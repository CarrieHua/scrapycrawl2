id=60700	LibreOffice likes to produce a certain amount of bogosity in it's files.If you create a blank writer document and save it you see:unzip -l /tmp/empty.odtArchive: /tmp/empty.odt Length Date Time Name--------- ---------- ----- ---- 39 2013-02-11 21:48 mimetype 906 2013-02-11 21:48 meta.xml 9863 2013-02-11 21:48 settings.xml 3241 2013-02-11 21:48 content.xml 728 2013-02-11 21:48 Thumbnails/thumbnail.png 899 2013-02-11 21:48 manifest.rdf 0 2013-02-11 21:48 Configurations2/images/Bitmaps/ 0 2013-02-11 21:48 Configurations2/popupmenu/ 0 2013-02-11 21:48 Configurations2/toolpanel/ 0 2013-02-11 21:48 Configurations2/statusbar/ 0 2013-02-11 21:48 Configurations2/progressbar/ 0 2013-02-11 21:48 Configurations2/toolbar/ 0 2013-02-11 21:48 Configurations2/menubar/ 0 2013-02-11 21:48 Configurations2/accelerator/current.xml 0 2013-02-11 21:48 Configurations2/floater/ 11252 2013-02-11 21:48 styles.xml 1086 2013-02-11 21:48 META-INF/manifest.xml--------- ------- 28014 17 filesHaving a load of empty 'Configurations2/' directories - that - might (but don't) hold something useful is a bit sad / pointless.It would be nice to remove (or not create) those directories unless they are needed. This probably has something twisted to do with the framework/ code hereabouts:framework/inc/uiconfiguration/moduleuiconfigurationmanager.hxx: class ModuleUIConfigurationManagerwith this sort of thing:framework/inc/uielement/uielementtypenames.hxx:#define UIELEMENTTYPE_FLOATINGWINDOW_NAME "floater"One gotcha to bear in mind is that the package2 (etc.) APIs we use to create and store streams are -horribly- awful; and creating sub-directories is really deeply unpleasant in packages. The lifecycle / 'commit' calling etc. on the interfaces is really poor - which perhaps is the reason why it is as bad as it is. Nevertheless if we can detect and avoid creating at least the sub-directories of Configurations2 we're winning I feel :-)Thanks ! The folder should hold the configuration, which is saved inside the document. That should be possible, but has errors in older versions and seems to be broken totally now. For details seeThe discussion with Carsten Driesner, which is mentioned in the OO.o bug, is in. But unfortunately it is in German.CreatedTemplate with toolbar insideTo give you an example, where the Configuration2 folder contains something useful, I attach a template. It is a template for writing French documents. It contains a toolbar to insert the special French characters using macros. A document which is generated from this template, has the toolbar in Configuration2 folder too. So you can easily test, whether your solution to avoid the empty folder will not destroy the ability to store a toolbar inside a document.Hi Regina - thanks for your input ! :-)I have no doubt that it is possible for these directories to hold something useful :-) surely they can.However - when there is no keyboard customisation / configuration etc. (and I'm certain we havn't configured any keybindings / floaters etc. in this doc) - then we should not be creating empty directories that serve no useful purpose in the ODF file.But of course, it'd be interesting to fixup those other problems too - thanks for the pointers ! :-)I read and tested Alex's patch here:And it appears to be a lot better - though we still end up with this empty directory:0 Stored 0 0% 2013-04-24 08:31 00000000 Configurations2/images/Bitmaps/0 Defl:N 2 0% 2013-04-24 08:31 00000000 Configurations2/accelerator/current.xmlBut encouragingly we get the accelerators serialized as expected. I guess for a document opened read/write it is not needed to create those storages until the data is written; but ...Any more explanation of the code change - much appreciated ...Hi,First, sorry for such a late response.The idea is that the storage elements are opened again in the UIConfigurationManager::storeToStorage method (same file), so, basically, if there is a need to store anything, they will be reopened as writeable. As you pointed out, my current patch does not purge these directories in files that already contain them, but are empty. I've found this documentation of the XStorage interface [1], but I am not quite sure how to go about determining if the storage element is empty. There surely is something I am missing. It would be very helpful if someone could point me in the right direction. [1]Ok - you convinced me :-) good work - I pushed it.To further improve this to delete empty directories you'd want to queryInterface on the XStorage for:and call getElementNames - clearly if there are none - it is empty; and then do some removeElement on the XStorage interface to clean them out :-)Of course, that'd need some testing; and particularly with the flat-ODF filters: not sure how they work in this regard (prolly fine but... save as '.fodt' or '.fods' etc.).Anyhow thanks for the nice fix ! and sorry for the slow review cycle.commit da06166015689eca260c702602bef4cea58afbd3 caused a regression, it is not possible to save new custom toolbars and it is not possible to modify existing custom toolbars any longer. See. Benefits of this commit do not outweigh the harm it causes, so it's better to revert it.As we re-fix this, we should clearly add a regression test for saving a toolbar =) Alex - any thoughts ?Beyond the matter whether it is nice or not, 0 byte-sized files mean a blocking problem at applying digital signature technology according to the related standards.The ODF v1.2 says, that "Document signatures shall contain a <ds:Reference> element for each file within the package [...]". For interoperability reasons it is also highly recommended to use "ASiC-E with XAdES/CAdES" format of ETSI TS 102 918 standard which requires the signature to cover all the elements of the package. But in case of having 0 byte-sized files in the files-to-be-hashed-and-signed set, a strict CEN CWA 14170 requirement can not be met which says, that it is a threat, if a "signature is generated to a 'null' document".Possible solutions for this issue are: e.g. simply deleting 0 byte-sized files from the package, or inserting some "dont-care" content into them such as XML comments, or an XML root element.I have made a search for the zero byte files with the attached script. The result: Formulas with modified style has got zero current.xml files, too, and LibreOffice uses a zero file to store default dialog language. See the following files in the attached test document:Object 1/Configurations2/accelerator/current.xml Dialogs/Standard/DialogStrings_en_US.defaultCreatedtest file saved in LibreOffice master with extra zero byte filescheck with unzip -vCreatedBash script to test odts for zero byte filesThis is for a quick test using locate to test all ODTs of the system. The script lists the invalid test files of xmlsecurity and qa, too: 1 /home/laci/git/libo/sfx2/qa/complex/sfx2/testdocuments/CUSTOM.odt: mimetype 1 /home/laci/git/libo/xmlsecurity/test_docs/documents/invalid_ooo2_x_doc1.odt: Pictures/New Text Document.txt 1 /home/laci/git/libo/xmlsecurity/test_docs/documents/invalid_ooo2_x_macro1.odt: Basic/New Text Document.txt 1 /home/laci/git/libo/xmlsecurity/test_docs/documents/invalid_ooo2_x_macro2.odt: Basic/Standard/New Text Document.txt 1 /home/laci/git/libo/xmlsecurity/test_docs/documents/invalid_ooo2_x_macro3.odt: Basic/New Folder/New Text Document.txt 1 /home/laci/git/libo/xmlsecurity/test_docs/documents/invalid_ooo2_x_macro4.odt: Basic/Standard/New Folder/New Text Document.txt 1 /home/laci/git/libo/xmlsecurity/test_docs/documents/invalid_ooo3_2_doc1.odt: META-INF/New Text Document.txt 1 /home/laci/git/libo/xmlsecurity/test_docs/documents/invalid_ooo_3_2_doc2.odt: New Text Document.txt 1Migrating Whiteboard tags to Keywords: (EasyHack DifficultyInteresting SkillCpp TopicCleanup)[NinjaEdit]JanI is default CC for Easy Hacks (Add Jan; remove LibreOffice Dev List from CC)[NinjaEdit]
id=40465	So, I look at p. 82-84 of a 152 page document, Print Layout, 68% so I can see and read these three full pages, and I see the upper third of the next three pages below them. I click on a location in the document, the cursor goes there, I can edit, all perfect. Then I press CTRL and scroll up 1 step (mouse wheel) to magnify, and the fking display jumps to p. 56. And I have scroll back 1 step, and then out 2 steps, it jumps to 109-112. Yes, the cursor is still at the position it was before and I can get to it by pressing LEFT or RIGHT or seemthing but I cant be asking to much when I want the thing to also SHOW me the same pages. Oh, and add to that: the same things happens with making comments visible. I am somewhere in a document and edit, fine. Then I say, "Make comments visible", and the display jumps just somewhere, very annoying.still present in 3.3.4, and I have to say, with OOO one at least got a reply ...***has been marked as a duplicate of this bug. ***This is still the case in 3.4.3.What happens is that the number of pages lines until the displayed part remains the same:zoom level 1 page -> page displayed: X (Xth pages row)zoom level 2 pages -> page displayed: 2X (Xth pages row)zoom level 3 pages -> page displayed: 3X (Xth pages row)etc.This bug is particularly annoying with big documents (I use F5 -> Navigator to change pages to cope with that).problem also present with LibO 3.4.4 and WindowsSame on 3.4.4 on Ubuntu.Took me a while to get the three page example.. Here the description for 2, for dummies like me ;)If you're on print view, viewing 2 pages next to each other, And are on page, e.g. 50, and zoom in with CTRL+Mouse wheel, you end up about on page 25 with the display. Hugely annoying.[This is an automated message.]This bug was filed before the changes to Bugzilla on 2011-10-16. Thus itstarted right out as NEW without ever being explicitly confirmed. The bug ischanged to state NEEDINFO for this reason. To move this bug from NEEDINFO backto NEW please check if the bug still persists with the 3.5.0 beta1 or beta2 prereleases.Details on how to test the 3.5.0 beta1 can be found at:more detail on this bulk operation:bug still present on master (3.6.0alpha+, openSUSE 12.1)This bug is present in 3.5.0 RC2 on Fedora Linux x86_64.In my document, if I'm at page 103, zoom out so I see a 2x2 display of pages 101, 102, 103 (no 104 in the document. There's a blank space left for that page.)Zoom back in, it now shows page 51. Zoom out, and I see the 2x2 pages with 101-103/4. Zoom out to a 4x2 display, I get the last 8 pages of the document.Zoom out to a single page, and I get page 24! Zoom out, and I get a 2x2 of pages 47-50! If I move the cursor with the arrow keys, I get back to page 103.Bug is still present in 3.6.0 RC2 32 bit (2012-07-20) and in 3.5.4.2 64 bit (current version from Debian Testing repo).This thing drives me crazy but at least the arrow keys reset the view to the correct page.Reset the version to 3.3.4.Note that the version picker should point to the oldest version where the bug is reproducible. It helps to locate the problematic code. See alsoHmm, I agree that this is annoying but when I compare it with other MABs (crashers, data loss), I do not think that it deserves to be in the top list. The bugs has been there for years it has only three users that are interested (in CC). A workaround is "easy". If you enter a letter and remove it , it displays the right page => removing from MABs and adding Writer developers into CC.BTW: I wonder if it might be an easy hack after all.(In reply to)If anyone (someone? I never know) could give me a code pointer and perhaps a little background information on moving the cursor location, I am willing to try to patch this.(In reply to)You may want to start having a look at the patches fromas this was a similar problem. Not sure if it really helps though.I think I have a fix, but I want to test it a bit further and I was to see whether the fix can be made more efficient.Basically, I perform a cursor left followed by cursor right after each zoom.(In reply to)correction:I think I have a fix, but I want to test it a bit further and I _want_ to seewhether the fix can be made more efficient.Basically, I perform a cursor left followed by cursor right after each zoom.I wonder if UpdateCrsr(SwCrsrShell::SCROLLWIN) is of any use here.(In reply to)No, calling UpdateCrsr(...) does not work as it is a private member of Class swCrsrShell. I tried before I submitted the patch as that would have been neater.Please don't implement zoom based on the cursor position. The zoom should be based on the current view. If the cursor happens to be in the current view, then zoom based on the cursor seems okay, but if the cursor isn't in the current view, don't change the cursor and don't change the view other than the zoom.It's really common that I scroll to another page and then zoom AND LEAVE THE CURSOR WHERE I WANT TO CONTINUE WORKING. It's really annoying to scroll (sometimes many pages away) to another page and then need to zoom in to see details. If the zoom is based on where the cursor is, then the view jumps back, many pages away. Then I have to scroll back to the details I want to refer to.Please don't change the Undo chain to get zoom to work.(In reply toand)The submitted patch makes that the current cursor position stays in focus during zoom. It is no problem to scroll through the text as long as you don't move the cursor, e.g. by using the scrollbars.Changing the zoom only changes the scale/size of the document in your view, the view/screen does not change. You can edit with zoom at 5% or at 500%, it's the same view.It may well be that I misunderstand you, but in the submitted patch I see no introduced problems with respect to cursor position or undo chain. I tested on various documents, scrolled, moved cursor positions and did undo-actions, all with varying zoom-factors to try to reproduce the bug-behaviour. Luckily, I did not succeed, neither did I notice other unwanted behaviour.Winfried Donkers committed a patch related to this issue.It has been pushed to "master":fdo#40465 fix to maintain correct focus whilst zoomingThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Winfried Donkers committed a patch related to this issue.It has been pushed to "libreoffice-4-0":fdo#40465 fix to maintain correct focus whilst zoomingIt will be available in LibreOffice 4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Winfried Donkers committed a patch related to this issue.It has been pushed to "libreoffice-3-6":fdo#40465 fix to maintain correct focus whilst zoomingIt will be available in LibreOffice 3.6.5.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.In reply to, "It may well be that I misunderstand you, but in the submitted patch I see no introduced problems with respect to cursor position or undo chain." I'm not sure we're saying the same thing. When you said "The submitted patch makes that the current cursor position stays in focus during zoom." that implies that the zoomed view is based on the current cursor position, and not on the current view.If that is the case, then this is the opposite of what I said in: "It's really common that I scroll to another page and then zoom AND LEAVE THE CURSOR WHERE I WANT TO CONTINUE WORKING. It's really annoying to scroll (sometimes many pages away) to another page and then need to zoom in to see details. If the zoom is based on where the cursor is, then the view jumps back, many pages away. Then I have to scroll back to the details I want to refer to."To clarify my work-flow: I usually work with the document width taking up the whole screen so that I can see details. Call this position A. It is slow to scroll to another part of the document (call it position B) using the mouse scroll wheel or the scroll bar when zoomed in for detail. When I need to scroll quickly to B, I zoom out from A so I get a better overview and can scroll faster. When I get to position B, I need to zoom into the current VIEW, B, not the current cursor, A. Then I can get the info I need from B and continue typing where the cursor is (A), many pages away. If I zoom to position A, then I don't see any of the details I need from B.Your solution of zooming into the current cursor position breaks the usability. The zoom should be based on the current view, not the cursor. The zoom should be based on what the user sees on the screen. If I scroll to another page and then zoom, the zoom should be based on what I see, not on where the cursor is. If I type, the characters should be placed at the cursor position and the view changed to show where I'm typing.(In reply to)Steve,I think I understand what you mean.The reported bug, which is now patched, is not quite the behaviour that you want.Simply zooimg out and back in (no scrolling) made the view change. That is not desireable, we probably both agree on that. Also scrolling to a certain page and then zooming in did not mean that the page you wanted to zoom in on, stayed in view.The behaviour that you want (being able to zoom in at another location that the cursor position) sounds like a usefull feature, but I suggest hat you submit a separate bug and label it as a enhancement. It will avoid misunderstanding as -OMHO- your request is not the same as the original reported bug. Also, realising your request requires code changes in quite different places than the code changes for this bug fix.Could you put me in the cc-list for the new bug? Thank you!reading the comments here, i think that Steve has a valid point:the requirements for this bug are incomplete, and the currentfix is a regression in some scenarios.when the cursor is visible in the document view, then it is reasonableto expect that it is still visible after zooming, which is whatthe fix does.but when the user has the cursor on page 1 on the document, andis looking at something on page 250 with 100% zoom and wantsto take a closer look and zooms in a little then i'd agree withSteve that it's quite undesirable to jump to page 1.so it would be best to check if the cursor is visible _before_zooming, and to adjust the view afterwards only if it is.there is apparently SwCrsrShell::IsCrsrVisible method, pleasecheck if that is useful here, otherwise there is alsoSwCrsrShell::GetCharRect which also sounds useful.(In reply to)Steve certainly has a valid point, no question about that.To make sure there no misunderstanding from my side:-potential difficulty 1:With the example of the cursor at page 1 and the intention to look a page 250 it is quite certain that page 1 will not be vissible when zooming in (increasing the zoom/magnification percentage).But what if we're talking of page 1 and page 7? it could well be that page 1 is still visible.-potential difficulty 2:Suppose the cursor at page 1 and us wishing to zoom in on page 250: Which page is to be kept in view whilst zooming in? Say we see 8 pages before we zoom in, how does the code know which page is to be kept in view?The pre-patch code did not have a hand hold, so it sort of jumped to the first page that was in view before zooming. I gave it a hand hold (cursor position), and now I am in need of one, if you get my drift.Should we set a pointer to the page (paragraph, character, depending on the zoom percentage) that is to be kept in view. I mean is there a 'virtual cursor position' to focus on whilst zooming? Should this be triigered by a (any, specific?) scrolling action of the user?I'm quite willing to have a go at it, but it'll take some time before I can really start as I would like to finish another patch (that is currently being reviewed) first.The "user expectations" (as if there's a standard across all software) is pretty much that you zoom in/out wrt (with respect to) the center of the current view (COV) or the mouse position. Having said that, I did a little survey and thought about the difference between zooming wrt to the center of the current view and zooming to the current mouse position. But first, the survey:Here's a small survey of what happens when you turn the scroll wheel:with: No mods Shift ControlLibOffice pan U/D pan L/R zoom in/outDraw wrt COV LibOffice pan U/D pan L/R zoom in/outImpress wrt COV LibOffice pan U/D pan L/R zoom in/outSpreadsheet maintain upper-left Gimp pan U/D pan L/R zoom in/out wrt mouse Visio pan U/D pan L/R zoom in/out wrt center of cur selected objects or COV if no objs selectedSketchUp zoom in/out zoom in/out zoom in/out wrt mouse wrt mouse wrt mouseGoogle zoom in/out tilt view rotate viewEarth wrt mouse wrt COV wrt COVHaving used all of these, it's comforting when the same action gets the same result. When I use SketchUp, it's annoying when I need to scroll, because SU doesn't make use of the modifiers, and, therefore, the scroll wheel won't pan.Zooming wrt the mouse position is like zooming wrt to the center of view, but you have more control over where the zoom occurs. Both methods zoom wrt what you see, which is the most important feature of both---there's no sudden change on the screen when you are essentially magnifying what you are looking at. (A viewpoint jump is okay if I start typing, because the cursor determines where I type, and I expect to type where the cursor is, even if it's out of view.) However, with zoom wrt mouse you can quickly adjust where the zoom point is without having to stop zooming, then use the scroll bars to adjust the center-point, then switch back to the scroll wheel, zoom, then re-adjust the center-point. Using the mouse wheel to zoom and the mouse position to choose the center-point for the zoom is a really fluid action that makes zooming quick, intuitive, and really easy to control and adjust on-the-fly.(In reply to)that is of course true.well i'd just propose to use the cursor visibility check as a heuristic,surely it won't always result in what the user wanted but our task hereis to do the right thing "most of the time", we cannot read user'smind and if we're doing it wrong the user can then scroll around.i can't think of an obvious, easily implemented answer here,so how about we just do the same thing the old code used to do in this case?what i'm mostly concerned about is the obvious regression that Stevecomplains about, which is now backported to the 3.6 and 4.0 releasebranches.i suggest to fix that first, and if you are still motivated after that,you can think (and perhaps ask UX) about what changing zoomshould do in an ideal world :)To address...-potential difficulty 1:Center on the current view (or mouse). When you zoom out from 7, go to 7/8 (for COV and odd/even pairs) or 6/7 or 7/8, depending on whether the mouse is closer to the top or bottom of page 7 when zooming out.When you zoom out from 250, show 249/250 or 249/250 or 250/251 for mouse zoom.Use COV or mouse. If you use COV and you're viewing:1 2 3 45 6 7 8then it's hard to know what the user wants. Right now it looks like it's based on the upper-left page, 1 in this case. But what if I'm interested in zooming in on page 7? I could click on page 7, but then I've lost the place where I want to type. I could fiddle with the scroll bars to put 7 in the upper left, but that's tedious.If you use the mouse position, and it's over page 7, then you should display6 7 8 then 7 8 then 7 8, repositioning the mouse (which is fast) as needed.9 10 11 9 10After reviewing COV vs mouse, I vote for mouse. It's intuitive because it's WYSIWYG. In either case, when you scroll, you're changing the COV, which becomes the new COV or a new view for the mouse to explore.update:Using SwCrsrShell::IsCrsrVisible() seems a good idea, but doesn't work. The function checks if the cursor rectangle (SwCrsrShell::GetCharRect()) is within the visible area (SwCrsrShell::VisArea().For reasons that I can't figure out (yet), the result sometimes is false when the cursor can be seen blinking in the view.This probably means that I will not be able to submit a partial patch that addresses the regression case in time for for version 3.6.5.Enhancing the behaviour to nicely focus on whatever is decided is most user friendly is something I haven't been able to think about yet.update:I now have a patch that keeps the cursor in focus, when it is visible, and behaves as before January 8 when the cursor is not visible.That solves the regression problem. I intend to commit the patch later today.The behaviour when the cursor is not visible still is to be improved: when the view changes from n pages next to each other to m pages next to each other (m not equaling n), the visible page jumps out of view. For example on a 22 page document, with page 22 visible (and cursor at page 16) it jumps to page 10 when zooming in and back when zooming out.This is something I will be looking into, but that may well be time consuming.Winfried Donkers committed a patch related to this issue.It has been pushed to "master":fdo#40465 solve regression when zooming with cursor not visibleThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Winfried Donkers committed a patch related to this issue.It has been pushed to "libreoffice-4-0":fdo#40465 solve regression when zooming with cursor not visibleIt will be available in LibreOffice 4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Winfried Donkers committed a patch related to this issue.It has been pushed to "libreoffice-3-6":fdo#40465 solve regression when zooming with cursor not visibleIt will be available in LibreOffice 3.6.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Winfried Donkers committed a patch related to this issue.It has been pushed to "libreoffice-3-6-5":fdo#40465 solve regression when zooming with cursor not visibleIt will be available already in LibreOffice 3.6.5.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.The jumping of the page also occurs when changing the width of the window (in which the document is shown) to a size which makes the number of columns change, regardless whether the cursor is in view or not.I'll see if there are other bug reports mentioning this problem (apart fromin this bug), so that I can fix all likewise problematic behaviour.***has been marked as a duplicate of this bug. ***Re:, are you Steve confusing "cursor" and "caret"? It's the mouse cursor (or "pointer") that people refer to in this discussion when using the word "cursor", right?The mouse cursor / pointer, by definition, is always visible on the screen (except if explicitly turned off, like when viewing full-screen video in some media player, which I don't thjink LibreOffice does).Inyou apparently talk about the text insertion point, specific to a text field (like the text document being edited), indicated by the caret. That indeed need not be visible, it might be scrolled off-screen. I don't think anybody wants to change that.Note the related work on mouse centred zooming by Tim Hardeck from last year, that never got included, see.Also note that for touch device support, it is essential to have support for zooming centred on a specific position (not "cursor" as such, tablets don't have cursors, but the centre of a two-finger pinch/spread gesture). Which is making getting this bug/feature done more acute.Re: my, reading more of the comments here after, it is unfortunate that LO itself intentionally in the source code uses the "cursor" term (or the abbreviation "Crsr") for the text insertion caret, sigh. And apparently in this discussion the term "cursor" is used for the caret, to. (The term "mouse" is used by many here for the mouse pointer (cursor)). So, I guess it is a lost cause to try to use consistently separate words for these concepts.(In reply to)I confirm your findings. I replied so to your, but apparently I did something wrong as it did not get into the bug..Having had a look at the patch from Tim Hardek, I think I can make the code to keep the center of the window in focus whilst zooming (for the case that the caret is not visible).But it will be a couple of days before I have the opportunity to build and test the modified code.Winfried - thanks for all your great work on this bug :-)For touch / tablet-ness we are going to want to be able to pinch-to-zoom a document in an intuitive way that doesn't jump around the place (I guess) and probably bears no relation to where the cursor is or isn't [ lots of demands there of course ;-].I guess it's an interesting problem; hopefully we can re-use some combination of Tim / your work here. Tim's seemed to be significantly confused by the fact that the scroll zoom in would move the effective center of the zoom and the zoom-out would then try to restore something and (well - I forget what it did but it felt wrong to me ;-)(In reply to)I mean that the place you zoom into should be the mouse pointer, not the current insertion point. As I've said before, it's important to be able to zoom in to another portion of the document without losing the insertion point. This means that there need to be two pointers, and the logical ones are (a) the insertion point, and (b) the mouse cursor. The insertion point doesn't, and shouldn't, move as you zoom in and out. The mouse is free to move over any portion of the visible part of the document, so it's the best (only?) candidate for the center of zoom, whether it's in or out. We already have the notion of the view changing to the insertion point when you start typing, so it's already really easy (and intuitive) to return to the insertion-point view. Because mouse-based zoom is used in many other programs, it's intuitive (to a user) to use the mouse position as the zoom center in LibreOffice as well.I did some tests with bits of Tim's patch, but it does not fix the problem of this bug at all :-(I know what goes wrong, but haven't been able to find where is goes wrong.The pages of the document are 'tiled' in rows and columns, depending on the zoom factor and the window width. When repainting, it jumps to the relevant page(s) by going to the mth row and nth column.If the number of columns changes, because of zooming or because of window resizing, the number of columns changes, but on repaint the code still jumps to the old row number, which now contains a different page.I keep searching, but the pace is slow...IMHO, mouse pointer or finger position (touch screens) related zooming should have its own bug. It is an enhancement (and a longed for one), and not related to the problems this bug addresses.This is still a problem in 4.0.0.3, just downloading 4.0.1 now. I do think there's actually more wrong thatn just that. I just found a similar thing. I have a document that has several text frames. If I look at the doc with 3 pages next to each other and you delete one of them, the screen jumps two times and ends up slightly somewhere else. Take the attachment, look at three pages next to each other, delete the frame on p. 4, and see what happens.Createdframe deletion makes pages jump(In reply to)Yes, you are correct. The problem is not about zooming, but about repainting the pages in the window when the number of pages next to each other changes.I'm still trying to find the cause.I have changed the description of the bug to reflect the complete problem.(In reply to)i guess it depends on _how_ you zoom.i usually use the "slider" in the lower right to zoom,in which case the mouse cursor is naturally on the sliderand outside the document area, hence "mouse centered" israther useless in this case, and something like "keep theview cursor visible if it was before" makes more sense.(In reply to)Writer uses the term "Cursor" in a more abstract way for anytext selection in the document, of which there may be many at a time.One of these is the "View Cursor" (or shell cursor) that youcall "caret".(In reply to)This bug presently contains two issues:1. when the window is repainted, the shown page(s) may jump (see)2. the present zoom behaviour is that the top-left corner of the window is used as focal point. This could be changed to window-center or mouse pointer position (with window center as alternative when the mouse pointer is not in the visible area).The only thing 'fixed' so far is that when the caret is visible, it will remain visible (i.e. page jumps no longer occur).I very much want to work on issue 2 (large parts of Tim's patch can be used for this), but I need to fix issue 1 first, otherwise no testing is possible.And I still haven't found the code that causes these jumps. I know when the jump will take place I know to which page writer will jump, but I keep getting lost in the maze of calls. I suspect I need to be at the paint function, where (I think) the page to be painted is recalled and where (that's my current guess) the addressing (row/column vs page number) goes wrong.Hints and suggestions are very much welcome.update:I am now almost convinced that I know what is the problem, but a solution seems to be rather fundamental.After zoom/resizing each page (starting at the first page) is checked for being within the visible area (/core/sw/source/core/view/viewimp.cxx, SwViewImp::SetFirstVisPage()). But the comparison of rectangles (page and visible area) is not correct when the number of pages to be shown next to each other changes.Take for example a document with a zoom factor that shows 3 pages in a row and the top left page is page 16 (6th row). When resizing the screen width to a bit less than needed for 3 pages next to each other, the jump occurs. The page rectangles are now based on 2 pages in a row, whereas the visible area rectangle still reflects the 6th row. As a result the page on the 6th row (now page 11 as only 2 pages fit in a row) is shown and not page 16.I think this problem is caused because the 'focal point' (the position in the document, in the current code the top left page in the visible area before zooming/resizing) is not stored. The iteration through the pages of the document to find the 'focal point' happens a lot, which must be inefficient for large documents.A solution would be to keep track of the 'focal point'. The jump problem will not occur and a lot of iterating through the pages can be discarded with. I think it will also be easier to change the sort of focal point (top left corner, screen center, etc.)But this a rather fundamental change.Where to store the 'focal point'? When to adjust it? How to keep the 'focal point' available and which classes should have Get or Set access to it? Etc.@Cedric Bosdonnat, @Michael Stahl: you are the writer experts, what are your opinions on this? Such a change looks too big for me to handle, but with some guidance I might give it a try. Without guidance (such as hints and comments on my wop) I fear I must change the assignee from me to unassigned...If my text is not clear, please say so and I will try to clarify.I see no further possiblities to fix this bug without help.It is clear (to me) what generally goes wrong, but I can't pinpoint the exact what and where in the code.When this is possible, it is relatively easy to incorporate a 'focal point' for zooming (e.g. window center of mouse cursor position).I removed my name as assignee to make fixing this bug available for others.Still willing to help (and fix), however :-)Restricted my LibreOffice hacking areaIn order to limit the confusion between ProposedEasyHack and EasyHack and to make queries much easier we are changing ProposedEasyHack to NeedsDevEval.Thank you and apologies for the noiseThis bug really could use a summary as per, or (likely preferable) a new bug with a clear description of the remaining issues.Summary of remaining issues:When repainting a multi page writer document, the page that has focus may disappear from the screen. The only issue that has been fixed so far is the case where the page that has focus also contains the caret (text insertion point).The following comments describe what problems remain and what happens:#52#47#53IMHO, it was fairly pointless to reopen this bug. With this many comments about potentialy quite unrelated issues, nobody is ever going to get much useful information out of this bug report. I think.Reading just the previous comment, I don't really understand what "focus" means? The part of a document the user is looking at? ;) That's what it sounds like to me. If the text insertion caret never disappears accidentally (is that now the case?), that is good enough for me. I don't expect the software to know that I happen to look at a different spot in the document and that it should keep that spot visible instead...But ignore me, I am not a Writer hacker anyway,(In reply to)tml, I will not ignore you, you're comments are mostly usefull and otherwise entertaining ;)The current status (reopened) dates from around January 2013 and is IMHO justified and explained concisely by e.g.. That comment also may answer your question about focus.Migrating Whiteboard tags to Keywords: (needsDevEval)[NinjaEdit]
id=55695	CreatedPython script that listens for window.activate eventsWriter is not returning a window.activate event when the focus is returned by Alt-Tab. You can see the window.activate events generated with the attached python listener.To reproduce:1. Open Writer. 2. Alt-Tab away from Writer to another window.3. Alt-Tab back to Writer. No window.activate event is generated for Writer. We need to know:What operating system?What version of libreoffice?Has it been tested on a new stable release (preferably version 4)?What real impact does this have on anyone?Marking as NEEDINFO - please answer these questions and then mark as UNCONFIRMED if the problem still exists - if it doesn't mark as WFM.Thanks for your patience, apologies it took so long for someone to respond to your bug reportThis is still an issue. I am currently running gnome 3.10 with orca 3.10.1 and libreoffice 4.1.2.I can do the following- locate a writer icon in the gnome dock or elsewhere- activate the iconwhat happenslibre office writer window opens but I am not notified that something has changed giving an impression focus is still on the writer icon in the dock.What is expectedwriter document window should notify ATK that it has gained the system focus somehow. For example while opening gnome applications like gedit, gnome calculator etc I am correctly notified to the fact they have been launched with a proper focus indication.confirmed byStarted bisecting this issue and noticed that the issue was the same in version 3.5.0 as it is in the current version.I also noticed that if you open a new document from within LibreOffice the new document will receive the window.activate event, but the first document will continue to not receiving the event.And the issue is not isolated to Writer the issue is just the same if the first document you open is a spreadsheet, drawing, ...Per comment updating above info** Please read this message in its entirety before responding **To make sure we're focusing on the bugs that affect our users today, LibreOffice QA is asking bug reporters and confirmers to retest open, confirmed bugs which have not been touched for over a year.There have been thousands of bug fixes and commits since anyone checked on this bug report. During that time, it's possible that the bug has been fixed, or the details of the problem have changed. We'd really appreciate your help in getting confirmation that the bug is still present.If you have time, please do the following: Test to see if the bug is still present on a currently supported version of LibreOffice (4.4.3 or later)If the bug is present, please leave a comment that includes the version of LibreOffice and your operating system, and any changes you see in the bug behavior If the bug is NOT present, please set the bug's Status field to RESOLVED-WORKSFORME and leave a short comment that includes your version of LibreOffice and Operating SystemPlease DO NOT Update the version field Reply via email (please reply directly on the bug tracker) Set the bug's Status field to RESOLVED - FIXED (this status has a particular meaning that is not appropriate in this case)If you want to do more to help you can test to see if your issue is a REGRESSION. To do so: 1. Download and install oldest version of LibreOffice (usually 3.3 unless your bug pertains to a feature added after 3.3)2. Test your bug 3. Leave a comment with your results;4a. If the bug was present with 3.3 - set version to "inherited from OOo"; 4b. If the bug was not present in 3.3 - add "regression" to keywordFeel free to come ask questions or to say hello in our QA chat:Thank you for your help!-- The LibreOffice QA Team This NEW Message was generated on: 2015-06-08(In reply to peter.v from)Works fine for me on Ubuntu 16.04, Libreoffice 5.3 master gtk2 and gtk3 builds, Orca 3.20.3.(In reply to Yousuf Philips (jay) from)On LibreOffice 5.2 GTK2 the problem still appears. It looks like Orca has created a work around for this issue.I mark the bug as reopened.
id=103969	Description:Recent fixes on LODev 5.3 cause wrong glyph orientation for CJK Symbols and Punctuation characters when they are used in vertical Mongolian.Steps to Reproduce:1. Openand take screenshot2. Disable HarfBuzz (Tools -> Options -> Advanced: Expert Configuration search for "TextLayoutEngine") and restart3. Take screenshot againActual Results: With HarfBuzz:U+300A/300B are rotated when render with Oyun Qagan Tig, but with Mongolian Baiti they looks upright.Without HarfBuzz:U+300A/300B are rotated even if using different fonts.Expected Results:To fix it, CJK brackets (U+3008–300F, U+3014–301B) should get their vertical form via vert/vet2 feature, otherwise rotate the glyph by text layout engine.Reproducible: AlwaysUser Profile Reset: NoAdditional Info:Version: 5.3.0.0.alpha1+Build ID: c03c77ef4f46b81cd000ea26c4ef154044322535CPU Threads: 4; OS Version: Windows 6.19; UI Render: default; Layout Engine: new; TinderBox: Win-x86@39, Branch:master, Time: 2016-11-17_00:29:08Locale: zh-CN (zh_CN); Calc: groupUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:50.0) Gecko/20100101 Firefox/50.0 CreatedTest with HarfBuzzCreatedTest without HarfBuzzCreatedTest fonts(In reply to General Kutuzov from)Several bracktes encoded in Halfwidth and Fullwidth Forms range (U+FF08–FF09, U+FF3B, U+FF3D, U+FF5B, U+FF5D, U+FF5F, U+FF61) should also use this presetation form.I consider this a font bug; it does not provide a ‘vert’ feature, and even if vertical shaping fallback was implemented in HarfBuzz () it won’t help here since the vertical presentation forms are drawn upright in this font.BTW, do you get the correct behaviour with Firefox or Chrome?On a second thought, I think we can reasonably handle this.Khaled Hosny committed a patch related to this issue.It has been pushed to "master":tdf#103969: Do fallback glyph rotationIt will be available in 5.3.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.It have no effect to me.Version: 5.3.0.0.alpha1+Build ID: 883024d657fb45c7da459017d2f936aac5644bfbCPU Threads: 4; OS Version: Windows 6.2; UI Render: default; Layout Engine: new; TinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2016-11-21_22:51:20Locale: zh-CN (zh_CN); Calc: groupI can’t see the effect even if I get 5.3 beta1.Version: 5.3.0.0.beta1Build ID: 690f553ecb3efd19143acbf01f3af4e289e94536CPU Threads: 4; OS Version: Windows 6.2; UI Render: default; Layout Engine: new; Locale: zh-CN (zh_CN); Calc: group(In reply to Volga from)Can anyone else confirm this?Hi Khaled, I reopen the issue because I also see upright brackets.CreatedScreenshot 5.3.0.0beta1(In reply to Mark Hung from)Do you reproduce it also on Linux (using the same fonts)?Set to Windows since I do not see this on Ubuntu 16.04.Version: 5.3.0.0.beta1Build ID: 690f553ecb3efd19143acbf01f3af4e289e94536CPU Threads: 1; OS Version: Linux 4.4; UI Render: default; VCL: gtk2; Layout Engine: new; Locale: en-US (en_US.UTF-8); Calc: groupThis need to investigate what prevent the expected output on Windows.(In reply to Volga from)Since mostly users use LibreOffice on Windows, we should pay more attentions to that, and find better solution as soon as possible.(In reply to Volga from)It seems to me that our GDI handles failed to process some special text oritation specified by our text layout engine.
id=92617	CreatedAn extract of the ubuntu crash reportInI had regular crashes switching forms. That was fixed. However, the same symptom has now resurfaced, but it appears to be a slightly different cause since my demo of that crash does not crash in 4.4.4.3.I'm running MariaDB (10.0.20) and Libreoffice from the Ubuntu 14.04 ppas.The crashes usually occur when I have entered or modified data in a form which has been invoked from a series of previous forms, close that one and automatically expect to see the previous one show again. I use Basic macros to provide a type of modal user interface for the application. To explain briefly, it is a music catalogue, where I have a record set (eg one or more CDs), with several performances, on tracks, of pieces and/or parts of pieces. I can therefore view the record set, edit/add a performance or an existing or new piece, and return back to the record set and see that it now has a new track on it. There are quite a few bells and whistles.A number of forms and sub-forms are involved, and a number of tables and queries. My suspicion is that it is a GUI problem, as opposed to a Database problem, but I could well be wrong. I have some .xsession-errors but they are not time-stamped so I can't match them up with the syslog and may well be unrelated.I am well aware that this is insufficient information to help diagnose the problem(s). Supplying a copy of a fully populated database and instructions on how to use a non-trivial application, with inconsistent results, is, however, not very practical.I have run this in the debug version, and have a ubuntu crash report. That's over 40MB, so not very practical to upload here. I have therefore edited it to remove the core dump and attached that. I have taken the liberty of copying the email addresses from #70703 to this report.Createdhs_err_pid fileI just found a related java error log, attached.The Ubuntu crash report contains a backtrace. It points to this method in file svx/source/form/formcontrolling.cxx: bool FormControllerHelper::isModifiedRow() const { bool bIs = false; if ( m_xFormOperations.is() ) bIs = m_xFormOperations->isModifiedRow(); return bIs; }and seems to be the line "m_xFormOperations.is()", where "&m_xFormOperations" is 0x40, an obviously invalid value. I deduce that from one frame down: #7 is (this=0x40) at /build/libreoffice-A1OEbm/libreoffice-4.4.4~rc3/include/com/sun/star/uno/Reference.h:93I am trying to pin down when and why the crash occurs.I am in one form's (A) subform (B). From there I open another form (C) that contains a subform (D). If the focus is on subform (D) when form (C) is closed then tracing my macros I get to form D's afterupdate macro which seems to execute OK (all the values look to be correct) but on ending that macro Base crashes.If I manually move the focus from (D) to (C) before closing (C) then no crash occurs.I am trying to reproduce this in a simple fashion, but haven't succeeded yet.I mention this now because what I think Lionel is saying is that a pointer is empty, and I wonder if form (C) has disappeared before subform (D) has completed its actions.CreatedTest case databaseThis was not easy to reproduce, but I have just managed to do so in the attached self-contained database. I don't know if all the complexities and features included in the demo are require to generate the crash. There are 4 tables. Table1, with Table2 containing records that depend on Table1 records and also depend on Table3 records. Table4 has records that depend on Table3 records. There are 2 forms. Table1 has Table1 records with a subform for Table2 records linked to Table1. Table3 has Table3 records with a subform for Table4 records linked to Table3.To make it crash follow these steps:1. Open Table1 form2. Enter text in text13. Enter text in text2 (which is in the Table2 subform)4. Press button 'Open Table3'5. Enter text in text 36. Enter text in text 4 (which is in the Table 4 subform)7. Press the Exit button (do nothing else - if you put the cursor in a Table3 field first it may not crash)8. LO Base will ask you 'Do you want to save your changes'9. Press Yes10. It should crash.There are 4 (very ugly) macros created for testing this. Table4BeforeUpdate is the 'before update' routine for the Table4 subform. OpenForm is the routine for opening the Table3 form from Table2. ExitTable3 is called when the Exit button is pressed on Table3. CloseTable3 is called as the 'Document is going to be closed' routine on Table 3.The crash seems to be due to some sort of timing problem. When debugging in Table4BeforeUpdate there is a nested call to the 'before update' routine for the Table 4 subform. I had to add a delay to that routine to make it crash. In my real system I just do a lot more work in the equivalent forms that creates a long enough delay for the crash to occur more often than not.Version: 5.1.0.0.alpha1+Build ID: 9136f2344af88d524b6c10b6b2dfd6017bba60ecLocale: fr-FR (fr.UTF-8)OSX 10.10.4Confirming crash with Tim's file and steps inOn master, running in lldb, it first stops on its own when opening form Table1Process 12524 stopped* thread #18: tid = 0x1dd248, 0x000000012bcf329b, stop reason = signal SIGBUS frame #0: 0x000000012bcf329b-> 0x12bcf329b: testl -0x1ad3b1a1(%rip), %eax 0x12bcf32a1: retq 0x12bcf32a2: nop 0x12bcf32a3: nop Continuing to clicking on Exit button :warn:sal.osl.mutex:12524:1:sal/osl/unx/mutex.cxx:82: pthread_mutex_destroy failed: Resource busywarn:legacy.osl:12524:1:svx/source/form/formcontroller.cxx:3573: caught an exception!in function:bool svxform::FormController::checkFormComponentValidity(rtl::OUString &, Reference<com::sun::star::awt::XControlModel> &)type: com.sun.star.lang.DisposedExceptioncontext: N7svxform14FormControllerEwarn:legacy.osl:12524:1:svx/source/form/formcontroller.cxx:3659: caught an exception!in function:bool svxform::(anonymous namespace)::lcl_shouldValidateRequiredFields_nothrow(const Reference<com::sun::star::uno::XInterface> &)type: com.sun.star.uno.RuntimeExceptionmessage: unsatisfied query for interface of type com.sun.star.container.XChild!warn:legacy.osl:12524:1:svx/source/form/formcontroller.cxx:3705: FormController::approveRowChange: no column infos!error: libdbalo.dylib debug map object file '/Volumes/BUILDHD/Shared/LO/core/workdir/CxxObject/dbaccess/source/core/api/RowSetCache.o' has changed (actual time is 0x559ad0a7, debug map time is 0x5596928a) since this executable was linked, file will be ignoredProcess 12524 stopped* thread #1: tid = 0x1dd143, 0x000000011ce5fb4e libdbalo.dylib`dbaccess::ORowSetCache::insertRow(std::__1::vector<com::sun::star::uno::Any, std::__1::allocator<com::sun::star::uno::Any> >&) + 46, queue = 'com.apple.main-thread', stop reason = signal SIGSEGV frame #0: 0x000000011ce5fb4e libdbalo.dylib`dbaccess::ORowSetCache::insertRow(std::__1::vector<com::sun::star::uno::Any, std::__1::allocator<com::sun::star::uno::Any> >&) + 46libdbalo.dylib`dbaccess::ORowSetCache::insertRow:-> 0x11ce5fb4e <+46>: movq 0xd0(%rax), %rsi 0x11ce5fb55 <+53>: testb $0x1, (%rsi) 0x11ce5fb58 <+56>: movq %rax, -0x2d8(%rbp) 0x11ce5fb5f <+63>: je 0x11ce5fb93 ; <+115>CreatedbacktraceIt may be useful to note that if you remove the 'wait' from the Table4BeforeUpdate macro it does not crash. That's why I think it's some form of timing issue, with something being closed/deleted/dereferenced before it should be if things take too long.(In reply to tim from)I should stress that this is the case for the demo database I posted. In the real world case Base crashes much of the time due to this problem, but not every time. There are, of course, no 'wait' statements that I can remove.My LibreOffice has just updated to Version: 5.0.0.5, Build ID: 00m0(Build:5), Locale: en-GB (en_GB.UTF-8).This bug is still present.Createdconsole logs + bt with debug symbolsOn pc Debian x86-64 with master sources updated yesterday, I could reproduce this.If I don't misunderstand the bt, the pb is m_pCache is null. But how can it be since some lines above in dbaccess/source/core/api/RowSet.cxx, we've got this: 886 if(!m_pCache || !m_bNew || !m_bModified || m_nResultSetConcurrency == ResultSetConcurrency::READ_ONLY) 887 throwFunctionSequenceException(*this);Moreover, there's ::osl::ResettableMutexGuard aGuard( *m_pMutex );SeeSo even with multithread case, it should be ok(In reply to Julien Nabet from)aGuard is a resettable guard, and that's exactly what: notifyAllListenersRowBeforeChange(aGuard,aEvt);does:void ORowSet::notifyAllListenersRowBeforeChange(::osl::ResettableMutexGuard& _rGuard,const RowChangeEvent &aEvt){ NOTIFY_LISTERNERS_CHECK(m_aApproveListeners,XRowSetApproveListener,approveRowChange);(...)and:#define NOTIFY_LISTERNERS_CHECK(_rListeners,T,method) \ (...) \ _rGuard.clear();Createdvalgrind logIn addition of Valgrind trace, I added some traces at DELETEZ(m_pCache) and at m_pCache = new...Caolan: I don't know if it's related to the crash but I noticed this in Valgrind trace 29935 ==29672== Conditional jump or move depends on uninitialised value(s) 29936 ==29672== at 0xAD31CFB: Rectangle::IsInside(Point const&) const (gen.cxx:139) 29937 ==29672== by 0xBBE301E: vcl::Window::ImplHitTest(Point const&) (mouse.cxx:62) 29938 ==29672== by 0xBAED29A: vcl::Window::ImplFindWindow(Point const&) (stacking.cxx:679) 29939 ==29672== by 0xBC9F259: HandleGestureEventBase::FindTarget() (winproc.cxx:1423) 29940 ==29672== by 0xBC9F7BF: HandleGestureEvent::HandleEvent() (winproc.cxx:1562) 29941 ==29672== by 0xBC9F8BF: ImplHandleSwipe(vcl::Window*, SalSwipeEvent const&) (winproc.cxx:1593) 29942 ==29672== by 0xBCA2D26: ImplWindowFrameProc(vcl::Window*, SalFrame*, unsigned short, void const*) (winproc.cxx:2670) 29943 ==29672== by 0x1B5F5000: SalFrame::CallCallback(unsigned short, void const*) const (in /home/julien/compile-libreoffice/libreoffice/instdir/program/libvclplug_gtk3lo.so) 29944 ==29672== by 0x1B5F0F64: GtkSalFrame::gestureSwipe(_GtkGestureSwipe*, double, double, void*) (gtksalframe.cxx:3581)(I use gtk3)false positive from Valgrind or real bug?Additional traces before segfault:warn:sw.core:30105:1:sw/source/core/attr/calbck.cxx:170: a 21SwAccessibleParagraph client added as listener to a 16SwTextFormatColl during client iteration.TODO DELETEZ m_pCacheTODO freeResources from ORowSet::closeTODO DELETEZ m_pCacheTODO freeResources from ORowSet::closeTODO DELETEZ m_pCacheTODO freeResources from ORowSet::disposingTODO DELETEZ m_pCacheTODO freeResources from ORowSet::disposingwarn:legacy.osl:30105:1:sw/source/core/attr/format.cxx:228: SwFormat::~SwFormat: Def dependents!Is there any more on this? I still get these crashes at times.I'm going quietly nuts on this. I've a load of stuff to add using my application, and it's now crashing almost every time.I upgrade importance of this one since:- it's a crash- it's a regressionJust for the update, I still reproduce with master sources updated yesterday.Thanks.ORowSet::insertRow is called, that calls notifyAllListenersRowBeforeChange before it goes ahead and does the real insert there is some script listening on that and that calls close on the document again so eventually ORowSet::insertRow is called again. The inner insertRow completes and remove the m_pCache and eventually control returns to the outer one which falls over and dies.ORowSet::insertRow is called, that calls notifyAllListenersRowBeforeChange before it goes ahead and does the real insert there is some script listening on that and that calls close on the document again so eventually ORowSet::insertRow is called again. The inner insertRow completes and remove the m_pCache and eventually control returns to the outer one which falls over and dies.Caolán McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: tdf#92617 don't crash if insertRow gets triggered during insertRowIt will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.The specific example was reproducible and I've fixed our side. But all this does for you is to throw back to basic where this save-inside-a-save happens is which hopefully is useful for you to change your script to avoid this case.(In reply to tim from)Reading from what Caolan explains, I think that is because moving the focus from (D) to (C) does the row insertion. You will find that clicking on the "save record" button should have the same effect.(In reply to Lionel Elie Mamane from)You could also try to commit the changes (do the write to database) from the ExitTable3 macro before calling oController.close().I'm not yet convinced this is not our bug. You shouldn't have to take these precautions. It should just work. I'm looking into it.Caolan, I think we will have the same problem with ORowSet::updateRow.So, what happens is: * focus is in table4 subform * you click on "exit" button which is in table3 form * this moves the focus to table3 form, which implicitly commits the changes in the table4 subform *before* allowing the click. * the commit of the changes calls your Table4BeforeUpdate macro * this macro contains a "wait" statement. This wait statement (which is a thread yield, that allows other events to be processed in the meantime) allows the "click" event to be processed, calling your ExitTable3 macro, which calls close, which starts the "commit changes" again.This is definitely our bug. What I would like is for the "click" event *not* to be treated before the "commit because we change focus" is *finished*. I'm not 100% sure how to achieve that.At first I thought this could be linked to the svxform::FormScriptListener::impl_allowAsynchonousCall_nothrow discussed in, but it looks like it is not.Anybody has any idea of how I can enforce that one event "waits" for the other to finish?I attach a backtrace.At frame 80 starts the treatment of "change focus from one form to another":#80 0x00007f469e84c4c7 in svxform::FormController::OnActivated (this=this@entry=0x769aae0) at /home/master/src/libreoffice/workdirs/libreoffice-5-2/svx/source/form/formcontroller.cxx:1763On frames 74 and 73 you see that the change of focus first makes the "commit the current record".#73 0x00007f469e886df7 in svx::FormControllerHelper::commitCurrentRecord (this=0x7b470f0) at /home/master/src/libreoffice/workdirs/libreoffice-5-2/svx/source/form/formcontrolling.cxx:306#74 0x00007f469e7d537b in FmXFormShell::setActiveController (this=this@entry=0x322af50, xController=uno::Reference to (svxform::FormController *) 0x769ab30, _bNoSaveOldContent=_bNoSaveOldContent@entry=false) at /home/master/src/libreoffice/workdirs/libreoffice-5-2/svx/source/form/fmshimp.cxx:1881This then calls the event listeners, which are allowed to veto the commit (approveRowChange event). This goes in Basic interpreter code (frames 49 and below). When Basic gets to the "wait" statement (frame 29) it calls Application::Yield() (frame 28) which then starts treating the "click on button" event (frames 17 and below):#13 0x00007f4638b4028f in frm::OButtonControl::OnClick (this=this@entry=0x797fb10) at /home/master/src/libreoffice/workdirs/libreoffice-5-2/forms/source/component/Button.cxx:460(...)#16 0x00007f469b4c2de6 in ImplHandleUserEvent (pSVEvent=pSVEvent@entry=0x7a99270) at /home/master/src/libreoffice/workdirs/libreoffice-5-2/vcl/source/window/winproc.cxx:1959I want that the "OnClick" of the button that is in the form IS NOT TREATED before the "activation handlers" of the form THAT THIS BUTTON IS IN (called in formcontroller.cxx line 1734) are finished executing. if ( bActivated ) { // (asynchronously) call activation handlers m_aActivationEvent.Call(); // call modify listeners if ( m_bModified ) m_aModifyListeners.notifyEach( &XModifyListener::modified, EventObject( *this ) ); }Any suggestion from the experts?Createdbacktrace mentioned inUsing Version: 5.2.0.1 Build ID: 1:5.2.0~rc1-0ubuntu1~xenial1CPU Threads: 8; OS Version: Linux 4.4; UI Render: default; Locale: en-GB (en_GB.UTF-8)I re-ran this test, and now get a Basic runtime error:"BASIC runtime error.An exception occurred Type: com.sun.star.uno.RuntimeExceptionMessage: C++ code threw St13runtime_error: recursion in insertRow"This happens when I close oController in the subroutine below.Sub ExitTable3 (oEV as Object) Dim oController As Object Dim oForm as Object ' Save the value of id3 Set oForm = oEV.Source.Model.Parent gbid3value = oForm.getByName("id3").Text Set oController = Thisdatabasedocument.getFormDocuments.getByName("Table3") oController.close() End SubOn one occasion this was followed by a Base crash.(In reply to tim from)Hi Tim,That error message seems to be appropriate to the situation described by Caolan after his fix was applied in. In other words, the app doesn't crash immediately, but returns an error because insertRow() is being nested within an already running insertRow().As Lionel has also indicated in his, a similar problem occurs with updateRow() which gets called.@Tim :fwiw, I can confirm the Basic error message that you reported :BASIC runtime error.An exception occurred Type: com.sun.star.uno.RuntimeExceptionMessage: C++ code threw St13runtime_error: recursion in insertRow.on OSX 10.11.6Version: 5.3.0.0.alpha0+Build ID: 03f576466c9f110fbef8923604908654d59484a6CPU Threads: 2; OS Version: Mac OS X 10.11.6; UI Render: default; Locale: fr-FR (fr.UTF-8); Calc: groupThe Basic code throws other error messages which cause the Basic IDE to be displayed, which then caused a mutexlock (app hangs) because I'd already closed Forms Table1 and Table3 - sigh.@Tim : if I remove the wait statement, I don't get any error messages any more, or any other visible Basic issues and data entry in your forms seems to work fine.(In reply to Alex Thurgood from)Thanks for keeping at this one!I have gone back to my (stupidly complex) original source of this problem and taken out the work-around I put in place to stop crashes. The work-around was to refuse to exit the whole form (done by selecting a button on the form) when the focus was in the sub-form, and just put the focus on a field in the main form instead. The user then had to exit the form by pressing the button again.So I took out the work-around, and now it works as it should!I'm now on Version: 5.2.1.1Build ID: 1:5.2.1~rc1-0ubuntu1~xenial0CPU Threads: 8; OS Version: Linux 4.4; UI Render: default; Locale: en-GB (en_GB.UTF-8); Calc: groupI'll be using my application for real (as opposed to a slightly artificial test mode) again in a few days time. If all goes well without the work-around I'll close the report, marking it fixed.Is that OK?Thanks to all....(In reply to tim from)Unless Lionel wants to keep this open to explore the asynchronous call/yield problem, then I guess so.I've tested this again on my full system.If I save the subform before attempting to exit the form all is OK.If I don't, and BASE asks me if I want to save the form first, I get:BASIC runtime error.An exception occurred Type: com.sun.star.uno.RuntimeExceptionMessage: C++ code threw St13runtime_error: recursion in insertRowAdding keyword 'bibisectRequest'.
id=89168	In the about dialog, choose 'Show Notice', and it opens, and shows all the content.The problem is that it shows an additional empty page with few horizontal grey stripes, so it looks like if something went wrong, and the user should see something more, but does not.Hopefully just means that we get wrong amout of pages from LibreOffice :-) works for me in current masterI'm afraid there are still other documents that do not work correctly, as there is no implementation of the LOK_CALLBACK_DOCUMENT_SIZE_CHANGED handling; so let's keep it open please, just with a changed summary...
id=105589	I expect auto-save to happen at the intervals I have set in the Options, and to be measured starting from the time of the last save, *especially including* the time I last manually saved.Instead, auto save seems to occur on a fixed interval.I just double-checked this: I saved my document (waited 15 seconds for it to complete), then continued editing. Within 15 seconds, the regular auto-save once again interrupted my work and occurred. (I have set the period to 20 mins).I believe the idea of auto save is to preserve your work, in case of a crash, power failure, or similar.The purpose of setting a time period is to limit the amount of work that might be lost.For a long document, auto save takes long enough to end a 'flow state', and is somewhat disruptive.Having it kick in to save a few seconds of work is intensely annoying. It also means a user cannot avoid auto-save even by being so disciplined that they manually save more frequently than the auto save period they have chosen. With the current method of setting the start time for the time measurement, the auto-save feature is almost annoying enough for me to turn it off and just rely on remembering to manually save, myself.Please consider changing this behaviour. it seems you're using an old version of LibreOffice.Could you please try to reproduce it with the latest version of LibreOffice from?I have set the bug's status to 'NEEDINFO'. Please change it back to 'UNCONFIRMED' if the bug is still present in the latest version.I've upgraded to 5.2.5.1, the freshest available at that URL.I think you're quite right, and this has been resolved. This should I think be moved to Resolved, so I'll try to mark this report as such (rather tahn UNCONFIRMED).No, it's not properly fixed: I just had it happen to me again right now.I have multiple files opened. In my main one, I accidentally held down the Ctrl key instead of the Shift key when I typed "She", and of course saved the file and the letters "he" appeared. I continued editing the main document, and approx. 30 seconds after my Save, the auto-save kicked in again. A 2nd document I had open then performed its auto-save.I have the period set to 15 mins.Is it possible LO gets confused about which documents need auto-saving? Or saves all changed docs if any one needs an auto-save? The auto-save start time is per document, isn't it?Anyway, it was very clear: 30 secs after manually saving, auto-save kicked in again.This is with 5.2.5.1.Hmm. Just experienced another auto-save, less than 2 mins after another manual save of the doc. But it was also less than 5 mins since the 2nd doc I'm working on auto-saved (maybe, 3 mins). So I can't see any pattern to it. Auto-save interval is set to 15 mins.Saved at 16:11. Kept working. Auto-save kicked in at 16:12.And manually saved at 16:26; auto-save kicked in anyway, at 16:28.16:43: secondary document auto-saved. Then I manually saved the main doc (also at 16:43, maybe 10 seconds later), checked that, then made a small change. And at 16:44, the main doc auto-saved again.It's definitely not fixed.From my experiments, I can see each doc has its own individual time at which it gets auto-saved.The secondary doc was auto-saving a minute before the main doc. Saving the secondary document (so it needed no auto-save) did not prevent the auto-save of another working document. (I.e., the events are independent, as they should be.)Nor did saving the main doc within that one minute gap prevent its auto-save: I made a small edit of the main doc, and within 30 seconds of my manual save, the auto-save triggered on the main doc.It's very strange I could not reproduce this behaviour when I started using 5.2.5.1, and thought it was fixed.One very odd thing: the times and sizes don't match what I expected.My main doc is called ShadowHunt-CS.odt; it's 590069 bytes.Secondary doc is ShadowHunt-CS-Q3,thEditors.odt: 171721 bytes.So: small doc is the secondary, large file is the primary. But I noted the time the secondary file was saved (18:15), and when the larger primary file was auto-saved (a minute later, at 18:16). Yet the file size+time pair is the reverse of what I would expect in /tmp:In /tmp, I see:/tmp/lu4682tv3ttn.tmp-rw-r----- 1 luke kendall 171721 Feb 12 18:16 lu4682tv3vcw.tmp-rw-r----- 1 luke kendall 590069 Feb 12 18:15 lu4682tv3vcp.tmpIt says the small doc was saved at 18:16, the larger one at 18:15. This is the reverse of what I observed.Is it possible that LO thinks it's auto-saving one file, when it's saving the other?Oh, and another strange thing: while writing this comment, I just noted that an auto-save occurred on the main doc, ShadowHunt-CS.odt, at 18:31. But in the /tmp directory, the file timestamps are unchanged (although the directory is now 18:31). Does LO write the file, compare if it's the same as the previous one, then remove the just-written file if they're the same?! Why bother comparing? Why wouldn't you just remove the older auto-save instead of the most recent one?In /tmp, at 18:38:drwx------ 2 luke kendall 4096 Feb 12 18:31 lu4682tv3ttn.tmpIn /tmp/lu4682tv3ttn:-rw-r----- 1 luke kendall 171721 Feb 12 18:16 lu4682tv3vcw.tmp-rw-r----- 1 luke kendall 590069 Feb 12 18:15 lu4682tv3vcp.tmpI can't make sense of the timing": it looks wrong. I just noticed I hadn't saved for a while, though making lots of changes. The file was:-rw-rw---- 1 luke kendall 590176 Feb 12 19:21 ShadowHunt-CS.odtIn /tmp:-rw-r----- 1 luke kendall 590176 Feb 12 19:21 lu4682tv3ved.tmpThis was at 19:46: *more* than 15 mins since the last manual save (19:21).At 19:48 I manually saved again:-rw-rw---- 1 luke kendall 589972 Feb 12 19:48 ShadowHunt-CS.odtand afterward, found that the /tmp copy was the same size+time:-rw-r----- 1 luke kendall 589972 Feb 12 19:48 lu4682tv3vf1.tmpYeah, I did the same manual save at 19:57, and the same thing happened:-rw-rw---- 1 luke kendall 589987 Feb 12 19:57 ShadowHunt-CS.odt-rw-r----- 1 luke kendall 589987 Feb 12 19:57 lu4682tv3vf8.tmpYes: the time is now 20:28, last save was 20:10, I've been making changes, but it's not been auto-saved for over 17 mins, even though auto-save interval is set to 15 mins:-rw-r----- 1 luke kendall 590106 Feb 12 20:10 lu4682tv3vfm.tmp-rw-rw---- 1 luke kendall 590106 Feb 12 20:10 ShadowHunt-CS.odtOr now, at 20:32:-rw-r----- 1 luke kendall 590106 Feb 12 20:10 lu4682tv3vfm.tmpI can't make sense of this, but it's certainly not operating when it's supposed to.No wonder I've lost more work than I expected, when LO crashed.Maybe also an interaction with the LO bug that loses files saved (so that it complains it can't find the recovery files after a crash).I noticed these files in /tmp after auto-save of my secondary document had finished:$ ls -lt /tmp/lu4682tv3ttn.tmp | head-rw------- 1 luke kendall 602112 Feb 12 21:04 lu4682tv3vhx.tmp-rw------- 1 luke kendall 601950 Feb 12 21:04 lu4682tv3vhw.tmp-rw------- 1 luke kendall 0 Feb 12 21:04 lu4682tv3vhu.tmp-rw------- 1 luke kendall 57022 Feb 12 21:04 lu4682tv3vhq.tmp-rw------- 1 luke kendall 60064 Feb 12 21:04 lu4682tv3vhn.tmp-rw------- 1 luke kendall 54522 Feb 12 21:04 lu4682tv3vhk.tmp-rw------- 1 luke kendall 44070 Feb 12 21:04 lu4682tv3vhh.tmp-rw------- 1 luke kendall 38679 Feb 12 21:04 lu4682tv3vhe.tmp-rw------- 1 luke kendall 33494 Feb 12 21:04 lu4682tv3vhb.tmp-rw------- 1 luke kendall 113117 Feb 12 21:04 lu4682tv3vh8.tmp-rw------- 1 luke kendall 65612 Feb 12 21:04 lu4682tv3vh5.tmp-rw-r----- 1 luke kendall 540149 Feb 12 20:49 lu4682tv3vgt.tmp-rw-r----- 1 luke kendall 590187 Feb 12 20:34 lu4682tv3vg0.tmpAnd this, about 30 secs later, after auto-save of the main document had happened. Note that the two largest and newest auto-save files are gone:$ ls -lt /tmp/lu4682tv3ttn.tmp | head-rw------- 1 luke kendall 57022 Feb 12 21:04 lu4682tv3vhq.tmp-rw------- 1 luke kendall 60064 Feb 12 21:04 lu4682tv3vhn.tmp-rw------- 1 luke kendall 54522 Feb 12 21:04 lu4682tv3vhk.tmp-rw------- 1 luke kendall 44070 Feb 12 21:04 lu4682tv3vhh.tmp-rw------- 1 luke kendall 38679 Feb 12 21:04 lu4682tv3vhe.tmp-rw------- 1 luke kendall 33494 Feb 12 21:04 lu4682tv3vhb.tmp-rw------- 1 luke kendall 113117 Feb 12 21:04 lu4682tv3vh8.tmp-rw------- 1 luke kendall 65612 Feb 12 21:04 lu4682tv3vh5.tmp-rw-r----- 1 luke kendall 540149 Feb 12 20:49 lu4682tv3vgt.tmp-rw-r----- 1 luke kendall 590187 Feb 12 20:34 lu4682tv3vg0.tmp-rw-r----- 1 luke kendall 170335 Feb 12 20:11 lu4682tv3vft.tmp-rw-r----- 1 luke kendall 44258 Feb 12 19:28 lu4682tv3vei.tmp-rw-r----- 1 luke kendall 37055 Feb 11 22:56 lu4682tv3v5q.tmpNote also that the time and size of the 20:34 file matches that of the main doc, last saved:-rw-rw---- 1 luke kendall 590187 Feb 12 20:34 ShadowHunt-CS.odt, and that whatever the auto-saved file 15mins later (at 20:49) is, it's too small to be a backup copy of the main doc.And after saving the main doc, manually, after the auto-save:-rw-rw---- 1 luke kendall 590776 Feb 12 21:11 ShadowHunt-CS.odtAnd in /tmp, after that manual save:$ ls -lt /tmp/lu4682tv3ttn.tmp | head-rw-r----- 1 luke kendall 590776 Feb 12 21:11 lu4682tv3vic.tmp-rw------- 1 luke kendall 57022 Feb 12 21:04 lu4682tv3vhq.tmp-rw------- 1 luke kendall 60064 Feb 12 21:04 lu4682tv3vhn.tmp-rw------- 1 luke kendall 54522 Feb 12 21:04 lu4682tv3vhk.tmp-rw------- 1 luke kendall 44070 Feb 12 21:04 lu4682tv3vhh.tmp-rw------- 1 luke kendall 38679 Feb 12 21:04 lu4682tv3vhe.tmp-rw------- 1 luke kendall 33494 Feb 12 21:04 lu4682tv3vhb.tmp-rw------- 1 luke kendall 113117 Feb 12 21:04 lu4682tv3vh8.tmp-rw------- 1 luke kendall 65612 Feb 12 21:04 lu4682tv3vh5.tmp-rw-r----- 1 luke kendall 540149 Feb 12 20:49 lu4682tv3vgt.tmp-rw-r----- 1 luke kendall 170335 Feb 12 20:11 lu4682tv3vft.tmp-rw-r----- 1 luke kendall 44258 Feb 12 19:28 lu4682tv3vei.tmp-rw-r----- 1 luke kendall 37055 Feb 11 22:56 lu4682tv3v5q.tmpI hope this information is helpful.LO just crashed on me at 17:25. Last time I manually saved was 16:52.Last date on auto save is the same, 16:52.So I will have lost data because this function simply does not perform as it is supposed to.Surely that makes this bug more serious, and it should have a higher priority to fix: it can lead to data loss when LO crashes.Yeah, just restarted LO and confirmed that I have lost 30 mins of intense work.Very disappointed.
id=43619	Createdsample documentSee the attached fly.odp with a text box with three 1st level paragraphs (Foo, Bar, Baz) with one 2nd level paragraph each (First, Second, Third), with an on-click animation (fly in) grouped "By 2nd level paragraphs" (see context menu of any of the items in the "Tasks" pane's "Custom Animation - Effect Fly In" list, "Effect Options... - Text Animation - Group text").When doing the slide show, the individual 1st and 2nd level paragraphs correctly fly in one by one (Foo; First; Bar; Second; Baz; Third).Now, remove the effect for each of the 1st level paragraphs (Foo, Bar, Baz), via the items' context menu "Remove". When doing the slide show, the first 1st level paragraph (Foo) is correctly displayed right from the start, and the individual 2nd level paragraphs correctly fly in one by one (First; Second; Third), but the remaining two 1st level paragraphs (Bar, Baz) are erroneously not displayed at all.Also, after removing all the 1st level paragraphs' effects, the grouping of the remaining 2nd level paragraphs (as stated at "Effect Options... - Text Animation -Group Text") changes from "By 2nd level paragraphs" to "All paragraphs at once". Manually changing the setting for a paragraph does not work, after closing the "Effect Options" dialog it automatically goes back to "All paragraph at once."(Reproduced with a libreoffice-3-4 build towards LO 3.4.5. On master towards LO 3.5, this cannot currently be tested well, as doing this animated slide show, at least in an unxlngx6 --enable-dbgutil build, soffice.bin aborts with drawshapesubsetting.cxx's makeTreeNode calculating std::distance between singular iterator and end; immediate problem appears to be that maActionClassVector.begin() == maActionClassVector.end() in DrawShapeSubsetting::getTreeNode.) Createdfix the (automatically selected) paragraph groupingWith the attached paralevels.patch, after removing all the 1st level paragraphs' effects, the grouping of the remaining 2nd level paragraphs (as stated at "Effect Options... - Text Animation -Group Text") stays at "By 2nd level paragraphs" and no longer automatically changes to "All paragraphs at once". Manually changing the setting for a paragraph still does not work, however---after closing the "Effect Options" dialog it automatically goes back to "By 2nd level paragraphs."Thorsten ? :-)Stephan Bergmann committed a patch related to this issue.It has been pushed to "master":Fix fdo#43619 Animating only 2nd level paragraphs hides 1st levelPatch looks good, improves things -> pushed.But the original problem is not yet fixed at all.Note thatwas nothing but work-in-progress, astried to make clear. It now unfortunately got committed with a misleading commit message claiming "Fix fdo#43619."Comment onfix the (automatically selected) paragraph groupingpatch is integrated, removing "patch" flag so it does not turnup in bugzilla searches.What I can confirm is that, after removing the effects of the three 1st level paragraphs (Foo, Bar, Baz) the last two (Bar, Baz) are not showing on the slideshow. The patch mentioned fixes the "Effect Options... - Text Animation -Group Text") and it's working fine, but the other issue (Bar and Baz dissappearing) is not fixed. Confirmed on Debian 8 (jessie):Versión: 4.3.7.2Id. de compilación: 8a35821d8636a03b8bf4e15b48f59794652c68baVersión: 4.4.3.2Id. de compilación: 88805f81e9fe61362df02b9941de8e38a9b5fd16Configuración regional: es_ESVersion: 4.4.5.0.0+Build ID: 7847365292bf0c5e35cf94835b46e414dbe4692eTinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:libreoffice-4-4, Time: 2015-06-25_10:22:13Locale: es_ES.UTF-8Version: 5.0.0.1.0+Build ID: e36ca8d3c69d0c08ad28ceea278b05a0af81e102TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:libreoffice-5-0, Time: 2015-06-25_07:19:18Locale: es-ES (es_ES.UTF-8)Version: 5.1.0.0.alpha1+Build ID: a7a95af74badcb745bb1c86c7f9a21444ca12c77TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2015-06-25_09:37:54Locale: es-ES (es_ES.UTF-8)
id=92242	As per, the default StartCenter window no longer displays all of the document launch icons.On OSX, if the user attempts to expand the window by dragging a corner with the mouse, the window autoexpands to a size that overlaps with the OSX Dock.Additionally, this new window size can no longer be reduced by dragging with the mouse from the corner of the window, it can only be reduced in width from the side edge.This is a regression over 4432. (In reply to Alex Thurgood from)Issue still existant in 5.0.0.2 german on OSX 10.10.3.Version: 5.0.0.2Build-ID: a26d58f11b99b6aeddf7f7884effea188cc6e512Gebietsschema: de-DE (de.UTF-8)See attached screenshot.Cannot confirm this in my installation, works for me.Cannot confirm this in my installation, works for me.CreatedScreenshot StartCenter LO 5 RC1/RC2 (german) on OSXThe problem of resizing the StartCenter window spreads to the other application windows, so, e.g. Calc window can not be resized diagonally, even if I make the Dock disappear. The only solution I have found to this is to delete the profile and restart LO.How to reproduce:1) Delete LOdev profile from /Users/myuser/Library/Application Support/2) Start LOdev3) Note how StartCenter does not display all launchers.4) Put mouse cursor at bottom right hand corner of start center window, hover until the diagonal stretch icon is displayed, click and start to drag diagonally outwards and downwards.5) The StartCenter window automatically expands the window to below the Dock.There is no way to resize that window once that maximum position has been reached, other than shrinking the width - no diagonal shhrinkage is possible.I highly suspect that it's related to the Breeze icon theme, because I'm able to reproduce similar behavior with it under Fedora 22 (64-bit). Would be great to hear from Mac users, whether the problem persists there after changing the icon theme, and restarting LO.(In reply to Maxim Monastirsky from)Hi Maxim,Confirming that switching to Galaxy icon theme allows for the windows to be resized.It would appear thatis a duplicate of this bug.***has been marked as a duplicate of this bug. ***I changed the icon size to 32px as recommended. sorry that it took so long. don't go to vacation 3 times in a row.now also the "meaning" of the mimetype symbols is the right one. for me it would be ok. I added remote-documents don't know the name of the new icon for 5.1.andreask committed a patch related to this issue.It has been pushed to "master":Breeze: StartCenter icon size fixed to 32px tdf#93064 tdf#92242It will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Request please this patch also be applied to 5.0.x. As it stands right now, it's impossible to open LO in 1024x768 with the Breeze theme selected (which is our default theme).Cherry picked for 5.0.1 and 5.0.x.andreask committed a patch related to this issue.It has been pushed to "libreoffice-5-0":Breeze: StartCenter icon size fixed to 32px tdf#93064 tdf#92242It will be available in 5.0.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.andreask committed a patch related to this issue.It has been pushed to "libreoffice-5-0-1":Breeze: StartCenter icon size fixed to 32px tdf#93064 tdf#92242It will be available in 5.0.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Migrating Whiteboard tags to Keywords: (notBibisectable)[NinjaEdit]***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***This bug has re-appeared on LO5233 on macOS - re-opening
id=90150	Hi,the page number shown in the status bar, when I scroll up or down, remains unchanged even if the entire previous page is not visible on the screen. The page number changes at the intersection of the different pages which may cause confusion.+ Ubuntu 14.04 LTS - 32-bit+ LibreOffice Version: 4.5.0.0.alpha0+steps to reproduce:- create a document with at least 2 pages;- scroll down to the next page keeping the cursor in the current page(same behavior when scrolling up);- check the page number shown in the status bar when reaching the intersection of two pages.It would be preferable, instead, that this number changes when a certain proportion of the next page is reached.N.B. This bug appear in the bug tracker of openOffice id#80672.thanks. I agree this could be changed/improved.Reproducible with LO 4.4.1.2, Win 8.1Changed the importance in accordance with the Bug Priority Triage FlowchartmassinissaHamidi committed a patch related to this issue.It has been pushed to "master":tdf#90150 : Page numbering in the status bar which may cause confusionIt will be available in 5.0.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.This bug fix is mentioned in the release notes of the coming LibreOffice 5.0 (see release notes). Therefore it would be wonderful if this feature really worked well, otherwise it should not be mentioned in the release notes. In the notes it reads:Another issue inherited from OpenOffice.org—which caused Writer’s status bar to display the incorrect page number when scrolling—has been fixed in LibreOffice. Writer will now update the page indicator when less than the 43% of a page is visible on-screen. tdf#90150 i#80672 Thanks to: Hamidi Massinissa.Jan Holesovsky committed a patch related to this issue.It has been pushed to "master":tdf#92305: Revert "tdf#90150 : Page numbering in the status bar ..."It will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.MassinissaHamidi: I am very sorry, but I had to revert your patch. It was causing a very visible.The change is problematic from the user experience point of view - with that, the user is never sure what page is he/she looking at exactly.The better solution would be to extend the status bar indicator to allow showing the entire range of pages that are visible; like:* only one page visible: "Page 3 of 8."* more pages visible: "Pages 3-5 of 8."The code to do that is SwView::GetPageStr() in sw/source/uibase/uiview/view2.cxx. You'll also need to add the plural version of the string in sw/source/ui/shells/shells.src, search for STR_PAGE_COUNT and STR_PAGE_COUNT_CUSTOM.Thank you in advance for your help!Jan Holesovsky committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#92305: Revert "tdf#90150 : Page numbering in the status bar ..."It will be available in 5.0.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Jan Holesovsky committed a patch related to this issue.It has been pushed to "libreoffice-5-0-1":tdf#92305: Revert "tdf#90150 : Page numbering in the status bar ..."It will be available in 5.0.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=105433	Description:The tooltip "List the existing macros and dialogs" flickers rapidly and annoyingly (my guess is at the refresh rate of the screen) when the Basic Macro Organizer dialog is overlaid over the Basic Macros dialog. As this is the default when the dialog is opened, it is particularly distracting and annoying. Steps to Reproduce:1. Start LibreOffice, open a Writer document.2. Tools > Macros > Organize Macros > LibreOffice Basic3. Click on the Organizer buttonActual Results: As the mouse cursor moves over any of the libraries, the tooltip is displayed and it flickers annoyingly. The flicker disappears if the dialog window is moved outside of the Basic Macros dialog windowExpected Results:The tooltip should not flicker.Reproducible: AlwaysUser Profile Reset: NoAdditional Info:User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:50.0) Gecko/20100101 Firefox/50.0 Also present in Version: 5.1.6.2Build ID: 07ac168c60a517dba0f0d7bc7540f5afa45f0909Threads CPU : 2; Version de l'OS :Mac OS X 10.12.2; UI Render : par défaut; Locale : fr-FR (fr_FR.UTF-8); Calc: groupI might have forgotten to mention that you need to enable Tooltips under Preferences on OSX (or Tools>Options on other OSes)I can also reproduce this behaviour in the Spelling and Grammar dialog, by opening the Options dialog window over the top of the Spelling and Grammar dialog.Changed title accordingly. Affects dialogs where the the sub-dialog is overlaid over the hierarchically superior dialog.Also reproducible in Version: 4.1.4.2Build ID: 0a0440ccc0227ad9829de5f46be37cfb6edcf72Problem also present in LibreOffice 3.3.0 OOO330m19 (Build:6)tag libreoffice-3.3.0.4Inherited from OOoIn addition to having 'extended tooltips' enabled you also need to have help installed. :DSo i tested 5.0, which i have help installed for, and dont see the issue, so its possibly an osx only issue.Version: 5.0.3.2Build ID: 1:5.0.3~rc2-0ubuntu1~trusty2Locale: en-US (en_US.UTF-8)@Steve: Can you check this out to confirm?@Alex: Could this be a OSX version issue on a newer release?(In reply to Alex Thurgood from)One must have Extended Tooltips activated (Tools > Options > LibreOffice > General)In my version (Ubuntu Linux, 5.4 master) the tooltip is poping up irregular, but no constant annoying flickering.confirmed and yes this is annoying.Version: 5.4.0.0.alpha0+Build ID: 9e7526044c8fa6b006b0cb791d15f2476c96ebf2CPU Threads: 4; OS Version: Mac OS X 10.12.2; UI Render: default; TinderBox: MacOSX-x86_64@49-TDF, Branch:master, Time: 2017-01-14_04:23:59Locale: de-DE (de_DE.UTF-8); Calc: group→ NEW@Alex, @Steve: If you can do a screencast, that would be great.workforme w Version: 5.4.0.0.alpha0+Build ID: 789ed159fb03eef26c991f361380d0eb7b509cd9CPU Threads: 4; OS Version: Mac OS X 10.12.3; UI Render: default; TinderBox: MacOSX-x86_64@49-TDF, Branch:master, Time: 2017-02-03_01:08:49Locale: de-DE (de_DE.UTF-8); Calc: group@Alex: please verify and re-open if I am mistaken.I can still reproduce this inVersion: 5.4.0.0.alpha0+Build ID: 6c4310cc176c02624f5fa94fb50fec6050ce904bCPU Threads: 2; OS Version: Mac OS X 10.12.2; UI Render: default; Locale: fr-FR (fr_FR.UTF-8); Calc: groupMy test version is possibly just slightly older than yours (by a day or so). Will rebuild and test again.For repro steps, tooltips need to be activated.
id=93889	This one is a bit of a joke:sc/source/ui/dbgui/sfiltdlg.cxxsets up an idle handler that runs all the time: pIdle = new Idle; // FIXME: this is an abomination pIdle->SetPriority( SchedulerPriority::LOWEST ); pIdle->SetIdleHdl( LINK( this, ScSpecialFilterDlg, TimeOutHdl ) ); pIdle->Start();The comment: // Hack: RefInput-Kontrolle pIdle = new Idle;Is rather accurate ;-)Reading the actual idle handler: // alle 50ms nachschauen, ob RefInputMode noch stimmt if( (_pIdle == pIdle) && IsActive() ) { if( pEdCopyArea->HasFocus() || pRbCopyArea->HasFocus() ) { pRefInputEdit = pEdCopyArea; bRefInputMode = true; } else if( pEdFilterArea->HasFocus() || pRbFilterArea->HasFocus() ) { pRefInputEdit = pEdFilterArea; bRefInputMode = true; } else if( bRefInputMode ) { pRefInputEdit = NULL; bRefInputMode = false; } }Unless there is some cunning operator overloading or mis-use of the HasFocus() method somehow - then all of this could easily be renamed into a:"SyncFocusState()"method - and we can audit the code to find where we need to call that (ie. before we use the pRefInputEdit or bRefInputMode members.Might be nice to prefix the member variables with 'm' or 'm_' to taste.Then rip the idle handler out completely and all the muck that goes with it.Worth checking the git annotate to see why that's there too I suspect =) perhaps there is a helpful bug report somewhere.Thanks (for saving many people's batteries) =) Migrating Whiteboard tags to Keywords: (easyHack, difficultyBeginner, skillCpp, topicCleanup)JanI is default CC for Easy Hacks (Add Jan; remove LibreOffice Dev List from CC)[NinjaEdit]Jaskaran,I was wondering if you're still working on this; if not, I'd like to make an attempt.I have committed a patch to fix this issue. Kindly, review it. Thanks.Jaskaran committed a patch related to this issue.It has been pushed to "master":tdf#93889 Remove a busy loopIt will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Now since a patch has been successfully merged, Shouldn't this bug be marked RESOVLED?Sounds good to me - though I suspect there are more of these around the place =)Eike Rathke committed a patch related to this issue.It has been pushed to "master":Resolves: tdf#99360 Revert "tdf#93889 Remove a busy loop"It will be available in 5.3.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.That simply didn't work, see.Eike Rathke committed a patch related to this issue.It has been pushed to "libreoffice-5-2":Resolves: tdf#99360 Revert "tdf#93889 Remove a busy loop"It will be available in 5.2.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Eike Rathke committed a patch related to this issue.It has been pushed to "libreoffice-5-2-0":Resolves: tdf#99360 Revert "tdf#93889 Remove a busy loop"It will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=33060	The extensions installed on LibO installation time cannot disabled through UI, at least on win7.It is not possible even with administrator role.The needs for disabling some extensions, could happen with report builder extension.If you want to use "old" type report wizard, in OOo you disable report designer extension, run old report wizard, create report. Later you can allow report designer extension and create report with wizard based on report designer. @Zoltán:Still a problem?If yes, please contribute additional information:- What extension(s) are we talking about? - What does "is not possible" mean? Locked symbol? No reaction? Error message?All extensions locked and this cause that "Report builder" 1.2.1 extension can not be disabled to use "old" report wizard.It is a RC3 problem.CreatedScreenshot from LibO's Extension ManagerI may know what's being spoken of here. In LibO, Report Builder 1.21 from Oracle is showing up in the Extension manager. I am not sure if this is installed from LibO or Oracle Open Office. Does LibO detect OOo or Oracle Open Office extensions? It's either installed with LibO or LibO is detecting it from another install.I have attached a screenshot of LibO's Extension Manager. As you can see, the extension is locked. I believe Zoltán wishes to disable the extension and run a Wizard built-in to the program.This is similar to what I am talking about here:Hmmm, I think that this is no bug, maybe wanted....IMHO your enhancement is a great idea...Yes, it really might cause problems that you are forced to use bundled extensions instead of other ones you prefer. But currently there seems to be some decision that those extensions are more or less part of LibO and should not be unselectable in Extensions manager.@Zoltán Reizinger:Did you already try to unselect a bundled extension you dislike during installation?I install LibO parallel to many version of AOO/LibO versions to test it under win7. I usually use msiexec/a installation_file.msi option which is not allows me to unselect extensions, I can live with this situation. But the original question was to disable report builder to allow creation of "old" type of reports, and enable later, to crate report-builder reports. If I remove it from installation, later I can not add it, because no report builder extension is available on LibO extension site, because it is bundled. :(It was previously discussed how bundled extensions cannot be removed. However, the real issue should be that they cannot be *disabled*.Of course, bundled extensions cannot be removed from LibreOffice, since they are system-wide installations and part of system package management.. so that makes sense.Extension Manager currently does not live up to its name as it barely manages anything.On a minor note:Since all extensions are bundled upon first-run, the column of "lock" symbol icons is hard to intepret for a user, since there are no alternatives to the lock and it looks like a "secure" or "signed" icon.Please have a look here at how the icons are simply locks all the way down:(In reply to)Disagree: you can restart the installation in repair mode and reinstall the missing extension.Best regards. JBFNever confirmed by QA team, setting to UNCONFIRMED.I think that a disable/enable feature to turn on/off bundled extensions at will is a legitimate enhancement requestIs there consensus on this request? If so, I may handle it while I am still working on the extension manager.+1 from me as i dont see why i shouldnt be able to disable the bundled extensions that i would never use, like the french and spanish dictionaries, which i could build LO without.(In reply to Muhammet Kara from)I see no problem with it.This bug dates from a time when LO routinely bundled quite a number of extensions. That has changed significantly since:* "Code-based" bundled extensions (incl. the report builder mentioned in, see) have been moved into the code proper. The only such extensions that appear to still be bundled routinely with LO installsets are nlpsolver and wiki-publisher (cf. 'git grep -e --enable-ext- distro-configs/LibreOffice*.conf'). Not sure what were the reasons to not either turn them into code proper too or drop them from installsets.* Dictionaries are still distributed as bundled extensions. The original rationale for that was that these could have different update cycles than LO (resp. OOo, at that time) itself, allowing an admin to update these extensions in an existing LO installation.I'm not sure whether it is explicitly stated anywhere, but one obvious use case for bundled (and/or shared) extensions is to let an admin install an extension that enforces some feature (e.g., makes some configuration entry read-only) so that users cannot override it. That use case would be negatively affected by allowing users to disable bundled (and/or shared) extensions. (And the recently added safe-mode, <>, may negatively affect this too; would need looking into.)My suggestion would be to leave things as they are.(In reply to Stephan Bergmann from)Is there any objection to this? Should we close the bug as WONTFIX?As there was no further input past, I'll close as WONTFIX now. Feel free to reopen if there's new insights.(In reply to Stephan Bergmann from)My ha'penneth worth is that currently on LibreOffice for MacOS, there is no way of removing the bundled dictionary stubs for the many *non-installed* languages which pollute the Extension Manager - see screenshot.CreatedScreenshot of bundled dictionary extensions that are not even installedI would be inclined to re-open this bug as a result and set to OS(ALL)The OSX dictionary stub bundled extension problem is known asCurrently, in a production release of LO5233, I count 50 bundled dictionary extensions that are allegedly installed and displayed as such in the Extensions Manager, when in fact I have (and use) only 3.This makes use of the Extension Manager even more painful, as having to scroll through the whole list of irrelevant entries is a PITA.OK, I'll risk it for some flames - re-opening(In reply to Alex Thurgood from)How is that relevant for this issue about /disabling/ bundled extensions? Disabled extensions would not disappear from the Extension Manager.(In reply to Stephan Bergmann from)Having a visual cue corresponding to a disabled extension would vastly improve the UI experience in this regard, as I could simply ignore those that are disabled. Scrolling through the list would be faster, even if still painful. Even better would be a filter for disabled extensions, that allowed them to be hidden from view.(In reply to Alex Thurgood from)A better solution might be to untick the checkbox for bundled extensions by default, so that only shared and user extensions are shown, unless you activate the bundled checkbox. Maybe even hide shared extensions by default.(In reply to Alex Thurgood from)But adding a visual cue for disabled extensions is not in the scope of this issue (about disabling bundled extensions). If you see room for improvement afteris eventually fixed, I'd suggest filing specific issues for that.
id=73596	CreatedFile containing indexIf we open a docx file containing index (alphabetical index) those are loaded as normal text instead of alphabetical index.When we save the same file, index information is lost. Nikhil Walvekar committed a patch related to this issue.It has been pushed to "master":fdo#73596 Added support to import and export Index from docx.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Vinaya Mandke committed a patch related to this issue.It has been pushed to "master":fdo#73596 [DOCX] Multiple Columns in IndexThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Vinaya Mandke committed a patch related to this issue.It has been pushed to "master":fdo#73596 [DOCX] Auto Columns in IndexThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Nikhil Walvekar committed a patch related to this issue.It has been pushed to "master":fdo#73596 Added support to import and export \r,\h Index flags.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Vinaya Mandke committed a patch related to this issue.It has been pushed to "master":fdo#73596 [DOCX] Index:distance between columnsThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Looks like the fields are correctly exported back to .docx.Though a strange thing is going on when updating the roundtripped index.If you update the roundtripped index in word, a new line is added between the previous paragraph ('On the Insert tab, the') and the index. As far I tried, I can't delete this new line.Bug in Word or somewhere in the roundtripped file :)? Looks like the original file doesn't have this behavior.Kind regards,JorenClosing this issue as it is no more reproducible on latest LO master dated 17th April 2014.Reopening this Issue as all Index switches are still not supported.All available switches::\b \c \d \e \f \g \k \l \p \r \s \y \zCurrently supported:-\r \c \e \fDescription of the switches:-Commit for \f:Does not look like an easyHack.Please when adding easyHack also add topic<foo> (if relevant), skill<foo>, difficulty<foo> (if known).
id=77490	CreatedExample Japanese text document and resulting PDF in zip fileWhen exporting a vertical-text document to PDF, the character orientation changes, so that it becomes a plain left-to-right document rotated by 90 degrees instead of a vertical text document.* Create new text document.* Paste in plain text copied from some source, say Japanese Wikipedia.* In Format->Page change the text direction to "right-to-left (vertical)".* Choose proper Asian font to ensure proper metrics, make sure the text flows properly from right to left (using the text direction buttons if necessary).* Export to PDF. The characters are all rotated by 90 degrees.An example document (content copied from the LibreOffice item in Wikipedia) and the resulting PDF are attached. Tested the attached file in Linux Mint with LibO 3.3.0, 4.2.4, and 4.3 beta 2 and unfortunately couldnt reproduce. Also tested 4.2.4 on Windows 7 and still couldnt reproduce. Likely another mac only font issue.@Herouth: had this been showing correctly in previous version of LibreOffice?I haven't tested it before, so just now I downloaded a copy of LibreOffice 3.3.4 and tested the same document, and the result is the same.Reproduced on OS X 10.9.3 LO4.3beta2.The exported PDF indeed chances character orientation.NEW and adding "osx only" to title.A workaround, maybe also a hint to the person attempting to solve this:I ran into the same problem, but could produce a .pdf with correctly oriented letters by using the pdf output option in the print dialog instead of Export to PDF.(In reply to Tobias Schlüter from)Printing to PDF(a) Causes the loss of cross-references and table-of-content links in the document.(b) Is good only for printing. The text is not contiguous, you can't select a sentence and copy it, for example. The selection simply doesn't follow the vertical lines, which it does in the PDF exported directly from LibreOffice.CreatedActual behaviorHow to crate this fileWith LibreOffice 5.0.3 for Windows, 1. Create a new Writer document2. Go to [Format] > [Page...] > tab: [Page] -> Set "Text direction" to [Right-to-left (vertical)] then click [OK]3. Type 电脑 ("a computer" in Chinese) in the document -> You will see these two characters appear vertically with no rotation -> Latin characters may rotate 90 degrees which may be an expected behavior4. Click [Export as PDF] -> The Chinese characters are being rotated 90 degrees.Createdexpected behavior in ChineseTaking the same steps as "actual_exportPDFchineseRotates90degrees.pdf" except the last one: Print the document with any third-party PDF printer. In this document I used "Bullzip" and got the expected result, i.e., the two Chinese characters "电脑" has *not* been rotated."Export PDF rotates Asian language characters 90 degrees if text direction is set to vertical"IMPORTANT. This issue has been also confirmed with - Other Asian languages (Chinese (Simplified), in addition to Japanese)- Other platforms (Windows and Linux)Test Environment.- LibreOffice 5.0.3.2 Portable for Windows: Chinese (Simplified), Japanese- LibreOffice 5.0.4 for Linux: JapaneseHow to Replicate the Issue (easy): - See my note dated 2015-12-21 05:38:05 UTC- The one in the initial note by Herouth Maoz dated 2014-04-15 15:52:10 UTC sounds right.Can't reproduce on 5.3.0 beta1 in Windows.I can no longer replicate the issue either. * LibreOffice 5.2.3.3 (US-English) * Windows 7 64-bit (US-English)Maybe it's safe to assume the issue has been resolved in the recent versions.Tested on LibreOffice 5.2.3.3, The issue has NOT been resolved on Mac OS X, on which I originally reported it.I have no idea why it was decided it was an "all platforms" issue. It is strictly a Mac OS X bug, please test it only on Mac OS X, and please do not close based on testing on any other platform.It will be interesting you test 5.3.0 beta to confirm if new layout engine have any influence on the output, as users that reported the same problem on other platforms seems to no longer have this problem.
id=76227	Problem description: Added problem, you pull down menus don't include the latest versions...Steps to reproduce:Downloaded the Updated files and extracted both separate files, and extracted them. Changed to the RPMS directory to update, and it fails with the dependencies.[root@setzco LibreOffice_4.2.2.1_Linux_x86-64_rpm]# cd RPMS/[root@setzco RPMS]# rpm -Uvh *.rpmerror: Failed dependencies: libobasis4.2-en-US <= 4.2.1.1-1 is needed by (installed) libobasis4.2-en-US-help-4.2.1.1-1.x86_64Copied the Help RPM from the helppack RPM from the other directory.[root@setzco RPMS]# cp /home/msetzerii/data/LibreOffice_4.2.2.1_Linux_x86-64_rpm_helppack_en-US/RPMS/*.rpm .Reran the update, and now it works fine.[root@setzco RPMS]# rpm -Uvh *.rpmPreparing... ########################################### [100%] 1:libreoffice4.2-ure ########################################### [ 2%] 2:libobasis4.2-core01 ########################################### [ 4%]Current behavior:Doesn't work to Install as past versions did.Past Versions would install the program, and then run the update the helppack.Expected behavior:Either the same as past, or just included the helppack in the install to make it work. Operating System: FedoraVersion: 4.2.1.1 release ***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Okay, now this is embarrassing. I posted the following over on Red Hat for LibreCAD:$ su root -c "rpm -Uvh LibreOffice_4.3.4.1_Linux_x86-64_rpm/RPMS/*.rpm" Password: error: Failed dependencies: libobasis4.3-en-US <= 4.3.3.2-2 is needed by (installed) libobasis4.3-en-US-help-4.3.3.2-2.x86_64 But it is not missing: $ rpm -qa libobasis4.3-en-US libobasis4.3-en-US-4.3.3.2-2.x86_64 That sure look "<= 4.3.3.2-2" to me.And they answered me (what a bunch of nice guys)!I'm really not sure how you ended up here, this is a closed bug on Librecad (not LibreOffice). That said, I'm going to try to guess at your issue: You're updating from a directory full of rpms for LibreOffice 4.3.4.1. What the error is saying is that in the transaction, libobasis4.3-en-US gets updated from 4.3.3.2 to 4.3.4.1, but libobasis4.3-en-US-help does not, leaving it with an unresolved dependency on the old libobasis4.2-en-US (4.3.3.2), and failing the transaction (because you don't want broken dependencies). I would look in that directory and see if libobasis4.3-en-US-help is in there, I suspect it is missing. If that package went away in 4.3.4.1, it _should_ have been properly Provided/Obsoleted by something else in the package set (likely libobasis4.3-en-US), but since that clearly isn't happening, you might have to manually remove libobasis4.3-en-US-help before trying to update again: su root -c "rpm -e libobasis4.3-en-US-help"Is there something here that will help you guys?Many thanks,-TBut I'm betting that package is still there and just didn't get downloaded into your directory for some reason.Hope that helps.***has been marked as a duplicate of this bug. ***(In reply to Todd from)AFAIK helppacks and langpacks are distributed separately from the primary bundle of a LibreOffice installer. Example:master~2015-01-20_16.05.21_LibreOfficeDev_4.5.0.0.alpha0_Linux_x86_rpm.tar.gzmaster~2015....rpm_helppack_en-US.tar.gzmaster~2015....rpm_langpack_en-US.tar.gzmaster~2015....rpm_sdk.tar.gz If the help was installed with a dependency on 4.3.4.1, I'd imagine that removing 4.3.4.1 would also remove any dependent packages that didn't have available upgrades (e.g. 4.3.4.1-help). You mentioned that past versions upgraded the help as well -- were those updates from RH or from LO servers?This is with the released updates from LibreOffice site. Extracting all of the released updates for some time now fails as is. You extract the main one, and it will not install due to the dependence. Simply copying the rpm file from the help archive into the same directory as all the others, and the running the update works just fine. I guess one could go thru the process on uninstalling the program and the help, and then manually doing the update of the program and then the help. But why put out something that doesn't just work. Why not just include the help file in the batch as one simple package.(In reply to Michael Setzer II from)1+Look what just worked:rpm -Uvh LibreOffice_4.4.0.3_Linux_x86-64_rpm_helppack_en-US/RPMS/libobasis4.4-en-US-help-4.4.0.3-3.x86_64.rpm LibreOffice_4.4.0.3_Linux_x86-64_rpm/RPMS/*.rpmInstalled perfectlyThe dependency is designed to avoid installing a new LibreOfffce with an old help-pack. If you want to upgrade core LibreOffice, you will need to download the separate (to save download size - those things are in aggregate 100's of Mb small) help pack that you previously installed and upgrade both in tandem.Looks like this works as designed, but perhaps I'm missing something.(In reply to Michael Meeks from)Hi Michael,What yo are missing is that installing and upgrade should abe just that. No trouble shooting, no research, no work arounds, no "rpm --nodeps" should be involved. This bug should not be closed until you accomplish that.I see two ways of doing that, 1) include both together, or 2) remove the dependency.Many thanks,-TIf it is a design issue, then it is not consistent, since the Windows version installs the new version with no problem when an old help file is installed? So, why does the linux version not work. The help back is only 6M, so either including it in the original package, or making it not required like windows?I generally, always install it on both, but windows doesn't require it?At the moment, one has to download both program and help file, and copy the help file rpm file into the program RPMS directory, and then do rpm -Uvh *.rpm, or perhaps uninstall the program and help files, and then reinstall them separately. Think may users would try to install, and when they get the dependency error just give up.Hi Michael, (nice name incidentally) :-)Consistency with windows - which has no even half-way decent package management or dependency setup at all is not really a goal. As & when Windows has a sane package management system it's an option of course.Au contraire - it does work =) Then again - if -you- want to help patch this issue things change: people with real, tested code changes can make a difference. I have some sympathy with the idea that the help doesn't really change that significantly across minor versions; so potentially loosening the requirement there might be helpful. But code first; not bug status wars - which just irritate people.Ethnocentricty is not a crime; but why would your language (of 100+) be privileged to be bundled in the original package - if you multiply the 'only 6Mb' by >100 languages, you have over half a Gb. That is not attractive to tack onto the existing ~200Mb package. Of course, we could up-load 100's of Gb by having separate packages for each language - but this is a scalability, up-load efficiency, and then server/mirror utilization disaster area. That's why we don't do it ;-)There should be no need to install the help; you can use on-line wiki-help in either case.Sure - so manual package management on Linux sucks to the point that only some tiny fraction of our users bother to not use their distro packaging, some even smaller set bother to install the on-line help - this is a corner-case.Again - I think its unlikely; but I'm glad you're concerned about this use-case. I imagine fixing it is a matter of reading up on the public EPM docs, and then wrestling with the EPM packaging code and-or solenv/bin/make_installer.pl and it's spawn. I'd love to see a patch to slightly relax the dependency (it will still affect people updating through x.y versions though) - but lets leave this bug closed until then.Thanks for your feedback.I can see your points, but one thing that would make it much better from my point would be to make the help file, so that it would extract the file into the same RPMS directory as the full update. As it is, one has to extract the Main update, and then extract the Help, and then copy the Help RPM into the directory. If help was setup to use the same directory, one could just extrat the two files, and then run rpm -Uvh *.rpm and it is done. Just downloaded the new version, and did these steps.tar -zxvf LibreOffice_4.4.1_Linux_x86-64_rpm.tar.gztar -zxvf LibreOffice_4.4.1_Linux_x86-64_rpm_helppack_en-US.tar.gz cp LibreOffice_4.4.1.2_Linux_x86-64_rpm_helppack_en-US/RPMS/libobasis4.4-en-US-help-4.4.1.2-2.x86_64.rpm LibreOffice_4.4.1.2_Linux_x86-64_rpm/RPMS/cd LibreOffice_4.4.1.2_Linux_x86-64_rpm/RPMSrpm -Uvh *.rpm(In reply to Michael Setzer II from)This worked for me:rpm -Uvh LibreOffice_4.4.1.2_Linux_x86-64_rpm_helppack_en-US/RPMS/libobasis4.4-en-US-help-4.4.1.2-2.x86_64.rpm LibreOffice_4.4.1.2_Linux_x86-64_rpm/RPMS/*.rpmI get this, but I am a computer professional. A standard user would be beside himslef.
id=100000	to celebrate all the teams good work :)I hope someone can confirm this issue ;) how long did you wait to get that bug number? *g*Although this large number has their dark side, it helps to have the feet on the ground. The good side, it is a sign of activity that shows at the same time how many individuals are willing to collaborate.We can be happy with what has been achieved, and of course be optimists about the future. :)I think the importance of this issue is under-rated/confirmedVersion: 0.1Build ID: 0815Threads: 0Tinder: in the boxLocale: de-DE (de_DE)confirmed for all versions, operating systems and language packages ;-)This should be listed at the top of the "most exciting bugs" list Cu in BrnSeen this fixed. Mood was splendid, food excellent, if only a bit too little of it.Is this bug going to fixed at FOSDEM as well? ;-)FOSDEM broke the fixed state.
id=38531	Reproduce :1. Create somes tables with Legend.2. Create simple character style (set color to red)3. Insert Index of Type : Index of tables4. In "entries" tab Selected the "T" of the "Tabulation"5. Choose the previously created character style.The tabulation goes red but not the following page number too.The expected behavior is that only the tabulation must use the character style. CreatedSample files demonstrate the bug*The tabulation goes red but the following page number too.Always occur withLibreOffice 3.5.5.3 Version ID : 7122e39-92ed229-498d286-15e43b4-d70da21Reproduced in 3.6.1 on Fedora 64 bit using attachmentWorkaround: place one space after tab and assign needed style to it. For example assign style Standard. And numbers will have this style.Still happens with Version 3.6.3.2 (Build ID: 58f22d5) On Mac OS X Lion 10.7.5Hi, this is not a bug, you need to apply a style to the page number. In your sample, it has no style when you click on it. - edit the index- go under Entries tab- click on Page number (#) in the rule- click on the drop down list in front of Character style and assign Page number. otherwise it will inherit the tab style - Closing as works for me - SophieBug always occur with 4.3.I disagree with you Sophie. It does not seem natural to me that the character style propagates to the following items.Also when I choose "Default Style" for the page number, it does not work. I must create a style only to tell libroffice not to use a style that I have defined on another element. For me it is a strange behavior.I agree with Fabien, this seems broken as it's inconsistent.When you apply a style to the name of the chapter, then it doesn't propagate to the end of the line.
id=77284	CreatedSetUpWizardIcons250%DPIProduct Name: LibreOffice version 4.2.1.1Repro Environment: Windows 8.1 x86/x64Description of the Problem:Icons do not resize when the screen is scaled to 250%DPIDetailed Steps to Reproduce the Problem: Prerequisites:Steps to enable DPI scaling:1. Press Windows+S or swipe from the right and select the Search charm2. Type “Make text and other items larger or smaller” and select the result3. Select “Let me choose one scaling level for all my displays”4. Select “Custom sizing options”5. Select the desired scaling6. Sign out and sign back in to apply the scaling settingsRepro Steps:1. Apply 250% DPI2. Launch the Setup WizardActual Results: Icons do not resize when the screen is scaled to 250%DPITester/Developer Notes: You can learn more about updating your application for High DPI on MSDN <> and at the Channel 9 Build session Making Your Desktop App Shine <> on High-DPI Displays may be somewhat related, as this also requires high resolution icons...I believe this has been fixed in 4.2.3 and later. Can you verify?CreatedInstaller screen shown at 250% magnification in Windows 8.1I tried this and the bug can still be reproduced in LibreOffice 4.4.0.3 on Windows 8.1 64bit (see attached screenshot 113708).
id=103493	Description:In my spreadsheet (downloadable here:) the user needs to copy the sheet named "Character Name". Lately this is not possible anymore. See this history:In version win x86 4.4.7.2: the user can copy as many times as he likes and is able to save the document.In version 5.0: the user can copy this sheet 1 time and save the document without a problem. After a second copy the save process gives a Write Error message. After restarting Calc the user can copy the sheet again 1 time and save. etc.In version 5.1 and above: when the sheet is copied and you save the document then the application crashes. This is also in 5.3.0.0alpha1Steps to Reproduce:1. Copy sheet "Character Name" to "Character Name_2"2. (Optional) Copy sheet "Character Name" to "Character Name_3"3. SaveActual Results: application crashExpected Results:saved documentReproducible: AlwaysUser Profile Reset: NoAdditional Info:User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:49.0) Gecko/20100101 Firefox/49.0 I get the following errorError saving the document LotroPlan 3.8:Write Error.The file could not be written.in Version: 5.3.0.0.alpha1Build ID: f4ca1573fcf445164c068c1046ab5d084e1b005fCPU Threads: 4; OS Version: Linux 4.2; UI Render: default; VCL: gtk2; Locale: ca-ES (ca_ES.UTF-8); Calc: groupCreatedsampleit looks like the error I'm getting can't be reproducible inVersion 4.1.0.0.alpha0+ (Build ID: efca6f15609322f62a35619619a6d5fe5c9bd5a)So i'm creating another bug for the error problem in linux.Someone must confirm this one in windows thoughOuch, it looks like a get the document recovery dialog after restarting 5.3.0.0.alpha1, so move it to NEW.Createdofficeotron diagnoses 400000 errors in the attachmentOf course, input errors do not excuse the crash, but the may be acause. This is from officeotron 0.7.4 running on debian-stretch ...On Vista in win5.3 bibisect repository with source hash 6fe0706(committed 2016-11-05), I copied that worksheet twice and then savedthe file. It took several minutes (I did not hang around), buteventually Calc became responsive again, and I was able to close theprogram normally.(In reply to Terrence Enger from)AFAIK officeotron doesn't validate ODF 1.2 extended, hence all extension namespaces are considered errors.The validator of choice is ODFValidator, seeThank you, Eike, for the pointer to ODFValidator. Unfortunately, thefirst server reports "internal server error" and the second presents ajava exception report headed "HTTP Status 500 -org.apache.jasper.JasperException: javax.servlet.ServletException:java.lang.OutOfMemoryError: Java heap space". So far as I canremember, I have never had good results from ODFValidator.Note: the only real error visible in the attached officeotron validation excerpt, an empty style:text-position="" attribute, is fixed with@Terrence: ODFValidator can be run locally as well. Might be the attached document is too large for the server instance.(In reply to Xisco Faulí from)Were you by chance using a dbgutil build to test? Asking because I ran into an assertion with a dbgutil build that forces the application to crash:sax/source/expatwrap/saxwriter.cxx:1143: virtual void {anonymous}::SAXWriter::endElement(const rtl::OUString&): Assertion `aName == m_pSaxWriterHelper->m_DebugStartedElements.top()' failed.Which would explain your document recovery. I don't get a crash in a non-dbgutil build, but I do get the error message fromas well.Trying to take a stab at this..I lately don't experience an immediate crash after a second copy with a modified version of the spreadsheet.However, I still do have them when I make a larger number of sheet copies.It's like the size of the document does matter in this. After a certain point I can only copy/save with a reload in between.Saving corrupts something which makes the next save crash the application?It's some combination of drawing layer objects on that 'Character Name' sheet, i.e. comment boxes, hidden drawing objects and hidden images, that if copied twice on save makes obtaining some properties for the images fail, which leads to an exception and thus saving fails. I'm currently trying to strip that huge document down to something more narrow which still exposes the failure.Createdstripped down version of the test case documentThis document has only one table with comments and hidden drawing objects and images. When copied twice and saving the Write Error still appears.Formatting and formula cells have been deleted, but oddly deleting the few remaining text cells makes the bug disappear.The (first) exception thrown is under xPropSet->getPropertyValue("GraphicStreamURL") in xmloff/source/draw/shapeexport.cxx XMLShapeExport::ImpExportGraphicObjectShape()(and for properties "GraphicURL" and "ReplacementGraphicURL" as well if one places each in try/catch blocks for testing purposes).Interestingly these warnings are also triggeredxmloff/source/draw/shapeexport.cxx:648: exportShape callings do not correspond to collectShapeAutoStyles calls!: com.sun.star.drawing.CaptionShapethat seem to be related and a bunch ofxmloff/source/draw/shapeexport.cxx:626: XMLShapeExport::exportShape(): no shape info collected for a given shapeEike Rathke committed a patch related to this issue.It has been pushed to "master":Resolves: tdf#103493 copying note captions needs a completed destination sheetIt will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Eike Rathke committed a patch related to this issue.It has been pushed to "libreoffice-5-3":Resolves: tdf#103493 copying note captions needs a completed destination sheetIt will be available in 5.3.0.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Pending reviewfor 5-2Eike Rathke committed a patch related to this issue.It has been pushed to "libreoffice-5-2":Resolves: tdf#103493 copying note captions needs a completed destination sheetIt will be available in 5.2.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Thank you!Is it already available in any build? I've tested the original document with [], but I'm still getting the same problem on the 5th sheet copy:1. copy sheet "character name" before "jewelry": "character name_2"2. save3. copy sheet "character name" before "jewelry": "character name_3"4. save5. copy sheet "character name" before "jewelry": "character name_4"6. save7. copy sheet "character name" before "jewelry": "character name_5"8. save9. copy sheet "character name" before "jewelry": "character name_6"10. savecrashBuilds from 2016-11-29 should have it included.Btw, for dev-builds it helps if you include the Help->About information like Build-ID.However, I don't encounter a problem with your scenario. Might it be that with the 32-bit version your system simply runs out of memory during save? If so, you could try a Win-x86_64 build once available, currently there isn't.I don't know.. I have a 16gb system, but with win32 I guess applications have 4gb. It could be.By the way, I don't know if this is related, I was just testing with the latest builds and I noticed that saving my original document is very much broken now.When I don't make any changes and just save and reload the document then weird things have happened to the "character name" sheet. SeeAlso a large number of lines have been inserted further down: empty lines but with comments from top section.I don't have this corruption with "fresh" win32 Version: 5.2.3.3Build ID: d54a8868f08a7b39642414cf2c8ef2f228f780cfTesting win32 and x64 version 5.2.3.3 results:win32: fatal error after 5th copyx64: fatal error after 5th copySo no difference concerning memory there I guess.(In reply to gisel.avaleazar from)Unrelated, and probably fixed withHello again.I've done the same test again with version: 5.3.0.0.beta1+ (x64)Build ID: 7f47d68c4310b8bae09286a81036a6fa669a170 (dec 8th) and getting the same result again (fatal error after 5th copy).I've also done the same test on a win32 AMD system using the win32 version with the same result.Results for "Version: 5.2.4.2 (x64)Build ID: 3d5603e1122f0f102b62521720ab13a38a4e0eb0":1) Weird effects () have disappeared.2) Still Fatal Error at saving after 5th character sheet copy.@giselplease open a new clean bug report about the residual issues and put this one under "See also"
id=96426	==Summary==The operator for the intersection of two ranges is '!' in Calc A1 formula syntax and ' ' <SPACE> in Excel A1 formula syntax. With the appropriate formula syntax selected, a range intersection using '!' in Calc A1 syntax works, but a range intersection using <SPACE> in Excel A1 syntax gives an error.If the ranges are specified indirectly as "names", and there are parenthesis round the operation, the error is Err:508 (Pair missing). With no parentheses it gives Err:509 (missing operator).If the ranges are specified in Excel A1 syntax (not as "names"), the error is always Err:509 (missing operator), irrespective of whether there are parentheses.This is a bug, because the formula with a space for an intersection operator is perfectly valid Excel A1 formula syntax, so an Error code is an incorrect output.NB: Nothing in this bug is about import/export from MS Excel. It is solely about the Excel A1 formula syntax within native Calc. As long as the formulae are entered in Calc, the bug is independent of which format the sheet is saved in (it is even reproducible before saving the file). The following examples are available with screen-shots added here: <>==Expected Behaviour==With Calc A1 Formula Syntax, the '!' operator in a formula gives the intersection of two ranges. For example a cell containing the formula: =($B:$B!$2:$2)*2 should resolve to 28, if the contents of B2 is the number 14.With Excel A1 Formula Syntax (selected via Tools>Options>Formula), the <space> operator in a formula is meant to be equivalent, giving the intersection of two ranges. For example: =($B:$B $2:$2)*2should be equivalent.==Actual Behaviour==With Excel A1 Formula Syntax selected, when typing the formula, Calc displays the two ranges as expected; as intersecting coloured boxes around the ranges and it colours the characters in the formula to match. However, on entering the formula (type <enter> or click the tick), the cell displays "Err:509" (missing operator)If the ranges are defined as names (using Insert>Names>Define), e.g. horiz $2:$2 vert $B:$Bthen an intersection formula is defined with parentheses around these names, for example: =(horiz vert)*2 it returns "Err:508" (pair missing). However, a similar formula without parentheses such as =horiz vertreturns "Err:509" (missing operator)==Absence of Any Intersection Operator in Excel A1 Formula Syntax==Incidentally, with Excel A1 Formula Syntax selected, attempting to use '!' as an intersection operator correctly gives a #NAME? error. So there is no working intersection operator at all in Calc's Excel A1 Formula Syntax.==System build==Libre OfficeVersion: 5.0.3.2Build ID: 1:5.0.3~rc2-0ubuntu1~trusty2Locale: en-GB (en_GB.UTF-8) Reproduced.Win 7 Pro 64-bit Version: 5.2.0.0.alpha0+Build ID: 014633f83e44ae8ba33087b6f38e8e253e281969CPU Threads: 4; OS Version: Windows 6.1; UI Render: default; TinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-12-15_06:21:44Locale: fi-FI (fi_FI)Oh yeah, conditionally significant whitespace as operator, great fun.. also in OOXML. One has to bow before the wisdom of Excel devs.Eike Rathke committed a patch related to this issue.It has been pushed to "master":Resolves: tdf#96426 significant whitespace as intersection in Excel syntaxIt will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Eike Rathke committed a patch related to this issue.It has been pushed to "master":fully check for adjacent RPN end, tdf#96426 follow-upIt will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Eike Rathke committed a patch related to this issue.It has been pushed to "master":narrow down where a space could be an intersection, tdf#96426 follow-upIt will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.AlsoEike Rathke committed a patch related to this issue.It has been pushed to "master":first range can be anywhere before second at RPN end, tdf#96426 follow-upIt will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Pending reviewfor 5-1(In reply to Eike Rathke from)Thx for the fix. I'll test the daily build as soon as I can, using our cashbook spreadsheets, which liberally use the intersection operator in Excel formula syntax. I'll also try to contrive some more challenging tests. However, I have bigger problems at the mo, which I need to fix first (crash while not even touching my machine left me with black-screen on boot). So prob a fortnight.I'm afraid I cannot review the code. I've had a quick look at your diffs, but I'm completely unfamiliar with Libre Office code, so I won't promise to review it - would be pointless.(In reply to Bob Briscoe from)It's ok - we are not expecting you to review it :) If you are interested in contributing without coding, seefor an intro to the vast world of quality assurance.Eike Rathke committed a patch related to this issue.It has been pushed to "master":check presence of token, tdf#96426 follow-upIt will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Eike Rathke committed a patch related to this issue.It has been pushed to "libreoffice-5-1":Resolves: tdf#96426 significant whitespace as intersection in Excel syntaxIt will be available in 5.1.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.THank you for trying to fix this, but it's not completely fixed, I'm afraid.The fix works with intersections between simple cell ranges, but you get the two errors described in the original bug report when the intersection is defined between variable names (defined as cell ranges using Insert>Names>Define).See the screenshots atin which the red text has been added since the original bug report.For instance, if you define:* horiz as Sheet1!$2:$2* vert as Sheet1!$B:$BThen, with Excel A1 formula syntax, the following example formulae return the errors shown: =(vert horiz)*2 Err:508 (pair missing) =vert horiz Err:509 (missing operator)_______I just noticed an extra twist: If an intersection formula is written with a '!' when Calc A1 formula syntax is selected, e.g.: =(vert!horiz)*2a) this works correctly with no errors. b) the '!' correctly auto-translates to a ' ' (space) if the formula syntax is switched to Excel A1.c) And there are still no errors, but...d) ...if the formula is edited to a different formula with ' ' (space) as an intersection operator, the bug re-appears.
id=106113	Description:On Windows 7 text in all cells are bit lower, than vertical center. When cell text is in edit mode, that text moves few pixels higher. After editing is done, text returns to previous position, which is still off vertical center.Steps to Reproduce:1. Open new spreadsheet.2. Enter some text.Actual Results: Entered text is few pixels lower, than it should be. When editing, text is a bit higher.Expected Results:Text should stay vertically centered at all times, except when special formatting is applied.Reproducible: AlwaysUser Profile Reset: Yes. Problem still exists in safe mode.Additional Info:Version: 5.3.0.3 (x64)Build ID: 7074905676c47b82bbcfbea1aeefc84afe1c50e1CPU Threads: 4; OS Version: Windows 6.1; UI Render: default; Layout Engine: new; Locale: lt-LT (lt_LT); Calc: groupUser-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:51.0) Gecko/20100101 Firefox/51.0 CreatedText alignment issueHi,Thanks for reporting.This is the expected behaviour and it has been like that since OpenOffice, thus this is considered as not a bug.Closing as RESOLVED NOTABUGIt was working "correctly" in LibreOffice 5.2, all text was neatly aligned in the middle vertically. I think it is a regression.CreatedLibreOffice 5.2.5.1CreatedLibreOffice 5.3.0.3Please, take a look at two new screenshots, comparing similar views on 5.2 and 5.3 versions of LibreOffice. You will clearly see, that in 5.3 text is rendered a few pixels lower than in previous version.
id=33697	Hello,I was not able to choose Proxy server type "System" from menu Tools > Options > Internet > ProxyIf I change type to "System", then click on OK, when I come back to dialog box, proxy type reverted to previous choice, either "None" or "Manual".My system is WinXP. Confirmed on Win 7 and Ubuntu 10.10. With LibO 3.3.0 RC4.Same behavior with OOo 3.3.0RC10.No issue found on IZ.Good luck.Laurent BP Solve in LibO 3.4.2Hi,The bug is still present in 3.4.5Hello,Actually, I did a mistake with my previous test, as the bug is still there. Sorry for the noise :(To reproduce:- start with a new profile- Tools > Options > Internet > Proxy is set to "System"- change it to "None" or "Manual"- OK- reopen Tools > Options > Internet > Proxy=> setting has been changed, ok- change it to "System"- OK- reopen Tools > Options > Internet > ProxyExpected: setting should be on "System"Observed: setting kept previous choice ("None" or "Manual")Configuration Win7 LibO3.5.0RC3Work around: - either create a new profile- or manually modify your config file "registrymodifications.xcu" in your profile: - look for "ooInetProxyType" - change value between <value> with 1:<prop oor:name="ooInetProxyType" oor:op="fuse"><value>1</value></prop>Laurent BPCreatedProposed patchHello,This patch remove a line preventing the saving of Internet Proxy "System" mode.It solves the problem described here. Hope it does not have side effects.Test on OpenSuse 12.1 x86_64.Laurent BPCreatedCorrect patch fileAs far as I can see RestoreConfigDefaults_Impl is supposed to basically do the right thing, reset the values to their defaults, but the cast of m_xConfigurationUpdateAccess to an XPropertyState throws in SvxProxyTabPage::ReadConfigDefaults_Impl and SvxProxyTabPage::RestoreConfigDefaults_Impl so all of that reset is skipped/non-functional.Looking into configmgr I don't see any mention of XPropertyState in the list of things an Access supports. Though I do see a mention in (the unbuilt) configmgr/qa/unit/test.cxx of //TODO: support setPropertyToDefaultSo either configmgr's Access should support XPropertyState and the existing code in optinet2.cxx would then work fine, or Access shouldn't support XPropertyState and the XPropertyAccess using code in optinet2.cxx is all wrong.This is kind of funny. While the old configmgr implementation did support XPropertyState, I was always under the impression that the implementation was actually not functional (i.e., setPropertyToDefault would effectively do nothing), so I did not bother to support it in the new configmgr.The new configmgr is in since OOo 3.3, btw,; that explains why this issue first appeared with 3.3.However, the proposed patch will not really work. As long as no manual settings have ever been made on that options tab page, changing from "None" to "System" will indeed cause the default values for the various proxy settings to be used. (Which are "external" configuration properties that obtain their values by querying specific "data backends.") But once any manual settings have been made, changing from "Manual" to "System" will erroneously keep those manual values.A true fix would require some larger changes to configmgr, so that it keeps around in memory property values from lower layers that are overridden in higher layers. Other parts of configmgr would benefit from such a change, too (cf. the TODO comment at the head of Components::removeExtensionXcuFile in configmgr/source/components.cxx). Taking over.Comment onCorrect patch fileaccording tothis patch should not be integrated,setting the "obsolete" flag so it does not turn up in bugzilla queries.hi devs, could you please give an update of this REOPENED bug status?is this bug still relevant with latest 4.3.3 LibO release(In reply to tommy27 from)Yes, the analysis inis still relevant.Hi,Is this some news about integration of this patch in last release ?This bug has created about 6 years ago and it's not yet fixed in the latest version of LibreOffice (5.2.3), when will a fix be issued for this long-term bug?I changed proxy settings to manual and couldn't verify if proxy worked, then when I changed it back to "System" proxy, the settings wasn't saved and it still showed the previous settings.@Kaveh first of all, learn how to use the bug-tracker...you changed version field to 5.2.3.3 without reading that it must indicate "earliest affected" (I'm reverting to previous value).second, this kind of comment won't help fixing the bug.instead of ranting you can fix it by youself (patch welcome) or pay a developer to fix it.
id=105418	Description:When a page is zoomed in, we have to use scroll bar to pan view.Using middle mouse button could be easier.Actual Results: Expected Results: Reproducible: AlwaysUser Profile Reset: NoAdditional Info:User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:50.0) Gecko/20100101 Firefox/50.0 There is a setting for that in Tools->Options->View.So there is a real bug as it doesn't work in Draw, only on Writer and Calc.Neither for "Automatic scrolling" nor "Paste clipboard"
id=76334	Createdrectangle with text from PP2013Open the attached document and save it in .odp format. Inspect the file and notice the attribute svg:viewBox="0 0 0 0" in the enhanced geometry. Width and height in zero are wrong. This error gives wrong rendering by other consumers. On pc Debian x86-64 with master sources updated today, I can reproduce this.** Please read this message in its entirety before responding **To make sure we're focusing on the bugs that affect our users today, LibreOffice QA is asking bug reporters and confirmers to retest open, confirmed bugs which have not been touched for over a year.There have been thousands of bug fixes and commits since anyone checked on this bug report. During that time, it's possible that the bug has been fixed, or the details of the problem have changed. We'd really appreciate your help in getting confirmation that the bug is still present.If you have time, please do the following: Test to see if the bug is still present on a currently supported version of LibreOffice (4.4.2 or later)If the bug is present, please leave a comment that includes the version of LibreOffice and your operating system, and any changes you see in the bug behavior If the bug is NOT present, please set the bug's Status field to RESOLVED-WORKSFORME and leave a short comment that includes your version of LibreOffice and Operating SystemPlease DO NOT Update the version field Reply via email (please reply directly on the bug tracker) Set the bug's Status field to RESOLVED - FIXED (this status has a particular meaning that is not appropriate in this case)If you want to do more to help you can test to see if your issue is a REGRESSION. To do so: 1. Download and install oldest version of LibreOffice (usually 3.3 unless your bug pertains to a feature added after 3.3)2. Test your bug 3. Leave a comment with your results. 4a. If the bug was present with 3.3 - set version to "inherited from OOo"; 4b. If the bug was not present in 3.3 - add "regression" to keywordFeel free to come ask questions or to say hello in our QA chat:Thank you for your help!-- The LibreOffice QA Team This NEW Message was generated on: 2015-05-02The bug still exists in Version: 5.0.0.0.alpha1Build ID: 77a35997fa7cff387b5b135ff0c42155f80e9884Locale: de_DEFixed on AOoo (put the link quoted by Regina on URL)I wrote a patch for this one. Currently under review:** Please read this message in its entirety before responding **To make sure we're focusing on the bugs that affect our users today, LibreOffice QA is asking bug reporters and confirmers to retest open, confirmed bugs which have not been touched for over a year.There have been thousands of bug fixes and commits since anyone checked on this bug report. During that time, it's possible that the bug has been fixed, or the details of the problem have changed. We'd really appreciate your help in getting confirmation that the bug is still present.If you have time, please do the following:Test to see if the bug is still present on a currently supported version of LibreOffice (5.1.5 or 5.2.1If the bug is present, please leave a comment that includes the version of LibreOffice and your operating system, and any changes you see in the bug behavior If the bug is NOT present, please set the bug's Status field to RESOLVED-WORKSFORME and leave a short comment that includes your version of LibreOffice and Operating SystemPlease DO NOTUpdate the version fieldReply via email (please reply directly on the bug tracker)Set the bug's Status field to RESOLVED - FIXED (this status has a particular meaning that is not appropriate in this case)If you want to do more to help you can test to see if your issue is a REGRESSION. To do so:1. Download and install oldest version of LibreOffice (usually 3.3 unless your bug pertains to a feature added after 3.3)2. Test your bug3. Leave a comment with your results.4a. If the bug was present with 3.3 - set version to "inherited from OOo";4b. If the bug was not present in 3.3 - add "regression" to keywordFeel free to come ask questions or to say hello in our QA chat:Thank you for helping us make LibreOffice even better for everyone!Warm Regards,QA TeamMassPing-UntouchedBug-20160920It is fixed now.The mentioned patch was abandoned, so it is not the reason for the fixed behavior.I have tested it in Version: 5.3.0.0.alpha0+Build ID: ba269f7294e2416659011cbb498a2c6b5f9d5199CPU Threads: 4; OS Version: Windows 6.1; UI Render: default; TinderBox: Win-x86@42, Branch:master, Time: 2016-09-12_02:36:16Locale: de-DE (de_DE); Calc: groupI was wrong. The problem still exists in Version: 5.4.0.0.alpha0+Build ID: 5adab0927483d039037b0f93894627e41a2c72f2CPU Threads: 4; OS Version: Windows 6.1; UI Render: default; TinderBox: Win-x86@42, Branch:master, Time: 2017-01-09_23:34:00Locale: de-DE (de_DE); Calc: group
id=88927	Will trusted timestamping feature be added for both LibreOffice files and PDF files to protect files for lifetime in the future versions of LibreOffice? RESOLVED DUPLICATE of tracker.You can still make a donation.*** This bug has been marked as a duplicate of***This is not exact duplicate of. Because I meant for both OpenDocument and PDF files, not just PDF files.(In reply to Yan Fiz from)Well, the best is to split such requests as PDF and OpenDocuments are different formats and need separate work, commits and such. Having one bug for all is not a good idea. Instead of reopening this one, I would file new bugs for OpenDocuments only. Just my 2 cents.Well, before this can be worked on, I suppose there needs to be a specification for timestamps in ODF documents.As far as I am aware, there is no notion of digitally signed (RFC 3161) timestamps in the format, right?So a first step would be to draw up a specification.And, yes, this should then go into a separate "bug" (i.e. feature request)
id=81883	Problem description: Libreoffice crash on exit all time that i use a Basic Macro to access to a database connected to a sheet of calc (sorry for my english...)Steps to reproduce:1. Create a simple document in calc anda save it.Cod Description Price1 test1 102 test2 203 test3 302. Create and register a Database connected to a calc file3. Created the macro and executeSub TESTDatabaseContext = createUnoService(“com.sun.star.sdb.DatabaseContext”)DataSource = DatabaseContext.getByName(“TEST”)If Not DataSource.IsPasswordRequired Then Connection = DataSource.GetConnection(”“,”“)Else InteractionHandler = createUnoService(“com.sun.star.sdb.InteractionHandler”) Connection = DataSource.ConnectWithCompletion(InteractionHandler)End Ifend sub Current behavior: Now libreoffice crash on exitExpected behavior: Operating System: Windows 8Version: 4.2.5.2 release When trying to run the macro I get:BASIC syntax error.Unexpected symbol: .It highlights the first “ in the second line.Doesn't crash on exit either.Can you test on 4.3.2.2 or a daily build from here?Tested on:Version: 4.4.0.0.alpha1+Build ID: 0a82645c360158f9cc0fdabe2a52f1ff8f981bedTinderBox: Win-x86@39, Branch:master, Time: 2014-10-24_06:59:23Thanks for your replay. I have tested now with libo 4.3.2.2 and the problem persist.BASIC syntax error. is caused by a problem with copy and past of ""try this code:Sub TESTDim DatabaseContext As ObjectDim DataSource As ObjectDatabaseContext = CreateUnoService("com.sun.star.sdb.DatabaseContext")DataSource = DatabaseContext.getByName("TEST")If Not DataSource.IsPasswordRequired Then Connection = DataSource.GetConnection("","")Else InteractionHandler = createUnoService("com.sun.star.sdb.InteractionHandler") Connection = DataSource.ConnectWithCompletion(InteractionHandler)End Ifend subIf problem persist rewrite "". Thanks and sorry for my english.All right, thanks! I managed to reproduce this (same dev version as) so setting to NEW.CreatedLinux 4.3.2.2 backtraceThe attached is a backtrace from a binary package of 4.3.2.2. I can't however reproduce this on current masterCreatedLinux 4.4 master backtraceI take the above back, I did eventually manage to get the attached crash on 4.4 master - it looks completely different, so the two issues may be unrelatedI have the same crash on exit when connecting to a sheet of Calc using Mail Merge (Mail Merge creates a database connection).LibreOffice version: 4.4.1.2Operating system: Windows XP Professional SP3 ItalianAny update with last stable LO version 5.0.3?This is confirmed, so no need to change the status.(In reply to Beluga from)It's confirmed with a version belonging to a branch soon EOL.(In reply to Julien Nabet from)Mass pings are done regularly for old bugs, but they are never set to NEEDINFO, only a comment is added.If you add aConnection.dispose()when you are finished with the Connection then it'll not crash on exitCaolán McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: tdf#81883 dispose OCalcConnection's doc before shutdownIt will be available in 5.3.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.HiSorry I still reproduce the crash on windows 7/64 & Version: 5.3.0.0.alpha1+Build ID: 8a796410ec8f440b4163b15b928347c499da7a8fCPU Threads: 2; OS Version: Windows 6.1; UI Render: default; TinderBox: Win-x86@42, Branch:master, Time: 2016-10-20_23:07:21Locale: fr-FR (fr_FR); Calc: groupI have tested without & with Connection.dispose()I join a windbg backtrace.RegardsCreatedwindbg backtrace
id=68663	all works well when editing the report but when running it, parameter <label in first column> is not use. X axis is wrong way rebuilt .It works only when running the report during his creation.at the time of the next modifications of the report, you have to uncheck "label in first column".Direct opening of the report from database never works.Steps to reproduce:Create a table and a report containing a diagram in ReportHeader with the following datasDatasTable : Name "Table1" Fied "Date1" type date field "Value1" type Integer ContentDate1 Value1 25/01/13 10 15/02/13 20 18/03/13 25Report : Name "Report1" Data type : Table Content : Table1 Diagram in Report HeaderDiagram: Data type : Table Content : Table1Diagram Type : XY (dispersion) (in french)Data range : all, Label in first column UncheckX Axis : Scale :"Minimum" = 02/01/2013, "main interval" = 30,416 Number : "Category" = Date, Format = "JJ/MM/AAA"Current behavior:parameter "label in first column" : ineffectiveExpected behavior:parameter "label in first column" : effective X axis parameters are in french langage pleasePlease don't set a bug to "New", if there isn't anybody else who has reproduced the bug.Please add an example-database, so I could test it.(In reply to)Bug confirmed see :CreatedDatabase to reproduce the problemDatabase to reproduce the problemCreatedShows the difference in charts from LO 4.1.0.3 and 4.1.1.1 - x-axisI have checked it with the data and tried to create it new. It works up to LO 4.1.0.3. First Version with this bug is LO 4.1.1.1@chrislibreofficeAre you shure this behavior appears first in LO 4.1.0.4? I have tested this version also. There it works with Linux 64bit rpm. So I think it could have something to do with the fix of. This fix first appears in LO 4.1.1.Bug reproduce on Version 4.0.5.2 (Build ID: 5464147a081647a250913f19c0715bca595af2f)Processor AMD Athlon(tm)64 X2 Dual 5000+Seven 64 bitsthe database to reproduce the problem has been created vith this version.(In reply to)(In reply to)Sorry the concerned versions are 4.0.4, 4.0.5 and 4.1.0(In reply to) Bug reproduce on Version: 4.1.1.2Build ID: 7e4286b58adc75a14f6d83f53a03b6c11fa2903CreatedCurrent behaviorscreenshot current behavior(In reply to)Bug reproduce on Version : Version: 4.1.0.4Build ID: 89ea49ddacd9aa532507cbf852f2bb22b1ace28Are you shure this behavior appears first in LO 4.1.0.4? ICreatedExpected Behaviorscreenshot expected behaviorOK, what I found is another bug. Forgetand 6.I see the right behavior in the preview, when I will edit the report. Then I doubble-click on the chart. The charts show values without connection to the first column. I could change the "Data Ranges" and set "First column as label" off. Now the chart shows the right behavior. Saved the report. Start the report, had a look: the information has been gone. Again opening the report for editing and see: "Data Range" is set to "First column as label". Seems this property hasn't been saved.All this you could only notice, when you create x/y-charts. Its the same wrong behavior in all versions of LO - have tested LO 3.3.4 with the same result.Confirming also on LO 4.0.5 OSX 10.8.4AlexWhy is this labelled as a regression ?In which earlier version of LO did it work ?According to, the earliest version in which this bug is present is 3.3.4 - resetting version accordingly and removing regression status.AlexHave tested a little bit more.1. I could not start a report with x/y-chart in reportheader in LO 3.0.0 beta1 and beta2. So the first version I could test is LO 3.0.0 beta3. Same bug there, seems to be a very old bug, existing since OOo.2. There are many bugs working together. 2.1 The first is, that every x-axis is per default set to an interval "1", starting with "1" - seems to count the rows only.All versions up to 4.0.5.2 | 4.1.1.1 - beginning with this versions it works right in a special constellation.2.2 The second is, that you could switch "First column as label" in the Data-Range to "off", but this isn't been saved. Next opening it is always switched again to "on". For databases I would prefer, that this is set to "off" by default - the labels are the names of the field.2.3 The third is, that per default no «time» and no «date» is recognized by the chart-assistant. Only values like «integer» or «decimal» would work.All versions up to 4.0.5.2 | 4.1.1.1. Beginning with this versions the chart with «integer» and «decimal» is shown in the right way. Charts with «time» and «date» don't show a line at all.I will add an attachment to show the difference.CreatedDifferent filed-types show different bugs in charts of a report.Try the report with LO 4.1.0.4 or any earlier version, which could open reports with charts. I have tested a version 3.3.4.Then start the same report with LO 4.1.1.1 or newer, also with LO 4.0.5.2. Both show the same: no line in the date-and-time- chart and a right integer-decimal-chart.(In reply to)(In reply to)*please* do not mix different bugs in the same bugzilla entry.(In reply to)It a little bit tricky to mix not at this point: When I have a look at the types of the field this bug has gone for integer- and decimal-fields in LO 4.1.1.1 and LO 4.0.5.2. Label in first column of diagram works in reportbuilder with this fieldtypes.This bug has changed for date- and time-fields with LO 4.1.1.1 and LO 4.0.5.2. Label in first column of diagram don't works in reportbuilder in a different way since this versions. Should I open a new bug for this (actual) behavior of LO?(In reply to)That is *not* what this bug is (claims to be?) about. The issue is that UNsetting "label in first column" does not work. And never worked.You seem to describe the bug that date values stopped working in 4.1.1 and 4.0.5.Lionel Elie Mamane committed a patch related to this issue.It has been pushed to "master":fdo#68663 open chart-in-report: actually test for categories presenceThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Lionel Elie Mamane committed a patch related to this issue.It has been pushed to "master":fdo#68663 don't blindly force categories when there are noneThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.I forked the date-related issue in.My "fix" for this bug may have broken backwards compatibility with old files, so I'm going to consult with other developers before backporting to 4.1/4.0.(In reply toof)Markus, since we reintroduced this bug to fix, do you have some time to help me fix this bug without retintroducing? Thanks in advance.Surely, this should be re-opened as the fix was reverted, and the symptoms are once again present ?***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***
id=68341	Class test failed just because of a space at the beginning of the class name.Should be trimed. Could you please describe the bug a little bit more? What are you doing; what are you expecting, what Base should do; what do you mean with "class name"; how do you contact with MySQL ...@Lionel - any opinions on this really old enhancement request?I assume this is about connecting through JDBC, and the Java class name. It is a valid usabiity enhancement. Not only for MySQL, but for JDBC in general.Test class name:- m_aJavaDriver- m_aEDDriverClassFor Wizard: m_aETDriverClass--Laurent Balland-Poirier committed a patch related to this issue.It has been pushed to "master":fdo#68341 Remove space of java class when testing classThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.While the committed patch is good progress on this bug, I disagree that it is fully fixed. The spaces are trimmed only when one presses the "Test" button. If one does not press the "test" button, but only the "next" button, the class name is not space-trimmed.Migrating Whiteboard tags to Keywords:(difficultyBeginner, skillCpp, deprecated 'proposedEasyHack' -> the replacement term 'needsDevEval')
id=72830	CreatedODG file with demonstration of the problem with Straight ConnectorsAs far I can understand - Arrows from Lines and Arrows sub-panel of Drawing toolbar can:1. be straight (horizontal or vertical = rotated by 45/90/135/180/225/270/315/360) if I press <Shift> key;2. snap to grid.I use LibreOffice Draw for diagram creating. So I use elements from Drawing sub-panels Connectors, Glue Points and Basic Shapes.It was a surprise for me, that Straight Connectors do not snap to grid and do not react on <Shift> key. It is very difficult do connect Connector line to some object without these two options if one of line ends is not connected.The example is in attachment.It demonstrates, that:1. «Straight Connector ends with Arrow» line does not snap to grid and does not react to <Shift> key, so it is difficult to keep it horizontal or vertical.2. «Line Ends with Arrow» line snaps to grid and react to <Shift> key, but it does not connect to another object (does not have glue-point, it is not a connector).Please, if it possible, allow Connector line to act as other lines (add snap to grid and a reaction on <Shift> key). Without this changes it will be very difficult to use LO Draw as diagram editor for real life tasks.I see this behaviour on LO Version: 4.1.3.2 Build ID: 410m0(Build:2) and LO 3.5.7.2 Build ID: 350m1(Build:2). May be other versions are affected too. This bug exists in AOO 4.0.1 AOO401m5(Build:9714) too.(In reply to)So, inherit from AOO.Reproducible, tested using Windows 8.1 with LibreOffice 4.1.4.2.Kind regards,JorenBug exists in Version: 4.4.2.2Build ID: 40m0(Build:2)Locale: en_US.(Ubuntu 12.04.5 amd64, libreoffice PPA).Bug exists in LibreOffice 5.0 (Ubuntu 12.04.5 with PPA, 1:5.0.0~rc5-0ubuntu1~precise1).Bug exists in LibreOffice 5.0.1.2 (Ubuntu 12.04.5 with PPA, 1:5.0.1~rc2-0ubuntu1~precise1.1).Why do you expect connectors to snap to grid when it is supposed to connect two objects? Lines and connectors are different things, other programs do not even allow free floating connectors. I'd rather remove a connector when it is not connected at both ends. Removing an object should kill the connector too.Please set the status to RESOLVED and NOTABUG if you agree.I totally agree with Heiko. The geometry of connectors depends of the glue points. If they have the same Y coordinate, the connector is horizontal, and if these don't, the connector *cannot* be horizontal (if it's not a connector with turns, who will be horizontal in parts, if possible).Since Norbert X hasn't responded for five months, I set the status to RESOLVED and NOTABUG.Createddirty hack for Straight Connector LineBug exists in LibreOffice 5.0.6-0ubuntu1~precise1.And how I can draw horizontal or vertical Straight Connector Line without glue point on the left line-end?It is real world example, not fiction.Closing bug is not a solution if you plan to make LibO Draw better.As temporary dirty hack I cloned right rectangle, moved it to the left, set its line style to none and then connect left line-end to it. Are you seriously think that it is a good solution?
id=96548	The line numbering is not saved. I enter the line numbering. It displays. When I save it and then open the file again, the line numbering is no longer showing. I can save the file to a pdf file and it stays. But, this is unacceptable.Please, please, please make a keyboard shortcut for the footnote insertion. Yes, I can make my own, but I want one that is created by you because you know the whole scope of the program and I do not. Also, then it would be universal for the program and not my specific input. Please.Thank you, then you for LibreOffice`````````````````````````````````````````````````````````````````````````````````````````````````````````````````` @Robert : please do not file multiple bug reports / feature requests in a single report. Each one should have a separate report.1) Line numbering : please explain the options you chose for line numbering in Writer. Ideally, a sample document in which line numbering has been activated would be best. That way, we can see whether the problem just affects your own environment, or also that of others.2) Footnote insertion : if you don't want to create your own shortcut for this by customising the main toolbar, I suggest you open a bug report specifically for that feature request, or check at least to see whether someone else hasn't already asked for it.No feedback after 7 months, let's put this one to INSUFFICIENTDATA.Robert: if you still reproduce these problem, please follow Alex's advice in.The problem with the line numbering affects me, too.It shows up as follows:When I re-open the affected document, the line numbering doesn't appear. If I go to "Tools" > "Line Numbering...", "Show numbering" is activated and the selections are as I made them. If I just click "OK" now, everything shows up as it should.When I create a new document and try to "recreate the problem", the bug doesn't show up. I've adjusted the document in which the problem occurs, and wanted to attach it, but, unfortunately, the file somehow is still over 23MB large, even though I cut it to one page. And I cannot attach such a large file.
id=32531	CreatedDemonstration of wrong cursor movement in RTL cellWhen using the cursor keys to move to next/previous cell, the direction ofmovement depends on the directionality of the cell (LTR = Left to Right, or RTL= Right To Left).For example, when a cell is defined to have LTR direction, and the user pressesthe left arrow key, the cursor moves to the previous cell (to the left).However, if a cell is set to RTL direction, and the uses presses the left arrowkey, the cursor moves to the next cell (to the right).This is incorrect behavior and very confusing. The user expects the cursor keysto behave logically - progress to the next cell relative to the direction of the table, not to the next cell relative to the direction of text in the current cell.An example of how this behavior is very confusing:A user creates a table in a Hebrew document. Hebrew is an RTL language and sothe direction of the document, and by default of the table, is RTL. The thenselects one of the columns and clicks the LTR tool-button, to make all cells inthe column have LTR text. This is because the column is intended for emailaddresses, which are always in English.The user then uses the left arrow key to move from the first (right-most)column, to the next, then to the next, etc. Then the user reaches the emailcolumn (which is LTR), and again presses the left arrow key.The user expects the cursor to move to the next column - to the left, howeverthe cursor moves to the previous column! Repeated presses on the left arrow keycause the cursor to remain "trapped" among the email column and the column that precedes it.The solution: cursor movement between cells should depend on the direction ofthe table, not the direction of the text in the current cell. it is -This is a Writer table, so I guess putting Cedric in CC would be more appropriate.Does this bug apply to the direction of the cursor in general when navigating through RTL documents in general? As of now, the right arrow makes the cursor go right and the left arrow goes left. Is this a separate issue or the same? Also, I'm having trouble locating the code for the language directionality. Any pointers there?(In reply to)The bug refers only to cursor movement between table cells.Eyal.(In reply to)Ok. The inversion of the arrow keys is still an issue. Right means right and left means left. A way of fixing the cell cursor movement could be to fixing the inverse arrow key movement as well. Or is that not a concern?(In reply to)Ok. The inversion of the arrow keys is still an issue. Right means right and left means left. A way of fixing the cell cursor movement could be to fixing the inverse arrow key movement as well. Or is that not a concern?[This is an automated message.]This bug was filed before the changes to Bugzilla on 2011-10-16. Thus itstarted right out as NEW without ever being explicitly confirmed. The bug ischanged to state NEEDINFO for this reason. To move this bug from NEEDINFO backto NEW please check if the bug still persists with the 3.5.0 beta1 or beta2 prereleases.Details on how to test the 3.5.0 beta1 can be found at:more detail on this bulk operation:An EasyHack should have been checked by developers and thus is confirmed regardless of age. Moving back to NEW from NEEDINFO again. Sorry for the hassle.Seems like this is not just about table cells - it happens whenever the cursor crosses a boundary between LTR and RTL paragraphs / text runs.Interestingly, it doesn't trigger with RTL words in an otherwise LTR paragraph - the cursor does move right when the Left key is pressed inside the RTL word, but it doesn't get trapped on the boundary.OK, so this is actually 2 separate bugs:1. With caret movement set to Logical, caret gets trapped between LTR and RTL text runs (not just table cells).2. With Visual caret movement, caret is trapped at the end of an RTL cell containing LTR text.I assume the original poster meant the 2nd bug, the 1st one can be dealt with in a separate bug report.Removed EASYHACK from summaryadding LibreOffice developer list as CC to unresolved EasyHacks for better visibility.see e.g.for detailsRestricted my LibreOffice hacking areaadding LibreOffice developer list as CC to unresolved Writer EasyHacks for better visibility.see e.g.for detailsMigrating Whiteboard tags to Keywords: (easyHack)Seeing this is marked as an easy hack, but without code pointers:Writer keyboard input for the main editing area is in general handled in SwEditWin::KeyInput(), sw/source/uibase/docvw/edtwin.cxx. Put a breakpoint at the start of the member function in a debugger, then hit the key you're interested in, that'll allow you to see where the exact code is for the actual use case.JanI is default CC for Easy Hacks (Add Jan; remove LibreOffice Dev List from CC)[NinjaEdit]I have committed a patch to fix this issue and also tested it on my system. Please review it. ThanksJaskaran committed a patch related to this issue.It has been pushed to "master":tdf#32531 Fix for key movement in table cell of different directionalityIt will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.seems solvedThe commit here caused, which is rather major usability regression for RTL documents. So I’m reverting this commit and re-opening the bug until a better fix is provided.@KhaledI've seen you have already fixed.Are you still working on a better fix for the current report?(In reply to tommy27 from)No, I’m not working on this bug.
id=94871	Createdexample a pageif you look at the attached screenshot, you see that the paragraph alignment is uneven. In addition, they are placed away from the "note" and "warning" flags that makes it unsightly.it would be great if between the flags and the paragraph is had a small distance, and all the paragraphs is aligned the left edge.screenshot made on:Kubuntu 14.04LO master at 06.10.2015 Lera: Please attach the .xhp file too.Created.xhp fileI attach .xhp file.Also, you can download the latest versionLera: Your file has a muddle of block-level elements and inline-level elements.The element 'embed' is a block-level element. It embeds an element 'section'.Block-level elements are not allowed as child of an element 'paragraph'.If you want to embed something inside a paragraph, you have to use an inline-level element. So inside a paragraph use an element 'embedvar', which embeds an element 'variable'.To solve the conflict, do not write<paragraph id="par_id9397381616478" role="paragraph" localize="false" xml-lang="en-US"><embed href="text/scalc/01/ex_data_stat_func.xhp#ex_func_average"/></paragraph>but simple write<embed href="text/scalc/01/ex_data_stat_func.xhp#ex_func_average"/><paragraph id="par_id262061474420658" role="note" xml-lang="en-US"></paragraph>is needless.The section, which will be embed with the next element, has got the attribute 'role="note"' itself.Delete my last comment.CreatedscreenshotWell, I corrected this point, but it has not brought the expected results. Paragraphs continue to have uneven alignment. What's next?Creatednew .xhp fileDo the two 'note' paragraphs have the same indent now?In regard to alignment of 'note'- and 'tip'-paragraph I have no immediate solution. I guess, that it is nothing in the .xhp files, but happens on the way to the help browser. Please switch your icon theme from Tango to Galaxy before viewing the new help page. Is the indent the same then? [The icon size is different in Tango and Galaxy.](In reply to Regina Henschel from)It is Oxygen, I have it defaultIt is TangoIt is GalaxyI think that the problem is associated with the table stylesThe problem is surely outside your file. Have a look at the help "Icons in the Documentation" (Search for 'Icons' in 'headings only'). It shows the three types and has the same wrong alignment you have noticed.AOO uses a constant spacing between icon and text.LO 4.2 has a constant spacing for 'note' and 'tip' and this large width for 'warning'.You are right, different table settings result in not aligned paragraphs. But I do not know where these widths are set. I do not find such settings, neither in the .xhp file, nor in the main_transform.xsl nor in the default.css.this became a lot worse with this commitcommit a219bbb62f974020fac0799143fbc51c385bb460Author: Matteo Casalin <>AuthorDate: Mon Sep 1 23:36:14 2014 +0200 Simplify by early bailoutMichael Stahl committed a patch related to this issue.It has been pushed to "master":tdf#94871: sw: fix a frame formatting regression that affects helpIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#94871: sw: fix a frame formatting regression that affects helpIt will be available in 5.0.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-4-4":tdf#94871: sw: fix a frame formatting regression that affects helpIt will be available in 4.4.7.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.adding regression keyword hereI have tested Version: 5.1.0.0.alpha1+Build ID: f271602f7193ddf584ea58dc6a468e6842d0781eTinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-11-08_22:37:35Locale: de-DE (de_DE)The problem still exists, see attached screenshot.Createdscreenshot with LO5.1hmm... that one i can reproduce all the way back to 3.4.6 as well as AOO 3.4.0, so not a regression, removing keyword again
id=69407	CreatedFile describing the problemHello,If you read the attached file with Writer, you'll see the shadow came to the foreground.The reason is that the frame is initialised with transparency colour in writer.With my patch I put the white colour by default. CreatedProposed patchNo body confirmed the bug for nowAlso, please submit the patch to gerrit for review:Thanks!Quickly tested here: no regression found by 'make sw.check' and rendering is correct.2 suggestions though: - change the "//Transparent by default" comment - attach a proper patch with authorship info (or even better, submit the patch to gerrit, with a reference to fdo#69407)added version and plateform - SophieSee the gerrit here:Hi Matthieu, please do not change the version, it's important for QA, see, I put it back to the version the bug has been reported to you - SophieCreatedexample that shows the background has to be transparentsee the above attachment example also though. That shows in word and writer at the moment the same way, i.e. graphic is visible through the transparent frame. If you set it to no-fill then that breaks.I think the problem instead is the drawing of the shadow. I reckon it should be clipped to draw only outside the frame area, and not "underneath" it.@caolan: you're right - sorry I didn't think at this use case.After looking quickly at the code, it seems this isn't a bug, but a feature...See: void SwFrm::PaintShadow in paintfrm.cxx/// OD 23.08.2002 #99657#/// draw full shadow rectangle for frames with transparent drawn backgrounds.And if the last line of this function is changed from: lcl_PaintShadow(rRect, rOutRect, rShadow, bDrawFullShadowRectangle, bTop, bBottom, true, true);to: lcl_PaintShadow(rRect, rOutRect, rShadow, false, bTop, bBottom, true, true);Both test documents are rendered properly - of course this change could have other implications but hopefully it's a hint toward a better fix.Hello,I would like to test the code you write, but I need to build a 4.0.5/4.0.6 version and the code is very different from the branch 4.1.Do you have any hint about correcting this bug in branch 4.0?Thanks very much.Matthieu.To be more precise in the code I have/// OD 23.08.2002 #99657# - determine, if full shadow rectangle have to /// be drawn or only two shadow rectangles beside the frame. /// draw full shadow rectangle, if frame background is drawn transparent. /// Status Quo: /// SwLayoutFrm can have transparent drawn backgrounds. Thus, /// "asked" their frame format. bool bDrawFullShadowRectangle = ( IsLayoutFrm() && (static_cast<const SwLayoutFrm*>(this))->GetFmt()->IsBackgroundTransparent() );.... if ( bDrawFullShadowRectangle ) { /// OD 06.08.2002 #99657# - draw full shadow rectangle....For me it should be :if (! bDrawFullShadowRectangle ) { /// OD 06.08.2002 #99657# - draw full shadow rectangleBecause if the background is transparent it shouldn't be a full shadow rectangleWhen I test it's good for both files.HelloThe previous code was not good, I made this gerritwith a better without any regression.Hi everyone,The bug is fixed. Please take in consideration this last commit:--Mohamed-AliSo setting to FIXED as of.fix has not landed in git ... si pending that, reopeningHello,Is this bug has been fixed in version 4.3?Thanks Soufiane.Comment onProposed patchMarking patch obsolete as there is newer work on gerrit:None of which could be merged apparently, so leaving bug open.
id=58387	Description:When entering text into a content frame and “fit to frame“ is checked, Impress reduces automatically the font of all outline levels. This is very good. However, the indicated font size is always the default value before the font was adjusted to fit the frame.As it is often needed to adjust the font size across several slides, the indication of the real font size is needed and not the default value.Request: Display of the real font size in a content frame left and right of the cursor position.I can be contacted.Operating System: Windows XP Thank you for posting this enhancement. A good improvement to me also.(In reply to).... then let's hope that it will soon be implemented!** Please read this message in its entirety before responding **To make sure we're focusing on the bugs that affect our users today, LibreOffice QA is asking bug reporters and confirmers to retest open, confirmed bugs which have not been touched for over a year.There have been thousands of bug fixes and commits since anyone checked on this bug report. During that time, it's possible that the bug has been fixed, or the details of the problem have changed. We'd really appreciate your help in getting confirmation that the bug is still present.If you have time, please do the following:Test to see if the bug is still present on a currently supported version of LibreOffice (4.3.5 or later):If the bug is present, please leave a comment that includes the version of LibreOffice and your operating system, and any changes you see in the bug behaviorIf the bug is NOT present, please set the bug's Status field to RESOLVED-WORKSFORME and leave a short comment that includes your version of LibreOffice and Operating SystemPlease DO NOTUpdate the version fieldReply via email (please reply directly on the bug tracker)Set the bug's Status field to RESOLVED - FIXED (this status has a particular meaning that is not appropriate in this case)Thank you for your help!-- The LibreOffice QA TeamI made a test in 4.3.5.2 and it looks solved to me.Thanks to the one(s) who made it!I flag the bug RESOLVED and FIXEDSorry I flagged the bug RESOLVED by mistake and cannot go back to NEEDINFORMATIONI apologize for inconvenience and promise not to do it again.
id=52540	Createdtest documentProblem description: Linux Libertine G by default handles the standards ligatures, like ff, ffi, ffl, tt.On hyphenated words, the ligature is not omitted.Using the test text "Lorem ipsum differenza"I get this beaviour:Lorem ipsum diﬀ-ferenzawhile it should be:Lorem ipsum dif-ferenzaLinux Libertine offers a variant, "Linux Libertine G:ligc=1" which should correct ligatures on hyphenated words. But apparently it is ignored on the latest version of Libreoffice.Note: I'm using the Italian hyphenation.Steps to reproduce:1. Enable hyphenation on the current paragraph2. Set "Linux Libertine G:ligc=1" as the current font3. Paste same test text that gets hyphenated on a standard ligature Current behavior:A ligature is added before the hyphenation line.Expected behavior:No ligature should be added.Platform (if different from the browser): Browser: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:14.0) Gecko/20100101 Firefox/14.0.1Libreoffice 3.5.5.3Linux Libertine G version 2012-01-16 Confirmed with LibreOffice 3.6.***has been marked as a duplicate of this bug. ***CreatedEnglish test fileHyphenation of “proofing” in LibreOffice is proofi- ing.Workaround: put soft hyphen at the bad break point.[Note (another, but related bug): there is no kerning before the hyphen and Graphite ligature replacement before extra characters of a special hyphenation, eg. Hungarian cursive gy ligature in roggyan -> rogy=gyan, second test file attached.]CreatedNot extra, but missing ligature.Automatic hyphen and extra characters before the special hyphenation don't handled by Graphite kerning and ligature replacement.Laszlo Nemeth committed a patch related to this issue.It has been pushed to "master":fdo#52540 fix hyphenation of Graphite ligaturesThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Laszlo Nemeth committed a patch related to this issue.It has been pushed to "libreoffice-4-0":fdo#52540 fix hyphenation of Graphite ligaturesIt will be available in LibreOffice 4.0.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Laszlo Nemeth committed a patch related to this issue.It has been pushed to "libreoffice-4-1":fdo#52540 fix hyphenation of Graphite ligaturesIt will be available in LibreOffice 4.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Laszlo Nemeth committed a patch related to this issue.It has been pushed to "master":fdo#52540 fix Graphite hyphenation (ligat. + combining diac.)The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.CreatedNew test caseLászló Németh committed a patch related to this issue.It has been pushed to "master":fdo#52540, fdo#88051: fix Graphite layoutIt will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.László Németh committed a patch related to this issue.It has been pushed to "libreoffice-4-4":fdo#52540, fdo#88051: fix Graphite layoutIt will be available in 4.4.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.This bug, and it's embarrasingly long chain of related bugs is due to a slightly wider problem than just what comes after and how to limit the damage. What I think is happening is that sometimes Graphite and libreoffice disagree over what text should be in a run. Libo comes up with two short runs and Graphite converts these into a single cluster. Libo calls the graphite_layout to run the first run, which generates a long cluster, which is fine. In the second call for the second run, the first character in the new cluster is rendered as a base character and so the integration code goes: oh look the cluster is in range, include it.What needs to happen is that graphite needs to back up when generating its segment and make sure it picks up previous bases so that the second run that is passed to it is seen as being part of the first run cluster and so nothing is rendered.I've implemented a patch to this end, that also removes László Németh's fine patching to solve the specific problems. I would ask people to apply the patch and test that it does solve all the old problems in a suitably generic way.Createdpatch for fixMartin Hosken committed a patch related to this issue.It has been pushed to "master":fdo#52540 refix graphite layout generallyIt will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Any chance of 4.4.3 promotion for this patch?CreatedTest file with Graphite and non-Graphite hyphenationUnfortunately, it seems, the patch results bad hyphenation position, eg. "proofi-ng" instead of "proof-ing", see in the attached test file and screen shot.@Martin: I have checked a recent master with your patch, sorry for my late check!Createdscreen shot about the last (reintroduced?) bad break positionComment onscreen shot about the last (reintroduced?) bad break positionBad Graphite (above) and correct non-Graphite break positions@Martin, sorry, I reopened this Graphite bug a month ago, but I didn't notice, that you aren't in the CC list of the bug. It seems, this bug is a side effect of your fix for the. Could you help to fix this one? Thanks in advance, LaszloCreatedhyphenation seems OKI may well be missing something but building today from master seems to work for me.(In reply to martin_hosken from)@Martin: For me, too, thanks for checking! I will check with a recent libreoffice-5-0, too, and close this issue.Unfortunately, it seems, there is a bigger problem now, LibreOffice has lost conditional Graphite feature support, for example, extended font name "Linux Libertine G:smcp=1" doesn't result small capitals. I will bibisect it soon, and report the problem.It seems, the lost conditional Graphite feature support is related to the GTK3 transition of master.In the master branch, start LibreOffice with the following parameter to reproduce the ligature hyphenation problem of libreoffice-5-0 (this fixes the lost optional features, for example, the extended font name "Linux Libertine G:smcp=1" will result small capitals again):SAL_VCL_PLUGIN=gen instdir/program/soffice@Martin: I have reverted your commit "fdo#52540 refix graphite layout generally" in libreoffice-5-0 to fix the hyphenation for LO 5.0:The master still have the hyphenation problem.Please don't. That patch fixes way more problems than just not fixing this one. Please put it back. If that patch doesn't fix this problem (as you say, it doesn't introduce it). That is no reason to kick it out. It's every reason to look deeper. If you remove this patch it is up to you now to fix all the bugs that that patch fixed in addition to this one. Those bugs are now yours to fix and to do so in a timely fashion.I am not at all pleased that you have done this without any kind of diagnosis that these patches are causing a problem. Please put the patches back, as soon as possible.In fact, I will go further. The patch does seem to fix 52540. You stated inthat the problem was fixed. You then introduce a different issue (that I suspect has nothing to do with the patch) and rip out a perfectly good solution to the actual bug because it doesn't fix a different issue.I strongly suggest you put the patch back and then raise a separate issue for disabling graphite for a particular font or whatever under a different bug number rather than hijack an existing bug and its fix and holding it to ransom.If not, then you have the responsibility of solving this bug, all the other bugs that reference this bug that are fixed by this patch and also the new issue you raise, all on your own. Alternatively, put the patch back, raise a new bug and I'll take a look.Of course my understanding of this issue and the others may be wrong, in which case I am happy to be enlightened.László Németh committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#52540 Revert "fdo#52540 refix graphite layout generally"It will be available in 5.0.0.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.László Németh committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#52540 Revert "fdo#52540 refix graphite layout generally"It will be available in 5.0.0.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.@Lazlocan we set back status to fixed after your last committ?Migrating Whiteboard tags to Keywords: (bibisectNotNeeded)Createdligature hyphenation test documentHi,The LibreOffice still can't handle the hyphenation correctly with Linux Libertine G.I attached a test document with tt, ff, fb, fl and fi ligatures.Linux Libertine G version 5.1.3LibreOffice 5.1.4.2Xubuntu 16.04.1
id=89070	In database application : Tools/ Filter tablesI am used to filter database tables (Oracle datebase accessed with Oracle JDBC).In previous versions of Base, i can check the tables i want to see.This feature does work in LibreOffice.org 4.0.4, i can check the database tables but after pressing OK, no filter remains and no table appears. Is this specific to having an Oracle db or is it the same for any database that allows filtering ?Confirming on OSX 10.10.2LO master Version: 4.5.0.0.alpha0+Build ID: 48f704c3e1c08ae6e3eee450bf08712dc4caf460Locale: fr_Tested against a remote mysql db instance with default access to all tables.Opened ODBClick on Tables button in left hand pane.Enter password.Then menu Tools > Table filterDeselect all databases but one. The remaining selected database contains approx 15 tables.Click OKMenu View > Refresh tablesAll tables disappear ! Including the database I hadn't deselected.The second time I did this, while writing the comments below to describe what I did, LO SIGABRTs on me, enclosing crash trace produced by Apple.CreatedApple crash traceConfirming also with a jdbc connector to remote mysql instance - all the tables disappear when refresh tables is executed.The crash comment incan be ignored - this is due to a breakdown in network connection between the two machines, for which I've already reported the bug.In my JDBC test, the connection parameters are set up to connect to only 1 database - from the menu Tools Table filters, I deselected a few tables, clicked on OK, then went to to View > Refresh tables. All tables suddenly disappeared.If I go back into the Tools > Table filter menu entry, there are no databases displayed, much less any tables, the whole window is blank.Table filter works in Version: 4.2.4.2Build ID: 63150712c6d317d27ce2db16eb94c2f3d7b699f8Already failing in Version: 4.3.5.2Build ID: 3a87456aaa6a95c63eea1c1b3201acedf0751bd5@Caolan : UI rework related ?(In reply to Alex Thurgood from)Yes, exactly.Lionel Elie Mamane committed a patch related to this issue.It has been pushed to "master":tdf#89070 Table filter dialog: properly initialise OTableTreeListBoxIt will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Lionel: I updated my local master repo and it indeed works but only when relaunching LO. I mean, the filter is taken into account right away in dialog (you can close and reopen the dialog, it's ok) but not for showing tables.Is it another bug or does it correspond to an existing bug?(In reply to Julien Nabet from)Well, let's say at least it is not a regression because it was always like that, as far as I can remember.To apply the new filter, one has to do "Refresh Tables".Doing it automatically after closing the dialog is indeed not a bad idea.Lionel Elie Mamane committed a patch related to this issue.It has been pushed to "libreoffice-4-4":tdf#89070 Table filter dialog: properly initialise OTableTreeListBoxIt will be available in 4.4.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.So, I have just tried this on master Version: 4.5.0.0.alpha0+Build ID: f5e7207053b857b6903a0ab9c161bed9ad7bcee9Locale: fr_While the tables do now disappear after a table refresh, if I deselect the a whole set of table for a given schema at the highest level in the tree, the schema entries do not - aren't they supposed to disappear as well ?(In reply to Alex Thurgood from)Did you deselect the schema entry itself?(In reply to Lionel Elie Mamane from)YesAdditionally, there seems to be a problem re-selecting tables that were previously removed.1) Open ODB2) Tools > Table filter > Select tables to filter out > OK3) Display > Refresh tables > selected tables are now no longer displayed4) Tools > Table filter > select tables to include > OK5) Display > Refresh tables > display remains unchanged, the newly selected tables are not displayed.Seems the fix is incomplete ?(In reply to Alex Thurgood from)Just ot be absolutely clear, because I realise that my use of the word "select/deselect" is not particularly obvious :Step 2 : untick box against tables/schema to removeStep 4 : tick box against tables/schema to includeTesting on a different database file with a mysql JDBC connector, if I untick a table within a schema, then refresh the table list, then return to the Table filter dialog, the previously unticked table no longer even appears in the list...so I can't bring it back, even if I wanted to. At least with the native mysql connector I could re-tick the box against the previously removed table, even if that had no actual effect.Lionel Elie Mamane committed a patch related to this issue.It has been pushed to "libreoffice-4-3":tdf#89070 Table filter dialog: properly initialise OTableTreeListBoxIt will be available in 4.3.7.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.TestedVersion: 4.5.0.0.alpha0+Build ID: 1d85cf3504f5dcbbf0ae017eee47fc5a302a2739TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2015-02-21_00:41:48Locale: fr_FRReopening as one can not bring back removed tables, even if one goes through the process of reselecting them in the Filter dialog.Confirming(In reply to Lionel Elie Mamane from)Is there consensus on this not being a regression? (if so, we should remove the 'regression' keyword)(In reply to Robinson Tryon (qubit) from)There seems to be a mix of different sub-issues here.The original issue mentioned inIS a regression and IS fixed.The issue mentioned in, is AFAIK not a regression.The issue mentioned in comments 14 to 18 and 20 is UNCONFIRMED (only Alex has mentioned it).I recommend the other issues are forked into DIFFERENT bugs and this bug be CLOSED/FIXED again.(In reply to Lionel Elie Mamane from)Removing 'regression' keyword.Marking Summary so I don't spend time on this bug again.
id=69734	CreatedSample document for reproducing the bug + Slideshow showing the misbehaviorProblem description:When I create a dropdown menu (via data/validity, referencing to a certain cell area) in one table, the icon for that dropdown menu appears in all the other tables. Clicking on the fake icon in the other tables, it lists the cells in the same row in that table. However, when I select another cell, the icon and also the underlying functionality disappears.Moreover, when I select another cell in the table I created the drop down menu, the dropdown-icon also disappears (which it shouldn't I suppose).The attachment contains a slideshow and a sample document of this misbehavior.Steps to reproduce:Just open the small sample document in the attachment.Current behavior:- described above -Expected behavior:1) Dropdown-Menu-Icon in all the other tables (except the one where I created it) should neither be drawn nor having a misbehaving functionality2) Icon for the drop down menu in the table i created it should never disappear, whatever cell I select.Operating System: Windows 7Version: 4.1.1.2 release With LibO 4.0.5.2 on Win7Partially reproduced : when clicking on the fake icon, it lists an erratic area (not always the same row).I disagree with your second part : when you are in the table where you have created drop-down menu(s), there is one dropdown menu per cell selected/marked at the data > validity setting, and only the dropdown menu icon of the selected cell (if it has some) is shown. For me, this is the correct behavior.(In reply to)Thanks Dominique first of all for investigating into this issue.Yes, the false icon should definitely disappear when changing the tables.Concerning the second issue: In the past experience of Open Office etc., the dropdown icon never disappers in the table you created a dropdown menu, whatever cell selected. Selecting any cell should not result in removal of all other icons (I really mean the icons, not the menue functionality itself!).In our business, when filling out a formula, with the current behavior each time you have to first select the cell with the dropdown menu, then select the drop down icon. Why not show valid drop down icons all the time? I consider this as being a bug, am I wrong?Why not show valid drop down icons all the time ?To my knowledge, no other spreadsheet software found it valuable (I can't remember for earlier versions of OOo, but AOO 4.0 don't do it). Probably because it will definitivly hide part of the content of all cells right to icon-showing ones ; and perhaps because it could lead to a huge number of visible icons (hugely overloaded screen).I do not reproduce with version 4.1.4.0.0+ under Ubuntu 13.10 x86-64. No fake icon for me.Please could you upgrade your installation to the current stable version (4.1.3) and try again?Best regards. JBFDear Bug Submitter,This bug has been in NEEDINFO status with no change for at least 6 months. Please provide the requested information as soon as possible and mark the bug as UNCONFIRMED. Due to regular bug tracker maintenance, if the bug is still in NEEDINFO status with no change in 30 days the QA team will close the bug as INVALID due to lack of needed information.For more information about our NEEDINFO policy please read the wiki located here:If you have already provided the requested information, please mark the bug as UNCONFIRMED so that the QA team knows that the bug is ready to be confirmed.Thank you for helping us make LibreOffice even better for everyone!Warm Regards,QA TeamDear Bug Submitter,Please read this message in its entirety before proceeding.Your bug report is being closed as INVALID due to inactivity and a lack of information which is needed in order to accurately reproduce and confirm the problem. We encourage you to retest your bug against the latest release. If the issue is still present in the latest stable release, we need the following information (please ignore any that you've already provided):a) Provide details of your system including your operating system and the latest version of LibreOffice that you have confirmed the bug to be presentb) Provide easy to reproduce steps – the simpler the betterc) Provide any test case(s) which will help us confirm the problemd) Provide screenshots of the problem if you think it might helpe) Read all comments and provide any requested informationOnce all of this is done, please set the bug back to UNCONFIRMED and we will attempt to reproduce the issue. Please do not:a) respond via email b) update the version field in the bug or any of the other details on the top section of FDOI just witnessed this in 5.1.3 and in 5.3.0.3 after upgrading.Create multitabbed spreadsheet with data including a cell that has a dropdown.Select the cell with the dropdown so the dropdown arrow appears.Change to a different tab, the dropdown arrow is still visible.Select the dropdown arrow, and the dropdown is populated with values from the same column.Linux Mint 18.0
id=105566	Currently the status of the signature is shown as an icon in the status bar:When the signature is broken, we should display a red infobar instead.Maybe we could also display an InfoBar for the other two states (valid, partly valid). That's a perfect example for the infobar. The question is only red or yellow to me, and I tend to yellow for all states.I'd prefer red for the 'broken signature' state (when someone tampered with the document), vs. yellow for less severe situations, like unknown key, untrusted cert chain etc.Agree with Thorsten.Just wonder whether we should show an InfoBar in the "All good" state. Maybe that could be too annoying for people who use this feature often.Samuel Mehrbrodt committed a patch related to this issue.It has been pushed to "master":tdf#105566 Show InfoBar when signature is invalidIt will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Samuel Mehrbrodt committed a patch related to this issue.It has been pushed to "master":tdf#105566 Show InfoBar also for signed docs with warningsIt will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.CreatedExample file: Broken signatureCreatedExample file: Unverified certificateSamuel Mehrbrodt committed a patch related to this issue.It has been pushed to "master":tdf#105566 Close Infobar after clicking action buttonIt will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Two design issues that might be not your fault: the red is unexpected dark; hope you make use of constants (haven't checked this red infobar against other errors). The black font on this dark red has not enough contrast, either it needs to be light grey or the red becomes brighter. After checking the other document I'm not so sure about whom to blame as orange is likely not a default. We must not make the infobar a rainbow :-). Please use THE default red and beige.Workflow: Red infobars are about serious problems and I would not expect to be able to "acknowledge" them. So as long the user don't dismiss explicitly it should be on top. The "Show signatures" function is rather a convenience function than a confirmation. (When I changes something and do not save when asked for the red infobar has disappeared but the signatures dialog won't be shown.) My suggestion is to close only with the x (an additional button is too much noise).Nitpick: Buttons are labeled with title style capitalization, and like "Edit Document" it has to be "Show Signatures".Would be nice to have the same width for buttons (Show Signature is slightly longer than Edit Document). But I wouldn't put too much effort in it.(In reply to Heiko Tietze from)The foreground color for red and orange is now white.I don't know what you mean with default red and beige.There are different levels with different colors. Error is red, warning is orange, info is yellow.I took the colors from the classification infobars.I don't understand exactly what you mean here.Btw I changed the behavior so that the infobar hides when you click the "Show signatures" button.I don't understand this either.The button shows the Signatures dialog where you can "fix" the problem. I don't think that is noise, it helps the user doing the action he is expected to do.Fixed.The button width is calculated on demand as different translations need different widths. So this is wontfix.Thanks for the comments!Another question: When the document is signed (valid signature) and the user edits it, the signature becomes invalid and it needs to be re-signed.Should we take any action here? (Show an InfoBar, or something).Btw the status of the signature is also shown in the status bar. This status should also be visible there.(In reply to Samuel Mehrbrodt (CIB) from)Sounds as a good idea.Along the lines of Singing an existing PDF: when that function is started and the user starts to edit the PDF anyways, a warning message is show.So something similar looks reasonable.What do you mean with "this status"?(In reply to Cor Nouws from)Like in Calc it should be a confirmation box with the option to never show again.Samuel Mehrbrodt committed a patch related to this issue.It has been pushed to "master":Revert "tdf#105566 Close Infobar after clicking action button"It will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=62879%0D%0A	Problem description: When trying to edit a write protected section, the error message reads "Readonly content cannot be changed.". This is confusing as it gives no glue how to fix the problem. The instinct is to click the "Edit file" -button. The error message should be reformulated so the user knows to edit the section properties.Steps to reproduce:1. Insert a write protected section (Insert -> section, check “Protect” -check box and click “Insert” -button)2. Place cursor inside the section and try to type somethingCurrent behavior:Error message is shown:Readonly content cannot be changed.No modifications will be acceptedExpected behavior:Error message should read:Write protected sections cannot be changed.No modifications will be accepted.Or something along these lines.Operating System: AllVersion: unspecified This bug seems also been reported to Apache OOO bug tracker:Verified:Ubuntu 14.04 x64LibreOffice 4.4 master built a few days agoSure seems fine.Marking asNEWEnhancementLowestNeedDevEval (really easy to fix, code pointer I'm sure would be easy to find)Nevermind I just committed a patch - no need for code pointersJoel committed a patch related to this issue.It has been pushed to "master":fdo#62879 Changed wording of protected section dialogThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.In that patch, “Write protected” is a compound adjective. Shouldn’t it be written hyphenated, for clarity?: “Write-protected sections cannot be changed.”I suppose so - I'll set this to reopened until I submit a follow up patch.This has been pushed and should be in 4.4.Joel committed a patch related to this issue.It has been pushed to "master":fdo#62879 HyphenationIt will be available in 4.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Reopening - I think this change should be reverted as the dialog and the "corrected" message are not specific for sections.Try e.g. this:1. In a new text document, choose Insert - Frame.2. On the Options tab, check the Content box in the Protect area and press OK.3. Try to write inside the new frame.You will see the dialog with the "Write-protected sections cannot be changed" which is clearly wrong here since not section, but frame is involved.Patch changing word "sections" to "content" submitted to Gerrit:Stanislav Horacek committed a patch related to this issue.It has been pushed to "master":related fdo#62879 replace "section" in dialog for read-only contentIt will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Stanislav Horacek committed a patch related to this issue.It has been pushed to "libreoffice-4-4":related fdo#62879 replace "section" in dialog for read-only contentIt will be available in 4.4.0.0.beta3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Looks like patches were pushed after bug was last set to REOPENED status. Are we all done here?Status -> NEEDINFO(In reply to Robinson Tryon (qubit) from)No. My patch only restored the previous state, user is still provided by message about write-protected content (the content is not specified - like section, frame or whatever). This cannot be fixed by a simple change of the message text.Dear Bug Submitter,This bug has been in NEEDINFO status with no change for at least 6 months. Please provide the requested information as soon as possible and mark the bug as UNCONFIRMED. Due to regular bug tracker maintenance, if the bug is still in NEEDINFO status with no change in 30 days the QA team will close the bug as INVALID due to lack of needed information.For more information about our NEEDINFO policy please read the wiki located here:If you have already provided the requested information, please mark the bug as UNCONFIRMED so that the QA team knows that the bug is ready to be confirmed.Thank you for helping us make LibreOffice even better for everyone!Warm Regards,QA TeamThis NEEDINFO message was generated on: 2015-09-03Set to REOPENED as the needed info was provided in.
id=66088	In theory, only operators like those mentioned inshould be exported as <mo> elements. Symbols like emptyset, aleph, setN that are more like variables should use <mi> elements instead. NEW right away :).Kind regards,JorenI've submitted a patch for review:Marking these bugs assigned since I've already taken them.Frederic Wang committed a patch related to this issue.It has been pushed to "master":fdo#66088 Export some math symbols as <mi> elements.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Reopening this bug as it seems that I overlooked the NSPECIAL and NGLYPH_SPECIAL cases.NGLYPHSPECIAL correspond to the commands uoper, boper, oper to define operators and so should still be exported as <mo> elements.NSPECIAL correspond to the %xxxx commands. Most of them are greek letters like %alpha so should be exported as <mi> elements. Other correspond to binary operators (without syntax verification) like %and so should be exported as <mo> elements. I think users can define their own %xxxx commands so a generic way to detect whether a character is an operator is needed ()Frederic Wang committed a patch related to this issue.It has been pushed to "master":fdo#66088 - follow-up: handle NGLYPHSPECIAL and NSPECIAL too.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.This is not completely fixed and depends on. %xxx are now exported as <mi>'s rather than <mo>'s which is OK since most of them are Greek letters. But a few commands like %noelement should be <mo>. Users can also define their own commands with the Catalog menu. See.OK, I overlooked that.
id=97203	Createdvisio2016 example of the correct shapeHI,I got an vsd-document from a friend. It contains an organigramm with round shapes for displaying different properties. When I opened it in libreoffice version: 5.0.4.2 under windows 7 - 64 bit the shapes aren`t displayed correct. I prepare some documents for the this bug reportes: The original vsd was created with visio xx (I don't now). I copied one shape to visio 2016, save it as Zeichnung11.vsd and Zeichnung11.vsdx. Opened it in libreoffice draw, the result is shown in the screenshots with 2016-01-19_23h40_x. In the screenshot upper left corner is the name of filename displayed. Both imports are incorrect, you got an rectangle in the correct color, but the circle is displayed in grey above. The correct result is shown in Zeichnung11.pdf, exported from visio16.Best regards,Christoph Createdvisio2016 as vsd sample fileCreatedthe wished layout as pdf shown in visio2016Createdimport in draw of Zeichnung11.vsdCreatedimport in draw of Zeichnung11.vsdx*** This bug has been marked as a duplicate of***HI, I open the bug again with the newest libreoffice version the vsdx is not imported correctly.Version: 5.2.3.3Build-ID: d54a8868f08a7b39642414cf2c8ef2f228f780cfCPU-Threads: 4; BS-Version: Windows 6.1; UI-Render: Standard; Gebietsschema: de-DE (de_DE); Calc: CLCreatedScreenshot of the wrong display round circle, only the inner circle should be filled with the color.
id=101815	CreatedExampleIn some cases the text is not redrawn after using spell check to correct a word in outline mode. Adding more text to the line or switching the view mode is needed to trigger the redraw. Seems to only happen on bullet points, not on slide titles.Works as expected in 5.0.6.2 (fedora 23 package). Does not redraw in 5.2.0.0.beta2 (flatpak verison on fedora). So could be a flatpak or gtk3 issue.Steps to reproduce.1) Open attached file2) go to outline mode (View -> Outline)3) right click on the misspelt word "piont", and select the correct spelling "point"4) old spelling is still displayed Setting it to 'New' as I can reproduce it withVersion: 5.3.0.0.alpha0+Build ID: 9299b4ed1fd6aec795e55cf9a5a67f6111b48f7cCPU Threads: 4; OS Version: Linux 4.2; UI Render: default; Locale: ca-ES (ca_ES.UTF-8); Calc: groupHowever, I can't reproduce it withVersion: 4.3.0.0.alpha1+Build ID: be44f0e91b6061f6bbe6b4da2f264eed70fb6542Thus, adding Keyword 'Regression'Issue introduced in range ee3d40b30816a8fc6d4e8f984659c8dfac19ec3b..efa2c05e84d0696b31bd822d3234798be43853ad(In reply to Xisco Faulí from)Ubuntu 16.04: I'm reproducing this all the way back to last36onmaster in bibisect43all (the oldest I can test).Proposed fix:tdf#101815 SetMustRepaint when InsertTextJustin Luth committed a patch related to this issue.It has been pushed to "master":tdf#101815 editeng SetMustRepaint when InsertTextIt will be available in 5.3.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.My fix inwas not targeted enough and caused. Reverting the fix and re-opening this bug.Justin Luth committed a patch related to this issue.It has been pushed to "master":revert tdf#101815 editeng SetMustRepaint when InsertTextIt will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Justin Luth committed a patch related to this issue.It has been pushed to "libreoffice-5-3":revert tdf#101815 editeng SetMustRepaint when InsertTextIt will be available in 5.3.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.proposed replacement patch
id=43021	Problem description: Steps to reproduce:1. Open the Basic IDE (Alt+F11)2. Enter the macro below:Sub testFilePickerDialog oFilePickerDlg = _ createUnoService("com.sun.star.ui.dialogs.FilePicker") oFilePickerDlg.setDisplayDirectory(ConvertToURL("C:\")) oFilePickerDlg.execute()End Sub3. Run the macroCurrent behavior:The file picker opens displaying the default pathExpected behavior:The file picker opens displaying the specified path ("C:\")Platform (if different from the browser): Browser: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:8.0) Gecko/20100101 Firefox/8.0 Hello I Can confirm that behaviour.But this Bug seems to bee older.I'm using LO 3.3.4 (German ) and Windows7 64 bitOn my Linux - System Te Problem doesn't exist.But I remember , that this Problem also appeared in earlier Versions.I know for sure that it also appeared in Version 3.3.3 .but I don't know in which version it appeared first.Workaround:Use the FilePickerDialog from Libreoffice instead of the one from Windows.Menu: Tools-> Options-> LibreOffice->General->Select "Use LibreOffice diaogs"Hello I Can confirm that behaviour.But this Bug seems to bee older.I'm using LO 3.3.4 (German ) and Windows7 64 bitOn my Linux - System Te Problem doesn't exist.But I remember , that this Problem also appeared in earlier Versions.I know for sure that it also appeared in Version 3.3.3 .but I don't know in which version it appeared first.Workaround:Use the FilePickerDialog from Libreoffice instead of the one from Windows.Menu: Tools-> Options-> LibreOffice->General->Select "Use LibreOffice diaogs"NOT reproducible with "LibreOffice 3.4.5 German UI [Build ID: OOO340m1 (Build:502)]" parallel Server installation on German WIN7 Home Premium (64bit),NOT reproducible with "LibreOffice 3.5.1.2 German UI/Locale [Build-ID: dc9775d-05ecbee-0851ad3-1586698-727bf66] on German WIN7 Home Premium (64bit) @Frieder:NEW is reserved for bugs that need a fix.<>HelloI tested it with Lo 3.4.5 portable(German), and LO 3.5.0 RC2 (on win7 premium 64bit German)and with both versions the bug is still there.The FilePicker is one of the most used functions in Macros, Extensions, and Templates.and therefore this bug should be fixed soon. @Rainer Bielefeld:It was and is absolutely correct, that I selected "New" for the Status,because this Bug needed to be fixed at the time I wrote the report,and it still needs to be fixed.But you are wrong, putting the State to "resolved".Up to now nobody fixed this bug, so I really doubt, that you tested it correctly.Are you sure, that you used the Windows-dialogs, and not the LibreOffice-diaogs?regards FriederStrange, I can't reproduce my successful test I did in the morning. Now it's reproducible with all LibO Versions I tested on WIN7 64 bit (including Master 3.6). May be my lots of tests with various versions, profiles, ... die some faith healing :-/Seems inherited from OOo, because OOo 3.3 and OOo 3.4 show the same problem. Works fine with OOo 3.1.1Works fine With LibO 3.5 IWN XP 32bit on VirtualBoxSomething strange I remember from my tests in the morning is that I saw "C:\" in the file dialog Path pane instead the normal "> Computer > Local HD (C:) > ", what ever that might explain.Using URL syntax "file:///C:/" will work, but not heal the problem with the WIN dialog.@Noel:Please set Status to ASSIGNED and add yourself to "Assigned To" if you accept this BugHelloAddition:I just installed LO 3.5.1.rc2 in parallel, and tested it.Result:The Bug is still there. My System:Win 7 Premium 64bitHelloAddition2:Maybe it is helpful for the one, how is going to fix this bug, to know,that the Windows FolderPicker-dialog works fine.Sub testFolderPickerDialog oFolderDialog = CreateUnoService("com.sun.star.ui.dialogs.FolderPicker") oFolderDialog.SetDisplayDirectory(ConvertToURL("C:\")) oFolderDialog.ExecuteEnd SubIf you run this macro, the Windows FolderPicker-dialogopens in the directory C:\, as expected.regards Frieder(LO3.5.1.rc2 on Win7 )Now works for me with parallel installation of Master "LOdev 3.6.0alpha0+ WIN7 Home Premium (64bit) ENGLISH UI [Build ID: 5b81e2d]" (tinderbox: W2008R2@20-With-Symbol-Bytemark-Hosting, pull time 2012-05-23 22:18:38)Please fell free to reopen if you see the problem reappearing.This problem still exists for me using 3.5.4 on Windows 7 64-bit. Dialogs work as expected when using LibreOffice dialogs but do not work when using system dialogs.For more background on the problem see this old OpenOffice bugBug still exists in 3.6.0.4. setDisplayDirectory is completely ignored on my Windows 7 system.Noteworthy side effect of this: passing in "" as the argument produces no error on Windows but does on Linux (a warning dialog appears when the filepicker is executed).Just tested it with Version 4.0.2.2 on a Windows 7 x64 Prof. System.It also displays the wrong directory, no matter if i'm using drive names like "C:\" or UNC-Paths like "\\Servername\somedir\".Along i tried to get the actual directory from the filepicker with oFilePickerDlg.getDisplayDirectory() and getting an empty string back.Hey guys,PLs leave the version to the oldest known version with the problem.This:shows it's an old bug from OOoFound a workaround, still think that it would be nice if it worked without the extra code just as it does on other platforms.If we explicitly initialize the dialog then we are able to use setDisplayDirectory. Sub testFilePickerDialog oFilePickerDlg = _ createUnoService("com.sun.star.ui.dialogs.FilePicker") Args = _ Array(com.sun.star.ui.dialogs.TemplateDescription.FILEOPEN_SIMPLE) oFilePickerDlg.initialize(Args) oFilePickerDlg.setDisplayDirectory(ConvertToURL("C:\")) oFilePickerDlg.execute()End SubJust for reference some other ways to initialize the dialog.I'm a bit confused now. I have been using code similar tofor some time now and it did not work on Windows 7, so I switched to using the LibreOffice dialogs (which my users didn't like very much). Now that I seeI tested my code with Windows System dialogs and it works! So I'm guessing something was fixed in a prior release of LibreOffice or in a Windows 7 update. Anyway, my users will be happy about this. We are still on 4.0.1.2.So I'm confused now too. The code that I posted in June does not work anymore. This time I tried it in LibreOffice 4.0.4. There might very well be some change in Windows that triggered the problem to reappear. Does anybody else have an older version installed like 4.0.3 and a 64-bit version of Windows 7? I think that I used 4.0.4 when testing my code the last time.It still works for me with Libre 4.0.1.2 and Windows 7 x64. Windows is fully up-to-date. So if it isn't working for you in Libre 4.0.4 then it seems like a Libre problem rather than a Windows problem. That would be disappointing and would prevent me from upgrading my 28 users.Assign it to me***has been marked as a duplicate of this bug. ***The comments inshould be useful in further narrowing down the problem. It says that the 4.0.3.3 works but the problem reappears in 4.0.4.2 and 4.1.0.4.I just upgraded to 4.1.3.2 and the problem is gone again. I guess I would consider marking this closed, except that I'm not sure anyone understands why it keeps reappearing in subsequent releases.libreoffice 4.2.0.4 64bit, windows 7 german: The problem is here again, the described workaround indoes NOT work.That's really disappointing. There is another fix in 4.2 that my 30 users are waiting for, but this is more important for us. I'm wondering if we could get more attention by changing the Version from "Inherited From OOo" to "4.2.0.4 release". After all, this is really a regression, since there was no problem with the previous version. Opinions?I've installed version 4.2.1.1 and the bug seems to be gone again. Yay!updated to 4.2.1.1, win 7 same setup as in:tried out samples description and from:with internal file dialog everything works as expected,with windows file dialog the directory T:\TEXTE (one of the used standard directories of the user) is always opened.I searched for T:\Texte in registrymodifications.xcu but beside history entries nothing was found.where could the strange "T:\Texte" default come from ?The behaviour is consistent over the 7 machines deployed here.Only one machine is used to make manual changes, every other machine is getting an automated setup.English version of 4.2.3.3 is working for me.I spoke too soon. I installed 4.2.3.3 on a test machine and it is working fine, but then I installed on two more office machines and the FilePicker bug is back on those machines. Currently scratching our heads to try to find any difference between the two installs that would account for this.Any troubleshooting suggestions welcome.i did not try 4.2.3.3 so far, but the behaviour is similar. It worked in the beginning, but stopped soon after. I also have no idea what changed in between.I succeeded in breaking the installation that was working simply by using the Windows System SaveAs dialog to save a file. Now the FilePicker ignores my specified directory and defaults to the directory where I last saved a file (using the system SaveAs). I thought I might be able to clear this value before I call FilePicker, but I haven't been able to figure out where windows is saving it.I can confirm that I have observed this problem as well (Windows 7, 64bit, LibreOffice 4.2.3.3). The LibreOffice dialog works, all attempts to call setDisplayDirectory() have no effect. Any calls to getDisplayDirectory() return an empty string (""). The get/setDisplayDirectory() works fine when the LibreOffice dialog style is slected. Both system/LibreOffice dialog(s) work for valid paths on Linux (fc20, also LO 4.2.3.3).After running numerous test cases, it appears that for my installation the directory that is shown was a FilePicker selection made in some prior call to execute the dialog. This can be reproduced by running a simple test/demo program that selects a file (you don't need to actually do anything with the file), and from them on that is the initial directory displayed.I can also verify that getDisplayDirectory() continues to return "".I was going to report this as a bug, but noticed that this bug was already opened. Let me know if you need more info and/or screen shots.FYI, I may have uncovered a related problem. There appears to be a race condition where getDisplayDirectory incorrectly returns an empty string. Seefor more information.I can confirm that FolderPicker, while mirroring FilePicker behavior in almost all respects, does NOT reproduce Bugzilla 43021 behavior. Hope this helps in tracking down the problem.Confirmed by swapping FolderPicker for FilePicker when creating dialog object and comparing "working" vs. "non-working".Screen shots and code used to reproduce problems uploaded supporting Bugzilla 78210 and 78315.Just confirming that the bug still exists in LO 4.2.4.2 English.More possibly useful debugging information:Sub testFilePickerAgain oFilePickerDlg = createUnoService("com.sun.star.ui.dialogs.FilePicker") Args = Array(com.sun.star.ui.dialogs.TemplateDescription.FILESAVE_SIMPLE) oFilePickerDlg.initialize(Args) oFilePickerDlg.setDisplayDirectory(ConvertToURL("C:\")) oFilePickerDlg.execute()End SubIf I change FILESAVE_SIMPLE to FILESAVE_AUTOEXTENSION the dialog box opens in a different (but still wrong) directory. Changing back to SIMPLE changes the opening directory back to the previous (but still wrong) directory.Just confirming the bug still exists in 4.2.5.2.as additional information, using the internal libreoffice filepicker is a suboptimal workaround, because it consumes lot of cpu cycles every time a directory gets opened if there are more than 50 to 100 documents inside this directory. (as in 2 to 3 seconds for save or open)My workaround is to move old documents out of the way in a archive directory (which would be done anyways, but only after the document was not modified within 3 months, which is currently to much to use the internal filepicker without interrupting the workflow of the user (eg. 2 seconds or more on save, open, a.s.o)(In reply to Ewald Anderl from)That is a different problem. I have put it into, and I have a fix for that..CreatedA macro workaround for setDisplayDirectoryI have attached a document, which contains a macro with a workaround I have got from. If you want to test it, you need a current daily build, which contains already the fix of.It is not a total solution but a workaround. The directory, which the user has used for opening, is not written back to the file picker object in Basic. I have initialized the file picker object again and then the updated DisplayDirectory is available. I suspect, that it is not a problem in the code of the file picker, because that works in normal situations. But I think it might be a problem in the way Basic uses these objects.Great to see renewed interest and some progress on this longstanding bug. Rather than messing with the daily build, can I just wait for 5.0.2 and then test the workaround?No, the needed corrected getDisplayDirectory will be available in 5.0.3, not in 5.0.2.(In reply to Mark Nienberg from)Just to clarify, you can still use the workaround in current versions of LibreOffice and the correct display directory will be shown. It is the fix for getDisplayDirectory that you need to wait for.Thanks a lot Regina and OliverWorth noting is Ariel's comment that one can use the service:"com.sun.star.ui.dialogs.OfficeFilePicker"instead of "com.sun.star.ui.dialogs.FilePicker"and thereby use LibreOffice own dialogs without changing the default setting for other scenarios opening files etc.Confirmed that the workaround solves the display directory problem for me using 5.0.2. My code isn't using getDisplayDirectory so I am finally able to revert to the System dialogs. My users will be happy with this!Thanks to all who have been and still are working on this issue.
id=103831	Description:When I use LODev Writer, open Character dialog, I found sample text always overlap each other.Steps to Reproduce:1. Open LibreOfficeDev Writer2. Format > Character Actual Results: See my attchmentExpected Results:-Reproducible: AlwaysUser Profile Reset: NoAdditional Info:Version: 5.3.0.0.alpha1+Build ID: 05d2a66955f8a6552a79696474386ca9f45f9ef2CPU Threads: 4; OS Version: Windows 6.2; UI Render: default; Layout Engine: new; TinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2016-11-07_23:34:48Locale: zh-CN (zh_CN); Calc: groupUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:49.0) Gecko/20100101 Firefox/49.0 CreatedScreenshot from LODev WriterCan you test with the old layout engine, and/or 5.2?Createdsampler - character previewsampler of the Character dialog previews by renderer and layout engine...Version: 5.3.0.0.alpha1+Build ID: f6391d9696bfa7485bf785ac81edef4d5441e232CPU Threads: 8; OS Version: Windows 6.2; UI Render: GL; Layout Engine: new; TinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2016-11-10_00:11:47Locale: en-US (en_US); Calc: CLthe sample text, or selection, is generated in theSvxFontPrevWindowConfirming things degrade a fair bit with the HarfBuzz layout.Seems we directly scale the selection or sample text to compose the preview for rendering in the dialogSo is this another DirectWrite scalling issue, or something in the way the dialog is being composed misbehaving with HarfBuzz layout? And then there isfor combining forms that has long had an issue with the preview.@Tomaž, Chris?(In reply to V Stuart Foote from)Oh, that is just broken! Setting font width means “scale the text horizontally by the font width / font height” not ”set text to fit in this width”. I blame the odd choice for naming, it should have been X scale and Y scale not width and height.so this is another duplicate of, though I think the right fix here is to not set font width at all.(In reply to Khaled Hosny from)Reading the code above again, I’m not sure it does what I thought it is doing.Font scaling issue.*** This bug has been marked as a duplicate of***@Khaled, reopening this rather thanOn windows 10 Pro 64-bit en-US with recent master or withVersion: 5.3.0.3 (x64)Build ID: 7074905676c47b82bbcfbea1aeefc84afe1c50e1CPU Threads: 8; OS Version: Windows 6.19; UI Render: GL; Layout Engine: new; Locale: en-US (en_US); Calc: groupWith OpenGL rendering enabled, the font name preview or a selection of text for preview in the Character dialog is again being compressed.Preview appears reasonable with default GDI based rendering.STR1. new Writer document with OpenGL rendering enabled2. enter sample text "Some sample text for preview"3. select text4. context menu -> Character dialogexpected -- preview should be formatted as on document canvasactual -- preview is compressed horizontally5. disable OpenGL (Tools -> Options -> View) and restart6. repeat 1 - 4actual -- preview is formatted as on document canvasSo this handling for the dialog preview seems correct with HarfBuzz for GDI, but not with DirectWrite--while rendering to document canvas seems unaffected.***has been marked as a duplicate of this bug. ***Just with OpenGL rendering enabled.Initially during HarfBuzz implementation this affected both default GDI and OpenGL based rendering. Now (at 5.3.0.3) correct with default GDI handling, but OpenGL rendering of the character preview remains compressed.***has been marked as a duplicate of this bug. ***The incorrect glyph spacing with OpenGL rendering is also affecting preview/sample text on Impress master slides--and***has been marked as a duplicate of this bug. ***-- Text width scale doesn't work when not 100% and OpenGL is enabled, suggests the issue here is not with the Character style dialog but in mishandling of Direct2Write/DirectWrite font scaling applied to the sample text or selection composed in the dialog when OpenGL is enabled.Default GDI+ based rendering handles font sample/selection correctly.***has been marked as a duplicate of this bug. ***
id=98416	Steps:1) Open a release version of LO, which has google drive access2) File > Open Remote File3) Click 'Add Service' button4) Fill in Google Drive details5) When pressing OK you get a 'The specified device is invalid.' error dialog.This didnt occur on Windows.Version: 5.1.1.3Build ID: 89f508ef3ecebd2cfb8e1def0f0ba9a803b88a6dCPU Threads: 2; OS Version: Linux 4.2; UI Render: default; Locale: en-US (en_US.UTF-8) (In reply to Yousuf (Jay) Philips from)'The specified device is invalid.' error dialog appears only when I enter wrong password. You are sure that on other OS you entered correct login and password?By the way, I think we should change this mysterious message to something more clear in case of providing incorrect combination :)Version: 5.1.2.0.0+Build ID: bba00901f55bfd4fa476667baaf2b2e7e1f58762CPU Threads: 4; OS Version: Linux 4.1; UI Render: default; Locale: pl-PL (pl_PL.UTF-8)(In reply to Szymon Kłos from)As stated in the other bug, it was the right password as i got an email from google saying a successful login, but still was getting this error.Yes if that is the error for an incorrect password, we definitely need to change it. I see that its found below, but i would assume that error maybe used elsewhere for something different.CreatedWireshark log of failing Linux Google Drive connectionWireshark log of failing Linux Google Drive connection, obtained with:Version: 5.1.1.3Build ID: 89f508ef3ecebd2cfb8e1def0f0ba9a803b88a6dCPU Threads: 8; OS Version: Linux 3.13; UI Render: default; Locale: en-US (en_US.UTF-8)It seems the TLS 1.2 protocol never started.CreatedWireshark log of a working Linux Google Drive connectionThe log was obtained using a LO 5.1.1.3 version, compiled from public source code, using my own Google application ids.As can be seen in the log, after the first three standard sync messages, the TLS protocol started.Set as NEW, this bug affects LO 5.x Linux TDF builds.Just tried this on a new installation of Ubuntu Mate 16.04 which comes with 5.1.0.3 and got the same error and got an email from google confirming the sign-in.So did some testing of old builds and they have failed to connect to Google Drive on linux since 4.2, when this feature was introduced, and only with the new remote file dialog is an error message appearing.This bug could be related with:It is marked as resolved, but it was mentioned that not in all cases.(In reply to Szymon Kłos from)It was never fixed, see:Giuseppe Castagno committed a patch related to this issue.It has been pushed to "master":tdf#98416: Explicitly disable curl hardcoded CA certificate storeIt will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.@Szymon: So how can we correct the incorrect login error message?Christian Lohmaier committed a patch related to this issue.It has been pushed to "master":tdf#98416 fix curl's configure check for nss (missing -lnssutil3)It will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Usually daily masters are not Google Drive enabled, this:<>It's a special version of master build specifically created to check this bug.A comfirmation will be appreciated.Thanks.(rpms also provided at the gdrivetest2 url)Note that there's still(two-factor auth for gdrive not working) - so if you want to test, you have to disable two-factor authentication temporarily.Giuseppe Castagno committed a patch related to this issue.It has been pushed to "libreoffice-5-1":tdf#98416: Explicitly disable curl hardcoded CA certificate storeIt will be available in 5.1.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Thanks Giuseppe. It works correctly now in cloph's special daily build. Would be good to backport this also to 5.0.I've created a separate bug report to deal with the incorrectly phrased error message for a wrong password ().Version: 5.2.0.0.alpha0+Build ID: 98d48dad9e807a4a40f4c3d1b5280d9e5156cb18CPU Threads: 2; OS Version: Linux 4.2; UI Render: default; Locale: en-US (en_US.UTF-8)***has been marked as a duplicate of this bug. ***Christian Lohmaier committed a patch related to this issue.It has been pushed to "libreoffice-5-1":tdf#98416 fix curl's configure check for nss (missing -lnssutil3)It will be available in 5.1.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Christian Lohmaier committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#98416 fix curl's configure check for nss (missing -lnssutil3)It will be available in 5.0.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Tested withVersion: 5.1.2.0.0+Build ID: 750fcdef6551f069badb802649a665e147e69083CPU Threads: 2; OS Version: Windows 5.1; UI Render: default; TinderBox: Win-x86@62-merge-TDF, Branch:libreoffice-5-1, Time: 2016-03-15_16:35:55Locale: pt-PT (pt_PT)under Windows XP Pro x86 SP3 (there isn't any newer 5.1 build for x86 and the latest 5.0 build is from March 7th)It isn't fixed and in fact it locks before any fields can be filled.(In reply to Pedro from)This bug was specifically for linux, so i'd suggest opening a new bug specifically about it not working on XP.(In reply to Yousuf (Jay) Philips from)So, more than the XP specific?Giuseppe Castagno committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#98416: Explicitly disable curl hardcoded CA certificate storeIt will be available in 5.0.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.In 5.1.2.2 I still receive response The specified device is invalid on attempt to open remote file on Google drive. Ubuntu 14.04 32 bitDidnt work for me either on Linux.Version: 5.1.2.2Build ID: d3bf12ecb743fc0d20e0be0c58ca359301eb705fCPU Threads: 2; OS Version: Linux 4.2; UI Render: default; Locale: en-US (en_US.UTF-8)(In reply to V Stuart Foote from)No that is fine for it.It still doesn't work under Windows 7 x64.Using 5.1.2.2 x64, the message is still "The specified device is invalid."Testing the latest x64 dev build (there aren't any for 5.1 or Master)Version: 5.0.6.0.0+ (x64)Build ID: 1f7af80f020a9114d7b6b4014a4ebb71cb81d8a1TinderBox: Win-x86_64@62-TDF, Branch:libreoffice-5-0, Time: 2016-03-24_12:43:39Locale: pt-PT (pt_PT)There is no error because Google Drive Server Type is no longer available.→ that is expected, nightly builds don't have necessary keys. It is planned to have dedicated keys for daily builds in future.And RE not working in RCs/final builds:If the comment doesn't explicitly state "I really don't use two-factor authentication and the problem occurs nevertheless", I mentally immediately treat it as dupe to(see also)(In reply to Christian Lohmaier from)I had already answered to you personally on IRC that I don't use two-factor authentication but here is the explicit statement: "I really don't use two-factor authentication and the problem occurs nevertheless"(In reply to Christian Lohmaier from)I dont use 2FA. :DSpent some time hunting this bug in master.I found that Google changed the OAuth 2.0 login procedure used by LO (more specifically by libcmis) to login.If what I suspect is right, all LO versions are now unable to login to Google Drive.Can someone check on LO older versions?The operating system doesn't matter.(In reply to Giuseppe Castagno (aka beppec56) from)Tested with LO 4.4.7, 4.3.7 and 4.2.8 under Windows 7 x64.Result for all: General input/output error.The reason for Google Drive login failing is this one:Changing the login sequence from one html page to two broke libcmis.I worked out a solution in Linux that works. Need to test in Windows , will take a few days.Giuseppe Castagno committed a patch related to this issue.It has been pushed to "master":Related tdf#98416 Libcmis: add a patch to fix Google Drive loginIt will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Giuseppe Castagno committed a patch related to this issue.It has been pushed to "libreoffice-5-1":Related tdf#98416 Libcmis: add a patch to fix Google Drive loginIt will be available in 5.1.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Giuseppe Castagno committed a patch related to this issue.It has been pushed to "libreoffice-5-1-3":Related tdf#98416 Libcmis: add a patch to fix Google Drive loginIt will be available in 5.1.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.5.1.3.2 is ready to be tested, download from here:Fixed in:Version: 5.1.3.2Build ID: 644e4637d1d8544fd9f56425bd6cec110e49301bCPU Threads: 8; OS Version: Linux 3.13; UI Render: default; Locale: en-US (en_US.UTF-8)(In reply to Giuseppe Castagno (aka beppec56) from)It is indeed fixed in 5.1.3.2!Grazie mille!I am using Ubuntu 16.04 and LO Version: 5.1.4.2 (Build ID: 1:5.1.4-0ubuntu1) and the problem is not solved for me.what info can I provide to check further?(In reply to Pierre van Male from)The steps you used to reproduce the bug but using a TDF release, judging from the Build ID you reported, you are using a Ubuntu version, that may work differently than the TDF's one.I can confirm that the bug is fixed in TDF version. -- Thanks!Operating system Debian unstable 64bitFrom libreoffice.org - works properlyVersion: 5.2.0.4Build ID: 066b007f5ebcc236395c7d282ba488bca6720265From Debian unstable repository - "General input/output error." dialogVersion: 5.2.0.4Build ID: 1:5.2.0-1(In reply to Giuseppe Castagno (aka beppec56) from)Giuseppe: So i tested ubuntu's LO 5.1.4.2 build and get the same 'The specified device is invalid.' error, and as kubi mentioned debian's LO build doesnt work as well, i could guess that something maybe wrong with their build script or their google drive credentials arent correct. @Bjoern: Any thoughts?(In reply to kubi from)Kubi: Do you have two factor authentication on your google login?No, I forgot to mention. I use single factor only.I get the error message on two separate computers, with the same Google account using two-factor authentication.Computer 1 is under Linux Mint 18 Cinnamon 64 bits.Version: 5.2.0.4Build ID: 1:5.2.0~rc4-0ubuntu1~xenial2Computer 2 is under Microsoft Windows 7 Ultimate 64 bits.Version: 5.2.0.4 (x64)Build ID: 066b007f5ebcc236395c7d282ba488bca6720265The error appears after I enter the authentication code. Creating and using an application-specific password from Google does not solve the issue.I have the same problem in ArchLinux with version 5.2.0.4The maintainer of the package said it could be related to libcmis, if this gives some hint.Can report this happening on a Google Apps account with 2 factor. Filling out the login details, entering the 2 factor code and then clicking OK shows this error. Ubuntu 14.04.5 LTS, with LibreOffice deb packages downloaded from TDF website.Version: 5.2.0.4Build ID: 066b007f5ebcc236395c7d282ba488bca6720265CPU Threads: 4; OS Version: Linux 3.16; UI Render: default; Locale: en-GB (en_GB.UTF-8)(In reply to Martin from)Martin, are you having problem with ArchLinux LO version or TDF's ?(In reply to Giuseppe Castagno (aka beppec56) from)Both. The only difference is that ArchLinux's version doesn't promt me the 2 factor code, whereas the TDF's one first asks for it and then shows the error message.(In reply to Martin from)Just downloaded and installed:, which is the latest TDF version.I got the prompt for the 2 factor code, then got shown the same error message.Right, same here on Windows 7 , LO Version: 5.2.1.2 (x64)Build ID: 31dd62db80d4e60af04904455ec9c9219178d620In addition, the Help link sends yo to an empty page:Swriter/svt/ui/placeedit/okThere is currently no text in this page.I'm getting the same errors..there is an underscore in my password as well as an exclamation point...Not sure at this point if 2-factor is enabled... probably not, Evolution is able to sync my google calendars, no problem.This is kind of frustrating because it's a really useful feature.I know gnome is coming up with some kind of documents syncing app for google drive as well, but it's not part of debian-stable yet (won't be until january last I checked)...Version info running debian :Version: 5.2.2.2.0+Build ID: 1:5.2.2~rc2-2~bpo8+1Threads CPU : 4; Version de l'OS :Linux 3.16; UI Render : par défaut; Locale : fr-FR (fr_FR.UTF-8); Calc: group
id=57975	Createdstep-by-step instructions how to reproduce the problem1. Create 3-rows, 3-columns table2. In first column merge second and third row.3. Mark first column and try to delete a column - deleting not possible menu option Table | Delete | Columns is grayed out. Trying to press DELETE key reports error: "Read-only content cannot be changed. No modifications will be accepted"See attached document with detailed step-by-step instructions. Confirmed in 4.0.The delete column command is disabled when the column with merged cells is selected entirely. It does work when several cells in that columns are selected.It works for me if the merged cell is not the last cell in the column. Tested in versions 4.2.7.0.0+, 4.3.3.0.0+ and master built at home under Ubuntu 14.04 x86-64.In the present case with a 3 rows table: click in cell B3 and insert a new row. Now the first column can be deleted. When done delete the fourth row.Best regards. JBFRetested on LibreOffice v.4.1.3.2 on Windows XP and problem still persists like described in attachment.Like "Jean-Baptiste Faure" described if merged column is in the last row in table and column can't be deleted. But somehow work-around it to add a new dummy row in table at the bottom, then do merge like described in attachment and after delete added dummy row. This is work-around, but I still think this is a bug and should be fixed.Opps... I tested on Windows 7 now, I don't have Windows XP anymore to test this.It is possible to delete the column but it depends on where the cursor is placed.1. New Text Document.2. Insert → Table with 3 rows and 3 columns.3. Select cells A2 and A3 and Merge.4. Place cursor in paragraph outside table.5. With mouse, move cursor to above first column to get downward point arrow and click to select column.6. Try to delete column using these methods:a. Right click on column → Column.Result: no option to delete.b. Toolbar → Delete Columns.Result: button is greyed out.c. Menu → Table → Delete → Columns.Result: option greyed out.d. Delete key (this only deletes content not the column).Result: Read-only content...Alternate:4. Place cursor in A1.5. With mouse, move cursor to above first column to get downward point arrow and click to select column.6. Try to delete column using these methods:a. Right click on column → Column → Delete.b. Toolbar → Delete Columns.c. Menu → Table → Delete → Columns.Result: column deleted.Alternate:4. Place cursor in A2.5. With mouse, move cursor to above first column to get downward point arrow and click to select column.6. Try to delete column using these methods:a. Right click on column → Column.Result: no option to delete.b. Toolbar → Delete Columns.Result: button is greyed out.c. Menu → Table → Delete → Columns.Result: option greyed out.d. Delete key (this only deletes content not the column).Result: Read-only content...Alternate:4. Place cursor in either A1 or A2.5. Try to delete column using these methods:a. Right click on column → Column → Delete.b. Toolbar → Delete Columns.c. Menu → Table → Delete → Columns.Result: column deleted.Version: 4.4.3.2Build ID: 88805f81e9fe61362df02b9941de8e38a9b5fd16The same happens in 4.3.6.2 and 4.2.8.2.Gordo,thanks for work-arounds. I tested your suggestions in LibreOffice 4.4.2.2 on Windows 7 (currently installed on my system).It works exactly the way you have described. It really looks like it is important where cursor is placed BEFORE selecting the whole column. This is little bit unreasonable to average Joe. Specially because when you mark whole column the cursor appears in A1 cell.What I see now is also that there is not required to mark a column to delete it, but I see somehow logical to do the following:a) make selectionb) perform action (delete column, merge column, etc).The same logic is in any text oriented. You know make selection and bold, italic, underline the text. I think many users think like "selection & action" and many users can get into this problem very quickly. In my humble opinion this is a usability bug and it should be fixed.Regardsgrofaty, following on from what you said about selection and formatting, I ran some other tests.In the first column, I typed "test" into each cell. I attempted to change the formatting with column arrow selection depending on where the cursor was placed. Only if the cursor was before "test" in the first cell was I able to format the column.Additionally, dragging and selecting of the column allows you to delete or format the column no matter whether you drag from the top or drag from the bottom.** Please read this message in its entirety before responding **To make sure we're focusing on the bugs that affect our users today, LibreOffice QA is asking bug reporters and confirmers to retest open, confirmed bugs which have not been touched for over a year.There have been thousands of bug fixes and commits since anyone checked on this bug report. During that time, it's possible that the bug has been fixed, or the details of the problem have changed. We'd really appreciate your help in getting confirmation that the bug is still present.If you have time, please do the following:Test to see if the bug is still present on a currently supported version of LibreOffice (5.1.5 or 5.2.1If the bug is present, please leave a comment that includes the version of LibreOffice and your operating system, and any changes you see in the bug behavior If the bug is NOT present, please set the bug's Status field to RESOLVED-WORKSFORME and leave a short comment that includes your version of LibreOffice and Operating SystemPlease DO NOTUpdate the version fieldReply via email (please reply directly on the bug tracker)Set the bug's Status field to RESOLVED - FIXED (this status has a particular meaning that is not appropriate in this case)If you want to do more to help you can test to see if your issue is a REGRESSION. To do so:1. Download and install oldest version of LibreOffice (usually 3.3 unless your bug pertains to a feature added after 3.3)2. Test your bug3. Leave a comment with your results.4a. If the bug was present with 3.3 - set version to "inherited from OOo";4b. If the bug was not present in 3.3 - add "regression" to keywordFeel free to come ask questions or to say hello in our QA chat:Thank you for helping us make LibreOffice even better for everyone!Warm Regards,QA TeamMassPing-UntouchedBug-20160920Not reproducible anymore in LibreOffice 5.2.3.0+ and current master under Ubuntu 16.04 x86-64.Closing as WorksForMe. Please, feel free to reopen if you disagree.Best regards. JBFHi,I have retested this problem and in my humble opinion this is still a bug. It looks like it is very important where the cursor is and marking the column is not such an importance. This is not what average Joe would expect.I am reopening this problem. Tested on LibreOffice master on Windows 7.Regards==============MASTER VERSION==============Version: 5.3.0.0.alpha1+Build ID: f965a629fba10ecba7bad938a0c1c9c3db1e510dCPU Threads: 3; OS Version: Windows 6.1; UI Render: default; Layout Engine: new; TinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2016-11-23_00:13:10Locale: sl-SI (sl_SI); Calc: group
id=103914	When LO closes menu, it sets window of that menu activeSteps to reproduce:1. Open two any LO documents (e.g. an empty Calc document and an empty Writer document - I will refer to them below). Make them both visible on screen (say, side-by-side).2. In Calc document, right-click in greed area to open context menu. Alternatively, click on a main menu item to open it down.3. Now (while the menu is still open visible) try to left-click on page area of Writer document.Expected result: the menu should close, and Writer document should become active.Actual result: the menu does close, but the active window is still Calc.When in Windows, this may be seen even better. After step 2, first activate Writer window clicking on its header (this won't close the menu), and then do step 3. This way, you will see that clicking on page area in already active Writer's window brings another window (Calc's) active.Reproducible with:==================Version: 5.3.0.0.alpha1+Build ID: 24707c7b8d5e7b3d72decb9749b83153b273917fCPU Threads: 4; OS Version: Windows 6.19; UI Render: default; Layout Engine: new; Locale: ru-RU (ru_RU); Calc: groupVersion: 5.2.3.1 (x64)Build ID: 01ec8f357e651ca9656837b783cf7e6a32ee4d92CPU Threads: 4; OS Version: Windows 6.19; UI Render: default; Locale: ru-RU (ru_RU); Calc: CLVersion: 5.2.3.2Build ID: 1:5.2.3~rc2-0ubuntu1~xenial1CPU Threads: 1; OS Version: Linux 4.4; UI Render: default; Locale: en-US (en_US.UTF-8); Calc: group-> OS: AllNot reproducible with:======================Version: 5.2.2.2 (x64)Build ID: 8f96e87c890bf8fa77463cd4b640a2312823f3adCPU Threads: 4; OS Version: Windows 6.19; UI Render: default; Locale: ru-RU (ru_RU); Calc: CL-> regressionBibisect log (bibisect-win32-5.2):# bad: [d2d2b966fc101ea850dd1cb37d7f628c1b6a13d5] source sha:3f373500282c926031eed4f995ca8d51402ed187# good: [1f670510f08cb800cbae2a1dd6ea70d3542e4721] source sha:49c2b9808df8a6b197dec666dfc0cda6321a4306git bisect start 'master' 'oldest'# good: [ad4c13c90a7c6c8437f80068188b71e2f17190be] source sha:7df498c828b36259397e2dd2769d99e7f30f7470git bisect good ad4c13c90a7c6c8437f80068188b71e2f17190be# skip: [c1717b0fc757f6034436348e24d8e3058cc7952f] source sha:73b9846e8242f4d383717d627cb84e97b91c58f3git bisect skip c1717b0fc757f6034436348e24d8e3058cc7952f# skip: [a1d0fd68f06f368ebf73772fea1249335a8f5835] source sha:438f2db139dfee1036da3baae85c82c9a14448b5git bisect skip a1d0fd68f06f368ebf73772fea1249335a8f5835# good: [469f5f26711cb6b872179e201543b0db3959bedb] source sha:6c782fe1568d1b3a5f968b3696ba1bf8ad6d914cgit bisect good 469f5f26711cb6b872179e201543b0db3959bedb# good: [39fde614d5390fcf200d839f16ac61ffa53faa02] source sha:35d4f6608a05b349950030e5aeb21dec6aa185e1git bisect good 39fde614d5390fcf200d839f16ac61ffa53faa02# good: [63a155b9baab60ce2a3693fd584f9cfa3253f676] source sha:721b55bcf1ab31b24b28aac6d9a54784fc290d6cgit bisect good 63a155b9baab60ce2a3693fd584f9cfa3253f676# good: [927a15c2fb89575df147510515d2666457bc75a6] source sha:d8e46307cd8190c93c0b60e394475536b40e3a46git bisect good 927a15c2fb89575df147510515d2666457bc75a6# bad: [d02008cca47f3e5cdedf66dcf26d054d7f1f8607] source sha:6eef3ed192f4426ab1b8da6bb26ea64bcd5822a4git bisect bad d02008cca47f3e5cdedf66dcf26d054d7f1f8607# good: [78ec0b2be08e12f5f7a43cd6627356cbd7e17300] source sha:0402ba63551b614c9742b198e48232ac87a2b32bgit bisect good 78ec0b2be08e12f5f7a43cd6627356cbd7e17300# bad: [001d8f317d7324af45d6ce4fe2235e10c756b415] source sha:b73a8e115d9afaf7cc00906d158d1c2f1ba8829cgit bisect bad 001d8f317d7324af45d6ce4fe2235e10c756b415# bad: [4a73eccd907c0d3076800d2d35c69178b744d545] source sha:d0f2707c2a649778fe8bc47a187ceb2e6a90aaf7git bisect bad 4a73eccd907c0d3076800d2d35c69178b744d545# good: [c1ef34c55244191d0cdee2a97b6768df36320425] source sha:3e441af7c12e408a886256a55c34780699af7e2agit bisect good c1ef34c55244191d0cdee2a97b6768df36320425# bad: [2e26ebc43ae490af20c698974ee8febb76066fc0] source sha:06761518b63cc420ee11cff3e54e1059a5985b01git bisect bad 2e26ebc43ae490af20c698974ee8febb76066fc0# first bad commit: [2e26ebc43ae490af20c698974ee8febb76066fc0] source sha:06761518b63cc420ee11cff3e54e1059a5985b012e26ebc43ae490af20c698974ee8febb76066fc0 is the first bad commitcommit 2e26ebc43ae490af20c698974ee8febb76066fc0Author: Norbert Thiebaud <>Date: Thu Oct 6 07:49:32 2016 -0700 source sha:06761518b63cc420ee11cff3e54e1059a5985b01 source sha:06761518b63cc420ee11cff3e54e1059a5985b01:040000 040000 988a108f2ce05fd3948fdf4e266dbab53c7a8325 e02e7ff8c7e535b6a5db2211940d9480619d0ad9 M instdirauthor Caolán McNamara <> 2016-09-27 14:14:46 (GMT)committer Miklos Vajna <> 2016-10-06 14:26:17 (GMT)commit 06761518b63cc420ee11cff3e54e1059a5985b01tree 8b46e4481c2b39f91699ea31da20d0ae49f50cfaparent 3e441af7c12e408a886256a55c34780699af7e2aResolves: tdf#102177 focus not restored from context menus confirmed in Version: 5.3.0.0.alpha1+Build ID: 0af30952982767543cddd0b1ce643cb8d5c253a2CPU Threads: 4; OS Version: Linux 4.8; UI Render: default; VCL: gtk2; Layout Engine: new; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-11-11_23:43:27Locale: nl-NL (nl_NL.UTF-8); Calc: groupAdding Cc: to Caolán McNamaraAs the identified commit in 5.2 was a bunch of squashed together commits from master, here is bibisecting results from bibisect-win32-5.3:# bad: [2e5256b83814c5afeee8e0ef13333a803e991288] source sha:6fe0706f6726e5a5446c9f44e3d139cf73adeab9# good: [defb73f1c6e2a66dbd21ba89e684f57427e8bc4b] source sha:5b168b3fa568e48e795234dc5fa454bf24c9805egit bisect start 'master' 'oldest'# good: [470e63808ce80588af14a79583f54bec38da3ccb] source sha:a75d49241df2e0dd2f1bcd3ce7fae3197eb5afe8git bisect good 470e63808ce80588af14a79583f54bec38da3ccb# bad: [8848305c9da26198edecff59040ace7352f90102] source sha:f0249a88fc502df142d36f2f67c976618b7ba6b6git bisect bad 8848305c9da26198edecff59040ace7352f90102# good: [96563aa883394c59a8d3111454aca6ff016b2eab] source sha:e501c39a48ab3f73f1994ab03a7f194774ed7ff4git bisect good 96563aa883394c59a8d3111454aca6ff016b2eab# good: [a4c502b9cea5c21c1002820268557ea7b1bbf31e] source sha:b2aa15ed6e989c50402e3914bffbc1a352e127degit bisect good a4c502b9cea5c21c1002820268557ea7b1bbf31e# good: [02f56f736c0be4880cffb353d37753b26c7b8c18] source sha:6d6668bb22a063cabb86bc601603d205522ae865git bisect good 02f56f736c0be4880cffb353d37753b26c7b8c18# bad: [e2f8bf1b68f219578df7c5e05152c22de437854e] source sha:f6998d9087c472954cc605c1308ec2df940dddd9git bisect bad e2f8bf1b68f219578df7c5e05152c22de437854e# bad: [24d0a1fb206cfa68c73c632b05d0aae81099f4cd] source sha:0145d83cc7872bf943de12e386645a7aa8868f5dgit bisect bad 24d0a1fb206cfa68c73c632b05d0aae81099f4cd# bad: [32a8267515ac066d99e71bedb9fdc3316c50e0a3] source sha:0901c29d522f03c29c60fcda537918c2bf9eda63git bisect bad 32a8267515ac066d99e71bedb9fdc3316c50e0a3# good: [072ca7c27df58088cd551ac484abe51c564f90b7] source sha:3468dab9ff02ecdf5d0806a00e15b9b579c8dc35git bisect good 072ca7c27df58088cd551ac484abe51c564f90b7# good: [ea925963d2e71338cee3e6a5aef6a4c9b6bee20a] source sha:120d8fc75c164555058d63ef7dca8bfbd8316a5agit bisect good ea925963d2e71338cee3e6a5aef6a4c9b6bee20a# good: [3b38c129b658029cd78aaf71c50757bef9b38772] source sha:65fc486f7e28ec02ed481265dcaa30d09eaadc6cgit bisect good 3b38c129b658029cd78aaf71c50757bef9b38772# bad: [3ad3848b73ecdaa3f6eadc39353e74d19807d725] source sha:1aaba02fafe0b9131c2cdeba3fb4ad9924da81begit bisect bad 3ad3848b73ecdaa3f6eadc39353e74d19807d725# bad: [7f571441f77eb85aec8ac12dc1c6bcb53abb9374] source sha:4da7971812b0a53ba80f7d9c29851c527488067dgit bisect bad 7f571441f77eb85aec8ac12dc1c6bcb53abb9374# first bad commit: [7f571441f77eb85aec8ac12dc1c6bcb53abb9374] source sha:4da7971812b0a53ba80f7d9c29851c527488067d7f571441f77eb85aec8ac12dc1c6bcb53abb9374 is the first bad commitcommit 7f571441f77eb85aec8ac12dc1c6bcb53abb9374Author: Norbert Thiebaud <>Date: Tue Sep 27 09:04:26 2016 -0700 source sha:4da7971812b0a53ba80f7d9c29851c527488067d source sha:4da7971812b0a53ba80f7d9c29851c527488067d:040000 040000 32e62ea1d646126ab7a5163cf0eb90522904205f 6d47edcf3ecc2e5cf1b782cc118b53aae3706852 M instdirauthor Caolán McNamara <> 2016-09-27 14:33:54 (GMT)committer Caolán McNamara <> 2016-09-27 15:03:54 (GMT)commit 4da7971812b0a53ba80f7d9c29851c527488067dtree dd0724cbf76e465fd532008208973fdfcd365b3bparent 65fc486f7e28ec02ed481265dcaa30d09eaadc6cResolves: tdf#102177 focus not restored from context menusCaolán McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: tdf#103914 if menu no longer has focus, leave focus where it isIt will be available in 5.3.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.This seems to do what you want and keep the original problem working. Acceptable ?(In reply to Caolán McNamara from)if is it fixing this bug, then backport this to 5.2.4 please.(In reply to Caolán McNamara from)I tested your fix, and it indeed fixes the problem. Thank you!Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-5-2":Resolves: tdf#103914 if menu no longer has focus, leave focus where it isIt will be available in 5.2.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Unfortunately, not properly fixed.Steps to reproduce:1. On Windows, open Writer and Impress side-by-side.2. In Impress, click on File menu.3. Click on Writer's title bar (note that menu in Impress is still open, and cursor is blinking in Writer).4. Type single character "i".Expected: "i" in Writer.Actual result: Properties dialog from Impress is shown, nothing is typed in Writer. The "Properties" subitem of "File" menu that was open in Impress, has "i" as accelerator.Caolán, I set you as assignee, as you've made previous patch; please reset to default if inappropriate.
id=98540	(At least) the odt file icon does not show (blank file icon in the finder and in the libreoffice window top frame) in 5.1.0 and 5.1.1.I tried to replace with info.plist provided in those versions with the one from 5.0.5 and things went back to normal. ***has been marked as a duplicate of this bug. ***Works in Version: 5.3.0.0.alpha0+Build ID: 4d49c9601c9b3e26a336e08e057d299895683480Threads CPU : 2; Version de l'OS :Mac OS X 10.11.5; UI Render : par défaut; Locale : fr-FR (fr.UTF-8)Also seems to display correctly inVersion: 5.1.3.2Build ID: 644e4637d1d8544fd9f56425bd6cec110e49301bCPU Threads: 2; OS Version: Mac OS X 10.11.5; UI Render: default; Locale: fr-FR (fr.UTF-8)***has been marked as a duplicate of this bug. ***Createdblan iconsI have this problem (LO 5.2.5.1 on OSX "Sierra").
id=105498	Hey,here is my LibreOffice Online setupI am trying to package it for ArchLinux!Loolwsd prints several errors when starting:It's similar to this: kit-11301-11301 19:27:30.869672 [ loolkit ] ERR link("/usr/lib/libreoffice/program/libavmedialo.so", "/var/lib/lool/child-roots/11301/lo/program/libavmedialo.so") failed. Will copy. (errno: File exists)| kit/Kit.cpp:152Best regards,Jonas This issue seems to be fixed in the latest version of libreoffice-online 2.0.3 and libreoffice (sdk) 5.3Ups sorry, no its still presentUpdated build scripts:Updated to libreoffice-online 2.0.3Updated to libreoffice-sdk 5.3Heres my loolwsd.xml:Bug still present ...
id=74244	Problem description: CFShortBundleVersionStrings are incorrect on both x86 and x86_64 OSX buildsSteps to reproduce:1. mount Libreoffice 4.2*.dmg2. open Libreoffice.app/Contents/Info.plist3. Current behavior:<key>CFBundleShortVersionString</key><string>4.2.4</string>Expected behavior:<key>CFBundleShortVersionString</key><string>4.2.0.4</string> This line 1408 in LibreOffice.app/COntents/Info.plistI was too lazy to file a bug for this one.***has been marked as a duplicate of this bug. ***Still applicable in the latest 4.2.1.1 release, which reads as 4.2.1001Still applicable in 4.2.2.1 RC1.It reads as 4.2.2001the version is defined as follows:# The CFBundleShortVersionString in Info.plist consists of three integers, so encode the third# as the micro version times 1000 plus the patch number. Unfortunately the LIBO_VERSION_SUFFIX can be anything so# no way to encode that into an integer in general.MACOSX_BUNDLE_SHORTVERSION=$LIBO_VERSION_MAJOR.$LIBO_VERSION_MINOR.`expr $LIBO_VERSION_MICRO '*' 1000 + $LIBO_VERSION_PATCH`so this is a limitation that needs a workaround, so cannot fix/worksforme.btw.closing.Translation: MAS wants 3 or less integers separated by a dot. That means to get the build info into that system LO uses 4.2.2002 which then would be the 2nd build for version 4.2.2. indeed worksforme.Took me sometime but now I get it. thanks for searching this link christian.reopening. The code fails for the .0 releases. 0*1000 still is 0, so 4.3.0.1 would then identify as 4.3.1 and rc2 as 4.3.2 and that would be very wrong :-)As there are many Applications that use more liberal formatting of the version: If anyone finds an Appstore-Listed application that uses more than three integers (maybe even letters), then the limit can be reverted again as well.Has this been resolved by chance? Can we close as WFM?Still affected in 4.4.0.x, which reads as 4.4.3.But as long as 4.4.1003 > 4.4.3, worksforme.Christian, are you still on this? Do you have an idea how this could be solved?
id=91362	On Windows (32bit) and Linux (32bit) I noticed this bug that can be reproduced the following way:a) create a new writer documentb) Format->Page and switch this page to Landscape-Formatc) File->Print / Properties... (opens the printer drivers settings dialog)BUG: Default-Values for page-format don't reflect our landscape settings above. It shows "portrait". I would expect "landscape" here. If I do the workflow analogue in MS-Office, this dialog shows "landscape" instead of "portrait"d) why is this behavíour annoying? because If I would like to change some other settings in the printer drivers dialog (e.g. duplex), I get the feeling that my results will come in with the wrong orientation.Note: By default, only the page settings control in which size a page is printed. There is an printer option in the "options" tab called "use only paper size from printer preferences". Only if this option is switched on, the settings from the printer driver should be used. Results of analysis:1) THB stated that he couldn't reproduce this bug on linux 64bit - everything is as expected here (it is not yet sure, if this issue is related to to architecture 32/64 bit or just some other different settings - different printer drivers, ...)2) The bug is from functional point of view related to tdf#61186 and commit 71ebe4404b6e7c78a7d2e352f6af88d57209680a3) The bug is related to resetPaperToLastConfigured in. If this line is commented, then everything is fine, even with Win/Linux 32bit (but the use case described in 2. is broken, then).4) We further noticed that in case of the bug, in linethe variable bNeedToChange is true, even if if we don't want to trigger a "change". This is because of the comparison "maJobSetup.ImplGetConstData()->mnPaperWidth != aPageSize.Width() || maJobSetup.ImplGetConstData()->mnPaperHeight != aPageSize.Height()" which returns true. In this case, the compared width/height values are just slightly different (but logically "the same").5) It seems we run into rounding errors. These rounding errors are caused in the mm/inch mapping PixelToLogic and show that the real cause seems to be much deeper inside the code. The PageSize Size-Structure used by mxPrinter can only hold integer (size in Pixels, stored as long) values which cannot be exactly converted to mm: 600 DPI / 2,54 inch * 21cm = 4960,62 (Pixels) --> This value is stored in an integer variable as 4961 and PixelToLogic () is not able to convert this value back without loss of information.Reproduced, looking at the properties dialog of HP LaserJet 700 M775.Win 7 Pro 64-bit Version: 5.0.0.0.alpha1+Build ID: 158b50763962f66515062300e265839828463efaTinderBox: Win-x86@39, Branch:master, Time: 2015-05-19_00:28:31Locale: fi-FI (fi_FI)Yep. Make sure to *not* use legal or letter both as the writer page format and for the printer, it seems you get lucky there with the rounding.Can reproduce with a4 paper for sure.As far as I see from tdf#61186 and own experiments, it is not expected that printer settings dialog will show page orientation of document. It toggles *paper* rotation placed in *printer*, not a *page* rotation in *document*. Even corresponding tab in dialog is called "Paper", not "Page".So in my mind behavior with A4 format is correct: orientation is not changed automatically, it can be adjusted by user. But Letter format works incorrectly: paper orientation is selected to be Landscape automatically, it can not be changed by user: once I select Portrait orientation, click Ok in Printer Properties Dialog and open it again, I expect to see Portrait orientation, and not the Landscape. Proposed fix is committed to gerrit:After correcting of page sizes comparison in Printer::SetPaperSizeUser() everything became fine and it corresponds to logic written above.Katarina Behrens committed a patch related to this issue.It has been pushed to "master":tdf#91362: Don't override printer page autodetectionIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Katarina Behrens committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#91362: Don't override printer page autodetectionIt will be available in 5.0.0.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.(In reply to Beluga from)Still repro.Win 7 Pro 64-bit Version: 5.1.0.0.alpha1+Build ID: 4fff776a08dd92121ab507a1ab506ac945abaedbTinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-06-28_00:25:54Locale: fi-FI (fi_FI)Katarina Behrens committed a patch related to this issue.It has been pushed to "master":tdf#91362: Make "printer was modified" status persistentIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Katarina Behrens committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#91362: Make "printer was modified" status persistentIt will be available in 5.0.0.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Verified as fixed.Win 7 Pro 64-bit Version: 5.1.0.0.alpha1+Build ID: a625cd702700ae1773966a3133d27027d1c4d083TinderBox: Win-x86@39, Branch:master, Time: 2015-07-07_08:23:06Locale: fi-FI (fi_FI)Katarina Behrens committed a patch related to this issue.It has been pushed to "libreoffice-5-0":Related tdf#91362: disable paper size & orientation selectionIt will be available in 5.0.0.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Katarina Behrens committed a patch related to this issue.It has been pushed to "master":Related tdf#91362: disable paper size & orientation selectionIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.(In reply to Commit Notification from)" It was really challenging to have this one toggle get all the way down through several layers of abstraction, though .. "Hurray, lots of kudoos for hunting this all the way!The use case with writer is fixed now. Unfortunately we figured out that the issue remains for impress. Here the steps to reproduce:0) I have got a PDF printer installed that supports all common german page formats A4, A5, ... This printer is used for the test. This is done on linux.1) create a new impress presentation2) Format->Page and change page format to e.g. "A5" (I know, it is not typical to do such things)3) File->Print --> now look at the preview and see, that A5 is not used now. I would expect to see the preview already in A5 format.4) press button "Properties..." for the printersettings. Now I would expect the disabled comboboxes for size and orientation to show up "A5" and "landscape", but I get "A4" (my printeres preferred page size) and "landscape".We also figured out, that the following patch (that is already included in libreoffice-5-0 and master) solves this issue for draw and impress:commit 7b31e45ec7106d2cfbdbb7915d97667ba710f81cAuthor: Eilidh McAdam <>Date: Mon Jun 23 20:55:21 2014 +0100 Make Draw use paper size when printing - fdo#63905 Previously, Draw/Impress use the default size from the printer. Now Draw uses the paper size (specified in page formatting). Impress still uses the old method - not sure if this is correct but printing handouts etc probably complicate print/paper size. Change-Id: If90bae4ac59cd95dd50fcd8deb25fd900756193e Reviewed-on:Reviewed-by: Matúš Kukan <> Tested-by: Matúš Kukan <>and that this patch breaks the fix again for impress only:commit f1f89f0202232635e7fbbd7ca47de51755b2bce0Author: Caolán McNamara <>Date: Thu Sep 18 11:40:26 2014 +0100 IsDraw doesn't mean the app/page is Draw it means a slide in impress. commit 7b31e45ec7106d2cfbdbb7915d97667ba710f81c Date: Mon Jun 23 20:55:21 2014 +0100 Make Draw use paper size when printing - fdo#63905 Previously, Draw/Impress use the default size from the printer. Now Draw uses the paper size (specified in page formatting). Impress still uses the old method - not sure if this is correct but printing handouts etc probably complicate print/paper size. suggests the intent is for this to not affect Impress and to only affect Draw, so this does that Change-Id: I481a824ef244fd837992c893f6de0c051af0a26bSo my question is: What is this second patch supposed to do? which issue does it solve? Can we revert this one?Adding involved developers.@caolan: there was a question on f1f89f0202232635e7fbbd7ca47de51755b2bce0Yesterday pinged caolan on IRC and he's fine with a revert of his patch. Will do when I have time to actually test this. But actually feel free to do the revert yourself but don't forget to test again the regression from, which was somehow related to the last patch!
