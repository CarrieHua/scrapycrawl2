id=30904	LibreOffice 3.3.0 OOO330m9 (Build:1)libreoffice-build 3.2.99.2Ubuntu 10.04 LTS (Lucid Lynx)Also filed in Debian bug tracker August 8 2010: #594120 (openoffice.org-calc: Function Wizard omits sheet reference)Much simpler way to reproduce this in Calc:-Click Function Wizard-Double-click ABS function-Select Sheet2.A1Function Wizard enters =ABS(A1:A1) and Calc returns Err:522Expected:Function Wizard to enter =ABS(Sheet2.A1) and Calc to return 0.For me the severity is critical because it stops me from working efficiently. I use the Function Wizard daily to build formulas on complex multi-sheet files. But, I can revert to Beta1 where this bug does not appear to exist. Yes, this needs to be fixed. Thanks for reporting this. I'll look into this sooner rather than later.Found the cause & fixed it on master. This will be fixed in the next release.Verified in 10_10_28_Cedric.rpm build - Closing - SophieThis is a Calc issue, therefore changed 'Component' field accordingly.Set Version according to original description.
id=30861	Problem occurs with LibreOffice Betas 1 and 2 loading a specific spreadsheet which crashes the programme. The loading progress bar indicates "Adapt row height" when it crashes.This problem only occurs with the LO betas. OO.org and NeoOffice have never had problems with the particular spreadsheet.Thanks. I would guess this problem is not specific to MacOS - Peter, would you be able to share your document privately, then Kohei could have a look?(In reply to)Thanks for your response. Unfortunately the spreadsheet document contains confidential data so am unable to share it. I will install LibreOffice on a Windows PC and re-test the document.Will post the outcome.(In reply to)Understood. But without the actual document it'll be hard for us to debug. Could you cleanse the document to remove all your confidential info and send it to me privately to my email address?(In reply to)Email with attachment sent.PeterThanks for your test document. I've reproduced this on my end, and I'll look into this pronto!This is now fixed on master, for 3.3.(In reply to)Thanks. That's great news.When will compiled update be available?(In reply to)We are not 100% sure yet, but our best estimate would be somewhere in the neighborhood of the next 2 to 3 weeks.I don't have the doc to test, but closing the issue as there is no further comments for the reporter. Reopen if needed :) SophieThis is (at least at the surface) a Calc issue, therefore changed the'Component' field accordingly.Added version according to original description and summary.
id=30882	CreatedSimple array in a new calc spreadsheet doesn't workSimple array in a new calc spreadsheet doesn't work.I have never had this issue in OOo even in OOo3.3m10 In Windows 7 ultimateYup, this is pretty bad. Thanks for reporting this.I'll take care of this.I've just identified the location of the problem, and am in the process of coming up with a correct fix. Give me a little longer...Just to make it explicit for QA purposes, typing in a cell '=A1:A5' and hitting Ctrl-Shift-Enter should expand it into a 5 x 1 array and turn the formula string into '{=A1:A5}'.This is now fixed on master, for 3.3.Thank's KoheiVerified in the 10_10_28_Cedric.rpm build - Closing - Sophie
id=30946	I checked with LibreOffice 3.3.0 - WIN XP DE [OOO330m9 (Build:1 - build 3.2.99.2)] I have documents created with OOo containing a data validity check (menu 'Data ->Validity'Criteria list is created with formula: to get a continuous data range for creteria, the allowed values from many places in the document are gathered to a central cell range list with '=A1' formulas.In my spreadsheet input fields validity of input data will be checked with tat data range. That worked fine with OOo, but pulldown in LibO only shows "Err:504", and manual input with correct data will be rejected.NOT Reproducible with "Ooo-Dev 3.3.0 multilingual version English UI WIN XP: [OOo330m10 (Build 9533)]"!I will contribute a sample document soon. Yup, this is mine.CreatedSample documentRo reproduce, pls. open document and try to insert data into sheet "Reparatur_Erforderlich" cell B3comportement identique avec LibO en français : erreur 504(In reply to)Translation: the same is happening with LibO in French: error 504 is reported - SophieJust fixed, which may have fixed this one also. I no longer see the problem reported here. Entering an invalid value into B3 launches the error dialog (as it should), and the selection list also shows a list of values (not Err:504).Based on that, I declare this bug fixed.Verified in the 10_10_28_Cedric.rpm build - Closing - SophieStill having same issue as previous bug reporters. Downloaded the sample document and get same error "Err:504". Documents work fine in OO.o, but not LO.LibreOffice 3.3.0 OOO330m9 (Build:1)libreoffice-build 3.2.99.2Try either Beta3, or RC1 which is due out soon.Closing it again.
id=32250	I test LibO for MS-Windows on a VM XP with only 4 GB virtual hard-disk. I have about 700 MB of free space. There was no problem to install beta 1,2 and 3.There is something wrong.For me, if LibO requires so much of free space, it is a blocker: I can't test LibO anymore on XP. You need a bigger disk.(In reply to)No! It worked well until this RC1. I guess there is a bug in the installer.End users will not understand how it is possible to have a lighter office suite which require ~4 times than OOo of free space on the hard disk to install.What has been changed in this installer since beta3 ?Best regards. JBFFridrich, others, could we do anything with it? 1500MB sounds too much to me.Note that it has been nominated as 3.3 blocker.Duplicate of???(In reply to)Installation worked fine on the same machine and HD for beta2. So I guess there is a bug in the computation of the amount of needed free space.It's mostly pointless to compare the disk space used by betas and release candidates, when there are changes going on that greatly affect the size of the installer, and the amount of disk space used during the installation. Nobody is claiming that the beta 2 and the rc1 would be very like each others. Of course there are changes.Yes, this is a duplicate of. But as this bug seems to have more excited commenters, let's resolve that one as a duplicate of this one instead, even if that is not really logical.I still think it is ridiculous to try to run a Windnows installation and expect to be able to install any significant software on a 4 GB disk.***has been marked as a duplicate of this bug. ***(In reply to)Hmmm, not very fair and friendly your comment :-(My XP is on a virtual machine with nothing other than LibO or OOo. I am using this machine for QA tests. That worked fine for years until this RC1. Are you sure that there is not a bug in the *computation* of the needed free space ?If you compare the size required during installation of an OOo installer that contains just one UI language to that required during the installation of a LibreOffice multi-language installer, it should not come as a surprise that the latter requires more space.I have discussed it with Fridrich and Michael. The 3.3-rc1 installer really needed 1500GB. It compressed the files twice to reduce the download size. The result was that the files were duplicated once more on the disk during the installation.Fridrich told me that they found another solution and there should be less disk space need for the upcomming 3.3-rc2. It should be more comparable with 3.3-beta3.I would consider this bug as fixed. Feel free to reopen it if you are not happy with 3.3-rc2.Really mark as fixed.Hi Jean:Sadly so - for RC1 :-) With the WinShrink branch, as of now I expect it to be ~900Mb, and we are working on shrinking that further - though how much further is unclear to me (thus far).HTH.A breakdown of the uncompressed space is:As you see, ~20% of the size is duplicate licenses (still).***has been marked as a duplicate of this bug. ***Fridrich removed yet more duplicated licenses, which should help some more; we still have the wizards / templates bulking us up - but this requires rather more development work to straighten out I'm afraid.Either way - the expectation is that the net result of this is a substantially reduced disk usage for RC2 - and going forward to 3.4 there is lots more scope for shrinkage.Hi,Installation of rc2 without problem on my VM XP ! You have done a great job. Thanks.JBFThanks for the encouragement ! :-) it really makes life sweeter - anyhow there is lots more space to be saved in the multi installer, but hopefully 3.4 will give us some more wins just in the course of business around artwork eg.Closed - Sophie
id=32313	When attempting to open the 'open document folder' gui, it crashes with a sigserv of 11 but no backtrace, which apperas to be turned off. The usage of the cpu then climbs until its all being used by a swriter instance and has to be killed off manually to regain control of the machine. Being unable to open any files is a real show stopper!This is on CentOS 5.5 currently up to date. Without more information, I fear we can't help here.Please read:And submit the gdb backtrace.I am using KDE, and it is with OOo writer running in another desktop. LO is now refusing to open the File > open document gui, but i know from past exeperience that it would refuse to open it, crashing instead with a SIGSERV(In reply to)This is using LibreOffice 3.3.0 OOO330m9 (Build:1)libreoffice-build 3.2.99.2, and the same thing happens with LO RC1.I have tried deleting the .libreoffice folder in KDE thinking that it was some problem with my local settings, so i went with the default ones but it still refuses to work. I have checked my path and it is pointing correctly to my documents folder, and dont know what to do next.Please, what does it mean 'it is with OOo writer running in another desktop'? Like, that you run both OOo and LO at the same time? What if you turn off OOo, do you still see the bug?Also - we really need to see the gdb backtrace, see.Thank you!On 21 December 2010 08:36, Sharon Kimble <> wrote:>>>>>>--A taste of linuxefeverCentos 5.5, KDE 3.5.4-25, OpenOffice 3.2.1Registered Linux user 334501And i've just downloaded the 3.3 RC 2 and installed that, and that hasthe same problem too, i cant open any files!Sharon.On 21 December 2010 08:39, Sharon Kimble <> wrote:>>>>BTW, is that KDE3, or KDE4?What if you enable Tools -> Options... -> General -> Use LibreOffice dialogs, does it stop crashing then?Also, an strace and a backtrace might help here:On 28 December 2010 14:28, <> wrote:>KDE 3.5.4.-25Well, I'll be blowed! The open files dialog works without any problemand i can open files with it! Thanks, problem solved! But it soundslike there is a bug in the program that this workaround sorts out, butthanks, i'm now a happy bunny again!Sharon.>On 28 December 2010 14:31, <> wrote:>>>Jan.Do you still want the strace and backtrace in view of the fact thatthe problem is now solved?Sharon.>Createdbacktrace sofficeSorry, no symbols, don't have the computer and bandwidth to build my own.LibreOffide 3.3.1 (on Slackware from original rpms)Createdstracestrace of file open dialog (LibreOffice 3.3.1 on Slackware from original rpms)I had the same problem, using LibreOffice's own dialogs fixes the problem. Nevertheless, at first it worked for "several" times (installed today). I didn't do any substantial (root) changes between working/not-working states.Simply moving ~/.libreoffice didn't help either.German language-package is installed, setting to English (USA) didn't help.I use LibreOffice 3.3.1 (from original rpms) on Slackware 13.37. Sorry, no debug symbols, strace and gdb-bt attached.(In reply to)And I don't use a major gui (evilwm), it doesn't have its own dialogs if that matters. But as I said, it worked before.To OP: Please post your traces as this is not solved/fixed but circumnavigated.It looks similar to theand should get fixed in 3.3.3 release.Feel free to reoplen this bug if it does not work there.*** This bug has been marked as a duplicate of***Remove infoprovider from closed and resolved bugs.RESOLVED, FIXED or CLOSED bugs cant be KEYWORD NEEDINFO.
id=33134	I can see the UI drawing in Win32 this happened in rc1 but fixed in rc2 now it is back. Can`t remember the other bug entry so I fill this one.Menus are slow in all aplication of libreoffice and the overall libreoffice it is slow. This happened in rc1 fixed in rc2 , what happened this time ?A fast fix and repost of a binary build of rc3 with this fixed will be nice.Now i can`t use LibreOffice rc3 for nothing in win32. Uninstalled RC3 and installed RC2 for testing again.LibreOffice RC2 menu speed it is like under 5 max 10 ms or so , i can`t even see when all the menus are drawn.Uninstalled RC2 installed RC3 on same machine and the menu speed it is likeLibreOffice RC3 menu speed it is like 1 second lag i can see on the menus when i move the cursor that the "blue select" thing goes with a 1 second and more lag behind not under my cursor and some menus looks not drawng for a second then are drawn.Don`t like that to slow.Duplicate of?(In reply to)Yeah it is the same but looks they have not tested the RC2 forth and back to see this bug more clearly that the RC2 behave normaly and fast.It must be reverted to the behavior of RC2.Looks more like some debug is on or something else.Reported this one long time ago on IRC (2010..) channel when i was testing LibreOffice beta 2 until rc1 if a remember well and compared with OpenOffice speed at that time so. Looks like a very old bug for me cause i spoted first and everytime I look for this bug when i open LibreOffice.I installed LibreOffice RC2 now until RC3 will be fixed to work the same.*Note LibreOffice RC2 works like other apps in Windows Vista in speed comparation like IE8,Explorer speed near same.I know for last time i found this bug that on Linux platform it is not present and neither MAC (some said that on irc) at that time in 2010.I think it is no need to retest from alpa to rc3 all the builds for windows when RC2 works flawless.Thanks for your work chasing this down ! it is a duplicate though, so marking as such so we can make the other a blocker :-)*** This bug has been marked as a duplicate of***
id=33562	Open an existing .docxCopy an image from a .docx open with word 2010Paste the image into LibreApp crashesProblem is reproducible.Also this attempt would not have been necessary except that the image that was in the original word 2010 .docx disappeared when the document was opened in Libre. Please attache the problem document.(In reply to)can we have a copy of a test document containing problematic images please ? >that sounds like a different issue, could you open a separate bug for that pleaseCreatedWord 2010 fileThis document has an image and a text box at the top. When opened in Libre, the picture does not appear and the text box is empty.Attempting to paste the picture causes Libre to crash.I can reproduce the second half of the OP's concern, but not the part that crashes writer. I see other bugs are already open which address missing images in .docx files.Noel, will you take over this one ? (mark as duplicate, if necessary)Seems to be a problem of all Libre-Offiversion:,,,(In reply to)why do you think this is related? please don't pollute existing bugs just because they seem to have the same keywords eg. 'Paste' & 'Crash' The bugs you mention look like they are completely unrelated to this issue.btw the image now imports on master so probably the fix associated with issue #34305 Additionally as mentioned in there textbox docx import just isn't ( afaics ) implemented. Please open a separate issue for that. Regarding the crash still I can't reproduce that. The steps I am taking area) open libreofficeb) opened the docx attached to the issue in word 2010c) copy the image from the top of the first paged) open a new writer doc in libreofficee) paste into doc ( via menu )sorry result no crash unfortunatelyso.. did I miss some step, am I doing something differently than you? some extra info might also be usefulwhat exact os are you using xp, vista etc. Do you have any extra extensions installed The more details the better :-)aha, I actually was testing against a master build, testing against 3.3.0 also works with the steps above BUT if you use cntrl-v to paste is seems to crash. But.. this is not the behaviour I observe with the master build. Need to quickly test with 3.3.1 ( which is just out ) to see if it still crashes with thatworks for me with 3.3.1 pasting with no crash. @Dan can you try with 3.3.1 ( note: you wont see the images with 3.3.1 docx import either )closing as worksforme according to Noel's commentsRemove infoprovider from closed and resolved bugs.RESOLVED, FIXED or CLOSED bugs cant be KEYWORD NEEDINFO.
id=35805	CreatedDocument with table with many columnsSteps to reproduce the bug:1. Open the attached file in Writer and save as Word DOC file (97/2000/XP)2. Open the file in Word 2007 or 2010: File is broken in many ways.This does not apply if the number of columns is reduced by four.Somehow havoing 35 columns in one table breaks the export.This problem is not present in old 2.4 releases for windows! There seems to be more to it than just removing some columns:Even with some columns removed the background color in some of the cells is lost after opening the file in word 2007.***has been marked as a duplicate of this bug. ***[Reproducible] with "LibreOffice 3.4Beta3 – WIN7 Home Premium (64bit) German UI [DEV300m103 (Build:3)]".In LibO the .doc looks ugly, MS WORD Viewer won't even open the document. Currently it seems that tables are completely broken in WORD export, IMHO that's a blocker.@Cédric:your area?I also saw Noel active in Table issues, please feel free to reassign if it's not your area.CreatedBroken 1 columm 1 row table MS Word exportI can confirm this Bug with tables in doc (Made with MS Office XP) and saved as doc (97/2000/XP) format with LO 3.4 Beta 4 (Win XP).Table(1 row/1 columm) is broken when opening again in Word. Attached broken docFixed:in master:Asked for review and cherry-pick in 3.4***has been marked as a duplicate of this bug. ***When integrated may be someone can check whether that also fixes- Cells pattern completely broken in exported .doc***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Checked with sample document and also for: Both no longer with problems in 3.4RC1.
id=36263	There are no icons in user interface at all. UI under Windows is completely broken. No icons, no controls, no zoom slider, labels shifted and unreadable...See attached screenshots. Impossible to be tested.Createdscreenshot 1Createdscreenshot 2Confirmed. Running Windows 7 Home Premium x86.***has been marked as a duplicate of this bug. ***Confirmed: same problem in Windows XP 32The Version field is incorrect, I am sure you mean 3.4 beta 1. But that alternative is not available, sure. So let's use "unspecified".)Same problem with 3.4 beta1 on Win 7 Home (like Zack). Just changed to "LibO 3.3.4 beta 1" by mistake ; sorry !Tor, could you please have a look?Modified Version due to report- No main LO iconMight be a DUP or at least show an additional aspect***has been marked as a duplicate of this bug. ***Fixed now in the libreoffice-3-4 branch, will cherry-pick to master right away, too.commit 99e0b6fac7f5fa49d47e1943682b6956db312e48Author: Tor Lillqvist <>Date: Tue Apr 19 11:51:49 2011 +0300 Export the two UNO component functions Fixes zip archive handling which was spectacularly broken in 3.4 beta1 on Windows. package/source/manifest/UnoRegister.cxx | 4 ++-- 1 files changed, 2 insertions(+), 2 deletions(-)***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***IMO, Beta 1 should be withdrawn and an Alpha pushed out that has this bug fixed. It makes no sense to me to spend more time testing a release that contains this bug.@Allen:Full ACK, although I am a survivor concerning software with bugs I did not install the Beta after I read of those problems. And too many problems might be have this one as root.Sure, I am just going to tag sources for beta2 build. LO is huge, so it will take 2-3 days until the build is available on mirrors for all architectures.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***
id=36271	CreatedLO Writer Error MessageI decided to check out the new 3.4 Beta and after installation I tried to open writer and I got this error message:General Error.General input/output error.I tried uninstalling LO 3.4 and reinstalling. The same error message appears. I will be switching back to LO 3.3.2 because I need something that works, but if anything is needed of me I'd be happy to help so this problem gets fixed.I have attached a screenshot. Everything but writer works (albeit with missing icons as has been mentioned in another bug). The program is completely unusable.System:Windows 7 Home Premium x86Intel Core 2 Duo E77004GB RAM. Same problem with Windows XP, also with Calc.RegardsTor, help.Same results with my desktop which is running a 64 bit version of Windows 7.FYI, a "ProcMon" dump can be very useful for tracking down this kind of problem. ProcMon is part of Sysinternals distributed by Microsoft atTo generate a ProcMon dump:1. Download ProcMon from2. Run ProcMon.3. Select the menu Filter -> Filter..., select "Image Path" and "contains", type "LibreOffice", select "include", then click "Add" then "OK".4. Under the File menu, make sure Capture Events is checked.5. Select the menu Edit -> Clear display.6. Force the bug to occur (i.e., run LibreOffice, do whatever causes the bug, etc.)7. Go back to ProcMon.8. Select the File menu and uncheck Capture Events.9. Select File -> Save, select "Events displayed using current filter", uncheck "Also include profiling events", select "Native Process Monitor Format (PML)", enter a file name, click OK.10. Post the .pml file.Same problem for me on Ubuntu withAllen, can you then show us how to use such a "Procmon dump", thanks! I assume you have built LibreOffice for Windows yourself and have tried to use such a dump file? Thanks in advance!System XP Pro, SP3I start Writer. No icons in toolbars. Attempt to open a text document, get:General Error.General input/output error.same as other people.Close Writer (and thus whole of LibreOffice) and get:DDE Server Window: soffice.bin - Application Error [title-bar of dialogue]The instruction at "0x04306546" referenced memory at "0x00000004". The memory could not be "read".Click on OK to terminate the programI attach the PML file as requested by Allen, using exactly his instructions.PML file is too big for attachment. Can be found here:***has been marked as a duplicate of this bug. ***Modified component due toand results from- General error on opening filesModified Status due to facts.(In reply to)Rainer, I wouldn't mark this as a duplicate of. They may be related based on the error message, but they are distinctly different. What I was referring to with this bug is that I cannot open LO Writer. Even a new blank document fails to open. In the start center if I click "Text Document" I receive the error message I posted.deals with opening files. This deals with running the writer program itself.***has been marked as a duplicate of this bug. ***You load the PML file into ProcMon (File -> Open) and then look for signs of a problem. ProcMon's filtering (Filter -> Filter...) and highlighting (Filter -> Highlight) can be helpful. For example, if you Filter to exclude the results SUCCESS, END OF FILE and NO MORE FILES, then you would just see the errors. It can also be helpful to export (File -> Save) the PML file to a CSV file and load it into an editor that can sort and search by column.I see a few things that look strange to me in the .PML file Jonathan linked to, on the other hand, I have never used ProcMon to debug LibreOffice (only OpenOffice.org), and what I'm seeing might be normal for LibreOffice, and especially for the v3.4. For one thought however, see my next comment.Could the users who are seeing this problem (or a related problem) try the following:1. Run LibreOffice to confirm the problem.2. Close LibreOffice.3. If the LibreOffice Quickstarter is running, right-click on the LibreOffice Quickstarter icon in the system tray and select "Exit Quickstarter".4. Run taskmgr (Start -> Run -> type "taskmgr" and hit Enter).5. Verify that there are no processes running with names that start with "soffice" (such as "soffice.exe" or "soffice.bin").6. Navigate to your user setting directory (open the Windows File Explorer, type %APPDATA$ in the location bar and hit Enter).7. You should see a subfolder called "LibreOffice". Rename this subfolder to something else, like "LibreOffice-save".8. Run LibreOffice and check to see if the problem is still occurs.If the problem is still there, do the following if you are running Vista or Windows 7; otherwise, skip to Step 14 below:9. Repeat Steps 2-6 above, and then:10. In your user settings directory, delete the subfolder named LibreOffice.11. Navigate to your VirtualStore folder, which is at C:\Users\<your username>\AppData\Local\VirtualStore.12. Look in all subfolders for any subfolders named "LibreOffice" or "LibreOffice 3", and if you find one, delete it.13. Run LibreOffice and check to see if the problem is still occurs.If the problem is still there:14. Repeat Steps 2-6 above, and then:15. In your user settings directory, delete the subfolder named LibreOffice.16. Uninstall LibreOffice.17. Delete the folder named "LibreOffice 3" in the Windows programs directory (either "C:\Program Files\LibreOffice 3" or "C:\Program Files (x86)\LibreOffice 3", depending on whether you are running a 32 bit or 64 bit version of Windows).18. Reboot your computer.19. Reinstall LibreOffice.20. Run LibreOffice and check to see if the problem is still occurs.If any of the above helps, please post which step solved the problem.Step 7 solved my problem with swriter.exe failing to run properly (which is what this bug was initially about). I opened a new bug,to deal with the swriter.exe problem. However, steps 1-13 were unable to solve the file opening problem. I haven't had time to try steps 14-20 yet.***has been marked as a duplicate of this bug. ***- Can’t open files confirmed several details in the comments here ("The memory could not be "read"").To recount the history of this bug report:1. Zack opened this bug report (#3671), stating that he was getting the error message "General input/output error" whenever he attempted to run Writer, either with a new blank document or an existing document.2. Someone else came along and said they were getting the error message "General error, memory could not be read" whenever they attempted to open a document in Writer. Based on their bug, that person changed the title of this bug report to "FILEOPEN impossible, General error, memory could not be read" 3. In response to Action #2 above, Zack opened a new bug report (#36375) that restated his initial bug report, with his original title.Action #2 above was wrong and should not have been done. It confused two different error messages (one an error in input/output and the other an error reading memory) that occur at two different times (one when trying to run Writer, and one when trying to open an existing document in Writer).At this point, I agree with Zack that this issue thread is hopelessly confused. I suggest closing this issue as a duplicate and then following up on Zack's issue at his new bug report #36375, and the other bug at whatever bug number is created for it.I agree with Allen inthat this bug report is now quite confusing and should be closed. Anyway, the problem where attempting to open ODF documents failed with a useless "General input/output error" message had the same root cause as, so that problem is fixed now, even more reason to resolve this bug report.Could bugzilla_acct_1959 please tell more what kind of document he/she/it was trying to open?The crash when quitting LibreOffice is another thing, not related to the file opening problem. I wish people would spend as much time on producing useful bug reports that don't mix in different problems as they do on coming up with clever email addresses for bugzilla.
id=36284	CreatedError saving the document...3.4.0-beta1/win/x86/LibO_3.4.0beta1_Win_x86_install_multi.exe[LibreOffice 3.4.0 DEV300m103 Build 1 / on WinXP]- Open Writer via swriter.exe- Type some text- Save as "Test1" <Ctrl+S>Error message:Error saving the document Untitled1General error.General input/output error.The same error message withCalc, Impress, Draw.Have to kill soffice.bin for turning off the application. This is a blocker without a doubt. Related to? Same error message for both bugs.Might have same roots like- FILEOPEN impossible, General error@Thor:Can you help?Please feel free to reassign if it's not your area!I assume you tried to save in the default ODF formats (.ods, .odp, .odt)? In that case this problem has the same root cause as, which has been fixed. Resolving as duplicate.*** This bug has been marked as a duplicate of***[Tor Lillqvist]"I assume you tried to save in the default ODF formats (.ods, .odp, .odt)?"Yes. Sorry for the poor description.And thanks, I'll test the fix with the next available build...
id=36320	LibO 3.4 Beta1Windows XP SP3 All updates installedOpening LibO menu menu screen is incomplete at bottom "Get more tem" has something missing.Trying to open any file gives message "General Error General input/output error"Repair option gives same result. Other items also are affected but may be the same cause. Related to or DUP of- LO 3.4 Writer Won't Open?CreatedOpen – errror messageI can confirm that bug for Startcenter, Writer, Calc, Draw, Impress:Menu Open > [select any *.odt, *.ods, *odg, *.odp]gives the mentioned error message.Impossible to open an existing document (ODF).Currently I see this one as a DUP of.@reporter:Please feel free to reopen this Bug if you find evidence that we have an independent issue here.*** This bug has been marked as a duplicate of***@Rainer BielefeldAs I understand– "LO 3.4 Writer Won't Open",and now stated in#c11 [],these are different issues.Here we can open the application(s) (Writer etc.).This issue describes that fileopen is impossible.Now you've modified the summary ofto "FILEOPEN impossible, General error".That's a little bit irritating, but it would match the intention of this.Nevertheless I would prefer to reopen.But I'll respect your decision.(In reply to)I agree. The error messages are the same, but the steps taken to produce the errors are different.
id=36345	Clean installation of 3.4 Beta 1 under Windows 7.None of the checkboxes in the options panel are visible, making it impossible to change any settings. This can be seen in the screenshotadded to a different issue.This is a blocker because it makes the options panel completely unusable. Oh yeah. The check boxes are totally screwed up in the Options dialog. Actually all dialogs are affected, not just the Options dialog.Maybe Tor?Also this bug has the same rootcause as.*** This bug has been marked as a duplicate of***
id=36375	CreatedScreenshot of error messageI try to open writer and I get this error message:General Error.General input/output error.It doesn't matter if I try to start writer from the startcenter (as shown in the screenshot) or I manually try to open swriter.exe, I get the same error message. This bug was originallybut that has morphed into the bug which deals with opening files. Either way, they are related as the same error message occurs.I tried the instructions as proposed by Allen inwhich read:(In reply to)Step 7 solves the problem and allows writer to run. However, upon exiting LO (doesn't matter what component is running) soffice.exe crashes every time.Hope some of this helps! I still suspect that "- FILEOPEN impossible, General error, memory could not be read"has the same rootsThat is a different bug and IMO should be handled on a different thread. It might be the same as the "Error reading memory" that others are reporting.OK, there is something in your %APPDATA%\LibreOffice folder that is preventing Writer from running. I have no idea what that might be though, and just to warn you, tracking down the specific item might be about ten times more work than you've expended so far. If you have the time though, it might be helpful if you close LO (Steps 1-5 of the troubleshooting procedure I posted), delete your new %APPDATA%\LibreOffice folder and then rename your defective folder %APPDATA%\LibreOffice-save back to %APPDATA%\LibreOffice. Then attempt to run Writer and confirm you are getting the bug. Finally, follow my procedure on your earlier bug report #36271 to generate a ProcMon dump file, upload that file somewhere and post a link where I can download it and take a look.Zack, Tor's recent comments on a number of different bugs indicate that some serious and potentially related problems in LO v3.4 Beta 1 have already been fixed. Given the level of effort that would be required to track down the specific source of your problem, as well as a availability of a work around (deleting the %APPDATA%\LibreOffice directory), I think it would make sense at this point to wait for a LO v3.4 Beta 2 release and see if that resolves this problem, before attempting to troubleshoot further.I cannot reproduce this problem in a fresh install of a fresh build of the libreoffice-3-4 branch.probably is useful, there might be something in your user-specific settings that causes the problem. Do you think you could zip up the %APPDATA%\LibreOffice folder and attach to this bug? Please check that nothing confidential gets included.(In reply to)I'm going to wait for Beta 2. Based on the error message I agree that this may be related toas well.(In reply to)This only occurs when attempting the workaround of deleting/renaming the %APPDATA%\LibreOffice folder.I will close this bug for now and await the Beta 2. If the problem resurfaces I'll reopen and attach the contents of my %APPDATA%\LibreOffice folder and we can go from there.Thanks for all the hard work!This has been fixed in Beta 2.Remove infoprovider from closed and resolved bugs.RESOLVED, FIXED or CLOSED bugs cant be KEYWORD NEEDINFO.
id=36437	It is very important that our community members could test the nightly builds without any risk for the productive user / profile. I tested one of this builds with my current user and get issues with the user profile. It doesn't work correctly with my LibO 3.3.x anymore. In my case it affected an extension (the Presenter Console) and I was only aware of this issue, because I had to give a presentation about LibreOffice (and use the second monitor).Because of such possible side effect I propose a different namespace and a different profile for the nightly build (like in the OOo project). We should name it more interesting, e.g. LibO-future. We need more people who install and use the development builds on their desktops, so that we could get feedback early and often, if something went wrong within the code. Good idea, can we expect you to help in implementing that?@Tor: I can test it, but I can't implement it. I'm working currently on another important sub-project for LibO and have no time to examine, where the necessary changes had to be done.There should not be anything necessary except to not build the openoffice targets, but the openoffice-dev targets in instsetoo_native/utili.e.ALLTAR : openofficedev_$(defaultlangiso) ooolanguagepackdev $(eq,$(OS),MACOSX $(NULL) ooohelppackdev)instead of the defaultALLTAR : openoffice_$(defaultlangiso) ooolanguagepack $(eq,$(OS),MACOSX $(NULL) ooohelppack)As building dev-versions is the more usual task, the dev-named variant should be made the default, and the non-dev variant be activated with --enable-release or something.Anyway, to check whether the building of dev variant works for libreoffice, or whether there needs to be changes needed, build LO, and after regular building, source the environmentfile, cd instsetoo_native/util and run dmake openofficedev_en-US - this should produce the libreoffice-dev version of the installer.***has been marked as a duplicate of this bug. ***Changed "Nightly" to "Developer" as this applies to beta as well as nightly builds.This topic is not only important for our community members, but for our marketing and public recognition too.If we want external people to test our release-early / release-often cycle, installing a test/daily/beta version should not lead to deinstallation of the version of LibreOffice they use for productive work. Similar problems might happen to their user profiles.We can't expect an average user to set up a virtual machine or create a test user account to avoid such interaction. We got negative public feedback on our first Beta, now it's the same for the present Beta. If we can't change the product's behavior in short time, we should modify our website to describe different installation processes for final releases and developer/tester builds.Developers: Please check if this topic qualifies for an "Easy Hack" - and if nobody considers it to be important enough to work on it, tell us, so we can modify our website (perhaps leading to less testers, but to less negative feedback as "premature project" too).All: Do you think this topic is worth to be linked to the "most annoying bugs" ()?This issue by its very nature only affects developer builds, so I don't think it would make any sense to set it to block a stable release.I patched openoffice.lst in master, so openofficedev target does not want to package JRE any more.I built dev versions (en-US only) on Windows and on Linux without problems.The --enable-release configure switch is yet to be implemented.This is not a medium priority enhancement request. It is essential for developer builds to be installable alongside stable versions to allow the product to be tested. Setting a more appropriate importance.And since when does an anonymous bugzilla commenter get to decide?In master I introduced a new switch to configure: --enable-release-buildDefault is dev build with dev prefixes all around.For 3.4 we'll not have more betas (or will we?) so I would not disturb that branch.It'd be great to have it already for 3.4!I assume many many people out there beeing keen to install the 3.4 prerelease to satisfy their couriousity and to give feedback about issues they encounter.As 3.4 from my point of view, is widely considered the very first child of genuine libreoffice development. This way we might profit from more eyes power resulting in a more refined release.One more thank You for the great work done so far.FriedrichWhy is this marked RESOLVED FIXED? LO 3.4 beta 4 still overwrites previous versions.I don't remember specifically where - but someone has added a note that installing LO 3.4 beta 4 will replace earlier installations. So we are being warned at the moment. The next issue might be how a user can see in their application menu which version is stable and which is not - most places in Windows and Linux the version is not usually mentioned, just the application name. It might be good to have some visual indication on the application icons. This is especially relevant with Widnows / and the Ubuntu Unity desktop encouraging keystroke launching of application. Just my thoughts on this.Thanks for the great progress LO has already made - I've noticed a few silly things disappear which bugged me about OOo.This process will not be used for 3.4[.0] - the next build is already planned to be a rc = release candidate, and those are supposed to behave exactly like the final version, thus you would have had a dev-build just for one single build, and that would be confusing at best.for the next releases, the dev-builds will be used and hence will make it much easier for testers/QA/interested users to follow the nightly builds/start earlier with QA for the release without having to worry about removal of the stable version.***has been marked as a duplicate of this bug. ***
id=36500	Just downloaded 3.4 Beta 2. On exit, soffice.bin crashes every time. It doesn't matter if its a new document or an existing document, a crash occurs on exit every time. It doesn't matter how long LO is open for, a few seconds or a few minutes, a crash occurs regardless.While usability doesn't appear to be affected, you can't ship a program that crashes on exit, therefore I marked this as a blocker.System:Windows Vista SP2 32 bit Probably duplicate of(In reply to)Wow, I even commented on that bug. Talk about brain fart...*** This bug has been marked as a duplicate of***
id=36551	It's not possible (without dirty tricks) to update a 3.3.2 installation of LibreOffice to the 3.4.0beta2, because of unfortunate naming of packages.There are versioned package names, that install files to non-versioned directories.both core as well as extension packages are affected. For example/opt/libreoffice/program/kdefilepicker is in package "libreoffice3.3-core01" and"libreoffice3.4-core01"As both have a different name, the libreoffice3.4-core01 is not considered an update of libreoffice3.3-core01, thus rpm as well as dpkg try to install the 3.4-0beta2 one alongside of the 3.3.2 one, and of course fails because both packages include the same files (the same filepaths)It's a bad idea to have versioned package names when they use a non-versioned directory. The only way to do a clean update in this case is to add tons of "Obsoletes" statements in all affected packages.#########################################################Two ways to solve this dilemma1) Allow packages to installed along each other (except the desktop-integration one - you have to decide which version should be in your DE's menu, what should be default for the corresponding mime-types)In this case, make the installation directory versioned as well. /opt/libreoffice3.4/..... for example2) Have 3.4.0 be an update to previous version(s)In this case remove the version from the package names, and add a corresponding Obsoletes: <packagename>3.3 to the packages(or put a hard break to it without adding Obsoletes-directive and make manual uninstallation of previous versions mandatory for the users by putting it in big letter to the release notes)(note that neither of the above is a replacement for special development versions that can always be inside alongside release(candidate) versions likerequests) ***has been marked as a duplicate of this bug. ***This is IMO a duplicate of[- broken debian files ]No, 31747 is no duplicate. Only the very last comment is the same problem, but the rest of the problem is about a conflict of en-US vs. en-us.is a mutating issue (turning from problem A in completely different problem B). Dealing with those issues is a pain in the a… and in most cases it's far easier to write a new bug with a clean, focused description, instead of having to read through pages of comments)This issue: Version part of package name, but files in non-versioned directoriesOther issue: Something about en-US in the package name, but an en-us in the package's dependencies (or the other way round - no idea whether this still applies, I don't use deb).Steering committee has decided to allow to install LO-3.3 and LO-3.4 in parallel, seeI am going to fix the linux part: * rename libreoffice3 packages to libreoffice3.4 * change the default prefix from /opt/libreoffice to /opt/libreoffice3.4 * keep user configuration in ~/.libreoffice/3Fridrich, Tor, Thorsten, could you please do something similar on Windows and MAC for LO-3.4.0-rc1 release?So when the steering committee decided to "allow" a parallel installation, did they mean that this should be *optional*? I.e. that it should be possible for the user to *choose* whether to install 3.4 in parallel with an earlier LO installation, or whether to let it overwrite/override it? That will be quite hard to implement on Windows at least, without actually providing two separate sets of installers for two completely separate products, one which is a new version of the LibreOffice product, one which is a new LibreOffice3.4 product.(In reply to)DoneNote that even the desktop integration packages can be installed installed in parallel. Everything is versioned, including desktop menu entries and the libreoffice3.4 wrapper.There was a long discussion and it is not easy to do this for Windows. Though, we decided to produce non-conflicting daily builds using tinderboxes for Windows (so called dev builds).
id=36924	I very much welcome the change of including all available dict-packages in the main installer tarball(s), but I doubt they completely replace the English spelling tools (i.e. the dict-en package) so that it need not be included any more...The package is absent from all Linux tarballs:Linux x86 (deb), LibO_3.4.0beta4_Linux_x86_install-deb_en-US.tar.gzLinux x64 (deb), LibO_3.4.0beta4_Linux_x86-64_install-deb_en-US.tar.gzLinux x86 (rpm), LibO_3.4.0beta4_Linux_x86_install-rpm_en-US.tar.gzLinux x64 (rpm), LibO_3.4.0beta4_Linux_x86-64_install-rpm_en-US.tar.gz *** This bug has been marked as a duplicate of***
id=38590	Createdspreadsheet with charts which cause probable memory leakSteps to reproduce:- open the attached spreadsheet with LibO 3.4.1 rc1- go to the bottom of the sheet to show the charts- navigate in the sheet several times in order to show and hide the charts- after a moment it becomes impossible to save the file : too many files open !In fact, if you look at the temporary folder used by LibO, you can see that Calc create many new temp files each time a chart becomes visible.With the attached file I reach quickly ~1000 filesresult of ulimit -n command : 1024 ...Best regards. JBF correction of summary.Consequence of this bug : data loss when you can't save your file.possible duplicate ofI haven't looked into it but sounds similar.Createdanother test documentIt might be related to charts. I have created another sample document with two charts. It opens new temp files every time I go down or up the page.The temp files are binary files starting with the text "VCLMTF". I think that it is a meta file describing the chart picture. I guess that it draws the chart from the beginning everytime it appears on the screen. It does not reuse and and does not close pictures that are not longer visible.I do not see it with 3.4.0, so it a regression added in this bug fix release :-((In reply to)Something has been changed between 3.4.0 and 3.4.1 in the updating of a chart when data used to define this chart are modified. In 3.4.0 when you modify the value of a data, the chart is not updated automatically. It is in 3.4.1 rc1.Best regards. JBFI built the latest libreoffice-3-4 which shows the problem, then I downgraded -only- the 'sc' module to libreoffice-3-4-0 and the problem is gone.Ergo at least the exacerbating cause of the issue is in the 'calc' repository (which includes chart2 of course) between libreoffice-3-4-0 and libreoffice-3-4-1. Hopefully that narrows it a little.I didn't like this patch at the time it was reviewed on the list ;-> so I was suspicious from the outset that this was it, and ... bingo :-)If I add / and/or remove just this one commit:commit 70af08e849a93d56915b7abe14537facf1022a6aAuthor: Cédric Bosdonnat <>Date: Wed May 18 12:04:28 2011 +0200 fdo#36688: Fixed undisplayed calc page and header / footer borders When displaying the page, header and footer borders, calc uses a fake ScDocument with no drawing page. Create a new SdrPage if none can be fetched from the ScDocument to create the primitive processor. Signed-off-by: Kohei Yoshida <>diff --git a/sc/source/ui/view/output.cxx b/sc/source/ui/view/output.cxxindex f37a2c8..22b5d24 100644--- a/sc/source/ui/view/output.cxx+++ b/sc/source/ui/view/output.cxx@@ -52,6 +52,7 @@ #include <basegfx/matrix/b2dhommatrix.hxx> #include <svx/sdr/contact/objectcontacttools.hxx> #include <svx/unoapi.hxx>+#include <svx/svdpage.hxx> #include "output.hxx" #include "document.hxx"@@ -1634,17 +1635,19 @@ void ScOutputData::DrawRotatedFrame( const Color* pForceColor ) drawinglayer::processor2d::BaseProcessor2D* ScOutputData::CreateProcessor2D( ) {+ SdrModel aModel;+ SdrPage aSdrPage( aModel );+ ScDrawLayer* pDrawLayer = pDoc->GetDrawLayer();- if (!pDrawLayer)- return NULL;+ if ( pDrawLayer )+ aSdrPage = *pDrawLayer->GetPage( static_cast< sal_uInt16 >( nTab ) ); basegfx::B2DRange aViewRange;- SdrPage *pDrawPage = pDrawLayer->GetPage( static_cast< sal_uInt16 >( nTab ) ); const drawinglayer::geometry::ViewInformation2D aNewViewInfos(...Then the problem appears and/or goes away.Creating that new SdrModel that new SdrPage and what we then do with it always seemed highly suspect to me :-) Of course, this prolly points to an underlying leak anyway - but we provoke it regularly here.Cedric - your patch ...***has been marked as a duplicate of this bug. ***I think I had the problem with 3.4.0 as well - that is probably why I installed 3.4.1rc1 ??Will check it.Okay, we fixed this by reverting the commit 70af08e849a93d56915b7abe14537facf1022a6a and are going to do 3.4.1-rc3.***has been marked as a duplicate of this bug. ***(In reply to)It seems that the bug is still in the master.Best regards. JBF(In reply to)Ok, explications given by moggi on irc. Thanks.(In reply to)JBF,Can you tell me1) how many times (roughly) do I need to show and hide the charts in order to reproduce this?2) where do you look to see the temp files that LibO creates, preferably on Linux? Is it /tmp?3) What are the names of those temp files? Is there a pattern in the naming?I'm trying to fix, and I'd like to make sure that I won't re-introduce this bug while fixing it.Thanks,KoheiWell, I did notice that I got tons of /tmp/lu41n115.tmp/lu41n*.tmp as I scrolled through the test document. Each scroll-through would increase the number of temp files there. With my (hopefully proper) fix for, I only see one temp file, and the number doesn't increase even after repeated scrolling, so I assume I've fixedthe right way.
id=41089	Steps to reproduce with Server installation of Master "LibO-dev 3.5.0 – WIN7 Home Premium (64bit) English UI [(Build ID: d3d1481-3f8994a-2ba0a9f)]"1. Open new WRITER document from LibO Start Center2. type xyz3. Menu 'File -> Save As (LibO or OS dialog, does not matter) -> click PW protection -> Browse for folder -> insert name' <save>4. Type and confirm password (without options) <ok> Expected: will be saved Actual: "Error saving the document [Name], General Error, General input/output Error"Save as MSWORD97XP.doc works fineWorked without problems with 3.4.3 Not reproducible (UI en-US; on WinXP 32b) withLibO-dev 3.5.0 · Build ID: 2d0998f-090bcba-45cf606[master~2011-12-01_08.37.54_libodev35.msi · 01-Dec-2011].Has been saved password-protected (and reopened) w/o any error message.Works fine (for me).I confirm error. Not only saving with password, but it will fail to open a password protected file saved with earlier versions. I had to uninstall 3.4.5, reinstall 3.4.4 to be able to open the protected odt file.LibreOffice 3.4.5 RC1Windows XP SP3NEW due toThis looks related to the other blocker.Thorsten, I think that your worked on it. Was it solved in libreoffice-3-4, libreoffice-3-4-5, and libreoffice-3-5 branches?Original report sounds unrelated to.[This is an automated message.]This bug was filed before the changes to Bugzilla on 2011-10-16. Thus itstarted right out as NEW without ever being explicitly confirmed. The bug ischanged to state NEEDINFO for this reason. To move this bug from NEEDINFO backto NEW please check if the bug still persists with the 3.5.0 beta1 or beta2 prereleases.Details on how to test the 3.5.0 beta1 can be found at:more detail on this bulk operation:Still reproducible with LibO 3.4.5 RC1[LibreOffice 3.4.5 · OOO340m1 (Build:501)](on Win XP 32b · UI en-US)Moving back to NEW from NEEDINFO again.For the record:Works fine with LibO 3.5.0 Beta2[LOdev 3.5.0beta2 · Build ID: 8589e48-760cc4d-f39cf3d-1b2857e-60db978](on Win XP 32b · UI en-US)I have reproduced the problem with 3.4.5-rc1 build. I do not see it with the last build from 3-4-5 branch. I guess that the fix for thehelped here as well. I guess that LO tries to read the created zip file after it is saved or so.Anyway, it should work in 3.4.5-rc2 again.Verified - FILESAVE with password protection works fine with LibO 3.4.5 RC2 (tested: Writer · on WinXP 32b).***has been marked as a duplicate of this bug. ***I saw that the testes for this report were made on Windows 32b, and I really don't know if with a report for this bug in Windows-32b is enough... but I forgot to mark that it was identified onUbuntu 11.10X86-64 systemand LibreOffice 3.4.5 OOO340m1 (Build:501)Thanks,The bug was solved in the 3.4.5 RC2 build 502. Thanks***has been marked as a duplicate of this bug. ***
id=43868	thank god, 3.5 beta 1 opened them. terrible scenery. it seems, that no changes have been made on the file by (mis-)trying to open it.15.12.2011please save a calc-file under 3.4.5 rc1 with password and try to reopen it.3.5 beta 1 was able to open it with the correct password.os: win 7 64 15.12.2011 Could you add a simple test document?[Reproducible] with "LibreOffice 3.4.5 RC1 - WIN7 Home Premium (64bit) German UI [Build ID: OOO340m1 (Build:501)]"steps to reproduce:1. Start LibO > Start Center appears2. New Spreadsheet Document > opens3. Type an "x" to A14. Menu (LibO dialogs) 'File -> Save as - Filename = "test" - Save sith PW checked > WP dioalog appears5. type password "password" and confirm "password" <ok>6. Menu 'File -> Close'7. Menu 'File -> Recent Documents - select "test.ods" <open> > PW dialog appears8. Type "password" <ok> Expected: document will be opened Actual: Message "Invalid Password" Document will be opened without problems with 3.5.0 Beta1 or Portable 3.3.3Same with document created with 3.4.4, so FILEOPEN problem@Markus:Please feel free to reassign (or reset Assignee to default) if it’s not your area or if provided information is not sufficient. Please set Status to ASSIGNED if you accept this Bug.Hi, I guess this is- default ODF encryption etc algorithms changed, so encrypted/protected documents from master cannot be opened in <= 3.4.X@Cor:I can't tell whether there is a relation. Here we are speaking about the problem that Libo 3.4.5 can't open a document that it saved 3 seconds ago, no different LibO versions are involved.@Rainer: I bet there is a relation. Stephan may want to have a look?BTW: gerdi: thanks for testing/finding this!<>:"Dec 15 11:22:52 <sberg> thorsten, 309f56174aca6adca879f70958892492361dac6e apparently broke password protected documents; opening old ones does no longer work ('wrong password,' cf sc_subsequent_filters_test testPassword), and writing new ones gives 'warn:legacy.osl:2705:1:/data/lo/core/package/source/xstor/owriteablestream.cxx:1336: Can't write encryption related properties!' (and opening again does not work either)""Dec 15 11:30:45 <thorsten> sberg: shit, that fix went to 3.4.5 - how twisted is that thing, manual review didn't turn up anything :("Not only CALC is affected, I also failed to open a WRITER document created with 3.5.0Beta1. Here the difference is that 3.4.5RC1 WRITER even is unable to save a document with password protection, Error message (General input output error) appears.To avoid misunderstanding: Also a protected document created with 3.3.3 Portable will not be opened with 3.4.5 RC1Thorsten, I think that you worked on this. Was it solved in the libreoffice-3-4,libreoffice-3-4-5, and libreoffice-3-5 branches?Note that there is also problem with saving password protected files, see the.(In reply to)Properly fixed for master and -3-5, reverted original fix for -3-4, pending review for -3-4-5 (thanks for the poke, had missed the branch-off there).Fix has been approved and pushed to 3-4-5 => FIXED***has been marked as a duplicate of this bug. ***Verified - FILEOPEN with password protection works fine with LibO 3.4.5 RC2 (tested: Writer · on WinXP 32b).For the record:Also OK for password protected files, created withLibO 3.3.4 releaseLibO 3.4.4 releaseLibO 3.5.0 Beta2LibO 3-5 LOdev 3.5.0beta2+ Build ID: 2650c80-7ef74e0-dee380a(libreoffice-3-5~2012-01-02_22.09.08...)***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***I saw that the testes for this report were made on Windows 32b, and I really don't know if with a report for this bug in Windows-32b is enough... but I forgot to mark that it was identified onUbuntu 11.10X86-64 systemand LibreOffice 3.4.5 OOO340m1 (Build:501)Thanks,The bug was solved in the 3.4.5 RC2 build 502. Thanks***has been marked as a duplicate of this bug. ***I revert pickers to correct selections***has been marked as a duplicate of this bug. ***"- FILEOPEN impossible for documents that were saved with password" still does not work with "LibreOffice 3.4.5 German UI[Build ID: OOO340m1 (Build:502)]" parallel Server installation on German WIN7Home Premium (64bit).(In reply to)then a bug in that version? reopen I would say...I tried (again) with Linux International/Dutch langpack this weekend. 3.3.4 <> 3.4.5 <> 3.5.0.Was OK.(In reply to)May be that there is a little damage in my installation (my LibOs have a hard life), 3.4.5 on WIN XP (VirtualBox) opens sample from "- FILEOPEN impossible for documents that were saved with password" without problems. Or can it be a problem of a server installation?It works here on Windows XP SP3 i586 with "LibreOffice 3.4.5 EN_US UI[Build ID: OOO340m1 (Build:502)]" with the server installation.So, it rather looks like a problem with your local installation.Note that we simply reverted the commit that caused all these problems with passwords => 3.4.5-rc2 should work the same way as 3.4.4 in this regard.I have LibreOffice 3.4.5 OOO340m1 (Build:502) on Ubuntu 11.10.Last week I could open my password-protected file, this week I cannot (with 3.4.5). On Linux Mint, with LibreOffice 3.4.4, the same file opens fine.(In reply to)I also cannot save a file with password protection (test file is also a Calc spreadsheet). Message is "Error saving the document pwtest: General Error. General input/output error."(In reply to)Can you check if the firefox or thunderbird version changed in this week?And correct bug for this problem is.Sorry did not notice it earlier.
id=45068	Hi!If you try to update an existing LibreOffice ( In the test most 3.4.4) the installation stops after warning, that all components of 3.4.x should be closed (In fact, they are...)On the German-ML tested with:LibreOffice 3,4,4 --> 3,5rc1 (windows 7 hp x64) HANGLibreOffice 3,4,4 --> 3,5rc1 (windows XP x86) OKLibreOffice 3,4,x --> 3,5rc1 (windows 7 pro x?) HANGLibreOffice 3,4,x --> 3,5rc1 (windows Vista hp x86) HANGML Thread: This looks like(and its many dupes). See in particularof: > It is impossible to fix this, because LibreOffice 3.4.4 is released and the bug is in LibreOffice 3.4.4 installer. It was fixed for 3.4.5, see.I suppose we now have another work-around: upgrade to LibreOffice 3.4.5 and *then* upgrade to LibreOffice 3.5.It remains very annoying that we cannot "fix" this in the *new* installer.*** This bug has been marked as a duplicate of***I have mentioned it at
id=44147	Createdodt-sheet with embedded calcopen the appended writer-sheet.click into the embedded calc-sheet.try to input an number in one of the cells.Normally the input is accepted, in this case no change.tested with version 3.5 beta from daily 2011-12-25-20-32-07win win7 64 seems to depend upon formatting:format all to number: the input appears.perhaps "standard" input is undefined??Happening in LODev 3.5.0 beta2. However, if I do ctrl-A, right click to format, and format all as any number format, it works.I see this also on Linux with 3.5.0-beta2-x86_64 build.To be more precise. I could write a text into a cell but when I press enter, the text disappear.I am not sure of the bug is in Writer or Calc => I rather add both experts into CC. Also I am going to add this to most annoying bugs.[Reproducible] with reporter's sample and own sample documents and Parallel Dev-Installation of "LibreOffice 3.5.0 Beta2- WIN7 Home Premium (64bit) German UI [Build-ID : 8589e48-760cc4d-f39cf3d-1b2857e-60db978]. Even a CALC object created in WRITER by 'copy/paste special - calc' from a CALC will loose it's contents integrity when you try to edit it.I can confirm observation that changing cell format from "Standard" to something explicit seems to heal the problem.There are lots of strange effects trying to edit CALC OLE objects, because it's easy to reproduce I will not repeat all observations.I also tested WRITER and DRAW OLE objects in CALC, no problem.Problem also visible with CALC objects in DRAW, currently I see this as a CALC problem (further investigations might lead to a different result).@Kohei:Please feel free to reassign (or reset Assignee to default) if it’s not your area or if provided information is not sufficient. Please set Status to ASSIGNED if you accept this Bug.[Reproducible] with Server installation of MSVC Master "LibO-dev 3.5.0 – WIN7 Home Premium (64bit) ENGLISH UI [Build ID: 485138f-e92bf75-4c1bcb5]" Win-x86@6 – 2011-12-06_21:37:02)Ir seems prolbem began somehwere between 11-11-28 and 2011-12-06Worked fine with Server installation of MSVC Master "LibO-dev 3.5.0 – WIN7 Home Premium (64bit) ENGLISH UI [Build ID: a653e50-1f92ab1-3bd0388]" Win-x86@6 - 111128)I'll take a look.I got it. Fixing the pagination in print preview and syncing selected sheets before and after the print preview ended up affecting this functionality. Very interesting.Fixed on libreoffice-3-5 and master.The fix will be in RC1.Version LOdev 3.5 beta3S.O. Ubuntu 10.04 and Debian Testing.Leaflet 'writer' with inserted OLE object (Calc).Opens the object Calc to modify the cells.No change is possible because the sheet Calc is protected.Even if 'format cells' eliminates the tick on 'protection' remains the factthat it is impossible to modify any cell. In my similar models very old (madewith OOo 2.x in years 2003, 2004 or 2005) the elimination of protection worksvery well and the cells are modified and saved correctly.@Felice: please, read more carefully what it written at the end of. The fix will be in RC1, it is not in beta-3.I tested on my own build of LO 3.5.0 beta3+ and it works as expected.Setting to fixed back.Best regards. JBF(In reply to)@Jean-Baptistethanks and sorry for the distraction, greetings ... Felice
id=46105	Createdmoment of crash during startupI use Win7 in english, and installed LibreOffice 3.5 final release in german. I had installed ver 3.4.5 in german before which worked well. The standard install succeeded without any errors. But when I start LO from the desktop icon I reach the crash (tried it a dozen times). And rebooting the pc won't help either. I also tried to repair and deinstall LO but still got the same error. I never selected the danish dictionary and also tried to delete it from the disk, but still the same crash. I have Java SE 7.02 installed.Uninstall LibreOffice, then delete C:\Program Files\LibreOffice 3.5. Reinstall. Does it work for you?*** This bug has been marked as a duplicate of***
id=46140	CreatedWindows crash logProblem description: Every time I update LibreOffice, for a while I continue to get a "LibreOffice has encountered a problem and needs to close. We are sorry for the inconvenience." error whenever I try to open a file with it. Uninstalling and reinstalling doesn't make a difference, nor does removing the PDF import extension. The problem usually fixes itself after a while but returns when I update again. The crash log is attached. (Possibly related to?)Steps to reproduce:1. Install LibreOffice2. Associate LibreOffice with documents, spreadsheets, and presentations3. Try to open a document.Current behavior:LibreOffice begins to load, but once the loading bar reaches halfway or so and the window reads "Enabling Danish spelling dictionary, hyphenation rules, and thesaurus" (which is odd because I only have the English dictionary installed), LibreOffice crashes and I get the error described above.Expected behavior: LibreOffice should open the document.Platform (if different from the browser): Windows XP Pro SP3 Browser: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; .NET4.0C) I resolved the problem by doing a clean uninstall of LibreOffice using Revo Uninstaller, which means that some files were being left over and not overwritten from a previous version I had installed. I would assume they existed in the \Program Files\LibreOffice 3.5\ folder.*** This bug has been marked as a duplicate of***
id=46782	CreatedSee the error (German UI)Hi!Downloaded LibO 3.5.1rc1 and tried to install over 3.5.0There was only a "repair,remove,change" available. (The same, like I would want to deinstalling LibO 3.5.0, BUT I want to update to 3.5.1rc1...OS: Win7 x64 SP 1 Sorry for bothering, was a mistake at my place...
id=47782	when the a MS .docx file received by email is opened and then saved as MS .docx the 10 page document is truncated to 4 pages.if the document is saved as a MS .doc file, the file is not truncated. Thanks for bugreportPlease, do not save documents in docx format using LibreOffcie. Or information will be lost.Dear John, DATA LOSS is the worst of all possible failures.You will have to attach such a document so that the error can be reproduced and tested, otherwise this bug is of little help to get this fixed.Createddocx file that exhibits the bugThis document clearly reveals the truncation bug with docx files.This bug also exist in 3.6.1.2 on MacOSXAlso true for LibreOffice 3.5.7.2 (Build ID: 350m1(Build:2)) on Ubuntu 12.04 LTS.Confirmed with the file attached here (from 16 pages to 9 after edit and save (+close and open)) and also one other file I cannot share created in not specified version of MS Word.Current version of LibreOffice is 4.1, can someone test it with this version?The other comments should probably go to one of these reports at LibreOffice Bugzilla:in 4.0 and 4.1.1 on Fedora RFR 64 bitdocument is not truncated after saving into docx and reloading, as I can see.But document formatting in some places becomes corrupted.I am using "Version: 4.1.4.2", "Build ID: Gentoo official package". The document indoes not seem to get truncated for me. However, libreoffice just truncated my ~22 pages document to seven pages. I believe I cannot share the .docx file, unfortunately.I am not familiar with the .docx format but it appears that after unzipping it and stripping all the markup from word/document.xml, most of the text is still kind of there. Meanwhile, other .docx consumers refuse to open the file at all.Ignore me, I think I wanted #55820Hi all, while I see some odd behavior and slight differences when comparing the test document in Word2010 and LO 4.2.0.1 pages are the same amount.Next I tried resaving to a new docx file. Then compared the two LO files (existing docx and newly created docx from test file), they are identical.Thus setting to WORKSFORME.I know similar issues do appear occasionally but with 4.2.0.1 and this test file it seems to no longer happen, so I suggest, if any of you run into a similar problem please make sure to create a new bug and we can start a new investigation of what's going on.this problem is still in versions 3.5A 29 pages .docx file saved with that extension and reopened only includes 7 pagesChecked in 4.4.1.2No Problems(In reply to Salvador from)Version 3.5 is obsolete. It would be different, if you would see the problem in versions 4.3.6 to 4.4.1.Setting back to WFM per other comments in 2015.
id=48469	CreatedScreen shots showing message boxes of problemI get a warning message box saying:--------------------------------------------------------------------------LibreOffice 3.4 Installation WizardPlease exit LibreOffice 3.5 and LibreOffice Quick Starter before you continue. If you are using a multi-user system, also make sure that no other user has LibreOffice 3.5 open.------------------------------------------------------------------------After clicking OK on the message box the installation returns to the LibreOffice 3.4 Installation Wizard having the following text:---------------------------------------------------------------------------"Installation Wizard CompletedThe wizard was interrupted before LibreOffice 3.5 could be completely installed.Your system has not been modified. To complete installation at another time, please run setup again.Click Finish to exit the wizard"--------------------------------------------------------------------------I do not have any version of LibreOffice on the computer. Yes, I have triple checked and have checked using control panel program remove.I have re-downloaded. I have reset the computer. I have cleaned the cache.I do have OpenOffice 3.30 OOO330m20 (Build:9567) installed on the computer but it was not running during any of the installation attempts.___________________________________________________________________________Please help.Thank you,Ann___________________________________________________________________________System Information:OS: Windows 7 Home Premium SP1 64 bitPC: HP p6340fProcessor: Intel Core 2 Quad CPU Q8400 @ 2.66 GHzHard Drive: 1 T with 747 GB freespaceInstalled Memory: 8.0 GB Verify you haven't the quick start for OpenOffice running, and if there is a soffice process running in the task manager, kill it.Pls if this solve the problem, change the bug status to resolved.I am pretty sure that reporter suffers from the known "update 3.4 to 3.5 not possible" "- Uninstall Problems with MSI on Windows 7 64bit " problem, but report is much to rare to decide.@reporter:Installing 3.4.5 (or 3.4.6, but I never tested that) and updating to 3.5 from that version will solve your problem if my suspect is correct.Please feel free to reopen this Bug if you find evidence that we have an independent issue here. If you want to do so please read hints on <>. If you believe that that is really sophisticated please as for Help on a user mailing listPlease:- Write a meaningful Summary describing exactly what the problem is- Contribute a step by step instruction containing every key press and every mouse click how to reproduce your problem (due to example in)- add information -- whether you ever had a LibO 3.4 version on your PC -- concerning your OS (Version( with Build ID if it's not a public release), Distribution, Language) -- how you launch LibO Installation and what options you selected -- everything else crossing your mind after you read linked texts*** This bug has been marked as a duplicate of***mariosv,I found soffice.bin & soffice.exe in processes on task manager, as you suggested.After removal of soffice.bin & soffice.exe, I installed LO without any problem.Thank you,Ann
id=48946	LibO-3.6.0alpha0_Win86 (the window: "Options - LOdev - Java") can not find the JRE, installed into the operating system. Confirmed on WinXP 32b w/ jre 1.6.0_31.Tried via 'Add..' button w/o success.Current version:master~2012-04-17_23.05.35_LibO-Dev_3.6.0alpha0_Win_x86tinderbox: buildname: Win-x86@6-fasttinderbox: tree: MASTERtinderbox: pull time 2012-04-17 23:05:35tinderbox: git sha1score:66974653c0635e9e13a277e22da33e7f2062e674binfilter:af20ea3f8376a9d29d00d06b106fc49ca85377afdictionaries:05f89ef6371a108ebc4e7763541407a2552ab274help:ae7aae4e8962cb1256a785dad57bc8ce697b993fI don't remember the first occurrence. But the following version has been affected, too:master~2012-04-01_22.12.31_LibO-Dev_3.6.0alpha0_Win_x86tinderbox: buildname: Win-x86@6-fasttinderbox: tree: MASTERtinderbox: pull time 2012-04-01 22:12:31tinderbox: git sha1score:4ab9719f15baddbc60b96d86d2e0878e79a6ddf7dictionaries:6299bf66e3004cb8db805b360070762d0870cf50help:879ce369d7f292c50886019a5a8573c316dc8cd5CreatedBase is not workingLOdev-3.6.0alpha0+_Win_x86 (build ID: 52d90ce)OS: Windows-7sp1_x32; Windows-XPsp2_x64This error does not allow Base will work - the status of "blocking" for this reason.***has been marked as a duplicate of this bug. ***CreatedMacro crash notificationMy macros started from a user defined Menu entry do crash because Java Virtual Machine can not be found. I can confirm the findings of previous posters w.r.t. WinXP and Win7version 3.6.0alpha0+ (Build ID: 7f3f6e4) on WinXP:1) Was not able to autodetect JRE.2) Tools->Options->Java: no JRE listed3) Tools->Options->Java: click add, in the path select dialog provide path to the installed JRE folder, click Ok, path selection dialog disappears and reappears again immediately. Nothing more happens.Are there any log files for us to look into?(In reply to)Well, my screendump says on a macrocrash:com.sun.star.uno.RuntimeExceptionProviderCache::populateCache: couldn't obtain XSingleComponentFactory for [JavaVirtualMachine]: An unexpected error occurred while searching fo a Java!Hope this may help the debuggers. I have no serious programming skils myself, so I am stuck here.Remains strange that no one has picked up this 'Blocker'. It stops me from thoroughly testing the patch that was made for faulty Table Autoformats.With the most updated master sources and a brand new LO profile, could you try to retrieve an useful backtrace by following this great video ?It could really help a lot the devs.(In reply to)Nothing stops you from just doing that, and publish the results here!(In reply to)Nothing at all, you're right except that I'm on Linux most of the time and try to give bt with symbols on this system.Now nobody forces you to do it :-)Added keyword 'regression'This bug is NEW,<>same problem with finding java on windows 8 CP.as outlined above about finding java.ljelly.I looked at it and it turns out, that it was failing in ./jvmfwk/source/fwkbase.cxx:181 with:The file: vnd.sun.star.expand:$URE_INTERNAL_LIB_DIR/libsunjavaplugin.dll does not exist."But the Library is called sunjavaplugin.dll and not libsunjavaplugin.dll.So we have really simple workaround for Alpha1:go to%INSTALL_DIR_LO_ALPHA1%\URE\misc\javavendors.xmlreplace <library vendor="Sun Microsystems Inc.">vnd.sun.star.expand:$URE_INTERNAL_LIB_DIR/libsunjavaplugin.dll</library> <library vendor="Oracle Corporation">vnd.sun.star.expand:$URE_INTERNAL_LIB_DIR/libsunjavaplugin.dll</library> <library vendor="IBM Corporation">vnd.sun.star.expand:$URE_INTERNAL_LIB_DIR/libsunjavaplugin.dll</library>through:sunjavaplugin.dll <library vendor="Sun Microsystems Inc.">vnd.sun.star.expand:$URE_INTERNAL_LIB_DIR/sunjavaplugin.dll</library> <library vendor="Oracle Corporation">vnd.sun.star.expand:$URE_INTERNAL_LIB_DIR/sunjavaplugin.dll</library> <library vendor="IBM Corporation">vnd.sun.star.expand:$URE_INTERNAL_LIB_DIR/sunjavaplugin.dll</library>LO -> Java Bridge is working now.(In reply to)Now you broke it on Linux and MacOS X :-)Sorry, this is my fault. The library was named sunjavaplugin originally; I renamed it during gbuildization of jvmfwk because the name did not fit any library naming scheme we had and did not realize that would cause problems on Windows. I will change the name back and mangle it in RepositoryFixes.mk .CreatedBase_errorWell, LOdev-3.6.0alpha1_Win-x86 finds the path to the JRE now. But the connection to the tables in LOdev_Base impossible still. See the snapshot in the attachment.David Ostrovsky committed a patch related to this issue.It has been pushed to "master":fdo#48946: URE_INTERNAL_LIB_DIR/libsunjavaplugin.dll does not exist.(In reply to)I take that back. I forgot there is more than one javavendors_<platform>.xml file, so Windows-specific change can be done without affecting other platforms.Therefore the fix is good and nothing more is needed.(In reply to)>Thanks, works fine (on WinXP 32b) w/- LibO 3.6.0alpha1 (Build ID: 66f01b5)- LibO-Dev_3.6.0alpha1Win-x86@6-fast MASTERpull time 2012-06-01 00:20:15core:76f63f4c9b324de9a6d2e1de1c6f718a153feb26- LibO-Dev_3.6.0alpha0Win-x86@6-fast MASTERpull time 2012-04-17 23:05:35core:66974653c0635e9e13a277e22da33e7f2062e674
id=49833	Tools|Options program crashes regardless of component. Unusable at this stage.Win 7x64 On pc Debian x86-64, master updated today, I don't reproduce this problem.Now, perhaps it's a specific Windows bug.Have you tried with a brand new LO profile ?If you still reproduce, you may follow this video to retrieve a useful backtrace :Not reproducible (on WinXP 32b).Works for me w/ LibO-Dev_3.6.0alpha0Win-x86@6-fastpull time 2012-05-11 21:40:19core:7327195602e7870e20a4eebb8ea26ae7294f065b.Works for me with LOdev 3.6 (2012-05-10) version 3.6.0alpha0+ (Build ID: 9980e69) Win-x86@6-fast on Windows Vista 64.NOT reproducible with parallel installation of Master "LOdev 3.6.0alpha0+ – WIN7 Home Premium (64bit) ENGLISH UI [Build ID: 9980e69]" (tinderbox: Win-x86@6-fast, pull time 2012-05-10 09:36:56)It seems to be working for others. It was most likely an intermediate bug that was fixed the next day. Let's close this bug for now.John, feel free to reopen it if you see it with more recent daily build.If you reopen it, please provide more information about the build: + URL where you got it + version from the "Help/About LibreOffice" dialog
id=51426	The installer file, accessed through, claims to be named LibO_3.5.4_Win_x86_install_multi.msi.In fact, it is named LibO_3.5.4_Win_x86_install_multi.man.Consequently, it will not initiate the Windows Installer.To install correctly, the extension must be renamed manually, from .man to .msi.This is a critical bug. Fortunately, it must be about the easiest to fix. Jep, IMHO a "Windows Installer bug. CCed Andreas Timar /in Installer Expert@David: Good catch ;)Jep, IMHO a "Windows Installer bug. CCed Andreas Timar /in Installer Expert@David: Good catch ;)Not reproducible for me. Clicked big download button "Main installer", was forwarded to <>But may be we have a mirror with a damaged file on it?I have no idea how to reproduce the problem - what ever it might be.@David/Florian:unfortunately important information is missing.Please:- Write a meaningful Summary describing exactly what the problem is- add information -- Why you selected Version 3.5.1RC1 -- Concerning the download mirror (I find that information in Seamonkey Download Manager) -- everything else crossing your mind after you read linked textsNot sure what's happened but it seems the problem might now now solved. When I follow the LibreOffice instructions onand click onthe link "Download the LibreOffice installer<>" I am now directed to a differentpage. I am testing the new download now but it seems to have thecorrect extension. Previously I asked a colleague to repeat theexercise for me and the result for both of us was the same ... ie. afile with an extension of .man rather than .msi. I will ask her torepeat the exercise again and report back.All the best, David.On 26/06/12 17:01,wrote:>>>>>>>So back to needinfo, may be Florian finds the Mirror or what ever else from where the damaged installation file was.Modified Version because Filename is for a release, not RC.Removed András for now due to latest comments, currently it seems to be a WWW / Mirror problem, not a installer packing problem.@David Any chance to find the mirror or what ever in your Browser history?For me it is alright now....I can confirm that the problem is solved. Thank you very much.ps. for your information, I am using LibreOffice to teach first-yearundergraduate business students about spreadsheets and relationaldatabases. That's why getting the installation facility workingperfectly is so important to me.On 27/06/12 03:04,wrote:>>WFM due to latest Comments
id=51278	For me, using 3.6 beta1 and beta2, it's just impossible to open reports in Base that were generated with LO 3.5.X.I can't either create new reports. If I double click on the reports wizard I get an error message saying that no valid templates are found. OK, that's an error that I had sometime ago that seems to happen to some people (looking in Google), but what is new to me is that if I double click on the option to create reports on design mode (which always worked before), this time it does nothing. Yes, I double click on it and nothing happens.On a previosly created .odb file (with 3.5.X), if I try to open a report, I get an error saying something like: The document XXXXXX can't be opened (it's a translation that I've done from the spanish message I get, it might not be exactly the same message on the pure english version). On this file, if I then try to create new reports I get the same result than in the previous paragraph.This is critical, as Base becomes unusable on 3.6. [Reproducible] with Biblio Database and Server Installation of "LibreOffice 3.6.0beta1 German UI/Locale [Build-ID: 1f1cdd8] on German WIN7 Home Premium (64bit). 1. Open Database2. click 'Reports'3. Click 'Use Wizard ... ' Blank new profile Bug: Error message@Lionel:one for you?Reproducible with Beta1(In reply to)Hmm... 3.6beta1 (official binaries) does not start *at* *all* for me (Linux x86-64 .deb). Says "terminate called after throwing an instance of 'com::sun::star::uno::DeploymentException'"So right now, cannot get to state to try to reproduce this bug :-|OK, could start 3.6.0beta1 and reproduce. Will try to build 3.6 soonish to chase that down.On pc Debian x86-64, with master sources updated today, I reproduce the problem.Here is the console logs when I click on wizard :warn:legacy.tools:10910:1:/home/julien/compile-libreoffice/libo/toolkit/source/helper/unowrapper.cxx:186: UnoWrapper::SetWindowInterface: there already *is* a WindowInterface for this window!warn:legacy.tools:10910:1:/home/julien/compile-libreoffice/libo/toolkit/source/awt/vclxtoolkit.cxx:1136: VCLXToolkit::createWindow: did #133706# resurge?And when I click on Design : warn:legacy.osl:10910:1:/home/julien/compile-libreoffice/libo/dbaccess/source/ui/misc/linkeddocuments.cxx:327: caught an exception!in function:com::sun::star::uno::Reference<com::sun::star::lang::XComponent> dbaui::OLinkedDocumentsAccess::newDocument(sal_Int32, const comphelper::NamedValueCollection&, com::sun::star::uno::Reference<com::sun::star::lang::XComponent>&)type: com.sun.star.io.IOExceptionHere are my findings up to now:dbaui::OLinkedDocumentsAccess::newDocument (file dbaccess/source/ui/misc/linkeddocuments.cxx) gets called with i_nActionID==ID_REPORT_NEW_TEXT, which thus sets a ClassID of {-41 '\327', -119 '\211', 109 'm', 82 'R', -73 '\267', -81 '\257', 72 'H', 32 ' ', -99 '\235', -2 '\376', -44 '\324', 4 '\004', -48 '\320', 21 '\025', -106 '\226', 15 '\017'}. This then trickles down to OOoEmbeddedObjectFactory::createInstanceUserInit (file embeddedobj/source/commonembedding/xfactory.cxx) which calls m_aConfigHelper.GetObjectPropsByClassID( aClassID );(file comphelper/source/misc/mimeconfighelper.cxx)which stringifies the ClassID to d7896d52-b7af-4820-9dfe-d404d015960f and calls xObjConfig->getByName( aStringClassID.toAsciiUpperCase() )which throws css::container::NoSuchElementException.So either the ClassID being used is incorrect, or it is correct and should be found, but is not found.This ClassID is mentioned in reportbuilder/registry/data/org/openoffice/Office/Embedding.xcuNatural questions:1) is this file correctly processed and installed?2) Does it have the intended effect?Except for gbuildification, not much seems to have happened in reportbuilder between 3.5 and 3.6:1) cosmetic changes from "Childs" to "Children", also in variable and method names; no "Childs" seems to be forgotten in this.So maybe it is a bug or some other behaviour in the gbuildification?Quickly comparing report-builder.oxt from dmake and from gbuild, it shows that registry/data/org/openoffice/Office/UI/Controller.xcu is missing. Also, META_INF/manifest.xml has many missing entries.[ build XCS ] reportbuilder/registry/schema/org/openoffice/Office/UI/ReportCommands.xcswarning: failed to load external entity "C:/lo/libo-master/reportbuilder/registry/schema//org/openoffice/Office/UI/WindowState.xcs"[ build XCU ] reportbuilder/registry/data/org/openoffice/TypeDetection/Filter.xcu[ build XCU ] reportbuilder/registry/data/org/openoffice/TypeDetection/Types.xcuwarning: failed to load external entity "C:/lo/libo-master/reportbuilder/registry/schema//org/openoffice/Office/UI/Commands.xcs"warning: failed to load external entity "C:/lo/libo-master/reportbuilder/registry/schema//org/openoffice/Office/UI/Commands.xcs"gbuild makefile does not copy those xcs files from solver to build dir. dmake makefile contained these lines:"$(PWD)$/$(MISC)$/$(EXTNAME)$/registry$/schema$/$(PACKAGEDIR)$/Commands.xcs": $(SOLARXMLDIR)$/registry$/schema$/$(PACKAGEDIR)$/Commands.xcs @@-$(MKDIRHIER) $(@:d) $(COPY) $< $@ "$(PWD)$/$(MISC)$/$(EXTNAME)$/registry$/schema$/$(PACKAGEDIR)$/WindowState.xcs" : $(SOLARXMLDIR)$/registry$/schema$/$(PACKAGEDIR)$/WindowState.xcs @@-$(MKDIRHIER) $(@:d) $(COPY) $< $@ "$(PWD)$/$(MISC)$/$(EXTNAME)$/registry$/schema$/$(PACKAGEDIR)$/Controller.xcs" : $(SOLARXMLDIR)$/registry$/schema$/$(PACKAGEDIR)$/Controller.xcs @@-$(MKDIRHIER) $(@:d) $(COPY) $< $@@dtardon: From the git log, it seems you made the gbuildification of reportbuilder? It seems it does not ship registry/data/org/openoffice/Office/UI/Controller.xcu, and other entries are missing in manifest.xml.Could you please take a look? Thanks in advance.(In reply to)That is the real problem. Files not present in manifest are ignored when an extension is registered. So, as far as libreoffice is concerned, the reportbuilder has no configuration files...The old build system allows to have a skeleton manifest for an extension that is then filled by a perl script (solenv/bin/makemani.pl) during build (which is something I overlooked at the time I did the conversion). We either need to duplicate that functionality in gbuild or fill all the necessary entries in.git grep COMPONENT_MANIFEST_GENERIC says there is no other extension that uses makemani.pl to create the manifest for it. (And git log -SCOMPONENT_MANIFEST_GENERIC says reportbuilder was the only extension that had ever used it.) So I am simply going to add all the necessary entries.David Tardon committed a patch related to this issue.It has been pushed to "master":fdo#51278 make reportbuilder work againDavid Tardon committed a patch related to this issue.It has been pushed to "master":fdo#51278 bump version to force update of package cacheReopening because the patch by David:1) Is not yet applied to all branches it should be (missing libreoffice-3-6)2) In my testing actually trying to generate a report is still broken after the patch.Reproduction instructions:Open DatabaseClick Reports in the left part of the window.If you already have a report in the database, open it (double-click or right-click and "open"). Error message.If there is no report in the database, click "Use Wizard to create report". Click ">>" to add all fields. Click "Finish" to take all default options. Error message.The document ReportName could not be opened.Cannot activate implementation(...)solver/unxlngx6/installation/opt/program/..share/extensions/report-builder/sun-report-builder.jar:Cannot activate jar(...)solver/unxlngx6/installation/opt/program/..share/extensions/report-builder/sun-report-builder.jar:java stack trace:com.sun.star.loader.CannotActivateFactoryException: cannot activatejar(...)solver/unxlngx6/installation/opt/program/..share/extensions/report-builder/sun-report-builder.jaratcom.sun.star.comp.loader.JavaLoader.activate(JavaLoader.java:282)Caused by missing items in the jar's manifest. And I even have a TODO for it in reportbuilder/Jar_reportbuilder.mk ...report creation works nowDavid Tardon committed a patch related to this issue.It has been pushed to "master":fdo#51278 fix reportbuilder manifestFix not applied to libreoffice-3-6 branch -> don't close bug (else it shows up as fixed in Most Annoying Bugs, and in the queries QA does before release to check that no blocker bug remains).Works now; squashed the three commits and pushed to libreoffice-3-6.David Tardon committed a patch related to this issue.It has been pushed to "libreoffice-3-6":fdo#51278 make reportbuilder work againIt will be available in LibreOffice 3.6.
id=52341	I've just installed LibreOffice 3.6.0.2 and when I try to run it: it opens a window titled: Microsoft Visual C++ Runtime Library. It has the following text in it: Runtime Error! Program: C:\path\soffice.bin and then "The application has requested the runtime to terminate in an unusual way. Please contact the application's support team for more info. " After a while a LO window shows up saying that LO needs to close. Please fix this urgently. My Windows version is Windows XP.I have Java version 1.6 Update 33.Not reproducible (on WinXP 32b; JRE 1.6.0_33) with server imageLibO 3.6.0.2 rc (Build ID: 815c576).Have you applied a LibO default user profile?Apparently a duplicate of '- LO cannot start (reports runtime error with Visual C++ Runtime Library'.*** This bug has been marked as a duplicate of***@Jean Spiteri: Please see <> for ways to gather more information that might help track down this issue.
id=53854	CreatedThe corrupted database fileProblem description: When working with a Base database using LO 3.6.0.4, after saving the file and closing Base, the file can not be opened again.Steps to reproduce:1. Open a database document file.2. Modify a table, create another table, etc.3. Save the Base file.4. Open the Base file.Current behavior:After working with a database document file with LO 3.6.0.4, saving the file corrupts it. When attempting to open the file, I get the Filter Selection dialog. This is true for LO 3.4.6, LO 3.5.6, and AOO 3.4.1.Expected behavior:The file should open Platform (if different from the browser): Browser: Mozilla/5.0 (X11; Linux x86_64; rv:14.0) Gecko/20120715 SeaMonkey/2.11 CreatedA Copy made of Budget.odb before opening the original with LO 3.6.0.Dan,I can reproduce this on Linux 64bit 3.6.0.4, but it is/was also being discussed on the German user/discuss mailing list, and I don't know now whether they actually filed a bug report, so this might be a duplicate.Alex@Robert : did you or anyone else from the German list file a bug report in the end for this problem ?AlexHi Lionel,From what I understand, this bug only affects x64 bit version, but for some reason when an existing ODB file is opened in Base, it gets truncated on saving, and thereby becomes unopenable in any version of LO, AOOo or equivalent products.AlexPlease check whether this is or not a duplicate of. For example, check with a recent daily or 3.6.1.rc(In reply to)Thanks Lionel, that's the one, but of course, I forgot to look for resolved bugs in my hunt for the dup.Setting as duplicate.Alex*** This bug has been marked as a duplicate of***
id=54542	Version 3.7.0.0.alpha0+ (Build ID: 4deb9d4)1) File New > Database2) Create default HSQLDB database. 3) Select defaults of New Database.odb as file name4) Open the file for editing. Click on Tables.5) Select "Use Wizard to create Table"What should happen : Table creation wizard should startWhat actually happens : nothingAlex @Lionel, Julien : adding you guys to take a look ?I tested this on Mac OSX, daily build from 30/08AlexAlso confirmed with separate ODB file that I had already made in previous versions of LO. If I open the file, click on the Tables icon, then click on the Table Creation Wizard, nothing happens.The Create View and the manual table creation entries work fine.Alex@Alex: I launched a recompilation from scratch of master sources (future 3.7) this morning, so I'll be able to test tonight when come back home(so after my daytime work).On pc Debian x86-64 with master sources updated today, I reproduced the problem.Here are the console logs:com.sun.star.uno.RuntimeException: string resource for id not availablejava stack trace: at com.sun.star.bridges.jni_uno.JNI_proxy.dispatch_call(Native Method) at com.sun.star.bridges.jni_uno.JNI_proxy.invoke(JNI_proxy.java:166) at $Proxy18.getByIndex(Unknown Source) at com.sun.star.wizards.common.Resource.getResText(Resource.java:81) at com.sun.star.wizards.table.TableWizard.getTableResources(TableWizard.java:388) at com.sun.star.wizards.table.TableWizard.<init>(TableWizard.java:82) at com.sun.star.wizards.table.CallTableWizard$TableWizardImplementation.trigger(CallTableWizard.java:82) at com.sun.star.bridges.jni_uno.JNI_proxy.dispatch_call(Native Method) at com.sun.star.bridges.jni_uno.JNI_proxy.invoke(JNI_proxy.java:166) at $Proxy18.getByIndex(Unknown Source) at com.sun.star.wizards.common.Resource.getResText(Resource.java:81) at com.sun.star.wizards.table.TableWizard.getTableResources(TableWizard.java:388) at com.sun.star.wizards.table.TableWizard.<init>(TableWizard.java:82) at com.sun.star.wizards.table.CallTableWizard$TableWizardImplementation.trigger(CallTableWizard.java:82)java.lang.IllegalArgumentException: Resource with ID not 2525not found(In reply to)So this problem is not specific to Mac OS; therefore adapted Platform field.Createdproposed patchI noticed in this commit:5eb16c1cf277a8a3514e81e64b211a2e4f4c7a8f(fixes to new template localization code)this change in:wizards/source/formwizard/dbwizres.src-#define RID_DB_TABLE_WIZARD_START 2500+#define RID_DB_TABLE_WIZARD_START 2525The problem is corresponding parts are in:- wizards/com/sun/star/wizards/ui/UIConsts.py- wizards/com/sun/star/wizards/ui/UIConsts.javaboth contain this:RID_TABLE = 2500So I just propose to update the value to 2525 too here.Forgot to say, I tested the patch and it's ok.@Andras and Lionel: what do you think about this proposed patch?If ok with it, I can commit and push it on master.(In reply to)Patch is OK. Commit.What I wonder is why 5eb16c1cf277a8a3514e81e64b211a2e4f4c7a8f pushed the value of RID_DB_TABLE_WIZARD_START so "tight" to 2525 and not to 2600, to give RID_DB_REPORT space to grow in future...(In reply to)Thank you for the feedback.I'll be able to commit and push only tonight (after my day time work). So if you want to think more about the value that RID_DB_TABLE_WIZARD_START should have (2600 or other) and post another comment here, don't hesitate to :-)BTW, I know how to push/"submit-for-rewiew" with gerrit and here I thought about pushing directly but I don't know the gerrit process for asking cherry pick on other branches. (found nothing on these pages:--- wiki.documentfoundation.org/Development/GitReviewSo by default I'll post on dev mailing list.(In reply to)Let's leave author & committer a chance to comment on that, maybe we are overlooking something.You do the cherry-pick yourself (recommended: in a detached HEAD state or a special-purpose branch just for *that* cherry-pick: e.g. branch "fdo54542"), and push the result to refs/for/BRANCH_NAME; ah no, that's "submit-for-review".To push a cherry-pick directly, just do the cherry-pick and push it, as if there were no gerrit (but push to the gerrit.libreoffice.org repository, not to git.freedesktop.org).But I don't understand why you ask here, as no other branch is affected, or did I miss that?Just to be clear: I haven't OKed the patch for any release branch (libreoffice-3-5, libreoffice-3-6, etc). In my mind it was intended only for master, since only master is affected.(In reply to)OKOups, you're right! :-)Of course, moreover with the previous comment.Sorry for the confusionThanks for the fix, Julien. It was an oversight from our side.Julien Nabet committed a patch related to this issue.It has been pushed to "master":fdo#54542 fix start of table wizard IDsThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=55493	CreatedRTF with the problemImages in attached RTF seem to be not scaled (one can "fix" it by right click->Picture->Original size); erroneous line ends added after them (?).3.6.0 and 3.5.x behave slightly differently (but wrong too), a user claims that 3.3 opens this file w/o issue. CreatedMid of the 1st page screenshot of this RTF file opened in MSOConfirmed. It seems this is produced by Oracle BI Publisher, if I re-save it with Word, it's opened correctly in Writer as well.OK, I know where the problem is.Miklos Vajna committed a patch related to this issue.It has been pushed to "master":fdo#55493 fix RTF import of specific PNG imageThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Resolved in master, -3-6 review request:Miklos Vajna committed a patch related to this issue.It has been pushed to "libreoffice-3-6":fdo#55493 fix RTF import of specific PNG imageIt will be available in LibreOffice 3.6.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Regression. Writer_LibO-dev_4.0.0.beta2\beta1+ does not show pictures that are in the table cells.Bag is absent in LibO-dev_4.0.0.0.beta2+ (ID: 835cae7e323b9831d11f5f4957933728f561e71; date: 22\12\12)
id=56855	CreatedA writer file and Impress file used in test described above under steps to reproduce. Note: Default font for Writer is Arial 10,5Problem description: I worked forth and back in an Impress and Writer file and wanted to copy a bullet list from Impress into WriterUpon pasting the clipboard content the pasted content was not visible but the formatting of the entire Writer file was destroyedctrl+z did not bring back the original formatting in writerSteps to reproduce:1 – Open Writer and type a few words in a new file2 – Open Impress and create a bullet list3 – Select bullet list and ctrl+C4 – Switch to Writer and ctrl+VCurrent behavior:copy & paste a bullet list from Impress into Writer destroys the Writer format irreparableExpected behavior:copy & paste a bullet list from Impress into Writer should be displayed in Writer as a bullet list matching the bullets of Impress or the Default for Writer. In minimum it should be pasted as unformatted textPlatform (if different from the browser): XP/SP3 Browser: Mozilla/5.0 (Windows NT 5.1; rv:16.0) Gecko/20100101 Firefox/16.0 Could not reproduce the destruction of the Writer document formatting with LO 3.7.0.0.alpha0+ (Build ID: 52faa1). LO copies the bulleted test lines from slide 2 into the ODT, converting the Impress style "Outline 1" to "Default~LT~Gliederung 1", omitting the bullet numbering however. Probably already fixed?Could someone make the test with the latest 3.6 release? The 3.7 release is still farway for most users? In my 3.5.7 the bug is consistent, I just produced it again.I really would appreciate a test of version 3.6? The test on 3.7 was done with limitations, thus not necessarily fully reliable. This bug is reducing productivity tremendously because it also destroys the saved version. I save frequently while working: ctrl+s and make every day a new copy of the file. Because instead of ctrl+b I hit crtl+v (English keyboard layout) I lost only today at least 1/2 day of work I am sure this will happen to other people as well.I changed importance to highest and blocker.Sorry to hear about the dataloss.This seems to be fixed in 3.6.2 and 4.0 master (e22be4 built today)There are no more 3.5 builds so closing this.Please feel free to reopen if you still get the problem in 3.6 or 4.0.
id=57311	LibreOffice 3.6.4.1 (RC1) for Linux / Deb x86 is named LOdev instead of LibreOfficeIts splash-screen has the tag betaAs a consequence the user profile is not found and a new one is created.The build for Linux / deb x86_64 does not has this problem.Best regards. JBF Fridirch, please make sure that you use the --enable-release-build and --with-branding=/path/to/official-lo-branding options :-)3.6.4.3 (aka rc3) is correct. Let's mark this as fixed.(In reply to)Indeed, verified today. :-)Best regards.
id=57855	Version 4.0.0.0.alpha1+ (Build ID: 61d43ea6aaaa953e2243548932e03649bb36f7b)Linux 32bit master buildHow to reproduce :1) Start LO master build2) Click on Templates in StartCenter3) Double-click on a template folder4) Switch to Preview mode by clicking on preview button5) Select a template from the list.6) FreezeForce kill is necessary.No gdb trace could be obtained.Alex Confirmed with 4.0-master on Ubuntu 12.04 x86_64 with last commit 28327c28ced32f181ed9b5c4921fd844e549980dAFAIK, the templates dialog is under reconstruction. I can't find the preview button in the current version. It seems that it always shows the preview now.To be honest, I do the testing with 4.0 build from yesterday. But I guess that master has this feature as well.The same freeze could be observed in the template properties dialog and was fixed byThis is now fixed in master and libreoffice-4-0 branches... though the old template manager has also died in the mean time in this branches.
id=58110	CreatedXlsx fileCalc crashes when opening a particular xlsx file. The xlsx file is attached.Backtrace:aviso: Currently logging to gdbtrace.log. Turn the logging off and on to make the new setting effective.[Depuración de hilo usando libthread_db enabled]Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".[Nuevo Thread 0x7fffeae21700 (LWP 11384)][Nuevo Thread 0x7fffe3c6f700 (LWP 11385)][Nuevo Thread 0x7fffe23fd700 (LWP 11386)][Nuevo Thread 0x7fffe15c8700 (LWP 11387)][Nuevo Thread 0x7fffd34ae700 (LWP 11388)][Nuevo Thread 0x7fffd2cad700 (LWP 11389)][Nuevo Thread 0x7fffcadbf700 (LWP 11390)][Thread 0x7fffd34ae700 (LWP 11388) terminado][Nuevo Thread 0x7fffd34ae700 (LWP 11391)][Nuevo Thread 0x7fffb9cae700 (LWP 11394)][Nuevo Thread 0x7fffb94ad700 (LWP 11395)][Nuevo Thread 0x7fffb3fff700 (LWP 11396)][Thread 0x7fffb3fff700 (LWP 11396) terminado][Nuevo Thread 0x7fffb3fff700 (LWP 11397)][Nuevo Thread 0x7fffb1a43700 (LWP 11398)][Thread 0x7fffb1a43700 (LWP 11398) terminado][Nuevo Thread 0x7fffb1a43700 (LWP 11399)][Thread 0x7fffb1a43700 (LWP 11399) terminado][Nuevo Thread 0x7fffb1a43700 (LWP 11400)][Thread 0x7fffb1a43700 (LWP 11400) terminado][Nuevo Thread 0x7fffb1a43700 (LWP 11401)]Program received signal SIGSEGV, Segmentation fault.0x00007fffc864bcff in SdrObject::ApplyNotPersistAttr(SfxItemSet const&) () from /opt/lodev4.0/program/../program/libsvxcorelo.so#0 0x00007fffc864bcff in SdrObject::ApplyNotPersistAttr(SfxItemSet const&) () from /opt/lodev4.0/program/../program/libsvxcorelo.so#1 0x00007fffc879181a in SvxShape::ObtainSettingsFromPropertySet(SvxItemPropertySet const&) () from /opt/lodev4.0/program/../program/libsvxcorelo.so#2 0x00007fffc87919d7 in SvxShape::Create(SdrObject*, SvxDrawPage*) () from /opt/lodev4.0/program/../program/libsvxcorelo.so#3 0x00007fffc8755e96 in SvxDrawPage::add(com::sun::star::uno::Reference<com::sun::star::drawing::XShape> const&) () from /opt/lodev4.0/program/../program/libsvxcorelo.so#4 0x00007fffc9780690 in oox::drawingml::Shape::createAndInsert(oox::core::XmlFilterBase&, rtl::OUString const&, oox::drawingml::Theme const*, com::sun::star::uno::Reference<com::sun::star::drawing::XShapes> const&, com::sun::star::awt::Rectangle const*, unsigned char, unsigned char, basegfx::B2DHomMatrix&) () from /opt/lodev4.0/program/../program/libooxlo.so#5 0x00007fffc97835bf in oox::drawingml::Shape::addShape(oox::core::XmlFilterBase&, oox::drawingml::Theme const*, com::sun::star::uno::Reference<com::sun::star::drawing::XShapes> const&, basegfx::B2DHomMatrix&, com::sun::star::awt::Rectangle const*, std::map<rtl::OUString, boost::shared_ptr<oox::drawingml::Shape>, std::less<rtl::OUString>, std::allocator<std::pair<rtl::OUString const, boost::shared_ptr<oox::drawingml::Shape> > > >*) () from /opt/lodev4.0/program/../program/libooxlo.so#6 0x00007fffbceba951 in oox::xls::DrawingFragment::onEndElement() () from /opt/lodev4.0/program/../program/libscfiltlo.so#7 0x00007fffc9590c73 in oox::core::ContextHandler2Helper::implEndElement(int) () from /opt/lodev4.0/program/../program/libooxlo.so#8 0x00007fffbf1a5965 in sax_fastparser::FastSaxParser::callbackEndElement(char const*) () from /opt/lodev4.0/program/../program/fastsax.uno.so#9 0x00007fffbf1b65e1 in doContent () from /opt/lodev4.0/program/../program/fastsax.uno.so#10 0x00007fffbf1b7394 in contentProcessor () from /opt/lodev4.0/program/../program/fastsax.uno.so#11 0x00007fffbf1b7fdf in doProlog () from /opt/lodev4.0/program/../program/fastsax.uno.so#12 0x00007fffbf1b950b in prologProcessor () from /opt/lodev4.0/program/../program/fastsax.uno.so#13 0x00007fffbf1b2b6a in XML_ParseBuffer () from /opt/lodev4.0/program/../program/fastsax.uno.so#14 0x00007fffbf1a69c4 in sax_fastparser::FastSaxParser::parse() () from /opt/lodev4.0/program/../program/fastsax.uno.so#15 0x00007fffbf1aadd2 in sax_fastparser::FastSaxParser::parseStream(com::sun::star::xml::sax::InputSource const&) () from /opt/lodev4.0/program/../program/fastsax.uno.so#16 0x00007fffc95935ec in oox::core::FastParser::parseStream(com::sun::star::xml::sax::InputSource const&, bool) () from /opt/lodev4.0/program/../program/libooxlo.so#17 0x00007fffc9593722 in oox::core::FastParser::parseStream(com::sun::star::uno::Reference<com::sun::star::io::XInputStream> const&, rtl::OUString const&, bool) () from /opt/lodev4.0/program/../program/libooxlo.so#18 0x00007fffc95b231d in oox::core::XmlFilterBase::importFragment(rtl::Reference<oox::core::FragmentHandler> const&) () from /opt/lodev4.0/program/../program/libooxlo.so#19 0x00007fffbcf471d4 in oox::xls::WorkbookHelper::importOoxFragment(rtl::Reference<oox::core::FragmentHandler> const&) () from /opt/lodev4.0/program/../program/libscfiltlo.so#20 0x00007fffbcf5bc51 in oox::xls::WorksheetGlobals::finalizeDrawings() () from /opt/lodev4.0/program/../program/libscfiltlo.so#21 0x00007fffbcf5d789 in oox::xls::WorksheetGlobals::finalizeWorksheetImport() () from /opt/lodev4.0/program/../program/libscfiltlo.so#22 0x00007fffbf1aaf46 in sax_fastparser::FastSaxParser::parseStream(com::sun::star::xml::sax::InputSource const&) () from /opt/lodev4.0/program/../program/fastsax.uno.so#23 0x00007fffc95935ec in oox::core::FastParser::parseStream(com::sun::star::xml::sax::InputSource const&, bool) () from /opt/lodev4.0/program/../program/libooxlo.so#24 0x00007fffc9593722 in oox::core::FastParser::parseStream(com::sun::star::uno::Reference<com::sun::star::io::XInputStream> const&, rtl::OUString const&, bool) () from /opt/lodev4.0/program/../program/libooxlo.so#25 0x00007fffc95b231d in oox::core::XmlFilterBase::importFragment(rtl::Reference<oox::core::FragmentHandler> const&) () from /opt/lodev4.0/program/../program/libooxlo.so#26 0x00007fffbcf471d4 in oox::xls::WorkbookHelper::importOoxFragment(rtl::Reference<oox::core::FragmentHandler> const&) () from /opt/lodev4.0/program/../program/libscfiltlo.so#27 0x00007fffbcf45a48 in oox::xls::WorkbookFragment::finalizeImport() () from /opt/lodev4.0/program/../program/libscfiltlo.so#28 0x00007fffbf1aaf46 in sax_fastparser::FastSaxParser::parseStream(com::sun::star::xml::sax::InputSource const&) () from /opt/lodev4.0/program/../program/fastsax.uno.so#29 0x00007fffc95935ec in oox::core::FastParser::parseStream(com::sun::star::xml::sax::InputSource const&, bool) () from /opt/lodev4.0/program/../program/libooxlo.so#30 0x00007fffc9593722 in oox::core::FastParser::parseStream(com::sun::star::uno::Reference<com::sun::star::io::XInputStream> const&, rtl::OUString const&, bool) () from /opt/lodev4.0/program/../program/libooxlo.so#31 0x00007fffc95b231d in oox::core::XmlFilterBase::importFragment(rtl::Reference<oox::core::FragmentHandler> const&) () from /opt/lodev4.0/program/../program/libooxlo.so#32 0x00007fffbce961cb in oox::xls::ExcelFilter::importDocument() () from /opt/lodev4.0/program/../program/libscfiltlo.so#33 0x00007fffc959a71d in oox::core::FilterBase::filter(com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) () from /opt/lodev4.0/program/../program/libooxlo.so#34 0x00007fffbce966f0 in oox::xls::ExcelFilter::filter(com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) () from /opt/lodev4.0/program/../program/libscfiltlo.so#35 0x00007ffff5937dd9 in SfxObjectShell::ImportFrom(SfxMedium&, bool) () from /opt/lodev4.0/program/libsfxlo.so#36 0x00007ffff593b3b2 in SfxObjectShell::DoLoad(SfxMedium*) () from /opt/lodev4.0/program/libsfxlo.so#37 0x00007ffff598aea2 in SfxBaseModel::load(com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) () from /opt/lodev4.0/program/libsfxlo.so#38 0x00007ffff59d19f7 in SfxFrameLoader_Impl::load(com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&, com::sun::star::uno::Reference<com::sun::star::frame::XFrame> const&) () from /opt/lodev4.0/program/libsfxlo.so#39 0x00007fffd0dd083b in framework::LoadEnv::impl_loadContent() () from /opt/lodev4.0/program/../program/libfwklo.so#40 0x00007fffd0dd0dfa in framework::LoadEnv::startLoading() () from /opt/lodev4.0/program/../program/libfwklo.so#41 0x00007fffd0d4c621 in framework::LoadDispatcher::impl_dispatch(com::sun::star::util::URL const&, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&, com::sun::star::uno::Reference<com::sun::star::frame::XDispatchResultListener> const&) () from /opt/lodev4.0/program/../program/libfwklo.so#42 0x00007fffd0d4ccc8 in framework::LoadDispatcher::dispatchWithReturnValue(com::sun::star::util::URL const&, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) () from /opt/lodev4.0/program/../program/libfwklo.so#43 0x00007ffff6991ac0 in comphelper::SynchronousDispatch::dispatch(com::sun::star::uno::Reference<com::sun::star::uno::XInterface> const&, rtl::OUString const&, rtl::OUString const&, int, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) () from /opt/lodev4.0/program/libcomphelpgcc3.so#44 0x00007ffff793b125 in desktop::DispatchWatcher::executeDispatchRequests(std::vector<desktop::DispatchWatcher::DispatchRequest, std::allocator<desktop::DispatchWatcher::DispatchRequest> > const&, bool) () from /opt/lodev4.0/program/libsofficeapp.so#45 0x00007ffff794a03a in desktop::OfficeIPCThread::ExecuteCmdLineRequests(desktop::ProcessDocumentsRequest&) () from /opt/lodev4.0/program/libsofficeapp.so#46 0x00007ffff7921244 in desktop::Desktop::OpenClients() () from /opt/lodev4.0/program/libsofficeapp.so#47 0x00007ffff7922cf2 in desktop::Desktop::OpenClients_Impl(void*) () from /opt/lodev4.0/program/libsofficeapp.so#48 0x00007ffff3971f01 in ImplWindowFrameProc(Window*, SalFrame*, unsigned short, void const*) () from /opt/lodev4.0/program/libvcllo.so#49 0x00007ffff397a49e in SalGenericDisplay::DispatchInternalEvent() () from /opt/lodev4.0/program/libvcllo.so#50 0x00007fffe96459b7 in GtkData::userEventFn(void*) () from /opt/lodev4.0/program/libvclplug_gtklo.so#51 0x00007fffe9645a29 in call_userEventFn () from /opt/lodev4.0/program/libvclplug_gtklo.so#52 0x00007fffe796cd53 in g_main_context_dispatch () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#53 0x00007fffe796d0a0 in ?? () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#54 0x00007fffe796d164 in g_main_context_iteration () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#55 0x00007fffe9645b1d in GtkData::Yield(bool, bool) () from /opt/lodev4.0/program/libvclplug_gtklo.so#56 0x00007ffff3690721 in Application::Yield(bool) () from /opt/lodev4.0/program/libvcllo.so#57 0x00007ffff36907d7 in Application::Execute() () from /opt/lodev4.0/program/libvcllo.so#58 0x00007ffff791e16d in desktop::Desktop::Main() () from /opt/lodev4.0/program/libsofficeapp.so#59 0x00007ffff3695e31 in ImplSVMain() () from /opt/lodev4.0/program/libvcllo.so#60 0x00007ffff3695ef5 in SVMain() () from /opt/lodev4.0/program/libvcllo.so#61 0x00007ffff794c247 in soffice_main () from /opt/lodev4.0/program/libsofficeapp.so#62 0x00000000004007cb in main ()Hilo 17 (Thread 0x7fffb1a43700 (LWP 11401)):#0 0x00007ffff6e2c0fe in pthread_cond_timedwait@@GLIBC_2.3.2 () from /lib/x86_64-linux-gnu/libpthread.so.0#1 0x00007ffff7bb41a7 in osl_waitCondition () from /opt/lodev4.0/program/../ure-link/lib/libuno_sal.so.3#2 0x00007fffd3ba1421 in configmgr::Components::WriteThread::execute() () from /opt/lodev4.0/program/../program/configmgr.uno.so#3 0x00007ffff5d01773 in salhelper::Thread::run() () from /opt/lodev4.0/program/../ure-link/lib/libuno_salhelpergcc3.so.3#4 0x00007ffff5d01aea in threadFunc () from /opt/lodev4.0/program/../ure-link/lib/libuno_salhelpergcc3.so.3#5 0x00007ffff7b9339d in osl_thread_start_Impl () from /opt/lodev4.0/program/../ure-link/lib/libuno_sal.so.3#6 0x00007ffff6e27e9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0#7 0x00007ffff7130cbd in clone () from /lib/x86_64-linux-gnu/libc.so.6#8 0x0000000000000000 in ?? ()Hilo 13 (Thread 0x7fffb3fff700 (LWP 11397)):#0 0x00007ffff7125303 in poll () from /lib/x86_64-linux-gnu/libc.so.6#1 0x00007fffb835735f in ?? () from /usr/lib/x86_64-linux-gnu/libpulse.so.0#2 0x00007fffb834876c in pa_mainloop_poll () from /usr/lib/x86_64-linux-gnu/libpulse.so.0#3 0x00007fffb8348dd9 in pa_mainloop_iterate () from /usr/lib/x86_64-linux-gnu/libpulse.so.0#4 0x00007fffb8348e90 in pa_mainloop_run () from /usr/lib/x86_64-linux-gnu/libpulse.so.0#5 0x00007fffb835730f in ?? () from /usr/lib/x86_64-linux-gnu/libpulse.so.0#6 0x00007fffb35e0d18 in ?? () from /usr/lib/x86_64-linux-gnu/libpulsecommon-1.1.so#7 0x00007ffff6e27e9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0#8 0x00007ffff7130cbd in clone () from /lib/x86_64-linux-gnu/libc.so.6#9 0x0000000000000000 in ?? ()Hilo 11 (Thread 0x7fffb94ad700 (LWP 11395)):#0 0x00007ffff6e2c0fe in pthread_cond_timedwait@@GLIBC_2.3.2 () from /lib/x86_64-linux-gnu/libpthread.so.0#1 0x00007ffff7bb41a7 in osl_waitCondition () from /opt/lodev4.0/program/../ure-link/lib/libuno_sal.so.3#2 0x00007fffd0d70148 in framework::WakeUpThread::run() () from /opt/lodev4.0/program/../program/libfwklo.so#3 0x00007fffd0d615fa in threadFunc () from /opt/lodev4.0/program/../program/libfwklo.so#4 0x00007ffff7b9339d in osl_thread_start_Impl () from /opt/lodev4.0/program/../ure-link/lib/libuno_sal.so.3#5 0x00007ffff6e27e9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0#6 0x00007ffff7130cbd in clone () from /lib/x86_64-linux-gnu/libc.so.6#7 0x0000000000000000 in ?? ()Hilo 10 (Thread 0x7fffb9cae700 (LWP 11394)):#0 0x00007ffff6e2c0fe in pthread_cond_timedwait@@GLIBC_2.3.2 () from /lib/x86_64-linux-gnu/libpthread.so.0#1 0x00007ffff7bb41a7 in osl_waitCondition () from /opt/lodev4.0/program/../ure-link/lib/libuno_sal.so.3#2 0x00007fffbc94ecfb in (anonymous namespace)::InitUpdateCheckJobThread::run() () from /opt/lodev4.0/program/../program/libupdchk.so#3 0x00007fffbc942a1a in threadFunc () from /opt/lodev4.0/program/../program/libupdchk.so#4 0x00007ffff7b9339d in osl_thread_start_Impl () from /opt/lodev4.0/program/../ure-link/lib/libuno_sal.so.3#5 0x00007ffff6e27e9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0#6 0x00007ffff7130cbd in clone () from /lib/x86_64-linux-gnu/libc.so.6#7 0x0000000000000000 in ?? ()Hilo 9 (Thread 0x7fffd34ae700 (LWP 11391)):#0 0x00007ffff7125303 in poll () from /lib/x86_64-linux-gnu/libc.so.6#1 0x00007fffe6ea5563 in x11::SelectionManager::dispatchEvent(int) () from /opt/lodev4.0/program/libvclplug_genlo.so#2 0x00007fffe6ea563e in x11::SelectionManager::run(void*) () from /opt/lodev4.0/program/libvclplug_genlo.so#3 0x00007ffff7b9339d in osl_thread_start_Impl () from /opt/lodev4.0/program/../ure-link/lib/libuno_sal.so.3#4 0x00007ffff6e27e9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0#5 0x00007ffff7130cbd in clone () from /lib/x86_64-linux-gnu/libc.so.6#6 0x0000000000000000 in ?? ()Hilo 8 (Thread 0x7fffcadbf700 (LWP 11390)):#0 0x00007ffff7125303 in poll () from /lib/x86_64-linux-gnu/libc.so.6#1 0x00007fffe6e84b0c in ICEConnectionWorker () from /opt/lodev4.0/program/libvclplug_genlo.so#2 0x00007ffff7b9339d in osl_thread_start_Impl () from /opt/lodev4.0/program/../ure-link/lib/libuno_sal.so.3#3 0x00007ffff6e27e9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0#4 0x00007ffff7130cbd in clone () from /lib/x86_64-linux-gnu/libc.so.6#5 0x0000000000000000 in ?? ()Hilo 7 (Thread 0x7fffd2cad700 (LWP 11389)):#0 0x00007ffff7131a6d in accept () from /lib/x86_64-linux-gnu/libc.so.6#1 0x00007ffff7b8d392 in osl_acceptPipe () from /opt/lodev4.0/program/../ure-link/lib/libuno_sal.so.3#2 0x00007ffff794a291 in desktop::OfficeIPCThread::execute() () from /opt/lodev4.0/program/libsofficeapp.so#3 0x00007ffff5d01773 in salhelper::Thread::run() () from /opt/lodev4.0/program/../ure-link/lib/libuno_salhelpergcc3.so.3#4 0x00007ffff5d01aea in threadFunc () from /opt/lodev4.0/program/../ure-link/lib/libuno_salhelpergcc3.so.3#5 0x00007ffff7b9339d in osl_thread_start_Impl () from /opt/lodev4.0/program/../ure-link/lib/libuno_sal.so.3#6 0x00007ffff6e27e9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0#7 0x00007ffff7130cbd in clone () from /lib/x86_64-linux-gnu/libc.so.6#8 0x0000000000000000 in ?? ()Hilo 5 (Thread 0x7fffe15c8700 (LWP 11387)):#0 0x00007ffff6e2c0fe in pthread_cond_timedwait@@GLIBC_2.3.2 () from /lib/x86_64-linux-gnu/libpthread.so.0#1 0x00007fffe79a8925 in g_cond_wait_until () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#2 0x00007fffe79431c1 in ?? () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#3 0x00007fffe79437da in g_async_queue_timeout_pop () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#4 0x00007fffe798f164 in ?? () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#5 0x00007fffe798e9e5 in ?? () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#6 0x00007ffff6e27e9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0#7 0x00007ffff7130cbd in clone () from /lib/x86_64-linux-gnu/libc.so.6#8 0x0000000000000000 in ?? ()Hilo 4 (Thread 0x7fffe23fd700 (LWP 11386)):#0 0x00007ffff7125303 in poll () from /lib/x86_64-linux-gnu/libc.so.6#1 0x00007fffe796d036 in ?? () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#2 0x00007fffe796d49a in g_main_loop_run () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#3 0x00007fffe6264406 in ?? () from /usr/lib/x86_64-linux-gnu/libgio-2.0.so.0#4 0x00007fffe798e9e5 in ?? () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#5 0x00007ffff6e27e9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0#6 0x00007ffff7130cbd in clone () from /lib/x86_64-linux-gnu/libc.so.6#7 0x0000000000000000 in ?? ()Hilo 3 (Thread 0x7fffe3c6f700 (LWP 11385)):#0 0x00007ffff7125303 in poll () from /lib/x86_64-linux-gnu/libc.so.6#1 0x00007fffe796d036 in ?? () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#2 0x00007fffe796d49a in g_main_loop_run () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#3 0x00007fffe3c7498b in ?? () from /usr/lib/x86_64-linux-gnu/gio/modules/libdconfsettings.so#4 0x00007fffe798e9e5 in ?? () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#5 0x00007ffff6e27e9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0#6 0x00007ffff7130cbd in clone () from /lib/x86_64-linux-gnu/libc.so.6#7 0x0000000000000000 in ?? ()Hilo 2 (Thread 0x7fffeae21700 (LWP 11384)):#0 0x00007ffff6e2c0fe in pthread_cond_timedwait@@GLIBC_2.3.2 () from /lib/x86_64-linux-gnu/libpthread.so.0#1 0x00007ffff7b992f0 in rtl_cache_wsupdate_all(void*) () from /opt/lodev4.0/program/../ure-link/lib/libuno_sal.so.3#2 0x00007ffff6e27e9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0#3 0x00007ffff7130cbd in clone () from /lib/x86_64-linux-gnu/libc.so.6#4 0x0000000000000000 in ?? ()Hilo 1 (Thread 0x7ffff7ea4740 (LWP 11381)):#0 0x00007fffc864bcff in SdrObject::ApplyNotPersistAttr(SfxItemSet const&) () from /opt/lodev4.0/program/../program/libsvxcorelo.so#1 0x00007fffc879181a in SvxShape::ObtainSettingsFromPropertySet(SvxItemPropertySet const&) () from /opt/lodev4.0/program/../program/libsvxcorelo.so#2 0x00007fffc87919d7 in SvxShape::Create(SdrObject*, SvxDrawPage*) () from /opt/lodev4.0/program/../program/libsvxcorelo.so#3 0x00007fffc8755e96 in SvxDrawPage::add(com::sun::star::uno::Reference<com::sun::star::drawing::XShape> const&) () from /opt/lodev4.0/program/../program/libsvxcorelo.so#4 0x00007fffc9780690 in oox::drawingml::Shape::createAndInsert(oox::core::XmlFilterBase&, rtl::OUString const&, oox::drawingml::Theme const*, com::sun::star::uno::Reference<com::sun::star::drawing::XShapes> const&, com::sun::star::awt::Rectangle const*, unsigned char, unsigned char, basegfx::B2DHomMatrix&) () from /opt/lodev4.0/program/../program/libooxlo.so#5 0x00007fffc97835bf in oox::drawingml::Shape::addShape(oox::core::XmlFilterBase&, oox::drawingml::Theme const*, com::sun::star::uno::Reference<com::sun::star::drawing::XShapes> const&, basegfx::B2DHomMatrix&, com::sun::star::awt::Rectangle const*, std::map<rtl::OUString, boost::shared_ptr<oox::drawingml::Shape>, std::less<rtl::OUString>, std::allocator<std::pair<rtl::OUString const, boost::shared_ptr<oox::drawingml::Shape> > > >*) () from /opt/lodev4.0/program/../program/libooxlo.so#6 0x00007fffbceba951 in oox::xls::DrawingFragment::onEndElement() () from /opt/lodev4.0/program/../program/libscfiltlo.so#7 0x00007fffc9590c73 in oox::core::ContextHandler2Helper::implEndElement(int) () from /opt/lodev4.0/program/../program/libooxlo.so#8 0x00007fffbf1a5965 in sax_fastparser::FastSaxParser::callbackEndElement(char const*) () from /opt/lodev4.0/program/../program/fastsax.uno.so#9 0x00007fffbf1b65e1 in doContent () from /opt/lodev4.0/program/../program/fastsax.uno.so#10 0x00007fffbf1b7394 in contentProcessor () from /opt/lodev4.0/program/../program/fastsax.uno.so#11 0x00007fffbf1b7fdf in doProlog () from /opt/lodev4.0/program/../program/fastsax.uno.so#12 0x00007fffbf1b950b in prologProcessor () from /opt/lodev4.0/program/../program/fastsax.uno.so#13 0x00007fffbf1b2b6a in XML_ParseBuffer () from /opt/lodev4.0/program/../program/fastsax.uno.so#14 0x00007fffbf1a69c4 in sax_fastparser::FastSaxParser::parse() () from /opt/lodev4.0/program/../program/fastsax.uno.so#15 0x00007fffbf1aadd2 in sax_fastparser::FastSaxParser::parseStream(com::sun::star::xml::sax::InputSource const&) () from /opt/lodev4.0/program/../program/fastsax.uno.so#16 0x00007fffc95935ec in oox::core::FastParser::parseStream(com::sun::star::xml::sax::InputSource const&, bool) () from /opt/lodev4.0/program/../program/libooxlo.so#17 0x00007fffc9593722 in oox::core::FastParser::parseStream(com::sun::star::uno::Reference<com::sun::star::io::XInputStream> const&, rtl::OUString const&, bool) () from /opt/lodev4.0/program/../program/libooxlo.so#18 0x00007fffc95b231d in oox::core::XmlFilterBase::importFragment(rtl::Reference<oox::core::FragmentHandler> const&) () from /opt/lodev4.0/program/../program/libooxlo.so#19 0x00007fffbcf471d4 in oox::xls::WorkbookHelper::importOoxFragment(rtl::Reference<oox::core::FragmentHandler> const&) () from /opt/lodev4.0/program/../program/libscfiltlo.so#20 0x00007fffbcf5bc51 in oox::xls::WorksheetGlobals::finalizeDrawings() () from /opt/lodev4.0/program/../program/libscfiltlo.so#21 0x00007fffbcf5d789 in oox::xls::WorksheetGlobals::finalizeWorksheetImport() () from /opt/lodev4.0/program/../program/libscfiltlo.so#22 0x00007fffbf1aaf46 in sax_fastparser::FastSaxParser::parseStream(com::sun::star::xml::sax::InputSource const&) () from /opt/lodev4.0/program/../program/fastsax.uno.so#23 0x00007fffc95935ec in oox::core::FastParser::parseStream(com::sun::star::xml::sax::InputSource const&, bool) () from /opt/lodev4.0/program/../program/libooxlo.so#24 0x00007fffc9593722 in oox::core::FastParser::parseStream(com::sun::star::uno::Reference<com::sun::star::io::XInputStream> const&, rtl::OUString const&, bool) () from /opt/lodev4.0/program/../program/libooxlo.so#25 0x00007fffc95b231d in oox::core::XmlFilterBase::importFragment(rtl::Reference<oox::core::FragmentHandler> const&) () from /opt/lodev4.0/program/../program/libooxlo.so#26 0x00007fffbcf471d4 in oox::xls::WorkbookHelper::importOoxFragment(rtl::Reference<oox::core::FragmentHandler> const&) () from /opt/lodev4.0/program/../program/libscfiltlo.so#27 0x00007fffbcf45a48 in oox::xls::WorkbookFragment::finalizeImport() () from /opt/lodev4.0/program/../program/libscfiltlo.so#28 0x00007fffbf1aaf46 in sax_fastparser::FastSaxParser::parseStream(com::sun::star::xml::sax::InputSource const&) () from /opt/lodev4.0/program/../program/fastsax.uno.so#29 0x00007fffc95935ec in oox::core::FastParser::parseStream(com::sun::star::xml::sax::InputSource const&, bool) () from /opt/lodev4.0/program/../program/libooxlo.so#30 0x00007fffc9593722 in oox::core::FastParser::parseStream(com::sun::star::uno::Reference<com::sun::star::io::XInputStream> const&, rtl::OUString const&, bool) () from /opt/lodev4.0/program/../program/libooxlo.so#31 0x00007fffc95b231d in oox::core::XmlFilterBase::importFragment(rtl::Reference<oox::core::FragmentHandler> const&) () from /opt/lodev4.0/program/../program/libooxlo.so#32 0x00007fffbce961cb in oox::xls::ExcelFilter::importDocument() () from /opt/lodev4.0/program/../program/libscfiltlo.so#33 0x00007fffc959a71d in oox::core::FilterBase::filter(com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) () from /opt/lodev4.0/program/../program/libooxlo.so#34 0x00007fffbce966f0 in oox::xls::ExcelFilter::filter(com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) () from /opt/lodev4.0/program/../program/libscfiltlo.so#35 0x00007ffff5937dd9 in SfxObjectShell::ImportFrom(SfxMedium&, bool) () from /opt/lodev4.0/program/libsfxlo.so#36 0x00007ffff593b3b2 in SfxObjectShell::DoLoad(SfxMedium*) () from /opt/lodev4.0/program/libsfxlo.so#37 0x00007ffff598aea2 in SfxBaseModel::load(com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) () from /opt/lodev4.0/program/libsfxlo.so#38 0x00007ffff59d19f7 in SfxFrameLoader_Impl::load(com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&, com::sun::star::uno::Reference<com::sun::star::frame::XFrame> const&) () from /opt/lodev4.0/program/libsfxlo.so#39 0x00007fffd0dd083b in framework::LoadEnv::impl_loadContent() () from /opt/lodev4.0/program/../program/libfwklo.so#40 0x00007fffd0dd0dfa in framework::LoadEnv::startLoading() () from /opt/lodev4.0/program/../program/libfwklo.so#41 0x00007fffd0d4c621 in framework::LoadDispatcher::impl_dispatch(com::sun::star::util::URL const&, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&, com::sun::star::uno::Reference<com::sun::star::frame::XDispatchResultListener> const&) () from /opt/lodev4.0/program/../program/libfwklo.so#42 0x00007fffd0d4ccc8 in framework::LoadDispatcher::dispatchWithReturnValue(com::sun::star::util::URL const&, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) () from /opt/lodev4.0/program/../program/libfwklo.so#43 0x00007ffff6991ac0 in comphelper::SynchronousDispatch::dispatch(com::sun::star::uno::Reference<com::sun::star::uno::XInterface> const&, rtl::OUString const&, rtl::OUString const&, int, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) () from /opt/lodev4.0/program/libcomphelpgcc3.so#44 0x00007ffff793b125 in desktop::DispatchWatcher::executeDispatchRequests(std::vector<desktop::DispatchWatcher::DispatchRequest, std::allocator<desktop::DispatchWatcher::DispatchRequest> > const&, bool) () from /opt/lodev4.0/program/libsofficeapp.so#45 0x00007ffff794a03a in desktop::OfficeIPCThread::ExecuteCmdLineRequests(desktop::ProcessDocumentsRequest&) () from /opt/lodev4.0/program/libsofficeapp.so#46 0x00007ffff7921244 in desktop::Desktop::OpenClients() () from /opt/lodev4.0/program/libsofficeapp.so#47 0x00007ffff7922cf2 in desktop::Desktop::OpenClients_Impl(void*) () from /opt/lodev4.0/program/libsofficeapp.so#48 0x00007ffff3971f01 in ImplWindowFrameProc(Window*, SalFrame*, unsigned short, void const*) () from /opt/lodev4.0/program/libvcllo.so#49 0x00007ffff397a49e in SalGenericDisplay::DispatchInternalEvent() () from /opt/lodev4.0/program/libvcllo.so#50 0x00007fffe96459b7 in GtkData::userEventFn(void*) () from /opt/lodev4.0/program/libvclplug_gtklo.so#51 0x00007fffe9645a29 in call_userEventFn () from /opt/lodev4.0/program/libvclplug_gtklo.so#52 0x00007fffe796cd53 in g_main_context_dispatch () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#53 0x00007fffe796d0a0 in ?? () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#54 0x00007fffe796d164 in g_main_context_iteration () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#55 0x00007fffe9645b1d in GtkData::Yield(bool, bool) () from /opt/lodev4.0/program/libvclplug_gtklo.so#56 0x00007ffff3690721 in Application::Yield(bool) () from /opt/lodev4.0/program/libvcllo.so#57 0x00007ffff36907d7 in Application::Execute() () from /opt/lodev4.0/program/libvcllo.so#58 0x00007ffff791e16d in desktop::Desktop::Main() () from /opt/lodev4.0/program/libsofficeapp.so#59 0x00007ffff3695e31 in ImplSVMain() () from /opt/lodev4.0/program/libvcllo.so#60 0x00007ffff3695ef5 in SVMain() () from /opt/lodev4.0/program/libvcllo.so#61 0x00007ffff794c247 in soffice_main () from /opt/lodev4.0/program/libsofficeapp.so#62 0x00000000004007cb in main ()Una sesión de depuración está activa. Inferior 1 [process 11381] will be killed.¿Salir de cualquier modo? (y or n) [answered Y; input not from terminal] Comment onXlsx fileFix mimetypeOn pc Debian x86-64 with master sources updated today (commit 634ee953f1d090871834f6bc53faafaa7b96b874), I reproduced this.Precisely, the problem is "if (pUserCall)" I changed the sources a little to have 1 instruction per line: 2024 Rectangle aBoundRect0; 2025 if (pUserCall) 2026 { 2027 aBoundRect0=GetLastBoundRect(); 2028 }Program received signal SIGSEGV, Segmentation fault.0x00007f66cafc9ac6 in SdrObject::ApplyNotPersistAttr (this=0x0, rAttr=...) at /home/julien/compile-libreoffice/libo/svx/source/svdraw/svdobj.cxx:20252025 if (pUserCall)(gdb) bt#0 0x00007f66cafc9ac6 in SdrObject::ApplyNotPersistAttr (this=0x0, rAttr=...) at /home/julien/compile-libreoffice/libo/svx/source/svdraw/svdobj.cxx:2025#1 0x00007f66cb17116c in SvxShape::ObtainSettingsFromPropertySet (this=0x786d7d0, rPropSet=...) at /home/julien/compile-libreoffice/libo/svx/source/unodraw/unoshape.cxx:674#2 0x00007f66cb1704cf in SvxShape::Create (this=0x786d7d0, pNewObj=0x7874530) at /home/julien/compile-libreoffice/libo/svx/source/unodraw/unoshape.cxx:450*** This bug has been marked as a duplicate of***
id=58815	CreatedSave this file as pptHow to reproduce:Download attached document, or follow this steps:* Create new presentation* Delete header of first slide* Enter some text in the textbox (Click to add text)* Create an empty slide* Save this presentation as .ppt* Crash (if not, close window (click on the 'x') -> crash) Comment onSave this file as pptFix mimetypeOn pc Debian x86-64 with 3.6 sources updated yesterday I don't reproduce this.Joren: which LO version do you have?Oh, I'm sorry. Damn, I made a bad bug report :s. I'm sorry for that. My bad.Ok, here some additional info:I tried again to reproduce this bug using my attached file, but I can't reproduce it using that file.I still CAN reproducing following the 'how to reproduce' steps.Mac OS X 10.8.2LibreOffice 4.1.0.0.alpha0+ (Build ID: 699132c269a6c6d9e815fc582e2e6a106e46923)TinderBox:, Branch:master, Time: 2012-12-27_01:05:51I'll upload crash log.CreatedCrash log Mac OS X 10.8.2Reproducible also with 4.0.0.0.beta1+ (Build ID: f4a1520c58f8bbbaf5027222c071374afb55961)TinderBox:, Branch:libreoffice-4-0, Time: 2012-12-16_21:58:26CAN'T reproduce using Version 3.6.4.3 (Build ID: 2ef5aff)So -> REGRESSIONJoren: no problem :-) However I don't still reproduce this :-( Perhaps other will be "luckier" than me.Libo 4.0beta2, Debian GNU/Linux 64I can reproduce and even in a simple manner:- Impress 4.0beta2, File -> New -> Create button- go to the left panel, right click, "New slide"- File -> Close, when asked click "Close without saving"- Impress crashes!If you start it again, it asks for recovery.With 3.6.2 works fine.(In reply to)I can confirm that;Works fine with 3.6.4.3Crashes with LO 4.0 beta 1, beta 2 and 4.1 masterFollowing-> Priority 'Critical' and 'Highest'.Added to mab4.0git bisect log:git bisect start# skip: [65fd30f5cb4cdd37995a33420ed8273c0a29bf00] source-hash-d6cde02dbce8c28c6af836e2dc1120f8a6ef9932git bisect skip 65fd30f5cb4cdd37995a33420ed8273c0a29bf00# good: [65fd30f5cb4cdd37995a33420ed8273c0a29bf00] source-hash-d6cde02dbce8c28c6af836e2dc1120f8a6ef9932git bisect good 65fd30f5cb4cdd37995a33420ed8273c0a29bf00# bad: [5b4b36d87517a6ea96ff8c84c46b12f462fc9a1a] source-hash-8450a99c744e9005f19173e4df35d65640bcf5c4git bisect bad 5b4b36d87517a6ea96ff8c84c46b12f462fc9a1a# good: [16b0b88cbd4ef0f51816e97277e40c5cf78f7bf9] source-hash-099198a4224778fe6e43f5dc13b5b9b1b4dc828cgit bisect good 16b0b88cbd4ef0f51816e97277e40c5cf78f7bf9# good: [f28b8f9a6c47fa59bf98fffe937a2f2db7a2445a] source-hash-a581d31b227623e09d2970a91214fda398f98edagit bisect good f28b8f9a6c47fa59bf98fffe937a2f2db7a2445a# bad: [114fd3b76bcba890e6d702d00cef910f1493c262] source-hash-64ab96cd15e52da88781e720d6f031dbcd0ba902git bisect bad 114fd3b76bcba890e6d702d00cef910f1493c262# good: [6af64581913aa7ce3fcf0890fe671830d416a6ea] source-hash-06a8ca9339f02fccf6961c0de77c49673823b35fgit bisect good 6af64581913aa7ce3fcf0890fe671830d416a6ea# good: [7e20e241c1d8819d8d5edb7894baeddde33f9d3a] source-hash-2c270eeff422ef93100376ce0717a131d4f3cc2fgit bisect good 7e20e241c1d8819d8d5edb7894baeddde33f9d3a# good: [62b2ae5ee4cc77ad0b399c5a716ef526023d13ab] source-hash-e9960f36675a025c0536dec30ae56c50f4adecb1git bisect good 62b2ae5ee4cc77ad0b399c5a716ef526023d13ab# bad: [e7627bbadeb1ab2ff16757dd240d55c0023f8257] source-hash-5b195fbcf7a441aeb193f6abd08b877e580938e0git bisect bad e7627bbadeb1ab2ff16757dd240d55c0023f8257# good: [6f5853805cc557b8dd50ed2d76fc8ec917544575] source-hash-7c4d3ea6ba4d42b4dda5148a00c8c411b5d7703dgit bisect good 6f5853805cc557b8dd50ed2d76fc8ec917544575I've to add that crashes Drawing too!Reproduce: same as Impress.Open Drawing, on the left panel right click, New Page, close the document, click NO save, Drawing crashes(In reply to)I can reproduce that.LOdev_4.1 crashes when closing a new empty (ODG or ODP) document:WindowsXP 64-bit; LOdev_4.1.0.0.alpha0+ (ID: 6a393297ce6d99bbc4edefbf01ab9c5c6f0eff8; TinderBox: Win-x86@6, Branch:master, Time: 2013-01-04_01:06:01).1. Run Draw or Impress2. Close the new empty document (i.e., close the Draw or Impress)3. LOdev_4.1.0.0.alpha0+ suffers crash. But LOdev_4.0.0.0.beta2+ - OK. These are regressions compared to LOdev_4.0.0.0.beta2 (ID assembly: b060b43f093dce23222fd99375b1c6bd433703d; Tinderbox <>: Win-x86 @ 6, time 2013-01-03 13:16:15)ape: I put back former version, for more explanation, seeI have reproduced the steps from theon Linux as well. I used my own build from libreoffice-4-0 branch, pulled today morning.(In reply to)1. Switch Off left panel: View > Slide Panel (Impress) \ Page Pane (Draw)2. Agree with the restoration of "Untitled_1.odp \ odg".3. Starts smath.exe (Windows OS only) and closes its after.--Impress and Draw are working right. 'Add Slide(impress)\Page(Draw)' option works too across 'Insert > Slide'.The bug inreproduces for me too - but not the steps in.will take a look ...Createdstack trace.Createdmore debugging & valgrind log.I get some deja-vu with this; IIRC I've seen a duplicate of it in the past.It strongly looks like yet-another artifact of VCL's lack of reference-counting.(In reply to)I can't confirm it anymore with my own steps either (Description); But I can indeed still reproduce with.Wonderful; as expected it is basically VCL being unutterably horrible lifecycle wise:--- a/toolkit/source/awt/vclxdevice.cxx+++ b/toolkit/source/awt/vclxdevice.cxx@@ -53,6 +53,8 @@ VCLXDevice::~VCLXDevice() void VCLXDevice::DestroyOutputDevice() {+ fprintf (stderr, "Destroy output device %p: '%s'\n",+ mpOutputDevice, mpOutputDevice ? typeid(*mpOutputDevice).name() : "<null>"); delete mpOutputDevice; mpOutputDevice = NULL; }prints out:Destroy output device 0x8955ee0: 'N2sd6WindowE'Destroy output device 0x8956268: '9ScrollBar'Destroy output device 0x8956d30: '9ScrollBar'Destroy output device 0x8957060: '12ScrollBarBox'I get:#0 std::list<Link, std::allocator<Link> >::remove (this=0x50, __value=...) at /data/opt/libreoffice/libreoffice-4-0/vcl/source/app/vclevent.cxx:162#1 0xb67f9533 in VclEventListeners::removeListener (this=0x50, rListener=...) at /data/opt/libreoffice/libreoffice-4-0/vcl/source/app/vclevent.cxx:110#2 0xb6a04fed in Window::RemoveEventListener (this=0x8955ee0, rEventListener=...) at /data/opt/libreoffice/libreoffice-4-0/vcl/source/window/window.cxx:5310#3 0xacb17099 in sd::slidesorter::SlideSorter::ReleaseListeners (this=0x89584c8) at /data/opt/libreoffice/libreoffice-4-0/sd/source/ui/slidesorter/shell/SlideSorter.cxx:403#4 0xacb17649 in sd::slidesorter::SlideSorter::~SlideSorter (this=0x89584c8, __in_chrg=<optimized out>) at /data/opt/libreoffice/libreoffice-4-0/sd/source/ui/slidesorter/shell/SlideSorter.cxx:218#5 0xacb17862 in sd::slidesorter::SlideSorter::~SlideSorter (this=0x89584c8, __in_chrg=<optimized out>) at /data/opt/libreoffice/libreoffice-4-0/sd/source/ui/slidesorter/shell/SlideSorter.cxx:246The slide-sorter has this rather naive / optimistic boost::shared_ptr:typedef ::boost::shared_ptr<sd::Window> SharedSdWindow;...class SlideSorter : private ::boost::noncopyable{... SharedSdWindow mpContentWindow;Which is just hard deleted by a toolkit peer:==24244== Address 0xe2a2484 is 244 bytes inside a block of size 324 free'd==24244== at 0x4027F33: operator delete(void*) (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)==24244== by 0x4FC1085: VCLXDevice::DestroyOutputDevice() (vclxdevice.cxx:56)==24244== by 0x4FE34F1: VCLXWindow::dispose() (vclxwindow.cxx:957)==24244== by 0x509F5B6: UnoWrapper::WindowDestroyed(Window*) (unowrapper.cxx:263)==24244== by 0x56BE2B4: Window::~Window() (window.cxx:4333)==24244== by 0x56936B6: SystemWindow::~SystemWindow() (syswin.cxx:85)==24244== by 0x56C5C77: WorkWindow::~WorkWindow() (wrkwin.cxx:142)==24244== by 0x56C5CB1: WorkWindow::~WorkWindow() (wrkwin.cxx:150)==24244== by 0x12A6BD70: boost::detail::sp_counted_impl_p<WorkWindow>::dispose() (checked_delete.hpp:34)==24244== by 0x12991C0F: boost::detail::shared_count::~shared_count() (sp_counted_base_gcc_x86.hpp:145)==24244== by 0x12A69E5E: sd::framework::BasicViewFactory::~BasicViewFactory() (shared_ptr.hpp:168)==24244== by 0x12A69F1F: sd::framework::BasicViewFactory::~BasicViewFactory() (BasicViewFactory.cxx:145)Which is just silly.Quite why toolkit thinks it can go deleting windows like that - I have no idea. The ownership of those resources is extraordinarily unclear.Digging at the bibsect:git log 7c4d3ea6ba4d42b4dda5148a00c8c411b5d7703d..5b195fbcf7a441aeb193f6abd08b877e580938e0 -- sd/suggest that Thorsten's commit:commit aa1927dc257b52edf96de220cc3797e02c83a0aeAuthor: Thorsten Behrens <>Date: Wed Oct 10 10:57:35 2012 +0200 Make svg export use slidesorter selection in most cases. There was code previously that took the current selection, iff Impress main view was in slidesorter mode. Extended this quite helpful functionality to also work in other modes (as long as a slidesorter pane is displayed & has up-to-date selection, it should work). Change-Id: Ibbfe630a4ca31aa52978501745c2eef0d79fb8e391 0 sd/source/ui/framework/factories/ViewShellWrapper.cxx13 2 sd/source/ui/inc/framework/ViewShellWrapper.hxxIs almost certainly to blame for changing the ordering in subtle ways here:+ ::boost::shared_ptr< ::sd::slidesorter::SlideSorterViewShell > mpSlideSorterViewShell;...@@ -64,6 +75,8 @@ ViewShellWrapper::ViewShellWrapper ( const Reference<awt::XWindow>& rxWindow) : ViewShellWrapperInterfaceBase(MutexOwner::maMutex), mpViewShell(pViewShell),+ mpSlideSorterViewShell(+ ::boost::dynamic_pointer_cast< ::sd::slidesorter::SlideSorterViewShell >( pViewShell )), mxViewId(rxViewId), mxWindow(rxWindow) {in particular.***has been marked as a duplicate of this bug. ***So the solution to this is either/and: * add functionality to toolkit/ to tag that some UNO peers don't own the underly outputdevice / widget: seems like a useful feature anyway. The snag is that we need to work out who is creating the VCLXDevice for that widget. * add some null-able smart pointer that goes NULL when it gets destroyed for the sd::Window class (or even vcl::OutputDevice ?), such that we can detect and handle this case sanely.I'll try to poke at either/both of those in my spare cycles.*** This bug has been marked as a duplicate of******has been marked as a duplicate of this bug. ***
id=58275	CreatedInstall error messageIn preparation for the Test Marathon, I downloaded the LO 4.0 beta via bittorrent and tried to install it via "custom" instead of "typical" installation. The modification I did was to change the install drive from "c:\" to "d:\".LO installation failed.Attaching images of error found. CreatedInstall error message 2I'm hunting down someone to test this out, can you install on your C:/ successfully?I tried a "typical" install, without changing any settings, on the c:\ drive and still got the same error message"Error 1304.Error writing to file cli_basetypes.dll. Verify that you have access to that directory."I will now try to download the file directly (not using utorrent, and then install).You need to install .NET Framework (Client) 4.0.We are aware of this problem. We need to either make this requirement more obvious, or make it not be a requirement. The useless error message is Microsoft's fault, though.Thanks for the information, perhaps the installer could check for the .Net 4.0 framework as a pre-requisite. I will install framework, and try installing again.dhirenjani: Please tell us what Windows version you are using, and whether you had any .NET Framework installed before.I have Windows Vista Home Premium with SP2A few months back, I had removed .Net 4.0 and retained only .Net 3.5 SP1With only .Net 3.5 SP1, LO 4.0 beta did not install and I ran into the error message.After downloading and installing .Net 4.0 client framework, I was able to install LO 4.0 beta1, using custom install method.You can close this bug.Wow - what a sucky bug in Microsoft's infrastructure. Is there no way we can defeat it (for this fairly minor piece of .Net integration code that almost no-one uses ?).I wonder, could we detect the wrong SDK and simply turn off that .Net integration in the installer, or even default to turning it off in extremis for Beta2 ? ...Michael: Read the email thread, Andras has a good idea what to do, and it sounds as if it would do exactly what you say.dhirenjani: No, we don't want to close this bug as it *is* a bug that you can't install LO if you happen to have some, but not the latest, .NET installed...***has been marked as a duplicate of this bug. ***I place a quote here from a mail from Andras Timar:" for testers there is an easy workaround. Well, there are two.1. Install .NET 4.0.-- OR --2. Install LibreOffice from the command line:msiexec /i LibO-Dev_4.0.0.0.beta1_Win_x86_install_multi.msiREQUIRED_DOTNET_VERSION=4.0.0.0 "***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***This happened with LO 4.0 Beta 2, I have tried it on Windows 7 Ultimate, actually don´t know what version of .net it have.This is confirmed, marking as NEW, setting priority to HIGHESTDoes this commitmean that it is a feature, not a bug?I'm not kidding.Best regards. JBFah looks like it may be fixed, thanks for the link, once it's verified as fixed (RC is coming out next week) we'll mark as RESOLVEDJBF: As far as I know, if you don't have any .NET at all (as in a vanilla latest-SP XP), there is no problem in installing. The problem happens if you have *some* .NET but not 4.0. And I don't see what problem there is in requiring 4.0 then in that case, if the machine already has some .NET anyway. Doesn't Windows Update recommend installing .NET 4.0 anyway?Won't this fix fail when newer .NET will be released, i.e. 5.x will be installed and LibO will try to copy its 4.x version? Or do I not understand something?(In reply to)I am afraid my English is too bad to express correctly what I mean.;-)I understood the commit as: now .NET ≥ 4.0 is explicitly required. So now, it is not a bug if the installation fails until you installed all needed dependencies. No problem for me. I imagine that this change implies there is some message to the user which tell him to upgrade .NET before to complete the LO installation.Best regards. JBFRuslan, I don't understand what you mean with "copy its 4.x version"?LO does not "include" the .NET Framework. It just includes some (relatively unimportant and never used by most users) dlls that are managed (.NET) code. (To be used by extensions written in C#.)HelloI reproduce the bug (error 1304 cli_basetypes.dll)with Version 4.0.0.0.beta2 (Build ID: 4104d660979c57e1160b5135634f732918460a0)and Windows XP Pro Version 2002 SP3According to the windows control panel:-Microsoft .NET Framework 1.1-Microsoft .NET Framework 1.1 French Language Pack-Microsoft .NET Framework 2.0(In reply to)I successfully tested the second workaround.Thank you for thatRegardsPierre-YvesPierre-Yves: and what happened then when you passed that property setting on the command line? No warnings or other messages, no windows telling you that you need .NET 4.0? Then that property works is even better than I thought. (Now that I think about it, Andras probably described it just like that, but I had forgotten.)(In reply to)This... (no warnings or other messages).And that is what I meant by "successfully tested".Sorry for my lack of precision...The software starts without warning or error ... I do not know if such a message can occur during use, but I doubt it.RegardsPierre-YvesSo we require .NET 4.0 from now on. If user does not have .NET 4.0, then installer will silently continue and will not install cli ure stuff.(In reply to)What are the consequences in terms of functionalities when cli ure stuff is not installed? If there is consequences, we could mention them in the release notes.Best regards. JBFAs Tor mentioned in, it is for extensions written in C#. I don't know about such extension at all. The risk is near 0. On the other hand we are looking forward to getting bug reports related to this part of code, so we know if anybody out there is using it.Hello(In reply to)Confirmed with Version 4.0.0.1 (Build ID: 527dba6f6e0cfbbc71bd6e7b88a52699bb48799)same config asWindows XP Pro Version 2002 SP3According to the windows control panel:-Microsoft .NET Framework 1.1-Microsoft .NET Framework 1.1 French Language Pack-Microsoft .NET Framework 2.0Thank youPierre-YvesSee #59232. Still a problem on 4.0.0.4 (first official v4 release)(In reply to)make that 4.0.0.3 - keyboard (== me) error.Gordon:What are the symptoms of that ? do we truly fail to install unless .Net Framework 4.0(Client) is installed ? - if so that would be simply horrible.The correct behavior would be to silently disable the .Net pieces in this case. Is that what we are doing ? can you provide more data on the machine you tested this on and the outcome ?Yes. A complete failure to install.It just unwinds (and, if you had 3.6 there before, that is now gone and you are left with no LO at all).As I said - I has to install .Net 4.x (I did 4.5) to get an installation to complete.Andras - that sounds pretty hideous; how can we debug that / help out with it ? We got quite a significant jump in the proportion of Linux & Mac installs with the 4.0 release - it would be sad if people downloaded & then could not install en-masse.Gordon - can you reproduce this on a clean machine - and if so - what exact OS/Version etc. ?I'll test it tomorrow. I guess it happens on XP, because Windows 7 has .Net 4.0 by default. So I'll test the following scenarios:Clean Windows XP, no .Net, 3.6 -> 4.0 upgradeClean Windows XP, .Net 2.0, 3.6 -> 4.0 upgradeClean Windows XP, no .Net, 4.0 installClean Windows XP, .Net 2.0, 4.0 installAs noted in(which I did reference, even though I'd forgotten how to get an automatic link set-up) the problem occurred for me on a Win7, 64-bit system which only had .Net 2.0.This is a work-supplied laptop. So don't ask me why it only has .Net 2.0, but it does (or rather, it did).I've tried this on Windows XP virtual guest, and having removed LODev4 which was installed using workaround 2 from, I cleanly installed LO 4.0.0.3 without problems, i.e. not needing any workarounds. So, I've not been able to reproduce the problem with currently downloadable release.I could not reproduce. Neither on Windows XP 32-bit (with and without .Net 2.0), nor on Windows 7 64-bit (with built-in .Net 2.0).3.6.5.2 -> 4.0.0.3 upgrade worked, standalone 4.0 install worked. When .Net 2.0 was installed, then 3.6 installed .Net assemblies, as expected. During upgrade to 4.0 these were removed, as expected. 4.0 installer did not try to install them (DotNetCheck did not report a useable .Net version). I mark this RESOLVED FIXED again.So the fact that others are reporting it as a problem on Win7 64-bit (see) doesn't influence anyone.***has been marked as a duplicate of this bug. ***(In reply to)No, because the screenshot in there was made of 4.0.0.0beta2, before the fix.Ah...I didn't add a screenshot there as it didn't add any additional info.But I *did* update the version and platform to indicate the latest release which had shown the problem.It turns out I have another 64-bit Win7 desktop at work (not much used - only just occurred to me that it is there).I'll have another go on that one.And remember that this will be Windows Professional, not Windows Home (if it might make any difference).Just a reminder ,version field is the oldest version that shows the issue - it should NOT be updated to a newer release if a newer release shows the issue. We use comments to track what versions have been tested & when a bug is in NEW status it is known that it's still an issue so no need to change verisnThat was the theory. Except that one doesn't have any .Net on it at all.I can only assume the the first system has .Net2.0 on it as it was prepped to mirror my previous XP setup (which presumably had it).Looking at the .Net 2.0 download page indicates it might be a real problem to add, along with required updates.So I'll leave it as being the result of an oddly set-up system.Just an update on my failures with this in case anyone comes across this in the archive.Since having .net4.5 on my system broke other things (which use the latest .net, but can;t handle .net4.5) it was removed.I've just done an update to 4.0.2.2. This failed with the "Error 1304. Error writing to file cli_basetypes.dll" pop-up.However, this time round I was able to install using the Command Line method mentioned in.
id=59023	Createdbig calc-documentProblem description: Steps to reproduce:load the attached calc-file with version 4.0betamark the whole calc-sheettry to adjust the row height by clicking to the left borderorclick Format .. Row .. Optimal Heightnothing happensno problems with 3.6.4.3no problem with 4.beta and a new (!) created calc sheetthe problems appears only with older calc-documents1. ....2. ....3. ....Current behavior:Expected behavior: Operating System: Windows 7Version: 4.0.0.0.beta2 I confirm this bug occurring only with spreadsheets created with a previous version of Libo (3.6)Version 4.0.0.0.beta2 (Build ID: 4104d660979c57e1160b5135634f732918460a0) - VistaVersion 4.0.0.0.beta2+ (Build ID: 7bdf322a45505af8e23397bbeb08f7e21cb88c0) - W7changed to blocker, because spreadsheets created with prior versions cannot be worked with.duplicate of?It seems to be duplicate of the.*** This bug has been marked as a duplicate of***
id=58978	Tested with Mac OSX 10.8.2How to reproduce:* Open a random .odt file (by double clicking on the file in Finder, or open it with LibreOffice)Current behavior: General Error and the file opens correctly (as far I can see)Expected behavior: No general errorWhile saving a .odt file same behavior:How to reproduce:* Open Writer* Write something down (or nothing)* File > Save* Save file somewhere with a name as .odtCurrent behavior: Error saving the document <document name>: General Error.The file saves correctly as far I can see.Expected behavior: No general errorLibreOffice 4.1.0.0.alpha0+ (Build ID: 73731b01cd65defdf9b42a9754bede3ba84221d)TinderBox:, Branch:master, Time: 2013-01-02_08:47:51 CreatedError while opening a .odtCreatedError while saving a document as .odtCAN'T reproduce:4.1.0.0.alpha0+ (Build ID: bb51791ae49ecded0f618b4534893adb8fcf917)TinderBox:, Branch:master, Time: 2012-12-22_01:05:08CAN'T reproduce:4.1.0.0.alpha0+ (Build ID: 45a85b5af82d130bb3eea2b6a168f4ceaff9975)TinderBox:, Branch:master, Time: 2012-12-28_01:21:51CAN reproduce:4.1.0.0.alpha0+ (Build ID: 00234d0578419c3d0847dd89554186146121f60)TinderBox:, Branch:master, Time: 2013-01-01_08:03:47CAN'T reproduce:4.1.0.0.alpha0+ (Build ID: 27a66ce174d8c5c2947056cbf39533be55e1417)TinderBox:, Branch:master, Time: 2012-12-29_14:04:45CAN'T reproduce:4.1.0.0.alpha0+ (Build ID: c5132e30fb09477aa46d810dd86727b3aa8cf20)TinderBox:, Branch:master, Time: 2012-12-30_01:12:12Conclusion: bug is entered between December 30 01:12:12 and January 1 08:03:47I addto 'See Also' because this bug isn't 100% a duplicate of this bug. There they speak about 'MinGW'; I use build for Mac OS X and this bug is related to 4.1, not master old - 3.6works again in Version 4.0.01 (Build ID: 527dba6f6e0cfbbc71bd6e7b88a52699bb48799) TinderBox: MacOSX TDF Release, Branch:libreoffice-4-0, Time: 2013-01-09_10:49:53-> WORKSFORMEI mark this bug back as unconfirmed because the problem is there again ... (same instructions)Can't reproduce using 4.0.0.1 RC1; same OS (Mac OSX 10.8.2)I can confirm this. A simple .odt file gives this error, while saving and opening. But at last file saves and opens fine. Version 4.1.0.0.alpha0+ (Build ID: dc44862f0e711fe0cf93063f72ebe1dec598d92)TinderBox:, Branch:master, Time: 2013-01-19_22:49:36Could not reproduce with libreoffice-4-0~2013-01-21_18.50.48_LibO-Dev_4.0.0.1_MacOS_x86.dmg on 10.8.2.(But I *have* seen such an apparently bogus "General Error" dialog popping up in a self-built LO from current master, built with --enable-debug and using latest Xcode Clang, against SDK 10.7.)So, it seems this bug rather affects the master builds but not the 4.0 branch.I have the same problem in Ubuntu 12.10 withVersion 4.1.0.0.alpha0+ (Build ID: a1808e0d38dd36d590a5bae26a02c49252d6162) when I try to open or save a in odt.I can open and save any document in .doc or .docx, when i try to save in .odt libreoffice crash.In the console I get this message:raptor_sequence.c:419: (raptor_sequence_get_at) assertion failed: object pointer of type raptor_sequence is NULL.raptor_sequence.c:419: (raptor_sequence_get_at) assertion failed: object pointer of type raptor_sequence is NULL.good luck.AFerreiraThis bug seems to be reproducible only in the 4.1.0.0.alpha0+ builds => let's move it from 4.0 to 4.1 MABs.Alberto: could you try to retrieve a bt, even without symbols, by following this link:?Hm, can it be that correct Operation System selection is missing? I only see Mac in the comments."- MinGW: FILESAVE Writer document shows "General Error" also shows the same symptoms, Error message, but opens documents correctly; what ever that might mean (and that one might be DUP of*** This bug has been marked as a duplicate of***I'm sorry, I need to do it the other way around. Sorry for the spam***has been marked as a duplicate of this bug. ***Could not reproduce with my own build of Version 4.1.0.0.alpha0+ (Build ID: 74e40fbbbdb0b09f6529a26984f942a3d4b788b) under Ubuntu 12.04 x86-64Best regards. JBFI did not reproduce this behavior anymore past few weeks... So I think this is fixed somehow (Linux Mint 14 x64 as well as Mac OSX 10.8.3). Therefore I mark this as RESOLVED WORKSFORME.Thanks <don't know who> for fixing it!Kind regards,JorenPS: if someone is still dealing with this issue/if this issue returns, please mark this bug as REOPEN.I have to reopen this bug :(.I can reproduce it again (with my own build) on my Mac OSX 10.8.3. LibreOffice Version: 4.1.0.0.alpha0+ Build ID: afb3af7ce5fef803d42a549095863e6bb8210efI ran a gdb debug on it (without breakpoints, so I can see the console output/log). I saw this warning passing by when opening a random odt file:warn:legacy.osl:3691:1:tools/source/ref/errinf.cxx:334: Error nicht behandeltand then some other warnings:warn:sfx2.control:3691:1:sfx2/source/control/dispatch.cxx:1476: Childwindow slot missing: 10367Reading symbols for shared libraries . donewarn:sfx2.control:3691:1:sfx2/source/control/dispatch.cxx:1476: Childwindow slot missing: 10367warn:sfx2.control:3691:1:sfx2/source/control/dispatch.cxx:1476: Childwindow slot missing: 10367I'll attach the full gdb log (I only opened a file from the start center).Createdgeneral error gdb logIs this a mac only bug, and a failure to find/load the upgraded libraptor on that platform ?(In reply to)says:So this is a bug in how LO's librdf-lo.0.dylib is built and references libraptor2-lo.0.dylib with a bad path (that hasn't been resolved via solenv/bin/macosx-change-install-names.pl as it should have been). This might have been an intermittent bug in the build system that has been fixed by now.Stephan Bergmann committed a patch related to this issue.It has been pushed to "master":fdo#58978 TypoThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.I can not reproduce this anymore using Mac OSX 10.8.3 with LibreOffice Version: 4.1.0.0.alpha1+ Build ID: 43c234b0481fe63b8c4823affad066c6362f506 , so looks fixed indeed.I build that version my own, with parameters: --enable-debug--enable-dbgutil--without-javaKind regards,Joren
id=59128	CreatedODT file with formulas as an exampleWinWord-2007 can't open DOCX file with formulas if the file was created LOdev-4.0.0:1. Open ODT file with formulas (attachment).2. Save this file as a Microsoft Word 2007/2010XML or Office OpenXML Text.3. Try to open this DOCX file using Microsoft Word 2007.Pop-up window reports the result:“Cannot open the file because of errors in its content.Details:invalid character in its name.Location: part:/word/footer1.xml, line: 2, column: 440” (In reply to)This is a fragment of:<w:1D><w:top w:val="none"/><w:left w:val="none"/><w:bottom w:val="none"/><w:insideH w:val="none"/><w:right w:val="none"/><w:insideV w:val="none"/></w:1D>in between<w:pStyle w:val="style40"/> and <w:pPr></w:pPr></w:p></w:ftr>It's absent in LibreOffice_3.6.4.3Petr! I added you to "CC," because the bug is in LOdev_4.0.0.1+ (ID: b0e35a54631d0e514860ae53cd7b408bb3d2e14). It seems to me that the regression associated with the export filter's violation in the ISO (OOXML) file's description must be resolved before LibreOffice_4.0.0.final will be published.--apeCreatedThe file without the piece(In reply to)--I removed this piece from the file "2_formulas \ word \ footer1.xml", using a text editor. Now Microsoft Word 2007 opens a new file "correction_2_formulas.docx".CreatedPerhaps that fixing other bugs (see the picture in an attachment) caused regressionI can confirm that this also occurs in 4.0.0.1 (aka 4.0.0 RC1)It is indeed a regression. The file is exported correctly under 3.6.4.3(In reply to)Export problem occurs if the Cyrillic characters used in a variable name.WinWord-2007 will recognize Cyrillic characters in the formula only as text, not as a variable name.Bug is absent in LibO-Dev_4.0.0.1_Win_x86 (Time: 2013-01-19_01.04.55; ID: baa9a119dabfc5e5dbb5c174cebf8c24298bad6), so I changed the status.
id=61726	Createdreproduction example+++ This bug was initially created as a clone of+++Problem description:All ReportBuilder report executions fail with a Java exception "IncompatibleClassChangeError":com.sun.star.report.pentaho.SOReportJobFactory$_SOReportJobFactory executeSEVERE: Detected an IncompatibleClassChangeErrorTo test / work on this, please make sure: 1) Use a version whereis fixed 2) Work aroungby commenting out the assertionReproduction instructions: - Open attachment minimalReportBuilder.odb - In the left pane, click "Reports" - In the lower right pane, double-click "Contacts" (or right-click for menu and choose "open")See also, it contains logs, typescripts, backtraces, etc.Reported also after a "make clean && make", which puzzles me since Google tells me this error happens when a class has been changed incompatibly and code using it has not been recompiled. A clean/remake should thus make this error disappear, but it does not. Lionel - as this is your report, marking as NEW.I would argue that this qualifies for a blocker - marking as such. Lionel - of course if you disagree change it again :-DReproducible with:Win7x64 UltimateVersion 4.1.0.0.alpha0+ (Build ID: 8e658ca263808d3466c62b2acfc82d61901fa57)TinderBox: Win-x86@6, Branch:master, Time: 2013-02-08_22:04:23Java 1.7.0_15I thing something is wrong in the file, several options are greyed out, e.g. the wizards. As if the database was in a write protect status.4.1.0.0 With a new file from scratch, I can reproduce the bug with double click but not with right-click/edit.4.0.1.2 With a new file from scratch, I can reproduce but not the same bug, with double click opens a writer document but works fine with right-click/edit.Opening the file in one of the versions, closed the file without closed the program, and open the file in the other version show the same symptoms than the attached file.see detailed explanation of the problem and the solution here:David Ostrovsky committed a patch related to this issue.It has been pushed to "master":fdo#61726 java class collision with new idlThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.David Ostrovsky committed a patch related to this issue.It has been pushed to "master":fdo#61726: rename report-builder package to org.libreoffice.reportThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.<_rene_> _david_: for the minimizer, please add it to the impress gid (gid_Module_Prg_Impress_Bin). (like gid_File_Lib_PresenterScreen)<_rene_> _david_: that will make it automatically end up in impress ;)<_david_> _rene_, will do!
id=63627	Problem description:When Quick Starter is executed, after some time (less than a minute) the Win Task Manager reports that the system program has 99% disk access, at speeds more than 3.0 MB/s.This slows down all apps, including LibreOffice (LO). For instance cut and paste between LO and Notepad might take minutes.Also, as Writer, Calc and other modules stop responding, I abort them often. Accessing Win explorer (explorer.exe) is taking very long, an dis unusable, until aborted.Steps to reproduce:1. Launch quickstart.exe2. After some time, task manager report excessive disk access.3. Abort quickstart.exe4. After some time, task manager reports low disk access. This step takes longer than step 2.Current behavior:Unacceptable. This is a brand new HP Pavilion G7 laptop with Win 8 Pro, 64 bit, 8GB RAM, secure boot, GPT and and UEFI. And I cannot use it for serious work. Too unreliable. I still create and maintain all my professional documents on my 7 year old Compal laptop with Win XP and LO 3.xExpected behavior:A stable document processing platform.I will be more than happy if I can help finding this strange bug. Operating System: Windows 8Version: 4.0.2.2 release Some extra info:This program creates the excessive disk I/Ontoskrnl.exe - NT Kernel & SystemThe result (Sysinternals Process Explorer) is a very long list of temporary page file usage, called:<Pagefile Backed><Pagefile Backed><Pagefile Backed>... (Goes on seemingly endlessly)Some more info. The Mozilla products Firefox and Thunderbird (TB) suffer from the same thing: Firefox a little, and only when flash-like software is fired through the container functionality. TB suffers more, but by far not as much as LibreOffice.The short term solution for Mozilla products is to clear all history. After that they behave themselves for some time.The problem appears to be fixed in v4.0.3.3 (current stable version).Test System: Windows 8 Home Premium 64-bit, HP Envy H8-1445, 12Gb RAM, GPT, UEFI, Secure Boot.Step #1 was tested twice from a cold start, first by launching quickstart.exe manually at the command prompt, and also by enabling it via the Libreoffice Options menu.Each instance was left running for over 15 minutes while opening/closing a few sample documents with no growing increase in Disk% (observed with the Task Manager). No warning messages were generated.The comments on ntoskernel.exe, Firefox, and Thunderbird are interesting but I cannot link them to the Libreoffice Quickstarter at this point.If you are still having the same excessive disk access with v4.03, please set bug Status back to UNCONFIRMED and let's proceed with more details. Thanks for reporting.Shortly after reporting this bug I switched to the PortableApps version of LibreOffice (v4.0.3.3 3.3). Now I can reasonably work with LibreOffice. I can confirm that in this version QuickStart behaves normal.However, also in this version you cannot leave an edited file open, p.e. in Writer, hibernate, and continue editing. LibreOffcie will crash, and start a recovery, even if the document was completely saved, and there is nothing to recover.Should I report this as a new bug?Kind regards, and thanks for helping out,Hans LodderPS: Since then I also became aware that explorer.exe is not to be trusted: it hangs often if opened more than a couple minutes. This might be related, as also my issues with other 32-bits applications (FF, TB, etc).I checked all Windows logging files, and currently Windows reports no issues, errors or otherwise. I checked with several malware detection applications, and they reported nothing. I updated all my HP drivers, and checked with SlimDrivers if there are any other outdated drivers. There are none.I just noticed that selecting and copying information to the clipboard in Notepad++ does not become visible and available in LibreOffice Writer.Follow these steps to be able to paste information from the clipboard:1. Save document2. close document3. Close QuickStarter4. Restart QuickStarter5. Open document in Writer6. Paste informationFortunately I do not have to repeat these actions often...(In reply to)Great! Here I'll change this bug Status back to Resolved/Works. Thanks for reporting back, and sorry it took a couple of days (I forgot to add me to cc:).Yes, detailed reports are always welcome. Thanks :-)explorer.exe is not to be trusted :). I'm sorry I can't comment more on your Windows driver issues. I have a newish HP 8-core with Windows8, as well as my older HP/Win7 systems. Definitely feel your pain. BUT, if it's a Libreoffice-related report I'll help recreate the problem and test the fixes as they arrive.That's fun \o/!Thanks again for contributing,Liz(In reply to)This is a different bug.I'm not clear to recreate the problem in the steps you listed. If you have time, can you be more specific in what you expect Libreoffice to do here? In your shiny new report :-)Thank you,Liz
id=63652	As a pastor I publish weekly church bulletins and monthly newsletters the design of which depends on several tab stops. Problem/Frustration... I create a document, save it, close it and when I open it again, the tabs have migrated. Sometimes to the left, sometimes to the right, sometimes off into the margins, sometimes... you get the picture. That means that either I or my staff then must re-format the document and print masters for photocopying without closing and re-opening the document. Exchanging files between libreoffice on my mac with libreoffice on the church's pc only compounds the problem. AAAaaarrrrgggHHHHHHHHH!Is this a common/known problem? Is there a fix I can do? Is there a fix in the works?Rev. Jeremy McLeod Which format are you saving in? .odt, .doc or .docx?Which version of LibreOffice are you using? (Help > About)And a sample file - that would be great.The problem most likely is that you have different fonts on the different systems. Each font has different metrics, so the text has different size and it matches different default tab positions.It might help if you define exact tab positions in "Format/Paragraph/Tabs". Another solution would be to use Tables or Frames.The best solution depends on what you want to achieve. In each case, you should not do formatting using spaces or normal tabs. This is not portable and it always causes these problems.The proper solution is to do the formatting the right way. I am sure that the above hints will help. If not, I would suggest to ask on thewhere you could get more precise hints how to achieve the wanted formatting.I close this bug for now. Feel free to reopen it, it the above hints do not help or if nobody suggest a working solution at.
id=63683	Createddictionary packageHi!After upgrading of LO i found that previously functioning dic for Latgalian language stopped working.Installation of dictionary gives the following error messages:###### Progress log entry 2013-04-18 14:31:54 ######ERROR: (com.sun.star.lang.IllegalArgumentException) { { { Message = "There is no such extension deployed: Latgal\X012b\X0161u vol\X016bdys pareizraksteibys vuordineica nu dict.dv.lv", Context = (com.sun.star.uno.XInterface) @cd18eec } }, ArgumentPosition = (short) -1 }ERROR: (com.sun.star.lang.IllegalArgumentException) { { { Message = "There is no such extension deployed: Latgal\X012b\X0161u vol\X016bdys pareizraksteibys vuordineica nu dict.dv.lv", Context = (com.sun.star.uno.XInterface) @cd18eec } }, ArgumentPosition = (short) -1 }Copying: ltg_LV-0.1.3.oxtSimilar error messages produces any additional language dic installed using Extension manager. Unfortunately, only ltg_LV is not working - all words are underlined and no suggestion is available. Just to note - the same 0.1.2 is working OK with Mozilla products.Officially released dic can be found here:Attached please find not yet released version of ltg_LV dic in which I corrected dictionaries.xcu file, which in case of 0.1.2 generates an additional error message.I tested it with 4.0.3.1 release candidate and 3.6.6. with the same result.Janis First line of the ltg_LV.dic must be the number of items (lines) in the dictionary. In your case it is 8097. With this change the extension works as expected. This is not a bug in LibreOffice, but in ltg_LV-0.1.3.oxt.Indeed.I was so confused with all this that forgot to check word count in unreleased dic.In 0.1.2 it exists.
id=63767	For testing I used this file:I tried with some other bug documents, from time to tome a crah, but most reproducable with this file.....1) Try to open with master2) crash (after a second) Also crashes with Version: 4.1.0.0.alpha0+Build ID: fa72fc3eddbfabb82193452a4ba993b11d1584dTinderBox: Win-x86@6, Branch:master, Time: 2013-04-18_23:11:53Okay far better way to crash: Open Writer and press any button you want :)If recovery has recovered the document one single character lets LibreOffice crashis also a crasher on Ubuntu ( after 10 seconds marking and unmarking text) --> This document contains makros (not activated) --> Confirmed 2 independent systems Linux: Self-built Version: 4.1.0.0.alpha0+Build ID: 75c87c417b6fbb82d956a803f065c9c49d0d62fLinux master does not crash when holding down a key...CRASH on Windows (not on Linux)Valid with Version: 4.1.0.0.alpha0+Build ID: 6536d0eb4f56e64c9b74b358642e3ee1e39353eTinderBox: Win-x86@6, Branch:master, Time: 2013-04-23_04:48:50---With Version: 4.1.0.0.alpha0+Build ID: c8da8f48415c058c70698a7b4a6716bd41cfeeb @ Ubuntu 13.04Crash with 2011.10.20.doc WORKING with OpenOfficew 3.2.0, crash with LibreOffice 3.3.4 OOO330m19 (Build:401)In Windows, the master build crashes with every document trying to dereference NULL pointer:sal3.dll!rtl_uString_assign()???? swlo.dll!SwTable::SetTabCols()swlo.dll!cppu::WeakImplHelper2<com::sun::star::linguistic2::XLinguServiceEventListener,com::sun::star::frame::XTerminateListener>::getImplementationId()swlo.dll!SwTxtNode::GetMinMaxSize()swlo.dll!SwTxtNode::GetMinMaxSize()swlo.dll!SwTxtNode::GetMinMaxSize()swlo.dll!SwTable::SetTabCols() swlo.dll!SwTxtNode::IsAutoCompleteWordDirty()swlo.dll!SwTxtNode::TransliterateText()swlo.dll!SwPosFlyFrm::~SwPosFlyFrm()swlo.dll!SwPosFlyFrm::~SwPosFlyFrm()swlo.dll!SwPosFlyFrm::~SwPosFlyFrm()swlo.dll!ViewShell::LayoutIdle()....@urmus,(In reply to)Would you add additional comment toThanks!Closing as resolved duplicate ofwhich has been resolved fixed byMiklos Vajna committed a patch related to this issue.It has been pushed to "master":fdo#63680 SwTxtCursor::GetCrsrOfst: don't pass reference to a temporary@Urmas, would be great if you also can confirm on your build of master.*** This bug has been marked as a duplicate of***Sorry, should have included profs to the patch author Arnaud V.
id=65501	CreatedSample document (just one word)HelloPlatform: Windows 7 64bitVersion: 4.1.0.0.beta2Build ID: 33224f4f11a05cfad2249e812fcc2975fbb61f6I can not select the version in the list because it does not offer when I write.Steps to Reproduce:1. Check Tools> Options> Load / Save> General> Always create backup copy2. File> Open> Sample attached document3. Edit Document (type a space, for example)4. File> SaveError Message:error saving the document <nomDoc>Error creating objectCould not create backup copyRegardsPierre-Yves Hello Pierre-Yves,I reproduce this behaviour with master LO 4.2.0.0.alpha0+Build ID: 3e6853ae3e093b919ff3732e8fac05cb0a0fba5on Windows 7 Home PremiumJacques GuilleronBug confirmed under Win XP x86.This is a REGRESSION from 4.0.3.3Pierre-Yves,I apologize for suggesting the obvious, but I wonder ... Where do you save backup copies? ( Tools > Options > LibreOffice >Paths and find Type = Backups in the right pane )Do you have permission to write there?Terry.Hello(In reply to)It costs nothing to check :)Yes I have write permissions, and as you can see, the bug was also reproduced on different systems.RegardsPierre-Yvesis the default backup directory actually missing, that's what I seem to see here locallyYes. There's no backup directory in C:\Users\me\AppData\Roaming\LibreOfficeDev\4\user\backupActual directory for backup is the same as document.Jacques GuilleronSeems to be the missing backup dir. strangely enough if I blow away by config dir and try in the oldest 3.5 I've got, it also doesn't create a backup dir and I get the same message with that option toggled on, so I'm not entirely sure when its a regression from that the backup dir itself didn't get created. I mean, if you happen to have the dir it works.Caolan McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: fdo#65501 ensure configured backup dir exists before using itThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.***has been marked as a duplicate of this bug. ***Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-1":Resolves: fdo#65501 ensure configured backup dir exists before using itIt will be available in LibreOffice 4.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-0":Resolves: fdo#65501 ensure configured backup dir exists before using itIt will be available in LibreOffice 4.0.5.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.*should* be fixed now if I was reproducing the same problem as originally reportedHi Caolan,Verified. I have .bak in Backup directory. Works with LO 4.2.0.0.alpha0+Build ID: ce0383d2950d3b0da2c457c8a406c1229de53571 & Windows 7 Home PremiumThank you very much,Jacques Guilleron
id=65022	Steps to Reproduce: 1. Open writer2. Format -> ParagraphObserved: Crash no error Expected: No crash Happens with any component, cc'ing some of the expertsJust kind of randomly picked who to CC on this one so apologies if you're not involved and shouldn't be cc'ed. Want to make sure that this gets attention ASAPHave not tested on Linux yetI couldn't confirm it on Kubuntu 12.04. No crash happens.linux is fine, so Windows onlyjust tested at master@28f2af669f01cd304994f1907de0b61245b3d37a on Linux, not reproducable here.Hi Joel, I imagine it's a duplicate of one of these UNO / migration problems: throwing some exception from somewhere.Does it persist if you move your profile away ? :-)Almost certainly its a wrong library name in a .ui file. I rather suspect it was fixed byDoes the problem persist in a recent daily ?(In reply to)Looks like this was it, I didn't check the daily, but applied the changes to my beta1 install manually and it stopped crashing.I can not reproduce a crash anymore using Windows 7 x64 with libreoffice-4-1~2013-05-27_07.07.10_LibreOfficeDev_4.1.0.0.alpha1_Win_x86_ which I download here:So, resolved fixed.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Hello all, I am not sure of fdo#65058 is fixed in the patch, I think it is but I have not al lot of coding knowledge or a windows machine to test, if it is fixed with the patch can some one please set it to a duplicate. thank you in advance, Thomas van der Meulen.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***I just reproduced this crash again....setting to REOPENLibreOffice 4.2 built just yesterdaySetting to ALL (reproduced in Linux) - also setting to NEW as it's not assigned so reopened is incorrect - sorry for the noisejust tested on Win7 64bit1. Open writer2. Format -> Paragraphno crash in 4.1.1.2no crash in 4.2.0.0.alpha0+Build ID: 1ea33a8cfc5bc51d0cf83989702b8be82cf52c49TinderBox: Win-x86@39, Branch:master, Time: 2013-09-10_06:19:34Joel, if you can reproduce this (which I can't) can you get a backtrace from gdb of the crash, and state the git hash of the top of your tree (git show)My mistake - I think it was due to a partial build that had failed. Just finished building and tested again with no problem. Thanks all***has been marked as a duplicate of this bug. ***
id=65951	Problem description:After installing Java 7 Update 25, any attempt to open a report in Base causes LibreOffice to crash.Steps to reproduce:1. Open any previously written report in a Base document. Operating System: Mac OS XVersion: 4.0.4.2 rcLast worked in: 4.0.3.3 release Same problem exists for the release version 4.0.4 and 4.1.0.0.beta2 both with Java 7 Update 21.The bug seems not to be platform dependent as this behavior is the same in Windows 7 and Ubuntu 13.04.Version 4.0.3.3 works on both operating systems without any problem.Confirmed that the problem is not restricted to only LibreOffice 4.0.4.2 and Java 7 Update 25. The same problem is occurring on my other Mac, which has the following profile:Operating System: Mac OS X 10.6.8Version: 4.0.4.2 (release)Java Runtime Environment: 1.6.0_51-b11-456-10M4508I don't have any database files, but since according to, problem is reproducible, therefore setting status to "NEW".Back-revving LibreOffice to 4.0.3.3 on my machine with Mac OS 10.8.4 and Java 7 Update 25 does not cause LibreOffice to crash upon opening a report. This seems to imply that Java 7 is not the culprit, but rather is a bug that has been introduced in the LO 4.0.4. The title of this bug report has been changed accordingly.It is definitely tied to the report-builder. When I remove the report-builder the system reverts to the old inbuilt report builder. Obviously you cannot run reports built with the (Oracle) report-builder but setting up a report with the old inbuilt report builder works fine with no crashing issues.This should be a blocker.Also, I seem to recall that this has been reported for Linux 64bit too, but will have to find the dup report.AlexAdding Lionel, Julien to CCI don't get a crash on master build with OSX 10.8.4, however the app does hang.Testing the options in the Report section of an ODB file gives :- double-clicking on an existing report : error message that javaloader has no mapping from java to C++- Use Wizard to Create Form : nothing happens- Create Form in Design View : app hangs, requiring force killWhen killed, this is the trace I see :Process: soffice [15184]Path: /Applications/LibreOfficeDev.app/Contents/MacOS/sofficeIdentifier: sofficeVersion: 4.2.0.0.alpha0 (???)Code Type: X86 (Native)Parent Process: launchd [1043]User ID: 501Date/Time: 2013-06-20 18:31:33.111 +0200OS Version: Mac OS X 10.8.4 (12E55)Report Version: 10Interval Since Last Report: 461131 secCrashes Since Last Report: 102Per-App Crashes Since Last Report: 1Anonymous UUID: 9F5C4B75-E194-D972-37AE-22D09B94D397Crashed Thread: 0 Dispatch queue: com.apple.main-threadException Type: EXC_BAD_ACCESS (SIGBUS)Exception Codes: KERN_PROTECTION_FAILURE at 0x0000000000000004VM Regions Near 0x4:--> __PAGEZERO 0000000000000000-0000000000001000 [ 4K] ---/--- SM=NUL /Applications/LibreOfficeDev.app/Contents/MacOS/soffice __TEXT 0000000000001000-0000000000002000 [ 4K] r-x/rwx SM=COW /Applications/LibreOfficeDev.app/Contents/MacOS/sofficeThread 0 Crashed:: Dispatch queue: com.apple.main-thread0 libuno_sal.dylib.3 0x0002c48d rtl_uString_new_WithLength + 451 libuno_sal.dylib.3 0x00029649 rtl_uStringbuffer_ensureCapacity + 572 libuno_sal.dylib.3 0x0002974d rtl_uStringbuffer_insert_ascii + 1733 libpcrlo.dylib 0x2308a8db pcr::OBrowserLine::FullFillTitleString() + 1874 libpcrlo.dylib 0x2308ce7f pcr::OBrowserListBox::PositionLine(unsigned short) + 1915 libpcrlo.dylib 0x2308cf91 pcr::OBrowserListBox::UpdatePosNSize() + 816 libpcrlo.dylib 0x2308f8d5 pcr::OBrowserListBox::InsertEntry(pcr::OLineDescriptor const&, unsigned short) + 5977 libpcrlo.dylib 0x231421ce pcr::OPropertyEditor::InsertEntry(pcr::OLineDescriptor const&, unsigned short, unsigned short) + 788 libpcrlo.dylib 0x2312ffbe pcr::OPropertyBrowserController::UpdateUI() + 4629 libpcrlo.dylib 0x23130e9f pcr::OPropertyBrowserController::impl_rebindToInspectee_nothrow(std::vector<com::sun::star::uno::Reference<com::sun::star::uno::XInterface>, std::allocator<com::sun::star::uno::Reference<com::sun::star::uno::XInterface> > > const&) + 6310 libpcrlo.dylib 0x23130fdd pcr::OPropertyBrowserController::inspect(com::sun::star::uno::Sequence<com::sun::star::uno::Reference<com::sun::star::uno::XInterface> > const&) + 26911 librptuilo.dylib 0x22cd4061 rptui::PropBrw::implSetNewObject(com::sun::star::uno::Sequence<com::sun::star::uno::Reference<com::sun::star::uno::XInterface> > const&) + 19312 librptuilo.dylib 0x22cd4364 rptui::PropBrw::Update(com::sun::star::uno::Reference<com::sun::star::uno::XInterface> const&) + 50013 librptuilo.dylib 0x22ccbdb3 rptui::ODesignView::MarkTimeout(void*) + 27514 libvcllo.dylib 0x01abb5cc Timer::Timeout() + 2815 libvcllo.dylib 0x01abba05 Timer::ImplTimerCallbackProc() + 13316 libvcllo.dylib 0x01e3fee1 -[TimerCallbackCaller timerElapsed:] + 8117 com.apple.Foundation 0x947239b4 __NSFireTimer + 11718 com.apple.CoreFoundation 0x939c7406 __CFRUNLOOP_IS_CALLING_OUT_TO_A_TIMER_CALLBACK_FUNCTION__ + 2219 com.apple.CoreFoundation 0x939c6da5 __CFRunLoopDoTimer + 70920 com.apple.CoreFoundation 0x939abbb2 __CFRunLoopRun + 184221 com.apple.CoreFoundation 0x939ab01a CFRunLoopRunSpecific + 37822 com.apple.CoreFoundation 0x939aae8b CFRunLoopRunInMode + 12323 com.apple.HIToolbox 0x9253ef5a RunCurrentEventLoopInMode + 24224 com.apple.HIToolbox 0x9253ebf5 ReceiveNextEventCommon + 16225 com.apple.HIToolbox 0x9253eb44 BlockUntilNextEventMatchingListInMode + 8826 com.apple.AppKit 0x96ca593a _DPSNextEvent + 72427 com.apple.AppKit 0x96ca516c -[NSApplication nextEventMatchingMask:untilDate:inMode:dequeue:] + 11928 libvcllo.dylib 0x01e04c47 AquaSalInstance::Yield(bool, bool) + 48729 libvcllo.dylib 0x01ab3c74 Application::Yield(bool) + 8430 libvcllo.dylib 0x01ab3d2c Application::Execute() + 6031 libsofficeapp.dylib 0x000a256c desktop::Desktop::Main() + 759632 libvcllo.dylib 0x01aba312 ImplSVMain() + 22633 libvcllo.dylib 0x01e03fa1 AquaSalInstance::handleAppDefinedEvent(NSEvent*) + 12934 libvcllo.dylib 0x01e40b5b -[VCL_NSApplication sendEvent:] + 12335 com.apple.AppKit 0x96c9b62c -[NSApplication run] + 95136 com.apple.AppKit 0x96c3e5f6 NSApplicationMain + 105337 libvcllo.dylib 0x01e04867 ImplSVMainHook(int*) + 34338 libvcllo.dylib 0x01aba34a SVMain() + 2639 libsofficeapp.dylib 0x000d1ff5 soffice_main + 32540 org.libreoffice.script 0x00001f4e main + 3041 org.libreoffice.script 0x00001f25 start + 53(In reply to)>Sigh, that should be :- Use Wizard to create REPORT : no reaction, nothing happens- Create REPORT in Design View : app hangs.AlexCreatedApple hang trace of soffice processFWIW, I do also get a hang condition in the Form creation wizard...Could be the same issue as in. Adding linkage in "See Also" section.Seems to be the same asThere it is reported for Linux. Only LO 4.0.4.2 will crash, when a report should be executed or should be edited.LO 4.1.0.0 Beta 2 works ..., also LO 4.0.3.3*** This bug has been marked as a duplicate of***
id=66002	Createderror logSo, yet another Report Builder problem :-))on master :Version: 4.2.0.0.alpha0+Build ID: 585410476faca215122c96fdd4196ebf77a8df7dHow to reproduce :1) Open an ODB file containing a report2) Open the Report in Edit mode - the report contains no grouping, no sorting and no header or footer, and is presented in tabular format, simple 3 record table on one page.3) Click on the Report Properties icon to toggle properties on/off.4) LO hangsWhat should happen :LO should alternately display and hide the properties of the report.Console output after forced kill :First time around : C [libvcllo.so+0x327e01] boost::unordered::iterator_detail::iterator<boost::unordered::detail::ptr_node<std::pair<int const, int> > > boost::unordered::detail::table_impl<boost::unordered::detail::map<std::allocator<std::pair<int const, int> >, int, int, boost::hash<int>, std::equal_to<int> > >::find_node_impl<int, std::equal_to<int> >(unsigned int, int const&, std::equal_to<int> const&) const [clone .isra.117]+0x29Second time around :# A fatal error has been detected by the Java Runtime Environment:## SIGSEGV (0xb) at pc=0xb6479e01, pid=14411, tid=3011807104## JRE version: 6.0_27-b27# Java VM: OpenJDK Client VM (20.0-b12 mixed mode, sharing linux-x86 )# Derivative: IcedTea6 1.12.5# Distribution: Ubuntu 12.10, package 6b27-1.12.5-0ubuntu0.12.10.1# Problematic frame:# C [libvcllo.so+0x327e01]pure virtual method calledterminate called without an active exceptionAlex Putting db devs on CC, if interested.Does this Java debug stuff always happen with the ReportBuilder, or is it just in the dev builds ?Jun 21, 2013 10:46:40 AM org.pentaho.reporting.libraries.base.boot.AbstractBoot startINFO: LibSerializer 1.1.6.10682 started.Jun 21, 2013 10:46:40 AM org.pentaho.reporting.libraries.base.boot.AbstractBoot startINFO: LibBase 1.1.6.10682 started.Jun 21, 2013 10:46:40 AM org.pentaho.reporting.libraries.base.boot.AbstractBoot startINFO: LibLoader 1.1.6.10682 started.Jun 21, 2013 10:46:40 AM org.pentaho.reporting.libraries.base.boot.AbstractBoot startINFO: LibRepository 1.1.6.10682 started.Jun 21, 2013 10:46:40 AM org.pentaho.reporting.libraries.base.boot.AbstractBoot startINFO: LibFonts 1.1.6.10682 started.Jun 21, 2013 10:46:40 AM org.pentaho.reporting.libraries.base.boot.AbstractBoot startINFO: LibLayout null started.Jun 21, 2013 10:46:40 AM org.pentaho.reporting.libraries.base.boot.AbstractBoot startINFO: LibFormula 1.1.7.10682 started.Jun 21, 2013 10:46:40 AM org.pentaho.reporting.libraries.base.boot.AbstractBoot startINFO: LibXML 1.1.7.10682 started.Jun 21, 2013 10:46:40 AM org.pentaho.reporting.libraries.base.boot.PackageManager loadModuleWARNING: Exception while loading module: org.pentaho.reporting.libraries.base.boot.DefaultModuleInfo={ModuleClass=org.jfree.report.modules.gui.swing.common.SwingCommonModule}java.lang.NullPointerException at org.pentaho.reporting.libraries.base.boot.PackageManager.containsModule(PackageManager.java:369) at org.pentaho.reporting.libraries.base.boot.PackageManager.loadModule(PackageManager.java:436) at org.pentaho.reporting.libraries.base.boot.PackageManager.addModule(PackageManager.java:330) at org.pentaho.reporting.libraries.base.boot.PackageManager.load(PackageManager.java:199) at org.jfree.report.JFreeReportBoot.performBoot(Unknown Source) at org.pentaho.reporting.libraries.base.boot.AbstractBoot.start(AbstractBoot.java:197) at org.libreoffice.report.pentaho.PentahoReportEngine.<init>(PentahoReportEngine.java:34) at org.libreoffice.report.pentaho.SOReportJobFactory$_SOReportJobFactory.createReportJob(SOReportJobFactory.java:319) at org.libreoffice.report.pentaho.SOReportJobFactory$_SOReportJobFactory.execute(SOReportJobFactory.java:213) at com.sun.star.bridges.jni_uno.JNI_proxy.dispatch_call(Native Method) at com.sun.star.bridges.jni_uno.JNI_proxy.invoke(JNI_proxy.java:183) at sun.proxy.$Proxy87.execute(Unknown Source) at com.sun.star.wizards.reportbuilder.ReportBuilderImplementation.store(ReportBuilderImplementation.java:266) at com.sun.star.wizards.report.ReportFinalizer.finish(ReportFinalizer.java:267) at com.sun.star.wizards.report.ReportWizard.finishWizard(ReportWizard.java:352) at com.sun.star.wizards.ui.WizardDialog.finishWizard_1(WizardDialog.java:687) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:616) at com.sun.star.wizards.ui.event.MethodInvocation.invoke(MethodInvocation.java:76) at com.sun.star.wizards.ui.event.AbstractListener.invoke(AbstractListener.java:80) at com.sun.star.wizards.ui.event.CommonListener.actionPerformed(CommonListener.java:36) at com.sun.star.bridges.jni_uno.JNI_proxy.dispatch_call(Native Method) at com.sun.star.bridges.jni_uno.JNI_proxy.invoke(JNI_proxy.java:183) at sun.proxy.$Proxy71.execute(Unknown Source) at com.sun.star.wizards.ui.UnoDialog.executeDialog(UnoDialog.java:698) at com.sun.star.wizards.report.ReportWizard.startReportWizard(ReportWizard.java:472) at com.sun.star.wizards.report.CallReportWizard$ReportWizardImplementation.trigger(CallReportWizard.java:90)Jun 21, 2013 10:46:40 AM org.pentaho.reporting.libraries.base.boot.PackageManager loadModuleWARNING: Exception while loading module: org.pentaho.reporting.libraries.base.boot.DefaultModuleInfo={ModuleClass=org.jfree.report.modules.gui.swing.html.SwingHtmlModule}java.lang.NullPointerException at org.pentaho.reporting.libraries.base.boot.PackageManager.containsModule(PackageManager.java:369) at org.pentaho.reporting.libraries.base.boot.PackageManager.loadModule(PackageManager.java:436) at org.pentaho.reporting.libraries.base.boot.PackageManager.addModule(PackageManager.java:330) at org.pentaho.reporting.libraries.base.boot.PackageManager.load(PackageManager.java:199) at org.jfree.report.JFreeReportBoot.performBoot(Unknown Source) at org.pentaho.reporting.libraries.base.boot.AbstractBoot.start(AbstractBoot.java:197) at org.libreoffice.report.pentaho.PentahoReportEngine.<init>(PentahoReportEngine.java:34) at org.libreoffice.report.pentaho.SOReportJobFactory$_SOReportJobFactory.createReportJob(SOReportJobFactory.java:319) at org.libreoffice.report.pentaho.SOReportJobFactory$_SOReportJobFactory.execute(SOReportJobFactory.java:213) at com.sun.star.bridges.jni_uno.JNI_proxy.dispatch_call(Native Method) at com.sun.star.bridges.jni_uno.JNI_proxy.invoke(JNI_proxy.java:183) at sun.proxy.$Proxy87.execute(Unknown Source) at com.sun.star.wizards.reportbuilder.ReportBuilderImplementation.store(ReportBuilderImplementation.java:266) at com.sun.star.wizards.report.ReportFinalizer.finish(ReportFinalizer.java:267) at com.sun.star.wizards.report.ReportWizard.finishWizard(ReportWizard.java:352) at com.sun.star.wizards.ui.WizardDialog.finishWizard_1(WizardDialog.java:687) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:616) at com.sun.star.wizards.ui.event.MethodInvocation.invoke(MethodInvocation.java:76) at com.sun.star.wizards.ui.event.AbstractListener.invoke(AbstractListener.java:80) at com.sun.star.wizards.ui.event.CommonListener.actionPerformed(CommonListener.java:36) at com.sun.star.bridges.jni_uno.JNI_proxy.dispatch_call(Native Method) at com.sun.star.bridges.jni_uno.JNI_proxy.invoke(JNI_proxy.java:183) at sun.proxy.$Proxy71.execute(Unknown Source) at com.sun.star.wizards.ui.UnoDialog.executeDialog(UnoDialog.java:698) at com.sun.star.wizards.report.ReportWizard.startReportWizard(ReportWizard.java:472) at com.sun.star.wizards.report.CallReportWizard$ReportWizardImplementation.trigger(CallReportWizard.java:90)Jun 21, 2013 10:46:40 AM org.pentaho.reporting.libraries.base.boot.PackageManager loadModuleWARNING: Exception while loading module: org.pentaho.reporting.libraries.base.boot.DefaultModuleInfo={ModuleClass=org.jfree.report.modules.gui.swing.pdf.SwingPdfModule}java.lang.NullPointerException at org.pentaho.reporting.libraries.base.boot.PackageManager.containsModule(PackageManager.java:369) at org.pentaho.reporting.libraries.base.boot.PackageManager.loadModule(PackageManager.java:436) at org.pentaho.reporting.libraries.base.boot.PackageManager.addModule(PackageManager.java:330) at org.pentaho.reporting.libraries.base.boot.PackageManager.load(PackageManager.java:199) at org.jfree.report.JFreeReportBoot.performBoot(Unknown Source) at org.pentaho.reporting.libraries.base.boot.AbstractBoot.start(AbstractBoot.java:197) at org.libreoffice.report.pentaho.PentahoReportEngine.<init>(PentahoReportEngine.java:34) at org.libreoffice.report.pentaho.SOReportJobFactory$_SOReportJobFactory.createReportJob(SOReportJobFactory.java:319) at org.libreoffice.report.pentaho.SOReportJobFactory$_SOReportJobFactory.execute(SOReportJobFactory.java:213) at com.sun.star.bridges.jni_uno.JNI_proxy.dispatch_call(Native Method) at com.sun.star.bridges.jni_uno.JNI_proxy.invoke(JNI_proxy.java:183) at sun.proxy.$Proxy87.execute(Unknown Source) at com.sun.star.wizards.reportbuilder.ReportBuilderImplementation.store(ReportBuilderImplementation.java:266) at com.sun.star.wizards.report.ReportFinalizer.finish(ReportFinalizer.java:267) at com.sun.star.wizards.report.ReportWizard.finishWizard(ReportWizard.java:352) at com.sun.star.wizards.ui.WizardDialog.finishWizard_1(WizardDialog.java:687) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:616) at com.sun.star.wizards.ui.event.MethodInvocation.invoke(MethodInvocation.java:76) at com.sun.star.wizards.ui.event.AbstractListener.invoke(AbstractListener.java:80) at com.sun.star.wizards.ui.event.CommonListener.actionPerformed(CommonListener.java:36) at com.sun.star.bridges.jni_uno.JNI_proxy.dispatch_call(Native Method) at com.sun.star.bridges.jni_uno.JNI_proxy.invoke(JNI_proxy.java:183) at sun.proxy.$Proxy71.execute(Unknown Source) at com.sun.star.wizards.ui.UnoDialog.executeDialog(UnoDialog.java:698) at com.sun.star.wizards.report.ReportWizard.startReportWizard(ReportWizard.java:472) at com.sun.star.wizards.report.CallReportWizard$ReportWizardImplementation.trigger(CallReportWizard.java:90)Jun 21, 2013 10:46:40 AM org.pentaho.reporting.libraries.base.boot.PackageManager loadModuleWARNING: Exception while loading module: org.pentaho.reporting.libraries.base.boot.DefaultModuleInfo={ModuleClass=org.jfree.report.modules.gui.swing.preview.SwingPreviewModule}java.lang.NullPointerException at org.pentaho.reporting.libraries.base.boot.PackageManager.containsModule(PackageManager.java:369) at org.pentaho.reporting.libraries.base.boot.PackageManager.loadModule(PackageManager.java:436) at org.pentaho.reporting.libraries.base.boot.PackageManager.addModule(PackageManager.java:330) at org.pentaho.reporting.libraries.base.boot.PackageManager.load(PackageManager.java:199) at org.jfree.report.JFreeReportBoot.performBoot(Unknown Source) at org.pentaho.reporting.libraries.base.boot.AbstractBoot.start(AbstractBoot.java:197) at org.libreoffice.report.pentaho.PentahoReportEngine.<init>(PentahoReportEngine.java:34) at org.libreoffice.report.pentaho.SOReportJobFactory$_SOReportJobFactory.createReportJob(SOReportJobFactory.java:319) at org.libreoffice.report.pentaho.SOReportJobFactory$_SOReportJobFactory.execute(SOReportJobFactory.java:213) at com.sun.star.bridges.jni_uno.JNI_proxy.dispatch_call(Native Method) at com.sun.star.bridges.jni_uno.JNI_proxy.invoke(JNI_proxy.java:183) at sun.proxy.$Proxy87.execute(Unknown Source) at com.sun.star.wizards.reportbuilder.ReportBuilderImplementation.store(ReportBuilderImplementation.java:266) at com.sun.star.wizards.report.ReportFinalizer.finish(ReportFinalizer.java:267) at com.sun.star.wizards.report.ReportWizard.finishWizard(ReportWizard.java:352) at com.sun.star.wizards.ui.WizardDialog.finishWizard_1(WizardDialog.java:687) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:616) at com.sun.star.wizards.ui.event.MethodInvocation.invoke(MethodInvocation.java:76) at com.sun.star.wizards.ui.event.AbstractListener.invoke(AbstractListener.java:80) at com.sun.star.wizards.ui.event.CommonListener.actionPerformed(CommonListener.java:36) at com.sun.star.bridges.jni_uno.JNI_proxy.dispatch_call(Native Method) at com.sun.star.bridges.jni_uno.JNI_proxy.invoke(JNI_proxy.java:183) at sun.proxy.$Proxy71.execute(Unknown Source) at com.sun.star.wizards.ui.UnoDialog.executeDialog(UnoDialog.java:698) at com.sun.star.wizards.report.ReportWizard.startReportWizard(ReportWizard.java:472) at com.sun.star.wizards.report.CallReportWizard$ReportWizardImplementation.trigger(CallReportWizard.java:90)Jun 21, 2013 10:46:40 AM org.pentaho.reporting.libraries.base.boot.PackageManager loadModuleWARNING: Exception while loading module: org.pentaho.reporting.libraries.base.boot.DefaultModuleInfo={ModuleClass=org.jfree.report.modules.gui.swing.printing.SwingPrintingModule}java.lang.NullPointerException at org.pentaho.reporting.libraries.base.boot.PackageManager.containsModule(PackageManager.java:369) at org.pentaho.reporting.libraries.base.boot.PackageManager.loadModule(PackageManager.java:436) at org.pentaho.reporting.libraries.base.boot.PackageManager.addModule(PackageManager.java:330) at org.pentaho.reporting.libraries.base.boot.PackageManager.load(PackageManager.java:199) at org.jfree.report.JFreeReportBoot.performBoot(Unknown Source) at org.pentaho.reporting.libraries.base.boot.AbstractBoot.start(AbstractBoot.java:197) at org.libreoffice.report.pentaho.PentahoReportEngine.<init>(PentahoReportEngine.java:34) at org.libreoffice.report.pentaho.SOReportJobFactory$_SOReportJobFactory.createReportJob(SOReportJobFactory.java:319) at org.libreoffice.report.pentaho.SOReportJobFactory$_SOReportJobFactory.execute(SOReportJobFactory.java:213) at com.sun.star.bridges.jni_uno.JNI_proxy.dispatch_call(Native Method) at com.sun.star.bridges.jni_uno.JNI_proxy.invoke(JNI_proxy.java:183) at sun.proxy.$Proxy87.execute(Unknown Source) at com.sun.star.wizards.reportbuilder.ReportBuilderImplementation.store(ReportBuilderImplementation.java:266) at com.sun.star.wizards.report.ReportFinalizer.finish(ReportFinalizer.java:267) at com.sun.star.wizards.report.ReportWizard.finishWizard(ReportWizard.java:352) at com.sun.star.wizards.ui.WizardDialog.finishWizard_1(WizardDialog.java:687) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:616) at com.sun.star.wizards.ui.event.MethodInvocation.invoke(MethodInvocation.java:76) at com.sun.star.wizards.ui.event.AbstractListener.invoke(AbstractListener.java:80) at com.sun.star.wizards.ui.event.CommonListener.actionPerformed(CommonListener.java:36) at com.sun.star.bridges.jni_uno.JNI_proxy.dispatch_call(Native Method) at com.sun.star.bridges.jni_uno.JNI_proxy.invoke(JNI_proxy.java:183) at sun.proxy.$Proxy71.execute(Unknown Source) at com.sun.star.wizards.ui.UnoDialog.executeDialog(UnoDialog.java:698) at com.sun.star.wizards.report.ReportWizard.startReportWizard(ReportWizard.java:472) at com.sun.star.wizards.report.CallReportWizard$ReportWizardImplementation.trigger(CallReportWizard.java:90)Jun 21, 2013 10:46:40 AM org.pentaho.reporting.libraries.base.boot.AbstractBoot startINFO: Pentaho Reporting Flow-Engine null started.More to the point, is it of any use to anyone ?Alex0xb7fb6ee5 in rtl_uStringbuffer_insert_ascii () from /home/Development/libo/core/solver/unxlngi6.pro/installation/opt/program/../ure-link/lib/libuno_sal.so.3(gdb) backtrace#0 0xb7fb6ee5 in rtl_uStringbuffer_insert_ascii () from /home/Development/libo/core/solver/unxlngi6.pro/installation/opt/program/../ure-link/lib/libuno_sal.so.3#1 0xa7b9ceef in pcr::OBrowserLine::FullFillTitleString() () from /home/Development/libo/core/solver/unxlngi6.pro/installation/opt/program/../program/libpcrlo.so#2 0xa7b9f543 in pcr::OBrowserListBox::PositionLine(unsigned short) () from /home/Development/libo/core/solver/unxlngi6.pro/installation/opt/program/../program/libpcrlo.so#3 0xa7b9fbfa in pcr::OBrowserListBox::UpdatePosNSize() () from /home/Development/libo/core/solver/unxlngi6.pro/installation/opt/program/../program/libpcrlo.so#4 0xa7ba11ad in pcr::OBrowserListBox::InsertEntry(pcr::OLineDescriptor const&, unsigned short) () from /home/Development/libo/core/solver/unxlngi6.pro/installation/opt/program/../program/libpcrlo.so#5 0xa7c01631 in pcr::OPropertyEditor::InsertEntry(pcr::OLineDescriptor const&, unsigned short, unsigned short) () from /home/Development/libo/core/solver/unxlngi6.pro/installation/opt/program/../program/libpcrlo.so#6 0xa7bf8194 in pcr::OPropertyBrowserController::UpdateUI() () from /home/Development/libo/core/solver/unxlngi6.pro/installation/opt/program/../program/libpcrlo.so#7 0xa7bf92c0 in pcr::OPropertyBrowserController::impl_rebindToInspectee_nothrow(std::vector<com::sun::star::uno::Reference<com::sun::star::uno::XInterface>, std::allocator<com::sun::star::uno::Reference<com::sun::star::uno::XInterface> > > const&) () from /home/Development/libo/core/solver/unxlngi6.pro/installation/opt/program/../program/libpcrlo.so#8 0xa7bf9416 in pcr::OPropertyBrowserController::inspect(com::sun::star::uno::Sequence<com::sun::star::uno::Reference<com::sun::star::uno::XInterface> > const&) () from /home/Development/libo/core/solver/unxlngi6.pro/installation/opt/program/../program/libpcrlo.so#9 0xa7d5a29f in rptui::PropBrw::implSetNewObject(com::sun::star::uno::Sequence<com::sun::star::uno::Reference<com::sun::star::uno::XInterface> > const&) () from /home/Development/libo/core/solver/unxlngi6.pro/installation/opt/program/../program/librptuilo.so#10 0xa7d5ac93 in rptui::PropBrw::Update(com::sun::star::uno::Reference<com::sun::star::uno::XInterface> const&) () from /home/Development/libo/core/solver/unxlngi6.pro/installation/opt/program/../program/librptuilo.so#11 0xa7d54513 in rptui::ODesignView::MarkTimeout(void*) () from /home/Development/libo/core/solver/unxlngi6.pro/installation/opt/program/../program/librptuilo.so#12 0xb6b131a4 in Timer::Timeout() () from /home/Development/libo/core/solver/unxlngi6.pro/installation/opt/program/libvcllo.so#13 0xb6b13258 in Timer::ImplTimerCallbackProc() () from /home/Development/libo/core/solver/unxlngi6.pro/installation/opt/program/libvcllo.so#14 0xb364e230 in sal_gtk_timeout_dispatch () from /home/Development/libo/core/solver/unxlngi6.pro/lib/libvclplug_gtklo.so#15 0xb5f739e3 in g_main_context_dispatch () from /lib/i386-linux-gnu/libglib-2.0.so.0#16 0xb5f73d80 in ?? () from /lib/i386-linux-gnu/libglib-2.0.so.0#17 0xb5f73e61 in g_main_context_iteration () from /lib/i386-linux-gnu/libglib-2.0.so.0#18 0xb364df0c in GtkData::Yield(bool, bool) () from /home/Development/libo/core/solver/unxlngi6.pro/lib/libvclplug_gtklo.so#19 0xb364e3a7 in GtkInstance::Yield(bool, bool) () from /home/Development/libo/core/solver/unxlngi6.pro/lib/libvclplug_gtklo.so#20 0xb6b0ea32 in ImplYield(bool, bool) () from /home/Development/libo/core/solver/unxlngi6.pro/installation/opt/program/libvcllo.so#21 0xb6b0c7ca in Application::Yield(bool) () from /home/Development/libo/core/solver/unxlngi6.pro/installation/opt/program/libvcllo.so#22 0xb6b0c7fb in Application::Execute() () from /home/Development/libo/core/solver/unxlngi6.pro/installation/opt/program/libvcllo.so#23 0xb7f51c26 in desktop::Desktop::Main() () from /home/Development/libo/core/solver/unxlngi6.pro/installation/opt/program/libsofficeapp.so#24 0xb6b1298c in ImplSVMain() () from /home/Development/libo/core/solver/unxlngi6.pro/installation/opt/program/libvcllo.so#25 0xb6b12a5e in SVMain() () from /home/Development/libo/core/solver/unxlngi6.pro/installation/opt/program/libvcllo.so#26 0xb7f6de55 in soffice_main () from /home/Development/libo/core/solver/unxlngi6.pro/installation/opt/program/libsofficeapp.so#27 0x080485ac in main ()Alex: we have different traces here,1) stacktrace from your attachmentC [libvcllo.so+0x327e01] boost::unordered::iterator_detail::iterator<boost::unordered::detail::ptr_node<std::pair<int const, int> > > boost::unordered::detail::table_impl<boost::unordered::detail::map<std::allocator<std::pair<int const, int> >, int, int, boost::hash<int>, std::equal_to<int> > >::find_node_impl<int, std::equal_to<int> >(unsigned int, int const&, std::equal_to<int> const&) const [clone .isra.117]+0x29C [libvcllo.so+0x32a2a0] ServerFont::FixupGlyphIndex(int, unsigned long) const+0x34C [libvcllo.so+0x32e01d] HbLayoutEngine::layout(ServerFontLayout&, ImplLayoutArgs&)+0x5012) warning. I've seen them since a long time (I think it was already the case 3 years ago)3) I noticed that again rtl_uStringbuffer_insert_ascii is quoted but this time the caller is pcr::OBrowserLine::FullFillTitleString instead of connectivity::odbc::OTools::getStringValue (indirectly as Lionel explained) with fdo#65830As soon as my build was finished, I'll give it a try to pinpoint the precise line for stacktrace 1)Created3 bts at randomOn pc Debian x86-64 with master sources updated today, I reproduced the hanging.I attached 3 bts at random.It worked with 4.0.3.3 Debian package ("libreoffice-report-builder" package must be installed to be able to edit the report). Put it at New + add "regression" keyword.This commitseems to have fixed the problem.At least, I don't reproduce it anymore!(In reply to)I reverted that, and (hopefully) fixed the original problem. Please test again withThanks.Lionel Elie Mamane committed a patch related to this issue.It has been pushed to "master":fdo#66002 correct error introduced by "AppendAscii cleanup"The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Lionel: I git updated to retrieve your change then "make dev-install", it's still ok, no hang.Lionel: I was just waiting you putting this tracker at RESOLVED/FIXED to put it at VERIFIED :-)(In reply to)I was too quick/ambiguous in writing this comment. Apologies.DavidO's commit did fix this bug, by reverting a buggy part of a previous commit (a String->OUString conversion), which introduced this bug. I reverted the revert (that is, did the String->OUString conversion again), but additionally fixed the error in the conversion.I should have written something like:I did the work that this commit reverts again, but corrected the original error in the commit that this commit partially reverts. However, I'm not in a position to quickly test whether I really corrected the error, or if there is another undetected error lurking, so this needs testing again, because there is a non-zero chance that I just reintroduced this bug. I hope I did not.Confirming fix works on master 32bit Linux (Ubuntu 12.10), without any as yet untoward side effects ;-)Confirming fix on master OSX 10.8.4.
id=66239	How to reproduce :on Mac OSX, with master build from 26/06/2013 1) Open a Base file containing a report2) Click on the Reports icon3) Double-click on a report to open it for display4) Error message "Java loader error - no mapping from java to C++"What should happen : report should open and be displayed.Regression over LO 4.0.3.3Alex Adding Lionel, Julien to CC for info.Adding Stephan for the Java stuff@Stephan : any idea what is happening here ?AlexIn 4.0.3.3, on the same OSX system, the report opens just fine.AlexOn pc Debian x86-64 with master sources updated today, I don't reproduce this.Alex: just to be sure, could you attach the file? Perhaps it's specific to this one?Also, what's your Java version?Hi Julien,It is OSX specific I'm afraid. Using Apple supplied JVM, 1.6_29 I think. I don't have the problem on my master build on Linux either.AlexI've this with three different ODB files, all of them are taken fron bugzilla.Alex: perhaps it'll be useless but could you try to launch LO from console to see if there are some logs?BTW, do you build from sources or do you still have some problems about building?The interest would be to enable debug mode sincedon't show any content for: ---Alex: forget my question about building, just read this:Using 4.1.0.1, Debian, 32 bit, if I try to open or edit an existing report, built using 3.5/3.6 Report Builder extension, Base just crashes. If I try to create a new report using the wizard it says 'No valid report template was found'.If I open a new one in design mode it appears to work (although I have not pursued this).I can't easily submit a sample since this application is on mysql. I am even unable now to run the report on 3.5/6 since the 4.1 report builder has supplanted the compatible extension and I can't download it any more from the extension library (why is that - isn't 3.6.n a valid version any more?). All in all I have had to give up entirely on LO reports on Base and create them another way (using the ancient DataVision). The Report Builder always rather flaky.Tim: this bugtracker is specific to MacOs so it could be better you comment on fdo#63817 (not fdo#63398 which is solved now)(In reply to)Hi Julien,I build from master source, and most of the time, the build completes just fine.Yes, but enabling symbols or dbgutil all currently fail for me on OSX.It used to work for a while, then stopped working about 3 months ago, and the number of exceptions to DEBUG=true that you have to put in for each of the modules is a real PITA, and kind of defeats the point of having a debug build.Alex*** This bug has been marked as a duplicate of***
id=66265	Before installing 4.1.0.1, I uninstalled the previous version (beta 2). However the control panel still shows two entries for this older version (one for the main program, the other for the help file). If I click on these entries, the uninstaller asks for the msi file. "The installation source for this product is not available. Verify that the source exists and that you can access it."Unfortunately I have deleted these files after I got the latest version. So I tried to install 4.1.0.1 in parallel (without uninstalling the previous version), but this installer detects that an older version is still installed, and again asks for the msi file of the previous version (4.0.3.3); and then aborts the installation.I checked the C:\Users\<UserName>\AppData\Roaming path, but there are no folders named LODEV, LibreOffice, etc.I searched the registry but there are no values/keys with LibreOffice, LO, LODEV, etc.Since I have already uninstalled the previous version (4.0.3.3), the control panel entries must be ghost entries, but I am not able to delete these entries. (Usually the Control Panel offers to delete such ghost entries. But in this case it insists on having the msi file of 4.0.3.3.)How do I get rid of the issue?I am ready to download the older version msi files, but they are no longer available from the website.Please help! Update: I did find the older msi by Googling. I hope this is the correct path:Will update the status after downloading these files.But still, the problem is weird indeed! The uninstallation should not look for msi files at all.Update-2:I downloaded the old msi files, and then re-ran the uninstaller (from Control Panel). Both the help and the main program got uninstalled immediately.However, the moot point remains: Why does not manage within the installed base?Andras, how is this supposed to work please?So, how would it find out what to remove then? If all go well, you have that msi in your Windows\Installer (hidden) folder. I accept that Windows is not rock solid and sometimes the package database gets corrupted. But it is not a reproducible bug.You can also search for the product code in registry, it is {FB548EA9-B985-4217-9EB6-EFDCB2DBA088}.
id=66508	CreatedThe example file for test this bug.Problem description: Coping a chart will make Calc crash.Steps to reproduce:1. Open the "carsh.ods"2. Click the chart and press "Ctrl+C".3. Then Calc crashs.Current behavior:Coping a chart will make Calc crash.Expected behavior:Coping a chart do not make Calc crash.Thanks. Operating System: DebianVersion: 4.1.0.1 rcLast worked in: 4.0.3.3 release Thank you for your bug report, I can reproduce this bug running LibreOffice 4.1.0.1 on Ubuntu 12.04.2.I CANNOT confirm this bug running LibreOffice 4.1.0.1 on Mac osx 10.8.4Markus could you take a look add this please? I think it is serious.Crashes in mdds#6 0x00007ff82e236c8d in mdds::multi_type_vector<mdds::mtv::custom_block_func1<51, mdds::mtv::default_element_block<51, sc::CellTextAttr> > >::set_empty_impl(unsigned long, unsigned long, unsigned long, unsigned long) () from solver/unxlngx6.pro/installation/opt/program/../program/libsclo.so#7 0x00007ff82e237308 in mdds::multi_type_vector<mdds::mtv::custom_block_func1<51, mdds::mtv::default_element_block<51, sc::CellTextAttr> > >::set_empty(unsigned long, unsigned long) () from solver/unxlngx6.pro/installation/opt/program/../program/libsclo.so#8 0x00007ff82e23f1b6 in ScColumn::CopyCellTextAttrsToDocument(int, int, ScColumn&) const () from solver/unxlngx6.pro/installation/opt/program/../program/libsclo.so#9 0x00007ff82e2250ce in ScColumn::CopyStaticToDocument(int, int, ScColumn&) () from solver/unxlngx6.pro/installation/opt/program/../program/libsclo.soI fixed this bug already some time ago in master and just forgot to push the fixes to 4-1.Pending review now for 4-1 so it should be in the 4.1.0.2.Markus Mohrhard committed a patch related to this issue.It has been pushed to "libreoffice-4-1":don't crash during chart copying, fdo#66508It will be available in LibreOffice 4.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.After following the steps as described by minhsien0330, using his attachment, I can verify that this bug appears to be fixed. Calc doesn't crash when chart is copied with Ctrl+C.Running Windows 8 64 bitusing daily build:libreoffice-4-1~2013-07-06_14.02.34_LibreOfficeDev_4.1.1.0.0_Win_x86_archiveApologies, didn't notice it was on linux platform.Although, after getting the latest daily build, LibreOffice_4.1.1.0.0_Linux_x86-64_deb, and going through the test process I can also verify that it works on Ubuntu 13.04 64 bit.I tried 4.1.0 rc2, it was fixed. Thank you very much!!!Best Regards,Minhsien0330
id=66528	Upgraded Libra Office Spreadsheet from version 4.0.2.2 to 4.0.4.2Spreadsheet has hyperlinks within its own tabs and was working in version 4.0.2.2But when upgraded to 4.0.4.2, the hyperlinks looked they were still there but when clicked on they didn't do anything. Created Hyperlinks via the Insert / Hyperlink function Clicked using Ctrl+click? Have you tried resetting user profile? If that still unsolve the problem, please attach your sample file & steps to reproduce.Createdattachment-13193-0.htmlNot sure what you mean by “resetting user profile”. Could you explain further on how to do thisI have deleted original hyperlink and tried re-establishing it again. But it still won’t workMelinda Koth[PO Box 512 Logo]From:[]Sent: Wednesday, 3 July 2013 3:13 PMTo: Melinda KothSubject: [] Hyperlinks within spreadsheet not working after upgrade from Version 4.0.2.2 to Version 4.0.4.2<> on<> from ign_christian<>Clicked using Ctrl+click?Have you tried resetting user profile? If that still unsolve the problem,please attach your sample file & steps to reproduce.________________________________You are receiving this mail because: * You are on the CC list for the bug. * You reported the bug.Createdattachment-13193-1.datCreatedimage001.pngCreatedattachment-14108-0.htmlThis is the file that we are working on.Have deleted the original hyperlink and re established the link but it wont workMelinda Koth[PO Box 512 Logo]From:[]Sent: Wednesday, 3 July 2013 3:13 PMTo: Melinda KothSubject: [] Hyperlinks within spreadsheet not working after upgrade from Version 4.0.2.2 to Version 4.0.4.2<> on<> from ign_christian<>Clicked using Ctrl+click?Have you tried resetting user profile? If that still unsolve the problem,please attach your sample file & steps to reproduce.________________________________You are receiving this mail because: * You are on the CC list for the bug. * You reported the bug.Createdattachment-14108-1.datCreatedimage001.pngCreatedattachment-14108-2.datCreatedA&T Investment property files V1.odsMelindak: Here's a link explaining how to reset your user profile:Also please do not reply form your mail client but in the browser, since otherwise this bug will be cluttered with useless information (as unintended attachments and cluttering useless text).I opened your example document with LO 4.1.0.1 but I can't find any links. Could you please provide a detailed step-by-step description on how to reproduce the problem or which cells in which sheet should be links?After providing that info please reset the bug to "Unconfirmed".Have you try Ctrl+Click as ign_christian wrote in comment #.There is an option to change the behaviour:Menu/Tools/Options/Security/Security Options&Warnings/Security Options - Ctrlclick required to follow hyperlinks.Changed the status to resolved notabug, if you are not agree please reopen it.Not english speaking, sorry for some errors,the hyperlinks local from file to file and in a file as an alphabetic jump-list will be shown but they don't work.Food source
id=66666	le logiciel se bloque en cas de correction orthographique avec le Cal de libre office 4.0.4.2 (le tableur)merci de voir pour la prochaine fois English only here.remplacer les mauvais accents : évènement au lieu de événement
id=66700	How to reproduce :1) Open an ODB file, I have been using nba2012.odb for my tests.2) Click on Reports, then Crete Report in Design View3) Drag field from list of fields window to the Detail pane.4) Note that 2 identical fields appear to be added ????5) Select the object (both fields appear selected) and try to delete it with Backspace (Mac) or delete key6) Crashgdb output below :Program received signal EXC_BAD_ACCESS, Could not access memory.Reason: KERN_PROTECTION_FAILURE at address: 0x000000500x0052245f in SfxApplication::MiscState_Impl ()(gdb) (gdb) backtrace full#0 0x0052245f in SfxApplication::MiscState_Impl ()No symbol table info available.#1 0x005bd2eb in SfxShell::GetSlotState ()No symbol table info available.#2 0x00845d5f in SfxDispatcher::QueryState ()No symbol table info available.#3 0x005e6f10 in SfxDispatchController_Impl::addStatusListener ()No symbol table info available.#4 0x005e765e in SfxOfficeDispatch::addStatusListener ()No symbol table info available.#5 0x0b26cffd in framework::MenuBarManager::Activate ()No symbol table info available.#6 0x01a856b7 in Menu::Activate ()No symbol table info available.#7 0x01a82d77 in MenuBar::HandleMenuActivateEvent ()No symbol table info available.#8 0x01af9669 in ImplWindowFrameProc ()No symbol table info available.#9 0x01b52ff5 in -[SalNSMenu menuNeedsUpdate:] ()No symbol table info available.#10 0x96c0eb2f in -[NSMenu _populateFromDelegateWithEventRef:] ()No symbol table info available.#11 0x96bb0b66 in -[NSMenu _populateWithEventRef:] ()No symbol table info available.#12 0x96c0db6d in -[NSCarbonMenuImpl _carbonPopulateEvent:handlerCallRef:] ()No symbol table info available.#13 0x96c0d6ee in NSSLMMenuEventHandler ()No symbol table info available.#14 0x937099bb in _InvokeEventHandlerUPP ()No symbol table info available.#15 0x93591394 in DispatchEventToHandlers ()No symbol table info available.#16 0x93590780 in SendEventToEventTargetInternal ()No symbol table info available.#17 0x935905ca in SendEventToEventTargetWithOptions ()No symbol table info available.#18 0x9374b204 in SendMenuPopulate ()No symbol table info available.#19 0x937670a9 in PopulateMenu ()No symbol table info available.#20 0x935d7a89 in Check1MenuForKeyEvent ()No symbol table info available.#21 0x935d83d9 in Check1MenuForKeyEvent ()No symbol table info available.#22 0x935d73fd in CheckMenusForKeyEvent ()No symbol table info available.#23 0x93766f9d in _IsMenuKeyEvent ()No symbol table info available.#24 0x935d6f8f in IsMenuKeyEvent ()No symbol table info available.#25 0x96c0d437 in -[NSCarbonMenuImpl _menuItemWithKeyEquivalentMatchingEventRef:] ()No symbol table info available.#26 0x96c0d1b1 in _NSFindMenuItemMatchingCommandKeyEvent ()No symbol table info available.#27 0x96ac6434 in _NSHandleCarbonMenuEvent ()No symbol table info available.#28 0x969ecfdf in _DPSNextEvent ()No symbol table info available.#29 0x969ec16c in -[NSApplication nextEventMatchingMask:untilDate:inMode:dequeue:] ()No symbol table info available.#30 0x01b06ea4 in AquaSalInstance::Yield ()No symbol table info available.#31 0x017b7b34 in Application::Yield ()No symbol table info available.#32 0x017b8eec in Application::Execute ()No symbol table info available.#33 0x0006dffc in desktop::Desktop::Main ()No symbol table info available.#34 0x017c0302 in ImplSVMain ()No symbol table info available.#35 0x01b05f31 in AquaSalInstance::handleAppDefinedEvent ()No symbol table info available.#36 0x01b42b6b in -[VCL_NSApplication sendEvent:] ()No symbol table info available.#37 0x969e262c in -[NSApplication run] ()No symbol table info available.#38 0x969855f6 in NSApplicationMain ()No symbol table info available.#39 0x01b067f7 in ImplSVMainHook ()No symbol table info available.#40 0x017c033a in SVMain ()No symbol table info available.#41 0x0009c0b5 in soffice_main ()No symbol table info available.#42 0x00001f4e in main ()No symbol table info available.(gdb) cContinuing.Program received signal EXC_BAD_ACCESS, Could not access memory.Reason: KERN_PROTECTION_FAILURE at address: 0x000000500x0052245f in SfxApplication::MiscState_Impl ()(gdb) Adding Lionel, Julien to CCIt is already pretty weird that two identical fields get added via DnD - that in itself is a bug.AlexOK, forget the double fields comment, there are not two fields being added, but the Label gets positioned under the Field itself and bears of course the same name. The positioning of the Label is such that it overlaps with the Footer zone of the report. This is still a separate bug IMHO.AlexCreatedapple crash trace when trying to delete field/label from reportThis could well be a DUP of fdo#61380Alex, you tagged this as regression, but I don't see in any comment in which version it was working. Please specify that (if necessary, after testing with older/stable versions), or remove the regression keyword.All this works in LO 3.6.6.2, LO 4.0.3.3 and LO 4.1.0.2 under Linux 64bit rpm. You could delete both fields. Alex, you could be happy, when you could create a report in LO 4.2.0.0 beta - I can't. LO will hang when I want to start to create a report.And of course, I don't see the problem on my 32bit Linux build from master, sigh.Will report on or rectify OSX regression status later.AlexConfirming regression over 3.5.7 and 3.6.6 on OSXAlexFurther comments :In versions 3.5.7 and 3.6.6, the Backspace key, used to delete selected objects on OSX did not work (accelerator binding issues). However, Cmd-X did work and successfully deletes any selected object.If I try Cmd-X on the selected objects in my OSX master build, the crash is immediate, whereas if I use the the Backspace key, it takes a few microseconds more for the main app window to disappear.I am wondering whether the recent accelerator key work on OSX is the underlying issue here ?AlexOn LO 4.0.3.3, Cmd-X also works without crashing LO, whereas the Backspace key has no effect.Alex(In reply to)Hi Robert,On my 32bit Linux master build, I can create a Report in Design View but the windows are slow to appear, it takes my 4Gb RAM Ubuntu 13.04 system a good ten seconds for the Report Design window and Field Selector to appear, and certainly Unity seems to think that the app has hung for a while, as it darkens the screen. I put that down to it being a developer build on my machine, and not fully integrated with Unity, but maybe what you are seeing on your own system is that it is indeed slow to appear to the point where the app appears to have hung.If that is the case, and I say 'if', then that sounds like a separate performance bug.AlexHello all, I can reproduce this bug running LibreOffice Version: 4.2.0.0.alpha0+Build ID: 02fb63f8f29085213659b730456dbf0438c2f7ccTinderBox: MacOSX-X86_64@43, Branch:master, Time: 2013-08-01_00:42:37 on Mac osx 10.8.4. I used the nba2012.odb file fromI am not good with Base (first time I used it) so I hope I did every thing goodOn pc Debian x86-64 with master sources updated today, I don't reproduce this.I noticed that if I drag a field from the list, there's just 1 field which appear to be added.Java info:java version "1.7.0_21"OpenJDK Runtime Environment (IcedTea 2.3.9) (7u21-2.3.9-5)OpenJDK 64-Bit Server VM (build 23.7-b01, mixed mode)Thomas: in the recent build you use, did you have too 2 identical fields added?(In reply to)Hi Julien,Looks like this is another Mac-only bug...AlexAlex: badfully :-( With a more recent build, do you still have the "duplicate drag"?(In reply to)Haven't been able to build from master on Mac for a while, thanks to an automatic Apple XCode upgrade hosing my command line tool installation and forcing me to switch to 10.8 SDK. For now, I will have to try with one of Tor's 64bit builds or a daily build from the buildbots.AlexJulien: Yes there were too fields edited at the same time just like Alex said at step 4. I thing that that is also a bug.?.?..I can reproduce this now on macCaolan McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: fdo#66700 don't crash on querying zoom state with no SfxObjectShellThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-1":Related: fdo#66700 don't crash on setting zoom state with no SfxObjectShellIt will be available in LibreOffice 4.1.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=66703	The Report Designer wizard seems to have been disabled.How to reproduce :1) Open an ODB file.2) Click on the Reports button3) Click on Use Wizard to Create Report4) Nothing happensWhat should happen :Wizard should start to help user design report.regressionAlex Adding Lionel, Julien to CCCannot reproduce on master (4.2.0.alpha), my own (dbg-util) dev tree on top of b440845b9f04fdf498caf3bcdcc52ffc8c489639 of 2013-07-05 17:55:30 on Debian GNU/Linux amd64.What version exactly are you using? Your own build? A nightly/daily?(In reply to)Hi Lionel,It is my own OSX build from master, from 07/07/2013.I can't reproduce on my 32bit Linux build from yesterday either.AlexEven worse ... reproducible using Mac OSX 10.8.4 with LibreOffice Versie: 4.1.0.2.0 Build ID: 103a942746cfe346e87daab62acbd4268c38097; Dutch UIStephan Bergmann committed a patch related to this issue.It has been pushed to "master":fdo#66703: Missing libjava_uno.jnilib symlinkThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Stephan Bergmann committed a patch related to this issue.It has been pushed to "libreoffice-4-1":fdo#66703: Missing libjava_uno.jnilib symlinkIt will be available in LibreOffice 4.1.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.***has been marked as a duplicate of this bug. ***requested backport of fix to libreoffice-4-1-0 as <>Stephan Bergmann committed a patch related to this issue.It has been pushed to "libreoffice-4-1-0":fdo#66703: Missing libjava_uno.jnilib symlinkIt will be available already in LibreOffice 4.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=67094	Steps to Reproduce:1. Open Spreadsheet2. Type "this is a test" -- lots of spaces3. Save as ODS4. Close5. OpenExpected:You see the text as you wrote itObservedYou see "this is a test" with a single spaceAlso exists on master Marking as NEW as it's been confirmed by erAck & PapamattiAlso erAck confirmed that the data is stored - just not reading correctly upon openingprolly related (not yet reported as bug)type " =3+4" in a cell (without double quotes, but with leading spacethis shows as " =3+4"save file and reopen > space is removed and cell shows "7"When readingaaa bbb (5 spaces) =3+4 (text with 1 leading space)saved with 4.0.4 <table:table-row table:style-name='ro1'> <table:table-cell office:value-type='string'> <text:p>aaa <text:s text:c='4' />bbb </text:p> </table:table-cell> </table:table-row> <table:table-row table:style-name='ro1'> <table:table-cell office:value-type='string'> <text:p> <text:s />=3+4 </text:p> </table:table-cell> </table:table-row>in 4.1.0.2 this results inaaa bbb (1 space only)= #NAME? (i.e. interpreted as formula with no content)Saving again in 4.1.0.2 leads to data loss.Found the cause, working on a fix.Eike Rathke committed a patch related to this issue.It has been pushed to "master":resolved fdo#67094 handle <text:s> in <text:p> and <text:span>The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Pending reviewfor 4-1 asfor 4-1-0 asI can't see this in an RC5 for 4.1.0 personally. Too old a bug, and too big a patch I think; it's obviously the right thing to do for 4.1.1 though [!].It would be -lovely- to see a unit test for it too IMHO ;-) thanks for the quick fix Eike !(In reply to)of course I can't step in the other considerations, but this issue is only 3 days old :)Eike Rathke committed a patch related to this issue.It has been pushed to "libreoffice-4-1":resolved fdo#67094 handle <text:s> in <text:p> and <text:span>It will be available in LibreOffice 4.1.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.(In reply to)Michael was probably referring that the regression was introduced in master beginning of February and wasn't discovered until now.Eike Rathke committed a patch related to this issue.It has been pushed to "libreoffice-4-1-0":resolved fdo#67094 handle <text:s> in <text:p> and <text:span>It will be available already in LibreOffice 4.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.(In reply to)I guess so yes ;)(Alas no daylies for me. And no extra time either of course)Eike Rathke committed a patch related to this issue.It has been pushed to "master":unit test for <text:s> in <text:p> and <text:span>, fdo#67094The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.This all looks beautiful, and thanks Eike for fixing it so nicely & unit testing it too => marking fixed to make MAB's easier to grok :-)Eike Rathke committed a patch related to this issue.It has been pushed to "libreoffice-4-1":unit test for <text:s> in <text:p> and <text:span>, fdo#67094It will be available in LibreOffice 4.1.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.(In reply to)Note that the commit happened after RC4 tagging, the fix will actually be in 4.1.1The commit 3d1ab404feb742c59652b381c54af4ca624dca15 could be applied as a hotfix if someone wanted to roll an own 4.1.0 build.***has been marked as a duplicate of this bug. ***
id=67128	CreatedFile Demonstrating ProblemVersion: 4.2 masterBuild Date: Thu Jul 18 14:51:17 2013 +0200Reproducible Steps:1. Open Attached File2. Select entire sheet (UNFORMAT)3. Data -> Filter -> Auto Filter4. Go to Column X5. SortExpected: Sort happensObserved: CrashWorks fine on 4.1 RC3 Comment onFile Demonstrating ProblemMimetype fixedI can not reproduce.Win7x97i3UltimateVersion: 4.2.0.0.alpha0+Build ID: 2cce78137bbf9810421b9fdedd45127b019b1188TinderBox: Win-x86@6-debug, Branch:master, Time: 2013-07-18_23:43:36Maybe a bit detailed step by step and OS information, to do exactly the same, could help.Have you tried resetting the user profile?ah apologies: Bodhi Linux x64Not sure how much more detailed I can be than those steps that were provided. Every time I do those steps results in a crash - clean profile = same crash.The only additional note is that you must first turn off the autofilters that are on - in other words, if you just open the file as is and sort by column X on sheet "UNFORMATED", no crash occurs. First turn off the auto filter1. Data -> Filters -> Autofilters2. Select the entire sheet3. Repeat step 1 to turn auto filters back on4. Sort by column XResults in nasty crash.Marking as UNCONFIRMED again - if no crash on Windows perhaps Linux only bug. If those steps are still not clear I'll hop into dev channel or QA channel and walk someone through :)Tested on Windows 8: master~2013-07-11_04.05.08_LibreOfficeDev_4.2.0.0.alpha0_Win_x86.msi No crash - marking as Linux(all)Works fine on 4.1.0.3 on UbuntuCreatedBacktraceConfirmed on Ubuntu 64Createdtypescript with backtrace and valgrindSome points of potential interest: - l 14: start of execution under gdb. The program issues lots of warnings. - l 1046: SIGSEGV - L 1055: thread apply all backtrace full. At top of active thread is __gnu_debug::_Safe_iterator_base::_M_attach_single(__gnu_debug::_Safe_sequence_base*, bool) - l 1430: start of execution under valgrind. - l 2666: invalid read. At top of stack is the same function ...: more valgrind errors follow - l 2806: SIGSEGV. At top of stack is the same function.My LibreOffice is master commit 1cf0999, pulled around 2013-07-28 0208 UTC,built and running on ubuntu-natty (11.04) 32-bit, configured with ... --enable-option-checking=fatal --enable-dbgutil --enable-crashdump --without-system-postgresql --without-myspell-dicts --with-extra-buildid --without-doxygen --with-external-tar=/home/terry/lo_hacking/git/srcCreatedbacktrace from signal 6, SIGABRTI have been trying to bibisect this bug using the daily bibisect repo,and the results are less clear-cut than I would like. Thus, I amwitholding keyword "bibisected" until somebody finds my resultsadequately useful.For purposes of bibisecting, I treated two conditions as "bad":(*) segfault, as evident in version latest(*) signal 6, SIGABRT, with terminal messages terminate called after throwing an instance of 'std::out_of_range' what(): vector::_M_range_check but only after the progress bar started to move across the bottom of the screen. Among the LO versions which bibisect probed, this appeared in 3791268. The current attachment is from that crash.Moreover, as I went through the versions of LibreOffice, I sorted oncolumn B and took that one result--crash or no crash--as the answer.This despite my vague memory of one version of LibreOffice whichsucceeded in sorting on column A but crashed sorting on column B.This is my first experience using AutoFilter. I saw some surprisingbehaviour, even some which I think is outright wrong, but in the absenceof a crash I deemed the LO version "good".Let me continue with the standard report of bibisect results. Theterminal output from the final `git bisect good` is ... 3791268ce3e6f9e570f02c09d586fd8e9f2485c3 is the first bad commit commit 3791268ce3e6f9e570f02c09d586fd8e9f2485c3 Author: Jean-Baptiste Lallement <> Date: Tue Jun 25 08:38:33 2013 +0000 source-hash-51daa4de4fbb86903aeb9cdfefbb089e8d00c001 commit 51daa4de4fbb86903aeb9cdfefbb089e8d00c001 Author: Jelle van der Waa <> AuthorDate: Sat Jun 22 12:52:31 2013 +0200 Commit: Michael Stahl <> CommitDate: Mon Jun 24 21:44:24 2013 +0000 fdo#43460 sd,rsc,ucb,sdext: use isEmpty() Change-Id: I7a7a77c26b74078f7fc160fbaa1c8d4e912b844e Reviewed-on:Reviewed-by: Michael Stahl <> Tested-by: Michael Stahl <> :100644 100644 e0cc68ae32874b64ac7d808f00880e1a79e714dc df3b23445f820f871a2d81e85b1e77e498f3ad23 M ccache.log :100644 100644 37f2ae4d811759d268b9b1038112d19960894a41 dc625f5b9d41121b4fa888e776a25b5cdbf462a8 M commitmsg :100644 100644 7873383e78698b5969775797224dea2257429d1a b85c93b24f073f04203e6d8492b6ae63d3039c30 M dev-install.log :100644 100644 8c4471055dd337a79af1aea93ba257edc45bbae3 062a117b360ac5cff020aae921e81cb3ca6578d9 M make.log :040000 040000 1cf15df9ad150422e1e8c4c13350c7fd64c88fd1 dcff4929a651e1e77268fb14b8688ae249b041ed M optand `git bisect log` shows ... # bad: [893c8a30f0419e92c94e9c6c435ee2531a6f748c] source-hash-2fc0fa62b26ce34675fcb94de59194592421eeb5 # good: [9342a3ee4ef4df633567057ea46530d79254b6d2] source-hash-0d61e5dcdbe2cec9df33ac22e3f0e4fbd6a07517 git bisect start '893c8a3' '9342a3e' # good: [159a7f006fe0759d61076916d2ddc1bec2e0fa83] source-hash-bddf3bba1fa13b57a69f2bd5f7c7f96bb945066d git bisect good 159a7f006fe0759d61076916d2ddc1bec2e0fa83 # bad: [6e4f7bdbe1bf434b9ae111c5e83f524113b7c4b8] source-hash-f237f1a616d973397511575c1eb033731d6007f7 git bisect bad 6e4f7bdbe1bf434b9ae111c5e83f524113b7c4b8 # bad: [4e06b05aa294d89809817c3ac5743e4328fe363a] source-hash-26a45c1886d9167d8f9ae9aad6234a3702768d8a git bisect bad 4e06b05aa294d89809817c3ac5743e4328fe363a # bad: [3791268ce3e6f9e570f02c09d586fd8e9f2485c3] source-hash-51daa4de4fbb86903aeb9cdfefbb089e8d00c001 git bisect bad 3791268ce3e6f9e570f02c09d586fd8e9f2485c3 # good: [a5620bdfe00015bdba86ee895e26fb4a13721dfe] source-hash-97f71c5f8be85f47d7978259a2d82708412043fd git bisect good a5620bdfe00015bdba86ee895e26fb4a13721dfeAlong the way I saw some funny things ...(*) The down-arrow icon in the first row throws up an untitled dialog. The dialog sometimes appears immediately and sometimes appears after a delay of a few seconds. I think that the delayed presentation of the dialog is associated with crashing versions of LibreOffice, but I was well into the bibisect process before I noticed the connection. Treat the observation as tentative.(*) In some versions of LibreOffice, that unnamed dialog captures <alt>-<tab> to move focus among its own controls instead of moving focus between applications.(*) After I told the dialog box arising from Data > Filter > AutoFilter to use first row as headings, the sort moved the headings down to row 148, after col B = 1 and before col B = blank. This seems just plain wrong. Joel?(*) 1 sorts before blank. Again, this seems just plain wrong. Joel?I can't reproduce this, on Linux.Does anyone test with a non-dbgutil build?Also, how are you sorting? There are 3 ways to sort by a column. I need to know which sorting method was used. Please be specific as to which menu item, which dialog, which buttons are clicked, which icon was pressed, and where the cell cursor is at the time of the sort.Thanks.The versions of LibreOffice in the daily bibisect are non-dbgutil.But perhaps, Kohei, you want a distributed version?The sort I used is "Sort Ascending" on column B. For completeness,the whole procedure with version "latest" (4118d73...source-hash-5bd6a51...) from the daily bibisect is ...(1) Run soffice from the command line, naming the example file attached to this bug. Program displays window "Unconfirmed.ods - LibreOffice Calc", sheet UNFORMATED, with cell I12 selected. The cells in row 1 each have a down-arrow button.(2) Take menu options Data > Filter. Note that AutoFilter is selected (the icon at the left of AutoFilter is against a dark background).(3) Click sub-sub-menu option AutoFilter. Program presents dialog box "Autofilter not possible". In row 1 of "Unconfirmed.ods...", the cells do not have down-arrow buttons.(4) Click <OK> in the dialog. Focus returns to "Uconfirmed.ods...".(5) Select the whole sheet by clicking on the rectangle above row numbers and to the left of column numbers. (Surely this rectangle has a name?) Program colours all visible cells to show selection.(6) Take menu option Data > Filter > AutoFilter. Program presents dialog "LibreOffice Calc: The range does not contain column headers. Do you want the first line to be used as column header?".(7) Click <Yes> in the dialog. Focus returns to "Unconfirmed.ods...", each visible cell in row 1 has a down-arrow button, all visible cells are shaded to show selection, and cell I12 is outlined.(8) Click the down-arrow button in cell B1. After about five seconds, the program presents pop-up with options "Sort Ascending", "Sort Descending", "Top 10", "Empty", "Not Empty", "Standard Filter...".(9) Click "Sort Ascending". Program produces segfault.Thanks Terrence. Did exactly that and ensured that your descriptions matched mine in each step. And it still doesn't crash...Perhaps this no longer happens in the latest master?I am starting git fetch now. Should have something to report within 24 hours.Createdbacktrace from later segfault, executing on a 64-bit systemWith master commit ecb842e, pulled around 2013-08-13 22:30 UTC, builtwith --enable-dbgutil, the results are different, but further actionslead anyway to a segmentation fault. So, picking up from step (9) of, my revised report is ...( 9) Click "Sort Ascending". Program resorts the rows so that all cells visible in column B have 1. Note that the header row has been sorted out-of-sight.(10) Type ctrl-Z. Row 1, in particular, is once again the header row with down-arrow buttons.(11) Click the down-arrow button in cell B1. Program present the pop-up.(12) Click "Sort Descending". Segfault.The backtrace again shows function __gnu_debug :: _Safe_iterator_base :: _M_attach_single ( __gnu_debug :: _Safe_sequence_base * , bool )So, I conclude that (a) this is, in some ill-defined sense, the same crash; and (b) a non-dbgutil build is unlikely to fail the same way.Still, if the non-dbgutil build is not somehow unclean--perhapsrelying on undocumented behaviour of the STL, or something--it wouldsuggest a problem in STL. Unless our code really is different with--enable-dbgutil; I saw a commit fixing one of those bugs in the lastfew days.Createdsimpler test documentHere is a simpler way to reach a segfault:(1) Download and open the attached file, simpler.ods. Or, in an empty worksheet, just enter in rows 1 to 3 and columns A to C ... number en fr 1 one un 2 two and turn on AutoFilter.(2) Sort on column A descending.(3) Sort on column B descending.Emptiness of cell C3 is essential to the segfault: type "deux" in thatcell and there is no crash.Thanks. At this point I'll assume that this crash only happens with a dbgutil build, which likely means some mis-use of singular iterator instances which normally don't crash in the release build, but that itself is an error.I'll take it.Well, I just built myself a dbgutil build, convinced that that would reproduce this crash. I followed Terrence's simpler example in, but still doesn't crash... :-(Well, this is disappointing. I also tried the original scenario with my dbgutil build, and still no crash... No idea what's going on here...I'll put to back to the default owner for now.Terrence: on pc Debian x86-64 with master sources updated today (+ brand new LO profile), I don't reproduce this.Could you tell precisely what you use to sort the columns?Here what I did:- select column A (by clicking "A")- click Sort descending icon => LO asked me if I wanted to 1) Extend selection 2) Current selection 3) CancelI clicked on "Extend selection" and it turned off the Autofilter.Then I kept on the same way with Column B and no crash.I also tried with ("Current selection"), Autofilter turned off again and no crashconfig elements:gcc (Debian 4.7.3-4)ldd (Debian EGLIBC 2.17-92)autogen.input includes --enable-debug and --enable-dbgutil(In reply to)Julien, follow Terrence's very detailed steps in. That's almost as good as we could ask for.Createdconsole + bt with symbols on master sourcesThank you Kohei, I've been able to reproduce the problem.I attached console logs (which showed a lot of errors) + bt but this last one seems exactly the same as Terrence's one.Julien,You do not say whether you started with the first attachment (a normalworkbook from Joel Madero) or the later one (my trivial worksheet).In the latter, the "Sort Descending" icon gives me a segfault, butonly after a "Sort Descending" on another column.However, I can make a segfault on the first sort after loading thesheet by entering row 4 with values 3,three,drei before sorting oncolumn C.Kohei,Is it the case that an empty cell should work well in a swap-cellsoperation?(In reply to)Sorry Terrence, it was with the Joel Madero's one.I'll give a try with yours and keep you informed of course:-)(In reply to)Of course. We even have a unit test case for that with empty cells.How many of you have live spell check enabled when the crash happens? Does turning that off make any difference?(In reply to)I reproduced the problem with your file but only with second method (row 4).With first method, I chose "Sort Descending" for 1 column, LO proposed me Extend/Current/Cancel, I chose Extend, then another column, did again "Sort Descending", no crash.(In reply to)Kohei: I had spell check enabled (it seems the default option since I used a brand new LO profile).Anyway, I disabled it and gave a new try with Terrence's file method 2 (row 4) and no crash!Then I also gave a new try toand initial file, no crash too when live spellchecking disabled!I found Tools > Options > Languages > "Writing Aids" > "Check spellingas you type" selected. When I deselect it, the segfault goes away;when I select it the segfault returns.For me to make the crash, "another column" must be column C, and (Ithink) the sort must move the empty cell.(In reply to)Thank you Terrence, I reproduced the crash with first method. If live spellcheck (as you said Tools > Options > Languages > "Writing Aids" > "Check spellingas you type") is disabled, no crash.Ok. That narrows it down for me. Having live spell check on (which btw is also referred to as "online spell check") is known to cause hard-to-reproduce problems because it kicks in at random and modifies cell content.***has been marked as a duplicate of this bug. ***Kohei: I found that fdo#67141 had the same bt and disabling "checking spelling" prevents LO from crashing.The description of the buggives a even more straighforward process to reproduce the bug (at least for me :-))FWIW, I can not reproduce on Version: 4.2.0.0.alpha0+Build ID: 22d1beb78a475e4846af945afde1c4d6c263b5d6on OSX 10.8.4.My master build is a 64bit OSX version from 22/08/2013.AlexI tested with simpler.ods, and it made no difference whether I turned live spellchecking on/off.AlexI've made a whole bunch of changes on the master branch just now, to rework the way how calc's online spell check works. The new implementation doesn't modify the document content, so it should make this use case a lot more stable.@KoheiThank you for the fix.I have built on ubuntu 32-bit and tested on ubuntu 32-bit and 64-bitwith no observed problem.@JoelIs it a bug that the sort should move the heading row to the bottom inthe example file that you attached. That does not happen with mytrivial worksheet.Terry.Yeah it is - but I believe it's been reported on another bug. No clue the # unfortunatelyI'll park this bug on me since I fixed it.Thanks Kohei - glad it got fixed before release.
id=67235	Problem description: When you create a main form with a subform with a time text box in the subform, the "time max" setting always reverts to 00:00:01 when you save the form, so you cannot read or change any times. I have not tested this in Windows since I can't take a chance on losing this function.Steps to reproduce:1. Create new database2. Create 2 tables including 1 field in each to connect main form with subform, and including a time text box in the subform3. Use wizard to create main form and subform including the time text boxCurrent behavior:You will be unable to see or change any times in the time text box. "Time max" setting for the text box remains at 00:00:01 when you try to change it and save the form. This happened in both data sheet view and with text boxes.Expected behavior:Times will show correctly in the time text box in the subform, you will be able to change times in the text box, and changes to the "time max" setting will be saved Operating System: DebianVersion: 4.1.0.1 rc Would be better if you could attach a little database. I don't know what you mean with "time text box".CreatedThe information fields in both tables help explain the problem I'm having.Open the form and try to change the time. Then try to adjust the control settings to make the time box & column (both main & subform in this case) work.I don't know where the bug started, but I had to pick a version. I know it didn't happen in 4.0.3. I never tested it in any version other than Debian. I use Ubuntu 12.04 for my OS, with latest updates. I had to quit using 4.0 because reports stopped working in 4.0.4CreatedTimefield in a tablecontrol is limited to 1 secondI can confirm this bug. It isn't a problem of the subform. So I created a new form and a tablecontrol with a timefield. All timefields in a tablecontrol are automatically limited to 00:00:01. You could see this, when you try to change the value of one row and then have a look to the table, 00:00:01 appears.The timefield in a tablecontrol works right LO 4.0.4.2.One hint:If you would chose a formatted field it should work for you - but didn't solve the bug.I have switched the version to 4.1.0.0.beta1 - the first version I could test where the bug appears.If you're saying the problem only occurs in the datasheet view, please check the "TimeWorksCorrectly" text box in the "MainFormWithSubForm" form in the file I uploaded. The text box with a time field does the same thing as it does in the datasheet view in the subform. I discovered this after making the test database to upload.CreatedTime field not displaying existing (nonzero) table values anymoreSame bug still present in the 4.1.0.4 release.This is a blocker for us, as we are unable to read/change/assign course beginning times.(In reply to)Please see:Please do not change the version to the latest version the bug appears. Everybody, who could fix bugs, would search: What has been changed that this bug appears.The first version the bug appears I have tested is 4.0.0.0.beta1Hello,I may have another manifestation of the same bug. The LO version is 4.1.0.4 running on Ubuntu 12.04.We have a database, HSQLDB 2.3, which is used to store employee work time. We use Base as the front end. We use a split configuration db which is stored in a shared Dropbox folder.Two computers access the DropBox files, one is running Windows 8/LO 4.0.3.3 and the other is running Ubuntu 12.04/LO 4.1.04.All the tables, etc have been developed on the Windows machine.One table has 3 timestamp fields, two are set to default to current_timestamp when the record is created and the 3rd field is set to current_timestamp after a triggering event occurs.When you open the table in the Ubuntu LO the displayed dates are correct, however all times are set to 12:00 am. Although the display is incorrect, the correct system time is being recorded in the database. This is verified when the table is opened in the Windows LO, where all the records are correctly displayed.All formats in the table, forms and reports are set correctly.As a test I copied data from the table as displayed on the Ubuntu machine and pasted it into a Calc spreadsheet. The times were incorrectly displayed.I repeated the test on the Windows machine (accessing the same database), pasted the records into a spreadsheet, saved the spreadsheet and opened it on the Ubuntu machine. This time the time display was correct.I have also created a new table with a field default set to current_timestamp using the Ubuntu LO. This new table records the correct time in the db, but displays the incorrect time. I tried a query using datediff and the hours were calculated correctly, so the problem seems limited to the display.If this is posted in the wrong place, please let me know so I can repost correctly.Cheers,KatrinaCreatedTimefield in a tablecontrol is limited to 1 second, in a normal control to 0 secondThe bug doesn't appear only in a tablecontrol. It could be also found in a normal timefield.All values of a timefield in a tablecontrol were shown as "00:00" when chosen hours:minutes.Values in a normal timefield don't show any value when you open the form.Createdcom.sun.star.util.Time has been changed in LO 4.1.0 - could this give a hint?Tests with Windows give the same result. Timefield is broken in LO 4.1.0.4. Attachment is one hint from the german libreoffice-forum:CreatedTimefield and time in a formatted field for a timestamp are brokenHave readAnd the had a look at the timestamp. Its the same behavior in a formatted field with a timestamp - Time is shown as 00:00Hello Lionel,The input of time through a form is broken. Could you please have a look? or do you know someone else, who is working on form-controls in Base?Many thanks for all what you are doing for Base.RegardsRobertI will open a new bug. The time in the formatted field is broken in 4.1, not in 4.0are obsolete for this bug-report.Seems to be I am a little bit confused by testing all this versions. With LO 4.0.4.2 all the fields work right - seeThe timefield is first broken in LO 4.1.0.0.beta1. Version inis wrong.The time in a formatted field (timestamp) is first broken in LO 4.1.0.2. This is right inFix is at, but raises issues, so to be discussed.Lionel Elie Mamane committed a patch related to this issue.It has been pushed to "master":fdo#67235 adapt form control code to time nanosecond API changeThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Lionel Elie Mamane committed a patch related to this issue.It has been pushed to "master":fdo#67235 adapt form control code to time nanosecond API change, step 2The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Lionel Elie Mamane committed a patch related to this issue.It has been pushed to "master":fdo#67235 adapt form control code to time nanosecond API change, step 3The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Lionel Elie Mamane committed a patch related to this issue.It has been pushed to "libreoffice-4-1":fdo#67235 adapt form control code to time nanosecond API changeIt will be available in LibreOffice 4.1.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***
id=67801	CreatedScreenshot; no red underline, buggy title and incorrect spellcheckHow to test:* Open Writer* Make sure AutoSpellCheck is enabled (see Toolbar)* Type some random words like "maijfsdqfn, nvqfjghqg"Behavior: no red line under the 'incorrect' words* Go to 'Spelling and Grammar' (via toolbar, or F7, or Tools > Spelling and Grammar)Behavior: you'll receive a message "The spellcheck is complete."Also notable is the buggy title of the Spelling and Grammar window (see screenshot). $LANGUAGE($LOCATION)Tested using Windows 8, with Version: 4.2.0.0.alpha0+Build ID: 087a610fcd5c0c354a9ed6bfccd3451b667d62a3TinderBox: Win-x86@6-debug, Branch:master, Time: 2013-08-04_21:41:24Joel already confirmed this bug with a build of 2013-07-11 Indeed - confirmed on W8CC'ed a couple people that we though would want to be well aware of this one.Is this reproducible for anyone not on windows ?(In reply to)This one is reproducible with 4.1 too, see.Hmm...caolan->jorendc: What windows install sets are you using ? e.g. is it this onebecause if so it appears that one simply doesn't have the dictionaries included which would explain that.Caolan, yes this seems to be the problem, as it's the tinderbox Win-x86@6-debug build. So marking this as NOTABUG. The $LANGUAGE($LOCATION) thing got already fixed.
id=67571	Createdattached is the original documentProblem description: Steps to reproduce:1. File -> save as...-->xls file format2. When I open with Excel it says "File error: data may have been lost" 3. The file in open in Excel, but it is with messed formulas and looks different than the originalCurrent behavior: bad Expected behavior: to be able to open on excel computer with correct formulas Operating System: Windows XPVersion: 4.1.0.4 release Thank you for your bug report, I can reproduce this bug running LibreOffice Version: 4.1.0.4Build ID: 89ea49ddacd9aa532507cbf852f2bb22b1ace28 on Mac osx 10.8.4. I didn't use Excel but I saved it to .xls and reopend it and it was messed up.Hi Georgi / *Any idea if this is a new problem, or if the problem happens in earlier versions too?Also: any idea whitch formulas causes the problems?Thanks,Cor(In reply to)Hello Cor,I don't know if this was happening in earlier versions - it is just the first time I've tried it with the latest one 4.1.0.4To come to your second question - I saw that the formula in column X is wrongly copied in some rows from column Z to the right and thus replacing there the original formulas as they are defined in the ODS fileRegards,Georgi(In reply to)Actually when I set the option "Treat empty strings as zero" to "True" it looks better, but still it is messed up with some formulas looks like it cannot handle #N/A value.I think this is the problematic formula: =IF(ISNA($G16);"";IF(INDEX($data.$A$2:$T$5009;$G16;H$2)=0;"";INDEX($data.$A$2:$T$5009;$G16;H$2)))the program replaces this formula =MATCH(A42;$data.$A$2:$A$5009;0) with something else like "=AT42" hope this will helpGeorgiSaving to binary .xls format omits to save formula expressions of ALL cells where the formula result is an error, corrupting the BIFF record structure of a .xls file.Simple steps to reproduce:New document.A1: =1/0 => #DIV/0!Save as .xlsReload.A1 contains an empty formula, only = character.This is serious data loss.***has been marked as a duplicate of this bug. ***Eike Rathke committed a patch related to this issue.It has been pushed to "master":resolved fdo#67571 write flags and formula token array againThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Pending reviewfor 4-1 asfor 4-1-1 asEike Rathke committed a patch related to this issue.It has been pushed to "libreoffice-4-1":resolved fdo#67571 write flags and formula token array againIt will be available in LibreOffice 4.1.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.I've downloaded the latest patch from the link, but the program doesn't run well. Probably I'm downloading the correct one?Never downloaded beta before so I'm not sure if I'm doing something wrongRegards,GeorgiEike Rathke committed a patch related to this issue.It has been pushed to "libreoffice-4-1-1":resolved fdo#67571 write flags and formula token array againIt will be available already in LibreOffice 4.1.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.I reported same bug some time ago. If it's fixed with this patch please mark my bug duplicate of this bug.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***indeed works fine in 4.1.1.2Confirmed: in 4.1.1.2 is OK, I just tested it.
id=68220	Problem description: calc crashes on spell checkOperating system: Windows 7 & UbuntuSteps to reproduce:1. open a new calc sheet2. type anything with wrong spelling3. press F7 for spell check4. press "correct" buttonCurrent behavior: libreoffice crashesExpected behavior: Operating System: UbuntuVersion: 4.1.0.4 release Reproducible under both Windows 7 & Ubuntu 13.04, and only if the spelling error isn't located in A1 cell.Createdbacktrace (Ubuntu 13.04)Same for Version: 4.1.1.1Build ID: a990db030b8125868501634ff662be1d89d0868on Windows 7Can confirm Maxim's comment that crash only occurs if the spelling error isn't located in A1 cell.This also crashes Libreoffice 4.1.0.4 under Debian 7.1Here is what happened when running soffice in gdb:Program received signal SIGSEGV, Segmentation fault.0x00007fffd1d55437 in (anonymous namespace)::lclCloneCell(ScBaseCell const&, ScDocument&, ScAddress const&, int) () from /opt/libreoffice4.1/program/../program/libsclo.soI think is the right fixCaolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-1":Resolves: fdo#68220 wrong index into source tableIt will be available in LibreOffice 4.1.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Createdtried under Windows7......... spell check work OK for /me under Windows 7, LO version 4.1.0.4Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-1-1":Resolves: fdo#68220 wrong index into source tableIt will be available already in LibreOffice 4.1.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.The bug reappeared in Version: 4.2.0.1indeed, crashes for me too in 4.2.0.1Please file a new bug for this. 4.1 and 4.2 have enough differences that we can't assume it's the same bug.Hi Kohei Yoshida,filed a new bug for thisThanks
id=68512	Starting with buildVersion: 4.2.0.0.alpha0+Build ID: 45ef1eda9e8851d454237d91b7fc46299fd621ebTinderBox: Win-x86@6-debug, Branch:master, Time: 2013-08-23_07:32:04the Open button and the command File Open stopped working. Opening previously opened files does work.Workaround: check the "Use LibreOfficeDev dialogs" option under LibreOfficeDev > General ***has been marked as a duplicate of this bug. ***The program has lost integration with Windows Explorer between 21th and 23th August.This version: master/Win-x86@6-debug/2013-08-21_20.26.24/ - worked good.NOT reproduced with both following versions on Windows 7:Version: 4.2.0.0.alpha0+Build ID: e926621fb00f31471b0037d7955b6a3d7f908dc0TinderBox: Win-x86@6-debug, Branch:master, Time: 2013-08-24_03:41:23Version: 4.2.0.0.alpha0+Build ID: a6a06e0f23a6aced46b9f0b899cd81bd8d2f2decTinderBox: Win-x86@6-debug, Branch:master, Time: 2013-09-01_22:18:41Pedro, ape: Which Windows version are you using?(In reply to)Windows XP Pofessional last update:- NT-5.1_sp3 RUS 32-bit Edition- NT-5.2_sp2 ENU 64-bit EditionOS: Windows XP 32&64 bitLibreOfficeDev Version: 4.2.0.0.alpha0+Build ID: a8865e5df62b5f33aa769d459b9823eb5b110d4bTinderBox: Win-x86@6-debug, Branch:master, Time: 2013-09-03_14:36:22--I do not see errors in the latest version of the software. So is "RESOLVED".
id=68746	Createdbt wizard embedded firebird db creationUsing build Version: 4.2.0.0.alpha0+Build ID: d9b62a48d75e596888fcf10f5f73fed93e7b88a3This is a 64bit debug build.The Base wizard crashes on firebirddb creation, at the last step, i.e. where it is supposed to save the ODB file.Enclosed backtrace. Commit a1d2668c193e99044ac77d171eac651c0ad4c263 or later are needed for firebird to work on OSX (that's one commit after the one you are on) -- hopefully that should fix the issue.(Additionally commit 295759c05395099e564e263b98e5e4a38a9a9bc4 is needed if you are running libreoffice in sandboxed mode.)Created2nd full btThis bt seems to be different to the first one I posted and yet it is with the same build.(In reply to)OK, thanks, will rebuild after pull and report back.AlexOk, after a fresh pull and rebuild, I don't get a crash any more. LO tries to open the recently created file and then displays the following error :The connection to the data source "New Database9" could not be established.Error code :1firebird_sdbc error"Can't access lock files' directory"file:///var/folders/47/7s51p5_d5tq7yvfs0r8t_g0h0000gn/T/firebirdcaused by 'isc_create_database'But at least it doesn't crash any more ;-)Alexgdb points to the following :warn:connectivity.firebird:25772:1:connectivity/source/drivers/firbird/Util.cxx:51(In reply to)Yes -- I messed up the sandboxing tmp-dir fix, commit 819b72bb03b2be368790d6e603f282ec6ea72ab4 should hopefully deal with that -- thanks for reporting!AndrzejAndrjez,your fix did the trick, thanks.Closing.Alex
id=69164	Problem description: Impress presentation was working perfectly under 4.0.4.2. After upgrading to 4.1.1.2, any changes will cause a crash when trying to save. Steps to reproduce:1. Load old presentation - 4.02. Edit presentation.3. Attempt to save presentation with changes.Current behavior:Impress (All libre office components that are open) crash requiring restart.Expected behavior:Save and continue. Operating System: Windows 7Version: 4.1.1.2 rc is there a specific Impress that makes it crash or any file causes the crash?is the crash happening just with old 4.0 files or even with brand new 4.1 files?Ray: could you attach an example file so we can try to reproduce?Createdattachment-25411-0.htmlG'Day Julien,Thanks for being so diligent. I have checked several files and some crash and some don't. I can't seem to find a specific pattern. Many of the files were created with much earlier versions of LibreOffice and some go back to a time when I was using Open Office, probably a version of 3. The file I am attaching crashes EVERY time I try to save any change and it also crashes at random times when I am just advancing through the presentation as a slideshow.Thanks again for the help.RayWilliamsP.O. Box 5Klemzig, SA 5087, AustraliaPhone: 61-8-8367-6904 Mobile 61-40-348-8761www.TEAM Logoteam.orgwww.australia.team.orgOn 12/09/2013 5:26 AM,wrote:>>>Createdceheaihb.pngCreatedattachment-25411-1.datCreatedattachment-25411-2.datCreatedLecture 6.odpOne other thing about the Impress crashes - I never had this problem with Libre Office 4.0.Thanks again,RayRayWilliamsP.O. Box 5Klemzig, SA 5087, AustraliaPhone: 61-8-8367-6904 Mobile 61-40-348-8761www.TEAM Logoteam.orgwww.australia.team.orgOn 12/09/2013 5:26 AM,wrote:>>>reproduced on 4.1.1.2 and 4.1.0.4 under Win7 64bitsome edits make Impress crash immediately (i.e. try deleting the word "History" from the 3rd textbox at page one). other edits make impress crash only on saving.no crash at all with 4.0.4.2, hence regression.adding Impress expert to CC list.Comment onattachment-25411-0.html>@Rayplease do not reply directly from your mailer but enter the webpage of this bug () since mailer adds unnecessary attachments (which I removed right now) and text to the reportdoesn't happen with my 4.1.x linux build; let's see if I manage to get hold of a debuggable windows one.Createdconsole + bt with symbols on 4.1 sourcesOn pc Debian x86-64 with 4.1 sources updated 3 days ago + brand new LO profile, I reproduced the crash.I just added an "s" at a word of first slide then saved.I attached console logs and bt.And no crash with Debian LO package 4.1.1.2 by following the same scenario.No crash too on MacOS 10.7.5 with LO 4.1.1.2However, I got a similar bt with master sources updated today on pc x86-64 Debian. Now I don't know what to think about this mutex stuff.I have the same problem with LibreOffice 4.3.0.4 on Windows7 64 bit. Impress randomly crashes when editing text. Impress is not usable this way.This is a showstopper bug. Impress is not usable. Ordinary actions such as editing text or resizing a box can cause it to crash without warning.Unable to reproduce crash with attached file, using LO 4.3.2.2 portable under Win7 x86.Adding keywords have-backtrace -> supplied by Julien inOn pc Debian x86-64 with 4.3.2.2 LO Debian package, I don't reproduce this.I put it as WFM.If someone can still reproduce this with last stable LO version (4.3.2), please don't hesitate to reopen this tracker.
id=69218	Problem description: Steps to reproduce:1. Export to PDF2. Hit "OK-Button"3. Select a directory and file4. Hit SaveCurrent behavior:Impress stops with this exception:Process: soffice [11193]Path: /Applications/LibreOffice.app/Contents/MacOS/sofficeIdentifier: org.libreoffice.scriptVersion: 4.1.1.2 (???)Code Type: X86 (Native)Parent Process: launchd [232]User ID: 501Date/Time: 2013-09-11 12:21:00.690 +0200OS Version: Mac OS X 10.8.4 (12E55)Report Version: 10Interval Since Last Report: 33318 secCrashes Since Last Report: 2Per-App Crashes Since Last Report: 2Anonymous UUID: 4D880CE5-E74A-5852-7639-17C7B8F664FBCrashed Thread: 0 Dispatch queue: com.apple.main-threadException Type: EXC_BAD_ACCESS (SIGSEGV)Exception Codes: KERN_INVALID_ADDRESS at 0x000000007473346eVM Regions Near 0x7473346e: MALLOC_TINY 0000000024f00000-0000000025000000 [ 1024K] rw-/rwx SM=PRV --> __TEXT 000000008febc000-000000008feef000 [ 204K] r-x/rwx SM=COW /usr/lib/dyldApplication Specific Information:objc_msgSend() selector name: releaseThread 0 Crashed:: Dispatch queue: com.apple.main-thread0 libobjc.A.dylib 0x9a415a8b objc_msgSend + 271 com.apple.CoreFoundation 0x9356131b CFRelease + 1712 libvcllo.dylib 0x01a57162 CTTextStyle::~CTTextStyle() + 503 libvcllo.dylib 0x01a5a2cd AquaSalGraphics::SetFont(FontSelectPattern*, int) + 294 libvcllo.dylib 0x0189c643 OutputDevice::ImplInitFont() const + 1475 libvcllo.dylib 0x018aab61 OutputDevice::ImplLayout(rtl::OUString const&, long, long, Point const&, long, long const*, bool) const + 7056 libvcllo.dylib 0x0191ad02 vcl::PDFWriterImpl::drawTextArray(Point const&, String const&, long const*, unsigned short, unsigned short, bool) + 1147 libvcllo.dylib 0x018eca90 vcl::PDFWriter::DrawTextArray(Point const&, String const&, long const*, unsigned short, unsigned short) + 648 libvcllo.dylib 0x018f1e8c vcl::PDFWriterImpl::playMetafile(GDIMetaFile const&, vcl::PDFExtOutDevData*, vcl::PDFWriter::PlayMetafileContext const&, VirtualDevice*) + 51169 libvcllo.dylib 0x018f2268 vcl::PDFWriterImpl::playMetafile(GDIMetaFile const&, vcl::PDFExtOutDevData*, vcl::PDFWriter::PlayMetafileContext const&, VirtualDevice*) + 610410 libvcllo.dylib 0x018ebf20 vcl::PDFWriter::PlayMetafile(GDIMetaFile const&, vcl::PDFWriter::PlayMetafileContext const&, vcl::PDFExtOutDevData*) + 4811 libpdffilterlo.dylib 0x1d978d65 PDFExport::ImplExportPage(vcl::PDFWriter&, vcl::PDFExtOutDevData&, GDIMetaFile const&) + 56512 libpdffilterlo.dylib 0x1d97b21c PDFExport::ExportSelection(vcl::PDFWriter&, com::sun::star::uno::Reference<com::sun::star::view::XRenderable>&, com::sun::star::uno::Any const&, StringRangeEnumerator const&, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue>&, long) + 335613 libpdffilterlo.dylib 0x1d97dfb0 PDFExport::Export(rtl::OUString const&, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) + 1019214 libpdffilterlo.dylib 0x1d989035 PDFFilter::implExport(com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) + 469315 libpdffilterlo.dylib 0x1d989917 PDFFilter::filter(com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) + 8716 libsfxlo.dylib 0x0070876a SfxObjectShell::ExportTo(SfxMedium&) + 367417 libsfxlo.dylib 0x0070f792 SfxObjectShell::SaveTo_Impl(SfxMedium&, SfxItemSet const*) + 696218 libsfxlo.dylib 0x00712ad7 SfxObjectShell::PreDoSaveAs_Impl(String const&, String const&, SfxItemSet*) + 93519 libsfxlo.dylib 0x007134f2 SfxObjectShell::CommonSaveAs_Impl(INetURLObject const&, String const&, SfxItemSet*) + 208220 libsfxlo.dylib 0x006fb2f3 SfxObjectShell::APISaveAs_Impl(String const&, SfxItemSet*) + 53121 libsfxlo.dylib 0x0073f2ca SfxBaseModel::impl_store(rtl::OUString const&, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&, unsigned char) + 204222 libsfxlo.dylib 0x00749ab6 SfxBaseModel::storeToURL(rtl::OUString const&, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) + 27823 libsfxlo.dylib 0x006dea11 SfxStoringHelper::GUIStoreModel(com::sun::star::uno::Reference<com::sun::star::frame::XModel>, rtl::OUString const&, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue>&, unsigned char, rtl::OUString, unsigned short) + 406524 libsfxlo.dylib 0x006fcb49 SfxObjectShell::ExecFile_Impl(SfxRequest&) + 536925 libsfxlo.dylib 0x0082c3a8 SfxDispatcher::Call_Impl(SfxShell&, SfxSlot const&, SfxRequest&, unsigned char) + 36026 libsfxlo.dylib 0x00595183 SfxBindings::Execute_Impl(SfxRequest&, SfxSlot const*, SfxShell*) + 9927 libsfxlo.dylib 0x005cc5b5 SfxDispatchController_Impl::dispatch(com::sun::star::util::URL const&, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&, com::sun::star::uno::Reference<com::sun::star::frame::XDispatchResultListener> const&) + 402128 libsfxlo.dylib 0x005cd635 SfxOfficeDispatch::dispatch(com::sun::star::util::URL const&, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) + 34129 libfwklo.dylib 0x0f962964 framework::GenericToolbarController::ExecuteHdl_Impl(framework::GenericToolbarController*, framework::ExecuteInfo*) + 5230 libvcllo.dylib 0x01a55acd ImplWindowFrameProc(Window*, SalFrame*, unsigned short, void const*) + 633331 libvcllo.dylib 0x01a629d8 AquaSalInstance::Yield(bool, bool) + 31232 libvcllo.dylib 0x01723d94 Application::Yield(bool) + 8433 libvcllo.dylib 0x01723e4c Application::Execute() + 6034 libsofficeapp.dylib 0x0006f29a desktop::Desktop::Main() + 764235 libvcllo.dylib 0x0172a1f2 ImplSVMain() + 22636 libvcllo.dylib 0x01a61a21 AquaSalInstance::handleAppDefinedEvent(NSEvent*) + 12937 libvcllo.dylib 0x01a9dcfb -[VCL_NSApplication sendEvent:] + 31538 com.apple.AppKit 0x97e9f62c -[NSApplication run] + 95139 com.apple.AppKit 0x97e425f6 NSApplicationMain + 105340 libvcllo.dylib 0x01a622e7 ImplSVMainHook(int*) + 34341 libvcllo.dylib 0x0172a22a SVMain() + 2642 libsofficeapp.dylib 0x0009d765 soffice_main + 32543 org.libreoffice.script 0x00001f4e main + 3044 org.libreoffice.script 0x00001f25 start + 53Expected behavior:Create a PDF of my presentation.Operating System: Mac OS XVersion: 4.1.1.2 release bernd:- do you reproduce this with any file, in particular with a brand new file just containing the word "test" for example? (without formatting, charts, image, etc.)- did you install any specific font?Createdidee5 template with "//" as text crashing the pdf exportHaving done some tests I were able to reduce it to the attached file.Creating a new file without formatting and "//" as text works as expected.I use Century Gothic and Georgia. Web safe fonts. Nothing fancy.Confirming, enclosing crashtraceAll of these bugs appear to have the same CF/coretext release threads.AlexCreatedexport to pdf crash traceregression over 4.0.5Nominating as blocker***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***I can not reproduce the crash on my master 4.2 buildTested with ODP from this bug, and ODT from, and LO no longer crashes on PDF export with my 4.2 master build.Setting as WORKSFORME on master, but no idea whether the fix (which at present is unidentifiable) has been backported to the next release version of LO.Alex***has been marked as a duplicate of this bug. ***I tested the attachment fromin 4.1.1.2 on Ubuntu and was fine there.
id=69406	How to reproduce :1) Open an ODB file that connects to a Mac Addressbook.2) Click on Tables3) Crash.GDB says :warning: Tried to remove a non-existent library: /Applications/LibreOfficeDev.app/Contents/MacOS/libfirebird_sdbclo.dylibwarn:cppuhelper:29471:1:cppuhelper/source/shlib.cxx:503: loading component library failed: file:///Applications/LibreOfficeDev.app/Contents/MacOS/../MacOS/libfirebird_sdbclo.dyliblibc++abi.dylib: terminate called throwing an exceptionProgram received signal SIGABRT, Aborted.0x00007fff918ae212 in __pthread_kill () Adding Lionel, Julien, Andrzej to CCRegression over 4.1.1.2@ahunt: this seems related to issues of the firebird sdbc driver on Mac? It complains about not being able to load libfirebird_sdbclo.dylib, I guess this leads to a crash before the MacAB driver is even tried?When the ODB is loaded, I see this in gdb :warn:xmloff.core:10469:1:xmloff/source/core/xmlimp.cxx:848: exception caughtwarn:legacy.osl:10469:1:xmloff/source/core/xmlimp.cxx:849: caught an exception!in function:virtual void SvXMLImport::setTargetDocument(const uno::Reference<lang::XComponent> &)type: com.sun.star.lang.NotInitializedExceptioncontext: N8dbaccess17ODatabaseDocumentEwarn:xmloff.core:10469:1:xmloff/source/core/xmlimp.cxx:848: exception caughtwarn:legacy.osl:10469:1:xmloff/source/core/xmlimp.cxx:849: caught an exception!in function:virtual void SvXMLImport::setTargetDocument(const uno::Reference<lang::XComponent> &)type: com.sun.star.lang.NotInitializedExceptioncontext: N8dbaccess17ODatabaseDocumentEwarn:xmloff.core:10469:1:xmloff/source/core/xmlimp.cxx:848: exception caughtwarn:legacy.osl:10469:1:xmloff/source/core/xmlimp.cxx:849: caught an exception!in function:virtual void SvXMLImport::setTargetDocument(const uno::Reference<lang::XComponent> &)type: com.sun.star.lang.NotInitializedExceptioncontext: N8dbaccess17ODatabaseDocumentEThen when I click on the Tables button, I see the following :warning: Tried to remove a non-existent library: /Users/Shared/Repos/LO/core/instdir/unxmacxx/LibreOfficeDev.app/Contents/MacOS/libfirebird_sdbclo.dylibwarn:cppuhelper:10469:1:cppuhelper/source/shlib.cxx:503: loading component library failed: file:///Users/Shared/Repos/LO/core/instdir/unxmacxx/LibreOfficeDev.app/Contents/MacOS/../MacOS/libfirebird_sdbclo.dyliblibc++abi.dylib: terminate called throwing an exceptionPulled a full bt on the stack, and enclosed it.Createdwarnings and full bt(In reply to)This is usual / unrelated.When trying to open a sdbc: URL, LibreOffice asks each driver in turn whether it can handle this URL. My guess is that the firebird driver is asked before the macab driver and the firebird-sdbc driver on Mac has problem that makes it abort the whole LibreOffice before macab is tried.***has been marked as a duplicate of this bug. ***I haven't done anything to do with library naming/loading recently -- when is this build from? There's a vague possibility that this was a temporary breakage to do with the instdir changes (but they were apparently wrapped up by Thursday 12th/Friday 13th.The bt in the related bug suggests that multiple drivers are affected which would support this -- if this persists in more recent builds I guess this would be an accidental breakage related to packaging from instdir builds (unit-tests are running fine on the mac tb's afaict, so the fault would seem to be creeping in later).Version: 4.2.0.0.alpha0+Build ID: 0618b35ebda29b911058254cd34620e8b24ab8f7from 23/09/2013The problem is still there :warn:cppuhelper:30055:1:cppuhelper/source/shlib.cxx:503: loading component library failed: libfile:///Applications/LibreOfficeDev.app/Contents/MacOS/../MacOS/libhsqldb.jnilib.dyliblibc++abi.dylib: terminate called throwing an exceptionfull bt attachedCreatedfull bt after clicking on Table button in Mac addressbook odbFurther testing reveals that the crash occurs with any ODB file, as soon as the Tables button is pressed. Corrected title accordingly.(In reply to)That "libhsqldb.jnilib.dylib" problem is fixed since <> "Special-case Mac OS X .jnilib" (but I cannot currently verify whether that fixes the root problem of this issue).(In reply to)Yes, it does.
id=69412	CreatedShort document containing some tables and equations.Open the file with Writer. Press the button to export the file to PDF, LibreOffice crashes. Not reproducible with 4.1.2.1 under Win7x64 - Mac only?Confirming on OSX LO 4.1.1.2Changing status to blocker and marking as regressionAlexAdding Tor, David to CCAny idaes ?AlexRegression over 4.0.5Createdpdf export apple crash traceFWIW, I experience similar PDF export crashes currently every time I use Writer LO 4.1.1.2 for my business work with a document that contains no header, a footer containing an inserted table in 3 columns, and a single image inserted on the final page, anchored to the page, with continuous background wrap attribute.Alex*** This bug has been marked as a duplicate of***
id=69458	Createdquery designer btHow to reproduce :1) Open a ODB file that uses embedded hsqldb2) Click on Queries3) Click on Query DesignerCrash.Backtrace enclosed. Adding Andrzej, Lionel, Julien to CC*** This bug has been marked as a duplicate of***
id=70828	CreatedScreenshotError 1335 accured during the Installation procces. Cabinet file "libreoffice1.cab" is corrupted.I've download the installation file twice, and ran it several times.System: Windows XP SP3 Professional, Hebrew localized. Hi,Could you please try to download from another mirror? Here is a list of mirrors:Also please right-click on the file in Explorer, choose 'Properties', open 'Digital Signatures' tab, and click on 'Details'. You should get a new window with the text 'This digital signature is OK.'. If it's not the case, or you don't have the 'Digital Signatures' tab at all, then your installation file is corrupted.Hi Maxim,I've download from another mirror (IL), and it works fine. Anyway, the digital signature of the previous installation file is indeed OK.Thanks for your assistance.
id=70210	CreatedSample document to demonstrate the issueWhen saving/loadinig a presentation/drawing with connectors, all the connectors skews are lost. Older documents with connectors formatted with line skew are corrupted by losing the connector formatting in load/save/load cycle.To demo the issue:1) Load the attached document test.odp2) Right click on the lower connector and open the connector properties. See that all the line skews are at 0.3) Change the line skews, so that for line 1 it is 1cm and for line 3 it is -0.60 cm4) Save the document5) Reload the document and visually see that the connector line skews have changed6) Right click on the lower connector and open the connector properties. See that all the line skews have been reset at 0.To me, this is a major issue:1) Means that draw/impress cannot be used anymore to draw block diagrams and flow charts properly2) Means that libreoffice now corrupts drawings/presentations in load/save/load cycle3) Means that all older docs when opened with newer libreoffice and resaved get corrupted and lose connector formattingI'm rather sure that openoffice in the past used to manage connector skews properly. Probably also past versions of libreoffice did it right, so this is definitely a regression. However I would not be able to say which versions of openoffice/libreoffice were correct.In any case, this is a regression shared also by openoffice 4.0. Maybe it was 'imported' together with changes introduced with openoffice 4.The bug is seen in Linux on an X86-64 Kubuntu raring machine, with libreoffice packages downloaded from the libreoffice site. But probably the bug applies to all hardware platforms and OSs. Update.Bug is confirmed and actually fixed for Openoffice. Fix is in Openoffice 4.0.1.By simultaneously using libreoffice and openoffice 4.0.1, one can conclude that libreoffice /saves/ the skews correctly, but ignores them (or resets them) on loading the files.Please, port the Openoffice fix asap! I realized about this issue late and already I have many many presentations to check for corruption.One more note about why this bug is quite serious.Say that you have >100 presentations and that you have drawings in them where you use connectors (e.g. electronic schematics, where connectors are a handy way to do wires since they let things stay connected when positions of component are slightly rearranged, or diagrams or flowcharts).Say that for some reason you need to change an affiliation in the first slide.So, you open the documents one by one, you go to the first slide, you fix the affiliation, you save. Since you are just fixing something in the first slide, you do not even look at the other ones.One month later you realize that many of your diagrams in all your >100 presentations are now broken.A side note. LibO should probably have automatic testing in place for this kind of LOAD/SAVE consistency issues. It can probably suffice to have some test docs for which doc is just opened and re-saved without any editing and then the saved doc is compared to the original test document for differences.The same bug is tracked in OpenOffice (and has been fixed there) atHi.. It's possibly duplicate to one of these bugs:Fixed bug title.One can easily verify, by comparing with Apache Openoffice, that the bug is just in the file open path.From the number of duplicates it seems like this is a problematic issue to many.Note that in Apache this was considered a release blocker.Fix inplease port for 4.1.3.See also***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***I have changed the platform to all as this affects both Linux and Windows, updated the importance to high as this 'damages' existing documents for other users.***has been marked as a duplicate of this bug. ***Apparently 4.1.3 RC2 is out with no fix for this issue.Is a 4.1.3 RC3 being considered?I wish that LO QA could consider this bug a release blocker as Apache Openoffice QA did.Please, consider once more that the current behavior means that you open a document and when you save it again (regardless whether it was modified or not), the document gets corrupted.With this issue, Libreoffice is not just misrendering draw/impress documents, it is actively destroying people's work and in a very subtle way (user changes title in first slide and the 100 following slides have their diagrams made useless when he saves). User may realize at the very important presentation of his life. This may mean throwing away users' manmonths work. I spent the last day fixing back some slides of mine using AOO.This bug is also a major problem for me as it has corrupted a number of business documents I have. I would urge someone to pick it up as soon as possible.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***If I didn't make mistake reproducing, it's not reproducible on LO 4.0.6.2 (Win7 32bit). Maybe regression occur in 4.1.xI can confirm, this does not seem to be an issue on 4.0.6.However, on that version there seems to be a bug where a connector with 2 skew lines initially doesn't show all handles after loading (and the one handle it does show is moving in the wrong direction). When I try to make a change to such a connector, the routing is reset and then works as expected after that. I also noticed that the connector dialog for such a connector has the line skew settings disabled.A connector with 1 skew line seems to have no problems at all on 4.0.6. I have not tested connectors with 3 skew lines.So it's not perfect on 4.0.6, but I would call it an annoyance.The fact that the release notes of 4.1.3 do not even mention the possibility of ruining existing documents may get judged as unfortunate by some users. Particularly, because 4.1 is now indicated as 'recommended'.Please, at least update the release notes.This is, arguably, one of the most pressing bugs in Draw (perhaps all of LibreOffice) as it, effectivly, shuts down Draw's ability to be used for anything but the most basic diagrams. This has been around for months (at least) and needs to be fixed.SeanI would like to underline again that it is even worse than that.I would not complain this loudly if for some versions of LibO there was no draw and impress at all or if it was simply unusable.The problem is that this defect makes LibO /appear/ useful, while it is in fact actively destroying a potentially large amount of previous document preparation work from the users. I am still through reconstructing my slides with LibO 4.0 and AOO 4.0.1. This is a huge issue, and the most damaging thing that could be done to the perception of LibO and free software. People biten by this issue may make the association 'It's free so it is risky. I must expect that it can deteriorate my data in unpredictable ways.'.Hence, again. Please, put a warning in the release notes for the 4.1 series until this is fixed.***has been marked as a duplicate of this bug. ***Looks like it is fixed (backported from AOO)Can someone verify this, tested using a master-build?This fix is _NOT_ backported (yet) to 4.1 branch. I'm not sure it's possible to do. But please test first on master branch :).Kind regards,JorenI have changed the status to blocker as I feel that 4.1.4 should not be released without addressing this issue, owing to the fact it 'damages' existing documents for other users. I am slightly disappointed that this bug has not received an official LO developer reply, to say it was posted in October and has such an impact.I can verify that the bug is fixed in master build. Tested on 4.2.0.0.alpha1+, MacOSX. Tested with the bug attachment document and some other documents.I cherry-picked the fix to libreoffice-4-1 branch.Seems unmentioned inIs the fix actually getting in 4.1.4?(In reply to)It must be my mistake, I did not push it, or something like this. Now it requires more reviews on gerrit, for 4.1.4 rc2.Thanks for the clarification.Please, do all that is possible so that it actually gets in 4.1.4 RC2 since having LO silently ruin documents even in 4.1.4 would be really bad.Also, please try to assure that it gets some visibility in the release notes, since this time I really think that people who are on 4.1 *must* upgrade.***has been marked as a duplicate of this bug. ***The fix will be in LibreOffice 4.1.4.***has been marked as a duplicate of this bug. ***Excellent news that the fix is in! Thanks.Just updated to 4.1.3.2 on Fedora 19 x64 and the bug appears to be fixed!Hi, I have 4.1.3.2 on Windows 7 and this has the issue. Did (Sean) mean to say he tried 4.1.4 RC2 and it was fixed?It is fixed in 4.1.4 RC2. See alsoand particularly note i#123048 line skew parameter is not read from file for connectors in OO draw [Armin Le Grand].Thanks Andras for taking care of this!***has been marked as a duplicate of this bug. ***David Clayton: I just double checked and I am running 4.1.3.2-11.fc19 on an x64 machine and it is fixed.***has been marked as a duplicate of this bug. ***
id=70664	CreatedPictures couldn't be saved in a table created by the GUITake the attachment. There is one table, created by the GUI. One filed of this table is a field with the type BLOB.I have created a form by the wizard. The wizard creates a field for input of a picture, but the BLOB of the table doesn't save the picture.The BLOB doesn't seem to be the BLOB SUB_TYPE 0 (or BLOB SUB_TYPE BINARY). So it isn't possible to create a table with the GUI, which could save pictures. Have now tested it with a Tools → SQL in the direct mode.create table MyPictures (id int not null primary key,title varchar(40),description varchar(200),picture blob sub_type binary);The table is created, but the filed picture doesn't save any picture.So it is impossible to save any picture in the internal Firebird database.Confirming on Linux 32 bit Ubuntu 13.04Version: 4.2.0.0.alpha0+Build ID: 6dd844917205a051c880ff7609c28e09698770c8As this is functionality which currently works in HSQLDB via the UI, I don't think we should be releasing Firebird integration if this doesn't work. AlexIn the GUI, the user isn't given a choice as to the type of BLOB subtype when in Table edit/creation mode.If a form is built based on a table containing id INT NOT NULL PRIMARY KEYpic BLOBwhich is all that the GUI provides for, then a form can be built on that and by default, double-clicking on the control that maps to the image field will open the file manager and allow a user to insert an image, with a preview. The image then gets displayed in the control on the form.However, saving the record, or moving to a new record and then back again, removes the image from the display, even though the data is referenced as an <OBJECT> in the underlying table.AlexAdd repro info to whiteboardAndrzej Hunt committed a patch related to this issue.It has been pushed to "master":fdo#70664 Implement Blob writing (firebird-sdbc).The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Andrzej Hunt committed a patch related to this issue.It has been pushed to "master":fdo#70664 Allow reading firebird Blob as InputStream.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Andrzej Hunt committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#70664 Implement Blob writing (firebird-sdbc).It will be available in LibreOffice 4.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Andrzej Hunt committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#70664 Allow reading firebird Blob as InputStream.It will be available in LibreOffice 4.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=71321	Problem description: in Version: 4.2.0.0.alpha1Build ID: c2b9ad37f8a8de9c7dbdd76c86aecf6388107056you can not scroll down in Writer or Calc, you can scroll up but not downSteps to reproduce:1. open Writer or Calc and try to scroll down2. ....3. ....Current behavior: nothing happensExpected behavior: scroll down Version: 4.2.0.0.alpha1Build ID: c2b9ad37f8a8de9c7dbdd76c86aecf6388107056Operating System: Mac OS XVersion: 4.2.0.0.alpha0+ MasterLast worked in: 4.1.3.2 rc os: mac osx 10.9Dangit, I can reproduce this behavior, tested using Mac OSX 10.9 with LibreOffice Version: 4.2.0.0.alpha1Build ID: 496e2be9dd6eb96d120d412760422eaa904b7f71Going to nominate as MAB4.2side note: The only way to scroll down is to drag the scrollbar down. Scrolling up isn't affected.Thomas, Joren: where do you find those alpha builds? You are all building them yourself?(In reply to):)#libreoffice-dev:***has been marked as a duplicate of this bug. ***Raising to high. Is this isn’t high or even highest I don’t know what would be.The bot isn't auto-commenting on the bug when a commit is made related to this bug.Thanks to Tor during the week-end:Not tested yet.Kind regards and thanks for your work related to OSX and other parts in LibreOffice Tor! Much appreciated :)Kind regards,JorenThanks to the OS X nightly back in working state I'm able to verify this fix (first nightly since the old nightly machine died :)Tor, thanks so much this was a real road-blocker.Setting to RESOLVED FIXED.Migrating Whiteboard tags to Keywords: (regression)[NinjaEdit]
id=71348	Hello,Scrolling does not work on 4.2.0 Alpha. It is not possible scroll through any document neither with trackpad nor mouse. Setting this as a blocker. OS X 10.7.5 - Version: 4.2.0.0.alpha1 Build ID: c2b9ad37f8a8de9c7dbdd76c86aecf6388107056 To bad, to late :) ;-)*** This bug has been marked as a duplicate of***
id=71648	Problem description: Steps to reproduce:1. Start LibreOffice2. Choose Menu -> Options3. LibreOffice Base -> Connections or -> DatabasesCurrent behavior:LibreOffice crash with no message no error. I can reproduce problem on 2 PC's and 1 laptop all running OpenSuse 12.3Expected behavior:Open Databases option to register existing databases. Operating System: openSUSEVersion: 4.1.3.2 release Same system here: OpenSUSE 12.3 64bit rpm. No problems to register any database with LO 4.1.3.2 release, also with other LO-Versions.Where did you get 4.1.3.2 from?Have you tried to rename in your home-directory .config/libreoffice/4 ? It would be reinstalled when you restart LO ...Btw I run also 12.3 64bit on all my PC's. Sorry I forgot to specify it.Yes I tried to rename or delete ./config/libreoffice/4 and result is the same.I got 4.1.3.2 with update from OpenSuse yesterday evening from this repo I guess URL :It says 4.1.3.2 build id 410m0 Build 2 supplied by SUSE.I tried tonight on 2 other PC (in total I tried on 5). Result tonight is :first one running LO 4.0 build 305 build id 400m0 and result is the same crash. I upgraded it to 4.1.3.2 and result is the same it crash.second one running LO 4.1.3.2 build 2 build id 410m0 and it's working fine. What I noticed on this PC is that existing DB I use are already registered there. So when I go to Options -> Databases it works fine because list is not empty I guess but not sure.For all the others where it's failing and crash I guess the list of registered DB is empty. Of course I can't be sure of it as I can't see the list of registered DB there by default like Bibliography. But my guess is it's empty. Again not sure.Do you know if there is a way to register an entry in other way than with Options -> Databases in GUI ?I could delete the entire list and see if with an empty list it fail but sorry it's the onlyPC where it works fine and I need it so I can't do this test. May be you could try ?(In reply to)If you are using the SuSE-version the name of the folder is 4-suse. I have such a folder here in that path, but not the 4.1.3.2 from openSUSE, only 4.1.1.2. from another repo.I have deleted all entries in the register in my LO 4.1.3.2, directly from LO. I restarted 4.1.3.2 and could register new databases.Could you please report the same you reported here to? Seems to be it is a bug of the packages of OpenSUSE.Yes sorry folder is 4-suse but result is the same.On working PC I deleted all registered databases an like you was able to register new one. On all others it crash.I reported the bug where you told me :Thanks for your help.OlivierOlivier: would it be possible you try to retrieve a backtrace by following this link?Julien: it's pity because I had a core this week but I don't have it anymore as I update my PC at work to Opensuse 13.1 and now problem is gone. I still have other PC with Opensuse 12.3 and LO 4.1.3.2 so I will reproduce it when back home. When it crashed java generated a core.I will retrieve back trace for you at home ...I couldn't take a backtrace with the command advised in the link you gave me as LO was hanging staring with : soffice --backtrace. Reproducing my problem I got a core java dump but it's too be and can't be attached to this thread. How can I send it to you ?Olivier: there's perhaps you could try the old manner:- launch LO from a first terminal/console- open a new terminal/console and run this: - LOPID=$(pidof soffice.bin) - gdb soffice.bin $LOPID - type "c" (without quotes) then enterGo back to first terminal/console and reproduce the crash, at the very moment where you should have the crash, there'll be an hanging, at this moment go to second terminal/console and you should see a segfault or something, just type:bt (to retrieve a backtrace)If you got several "?", type c (for "Continue") until another it stops again then try again "bt".CreatedBacktrace LO 4.1.3.2Thanks for your help it worked. Attached is the bt I took as a txt file. Here are information I got from the first console where I started LO.If you need more info please let me know.om03830@om03830n:~> libreoffice## A fatal error has been detected by the Java Runtime Environment:## SIGFPE (0x8) at pc=0x00007f4f99c3f6cf, pid=9229, tid=139981333080512## JRE version: OpenJDK Runtime Environment (7.0_45-b31) (build 1.7.0_45-b31)# Java VM: OpenJDK 64-Bit Server VM (24.45-b08 mixed mode linux-amd64 compressed oops)# Problematic frame:# C [libqt-mt.so.3+0x5916cf] QMutexPool::get(void*)+0x1f## Failed to write core dump. Core dumps have been disabled. To enable core dumping, try "ulimit -c unlimited" before starting Java again## An error report file with more information is saved as:# /tmp/jvm-9229/hs_error.log## If you would like to submit a bug report, please include# instructions on how to reproduce the bug and visit:#Olivier: thank you for your quick feedback! :-) I put it at New since there's a bt.Lionel/Petr: Base (+perhaps OpenSuse specific problem?), any idea?Olivier: for the test, could you give a try to 4.2.4 LO version? (with a brand new LO profile if possible)FYI last 4.1 version is 4.1.6 and there won't be any new official LO 4.1.X version.Olivier: any update with 4.2.6 or 4.3.0 (for the test)?Confirmed on LibO:* Version: 4.4.0.0.alpha0+* Build ID: 65277f994ae25d930c15aebba0ed19f8de0abba1* TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2014-09-29_19:47:20* OS: Ubuntu 14.04.1 x86_64CreatedBacktrace LibO 4.4.0.0.alpha0+ daily build 2014-09-29_19:47:20Backtrace LibO 4.4.0.0.alpha0+ daily build 2014-09-29_19:47:20According to "Prioritizing_Bugs_Flowchart":set importance from medium, normal to highest blocker(In reply to)This does not look like a backtrace... It looks like a gzipped tar of a single gzipped file that contains only binary nulls?CreatedBacktrace LibO 4.4.0.0.alpha0+ daily build 2014-09-29_19:47:20Backtrace LibO 4.4.0.0.alpha0+ daily build 2014-09-29_19:47:20(In reply to)You get a different backtrace than Olivier Musson. Also a backtrace that will happen only in a debug build. You get an unexpected thrown exception, something which is just ignored in a release build, but leads to an abort in a debug build. The interesting information would be which exception thrown from where.Well, anyway, I still cannot reproduce (in my debug build).Also, I now realise that the original reporter said the problem 'disappeared' in a newer version, so actually your (Marina) abort may be a completely different problem and unrelated.(In reply to)Ok, can I provide other informations for my crash? How can I help?Maybe I can fill a new bug report. Let me know.Best,MarinaMarina: do you reproduce this with LO package provided by ppa (see)?Indeed, I think .deb or .rpm provided by TDF is more for Linux distrib packagers to manage dependecies. Since I'm neither a LO expert nor a distrib package, it's just an idea, not a sure thing :-)@Lionelshould Marina open a separate report for her issue or should we keep the discussion here?(In reply to Julien Nabet from)I expect those are not debug (--enable-dbgutil) builds, so the exact problem she reported will not happen; the same actions could theoretically still lead to a different crash/abort, though.(In reply to tommy27 from)Let's fork it into a different bug.Since original reporter (in) wrote that the problem is "gone in OpenSuSE 13.1", I'm going to close this one under presumption that it is fixed, although we don't know in which version exactly.
id=71423	Createdhs_err_pid3856.logAfter one of the last LibreOffice Updates for Ubuntu 13.04, LibreOffice Impress behaves unstable. It crashes very frequently when editing tables in slides. This occurred with several different files on my system.It seems to be a crash related to Java. Please see output below and error log in the attachment.System:Ubuntu 13.04 Gnome3 Shell, 64-BitLibreOffice Version: 4.1.3.2, Build ID: 410m0(Build:2)gerry@host:~$ soffice ## A fatal error has been detected by the Java Runtime Environment:## SIGSEGV (0xb) at pc=0x00007f0bdabccfb4, pid=5856, tid=139688929548800## JRE version: 7.0_25-b30# Java VM: OpenJDK 64-Bit Server VM (23.7-b01 mixed mode linux-amd64 compressed oops)# Problematic frame:# C [libmergedlo.so+0x14d7fb4] SfxTemplatePanelControl::GetISfxTemplateCommon()+0x70f4## Failed to write core dump. Core dumps have been disabled. To enable core dumping, try "ulimit -c unlimited" before starting Java again## An error report file with more information is saved as:# /home/gerry/hs_err_pid5856.log## If you would like to submit a bug report, please include# instructions on how to reproduce the bug and visit:##[error occurred during error reporting , id 0xb] On the weekend, I did a bit more testing with regards to these crashes of LibreOffice Impress. It actually costed me quite some nerves as I needed to get a presentation done for today and it crashed very often when editing tables.What did I do?* I disabled the extensions Zotero and Languagetool. No change, still crashes.* I disabled Java in the options. No change, still crashes.* I installed LibreOffice Version 4.0.6.2 (Build ID: 2e2573268451a50806fcd60ae2d9fe01dd0ce24) from the LibreOffice website. The crashes also occur in this version, but a bit less frequent (I think so).What other testing could I do? Unfortunately, I cannot attach the presentation here, but I could send it to someone's email address.Createdgdbtrace.logCreatedstrace.log.7zAdded a backtrace and a strace log.Hey Gerry,Thanks for the trace - have you made sure to try with a fresh profile? I'm requesting additional input here before moving to NEW but with all the info you provided, likely it will be marked as NEW and we'll hopefully get it fixed soon.(In reply to)Hi Gerry, can you install libreoffice-dbg to get debug symbols, which will make the stacktrace way more readable?Createdgdbtrace(with libreoffice-gdb).log@Björn: As you suggested, I installed libreoffice-gdb and continued testing. With libreoffice-gdb it took a bit longer (about 1 minute) until LO finally crashed. Please find the new gdbtrace.log attached.Createdgdbtrace(with libreoffice-gdb 2nd test).logPlease find attached the gdbtrace.log from a second test with libreoffice-gdb. This time LO crashed within a few seconds when I started editing a table in the presentation.Gerry: Can you please provide a test document so this can be tested against and subsequently be confirmed. If your document contains sensitive data, please clear that or replace it with random information.A step-by-step description of how to reproduce the issue is most helpful and will help to speed up the processing of this problem a lot.Setting to NEEDINFO until more detail is provided.After providing the requested info, please reset this bug to UNCONFIRMED. Thanks :)Thanks Foss for looking into the bug. I will try removing the sensitive information and hope that this doesn't change the tendency to crash. This time (in my test today), Impress hung long enough so that Apport-gtk of Ubuntu appeared. This is the information Apport collected from the crash:(36MB)I think the relevant information on the LibreOffice crash starts in line 1731.Besides the apport-gtk crash report in, I can also provide the presentation with removed sensitive stuff. You can download it here:(7.4MB)With this cut-down presentation, Impress also crashes.How to reproduce the crash:* Please start Impress* File -> Open -> choose attached file* There is no single event that crashes Impress, but it has always to do with tables in the presentation. Hence, to reproduce the crash you need to play a bit with tables. Do, for example:** on slide 54: Select with the mouse both heading cells of the table and choose Arial for both and font size 18. (sometimes it already crashes here). Then try to make the table smaller by selecting the middle blue rectangle in the bottom of the table and try to move the bottom edge of the table upwards (this usually makes tables smaller). (sometimes it crashes by doing this).* If it still does not crash, try to do something similar with slides 55, 58, 59, 62, 63,.... (highlighting more than one cell and change font and font size, change content, try to change the table size from the bottom upwards, and so forth).* On my system, there is a 100% chance that Impress crashes when I play a bit with tables in this presentation.I can confirm frequent crashes when using tables in Impress.This behaviour began in LO 4.1 branch and 4.0.5.I've never been able to have steps to reproduce the crashes but working with tables is now a problem. This afternoon again, with LO 4.1.4.1.The crashes came at the same time with this bug :(witch is a very annoying bug)I am experiencing the same (very annoying) bug on Windows 7 Home Premium 6.1.7601 SP1 Build 7601. I am trying to edit tables in Impress and it hangs every time. I am similarly trying to change font sizes, colors, and background colors. I have started from a fresh profile and the behavior is the same. I am using LibreOffice Version: 4.1.3.2Build ID: 70feb7d99726f064edab4605a8ab840c50ec57aBecause of the great backtrace as well as the confirmation from other users - I am moving this to NEW.Also putting it on MAB listA major problem (IMHO) is that, currently, there is no stable version of LO being stable for using table with impress.I can confirm comments #10 and #12 frequently crashes but very difficult to reproduce. Just have to play with tables, modifying background, copying, pasting, changing font size, colour, and so on...All LO 4.1.x and LO 4.0.6 crashes too (not LO 4.0.5 ) so all LO available for download are buggy actually three bugs seems to have appear at the same time and may be linked :that one and these :Unfortunately, this bug had not been fixed for yesterday's release 4.1.4.I can also confirm this bug with the most recent LO update for Ubuntu: Version: 4.1.3.2, Build ID: 410m0(Build:2)It is a severe bug! For a completely different presentation yesterday, I almost could not meet the deadline, because of crashes due to this bug. Working with tables in Impress is not possible at this stage!Please consider fixing this bug for 4.1.5. Thanks in advance!This is one of the worst Impress bugs for a long time. The crashes when working with tables in slides are unbearable.If you need any additional information, please request this information.@Gerry Isn't it too late for Christmas guess ?I hope that this bug will be fix soon. I hope... But I don't trust it'll beI've just tried with the latest 4.1.5.0+. It just took me 10 seconds to make it crash. Just a new presentation, insert a table as default, and starting to fill it randomly...But with 4.2.0 RC1, I've played 1 min with tables... and no crashI just did exactly as requested with 4.1.3.2 and was unable to reproduce on ubuntu 13.10. If it's fixed on 4.2 then it was likely "accidentally" fixed - a bibisect may be usefulYou'll have to use the 2013-11-25 package that is listed on that wiki.Oh, please try with a fresh profile before doing a bibisect - it might just be a wonky profileI did all my test with a fresh profiles.anyway LO must not crash whatever you profile isI did not told that the bug were fixed in LO 4.2 branch. As said before, it is difficult it reproduce the bug. maybe I was simply lucky this timeIf the bug has disappear accidental, it can be back bay the same way I will do new test soon on 4.2.0 RC1(This is an automated message.)Setting priority to highest as this is a 4.1 MAB. This is part of an effort to make the importance of MAB reflected in priority too.I was observing the described bug in version 4.2.0.4 of LO (Windows 7 64).Selecting the only table in the presentation was enough to crash Impress after a few seconds. On the other hand, not touching the table allowed working on the presentation without issues for as long as desired.I tried the suggested clean profile*, and I am here to report that I do not observe the bug anymore. I can select and modify the table of the above mentioned file without a glitch.I do not remember which version of LO was installed before I upgraded to 4.2.0.4.* - I.e.:Closed LORenamed C:\Users\Username\AppData\Roaming\LibreOffice\4\userto C:\Users\Username\AppData\Roaming\LibreOffice\4\user-oldRestarted LOWith LO 4.1.5.3 (Seven x64)1 Launch LibreOffice2 Create new presentation by file -> new -> presnetation3 insert table, keep default values4 click on the last cell5 press tab to insert a new line on the table==> CrashLo is unable to recover the fileI've done it three times => Same crashBUTIf you create the new presentation with the Impress icon (after launching LibreOffice) there is no crash !trying it three times and the coming back to first way to create new presentation three times and then 3 crashes.No crash with dev-masterHumm... after a reboot, this way to make LO crash does not work any moreBut, playing with tables still make LO crash very quicklyAs I've had to work with table in one of my presentations. I can confirm that with LO 4.1.6+ it crashes but also with LO 4.2.2.1.Working with tables is unbearable !And no one seems to get attention at it...I can only said to my student : DON'T USE ANY TABLE IN IMPRESS(as I told them quite before : don't use embedded font with LO)Hey Thorsten - Assuming you've seen this one on the MAB list but wanted to CC you in case you're interested in taking a look. Looks like there's a nice gdb trace - if you want a bibisect let me know and I'll get one done ASAP. Thanks!At least, there is a workaround.Just use AO 4.1 betaI don't want to be inpatient, but I am now somewhere between 50-100 crashes due to this bug with many different presentations on three different computers (Ubuntu with LO 4.1.x, Mint with LO 4.1.x, Windows7 with LO 4.2.x). Every crash of Impress stole me a couple of minutes of work, summing up to at least one work-day lost, not counting my lost nerves ;-) UuuhTo sum up:* Working with tables in LO Impress is a pain* All recent LO versions are affected: 4.0.6 , 4.1.x, 4.2.x * It is a regression (4.0.5 and earlier was okay!!-> seeand))* It is an all OS problem* Reproducing the bug exactly step-by-step is somewhat difficult, but working with tables in Impress is generally unstable and creating a presentation with a couple of tables almost surely leads to at least one crash.* choffardet assumes thatandis related ->I just can't understand why is this bug ignored !As it was just told. I use three computers, and the bug is present in all of these computers. It's a serious regression. most often, there is no data-loss, but sometimes,some of the work isn't recovered.Just yesterday : To write a simple word in a cell, LO crash for each letter.This bug should be a blocker for the last 4.1.6.But IMHO, it won't be solved. And not sure it'll be for 4.2 branchThe only hope is that's the bug get away as it comesTjis bug may be a duplicate of this one :EDITING: Impress crashes after adding / moving table@Joel Madero: IMHO choffardet is right that this definitively should be a blocker for 4.1.6, the last revision of the 4.1.x branch. If I understand the ReleasePlan right, then "conservative" users will use that version at least one more year. Joel, would you be so kind to put this in the next ESC call as a candidate for BLOCKER for release 4.1.6?With le latest 4.3.2opening a presentation. working on it 20 minutes.When on a slide with a table.Selecting a column -> align centre ==> crash (of course now I save it before touching a table)I guess no-one is working on this bug.After reopening the file. the table shows differently (all blue instead of alternate gray)When opening the files with AOo, the tables also show all blue instead of alternate grey.Maybe a way to trace the bug ?FWIW we don't actually have true blockers - we will almost never not release due to a bug. I agree this one is pretty nasty but it's not going to block releases - we've done what we can - it's set very high and put on the MAB list. I'll see if there's anything else we can do to help encourage a volunteer to tackle itPlayed a bit with the sample documents, couldn't make it crash. Could someone who sees this attach a screenshot just before the crashing? I'm particularly interested in the state of the Styles & Formatting floater.Backtrace hints at const SfxStyleFamilyItem *pItem = GetFamilyItem_Impl(); pStyleSheetPool->SetSearchMask(pItem->GetFamily(), SFXSTYLEBIT_ALL_VISIBLE);pItem being NULL or something. Band-aid fix is trivial, but would be good to know this is really the sticking point.This bug is quite curious.I've yet a sample doc :To make LO crash, I just have to select the word 'Domaine' and right-clic on 'default'.LO crash almost every timesIt crashes on my laptop and on my notebook (both with Seven x64)But it does not crash with LO 4.1.6+ (on both computers) and does not crash on Vmwares with LO 4.1.3.2 and XP or Seven x64But with any LO on these computers I can always make LO crash, just playing with tables (inserting columns, lines, copy, pasting, changing font, size, color) it just take less than 5 min. sometimes 5 seconds, and yes rarely, I can't make it crashCreatedScreenshot-at-freeze-before-crash.png(In reply to)Please find attached a screenshot at the time of the freeze (before LO crashed).(Remark: I don't know why the screenshot looks a bit weird. My LibreOffice Windows looks normal before crashing)CreatedAnother-screenshot-at-freeze.pngAnother screenshot at freeze (before crash). (Remark: This screenshot looks nicer :-)CreatedThird-screenshot-at-freeze-before-crashing-pngAttached the third (and last) screenshot of the freezes (before crashing). (Sometimes the crash came too fast so I was not able to create a screenshot. In such case for example, the styles&formatting was free floating).After Thorsten's hint, I realized that the crashes seem to only occur when the Styles&Formatting window is open. If it is not open at all, I could never reproduce a crash in my tests today.Hi Thorsten, were the attached screenshots helpful for identifying the problem behind the crashes? Do you need any other information? Thanks!(In reply to)>Yep, thank you - especially the confirmation that it hinges on the styles & formatting floater!Thorsten Behrens committed a patch related to this issue.It has been pushed to "master":Fix fdo#71423 - crash while editing Impress tables.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.choffardet, davidemf - committed a band-aid fix that _should_ fix this(can't really tell, since I don't see the crash). Can one of you picka new nightly build fromtomorrow, and try toverify if it's fixed indeed?Thanks a lot Thorsten!@choffardet: Do you have the possibility to test the nightly build as suggested by Thorsten in? I am travelling and could only try it out later next week.@davidemf: Same question to you, of course. Thanks.Yes I will try it. but server GUI install is still proposing the master from march the tenth. I'm waiting for the one of 04/11/2014. Maybe tomorrowanyone of the reporters able to quickly check? there are builds available now fromI've made some tests with this latest dev master. And I wasn't able to make LO crash when using tables.It doesn't mean the bug is over. Sometimes it tooks me five seconds. Sometime five minutes. Some times I can't. But next day it took me only one second...BUT in this version, there is no extensions. And LO impress had curious behaviour.- Selecting all the table show a partial frame on the table even if all the table is highlighted.- Changing font size of all the table changes only some cells- Adding a row by pressing tab on the last cell works sometimes but not every times.- All these seem very slowand more -the difficulty to select a text frame is still here (this bug went at the same time with crashing impress with tables)CreatedTable selection bug.pngHi Thorsten,I did a fresh LO 4.3 nightly install in a VirtualBox with WindowsXP SP3 and after some tests, I was not able to get a crash with Tables im Impress. I did a variety of test and there was no crash. That's excellent!However, as choffardet describes, tables in Impress now behave very strange. It is very difficult to "grab" the edges of the tables in order to be able to resize the table. Furthermore, sometimes the edges are not there where the edges of the table are (see the screenshot attached). I also encountered situations where I was not able to select more than the content of one single table cell with the mouse. Only after clicking outside the table and then again inside the table, I was able to select multiple cells. Very strange.Version: 4.3.0.0.alpha0+Build ID: 087a79db1272858f107656c5ca3c6efb45680986TinderBox: Win-x86@39, Branch:master, Time: 2014-04-16_01:43:37(In reply to)Cool, that's good news, thanks to both of you for testing!But I would assume that would be the same in a master build beforeThursday last week, right? And then worth a separate bug report.Thorsten Behrens committed a patch related to this issue.It has been pushed to "libreoffice-4-2":Fix fdo#71423 - crash while editing Impress tables.It will be available in LibreOffice 4.2.5.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.With regards to this bug, good news: After installing a slightly older nightly build (2014-04-08) in my test environment (Virtualbox and WinXP SP3), I could reproduce the crashes with tables. This means that Thorsten's fix is successful.With regards to the other problems, I am not sure whether they are introduced by this fix (is this possible, Thorsten?) or by something else. Testing a nightly from the 8th of April, I could reproduce some of the other problems, but not all. E.g. I cannot confirm the bug of my screenshot in that earlier build.Nevertheless, I openedfor these problems.Version: 4.3.0.0.alpha0+Build ID: 615f6aa293a6da90da94e6e78828198ffbc0ca5eTinderBox: Win-x86@39, Branch:master, Time: 2014-04-08_01:30:26back to RESOLVED FIXEDthis bug appears at the same time with that one (crash tables)Thorsten Behrens committed a patch related to this issue.It has been pushed to "libreoffice-4-2-4":Fix fdo#71423 - crash while editing Impress tables.It will be available already in LibreOffice 4.2.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Confirming fixed. Thank you!Ubuntu 14.04, x86_64.As with others, 4.2.3 crashed incessantly when editing tables. 4.2.4 from ppa () resolved the issue.I am experiencing this bug in LO 4.3.3.2 (Ubuntu 14.04, 64-bit).Table was copied from Writer. I managed to edit table (change font, size, delete columns etc...) however, following events triger LO Impress crashing: - first column is selected and I press CTRL + C (LO Crashes) - I selected for slides (three slides contain tables) and wanted to move it to different positions... LO crashCreatedExamples of tables for crash-test.I uploaded Impress ODP file with tables which always crashes Impress when trying to copy first column..."Examples of tables for crash-test." if attachment. How to reproduce the error (LO 4.3.3.2)1. Open the attachment2. Select first column3. Press CTRL + C4. Impress should crashHi,I'm sorry to report that this bug is not properly fixed.LibreOffice crashes immediately on my system (Mac OSX 10.9.5) whenever I try to copy a table from a slide (or a slide containing a table) in Impress. I have updated to the latest LO version (4.3.3) without any improvement.On the contrary, I have now downgraded to LO 4.2.7.2 and I can copy slides with tables without problems.So something has gone wrong again from 4.2 to 4.3.-jordimpjordimp, please file a *new* bug report. this one has *59* comments already and no developer will look at such a mess.
id=72022	steps to reproduce:1/ install version 4.2.0.beta1 and the helppack corresponding to your langpack2/ open the startcenter or the module you want3/ press F1 or menu Help > Help of LibreOffice (F1)current behavior: the help website is openedexpected behavior: the integrated help is openedReproduced with LibreOfficeDev (beta1) and my own build, under Ubuntu 13.10 x86-64. Worked sometime ago (see).Best regards. JBF @Jean-Baptiste: Are you sure that the helppack was successfully installed? On Ubuntu 13.04, the German helppack did install, but dpkg refused to configure it for some reason.(In reply to)Yes I am sure. I reinstalled the helppack FR without error message from dpkg.Even the with En-US helppack installed en the UI in English, the integrated help is ignored.At least you confirmed that there is a problem with the helppack ;-)Best regards. JBFsame problem hereSame behavior with LO 4.2.0.0.beta1Build ID: f4ca7b35f580827ad2c69ea6d29f7c9b48ebbac7on Windows 4 Home PremiumRegards,JacquesHello Jean-Baptiste, *,I can confirm it with LO Version: 4.2.0.0.beta2 Build-ID: 1a27be92e320f97c20d581a69ef1c8b99ea9885d and installed Germanophone help- as well as langpack ... :( But I reported it in the past on the QA ML (and), which were ignored for whatever reason ... :( This one should be fixed really fast and I think, it should be added to the MAB 4.2 bug.HTHThomas.LibreOffice tries to open "helpen-US" instead of "help/en-US", I think we are the victims of a String->OUString conversion, but let's see...regression since 58fa3d50aa43102cea8690fd6bf51fb80c007955Caolan McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: fdo#72022 Integrated help ignored if installedThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-2":Resolves: fdo#72022 Integrated help ignored if installedIt will be available in LibreOffice 4.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "master":Related: fdo#72022 internal links bustedThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-2":Related: fdo#72022 internal links bustedIt will be available in LibreOffice 4.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Thank you very much for the fix, it works as expected.Verified in Version: 4.2.0.0.beta2+ Build ID: a125b9da3035a584ffd2203f2b3c71c972b8bd4c under Ubuntu 13.10 x86-64Best regards. JBF***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***I still see this on OSX 4.2.0.1 (RC1). Reopening.This behavior does not occur with LO 4.1.4.2UNLESS the helppack is not installed in its default install directory.JFJBPS. Is the Help path hardcoded?OK, let me get this straight:This behavior does occur with LO 4.2.0.1 (on OS X)EVEN WHEN the helppack is installed in its default install directory.It seems a 4.2.0 stopper.lp, m.BTW, on OS X the lang pack includes both localized help and UI localization. In my case LO UI is localized into Slovenian, thus lang pack is properly installed - which means help is installed as well. But it opens wiki help in the browser (Slovenian one).On Ubuntu, I have 4.2.0 rc1 and both with a fresh and with an old user profile, it does open the local installed help.So maybe Mac OS related?Should I open a new bugreport?(In reply to)maybe - lets wait for some specific Mac - QA imput first, I think..(In reply to)MacBook Pro Adapter is broken ;-). Will put it on my to-do list.Confirming, clicking on Help in the menu even with the installed help and french lang-pack leads here :There does however seem to be something wrong with the langpack DMG. It contains the app file, but it also contains a 35Mb LibreOffice.app bundle, which I've never seen before. Seems to be some kind of packaging issue ?AlexTested with Version: 4.2.0.1Build ID: 7bf567613a536ded11709b952950c9e8f7181a4aAlexThe unzipped tarball in "LibreOffice Language Pack.app" is only 2.8 Mb and the rest, especially the help (all the jars) seem to be in "LibreOfffice.app".Unless the packaging has changed, I would say something has gone wrong with the build...Checking the contents of the LibreOffice.app installed in /Applications confirms that only the en_US help is present.AlexHello Jean-Baptiste, *,I have tested it again w/ LO Version: 4.2.0.2 Build-ID: cd65d6220c5694ee7012d7863bcde3455c9e3c30 and installed Germanophone lang- as well as helppack, and it is still reproducible ... :( In 4.2.0.1 it was fixed, but now it reappeared ... :(HTHThomas.P.S. Why was this bug reported for "x86-64 (AMD64)" and "Windows", when most people confirmed it with any other OS? I set it to "x86-64 (AMD64)" and "All". If you (or someone else) think, it is not adequate, feel free to change it back ... ;)(In reply to)For me it works as expected on Ubuntu Linux with version 4.2.1.0+ (built at home), will test with the RC2.You can check the history () of this bug report. The change for Windows was a mistake. Thank you for the correction.On Windows 7 sp1, 64-bit with RC2 with en-US help installedVersion: 4.2.0.2Build ID: cd65d6220c5694ee7012d7863bcde3455c9e3c30F1 and the LibreOffice Help (the "lifesaver") both correctly launching indexed to correct article in the integrated help.Also, the Help button on the start center lands on the project home page. Would prefer thepage, but seems to be correct otherwise.So, would say WFM on Windows.Hi, Stuart, the last part does not seem logical - if help system is installed, the Help button in Start Center should open local help, not some webpage. This goes against the usage of LO on computers not connected into internet. I guess I should open another bug report for that.But at least local Help works on Win7, as your report.Also, I am marking this bug as a blocker - this kind of erratic behaviour of "online" help in an office suite cannot be released as official build, so this bug must be squashed before 4.2.0 is released.Reporting now also from Win2012 Server with 4.2.0.2 - instead of installed help it opens wiki help (and it opens English, not Slovenian help, I don't know why).It also has another quirk, localized version has the credits dialog in English (on OS X this is in the localized version's language).Strange.Works as expected in version 4.2.0.2 under Linux (Ubuntu 13.10 64 bits).Best regards. JBFHello, what can be done about this bug before the 4.2.0 release?This is a stopper - on some systems (without clear logic when this does happen) wiki help opens instead of installed online help. This is a no-go for some government use etc. where internet access while using such tools is not welcome or allowed.Also it means installing help packs is of no effect.It is not like some command in UI is not translated and it can wait for 4.2.1 or later ...Confirming also on OSX with 4.2 rc2, that even with the alleged installation of the lang-pack, both F1 and clicking on the Help button in the StartCenter point the user to the web site.As I mention in comments,, and 26, the packaging of the OSX lang-pack is wrong..DS_StoreLibreOffice Language Pack.appLibreOffice.appREADMEs Quite why there is another LibreOffice.app in the lang-pack image is beyond me. Previously, this was all packaged into a compressed file which was in the LibreOffice Language Pack.app bundle, so something has gone wrong with the build packaging process.Alex@Norbert : any idea what's happening here ?AlexSomeone @Mac could pls try with this:@Florian8.7M for the FR langpack is way too smallAlexConfirming that the daily 4.2.1, which installs as LibreOfficeDev on OSX, doesn't install French help if the FR langpack is installed.Alex(This is an automated message.)Setting priority to highest as this is a 4.2 MAB. This is part of an effort to make the importance of MAB reflected in priority too.This is fixed for me on LO 4.1.4.2 release build on OSX Mavericks.Also fixed in my own master 4.3 build from yesterday afternoon.I am assuming that the fix has been pushed to 4.2 tree also.Setting to resolved fixed, if I'm wrong, please change it back as appropriate.
id=72267	CreatedDemo databasePrior to 4.2 Beta (e.g. in 4.1.3.2) the following SQL is valid: SELECT "id", "txt", "num" FROM "Table1" WHERE "num" IS NULLIn 4.2 Beta this results in: "Syntax error in SQL statement syntax is ambiguous"See the attached demonstration odb, which includes the definition of Table1 (id is the integer primary key, txt is mandatory text, num is an optional integer), and the above query is Query1.The same error occurs using an external database with much more complex queries (I came across it with a MariaDB 10 database connected using MySql(JDBC)). I produced this stand-alone example to make it easy to reproduce the problem.This is a non-trivial issue, since checking if a field is NULL is particularly useful in some situations (eg where it may be a foreign key). Reproducible.Win7x64Version: 4.2.0.0.beta1 Build ID: f4ca7b35f580827ad2c69ea6d29f7c9b48ebbac7Select "Run SQL command directly" icon, works fine for me.NEW for All systems.In any form where you need to filter, sort, or link from a subform, and so on, LO needs to inspect the SQL. So whilst it is true that running SQL directly avoids the problem, sadly it doesn't work for many of my forms.Hi tim, it was for information about the bug, as you can see the bug status was changed to NEW for All Operating Systems. Now depends on developers.Hi Mario,Sorry if I appeared ungrateful for your info. I too was just trying to make sure the developers had a complete picture of the problem.I am continually amazed by the speed and quality of response from the likes of yourself and the others involved in LibreOffice. It really encourages ordinary users such as myself to spend a bit of time trying to pin problems down and then reporting them :-)No problem Tim, thanks, I think all are looking in the same direction.Reproduce also with OpenSUSE 12.3 64bit rpm. Same query works right with LO 4.1.3.2, so a regression.@Lionel : any chance that this is an unwanted side effect to the changes in "IS NULL" parsing ?AlexLionel Elie Mamane committed a patch related to this issue.It has been pushed to "master":fdo#72267 boolean_test is subsumed by general case "foo IS [NOT] bar"The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.(In reply to)Yes and no. The changes to "IS NULL" parsing are far older than that, but what happened more recently is that the parser what switched to a mode where it is more powerful (it recognises more expressions), but more strict.Previously, in the case there was an ambiguity in the grammar, the parser would just make a more-or-less not semantically justified choice (that is, a choice that has nothing to do with the grammer / semantics, just linked to implementation details).Now, it throws an error saying "there is an ambiguity", and the ambiguity needs to be resolved in the grammar (either by making it non-ambiguous or by assigning priorities to the different cases so that exactly one case "wins").So, in short, if testers could throw their most varied SQL at the parser and stress-test it, it would be really nice. So that we "catch" regressions as these as early as possible.The "far older changes to parsing IS NULL" have introduced the ambiguity that this case triggers, but since before an ambiguity was not an error (but a subtle bug waiting to be discovered...), we get this "regression" now that the parser is strict about ambiguities.Lionel Elie Mamane committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#72267 boolean_test is subsumed by general case "foo IS [NOT] bar"It will be available in LibreOffice 4.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Verified fixed in 4.2.0.1. Thanks.
id=72470	Problem description: When typing into a cell Chinese chars following non-Chinese strings, calc freezes immediately.Steps to reproduce:1. Start calc;2. Type "abc" in A1, hit ENTER;3. Type "中国" (which means "China" in Chinese) in A2, hit ENTER;4. Type "abc中国" in A3, hit ENTER.Current behavior:Calc freezes immediately in step 4. Same issue when disable spell check.Same issue when change UI language.Expected behavior:Calc should not freeze.Ubuntu 13.10 x86, LibrOffice 4.2.0.0 beta 2, system locale: en_US.No such behavior in 4.1.3.2 release, so may be a regression. Operating System: UbuntuVersion: 4.2.0.0.beta2Last worked in: 4.1.3.2 release Changing status to high critical, as it I have to "force quite" the window thus it causes data loss.Hi,suokunlong.I'm Japanese. I can input Chinese chars.I did not reproduce."abc中国" in A3, hit Enter -> No problemUbuntu 12.04 LibreOffice 4.2.0.0 beta2 systemlocale:JaBest regards(In reply to)Thanks for testing, I further tested in another pc and confirm that this is not a bug, maybe just because of the OS in my home pc.Marking as WORKSFORME.(In reply to)Reproduce at Ubuntu 13.10, LibreOffice 4.2.0.0 beta2.You should not copy the "abc中国" into A3,Instead, use the input framework (eg ibus), after input "abc中国" in A3, hit ENTER, then freezes immediately.Still freezing in linux. But work ok in windows XP.Steps to reproduce:1. Start calc;2. Copy "abc" and paste into A1;3. Copy "abc中国" and paste into A2, then frozen.libreoffice Version: 4.2.0.2Build ID: 601a398b803303d1a40a3299729531824fe0db56Linux 3.11.0-15-generic #23-Ubuntu SMP Mon Dec 9 18:17:04 UTC 2013 x86_64 x86_64 x86_64 GNU/LinuxDescription: Ubuntu 13.10locale LANG=zh_CN.UTF-8locale LANGUAGE=zh_CN:zhAdding keyword "regression". Still reproducible in 4.2.0.3.I think I know what's going on here...I'm looking into this right now.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#72470: Correctly calculate the first edit cell row position.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.4.2 backport request:Upping the severity. Without this, Calc is useless in CJK locales.Also, for the freeze to occur, on Linux the LANG must be set to either one of CJK. For me, setting LANG=ja_JP.utf8 was necessary to trigger the freeze.(In reply to)Thanks and really happy to see this bug to be fixed.is another freeze which is related to LANG, dont know if they are related. Hope that bug to be fixed soon.(In reply to)Likely unrelated, since this bug causes an infinite loop (i.e. freeze), not a long delay.And the fact thathappens in Writer suggests that it's a different problem. This bug here is strictly Calc only.***has been marked as a duplicate of this bug. ***(In reply to)No, I don't think so.Today with 4.2.0.4 I can no longer reproduce "my steps" as in(type in the chars), but I can 100% repro jmxhyz's steps as in(copy the mixed chars),and freeze also happen with the attached file in, see my comment there at #4.All the above freezes happen no matter which UI LANG is in use (I tested English US and Simplified Chinese.)@Kohei: Isrelated to this?(In reply to)Not clear yet. Let's leave that one as a separate bug for now.Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#72470: Correctly calculate the first edit cell row position.It will be available in LibreOffice 4.2.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#72470: Correctly calculate the first edit cell row position.It will be available in LibreOffice 4.2.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Ok. This is now backported. I'll call it fixed.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Sorry if I sound dumb, but how do I install the patch? I am running Windows 7 (both 32 and 64 bit, on different PCs).(In reply to)Try the most recent daily 4.2 builds from here.But note that it sometimes takes a few days before the fix makes it into a daily build. The fix for this bug is definitely in for sure, but you need to keep it in mind for future references for other bugs.Not sure about. Looks quite related behavior, but as far bug reporter mentions: only 1 script type. Therefore I'm putting this bug in 'see also'. Can anyone else please have a look and mark it correctly (either marking as duplicate or removing it from the 'see also' field).Thanks in advance,Joren(In reply to)The input 2012年4月 consists of 2 script types: asian and latin. You need to disect the input character by character.So, that bug is likely a duplicate, but please verify by re-checking.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Kohei, checking the link you provided to the daily builds four days ago, I note that while there do exist sub-directories for Mac and Windows builds, nothing is provided for us Linux users. Any chance of patches being posted for Linux - in my case, deb - builds in the near future ?...Henri***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***
id=72647	With ESC decision to keep the UAA <-> Java Accessibility API Java Accessibility Bridge while implementing the IAccessible2 native bridge as an experimental feature for 4.2.0.0 now requires more work.The JAB has can no longer be enabled on LODev 4.2.0 beta1+ builds forward.Believe results from IA2 a11y related commit for 4.2.0.0beta1+ between Nov 21 and Nov 25th that isn't quite correct:The result is though that currently for the 4.2.0 RC1 users dependent on Java Access Bridge will not be able to activate it, and would have to attempt to activate the IAccessible2 bridge as an "experimental feature".Setting a blocker status accordingly--knock it back to critical if we're content to let the RC1 out without JAB functioning. Nominating for mab4.2 obviously.Really sorry, I saw this back on Nov 26 ()lost track of it and did not follow up.I know a lot of folks worked hard to bring in the IAaccessible2 native bridge in working form for the 4.2 release--also a lot of moving parts; but at present this regression in the Java Access Bridge would be discouraging for our AT users.Not sure how best to fix it. Pulling JAB out completely as already done in master might be the most direct way, but in truth it could be just some simple issue affecting the JAB--but will need to dig back into it to clear the regression.OK, so for anyone following along.I'd been testing against TB-42 daily builds of LODev4.2.0.beta2+. Build logs show the --enable-ia2 flag.I went back and loaded the pre-release LODev4.2.0beta2 (5 Dec). And it will not come up with IAccessible2 with "Experimental Features" set, insisting that I enable a JRE. At which point it comes up with JAB provided AT (monitored with Java Ferret). Original issue ofWhat are the compile flag differences between Cloph's 4.2 release build system and Thorsten TB-42 for 4.2? Are they building with the same configuration flags regards the enable_ia2 and the "fall back" for Windows Java Access Bridge support?yep --enable-ia2 build doesn't register JAB UNO component; should be fixed now.please test the new builds (as i'm only building master on Windows myself).Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#72647: register Java Access Bridge componentIt will be available in LibreOffice 4.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Createdwith an Assistive Technology tool in use, and Experimental features not checked, default activation of JAB AT support triggers call for JRE activationOn Windows 7 sp1, 64 bit with /A administrative install ofVersion: 4.2.0.0.beta2+Build ID: 4031765b004dded31f04c54f9a055b7a3d0053f2TinderBox: Win-x86@42, Branch:libreoffice-4-2, Time: 2013-12-14_01:35:27Can verify, with an Assistive Technology tool (NVDA 2013.2) active, this build of LODev 4.2.0 beta2+ enables Java Access Bridge and IAccessible2 support for Assistive Technology tools. Hooray! :)One potential down side, is that we are now always activating support for Assistive Technology if an AT tool (NVDA, Jaws) is in use.Probably correct, and will not be an issue for IA2 native bridge alone--as targeted for 4.3 release--but the JAB is a bit resource heavy, and when an AT tool is active it is now challenging to disable the JRE--requiring deletion of LODev profile, and needing to kill the soffic.exe process tree not a good UX.see the attached image of JRE required error.Some notes on state of things for 4.2:**UAA -- Java Accessibility API via JAB**Possibly masked by the current "activate when an AT is in use" implementation.At this point it is unclear if there is a continuing need for the established Windows methods allowing a user to activate the Java Access Bridge-- e.g. 1) using Tools --> Options Advanced, Java options use a JRE and select a system JRE for use, coupled with Tools --> Options Accessibility Miscellaneous check-box to "Support assistive technology tools". Followed by relaunch of LODev.2) a Windows registry HKCU key value Software\LibreOffice\Accessibility\AtToolSupport of "SupportAssistiveTechnology" set true will also activate JAB based AT. 3) Setting the SAL_ACCESSIBILITY_ENABLED=1 system environment variable activates the JAB support. So a full install using the "Support Assistive Technology Tools" that will set the SAL_ACCESSIBILITY_ENABLED environment variable ( see) will still be functional.They seem to work, but hard to tell. And they probably should go away for 4.3 if we drop JAB based AT support via the JRE.**UAA -- native IAccessible2 bridge**Checking "Enable experimental features" from Tools --> Options --> Advanced panel, and restart of LODev--WILL toggle off JAB support and activate IAccessible2 support for AT use. Although it does not clear the use Java Runtime.If the Java JAB had not been activated as above, i.e. AT not in use then selecting the "Enable experimental features" check-box will directly activate IAccessible2, when an AT is activated. Not the common use case as anyone needing AT will usually have it in use on launch. Maybe not the best UX, is there a simple fix short of yanking out the JAB based support? This late in the release cycle can the IAccessible2 native bridge be made the default, and retain use of the JAB as the option?Migrating Whiteboard tags to Keywords: (regression)[NinjaEdit]
id=74077	Createdfile with cell changing formulas from 4.1 to 4.2Calc is changing cell formulas between version 4.1.4 and 4.2.0.34.1.4 from Ubuntu PPA4.2.0.3 from W7 and Linux.In the sample file I attached cell D28 changes from=D27*0,09to =D27*0,32without even touching any other cell.A spreadsheet caoont change formulas between versions. CreatedFile showing the errorThe same problem with me. I'm using Linux Mint 15 Oliva 64 bits and LibreOffice 4.2.0.3.cell content is already 0,32 at source-hash-1581b1fc3ac82a7bd62df968226e98604a4ca52d (bibisect 2013-11 oldest).Error occurs even on a blank spreadsheet:procedure: On a blank sheet under 4.1.4, fill the cells in column ARow 1 (nothing)Row 2 =A1Row 3 =A2*0,32Row 4 =A3*0,09Save it and open it in LO 4.2results obtained in 4.2Row 1 (nothing)Row 2 =A1Row 3 =A2*0,32Row 4 =A3*0,32#fail!Already a problem in alpha1cell content is still 0,09 at source-hash-4b9740b4ec3987e1d4d2ad6d20b4dcf996a4fa2e (bibisect 2013-10 oldest).bibisecting now ...Bisect log:# bad: [25428b1e953636f74986622c5df614f04c150ed1] source-hash-cb4e009c4539c535108021934e545194b35cad9d# good: [f0f6c65eb764f0303f59c58d320e9b0d5a894377] source-hash-4b9740b4ec3987e1d4d2ad6d20b4dcf996a4fa2egit bisect start 'latest' 'oldest'# good: [a72833796a7e527d9efc9ca6d8fe9b579e469105] source-hash-1472b5f87314fe660ef1a7b254e51272669f12f6git bisect good a72833796a7e527d9efc9ca6d8fe9b579e469105# good: [b21386bf459ae47bd6e461ea94cea6a06729a1ff] source-hash-570fe620e9d573cfc9fc260e6518563c6a6c1a3cgit bisect good b21386bf459ae47bd6e461ea94cea6a06729a1ff# bad: [091d742e82f2b4608690c697d14f846ffc9164c7] source-hash-349c91c8ec6afc1f5c8499529d559af34d115a76git bisect bad 091d742e82f2b4608690c697d14f846ffc9164c7# good: [8f9ca7d8ab2e98061706d2fae7501b75a902d93a] source-hash-3cf0b5cdb05e1d77610431b1b1328102bf05b602git bisect good 8f9ca7d8ab2e98061706d2fae7501b75a902d93a# bad: [957af3a493bd71de62b536a590a2630aa4a53a27] source-hash-5166f28e797aec47a8a48213203ebd6a7ee06302git bisect bad 957af3a493bd71de62b536a590a2630aa4a53a27# good: [7bd35cbe665503fc9fc769437a723e90b46b2a3a] source-hash-e4ebe80be51fb33545091aa4f0bbc0ea2fe674f0git bisect good 7bd35cbe665503fc9fc769437a723e90b46b2a3a# bad: [896c52dbcc24f55d6487750f2d72f0c010f62cff] source-hash-d1cbaee70d3f922937a1993914436c8fc899ebfcgit bisect bad 896c52dbcc24f55d6487750f2d72f0c010f62cff# good: [e9c4bed0b2622077e75004f7b8a50dd9a02fa584] source-hash-417d1c2b13cbd70300d2921b5667dfadc7e25895git bisect good e9c4bed0b2622077e75004f7b8a50dd9a02fa584# first bad commit: [896c52dbcc24f55d6487750f2d72f0c010f62cff] source-hash-d1cbaee70d3f922937a1993914436c8fc899ebfcSo introduced in:which has 8 calc commits in the beginning.For the life of me, I cant make sense of this. When I compile 417d1c2b13cbd70300d2921b5667dfadc7e25895 here, it also turns out the bad 0.32 result, although the bibisect build is fine. I even rechecked the "about" box of the bibisect build. I tried to tweak the ./configure-flags of my build to match the bibisect builds flags, still my current builds are always wrong, while the bibisect buildx are right up to until 417d1c2b13cbd70300d2921b5667dfadc7e25895.Markus Mohrhard committed a patch related to this issue.It has been pushed to "master":we need to check that the content is equal as well, fdo#74077The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Pending review for 4-2 and 4-2-0.Markus Mohrhard committed a patch related to this issue.It has been pushed to "master":better check for more formula token types, related fdo#74077The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.This one affects all formulas where the difference between two formulas is only a string, a value, a range name, ...There are a few more cases that I need to inspect later.Markus Mohrhard committed a patch related to this issue.It has been pushed to "libreoffice-4-2":we need to check that the content is equal as well, fdo#74077It will be available in LibreOffice 4.2.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Markus Mohrhard committed a patch related to this issue.It has been pushed to "libreoffice-4-2-0":we need to check that the content is equal as well, fdo#74077It will be available already in LibreOffice 4.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#74077: Write unit test for this.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.It seems that this bug affects LO 4.1.5.2 too.Please, is it possible to backport the fix to 4.1.5 ?Best regards. JBF(In reply to)Sorry, wrong bug report. No problem with LO 4.1.5.2 on the test file.Best regards. JBF***has been marked as a duplicate of this bug. ***In Ubuntu 12.04.4 x86_64 LibreOffice 4.2.1.1 Build ID: d7dbbd7842e6a58b0f521599204e827654e1fb8b I have =D26*0,32 in Cell D27 and =D27*0,09 in Cell D28Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=73464	If the IA2 UAA bridge is active while any existing document or any new is being edited--Writer, Calc, Impress--pressing the ENTER key is immediately crashing the edit session and LibreOffice "stops workings" and enters a document recovery cycle on next launch. Issue noted on multiple installations different workstations, Windows 7 sp1, 64-bit en-US with LibreOffice 4.2.0.2 RC2. en-US Help pack also installed.Version: 4.2.0.2Build ID: cd65d6220c5694ee7012d7863bcde3455c9e3c30IA2 enabled by selection of Tools --> Options --> Advanced "Enable experimental features"Monitoring with AccProbe and JavaFerret32 to verify switch from JAB or IA2 support for AT is active following logoff/logon. Issue occurs with either NVDA (2013.2) or if setting Environment variable SAL_FORCE_IACCESSIBLE2 set to "1".This is unique to the 4.2.0.2 RC build. Recent TB builds of 4.2.0 branch are fine. Verified that a /A parallel install of the next TB 42 build following the tag, works without issue.Version: 4.2.1.0.0+Build ID: 8308f6e5f50bcdd5cd4e5511a8a3bd5c64c93e2bTinderBox: Win-x86@42, Branch:libreoffice-4-2, Time: 2014-01-08_09:46:01Removing the 4.2.0.2 en-US Help package made no improvement.Performing a /A administrative install of the 4.2.0.2 msi package also does not help, the <ENTER> key press continues to crash the edit session when IAccessible2 is active.Can also consistently cause LO 4.2.0.2 to crash while editing a document with some existing text by positioning with cursor to an empty line and then pressing <BACKSPACE> to rub out a Paragraph mark.With no AT active, and AccProbe not running to monitor AT (so IA2 AT support disabled), the same <BACKSPACE> removal of paragraph mark does not crash LO.Attempting to isolate for stacktrace the program action, but its being elusive and the Windows application error is useless.Hi Stuart,You should download Windows version 4.2.0.2 again. The build you tested is broken as Christian Lohmaier said on QA mailing list.Correct build ID is 601a398b803303d1a40a3299729531824fe0db56 ()Best regards. JBF(In reply to)Jean-Baptiste,Wish I could, but the Windows build posted to the /pre-release site remainsVersion: 4.2.0.2Build ID: cd65d6220c5694ee7012d7863bcde3455c9e3c30Verified HASH values of all prior attempts against the build still posted topackage listed as LibreOffice_4.2.0.2_Win_x86.msi 09-Jan-2014 12:00 210MCreatedscreen clip of soffice.bin ProcessExplorer propertiesStill struggling to isolate the issue; I think is is OLE32 but I'm not certain.Attached a capture of a crashing Writer edit session following rub out of a paragraph mark.=-=Stack Traces=-=Here is stack trace for the hung soffice.bin process:=-=-=wow64cpu.dll!TurboDispatchJumpAddressEnd+0x6c0wow64cpu.dll!TurboDispatchJumpAddressEnd+0x4a8wow64.dll!Wow64SystemServiceEx+0x1cewow64.dll!Wow64LdrpInitialize+0x42bntdll.dll!RtlUniform+0x6e6ntdll.dll!RtlCreateTagHeap+0xa7ntdll.dll!LdrInitializeThunk+0xentdll.dll!ZwWaitForSingleObject+0x15ntdll.dll!RtlReportException+0x86ntdll.dll!RtlpNtEnumerateSubKey+0x1ab9ntdll.dll!RtlpNtEnumerateSubKey+0x1b36ntdll.dll!RtlpNtEnumerateSubKey+0x2a2cntdll.dll!RtlpNtEnumerateSubKey+0x2b0cntdll.dll!RtlUlonglongByteSwap+0xc811ole32.dll!CoGetComCatalog+0x4f7OLEAUT32.dll!GetErrorInfo+0x519OLEAUT32.dll!SysFreeString+0x4aOLEAUT32.dll!BSTR_UserFree+0x19RPCRT4.dll!NdrUserMarshalFree+0x37RPCRT4.dll!NdrStubCall2+0x4a3RPCRT4.dll!NdrStubCall2+0x38fole32.dll!WdtpInterfacePointer_UserUnmarshal+0x256fole32.dll!WdtpInterfacePointer_UserUnmarshal+0x25ffole32.dll!WdtpInterfacePointer_UserUnmarshal+0x2b59ole32.dll!CoTaskMemFree+0x1b02ole32.dll!CoTaskMemFree+0x19f7ole32.dll!DcomChannelSetHResult+0x8ffole32.dll!WdtpInterfacePointer_UserUnmarshal+0x2a56ole32.dll!WdtpInterfacePointer_UserUnmarshal+0x28caole32.dll!WdtpInterfacePointer_UserUnmarshal+0x2f86ole32.dll!DcomChannelSetHResult+0x75cole32.dll!DcomChannelSetHResult+0x71bUSER32.dll!gapfnScSendMessage+0x332USER32.dll!GetThreadDesktop+0xd7USER32.dll!CharPrevW+0x138USER32.dll!DispatchMessageW+0xfvcllo.dll!?IsMaximized@WorkWindow@@QBEEXZ+0x9cf0vcllo.dll!?IsMaximized@WorkWindow@@QBEEXZ+0x9e60vcllo.dll!?Execute@Application@@SAXXZ+0x97vcllo.dll!?Execute@Application@@SAXXZ+0x20vcllo.dll!??4EmbeddedFontsHelper@@QAEAAV0@ABV0@@Z+0x171soffice.bin!main+0x51soffice.bin!main+0x229soffice.bin!main+0x8f5And stack trace for the associated sal3.dll process:=-=-=wow64cpu.dll!TurboDispatchJumpAddressEnd+0x6c0wow64cpu.dll!TurboDispatchJumpAddressEnd+0x4a8wow64.dll!Wow64SystemServiceEx+0x1cewow64.dll!Wow64LdrpInitialize+0x42bntdll.dll!RtlIsDosDeviceName_U+0x23a27ntdll.dll!LdrInitializeThunk+0xentdll.dll!ZwWaitForSingleObject+0x15kernel32.dll!WaitForSingleObjectEx+0x43kernel32.dll!WaitForSingleObject+0x12sal3.dll!rtl_cache_free+0x395kernel32.dll!BaseThreadInitThunk+0x12ntdll.dll!RtlInitializeExceptionChain+0x63ntdll.dll!RtlInitializeExceptionChain+0x36And stack trace for the associated MSVCR100.dll process:=-=-=wow64cpu.dll!TurboDispatchJumpAddressEnd+0x6c0wow64cpu.dll!TurboDispatchJumpAddressEnd+0x4a8wow64.dll!Wow64SystemServiceEx+0x1cewow64.dll!Wow64LdrpInitialize+0x42bntdll.dll!RtlIsDosDeviceName_U+0x23a27ntdll.dll!LdrInitializeThunk+0xentdll.dll!ZwWaitForSingleObject+0x15KERNELBASE.dll!WaitForSingleObject+0x12KERNELBASE.dll!GetOverlappedResult+0x57sal3.dll!osl_acceptPipe+0x80KERNELBASE.dll!RaiseException+0x58sal3.dll!osl_unloadUserProfile+0x829MSVCR100.dll!_endthreadex+0x3aMSVCR100.dll!_endthreadex+0xe4kernel32.dll!BaseThreadInitThunk+0x12ntdll.dll!RtlInitializeExceptionChain+0x63ntdll.dll!RtlInitializeExceptionChain+0x36And finally stack trace for associated ole32.dll process:=-=-=wow64cpu.dll!TurboDispatchJumpAddressEnd+0x6c0wow64cpu.dll!TurboDispatchJumpAddressEnd+0x56bwow64.dll!Wow64SystemServiceEx+0x1cewow64.dll!Wow64LdrpInitialize+0x42bntdll.dll!RtlIsDosDeviceName_U+0x23a27ntdll.dll!LdrInitializeThunk+0xentdll.dll!ZwDelayExecution+0x15KERNELBASE.dll!Sleep+0xfole32.dll!CoGetTreatAsClass+0x325eole32.dll!CoGetTreatAsClass+0x314bkernel32.dll!BaseThreadInitThunk+0x12ntdll.dll!RtlInitializeExceptionChain+0x63ntdll.dll!RtlInitializeExceptionChain+0x36V Stuart Foote : this link could help to retrieve a backtrace :(In reply to)Thanks Julien, but the stack trace provided is functionally equivalent and is using Windows 8.1 SDK Debugtools -- debughelp.dll, and Cloph's project symbols for the 4.2.0 build fromOnly difference is using SysInternals Process Explorer or Process Monitor to follow the processes. These stack traces were following soffice.bin from Process Explorer, but if someone can pin the keystroke event down futher--great.=-=Ref for using Symbols with Sysinternal PE or PM=-=V Stuart: I recognize I know too few about stacktraces from Windows.Re reading it, I wondered if it could be a pb in vcl module, IsMaximized function.But I prefer letting other give their idea.(In reply to)Nope, there's a little confusion. The initial upload was not from the tag (as was apparent by not being called "4.2.0.2" - so that build was removed and windows build was redone with the initial libreoffice-4.2.0.2 tag (that is cd65d6220c5694ee7012d7863bcde3455c9e3c30 )This is only for the linux builds, as the buildfix only is about the package dependency problem, no code change.Difference between Win@42 buidls and the release builds is that the release one uses --with-distro=LibreOfficeWin32 configure switch, i.e. all switches from(and additionally also --enable-symbols to create the pdbs)I'll create a build and only mimic the options of the @42 box. That will tell whether VisualStudio 2012 vs Visual Studio 2010 is the problem...the build with only ia2 and none of the other feature-switches from distro-configCreatedclip of Process Explorer capture of soffice.bin crash with IA2 active on test buildChristian,(In reply to)Thanks for spinning up a test build. Unfortunately, no improvement with a /A administrative install.Attached a Process Explorer screen clip of hung soffice.binWith these additional stack traces...Stack trace fo soffice.bin main process 6976:=-=-=wow64cpu.dll!TurboDispatchJumpAddressEnd+0x6c0wow64cpu.dll!TurboDispatchJumpAddressEnd+0x4a8wow64.dll!Wow64SystemServiceEx+0x1cewow64.dll!Wow64LdrpInitialize+0x42bntdll.dll!RtlUniform+0x6e6ntdll.dll!RtlCreateTagHeap+0xa7ntdll.dll!LdrInitializeThunk+0xentdll.dll!ZwWaitForSingleObject+0x15ntdll.dll!RtlReportException+0x86ntdll.dll!RtlpNtEnumerateSubKey+0x1ab9ntdll.dll!RtlpNtEnumerateSubKey+0x1b36ntdll.dll!RtlpNtEnumerateSubKey+0x2a2cntdll.dll!RtlpNtEnumerateSubKey+0x2b0cntdll.dll!RtlUlonglongByteSwap+0xc811ole32.dll!CoGetComCatalog+0x4f7stack trace for sal3.dll process 5196:=-=-=wow64cpu.dll!TurboDispatchJumpAddressEnd+0x6c0wow64cpu.dll!TurboDispatchJumpAddressEnd+0x4a8wow64.dll!Wow64SystemServiceEx+0x1cewow64.dll!Wow64LdrpInitialize+0x42bntdll.dll!RtlIsDosDeviceName_U+0x23a27ntdll.dll!LdrInitializeThunk+0xentdll.dll!ZwWaitForSingleObject+0x15kernel32.dll!WaitForSingleObjectEx+0x43kernel32.dll!WaitForSingleObject+0x12sal3.dll!rtl_cache_free+0x395kernel32.dll!BaseThreadInitThunk+0x12ntdll.dll!RtlInitializeExceptionChain+0x63ntdll.dll!RtlInitializeExceptionChain+0x36stack trace for ole32 process 5200:=-=-=wow64cpu.dll!TurboDispatchJumpAddressEnd+0x6c0wow64cpu.dll!TurboDispatchJumpAddressEnd+0x56bwow64.dll!Wow64SystemServiceEx+0x1cewow64.dll!Wow64LdrpInitialize+0x42bntdll.dll!RtlIsDosDeviceName_U+0x23a27ntdll.dll!LdrInitializeThunk+0xentdll.dll!ZwDelayExecution+0x15KERNELBASE.dll!Sleep+0xfole32.dll!CoGetTreatAsClass+0x325eole32.dll!CoGetTreatAsClass+0x314bkernel32.dll!BaseThreadInitThunk+0x12ntdll.dll!RtlInitializeExceptionChain+0x63ntdll.dll!RtlInitializeExceptionChain+0x36And stack traces for the associated MSVCR100.dll process 2760:=-=-=wow64cpu.dll!TurboDispatchJumpAddressEnd+0x6c0wow64cpu.dll!TurboDispatchJumpAddressEnd+0x4a8wow64.dll!Wow64SystemServiceEx+0x1cewow64.dll!Wow64LdrpInitialize+0x42bntdll.dll!RtlIsDosDeviceName_U+0x23a27ntdll.dll!LdrInitializeThunk+0xentdll.dll!ZwWaitForSingleObject+0x15KERNELBASE.dll!WaitForSingleObject+0x12KERNELBASE.dll!GetOverlappedResult+0x57sal3.dll!osl_acceptPipe+0x80KERNELBASE.dll!RaiseException+0x58sal3.dll!osl_unloadUserProfile+0x829MSVCR100.dll!_endthreadex+0x3aMSVCR100.dll!_endthreadex+0xe4kernel32.dll!BaseThreadInitThunk+0x12ntdll.dll!RtlInitializeExceptionChain+0x63ntdll.dll!RtlInitializeExceptionChain+0x36and for process 3684:=-=-=wow64cpu.dll!TurboDispatchJumpAddressEnd+0x6c0wow64cpu.dll!TurboDispatchJumpAddressEnd+0xf5wow64.dll!Wow64SystemServiceEx+0x1cewow64.dll!Wow64LdrpInitialize+0x42bntdll.dll!RtlIsDosDeviceName_U+0x23a27ntdll.dll!LdrInitializeThunk+0xentdll.dll!NtWaitForMultipleObjects+0x15kernel32.dll!WaitForMultipleObjectsEx+0x8ekernel32.dll!WaitForMultipleObjects+0x18MSVCR100.dll!_endthreadex+0x3aMSVCR100.dll!_endthreadex+0xe4kernel32.dll!BaseThreadInitThunk+0x12ntdll.dll!RtlInitializeExceptionChain+0x63ntdll.dll!RtlInitializeExceptionChain+0x36Don't want to clutter up the BZ with additional, but if someone needs to see some other detail posted, happy to oblige. Any ideas?Any thoughts Michael ? :-)Createdstack trace of WinDbg attached analyze -v sessionTrace caught using WinDbg.exe (Win 8 SDK) attached to soffice.bin processCreateddump file of crashing soffice.binCreatedWinDbg analyze -v of soffice.bin dump fileA WinDbg analyze -v of the soffice.bin dump file caught during the IA2 bridge crash when entering an <Enter> key.Not much improved over the earlier traces.Stuart; the trace would be best done with the symbol server setup (or somesuch) I guess - or a build that has symbols; there is no good data there:*** ERROR: Symbol file could not be found. Defaulted to export symbols for vcllo.dll - *** ERROR: Symbol file could not be found. Defaulted to export symbols for sofficeapp.dll - *** ERROR: Symbol file could not be found. Defaulted to export symbols for soffice.bin - Cannot find frame 0x9, previous scope unchanged...are not good signs from that perspective.Beyond that - it looks like a heap corruption: these are exciting bugs to track on Windows. I'd recommend running it under:which makes it 40x slower or worse, but should catch the problem in a helpful way - it'd be fantastic to have some output from drmemory for this specifically - and ideally with symbols. With a drmemory trace (as with valgrind) it should point is ~directly at the real bug =)Thanks so much for chasing though !CreatedDrMemory run against soffice.exe, and open Writer. Issues in soffice.bin but no crashUse a DrMemory command line of:"drmemory -no_count_leaks -ignore_asserts -no_check_uninitialized -- soffice.exe"In this log, set IAccessible2 experimental feature enabled in advance in LibreOffice 4.2.0.2--launch of soffice.exe with command line above.Open a Writer session.But, I could not make soffice.bin crash with DrMemory running.However, Error(s) 5 & 6, and Error(s) 7 & 8 occur in Writer session when paragraph mark is first inserted and then with cursor movement another paragraph mark is deleted.Createdfull set of DrMemory logs for soffice.bin process logged in 92195 attachment-- an IA2 enabled writer sessionzip of full set of DrMemory logs, rather that the copy paste stderr log of.global.2292.logresults.txtpotential_errors.txtsuppress.txtmissing_symbols.txtThe DrMemory run seems to keep the soffice session open, resumes crashing on edit when run alone.(This is an automated message.)Setting priority to highest as this is a 4.2 MAB. This is part of an effort to make the importance of MAB reflected in priority too.I can reproduce on Windows 8.0 with LibreOffice Version: 4.2.0.2Build ID: cd65d6220c5694ee7012d7863bcde3455c9e3c30I cannot reproduce with the daily build Version: 4.2.1.0.0+Build ID: 23221e48495262d0384c9169a0d8a01db8a5dab5Since 4.2.0.3 is to be released shortly I'll wait for that release to try again. Keeping my fingers crossed that whatever was fixed between the releases above will be available in the next release candidate as well.On Windows 7 sp1, 64-bit withVersion: 4.2.0.3Build ID: c63c03decdf780d8fb80823950665b782ec9ecd0Sorry to have to report that the issues from the release build of RC2 continue with the RC3 build.Have enabled experimental features activating IAccessible2 AT support monitoring with NVDA (2013.2).WinDbg attached to soffice.bin process."receiving multiple (e64.db4): C++ EH exception - code e06d7363 (first chance)"errors. And on a rub out of paragraph mark see this error and its stack trace 'k' result.0:000> g(e64.ff8): Unknown exception - code c0000374 (first chance)(e64.ff8): Unknown exception - code c0000374 (!!! second chance !!!)eax=00bff12c ebx=00000000 ecx=77d20b42 edx=00bfeec9 esi=00c00000 edi=65a55c1ceip=77d7e753 esp=00bff11c ebp=00bff194 iopl=0 nv up ei pl zr na pe nccs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00000246ntdll!RtlpNtEnumerateSubKey+0x1b26:77d7e753 eb12 jmp ntdll!RtlpNtEnumerateSubKey+0x1b3a (77d7e767)0:000> kChildEBP RetAddr WARNING: Stack unwind information not available. Following frames may be wrong.00bff194 77d7f659 ntdll!RtlpNtEnumerateSubKey+0x1b2600bff1a4 77d7f739 ntdll!RtlpNtEnumerateSubKey+0x2a2c00bff1d8 77d39cb1 ntdll!RtlpNtEnumerateSubKey+0x2b0c00bff200 64e4959c ntdll!RtlUlonglongByteSwap+0xc81100bff224 772e625c AcXtrnal+0x959c00bff238 770b443a ole32!CoGetComCatalog+0x4f700bff25c 770b3ea3 OLEAUT32!GetErrorInfo+0x51900bff278 770b7803 OLEAUT32!SysFreeString+0x4a00bff288 76d87af6 OLEAUT32!BSTR_UserFree+0x1900bff2c0 76e0083e RPCRT4!NdrUserMarshalFree+0x3700bff2e4 76e0072a RPCRT4!NdrStubCall2+0x4a300bff6f0 773dd7e6 RPCRT4!NdrStubCall2+0x38f00bff738 773dd876 ole32!WdtpInterfacePointer_UserUnmarshal+0x256f00bff780 773dddd0 ole32!WdtpInterfacePointer_UserUnmarshal+0x25ff00bff7cc 772f8a43 ole32!WdtpInterfacePointer_UserUnmarshal+0x2b5900bff8a8 772f8938 ole32!CoTaskMemFree+0x1b0200bff8c4 772f950a ole32!CoTaskMemFree+0x19f700bff8f0 773ddccd ole32!DcomChannelSetHResult+0x8ff00bff924 773ddb41 ole32!WdtpInterfacePointer_UserUnmarshal+0x2a5600bffa04 773de1fd ole32!WdtpInterfacePointer_UserUnmarshal+0x28ca00bffa2c 772f9367 ole32!WdtpInterfacePointer_UserUnmarshal+0x2f8600bffa40 772f9326 ole32!DcomChannelSetHResult+0x75c00bffa84 76e862fa ole32!DcomChannelSetHResult+0x71b00bffab0 76e86d3a USER32!gapfnScSendMessage+0x33200bffb28 76e877c4 USER32!GetThreadDesktop+0xd700bffb88 76e8788a USER32!CharPrevW+0x13800bffb98 65423a00 USER32!DispatchMessageW+0xf00bffbd4 65423b70 vcllo!WorkWindow::IsMaximized+0x9cf000bffbf8 650c8127 vcllo!WorkWindow::IsMaximized+0x9e6000bffc10 650c80b0 vcllo!Application::Execute+0x9700bffd8c 650d2b21 vcllo!Application::Execute+0x2000bffdb4 70e3a80f vcllo!EmbeddedFontsHelper::operator=+0x17100bffe14 01251051 sofficeapp!soffice_main+0xbf00bffeb0 771a336a soffice!main+0x5100bffebc 77ce9f72 kernel32!BaseThreadInitThunk+0x1200bffefc 77ce9f45 ntdll!RtlInitializeExceptionChain+0x6300bfff14 00000000 ntdll!RtlInitializeExceptionChain+0x36The behavior changed a bit for me, now I need to add a page break (Ctrl + Enter) and then press backspace to trigger the crash. Verified that no crash is triggered in the 4.2.1+ build.I'm running a build from the 4-2 branch and can't reproduce the problem at all - presumably I need to build -4-2-0 now ...@Michael,(In reply to)I have ONLY experienced the issue with the two LO Production releases built on Christian's release build system.Either of these build trees:The TB 42 builds have remained clear of the issue, and I have not heard from anyone who rolls their Windows builds own having the issue.I don't know, but couldn't it be one of these:1) the build with debug is enabled (no problem on TB 39 builds of master), or2) it is a MSVC 2010 based build, or3) something in the OLE32 and OLEAUT32 support for the release build config?This is pretty depressing - I built 4-2-0 here from "Don't crash on unstarted table" incrementally on top of 4-2 and I can't reproduce the problem at all.Works perfectly for me. NVDA is reading nicely, showing selections etc. etc.I'm using Visual Studio Professional 2012. I'll do a build from clean this time with the release configuration.Christian - can you confirm the configuration you're building with ? is it only --with-distro=LibreOfficeWin32 ?Of course - it could be related to on-line help or somesuch; a11y does touch some funny code-paths, and I never build with that ...Thanks ! =)So here is an interesting twist. The TB's have been down, but noticed Chrisitian's TB 47 build of master was posted. So downloaded it and the en-US help and did an /A administrative install.On Windows 7 sp1, 64-bit with NVDA 2013.2 running for ATVersion: 4.3.0.0.alpha0+Build ID: 04c3d13ed942e6fc9feb78535701d48e5034d9e2TinderBox: Win-x86@47-TDF, Branch:MASTER, Time: 2014-01-26_00:10:53Runs without issue with out AT active. But as soon as I activate AT and relaunch, I get a crash on activity to launch a module -- Writer in this caseAttach soffice.bin process to WinDbg, and get a series of first chance exceptions. Symbols are a residual from TB 39 or 4.2.0.3, but some hits.Seem to all be MSVCR100!_CxxThrowExceptionHave to navigate through a couple of dozen first chance exceptions before I can get the debugger to run on the writer session. Even then doesn't seem to be a specific action that will crash the writer session. Don't know if I'm cycling from WinDbg for long enough.Point is, that the issue is no longer confined to the 4.2.0.3 RC, but is also appearing on Christian's TB 47 system build.Stuart - great data point - thanks so much for that; I'll give up trying to reproduce with 4-2-0 - I did a release build locally with VS 2012 - and can't reproduce the problem despite having the lang-packs and all that good stuff =)I strongly suspect this is an MSVC 2010 bug - almost certainly related to Link Time Optimisation, which we should disable by default for now for 4-2-0 I think ...running a build right now with the --disable-lto switch(the @47 tinderbox uses the same setup as for the release builds - so no surprise it is also affected, the other windows tinderboxes however use newer compiler)Compiler conspiracy theories aside (perhaps they provoke some race or other) ;-) I have a good hard crash in UAccCom.dll here where: CMAccessible::get_attributes() is called on an object where m_isDestroy is true and m_xAccessible is cleared / empty.Just pushed a patch that adds a number of checks vs. that sort of thing ...Michael Meeks committed a patch related to this issue.It has been pushed to "master":fdo#73464 - guard against NULL / unset m_xAccessible.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Meeks committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#73464 - guard against NULL / unset m_xAccessible.It will be available in LibreOffice 4.2.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Meeks committed a patch related to this issue.It has been pushed to "libreoffice-4-2-0":fdo#73464 - guard against NULL / unset m_xAccessible.It will be available already in LibreOffice 4.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.← build with the --disable-lto switchNo difference with the non-LTO build - well - it still crashes; but of course there could have been two bugs - I suggest we disable LTO here anyway just in case (we can't explain a difference otherwise).Beyond that the crash I get looks just like the thing I fixed above.Michael Meeks committed a patch related to this issue.It has been pushed to "libreoffice-4-2-0":Disable LTO for now - suspected cause of fdo#73464.It will be available already in LibreOffice 4.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.@Michael(In reply to)Cool! Will have a go on next round of TB builds. Meanwhile, noticed over on the AOO side that Mick Curran (co-lead on the NVDA project) reached the same conclusion and contributed a patch to MAccessible.cpp that Steve Yin has rolled in as rev 1561587 (). It looks to be touching some of the same issues and might be worth a review.StuartMichael Meeks committed a patch related to this issue.It has been pushed to "master":fdo#73464 - get relation BSTR allocation right.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Meeks committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#73464 - get relation BSTR allocation right.It will be available in LibreOffice 4.2.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.My thesis is that this BSTR allocation mess-up is something that the C run-times for 2010 and 2012 differ on - the latter being more tolerant of people doing stupid stuff with BSTRs (perhaps), and that's why we were getting the crash only with a 2010 build.Michael Meeks committed a patch related to this issue.It has been pushed to "libreoffice-4-2-0":fdo#73464 - get relation BSTR allocation right.It will be available already in LibreOffice 4.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Meeks committed a patch related to this issue.It has been pushed to "libreoffice-4-2":Disable LTO for now - suspected cause of fdo#73464.It will be available in LibreOffice 4.2.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Was the BSTR allocation (and the other crash) all along; we can prolly re-enable LTO for 4.2.1 on the -4-2 branch in a bit: I imagine it helps.Glad to see this working smoothly (for me at least) in the Win-x86@47 TDF builds as of 2014-01-27_19.12.00Whoot =)Downloaded Christian's TB 47 build of Master with today's patches, no problems with it now on a /A administrative install on Windows 7 sp1, 64-bit and NVDA 2013.2 and AccProbe active for AT.Version: 4.3.0.0.alpha0+Build ID: 7f2a2d2b05e64ee425f95d189ed6ef32d8895ab9TinderBox: Win-x86@47-TDF, Branch:MASTER, Time: 2014-01-27_19:12:00Actions that would crash prior builds are running without issue. Assuming patches all make it down for the 4.2.0 branch for next RC build, concur in calling this Resolved Fixed. Thanks to all.Verified fixed on today's LibreOffice 4.2.0.4 RC4 build!Version: 4.2.0.4Build ID: 05dceb5d363845f2cf968344d7adab8dcfb2ba71Full custom* installation on Windows 7 sp1, 64-bit with NVDA (2013.2) active and using the 'Enable AT support' check box during install. Then activating 'Enable experimental features' during first launch. *Custom -- deselect additional dictionaries, quickstarter, automatic updates and the non-linear problem solver, and include language support for english only.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-4-2":Revert "Disable LTO for now - suspected cause of fdo#73464."It will be available in LibreOffice 4.2.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=74325	Createdsee bug description: ods-file with many comments to reproduce the bugI have changed an ods file with many comments. I have saved the file and all comments are present before I close it. When I re-open the file some or all comments are lost.Example, how bug can be reproduced:- copy "File altix_Nummern_aktuell_bearb_Lange.ods" (attached, file size 777.799) to e.g. "altix_Nummern_aktuell_bearb_Lange - LO_4.2.ods"- insert in "File altix_Nummern_aktuell_bearb_Lange - LO_4.2.ods" sheet "Alle" a new line before the line 2516 (*** Ende ***)- Save the file --> comments are still present- Close it -> file is smaller (new file size on my system is 644.596))- Open the fiile again --> Comments are lost Argh!!! Data loss!Easier steps to reproduce:1/ create a new empty spreadsheet with LO 4.2.02/ type a in cell A1 (or something else)3/ extend A1 to C16 (or something else)4/ in B7 (or elsewhere) do ctrl+alt+C to insert a comment; type something in the comment field5/ save the document and close it6/ reopen the file, the comment is still there7/ save the document under another name and close it8/ reopen the new (second) filecurrent behavior: the comment is gone. That can be verified in the Navigator.Tested with LO 4.2.1.0.0+ under Ubuntu. Please confirm with 4.2.0.4.Best regards. JBFReproduce on LibreOffice 4.2.0.4 Build ID: 05dceb5d363845f2cf968344d7adab8dcfb2ba71 Ubuntu 12.04.4 x86_64But,7/ save the document _in other folders_ under another name and close it8/ reopen the new (second) fileConfirmed on master built about 30 minutes ago.@ Markus - thoughts on this one?***has been marked as a duplicate of this bug. ***@which O/S do you run? Windows, Linux or Mac?He was running Windows (as it was marked as Windows (all)) but we've confirmed on Linux as wellKohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#74325: Write unit test for cell note export to ods.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#74325: Ensure that all note objects have an sdr object before exporting.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.The export code currently relies on the SdrObject note caption objects to see if the note is present or not. In some cases, a note object may not have an associated SdrObject present at the time of export (e.g. when loading a document with cell comment inside and the comment is not displayed). In such cases, the export code skips the note.4.2 backport request:Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#74325: Ensure that all note objects have an sdr object before exporting.It will be available in LibreOffice 4.2.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Marking it fixed.Verified fixed in master (Build ID: 85579b1318bec424c87dde567ac1dee6a52da90c) and LO 4.2.1.0.0+.Thank you very much, Kohei !Best regards. JBFMy test withVersion: 4.2.1.0.0+Build ID: 17593b3e00c4d73a1985dfc1fae976d211aee007TinderBox: Win-x86@42, Branch:libreoffice-4-2, Time: 2014-02-03_09:29:12was succesful: Comments were no longer lost - also not after repeated Save. Many thanks!***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Migrating Whiteboard tags to Keywords: (dataLoss)Remove redundant 'ConfirmedRegression'[NinjaEdit]
id=74488	Createdscreenshot of windows system logProblem description: Draw not running.Steps to reproduce:1. Run DrawCurrent behavior:Crash and restarted LibreOfficeExpected behavior:Run DrawOperating System: Windows 7Version: 4.2.0.4 releaseLast worked in: 4.1.4.2 release *** This bug has been marked as a duplicate of***Migrating Whiteboard tags to Keywords: (possibleRegression)[NinjaEdit]
id=74493	Bug discovered on LibreOffice 4.1.5.2Steps to reproduce:1/ open a new spreadsheet2/ in A1 enter aaa, in B1 enter bbb3/ save the file4/ reload the file5/ in A5 enter zzz6/ save the file7/ reload the file : you find bbb in A58 in C1 enter ccc and save the file9 reload the file : you find ccc in C1 and in A5Expected behavior: Calc keeps the entered data. ;-)Best regard. JBF NoRepro:4.2.0.4:OSXConfirmed by the FR QA team - set as New - Sophie(In reply to)Yes, it concerns 4.1.5 only.Best regards. JBFCreatedfile saved by LO 4.1.5.2Open this file with LO 4.1.5.2 you get bbb in A5.Look at its content.xml : there is zzz in A5Same problem if I open this file with LO 4.2.1.0.0+Best regards. JBFTaking.Pending reviewfor 4-1 atfor 4-1-5 atEike Rathke committed a patch related to this issue.It has been pushed to "libreoffice-4-1":resolved fdo#74493 do not trust aCell.maBaseCellIt will be available in LibreOffice 4.1.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Eike Rathke committed a patch related to this issue.It has been pushed to "libreoffice-4-1-5":resolved fdo#74493 do not trust aCell.maBaseCellIt will be available already in LibreOffice 4.1.5.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Verified in 4.1.5.2.0+ (Build ID: 9cb9d32c7a64bf5789eabe47d901237d78b44a4)Thank you very much for the quick fix.Best regards. JBF***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***
id=74527	Createdorigibal file whitout problemsthe content of the last row in the first line overwrites all following cells in first row.how to reproduce:load the file "original"write something in the lines in the first left row.store the fileopen again the written file.results are to be seen in file ttods-03very dangerous bug, because all original data is destroyedthe second file is sent with the next message, seems that there is only one file to be sent whith each message Createdfile with overwritten contents first row many linesHi gerdl, thanks for reporting.Reproducible with:Win7x64UltimaateVersion: 4.1.6.0.0+ Build ID: 2d0b2cb6b7ca48663d09118acfb01a1dd194a1eNot reproducible with:Version 4.0.6.2 (Build ID: 2e2573268451a50806fcd60ae2d9fe01dd0ce24)Version: 4.2.0.4 Build ID: 05dceb5d363845f2cf968344d7adab8dcfb2ba71Regression and severe data loss saving in ods format.duplicate of.Bets regards. JBF*** This bug has been marked as a duplicate of***
id=75686	CreatedFile as created in LO4.3Start with a new text document on LO 4.3Write the formula bold{(1)}Save the document.Open the document in an older version. I used LO4.0.You will notice a wrong preview image (that is already). Double click the formula and leave edit mode without any changes.Save the document.Open the document with LO4.3 => Crash. CreatedFile resaved by LO4.2I see the same crash, when the file was resaved be LO4.2Hello Regina,I reproduce with LO 4.3.0.0.alpha0+Build ID: 7122ef19847b26529ed1d5bad40df869e91a8495TinderBox: Win-x86@39, Branch:master, Time: 2014-03-06_00:38:21& Windows 7 Home Premium.Inserting a formula into an .odt file with LO 3.6.6.2 and opening it with LO 4.3.0.0.alpha0+ give the crash too. So it semms that all old odt documents with formulas cannot be opened with master.Writer only concerned?...Set status to NEW.Kind regards,JacquesSame behaviour with an Impress document that contain only a formula saved with LO 4.2.2.1 and opened with LO 4.3.0.0.alpha0+. In this case, trying to open give first a crash. The second opening give a slide with no formula. Third opening give the correct result. The next openings are correct.Kind regards,JacquesI could NOT reproduce this with:Version: 4.3.0.0.alpha1+Build ID: f3a46244a07b76d633ccc7f83da3fa502612e978TinderBox: Win-x86@42, Branch:master, Time: 2014-05-20_07:23:58Is this still reproducible for you?Right Thomas,Those behaviors desappear with LO 4.3.0.0.alpha1+Build ID: 657004ae5c9f4a07b2cdafbb21bc8657842d4d74TinderBox: Win-x86@39, Branch:master, Time: 2014-05-08_00:35:12JacquesWonderful :) Maybe this was introduced by some string conversion or something else. There were many fixes in starmath.
id=76502	After the installation of the 4.2.2.1 release, when its first launching, Comodo antivirus detect that soffice.exe is infected by CloudScanner.Trojan.Gen@2@1 and put it in quarantaine. I cannot reproduce this issue with norton security, mcaffee enterprise 8.7 or clamav. Are you download your installation file from the libreoffice site directly or from a third party site?Can you check the md5sum of your downloaded file, please?Antivirus results are not really under our control. When I developed portable applications for Windows, there were antivirus software that detected “false positives” in my innocent code. The same could happen to LibreOffice, but that shouldn’t happen (at least not too often) because official TDF builds are digitally signed.Hello,Sorry for the delay; I have some health problems.As I don't remember if I downloaded from the french or from the generalLibreOffice site, I have uninstalled LibreOfficeand reinstalled LibreOffice v4.2.2.1 from :and verified MD5 sum : OKand re-tested against Comodo Antivirus : no virus detectedI unistalled LibreOffice and reinstalled v4.2.2.1 from :and verified MD5 sum : OKand re-tested against Comodo Antivirus : no virus detectedSo, everything seems OK. I don't understand what hapened.Thank you for your quick help.Best regards. [UTF-8?] Michel COLLET ----- DCLIC 132, rue de Rosny - 93100 MONTREUIL-Sous-BOIS - FRANCE phone +33 (0)1 4857 2406 [UTF-8?] - [UTF-8?] [UTF-8?]----- ---------- Original Message -----------href="" class="email"> PapamattiI cannot reproduce thisissue with norton security, mcaffee>
id=76949	Createdsimple test case documentNew functions not defined in OOXML (e.g. introduced in Excel 2010) are saved without the _xlfn. prefix and when the document is reloaded the functions are not recognized and lead to #NAME? errors when recalculated. For example functions BETA.DIST and CHISQ.DIST and all others implemented in Calc in the mean time.Load attached test case document, save as Excel 2007 .xlsx, reload .xlsx, hit Shift+Ctrl+F9 Eike Rathke committed a patch related to this issue.It has been pushed to "master":resolved fdo#76949 correct grammar is GRAM_OOXMLThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Pending reviewfor 4-2 atfor 4-2-3 atEike Rathke committed a patch related to this issue.It has been pushed to "libreoffice-4-2":resolved fdo#76949 correct grammar is GRAM_OOXMLIt will be available in LibreOffice 4.2.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Eike Rathke committed a patch related to this issue.It has been pushed to "libreoffice-4-2-3":resolved fdo#76949 correct grammar is GRAM_OOXMLIt will be available already in LibreOffice 4.2.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=77163	Hi thereMy company (50k+ employees) intends to use LibreOffice as a primary software but we have one very annoying problem and i'm sure this problem is global.We are using Georgian keyboard.When using Georgian keyboard and want to use Ctrl+C, Ctrl+V or any other shortcut key has no effect.This bug may be is secondary for someone but for us makes LibreOffice almost unusable.I am sure bug presents for other languages rather then Georgian.Please correct the problem as soon as possible.Thanks in advance.Best regards. ***has been marked as a duplicate of this bug. ****** This bug has been marked as a duplicate of***
id=77913	CreatedShowing the error in a 4.3 alpha1+ masterPlease have a look at the attached screenshot for more infos. It is difficult to describe. All other menu entries are invisible, but the current on withVersion: 4.3.0.0.alpha1+Build ID: 808d273db098e2269e53813595a6bfc7b160e28eTinderBox: Win-x86@39, Branch:master, Time: 2014-04-25_02:09:26With another daily from 2014-04-20 and from another thinderbox the behaviour is as expected.Not well working core-functions -> critical-high + regression keyword This is not just a 64 bit windows bug. After I did a "git reset --hard origin/master" the menu's were all blank, except when the mouse is hovering over an item.$ lsb_release -rcd ; uname -rmDescription: Linux Mint 16 PetraRelease: 16Codename: petra3.11.0-12-generic i686As a temp workaround, you can do a:$ SAL_USE_VCLPLUGIN=gen ./soffice***has been marked as a duplicate of this bug. ***On pc Debian x86-64 with master sources updated today, I can reproduce this.When just hovering menus without try to select an entry it's ok, but when you hover inside any menu, only the current entry of the menu displays.It's not a crash but it's a big regression of a core basic feature used a lot by a lot of people, IMHO it's a blocker.Chris/Caolán: one for you? (vcl part I suppose)When I gave a try to fdo#77934, I saw that the bug was also present in context menus (which appears with right click)***has been marked as a duplicate of this bug. ***I think this commit 0ef2999f7b498686ad38749b93f0591dd52bcc50 solved the problem.At least, it's ok right now after having updated local master sources.Florian/Joren/Luke: Could you give a try with master sources updated after this commit?Just checked and it is resolved! Thanks :)***has been marked as a duplicate of this bug. ***Caolan's commit message explains what happened here:given the explanation of MenuFloatingWindow::InitClipRegion() it should not be virtual then prior to 95711f5b9e7b6a982d1762d37d5a38e0f40b86f9 the menu ImplInitClipRegion had nothing to do with the outdev ImplInitClipRegion and so all the original ImplInitClipRegion calls here should now be routed to InitMenuClipRegion which was removed by "In fact InitMenuClipRegion() is unused" so restore that.In other words, Windows derives from OutputDevice and this had a virtual function IntiClipRegion. However, MenuFloatingWindow derives indirectly from Window, but it used the function InitClipRegion for an entirely different purpose. When it was made virtual, it caused this issue.Verified using windows 8.1 using Version: 4.3.0.0.alpha1+Build ID: 145f2e970f46a3a3e5456b122d71f17c3abe878fTinderBox: Win-x86@42, Branch:master, Time: 2014-04-26_23:32:36Kind regards,Joren
id=78133	I opened LibO 4.3 alpha and when i was going through the options dialog, if i click on the 'Colors' entry, LibO will crash. Thinking about it just now, i think this must also relate to the color drop down in. Createdconsole logs + bt with symbolsOn pc Debian x86-64 with master sources updated today, I can reproduce this crash.I put max priority because:- it's a core function- no workaround- crash- regressionPatch on master sources for review:hmm, that pDrDoc has a GetColorList method, maybe we should call that one on the pDrDoc branch and leave the "generic" color list on the other branchIt does not crash for me in Build ID: 46cfcd5a05aa1d13fecd73f5a25b64b8d8dd6781 on Linux (fresh user profile) - but that may be an older build.How the *piep* can Severity and Priority change themselves with me just giving a comment? (Due to FF crashing just before commenting??)I found it weird that you changed it and was going to change it back, but didnt want to step on any toes. :)Caolán: I've changedaccordingly to what you said. Would you have some time to validate it?Julien Nabet committed a patch related to this issue.It has been pushed to "master":Resolves: fdo#78133 LibO crashes when in options dialog (Colors part)The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.(In reply to)It happened me before... No idea which ghost is hunting me ;)@julien: thanks !***has been marked as a duplicate of this bug. ***
id=78917	CreatedVideo of the crashsHi,Repro steps: Open impres with a recent daily build. Tested with Win 7 and Version: 4.3.0.0.alpha1+Build ID: f62de9113a4866f7152acbe0e8221c594b7a7b68TinderBox: Win-x86@51-TDF, Branch:MASTER, Time: 2014-05-17_07:51:54I attach a video showing the problem no crash with 4.3.0.0.alpha1+Build ID: a1dd961c3093f5f7624e4d1f2240e9120fd13f23TinderBox: Win-x86@39, Branch:master, Time: 2014-05-06_11:47:48No repro Windows 8.1 with LibreOffice Version: 4.3.0.0.alpha1+Build ID: cd11bc699ac50af4f560ed5f2e5e7903de0898b8TinderBox: Win-x86@51-TDF, Branch:MASTER, Time: 2014-05-20_08:02:54again no repro with more recent 4.3.0.0.alpha1+Build ID: 19979ae27055cb910bfc368bfc2899d211f56be1TinderBox: Win-x86@39, Branch:master, Time: 2014-05-21_00:29:23@Floriando you still see that problem?WFM with Version: 4.3.0.0.alpha1+Build ID: cd11bc699ac50af4f560ed5f2e5e7903de0898b8TinderBox: Win-x86@51-TDF, Branch:MASTER, Time: 2014-05-20_08:02:54 on Win 7Win XP seems to have such problems still...
id=78918	CreatedVideo of the crashsHi,Repro steps: Open a new calc document and type till the crash (not very long). Tested with Win 7 and Version: 4.3.0.0.alpha1+Build ID: f62de9113a4866f7152acbe0e8221c594b7a7b68TinderBox: Win-x86@51-TDF, Branch:MASTER, Time: 2014-05-17_07:51:54I attach a video showing the problem *** This bug has been marked as a duplicate of***
id=78919	CreatedVideo of the crashsHi,Repro steps: Open a new writer document and type till the crash (not very long). Tested with Win 7 and Version: 4.3.0.0.alpha1+Build ID: f62de9113a4866f7152acbe0e8221c594b7a7b68TinderBox: Win-x86@51-TDF, Branch:MASTER, Time: 2014-05-17_07:51:54I attach a video showing the problem *** This bug has been marked as a duplicate of***
id=79105	OS – Windows XP 32&64 bit Edition.The new regression (to the 1st alpha; only in Windows):The dictionaries based on Light Proof (English, Hungarian and Russian) don't work. Attempt to start the Writer leads to the LibreOfficeDev crash. LibODev-4.3.0.0.beta1 works normally if dictionaries are removed.It seems to me incorrect assembly MSI package (build environment) caused this error. The bug had appeared two weeks ago. OK in LibreOffice-4.3.0.1 so RESOLVED
id=79269	I filed this bug a while ago, but at that time it suddenly became not reproducible on my PC, and the person who answered me could not reproduce it either.Now I got it again. I am 100% _sure_ that footers are _not_ saved.It stopped working again right after I updated LibreOffice from 4.2.x to 4.2.4.2. I do not remember exact version number of previous version. I could possibly find out version of previously installed LibreOffice from my previous bug report, but sadly I could not find it. Looks like my previous bug report got deleted.Footers are not saved in my document. I uncheck "same content for first page" in footer format dialog, then I add page number filed to the footer of second page, then I save document, then I close document, then I open document, then I see no footers at all. "same content for first page" option gets checked again.I already tried multiple times, it always happens. I can post my document if it helps.I now think that this issue is related to updating. I installed new version of LibreOffice using windows installer from official web site. I now remember that last time when saving footers didn't work for me before it also happened right after I updated LibreOffice. In fact that time I did not update LibreOffice but rather uninstalled OpenOffice and then installed LibreOffice, then saving footers stopped working, but later is started working again. But this time it does not work at all. I don't remember what exactly I did previous time to make it work. It seemed completely random. But this time I tried already like 8 times, and... well.... footers are _not_ saved :/Thanks for your attention. Confirmed on Linux Mint with 4.0.6, 4.2.4 and 4.3 beta 1. LibO 3.6 does have the footer option.Here are some simple steps.1. Open writer2. Make a page break so you have 2 pages3. Menu > Format > Page > Footer - uncheck 'same content on first page'4. In footer of first page type 'WhatsApp'5. In footer of second page insert page number6. Save file as odt7. Reopen file and 'same content on first page' has been rechecked resulting in 'WhatsApp' appearing on the second page.I tested saving the file as .doc and .docx and it opened correctly. Saving it as .rtf resulted in it opening with only a single page and 'WhatsApp' was gone and only the page number was retained. I tested the saved .odt in calligra and it had the page number on both pages.Your previous bug report is. :)I've set this to higest-blocker as data is being lost in the footnote.***has been marked as a duplicate of this bug. ***Just confirmed that unchecking 'same content on first page' in the header is fine in 4.3 beta but not in 4.2. You can see this if you useand save it as a docx and then reopen it, then the headers on page 2 and 3 are gone.I also experience this problem on Debian testing (jessie).Version: 4.3.0.4Build-ID: 430m0(Build:4)the problem actually happens on importfixed on masterMichael Stahl committed a patch related to this issue.It has been pushed to "master":fdo#79269: fix ODF import of style:footer-firstThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "master":fdo#79269: sw: more cleanup of SwXStyle's FirstIsShared propertyThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "master":fdo#79269: add a unit test for first-page header tooThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-4-3":fdo#79269: fix ODF import of style:footer-firstIt will be available in LibreOffice 4.3.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Migrating Whiteboard tags to Keywords: (filter:odt, DataLoss)[NinjaEdit]
id=79714	While attempting to retest status of, I downloaded the test file provided there and loaded it into my master build.When I double click on good query, I get an immediate crash, Apple stack trace enclosed. Createdstack traceCreatedbtIn fact, any aatempt to open a query or table causes the crashOn pc Debian x86-64 with master sources updated yesterday, I don't reproduce this.MacOS only bug?Alex: what's the build date? If more than 1 week, could you give a try to a newer one?Julien, yes, it is OSX only. My build dates from 04/06/2014Just if you have 4.3 or 4.2 in parallel (if not, don't bother), do you reproduce this too on 4.3/4.2 daily builds?(In reply to)On 4242 production release, it doesn't crash.Createdbt with 4-4On MacOs 10.7.5 with 2014/06/07 daily build, I got a different bt.I got the same bt with 4.3 on MacOSHum, in fact once I removed LO directory profile, I don't reproduce this with 4.3 daily build...Still crashes for me on 10.9.2 with master, even after removing all LO profilesJulien, are you using 32 or 64 bit versions of LO - mine are all 64bit ?LO 4.3 beta 2 is 32bitLO 4.3 beta 2 also crashes with same trace on OSX 10.9.2I'm on OSX 10.9.3, not 10.9.2, as previously indicatedexception std::bad_alloc means that the "new" operator failed to allocate memory... If you can attach a debugger and see what happens in OResultSetMetaData::getColumnName when the exception is thrown, it would be useful. Is suspect that m_pSqlda->sqlvar[column-1].sqlname_length contains an unreasonable value.After having built LO with master sources on MacOs (64bits build), I got a crash this:warn:legacy.osl:522:1:connectivity/source/drivers/firebird/DatabaseMetaData.cxx:845: Not implemented yet!warn:connectivity.firebird:522:1:connectivity/source/drivers/firebird/Util.cxx:243: Unknown type: 0Assertion failed: (false), function mallocSQLVAR, file /Users/julien/lo/core/connectivity/source/drivers/firebird/Util.cxx, line 244.warn:legacy.tools:522:1:vcl/source/window/dialog.cxx:794: Dialog::StartExecuteModal() - Parent not visibleCreatedbt with MacOsFirst bt retrieved on MacOS with built sources! :)(In reply to)That's the fatal one: wants to allocate memory for a SQL variable, but gets an unknown type, namely zero. Need to step through how pSqlda is constructed in the *parent* in the backtrace (namely OStatementCommonBase::prepareAndDescribeStatement) to see how / why one gets a type if "0" (or 1, since the 1 bit is masked out).Adding some traces on connectivity/source/drivers/firebird/Statement.cxx in executeQuery, I got this on Linux: sql : SELECT DISTINCT indices.RDB$INDEX_NAME FROM RDB$INDICES indices JOIN RDB$INDEX_SEGMENTS index_segments ON (indices.RDB$INDEX_NAME = index_segments.RDB$INDEX_NAME) JOIN RDB$RELATION_FIELDS relation_fields ON (index_segments.RDB$FIELD_NAME = relation_fields.RDB$FIELD_NAME) JOIN RDB$FIELDS fields ON (relation_fields.RDB$FIELD_SOURCE = fields.RDB$FIELD_NAME) WHERE (indices.RDB$SYSTEM_FLAG = 0) AND ((fields.RDB$FIELD_TYPE = 14) OR (fields.RDB$FIELD_TYPE = 37)) AND (indices.RDB$INDEX_INACTIVE IS NULL OR indices.RDB$INDEX_INACTIVE = 0) m_pSqlda : 0warn:legacy.osl:29078:1:connectivity/source/drivers/firebird/DatabaseMetaData.cxx:845: Not implemented yet! sql : SELECT RDB$RELATION_NAME, RDB$SYSTEM_FLAG, RDB$RELATION_TYPE, RDB$DESCRIPTION, RDB$VIEW_BLR FROM RDB$RELATIONS WHERE ( (0 = 1) OR (RDB$SYSTEM_FLAG IS NULL OR RDB$SYSTEM_FLAG = 0 AND RDB$VIEW_BLR IS NULL) OR (RDB$SYSTEM_FLAG IS NULL OR RDB$SYSTEM_FLAG = 0 AND RDB$VIEW_BLR IS NOT NULL) ) AND RDB$RELATION_NAME LIKE '%' ORDER BY RDB$RELATION_TYPE, RDB$RELATION_NAME m_pSqlda : 0 sql : SELECT RDB$RELATION_NAME, RDB$SYSTEM_FLAG, RDB$RELATION_TYPE, RDB$DESCRIPTION, RDB$VIEW_BLR FROM RDB$RELATIONS WHERE (RDB$RELATION_TYPE = 0 OR RDB$RELATION_TYPE = 1) AND RDB$RELATION_NAME = 'Exchange' ORDER BY RDB$RELATION_TYPE, RDB$RELATION_NAME m_pSqlda : 0 sql : SELECT relfields.RDB$RELATION_NAME, relfields.RDB$FIELD_NAME, relfields.RDB$DESCRIPTION,relfields.RDB$DEFAULT_VALUE, relfields.RDB$FIELD_POSITION, fields.RDB$FIELD_TYPE, fields.RDB$FIELD_LENGTH, fields.RDB$FIELD_PRECISION, relfields.RDB$NULL_FLAG FROM RDB$RELATION_FIELDS relfields JOIN RDB$FIELDS fields on (fields.RDB$FIELD_NAME = relfields.RDB$FIELD_SOURCE) WHERE (1 = 1) AND relfields.RDB$RELATION_NAME = 'Exchange' AND relfields.RDB$FIELD_NAME LIKE '%' m_pSqlda : 0 sql : SELECT * FROM "Exchange" WHERE 0 = 1 m_pSqlda : 0 sql : SELECT constr.RDB$RELATION_NAME, inds.RDB$FIELD_NAME, inds.RDB$FIELD_POSITION, constr.RDB$CONSTRAINT_NAME FROM RDB$RELATION_CONSTRAINTS constr JOIN RDB$INDEX_SEGMENTS inds on (constr.RDB$INDEX_NAME = inds.RDB$INDEX_NAME) WHERE constr.RDB$RELATION_NAME = 'Exchange' AND constr.RDB$CONSTRAINT_TYPE = 'PRIMARY KEY' ORDER BY inds.RDB$FIELD_NAME m_pSqlda : 0In comparison on MacOs, the last logs show:sql : SELECT * FROM "Exchange" WHERE 0 = 1m_pSqlda : 0After some tests, I noticed Debian x86-64 (Intel i5) was considered as OSL_BIGENDIANwhereas MacOs 10.9.3, i5 too! wasn't considered as OSL_BIGENDIANso this could be the problem:int dtype = (pVar->sqltype & ~1);"~1" should be changed if not BIG_ENDIANCreatedValgrind logAn interesting part:==24845== Conditional jump or move depends on uninitialised value(s)==24845== at 0x4D59E54A: UTLD_parse_sql_info(long*, unsigned short, char const*, XSQLDA*, unsigned short*) (utld.cpp:234)==24845== by 0x4D3723BD: iterative_sql_info(long*, unsigned int*, unsigned short, char const*, short, char*, unsigned short, XSQLDA*) (why.cpp:5564)==24845== by 0x4D3690F0: isc_dsql_describe (why.cpp:2455)==24845== by 0x4D047744: connectivity::firebird::OStatementCommonBase::prepareAndDescribeStatement(rtl::OUString const&, XSQLDA*&, XSQLDA*) (StatementCommonBase.cxx:200)==24845== by 0x4D045E8D: connectivity::firebird::OStatement::executeQuery(rtl::OUString const&) (Statement.cxx:118)This patch:diff --git a/connectivity/source/drivers/firebird/StatementCommonBase.cxx b/connectivity/source/drivers/firebird/StatementCommonBase.cxxindex 381b14b..49415fa 100644--- a/connectivity/source/drivers/firebird/StatementCommonBase.cxx+++ b/connectivity/source/drivers/firebird/StatementCommonBase.cxx@@ -194,6 +194,7 @@ void OStatementCommonBase::prepareAndDescribeStatement(const OUString& sql, free(pOutSqlda); pOutSqlda = (XSQLDA*) malloc(XSQLDA_LENGTH(n)); pOutSqlda->version = SQLDA_VERSION1;+ pOutSqlda->sqln = n; aErr = isc_dsql_describe(m_statusVector, &m_aStatementHandle, 1,makes possible to open the 2 queries on MacOs but then LO crashes when closing.Createdbt after patchHere's the bt I get after crash.crash is quite hard since Ctrl-C doesn't work. I must open a new term and kill the process.Julien Nabet committed a patch related to this issue.It has been pushed to "master":Related fdo#79714 OSX-crash opening query or table in embedded Firebird ODBThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Given this line:pOutSqlda->sqln = 10;(see), I think there's a link with fdo#74019I finally pushed this patch because:- Valgrind is right (we can read this "pOutSqlda->sqln = 10;" line 138, see- It allows to open both queries on MacOs- The crash I had seems to concern debug build onlySo now, it'll be interesting to wait for the next daily build to test this on non debug config.Of course, whatever the result, we should take into account this problem in debug mode but I must recognize I'm quite stuck since I don't understand why the Firebird cleaning process fails :(Lionel/Andrzej: any idea?I wonder if it could be a problem linked to the order of destructor calls in Firebird code.Indeed, there're several classes related by inheritance. There's also template part which doesn't help me to understand the whole thing as an almost beginner C++ dev I am :)Works for me too, and no crash on exit - brilliant !As far as I'm concerned, you can set this to resolved fixed.Thank you Alex for the test!So with:- on master- 4.3- 4.2and according to your comment, let's put it as FIXED.Ooops, having just checked my autogen, I'm not using dgbutil after all, so can not confirm that a debug build doesn't crash, but at least my normal build works ;-)Julien Nabet committed a patch related to this issue.It has been pushed to "libreoffice-4-2":Related fdo#79714 OSX-crash opening query or table in embedded Firebird ODBIt will be available in LibreOffice 4.2.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Julien Nabet committed a patch related to this issue.It has been pushed to "libreoffice-4-3":Related fdo#79714 OSX-crash opening query or table in embedded Firebird ODBIt will be available in LibreOffice 4.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=79870	CreatedError Message Screen shotI couldn't able to oepn a saved Libre spreadsheet file. While opening the file it is showing a error message that "Read-Error.Format error discovered in the file in sub-document content.xml at 2,28272(row,col).". I attached the erroe message screenshot . This is a important file kindly advise me to rectify the file. Thanks in advance. Hi Livingtone,thanks for the report.The problem description does not contain enough information to understand what is the cause of the issue. As a consequence I'm setting status to NEEDINFO.To tackle the issue it is needed to have a document to test with an reproduce your issue. So, if you have one, please upload it in this report.CreatedThe corrupted file.Kindly advise me as soon as possible. ThanksThe corrupted file has been attached.I have the same behavior here on openSUSE with 4.1.6.2, 4.2.4.2 and 4.3.0.0.beta1.The file is probably corrupted, not really sure how to set the status...I'll change Status to NEW at the moment.The file is corrupted. Nothing we can do about that. The problem was on the export side which has already been fixed.*** This bug has been marked as a duplicate of***can i able to get the file or not?CreatedCorrected fileI just deleted the tag around the error-position. It looks like some weird direct formattingExcept explaining why this is not a duplicate, there is no reason to reopen it.*** This bug has been marked as a duplicate of***Thanks a lot Jens i got my file back.
id=80140	Description:When I was testing Moztrap case #40, I found that spell check does not work in Impress odp file anymore. I have reported one bug in. However, this bug report (I mean this one you are now reading) is about another bug behaviour, which may be related to.Steps to reproduce:1. Openin;2. Go to "Tools - Options - Language Settings - Languages", set language for document to "English-USA". Make sure to check "For the current document only". Press OK.3. Click one of the text boxes in the slides (for example, I click somewhere between the word"Smoothly" of the 1st slide.4. Press F7, or click "Tools - Spelling"Current Behaviour:The dialog "Spellcheck of entire document has been completed" pops up, hangs, and can not be closed. I have to kill the soffice.bin process.Expected:"Spelling and Grammar: [Language]" window pops up, and allow me to "change" and "ignore" the spelling errors. When finished checking, the dialog "Spellcheck of entire document has been completed" pops up, and I can close it by press OK button.OS: Ubuntu 14.04 X86Version: 4.3.0.0.beta2Build ID: a06aa316117a6ff0f05c697c82831c227812d810It works OK in 4.2.5.2, so it's a regression in 4.3.0.0 beta2. Addedto see also.Hello suokunlong,I reproduce with LO 4.4.0.0.alpha0+Build ID: 488f31200094d7237d45545ab227014831a1f8e6TinderBox: Win-x86@39, Branch:master, Time: 2014-06-15_05:02:39under Windows 7 Home Premiumregards,JacquesSet Importance to highest and added to MAB4.3 list.FWIW I don't think that Step 2 is necessary to reproduce. Bibisect below:4fcd68ce4979f85fda4568f4b419a4b41d07345f is the first bad commitcommit 4fcd68ce4979f85fda4568f4b419a4b41d07345fAuthor: Bjoern Michaelsen <>Date: Sun May 11 18:45:33 2014 +0000 source-hash-2c4621c87ed3a7b19de195c21494c9a381e72b2e commit 2c4621c87ed3a7b19de195c21494c9a381e72b2e Author: Noel Grandin <> AuthorDate: Wed Feb 26 11:30:40 2014 +0200 Commit: Noel Grandin <> CommitDate: Thu Feb 27 12:30:29 2014 +0200 editeng: sal_Bool->bool Change-Id: I659497b79fe809865639429f2744d815f2a1f3e2:100644 100644 5c688d732bb5e3c2e2e590c92dccc5bb231e9f26 0eacdd85eed1050b13e09581b1b690bc2f10bf42 M ccache.log:100644 100644 0c1ce0eef885c4f1690557efc0fd5b591611b57d ecc1fd1889983a2d218a881155a9c0d43844c025 M commitmsg:100644 100644 fba2fb23d18fb2c754eddad1a160c39166dfe9e1 daae8edb8d62c5b27e10d58dc3fdd55f81071968 M make.log:040000 040000 231495c39d790222e733e96a38c10584b0181901 f0938573f30b23c4f669b2f2fb02090e7c33e449 M opt# bad: [423a84c4f7068853974887d98442bc2a2d0cc91b] source-hash-c15927f20d4727c3b8de68497b6949e72f9e6e9e# good: [65fd30f5cb4cdd37995a33420ed8273c0a29bf00] source-hash-d6cde02dbce8c28c6af836e2dc1120f8a6ef9932git bisect start 'latest' 'oldest'# good: [e02439a3d6297a1f5334fa558ddec5ef4212c574] source-hash-6b8393474974d2af7a2cb3c47b3d5c081b550bdbgit bisect good e02439a3d6297a1f5334fa558ddec5ef4212c574# good: [4850941efe43ae800be5c76e1102ab80ac2c085d] source-hash-980a6e552502f02f12c15bfb1c9f8e6269499f4bgit bisect good 4850941efe43ae800be5c76e1102ab80ac2c085d# bad: [a900e72b6357882284c5955bdf939bf14269f5fb] source-hash-dd1050b182260a26a1d0ba6d0ef3a6fecc3f4e07git bisect bad a900e72b6357882284c5955bdf939bf14269f5fb# good: [e1d0365cd2b073a859f59ad0a4584385a66dc611] source-hash-2eea96c702a44ab009743b0d22ef639127f0b57bgit bisect good e1d0365cd2b073a859f59ad0a4584385a66dc611# skip: [8f55938c891ee3e4c252b193dba9419f130537bc] source-hash-93f3f72d18e551c8edd6a010cb78d9cbe404f8efgit bisect skip 8f55938c891ee3e4c252b193dba9419f130537bc# bad: [7518fcaf863962bf4f6f3cdf84f6e42f0f59225f] source-hash-ab1f5eab4830f00dbbd7c883b98b59975ecd3bb1git bisect bad 7518fcaf863962bf4f6f3cdf84f6e42f0f59225f# good: [2e56ba511184c20aa8ada64d35e9f1d27d596790] source-hash-8be2cbc856fb5ba61203872d8f01ed8162aa4256git bisect good 2e56ba511184c20aa8ada64d35e9f1d27d596790# good: [6738b3ad82bbc77ce9a788be07da490e530de3ff] source-hash-43fc67adcc3bdc5efaaaf9b0d65e53e99880b18agit bisect good 6738b3ad82bbc77ce9a788be07da490e530de3ff# bad: [0e47d65bd5b2b2e544679d254078754fa456ce3d] source-hash-09e5de8278dd8f13adcf614db35c8a8a04ba8e47git bisect bad 0e47d65bd5b2b2e544679d254078754fa456ce3d# bad: [4fcd68ce4979f85fda4568f4b419a4b41d07345f] source-hash-2c4621c87ed3a7b19de195c21494c9a381e72b2egit bisect bad 4fcd68ce4979f85fda4568f4b419a4b41d07345f# good: [bc8862bec54976cb779628ed7b44397b5c7be10b] source-hash-5c57c9b6eb30265fe7312ff2b4d6ce7363cf2006git bisect good bc8862bec54976cb779628ed7b44397b5c7be10b# first bad commit: [4fcd68ce4979f85fda4568f4b419a4b41d07345f] source-hash-2c4621c87ed3a7b19de195c21494c9a381e72b2e(In reply to)When I was testing on Ubuntu yesterday, without step 2 it always behaves as(spell check pops up and vanishes immediately).But today while I am testing on windows xp, I can reproduce the dialog hang without step 2.So this may be different on windows and linux?andcan be reproduced also with Draw!When you press F7 (or Tools->Spelling) I can confirm two behaviour. With a blank document (odp or odg) I reproduce the, with a document with some content I can reproduce the.* Changed arch to All because both x86 and x86_64 are affected.* importance: ----highest -> this is a MAB----blocker -> can't use spellcheck or LibreOffice hangs.* Version: 4.3.0.0.beta2* Build ID: a06aa316117a6ff0f05c697c82831c227812d810* OS Ubuntu 14.04 x86_64I believe this is a regression from 57779aa0195d77239b339c6dbe17209b3f0cc4ee where I see an inverted logic from false to true in OutLiner::SpellNextDocumentCaolan McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: fdo#80140 inverted spell-check continue logicThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-3":Resolves: fdo#80140 inverted spell-check continue logicIt will be available in LibreOffice 4.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.***has been marked as a duplicate of this bug. ***Caolan McNamara committed a patch related to this issue.It has been pushed to "master":Related: fdo#80140 a11y crash on changing text via spellchecker in impressThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-3":Related: fdo#80140 a11y crash on changing text via spellchecker in impressIt will be available in LibreOffice 4.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.VERIFIED on LibreOffice:* Version: 4.4.0.0.alpha0+* Build ID: d2c469cc16bf303d4f5065a438d5252a31b3a564* TinderBox: Linux-rpm_deb-x86_64@46-TDF, * Branch:master, * Time: 2014-06-19_06:25:05* OS: Ubuntu 14.04 x86_64Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-2":Related: fdo#80140 a11y crash on changing text via spellchecker in impressIt will be available in LibreOffice 4.2.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=80527	CreatedScreen showing errorOccurs in LibreOfficeDev 4.3.0.1.0 Nightly Builds Installation Wizard in WindowsI try to install this in Windows 7:libo-43~2014-06-25_00.02.29_LibreOfficeDev_4.3.0.1.0_Win_x86.msi(from the URL:)Then the install produces this error message:Internal Error 2810. ReadyToInstall, EnableQuickstart,BackUsually the good install from RC1 is 215M and the wrong install (nigly build) is 123M Andras: following, I thought you might be interested in this tracker.I put fdo#80492 in See Also but not sure if it's the same.Andras Timar committed a patch related to this issue.It has been pushed to "master":fdo#80527 fix tab order on ReadyToInstall dialogThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Andras Timar committed a patch related to this issue.It has been pushed to "libreoffice-4-3":fdo#80527 fix tab order on ReadyToInstall dialogIt will be available in LibreOffice 4.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=80198	OS: Windows XP 32&64 bit editionsLibreOffice: 4.3.0.beta2; 4.3.0.1(rc1)1. Run Writer or Draw or Impress.2. Insert the SVG file () as an image.3. These programs don’t create a bitmap of the SVG file. Then LibreOffice crashed. To verify this issue, I tried to reproduce it under Linux, using the referred attachment in a Writer document inserted via Insert > Image > From File.I couldn’t make the program to crash, but it certainly went unresponsive for several seconds.I confirm it for LibreOffice: 4.3.0.beta2; 4.3.0.1 on Windows7.(In reply to)1. Read this message (), please.2. Try saving the file. The program crashed on my PC (Lubuntu-13.10_x32) when I tried to save this file. However, the file was created.I confirm this bug for LibreOffice 4.3.0.2(rc2). OS - Windows XP 64&32 bit Edition.I confirm this bug for LibreOffice 4.3.0.3(rc3). OS - Windows XP 64&32 bit Edition.LibO's message: 'LibreOffice 4.3 - Fatal Error; SEH Exception: ACCESS'.Apache OpenOffice does not crash, but in debug mode I get the error message:Error: Null-Pointer in child node list (!) From File c:/AOO_debugbuild_420/trunk/main/svgio/source/svgreader/svgnode.cxx at Line 568which is likely line 497 in LibreOffice(In reply to)--Regina,1. Please read the;2. It seems to me that there is every reason to consider with SVG at once and at first:- Stop using the patch of the Apache Open Office inscribed Michael Meeks in release 4.0.x.- Return the bitmap’s build used in LibO-3.6.6.- Replacement of SVG to PNG only when the ODF file is saved in ISO (i.e. in versions 1.0/1.1).--p.s. I may remind You more of the fake SVM.(This is an automated message.)Setting priority to highest as this is a MAB. This is part of an effort to make the importance of MAB reflected in priority too.I can also confirm this in release version 4.3.0.4. I have a data sheet with 10 complex SVG files. The file opens but when I get to the page with the graphics, the screen will not render the SVGs and Libre crashes.I've reverted to Version: 4.1.3.2 Build ID: 70feb7d99726f064edab4605a8ab840c50ec57a and it loads fine.Portable version is the install.CreatedLibreOffice Draw SVG CrashBug confirmed (still exists) for LibreOffice Draw version 4.3.1.2.Opening an existing LibreOffice Draw document and applying operations to svg cliparts in the drawing (like moving) also crashes the program.Provided sample testcase document.seeplease verify(In reply to V Stuart Foote from)--OK in LibO Dev_4.3.5.0.0+ (ID: 9a612f1d08eea858111ad5e161dc548c5173250a, TinderBox: Win-x86@51-TDF, Branch:libreoffice-4-3, Time: 2014-11-12_10:22:18); OS - Windows XP 64&32-bit Edition
id=81416	I can only reproduce this on OSX and LO 4.2.5.21) Open a simple ODT file (text only, no images or other objects, just a page footer with inserted page number field) from an external FAT USB connected drive.2) Make some changes to the file.3) Save As...with a new file name to the external storage.4) Make some more changes5) Attempt to save changes, random failure to save, provoking error message about IO.6) Close file, ignore message to resave file.7) Attempt to re-open file in LO - fails to open, General IO error message.File is corrupt, it can neither be opened in any version of LO, nor inspected by zip/unzip. Attempting to copy file via Finder from external storage to Desktop provokes an error (-36) that the file is incomplete. This is a regression over 4.1.6.2. So far, I did not see the problem on 4.2.3.3 either.The file is currently a privileged attorney work product, so it won't be posted here.Note that the problem never occurs when the file is read/written to internal hard disk storage.This sounds horrible.(In reply to)Yes, it is so bad, I have gone back to 4.1.6, where this doesn't happen.Alex@Alex Thurgoodare you still reproducing this bug with LibO 4.2.7.2 or 4.3.4.1?(In reply to Alex Thurgood from)Can you reproduce this on a different machine and/or different USB drive? It would be helpful to eliminate hardware problems.If the test case is a 'simple ODT file', can you reproduce the behavior by creating a new (non-privileged) file?wfm in LO 4341, closing as resolved wfm
id=81147	Open a Writer document, add a rectangle, right-click on it, select Area... It crashes with an ssertion failure: include/rtl/ref.hxx:166: reference_type *rtl::Reference<XColorList>::operator->() const [reference_type = XColorList]: Assertion `m_pBody != 0' failed Not surprisingly, happens on OS X too, so changing Platform field to All.Createdcallgrind log fileCallgrind log fileConfirmed on:* Version: 4.4.0.0.alpha0+* Build ID: 3fdd4f069d5436cf39708004af7fda8175fbc4c2* TinderBox: Linux-rpm_deb-x86_64@46-TDF, * Branch:master, Time: 2014-07-09_02:51:53* OS: Ubuntu 14.04 x86_64 Status NewImportance -> highest - blockerAccording to "Bug Priority Triage Flowchart Suggestions" I set the importance to blocker and highest because the bug happens every time a user uses this dialog and causes a crash.A valgrind out here:I confirm it too. But on my side it crashes inside XPropertyList::Count() called by SvxColorTabPage::UpdateModified():Exception Type: EXC_BAD_ACCESS (SIGBUS)Exception Codes: KERN_PROTECTION_FAILURE at 0x000000000000002cCrashed Thread: 0Thread 0 Crashed:0 libsvxcorelo.dylib 0x06239df4 XPropertyList::Count() const + 201 libcuilo.dylib 0x3366b9d8 SvxColorTabPage::UpdateModified() + 242 libcuilo.dylib 0x3366b9d8 SvxColorTabPage::UpdateModified() + 243 libcuilo.dylib 0x33670714 SvxColorTabPage::Reset(SfxItemSet const*) + 5164 libsfxlo.dylib 0x00c72558 SfxTabDialog::ActivatePageHdl(TabControl*) + 10485 libvcllo.dylib 0x02fc841c TabControl::calculateRequisition() const + 1406 libvcllo.dylib 0x02fc85a4 TabControl::GetOptimalSize() const + 207 libvcllo.dylib 0x02f540d8 Window::get_ungrouped_preferred_size() const + 1528 libvcllo.dylib 0x02f56520 Window::get_preferred_size() const + 32...* it fails on (XPropertyList*) this, where "this" is already NULL, so let's dig up to the caller* void SvxColorTabPage::UpdateModified() <cui/source/tabpages/tpcolor.cxx:585> -- bool bEnable = pColorList->Count(); <---- pColorList is already NULL here* `long XPropertyList::Count() const' returns `maList.size();' but it's called as `bool bEnable = pColorList->Count();' to do things like m_pBtnModify->Enable( bEnable ); etc.* since when are sizes true/false?!* why pColorList isn't initialized in ctor? but only in SvxColorTabPage::Update, which is called on bottom of strangely titled IMPL_LINK_NOARG(SvxColorTabPage, ClickLoadHdl_Impl)* maybe the logic was: `bool bEnable = false; if (pColorList) { if (pColorList->Count() > 0) { bEnable = true; } }' ?***has been marked as a duplicate of this bug. ***sounds like the segfault problem reported here. That bughas a backtrace attached.I didn't realize I need to attach a backtrace for a crasher in master; by definition, anybody that is going to debug this builds master, and can get a backtrace then in the debugger. Or what am I missing?Tor,I am not suggesting that you are missing anything.I tend to attach backtraces to bug reports mostly because I lack theknowledge to do anything more useful. Thet said, they may helpsomebody else working on bug reports, not necessarily a developer, todetermine "looks similar" or "looks different". Assertions are a bitdifferent in that they are evident only in debug builds.Maybe I am adding more noise than useful information. Guidancewelcome.Thanks,Terry.Caolan McNamara committed a patch related to this issue.It has been pushed to "master":Related: fdo#81147 check if colorlist is validThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: fdo#81147 fix mismatching drawlayer and docshell colorlistsThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=82336	Attempting to execute a multi-table LEFT OUTER JOIN query to a mysql instance via the native mysql connector causes LO to crash immediately.If the Query mode button on the main database window is clicked first, and then the query itself double-clicked to start it (request for login, then execution of query), LO goes into beachball mode, procesor occupation goes up to 70% and stays there until the application is forcibly killed. The query never gets displayed.The same query runs from a terminal against a local mysql instance in 0.08s and returns 636 results.The query is as follows :SELECT * from ipgalore as t1 LEFT OUTER JOIN (priority as t2,owner_list as t3,inventor_list as t4) ON (t2.fmpro_id = t1.fmpro_id AND t3.fmpro_id = t1.fmpro_id AND t4.fmpro_id = t1.fmpro_id)The same query runs almost instantly with LO 4233. Createdcrash trace on multitable left outer join queryAlso works fine on :Version: 4.1.6.2Build ID: 40ff705089295be5be0aae9b15123f687c05b0awith the corresponding Oracle native 1.0.1 connectorCreatedProcess sampling via Mac sampling utilityComment onProcess sampling via Mac sampling utilityThis sampling was made when LibreOffice did not crash, but hung - this situation occurs when the query is executed directly after opening the ODB file, i.e. it combines the parsing of the login credentials with subsequent execution of the queryCrash doesn't occur with the JDBC driver - changing title to reflect that it is limited to mysql native connectorChanged component to ExtensionsTested on :Version: 4.4.0.0.alpha0+Build ID: a0b89100be8ccc2b60d08d7e3819cd247a6042b0with JDBC connector, query executes fine.The crash is in mysql client library code...It looks similar to.Which MySQL connector are you using *exactly*, built from which commit in the git LibreOffice repo? The main thing I'm trying to find out is whether it uses libmysql from mysql.com or the LGPL C native client library from MariaDB.To reproduce, I'll "obviously" need a database dump and the .odb file.This looks similar towhich was caused by, so the *first* thing to check is if you are using a MySQL-LibreOffice native connector that is "recent enough".(In reply to)The dump won't happen, it is one of my pro dbs, and unfortunately must remain confidential.At best, I can provide the table descriptions.As to the commit that bases the build of the connector, I have no idea, but am pretty certain that the library is from Mysql and not MariaDB - can one tell from the extension components ?(In reply to)Where did you get the connector from? Downloaded from somewhere? Built yourself?Yes, that's often enough. If you can populate the tables with fake (whimsical) data that still reproduces the problem, that's nicer.Createdcreate table statements(In reply to)Yes, own build, but from 4.2 branch at time, in theory against mysql's C connector code source mysql-connector-c-6.1.2-osx10.7-x86_64(In reply to)If you built it yourself from branch "libreoffice-4-2" AND NOT from branch "master" when master was 4.2, then yes, you should theoretically have MySQL connector and not the LGPL MariaDB client library. I suppose you don't have any build log from that anymore?To be absolutely sure, it may be worth to build the MySQL connector again, and then show me:1) the build log2) the "config_host.mk" from the buildFWIW, the extension can be found here :dated October 21st, 2013This connector shows the same behaviour on LO 4.3 on OSXAfter that date, it became impossible for me to build a functional extension on OSX, so I have no later working extensions. I was building from master at the time.Just tested on OSX with :Version: 4.2.4.2Build ID: 63150712c6d317d27ce2db16eb94c2f3d7b699f8and the query executes without crash, so the changes in LO code occurred between LO 4242 and LO 4252(In reply to)The connector switched from the MariaDB LGPL library to the MySQL GPL library on 19 October 23:03:14 (or later). The files within the .oxt are dated 2013-10-19 06:53:44. As such, they probably are based on the MariaDB LGPL library and this bug is probably a dupe of.Yes, the *connector* is the important part, not that much the LibreOffice it is used with.(In reply to)In that case I'm stuffed :-pNorbert Thiebaud kindly fixed building the MySQL connector on MacOS X, so you can try On master, I switched the MySQL connector back to the LGPL mariadb client C library, but to version 2 of it, which hasfixed. This bug smells so much like a dupe ofI'm going to mark it as such. If you can reproduce with a newer connector (either using the MySQL GPL library or the The following should now build & work on MacOS X, without any "system" installation of mariadb or mysql (neither C, nor C++) libraries: --enable-ext-mariadb-connector --without-system-mariadb --without-system-mysql-cppconn*** This bug has been marked as a duplicate of***Oups, correction: If you can reproduce with a newer connector (either using the MySQL GPL library or the MariaDB LGPL C connector version 2), then reopen.
id=82484	Createdbacktrace logWriter crashes every time I'm trying to open odt-file. Please, see gdbtrace.log in attachment. Createdfile which happens writer crashOn pc Debian x86-64 with 4.3 sources updated 2 weeks ago, I reproduced this problem.With master sources updated today, I don't reproduce this.After some searching, I found it was a dup.*** This bug has been marked as a duplicate of***
id=82550	Using a more or less daily build from master, on OSX, the new dialog UI changes have caused message boxes to be incorrectly displayed, with a larger than life baox containing text that is generally right at the bottom of the rectangle and pushed to the right hand side.Apparent in at least :- Java classpath add archive dialog- About window- DB creation wizard main pane- Extension manager when clicking on a registered extension Regression over 4.3 and 4.2.x***has been marked as a duplicate of this bug. ***"Who broke the fountain?":)(In reply to)This is a local joke, anyway, sorry for the noise. :))Reproducible on the latest master BTW.screenshot of much toooooooo long about window:***has been marked as a duplicate of this bug. ***This is due toCaolan McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: fdo#82550 MacOSX GetTextBreak always return -1The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.That seems to fix it anyway, hopefully Norbert will have a look to see if its a desirable fix.caolan said: "That seems to fix it anyway, hopefully Norbert will have a look to see if its a desirable fix."well I was about to commit something... but your fix seems 'better'What puzzle me is that nTextWidth in OuputDevice::GetTextBreak()does not look like a 'logical unit'.in the test of the about box.. it comes with a value of 485andImplLogicWidthToDevicePixel( nTextWidth ) return an insane value 4.10^6 or something like thatcan you confirm that nTextWidth there is indeed a logical unit ?correctionit is LogicWidthToDeviceCoordinate( nTextWidth );that return the insane valuethanks for addressing this one.Ok, I found the real bug.. it is in map.cxxI'll push something soon (will revert caolan's version)Norbert Thiebaud committed a patch related to this issue.It has been pushed to "master":fdo#82550 LogicWidthToDeviceCoordinate missed handling of mbMap == falseThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Norbert Thiebaud committed a patch related to this issue.It has been pushed to "master":Revert "Resolves: fdo#82550 MacOSX GetTextBreak always return -1"The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Fix verified in Version: 4.4.0.0.alpha0+Build ID: b5688eb1523754f94aaa5af6d372174cab1a4bd7TinderBox: MacOSX-x86@49-TDF, Branch:master, Time: 2014-08-15_09:09:58Thanks norbert.
id=83612	Createdsample master documentHi,For some reason figure numbers are no longer renumbered with respect to their order in the master document. In the sample files attached and also uploaded on Dropbox () you will see that in the master document, Figure 1 from Subdocument 2, instead of being renumbered as Figure 2 is still Figure 1 in the master document despite being preceded in the master document by Figure 1 from Subdocument 1.What could be causing this problem? Looks similar with@Darius, please inform with which LO version you created that sample?Well, I used OpenOffice to create that file. As this is an issue in both OpenOffice and LibreOffice I submitted this bug to both OpenOffice and LibreOffice. That's what forking does.Strange! Now that you asked about what version of LibreOffice I'm using I found out that version 4.3 exists. However, I thought that I have the latest version. If I go to Help->Check for update... I'm told that LibreOffice is up to date.Anyway, just installed LibreOffice 4.3.1.2 and this bug is still present.Update is for the same branch.Eg: if you've got 4.2.0, it'll indicate updates for 4.2.1, 4.2.2, etc. not for 4.3.0Set back version to 4.2.5.2 because it is intended to show the first (oldest) version in which the bug has been seen.Best regards. JBFI re-checked and I noticed that cross-references are actually renumbered correctly using LO 4.3. It's just takes a bit of time.No patch included, should not be Fixed, but WorksForMePlease Darius, Cor is right, let this to WFM since there's no specific patch spotted for this bugtracker.
id=84284	Createdtest database from documentation projectTry opening a form from the attached ODB file.Enable macros.Click on Tables :Error message :The connection to the data source "Beispiel_Bilder_einbinden" could not be established.SQL Status: S1000Error code: -40General error: java.lang.UnsatisfiedLinkError: com.sun.star.sdbcx.comp.hsqldb.StorageFileAccess.isStreamElement(Ljava/lang/String;Ljava/lang/String;)ZNo tables are displayed in list windowTry to load a form.Double-click on any form.The same error message is displayed.Regression over production release 4.3.1.2 This is with a recognised Java 1.8.0_05 on OSXJust in case it was a macro problem, I also tested after disabling macros, same result - no load of any db object and same error message.The same problem is present on another machine with Java 1.7.0_67CDonfirming also daily :Version: 4.4.0.0.alpha0+Build ID: 5045400eb3ae5622d18e9a9b1b928d4ecc78bbf2TinderBox: MacOSX-10.9-x86_64@53, Branch:master, Time: 2014-09-24_11:42:05For the record, on pc Debian x86-64 with master sources updated yesterday or with 4.3.1 LO Debian package, I don't reproduce this.java version "1.7.0_65"OpenJDK Runtime Environment (IcedTea 2.5.2) (7u65-2.5.2-4)OpenJDK 64-Bit Server VM (build 24.65-b04, mixed mode)Thanks Julien. Mac specific Java environment bug ?@Stephan : any idea ?Quite weird, on MacOs 10.9.4 with LO 4.3.1 (French UI), I don't reproduce this.I can see the tables and open the first forms. (LO warns about macros disabled because I let the by default setting)java version "1.8.0_11"Java(TM) SE Runtime Environment (build 1.8.0_11-b12)Java HotSpot(TM) 64-Bit Server VM (build 25.11-b03, mixed mode)Did you try to launch LO from console to see if there could be some console logs?I know you could reproduce this on 2 machines but: - Did you try with a brand new LO profile?- Do you reproduce this with a brand new file?Alex: your daily build is x86-64, your LO 4.3.1 package too?Also, do you confirm you use Java 64 bits and not 32 bits? (you didn't install other Java versions these days?)com.sun.star.sdbcx.comp.hsqldb.StorageFileAccess.isStreamElement(java.lang.String,java.lang.String) is a native method; if this issue is Mac-only, I guess it is related to the recent changes to the LibreOffice.app tree layout, and the .jar no longer finds the .jnilib.Stephan Bergmann committed a patch related to this issue.It has been pushed to "master":fdo#84284: Adapt jar Class-Path to new Mac OS X LibreOffice.app layoutThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Alex: just by curiosity, what's your precise MacOs version on your 2 machines?Indeed, I don't understand why I couldn't reproduce this.Of course it's just a detail, the important thing is it's solved now thanks to Stephan :-)Julien, I'm on 10.9.5 on both machines.Note that I said that LO 4312 worked fine, it was just 440 alpha that showed the problem. Will start new build tomorrow to test whether bug fix okAlex: oups! I had read a little too faster!Ok then :-)(In reply to)(Make sure to do either a clean build or at least "make connectivity.clean" first. IIUC, the change to the Jar_sdbc_hsqldb.mk wouldn't necessarily be picked up by an incremental make.)verified with master own build today, thanks
id=83368	I have download the latest 4.3.1 and it will not start, it just keeps on crashing on about the third try it may open, but will crash on the next startKen Please try resetting the user profile.I renamed the user folder Via Terminal and it is still crashingCrash logProcess: soffice [23970]Path: /Applications/LibreOffice.app/Contents/MacOS/sofficeIdentifier: org.libreoffice.scriptVersion: 4.3.1002 (???)Code Type: X86 (Native)Parent Process: ??? [1]Responsible: soffice [23970]User ID: 501Date/Time: 2014-09-01 22:43:25.116 -0500OS Version: Mac OS X 10.10 (14A329r)Report Version: 11Anonymous UUID: 12D35764-EC09-50CE-7947-2817279307EBTime Awake Since Boot: 510000 secondsCrashed Thread: 0 Dispatch queue: com.apple.main-threadException Type: EXC_BAD_ACCESS (SIGSEGV)Exception Codes: KERN_INVALID_ADDRESS at 0x0000000000000000VM Regions Near 0:--> __TEXT 0000000000001000-0000000000002000 [ 4K] r-x/rwx SM=COW /Applications/LibreOffice.app/Contents/MacOS/sofficeThread 0 Crashed:: Dispatch queue: com.apple.main-thread0 libvcllo.dylib 0x01cdb9fc -[VCL_NSApplication screenParametersChanged:] + 281 com.apple.Foundation 0x9bf44e63 __57-[NSNotificationCenter addObserver:selector:name:object:]_block_invoke + 502 com.apple.CoreFoundation 0x98233d34 __CFNOTIFICATIONCENTER_IS_CALLING_OUT_TO_AN_OBSERVER__ + 203 com.apple.CoreFoundation 0x98114b61 _CFXNotificationPost + 37134 com.apple.Foundation 0x9bf32d84 -[NSNotificationCenter postNotificationName:object:userInfo:] + 925 com.apple.Foundation 0x9bf515c2 -[NSNotificationCenter postNotificationName:object:] + 566 com.apple.AppKit 0x96798da5 -[NSApplication _reactToScreenInvalidation:] + 5657 com.apple.AppKit 0x967990f7 -[NSApplication _reactToDockChanged] + 708 com.apple.AppKit 0x966bd965 _NSCoreDockMessageReceive + 7849 com.apple.HIToolbox 0x98c0d4af DockCallback(unsigned long, unsigned int, void*, void*) + 274210 com.apple.HIServices 0x97ac4bfc dockClientNotificationProc + 16811 com.apple.CoreGraphics 0x998897e8 CGSConnectionNotifier::invoke_callbacks(unsigned int, void*, unsigned long) const + 50612 com.apple.CoreGraphics 0x998895db CGSPostLocalNotificationToConnection + 4913 com.apple.CoreGraphics 0x99889584 (anonymous namespace)::notify_datagram_handler(unsigned int, CGSDatagramType, void*, unsigned long, void*) + 11214 com.apple.CoreGraphics 0x9984078d CGSDatagramReadStream::dispatch_next_datagram() + 76515 com.apple.CoreGraphics 0x99840483 CGSDatagramReadStream::dispatch_datagrams() + 4716 com.apple.CoreGraphics 0x9984027c CGSDatagramReadStreamDispatchDatagramsWithData + 15017 com.apple.CoreGraphics 0x9983ff9a CGSSnarfAndDispatchDatagrams + 42718 com.apple.CoreGraphics 0x9983fcce CGSGetNextEventRecordInternal + 8419 com.apple.CoreGraphics 0x9983fc35 CGEventCreateNextEvent + 3920 com.apple.HIToolbox 0x98929c71 PullEventsFromWindowServerOnConnection(unsigned int, unsigned char, __CFMachPortBoost*) + 8321 com.apple.HIToolbox 0x98929bee MessageHandler(__CFMachPort*, void*, long, void*) + 5522 com.apple.CoreFoundation 0x9818b841 __CFMachPortPerform + 25723 com.apple.CoreFoundation 0x9818b735 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ + 5324 com.apple.CoreFoundation 0x9818b69e __CFRunLoopDoSource1 + 51025 com.apple.CoreFoundation 0x9817cab0 __CFRunLoopRun + 262426 com.apple.CoreFoundation 0x9817be06 CFRunLoopRunSpecific + 39027 com.apple.CoreFoundation 0x9817bc6b CFRunLoopRunInMode + 12328 com.apple.HIToolbox 0x98920a88 RunCurrentEventLoopInMode + 26229 com.apple.HIToolbox 0x98920693 ReceiveNextEventCommon + 19230 com.apple.HIToolbox 0x989205bc _BlockUntilNextEventMatchingListInModeWithFilter + 9931 com.apple.AppKit 0x9642b199 _DPSNextEvent + 73432 com.apple.AppKit 0x9642aa03 -[NSApplication nextEventMatchingMask:untilDate:inMode:dequeue:] + 12433 com.apple.AppKit 0x9641d14c -[NSApplication run] + 90734 com.apple.AppKit 0x96406700 NSApplicationMain + 208235 libvcllo.dylib 0x01ca011f ImplSVMainHook(int*) + 33536 libvcllo.dylib 0x01c2beda SVMain() + 2637 libsofficeapp.dylib 0x0009af05 soffice_main + 27738 org.libreoffice.script 0x00001f4e main + 3039 org.libreoffice.script 0x00001f25 start + 53Thread 1:0 libsystem_kernel.dylib 0x95ec5516 __psynch_cvwait + 101 libsystem_pthread.dylib 0x904f2b06 _pthread_cond_wait + 7262 libsystem_pthread.dylib 0x904f621d pthread_cond_timedwait$UNIX2003 + 713 libuno_sal.dylib.3 0x000107fb rtl_cache_wsupdate_all(void*) + 2674 libsystem_pthread.dylib 0x904f1ecf _pthread_body + 1385 libsystem_pthread.dylib 0x904f1e45 _pthread_start + 1626 libsystem_pthread.dylib 0x904eff0e thread_start + 34Thread 2:: Dispatch queue: com.apple.libdispatch-manager0 libsystem_kernel.dylib 0x95ec68d2 kevent64 + 101 libdispatch.dylib 0x934137f1 _dispatch_mgr_invoke + 2452 libdispatch.dylib 0x93413450 _dispatch_mgr_thread + 52Thread 3:0 libsystem_kernel.dylib 0x95ec5e6e __workq_kernreturn + 101 libsystem_pthread.dylib 0x904f236d _pthread_wqthread + 9392 libsystem_pthread.dylib 0x904efeea start_wqthread + 30Thread 4:0 libsystem_kernel.dylib 0x95ec5e6e __workq_kernreturn + 101 libsystem_pthread.dylib 0x904f236d _pthread_wqthread + 9392 libsystem_pthread.dylib 0x904efeea start_wqthread + 30Thread 5:0 libsystem_kernel.dylib 0x95ec5e6e __workq_kernreturn + 101 libsystem_pthread.dylib 0x904f236d _pthread_wqthread + 9392 libsystem_pthread.dylib 0x904efeea start_wqthread + 30Thread 6:0 libsystem_kernel.dylib 0x95ec5e6e __workq_kernreturn + 101 libsystem_pthread.dylib 0x904f236d _pthread_wqthread + 9392 libsystem_pthread.dylib 0x904efeea start_wqthread + 30Thread 7:0 libsystem_kernel.dylib 0x95ec5e6e __workq_kernreturn + 101 libsystem_pthread.dylib 0x904f236d _pthread_wqthread + 9392 libsystem_pthread.dylib 0x904efeea start_wqthread + 30Thread 8:0 libsystem_kernel.dylib 0x95ec5e6e __workq_kernreturn + 101 libsystem_pthread.dylib 0x904f236d _pthread_wqthread + 9392 libsystem_pthread.dylib 0x904efeea start_wqthread + 30Thread 9:0 libsystem_kernel.dylib 0x95ec5e6e __workq_kernreturn + 101 libsystem_pthread.dylib 0x904f236d _pthread_wqthread + 9392 libsystem_pthread.dylib 0x904efeea start_wqthread + 30Thread 10:0 libsystem_kernel.dylib 0x95ec5e6e __workq_kernreturn + 101 libsystem_pthread.dylib 0x904f236d _pthread_wqthread + 9392 libsystem_pthread.dylib 0x904efeea start_wqthread + 30Thread 11:Thread 0 crashed with X86 Thread State (32-bit): eax: 0x00000000 ebx: 0x01cdb9ee ecx: 0xbfff46a0 edx: 0x00000000 edi: 0x0433c830 esi: 0x01e1ca1c ebp: 0xbfff4728 esp: 0xbfff46f0 ss: 0x00000023 efl: 0x00010286 eip: 0x01cdb9fc cs: 0x0000001b ds: 0x00000023 es: 0x00000023 fs: 0x00000000 gs: 0x0000000f cr2: 0x00000000 Logical CPU: 0Error Code: 0x00000004Trap Number: 14Binary Images: 0x1000 - 0x1ff7 +org.libreoffice.script (4.3.1002 - ???) <0E316897-FF31-26B9-94D4-D9D22C5FCC74> /Applications/LibreOffice.app/Contents/MacOS/soffice 0x5000 - 0x42fff +libuno_sal.dylib.3 (0) <82DB2A78-F5E5-5364-ACED-AAE13284E5FA> /Applications/LibreOffice.app/Contents/ure-link/lib/libuno_sal.dylib.3 0x60000 - 0xcbfff +libsofficeapp.dylib (0) <113E236D-4618-B17D-EC14-6C230D6BB2DC> /Applications/LibreOffice.app/Contents/MacOS/libsofficeapp.dylib 0xfa000 - 0x214ffb +libcomphelper.dylib (0) <8E26E29E-87F3-EB73-CFBA-AC980D7C7EDD> /Applications/LibreOffice.app/Contents/MacOS/libcomphelper.dylib 0x2d0000 - 0x2fdff7 +libuno_cppu.dylib.3 (0) <2EB4DD02-FEF5-6789-1D3C-82FE736EEA78> /Applications/LibreOffice.app/Contents/ure-link/lib/libuno_cppu.dylib.3 0x30f000 - 0x3dbff3 +libuno_cppuhelpergcc3.dylib.3 (0) <DF380B1A-6591-E62A-3AF3-D16B3EF82A85> /Applications/LibreOffice.app/Contents/ure-link/lib/libuno_cppuhelpergcc3.dylib.3 0x451000 - 0x478ff3 +libdeploymentmisclo.dylib (0) <5C826729-AC2D-CFE0-1BE9-8787927ACE57> /Applications/LibreOffice.app/Contents/MacOS/libdeploymentmisclo.dylib 0x48f000 - 0x4beff3 +libi18nlangtag.dylib (0) <3CEDA7BD-350A-47B0-B946-73E546D70783> /Applications/LibreOffice.app/Contents/MacOS/libi18nlangtag.dylib 0x4d9000 - 0x4dcff3 +libuno_salhelpergcc3.dylib.3 (0) <14545635-4A8D-C805-6080-3528ED17DC18> /Applications/LibreOffice.app/Contents/ure-link/lib/libuno_salhelpergcc3.dylib.3 0x4e3000 - 0x647fef +libsblo.dylib (0) <529E2E26-40F1-B426-5F26-D12EC5B267C0> /Applications/LibreOffice.app/Contents/MacOS/libsblo.dylib 0x6e2000 - 0xafffff +libsfxlo.dylib (0) <E0470D12-9648-CD4E-AA35-B26F2451F51B> /Applications/LibreOffice.app/Contents/MacOS/libsfxlo.dylib 0xcfa000 - 0xdd1ff7 +libsvllo.dylib (0) <D866990B-3BFE-603E-D737-F09F8D10A540> /Applications/LibreOffice.app/Contents/MacOS/libsvllo.dylib 0xe3b000 - 0x10eaff3 +libsvtlo.dylib (0) <B6C892D5-585D-F026-BC46-D998AE219906> /Applications/LibreOffice.app/Contents/MacOS/libsvtlo.dylib 0x128c000 - 0x14d5feb +libtklo.dylib (0) <95C5544C-4352-0B85-7CA1-5C66DA8B72A9> /Applications/LibreOffice.app/Contents/MacOS/libtklo.dylib 0x16a8000 - 0x1707ffb +libtllo.dylib (0) <8CC90393-4A81-7863-8FBC-2B684D392418> /Applications/LibreOffice.app/Contents/MacOS/libtllo.dylib 0x172a000 - 0x1787ff7 +libucbhelper.dylib (0) <69D1AB85-ECE5-3A15-9CCC-26670685AD0A> /Applications/LibreOffice.app/Contents/MacOS/libucbhelper.dylib 0x17c7000 - 0x18c7ffb +libutllo.dylib (0) <B995F7E2-357D-CE01-1C19-DB878AA54D25> /Applications/LibreOffice.app/Contents/MacOS/libutllo.dylib 0x1941000 - 0x1dfefeb +libvcllo.dylib (0) <7446D821-B061-7159-430B-86138D82C2FF> /Applications/LibreOffice.app/Contents/MacOS/libvcllo.dylib 0x1f92000 - 0x20a9ffb +libicuuc.dylib.53 (53.1) <AFDE0B23-F526-4479-6FDB-256C489BB781> /Applications/LibreOffice.app/Contents/MacOS/libicuuc.dylib.53 0x2100000 - 0x2116fe7 +libreglo.dylib (0) <D3EFFEC3-3ADE-5A49-7A7E-7641202DC374> /Applications/LibreOffice.app/Contents/ure-link/lib/libreglo.dylib 0x2120000 - 0x2182fff +libunoidllo.dylib (0) <8BEDA82F-BC6F-E430-F50C-AC2554F35AE9> /Applications/LibreOffice.app/Contents/ure-link/lib/libunoidllo.dylib 0x2191000 - 0x219aff3 +libxmlreaderlo.dylib (0) <ADE4AE4D-FFB3-88C0-5625-CAAC35930559> /Applications/LibreOffice.app/Contents/ure-link/lib/libxmlreaderlo.dylib 0x21a0000 - 0x21baff7 +libstorelo.dylib (0) <C0EE57D4-40FE-8D0A-E8A9-58BA143B9FBF> /Applications/LibreOffice.app/Contents/ure-link/lib/libstorelo.dylib 0x21c5000 - 0x364cff7 +libicudata.dylib.53 (53.1) <6431AE13-F1C1-F438-4F4F-D9FD8BFA1BCA> /Applications/LibreOffice.app/Contents/MacOS/libicudata.dylib.53 0x3668000 - 0x3701fef +libxmlscriptlo.dylib (0) <CC1330ED-8D69-C448-5F66-11BAE2343A53> /Applications/LibreOffice.app/Contents/MacOS/libxmlscriptlo.dylib 0x3732000 - 0x37caff3 +libbasegfxlo.dylib (0) <CB234961-6064-5DFF-82E0-291F9C98036F> /Applications/LibreOffice.app/Contents/MacOS/libbasegfxlo.dylib 0x37f1000 - 0x3842ff7 +libsotlo.dylib (0) <DB9A10F6-F50F-722B-0A51-8F6B51F5B01F> /Applications/LibreOffice.app/Contents/MacOS/libsotlo.dylib 0x3869000 - 0x3879ff7 +libi18nutil.dylib (0) <A86B959D-B805-FE73-871A-67AF83E0ABDC> /Applications/LibreOffice.app/Contents/MacOS/libi18nutil.dylib 0x3884000 - 0x389bff7 +libjvmfwklo.dylib (0) <CA26B8C0-A485-8CD5-D064-41348A1A816C> /Applications/LibreOffice.app/Contents/ure-link/lib/libjvmfwklo.dylib 0x38a4000 - 0x3a51ff3 +libicui18n.dylib.53 (53.1) <78B1D567-93B3-1410-5501-D20998624560> /Applications/LibreOffice.app/Contents/MacOS/libicui18n.dylib.53 0x3b01000 - 0x3b04ffb +libjvmaccesslo.dylib (0) <007A2A85-186F-3A94-50CF-D31E3432141D> /Applications/LibreOffice.app/Contents/ure-link/lib/libjvmaccesslo.dylib 0x3b0b000 - 0x3b10ff7 +libAppleRemotelo.dylib (0) <27A49018-D23B-8746-FA21-00B0AC5CF933> /Applications/LibreOffice.app/Contents/MacOS/libAppleRemotelo.dylib 0x3b17000 - 0x3b51fef +libnspr4.dylib (1) <792BA822-C030-8A53-B209-C86954F6F68E> /Applications/LibreOffice.app/Contents/MacOS/libnspr4.dylib 0x3b79000 - 0x3cb1fe7 +libnss3.dylib (1) <EB25CEB3-C7BB-7E14-EB42-B96E2233B586> /Applications/LibreOffice.app/Contents/MacOS/libnss3.dylib 0x3d38000 - 0x3d5dfe7 +libsmime3.dylib (1) <06222364-3969-810B-2EA7-3821A8CAABA7> /Applications/LibreOffice.app/Contents/MacOS/libsmime3.dylib 0x3d7b000 - 0x3db9fe7 +liblcms2.2.dylib (3.6) <1775730D-BD5C-DB09-4D4A-55C23A07E18E> /Applications/LibreOffice.app/Contents/MacOS/liblcms2.2.dylib 0x3ddd000 - 0x3dfdfe7 +libnssutil3.dylib (1) <6794BEE7-DDAB-A248-DD1A-4F5658614DC0> /Applications/LibreOffice.app/Contents/MacOS/libnssutil3.dylib 0x3e18000 - 0x3e1efff +libplc4.dylib (1) <8222890E-90A2-2ACC-CB31-DC9E04A395FE> /Applications/LibreOffice.app/Contents/MacOS/libplc4.dylib 0x3e28000 - 0x3e2efff +libplds4.dylib (1) <5FC6610B-969F-6DFA-6785-6206931893E5> /Applications/LibreOffice.app/Contents/MacOS/libplds4.dylib 0x3e37000 - 0x3f4cff3 +libdrawinglayerlo.dylib (0) <F573D347-1A99-EB0B-7937-0930079550DF> /Applications/LibreOffice.app/Contents/MacOS/libdrawinglayerlo.dylib 0x3fd2000 - 0x4052ff7 +libfwelo.dylib (0) <682B4AFA-88A2-E22F-767E-3669C92489E5> /Applications/LibreOffice.app/Contents/MacOS/libfwelo.dylib 0x4096000 - 0x40aaff3 +libsaxlo.dylib (0) <3537877C-5F22-C2E0-F86A-7CD7D4DAFD1D> /Applications/LibreOffice.app/Contents/MacOS/libsaxlo.dylib 0x40b8000 - 0x40e8ffb +libcanvastoolslo.dylib (0) <C69A9C41-98A5-2664-E385-44776DF2B904> /Applications/LibreOffice.app/Contents/MacOS/libcanvastoolslo.dylib 0x4108000 - 0x415dfff +libcppcanvaslo.dylib (0) <35316B3D-C339-1A31-1FFA-CDBA5C1CA74B> /Applications/LibreOffice.app/Contents/MacOS/libcppcanvaslo.dylib 0x4180000 - 0x41aaff7 +libfwilo.dylib (0) <2C7D0093-C343-C4DC-4E95-D1E2D970E2F5> /Applications/LibreOffice.app/Contents/MacOS/libfwilo.dylib 0x9ff2000 - 0x9ff2ff9 +cl_kernels (???) <6809B14A-52B7-408E-8917-1DFDB0537ADB> cl_kernels 0x9ff6000 - 0x9ff6ffb +cl_kernels (???) <18C8CD6C-3B3E-46B2-B4BB-ECD6A7913A0D> cl_kernels 0xab32000 - 0xab72ff3 com.apple.CloudDocs (1.0 - 262) <4B31F83F-3EC6-310F-AFFA-6626295657B6> /System/Library/PrivateFrameworks/CloudDocs.framework/CloudDocs 0xbe5a000 - 0xbf45ff7 unorm8_bgra.dylib (2.4.5) <158C8746-4F0B-3ACB-988A-80346F3E5D74> /System/Library/Frameworks/OpenCL.framework/Versions/A/Libraries/ImageFormats/unorm8_bgra.dylib0x8fe27000 - 0x8fe5ae03 dyld (353.2.1) <EBFF7998-58E8-32F5-BF0D-9690278EC792> /usr/lib/dyld0x90008000 - 0x9000dff7 libmacho.dylib (862) <994A4135-A10A-3E00-AD33-9BB4D59EE6DD> /usr/lib/system/libmacho.dylib0x9012f000 - 0x90131fff com.apple.loginsupport (1.0 - 1) <CC0571F3-68A7-3986-A0E4-36057DD2B796> /System/Library/PrivateFrameworks/login.framework/Versions/A/Frameworks/loginsupport.framework/Versions/A/loginsupport0x90132000 - 0x9018fff3 com.apple.print.framework.PrintCore (10.0 - 450) <396AFF1D-32DE-3FFC-AF36-1E525FCB112C> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/PrintCore.framework/Versions/A/PrintCore0x90190000 - 0x9019eff7 com.apple.SpeechRecognitionCore (2.0.28 - 2.0.28) <2C043721-D5FD-3A24-90E0-D5F6FAD4472D> /System/Library/PrivateFrameworks/SpeechRecognitionCore.framework/Versions/A/SpeechRecognitionCore0x9019f000 - 0x904eefff libmecabra.dylib (661) <1010C0D1-FC4D-3C7F-87B9-D8EEF2E23825> /usr/lib/libmecabra.dylib0x904ef000 - 0x904f7fff libsystem_pthread.dylib (105.1.4) <7A96DB53-5E28-304D-8CE4-760E65C5430D> /usr/lib/system/libsystem_pthread.dylib0x9052d000 - 0x90623ff7 libFontParser.dylib (130) <EBA8441C-5131-3D71-892D-4490548B1A32> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/Resources/libFontParser.dylib0x90624000 - 0x90677fff libstdc++.6.dylib (104.1) <D0EB2C99-5939-3ABA-9C18-D9AD75CE23A1> /usr/lib/libstdc++.6.dylib0x90678000 - 0x9067bfff libpam.2.dylib (20) <E2F34522-448A-3392-BC1D-6625BEB612B9> /usr/lib/libpam.2.dylib0x9067c000 - 0x906efffb com.apple.framework.CoreWLAN (5.0 - 500.29) <6DC23F60-69C0-3495-B539-C7C990F89AE1> /System/Library/Frameworks/CoreWLAN.framework/Versions/A/CoreWLAN0x906f0000 - 0x907bbfff com.apple.DiscRecording (9.0 - 9000.4.1) <820ED5C6-3B0A-33E0-B828-8DE5147A7131> /System/Library/Frameworks/DiscRecording.framework/Versions/A/DiscRecording0x907bc000 - 0x907c0ffb com.apple.TCC (1.0 - 1) <8536270E-C27A-36D6-AAFD-D46C0C49FC8F> /System/Library/PrivateFrameworks/TCC.framework/Versions/A/TCC0x908d4000 - 0x908e5ffb libsystem_coretls.dylib (35) <7BF5E19E-8083-3D63-AC0B-C58CD1B67FD9> /usr/lib/system/libsystem_coretls.dylib0x908e6000 - 0x9096dfff com.apple.CoreServices.OSServices (639 - 639) <740EA9BB-EBD7-3D0C-97A4-183B4779D813> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/OSServices.framework/Versions/A/OSServices0x9096e000 - 0x909b1fff libGLU.dylib (11.0.5) <5BE4EE86-4BBD-30A4-96BF-9B49B0A75BC0> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGLU.dylib0x909b2000 - 0x909b6ffb libcache.dylib (69) <1E85E459-FBEF-31E0-A237-EF4BE9D5D768> /usr/lib/system/libcache.dylib0x909b7000 - 0x90cb4ffb com.apple.CoreServices.CarbonCore (1105 - 1105) <AD965CC1-83E5-3EEC-81BF-7815E5E07DDD> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/CarbonCore.framework/Versions/A/CarbonCore0x90cb5000 - 0x90cc3ff7 libz.1.dylib (55) <DF3B8F77-8931-3A6B-8BDF-DB67315050E6> /usr/lib/libz.1.dylib0x90cc4000 - 0x90cc6ff3 com.apple.EFILogin (2.0 - 2) <40B1056B-2FCA-3DD1-AC19-8A7DB09F1757> /System/Library/PrivateFrameworks/EFILogin.framework/Versions/A/EFILogin0x90d02000 - 0x90d02fff com.apple.Cocoa (6.8 - 21) <6745A805-354F-3B26-9991-2C964D904256> /System/Library/Frameworks/Cocoa.framework/Versions/A/Cocoa0x90d03000 - 0x90d29ff7 com.apple.IconServices (45 - 45) <E7B742AA-1699-372D-9689-93A012142614> /System/Library/PrivateFrameworks/IconServices.framework/Versions/A/IconServices0x91cca000 - 0x91cd3fff libGFXShared.dylib (11.0.5) <23B88370-1E8E-34B5-9625-757409DD721F> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGFXShared.dylib0x92bb5000 - 0x92cabff7 libxml2.2.dylib (26) <2F37833C-4D55-3A09-9A0C-5904E8B6892A> /usr/lib/libxml2.2.dylib0x92cac000 - 0x92cebfff com.apple.NavigationServices (3.8 - 215.1) <2A4EB6F1-F9F3-3AA6-AF95-02611C72C35C> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/NavigationServices.framework/Versions/A/NavigationServices0x92cec000 - 0x92d09fff libCRFSuite.dylib (34) <781A92EF-410E-39B2-953D-FEE12748D834> /usr/lib/libCRFSuite.dylib0x92d0a000 - 0x92d12ff7 com.apple.icloud.FindMyDevice (1.0 - 1) <D851D4D4-1486-38CD-BE70-ED34A076B929> /System/Library/PrivateFrameworks/FindMyDevice.framework/Versions/A/FindMyDevice0x92d3e000 - 0x92d49fff com.apple.CrashReporterSupport (10.10 - 625) <0047B7D0-426F-39D2-BDDB-6F6562F51794> /System/Library/PrivateFrameworks/CrashReporterSupport.framework/Versions/A/CrashReporterSupport0x92ef9000 - 0x92efafff libremovefile.dylib (35) <CFB0212F-7005-3B0C-8243-527B32E2BF74> /usr/lib/system/libremovefile.dylib0x92efb000 - 0x92f0bfff libGL.dylib (11.0.5) <558A4D68-B8A4-34BF-B0A6-875D3B44B526> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib0x92f0c000 - 0x92f26ff7 liblzma.5.dylib (7) <D0BC984D-5B33-328C-8F1E-7E9C41813433> /usr/lib/liblzma.5.dylib0x92f27000 - 0x9306bff7 com.apple.ImageIO.framework (3.3.0 - 1038) <299FE5ED-6E8F-3D38-888C-509C12BCF9FE> /System/Library/Frameworks/ImageIO.framework/Versions/A/ImageIO0x930e3000 - 0x9320ffff com.apple.coreui (2.1 - 300) <6765132D-A0FD-34E7-845C-7AF21AFB91BD> /System/Library/PrivateFrameworks/CoreUI.framework/Versions/A/CoreUI0x93210000 - 0x9323cfff com.apple.ChunkingLibrary (2.1 - 163.1) <DC9EAEFB-8855-3131-A13C-99768C5394D2> /System/Library/PrivateFrameworks/ChunkingLibrary.framework/Versions/A/ChunkingLibrary0x9323d000 - 0x9326fff3 com.apple.GSS (4.0 - 2.0) <6E3ECA6A-8CEC-3D8A-A484-DCC4A7BEC314> /System/Library/Frameworks/GSS.framework/Versions/A/GSS0x93270000 - 0x93271fff liblangid.dylib (117) <34A0F807-755F-300B-B01F-AABAE3838451> /usr/lib/liblangid.dylib0x93272000 - 0x932e8ff7 com.apple.SearchKit (1.4.0 - 1.4.0) <B4BD4A0F-F6ED-37A0-AA73-9CAC84BCFF33> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/SearchKit.framework/Versions/A/SearchKit0x9332b000 - 0x9332dfff libquarantine.dylib (76) <BA2D935B-4B5C-355B-9BAE-0325624E39C0> /usr/lib/system/libquarantine.dylib0x9332e000 - 0x93334ff7 libsystem_trace.dylib (72.1.1.0.1) <05261F36-47FB-3288-9EAD-EA2A4D2F1CEB> /usr/lib/system/libsystem_trace.dylib0x93335000 - 0x9333efff libcopyfile.dylib (118.1.1) <6C56E539-FD5F-3F1C-8D4C-720AEA97E2FE> /usr/lib/system/libcopyfile.dylib0x9333f000 - 0x933bcff3 com.apple.framework.IOKit (2.0.2 - 1050.1.20) <42B5C125-BED8-387B-B22A-8C9255BE57A1> /System/Library/Frameworks/IOKit.framework/Versions/A/IOKit0x933bd000 - 0x9340efff libcups.2.dylib (404) <D7C5C50F-AB38-36D5-9CC4-B7378BB1CF68> /usr/lib/libcups.2.dylib0x9340f000 - 0x93436fff libdispatch.dylib (442.1.3) <4FFC29A5-45E8-30FB-8206-1D3318D9F20E> /usr/lib/system/libdispatch.dylib0x93437000 - 0x9343dff3 libsystem_platform.dylib (63) <0C034682-EF49-3188-AAE0-AA445872632C> /usr/lib/system/libsystem_platform.dylib0x9343e000 - 0x9344bfff com.apple.OpenDirectory (10.10 - 187) <AE61B41A-9228-3DF2-A750-B75405295C67> /System/Library/Frameworks/OpenDirectory.framework/Versions/A/OpenDirectory0x9344c000 - 0x93452ff7 libsystem_networkextension.dylib (167.1.9) <940A7B3A-3E69-3764-B6CD-ECF5BB18E090> /usr/lib/system/libsystem_networkextension.dylib0x93453000 - 0x93472ff7 com.apple.GenerationalStorage (2.0 - 209.8) <CF1C8A52-DB43-3C2F-8B23-9A61B685E33E> /System/Library/PrivateFrameworks/GenerationalStorage.framework/Versions/A/GenerationalStorage0x93473000 - 0x93499fff libxpc.dylib (559.1.7) <04256902-F7CD-36BD-8B7C-D954366DE149> /usr/lib/system/libxpc.dylib0x9349a000 - 0x9349cffb libRadiance.dylib (1230) <C9193F08-5AB9-3F48-96C3-3AC693C48FFE> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libRadiance.dylib0x9349d000 - 0x9349efff libDiagnosticMessagesClient.dylib (100) <3EE83437-AA9C-356B-810B-589346B73797> /usr/lib/libDiagnosticMessagesClient.dylib0x9349f000 - 0x934b1ff7 libsasl2.2.dylib (191) <150F11A4-9FFF-3D7D-906B-57D1BAC37FC2> /usr/lib/libsasl2.2.dylib0x934b2000 - 0x93737fff com.apple.QuickTime (7.7.3 - 2890) <93AEDD55-213D-3495-B9DD-348B269982B8> /System/Library/Frameworks/QuickTime.framework/Versions/A/QuickTime0x93738000 - 0x9383cff7 libJP2.dylib (1230) <64724906-45FF-39A0-A5FA-1AEE3B822CB5> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libJP2.dylib0x9383d000 - 0x9384aff7 libbz2.1.0.dylib (36) <6BC7B049-8F03-3217-9840-B1804CCBF742> /usr/lib/libbz2.1.0.dylib0x9384b000 - 0x938b4ff7 libcorecrypto.dylib (233.1.2) <353B7C76-DCDC-3414-AA92-0AB9CA74376A> /usr/lib/system/libcorecrypto.dylib0x938b5000 - 0x93903ff7 libcurl.4.dylib (83.1.1) <46C49D27-5E3E-3CD7-9921-16F1BFFCFA7F> /usr/lib/libcurl.4.dylib0x9396a000 - 0x939e4fff com.apple.ApplicationServices.ATS (360 - 373) <55F10232-89FE-317E-8989-0630635F0121> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/ATS0x939e5000 - 0x93a5bfff com.apple.securityfoundation (6.0 - 55125) <8A9A2603-5610-3D99-8F42-C75CAC57092D> /System/Library/Frameworks/SecurityFoundation.framework/Versions/A/SecurityFoundation0x93a5c000 - 0x93a68ff3 libcommonCrypto.dylib (60061) <19665E39-1C4A-3B7B-AB33-B808E00F97FE> /usr/lib/system/libcommonCrypto.dylib0x93a69000 - 0x93ab2fff libFontRegistry.dylib (133) <83673E22-238D-3513-B62A-FA025DF9A152> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/Resources/libFontRegistry.dylib0x93ab3000 - 0x93aceff7 com.apple.CFOpenDirectory (10.10 - 187) <F2FD6A1A-5AAB-31CE-AB42-EEF694C39138> /System/Library/Frameworks/OpenDirectory.framework/Versions/A/Frameworks/CFOpenDirectory.framework/Versions/A/CFOpenDirectory0x93acf000 - 0x93b09fff com.apple.LDAPFramework (2.4.28 - 194.5) <B58B0F39-A7C0-3A7C-B606-9065CA1ED1AA> /System/Library/Frameworks/LDAP.framework/Versions/A/LDAP0x93b10000 - 0x93c22ff7 com.apple.CoreText (352.0 - 450) <3EBCEE3F-03E0-381F-9731-66F21D00DC11> /System/Library/Frameworks/CoreText.framework/Versions/A/CoreText0x93f3b000 - 0x93f3cfff com.apple.TrustEvaluationAgent (2.0 - 25) <28BBD931-EF7C-3753-B50E-6568F4075086> /System/Library/PrivateFrameworks/TrustEvaluationAgent.framework/Versions/A/TrustEvaluationAgent0x942c0000 - 0x942c0fff liblaunch.dylib (559.1.7) <03822C2F-8F48-34A8-AF57-7D5FE05CA297> /usr/lib/system/liblaunch.dylib0x942c1000 - 0x94361fff com.apple.QD (3.48 - 300) <4A32A4F5-48A4-3749-B3F7-8224FA917422> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/QD.framework/Versions/A/QD0x94362000 - 0x9438bfff libRIP.A.dylib (754.1) <FFCD387A-7D94-3F76-9C8A-41A8E7DE0727> /System/Library/Frameworks/CoreGraphics.framework/Versions/A/Resources/libRIP.A.dylib0x9438c000 - 0x943b2ffb libPng.dylib (1230) <74ED7B1A-B8D0-363D-BC9C-2E74C81896A1> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libPng.dylib0x943b3000 - 0x94576ff7 com.apple.QuartzCore (1.10 - 361.3) <AFD0E87B-053E-35E1-86E1-B191A3661B1A> /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore0x94577000 - 0x945f5fff com.apple.SystemConfiguration (1.14 - 1.14) <95045A74-D520-38FA-BCFC-96AFAA4EB4B6> /System/Library/Frameworks/SystemConfiguration.framework/Versions/A/SystemConfiguration0x945f6000 - 0x94662fff com.apple.datadetectorscore (5.0 - 396) <B83917F8-5FFE-3071-AE76-0021C52C4962> /System/Library/PrivateFrameworks/DataDetectorsCore.framework/Versions/A/DataDetectorsCore0x946b7000 - 0x946c5ff3 libxar.1.dylib (254) <D7C4FDEB-61AA-3FC1-8B7B-0AE3A3A64492> /usr/lib/libxar.1.dylib0x946ca000 - 0x946defff com.apple.ImageCapture (9.0 - 9.0) <23F1303A-F93B-3BBE-A6DC-931DB680C25C> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/ImageCapture.framework/Versions/A/ImageCapture0x946df000 - 0x946e1fff libsystem_configuration.dylib (699.1.4) <488307B9-01E5-39B2-8847-B49C4F39E446> /usr/lib/system/libsystem_configuration.dylib0x946e2000 - 0x94733fff com.apple.opencl (2.4.2 - 2.4.2) <E05E503B-BB20-342A-81ED-5EA8087C9B60> /System/Library/Frameworks/OpenCL.framework/Versions/A/OpenCL0x94734000 - 0x9473aff7 com.apple.speech.recognition.framework (5.0.6 - 5.0.6) <EFEAE767-AA42-306F-B35C-F0341EABFA51> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/SpeechRecognition.framework/Versions/A/SpeechRecognition0x948b1000 - 0x948ebff7 com.apple.DebugSymbols (115 - 115) <8B1A8310-EC15-3174-913D-42B892685A5C> /System/Library/PrivateFrameworks/DebugSymbols.framework/Versions/A/DebugSymbols0x948ec000 - 0x948f4fff libsystem_dnssd.dylib (561) <12EEB90B-82E8-3903-B622-FF7C8BCCDDBB> /usr/lib/system/libsystem_dnssd.dylib0x94d9f000 - 0x94da7feb libcldcpuengine.dylib (2.4.5) <C918FDAE-3462-3EC3-9E0F-8A21125A3302> /System/Library/Frameworks/OpenCL.framework/Versions/A/Libraries/libcldcpuengine.dylib0x94dc0000 - 0x94dc9ff7 libsystem_notify.dylib (133.1.1) <16BC7F5B-F438-33EF-9068-99078948AA68> /usr/lib/system/libsystem_notify.dylib0x956d8000 - 0x956ebfff libcmph.dylib (1) <2449B048-208E-36FB-9DFA-47E0F3BCF132> /usr/lib/libcmph.dylib0x956ec000 - 0x9572cfff com.apple.Symbolication (1.4 - 56045) <0661B60C-1ECF-3FA3-A541-6BF0569D43A2> /System/Library/PrivateFrameworks/Symbolication.framework/Versions/A/Symbolication0x9572d000 - 0x9574affb com.apple.Ubiquity (1.3 - 313) <056AF605-B3B8-3897-A2FB-5289C8DE41E3> /System/Library/PrivateFrameworks/Ubiquity.framework/Versions/A/Ubiquity0x9574b000 - 0x95834fff libcrypto.0.9.8.dylib (52) <BF7474C8-46E4-3694-B94A-738076734B79> /usr/lib/libcrypto.0.9.8.dylib0x95835000 - 0x9588bfff libc++.1.dylib (120) <D8DE4962-66CD-3491-904E-9291EEE5E570> /usr/lib/libc++.1.dylib0x9588c000 - 0x9589dfff libbsm.0.dylib (34) <C9F0C608-2794-3F6B-8078-583FC0046039> /usr/lib/libbsm.0.dylib0x958a6000 - 0x958d9fff com.apple.CoreServicesInternal (221 - 221) <DE28C5A5-92B8-3616-BB54-65EDF437047F> /System/Library/PrivateFrameworks/CoreServicesInternal.framework/Versions/A/CoreServicesInternal0x95a62000 - 0x95c58fff libicucore.A.dylib (531.26) <A460D460-1C54-3743-ADF6-EAF1C2544DD8> /usr/lib/libicucore.A.dylib0x95c59000 - 0x95c5cfff libdyld.dylib (353.2.1) <0F834F1E-55D9-3D9B-9733-BBF49C6472FA> /usr/lib/system/libdyld.dylib0x95c5d000 - 0x95c86ff7 libsystem_info.dylib (459) <FEC32E6C-F6B0-34D6-8126-DDA2CC980722> /usr/lib/system/libsystem_info.dylib0x95d0f000 - 0x95d22ff7 com.apple.ProtectedCloudStorage (1.0 - 1) <CCC4EF12-DF4B-36FA-A566-B832C6E18B6C> /System/Library/PrivateFrameworks/ProtectedCloudStorage.framework/Versions/A/ProtectedCloudStorage0x95d23000 - 0x95d23fff com.apple.CoreServices (62 - 62) <51E95B8E-1F5D-39CF-B1F8-2E0CFF3F8501> /System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices0x95d31000 - 0x95d35fff libCoreVMClient.dylib (79) <85CBF1F3-3CE1-304F-88DF-15608C9A2367> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libCoreVMClient.dylib0x95d36000 - 0x95d36fff libOpenScriptingUtil.dylib (162) <D471EF1A-C045-3034-B2DA-0D1349B79925> /usr/lib/libOpenScriptingUtil.dylib0x95d37000 - 0x95d3fffb com.apple.NetFS (6.0 - 4.0) <BE9098D6-D631-3CBA-AD4C-F3621D849AF8> /System/Library/Frameworks/NetFS.framework/Versions/A/NetFS0x95d40000 - 0x95d9bfff com.apple.LanguageModeling (1.0 - 1) <5A3209C8-037B-3FDE-A90B-66DB622DE801> /System/Library/PrivateFrameworks/LanguageModeling.framework/Versions/A/LanguageModeling0x95d9c000 - 0x95e39fff com.apple.ink.framework (10.9 - 213) <07522A36-9EE2-352B-89D2-EA922FBE6C31> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Ink.framework/Versions/A/Ink0x95e9c000 - 0x95eabff3 com.apple.opengl (11.0.5 - 11.0.5) <3AE5E3C7-4181-37DF-9755-EA70CE9A3C48> /System/Library/Frameworks/OpenGL.framework/Versions/A/OpenGL0x95eac000 - 0x95ecbfff libsystem_kernel.dylib (2782.1.80) <52BAA39C-12FC-3BF6-9C73-D6967645362F> /usr/lib/system/libsystem_kernel.dylib0x95ecc000 - 0x95f13ff3 com.apple.AppleJPEG (1.0 - 1) <2C0FADB1-D166-3320-8C48-03271A7C3457> /System/Library/PrivateFrameworks/AppleJPEG.framework/Versions/A/AppleJPEG0x95f14000 - 0x9602bff3 com.apple.desktopservices (1.9 - 1.9) <98FCEDFE-DEC9-331B-AB31-43AC155D2D30> /System/Library/PrivateFrameworks/DesktopServicesPriv.framework/Versions/A/DesktopServicesPriv0x96059000 - 0x9618bffb com.apple.UIFoundation (1.0 - 1) <8988B1F1-2CCC-39D5-A37D-D34A295525BE> /System/Library/PrivateFrameworks/UIFoundation.framework/Versions/A/UIFoundation0x96194000 - 0x96198fff com.apple.CommonPanels (1.2.6 - 96) <2CBDC939-8E09-30D1-B4F8-22868993B988> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/CommonPanels.framework/Versions/A/CommonPanels0x96199000 - 0x961b8ffb libresolv.9.dylib (57) <C2C3810A-A45E-3375-B41D-6E1BECE1BA3C> /usr/lib/libresolv.9.dylib0x9636a000 - 0x9639effb com.apple.frameworks.CoreDaemon (1.3 - 1.3) <EEA082B1-9C22-384A-8587-2E9813CF2DB5> /System/Library/PrivateFrameworks/CoreDaemon.framework/Versions/B/CoreDaemon0x9639f000 - 0x963cefff com.apple.CoreVideo (1.8 - 145.0) <5822134F-3114-39EE-97F8-0F0F5A24DD16> /System/Library/Frameworks/CoreVideo.framework/Versions/A/CoreVideo0x963cf000 - 0x963dbff7 libcsfde.dylib (468) <DBB1DEB1-26CD-32C0-BB80-054D45A2B050> /usr/lib/libcsfde.dylib0x963dc000 - 0x963ffffb com.apple.framework.Apple80211 (10.0 - 1000.47) <2D8F9EAB-5C86-36FC-8F48-DBB22B5A0A9F> /System/Library/PrivateFrameworks/Apple80211.framework/Versions/A/Apple802110x96400000 - 0x96403fff com.apple.xpc.ServiceManagement (1.0 - 1) <15AD8E1F-073B-3B2F-A0A7-955EE30A6F06> /System/Library/Frameworks/ServiceManagement.framework/Versions/A/ServiceManagement0x96404000 - 0x96fdbffb com.apple.AppKit (6.9 - 1331.12) <4E68D16B-713C-37FD-8BD6-199D2772A7B0> /System/Library/Frameworks/AppKit.framework/Versions/C/AppKit0x96fe8000 - 0x970d4fe7 libvMisc.dylib (512) <56B7DE45-36B1-32BE-B823-DB14F315EEB9> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libvMisc.dylib0x970d5000 - 0x971d2ff7 com.apple.LaunchServices (641.1.2 - 641.1.2) <F15AE779-AA0B-3D1E-92C8-BDAF555AA0A9> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/LaunchServices.framework/Versions/A/LaunchServices0x971d3000 - 0x97213fff libauto.dylib (186) <1609D0F9-6E3A-3C67-87EF-BB0BD93EDAC9> /usr/lib/libauto.dylib0x97214000 - 0x97218fff libheimdal-asn1.dylib (398) <2E5C5B4B-6CFF-3AE7-B5B7-84F834D5348A> /usr/lib/libheimdal-asn1.dylib0x97219000 - 0x97222ffb com.apple.CommonAuth (4.0 - 2.0) <5C8CFDF2-6932-3AC0-87CC-500E915710FA> /System/Library/PrivateFrameworks/CommonAuth.framework/Versions/A/CommonAuth0x975e3000 - 0x975ebfff com.apple.CoreServices.FSEvents (1210 - 1210) <0CF2ED08-0972-3E32-8268-E944E6EAAF53> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/FSEvents.framework/Versions/A/FSEvents0x976f9000 - 0x976fcff7 com.apple.help (1.3.3 - 46) <B7E4F49A-9442-3107-9320-42E7878F02B1> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Help.framework/Versions/A/Help0x976fd000 - 0x97708ff7 com.apple.NetAuth (5.0 - 5.0) <1667582F-656C-323B-894A-E408B70E6A9F> /System/Library/PrivateFrameworks/NetAuth.framework/Versions/A/NetAuth0x97709000 - 0x9779bfff com.apple.CoreSymbolication (3.1 - 56072) <DA781DE3-0D1E-3893-9571-7F7A778CFD73> /System/Library/PrivateFrameworks/CoreSymbolication.framework/Versions/A/CoreSymbolication0x9779c000 - 0x97a2eff7 com.apple.CoreData (110 - 522) <2236DD75-E2DA-3937-A528-1E761A4241A2> /System/Library/Frameworks/CoreData.framework/Versions/A/CoreData0x97a2f000 - 0x97a5dff7 libarchive.2.dylib (30) <9505A3D3-CE6E-3D45-B22E-DBC923A933B8> /usr/lib/libarchive.2.dylib0x97a5e000 - 0x97ab9ffb libTIFF.dylib (1230) <03927ED0-F4AD-37B1-82FE-EE10977A2867> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libTIFF.dylib0x97aba000 - 0x97b0dff7 com.apple.HIServices (1.22 - 516) <66314CBC-D6EE-37E7-A667-2B3C4D3DFE35> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/HIServices.framework/Versions/A/HIServices0x97b0e000 - 0x97b25fff libsystem_asl.dylib (267) <61F3AE18-A118-38F3-A1A9-353D38532F25> /usr/lib/system/libsystem_asl.dylib0x97b26000 - 0x97b62ff3 com.apple.RemoteViewServices (2.0 - 99) <44A7D91E-80AA-3191-90A3-6C3CC66A8658> /System/Library/PrivateFrameworks/RemoteViewServices.framework/Versions/A/RemoteViewServices0x97b63000 - 0x97c6ffe3 libvDSP.dylib (512) <46C25529-ACD8-3929-B6F0-6AEE80DAF14D> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libvDSP.dylib0x97c70000 - 0x97c72ff7 libsystem_sandbox.dylib (358.1.1) <7C2B1D4A-17B0-3785-8498-C65B827246F7> /usr/lib/system/libsystem_sandbox.dylib0x97c73000 - 0x97c77ffb libGIF.dylib (1230) <C5A7F653-02E4-3022-96E5-CE822D751DAE> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libGIF.dylib0x97c78000 - 0x97f67ff7 com.apple.CoreImage (10.0.30) <93B04FDA-6E66-3A9B-9AC6-36F4D187A336> /System/Library/Frameworks/QuartzCore.framework/Versions/A/Frameworks/CoreImage.framework/Versions/A/CoreImage0x97f68000 - 0x97f83ff3 com.apple.openscripting (1.4 - 162) <950F79B1-F756-34AA-B8B1-3BEE27ADD7D3> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/OpenScripting.framework/Versions/A/OpenScripting0x97fb2000 - 0x98091fff com.apple.backup.framework (1.6 - 1.6) <6B1DBBB9-FEC7-3E4E-9953-00FB1D81E20F> /System/Library/PrivateFrameworks/Backup.framework/Versions/A/Backup0x98092000 - 0x9809bfff com.apple.AppleSRP (5.0 - 1) <41C48FA8-C249-3800-A551-7F4AFA3E723F> /System/Library/PrivateFrameworks/AppleSRP.framework/Versions/A/AppleSRP0x9809c000 - 0x980f1ff7 com.apple.audio.CoreAudio (4.3.0 - 4.3.0) <E1E94237-02EF-34B2-AB7F-0AE821F6CB7B> /System/Library/Frameworks/CoreAudio.framework/Versions/A/CoreAudio0x980f2000 - 0x98104fff com.apple.Sharing (316 - 316) <EAACB397-0173-31F6-9EAA-222E8A4CBC5B> /System/Library/PrivateFrameworks/Sharing.framework/Versions/A/Sharing0x98105000 - 0x984b7fff com.apple.CoreFoundation (6.9 - 1150.11) <18DF9262-BEAB-3F3B-A378-CF7D85B3FB28> /System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation0x984b8000 - 0x984bafff com.apple.securityhi (9.0 - 55005) <057C189F-D972-351D-B735-B1B421F0E1E6> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/SecurityHI.framework/Versions/A/SecurityHI0x984bb000 - 0x98641fff libsqlite3.dylib (164) <F3B4BDB1-E1B4-39C6-A93E-D9BC6A3BAF57> /usr/lib/libsqlite3.dylib0x98642000 - 0x98675fe3 libsystem_m.dylib (3086.1) <37982713-2BC5-36FD-9923-6056A2416620> /usr/lib/system/libsystem_m.dylib0x98676000 - 0x98767ffb libiconv.2.dylib (42) <4AF77F10-0BEC-3BE0-99DF-C5170EDB316B> /usr/lib/libiconv.2.dylib0x98768000 - 0x987f4ff3 com.apple.PerformanceAnalysis (1.0 - 1) <D5F5C1F1-E880-3725-AA3A-346AD7042796> /System/Library/PrivateFrameworks/PerformanceAnalysis.framework/Versions/A/PerformanceAnalysis0x987f5000 - 0x98808fff com.apple.CoreBluetooth (1.0 - 1) <2216AB08-4749-3BC8-8BAD-4B3178C902FC> /System/Library/Frameworks/CoreBluetooth.framework/Versions/A/CoreBluetooth0x98809000 - 0x98815ff7 com.apple.speech.synthesis.framework (5.2.1 - 5.2.1) <8302974A-5C6D-3A8C-871F-FFACECADD27A> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/SpeechSynthesis.framework/Versions/A/SpeechSynthesis0x98816000 - 0x988bbfff com.apple.Metadata (10.7.0 - 899) <07D04AC5-659B-34D5-A21C-CFD82ED7DD6F> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/Metadata.framework/Versions/A/Metadata0x988bc000 - 0x988e6fff libxslt.1.dylib (13) <0F55B64A-6C55-304E-ACE0-B531027AA066> /usr/lib/libxslt.1.dylib0x988e7000 - 0x988f3ff7 libkxld.dylib (2782.1.80) <C247D987-910B-3457-9157-1E8C569F5183> /usr/lib/system/libkxld.dylib0x988f4000 - 0x988f4fff libkeymgr.dylib (28) <1CEB82CD-2F94-3FD7-B31A-A229618EB430> /usr/lib/system/libkeymgr.dylib0x988f5000 - 0x98ccaff7 com.apple.HIToolbox (2.1.1 - 747) <23D0D5E8-464F-3116-9260-2C90A02F2317> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/HIToolbox.framework/Versions/A/HIToolbox0x98ccb000 - 0x98cf9fff com.apple.DictionaryServices (1.2 - 227) <7E75AF7E-7223-329D-A33B-8C9B23890418> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/DictionaryServices.framework/Versions/A/DictionaryServices0x98d01000 - 0x98d03ffb libCGXType.A.dylib (754.1) <91D4F442-2FFB-3C65-9466-A4ACC7250DE2> /System/Library/Frameworks/CoreGraphics.framework/Versions/A/Resources/libCGXType.A.dylib0x98da6000 - 0x98da8fff libCVMSPluginSupport.dylib (11.0.5) <8453DB16-BB2D-32D7-BD58-6EC202907A48> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libCVMSPluginSupport.dylib0x98db2000 - 0x98db2fff com.apple.audio.units.AudioUnit (1.12 - 1.12) <7ED04704-DD04-346A-ABAC-98FC2B128932> /System/Library/Frameworks/AudioUnit.framework/Versions/A/AudioUnit0x98db3000 - 0x9904cfff com.apple.RawCamera.bundle (6.00 - 754) <AC102D5B-8B4C-3AA3-94CB-A264F9F11E07> /System/Library/CoreServices/RawCamera.bundle/Contents/MacOS/RawCamera0x9904d000 - 0x99052fff com.apple.print.framework.Print (10.0 - 265) <568A1B1C-810D-3647-90EC-33F0FD691960> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Print.framework/Versions/A/Print0x99053000 - 0x990e8ff3 libsystem_c.dylib (1044.1.1) <DCE7F6D7-21DE-3FC2-A051-40CB4E4F0832> /usr/lib/system/libsystem_c.dylib0x990e9000 - 0x990e9fff com.apple.Accelerate.vecLib (3.10 - vecLib 3.10) <96675103-6E3D-326A-83C0-82D3A34C3A1A> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/vecLib0x990ea000 - 0x99525fd7 com.apple.vImage (8.0 - 8.0) <AE6DA57E-3C8E-39EC-869F-1C2EF6AC4376> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vImage.framework/Versions/A/vImage0x99526000 - 0x99529fff libextension.dylib (50) <B94A01F4-DDD9-33BD-B07E-610D1500F917> /usr/lib/libextension.dylib0x9952a000 - 0x996b5ffb com.apple.audio.toolbox.AudioToolbox (1.12 - 1.12) <D5332121-FC40-37C2-BEB0-878C847319F7> /System/Library/Frameworks/AudioToolbox.framework/Versions/A/AudioToolbox0x996b6000 - 0x996b7fff libSystem.B.dylib (1213) <1A292FD8-3AC9-3E87-A7C0-88A7E4219392> /usr/lib/libSystem.B.dylib0x997c7000 - 0x997cfff7 libCGCMS.A.dylib (754.1) <E531AEDC-A85A-3774-BB90-F647A42B333E> /System/Library/Frameworks/CoreGraphics.framework/Versions/A/Resources/libCGCMS.A.dylib0x997d0000 - 0x9980afff com.apple.MediaKit (16 - 756) <0CAB9818-18A7-31DE-BC63-FD07EB753208> /System/Library/PrivateFrameworks/MediaKit.framework/Versions/A/MediaKit0x9980b000 - 0x99c01fff com.apple.CoreGraphics (1.600.0 - 754.1) <54252926-6E76-3880-A4D6-03EFC8F333F4> /System/Library/Frameworks/CoreGraphics.framework/Versions/A/CoreGraphics0x99c02000 - 0x99dde2ef libobjc.A.dylib (646) <EF789AF0-508F-3D49-A988-376CE2E1107C> /usr/lib/libobjc.A.dylib0x99ddf000 - 0x99e53ff3 com.apple.Heimdal (4.0 - 2.0) <F0012CD1-F49D-3259-89D0-E15C2B50B308> /System/Library/PrivateFrameworks/Heimdal.framework/Versions/A/Heimdal0x99e54000 - 0x99e6dfff com.apple.Kerberos (3.0 - 1) <7950EB36-BEBA-3CC5-A9DF-E49B0EB3AE56> /System/Library/Frameworks/Kerberos.framework/Versions/A/Kerberos0x99e6e000 - 0x99e70fff libsystem_coreservices.dylib (9) <E029A4DF-F588-314D-82B4-13FE48518831> /usr/lib/system/libsystem_coreservices.dylib0x99e71000 - 0x99ec6ff7 com.apple.htmlrendering (77 - 1.1.4) <79359AB7-86A6-3356-9604-73955F47B36D> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/HTMLRendering.framework/Versions/A/HTMLRendering0x99ec7000 - 0x99ec7fff com.apple.Accelerate (1.10 - Accelerate 1.10) <7AD2A383-63B9-3FA8-BBEF-DCBCF0D01F6C> /System/Library/Frameworks/Accelerate.framework/Versions/A/Accelerate0x99ec8000 - 0x99f2cffb com.apple.AE (680 - 680) <74735E5D-B505-3D5E-9790-27F2841285BC> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/AE.framework/Versions/A/AE0x99f2d000 - 0x99f44ff3 libLinearAlgebra.dylib (1128) <B20FAAAA-1C76-3B20-B100-5FC90F7FE023> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libLinearAlgebra.dylib0x99f45000 - 0x99f82ff7 libsystem_network.dylib (408) <E8B7CA94-7DED-39FE-8C28-74EB1020B65F> /usr/lib/system/libsystem_network.dylib0x99f83000 - 0x99fc3ffb libGLImage.dylib (11.0.5) <A1A10306-7EF0-38E7-BD0D-D7CC58E14F6E> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGLImage.dylib0x99fc4000 - 0x9a3f7ff3 com.apple.vision.FaceCore (3.1.6 - 3.1.6) <11BD7F81-AEF5-30AF-BF0B-3095B18D299C> /System/Library/PrivateFrameworks/FaceCore.framework/Versions/A/FaceCore0x9ada7000 - 0x9ada8fff libunc.dylib (28) <F36FBA4E-BA5F-3E1F-9AF0-9BCA53BC8D06> /usr/lib/system/libunc.dylib0x9ae57000 - 0x9ae5eff3 libunwind.dylib (35.3) <38BC2EF3-BD2C-36E9-9F78-2039E7999162> /usr/lib/system/libunwind.dylib0x9aed0000 - 0x9aef6ff3 libc++abi.dylib (125) <E9AF8CA1-D54D-37E3-8363-A3E8C0840F71> /usr/lib/libc++abi.dylib0x9aef7000 - 0x9af1afff libJPEG.dylib (1230) <50D8776B-A29A-3546-92FE-5F383AE1B9ED> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libJPEG.dylib0x9af1b000 - 0x9af28ff7 com.apple.ProtocolBuffer (1 - 225.1) <660D68A0-00F9-326C-8EBD-CE3A6A911882> /System/Library/PrivateFrameworks/ProtocolBuffer.framework/Versions/A/ProtocolBuffer0x9af29000 - 0x9af33ffb com.apple.audio.SoundManager (4.2 - 4.2) <EF1A1C69-1CB9-3FC9-8EDA-0D3F90438EC7> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/CarbonSound.framework/Versions/A/CarbonSound0x9af34000 - 0x9b024ff3 com.apple.DiskImagesFramework (10.10 - 389) <58B79B83-8C4B-3C9A-97FB-48E75EC4224A> /System/Library/PrivateFrameworks/DiskImages.framework/Versions/A/DiskImages0x9b025000 - 0x9b0d4ff3 com.apple.Bluetooth (4.3.0 - 4.3.0b13) <DB36334E-7405-3498-AB9C-E609F8A40621> /System/Library/Frameworks/IOBluetooth.framework/Versions/A/IOBluetooth0x9b0d5000 - 0x9b0e5ff7 com.apple.LangAnalysis (1.7.0 - 1.7.0) <D6F05FB2-CD47-3A9A-B9B2-E110BE33F831> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/LangAnalysis.framework/Versions/A/LangAnalysis0x9b0e6000 - 0x9b0e6fff com.apple.Carbon (154 - 157) <CCAEDF74-3B62-332A-B18F-2E390DE4E407> /System/Library/Frameworks/Carbon.framework/Versions/A/Carbon0x9b0e7000 - 0x9b181fff com.apple.ColorSync (4.9.0 - 4.9.0) <E89E51C8-19D7-39BB-8921-8ABE656BD2D1> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ColorSync.framework/Versions/A/ColorSync0x9b182000 - 0x9b56aff7 libLAPACK.dylib (1128) <4E3D1289-2C98-3E53-BB8D-AD911357FF66> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libLAPACK.dylib0x9b59d000 - 0x9b70effb libBLAS.dylib (1128) <ACEF468C-5DB1-38F3-BCB2-6F3D7F2B2040> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib0x9b70f000 - 0x9b987ffb com.apple.security (7.0 - 55406) <41073BCD-8602-393A-B426-AA7EBC7A4971> /System/Library/Frameworks/Security.framework/Versions/A/Security0x9b98b000 - 0x9b9a4ffb libsystem_malloc.dylib (53) <3E21B30B-77EF-3143-9625-40555D35375C> /usr/lib/system/libsystem_malloc.dylib0x9b9a5000 - 0x9ba57fff libCoreStorage.dylib (468) <4434DDD3-B282-3F45-B4AB-AF0244F4DE26> /usr/lib/libCoreStorage.dylib0x9ba58000 - 0x9ba5affb libsystem_secinit.dylib (18) <A31E4E98-B2A5-33FB-AC06-5F62D3713920> /usr/lib/system/libsystem_secinit.dylib0x9ba7e000 - 0x9bc80ffb com.apple.CFNetwork (714 - 714) <9FD8415C-2F58-3124-94E9-57B03F6E9E94> /System/Library/Frameworks/CFNetwork.framework/Versions/A/CFNetwork0x9bc81000 - 0x9bc96ffb com.apple.MultitouchSupport.framework (260.29 - 260.29) <FC591B47-058C-3CD5-9032-32B704E8FC34> /System/Library/PrivateFrameworks/MultitouchSupport.framework/Versions/A/MultitouchSupport0x9bc97000 - 0x9bc97fff com.apple.ApplicationServices (48 - 48) <D3F49C7F-BE74-3C6B-9306-502E7F3ACB78> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/ApplicationServices0x9bc98000 - 0x9bca1fff com.apple.DiskArbitration (2.6 - 2.6) <2CC468C1-625A-3BC6-8271-DAC70263CD02> /System/Library/Frameworks/DiskArbitration.framework/Versions/A/DiskArbitration0x9bf2a000 - 0x9bf2fff7 libcompiler_rt.dylib (35) <0D0E826D-BC15-3E80-BF58-0E6ECE919C2D> /usr/lib/system/libcompiler_rt.dylib0x9bf30000 - 0x9c28effb com.apple.Foundation (6.9 - 1150.12) <5BD65BE4-18A3-336A-95C5-E1AF0568C0DF> /System/Library/Frameworks/Foundation.framework/Versions/C/Foundation0x9c28f000 - 0x9c2faff7 com.apple.framework.CoreWiFi (3.0 - 300.3) <F0D5E81B-E0E2-3BD1-916D-741F2B51EC97> /System/Library/Frameworks/CoreWiFi.framework/Versions/A/CoreWiFi0x9c2fb000 - 0x9c2ffffb com.apple.IOSurface (97 - 97) <7283FBC9-CD72-3367-A59A-E2FFFDFF0334> /System/Library/Frameworks/IOSurface.framework/Versions/A/IOSurface0x9c318000 - 0x9c319fff libsystem_blocks.dylib (65) <4EADAA33-46FC-3A88-949F-406F7095DD4C> /usr/lib/system/libsystem_blocks.dylib0x9c31a000 - 0x9c31dffb libutil.dylib (38) <B5A16C6B-A79E-3504-BDA6-64A063F6612D> /usr/lib/libutil.dylibExternal Modification Summary: Calls made by other processes targeting this process: task_for_pid: 1 thread_create: 0 thread_set_state: 0 Calls made by this process: task_for_pid: 0 thread_create: 0 thread_set_state: 0 Calls made by all processes on this machine: task_for_pid: 196805 thread_create: 0 thread_set_state: 0VM Region Summary:ReadOnly portion of Libraries: Total=218.8M resident=30.5M(14%) swapped_out_or_unallocated=188.3M(86%)Writable regions: Total=101.9M written=4216K(4%) resident=6004K(6%) swapped_out=4K(0%) unallocated=96.0M(94%) REGION TYPE VIRTUAL=========== =======CG backing stores 336KCG image 8KCG shared images 208KKernel Alloc Once 4KMALLOC 70.1MMALLOC (admin) 48KOpenCL 16KStack 68.6MStack (reserved) 516K reserved VM address space (unallocated)VM_ALLOCATE 17.5M__DATA 8308K__IMAGE 528K__LINKEDIT 54.7M__OBJC 2288K__TEXT 164.1M__UNICODE 544Kmapped file 152.3Mshared memory 4K=========== =======TOTAL 539.9MTOTAL, minus reserved VM space 539.4MTried to open LibreOffice again(after the crash) this time with out errorI commented too soon it si back to crashingProcess: soffice [24173]Path: /Applications/LibreOffice.app/Contents/MacOS/sofficeIdentifier: org.libreoffice.scriptVersion: 4.3.1002 (???)Code Type: X86 (Native)Parent Process: ??? [1]Responsible: soffice [24173]User ID: 501Date/Time: 2014-09-01 23:10:56.514 -0500OS Version: Mac OS X 10.10 (14A329r)Report Version: 11Anonymous UUID: 12D35764-EC09-50CE-7947-2817279307EBTime Awake Since Boot: 510000 secondsCrashed Thread: 0 Dispatch queue: com.apple.main-threadException Type: EXC_BAD_ACCESS (SIGSEGV)Exception Codes: KERN_INVALID_ADDRESS at 0x0000000000000000VM Regions Near 0:--> __TEXT 0000000000001000-0000000000002000 [ 4K] r-x/rwx SM=COW /Applications/LibreOffice.app/Contents/MacOS/sofficeThread 0 Crashed:: Dispatch queue: com.apple.main-thread0 libvcllo.dylib 0x01cdb9fc -[VCL_NSApplication screenParametersChanged:] + 281 com.apple.Foundation 0x9bf44e63 __57-[NSNotificationCenter addObserver:selector:name:object:]_block_invoke + 502 com.apple.CoreFoundation 0x98233d34 __CFNOTIFICATIONCENTER_IS_CALLING_OUT_TO_AN_OBSERVER__ + 203 com.apple.CoreFoundation 0x98114b61 _CFXNotificationPost + 37134 com.apple.Foundation 0x9bf32d84 -[NSNotificationCenter postNotificationName:object:userInfo:] + 925 com.apple.Foundation 0x9bf515c2 -[NSNotificationCenter postNotificationName:object:] + 566 com.apple.AppKit 0x96798da5 -[NSApplication _reactToScreenInvalidation:] + 5657 com.apple.AppKit 0x967990f7 -[NSApplication _reactToDockChanged] + 708 com.apple.AppKit 0x966bd965 _NSCoreDockMessageReceive + 7849 com.apple.HIToolbox 0x98c0d4af DockCallback(unsigned long, unsigned int, void*, void*) + 274210 com.apple.HIServices 0x97ac4bfc dockClientNotificationProc + 16811 com.apple.CoreGraphics 0x998897e8 CGSConnectionNotifier::invoke_callbacks(unsigned int, void*, unsigned long) const + 50612 com.apple.CoreGraphics 0x998895db CGSPostLocalNotificationToConnection + 4913 com.apple.CoreGraphics 0x99889584 (anonymous namespace)::notify_datagram_handler(unsigned int, CGSDatagramType, void*, unsigned long, void*) + 11214 com.apple.CoreGraphics 0x9984078d CGSDatagramReadStream::dispatch_next_datagram() + 76515 com.apple.CoreGraphics 0x99840483 CGSDatagramReadStream::dispatch_datagrams() + 4716 com.apple.CoreGraphics 0x9984027c CGSDatagramReadStreamDispatchDatagramsWithData + 15017 com.apple.CoreGraphics 0x9983ffeb CGSSnarfAndDispatchDatagrams + 50818 com.apple.CoreGraphics 0x9983fcce CGSGetNextEventRecordInternal + 8419 com.apple.CoreGraphics 0x9983fc35 CGEventCreateNextEvent + 3920 com.apple.HIToolbox 0x98929c71 PullEventsFromWindowServerOnConnection(unsigned int, unsigned char, __CFMachPortBoost*) + 8321 com.apple.HIToolbox 0x98929bee MessageHandler(__CFMachPort*, void*, long, void*) + 5522 com.apple.CoreFoundation 0x9818b841 __CFMachPortPerform + 25723 com.apple.CoreFoundation 0x9818b735 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ + 5324 com.apple.CoreFoundation 0x9818b69e __CFRunLoopDoSource1 + 51025 com.apple.CoreFoundation 0x9817cab0 __CFRunLoopRun + 262426 com.apple.CoreFoundation 0x9817be06 CFRunLoopRunSpecific + 39027 com.apple.CoreFoundation 0x9817bc6b CFRunLoopRunInMode + 12328 com.apple.HIToolbox 0x98920a88 RunCurrentEventLoopInMode + 26229 com.apple.HIToolbox 0x98920693 ReceiveNextEventCommon + 19230 com.apple.HIToolbox 0x989205bc _BlockUntilNextEventMatchingListInModeWithFilter + 9931 com.apple.AppKit 0x9642b199 _DPSNextEvent + 73432 com.apple.AppKit 0x9642aa03 -[NSApplication nextEventMatchingMask:untilDate:inMode:dequeue:] + 12433 com.apple.AppKit 0x9641d14c -[NSApplication run] + 90734 com.apple.AppKit 0x96406700 NSApplicationMain + 208235 libvcllo.dylib 0x01ca011f ImplSVMainHook(int*) + 33536 libvcllo.dylib 0x01c2beda SVMain() + 2637 libsofficeapp.dylib 0x0009af05 soffice_main + 27738 org.libreoffice.script 0x00001f4e main + 3039 org.libreoffice.script 0x00001f25 start + 53Thread 1:0 libsystem_kernel.dylib 0x95ec5516 __psynch_cvwait + 101 libsystem_pthread.dylib 0x904f2b06 _pthread_cond_wait + 7262 libsystem_pthread.dylib 0x904f621d pthread_cond_timedwait$UNIX2003 + 713 libuno_sal.dylib.3 0x000107fb rtl_cache_wsupdate_all(void*) + 2674 libsystem_pthread.dylib 0x904f1ecf _pthread_body + 1385 libsystem_pthread.dylib 0x904f1e45 _pthread_start + 1626 libsystem_pthread.dylib 0x904eff0e thread_start + 34Thread 2:: Dispatch queue: com.apple.libdispatch-manager0 libsystem_kernel.dylib 0x95ec68d2 kevent64 + 101 libdispatch.dylib 0x934137f1 _dispatch_mgr_invoke + 2452 libdispatch.dylib 0x93413450 _dispatch_mgr_thread + 52Thread 3:0 libsystem_kernel.dylib 0x95ec5e6e __workq_kernreturn + 101 libsystem_pthread.dylib 0x904f236d _pthread_wqthread + 9392 libsystem_pthread.dylib 0x904efeea start_wqthread + 30Thread 4:0 libsystem_kernel.dylib 0x95ec5e6e __workq_kernreturn + 101 libsystem_pthread.dylib 0x904f236d _pthread_wqthread + 9392 libsystem_pthread.dylib 0x904efeea start_wqthread + 30Thread 5:0 libsystem_kernel.dylib 0x95ec5e6e __workq_kernreturn + 101 libsystem_pthread.dylib 0x904f236d _pthread_wqthread + 9392 libsystem_pthread.dylib 0x904efeea start_wqthread + 30Thread 6:0 libsystem_kernel.dylib 0x95ec5e6e __workq_kernreturn + 101 libsystem_pthread.dylib 0x904f236d _pthread_wqthread + 9392 libsystem_pthread.dylib 0x904efeea start_wqthread + 30Thread 7:0 libsystem_kernel.dylib 0x95ec5e6e __workq_kernreturn + 101 libsystem_pthread.dylib 0x904f236d _pthread_wqthread + 9392 libsystem_pthread.dylib 0x904efeea start_wqthread + 30Thread 8:0 libsystem_kernel.dylib 0x95ec5e6e __workq_kernreturn + 101 libsystem_pthread.dylib 0x904f236d _pthread_wqthread + 9392 libsystem_pthread.dylib 0x904efeea start_wqthread + 30Thread 9:0 libsystem_kernel.dylib 0x95ec5e6e __workq_kernreturn + 101 libsystem_pthread.dylib 0x904f236d _pthread_wqthread + 9392 libsystem_pthread.dylib 0x904efeea start_wqthread + 30Thread 10:0 libsystem_kernel.dylib 0x95ec5e6e __workq_kernreturn + 101 libsystem_pthread.dylib 0x904f236d _pthread_wqthread + 9392 libsystem_pthread.dylib 0x904efeea start_wqthread + 30Thread 0 crashed with X86 Thread State (32-bit): eax: 0x00000000 ebx: 0x01cdb9ee ecx: 0xbfff4680 edx: 0x00000000 edi: 0x0450a650 esi: 0x01e1ca1c ebp: 0xbfff4708 esp: 0xbfff46d0 ss: 0x00000023 efl: 0x00010282 eip: 0x01cdb9fc cs: 0x0000001b ds: 0x00000023 es: 0x00000023 fs: 0x00000000 gs: 0x0000000f cr2: 0x00000000 Logical CPU: 2Error Code: 0x00000004Trap Number: 14Binary Images: 0x1000 - 0x1ff7 +org.libreoffice.script (4.3.1002 - ???) <0E316897-FF31-26B9-94D4-D9D22C5FCC74> /Applications/LibreOffice.app/Contents/MacOS/soffice 0x5000 - 0x42fff +libuno_sal.dylib.3 (0) <82DB2A78-F5E5-5364-ACED-AAE13284E5FA> /Applications/LibreOffice.app/Contents/ure-link/lib/libuno_sal.dylib.3 0x60000 - 0xcbfff +libsofficeapp.dylib (0) <113E236D-4618-B17D-EC14-6C230D6BB2DC> /Applications/LibreOffice.app/Contents/MacOS/libsofficeapp.dylib 0xfa000 - 0x214ffb +libcomphelper.dylib (0) <8E26E29E-87F3-EB73-CFBA-AC980D7C7EDD> /Applications/LibreOffice.app/Contents/MacOS/libcomphelper.dylib 0x2d0000 - 0x2fdff7 +libuno_cppu.dylib.3 (0) <2EB4DD02-FEF5-6789-1D3C-82FE736EEA78> /Applications/LibreOffice.app/Contents/ure-link/lib/libuno_cppu.dylib.3 0x30f000 - 0x3dbff3 +libuno_cppuhelpergcc3.dylib.3 (0) <DF380B1A-6591-E62A-3AF3-D16B3EF82A85> /Applications/LibreOffice.app/Contents/ure-link/lib/libuno_cppuhelpergcc3.dylib.3 0x451000 - 0x478ff3 +libdeploymentmisclo.dylib (0) <5C826729-AC2D-CFE0-1BE9-8787927ACE57> /Applications/LibreOffice.app/Contents/MacOS/libdeploymentmisclo.dylib 0x48f000 - 0x4beff3 +libi18nlangtag.dylib (0) <3CEDA7BD-350A-47B0-B946-73E546D70783> /Applications/LibreOffice.app/Contents/MacOS/libi18nlangtag.dylib 0x4d9000 - 0x4dcff3 +libuno_salhelpergcc3.dylib.3 (0) <14545635-4A8D-C805-6080-3528ED17DC18> /Applications/LibreOffice.app/Contents/ure-link/lib/libuno_salhelpergcc3.dylib.3 0x4e3000 - 0x647fef +libsblo.dylib (0) <529E2E26-40F1-B426-5F26-D12EC5B267C0> /Applications/LibreOffice.app/Contents/MacOS/libsblo.dylib 0x6e2000 - 0xafffff +libsfxlo.dylib (0) <E0470D12-9648-CD4E-AA35-B26F2451F51B> /Applications/LibreOffice.app/Contents/MacOS/libsfxlo.dylib 0xcfa000 - 0xdd1ff7 +libsvllo.dylib (0) <D866990B-3BFE-603E-D737-F09F8D10A540> /Applications/LibreOffice.app/Contents/MacOS/libsvllo.dylib 0xe3b000 - 0x10eaff3 +libsvtlo.dylib (0) <B6C892D5-585D-F026-BC46-D998AE219906> /Applications/LibreOffice.app/Contents/MacOS/libsvtlo.dylib 0x128c000 - 0x14d5feb +libtklo.dylib (0) <95C5544C-4352-0B85-7CA1-5C66DA8B72A9> /Applications/LibreOffice.app/Contents/MacOS/libtklo.dylib 0x16a8000 - 0x1707ffb +libtllo.dylib (0) <8CC90393-4A81-7863-8FBC-2B684D392418> /Applications/LibreOffice.app/Contents/MacOS/libtllo.dylib 0x172a000 - 0x1787ff7 +libucbhelper.dylib (0) <69D1AB85-ECE5-3A15-9CCC-26670685AD0A> /Applications/LibreOffice.app/Contents/MacOS/libucbhelper.dylib 0x17c7000 - 0x18c7ffb +libutllo.dylib (0) <B995F7E2-357D-CE01-1C19-DB878AA54D25> /Applications/LibreOffice.app/Contents/MacOS/libutllo.dylib 0x1941000 - 0x1dfefeb +libvcllo.dylib (0) <7446D821-B061-7159-430B-86138D82C2FF> /Applications/LibreOffice.app/Contents/MacOS/libvcllo.dylib 0x1f92000 - 0x20a9ffb +libicuuc.dylib.53 (53.1) <AFDE0B23-F526-4479-6FDB-256C489BB781> /Applications/LibreOffice.app/Contents/MacOS/libicuuc.dylib.53 0x2100000 - 0x2116fe7 +libreglo.dylib (0) <D3EFFEC3-3ADE-5A49-7A7E-7641202DC374> /Applications/LibreOffice.app/Contents/ure-link/lib/libreglo.dylib 0x2120000 - 0x2182fff +libunoidllo.dylib (0) <8BEDA82F-BC6F-E430-F50C-AC2554F35AE9> /Applications/LibreOffice.app/Contents/ure-link/lib/libunoidllo.dylib 0x2191000 - 0x219aff3 +libxmlreaderlo.dylib (0) <ADE4AE4D-FFB3-88C0-5625-CAAC35930559> /Applications/LibreOffice.app/Contents/ure-link/lib/libxmlreaderlo.dylib 0x21a0000 - 0x21baff7 +libstorelo.dylib (0) <C0EE57D4-40FE-8D0A-E8A9-58BA143B9FBF> /Applications/LibreOffice.app/Contents/ure-link/lib/libstorelo.dylib 0x21c5000 - 0x364cff7 +libicudata.dylib.53 (53.1) <6431AE13-F1C1-F438-4F4F-D9FD8BFA1BCA> /Applications/LibreOffice.app/Contents/MacOS/libicudata.dylib.53 0x3668000 - 0x3701fef +libxmlscriptlo.dylib (0) <CC1330ED-8D69-C448-5F66-11BAE2343A53> /Applications/LibreOffice.app/Contents/MacOS/libxmlscriptlo.dylib 0x3732000 - 0x37caff3 +libbasegfxlo.dylib (0) <CB234961-6064-5DFF-82E0-291F9C98036F> /Applications/LibreOffice.app/Contents/MacOS/libbasegfxlo.dylib 0x37f1000 - 0x3842ff7 +libsotlo.dylib (0) <DB9A10F6-F50F-722B-0A51-8F6B51F5B01F> /Applications/LibreOffice.app/Contents/MacOS/libsotlo.dylib 0x3869000 - 0x3879ff7 +libi18nutil.dylib (0) <A86B959D-B805-FE73-871A-67AF83E0ABDC> /Applications/LibreOffice.app/Contents/MacOS/libi18nutil.dylib 0x3884000 - 0x389bff7 +libjvmfwklo.dylib (0) <CA26B8C0-A485-8CD5-D064-41348A1A816C> /Applications/LibreOffice.app/Contents/ure-link/lib/libjvmfwklo.dylib 0x38a4000 - 0x3a51ff3 +libicui18n.dylib.53 (53.1) <78B1D567-93B3-1410-5501-D20998624560> /Applications/LibreOffice.app/Contents/MacOS/libicui18n.dylib.53 0x3b01000 - 0x3b04ffb +libjvmaccesslo.dylib (0) <007A2A85-186F-3A94-50CF-D31E3432141D> /Applications/LibreOffice.app/Contents/ure-link/lib/libjvmaccesslo.dylib 0x3b0b000 - 0x3b10ff7 +libAppleRemotelo.dylib (0) <27A49018-D23B-8746-FA21-00B0AC5CF933> /Applications/LibreOffice.app/Contents/MacOS/libAppleRemotelo.dylib 0x3b17000 - 0x3b51fef +libnspr4.dylib (1) <792BA822-C030-8A53-B209-C86954F6F68E> /Applications/LibreOffice.app/Contents/MacOS/libnspr4.dylib 0x3b79000 - 0x3cb1fe7 +libnss3.dylib (1) <EB25CEB3-C7BB-7E14-EB42-B96E2233B586> /Applications/LibreOffice.app/Contents/MacOS/libnss3.dylib 0x3d38000 - 0x3d5dfe7 +libsmime3.dylib (1) <06222364-3969-810B-2EA7-3821A8CAABA7> /Applications/LibreOffice.app/Contents/MacOS/libsmime3.dylib 0x3d7b000 - 0x3db9fe7 +liblcms2.2.dylib (3.6) <1775730D-BD5C-DB09-4D4A-55C23A07E18E> /Applications/LibreOffice.app/Contents/MacOS/liblcms2.2.dylib 0x3ddd000 - 0x3dfdfe7 +libnssutil3.dylib (1) <6794BEE7-DDAB-A248-DD1A-4F5658614DC0> /Applications/LibreOffice.app/Contents/MacOS/libnssutil3.dylib 0x3e18000 - 0x3e1efff +libplc4.dylib (1) <8222890E-90A2-2ACC-CB31-DC9E04A395FE> /Applications/LibreOffice.app/Contents/MacOS/libplc4.dylib 0x3e28000 - 0x3e2efff +libplds4.dylib (1) <5FC6610B-969F-6DFA-6785-6206931893E5> /Applications/LibreOffice.app/Contents/MacOS/libplds4.dylib 0x3e37000 - 0x3f4cff3 +libdrawinglayerlo.dylib (0) <F573D347-1A99-EB0B-7937-0930079550DF> /Applications/LibreOffice.app/Contents/MacOS/libdrawinglayerlo.dylib 0x3fd2000 - 0x4052ff7 +libfwelo.dylib (0) <682B4AFA-88A2-E22F-767E-3669C92489E5> /Applications/LibreOffice.app/Contents/MacOS/libfwelo.dylib 0x4096000 - 0x40aaff3 +libsaxlo.dylib (0) <3537877C-5F22-C2E0-F86A-7CD7D4DAFD1D> /Applications/LibreOffice.app/Contents/MacOS/libsaxlo.dylib 0x40b8000 - 0x40e8ffb +libcanvastoolslo.dylib (0) <C69A9C41-98A5-2664-E385-44776DF2B904> /Applications/LibreOffice.app/Contents/MacOS/libcanvastoolslo.dylib 0x4108000 - 0x415dfff +libcppcanvaslo.dylib (0) <35316B3D-C339-1A31-1FFA-CDBA5C1CA74B> /Applications/LibreOffice.app/Contents/MacOS/libcppcanvaslo.dylib 0x4180000 - 0x41aaff7 +libfwilo.dylib (0) <2C7D0093-C343-C4DC-4E95-D1E2D970E2F5> /Applications/LibreOffice.app/Contents/MacOS/libfwilo.dylib 0x9b07000 - 0x9b47ff3 com.apple.CloudDocs (1.0 - 262) <4B31F83F-3EC6-310F-AFFA-6626295657B6> /System/Library/PrivateFrameworks/CloudDocs.framework/CloudDocs 0xae3c000 - 0xae3cffb +cl_kernels (???) <18C8CD6C-3B3E-46B2-B4BB-ECD6A7913A0D> cl_kernels 0xae4b000 - 0xae4bff9 +cl_kernels (???) <6809B14A-52B7-408E-8917-1DFDB0537ADB> cl_kernels 0xae4d000 - 0xaf38ff7 unorm8_bgra.dylib (2.4.5) <158C8746-4F0B-3ACB-988A-80346F3E5D74> /System/Library/Frameworks/OpenCL.framework/Versions/A/Libraries/ImageFormats/unorm8_bgra.dylib0x8fe5d000 - 0x8fe90e03 dyld (353.2.1) <EBFF7998-58E8-32F5-BF0D-9690278EC792> /usr/lib/dyld0x90008000 - 0x9000dff7 libmacho.dylib (862) <994A4135-A10A-3E00-AD33-9BB4D59EE6DD> /usr/lib/system/libmacho.dylib0x9012f000 - 0x90131fff com.apple.loginsupport (1.0 - 1) <CC0571F3-68A7-3986-A0E4-36057DD2B796> /System/Library/PrivateFrameworks/login.framework/Versions/A/Frameworks/loginsupport.framework/Versions/A/loginsupport0x90132000 - 0x9018fff3 com.apple.print.framework.PrintCore (10.0 - 450) <396AFF1D-32DE-3FFC-AF36-1E525FCB112C> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/PrintCore.framework/Versions/A/PrintCore0x90190000 - 0x9019eff7 com.apple.SpeechRecognitionCore (2.0.28 - 2.0.28) <2C043721-D5FD-3A24-90E0-D5F6FAD4472D> /System/Library/PrivateFrameworks/SpeechRecognitionCore.framework/Versions/A/SpeechRecognitionCore0x9019f000 - 0x904eefff libmecabra.dylib (661) <1010C0D1-FC4D-3C7F-87B9-D8EEF2E23825> /usr/lib/libmecabra.dylib0x904ef000 - 0x904f7fff libsystem_pthread.dylib (105.1.4) <7A96DB53-5E28-304D-8CE4-760E65C5430D> /usr/lib/system/libsystem_pthread.dylib0x9052d000 - 0x90623ff7 libFontParser.dylib (130) <EBA8441C-5131-3D71-892D-4490548B1A32> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/Resources/libFontParser.dylib0x90624000 - 0x90677fff libstdc++.6.dylib (104.1) <D0EB2C99-5939-3ABA-9C18-D9AD75CE23A1> /usr/lib/libstdc++.6.dylib0x90678000 - 0x9067bfff libpam.2.dylib (20) <E2F34522-448A-3392-BC1D-6625BEB612B9> /usr/lib/libpam.2.dylib0x9067c000 - 0x906efffb com.apple.framework.CoreWLAN (5.0 - 500.29) <6DC23F60-69C0-3495-B539-C7C990F89AE1> /System/Library/Frameworks/CoreWLAN.framework/Versions/A/CoreWLAN0x906f0000 - 0x907bbfff com.apple.DiscRecording (9.0 - 9000.4.1) <820ED5C6-3B0A-33E0-B828-8DE5147A7131> /System/Library/Frameworks/DiscRecording.framework/Versions/A/DiscRecording0x907bc000 - 0x907c0ffb com.apple.TCC (1.0 - 1) <8536270E-C27A-36D6-AAFD-D46C0C49FC8F> /System/Library/PrivateFrameworks/TCC.framework/Versions/A/TCC0x908d4000 - 0x908e5ffb libsystem_coretls.dylib (35) <7BF5E19E-8083-3D63-AC0B-C58CD1B67FD9> /usr/lib/system/libsystem_coretls.dylib0x908e6000 - 0x9096dfff com.apple.CoreServices.OSServices (639 - 639) <740EA9BB-EBD7-3D0C-97A4-183B4779D813> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/OSServices.framework/Versions/A/OSServices0x9096e000 - 0x909b1fff libGLU.dylib (11.0.5) <5BE4EE86-4BBD-30A4-96BF-9B49B0A75BC0> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGLU.dylib0x909b2000 - 0x909b6ffb libcache.dylib (69) <1E85E459-FBEF-31E0-A237-EF4BE9D5D768> /usr/lib/system/libcache.dylib0x909b7000 - 0x90cb4ffb com.apple.CoreServices.CarbonCore (1105 - 1105) <AD965CC1-83E5-3EEC-81BF-7815E5E07DDD> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/CarbonCore.framework/Versions/A/CarbonCore0x90cb5000 - 0x90cc3ff7 libz.1.dylib (55) <DF3B8F77-8931-3A6B-8BDF-DB67315050E6> /usr/lib/libz.1.dylib0x90cc4000 - 0x90cc6ff3 com.apple.EFILogin (2.0 - 2) <40B1056B-2FCA-3DD1-AC19-8A7DB09F1757> /System/Library/PrivateFrameworks/EFILogin.framework/Versions/A/EFILogin0x90d02000 - 0x90d02fff com.apple.Cocoa (6.8 - 21) <6745A805-354F-3B26-9991-2C964D904256> /System/Library/Frameworks/Cocoa.framework/Versions/A/Cocoa0x90d03000 - 0x90d29ff7 com.apple.IconServices (45 - 45) <E7B742AA-1699-372D-9689-93A012142614> /System/Library/PrivateFrameworks/IconServices.framework/Versions/A/IconServices0x91cca000 - 0x91cd3fff libGFXShared.dylib (11.0.5) <23B88370-1E8E-34B5-9625-757409DD721F> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGFXShared.dylib0x92bb5000 - 0x92cabff7 libxml2.2.dylib (26) <2F37833C-4D55-3A09-9A0C-5904E8B6892A> /usr/lib/libxml2.2.dylib0x92cac000 - 0x92cebfff com.apple.NavigationServices (3.8 - 215.1) <2A4EB6F1-F9F3-3AA6-AF95-02611C72C35C> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/NavigationServices.framework/Versions/A/NavigationServices0x92cec000 - 0x92d09fff libCRFSuite.dylib (34) <781A92EF-410E-39B2-953D-FEE12748D834> /usr/lib/libCRFSuite.dylib0x92d0a000 - 0x92d12ff7 com.apple.icloud.FindMyDevice (1.0 - 1) <D851D4D4-1486-38CD-BE70-ED34A076B929> /System/Library/PrivateFrameworks/FindMyDevice.framework/Versions/A/FindMyDevice0x92d3e000 - 0x92d49fff com.apple.CrashReporterSupport (10.10 - 625) <0047B7D0-426F-39D2-BDDB-6F6562F51794> /System/Library/PrivateFrameworks/CrashReporterSupport.framework/Versions/A/CrashReporterSupport0x92ef9000 - 0x92efafff libremovefile.dylib (35) <CFB0212F-7005-3B0C-8243-527B32E2BF74> /usr/lib/system/libremovefile.dylib0x92efb000 - 0x92f0bfff libGL.dylib (11.0.5) <558A4D68-B8A4-34BF-B0A6-875D3B44B526> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib0x92f0c000 - 0x92f26ff7 liblzma.5.dylib (7) <D0BC984D-5B33-328C-8F1E-7E9C41813433> /usr/lib/liblzma.5.dylib0x92f27000 - 0x9306bff7 com.apple.ImageIO.framework (3.3.0 - 1038) <299FE5ED-6E8F-3D38-888C-509C12BCF9FE> /System/Library/Frameworks/ImageIO.framework/Versions/A/ImageIO0x930e3000 - 0x9320ffff com.apple.coreui (2.1 - 300) <6765132D-A0FD-34E7-845C-7AF21AFB91BD> /System/Library/PrivateFrameworks/CoreUI.framework/Versions/A/CoreUI0x93210000 - 0x9323cfff com.apple.ChunkingLibrary (2.1 - 163.1) <DC9EAEFB-8855-3131-A13C-99768C5394D2> /System/Library/PrivateFrameworks/ChunkingLibrary.framework/Versions/A/ChunkingLibrary0x9323d000 - 0x9326fff3 com.apple.GSS (4.0 - 2.0) <6E3ECA6A-8CEC-3D8A-A484-DCC4A7BEC314> /System/Library/Frameworks/GSS.framework/Versions/A/GSS0x93270000 - 0x93271fff liblangid.dylib (117) <34A0F807-755F-300B-B01F-AABAE3838451> /usr/lib/liblangid.dylib0x93272000 - 0x932e8ff7 com.apple.SearchKit (1.4.0 - 1.4.0) <B4BD4A0F-F6ED-37A0-AA73-9CAC84BCFF33> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/SearchKit.framework/Versions/A/SearchKit0x9332b000 - 0x9332dfff libquarantine.dylib (76) <BA2D935B-4B5C-355B-9BAE-0325624E39C0> /usr/lib/system/libquarantine.dylib0x9332e000 - 0x93334ff7 libsystem_trace.dylib (72.1.1.0.1) <05261F36-47FB-3288-9EAD-EA2A4D2F1CEB> /usr/lib/system/libsystem_trace.dylib0x93335000 - 0x9333efff libcopyfile.dylib (118.1.1) <6C56E539-FD5F-3F1C-8D4C-720AEA97E2FE> /usr/lib/system/libcopyfile.dylib0x9333f000 - 0x933bcff3 com.apple.framework.IOKit (2.0.2 - 1050.1.20) <42B5C125-BED8-387B-B22A-8C9255BE57A1> /System/Library/Frameworks/IOKit.framework/Versions/A/IOKit0x933bd000 - 0x9340efff libcups.2.dylib (404) <D7C5C50F-AB38-36D5-9CC4-B7378BB1CF68> /usr/lib/libcups.2.dylib0x9340f000 - 0x93436fff libdispatch.dylib (442.1.3) <4FFC29A5-45E8-30FB-8206-1D3318D9F20E> /usr/lib/system/libdispatch.dylib0x93437000 - 0x9343dff3 libsystem_platform.dylib (63) <0C034682-EF49-3188-AAE0-AA445872632C> /usr/lib/system/libsystem_platform.dylib0x9343e000 - 0x9344bfff com.apple.OpenDirectory (10.10 - 187) <AE61B41A-9228-3DF2-A750-B75405295C67> /System/Library/Frameworks/OpenDirectory.framework/Versions/A/OpenDirectory0x9344c000 - 0x93452ff7 libsystem_networkextension.dylib (167.1.9) <940A7B3A-3E69-3764-B6CD-ECF5BB18E090> /usr/lib/system/libsystem_networkextension.dylib0x93453000 - 0x93472ff7 com.apple.GenerationalStorage (2.0 - 209.8) <CF1C8A52-DB43-3C2F-8B23-9A61B685E33E> /System/Library/PrivateFrameworks/GenerationalStorage.framework/Versions/A/GenerationalStorage0x93473000 - 0x93499fff libxpc.dylib (559.1.7) <04256902-F7CD-36BD-8B7C-D954366DE149> /usr/lib/system/libxpc.dylib0x9349a000 - 0x9349cffb libRadiance.dylib (1230) <C9193F08-5AB9-3F48-96C3-3AC693C48FFE> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libRadiance.dylib0x9349d000 - 0x9349efff libDiagnosticMessagesClient.dylib (100) <3EE83437-AA9C-356B-810B-589346B73797> /usr/lib/libDiagnosticMessagesClient.dylib0x9349f000 - 0x934b1ff7 libsasl2.2.dylib (191) <150F11A4-9FFF-3D7D-906B-57D1BAC37FC2> /usr/lib/libsasl2.2.dylib0x934b2000 - 0x93737fff com.apple.QuickTime (7.7.3 - 2890) <93AEDD55-213D-3495-B9DD-348B269982B8> /System/Library/Frameworks/QuickTime.framework/Versions/A/QuickTime0x93738000 - 0x9383cff7 libJP2.dylib (1230) <64724906-45FF-39A0-A5FA-1AEE3B822CB5> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libJP2.dylib0x9383d000 - 0x9384aff7 libbz2.1.0.dylib (36) <6BC7B049-8F03-3217-9840-B1804CCBF742> /usr/lib/libbz2.1.0.dylib0x9384b000 - 0x938b4ff7 libcorecrypto.dylib (233.1.2) <353B7C76-DCDC-3414-AA92-0AB9CA74376A> /usr/lib/system/libcorecrypto.dylib0x938b5000 - 0x93903ff7 libcurl.4.dylib (83.1.1) <46C49D27-5E3E-3CD7-9921-16F1BFFCFA7F> /usr/lib/libcurl.4.dylib0x9396a000 - 0x939e4fff com.apple.ApplicationServices.ATS (360 - 373) <55F10232-89FE-317E-8989-0630635F0121> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/ATS0x939e5000 - 0x93a5bfff com.apple.securityfoundation (6.0 - 55125) <8A9A2603-5610-3D99-8F42-C75CAC57092D> /System/Library/Frameworks/SecurityFoundation.framework/Versions/A/SecurityFoundation0x93a5c000 - 0x93a68ff3 libcommonCrypto.dylib (60061) <19665E39-1C4A-3B7B-AB33-B808E00F97FE> /usr/lib/system/libcommonCrypto.dylib0x93a69000 - 0x93ab2fff libFontRegistry.dylib (133) <83673E22-238D-3513-B62A-FA025DF9A152> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/Resources/libFontRegistry.dylib0x93ab3000 - 0x93aceff7 com.apple.CFOpenDirectory (10.10 - 187) <F2FD6A1A-5AAB-31CE-AB42-EEF694C39138> /System/Library/Frameworks/OpenDirectory.framework/Versions/A/Frameworks/CFOpenDirectory.framework/Versions/A/CFOpenDirectory0x93acf000 - 0x93b09fff com.apple.LDAPFramework (2.4.28 - 194.5) <B58B0F39-A7C0-3A7C-B606-9065CA1ED1AA> /System/Library/Frameworks/LDAP.framework/Versions/A/LDAP0x93b10000 - 0x93c22ff7 com.apple.CoreText (352.0 - 450) <3EBCEE3F-03E0-381F-9731-66F21D00DC11> /System/Library/Frameworks/CoreText.framework/Versions/A/CoreText0x93f3b000 - 0x93f3cfff com.apple.TrustEvaluationAgent (2.0 - 25) <28BBD931-EF7C-3753-B50E-6568F4075086> /System/Library/PrivateFrameworks/TrustEvaluationAgent.framework/Versions/A/TrustEvaluationAgent0x942c0000 - 0x942c0fff liblaunch.dylib (559.1.7) <03822C2F-8F48-34A8-AF57-7D5FE05CA297> /usr/lib/system/liblaunch.dylib0x942c1000 - 0x94361fff com.apple.QD (3.48 - 300) <4A32A4F5-48A4-3749-B3F7-8224FA917422> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/QD.framework/Versions/A/QD0x94362000 - 0x9438bfff libRIP.A.dylib (754.1) <FFCD387A-7D94-3F76-9C8A-41A8E7DE0727> /System/Library/Frameworks/CoreGraphics.framework/Versions/A/Resources/libRIP.A.dylib0x9438c000 - 0x943b2ffb libPng.dylib (1230) <74ED7B1A-B8D0-363D-BC9C-2E74C81896A1> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libPng.dylib0x943b3000 - 0x94576ff7 com.apple.QuartzCore (1.10 - 361.3) <AFD0E87B-053E-35E1-86E1-B191A3661B1A> /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore0x94577000 - 0x945f5fff com.apple.SystemConfiguration (1.14 - 1.14) <95045A74-D520-38FA-BCFC-96AFAA4EB4B6> /System/Library/Frameworks/SystemConfiguration.framework/Versions/A/SystemConfiguration0x945f6000 - 0x94662fff com.apple.datadetectorscore (5.0 - 396) <B83917F8-5FFE-3071-AE76-0021C52C4962> /System/Library/PrivateFrameworks/DataDetectorsCore.framework/Versions/A/DataDetectorsCore0x946b7000 - 0x946c5ff3 libxar.1.dylib (254) <D7C4FDEB-61AA-3FC1-8B7B-0AE3A3A64492> /usr/lib/libxar.1.dylib0x946ca000 - 0x946defff com.apple.ImageCapture (9.0 - 9.0) <23F1303A-F93B-3BBE-A6DC-931DB680C25C> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/ImageCapture.framework/Versions/A/ImageCapture0x946df000 - 0x946e1fff libsystem_configuration.dylib (699.1.4) <488307B9-01E5-39B2-8847-B49C4F39E446> /usr/lib/system/libsystem_configuration.dylib0x946e2000 - 0x94733fff com.apple.opencl (2.4.2 - 2.4.2) <E05E503B-BB20-342A-81ED-5EA8087C9B60> /System/Library/Frameworks/OpenCL.framework/Versions/A/OpenCL0x94734000 - 0x9473aff7 com.apple.speech.recognition.framework (5.0.6 - 5.0.6) <EFEAE767-AA42-306F-B35C-F0341EABFA51> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/SpeechRecognition.framework/Versions/A/SpeechRecognition0x948b1000 - 0x948ebff7 com.apple.DebugSymbols (115 - 115) <8B1A8310-EC15-3174-913D-42B892685A5C> /System/Library/PrivateFrameworks/DebugSymbols.framework/Versions/A/DebugSymbols0x948ec000 - 0x948f4fff libsystem_dnssd.dylib (561) <12EEB90B-82E8-3903-B622-FF7C8BCCDDBB> /usr/lib/system/libsystem_dnssd.dylib0x94d9f000 - 0x94da7feb libcldcpuengine.dylib (2.4.5) <C918FDAE-3462-3EC3-9E0F-8A21125A3302> /System/Library/Frameworks/OpenCL.framework/Versions/A/Libraries/libcldcpuengine.dylib0x94dc0000 - 0x94dc9ff7 libsystem_notify.dylib (133.1.1) <16BC7F5B-F438-33EF-9068-99078948AA68> /usr/lib/system/libsystem_notify.dylib0x956d8000 - 0x956ebfff libcmph.dylib (1) <2449B048-208E-36FB-9DFA-47E0F3BCF132> /usr/lib/libcmph.dylib0x956ec000 - 0x9572cfff com.apple.Symbolication (1.4 - 56045) <0661B60C-1ECF-3FA3-A541-6BF0569D43A2> /System/Library/PrivateFrameworks/Symbolication.framework/Versions/A/Symbolication0x9572d000 - 0x9574affb com.apple.Ubiquity (1.3 - 313) <056AF605-B3B8-3897-A2FB-5289C8DE41E3> /System/Library/PrivateFrameworks/Ubiquity.framework/Versions/A/Ubiquity0x9574b000 - 0x95834fff libcrypto.0.9.8.dylib (52) <BF7474C8-46E4-3694-B94A-738076734B79> /usr/lib/libcrypto.0.9.8.dylib0x95835000 - 0x9588bfff libc++.1.dylib (120) <D8DE4962-66CD-3491-904E-9291EEE5E570> /usr/lib/libc++.1.dylib0x9588c000 - 0x9589dfff libbsm.0.dylib (34) <C9F0C608-2794-3F6B-8078-583FC0046039> /usr/lib/libbsm.0.dylib0x958a6000 - 0x958d9fff com.apple.CoreServicesInternal (221 - 221) <DE28C5A5-92B8-3616-BB54-65EDF437047F> /System/Library/PrivateFrameworks/CoreServicesInternal.framework/Versions/A/CoreServicesInternal0x95a62000 - 0x95c58fff libicucore.A.dylib (531.26) <A460D460-1C54-3743-ADF6-EAF1C2544DD8> /usr/lib/libicucore.A.dylib0x95c59000 - 0x95c5cfff libdyld.dylib (353.2.1) <0F834F1E-55D9-3D9B-9733-BBF49C6472FA> /usr/lib/system/libdyld.dylib0x95c5d000 - 0x95c86ff7 libsystem_info.dylib (459) <FEC32E6C-F6B0-34D6-8126-DDA2CC980722> /usr/lib/system/libsystem_info.dylib0x95d0f000 - 0x95d22ff7 com.apple.ProtectedCloudStorage (1.0 - 1) <CCC4EF12-DF4B-36FA-A566-B832C6E18B6C> /System/Library/PrivateFrameworks/ProtectedCloudStorage.framework/Versions/A/ProtectedCloudStorage0x95d23000 - 0x95d23fff com.apple.CoreServices (62 - 62) <51E95B8E-1F5D-39CF-B1F8-2E0CFF3F8501> /System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices0x95d31000 - 0x95d35fff libCoreVMClient.dylib (79) <85CBF1F3-3CE1-304F-88DF-15608C9A2367> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libCoreVMClient.dylib0x95d36000 - 0x95d36fff libOpenScriptingUtil.dylib (162) <D471EF1A-C045-3034-B2DA-0D1349B79925> /usr/lib/libOpenScriptingUtil.dylib0x95d37000 - 0x95d3fffb com.apple.NetFS (6.0 - 4.0) <BE9098D6-D631-3CBA-AD4C-F3621D849AF8> /System/Library/Frameworks/NetFS.framework/Versions/A/NetFS0x95d40000 - 0x95d9bfff com.apple.LanguageModeling (1.0 - 1) <5A3209C8-037B-3FDE-A90B-66DB622DE801> /System/Library/PrivateFrameworks/LanguageModeling.framework/Versions/A/LanguageModeling0x95d9c000 - 0x95e39fff com.apple.ink.framework (10.9 - 213) <07522A36-9EE2-352B-89D2-EA922FBE6C31> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Ink.framework/Versions/A/Ink0x95e9c000 - 0x95eabff3 com.apple.opengl (11.0.5 - 11.0.5) <3AE5E3C7-4181-37DF-9755-EA70CE9A3C48> /System/Library/Frameworks/OpenGL.framework/Versions/A/OpenGL0x95eac000 - 0x95ecbfff libsystem_kernel.dylib (2782.1.80) <52BAA39C-12FC-3BF6-9C73-D6967645362F> /usr/lib/system/libsystem_kernel.dylib0x95ecc000 - 0x95f13ff3 com.apple.AppleJPEG (1.0 - 1) <2C0FADB1-D166-3320-8C48-03271A7C3457> /System/Library/PrivateFrameworks/AppleJPEG.framework/Versions/A/AppleJPEG0x95f14000 - 0x9602bff3 com.apple.desktopservices (1.9 - 1.9) <98FCEDFE-DEC9-331B-AB31-43AC155D2D30> /System/Library/PrivateFrameworks/DesktopServicesPriv.framework/Versions/A/DesktopServicesPriv0x96059000 - 0x9618bffb com.apple.UIFoundation (1.0 - 1) <8988B1F1-2CCC-39D5-A37D-D34A295525BE> /System/Library/PrivateFrameworks/UIFoundation.framework/Versions/A/UIFoundation0x96194000 - 0x96198fff com.apple.CommonPanels (1.2.6 - 96) <2CBDC939-8E09-30D1-B4F8-22868993B988> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/CommonPanels.framework/Versions/A/CommonPanels0x96199000 - 0x961b8ffb libresolv.9.dylib (57) <C2C3810A-A45E-3375-B41D-6E1BECE1BA3C> /usr/lib/libresolv.9.dylib0x9636a000 - 0x9639effb com.apple.frameworks.CoreDaemon (1.3 - 1.3) <EEA082B1-9C22-384A-8587-2E9813CF2DB5> /System/Library/PrivateFrameworks/CoreDaemon.framework/Versions/B/CoreDaemon0x9639f000 - 0x963cefff com.apple.CoreVideo (1.8 - 145.0) <5822134F-3114-39EE-97F8-0F0F5A24DD16> /System/Library/Frameworks/CoreVideo.framework/Versions/A/CoreVideo0x963cf000 - 0x963dbff7 libcsfde.dylib (468) <DBB1DEB1-26CD-32C0-BB80-054D45A2B050> /usr/lib/libcsfde.dylib0x963dc000 - 0x963ffffb com.apple.framework.Apple80211 (10.0 - 1000.47) <2D8F9EAB-5C86-36FC-8F48-DBB22B5A0A9F> /System/Library/PrivateFrameworks/Apple80211.framework/Versions/A/Apple802110x96400000 - 0x96403fff com.apple.xpc.ServiceManagement (1.0 - 1) <15AD8E1F-073B-3B2F-A0A7-955EE30A6F06> /System/Library/Frameworks/ServiceManagement.framework/Versions/A/ServiceManagement0x96404000 - 0x96fdbffb com.apple.AppKit (6.9 - 1331.12) <4E68D16B-713C-37FD-8BD6-199D2772A7B0> /System/Library/Frameworks/AppKit.framework/Versions/C/AppKit0x96fe8000 - 0x970d4fe7 libvMisc.dylib (512) <56B7DE45-36B1-32BE-B823-DB14F315EEB9> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libvMisc.dylib0x970d5000 - 0x971d2ff7 com.apple.LaunchServices (641.1.2 - 641.1.2) <F15AE779-AA0B-3D1E-92C8-BDAF555AA0A9> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/LaunchServices.framework/Versions/A/LaunchServices0x971d3000 - 0x97213fff libauto.dylib (186) <1609D0F9-6E3A-3C67-87EF-BB0BD93EDAC9> /usr/lib/libauto.dylib0x97214000 - 0x97218fff libheimdal-asn1.dylib (398) <2E5C5B4B-6CFF-3AE7-B5B7-84F834D5348A> /usr/lib/libheimdal-asn1.dylib0x97219000 - 0x97222ffb com.apple.CommonAuth (4.0 - 2.0) <5C8CFDF2-6932-3AC0-87CC-500E915710FA> /System/Library/PrivateFrameworks/CommonAuth.framework/Versions/A/CommonAuth0x975e3000 - 0x975ebfff com.apple.CoreServices.FSEvents (1210 - 1210) <0CF2ED08-0972-3E32-8268-E944E6EAAF53> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/FSEvents.framework/Versions/A/FSEvents0x976f9000 - 0x976fcff7 com.apple.help (1.3.3 - 46) <B7E4F49A-9442-3107-9320-42E7878F02B1> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Help.framework/Versions/A/Help0x976fd000 - 0x97708ff7 com.apple.NetAuth (5.0 - 5.0) <1667582F-656C-323B-894A-E408B70E6A9F> /System/Library/PrivateFrameworks/NetAuth.framework/Versions/A/NetAuth0x97709000 - 0x9779bfff com.apple.CoreSymbolication (3.1 - 56072) <DA781DE3-0D1E-3893-9571-7F7A778CFD73> /System/Library/PrivateFrameworks/CoreSymbolication.framework/Versions/A/CoreSymbolication0x9779c000 - 0x97a2eff7 com.apple.CoreData (110 - 522) <2236DD75-E2DA-3937-A528-1E761A4241A2> /System/Library/Frameworks/CoreData.framework/Versions/A/CoreData0x97a2f000 - 0x97a5dff7 libarchive.2.dylib (30) <9505A3D3-CE6E-3D45-B22E-DBC923A933B8> /usr/lib/libarchive.2.dylib0x97a5e000 - 0x97ab9ffb libTIFF.dylib (1230) <03927ED0-F4AD-37B1-82FE-EE10977A2867> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libTIFF.dylib0x97aba000 - 0x97b0dff7 com.apple.HIServices (1.22 - 516) <66314CBC-D6EE-37E7-A667-2B3C4D3DFE35> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/HIServices.framework/Versions/A/HIServices0x97b0e000 - 0x97b25fff libsystem_asl.dylib (267) <61F3AE18-A118-38F3-A1A9-353D38532F25> /usr/lib/system/libsystem_asl.dylib0x97b26000 - 0x97b62ff3 com.apple.RemoteViewServices (2.0 - 99) <44A7D91E-80AA-3191-90A3-6C3CC66A8658> /System/Library/PrivateFrameworks/RemoteViewServices.framework/Versions/A/RemoteViewServices0x97b63000 - 0x97c6ffe3 libvDSP.dylib (512) <46C25529-ACD8-3929-B6F0-6AEE80DAF14D> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libvDSP.dylib0x97c70000 - 0x97c72ff7 libsystem_sandbox.dylib (358.1.1) <7C2B1D4A-17B0-3785-8498-C65B827246F7> /usr/lib/system/libsystem_sandbox.dylib0x97c73000 - 0x97c77ffb libGIF.dylib (1230) <C5A7F653-02E4-3022-96E5-CE822D751DAE> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libGIF.dylib0x97c78000 - 0x97f67ff7 com.apple.CoreImage (10.0.30) <93B04FDA-6E66-3A9B-9AC6-36F4D187A336> /System/Library/Frameworks/QuartzCore.framework/Versions/A/Frameworks/CoreImage.framework/Versions/A/CoreImage0x97f68000 - 0x97f83ff3 com.apple.openscripting (1.4 - 162) <950F79B1-F756-34AA-B8B1-3BEE27ADD7D3> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/OpenScripting.framework/Versions/A/OpenScripting0x97fb2000 - 0x98091fff com.apple.backup.framework (1.6 - 1.6) <6B1DBBB9-FEC7-3E4E-9953-00FB1D81E20F> /System/Library/PrivateFrameworks/Backup.framework/Versions/A/Backup0x98092000 - 0x9809bfff com.apple.AppleSRP (5.0 - 1) <41C48FA8-C249-3800-A551-7F4AFA3E723F> /System/Library/PrivateFrameworks/AppleSRP.framework/Versions/A/AppleSRP0x9809c000 - 0x980f1ff7 com.apple.audio.CoreAudio (4.3.0 - 4.3.0) <E1E94237-02EF-34B2-AB7F-0AE821F6CB7B> /System/Library/Frameworks/CoreAudio.framework/Versions/A/CoreAudio0x980f2000 - 0x98104fff com.apple.Sharing (316 - 316) <EAACB397-0173-31F6-9EAA-222E8A4CBC5B> /System/Library/PrivateFrameworks/Sharing.framework/Versions/A/Sharing0x98105000 - 0x984b7fff com.apple.CoreFoundation (6.9 - 1150.11) <18DF9262-BEAB-3F3B-A378-CF7D85B3FB28> /System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation0x984b8000 - 0x984bafff com.apple.securityhi (9.0 - 55005) <057C189F-D972-351D-B735-B1B421F0E1E6> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/SecurityHI.framework/Versions/A/SecurityHI0x984bb000 - 0x98641fff libsqlite3.dylib (164) <F3B4BDB1-E1B4-39C6-A93E-D9BC6A3BAF57> /usr/lib/libsqlite3.dylib0x98642000 - 0x98675fe3 libsystem_m.dylib (3086.1) <37982713-2BC5-36FD-9923-6056A2416620> /usr/lib/system/libsystem_m.dylib0x98676000 - 0x98767ffb libiconv.2.dylib (42) <4AF77F10-0BEC-3BE0-99DF-C5170EDB316B> /usr/lib/libiconv.2.dylib0x98768000 - 0x987f4ff3 com.apple.PerformanceAnalysis (1.0 - 1) <D5F5C1F1-E880-3725-AA3A-346AD7042796> /System/Library/PrivateFrameworks/PerformanceAnalysis.framework/Versions/A/PerformanceAnalysis0x987f5000 - 0x98808fff com.apple.CoreBluetooth (1.0 - 1) <2216AB08-4749-3BC8-8BAD-4B3178C902FC> /System/Library/Frameworks/CoreBluetooth.framework/Versions/A/CoreBluetooth0x98809000 - 0x98815ff7 com.apple.speech.synthesis.framework (5.2.1 - 5.2.1) <8302974A-5C6D-3A8C-871F-FFACECADD27A> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/SpeechSynthesis.framework/Versions/A/SpeechSynthesis0x98816000 - 0x988bbfff com.apple.Metadata (10.7.0 - 899) <07D04AC5-659B-34D5-A21C-CFD82ED7DD6F> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/Metadata.framework/Versions/A/Metadata0x988bc000 - 0x988e6fff libxslt.1.dylib (13) <0F55B64A-6C55-304E-ACE0-B531027AA066> /usr/lib/libxslt.1.dylib0x988e7000 - 0x988f3ff7 libkxld.dylib (2782.1.80) <C247D987-910B-3457-9157-1E8C569F5183> /usr/lib/system/libkxld.dylib0x988f4000 - 0x988f4fff libkeymgr.dylib (28) <1CEB82CD-2F94-3FD7-B31A-A229618EB430> /usr/lib/system/libkeymgr.dylib0x988f5000 - 0x98ccaff7 com.apple.HIToolbox (2.1.1 - 747) <23D0D5E8-464F-3116-9260-2C90A02F2317> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/HIToolbox.framework/Versions/A/HIToolbox0x98ccb000 - 0x98cf9fff com.apple.DictionaryServices (1.2 - 227) <7E75AF7E-7223-329D-A33B-8C9B23890418> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/DictionaryServices.framework/Versions/A/DictionaryServices0x98d01000 - 0x98d03ffb libCGXType.A.dylib (754.1) <91D4F442-2FFB-3C65-9466-A4ACC7250DE2> /System/Library/Frameworks/CoreGraphics.framework/Versions/A/Resources/libCGXType.A.dylib0x98da6000 - 0x98da8fff libCVMSPluginSupport.dylib (11.0.5) <8453DB16-BB2D-32D7-BD58-6EC202907A48> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libCVMSPluginSupport.dylib0x98db2000 - 0x98db2fff com.apple.audio.units.AudioUnit (1.12 - 1.12) <7ED04704-DD04-346A-ABAC-98FC2B128932> /System/Library/Frameworks/AudioUnit.framework/Versions/A/AudioUnit0x98db3000 - 0x9904cfff com.apple.RawCamera.bundle (6.00 - 754) <AC102D5B-8B4C-3AA3-94CB-A264F9F11E07> /System/Library/CoreServices/RawCamera.bundle/Contents/MacOS/RawCamera0x9904d000 - 0x99052fff com.apple.print.framework.Print (10.0 - 265) <568A1B1C-810D-3647-90EC-33F0FD691960> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Print.framework/Versions/A/Print0x99053000 - 0x990e8ff3 libsystem_c.dylib (1044.1.1) <DCE7F6D7-21DE-3FC2-A051-40CB4E4F0832> /usr/lib/system/libsystem_c.dylib0x990e9000 - 0x990e9fff com.apple.Accelerate.vecLib (3.10 - vecLib 3.10) <96675103-6E3D-326A-83C0-82D3A34C3A1A> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/vecLib0x990ea000 - 0x99525fd7 com.apple.vImage (8.0 - 8.0) <AE6DA57E-3C8E-39EC-869F-1C2EF6AC4376> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vImage.framework/Versions/A/vImage0x99526000 - 0x99529fff libextension.dylib (50) <B94A01F4-DDD9-33BD-B07E-610D1500F917> /usr/lib/libextension.dylib0x9952a000 - 0x996b5ffb com.apple.audio.toolbox.AudioToolbox (1.12 - 1.12) <D5332121-FC40-37C2-BEB0-878C847319F7> /System/Library/Frameworks/AudioToolbox.framework/Versions/A/AudioToolbox0x996b6000 - 0x996b7fff libSystem.B.dylib (1213) <1A292FD8-3AC9-3E87-A7C0-88A7E4219392> /usr/lib/libSystem.B.dylib0x997c7000 - 0x997cfff7 libCGCMS.A.dylib (754.1) <E531AEDC-A85A-3774-BB90-F647A42B333E> /System/Library/Frameworks/CoreGraphics.framework/Versions/A/Resources/libCGCMS.A.dylib0x997d0000 - 0x9980afff com.apple.MediaKit (16 - 756) <0CAB9818-18A7-31DE-BC63-FD07EB753208> /System/Library/PrivateFrameworks/MediaKit.framework/Versions/A/MediaKit0x9980b000 - 0x99c01fff com.apple.CoreGraphics (1.600.0 - 754.1) <54252926-6E76-3880-A4D6-03EFC8F333F4> /System/Library/Frameworks/CoreGraphics.framework/Versions/A/CoreGraphics0x99c02000 - 0x99dde2ef libobjc.A.dylib (646) <EF789AF0-508F-3D49-A988-376CE2E1107C> /usr/lib/libobjc.A.dylib0x99ddf000 - 0x99e53ff3 com.apple.Heimdal (4.0 - 2.0) <F0012CD1-F49D-3259-89D0-E15C2B50B308> /System/Library/PrivateFrameworks/Heimdal.framework/Versions/A/Heimdal0x99e54000 - 0x99e6dfff com.apple.Kerberos (3.0 - 1) <7950EB36-BEBA-3CC5-A9DF-E49B0EB3AE56> /System/Library/Frameworks/Kerberos.framework/Versions/A/Kerberos0x99e6e000 - 0x99e70fff libsystem_coreservices.dylib (9) <E029A4DF-F588-314D-82B4-13FE48518831> /usr/lib/system/libsystem_coreservices.dylib0x99e71000 - 0x99ec6ff7 com.apple.htmlrendering (77 - 1.1.4) <79359AB7-86A6-3356-9604-73955F47B36D> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/HTMLRendering.framework/Versions/A/HTMLRendering0x99ec7000 - 0x99ec7fff com.apple.Accelerate (1.10 - Accelerate 1.10) <7AD2A383-63B9-3FA8-BBEF-DCBCF0D01F6C> /System/Library/Frameworks/Accelerate.framework/Versions/A/Accelerate0x99ec8000 - 0x99f2cffb com.apple.AE (680 - 680) <74735E5D-B505-3D5E-9790-27F2841285BC> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/AE.framework/Versions/A/AE0x99f2d000 - 0x99f44ff3 libLinearAlgebra.dylib (1128) <B20FAAAA-1C76-3B20-B100-5FC90F7FE023> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libLinearAlgebra.dylib0x99f45000 - 0x99f82ff7 libsystem_network.dylib (408) <E8B7CA94-7DED-39FE-8C28-74EB1020B65F> /usr/lib/system/libsystem_network.dylib0x99f83000 - 0x99fc3ffb libGLImage.dylib (11.0.5) <A1A10306-7EF0-38E7-BD0D-D7CC58E14F6E> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGLImage.dylib0x99fc4000 - 0x9a3f7ff3 com.apple.vision.FaceCore (3.1.6 - 3.1.6) <11BD7F81-AEF5-30AF-BF0B-3095B18D299C> /System/Library/PrivateFrameworks/FaceCore.framework/Versions/A/FaceCore0x9ada7000 - 0x9ada8fff libunc.dylib (28) <F36FBA4E-BA5F-3E1F-9AF0-9BCA53BC8D06> /usr/lib/system/libunc.dylib0x9ae57000 - 0x9ae5eff3 libunwind.dylib (35.3) <38BC2EF3-BD2C-36E9-9F78-2039E7999162> /usr/lib/system/libunwind.dylib0x9aed0000 - 0x9aef6ff3 libc++abi.dylib (125) <E9AF8CA1-D54D-37E3-8363-A3E8C0840F71> /usr/lib/libc++abi.dylib0x9aef7000 - 0x9af1afff libJPEG.dylib (1230) <50D8776B-A29A-3546-92FE-5F383AE1B9ED> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libJPEG.dylib0x9af1b000 - 0x9af28ff7 com.apple.ProtocolBuffer (1 - 225.1) <660D68A0-00F9-326C-8EBD-CE3A6A911882> /System/Library/PrivateFrameworks/ProtocolBuffer.framework/Versions/A/ProtocolBuffer0x9af29000 - 0x9af33ffb com.apple.audio.SoundManager (4.2 - 4.2) <EF1A1C69-1CB9-3FC9-8EDA-0D3F90438EC7> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/CarbonSound.framework/Versions/A/CarbonSound0x9af34000 - 0x9b024ff3 com.apple.DiskImagesFramework (10.10 - 389) <58B79B83-8C4B-3C9A-97FB-48E75EC4224A> /System/Library/PrivateFrameworks/DiskImages.framework/Versions/A/DiskImages0x9b025000 - 0x9b0d4ff3 com.apple.Bluetooth (4.3.0 - 4.3.0b13) <DB36334E-7405-3498-AB9C-E609F8A40621> /System/Library/Frameworks/IOBluetooth.framework/Versions/A/IOBluetooth0x9b0d5000 - 0x9b0e5ff7 com.apple.LangAnalysis (1.7.0 - 1.7.0) <D6F05FB2-CD47-3A9A-B9B2-E110BE33F831> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/LangAnalysis.framework/Versions/A/LangAnalysis0x9b0e6000 - 0x9b0e6fff com.apple.Carbon (154 - 157) <CCAEDF74-3B62-332A-B18F-2E390DE4E407> /System/Library/Frameworks/Carbon.framework/Versions/A/Carbon0x9b0e7000 - 0x9b181fff com.apple.ColorSync (4.9.0 - 4.9.0) <E89E51C8-19D7-39BB-8921-8ABE656BD2D1> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ColorSync.framework/Versions/A/ColorSync0x9b182000 - 0x9b56aff7 libLAPACK.dylib (1128) <4E3D1289-2C98-3E53-BB8D-AD911357FF66> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libLAPACK.dylib0x9b59d000 - 0x9b70effb libBLAS.dylib (1128) <ACEF468C-5DB1-38F3-BCB2-6F3D7F2B2040> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib0x9b70f000 - 0x9b987ffb com.apple.security (7.0 - 55406) <41073BCD-8602-393A-B426-AA7EBC7A4971> /System/Library/Frameworks/Security.framework/Versions/A/Security0x9b98b000 - 0x9b9a4ffb libsystem_malloc.dylib (53) <3E21B30B-77EF-3143-9625-40555D35375C> /usr/lib/system/libsystem_malloc.dylib0x9b9a5000 - 0x9ba57fff libCoreStorage.dylib (468) <4434DDD3-B282-3F45-B4AB-AF0244F4DE26> /usr/lib/libCoreStorage.dylib0x9ba58000 - 0x9ba5affb libsystem_secinit.dylib (18) <A31E4E98-B2A5-33FB-AC06-5F62D3713920> /usr/lib/system/libsystem_secinit.dylib0x9ba7e000 - 0x9bc80ffb com.apple.CFNetwork (714 - 714) <9FD8415C-2F58-3124-94E9-57B03F6E9E94> /System/Library/Frameworks/CFNetwork.framework/Versions/A/CFNetwork0x9bc81000 - 0x9bc96ffb com.apple.MultitouchSupport.framework (260.29 - 260.29) <FC591B47-058C-3CD5-9032-32B704E8FC34> /System/Library/PrivateFrameworks/MultitouchSupport.framework/Versions/A/MultitouchSupport0x9bc97000 - 0x9bc97fff com.apple.ApplicationServices (48 - 48) <D3F49C7F-BE74-3C6B-9306-502E7F3ACB78> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/ApplicationServices0x9bc98000 - 0x9bca1fff com.apple.DiskArbitration (2.6 - 2.6) <2CC468C1-625A-3BC6-8271-DAC70263CD02> /System/Library/Frameworks/DiskArbitration.framework/Versions/A/DiskArbitration0x9bf2a000 - 0x9bf2fff7 libcompiler_rt.dylib (35) <0D0E826D-BC15-3E80-BF58-0E6ECE919C2D> /usr/lib/system/libcompiler_rt.dylib0x9bf30000 - 0x9c28effb com.apple.Foundation (6.9 - 1150.12) <5BD65BE4-18A3-336A-95C5-E1AF0568C0DF> /System/Library/Frameworks/Foundation.framework/Versions/C/Foundation0x9c28f000 - 0x9c2faff7 com.apple.framework.CoreWiFi (3.0 - 300.3) <F0D5E81B-E0E2-3BD1-916D-741F2B51EC97> /System/Library/Frameworks/CoreWiFi.framework/Versions/A/CoreWiFi0x9c2fb000 - 0x9c2ffffb com.apple.IOSurface (97 - 97) <7283FBC9-CD72-3367-A59A-E2FFFDFF0334> /System/Library/Frameworks/IOSurface.framework/Versions/A/IOSurface0x9c318000 - 0x9c319fff libsystem_blocks.dylib (65) <4EADAA33-46FC-3A88-949F-406F7095DD4C> /usr/lib/system/libsystem_blocks.dylib0x9c31a000 - 0x9c31dffb libutil.dylib (38) <B5A16C6B-A79E-3504-BDA6-64A063F6612D> /usr/lib/libutil.dylibExternal Modification Summary: Calls made by other processes targeting this process: task_for_pid: 1 thread_create: 0 thread_set_state: 0 Calls made by this process: task_for_pid: 0 thread_create: 0 thread_set_state: 0 Calls made by all processes on this machine: task_for_pid: 197611 thread_create: 0 thread_set_state: 0VM Region Summary:ReadOnly portion of Libraries: Total=218.8M resident=35.7M(16%) swapped_out_or_unallocated=183.1M(84%)Writable regions: Total=93.3M written=4032K(4%) resident=5968K(6%) swapped_out=4K(0%) unallocated=87.5M(94%) REGION TYPE VIRTUAL=========== =======CG backing stores 336KCG image 8KCG shared images 208KKernel Alloc Once 4KMALLOC 62.1MMALLOC (admin) 48KOpenCL 16KStack 68.6MVM_ALLOCATE 17.5M__DATA 8308K__IMAGE 528K__LINKEDIT 54.7M__OBJC 2288K__TEXT 164.1M__UNICODE 544Kmapped file 152.3Mshared memory 4K=========== =======TOTAL 531.3MFWIW the apple debug spitout is pretty much useless for debugging purposes. If you could debug this way:that would provide actually useful info. Thanks!The Mac crash report does not have any more information than what is already listed. If you have some other way to Trap the crash I will be more than glad to help.Ken GreerCreatedCrash logReporting as per the web linkWhere it is crashing is when I try and open An ODT document, where as if I open from applications it starts.Well, it is now crashing while opening the app, the only way to get it up & running is to use Reopen sending the log to appleTor: Considering the bt, I found this part:425 -(void)screenParametersChanged: (NSNotification*) pNotification 426 { 427 (void)pNotification; 428 YIELD_GUARD; 429 430 SalData* pSalData = GetSalData(); 431 std::list< AquaSalFrame* >::iterator it; 432 for( it = pSalData->maFrames.begin(); it != pSalData->maFrames.end(); ++it ) 433 { 434 (*it)->screenParametersChanged(); 435 } 436 }Shouldn't we check if maFrames may be empty? (like)Ken: To know if it could be a regression, was a former LO version work on your Mac? If yes which one?Also, you must know that sometimes a crash can be due to accessibility components so I'll quote Roman's (put in cc) questionnaire."1) Do you have any accesibility features enabled? Apple’s accessibilityfeatures like “VoiceOver” or “Enable access for assistive devices”, which getenabled in “System Preferences > Universal Access”, are known to cause many crashes and freezes in LibreOffice. So please try to disable any accesibility features, then check if the problem is still reproducible.2) Do you have installed any window management/user interface utilities/apps/control panels/extensions for Mac OS X like * AquaSnap * BetterSnapTool * BetterTouchTool * Breeze * Cinch * Divvy * DoublePane * Flexiglass * HyperDock * iSnap * Moom * RightZoom * ShiftIt * SizeUp * SizeWell * Spectacle * Stay * TileWindows * WindowTidy * Flavours (from flavours.interacto.net)... or something similar?And/or do you use any mouse cursor/pointer utility, i.e. some little application or control panel etc. which animates or replaces etc. the mouse curser/pointer, like * LazyMouse?And/or do you use any special software which could be related to accessibility stuff, e.g. a screen reader, screen magnifier, speech recognition software,a text-to-speech (dictation) application, or similar?All these and many similar utilities rely heavily on Mac OS accessibility features and therefore can cause LibreOffice to crash or freeze. So please check if you have installed any utility of this kind and try to disable it(or to add LibreOffice to the list of excluded applications for the utility,if there is such a thing).So please check these possibilities, if any of them helps to make the crash go away, and report the results here."CreatedCrash report with 4.2.61: Do not have any actability installed or turned on2: I have not installed and windoz management apps3: no different mouse pointer, just the normal trackpad4: the only thing I have tuned on is the speech of notificationsI also have it crashing with 4.2.6Thank you for your feedback, I put it at NEW since there's a bt.Just for the test, could you disable speech of notifications?Created4.3.1 crashing with out any Text to Speach onI turned off the speech notifications and 4.2.6 did not crash, so I bumped up to 4.3.1 and the crashing returned, I have attached the new log droping back to 4.2.6 for now(In reply to)Hi Joel,The output is, as far as I can tell, identical. Obtaining a full backtrace on recent versions of OSX is more difficult for the casual user because Apple has removed gdb, and replaced it with lldb.why is this bug linked to 83426 ?***has been marked as a duplicate of this bug. ***@Ken : Yosemite final is now generally available. I'm assuming you've upgraded from beta to final ?Please download the latest 64bit production release of LibreOffice, i.e. 4322, rename your LO profile, and try restarting LO and report back here with your findings.I'm having the same issue, and I'm with the latest version of OS X (OS X 10.10 (14A389)) and LibreOffice. If it can make a difference, I'm on a Macbook Pro 2009.10.10 final here with LO Version: 4.3.3.1Build ID: 7d55112667c8fcddb67bc3803796b46c93aa56b0Working fine here.Please tryand set this bug back to NEW if the issue persists or WORKSFORME if it is fixed for you.Yes 4.3.3.1 is indeed working fine for me too.Sorry, setting back to NEEDINFO (Status WORKFORME doesn't seem to be available)Following last comments, put it as RESOLVED/WFM.Working fine with released OSX 10.10
id=85190	Using OSX Yosemite (10.10)LO master own build 64bitJava 1.8.0_25Trying to open a report that was previously created and ran correctly no longer opens, throws following error :SQL Status: S1000An error occurred while creating the report.[jni_uno bridge error] UNO calling Java method execute: [map_to_uno():any] UNO type not found: org.libreoffice.report.ReportExecutionExceptionjava stack trace:The report contains three fields in the detail section, no formulae, no sorting, no grouping, no header or footer @Stephan : you're our Java UNO expert I believe, any idea ?More background :Mysqldb instance on LANmysql native C++ connectorReport is Writer documentFields in report : TINYINT, VARCHAR(15), VARCHAR(40)Two other, different, reports in the same ODB file open fineJust noticed that attempting to open same report in LO 4322 also fails with different error :Timestamp format must be yyyy-mm-dd hh:mm:ss[.fffffffff]There are no timestamps in report !! The timestamp field is in the underlying table, and the table itself can be opened just fine.Table definitionCREATE TABLE `action_type` ( `type` varchar(15) NOT NULL DEFAULT '', `comments` varchar(40) DEFAULT NULL, `action_type_id` tinyint(3) unsigned NOT NULL AUTO_INCREMENT, `chg_date` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (`action_type_id`)) ENGINE=MyISAM AUTO_INCREMENT=5 DEFAULT CHARSET=latin1Sample data :select * from action_type;+-------------+----------------------------------+----------------+---------------------+| type | comments | action_type_id | chg_date |+-------------+----------------------------------+----------------+---------------------+| A.94(3) EPC | Normal Examining Division action | 1 | 0000-00-00 00:00:00 || R.71(3) EPC | Intention to grant communication | 2 | 0000-00-00 00:00:00 || R.51(6) EPC | Notice of grant communication | 3 | 2013-01-10 17:15:00 || A.121 EPC | Further processing | 4 | 2013-01-10 17:56:28 |+-------------+----------------------------------+----------------+---------------------+4 rows in set (0,00 sec)Hmm, methinks it could be mysql's "null" timestamp values which are the root causeI managed to a little more info in the attached screenshot, by trying to create a totally new report based on a table that had timestamps, but without including the ts field in the report.CreatedUNO JNI errorConfirmed on separate OSX machine.Possibly linked to?If I try the same basic report in LO 4322 with the mysql jdbc connector, once again not including timestamp fields in the report, I get yet another completely different error :You have an error in your SQL syntax, check the manual that corresponds to your mysql server version for the right syntax to use near'OPTION SQL_SELECT_LIMIT=DEFAULT' at line 1Where is this option being set ?(In reply to Alex Thurgood from)Mysql jdbc connector 5.1.31(In reply to Alex Thurgood from)The immediate error is that the non-UNO Java type org.libreoffice.report.ReportExecutionException shall be transported as the value of a UNO Any.But that is likely only the consequence of another error, which causes throwing such an org.libreoffice.report.ReportExecutionException somewhere in the reportbuilder/java/org/libreoffice/report/ code in the first place, for reasons yet unknown.Could you attach a reproducer + dump of MySQL database?Following Lionel's comment, I put it as NEEDINFO.Adding self to CC if not already onCreatedsql dumpEnclosing sqldumpSteps to reproduce :1) Create ODB file using mysql native connector extension to bind to database.2) Open ODB file3) Select Reports4) Choose Use wizardto create report5) In report wizard step 1, select table action_type from dropdown list6) Then add fields type, comments, action_type_id and click Next7) In step 2, click Next8) In steps 3, 4 and 5 click Next without changing anything9) In step 6, click on FinishAn error message occurs."The document ipdatabase.action_type2 could notbe opened."A whole load of JNI errors with a Java stack trace, which I can't copy appears in the msgbox.I will try and find this in the console logs.Click on Ok and the error message disappears. The report is saved nonetheless, but any attempt to execute it leads to the [jni_uno bridge error] UNO calling Java method execute: [map_to_uno():any] UNO type not found: org.libreoffice.report.ReportExecutionExceptionjava stack trace:error messageAlexConsole is showing possibly unrelated message with master 4500alphadynamic_cast error 2: One or more of the following type_info's has hidden visibility. They should all have public visibility. 7SdrView, 12SdrPaintView, 10FmFormView.Createdfull btEnclosing full btTested today onVersion: 4.5.0.0.alpha0+Build ID: 15db0307fe6429238be72612cccd4a1df5e1e97cLocale: fr_bt=> NEWNoel: I noticed this:java.lang.NullPointerException at org.pentaho.reporting.libraries.base.boot.PackageManager.containsModule(PackageManager.java:369) at org.pentaho.reporting.libraries.base.boot.PackageManager.loadModule(PackageManager.java:436) at org.pentaho.reporting.libraries.base.boot.PackageManager.addModule(PackageManager.java:330) at org.pentaho.reporting.libraries.base.boot.PackageManager.load(PackageManager.java:199) at org.jfree.report.JFreeReportBoot.performBoot(Unknown Source) at org.pentaho.reporting.libraries.base.boot.AbstractBoot.start(AbstractBoot.java:197) at org.libreoffice.report.pentaho.PentahoReportEngine.<init>(PentahoReportEngine.java:34) at org.libreoffice.report.pentaho.SOReportJobFactory$_SOReportJobFactory.createReportJob(SOReportJobFactory.java:318) at org.libreoffice.report.pentaho.SOReportJobFactory$_SOReportJobFactory.execute(SOReportJobFactory.java:212)Thought you might be interested in this one since I wonder if it could be related to the cleaning of the java part (again just a guess for the moment, I'll try to take a look tonight or tomorrow)(In reply to Alex Thurgood from)why did you continue upon the first few JVM-induced SIGSEGVs and then decided to show the backtraces upon the next one? did that one look any different? note that the JVM routinely raises and handles SIGSEGVs(not that I'm sure an soffice.bin backtrace would be of much help here anyway; but I for one cannot look into this as I'm already lost at step 1 of the reproducer in)(In reply to Stephan Bergmann from)Hi Stephan,the reason I continued was to just to check whether or not LO could recover from the SIGSEGV of the JVM as sometimes with debug builds this happens. Additionally, the hex values of the frame were slightly different between the first and second times Process 31063 stopped* thread #1: tid = 0x1ec6d5, 0x000000012e3658f5, queue = 'com.apple.main-thread', stop reason = signal SIGSEGV frame #0: 0x000000012e3658f5-> 0x12e3658f5: movl 0xc(%rdx), %r9dthen Process 31063 stopped* thread #1: tid = 0x1ec6d5, 0x000000012e16fa6e, queue = 'com.apple.main-thread', stop reason = signal SIGSEGV frame #0: 0x000000012e16fa6e-> 0x12e16fa6e: movl 0x8(%rcx), %edx(In reply to Stephan Bergmann from)You need to have LO with the mysql native connector C++ extension installed.Then you need to import the sql dump into a mysql db instance. This will create a database called ipdatabase containing one table, action_type and the sample data.After that create your ODB file, using the wizard to connect to the database via the connector extension :Start LOChoose New DatabaseDB creation wizard starts.Connect to existing database - choose mysql from the dropdown - NextChoose connect directly (third choice in list, if you also have odbc and jdbc connectors set up) - NextFill in your database name and host connection address and port if different from the default (127.0.0.1/3306) - NextEnter User name / password if necessary for your mysql connection - test connectionFinish, then save your ODB file.Open ODB file and follow previous instructionsTesting on LO 4.1 gives the same error as in. Probably linked to the changes made to timestamp definitions (inclusion of nanosecond handling) during 4.1 development ?The problem is indeed most probably the "all zeros" dates from MySQL, which are not valid values in SQL.Basing the report on a query that does not include the chg_date column works around the problem.With what version did it use to work?(In reply to Alex Thurgood from)This error comes from Java. Since displaying the table does not use Java, it does not encounter this particular problem. I guess that Java refuses to handle date "0000-00-00 00:00:00".So... The hiding of the real error behind "ReportExecutionException" is indeed from Noel's commitcommit 9341bf3dc38b2cc117ffbe12ff057511ed6e046dAuthor: Noel Grandin <>Date: Thu Oct 16 12:19:14 2014 +0200 java: when rethrowing, store the original exception Change-Id: I34ce000c48d2d79bfec854c8dd55d12f2bee29c7Noel, you cannot stick an arbitrary Java exception into a UNO exception, only a UNO exception... It will not pass the UNO barrier to C++. Please review your whole commit in this light.If you want to make that kind of throwing more useful, you can do something like: Writer result = new StringWriter(); PrintWriter printWriter = new PrintWriter(result); e.printStackTrace(printWriter); throw new com.sun.star.lang.WrappedTargetException(e.toString() + '\n' + result.toString(), this, null)So, I confirmed that this error comes when trying to convert a "all zeros" timestamp (that ultimately comes from MySQL) to a Java timestamp. Java does not accept "0000-00-00 00:00:00.000000000" as a valid timestamp.Seeing the history of the code, I doubt it ever worked.(In reply to Lionel Elie Mamane from)Since official LibreOffice builds don't include the native MySQL driver, I cannot easily check that.Anyway, what could we do about this? I only see silently replacing MySQL zero dates with NULL. That's what the ODBC driver does. But the JDBC driver does it only optionally (and not by default, see zeroDateTimeBehavior=convertToNull).So.. <shrug> haven't decided what to do yet.Createdpatch to transform zero dates to NULLHere's a patch to implement replacing zero dates by NULL unconditionally. If someone wants to add all the code and UI to make it optional, then we can do it.Else, I'll just consider it as a MySQL bug / misfeature.(In reply to Lionel Elie Mamane from)You can also separate the case of catching a UNO exception, and in this case store the original exception, from the case of an arbitrary Java exception, and in this case do as above.(In reply to Lionel Elie Mamane from)That is a good question, unfortunately, the shift to all 64bit program stack, including the connector extension, means that I can no longer test.(In reply to Alex Thurgood from)All I know is that it did, but that it would have been with an earlier version of LO (3.x ?) 32bit, native connector 1.01 ?, plus 32bit Java and 32 bit mysql - too many variables !(In reply to Lionel Elie Mamane from)This got me wondering how other Java report builders deal with this problem.After all, they interface with a wide range of different dbs with varying timestamp definitions. Will try and have a trawl to see what I can dig up.Stephan Bergmann committed a patch related to this issue.It has been pushed to "master":Related fdo#85190: Don't dress arbitrary Java Throwables as UNO Any valuesIt will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.(In reply to Commit Notification from)...addresses the sub-thread of,,Stephan Bergmann committed a patch related to this issue.It has been pushed to "libreoffice-4-4":Related fdo#85190: Don't dress arbitrary Java Throwables as UNO Any valuesIt will be available in 4.4.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.(In reply to Stephan Bergmann from)Thanks.The catch (java.lang.IncompatibleClassChangeError e2){ LOGGER.error("Detected an IncompatibleClassChangeError"); throw new com.sun.star.lang.WrappedTargetException(e2, "caught a " + e2.getClass().getName(), this, new com.sun.star.uno.Exception(e2.getLocalizedMessage()));}to me looks like it will not work, trying to pass a java.lang.IncompatibleClassChangeError through UNO.Anyway, I improved the message / throwing:Feel free to cherry-pick to libreoffice-4-4.(In reply to Lionel Elie Mamane from)No. In UNO exception ctors, the optional leading Throwable argument ('e2') is only used to pass it as 'cause' argument into the underlying java.lang.Throwable ctor; it is not "passed through UNO." What was problematic about Noel's commit was that UNO exception css.lang.WrappedTargetException takes a UNO Any argument containing a UNO exception value, and /that/ must not be an arbitrary Java non-UNO exception (was erroneously 'e2', is now 'new com.sun.star.uno.Exception(...)').That commit needlessly removes passing in the 'cause' argument. Please revisit.Stephan Bergmann committed a patch related to this issue.It has been pushed to "libreoffice-4-4-0":Related fdo#85190: Don't dress arbitrary Java Throwables as UNO Any valuesIt will be available in 4.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.(In reply to Alex Thurgood from)(Indeed unrelated, and incidentally addressed now with <> "SAL_DLLPUBLIC_RTTI for proper RTTI visibility for LLVM.")(In reply to Stephan Bergmann from)So it is thrown away when the Java exception is caught by the Java UNO bridge, and the latter throws a UNO exception to whatever called that Java code through UNO? I see. Thanks for the explanation.Readded in
id=85524	Createdcrash traceDaily build Version: 4.4.0.0.alpha1+Build ID: 6ba8b7f5eacac969e4781d63718083a05491b1bcTinderBox: MacOSX-10.10@61, Branch:master, Time: 2014-10-24_01:13:49Attempt to open ODP file containing video clips, some of which are unsupported by LO.Crash before loading completes.Trace attached. Same file opens in LO 4322, regressionTerminal output/Applications/LibreOfficeDev.app/Contents/MacOS/sofficelibc++abi.dylib: terminating with unexpected exception of type std::bad_alloc: std::bad_allocAbort trap: 6Createdfull backtraceCreatedapple trace from daily buildpossibly more useful trace indicating that there is a problem with the jvmTest file hereCreatedanother full btConfirmed on separate machine running osx 10.10 and same master buildCreatedminimal test fileAdded minimal test file to reproduceBuild switches fwiw--with-ant-home=/Volumes/HD1/Shared/Repos/LO/packages/apache-ant-1.9.2--without-junit--enable-64-bit--with-extra-buildid--enable-debug--enable-ext-nlpsolver--enable-ext-google-docs--enable-ext-languagetool--enable-ext-diagram--enable-ext-typo--enable-ext-validator--enable-ext-watch-window--enable-extra-template--enable-extra-gallery--enable-ext-wiki-publisher--enable-extension-integration--with-lang=fr--with-help--enable-epm--with-package-format=dmg--enable-ext-mariadb-connector--with-system-mariadb--enable-bundle-mariadbHmmm, is this the problem ? frame #0: 0x00000001053782a9 libvcllo.dylib`AquaSalObject::AquaSalObject(this=0x000000013e6ac950, pFrame=0x000000011c808420, pWindowData=0x0000000000000000) + 217 at salobj.cxx:41 38 { 39 maSysData.nSize = sizeof( maSysData ); 40 maSysData.mpNSView = NULL;-> 41 maSysData.mbOpenGL = pWindowData->bOpenGL; 42 43 NSRect aInitFrame = { NSZeroPoint, { 20, 20 } }; 44 mpClipView = [[NSClipView alloc] initWithFrame: aInitFrame ];Alex: quite agree with your last comment since we can see this on your bt:pWindowData=0x0000000000000000Possibly this commitAlex: I think it's due toMarkus: what about this change?-maSysData.mbOpenGL = pWindowData->bOpenGL;+maSysData.mbOpenGL = false;Then putting maSysData.mbOpenGL = pWindowData->bOpenGL;in "if (pWindowData && pWindowData->bOpenGL)" block.See(Sorry, I'm not at home for the moment to create a real patch on gerrit)Would it be ok for you?Julien Nabet committed a patch related to this issue.It has been pushed to "master":Resolves fdo#85524: OSX Crash Impress with videoclipIt will be available in 4.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Finally I commited the patch (after having simplified just a bit), see.After all, it's master branch and the fix is very straightforward.Alex: could you update your sources and confirm it's ok?Fix works in master Version: 4.4.0.0.alpha1+Build ID: 4dbed9ef9a2299587d75bd9fae96b05dac0675c3Thanks Julien !Alex
id=85589	Createdbt1) Open blank Calc document2) menu Data > Pivot Table > Create3) Choose Datasource registered4) Choose Bibliography as database5) Choose biblio as datasource6) Choose any of Sheet, Query, SQL, SQL native7) CrashConfirmed on libreoffice-fr irc yesterday on Debian and Mac OSXFull bt aatached Reproduced also on masterVersion: 4.4.0.0.alpha1+Build ID: f66cbdb948c6c43909a18be10aa838c69338dcb0regression over 4252Also affects LO 4322 on OSX, setting version to earliest found so farPerhaps this commitTomaz: I put you in cc of this bug and, as you may have seen, forIt builds ok and I don't reproduce the crash.***has been marked as a duplicate of this bug. ****** This bug has been marked as a duplicate of***It affects this version too (4.3.3.1 rc).I didn't say the bug was solved, I said it's a dup.Please take a look to*** This bug has been marked as a duplicate of***
id=86036	I have tables containing ID (Integer) and d.o.b (date-integer) and text.using 4.2.7 in Linux Fedora 20 no problem, nor in Windows 7 with 4.1.1 .Changing from Fedora 20 to openSuse 13.2 came with an upgrade to LibreOffice 4.3.3 .Now: the numerical fields in the tables all show 0 (zero)the SQL statements of the queries are unchangedsome queries still work, but only when ID is not involved in the querythe forms are unchanged but remain emptythe reports based on working queries are OK, the others notthe macros needed for opening a tree of forms work OKthe macro determining the path to the database works OKUpon closing the not-working database in openSuse (without storing any changes) and transferring the database to a machine with Windows 7 - libreoffice 4.1.1 -, the new path is found correctly and all works perfectly again. I couldn't confirm this for the original packages of LO and OpenSUSE 12.3, 64bit.Using LO 4.3.3.2 and Base without any problems here.If I understand right you ara using the packages of OpenSUSE. The first I have done when I installed a new OpenSUSE-version: I deinstalled the packages of OpenSUSE, created a folder for the packages of LO and downloaded the packages from this page:For packages from OpenSUSE please report the bug to OpenSUSE also.Lionel/Robert: dup of fdo#84315? (put in See Also)(In reply to robert from)Correct, I have LO straight from the openSuse DVD. Will do what you suggest and make a separate installation of LO.I Will come back after I have done this.For what it is worth: I installed on another machine the latest version of OpenOffice and there everything worked fine.dh_holsboer: could you take a look toto know if it's a dup or not?(In reply to dh_holsboer from)Followed your suggestion with a "clean" install straight from LO. The problem has disappeared. I will write to openSuse about the distribution bug.Thank you very much for helping out.(In reply to Julien Nabet from)After looking at that bug, it seems a duplicate. I have not looked at it in depth, however, as using the LO installation instead of the openSuse installation solved the problem.Thank you for your feedback, I put it as dup.*** This bug has been marked as a duplicate of***
id=87123	On pc Debian x86-64 with master sources updated today (commit b45e1b58700c8303596a0aac9705d8c1577903b3), I can't create a form with wizard.Steps to reproduce: - open- in left pane, click on "Forms" - in upper right pane, click on "Use Wizard to Create Form" - click on ">>" - click on finish=> Writer opens but then close before displaying any form Ubuntu 14.04 x64LibreOffice 4.5 Build ID: 8b65be4740f4349b769a8709867e0cc32d93686dLibreOffice 4.3.4.1 releaseConfirmed:NewMajor - major functionality brokenHigh - defaultRegression (works on 4.3.4.1)Would be nice to know if 4.4 is broken as well.I have tested this with Version: 4.5.0.0.alpha0+Build ID: f92183833fa569006602ac7e93c906d2094e0d4dTinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2014-12-13_23:36:38Locale: de_DEThe follwing happend:I coudl go through all steps of the wizard and wanted to save the form, but nothing to see in the database. Then I closed the database and saw the designed form on the LO-desktop. It has been saved in the /tmp-folder. I opend this form and saw the data of my database. So I switched set the design-mode on and had a look at the properties of this form. The data-source of the form was defined as file:///home/.../.../myfile.odbSo the wizard had created an external form for the database and saved this in the systems temporary folder.Then I tried the wizard in Version: 4.4.0.0.beta1+Build ID: a15a538fb191b1851f366716914822411b583c58TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:libreoffice-4-4, Time: 2014-12-03_06:05:11Locale: de_DEThe form will be created by the wizard inside the database, but without setting the styles for the form (a new bug ...).Robert: thank you for your interesting detailed feedback.Lionel: one for you?Didn't I fix this one with my recent forms wizard work?(In reply to Lionel Elie Mamane from)Have tested with Version: 4.5.0.0.alpha0+Build ID: 0c24686c3970bac7e9a4e214fccfdfffd742149eTinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2014-12-29_05:28:52Locale: de_DEThe form is created as an external form in the temporary folder with LO 4.5 at this moment.***has been marked as a duplicate of this bug. ***Still present in master with my osx build of today, which is why I just filed the duplicate that Julien correctly spotted.Reproduced by Alex too who uses MacOs (see fdo#87899).So blocker here.The funny thing is that the form appears in the document preview of the start centerThe form created also lacks a tuple navigation toolbar, similar to- normal ?Noel: thought you might be interested in this one, since form query wizard is managed by files located here:wizards/com/sun/star/wizards/formI noticed that if we comment this block 464 // add a window listener, to know 465 // if the user used "escape" key to 466 // close the dialog. 467 xWindow.addWindowListener(new XWindowListenerAdapter() { 468 @Override 469 public void windowHidden(EventObject event) { 470 cancelWizard_1(); 471 } 472 });(see)it seems ok.(In reply to Julien Nabet from)This specific part comes from:Noel: any thoughts?The original block of code looked like this before my changes:MethodInvocation windowHidden = new MethodInvocation("windowHidden", this);xWindow.addWindowListener((CommonListener) getGuiEventListener());String dialogName = (String) Helper.getUnoPropertyValue(xDialogModel, PropertyNames.PROPERTY_NAME);getGuiEventListener().add(dialogName, EVENT_ACTION_PERFORMED, windowHidden);which is clearly bogus, since "actionPerformed" is not an event on the XWindowListener interface.So I agree with Julien that this block can just be deleted.If he hasn't gotten to it by next week, I'll take care of it.Thank you Noel for your feedback.I wanted to compare with Table wizard but it fails to open with this console log:warn:legacy.osl:15896:1:dbaccess/source/ui/misc/linkeddocuments.cxx:208: caught an exception!in function:void dbaui::OLinkedDocumentsAccess::impl_newWithPilot(const char*, sal_Int32, const rtl::OUString&)type: com.sun.star.uno.RuntimeExceptionmessage: there is no member variable: Commandjava stack trace:com.sun.star.uno.RuntimeException: there is no member variable: Command at com.sun.star.lib.uno.helper.PropertySet.registerProperty(PropertySet.java:170) at com.sun.star.lib.uno.helper.PropertySet.registerProperty(PropertySet.java:192) at com.sun.star.wizards.table.CallTableWizard$TableWizardImplementation.<init>(CallTableWizard.java:66) at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57) at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) at java.lang.reflect.Constructor.newInstance(Constructor.java:526) at com.sun.star.comp.loader.FactoryHelper$Factory.createInstanceWithArgumentsAndContext(Factory... :-(Julien Nabet committed a patch related to this issue.It has been pushed to "master":Resolves fdo#87123: Impossible to create a form with wizardIt will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Thank you Noel.Now let's take a look to the Table creation wizard :-)CallTableWizard and CallQueryWizard both need a couple of lines added back that I deleted by accident.CallTableWizard needs this: public static class TableWizardImplementation extends com.sun.star.lib.uno.helper.PropertySet implements com.sun.star.lang.XInitialization, com.sun.star.lang.XServiceInfo, com.sun.star.task.XJobExecutor { private PropertyValue[] m_wizardContext; // the next two fields are accessed by reflection, do not delete! public String Command; public final Integer CommandType = com.sun.star.sdb.CommandType.TABLE;CallQueryWizard needs this: public static class QueryWizardImplementation extends com.sun.star.lib.uno.helper.PropertySet implements com.sun.star.lang.XInitialization, com.sun.star.lang.XServiceInfo, com.sun.star.task.XJobExecutor { private PropertyValue[] m_wizardContext; // the next two fields are accessed by reflection, do not delete! public String Command; public final Integer CommandType = com.sun.star.sdb.CommandType.QUERY;Julien Nabet committed a patch related to this issue.It has been pushed to "master":Following fdo#87123: Impossible to create table or query with wizardIt will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.(In reply to Noel Grandin from)Thank you Noel, fix pushed on master now!Migrating Whiteboard tags to Keywords: (bibisectRequest)[NinjaEdit]
id=86578	I'm using 64 bit Ubuntu 14.04 with a parallel installation (with separate user profile, etc.) of LibreOffice Version: 4.4.0.0.alpha2+Build ID: d273a60bfdbf9bb7623bed38667ec0647753157c - TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2014-11-20_03:05:21 - Locale: en_USI know this is similar to, but it is quite real and reproducible on my machine, and does not occur with my day-to-day 4.3 installation.While attempting to test the improved pdf export in 4.4 (BIG Improvement in pdf file sizes by the way), I thought that perhaps the smaller size resulted from the fact that Writer just left out quite a few of my graphics, which didn't appear in the resulting pdf.A little further exploration, however, showed that they were not visible in the document either, although seemed to in fact still be there - just hidden under totally (and newly) opaque non-transparent frames. Thinking that maybe this was a result of some sloppy formatting on my part, I changed a few of the frames to 100% transparency - permitting the graphic, which was already marked as "on top" to be displayed in Writer and then saved the file (yes - under a new name).I generated a new pdf and - viola - the graphics whose frames I had "fixed" showed up in the pdf.HOWEVER, when reloading the document, all of the frames were again totally opaque. To cut this short, I checked and changed the style for frame contents to 100% transparency as well, but that did made no difference in the results. The bottom line is that I can't use Writer 4.4 if there are graphics in frames.Graphics that I had placed in borderless tables, by the way, show up fine and export to pdf properly, etc.All Frames that I checked in the document (several hundred pages, so I didn't hit every one) show up in the dialog box as 50% transparency, although graphics placed in the frame (although not text, which was still visible) were completely invisible - suggesting that the transparency is really 0%.So ... The fact that Writer doesn't save the transparency of the frame would seem to be a bug. I suspect the change of the earlier default of 100% transparency (actually I don't recall ever setting frame transparencies before) may be unintentional as well if this is a new enhancement.QA folks or developers are welcome to contact me via e-mail if there are any other questions I can answer or things they would like me to try - I really want the improved pdf export, but can't use 4.4 as is (yes - I know it's an alpha, but I'm old and impatient :)FrankADDITIONAL COMMENT:While writing this, I happened to notice that the graphics that disappeared possibly had something in common: each of them was set to "in background" in a frame that was formatted with two columns. I'm not sure if this is a "clue" or not but thought I should mention it. @Frank,Not clear, are your working in ODF .odt or in filtered .doc format?How a bout a sample test document and your concise steps to reproduce.This is likely related to handling of background fill--and the exportand friends--but is not the same issue.Createdodt Document to illustrateHere you are - with my best wishes and encouragement.You can fix this - even the Bears won a game last weekend, so anything is possible!!Let me know if you need anything else.FrankPretty sure this will end up being a duplicate of fdo#80294, seeand c9.@Miklos, does this make sense?*** This bug has been marked as a duplicate of***Going to reopen and set back to NEWThis issue starts with 4.4.0 builds, which retain Armin Le Grand's writer frames refactoringwas reverted for the 4.3 builds. So, splitting it back out from.For 4.4.0 branch forward, there seems to be issues with the Writer style:graphic-properties in the content.xml and the styles.xml It seems like the XML of a coincident image frame and text frame are conflicting, and when the document is being saved back to its ODF archive something is being dropped in writing the XML. On reopen transparency and area fill have changed. The image frame is loosing color for area fill (resetting to white), and also some of the transparency elements. It will hold other area fill types.It also seems that with introduction of transparency for image frame--the Image dialog Wrap -> Through -> In bac~kground is being set--but the frame for the image is conflicting with the coincident text frame drawing layer. If the text frame is assigned an area fill (Color, Gradient, Hatching, or Bitmap) and a transparency value--then the image frame will correctly render. But if an text frame area fill NONE is set, the coincident image frame will not render the image and its frame will show opaque. Unfortunately setting transparency of the text frame is cleared to no transparency when the document is saved and reopened. So the image shows opaque. The issue of sample document provided by OP.Also, the text frame with a Color area fill will reset to color White.Resetting NEW and adding to mab4.4The Writer Frames refactoring is a nice bit of work, but looks to still need some tweaks. There is loss of formatting style of coincident image frames and text frames occurring between an .ODT document save and reopen.ref the attachments posted to 80294 applicable to this issuezip with PNGs -- converted with Alpha chnl transparencyzip of sample .odt and PDFs of 4.3.4.1 and 4.4.0beta1 renderings(In reply to V Stuart Foote from)s/84294/80294/(This is an automated message.)Setting priority to highest as this is a MAB. This is part of an effort to make the importance of MAB reflected in priority too.The attribute draw:opacity="0%" is removed on saving, when the draw:fill="none" attribute is present. So you cannot workaround the problem by explicitly setting transparent=100% in the UI.This error is similar to issue 88295 and might be connected with the wrong handling of draw:fill="none" in old OpenOffice, see.I´ve found that the color filling of a frame does not stick on saving the document. Might be related. (The background color of a text box remains though)Versión 4.4.0.2. Windows 8.Worked fine until 4.3.5To produce de bug: Create New document. Create a text frame. Set color fill.Save document. Reopen document. Frame appears with no color background.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Whiteboard -> bibisectRequest***has been marked as a duplicate of this bug. ***see***has been marked as a duplicate of this bug. ***bumping to critical, not a blocker--but this residual mishandling and loss of colors and transparency for frames is quite an annoyance--All started with refactoring with Armin L's:and subsequentthey were backed out of 4.3, but have had ongoing issues on master now as 4.4Recall seeing bits and drabs of patches against 4.3, and 4.4 but has never really been resolved.According to the following flowchart…… this should be Importance: Highest + Blocker, especially as this mis-saving happens silently; it causes loss of data without warning.(As explained in, this would mean — literally! — thousands of problems per year for just one of my files. It is preventing me from upgrading from 4.3.)Same here, and I am even stuck with 4.2.8 for specific documents, because 4.3.x is still broken by this related problemLibreOffice is confused by the draw:fill-color attribute of the frame style. If you remove it, the background color is read correctly. You can easily test this, when you save to .fodt and remove the attribute manually.***has been marked as a duplicate of this bug. ***the ALG commit disabled some horrible special-case hack topaint flys anchored at other flys specially defying thedefined z-order; this is quite awful and good to see it gonebut probably we should restore it for the legacy documents.also most of the bugs resolved as duplicate of this oneare apparently 3 or so different bugs (that were allintroduced by the same commit).Michael Stahl committed a patch related to this issue.It has been pushed to "master":tdf#86578: sw: fix rendering of legacy documents with fly achored at flyIt will be available in 5.0.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Createddocument with both writer image and drawing objectif you're curious how crazy this "feature" actually is, look at this attachment...(In reply to Michael Stahl from)Noted, will try to be careful of that in future for more than trivially sized commits@Michael S., when a TB daily rolls with the patch will of course test against each of the duplicate cases. Do you prefer they be reopened if not resolved by your rework? Or post as new specific bugs? Or just tack them on here?StuartAs the submitter of the bug, I'm eager to test these fixes, but how do I know where to find them?Michael says it will be available in 5.0 which is either week 16 (freeze) or week 21 (release), and also that it will be in the daily builds in 24 or 48 hours.Sorry I'm not familiar with how this all works, but should I get the fixed version from the 4.x line or the 5.x line, or will it be in both?And thanks much for attacking this extremely annoying (at least to me) problem. I look forward to seeing how it works.Frank@Frank, *(In reply to Frank from)No worries, unless you build from git pulls yourself, or work regularly with the TinderBox builds it can be a bit confusing.Description of the LibreOffice Tinderbox infrastructureCurrent status monitoring of the TinberboxesOwners of the various TinderBox systems may or may not post to the "Daily" build repository hosted by the project. But you should be able to find current builds of master or 4.4 or soon 4.5 here:So, Michael S's patches have been applied to the master branch. Those that will become the 5.0 release. And, at this point, the corrections have not been "backported" to the 4.4 release builds. Doing that will depend on the reviews that folks give of the effectiveness in a current build of master--and a decision made to backport if warranted and of low risk.Let us know how you make out.(In reply to V Stuart Foote from)Sorry correct that a bit...s/builds of master or 4.4 or soon 4.5 here/builds of master, or 4.4, or soon 5.0 here/Stuart, no worries, all of these dupe bugs are pretty bad so i'll try to look through them asap anyway.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-4-4":tdf#86578: sw: fix rendering of legacy documents with fly achored at flyIt will be available in 4.4.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Alas, this patch has not fixed the problem. I have installed the latest Linux version, which became available earlier today, from here:The problems remain.I shall attach some samples files for testing in file ".zip" as follows.•4.3.6.2.odt : Created in 4.3.6.2 →4.3.6.2 a.pdf : As shown when saved but before closing →4.3.6.2 b.pdf : As shown after reopening in 4.3.6.2 →4.3.6.2 c.pdf : As shown when opened by 4.4.3.0.0+ (Dev) →4.3.6.2 c.pdf : As shown when saved then reopened by 4.4.3.0.0+ (Dev)•4.4.3.0+.odt : Created in 4.4.3.0.0+ (Dev) →4.4.3.0+ a.pdf: As shown when saved but before closing →4.4.3.0+ b.pdf: As shown when reopenedI am marking this bug as Reopened.More information: Linux Ubuntu 14.04 64-bitI cannot attach the file. Therefore, here is a link to the folder on Dropbox.Created4.4.3+ a.pdf compared to ODT opened in 4.5.0alpha0+@Paddy,A good test case, will rebundle and post to this issue rather than dropbox.However, as shown, the 4.4.3+ ODT does open correctly in 4.5.0alpha0+Version: 4.5.0.0.alpha0+ (x64)Build ID: 79f64d75b25ebb7fdf9f827218cd8a762dc2739bTinderBox: Win-x86_64@42, Branch:master, Time: 2015-04-14_05:46:17Locale: en_USSo, there is another element affecting the 4.4 builds that may need backport.The 4.3.6 ODT does have the issues described in the Explain.txtCreatedrepackaged testcase by Paddy L.File names Paddy L. used caused issues with upload. Renamed and zip'd and posting test case here on TDF BZ.now i've sorted out the wrong duplicates and fixed 2 ODF related bugs,while Caolan has fixed another 1-2 about frame backgrounds.the attachment fromlooks like a different bug too,please check if it's still buggy on tomorrow's master buildsand if so file a *new* bug.The background colour has been fixed, but a new bug has been introduced. It removes the background graphic and will not allow it to be re-added!I have reported this as.Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=87369	When saving a document where a frame has a background colour, this colour is changed to white on saving.How to replicate:1. Create a new document (or edit an old one).2. Create a new frame. (As a side note, trying to choose Colour at this point usually doesn't work.)3. Frame > Area > Fill > Colour > choose any colour other than white.4. Save the document.5. Close the document.6. Re-open the document.What happens:* The frame's colour has changed to white (confirmed with Frame > Area).What should happen:* The frame retains the chosen colour.This has been tested on both Windows 7 and Ubuntu 14.04 64-bit with LibreOffice 4.4.0.0.beta2.This bug is more serious than it sounds, because it can take a tremendous amount of work to keep resetting the colours of several frames in a document. For example, I have one document used for a community, containing nine non-white frames and edited thousands of times (no exaggeration) per year. That potentially would equate to over a million frame fixes over its (so far) ten-year lifespan. Confirmed under mint 17 x64 with 4.4.0.0.beta2 Build ID: be92f32b8f21603a6b7a75dd645f7475bdee519dColor has changed to white when *loading* the file, not saving.You can see the correct color if you load it in another, older version.@MM Thank you.I confirm that I have the same results as you, loading with version 4.3.4.1.I shall edit the original report to reflect this.Oh… I can't edit the original report.Load the file saved with 4.4 with 4.3 for example and resave it to another name. Now, if you copy over content.xml from the '4.3' file to the '4.4' file, it can be imported in 4.4 again.@MM, I have duplicated what you suggested.Unfortunately, of course, as soon as you make a change and re-save the document in 4.4, it again loads as white.The difference between the two content.xml files seems to be the addition in the version 4.4 file of the following line (replace #c5000b with your chosen colour):draw:fill-color="#c5000b" draw:fill-image-width="0in" draw:fill-image-height="0in"I don't know enough about .xml files to be able to comment why this should prevent version 4.4 from using the chosen colour. But, the information should at least help the developers to find and fix the bug.This is a serious regression that should not make it into 4.4.0. I can confirm this behavior in 4.4.0.1 rc. I'll mark it as a regression and up the importance to high. If this was regarding a released version, it would warrant an importance of blocker according to the bug prioritization flowchart.I bibisected:62e81d8a4ea612991512b908f80f3b40230ba9ef is the first bad commitcommit 62e81d8a4ea612991512b908f80f3b40230ba9efAuthor: Bjoern Michaelsen <>Date: Thu Nov 6 02:27:20 2014 +0000 source-hash-d8e21f0400c5ae77e388ef81b7fcad9f65401c65 commit d8e21f0400c5ae77e388ef81b7fcad9f65401c65 Author: Stephan Bergmann <> AuthorDate: Tue Sep 30 08:24:10 2014 +0200 Commit: Stephan Bergmann <> CommitDate: Tue Sep 30 10:33:25 2014 +0200 compilerplugins: get rid of std::auto_ptr in comment Change-Id: Ia2b1bc97f3476da7bfbe659e5160cd5c73c01ce5:100644 100644 5c3813bbffcc1a973d54c24b9344a27004b8e8d4 3c6de89b42d551444e7249b54f84c458f0131f8f M ccache.log:100644 100644 603d4f7a782b36e2f744e3f1b7ae0d15f3267ee0 a01b9c064d6d47bf8377eb49bc32be6ba3efd54c M commitmsg:100644 100644 04bc02ea6b9a198280636d812dadf526391078a0 bd57af0b2b70f65eeb4e4e24d93e7f3d2dc31736 M make.log:040000 040000 b4c02035df8301972581e0df7ca439311ef4d5d2 a9c2ee18b91f9f5f64bde6f0231d616c6678b773 M opt$ git bisect log# bad: [4a3091e95fa263d3e2dd81e56e83996f0bb12287] source-hash-2b5b04e1e62914bf0902dfd7943cdc44499c47a6# good: [812c4a492375ac47b3557fbb32f5637fc89d60d9] source-hash-dea4a3b9d7182700abeb4dc756a24a9e8dea8474git bisect start 'latest' 'oldest'# good: [5d0dfb8e62ae61a240f8313c594d4560e7c8e048] source-hash-0c6cd530de13f80795881f61064f1bf1dcc4ea81git bisect good 5d0dfb8e62ae61a240f8313c594d4560e7c8e048# good: [7dfacd0b8bd828331d74c0f79de6e8924bc4e6a5] source-hash-f93ce4f7eb90093d0ea3115d0a1c614612676dbdgit bisect good 7dfacd0b8bd828331d74c0f79de6e8924bc4e6a5# bad: [a42da134cd542144fca7ba14cce86c2b409fc18a] source-hash-beadebc0f7eb5582fcb8dcb082d19afdf2751876git bisect bad a42da134cd542144fca7ba14cce86c2b409fc18a# bad: [5f697ca821720f76105e5539f0408e68a0647481] source-hash-f9695150942341a755a43996d4639eb623d7640bgit bisect bad 5f697ca821720f76105e5539f0408e68a0647481# bad: [3b00b662438462a4b73b0531ffa6192fc7e72638] source-hash-0a5cd87e591d7f87bfab92716079af719259f143git bisect bad 3b00b662438462a4b73b0531ffa6192fc7e72638# good: [b4320c4383b3d61076ac1794797bd3162612889d] source-hash-da21f7da44dc577a08ea3bc210083dc8decf18bcgit bisect good b4320c4383b3d61076ac1794797bd3162612889d# good: [e1690f3a96306b42e829d63cb23a48e4b90603b5] source-hash-3d394257945f6b0a4bc4b5ea397a3942a59c5d06git bisect good e1690f3a96306b42e829d63cb23a48e4b90603b5# bad: [62e81d8a4ea612991512b908f80f3b40230ba9ef] source-hash-d8e21f0400c5ae77e388ef81b7fcad9f65401c65git bisect bad 62e81d8a4ea612991512b908f80f3b40230ba9ef# good: [8d288df76cd45312945404c1805ffae2418a27a8] source-hash-26f2da07b1c6074e519d28557a3d1d5518ff6cb4git bisect good 8d288df76cd45312945404c1805ffae2418a27a8# first bad commit: [62e81d8a4ea612991512b908f80f3b40230ba9ef] source-hash-d8e21f0400c5ae77e388ef81b7fcad9f65401c65CreatedTest file (background of frame should be violet)The behaviour seems to have changed as of the below commit.Adding Cc: to; Could you take a look at this one? Thankscommit 5aa360cae0383f270c12708e7e94179a7fde6711Author: Caolán McNamara <>Date: Mon Sep 29 16:25:27 2014 +0100 Resolves: fdo#80468 and fdo#81223 image/frame backgrounds wrong writer has code to fill in missing new properties from the old properties if they exist. But xmloff is stripping them out before they get there. Don't strip them out, and add in a missing check for one of the archaic bg colors and add a regression test for fdo#81223 Change-Id: I9a541a9bee0a01c90f2c33383f1144ecd8b0bfff***has been marked as a duplicate of this bug. ***I have today installed the just-released version 4.4.0.This bug is still present.It is a critical show-stopper for me; I cannot use version 4.4 until this is fixed (as per my original post).I am sure that this will affect many people.This bug has still not been assigned. Is there any way to have it looked at by the developers?This is still present in 4.4.1.2.Is there any way to have this looked at, please? It's only three months before support for 4.3 ends, so this needs to fixed before then.I can Confirm.I've got the same issue, as I open documents created with libreoffice 4.3 and also new documents created with 4.4.I'm running on ubuntu 12.04***has been marked as a duplicate of this bug. ***This bug occurs in 4.4.1 fresh and occurred in other recent releases.Don't know whether frame background colour is not saved with document or not retrieved upon file open.Regards@PeterSHarris, the information is initially saved but then incorrectly loaded, and subsequently incorrectly saved. Loading from version 4.3 correctly loads it, showing how it has been saved.Please make this bug a release blocker for 4.4.2. It silently renders opened files useless if they are saved.According to the following flowchart:This should be Importance: Highest + Blocker.I have made the changes.Unfortunately, the problem is still there in 4.4.2.1.Let's hope for 4.4.2.2!While desperately experimenting with frame colors, I discovered that, while Any color set is transformed into white when saving the file in ODT format, if you set the area of the frame as transparent, it actually stays white, and you cannot see anything (E.G. other objects) behind the frame even if its properties state that it has no filling.Actually, I am not sure whether this is regression or a bug, since I do not remember to have used this option in the past. Should I open another ticket?duplicate ofalready on 4.4. mab*** This bug has been marked as a duplicate of***this is not a duplicate ofbut of*** This bug has been marked as a duplicate of***Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=87446	When I work in Calc, references to other sheets get lost in all cells.So instead of "=Sheet2.A1" theres "=A1".This happens to the whole document, not just single cells.In addition the Bug is only "visible" when you click on affected cells,because the cells don't get updated right away.When I close the file and open it again, I see all the errors in the bynow updated cells. But I wasn't able to catch the bug "at work" so tospeak.For now it seems very random and I can't reproduce it reliably, but it happened3 or 4 times on different files in the last week alone.I judge the severity of this bug very high!I had to recreate complex sheets for my master thesis from backups and redo a full days work because the saved file opened corrupted the next day (as described above).P.S.:I'm using version 4.2.7-2 in manjaro linux Ask your friendly Manjaro maintainer to upgrade the LibreOffice package to 4.2.8*** This bug has been marked as a duplicate of***
id=87899	Version: 4.5.0.0.alpha0+Build ID: 5f2cfd1beed6466715b7a1ed6a22b93cc250c79bLocale: fr_at step 8 of the form creation wizard, the user is asked for a name for the form, or a default is suggested. The user sees the Finish button highlighted, but clicking on this does nothing. The only other alternative is Back or Cancel. What should happen:form wizard should complete and save form, the open it for use.What currently happens:use can not save form, and is stuck between cancelling or remaining in a loopregression over LO 4331*** This bug has been marked as a duplicate of***Correction : the form does get actually created on first execution of the wizard but is not stored in the database file, rather it gets written as ODT to /user/temp in the LO profile.For this reason, the user thinks the wizard has failed, and re-running the wizard leads to the loop behaviour where it subsequently fails to complete
id=89136	CreatedThe problem of the Image buttonsWhen you edit a Form and want to add buttons:- if you choose an Image control (in French Controle picto), id doesn't work- if you want to make an Image button (in French Bouton picot), it works until you close the form, you open it: no buttons, they no longer are on the form (you can verify by editing) (see attached file)- if you choose Push Button and want to have a picture instead of text, when you open the form after having closed it: the pictures of the buttons are no longer on them.For this reason, and the problem of the reports we can't make, we can't really work with Base (and the entire office suite). I forget to mention that Base crashes when I want to add an Image control.@Ysabeau : please only put one bug submission per reportThe non-saved image on button is a known bug.Setting this as duplicate*** This bug has been marked as a duplicate of***Please open a separate bug report for Base crashing when trying to insert an image control in a formspecify : LO versionOS : type and versionExact steps to reproduceProvide a sample ODB file to accompany detailed step by step explanation.Hi Alex,I reproduce the disappearance picto button :- editing a forms;- in form controls I choose the picto button;- I trace the shape of the button on my form;- I right click to open the properties dialog;- I choose an action;- I get a picture (I took a 26 kb png image);- I close the properties dialog;- I disable the form draft mode.- I click the picto button;- the action is not executed; (*)- I save and close the form;- I re-open the form;- I close the database;- re-open database, re-open form,(*) I open a separate issue for this problem.BernardMy configuration :Windows 7 / x86LibreOffice Version: 4.4.0.3Build ID: de093506bcdc5fafd9023ee680b8c60e3e0645d7Locale : fr_FR
id=90722	I have download master~2015-04-19_06.58.05_LibreOfficeDev_5.0.0.0.alpha0_Win_x86_en-US_de_ar_ja_ru_qtz.msiand installed.But I cannot start it. I get the errorDie Anwendung kann nicht gestartet werden.service not supplied: loading component library<file:///F:/LOdev50_2015_04_16/program/../program/expwraplo.dll> failed I have brought the problem to the developers via IRC.It is a problem with the new merging of dlls, which is done on the tinderbox Win-x86@62-merge-TDF.The installation set fromworks.Reproduce with LibOfficeDev 5.0.0.0.alpha1 x64.(77a35997fa7cff387b5b135ff0c42155f80e9884)***has been marked as a duplicate of this bug. ***Putting as blocker even if it concerns only Windows since LO is completely unuseable.Cannot reproduce with master/LibreOfficeDev daily/master/Win-x86@62-merge-TDF/2015-05-13_01.52.36Version: 5.0.0.0.alpha1+Build ID: 5b3a30f40a7ce476922649b734f6ede1c2fdef4bTinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-05-13_01:52:36Locale: ja-JP (ja_JP)(In reply to baffclan from)Версия: 5.0.0.0.alpha1+ID сборки: 2b999dd6da5a90db66afe852a007fab8c62ffaecTinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-05-12_13:03:41Локаль: ru-RU (ru_RU)bug is not reproducedwe assume that fixed
id=89873	Createdscreenshottested under Win8x64 using Version: 4.5.0.0.alpha0+Build ID: 333f8a76341f5b4921e89012d133007503e49612TinderBox: Win-x86@42, Branch:master, Time: 2015-03-07_00:28:52Locale: it_ITany dialog window you open (ie. File/Properties, Tools/Autocorrect Options) looks completely broken like you can see in my screenshotit seems the windows doesn't show up the dialog text but instead shows the document background beneath it if confirmed by others this has to be added to the mab4.5 list(In reply to tommy27 from)well, not every dialog is affected...for example Tools/customize, Tools/Options, Help/about look normalCan not confirm withVersion: 4.5.0.0.alpha0+Build ID: e80d1cfcb75659eddfd7a29e45d9e6ee935668acTinderBox: Win-x86@39, Branch:master, Time: 2015-02-27_02:25:05Locale: fr_FRon Windows Vista.CreatedscreenshotReply too quickly...I've tried with Calc.Have again atry with Writer and now I can reproduce *partially*.Windows are showned correctly excepted when having checkboxes.Text with checkbox is not lisible (black on black background).I uninstalled the build were I reported the bug originallyBuild ID: 333f8a76341f5b4921e89012d133007503e49612TinderBox: Win-x86@42, Branch:master, Time: 2015-03-07_00:28:52Locale: it_ITand then installed this slightly older build from another tinderboxBuild ID: cda4c8edc21a92422e3479909d8082cddf16bcaeTinderBox: Win-x86@39, Branch:master, Time: 2015-03-06_03:02:28Locale: it_ITnow I see the same issue as you in the autocorrect option dialog box.the other looks fineanyway this supports the fact that the dialogs were already broken on 2015-03-06 and some code change made the situation getting worse in 2015-03-07I set status NEW and I edit summary notes.Confirming on Windows 7 sp1, 64-bit en-US with nVidia GTX 260 and 9.18.13.2018 driver onVersion: 4.5.0.0.alpha0+Build ID: 333f8a76341f5b4921e89012d133007503e49612TinderBox: Win-x86@42, Branch:master, Time: 2015-03-07_00:28:52Locale: en_USSTR:1. Launch with new/clean user profile2. Open Writer3. Standard toolbar -> Spelling and Grammar button, or <F7>Observed -- Dialog frame and alert box both empty not drawntdf#89873 Bisect resultsGoodVersion: 4.5.0.0.alpha0+Build ID: c6223049651d6607101ef04271773e478a429c8aTinderBox: Win-x86@39, Branch:master, Time: 2015-03-04_00:54:12Locale: en_USGoodVersion: 4.5.0.0.alpha0+Build ID: 78be86343bc6ee91fffe3b710f7db3a90f1b23aeTinderBox: Win-x86@39, Branch:master, Time: 2015-03-05_04:01:11Locale: en_USGoodVersion: 4.5.0.0.alpha0+Build ID: cda4c8edc21a92422e3479909d8082cddf16bcaeTinderBox: Win-x86@39, Branch:master, Time: 2015-03-06_03:02:28Locale: en_USFirst badVersion: 4.5.0.0.alpha0+Build ID: 8ea45048b83e685090484c959f642118cfebef6cTinderBox: Win-x86@62-TDF, Branch:MASTER, Time: 2015-03-06_23:24:09Locale: en_USBadVersion: 4.5.0.0.alpha0+Build ID: 333f8a76341f5b4921e89012d133007503e49612TinderBox: Win-x86@42, Branch:master, Time: 2015-03-07_00:28:52Locale: en_USIn the 56 commits in range:***has been marked as a duplicate of this bug. ***This does not appear to affect builds other than Windowsnot reproducible on Fedora 21 with LXDE withVersion: 4.5.0.0.alpha0+Build ID: 333f8a76341f5b4921e89012d133007503e49612TinderBox: Linux-rpm_deb-x86@45-TDF, Branch:master, Time: 2015-03-07_01:08:32Locale: en_USalso present on x64 Windows buildsVersion: 4.5.0.0.alpha0+ (x64)Build ID: 8ea45048b83e685090484c959f642118cfebef6cTinderBox: Win-x86_64@42, Branch:master, Time: 2015-03-06_22:59:05Locale: en_USMAB should always be highest - setting as such nowIssue inare different issue as in- UI: black background on Options - Language Settings - Writing AidsDespite, I can reproduce this on Linux (Ubuntu 14.04, lxde) with e.g. the Calc "Find & Replace" dialog.First bad commit in the 45 dbgutil bibisect tree is2015-03-07: source-hash-333f8a76341f5b4921e89012d133007503e49612which tallies within terms of the timescale of when it was introducedAdjusting bug metadata to suit.(In reply to Matthew Francis from)Yes confirming Linux (Fedora 21 (32-bit), w/LXDE) is also affected, the "Find & Replace" <Ctrl+H> in Writer or Calc exhibits the isssue. Odd that the STR using "Spelling and Grammar" <F7> shows correctly on LXDE Linux, but only for Writer. But with Calc "Spelling" <F7> is also not painting dialog correctly. Guess using "Find & Replace" would have been the better STR.The "Find and Replace" window should be fixed. Currently working on black background at Autocorrect.Still occurs on master in Writer with "Insert - Indexes and Tables - Indexes and Tables...""File - Print..." also isn't painted initially, although it sorts itself out after a whileTo Commit 15The bug in TreeLists with black background is NOT from scheduler. It is from patch 148e489e33a34c6345326c9beaf248ac91f8cd01. Lot of dialogs not set the background, that was the problem. My fix set the color to the default background, in my case under windows is the color grey, and under linux it is white, and both work now. In following dialog found, not completely- Autocorrect, tab options and tab localized options- Spelling, button options - Options, Language Settings/Writing AidsPatch:Juergen Funk committed a patch related to this issue.It has been pushed to "master":tdf#89873 UI: some dialog windows not being paintedIt will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.***has been marked as a duplicate of this bug. ***On Windows 7 sp1, 64-bit en-US withVersion: 4.5.0.0.alpha0+ (x64)Build ID: 2302e9eb8a161abaf5899288b4e1c689f5a1ff07TinderBox: Win-x86_64@42, Branch:master, Time: 2015-03-31_23:15:41Locale: en_USVerified, both types of issue are now correct.Seems like this bug made it into 4422 too - seeCan the fix be backported to 4.4 ?ToThe last fix is only for the screenshot (42.04 KB) in this case the background was not set for the list-box-entries. The trouble is coming with this patch:and that was only in LO 4.5In your case it look like a graphic problem, and nothing to do witch this.@Juergen: Edit – AutoText... appears to still suffer from a lack of backgroundMigrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=91380	Animation Dialog has not Title BarSteps to Reproduce:1. Start LibO-Dev2. Make a New Impress Presentation3. Insert Animation, Menu - Insert - Animated Image4. Appear Animation Dialog daily/master/Win-x86@62-merge-TDF/2015-05-16_03.18.47Version: 5.0.0.0.alpha1+Build ID: 6664859e1e8b3f8b7db8c931b8d0335510c20ce0TinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-05-16_03:18:47Locale: ja-JP (ja_JP) CreatedScreenshotSorry, it is UI problem.Components: Impress -> UINot reproducible for me with Version: 5.0.0.0.beta1+Build ID: 7f49a466e85b5f5866e6af28d84ed06697e49d20Ubuntu_15.04_x86-64Locale : fr-FR (fr_FR.UTF-8)The title is "Animation". Perhaps a Windows-only problem.Best regards. JBFConfirmed.Win 7 Pro 64-bit Version: 5.1.0.0.alpha1+Build ID: d8208da8576874fdb07014287e6cbc0aeba741bbTinderBox: Win-x86@39, Branch:master, Time: 2015-05-23_09:23:03Locale: fi-FI (fi_FI)Sounds like it's related to #91524***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Confirmed: pt-BR has untranslated strings, no window decoration for color picker. See image.CreatedImage with issue***has been marked as a duplicate of this bug. ***It is related to .ui conversion of docking windows. i.e. before conversion it was OK, after it there is no titlebar on Windows. I tested with:0ef2fa8 convert RID_SVXDLG_BMPMASK dockingwindow to .uiAttention: Bug is still present in 5.0.0.1 - the official RC1!! RC 1 overwrites an existing stable 4.x version!For users the only possibility to close those "ghost"-frames is to create a new user profile. This is a NOGo!!From what I can see, all the affected windows have type_hint=dock property, so maybe this kind doesn't get the right WinBits?If someone here has a Windows build, he could experiment with it, to see what WinBits are actually missing:***has been marked as a duplicate of this bug. ***just to tell that the lack of titlebar makes those docking windows unmovable and unclosable, so I consider it a blocker.(In reply to tommy27 from)I can close them with the Esc key.(In reply to Maxim Monastirsky from)I had the same WinBits in Linux and Windows: A0000460WB_SIZEABLE | WB_3DLOOK | WB_CLOSEABLE | WB_HIDE | WB_DOCKABLEI have a fix at(tested and worked on Windows, no adverse effect on Linux). I asked for review, because it was just a hack without deep understanding of the underlying behaviour.Andras Timar committed a patch related to this issue.It has been pushed to "master":tdf#91380 add WB_MOVEABLE bit to docking windowsIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Andras Timar committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#91380 add WB_MOVEABLE bit to docking windowsIt will be available in 5.0.0.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Cannot reproduce with newest master.Windows 7 Pro x64Version: 5.1.0.0.alpha1+ (x64)Build ID: 253c0f073715b1d0f6ba063b1182016e45951bf4TinderBox: Win-x86_64@62-TDF, Branch:MASTER, Time: 2015-06-24_21:31:12Locale: ja-JP (ja_JP)Thanks for fixing this.***has been marked as a duplicate of this bug. ***Migrating Whiteboard tags to Keywords: (bibisectRequest)[NinjaEdit]
id=92014	On Windows 8.1 64-bit en-US, nVidia Quadro K2000 GPU withVersion: 5.0.0.0.beta3 (x64)Build ID: 96345c15d8ab19c49014f055fe41ba8e1f421e5cLocale: en-US (en_US)also on Windows 7 sp1 64-bit en-US, nVidia GTX260Have had problems with 64-bit LO 5.0.0beta1, and now 5.0.0beta3 where creating a new Writer document or opening an existing writer document immediately crashes LO--but leaves soffice.bin and soffice.exe running.No affect setting OpenGL, and other components do not seem to be affected. Just Writer.Mid-May TB42 64-bit builds not similarly affected on same systems. @Cloph, @Qubit, *Will try to get a BT, stack dump, but is there a source of symbols that will make sense to 64-bit WinDbg for these 64-bit builds?Seems a bit much, but guess this is highest / blocker perI can confirm the crash on Windows 7 that after opening a document it crashes and then shows the 'LibreOffice Document Recovery' dialog due to the crash and that it files worked on will be saved and auto recovered. Currently running WinDbg and will post the result once its finished.@Stuart: Full instruction on windbg is available here (i rewrote it with pictures :D) -Createdwindbg backtrace of 500b3(In reply to V Stuart Foote from)Stuart: What's the latest good build/commit that's working for you? I don't think we're currently building a Win64bit bibisect repo, but that might come in handy...(In reply to Robinson Tryon (qubit) from)Last I had on the 8.1 system that was OK from Thorsten's TB42 isVersion: 5.0.0.0.alpha0+ (x64)Build ID: add7eeb7dbd0eefa0c5ae5430490864079add801TinderBox: Win-x86_64@42, Branch:master, Time: 2015-04-17_02:28:38Locale: en_USI have to see what I have on the Windows 7 sp1 system this evening--may not be into May as I thought, but those were the last 64-bit Windows builds I'd been able to run as Cloph's TDF build have all had issues, and no other 64-bit Windows TB to work against.Createdanother WinDbg-64 backtrace of 500b3, same break pointseems to hang at the same location as for JayCreatedWinDbg-64 backtrace of a 500b1 Writer launch(In reply to V Stuart Foote from)So, on Windows 7 sp1, 64-bit en-US the last build I had from Thorsten's TB42 was from 2015-05-15Version: 5.0.0.0.alpha1+ (x64)Build ID: 9d0c51daea67104349cac26de9839afa8baeb099TinderBox: Win-x86_64@42, Branch:master, Time: 2015-05-15_23:59:35Locale: en-US (en_US)followed by Cloph/Qubit's TDF build of 5.0.0beta1 on 2015-05-21, which had issuesVersion: 5.0.0.0.beta1 (x64)Build ID: 0a16c3dda4150008d9be6f24cbd15ac198d116d3Locale: en-US (en_US)I've attached a WinDbg-64 backtrace of failures there that also triggers with launch of Writer, but ends at a different point.So - hanging in the python grammar checker ? I wonder if Laszlo has an idea. This affects only our new platform - x86_64 right ?***has been marked as a duplicate of this bug. ***(In reply to Michael Meeks from)Yes, believe so, just x86_64 Windows builds.I'm experiencing immediate Writer crash too.Win10_64-bit: Build 10130LibreOffice Version: 5.0.0.0.beta3 (x64)Also see, perhaps as a duplicate.I can confirm this behavior. I have the same issue with LO5 x64 builds since the LO 5 Alpha. Immediate crash. Open GL / Graphics / JRE settings make no difference. Writer cannot be used.Reported -***has been marked as a duplicate of this bug. ***CreatedWinDbg 64 Trace - Writer Fail - FromI tested the same 32-bit windows build as the 64-bit build and no crash.***has been marked as a duplicate of this bug. ***as workaround, disable the automatic spell checking.Starting Writer with a document where the locale has no grammar checker (i.e. French), it’s OK. When you switch the language style to English, LO crashes.good news: not reproducible anymore in current build of both master as well as libreoffice-5-0In other words: While I can reproduce with beta3, I can no longer with code that will end up as rc1 - so I assume it was fixed in the meantime along with another change.I cannot reproduce with my Windows --enable-64-bit --enable-dbgutil master build from last night either. (But also couldn't reproduce in the past, as I had failed to configure --with-myspell-dicts in the past, so had had no spell checking dictionaries to begin with.)Bug can still be reproduced in LO 5.0.0.1 win x64 build (currently on pre-release server - jun 20). As Christian pointed out, switching off the spell-checker does indeed provide a workaround that enables writer to run. I guess this means that whatever had solved the problem in master hasn't made it to the RC build. :(As a follow up on Christian's workaround, only the 'Lightproof module' and 'check grammar while typing' option need to be turned off.The immediate crash will only reproduce with the realtime 'lightproof checker' enabled and the 'check while typing option' selected. With the lightproof module available and realtime switched off, a manual grammar check (f7) causes the crash.With lightproof off and realtime grammar off, auto and manual Spell checking functions without any problems and the hyphenation / thesaurus behave as expected.In my case, System language / dictionaries and documents being opened are all in English.This should be fixed now with <> "MSVC 64-bit: In queryInterface optimization, copy hidden ret val addr" towards LibreOffice 5.0. (Same underlying problem as.)(In reply to Christian Lohmaier from)The underlying bug was that a certain function should return in RAX a specific value that is already known to the caller, but instead returned garbage in RAX. Whether the caller wants to actually make use of that value returned in RAX (which it does not really need, as it already knows the value) may depend on details like --enable-debug configuration etc. That might explain that some builds exhibited actual problems while others didn't.Wow - great fix Stephan =) I'm surprised our unit tests didn't pick it up though.(In reply to Michael Meeks from)I was surprised too, but also note.Confirm resolved inVersion: 5.0.0.3 (x64)Build ID: f79b5ba13f5e6cbad23f8038060e556217e66632Locale: en-GB (en_GB)
id=91574	tested under Win8 using LibO 5.1.0.0.alpha1+Build ID: 83eb114394879cbfd073322a51c47d02553c1fcfTinderBox: Win-x86@39, Branch:master, Time: 2015-05-22_06:33:51Locale: en-US (it_IT)- load an .odp file in Impress- click Slide Show/Start from first slidepresenter console is not shown, but you can still advance trough slides using arrow keys or mouse clicksif you click Esc LibO crashesserious regression, works fine in 4.4.xp.s. I set version to 5.0 beta1 since 5.1 master is not yet available in the version list On pc Debian x86-64 with master sources updated today, I don't reproduce this.Windows-only bug?still present with LibO 5.1.0.0.alpha1+Build ID: 6c1cabe677f5eb24b465dd6e316c8c66df64bb29TinderBox: Win-x86@39, Branch:master, Time: 2015-05-29_06:48:08Locale: en-US (it_IT)I reproduced it. Tested under Windows8.1(X64) and MacOS X(10.10.3) with LibO 5.0.0.0.beta1(BuildID: 0a16c3dda4150008d9be6f24cbd15ac198d116d3).It was occurred by the steps below.Steps to Reproduce:1. Start LibO-Dev2. Make a New Impress Presentation3. Select Slideshow > Start from first Slide to Start SlideshowAnd the times of crushing are as follows* Windows: After playing slideshow, when I attempted clicking to finish slideshow, it crushed.* Mac: It crushed on Step3 of Steps to Reproduce.Although the version of LibO and steps, can you test them?Yeah, presenter console seems seriously busted on 5.0 - on linux, libreoffice-5-0 build from yesterday, and just getting an empty frame for the presenter view. No immediate crash though.Would be nice for someone seeing this crash to get us a decent backtrace:(In reply to Masui Masanori from)I revert version to 5.0 beta1 according to this commentactually when the slideshow is over, I don't see an immediate crash as in the original report, however when I click Esc or Exit slideshow the LibO interface gets frozen... I cannot click on anything and I have to Ctrl+Alt+Canc to kill the applicationtested on Win8 using 5.1.0.0.alpha1+Build ID: 6c1cabe677f5eb24b465dd6e316c8c66df64bb29TinderBox: Win-x86@39, Branch:master, Time: 2015-05-29_06:48:08Createdan error log what was taken by WinDbg(In reply to Joel Madero from)I got an error log. Please let me know if there are any problems.(In reply to Masui Masanori from)That one looks like- but it then doesn't quite explain the Linuxissues. Let's wait for beta2, unless someone gets a linux backtrace.(In reply to Thorsten Behrens from)Thank you for testing. OK, I will test again after getting beta2:)MABs are obsolete =)retested under Win8.1 x64 using LibO 5.1.0.0.alpha1+Build ID: bb9dad2ef23829b2500c9f99154bca6a8ba7d49aTinderBox: Win-x86@39, Branch:master, Time: 2015-06-11_23:59:18Locale: en-US (it_IT)I still see two issues once you start the slideshow1- presenter console not shown either you are on a single monitor or a dual monitor setup2- once you finish the presentation and click exit presentation, if you are on a single monitor setup there's no issue. if you are on a dual setup monitor the focus stays on the secondary monitor so all the LibO GUI which is on the primary monitor gets frozen and you can't click anything so you can't exit the application... the only way to exit is to click on the taskbar icon in the secondary monitor (on Win8 you have taskbars on both monitors) and exit the applicationI don't see any real crash now (as I noted in) so I'm changing summary notes from:SLIDESHOW: presenter console not shown and crash on exit to:SLIDESHOW: presenter console not shown and focus remains on the secondary monitorcan anyone retest according to my latest findings with 5.0 beta3 or latest 5.1 dailies?retested under Win7 x64 using LibO 5.1.0.0.alpha1+ updated todaythe issue remains the same... but as said in previous comment, since Windows 7 (and earlier releases) has no taskbar in the secondary monitor (unlike Win8.1) you cannot use that workaround.so the issue is even worse on those Windows system where you have to Ctrl+Alt+Canc and kill LibO in order to retake possess of your computer.I'm writing about.I retested it with LibO 5.0.0.0.beta3 and confirmed it hadn't occured on Windows8.1(X64).But on MacOS X(10.10.3), it was reproduced again..@Masuiare you on a dual monitor setup?(In reply to tommy27 from)@tommy27no. I'm using only one monitor.[Environment]・PC: Mac mini 2012・Monitor: PHL 224E5CreatedRender problem of presenter consoleGot this issue on Debian 8 (jessie) with KDE:Version: 5.1.0.0.alpha1+Build ID: a64999511ae654131d997eec9a3d78478cfc1c75TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2015-06-22_05:01:17Locale: es-ES (es_ES.UTF-8)andVersion: 5.0.0.1Build ID: 9a0b23dd0ab9652e0965484934309f2d49a7758eLocale: es-ES (es_ES.UTF-8)After pressing F5 to start presentation, I can go through it with the cursor or key press but the presenter console renders badly.Works fine on:Version: 4.4.5.0.0+Build ID: be0f5f5b66c55081849250ffad9f600cd61a00a1TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:libreoffice-4-4, Time: 2015-06-20_22:26:11Locale: es_ES.UTF-8Versión: 4.4.3.2Id. de compilación: 88805f81e9fe61362df02b9941de8e38a9b5fd16Configuración regional: es_ESVersión: 4.3.7.2Id. de compilación: 8a35821d8636a03b8bf4e15b48f59794652c68baprobably we are dealing with different issues with presenter console in different O/S...I reported under Windows that the console is not showed at all and the focus remains on secondary monitor when exiting the slideshowMasui reported a crash under MacOSCarlos reported a badly renderd presenter console under Linux@Carlosare you working on a dual monitor setup or with a single monitor?(In reply to tommy27 from)Dual monitor with a not so new Intel(R) HD Graphics 4000This bug also affects Windows XP Pro x86. Tested with 5.0.0.2 on a dual monitor system. Exiting presentation with Esc leaves a "ghost" task in the taskbar (which is closed when the presentation is closed on the main window). There is no crash.This is a major regression.thanks for feedback. what about exiting the presentation? do you have the same secondary monitor taskbar focus issue I described under Windows? seetested in 5002 on Ubuntu 32 bitsNo presenter console.No crash.After the presentation, when I use Ctrl+` , to toggle between active LibreOffice windows, I do see an *empty* window, just the *frame* and for the *transparent*.(In reply to Cor Nouws from)I do see an *empty* window, just the *frame* and for the rest *transparent*.thanks Cor, are you able to exit the slideshow without using keyboard shortcuts?there's should be an "exit presentation" or something like that at the end of it.(In reply to tommy27 from)Yes, if I click it exits presentation mode(In reply to Cor Nouws from)And after closing the presentation document, the empty window remains(Sorry, can't take a screen shot of the ghost window :) )ok, but what about the "focus" of the LibO application? does it remains on the secondary monitor like in Windows (which makes impossible to select anything in the primary monitor... not only LibO, but also taskbar etc. etc.) or stays on the primary monitor allowing to work with LibO and other apps?(In reply to tommy27 from)Something weird with focus ongoing too here.But I expect (maybe too optimistic) that one bug in the software may have various effects, depending on OS, set up etc etc..Not working as expected confirmed for me under Linux Ubuntu 15.04 with a dual screen.Just tested with Version: 5.0.0.2.0+Build ID: 50b93a183bcdd9981a740a92cd5cc6be77be1973Ubuntu_15.04_x86-64Locale : fr-FR (fr_FR.UTF-8)built at home.The bad behaviour is different depending on whether you use VCL plugin GTK3 (default) or GTK2.GTK3: the screen of the speaker is emptyGTK2: the screen of the speaker is a duplicate of the edit window.For both closing the slide-show does not go back to the edit mode.I did not experienced a crash. Same behaviour for the master.Best regards. JBFthanks for testing.the crash was probably some other bug present at the time of the initial report but has not been reproduced subsequently either on Windows and Linux (a Mac user is still reporting a crash) while the issues of presenter console visualization and slideshow exit are still presentIt doesn't crash for me (dual screen), presenter console is shown on the primary screen, but I'm loosing focus (and mouse responding) on primary screen.A way to retrieve focus on primary screen, is to open a terminal on secondary screen, and manually kill soffice.binVersion: 5.1.0.0.alpha1+Build ID: a28231b72b5a87dddffad82a34deac4e5bb76ed1TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2015-07-02_06:22:36Locale: fr-FR (fr_FR.UTF-8)GUI Toolkit tested : gen, gtk, gtk2, gtk3, kde, kde4Distrib : Xubuntu 14.10Ubuntu's Kernel package : 3.16.0-41-generic (x86_64)May this specific issue should be tracked by a new bug, "on graphics stack" component ?Christian Lohmaier committed a patch related to this issue.It has been pushed to "master":tdf#91574 fix presenter console not displayedIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Christian Lohmaier committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#91574 fix presenter console not displayedIt will be available in 5.0.0.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.(In reply to Commit Notification from)With this commit LO quit without error message just after the slide-show started. I do not see the speaker console.Tested with Version: 5.0.0.2.0+Build ID: d78b81b379333bd471c670bc9f49304f1d6f030aUbuntu_15.04_x86-64Locale : fr-FR (fr_FR.UTF-8)Best regards. JBFretested under Win8.1 x64 with LibO 5.1.0.0.alpha1+ (x64)Build ID: a551d82bfc3ddae2354d39c90e31ad6eefcd1617TinderBox: Win-x86_64@62-TDF, Branch:MASTER, Time: 2015-07-04_07:51:25Locale: en-US (it_IT)things now are even worse...the presenter console is still not shown and LibO crashes as soon as I start the slideshow and move to the second slide.I'll retest with a 32 bit build from a different tinderbox when it will be available.it seems that the Windows 32bit tinderbox are not working and there's no recent daily build availableso I retested the latest 64bit build 5.1.0.0.alpha1+ (x64)Build ID: 67afab2a7cd5596d321bb85e6e2624df19c2296bTinderBox: Win-x86_64@62-TDF, Branch:MASTER, Time: 2015-07-04_22:51:13Locale: en-US (it_IT)the issue still persist. still no presenter console and crash after moving slideshow from 1st to 2nd slide.please, Linux and Mac users, test and tell if you see the same problem.I also think we should split the current report in different sub-issues... I mean:#1- presenter console not shown#2- crash after advancing trough slideshow#3- loss of focus in dual monitor after exiting the slideshowissue #1 has always been constant even after Christian committ which was supposed to address this side of the bug, while #2 and #3 varied among different daily builds so I suspect it's not a single bug causing all the troubleCreatedbt with debug symbolsOn pc Debian x86-64 with master sources updated today, I had a crash.See bt attachedMichael: Seeing this=I wonder if we should change maVDev to declare it like this ScopedVclPtr<VirtualDevice> or if we should just use VclPtr<VirtualDevice>::Create (but in this case with which parameter?)I submitted a patch here:I chose the simplest way (but perhaps not the right way)(diff --git a/canvas/source/vcl/spritecanvashelper.cxx b/canvas/source/vcl/spritecanvashelper.cxxindex 095dae6..e6fa3e7f7 100644--- a/canvas/source/vcl/spritecanvashelper.cxx+++ b/canvas/source/vcl/spritecanvashelper.cxx@@ -177,7 +177,7 @@ namespace vclcanvas SpriteCanvasHelper::SpriteCanvasHelper() : mpRedrawManager( NULL ), mpOwningSpriteCanvas( NULL ),- maVDev(),+ maVDev(VclPtr<VirtualDevice>::Create()), maLastUpdate(), mbShowFrameInfo( false ), mbShowSpriteBounds( false ),)at least, I don't reproduce the crash with this.CreatedPresenter console ghost windowOn Debian 8 (jessie) with KDE and:Version: 5.1.0.0.alpha1+Build ID: 8b788891796ff0571f779cdbe8ce809c35c42754TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2015-07-03_01:07:30Locale: es-ES (es_ES.UTF-8)Version: 5.0.0.2.0+Build ID: 64b4ed9de3852494416cdcb8c25d2e24fc4d0253TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:libreoffice-5-0, Time: 2015-07-03_09:08:51Locale: es-ES (es_ES.UTF-8)#1- presenter console not shown but window task exists (see attachment). I can click where the controls should be and the presentation follows BUT "forward button" seems to go "backwards" and reciprocally.#2- NOT crashing after advancing trough slideshow and I can get the focus on other windows normally below the presenter console window.#3- After exiting presentation I loss of focus in the display where the presenter console was. I can do Alt+Tab to go through the windows tasks and focus one of the LibO windows and close the ODP file or create a new one but I'm unable to get the focus on anything below this window. The only way to do it is closing it that kills the "presenter console" ghost window.Upgrading to:Version: 5.1.0.0.alpha1+Build ID: 3c45bfb0cabf206f6217f1de9eb5cfa12b78e46fTinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2015-07-04_01:25:39Locale: es-ES (es_ES.UTF-8)I get a crash as soon as I press F5 to start the presentation :-(Yes - getting the crash currently is expected (see the comment in)the crash and not showing the presenter console are different buts - although not showing the console did hide the crash. Julien's fix addresses the crasher.@clophso basically once Julien crash fix will be merged we should be finally able to see the presenter console?as I said in, I agree with tommy27 on his.I'm only concerned by issue #3, and i think it would be easy to track if we split this bug into 3 new ones :#1- presenter console not shown#2- crash after advancing trough slideshow#3- loss of focus in dual monitor after exiting the slideshowIs there a simple way on buggzila to create 3 new bugs, linkink comments and attachment of this one ?if nobody has objections, I'll do the split tonight then I'll tell everybody the link to the the new bugs.Julien Nabet committed a patch related to this issue.It has been pushed to "master":tdf#91574: SLIDESHOW: crash when second monitor connectedIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Julien Nabet committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#91574: SLIDESHOW: crash when second monitor connectedIt will be available in 5.0.0.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.retested under Win8.1 x64 using LibO 5.1.0.0.alpha1+ (x64)Build ID: 0251e61640b94094918406b33ee7b05564409febTinderBox: Win-x86_64@62-TDF, Branch:MASTER, Time: 2015-07-06_23:45:07Locale: en-US (it_IT)this time no crash after launching slideshow presenter console is still not shown correctly (you got a white screen with current slide miniature) during slideshow when you exit slideshow (Esc key) the slideshow windows closes and the presenter console reappears basically the presenter console GUI is not show at all apart from the current slide miniature... when you exit the slideshow the grey background of the presenter console along with its buttons appears around the slide miniaturefocus still remains in the secondary monitor so in Windows 8.1 you have to use the secondary monitor to regain possess of the primaryThanks for the testing; just pushed another fix - would love input on whether this makes things good finally. For me the fix cleanups a load of lingering / leaking slide-show windows and makes slideshow work nicely (at least for me on Linux). I saw quite a curious paint related crasher here too - somehow with toolkit queuing idle emitted paint events on VCLXWindows but not managed to reproduce - hopefully also gone.Thanks !Michael Meeks committed a patch related to this issue.It has been pushed to "master":tdf#91574 - fix slideshow presenter console lifecycle.It will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Meeks committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#91574 - fix slideshow presenter console lifecycle.It will be available in 5.0.0.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.retested under Win7x64 using LibO 5.1.0.0.alpha1+ (x64)Build ID: 449d272daf5e99f039cdfdd25f020bd798fb9e1dTinderBox: Win-x86_64@62-TDF, Branch:MASTER, Time: 2015-07-08_08:13:06Locale: it-IT (it_IT)things are better now not 100% fixed...first the good news...there's no more crash either at start or end of slideshowthe second monitor issue is gonethe abd news are that the presenter console is still shown incorrectly...actually you see just the current slide miniature surrounded by a blank white background in the monitor which is supposed to show the presenter consolethe presenter console grey background and buttons only show up when you reach the last slide.so I'm changing again the summary notes to better reflect the current issue statusRetested with Version: 5.0.0.2.0+Build ID: 5de8f1559afafe4a5430142c305549223d467606Ubuntu_15.04_x86-64Locale : fr-FR (fr_FR.UTF-8)containing the commit tdf#91574 - fix slideshow presenter console lifecycle.Now Presenter Screen seems to work as expected. Thank you very much.Best regards. JBFworks in Linux as said in previous comment but still broken under Windows.retested again with 5.1.0.0.alpha1+Build ID: d3b6f3790953bdfeaeebcd3ba9ec370d94ca4ebfTinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-07-09_00:11:55Locale: en-US (it_ITsame findings as inplease Mac users give update of the bug current status in your platforma Mac user in the QA mailing list said that presenter console works fine under OS X Yosemite (10.10.4) with multi-windowso it seems the residual issues affect Windows only...Confirmed fixed on Debian 8 (jessie):Version: 5.1.0.0.alpha1+Build ID: 85ce6a2446deb0f4c01604b6188f969603de9b16TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2015-07-09_02:29:43Locale: es-ES (es_ES.UTF-8)and Version: 5.0.0.2.0+Build ID: 991dd34d66dada90de0f5eb8f28deb74af8c5851TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:libreoffice-5-0, Time: 2015-07-09_08:22:48Locale: es-ES (es_ES.UTF-8)Thank you!!Wow - so, at least I can reproduce on Windows. Will have a look and try to get it into RC3.I've had a further wrestle with this ... the slideshow and worse sdext/ code is some of the most -horribly- tangled stuff I've seen in libreoffice's VCL usage. No wonder its under-responsive & performs poorly ;->Anyhow - it seems that the proximate cause of the non-rendering is that:CanvasUpdateRequester::RequestUpdate is not called on Windows, at least until we get an invalidate from something eg. a mouse-over causing a re-render of the canvas-based presenter-console toolbar. It seems there is also something of a delay here on Linux too which makes it easier to chase but even so ... the code maketh one cry.I have not updated the nightly build yet, but still seeing this issue in the RC from the PPA, which updated between last night and today.***has been marked as a duplicate of this bug. ***More reading of the pure over-engineered horrors in the impress code-base =) Turns out that this is specific to the DX canvas. If we disable that Tools->Options->View - and un-check "use hardware acceleration" - life is good again - albeit that it still takes far longer than is remotely feasible to actually render the presenter view - (and the projected slides), but that's nothing too new =) F9 should within a few ms be able to configure both displays to be showing the right thing, but there is a huge pile of code here seemingly designed to avoid things happening sensibly here ;-)Seems to be fixed in the latest RC build from the LibreOffice Pre-release PPA.Works with or without hardware acceleration enabled.@Rolandit's fixed in Linux, we know that.but the bug persists under Windows.still reproducible with LibO 5.1.0.0.alpha1+Build ID: fcdddbd30a8b5cf6a5cc4d2ff28b7d4a20f8ec6bTinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-07-20_02:07:48Locale: en-US (it_IT)Not sure what wasn't clear but I still had the problem after everyone else said ut was fixed. This is why I reported that I'm no longer seeing it.probably they retested with a daily 5.0 build with the fix merged while you waited to test it only in the official 5.0 RC3 which featured that fix (see target in whiteboard) whilst RC2 still had the bug.correct me if my suppositions are wrongI don't want to launch into extended discussion but as far as I understand the PPA was up to date.It was already hosting RC3 when I commented that it wasn't fixed for me a few comments up.Hi Roland - thanks for your feedback - if you can paste the git hash / details from Help->About that really helps us to isolate the exact version you're seeing this in. Unfortunately the Windows problem is really pretty unpleasant, but my hope is the Linux issue is fixed.Well; after yet more wading through the code - I have a fix; the real question is - why does it fix it ? ;-)diff --git a/canvas/source/directx/dx_9rm.cxx b/canvas/source/directx/dx_9rm.cxxindex 63e12b7..42c37ac 100644--- a/canvas/source/directx/dx_9rm.cxx+++ b/canvas/source/directx/dx_9rm.cxx@@ -680,7 +680,6 @@ namespace dxcanvas mpWindow->SetControlForeground(); mpWindow->SetControlBackground();- mpWindow->EnablePaint(sal_False); const SystemEnvData *pData = mpWindow->GetSystemData(); const HWND hwnd(reinterpret_cast<HWND>(pData->hWnd));I -imagine- that this method stops the window paint event getting emitted; and hence we miss the chain to:sdext::presenter::PresenterPane::windowPaint (this=0x7fffc01b16c8, rEvent=...) at /data/opt/libreoffice/master/sdext/source/presenter/PresenterPane.cxx:139PaintListenerMultiplexer::windowPaint (this=0x1ffcfe8, evt=...) at /data/opt/libreoffice/master/toolkit/source/helper/listenermultiplexer.cxx:122That ultimately triggers the CanvasUpdateRequester::RequestUpdate - and various other rendering pieces that in the end calls the various updateScreen methods that whack this stuff to the display.Still not understanding the change here; but this is what I'd expect to see to get the rendering into order:#0 sd::presenter::CanvasUpdateRequester::RequestUpdate (this=<error reading variable: can't compute CFA for this frame>, bUpdateAll=<error reading variable: can't compute CFA for this frame>) at /data/opt/libreoffice/master/sd/source/ui/presenter/CanvasUpdateRequester.cxx:81#1 0x00007fffc25d0bcb in sd::presenter::PresenterCanvas::updateScreen (this=<error reading variable: can't compute CFA for this frame>, bUpdateAll=<error reading variable: can't compute CFA for this frame>) at /data/opt/libreoffice/master/sd/source/ui/presenter/PresenterCanvas.cxx:562#2 0x00007fffad103911 in sdext::presenter::PresenterPaneBorderPainter::Renderer::PaintBorder (this=0x213e710, rsTitle="Current Slide (1 of 2)", rBBox=..., rUpdateBox=..., rsPaneURL="private:resource/pane/Presenter/Pane1") at /data/opt/libreoffice/master/sdext/source/presenter/PresenterPaneBorderPainter.cxx:503#3 0x00007fffad1023a4 in sdext::presenter::PresenterPaneBorderPainter::paintBorder (this=0x7fffc01b3798, rsPaneBorderStyleName="private:resource/pane/Presenter/Pane1", rxCanvas=uno::Reference to (sd::presenter::PresenterCanvas *) 0x7fffdc09b928, rOuterBorderRectangle=..., rRepaintArea=..., rsTitle="Current Slide (1 of 2)") at /data/opt/libreoffice/master/sdext/source/presenter/PresenterPaneBorderPainter.cxx:229#4 0x00007fffad10149f in sdext::presenter::PresenterPaneBase::PaintBorder (this=0x7fffc01b16c8, rUpdateBox=...) at /data/opt/libreoffice/master/sdext/source/presenter/PresenterPaneBase.cxx:410#5 0x00007fffad0fef09 in sdext::presenter::PresenterPane::windowPaint (this=0x7fffc01b16c8, rEvent=...) at /data/opt/libreoffice/master/sdext/source/presenter/PresenterPane.cxx:139#6 0x00007ffff247b192 in PaintListenerMultiplexer::windowPaint (this=0x1ffcfe8, evt=...) at /data/opt/libreoffice/master/toolkit/source/helper/listenermultiplexer.cxx:122#7 0x00007ffff22fca86 in VCLXWindow::ProcessWindowEvent (this=0x7fffdc3b6498, rVclWindowEvent=...) at /data/opt/libreoffice/master/toolkit/source/awt/vclxwindow.cxx:470#8 0x00007ffff22fc753 in VCLXWindow::WindowEventListener (this=0x7fffdc3b6498, pEvent=0x7fffffffc9d0) at /data/opt/libreoffice/master/toolkit/source/awt/vclxwindow.cxx:417#9 0x00007ffff22fc5bf in VCLXWindow::LinkStubWindowEventListener (instance=0x7fffdc3b6498, data=0x7fffffffc9d0) at /data/opt/libreoffice/master/toolkit/source/awt/vclxwindow.cxx:408#10 0x00007ffff0754b0f in Link<void*, long>::Call (this=0x156ffa0, data=0x7fffffffc9d0) at /data/opt/libreoffice/master/include/tools/link.hxx:127#11 0x00007ffff0d2aeb4 in VclEventListeners::Call (this=0x1ffca00, pEvent=0x7fffffffc9d0) at /data/opt/libreoffice/master/vcl/source/app/vclevent.cxx:63#12 0x00007ffff0803e6e in vcl::Window::CallEventListeners (this=0x1ffd1a0, nEvent=1000, pData=0x7fffffffcca8) at /data/opt/libreoffice/master/vcl/source/window/event.cxx:214#13 0x00007ffff074b733 in vcl::Window::Paint (this=0x1ffd1a0, rRect=Rectangle = {...}) at /data/opt/libreoffice/master/vcl/source/window/paint.cxx:994#14 0x00007ffff074891f in PaintHelper::DoPaint (this=0x7fffffffcc70, pRegion=0x1ffc800) at /data/opt/libreoffice/master/vcl/source/window/paint.cxx:268#15 0x00007ffff0749b80 in vcl::Window::ImplCallPaint (this=0x1ffd1a0, rBuffer=..., pRegion=0x1ffc800, nPaintFlags=62) at /data/opt/libreoffice/master/vcl/source/window/paint.cxx:566#16 0x00007ffff07496b2 in PaintHelper::~PaintHelper (this=0x7fffffffcdb0, __in_chrg=<optimized out>) at /data/opt/libreoffice/master/vcl/source/window/paint.cxx:505#17 0x00007ffff0749bd1 in vcl::Window::ImplCallPaint (this=0x166bd70, rBuffer=..., pRegion=0x21071d0, nPaintFlags=60) at /data/opt/libreoffice/master/vcl/source/window/paint.cxx:570#18 0x00007ffff07496b2 in PaintHelper::~PaintHelper (this=0x7fffffffcef0, __in_chrg=<optimized out>) at /data/opt/libreoffice/master/vcl/source/window/paint.cxx:505#19 0x00007ffff0749bd1 in vcl::Window::ImplCallPaint (this=0x2003a90, rBuffer=..., pRegion=0x1fd4570, nPaintFlags=60) at /data/opt/libreoffice/master/vcl/source/window/paint.cxx:570#20 0x00007ffff07496b2 in PaintHelper::~PaintHelper (this=0x7fffffffd030, __in_chrg=<optimized out>) at /data/opt/libreoffice/master/vcl/source/window/paint.cxx:505#21 0x00007ffff0749bd1 in vcl::Window::ImplCallPaint (this=0x166b380, rBuffer=..., pRegion=0x0, nPaintFlags=60) at /data/opt/libreoffice/master/vcl/source/window/paint.cxx:570#22 0x00007ffff0749cea in vcl::Window::ImplCallOverlapPaint (this=0x166b380) at /data/opt/libreoffice/master/vcl/source/window/paint.cxx:591#23 0x00007ffff0749ec1 in vcl::Window::ImplHandlePaintHdl (this=0x166b380) at /data/opt/libreoffice/master/vcl/source/window/paint.cxx:620#24 0x00007ffff0749da9 in vcl::Window::LinkStubImplHandlePaintHdl (instance=0x166b380, data=0x2040350) at /data/opt/libreoffice/master/vcl/source/window/paint.cxx:602And of course this is completely inhibited by:ImplCallPaint's path here: if (mpWindowImpl->mbPaintDisabled) { if (mpWindowImpl->mnPaintFlags & IMPL_PAINT_PAINTALL) Invalidate(InvalidateFlags::NoChildren | InvalidateFlags::NoErase | InvalidateFlags::NoTransparent | InvalidateFlags::NoClipChildren); else if ( pRegion ) Invalidate(*pRegion, InvalidateFlags::NoChildren | InvalidateFlags::NoErase | InvalidateFlags::NoTransparent | InvalidateFlags::NoClipChildren); return; }Tomaz - any ideas what changed here and why ? its somewhat unclear to me why we don't end up with some loop here if we invalidate, trigger a paint that ends up here with paint disabled & we trigger a new invalidate; hmm ...Would love this verified on Windows vs. master before getting too excited for -5-0 =)Michael Meeks committed a patch related to this issue.It has been pushed to "master":tdf#91574 - ensure we get paint events to render directx presenter console.It will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Createdmy random code-reading notes on some of the oddness here.(In reply to Michael Meeks from)works under Win8.1x64 using LibO 5.1.0.0.alpha1+ (x64)Build ID: 591238e8a4f1164adb51d3bada0cd90c3e7c655eTinderBox: Win-x86_64@62-TDF, Branch:MASTER, Time: 2015-07-22_00:03:41Locale: en-US (it_IT)set status to VERIFIEDwould like to see it pushed to 5.0.x as well.thansk MichealOn Windows 7 sp1, 64-bit en-US withVersion: 5.1.0.0.alpha1+ (x64)Build ID: 591238e8a4f1164adb51d3bada0cd90c3e7c655eTinderBox: Win-x86_64@62-TDF, Branch:MASTER, Time: 2015-07-22_00:03:41Locale: en-US (en_US)Timer works, Notes, Slides panes show and can be manipulated.So would agree its fixed now on Windows, and ready to back-port--Thanks Michael!Should have added also good with the 32-bit buildsVersion: 5.1.0.0.alpha1+Build ID: 8be5ec39051cc0eb70ec9882a45a95c661f7398fTinderBox: Win-x86@39, Branch:master, Time: 2015-07-22_05:19:39Locale: en-US (en_US)Michael Meeks committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#91574 - ensure we get paint events to render directx presenter console.It will be available in 5.0.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.CreatedMissing console under Windows XP x86 running version 5.0.0.4It is not fixed in 5.0.0.4 under Windows XP x86I still get the same: it runs correctly on the first run showing the console on the main monitor and the slideshow on the second. On the second run (and all following) the console is white, with some very small images on the Top Left Corner and a correct preview of the current slide in the correct position. The slideshow is working correctly on the second monitor.See attached image.(In reply to Pedro from)Will not be fixed for 5.0.0,is clear that target is 5.0.1***has been marked as a duplicate of this bug. ***(In reply to V Stuart Foote from)I'm running 5.0.3.2 (openSuse 13.1) and the bug is still there: The presenter console on terminal 2 consists of a completely white screen except for a frame with the running time displayed in yellow.The presentation on terminal 1 is as expected, but there is no way to decently end Impress: Both terminals are blocked, and can only be unblocked with Ctrl+Alt+Del.So please reopen the bug and fix it.I forgot to mention that the presenter console works fine using the same presentation under Impress 4.4.6.3 running in the same environment.Hi, Willy, Some months ago, I found out this issue had something to do with profile folder, but I was using Linux. I don't know how to explain it technically. But, despite having upgraded from LO 4 to 5, my profile folder remained as "4", as if no upgrade had happened. The solution was: with LO closed, I copied my profile folder to another place, then I deleted the original folder. When I opened LO again it created a new profile folder, solving the problem. I could then copy my profile settings from the old to the new folder. But I didn't feel it was really necessary.I don't know it it does apply to Windows.Good luck!(In reply to Daniel Hora from)Hi Daniel,thank you for pointing me to the non-updated configuration. I removed the directory .config/libreoffice and restarted LO 5.Now the presenter console shows the actual slide and the preview of the next one, and LO can be exited decently.But:1. The background is white instead of black (bad contrast),2. the digits for the time measurement are over-pixeled when they are non-zero,3. and the frame showing the graphical menue (e.g. switch terminals) is present, but only white.Question to the maintainers:Should I open an new bug report?Out of sheer despair I downloaded LO 5 from the libreoffice site, andIT WORKS AS IT SHOULD!Therefore I ask you not to re-open this bug report.So, it's a bug in the openSuSE distribution of LO 5.0.3. I'll open a bug report with openSuSE.(In reply to Willy Weisz from)Thank you for investigating further and for reporting your findings.For future situations, yes it is preferable to open a new bug report. Even if the problem is seems to be the same, it is preferable to start with a fresh report (no mixing with previous comments/symptoms)
id=92269	CreatedShell Crash ReportWin 7 x64LO 5.0.0.1 x64 build - (win shell extensions enabled)steps:-Open any folder containing LO ODF files in an explorer window.Click on an ODF file to select.Explorer crashes. [see attached screen shot]Workaround:-Disable all 32bit LO shell property handlers [see attached screen shot]Note:32bit Thumbnail handler may be left enabled without a crash occuring.Disabling a single handler changes the length of time before the crash occurs. Disabling all stops the crash.64bit handlers are all left enabled. Disabling the 64bit handlers has no effect upon the behaviour. CreatedDisabled Shell Handlers - Stable BehaviourI previously noticed a bug out for x64 shlxthdl.dll but I can't find it now :( -this may be a duplicate but I'm filing it as it still occurs in 5.0.0.1 (rc) and I'm also having to disable propertyhdl.dll under 32bit in order to stop the crash.Likely related:and.Confirm due to. Adjust prio.***has been marked as a duplicate of this bug. ***(In reply to Thorsten Behrens from)Hi ThorstenIn reply to(duplicate of this bug)No, my system is Windows 7 Home Premium SP1 32 bit. (Spanish)LibO 5.0.0.1 9a0b23dd0ab9652e0965484934309f2d49a7758e es_COI had installed LibO 5.0.0.1 on a Windows 8.1 64x, but I was unaware of the x64 LibreOffice version. So I don't know what was on the 8.1 system, I reverted back to 4.4. (But I think it as 32 bit)ThanksClaudeI've encountered a similar problem after installing LibO 5.0.0.1 on Win7x64just selecting an .odt file and trying to rename it, caused crash of the file managerafter uninstalling LibO 5.0.0.1 the issue was goneon another machine with Win8.1x64 and a very recent 5.1.0.0 alpha daily build I have no issue like that.TESTING on Win8.1 with 5.1.0.0.alpha1+ (x64)tinderbox: pull time 2015-06-24 21:31:12tinderbox: git sha1score:253c0f073715b1d0f6ba063b1182016e45951bf4(In reply to Eric M from)NO REPRO here -- clicking on an ODT file does not crash Explorer.(However: I'm seeing the same missing filetype associations as reported in, and I wonder if that issue is superseding this bug)(In reply to Robinson Tryon (qubit) from)CONFIRMED on Win8.1 + LO 5.0.0.1 (x64)The Explorer window froze, then disappeared (crashed, I assume?), but I was able to open up Explorer again less than a minute later.Subsequent runs of the steps above (no reboot) had less severe effects. Explorer isn't even freezing up when I click on the file icon.Neither LibreOffice nor Windows has crashed for me, and Explorer seems to re-appear pretty promptly, so I'm wondering if this really a highest + blocker, or perhaps something less severe.(In reply to Robinson Tryon (qubit) from)This is possibly fixed (on master and libreoffice-5-0 branch), any chance to re-test with a daily libreoffice-5-0 build?(In reply to Thorsten Behrens from)Yep -- I'm eager to test, but 5.0 RC1 came out on June 22nd, and I don't believe there are any newer 5-0 daily builds:Latest x86-64: Jun 22ndLatest x86: Jun 17thI know that TB62 wears multiple hats, so it may have been too busy to produce new 5-0 builds. I'll check with cloph.***has been marked as a duplicate of this bug. ***Just tested on the new rc :-Version: 5.0.0.2 (x64)Build ID: a26d58f11b99b6aeddf7f7884effea188cc6e512Locale: en-GBOS - Win 7 - x64 The crash is reproducible (same steps).The workaround will stop the crash.Crash is even reproducable with 32 bit build on Win 8.1 64Bit.It just needs some more time....so crash occurs after opening 3 or 4 files )odf) via explorer and then stay with muase about 1-3 sec over another odf-file. Explorer crashes!Win 8.1 64 bitVersion: 5.0.0.1Build-ID: 9a0b23dd0ab9652e0965484934309f2d49a7758eGebietsschema: de-DE (de_DE)***has been marked as a duplicate of this bug. ***It happens on 5.0.0.2 .Windows 7 x64Intel Core i7Build-Id: a26d58f11b99b6aeddf7f7884effea188cc6e512Same here. Windows 7/64, Core i5, 8GB RAM.(In reply to schaber from)And LO 5.0.0RC2the trick to provoke a crash is not clicking on a file - it is waiting until Windows Explorer tries to show a tooltip.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***problem is here:the wscpy_s triggeres invalid parameter error and that terminates the process.it was changed from simple, non-caring function- msg.copy(pMem,msg.length());+ wcscpy_s(pMem, msg.length(), msg.c_str());in 19bfe765a50a81f67325c4fd35314ca8a2e4ca0aso the function does what it is supposed to do and chokes on invalid input (overruns) - so question is where does invalid input come from/is it OK to just revert. Need to read about the functions in more detail...first guess: copy is length, wcscpy_s expects buffersize, i.e. needs a +1 for also covering the null-bytenow on to verify...I encounter the explorer crash after install LibreOffice 5.0.0 version in my Win 7 PC. However my OS is 32bit. Is it the same problem, or should a file a new bug?(In reply to Kevin Suo from)Does the crash occur in the same way? Does the mentioned workaround stop the crash?If the behaviour you have encountered is the same, you don't need to file a new bug. Confirming that an existing bug is reproducible (as you have done) is enough.it's the same bug if you see error about msvcr120.dll with the exception 0xc0000409 (i.e. an overrun) in your windows event log (or in some error-report-sending tool that might shows up). Bot 64bit as well as 32bit versions of windows are affected, so no need to file a separate bug.Christian Lohmaier committed a patch related to this issue.It has been pushed to "master":tdf#92269 fix Windows Explorer crash caused by shellextensionIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.wow - these "secure" functions actually do what they're supposed towhen you stupidly forget to consider the terminating null :)thanks for tracking that down.Christian Lohmaier committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#92269 fix Windows Explorer crash caused by shellextensionIt will be available in 5.0.0.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.HiI do not reproduce the crash on Windows 7/64 SP1 & Version: 5.0.0.2.0+ (x64)Build ID: 18d6d789cae7cd684156dbd41d473892bc17392cLocale: fr-FR (fr_FR)Tried with steps&RegardsPierre-YvesI use Windows 7 starter, 32 Bit. Windows Explorer finishes and restarts here, when I hover a file thumbnail, which is associated to LibreOffice. Right click and calling file properties does not trigger it. I have uninstalled my old LO version 4.2 and installedVersion: 5.0.0.2Build-ID: a26d58f11b99b6aeddf7f7884effea188cc6e512Gebietsschema: de-DE (de_DE)***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Resolved in 5.0.0.3 RC on 32-bit Windows 7, but can't speak to 64-bit versions of Windows.Resolved in Version: 5.0.0.3 (x64)Build ID: f79b5ba13f5e6cbad23f8038060e556217e66632Locale: en-GB (en_GB)***has been marked as a duplicate of this bug. ***
id=92277	CreatedIcons which my crash Windows ExplorerAfter installing LibO 5.0.0.1 on Win 8.1, 64 Bit there is a problem with existing Odf-Documents (writer, calc, draw Impress). As far as I move my mouse over a odf-document in Windows explorer, the Explorer crashes. Windows restart it surface - but again - moving mouse over a odf document in Explorer - - crash.It first happens after installing LibO 5.0.0.1 - with replace an existing 4.4 installation.Computer has a Dev-Installation too (LibO 5.0.0.beta3).So I removed all LibO-Installations (even the Beta-Installation) - and restart the computer.In Windows explorer the odf-files now do not have any Icon (standard file icon), and nothing happend on mouse over. Everything is stable.Then I installed libO 5.0.0.1 again - the files now have again the Icons (screenshot) - mouseover crashes Windows explorer after a delay of approximatly 1 sec.Starting libO and selecting "open document" - the file-browser will not crash!My System:Win 8.1 64 BitVersion: 5.0.0.1 (x64)Build-ID: 9a0b23dd0ab9652e0965484934309f2d49a7758eGebietsschema: de-DE (de_DE) Confirm behaviour, not only in Windows 8.1 but also in Windows 7. In the latter a window opens informing that explorer stopped and has to restart; it takes longer though than in Windows 8.1.LibreOffice 5.0.0.1 spanish versión.(In reply to Claude from)Claude, Thomas, can you confirm this is 64bit-LibreOffice only? I.e. it does *not* happen with a 32bit install, even on a 64bit Windows?Claude, question for you in an earlier comment.I can confirm with win7 64bit, LO Verze: 5.0.0.1 (x64)ID sestavení: 9a0b23dd0ab9652e0965484934309f2d49a7758eNárodní prostředí: cs-CZ (cs_CZ)Seefor a workaround*** This bug has been marked as a duplicate of***
id=92325	I am trying to compile libreoffice on ubuntu 15.04.immedieatly after using make commandI get this following errorfatal: unable to connect to gerrit.libreoffice.org:gerrit.libreoffice.org[0: 89.238.68.148]: errno=Connection refusedClone of 'git://gerrit.libreoffice.org/translations' into submodule path 'translations' failedMakefile:210: recipe for target 'get-submodules' failedmake: *** [get-submodules] Error 1 (In reply to Rachna from)Hi Rachna,For any build-related bugs or questions, please send an email to the dev list here:Thanks!Status -> RESOLVED NOTOURBUG
id=92460	Open any of the applications, try to save a file and it freezes.Win 7 Pro 64-bit Version: 5.1.0.0.alpha1+Build ID: f33700200901ff5d54fbbbb12053e1f1ccad1739TinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-06-29_22:45:51Locale: fi-FI (fi_FI) no freeze under Win8.1x64 using LibO 5.1.0.0.alpha1+Build ID: df7595a5f5871f8343e4ee3869ad153e3ae4a7f3TinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-06-25_14:29:31Locale: en-US (it_IT)I'll retest with a newer buildreproducible using LibO 5.1.0.0.alpha1+Build ID: f33700200901ff5d54fbbbb12053e1f1ccad1739TinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-06-29_22:45:51Locale: en-US (it_IT)critical regression needs bibisecting... should be a small committ range since a few days ago it workedsame issue with LibO 5.1.0.0.alpha1+Build ID: ec44f1ae39e44f55ef1b1625fc5f638d2dbf5256TinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-06-27_22:18:34Locale: en-US (it_IT)Export to PDF freezes, too.Win 7 Pro 64-bit Version: 5.1.0.0.alpha1+ (x64)Build ID: 3a6ec53eeeec71312f5ea890689f9c2ee79c2aacTinderBox: Win-x86_64@62-TDF, Branch:MASTER, Time: 2015-07-01_02:24:40Locale: fi-FI (fi_FI)it works with Build ID: ee3d40b30816a8fc6d4e8f984659c8dfac19ec3bTinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-06-26_00:21:32Locale: en-US (it_IT)so the regression took place between 26th and 27th juneinfo taken from the QA mailing list.On Wed, 01 Jul 2015 14:26:53 +0200, Matthew J. Francis <> wrote:>>>>>adding Micheal Stahl to CC list ?yes this was triggered by SolarMutexReleaser fixfixed on masterMichael Stahl committed a patch related to this issue.It has been pushed to "master":tdf#92460: fpicker: fix VistaFilePicker using SolarMutexReleaserIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.***has been marked as a duplicate of this bug. ***Doesn't crash anymore.Win 7 Pro 64-bit Version: 5.1.0.0.alpha1+ (x64)Build ID: 8b788891796ff0571f779cdbe8ce809c35c42754TinderBox: Win-x86_64@62-TDF, Branch:MASTER, Time: 2015-07-02_23:09:27Locale: fi-FI (fi_FI)Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=93437	In order to reproduce the bug:[1] Open new spreadsheet.[2] Click Function Wizard. The dialogue is opened.[3] Cancel dialogue.[4] Try to select row or column. Columns and can't be selected.[5] Try to open context menu of a column (A, B,..) or of a row (1,2,3,..). No context menu is opened.At step [3] you can also insert a function. The result is the same. I tried it with the function TODAY.Ver. 5.0.0.5 with Win 7 (32 bit). Additional info: Works for me with version 4.4.4. Hence regression.Reproducible.Win7x64UltimateVersion: 5.0.1.1 (x64) Build ID: 13f702ca819ea5b9f8605782c852d5bb513b3891Version: 5.1.0.0.alpha1+ Build ID: 7d3fa6bae9f7a755eb2d0ca24bf1afd5f3646bb7TinderBox: Win-x86@39, Branch:master, Time: 2015-08-09_08:38:08On pc Debian x86-64 with master sources updated yesterday, I could reproduce this.I only noticed these logs when closing wizard dialog:warn:legacy.osl:32416:1:include/cppuhelper/interfacecontainer.h:479: object is disposedwarn:legacy.osl:32416:1:include/cppuhelper/interfacecontainer.h:479: object is disposedwarn:legacy.tools:32416:1:vcl/inc/svdata.hxx:389: object deleted while in use !I noticed too that if I run format cell (from context menu in a cell or from menu) or another kind of function which calls a dialog, it's ok.Even if it's not a crash and you don't lose data, considering how it's simple to reproduce this and the fact that you can encounter this more than often in Calc, I think it's a blocker (or whatever the new word to name this kind of case)Eike: thought you might be interested in this one.I wonder if it could be due to a wrong fix from me for tdf#91273 (see)I'll give this a try ...Katarina Behrens committed a patch related to this issue.It has been pushed to "master":tdf#93437: Re-enable input after closing formula wizardIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Eike Rathke committed a patch related to this issue.It has been pushed to "master":Revert "tdf#93437: Re-enable input after closing formula wizard"It will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Katarina Behrens committed a patch related to this issue.It has been pushed to "master":tdf#93437: Calc RefDialogs were never actually destructedIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Katarina Behrens committed a patch related to this issue.It has been pushed to "master":tdf#93437: release reference held by ScFormulaReferenceHelperIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Katarina Behrens committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#93437: release reference held by ScFormulaReferenceHelperIt will be available in 5.0.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.This was a tough one. Let's set it to fixedVerified on version 5.0.2.0+ build at home under Ubuntu 15.04 x86-64 with GCC 5.1.Version: 5.0.2.0.0+Build ID: d92c8638a186900711faa88be5bed254b0574712Ubuntu_15.04_x86-64Locale : fr-FR (fr_FR.UTF-8)Thank you very much.JBF***has been marked as a duplicate of this bug. ***Same problem now with the latest 5.0.1.2 version on Windows 7 SP1 64-bit. One way to get functionality back is to add / delete row, column, or cell.(In reply to Ari Latvala from)It's fixed from 5.0.2 (5.0.2 is after 5.0.1.2)Fix verified with version 5.0.2.2 (Win 7). Is OK now. Hence bug closed.
id=93761	Createdinstallation error windowI tried to update from the first x64 5 release to the second release. It failed with an error 1303, the installation procedure could write in the LibreOffice 5 program directory.I could not install the previous version either (same error), and deleting the program folder was impossible to (Damned Windows 10...)So I'm left with no LibreOffice at all :-) Hi Dirk, thanks for reporting.Please take a look to this thread.Resolved as notabug, please if you are not agree reopen it.Thanks for your reply.First of all, I never had to use admin privileges, so this behaviour is different from the many updates I installed before.Secondly, Windows 10 has no "Install as Administrator" option, so that solution doesn't work. I found a way to add this option (the fix is meant for Windows 8), but that doesn't help, the same error.()The elevated administrator account is disabled by default in Windows 10. I enabled it, didn't work either.Even if solutions like these would work, I'm sure you will agree it's not the way consumers should install an office package.Since a first install seems to work, I tried to remove the whole LibreOffice 5 directory tree.I can not delete the program subdirectory, not even in administrator mode:C:\Program Files\LibreOffice 5>rmdir programAccess is denied.C:\Program Files\LibreOffice 5>attrib -r -s programAccess denied - C:\Program Files\LibreOffice 5\programSorry but I think how to admin system security to install a package is not a not something that LIbreOffice can and must modify. I can install with Win10x64, system ask me to allow the installation but that's all.May be some Win configuration option is creating the issue. User without or with limited rights. I think the level established in User Account Control. From 0 to 3 I have level 2.Delete a program like breOffice by hand it's not the way.To remove a program there is as option in the system configuration for Aggregate and Remove programs, where to select the program and remove it, it works fine for me with LIbreOffice.The problem to remove folders, may be is the same limitation than for install or if some LibreOffice program is running in background, the system doesn't allow remove the program file and of course any directory in their path.Perhaps trying to install with a new administrator user, if working in it, could help you to find the differences in the user's rights.This was an upgrade from a previous LibreOffice 5 installation. That installation went fine, no problem what so ever.If I install the package as administrator, then I have the highest privileges, but that doesn't work either.The upgrade procedure will remove the previous LibreOffice version, and that happened. So there's nothing to uninstall. It has left the LibreOffice 5 directory and the empty program subdirectory. For some reason that directory can not be romoved.After a reboot the program subdirectory was gone. It seems the uninstall procedure tried to delete the program directory, but the delete operation did not complete for what ever reason, and left de program subdirectory in an unknown state.Anyway I also deleted the LibreOffice 5 directory, and then did a new attempt to install the new version, and this time I succeeded.Anyway, the procedure you advised in your first reply is not possible for Wind 8, 8.1 en 10. There is no install as administrator option !!As you like, but in any case it was not a LibreOffice bug.Well, the install procedure of the new version calls the uninstall procedure of the previous version. I have the impression that the uninstall procedure wants to delete the program directory, and that went wrong. Maybe it was an unfortunate coincidence, a timing problem, I don't know. But the fact remains it did happen in the install procedure of the new version.The problem remains. When I am going to install a new 64 bit version of libreoffice, I will first remove the old version (with Program remove from Control Panel).The program folder in the libreoffice 5 folder will still be visible after the uninstall, but it can't be used or deleted.After a reboot the program folder is gone, and I can install a new version of libreoffice.My previous comment was 5.0.4. I had to remove 5.1 (had to go back to 5.0.5), and that went fine. Even the Libreoffice folder itself was removed!!This looks like a duplicate ofafter reopening.This behaviour is still present in 5.1.3.2Windows 7, both 32 bit & 64 bit, running as privileged user, not administrator.Either after uninstalling first, or attempting to upgrade a previous version.As noted by others, solution is to reboot to remove the rogue \program directory.*** This bug has been marked as a duplicate of***
id=31304	Hello,Windows XP fully up to date.I downloaded LibreOffice today. First I uninstalled OpenOffice 3.2 (I think, it was up to date) and then installed LibreOffice. I got the following message upon starup...LibreOffice 3.3 - Fatal ErrorThe program cannot be started.A general error occurred while accessing your central configuration.I then re-ran the installation and chose repair. This time I put my Online Armor firewall in learning mode just in case it was hindering. The installation also required a system reboot this time, but not the first. I am still got the same message.I then tried to open it using an existing .ods file. Got the same message.If I can tell you anything else, please let me know. Hi i not dev or something but in your place i will check this:1) I have installed JRE/JDE?2) I run installation from admin account (with his privileges)?3) Your AV my case problem (i have Kaspersky IS 2010 and when i installing i must add to trust - ofc after virus saning and check sums :).Cy.Cy,Thanks for the thoughts. I do have Java installed (Oracle branded, maybe I need to look for another. I seem to remember IBM having one). I re-ran the install in Administrator mode, with the anti-virus (Avast, cannot be turned off, but the active modes can temporarily be disabled, which I did) and the firewall in learning mode. Reboot required again, and when I got back in, same result.Thanks again,KevinOk try this, brows to C:\Documents and Settings\<your_name>\Application Data\ and delete, or zip old folders OpenOffice.org, remove LibereOffice and tray again - this bug is sometime case by old plugins.And remove JRE/JDE from your OS in standard version you have tested JRE - ofc. after installation if will run you must select Tools -> OPTIONS/Preferences -> LO- > Java and restart( actually I using 1.6.0_22 version)-cy.Cy,Ok, I gave this a try. Uninstall LibreOffice. Uninstall Java. Searched C: for any office related files/folders and deleted. Rebooted into Admin mode. Installed LibreOffice. Installed Java (both with firewall in learning mode and anti-virus disabled). Same result.Thanks for the try.KevinI think this my case by:1) Avast, try boot in rescue mode -> after BIOS press F8, it will give two (or more) windows options. one is normal and another one is "Microsoft Windows XP Professional"(Rescue Mode) chose this and tray run LO in this spartan resolution and video acceleration.2)You may have corrupted memory test with this using USB key :or other :3) You can also check your installation filesi Used LibO_3.3.0_beta2_Win_x86_install_multi.exe 6fcd0216b34bd7f18b2caf59f21d702e LibO_3.3.0_beta2_Win_x86_install_multi.exeOr Use bittorent to check integrity :Cy.Cy,I found the issue. LibreOffice worked in safe mode. I ran memtest 4.10 (something I already had) for one full pass, no errors. I then went back into regular Windows and using Task Manager, shut down everything that will shut down (something I do regularly to run MS Flight Simulator for extra memory). LibreOffice then worked.After rebooting, I tried shutting things down one at a time, and trying LibreOffice after each. Online Armor firewall was the culprit, even though I had allowed the install and used learning mode, which should have auto created rules. After some working with the firewall for some time, I managed to get it to agree that LibreOffice was OK. It is now working.It took more than just allowing/trusting soffice.exe and soffice.bin. Each of the different parts (calc.exe etc.) had to be allowed.Thanks for your assistance,KevinClosing Sophie
id=31624	On windows the default install of LibreOffice is not able to load the Flat XML variants (.fodt, .fods, .fodp, etc.) of the ODF files. Please include the requried XML filter and respective file associations with the default install of LibreOffice. For Fridrich?Should we make that XSLT filters included by default (but unselectable)? Will that have any potential negative effect, do they include some broken or usually unwanted functionality? If so, should we move out the flat XML stuff into a component that is included by default?My Server installation of Master "LibO-dev 3.5.0 – WIN7 Home Premium (64bit) English UI [(Build ID: 81607ad-3dca5fd-da627d2)]" has flat.xml filters by default, "LibreOffice 3.4.3 RC2 - WIN7 Home Premium (64bit) German UI [OOO340m1 (Build:302)]" has not. I will check whether tat is an extra option for the installation.@Alex, inpost:Results here might be relevant for.[Reproducible] with "LibreOffice 3.4.3 RC2 - WIN7 Home Premium (64bit) German UI [OOO340m1 (Build:302)]". I modified installation and added xslt filters, but FlatXML still is not assigned to LibO. So those .fodx documents can't be opened from WIN Explorer without problems, but opening via LibO file dialog works without problems (I tested for .fodg).I do not know whether it's planned to install XSLT filters by default, but if the will be installed (also for customized installation) filetype association should be done.Yes, please. I am involved in a project that generates Flat ODF files (.fodt and .fodp) and out-of-the-box support of these file types greatly benefits our use-case.Since all new unconfirmed bugs start in state UNCONFIRMED now and old unconfirmed bugs were moved to NEEDINFO with a explanatory comment, all bugs promoted above those bug states to NEW and later are automatically confirmed making the CONFIRMED whiteboard status redundant. Thus it will be removed.issue is still present on win32 xp, with:LOdev 3.5.0beta2 Build ID: 8589e48-760cc4d-f39cf3d-1b2857e-60db978This is still a problem in LibreOffice 3.5RC2. Because of this Windows users cannot open or export Flat ODF files.Can we please fix this ASAP (preferably before the release of 3.5.0) ?For people having this same issue, you can enable Flat ODF in your LibreOffice installation by rerunning setup and modifying the installation to include: Sample XSLT FiltersSo: setup.exe -> Modify -> Optional Components -> XSLT Sample FiltersShould get you the required filters for using Flat ODF files, but the related file-associations are still not there. The above configuration should become the default on Windows !!Can someone verify this ?I tested on a Windows 7 with the above procedure to enable XSLT Filters and the file associations seem to be there with LibreOffice 3.5RC2, however the XSLT Filters are still not enable by default...<>I understand that it is annoying, so it is perfectly fine to mention it in the most annoying bugs.On the other hand, this is very old bug, workaround is easy => it can't block the 3.5.0 release => lovering severity a bit.Fridrich, any chance to fix this for 3.5.1?(In reply to)It is already fixed in 3-5, now the XSLT filter is default component on Windows.If we need to do another rc, maybe it would be nice to include, but I don't vote for it to be blocker for 3.5.0 if no other stuff pops up.I have described the workaround at. I agree that it should not block the release => closing as fixed.
id=33368	1.- Open the attachment2.- Make a slightest modification (or Saves As)3.- Save (yes to keep current format)4.- Progress bar (bottom) hangs indefinitely. Have to kill process.Right before the progress bar it says: "Exporting document"I also noticed that if you delete the first reference in the second page-[1] J. Smith, Proc. of the 1993 Electronic Components and Technology Conference (ECTC), Atlanta, Georgia, August 12-15, pp. 21-33, 1993.-it saves the document without problems. Createdlibreoffice hangs when "exporting" this attachment[Reproducible] with sample doucment and "LibreOffice 3.3.0 RC4 - WIN7 Home Premium (64bit) German UI [OOO330m19 (build 6 / tag 3.3.0.4)]" on 64 bit AMD Phenom II X4 955 Processor 32.2 GHz, 4GB RAM, Graphic Card: NVIDIA GeForce GT 430Also that the hang disappears when reference will be deleted is reproducible.and worse still the rc ( 9 I guess ) I downloaded from openoffice last week doesn't seem to fail :-/CreatedStack trace of the freezeI have experienced the same problem on Windows 7 64bit with my own files.Affects me too, Ubuntu 10.10 / amd64. Cannot save to doc or save a docx***has been marked as a duplicate of this bug. ***This loop has been fixed in master branch in the meantime by this commit:Could anyone review it for integration in libreoffice-3-3 branch?caolan, approved the fix for 3.3 on IRC. Cherry-picked it.***has been marked as a duplicate of this bug. ***Confirm! Can not save in Write file *. odt with complex formatting as *. doc.If you do not close Write by hand (kill the process soffice.bin) the process of saving *. odt as *. doc will take all the free disk space.In OpenOffice.org Write it is working correctly - saving *. odt as *. doc *. odt as *. doc. is OK.LibreOffice 3.3.0 finalOS: Linux (Ubuntu 10.04)RUS: LO Write: виснет при сохранении документа .odt в .docПри сохранении сложноформатированного (многостраничного) документа .odt в .doc Write виснет. При этом, если не завершить процесс Write вручную, он "забьет" всё свободное пространство диска.
id=33658	Calc1.Input "2011/1/30" in A1,then format the cell2.In Format Cells dialog's Number Tab-Category:Date,Format:中華民國88年12月31日3.The result should be"中華民國100年1月30日",but it display "中華民國00年1月30日",the year bigger than 100 can't display correctlyWriterThe same problem in Fields dialog's Fomat *** This bug has been marked as a duplicate of***
id=32709	Created2007 PPTX Format Sample Document Created by LibreOffice RC1Hello!I use LibreOffice in my daily work, but I have to exchange documents with MS Office formats (mainly .doc/.xls/.ppt) because all others use MS Office (mainly 2003). So I pay very much attention to try to reduce incompatibility at the utmost.Yesterday I found a problem which LibreOffice has but OOo/Go-oo don't have.The .ppt/.pptx documents created by LibreOffice (both of RC1 and RC2 for Windows and Linux) can't be opened by Microsoft PowerPoint Viewer (with the support of 2007 formats) and Micrsoft Office Web Apps.MS PowerPoint Viewer says that the documents have a problem.MS Office Web Apps warns that the .ppt documents have a potential security problem ("PowerPoint Web App cannot open this presentation because it may contain malicious content. To view or edit this presentation, open it in Microsoft PowerPoint.") and the .pptx documents are broken ("PowerPoint Web App cannot open this presentation because of an error. To view or edit this presentation, open it in Microsoft PowerPoint.").However, MS Office PowerPoint can open these documents.The .ppt/.pptx documents created by OpenOffice.org/Go-oo can be opened by both of MS PowerPoint Viewer and MS Office Web Apps without any warning.LibreOffice RC2 has an other problem about converting an .odp document to a .pptx document. An .odp file of about 500 KB (with a column chart generated from a data sheet) is saved as a .ppt file with the similar size, but it will be saved as a .pptx file with more than 6 MB. (Sorry, I can't attach the specific document.)Thanks for all people's efforts to launch and improve the great project! CreatedPPT Format Sample Document Created by LibreOffice RC1I have the 2 files a try in Microsoft PowerPoint Viewer 2010.The ppt file problem is reproducible, while I can play the pptx file with viewer.In addition, open the ppt file with MS Powerpoint and save it again, the PPT Viewer is able to play it. So It would be something different in the LibO version ppt.(In reply to)My ideal is to completely abandon MS Office. I like open-source software and free software, not because they are free of charge but because I love freedom.For exchanging documents with others, I have to pay attention to keeping the layout of the documents with MS Office's proprietary formats. I only use the free tools, MS Word/PowerPoint Viewer and MS Office Web Apps, to know whether the documents are compatible. As for "open the ppt file with MS Powerpoint and save it again", MS PowerPoint of course can open it, but MS PowerPoint Viewer and MS Office Web Apps can't open it. If I need to view the layout, I should find a computer with MS Office? How to let others accept LibreOffice and be free from dependence on MS Office?OpenOffice.org and Go-oo don't have the bug, but I still hope that LibreOffice will be better.LibreOffice 3.3.0 RC3 has the bug, too.(In reply to)OOO330m19 (Build:202) has the bug too, but OpenOffice OOO330m20 (Build:9567) does not. If I save a file in LibreOffice Impress and try to open it in Powerpoint, it complains - "Office has detected a problem with this file. To help protect your computer this file cannot be opened."If I open the same file in OpenOffice 3.3.0 as above, and then resave, it opens in Powerpoint viewer without any problem or error message.Open the OOo generated ppt file again in LOo and resave and the same message applies. "Office has detected a problem with this file. To help protect your computer this file cannot be opened."Reproducible with the .pptx file but NOT the .ppt file.Running:LO 3.3.2 releaseVista SP2 x86.(In reply to)@Zack - What Microsoft product are you using to open the ppt file?(In reply to)I'm using the Microsoft Office PowerPoint viewer.I'm sorry first of all not to be able to supply the documents themselves (business stuff I can't post). I'm working on getting a version I can strip somehow of data and make it reproducible. The problem is that after opening a .ppt document in libre office, powerpoint opens it but hangs as soon as an edit is made. We have worked around this by uploading to google docs and saving once more from there. On #libreoffice-dev I was told to check if it has any grouped drawings, but it doesn't.This bug has still been active through LibreOffice versions 3.3.2 (including release candidates) and now 3.4b1, 3.4b2 and 3.4b3. It is not and has not been an issue with any OpenOffice releases as far as I am aware - I have tested it on OOo3.3.0, OOo3.3.2 and OOo3.4b1. Obviously something has changed in the LibreOffice file .ppt format that hasn't changed in OpenOffice.The error message I get is this "Office has detected a problem with this file. To help protect your computer this file cannot be opened."The bug is *definitely not* to do with grouped drawings, but rather to do with a Microsoft security update called "Office File Validation" that refuses to open files that aren't precisely to its specification.See the following links;And these ones particularly link this issue to the error message I receive;CreatedImpress Export Test (ODP)This file is a test ODP file generated by LibreOffice 3.4b3.CreatedImpress Export Test (OOo 3.3.0 ppt)This file is an export of the test odp to Powerpoint 97/2000/XP format. The export was done in OpenOffice 3.3.0 release. It opens fine in Powerpoint viewer 2010 (up to date patches).CreatedImpress Export Test (OOo 3.4b1 ppt)This file is an export of the test odp to Powerpoint 97/2000/XP format. The export was done in OpenOffice 3.4b1. It opens fine in Powerpoint viewer 2010 (up to date patches).CreatedImpress Export Test (LibreOffice 3.4b3 ppt)This file is an export of the test odp to Powerpoint 97/2000/XP format. The export was done in LibreOffice 3.4b3. It fails to open in Powerpoint viewer 2010 (up to date patches), giving the error "Office has detected a problem with this file. To help protect your computer this file cannot be opened."(In reply to)This file was designed to be an extremely simple test case, but the ppt files saved from it in LibreOffice still exhibit the problem. No macros, no fancy templates (using the default "Title slide" template on the top right in Impress), just straight text. I didn't do any formatting, not even changing the default font, just typed the text and saved.Radek, could you please have a look?Yup, I will look at it.Yike, please could you also attach pptx version saved by Go-oo? I would like to check what changed meanwhile.I also created a simple test file (one slide) on ODP format. I opened it with Go-OO and LibreOffice and saved as PPT/PPTX. I tried to them in PowerPoint Viewer 2010.Go-OO 3.2:save as PPT - OKsave as PPTX - OKLibO 3.3.2:save as PPT - errorsave as PPTX - OKLibO 3.4rc1:save as PPT - errorsave as PPTX - can't save to PPTX, Write ErrorI modified Status due to facts.The problem was already in 3.3.x release. Presenters usually do the presentation themselves, so they have MS Office at hands => can't block the 3.4.0 release => reducing the severity a bit. We will do our best to fix this for 3.4.1.It seems to me that this is fairly important as it affects every ppt someone emails to someone else. I would personally view it as a blocker. It was enough of an issue for me that I am currently using OOo 3.4b instead of LO, and have given disks of OOo to several friends who I had installed LO for.It also seems to me that it shouldn't be hard to find what is causing this, as some patch has been applied within a fairly short time frame to introduce this regression before the first release of LibreOffice, it only affects a fairly particular component, and whatever patch was applied was not applied to OpenOffice or Go-OOo.So in my view it should be possible to look at all the patches applied to powerpoint exports in the time shortly before LO, and compare which of these have been applied or not to OOo. If someone has access to both code bases and knows how to build LO, you would possibly have to test no more than 5 patches (a guess) to eliminate which has caused this. I used to do this for Inkscape all the time, but unfortunately I haven't got the time to get up to speed for LO/OOo.PPTX files saved from Go-OO 3.2, LibreOffice 3.3.2, LibreOffice 3.4 rc1 all open in MS PowerPoint Viewer 2010. None of those PPTX files open in MS Web Office. This is bug#1: PPTX files saved from LibreOffice do not open in MS Web Office (corrupted contents).PPT file saved from Go-OO 3.2 opens both in MS PowerPoint Viewer 2010 and MS Web Office.PPT file saved from OOo 3.3 opens both in MS PowerPoint Viewer 2010 and MS Web Office.PPT file saved from LibreOffice 3.3.2 opens neither in MS PowerPoint Viewer 2010 nor in MS Web Office (malicious content).PPT file saved from LibreOffice 3.4 opens neither in MS PowerPoint Viewer 2010 nor in MS Web Office (editing error).Error message in MS PowerPoint Viewer 2010 was always "Office has detected problems with this file. To help protect your computer this file cannot be opened."This is bug#2: regression: PPT files saved from LibreOffice 3.3 and higher cannot be opened in MS PowerPoint Viewer 2010 and MS Web Office.PPT file saved from either LibreOffice 3.3.2 or LibreOffice 3.4 rc1 can be opened in MS PowerPoint 2010 with this warning: "Office has detected a problem with this file. Editing may harm your computer." PPT file saved from either OOo 3.3 or Go-OO 3.2 opens without warning. All test PPTX files open in PowerPoint 2010 without warning.I dumped valid and invalid ppt files and I found that in the invalid file the \x05DocumentSummaryInformation stream was corrupted. When I renamed the stream with hexa editor in order to programs ignore it (\x05DocumentSummaryInformation stream is optional), then the file opened in MS PowerPoint Viewer 2010 and in MS PowerPoint 2010 without warning. Now we need to find out what went wrong with exporting \x05DocumentSummaryInformation stream in the code.@ Petr MladekYour comments don't hold water.What often happens is that presenters give their presentations to someone on a memory stick or CD and they have to hope it is compatible. In other cases people use software to present that integrates lots of individual elements/presentations into a larger run sheet/schedule program that will often use Powerpoint or Powerpoint Viewer as the presentation engine, even if it's behind the scenes of another package. See for example screen monkey, which is merely one example of a whole category of presentation software that is all about the scheduling side of things, but which uses Powerpoint behind the scenes.It seems that TDF are currently looking for corporate backing, but a big company will not back a product that fails to do the most basic functions. To companies, and to individuals, interoperability is a very strongly held ideal. Isn't it one of the key founding principles of TDF? Well, it seems only on paper...(In reply to)I was aware of this.This is not true. Please note that LO has switched to time based releases. You might read the following at:--- cut ---The time based release makes happy all type of users. Enthusiasts start using X.Y.0 releases with lovely new features and known bugs. While more conservative users are later attracted by the frequent pure bug fix releases. Even the most conservative users is satisfied by a later bug fix releases, e.g. X.Y.3. --- cut ---This bugs is the 6th most important bug in the list of most annoying bugs. I am pretty sure that we will fix it before LO-3.4.3 release. I guess that corporate users are the most conservative ones. They need to wait for 3.4.2 or 3.4.3 anyway.Radek, any chance to get this fixed for 3.4.2?I have fixed it just now in master branch and will send for review.I have fixed the PPT export, if I understand it correctly the PPTX export was OK. Please test and let me know if you still experience problems.Createdversion exported with build from master branchThanks Radek! Your attached file seems to open fine for me using Powerpoint Viewer 2010. Very much appreciated!Can someone please push this fix into 3.4.2 RC4? Sadly it's not in 3.4.2 RC3...This fix works well in 3.3.4 but has still not been merged into 3.4.3 RC1(In reply to)I see the fix on 3-4-3 branch so I wonder why do you think it is not merged in 3.4.3 RC1. What build do you use and how do you test it?My apologies. I thought I had tested this using the latest RC, but obviously I hadn't, and I also didn't see a mention of it in the change logs for any of the 3.4.3 builds.Thank you again for your help.This bug is listed as fixed for LO 3.4.2 under libs-gui on pageWhen I open your attachment 48941 of 2011-07-11 with LO 3.4.3/OOO340m1 (Build: 302) for Windows (running on XP SP3) and save it as .pptx, I get a file that can not be opened with either PowerPoint Viewer 2007 (published 12/3/2007) or PowerPoint Viewer 2010 (published 5/5/2010).CreatedIET.ppt, IET.pptx, IET2.pptx3.5.0.b2. all tests on Windows XP SP3.(IET is an abbreviation for "Impress Export Test", the actual name of the file)1. Opened IET.odp example of 2011-04-29 17:20 PDT, rygle and saved as IET.pptx 2. Opened IET.odp example of 2011-04-29 17:20 PDT, rygle and saved as IET.ppt3. IET.ppt file opened with MS PowerPoint 20034. IET.pptx would NOT open with MS PowerPoint 2003 (with 2007 extensions, which let it open most .pptx).5. IET.pptx does open with MS PowerPoint 20106. save from MS PowerPoint 2010 to IET2.pptx7. IET2.pptx does open with MS PowerPoint 2003 (with 2007 extensions).The three files are in the .zip attachmentI'm affected by this bug.appears to be a duplicate.In attached test kit you find results with various exports from "TestPresentation.odp" to MS presentation documents with "LibreOffice 3.5.2.2 German UI/Locale [Build-ID: 281b639-6baa1d3-ef66a77-d866f25-f36d45f] on German WIN7 Home Premium (64bit).Most documents can not be opened with my PP-Viewer (version 12.0.4518.1014), only successful for PP2007.pot, PP2007.pps, PP2007.ppt.PP-Viewer also was not able to open document exported from LibO 3.3.0But this partially might be a MS PPV problem. I updated to Version 14.0.4760.1000 and now at least it worked for document exported from LibO 3.3.0, but other documents still can not be opened.Unfortunately I can't tell whether this problem is caused by exactly the same roots as the problem in original report.Modified Version due to;@:<> 3.4 lifecycle is terminated, so shift to “LibreOffice 3.5 most annoying bugs”@drhatch:What information can you contribute confirming that the old problem reappeared / is unifixed and not a new one additionally causes problems? I can't indicate a .ppt problem any longer@mathog:"Impress Export Test2.pptx" opens fine with my Viewer.@RadekCan you please add Target information to Whiteboard for your fix (I believe target:3.5.0?).(In reply to)Seconded.Also when you open a Office made pptx document, and edit a side, the document becomes corrupt.When open the corrupted document, Office is only able to recover the slides which libreoffice didn't touch.According to many users this will mean data loss.Radek, All: I have been experiencing the problem with LO saving .pptx files in a format unreadable by MS Office. My belief is that it has to do with PPT documents containing OLE objects. LO has made huge advancements in 3.5 release to read OLE objects (e.g. charts created in excel/calc), but it is not currently writing them back in a format that MS Office (or Google Docs) can read. I have some example documents that I will upload shortly that clearly illustrate the problem.OOO doesn't have the problem because it can't read those OLE objects properly in the first place, so doesn't make any mistakes writing them back!!-RSBut this problem persists even there're no OLEs in the document.Hi,Yes, this problem happens with documents containing OLE objects, and documents without OLE objects alike.I have attached the follow four test presentations:1) The original - "Test presentation - original.pptx" - this opens in MS Office for Mac 2008, and in LO 3.5.32) The original opened in LO, and reserved by LO without making any changes (as MS Office 2007-2010 format (.pptx)) - "Test presentation - original - saved by LO.pptx". This does NOT open in MS Office - I get the error "Powerpoint cannot read the presentation ...", followed by "Powerpoint cannot open ... because part of the file is missing"3) The odp version of the presentation, saved by LO - - "Test presentation - saved by LO.odp". 4) I finally opened the odp in 3 above in LO, and saved as .pptx in LO (2007-2010 format) - "Test presentation - first saved as odp, then reopened and saved as pptx by LO.pptx". This file now opens in MS Office but I get errors for slides 2 and 3 - "Powerpoint cannot read ...". These come up as blank sides, slides 1, 4 and 5 come up ok.CreatedOriginal MS Office pptx presentationCreatedoriginal MS Office pptx resaved as pptx without changes by LOCreatedODP version of the document, converted by LOCreatedPPTX version of the document, created by opening the ODP version in LO (from the previous step), and saving-as MS office 2007-2010 (pptx format)Looks like there're no volunteers to fix this since more than a year.Can this feature be marked experimental? Otherwise the market share of LO is going to downgrade from 5% to 0.5%.Way to go:Looks like it's best to edit a (XML) file that exhibits this bug manually to remove one line after the other until the Problem ceases to exist, then we know what the part looks like thats the trigger.But in order to do so, I need some kind of ,,Lossless'' Editor that can edit pptx files on a xml level and does only change things you intend to change, so i need a program which can do this, best a one that only decompresses the files to plain readable XML text and back, and for the case that it turns out to be an error on the compression level it would be helpful if that program would be open source... and LEAN! (in this case, such a finding could be a step forward anyway...)Does somebody know such a program he could recommend to me?It may happen that its NOTOURBUG but we must find it out.I have looked at this bug again, but didn't found anything wrong with validator and 2010 MSO loads the IET.pptx file fine. Unfortunately I don't have MSO2003 at hand.I have fixed similartoday, so there is a slight chance it might help with 2003 issue as well. No way to test it here.Lennard, if you want to try edit pptx, emacs works nicely for that. What I usually do is I 1st unpack the pptx file, so that I reformat it nicely with xmlint, I do it with fxreformat function (put this in your .bashrcfxreformat() { find | egrep '\.(xml|rels)$'|while read i; do xmllint -format $i > $i.new; rm $i; mv $i.new $i; done}), run fxreformat in unpacked directory and pack it again. Then I just open the archive in emacs and edit it and save it as I need.Arrgh, I'm such a fool, I didn't know that theyre zip files.(This solves my request, of course)However, just unzipping and rezipping it with winrar didn't change anything.I'm doing tests on it - Can you mail me your pathch forso that I can use that patch in my tests? I got WinXP sp3 openXML converter which strangely says ,,The file couldn't be saved by the converter''.(In reply to)Actually, why cant a text editor be used?(In reply to)The patches are here:It seems also Powerpoint 2010 Professional seesas corrupted.(but can restore it)CreatedMinimalist file recovery from bugCreated a pptx file with MS Office Professional 2010, resaved with libreoffice using your 3 patches, Radek (as pptx). Opens cleanly in LibO 3.5. Opens cleanly in MS Office Professional 2010. Wont open in MS Open XML Converter. (Says: the file could not be saved, as always).I attach two files. One is the one directly saved with Libre Office, the other contains all changes I had to make until *MS Open XML converter* accepted it, namely:1. renumbering some rID's in >>presentation.xml and presentation.xml.rels<< not to start at 2 but 1,2. renumbering <p:sp> <p:cNvPr id='s (who started at id="0") to higher numbers in slidemaster1.xml and slidemaster1.xml.rels3. Excluding the twelveth - and LibreOffice created! - slideLayout12.xml from the r:id="rId<...>" enumeration. Libo_resaved_patched.pptx THIS attachement is the DAMAGED formbest_repair.pptx The most minimalist repair effort I tried that succeeded.I couldn't repair the file by just REMOVING the added slideLayout12.xml from the references, or substituting it with a modified slideLayout3.xml.That means, there must be something going bad with the numbering.By the way: I couldn't save the MS-Originated pptx file (not included) as ppt with Radek-patched LO! not even with .odp in-between.By the way, >>noch heil<< means >>still intact<< in german, not something evil.In the latest master of LO, writing .ppt files (by saving an MSO 2010 Originated pptx file) returned an error that the file couldn't be created.The error had not occurred when using some ?branch? where the stem directory was called ,,libo'' instead of ,,core''. (don't know how I got that).That file could be opened by MS Power Point Viewer 2010 without trouble.With that same version, the repectively saved pptx file returned an error in XML converter.but right now, you cant save a .ppt file that WAS originally a MSO 2010 pptx file.greetingsCreatedAnother exampleI am also seeing this bug in 3.5.4.2. I've added another attachment in hopes that this will help the debugging. These are some slides that I originally did in MS Powerpoint 2008, but I later edited in LO 3.5.4.2 and Powerpoint is not reporting them as corrupted in both the Mac and Windows version. The corruption does not appear on the first slide, but instead one of the later slides.Thanks for your work on this bug. It is essentially blocking me from using LibreOffice and Linux for my lecture prep.Dont restrict the occurrences. It is known to fail on windows and 32 bit, too!Currently I am trying to fix this export issue by searching for incompatibilities that make differences in the content. Maybe that will solve it anyway, but as soon as I learn enough about numbering, I will try to change something about numbering as this obviously solves the export issue, but maybe that just hides that the real problem is somewhere else.By the way, do we neeed to set it on the latest version? the we could -perhaps - set it to 4.0, too, I am afraid...It is true that the version number entered should show the FIRST occurrence, isnt it?(In reply to)No.This problem doesn't persist with 3.6.4.3(In reply to)>So you say it is fixed for you starting 3.6.4.3 ?(In reply to)Yes.Due to the last comment I am marking this as RESOLVED - FIXED. Usually we would put WORKSFORME as we don't know the patch that fixed the issue but so many people confirmed that it was an issue on 3.5 series that FIXED seems more accurate.3.5 is at end of life so whatever fixed the issue in 3.6 will not be ported back to 3.5 series. Thanks for confirming that the issue is resolved.
id=33858	No saves in Microsoft Word 97/2000/XP - hangs ...In the Open Document (ODT) format saves great. Please provide more information. It would also be helpful if you could attach the odt file which when saved as .doc is hanging.You can useas a referenceThank you.May be a duplicate of*** This bug has been marked as a duplicate of***Thank.Confirm! Can not save in Write file *. odt with complex formatting as *. doc.If you do not close Write by hand (kill the process soffice.bin) the process of saving *. odt as *. doc will take all the free disk space.In OpenOffice.org Write it is working correctly - saving *. odt as *. doc *. odt as *. doc. is OK.LibreOffice 3.3.0 finalOS: Linux (Ubuntu 10.04)RUS: LO Write: виснет при сохранении документа .odt в .docПри сохранении сложноформатированного (многостраничного) документа .odt в .doc Write виснет. При этом, если не завершить процесс Write вручную, он "забьет" всё свободное пространство диска.
id=33970	I installed LibreOffice 3.3 on a standard image with Windows XP SP3 for a small private school. I am able to run it as a non-administrative user before it's joined to a domain. Once I join the machine to the domain, a non-admin user cannot start LibreOffice; it gives one of two errors:The application cannot be started.[context="bundled"] caught unexpected exception!orThe application cannot be started.[context="user"] caught unexpected exception!with the second error being more common. I did not modify the selection of components to install; I used the typical installation. The standard image used to have OpenOffice 3.3 installed, but I did a clean uninstall of OOo before installing LibreOffice.Some online research shows that other people are having the same problem. For example, see.For reference, OpenOffice 3.3 has exactly the same issue.My environment has roaming profiles and redirected folders. I've not yet tried messing with group policy to see how LibreOffice reacts; I plan to, but I wanted to open the bug ASAP. I will eagerly try whatever ideas you have, as the private school would love to get LibreOffice working. Issue report for OOo:Tor, any idea what could be the problem?I quote from the OOo issue: "It looks like a problem related to theUNC path used for the user profile within the deployment library which isresponsible for extensions."***has been marked as a duplicate of this bug. ***I can confirm this bug (WinXP Pro SP3). Everything works nice when using a local sysadmin profile, however usage of a roaming profile triggers the two exceptions listed above. The issue persists in LibO 3.3.1 RC1.Having reviewed the list of other blocker and critical LO bugs, I've raised this issue's importance.On a related note, the equivalent OOo bug has been marked to be fixed by OOo 3.4.It would be nice if we could fix this in 3.3.2. Does anybody know a way to reproduce it on a non-domain-member machine?Tor, not sure about that, but here's an alternate approach: teach me to build the source from git for the Windows platform. Assuming the issue was introduced sometime during LibreOffice's lifetime, I could bisect to the offending commit.Or, build me the first revision from git and I'll try it.Right now I cannot find any build-for-Windows instructions on libreoffice's site.andshould get you started. Then come to the IRC channel #libreoffice on freennode, or ask specific questions on the libreoffice mailing list. We very much want to help people in learning to build it!I have done some testing with the following betas of LibO 3.3:- beta 1 (2010-09-27, OOo330m7, Build 9526, OOo-build 2010-09-24)- beta 2 (2010-10-11, OOo330m9, Build 1, libreoffice-build 3.2.99.2)- beta 3 (2010-11-15, OOo330m12, Build 2, libreoffice-build 3.2.99.3)All of them start-up normally in a local user context but produce the errors described above when used with roaming profiles. In addition, beta 1 sometimes gave the following error:The application cannot be startedA general error occurred while accessing your central configurationTo me this suggests that this bug was probably introduced before the OOo/LibO fork, which would be in line with OOo330 facing the same problem.This bug still exists in LibreOffice 3.3.1 RC2 (2011-02-18). This is sad that it existed in 3.3 final release. It is very disturbing that it exists in RC2 for another release. I am happy to test out nightlies or what not. I have several domains with XP SP3, Vista (latest SP) and 7 (latest).I would help with the code/build, but it has been ages since I had MSVC setup on any machines and used it.No need to point out that the bug has not been fixed; if it had, we (developers) would have marked it as fixed here.Nobody can figure out a way to reproduce the problem on a non-domain-member machine (but with other Windows machines in the same workgroup, if needed)? That would obviously be very useful so that this can be debugged.Due to the fact that the bug seems to be with roaming profiles, I am not sure you can reproduce it any other way. I am using Samba 4 for the server if that is the problem. If it is because you don't have Pro/Business/Enterprise/Ultimate clients, I am not sure how to go about doing it.Many of the people who would be interested and capable of debugging this, including me, have access to MSDN, so if really really necessary, sure, I can set up a domain between two virtual machines. It's just a pain to do just for some debugging of what no doubt turns out to be a very easy to fix error once you find the root cause.Hmm, actually, I might have a domain set up in a vmware virtual machine running Windows Server 2003 I haven't started for ages, will have to check. I could then set up roaming progiles, however one does that (I don't have any Windows domain sysadmin experience), and join another virtual machine to that domain, and debug LibreOffice on that. But that will have to wait until I get back from vacation next week.LibreOffice 3.3.0 and 3.3.1 gets fatal error if %appdata% is redirected.Also happens with OpenOffice 3.3.Only happens if the user never started LibreOffice before %appdata% wasredirected, the user has no problems if LibreOffice was started before %appdata%was redirected.Seems like the problem lies in %appdata%\LibreOffice.I have tried to rename %appdata%\LibreOffice on a user that LibreOffice wasworking for (did use LibreOffice before %appdata% was redirected), thenLibreOffice generated it again and Fatal error.Put back the working %appdata%\LibreOffice folder and everything works.Have tested this on Windows 2003 and 2008 R2 terminal servers.***has been marked as a duplicate of this bug. ***(In reply to)I can confirm this. I changed the group policy to redirect Application Data back to the user's profile (while leaving all other redirections in place), and the problem is solved.So, on a machine that is not a member of a domain, to reproduce the problem, it is enough to set the APPDATA environment variable to a UNC path before starting LibreOffice the first time?just run into this bug on linux after upgrading from 3.3.0 to 3.3.1...something is wrong with my config in .libreoffice may be some locking problem?this suprisingly solved it for me:mv ~/.libreoffice ~/.libreoffice.xxxcp -vax ~/.libreoffice.xxx ~/.libreofficesounds and looks stupid but it now works again 8)i also tried moving it back:rm ~/.libreofficemv ~/.libreoffice.xxx ~/.libreofficeand it stopped working again..my home is on a NFS3 Server so i suggest some locking problem but i don't have the time right now for further investigation..(like tracing NFS traffic or removing files one by one from .libreoffice) ..but i still have my ~/.libreoffice.xxx to test again later..i am using a linux from scratch based distribution with kernel 2.6.35.10 and glibc 2.12.1.. arch=x86_64.. libreoffice is installed using the rpms for 64bit linux downloaded from the official website..may be this information helps solving this bug.. i can provide more information if needed later..bye.. marius tolzmann..i forgot to mention that the problem still existed after downgrading to 3.3.0 again..Marius, whatever problem you have on Linux, it has nothing at all to do with what this bug report is about. This bug report is about a Windows-specific issue. Please file a separate bug.Pål, when you say "LibreOffice 3.3.0 and 3.3.1 gets fatal error if %appdata% is redirected" what do you mean exactly? (I asked the same question to you in the OOo issue, see details there...)I would very much like to fix this, but first I need to reproduce it, on a machine that is not a member of a domain.It's interesting that even if I set an APPDATA environment variable in Control Panel:System:Advanced:Environment Variables, if I then run cmd.exe, it still has the normal value for APPDATA (C:\Documents and Setings\N.N\Application Data , on XP). So is APPDATA treated specially, does cmd.exe override any setting of it in its environment? Does explorer.exe ignore attempts to set APPDATA?If nobody can come up with a way to reproduce this in a non-domain-member machine, could somebody at least give *exact* instructions how to set up "roaming profiles" and "redirected folders" when I have a Windows Server 2008 R2 running with the Active Directory Domain Services role activated, and have joined a XP workstation to that domain. (Both are virtual machines, and yes, I can ping one from the other.)If you want this problem fixed, please at least help me to reproduce it! You who have the problem, can't you ask your sysadmin to write here a step-by-step guide how to set up a minimal temporary test domain with "roaming profiles" and "redirected folders", huh? Or are you attempting to use LibreOffice without the sysadmins knowing?This is from a windows XP perspective. I do not have the updated instructions in front of me:Click Start, point to Programs, point to Administrative Tools (Common), and then click User Manager for Domains or Active Directory Users and ComputersSelect all relevant users, right-click one of the users, and then click Properties.Click on ProfileUser Profile Path type “\\SERVER_NAME\profiles\%USERNAME%” in the box, and then click OK. User Home Path type “\\SERVER_NAME\homes\%USERNAME%” in the box, and drive letter and then click OK. Right click on domain, do new GPO for full domain1. User Configuration/Folder Redirection/My Documents to drive letterDefault Policy/User Configuration/Windows Settings/Folder Redirection/AppDataBasicCreate a folder for each user under the root path\\%FILESERVER%.%DOMAIN\appdataSettings: Grant user exclusive, move contents, also apply to 2000, XP, etc., leave when deletedDefault Domain GPO "Exclude Directories in roaming profile"appdata is a share I setup, btw.Thanks. There were indeed a couple of points there that I wouldn't have realized myself. Will try that out tomorrow. If anybody else has more hints, please add comments!Sorry, forgot a few others %FILESERVER%.%DOMAIN are not real variables. They are just my way of remembering in my own instructions. %USERNAME% is a real one.In WS2008R2, the "Profile" tab of the domain user properties has one entry box for "Profile path", so that should be \\%server%\profiles\%username% as you say inthen, OK. (Where %server% and %username% are replaced with the actual server and user names.) This is fairly clear.Do I need to create this "profiles" share on the server beforehand, and set its owner to the domain user in question? Or is "profiles" some kind of "magical" share name?But then about the "Home folder", it is not so clear. There are two alternatives here, "Local path" and "Connect" (connect a drive letter to what I assume should be a UNC path). You mean I should use the latter alternative? Should I then create the "homes" share you mention and a subdirectory for the user under it, or will it be created automatically when the user logs in to a domain member?I already yesterday had entered into "Profile path" a UNC path to a directory for the user I had created on the server (and left the "Home folder" entries empty), but when I logged in on the domain member machine, it complained it couldn't connect to the profile folder, or something like that. I guess I should try to figure out that first, or will filling in the "Home folder" stuff automatically make that work OK, too?Thanks in advance for any further advice...I think my current problem now is firstly to make it possible for the XP domain member to see and mount shares on the ws2008r2 server... that seems to require some extra trick I haven't figure out yet, I just get error 5 if I try "net view \\server" or "net use \\server\scratch x: /user:foo" where scratch is a share I made as wide-open as possible, and foo is a domain user. Hmm....The homes share is a share I created. For me (XP, Vista, 7) it auto-creates the path for the user when you set it up, but you do have to create the share. And yes, I meant where you connect a drive letter to a UNC.Profiles I think is magic if you are using Windows, but I do NOT know that. I have to set it up manually as I am using Samba 4. (may or may not help as it is where I got a lot of the information, or at least where I started from.)If you setup the paths correctly and they point to valid shares, then everything should automatically work. At least it does here for me.OK, after explicitly creating the appdata\%username%, homes\%username% and profile\%username% folders on the server and making sure that user has max permissions to them and is their owner I think I got it working to some extent. At least I now can log in to the client without warnings.But the AppData is still not redirected, I still see the LibreOffice folder being created in the XP client locally in C:\Documents and Settings\%username%\Application Data .Maybe I really need to set up a Windows 7 client? (Unfortunately the one Windows 7 virtual machine I already have is in Chinese (I once wanted to check how something worked in a Chinese localisation...), and that is a bit hard to use...)Ok, I think you must have failed to setup a GPO that applies to the user in question (mine are all domain wide at this time).In group policy editor do the following (some things may be different if you are setting things up on Windows Vista/7 vs XP, so if the client is XP, do it there, also some locations may be correct for Vista/7, others for XP so you may have to search a bit):Default Policy/User Configuration/Windows Settings/Folder Redirection/AppDataBasicCreate a folder for each user under the root path\\%FILESERVER%.%DOMAIN\appdataSettings: Grant user exclusive, move contents, also apply to 2000, XP, etc.,leave when deletedDefault Domain GPO "Exclude Directories in roaming profile"I think on the local machine it may show things still being in that directory as some of them are remapped, the question is to see if it exists in appdata\%USERNAME% on the server.Check the APPDATA environment variable as well, see if it changed.(In reply to)I have replied in the OOo issue but I reply here too.I mean I have used Group Policy in Windows Active Directory Domain to create apolicy that redirects everyone's appdata folder to the same location, alsocalled roaming.The reason I do this is that we have terminal servers at work and a lot of datais stored at appdata, if we did not redirect appdata it would be copied to theterminal server every time they logon witch give a longer logontime.This is how I have set up the redirect policy.Windows server 2008 R2 -> Group Policy Management -> New Policy -> Userconfiguration\Policies\Windows Settings\Folder Redirection\AppData(Roaming):Target:Setting = Basic - Redirect everyone's folder to the same location.Target folder location = Create a folder for each user under the root path.Root path = \\server\usersSettings (enabled):On - Move the contents of AppData(Roaming) to the new location.On - Also apply redirection policy to Windows 2000, Windows 2000 Server,Windows XP, and Windows Server 2003 operating systems.On - Leave the folder in the new location when policy is removed.Ex. For user Clair, this folder will be redirected to:\\server\users\Clair\Application dataPål, ok, so you use the normal \users folder on the server for the redirected app data. Should it be possible to reproduce the problem using *only* the redirected app data folder like that (and \users then shared, presumably)? I.e. redirection of "documents" is not needed, nor is it needed to set up separate homes, profiles or appdata shares? What do you do for profiles, do you set up anything in the "Profile" tab of the domain user properties?I prefer to have an as minimal way as possible to reproduce the problem.(In reply to)When you say the normal \users folder on the server do you think of C:\Users?If so I do not use the normal users folder on the server.I have created a personal home folder for every user, lets call it homes instead of users. This folder is then shared and every user has it's own personal folder in here for personal stuff that only that person and domain admins has access to.AppData(Roaming) Target Root path = \\server\homesEx. For user Clair, this folder will be redirected to:\\server\homes\Clair\Application dataI also redirect Desktop, Documents, Pictures, Music and Videos folders to \\server\homes, but this should not have anything to do with LibreOffice/OOo error!The only thing I do in the "Profile" tab of the user properties is:Home folder, Connect = H: to \\server\homes\%username%The User profile, Profile path is blank!OK, thanks. I was misunderstanding your.This seems to be fixed in the Oracle OO 3.4 alpha that has just been releasedIs the plan to try and fix this for 3.3.3 or 3.4. As a XP site with 500+machines this bug is a complete show stopper. :-(MGreat, will have to look how they fixed it then and see if it can easily be adapted to 3.3 (as we presumably will continue releasing new 3.3.x versions once a month or so). But in any case the fix will naturally then be in our 3.4, too. We merge in OOo changes in LibreOffice in general.***has been marked as a duplicate of this bug. ***I see no mention in the OOo issue () that it would have been fixed intentionally.***has been marked as a duplicate of this bug. ***Looks like the problem is solved in OpenOffice.org 3.4 Alpha Release (buildDEV300m101). I have tested it and the problem did not occur.I'm also hitting this bug.If this helps testing:If you follow these steps, it will also fail: * create a new local account * Log in with the new account * change HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders\AppData to REG_EXPAND_SZ with value C:\test-appdata (or whatever) * Create the folder C:\test-appdata and if necessary give permissions to the new local account * Log out and log in again * Start a command prompt and verify the content of %APPDATA% (echo %APPDATA%) * Start LibreOfficeThis is what the group policy object changes under the hood.Wilco, thanks a lot! I didn't try yet but your instructions sound very promising.Wilco, using c:\test-appdata for that Registry value I had no problem starting LibreOffice.But if I use a UNC path (in my case, \\vmware-host\Shared Folders\tmp\test-appdata) I can indeed reproduce the problem. Yay, finally!Wilco, thanks once more. This kind of trivial way to reproduce the problem was what I was asking for already in.Debugging this now; in case I get interrupted, here is the stack trace at an interesting spot, and some musings:deploymentmi.uno.dll!dp_registry::backend::configuration::ConfigurationBackendDb::getAllDataUrls() Line 144 + 0xf bytes C++ deploymentmi.uno.dll!dp_registry::backend::configuration::`anonymous namespace'::BackendImpl::BackendImpl(const com::sun::star::uno::Sequence<com::sun::star::uno::Any> & args=0x00e9f408 {size=0x00000003}, const com::sun::star::uno::Reference<com::sun::star::uno::XComponentContext> & xComponentContext={...}) Line 216 + 0x16 bytes C++ deploymentmi.uno.dll!cppu::ImplInheritanceHelper1<dp_registry::backend::configuration::`anonymous namespace'::BackendImpl,com::sun::star::lang::XServiceInfo>::ImplInheritanceHelper1<dp_registry::backend::configuration::`anonymous namespace'::BackendImpl,com::sun::star::lang::XServiceInfo><com::sun::star::uno::Sequence<com::sun::star::uno::Any>,com::sun::star::uno::Reference<com::sun::star::uno::XComponentContext> >(const com::sun::star::uno::Sequence<com::sun::star::uno::Any> & arg1=0x00e9f408 {size=0x00000003}, const com::sun::star::uno::Reference<com::sun::star::uno::XComponentContext> & arg2={...}) Line 187 + 0x36 bytes C++ deploymentmi.uno.dll!comphelper::service_decl::detail::OwnServiceImpl<cppu::ImplInheritanceHelper1<dp_registry::backend::configuration::`anonymous namespace'::BackendImpl,com::sun::star::lang::XServiceInfo> >::OwnServiceImpl<cppu::ImplInheritanceHelper1<dp_registry::backend::configuration::`anonymous namespace'::BackendImpl,com::sun::star::lang::XServiceInfo> >(const comphelper::service_decl::ServiceDecl & rServiceDecl={...}, const com::sun::star::uno::Sequence<com::sun::star::uno::Any> & args=0x00e9f408 {size=0x00000003}, const com::sun::star::uno::Reference<com::sun::star::uno::XComponentContext> & xContext={...}) Line 182 + 0x36 bytes C++ deploymentmi.uno.dll!comphelper::service_decl::detail::ServiceImpl<dp_registry::backend::configuration::`anonymous namespace'::BackendImpl>::ServiceImpl<dp_registry::backend::configuration::`anonymous namespace'::BackendImpl>(const comphelper::service_decl::ServiceDecl & rServiceDecl={...}, const com::sun::star::uno::Sequence<com::sun::star::uno::Any> & args=0x00e9f408 {size=0x00000003}, const com::sun::star::uno::Reference<com::sun::star::uno::XComponentContext> & xContext={...}) Line 211 + 0x3a bytes C++ deploymentmi.uno.dll!comphelper::service_decl::detail::CreateFunc<comphelper::service_decl::detail::ServiceImpl<dp_registry::backend::configuration::`anonymous namespace'::BackendImpl>,comphelper::service_decl::detail::PostProcessDefault<comphelper::service_decl::detail::ServiceImpl<dp_registry::backend::configuration::`anonymous namespace'::BackendImpl> >,comphelper::service_decl::with_args<1> >::operator()(const comphelper::service_decl::ServiceDecl & rServiceDecl={...}, const com::sun::star::uno::Sequence<com::sun::star::uno::Any> & args=0x00e9f408 {size=0x00000003}, const com::sun::star::uno::Reference<com::sun::star::uno::XComponentContext> & xContext={...}) Line 263 + 0x31 bytes C++ deploymentmi.uno.dll!boost::detail::function::function_obj_invoker3<comphelper::service_decl::detail::CreateFunc<comphelper::service_decl::detail::ServiceImpl<dp_registry::backend::configuration::`anonymous namespace'::BackendImpl>,comphelper::service_decl::detail::PostProcessDefault<comphelper::service_decl::detail::ServiceImpl<dp_registry::backend::configuration::`anonymous namespace'::BackendImpl> >,comphelper::service_decl::with_args<1> >,com::sun::star::uno::Reference<com::sun::star::uno::XInterface>,comphelper::service_decl::ServiceDecl const &,com::sun::star::uno::Sequence<com::sun::star::uno::Any> const &,com::sun::star::uno::Reference<com::sun::star::uno::XComponentContext> const &>::invoke(boost::detail::function::function_buffer & function_obj_ptr={...}, const comphelper::service_decl::ServiceDecl & a0={...}, const com::sun::star::uno::Sequence<com::sun::star::uno::Any> & a1=0x00e9f408 {size=0x00000003}, const com::sun::star::uno::Reference<com::sun::star::uno::XComponentContext> & a2={...}) Line 131 + 0x18 bytes C++ comphelp4MSC.dll!00edf63a() [Frames below may be incorrect and/or missing, no symbols loaded for comphelp4MSC.dll] comphelp4MSC.dll!00edf6df() cppuhelper3MSC.dll!00370c0c() The m_urlDb at that top of the stack location is "file://vmware-host/Shared%20Folders/tmp/test-appdata/LibreOffice/3/user/uno_packages/cache/registry/com.sun.star.comp.deployment.configuration.PackageRegistryBackend/backenddb.xml" which IMHO is bogus. UNC paths should not be represented as file: URLs where the host part is the server name. More correct would be "file://///vmware-host/Shared%20Folders/..." IMHO. But as such, as long as the conversion from an UNC path to an URL and back results in the same UNC path as it started with, it shouldn't be a problem if the file: URL for the UNC path is bogus. But does it? Debugging...Yeah, I am fairly sure I understand the problem now. It is basically a mismatch between how OOo/LO represents UNC paths as URLs format, and what libxml2 is prepared to handle.The correct syntax for file: URLs on Windows is severely under-specified. Historically even for local file names various incompatible formats have been used, like Mozilla (Netscape?) at some point using | instead of :.But by now, I think the form generally agreed upon for local file names, at least when ASCII only is involved (yeah... a big "only") is file:///x:/rest/of/path , where x: is the drive letter.For UNC paths there is much less consensus. OOo/LO uses the form file://server/share/rest/of/path . But libxml2 does not handle that. Look at the code in xmlIO.c:xmlNoNetExists().Now, this bug would have been *much* easier to solve if only the error handling would have been saner. In unoxml/source/dom/documenthandler.cxx:warning_func(), the nice verbose error message from libxml2 is used, we get libxml2 warningfailed to load external entity "file://vmware-host/Shared%20Folders/tmp/test-appdata/LibreOffice/3/user/uno_packages/cache/registry/com.sun.star.comp.deployment.configuration.PackageRegistryBackend/backenddb.xml"And then in throwEx() in the same file we still have that message around, and it is stored in a com::sun::star::xml::sax::SAXParseException, which is thrown. But that exception is then caught in desktop/source/deployment/manager/dp_manager.cxx:dp_manager::PackageManagerImpl::create() with just: catch (Exception &) { ... }How nice. If the actual exception object would be captured here, we would see that it contains a nice verbose message "Extension Manager: failed to read data entry in configuration backend db: file://vmware-host/Shared%20Folders/tmp/test-appdata/LibreOffice/3/user/uno_packages/cache/registry/com.sun.star.comp." Yes, the URL is truncated (!), but still, showing that to the user would have been more useful than just saying "caught unexpected exception".This problem has been fixed in OOo 3.4 as a side-effect of them fixing their issue, in CWS jl164. Cherry-picking just the lines that help this problem is trivial. Will commit to the libreoffice-3-3 branch after I get one approval. (We presumably don't want to cherry-pick all of that CWS to our 3.3 branch, even if it fixes other symptoms of the same basic problem, too. But so far nobody seems to have reported the other symptoms for us, so maybe they are rare.)Patch:--- desktop/source/deployment/registry/dp_backenddb.cxx+++ desktop/source/deployment/registry/dp_backenddb.cxx@@ -92,7 +92,10 @@ css::uno::Reference<css::xml::dom::XDocument> BackendDb::getDocument() ::osl::File::RC err = ::osl::DirectoryItem::get(m_urlDb, item); if (err == ::osl::File::E_None) {- m_doc = xDocBuilder->parseURI(m_urlDb);+ ::ucbhelper::Content descContent(+ m_urlDb, css::uno::Reference<css::ucb::XCommandEnvironment>());+ Reference<css::io::XInputStream> xIn = descContent.openStream();+ m_doc = xDocBuilder->parse(xIn); } else if (err == ::osl::File::E_NOENT) {+1 for 3.3 from meFixed now in the 3.3 branch. (In master also fixed as part of the merge of OOo DEV300 stuff.)Nearly fixed. I built an XP pro SP3 machine from scratchInstalled LO 3.4 B5 syspreped the machines and imaged it.Then downloaded the image to another machine. The first user ( with a redirected home / application data /etc )to log in got the '[context=user]' error. Subsequent launchesof LO by that user worked and all other users also workedafterwardsM
id=34805	If the file you are editing is a .doc the recovery information is not recoverable.Edit a .doc, set recovery set autoRecovery information save time to say 5 mins.Add some content to the file and wait more than 5 mins without saving.Crash (kill) LibreOffice. The document fails to recover with a message Read-Error: Error reading file Reproducable on OSX and Win7.Also occurs in Openoffice 3.3 Also under Linux (OpenSUSE)[Reproducible] with "LibreOffice 3.4.0RC2 – WIN7 Home Premium (64bit) English UI [OOO340m1 (Build:12)]". I created a test document "mytest.doc" and provoked a crash by exporting the document to a .pdf due to "- PDFEXPORT with option "Tagged PDF" crashes WRITER documents". LibO crashed, and when I restarted it during recovery I got some "Read error" message, I do not remember.I checked the backup folder and found a file "mytest.doc_1.odt". When I renamed it to "something.doc" after I had copied it to an other folder LibO was able to open "something.doc" without problems, and the document was a perfect copy of my "mytest.doc" with all contents.So It seems that the name of the recovery copy "mytest.doc_1.odt" is wrong or LibO expects the wrong name or soemthing else.In an additional test I modified the name of the backup document from "__mytest.doc_0.odt" to "__mytest.doc", what was the name of my new sample. but that did not work either, when I started recovery I got an error message "__mytest.doc_0.odt ont available".I also did a similar test with an EXCEL document. You will not believe it, this time my additionally opened .doc and also an .odt have been recovered without problems, but for the excel document I got an error message "Read Error, Unknown or unsupported Excel file format."It seems recovery for MS OFFICE documents is messed up.CreatedScreenshots, SeeThis might cause data loss => we should do our best to fix it for 3.4.1 => increasing severity and priority.(In reply to)Also in Win XPCould not reproduce in a straightforward test with 3.4.2 rc1 on Windows XP. I set the aurorecovery interval to one minute. I edit a .doc document, adding a bit of text, wait for over one minute, and terminate the soffice.bin process in Task Manager. Then I restart LibreOffice. It offers to recover the document that was being edited, I click "Start Recovery". Next it then offers to send a crash report (huh, I thought we didn't have this functionality, where do these crash reports go?), I click Cancel. The document opens with my unsaved additions intact.Is there something special about the initial reporter's situation? Where do you store the temporary files, what is the path for "Temporary files" in Tools:Options:LibreOffice:Paths ?I think the claim that the problem the initial bug reporter sees would be specific to MSO file types is a red herring. As far as I can understand, autorecovery backup files are in fact saved as the appropriate ODF format. I.e. for text documents, .odt. (The file names used end with .tmp, though.) Autorecovery works also for documents that have been created from scratch without having ever been saved in any format at all, how would that work if autorecovery used the format the document was loaded as, or last saved as?Rainer, I am afraid I am going to ignore your complex comment, it just confuses me... I don't know what backup folder and files you are talking about.(In reply to)Confuses me now, too. Created the comment while testing with all delusions and confusions during the test. I think the result is more or less that recovery documents are available, but LibO does not find them because it expects other names (or similar). If you do not find an other approach (and if you cant' reproduce it will be hard to find ...) I can retry again and may be I find a more direct way.That was simple, it seems the bug has vanished. No longer reproducible with "LibreOffice 3.4.1 - WIN7 Home Premium (64bit) German UI [OOO340m1 (Build:103)]", also works fine with Master dev-build.Closing due to latest results.I can still reproduce this every time on 3.4.1 on OSX.Set "Save auto recovery information" to 2 minutes.Don't tick "Always create backup copy"Open a .doc fileChange some thingsKill LO (force quit on a mac)Open LO again. The attached screen shot is what I get, document is not recovered.steveCreatedFailed recovery 3.4.1, note 9@Steve:Strange! Because for me the problem is no longer reproducible, we might have 2 effects with the same result?I have some difficulties to understand your crash method, can you please use a crash bug (see below!)Can you do an additional test by trying to crash with a document you can attach here (with simple line "This is first test YYYMMDDhhmm)" and "[] PRINTING: Switching radio buttons "Selection <-> All" Crashes" (If it woks, please confirm there for your OS)Please check your backup folder before recovery:a) Is a copy of the document in the backup folder?b) If yes, make a copy of backup document to an other folderc) check whether that document can be opened after recovery.d) if not, also attach copye) try again with clean new user profile.We need much more information than a simple "it does not work"Reproducible [1]with LibO 3.4.2 RC1 on WinXP 32b[LibreOffice 3.4.2 OOO340m1 (Build:201)] AutoRecovery doesn't work for the attached 'autorecovery.doc'. [2]The recovered file is always the last (manually) saved file. [3]The up-to-date AutoRecovery info is saved:1. in the user\backup folder (as 'autorecovery.doc_0.odt' / 'autorecovery.doc_1.odt')2. in the LOKALE~1\Temp folder(as 'lu4989y.tmp', or a similar name)(respectively the paths in Tools > Options > LibreOffice > Paths >Backups / Temporary files).The up-to-date AutoRecovery info isn't available for the AutoRecovery process.Attachments:[1] Screenshots: AutoRecovery process - error messages[2] Original 'autorecovery.doc' (created with LibO 3.4.2 RC1)[3] Recovered file 'autorecovery.doc_1.odt'[4] AutoRecovery info 1 / backup folder – 'autorecovery.doc_0.odt'[5] AutoRecovery info 2 / Temp folder – 'lu4989y.tmp'Created[1] Screenshots: AutoRecovery process - error messagesCreated[2] Original 'autorecovery.doc' (created with LibO 3.4.2 RC1)Created[3] Recovered file 'autorecovery.doc_1.odt'Created[4] AutoRecovery info 1 / backup folder – 'autorecovery.doc_0.odt'Created[5] AutoRecovery info 2 / Temp folder – 'lu4989y.tmp'LibO 3.4.2 RC1 on WinXP 32b[LibreOffice 3.4.2 OOO340m1 (Build:201)]Another sample without dataloss 1. 'He heard quiet steps behind him.doc' - created with MSWord 2000 [6]2. Opened with Writer3. Modified the document4. Killed soffice.binThe recovered file 'He heard quiet steps behind him.doc' was the last saved file (without modifications) [7]From AutoRecovery process (step 4):"The automatic recovery process was interrupted.The document listed below will be saved in the folder noted below if you click 'Save'"(Path: Tools > Options > LibreOffice > Paths > My Documents)This saved file 'He%20heard%20quiet%20steps%20behind%20him.doc_0.odt' is up-to-date with all current AutoRecovery info. [8] [9] [10]Attachments:[6] Original file 'He heard quiet steps behind him.doc' (created with MSWord 2000)[7] Recovered file 1 'He heard quiet steps behind him.doc'[8] Recovered file 2 'He%20heard%20quiet%20steps%20behind%20him.doc_0.odt'[9] AutoRecovery info 1 / backup folder – 'He heard quiet steps behind him.doc_0.odt'[10] AutoRecovery info 2 / Temp folder – 'luautmz.tmp'Created[6] Original file 'He heard quiet steps behind him.doc' (created with MSWord 2000)Created[7] Recovered file 1 'He heard quiet steps behind him.doc'Created[8] Recovered file 2 'He%20heard%20quiet%20steps%20behind%20him.doc_0.odt'Created[9] AutoRecovery info 1 / backup folder – 'He heard quiet steps behind him.doc_0.odt'Created[10] AutoRecovery info 2 / Temp folder – 'luautmz.tmp'Sigh, with manj_k's "autorecovery.doc" and proceeding as perI can reproduce the problem with 3.4.1 (Read error).Unbelievable, today I get the problem with my simple test document from. Unfortunately I have no idea why this prolbem sometimes does not appear.I believe the most promising approach will be that Tor tries again to reproduce with "autorecovery.doc"?Nothing mysterious with my good test results any longer - I did my tests with fromwith my source.odt documents, not with my test.doc documents :-(@manj_k:Thank you for your endurance.I think it is fairly pointless to attach screenshots or intermediate backup files, recovered files etc in this bug report. I am not really going to look at them. What is needed is exact reproduction instructions that work 100% reliably. Plus possibly then a sample document if it is for some reason impossible to reproduce the problem just using exact minimal reproduction instructions.I am now going to concentrate on the autorecovery.doc from.For the Mac, wouldn't using the kill command from a shell be better than "force quit" from Finder? For all I know, "force quit" might first try to make the process quit in a "clean" fashion, and thus not match a real crash.BTW, why do you people use *two* minutes when testing this? Why not one minute, which would make it a bit less tedious to reproduce the bug? Have you noticed a difference in behaviour between one and two minutes?OK, with the autorecovery.doc from comment I indeed see the stupid "Read-Error. Error reading file" message when the autorecovery is in progress. Could it be the image in the document that causes the recovery problem? Anyway, no need for any more instructions or attachments now, thanks!BTW, when I intalk about the automatically saved backup copies of documents always being in ODF, I was misunderstanding. I think... I was looking at the files in the temp directory's lu*.tmp subdirectory, not the one in LO the user/backup directory.Oh, and to reproduce the problem from scratch, it is enough to insert a picture from a file into an empty text document, and save as .doc. Then open it, add some minimal amount of text, and wait for it to be auto-saved. Then kill soffice.bin, start LO, and watch the recovery fail.Eh, and now I can reproduce it even with no picture inserted into the document, wtf. I thought I had checked that already last week.I have had it on Suse linux, first noticed with LO3.3.2 in a real "hang" situation.I can reproduce it in linux LO3.3.2 and on a mac with 3.4.1 every time with a .doc without a picture.I always start with a .doc created in MSO and sent to me. I have not had a .doc yet that it does not exhibit this problem. The .doc is edited, not saved or saved as and wait for the autorecovery time to elapse before killing or flicking the switch at the wall.My current theory is that the autosave files (the one stored in the user-specific user/backup directory) are always ODF format (and indeed have names that say so, like x4.doc_0.odt for a document loaded from the file x4.doc). They do seem to be well-formed proper ODF documents. But then when ther autorecovery tries to restore the in-progress edit state of the document from the autosave file, it uses the filter for the original document, i.e. it tries to load the above x4.doc autosave file x4.doc_0.odt as if it was a .doc document.Here is a stack trace from SfxBaseModel::load() while attempting the recovery, where in the seqArguments "FilterName" is "MS Word 97" even though "URL" is "file:///C:/Documents%20and%20Settings/N.N/Application%20Data/LibreOffice/3/user/backup/x4.doc_0.odt", and that file indeed is a proper .odt file (and it *does* contain the document as it was when being edited and I intentionally killed the soffice.bin process).sfxmi.dll!SfxBaseModel::recoverFromFile(const rtl::OUString & i_SourceLocation={...}, const rtl::OUString & i_SalvagedFile={...}, const com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> & i_MediaDescriptor=0x00e9ee3c {size=8}) Line 1788 + 0x30 bytes C++ fwkmi.dll!framework::AutoRecovery::implts_openOneDoc(const rtl::OUString & sURL={...}, comphelper::MediaDescriptor & lDescriptor={...}, framework::AutoRecovery::TDocumentInfo & rInfo={...}) Line 2663 + 0xb2 bytes C++ fwkmi.dll!framework::AutoRecovery::implts_openDocs(const framework::DispatchParams & aParams={...}) Line 2548 C++ fwkmi.dll!framework::AutoRecovery::implts_doRecovery(const framework::DispatchParams & aParams={...}) Line 3018 + 0xc bytes C++ fwkmi.dll!framework::AutoRecovery::implts_dispatch(const framework::DispatchParams & aParams={...}) Line 637 C++ fwkmi.dll!framework::AutoRecovery::implts_asyncDispatch(void * __formal=0x00000000) Line 1631 C++ fwkmi.dll!framework::AutoRecovery::LinkStubimplts_asyncDispatch(void * pThis=0x06164908, void * pCaller=0x00000000) Line 1620 + 0xf bytes C++ tlmi.dll!01183544() [Frames below may be incorrect and/or missing, no symbols loaded for tlmi.dll] vclmi.dll!vcl::EventPoster::DoEvent_Impl() + 0x12 bytes C++ vclmi.dll!vcl::EventPoster::LinkStubDoEvent_Impl() + 0xe bytes C++ tlmi.dll!01183544() vclmi.dll!ImplHandleClose() + 0x151 bytes C++ vclmi.dll!ImplWindowFrameProc() + 0x2e5 bytes C++ vclmi.dll!SalFrame::CallCallback() + 0x16 bytes C++ vclmi.dll!SalFrameWndProc() + 0x788 bytes C++ vclmi.dll!SalFrameWndProcW() + 0x30 bytes C++ user32.dll!7e368734() user32.dll!7e368816() user32.dll!7e3689cd() user32.dll!7e368a10() vclmi.dll!ImplDispatchMessage() + 0xc bytes C++(In reply to)Yes, that's it!When I 1. copy paste the original document autorecovery.doc to the backup folder after the crash, 2. delete the autorecovery.doc_1.odt in backup folder3. Rename autorecovery.doc by autorecovery.doc_1.odt4. Backup file will be opened during recovery without problemsThat has to be expected from Tor's resultsYeah, the interesting question now is which is the true intentional of the people who have written this code: 1) that documents indeed always are autosaved as ODF, (and the use of the MS Word filter then to recover an autosaved text document is a bug), or 2) that a document is autosaved in the format it is associated with (the one it was loaded from, or saved as, whichever was later, or something) (and that a text document at least in fact is autosaved as .odt is a bug).Heritage from OOo? I did some tests:a) OOo 3.1.1 and 3.4-Dev OOo300m103(Build 9578) both create .odt backup files in the backup folderb) I checked a crash with OOo-Dev3.4, recovery shows the same "Read file error" like LibOWhat ever that might tell concerning "the true intentional of thepeople who have written this code".I did not find a related OOo IssueCould it really be that the use of "foreign" (non-ODF) formats is so rare among the Sun/Oracle developers writing this code that nobody even tried if the autorecovery code in the 3.4 development line works for non-ODF documents?It seems that this small change fixes the problem:Committed to master, one review needed for the 3-4 branch, three reviews needed for the 3-4-2 branch.Fridrich cherry-picked it to the libreoffice-3-4 branch, will thus be in 3.4.3.It seems the bug was introduced Jan 2010:commit 502e0900447f2eab00ead2e2703fe0395ac92baaAuthor: Frank Schoenheit [fs] <>Date: Tue Jan 5 22:32:38 2010 +0100in the big re-write of the recovery code. Good to have it fixed, but certainly not a LibreOffice specific bug.We needed 3.4.2-rc3, so we added this fix there.
id=35188	Standard spreadsheet capability is to be able to reference data cells in external spreadsheets. Behaviour: create a test.ods sheet with some data values. save the file. Create a second new spread sheet. Use any cell in the second spreadsheet and pick a reference a cell that holds a value from the first sheet. E.g. cell A1 in test.ods holds the value '3'. Set cell A1 in the second spread sheet equal to cell test.A1 (ie ='file:///[location]/test.ods'#$Sheet1!A1'). The result should be '3' in the second sheet.The results: The cell result holds '#NAME?'. In the file descriptor, any caps are reduced to small letters. The '$' is dropped. This occurs with 3.3.1.2 OOOm19(Build:8) Ubuntu package 1:3.3.1-1ubuntu3-maverick.The reason for major is that when previously created files are opened that have external links, any cells with references became invalid. Hence, the spread sheets become unusable with this version.I've tried this with a 3.4 snapshot running on Ubuntu marverick and OOO330m19 (Build:6) tag libreoffice-3.3.0.4 running on Fedora 14. Neither exhibit the problem.Also the problem does not occur in 3.3.1.2 OOO330m19(Build:8) tag libreoffice-3.3.1.2 running in Windows 7 Not reproducible.I have similar problem.References to external spreadsheets don't work with 'Index()' command.For example, I have a file 'Calc.ods' on a local drive. The cell A1 holds '=INDEX('file:///Users/kosvlad/Downloads/Price-list.ods'#$Price.A1:D10;1;1)'. So, the 'Price-list.ods' is placed on a local drive too. Its name and its sheet name contain latin characters only without spaces.The A1 of 'Calc.osd' returns 'Err:502'.When I open this file in Open Office 3.2, it works properly, so there is no errors in formulas. Even if external 'ODS' file is placed on a file server and its full name contains cyrillic characters.I tested localised Libre Office (RU) and I have the same problem.Mac OS 10.6.7LibreOffice 3.3.2 OOO330m19 (Build:202)tag libreoffice-3.3.2.2This works in Windows 7.create a test.ods sheet with some data values. save the file. Createa second new spread sheet. Use any cell in the second spreadsheet and pick areference a cell that holds a value from the first sheet. E.g. cell A1 intest.ods holds the value '3'. To set cell A1 in the second spread sheet equal tocell test.A11. In test, name cell A1 as a range and save it.2. In the second sheet, select any cell. A. Under menu Insert select "Link To External Data. B. From the drop down menu, select test.ods C. Press OK3. The result should be '3' in the second sheet.(In reply to)When using Calc A1 syntax the sheet separator is a '.' dot, so the correct formula would be ='file:///[location]/test.ods'#$Sheet1.A1And this works in 3.4.2 and 3.3.4The Excel A1 syntax (which uses '!' exclamation mark as sheet separator but again is different from the example you gave) however seems to be broken in both, 3.4.2 and 3.3.4It seems that the problem never has been reproduced, only user errors with wrong syntax!@mrh / others:Please feel free to reopen this bug if you find out that the problem still exists with the current stable LibreOffice version and if you can contribute requested additional information due to <> (especially BugReport Details), especially a test kitRESOLVED, FIXED or CLOSED bugs cant be KEYWORD NEEDINFO.
id=35080	CreatedDocument file that reproduces bug. Right-click "Lani's" to crash.If the string "Lani's" is included in a Writer document with automatic spell checking enabled, it will have the wavy red underline indicating it as a spelling error. If I right-click on that string, Writer will crash. This is 100% reproducible on two different computers. I have attached a sample document that causes this crash.Both computers are running Windows XP Professional SP3 32-bit with LibreOffice v3.3.1. LibreOffice extensions consist of the defaults plus Accentuate v1.0.0, Alternative Searching v1.3.2, DateTime v2.0.3, OxygenOffice Extra Templates US v2.8.0.1, Sun Professional Template Pack II (English) v1.0, and Test Missing Fonts v1.4.4. LibreOffice is configured as "English (Canada)" for both locale setting and default document language.I upgraded from LibreOffice v3.3.0 to v3.3.1 because of this bug, but it is still present.I consider this to be a very serious bug because I have no reason to suspect that there wouldn't be many other magical letter combinations that would also cause data loss due to such crashes.There is a small subset of letter changes that can be made to the "Lani's" string which will also result in a crash, but most do not. Obviously the number of possible replacements are huge, but I have tested the following possibilities, each of which alters only one letter in the string "Lani's":- Replacing the 'L' with 'M' will still crash, but no other uppercase letter will.- No other lowercase replacement for the 'a' will crash.- Replacing the 'm' with 'n' will crash, but no other lowercase letter will.- Replacing the 'i' with any one of "krtuvw" will crash, but no other lowercase letter will.- The apostrophe must remain in order to crash.- The 's' must remain unchanged in order to crash.We are experiencing other crashes with random documents and have as yet noticed no clear pattern. OpenOffice v3.2.1 never crashed under any circumstances for us. LibreOffice is not what we would expect for release quality. What are the possible negative consequences of downgrading back to OOo v3.2.1 for documents that have since been modified using LibreOffice v3.3.0 or v3.3.1? Reproduced.A (mostly useless) stack trace from first debug attempt, of stock 3.3.1 binaries. Will build more of it for debugging to get more useful information, unless somebody happens to beat me to it, and can reproduce and fix it with a build suited for debugging they already have lying around...[Frames below may be incorrect and/or missing, no symbols loaded for ntdll.dll] ntdll.dll!7c910222() ntdll.dll!7c91019b() ntdll.dll!7c9101db() ntdll.dll!7c9101db() ntdll.dll!7c9101db() ntdll.dll!7c910222() ntdll.dll!7c91019b() ntdll.dll!7c9101db() stlport_vc7145.dll!00fe1050() stlport_vc7145.dll!00fe86d1() stlport_vc7145.dll!00fe1050() stlport_vc7145.dll!00fe86d1() stlport_vc7145.dll!00ff3876() stlport_vc7145.dll!00ff9a5b() msvcr90.dll!78583a58() msvcr90.dll!78583b58() gdi32.dll!77f1831d() gdi32.dll!77f1836d() vclmi.dll!020c5119() vclmi.dll!020c522e() vclmi.dll!020c75ee() vclmi.dll!01f78712() vclmi.dll!01f7a73c() swmi.dll!0ebbcc9c() swmi.dll!0ebcacb9() swmi.dll!0eb512b8() swmi.dll!0eb19856() sal3.dll!10003988() stlport_vc7145.dll!00fe1050() cppu3.dll!00fb48d1() swmi.dll!0ea93725() swmi.dll!0ea93c9c() swmi.dll!0ea777fe() swmi.dll!0ee5b29b() swmi.dll!0edb84ba() vclmi.dll!020514d9() vclmi.dll!020514d9() vclmi.dll!020514d9() vclmi.dll!02056e2d() vclmi.dll!02059b06() uxtheme.dll!5b28c406() vclmi.dll!02125fad() vclmi.dll!01f1efac() vclmi.dll!01f1bcb8() vclmi.dll!020ae8e2() sal3.dll!100039a0() vclmi.dll!01f28287() vclmi.dll!021313aa() vclmi.dll!01f1dff7() soffice.bin!0040101b() soffice.bin!0040103c() soffice.bin!004011e6()Reproduced withLibreOffice 3.3.1 RC2 (1:3.3.0-1lucid1) - Ubuntu 10.04 x86 Linux 2.6.32-28-generic Russian UII changed OS due to this result.After building stlport_vc7145.dll, basegfxmi.dll, vclmi.dll and svxcoremi.dll for debugging (because I saw those at the bottom of the stack trace when debugging), I now have this stack trace when I get a crash:06c6c680() swmi.dll!06ed3725() swmi.dll!06ed3c9c() swmi.dll!06eb77fe() swmi.dll!0729b29b() swmi.dll!071f84ba() vclmi.dll!Window::PreNotify(NotifyEvent & rNEvt={...}) Line 5174 + 0x23 bytes C++ 0d68b828() swmi.dll!06f2c64f() vclmi.dll!ImplCallCommand(Window * pChild=0x06ce2458, unsigned short nEvt=0x0001, void * pData=0x00000000, unsigned char bMouse='', Point * pPos=0x00e9f82c) Line 310 C++ vclmi.dll!ImplHandleMouseEvent(Window * pWindow=0x06bdd240, unsigned short nSVEvent=0x0001, unsigned char bMouseLeave=0x00, long nX=0x000000a1, long nY=0x000000ec, unsigned long nMsgTime=0x0050b8fa, unsigned short nCode=0x0004, unsigned short nMode=0x0000) Line 906 + 0x13 bytes C++etcI am afraid that building swmi.dll for debugging might be problematic, at least that is my vague memory. But I will try anyway...Interestingly, once I rebuilt the DLLs mentioned first with debugging, I no longer see them being involved in the crash.It would be great if this is reproducible on Linux, too. Any developer capable of reproducing it on Linux?OK, here is yet another stack trace, now again with basgfxmi.dll at the bottom (i.e. top, visually...):vclmi.dll!OutputDevice::GetViewTransformation() Line 1062 + 0x12 bytes C++ svxcoremi.dll!sdr::overlay::OverlayManagerBuffered::invalidateRange(const basegfx::B2DRange & rRange={...}) Line 501 + 0x19 bytes C++ svxcoremi.dll!sdr::overlay::OverlayManager::impApplyAddActions(sdr::overlay::OverlayObject & rTarget={...}) Line 235 C++ svxcoremi.dll!sdr::overlay::OverlayManager::add(sdr::overlay::OverlayObject & rOverlayObject={...}) Line 310 C++ swmi.dll!SwSelPaintRects::Show() Line 534 C++ swmi.dll!SwCrsrShell::UpdateCrsr(unsigned short eFlags=0x0006, unsigned char bIdleEnd=0x00) Line 1770 C++ swmi.dll!SwCrsrShell::ExtendSelection(unsigned char bEnd='', unsigned short nCount=0x0006) Line 2289 C++ swmi.dll!SwEditShell::GetCorrection(const Point * pPt=0x00e9f53c, SwRect & rSelectRect={...}) Line 1089 C++ swmi.dll!SwView::ExecSpellPopup(const Point & rPt={...}) Line 687 + 0x1d bytes C++ swmi.dll!SwEditWin::Command(const CommandEvent & rCEvt={...}) Line 4884 + 0x15 bytes C++ vclmi.dll!ImplCallCommand(Window * pChild=0x06c72288, unsigned short nEvt=0x0001, void * pData=0x00000000, unsigned char bMouse='', Point * pPos=0x00e9f82c) Line 310 C++ vclmi.dll!ImplHandleMouseEvent(Window * pWindow=0x06b21308, unsigned short nSVEvent=0x0001, unsigned char bMouseLeave=0x00, long nX=0x000000a8, long nY=0x000000f0, unsigned long nMsgTime=0x00a5a10f, unsigned short nCode=0x0004, unsigned short nMode=0x0000) Line 906 + 0x13 bytes C++ vclmi.dll!ImplHandleSalMouseButtonDown(Window * pWindow=0x06b21308, SalMouseEvent * pEvent=0x00e9fa40) Line 2069 + 0x48 bytes C++The rMat in B2DHomMatrix::B2DHomMatrix(const B2DHomMatrix& rMat) seems to be bogus. That is called from basegfx::B2DHomMatrix OutputDevice::GetViewTransformation() const , as return *mpOutDevData->mpViewTransform. That again is called from OverlayManagerBuffered::invalidateRange(const basegfx::B2DRange& rRange) , as aDiscreteRange.transform(getOutputDevice().GetViewTransformation()). Nothing of this says much to me...There is a fairly verbose comment before that last mentioned location, saying:// add the discrete range to the remembered region// #i75163# use double precision and floor/ceil rounding to get overlapped pixel region, even// when the given logic region has a width/height of 0.0. This does NOT work with LogicToPixel// since it just transforms the top left and bottom right points equally without taking// discrete pixel coverage into account. An empty B2DRange and thus empty logic Rectangle translated// to an also empty discrete pixel rectangle - what is wrong.I wonder if that is relevant to this problem?Interestingly enough, next time I try the same right-click, the crash happens with this stack trace:06c70002() swmi.dll!SwTxtCursor::_GetCharRect(SwRect * pOrig=0x06aff4d0, const unsigned short nOfst=0x0002, SwCrsrMoveState * pCMS=0x00e9e9cc) Line 941 + 0x1e bytes C++ swmi.dll!SwTxtCursor::GetCharRect(SwRect * pOrig=0x06aff4d0, const unsigned short nOfst=0x0002, SwCrsrMoveState * pCMS=0x00e9e9cc, const long nMax=0x000007ba) Line 1232 C++ swmi.dll!SwTxtFrm::GetCharRect(SwRect & rOrig={...}, const SwPosition & rPos={...}, SwCrsrMoveState * pCMS=0x00e9e9cc) Line 302 + 0x48 bytes C++ swmi.dll!SwCrsrShell::UpdateCrsr(unsigned short eFlags=0x0006, unsigned char bIdleEnd=0x00) Line 1696 + 0x3e bytes C++ swmi.dll!SwCrsrShell::Pop(unsigned char bOldCrsr=0x00) Line 1996 C++ swmi.dll!SwEditShell::GetCorrection(const Point * pPt=0x00e9f53c, SwRect & rSelectRect={...}) Line 1074 C++ swmi.dll!SwView::ExecSpellPopup(const Point & rPt={...}) Line 687 + 0x1d bytes C++ swmi.dll!SwEditWin::Command(const CommandEvent & rCEvt={...}) Line 4884 + 0x15 bytes C++ vclmi.dll!ImplCallCommand(Window * pChild=0x06c723f0, unsigned short nEvt=0x0001, void * pData=0x00000000, unsigned char bMouse='', Point * pPos=0x00e9f82c) Line 310 C++ vclmi.dll!ImplHandleMouseEvent(Window * pWindow=0x06b21308, unsigned short nSVEvent=0x0001, unsigned char bMouseLeave=0x00, long nX=0x000000a0, long nY=0x000000ef, unsigned long nMsgTime=0x00c1d67f, unsigned short nCode=0x0004, unsigned short nMode=0x0000) Line 906 + 0x13 bytes C++ vclmi.dll!ImplHandleSalMouseButtonDown(Window * pWindow=0x06b21308, SalMouseEvent * pEvent=0x00e9fa40) Line 2069 + 0x48 bytes C++ vclmi.dll!ImplWindowFrameProc(Window * pWindow=0x06b21308, SalFrame * __formal=0x06b0ddd8, unsigned short nEvent=0x0003, const void * pEvent=0x00e9fa40) Line 2396 + 0xd bytes C++ vclmi.dll!ImplHandleMouseMsg(HWND__ * hWnd=0x00220126, unsigned int nMsg=0x00000204, unsigned int wParam=0x00000002, long lParam=0x00ef00a0) Line 3530 + 0x25 bytes C++I love randomness.Definitely seems to be heap corruption or something similar. Now when I run VS with symbols also for the MS libraries, I get a crash (i.e. unhandled exception) in malloc(). ntdll.dll!_RtlAllocateHeap@12() + 0xef bytesmsvcr90.dll!operator new(unsigned int size=0x00000008) Line 59 + 0x8 bytes C++ vclmi.dll!SimpleWinLayout::LayoutText(ImplLayoutArgs & rArgs={...}) Line 413 + 0x1f bytes C++ vclmi.dll!OutputDevice::ImplLayout(const String & rOrigStr={...}, unsigned short nMinIndex=0x0000, unsigned short nLen=0x0002, const Point & rLogicalPos={...}, long nLogicalWidth=0x00000000, const long * pDXArray=0x00000000, bool bFilter=false) Line 5992 + 0x16 bytes C++ vclmi.dll!OutputDevice::GetTextArray(const String & rStr={...}, long * pDXAry=0x0d1703b8, unsigned short nIndex=0x0000, unsigned short nLen=0x0002) Line 5665 + 0x2e bytes C++ swmi.dll!SwFntObj::GetTextSize(SwDrawTextInfo & rInf={...}) Line 2009 C++ swmi.dll!SwSubFont::_GetTxtSize(SwDrawTextInfo & rInf={...}) Line 762 + 0x13 bytes C++ swmi.dll!SwTxtSizeInfo::GetTxtSize() Line 490 + 0x44 bytes C++ swmi.dll!SwTxtPortion::GetTxtSize(const SwTxtSizeInfo & rInf={...}) Line 565 + 0xc bytes C++ swmi.dll!SwTxtCursor::_GetCharRect(SwRect * pOrig=0x06af04e0, const unsigned short nOfst=0x0002, SwCrsrMoveState * pCMS=0x00e9e9cc) Line 941 + 0x1e bytes C++ swmi.dll!SwTxtCursor::GetCharRect(SwRect * pOrig=0x06af04e0, const unsigned short nOfst=0x0002, SwCrsrMoveState * pCMS=0x00e9e9cc, const long nMax=0x000007ba) Line 1232 C++ swmi.dll!SwTxtFrm::GetCharRect(SwRect & rOrig={...}, const SwPosition & rPos={...}, SwCrsrMoveState * pCMS=0x00e9e9cc) Line 302 + 0x48 bytes C++ swmi.dll!SwCrsrShell::UpdateCrsr(unsigned short eFlags=0x0006, unsigned char bIdleEnd=0x00) Line 1696 + 0x3e bytes C++ swmi.dll!SwCrsrShell::Pop(unsigned char bOldCrsr=0x00) Line 1996 C++ swmi.dll!SwEditShell::GetCorrection(const Point * pPt=0x00e9f53c, SwRect & rSelectRect={...}) Line 1074 C++ swmi.dll!SwView::ExecSpellPopup(const Point & rPt={...}) Line 687 + 0x1d bytes C++ swmi.dll!SwEditWin::Command(const CommandEvent & rCEvt={...}) Line 4884 + 0x15 bytes C++ vclmi.dll!ImplCallCommand(Window * pChild=0x06c622d8, unsigned short nEvt=0x0001, void * pData=0x00000000, unsigned char bMouse='', Point * pPos=0x00e9f82c) Line 310 C++ vclmi.dll!ImplHandleMouseEvent(Window * pWindow=0x06b12308, unsigned short nSVEvent=0x0001, unsigned char bMouseLeave=0x00, long nX=0x000000a2, long nY=0x000000ec, unsigned long nMsgTime=0x00dec56b, unsigned short nCode=0x0004, unsigned short nMode=0x0000) Line 906 + 0x13 bytes C++ vclmi.dll!ImplHandleSalMouseButtonDown(Window * pWindow=0x06b12308, SalMouseEvent * pEvent=0x00e9fa40) Line 2069 + 0x48 bytes C++ vclmi.dll!ImplWindowFrameProc(Window * pWindow=0x06b12308, SalFrame * __formal=0x06afedf8, unsigned short nEvent=0x0003, const void * pEvent=0x00e9fa40) Line 2396 + 0xd bytes C++ vclmi.dll!ImplHandleMouseMsg(HWND__ * hWnd=0x002f0106, unsigned int nMsg=0x00000204, unsigned int wParam=0x00000002, long lParam=0x00ec00a2) Line 3530 + 0x25 bytes C++Running soffice.bin under an evaluation copy of Purify, when right-clicking the word in question, I see 14 occurrences of FMR (free memory read) in strncmp and 36 occurrences of IPR (invalid pointer read) in strncmp. As it is an evaluation copy, it doesn't show me where, not even in what DLL. Kendy, should we purchase a PurifyPlus license? Can anybody see any problem when running the reproduction case under Valgrind on Linux?I don't know if it helps, but I had someone try to reproduce this bug using OpenOffice.org v3.3.0 instead of LibreOffice. He suffered no crash, so it seems to be a LibreOffice bug only.I cannot reproduce this bug with LO 3.3.1 running Windows Vista SP1 x86(In reply to)Actually it's SP2, not that it really matters...(In reply to)I should have also said that he's using Windows 7 rather than Windows XP, so given Zack's test it's also possible that the bug is OS-dependent.I have reproduced it on windows XP 32 bit LibreOffice 3.3.1.2 (Writer,Calc,Impress) without extensionsbut can not reproduce on Mandriva 64 bit LibreOffice 3.3.2.1rc1Createdcrash stack on LibO 3.3.1 sled 11 sp1Hi, I reproduced this on SLED 11 sp1 with LibO 3.3.1. Crash stack attached.Yifan, great, if it van be reproduced on (some) Linux, it can hopefully be valgrinded... Your crash stack (in free()) definitely seems to indicate heap corruption, too.gah, I tried to reproduce this as I have a couple of debug builds around, failed miserably,master (64 bit ) - nolibreoffice3.3 ( 64 bit ) branch with distro patch - no ( although this self build seems to not even detect the spelling error ( might be to do with missing dictionaries or something ) however ( although I did get a very similar valgrind trace to the stack from yifan ) against the generic 3.3.1 build downloaded from libreoffice site. I will attach the valgrind log ( although without line numbers it's not enough for me to see where it is going wrong ).Createdvalgrind log against 3.3.1 finalnote the memcpy error is all I get with the current libreoffice3-3 branch and master builds and that error seems benign ( although in theory it could cause some problems )(In reply to)I should say in this case that I had to set the text language from English (canada ) to English (uk) to get the spelling errorNoel, thanks for the valgrind runs!I also tried reproducing this bug with my desktop which is running Windows 7 SP1 x64. I was unable to reproduce this bug with any combination of letters that have crashed LO for the OP.it is 32-bit specific bugit can reproduced on 32 bit windows and Linuxbut can not reproduced on 64 bit windows and LinuxSasha, I hope you are aware that on 64-bit Linux, the LibreOffice is also 64-bit code, but for Windows, there is only a 32-bit LibreOffice which is used both on 32- and 64-bit Windows. Thus I don't really give that much value to your last comment. You might be making up the wrong conclusions. Please don't bother with technical guesses if you are not a developer and actually have been debugging the code.Thanks for explanations(In reply to)As tor said, I don't think this is correct. I cannot reproduce this bug on either version of Windows (Vista x68 and 7 x64).This bug triggered for me in a Windows XP VM (VirtualBox) with OpenOffice 3.3Bug seems to be fixed in 3.4.
id=35583	Createderror-message (german)I want to use LibreOffice 3.3.2 on a Windows 7 machine (member of a domain) with remote user profiles. When i start LibreOffice 3.3.2 I get the following error:LibreOffice 3.3 Fatal Error.[context="user"] caught unexpected exception!I really want to use this nice peace of free software on an Enterprise! Could you fix this behavior? *** This bug has been marked as a duplicate of***(In reply to)Why? The Bug you refer to concerns to Windows XP, not to Windows 7 ?!Do you have any specific techincal reason to believe that the root cause would be different?*** This bug has been marked as a duplicate of***
id=36267	CreatedApple CrashReporter logCan not start LO 3.4 B1 - instant crash (SIGBUS) on launch. Apple CrashReporter information is attached.Mac OS X 10.6.7 on Intel Core 2 Duo iMac OK, a bit more info - launch application, get splash screen, seems to get through boot process, opens a new window (Start Center) but before anything is drawn in the window, that's when the crash happens.Nothing appears in the Console except a message saying "LibreOffice appears to have crashed (Bus error)" and the CrashReporter info.Deleted LibreOffice.app (3.4) and reinstalled LibreOffice.app (3.3.2) and it works fine again. So definitely something in 3.4 causing the crash.Thorsten, could you take a look at this?I haven't verified this (since I don't have a Mac), but it is consistent with some of the users' feedback who tried one of our Mac nightly builds.(In reply to)Hi Kohei,It is certainly consistent with my experience of the nightly build from 14/04, Julie Nabet also experienced the same thing.The app instantiates, then crashes before it can finish loading the main app window.Alex(In reply to)Sorry, that should've been Julien, T9 my enemy there.AlexSorry again. It wasn't Julien, but Rob Dargaud. I need a holiday :-)***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Hmm, did anyone actually get this to run on Mac before announcing the release?I see that there is a similar issue on Windows.Alex***has been marked as a duplicate of this bug. ****** This bug has been marked as a duplicate of***3.4 beta 1 for mac OS X. Error during installation.Process: soffice [177]Path: /Applications/LibreOffice.app/Contents/MacOS/sofficeIdentifier: org.libreoffice.scriptVersion: 3.4.0 (???)Code Type: X86 (Native)Parent Process: launchd [109]Date/Time: 2011-04-19 22:57:43.143 +0200OS Version: Mac OS X 10.6.7 (10J869)Report Version: 6Interval Since Last Report: 304735 secCrashes Since Last Report: 12Per-App Interval Since Last Report: 97 secPer-App Crashes Since Last Report: 7Anonymous UUID: 78EE1B1C-FD64-428B-AED4-B0B834448ADFException Type: EXC_BAD_ACCESS (SIGBUS)Exception Codes: KERN_PROTECTION_FAILURE at 0x0000000000000005Crashed Thread: 0 Dispatch queue: com.apple.main-threadThread 0 Crashed: Dispatch queue: com.apple.main-thread0 libvclmxi.dylib 0x01782d66 ImplFontCharMap::DeReference() const + 541 libvclmxi.dylib 0x017832a4 FontCharMap::~FontCharMap() + 202 libvclmxi.dylib 0x017a203e OutputDevice::HasGlyphs(Font const&, String const&, unsigned short, unsigned short) const + 1903 libvclmxi.dylib 0x01934a09 Window::IsMouseCaptured() const + 7294 libvclmxi.dylib 0x01945d97 Window::doLazyDelete() + 40235 libvclmxi.dylib 0x01713767 Application::MergeSystemSettings(AllSettings&) + 716 libsvtmxi.dylib 0x00a4921c SvtTabAppearanceCfg::SetApplicationDefaults(Application*) + 4127 libsofficeapp.dylib 0x0006a1c6 0x58000 + 741828 libvclmxi.dylib 0x0171b3e8 DeInitVCL() + 36249 libvclmxi.dylib 0x01a1e8fb component_getFactory + 20951510 libvclmxi.dylib 0x01a23d2b SalGetDesktopEnvironment() + 2089111 com.apple.AppKit 0x949182a7 -[NSApplication run] + 91712 com.apple.AppKit 0x949102d9 NSApplicationMain + 57413 libvclmxi.dylib 0x01a1f687 SalGetDesktopEnvironment() + 280714 libvclmxi.dylib 0x0171b491 SVMain() + 1715 libsofficeapp.dylib 0x00096f25 soffice_main + 24516 org.libreoffice.script 0x00001ebe main + 3017 org.libreoffice.script 0x00001822 start + 25818 org.libreoffice.script 0x00001749 start + 41Thread 1:0 libSystem.B.dylib 0x9733e0fa semaphore_timedwait_signal_trap + 101 libSystem.B.dylib 0x9736bc85 _pthread_cond_wait + 10662 libSystem.B.dylib 0x973b466c pthread_cond_timedwait + 473 libuno_sal.dylib.3 0x00035e48 rtl_cache_create + 7284 libSystem.B.dylib 0x9736b7fd _pthread_start + 3455 libSystem.B.dylib 0x9736b682 thread_start + 34Thread 2: Dispatch queue: com.apple.libdispatch-manager0 libSystem.B.dylib 0x97364922 kevent + 101 libSystem.B.dylib 0x9736503c _dispatch_mgr_invoke + 2152 libSystem.B.dylib 0x973644f9 _dispatch_queue_invoke + 1633 libSystem.B.dylib 0x9736429e _dispatch_worker_thread2 + 2404 libSystem.B.dylib 0x97363d21 _pthread_wqthread + 3905 libSystem.B.dylib 0x97363b66 start_wqthread + 30Thread 3:0 libSystem.B.dylib 0x9740541e accept$NOCANCEL$UNIX2003 + 101 libSystem.B.dylib 0x97404286 accept + 322 libuno_sal.dylib.3 0x00011d4a osl_acceptPipe + 583 libsofficeapp.dylib 0x00093a6e 0x58000 + 2443344 libsofficeapp.dylib 0x00095c62 0x58000 + 2530265 libuno_sal.dylib.3 0x0000c1a9 osl_setThreadName + 5696 libSystem.B.dylib 0x9736b7fd _pthread_start + 3457 libSystem.B.dylib 0x9736b682 thread_start + 34Thread 4:0 libSystem.B.dylib 0x973639b2 __workq_kernreturn + 101 libSystem.B.dylib 0x97363f48 _pthread_wqthread + 9412 libSystem.B.dylib 0x97363b66 start_wqthread + 30Thread 0 crashed with X86 Thread State (32-bit): eax: 0x00000001 ebx: 0x019348b0 ecx: 0x00000065 edx: 0x183a4b80 edi: 0x00000041 esi: 0xbffff2c8 ebp: 0xbffff258 esp: 0xbffff258 ss: 0x0000001f efl: 0x00010202 eip: 0x01782d66 cs: 0x00000017 ds: 0x0000001f es: 0x0000001f fs: 0x00000000 gs: 0x00000037 cr2: 0x00000005Binary Images: 0x1000 - 0x1ff7 +org.libreoffice.script 3.4.0 (???) <8D38ED52-0788-1BB7-5A00-5E884D2870F1> /Applications/LibreOffice.app/Contents/MacOS/soffice 0x5000 - 0x45ff3 +libuno_sal.dylib.3 ??? (???) <9C8D0625-05E6-1D2D-DBFE-BE0842100B12> /Applications/LibreOffice.app/Contents/basis-link/ure-link/lib/libuno_sal.dylib.3 0x58000 - 0xbcfe3 +libsofficeapp.dylib ??? (???) <92692F5A-FCB1-2090-D322-7AA40B3D5748> /Applications/LibreOffice.app/Contents/basis-link/program/libsofficeapp.dylib 0xd2000 - 0x1d8fff +libcomphelpgcc3.dylib ??? (???) <211F3F1D-91B0-298A-CFD7-6FCF01C1E16D> /Applications/LibreOffice.app/Contents/basis-link/program/libcomphelpgcc3.dylib 0x2a5000 - 0x341fe3 +libuno_cppuhelpergcc3.dylib.3 ??? (???) <380B4CC5-E9D4-EE94-BCE0-D77EE5BC36A7> /Applications/LibreOffice.app/Contents/basis-link/ure-link/lib/libuno_cppuhelpergcc3.dylib.3 0x362000 - 0x390ffb +libuno_cppu.dylib.3 ??? (???) <395BBCAB-D0B8-73F3-169E-5ED8784CD469> /Applications/LibreOffice.app/Contents/basis-link/ure-link/lib/libuno_cppu.dylib.3 0x398000 - 0x3b5ffb +libdeploymentmiscmxi.dylib ??? (???) <FE4FBE3B-29DD-CCB3-3DA8-CC59FA319194> /Applications/LibreOffice.app/Contents/basis-link/program/libdeploymentmiscmxi.dylib 0x3c0000 - 0x3c4ff7 +libi18nisolang1gcc3.dylib ??? (???) <1517DE63-D6B4-595E-8A8D-55C64423F62B> /Applications/LibreOffice.app/Contents/basis-link/program/libi18nisolang1gcc3.dylib 0x3c9000 - 0x70bff3 +libsfxmxi.dylib ??? (???) <A6D855F4-2F48-4FDB-6BCB-2872558F7CFA> /Applications/LibreOffice.app/Contents/basis-link/program/libsfxmxi.dylib 0x8f9000 - 0x9b7fff +libsvlmxi.dylib ??? (???) <E96F9FE1-C85A-D40B-C76B-F5033AA1A535> /Applications/LibreOffice.app/Contents/basis-link/program/libsvlmxi.dylib 0xa27000 - 0xd34fef +libsvtmxi.dylib ??? (???) <06FF18A3-FA03-C731-321C-08F455173BE8> /Applications/LibreOffice.app/Contents/basis-link/program/libsvtmxi.dylib 0xf23000 - 0x11a5ff7 +libtkmxi.dylib ??? (???) <C2C17CE0-11D6-7126-67CD-54CCD80BD766> /Applications/LibreOffice.app/Contents/basis-link/program/libtkmxi.dylib 0x146e000 - 0x14f9fe7 +libtlmxi.dylib ??? (???) <49B1347C-5C3D-4E3A-9DAE-9DDB85122262> /Applications/LibreOffice.app/Contents/basis-link/program/libtlmxi.dylib 0x1530000 - 0x1584feb +libucbhelper4gcc3.dylib ??? (???) <8A2FCA69-89D2-F4C8-67BA-77AD4131C3E5> /Applications/LibreOffice.app/Contents/basis-link/program/libucbhelper4gcc3.dylib 0x15a9000 - 0x16bbfef +libutlmxi.dylib ??? (???) <551A9BD7-91B6-053B-015F-7059D01C9637> /Applications/LibreOffice.app/Contents/basis-link/program/libutlmxi.dylib 0x1706000 - 0x1abffff +libvclmxi.dylib ??? (???) <FAB7EBAD-6EA0-2A94-6EBD-70A4FAD46EA7> /Applications/LibreOffice.app/Contents/basis-link/program/libvclmxi.dylib 0x1bc1000 - 0x1bc3ffb +libuno_salhelpergcc3.dylib.3 ??? (???) <B2A7E01D-0C36-9D70-1C1D-A9BB6F5682CC> /Applications/LibreOffice.app/Contents/basis-link/ure-link/lib/libuno_salhelpergcc3.dylib.3 0x1bc8000 - 0x1d29fe7 +libdb-4.7.dylib ??? (???) <4802510F-3AD3-E664-CFF0-A4140367A02E> /Applications/LibreOffice.app/Contents/basis-link/program/libdb-4.7.dylib 0x1d3b000 - 0x1dbaff7 +libxcrmxi.dylib ??? (???) <DD82CCB3-9F3E-7C5C-4002-98EA39B17DF0> /Applications/LibreOffice.app/Contents/basis-link/program/libxcrmxi.dylib 0x1df8000 - 0x1e9dfff +libbasegfxmxi.dylib ??? (???) <1BEA67C8-EA11-B76A-DBF5-F5971E8030C3> /Applications/LibreOffice.app/Contents/basis-link/program/libbasegfxmxi.dylib 0x1eda000 - 0x1f58fff +libfwemxi.dylib ??? (???) <457EA015-CFCE-AB8C-E00C-27E94C2518D8> /Applications/LibreOffice.app/Contents/basis-link/program/libfwemxi.dylib 0x1f9f000 - 0x1fb0fff +libsaxmxi.dylib ??? (???) <8FC349DB-5575-7C25-CD78-7318164FB4F7> /Applications/LibreOffice.app/Contents/basis-link/program/libsaxmxi.dylib 0x1fb9000 - 0x20e0ff7 +libsbmxi.dylib ??? (???) <8863BBB7-A18A-D925-EF09-2F33412B96F7> /Applications/LibreOffice.app/Contents/basis-link/program/libsbmxi.dylib 0x2194000 - 0x21d8fe3 +libsotmxi.dylib ??? (???) <6692A695-90EA-4505-CE9B-0121445ACCAC> /Applications/LibreOffice.app/Contents/basis-link/program/libsotmxi.dylib 0x2203000 - 0x2224feb +libfwimxi.dylib ??? (???) <B46E4CEE-C92E-61C0-5363-815299DB0807> /Applications/LibreOffice.app/Contents/basis-link/program/libfwimxi.dylib 0x223d000 - 0x2240feb +libi18nutilgcc3.dylib ??? (???) <FD529EAE-1A34-4E30-1809-258584FF94CF> /Applications/LibreOffice.app/Contents/basis-link/program/libi18nutilgcc3.dylib 0x2250000 - 0x2267ff7 +libjvmfwk.dylib.3 ??? (???) <5D13F7A7-42CE-062C-B765-F3CB280F2C8E> /Applications/LibreOffice.app/Contents/basis-link/ure-link/lib/libjvmfwk.dylib.3 0x226e000 - 0x2354fe7 +libicuuc.dylib.44.2 44.2.0 (compatibility 44.0.0) <4EF2B9BA-6C6B-E5D6-258C-A8518DC54443> /Applications/LibreOffice.app/Contents/basis-link/program/libicuuc.dylib.44.2 0x238e000 - 0x31cdff7 +libicudata.dylib.44.2 44.2.0 (compatibility 44.0.0) <CD11B919-996D-5A5B-7BE7-9EB405DE4C66> /Applications/LibreOffice.app/Contents/basis-link/program/libicudata.dylib.44.2 0x31d0000 - 0x31d2ffb +libi18npapermxi.dylib ??? (???) <9180821C-3025-842B-1BC0-2FE3115DC42F> /Applications/LibreOffice.app/Contents/basis-link/program/libi18npapermxi.dylib 0x31d7000 - 0x3203ff7 +libicule.dylib.44.2 44.2.0 (compatibility 44.0.0) <6A4B17E9-53AC-1CD4-FAE0-91AC4A44D5BC> /Applications/LibreOffice.app/Contents/basis-link/program/libicule.dylib.44.2 0x320b000 - 0x320eff3 +libjvmaccessgcc3.dylib.3 ??? (???) <267F6C79-8366-EFC5-944B-D19BFD6BEFD8> /Applications/LibreOffice.app/Contents/basis-link/ure-link/lib/libjvmaccessgcc3.dylib.3 0x3213000 - 0x33cbfff +libbasebmpmxi.dylib ??? (???) <3D9E0FB1-A485-7148-5237-76726C9A4DDF> /Applications/LibreOffice.app/Contents/basis-link/program/libbasebmpmxi.dylib 0x3487000 - 0x348dff7 +libAppleRemotemxi.dylib ??? (???) <522AC1CA-4C81-D36D-88D1-E9C765842DB3> /Applications/LibreOffice.app/Contents/basis-link/program/libAppleRemotemxi.dylib 0x3799000 - 0x37aefeb +libreg.dylib.3 ??? (???) <1B0CB86A-F1FD-C798-D862-300AB3487049> /Applications/LibreOffice.app/Contents/basis-link/ure-link/lib/libreg.dylib.3 0x37b4000 - 0x37baff3 +libxmlreader.dylib ??? (???) <10DC5408-1D4A-6B4A-5591-F034E1C80866> /Applications/LibreOffice.app/Contents/basis-link/ure-link/lib/libxmlreader.dylib 0x37be000 - 0x37d0ff7 +libstore.dylib.3 ??? (???) <32235E51-3009-3097-FFE3-92798380C708> /Applications/LibreOffice.app/Contents/basis-link/ure-link/lib/libstore.dylib.3 0x37d5000 - 0x37e1fff +libgcc3_uno.dylib ??? (???) <597B8E70-8E69-57DD-05E5-E52395CB491E> /Applications/LibreOffice.app/Contents/basis-link/ure-link/lib/libgcc3_uno.dylib 0x4200000 - 0x42a4fff +bootstrap.uno.dylib ??? (???) <C29601DC-C258-7585-0E62-0B1E182E691B> /Applications/LibreOffice.app/Contents/basis-link/ure-link/lib/bootstrap.uno.dylib 0x4639000 - 0x464effb +stocservices.uno.dylib ??? (???) <30A97D48-FB52-698F-CA8E-94AC2302322D> /Applications/LibreOffice.app/Contents/basis-link/ure-link/lib/stocservices.uno.dylib 0x475e000 - 0x476bff7 com.apple.iokit.IOHIDLib 1.6.5 (1.6.5) <FD60CB35-DAC1-D320-503E-80F6C059DA98> /System/Library/Extensions/IOHIDFamily.kext/Contents/PlugIns/IOHIDLib.plugin/Contents/MacOS/IOHIDLib 0x477b000 - 0x47e3fff +configmgr.uno.dylib ??? (???) <CBE2968C-9DAE-A38D-6E9E-227CA4BD7EAF> /Applications/LibreOffice.app/Contents/basis-link/program/configmgr.uno.dylib 0x47f8000 - 0x47fbffb +localebe1.uno.dylib ??? (???) <BA668AA4-4DAF-712A-820D-25E27094E879> /Applications/LibreOffice.app/Contents/basis-link/program/localebe1.uno.dylib0x17cab000 - 0x17caffff +macbe1.uno.dylib ??? (???) <BDC9D7DF-7F8B-5C17-21CC-358C9B60C66C> /Applications/LibreOffice.app/Contents/basis-link/program/macbe1.uno.dylib0x17dc0000 - 0x17de0fef +libsplmxi.dylib ??? (???) <ED32885C-2C7F-36BD-D433-B11179C649B2> /Applications/LibreOffice.app/Contents/basis-link/program/libsplmxi.dylib0x18400000 - 0x1855afff +i18npool.uno.dylib ??? (???) <20572517-2947-410E-21FB-1B2C69E18D7C> /Applications/LibreOffice.app/Contents/basis-link/program/i18npool.uno.dylib0x18595000 - 0x186eafe7 +libicui18n.dylib.44.2 44.2.0 (compatibility 44.0.0) <455CF1B9-3E9A-F426-5E8B-0F67CCAE9A62> /Applications/LibreOffice.app/Contents/basis-link/program/libicui18n.dylib.44.20x18cb2000 - 0x18ceefeb +libucb1.dylib ??? (???) <AD5FD44C-1FFF-8098-5D70-00EB73726AF8> /Applications/LibreOffice.app/Contents/basis-link/program/libucb1.dylib0x18cfd000 - 0x18f5effb +libfwkmxi.dylib ??? (???) <BADF735F-1ABA-D18F-7D34-AC8841D49D06> /Applications/LibreOffice.app/Contents/basis-link/program/libfwkmxi.dylib0x190a5000 - 0x190f5fff +libucpfile1.dylib ??? (???) <600F9283-69B0-B0EF-615F-372564D39B52> /Applications/LibreOffice.app/Contents/basis-link/program/libucpfile1.dylib0x1cc92000 - 0x1cc97ff3 +libmcnttype.dylib ??? (???) <7D9A9419-5C70-91F6-A49D-16E2B081E8C4> /Applications/LibreOffice.app/Contents/basis-link/program/libmcnttype.dylib0x25be8000 - 0x25c3bff7 +libpackage2.dylib ??? (???) <FAB32E31-3B8E-B398-31C9-EDEADAEC3E76> /Applications/LibreOffice.app/Contents/basis-link/program/libpackage2.dylib0x25cbd000 - 0x25cd4ff7 +fsstorage.uno.dylib ??? (???) <B7FBE997-314F-2DBF-F2DA-F1AB38FE9D6D> /Applications/LibreOffice.app/Contents/basis-link/program/fsstorage.uno.dylib0x25ce8000 - 0x25d18ff7 +sax.uno.dylib ??? (???) <E9CDC8D2-71E2-1654-CFAF-3955E1565D52> /Applications/LibreOffice.app/Contents/basis-link/program/sax.uno.dylib0x8fe00000 - 0x8fe4162b dyld 132.1 (???) <A4F6ADCC-6448-37B4-ED6C-ABB2CD06F448> /usr/lib/dyld0x90003000 - 0x90049ff7 libauto.dylib ??? (???) <29422A70-87CF-10E2-CE59-FEE1234CFAAE> /usr/lib/libauto.dylib0x90052000 - 0x90074fef com.apple.DirectoryService.Framework 3.6 (621.11) <CA979EAC-9537-43B6-CD69-C144ACB75E09> /System/Library/Frameworks/DirectoryService.framework/Versions/A/DirectoryService0x90075000 - 0x90075ff7 com.apple.Carbon 150 (152) <9252D5F2-462D-2C15-80F3-109644D6F704> /System/Library/Frameworks/Carbon.framework/Versions/A/Carbon0x90153000 - 0x9021efef com.apple.CoreServices.OSServices 359 (359) <EC340F74-8192-C9DD-40B3-AE4E519A38D7> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/OSServices.framework/Versions/A/OSServices0x9021f000 - 0x9023ffe7 libresolv.9.dylib 41.0.0 (compatibility 1.0.0) <751955F3-21FB-A03A-4E92-1F3D4EFB8C5B> /usr/lib/libresolv.9.dylib0x90240000 - 0x90240ff7 liblangid.dylib ??? (???) <B99607FC-5646-32C8-2C16-AFB5EA9097C2> /usr/lib/liblangid.dylib0x9036e000 - 0x90371ffb com.apple.help 1.3.1 (41) <67F1F424-3983-7A2A-EC21-867BE838E90B> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Help.framework/Versions/A/Help0x906f3000 - 0x909ecfef com.apple.QuickTime 7.6.6 (1756.15) <C2567783-4EAC-6803-522B-D701B95C4DAE> /System/Library/Frameworks/QuickTime.framework/Versions/A/QuickTime0x909ed000 - 0x909f1ff7 libGFXShared.dylib ??? (???) <4F2199F0-320F-0B59-0380-D3131D644CBA> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGFXShared.dylib0x90b35000 - 0x90c36fe7 libxml2.2.dylib 10.3.0 (compatibility 10.0.0) <C75F921C-F027-6372-A0A1-EDB8A6234331> /usr/lib/libxml2.2.dylib0x90c37000 - 0x90c94ff7 com.apple.framework.IOKit 2.0 (???) <A769737F-E0D6-FB06-29B4-915CF4F43420> /System/Library/Frameworks/IOKit.framework/Versions/A/IOKit0x90c95000 - 0x90cc6ff7 libGLImage.dylib ??? (???) <1AF72191-087A-5D75-B3B9-3F537315F635> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGLImage.dylib0x90cc7000 - 0x910ddff7 libBLAS.dylib 219.0.0 (compatibility 1.0.0) <C4FB303A-DB4D-F9E8-181C-129585E59603> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib0x910de000 - 0x91127fe7 libTIFF.dylib ??? (???) <5CE284EC-F637-EDBB-FDB3-61E86407CBB8> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/Resources/libTIFF.dylib0x91128000 - 0x9112efe7 com.apple.CommerceCore 1.0 (9) <928FCA4F-1366-AE18-CF67-87C79F5DAC21> /System/Library/PrivateFrameworks/CommerceKit.framework/Versions/A/Frameworks/CommerceCore.framework/Versions/A/CommerceCore0x91132000 - 0x9114efe3 com.apple.openscripting 1.3.1 (???) <DA16DE48-59F4-C94B-EBE3-7FAF772211A2> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/OpenScripting.framework/Versions/A/OpenScripting0x9114f000 - 0x9115cff7 com.apple.NetFS 3.2.2 (3.2.2) <DDC9C397-C35F-8D7A-BB24-3D1B42FA5FAB> /System/Library/Frameworks/NetFS.framework/Versions/A/NetFS0x9133a000 - 0x91341ff3 com.apple.print.framework.Print 6.1 (237.1) <F5AAE53D-5530-9004-A9E3-2C1690C5328E> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Print.framework/Versions/A/Print0x913b8000 - 0x913baff7 libRadiance.dylib ??? (???) <B83179D4-E41C-D2BA-1E4C-A64CB45C15E6> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/Resources/libRadiance.dylib0x913f7000 - 0x91762ff7 com.apple.QuartzCore 1.6.3 (227.36) <8E927524-EB0A-D5BA-C2E4-FA26FE4C428A> /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore0x91763000 - 0x91763ff7 com.apple.Accelerate 1.6 (Accelerate 1.6) <BC501C9F-7C20-961A-B135-0A457667D03C> /System/Library/Frameworks/Accelerate.framework/Versions/A/Accelerate0x917bf000 - 0x918fbff7 com.apple.audio.toolbox.AudioToolbox 1.6.6 (1.6.6) <781018FB-474B-E09C-D419-5BFF80590A10> /System/Library/Frameworks/AudioToolbox.framework/Versions/A/AudioToolbox0x91a05000 - 0x91a1afff com.apple.ImageCapture 6.0.2 (6.0.2) <E9F4B952-27A1-5BFC-CA8D-DADA055D30E9> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/ImageCapture.framework/Versions/A/ImageCapture0x91cc8000 - 0x91d70ffb com.apple.QD 3.36 (???) <FA2785A4-BB69-DCB4-3BA3-7C89A82CAB41> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/QD.framework/Versions/A/QD0x9282c000 - 0x9282fff7 libCGXType.A.dylib 545.0.0 (compatibility 64.0.0) <B84D7376-EE9C-2B7F-04FA-D622E2C10CA6> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/Resources/libCGXType.A.dylib0x92884000 - 0x92921fe3 com.apple.LaunchServices 362.2 (362.2) <F3952CAB-322F-A12F-57AF-8B91B1D76DDE> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/LaunchServices.framework/Versions/A/LaunchServices0x92922000 - 0x92922ff7 com.apple.ApplicationServices 38 (38) <8012B504-3D83-BFBB-DA65-065E061CFE03> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/ApplicationServices0x929ef000 - 0x92a59fe7 libstdc++.6.dylib 7.9.0 (compatibility 7.0.0) <411D87F4-B7E1-44EB-F201-F8B4F9227213> /usr/lib/libstdc++.6.dylib0x92a5a000 - 0x92a9efe7 com.apple.Metadata 10.6.3 (507.15) <A23633F1-E913-66C2-A073-E2B174C09B18> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/Metadata.framework/Versions/A/Metadata0x92a9f000 - 0x92b0eff7 libvMisc.dylib 268.0.1 (compatibility 1.0.0) <2FC2178F-FEF9-6E3F-3289-A6307B1A154C> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libvMisc.dylib0x92b0f000 - 0x92b42ff7 com.apple.AE 496.4 (496.4) <7F34EC47-8429-3077-8158-54F5EA908C66> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/AE.framework/Versions/A/AE0x92b80000 - 0x92b8affb com.apple.speech.recognition.framework 3.11.1 (3.11.1) <EC0E69C8-A121-70E8-43CF-E6FC4C7779EC> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/SpeechRecognition.framework/Versions/A/SpeechRecognition0x92b8b000 - 0x92eabff3 com.apple.CoreServices.CarbonCore 861.34 (861.34) <3DA9098F-B71B-4BDE-5DE5-4B76C49158EB> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/CarbonCore.framework/Versions/A/CarbonCore0x92eac000 - 0x92eadff7 com.apple.audio.units.AudioUnit 1.6.6 (1.6.6) <253E9552-5CEA-0D5A-1EDA-3B8F669B79EA> /System/Library/Frameworks/AudioUnit.framework/Versions/A/AudioUnit0x9346d000 - 0x93478ff7 libGL.dylib ??? (???) <4425B9AA-B494-A336-EABB-6BBC9FF4EC4F> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib0x93784000 - 0x93788ff7 IOSurface ??? (???) <D849E1A5-6B0C-2A05-2765-850EC39BA2FF> /System/Library/Frameworks/IOSurface.framework/Versions/A/IOSurface0x93789000 - 0x93795ff7 libkxld.dylib ??? (???) <F0E915AD-6B32-0D5E-D24B-B188447FDD23> /usr/lib/system/libkxld.dylib0x93796000 - 0x93950feb com.apple.ImageIO.framework 3.0.4 (3.0.4) <C96F11A7-2569-3037-C4C3-0342708FA3CB> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/ImageIO0x93951000 - 0x9399efeb com.apple.DirectoryService.PasswordServerFramework 6.1 (6.1) <136BFA48-D456-B677-3B5D-40A6946C3A09> /System/Library/PrivateFrameworks/PasswordServer.framework/Versions/A/PasswordServer0x93d51000 - 0x93e0afe7 libsqlite3.dylib 9.6.0 (compatibility 9.0.0) <52438E77-55D1-C231-1936-76F1369518E4> /usr/lib/libsqlite3.dylib0x94063000 - 0x94111ff3 com.apple.ink.framework 1.3.3 (107) <57B54F6F-CE35-D546-C7EC-DBC5FDC79938> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Ink.framework/Versions/A/Ink0x94216000 - 0x94228ff7 com.apple.MultitouchSupport.framework 207.10 (207.10) <E1A6F663-570B-CE54-0F8A-BBCCDECE3B42> /System/Library/PrivateFrameworks/MultitouchSupport.framework/Versions/A/MultitouchSupport0x94229000 - 0x94335ff7 libGLProgrammability.dylib ??? (???) <2D172B4E-432F-D18E-EA99-3BD56DBE7649> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGLProgrammability.dylib0x94336000 - 0x94338ff7 com.apple.securityhi 4.0 (36638) <38D36D4D-C798-6ACE-5FA8-5C001993AD6B> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/SecurityHI.framework/Versions/A/SecurityHI0x94339000 - 0x9433ffff com.apple.CommonPanels 1.2.4 (91) <2438AF5D-067B-B9FD-1248-2C9987F360BA> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/CommonPanels.framework/Versions/A/CommonPanels0x9436e000 - 0x944f0fe7 libicucore.A.dylib 40.0.0 (compatibility 1.0.0) <D375C1CF-C88D-C5F6-3C49-CD429023FBAC> /usr/lib/libicucore.A.dylib0x94532000 - 0x94536ff7 libGIF.dylib ??? (???) <447BC6E8-4C56-3D5D-983B-6BEA0D26F319> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/Resources/libGIF.dylib0x94537000 - 0x94541fe7 com.apple.audio.SoundManager 3.9.3 (3.9.3) <5F494955-7290-2D91-DA94-44B590191771> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/CarbonSound.framework/Versions/A/CarbonSound0x94542000 - 0x947a7feb com.apple.security 6.1.2 (55002) <7F00A51B-F22A-0EBC-A321-923472D686BD> /System/Library/Frameworks/Security.framework/Versions/A/Security0x94863000 - 0x9490dfe7 com.apple.CFNetwork 454.11.12 (454.11.12) <BE832CCE-B692-F55F-F5F8-3973649AFEA1> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/CFNetwork.framework/Versions/A/CFNetwork0x9490e000 - 0x951eeff7 com.apple.AppKit 6.6.7 (1038.35) <ABC7783C-E4D5-B848-BED6-99451D94D120> /System/Library/Frameworks/AppKit.framework/Versions/C/AppKit0x9525e000 - 0x953d9fe7 com.apple.CoreFoundation 6.6.4 (550.42) <C78D5079-663E-9734-7AFA-6CE79A0539F1> /System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation0x954c3000 - 0x95527ffb com.apple.htmlrendering 72 (1.1.4) <4D451A35-FAB6-1288-71F6-F24A4B6E2371> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/HTMLRendering.framework/Versions/A/HTMLRendering0x95570000 - 0x9557efe7 libz.1.dylib 1.2.3 (compatibility 1.0.0) <3CE8AA79-F077-F1B0-A039-9103A4A02E92> /usr/lib/libz.1.dylib0x95630000 - 0x95630ff7 com.apple.vecLib 3.6 (vecLib 3.6) <7362077A-890F-3AEF-A8AB-22247B10E106> /System/Library/Frameworks/vecLib.framework/Versions/A/vecLib0x95631000 - 0x95655ff7 libJPEG.dylib ??? (???) <A50127EB-C202-0436-E62D-41E2E893E436> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/Resources/libJPEG.dylib0x95687000 - 0x95687ff7 com.apple.Cocoa 6.6 (???) <EA27B428-5904-B00B-397A-185588698BCC> /System/Library/Frameworks/Cocoa.framework/Versions/A/Cocoa0x95688000 - 0x95691ff7 com.apple.DiskArbitration 2.3 (2.3) <E9C40767-DA6A-6CCB-8B00-2D5706753000> /System/Library/Frameworks/DiskArbitration.framework/Versions/A/DiskArbitration0x95692000 - 0x95772fe7 com.apple.vImage 4.1 (4.1) <D029C515-08E1-93A6-3705-DD062A3A672C> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vImage.framework/Versions/A/vImage0x95773000 - 0x95784ff7 com.apple.LangAnalysis 1.6.6 (1.6.6) <97511CC7-FE23-5AC3-2EE2-B5479FAEB316> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/LangAnalysis.framework/Versions/A/LangAnalysis0x95785000 - 0x957adff7 libxslt.1.dylib 3.24.0 (compatibility 3.0.0) <769EF4B2-C1AD-73D5-AAAD-1564DAEA77AF> /usr/lib/libxslt.1.dylib0x957ae000 - 0x957b9ff7 libCSync.A.dylib 545.0.0 (compatibility 64.0.0) <4560936D-7730-5DD2-BFD7-95270DDC210A> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/Resources/libCSync.A.dylib0x957ba000 - 0x957ceffb com.apple.speech.synthesis.framework 3.10.35 (3.10.35) <57DD5458-4F24-DA7D-0927-C3321A65D743> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/SpeechSynthesis.framework/Versions/A/SpeechSynthesis0x95b52000 - 0x95b52ff7 com.apple.Accelerate.vecLib 3.6 (vecLib 3.6) <1DEC639C-173D-F808-DE0D-4070CC6F5BC7> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/vecLib0x95b53000 - 0x95b6bff7 com.apple.CFOpenDirectory 10.6 (10.6) <F9AFC571-3539-6B46-ABF9-46DA2B608819> /System/Library/Frameworks/OpenDirectory.framework/Versions/A/Frameworks/CFOpenDirectory.framework/Versions/A/CFOpenDirectory0x95ba1000 - 0x95e14fe7 com.apple.Foundation 6.6.6 (751.53) <C73FDD37-000B-C505-FD8D-80D1C9D17965> /System/Library/Frameworks/Foundation.framework/Versions/C/Foundation0x95e15000 - 0x95e29fe7 libbsm.0.dylib ??? (???) <14CB053A-7C47-96DA-E415-0906BA1B78C9> /usr/lib/libbsm.0.dylib0x95f06000 - 0x95f88ffb SecurityFoundation ??? (???) <3670AE8B-06DA-C447-EB14-79423DB9C474> /System/Library/Frameworks/SecurityFoundation.framework/Versions/A/SecurityFoundation0x95f89000 - 0x95fcbff7 libvDSP.dylib 268.0.1 (compatibility 1.0.0) <3F0ED200-741B-4E27-B89F-634B131F5E9E> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libvDSP.dylib0x95fcc000 - 0x96009ff7 com.apple.SystemConfiguration 1.10.5 (1.10.2) <362DF639-6E5F-9371-9B99-81C581A8EE41> /System/Library/Frameworks/SystemConfiguration.framework/Versions/A/SystemConfiguration0x9615c000 - 0x961acff7 com.apple.framework.familycontrols 2.0.2 (2020) <C96C8A99-A40C-8B9C-1FBA-A0F46AC92F17> /System/Library/PrivateFrameworks/FamilyControls.framework/Versions/A/FamilyControls0x961f6000 - 0x96239ff7 com.apple.NavigationServices 3.5.4 (182) <753B8906-06C0-3AE0-3D6A-8FF5AC18ED12> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/NavigationServices.framework/Versions/A/NavigationServices0x9623a000 - 0x9655efef com.apple.HIToolbox 1.6.5 (???) <21164164-41CE-61DE-C567-32E89755CB34> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/HIToolbox.framework/Versions/A/HIToolbox0x965a6000 - 0x966aafe7 libcrypto.0.9.8.dylib 0.9.8 (compatibility 0.9.8) <BDEFA030-5E75-7C47-2904-85AB16937F45> /usr/lib/libcrypto.0.9.8.dylib0x966ab000 - 0x96725fff com.apple.audio.CoreAudio 3.2.6 (3.2.6) <F7C9B01D-45AD-948B-2D26-9736524C1A33> /System/Library/Frameworks/CoreAudio.framework/Versions/A/CoreAudio0x96726000 - 0x96761feb libFontRegistry.dylib ??? (???) <4FB144ED-8AF9-27CF-B315-DCE5575D5231> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/Resources/libFontRegistry.dylib0x96762000 - 0x967fdff7 com.apple.ApplicationServices.ATS 4.4 (???) <FD63F92B-8DDE-4DBA-A7A5-0294E3607083> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/ATS0x967fe000 - 0x9687efeb com.apple.SearchKit 1.3.0 (1.3.0) <9E18AEA5-F4B4-8BE5-EEA9-818FC4F46FD9> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/SearchKit.framework/Versions/A/SearchKit0x969c3000 - 0x969c8ff7 com.apple.OpenDirectory 10.6 (10.6) <C1B46982-7D3B-3CC4-3BC2-3E4B595F0231> /System/Library/Frameworks/OpenDirectory.framework/Versions/A/OpenDirectory0x96a1a000 - 0x96bf6ffb libType1Scaler.dylib ??? (???) <494D1BE1-8395-9A53-1224-1CFD4236D40E> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/Resources/libType1Scaler.dylib0x96bf7000 - 0x96c3bff3 com.apple.coreui 2 (114) <29F8F1A4-1C96-6A0F-4CC2-9B85CF83209F> /System/Library/PrivateFrameworks/CoreUI.framework/Versions/A/CoreUI0x96c80000 - 0x96c9fff7 com.apple.CoreVideo 1.6.2 (45.6) <EB53CAA4-5EE2-C356-A954-5775F7DDD493> /System/Library/Frameworks/CoreVideo.framework/Versions/A/CoreVideo0x96cde000 - 0x97113ff7 libLAPACK.dylib 219.0.0 (compatibility 1.0.0) <5E2D2283-57DE-9A49-1DB0-CD027FEFA6C2> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libLAPACK.dylib0x97254000 - 0x97301fe7 libobjc.A.dylib 227.0.0 (compatibility 1.0.0) <DF8E4CFA-3719-3415-0BF1-E8C5E561C3B1> /usr/lib/libobjc.A.dylib0x97339000 - 0x9733cfe7 libmathCommon.A.dylib 315.0.0 (compatibility 1.0.0) <1622A54F-1A98-2CBE-B6A4-2122981A500E> /usr/lib/system/libmathCommon.A.dylib0x9733d000 - 0x974e4ff7 libSystem.B.dylib 125.2.10 (compatibility 1.0.0) <ADF8138B-2384-2FC0-CCBF-C4721B53568A> /usr/lib/libSystem.B.dylib0x9751d000 - 0x9752dff7 libsasl2.2.dylib 3.15.0 (compatibility 3.0.0) <C8744EA3-0AB7-CD03-E639-C4F2B910BE5D> /usr/lib/libsasl2.2.dylib0x975a8000 - 0x976d6fe7 com.apple.CoreData 102.1 (251) <E6A457F0-A0A3-32CD-6C69-6286E7C0F063> /System/Library/Frameworks/CoreData.framework/Versions/A/CoreData0x976d7000 - 0x97710ff7 libcups.2.dylib 2.8.0 (compatibility 2.0.0) <90C5DE81-1BEF-D807-A898-0FC19BDD14EC> /usr/lib/libcups.2.dylib0x9774a000 - 0x9776bfe7 com.apple.opencl 12.3.6 (12.3.6) <B4104B80-1CB3-191C-AFD3-697843C6BCFF> /System/Library/Frameworks/OpenCL.framework/Versions/A/OpenCL0x9776c000 - 0x9779fffb libTrueTypeScaler.dylib ??? (???) <574C2C51-65EC-7D2A-086D-C9312287DE22> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/Resources/libTrueTypeScaler.dylib0x986f4000 - 0x98ee3557 com.apple.CoreGraphics 1.545.0 (???) <8A4CB0D9-1001-0F62-4DA4-B8AB3B45E226> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/CoreGraphics0x98ee4000 - 0x98ef2ff7 com.apple.opengl 1.6.12 (1.6.12) <81AEF74E-E33A-B021-9CDB-6199104105FF> /System/Library/Frameworks/OpenGL.framework/Versions/A/OpenGL0x98ef3000 - 0x98f8bfe7 edu.mit.Kerberos 6.5.11 (6.5.11) <F36DB665-A88B-7F5B-6244-6A2E7FFFF668> /System/Library/Frameworks/Kerberos.framework/Versions/A/Kerberos0x98f8c000 - 0x99066ffb com.apple.DesktopServices 1.5.10 (1.5.10) <2BA08DD4-35A2-A0FF-ADEA-B381F0CEEB81> /System/Library/PrivateFrameworks/DesktopServicesPriv.framework/Versions/A/DesktopServicesPriv0x99067000 - 0x990b8ff7 com.apple.HIServices 1.8.2 (???) <F6EAC2D1-902A-9374-FC4B-43B50E054416> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/HIServices.framework/Versions/A/HIServices0x991ae000 - 0x991aeff7 com.apple.CoreServices 44 (44) <51CFA89A-33DB-90ED-26A8-67D461718A4A> /System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices0x991af000 - 0x99266feb libFontParser.dylib ??? (???) <DDBBB503-5289-2E2B-AD35-F3BA00D00D5F> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/Resources/libFontParser.dylib0x99700000 - 0x997bcfff com.apple.ColorSync 4.6.6 (4.6.6) <D00B95AE-2379-CB8E-B18C-FF5B66741C23> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ColorSync.framework/Versions/A/ColorSync0x997bd000 - 0x997e3ffb com.apple.DictionaryServices 1.1.2 (1.1.2) <43E1D565-6E01-3681-F2E5-72AE4C3A097A> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/DictionaryServices.framework/Versions/A/DictionaryServices0x997e4000 - 0x99825ff7 libRIP.A.dylib 545.0.0 (compatibility 64.0.0) <95079B56-0B7B-F114-5C43-5220DBE0FBB1> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/Resources/libRIP.A.dylib0x99826000 - 0x99841ff7 libPng.dylib ??? (???) <65E824F7-523A-CC34-ABDD-2A3B12DE1CA9> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/Resources/libPng.dylib0x9984a000 - 0x9984dff7 libCoreVMClient.dylib ??? (???) <12EF6056-7AC7-6691-75A2-BD0675C56A35> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libCoreVMClient.dylib0x9984e000 - 0x9984fff7 com.apple.TrustEvaluationAgent 1.1 (1) <6C04C4C5-667E-2EBE-EB96-5B67BD4B2185> /System/Library/PrivateFrameworks/TrustEvaluationAgent.framework/Versions/A/TrustEvaluationAgent0x99850000 - 0x998e2fe7 com.apple.print.framework.PrintCore 6.3 (312.7) <7410D1B2-655D-68DA-D4B9-2C65747B6817> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/PrintCore.framework/Versions/A/PrintCore0x998e3000 - 0x99944fe7 com.apple.CoreText 3.151.8 (???) <6F5D6C49-4693-B9B7-6612-832E8F155747> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreText.framework/Versions/A/CoreText0x99a55000 - 0x99a98ff7 libGLU.dylib ??? (???) <2C7B2727-26F6-F29D-9D15-33044E87359F> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGLU.dylib0xffff0000 - 0xffff1fff libSystem.B.dylib ??? (???) <ADF8138B-2384-2FC0-CCBF-C4721B53568A> /usr/lib/libSystem.B.dylibModel: MacBookPro5,4, BootROM MBP53.00AC.B03, 2 processors, Intel Core 2 Duo, 2.53 GHz, 4 GB, SMC 1.49f2Graphics: NVIDIA GeForce 9400M, NVIDIA GeForce 9400M, PCI, 256 MBMemory Module: global_nameAirPort: spairport_wireless_card_type_airport_extreme (0x14E4, 0x8D), Broadcom BCM43xx 1.0 (5.10.131.36.9)Bluetooth: Version 2.4.0f1, 2 service, 12 devices, 1 incoming serial portsNetwork Service: AirPort, AirPort, en1Serial ATA Device: Hitachi HTS545025B9SA02, 232,89 GBSerial ATA Device: MATSHITADVD-R UJ-868USB Device: Built-in iSight, 0x05ac (Apple Inc.), 0x8507, 0x24400000USB Device: Apple Internal Keyboard / Trackpad, 0x05ac (Apple Inc.), 0x0237, 0x04600000USB Device: IR Receiver, 0x05ac (Apple Inc.), 0x8242, 0x04500000USB Device: Internal Memory Card Reader, 0x05ac (Apple Inc.), 0x8403, 0x26500000USB Device: BRCM2046 Hub, 0x0a5c (Broadcom Corp.), 0x4500, 0x06100000USB Device: Bluetooth USB Host Controller, 0x05ac (Apple Inc.), 0x8213, 0x06110000
id=36982	When loading a docx file, Writer will not load an Equation created in MS Word, and any text after it.This is a regression. This didn't happen in LO 3.3.2. In Writer 3.3.2 the document is fully loaded and the Equation is displayed and opened in MS Equation Editor for editing.Just for the record it didn't happen in OOo Writer 3.3 either. But OOo 3.4 Beta loads the whole text and just ignores the Equation. @:Please attach a sample document!Createddocx sample file with text and equation on the second pageI did add the attachment when I submitted the bug report... Apparently it wasn't uploaded...*** This bug has been marked as a duplicate of***huh, seems I marked this as a duplicate of the wrong bug ;-(But.. I was able to reproduce this on windows but not on linux ( although my linux build is the latest build of the 3.4 branch ) I need to install the official 3.4 to check if this is really fixed in later builds or just a windows only bugseems this really is windows specific ( which seems weird ) tor, could you have a look pleaseI opened the document in LibreOffice 3.3.2 under Ubuntu 10.04 and the equation does show up. Double clicking the equation opens it in LO Math. But clicking on the equation crashes LO every time.It seems my results confirm Noel's suspect, problem is [Reproducible] with reporter's sample document and "LibreOffice 3.4Beta5 – WIN7 Home Premium (64bit) English UI [DEV300m103 (Build:5)]", equation and following text are not shown.MS WORD Viewer shows equation and following text.Can't test with my own documents, it seems LibO does not export Math objects from Writer to docx (math formula invisible when reopen in LibO and also in MS WORD Viewer, but text behind missing formula object visible).I modified Status to Assigned due to facts.Since this is a regression from 3.3.2 and it prevents loading of documents, shouldn't it be considered a blocker and get higher importance?@:<>!May be you should ask for an answer before you modify the fields? I doubt that this one is a blocker due to the definitions<>, other docx problems mostly are classified with importance "medium / normal", so it will be difficult to substantiate a "blocker":<>Comparing this issue with all other 100000 things on the to do list i can't see more importance for this one than "medium / normal". Please keep in mind that an other "critical" fix would have to be shifted to 3.4.1 in favor of this one, can you decide which one it will be?You are right about the version. Sorry.My point is that this is a REGRESSION and causes DATA LOSS. But you are correct that it only applies to docx. Are all the docx problems the same degree of importance?In 3.4rc1 I get a crash, even, when opening the sample document from.This bug is fixed in MinGW build 93e3a869-b211287-090bcba-45cf606 but not in the MSVC build 130028f-b211287-090bcba-45cf606-05891e7.Does this information help?***has been marked as a duplicate of this bug. ***Hint:"Opening of docx-file with mathematical formulas crashed writer. (Sample provided)" is a duplicate of this bug, I think, but the additional comments tocontain some information which may be helpful for fixing this bug ...Under some circumstances (not sure, when) Writer just ignores the contents of the DOCX file after (and including) the first formula, under other circumstances Writer crashes opening the DOCX file. Not sure what makes the difference. Both phenomena happen on Windows only, of course.***has been marked as a duplicate of this bug. ***could be considered more important ?Hmm medium/high is for the dev to set, IIRC, so could be blocker in stead of major .. ?)I can confirm, but I have no idea how to debug a windows-only problem.Lubos - it is rather hard; is the import valgrind clean ?It is valgrind-clean.I increase the priority and severity because it causes data loos. See also the.This is the stack trace I get:00 00e3b900 00e3b8dc 1450d122 ooxmllo!boost::detail::sp_counted_base::add_ref_copy+0x1201 0f836dc4 87a1cce9 00e3b8fc ooxmllo!boost::detail::shared_count::shared_count+0x2302 0f836dc0 87a1cd2d 0f838858 ooxmllo!boost::shared_ptr<writerfilter::ooxml::OOXMLProperty>::shared_ptr<writerfilter::ooxml::OOXMLProperty>+0x4203 00e3b940 87a1cd61 0f835388 ooxmllo!writerfilter::ooxml::OOXMLPropertySetImpl::resolve+0x6104 0016014b 0f7ef2c8 0016014b ooxmllo!writerfilter::ooxml::OOXMLFastContextHandlerProperties::handleOLE+0x7505 091905a8 87a1cdad 0f7ef2c8 ooxmllo!writerfilter::ooxml::OOXMLFactory_vml_officeDrawing::endAction+0x4606 091905a8 0007010f 87a1cdf9 ooxmllo!writerfilter::ooxml::OOXMLFactory::endAction+0x7207 0007010f 091905a8 00e3ba0c ooxmllo!writerfilter::ooxml::OOXMLFastContextHandler::lcl_endAction+0x5b08 0007010f 87a1ce39 0f8388e8 ooxmllo!writerfilter::ooxml::OOXMLFastContextHandler::endAction+0x1b09 0007010f 00e3ba6c 0f3962d3 ooxmllo!writerfilter::ooxml::OOXMLFastContextHandlerProperties::lcl_endFastElement+0x340a 091905bc 0007010f 87ad165f ooxmllo!writerfilter::ooxml::OOXMLFastContextHandler::endFastElement+0x180b 0f806638 0f5b9a28 00e3bb44 fastsax_uno!sax_fastparser::FastSaxParser::callbackEndElement+0x1030c 0f5b9a28 0f806638 00000001 fastsax_uno!call_callbackEndElement+0x160d 0f77f2c8 00000000 0f3c9cf0 fastsax_uno!doContent+0x8420e 0f77f2c8 0f80ca51 0f810a18 fastsax_uno!contentProcessor+0x380f 0f77f2c8 0f3c9cf0 0f80ca51 fastsax_uno!doProlog+0x7e210 0f77f2c8 0f80ca18 0f810a18 fastsax_uno!prologProcessor+0x6f11 0f77f2c8 0f80ca18 0f810a18 fastsax_uno!prologInitProcessor+0x4012 0f77f2c8 00004000 00000000 fastsax_uno!XML_ParseBuffer+0xc813 0f77f2c8 0f620010 00004000 fastsax_uno!XML_Parse+0x1c214 87ad1367 00e3f8e0 00000000 fastsax_uno!sax_fastparser::FastSaxParser::parse+0xbf15 0f5b9a3c 00e3bfcc 87a1cbc1 fastsax_uno!sax_fastparser::FastSaxParser::parseStream+0x3eb16 0f7d3f84 87bf5cbd 00e3f8e0 ooxmllo!writerfilter::ooxml::OOXMLDocumentImpl::resolve+0x29317 0f5d3f8c 00e3c49c 93842a8b writerfilterlo!WriterFilter::filter+0x7eb18 0f777348 00000000 938429bf sfxlo!SfxObjectShell::ImportFrom+0x92319 0f777348 9384272b 03f98548 sfxlo!SfxObjectShell::DoLoad+0xc6c1a 08c7c350 00e3cab4 938425f3 sfxlo!SfxBaseModel::load+0x29f1b 0ee96a00 00e3cccc 00e3ccc8 sfxlo!SfxFrameLoader_Impl::load+0x6ec1c 93f3054b 0ed300d0 0ed300c8 fwklo!framework::LoadEnv::impl_loadContent+0xa521d 93f306a7 00e3f8e0 00000000 fwklo!framework::LoadEnv::startLoading+0xfe1e 00e3cf58 00e3cf88 00e3e158 fwklo!framework::LoadDispatcher::impl_dispatch+0x2f31f 0ed30094 00e3cf58 00e3cf88 fwklo!framework::LoadDispatcher::dispatchWithReturnValue+0x5f20 00e3d348 00e3e174 00e3d34c comphelpMSC!comphelper::SynchronousDispatch::dispatch+0x27a21 00e3e2c0 00e3e1b8 016c1052 sfxlo!SfxApplication::OpenDocExec_Impl+0x2e9722 072ddc48 00e3e2c0 072ddc48 sfxlo!SfxStubSfxApplicationOpenDocExec_Impl+0xf23 016dae70 00e3e2c0 93840c2f sfxlo!SfxShell::CallExec+0x1224 072ddc48 01ae6f4c 00e3e2c0 sfxlo!SfxDispatcher::Call_Impl+0x32725 072ddc48 01ae6f4c 00e3e2c0 sfxlo!SfxDispatcher::_Execute+0x17b26 0000157d 00000001 00000000 sfxlo!SfxDispatcher::Execute+0x11f27 0000157d 00000001 0f77c768 sfxlo!SfxDispatcher::Execute+0x1fThis bug seems to be fixed byIt has been approved and pushed for other branches as well:branch libreoffice-3-5 to be used in LO-3.5.2branch libreoffice-3-4 to be used in LO-.3.4.6:branch libreoffice-3-4-6 to be used in LO-3.4.6-rc2:
id=36275	Starting LibreOffice 3.4 beta 1 on Debian Lenny x86 fails:m@a:~ 22:50:25 $ libreoffice/opt/libreoffice/program/oosplash.bin: symbol lookup error: /opt/libreoffice/program/oosplash.bin: undefined symbol: sal_detail_initialize, version PRIVATE_1.1m@a:~ 22:50:26 $ The same with 3.4 beta 2 (still on Debian Lenny x86).I can confirm this with 3.4 beta 2 on Ubuntu 10.10.I have similar error on my Ubuntu 10.04 and LibO 3.4 b2.exec: 101: /opt/libreoffice/program/oosplash.bin: not foundIt fails with same error with 3.4 Beta 2 on Fedora 15 (so it's not just Deb specific). Appears to work fine in Wine though.Same Problem here on Fedora 14 & 15.I guess the problem might me 32-bit specific, because it started fine on my 64-bit Ubuntu 10.10.Same here on Fedora 14 i686.Does anyone actually do QA when making releases, like e.g. testing in most common Linux distros? Beta builds are at least supposed to run actually.Same on Puppy Linux, where 3.3.2 started fineSame here Ubuntu 10.04.2 32 bits...Createdpart from rpm install logrpm installation produced the attached error messagesx86/openSUSE 11.1, KDE 3.5.x(In reply to)Possibly, the above reported install errors are not related to the program start symbol lookup failure. So I created a separatefor the install issues.seems to report the same symbol lookup phenomenon.***has been marked as a duplicate of this bug. ***New beta3 still doesn't run on Linux and console still show the same error.quest@quest-desktop:/opt/libreoffice/program$ sh sofficeexec: 101: /opt/libreoffice/program/oosplash.bin: not foundquest@quest-desktop:/opt/libreoffice/program$ I don't understand how developers can release new builds if it doesn't work at all.(In reply to)1. They code for fun2. Relevant people a) are not subscribed to this bug report b) disregard emails from freedesktop bugzilla c) don't use e-mail at allSame here on Ubuntu 10.04.2 32 bits with LibO_3.4.0beta3_Linux_x86exec: 101: /opt/libreoffice/program/oosplash.bin: not foundReinstalled LibO_3.4.0beta3_Linux_x86 removing all previous libreoffice packages i get:/opt/libreoffice/program/oosplash.bin: symbol lookup error: /opt/libreoffice/program/oosplash.bin: undefined symbol: sal_detail_initialize, version PRIVATE_1.1(In reply to)It does work, but apparently not on your platform. Preventing allother users (and platforms) from testing improved builds does not seemreasonable to me. This blocks the 3.4 *release*, not updated builds.Ubuntu 10.04.2 LO 3.4beta3.$libreoffice -nologo/opt/libreoffice/program/oosplash.bin: symbol lookup error: /opt/libreoffice/program/oosplash.bin: undefined symbol: sal_detail_initialize, version PRIVATE_1.1With libreoffice3-ure_3.4.0-1_i386.deb not libreoffice3-ure_3.4.0-103_i386.deb it was similar but not exactly the same error."Greetings" from Fedora 14[caterpillar@computer ~]$ libreoffice --writer/opt/libreoffice/program/oosplash.bin: symbol lookup error: /opt/libreoffice/program/oosplash.bin: undefined symbol: sal_detail_initialize, version PRIVATE_1.1[caterpillar@computer ~]$ libreoffice -nologo/opt/libreoffice/program/oosplash.bin: symbol lookup error: /opt/libreoffice/program/oosplash.bin: undefined symbol: sal_detail_initialize, version PRIVATE_1.1"Greetings" from Fedora 14[caterpillar@computer ~]$ libreoffice --writer/opt/libreoffice/program/oosplash.bin: symbol lookup error: /opt/libreoffice/program/oosplash.bin: undefined symbol: sal_detail_initialize, version PRIVATE_1.1[caterpillar@computer ~]$ libreoffice -nologo/opt/libreoffice/program/oosplash.bin: symbol lookup error: /opt/libreoffice/program/oosplash.bin: undefined symbol: sal_detail_initialize, version PRIVATE_1.1It seems that on Ubuntu 10.04 x86_64 oosplash.bin starts and does not want to stop. After some time of inactivity it eats 100% of the CPU.I guess it is the same root cause.JBFWe are looking at it and will fix it for 3.4.0-rc1 (next build).The problem with this bug was that it had low severity too long. Hence it was hidden within other bugs.BTW1: The official 32-bit build was done on CentOS. I tested all betas on SUSE and it worked here.BTW2: We are always looking for more testers that would help with testing and triaging bugs, seeIt seems to be related to --with-linker-hash-style=both. The symbol was found after we recompiled sal with WITH_LINKER_HASH_STYLE=sysvIt is strange. We used this option even for LO-3.3. We are going to investigate it more.(In reply to)Can you please release a special fixed LO 3.4beta2 for those of us who couldn't run the official release?There's no need to announce or publish it officially, just give us a download link to binaries.Please also see:[broken debian files](Comments #10 & #11)More symbol lookup errors in debian 32bit packages (64bit packages work for me):Setting up libreoffice3-dict-en (3.4.0-103) .../opt/libreoffice/program/../basis-link/ure-link/bin/javaldx: symbol lookup error: /opt/libreoffice/ure/bin/../lib/libuno_cppuhelpergcc3.so.3: undefined symbol: _ZTIN9salhelper21SimpleReferenceObjectE, version UDK_3_0_0/opt/libreoffice/program/unopkg.bin: symbol lookup error: /opt/libreoffice/program/../basis-link/program/libxcrli.so: undefined symbol: _ZN4cppu11OWeakObject12queryAdapterEv, version UDK_3_0_0find: `/opt/libreoffice/./share/prereg/bundled': No such file or directorySetting up libreoffice3-dict-es (3.4.0-103) .../opt/libreoffice/program/../basis-link/ure-link/bin/javaldx: symbol lookup error: /opt/libreoffice/ure/bin/../lib/libuno_cppuhelpergcc3.so.3: undefined symbol: _ZTIN9salhelper21SimpleReferenceObjectE, version UDK_3_0_0/opt/libreoffice/program/unopkg.bin: symbol lookup error: /opt/libreoffice/program/../basis-link/program/libxcrli.so: undefined symbol: _ZN4cppu11OWeakObject12queryAdapterEv, version UDK_3_0_0find: `/opt/libreoffice/./share/prereg/bundled': No such file or directorySetting up libreoffice3-dict-fr (3.4.0-103) .../opt/libreoffice/program/../basis-link/ure-link/bin/javaldx: symbol lookup error: /opt/libreoffice/ure/bin/../lib/libuno_cppuhelpergcc3.so.3: undefined symbol: _ZTIN9salhelper21SimpleReferenceObjectE, version UDK_3_0_0/opt/libreoffice/program/unopkg.bin: symbol lookup error: /opt/libreoffice/program/../basis-link/program/libxcrli.so: undefined symbol: _ZN4cppu11OWeakObject12queryAdapterEv, version UDK_3_0_0find: `/opt/libreoffice/./share/prereg/bundled': No such file or directoryI rebuilt the binutils and the compiler on the 32-bit build machine. I rebuilt them again against the recently built versions and now the nightlies/dailies found here:run without problem for me on newer systems where the gnu section is used.For those that need this for testing, just grab the version from there.I rebuilt the binutils and the compiler on the 32-bit build machine. I rebuilt them again against the recently built versions and now the nightlies/dailies found here:run without problem for me on newer systems where the gnu section is used.For those that need this for testing, just grab the version from there.***has been marked as a duplicate of this bug. ***(In reply to)Thanks Fridirch, running now here and informing Dutch testers!NB. running from command line gives output FIXME: re-start with all params !something for bug, irc, list ?(In reply to)Cor, are you able to reproduce it? I have seen this once but was not able to reproduce it. If you know the steps, please open a new bug.(In reply to)Yes Petr, see(prolly two bugs in one - I will read the comments in that bug ;-) )$ md5sum libreoffice-3-4~2011-05-02_18:50:09_LibO_3.4.0beta3_Linux_x86_install-deb_en-US.tar.gz71b7f12401c0a992d88625507deb6c16 libreoffice-3-4~2011-05-02_18:50:09_LibO_3.4.0beta3_Linux_x86_install-deb_en-US.tar.gz$ md5sum libreoffice-3-4~2011-05-02_18:50:09_LibO_3.4.0beta3_Linux_x86_helppack-deb_en-US.tar.gze44acdbb3eb3b9a92dd20e22d147fa01 libreoffice-3-4~2011-05-02_18:50:09_LibO_3.4.0beta3_Linux_x86_helppack-deb_en-US.tar.gzUbuntu 10.10 (maverick) 2.6.35-29-generic #51-Ubuntu SMP Fri Apr 15 17:13:54 UTC 2011 i686 GNU/LinuxWorks for me. Thanks! Marking(broken debian files) as a dupe of 36275.***has been marked as a duplicate of this bug. ***Problem is back with today's Beta 4.(In reply to)Seems to work for me (Debian Lenny x86).Does not work for me on Fedora 14 & 15this beta4 LibO_3.4.0beta4_Linux_x86_install-deb_en-US.tar.gz)starts correct for me (Ubuntu 11.04)Ubuntu 10.04 + LibO3.4beta4: OKUbuntu 10.04 + LibO3.4beta4Now works!Works (Ubuntu 10.10). However getting:Unpacking replacement libreoffice3-dict-af .../opt/libreoffice/program/unopkg.bin: error while loading shared libraries: libjvmaccessgcc3.so.3: cannot open shared object file: No such file or directoryfind: `/opt/libreoffice/./share/prereg/bundled': No such file or directoryerrors. Maybe related to:??See the attached dpkg log.CreatedUbuntu 10.10 dpkg install log(In reply to)On my Kubuntu 32 bits Natty Narwhal machine your build worked flawlessly. As far as I am concerned you found the remedy.And it starts up as fast as lightning too!(In reply to)However not the beta4, if I understood you correct?(In reply to): do you see exactly the same error message? (undefined symbol: sal_detail_initialize) or is it different?In each case, could you please cut&paste or attach the error messages?(In reply to)NoOp@: This looks like a different problem. I have almost missed your note in this long thread. Could you please open separate bug for this?Anyway, the library is included in the package libreoffice3-ure_3.4.0-103_i386.deb in /opt/libreoffice/ure/lib. I wonder why it was not found.It works for most users now. We can't move forward without information from. It should not block that 3.4.0 release as it is now => lowering severity a bit.Beta 5 works for me now. Sorry for the delay but i was in hospital.It seems we can change to WORKSFORME if no new complaints will come?@:thank you for feedback(In reply to)Let's do it. Anyone could reopen it if needed.
id=37017	- Create presentation, simple, thus with one sheet- choose simple lay-out: title + content- add title, add some content: lines with bullets- save and close presentation- open again > bullets are lostAlso opening in previous version (3.3.2) does not show bulletsThe bullets are still available on the master page however. same effect with presentation from earlier version (eg 3.3.2)I have reproduced it with 3.4.0-beta4 build on Linux. It is very annoying and affects almost all users => critical.It is is import/export => Radek***has been marked as a duplicate of this bug. ***Radek fixed this byCreatedPresentation with wring bullets(In reply to)I'm not really sure if it's the same problem, but I still do have bullet problems in version 3.4.1 x86_64, Archlinux. With all masters, when I save the presentation and then reopen it, all bullets but the first level are changed to black standard ones. Tabs are also changed. Checking the Master shows the correct bullets.Maybe this bug should be reopened.Createdlatest test in 3.4.1Hi Martin,Works OK for me in 3.4.1Bullets and indent that I set at master page, and are applied to slide, stay OK after close and reopen..(In reply to)Thanks a lot for the quick answer. In fact, your file works flawlessly here too. Is there maybe something wrong with my master? I hardly doubt so, because it also affects the default ones which come preinstalled. I'll attach a file with many masters in it; the default ones even where modified from the master after saving the file. May you please have a look at it? I'll also attach the original master with which I'm working.CreatedAnother test with 5 mastersCreatedThe original template I'm using (I made it myself)(In reply to)I just found that the problem only happens if I select the template from the right toolbar. If I do open an already existent file and modify it (such as opening directly the template file), the problem doesn't reproduce. However, 2 files created with this 2 methods seem just the same to me, but are shown with different bullets. I'll attach a zip with both of them.Created2 almost identical files, one created with template from toolbar and the other opening a preexistent file.(In reply to)I guess you mean a templete from the 'Wizard' when starting a new presentation.Was good to test that too, indeed.I can change bullets. Close the file.On opening, I get a question: update new styles or keep old styles.When I choose the latter, my changes are still there.So lets keep this issue as resolved.If there is any issue with the offered templates, pls create a new issue and a step by step description.Thanks a lot for your help so far,Cor
id=37516	1. Open LibreOffice 3.4 RC1 Writer.2. Write a line, e.g. "This is a test."3. Save as Word 97 DOC format.4. Open the file in MS Office 2010.-> Protected View. Office has detected a problem with this file. Editing may harm your computer. Click for more details.Same sample saved from LibreOffice 3.3 is valid. CreatedValid DOC saved from LibreOffice 3.3.2CreatedInvalid DOC saved from LibreOffice 3.4 RC1Cedric, could you please have a look? IMHO, it is very annoying, ugly, and affecting many users :-(This is an annoying bug but has no reason to block 3.4.0. The file can still be edited in MSO 2010 and no warning is shown on other versions of Words. There is furthermore no problem when resaving a file that hasn't been created with LO 3.4.Createdtest file created by 3.3 and resaved by 3.4, valid for MSO 2010Createdsame document than attachement 47768, but created from scratch with 3.4It is quite confusing for users. We should do our best to fix it in 3.4.1 => increasing the severity.I do not have MSO 2010 to test...Is Cédric Bosdonnat saying that he cannot reproduce this bug?(In reply to)Surely not. I'm just saying I still haven't found what causes it.CreatedMy testing document generated by 3.4 (bad one) for reference.So I got to something; I'll attach few files here.CreatedBinary dump of test-3.4.doc (got using xxd test-3.4.doc > bad.txt).CreatedThis makes a working document from the non-working dump of test-3.4.doc.Just apply this patch over the bad.txt, and do xxd -r bad.txt > good.doc, and see that good.doc now opens without warning.So the difference that makes it non-working is newly introduced "ccb4 cc0c" in the WordDocument stream; no idea yet what does it mean, but hopefully we are close ;-)It is SPRM SDxtCharSpace that has wrong value. Patch sent to the mailing list for approval & closing the bug :-)
id=37622	Createdtestfile with 1 bold cell.When saving a file as xls, with some cells set as bold, and reopening the file in libreoffice 3.4RC1, the data is shown, but the cell isn't bold anymore.When opening the file in excel (viewer), everything is fine. Confirmed for me. Regression from 3.3.2Strange behavior...- XLS saved with Calc and opened with Calc -> All text attributes lost- XLS saved with Calc and opened with Excel -> Attributes OK- XLS saved with Excel and opened with Calc -> Attributes OKI had it when saving in excel 2003, and opening in calc, and also when saving in calc and opening in calc. (in fact, all xls-files I opened in calc are wrongformatted)I'll take thisIt seems to be more complicated. I have created another test document and only two cells lost formating (red number color).CreatedOriginal ODS test document where two cells A6 and A7 lose fomating when saved in XLSCreatedGenerated XLS where the cells A6 and A7 lost formating when opened in Lo-3.4.0-rc2Interesting, I have slightly modified the test document and the last column loses formating.CreatedOriginal ODS test document where the last comun C loses fomating when saved in XLSCreatedGenerated XLS where the last column C lost formating when opened in Lo-3.4.0-rc2Same problem here with version 3.4If I change some cells in an xls file to bold and then reopen the file, formatting is gone.If I save the file in ods format and then reopen it, then the formatting is shown correctly.This doesn't happen in all xls files. Some save the formatting without any problem and others don't.Just to add that formatting appears fine in 3.3.2I don't know if there is a separate bug for this one, but there also a problem in Calc with column width. If I open the file in 3.4 formatting is gone.(In reply to)Nodens, does it happen when you export XLS from LO-3.4? Does it work in L0-3.3. If not, please open a new bug for this. We should keep this bug only for formating lose with LO-3.4 XLS export that did not happen with LO-3.3. We should not pollute it with other import/export bugs. In each case, please attach a test document showing the problem. You should attach it only where it belong, either here or to the new bug.Well this happened in every xls I opened after upgrading to 3.4Anyway, I downgraded to 3.3.2 because of these problems mentioned here.It causes data loss. We should do our best to fix it for 3.4.1 => increasing severity and priority.Ok. I found the cause. It was my fault. :-PI accidentally changed the font lookup behavior while replacing ScfDefList with boost::ptr_vector.I'll take over this since it's my oops.Fix committed in master.I'll send a request for review to the list for inclusion into 3.4.1.Reviewed, cherry-picked & pushedEnjoy 3.4.1just tried it in 3.4.1. The problem still remains, and isn't solved yet.CreatedExcel file with some bold cellsAttachment where behaviour still is present.Are you absolutely positive that there are *any* bold cells at all in the attachment? 'cause I don't see them, even after opening the doc in Excel ...(In reply to)Yes for me. Cells C2:D3N2:N3 and U2 tooWith "signprev27251243622.xls" (reporters sample 2011-07-01) and "LibreOffice 3.4.1RC1 - WIN7 Home Premium (64bit) German UI [OOO340m1 (Build:103)]" everything seems to be OK for me:0. downloaded latest sample1. open "signprev27251243622.xls" with LibO: Bold C2:D3, N2:N3, U2 Same result with EXCEL Viewer2. Save as "signprev27251243622_saved.xls" in EXCEL95 format (seems to be original document format?), close, reopen Bold C2:D3, N2:N3, U2 Same result with EXCEL Viewer3. Close allNew Test 11. open "signprev27251243622.xls" with LibO: Bold C2:D3, N2:N3, U2 Same result with EXCEL Viewer12. Save as "signprev27251243622_saved97.xls" in EXCEL97 format (seems to be original document format?), close, reopen Bold C2:D3, N2:N3, U2 Same result with EXCEL ViewerSo currently I can't see a problem@Dries Feys, all:Can you please contribute complete, useful information instead of information fragments? Thanks!@Dries Feys:Please attach your result with lost formatting!@Rainer Bielefeld : I don't know what you mean with "Please attach your result with lost formatting!" The attached file has lost formatting with me and some other persons.I admit I wasn't clear which cells supposed to be bold and which not. The given example is the result of an automated batch task which creates the excel-file.I opened & saved the file before uploading it to remove some sensitive data, also with office 2003.So, with "signprev27251243622.xls" (reporters sample 2011-07-01) and "LibreOffice3.4.1 final - WINXP Professional English UI"0. downloaded latest sample1. open "signprev27251243622.xls" with LibO 3.4.1 final: Nothing bold ==> I haven't restarted the pc yet. EXCEL Viewer : dunno Excel 2003 : bold as expected.File was generated with excel 2003, but is apparently saved in excel 97 format.(I'm at home for the moment, so I won't be able to do more tests now - I use 3.3.2 under ubuntu at home and don't have time to install the latest version)What I'll do next monday or tuesday:- after the restart of my computer, verify the current behaviour (if that's ok, the installer should give a message to restart the pc after installing LO)- change my batch task and save the file in a more recent excelformat.But I surely can say I saved the file in excell2003, in excel97format, and that it opens correct in excel, but not in LO 3.4.1 final, which was released earlier today.Am I clear enough now, dear Rainer?Hi Dries,Is this a Windows only issue?I cannot reproduce it on Ubuntu with 3.4.1.(And indeed, the older 3.4.0 does show the problem too on Ubuntu.)I opened all attached test.xls documents, always using applicatino file dialog, with mentioned LibO version, "LibreOffice 3.4.1RC1 - WIN7 Home Premium (64bit) German UI [OOO340m1 (Build:101)]", EXCEL 2010 (Starter version), MS EXCEL VIEWER (12.0.6334.5000). None of my tests showed a formatting loss, EXCEL 2010 also showed the .ods files with correct formatting.This one really is a tough nut.The original report is concerning the problem that .xls documents opened in LibO seem to loose some formatting when they are saved as .xls again from LibO, at least formatting is no longer visible in LibO, but is visible in EXCEL 2003. Information concerning LibO localization, exact OS version missing.If the problem again is reproducible with an old test kit, we still have the old problem, if new test kits will be required to prove, it's a new bug (may be related to this one) that should have a new report.Unfortunately not at all, dear Dries, although some obscurity no longer exists several relevant information still is missing. May I ask you to read hints on <> carefully? Currently it's completely unclear what might cause the different observations, and so every little detail might be the key.I still have problems to understand all details of your problem, so please answer these questions (although some of the details might look irrelevant for you):0.1. You reopened the report because you do not see any bold in "signprev27251243622.xls"?0.2. Yourmeans: C2:D3, N2:N3, U2 SHOULD be bold, but they are not in LibO 3.4.1?0.3. so that Katarina'sconfirms your observations concerning LibO?1. You opened "signprev27251243622.xls": from LibO OS File dialog? LibO LibO File dialog Explorer? Else? From your HDD? Via network?2. 3. Your LibO localization is English (only for the sake of completness)?4. Your "signprev27251243622.xls" nothing bold in LibO means4.1. Cell C2 does not look bold?4.2. Bold icon is not active when cell cursor selects C2?4.3. Bold icon is inactive after double click on cell for every caret position?5. Do you still see a problem with 3.4.1 and old sample documents?5.1. If yes, with what ones?6. Does the problem persist if you rename your user profile before you start LibO (It's just a stab in the dark)?@Cor:Does not seem to be WIN only, My OS and afaik vitriol's are WIN.@KatarinaWhat Excel Version did your use? I already saw bugs only for Viewer or only for particular Excel version or even related to particular settings.I just tried to open and save signprev27251243622.xls with LIbO 3.4.1 final under Win, and I can see the bold formatting.Dries, are you sure that you use 3.4.1 final?Createdscreenshot to clarify the problemIn the uploaded file, mailaddress wasn't visible, but I can assure it IS the same file & behaviourThink you may close this one.The cause is the fact the zoom factor is on 75%, and LibO doesn't show bold anymore when zooming out.Sorry for the inconvenience...Ok, it's clear with bold. But there is something wrong with borders. It seems that 3.4.1 resets cell borders settings.CreatedLO 3.4.1 forgets border settingsCreatedThe same file, using OO 3.2.1@ alexandr: your extra comments for sure is about a diffent issue. Please look for the already existing issue(s) for borders. (e.g. 37133, 38595, ..)And if necessary, please do add your information there.Thanks! CorRESOLVED, FIXED or CLOSED bugs cant be KEYWORD NEEDINFO.
id=37488	CreatedPls. see original reportWith attached sample document and "LibreOffice 3.4.0RC1 – WIN7 Home Premium (64bit) German UI [OOO340m1 (Build:11)]" print results are completely unusable.I print pages 5-7 from "test101.odt" and seeWith HP OJ6110 (default WIN7 drivers):Table: borders missingEnvelope object: crippledRadio buttons on last page under "Vertrags-Details": Printed at the end of the document and much too bigFooter LibO label: missingWith Okipage 14ex (default WIN7 drivers):Table: borders missingEnvelope object: crippledRadio buttons on last page under "Vertrags-Details": missingFooter LibO label: missingPDF export is okOOo3.1.1 prints the same document correctlyThat was ok with LibO 3.3 CreatedPrint resultsYou can see my print results in Postscript files created with "Dell open print driver" (I think it's in the WIN drivers repository ore somewhere available for free):myprint5.ps:Both envelope pictures vrom OLE object messed up (envelope too small, "@" not visible correctly)Borders in table are missingLibO symbol in footer is missingmyprint6.ps:Borders in table are missingLibO symbol in footer is missingNo idea what the blue bar has been in the original documentmyprint7.ps:Radio Buttons behind "Mehrwertsteuer" missingLibO symbol in footer is missingThe results also are visible printing a PDF with FreePDF (what IMHO uses an Apple PS printer.CreatedRepaces defective original sample documentIn sample document Envelope OLE DRAWing object was missingCreatedOutput on Linux with LO-3.4.0-rc1It looks much better on Linux with LO-3.4.0-rc1. It is with our network printer. I can't see the driver name anywhere.Table borders seem to be missing during the print-out if the document contains any graphic (like company logo). However they are fulli exported to the PDF file under LO however they dissapear again if you export the file to PDF using virtual print drive (like PDF Creator).(In reply to)Forgot to add that the bug is present in the newly released LO 3.4 (not only in the RC version)!I think bug is confirmed by comments,.May be many users like me can't use LibO for the very basic job "printing a text document with Tables and DRAW objects", so I will nominate this one for "- LibreOffice 3.4 most annoying bugs"@Cédric:Please feel free to reassign if it's not your area!.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***I have the same problem. This version of Writer is not usable for now***has been marked as a duplicate of this bug. ***(In reply to)This is fine with me. Note however:The fact that LO 3.4.0 messes up printing and that in all former version I never got the spell checker working is a blocking issue for my multi-lingual environment.***has been marked as a duplicate of this bug. ***Could this issue be considered as a blocker for release 3.4.1 ?I've read about an 3.4.1rc3 for another blocker.IMHO (and also in my humble company ;) ) it's a blocker for 3.4 deployment. We have many documents with a logo and a tables with borders which will be unprintable.Thanks !(In reply to)A poor workaround is to export to PDF (what works fine) and to print the PDF. I doubt that can be fixed before 3.4.2We already have 3.4.1-rc3, so it is too late to add any other fix. The blocker was the. It was regression against 3.4.0, caused heavy data loss and affected almost all Linux users.I am afraid that this bug can't be considered as a blocker because there is the workaround, ... Anyway, I have increased the priority.Cedric, is there any chance to fix this for 3.4.2?So we'll wait for 3.4.2 !***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***This bug makes LibO 3.4.0/3.4.1 completely unusable.***has been marked as a duplicate of this bug. ***I agree with VITRIOL... printing documents is a basic feature that cannot be so messy... it's urgent to fix this in 3.4.2....I will stick to LibO 3.3.3 till this issue hasn't been fixed...the pdf workaround is not acceptable in a productive environmentDefining the PDF workaround as a solution is a lazy programmer's answer. Printing a doc is the basic of a Word Processor.In parallel, the Foundation will work on far much more 'geeky' features.This has nothing to do with quality.Such behaviours are the root of free software's reputation vs commercial products.@desaunay, tommy27: no doubt this one will be picked up asap.All involved people are aware this is needed for production environments.(In reply to)I hope so. But how do you explain this:"LibreOffice 3.4.1 fixes several bugs that affected the previous version, and can be safely deployed for production needs by most users."this comes from your release announcement...I think most users need a word processor that can print without any issue, so LibO 3.4.1 cannot be safely used by them.please, understand what is the point of my critics... I'm not ranting against you... I know that the LibO 3.4.x development is still work in progress and is still affected by many bugs... I use the 3.3.x series and I'm very happy with it, and I know that sooner or later Lib 3.4.x will be stable.the problem is about newcomers, people who download LibO for the first time...if their first experience with LibO is affected by such a serios bug like the present one, they will not probably give LibO a second chance...my suggestion is to be more prudent with your release bullettins...you cannot tell people that 3.4.1 is almost ready for production needs while it still have such important bugs...I tried - as far as provided - all attachments from the duplicate issues. Prints on Ubuntu, does not print on Windows@CorIt's worse: The borders (of tables and frames) appear mostly as pretty bold lines elsewhere in the printed document.hmm, appologies.I printed 4 of the usable attachments from the issues, and none showed the strange line. But just tried the fifth, and indeed, that one (Copia de Plantilla_Defensoria-OpenOffice.ott) does have the problem.This all on WinXP, BTWSo then might turn out that we have more than one issue at hand?The strange lines appear in the attached 'Print results' (i.e.: 'myprint5.ps', 'myprint6.ps') by Rainer Bielefeld (see), and--as far as I remember-- they appear also in all attachments of bugs, which I have marked as a duplicate of this.I believe it's a single issue... ;)The original report also was concerning crippled DRAWing printing in documents with table.Tor, a windows-only bug for youCédric's first guess that it would be the lcl_DrawDashedRect() method in sw/source/core/layout/paintfrm.cxx that needs debugging was wrong, I didn't see that method getting called at all when printing the "Copia de Plantilla..." test document from one of the duplicate bugs. (This is apparently the simplest document we have to reproduce the problem? Can somebody come up with an even simpler sample document that exhibits the bug, please?)(Sigh, debugging this will cause paper waste;)(In reply to)On windows, you can use a virtual pdf printer (like PDFCreator), the bug is still present with this kind of printer.I'll add a simple odt file with the bug :- print (even virtual pdf printer) : no border around the table- export to pdf : it's ok- delete the image : print or export, it's ok(Win 7 Pro 64 bits, LibO 3.4.1 french with english ui)I think if you solve the problem with this "not real life" document on virtual pdf printer ... you can successfully test with "real life" document and "paper waste" printer. ;-)(In reply to)- Open Writer- Insert a table- Insert a image into a cell via Insert > Image > From file...- PrintThat's all.You can use a PDF virtual printer for testing.CreatedSimple odt file with the bugCreatedLean test documentYes, Sir! :-)My new test kit contains:newsample3.odt: test document to reproduce all (?) problems except "Table lines appear somewhere in the document newsample3.pdf: print result with FreePDF print (same results with DELL free PostScript Printer)newsample3results.odg: Print results with marked errors I sawBTW, if you find out why the little OOo logo can't be deleted:"- Can not delete Picture"Not even necessary to install a 3rd-party virtual PDF printer; the "Microsoft XPS Document Writer" can be used to demonstrate, too, it seeems. (I don't know if that is always present, or came with MS Office?) Good.(In reply to)I think that it comes with .NET Framework.Simple sample with "strange line":- 'header_border_image.odt' (14 KB)- 'header_border_image.pdf' (9 KB)- 'header_border_image.eps' (7 KB)1. Text document, Page style 'Defaut' with 'Header on', 'Bottom Border only', Width 0,50 pt, Color 'Light blue'2. Insert > Image 'x.png'3. Saved as 'header_border_image.odt'4. Exported as 'header_border_image.pdf'5. Created 'header_border_image.eps' with PDFCreator6. Print...or7. Open 'header_border_image.eps' with GSview...CreatedSample files .odt, .pdf, .epsNo need for any more reproduction instructions or sample files, thanks.has instructions for a minimal test case, and is enough. And printing to XPS and using the XPS viewer allows me to reproduce just fine without actually printint to paper, I won't bother with any 3rd-party print-to-pdf or print-to-postscript tools.CreatedMinimal sample documentJust an 1x1 table and an image. If the image is the last selected item, the bug shows up, if some part of the table is, it doesn't. Or something like that.I have been debugging this for some days but not really come up with anything that would tell me what the problem actually is... I know that in the buggy case, GDIMetaFile::Play( OutputDevice* pOut, sal_uLong nPos ) in vcl/source/gdi is called with a metafile containing just 55 elements, in the non-bug case, 96 elements. But at what stage the table (and its borders, or the lines forming the borders, or whatever) get dropped, no idea."Minimal sample document" seems to show only the table problem, but not the (table related?!) Drawing print problem from my "Lean test document".That is intentional. One kind of bug per bug report.@Tor:It's your decision, I am pretty sure that both effects at least have the same root, the crippling only appears with table in document.(In reply to)In my test document (), the problem "non printing" table border always occurs. - If you select "nothing" (cursor in first position): problem- If you select the image : problem- if the cursor is in the table with nothing selected : problem- if you select the word "first" from the first cell : problem- if you select the whole first cell : problem - if you select the whole table : problemOnly case the border are printed : you select the whole table and , in the print dialog , you choose to print "Selection" (default choice) and not "All pages".Oh and perhaps a new bug ( I've still not searched bugzilla) :- Something (e.g. the table ) is selected.- You choose "Print"- In the print dialog, default choice for "Range and Copies" is printing "Selection"- You choose to print "All pages"- Then choose again to print "Selection"- Crash !Please, for the sanity of developer(s) trying to debug this problem, let them (us) concentrate on just the simplest minimal test document from now on here in this bug report, OK? And no speculation whether some problem with a completely different outcome (a crash) is related, thanks.FWIW, he is some debugging output showing what GDIMetafile "actions" are present in the non-buggy vs. buggy case when printing the sample document from.OK:WinSalPrinter::StartPage()GDIMetaFile::Play (2): nPos=-1 count=96 PUSH MAPMODESetMapMode(new) returning at 826 MAPMODESetMapMode(new) setting maMapMode=rNewMapMode at 864 origin=(-568,-568) scale=(1/1,1/1) at 889 LINECOLOR FILLCOLOR MAPMODESetMapMode(new) returning early, identical mode PUSH LINECOLOR PUSH LINECOLOR RECT POP PUSH LINECOLOR RECT POP PUSH LINECOLOR RECT POP PUSH LINECOLOR RECT POP POP PUSH PUSH ISECTREGIONCLIPREGION POP POP PUSH CLIPREGION TEXTLANGUAGE LINECOLOR COMMENT LINECOLOR FILLCOLOR POLYLINE COMMENT TEXTLANGUAGE LINECOLOR COMMENT LINECOLOR FILLCOLOR POLYLINE COMMENT TEXTLANGUAGE LINECOLOR COMMENT LINECOLOR FILLCOLOR POLYLINE COMMENT TEXTLANGUAGE LINECOLOR COMMENT LINECOLOR FILLCOLOR POLYLINE COMMENT POP LAYOUTMODE LAYOUTMODE FONT TEXTALIGN TEXTFILLCOLOR FONT TEXTALIGN TEXTFILLCOLOR FONT TEXTALIGN TEXTFILLCOLOR PUSH PUSH ISECTREGIONCLIPREGION LAYOUTMODE TEXTLANGUAGE PUSH MAPMODESetMapMode(new) returning early, identical mode PUSH CLIPREGION PUSH ISECTRECTCLIPREGION BMPSCALE POPSetMapMode(new) returning early, identical mode POP POPSetMapMode(new) returning early, identical mode FILLCOLOR LINECOLOR RECT POP POP PUSH ISECTREGIONCLIPREGION POP POPSetMapMode(new) setting maMapMode=rNewMapMode at 864 origin=(0,0) scale=(1/1,1/1) at 889SetMapMode(new) returning early, identical modeWinSalPrinter::EndPage()Not OK:WinSalPrinter::StartPage()GDIMetaFile::Play (2): nPos=-1 count=55 PUSH MAPMODESetMapMode(new) returning at 826 MAPMODESetMapMode(new) setting maMapMode=rNewMapMode at 864 origin=(-568,-568) scale=(1/1,1/1) at 889 LINECOLOR FILLCOLOR MAPMODESetMapMode(new) returning early, identical mode PUSH LINECOLOR PUSH LINECOLOR RECT POP PUSH LINECOLOR RECT POP PUSH LINECOLOR RECT POP PUSH LINECOLOR RECT POP POP PUSH PUSH ISECTREGIONCLIPREGION POP POP LAYOUTMODE PUSH PUSH ISECTREGIONCLIPREGION LAYOUTMODE TEXTLANGUAGE PUSH MAPMODESetMapMode(new) returning early, identical mode PUSH CLIPREGION PUSH ISECTRECTCLIPREGION BMPSCALE POPSetMapMode(new) returning early, identical mode POP POPSetMapMode(new) returning early, identical mode FILLCOLOR LINECOLOR RECT POP POP PUSH ISECTREGIONCLIPREGION POP POPSetMapMode(new) setting maMapMode=rNewMapMode at 864 origin=(0,0) scale=(1/1,1/1) at 889SetMapMode(new) returning early, identical modeWinSalPrinter::EndPage()@Nicolas R:Your Crash observation seems not to be related, I filed new "- PRINTING: Switching radio buttons "Selection <-> All" Crashes"Worked with former LibO versions.Sigh, I now realize that an unknown part of my reproduction successes has actually been bogus: If one has a part of a document "selected", and then File:Print, the idiotic default is that it prints just the selection. I had not noticed that it defaults to printing just the selection. (That is IMHO a horrible feature, but no doubt if we would "fix" it, people would scream how that is an insult to the users, makes LO totally unusable, and especially unsuitable for left-handed people working in the construction industry, or something.)At the moment I am not capable of reproducing the bug with either my own trivial test document (either the one attached, or a similar one constructed from scratch), or the "Copia de..." sample document. This is with a relatively fresh build of vclmi.dll and swmi.dll from the 3-4 branch, but otherwise stock LibreOffice 3.4.0rc2 (I think). I will now try to reproduce with the latest 3.4.2 beta or something...OK, with the 3.4.1 final installed in a VM I can indeed reproduce now again, both with the "Copia de Plantilla"... document (sigh, why can't we have sample documents with *short* and *simple* names?) and with a minimal test case constructed on the fly out of a 1x1 table with an image. (And this time I made sure that I did *not* print just the selection.)Will now then try to replace the vclmi.dll and/or swmi.dll DLLs with the ones freshly built for debugging and see if the bug goes away...CreatedAnother minimal test caseNow, with this test case, I definitely see the bug even if I make sure not to have anything selected. Both with 3.4.1 final as such, and with a freshly built vclmi.dll.And here is the same kind of debugging output from printing that t.odt, with the table (its borders) not visible in the output:WinSalPrinter::StartPage()GDIMetaFile::Play (2): nPos=-1 count=96 PUSH MAPMODESetMapMode(new) returning at 826 MAPMODESetMapMode(new) setting maMapMode=rNewMapMode at 864 origin=(-3265,-568) scale=(1/1,1/1) at 889 LINECOLOR FILLCOLOR MAPMODESetMapMode(new) returning early, identical mode PUSH LINECOLOR PUSH LINECOLOR RECT POP PUSH LINECOLOR RECT POP PUSH LINECOLOR RECT POP PUSH LINECOLOR RECT POP POP PUSH PUSH ISECTREGIONCLIPREGION POP POP PUSH CLIPREGION TEXTLANGUAGE LINECOLOR COMMENT LINECOLOR FILLCOLOR POLYLINE COMMENT TEXTLANGUAGE LINECOLOR COMMENT LINECOLOR FILLCOLOR POLYLINE COMMENT TEXTLANGUAGE LINECOLOR COMMENT LINECOLOR FILLCOLOR POLYLINE COMMENT TEXTLANGUAGE LINECOLOR COMMENT LINECOLOR FILLCOLOR POLYLINE COMMENT POP LAYOUTMODE FONT TEXTALIGN TEXTFILLCOLOR FONT TEXTALIGN TEXTFILLCOLOR FONT TEXTALIGN TEXTFILLCOLOR LAYOUTMODE PUSH PUSH ISECTREGIONCLIPREGION LAYOUTMODE TEXTLANGUAGE PUSH MAPMODESetMapMode(new) returning early, identical mode PUSH CLIPREGION PUSH ISECTRECTCLIPREGION BMPSCALE POPSetMapMode(new) returning early, identical mode POP POPSetMapMode(new) returning early, identical mode FILLCOLOR LINECOLOR RECT POP POP PUSH ISECTREGIONCLIPREGION POP POPSetMapMode(new) setting maMapMode=rNewMapMode at 864 origin=(0,0) scale=(1/1,1/1) at 889SetMapMode(new) returning early, identical modeWinSalPrinter::EndPage()@Torthanks for your efforts trying to fix this annoying bug.I keep my fingers crossed!!!However, with a freshly built swmi.dll I don't see the bug. Whether this is because I built it with (partial) debugging, or because of some code changes in it since 3.4.1, no idea...I guess it is possible that we are lucky, and some change in the code after 3.4.1 has (accidentally) fixed also this problem...@Tor:What ever that might help for your investigations: I just did a test with my more complex sample documens and compared result 3.4.1 and a Daily 3.4 Branch Dated 2011-07-08. I see much progress concerning the table printing, a blue table not printed at all with 3.4.1 now is printed correctly, and also the resting table lines seem to be complete. A print with HP OJ3110 looks perfect, also the Drawing object is no longer cropped.It might be that there still some PS print problems exist. FREEPDF shows some line thickness issues (grey instead of black), and the envelope still is cropped, but in a different way I saw that before. IMHO this is a different issue that had been hidden by the terrible other croppingResult via Dell PS Printer still looks horrible on screen, some better in print, but same as from OOo 3.1.1, so that is not our problem.My summary:Table print problem fixed / worksforme (IMHO we can change status)Remaining Drawing Cropping problem IMHO different issue, If you do not object, I will file a new report for that.@Tor & Reinergreat!!! teamwork pays!!!I can confirm Rainer's finding.Tested with LibO 3.4 Daily[libreoffice-3-4~2011-07-10_23.10.17_LibO_3.4.1rc1_Win_x86_install_en-US_de_fr.exeon WinXP]:1. 't.odt' (Another minimal test case -)Works well (with line width 0,50 pt; that's another problem)2. 'Copia de Plantilla_Defensoria-OpenOffice.ott' (,)Works well3. 'header_border_image.odt' ()Works well4. 'sample embedded calc wont print border cells.odt' (,)Works pretty well (only a left border is missing; probably another problem)No objections, so due to latest results I add target and close this one for now.I will leave comments for follow ups concerning remaining problems with different reasons.***has been marked as a duplicate of this bug. ***great seeing this resolved! Thanks a lot all.(I missed this earlier, because I'm on vacation and missed too that my subscription to libreoffice-dev list somehowe got broken).As state/solution I would rather advice just 'fixed'. Not only because it was broken (though the reason solution are not spit out), but also beacuse it is much clearer to people looking for the coming 3.4.2 release that this is fixed. Now 37488 does not show on...fixed ! Cheers !@Cor Nouws:I prefer the "WORKSFORME" because we can not know how t4h problem has been repaired. For good reasons the Bugzilla Help text for FIXED is "A fix for this bug is checked into the tree and tested." These fixes are very reliable. The pseudo-fixes are much less reliable, sometimes the problem reappears. For me it eases the work if my Bugzilla search separates such "real reviewed fixes" from "problem vanished somehow, nobody knows why".@rainer:well, OK, I can agree. I thought setting to 'Fixed' would help to get this kind of automagically resolved issues in the generated list of fixes. But since it does not (as explained to me on the list), I have no reason to stick to my proposal.@Cor:For me information how those lists are created also was nes.See also.***has been marked as a duplicate of this bug. ***I see that this bug was moslty on Windows, but I have a problem with messed-up printing on Ubuntu 11.10 32-bit with LibreOffice 3.4.2. It is a simple text-only document, created in LibreOffice. I don't know if you need sample file for this or not, but the result is far from usable - almost one in 10 words is wrongly printed. If I export document to PDF, and print it, everything looks OK. I also tried the latest 3.4.4 from LibreOffice PPA, but that one prints the same as 3.4.2. Interestingly, if I open the same document in OpenOfice 3.3, and print from it, it looks fine. If you need sample, please tell, I'll send it here.Hmm, I tought that I was filling the bug for"[] PRINTING result completely messed up"but, after sending, I see different title of the bug. If this isn't the right place, should I make a new one?@Zarko ZivanovSummery concerning your: this bug can be closed again?I will file a new bug for my issue, with the same text. Sorry for the inconvinience.@Zarko ZivanovA simple "Yes" would have been enouth ;-)
id=38222	CreatedFiles and Screenshots demonstration reproduction of the bugI know this bug has been mentioned on LibreOffice lists, but I could not find it on bugs.freedesktop.org. This may be a duplicate:When change-tracking applies to simple deletions that where changes are recorded and shown, the deletion will show as a correct strike-out of text and then suddenly change to a strike-out of the same number of spaces. It is not possible to recover the original text by rejecting the change.The attached Zip has a .txt file that describes its comments.The screen captures show a simple deletion immediately after it is made, and then what it became when the Save button was pressed. The saved file also had the incorrect deletion in the tracked-changes information.The before and after files are included, and there is an annotated extract of the change-tracking portion of the content.xml file in the package.This bug seems related to the one reported at <>. In that bug, the deletion is also altered after the fact, but not quite so quickly and not so dramatically. *** This bug has been marked as a duplicate of***
id=38374	Createdwriter_bug.docSteps to reproduce: 1. open the attached document (writer_bug.doc)2. scroll to page #43. There begins a section "5" with several tables in it. The first table already contains some pre-filled data4. Copy/paste this pre-filled table just after itself5. [optinal] modify contents of the pre-filled text in the pasted table (in the grey area)6. Save the file7. Close Libreoffice8. Open the saved file9. Be badly surprised about the contents of the pasted table not being there I have reproduced this with LO-3.4.1-rc1.It might be a problem with .doc export. The problem does not happen when I export it into .odt.Cedric, Lubos could you please have a look?It is a data loss => we should fix it for 3.4.2. It would be great to have the fix also in 3.3.4.Linux 64bit:First time I can't change the text because it's a restrictet area (Error message).Ohter parts of the text I can change.After save, restart and load:All changes are in the documentI can change the text in the restrictet area (ops).Jikosi, jeden pro Tebe ;-)When you copy/paste a fieldmark, the essential attributes are not preserved; later, when saving, the fieldmark is of unknown type, and ignored. We should save even the unknown fieldmarks I think, but here I fixed the root cause - that the attributes are not copied.Sent to ML for review, to get to 3.4.2.
id=38633	no problems saving and editing a complex document, prepared with version 3.3.3.crash at terminating writer.crash when closing the document (after writing it).if you need complex big documents for analyzing, please send a message. They are too big for sending via email.tested on 2 machines (win 7 64), one native installation of libre-office.same crashes with 3.4.1 rc1 (rc1 2011-06-18-15-53-53) on the same documents. same behavior with 3.4.1 rc3 writer crashes after closing a complex document or when closing writer after successful writing.win 7 64Crash on exit does not affect the primary function. Also it happens only with limited number of documents => it can't block the release => reducing the severity a bit.I wonder if it a duplicate of the.There isn't any data here to make any judgement on unfortunately.No possibility for invistigations, but Petr's suspect sounds plausible. so DUP of "- Win2K: always crash on exit" for now@gerdl:Without a sample document or a precise instruction how such document can be created we can't do anything.Please feel free to reopen this Bug if you find evidence that we have an independent issue here and if you can contribute a test kit.*** This bug has been marked as a duplicate of***
id=37361	This is the Meta issue to track most annoying bugs for the release of LibreOffice3.5.x releases. It helps developers to concentrate on bugs that are importantfor users. Also it helps users to be aware of potential problems.If anyone wants to raise an Bug for the release, please add the Bug ID asdependent Bug here to the Meta Bug in field "Depends on". Additionally pleaseleave a comment here why you think that the bug should be privileged.See alsoand My be one of next bugs:- TABLES text in cells behaves wrong when rotated (annoys when opening documents in doc format, there rotated text has no restrictions)- Appearing docked Toolbars cause document jumping on screen (distorts attention, slows down work)- Complex Dialogs should be resizable (dialogs takes only small part on contemporary displays, and if dialog contains much information, it seriously slows down work; besides on some locales text not fits in UI of dialogs)- in Writer in table cursor jump to last cell if press Ctrl-A (user lost cell where last time works, problem if table is big)- Writer table: can not select rows by mouse (user can not select many rows in table)- merged cells in tables in DOC files not saved correctly by Writer on Linux 64bit (user can not save to doc format correctly)- Opening .doc file displays numbering with wrong size VIEWING (some files open incorrectly)None of these bug is serious, but they are annoyingNominate- Mouse pointer disappears instead of changing to "move arrows". There are lots of additional conditions causing disappearing mouse pointer, Master is difficult to useNominate- Recent Documents list does not workAdd. LO window is on background when starting on MAC.I nominate. Import and Export Excel files in format xlsx crashes immediately. Working with spreadsheets in new Excel format is impossible.Nominate "- PDF: Most of contents missing, wrong PDF syntax": Very basic function completely broken, WRITER would be unusable for very many users.nominate- XTableRows.removeByIndex and also symply remove Row / Column crashes Libo(In reply to)It is a core function => acceptedNominate "- SPELLCHECK does not recognize text language", WRITER without any spell check - unimaginable!Nominate "- Spell check does not work after copy / paste, modified language not recognized". WRITER without any spell check - unimaginable!I nominateit really old but never the less very annoying.For complex Documents and Thesis it is important that the master document feature works again.Nominate "- FILEOPEN CRASH with trivial lorem ipsum text document"Nominate- required visual studio 2008 redistributable libraries not installed, failed to start. For details please see <>I would like to nominate. Crash when moving cells<>.It happens a lot using KDE interface rendering working with calc quite interesting.(In reply to)acceptedNominate "- CRASH when PRINTING from Page Preview"I nominate the. The import/export of shapes is somehow broken.Nominate "- FILEOPEN: rotated objects all in top left slide corner", what makes DRAW unusableNominate(multimedia keys)- this (i hope only a) simple bug which is not solved for years (since OOo 3.0.1).Nominate- Impress may shows the wrong image if a RTF file is opened before the ODP document.Nominate "- EDITING: Crash when insert Table Control". Potential for 3.4 M.A.B. but within rather long time nobody reclaimmed, so 3.5 might be more appropriate.I would like to focus on an improvement, not a bug. The possibility to print notes besides text, like in MS Office would be really a big step forward. This feature is missing since the early OOo release. Due this lack I still need MS Office for printing documents with notes, because it is not possible to work with notes printed on the next/last page.Orwel - it is quite a well known issue that people are trying to find funding to fix; whether it is a 'most annoying' bug, as a non-blocker, non-regression I don't know. Then again we have no tracker for "most important features". Either way, you'd want to file a bug for this I think. Also the feature freeze is in ~2 weeks, so you're a bit late for 3.5 :-)I want to add 42826 : unopkg.bin runtime error during installation.If we want to make test, we need a version installed without error.Nominate 43105 because its:- a regression- a very relevant file import (*.doc)File import issues are hard to tracks as is, and regressions are harder to solve the longer they are in the product.Nominate: Incorrect cross-references to illustrations and equations in master documents.It is a quite old bug with many duplicates and votes.Nominate: regression from LibO 3.4, false results in Calc.Nominating: cannot change macro security settings: UI does not openNominate- Terminal (command) window is opened when launching any executable. Such a very visible problem is not acceptable for a release.Nominate "- Wrong application icon on the MSVC Master". Such a very visible problem is not acceptable for a release.Nominate "43384 - FILESAVE: causes lots of messages or even impossible". Blocker if reproducible!Nominate "- CRASH wen close document"Blocker if reproducible!Nominate: scripting code in the wild (and example code in SDK) uses --nodefault command-line argument to mean "splash screen shown, but no window opened after that". LibO 3.4 uses it to mean "show welcome screen on startup instead of opening a blank Writer document", which breaks user code.We need to clean that up.Nominate "- Break-off with message "Terminate Quick Starter""; 3.5.0 Beta0 Installation fails for me.Nominate '- Spell check: Crash "Runtime Error" with AutoSpellcheck';not acceptable for a release.Nominate– findAll doesn't workThis bug would break extensions and macroses that use findAll method in CalcMay I propose to add: "Writer ignores text after Equation in docx" -- or even crashes (see comments about the bug)? I know this is an old bug report from LibreOffice 3.4, but IMHO fixing it for 3.5 is even more important now because our "scratch-pad of notes to build release notes from" atsays:"Support for export and import of math formulas in Office Open XML (docx) documents (Luboš Luňák)."So, if we declare that there is now official support for import/export of math formulas in docx documents, it is strange that opening such a docx document containing some math formulas does not work at all or even crashes LibreOffice ...Just ignore my proposal if I got something wrong, but at least to me fixing this bug seems especially important. It should be not that difficult, BTW, because on MacOS the same docx files containing math formulas already open without major difficulties, so this seems Windows-only problem ... Compare also, which is IMHO a duplicate ofbut especially describes the crashes.Nominate: Hidden state in report design, leads to behaviour that is incomprehensible from what is shown in the UI.Nominate "- Crash when closing document and several Spreadsheet documents open", makes CALC unusable!Nominating "- CONFIGURATION: Using existing User Profile existing WRITER documents open "semi read only"". Currently indications are rather confusing and it's not a crash or similar, but there is a potential to make WRITER unusable after an update.Nominating: navigator corruption. The problem is mostly with Impress and make the navigator unusable.Nominate #42656 : Problems during exchange of image from ODP and RTF. Copy an image from an opendocument to an rtf does'nt workNominating- Can't move slides in slide sorter.Tried with LibO 3.5 beta 0.Seems to not affect everyone, though. (Only certain Linux distros? It would be nice to get more people to test it.)Nominate "- VIEWING: Rotated flipped shapes in 3.4 drawings loose rotation opened in 3.5".Nominate "- EDITING in existing cell content not possible, cursor jumps to line end"Nominate "- FILEOPEN PDF brings up (ASCII) filter selector instead of opening document"Nominate "- Advanced FILTER incompatible with 3.4.4 documents" - we should not break compatibilityNominate "- Page FORMATTING: Margin settings information not compatible with 3.4.4", breaking version interoperability is a potential blocker.Nominate- Impress crashes on custom animation of presentation objectsPlease try it out, it is not confirmed yet.Propose- MAILMERGE: Mail Merge with image in header of document, causes crashpropose- LibreOffice does not start with a second monitor connectedpropose- Crash when starting to enter cell contents with a single quote for the second timepropose- Renaming and deleting of inserted template categories broken, inserted templates land in wrong category (indexing issue in code)proposing- EDITING: cell text *contents* from Calc pasted to Writer is pasted at bottom of document, unless paste special is usedpropose- Paste special from Calc to Writer, causes last paragraph to be removedPropose bug, base is unusable until this is resolved. While it seems to be a Java bug, we already appear to have had at least one misdiagnosis.Adding(as reported by Regina Henschel in) to the list because the bug has been confirmed now and is a blocker.Propose to add this:Two of our bundled extensions don't work on Windows.(In reply to)Yup, we should fix this.I propose the following bugs in order of my priorities:- CONFIGURATION: Formatting aids - displayed nonprinting characters become unchecked during printing and PDF exportReason: Because it is a regression and really annoying to recover the characters.- PRINTING: Option Buttons and Check Boxes not printed correctlyReason: Because it is a regression and we have many documents with check boxes making it impossible to use LO at the moment.- FORMCONTROLS: Check Boxes and Option Buttons Become Invisible, when you Click into a Table.Reason: Because it is a regression and image of LO is suffering ("Why do we use LO if that software is not able to display a simple document).- TABLES text in cells behaves wrong when rotatedReason: Because MS Word compatibility is important for us. Rotated text with more that one line can not be read after import and even the creation of the second line next to (and not under) the rotated text in LO is less than obvious. The behaviour (Ctrl+Enter) is not expected by the users I know.Proposed."New Math symbols poorly redered in Windows"The bug has the fix already, we just need to cherry-pick the files.Proposing, as UI in Hebrew is broken due to selection of a font without Hebrew support. Since beta2, this font is also part of LibO, which makes the problem to happen on default installation unless the font is manually deleted from the system.Nominate "- PRINTING: after leaving Print Page Preview with <esc> particular documents will CRASH", it seems many documents are affectedadd- Text rendered poorlyWriter (beta2) crashes after leaving to another program on Win7 64bitI nominate the. Crash when page preview after <f4> (data sources).hello,I re-openend.For an average user this bug is very confusing and dissapointing. Shouldbe corrected before releasing a new version. I also did see it in the main-build, 3.6.I discovered it myself working on a 230 pages document, my logbook, whichI carry along for 6 years (!). So now this bug suddenly appeared. I am even disappointed my self.From the discription: it showed up suddenly and disappeared suddenly,now it is there again. For me it was consistent during 3 days of editing workon a document, then was gone again in one editing session.Some not of half-way initialised parameter ?Please consider adding this bug to this generic bug report.Luc(In reply to)I agree that it is quite annoying => adding here. Well, I am not if we will be able to fix it. Random bugs are always hard to cope with.(In reply to)Yup, that sounds pretty nasty.Nominate "- FORMATTING: User style not trans ferred with copy / paste to other document", this bug makes effective work with DRAW impossible (enchains me to OOo 3.1.1)Nominate 44093: Forms open in printer view. They should open in web-viewNominate: Writer input fields are not populated using the Java UNO APIAs per discussion with Michael Meeks, nominating- mysql connector 1.0.1 extension from Oracle no longer works with 3.5 and throws a UNO shared object/component error.AlexNominate- Deleting sheets can shift images or graphics between next sheetsNominate 44147: unable to edit embeded Calc table in WriterPlease, verify- in Arabian text blank squares instead of lettersit my be regression if confirmedNominate 44322: ODF compatibility; margins saved by Lo-3.5 are not read corrrectly by L0-3.4Nominate 44498: Even simple odt document is considered as invalid by MS Office 2010.Nominate "- After installation first launch terminates after splash screen". Although it seems completely harmless, that's no good first impression of a fresh installed software. We should be sure that that will not happen with RC1.Nominate "- EDITING: CRASH for any input in Full Screen Mode"(In reply to)I agree that it is annoying => added. On the other hand, you saw it also with 3.4.5 => it is older bug => it is not must to have for rc1.I am a bit unsure about these, but I'd like to nominate:- LibreOffice crashes in Bibliography dialog when pressing Enter– Because it's a crash and has been in LibO at least since 3.4- Modeless Word Count window hides when user clicks into a note– Because it's a new feature that doesn't always work as advertisedAdding "- CRASH in OLE object EDITING"Please, verify- Calc PRINTING: printer prints Landscape page orientation as Portraitit my be regression if confirmedAdding- There's no scroller in Calc's scrollbar with RTL UI.(In reply to)Please see prioras it may be the same or a closely related bug. In, freedesktop isolates the problem he is seeing to the Printer Language Type being set to PDF. Note that this may be affecting primarily Brother brand printers(???). Also note that this may be an issue for 3.4 as well as 3.5.(In reply to)I crashes even when adding TOC, so let's add itI think that this one is rather funny than annoying. I think that we do not need to prioritize it that much.Add- Formula returns #VALUE in 3.4RC2 but works as expected in 3.3Although the change is intended, it breaks compatibility to earlier versionsand to Excel import.There's a common pattern =IF(A1+B1=0;"";A1+B1) which is used to hide zeros,that leads to an error if another formula references this cell when 0/"".Additionally it is already tagged as EasyHack.Nominate: Cannot resize a control with the mouse in Report Builder.I am still confused about the usage of "nominate" here.says it has two meanings: 1) To name someone as a candidate for a particular role or position, including that of an office. and 2) (obsolete) To entitle, confer a name upon. So, when people "nominate" a bug for the coveted Most Annoying membership, does that mean they 1) suggest it as a candidate for being Most Annoying, i.e. invite discussion whether it is or not? Or that they 2) directly entitle it, say that it *is* a Most Annoying bug?@Tor:Because of that confusion I changed my wording to "Adding bug ...". I do not believe we should do long discussions here concerning each bug, IMHO the proceeding should be: - Always add the Bug Number to "Depends on"- Always cite the Bug Subject in a comment with a one sentence reason why it is a "Most Annoying" one, so that we keep overview here.Without objection the Bug remains listed here, or someone objects and deletes it from "Depends on", further discussion in the Bug report itself.A "nominate first, discuss, add" would be too bureaucraticI understand it the way that all bugs are kind of nominated because they could be added and removed from the dependencies at any time if there are good reasons.I think that the main confusion is whether to update bug dependencies together with the explanation comment or wait for someone to accept it.My suggestion is to update dependencies immediately if you are pretty sure that it is annoying for many users. You could just leave a comment if you are not sure.It is how it works now and I think that it works well.I agree with Rainer that we do not want long discussions about every bug. Most people nominate reasonable bugs. This is why the initial comment suggest to add the dependency immediately.By other words, both approaches are good. You can't do a mistake :-)Version LOdev 3.5 beta3S.O. Ubuntu 10.04 and Debian Testing.Leaflet 'writer' with inserted OLE object (Calc).Opens the object Calc to modify the cells.No change is possible because the sheet Calc is protected.Even if 'format cells' eliminates the tick on 'protection' remains the fact that it is impossible to modify any cell. In my similar models very old (made with OOo 2.x in years 2003, 2004 or 2005) the elimination of protection works very well and the cells are modified and saved correctly.(In reply to)Felice this must be reported only (!) onand, in case, changed there the target platforms: not here in 3.5 bugs collection.Ok?CarloHi KoheiWhy did you remove that bug from the list?Shouldn't I have it added to 3.4 and 3.5, or what's the reason?RegardsPhilippAm 12.01.2012 20:13, schrieb:>>>Another interesting bug:- Writer FILESAVE: document, saved by LibO 3.5.0 opens incorrectly in LibO 3.3.4 and 3.4.3Add: too bad user experience with StartCenter.(In reply to)@sasha:You nominated, butis marked as a duplicate of, which is (or should be) fixed now. Isnot fixed for you? If this is the case, it is probably not a duplicate of, and thenshould be opened again. Or why did you nominate it? Am I missing something? (Just wanting to help, no offense!)@RomanI closed(as dup) after it was mentioned here. The fix will be at beta3 while it was reported on beta2.Possible regression from 3.3.4 if confirmed:- Impress EDITING: Undo not works when change master pageSuggest- leaking page-breaks in the rendering, makes the new feature look bad.possible regression, if confirmed:- Calc: font on screen looks corruptedpossible regression, if confirmed:- Writer EDITING: LibO crashes when attempt to copy-paste from Calc and undo resultspossible regression, if confirmed:- Calc EDITING: when recovered after crash, impossible to enter into cellsusers from opennet.ru very complain on this bug:- FILESAVE During DOC export drawing is lostanother regression since 3.3.4 version:- Writer FILESAVE: Text direction in table is not saved into DOC formatRegression from LibO 3.3.4:Rationale:Duden Korrektor is a commercial extension (ca. 20 Euro) providing variouslanguage tools for the German language that in many tests out-performed allother similar contestants. The extension is available for LibreOffice,OpenOffice and Microsoft Office and is important for German professionalwriters as well as many 'regular' German writers.Not being able to install the extension in LibO 3.4.0 to 3.4.4 makes for a/very/ bad user experience. Guess what users relying on that extension willstay with or switch to?As far as I can see from the discussion in #37561, a fix (adding missingsymbols) should be relatively simple.Thanks,Stephan HennigNote, I've also added this bug to 'LibreOffice 3.4 most annoying bugs', but only after LibO 3.4.5 was released. According to the release plan LibO 3.5.0 will be the next release.another regression since 3.3.4 version:- Writer FILEOPEN: document in format DOC with picture opens incorrectlySuggest add major PPTX performance regression:that may affect other font related performance issues.MSI installer does not show localized UI for many languages, for example pt-BR.Possible regression: In Writer options disappears one option, important for Asian languages. See explanations in last comments of this bug:I addedwhich should be, if it that's not clear, OpenOffice bug 13791. Writer FILEOPEN: document in format DOC with table opens incorrectly.AddingORowSetCache provides the XResultSet interface. Its isLast() returned true on the last line of the prefetch window, instead of the last line of the data. This has the potential to break a lot of other stuff, and in particular breaks search: the search does not look beyond the prefetch window.Can I nominateNot letting the Smartboard ink layer get above an Impress presentation on a second screen makes Impress pretty useless in most schools.XP works fine but Linux doesn't ( As in: Slideshow/Slideshow Settings/Presentation Always On Top doesn't seem to do anything at all )(In reply to)Updated this bug for RC1... Please read it's very interestingMNominate 44143 - formula's that use data from pivot table don't update with the pivot tablenominate- brackets inverted in rtl text (mac only).(In reply to)sorry for double post but i wanted to add an argument : it is very annoying to see inverted brackets in file you open or create, it makes it very hard to know how the file will look in other programs , and the bug persists while printing .it is probably not hard to fix it is related to fonts (neooffice fixed it a long time ago)!Nominating- Update installation from 3.4 fails on most windows systems@Volker:It's as Lionel wrote in the bug, we can't do a Fix for the 3.4.4 and older versions. But we urgently will need a hint in the installations manual that Versions before 3.4.5 will have to be uninstalled on 64 Bit WINI think that,andare the same one.I just test them with:- LibreOffice 3.4.5 rc2 (= final), linux x86-64 rpm build, on OpenSuSE 12.1,kernel 3.1.0, updated, Gnome, ita GUIed;- LibreOffice 3.5.0 beta3 and rc1, win32 build, on my Windows Vista64 bit, SP2, updated, ita GUIed;and I obtained always the same result: the bug is still here.Now I try with 3.5.0 RC1, I posti here test results and then I add them to MostAnnoying 3.4 and 3.5 ones.I think they may hide a bad table width initialization and tick and colormanagement. This affect quality and people LibreOffice quality ideas.Tables and default table width are too often used to yield many document andtheir exported PDFs so that people may easily decide because the border bugthat LibreOffice is still too young to be adopted and so they may decide tounistall it putting all our efforts trough the window!It's a big pity! So that I add them to most annoying one.Carloadding regression- FILEOPEN: Cannot open HTML Files in Calc(In reply to)It sounds pretty annoying => added to the list.(In reply to)Added to the list. The reason is quite located. Probably has more duplicates.(In reply to)Let's leave it outside the list for now. I am not sure how many users are affected. The bug has already got some attention. It works on Windows now...(In reply to)Added to the list 40539. The document is still readable but it looks much worse. The other text direction is pretty useful feature when you do more complex tables.(In reply to)The objects are somehow special. Normal drawing objects are exported correctly. I have added some experts into CC. I am not sure how many users are affected, so let's leave it out of the most annoying bugs for now.Want to add.Pivot table with dates is inusable.Dates are changed in string, so you cannot use Data > Group.(In reply to)Great catch. Well, let's leave it outside of most annoying bugs for now. It happens only when the document in not saved or autosaved.(In reply to)Added to the list. Looks well reproducible. Might help to solve more cut&paste related crashes.(In reply to)I am sorry, this was meant for the cut&paste crasher.(In reply to)It has been fixed in the meantime.(In reply to)Nice catch. I see it also with 3.4.5. I am not sure how many users are affected. I would leave it as a normal bug.is not a regression even though it may seem like one to some users. I gave my reason in that bug report. Please consider removing it from the list.(In reply to)the bug report currenly shows no consensus about it being not a regression ..(In reply to)If we need to ensure the same order in an unordered map container, then all bets are off. I'll leave it at that. No more input from me.(In reply to)pls consider to read the comment in the issue en reply there. It's the way to open the file, that you suggest to use, that is not working any more.thanks.In one bug hard to distinguish regression from new functionality:- "Save As" defaults to current document formatAdded: images (graphics, pictures) get lost on editing. Gets more duplicates ..#40907 : Networking for Mac users is strongly affected by this bug. When a user attempts to open a file already open on AFP shared folder, it is not advised of which use this file, but receive an I/O errorAdd "- SLIDESHOW: Transparency gradient effect fade in with wrong VIEWING", that might make Presentation useless fol many users.(In reply to)It was already in LO-3.4. The current state seems reasonable. Just the description is slightly confusing. People do not complain about LO-3.4 => normal bug.Heh, I have modified the platform setting by mistake.Nominate.Nominate. This is a seemingly minor regression, but it breaks our extension quite badly :(possible regression since 3.3.4: when import from doc, comments disappears- Writer, comment (see last comment)Instead of:- Writer FILEOPEN: when open doc file, comments disappearAdding- Report Designer Wizard missing Label display and editing capability - regressionAdd: cannot edit data using postgreSQL-SDBCAdd: The Document Converter wizard is crashing on Windows OSs with default installation. It depends on binfilters.Added 37024 as we have now had this bug for the whole of the 3.4 series and it is still not fixed. It is a blocker for all Base users, and a regression over previously established OOo 3.x versions and apparently LibO 3.3.x versions of ODB files.AlexAdd "- EDITING: Calculated cell contents not updated after copy - paste - delete of source values", what makes calculations unreliable.Adding: Crash on 64 bits when using an ODBC datasource (some drivers).Regression since 3.3.4- Table borders in word 200x .doc are shown incorrect in writerregression since 3.3.4:- FORMATTING: Table number format not retained+ "- CRASH when XML filter settings XSLTs test", regression crash!+ "- FILEOPEN particular .doc: Table of contents broken, internal reference information visible". Makes 3.5 useless for editing WORD documents, dataloss, saved with 3.5 also unsable with more early versions.Adding: on database system with no/poor boolean support, "big" queries/tables completely fail to open in datasheet mode.regression since 3.3.4:- Pie charts colors messed up when saving opening Excel (.xls) documentspossible regression, all formulas in doc file disappear:- LibreOffice Writer doesn't get the right border style of an image or object in .doc filesAdded, without the necessary change to the Windows installer (to include XML filters in the default installation), Flat ODF (XML) fails to work on Windows.regression, doc file opens wrong (see my comment):- FILEOPEN: Extra footer text when Libreoffice opens a .doc created in WordWriter hangs on Linux when open docx file, regression:- FORMATTING: Writer unable to format specific docx/doc correctly- presentation view defectiveAdding 45607 - really poor performance on Calc macro execution (repeat insertions).AlexAdding, this is a (partial) regression against OOo and the fact the field becomes completely undeletable is a very annoying behavior.regression since 3.3.4, OLE opject not opens:- cannot open OLE object when the document is opened in read-only moderegression since 3.3.4, most information in doc file is lost- FORMATTING: Opening a .doc file - Regression in Libreoffice 3.4please look at- [FILEOPEN] "LibO Writer changes decimal delimiter when opening a sdw file which causes data loss after saving"Maybe specific case, maybe more generic problem ..- Importing uno libraries in python my crash python; workaround existsadd- FORMCONTROLS: Notes/comments are displayed below controlsAddNon-standard caption number and reference do not appear in the insert cross-reference dialogIt took me far to long to step into this annoyancy: problems with paper size and printing. As fas as I am concerned, all 3.4 versions are affected and the 3.5 line logically too.- PRINTING - Brochure printing incorrectly changes paper size to 'Legal'- Print system fails to use or allow user to select correct paper size for printing- Letter-size landscape 2-column Laser PRINTING bugPlease note that in this comment :I've added two links to discussions on the users list. One with more explanation (in my judgement) / workaround.Highly recommended :-)Would be great to have 3.5.1 cured from those issues. ThanksPut back 33791. It was evidently removed by mistake, probably when adding a comment at the same time.Add 45117: Shrinked buttons in the warning when saving documents in non-ODF file formats.regression since 3.3.4 Writer crashes opening fodt file- Crash over invalid ODFNominating 43567, nasty crash in XML Form document production.AlexNominating 40261, see alsowhere there are bt provided by Julien - nasty crash in XML form controlAlexregression since 3.4.5- Unable to un-protect password protected MS-Word .doc documentCan't install 3.5 because it says I must quit using another version of libre(In reply to)It is most likely caused by the. The update to LO-.3.5 does not work directly from LO < 3.4.5. The solution is to either install 3.4.5 and then 3.5 or remove the older LO before installation.- Writer table: border of merged cell is misplaced (regression since 3.3.4)- Draw printing: Bitmap edited object prints incorrectly from Draw (regression since 3.3.4)No databases in Wisard of mailmerge (regression since 3.4.4)- Address data source wizard will not allow the definition of a Spreadsheet connection settingaddCrash when merging cells that have been pasted as Formatted text from copy of spreadsheet cellsAdd "- EDITING: CRASH when copy-paste text from particular WRITER source" because of regression CRASHAdded 44127 - Writer EDITING: LO crash on "Apply Numbering" Undo with Tracked Changesregression since 3.4: ole object inserted in Calc becomes looking corrupted when resize object or save/reload document:- FORMATTING: Position, size, word wrap wrong for WRITER OLE Object in CALCConsider- "Distributy Columns Evenly" does not work with the selected columns.Also scripting in Java unavailable (regression since 3.4.x) -- script dispatch java extensions are brokenThis happens with LO3.5.0 released version downloaded on 18/Feb/2012 on MSWin7Prof64-bit. LO crashes quite frequently. I have filed a separateabout crash when attempting to set proxy. (In reply to)mentioned aboveis regression since version 3.4@ Orwel, Michael Meeks: There is already a bug for Advanced printing capabilities of comments in Writer [PRINTING] at. It's one of my favorites.I don't know whywas not here, but now, it is: FILEOPEN: LibreOffice hangs with 100% CPU usage on specific .doc file.Add "- PRINTING: Paper tray setting not accepted from "File -> Print..."", broken important basic function.Regression: into Calc pastes not only selected text, but also content of Header of page:- EDITING: copy and paste text from Writer to Calc performs wrong (regression since 3.4)I added- PRINTING: VIEWING cell borders differs from PRINTING. Although it's still not confirmed, looks like a bug and behaves like a bug :)I add issue #46498, am checking if it was in the 3.5.0 rel versionadding issue #46165 more ole array handling brokenessNominatewhich could be related to: transparent color objects shows up in gray scale in PDFaddingThis is data corruption in a pretty well used dialog in calc ( e.g. the Manage Names dialog ) note: it core dumps for me consistently with accessibility enabled ( but ymmv )I would like to nominate confirmedfor 'most annoying'. As a professor, I was using the 3.5 series, but I cannot give my lectures because of the above bug, so I have a revert back to using the 3.4 series.(In reply to)It seems to be fixed in 3.5.1-rc1 => it does not need immediate attention => let's leave it out of the most annoying bugs.Feel free to put it into most annoying bugs if you still see it with 3.5.1-rc1 or never.(In reply to)I am not 100% sure that the bug is in LibreOffice. Anyway, it looks annoying, has more duplicates, so let's add it here.Add 45171: Can't open document with password; It seems to be related to a Firefox upgrade. It affects many distro builds.Printing problem on Windows 7. My be somebody can help to reproduce this or understand source of problem or knows workaround:- Letter-size landscape 2-column Laser PRINTING bugPlease consider, included in 'LibO 3.4 most annoying bugs', but still there in LibO 3.5.0...@RaphaëlI think that all 3.4 most annying bugs the will not be fixed in LibO 3.4.6 (last release of the 3.4.x series) will be then moved into the 3.5 listremoving( doesn't affect release build )AddedAdd: undocked 'Find' toolbar freezes the applicationWhen I hide a row and then copy the remaining rows Calc will also copy the hide rows.(In reply to)I'm not sure if this is a feature or a bug, but for now, there's an extension for the behaviour you want:(In reply to)Thanks for the pointer :-)Well, in general, please, do not discuss details about issues in this meta bug. It already has more than 200 comments, so any useful detail gets lost soon.I have asked Bas (in a private mail) to open bug for the problem and mention the bug number here.Add: Base Queries loose sorting-order when reopening for editingAdd "- SLIDESHOW does not show pictures with Hardware Acceleration activated"Add "- SLIDESHOW shows characters too slim with Hardware Acceleration activated"(In reply to)As I know this only works with rows hidden by filters not if is hidden directly.@:please don’t change Platform or Version here — this is a meta-bug to keep track of all "LibreOffice 3.5 most annoying bugs" (well, the headline says it all), and therefore, Platform should be All/All.add- Undo for automatic numbered/bulleted lists selects previous line, but the cursor should stay in position: a 1st class usability annoyanceAdd "- Recovery fails because no access to AppData Temp folder", data lossAdd "- EDITING: CRASH when undo copy paste". It's rather a chin-up to get the crash, but we can't know whether there are other more simple ways to crash LibO because of this bug.Adding 47068, nasty crash in Report Builder when moving a graphical object over a text field.AlexI just add- "recent documents list always blank with libreoffice" because it it quite annoying (it blocks an useful function also to first use users), it is a regression and it has been pointed out that cleaning the (linux only?) LibreOffice profile directory (~/.config/libreoffice/) solve the problem.:This bug first appeared in OO3.2 ( see)But it is still not fixed.The FilePicker is one of the most used functions in Macros, Extensions, andTemplates. And therefore this bug should be fixed soon. You can read nearly every weak about this bug in the mailing-lists or a forum.(,,...)Regards FriederAdd "- EDITING: impossible to perform a drag & drop of entire row/column", that's really annoying if you are used to work with those edit functions.Added- EDITING: Crash when copy/paste table with data from Writer.Nominating. Regression and big usability problem in Calc.Nominating 46439 as blocker - can not access postgres db with official 3.5 builds on Mac and native postgres driver - works on build from master !!(In reply to)Oh well, too late apparently !! Just seen the announcement for 3.5.1.AlexRegression since 3.3.4 in Writer: wrapping text around object becomes or seen wrong after use Page Preview- [FORMATTING] Incorrect text wrapping around drawing shapesAdding #46509 as the functionality of wiki export is completely brokenAdded an annoying installation issue..Nominating- cannot print in landscape in writerNominate- Movie and Sound media inserted into Impress presentations cause Impress to crash when the slide with inserted media is displayed on 32 and 64-bit Windows systems.Nominate, added videos or audio crash impress as soon as a presentation is started. This may be a windows specific issue, but it happens on 32 and 64 bit windows systems. This is a tremendous handicap and makes impress unusable for many.Adding "- SLIDESHOW CRASH on slide with embedded / linked video" (replaces)Add this long standing bug to the list please.<a href=""><b></b></a> - 3.4.2 Draw with transparent layer loses bezier curvesAdd "- PRINTING shapes with transparent(?) Bitmap background loses bezier curves"Add "- EDITING: Copy row to clipboard incomplete ... or: pasting copied row to other rows, makes that data in that row is repeated until the last column"; Calc is more or less unusable for me with tht bug.Add: Base Queries mangle sorting-order when reopening for editingAdd: Almost all graphics that have internal circuits is wrongly positioned in ODT import. It is a regression against 3.4.May I nominate— "Loss of footnotes when exporting to DOC-File"? A long-standing bug, of course, but IMHO very important, because this kind of silent, not easy to notice, but severe footnote data loss is exactly the kind of problem that could make LibreOffice useless for scientific, Academic and other purposes and could chase out many users if it became public ...(How can I say to my students: "Just use LibreOffice instead of MS Office, it's free and fast, you can save you document as DOC file later, if you ever need to do so", when there is the possibility that some footnotes get lost on DOC export? Then, if I say to a student: "This is a citation but you did not mark it! You made a plagiarism!" the student could just answer: "Oh no, there was footnote giving the complete reference, but LibreOffice must have killed the footnote when I saved the document as DOC file." Even the former German Minister of Defense, Karl Theodor zu Guttenberg, who had to withdraw because he missed so many many many quotation marks and references in his PhD thesis, could excuse himself by saying "I used OpenOffice, and it has killed all the footnotes." ;-)Great nomination Roman - thanks for that ! :-)please, consider this bug :this bug is also in libreofficeand is a very annoying bug...(In reply to)@choffardet:Here we only can list LibO Bugzilla bugs. Please check whether that's already reported, if not please file a new LibO Bugzilla Bug!Nominating. Regression and productivity killer.(In reply to)what about ?added- Presenter-Console duplicates (echoes) sound in videoAddedas nominated by choffardetadd Bug fdo#47717 - Paragraph border visible through an imageSorry -- removed("EDITING: Inconsistent / unintuitive reference link handling for check boxes and other form fields when Copying Sheets") again because it is now considered as "enhanchement". BTW: Sortet list of bug numbers to make removing a specific bug easier (the displayed list is sorted anyway, but to remove a specific bug from the comma-separeted list, sorting it makes sense).Added("[EDITING] When shrinking an object anchored as character, paragraph below it doesn't update its position") again -- see the convincing comments by Rainer and Josiasmat on the bug report page. This is not a critical bug, right, but really a very annoying on, the workaround is not obvious, and, as Josiasmat put it, "this is the kind of bug that makes one consider going back to M$ Word". At least for beginners and part-time office-suite users, this is definitely true.Add "- FILEOPEN particular DOCX 2007 - pictures shown wrongly on page 1", at least also sampld ofaffected, might make LibO completely unusable for .docx 2007 with picturesAdd- Regression: ODT files no longer display in Explorer previewExplorer Preview and Icon thumb also broken in 3.5.2rc1The Icon Thumb appeared to be working again in 3.4.6Slide preview (on left side) of Impress not working correctly, all slides except of first looks corrupted:- UI: Wrong slides preview when images on slide are cropped and scaledLinux specific regression:- Impress UI: impossible to select picture using left mouse clickregression in Impress:- Impress: text in odp file looks incorrect (regression after 3.4.3)Add 46904: single file collated printing creates broken PDF. This breaks "print to file" and "real" printing.Add "- VIEWING: Heading - Footer - Pagebreak lines appear somewhere in the page". It's harmless and acceptable for a x.x.0, but not acceptable for x.x.3 and a daunting view for someone who wants to try LibO. You don't get a second chance at a first impression.Now really addedAdding- Upgrading from 3.4 to 3.5 breaks Math/Formula EditorWriter, document with forms: impossible to export to any another format and retain information inside of forms, msOffice opens odt file without forms:- FILESAVE, FORMATTING, Text field data loss(almost) all doc files, opened by Writer, contain text approximately on 7% bigger than should be. It breaks layout and page division. Needed manual editing for each file.- FORMATTING: Writer places text icorrectly in MS Office documentsAdded- Calc EDITING: function Find&Replace behaves incorrectly if regular expressions used. Related to problem of the character "&" at the beginning of the search or replace string.I nominate "- LO 3.4.5 Calc fails to print an .xls file correctly." There is a work-around, but out of the box, LO on a Linux machine will fail to print an xls file properly--this is probably frustrating a lot of newbies and gives them the wrong impression of LO.(In reply to)No, very less number of people use this feature.I think it should be removed.Most important is, and probably the most difficult to fix too.There're a lot of unconfirmed bugs here, and a lot which actually needs not be here.This should be a place for really annoying bugs.I don't think these bugs should be added here --- the probability of someone placing the picture 'as character' and then resizing the image is very less... very few people are affected by this.-- 99% of custom animation is used on simple static text. This bug has an easy workaround.-- No one uses this feature. I don't yet understand how do you use it. Editing wiki directly in wiki's language is easier.-- not a major problem for many and has a workaround, but cause this already has a patch,......-- unused feature.-- it's not even confirmed. If you want security, encrypt your partitions, or put it in an encrypted archive.-- not a big problem.-- rarely used feature.-- same-- sameLet's process these first.I would like to nominate().It makes LO 3.5.x unusable in Eastern European countries when RTF export is concerned (and used).Since a lot of public sector uses rtf of MS Word files, that makes LO 3.5.x a releases very public-image-threatening to LO in these countries (those to decide whether to use open source in public sector, might start saying: "Why use open source if it has such serious bugs that can cause us severe headaches, loss of data?").Thsnks.changed importance ofto major(In reply to)Why do you think this's a major issue?Removing other pointed out bugs.Made changes.@ dE1) here placed also regressions, not only annoying bugs2) developers know what to do. Unimportant bugs they will ignore for now.@dEI think you should ask advise to the QA team (Reiner & co.) before removing MABs.removing those existing bugs from this page does not solves them.1) let not flame here2) deleting something from "Depend on" not very important because:a) bug numbers still seen inside of commentsb) most of them are closed because "Duplicate" c) bugreport owners often communicate directly to developers, not via MABIMHO, dE did great job. We could discuss particular bugs but some clean up was useful.For example. I am not sure about removing the. IMHO, the password protected documents are used by some type of users and it is rather important feature. Other than that, I agree that the removed bugs were not that important and did not belong here.Bugs mentioned here are proceed in two ways:First, comments are send to the mailing list. So, if you mention a bug, it is read by many developers and it might get immediate attention. In this case, it does not matter if you update the dependency or not.Second, it is used for prioritization. Developers can't fix everything immediately. They look here when they finish something and look for another job. In this case, they do not read comments but they check list of opened bugs. So, the dependency, priority, and severity is important.So, we need to keep dependencies, priorities, and severities in a good state. Otherwise, we will end with another swamp where it will be hard to find the important bugs. IMHO, we need not spend too much time on it at this stage because the number of opened bugs is still reasonable low and developers could filter them easily. On the other hand, any clean up is good and we might even need it in the future.Add "- FILEOPEN arbitrary.pptx will CRASH", seems we (at least with WIN) lost ability to open that document type (created with MSO)Hi dE(In reply to)Prolly this is not the best place to discuss. but ...Would be my guess too. But a short discussion in the issue decided different..Agree.How do you know no one uses this ?Will be fixed in 3.6 anyway. Maybe in 3.5.x too.How do you know?I agree it's not a MAB, since the use of native field cross-application is limited anyway.Not a MAB, where so many developers spend attention to this one?Formattig. Annoying people with existing document ...Assigned, devs pay attention too it, and it actually blocks people opening certain files in LibreOffice. Indeed AnnoyingAh well, a Wordprocessor with broken cross-references.. OK, it's Non-standard caption number, but why would that have be added in the first place?If a feature is used more or less, is not the sole scale to measure the annoyancy, IMO ;-)(In reply to)I think that indeed is the best idea. We have the QA list, and even can ask advise from users and discuss list if we think we got stuck ;-)Anyway, thanks for your thoughts and contribution dE.CorAdding again. I ask dE not to remove other people's bugs and not to discuss them here.(In reply to)The title clearly says "LibreOffice 3.5 most annoying bugs"... yours is not even a bug.You simply can't add your personal bugs or feature enhancements here... you gotta think about others also. And this way, the whole bugzilla will be added to the list.We're only interested in bugs which cause data loss, corruption, crashes, and other i/o errors (especially with MS office formats).I think it's time Rainer Bielefeld steps in and advice us what to do.(In reply to)I think that it is questionable. If it replaces 1345-1430 with 13.45-14..0, it is data loss. If you replace data in large documents and you do not notice, it might be very annoying.Please stop fighting about this bug. We are not in a state where we need to spend time on such long discussions. Developers are clever. They could filter few bugs that does not belong here. After all, this is just a helper bug. It does not enforce any work. It is just a suggestion.It is not Cor's pet bug. Cor have actively worked on bug triagging for a long time. He has great overview about type of bugs that people report. So, his opinion has some value. Note that nothing is black and white. There might be different views on some things.First, I thank you all for spotting and fixing all those bugs, and especially for opening bug like this one. What's clear here is that's about bugs, and not enhancements. I'd like to discuss 2 issues, I apologize if it's already been done. 1. "Most annoying bugs" is relative, we don't have all the same opinion about what's most annoying. If it's like this, where is the limit, or this should mean "all bugs"? I'm not aware of some bug that is little annoying and thus not here. My opinion is that all bugs should be tracked, although some minor and hard may not be fixed.2. "LibreOffice 3.5" has releases. Although in bug itself it can be seen in which release it will be/was fixed, it'd be convenient to see it also here. For example, to see "fixed in 3.5.1", "fixed in 3.5.2", etc below "Depends on". If it's a feature of Bugzilla, there should be some aggregating meta issue there, with that option, for bugs like this one.IMHO, it currently works the following way:If you add a bug here, you send a message to developers. Hey, this is something that people really hates in this release. It annoys many people and discourage them from using this application. This is something that you should solve ASAP.Developers look at the bugs and fix them if possible.Note that developers are in CC in many other bugs, read mails, have other tasks from other people, have their personal life. They maintain their own priority lists. So, this bug does not enforce anything. It is still only a helper tool. Though, it seems that it works pretty well.My view of why we need this bug:First, any software has bugs and we can't fix everything. Any fix could potentially create another bug. Also we could not make everyone happy. Some people might like a feature that annoys other people. We can't make everything configurable because it would be hard to maintain all options. Even if we make it configurable, people will fight about defaults. So, we will always have any bug reports.Next, this bug won't be needed if people set severity and priority correctly. Unfortunately, it does not work in a real life. If a person gets into a state that she reports a bug, she is often quite annoyed and wants a solution quickly. The bug is often quite important for the person, so she tends to set high severity and priority. One the other hand, some people does not know about this setting and they use the default values. All this can be corrected by people doing the bug triage who see many bugs every day and could better prioritize them. Unfortunately, we do not have enough people this time, so many bugs still have the severity and priority set by the reporter. So the query for all bugs does not show the most annoying bugs on top.Finally, this bug is a workaround for the above problem. It is mostly updated by people doing the regular bug triage. They know the bigger picture and do their best guess what belongs here. They try to do not include their pet bugs. Of course, everyone has its own opinion. Also this bug is opened for anyone. Well, I think that it has worked quite well so far and we do not need any complex rules. IMHO, the name "most annoying bugs" set the right feeling in most people ;-)If we want to keep it working, we need to keep a balance.If we mention too many bugs here, we will create another swamp of ideas and developers will ignore it. I am not sure where are the limits. IMHO, it somehow works now, so we do not need any regulation at this stage.In each case, fights about each bug are rather contra-productive. It is better to fix them than discuss their priorities ;-)@ TimurWe can see bug title when place mouse cursor over bug numbers in field "Depends on". Expected version, where bug will not exist may be added to end of titles of mentioned bugs. But it is much to work.Hi Timar,(In reply to)Yes, so the one acting with code (fixing a bug) decides.All are tracked. In bugzilla.In addition to what others said: the release notes give a list of fixed bugs.Should I add more bugs (I can easily add a 100 more).Yes, but preferred that only one bug per day. We should have time to think on one bug before appears another(In reply to)Yes and no. Bugs that belong here, pls do. However: I do not believe in doing it 'easily'. Since, steps in the correct work flow are: - reproduce, - test impact, workarounds, - query BugZilla for related and the same or closely related issues which may lead to do some bundling of issues - in case of doubt, consult others via the QA list....But any bug that is really a problem, and that is not yet visible here: pls do. We have had issues in the past, that were in BugZilla for months, turned out to be very nasty, and were not recognised fast enough, but discovered just because I (or someone else) was confronted with a similar problem and did "the work" in BugZilla.So finding those bugs, is important and more helpful than adding just a load of bug numbers to this MAB.Thanks for your help!@dE, Sasha, Cor:For discussions we have <>, please stop discussion here immediately! Same concerning discussion concerning relevance of bugs, discuss that in the bugs, not here. Tis Bug is only to be used for purposes as per Petr's report. All those 28 Users listed in CC do not want to read any of your thoughts!I suggest removal of -See my comments in the above bugs for the reason why.Added- large autocorrect database make LibO freeze when start typingProposeCan cause serious annoyance to people distributing pdf docs created from LibO Writer. See example inside bug report.Hello,I'd like to proposeFILEOPEN, FILESAVE, FORMATTING in RTF with non-breaking spacesIt is very complicated to edit RTF file with non-breaking spaces because a normal space is added just after each non-breaking space. Non-breaking space is quite common in French text, as there is one before each double punctuation: ':' ';' '?' '!'AddedAs said by Laurent, this bug make RTF export unusable for French documents.add- FILEOPEN Password protected file opens in background (visible on task bar / invisible in Unity)Nominate- Time lag makes Calc unusable for many business spreadsheets.Add "- CRASH EDITING TABLE when merge cells in .sxw" because of crashI would like to nominate.Reason: there is a large number of Libreoffice corporate deployments. A number of them, including my own, has a mixed environment which includes MS Office alongside LibO/Oo. Group policy-made deployments at LibO 3.4 broke, with LibO stealing associations from MS Office for Word files (.doc / .otx). As an example, on my 300-pc installation I rolled back to Oo, till this issue is solved. Unfortunately, issue persists on 3.5Summarizing:is a blocker (IMHO always) for corporate installations.adding- freeze when saving new entry to a large autocorrect replacement tableAdd "- EDITING: CRASH when add custom animation to media (Movie, Sound)"I added- Impossible to hide horizontal scrollbar in writer when zoom is over 100%. It's very annoying for users working with 'optimal zoom' on a small screen.rtf files open corrupted. Seriously regression.Add "- Error during Installation, Error 1335", we have 2 DUPs, so I doubt that those are random problems.Add "- closing the license document closes LibO". I doubt that that crashes cause much problems, but it's a crash at a very visible place an can be used for malicious-joy, scorn and ridiculeremoving feature bug from MAB listAdd 49522 - scrolling is broken in Base. Data are duplicated in fields.Replacingbyof which it is a duplicate.added- Printing multiple files from Windows Explorer at once makes LibreOffice unusableNominating. Haven't seen working cross-references in quite a while.Nominating. This is a severe regression for all of us heavily using Draw. This regression appeared during the 3.3 developement cycle and is still present in LibO 3.5.3. moggi told me on IRC to add it here.Nominating- Writer: Select All doesn't work on a document beginning with a table. It is a very old issue from OpenOffice.org. I guess it's not hard to fix.(In reply to)Sorry, but I removed this one.Just being an old OOo bug does not qualify for 'most annoying'. We could use an extra storage in that cast ;-)Nominate- "Persistent 'Restore Windows' dialog won't disappear, disables key functionality."I know this bug is only present on one platform (MacOS X), and there is a workaround for it, but that workaround is not easy and the complete issue is particular "annoying" in the lexical meaning: this bug has the potential to drive ordinary (real!) users crazy ;-)(In reply to)Cor, it seems that you and me have different perception of annoyingbugs. I'll quote a comment fromwhich describes myperception:Add "- EDITING: grouped shapes drawings become distorted", this one makes LibO DRAW completely unusable for me. Unfortunately it seems very difficult to reproduce the bug.Add "50399 - FILESAVE document created with 3.4.5 destroys grouped elements for 3.4 VIEWING". Dataloss when interchange between versions.Add: Shortcut names are not localized on Linux; regression in 3.5.4; it worked well in 3.5.3Add "- EDITING: Pasted object not same position w.r.t. original object if border thickness greater 0". This bug makes DRAW completely unusable for technical sketches. Although there is a simple workaround (use AOOo3.4) we need a fix for this bug.suggesting 50676 as it makes LibreOffice hardly usable for Chinese users.Nominate(Calc cannot filter data from the data source). This bug makes it impossible to draw data from a database and use that data in any helpful way in Calc, and there is no workaround. It is for this reason that my office has not been able to upgrade to LibO 3.5 at all. It looks to be a regression to a prior bug that may have been present in LibO 3.3.4.I nominate- FILESAVE: Long delays saving in XP .XLS format.Save as xls/xlsx with table column line must be possible.I nominate(SVG in PDF becomes Bitmap), because many business letters contain SVG-logos and cannot be converted to pdf any more.(Reset Importance pickers after accidental change.)(should be in the "Depends on" list, not in the "Blocks" list. Therefore corrected.)(In reply to)ok, added.Added 40481 50509 46508 46510 of which only 46510 is still unresolved.Nominating 49610: EDITING: Terminating 'Find' when reached end of document second time deletes slides, replaces contents by templatesNominated because many users use Find feature and would be affected if slides were deleted. Loss of data = really annoying ;)schrieb:Hi,you are a little late, and:<>Best RegardsRainerI nominate again. There are daily duplicated reports for this nasty regression bug.Add "- EDITING: CRASH when paste in outline view after SLIDESHOW" because of crashAdd "- EDITING: CRASH when modify Text Anmiation properties to "As one object" and check "Animate attached shape" option": rather unplausible user scenario, but crash!Add "- EDITING: CRASH when undo leads to a deleted style". Crash with rather normal proceedingAdded- "EDITING: Drag-and-drop slide sorting broken on Mac OS X, leading to data corruption and crashes".This bug seems to be limited to MacOS X for now, but is still really annoying and urgent:* it makes sorting slides in Impress completely impossible,* it leads to data corruption of a serious kind* and even to crashes.* Additionally, it is an regression introduced in LibreOffice 3.5.x.There are some reports about Drag-and-drop slide sorting not working on Linux, which could be related, so looking into this issue may also help to fix these Linux issues (and the other way around).Add "- Missing Search and Replace shortcut": If you use LibO for WORK that's worse than plagueAdding #51618, nasty crash and regression over 3.5.4 when opening a report based on a parameterized query on Linux 64bitSorry, that should read #51619AlexAdd "- CRASH hovering over Menu "File > Send" if no JRE is available and MediaWiki Publisher installed". We can't terminate 3.5 before this has been fixed.: embedded hsqldb too slow (regression)I have resisted for a long time, but finally I have to nominate- "Many crashes when accessibility enabled on Mac".I have resisted for a long time, because this is not an easy candidate:* the problem is limited to a single platform (MacOS X);* it is not always reproducible out of the box;* it is not clear where the problem comes from, i.e. if the bug is in our code or in Apple's code.But nevertheless, it is definitely a "most annoying bug", and so I *have* to nominate it:* it affects quite more users than you may think (see the duplicates listed in; and there are even more similar bug reports which are just not marked as duplicates of!)* it causes crashes about crashes for the users which suffer from it;* these crashes appear in many different actions, giving our users the (wrong) impression that every piece of LibreOffice was unstable;* therefore this bug has the potential to drive users crazy;* and to make them leave LibreOffice once and for good.You may object: "We have an easy workaround: just disable the MacOS accessibility features, and LibreOffice is stable again"; this is true, but IMHO it does not make this bug less annoying:* It is very difficult for "normal" users to discover any connection between the crashes in LibreOffice and the MacOS accessibility features,* therefore "normal" users will not discover the workaround easily;* we, the QA volunteers, have to ask people again and again to check their accessibility settings, which shows that people even forget about these settings (and therefore will not use the workaround, even if we list it in the release notes and read_me files);* for many people which are physically disabled/handicapped in one or the other way the accessibility features are vitally necessary, so they just CAN NOT disable them* and have to leave LibreOffice instead;* therefore this workaround is NOT a workaround for them.In addition, it gives me a rather bad feeling about LibreOffice that we unwillingly discriminate people (physically disabled/handicapped people) which are already discriminated by our way of live in many ways. This is a bad thing to do for free and open software -- it should be free and open also in the meaning of being easily accessible and usable for as many people as possible.Therefore, we need to track down this issue some day. Even if we can't fix it because the problem is in Apple's code (I don't believe this, because many other applications seem to work fine with accessibility features enabled, including other office applications!), we need to find out about this, either in order to fix it (together with Apple) or at least to explain to our users that the crashes are not our fault.Sorry for this rant -- no offence! -- I just wanted to state clearly why this bug, even being limited to a single platform and not easy to track down, is nevertheless an important (!) candidate for our "most annoying bugs" list. So please don't remove it from this list, but let's think together about what we can to do to solve this issue.Hi Roman,Please don't resist so long - it's good to make these visible, even if they are ill-formed and hard to fix; the video in that bug is amazing :-) clearly we need to address this. It is possible of course that the bug is in OS/X - but if so we need to work out which versions of it - and then blacklist a11y only for those versions (if there is a consistent pattern there it'd be good to build data for that).Thanks for raising it :-)add linked slide editing / potential data-loss ergonomic issue from 3.6 tracker - that is not specific to 3.6Nominate- Impossible to use Writer OLE object in drawing or presentation due to uncontrollable size and position.This is regression bug and it makes completely impossible to use releases after 3.3.4 if you need to have Writer OLE objects in your documents.Add "- CRASH on any action for particular big .odt". 7000 pages document is nothing affecting many users, but we had it working in 3.4, and who can know whether we also have an increased vulnerability with some hundreds pages documents?Add "- FILESAVE: # in hyperlink corrupts .docx (MSO2007) document": Dataloss Regression.Add win32 specific crash loading Danish dictionary during startup after upgrade- sounds bad.nominate: memory leak, crash under XP.- "FORMATTING Fit to Frame for text boxes is broken" should be removed from "LibreOffice 3.6 most annoying bugs" () and added here, because this bug goes back to LibreOffice 3.3.0.Add- FILESAVE [DOCX] File.docx, created LibO Writer, can't be opened in other programs ()Add- FILESAVE [DOCX] Loss of footnotes's text when exporting to DOCX-files ()Add "- CRASH when browse to HD root directory in FILEOPEN Template dialog": Crash, Regression, several DUPsI deleted(DUPLICATE of), added(FIXED), deleted(DUPLICATE of), added(NEW).Add "- SVG Export ignores line width", currently SVG export is completely unusable.Nominate(DOCX filter loses shape containing text) and(Error reading “Content (TOC)” from a DOCX).These bugs are not regression but they make unusable re-import OOXML textdocuments (DOCX, ISO) by Writer. As result we need to use Microsoft Office forthis purpose.Add- Large files become unresponsive since version 3.5.0.Regression - working with large files was fine with Writer in the 3.4 series, now broken.I'd like to nominate <a href=""></a> as it actually corrupts document content. This was still an issue with 3.5.5 and is also an issue with 3.6.0(In reply to)addedAdd "- FILESAVE: # in hyperlink corrupts .docx (OOXML) document", destroys documents, dataloss, similar to also listedFor the record:Sasha has added-- "merged cells in tables in DOC files not saved correctly by Writer on Linux 64bit".I am adding #38606: "Under Style and Formatting, clicking Apply always resets to initial tab".If I understand correctly, no one worked on this, because there are plans to redesign style modification dialogs, and chances are that "Apply" button will be removed.But this redesign will happen in 3.7 at best, which is around six months from now. This bug has been opened for over a year. Instead of having users waiting next half year, please fix it in at least 3.6 branch.Add- "FILEOPEN .doc/.docx (MSO2007) Bullet lists show wrong bullet symbols MacOS X".Rationale:This is a follow-up of the long-standing, which was finally fixed in LibO 3.5.4. Since this fix, bullet lists are imported correctly from .doc/.docx files in LibO on Windows and Linux -- but still not on Mac OS X. For this special case (bullet lists still wrong on Mac OS X), the specialwas filed. Nowwas a MAB; therefore,, which is about the same problem, just limited now to a single platform, must be a MAB, too.Additionally, cf. the user comments in, e.g.and 30., base crasher on any calculated fieldCHART printing directly is amissing feature which is included inExcel and in Lotus 123 for around 20 years. The workaround to export the chartto PDF and then print from there is working but a total mess and waste of timeto get it right ( changing page properties, changing chart window and alottrial and error).Bug Proposal - Calc is too slow to open and work with big datasheet fileSince I can't find any related bug so far, is there any bug open for this problem?The problem is simple, the file as 30,5Mb and almost 150,000 lines, with data from the last two years. It takes a lot to open and its very frustrating working this the filters (it takes to long just to open the menu). This has been reported to me since OOo 2.1 and only now I had access to a so large file at the enterprise I work.I want to start to migrate some office suites, but this bug is pulling the project out.I can prepare a file to share if needed.Added- "Charts embedded in .docx files are absent when opened in LibreOffice Writer"Added- "CRASH - opening database report" (was a 3.6/3.7 MAB, but is now already reproducible in LibO 3.5 daily, therefore moved to this list).Add "- CRASH when opening biblio.odb via tools menu without Base module installed", way to fix this one might lead via fix for- CONFIGURATION: Menu 'Tools - (open) Bibliography Database', although Base not installedNominating 48569 as a MAB. Document shows instance of document crashing when saved as .docx, potential for loss of data is high.Added- "QuickStarter setting not remembered after upgrade" because it's required for a resolved- "Turn on Quickstarter by silent install" to work.Added- "QuickStarter setting not remembered after upgrade" because it's required for a resolved- "Turn on Quickstarter by silent install" to work.Nominating fdo#50285This bug has the potential of really creating an unprofessional document. This could be a real problem for business people or students if they save as a document and then submit the work as it completely changes the text.Remove chart printing bug, as it is a feature request and has no place here.---Please note that this doesn't mean the bug isn't important in its own right, but it is not a crasher, not a data loss bug and also not a small/big annoyance that's easy to turn off.is a change in Impress from 3.4.x which negatively impacts existing slides which are subsequently edited using 3.5.x: the available text area is reduced for any newly inserted slide creating an inconsistency with other slides in a slide set. Thus I think we have a regression. Problem also exists in 3.6.x.Added- autocorrect limit. acor.dat with entry 65535: Loop and/or loss of acor data.IMHO this is very annoying since the 65K limit of autocorrect entries is something that sooner or later any user will face and the after reaching that limit the autocorrect database will be reset to 0 loosing all entries collected.it seems the 65K limit is related to 16-bit encoding...is there any chance to raise this limit from 16^2 to 20^2 or 32^2 ?something similar was done in Calc to allow more than 65K columns (actually I think it can handle 1 million)s(In reply to)sorry, I meant Added- autocorrect limit. acor.dat with entry 65535: Loop and/or loss of acor data.move(comment printing) from 3.7 MAB to here where it belongs.Showstopper bug for upgrade to LO 3.5/3.6 in some enterprise deployments that store user data in central file servers.For the record: Lionel Elie Mamane has added*- “EDITING Report builder: mouse-resize control allows to move top of control to out of section”*- “EDITING Report builder: mouse-move control: gap between mouse position”Added– DOCX file is opened properly but is re-saved to native LibreOffice ODT with mistakes and with missing formulas.Add "- No WINDOWS daily builds available for QA", without daily builds for 3.5 latest fixes for 3.5.7 can not be verified by QALibreOffice 3.5.4.2When saving to *XML.docx (other save formats not usable), Paragraph > Borders > "Spacing to Contents" Settings are lost (not saved, or not read on re-open?) when the document is re-opened.LibreOffice 3.5.4.2When saving to *XML.docx (other save formats not usable),Imported graphic image lost; but place holder remains.@Lou Vaughnplease, cite an existing Bug number or in case it does not exist yet, file a new bug report with steps to reproduce and test documents.As suggested by Timon in,I add-- “Incorrect numbering of paragraphs in docx document”. Makes LibO unsuitable for academic etc. usage.If we speak about academic usage, then there is anotherwith OLEIt also present in AOO and confirmed thereThis bug affects LibO 3.5, 3.6; AOO 3.4; may be other LibO and AOO more old versionsAddingfileopen read error on older Lotus 123 files. Add it here because already not working in 3.5.5.AddIn Calc, object anchored to cell are moved to A1. Same aswhich was corrected for LibO 3.6.2.Added, because youre in trouble when you have to hold your slideshow and saved as pptx for that and this bug will appear on nearly any pptx show to a certain degree.Adding 52392 - Biliography database is screwed. New entries to bibliography database cause random illegible data to be written to unfilled fields which then display both in the table view and any use of the biblio db in documents, e.g. for creating a bibliographic index.Alex(In reply to)add image cropping annoyance mis-added to 4.0Added- FORMATTING: Autofit doesn't work properly on long textsThis is terribly annoying for me: with longer lines, part of or all of the text in a text frame regularly gets squeezed together so the text becomes illegible. Workaround is to disable Autofit completely.I would guess thatis meant to be in the “Depends on” field, not in the “Blocks” list, isn’t it?!Added- “FILEOPEN Word 97-2003 DOC structure is not recognized”.A regression, very important, introduced somewhere in the 3.6 development process and then backported to the 3.5 branch. According to my tests, the backporting was done between the releases of 3.5.5.3 and 3.5.6.2; this is a fairly limited range of commits which need to be checked.[I thought that this (3.5) list was more or less closed, but it seems to be still alive, therefore I add the bug to this (3.5) list, not to the 3.6 list ;-) Correct me if I am wrong ...]Shouldn't be WONTFIX already?@Urmasif I remember correctly I read on the dev list that Reiner and the QA team will probably review all the opened 3.5 MABs before the end of the year and then the still valid bugs to the 3.6 MAB list.a similar job was already done in the past when 3.4.x cicle ended and all the survivor MABs were shifted to the 3.5.x listFor the record: Norbert Scheibner has added*- “FORMATTING - Calc ignores manual breaks when ‘fit to number of pages’ is chosen”Definitely a disputed case, but I agree that we need at least more consistency in manual breaks handling in Calc, so this seems a valid nomination.Nominate(FILESAVE Save/Save As dialogs use last save folder (not original) with non-ascii path)Really annoying issue causing documents loss.Removingas it was marked as a DUPLICATE of, and adding the later.Is it possible to have some feedback about this very annoying bug about "incorrect cross-references in Master/Sub-document"?These two bug reports echo only users comments for several months, and it is still broken.Thanks in advance.@nomnex - we try not to bump bugs in MAB or discuss them here in the comments. If a bug is already on MAB list, we do ALL discussion on the bug itself, not in the meta tracker.Thanks!(In reply to)Yes, sorry about that.And with that last bug removed from 3.5 MAB --Set status to CLOSED/FIXED, in order to make it really obvious (especially for beginners) that no more bugs should be added to this tracking bug.Really mark as CLOSED. Also add accidentally-removed mab3.6 back to 'See Also'.Hi all,The MAB docs on the wiki have been updated to reflect the newPriority-based system for categorizing bugs:The old MAB tracker bugs (mab4.3, mab4.4, etc.) will remain inBugzilla for historical reference, but should be ignored for currentwork. ......................FINAL mab3.5 STATS......................fixed bugs -> 215open bugs -> 0......................
id=38542	Created180% screenshot of table rules in 3.3.2I have a document with hundreds of tables. I designed the table rules with the corporate style. I've attached a screenshot of one of the tables, before and after 3.3.4.When I loaded the file into LibreOffice 3.3.4, the table rules exploded, as shown in the second attachment. (Both attachments are taken with the document at 180%.)Here's how the upper-left corner cell is defined in the odt/content.xml file:style:border-line-width-left="0.0139in 0.0139in 0.0139in" style:border-line-width-top="0.0139in 0.0139in 0.0139in" fo:padding="0.0201in" fo:border-left="0.0417in double #0000ff" fo:border-right="none" fo:border-top="0.0417in double #0000ff" fo:border-bottom="0.0007in solid #0000ff"Here's how is looks in 3.3.4:style:border-line-width-left="0.0417in 0.0417in 0.0417in" style:border-line-width-top="0.0417in 0.0417in 0.0417in" fo:padding="0.0201in" fo:border-left="3pt double #0000ff" fo:border-right="none" fo:border-top="3pt double #0000ff" fo:border-bottom="0.05pt solid #0000ff"As you can see, the border-line-width-left and top are getting tripled!(B.T.W. 0.0139in = 1pt; 0.0417in = 3pt) Created180% screenshot of table rules in 3.3.4Yo, anyone home?Createdtable with 3pt double rules that don't display properly in 3.4More on this one. LibreOffice 3.3.3 and 3.4 display the same table rules radically differently for the same file (attached). 3.3.3 draws the lines correctly. 3.4 draws the lines way too fat, which obscures part of the content.Still a problem in 3.4.2rc1P.S. The tables were created in OpenOffice, not Microsoft, so it's a problem with changing OO versions, not conversion from Microsoft.[Reproducible] with "LibreOffice 3.4.1 - WIN7 Home Premium (64bit) German UI [OOO340m1 (Build:103)]". In master situation becomes even worse!Situation is a little confusing because there seem to be also bugs in older versions ( see "- TABLES border formatting preserved").But facts are:a) Double borders are shown different in LibO 3.3.3 (OOo) ans LibO 3.4aa) white space between lines and inner lines will be shown too thickb) Saving with LibO 3.4 and Reopening with LibO 3.3.3 does not heal problems from 3.4, Tables will be destroyed, look even worse than looked with 3.4 (with thin single border) and can no longer be used in 3.3.3 without intensive rework.For more details please see screenshots from my Testkit.This problem makes 3.4 unusable for all users using tables with double lines. Dataloss problem, so CRITICAL@Steve Kelem:Version modified due to <>?@Cédric:Please feel free to reassign if it’s not your areaCreatedTest kit, seeIt causes data loss. It is relatively common thing. So I increase the priority.Cedric has vacation next few weeks. Lubos, any chance that you could look at it?.Is this related to- Abnormal Table Rendering ?No,has to do with rendering tables whose borders were generated in xml, something about incompatible parameters.This bug has to do with tables created in OpenOffice prior to 3.4 being rendered improperly in 3.4.Has anyone signed on to this bug?(In reply to)Abnormal table rendering you can also see in new documents created with LO 3.4.3.Glad that someone filed this bug before. This bug makes older files nearly unusable.Createddoc viewed in LO ver 3.3Createddoc viewed in LO ver 3.4 & greaterCreateddocument containing table with single line bordersIt's not just double borders that are affected. I have many documents containing tables with single minimal width (0.05pt) borders that no longer render correctly. A stripped down example is attached. In OOo 3.3.0 and LO 3.3.2 this renders correctly, with borders around all cells (see first screenshot). In LO 3.4.x and LO 3.5.0, most of the borders are missing (see second screenshot).For me, this makes LO completely unusable.Createddocument viewed in OOo 3.3.0Createddocument viewed in LO 3.5.0 beta(In reply to)Another issue, viewing hidden cell borders has changed also.Using Lo 3.5 RC1 and the LO 3.4.x series.These two features seem to control the visibility of cell borders, the behavior has been changed.1. menu > view > text boundaries2. menu > table > table boundariesAFAIKT, 'table boundaries' is not working (does not show or hide cell boundaries) on my docs.Seems like someone has been busy changing table features, without an eye towards backward compatibility.Createdput "double" cell borders on a dietin the first attachment, the cell borders are of type "double",and the ODF import filter effectively triples their width.patch should fix that.Createdprevents wrong overriding of the style:border-line-width attributesanother problem when importing the first attachment:the width from fo:border overrides widths in style:border-line-width,which are more specific for "double" style borders and thusshould be preferred.additional note about the second patch:i'd really like to detect the fact that we have read the otherattribute by adding some booleans in the import filterinstead of checking that the width is not zero, but that seemsto require too much refactoring to do it now... so thisheuristic will have to do.now, the document inside the zip file attached inlooks much better, which is mostly good but in one case not:the 6.55 pt double border has attributes like this: style:border-line-width="0.002cm 0.088cm 0.141cm" but it is displayed with 3 equal width inside, gap, outside lines.looking at it in OOo 3.3 it is rather ugly, but stillthe fact that it looks prettier in LO 3.4 is a regression :)Createdadd a custom double border stylethis patch seems to fix the problem described in previous comment.i'm really not sure if this is the right approach, apparentlyeverything that doesn't match one of the pre-defined stylesis deliberately ignored; is there a reason for that?anyway, saving the document again, i get the same attribute values,and the rendering looks rather more like in older versions,except not the same: the thin inner lines are painted too long,also outside the table cell borders.Michael,thanks for the patches. they are OK for me. I just pushed them to master and cherry-picked to -3-5. 2 more reviews to get them into -3-5-0.Have these patches also fixed the problem with minimal width single borders (see)? If not, I will open a new bug for this.the bugdoc attached inmainly has the problem thatthe border line is only 1 twip wide, and is not painted for some reason.this problem is handled with.OK, thanks Michael, that saves me a job. Can I suggest changing the title ofto make it more obvious what it is now tracking.***has been marked as a duplicate of this bug. ***fixed in libreoffice-3-5:fixed in libreoffice-3-4:***has been marked as a duplicate of this bug. ***
id=39192	The attached document should show TRUE in all cells in Column F, but it doesn't.The build from the -3-4 branch calculates correctly. So this is currently a master-only problem. Createdtest documentHoly crap. Where did my attachment go?Works well in Win7x64 Ultimate, LIBO 3.4.2RC3(In reply to)It's a master only bug.Fixed on master:oops, that'sinstead.
id=39484	Several times, while editing one of several spreadsheets, I have found the outline groups which I had recently created, to have disappeared. I believe this sometimes happened while the file was open; more often, I have noticed the outlines' absence only after re-opening a file which I had previously edited. Sometimes the outlining disappear from multiple sheets, sometimes just from one.When I discover the outline groups to be gone, the rows (or columns) which had been collapsed, are now hidden. I can reveal them by selecting a range including those rows or columns, right-clicking, and choosing Show. But there seems to be no way to recover the outlining I had created, other than to re-create it from scratch.Is there anyone else who has noticed, or is able to replicate, this behavior? Because it happens inconsistently, I'm not yet sure how to reliably reproduce it, and the files which it affects are full of personal information, so I'm reluctant to share them. If necessary, I suppose I could try to craft a simple file where the behavior might be replicated. (Any tips are welcome.) I think it would be best if you give a case (even if it isn't consistently reproducible) in which the bug occurs. That way there are some attributes that people can examine which might be the cause for the failure to record the change.There was a case reported inin which calc does not save changes in cell's widths and other attributes because the spreadsheet was imported as a .doc file. Perhaps that might be the cause of the bug?Anyway, keep digging,but any sample document or reproducible behavior would be great help.(In reply to)Thanks for the reply. In fact, I believe all of the documents in question originated as PlanMaker files which I saved as Excel and then opened in LibreOffice. When I was editing them in PlanMaker, besides other bugs (which eventually led me to switch to LibreOffice), sometimes the outlines were lost or corrupted (certain levels or elements of them were lost). I thought it was strange that LibreOffice, a completely different program, would have a similar bug, where outlines could be corrupted or lost. Perhaps, as you suggest, it's the files themselves which are corrupted, and LibreOffice only wasn't able to detect or fix the corruption when importing them.I'll experiment with this and post more.CreatedFirstSee post for detailsCreatedSecondSee post for detailsCreatedThirdSee post for detailsSince my last post, I tried copying all the sheets of one of the spreadsheets in question to a new file (both ODS), to see if the outlines would still be occasionally lost. Today I opened that file to find, indeed, all the outlining gone.Jeffrey, if you have a hint for how to copy the data to a new file without bringing along whatever corruption might be causing the outlines to disappear, please let me know.For now, I post three files, which I've just created, in case anyone can examine them and see what differences might lead one or more of them to lose its outlines. I haven't yet observed that behavior with any of these files, but if I do, I'll post again.All files are ODS. The first file I simply created from scratch in LibreOffice. I named it "Outlining bug test (created in LibreOffice).ods".The second file I created in PlanMaker 2010 (by copying & pasting the range of text cells from LibreOffice, then duplicating the outlining by hand in PlanMaker), and saved in PMD (PlanMaker's native format), then saved again in XLS, then opened the XLS in LibreOffice and saved it as ODS. I named it "Outlining bug test (created in PlanMaker 2010 as xls).ods".For the third file, I used LibreOffice to open the original PMD I had created in PlanMaker, and then saved it as ODS. I named this file "Outlining bug test (created in PlanMaker 2010 as pmd).ods".For the second and third files, I adjusted some of the column widths, as they didn't all convert accurately. For all three files, I collapsed the outlines to level two before saving (i.e. levels one and two are visible, level three is collapsed).All three files, therefore, should have these rows, where parentheses indicate rows which are collapsed, and brackets indicate rows which are simply hidden (and aren't part of the outline):1-2-3-45-6-7 (--8)-9-1011 [12 13 14]15-16 (--17)18-19 (--20 --21)-22-23And these columns:A-B-C-D (--E)-FIn my experience, when the outlines disappear, those rows/columns which had been collapsed, the last time they were viewed, are now simply hidden, and there's no evidence of outlining.I hope these files are helpful.CreatedThird (corrected)See post for details[This is an automated message.]This bug was filed before the changes to Bugzilla on 2011-10-16. Thus itstarted right out as NEW without ever being explicitly confirmed. The bug ischanged to state NEEDINFO for this reason. To move this bug from NEEDINFO backto NEW please check if the bug still persists with the 3.5.0 beta1 or beta2 prereleases.Details on how to test the 3.5.0 beta1 can be found at:more detail on this bulk operation:Dear bug submitter!Due to the fact, that there are a lot of NEEDINFO bugs with no answer within the last six months, we close all of these bugs.To keep this message short, more infos are available @Thanks for understanding and hopefully updating your bug, so that everything is prepared for developers to fix your problem.Yours!FlorianDear bug submitter!Due to the fact, that there are a lot of NEEDINFO bugs with no answer within the last six months, we close all of these bugs.To keep this message short, more infos are available @Thanks for understanding and hopefully updating your bug, so that everything is prepared for developers to fix your problem.Yours!FlorianDear bug submitter!Due to the fact, that there are a lot of NEEDINFO bugs with no answer within the last six months, we close all of these bugs.To keep this message short, more infos are available @Thanks for understanding and hopefully updating your bug, so that everything is prepared for developers to fix your problem.Yours!FlorianDear bug submitter!Due to the fact, that there are a lot of NEEDINFO bugs with no answer within the last six months, we close all of these bugs.To keep this message short, more infos are available @Thanks for understanding and hopefully updating your bug, so that everything is prepared for developers to fix your problem.Yours!FlorianI confirm this bug.With version 3.6.4.3 we had several cases of disappearing groups (and the rows/columns remaining hidden).Worse, still, all notes were gone too!All files were originally created with Excel 2000 and in october 2011 converted to ods (by openeing and saving as ods) in a batch.We have only noticed this behaviour since 3.6.4.3, i.e. we have no reports before december 2012, and 3 sofar since. Currently we are checking all ods files changed since out update to 3.6.4.3, so we might find more.As data gets lost, I have upgraded the severity of this bug(In reply to)We have finished out investigations:of the thousand+ of ods-files that have been converted from xls to ods, two files have suffered loss of all groups and all notes on one or more tabs (not on all tabs). One file had this phenomenom more than once, i.e. at one date the groups and notes of one tab were lost, at another date the groups and note of another tab were lost.We have only checked files that have been modified in the last 2 months.One of the files lost its groups and notes on one tab before the upgrade from version 3.5 to 3.6.4.3, the other incidents happened with version 3.6.4.3. We have not been able to establish whether all incidents originated from one user/one installation.We cannot reproduce the problem. Should we be able to reproduce the problem or similar behaviour, I will update this bug inmediately.(In reply to)I have this problem with EVERY ods file I use. I've tried to narrow down what could the fault be, but I get lost in the possibilities.I feel lost, as a I am engaged to free software and it seems impossible to work without manual grouping and outlining. I tried these with no successI am currently working on a 10MB,260 sheet ods file. The problem is exactly as explained above. The ods file does not come from xls conversion. It sometimes happen on one sheet, sometimes on all sheets. The result is devastating on a 260 sheet file. I've always managed to workaround the various bugs from various releases, but this one is the most critical. I am worrying what I am going to do, if I don't find a workaround in the near future. I currently use kubuntu 12.04 , had the same problem with 11.04, I am considering of trying libreoffice4 at some point or another distro. I am also trying to find out how to report the bug since it is the firt time I report or comment a bug.In the meanwhile I would appreciate any directions on how to deal with it. Going to ms excel is no option, I intend to deal with it.Createdcalc document that suffers grouping/notice lossAttached document has suffered loss of grouping and notes in entire tabsheet(s) more than once, all with version 3.6.4.3 on Windows 7.Tab "Bediendeel P4238_4241" was most often the victim of the bug.Document has been saved as fods to remove client's name and then resaved as ods.This document was originally created in MS Office 2000 and in 2011 opened in LibreOffice, saved as ods and kept as ods.When investigating the damaged file (saved as fods to investigate), Grouping and notes where simply not there at all. If need be, I could upload such a damaged file too (after removing the client's name).First, thanks a lot for moving this bug forward. Unfortunately, I am not able to reproduce the problem.I tried the following with both LO-3.6.5.2, and 4.0.1.1: 1. Opened fdo39484-sample.ods from the2. Saved as fodt and reloaded 3. Saved as ods and reloadedResult: The grouping was still there.The above test was inspired by the description:--- cut ---Document has been saved as fods to remove client's name and then resaved as ods.This document was originally created in MS Office 2000 and in 2011 opened in LibreOffice, saved as ods and kept as ods.--- cut ---So, I do not know how reproduce this and how to debug this. It even looks that the document could get corrupted when removing client's name in the fods form.Could you please, provide clear steps how to reproduce this? It would help if you start with a good document, do some steps and end with broken document. The following style helps to provide good description:1. Open document X in application Y2. Do this3. Do that4. ...Result:Expected Result:I am sorry but this bug can't be blocker in this state. It is a data loss but theindicates that it affects only very limited set of documents. It seems to be pretty old but I do not see any duplicates or many people in CC which means that it probably affects only very limited group of people => reducing severity a bit.It even does not belong into MABs in this state because nobody is able to start debugging it right now. I will leave it there because it is a data loss and I guess that you will provide the scenario within next few hours or days. I feel that we are very close :-)(In reply to)No, to my frustration I cannot. We have so far not been able to reproduce the data loss on purpose. We know that one document () seems to be more susceptible, but losing the grouping (which is very annoying) and losing the notes (which is more than annoying) seems to happen unexpectedly.Koukasio () also reports seemingly random, unexpected and not (yet) reproducible happening of the bugWhat I can say is that we did not have any of this with version 3.5 and earlier.Because of problems with openening Access files, we only updated to 3.6 when 3.6.4 came out.When I get a report from someone regaridng this grouping/notes-loss, I try to look at the damaged file, but it seems as if the grouping and notes are simply not saved for that tab sheet.As our problems look like the orignal reported bug, I reopened it, but my (and koukasio's) problems may be different from the one reported in 2011. I don't know.Changing the severity and reporting it as MAB was triggered by the loss of data, it not happening only once or with only one user and the confirmation of koukasio of the bug.I'm willing to help wherever I can. On the coding part, I have no experience with the file saving aspects of calc, but I could add traces to the code - if only we know how to reproduce th bug ...I have tried to reproduce the bug, but I can't. I have even made notes with the possibilities, but I get lost in them. My basic problem of reproducing the bug is that it happens in an unfocused sheet and there seems to be a random aspect. The closest I've come to it, was when once the +- buttons on horizontal grouping were visible but not responding to clicks or shortcuts for hide/show. After switching sheet and back again , buttons were gone and grouping was lost.I have some examples, because I save instances of the document often, but it is a 260 sheet 10mb document and it is difficult to track changes...I understand your pain. Please, try to understand the other side as well. If it is hard to reproduce, it is also hard to fix. The LO source code is really huge and the bug might be in many locations. Some complicated bugs takes days to fix even when they are easily reproducible. This one is harder because there is no scenario.The bug has been reported 1.5 year ago. I understand that it is data loss and more people are affected. But still there are only 4 people in CC and no duplicate. I do not understand why it should suddenly start blocking bug fix release with other useful fixes and improvements.Please note that changing severity from blocker to critical is not that big change. It only means that this bug will not block the release. It has the highest priority, the second highest severity, so it is still on top of the queries. It is listed in MABs, so heavily advertised. I have also nominated it as "Hard Hack", so it might get even more attention soon, seePlease continue in monitoring this problem when you work with LO and when you read other bugs or mails. It is kind of detective work. You might meat a new indicia that could help to create a scenario and help to fix it.I guess that there is an operation that breaks a data structure in memory and the information about the outline groups gets lost. It might help to remember what operations you did when this bug happened and compare them with operations that you do the other days and you do not see this bug.(In reply to)Thanks for your assistance and cooperation..! I understand. I've always managed to work around the bugs, and keep on doing my job, but this one is the first time I feel blocked. Considering that I have noticed this problem for over a year now without reporting(not sure what to do), and considering that I feel being a quite experienced user, I can imagine that there are a lot more people who have this problem but do nothing, or run to MSoffice. Going to MSoffice is not an option to me, but I know that people don't have to think the same way. I know now, that it is impossible to work without outlining. After failure for a long time, I've decided to sacrifice my time and outline normally (it always breaks in all my multisheet files) until that indicia comes, but I feel a bit wasted at times (it's been a MONTH of everyday failure, not days). I need help.(In reply to)I 100% agree with you, I work on the code. But as this is a 'hard hack', it's too complex for me to fix ;)Given the difficulty in reproducing the problem and the, blocker is not correct.I've taken the liberty to change it to critical.I will provide as much information as I can gather about this bug, in order to assist the hard hackers.I gambled a little around with 3.4.5 (WIN) and "fdo39484-sample", as expected without quick success. Really a hare nut, thanks to Petr no nominate this one as hard nut.I would like to do a "brute-force test" to try to make this one reproducible, but there still are some questions to be clarified before in beforea) is it 100% clear when the loss happens?a1) you see outlines missing after FILEOPEN, but do not know whether might have been lost during FILESAVE, because you did not try to open with other software before edits?a2) definitivly FILESAVE, groups lost for all other software when FILEOPENa3) definitivly FILEOPEN, I tried with an other software and still saw the missing group(s)b) Am I right that normally only some groups are lost and replaced by hiding the rows / columns, but normally not all?b1) yesb2) no, but ...c) do we have any document set showing a before/after loss. I would prefer something like Winfried Donkers' sample what is simple enough for quick tests (might be with macro aid)c1) yesc2) no, but ...d) due to "fdo39484-sample.ods" contains hundreds of ODF errors. Are sample documents with valid ODF 1.2 (strict) available?d1) yesd2) no(In reply to)I see outlines missing during a workflow, not affected by FILEOPEN, not sure if affected by FILESAVE. If the document is saved with correct outlining, the outlining will be there in after FILEOPEN. If the outlining breaks during the workflow and saved, it will not be there after FILEOPEN.I have not tried other software. I use LO (linux).The outlining breaks a single sheet or more sheets, not parts of sheets. There are times that I have noticed some sheets broken, while others remain unaffected, although it seems certain that they will break at some point during the workflow, they always break . Most times I've noticed all sheets broken.My basic problem of reproducing the bug is that it happens in an unfocused sheet and there seems to be a random aspect. The closest I've come to it, was when once the +- buttons on horizontal grouping were visible but not responding to clicks or shortcuts for hide/show. After switching sheet and back again , buttons were gone and grouping was lost.My samples might not be "simple enough for quick tests" as they are 10MB 260sheet, but I can send you two samples in case you want to check out.I've always had the setting ODF format version: 1.2 Extended (recommended) in the Options menu.Createdsample of document with outlining before breakageCreatedsample of document with outlining after breakage@koukasio (In reply to):Thank you, that helps a lot. I will do some tests and research with your documents asap (unfortunately rather busy currently).@all:Can you please submit separate bugs for all similar problems what are not "loss of all groups during workflow" weth "related to this one"? Although all these problems might have the same roots, dividing the problem into smaller parts might ease tests and finding those roots.I did some first investigation in contents.xml of sample "2013-03-02 10:36 UTC," and related broken document. I see that the groups (not unexpectedly) really are lost, compare:CONTENT.XML OK------------------<table:table-cell table:number-columns-repeated="1015"/></table:table-row><table:table-row-group><table:table-row-group><table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce6"/><table:table-cell table:style-name="ce15" office:value-type="string">BROKEN same area (missing group definition):-------------------------------------------<table:table-cell table:number-columns-repeated="1015"/></table:table-row><table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce6"/><table:table-cell table:style-name="ce15" office:value-type="string">@koukasio / allHow often do you see such problems? all 100 edits? all 100000 edits? Only to get an idea how much edits might be needed to have a chance to see something interesting(In reply to)We have not noticed grouping/notes losses with versions prior to 3.6.4 (all Windows), except possibly once (with version 3.5.something) in November 2012.In our cases, all losses happened when the document was saved and was noticed when openened the next time. That is to say, grouping (sometimes notes as well) gets lost on a complete sheet, which need not necessarily be the sheet in view. So in some cases, the loss of grouping/notes was only noticed some time later.The groupings (notes) are simply not saved for that sheet, I examinated several backups and studied the xml-content.It may be that I do not understand your question, but when it happens _all_ grouping (rows and columns) are gone on a sheet. I cannot say whether it happened on one sheet only or or one or more sheets, but it did not happen on all sheets. The sheet(s) with lost grouping (notes) were often not the selected/visible sheets.Yes, I have several documents before and after as we have a lot of backups. I cannot upload them as they are (the documents include information from customers) to freedesktop. I can upload one or more fods with sensitive information removed, I can also send them (ods) as an attachment to Rainer or Petr directly on the condition that they are used discretely.The documents with which we experienced the grouping/notes loss were all xls-docuemnts (Excel 2000) that were converted to odt in the autumn of 2010 and used with LibreOffice since. So yes, ODF-errors can be expected in the documents.I include 'notes' when I say grouping, as the loss of notes occurs together with the loss of grouping (in the same tab). I cannot say with certainty that grouping loss did not occur without notes loss, but the other way round (notes have not been lost without groups being lost) is definitivelt true.We have 8 people editing a total of 20-100 of calc-documents like the fdo39484-sample. Some are edited several time a day, some only once a year. We only noticed the data loss since December, 2012 and only found two documents which suffered data loss (we checked more than 50 of these documents that were modified in November/December 2012 and January 2013). One of these two documents, suffered data loss several times. My suspect is that it is a combination of document-content (ODF-error?) and FILESABE handling of LibreOffice. The people that edit these two documents regularly have downgraded to version 3.5.7. Since then we have not noticed grouping/notes losses.As it looks to me that it is document-related, the ratio with which the bug happens could be less than 1/1000 for documents in general or 1/10 (a guess) for susceptible documents.(In reply to)When trying to notice, I keep checking back an forth for any losses. At some point I find it really frustrating to keep checking but there comes a point of breakage. So I can tell you that it is more than 100. 100000 sounds too much. Maybe a class of 100-10000.@koukasio: Ah, you set the blocker severity again. I understand that it is a blocker for you but it is not blocker for most other users who do not use this feature. The broader view is important in the time based release process, see. I am sorry to say but this bug could not and will not block 4.0.1 release and any further bugfix releases. I leave the severity as is because I am not able to persuade you and do not have possibility to make it read only. Any shufling just create mess and is waste of time. The current severity does not reflect reality and will be ignored in the release process decisions.(In reply to)I did nothing, I expect your apology...(In reply to)Apology is all mine, I was changing the severity of the bug accidentally, maybe something to do with the refreshing of the page in my browser. I am sorry for the mess I've caused.Winfried - does this continue with LibreOffice 4.0 ? - I had a go at reproducing it; cranked down the undo level to only 2 steps to try to provoke things some more [ no joy ], did a number of random hide/show / column deeletion etc. The sample sheet is rather beautiful ! Thanks for that koukasio ! otherwise, I'm a bit stuck here as others have been; how annoying !Diffing -u -w the flat-odf of before/after it is interesting to see things like:@@ -1804,8 +1804,6 @@ </table:table-cell> <table:table-cell table:number-columns-repeated="1015"/> </table:table-row>- <table:table-row-group>- <table:table-row-group> <table:table-row table:style-name="ro1"> <table:table-cell table:style-name="ce6"/> <table:table-cell table:style-name="ce15" office:value-type="string" calcext:value-type="string">ie. the data appears un-changed itself - the only omission is the table:table-row-group elements - of which there are exactly zero in the broken file vs. ~400 in the original file.There are several instances of:@@ -10545,8 +10603,7 @@ <table:table-cell table:style-name="Default" table:number-columns-repeated="6"/> <table:table-cell table:number-columns-repeated="1015"/> </table:table-row>- <table:table-row-group table:display="false">- <table:table-row table:style-name="ro1" table:visibility="collapse">+ <table:table-row table:style-name="ro1"> <table:table-cell table:style-name="Default"/> <table:table-cell office:value-type="string" calcext:value-type="string"> <text:p>z/(m)=</text:p>@@ -10557,7 +10614,7 @@ <table:table-cell table:style-name="Default" table:number-columns-repeated="6"/> <table:table-cell table:number-columns-repeated="1015"/> </table:table-row>- <table:table-row table:style-name="ro1" table:visibility="collapse">+ <table:table-row table:style-name="ro1"> <table:table-cell table:style-name="Default"/> <table:table-cell office:value-type="string" calcext:value-type="string"> <text:p>⇒z/(m)=</text:p>The broken document has zero instances of a collapsed table visibility in parallel with it's lack of table-row-group elements; and independent of them.(In reply to)Hi Michael,I have a script running daily that checks changed ods files for reduction in size; these files are then checked manually if grouping/notes are missing.So far, the problem has not reoccurred, which is forunate for us (reoccurrence is deadly for the confidence in libreffice of a group of users who still want to go back to MS Office), but not so fortunate for bug fixing ;)Currently, the department using the kind of ods file where the problems occurred use versions 3.5.7 (mainly) and some 3.6.5. Not yet 4.0 asblocks necessary functionality for us (haven't tested 4.0.3 yet though).Should we encounter grouping/notes loss, I will report asap, with version and if possible fods files before and after. (The original ods files cannot be provided to a public site because of client names.)Createdsample2 of document with outlining before breakageThere has been loss of outlining before in the document history. For what I recall, this one happened after I added some columns and messed up with some undo stuff.Createdsample2 of document with outlining after breakageThere has been loss of outlining before in the document history. For what I recall, this one happened after I added some columns and messed up with some undo stuff.koukasio - did that happen recently - and if so with what version of LibreOffice ?If it is before 3.6, and given that Winfried can't reproduce this in six weeks of work with more recent versions; I'm inclined to close this as 'worksforme' and hope we nailed it in newer versions (though where I don't know).I wonder - could it be related to cut/paste/undo of grouped columns/rows somehow ? :-)(In reply to)This happened just yesterday! I keep using this feature (even though the dissapointment is big at points) for debugging purposes, in case of an enlightenment... I am still having it in all multisheet files which become a little complex...There has been loss of outlining before in the attached document history. For what I recall, this one happened after I added some columns and messed up with some undo stuff.I am the "stable" guy who doesn't update distros or software easily. It seems more productive to me to stay focused in my work rather than hunting the "edge" of things...I will update to 4.0.2 for debugging purposes, but I will be working on the files i've started with 3.5.4.2 . Would that mean anything to you?I am very awkwardly suspicious about the "undo" thing. There's other things that I've noticed when "undo"ing , I wonder if I should report them as bugs. When I want to copy the exact contents of a cell without using absolute references (which I do a lot), I have 3 choices:1)(cellInsert→Ctrl+A→Ctrl+C→Esc→...→PasteMinor note: This last paste action cannot be undone?!..is never undone, I have to delete the paste manually if I have to... I have this action as a macro assigned to shortcut but it has the same behaviour as the manual one. The behaviour is right when I Ctrl+Shift+V(Paste_special)→Unformatted_Text...This action is only useful for copying contents of a single cell2)(cell1)...Ctrl+X→Ctrl+Z→(cell2)...Ctrl+VProblem: The reference (cell1) is cut and pasted to cell2 even though I have undone the cut action. That's the reason I don't use this action.3)(cell1)...Ctrl+X→(cell2)...→Paste→Ctrl+C→Ctrl+Z→Ctrl+Z→(cell2)...→Ctrl+VThis action works (for multiple cells), even though I've noticed at awkward points that the reference is cut and pasted as well but I can't reproduce it right now...This action is useful for copying contents of a single or multiple cells but cannot write as a macro...I begun writing this cut/paste/undo comment before you post your question..!Should I report any of these?I just had another incident with 4.0.2. Unfortunately I tried to reproduce it but failed. It happened while I was working on sample2. The steps that took place were Edit→Sheet→Select→Ctrl+a(all) and then I did insert columns, merge cells, undo stuff. I was checking the outlining. At some point I pointed with the mouse at the "+" sign of the outlining but was not pressable. I switched sheets back and forth and outlining was lost on several sheets but not all.Maybe things have changed but I found a very minimal test caseVersion 4.0.3.3 (Build ID: 400m0(Build:3)) from DebianOpen new instance of localcNew sheethighlight column DPress F12 -> grouping appearsSave as /tmp/grptst2.xlsxclose sheetopen sheetNo grouping visibleFor background I hit this bug on sheets generated byThat creates sheets which *do* have grouping and which is preserved in rows, but not columns afaict(In reply to)Well, this may help find the cause, which would be very nice.I confirm the behaviour of the minimal test case with openSUSE version 3.6 and with master (on openSUSE 12.3).The way to reproduce the problem may be different, but at least it is reproduceable.(In reply to)I confirm the behaviour with 4.0.2.2 on Kubuntu 12.04(In reply to)I forgot to mention:I confirm the behaviour of the minimal test case with version 4.0.3 on Windows.Now we can only hope that this _is_ related to the bug and not a separate anomaly ;)Hi David; I rather suspect that your test case just highlights the lack of grouping support in the XLSX export - which is a different bug.Some random code pointers: SID_OUTLINE_MAKE applies outline grouping - (not to be confused with any SID_*GROUP foo).It looks like that all ends up in sc/source/ui/docshell/olinefun.cxx - MakeOutline and RemoveOutline; hmm ...We just found out another case of grouping loss on one sheet of an ods document.Last change was made on a Windows 7 machine with version 3.5.7 (machine was downgraded to avoid this problem as we suspected the problem started with version 3.6 - which assumption was clearly wrong).This time the notes were not lost, only the grouping of one sheet (other sheets in the document were still with grouping and notes).The document is available in version with grouping and without (i.e. before and after the occurrance of the problem). Given the content I cannot make them attachments of this public bug, but I can send them directly to the developer working on this bug. I can however upload fods files with the client information removed, allthough I fear that both files will be valid and the difference will be that one file has grouping setting for n sheets and the other has grouping settings for n-1 sheets (the settings are simply not there, they don't seem corrupted).@Winfrieddo you still reproduce this bug with recent 4.0.4 or 4.1.0 releases?(In reply to)AFAIK we haven't encountered this bug with version 4.0 (4.1 isn't ready for company use yet).The bug occurs very rarely, but -given the data loss- it is a bad one.My guess is that it is connected to certain (long existing) files. With two files it has occurred multiple times, with hundreds of other files is has never occurred (and these files all have the same base file from which they originate, first an xls-file, now an ods file).so are you saying that it has never reoccurred yet in 4.0.x or that it still happens rarely? or that it happened rarely in 3.6.x...(In reply to)The bug hasn't occurred with version 3.5.5 or earlier (we think), it seemed to start with 3.6, but we know of at least one instance when the bug occurred with version 3.5.7.We upgraded from 3.5.7 to 4.0.4 and so far, I have not received reports of the bug.(BTW we are currently moving the data from these calc-documents to our ERP-platform, which means that we are likely to experience the bug even less, as these calc-documents become read-only once the data is moved. I will so be of limited 'use' with respect to this bug.)Ok Winfried.I'm gonna set status as WORKSFORME since you said it's not happening anymore in 4.0.x even if we don't know what fixed it.feel free to REOPEN this report if you will reproduce it again in 4.0.x or 4.1.x(In reply to)I have confirmed that the bug exists with 4.0.X with newly created files(not old ones)... I have been updating to the latest releases of libreoffice to help debugging. The problem is not fixed. I am still trying to figure out what is happeningI don't want to change any status bymyself but I think that it is wrong to state as resolved. I will keep trying to help@koukasiook. I reopen the bug and move it to the mab4.0 list.it would be very important to obtain a test case and instruction to reproduce.I want to start with an introductory paragraph, which contains the most important information of this comment according to my non-technical judgment:The bug occured repeatedly after changing cell formatting globally in the sheet. The cause for global change of cell formatting can be deletion of a user-defined format code, change of the default settings in "Styles and Formatting" in the "Format" menu or similar changes.And now the long version:The reported bug causes a siginificant annoyance in my work with LO Calc for more than a year. I had not reported the bug because I cannot reproduce it. Today I found this bug report accidentally and realised that other users encounter the same problem and that reproducing the bug is not easy for them either.I encounter the bug in a rather big and complicated spreadsheet, which I had started setting up with MS Excel 2007. To migrate from MS Excel to LO Calc I had converted the sheet by saving it as XLS with MS Excel, loading it with LO Calc and then saving it as ODS with LO Calc. Since then I kept developing the spreadsheet considerably, and the bug occurs from time to time.The spreadsheet contains 18 worksheets, the cells contain several thousand links to other cells, and the spreadsheet size is 2 MB in ODS file format. I cannot share the file for confidentiality reasons.The bug occured with LO 3.5 and LO 3.6. I remember to have encountered the bug with LO 3.4 as well, but I am not absolutely sure about the occurrence in LO 3.4. I have not switched to LO 4.0 yet, because the bug had occured in my spreadsheet after version changes (i.e. when opening the sheet with the new version), so that I am very conservative with updating LO program versions. Besides, LO 4.0 contains another unrelated bug in LO Impress, which is significant for my work and which does not occur with LO 3.6. Currently I work with LO 3.6.7.2 under Windows 7 with 32-bit architecture (x86).If the bug occurs, I lose the groupings of columns and rows on all worksheets. However, I am not absolutely sure, if the bug might have occured by affecting only some worksheets in the spreadsheet. I think that the bug was not related to saving or opening the spreadsheet. Again I am not sure about it. I lost the comments in cells of the worksheet as well. Therefore, I gave up using comments. I can work on the spreadsheet without using comments, but I do not get along without grouping columns and rows. Therefore, my experience with the bug concentrates on loss of grouping columns and rows.Since I had found out that the bug occured mainly when changing cell formats globally (see introductury remark of this comment), I could minimise its frequency of occurrence. Nevertheless, the bug can still occur unexpectedly.There is a high probability that the bug occurs in my spreadsheet if I do a series of global cell format manipulations. I tried to reproduce it with a simple spreadsheet, which I had converted from XLS or XLSX to ODS. I was not able to produce the bug with a simple spreadsheet.I am not a developer. I assume that a comment like this one is technically of limited use. Nevertheless, I want to share my experience with this bug. Maybe my description helps though it is not extremely precise. Moreover, it documents that there are more users out there, who struggle considerably with the effects of this bug.A big thank you to everyone who has tried and will try to hunt down this bug considering its complexity and the difficulty to reproduce it with a simple spreadsheet.Createdreproduction_sampleHALLELUJAH!!!!!!!!I have managed to reproduce the bug!!!!Let's get serious...I am attaching the fileThe steps to follow are:go to sheet named '1'select row 15Insert→Rowsselect row 16cutpaste to row 15undoVoilà!!Go to sheet named '2'... grouping/outlining is lost!!I hope this is useful, this thing has been such a pain for so long!!I started building the document yesterday on lo 4.1.0.4 on Ubuntu 12.04 , 08/16/2013, 15:41:44 .I started it from scratch , no M$ windows, office etc.The template I am using was started a year before on something like lo3.5. Would you like me to attach my template as well?(In reply to)I confirm the getting lost of the grouping in sheet 2, using version 4.0.4.2 on Windows 7 and using version 4.2.0.0.alpha0+ on openSUSE 12.3Unfortunately, I am not familiar with in this part of the calc code, so I can't try to fix it.I add Kohei Yoshida to CC list. maybe he can help.(In reply to)I can reproduce the loosing of grouping in other calc documents as well:-select sheet before sheet with grouping-select row n-paste somewhere-undo : the grouping in th enext sheet is lostI have not tried other combinations, the steps inand above should be a sufficient starting point for a developer.koukasio - brilliant :-) thanks so much for the reproduction steps; it's fantastic to finally have a good way to reproduce this.(In reply to)It is the lo-people to thank, I am just a humble user :-) I hope I am being helpful...(In reply to)Instead of rows, columns can also be used to reproduce the loosing of grouping in the next tab sheet. I have not been able yet to loose the comments with these steps.I did a bit of work on this; the undo object is ScUndoPaste:ScUndoPaste::DoChange (this=0xae48eb8, bUndo=true) at /data/opt/libreoffice/master/sc/source/ui/undo/undoblk.cxx:896Seems to do some rather odd things - it appears eg. to touch other sheets than the current one (on which the operation is done) - no idea why:937 for (size_t i = 0, n = maBlockRanges.size(); i < n; ++i)938 {939 ScRange aCopyRange = *maBlockRanges[i];940 aCopyRange.aStart.SetTab(0);941 aCopyRange.aEnd.SetTab(nTabCount-1);942 pDoc->CopyToDocument( aCopyRange, nUndoFlags, false, pRedoDoc );943 bRedoFilled = true;Which of course only fills the redo data - but appears to copy every sheet rather than the current one [ perhaps that has something to do with it ] - still thinking ;-)(In reply to)I lose the the comments as well if I use koukasio's sheet fromand follow the described steps. After opening koukasio's sheet, the cursor is on sheet "2" in cell A12. I insert a comment in this cell. It is lost after following the steps in.I use Windows 7 with 32-bit architecture (x86).I assumed inthat the loss of grouping can be related with global changes of cell formatting. I could not verify this suspicion with koukasio's sheet. My assumption ofseems to be wrong.(In reply to)Forgot to mention: LO 3.6.7.2(In reply to)@Michael: when you've thought it out ;-) , but haven't got the time to code and test, I am willing to help fixing this. It is a very annoying bug at our company. Having said that, I won't be able to do any coding in the first half of September.Not that it's news but this:void ScUndoPaste::DoChange(bool bUndo)... for (size_t i = 0, n = maBlockRanges.size(); i < n; ++i) { ScRange aRange = *maBlockRanges[i]; ScMarkData::iterator itr = aMarkData.begin(), itrEnd = aMarkData.end(); for (; itr != itrEnd && *itr < nTabCount; ++itr) { aRange.aStart.SetTab(*itr); aRange.aEnd.SetTab(*itr);** pUndoDoc->UndoToDocument(aRange, nUndoFlags, false, pDoc); } }line - when uncommented avoids the issue occuring; I guess that's the core of Undoing pastes though ;-)Interestingly though, the *itr is 4 for this - and the inner loop only occurs once; 4 seems a plausible value for nTab called '1' which I'm editing; which looks correct.void ScDocument::UndoToDocument(const ScRange& rRange,...... if (nTab2 < static_cast<SCTAB>(maTabs.size())) CopyToDocument( 0,0,nTab2+1, MAXCOL,MAXROW,maTabs.size(), IDF_FORMULA, false, pDestDoc, pMarks );Appears to do a giant copy to undo a paste - of all the formulae in the document - which seems a tad steep. Either way - disabling that un-breaks the groups too.void ScTable::CopyToTable(... pDestTab->SetOutlineTable( pOutlineTable ); // auch nur wenn bColRowFlagsDisabling this line stops us loosing the grouping; so - I guess that pOutlineTable is NULL in the undo information - which is interesting - but why only for this one sheet ? why don't we loos more :-)The hunt continues ...(In reply to)Please keep hunting ;)BTW, we did have a loss of grouping and of grouping_and_comments (all cell comments on a sheet). I can't tell if we experienced loss in more than one sheet at a time, especially as we didn't know what caused the loss and loss in more sheets could have been caused by more than one undo action.Another interesting data-point is that this is exclusive to cut/paste, copy/paste doesn't suffer from the same issue; so back up to:bool ScViewFunc::PasteFromClip( sal_uInt16 nFlags, ScDocument* pClipDoc,The more I read this the more I marvel at what is going on - it looks rather fragile. It appears that the code wants to preserve formulae on ~all sheets so we can undo the effects of cut/paste.Unfortunately, the CopyToDocument method has two modes of operation: one where every tab is present (when it really copies the range you pass), and another when tabs are not present (when it only copies to existing tabs).First we try to CopyToDocument with a limited set of (the selected) tabs - to just copy that data for undo; so we only copy the outline data for sheets that are active. // all sheets - CopyToDocument skips those that don't exist in pUndoDoc SCTAB nTabCount = pDoc->GetTableCount();+ if ( bCutMode )+ {+ // fdo#39484 - needs to be done before the CopyToDocument to preserve+ // outline & other data on sheets that we're not viewing.+ pUndoDoc->AddUndoTab( 0, nTabCount-1 );+ }fixes that; but of course it then starts to copy far too much.Then unfortunately, we do another copy into the pUndoDoc here: pRefUndoDoc->CopyToDocument( 0,0,0, MAXCOL,MAXROW,nTabCount-1, IDF_FORMULA, false, pUndoDoc );Which is presumably intended to preserve formulae, however this was again not constructed for all tabs, so it now overwrites the outline data with NULL dummy data.So ... it seems that the basic problem here is a mis-understanding of how CopyToDocument interacts with outlining. We pass the IDF_FORMULA flag, but the code then operates on far more than just formulae.Having fiddled a fair bit here; I think the best sol'n is to add an IDF_OUTLINE - or IDF_NOOUTLINE bit to add in there, to allow the IDF_FORMULA mask to only mutate formulae. Or worse - add some IDF_FORMULAONLY - which would suck ;-) I'll try to come up with something pleasant.I just pushed a prototype fix; quite possibly it severely harms the rest of calc [ I hope not, but you never know ], and I'm no calc engineer. Looking forward to some testing of copy / paste / move etc. with outlines around - AFAIK there are no unit tests for this lot (anyone wanting to write them would be more than welcome). Things to look out for when testing:the code involved tries to restore formulae to the state they were in before the cut/paste - so worth checking some cases of this to make sure they are. Anyhow - I hope it will be in some master builds to play with in due course, and at some stage we can back-port it :-)Thanks so much for the reproducible test-case; it looks like this issue has been there for years.Michael Meeks committed a patch related to this issue.It has been pushed to "master":fdo#39484 - don't loose outlines while trying to undo formulae changes.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Eike seemed happy with it so it's:for -4-1. If that doesn't cause any concern after a release, we could back-port it to 4-0 I imagine in a month or so.Closing for now; do ping in a month if you're desperate for a -4-0 backport.(In reply to)Thanks a lot for your fast -and informative- digging and fixing!I will test with master if I can reproduce the problem with the comments getting lost (I hope I can't).Michael Meeks committed a patch related to this issue.It has been pushed to "libreoffice-4-1":fdo#39484 - don't loose outlines while trying to undo formulae changes.It will be available in LibreOffice 4.1.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.According to my user checks things work fine including comments.Thank you very much to all contributors for having removed this nasty bug! The bug used to be a real annoyance in my work with LO Calc. I am impressed about the process how it could be reproduced and removed.Michael Meeks committed a patch related to this issue.It has been pushed to "libreoffice-4-0":fdo#39484 - don't loose outlines while trying to undo formulae changes.It will be available in LibreOffice 4.0.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.I think I have found a workaround for those who use an affected version of lo. If you want to copy exactly one cell/row/column [→element]copy elementpaste specialShift down/rightcut new element (leaves blank element)pastedelete blank element (Ctrl+delete)This way you don't use the undo command. It seems to be working fine but I have not tested this thoroughly. I hope it helpsMarkus Mohrhard committed a patch related to this issue.It has been pushed to "master":compare against IDF_HARDATTR, fdo#39484The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=40006	Createdods password protected in 342create spreadsheet in 3.4.2save with passwordopen in build_from_masteredit and savetry to open again in 3.4.2 > Error X Error in reading Subdocument ... on position ..try to open again in build_from_master > OKVersion info:LibreOffice 3.5.0 Build ID: 0410bba-4eb4f62-260b7c1Attached the document I created new (not my original password protected file)password: password same problem when you try to open a password protected file from 35Master in 3.4.2I have noticed this already but I was unable to reproduce it when I worked on the password code two weeks ago.I have some open work left in the password code and i will look at it when I do this. Might be that we don't use the correct algorithm at the moment.Did you try if you can open a LibreOffice 3.3 file in 3.4 or master?hi Markus,didn't notice any problems previous, so 3.3.x > 3.4.x must be OK.Just tested: password protected from 3.3.3 opens fine in MasterBuildLooking at the errors I get: it are all errors complaining about one or another xml file ...HTH - Corerror in console when starting 3.3 from command line and trying to open file again:librdf error URI file:///home/cono/tstPasswordFrom33ToMaster.odt/ - XML parser error: Document is emptyHello Cor,can you reproduce this every time? I had a look at the generated manifest.xml and there are no password information saved. This file is totally invalid can neither be opened in 3.4 nor in 3.5.I had a quick look at a newly generated manifest.xml and we have a missing line in a 3-4 document://Version master<manifest:file-entry manifest:media-type="text/xml" manifest:full-path="settings.xml" manifest:size="7226"> <manifest:encryption-data manifest:checksum-type="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0#sha256-1k" manifest:checksum="5+tFidD/SNAtXf1fHsBcoXSEghaK6y9gb9KbdeyD4kM="> <manifest:algorithm manifest:algorithm-name="" manifest:initialisation-vector="VelJ1kajLXUIeoDIkSG2Ow=="/> <manifest:key-derivation manifest:key-derivation-name="PBKDF2" manifest:key-size="32" manifest:iteration-count="1024" manifest:salt="Vrp3nZICerDtWfXs2fqVag=="/> <manifest:start-key-generation manifest:start-key-generation-name="" manifest:key-size="32"/> </manifest:encryption-data></manifest:file-entry>//Version 3.4<manifest:file-entry manifest:media-type="text/xml" manifest:full-path="settings.xml" manifest:size="7226"> <manifest:encryption-data manifest:checksum-type="SHA1/1K" manifest:checksum="ba3iogtlREVABXDLTrQ5d0DJIDk="> <manifest:algorithm manifest:algorithm-name="Blowfish CFB" manifest:initialisation-vector="CcoafZ9v4Rk="/> <manifest:key-derivation manifest:key-derivation-name="PBKDF2" manifest:iteration-count="1024" manifest:salt="4i1aKukpZWu2BhCTwar2Jw=="/> </manifest:encryption-data></manifest:file-entry>//version 3.3<manifest:file-entry manifest:media-type="text/xml" manifest:full-path="styles.xml" manifest:size="6933"> <manifest:encryption-data manifest:checksum-type="SHA1/1K" manifest:checksum="i9UUUMTixqCE5k1mVYGt0hIG/Aw="> <manifest:algorithm manifest:algorithm-name="Blowfish CFB" manifest:initialisation-vector="YPXtGlqCoCk="/> <manifest:key-derivation manifest:key-derivation-name="PBKDF2" manifest:key-size="16" manifest:iteration-count="1024" manifest:salt="YK1YYEXehMzE3s42UVSfqA=="/> <manifest:start-key-generation manifest:start-key-generation-name="SHA1" manifest:key-size="20"/> </manifest:encryption-data></manifest:file-entry>I think that only the master version is a valid odf 1.2 document.When I password protect a file in 3.4.2, I can open it in 35MasterWhen I password protect a file in 35Master I can not open it in 3.4.2,Tested again. Same pattern. (And with my initial report, I didn't notice irregulaties too ...)Typical error message: " Read error Format error discoverenr in subdocument styles.xml on position 1,n (row, column) "(But I've seen another xml-file seen mentioned too)I have no opinion on what manifest xml is the correct one.If it would help to start with gdb or ?? pls, give me a hint (or some more if needed), then I'll do my best.Can't you reproduce the error on your system?This was a deliberate (I believe) change, seeto get an encrypted documented out of master which can be opened in <= 3.4, one needs to toggle ODF 1.1 on instead of ODF 1.2 Extended in tools->optionsIndeed, chosing ODF 1.0/1.1 as save format, makes it possible to open a encrypted doc from 35 Master in 342we did this IIRC, i.e. backport support for reading these encryptions to the 3.4.X seriesRight, reading AES-encrypted ODF 1.2 documents (as genereated by LibO 3.5) has been backported to LO-3-4 towards LO 3.4.5 as <> etc.
id=39799	CreatedLibreOffice 3.4.2 release crashes with this SVG fileFollow these steps to reproduce the error in LibreOffice 3.4.2 release:(1) Launch LibreOffice 3.4.2 release on OSX(2) Select New Text Document(3) Select Insert, Picture, From File...(4) Select desired SVG file (see attached file) then click Open(5) LibreOffice 3.4.2 release crashesIn an attempt to Insert a Picture into "LibreOffice 3.4.2 release" we selected an "svg" image and LibreOffice crashed. OSX generated the following partial crash report:Process: soffice [811]Path: /Applications/LibreOffice 3.4.2.app/Contents/MacOS/sofficeIdentifier: org.libreoffice.scriptVersion: 3.4.2 (???)Code Type: X86 (Native)Parent Process: launchd [128]Date/Time: 2011-08-03 05:06:47.504 -0700OS Version: Mac OS X 10.6.8 (10K549)Report Version: 6Interval Since Last Report: 98760 secCrashes Since Last Report: 1Per-App Interval Since Last Report: 66 secPer-App Crashes Since Last Report: 1Exception Type: EXC_BAD_ACCESS (SIGBUS)Exception Codes: KERN_PROTECTION_FAILURE at 0x000000002ce742e4Crashed Thread: 0 Dispatch queue: com.apple.main-threadThread 0 Crashed: Dispatch queue: com.apple.main-thread0 libsvgfiltermxi.dylib 0x2ce1db89 0x2ce10000 + 562011 libsvgfiltermxi.dylib 0x2ce15d05 0x2ce10000 + 238132 libsvgfiltermxi.dylib 0x2ce4433d component_getFactory + 850533 libsvgfiltermxi.dylib 0x2ce44839 component_getFactory + 863294 libsvgfiltermxi.dylib 0x2ce4543c component_getFactory + 894045 libsvgfiltermxi.dylib 0x2ce6647d component_getFactory + 2246376 libsvgfiltermxi.dylib 0x2ce683f2 component_getFactory + 2326907 libsvgfiltermxi.dylib 0x2ce68247 component_getFactory + 2322638 libsvgfiltermxi.dylib 0x2ce68247 component_getFactory + 2322639 libsvgfiltermxi.dylib 0x2ce68247 component_getFactory + 23226310 libsvgfiltermxi.dylib 0x2ce68247 component_getFactory + 23226311 libsvgfiltermxi.dylib 0x2ce68247 component_getFactory + 23226312 libsvgfiltermxi.dylib 0x2ce35e3c component_getFactory + 2642813 libsvgfiltermxi.dylib 0x2ce2f6b8 GraphicImport + 2414 libsvtmxi.dylib 0x00b943e1 GraphicFilter::ImportGraphic(Graphic&, String const&, SvStream&, unsigned short, unsigned short*, unsigned long, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue>*) + 257715 libsvtmxi.dylib 0x00b95274 GraphicFilter::ImportGraphic(Graphic&, String const&, SvStream&, unsigned short, unsigned short*, unsigned long) + 6816 libsvtmxi.dylib 0x00b9535a GraphicFilter::ImportGraphic(Graphic&, INetURLObject const&, unsigned short, unsigned short*, unsigned long) + 21817 libsvtmxi.dylib 0x00b955e3 GraphicFilter::LoadGraphic(String const&, String const&, Graphic&, GraphicFilter*, unsigned short*) + 56318 libswmxi.dylib 0x27ba2d22 SwView::InsertGraphic(String const&, String const&, unsigned char, GraphicFilter*, Graphic*, unsigned char) + 94619 libswmxi.dylib 0x27ba5fa0 SwView::InsertGraphicDlg(SfxRequest&) + 184020 libswmxi.dylib 0x27ba8f58 SwView::Execute(SfxRequest&) + 328821 libsfxmxi.dylib 0x0047fc62 SfxDispatcher::Call_Impl(SfxShell&, SfxSlot const&, SfxRequest&, unsigned char) + 53022 libsfxmxi.dylib 0x00480404 SfxDispatcher::PostMsgHandler(SfxRequest*) + 30823 libsfxmxi.dylib 0x006509d9 SfxHintPoster::LinkStubDoEvent_Impl(void*, void*) + 2524 libvclmxi.dylib 0x0195681f vcl::LazyDeletor<Window>::~LazyDeletor() + 2223925 libvclmxi.dylib 0x01a21ec3 SalGetDesktopEnvironment() + 104326 libvclmxi.dylib 0x01716180 Application::Yield(bool) + 9627 libvclmxi.dylib 0x01716281 Application::Execute() + 9728 libsofficeapp.dylib 0x0006a785 0x58000 + 7565329 libvclmxi.dylib 0x0171e268 DeInitVCL() + 362430 libvclmxi.dylib 0x01a2181b component_getFactory + 20954731 libvclmxi.dylib 0x01a26c4b SalGetDesktopEnvironment() + 2089132 com.apple.AppKit 0x98b47253 -[NSApplication run] + 91733 com.apple.AppKit 0x98b3f289 NSApplicationMain + 57434 libvclmxi.dylib 0x01a225a7 SalGetDesktopEnvironment() + 280735 libvclmxi.dylib 0x0171e311 SVMain() + 1736 libsofficeapp.dylib 0x00096f65 soffice_main + 24537 org.libreoffice.script 0x00001ebe main + 3038 org.libreoffice.script 0x00001822 start + 25839 org.libreoffice.script 0x00001749 start + 41 No problem with reporter's sample and "LibreOffice 3.4.2 - WIN7 Home Premium (64bit) German UI [OOO340m1 (Build:203)]". I can insert it to new WRITER document without problems.Not a blocker as long as it's not a general problem.MAC only?@Reporter:Not a problem with DRAW?@Thorsten:Please feel free to reassign if it’s not your area or if provided information is not sufficient. Please set Status to ASSIGNED if you accept this Bug.Unconfirmed with [Win2K LibreOffice 3.4.2 OOO340m1 (Build:203)].File imports without a problem.On 2011-08-03 08:31:19 PDT Rainer Bielefeld asked if LibreOffice 3.4.2 release crashes with the above SVG file using DRAW?ANSWER: YESFollow these steps to reproduce the error in LibreOffice 3.4.2 release with DRAW:(1) Launch LibreOffice 3.4.2 release on OSX(2) Select Drawing(3) Select Insert, Picture, From File...(4) Select desired SVG file (see attached file) then click Open(5) LibreOffice 3.4.2 release crashesIn an attempt to Insert a Picture into "LibreOffice 3.4.2 release" DRAW we selected an "svg" image and LibreOffice crashed. OSX generated the following NEW partial crash report:Process: soffice [1007]Path: /Applications/LibreOffice 3.4.2.app/Contents/MacOS/sofficeIdentifier: org.libreoffice.scriptVersion: 3.4.2 (???)Code Type: X86 (Native)Parent Process: launchd [128]Date/Time: 2011-08-04 06:50:51.151 -0700OS Version: Mac OS X 10.6.8 (10K549)Report Version: 6Interval Since Last Report: 9564 secCrashes Since Last Report: 1Per-App Interval Since Last Report: 1195 secPer-App Crashes Since Last Report: 1Exception Type: EXC_BAD_ACCESS (SIGBUS)Exception Codes: KERN_PROTECTION_FAILURE at 0x000000002d48f2e4Crashed Thread: 0 Dispatch queue: com.apple.main-threadThread 0 Crashed: Dispatch queue: com.apple.main-thread0 libsvgfiltermxi.dylib 0x2d438b89 0x2d42b000 + 562011 libsvgfiltermxi.dylib 0x2d430d05 0x2d42b000 + 238132 libsvgfiltermxi.dylib 0x2d45f33d component_getFactory + 850533 libsvgfiltermxi.dylib 0x2d45f839 component_getFactory + 863294 libsvgfiltermxi.dylib 0x2d46043c component_getFactory + 894045 libsvgfiltermxi.dylib 0x2d48147d component_getFactory + 2246376 libsvgfiltermxi.dylib 0x2d4833f2 component_getFactory + 2326907 libsvgfiltermxi.dylib 0x2d483247 component_getFactory + 2322638 libsvgfiltermxi.dylib 0x2d483247 component_getFactory + 2322639 libsvgfiltermxi.dylib 0x2d483247 component_getFactory + 23226310 libsvgfiltermxi.dylib 0x2d483247 component_getFactory + 23226311 libsvgfiltermxi.dylib 0x2d483247 component_getFactory + 23226312 libsvgfiltermxi.dylib 0x2d450e3c component_getFactory + 2642813 libsvgfiltermxi.dylib 0x2d44a6b8 GraphicImport + 2414 libsvtmxi.dylib 0x00b943e1 GraphicFilter::ImportGraphic(Graphic&, String const&, SvStream&, unsigned short, unsigned short*, unsigned long, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue>*) + 257715 libsvtmxi.dylib 0x00b95274 GraphicFilter::ImportGraphic(Graphic&, String const&, SvStream&, unsigned short, unsigned short*, unsigned long) + 6816 libsvtmxi.dylib 0x00b9535a GraphicFilter::ImportGraphic(Graphic&, INetURLObject const&, unsigned short, unsigned short*, unsigned long) + 21817 libsfxmxi.dylib 0x004bfd37 sfx2::FileDialogHelper_Impl::getGraphic(rtl::OUString const&, Graphic&) const + 69518 libsfxmxi.dylib 0x004bff89 sfx2::FileDialogHelper_Impl::getGraphic(Graphic&) const + 36119 libsdmxi.dylib 0x275d8a04 SdUndoGroup::~SdUndoGroup() + 4851620 libsdmxi.dylib 0x275d8953 SdUndoGroup::~SdUndoGroup() + 4833921 libsdmxi.dylib 0x27343058 sd::ViewShell::GetViewFrame() const + 16442422 libsdmxi.dylib 0x2732bec8 sd::ViewShell::GetViewFrame() const + 6981623 libsfxmxi.dylib 0x0047fc62 SfxDispatcher::Call_Impl(SfxShell&, SfxSlot const&, SfxRequest&, unsigned char) + 53024 libsfxmxi.dylib 0x00480404 SfxDispatcher::PostMsgHandler(SfxRequest*) + 30825 libsfxmxi.dylib 0x006509d9 SfxHintPoster::LinkStubDoEvent_Impl(void*, void*) + 2526 libvclmxi.dylib 0x0195681f vcl::LazyDeletor<Window>::~LazyDeletor() + 2223927 libvclmxi.dylib 0x01a21ec3 SalGetDesktopEnvironment() + 104328 libvclmxi.dylib 0x01716180 Application::Yield(bool) + 9629 libvclmxi.dylib 0x0171626c Application::Execute() + 7630 libsofficeapp.dylib 0x0006a785 0x58000 + 7565331 libvclmxi.dylib 0x0171e268 DeInitVCL() + 362432 libvclmxi.dylib 0x01a2181b component_getFactory + 20954733 libvclmxi.dylib 0x01a26c4b SalGetDesktopEnvironment() + 2089134 com.apple.AppKit 0x98b47253 -[NSApplication run] + 91735 com.apple.AppKit 0x98b3f289 NSApplicationMain + 57436 libvclmxi.dylib 0x01a225a7 SalGetDesktopEnvironment() + 280737 libvclmxi.dylib 0x0171e311 SVMain() + 1738 libsofficeapp.dylib 0x00096f65 soffice_main + 24539 org.libreoffice.script 0x00001ebe main + 3040 org.libreoffice.script 0x00001822 start + 25841 org.libreoffice.script 0x00001749 start + 41CONFIRMED due tois this issue just present in LibO 3.4.2 or can you reproduce it also in previous releases?On 2011-08-05 06:47:57 PDT Tommy27 asked if this issue is just present in LibO 3.4.2 or can you reproduce it also in previous releases?ANSWER: Please seeNOTE: We have tested LibreOffice 3.3.2 on both Mac OSX System 10.6.7 and Windows System 7. We have found that Scalable Vector Graphics in LibreOffice is inconsistent and incorrect on both operating systems. The attached compressed file is provided to show how the same Scalable Vector Graphics is inconsistent and incorrect in Writer and Draw. We were able to use SVG images in a previous release.I saw a similar problem wrongly reported in, might be DUP or related:<> (seehere)"- CRASH when insert particular SVG picture from file" might be DUP or at least related?It seems that there is some vulnerability, some .svg crash MAC, some others WIN, and may be some others Linux?@reporter, @tommy27, @xdmx:Can you please checkand leave your results there in a comment?Also no problem with WRITER - Master "LibO-dev 3.4.5 – WIN7 Home Premium (64bit) English UI [(Build ID:d337f79-a24c961-2865670-9752b71-7f8fd43 2fdd60d-fd28b6a-fd7bf20-aa369cb-28da3fb 6a9633a-931d089-ecd263f-c9b55e9-b31b807 82ff335-599f7e9-bc6a545-1926fdf)]"I can see no crash or warning under valgrind with current Linux x86_64 3-4 (will be 3.4.3)I can confirm this happens with LibO 3.4.3 rc1 on Snow Leopard 10.6.8 - same issue if you drag from desktop into doc. Also tried another SVG (much smaller) from openclipart.org and produced the same results.Process: soffice [2107]Path: /Applications/LibreOffice.app/Contents/MacOS/sofficeIdentifier: org.libreoffice.scriptVersion: 3.4.3 (???)Code Type: X86 (Native)Parent Process: launchd [127]Date/Time: 2011-08-20 22:13:57.545 -0400OS Version: Mac OS X 10.6.8 (10K549)Report Version: 6Interval Since Last Report: 90506 secCrashes Since Last Report: 3Per-App Interval Since Last Report: 571 secPer-App Crashes Since Last Report: 3Anonymous UUID: BC553B34-4860-4953-8D6F-06E4206C6D53Exception Type: EXC_BAD_ACCESS (SIGBUS)Exception Codes: KERN_PROTECTION_FAILURE at 0x000000003d4742e4Crashed Thread: 0 Dispatch queue: com.apple.main-threadThread 0 Crashed: Dispatch queue: com.apple.main-thread0 libsvgfiltermxi.dylib 0x3d41db89 0x3d410000 + 562011 libsvgfiltermxi.dylib 0x3d415d05 0x3d410000 + 238132 libsvgfiltermxi.dylib 0x3d44433d component_getFactory + 850533 libsvgfiltermxi.dylib 0x3d444839 component_getFactory + 863294 libsvgfiltermxi.dylib 0x3d44543c component_getFactory + 894045 libsvgfiltermxi.dylib 0x3d46647d component_getFactory + 2246376 libsvgfiltermxi.dylib 0x3d4683f2 component_getFactory + 2326907 libsvgfiltermxi.dylib 0x3d468247 component_getFactory + 2322638 libsvgfiltermxi.dylib 0x3d468247 component_getFactory + 2322639 libsvgfiltermxi.dylib 0x3d468247 component_getFactory + 23226310 libsvgfiltermxi.dylib 0x3d468247 component_getFactory + 23226311 libsvgfiltermxi.dylib 0x3d468247 component_getFactory + 23226312 libsvgfiltermxi.dylib 0x3d435e3c component_getFactory + 2642813 libsvgfiltermxi.dylib 0x3d42f6b8 GraphicImport + 2414 libsvtmxi.dylib 0x00b963e1 GraphicFilter::ImportGraphic(Graphic&, String const&, SvStream&, unsigned short, unsigned short*, unsigned long, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue>*) + 257715 libsvtmxi.dylib 0x00b97274 GraphicFilter::ImportGraphic(Graphic&, String const&, SvStream&, unsigned short, unsigned short*, unsigned long) + 6816 libsvtmxi.dylib 0x00b9735a GraphicFilter::ImportGraphic(Graphic&, INetURLObject const&, unsigned short, unsigned short*, unsigned long) + 21817 libsvtmxi.dylib 0x00b975e3 GraphicFilter::LoadGraphic(String const&, String const&, Graphic&, GraphicFilter*, unsigned short*) + 56318 libswmxi.dylib 0x27b25bc2 SwView::InsertGraphic(String const&, String const&, unsigned char, GraphicFilter*, Graphic*, unsigned char) + 94619 libswmxi.dylib 0x27b28f20 SwView::InsertGraphicDlg(SfxRequest&) + 184020 libswmxi.dylib 0x27b2bed8 SwView::Execute(SfxRequest&) + 328821 libsfxmxi.dylib 0x00480a02 SfxDispatcher::Call_Impl(SfxShell&, SfxSlot const&, SfxRequest&, unsigned char) + 53022 libsfxmxi.dylib 0x004811a4 SfxDispatcher::PostMsgHandler(SfxRequest*) + 30823 libsfxmxi.dylib 0x006518f9 SfxHintPoster::LinkStubDoEvent_Impl(void*, void*) + 2524 libvclmxi.dylib 0x0195882f vcl::LazyDeletor<Window>::~LazyDeletor() + 2223925 libvclmxi.dylib 0x01a23ed3 SalGetDesktopEnvironment() + 104326 libvclmxi.dylib 0x01718190 Application::Yield(bool) + 9627 libvclmxi.dylib 0x0171827c Application::Execute() + 7628 libsofficeapp.dylib 0x0006a785 0x58000 + 7565329 libvclmxi.dylib 0x01720278 DeInitVCL() + 362430 libvclmxi.dylib 0x01a2382b component_getFactory + 20954731 libvclmxi.dylib 0x01a28c5b SalGetDesktopEnvironment() + 2089132 com.apple.AppKit 0x9981b253 -[NSApplication run] + 91733 com.apple.AppKit 0x99813289 NSApplicationMain + 57434 libvclmxi.dylib 0x01a245b7 SalGetDesktopEnvironment() + 280735 libvclmxi.dylib 0x01720321 SVMain() + 1736 libsofficeapp.dylib 0x00096f65 soffice_main + 24537 org.libreoffice.script 0x00001ebe main + 3038 org.libreoffice.script 0x00001822 start + 25839 org.libreoffice.script 0x00001749 start + 41Thread 1:0 libSystem.B.dylib 0x91d71b5a semaphore_timedwait_signal_trap + 101 libSystem.B.dylib 0x91d9f6e1 _pthread_cond_wait + 10662 libSystem.B.dylib 0x91de826c pthread_cond_timedwait + 473 libuno_sal.dylib.3 0x00035e38 rtl_cache_create + 7284 libSystem.B.dylib 0x91d9f259 _pthread_start + 3455 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 2: Dispatch queue: com.apple.libdispatch-manager0 libSystem.B.dylib 0x91d98382 kevent + 101 libSystem.B.dylib 0x91d98a9c _dispatch_mgr_invoke + 2152 libSystem.B.dylib 0x91d97f59 _dispatch_queue_invoke + 1633 libSystem.B.dylib 0x91d97cfe _dispatch_worker_thread2 + 2404 libSystem.B.dylib 0x91d97781 _pthread_wqthread + 3905 libSystem.B.dylib 0x91d975c6 start_wqthread + 30Thread 3:0 libSystem.B.dylib 0x91e39096 accept$NOCANCEL$UNIX2003 + 101 libSystem.B.dylib 0x91e37eff accept + 322 libuno_sal.dylib.3 0x00011d3a osl_acceptPipe + 583 libsofficeapp.dylib 0x00093aae 0x58000 + 2443984 libsofficeapp.dylib 0x00095ca2 0x58000 + 2530905 libuno_sal.dylib.3 0x0000c1b9 osl_setThreadName + 5696 libSystem.B.dylib 0x91d9f259 _pthread_start + 3457 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 4:0 libSystem.B.dylib 0x91d97412 __workq_kernreturn + 101 libSystem.B.dylib 0x91d979a8 _pthread_wqthread + 9412 libSystem.B.dylib 0x91d975c6 start_wqthread + 30Thread 5:0 libSystem.B.dylib 0x91d71afa mach_msg_trap + 101 libSystem.B.dylib 0x91d72267 mach_msg + 682 com.apple.CoreFoundation 0x9a69630f __CFRunLoopRun + 20793 com.apple.CoreFoundation 0x9a6953f4 CFRunLoopRunSpecific + 4524 com.apple.CoreFoundation 0x9a69b334 CFRunLoopRun + 845 com.apple.DesktopServices 0x928a0b3d TSystemNotificationTask::SystemNotificationTaskProc(void*) + 6436 ...ple.CoreServices.CarbonCore 0x9a35e54a PrivateMPEntryPoint + 687 libSystem.B.dylib 0x91d9f259 _pthread_start + 3458 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 6:0 libSystem.B.dylib 0x91d97412 __workq_kernreturn + 101 libSystem.B.dylib 0x91d979a8 _pthread_wqthread + 9412 libSystem.B.dylib 0x91d975c6 start_wqthread + 30Thread 7: com.apple.CFSocket.private0 libSystem.B.dylib 0x91d90ac6 select$DARWIN_EXTSN + 101 com.apple.CoreFoundation 0x9a6d5c83 __CFSocketManager + 10912 libSystem.B.dylib 0x91d9f259 _pthread_start + 3453 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 8:0 libSystem.B.dylib 0x91d97412 __workq_kernreturn + 101 libSystem.B.dylib 0x91d979a8 _pthread_wqthread + 9412 libSystem.B.dylib 0x91d975c6 start_wqthread + 30Thread 9:0 libSystem.B.dylib 0x91d9faa2 __semwait_signal + 101 libSystem.B.dylib 0x91dcb9c5 nanosleep$UNIX2003 + 1882 libSystem.B.dylib 0x91dcb903 usleep$UNIX2003 + 613 com.apple.AppKit 0x999c2e2d -[NSUIHeartBeat _heartBeatThread:] + 20394 com.apple.Foundation 0x903d7564 -[NSThread main] + 455 com.apple.Foundation 0x903d7514 __NSThread__main__ + 14996 libSystem.B.dylib 0x91d9f259 _pthread_start + 3457 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 10: Java: Exception Handler Thread0 libSystem.B.dylib 0x91d71afa mach_msg_trap + 101 libSystem.B.dylib 0x91d72267 mach_msg + 682 libSystem.B.dylib 0x91dddc78 mach_msg_server + 5203 libjvm.dylib 0x2b7100eb jio_snprintf + 438034 libjvm.dylib 0x2b70ff80 jio_snprintf + 434405 libjvm.dylib 0x2b70ed2d jio_snprintf + 387496 libSystem.B.dylib 0x91d9f259 _pthread_start + 3457 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 11: Java: Gang worker#0 (Parallel GC Threads)0 libSystem.B.dylib 0x91d71afa mach_msg_trap + 101 libSystem.B.dylib 0x91d72267 mach_msg + 682 libjvm.dylib 0x2b9824c9 JVM_RaiseSignal + 3653773 libjvm.dylib 0x2b70f0e6 jio_snprintf + 397024 libjvm.dylib 0x2b976681 JVM_RaiseSignal + 3166655 libjvm.dylib 0x2b976750 JVM_RaiseSignal + 3168726 libjvm.dylib 0x2b70ec5d jio_snprintf + 385417 libjvm.dylib 0x2b723cbe jio_vsnprintf + 3338 libjvm.dylib 0x2b70ed2d jio_snprintf + 387499 libSystem.B.dylib 0x91d9f259 _pthread_start + 34510 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 12: Java: Gang worker#1 (Parallel GC Threads)0 libSystem.B.dylib 0x91d71afa mach_msg_trap + 101 libSystem.B.dylib 0x91d72267 mach_msg + 682 libjvm.dylib 0x2b9824c9 JVM_RaiseSignal + 3653773 libjvm.dylib 0x2b70f0e6 jio_snprintf + 397024 libjvm.dylib 0x2b976681 JVM_RaiseSignal + 3166655 libjvm.dylib 0x2b976750 JVM_RaiseSignal + 3168726 libjvm.dylib 0x2b70ec5d jio_snprintf + 385417 libjvm.dylib 0x2b723cbe jio_vsnprintf + 3338 libjvm.dylib 0x2b70ed2d jio_snprintf + 387499 libSystem.B.dylib 0x91d9f259 _pthread_start + 34510 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 13: Java: Gang worker#2 (Parallel GC Threads)0 libSystem.B.dylib 0x91d71afa mach_msg_trap + 101 libSystem.B.dylib 0x91d72267 mach_msg + 682 libjvm.dylib 0x2b9824c9 JVM_RaiseSignal + 3653773 libjvm.dylib 0x2b70f0e6 jio_snprintf + 397024 libjvm.dylib 0x2b976681 JVM_RaiseSignal + 3166655 libjvm.dylib 0x2b976750 JVM_RaiseSignal + 3168726 libjvm.dylib 0x2b70ec5d jio_snprintf + 385417 libjvm.dylib 0x2b723cbe jio_vsnprintf + 3338 libjvm.dylib 0x2b70ed2d jio_snprintf + 387499 libSystem.B.dylib 0x91d9f259 _pthread_start + 34510 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 14: Java: Gang worker#3 (Parallel GC Threads)0 libSystem.B.dylib 0x91d71afa mach_msg_trap + 101 libSystem.B.dylib 0x91d72267 mach_msg + 682 libjvm.dylib 0x2b9824c9 JVM_RaiseSignal + 3653773 libjvm.dylib 0x2b70f0e6 jio_snprintf + 397024 libjvm.dylib 0x2b976681 JVM_RaiseSignal + 3166655 libjvm.dylib 0x2b976750 JVM_RaiseSignal + 3168726 libjvm.dylib 0x2b70ec5d jio_snprintf + 385417 libjvm.dylib 0x2b723cbe jio_vsnprintf + 3338 libjvm.dylib 0x2b70ed2d jio_snprintf + 387499 libSystem.B.dylib 0x91d9f259 _pthread_start + 34510 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 15: Java: Gang worker#4 (Parallel GC Threads)0 libSystem.B.dylib 0x91d71afa mach_msg_trap + 101 libSystem.B.dylib 0x91d72267 mach_msg + 682 libjvm.dylib 0x2b9824c9 JVM_RaiseSignal + 3653773 libjvm.dylib 0x2b70f0e6 jio_snprintf + 397024 libjvm.dylib 0x2b976681 JVM_RaiseSignal + 3166655 libjvm.dylib 0x2b976750 JVM_RaiseSignal + 3168726 libjvm.dylib 0x2b70ec5d jio_snprintf + 385417 libjvm.dylib 0x2b723cbe jio_vsnprintf + 3338 libjvm.dylib 0x2b70ed2d jio_snprintf + 387499 libSystem.B.dylib 0x91d9f259 _pthread_start + 34510 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 16: Java: Gang worker#5 (Parallel GC Threads)0 libSystem.B.dylib 0x91d71afa mach_msg_trap + 101 libSystem.B.dylib 0x91d72267 mach_msg + 682 libjvm.dylib 0x2b9824c9 JVM_RaiseSignal + 3653773 libjvm.dylib 0x2b70f0e6 jio_snprintf + 397024 libjvm.dylib 0x2b976681 JVM_RaiseSignal + 3166655 libjvm.dylib 0x2b976750 JVM_RaiseSignal + 3168726 libjvm.dylib 0x2b70ec5d jio_snprintf + 385417 libjvm.dylib 0x2b723cbe jio_vsnprintf + 3338 libjvm.dylib 0x2b70ed2d jio_snprintf + 387499 libSystem.B.dylib 0x91d9f259 _pthread_start + 34510 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 17: Java: Gang worker#6 (Parallel GC Threads)0 libSystem.B.dylib 0x91d71afa mach_msg_trap + 101 libSystem.B.dylib 0x91d72267 mach_msg + 682 libjvm.dylib 0x2b9824c9 JVM_RaiseSignal + 3653773 libjvm.dylib 0x2b70f0e6 jio_snprintf + 397024 libjvm.dylib 0x2b976681 JVM_RaiseSignal + 3166655 libjvm.dylib 0x2b976750 JVM_RaiseSignal + 3168726 libjvm.dylib 0x2b70ec5d jio_snprintf + 385417 libjvm.dylib 0x2b723cbe jio_vsnprintf + 3338 libjvm.dylib 0x2b70ed2d jio_snprintf + 387499 libSystem.B.dylib 0x91d9f259 _pthread_start + 34510 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 18: Java: Gang worker#7 (Parallel GC Threads)0 libSystem.B.dylib 0x91d71afa mach_msg_trap + 101 libSystem.B.dylib 0x91d72267 mach_msg + 682 libjvm.dylib 0x2b9824c9 JVM_RaiseSignal + 3653773 libjvm.dylib 0x2b70f0e6 jio_snprintf + 397024 libjvm.dylib 0x2b976681 JVM_RaiseSignal + 3166655 libjvm.dylib 0x2b976750 JVM_RaiseSignal + 3168726 libjvm.dylib 0x2b70ec5d jio_snprintf + 385417 libjvm.dylib 0x2b723cbe jio_vsnprintf + 3338 libjvm.dylib 0x2b70ed2d jio_snprintf + 387499 libSystem.B.dylib 0x91d9f259 _pthread_start + 34510 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 19: Java: Gang worker#0 (Parallel CMS Threads)0 libSystem.B.dylib 0x91d71afa mach_msg_trap + 101 libSystem.B.dylib 0x91d72267 mach_msg + 682 libjvm.dylib 0x2b9824c9 JVM_RaiseSignal + 3653773 libjvm.dylib 0x2b70f0e6 jio_snprintf + 397024 libjvm.dylib 0x2b976681 JVM_RaiseSignal + 3166655 libjvm.dylib 0x2b976750 JVM_RaiseSignal + 3168726 libjvm.dylib 0x2b70ec5d jio_snprintf + 385417 libjvm.dylib 0x2b9dda92 JVM_RaiseSignal + 7395948 libjvm.dylib 0x2b70ed2d jio_snprintf + 387499 libSystem.B.dylib 0x91d9f259 _pthread_start + 34510 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 20: Java: Gang worker#1 (Parallel CMS Threads)0 libSystem.B.dylib 0x91d71afa mach_msg_trap + 101 libSystem.B.dylib 0x91d72267 mach_msg + 682 libjvm.dylib 0x2b9824c9 JVM_RaiseSignal + 3653773 libjvm.dylib 0x2b70f0e6 jio_snprintf + 397024 libjvm.dylib 0x2b976681 JVM_RaiseSignal + 3166655 libjvm.dylib 0x2b976750 JVM_RaiseSignal + 3168726 libjvm.dylib 0x2b70ec5d jio_snprintf + 385417 libjvm.dylib 0x2b9dda92 JVM_RaiseSignal + 7395948 libjvm.dylib 0x2b70ed2d jio_snprintf + 387499 libSystem.B.dylib 0x91d9f259 _pthread_start + 34510 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 21: Java: Concurrent Mark-Sweep GC Thread0 libSystem.B.dylib 0x91d71afa mach_msg_trap + 101 libSystem.B.dylib 0x91d72267 mach_msg + 682 libjvm.dylib 0x2b982599 JVM_RaiseSignal + 3655853 libjvm.dylib 0x2b98293c JVM_RaiseSignal + 3665164 libjvm.dylib 0x2b97669b JVM_RaiseSignal + 3166915 libjvm.dylib 0x2b976750 JVM_RaiseSignal + 3168726 libjvm.dylib 0x2b70ec5d jio_snprintf + 385417 libjvm.dylib 0x2b7be0c9 JVM_Close + 132058 libjvm.dylib 0x2b7be031 JVM_Close + 130539 libjvm.dylib 0x2b729d73 jio_vsnprintf + 2509010 libjvm.dylib 0x2b70ed2d jio_snprintf + 3874911 libSystem.B.dylib 0x91d9f259 _pthread_start + 34512 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 22: Java: VM Thread0 libSystem.B.dylib 0x91d71afa mach_msg_trap + 101 libSystem.B.dylib 0x91d72267 mach_msg + 682 libjvm.dylib 0x2b982599 JVM_RaiseSignal + 3655853 libjvm.dylib 0x2b98293c JVM_RaiseSignal + 3665164 libjvm.dylib 0x2b97669b JVM_RaiseSignal + 3166915 libjvm.dylib 0x2b976750 JVM_RaiseSignal + 3168726 libjvm.dylib 0x2b70ec5d jio_snprintf + 385417 libjvm.dylib 0x2b790564 JVM_Lseek + 1493788 libjvm.dylib 0x2b790214 JVM_Lseek + 1485309 libjvm.dylib 0x2b70ed2d jio_snprintf + 3874910 libSystem.B.dylib 0x91d9f259 _pthread_start + 34511 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 23: Java: Reference Handler0 libSystem.B.dylib 0x91d71afa mach_msg_trap + 101 libSystem.B.dylib 0x91d72267 mach_msg + 682 libjvm.dylib 0x2b9824c9 JVM_RaiseSignal + 3653773 libjvm.dylib 0x2b70f0e6 jio_snprintf + 397024 libjvm.dylib 0x2b97e82c JVM_RaiseSignal + 3498605 libjvm.dylib 0x2b9bdb5f JVM_RaiseSignal + 6087276 libjvm.dylib 0x2b79d50a JVM_MonitorWait + 1967 libjvmlinkage.dylib 0x2b534e75 JVM_MonitorWait + 698 ??? 0x3100b9d9 0 + 8221311619 ??? 0x31003e31 0 + 82209950510 ??? 0x31003e31 0 + 82209950511 ??? 0x31001374 0 + 82208856412 libjvm.dylib 0x2b7917aa JVM_Lseek + 15405613 libjvm.dylib 0x2b791544 JVM_Lseek + 15344214 libjvm.dylib 0x2b79d341 JVM_StartThread + 272615 libjvm.dylib 0x2b79d246 JVM_StartThread + 247516 libjvm.dylib 0x2b79d1d4 JVM_StartThread + 236117 libjvm.dylib 0x2b79d048 JVM_StartThread + 196518 libjvm.dylib 0x2b79cea7 JVM_StartThread + 154819 libjvm.dylib 0x2b70ed2d jio_snprintf + 3874920 libSystem.B.dylib 0x91d9f259 _pthread_start + 34521 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 24: Java: Finalizer0 libSystem.B.dylib 0x91d71afa mach_msg_trap + 101 libSystem.B.dylib 0x91d72267 mach_msg + 682 libjvm.dylib 0x2b9824c9 JVM_RaiseSignal + 3653773 libjvm.dylib 0x2b70f0e6 jio_snprintf + 397024 libjvm.dylib 0x2b97e82c JVM_RaiseSignal + 3498605 libjvm.dylib 0x2b9bdb5f JVM_RaiseSignal + 6087276 libjvm.dylib 0x2b79d50a JVM_MonitorWait + 1967 libjvmlinkage.dylib 0x2b534e75 JVM_MonitorWait + 698 ??? 0x3100b9d9 0 + 8221311619 ??? 0x31003e31 0 + 82209950510 ??? 0x31003f97 0 + 82209986311 ??? 0x31003f97 0 + 82209986312 ??? 0x31001374 0 + 82208856413 libjvm.dylib 0x2b7917aa JVM_Lseek + 15405614 libjvm.dylib 0x2b791544 JVM_Lseek + 15344215 libjvm.dylib 0x2b79d341 JVM_StartThread + 272616 libjvm.dylib 0x2b79d246 JVM_StartThread + 247517 libjvm.dylib 0x2b79d1d4 JVM_StartThread + 236118 libjvm.dylib 0x2b79d048 JVM_StartThread + 196519 libjvm.dylib 0x2b79cea7 JVM_StartThread + 154820 libjvm.dylib 0x2b70ed2d jio_snprintf + 3874921 libSystem.B.dylib 0x91d9f259 _pthread_start + 34522 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 25: Java: Surrogate Locker Thread (Concurrent GC)0 libSystem.B.dylib 0x91d71afa mach_msg_trap + 101 libSystem.B.dylib 0x91d72267 mach_msg + 682 libjvm.dylib 0x2b9824c9 JVM_RaiseSignal + 3653773 libjvm.dylib 0x2b70f0e6 jio_snprintf + 397024 libjvm.dylib 0x2b976681 JVM_RaiseSignal + 3166655 libjvm.dylib 0x2b976750 JVM_RaiseSignal + 3168726 libjvm.dylib 0x2b70eba4 jio_snprintf + 383567 libjvm.dylib 0x2b7ad9d7 JVM_IsPrimitiveClass + 59918 libjvm.dylib 0x2b79d048 JVM_StartThread + 19659 libjvm.dylib 0x2b79cea7 JVM_StartThread + 154810 libjvm.dylib 0x2b70ed2d jio_snprintf + 3874911 libSystem.B.dylib 0x91d9f259 _pthread_start + 34512 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 26: Java: Signal Dispatcher0 libSystem.B.dylib 0x91d71b36 semaphore_wait_trap + 101 libjvm.dylib 0x2b7ae209 JVM_IsPrimitiveClass + 80892 libjvm.dylib 0x2b7adbf4 JVM_IsPrimitiveClass + 65323 libjvm.dylib 0x2b79d048 JVM_StartThread + 19654 libjvm.dylib 0x2b79cea7 JVM_StartThread + 15485 libjvm.dylib 0x2b70ed2d jio_snprintf + 387496 libSystem.B.dylib 0x91d9f259 _pthread_start + 3457 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 27: Java: C1 CompilerThread00 libSystem.B.dylib 0x91d71afa mach_msg_trap + 101 libSystem.B.dylib 0x91d72267 mach_msg + 682 libjvm.dylib 0x2b9824c9 JVM_RaiseSignal + 3653773 libjvm.dylib 0x2b70f0e6 jio_snprintf + 397024 libjvm.dylib 0x2b976681 JVM_RaiseSignal + 3166655 libjvm.dylib 0x2b976750 JVM_RaiseSignal + 3168726 libjvm.dylib 0x2b70eba4 jio_snprintf + 383567 libjvm.dylib 0x2b7b4d30 JVM_Write + 2888 libjvm.dylib 0x2b7af368 JVM_IsPrimitiveClass + 125369 libjvm.dylib 0x2b79d048 JVM_StartThread + 196510 libjvm.dylib 0x2b79cea7 JVM_StartThread + 154811 libjvm.dylib 0x2b70ed2d jio_snprintf + 3874912 libSystem.B.dylib 0x91d9f259 _pthread_start + 34513 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 28: Java: Low Memory Detector0 libSystem.B.dylib 0x91d71afa mach_msg_trap + 101 libSystem.B.dylib 0x91d72267 mach_msg + 682 libjvm.dylib 0x2b9824c9 JVM_RaiseSignal + 3653773 libjvm.dylib 0x2b70f0e6 jio_snprintf + 397024 libjvm.dylib 0x2b976681 JVM_RaiseSignal + 3166655 libjvm.dylib 0x2b976750 JVM_RaiseSignal + 3168726 libjvm.dylib 0x2b70ec5d jio_snprintf + 385417 libjvm.dylib 0x2b7b0cf6 JVM_IsPrimitiveClass + 190788 libjvm.dylib 0x2b79d048 JVM_StartThread + 19659 libjvm.dylib 0x2b79cea7 JVM_StartThread + 154810 libjvm.dylib 0x2b70ed2d jio_snprintf + 3874911 libSystem.B.dylib 0x91d9f259 _pthread_start + 34512 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 29: Java: VM Periodic Task Thread0 libSystem.B.dylib 0x91d71afa mach_msg_trap + 101 libSystem.B.dylib 0x91d72267 mach_msg + 682 libjvm.dylib 0x2b982599 JVM_RaiseSignal + 3655853 libjvm.dylib 0x2b98293c JVM_RaiseSignal + 3665164 libjvm.dylib 0x2b7b2eae JVM_IsPrimitiveClass + 277105 libjvm.dylib 0x2b70ed2d jio_snprintf + 387496 libSystem.B.dylib 0x91d9f259 _pthread_start + 3457 libSystem.B.dylib 0x91d9f0de thread_start + 34Thread 30:0 libSystem.B.dylib 0x91d71b5a semaphore_timedwait_signal_trap + 101 libSystem.B.dylib 0x91d9f6e1 _pthread_cond_wait + 10662 libSystem.B.dylib 0x91de826c pthread_cond_timedwait + 473 libuno_sal.dylib.3 0x000084e9 osl_waitCondition + 2814 configmgr.uno.dylib 0x17f24c5b 0x17f00000 + 1506195 configmgr.uno.dylib 0x17f28312 0x17f00000 + 1646266 libuno_sal.dylib.3 0x0000c1b9 osl_setThreadName + 5697 libSystem.B.dylib 0x91d9f259 _pthread_start + 3458 libSystem.B.dylib 0x91d9f0de thread_start + 34Still no crash, or anything visible under valgrind and x86_64 Linux in 3-4 series.If this really is affecting *only* macosx ? Perhaps there's a connection to the exact version of libxml2 on that platform ?anyone able to get a backtrace with symbols ?Caolán:I expected several problems to get such crashes reproducible, every LibO user needs his particular SVG to get the crash ;-)Can you please check "- CRASH when insert particular SVG picture from file"?No crash here with Debian Linux x86 32 bits on master branch (3.5), debug mode.Here are debug logs I get in console :Error: SfxModule::GetFieldUnit: no metric item in the module implemented by '8SwModule'! From File /.../libo/sfx2/source/appl/module.cxx at Line 399 14 timesHi all,Does not cause crash on Mac OSX when using Writer with following build from master :LibO-dev 3.5.0 Build ID: 6058133-1b94742-3dca5fd-7252360AlexI can also NOT confirm crash when I drag and drop the image onto a freshly opened Draw document with the same build from master.AlexI can confirming that it does crash 3.4.3 on Mac OSX.AlexTested against :LibreOffice 3.3.4 : no crash, but clouds appear behind moon.NeoOffice 3.2 patch 5 : no crash (but transparent objects not correctly rendered)NeoOffice 3.1.2 patch 8 : no crash, but objects mangled.Symphony 3 : refuses to load image in Impress (no Draw module)OOo-dev 3.4 : no crash, but clouds appear behind moon.AlexI can also confirm this crash (Insert picture from file svg into writer) on MAC OS X:LibreOffice 3.4.3 OOO340m1 (Build:302)Dump:Process: soffice [693]Path: /Applications/LibreOffice.app/Contents/MacOS/sofficeIdentifier: org.libreoffice.scriptVersion: 3.4.3 (???)Code Type: X86 (Native)Parent Process: launchd [338]Date/Time: 2011-10-18 23:40:09.595 +0200OS Version: Mac OS X 10.7.2 (11C74)Report Version: 9Interval Since Last Report: 94429 secCrashes Since Last Report: 8Per-App Interval Since Last Report: 27374 secPer-App Crashes Since Last Report: 8Crashed Thread: 0 Dispatch queue: com.apple.main-threadException Type: EXC_BAD_ACCESS (SIGBUS)Exception Codes: KERN_PROTECTION_FAILURE at 0x0000000023e062e4VM Regions Near 0x23e062e4: IOKit 0000000023b42000-0000000023da2000 [ 2432K] rw-/rw- SM=SHM --> __TEXT 0000000023da2000-0000000023e10000 [ 440K] r-x/rwx SM=COW /Applications/LibreOffice.app/Contents/basis-link/program/libsvgfiltermxi.dylib __DATA 0000000023e10000-0000000023e1c000 [ 48K] rw-/rwx SM=COW /Applications/LibreOffice.app/Contents/basis-link/program/libsvgfiltermxi.dylibApplication Specific Information:objc[693]: garbage collection is OFFThread 0 Crashed:: Dispatch queue: com.apple.main-thread0 libsvgfiltermxi.dylib 0x23dafb89 0x23da2000 + 562011 libsvgfiltermxi.dylib 0x23da7d05 0x23da2000 + 238132 libsvgfiltermxi.dylib 0x23dd633d component_getFactory + 850533 libsvgfiltermxi.dylib 0x23dd6839 component_getFactory + 863294 libsvgfiltermxi.dylib 0x23dd743c component_getFactory + 894045 libsvgfiltermxi.dylib 0x23df847d component_getFactory + 2246376 libsvgfiltermxi.dylib 0x23dfa3f2 component_getFactory + 2326907 libsvgfiltermxi.dylib 0x23dfa247 component_getFactory + 2322638 libsvgfiltermxi.dylib 0x23dfa247 component_getFactory + 2322639 libsvgfiltermxi.dylib 0x23dfa247 component_getFactory + 23226310 libsvgfiltermxi.dylib 0x23dfa247 component_getFactory + 23226311 libsvgfiltermxi.dylib 0x23dc7e3c component_getFactory + 2642812 libsvgfiltermxi.dylib 0x23dc16b8 GraphicImport + 2413 libsvtmxi.dylib 0x00b963e1 GraphicFilter::ImportGraphic(Graphic&, String const&, SvStream&, unsigned short, unsigned short*, unsigned long, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue>*) + 257714 libsvtmxi.dylib 0x00b97274 GraphicFilter::ImportGraphic(Graphic&, String const&, SvStream&, unsigned short, unsigned short*, unsigned long) + 6815 libsvtmxi.dylib 0x00b9735a GraphicFilter::ImportGraphic(Graphic&, INetURLObject const&, unsigned short, unsigned short*, unsigned long) + 21816 libsvtmxi.dylib 0x00b975e3 GraphicFilter::LoadGraphic(String const&, String const&, Graphic&, GraphicFilter*, unsigned short*) + 56317 libswmxi.dylib 0x21b91be2 SwView::InsertGraphic(String const&, String const&, unsigned char, GraphicFilter*, Graphic*, unsigned char) + 94618 libswmxi.dylib 0x21b94f40 SwView::InsertGraphicDlg(SfxRequest&) + 184019 libswmxi.dylib 0x21b97ef8 SwView::Execute(SfxRequest&) + 328820 libsfxmxi.dylib 0x00480a02 SfxDispatcher::Call_Impl(SfxShell&, SfxSlot const&, SfxRequest&, unsigned char) + 53021 libsfxmxi.dylib 0x004811a4 SfxDispatcher::PostMsgHandler(SfxRequest*) + 30822 libsfxmxi.dylib 0x006518f9 SfxHintPoster::LinkStubDoEvent_Impl(void*, void*) + 2523 libvclmxi.dylib 0x0195882f vcl::LazyDeletor<Window>::~LazyDeletor() + 2223924 libvclmxi.dylib 0x01a23ed3 SalGetDesktopEnvironment() + 104325 libvclmxi.dylib 0x01718190 Application::Yield(bool) + 9626 libvclmxi.dylib 0x01718291 Application::Execute() + 9727 libsofficeapp.dylib 0x0006a785 0x58000 + 7565328 libvclmxi.dylib 0x01720278 DeInitVCL() + 362429 libvclmxi.dylib 0x01a2382b component_getFactory + 20954730 libvclmxi.dylib 0x01a28c5b SalGetDesktopEnvironment() + 2089131 com.apple.AppKit 0x9a4cac82 -[NSApplication run] + 100732 com.apple.AppKit 0x9a75f18a NSApplicationMain + 105433 libvclmxi.dylib 0x01a245b7 SalGetDesktopEnvironment() + 280734 libvclmxi.dylib 0x01720321 SVMain() + 1735 libsofficeapp.dylib 0x00096f65 soffice_main + 24536 org.libreoffice.script 0x00001ebe main + 3037 org.libreoffice.script 0x00001822 start + 25838 org.libreoffice.script 0x00001749 start + 41Thread 1:0 libsystem_kernel.dylib 0x9b0ae83e __psynch_cvwait + 101 libsystem_c.dylib 0x90175e78 _pthread_cond_wait + 9142 libsystem_c.dylib 0x9011d7f5 pthread_cond_timedwait + 473 libuno_sal.dylib.3 0x00035e38 rtl_cache_create + 7284 libsystem_c.dylib 0x90171ed9 _pthread_start + 3355 libsystem_c.dylib 0x901756de thread_start + 34Thread 2:: Dispatch queue: com.apple.libdispatch-manager0 libsystem_kernel.dylib 0x9b0af90a kevent + 101 libdispatch.dylib 0x92eb2c58 _dispatch_mgr_invoke + 9692 libdispatch.dylib 0x92eb16a7 _dispatch_mgr_thread + 53Thread 3:0 libsystem_kernel.dylib 0x9b0ade2e __accept_nocancel + 101 libsystem_kernel.dylib 0x9b0ad30d accept + 392 libuno_sal.dylib.3 0x00011d3a osl_acceptPipe + 583 libsofficeapp.dylib 0x00093aae 0x58000 + 2443984 libsofficeapp.dylib 0x00095ca2 0x58000 + 2530905 libuno_sal.dylib.3 0x0000c1b9 osl_setThreadName + 5696 libsystem_c.dylib 0x90171ed9 _pthread_start + 3357 libsystem_c.dylib 0x901756de thread_start + 34Thread 4:0 libsystem_kernel.dylib 0x9b0af02e __workq_kernreturn + 101 libsystem_c.dylib 0x90173ccf _pthread_wqthread + 7732 libsystem_c.dylib 0x901756fe start_wqthread + 30Thread 5:0 libsystem_kernel.dylib 0x9b0af02e __workq_kernreturn + 101 libsystem_c.dylib 0x90173ccf _pthread_wqthread + 7732 libsystem_c.dylib 0x901756fe start_wqthread + 30Thread 6:: com.apple.CFSocket.private0 libsystem_kernel.dylib 0x9b0aeb42 __select + 101 com.apple.CoreFoundation 0x949b1195 __CFSocketManager + 15572 libsystem_c.dylib 0x90171ed9 _pthread_start + 3353 libsystem_c.dylib 0x901756de thread_start + 34Thread 7:0 libsystem_kernel.dylib 0x9b0ae83e __psynch_cvwait + 101 libsystem_c.dylib 0x90175e78 _pthread_cond_wait + 9142 libsystem_c.dylib 0x90175f7b pthread_cond_timedwait_relative_np + 473 com.apple.FinderKit 0x9b1991f5 TConditionVariable::WaitWithTimeout(TMutex&, unsigned long long, bool&) + 1074 com.apple.FinderKit 0x9b1c5536 TThreadSafeQueue<TThumbnailExtractorThread::TThumbnailQueueData>::WaitForChange(unsigned long long) + 605 com.apple.FinderKit 0x9b1c4957 TThumbnailExtractorThread::Main() + 3336 com.apple.FinderKit 0x9b1994f2 TThread::MainGlue(void*) + 627 libsystem_c.dylib 0x90171ed9 _pthread_start + 3358 libsystem_c.dylib 0x901756de thread_start + 34Thread 8:0 libsystem_kernel.dylib 0x9b0af02e __workq_kernreturn + 101 libsystem_c.dylib 0x90173ccf _pthread_wqthread + 7732 libsystem_c.dylib 0x901756fe start_wqthread + 30Thread 9:0 libsystem_kernel.dylib 0x9b0af02e __workq_kernreturn + 101 libsystem_c.dylib 0x90173ccf _pthread_wqthread + 7732 libsystem_c.dylib 0x901756fe start_wqthread + 30Thread 10:: com.apple.appkit-heartbeat0 libsystem_kernel.dylib 0x9b0aebb2 __semwait_signal + 101 libsystem_c.dylib 0x901267b9 nanosleep$UNIX2003 + 1872 libsystem_c.dylib 0x90126558 usleep$UNIX2003 + 603 com.apple.AppKit 0x9a716be2 -[NSUIHeartBeat _heartBeatThread:] + 23994 com.apple.Foundation 0x945f2f7d -[NSThread main] + 455 com.apple.Foundation 0x945f2f2d __NSThread__main__ + 15826 libsystem_c.dylib 0x90171ed9 _pthread_start + 3357 libsystem_c.dylib 0x901756de thread_start + 34Thread 11:: WebCore: LocalStorage0 libsystem_kernel.dylib 0x9b0ae83e __psynch_cvwait + 101 libsystem_c.dylib 0x90175e21 _pthread_cond_wait + 8272 libsystem_c.dylib 0x9012642c pthread_cond_wait$UNIX2003 + 713 com.apple.JavaScriptCore 0x99f12021 WTF::ThreadCondition::timedWait(WTF::Mutex&, double) + 814 com.apple.WebCore 0x9921ad41 WTF::MessageQueue<WebCore::LocalStorageTask>::waitForMessage() + 1355 com.apple.WebCore 0x9921ac94 WebCore::LocalStorageThread::threadEntryPoint() + 746 com.apple.WebCore 0x9921abf1 WebCore::LocalStorageThread::threadEntryPointCallback(void*) + 177 libsystem_c.dylib 0x90171ed9 _pthread_start + 3358 libsystem_c.dylib 0x901756de thread_start + 34Thread 12:: com.apple.NSURLConnectionLoader0 libsystem_kernel.dylib 0x9b0acc22 mach_msg_trap + 101 libsystem_kernel.dylib 0x9b0ac1f6 mach_msg + 702 com.apple.CoreFoundation 0x9495a0ea __CFRunLoopServiceMachPort + 1703 com.apple.CoreFoundation 0x94963214 __CFRunLoopRun + 14284 com.apple.CoreFoundation 0x949628ec CFRunLoopRunSpecific + 3325 com.apple.CoreFoundation 0x94962798 CFRunLoopRunInMode + 1206 com.apple.Foundation 0x945ff21c +[NSURLConnection(NSURLConnectionReallyInternal) _resourceLoadLoop:] + 3787 com.apple.Foundation 0x945f2f7d -[NSThread main] + 458 com.apple.Foundation 0x945f2f2d __NSThread__main__ + 15829 libsystem_c.dylib 0x90171ed9 _pthread_start + 33510 libsystem_c.dylib 0x901756de thread_start + 34Thread 13:: CVDisplayLink0 libsystem_kernel.dylib 0x9b0ae83e __psynch_cvwait + 101 libsystem_c.dylib 0x90175e21 _pthread_cond_wait + 8272 libsystem_c.dylib 0x9012642c pthread_cond_wait$UNIX2003 + 713 com.apple.CoreVideo 0x98fe5529 CVDisplayLink::runIOThread() + 9454 com.apple.CoreVideo 0x98fe5161 _ZL13startIOThreadPv + 1605 libsystem_c.dylib 0x90171ed9 _pthread_start + 3356 libsystem_c.dylib 0x901756de thread_start + 34Thread 14:0 libsystem_kernel.dylib 0x9b0ae83e __psynch_cvwait + 101 libsystem_c.dylib 0x90175e78 _pthread_cond_wait + 9142 libsystem_c.dylib 0x9011d7f5 pthread_cond_timedwait + 473 libuno_sal.dylib.3 0x000084e9 osl_waitCondition + 2814 configmgr.uno.dylib 0x07d69c5b 0x7d45000 + 1506195 configmgr.uno.dylib 0x07d6d312 0x7d45000 + 1646266 libuno_sal.dylib.3 0x0000c1b9 osl_setThreadName + 5697 libsystem_c.dylib 0x90171ed9 _pthread_start + 3358 libsystem_c.dylib 0x901756de thread_start + 34Thread 0 crashed with X86 Thread State (32-bit): eax: 0x23e062e0 ebx: 0x23da720a ecx: 0xbfffbd08 edx: 0x1c34facf edi: 0xffffffff esi: 0xbfffbdac ebp: 0xbfffb788 esp: 0xbfffb6d0 ss: 0x00000023 efl: 0x00010206 eip: 0x23dafb89 cs: 0x0000001b ds: 0x00000023 es: 0x00000023 fs: 0x00000000 gs: 0x0000000f cr2: 0x23e062e4Logical CPU: 0VM Region Summary:ReadOnly portion of Libraries: Total=299.1M resident=204.9M(69%) swapped_out_or_unallocated=94.2M(31%)Writable regions: Total=167.5M written=30.6M(18%) resident=62.9M(38%) swapped_out=0K(0%) unallocated=104.6M(62%) REGION TYPE VIRTUAL=========== =======ATS (font support) 32.8MCG backing stores 17.3MCG image 172KCG raster data 9772KCG shared images 3448KCoreAnimation 176KCoreGraphics 8KCoreImage 4KCoreServices 1840KIOKit 4444KMALLOC 57.2MMALLOC guard page 48KMemory tag=240 4KMemory tag=242 12KMemory tag=250 64KOpenCL 40KOpenGL GLSL 1116KOpenGL GLSL (reserved) 128K reserved VM address space (unallocated)SQLite page cache 384KStack 70.7MVM_ALLOCATE 27.7M__CI_BITMAP 80K__DATA 17.8M__DATA/__OBJC 328K__IMAGE 1256K__IMPORT 540K__LINKEDIT 69.0M__OBJC 3032K__OBJC/__DATA 40K__PAGEZERO 4K__TEXT 230.1M__UNICODE 544Kmapped file 350.9Mshared memory 6324Kshared pmap 6032K=========== =======TOTAL 912.4MTOTAL, minus reserved VM space 912.3MModel: MacBookPro8,1, BootROM MBP81.0047.B1E, 2 processors, Intel Core i7, 2.7 GHz, 8 GB, SMC 1.68f96Indeed this is fixed for 3.5.Since all new unconfirmed bugs start in state UNCONFIRMED now and old unconfirmed bugs were moved to NEEDINFO with a explanatory comment, all bugs promoted above those bug states to NEW and later are automatically confirmed making the CONFIRMED whiteboard status redundant. Thus it will be removed.This bug is similar to one that occurs in Draw.Problem description:Steps to reproduce:1. Insert image from file2. Move or resize the SVG imageCurrent behavior: Causes crash of DrawExpected behavior: Any acceptable image should be able to be moved around on the drawing or resized as needed.Current behavior is erratic and crash occurs at random intervals.OS: Windows XP SP3Ver: 4.3.2.21. please do no longer use winXP2. please file a new bug"1. please do no longer use winXP"While I appreciate the sentiment, and I would even adminish him to to use Windows at all.. but XP has not been dropped from libreoffice support"2. please file a new bug"yes that is absolutely correct.this is not the same bug... please open a new one.just because the symptom you observe are 'similar' to the one associated with a bug closed 3 years ago, does not make it a good place to start a whole new one.
id=39510	Createdopen the file, change one letter and close the file - crashas an attachment there is a writer file. open it, change one letter and save it. Closing the writer file libO crashes. somewhat in the text causes the crash, it cannot be seen.tested with windows 7-64. I see the crash also with 3.4.1-rc3 on Linux. I checked the 64-bit build on SLED11-SP1-x86_64.can reproduce with -3-4-2 rc2 on Linux; needs some valgrinding of writer I think.The code nearest to the crash, seems to have been there since 2000 ...Program received signal SIGSEGV, Segmentation fault.0xae62db28 in SwTxtFrm::IsLocked (this=0x0) at /data/opt/libreoffice/libreoffice-3-4/clone/writer/sw/source/core/inc/txtfrm.hxx:383383 inline sal_Bool IsLocked() const { return bLocked; }(gdb) bt#0 0xae62db28 in SwTxtFrm::IsLocked (this=0x0) at /data/opt/libreoffice/libreoffice-3-4/clone/writer/sw/source/core/inc/txtfrm.hxx:383#1 0xae65d68b in SwFtnBossFrm::RemoveFtn (this=0xac6c0168, pRef=0xac5e1b44, pAttr=0x8ae3f40, bPrep=1 '\001') at /data/opt/libreoffice/libreoffice-3-4/sw/source/core/layout/ftnfrm.cxx:1906#2 0xae7a9dad in SwTxtFtn::DelFrms (this=0x8ae3f40, pSib=0xac5e1ab4) at /data/opt/libreoffice/libreoffice-3-4/sw/source/core/txtnode/atrftn.cxx:381#3 0xae6b0ad6 in SwCntntFrm::~SwCntntFrm (this=0xac5e1ab4, __in_chrg=<value optimized out>) at /data/opt/libreoffice/libreoffice-3-4/sw/source/core/layout/ssfrm.cxx:492#4 0xae78628a in SwTxtFrm::~SwTxtFrm (this=0xac5e1ab4, __in_chrg=<value optimized out>) at /data/opt/libreoffice/libreoffice-3-4/sw/source/core/text/txtfrm.cxx:404#5 0xae7862e5 in SwTxtFrm::~SwTxtFrm (this=0xac5e1ab4, __in_chrg=<value optimized out>) at /data/opt/libreoffice/libreoffice-3-4/sw/source/core/text/txtfrm.cxx:408#6 0xae6b11b3 in SwLayoutFrm::~SwLayoutFrm (this=0xac6c20c8, __in_chrg=<value optimized out>) at /data/opt/libreoffice/libreoffice-3-4/sw/source/core/layout/ssfrm.cxx:607#7 0xae685ff8 in SwBodyFrm::~SwBodyFrm (this=0xac6c20c8, __in_chrg=<value optimized out>) at /data/opt/libreoffice/libreoffice-3-4/clone/writer/sw/source/core/inc/bodyfrm.hxx:37#8 0xae686039 in SwBodyFrm::~SwBodyFrm (this=0xac6c20c8, __in_chrg=<value optimized out>) at /data/opt/libreoffice/libreoffice-3-4/clone/writer/sw/source/core/inc/bodyfrm.hxx:37#9 0xae6b11b3 in SwLayoutFrm::~SwLayoutFrm (this=0xac6c00f0, __in_chrg=<value optimized out>) at /data/opt/libreoffice/libreoffice-3-4/sw/source/core/layout/ssfrm.cxx:607#10 0xae62f590 in SwFtnBossFrm::~SwFtnBossFrm (this=0xac6c00f0, __in_chrg=<value optimized out>) at /data/opt/libreoffice/libreoffice-3-4/clone/writer/sw/source/core/inc/ftnboss.hxx:57#11 0xae67fc06 in SwPageFrm::~SwPageFrm (this=0xac6c00f0, __in_chrg=<value optimized out>) at /data/opt/libreoffice/libreoffice-3-4/sw/source/core/layout/pagechg.cxx:278#12 0xae67fc61 in SwPageFrm::~SwPageFrm (this=0xac6c00f0, __in_chrg=<value optimized out>) at /data/opt/libreoffice/libreoffice-3-4/sw/source/core/layout/pagechg.cxx:318#13 0xae6b11b3 in SwLayoutFrm::~SwLayoutFrm (this=0x8b42e40, __in_chrg=<value optimized out>) at /data/opt/libreoffice/libreoffice-3-4/sw/source/core/layout/ssfrm.cxx:607#14 0xae679dca in SwRootFrm::~SwRootFrm (this=0x8b42e40, __in_chrg=<value optimized out>) at /data/opt/libreoffice/libreoffice-3-4/sw/source/core/layout/newfrm.cxx:606#15 0xae679e3b in SwRootFrm::~SwRootFrm (this=0x8b42e40, __in_chrg=<value optimized out>) at /data/opt/libreoffice/libreoffice-3-4/sw/source/core/layout/newfrm.cxx:624#16 0xae9622b5 in boost::checked_delete<SwRootFrm> (x=0x8b42e40) at /data/opt/libreoffice/libreoffice-3-4/solver/340/unxlngi6.pro/inc/boost/checked_delete.hpp:34#17 0xae962e24 in boost::detail::sp_counted_impl_p<SwRootFrm>::dispose (this=0x8b42ef8) at /data/opt/libreoffice/libreoffice-3-4/solver/340/unxlngi6.pro/inc/boost/smart_ptr/detail/sp_counted_impl.hpp:78#18 0xae3ef73a in boost::detail::sp_counted_base::release (this=0x8b42ef8) at /data/opt/libreoffice/libreoffice-3-4/solver/340/unxlngi6.pro/inc/boost/smart_ptr/detail/sp_counted_base_gcc_x86.hpp:145#19 0xae3ef79e in boost::detail::shared_count::~shared_count (this=0x8b3fb80, __in_chrg=<value optimized out>) at /data/opt/libreoffice/libreoffice-3-4/solver/340/unxlngi6.pro/inc/boost/smart_ptr/detail/shared_count.hpp:217#20 0xae961c12 in boost::shared_ptr<SwRootFrm>::~shared_ptr (this=0x8b3fb7c, __in_chrg=<value optimized out>) at /data/opt/libreoffice/libreoffice-3-4/solver/340/unxlngi6.pro/inc/boost/smart_ptr/shared_ptr.hpp:169#21 0xae961941 in ViewShell::~ViewShell (this=0x8b3fb28, __in_chrg=<value optimized out>)---Type <return> to continue, or q <return> to quit--- at /data/opt/libreoffice/libreoffice-3-4/sw/source/core/view/vnew.cxx:275#22 0xae3fe322 in SwCrsrShell::~SwCrsrShell (this=0x8b3fb28, __in_chrg=<value optimized out>) at /data/opt/libreoffice/libreoffice-3-4/sw/source/core/crsr/crsrsh.cxx:2600#23 0xae5acd59 in SwEditShell::~SwEditShell (this=0x8b3fb28, __in_chrg=<value optimized out>) at /data/opt/libreoffice/libreoffice-3-4/sw/source/core/edit/edws.cxx:66#24 0xae600530 in SwFEShell::~SwFEShell (this=0x8b3fb28, __in_chrg=<value optimized out>) at /data/opt/libreoffice/libreoffice-3-4/sw/source/core/frmedt/fews.cxx:704#25 0xaec87482 in SwWrtShell::~SwWrtShell (this=0x8b3fb28, __in_chrg=<value optimized out>) at /data/opt/libreoffice/libreoffice-3-4/sw/source/ui/wrtsh/wrtsh1.cxx:1759#26 0xaec87513 in SwWrtShell::~SwWrtShell (this=0x8b3fb28, __in_chrg=<value optimized out>) at /data/opt/libreoffice/libreoffice-3-4/sw/source/ui/wrtsh/wrtsh1.cxx:1767#27 0xaebd2a71 in SwView::~SwView (this=0x8b57908, __in_chrg=<value optimized out>) at /data/opt/libreoffice/libreoffice-3-4/sw/source/ui/uiview/view.cxx:1073#28 0xaebd2e03 in SwView::~SwView (this=0x8b57908, __in_chrg=<value optimized out>) at /data/opt/libreoffice/libreoffice-3-4/sw/source/ui/uiview/view.cxx:1088#29 0xb77f52cf in ?? () from /data/opt/TTInstall/program/../basis-link/program/libsfxli.so#30 0xb77f5f94 in SfxViewFrame::~SfxViewFrame() () from /data/opt/TTInstall/program/../basis-link/program/libsfxli.so#31 0xb77f60d8 in SfxViewFrame::~SfxViewFrame() () from /data/opt/TTInstall/program/../basis-link/program/libsfxli.so#32 0xb77f5e8d in SfxViewFrame::Close() () from /data/opt/TTInstall/program/../basis-link/program/libsfxli.so#33 0xb77dfeb2 in ?? () from /data/opt/TTInstall/program/../basis-link/program/libsfxli.so#34 0xb77efa0f in SfxBaseController::dispose() () from /data/opt/TTInstall/program/../basis-link/program/libsfxli.soI suppose it may be related to the re-factor of the layout fun that we merged in m104:commit bee0ab39bd38fc866e4e7149b9ac59b6a0209b63Author: Mathias Bauer <>Date: Fri Dec 17 09:02:23 2010 +0100 CWS swlayoutrefactoring: #i115510#: first step to clean up the SwClient messWhich at least changed FindMaster's function.Unfortunately, reproducing it is not so easy as it was at first for me. Perhaps it relies on the layout code being in a given state when we exit.The banal patch:--- a/sw/source/core/layout/ftnfrm.cxx+++ b/sw/source/core/layout/ftnfrm.cxx@@ -1897,7 +1897,7 @@ void SwFtnBossFrm::RemoveFtn( const SwCntntFrm *pRef, const SwTxtFtn *pAttr, { OSL_ENSURE( pRef->IsTxtFrm(), "NoTxtFrm has Footnote?" ); SwTxtFrm* pMaster = (SwTxtFrm*)pRef->FindMaster();- if( !pMaster->IsLocked() )+ if( pMaster && !pMaster->IsLocked() ) pMaster->Prepare( PREP_FTN_GONE ); } }Might fix the symptom, if not the underlying problem, but lots of other FindMaster results are used unchecked. Thoughts appreciated.Any thoughts Cedric ? :-)CreatedModified file without crashThat seems to be similar to '- Writer crashes at closing a document with footnotes in a single paragraph over two pages'.The attached 'temp-49_modified.odt' doesn't crash at closing.My modification:Inserted a manual page break on page 3 after"xxhöhxwgew dxx xmsayzsyexxx (zxleyzy 1.1.2007, 1.4.1998) sqwd sowsy wqchy awzxseyzew, da qw dew fesygesyellyew waxprxcsqwdqces ewyhalyew."[highlighted yellow].All footnotes of the former single paragraph are now in a second paragraph on page 4.No Crash with Master "LibO-dev 3.4.5 – WIN7 Home Premium (64bit) English UI [(Build ID:d337f79-a24c961-2865670-9752b71-7f8fd43 2fdd60d-fd28b6a-fd7bf20-aa369cb-28da3fb 6a9633a-931d089-ecd263f-c9b55e9-b31b807 82ff335-599f7e9-bc6a545-1926fdf)]"No Crash with "LibreOffice Portable 3.3.3 - WIN7 Home Premium (64bit) German UI [OOO330m19 (Build:301 Tag 3.3.3.1)]", so REGRESSIONOS -> All due to***has been marked as a duplicate of this bug. ***Within relative short time we had DUPs,,, what shows the severity of this bug. Currently LibO is unusable for scientific texts or other ones with many footnotes. This is even more serious because users suffering from an other footnote problem (,,(all fixed for 3.4.2?)) can not upgrade.So I decided to rate this one as a blocker. Please feel free to downgrade Importance if you see higher-ranking interests to get released 3.4.2 asap.I also saw the crash with a daily build nearby "LibreOffice 3.4.1 - WIN7 HomePremium (64bit) German UI [OOO340m1 (Build:101)]"Adding my humble opinion, I fully agree to rate this as a blocker. Particularly the less technically experienced researchers are afraid of having lost data due to this bug (I can name at least two plus myself). This cannot be unfixed in 3.4.2 particularly if it should be ready for enterprise and professional deployment.Createdpatch for debugging the issueI debugged a bit around this.The issue after all is that the assertion at:fires: "Follow ist lost in Space."I created the attached debug code to see when things go wrong:- After loading, the doc looks sane- After inserting a char the doc looks sane- After saving, the doc looks sane- At the start of SwView::~SwView() the doc looks saneSo the issue is likely that the destruction of the layout does something in the wrong order while destructing itself.To use the patch (which is never intended to be commited obviously), apply it, compile sw with "make DBGLEVEL=2" and type: p debug_checkCntntNodeFollow(debug_GetLastLoadedDoc())in gdb. The debugcode needs some more tuning to work well during destruction, because it gets the RootFrm from the SwDoc, which is disconnected rather early.HTH a bit.I could to really figure out what is going on there, but this looks really, really wrong:#14 0xae679dca in SwRootFrm::~SwRootFrm (this=0x8b42e40, __in_chrg=<valueoptimized out>) at/data/opt/libreoffice/libreoffice-3-4/sw/source/core/layout/newfrm.cxx:606#15 0xae679e3b in SwRootFrm::~SwRootFrm (this=0x8b42e40, __in_chrg=<valueoptimized out>) at/data/opt/libreoffice/libreoffice-3-4/sw/source/core/layout/newfrm.cxx:624To me that looks like the SwRootFrm thinks it is a member of itself. It calls its own destructor on the same instance (itself) upon leaving the scope of the destructor. While I think that cant be right, it can be even less right with the SwRootFrm being owned by the ViewShell (via boost::shared_ptr<>), so the only one ever calling a ~SwRootFrm destructor should be that shared_ptr<>.Unfortunately, I havent figured it out completely -- all I see is that I jump from the last line of the destructor to the first one of it in the debugger.Most likely the cause is somewhere in writer:0382ef89c6631ec39b98b63dbdadd85ecea11275, but that one is not-so-small.Createdpatch for debugging the issueupdated patch to check the consistency of the layout. Im giving up for now (after all it is weekend and vacation for me).Ok, one final suspicion: at#13 0xae6b11b3 in SwLayoutFrm::~SwLayoutFrm (this=0x8b42e40, __in_chrg=<valueoptimized out>) at/data/opt/libreoffice/libreoffice-3-4/sw/source/core/layout/ssfrm.cxx:607the SwLayoutFrm has already been removed from the layout tree in the line before, so when FindMaster iterates backwards through the tree it cant find its Master, because that is in the other tree. Dunno why this would have worked before then though (maybe by some evil Doc->IsInDtor() magic?)(In reply to)I see the crash also with LO-3.4.0-final on SLED11-SP1-x86_64 => it is an older bug. Nobody escalated it earlier, so it can't block the 3.4.2 release. We are sorry but affected users need to wait for LO-3.4.3 release.BTW: The crash happens when people close the document. It usually happens when people close the whole application => It is ugly, it might block saving other opened documents but it should not cause that much harm in most cases.Createdstructure of the layout at the beginning of destruction and at the time of crashIn the attached file, you will find a representation of the layout at the beginning of the destruction and which frms are already deleted at the crash.You will find that the text frame 0x7fffc1fb4228 is already removed from the layout but still has a follow, the text frame 0x7fffc1fb4330, that is still in the layout. When it tries to delete 0x7fffc1fb4330, 0x7fffc1fb4330 tries to find its master by iterating backwards through the layout, which must fail.I am still unsure why this does not happen in 3.3.3 -- that might be worth a look. However, in general the solution seems to be to remove all footnotes before a textframe gets removed at sw/source/core/layout/ssfrm.cxx:606 ...***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***If can help, in the attachment if you up one level the first heading, then don't crash.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***CreatedCrashlog from Mac OS X 10.7It can be reproduced on Mac OS X 10.7 in LO 3.4.2 Release. Crashlog added.Hi, is the fix for this bug planned to go into 3.4.3?@Petr: referring to your, there are several reasons to rate this bug as a release blocker, although it might be 'alive' for quite some while. Reasons:First, the bug can definitively result in data loss. How to reproduce: (1) Open attached document by gerdl, (2) make minor changes to the document and save it, (3) open any other document and make changes to it, but don't save it, (4) close the first document. -> Result: LibreOffice crashes and all changes to the second document are lost.Second, the bug already has seven duplicatesThird, it affects many documents (containing footnotes), not only few.Please reconsider your decision not to five this bug a 'blocker' status. Thanks.Three more points of advocacy, I'll be brief:1. Users may be under-reporting this bug because there is no indication the crash/recovery cycle is due to footnotes or endnotes. I had a difficult time tracing it to this bug. In fact, the crash does not seem like a crash. WinXP does not give the usual crash response. The program just closes after closing a document, which would be normal in MS Word.2. Users may be under-reporting this bug because they are still on the 3.3 branch.3. Almost all academic publishing uses footnotes, or more commonly, endnotes. All my documents crash, so far.(In reply to)I would stronly support these tree points. I have lots of dokuments with footnotes. For this reason I have gone back to 3.3 branch.FindMaster crasher remembers me of something I fixed a while ago:I can't remember for sure the cause of this hack... and I'll try it on 3.4 to see if it fixes the crasher.(In reply to)Tested to backport this patch on 3.4: works nicely with it. Bjoern, do you have any concern with this patch?No objections against that patch. It is much saner than what we had before.I don't know anything to the contrary to make me thing its a bad idea anyway :-)Patch pushed in both 3-4 and 3-4-3 branches.***has been marked as a duplicate of this bug. ***so a big applause for diving into this and fixing it guys :-)(In reply to)Super job done - tanks a lot everybody!Fix confirmed in LibreOffice 3.4.3 rc2 (Ubuntu 10.04 x86_64).Thanks again. JBF(In reply to)Fix confirmed in LibreOffice 3.4.3 rc2 (Win Vista SP2)Fix confirmed in LibreOffice 3.4.3 rc2 for Mac OS X (tested on Mac OS X 10.7.1)(In reply to)I just installed 3.4.3 on Ubuntu natty to try if it works and, alas, LO still crashes on my footnoted files.I doesn'r crash every time so things are definitely better, but this bug is still far from resolved. Have you tried other formats with footnotes? (i.e. doc that is still the most popular exchange format)Many thanks@krzysztof pijarskiCould you provide a sample document?Createdbug not fixed for this fileCrash problem exists for this file. I am running 3.4.3.2 on Pardus Linux.No crash on closing for me. LibO 3.4.3 under Win7 Italian 64 bit.(In reply to)no crash on closing for me Vista HP SP2 // LO 3.4.3 OOO340m1 (Build:302)No crash with Bertan Gündoğdu' sample and with "LibreOffice 3.4.3 RC2 - WIN7 Home Premium (64bit) German UI [OOO340m1 (Build:302)]".@Bertan Gündoğdu:Please mention that a crashing document with footnotes does not inevitably mean that the fix does not work. I future please report your observations if it's your suspect that the fix does not work, but do not touch "the dashboard"!@Jeffry or someone else:can you please do a test with Linux?I reproduce the crash with the testfile from Bertan Gündoğdu under Ubuntu 10.04 x86_64. I did same test as with the first testfile by gerdl:- open the file with LibO 3.4.3 (build 302)- change one letter- save the file- close the file by clicking on the top right cross (do not close LibO, only the file)==> crash (LibO close without notice, then launch LibO and get the restoration dialog)No crash with the testfile from gerdl.Best regards.JBFCreatedodt file with footnotes that crash(In reply to)This file "odt file with footnotes that crash", continuously crashes LO 3.4.3 in Win XP when I open it. I worked on this file without any problems UNTIL I copied some lines from a docx file with footnotes to it. Then all of a sudden this file caused LO to crash. This also happenned to a file with footnotes that I converted into from docx into odt format.Just open the file in LO.@Rainer In, İsmail attached two versions of the file that i attached to this bug and a simplified version is here [1]. In that bug report, it is accepted that the simplified version of the file causes the same crash, thus the bug is marked as a dup.Hope this helps.[1]"more simple buggy odt file"I can reproduce the crash wit Asterix'x test document and "LibreOffice 3.4.3 RC2 - WIN7 Home Premium (64bit) German UI [OOO340m1 (Build:302)]".When I increase page hight of that document to 60cm the crash disappears, when I return to A4 the crash reappears.It seems that this bug has some more reasons and aspects that were not visible with the first sample document.@Cédric:Can you please examine these new aspects?Please feel free to reassign (or reset Assignee to default) if it’s not your area or if provided information is not sufficient. Please set Status to ASSIGNED if you accept this Bug.Bug reproduced with the test file from Astrix ("Finale Chapter 2 draft 1.odt") and with LibreOffice 3.4.3 final (OOO340m1 (Build:302)) under MacOS X 10.6.8 German.Just following nearly the same steps as mentioned by Jean-Baptiste Faure:1) open the file with LibO 3.4.3 (build 302)2) change one letter3) save the file4) close the file by clicking on the window's top left (red) button (note that this will close the just file, not the application, under MacOS)==> Crash: The system's window "Error Report for LibreOffice" with the message "LibreOffice wurde unerwartet beendet" (LibreOffice was quitted unexpectedly) appears. I will attach the MacOS X crashlog. Hope it helps a little bit ...CreatedThe MacOS X 10.6.8 crashlog when closing the sample document from AstrixThe MacOS X 10.6.8 crashlog when closing the sample document from Astrix, copied from the window "Error Report for LibreOffice" presented by the OS after the crash. If you need some other log files, let me know ...(In reply to)If it helps to increase the importance of this bug ;) I've got the same problem. My system environment is:MS Windows XP SP3 German (all updates), LibreOffice 3.4.3It took me a while to trace my problems with the not removed lock files and the document recovery back to this bug. (It didn't seem likely that this bug might be caused by footnotes)I'm working on a document which will be about 100 pages or more by the time it will be finished. It contains around 60 footnotes at the moment and if I do it right this number will increase! (I didn't attach this file, since it is almost 700k. I will work on a stripped down version of this file if it helps.)This file has been first set up with OpenOffice 3.2.1 and I've made every upgrade that has been released up to LibreOffice 3.4.3For scientific purposes I think it is extremely critical (I was about to say: ludicrously critical) that footnotes (or anything else for that matter) will not cause crashes!When do you think this bug will be fixed? (Not pushing; just looking for information, since I put work on this document on hold because of this bug)Thank you in advanceFabianThe odt file I added "odt file with footnotes that crashed" did not cause any crashes until I copied parts of a docx file with footnotes into it. I was wondering whethercould have any thing to do with this bug.is about writer taking around 2 minutes to open a 50 page docx file with footnotes and 6 minutes to open a 100 page docx file with footnotes.Createdpatch killing footnotes firstAttached patch seems to fix the problem. It makes the layout remove all footnotes as first step before proceeding killing the rest. I will commit it to master and put it for review on -3-4.pushed to master as:Submitted for review for backporting to -3-4:(In reply to)Fix confirmed with nightly build -- LibO-dev 3.5.0 (Build ID: 3323ab3-c56b83c-1e62dcb-2c8122e-7a7d02) running on MacOS X 10.6.8 --: the sample document provided by Astrix doesn’t crash LibreOffice anymore, neither after the simple steps mentioned by Jean-Baptiste Faure or myself, nor after playing around a bit with the document and especially with the footnotes.@ Björn Michaelsen: thank you very much!@ Bertan Gündoğdu & @ Astrix: could you test your crashing files with a new nightly build, just to make sure that all manifestations of the footnotes related crash are fixed now?backported to 3-4 for 3.4.4 release with:(In reply to)Many thanks! So all users will benefit from you patch soon (the publishing date for 3.4.4 is Nov 9, 2011, if I recall correctly).Fix confirmed on Pardus Linux with LO 3.4***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Since all new unconfirmed bugs start in state UNCONFIRMED now and old unconfirmed bugs were moved to NEEDINFO with a explanatory comment, all bugs promoted above those bug states to NEW and later are automatically confirmed making the CONFIRMED whiteboard status redundant. Thus it will be removed.closingMichael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-3-5":fdo#39510: fix yet more layout crashes in ~SwRootFrm:It will be available in LibreOffice 3.5.1.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-3-4":fdo#39510: fix yet more layout crashes in ~SwRootFrm:It will be available in LibreOffice 3.4.6.***has been marked as a duplicate of this bug. ***
id=40988	CreatedExample-fileLO stopps reacting opening a pulldown menue of autofilter. LO has to be restarted. CreatedscreenshotNOT reproducible with reporter#s sample and "LibreOffice 3.4.3 RC2 - WIN7 Home Premium (64bit) German UI [OOO340m1 (Build:302)]" @reporter:Please test a current version! There were several serious Filter problems in 3.3 what have been fixed for 3.4.After deleting the font-caches (system and user) with onyx, the bug seams to be fixed for me.Maybe LO have some problems with fonts?Closing per.RESOLVED, FIXED or CLOSED bugs cant be KEYWORD NEEDINFO.
id=41169	Hotkeys are language dependent and work in English language only.While writing in any other language i.e. any Cyrillic, it's impossible to use hotkeys, they just don't do anything. Switching to English input language enable hotkeys once again.This is very frustrating as user needs to switch language to save document, to make it bold, or italic, etc. [This is an automated message.]This bug was filed before the changes to Bugzilla on 2011-10-16. Thus itstarted right out as NEW without ever being explicitly confirmed. The bug ischanged to state NEEDINFO for this reason. To move this bug from NEEDINFO backto NEW please check if the bug still persists with the 3.5.0 beta1 or beta2 prereleases.Details on how to test the 3.5.0 beta1 can be found at:more detail on this bulk operation:Adding more info.Verified and reproduced on: 3.4.3, 3.4.4, 3.5.0.beta1 and 3.5.0.beta2.Mac OS X specific.Steps to reproduce:1. Launch Writer.2. Change language to Russian.3. Press Cmd+B to change font weight to bold.Error: Font weight does not get changed. System error sound is played instead.Expected: Font weight changed to bold.Note that some other system hotkeys work as expected. I.e. Cmd+S to save, or Cmd+O to open document still work regardless of input language. Other critical key combinations that don't work: Cmd+I, Cmd+U and so on, all text manipulation hotkeys are English-only. One may assume that hotkeys don't work correctly in text area, but do work for UI.Workaround 1: Click toolbar button to apply corresponding style.Workaround 2: Change language to English, press desired hotkey, then switch language back to russian.The issue is critical, as it make text editor very slow for keyboard-only typing.***has been marked as a duplicate of this bug. ***Reproduced in 6.6.4.3 on Mac OS X 10.7.5.I also confirm this in LibreOffice 3.6.3, and it is really annoying to change keyboard to En, only to use a shortcut and then change it back to whatever it was and then continue.I use Fedora, but this problem was not occurred in Fedora 17 or Windows, as they both use a different keyboard handling method than Fedora 18 (). But now in Fedora 18, lots of program are affected by this change.Applications such as gedit, nautilus, fileroller (Archive Manager) which are parts of gnome act like before, which means there is no difference which keyboard layout is currently active, the keyboard shortcuts work OK. But other applications usually is not the same, like LibreOffice, Zim, Blender, ... .So, I don't know where the problem is, but as (let say native) gnome applications are working fine, so there must be a way to solve this problem with others.The problem still exist in LibreOffice 3.6.5.2 in Fedora 18.I realy dont know why no developer really pay attention to fix this problem.It may looks like that it is not important but it really affected the productivity of LibreOffice for non-Latin users.Today I downloaded LibreOffice 4.0.0.3 from the official website and the problem still is there.I also install all available desktops in Fedora 18 repo and test LibreOffice against theme to check whether the problem of keyboard shortcuts in non-latin layout is steal exist or not:KDE: No problemMATE: No problemXFCE: No problem LXDE: Problem existCinnamon: Problem existAll the three first desktops still use the same keyboard handling as they used to be, but Cinnamon is based on gnome 3 and inherits its problems, and I have no idea about LXDE problem.I really hope someone at last pay some attention to this problem and attempt to fix it.Today I also use the JHBuild tool on Fedora 18 to compile the Gnome 3.7.5 from their external module sets which contain the released tarbals. ()Well, not too surprising, the problem is still exist using Gnome 3.7.5 and LibreOffice 4.0.0.3. This means that LibreOffice needs to make some changes in its keyboard shortcut handling, as it's likely that gnome is not and will not follow its old keyboard management.I am really hoping some developer at least look at this bug and put some information or notes here.Here is how some other big open source products fix this issue:Mozilla:Eclipse:According to this page Chromium fix this in version 3.0.196 afterwards, so it might have something helpful:And also a patch for Gnome which I don't know how to make it work:Sorry in last comment I sent the Eclipse link in Mozilla part.***has been marked as a duplicate of this bug. ***Confirm this bug still exists in LibreOffice 4.0.2.2.Very annoying. The only workaround is to use other apps, like gedit for example. All hotkeys work great in any language there.Using ArchLinux with latest GNOME-Shell 3.8 from gnome-testing repo.I can confirm the bug exists in LibreOffice 4.0.2.2 on MacOS X 10.8.3. It's not a Linux-specific bug.I can not confirm the bug on 4.1.0.0beta1 on Ubuntu.I selected a text, and pressed ctrl+b to make it bold.I tested with the input configured as: English, Arabic, Turkish & Frenchresults: normal behavior.P.S.: I use cinnamon***has been marked as a duplicate of this bug. ***I have the same problem. When my keyboard layout is in a non-English language (in my case Fa) most shortcuts don't work (e.g. Ctrl+C, Ctrl+S, customized LO‌ shortcuts).My system: Linux Mint Debian Edition Update Pack 6, XFCE 4.8, LibreOffice 3.5.4.2, both libreoffice-gnome and libreoffice-gtk packages installed.(In reply to)Also in my case, as AshkanV mentioned in, many other applications work just fine. I'm in XFCE but I also have Gnome, KDE and Mate installed. And text editors of all of these DEs work correctly.In the both links below they blame packages libreoffice-gtk or libreoffice-gnome.Someone also suggested resetting LO user profile in duplicate:However as mentioned inthis bug could be reproduced in LibreOffice 4.0.2.2 on MacOS X 10.8.3, which complicates the situation.Sina, resetting profile does not help. Also this bug is reproducible in 4.1.0.4.This bug is reproducible on gnome-shell in ubuntu 13.10, which handles now keyboard events with the new gnome-settings-daemon instead of directing them to X. It is indeed a crucial issue for all of us who happen to work with a non-latin language.Still exists in LibreOffice 4.1.2.2.Still exists in 4.1.2.3.All hotkeys are not working in all keyboards, except English.Verified and reproduced on: 4.1.2.3 on Ubuntu 13.10Steps to reproduce:1. Launch Writer.2. Change language to Russian and write a text, then select a part of it.3. Press Ctrl+X to cut a text.Error: Text will be on screenExpected: To cut selected text.Workarounds to use toolbar buttons or select English keyboard layout, use shortcut, select Russian layout.It is very important bug because make work very slow.***has been marked as a duplicate of this bug. ***Seefor why this happens and how it could be fixed.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***== TESTS WE DO ==This bug found in:- Fedora 19 Gnome Shell- Fedora 19 Mate- Ubuntu 12.04 Unity- Ubuntu 12.04 Cinnamon- Ubuntu 13.10This bug not found in:- Fedora 19 KDE- Mint 15 Cinnamon- Mint 15 XFCE- Debian 7.1- Debian - nonstable XFCE- Ubuntu 10.04 Gnome 2.30- Arch KDECurrent behavior:Accelators don't workExpected behavior:Accelators works Operating System: Linux (Other)Version: 4.1.2.3 releaseThe original report is from the Mac, but the recent storm is for gtk. There are different backends involved. So there are really two different bugs in here. A Mac one and a Gtk one.Caolan McNamara committed a patch related to this issue.It has been pushed to "master":Related: fdo#41169 fix GTK non-Latin keyboard layout with Latin shortcutsThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-2":Related: fdo#41169 fix GTK non-Latin keyboard layout with Latin shortcutsIt will be available in LibreOffice 4.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: fdo#41169 fix MacOSX non-Latin keyboard layout with Latin shortcutsThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.And the last patch should allow stuff like ctrl+b to work on the mac even if the current keymap is Russian, which is the other older half of this problem apparently.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-1":Related: fdo#41169 fix GTK non-Latin keyboard layout with Latin shortcutsIt will be available in LibreOffice 4.1.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-1":Resolves: fdo#41169 fix MacOSX non-Latin keyboard layout with Latin shortcutsIt will be available in LibreOffice 4.1.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-2":Resolves: fdo#41169 fix MacOSX non-Latin keyboard layout with Latin shortcutsIt will be available in LibreOffice 4.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.While I had trouble with this bug for a long time, I recently discovered that using m17n keyboard layout instead of xkb layout for Persian (fa_IR) completely resolves the problem in libreoffice 4.1.3 gnome 3.8.(In reply to)And I think the keyboard is actually Latin keyboard, my comment was completely irrelevant.I could not verify the fix on a build from master, Debian testing 64bit, GNOME 3.8 with Hebrew keyboard layout. While using the Hebrew layout I can't use CTRL+C/V or CTRL+O in LibO. Switching to another application (e.g. a web browser) I could paste with CTRL+V although I'm in the Hebrew layout.ֹUnsure if this is the same bug or even related; however, the issue persists with the Hebrew keyboard layout (while absent in (a) other Hebrew layouts (lyx, phoenetic) (b) other languages, including RTL (Russian, Arabic tested)).Ubuntu 13.10 64-bitUnity 7.1.2LibreOffice 4.2.0.4Steps to reproduce:1. Add Hebrew keyboard layout.2. Open Writer.3. Switch to Hebrew layout.4. Type a string.5. Attempt to use CTL+A/C/V/X.Moving to mab4.1 () because:- 4.0 reached EOL (End Of Life)- bug confirmed in later versionHello everyone!After months of switching layouts and banging my head against this bug, I thought I should check LibreOffice settings (I'm using 4.1.5.3 now). What figures? I did find something. And in just a few clicks.This is not a bug! It's simply a matter of configuration.For the regular keyboard shortcuts (like Ctrl+C, Ctrl+V, etc.) to remain operational in LibreOffice applications while using a non-latin keyboard layout (like Greek or Russian), go to Tools -> Options -> Language Settings -> Languages, check the Ignore system input language option, save, and Bob's your uncle.Hope this helps.Cheers!PSTechnically, though, shortcuts still remain language-dependent. This means if you enable this option, you will have to set your document languages manually.The problem is with formatting shortcuts like Ctrl-B/Command+B and Ctrl-I/Command+I shortcuts that still don’t work after Setting “Ignore system input language option”. Ctrl-S/Command-S works even without this setting.***has been marked as a duplicate of this bug. ***is this bug still valid in 4.2.x branch?if yes, please move it from mab4.1 to mab 4.2 list since 4.1.x is EOLBug still exists in LO 4.2.3.3 on ubuntu 14.04 with hebrew layout.The problem still occurs with LibO 4.2.5 on Debian unstable (Gnome 3), but doesn't on 4.2.5 on Ubuntu 10.04 (Official DEBs, not from distro) with Gnome 2.30. Can anyone confirm/deny on KDE/qt so we could narrow this to Gnome 3?I tested that on Arch (Anteragos), with gnome 3.12Build ID: 4.2.5.2 Arch Linux build-1The bug still exists..(I can test on ubuntu 12.04 if needed as well)Version detail should be set to the earliest release the issue is confirmed on, please do not advance it--a note in a comment is all that is required.Resetting to original reporting.Confirming that this bug STILL exists in:$ uname -aLinux localhost.localdomain 3.14.5-200.fc20.x86_64 #1 SMP Mon Jun 2 14:26:34 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux$ cat /etc/fedora-release FXorg -versionX.Org X Server 1.14.4Release Date: 2013-10-31X Protocol Version 11, Revision 0Build Operating System: 3.14.3-200.fc20.x86_64 Current Operating System: Linux localhost.localdomain 3.14.5-200.fc20.x86_64 #1 SMP Mon Jun 2 14:26:34 UTC 2014 x86_64Kernel command line: BOOT_IMAGE=/vmlinuz-3.14.5-200.fc20.x86_64 root=UUID=64bb5aa4-a945-4e0e-8d4d-776f44302cd1 ro rootflags=subvol=root vconsole.font=latarcyrheb-sun16 rhgb quiet LANG=en_US.UTF-8Build Date: 27 June 2014 01:35:28AMBuild ID: xorg-x11-server 1.14.4-11.fc20 Current version of pixman: 0.30.0 Before reporting problems, checkto make sure that you have the latest version.edora release 20 (Heisenbug)$ libreoffice --versionLibreOffice 4.2.6.2 420(Build:2)Tools -> Options -> Language Settings -> Languages -> Ignore system input language - Checked as advised by commenter Paulo Fino, still no hotkeys :-(This bug exists in a fully-updated Arch system:$ uname -aLinux XXXXX 3.17.3-1-ARCH #1 SMP PREEMPT Fri Nov 14 23:13:48 CET 2014 x86_64 GNU/Linux$ libreoffice --versionLibreOffice 4.3.4.1 430m0(Build:1)Please fix this annoying bug, it prevents non-English locale users from getting any meaningful work done.moving this bug to mab4.3 list since 4.2.x is END OF LIFEThis bugreport got non-actionable in the meantime I am afraid; we should close it as per, because fixes of 2 problems were already provided, and also the information about the "Ignore system input language" seems to be helpful.If there are still trouble with the shortcuts, please file that as separate report, and provide the following information:* your locale / language settings* your desktop environment, and its version* LibreOffice version* try also with the latest LibreOffice 'fresh' version, and tell if it is still present there* if it is affected by Tools -> Options -> Language Settings -> Languages -> Ignore system input language* exact reproduction steps (in the affected locale)Thank you all for the reports and fixes!***has been marked as a duplicate of this bug. ***
id=42310	Names defined whid formula don't work and the result is that in the spreadsheet appear error "NAME?"The problem appera with Libreoffice 3.4.3 and not in the previous 3.3.4 CreatedMortage plan with name defined with formulasIt is a case problem.*** This bug has been marked as a duplicate of***
id=42178	CreatedPage Preview and Print document CRASHES LibO 3.5.0 on OSXPrinting a Writer document from Page Preview and Print document CRASHES LibO 3.5.0As an example, we tested the desired functionality in the Master:LibO-dev 3.5.0 Build ID: f8c2d29-e8c71c5-9c6ea62-4b83b90On OSX 10.6.8Located at:withmaster~2011-10-24_13.56.07_LibO-Dev_OOO350m1_MacOS_x86_install_en-US.dmgSteps to reproduce:1. Open a new WRITER Text DocumentOR2. Open an existing document like "OSX_Space_Crash.odt"3. Select File -> Page Preview4. Click on the Print documentExpected results: Document is printed.Actual results: OSX CRASHES!See attachment for sample documents and screenshots (OSX_Crash_Test.zip).Below is a partial Crash Report:Process: soffice [362]Path: /Applications/LibO-dev.app/Contents/MacOS/sofficeIdentifier: org.libreoffice.scriptVersion: 3.5.0 (???)Code Type: X86 (Native)Parent Process: launchd [128]Date/Time: 2011-10-24 15:54:25.111 -0700OS Version: Mac OS X 10.6.8 (10K549)Report Version: 6Interval Since Last Report: 145931 secCrashes Since Last Report: 13Per-App Interval Since Last Report: 53747 secPer-App Crashes Since Last Report: 2Exception Type: EXC_BAD_ACCESS (SIGBUS)Exception Codes: KERN_PROTECTION_FAILURE at 0x0000000000000110Crashed Thread: 0 Dispatch queue: com.apple.main-threadThread 0 Crashed: Dispatch queue: com.apple.main-thread0 libswlo.dylib 0x3654e89c SwCrsrShell::GetCrsr(unsigned char) const + 281 libswlo.dylib 0x36d00119 lcl_GetPrintUIOptions(SwDocShell*, SfxViewShell const*) + 3132 libswlo.dylib 0x36d0e432 SwXTextDocument::getRenderer(long, com::sun::star::uno::Any const&, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) + 27063 libsfxlo.dylib 0x0069d487 SfxPrinterController::SfxPrinterController(boost::shared_ptr<Printer> const&, com::sun::star::uno::Any const&, com::sun::star::uno::Any const&, com::sun::star::uno::Any const&, com::sun::star::uno::Reference<com::sun::star::view::XRenderable> const&, unsigned char, unsigned char, SfxViewShell*, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) + 12714 libsfxlo.dylib 0x0069e152 SfxViewShell::ExecPrint(com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&, unsigned char, unsigned char) + 7705 libsfxlo.dylib 0x006a062c SfxViewShell::ExecPrint_Impl(SfxRequest&) + 5886 libsfxlo.dylib 0x0049b11a SfxShell::ExecuteSlot(SfxRequest&, SfxInterface const*) + 907 libswlo.dylib 0x36c9d3b7 SwPagePreView::Execute(SfxRequest&) + 24238 libsfxlo.dylib 0x0048db12 SfxDispatcher::Call_Impl(SfxShell&, SfxSlot const&, SfxRequest&, unsigned char) + 5309 libsfxlo.dylib 0x0048e104 SfxDispatcher::PostMsgHandler(SfxRequest*) + 30810 libsfxlo.dylib 0x00654109 SfxHintPoster::LinkStubDoEvent_Impl(void*, void*) + 2511 libvcllo.dylib 0x019d9e2f ImplWindowFrameProc(Window*, SalFrame*, unsigned short, void const*) + 558312 libvcllo.dylib 0x019e4483 AquaSalInstance::Yield(bool, bool) + 32313 libvcllo.dylib 0x0170c570 Application::Yield(bool) + 9614 libvcllo.dylib 0x0170c671 Application::Execute() + 9715 libsofficeapp.dylib 0x0006c41d desktop::Desktop::Main() + 631716 libvcllo.dylib 0x01713da8 ImplSVMain() + 37617 libvcllo.dylib 0x019e314b AquaSalInstance::handleAppDefinedEvent(NSEvent*) + 7518 libvcllo.dylib 0x01a28c9b -[VCL_NSApplication sendEvent:] + 31519 com.apple.AppKit 0x98b47253 -[NSApplication run] + 91720 com.apple.AppKit 0x98b3f289 NSApplicationMain + 57421 libvcllo.dylib 0x019e4b97 ImplSVMainHook(int*) + 34322 libvcllo.dylib 0x01713e51 SVMain() + 1723 libsofficeapp.dylib 0x00097e65 soffice_main + 24524 org.libreoffice.script 0x00001ebe main + 3025 org.libreoffice.script 0x00001822 _start + 21626 org.libreoffice.script 0x00001749 start + 41 [Reproducible] with Server installation of Master "LibO-dev 3.5.0 – WIN7 Home Premium (64bit) English UI [(Build ID: d3d1481-3f8994a-2ba0a9f)]" (110909)[Reproducible] with parallel installation of MinGW Master "LibO-dev 3.5.0 – WIN7 Home Premium (64bit) English UI [(Build ID: 308b7a2-e916bf9-9c6ea62-e1a2fb3)] (daily/MinGW_cross-compilation 2011-10-18_22.56.49)"Every document will crash, even an empty one.Works fine with with "LibreOffice 3.4.3 - WIN7 Home Premium (64bit) German UI [OOO340m1 (Build:302)]", so Regression.@Cédric:Please feel free to reassign (or reset Assignee to default) if it’s not your area or if provided information is not sufficient. Please set Status to ASSIGNED if you accept this Bug.Also a problem for PDF exportThe possible guilty commit:In the "lcl_GetPrintUIOptions" function (sw/source/ui/uno/unotxdoc.cxx) pDocShell->GetWrtShell() always returns 0 in page preview.Fixed with. Thank you for the detailed report!Since all new unconfirmed bugs start in state UNCONFIRMED now and old unconfirmed bugs were moved to NEEDINFO with a explanatory comment, all bugs promoted above those bug states to NEW and later are automatically confirmed making the CONFIRMED whiteboard status redundant. Thus it will be removed.
id=42470	Steps to reproduce:1. Make sure no soffice process is already running2. Start LibreOffice with the command "libreoffice --nodefault"3. The splash screen appears. (This is the correct behaviour)4. The LO initial window appears. (This shouldn't happen!)This is a regression to the behaviour of LO/OOo in previous versions (before 3.4). -nodefault did not open a visible window.Maybe this was an intentional change because the help text for --nodefault reads:"don't start with an empty document"which is kind of ambiguous but the Ubuntu manpage is much clearer:"Starts the application without any window opened for the first time."(Regarding the bad documentation of the parameter, see also)Anyway, I see no reason why the behaviour of --nodefault was changed and this should be fixed. (In reply to)The effect you seek is obtained with "--invisible"; it also suppresses the splash screen.I rather like that --nodefault gives me a choice what to do instead of dumping me in an empty writer document. I can choose between opening an existing file, creating a new base / writer / calc / ... file.(In reply to)And what if I want to see the splash screen but not the window? That's the effect I seek. And since ages that effect could be achieved with "--nodefault". Not anymore with LibreOffice 3.4.The effect you seek is just starting "soffice" without a parameter.Anyway, let's not get into the "it's not a bug, it's a feature" argument. This is clearly a regression and you would need very, very good arguments to justify willingly breaking all programs/scripts/etc out there which depend on the known behaviour of "--nodefault".To illustrate the scope of the problem, it should also be mentioned that bootstrapping LibreOffice in Java using the com.sun.star.comp.helper.Bootstrap class, also launches the soffice process with the "-nodefault" parameter. Which means that every Java program out there using the well-documented (and also used in the examples of the LibreOffice SDK) way to bootstrap OOo/LibO suddenly behaves differently with LibO 3.4 and opens a window that wasn't there before. Am I the only one who sees this as problematic?And to give you a specific example (since we were asked at the last LibreOffice Hackfest in Munich to mention in our bug reports if the bug affects the Municipality of Munich and its OOo/LibO migration): This bug is highly relevant to us in Munich because our OOo extension "WollMux" is one of the above mentioned programs and we also have other tools which bootstrap OpenOffice in this way. And it is absolutely unacceptable for us that any window is opened in this case.You might say "Just modify your own code to use --invisible instead of --nodefault" but sadly that's not really an option, since we aren't explicitly starting soffice with the --nodefault parameter ourselves but just using OOo/LibreOffice's Bootstrap class and that's not our code. So if you really don't want to fix this bug, at least document the change and update the bootstrap helper classes in the SDK.But my suggestion would be to just change "--nodefault" to behave as it always did. That's the best and easiest solution.(In reply to)No, that creates a new (empty) writer document and puts me in LibreOffice writer. I don't particularly care if the effect I seek is --nodefault or another way, but I'd like to keep a way to achieve it, some way or the other.I see. Then indeed, it is part of external API, and its behaviour should not have changed like that.***has been marked as a duplicate of this bug. ***I can reproduce the issue with LibreOffice 3.4.4 on Linux and on Windows. However, daily builds from libreoffice-3-5 branch and from master behave as expected on Linux: --nodefault does not open LibreOffice windows, just displays the splash screen. On Windows, daily builds from libreoffice-3-5 branch and from master behave wrong, they open a LibreOffice windows with the start center.Removing from the Most Annoying Bugs - this is not a bug affecting majority of users, is it?(In reply to)Well, I don't know if it is affecting the majority of users but as explained in the comments above it is affecting every single application which uses the officially documented way to bootstrap LibreOffice by means of the Bootstrap Java class. Also, everybody who just used "libreoffice --nodefault" in scripts etc. to launch LibreOffice.So, I don't know what exactly the criteria for the "Most Annoying Bugs" list are (as I wasn't the one who put it on there) but in my opinion this bug definitely is directly or indirectly affecting enough users (and especially developers of applications interfacing with LibreOffice) that it should be fixed as soon as possible.Sorry for asking: any chance this bug is going to be fixed soon?As far as I'm concerned: I'm maintaining an Octave (www.octave.org) package () that uses (quoted from) the "officially documented way to bootstrap LibreOffice by means of the Bootstrap Java class". After LO 3.3.1 the behavior of this Bootstrap Java Class got broken (see); while most of that has already been fixed, the one remaining issue is the splash screen that still shows up while AFAIK it shouldn't (and me and my users don't want it).We can't fix this on our side, it's LO code that changed its behavior relative to the LO / OOo docs.ThanksI need this fixed as well, if run with libreoffice instead of OpenOffice.org my software (Gnuaccounting,) keeps opening a useless window. As far as I understood Jürgen this is also one of the reasons why he is really pissed of Libreoffice (he is developer and author of Thera-Pi,, which also embeds OpenOffice.org much better than LibreOffice)+1 from openyabs.orgAs long as the Startparameter-Bug, and here especially the Parameter "--nodefault", will not be fixed, LibreOffice will stay in the status unuseable for all Java-Programmers who embedds OpenOffice in their Software (and for the Users of these Software).And the Tip to take "--invisible" instead of "--nodefault" is not a Tip, it's a gallGrußJürgen Steinhilber+1It's impossible to work with LO > 3.4Sorry. I thought "it's impossible to work with LO >= 3.4"MichaelBecause the same Bug(!) exists in Apache OpenOffice 3.4 i filed the same Bug at the AOO-Project.And the same Bug means that "--nodefault" mustn't open the StartCenter.Contrary to the response of the LO-Team the Apache guys have had a solution at once.And here is the solution for LO:Add " && !rCmdLineArgs.IsNoDefault() " in the module /core/desktop/source/app/app.cxx at line 1675 and everything will be fine.Desolate, desolate, but this is the typically result if one broadcast every day to be the better one, but in the reality most of the code is imported from others.In this case it was the import of a Bug.CheersJürgen Steinhilber4Stephan Bergmann committed a patch related to this issue.It has been pushed to "master":fdo#42470: Do not show backing window on --nodefaultThis is funny. Finally came around to commit the (rather trivial) patch this morning, only to find out I'm dispraised as somebody who "broadcast[s] every dayto be the better one" (which I can't remember I ever did). I happened to look into this issue earlier this week, and in the course of doing so noticed other catastrophes that demanded more urgent fixing. Also, pathetic comments (just some, not all, for sure) and claim of highest criticality -- is there data loss involved? -- do not generally motivate one to treat such an issue as most urgent. I do understand people's frustration with unaddressed issues, though. (But if it frustrated you so much, you could also have had a stab at fixing it yourself. Would have been a nice easy hack to get involved with the LO code base.)Hi Daniel,That was a secret treasure bug, please contact me RE the details of the payment. You just scored 100€. You can ask me to redirect it to any institution you name or if you are freelancer or own a company you can invoice me for the money yourself.I would also be willing to get acquainted with the LO codebase but as far as I am aware the two other bugs really frustrating me are very, very deep and my C++ is not very good.You don't happen to attend the LibreCon 17-19 Oct 2012 do you?Stephan Bergmann committed a patch related to this issue.It has been pushed to "libreoffice-3-6":fdo#42470: Do not show backing window on --nodefaultIt will be available in LibreOffice 3.6.1.(In reply to)Hi Stephan,thanks a lot for doing so, and be sure alot of developers and users would like to thank you too (if they could).(and please don't be angry about my "little tough" posts, but I'm dealing with that problem since LO 3.4, trying to make workaraound etc., always with no success.)Thanks once more.Jürgen(In reply to)...of course I ment "Hi Stephan".As discussed by e-mail, the 100Eur are now donated to the charity organization you mentioned.
id=42534	Problem description: I have a bunch of ODTs created with 3.3.x. Most of them contain a frame on the first page (heavily customized - colored with white border). In 3.4.1 and 3.4.2 all of these files crashed Writer.Using 3.4.3 all but one do not crash writer, but the frame's border is gone - i have to redefine itI have this one file which still crashes writer, i cam send it to whoever thinks it might be useful - it's just 750kbSteps to reproduce:1. Load a odt file2. File loaded having a strange looking frame (no border)3. Crash after a couple of secondsCurrent behavior:Expected behavior:Platform: debian sid - libreoffice 3.4.3 OOO340m1 (Build 302) We should not mix too many problems together. Let's leave this bug for the crash.Please, attach the file that causes the crash. 750kB are fine. The limit is 3GB.Also please try to get backtrace from the crash, seeFinally, open separate bug for the missing frame's border and attache a test file there.BTW: I reduce the severity. It seems to happen with only a particular document => it can't block the whole release.Createdgdb.log on crash after document load (ODT)Hi PetrI will send the odt file causing the crash by email (it's not for the public domain)CheersSpirosThanks for the document.Hmm, I am unable to reproduce the crash. I tested it on two machines. I wonder if you have other fonts or extensions installed, or so.Unfortunately, the backtrace is not much useful without debug information. I see that you have the binaries under /usr/lib/libreoffice => it is not the official build fromWhat Linux distro are you using?Could you please install debuginfo packages and get a better backtrace?Hi PetrI have installed all relevant dbg packages and you can find attached the results of gdb and valgrindI am running aptosid xfce (debian sid)I do have a rather big collection of fonts installed, but that did not seem to be a problem till recently.The extensions i have installed are: Canadian English dictionary Greek dictionary PDF importThank you for your timeCheersSpirosCreatedgdb.log with debugging symbolsCreatedvalgrind.log with debugging symbolsThanks for the last gdb and valgring logs. They might give us some pointers.I add some developers into CC who might be interested into looking at it.I'd need to see a reproducer document. It looks a little like a previous bug where we were casting a SdrObject in a header to another type which was unrelated entirely in order to do some actually fairly useless test on it.BTW, this document demonstratestoo- EDITING: Frame Border Gone under 3.4.3Just a reminder...Well, the immediate crash reported in gdb would be fixed byspecifically by the hunk of sw/source/core/text/txtfrm.cxxI can't reproduce this in 3-4, but from the bt I'm fairly sure the immediate crash would be fixed by backporting the fix mentioned from master.I'll ask on the list if we want this backported.should be good in 3.5, no enthusiasm for backporting to 3.4.X apparently
id=42740	Createdprint screen of the errorCan't finish the installation of LibreOffice 3.3 on windows xp sp3. Unistalled the BRoffice 3.2. Bruno, could you please translate the error dialogs into English? Unfortunately, most developers do not speak Brazilian Portuguese.Anyway, msiexec.exe and msihnd.dll are a basic part of the Windows system. If there are problems with them, you might have troubles also with installing/uninstalling other applications.BTW: 3.3.4 is very old. The 3.4 code line is pretty stable this days. I suggest to try the last 3.4.4 bugfix release.In each case, other people do not report such problem. It must be somehow related to your system. It must not block the whole release => I lover the priority a bit.No reaction, so closed.
id=43139	Using gcc4.6.2 on Gentoo, I get this compile error:[ build CXX ] framework/source/classes/droptargetlistener/var/tmp/portage/app-office/libreoffice-3.4.4.2-r1/work/libreoffice-bootstrap-3.4.4.2/framework/source/accelerators/acceleratorcache.cxx: In copy constructor 'framework::AcceleratorCache::AcceleratorCache(const framework::AcceleratorCache&)':/var/tmp/portage/app-office/libreoffice-3.4.4.2-r1/work/libreoffice-bootstrap-3.4.4.2/framework/source/accelerators/acceleratorcache.cxx:64:29: error: no match for 'operator=' in '((framework::AcceleratorCache*)this)->framework::AcceleratorCache::m_lCommand2Keys = rCopy.framework::AcceleratorCache::m_lCommand2Keys'/var/tmp/portage/app-office/libreoffice-3.4.4.2-r1/work/libreoffice-bootstrap-3.4.4.2/framework/source/accelerators/acceleratorcache.cxx:64:29: note: candidate is:/var/tmp/portage/app-office/libreoffice-3.4.4.2-r1/work/libreoffice-bootstrap-3.4.4.2/framework/inc/stdtypes.h:170:7: note: framework::BaseHash<comphelper::SequenceAsVector<com::sun::star::awt::KeyEvent> >& framework::BaseHash<comphelper::SequenceAsVector<com::sun::star::awt::KeyEvent> >::operator=(framework::BaseHash<comphelper::SequenceAsVector<com::sun::star::awt::KeyEvent> >&)/var/tmp/portage/app-office/libreoffice-3.4.4.2-r1/work/libreoffice-bootstrap-3.4.4.2/framework/inc/stdtypes.h:170:7: note: no known conversion for argument 1 from 'const TCommand2Keys {aka const framework::BaseHash<comphelper::SequenceAsVector<com::sun::star::awt::KeyEvent> >}' to 'framework::BaseHash<comphelper::SequenceAsVector<com::sun::star::awt::KeyEvent> >&'/var/tmp/portage/app-office/libreoffice-3.4.4.2-r1/work/libreoffice-bootstrap-3.4.4.2/framework/source/accelerators/acceleratorcache.cxx: In member function 'virtual void framework::AcceleratorCache::takeOver(const framework::AcceleratorCache&)':/var/tmp/portage/app-office/libreoffice-3.4.4.2-r1/work/libreoffice-bootstrap-3.4.4.2/framework/source/accelerators/acceleratorcache.cxx:81:29: error: no match for 'operator=' in '((framework::AcceleratorCache*)this)->framework::AcceleratorCache::m_lCommand2Keys = rCopy.framework::AcceleratorCache::m_lCommand2Keys'/var/tmp/portage/app-office/libreoffice-3.4.4.2-r1/work/libreoffice-bootstrap-3.4.4.2/framework/source/accelerators/acceleratorcache.cxx:81:29: note: candidate is:/var/tmp/portage/app-office/libreoffice-3.4.4.2-r1/work/libreoffice-bootstrap-3.4.4.2/framework/inc/stdtypes.h:170:7: note: framework::BaseHash<comphelper::SequenceAsVector<com::sun::star::awt::KeyEvent> >& framework::BaseHash<comphelper::SequenceAsVector<com::sun::star::awt::KeyEvent> >::operator=(framework::BaseHash<comphelper::SequenceAsVector<com::sun::star::awt::KeyEvent> >&)/var/tmp/portage/app-office/libreoffice-3.4.4.2-r1/work/libreoffice-bootstrap-3.4.4.2/framework/inc/stdtypes.h:170:7: note: no known conversion for argument 1 from 'const TCommand2Keys {aka const framework::BaseHash<comphelper::SequenceAsVector<com::sun::star::awt::KeyEvent> >}' to 'framework::BaseHash<comphelper::SequenceAsVector<com::sun::star::awt::KeyEvent> >&'make[1]: *** [/var/tmp/portage/app-office/libreoffice-3.4.4.2-r1/work/libreoffice-bootstrap-3.4.4.2/solver/340/unxlngx6.pro/workdir/CxxObject/framework/source/accelerators/acceleratorcache.o] Error 1make[1]: *** Waiting for unfinished jobs....dmake: Error code 2, while making 'all'(...)----------------------------------------------------------------------- Oh dear - something failed during the build - sorry ! For more help with debugging build errors, please see the section in:internal build errors:ERROR: error 65280 occurred while making /var/tmp/portage/app-office/libreoffice-3.4.4.2-r1/work/libreoffice-bootstrap-3.4.4.2/padmin/prjERROR: error 65280 occurred while making /var/tmp/portage/app-office/libreoffice-3.4.4.2-r1/work/libreoffice-bootstrap-3.4.4.2/framework/prj it seems you are using a threaded build, which means that the actual compile error is probably hidden far above, and could be inside any of these other modules: framework please re-run build inside each one to isolate the problem.-----------------------------------------------------------------------Unfortunately, I don't know enough about this to provide a patch on my own :-(Thanks for your help! Sorry, I forgot the first one, here it is:[ build CHK ] loaded modules: padmin/var/tmp/portage/app-office/libreoffice-3.4.4.2-r1/work/libreoffice-bootstrap-3.4.4.2/padmin/source/prtsetup.cxx: In function 'int Sal_SetupPrinterDriver(psp::PrinterInfo&)':/var/tmp/portage/app-office/libreoffice-3.4.4.2-r1/work/libreoffice-bootstrap-3.4.4.2/padmin/source/prtsetup.cxx:816:41: error: no match for 'operator=' in 'rJobData = aDialog.padmin::RTSDialog::getSetup()'/var/tmp/portage/app-office/libreoffice-3.4.4.2-r1/work/libreoffice-bootstrap-3.4.4.2/padmin/source/prtsetup.cxx:816:41: note: candidate is:/var/tmp/portage/app-office/libreoffice-3.4.4.2-r1/work/libreoffice-bootstrap-3.4.4.2/solver/340/unxlngx6.pro/inc/vcl/printerinfomanager.hxx:48:8: note: psp::PrinterInfo& psp::PrinterInfo::operator=(psp::PrinterInfo&)/var/tmp/portage/app-office/libreoffice-3.4.4.2-r1/work/libreoffice-bootstrap-3.4.4.2/solver/340/unxlngx6.pro/inc/vcl/printerinfomanager.hxx:48:8: note: no known conversion for argument 1 from 'const psp::PrinterInfo' to 'psp::PrinterInfo&'make[1]: *** [/var/tmp/portage/app-office/libreoffice-3.4.4.2-r1/work/libreoffice-bootstrap-3.4.4.2/solver/340/unxlngx6.pro/workdir/CxxObject/padmin/source/prtsetup.o] Error 1dmake: Error code 2, while making 'all'Entering /var/tmp/portage/app-office/libreoffice-3.4.4.2-r1/work/libreoffice-bootstrap-3.4.4.2/editeng/prjI confirm thise bug on tegra2 board. same errorCreatedconst_cast required ?Uses const_cast to solve mostly issues and also notethe loadenv.cxx and as it is a workarround should be better means to solve that.Next issue after using the proposed patch. The problem seems not to be side effect of the fix.mkdir -p /home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/solver/340/unxlngi6.pro/workdir/Dep/CxxObject/framework/source/loadenv/ && echo '/home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/solver/340/unxlngi6.pro/workdir/CxxObject/framework/source/loadenv/loadenv.o : $(gb_Helper_PHONY)' > /home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/solver/340/unxlngi6.pro/workdir/Dep/CxxObject/framework/source/loadenv/loadenv.d[ build DEP ] LNK:Library/libfwkli.soR=/home/cabral/libreoffice_cooker/svn/current/BUILD && S=$R/libreoffice-3.4.4 && O=$S/solver/340/unxlngi6.pro && W=$O/workdir && mkdir -p $W/Dep/LinkTarget/Library/ && RESPONSEFILE=/tmp/gbuild.TgMhrL && cat ${RESPONSEFILE} /dev/null | xargs -n 200 cat > $W/Dep/LinkTarget/Library/libfwkli.so.d && rm -f ${RESPONSEFILE}[ build CXX ] framework/source/uiconfiguration/uiconfigurationmanagerR=/home/cabral/libreoffice_cooker/svn/current/BUILD && S=$R/libreoffice-3.4.4 && O=$S/solver/340/unxlngi6.pro && W=$O/workdir && mkdir -p $W/CxxObject/framework/source/uiconfiguration/ && mkdir -p $W/Dep/CxxObject/framework/source/uiconfiguration/ && g++ -DCPPU_ENV=gcc3 -DCUI -DENABLE_GRAPHITE -DENABLE_GTK -DENABLE_KDE4 -DENABLE_LAYOUT=0 -DENABLE_LAYOUT_EXPERIMENTAL=0 -DGCC -DGXX_INCLUDE_PATH=/usr/include/c++/4.6.2 -DHAVE_GCC_VISIBILITY_FEATURE -DLINUX -DNDEBUG -DOPTIMIZE -DOSL_DEBUG_LEVEL=0 -DPRODUCT -DPRODUCT_FULL -DSOLAR_JAVA -DSUPD=340 -DUNIX -DUNX -DVCL -DX86 -D_PTHREADS -D_REENTRANT -Wall -Wendif-labels -Wextra -Wno-ctor-dtor-privacy -Wno-non-virtual-dtor -Woverloaded-virtual -Wshadow -fPIC -fmessage-length=0 -fno-common -fvisibility-inlines-hidden -fvisibility=hidden -pipe -DEXCEPTIONS_ON -fexceptions -fno-enforce-eh-specs -Os -c $S/framework/source/uiconfiguration/uiconfigurationmanager.cxx -o $W/CxxObject/framework/source/uiconfiguration/uiconfigurationmanager.o -MMD -MT $W/CxxObject/framework/source/uiconfiguration/uiconfigurationmanager.o -MF $W/Dep/CxxObject/framework/source/uiconfiguration/uiconfigurationmanager.d -I$S/framework/source/uiconfiguration/ -I$O/inc/stl -I$S/framework/inc/pch -I$S/framework/source/inc -I$S/framework/inc -I$W/inc/framework/ -I$O/inc/external -I$O/inc -I$S/solenv/unxlngi6/inc -I$S/solenv/inc -I$S/res -I$S/solenv/inc/Xp31 -I/usr/lib/jvm/java-1.6.0-openjdk/include -I/usr/lib/jvm/java-1.6.0-openjdk/include/linux -I/usr/lib/jvm/java-1.6.0-openjdk/include/native_threads/include -I$O/inc/framework -I$O/inc/offuh In file included from /usr/lib/gcc/i586-mandriva-linux-gnu/4.6.2/../../../../include/c++/4.6.2/vector:61:0, from /home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/framework/inc/uiconfiguration/uiconfigurationmanager.hxx:36, from /home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/framework/source/uiconfiguration/uiconfigurationmanager.cxx:31:/usr/lib/gcc/i586-mandriva-linux-gnu/4.6.2/../../../../include/c++/4.6.2/bits/stl_algobase.h: In function 'typename __gnu_cxx::__enable_if<(! std::__is_scalar<_Tp>::__value), void>::__type std::__fill_a(_ForwardIterator, _ForwardIterator, const _Tp&) [with _ForwardIterator = framework::UIConfigurationManager::UIElementType*, _Tp = framework::UIConfigurationManager::UIElementType, typename __gnu_cxx::__enable_if<(! std::__is_scalar<_Tp>::__value), void>::__type = void]':/usr/lib/gcc/i586-mandriva-linux-gnu/4.6.2/../../../../include/c++/4.6.2/bits/stl_algobase.h:722:7: instantiated from 'void std::fill(_ForwardIterator, _ForwardIterator, const _Tp&) [with _ForwardIterator = framework::UIConfigurationManager::UIElementType*, _Tp = framework::UIConfigurationManager::UIElementType]'/usr/lib/gcc/i586-mandriva-linux-gnu/4.6.2/../../../../include/c++/4.6.2/bits/vector.tcc:397:5: instantiated from 'void std::vector<_Tp, _Alloc>::_M_fill_insert(std::vector<_Tp, _Alloc>::iterator, std::vector<_Tp, _Alloc>::size_type, const value_type&) [with _Tp = framework::UIConfigurationManager::UIElementType, _Alloc = std::allocator<framework::UIConfigurationManager::UIElementType>, std::vector<_Tp, _Alloc>::iterator = __gnu_cxx::__normal_iterator<framework::UIConfigurationManager::UIElementType*, std::vector<framework::UIConfigurationManager::UIElementType> >, typename std::_Vector_base<_Tp, _Alloc>::_Tp_alloc_type::pointer = framework::UIConfigurationManager::UIElementType*, std::vector<_Tp, _Alloc>::size_type = unsigned int, std::vector<_Tp, _Alloc>::value_type = framework::UIConfigurationManager::UIElementType]'/usr/lib/gcc/i586-mandriva-linux-gnu/4.6.2/../../../../include/c++/4.6.2/bits/stl_vector.h:944:9: instantiated from 'void std::vector<_Tp, _Alloc>::insert(std::vector<_Tp, _Alloc>::iterator, std::vector<_Tp, _Alloc>::size_type, const value_type&) [with _Tp = framework::UIConfigurationManager::UIElementType, _Alloc = std::allocator<framework::UIConfigurationManager::UIElementType>, std::vector<_Tp, _Alloc>::iterator = __gnu_cxx::__normal_iterator<framework::UIConfigurationManager::UIElementType*, std::vector<framework::UIConfigurationManager::UIElementType> >, typename std::_Vector_base<_Tp, _Alloc>::_Tp_alloc_type::pointer = framework::UIConfigurationManager::UIElementType*, std::vector<_Tp, _Alloc>::size_type = unsigned int, std::vector<_Tp, _Alloc>::value_type = framework::UIConfigurationManager::UIElementType]'/usr/lib/gcc/i586-mandriva-linux-gnu/4.6.2/../../../../include/c++/4.6.2/bits/stl_vector.h:632:4: instantiated from 'void std::vector<_Tp, _Alloc>::resize(std::vector<_Tp, _Alloc>::size_type, std::vector<_Tp, _Alloc>::value_type) [with _Tp = framework::UIConfigurationManager::UIElementType, _Alloc = std::allocator<framework::UIConfigurationManager::UIElementType>, std::vector<_Tp, _Alloc>::size_type = unsigned int, std::vector<_Tp, _Alloc>::value_type = framework::UIConfigurationManager::UIElementType]'/home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/framework/source/uiconfiguration/uiconfigurationmanager.cxx:614:70: instantiated from here/usr/lib/gcc/i586-mandriva-linux-gnu/4.6.2/../../../../include/c++/4.6.2/bits/stl_algobase.h:676:2: error: no match for 'operator=' in '* __first = __value'/usr/lib/gcc/i586-mandriva-linux-gnu/4.6.2/../../../../include/c++/4.6.2/bits/stl_algobase.h:676:2: note: candidate is:/home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/framework/inc/uiconfiguration/uiconfigurationmanager.hxx:160:20: note: framework::UIConfigurationManager::UIElementType& framework::UIConfigurationManager::UIElementType::operator=(framework::UIConfigurationManager::UIElementType&)/home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/framework/inc/uiconfiguration/uiconfigurationmanager.hxx:160:20: note: no known conversion for argument 1 from 'const framework::UIConfigurationManager::UIElementType' to 'framework::UIConfigurationManager::UIElementType&'make: *** [/home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/solver/340/unxlngi6.pro/workdir/CxxObject/framework/source/uiconfiguration/uiconfigurationmanager.o] Error 1Createdcomplete fix porpouse - tested also with gcc 4.6.1Build issue (module sfx2) is also being solved by the proposed patch: [ build DEP ] LNK:Library/libsfxli.soR=/home/cabral/libreoffice_cooker/svn/current/BUILD && S=$R/libreoffice-3.4.4 && O=$S/solver/340/unxlngi6.pro && W=$O/workdir && mkdir -p $W/Dep/LinkTarget/Library/ && RESPONSEFILE=/tmp/gbuild.G5GInd && cat ${RESPONSEFILE} /dev/null | xargs -n 200 cat > $W/Dep/LinkTarget/Library/libsfxli.so.d && rm -f ${RESPONSEFILE}[ build CXX ] sfx2/source/doc/guisaveasR=/home/cabral/libreoffice_cooker/svn/current/BUILD && S=$R/libreoffice-3.4.4 && O=$S/solver/340/unxlngi6.pro && W=$O/workdir && mkdir -p $W/CxxObject/sfx2/source/doc/ && mkdir -p $W/Dep/CxxObject/sfx2/source/doc/ && g++ -DCPPU_ENV=gcc3 -DCUI -DENABLE_GRAPHITE -DENABLE_GTK -DENABLE_KDE4 -DENABLE_LAYOUT=0 -DENABLE_LAYOUT_EXPERIMENTAL=0 -DGCC -DGXX_INCLUDE_PATH=/usr/include/c++/4.6.2 -DHAVE_GCC_VISIBILITY_FEATURE -DLINUX -DNDEBUG -DOPTIMIZE -DOSL_DEBUG_LEVEL=0 -DPRODUCT -DPRODUCT_FULL -DSOLAR_JAVA -DSUPD=340 -DUNIX -DUNX -DVCL -DX86 -D_PTHREADS -D_REENTRANT -DSFX2_DLLIMPLEMENTATION -DENABLE_QUICKSTART_APPLET -DENABLE_SYSTRAY_GTK -DPLUGIN_NAME=libqstart_gtkli.so -Wall -Wendif-labels -Wextra -Wno-ctor-dtor-privacy -Wno-non-virtual-dtor -Woverloaded-virtual -Wshadow -fPIC -fmessage-length=0 -fno-common -fvisibility-inlines-hidden -fvisibility=hidden -pipe -DEXCEPTIONS_ON -fexceptions -fno-enforce-eh-specs -Os -c $S/sfx2/source/doc/guisaveas.cxx -o $W/CxxObject/sfx2/source/doc/guisaveas.o -MMD -MT $W/CxxObject/sfx2/source/doc/guisaveas.o -MF $W/Dep/CxxObject/sfx2/source/doc/guisaveas.d -I$S/sfx2/source/doc/ -I$O/inc/stl -I$S/sfx2/inc -I$S/sfx2/inc/sfx2 -I$S/sfx2/source/inc -I$S/sfx2/inc/pch -I$W/SdiTarget/sfx2/sdi -I$W/inc/ -I$O/inc/external -I$O/inc -I$S/solenv/unxlngi6/inc -I$S/solenv/inc -I$S/res -I$S/solenv/inc/Xp31 -I/usr/lib/jvm/java-1.6.0-openjdk/include -I/usr/lib/jvm/java-1.6.0-openjdk/include/linux -I/usr/lib/jvm/java-1.6.0-openjdk/include/native_threads/include -I$O/inc/offuh -I$O/inc -I/usr/include/libxml2 /home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/sfx2/source/doc/guisaveas.cxx: In member function 'sal_Int8 ModelData_Impl::CheckFilter(const rtl::OUString&)':/home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/sfx2/source/doc/guisaveas.cxx:734:63: error: no match for 'operator=' in 'aFiltPropsHM = comphelper::SequenceAsHashMap((*(const com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue>*)(& aFilterProps)))'/home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/sfx2/source/doc/guisaveas.cxx:734:63: note: candidate is:/home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/solver/340/unxlngi6.pro/inc/comphelper/sequenceashashmap.hxx:81:28: note: comphelper::SequenceAsHashMap& comphelper::SequenceAsHashMap::operator=(comphelper::SequenceAsHashMap&)/home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/solver/340/unxlngi6.pro/inc/comphelper/sequenceashashmap.hxx:81:28: note: no known conversion for argument 1 from 'comphelper::SequenceAsHashMap' to 'comphelper::SequenceAsHashMap&'make: *** [/home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/solver/340/unxlngi6.pro/workdir/CxxObject/sfx2/source/doc/guisaveas.o] Error 1Build issue (module framework/loadenv) is also being solved by the proposed patch: /home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/framework/source/loadenv/loadenv.cxx: In member function 'virtual void framework::LoadEnv::initializeLoading(const rtl::OUString&, const com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue>&, const com::sun::star::uno::Reference<com::sun::star::frame::XFrame>&, const rtl::OUString&, sal_Int32, framework::LoadEnv::EFeature, framework::LoadEnv::EContentType)':/home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/framework/source/loadenv/loadenv.cxx:257:107: error: no match for 'operator=' in '((framework::LoadEnv*)this)->framework::LoadEnv::m_lMediaDescriptor = framework::impl_mergeMediaDescriptorWithMightExistingModelArgs(const com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue>&)()'/home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/framework/source/loadenv/loadenv.cxx:257:107: note: candidate is:/home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/solver/340/unxlngi6.pro/inc/comphelper/mediadescriptor.hxx:61:28: note: comphelper::MediaDescriptor& comphelper::MediaDescriptor::operator=(comphelper::MediaDescriptor&)/home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/solver/340/unxlngi6.pro/inc/comphelper/mediadescriptor.hxx:61:28: note: no known conversion for argument 1 from 'comphelper::MediaDescriptor' to 'comphelper::MediaDescriptor&'make: *** [/home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/solver/340/unxlngi6.pro/workdir/CxxObject/framework/source/loadenv/loadenv.o] Error 1Build issue (module framework/uiconfiguration) is also being solved by the proposed patch:In file included from /usr/lib/gcc/i586-mandriva-linux-gnu/4.6.2/../../../../include/c++/4.6.2/vector:61:0, from /home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/framework/source/uiconfiguration/uiconfigurationmanagerimpl.hxx:36, from /home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/framework/source/uiconfiguration/uiconfigurationmanagerimpl.cxx:31:/usr/lib/gcc/i586-mandriva-linux-gnu/4.6.2/../../../../include/c++/4.6.2/bits/stl_algobase.h: In function 'typename __gnu_cxx::__enable_if<(! std::__is_scalar<_Tp>::__value), void>::__type std::__fill_a(_ForwardIterator, _ForwardIterator, const _Tp&) [with _ForwardIterator = framework::UIConfigurationManagerImpl::UIElementType*, _Tp = framework::UIConfigurationManagerImpl::UIElementType, typename __gnu_cxx::__enable_if<(! std::__is_scalar<_Tp>::__value), void>::__type = void]':/usr/lib/gcc/i586-mandriva-linux-gnu/4.6.2/../../../../include/c++/4.6.2/bits/stl_algobase.h:722:7: instantiated from 'void std::fill(_ForwardIterator, _ForwardIterator, const _Tp&) [with _ForwardIterator = framework::UIConfigurationManagerImpl::UIElementType*, _Tp = framework::UIConfigurationManagerImpl::UIElementType]'/usr/lib/gcc/i586-mandriva-linux-gnu/4.6.2/../../../../include/c++/4.6.2/bits/vector.tcc:397:5: instantiated from 'void std::vector<_Tp, _Alloc>::_M_fill_insert(std::vector<_Tp, _Alloc>::iterator, std::vector<_Tp, _Alloc>::size_type, const value_type&) [with _Tp = framework::UIConfigurationManagerImpl::UIElementType, _Alloc = std::allocator<framework::UIConfigurationManagerImpl::UIElementType>, std::vector<_Tp, _Alloc>::iterator = __gnu_cxx::__normal_iterator<framework::UIConfigurationManagerImpl::UIElementType*, std::vector<framework::UIConfigurationManagerImpl::UIElementType> >, typename std::_Vector_base<_Tp, _Alloc>::_Tp_alloc_type::pointer = framework::UIConfigurationManagerImpl::UIElementType*, std::vector<_Tp, _Alloc>::size_type = unsigned int, std::vector<_Tp, _Alloc>::value_type = framework::UIConfigurationManagerImpl::UIElementType]'/usr/lib/gcc/i586-mandriva-linux-gnu/4.6.2/../../../../include/c++/4.6.2/bits/stl_vector.h:944:9: instantiated from 'void std::vector<_Tp, _Alloc>::insert(std::vector<_Tp, _Alloc>::iterator, std::vector<_Tp, _Alloc>::size_type, const value_type&) [with _Tp = framework::UIConfigurationManagerImpl::UIElementType, _Alloc = std::allocator<framework::UIConfigurationManagerImpl::UIElementType>, std::vector<_Tp, _Alloc>::iterator = __gnu_cxx::__normal_iterator<framework::UIConfigurationManagerImpl::UIElementType*, std::vector<framework::UIConfigurationManagerImpl::UIElementType> >, typename std::_Vector_base<_Tp, _Alloc>::_Tp_alloc_type::pointer = framework::UIConfigurationManagerImpl::UIElementType*, std::vector<_Tp, _Alloc>::size_type = unsigned int, std::vector<_Tp, _Alloc>::value_type = framework::UIConfigurationManagerImpl::UIElementType]'/usr/lib/gcc/i586-mandriva-linux-gnu/4.6.2/../../../../include/c++/4.6.2/bits/stl_vector.h:632:4: instantiated from 'void std::vector<_Tp, _Alloc>::resize(std::vector<_Tp, _Alloc>::size_type, std::vector<_Tp, _Alloc>::value_type) [with _Tp = framework::UIConfigurationManagerImpl::UIElementType, _Alloc = std::allocator<framework::UIConfigurationManagerImpl::UIElementType>, std::vector<_Tp, _Alloc>::size_type = unsigned int, std::vector<_Tp, _Alloc>::value_type = framework::UIConfigurationManagerImpl::UIElementType]'/home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/framework/source/uiconfiguration/uiconfigurationmanagerimpl.cxx:740:84: instantiated from here/usr/lib/gcc/i586-mandriva-linux-gnu/4.6.2/../../../../include/c++/4.6.2/bits/stl_algobase.h:676:2: error: no match for 'operator=' in '* __first = __value'/usr/lib/gcc/i586-mandriva-linux-gnu/4.6.2/../../../../include/c++/4.6.2/bits/stl_algobase.h:676:2: note: candidate is:/home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/framework/source/uiconfiguration/uiconfigurationmanagerimpl.hxx:164:20: note: framework::UIConfigurationManagerImpl::UIElementType& framework::UIConfigurationManagerImpl::UIElementType::operator=(framework::UIConfigurationManagerImpl::UIElementType&)/home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/framework/source/uiconfiguration/uiconfigurationmanagerimpl.hxx:164:20: note: no known conversion for argument 1 from 'const framework::UIConfigurationManagerImpl::UIElementType' to 'framework::UIConfigurationManagerImpl::UIElementType&'make: *** [/home/cabral/libreoffice_cooker/svn/current/BUILD/libreoffice-3.4.4/solver/340/unxlngi6.pro/workdir/CxxObject/framework/source/uiconfiguration/uiconfigurationmanagerimpl.o] Error 1The proposed patch helped a lot, but I still get an error in filtercachedata.hxx (error: no match for 'operator=')Listing :Making: standard.libMaking: all_standard.dpsloIn file included from /build/src/build/framework/inc/classes/filtercache.hxx:43:0, from /build/src/build/framework/inc/services/sessionlistener.hxx:35, from /build/src/build/framework/source/register/registerservices.cxx:85:/build/src/build/framework/inc/classes/filtercachedata.hxx: In member function 'framework::FileType& framework::FileType::impl_copy(const framework::FileType&)':/build/src/build/framework/inc/classes/filtercachedata.hxx:233:32: error: no match for 'operator=' in '((framework::FileType*)this)->framework::FileType::lUINames = rCopy.framework::FileType::lUINames'/build/src/build/framework/inc/classes/filtercachedata.hxx:233:32: note: candidate is:/build/src/build/framework/inc/stdtypes.h:170:7: note: framework::BaseHash<rtl::OUString>& framework::BaseHash<rtl::OUString>::operator=(framework::BaseHash<rtl::OUString>&)/build/src/build/framework/inc/stdtypes.h:170:7: note: no known conversion for argument 1 from 'const OUStringHash {aka const framework::BaseHash<rtl::OUString>}' to 'framework::BaseHash<rtl::OUString>&'/build/src/build/framework/inc/classes/filtercachedata.hxx: In member function 'framework::Filter& framework::Filter::impl_copy(const framework::Filter&)':/build/src/build/framework/inc/classes/filtercachedata.hxx:301:32: error: no match for 'operator=' in '((framework::Filter*)this)->framework::Filter::lUINames = rCopy.framework::Filter::lUINames'/build/src/build/framework/inc/classes/filtercachedata.hxx:301:32: note: candidate is:/build/src/build/framework/inc/stdtypes.h:170:7: note: framework::BaseHash<rtl::OUString>& framework::BaseHash<rtl::OUString>::operator=(framework::BaseHash<rtl::OUString>&)/build/src/build/framework/inc/stdtypes.h:170:7: note: no known conversion for argument 1 from 'const OUStringHash {aka const framework::BaseHash<rtl::OUString>}' to 'framework::BaseHash<rtl::OUString>&'/build/src/build/framework/inc/classes/filtercachedata.hxx: In member function 'framework::Loader& framework::Loader::impl_copy(const framework::Loader&)':/build/src/build/framework/inc/classes/filtercachedata.hxx:408:30: error: no match for 'operator=' in '((framework::Loader*)this)->framework::Loader::lUINames = rCopy.framework::Loader::lUINames'/build/src/build/framework/inc/classes/filtercachedata.hxx:408:30: note: candidate is:/build/src/build/framework/inc/stdtypes.h:170:7: note: framework::BaseHash<rtl::OUString>& framework::BaseHash<rtl::OUString>::operator=(framework::BaseHash<rtl::OUString>&)/build/src/build/framework/inc/stdtypes.h:170:7: note: no known conversion for argument 1 from 'const OUStringHash {aka const framework::BaseHash<rtl::OUString>}' to 'framework::BaseHash<rtl::OUString>&'Compiling: accessibility/source/extended/accessiblelistboxentry.cxxEntering /build/src/build/canvas/source/cairoR=/build/src && S=$R/build && O=$S/solver/340/unxlngi6.pro && W=$O/workdir && mkdir -p $W/CxxObject/framework/source/services/ && mkdir -p $W/Dep/CxxObject/framework/source/services/ && g++ -DCPPU_ENV=gcc3 -DCUI -DENABLE_GRAPHITE -DENABLE_GTK -DENABLE_KDE4 -DENABLE_LAYOUT=0 -DENABLE_LAYOUT_EXPERIMENTAL=0 -DGCC -DGXX_INCLUDE_PATH=/usr/include/c++/4.6.2 -DHAVE_GCC_VISIBILITY_FEATURE -DLINUX -DNDEBUG -DOPTIMIZE -DOSL_DEBUG_LEVEL=0 -DPRODUCT -DPRODUCT_FULL -DSOLAR_JAVA -DSUPD=340 -DUNIX -DUNX -DVCL -DX86 -D_PTHREADS -D_REENTRANT -Wall -Wendif-labels -Wextra -Wno-ctor-dtor-privacy -Wno-non-virtual-dtor -Woverloaded-virtual -Wshadow -fPIC -fmessage-length=0 -fno-common -fvisibility-inlines-hidden -fvisibility=hidden -pipe -march=i686 -mtune=generic -O2 -pipe -fstack-protector --param=ssp-buffer-size=4 -D_FORTIFY_SOURCE=2 -DEXCEPTIONS_ON -fexceptions -fno-enforce-eh-specs -Os -c $S/framework/source/services/modelwinservice.cxx -o $W/CxxObject/framework/source/services/modelwinservice.o -MMD -MT $W/CxxObject/framework/source/services/modelwinservice.o -MF $W/Dep/CxxObject/framework/source/services/modelwinservice.d -I$S/framework/source/services/ -I$O/inc/stl -I$S/framework/inc/pch -I$S/framework/source/inc -I$S/framework/inc -I$W/inc/framework/ -I$O/inc/external -I$O/inc -I$S/solenv/unxlngi6/inc -I$S/solenv/inc -I$S/res -I$S/solenv/inc/Xp31 -I/usr/lib/jvm/java-7-openjdk/include -I/usr/lib/jvm/java-7-openjdk/include/linux -I/usr/lib/jvm/java-7-openjdk/include/native_threads/include -I$O/inc/framework -I$O/inc/offuh [ build CXX ] framework/source/services/modulemanagerMaking: all_cairocanvas.dpsloR=/build/src && S=$R/build && O=$S/solver/340/unxlngi6.pro && W=$O/workdir && mkdir -p $W/CxxObject/framework/source/services/ && mkdir -p $W/Dep/CxxObject/framework/source/services/ && g++ -DCPPU_ENV=gcc3 -DCUI -DENABLE_GRAPHITE -DENABLE_GTK -DENABLE_KDE4 -DENABLE_LAYOUT=0 -DENABLE_LAYOUT_EXPERIMENTAL=0 -DGCC -DGXX_INCLUDE_PATH=/usr/include/c++/4.6.2 -DHAVE_GCC_VISIBILITY_FEATURE -DLINUX -DNDEBUG -DOPTIMIZE -DOSL_DEBUG_LEVEL=0 -DPRODUCT -DPRODUCT_FULL -DSOLAR_JAVA -DSUPD=340 -DUNIX -DUNX -DVCL -DX86 -D_PTHREADS -D_REENTRANT -Wall -Wendif-labels -Wextra -Wno-ctor-dtor-privacy -Wno-non-virtual-dtor -Woverloaded-virtual -Wshadow -fPIC -fmessage-length=0 -fno-common -fvisibility-inlines-hidden -fvisibility=hidden -pipe -march=i686 -mtune=generic -O2 -pipe -fstack-protector --param=ssp-buffer-size=4 -D_FORTIFY_SOURCE=2 -DEXCEPTIONS_ON -fexceptions -fno-enforce-eh-specs -Os -c $S/framework/source/services/modulemanager.cxx -o $W/CxxObject/framework/source/services/modulemanager.o -MMD -MT $W/CxxObject/framework/source/services/modulemanager.o -MF $W/Dep/CxxObject/framework/source/services/modulemanager.d -I$S/framework/source/services/ -I$O/inc/stl -I$S/framework/inc/pch -I$S/framework/source/inc -I$S/framework/inc -I$W/inc/framework/ -I$O/inc/external -I$O/inc -I$S/solenv/unxlngi6/inc -I$S/solenv/inc -I$S/res -I$S/solenv/inc/Xp31 -I/usr/lib/jvm/java-7-openjdk/include -I/usr/lib/jvm/java-7-openjdk/include/linux -I/usr/lib/jvm/java-7-openjdk/include/native_threads/include -I$O/inc/framework -I$O/inc/offuh [ build CXX ] framework/source/services/pathsettingsmake[1]: *** [/build/src/build/solver/340/unxlngi6.pro/workdir/CxxObject/framework/source/register/registerservices.o] Error 1make[1]: *** Waiting for unfinished jobs....Compiling: canvas/unxlngi6.pro/misc/cairocanvas.uno_version.cCompiling: canvas/source/cairo/cairo_cachedbitmap.cxxCompiling: canvas/source/cairo/cairo_cairo.cxxCompiling: canvas/source/cairo/cairo_canvas.cxxCompiling: canvas/source/cairo/cairo_canvasbitmap.cxxCompiling: accessibility/source/extended/accessibletabbarbase.cxxCompiling: fpicker/source/office/OfficeFolderPicker.cxxCompiling: fpicker/source/office/fpinteraction.cxxCompiling: fpicker/source/office/fpsmartcontent.cxxCompiling: canvas/source/cairo/cairo_canvascustomsprite.cxxCompiling: canvas/source/cairo/cairo_canvasfont.cxxCompiling: fpicker/source/office/fps_office.cxxCompiling: accessibility/source/extended/accessibletabbar.cxxCompiling: fpicker/source/office/iodlg.cxxmake[1]: Leaving directory `/build/src/build/framework'dmake: Error code 2, while making 'all'CreatedFix the filtercachedata.hxx errorThere are two remaining error with gcc 4.6.2 in the 'framework' module :/build/src/build/framework/source/uiconfiguration/moduleuiconfigurationmanager.cxx:760:85: instantiated from here/usr/lib/gcc/x86_64-unknown-linux-gnu/4.6.2/../../../../include/c++/4.6.2/bits/stl_algobase.h:676:2: error: no match for 'operator=' in '* __first = __value'/usr/lib/gcc/x86_64-unknown-linux-gnu/4.6.2/../../../../include/c++/4.6.2/bits/stl_algobase.h:676:2: note: candidate is:/build/src/build/framework/inc/uiconfiguration/moduleuiconfigurationmanager.hxx:174:20: note: framework::ModuleUIConfigurationManager::UIElementType& framework::ModuleUIConfigurationManager::UIElementType::operator=(framework::ModuleUIConfigurationManager::UIElementType&)/build/src/build/framework/inc/uiconfiguration/moduleuiconfigurationmanager.hxx:174:20: note: no known conversion for argument 1 from 'const framework::ModuleUIConfigurationManager::UIElementType' to 'framework::ModuleUIConfigurationManager::UIElementType&'make: *** [/build/src/build/solver/340/unxlngx6.pro/workdir/CxxObject/framework/source/uiconfiguration/moduleuiconfigurationmanager.o] Error 1[...]/build/src/build/framework/source/uiconfiguration/uiconfigurationmanager.cxx:614:70: instantiated from here/usr/lib/gcc/x86_64-unknown-linux-gnu/4.6.2/../../../../include/c++/4.6.2/bits/stl_algobase.h:676:2: error: no match for 'operator=' in '* __first = __value'/usr/lib/gcc/x86_64-unknown-linux-gnu/4.6.2/../../../../include/c++/4.6.2/bits/stl_algobase.h:676:2: note: candidate is:/build/src/build/framework/inc/uiconfiguration/uiconfigurationmanager.hxx:160:20: note: framework::UIConfigurationManager::UIElementType& framework::UIConfigurationManager::UIElementType::operator=(framework::UIConfigurationManager::UIElementType&)/build/src/build/framework/inc/uiconfiguration/uiconfigurationmanager.hxx:160:20: note: no known conversion for argument 1 from 'const framework::UIConfigurationManager::UIElementType' to 'framework::UIConfigurationManager::UIElementType&'make: *** [/build/src/build/solver/340/unxlngx6.pro/workdir/CxxObject/framework/source/uiconfiguration/uiconfigurationmanager.o] Error 1Createdfix gcc 4.6.2- Add the fix for the filtercachedata.hxx.- Add the fixes for two remaining issues: moduleuiconfigurationmanager.hxx and uiconfigurationmanager.hxx.Thanks. Build finished now here. This issue seems solved.does anyone know what the *root* cause is, casting away const to get operator= working doesn't look right. We have this problem with 3.4.4 as well, but 3.5.0 seems to build fine. Looks like compiler generated an operator=(foo&) instead of operator=(const foo&)problem seems to come from boost::unordered_map's operator=Is this with "system" boost ?, if so what version of boost is it ? This may be triggered by BOOST_COPYABLE_AND_MOVABLE(TYPE)Yes it is from system, version 1.48.0. Some links I'm looking at could help:Just I guess from /usr/include/boost/move/move.hpp: 387 #define BOOST_COPYABLE_AND_MOVABLE(TYPE)\ 388 public:\ 389 TYPE& operator=(TYPE &t)\ 390 { this->operator=(static_cast<const ::boost::rv<TYPE> &>(const_cast<const TYPE &>(t))); return *this;}\ 391 public:\ 392 operator ::boost::rv<TYPE>&() \ 393 { return *static_cast< ::boost::rv<TYPE>* >(this); }\ 394 operator const ::boost::rv<TYPE>&() const \ 395 { return *static_cast<const ::boost::rv<TYPE>* >(this); }\ 396 private:\Line 390, the const_cast seems also to be casting away but the compiler gets lost and guessing kick would be the static_cast operator in left part of the expression, as I still researching.Tried to diff from 1.47.0 but bost/move/move.hpp seems to be new.No problems on my side anymore.Thank you all for the patches.Createdone-liner probable fixSo, I think the problem is really in boost and/or gcc. It happens that 3.5 builds fine because there we enable -std=c++0x when gcc supports it, and then gcc is happy with that move.hpp from boost as a baseclass. How about this attached patch as an alternative.Hi, I've tested your "one-liner probable fix" in one of the reported buildissues and it has solved the problem. It was funny, one of the first things Ihad tried was to force the c++ standard using "-std=c++0x" using g++ commandline output from make for testing and it had *not* worked and now, I retest itusing the same trick and it worked and don't know what I missed. Anyway thealternative proposed fix also worked out :).odd, seems on first reading that boost::unordered_map now uses boost::move and in combo only works in c++11, in which case one wouldn't need boost::unordered_map in the first place :-(pmladek shoved the quick-fix into the 3-4 branch, so "fixed" from that perspective, though this will blow up again if we e.g. upgrade our internal boost to this version and run it through compilers that don't support c++11Sure, was what I'm trying to say in the mail list but my e-mails fall in the moderador approval (checking with Petr): My initial proposed fix is partially right when it to comes to "reimplement the operador=" (not sure about the const casts) whenever the compiler is in the C++03 or bellow mode or even if C++0x is not supported as well using boost 1.48.0 according :.
id=44208	Problem description: I selected various Indian Language to install like Gujarati, Hindi, Punjabi, Oriya, Marathi, Tamil, Telugu. While testing with Tamil (ta_IN) language on Windows Build, and click on Tools-> Option (or preference), application crashed.Steps to reproduce:1. install 3.5 Beta3 and select multiple language (like Hindi, Punjabi, Tamil)2. Select User Interface Language Tool->option->Language Settings->UI Language - Tamil3. close dialouge and click again Tools->OptionCurrent behavior:application crashedExpected behavior:it should not crashedPlatform (if different from the browser): Browser: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:10.0a2) Gecko/20111212 Firefox/10.0a2 may be helpfulProblem signature: Problem Event Name: APPCRASH Application Name: soffice.bin Application Version: 3.5.0.2 Application Timestamp: 4ef2169f Fault Module Name: KERNELBASE.dll Fault Module Version: 6.1.7601.17651 Fault Module Timestamp: 4e211319 Exception Code: e06d7363 Exception Offset: 0000b9bc OS Version: 6.1.7601.2.1.0.768.3 Locale ID: 18441 Additional Information 1: 0645 Additional Information 2: 0645d45961e356e62a360efba14a7d78 Additional Information 3: 81f6 Additional Information 4: 81f6ec5f817e576407e4b4c16f755576Could you also try it with RC1 that was just released?(In reply to)Still crashed (with RC1). Same type of behaviour for other Indian language. I tested following:with Bug:Gujarati (gu_IN)Hindi (hi_IN)Malayalam (ml_IN)Oriya (or_IN)Telugu (te_IN)Kannada (kn_IN)Nepali (ne_NP)Marathi (mr_IN)while application working properly with following locales (Indic and Non-Indic both):BengaliKashmiri (Kashmir)Punjabipt_BRJapaneseKorean***has been marked as a duplicate of this bug. ***Confirmed due to "- UI: TAMIL / DOGRI CRASH in menu Tools - Options"Modified version due to a.m. Bug.NEEDINFO: Any possibility to get information with what version that really started?Changing version (BTW 3.4.5 did not crash for me).@András:CRASH remains reproducible for me with "LibreOffice 3.4.5 Tamil (or Dogri) UI / German Locale [Build ID: OOO340m1 (Build:502)]" parallel Server installation on German WIN7 Home Premium (64bit)But indeed not reproducible with 3.4.5 on WIN XP 32Bit on VirtualBoxI may have fixed it. Could you please test?Look for main.xcd in c:\Program Files\LibreOffice 3.5\share\registry. Open it with a decent text editor. Delete every occurrence of "-IN". E.g. replace "te-IN" to "te", etc. Save, restart LibreOffice, and see if it crashes. It does not crash for me after this change.fixed on masterreview pending 3-4, 3-5, 3-5-0committed to 3-4, 3-5. 3-5-0 pending extra review.I wonder where this has been integrated.Please see "- UI: Menu 'Tools -> Options' will crash when 'Bodo' is selected for UI language"
id=44832	Createdand example of wrong axis plotIn ubuntu 10.04 32bit, using LibreOffice 3.4.5 Calc (or Spreadsheet)You tried to plot the axis' leyend and it appears wrongly.In 3.3.x didnt happend. Start to happend in 3.4.xThe problem appears when you have more than one row to plot.See the example!Thanks Well, it is actually the axis, not the leyend (i express myselft wrong).The attached document has already lost the settings for Data Series. It might be, that the file had been affected by. If the data series are corrupted, they cannot be repaired automatically, but you have to enter the correct ranges manually.Can you please try, if you can reproduce the error with a document, that is still correct in LO3.3 and will be wrong in LO3.5? (Use a copy of the file!)Createderror plotting axisstill is the same bug...it is an answer for Regina Henschel <in this case i use LOdev 3.50beta3 in windows 7 64CreatedThe diagram on fileopenSee second attachment...CreatedThe diagram after doubleclicking and giving away the focus (Sorry for the English...)It definitely should not look like this...Because of hoping on a quick fix, I will assign the bug to a Calc pro hacker.My OS Win7x64 LibO 3.5I cannot reproduce it. Please attach the document as it has been saved in LO 3.3. We do not need the version from LO 3.5, but we need the original content of the file.I work on WinXP. Can you please test it on WinXP too and/or on another Linux distribution.I appreciate it.I hope this bug could be soon solved.Thanks for the support.I have lost the original file in LO3.3But you can reproduce it with this:Graphic tipe:Lineal. Dot and lines.Row data series.1st column as tag.Y Value:$Hoja1.$B$5:$M$5;$Hoja1.$B$8:$M$8;$Hoja1.$B$11:$M$11;$Hoja1.$B$14:$M$14Categories:$Hoja1.$B$4:$M$4;$Hoja1.$B$7:$M$7;$Hoja1.$B$10:$M$10;$Hoja1.$B$13:$M$13Im using spanish version (so i translate the menus as i think it is). So where is "Hoja1" you should put "Sheet1" or something similar. You can replace it.It happens in 3.4.5 onwards (also 3.5 of course). Also in Windows (XP,7) or any linux distribution...If you need more specifications, just let me know.I may be a Calc expert, but I'm not a Chart expert..Anyway, could someone please create a working test case document in LibO/OOo 3.3 and attach it? Thanks.Createdthe original fileThis file was done with oo3.2(In reply to)Ok. I make my research and i have (somehow) good news.I tried LO3.3 and, know what? Still the bug is there.So i read the metadata of one old file that works fine, and it was made with OPENOFFICE 3.2.So openoffice 3.2 works fine.openoffice 3.3 (i dont know)libreoffice 3.3 and onwards (the bug is there)So, i just attached and OO3.2-without_bug-fileNow I see what you want to do.I have got some older versions and can see, that it is OK in DEV300m73(Build 9486) and is broken in DEV300m75(Build 9488). That has been 2010-03-08 to 2010-03-16 approximately.(In reply to)A long-trace bug.I hope it could be solved.If you need something more, just tell me.May be related to this feature :?@GeraldF: I think, that you are right. That feature was developed in CWS chartmultiline and that CWS was merged to DEV300m74 at 2010-03-09.Can you please check with Libreoffice 3.5.1 or attach a screenshot of the expected result.I think the file looks correct and I fixed some bugs for 3.5.1 and 3.5.2 related to this.@Eike, I hope you don't mind if I take this. Hopefully it has been fixed already withOk, my fix seems to help for fileopen helps but there are even more issues there. Let me see if I can find the remaining issues.There seems to be a really strange issue in VCartesianAxis::createAllTickInfosFromComplexCategories.TickInfo::fScaledTickValue should store the position of the axis labels but it contains more or less useless data for the second and following categories.Markus Mohrhard committed a patch related to this issue.It has been pushed to "master":correctly set the position of the axis labels, related fdo#44832My patch fixes only the positioning problem. There are even more problems around formatting of the string, transformation of the text shape, ... for the second category and following.I'm not sure if we should include this patch if we don't find someone knowing this code quite well or testing the hell out of the complex category charts. The CWS introducing this bug has already introduced several other issues and this patch while fixing this bug might cause new regressions.Ok, I finally a have a fix that solves all remaining problems. The question is why Ingrid Halama added these lines in the first place.I will not ask for 3-5 review without someone either fully understanding this issue or someone testing these fixes with a set of test documents.I will send the patch for review to the ML and won't include it directly into master.So, is there something that we (common humans) could do?Is there something (version libreoffice 3.5.1 beta)that we could try?Markus Mohrhard committed a patch related to this issue.It has been pushed to "master":fdo#44832: Follow-up fix for axis labels for complex categoriesThis patch will not be in the 3-5 release.But there is one thing that would help us quite a lot: It would be great if someone could create a set of test documents containing a lot of different chart features. These would allow us to be safer when we fix bugs and we could try to integrate them into our automatic tests to prevent regressions.***has been marked as a duplicate of this bug. ***
id=46593	Have v3.4.5 installed on Windows 7. Tried to install v3.5 but cannot get it to install due to an error # 1395. Tried the following to solve.Stopped virus and firewall.Re-installed MS .net framework v4Cleaned, repaired and defraged registry.Ran and completed MS "FixIt" tool for install problems.When v3.5 installation would not complete it also uninstalled my v3.4.5 program when it backed out of the install process.Eventually re-installed v3.4.5 and it worked fine.Thank you! Are you sure it was error # 1395 and not error # 1935?I am very sorry...it should be 1935. Typo I guess.________________________________ From: "" <>To:Sent: Saturday, February 25, 2012 4:38 AMSubject: [] Version 3.5 will not installAndras Timar <> changed: What |Removed |Added---------------------------------------------------------------------------- Status|UNCONFIRMED |NEEDINFO Ever Confirmed|0 |1---from Andras Timar <> 2012-02-25 01:38:41 PST ---Are you sure it was error # 1395 and not error # 1935?The error 1935 is described atI am not sure if we can do anything from the LibreOffice side, so adding some Windows experts into CC.The above mentioned page suggest a solution. IMHO, this bug can't block the release => lowering the severity a bit.Thank you for the update and link. However I had already tried all the steps suggested by MS for the 1935 error shown on the linked page. In addition I had reviewed and tried suggestions from other links on the MS site. None helped.It may be that it is a Win 7 problem but I do know that I was able to re-install LO 3.4.5 without incident. Something must be different with the install on 3.5Thanks again!________________________________ From: "" <>To:Sent: Friday, March 2, 2012 6:46 AMSubject: [] Version 3.5 will not installPetr Mladek <> changed: What |Removed |Added---------------------------------------------------------------------------- Severity|blocker |critical CC| |, | |, | |---from Petr Mladek <> 2012-03-02 03:46:14 PST ---The error 1935 is described atI am not sure if we can do anything from the LibreOffice side, so adding someWindows experts into CC.The above mentioned page suggest a solution. IMHO, this bug can't block therelease => lowering the severity a bit.(In reply to)Then it is a dupe.*** This bug has been marked as a duplicate of***
id=47426	CreatedThis document illustrates the problemI have been waiting forever for OOo to implement a "Find all" feature thatsearches all pages by default and gives a list of clickable results. I am now hoping that LibreOffice calc will implement this soon.I have 3 files that I open at work daily using another application because Calclacks this feature. (In reply to)The attached document illustrates why this solution is only a partial one. It can only search one sheet at a time.It has no optionsIt must be relaunched for each new searchThe attached document also illustrates how a perfect solution might work (Gnumeric) and how an adequate solution might work.(MS Excel)Version 3.5 is out and this issue has not been addressed. Sadly, I didn't missany of the improvements that we made. I am confident that if the developerswanted to, they could fix this problem. I just can not understand why theydon't want to.Please can you explain why an improvement must be highest an critical?I can't see it. IMHO only regression or crashing bugs can have this status.(In reply to)If that is the case, I can't. Can you tell me how I can get the developers to give some attention to this bug for which finding a fix is of the highest importance and which needs the most urgent attention? I have been trying for years.It is the only feature of any importance where both OOo and LibreOffice lag behind both MS Excel and Gnumeric.I am agree with you, it is an interesting feature.But I think shout it is not the best to get right attention.Get support from other user, would be good.I don't see this improvement in the list of new features in 3.6:May be is easy to get the attention from developer of the extension.(In reply to)Guess what, of the features listed in the link, I already fixed what I needed by customising menus and using macros. I was not aware of a problem with the others. Ctrl-D - Fixed by customizing menu New option to specify a custom sheet - Unaware of any issues Improved performance of pivot table. - Unaware of any issues Marked cells in Calc can now be merged via the right mouse click - Unaware of any issues Improved error message for invalid sheet name. - Unaware of any issues Export conditional formatting to xlsx (Markus Mohrhard) - Unaware of any issues Improved CSV file import. - Unaware of any issues Added a "Save cell formulas instead of calculated values" - Unaware of any issuesCut and Insert (another request of mine which was ignored) Fixed with macro and menu costomisingDo I really need to wait until I retire in another 15 years or so, plus another2 or so years that it may take me to learn programming (If I live that long) for this to be fixed?Filling several identical bug reports, will not boost your request for enhancement.Set as duplicate of.*** This bug has been marked as a duplicate of***Lots of advice about what won't work. Thanks for that. Any advice about what will?(In reply to)Answer: Yes, nothing.
id=47368	Using Writer with Mac OS X causes many health problems.Alternative title: The unstable version of LibreOffice, labeled as "stable" causes unstable minds.After wasting countless hours redoing lost work, I put that time to a much better use and made this video about the bugs:Here's a quick list of the TOP 5 things crashing Writer:1. Selecting "No Fill" as background color2. Adding a gray border3. Adding a 10pt border4. Adding columns to a footer5. Selecting "Automatic" font colorThese are just the TOP 5.All joking aside, I tested this on 3.5.1, Mac OS X (Snow Leopard and Lion). Clean installations with ~/Application Support/LibreOffice removed prior launching.The version is completely unusable as there are hundreds of things that cause a crash.The only workaround I've found is to use an older version (even the 3.4 has similar problems) or just run Ubuntu on a VM. Now reproduced with:- iMac 27" (2010) with Mac OS X Snow Leopard 10.6.8- iMac 24" (2009) with Mac OS X Lion 10.7.3- MacBook Pro (2011) with Mac OS X Lion 10.7.3- MacBook Pro (2007) with Mac OS X Snow Leopard 10.6.8On pc Debian x86-64, 3.5 branch updated today (so not exactly 3.5.1), I don'treproduce this problem but perhaps it's mac specific.Just some questions :- do you have any extensions ? If yes, could you disable them and test again ?- On the video, we can see some exceptions, could you copy paste the wholestack trace in a file and attach it here ?Alex Thurgood: isn't there a test you usually propose and which could be usefulin this kind of case (disable accessibility or something) ? It's specific MacOsbut I don't remember it exactly.CreatedEXC_BAD_ACCESSSorry, forgot to include the log before.The only extension I have had on a previous version was the finnish language pack.And not all of the machines that I've tested had that.Other than that, nothing.I happened to have another MacBook Pro for testing where the old installation of Mac OS X had this same problem but after reinstalling the OS, everything worked fine.So there might be something from a previous LibreOffice or OpenOffice installation left that I haven't found.A list of the paths I should just rm -rf to be sure, would be great.Hmm, I just tested disabling accessibility and so far no crashes.I add some MAC developers into CC.I have updated the summary to better describe the problem.We have a workaround, so it can't block the release => lowering the severity a bit.(In reply to)Hi Petr,Yes, unfortunately a known problem, and appears to be getting worse (previously it was sporadic, now it seems to be systematic). Something in LO doesn't like Apple's accessibility API, the question is what and where ?It also means that LO for people with disabilities where the accessibility API is useful on Mac is simply not an option.The debug symbols are not provided with the downloadable Mac DMG as far as I know, which makes debugging nigh on impossible for QA. I've never yet been able to build on Mac from master with debug/symbols enabled.AlexSomething that I found out on a clean installation of OS X was, that every time it crashes, it tried to open Java.Might have something to do with that.(In reply to)I sent a post on dev mailing list about this, seeTested with LO Daily :LOdev 3.6.0alpha0+ Build ID: 278c53c-19dcfb4-e67b1b (build with symbols)Mac OSX 10.6.8 Snow LeopardAssistive Technology device access option activated (first of the lower tick boxes on the General AT tab)Tests run according to video provided on You Tube link by bug reporter.32-bit kernel mode:Test 1Start LO, open New Text DocumentRight click, context menu Paragraph, Background, pick new Colour from paletteExpected result : No crash. Background colour of paragraph changes to new selectionActual result : No crash. Background colour of paragraph changes to new selectionConclusion : not reproducible.Test 2Start LO, open New Text documentRight click, context menu Paragraph, Text Borders, set Width to 10, OKExpected result : No crash. Border thickness line preview shows thicker lineActual result : No crash. Border thickness line preview shows thicker lineConclusion : not reproducible.Test 3Start LO, open New Text documentClick in Header or Footer area, play around with H/F properties dialogExpected result : No crash. Properties of header/footer changedActual result : No crash. Properties of header/footer changed.Conclusion : not reproducible.Alex(In reply to)Redid the tests in 64bit kernel mode - no difference, no crashes with any of the tests.Conclusion : not reproducible.Back to square one.AlexI also just repeated the tests with VoiceOver activated. Other than the fact that listening to an American voice trying to pronounce French menu entries drove me half-crazy ;-), I was unable to get LO to crash. I even tried the background colour setting for paragraph context menu, clicking wildly over the palette. Hilarious as it was to listen to VoiceOver trying to keep up, there was no crash.So, unfortunately, none of the reporters crashes were reproducible for me on my system. Sorry.AlexI also tested themaster~2012-03-23_05.11.17_LibO-Dev_3.6.0alpha0_MacOS_x86_install_en-USSeems to work just fine with the same machine that had the crashes...Spoke too soon... "Segmentation fault: 11" when changing border width.Just by curiosity, i searched for "_AXXMIGCopyElementAtPosition" (present in attached filed "EXC_BAD_ACCESS") and found these links :----... (there are others)Perhaps it's normal, I don't know, I just noticed this.***has been marked as a duplicate of this bug. ***I think with the fdo#47015 we can confirm there's a pb when accessibility is enabled.Q/A or devs guys : Perhaps I'm wrong, if it's the case, don't hesitate to revert the status.***has been marked as a duplicate of this bug. ***Also tested with :LibreOffice 3.5.1.2 Version ID : dc9775d-05ecbee-0851ad3-1586698-727bf66Not reproducible on SnowLeopard 10.6.8 with AT activated.AlexI have lion 10.7.3 with LibreOffice 3.5.1.2 . i found that crash occures on a mac which has first time installed libreoffice and usage of border properties on a system with accessibility enabled . probably when accessibility enabled libreoffice cant get and write system information correctly to “/Users/(**username**)/Library/Application Support/LibreOffice/3/user/registrymodifications.xcu” file.If you run libreoffice and use border functions before without accessibility enabled registrymodifications.xcu file created correctly . after that changing accessibility enable or disable not crash anymore.Also when accessibility disabled and enabled first time run with borber properties usage create different registrymodifications.xcu files with different size. one makes crash other file not.for reproduce to crash quit libreoffice, delete “/Users/(**username**)/Library/Application Support/LibreOffice/3/user/registrymodifications.xcu” file than enable accessibility and open libreoffice again and lastly change any border properties .do same thing with disable accessibility not crash.(In reply to)Hi,Oooh, thanks for that tip, will try it out, but maybe it is just sufficient to rename registrymodifications.xcu so that LO will attempt to recreate it on next startup ? I will try both ways anyway.Alexaccessibility do not effect on creation . but file size are different between accessibility enabled and disabled situation. something added when first time usage of change border properties to this file and accessibility effect on this .(In reply to)***has been marked as a duplicate of this bug. ***Toni, a wild guess, but could you try to reproduce it in a master daily build from May 12 or later? just in case it is caused by a certain Mac build system problem with symbol visibility that Tor fixed...***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***I have nominated this as a "LibreOffice 3.5 most annoying bug" -- see my explanation in.***has been marked as a duplicate of this bug. ***Of course, it'd be fantastic to have a stack-trace with full symbols for this SEGV:0 libsvtlo.dylib 0x00af5de2 ValueSetAcc::getAccessibleAtPoint(com::sun::star::awt::Point const&) + 1461 libvcllo.dylib 0x01936c31 hitTestRunner(com::sun::star::awt::Point, com::sun::star::uno::Reference<com::sun::star::accessibility::XAccessibleContext>) + 257...uno::Reference< accessibility::XAccessibleContext > SAL_CALL ValueSetAcc::getAccessibleContext() throw (uno::RuntimeException){ ThrowIfDisposed(); return this;}We don't throw - since we get a SEGV; so ThrowIfDisposed must be accessing invalid memory at: address 0x00000000fe000007 - so not related to a NULL ptr I suppose.svtools/source/control/valueimp.hxx shows this inheriting from:class ValueSetAcc : public ::comphelper::OBaseMutex, public ValueSetAccComponentBasetypedef ::cppu::PartialWeakComponentImplHelper6<...cppuhelper/inc/cppuhelper/compbase_ex.hxxinc/cppuhelper/interfacecontainer.h:typedef OBroadcastHelperVar< OMultiTypeInterfaceContainerHelper , OMultiTypeInterfaceContainerHelper::keyType > OBroadcastHelper;It -seems- that the 'r' prefix is misleading, and that this isa true member of the class; not a reference/pointer that can gobad; so 'this' must be bad at the ValueSetAcc point.The amazing thing is that the hitTestRunner code does: if ( rxAccessibleComponent.is() ) { com::sun::star::awt::Point location = rxAccessibleComponent -> getLocationOnScreen(); com::sun::star::awt::Point hitPoint ( point.X - location.X , point.Y - location.Y); Reference < XAccessible > rxAccessible = rxAccessibleComponent -> getAccessibleAtPoint ( hitPoint );And:awt::Point SAL_CALL ValueSetAcc::getLocationOnScreen() throw (uno::RuntimeException){ ThrowIfDisposed(); const SolarMutexGuard aSolarGuard; const Point aScreenPos( mpParent->OutputToAbsoluteScreenPixel( Point() ) ); awt::Point aRet; aRet.X = aScreenPos.X(); aRet.Y = aScreenPos.Y();Which must be called immediately beforehand - and is -much- more complex and invasive, fails to crash :-) which is where I'd expect problems to occur if anywhere.So - continuing on the basis that the stack-trace is busted, and that in fact it is getLocationOnScreen that crashes de-referencing mpParent - then ...it is rather unclear to me how, if the ValueSet is destroyed, the ValueSetAcc get it's mpParent pointer cleaned up. I'd expect to have the dispose method do that, but ... no sign of that.I guess, the invalid internal state is protected by all these IsDisposed calls (fugly but should work).So - I'm lost; prolly the best way to fix it is to get a valgrind trace of a build with debugging symbols; that ~requires a self-built build configured with --enable-symbols I suspect; and of course valgrind on Mac is newish; hopefully with that we'd get somewhere though.***has been marked as a duplicate of this bug. ***(In reply to)[...][...]Dunno if it is relevant but 'const' here is weird to me...Out of the 5K+ site the use that guard, only a couple hundred use const...***has been marked as a duplicate of this bug. ***is almost certainly a duplicate. I imagine this is memory corruption in VCL's widget tree etc. I suspect the only good way to find it is using valgrind on Mac (with debugging symbols).***has been marked as a duplicate of this bug. ***(In reply to)The "const" there is harmless. Whether or not to include it is a matter of style.- which is no longer reproducible has an horrible stack-trace:Which makes me nervous; re-enterancy and random method calling during vcl's Window destructor looks scary - though whether that's related is unclear - and the incoming call is on another atk peer than that associated with the window being destructed (it seems - from a fragmentry trace); hmm.so I built a debug version to get more info...but I still can reproduce.Any hint about what extra stuff need to be installed(I activated Universal Access, even voice to text... no cigar...)maybe this has to do with the fact that I am in en_US locale ? anyone in en_Us able to reproduce ? in which case please detail the setup and maybe extra accessibility widget/programs installed ...If someone that can reproduce is interested I can try to upload a debug build somewhere....(In reply to)Maybe a strange idea, but: you could try to install the one or the other of the window management utilities which rely heavily on MacOS accessibility features and which are known to trigger this (or a very very similar) bug; AFAIK, such utilities are * Moom (see) * Cinch (see) * RightZoom (see) * ShiftIt (see)... The singular bug reports cited above all give some hints which actions seem to crash LibO most often when the specific utility is installed.Hope it helps!(In reply to)Another idea: most reports about this issue come from users with MacOS X 10.7.x. This may be well a mere coincidence, but it is at least possible that it is easier to trigger this bug on 10.7.x than on 10.6.x ... (I’m on 10.6.8, and I could never manage to reproduce this bug).(In reply to)Sorry for all these posts, but I keep learning ;-):I have finally managed to reproduce-- after installing RightZoom, I can crash LibO 3.5.5.3 reliably by following the description in. Caution: I can’t swear thatis identical with this (present) issue, but at least the crash log looks promisingly: Thread 0 which crashed references ... ValueSetAcc::getAccessibleAtPoint() ... com::sun::star::accessibility::XAccessibleContext ... AquaA11yWrapper accessibilityHitTest: ... NSApplication(NSApplicationAccessibility) accessibilityHitTestSo please either try this yourself (just install RightZoom, activate it, and add LibO to the list of allowed applications -- and LibO crashes like a charm ;-),or upload your debug build and give me a link.I confirm the RightZoom does the trick.I was never able to reproduce so far.. I installed RightZoom and activated it for libreoffice (in fact for everything)started lo 3.6 and started the scenrion descriped in msg# It did not fail quite like described be pretty soon it dumpedProcess: soffice [24105]Path: /Volumes/Raid0/g_core/solver/unxmacxi.pro/installation/opt/LibreOffice.app/Contents/MacOS/sofficeIdentifier: org.libreoffice.scriptVersion: 3.6.0.2 (???)Code Type: X86 (Native)Parent Process: launchd [239]Date/Time: 2012-07-22 06:52:33.399 -0500OS Version: Mac OS X 10.6.8 (10K549)Report Version: 6Interval Since Last Report: 313372 secCrashes Since Last Report: 605284Per-App Interval Since Last Report: 301 secPer-App Crashes Since Last Report: 1Anonymous UUID: 80DA7628-1FAC-4CFF-BDEB-C2B268BC8FB5Exception Type: EXC_BAD_ACCESS (SIGBUS)Exception Codes: KERN_PROTECTION_FAILURE at 0x0000000000000000Crashed Thread: 0 Dispatch queue: com.apple.main-threadThread 0 Crashed: Dispatch queue: com.apple.main-thread0 ??? 0000000000 0 + 01 libsvxlo.dylib 0x340d63c6 svx::a11y::AccFrameSelector::LinkStubWindowEventListener(void*, void*) + 24 (AccessibleFrameSelector.cxx:645)2 libsofficeapp.dylib 0x000feab9 Link::Call(void*) const + 39 (link.hxx:143)3 libvcllo.dylib 0x033040f4 VclEventListeners::Call(VclSimpleEvent*) const + 160 (vclevent.cxx:73)4 libvcllo.dylib 0x03682fc5 Window::CallEventListeners(unsigned long, void*) + 155 (window.cxx:5186)5 libvcllo.dylib 0x036830c7 Window::ImplCallEventListeners(unsigned long, void*) + 31 (window.cxx:5168)6 libvcllo.dylib 0x0369e648 Window::~Window() + 264 (window.cxx:4210)7 libvcllo.dylib 0x0332b85a Control::~Control() + 98 (ctrl.cxx:91)8 libsvxlo.dylib 0x341a2a45 svx::FrameSelector::~FrameSelector() + 61 (frmsel.cxx:789)9 libcuilo.dylib 0x3af6bc19 SvxBorderTabPage::~SvxBorderTabPage() + 2277 (border.cxx:333)10 libsfxlo.dylib 0x00cf3302 SfxTabDialog::~SfxTabDialog() + 1096 (tabdlg.cxx:495)11 libswuilo.dylib 0x3a82ddc2 SwParaDlg::~SwParaDlg() + 38 (pardlg.cxx:168)12 libswuilo.dylib 0x3a877cee AbstractTabDialog_Impl::~AbstractTabDialog_Impl() + 62 (swdlgfact.cxx:120)13 libswlo.dylib 0x322e00ed SwTextShell::Execute(SfxRequest&) + 17593 (textsh1.cxx:1051)14 libswlo.dylib 0x322d0fe8 SfxStubSwTextShellExecute(SfxShell*, SfxRequest&) + 24 (swslots.hxx:2375)15 libsfxlo.dylib 0x00c670e0 SfxShell::CallExec(void (*)(SfxShell*, SfxRequest&), SfxRequest&) + 24 (shell.hxx:199)16 libsfxlo.dylib 0x00c50cc2 SfxDispatcher::Call_Impl(SfxShell&, SfxSlot const&, SfxRequest&, unsigned char) + 1070 (dispatch.cxx:263)17 libsfxlo.dylib 0x00c53cf1 SfxDispatcher::PostMsgHandler(SfxRequest*) + 267 (dispatch.cxx:1245)18 libsfxlo.dylib 0x00c53df8 SfxDispatcher::LinkStubPostMsgHandler(void*, void*) + 24 (dispatch.cxx:1216)19 libsofficeapp.dylib 0x000feab9 Link::Call(void*) const + 39 (link.hxx:143)20 libsfxlo.dylib 0x00e65731 GenLink::Call(void*) + 53 (genlink.hxx:54)21 libsfxlo.dylib 0x00e6568f SfxHintPoster::Event(SfxHint*) + 27 (hintpost.cxx:72)22 libsfxlo.dylib 0x00e65759 SfxHintPoster::DoEvent_Impl(SfxHint*) + 31 (hintpost.cxx:62)23 libsfxlo.dylib 0x00e65672 SfxHintPoster::LinkStubDoEvent_Impl(void*, void*) + 24 (hintpost.cxx:65)24 libsofficeapp.dylib 0x000feab9 Link::Call(void*) const + 39 (link.hxx:143)25 libvcllo.dylib 0x036aa2be ImplHandleUserEvent(ImplSVEvent*) + 220 (winproc.cxx:2003)26 libvcllo.dylib 0x036acfa3 ImplWindowFrameProc(Window*, SalFrame*, unsigned short, void const*) + 1871 (winproc.cxx:2576)27 libvcllo.dylib 0x036bdf39 SalFrame::CallCallback(unsigned short, void const*) const + 63 (salframe.hxx:281)28 libvcllo.dylib 0x036bd7fb AquaSalInstance::Yield(bool, bool) + 335 (salinst.cxx:736)29 libvcllo.dylib 0x032ef653 ImplYield(bool, bool) + 177 (svapp.cxx:452)30 libvcllo.dylib 0x032ebcd0 Application::Yield(bool) + 32 (svapp.cxx:486)31 libvcllo.dylib 0x032ebcf8 Application::Execute() + 38 (svapp.cxx:429)32 libsofficeapp.dylib 0x000fd8fa desktop::Desktop::Main() + 8340 (app.cxx:1823)33 libvcllo.dylib 0x032f7697 ImplSVMain() + 87 (svmain.cxx:183)34 libvcllo.dylib 0x036bc82b AquaSalInstance::handleAppDefinedEvent(NSEvent*) + 219 (salinst.cxx:606)35 libvcllo.dylib 0x03718882 -[VCL_NSApplication sendEvent:] + 64 (vclnsapp.mm:217)36 com.apple.AppKit 0x93edc253 -[NSApplication run] + 91737 com.apple.AppKit 0x93ed4289 NSApplicationMain + 57438 libvcllo.dylib 0x036ba459 ImplSVMainHook(int*) + 375 (salinst.cxx:243)39 libvcllo.dylib 0x032f77c7 SVMain() + 17 (svmain.cxx:217)40 libsofficeapp.dylib 0x0012c711 soffice_main + 293 (sofficemain.cxx:77)41 org.libreoffice.script 0x00001f26 sal_main + 11 (main.c:35)42 org.libreoffice.script 0x00001f0e main + 29 (main.c:33)43 org.libreoffice.script 0x0000187a _start + 21644 org.libreoffice.script 0x000017a1 start + 41Thread 1:0 libSystem.B.dylib 0x9a016b5a semaphore_timedwait_signal_trap + 101 libSystem.B.dylib 0x9a0446e1 _pthread_cond_wait + 10662 libSystem.B.dylib 0x9a08d26c pthread_cond_timedwait + 473 libuno_sal.dylib.3 0x0001d881 rtl_cache_wsupdate_wait(unsigned int) + 99 (alloc_cache.cxx:1384)4 libuno_sal.dylib.3 0x0001da47 rtl_cache_wsupdate_all(void*) + 51 (alloc_cache.cxx:1523)5 libSystem.B.dylib 0x9a044259 _pthread_start + 3456 libSystem.B.dylib 0x9a0440de thread_start + 34Thread 2: Dispatch queue: com.apple.libdispatch-manager0 libSystem.B.dylib 0x9a03d382 kevent + 101 libSystem.B.dylib 0x9a03da9c _dispatch_mgr_invoke + 2152 libSystem.B.dylib 0x9a03cf59 _dispatch_queue_invoke + 1633 libSystem.B.dylib 0x9a03ccfe _dispatch_worker_thread2 + 2404 libSystem.B.dylib 0x9a03c781 _pthread_wqthread + 3905 libSystem.B.dylib 0x9a03c5c6 start_wqthread + 30Thread 3:0 libSystem.B.dylib 0x9a0de096 accept$NOCANCEL$UNIX2003 + 101 libSystem.B.dylib 0x9a0dceff accept + 322 libuno_sal.dylib.3 0x00008a42 osl_acceptPipe + 182 (pipe.c:467)3 libsofficeapp.dylib 0x0012a178 osl::Pipe::accept(osl::StreamPipe&) + 20 (pipe.hxx:141)4 libsofficeapp.dylib 0x00127f48 desktop::OfficeIPCThread::execute() + 42 (officeipcthread.cxx:646)5 libuno_salhelpergcc3.dylib.3 0x00b77b35 salhelper::Thread::run() + 39 (thread.cxx:60)6 libuno_salhelpergcc3.dylib.3 0x00b77eca threadFunc + 30 (thread.hxx:197)7 libuno_sal.dylib.3 0x000122a1 osl_thread_start_Impl + 268 (thread.c:271)8 libSystem.B.dylib 0x9a044259 _pthread_start + 3459 libSystem.B.dylib 0x9a0440de thread_start + 34Thread 4:0 libSystem.B.dylib 0x9a016b5a semaphore_timedwait_signal_trap + 101 libSystem.B.dylib 0x9a0446e1 _pthread_cond_wait + 10662 libSystem.B.dylib 0x9a08d26c pthread_cond_timedwait + 473 libuno_sal.dylib.3 0x0004848e osl_waitCondition + 656 (conditn.cxx:264)4 configmgr.uno.dylib 0x1c53ee16 osl::Condition::wait(TimeValue const*) + 26 (conditn.hxx:85)5 configmgr.uno.dylib 0x1c538196 configmgr::Components::WriteThread::execute() + 52 (components.cxx:191)6 libuno_salhelpergcc3.dylib.3 0x00b77b35 salhelper::Thread::run() + 39 (thread.cxx:60)7 libuno_salhelpergcc3.dylib.3 0x00b77eca threadFunc + 30 (thread.hxx:197)8 libuno_sal.dylib.3 0x000122a1 osl_thread_start_Impl + 268 (thread.c:271)9 libSystem.B.dylib 0x9a044259 _pthread_start + 34510 libSystem.B.dylib 0x9a0440de thread_start + 34Thread 0 crashed with X86 Thread State (32-bit): eax: 0x1db26508 ebx: 0x340d62f0 ecx: 0xbfffdffc edx: 0x00000000 edi: 0x00000000 esi: 0x03303a0a ebp: 0xbfffdf08 esp: 0xbfffdecc ss: 0x0000001f efl: 0x00210206 eip: 0x00000000 cs: 0x00000017 ds: 0x0000001f es: 0x0000001f fs: 0x00000000 gs: 0x00000037 cr2: 0x00000000(In reply to)Good news!Just curious: What did you do to get this crash? My crash log (: just an ordinary MacOS X log, not from a debug build) looks different and contains more references to code points with 'accessibility' in their name. I generated this log via opening an .ods file with some cells with a background color, selecting one of these cells and then selecting "No Fill" from the palette under the Background Fill toolbar button. This crash is 100% reproducible for me with LibO 3.5.5.3. Can you try this, too? I wonder how the dump from your debug build will look ... (I can send you the .ods file I used if it is important.)(In reply to)I created a new empty writer document, right click paragrph.... then clicked on nofillit did not blow up immediatly, so I clicked some other color then nofill then close.. the dialog closed but the app frooze at that point... I even had the time to do a 'sample' via activity monitor... eventualy I got the 'crash dialog with the backtrace attached above. the 'sample' showed the same backtrace***has been marked as a duplicate of this bug. ***Due to the DUPs "- AutoFilter CRASH", "- Autofilter CRASH" it's now more or less "All LibO apps."Createdprototype patch for testing ...Clearly the problem with copying the listeners list is the re-enterancy hazard from Call is not well protected against. Well - this, and also that the -whole- VCL window lifecycle is a real train-crash with these listeners for object death instead of hard, properly tracked reference counts.Michael Meeks committed a patch related to this issue.It has been pushed to "master":fdo#47368 - fix one potential re-enterancy hazard around even emissionMichael Meeks committed a patch related to this issue.It has been pushed to "libreoffice-3-6":fdo#47368 - fix one potential re-enterancy hazard around even emissionIt will be available in LibreOffice 3.6.1.(In reply to)(In reply to)I wondered why it was a bit difficult for Norbert to reproduce this bug even with RightZoom installed ("It did not fail quite like described"); for me, installing RightZoom made crash LibreOffice on selecting nofill for background color immediately. And Norbert's crash log () looks quite different from my own one () -- it does not only contain additional debugging info, but mentions different codepoints, and far less Accessibility stuff as my one.Why?Finally I got it: I testedand this bug with LibO 3.5.5.3, but Norbert's debug build is a debug version of LibO 3.6.0.2. Now LibO 3.6.0.2 (or the whole 3.6.x branch) suffers from: "Text color setting is broken", which makes exactly difficult what is necessary to reproduce this bug with RightZoom: setting the text background color does not work anymore on MacOS. Norbert did not know this, I should have known when I suggested to install RightZoom (), but I just thought about 3.5.x in this issue and forgot totally about...This may explain the difference of the log files. I even fear (but I don't know) thatcurrently "covers" or "hides"and therefore makes it difficult to generate useful debugging info for this present bug by the way I suggested. Maybe because of that Norbert's crash log () has more to do withthan with the present accessibility issue? If so, then we need either to fixfirst and then make another debug build, or to find other ways to get the debug build crash with the accessibility issue ...(In reply to)actually, today, while trying to verify Michael's patch, I could not reproduce the crash anymore, even with the same binary I tested with yesterday :-((In reply to)I can’t, too: while I can reproduce the crash so easily with LibO 3.5.5.3, I can’t reproduce it with your (Norbert’s) debug build -- I have tried for the 3rd time now. This is why I fear thatcurrently "covers" or "hides" our accesibility issue, at least when testing with RightZoom and selecting a text/background color. So what to do now? Can we create a debug build of 3.5.5 (then I hope I will be able to reproduce the issue for sure)?At the moment, I'm searching all the other duplicates of this present bug and trying to get your (Norbert’s) 3.6.0.2 debug build to crash ... ;-)Michael Meeks committed a patch related to this issue.It has been pushed to "libreoffice-3-6-0":fdo#47368 - fix one potential re-enterancy hazard around even emissionIt will be available already in LibreOffice 3.6.0.Thanks to Norbert’s debug version of LibreOffice 3.6.0.2+, I spent several hours trying to reproduce all the different kinds of crashes which are mentioned in this bug report and in all its duplicates. For this I used MacOS X 10.6.8 (Intel) with "Enable access for assistive devices" checked in the System Preferences and RightZoom running (cf.). Now here is a quick overview of my results -- which, I fear, are not as helpful as I had expected. But only the developers can tell.(1) and (2) I can NOT reproduce two kinds of crashes specific to Impress (and). What regards the latter one (sorting slides), this could be explained by, which currently makes sorting slides in LibO 3.6.x on MacOS mostly impossible, and therefore may also "hide".(3) I can reproduce the crash in the LibreOffice Preferences (application "Options") window (,, and probably). See my comment in. For this crash, I got two slightly different kinds of crash logs, seeand. Good news, I hope: both contain explicte references to Accessibility stuff, e.g. XAccessibleContext, XAccessibleComponent, XAccessibleAction. So it may be helpful to look into these log files. I can investigate more, if you want and tell me what to do ...(4) As said above (), I can NOT reproduce the crash which occurs on setting character color and character background color (etc.), and I think -- but I may be totally wrong -- that this has to do with the new. See, again.(5) and (6) But I can reproduce a crash with two similar color-setting related actions (cf.in this report): When I open Writer and add a background color to a paragraph (via Format > Paragraph) or to a table (Via Table > Table properties...), LibO crashes. NB: It may be necessary to click forth and back through the different tabs of the "Paragraph" or "Table Properties" dialog before to get the crash. On both crashes, I get nearly identical log files -- see, and my comments in. Both log files are also more or less identical with Norbert’s log file, cited here in.(7), (8), (9) Many bug reports speak about crashes when adding a border to a cell in Calc or to a paragraph in Writer, or when changing border properties -- see this present report (), andand. I can reproduce this crash in at least three ways: in Calc, when I add a border to a cell (see); in Writer, when I add a border to a paragraph (see) or when I change the border width of a table (see). Cf. my comments in. All three log files are very similar, and they are more or les identical tofrom point (5) above and to Norbert’s log file (). All these log files don’t contain explicte references to Accessibility stuff (but only the developers can really judge this). So these crashes seem to have all the same technical background.(10) I can reproduce a freeze or crash related to auto-filter in Calc -- this isand. See my comments in. The log file for the freeze () could be especially interesting, because it contains explicte references to Accessibility stuff. The crash log () may be less interesting (no Accessibility stuff?), but only our developers can judge this.That’s it -- my results of several hours spent with making LibreOffice crash, a rather destructive pastime ;-) Hope it helps a bit ...Sorry, tired by too much testing done:Section (10) of the previous comment should read (attachment IDs were wrong!):(10) I can reproduce a freeze or crash related to auto-filter in Calc -- thisisand. See my comments in. The log file for thefreeze () could be especially interesting, because it contains explicte references to Accessibility stuff. The crash log () may be less interesting (no Accessibility stuff?), but only our developers can judge this. And I can't tell what was the difference, i.e. why LibO froze the 1st time and crashes the 2nd time.Hi Roman; so - the fix we pushed potentially catches a ton of segv's that have: VclEventListeners::Call(VclSimpleEvent*) constin the last ~5 or so stack-frames; of course - perhaps it doesn't fix the issue - there could clearly be other badness here; but perhaps it does. It'd be great to test the latest snapshot from Norbert's tinderbox that eg. I hope that:makes it ~impossible to reproduce the bulk of these a11y problems :-) if not, we need to think again of course. If so - we need to back-port this to 3.5 and close it I guess. It'd be really lovely to have some testing of that (if possible !). Thanks :-)(In reply to)I would expect the patch to fix issues (5) to (9) from my list in, and maybe issue (10) -- VclEventListeners::Call is in the crash log (), but not in the log file for the freeze (). But at least issue (3) looks entirely different, so please take a special look at this one.I will do so and report my findings.CreatedCrash log - LOdev 2012-07-24 - Writer, add bkg color to paragraph(In reply to)I fear "we need to think again". I have tested again with the latest master build, i.e. with LOdev 3.7.0.0.alpha0+ (Build ID: 7727f93, installation file: master~2012-07-24_01.17.17_LibO-Dev_3.7.0.0.alpha0_MacOS_x86_install_en-US.dmg), and RightZoom running, and can still reproduce the crashes listed in my...There is only a slight difference in the log files for the crashes. I will not post them all, but attached you find the new log file for case (5) from my distinction in, i.e. for adding a background color to a paragraph in Writer. Please compare this with the old. The first lines of the listing for thread 0 are different ...I can post more log files created on crashes with the new master built, of course, just tell me ;-)Ok - then we badly need that valgrind trace - Norbert ? :-) ...An observation which *could* be helpful in finding the bug:(is fixed now, the color pulldown palettes work again, but neverthelessdoes not return, therefore Winfried’s and/or Thorsten’s changes in the code for the color pulldown palettes seem to have eliminated the accessibility-related crashes by the way ... could this give a clue about where the bug is?)(In reply to)>Depending on which version you tested - Michael's fix is in recent -3-6, master, and -3-6-0 as well, I'd be more inclined to attribute fixing this to him therefore. ;)if there's good feedback for the patch (and yes it's hard to see how the color selector change could fix any mac a11y problem) I'll cherry-pick it to libreoffice-3-5 ...(In reply to)I tested the latest master build (LOdev 3.7.0.0.alpha0+, Build ID: c549e1e, installation file:master~2012-07-25_02.21.07_LibO-Dev_3.7.0.0.alpha0_MacOS_x86_install_en-US.dmg) with US English langpack installed.I did not want at all to dispute which patch did the job. But it is interesting that from all the ways to make LibreOffice crash which I have listed in, only no. (4) seems no longer reproducible. The ways (5) to (9), which all produce crash logs similar to Norbert’s one (), and towards which Michael’s patch seems to be directed (because they all involve VclEventListeners::Call() in the topmost stack-frames), are all still reproducible for me with the current master build. This is why I was under the impression that not Michael’s fix, but some change in the color selector code did the job -- because even cell/paragraph background color selection is fixed only when done via the color pulldown palettes (case (4)), but still causes crashes when done via menu and Cell/Paragraph properties window (case (5)/(6)).But I don’t want to dispute ;-) I’m only a simple-minded QA volunteer. I just want to point out that there remains much to do; besides (5) to (9), also case (3) is still reproducible, and I can’t guarantee that (1) and (2) are really fixed -- I can’t reproduce them, of course, but maybe this needs some special circumstances (e.g. MacOS X 10.7.x, or running another window management utility, etc.).(In reply to)Please do so. Then we can see if color selection via the color pulldown palettes will be fixed in 3.5.x, too (this would mean that Michael’s patch did the job, and it will receive all my applause then, as appropriate!), or not (then the 3.6 changes in the code for the color pulldown palettes would be the reason).Michael Meeks committed a patch related to this issue.It has been pushed to "libreoffice-3-5":fdo#47368 - fix one potential re-enterancy hazard around even emissionIt will be available in LibreOffice 3.5.6.(In reply to)I have tested again with LibreOffice 3.5.6.1, which contains the patch mentioned above (see), and I am sorry to say that selecting Font Color "Automatic" or Highlighting Color "No Fill" or (paragraph) Background color "No Fill" from the color pulldown palettes or from the "Character" and "Paragraph" dialog windows still crashes LibreOffice 3.5.6.1. Please see the crash logs:***All three log files are very similar. At the beginning of the files I have noted down the steps necessary to reproduce the crash.Also, all of the other ways to crash LibreOffice enumerated by me instill work (i.e., crash) with LibreOffice 3.5.6.1.What this means should be judged by the developers, but I fear that it is still true what Michael Meeks stated in.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***No "See also" fornecessary, ifis already marked as a duplicate of the present bug.Very interesting:see Alex Thurgood's comments in, "Accessibility - MAC AT accessibility problems".Does this help anything to fix the present issue, or at least to understand it better?***has been marked as a duplicate of this bug. ***Some updates about the importance of this bug:(1) According tothis is the open bug with most duplicates now. Congratulations to the winner;-) And there are more bugs which are most probably duplicates of this one, too (e.g.,and), so additional duplicates are coming ...(2) This bug has real relevance for many people, because our workaround: to disable MacOS accessibility features completely, is not a suitable workaround for many people with this or that kind of physical impairment. Some days ago, Vincenzo () wrote to the QA list: "Let's take, for instance, the mac os x version of LO: unfortunately it contains tons of accessibility bugs that make impossible to use it for a blind user [...] Just my opinion; maybe I am late, but I decided to share the opinion from my blind-user waiting for an accessible mac os x version of lo perspective..."So we need to stop this discriminating bug -- finally.(3) If no one has got a new idea about how to fix this issue, I want to quote Michael Meeks’s, because this is probably the hard way we need to go now (now, or tomorrow, but not some years in the future ;-):Thank you all!(For the record:I change the Importance field, not because I would believe that this would help anything to fix the issue, but only because QA is discussing about sorting bugs by priority, and therefore we need to get the Importance fields right.Additionally, I put the Whiteboard information into "(...)", to mark this information as a comment, because the issue was not fixed in these releases.)(In reply to)So, how many internets did I win?Not only does this affect people needing accessibility for, well accessibility, but also people using helper applications like window managers that require access to the accessibility API.Granted that fixing it for the visibility impaired is a much more important cause, but still.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***(In reply to)The description ofhas a backtrace containing "hitTestRunner" that looks like arbitrary memory corruption (crashing in pthread_mutex_unlock).***has been marked as a duplicate of this bug. ***So - this is indeed an horribly high priority bug; but - without more information it seems un-fixable; it is clearly a memory corruption bug:so I agree with Stephan. It is also I think clearly related to VCL's -abominable- lack of any hard lifecycle mechanism. As such, there are really only three ways we can find this [ assuming it is reproducible ]:a) binary chop. We need to build around 15 versions of LibreOffice going back in time, to the point that the bug (or it's increase in prevalence) was first introduced - IMHO this is a bug that always existed, so just finding that commit may only bring us a bit nearer to understanding the issue.b) code reading / gdb debugging We need to get good traces with debug symbols - the more precision we have as to which object is bad, the more likely we can find what is going on. This needs a hacker with their own build, -with- debugging symbols, and some clue to delve around / read about.c) valgrind Again, requires a build with debugging symbols to be at all useful; and (if we can reproduce it) will give us an exact pair of line numbers for the problem yielding an ~instant fix. Unfortunately, Norbert couldn't reproduce the problem under valgrind, and/or valgrind on OSX hung LibreOffice (which is a hard nut to crack anyway ;-).My preferred approach is c) it's something that anyone with a build with debugging symbols can work on, and perhaps we'd get some help.We really also need some precise instructions on how to reproduce each of the different symptoms of the underlying issue here that can easily be referred to.Sadly I don't have Mac, so can't help out ...(In reply to)Yep, I can confirm Norbert's experience of valgrind with my own fruitless attempts about some 6-8 months ago.LO no longer builds on OSX 10.8 Mountain Lion for me, even with Stephan's script (that appeared to work for him on OSX 10.7), and independently on two different machines, so I currently have no way of building even a normal version of LO on Mac, let alone a debug build, and I'm not a developer by any stretch of the imagination...AlexFor me, LO builds on 10.8.1 with Clang from Xcode 4.4.1 using the following autogen.lastrun:--disable-binfilter--disable-build-mozilla--disable-mozilla--disable-odk--disable-online-update--enable-debug=cppu/ cppuhelper/ sal/ sfx2/ stoc/ sw/ toolkit/ unotest/ unotools/ vcl/--enable-epm--enable-werror--with-java-target-version=1.5--with-macosx-version-min-required=10.6--with-max-jobs=1--with-num-cpus=1--without-doxygen--without-help--without-helppack-integration--without-myspell-dictsI am not saying that it has to be *exactly* like that; it's just an example.No 3rd-party software used except autoconf and automake.Whether the crash can be reproduced using a LO built thusly I have no idea; Quickly testing, I couldn't, but then I didn't try very hard. The distributed LO is built using a very different tool-chain anyway. (If I am expected to debug this, I want it clearly said that I can use work time on it.)(In reply to)If this means that we need a short ‘manual’ listing systematically all known ways to reproduce/trigger this bug, together with step-by-step instructions for each of these ways, and maybe links to the original bug reports, I can take this task ... IMHO a special page in our wiki would be the best solution. Give me some days, and I will create it.(However, if it means something else, please correct me ;-)(In reply to)Tor, thanks for the hint.Which versions of autoconf and automake do you use ? I see autoconf and automake in /Developer/user/share and /Developer/user/bin, but even when I specifically added those directories to my PATH, I still get an error in autogen.sh about not finding autom4te.On the OSX server machine I have no ports installed, just XCode 4.4.1AlexAlex: automake 1.11.3 and autoconf 2.68, built from sources. Do you have a /Developer even if you have Xcode 4.4.1? The latest Xcode installs from the Mac App Store, as a normal self-contained app, as /Applications/Xcode.app, with tverything then under that. At least, that's how it is for me. (Under /Developer I only have some minor leftovers from MonoTouch.) If you have an older version of Xcode, I think automake and autoconf should be present in /usr/bin if you make sure you install the "command-line tools" from inside Xcode. (This no longer happens with the later Xcode versions, for some reason they left out automake and autoconf from the "command-line tools".)(In reply to)Yes, I was previously building on the same machine under OSX 10.6 with XCode 3.2, then upgraded to 10.8 and XCode 4.4.1, so there appear to be quite a lot of /Developer "leftovers" (in fact what looks like most of the /usr/bin file structure for Unix build tools).Yep, noticed that too, and judging from the comments, made a fair few people unhappy in the process.I definitely don't have those tools in /usr or /usr/bin, so will simply try copying them from /Developer/usr/ over to the corresponding directories, then update automake/autoconf as necessary.Alex(In reply to)OK, sussed it, the copy over from /Developer/usr seems to have done the trick. Onto building.Thanks for your help.AlexAlex: Great you can build! the bt you'll be able to generate with --enable-symbols will be very useful.About LO building process on Mac, I just thought it could be useful to have this kind of info (encountered errors, solution, what to check) there:Obviously, the most important first would be the content not the format.Since you've got a Mac and are interested about building, would you be volunteer for updating wiki?The interesting point is since you're not a developer (as you said! :-)), you may mention explicitely elements that could be implicit for a dev.Of course, nothing mandatory here since you're already doing a great QA job for Base part at least and I know too much that time isn't an expandable resource!:-)(In reply to)Hi Julien,I will have a look, but anything I add will be specific to my own particular circumstances I guess.AlexCan somebody give *exact* reproduction instructions with LibreOffice 3.6.1 on Mac OS X 10.8.1? Preferably using only the OS's own accessibility tools. I have tried with VoiceOver but no crash.(In reply to)I have only Mac OS X 10.6.8, and can reproduce the crash only with the help of some 3rd party accessibility-related utility (see below), but here are two step-by-step procedures which crash both LibO 3.6.1 and the current master build (I can give more such step-by-step procedures if necessary):I) Adding a cell border in Calc (cf.,)----------------------------------------------------------0) Rename your LibO user profile folder, to make sure that there is no influence of any special settings on the test (I always do so before such tests).1) Start LibreOffice; -> the Start Center window appears.2) In the Start Center window, click "Spreadsheet"; -> a new spreadsheet document is created, cell A1 is already selected.3) Select "Format > Cells..." from the menu; -> the "Format Cells" dialog window appears.4) Select the tab "Borders".5) At top left, under "Line Arrangement" / "Default", select the second item ("Set all four borders"); -> the border preview below changes.6) Click "OK". -> LibreOffice crashes.II) Selecting a pane in the application Options window (cf.,, and probably)--------------------------------------------------------0) Rename your LibO user profile folder, to make sure that there is no influence of any special settings on the test (I always do so before such tests).1) Start LibreOffice; -> the Start Center window appears.2) Select "LibreOffice > Preferences..." from the menu; -> the "Options" dialog window appears.3) In the list at the left side of the window, click on any top-level entry -- I mean, one of the entries "Load/Save", "Language Settings", "LibreOffice Base", "Charts", "Internet", which can be unfolded to show the sub-entries. -> Most times LibreOffice will crash now; if not, click on another top-level entry. It _may_ be necessary that the top-level entry is not unfolded, but closed before you click on it.Sorry, this is my big problem: I have never managed to reproduce these crashes with the OS's own accessibility tools only; strange (maybe this depends on the Mac OS version? most reports mention Mac OS X 10.7). But I can reproduce the same crashes as reported by the users when I install some window-management utility like Moom, Cinch, RightZoom, ShiftIt, BetterSnapTool ... which all rely on accessibility features.For the tests given above, I have used RightZoom. What I did:1) Download it, e.g. from2) Install it.3) Start the application "RightZoom".4) In the 2nd tab "Applications", select "Enable RightZoom in all applications".5) In the 1st tab, check "Activate RightZoom" and click on "Apply".6) Quit the RightZoom application.7) You can now check in the Terminal via "top", if the Daemon (with the same name: RightZoom) is running.z) Later: To remove RightZoom again: start the application; in the 1st tab, check "Activate RightZoom"; click "Apply".I would guess that the best candidate is not "VoiceOver", but "Enable access for assistive devices"; this option is the one which is mentioned in most bug reports.OK, thanks, now I got it to crash, with Right Zoom active.But that was the TDF build of 3.6.1. A self-build of master (built with Clang from Xcode 4.4.1, with debugging information) did not crash, sigh. I will juggle my build tres a bit (I am a bit short on disk space on my Mac) and build a 3.6.1 with the old Xcode 3.2.6 and 10.4 SDK, gcc 4.0, with debugging... that should correspond to the TDF build.(It indeed seems essential to clean out your Library/Application Support/LibreOffice folder between testing different builds of LO for the crash to happen, for some reason.)Anyway, FWIW, for me slot 1 in the backtrace is svx::a11y::AccFrameSelector::LinkStubWindowEventListener(VclSimpleEvent*)+130 (slot 0 is all zeros, as in).I built the 3.6 branch with --enable-debug, and reproduced.This indeed is some kind of lifecycle management issue. It seems that svx::a11y::AccFrameSelector::WindowEventListener() in svx/source/accessibility/AccessibleFrameSelector.cxx (defined with the IMPL_LINK macro) gets called after the AccFrameSelector object in question has been destroyed.Some debugging output:AccFrameSelector::AccFrameSelector() this=0xc584b60AccFrameSelector::AccFrameSelector() this=0xc584de0 <= constructorAccFrameSelector::AccFrameSelector() this=0xc43a0e4AccFrameSelector::AccFrameSelector() this=0xc43a364AccFrameSelector::AccFrameSelector() this=0xc43a5e4AccFrameSelector::AccFrameSelector() this=0xc43a864AccFrameSelector::AccFrameSelector() this=0xc43aae4AccFrameSelector::WindowEventListener() this=0xc584b60AccFrameSelector::WindowEventListener() this=0xc584de0AccFrameSelector::WindowEventListener() this=0xc43a0e4AccFrameSelector::WindowEventListener() this=0xc43a364AccFrameSelector::WindowEventListener() this=0xc43a5e4AccFrameSelector::WindowEventListener() this=0xc43a864AccFrameSelector::WindowEventListener() this=0xc43aae4AccFrameSelector::~AccFrameSelector() this=0xc584de0 <= destructorAccFrameSelector::~AccFrameSelector() this=0xc584de0 returningAccFrameSelector::~AccFrameSelector() this=0xc43a0e4AccFrameSelector::~AccFrameSelector() this=0xc43a0e4 returningAccFrameSelector::~AccFrameSelector() this=0xc43a364AccFrameSelector::~AccFrameSelector() this=0xc43a364 returningAccFrameSelector::~AccFrameSelector() this=0xc43a5e4AccFrameSelector::~AccFrameSelector() this=0xc43a5e4 returningAccFrameSelector::~AccFrameSelector() this=0xc43a864AccFrameSelector::~AccFrameSelector() this=0xc43a864 returningAccFrameSelector::~AccFrameSelector() this=0xc43aae4AccFrameSelector::~AccFrameSelector() this=0xc43aae4 returningAccFrameSelector::WindowEventListener() this=0xc584b60AccFrameSelector::ProcessWindowEvent() this=0xc584b60AccFrameSelector::WindowEventListener() this=0xc584de0Program received signal EXC_BAD_ACCESS, Could not access memory.backtrace:#0 0x00000000 in ?? ()#1 0x23a3567f in svx::a11y::AccFrameSelector::WindowEventListener (this=0xc584de0, pEvent=0xbfffdccc) at /Users/tml/lo/tdf/svx/source/accessibility/AccessibleFrameSelector.cxx:659#2 0x23a356a2 in svx::a11y::AccFrameSelector::LinkStubWindowEventListener (pThis=0xc584de0, pCaller=0xbfffdccc) at /Users/tml/lo/tdf/svx/source/accessibility/AccessibleFrameSelector.cxx:648#3 0x032a2b9b in Link::Call (this=0xbd10fb8, pCaller=0xbfffdccc) at link.hxx:143#4 0x032c8627 in VclEventListeners::Call (this=0x22736750, pEvent=0xbfffdccc) at /Users/tml/lo/tdf/vcl/source/app/vclevent.cxx:75#5 0x0364751d in Window::CallEventListeners (this=0x739a6ec, nEvent=1, pData=0x0) at /Users/tml/lo/tdf/vcl/source/window/window.cxx:5184#6 0x0364761f in Window::ImplCallEventListeners (this=0x739a6ec, nEvent=1, pData=0x0) at /Users/tml/lo/tdf/vcl/source/window/window.cxx:5167#7 0x03662ba0 in Window::~Window (this=0x739a6ec) at /Users/tml/lo/tdf/vcl/source/window/window.cxx:4210#8 0x032efda2 in Control::~Control (this=0x739a6ec) at /Users/tml/lo/tdf/vcl/source/control/ctrl.cxx:91#9 0x23b01d49 in svx::FrameSelector::~FrameSelector (this=0x739a6ec) at /Users/tml/lo/tdf/svx/source/dialog/frmsel.cxx:789#10 0x25a21dd5 in SvxBorderTabPage::~SvxBorderTabPage (this=0x739a000) at /Users/tml/lo/tdf/cui/source/tabpages/border.cxx:333#11 0x00ce9d92 in SfxTabDialog::~SfxTabDialog (this=0x6b43e00) at /Users/tml/lo/tdf/sfx2/source/dialog/tabdlg.cxx:495#12 0x22b69f0a in ScAttrDlg::~ScAttrDlg (this=0x6b43e00) at /Users/tml/lo/tdf/sc/source/ui/attrdlg/attrdlg.cxx:93#13 0x22b6ea42 in AbstractTabDialog_Impl::~AbstractTabDialog_Impl (this=0x227d5db0) at /Users/tml/lo/tdf/sc/source/ui/attrdlg/scdlgfact.cxx:126#14 0x2062da22 in ScTabViewShell::ExecuteCellFormatDlg (this=0x6adf800, rReq=@0xbfffecd0, nTabPage=65535) at /Users/tml/lo/tdf/sc/source/ui/view/tabvwsha.cxx:539#15 0x205486a1 in ScCellShell::Execute (this=0x127e96a0, rReq=@0xbfffecd0) at /Users/tml/lo/tdf/sc/source/ui/view/cellsh3.cxx:357#16 0x2052fa50 in SfxStubScCellShellExecute (pShell=0x127e96a0, rReq=@0xbfffecd0) at scslots.hxx:6331#17 0x00c5db70 in SfxShell::CallExec (this=0x127e96a0, pFunc=0x2052fa38 <SfxStubScCellShellExecute(SfxShell*, SfxRequest&)>, rReq=@0xbfffecd0) at shell.hxx:199#18 0x00c47752 in SfxDispatcher::Call_Impl (this=0x12717a10, rShell=@0x127e96a0, rSlot=@0x20a5c244, rReq=@0xbfffecd0, bRecord=1 '\001') at /Users/tml/lo/tdf/sfx2/source/control/dispatch.cxx:260#19 0x00c47a8d in SfxDispatcher::_Execute (this=0x12717a10, rShell=@0x127e96a0, rSlot=@0x20a5c244, rReq=@0xbfffecd0, eCallMode=4) at /Users/tml/lo/tdf/sfx2/source/control/dispatch.cxx:943#20 0x00c3d196 in SfxBindings::Execute_Impl (this=0x1271b5e0, aReq=@0xbfffecd0, pSlot=0x20a5c244, pShell=0x127e96a0) at /Users/tml/lo/tdf/sfx2/source/control/bindings.cxx:1284#21 0x00c669eb in SfxDispatchController_Impl::dispatch (this=0x226ce850, aURL=@0xbfffee38, aArgs=@0xbfffee7c, rListener=@0xbfffeddc) at /Users/tml/lo/tdf/sfx2/source/control/unoctitm.cxx:748#22 0x00c67172 in SfxOfficeDispatch::dispatch (this=0xc57ec68, aURL=@0xbfffee38, aArgs=@0xbfffee7c) at /Users/tml/lo/tdf/sfx2/source/control/unoctitm.cxx:377#23 0x0ca93db2 in framework::MenuBarManager::Select (this=0xc4509d8, pMenu=0xbd045d0) at /Users/tml/lo/tdf/framework/source/uielement/menubarmanager.cxx:1154#24 0x0ca93e76 in framework::MenuBarManager::LinkStubSelect (pThis=0xc4509d8, pCaller=0xbd045d0) at /Users/tml/lo/tdf/framework/source/uielement/menubarmanager.cxx:1086#25 0x032a2b9b in Link::Call (this=0xbd04604, pCaller=0xbd045d0) at link.hxx:143#26 0x035c4bca in Menu::Select (this=0xbd045d0) at /Users/tml/lo/tdf/vcl/source/window/menu.cxx:1135#27 0x035bf2e8 in Menu::ImplCallSelect (this=0xbd045d0) at /Users/tml/lo/tdf/vcl/source/window/menu.cxx:2978#28 0x035bf308 in Menu::LinkStubImplCallSelect (pThis=0xbd045d0, pCaller=0x0) at /Users/tml/lo/tdf/vcl/source/window/menu.cxx:2975#29 0x032a2b9b in Link::Call (this=0x227b6b20, pCaller=0x0) at link.hxx:143#30 0x0366e816 in ImplHandleUserEvent (pSVEvent=0x227d2f20) at /Users/tml/lo/tdf/vcl/source/window/winproc.cxx:2003#31 0x036714fb in ImplWindowFrameProc (pWindow=0x6407310, nEvent=22, pEvent=0x227d2f20) at /Users/tml/lo/tdf/vcl/source/window/winproc.cxx:2575#32 0x036823dd in SalFrame::CallCallback (this=0x64070d0, nEvent=22, pEvent=0x227d2f20) at salframe.hxx:281#33 0x03681c9f in AquaSalInstance::Yield (this=0x78b2020, bWait=true, bHandleAllCurrentEvents=false) at /Users/tml/lo/tdf/vcl/aqua/source/app/salinst.cxx:735#34 0x032b3b2b in ImplYield (i_bWait=true, i_bAllEvents=false) at /Users/tml/lo/tdf/vcl/source/app/svapp.cxx:451#35 0x032b01a8 in Application::Yield (i_bAllEvents=false) at /Users/tml/lo/tdf/vcl/source/app/svapp.cxx:485#36 0x032b01d0 in Application::Execute () at /Users/tml/lo/tdf/vcl/source/app/svapp.cxx:430#37 0x000fcd61 in desktop::Desktop::Main (this=0xbffff950) at /Users/tml/lo/tdf/desktop/source/app/app.cxx:1715#38 0x032bbb6f in ImplSVMain () at /Users/tml/lo/tdf/vcl/source/app/svmain.cxx:183#39 0x03680ccf in AquaSalInstance::handleAppDefinedEvent (pEvent=0x64b5ec0) at /Users/tml/lo/tdf/vcl/aqua/source/app/salinst.cxx:606#40 0x036dcdd6 in -[VCL_NSApplication sendEvent:] (self=0x7860d30, _cmd=0x91847963, pEvent=0x64b5ec0) at /Users/tml/lo/tdf/vcl/aqua/source/app/vclnsapp.mm:69#41 0x90fe373c in -[NSApplication run] ()#42 0x90f868e6 in NSApplicationMain ()#43 0x0367e8fd in ImplSVMainHook (pnInit=0xbffff90c) at /Users/tml/lo/tdf/vcl/aqua/source/app/salinst.cxx:243#44 0x032bbc9f in SVMain () at /Users/tml/lo/tdf/vcl/source/app/svmain.cxx:217#45 0x0012c855 in soffice_main () at /Users/tml/lo/tdf/desktop/source/app/sofficemain.cxx:85#46 0x00001f26 in sal_main () at /Users/tml/lo/tdf/desktop/source/app/main.c:34#47 0x00001f0e in main (argc=1, argv=0xbffffa3c) at /Users/tml/lo/tdf/desktop/source/app/main.c:33I am a bit clueless about how this LINK stuff works, but will try to see what I can figure out...(It's fun that googling for related stuff, I found some OOo experts calling the LINK mechanism obsolete or old already in 2003...)The problem turned out to be pretty trivial and localized after all. (I am not sure if using valgrind would have helped much, but anyway, valgrind does not work on OS X 10.8, not even a bleeding edge svn version.)The problem is that in the AccFrameSelector destructor RemoveEventListener is called, but only if the mpFrameSel member is non-null. Unfortunately, in the Invalidate() method mpFrameSel is set to zero but the event listener is not removed. So when the object is destructed, as mpFrameSel is null, the event listener does not get removed, but stays active, even if associated with a dead object.The solution is to remove the event listener also in Invalidate(). I added a new tiny function for that.CreatedSuggested patchPushed to master, verifying and cherry-picking appreciated.Tor Lillqvist committed a patch related to this issue.It has been pushed to "master":fdo#47368: Remove event listener also in Invalidate()The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.The above patch fixes only the I) case in.For case II, there is an *awful* lot of recursion going on in hitTestRunner(). By an odd coincidence (?), the recursion ends before the thread runs out of stack space though. But then some thirty call stack slots deeper it does, anyway:#0 0x91aa5ef1 in pthread_mutex_lock ()#1 0x000068f9 in osl_acquireMutex (Mutex=0x787e6e0) at /Users/tml/lo/tdf/sal/osl/unx/mutex.c:123#2 0x00821801 in osl::Mutex::acquire (this=0x787e6d0) at mutex.hxx:67#3 0x0082e4f7 in osl::Guard<osl::Mutex>::Guard (this=0xbf80011c, t=@0x787e6d0) at mutex.hxx:153#4 0x008c3940 in com::sun::star::uno::WeakReferenceHelper::get (this=0x257dd3f4) at /Users/tml/lo/tdf/cppuhelper/source/weak.cxx:521#5 0x0083d00d in com::sun::star::uno::WeakReferenceHelper::operator com::sun::star::uno::Reference<com::sun::star::uno::XInterface> (this=0x257dd3f4) at weakref.hxx:108#6 0x008c3c23 in cppu::OWeakAggObject::acquire (this=0x257dd3e0) at /Users/tml/lo/tdf/cppuhelper/source/weak.cxx:269#7 0x00879bbb in cppu::WeakAggComponentImplHelperBase::acquire (this=0x257dd3e0) at /Users/tml/lo/tdf/cppuhelper/source/implbase.cxx:367#8 0x235e48d3 in cppu::WeakAggComponentImplHelper8<com::sun::star::accessibility::XAccessible, com::sun::star::accessibility::XAccessibleContext, com::sun::star::accessibility::XAccessibleComponent, com::sun::star::accessibility::XAccessibleEventBroadcaster, com::sun::star::accessibility::XAccessibleAction, com::sun::star::accessibility::XAccessibleSelection, com::sun::star::accessibility::XAccessibleText, com::sun::star::lang::XServiceInfo>::acquire (this=0x257dd3e0) at compbase8.hxx:158#9 0x0082189a in com::sun::star::uno::cpp_acquire (pCppI=0x257dd3e0) at genfunc.hxx:48#10 0x0071f77d in cppu::_acquire (p=0x257dd3e0, acquire=0x821882 <com::sun::star::uno::cpp_acquire(void*)>) at prim.hxx:88#11 0x0073dae2 in cppu::_copyConstructAnyFromData (pDestAny=0xbf8004d0, pSource=0xbf800370, pType=0x787fb50, pTypeDescr=0x0, acquire=0x821882 <com::sun::star::uno::cpp_acquire(void*)>, mapping=0x0) at copy.hxx:329#12 0x0071d015 in cppu::_copyConstructAny (pDestAny=0xbf8004d0, pSource=0xbf800370, pType=0x787fb50, pTypeDescr=0x0, acquire=0x821882 <com::sun::star::uno::cpp_acquire(void*)>, mapping=0x0) at copy.hxx:371#13 0x0071c888 in uno_type_any_construct (pDest=0xbf8004d0, pSource=0xbf800370, pType=0x787fb50, acquire=0x821882 <com::sun::star::uno::cpp_acquire(void*)>) at /Users/tml/lo/tdf/cppu/source/uno/any.cxx:81#14 0x0082d253 in com::sun::star::uno::Any::Any (this=0xbf8004d0, pData_=0xbf800370, rType=@0x63ba148) at Any.hxx:81#15 0x008c5d34 in cppu::queryInterface<com::sun::star::uno::XInterface, com::sun::star::uno::XAggregation, com::sun::star::uno::XWeak> (rType=@0x63ba148, p1=0x257dd3e0, p2=0x257dd3f0, p3=0x257dd3e0) at queryinterface.hxx:102#16 0x008c49e8 in cppu::OWeakAggObject::queryAggregation (this=0x257dd3e0, rType=@0x63ba148) at /Users/tml/lo/tdf/cppuhelper/source/weak.cxx:300#17 0x0087aa83 in cppu::WeakAggComponentImplHelperBase::queryAggregation (this=0x257dd3e0, rType=@0x63ba148) at /Users/tml/lo/tdf/cppuhelper/source/implbase.cxx:361#18 0x0087c63c in cppu::WeakAggComponentImplHelper_queryAgg (rType=@0x63ba148, cd=0x236ae180, that=0x257dd3e0, pBase=0x257dd3e0) at /Users/tml/lo/tdf/cppuhelper/source/implbase_ex.cxx:451#19 0x235e4aad in cppu::WeakAggComponentImplHelper8<com::sun::star::accessibility::XAccessible, com::sun::star::accessibility::XAccessibleContext, com::sun::star::accessibility::XAccessibleComponent, com::sun::star::accessibility::XAccessibleEventBroadcaster, com::sun::star::accessibility::XAccessibleAction, com::sun::star::accessibility::XAccessibleSelection, com::sun::star::accessibility::XAccessibleText, com::sun::star::lang::XServiceInfo>::queryAggregation (this=0x257dd3e0, rType=@0x63ba148) at compbase8.hxx:156#20 0x008c3b69 in cppu::OWeakAggObject::queryInterface (this=0x257dd3e0, rType=@0x63ba148) at /Users/tml/lo/tdf/cppuhelper/source/weak.cxx:290#21 0x00879b9e in cppu::WeakAggComponentImplHelperBase::queryInterface (this=0x257dd3e0, rType=@0x63ba148) at /Users/tml/lo/tdf/cppuhelper/source/implbase.cxx:350#22 0x235e4848 in cppu::WeakAggComponentImplHelper8<com::sun::star::accessibility::XAccessible, com::sun::star::accessibility::XAccessibleContext, com::sun::star::accessibility::XAccessibleComponent, com::sun::star::accessibility::XAccessibleEventBroadcaster, com::sun::star::accessibility::XAccessibleAction, com::sun::star::accessibility::XAccessibleSelection, com::sun::star::accessibility::XAccessibleText, com::sun::star::lang::XServiceInfo>::queryInterface (this=0x257dd3e0, rType=@0x63ba148) at compbase8.hxx:154#23 0x0082644d in com::sun::star::uno::BaseReference::iquery (pInterface=0x257dd410, rType=@0x63ba148) at Reference.hxx:52#24 0x008c5b31 in com::sun::star::uno::Reference<com::sun::star::uno::XWeak>::iquery (pInterface=0x257dd410) at Reference.hxx:67#25 0x008c5da4 in com::sun::star::uno::Reference<com::sun::star::uno::XWeak>::query (rRef=@0xbf80067c) at Reference.hxx:351#26 0x008c4a48 in com::sun::star::uno::OWeakRefListener::OWeakRefListener (this=0x26861270, xInt=@0xbf80067c) at /Users/tml/lo/tdf/cppuhelper/source/weak.cxx:374#27 0x008c5067 in com::sun::star::uno::WeakReferenceHelper::WeakReferenceHelper (this=0x257dd538, xInt=@0xbf80067c) at /Users/tml/lo/tdf/cppuhelper/source/weak.cxx:448#28 0x235e31f6 in com::sun::star::uno::WeakReference<com::sun::star::accessibility::XAccessible>::WeakReference (this=0x257dd538, rRef=@0xbf80067c) at weakref.hxx:142#29 0x235e162c in accessibility::AccessibleListBoxEntry::AccessibleListBoxEntry (this=0x257dd4a0, _rListBox=@0x687832c, _pEntry=0x1f0625c0, _xParent=@0xbf80067c) at /Users/tml/lo/tdf/accessibility/source/extended/accessiblelistboxentry.cxx:86#30 0x235e1b43 in accessibility::AccessibleListBoxEntry::getAccessibleAtPoint (this=0x257dd3e0, _aPoint=@0xbf800704) at /Users/tml/lo/tdf/accessibility/source/extended/accessiblelistboxentry.cxx:483#31 0x036d76f6 in hitTestRunner (point={X = 299, Y = 417}, rxAccessibleContext=@0xbf8007e4) at /Users/tml/lo/tdf/vcl/aqua/source/a11y/aqua11ywrapper.mm:981#32 0x036d78cd in hitTestRunner (point={X = 299, Y = 417}, rxAccessibleContext=@0xbf800894) at /Users/tml/lo/tdf/vcl/aqua/source/a11y/aqua11ywrapper.mm:984#33 0x036d78cd in hitTestRunner (point={X = 299, Y = 417}, rxAccessibleContext=@0xbf800944) at /Users/tml/lo/tdf/vcl/aqua/source/a11y/aqua11ywrapper.mm:984#34 0x036d78cd in hitTestRunner (point={X = 299, Y = 417}, rxAccessibleContext=@0xbf8009f4) at /Users/tml/lo/tdf/vcl/aqua/source/a11y/aqua11ywrapper.mm:984#35 0x036d78cd in hitTestRunner (point={X = 299, Y = 417}, rxAccessibleContext=@0xbf800aa4) at /Users/tml/lo/tdf/vcl/aqua/source/a11y/aqua11ywrapper.mm:984#36 0x036d78cd in hitTestRunner (point={X = 299, Y = 417}, rxAccessibleContext=@0xbf800b54) at /Users/tml/lo/tdf/vcl/aqua/source/a11y/aqua11ywrapper.mm:984#37 0x036d78cd in hitTestRunner (point={X = 299, Y = 417}, rxAccessibleContext=@0xbf800c04) at /Users/tml/lo/tdf/vcl/aqua/source/a11y/aqua11ywrapper.mm:984#38 0x036d78cd in hitTestRunner (point={X = 299, Y = 417}, rxAccessibleContext=@0xbf800cb4) at /Users/tml/lo/tdf/vcl/aqua/source/a11y/aqua11ywrapper.mm:984#39 0x036d78cd in hitTestRunner (point={X = 299, Y = 417}, rxAccessibleContext=@0xbf800d64) at /Users/tml/lo/tdf/vcl/aqua/source/a11y/aqua11ywrapper.mm:984(*thousands* of hitTestRunner slots below that, gdb just prints and prints line after line, I didn't have the patience to wait if it ever stops... Or maybe gdb gets totally confused by something.)Anyway,(gdb) p $esp$7 = (void *) 0xbf7ffff0and the stack bottom is at 0xbf800000:Stack bf800000-bf96d000 [ 1460K] rw-/rwx SM=COW thread 0Running gdb on the TDF build of 3.6.1, getting a backtrace through all the levels of hitTestRunner recursion is a lot faster (as there is no debugging info, it doesn't have any parameter values or source file locations to print out). It took only some tens of seconds, and around 58000 stack levels up it is out of the recursion;) So gdb does not seem to be confused, there really *is* an unbelievable amount of recursion going on here... Well, even if gdb is not confused, *I* certainly am.Ah, sorry, I am an idiot, of course there is no odd coincidence going on, the recursion has not ended, it just happens to be relatively deep in a call from hitTestRunner() when it runs out of stack. So the real problem is indeed to figure out why the recursion is infinite.(In reply to)couldbe related ?Perhaps, but by itself that change does not help.I tried various ways in hitTestRunner() to figure out if the recursion is going to be infinite, but without success. Of course, I have no clue what this code actually is doing... but clearly in some way it thinks that it is recursing down into children but in fact it isn't, it's all the time staying at the same "level". Or something. Sigh.Actually it is not a good thing at all that we have this one bug report for several unrelated crashes (with the only relation being that they happen only if some accessibility tool is turned on). After all, we don't bundle all other crashes into one bug report "crashes when accessibility tools are not enabled" either, do we?The bug described by case I) inis now fixed (in master), to tbe best of my understanding. But case II) is not. No idea about all the other unrelated crashes that this bug might be about.Yes, something seems to be going wrong here, that can't be handled that way as Tor explained, currently it's very difficult to keep overview what problems already have been fixed for what versions and what other ones still are waiting for a fix.IMHO we should- Make this one (or a different one) a Task bug for tracking these problems- Leave those DUPs what have only a very general description "crashes when accessibility enabled " as DUPS of the task bug- Change many oft the other DUPs what have a detailed description concerning the roots of the crashes from "DUP of" to "Blocks Task Bug", so that we have a separate Bug report for each bug causing such a crash.I have too few knowledge concerning details so that I can't do the job.Tor Lillqvist committed a patch related to this issue.It has been pushed to "libreoffice-3-6":fdo#47368: Remove event listener also in Invalidate()It will be available in LibreOffice 3.6.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.nice work Tor - sorry for the confused bug; we had a lot of a11y related issues stacked on top of each other here I guess. I pushed the patch to -3-6; I wonder if fixing case II nails the rest of these ;-) I suspect this may be the bug that never dies. Nevertheless if we can fix case II, then I guess we can keep this closed and re-assess duplicates as/when they get re-opened vs. more recent versions.Createdpotential infinite recursion fix (?)I couldn't correlate your line-numbers with mine; but if the recursion happens in the first hitTest - then it's possible that if the getAccessibleAtPoint returns the same AccessibleContext as the one we're passed we'll hit an infinite loop. Any chance of testing the attached ? :-)Createda new patchFirst of all: *** Many many thanks to Tor *** *** for his great debugging work! *** *******************************(In reply to)You are completey right. This problem (the confused bug report) has historical reasons: at the beginning, simple-minded QA volunteers like me thought that we really had only one bug with some duplicates; as time went by, we realized that more than one bug was involved, maybe a complete rat nest of bugs, but it was already so common to mark all Mac accesibility related issues as duplicates of this bug that no one wanted to change this procedure ...IIRC many of the Mac accesibility bug reports show similar stack traces, therefore I still hope that we don’t have 30 or more different Mac accesibility related bugs, but a small number of bugs, each of them with many duplicates.But to find out about this, and to make it easier to fix the remaining issues, it seems necessary that we QA folks follow Rainer’s suggestion:(In reply to)Having already spent much time with all these different Mac accesibility related issues, and therefore knowing most of them,I can take this job, ifa) I get some approval to do so (we should not have two people do the same job at the same time ;-), andb) we are willing to wait some days -- browsing all the related bug reports and sorting them will take quite some time ...Should I begin?Michael Meeks committed a patch related to this issue.It has been pushed to "master":fdo#47368: Fix for infinite recursionThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Meeks committed a patch related to this issue.It has been pushed to "libreoffice-3-6":fdo#47368: Fix for infinite recursionIt will be available in LibreOffice 3.6.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Roman: Your offer sounds lovely, thanks!Do we have daily builds of the 3.6 branch for the Mac? If not, I could also send you the new versions of the two .dylib files in question that you could replace the ones inside the TDF 3.6.1 .app with to test... (Assuming that works.)Agreed - many thanks to Tor ! :-)The fixes should be in 3.6.2rc1 which is just coming up for freeze, and then (IIRC) we should have 2x weeks to nail down exactly which of these we did in fact fix - and split the rest out of this bug.I'd rather like to mark it fixed however at this point :-)(In reply to)Thank you for the answer! OK, I will take it ...Thank you for your offer! But luckily, we have Mac daily builds of the 3.6 branch at-- so no library replacement is necessary.I want to share some GOOD NEWS with you:Testing our LibreOffice 3.6 daily builds, I can still reproduce both issues, I and II (see), with LibreOffice 3.6.2.0+ (Build ID: cfbfa26) Pull time: 2012-09-07 10:35:10But I can NOT reproduce them anymore, at least not by the easy steps listed in, with LibreOffice 3.6.2.0+ (Build ID: c303961) Pull time: 2012-09-11 08:49:57This is the first daily build which includes Tor's and Michael's fixes (seeand). This means very probably that the roots of both crashes I and II have been really fixed, once and forever.So: thank you very much again, Tor and Michael!More good news:While I am still sorting all the possibly related issues (cf.,; please be patient, I will upcome with a comprehensive and well-sorted list soon!), I can already say that many of these issues are so similar to our test cases I and II, that there are good chances that many of them have been fixed, too, by these two patches.Roman - that -is- great news :-) I'm going to close this FIXED then until further notice; any new a11y bugs we should split out into their own new trackers :-)Many thanks for testing & for all who reported bugs, and helped to find a solution - much appreciated !***has been marked as a duplicate of this bug. ***A little update:I have to ask you all for some patience. Since 3 days, I am sorting and testing all known bugs which are (or could be) related to Mac OS accessibility features. It will take me some more days to complete this survey, because I need to test every bug with at least 4 different LibO builds, and often the steps to reproduce a bug are not very easy to understand. I am leaving a detailed comment about my results in every bug report, so you can see which bugs have already been revisited.My plan is (simplified!):* Every bug which was reproducible with LibO 3.6.1 and LOdev master BEFORE Tor’s and Michael’s two patches (which fixed the two issues listed here in), but is NOT reproducible anymore AFTER these patches have been applied, should stay marked as a duplicate of the present bug; because if it was fixed by the same patches, it had the same roots.* Every bug which is still reproducible AFTER these two patches have been applied will be reopened. If some of them are related to each other, I will to try to group them by marking them as duplicates of each other, etc.* Other bugs (which I can’t reproduce or are very unclear) will be reopened or set to NEEDINFO, depending on the specific bug situation.* After completing my survey, I will create a new task bug -- this time a real straightforward task bug, similar to our MAB bugs --, to which I will add as “Depends on” all remaining issues, so that we can easily track them down.(I will NOT use the present bug report as task bug, because it is already far too long and confused.)The idea is to find out which bugs are related and which are not, so that at the end we will NOT have yet another confused task bug with 30 or so singular bugs in the "Depends on field", but a simple and clean task bug which only lists (hopefully) 5 or 6 remaining issues, all well-sorted and well-documented.If you want to discuss about this, please write to me directly at, or discuss this on the QA mailing list. The present bug report, already far too long, is IMHO not a good place to do so ;-)So, again: please be patient.***has been marked as a duplicate of this bug. ***CreatedHTML document: “Results of a survey of all LibreOffice bug reports related to Mac OS X accessibility features”Results of a survey of all known LibreOffice bug reportsrelated to Mac OS X accessibility features--------------------------------------------------------Attached to this comment you will find a detailed summary of my test results (document in HTML format). Here are the most important points:* According to my test results, Tor’s and Michael’s patches have truly fixed “[m]any crashes when accessibility enabled on Mac OS X” ;–):,,,,,,,,,,,,,,, and maybe some more. So all these bug reports are duplicates of the present one. * The following bugs are no longer reproducible with LibreOffice 3.6.1:,,,,,,,,. * Bugs set to NEEDINFO status:,,,,. * Bugs still reproducible (status NEW or REOPENED):(duplicate:),(with some unclear duplicates).These results are very encouraging; they mean that Tor’s and Michael’s patches have improved the situation strongly. So thanks again to Tor and Michael!*These results also confirm that the present bug is (and should stay) RESOLVED FIXED. So please do NOT open the present bug report again!If you can reproduce any bug related to Mac OS X accessibility features with LibreOffice >= 3.6.2, please check first if it is the same issue as any of the bugs listed above as NEW/REOPENED (,) or as NEEDINFO (,,,,).-- If yes, please add an additional comment to the particular bug report, if you can contribute some useful information about the issue.-- If no, please file a new bug report for the issue.Thank you!A last update:In, I announced to create “a new task bug -- this time a real straightforward task bug, similar to our MAB bugs --, to which I will add as ‘Depends on’ all remaining issues, so that we can easily track them down.”This tracking bug has now been created; it is, to which all new important bugs related to the Mac accessibility API should be added.At the moment, there is only one NEW issue listed there; all other known issues are either fixed or no longer reproducible or in NEEDINFO status.To make it easier to see even for newbies, that the present bug should not be opened again, I set its status to CLOSED/FIXED.Thank you all, and see you (if necessary) on! ;-)
id=46447	Since several versions, and also in previously used openoffice versions, and at least for all 3.x versions I had, the presentation module Impress shows the following bug which completely ruins any given presentation. This bug occurs on a regular basis - usually once every presentation I generate:For no specific reason, suddenly, images which have been embedded (not linked) into a presentation 'disappeare' with only a 'missing-link' placeholder displayed instead of the image in the editing mode of Impress.Once this behavior occurs, the presentation is irreversibly damaged and is in a state of unpredictable behavior.In particular, the obvious first choice for a fix, namely to simply delete the missing links and re-embed the images regularly leads to chaotic and additional disappearance of more images in the presentation.A minimalistic example of such a presentation, showing only one missing image is attached.The unpacked ODP files of such presentations always display the same pattern regarding this issue:In the unpacked file noLinkErr.odp without the bugand in the directory 'Pictures' one finds the relevant image "10000000000001F4000001F0BC3B6675.gif" in the present case,while in the XML file content.xml one finds a markup which links to that image<draw:image xlink:href="Pictures/10000000000001F4000001F0BC3B6675.gif" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad">In the unpacked file LinkErr.odp with the bugthe relevant image is missing in the directory 'Pictures'and in the XML File content.xml the markup which should link to the image reads only<draw:image xlink:href="">For me the only way to 'avoid' this error is to keep a long list of incrementally saved backup versions of any presentation I generate - which is very awkward.wbwb CreatedOriginal presentation and presentation with disappeared image and corrupted ODP fileI believe Thorsten did some work on things like this in 3.5.x can you confirm the problem continues there ? [ and sorry for the horrors here ! ]Observed the exact same problem in 3.5.0rc3.(In reply to)Hi Michael,At a guess, I'd say the problem isn't entirely solved :and I'm still losing images from my own Writer business template documents in 3.5.1.2 and Norbert's daily build from 23/03/2012 (#fdo 33393).AlexThis bug is pretty annoying. I'm currently preparing a presentation and I keep losing and replacing images at least 5 times per day :(. I'm using the LibreOffice version 3.6.2.2 from Ubuntu 12.10. Is there some kind of workaround or fix that reduces the impact of that problem?Also, I think that users should be warned when including images. I've got the habit of deleting figures after embedding, since I expect them to be stored in a document safely. Not being warned about Libre/Openoffice's bad memory can destroy hours of work.@Peter WürtzWelcome to the club.Impress simply is not (and never has been) a top priority on (Ooo)Libreoffice developers' list if it comes to bugs. That is very Very VERY sad, and I think it is a BIG mistake.This way Libreoffice will always remain a niche-product for all of those parts of academia and business where professional presentations influence not only careers but many other things on an every-day basis.Yet, that's how open source development works, namely by how many people 'make noise' to ask for resolution of what bugs.Sad enough there are simply zillions of more users out there who need Libreoffice just as an MSWord/MSExcel replacement rather than as a Powerpoint or KeyNote or MathEditor replacement. So there is just much too little traffic on all those nasty bugs in Impress, and hence too little 'persuasion' for the developers ... even if the bugs are as *absolutely* *devastating* as this bug here.Just for the record: another very 'nice' example of this situation has been Bug 48179 (still Ooo). Check it out. That one was just unbelievable - but, counted together with its duplicates - it has taken more than *7* years to get at least a 'workaround' embedded into Ooo's code base.To summarize, I fear this bug will still be around for a long time ... unless you find some >200 people constantly knocking the door.Just to get it wright by the previously mentioned 'Bug 48179' we meanand not the link which the previous comment produces automatically ;)(In reply to)No Idea what you want to tell with this comment and that linkI see this one more critical than major, nobody can risk to use LibO Impress if he has to be afraid that he will stand in front of audience with a damaged audience. I will nominate this one as HardHack on <>Modified OS due to ALL because reproduced with WIN (see <>!)CreatedValidation ResultsFor reporter's original Sample documentCreatedSample document in valid ODF 1.2for further testsStill happens in 3.6.4.3 ...I see this bug is already reproduced multiple times. Therefore I mark this as NEW. Rainer already set the priority, so nothing to change there.Kind regards,JorenPresent in 4.0 as well, Windows and Linux.I have the same problem. Problem can not be replicated all the time, but when it happens images from Picture folder (in odp archive) disappear, and content.xml shows only "" for href (empty string). Sometimes even OLE objects would disappear and folder Object 1/2/3... will be removed.This bug still occurs in version 4.0.1.2 on Mac OSX and is VERY, VERY annoying.I once a week stand in front of my students displaying slides where some images got lost. This is very embarrassing.This bug drives me crazy, and it will stop me from using Libreoffice very soon.It seems that increasing the memory for images in the options dialog (say from 30 MB to 200 MB) reduces the problem. Nevertheless, the current situation is hardly acceptable.Any chance to get an at least passably reliable test kit?(In reply to)>Seconded - it might easily save me days. Ideally a "do this, do that, and with image cache set to 1k, it happens every time".Try this to see if it helps:1. Copy the slides.2. Paste them on a new empty ODP.As far as I know corruptions tend to happen when we work on old ODPs (probably created by an earlier version of OO or LO) as a template. The above method solve my teachers problem of currupted ODP. Side effect, the new ODP became much smaller (about 10% of the original). Obviously there was a lot of rubbish in the old one.Tedo Vrbanec, please consider:<>If you also did this mistake in other Bugs please undo your Version changes there!And do not do such changes without any comment!(In reply to)I believe he was just trying to say that the bug still exist on 4.0.2.1 rc. I used to think that's how it should be too.Tedo, to do this, better to add a comment like "Still present in 4.0.2.1 rc."Cheers!Yes, my mistake. I apologize.Still present in 4.0.2.1 rc.This has also happened to me, multiple times:- OS X, 10.7.5- Version 4.0.1.2 (Build ID: 84102822e3d61eb989ddd325abf1ac077904985)TinderBox: MacOSX TDF Release, Branch:libreoffice-4-0, Time: 2013-02-27_17:15:43I can't replicate this bug using the noErr attachments fromand. Tested by opening numerous times and re-saving and re-opening using v3.5.7.2 under Ubuntu 10.04 x86_64 and v4.0.2.2 under Ubuntu 10.04 x86_64 and Win7HP. The graphic always displays.This bug is absolutely a show stopper.I stand several times in a week in front of my students with slides where images disappeared. I then have to open my script where the images do not disappear.This is really embarrassing. How can I convince the students like this from using an open source product?I can not understand why such a bug is not critical. Loosing data is even worse than a blocker.It is sure a memory management bug. But with 16 GB I have enough!!I pay the guy that fixes this bug 100 USD!I can send you an example ODP where you can reproduce the bug in 5 minutes.(In reply to)I tried it too with LO 3.6.6 on Win7 and was unable to replicate it as well.I opened noLinkErr.odp, save as another file. Closed LO. Reopen the file. Image is there.I created a new page, copied and pasted the image there. Save. Exit. Reopen, and both images are there.I duplicated both slides. So, now 4 slides with the image. Repeat as above. All images in 4 slides appears.I also resized and moved one image. Same.I've been using Impress quite heavily recently, and have not encountered such a situation before.I also played around with LinkErr.odp. It's as decribed, but I've no trouble adding the same image into it and still have it after reopening it.Sorry. No bug in sight.Finally, after many months of waiting, LO4.0.2 and LO4.3 no longer loses images from the presentation (Debian Wheezy).(In reply to)@Marcus: can you still reproduce this using LibreOffice 4.0.3.3? Followingandit isn't reproducible anymore?Kind regards,Joren(In reply to)So, case closed?(In reply to)It looks like the problem is gone. Thanks a lot!Thanks for the feedback!Lets mark it as RESOLVED FIXED then, although we don't know which commit fixed this issue we can be sure something fixed this behavior (thanks to the many confirmations).Kind regards,JorenPS: there are more NEW and UNCONFIRMED bugs out to (re)test. Feel free to help!This is by no means fixed. I had to give a talk today, and everything was fine when I double-checked half an hour before. So I saved the presentation (LO 4.0.3.1), shut down the laptop, and went to the lecture room. When I started the presentation much to my (unpleasant) surprise, two animated images on the second slide appeared empty with the infamous symbol in the upper left corner. This continued throughout the talk, and (if I am not mistaken) not only for images which were inserted by copy-and-paste. I consider this a showstopper.Windows 4.0.3.3 appears to be okay with some light testing using a new document with various images (saving, closing, re-opening, repeat) as well as old ones that had problems in the past. Will check Linux shortly. I don't think this should be closed as quickly as it was, as a Professor I gave up on using Impress long ago as it was not stable enough for normal use. Many people are probably in the same boat as I am and have resorted to other alternatives, so the pool of people actively testing this now will be smaller.(In reply to)Thank you for providing the details of how it happened.Some questions for you:Were to 2 animated images linked or embedded?Can you replicate the problem?Can you provide the file (or part of it, in which the problem can be replicated) for others to test?LO 4.0.3.3. The bug still exists in writer!!!!!!!! I replace the pictures every time I close and open document. A few days ago something happened and pictures were in the document for good, but I had to chenge the pictures and the problem is here again!!! I change status, becaus it drives me crazy.Ah.. to reproduce just prepare any drawing in Draw and place it in the document in writer. For 100% sure it will disapear add title for teh drawing.Hi @Piotr and @Bringfried Stecklum, one user reported that the bug only exists in files created with older versions of LibreOffice (some sort of old file structure that is not overwritten). If you open a new document and import your old files does it still have a problem.I have been giving lectures with LibreOffice for a couple of years, and this last semester I had no problems. Every time I reuse an old lecture, I open a template that I use and import the old slides in to avoid the above problem. Any way I am curious if it works.(In reply to)I can appreciate your frustrations, Piotr. Same for others experiencing this. I'd be frustrated too if I were you. I thought this bug report is for Impress, not Writer. Yet, perhaps both issues may be based on the same root cause. Besides, similar issues has been reported for Calc (). So, this appears to be a FILESAVE issue, specifically in graphic handling.Anyway, I've just done this: create a square with Draw, copy and paste it in Writer, and Impress. Reopen both files and find them still there.I'm using 3.6.6 (having experienced some issues with LO4). Perhaps affected ones can consider using this version instead. I plan to return to version 4 only when 4.0.4 release is ready.Perhaps in same cases the matter is as suggest by Vossman (), that it's an issue of backward compatibility. His method may solve the matter for some of you.Btw, Piotr, UNCONFIRMED means that "Nobody has confirmed that this bug is valid." It seems pretty confirmed for you. SeeCreatedtest_file_missing_pictureI enclose the file with missing picture. I think it is related to picture title. Without title I was able to keep picture inside the document.Reproduction:1) Paste special picture from draw as "Picture Format"2) save writer file3) open file again (the picture is still visible)4) add title to the picture5) save and close the writer document6) open the writer document - picture is missing. Only empty box with title is shownchange status -> NEWI created the documents from the scratch and the problem still exists. As I open the document with MS Word viewer the pictures are also missing.(In reply to)Perhaps you mean "Drawing format". I don't see "Picture Format".I think you mean "Caption".I can appreciate the confusion we have here because we're using different language versions. (FYI, there is something else called Title, which I get to by right-click > Description.)I tried this on the file you provided with LO3.6.6. I can reproduce and confirm what you reported. HOWEVER, you could have mentioned that you were using DOC! I suggest that you look at, which speaks of the same for DOCX.To everyone else who's making any further reports on this issue, please indicate specific LO version and file type.To all who have reported this for IMPRESS, does anyone of you still have the problem with the latest IMPRESS, or at least 3.6.6? If, yes, please remember to indicate file type.If not, I suggest that we close this.Createdtestcase_opendoc_formatsame test case happens when saving i odg format.Here is example.LO 4.0.4Kumara - You are right about language issues. I simply use polish version and translated the names.However, I do not agree that it is an issue with docx format:1) It is specific to the XML format which does not concern doc2) I enclosed attachement showing that the same happens when You save to odg format.sorry - i made mistake in version which should be 4.0.3You provided an ODT file (not ODG).Started happening to me today LO Impress 4.0.2.2(In reply to)Try the latest LibreOffice 4.0.4 at www.libreoffice.org/download/and see if the problem is still there."Pictures not saved to .pptx" is reportedly fixed.Version 4.0.4.2 (Build ID: 9e9821abd0ffdbc09cd8c52eaa574fa09eb08f2)Still happening. I have had pictures disappear multiple times to the point where I can't risk it happening when I open the presentation to do it for real.Don't want to use Powerpoint, but don't feel there is much choice.(In reply to)Why not save it as ODP? I've been using since StarOffice and have never meet with such a problem.(In reply to)I experience the same issue, even when I save my presentation as ODP.As long as this issue has not been fixed, LO Impress not useable at all to me.(In reply to)Would you mind uploading the file for us to have a look?And indeed, if anyone has this problem:- pls provide file (version before and after the problem would be great :) )- information about files origin (LibreOffice version)- information about LibreOffice version working withthanks,Cor***has been marked as a duplicate of this bug. ***Also I have experienced this many times, most recently withlibreoffice-impress-4.1.0.1-3.fc19.x86_64contains a recent example of a file.(In reply to)Note that comments,and #12 there contain at least some pointers as for the situation:10: " mostly to the images that are copy&pasted few times within a document. And only after saving, and trying to read again."11: " this happens only, but always, when I copy&paste pictures directly from ANY MS Word 2010 or MS PowerPoint 2010 document.Happens not when doing Copy&Paste from Gimp or Adobe Reader for example. "12: " It is likely that it happens during autosave. "Nice summary in previous comment, but I don't agree with #11.I have this under linux with images taken from acroread.(In reply to)Good to see some ideas about this. I wasn't wondering what you were talking about until I figured you were referring to comments at.I've tested bug3.odp (Impress file with the images gone.) from there, and notice that the ones that are gone are strangely different from the one that is present. You can try rightclick on the placeholder, then "Original Size". It becomes very large and unwieldy. My hunch is that it has to do withfrom 50051 (as you quoted above). Can someone with those apps confirm?(In reply to)Oops... I meant "I was wondering..."Anyway, I tested the other file there and found the same.Request info: From where were those missing images copied from?This feature just happened to me as well... Ubuntu 12.10 LO v. 3.6.2.2 build ID: 360m1(build:2). Never had that happen to me before for > 6 months. Now I used an ellipse with text, bg color and a circular arrow for the first time and now even other presentations that I did not even had open at the time are corrupted. But all of them have been created within the last week with pictures copy/pasted from GIMP. Surprising for me is the fact that all pictures where inserted the same way, but only some have disappeared...jogam(In reply to)Can you try the latest version and see if the issue remains?Hi,I just experienced a similar problem and found a way to fix it.Problem=======Win 7, LibreOffice 4.1, Impress, large presentation (D:/Dokumente/Dokumente/Report_Phase1/report.odp, ~100 slides) with lots of linked images. Everything worked just fine until this morning. I think the program just knew that today is my deadline ... when I opened up the file: all links broken, no images displayed anymore.I noticed on funny thing: In the "missing file frame", the link was pointing to the some target e.g.:file:///D:/Dokumente/Dokumente/Report_Phase1/Figures/CSEM/image.pngAt a first glance this looked OK, but looking closer I noticed the "Dokumente/Dokumente", which is incorrect. In fact, the true path should have been something like:file:///D:/Dokumente/Report_Phase1/Figures/CSEM/image.pngTRACKING DOWN THE PROBLEM=========================I opened a new file (odp) and copied one slide containing a broken image link from the original presentation to the new test file. On a second slide I used the dialog (Insert -> Picture -> from File) to again link to that same image.I then saved the presentation and re-opened it with the result that the link on the first page was still broken, but the second link worked just fine. I then unzipped the odp-file and took a look at the content.xml file. The two links looked as follows:../../../../Dokumente/Report_Phase1/Figures/CSEM/image.png (broken link)../Figures/CSEM/image.png (new working link).NOTE: the actual paths were much longer, I have shortened them a bit for this post.BUG FIX=======I used "find & replace" (../../../../Dokumente/Report_Phase1/Figures -> ../Figures) to replace the incorrect links in the content.xml file and re-integrated this file into the unzipped odp-file ... problem solved.OK, neither do I know, if this bug fully relates to the ones described above nor do I don't know, why Impress is doing this to us, but at least I found a way to fix this problem for me.Hope this is helpful to track down the problem, because this is REALLY annoying.CheersSebastianCreatedXDOC test case -- before bugVersion from before this bug hit Jared againCreatedXDOC test case -- after bugI just attached two files, xdoc test case "before bug" and "after bug". I just hit this on Windows 7 using LibreOffice 4.0.4.2.The "before bug" file works great and has lots of images. Suddenly, as I was editing my slides, many pictures disappeared, including the airplane on slide 1, 27, and 31. Also many pictures disappeared on slide 29.The *after bug* file was saved immediately after the bug struck. I don't know what I was doing. I think I was perhaps editing the text near slide 37.I have been dealing with this bug for years. I often create very image-intensive slides. I can distinctly remember three previous presentations where one particular image continually disappeared. It would be *wonderful* if someone can figure out why this is happening and fix it.(In reply to)Thanks Marc. On a second (n-th) thought, I agree with you that #11 is not linkedHi Sebastian,(In reply to)Thanks for the clear description and (sort of) solution.I don't think that it is the same problem as in this bug.Here, the embeded images really get lost.In your problem, the links are corrupted. Your problem looks very much related to, where the problem also is that path file:///X/more is changed to file:///X/X/moreMaybe you can open a separate issue and refer to 48463 ?Regards,CorHi all,So good news is that there is some work goning on to fundamentaly repair the handling of images.For time being ....It would be my advise: if you cut and past images from one place to another in the presentation: - keep a copy of the presentation before starting that work; - use a separate Impress/Draw document that you paste the images in; - when all collected, sorted out: - save the presentation - copy the images from the other file to the presentation - save againIt's some extra work, but compared to other work, let alone losing a file, relatively little.Ciao,CorI had the same problem in LibreOffice 3.6 with a png picture.Finally found a workaround that seems to work fine:- Add the picture to your presentation (the first time it is correctly displayed)- Select the picture in the presentation- Cut the picture into the copy & paste buffer (CTRL-X)- Paste the picture again but as GDI metafile (Shift CTRL-V)- DoneAfter this format change, I did not loose my pictures again.Hope it works also for you.diback394I still experience the problem it in LO 4.1.2.3 Build ID: 410m0(Build:3)(Kubuntu 13.10)Being bitten by this on LibreOffice 3.6.7.2 (Build ID: 3.6.7.2-4.fc18) (png images only?)works well as workaround.Thanks diback394This bug embarrassed me this evening at a presentation I was giving to a Cambridge-based society of software developers.Ironically, the talk was exploring the benefits of Open Source and how it is becoming an option for UK Government.Needless to say, this didn't set a great impression for LibreOffice nor for Open Source in general when some images failed to load!Affects: LibreOffice Impress 4.1.4.2, on Ubuntu 12.04.(In reply to)Since this workaround is confirmed to work, can I request all who are affected by this to confirm if in your situation the affected images are in PNG?Workaround worked, images were PNG. Version 4.0.2.2 (Build ID: 400m0(Build:2))I'm seeing this same behavior in v4.2.0.4 of Draw (on Mac). It has really killed broad-based adoption of LO in our organization. The latest update is to use the workaround, and from here on out, I will, but what is the current status of any fix?Having a large presentation due recently, I struggled with this issue on my Fedora Linux 19's LibreOffice 4.1.5.3. Just opening up the presentation, making a small change to some text, saving it and closing it will often result in lost images the next time it is opened.I have also opened Fedora bug 1084822. <>I noticed this bug first after an update to LO 4.2.4.2 on Fedora 20.For me the workaround intdoes not work (at least for JPG files). After reinserting the image is reset to 100% and the displayed zoom factor does not change when the frame is drawn smaller. This may be another bug but I did not verify this yet.I still have this bug.What is more, it seems to be worse in the latestlibreoffice-core.x86_64 1:4.2.5.2-1.fc20than with libreoffice-core.x86_64 1:4.1.3.2-9.fc20 will be updatedI'm downgrading...LO Impress 4.2.5.2 (official RPMs from LO website) on ~AMD64 Gentoo. PNGs were inserted via Insert -> Image form file. After one of saves (could be also autosave), some of images are gone and their XML nodes contain empty href attributes. No "copy & paste" was used.Same issue on Win 7 and LibreOffice 4.2.5.2, with SVG and PDF graphics inserted using the "insert image from file" button, or using a copy-paste from Inkscape.After some changes in other slides, the href in content.xml file becomes blank for some (apparently) random images: <draw:image xlink:href="">.My father just struck this in LibreOffice 4.2.5.2 (official x86 build) on Windows 7. The installation is pretty much out-of-the-box defaults.The machine:- AMD Turion X2 2GHz- 8GB RAM- Windows 7 Professional 64-bit- Other applications installed/running: - Kaspersky Internet Security - Mozilla Firefox - Mozilla Thunderbird - OwnCloud sync clientUp until tonight I had good faith in LibreOffice. It took a beating tonight.The presentation was created from scratch in LibreOffice, saved as OpenDocument presentation format.Only the stock template was used, the presentation itself consisted of a small amount of text, and about 17 JPEG photos, each approxmately ~4.7MB in size (3648x2736px). An image would be inserted (embedded) into the presentation, one by one, then resized and positioned on the slide. No special styling has been applied to any object other than the resizing of images. No transitions.Up until this point, no image loss had been observed. The file was growing to about 60MB in size.He decided to start compressing these images to reduce the size a little as the size of the file was beginning to have an impact on performance. After doing this, he got the file size down to 27MB, then noticed some photos had gone missing. Photos would randomly disappear from the document, re-adding them would cause others to disappear.Viewing the presentation would result in the presentation software crashing. LibreOffice would just disappear, we have no crash dump.We've just tried downdating to version 4.1.6 (obtained from).We observe that when we view the slide sorter, sometimes the images appear missing, then viewing that slide, the images would be slow to display. (They'd take about 20 seconds.) After viewing the presentation, then returning to the slide sorter, the preview of one slide still shows missing images.I'm running Fedora 20, and also getting this bug with libreoffice-4.2.5.2-1.fc20.x86_64.This bug is marked NEEDINFO. What info is needed?***has been marked as a duplicate of this bug. ***I would like to add an observation that could narrow things down slightly. This seems true for version libreoffice-4.2.5.2-1.fc20.x86_64 in Fedora Linux (I'm not sure if it applies to other cases). For me, this issue seems very much related to autosave.I've been working with a large presentation ~100 slides, lots of videos, pictures, shapes, animations, etc. Total size is about 200MB. I was getting the missing picture problem somewhere in the document every time I worked on it.I've noticed that if I worked on the document for a short time, save it, and quit, I wouldn't see the problem. I've turned off autosave, and haven't seen the issue since. For me, at least, it seems that regular save -- ctrl-s, or from the file menu -- don't corrupt the document. Only a save after an autosave occurs causes this corruption.How is this bug still unfixed?! It was first reported 2 years and 5 months ago.At my company, a debate is raging over whether we abandon our Microsoft Office 365 licences and go entirely to LibreOffice. Unfortunately, the abundance of bugs and lack of movement in fixing them is the main cited reason why we should stick with MS. It's hard to disagree.Change Version back to 3.3.2 according to:We have actually fixed this in one sense, it's just that there are multiple issues and evidentially we haven't fixed them all and this has now become a catch-all bug for a bunch of bugs with the same result. We definitely have fixed some of them. What is required is a route to reproduce, on the very latest stable releases, for what reportedly remains.Really? That's strange, because it worked in any case I tried in version 4.1.6.2, but causes severe problems almost randomly in version 4.2.5.2 again no matter how the image was embedded (imported or copy&paste) nor if it was edited (cropped, resized, ...) or not.I agree with Mike Brooks, it's almost impossible to migrate our company to LibreOffice since there are such obvious bugs even in the nth stable release.I got the same behavior with a fresh presentation using Version: 4.2.5.2 on Ubuntu 12.04 32bit. Yesterday, I decided to remove all the spaces from the path and even the name of the presentation (just to try!). Up to now, the problem disappeared, but maybe it is just a coincidence and it is not related to the bug.Mat Hirsh, #85, is on the right track.I have used 4.2.5.2 on XP and Win 7 variously to build a large document with many embedded jpegs for then last fortnight. Was driven to distraction by pictures just disappearing.Ready to quit and go back to Office, but following Matt, turned off auto-save. Now two full days on my project without one picture disappearing.This may be the place to look.Since we now have good reports by turning off autosave as a (temporary) workaround, can those still affected by this bug give it a try and report back?(Strangely, I've been working on an ODP with lots of images for years (now 3264kb) w/o this problem. Touch wood!)***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***maybe the same root aswhich is related to autosave as well?that bug recently received a fix, so I suggest to grab a daily 4.4.x.x or 4.3.1.x build to test if that fix is beneficial to the current bug as wellThe workaround with none autosave works fine for me too ().(In reply to)This bug is not fixed in libreoffice-4-3~2014-07-23_00.54.59_LibreOfficeDev_4.3.1.0.0 of today.I believe this has been fixed by commit fd641c7b23ce4205c29fc0c564b73336cb2cfb07. Could someone check with the latest daily build?(In reply to)For me this bug was fixed with the latest daily build (libreoffice-4-3~2014-07-24_16.46.54_LibreOfficeDev_4.3.1.0.0_Linux_x86-64_deb.tar.gz).Thank you.Looks like Caolans fix foralso fixed this here.Setting to Fixed as of. Can't test myself since nightly builds for OS X are broken.Feel free to test yourself and correct me if I'm mistaken.This happens for me as well, for both jpg and png files, and at arbitrary actions to other elements of the presentation (undo, cut&paste, save).LibreOffice: 4.3.0.4Build-ID: 430m0(Build:4) from the Launchpad ppa:libreoffice/libreoffice-4-3Ubuntu 14.04 64bitFreddi or others on Linux: anybody up for some testing using the latest nightly?Please don't change version number, it shows the oldest version in which the bug has been found.Best regards. JBF***has been marked as a duplicate of this bug. ***(In reply to)I had same issues as Freddi.The latest nightly, Build ID: 13d4f7b800a9f35717ed91f330b38513e0db4bc6 2014-08-12_16:26:55, seems to fix this issue for me (on Debian).Thank you.(In reply to)But this snapshot is not complete : lodevbasis4.4-core05 is missing because perhaps it is an alpha release. So Debian's apt speaks of dependences problems.Please, plan to fix thisin 4.2 and 4.3 releases.Regards,I suffer on the same sever bug on CentOS 7 LibreOffice 4.3.0.4 ReleaseNote: I appears when I copy-pasted slides from a pretty old presentation that was created with a previous release of Libre/OpenOffice.At first it worked after unknown events the pictures of several Slides disappeared.LO 4.3.1.1 build is almost Ok. I've been editing a presentation for several days using 3 ways for pasting images:- copy from GIMP- copy from another presentation- inserting from png file (drug&drop)I have used every method several times.One picture has disappeared only once, I don't know why. Hope it was some bad magic.I have lost another image right now. The autosave function is turned off. LO 4.3.1.1 @ Ubuntu. So, the problem is not completely solved.(In reply to)I'm sorry for my silly question, did you use fresh profile with 4.3.1.1 & still reproduce the problem?(In reply to)No, sorry for my silly question, what do you mean "fresh profile"?I uninstalled all LO packets and installed LO 4.3.1.1. I have not deleted any files in my home folder.(In reply to)For the sake of clarity, this problem is documented in. The missing package (core05) only affects certain tools (e.g., beanshell, javascript, mediawiki, nlpsolver, report builder, etc.) that are not likely related to the problem reported here of embedded images being dropped from a presentation.(In reply to)(In reply to):) Ok, I believe I knew what is user profile. I have asked what do YOU mean "fresh profile".After your previous comment I have uninstalled LO, renamed /home/<user name>/.config/libreoffice folder and installed LO again. The 4.3.1.1 build is not good for real life, it has some issues, but Ok, I will test it more.(In reply to)Sorry for not using proper wording :)Anyway 4.3.1.2 is out, please use that insteadI' a 4.3 user and a presentation of 63 pages lose all images on it!On writesr i lose 2 images that desappear.But on Impress all images were changed to a link error icon..(In reply to)What is the full number? 4.3.0 or 4.3.1 or 4.3.1.1 or 4.3.1.2?4.3.0.4 still have the bug4.3.1.2 still has the bugThere are multiple bugs that have the same result. This is now a mangled trainwreck of a bug report unfortunately. Some of the problems reported here are certainly solved, and there appears to be remaining problems.Taking 4.3.1.2, and ignoring all earlier versions, is there now a known route to reproduce the problem ? At this point a script to continually inserting/copying/saving images into impress in some mega-loop might be the way to go.Createdzip with extension & explanation for loading lots if images(In reply to)thanks for reminding me. Started this month or so ago, but somehow it dropped :(Attached zip contains extension and short explanation.Hope this helps.@caloan:(In reply to)Hm, bit stupid that I didn't think of the documentservice: the attached is for text documents..I can change it to do the same for presentations. Need some time..Maybe in the mean time, trying in Writer is interesting too :) ?***has been marked as a duplicate of this bug. ***Same here, working with LibreOffice Version: 4.3.1.2 Build-ID: 430m0(Build:2) and lost several images on a few slides just a moment ago. Only the placeholder frames for missing images are shown.This bug now persists for several years. :-(***has been marked as a duplicate of this bug. ***I just upgraded to 4.3.1.2 (from 4.2) since some images were lost and I thought an upgrade may fix this. But as a result, now even more of my images (png, inserted via copy and paste) are gone after opening my old presentation! Even worse, all videos are gone. Not a single one is working.How can I fix this? Where can I manually edit the links the videos and images are pointing to?I think I have found a workaround. Based on the hint, that this happens with old slides, I removed the Configurations2 folder from the odp (1). When opening the file and did not start the recovery process. Since then everything is fine.I did loose some settings like user defined colors, but at least it is working again.(1) For those not familiar with od*: It is a simple zip file you can open with your favorite zip program. Worst case, rename it to zip and back. Don't forget to make a backup.***has been marked as a duplicate of this bug. ***I can confirm this Bug on Arch LinuxVersion: 4.2.6.3Build ID: 4.2.6.3 Arch Linux build-4This has been happening to me with new presentations. I'm throwing together a presentation in Impress and I'm using this Google Images file of as a placeholder (Perseid meteor shower)and its disappeared, replaced with an image icon.The presentation is in a subdirectory of my home folder. This image is within an images directory:- 644 my_presentation.odp+ 755 images|-- 644 perseids_bruenjes_big.jpgI've been dealing with this problem by reinserting the missing images and saving immediately. Files saved with all the images visible have been opening with the images visible subsequently. In other words, the images don't bork--for me--when the file is opened.There are multiple bugs that have the same result. This is now a mangled trainwreck of a bug report unfortunately. Some of the problems reported here are certainly solved, and there appears to be remaining problems.Taking *4.3.1.2*, and *ignoring all earlier versions*, is there now a known route to reproduce the problem ? At this point a script to continually inserting/copying/saving images into impress in some mega-loop might be the way to go.I really cannot believe this is happening. This bug is pestering me for years now and left me standing in the rain again yesterday with a part of pictures gone during a presentation. This was a presentation created from scratch, no legacy imports whatsoever. The Powerpoint DVD is spinning in my drive, I'm over and out after 8 years of OOO and LO, I'm using Latex instead of Writer anyway.I agree with some of the comments above: There seems to be little understanding in the community that Impress could be an important "door-opener" at Universities where MS-Licenses are cheap and scientific documents are often written in Latex anyway. We lecturers could be multipliers but - as mentioned before - I feel truly left standing in the rain.As this bug is related to embedded images, a possible way to avoid it is to use linked images.When pictures are linked instead of embedded, it is important to activate option "Save URLs relative to filesystem", as explained at.As a consequence, images are never lost, because they are previously placed in some known folder in order to link them. If the presentation has to be copied or moved to a different folder, images will be available provided that they are copied or moved to the relative corresponding path too.I can confirm this is still happening in 4.3.1.2 and 4.2.6.3. I lost many of my copy/pasted images in my slides more than once in the past 2 weeks. This is really a show-stopper, and I think this is the worst bug currently present in LO that I know of.I am now trying some of the workarounds here presented (increased memory buffer in options + removed the Configurations2 folder from the odp + disabled auto-save) and have not encountered this bug again so far.I also got hosed by this bug. I lost all of my copy/pasted images in my slides more than once. This is a horrible bug for software based on showing images. Hours of time down the drain on this product. Booo!!!!(In reply to)(In reply to)Perhaps this is why I never had the problem. I recall changing this long time ago.Suggestion to all affected ones: Go to Tools - Options - LibreOffice - MemoryOn the right, you'll see "Graphics cache".My settings:Use for LibreOffice: 128 (MB)Memory per object 10 (MB)Remove from memory after 00:10 (hh:mm)(Perhaps LO should go automatic on this.)I've never disabled auto-save (more correctly: Save AutoRecovery information).(In reply to)Why have you changed this?Hardware from All to x86 (IA32)OS from All to Windows (All)Version from 3.3.2 release to 4.3.0.4 releaseIs it your parameters or what? As I see Linux users still have this problem too.***has been marked as a duplicate of this bug. ***Hello all Since upgrading to Ubuntu 14.04 with LO 4.2.6.3 I have the same problem. Images are disappearing and only place holders are found. This problem is occurring after reopening the file or after inserting one odp file into another. In the later case, only the inserted file images disappeared. This problem was not observed in the same machine with 12.04 and older LO versions. When renaming to .zip and extracting files the images are not found in “pictures” folder . I do not have the problem at work with Ubuntu 14.04 LO 4.2.5.2 with the same odp files.(In reply to)I should add that I'm still using 4.1.6.2. (Not upgrading until regressionis fixed.)***has been marked as a duplicate of this bug. ***I also ran into this bug while preparing for a presentation and a colleague had it during a presentation. Please fix this a.s.a.p. to prevent more loss of work, emberrasing moments and image damage for LibreOffice.I was using LO 4.2.6.3 (Build ID: 420m0(Build:3)) on Ubuntu 14.04.1 32-bit (up until Monday 29 Sept when I installed Xubuntu 14.04.1) and encountered that problem constantly. As with others, it did not matter how I put the pictures in (Insert; Copy/Paste; Drag/Drop) eventually some of them would disappear. I always 'fixed' it by right-clicking on the empty image box and clicking "Change picture" and basically re-assigning it. This would often cause other pictures in the presentation to disappear.I started encountering another issue with the Slide Pane not being visible but I don't know if that issue belongs here.Since I just reformatted and they weren't working anyway I do not have a sample doc to post but for now I will stick with Google Drive.JerCreatedTest case for images disappearingI just took LO for a quick test spin and attached the file. As you can see, I didn't even get 4 slides completed before the image on my title slide disappeared. The images were saved from Google (Save Image as) to my desktop and then inserted using the image button. I didn't even have a chance to use 'Save as' so maybe there is something with the autosave (mentioned in previous comments)(In reply to Jer from)Thanks for the report. And what if you apply the suggestion at?CreatedTestcase 2; with changes made fromHere is another test presentation. I have applied the changes from(128 MB for LibreOffice; 10 MB per object) and got the same result as before, this time losing the last two pictures that I inserted. At first, the picture was still visible on the slide in the slide pane but not on the outline. Then after scrolling up and down it was gone from both. All of the pictures share the same directory and are .jpg, .png, or .gif; the two that disappeared were jpgs at 100kb and 300kbWhy only 128 MB ? The maximum possible value is 256 MB. Since at least OOo 2.0 the first customization I do when I configure OOo / LO is to set this value to its maximum. And I do not lost pictures inserted in my presentations.Additionally I uncheck the checkbox "Automatically save the document too" because, as all dinosaurs, I am used to hit ctrl+S very often. Best regards. JBFI used 128MB as that has been suggested in previous posts (). Either way I don't think its relevant as the total size of the pictures I embedded into that presentation was only 2.8Mb. So unless LO is increasing the size of my images 50 fold, why should I have any issues? And while I appreciate the suggestion, it is not a solution, merely another workaround (and one that has been suggested for a year and a half;). If LO can not even function with a cache lower than 200MB then why is it adjustable? I certainly can not afford to spend days preparing a presentation with the risk of losing my pictures.It is the graphic cache and pictures are not the only graphics in a presentation.Best regards. JBFCreatedzip with oxt and odt with explanation(In reply to Cor Nouws from)Attaching a new version of the oxtWorks in Writer and in ImpressThe zip contains .oxt and odt with some explanationThat macro seems to insert into impress as a link instead of embedding the content, so probably doesn't exercise enough of the tricky piece(In reply to Caolán McNamara from)Ugh .. :\Createdzip with oxt embedding pictures in Impress toopls try this oneI have seen this bug off-and-on for years, going way back into OpenOffice days. However, I recently upgraded to Ubuntu 14.04 LTS (with LibreOffice 4.2.6.3), and the subjective frequency of this problem is *much* higher than before. Just yesterday I had this problem occur at least a dozen times in the course of the day.For what it may be worth: I primarily insert images by taking a screenshot, editing it in GiMP, copying a region from GiMP, and then pasting this into Impress.One of the developers commented above that this problem seems to be triggered from various places, and they are hunting these places down. May I just note: When a problem is so recalcitrant that it cannot be fixed over the course of several years, then something is fundamentally broken. Please consider throwing away the existing image-handling code and re-designing it from scratch.As others have pointed out, this is a <i>disastrous</i> error. This flaw alone has cost users uncounted thousands of hours of lost work. This flaw alone is reason for companies to avoid adopting LibreOffice.Hi,I've never had this bug before. But, when upgrading to LO 4.2.x this bug happens several times (impress).It seems that there are a lot of duplicates were raised at this timeThe bug happens in many ways. Coping and pasting from the net, from Xnview, linking object. At a moment all the images inserted disappears. But only images added.The only workaround for me was to save my file very often.I've upgrade to 4.3.2, and this bug seems to have gone away. In the other hand, I've not work a lot with Impress 4.3.2Impress has a lot of bugs since 4.0It' difficult to get the focus on a text frame or on a imageAll these bugs are *regressions*, and are graphic problemsMaybe this bug is a side effect of one of them(In reply to Brad Richards from)for what it's worth, the earliest bug entry I found for this is2002-12-16 11:26:51 UTCThat is about 12 years now, isn't it? - Actually I don't remember running LO/OOo, perhaps even the old StarOffice, without this bug.J.(In reply to Pierre C from)I think that all users should use LO 4.3.2.2. With this release, I have never seen this bug on Debian.@Juang Dse: Please help testing (or developing if you can). LO needs volunteers. Did you tested intensively 4.3.2?(In reply to Rpnpif from)I had write too early.Now I have the same bug but in Writer: an image in a text document disappeared during autosave.Should I open a new bug report or add a sample file to this?As this bug is about Presentation, I opened a new report about writer. Are you OK ?Regards.(In reply to Rpnpif from)I mean that I'll open a new report if it is needed.(In reply to Rpnpif from)Should be this:Wow, given the age of this bug, this is a VERY VERY dissapointing situation, I'm using L.O.Impress, Version: 4.2.6.3Build-ID: 3fd416d4c6db7d3204c17ce57a1d70f6e531ee21 and the problem annoys the hell out of me. I'm just preparing my slides and images come and go when and where they want. Usually the Images tend to stay after loading them again one or a few times... but until no further changes are made it's absolutely unpredictable which images are going to stay or disappear. If people think no-one is interested: I just assume this is a show-stopper that makes people turn away and never come back. I am sure this is not limited to .png, but also happens with .jpeg.(In reply to Pierre C from)Just a little sum up of the situation :I Went to LO 4.2 because working with table and impress 4.1 makes LO crashThen, I went to 4.3 because images disappears in LO 4.2In LO 4.3 I loose some of my work in formulas in writer. None of my update were motivated by a new featureLast but not least : I must keep an OpenOffice, to resized my formulas with borders in writer (borders shrink the formulas since 4.1 ?)This is a really funny way to work and a big waste of timeAnd now, with impress 4.3 It sometimes crashes. Yesterday I loosed one our of work.I'm a ten years user of OpenOffice/LibreOffice. I told many peoples to use this office suite. But since LO 4.x I haven't told anybody to use itSame bug with LO 4.2.5.2 on Windows 7. Memory settings are changed (as suggested above). I use laptop that is not very powerful, can be that there is not enough CPU.Pictures disappear after autosave and after save/save as. Doing backup doesn't help, as pics disappear also from backuped presentations.It's possible to see presentation fine before closing and open it without pictures.Seems that it occurs mostly when you click occasionally on other than current slide when autosave is running. For awhile I continue to see disappeared images in Slide Pane.Pics are disappearing whether they are linked, inserted from file or from screenshot software.It's very very very frustrating. Total loss of working time for me now 48 hours.Many thanks to all, who are working on this problem.(In reply to daria from)Please, read comments of others users above where it is said that all should use LO 4.3.2 to perhaps fix this bug.(In reply to Rpnpif from)Still present, but with a much lower frequency in LO 4.3.2.2 Build ID: fb5295ba211bd31ad47d0bad0118690f76407dWorkaround to prevent embedded pictures disappearing or displaying improperly in Impress slides:1- From "Slide Sorter" right click on empty space and select "New Slide"2- Double click the new slide. Now in "Normal" tab3- Add content to slide including embedding pictures4- When finished with editing the slide Left Click on "Slide Sorter"5- Right click on empty space and select "New Slide"6- File => SaveThe creating a new empty slide at the end of the deck seems to save the embedded pictures placed in the earlier slides.While following this procedure some extra new and empty slides are created.Removing these extra empty slides after saving does not cause deletion/changes of the embedded pictures in the earlier slides.After modifying the contents of a slide, I add an empty slide to the end of the slide deck then File => Save.Since doing this, embedded pictures are displayed properly. Before, only a rectangle with an "x" in the upper left corner displayed rather than the picture. LibreOffice 4.2.6.3Ubuntu 14.14 LTSLinux 3.13.0-34-generic***has been marked as a duplicate of this bug. ***(In reply to teacher1st from)thanks for the explanation teacher1st.This helps because you force synchronisation of the various copies of the document that are kept in memory for the various views (and more).please fix this error ASAP, I've just lost 1/3 of my presentation :'(Seriously, this is absolutely ridiculous. I've been increasingly burned by this bug on while using Version: 4.2.6.3 Build ID: 420m0(Build:3). Finally happened yesterday morning in front of my class. Images from the entire presentation were gone. Luckily, I had an older version of the presentation from an earlier semester that I was at least able to make my way through so that I did not waste a complete lecture period (in addition to the hours of prep work that was indeed lost).I've been trolling this thread for a few weeks hoping a solution would arise. None of the recommendations so far have worked, including that from teacher1st. Images continue to disappear randomly, most often while I am actively creating/editing a file, and sometimes on a fresh open of a complete file.However, I made a new observation today which may be of some value as I have not seen it mentioned in previous comments: I was working on a presentation today which had been copied over as a new file from an earlier version. Several hours in and all of a sudden 3 images are missing from 3 slides, showing only the placeholders, and on one slide an image remains (i.e. on a slide where previously there were two images, there is now one image and one placeholder). In order to quickly remedy this situation, I find the earlier version of the presentation in a different file in a different folder. Lo and behold, when I open that file, the exact same 3 images are missing and only those images are missing. That seems very odd to me.Impress is getting worse. yesterday at a work session of the city council, I was using Impress and draw. I had three crashes ! This has never happened before !I'm not that it was a good thing for the LibreOffice credibility (LO4.3.3.1)Please stop adding functionality ! Solve bugs. it's time for a brake.***has been marked as a duplicate of this bug. ***I can confirm having had and still having this bug on all versions of LO since at least 3.5.7.2. The bug appears on various systems, Linux 64 bit, Ubuntu 12.04LTS and 14.04LTS, Linux Mint Lisa. It's more frequent in the 4.x version or so it seems to me. I have been giving lectures with LOimpress 3.x vrsions but don't dare to anymore with the 4.x branch.Formats that I can conform to be problematic are at least .png an .tif.Best,Michael(In reply to michael.wibral from)thanks - but pls don't touch the fields unless you've read the documentation on that ;)Why isn't this listed as a MAB?I have the exact same bug, in Version: 4.2.6.3 Build ID: 420m0(Build:3).@Caolán:(In reply to Caolán McNamara from)You meant for trying to reproduce by * or to do the same by someone with specific development tools running ?(In reply to chtfn from)I don't know why it wasn't in that list. I added it to it right now.Have the same bug. version 4.2.6.3. Build ID: 420m0(Build:3)Lot of wasted time on presentations ...If it can helps :I installed the "TexMaths" plugin (0.41) to create mathematical formulae with LaTex syntax. The same bug occured. Formulae disappear randomly when generated with png export.(In reply to jo.lasticott from)Sorry for that.Now if you attempt to change the fields in the header of this issue, you get a warning... pls respect that ;)REOPENED is incorrect status - REOPENED is saved for bugs marked as FIXED and assigned to developers. This has never been assigned to a developer. Marking as NEW.The bug in Impress is still present in my LibreOffice (Version: 4.2.6.3 Build ID: 420m0(Build:3) on Ubuntu 14.04 LTS, 64-bit)Recently I started working with TexMaths which inserts LaTex-formatted formulae as PNG images into LibreOffice documents (see)These PNG images disappear randomly while working on the document (perhaps it has to do with the autosave, but I am not sure). In the case of TexMaths, the formulae can be brought back by selecting the empty image placeholder and clicking on the TexMaths plugin symbol to bring up the TexMaths dialog again.I have experienced randomly disappearing images in the past (before TexMaths), sometimes only finding out when giving the presentation. Now I realise that this is due to a long standing bug (or bugs).I hope that this serious problem will soon be solved, and I will try to help. It is the type of bug that efficiently chases people away from LibreOffice. Most of these will not file a bug report, but will simply stop using the software.Still happens on linux mint. Just cost me half an hour.Started a fresh presentation and inserted downloaded jpegs and pngs, nothing more. After saving and reopening images were lost.Version 4.2.6.3, Build ID: 420m0(Build:3)This bug is incredibly frustrating and I hope someone is making it urgent. Images disappear even from a file that is not open. Hoping to save myself some work, I saved a duplicate of the file I was working on, and when some images disappeared from the open one, I closed it and opened the copy. It had the same lost images.I am using a Macbook Air, OS X 10.9.5; Libre Office Version: 4.3.2.2Build ID: edfb5295ba211bd31ad47d0bad0118690f76407d.MY WORK AROUNDI posted this earlier and I unsure how well it works in general, but since I started using it, I have had zero problems with missing images.I think the problem is whenever I upgrade there are slight changes to reading the ODF files. So the work around I use is that whenever I want to open up an old file to edit it for a new purpose. I do not open up the file, I create a new file and use the 'Insert' -> 'File...' from the menu bar.As far as a fix, I think the ODF import function should check to see if any media files are not being used before purging them. If you recall the ODF file is a zip file with the media files inside. I do not see why it could not work this way.I am trying to figure out a list of steps to reproduce the issue, when starting on an empty Impress presentation.From what I read above, it might be an issue with memory management of images (see Tools->Options->LibreOffice->Memory). Or the cleanup of deleted images (might remove images that are in use?).I tried to reduce the values there (only 1MB image cache, only 1MB cache per image, remove from memory after only 5 minutes) so that the bug is more likely to happen.I also used this image,(PNG, 1.7MB).I created several slides and copied/pasted the image around those slides.I did not manage to reproduce the error.Could you all please try, by starting on an empty presentation, to create such a small presentation with the aim to get this golden list of steps that reproduce the bug?There must be something that triggers this bug, and we need to find it.(In reply to Simos Xenitellis from)Thanks for your post and encouraging ideas Simos!What I would suggest also: try with a presentation say 4 slides, with most already some graphics, and saved.Open it, ad a new slide two, copy an image from the file manager, paste it, go to the bowser or mail, set you some fresh tea and come back in five minutes or so, and look in Impress.Hi all. It would be lovely to be precise about what we are talking about here.One thing that I would like to make clearer: we only have, as far as I can see, one confirmation that this happens with autosave turned off ().Could anyone else please confirm that they come accross this issue with autosave turned off? ("Tools > Options > Load/Save > Automatically save the document too")If turning off autosave makes it disappear, you are probably looking for. There is activity there that we can look forward to:Thanks everyone.CreatedPrueba .odp saved and if is open do not shows imagesThis is an example file with images but not shows by libreoffice.@Ismael Cedillo & othersI never opened those attachments so far. But I was curious and a surprise: the image can be seen in the presentation! I'm using LO 4.3.3.2 @ Debian.(In reply to Ismael Cedillo from)I think this problem is different. Indeed LO 4.2.6 opens and shows all images without problem, in both modes edition and slideshow. But LO 4.3.5.0.0+ and LO 4.4.0.0.beta1+ does not show the pictures in both modes. In edition mode the pictures appear during a very short time and is replaced by its frame.I filed thefor that.Best regards. JBFI am running Windows 8.1 64-bit.I didn't have this problem in v4.3.4; but I am seeing one variation of this issue in 4.5.0.0.alpha0+: 1. Only some images disappear (not all slides)2. The image can be seen in the "Slides" pane (thumbnails), but not in the main (canvas) pane. The main pane only shows a placeholder. Attaching a screenshot.3. Sometimes the image vanishes from the "Slides" pane also, but after some delay.4. An image that has disappeared does not re-appear in slideshow mode also.CreatedOnly some slides are affected; leaving only a placeholdermoving this to mab4.3 list since 4.2.x reached EOLSome additional observations:In my case, the affected file does NOT change: The same file reads fine with 4.3.4; but shows missing images when opened with 4.3.5, 4.4 and 4.5.This is a strong clue. I can share the file.(In reply to narayanaras from)You probably encountered a duplicate ofwhich has been reported and fixed yesterday.Best regards. JBF***has been marked as a duplicate of this bug. ***It happened to me 2 hours ago, when I was about to finalise my 80-slide presentation for my evaluation for a Professorship at my institute set to begin 2 hours later..... I am dazzled :-) LibreOffice Version 3.6:build-304 (Build ID: 360m1(Build:304)) in OpenSuse 13.2this looks the "King of all the MABs"I wonder if the devs could resume the "hard hacks" fixing campaign just for this one.It would be very important that this annoying issue could be fixed before it's 3rd birthday (february 22nd 2015)Hi,It's not quite clear to me which version have the bug and which ones don't.Does v4.3.4.1 have this bug or not?Can someone reply quickly to this question: we have the problem in production with v4.2.6 and might have to downgrade to 4.1.5.3 (doesn't have the bug, we're sure about that) or upgrade to 4.3.4.1 (I would prefer but am not sure it'll fix the situation)Best regards,Eric Ficheux@I'm working with 4.3.x and I've never had this problem back. So it seems that this bug has gone away. But not sure(4.3.5.2 will be available soon)(In reply to bureautiquelibre from)As mentioned, this bug has multiple causes.And thus, when improvements are done, it might improve in part of the situations... Makes tracking rather complicated.I'm sure that the problem sometimes comes up in older versions. But maybe in a different setting/use that what is the case with your users.I've not much specific experience with 4.3/4.4/4.5, but some of the patches have been applied to those releases, so that could explain the positive response from Pierre CCheers,CorI am on Ubuntu 14.04 LTS. I installed a new version of Libreoffice from the official PPA, and am now working with LibreOffice 4.3.4.1.Since, I have prepared (and given!) a new ODP presentation. I did not encounter any problems with disappearing images. It wasn't a very long presentation but it did include quite some images, a few TexMaths formulae and even a video. This is very encouraging. Thanks!I should have upgraded before, instead of stubbornly sticking with the LibreOffice 4.2 included in Ubuntu 14.04 LTS.I have suffered from this bug over the years quite badly, for me THE worst LO Impress bug. However, I am now using 4.2.8.2. under Ubuntu 12.04 and the bug did not show up for some time (keep fingers crossed). I cannot tell with which version it disappeared but it looks like it got fixed. I will report if I see it again...As always thanks to the people who make LO everyday better...RegardsKarlHi Everyone,Thanks for your answers!We're rolling out v4.3.4.1 now to a limited number of users (200) as a test before complete roll out (5000 users), hopefully in january.I'll send an update beginning of january to tell you if we encounter the bug again or not.Best Regard,Eric Ficheux(In reply to bureautiquelibre -- E. Ficheux -- from)Note that thewhich have effect near of #46447 but with writer, is not yet fixed in the 4.3.4.1 nor 4.3.5.2 that it is released today. Last 4.4beta should fixed these two bugs but it is a beta so, for production, it is perhaps dangerous.Regards.I've been working for hours with both LO 4.3.5.2 and LO 4.4.0.2 Impress, and none of my images disappear.This bug seems to be solvedPer the final comment I am closing this as WFM - but if anyone else is still seeing this issue please set the bug back to NEW (not REOPENED) and leave a comment with your version of LibreOffice and operating system. Thanks!Encountered this bug again today. Using LibreOffice Version: 4.4.2.2Build ID: c4c7d32d0d49397cad38d62472b0bc8acff48dd6, on Mac OSX 10.9.5. Embedded EPS image via Insert...Image menu, embedded image disappeared after a few minutes of working.Sorry, but don't reopen old bugs like this. The changes that the original and final problems with similar appearances being the same bug over that span of time are too low. Please file a new one with how-to steps to reproduce***has been marked as a duplicate of this bug. ***Bug is present in 4.3.7.2@Tim @skianiplease open a new bug report as Caolan suggested with exact steps to reproduce and test files if needed.then put the new bug report link under the "see Also" field of the current reportIn LibreOffice Impress under the operating system Fedora 25 x64 and Windows 7 x64.In appointing the LibreOffice Basic macro to the macro button element works.But when you play a presentation (F5). In Playback mode, the macro does not work.@gamellplease open a new bug report with exact steps to reproduce and test files if needed. then put the new bug report link under the "see Also" field of the current report.please do not reopen such old bug reports... it's always better to file a new one.so I revert status to WORKSFORME
id=47494	Problem description: Steps to reproduce:Use --with-lang="hu" Current behavior:Build fails in officecfg:gmake: *** No rule to make target `/home/pobj/libreoffice-3.5.1.2-no_java-parallel/libreoffice-core-3.5.1.2/translations/unxobsd.pro/misc/sdf/officecfg/registry/data/org/openoffice/localize.sdf', needed by `/home/pobj/libreoffice-3.5.1.2-no_java-parallel/libreoffice-core-3.5.1.2/workdir/unxobsd.pro/XcuMergeTarget/officecfg/registry/data/org/openoffice/Setup.xcu'. Stop.Expected behavior:Working build.Platform (if different from the browser): Browser: Mozilla/5.0 (X11; OpenBSD amd64) AppleWebKit/535.20 (KHTML, like Gecko) Chrome/19.0.1036.7 Safari/535.20 Createdconfigure environmentIt might be unrelated but I also see the following DBG messages in the translations module:=============(1/1) Building module translations=============Entering /home/pobj/libreoffice-3.5.1.2-no_java-parallel/libreoffice-core-3.5.1.2/translationsmkdir -p ./unxobsd.pro/misc/sdf-templatemkdir -p ./unxobsd.pro/misc/sdf-l10n/home/pobj/libreoffice-3.5.1.2-no_java-parallel/libreoffice-core-3.5.1.2/solenv/bin/localize -f /home/pobj/libreoffice-3.5.1.2-no_java-parallel/libreoffice-core-3.5.1.2/translations/./unxobsd.pro/misc/sdf-template/en-US.sdf/home/pobj/libreoffice-3.5.1.2-no_java-parallel/libreoffice-core-3.5.1.2/translations /home/pobj/libreoffice-3.5.1.2-no_java-parallel/libreoffice-core-3.5.1.2/translationsDBG: NullPointer in HelpParser::CreateSDF , Language en-USDBG: NullPointer in HelpParser::CreateSDF , Language en-USCreatedfull build logPlease note that LibreOffice is unsupported on BSD.<URL:>You obviously do not know the facts, all BSD systems are supported.Anyways this is a gnumake bug, so I am closing the ticket.
id=47482	CreatedSXC files created with Password "test" (without quotes) in LO 3.4.5 and L.O. 3.5.1Problem description: Spreadsheets saved from LibreOffice (LO) 3.5.1 release as Openoffice 1.0 (*.sxc) format with a password cannot be reopened with the provided password (password not recognized as correct) in LO 3.5.1 or in LO 3.4.5. When trying to open same file in LO 3.4.4 is reports corrupt or wrong content.sxc format.Steps to reproduce:1. Create a new file (spreadsheet / Calc) or open a previously created password-protected *.sxc file or even *.ods file2. Menu or icon -> Save as3. Choose file type: - Openoffice 1.0 spreadsheet (*.sxc)4. Enable "save with password" (if not yet selected / active)5. Type in the password in both fields when prompted6. Close the file7. Try to open the newly created *.sxc file with the same password used to save it (or to create is in former versions of LO is this is the case)Current behavior:Libreoffice 3.5.1 (and 3.4.5) report "Wrong password, cannot open file" when the correct password is given.Libreoffice 3.4.4 reports corrupt file (wrong content.xml format) when attempting to open the *.sxc file saved with password from LO 3.5.1.See attached files (both created with password "test" (without quotes, lower case) - one with LO 3.4.5 which opens ok on any version, and one with LO 3.5.1 which fails to open in both versions.Expected behavior:File should open when the correct password is given.Platform (if different from the browser):Linux (Mandriva 2010.2) Browser: Mozilla/5.0 (X11; Linux i686; rv:12.0) Gecko/20100101 Firefox/12.0 This bug can result in loss of data if one opens an older password-protected spreadsheet (*.sxc format), makes some changes, then clicks on "save" (it will overwrite original file, and both the original data and modifications will be lost because one will no longer be able to open the encrypted file despite knowing the correct password). Changing importance to "High/Major".Just checked and bug also happens with text files (saving password-protected *.sxw = openoffice 1.0 text file type).Modifying subcomponent from spreadsheet to libreoffice (this is more general bug not particularly related to spreadsheet code). Cannot yet determine specific libreoffice component involved (legacy export filter? encryption?).Just reporting additional finding that may or may not be relevant to this issue:Besides the problem regarding the legacy Openoffice 1.0 formats, backward compatibility is broken for files saved with a password from LO 3.4.5, LO 3.4.6 and 3.5.1 in current ODF format (e.g. *.ods files for example), which can be open fine (with the password) in the newest releases of LO (3.4.5, 3.4.6 and 3.5.1) but NOT in earlier versions of LO 3.4.x, LO 3.3.x or Openoffice (tested 3.3.0). The following error message appears in a pop-up dialog:Read-Error.Format error discovered in the file in sub-document content.xml at 1.0(row,col).OKSo something important has changed from LO 3.4.5 on in the way the ODF and OO files are saved encrypted with a password, which result in (1) loss of backward compatibility of the saved encrypted files with earlier versions of LO; (2) loss of data if one inadvertently saves current work ONLY in the OO 1.0 format with a password (after closing the file data are lost forever because saved file cannot be open either with the newer 3.4.5 and later LO versions or older versions of LO or OO.org).Further investigating this issue in the issues "solved" in 3.4.5, I found some interesting bug reports ("closed") including:Most interesting isfrom the later:I've tested it and found a workaround to current issue:1. Launch LO 3.5.1 (or 3.4.5/3.4.6)2. Tools -> Options -> Load/Save -> General -> ODF Format version -> (change to 1.0/1.1)3. Open password-protected Openoffice 1.0 spreadsheet created in previous versions of LO 3.x or OpenOffice 3.x, or create a brand new one (with a password).4. Modify some data5. Click on save icon (or File -> Save)File is now saved (not prompting for the previously established password).6. Close file7. Try to open the file from any version of LO 3.x or OO 3.x.It now opens fine with the correct password.In summary:1. A decision has been made by the developers to change encryption algorithm (to AES?) which explicitly makes files saved with a password from 3.4.5 and later versions of LO incompatible with older versions of LO or OO.org.2. A workaround has been previously suggested (but apparently not included in the Release Notes or "Known Issues" - Developers, could you do this?) to change ODF version from 1.2 Extended (recommended) to 1.0/1.1 prior to saving ODF files or OO 1.0 files with a password to make them backward compatible with older versions of LO (prior to 3.4.5) or OO.org3. Openoffice 1.0 export filters in 3.4.5, 3.4.6 and 3.5.1 are "unaware" of the update and save the encrypted file with newer encryption method (AES?) but older ODF format (1.0/1.1 ?!) making FILEOPEN impossible for ANY version of LO or OO...Hope this additional enables this bug to be included in the "easy tasks" list... (just kidding?).BTW - I'm NOT a developer, please HELP!!!!Actually LO 3.4.5 and 3.4.6 behave correctly by using SHA1/1K and BlowFish CFB when saving an encrypted ODF file in legacy format (Openoffice 1.0 *.sxc or *.sxw) as is evident by examining the corresponding manifest.xml.However LO 3.5.1 uses SHA256-1k and AES256-cbc to create the password-protected file with the legacy file types, and at the same time is unable to decrypt the very file it just created and encrypted with the newer method. So it behaves in a way that is neither backward-compatible (which would be desirable when saving in "legacy" formats intended to be opened by older versions of OO.org, or when re-saving older files originally created in the past and in use for several months or years without difficulties) nor compatible with the decryption capabilities of the newest LO versions (3.4.5, 3.4.6) besides the very one that created the "locked forever" file...Is there a reliable way to manually decrypt content.xml or the remaining encrypted data from these "corrupted" files? Has LO 3.5.1 actually used the user-provided password to encrypt in a way that cannot be decrypted by the program, or has it actually corrupted the password? If the first is true, then does the program makes some "assumptions" as to the decryption method that should be used for opening these "legacy" formats that prevent it from using the appropriate AES256 / SHA256 methods when trying to reopen the file? Does someone know a way to manually recover the content of these malformed files by typing the correct command line code (e.g. using "openssl enc -d" or something similar, and how to easily obtain the "hex" version of the salt and of the initialization vector, and whatever else is required for successfully recovering them)?Also reproducible in LO 3.5.2.2(ID 281b639-6baa1d3-ef66a77-d866f25-f36d45f )1. New spreadsheet2. Save as -> Openoffice 1.0 spreadsheet (save with password)3. Type in password4. Close file5. Try to open same file in LO 3.5.2.2 (type same password used to save the file in step 3) -> fails with error message "the password is incorrect. File cannot be opened".By inspecting manifest.xml of the *.sxc file created by LO 3.5.2.2 we can see it has used (or supposedly used) the newer encryption method (AES256-cbc / sha256-1k).Switching ODF version from 1.2 extended to 1.0 (in options -. Load/Save) "fixes" the issue. However now ALL files use older ODF spec (even otherwise up-to-date file formats) and "Not using 1.2 extended ODF format can lead to information loss"...Possible fix:Make export filters (?) automatically use SHA1-1K + BLowfish encryption method and/or temporarily switch to ODF Format version 1.0 when saving current file (text/spreadsheet/others?) as openoffice 1.0 format...[=> Less optimal - "teach" LO 3.5.x how to decrypt the "aberrant" openoffice 1.0 files (???) which cannot be opened by LO 3.4.x nor by ApacheOO 3.4.x too (just tested !).]This bug is still present as of 3.6.2.2 (Build ID: 360m1(Build:2)), the standard version of LibreOffice that currently ships with Ubuntu 12.10.I just lost a bunch of files. Please note that this bug affects the SXC format, and it applies to files saved "with password", and then opened with the *same* version of LibreOffice. This is what the original bug description said. Some of the comments above seem to refer to a different bug.To reproduce:* Create a new spreadsheet in LibreOffice* Type "abc" into A1* File -> Save As. Select "OpenOffice 1.0 Spreadsheet (.sxc) as the file format. Select "Save with password". Type a filename and "Save".* When prompted, type "test" as the password (and a second time to confirm).* Close the file and quit LibreOffice.* Start LibreOffice again. Open the file just saved. When prompted, enter "test" as the password. * You get the error message "The password is incorrect. The file cannot be opened."An alternative way to reproduce this bug is:* open an .sxc file saved "with password" with an older version of LibreOffice.* when prompted, enter the password.* the file will open with no problems.* modify the file.* save it (Ctrl-S).* the file will save with no errors.* close the file.* open it again.* when prompted, enter the correct password.* error: "The password is incorrect. The file cannot be opened."It is this latter method by which it is very easy to lose data, because an apparently saved file will overwrite the previous version, but will become unopenable.Question: Why do I want to save files in the SXC format? Answer: I don't, really. I just have some spreadsheets that are up to 10 years old. At some time in the past, SXC was the "standard" format, and I just never changed it until now. Please, please fix this bug. It has been open for over a year, and it has not even been assigned to anyone. Thanks, -- PeterStill reproducible in the latest release (4.0.3.3):1. Create new spreadsheet with LibreOffice Calc;2. Save it with password as Openoffice 1.0 (*.sxc) Spreadsheet;3. Close file;4. Try to reopen saved file;Expected behavior: After typing correct password the file is opened by LibreOffice;Observed behavior: Cannot open file ("wrong password" error even though the same password used to create/save the file is used when trying to open it).Changing Importance to Medium/Normal since probably most users nowadays create files in the newer formats (.odt, .odc, and so on) instead of older OpenOffice 1.0 format (.sxw, .sxc, etc...). Anyway this issue may lead to the loss of data if an older existing password-protected file is opened, modified and then re-saved with current version of LibreOffice since the older file will be overwritten by the new one which can no longer be opened (with or without the correct password).please can you at least add a message on opening password protected sxc's for editing so that it warns the user to save as an ods, or disable saving of sxc's with passwords.Our lovely payroll lady just lost the staff salaries file after an upgrade to LO3.6 ... assuming that it was a one off she got a backup, made the changes again and lost them all again on saving.I am flabbergasted that this bug has remain unfixed for so long, and further that its importance has been downgraded (I'm putting it up to highest/critical). I can't think of a more critical fault than one that permanently(?) loses user's data, other than one that does so in more common circumstances.Using L.O. 4.0.3.3. I have just lost two files because of this fault, and it seems that nobody cares. As things stand, I certainly won't be recommending LibreOffice to anyone given that they care so little for users' data.I have a few old password-protected .sxw files which I opened, edited, and resaved in the same format. Now when I try opening them, I get "The password is incorrect. The file cannot be opened.", and the work-around given inisn't working for me. As I doubt any other existing bug has such critical consequences, it should be given the highest priority so that users with existing inaccessible files can open those files.CreatedSC1 spreadsheet [test]I can open the saved spreadsheet both in OO 1.1 and 4.1.Caolan McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: rhbz#1013844 fdo#47482 encrypted OOo 1.0 docs cannot be reopenedThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-1":Resolves: rhbz#1013844 fdo#47482 encrypted OOo 1.0 docs cannot be reopenedIt will be available in LibreOffice 4.1.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-0":Resolves: rhbz#1013844 fdo#47482 encrypted OOo 1.0 docs cannot be reopenedIt will be available in LibreOffice 4.0.7.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-0-6":Resolves: rhbz#1013844 fdo#47482 encrypted OOo 1.0 docs cannot be reopenedIt will be available already in LibreOffice 4.0.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Thank you Caolan!The fix works fine in most situations. I have done the following tests obtaining the following results (L.O. writer, Linux):1. Opening a backup copy of the "corrupt" openoffice 1.0 file saved with password from L.O. 3.5.1:With L.O. 3.6.6 (obsolete version I still have around): failsWith L.O. 4.0.6: worksWith L.O. 4.1.3: works2. Opening a new text file saved from L.O. 4.1.3 with password in OO 1.0 writer format:With L.O. 3.6.6 (obsolete version): worksWith L.O. 4.0.6: worksWith L.O. 4.1.3: works3. Opening a new text file saved from L.O. 4.0.6 with password in OO 1.0 writer format:With L.O. 3.6.6 (obsolete version): fails.With L.O. 4.0.6: worksWith L.O. 4.1.3: works.Thank you again.The fix works for me too. I was able to open the files that I couldn't open thanks to this bug. Thanks Caolan; much appreciated.***has been marked as a duplicate of this bug. ***
id=42745	was written against 3.4.3. When I tested the first fix that was "approved" it did not correct the problem. A subsequent additional change was made that did fix the problem. The secondary problem had something to do with needing to have a second pass to resolve forward reference names. In other words name "b" referenced name "c" and "c" has not been resolved yet. Where possible, changing the names such that all references to other names are reverse in collating sequence instead of forward avoids the problem. In other words, change name "b" to name "d" and the problem is avoided.The notes on 40590 should be helpful.I'm going back to 3.4.3. I cannot understand the poor quality control that exists within the LibreOffice development organization. CreatedSimple sheet that demonstrates the bugThis sheet demonstrates the bug.says "fixed in master", that's what it is. The fix was considered too invasive in a review to be cherry-picked to 3-4.*** This bug has been marked as a duplicate of***This bug has been marked as CLOSED DUPLICATE OF 40590 which in turn says RESOLVED FIXED. The definitions of those words is subject to interpretation. As it turns out, the fix will not be included until at least release 3.5.0. The bug was introduced in 3.4.3. 3.4.2 worked correctly. 3.4.3 created the problem. The fix is now stated as being too invasive to include in 3.4.4 or 3.4.5. Amazing. They broke it in 3.4.3 but the fix is "too invasive" to be implemented until 3.5.0 at the earliest. With this operating philosophy I don't believe that anyone should consider LibreOffice for use in a true production environment if your software maintenance policy embraces the concept of installing incremental fix releases.Seefor more.
id=42553	CreatedProblem with transparency gradientThere is a problem with the 'transparency gradient' (linear, axial, radial, etc) in Impress, when turning to presentation mode. It is a regression from openoffice, but present since the first version of LibreOffice.The best way to see it is the following:1) Make a new slide with black background;2) Draw a shape and fill area with black (so you have a black shape on black background);3) Right click -> Area -> Transparency -> Gradient and choose for instance a linear one;4) Start the diaporama (F5) and wait for the rendering: your black form isn't black anymore !See test files in attachment for illustration...Even if this functionnality can be considered as not essential, this bug can be a big problem, affecting the retro-compatibility with openoffice: for instance, an enterprise using transparency gradient for its logo (made on OpenOffice) is very very annoyed !This bug was reported, but mixed with other problems, in. As it was recently closed, but not completely fixed, I open this one with a specific description. CreatedOther illustration of the problem with transparency gradient.[Reproducible] with "LibreOffice 3.4.4 - WIN7 Home Premium (64bit) German UI [OOO340m1 (Build:402)]" I created a new example from reporter's ones only showing contents related to report.To reproduce the bug simply open "Test_new344.odp", start presentation and compare pictures with "So it looked in Edit mode", you will see strange differences.Related or not? copy /paste as Bitmap also shows strange gradient geometry modifications, but mostly different from those visible in presentation mode@Radek:Please feel free to reassign (or reset Assignee to default) if it’s not your area or if provided information is not sufficient. Please set Status to ASSIGNED if you accept this Bug.CreatedSample DocumentSee@Rainer Bielfeld: I don't understand why you truncated my test file. Moreover, why did you change my title? With my old title 'problems with transparency gradient in presentation mode', every slide of my test file was relevant, especially the first one, which exactly repeat the procedure described in. Please note that the problem is more than just a geometrical one.Maybe you didn't see exactly what the problem is: when you run the first slide of my file in presentation mode, the screen will be black for few seconds, but if you wait a little (the rendering process takes some time), you will see the relevance of this slide !schrieb:Hi,Your document demonstrates various problems with common subject "gradient/transparency", but very different manifestations and roots. As I told you several times when you posted again and again the various elements of your sample document in various reports, it is important to submit different reports for different problems.You are wrong. I see all the problems demonstrated in your documents very clear. Some of the problems have already been fixed in Master some are in the fixing process, only the geometry problem is a new one that hadn't been reported until now. So I stripped away all known problems and left the relevant new one.CURainer@Rainer:Thanks for your answer. I am glad to hear that the problem displayed in the first slide of my test file is already solved :)I was afraid about that because the patch proposed fordon't solve it (it is another problem, which don't involve 'transparency gradient'). Actually, thisis in some way a duplicate of my old, but with a more precise description. Note thatwas considered as a duplicate of, andas a duplicate of, and nowas fixed. Butis not fixed by the patch for, it's a different problem.So my question is: as neithernorsolve the problem described here in(illustrated on the first slide of my initial test file), which bug fixed it in the master branch ?In all cases, the new title about gradient geometry isn't in adequation with my description in...I can also confirm this bug. Along with the one I reported some time ago (#39369), it makes Impress totally unusable for anything more than trivial slides.@Radek:Please feel free to reassign (or reset Assignee to default) if it’s not your area or if provided information is not sufficient. Please set Status to ASSIGNED if you accept this Bug.Not working with 3.4.4 on UbuntuI will have a look at it with 3.5 soonpersists in 3.6 (master), unrelated to cairo / hardware acceleration.Odd that it is independent of size / zoom - we can render that gradient at that size correctly; -but- when we render it in a presentation we bust it ;-) Perhaps some metafile replay thing ?(In reply to)>So we're all on the same page - in a master build, the only remaining problem I see is that rectangular gradients don't scale horizontally, to completely fill the shape, correct?Seems so, the only obvious problem I see with parallel installation of Master "LOdev 3.6.0alpha0+ – WIN7 Home Premium (64bit) ENGLISH UI [Build ID: 35ec153]" (tinderbox: Win-x86@6-fast, pull time 2012-05-02 06:53:41) is in Sample Document slide 2 "Area : black, Quadratic". In edit mode the beams lead to the corners of the shape (not rectangular), in slideshow they are rectangular to each other.Createdgradient bugs still in masterAttached an updated sample document - note that transparency gradient behaves different to std color gradient, and that hw-acceleration on/off affects std color gradient, and *only* that.Seefor a similar, but separated problem.reproduced in 4.0beta1.Interestingly, the square gradient in slideshow mode is rendered by vcl's ImplDrawComplexGradientBut in editing mode it appears to be rendered by something else; odd.Still rather unclear about this; it all seems to work rather nicely except for the 'Square' gradient.The 'Square'-ness of the gradient is rather unclear to me in the drawing-layer impl. [ which I believe is used for the large preview in the gradient dialog ].The thumbnail there however is rendered with the vcl gradient rendering and is indeed square - which is what we see in the presentation mode.Most odd - did the behavior here really change ?Createdfix square gradient renderingI'd love some review / feedback on this: Thorsten ?Thorsten ack'd on IRC; pushed.Michael Meeks committed a patch related to this issue.It has been pushed to "master":fdo#42553 - fix square gradient rendering by vcl.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Meeks committed a patch related to this issue.It has been pushed to "libreoffice-4-0":fdo#42553 - fix square gradient rendering by vcl.It will be available in LibreOffice 4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Compared the display results of 'Test_new344.odp' file between 'LibO-Dev_4.0.0.0.beta1_Linux_x86-64_install-deb_en-US' and 'Version 3.6.2.2 (Build ID: 360m1(Build:2))'. Could not spot the problem in the daily build. (Kubuntu 12.10)
id=48168	CreatedScreenshots showing Writer running on each of three monitorsI run three monitors arranged horizontally. When I run Writer on theLeft-hand monitor the various menus act properly. When I move the Writermain window to the Center Monitor, the menus appear on the Right-handmonitor and even sub-menus are on the hard left edge of the monitor so theyare placed over each other. When I place the Writer main window on theRight-hand monitor, the menus appear on the left-hand edge of the rightmonitor and are also placed over each other.I would think the problem lies in an assumption, somewhere in the code,that there are, at most, two monitors side by side and menu positioncalculations are being made accordingly. Below are screenshots of theWriter window on the three monitors.System: Ubuntu 11.04 Natty NarwhalWriter LibreOffice 3.5.1.2 Build ID 350m1(Build 102) I can confirm the problem on a Gentoo with a 3 monitor configuration, using open source ATI drivers and very clean monitor configuration done via xrandr (clean == pure RandR protocol, no tricks, no proprietary hacks).I am using libreoffice-3.5.2.2 compiled from sources on Gentoo.The relevant bugreport is here:There is another report of this issue:And also in another distros:***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***I can confirm this bug. Ubuntu 64bit 12.04, fresh install, 3 monitors, ATI 12.3 catalyst.Same problem here with 3.5.3 triple monitor, Ubuntu 12.04 64 bitIt is impossible for me to upgrade from 3.4.x -> 3.5.x with this bug :-(I'm getting the same problem on Ubuntu 12.04 and LibOffice 3.5.3.2 (ubuntu repositories). LO worked fine on Ubuntu 11.10.Interestingly, the problem seems to be dependent on the monitor layout configuration I specify in System Settings > Displays. (I have a 1920x1200 monitor connected to my 1600x900 laptop). If my second monitor is configured directly above the laptop monitor such that the two monitors have their left edges aligned then the problem goes away.However, if my second monitor is positioned so its left edge is not aligned with my laptop monitor's left edge then I can't get access to the File, Edit, View, Insert of Format menus (the other menus work fine); and LO crashes soon after I try to access any of the inaccessible menus.A screenshot of this second configuration is available here:In the screenshot, I'm trying to open the File menu.Same problem here. 12.04 64bit, 3.5.3, fglrx 12.3.Same problem here, Catalyst 12.3Just to emphasise: this is, in my opinion, a serious bug. It pretty much renders LO unusable.Given the number of people who have reported this bug, I'm going to go ahead and change the status of this bug from UNCONFIRMED to NEW although I have no idea if I'm following the correct etiquette (I'm not a LO developer, I'm just a user).I just wanted to write again with a more detailed description of the issue I'm experiencing. I'm a little nervous that perhaps we're conflating several different problems into a single bug report; but probably not. So I wanted to describe my situation in as much detail as possible...THE PROBLEM(I'll use Calc as a specific example but similar problems are present in all LibreOffice apps)If I click on the File, Edit, View, Insert or Format menu, the menu does not open. Instead I see the artefact show in this screenshotnear the File menu.If I right-click on any cell in columns A, B, C or D then I see the exactly the same menu problem.After using LibreOffice for a few minutes it usually crashes.MY SETUPLibOffice 3.5.3.2 (ubunturepositories)Ubuntu 12.04 64bit with dual monitors configured as shown in"FIXES" THAT WORK FOR ME (none of which are satisfactory)* If I disable my second monitor then LibreOffice works fine* If I enable both of my monitors and position the 2nd monitor so the left sides of both monitors are aligned and the 2nd monitor is directly above the primary monitor then it works fine.A further update: Uninstalling "libreoffice-gtk" fixes the menu problem for me (but LibreOffice looks rather ugly without GTK+ integration... but at least it works).uninstalling "libreoffice-gtk" also fixes the problem for this guy:I am at least not getting the stability issue, as long as I run my libreoffice on the left screen it works fine.Yes, it is defintely a GTK issue. If you read bugreport on the Gentoo bugzilla (linked in) you will see that launching LO with SAL_USE_VCLPLUGIN=gen 'fixes' the issue.I am also rising the importance of this bug, as it really makes LO very hard to use in multihead environments.Is the problem in the next version (3.5.4) solved?***has been marked as a duplicate of this bug. ***(In reply to)Joker. I have yet to see any comment by a LO developer on this bug, so it clearly has not been addressed yet.Apologies. Pawel clearly is a developer.The relevant launchpad bug is here BTW:(In reply to)Unfortunately not, but this bug is very important to me and this is why I am tracking similar issues and try to centralize all the reports (also by finding duplicates). I also find it VERY weird that no developer commented on this issue. I was hoping that bug with so many duplicates and of relatively high importance will be at least assigned, especially that first report is over half a year old.Oh, and the launchpad bug was linked in, but of course there is nothing wrong in reposting it, as it confirms that at least 12 other people are affected :)I can not understand this, since report of the bug we have LibreOffice version 3.5.2, 3.5.3, 3.5.4.At the moment, that is _my_ opinion, LibreOffice 3.5.x is not ready for the business.I have no desire at the moment to test new versions / release candidates of LibreOffice because such important bugs won't fix. :-(Slightly resembles this:- : Menu displays on dual-monitor systems too far to the leftMarking as regression since it is reported to not exist in 3.4.xSomeone please check if this patch fixes this bug:*** This bug has been marked as a duplicate of***Still reproducible on 3.5.4.2, which should include the fix from.Ruslan: I cannot test source patches, is there some way you can provide a binary to test against?(In reply to)According to [1], this should be fixed in 3.5.5.[1]I am running 3.6 and it is certainly fixed in thereSince there's been no posts since last confirmation of the bug being fixed, I close it as FIXED.
id=48216	Ubuntu 11.04.Writer closes many times. I can not relate to any concrete action. Is closed more often when I paste a picture and / or when I use the mouse wheel.Less frequently, Calc and Impress are closed. Do you use any extension ?Do you reproduce this with a brand new document ?Can you reproduce this with a brand new profile (remove or backup these directories ~/.config/libreoffice and/or ~/.libreoffice, check both) ?Since there has been no feedback for months, I put it RESOLVED/INVALID.Clemente: if you reproduce this on a newer LO version (3.5.6 or 3.6.2) after, if needed, renamed your LO profile (see), don't hesitate to reopen the case. Also, it could be useful your retrieve a backtrace (see)
id=43008	Createdzipped folder with two files insideSelecting an entire column (by clicking into its letter in the column heading of a spreadsheet, e.g. column F), then pasting something into that column causes a hang.Steps to reproduce:-- Select a column that has data in it, by clicking on the column header (so the entire column is selected) In my case it was column F.-- from somewhere else, copy some data - in my case, I copied six rows and two columns worth of cells, just text and numbers in those cells.-- paste it (standard paste, not special) into the original document - in my case, I had about 1900 rows of data (by about 30 columns) that started in row 8 (rows 1-7 were blank), and I was attempting to paste that 6x2 data into F1,(again column F was already selected - but the attempted paste wouldn't or shouldn't have actually overwritten anything already there.)==>> The warning dialog about cells already having data, are you sure you want to overwrite-- I take the default to overwrite the dataRESULTS: hang, spinning beachball cursor, eventually the applications is "Not Responding" and you have to force quit - and lose all your data that is not yet savedMy Configuration: MacBook Pro late 2006, Mac OS 10.5.8 (not sure about which Intel processor it is in the Hardware pop-up of this bug report, so I chose "Other")I've seen this before in Open Office, never in Excel, I don't believe. It's like Calc has no conception of where the lowest row of data is, and dumbly just goes on forever down to row infinity,ATTACHMENTS (two BBEdit files in a zip-compressed folder called "Column selected paste hang bug"): 1) A sample graph from the Mac OS X Terminal app while the beachball was spinning, and 2) the bug report info sent to Apple that comes up when you force quit (both the "Problem Details" and "System Configuration" sections are included.) It does not crash here with 3.4.4 on Linux. It filled the column until the row 1048576. Well, I might have been just lucky.Another question is if this operation makes sense. IMHO, LO should warn before doing such thing.It is a corner case. The operation does not make much sense. Of course, LO should not crash but such bug can't block the release => lovering the priority a bitThis is a feature and not a bug.If you select a range larger than the copied range calc pastes as many times as possible the content into this range.We might need to rethink this feature in future but right now this is not a bug.Good Luck with your LibreOffice where selecting a column becomes an adventure. I've purchased Office for Mac 2011I vote to reopen this "Feature" report.I created a trivial formula in a cell (=A1+B1), copied it, selected the whole column and pasted it. LO hangs 1 core 100% -> after 5min Mem fills up (8Gb) -> System hangsThe mem fillup rate is not linear, it "lingers" a while at 1 to 1.5 Gb and then goes to 80% in 2 minutes or so.This is problematic. I understand the argument for this "do this to a potentially infinite column of this sheet".In these Programs however, pasting something into a column largely means: "Please column, behave this way!". Otherwise I'd recommend to disable pasting into columns, because it is almost never what you want it to do.Even Gnumeric is smart enough to catch this by asking "Do you really want to paste 65535 copies?(y/n)"!And even when I say yes it doesn't die as LO does.As I understand it their infinity is only about 6% of your infinity but, well, at least I can paste into a column without an adrenaline rush.I dare not fiddle with the controls as this is my first bug report here, but please oh please rethink this one.Sysinfo:uname -srvpioLinux 3.2.0-3-amd64 #1 SMP Mon Jul 23 02:45:17 UTC 2012 unknown unknown GNU/Linux(Debian Testing)Package: libreoffice-calcSource: libreofficeVersion: 1:3.5.4+dfsg-2Installed-Size: 23894Maintainer: Debian LibreOffice Maintainers <>Architecture: amd64***has been marked as a duplicate of this bug. ***Lost my work by crashing LibreOffice calc.Closing in Gnome does not work, soffice keeps running.Had to kill soffice in the terminal.Steps to reproduce:- type something in A1- type soemthing in A2- select A1..A2- copy- click on column B by accident instead of selecting B1- paste: memory usage rises, program hangs, work lost.Talked to colleagues about this, they also experienced this too many times.They are now using Microsoft Excel, because of this (and also because of the too low maximum amount of columns possible).Mission critical.Fix it or disable it!This is a serious bug that is reproducible in Openoffice, Libreoffice, and Neoffice, on my Macbook Pro, 10.8.5. Basically makes the spreadsheet application of these MS Office alternatives useless.(In reply to)This bug applies equally to rows.It is very likely that a user will mistakenly select an entire row or column when intending to select the first cell in that row or column, thus triggering this bug and potentially losing a lot of work.Just wanted to add that this issue still appears in Version: 4.2.4.2.If a user selects an entire row or column eventually LO will hang and crash as it continues selecting cells into infinity. It is hard to see how this is a feature. We are testing this suite to see if it might be a fit for our company and this is the first real deal breaker we have encountered. Is there any insight into a fix or workaround for this issue?This was closed by one of our most experienced spreadsheet developers (Markus). Please don't reopen it as it currently is. If you are so inclined, please create a new feature request that details what you expect to happen. As I see it, this is a feature, not a bug.Again please don't reopen this bug, as it is written now with the description, it's a feature, not a bug. See.So the question that must be answered on any new feature request is "what do you expect to happen when you copy and then paste into a much larger set of cells." Would a dialog warning that if you continue it may freeze depending on how many cells were selected/pasted in suffice? Would an autosave immediately before a large paste be better? Please be clear, objective, and without blame in your new report. Thanks***has been marked as a duplicate of this bug. ***
id=48352	Open a PDF with monthly calendar of Draw.The dates 1, 2, 3, 4, 5, 6, 7, 8 and 9 be11, 22, 33, 44, 55, 66, 77, 88 and 99.in Draw.With version 3.4 no problem.Jos why dont import more pdf, why dont more open pdf....Could you attach a sample PDF file that demonstrate this problem?Op 7/07/2012 8:15,schreef:>Solved in the next version of L.O.Thank you for your bug-report!unknown Whiteboard key word
id=48398	Problem description: Steps to reproduce:1. install from LibO_3.5.2_Linux_x86-64_install-rpm_en-US.tar.gz from LO website2. start from terminal or icon3. ....Current behavior:welcome screen shows program initializing ...then just terminates without warningExpected behavior:selected program expect to open for usePlatform (if different from the browser): Kernel: 3.3.1-1-desktop x86_64 (64 bit) Desktop KDE 4.8.2 Distro: openSUSE 12.1Mobo: A880G+ Bios: American Megatrends version: 080016 date: 01/25/2011Quad core AMD Phenom II X4 965Graphics: Card: ATI RS880 [Radeon HD 4250] X.Org: 1.10.4 driver: fglrx Resolution:GLX Renderer: ATI Radeon HD 4250 GLX Version: 3.3.11566 - CPC Browser: Mozilla/5.0 (X11; Linux x86_64; rv:11.0) Gecko/20100101 Firefox/11.0libreoffice3.5.2 is now installed and working.it would not run before the package : libreoffice3.5-stdlibs-3.5.2-202.x86_64.rpm was deleted.a similar issue was encountered installing from LibO_3.5.1_Linux_x86-64_install-rpm_en-US.tar.gzon all previous installs no problem was encountered today another similar machine was upgraded to libreoffice 3.5.2-202.x86_64, before libreoffice 3.5.1-102.x86_64 had been installed,no problems were encountered running any of the programs after installationhence I returned to the machine which did have problems and did a re-install,again no problems occurredso today the problem reported cannot be reproduced,minor updates have occurred to the os's over the weekendunless other people report the same difficulty,it's suggested this bug report be closedOK, good to here, that you do not suffer from such a problem anymore...
id=48775	when i open in writer [extras]=>[literaturdatenbank] (i think in english its something like literature-database?!) writer is crashing without any alert.i did the same from terminal and got this output:terminate called after throwing an instance of 'com::sun::star::loader::CannotActivateFactoryException' Do you talk about "Bibliography database" in "Tools" Menu ?If yes, I don't reproduce it with 3.5 branch on pc Debian x86-64.You may try with 3.4.6 (last version of 3.4) or better, you should give a try to 3.5.2 version.Could you also give more information about your Linux distribution (which one, which version) ?(In reply to)yes i think bibliography database is the right one.i'm using ubuntu 11.10i will take a try to get newer version of libreoffice and will give you a feedback about this.well, i tried to open tools => bibliography database in writer 3.5.1.2 (build id: 350m1 (build: 102)) running on ubuntu precise beta i386 (in vmware) and i had the same problem: crashing writer.ubuntu opened the report-a-bug-dialog and told me it is already reported, but i couldn't find it in launchpad...(In reply to)It seems that Ubuntu does not install base module by default. You should check if this module is installed for you.Best regards. JBFThis is set to NEEDINFO, which additional information is needed?I can reproduce a crash (no error message though); my version is:Version 3.6.1.2 (Build ID: e29a214) (running on Windows 7)I installed only Writer, Calc and Impress (no Base).I assume the best way to fix this is check if Base is installed, and pop up an error that base is needed for the bibliography database if it is not installed.On Debian, if I try to uninstall LibreOffice-base, apt indicates it'll remove all the other LO packages.I took a look toand obviously with a custom install you can unselect BaseRainer: I'm a bit stuck here, any idea?[Reproducible] with LibO 3.5.5.2 Build ID 350m1 (Build:202) on Ubuntu 12.04 64 bit (VirtualBox).I submitted "- CONFIGURATION: UBUNTU offers menu 'Tools - (open) Bibliography Database', although Base not installed by default", and my suspect also is that missing Base Module causes the crash.I am tending to close this one as NOTOURBUG (until proof of the opposite) because i am pretty sure that this bug is Ubuntu only, caused by the particular way of packaging. But of course it would be interesting to see what happens with other Linux Distributions and other OS if Base is not installed. I will try with a Master build.[Reproducible] with parallel installation of Master "LOdev 3.7.0.0.alpha0+ - ENGLISH UI / German Locale [Build ID: 6cad15d]" {tinderbox: @6, pull time 2012-09-03 23:08:07} on German WIN7 Home Premium (64bit)I installed without DB module and now can reproduce the bug, also on Ubuntu 64Bit (VirtualBox) with 3.5.2.Together with "- CONFIGURATION: Menu 'Tools - (open) Bibliography Database', although Base not installed" this one is really annoying. I do not know whether we will have to fix both bugs separately, I can not provoke a crash by simply trying to open an arbitrary .odb(In reply to)While hiding that menu item is IMHO good idea, I think it is not a solution here. Because one can for example write a macro to launch Bibliography Database, something like frame = ThisComponent.CurrentController.Frame serv = createUnoService("com.sun.star.frame.DispatchHelper") serv.executeDispatch(frame,".uno:BibliographyComponent", "", 0, Array())and it will crash as well.It turns out the problem was fixed (see) but for some reason it is reproducible now. I reproduce it with 3.5.4 from Ubuntu 12.04.Bjoern, could you have a look again? Thanks!P.S. I manually removed the files provided by the "libreoffice-base" package and lcl_isBaseAvailable returns true. I have no idea of that, but there is another way to check for Base installed: SvtModuleOptions().IsModuleInstalled(SvtModuleOptions::E_SDATABASE)Still reproducible with Version 3.6.3.2 (Build ID: 58f22d5). I have written a document which has a few includes and one without something in it.I think, first you have to test, if the module exists. If not, give the user a hint, he has to install the database module. If you only hide the button, users will be searching for it, if the have written documents using this and after the upgrade, this button can't be found.The case with scripting will be the same. With a clean errormessage, the user will found out, how the problem could be fixed.Greetings from Switzerland, MarkusStill happens in 4.0.0.0.beta1 (Build ID: 87906242e87d3ddb2ba9827818f2d1416d80cc7)(Win7 x64, lodev base not installed)I also reproduced this on Windows with a Master build.Version field is *oldest* (not newest) version where reproduced.Please put "reproduced in newer version" in a comment, saying exactly which version (for nightly/private builds, give build ID and approx date of last commit/pull).I can reproduce this with 3.6.5.2 on Windows 8. Is it being worked on?Can we get a trace of this ? It is quite possible that we need to get a breakpoint in _exit to see where it is called from; it is entirely possible that we need to run the app then insert a breakpoint into: __cxa_throw, continue and then dump traces for all exceptions until the one that causes the exit - but it'd be good to know where in the code that is coming from.Thanks !(In reply to)I'd like to but after building master sources + "make dev-install", how to disable temporarely Base?I can only contribute my experience with WIN: The only way to get rid of the Bas module (or an other one) is to install LibO with Custom installation and to disable Base during installation. I am pretty sure that that also works for parallel installation. I am also able to disable Base from WIN System Control (Uninstall-Repair-Modify). But I never found a way to do that for a Server installaiton. Theory is that the .msi in the folder with the server installation should be able to do that, but I failed. What ever that might mean for Linux.bfoman: would you have some time to give a try to this bug to retrieve an useful bt?Will check.Created- WinDbg session with FAILED_SOURCE_CODEConfirmed with:LO 4.0.0.3Build ID: own W7 debug buildWindows 7 Professional SP1 64 bitUninstall Base component (if installed). Go to Tools>Bibliography Database - instant crash. Attached full WinDbg session with FAILED_SOURCE_CODE.Personally I don't see this as a MAB as it only happens under very specific situations that only affect a very small number of users (custom install + try to do biblio stuff) but I'll defer to Rainer's judgment....moving to 3.6 MAB so that we can close the 3.5 meta tracker (as 3.5 is no longer being supported).Also marking as NEW as bfoman did his magic and got us a bt :)***has been marked as a duplicate of this bug. ***In master, Bjoern added this nice packagekit hook to allow people to install the 'base' module - which (I guess) mostly fixes the user experience here for Ubuntu.I added a check for an exception on load there; we should silently fail in the case that the database is not installed - better than a crash for sure. Since I can't reproduce, testing is much appreciated ! :-)Thanks for the trace bfoman - very helpful ...Michael Meeks committed a patch related to this issue.It has been pushed to "master":fdo#48775 - presumed fix for missing bibliography database exception crash.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Version: 4.1.1.2Build ID: 7e4286b58adc75a14f6d83f53a03b6c11fa2903(Windows 7 64bit)(installed: writer, calc, impress; no base)just tried this again (started writer with new document, Tools->Bibliography database, instant crash)reopening since fdo#48775 is supposedly fixed in 4.1.0:clemty: we need a new trace - this is one of those wonderful bugs that gives and gives I guess :-) it'd be great if whomever distributes LibreOffice in this mode fixes it (or distributes base too ;-).Michael, that's the official installer from- the setup lets me choose which components to install and since I only use writer, calc and impress it makes no sense for me to install base if setup offers me a choice@Michael: So that snipe goes back to TDF builds as its Windows version allows for this brokeness. Note that the Ubuntu version (which you are aiming at) actually pops up a session installer dialog and asks for base to be installed.So: Not a Linux bug (as Debian/Ubuntu handle it properly AFIAC and TDF Linux builds have an empty "base" package anyway).(In reply to)Could we have a look at the patch that does that, please?Link (assuming Ubuntu has something like) or attach it here.Quid? TDF GNU/Linux builds don't ship base?Code is upstream and around here:(except that the restart doesnt work and needs to be done manually, but thats not mission critical)It seems TDF build ships everything in core and the base package is a fake empty package.I just tried to reproduce this with Version: 4.2.0.1 / Build ID: 7bf567613a536ded11709b952950c9e8f7181a4a (on Windows 7)This bug should be now avoided since windows installation was changed to automatically install all parts of LibreOffice (including the Base module, which is needed for the bibliography database) (see)I installed 4.2.0.1 over the older version (I think it was 4.1.2.3) and the base module was not installed (no File->New->Database menu entry, crash was reproducible). The bug was however resolved after I deinstalled the older LibreOffice, then reinstalled 4.2.0.1 instead of merely upgrading (Base is then installed).For this reason I'm changing the status from NEEDINFO to NEW since imo either during upgrade setup needs to make sure base is installed even when it wasn't before or to make this explicit in the documentation.OTOH, feel free to close this bug if you feel this bug is now resolved for Windows or you can't reproduce.(This is an automated message.)Setting priority to highest as this is a 4.0 MAB. This is part of an effort to make the importance of MAB reflected in priority too.(In reply to)Closing this one as WORKSFORME then. Forcing to always install all components even on update is an different issue IMHO and should get a new bug then.
id=49181	Createdlocking toolbarsToolbars are rigidly fixed and do not move. (In reply to)------------LOdev 3.5.4rc0+ Build ID: 8d9e2d9-a73d29c-6845e52-f269e46OS: Windows-XPsp2_x64; Windows-7sp1_x32Works for me (on WinXP 32b) with LOdev 3.5.4rc0+ Build ID: fc0c85e-a73d29c-6845e52-f269e46-186d9edtinderbox: buildname: Win-x86@15-Prague Win32tinderbox: tree: libreoffice-3-5tinderbox: pull time 2012-04-21 20:05:59(In reply to)This build is the last worker.NOT Reproducible with "LibO-Dev_3.5.4rc0 [Build ID: ec752de-73cb0b8-f269e46] Win-x86@6-fast pull time 2012-03-19 11:08:23 – WIN7 Home Premium (64bit)@reporter:Thank you for your report – unfortunately important information is missing.May be hints on <> will help you to find out what information will be useful to reproduce your problem? If you believe that that is really sophisticated please as for Help on a user mailing listPlease:- Write a meaningful Summary describing exactly what the problem is- Contribute a step by step instruction containing every key press and every mouse click how to reproduce your problem (due to example in)- add information -- what EXACTLY is unexpected (cursor does not change to "move view"?) -- and WHY do you believe it's unexpected (cite Help or Documentation!) -- concerning your PC -- concerning download source, pull time, ... –- Libo settings that might be related to your problems (video hardware acceleration ...) -- how you launch LibO and how you opened the sample document -- everything else crossing your mind after you read linked textsEven if you can not provide all demanded information, every little new information might bring the breakthrough.Please submit Bugs with initial status UNCONFIRMEDMay be you can test <> for submitting bug reports?(In reply to)----------The problem emerged in last two builds "Win-x86@7-MinGW": 2012-04-25_14.56.06; 2012-04-25_14.56.06.I did not check for errors the "Win-x86@7-MinGW": 2012-04-23_07.08.07; 2012-04-24_11.37.45.Hardware (the mouse or the touchpad) and Windows does not affect the occurrence of the error: "Win-x86@15-Prague_Win32" dated April 21, works fine at these PC's.The last builds does not allow you to take and move the toolbars (Writer: "standart" or "format") by the mouse or the touchpad. The cursor (crossed arrows) does not appear.(In reply to)---------Sorry:The problem emerged in last two builds "Win-x86@7-MinGW": 2012-04-25_14.56.06; 2012-04-26_09.53.25.Probably DUP of "- MinGW: UI display broken"@ape:May be you suffer from a.m. Bug "Mouse pointer disappears instead of changing to "move arrows""?When I move mouse pointer to the toolbar handle area at the left coming from the right, mouse pointer will disappear at the handle area and reappear moving further to the left as shown in you screenshot. But I can move the toolbar by drag and drop with the invisible mouse pointer. Can you please check?(In reply to)@ape:Can you please use build info strings similar to the one you see in my Comment with additional info whether it's from Master or daily branch (I will add that info in future, too)? That will ease to recognize relations very much.(In reply to)------1. Yes, this is the Bug_41985. The control panel is took and was moved by the cursor invisible. But it was very difficult to do on Asus_EeePC.2. Last release with bug:LOdev 3.5.4rc0+ [Build ID: 8d9e2d9-a73d29c-6845e52-f269e46]Win-x86@7-MinGW pull time 2012-04-26_09.53.25 - WIN7 Home Premium sp1 (32bit) and WINXP Proffessional sp2 (64bit).3. About "Master":NOT Reproducible with "LibO-Dev_ 3.6.0alpha0+" [Build ID: b77858b] Win-x86@7-MinGW pull time 2012-04-26_23.01.24 - WIN7 Home Premium sp1 (32bit) and WINXP Proffessional sp2 (64bit).DUP due to. @ape:Can you close that one WFM if you can reproduce that it still works fine in second build?*** This bug has been marked as a duplicate of***
id=49120	CreatedA zip file with two sample files - one corrupt and one not corruptI have a file created created in Excel 2010 and saved in XLSX format.If I simply open this file and any minor change (just something to enable the save button) and then save it in LibreOffice the file becomes corrupt.If I open again (after savings and closing) in LibreOffice the row and column headings are not visible and and worksheets are gone.If I open it in Excel it reports the file it corrupt.This is a major issue for us (and I would imagine others?) as it actually appears to completely ruin the file. Not displaying correctly is one thing but we had to halt use of Libre for the time being as this is happening on many computers in our organization.I have attached the file before corruption and after corruption (zipped to one file).I am running Windows 7 64-bit but this ha also happened on Windows XP as well.LibreOffice is version 3.5.2.2 Confirmed with:LOdev 3.5.3rc1+ Build ID: 51648779-22e3d74-d554af7Windows 7 Professional SP1 64 bitAlso confirmed with:LibreOffice 3.5.4.2 Build ID: 350m1(Build:2)Ubuntu 12.04.1 LTS 64bitNOT confirmed in LibreOffice 3.6.0.4 (Build ID: 932b512)Windows 7 Starter SP1 32 bitCreatedGlitches after saving and reloadingI tested it with LibreOffice 3.6.1.2 (Build-id: e29a214 on Windows XP 32bit), after saving, the file can be opened but looks corrupt.See screenshot 2012-08-30_09h03m_before_after.png .NB Before I changed anything, I placed the cursor in cell A1. After opening the saved file again, this is what I noticed:- not A1 is shown, but some other part of the sheet- graphical glitches, ie cell numbers dissappearI didn't check to see if all formulas stayed the same.CONFIRMED: Windows 7 64 bit SP1Libre-Office 3.6.1.2 Build: e29a214This issue still occurs as mondane.woodworker also confirmed.Still a big issue as it destroys existing files with no way (that I can see) of getting them back.Confirmed with:LO 3.6.3.1Build ID: f8fce0bWindows XP Professional SP3Graphical glitches after saving and reloading. All sheets are switched from Window>Freeze to Window>Split option. When switched back the graphics is rendered correctly. No data corruption at first sight.Confirmed still bug in v3.6.4 on Windows7 32bitCorrupts save of .xlsx file. Loosing all tabs to all other sheets in workbook and alphabetic column headings, probably more but these are most apparent looses.Also confirmed with:LibreOffice 3.6.3.2 Build ID: 58f22d5Windows 7 Professional SP1 64 bitAfter the file was created in MS-Office, save as a .xlsxOpened in LibreOffice worked on it and saved again as .xlsxNow some data is inaccessible.Is there any way of retrieving the data back???Unfortunately there appears not to be any way to get it back - that is why this is such a critical bug. It is 100% reproducible and yet it has been sitting here for 8 months.(In reply to)CONFIRMED again - LO 4.0.0.1 (RC1) Windows 7 64-bitOpen the file marked "Good" (in the zip file attached to this post) - make a change and save it. The file is then corrupt.This is extremely serious -I don't know anyone that does not interact with MS Office users at some point - the fact that you have the potential to lose data is a serious problem.CONFIRMED again - LO 4.0.0.3 (release) Windows 7 64-bit.This is a very serious issue.Yes this is a very serious issue - how can we get any attention put on it though? Nobody seems to care, it has been here for almost a year.Please do not change the version field as this indicate the earliest version where bug was reproduced. I will set it to 3.5.2 release per original report. If this bug is reproducible in newer versions - please add a comment and leave the Version field unchanged.(In reply to)Oh, then it is the exact opposite how RedHat/Fedora bugzilla works. There reports for old versions are closed (WONTFIX) and people are asked to clone the report for new versions.I wonder whether it would make sense to create a new bug report for LO 4.x as "blocker" merely asking for XLSX saving to be disabled entirely until this bug is solved.Hi everyone. I need this bug/feature so much that I'm willing to pay 100.00 bucks for it.This offer is registered at FreedomSponsors ().Once you solve it (according to the acceptance criteria described there), just create a FreedomSponsors account and mark it as resolved (oh, you'll need a Paypal account too)I'll then check it out and will gladly pay up!If anyone else would like to throw in a few bucks to elevate the priority on this issue, you should check out FreedomSponsors!I also added $100 to the pot.It seems, the problem is fixed in LibO 4.0.1: After modification of the test file in 4.0.1, the result is not corrupt or empty in LibreOffice. The result is attached for MS Office testing.(In reply to)Oops, the result is the same as in the attached screenshot, so this filter problem hasn't fixed yet in LibO 4.0.1.(Possible workaround: using XLS (Microsoft Excel 97/2000/XP/2003 .xls) instead of XLSX. The XLS output filter keeps all worksheets of the test file.)Yes XLS is a workaround but each day XLSX becomes more popular and you can't control the format the people will send you documents in. (In reply to)Createdquick-fix-patchThis is a quick patch that probably fixes this "file-corruption", which is caused by a minor missing feature.(In reply to)Thanks! Can you please send a blanket license statement to, saying:"All of my past & future contributions to LibreOffice may be licensed under the MPL/LGPLv3+ dual license."Iranyossy Knoblauch Artur committed a patch related to this issue.It has been pushed to "master":fdo#49120 - Implementig XML_stateThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.I have tested it. It seems, only the background colors have changed to black in the test file, so I hope, the modified XLSX will be good for Excel, too. The result will be attached to test it.Many thanks for the fix!CreatedTest file after modification in the fixed LibreOffice.Note: background colors are correct in the Google Doc XLSX preview (Google Doc cannot edit the original and the modified XLSX test files).Iranyossy Knoblauch Artur committed a patch related to this issue.It has been pushed to "libreoffice-4-0":fdo#49120 - Implementig XML_stateIt will be available in LibreOffice 4.0.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.This corrected the corruption - the workbook opens in Excel 2010 and 2013 now. It does loose cell borders and some background coloring though.@ikarturThanks for your fix! If you could please create an account at FreedomSponsors, me and the two other people who sponsored the bug there will be able to pay you the combined $300 bounty for the bug.No particular rush. But we can't pay you until you have an account, and have added yourself as a worker on the bug.Hello All,I am trying to convert Micorsoft XLSX file to PDF using Libre Office 4.0.1 and latest version of Libre office 4.1.4, but the PDF which is forming is corrupted. (Some portion of xlsx file is not saving in PDF file)Kindly please let me know what is the solution for the above query. Any help ASAP is really appritiated.RegardsVikramThis is fixed. Just look at:payment has been made.If any pdf export fails, please open a separate new bug, since this bug is about something else. Thanks :)Please do not change the version field as this indicate the earliest version where bug was reproduced. I will set it to 3.5.2 release per original report.
id=48887	CreatedExample filesWhen you export a document that contains images to a HTML file it embeds the images into the html. That is, it embeds the binary data.I believe that images should instead be saved in a folder with the same name of the document and instead be link to those files. Embedding the images into the html file is a bad idea for two reasons:* It results in the browser having to load a much larger file* It actually results in an overall larger file. In the attachments. In the attachment the 4x4px gif (39 bytes), when embedded, results in an html file that is 86 bytes. When the image is instead link the combine file size of the html file and gif is 61 bytes. 25 bytes is wasted, which will only grow larger as the images used get larger embedding the images in the html should probably be optional.Createdresulting html file and original filePlease also see the attached html file generated with /opt/libreoffice3.6/program/soffice --display :1020 --convert-to html --outdir ./ Untitled\ 2.odtThe embedded image is not show by any browser.I forgot to mention that this was tested in fedora with 3.6.1CreatedODT and example X/HTML output under v3304 and v4132.I think this bug can be RESOLVED as NOTABUG. At the very least this bug would need to be changed to an enhancement request as it is asking for a new option that has never existed. There are separate filters for converting a file opened in Writer to HTML in such a way as to embed or link any included graphics:- File > Export > select File Type of "XHTML" will embed the graphics.- File > Save As... > select File Type of "HTML Document" will link the graphics.These two filters can be used via the command line as:$ soffice --headless --convert-to html:"HTML (StarWriter)" file_to_convert.odt$ soffice --headless --convert-to html:"XHTML Writer File" file_to_convert.odtI have tested this functionality under Ubuntu 10.04 x86_64 running:- v3.3.0.4 OOO330m19 Build: 6- v4.1.3.2 Build ID: 70feb7d99726f064edab4605a8ab840c50ec57a... indicating it has always been this way. The problem indicated byis a completely separate issue that is raised (using the same attachment) in.Changed Version to Inherited From OOo as a result of.(In reply to)It would appear that since LO v4.2 the fix tohas made this situation worse as now it is impossible to create a HTML file from any of these sources:- ODT with embedded graphic.- ODT with linked graphic.- HTML with embedded graphic.- HTML with linked graphic.... and produce HTML output (via either quoted method) with a linked graphic. All graphics are written out as base64 embedded. Unsure whether to mark this now as a regression, since the v4.2 change.I agree to Antonio and Owen Genat. It is not any longer possible to create simple html with pictures linked in 4.2Furthermore, and much important, html files with images saved in lo 4.2 writer don't open anymore in lo. lo crashes if you try to do.That means, you can open them in a browser (slowly) but if you wan't to change the code of the html file you must use another text editor.For my opinion, it should be restored as it was until 4.1 and as Owen Genat says:- File > Export > select File Type of "XHTML" will embed the graphics.- File > Save As... > select File Type of "HTML Document" will link the graphics.It is a regression and users complain about it.This one is a killer. It makes using LOweb useless as a simple wysiwyg html editor. Any web page with images is corrupted with filesize expanded by nearly an order of magnitude. That often results in web pages that cause the infamous 'read error' on the image showing pages of 'code' that text and html code editors often complain is a line too long for editing.The fact that there is no obvious work around leaves me high and dry with no options. I finally got a client to upgrade - and boy did I get blown out of the water on this bug.Please disregard myand. I am setting the version back to the earliest 4.2 release due tothrough. Summary amended for clarity. I am also setting the Severity to major, although it would appear, according to the Bug Triage flowchart (), that it may be a blocker. I will leave it to QA to confirm this.Pulled from my:Yes since 4.2, images added to files are saved as base64 encoded images embedded into html files, unless you check the 'insert as link' checkbox in the file insert dialog, but for some reason this isnt happening.Confirmed in Linux Mint in 4.2.4, 4.2.6 and 4.3 beta. It does work correctly with referenced images in .odt files but not .html files.***has been marked as a duplicate of this bug. ***Confirmed 4.2.5.2(In reply to Regina Henschel from)FWIW, a quick note for the next time: if this is about a behaviour change in 4.2 it would have likely be better to open a clear new bug, not reuse an old one from 2012.(This is an automated message.)It seems that the commit that caused this regression was identified. (Or at least a commit is suspected as the offending one.)Thus setting keyword "bisected".I'm not sure if this is the correct place to comment, but if this is added as an option, it would be wonderful if it were possible to control it from the command line. I use libreoffice with --headless --convert-to to automate conversion of some files, so a fix that only involves the UI would not solve this problem.Thank you!Adding bibisected to whiteboard as bisected keyword is a subset of bibisected whiteboard.Thanks!***has been marked as a duplicate of this bug. ***AFAICS, in current versions, at least 4.3.x it's not possible to use a filter which doesn't embed the raw images.Quoting myself from #88038:The data URI shouldn't be used per default.- It's definitely not the standard in the web.- Supporting it is not mandatory as per the HTML standards. Many browsers don't support it.- It's really a crude hack anyway, as it blows up the data size extremely.Moreover, it breaks any usage scenarios of e.g. using the --convert-to functionality within git for diffs of git managed opendocument files.It's really disturbing that such functionalities are removed in the first place (I thought LibreOffice != GNOME and features would be added, not dropped)... and even more that this is left open for such a long time o.OCheers.LibreOffice 4.2.7.2All the same. I can't use LibreOffice because of this bug. For now I start looking for any other Office which can store images separately from an HTML index file...Returning version number back to it earliest affected version. With this issue, LO is unusable to save to html or create html in Writer Web.***has been marked as a duplicate of this bug. ***I was also able to succesfully open the attached file(in 'Example files.zip', named 'embedded.html'), which was posted with the bug in LO Writer 4.4.3.2 I think this bug can be closed?This was caused somewhat unintentionally resolving mail merge features of-- "MAILMERGE: looses embedded image when e-mailing as html"The UX and design side has it under consideration as-- "WRITER WEB: handling of inserted images -- data URI embedding as base64 for email support, broke LO as HTML editor"But, point remains that HTML editing in Writer Web is misbehaving because images are being embedded into the HTML as base64 images by default when saved as HTML (an export filter). Ignoring/overriding settings to link the image.Good for email merge--bad for Writer as an HTML editor.Simple STR:1. create File -> New -> HTML document to launch Writer Web session2. type some text3. insert an image4. verify image is available as a link (Edit -> Links)5. save close6. reopen7. image not available as a link (Edit -> Links), rather is embedded into the HTML as an <img> stanza with base64 encoding.Presently, no way to do anything except embed. Specifically can not link by reference.@Ciorba Edmond, could you perhaps revisit your work on-- where the export to HTML filter actions are now always converting images, without regard for Writer's dual role as an HTML editor. In that mode, Writer does better with a document without embedding the images and so can honor the links.Remains a nuisance into 5.0.0rc2 and current master.In my own experience and as IT support, using Writer as HTML editor is a much more common use case than to mail merging HTML email. If there is not a fix planned for this, we should consider revertingVasily has been working on the HTML exporter.FWIW, some of us do want images embedded when we export to html. Can this be optional?(In reply to Michael Adams from)Please do not adjust details of bug reports, this first occurs in 4.2.0.4--not the current 5.0.1.2 release.In reply to Michael Adams:If you want to RETAIN the embedded image in your document (as distinct from=merely including the link to the image), then:1. From the menu, select "Insert > Image > From File"2. DON'T click the "link" tick-box at the bottom left of the "Insert Image"=dialogue box.The problem here is that (at least in my Version: 4.2.8.2) the embedded image is retained even if you click the "link" tick-box).(In reply to Luke from)I do like the export of images in HTML mail...An option would be great, yes.(In reply to Cor Nouws from)Well sure but the real problem, since default embedding of base64 image into HTML to support for mail merge was implemented, is that we have broken our ability to edit the resulting HTML in Writer Web mode. That default needs to be adjusted--an option on save, or detecting use for mail merge/mail send and only do it then.See the UX-advise(In reply to Leon Arundell from)I'm not 100% sure those two things should be tied together. If you email a file or otherwise send it, you need to ensure the images are embedded. On the other end though, it'd be nice to be able to make an HTML file without embedded images without too much fuss.(In reply to David N. Welton from)They absolutely should NOT. Imagine if by changing the type of link, it changed the export format from doc to docx without notifying the user at save time. This is essentially what Leon is suggesting.These are 2 different types of export formats, standard HTML and non-standard HTML with Data URIs, which is not supported by all browsers. Because Data URIs are non-standard and only useful for email (a very rare use case since all mail clients handle this), if we're going to support them it should be an option at export time. We should never use this format unless the user explicitly requests it, never implicitly tied to the document structure.Until we have the resources to add an option for Data URIs, we should revert commit 5dd1b3da.I'm not sure whether David N. Welton () and Luke () agree or disagree with me.I argue that users should have the OPTION of saving an HTML file with images that are linked (and external to the html file), as distinct from embedded in the html file.My current versions of LO Writer (4.2.8.2 for Ubuntu and 4.4.5.2 fr Windows) do NOT provide this option, even though they offer a non-functional "Link" tick-box when inserting an image from a file.I cannot use 4.2.8.2 to edit an html file with an image greater than about 50k, because once Writer has embedded the image and reopened the file, it displays the image as thousands of ACSII characters rather than as an image. Thankfully this problem has been fixed in 4.4.5.2.Leon Arundell,We all agree with you. With 4.2, we can not longer properly edit HTML files. 4.2 generates non-standard HTML that many browsers do not support. It also changes the structure of the file without the user explicitly asking for it. Finally it introduces bugs like you have encountered.The issue you described is related but needs to be tracked separately. Have you filed a bug report? We should never silently corrupt documents on save. We either need to fix the size restriction or warn users that the images are too large to be embedded.A Writer document saved as HTML is loaded fine with Mozilla Firefox 42.0 but the images do not appear on Internet Explorer 8.0 on am Windows XP machine.Version: 5.1.0.0.alpha1Build-ID: a8e4f75fe264f6ece37c154951cff53f2f4fa3e4Gebietsschema: de-DE (de_DE)IE 8.0 and Windows XP should be no longer supported?Both Dreamweaver CS6 and IE Edge on Windows 10 cannot read Libreoffice 5.2 files saved as HTML, but have no issue with those saved by LO 4.1. We should not be embedding images without the user explicitly requesting it. We should not write non-standard HTML.Should be reverted until this is resolved.(In reply to Luke from)How would you revert it, please? If you read the patch carefully, you will realize that it is not easy. In the last 2.5 years there were so many changes, that we cannot revert to the old code, but it has to be rewritten. Ideally we need to introduce a new html filter option. We have SkipImages and SkipHeaderFooter, probably we should have ImagesAsDataUris option which is not set by default, but the mail merge wizard sets it. Later a UI can be written for the option, if users find this useful. It would have been good to write the original patch like this in the first place, but the student who worked on this was not skilled enough and I did not foresee all of the consequences. Nevertheless mail merge is more important in the enterprise than html editing, so after all the current behaviour is better in my opinion, than it was before.Browsers not rendering data-uri sounds strange [1]. Here with 5.0.3.2 writer uses "image/*" as mimetype, could it be that using * instead of explicit format is confusing other programs? Anyone with IE at hand can double check?[1]Migrating Whiteboard tags to Keywords: (bibisected)I have registered for this forum to agree with Luke. I was using Libre Writer 4.1 and the Save As HTML function worked perfectly with images properly exported as links. I have updated to Libre Writer 5.0.3 and now the Save As HTML function does not export the images. This is a disaster for those of us who use Libre Writer as an HTML web editor. Apparently someone at the Document Foundation is not aware that in Save As HTML, images MUST be separate links. Please please fix this error as soon as possible. In the meantime, I either need to go back to Libre Writer 4.1 or use some other document processing program. The real question is how such a major error could have occurred without someone at the Document Foundation catching it???(In reply to David Spring from)No that is not correct. They are embedded as data URI into the HTML/XHTML by export filter with the "save as". The data URI is read correctly by all current web browsers and most applications. Unfortunately for the 5.0.x release the data URI were not being correctly read back in to LibreOffice. That has been fixed in master (5.2)--but needs to be back ported to 5.0 and 5.1 branches.And? Feel free to simply revert to LibreOffice 4.1.6, from archive here:It will be sorted out eventually.According to whom? Use of data URI (RFC 2397/3986) is perfectly acceptable HTML/XHTML format. Saying otherwise is just FUD.However as noted, there are two valid concerns here. One is that linkage details, as recorded by user preference in the ODF document, are being lost during filter export to HTML/XHTML, and can not be restored on import back into LibreOffice for editing in Writer/Web--loss of data and a legitimate regression.The other facet, is that the use of URL (links: both relative and absolute (RFC 1738/3986) regardless of preferences set per document--is not being honored during export filter to HTML/XHTML, so images are always embedded as data-URI--again a legitimate regression, but just for not honoring a user preference.Nope! That is not the way the project works. Rather see, and follow enhancements for HTML5 and CSS3 suggested in(In reply to David Spring from)The real question is how such a major errorJust to clarify this. There is no one "at the Document Foundation" checking bugs. This is *entirely* dependent on volunteers. If you would like to be a volunteer and test pre-releases out so that we (collectively, as volunteers) catch bugs earlier please feel free to join the QA mailing list or the chat at:I can confirm that Save As HTML is handled correctly in the latest version of Open Office. So this is strictly a problem with LibreOffice. In my opinion, this issue should be raised from Major to Critical. It is not a question of whether web browsers can handle embedded images. It is whether web authors can Save As a (properly formatted) HTML document to work with Sigil in the creation of Epub documents. For the time being, until the developers of LibreOffice can realize the magnitude of this error I will have to tell my students to use Open Office instead of LibreOffice. I am deeply concerned that some members of this forum do not realize what a major -and even critical - problem it is to not have a properly working "Save As HTML document" function.I’ve updated the priority since saving as HTML is a basic feature of any office suite and the triaging documents suggest pairing critical with highest. David, I understand your frustration and agree with you that this is a serious issue. Until this bug is fixed the only way for users to generate proper web pages with their word processor is to use OpenOffice one of the propriety options like MS Word. Unfortunately, Joel is correct in that TDF does not employ any programmers and depends on the community of volunteers to fix issues like this. If you work in academia, maybe someone in the CS department would be interested in working on this. Another option is to start a crowd funding campaign at Freedom Sponsors or Bounty Source. Joel,Would you be willing to bring this up at the next ESC? If not, I will try to.(In reply to David Spring from)Your point?Sorry, but that is clearly *your* use case.As an alternative for anyone similarly concerned, use an appropriate extension and export to ePub directly. The eLAIX project's extension () does quite nicely with complex documents on 5.0, 5.1 and 5.2/master--which I just verified. Also verified that Sigil has few concerns with resulting ePUB, which passes most of the FlightCrew validation tests.You are free to do so. Or work around as above.And?This is not a "forum", this is Bugzilla issue tracker for LibreOffice QA and Development. Opinions, and senseless assertions "the sky is falling" , have little value here. Please refrain.Fully support V Stuart Foote here and just for additional considerations:=---10k open bugs - many have users screaming and yelling about how their bug deserves additional priority. We have an objective way of prioritizing and it's not *at all* intended to dictate to developers what they must fix.Finally, regardless if it's critical or major - it won't necessarily change when/if it's fixed as that will *entirely* depend on a volunteer taking the time to fix it. There is no paid staff, no one dictates what gets fixed, there is no system where users can scream louder to get their pet bugs fixed faster (thankfully as that would destroy the project).As always your options are:1) Fix it yourself (that's what open source is all about);2) Pay for a fix;3) Find a friend, family member, colleague to fix it;4) Wait patiently;5) Use a different product.You seem to have chosen #5, which is entirely fine with everyone :)Here is the code for an Open Office 4 "Save As HTML" linked image. It is identical to the code used by Libre Writer before the change to embedded images with LibreOffice 4.2: <p class="western" style="margin-top: 0.04in; margin-bottom: 0.06in"><img align="left" alt="" border="0" height="120" hspace="10" name="Picture 1" src="../Images/ShorelineScribes__6c902d9b.jpg" vspace="14" width="153"/>Here is the HTML code for the exact same image in LibreOffice 5.0.3 "Save As HTML" image which has been exported not as a separate linked file but left inside of the document as an "embedded" image. Keep in mind that this is the code for a single image. Our books typically have more than 100 images. Does anyone on this forum think this is acceptable HTML code for a single image? <p class="western" style="margin-top: 0.04in; margin-bottom: 0.06in"><img align="left" alt="" border="0" height="120" hspace="10" name="Picture 1" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wgARCABkAJcDASIAAhEBAxEB/8QAGwAAAQUBAQAAAAAAAAAAAAAAAAIDBAUGAQf/xAAZAQADAQEBAAAAAAAAAAAAAAAAAQIDBAX/2gAMAwEAAhADEAAAAc0h2bzJlhhwT/URxreg3l1nU7Bq7Y0GQh643L1Q9E7lcR7pzahpqOe4JKOfTjS4sW3PI7JNJaIcM7rJ2T6dRDqhaV+as6rbC9jzoWcTLCinVEqDxOYkUIr51fZ0DbVWOTJhNW/QrCktsuteem5q1eZzU5RxYNosYyaWtBaFqYUoIJvlClVktMIwySqVcQQdgijjotaO2p6tNOPVhywrJMkp2K8h1lxQopJCss676ZpnndBd85NeL4Q4uYvUVphYm9b1PPdBpLF5Z6bY2GZioHolWzDclt6zCIJpPoWj6ji0UHYfDvGACIkC3bdVlm8BGfENKjuxgqsT6Ph+rKtJRvPqrYeZs4A0JAfQAQ2DHuAHEA23AAUrJhvGVA68v//EACgQAAICAgEDAgcBAQAAAAAAAAECAAMEERIFEyEQIhQVICMkMUEyM//aAAgBAQABBQI2MWFdoc1WIqnsxWJU5Oq11x+M7anZgPA4vV3Q25S8bSpOJc3c58lGpfb23usFgu3vgkFfCDIfbWNZAtXFgS3lynTWZflPj5Uol+GqSm0ofMr3ull4kaGQWjNxmu4a1StQvdC48x6w1lzKWVyjKw+JTzP5ZuZCmOffoceWouRHyOU7/JfMDGJ92W1NXZjBN2ZD1tVb9unyKsf86zPNMx8+y9s3O7DHPLx/LcQU7cXw/wDPIbZ2q6NTPwFQ0C2iKd1uAaLR3VA+LNAMWtUmdX3M58Ct5lVCp6v+fFmZVg8xlgE4Sv31lhVWbTYzFgfAT3LKLlsve1gj2e7KfI73xP4trG23xK9Abn9Ess4G3JMV+EZbLK11phANmwaPTm4kqrrYUx5f2rrMjjXSG4srlZWdV7gIMMYbjUqx/cGQ4r2fTF5ua+i5Fj5FC1IbnrZsiuwWZFaK1jNK15IQyyosIT7lGlb3HgJoASup7rKOgMZT0rEpgAAmTWbK7q1tV6bEhmuTY+La4Tp7m75XVLul2CEMkJ2WunfXddT3WYHTkwk9SQobJtaCovDjoS3T67Z28Tp6i+uyL5yvTMx1vqrU123cSD5nSMIUUH67nWtWTJvb5bVvtJwSlEb0tOhlVaL8+f8Agw/r6jE+n+3+Cw5JkfZuNi9yH9/U36X/AF6n0yz+IP8AOdWr5Le23//EACERAAICAQQCAwAAAAAAAAAAAAABAhEhAxASIDFBEyIw/9oACAEDAQE/Ad4xvwfEyelTKwcRR6Uaf1WS/ZqOxqyuyd5JM1EqEWUhreiOEOWCcrIFZM7JWKK2SrycUcPYkNGUcmJdEy3vL8p+Nv/EACIRAAICAQUAAgMAAAAAAAAAAAABAhEDEBIhMUETUSAwQv/aAAgBAgEBPwG66Kfokil/R8iQsrrgjLmzcZMnhaF2NuToXBLmivCCoTJTG7OCXfAom29Ioi9KKFGNDX0UOVPkvcxCRLo81nNRQ8smWRmkbx5volNkZ33ptJSt/n6Ynf6sXen/xAAuEAABAwIFAgQHAAMAAAAAAAABAAIREiEDEDFBUSJhEyAycSMwQmKBobEzcpH/2gAIAQEABj8CaWuFXCkW7SoBk87I1i/KmOkp1EC0QhWfYItwWgTqVdykaoNx+pvO6DmOBVTTZAOnw1U3IGFK7Jg3OhCxHPMd103QD2kjaNVTURGyqY2yuZVyAeF/l/Su8ldJVGxR4QlAbKEJXZRMboCPdFuJt3Qc1y3tujRg9Ktpwm+6nyDOEItC5yMr1Oa0bKk/VoUWteXu1MjREAXTnky4JzYu7dCbgNq91SGaIN8NUUq7QpVipcoAytl3VA0mYVeK4ujQJxa2if2i57ur+K1+xVUANnRHswBTC6U2dApNvZABBu8Ii8LRdsjOUSQQhDvYqBf2RVj1L3TnsNoGTSwukfciS+xTSTJi5QVOpUT5RSqhqqz6J0TqZBFwUSbjlcIgxKNjTyg11wtAJ7IUM/IsqGbqQunfKds+VJy8PbOlrKtrBfELWN/awcBgjDg/9UO2UORobcq+q7rdRsuyE6qyurTkMPDbU47IHHxY7NU+HUeX3UAQMreoXC6hB/itcZQEKGW5Qa4gDVG7lLCHj9qHiHcFSFutCm4eGJcdlPqxTq7ySTZfAwSRyU44uHD/ALdCtF6Pymt8MOJ13Ks6DwbIfa05kH8Kk2RpV14zh8R/6HyPSSTwhfwWDg3Ulzz+UGRIHKqa2LRkEVWPp/itN0RiNj5Mo+ULDdtUAco7yFW7q7ZD5B8z/wDYL8rCB3MJzdgV/8QAJBABAAICAgICAgMBAAAAAAAAAQARITFBUWFxgZEQoSCx0eH/2gAIAQEAAT8hJCpVeY+uLsUiq4GmYY5nZ/UdUJG4wKAaj7jKKrsdktTBpD+ot8xRVByNVOsPqYf7Fjl60k3IuOoZqh+Li/KRms5Ylsx+4XDVnMdvRgNS2X0466cLNHcHVIImuWxBQ5I8hhFuFRTLYVDKm109yobyn+lBUvVxOGWz6OmKSmR+o71/BO0BKkUN2TJrHDH4XD2B0l6GW0mmt+4EhHkBo58TIKc9PcTbQYxTLaWjyhDqitkXyRe8VGiNW5QhwzK87qZbqkKiFXuoovYWcujEzszxLj9LhydBV37hFPDYasHhflA0CLHqacRWyLA8jhm4rglWPCo3QEZvMFV1cuQJlmfGYy4j1KCNLHajEVZDEANplaDBKUwF5WZ7WqjARyO2pQxZTjTqJVYa1A3SZogNdWnEVVX+2zXt9zHj5lZCgcY3Nq14ATTnKPynzNwhzMRVAgViqRLoqo4Ch1FjY57lbnIjqHVAYAw+4tvqYVVsAm87uUNpGdRwXZS/iX7mOtIBU6AdvEOzC8B9kQmQrr7jSmwOxnNisKGGXHiO0z6iKo2wQ8YyrrmDg0yrZXcR/Bhy9OUa0lnai5AD5R8SYSmKrinUcTcoaYGBbkGu4slHShKQF3n/BOslddR2SqKWALlTNmpnNsbaV7Zh5SEua4hK34QMHwRXaNg5lMCbgq3BepeSy8WbLd/SdIbecKXzuAWp/fzBYD7IWkckyDjPGBdLAarb4g1zLb1DaXSxA4BKgYVCjmwQMkI3jTEEB7nb9xYFbk/pqVpdAVCdrvyzIQPtRFseLcDzQy/2TCBPJg+4tAlkbx4giqhxxH6Y0aikUEFyaEO6RRCBiL6Isih/wDM8R/KigNrxHa9CxiQncsH+xKOZMID9JaCa0h7fUGA/YP3Bu7Ve2pqIMGPNZdMdDp1xOWa6NxGe0NYXefq+YqJx+d/nOMFDdhxk+1Qs2XuCyEVBnMlTg6jBjzs18wTHJ+4bVclB3N+Pr8zr+QydInF7/gwirH/AHOJR30n7gEbTA0gN2vxqzn8P8FXz/i9I6XkiXdKfZBl7f3DLxc9TEVtBc//2gAMAwEAAgADAAAAECG/P0JF0xcqTA0lIFQ5ACXEwlBOaAsckg9RKiFoclHmPBEH58zlQpCpCDdkzA3XgPfYAwQv/8QAHREBAQACAwEBAQAAAAAAAAAAAQARIRAxQSBRcf/aAAgBAwEBPxDZdMJK9LL5dpOeF+Iu+NdSAZss2/hBCC8kIMa+Ju/JdjmwIWLYFk7g9Fj2ljdRqIb1e+DteCG9wtCBOC2aSdQPL+SDEcMt6ahLAKQwtYtfGA1LdtngYskcHHn0f//EABsRAQEBAQEBAQEAAAAAAAAAAAEAESExQRBR/9oACAECAQE/EEjJ8ol7Z9nxSnML87Pr/cFy6YvZAJ5RIbB/JaxBjOLrIGDN0ss4z6nXvJGpwcuk29bu8/G3l7BPo+pW7B0ZewtXF2KTfVoewvxtR9vsXTrfUj6i8i3LVk4+wSdl/cIICyDIA76WP2b5P6RHp+Zf/8QAJhABAAICAgIBBAMBAQAAAAAAAQARITFBUWFxgZGhsfAQweHR8f/aAAgBAQABPxDOJ8dmWlhjqoEAYkbeB6kdQ4XdxWwZShSsusiRY8JC5UE/2HQB5lNN/XhGSq3Sr9olmcWnowCNGEPt/TFJFtXHjQtX+uAUcvEMAEO2yao2nuXY6ZQ0gnB7hUriXkR0EwDJpn8w4YM7QDTzGN8j30/5KVHhBecTLXbBVzn1DeCLaGsW/mM6SvTgxiFmA2X+nEyEw4w+MxsJHWZCPMAjGC3jtjynuMT5PSjirWNuPcshCxlg2X2Rlr3supl3YSoTPAMKQyd1VNHgg5IhBqcY8dQqnEUbdjzM3D3MKulfiB8oDoc6+szkbgkTqLOuynyR6C+UWi2rioXNrHx07YGMIt/MfkdOTxAW6ghgeOxK6ixgG3MFXqOmW81Ys4IdosfghMWxjP2xicjY1lHPzEAvRqvquVIBbYc5JdcFFVLqotRVHIBRculRixSir8/iZ8RCyTvGpqDDgPeYjqWWnCodH3WbYTZK2eMw3WBiuSWTc+ZoBi7mLfZzEVsLfFyzGaymrlrgAouu4hY0dq/MGGg/lOn6TLHxAurTm/MsdFFYYaqUpegD7YyAV3bB56mf6iTr/QjWVXxYhu3kaGDlFDMPB9xwbYqn2JbQ2GEu+S8NkrgCzTfghAODbuUtWKR3Eo1a7OIp/gR6G+0XiArs90O03Pdh90Q+gyLwdzMrTbZ4gGxrd74GEwt8HajCjnQZPSK89zUCWVqKL555PmE0oEaV15QDoVOjLHOsiBwEYhYoD7rhACcFrl8mXiIQ9ou2g03uJKJLJ05g8YDd4mS4BYDt+ZbToVRBsYva50W/7KttpZh8RKngFx5kXzTZpovtljUkGNu6k+ESolaocTXmAfHsl25jcVRC97nGHFudQm59NbIt6iKt2R0YTncQCyto5KpkGJTLQo1BFbVwSJbqzuxlHt9nDEOfo1OMuSpfODHuDtBC0eBi/bMXzk2ESudlxFb314JqvyFyeYo/cjfgnIFo6O2ZREUlj7hxteQFp7gQQt9SUWHNXL7j5uVXMV+WZL3BUzOevEAVWvdyxgNxS9VuP/DzLKln4Wvj6DNkHCf2eoDJtVh8EMUlal3Tj0lnzC2iL1zBnm7WH0RXyC5Y5x7g6DT/AFUffjTzYOXJMgn0G3txNrEp/fh+sOxfoU13KOoGteYXADmtS9ZPDVyoeZcv9BtZRKuVaPt/czT+RvFtFAjawMG+gYi4oG3wLL0yXOxMFftzFL3bD5i9Rwq8r1wCUZ5g8Xgp9pktXzhL8CUADMFyQQtE8vifzHetpWiuYQRa6FOHMM+zOIjUGK5XJ4Oz8SxZUBj+EBSCdMxEGnklUx2deS+Pcp+xB8yTmXbStotfLWYaiujU9xMB9prK6r3FQNw32WNTLIp3pUw2QYzYY/fETCKk7OoUk0CmGLUeHucBywKIz4mJfRCvF5XFNG86OP5SiiXqKy6WCmBXXTRfX8zGFt34RFohR6zuWLyA+Nx3G9BW/ggXHNRVqCsqEYk6fmEDNEd/wx1c3G1caEmtr8YboCH62ieXFWsv/IV6WCtoan//2Q==" vspace="14" width="153"/>This is why I am forced to recommend Open Office until this HTML coding error in LibreOffice is fixed.(In reply to David Spring from)Sigh... you really are missing the point. No one disputes that there was a wrong turn 54 months ago in implementing an *unconditional* use of data URI (RFC 2397) especially as the Writer import filters were not adjusted to handle that format round trip--making the Writer/Web mode pretty much useless from that point. Import filtering has been restored, but the Writer/Web canvas still needs dev attention to render the markup for the <img src:data... > URIs.But, in point of fact the XSLT based export of ODF documents to XHTML has received prolonged dev attention and provides much better fidelity to the original ODF document than the Writer/Web and HTML export filter has ever achieved.You say your goal is generating ePUB, have you even tested the LibreOffice XSLT export to XHTML as source document for Sigil conversion to ePUB? In that scenario LibreOffice Writer becomes the editing and layout environment--the XSLT conversion generates the fully styled XHTML. Yes the images are embedded base64 there also. But, you would not need normally to tweak the XHTML code directly--but could do so against the XHTML using your markup editor of choice.LibreOffice's XSLT generated markup is XHTML tagged as <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" ""> DTD, as opposed to the Writer "save-as" filter which retains its mislabeled legacy <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"> DTD. Writer/Web has been a poorly maintained module.This all will get sorted out in some fashion--likely as Andras T. outlined in. Restoring correct handling of the per document embedding of images in the source ODF--and protecting that linkage and file naming during export to HTML. With this issue, andand, as set at appropriate priorities this will be worked out in some fashion. But should note it is entirely possible that in the end we strip out the Writer/Web module as unsupportable while bringing the HTML "save-as" export/import filter more in line with performance/fidelity of the XSLT conversion available in that export module. Ending the illusion of LibreOffice as an HTML code editor.The swhtml filter may even be consolidated with XSLT processing which also could be improved upon. But those are implementation decisions for the dev(s) that elects to take on the task.(In reply to V Stuart Foote from)Sorry, it was just 30 months ago in July 2013, not sure what radix I was thinking in.Thank you for your suggestions. I have tried dozens of options including Export to XHTML and Elaix. I have been building websites and creating Epubs and teaching courses in HTML since the early 1990s. Being able to use HTML to put content on the web is important. In my opinion, LibreWriter produced very clean HTML up until this change was made (especially compared to MS Weird). I would like to recommend LibreWriter to my students - but embedded images are not proper HTML. It leads to all kinds of problems not only with Epubs but with websites and I think it is important that websites and Epubs be interchangable. Linking images is proper HTML and works well. Libre Writer Save as HTML worked well (not perfect but acceptable) up until someone decided that linking images was not needed. Whoever that person was, they were wrong. Thankfully, Open Office still works so I will just have to recommend that option until LibreOffice Save As HTML is restored. As for Elaix, I use that tool all of the time and have attempted to use that tool to get around the problems created by Libre Writer. The person who claimed that works well with Libre Office 5 is also wrong. I have spent several days this past week trying to get Elaix to work with Libre Office 5 and it is very unstable. It crashes with complex documents with more than 100 images. So does Writer 2 Epub. I am currently using Elaix with Open Office 4. It works for some functions but not others. Many functions I simply have to wait and do in Sigil. This really slows down the process of creating complex books. At some point, when I get more time, I will write up a more complete description of the problems of Elaix with Libre Office 5. But I want to make it clear that it is not accurate to say that Elaix works well with LibreOffice 5. It does not. Finally, I do not mean to be complaining or yelling. I am just surprised at the lack of understanding of the need for and importance of linking and not embedding images in HTML.Luke, Thank you for raising this problem to critical. HTML is extremely important to many people who use Libre Writer. HTML is the most basic language of the Internet. From the first days of the Internet, images have been a problem and linking images as a separate file has been an acceptable solution. Embedding images is not an acceptable solution and never has been and never will be. I understand that Open Office also has problems. But this is a critical issue for those of us who use HTML to create content for the Internet. As for Libre Writer simply abandoning the function of being an HTML editor, I think that would be an even worse mistake. It would only result in driving millions of people away from LibreOffice and into the hands of Open Office. I think the solution is to take a close look at how Libre Office handled this issue in the past and how Open Office is currently handling this issue in the present and then adopting similar code. I realize that there are all kinds of problems with XHTML and HTML5 and Mail Merge image insertion. But right now, LibreWriter Save As HTML is broken. So is Export As XHTML. I appreciate the efforts of Elaix, Writer 2 Epub and others. But they also are having trouble keeping up with LibreOffice 5. Perhaps the team should consider slowing down on the new features to make sure that former essential features are working again. May the force be with you.Thanks for all the comments.Probably this is not too hard to add an option and give the choice.So people with some coding experience might feel invited to jump on this?Do realize that there are always more experienced people to help a hand when needed.***has been marked as a duplicate of this bug. ***We have some movement on this, yea!Oliver S. is reworking code for thepatch, to restore support for linked images in the HTML as user prefers, while keeping base-64 encoding for mail merge support.Thanks Oliver!=-ref-=Oliver Specht committed a patch related to this issue.It has been pushed to "master":tdf#63211: saving embedded images to HTML optionalIt will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Huge thanks, guys!
id=49217	When installing on a Windows7 box, the installer insists that I have already open LibO 3.5 and promptly exits the routine. I have downloaded a second copy of the installer, to no avail, and I've uninstalled version 3.4.I was able to install LibO 3.5 on a WindowsXP laptop without problems. DUP of "- Uninstall Problems with MSI on Windows 7 64bit"?@reporter:please check and complete your bug report! May be hints on <> will help you to find out what information still is needed?Andras, does it trigger any bell?If I understand it correctly, the reporter was able to install LO-3.5 after uninstalling LO-3.4. AFAIK, it is not a general problem. It might be caused by some strange state of the system => it should not block the next release => lowering the severity a bit.Reporter did not answer, so we should simply close this one. We had some issues that the user had to use an uninstall tool to remove 3.4.4 before he was able to install 3.6, may be reporter has the same problem.So closing.@Reporter:Please feel free to reopen this bug if you find out that the problem still exists with the current stable LibreOffice version and if you can contribute requested additional information (especially: 34 bit? Update from 3.4.4 to 3.5?) due to <> (especially BugReport Details)!
id=50029	As discussed for the intl. one already, the old page is totally confusing and non obvious to endusers: fixed
id=50057	Createdcommented snippets from defective content.xml in ODTProblem description: When editing an ODT document with a larger number of tracked changes (redlines), Writer occasionally hangs, formatting the document ad infinitum, with only short intervals when it reacts to user input again. If the file is saved (or autosaved) when this occurs, it is corrupted by having the same draw:frame element being replicated several thousand times in a row.Steps to reproduce:I haven't found a way to trigger this behaviour consciously, unfortunately. But I haven't found a way to avoid it, either... (except for avoiding the record changes function).I cannot disclose the defective documents but I'm attaching commented snippets from the content.xml file of one.Current behavior:When examining the content.xml file in the corrupt ODT, it is pretty obvious where the behaviour comes from: In the text:tracked-changes-section of the file, there is always a text:changed-region/text:deletion element which contains several thousand copies of the same draw:frame element. Likewise, the body section contains a paragraph containing several thousand copies of the same frame.I assume, Writer hangs because it takes so long reformatting the document.In effect, it is impossible to edit the file in Writer, so there is no way to simply remove the paragraph which contains the replicated frames. I usually try to kill LibreOffice (or OpenOffice) before it autosaves the corrupt file, so that I can start again from a recent intact autosaved version. If I fail to do so, I always unzip the content.xml file, search for the several thousand copies of the same lines, delete the sections by hand and zip the edited content.xml back to the ODT.Replicated frames have occurred in documents with a large number of tracked changes and text frames anchored with the paragraph or character. The frame being replicated is usually not the place that I edited at the moment when Writer hangs, so I'm not sure what triggers this behaviour. But it seems to have to do with having inserted frames in a deleted text sequence.Platform (if different from the browser): This last time Ubuntu Linux x86_64, but I have been seeing this bug with several versions of OpenOffice (under 32-bit Ubuntu 9/10) as well. I get the same problem in 3.5.3.2, build id 350m1(Build:2), which is the latest version available under Ubuntu 12.04.I have a frame with a link to an image. If I scroll to the page containing the image, then the frame replicates. Once there were about 60. After waiting for the page to redraw as new instances of the frame were added, I clicked on the frames, one by one, and deleted them.Today the problem is much, much worse. I waited over an hour, then closed Writer.The contents.xml contains 8,212 copies of the frame! I used emacs to delete an extra 8,210 copies and see what happens.What happened was that as soon as I tried to get to the page where the problem occurs, LO hangs, presumably re-inserting the same frame over and over...BTW, I noticed the following line above where the frame is: <text:h text:style-name="P13" text:outline-level="4"><text:bookmark-start text:name="__RefHeading__10012_38549477811111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111"/><text:span text:style-name="T5">fir_interp2_s</text:span> Semantics<text:bookmark-end text:name="__RefHeading__10012_38549477811111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111"/></text:h>I used emacs to get rid of the "extra" ones on those __RefHeading tags (a few hundred of them) and got rid of the extra 8,211 frames, and LO is behaving again.The problem still occurs in 3.5.5.2.I have 16,384 instances of the same frame, all on top of itself.(In reply to)Could you attach any example documents to allow others to check on differentsystem/build?I'll have to cleanse it, because it has company confidential info in it. If someone can work on it, that would help immensely, so it would be worth it.CreatedA file demonstrating the replicating picture.The subdirectory with the pictures is forthcoming.Createdtar file for the images subdirectory.This file should be untarred in the same directory with the attached .odt file.I have the setting "Save files relative to the file system." You might have to adjust this to see the two pictures.To demonstrate the bug:1. Turn on Edit/Changes/Record Changes.2. turn off Edit/Changes/Show Changes.3. put your cursor after the text "Lsklf".4. Type a few characters, newlines, etc. until the picture starts replicating.Please let me know if this does or does not replicate the problem.I have tried your attached test document Test1.odt (LO 3.4.4, Ubuntu Linux 64bit). The first picture is being replicated, though I don't get thousand of copies. LO still remains managable, although the constant rerendering/reformatting of the image part of the screen when inserting text makes it difficult. But replications seem to start when I _delete_ text, insertion seems OK.Great! I'm glad it's reproducible. I hope someone will work on it soon!I tried the file a second time, now with "show changes" enabled. This time it was worse: Working with LO became impossible because it didn't respond for minuted. Replication of the frame started after the first edit. LO completely stalled after some time.Attached are versions of the file made after some edits with "track changes" and "show changes" enabled (LibreOffice 3.4.4, Ubuntu AMD64 11.10):- inserted a new paragraph between 2 deleted paragraphs (file Test1_edit_1.odt)- inserted a space (file Test1_edit_2.odt)- inserted a "?" (I couldn't save the file anymore, LO didn't respond for over 15 minutes)Steve, I changed the state back to NEEDINFO, I don't think REOPENED would be appropriate when the bug was not even confirmed or assigned, let alone closed. I hope bfoman can reproduce the behaviour as well with your files.CreatedTest1.odt after 2 edits with tracked and visible changesCreated1077_replication_bug.odt: Another ODT file displaying replication of framesThis is another ODT showing the frame replication. I took one of my old files that I had repaired "by hand", and replaced all characters to be able to post it here as an attachment. It takes a while until replication starts (I suppose after LO has completely loaded all data and is laying out the page in question).Confirmed with:LO 3.5.6.2 Build ID: own W7 debug buildWindows 7 Professional SP1 64 bitInfinite image replication after few edits. LO is unresponsive.Increased Importance; really a critical issue (data corruption, freezes ...).The bug shows up when Record changes is on, even if show changes is off.The effect of this bug is so bad that I cannot edit my document (which is due in two days!). Libreoffice locks up when it gets to the page with the illustration that replicates forever.My only workaround is to edit the xml, removing the replicated frames.is anybody still experiencing this bug with recent LibO 4.0.4 or 4.1.0 releases?(In reply to)tested on LibO 4.1.1.2 under Win7 64bit.I think that when you say "replication" you mean blinking and moving of the picture... at least this is what I see on my PC with your test file...se here are my findings:1- first image "replication" starts immediately after loading the file, then it gets stable after a few seconds. document is still responsive.2- adding some text and a new line after "Lsklf" --> "replication" starts again then image gets stable after a few seconds. document is still responsive.3- remove some text --> "replication" starts again but never stops. document is unresponsive. had to kill soffice.bin so the bug is still CONFIRMED. moving from mab3.6 to mab4.0 list since 3.6 is EOL.interestingly if I try opening the test file with LibO 4.2.0 alpha (master build Sept.3) I receive "Read-Error. Error loading file" alert and cannot open that file.(This is an automated message.)Setting priority to highest as this is a 4.0 MAB. This is part of an effort to make the importance of MAB reflected in priority too.Moving to mab4.1 () because:- 4.0 reached EOL (End Of Life)- bug confirmed in later versionbug still present in 4.2.4.2moving to mab4.2 list since 4.1.x is EOLbug still present in 4.3.4.1moving to mab4.3 list since 4.2.x is EOLI can confirm this bug using LibreOffice 5.0.1.2 downloaded from libreoffice.org. It is a disaster. My collaborators will no longer use LibreOffice because of it.I confirm the issue too, still present in LO 5.1.4 (amd64 Windows 7 and GNU/Linux)Confirmed using 1077_replication_bug.odt fromUbuntu 16.04 - LO 5.3dev - so slow it effectively never loads.Document info:-233 pages-approx 1338 redlines (tracked changes)-approximately one fly every 3 pages (based on a brief scan) but 4097 fly frames being saved/restored.The delay comes from the call to DocumentContentOperationsManager::MoveRange(...)Someone with a good understanding of redlines, code optimizing, and overall writer knowledge should work on this bug.
id=50213	Problem description:The Mac PPC version of LibO 3.5.x does not show images in JPEG format in existing (i.e. doc/docx) documents. Adding images produces the error "Graphics Filter Not Found".The Mac Intel version does not have this problem, neither does the PPC version if you use LO 3.4.5Steps to reproduce:1. load a document (i.e. doc/docx) with included JPEGs2. Or add an image to a blank documentCurrent behavior:Expected behavior:Platform (if different from the browser): Browser: Mozilla/5.0 (Macintosh; PPC Mac OS X 10.5; rv:10.0.4) Gecko/20120421 Firefox/10.0.4 TenFourFox/G5 Thank you very much for your report!This looks like a duplicate of(even if the summary is quite different). Good news: This bug should be fixed in LibreOffice 3.5.4. Please refer tofor additional details.Therefore, I mark this bug report as a duplicate of.However, if you recognize that your issue is NOT fixed in LibreOffice 3.5.4, feel free to re-open this bug report. Thank you!*** This bug has been marked as a duplicate of***
id=50659	Createds This bug is for Libreoffice 3.4.4 Calc (not spreadsheet)This bug cover has nothing to do with the ODF format. Tried it in Calc via "Tools - Options - Load/Save - General - ODF format version - '1.0/1.1' and '1.2 Extended (recommended)'"Comment ons>>>>@"Calc (not spreadsheet)?" Please explain!Probably a duplicate of.Please upgrade to current LO 3.5 and try again.Best regards. JBFreply to)states "Previously-saved LibreOffice document lost by power outage (became 0 bytes long) - LibreOffice should call fsync". The files in this bug does not shrink to 0 bytes after being damaged, they contain their original size.How do I remove my own comments? Is it even possible?(In reply to)Libreoffice Calc, not Libreoffice Spreadsheet.Regarding"Previously-saved LibreOffice document lost by power outage (became 0 bytes long) - LibreOffice should call fsync"The file is not 0 bytes after being damaged, it contain its original size. Please send feedback...-------- Original Message --------From:Apparently from:To:Subject: [] FILESAVE: I/O error in ODS file AFTER SAVE if PSUswitched off while openDate: Mon, 04 Jun 2012 05:12:42 +0000Could you give a description of the bug and how to reproduce it ?But before this, could you test, as Jean-Baptise adviced, a newer version of LO (like 3.5.4) ?"Libreoffice Calc, not Libreoffice Spreadsheet" is also unclear.Be explicit if you want some help. (what's PSU for example ?)(I don't think it's possible to remove one's comments).So - we added the required fsync magic on save to fix this issue a while back; it should be there in 3.5 and 3.6.Thanks ! :-)
id=49853	Problem description: When I try to paste into the search bar, my text is pasted into the currently selected cell, even though the search bar has focus. Typing normally does enter text into the find box.Steps to reproduce:1. open a spreadsheet (empty will do).2. type "cmd+F" to bring up the search bar, and if necessary click on it to give it focus.3. type "cmd+V" to try to paste into the search bar (or use edit -> paste; the same effect occurs.)Current behavior: pastes the buffer into the selected cell.Expected behavior: should paste the buffer into the search box.Platform (if different from the browser): (Mac OS 10.6 Snow Leopard) Browser: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_6_8) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.168 Safari/535.19 note: I've found that right (secondary) clicking on the search box, and choosing "paste" from the popup dialogue does let you paste into the box, but the standard shortcuts and menus should clearly work here.*** This bug has been marked as a duplicate of***Just for the record:At least on MacOS X (10.6.8), already REPRODUCIBLE with LibreOffice 3.4.4, German langpack installed (probably present since 3.4.0?!). Therefore adapting the 'Version' and 'Platform' fields.Please forget my, it was a mistake:is, of course, very similar, but still a mistake. Sorry! Therefore I REOPEN this bug report and add here all information which has been collected in between:(I) This bug affects not only Calc (for Calc, see original description), but also Writer (therefore I change the Component field to "UI"). To reproduce it, use the following steps:1) Copy some text to the clipboard.2) Start LibreOffice.3) Open a Writer document (.odt)4) Press Cmd+F (= Ctrl+F for Windows): Find.5) The Find toolbar appears and gets the focus; the curser is blinking insidethe find edit field.6) Press Cmd+V (= Ctrl+V for Windows): Paste.Expected behaviour: The text copied in step (1) is pasted into the Find editfield, because it has the focus.Current behaviour: The text copied in step (1) is pasted somewhere into the main text of the Writer document.(II) This bug is REPRODUCIBLE on MacOS X (10.6.8, Intel Mac, German UI) with1) LibreOffice 3.4.4, German langpack installed.2) LibreOffice 3.5.3.2 (Build-ID: 235ab8a-3802056-4a8fed3-2d66ea8-e241b80), German langpack installed.3) LibreOffice 3.5.4.1 (Build-ID: 7306755-f4f605c-738527d-1cf4bc1-9930dc8), German langpack installed.4) LOdev 3.6.0alpha0+ (Build ID: 2398b9c; date: 2012-05-24),US English langpack installed.I don't have a copy of LibreOffice 3.4.0 around, but it seems probable that this bug is present in LibreOffice for MacOS X since the new Find toolbar was implemented.(III) This bug is NOT REPRODUCIBLE with LibreOffice 3.5.3.2, German UI, on Windows XP; in Writer and Calc everything works as expected (i.e., the edit field of the Find toolbar gets the text from the clipboard if I press Ctrl+V).Therefore, this bug seems to be MacOS X only.(IV) TODO: Can someone please verify if the bug is present on Linux? There is at least a similar, possibly somewhat related issue on Linux ().***has been marked as a duplicate of this bug. ***@Kendy:I add your mail address to the CC list because you are the original developer of the new Find toolbar. It is a nice improvement, of course, thank you again! But on MacOS X it suffers from this bug which makes it difficult to use the Find toolbar (taking myself as an example, I often copy some text from the document and then want to paste it into the Find edit field, which does currently not work due to this bug). Therefore, it would be wonderful if you could take a look at this issue ...@Thorsten:I add your mail address to the CC list because you are our MacOS expert, and this bug seems to be a MacOS only issue. It would be very nice if you could take a look at it!Thank you both in advance!***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. **** Also REPRODUCIBLE with Impress (this is no surprise: it is just a problem with the new Find toolbar, and therefore reproducible whereever the Find toolbar is used.)* Set Version field to 3.4.3 -- according toand. Probably present since 3.4.0.* The number of duplicates indicates the severity of this issue: it's not a terrible bug, but really annoying, and that for many people, as the number of bug reports shows.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***It's interesting: at first glance, this bugs seems to be not *that* important, and it is limited to a single platform (MacOS X); but nevertheless we have found 9 duplicates in two months, which shows that it affects really many people ...!I almost filled out a bug report, but I decide to search first instead. Same annoying issue on OS X 10.7.4 LibreOffice 3.6.0.4 (Build ID: 932b512).***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Still present in 3.6.4.1 rcI too have been annoyed by this on a regular basis (and was about to raise yet another duplicate before I finally found this bug)(In reply to)Thank you very much for testing! However, please do not “update” the Version field ;-): it is supposed to contain the *first* version which is known to contain the bug, *not* the last/newest one. Thank you!Noted, thanks for educating me***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***After switching to Linux i can confirm that this bug ist NOT present in any of the recent LO-versions i have tested so far.Confirming also on :Master build Version 4.1.0.0.alpha0+ (Build ID: f5cde53719544c7445ab6fdb465e332ac5678b0)OSX : 10.8.2Oh, not good. The cursor blinks in the Search window, indicating that it has the focus, when in fact it does not.AlexWell the field has and has not focus because one can type normal text into it just fine. That makes this bug twice as troublesome.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***This is seriously annoying and breaks basic UI-convention. The only way to actually search for something stored in the clipboard is to right click the searchfield and select paste.I filled a bugreport for this behaviour some time ago. But since I do not see it here, I thought it might be important to specifiy that this behaviour (bug) also affects word 2011 for mac (if not the whole Office2011 mac suite).Description: I type cmd+F, I type cmd+v to paste, but the pasted text appears where the cursor initially was in the text.On: MacOSX 10.8.2 + libreoffice 4.0 (and earlier) and office 2011 for mac.Maarten: I don't see anybody excusing a non-fix. The only factor this is not being fixed is, that neither you not me did provide a patch.And to add something useful: This is reproducible on 10.8.3 with LO 4.0.2.2.Request to the QA-core people: Can we raise importance from medium to high for this?(In reply to)I think Major Medium is already a *very high* importance for this kind of (very) annoying bug. So, I would not like to change the priority. Also seeKind regards,JorenWorkaround: right click the searchfield and select paste.As annoying as this is, the workaround is trivial. I don't know if it's my place, but I don't think this is this calls for high priority.Has been nominated up to the mab3.6, and by proxy should also help the See Also list items.Had recently poked at this a bit and while not certain, I made suggestion that the issue is with a set of accelerator key mappings--,,andare all related to a need to associate the accelerator key stroke with the desired actions "first responder" on the objects menu, or on the main menu. So seems like it is widget programming for Cocoa NSMenu and NSView that needs cleanup. Here is the Dev list topic:***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Actually, it is not possible to paste into *any* box in LibreOffice, including font, styles etc. Updated the title.(In reply to)which version did you use? 4.0.4, 4.1.0 or 4.2alpha?(In reply to)Still reproducible, not fixed. Sadly there are some serious and hard to find/fix field-focussing issues on Mac OSX. Moving this from 3.6 to 4.0Adding myself to the CC list. This is annoying not simply because the control focus doesn't work as expected, but because the result is that the search term is pasted into the body of the document, which might go unnoticed by the user, especially if they also use LibreOffice on another platform where it does work as expected (Linux). (That happened to me the first time.)Since someone mentioned MS Word 2011 for Mac also has this bug, I tested OpenOffice 4.0 and found it too has the same problem.***has been marked as a duplicate of this bug. ***Please elevate the status of this bug to critical. It can cause unnoticed destruction of data.It may also help to change the title from "cannot paste" to "pasting overwrites other data without warning".I add Tor Lillqvist to CC list.I've seen him fixing a lot of MacOS specific bugs recently.Hmm, yeah, this is an embarrassing bug. And it is LibreOffice-specific, the "search bar" thingie is something the two other products based on the same original codebase don't have.I guess one relatively easy fix would be to not use the "search bar" on OS X but always bring up the full Find & Replace dialog window. (The one you now get with Alt+Cmd+F.) Sure, the "search bar" (is that its real name?) would be nice if it worked properly, but as it doesn't...@V Stuart: Re:, LibreOffice (and OOo) is of course very far from a typical Cocoa application code-wise, it does not use Cocoa "widgets" for instnace, so generic instructions on how to code for Cocoa are not directly applicable to LibreOffice's code-base.Actually, I would say that the same bug *does* exist also on Linux, but it has to be invoked in a different way: You have to use Edit:Paste while the findbar's text input field has focus, that causes a paste into the document, not into the findbar. (Control-V works as expected, pastes into the findbar.) Most likely fixing that on Linux will fix the behaviour on OS X, too.I think that unlike on Linux, on OS X an accelerator like Command-V is more tightly coupled to actually work as if the corresponding menu entry was selected. (This is obvious from the fact that in OS X (in all applications, not just LibreOffice), when pressing for instance Command-V, one sees the "Edit" menu entry highlight for a moment.)***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***CONFIRMED on Ubuntu 12.04.3 + LO 4.2.0.1(In reply to)Yes -- this perfectly describes the behavior I see on Ubuntu.So it looks like this really IS a bug. Thanks for working on it. I completely lack the skills to do it!On Sat, 18 Jan, 2014, at 6:14 PM,wrote:Looks like this is more than just pasting text. Select All also fails to work properly: It selects the text in the document instead of text in the Find bar.This is still happening in 4.2.0.2 on Mac OS X 10.9Moving to mab4.1 () because:- 4.0 reached EOL (End Of Life)- bug confirmed in later version(In reply to)First off, the Edit:Paste "issue" is reproducible under Windows, too.But I wanted to notice one thing. The "Edit" menu behaviour cannot be regarded a bug. Actually, this is the way it should be: Edit menu describes actions that should be performed in edited document, not in some other auxiliary windows (such as Find toolbar edit box). The same goes for Edit->Select All, etc. (you wouldn't expect bringing another Find toolbar to search within first Find edit box when you select Edit->Find while inside find toolbar?)Thus, this must not be "fixed", as suggested in.The problem is that both main menu (controlling main edit area) and context menu (controlling currently active widget) have the same accelerators listed.But in other OSes, the context menu accelerators have priority, while under OSX, main menu has.Thus, this looks to be a clear OSX-only bug.On other OSes, there is only visual ambiguity, when one has focus in Find (or any other auxiliary) box, clicks Edit menu and sees all those shortcuts listed there, thus has impression that they will act on document, while actually the shortcuts would work inside the auxuliary window. Well, this is just cosmetic.Under OSX, this is really a problem, things don't work as expected. And THE way to fix this would be to DISABLE all Main Menu accelerators while caret is outside the main edit window, and restore them on entry. Of course, this could also be done on other OSes, to remove the visual ambiguity (so, when outside the main edit area, (some) main menu entries would not have accelerators listed next to them). This would fix all the mess, without need to break normal operation of Main menu.I guess you can say it isn't a bug (and I'd argue you're dead wrong - and it's been happily labelled as a bug for nearly 2 years), but that's OK.It does not behave the way users want or expect. It does not behave the way other apps behave. It is not the desired behavior.Whether it's a bug, an anti-feature, a feature, or a brilliant new feature, it isn't what users want."But I wanted to notice one thing. The "Edit" menu behaviour cannot be regarded a bug. Actually, this is the way it should be: Edit menu describes actions that should be performed in edited document, not in some other auxiliary windows (such as Find toolbar edit box)."This is plain wrong on the Mac, and not how any other app on the Mac behaves. (I do not know about Windows ir Linux). But if you are making a cross-platform app, it should work like a native app on all platforms.On the Mac it has always been the case that you can paste into native dialog boxes, for example, either by command-key, or by menu."Under OSX, this is really a problem, things don't work as expected. And THE way to fix this would be to DISABLE all Main Menu accelerators while caret is outside the main edit window, and restore them on entry."And that too would not be how native applications work on the Mac. Suggesting disabling functionality instead of fixing it is unhelpful.(In reply to)Unfortunately, I don't have a Mac. So I don't know what is "native" there. Could you explain, if native Mac applications are expected to use main menu to paste into any active vidget? I mean, do you expect that when the caret is inside "Find" vidget, you will click main menu, and then Paste, ant this will paste into Find string?If so, isn't Mac menu Edit expected to be changed when a vidget is active, to reflect only those commands that are relevant to active vidget (i.e., to look like contect menu)?(In reply to)Absoultely standard behaviour for all native applications. E.gYes.Or you can paste a password into a password dialog. And so on.Simply put, if you choose Paste on a Mac, when editing text, it will paste wherever the caret is. It does not matter if that is a window, a dialog box, or anything else.Furthermore, the Mac makes no distinction whether you use the Edit menu, or a command key - the command key is regarded as just a short cut for using the menu.Yes, menus are supposed to change to reflect conext. However, at the risk of getting boring, being able to paste text wherever you are typing text is expected. Any application which disabled pasting text into dialogs would be considered broken.Then my proposition remains true: I mean, main menu must be modified on entry to vidgets, and restored on return to main edit window. The only mistake I did is what exactly should be modified: it's not shortcuts, but the menu items themselves: they must be replaced with context menu entries that work with active vidget. And this is not the same as what is seen in Linuxes and Windows.By the way, I never meant to disable pasting; what I meant was temporarily remove DUPLICATE accelerators from main menu, that are the same in Main menu and in Context menu, so that no conflict exist, and Context menu keys would be active. Well, it's not "disabling functionality", it would enable Ctrl+V as well. But not in a native way. If main menu must be redirected under OSX, well, that should be done, but not under other OSes.Affects me too, LibreOffice 4.2.1.1 build ID d7dbbd7842e6a58b0f521599204e827654e1fb8bMac OS X 10.9 Mavericksplease MacOS X users give an update about the bug status with current 4.2.4.2 LibO release.if bug is still here, please move it from mab4.1 list to mab4.2 since 4.1.x reached END OF LIFEStill reproducible using latest master version -> move to mab4.2till here in 4.2.5.2(In reply to)Version field is the oldest version of LibreOffice you can reproduce the bug. Please do not change version field unless you can reproduce with an older version then 3.4.3.Sorry for the inappropriate change. How else can you indicate the bug is still alive?I guess there should be first seen and last seen version numbers. I don't understand how a bug marked as "critical" has not been given higher priority for a fix and is still there after > 3 years.*NO IMPORTANT info for developers in this comment*(In reply to)Lets not discuss that here :). Please start it at our QA-mailinglist.()Sadly this is not the only bug/enhancement developers are working on. Feel free to work on it, find a developer or support this feature by funding it (see).Kind regards, JorenI can confirm it's still here, too. Libreoffice 4.2.4.2 running on OS X 10.9.3.Sorry, I don't have the skills to fix this, so I can't complain. But just to say, it's reported 2 years ago, marked as highest/critical. I often encounter this issue when I quickly want to look in my accounting sheets and then accidentally overwrite some values.FYI: Collabora have a customer lined up who (I hope) may fund a fix here shortly - stay posted ...This bug will never be corrected. There are bla-bla-bla since 2012-05-12, it's awful. I'am trying to unsubscribe from this bug CC list because of spam on my email. Hope it's possible.This bug is still reproducible on OSX 10.9, LibreOffice 4.2.5 with Russian Language Pack.Instruction to reproduce is the same as Roman Eisele has written:1) Copy some text to the clipboard.2) Start LibreOffice.3) Open a Writer document (.odt)4) Press Cmd+F (= Ctrl+F for Windows): Find.5) The Find toolbar appears and gets the focus; the curser is blinking insidethe find edit field.6) Press Cmd+V (= Ctrl+V for Windows): Paste.Expected behaviour: The text copied in step (1) is pasted into the Find editfield, because it has the focus.Current behaviour: The text copied in step (1) is pasted at the cursor position into the main text of the Writer document.(In reply to)Stop changing the status and properties of this bug report! This is creating a lot of unnecessary spam for CC'ed users/developers. Just wait and don't comment on this bug if you can't add value to this bug report. First and last warning. Thanks.***has been marked as a duplicate of this bug. ***I never use "Select All"; I just click on the far upper left of the spreadsheet. But you're right - the underlying problem is that the app doesn't behave the way it should, based on where the cursor is.On Wed, 6 Aug, 2014, at 11:01 AM,wrote:***has been marked as a duplicate of this bug. ***bug still present in 4.3.x branch ( see)moving it to mab4.3 list since 4.2.x is EOLTESTING on Ubuntu 14.04 + various LO versions(In reply to angelica.cartwright from)NOREPRO with LO 4.4.0.1 (as expected -- see,)CONFIRMED: when pasting using the menu; testing with - LO 4.4.0.1 and- 4.5.0.0.alpha0+ (Build ID: 5c60dab390d66a4d5abeaf548efecf3913b90839 Time: 2014-12-31_00:20:30)I tried to repro the problem with LibreOffice 3.3.0 (OOO330m19 (Build:6), tag libreoffice-3.3.0.4), but the Find interface is a separate dialog, and loses focus when I click on the 'Edit' menu, so pasting into the document seems somewhat reasonable.UNCLEAR: LO 3.3.0.4Changed the summary as Edit > Paste doesnt work on any operating system to paste into the find bar (tested Linux and Windows) and it shouldnt work that way. Luckily Mac users have a work around - right-click paste. :Dwhile right-click paste does work as expected. Both Edit:Paste and Cmd-V do not work, did you mean to change the summary to remove Edit:PasteI hit this using version 4.4.1.2 on Mac OS X 10.10.2.While there is a work-around (right-clicking in the "Find Text" area and using "Paste" in the resulting pull-down), I didn't learn about that until finding this bug report and reading the comments. Also, there was no way for me to (easily) manually type the characters since I was searching for a Chinese string, which I don't know how to type.***has been marked as a duplicate of this bug. ***Tested with 4.4.3.2 and 4.4.2.2***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***I have this bug on Libreoffice 4.4.4.3 and Yosemite 10.10.4. This bug is really annoying, the user can try to c/c several times before realizing, he has paste the content of his search in a cell...Regards,***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Tested on AOO 3.3.0.20 (build:9567)cmd + f opens separate find dialog, cmd + v to paste a search string works as expected. So this is not an AOO bug.Tested on LibreOffice 3.3.0 OOO330m19 (Build:6)tag libreoffice-3.3.0.4same.→ regressionpretty sure the regression was intruduced when the search bar was introduced and since then likely this bug has always existed, so in that regard not a regression.→ regressionIt depend on point of view:Dev view: The bug allways exist, but not visible NOT regressionUser view: Previous version of Find dialog does not have this bug, new feature is buggy, so it is change to worse state and updated feature become unusable in some cases → it IS regression (weird workaround exist).On the other hand it's time to celebrate 3rd anniversary of this bug – Happy birthday and long live.PS: There is only one workaround – reassign shortcut to old dialog – see.Cannot really debug that without a mac; but my theory is thatvcl/source/window/keycod.cxxdoes not map the cmd+V to KeyFuncType::PASTE correctly on OS X.Can anybody with a mac add SAL_DEBUG to vcl::KeyCode::GetFunction() and see if it returns the PASTE there?(In reply to Jan Holesovsky from)I have tried debugging by setting a breakpoint at vcl::KeyCode::GetFunction() with lldb.Then typing Cmd+V does not enter the path, i.e., it does not call the KeyCode::GetFunction() at all while usual keys such as 'a' do.This is a infuriating bug. Can I pay someone to fix it?!This is an infuriating bug. Can I pay someone to fix it?!(In reply to Warwick from)Hi Warwick,I guess so yes.There are developers certified that you can contactOr alternatively start a bounty.Thanks for your concern and will to help,Cor@Warwick: Fantastic idea. Throwing money at a bug is a good way to raise the incentive for devs / community to contribute a fix.FreedomSponsers is a nice way of setting up a bug bounty for a specific bug. It seems this bug here has so far not seen any cash:Would be nice if you could make a start. Maybe others will join. With 61 humans in cc: of this bug it should be possible to move this into an area, where fixing becomes compelling.Bug still going strong in freshly installed 5.1.0.3 on OSX 10.11.3(In reply to vmoutoussamy from)Thanks for notifying this!I'm a heavy user of the keyboard myself. (*Read all my comments in the various issues ;) )Now Highest/Critical looks to me absolutely inappropriate for this issue.The Highest should be set by someone working on resolving the issue.Critical makes no sense. How often is your work cluttered by this issue? What simple work around are there? (I'm not on a Mac, but on Ubuntu I can open the context menu in *three* different ways, of which *two* with a simple key board stroke, and choose paste - also with a short cut - from there...)Yes, I fully agree that it is annoying that you have to remember not to use Cmd-V. But importance Major is more appropriate. Especially since it is reported so often.So I'm changing those settings now to be more reflecting reality.There is nothing wrong with getting involved on one or another constructive way?(*NOTE* If there is a neat bounty, I might well be able to find someone knowing the Mac and who did a little for LibreOffice in the past..)Again I support your frustration on this bug. Still, I thought general copy/paste is fine? And please don't forget all that is done on LibreOffice code for all kind of massive improvements that also now already have positive effect for Mac Users.Want to see more? Yes :) Want to see them faster? If possible Yes :)Will complaining help? I'm sorry, but I doubt. And I know developers that often put a whole lot of energy and sweat in their work, don't get a positive stimulus from it either.Please don't take this as a personal criticism on your post. I only pick your's from the list ;)So have a good day, and please jump in if you can think of any constructive contribution that is within your means.Ciao - CorI'm sorry I have to confirm: - with 5.1.0.3 on OSX 10.11.3 - concerning both cmd-F and cmd-A - in writer, calc, impress and draw.And I wish to stress the high annoyance factor, not only to Cor Nouws: The user can't always see that he has pasted something into the document. When scrolling, then deciding to cmd-F, the selection and the unintended paste can meanwhile be miles away. Then, only "doesn't paste into the search field" is his impression, but the document remains altered in error.I once lost valuable data myself by overriding calc fields, so please do all take this bug serious, keep workflows equal on any OS and continue all the brave rocking!Otto (after having made a small donation to the Doc-Foundation today)(In reply to Cor Nouws from)The main problem is that in Calc if you press CMD+F and then CMD+V this overwrites real data in a cell that had the focus before CMD+F, which might (and usually does) go unnoticed.Data loss sounds pretty critical to me.@Kendy, Takeshiwould that be influenced by /vcl/osx/vclnsapp.mm@Tor, can something similar be done here as Matthew dug up for(In reply to xfrz from)Though - looking at my work flow and how one notices work - I do not expect that frequent, I recognize your point...I wrote to the guy that I meant that might be interested in 'bounty-solving' this bug. I hope that will soon help.(In reply to Cor Nouws from)I have to apologize, maybe I didn't choose the right word. I'm not really complaining though, I'm just putting my "basic user hat" and I fully understand that this kind of feedback from a dev perceptive could be seen as something far away from a valuable feedback. Yes, this is a kind of feedback that a "project manager" would appreciate and understand for his value. So this might be the wrong place to say it, to the wrong people, but I have hoped that someone would catch this, because in the long run, users wont use any software with a flaw in a basic capabilities and won't make good publicity to his peers about this software.(In reply to Cor Nouws from)It has been mentioned here before, but i would like to reiterate that data might be overwritten in a cell that is off the screen already - i.e. totally impossible to *notice*.(In reply to Cor Nouws from)Not as much as I hoped - partly because he's working in LibreOffice code really rare, which makes the treshold a bit higher.So it better to look for other options.(In reply to xfrz from)Then - after all - let me set to critical. Again..Still present in LibreOffice 5.1.1 RC1 (LO 5.1.1.1, Mac OS X 10.11.3)Hi Paul; thanks for testing - but rest assured that this bug will not be fixed unexpectedly without this issue being updated ;-)Paul: I heard you were interested in looking into this, so let me add some more code pointers here...The actual task is to find out why pressing the Cmd-V does not hit the vcl::KeyCode::GetFunction() in vcl/source/window/keycod.cxxI'd try to put there a breakpoint, and see where is it called from when you press eg. the key 'a' (as according to, that case enters that), look up the stack, and see where it is coming from; you'll probably see something around vcl/osx/vclnsapp.mm or other .mm file.Then I'd try to put a breakpoint there in the .mm file, and see if you get at least there when pressing Cmd-V; and then find out what is different to the 'a' case, and try to fix that - so that you get to the GetFunction().Talking about vcl/osx/vclnsapp.mm, I am particularly suspicious of the if( pKeyWin && [pKeyWin isKindOfClass: [SalFrameWindow class]] )where in the 'else', they say // #i94601# a window not of vcl's making has the focus. // Since our menus do not invoke the usual commands // try to play nice with native windows like the file dialog // and emulate them // precondition: this ONLY works because CMD-V (paste), CMD-C (copy) and CMD-X (cut) are // NOT localized, that is the same in all locales. Should this be // different in any locale, this hack will fail.and continue with some stuff with cmd-c / cmd-v etc.So maybe as the first thing, I'd try to comment out the "&& [pKeyWin isKindOfClass: [SalFrameWindow class]]" part of the if, and if that helps, we know we need to find a way that still lets the native dialogs working, but makes the cmd-v in the toolbar work.CreatedBacktrace from keycod.cxx after pressing a in Find boxI've been looking into this a bit as well, after being notified about it by Cor. For hardware reasons, I'm using Mac OS X 10.7 and LO 4.3, but I can reproduce the issue.I tried some of Jan's suggestions ():- I tried some changes on vclnsapp.mm. Commenting out the "&& [pKeyWin isKindOfClass: [SalFramWindow class]]" does not change the behavior for me, nor does commenting out the first pKeyWin section, or even the entire pKeyWin section. I reverted those changes for now.- I did a stack backtrace on keycod.cxx, vcl::KeyCode::GetFunction(). Indeed the breakpoint does not get hit when pressing Cmd+V, but it does when pressing 'a'. The steps I took and the output are in the attached file.Is anyone else working on this issue now? Paul? Otherwise, I'll just continue with Jan's suggestion to look up the stack, etc.I've been able to build LO on Mac OS X 10.11 so I'll start debugging as well.Something else I notices that may help:The Find-box is part of a toolbar, but other toolbars such as Calcs Formula toolbar do not exhibit the wrong paste behaviour on Cmd-V or select behaviour on Cmd-A.Paul: I can confirm what you describe.Further findings:Breakpoint at -[SalFrameView keyDown:] (salframeview.mm:958, frame #22 in the stack trace I posted earlier) is not triggered by Cmd+V, though it is by 'a'.Breakpoint at -[NSWindow sendEvent:] (frame #23 in the earlier stack trace) is triggered so frequently that there is no chance to switch to the LO window and press Cmd+V.I probably won't be working on this for the next few days. Hope you can find out more.***has been marked as a duplicate of this bug. ***@I revert your change in the summary.Thetouches a different subject. Thanks for noticing that. But to handle that, if desired, a separate issue would be preferred.Ciao, CorA little analysis of flow (debug) and code has learned:a) The target that's hit with paste of context menu in findbar is Edit::Paste() Should this code also eventually be run when Cmd-V is pressed?b) In vclnsapp.mm: when textfield of Findbar has focus Cmd-V, then in sendEvent() [pKeyWin isKindOfClass: [SalFrameWindow class]] is true and for that reason the else if clause with handling for Cmd-V, -C, -X and -A will never be hit.c) The UI type of the findbar is vnd.sun.star.findbar:FocusToFindbar. Could it not being of type .uno.xxx be relevant to the bug in question?To be continued.p.s. I've always tried to stay away from GUI code and now remember again why.Reminder, in the handling of Cmd-V, which (type of) window would one expect pKeyWin to point to when the text field of the findbar has focus?Is not possible to search a text in a spreadsheet using Cmd+F , Cmd+V , enterShortcut Cmd+V does not work as expected when Find is open (using Cmd+F)Current behavior: pastes the buffer into the selected cell.Expected behavior: should paste the buffer into the Find search box.Mac OS X 10.11.3 (El Capitan)Libre Office: Version: 5.1.1.3Build ID: 89f508ef3ecebd2cfb8e1def0f0ba9a803b88a6dCPU Threads: 8; OS Version: Mac OS X 10.11.3; UI Render: default; Locale: de-DE (de.UTF-8)Bug notified for version 3.4.3I updated today to 5.1.2.1 (Mac OS 10.11.3 - El Capitan)Bug still there.How it is possible to update 2 major versions without fixing a "critical" problem ?On the sidelines of this, I'm cheerful to learn my city's administration is being replaced Microsoft's Office for LibreOffice and plans to allocate 200K euros to assist in the resolution of this type of bug. Hope this will help…It seems this archaic bug tracking system doesn't have a way to vote, so consider this my vote. LibreOffice 5.0.5.2, OS X 10.11.4Sure it does - you can send code - it is more than welcome; but let me remove a couple of developers from this bug =)Michael: sending in code is not a thing every user is capable of. Also sending in code is something completely different than voting on a certain bug. It's sad to see key devs un-cc:-ing themselves.Voting has been discussed a few times, I don't see any drawback to adding it. Also it doesn't hurt anybody. I understand that devs prefer to see real code patched coming in rather than many "me toos" or "+1". But since no voting exists as correctly stated by swrobel, there's no other way than posting a comment.@Paul / Peter, where you able to dig deeper in on this bug?@steve -_- No, sorry, this is unknown territory for me as well and I currently lack the resources to dive into this further.@steve Neither have I given more time to this bug, but I intent to invest more time once time allows ...Well, the root cause seems:159 // see whether the main menu consumes this event160 // if not, we want to dispatch it ourselves. Unless we do this "trick"161 // the main menu just beeps for an unknown or disabled key equivalent162 // and swallows the event wholesale163 NSMenu* pMainMenu = [NSApp mainMenu];164 if( ! bHandled && (pMainMenu == nullptr || ! [pMainMenu performKeyEquivalent: pEvent]) )165 {166 [[pKeyWin contentView] keyDown: pEvent];167 bHandled = GetSalData()->maKeyEventAnswer[ pEvent ];168 }169 else170 {171 bHandled = true; // event handled already or main menu just handled it172 }i.e. on OS X when pressing some shortcut, the main menu is checked first, and if it has an item with this shortcut, then a click on that menu item is simulated instead of sending the shortcut directly to the app. So because the Edit menu has "Paste" item, the OS X menu handling hijacks that shortcut, and it never passed down to the edit widget.Now we only need to figure out what's the right way to fix this...***has been marked as a duplicate of this bug. ***Seems plausible - doing the main menu paste action manually also writes to the document where the focus WAS, instead of the search widget where the focus (cursor) currently is. Which it should not do imho.(In reply to Maxim Monastirsky from)...check out Matthew F's similar work forand refs to(In reply to V Stuart Foote from)sendEvent() is kind of de-multiplexer. pKeyWin is assigned the keyWindow property value (window that currently receives keyboard events).The search bar is a SalFrameWindow; true?If so, then the fix would be to add handling of the Cmd-A|C|V|X|z|Z events for this window - currently no special handling for these cases exists. That these events end up being handled by the document window is obviously the wrong handler is dispatched.Where would these dispatch statements be inserted in the code ?Already the needed dispatch statement can be found in sendEvent() and just changing but the conditions for these statements to be executed may be all that's required. Currently the condition is that the window is not a SalFrameWindow, it should probably be "if (! bHandled)" and the test for pKeyWin The current code does things like "if (cond) { ... return;} else if {...}". When the if true clause always causes a return, then "else" should be omitted IMHO. Applied to the code of sendEvent() the control flow will be easier to grasp.Question: can sendEvent() recurse ? (possibly via pushback of event)That would allow for kind of FSM style of code (though I would not dare to open a Pandorra's box).(In reply to Paul Oranje from)No. "Frame" in LO terms is usually the whole app window.The find widget already has that handling, it's just that the menu handling occurs before the find widget gets a chance to handle it.Again - they are not handled by the document window, but by the menu handling code (going all the way through vcl's Menu and framework::MenuBarManager).One possible solution is to make Cmd-A|C|V|X|z|Z _never_ go through the menu, but I doubt that it's the right approach in general, and esp. when considering(i.e. that menu items should also work with the find field). For the latter, we might try to handle it in SalNSMenuItem::menuItemTriggered, or even in MenuBarManager::Select.Maxim Monastirsky committed a patch related to this issue.It has been pushed to "master":tdf#49853 Some shortcuts should always end up in the viewIt will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Well, this is a horrible hack, but it seems to do the trick.Note that only keyboard shortcuts are covered by this. Mouse click on Edit->Paste menu will still paste to the document. This is not trivial to fix for various reasons, so leaving this for a future investigation. Whoever interested in this part too - please open a new bug, as this one is too long already.thanks Maxim.sometimes brute force is required to kill some die-hard bugs.(In reply to Maxim Monastirsky from)Thanks !An reason that Shift-Z isn't covered ?Does a mouse click then not also cause menuItemTriggered() to be called?(In reply to Paul Oranje from)The underlying widget doesn't seem to support it.Yes, but then [NSApp currentEvent] won't have the right data, so you'll need to check the menu command (i.e. mpMenuItem->mpVCLMenu->GetItemCommand(mpMenuItem->mnId) ) and construct a new NSEvent based on this. So I believe it's doable too. Maybe you interested in working on this? I'll be happy to review and push your patch when ready.There is however one problem with customization. The menu item can be reassigned to anything else (Tools->Customize...->Keyboard) or even localized (bad idea, but still...), but the find widget has hardcoded Cmd+V etc. AFAIK. So in theory there could be some inconsistency that we'll have to handle somehow. Any idea?Follow up covering menubar Edit > Paste behaviorSince this is marked as verified fixed, would it be possible to please pull this up into the 5.1.x branch as well?added "backportRequest:5.1.x" to whiteboardlet's hear from the devs if this is technically feasible.Maxim Monastirsky committed a patch related to this issue.It has been pushed to "libreoffice-5-1":tdf#49853 Some shortcuts should always end up in the viewIt will be available in 5.1.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Confirming the CMD+V/CMD+A issue is fixed for me in 5.1.4 RC 1.VERIFIED FIXED on:Version: 5.1.4.1Build ID: a4d48e4ff0e9f93e78b6356ca7b0b6303e360356Thread CPU: 4; OS Version: Mac OS X 10.11.4; Render: default;Locale: it-IT (it.UTF-8)
id=50675	CreatedCzech spelling does not work in SpreadsheetProblem description: Unable check spelling of Czech text in Spreadsheet.Steps to reproduce:1) Open included .ods file and runCheck Spelling (F7)2) Select Czech Current behavior:Unable select Czech -> allways jump back to English.Expected behavior:Automatically select Czech if you have LO in Czech Language or if you have czech language as preffered in Preferences.Platform (if different from the browser): Tested and Occured on Mac OS X 10.7.4 and Windows 7 (I expect that it is multiplatform bug)Browser: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_4) AppleWebKit/534.57.2 (KHTML, like Gecko) Version/5.1.7 Safari/534.57.2 Ok, IMHO the problem is quite different: Are you able to select any language,except the default one??I'm working in Czech enviroment - Install LO + Czech additions.GUI language is in Czech other language preferences is "Default - Czech".Possible problem in Writer/Spreadsheet…:Switch User Interface to English (not depend on it).Switch Locale settings in LO preferences to for exaple "French (Belgium)", but if I switch in Spelling window language to another language "Polish" and click to "Ignore once", spelling select next word but language switch back to default "French (Belgium)".Dear Bug Submitter,This bug has been in NEEDINFO status with no change for at least 6 months. Please provide the requested information as soon as possible and mark the bug as UNCONFIRMED. Due to regular bug tracker maintenance, if the bug is still in NEEDINFO status with no change in 30 days the QA team will close the bug as INVALID due to lack of needed information.For more information about our NEEDINFO policy please read the wiki located here:If you have already provided the requested information, please mark the bug as UNCONFIRMED so that the QA team knows that the bug is ready to be confirmed.Thank you for helping us make LibreOffice even better for everyone!Warm Regards,QA TeamInteresting enough, it's just this spreadsheet.Copy and paste the content into another spreadsheet that is set to czech for the document language and it works fine.Although the one document shows the problem, unless you can figure out how to reproduce with a new document we'll mark as WFM.Thanks for the report - apologies it took so long to get to.I attached a document that I created from yours that works right with the Czech dictionary.CreatedWorking file with Czech Dictionary
id=50832	CreatedLibre Questions - doc2pdf conversion quality issue on Linux installation of Libre 3.5Issues/Questions: A) We have installed LibreOffice 3.5 (3.5.3.2 to be precise) from the website URL:on Linux (GNU coreutils) 6.12. We need this software to perform doc to pdf file format conversions along with other format conversions supported by libre (E.g.: doc2html, doc2ps, html2rtf, wp2html etc.). This is going to be used for a critical project in my division and we need extremely urgent help to answer this question: doc2pdf conversions on the above Libre version has some issues such as extra empty pages being introduced, spill over of text onto next page when there are long headers/footers in every page or dense text. The same issue is being observed in Windows (3.5.4 ) as well as Linux (3.5) versions. Are there any options (command-line / GUI) that we can give in the Libre (Linux/Windows) that could potentially help us with circumventing this issue ? Please let us know on priority. Also is a more stable version of Libre (where these bugs have been fixed) going to be released soon.. if so how soon and when can we download the same? A mail from our architects/technologists describing the issues we are facing is also attached here for your ref (RE: Initial analysis valuation of LibreOffice tools.msg)B) We want to invoke LibreOffice in GUI mode on Linux to test out format conversions manually. Please let us know how to invoke LibreOffice 3.5 in GUI mode using xming. I find an executable called soffice under /usr/lib64/libreoffice/program in the installation.. is this the program that will eventually be invoked as GUI when invoked using an X-server? Please provide some guidance. Thanks. Steps that I have followed (with little success) to invoke the X (GUI) version of Libre are also attached with this mail (FW: Opening soffice process in GUI mode (X windows) on Linux.msg) for your ref . Business Need: We want to to get Libre up and running on PRODUCTION for critical systems here to replace legacy Windows conversion strategy that is currently being used (but has some scalability issues), with a Linux based solution using LibreOffice. Hi, Please get back to us ASAP as a critical PRODUCTION release at our organisation has been held-up due to this issue.Thanks & RegardsJnaneshwar.H.RThomson ReuetersCreatedThis is the output we obtained by passing page14.doc through Libre 3.5 on LinuxCreatedThis is the input file to obtain page14-libre.pdf from libre 3.5 on linuxCreatedThis is another sample of output (pdf) obtained by passing an input (doc) via LibreOffice 3.5 on LinuxCreatedNew PDF output generated by libreoffice 4.0.3.3I think, the issue has been fixed in libreoffice 4.0.3.3 (see attachment)Can you check if this issue still exists?Dear Matthias Wieser<> Thanks so much for this response, I’ve cascaded it to Technical folks (architects/leads) in my org for review._____________________________________________Best Regards,Jnaneshwar RamaswamyDATA CAPTURE (DCGroup) | APS - LEGAL | Thomson WestThomson Reuters<>From:[]Sent: Monday, May 13, 2013 1:40 AMTo: Ramaswamy (R), Jnaneshwar H. (TR Technology)Subject: [] doc2pdf conversion quality circumspect, on Linux installation of Libre 3.5Matthias Wieser<> changed<>WhatRemovedAddedStatusNEWNEEDINFO<> on<> from Matthias Wieser<>Can you check if this issue still exists?________________________________You are receiving this mail because: * You are on the CC list for the bug. * You reported the bug.Jnaneshwar, please respond only via browser and not via mail. Otherwise you will badly clutter the bug tracker.Setting to worksforme as of.Jnaneshwar, if you still experience this problem, could you please try to:* test against the latest stable LO version (currently 4.1.4.1)* you might also want to reset your user profile and see if that improves the situation:Should you still run into this problem, you can re-open this issue.Hi, I will be on vacation on May 16th, 2013 due to personal work. Please contact DCGroup for any immediate assistance.Thanks & Regards,Jnaneshwar.H.RDATA CAPTURE
id=51064	I have a large excel file (58 MB). I have try this file from LibreOffice 3.3.x until now, and it has a great improvement. At first try using LO 3.3.x I opened this file with more than 1 hours load time, it is so annoying, so I back to MS Office Excel just to open that large file. Now, with LibreOffice 3.5.x, the load time for that file has show a great improvement in load file, as we now before 3.5.x it can be opened for 1 hours, now it can be opened for less than 10 minutes depend on PC specification. The problem is not just that, it's appear when I saving that file, it can take more than 30 minutes just to save that file. The larger file, the longer times needed.It's not the only large files. There is another files that larger than it, the size is 224 MB. And when I trying to load that file, LibreOffice just crash after a hour loading time.See attached file for example. sorry, the attachment cannot upload more than 3 MB file, so there is link for the sample fileI am getting huge XLS files when saving spreadsheets as XLS with spreadsheets that previously were similar size or slightly smaller in XLS form than in ODS form.Now the XLS file is well over 50 times bigger than the ODS file!!!This is with V 3.5.5.3 on WINDOWS.This should be already fixed in 3.6 and 3.5.6.Yes, seems to be fixed in 3.6 and 3.6.1.Closing this per.
id=51759	OS = UbuntuCan open blank application without any document loaded. Trying to start any Libo application either does nothing, hangs or closes LibO framework! Can't repoduce this....Can you please clear your user profile...Ok, CRAH when opening .xlsx NOT .docx.fodt .odt is OKMore research neededIrregularly I have a problem when I open a spreadsheet, that at the first attempt the office crashes: "property not found"(haven't found time yet to investigate, maybe already known ?)More precise description:- I start "lodev3.6": The GUI is loaded as excepted displaying the dialogue with the application buttons.- If I start the Draw application - for example - LibO freezes with the display in the attached screen shot.Createdscreenshot lodev3.6 Drawtypo:excepted -> expectedBug also present in:Version 3.6.0.0.beta3 (Build ID: 3e2b862)- Formula: Framework closes without message- Draw: Freeze- Presentation: Freeze- Calc: Framework closes without message- Writer: Nothing happens when clicking buttonI'm not able to use this build while current "stable" x86_64 builds are running without problems on my machine.Is someone working on this bug? Is additional info necessary?Did you try with a fresh user profile?Not sure. I have not deleted profile of stable builds. But I thought beta builds would use separate profile directory.Could you tell me please where stable and beta builds store their profiles? I cannot find a directory ".libreoffice" in home direoctory.I have deleted all LibO stuff in opt and .config (profiles) and did a CLEAN install of Version 3.6.0.1 (Build ID: 73f9fb6)LibO_3.6.0.1_Linux_x86-64_install-deb_en-US.tar.gzLibO_3.6.0.1_Linux_x86-64_langpack-deb_de.tar.gzLibO_3.6.0.1_Linux_x86-64_helppack-deb_de.tar.gz==> Same problem! :-((Why do we release "Release Candidates" while there are such blockers?Related to the following issue?No I can give a little bit more information.I found another way which forces a close of LibO. If I try to open the Options from within a blank GUI, LibO quits with the following message in the terminal:terminate called after throwing an instance of 'com::sun::star::uno::DeploymentException'(Changed platform to "All" since I'm not sure if this is a x86-64 only problem.)I found that Base is the only working application.Could this bug be Java related? Is the base the only application not using Java?My installation is also affected by this bug:Related?OfficeUser, do you use the official TDF packages fromor the Ubuntu-specific builds?Also, could you please attach strace and backtrace logs?The backtrace log is a bit tricky because it does not crash => you need to break the cycle by [Ctrl-c] when it freezes. Please, do not forget to get backtrace from all threads (thread apply all bt).Anyway, many other people are able to run the official Linux packages => it is somehow specific => it can't block the release for others => reducing the severity.Related/dupe of:if so:isnt quite right and this is not solved yet.Fixed inVersion 3.6.0.2 (Build ID: 815c576)
id=51023	Problem description:Sorting slides in either* slide sorter* left panelis broken in versions 3.5.x (still present in 3.5.4 release) and 3.6 beta 1 Tested under OS X 10.7 with existing and new presentations.Trying to drag and drop a slide always results in the moved slide being the first slide of the presentation.This is happening in Slide sorter view as well as in the slide panel in normal view / slide editing.Workaround:One has to use cut and paste to change ordering of Slides.Steps to reproduce:1. Open a new presentation2. Create a few slides3. Go to slide sorter / view4. Try to move a slide to a different position using mouse drag and drop.Current behavior:Always results in the moved slide being slide inserted at the beginning of the presentation.Expected behavior:Place the slide, where I dropped it. Show preview while dragging the slide where it would be positioned, would I drop it at this moment.Platform (if different from the browser): Browser: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:13.0) Gecko/20100101 Firefox/13.0 I also observe this behavior on Mac OSX 10.6.8LibreOffice 3.5.4.2 Build ID: 165a79a-7059095-e13bb37-fef39a4-9503d18CreatedCrash report when using slide panel to move a slideI think this crash might also be related, I've been using this version of LibreOffice for two days, and have crashed in the same manner (when trying to move pages around) at least three times.I do not reproduce exactly this bug on MacOS X 10.7.3 with LibO 3.6beta1.But,when i try to change a slide order by drag and drop, the behaviour isn't the expected one.1. Create 4 slides presentation2. Press left mouse button on the first slide in left panel "Slides"3. Move mouse to the down between slides 3 and 44. Release mouse buttonCurrent result : Nothing happen, the slide hasn't move.Graphically the ghost slide and animation to demonstrate where the slide will ordered doesn't appear.Expected result :Slide moved between slides 3 and 4Animation show the futur state.I've made a screen cast to see the behaviour.CreatedBug move slide in Slides panel(In reply to)Fabien,If understood that right, this is what is described at the beginning of this bug.ANY slide moved to a different position ends up being the first slide. So if you move the first slide, it will end up being the first slide.Please confirm, that this is also happening with other slides than the first one.REPRODUCIBLE with* LibreOffice 3.5.4.2 (Build-ID: 165a79a-7059095-e13bb37-fef39a4-9503d18)* LibreOffice/LOdev 3.6.0beta1 (Build ID: 1f1cdd8)both with German langpack installed, both on MacOS X 10.6.8 German UI (Intel).Taking the original description together withand, I can confirm that if I create a simple presentation with 4 slides (I will attach my sample file), sorting slides via drag and drop both-- in the left panel labelled "Slides" or-- in the slide sorterdoes not work correctly.The circumstances are exactly the same in both cases:-- if I try to move the *1st* slide to any other position, most times nothing happens;-- if I try to move *any* *other* slide to another position, either nothing happens or the moved slide is inserted before all other slides (becomes slide #1), regardless where I have dragged the slide to.I say "most times", because the behaviour seems not to be 100% deterministic (there must be some variable I don't understand).And sometimes (cf.), if I try to drag around slides for a while,-- LibreOffice crashes (I will attach the log file); this crash seems to happen a bit more often with beta 1 than with 3.5.4; but the crash log indicates always exactly the same type of crash: the 1st line of the trace for thread 0 is always 0 libsdlo.dylib 0x4325a126 sd::slidesorter::model::PageDescriptor::GetPage() const + 6CreatedTest file forCreatedLog file for crash which occured after some slide drag and dropCan someone please test if this bug is reproducible-- on Windows-- on some Linux variant? Thank you very much in advance!A more complete review with LibreOffice 3.5.4.2.Given four slides numbered 1, 2, 3, 4, what allows 4 x 3 = 12 primary drag actions, I get the following results when dragging slides in the "Slide Sorter" view and/or in the "Slides" section of the main window (the results are identical):1a) Dragging the 1st slide between slide 2 and 3: nothing happens (still 1, 2, 3, 4)1b) Dragging the 1st slide between slide 3 and 4: nothing happens (still 1, 2, 3, 4)1d) Dragging the 1st slide after the last slide: works (result: 2, 3, 4, 1)2a) Dragging the 2nd slide before the 1st slide: works (result 2, 1, 3, 4)2b) Dragging the 2nd slide between slide 3 and 4: 2 is inserted before 1 (result 2, 1, 3, 4)2c) Dragging the 2nd slide after the last slide: works (result 1, 3, 4, 2)3a) Dragging the 3rd slide before the 1st slide: works (result 3, 1, 2, 4)3b) Dragging the 3rd slide between slide 1 and 2: 3 is inserted before 1 (result 3, 1, 2, 4)3c) Dragging the 3rd slide after the last slide: works (result 1, 2, 4, 3)4a) Dragging the last slide before the 1st one: works (result 4, 1, 2, 3)4b) Dragging the last slide between slide 1 and 2: 4 is inserted before 1 (result 4, 1, 2, 3)4c) Dragging the last slide between slide 2 and 3: 4 is inserted before 1 (result 4, 1, 2, 3)Analysis:A) moving a slide via drag and drop before the 1st slide or after the last slide worksB) moving a slide via drag and drop to any other position does NOT work, but inserts the moved slide before the 1st slide. In the special case when the moved slide is already the 1st slide itself, this means that nothing happens at all.CreatedCorrupted sample file, corrupted via a simple sequence of drag-and-drop actionsBut the analysis given in my previous comment holds true only when I do single drag-and-drop actions, i.e. open my sample document () before each step again and try only one step at once.If I do several drag-and-drop actions one after another, I observea) crashes and b) data corruption.I have not found yet a simple way to reproduce the crash with 100% reliability, but here is a simple sequence of drag-and-drop actions which leads to data corruption:1) Open my sample file () with LibreOffice 3.5.4.2 or 3.6beta 1 and switch to the Slide Sorter. The order of the slides is first "1", "2", "3", "4".2) Drag slide "2" after slide "3". The order of the slides is now "2", "1", "3", "4" (wrong!).3) Drag slide "1" (the 2nd one) after slide "3" (the third one). The order of the slides is again "1", "2", "3", "4" (wrong!)4) Drag slide "2" after slide "3". The order of the slides is now "2", "2", "3", "4": corruption!Now we have two slides which look identical at the beginning of the slide show. The old slide "1" is gone.And this is a serious and stable corruption, not only a drawing error: the double slide "2" is still present when I save, close and open the document again, and the old slide "1" is still missing.Attached you find such a corrupted file which is the result of applying the given four steps to my sample file.Some more hints and observations:(a) There are some bug reports which could be related to this issue, especially for Linux, but I can't find any exact duplicates for now:*just says that sorting slides via drag-and-drop does not work at all*is the same (drag-and-drop does not work at all)*speaks about "drag & drop of slides from another document"*seems to speak about how many slides are visible in the slide sorter (if I understand it correctly).(b) Updated summary according to previous comments.(c) This bug is NOT REPRODUCIBLE with LibreOffice 3.4.6 (OOO340m1, Build:602), German langpack installed, on MacOS X 10.6.8 German (Intel).-> The bug is new in 3.5.x, therefore added keyword "regression".(d) This bug is NOT REPRODUCIBLE with LibreOffice 3.4.6, German langpack installed, on WinXP, therefore it seems to be a MacOS X only issue for now. (But someone else should still test Linux).@Thorsten Behrens,@Radek Doulik:I insert your addresses into the CC list of this bug report because you are our Impress experts (and MacOS X expert, too, in the case of Thorsten). This bug seems to be limited to MacOS X for now, but it is nevertheless very important and urgent -- it makes sorting slides in Impress completely impossible, it leads to data corruption and even to crashes. Additionally, it is an regression introduced in LibreOffice 3.5.x.I have done some extensive testing (see especiallyand) to give you an exact description about when slide sorting works and when it doesn't, and what exactly happens when it doesn't work. I hope this helps a bit.Now I ask you: please take a look at this issue. I know you have got much other things to do, but this is definitely a really critical bug, and should be placed high on your Impress priorities list.Thank you very much in advance!The real question is: when does the slide get corrupted; the trace is common as:Thread 0 Crashed: Dispatch queue: com.apple.main-thread0 sd::slidesorter::model::PageDescriptor::GetPage() const + 61 sd::slidesorter::controller::CurrentSlideManager::SetCurrentSlideAtXController(boost::shared_ptr<sd::slidesorter::model::PageDescriptor> const&) + 2132 sd::slidesorter::controller::CurrentSlideManager::SwitchPageCallback(void*) + 633 Timer::Timeout() + 28... from the mainloop ... I wonder if Linux versions have a similar trace. Most likely we need to run this under valgrind / drmemory to go back in time to when the corruption happened.Also - a build with debugging symbols is always going to produce a better trace; I assume we have these for Mac, any chance you could try one if it's easy to reproduce ?The comment in the relevant method doesn't fill one with confidence either:IMPL_LINK_NOARG(CurrentSlideManager, SwitchPageCallback){ if (mpCurrentSlide) { // Set current page. At the moment we have to do this in two // different ways. The UNO way is the preferable one but, alas, // it does not work always correctly (after some kinds of model // changes). Therefore, we call DrawViewShell::SwitchPage(), // too. ViewShell* pViewShell = mrSlideSorter.GetViewShell(); if (pViewShell==NULL || ! pViewShell->IsMainViewShell()) SetCurrentSlideAtViewShellBase(mpCurrentSlide); SetCurrentSlideAtXController(mpCurrentSlide); } return 1;}(In reply to)I will be happy to do so -- but where can I get a Mac build with debugging symbols?@Thorsten:Can you explain me where to get a Mac build with debugging symbols?***has been marked as a duplicate of this bug. ***CreatedLog fr crash after some slides drag’n’drop with Norbert's debug version of LibO 3.6.0.2+(In reply to)@Michael Meeksand other developers:thanks to Norbert's debug version of LibO 3.6.0.2+, I have tested this again and hope that the attached log file for the crash helps to track down the issue. Again, the crash happened after I opened my simple sample file for this bug () and dragged slides forth and back in the "Slides" panel (I did not use the "Slide sorter").In addition, there are some very interesting messages in the _console_. After the first drag-and-drop action (slide 1 dragged after slide 4), the console printed 120 (!!!) times:24.07.12 12:22:20 [0x0-0xa60a6].org.libreoffice.script[2081] warn:legacy.osl:2081:1:/Volumes/Raid0/g_core/sd/source/ui/slidesorter/controller/SlsSelectionFunction.cxx:1848: OSL_ASSERT: mpDragAndDropContextEvery following drag action caused the same line to be printed again, each time, for about 100 times or so.Finally, after the last drag-and-drop action, here are the last four lines which LibO printed to the console (the first one is the same as above, but the 2nd slightly differs, and the 3rd and the 4th one look very interesting):24.07.12 12:25:52 [0x0-0xa60a6].org.libreoffice.script[2081] warn:legacy.osl:2081:1:/Volumes/Raid0/g_core/sd/source/ui/slidesorter/controller/SlsSelectionFunction.cxx:1848: OSL_ASSERT: mpDragAndDropContext24.07.12 12:25:53 [0x0-0xa60a6].org.libreoffice.script[2081] warn:legacy.osl:2081:1:/Volumes/Raid0/g_core/sd/source/ui/slidesorter/controller/SlsCurrentSlideManager.cxx:247: OSL_ASSERT: rpDescriptor.get() != NULL24.07.12 12:25:53 [0x0-0xa60a6].org.libreoffice.script[2081] /Volumes/Raid0/g_core/solver/unxmacxi.pro/inc/boost/smart_ptr/shared_ptr.hpp:428: failed assertion `px != 0'24.07.12 12:25:54 com.apple.launchd.peruser.501[98] ([0x0-0xa60a6].org.libreoffice.script[2081]) Job appears to have crashed: Abort trap24.07.12 12:25:55 ReportCrash[2170] Saved crash report for soffice[2081] version 3.6.0.2 (???) to /Users/eiselemalina/Library/Logs/DiagnosticReports/soffice_2012-07-24-122554_Kore.crashHope it helps to fix this issue!Hi Roman - thanks so much for your work getting a trace with debugging symbols, however - I suspect you need to run soffice.bin under a debugger to get what we need out of those symbols. If they 'worked' I would expect to see detailed file + line-number information for each method in the call-trace; I suspect the generic crash app doesn't provide that.Either way, this looks thankfully unrelated to the a11y problems though. Looks like a normal slideshow issue - where the cult of uncontrolled asynchronicity tends to lead to poorly lifecycle-managed callbacks - combined (ironically) with poor interactive performance ;-)Thanks !(In reply to)Good to know -- I would have expected much more detailed information myself, but thought that LibO just does not provide it. BTW: *Which* debugger would do the trick, and is there somewhere some kind of guidance *how* to run soffice.bin under that debugger (on MacOS X, of course)?Good news! So I hope some developer, e.g. Thorsten, who is both a Impress and a MacOS X expert, will look into this issue soon?! ;-)Issue still existent in 3.6 release.- slide move animation doesn't show slide (frame), just a black sqare when moving a slide- moved slide still always ends up being the first slide, exception: - when it is moved at the end of one row of slides and you move the cursor outside the slide sorter panel. Then the animation and placement works correkt for the last position in that row.!!! - slide content of moved slide replaces the content of the slide where it is dropped.Tested on openSUSE Linux (with openSUSE provided 3.6 packages): slide sorting is working as expected.(In reply to)Thank you very much for testing again! However, please do not "update" the Version field: the Version field should always contain the FIRST version which is known to contain the bug, and NOT the last one. Thank you ;-)You know - I never understood how this policy works. How can you easily see a list of bugs that have been re-tested vs. a recent version to see if the issue is still there ? :-) but I guess I should ask on the mailing-list.***has been marked as a duplicate of this bug. ***This regression is nasty and a nogo for Impress. Working on presentations becomes impossible. Therefore I have increased the importance to highest.The bug is still present in LO 3.6.1.2.Mouse wheel scrolling is also not working - might be a related issue.The latest version of OpenOffice.org (3.4.1) does not have this bug. Hence an ugly work-around is to open the presentation with OOo, rearrange the slides, and continue with LO. This is silly. Where is the download for LO 3.4??The new bug report– “Clicking Slide Thumbnail of Non-Focused Window Causes Rearrange/Crash” is nearly related to the present one (but NOT an exact duplicate, so please don’t markas a duplicate for now, until we have more insight into the roots of both bugs!).It contains of two parts:1) “Clicking on a slide thumbnail in the left pane when LibreOffice does not have window focus causes the selected slide to shuffle to the top of the deck (become slide number one).”IMHO this could be related to the broken drag-and-drop of slides in the present bug report; I mean, both issues could have the same underlying problem.2) “Now that we have rearranged slides, we can click on the thumbnails for the two non-rearranged slides as many times as we want, but any attempts at clicking on the rearranged slide (slide 3 cum 1) will cause LibreOffice to crash.”IMHO this is the same crash as the one reported in the present bug report, because the log files created for the crashes are all more or less identical.So 1) seems nearly related to the present bug report, and 2) identical.I would suggest to mark this bug as a blocker: Due to this bug, you cannot do a presentation in a productive environment with Impress on a Mac as this time.***has been marked as a duplicate of this bug. ***(In reply to)Note that 53249 has a test case attached which apparently also manifests on Linux.(In reply to)-> Therefore changed Platform to "All" (even if not reproducible on Windows, we need to use all, if reproducible both on Mac OS and Linux).***has been marked as a duplicate of this bug. ***Changed QA person just so that I can easily query. Hoping to get a fix committed soon. Thanks for the thorough bug report***has been marked as a duplicate of this bug. ***Added bibisectrequest, not sure whether that really will help, more for training of bibisecting staff ;-)Please make 3.4.6 available again for download until this bug is resolved(In reply to)Please seefor *all* old LibreOffice versions, including 3.4.6.Lifecycle 3.5 is terminated, so 3.5 MAB is no longer useful.Comparing this one with other bugs this definitively is not a blocker.This bug is rated as HardHack on <>, so let's hope the best@Sergio Ballestrero:<> item 4If yyou think <> should be mentioned more prominent in download hints please submit a separate WWW bug!New research results:This bug appears *first* in LibreOffice 3.5.4.1(= RC1, build ID: 7306755-f4f605c-738527d-1cf4bc1-9930dc8).It is *not* in LibreOffice 3.5.3.2(Build ID: 235ab8a-3802056-4a8fed3-2d66ea8-e241b80):in all 3.5.x versions until and including 3.5.3.2, slide sorting still works (mostly ;-) correctly, both in the slide sorter and in the left panel, when I test with.So this bug was not (as I always wrongly assumed: sorry for not testing this earlier!) introduced somewhere in the 3.5 development process, but precisely between the branching of 3.5.3 and the first RC build of 3.5.4.1. This should it make much easier to find the root of this regression.@ Thorsten Behrens, Rodo, Muthu Subramanian, and maybe others:Could you please check the (not too lengthy) list of commits between the branching of 3.5.3 and the first RC of of 3.5.4.1? Somewhere there in the committs made to the 3.5/3.5.4 branch must be the root of this regression;and if you can identify it there, it should be possible to fix it on the3.6.x and Master branches.Thank you very much!Wow - Roman - that is some fantastic research ! thanks so much for narrowing it down so far :-) !Createdgit diff -u libreoffice-3.5.3.2..libreoffice-3.5.4.1 -- sdThe commit range indeed shows a change to the D&D code:commit e4450c54aee85b295b933e91d207fd8220c01107Author: Luboš Luňák <>Date: Fri May 11 20:33:23 2012 +0200 avoid recursion that can mess up DND setup (fdo#41996) The way too smart ctor for the DND handler started drag immediately, causing a race condition that could recurse to setting a handler again before the first one was actually set, thus immediately again causing the DND to be stopped, and then possibly later again started, depending on how the race condition turned out. Use delayed initialization to avoid this.Lubos - rumour is that this hard-hack / MAB is nearby your fix for.Would a bibisect help?No - we already found the commit in question (assuming Roman's range is right - and it looks very plausible) - thanks ! now it's either fix that commit or revert it.(In reply to)Would a Valgrind trace help to understand why this commit gives this bug?Perhaps the commit is ok in itself but triggers a buggy part of code.(In reply to)I am quite sure about the range (and everybody can, at least on Mac OS X, check it himself/herself: just download 3.5.3.2 and 3.5.4.1 fromand test if you, like me, can reproduce the issue in 3.5.4.1, but not in 3.5.3.2).The only little question which I, as a layman, see is if the problem was really caused (only) by commit e4450c54aee85b295b933e91d207fd8220c01107, or if another commit could be involved (too).Of course, I don’t see any other commit in that range which could be involved (all other commits related to Impress look innocent, e.g. 009776a16410024a9437847af065d2160b434f30); but only a code expert can really judge this. So, if there are any doubts about the question if e4450c54aee85b295b933e91d207fd8220c01107 is really the (only) guilty one,our Impress experts should check the list of all commits (ca.120?) in that range.Has somebody actually built a version with the patch reverted to confirm it is really triggering the problem? The change should not have any other effects other than fixing the bug it fixed, so either it's not that, or something somewhere else is broken (race condition, whatever).For what it's worth, I can't get any drag-and-drop to work, in Impress or Writer, in a master build on the Mac currently...(In reply to)It works for me on Mac OS X 10.6.8 (Intel) with the master buildLOdev 3.7.0.0.alpha0+ (build ID: 370m0(Build:0); pull time: 2012-10-25 06:12:34)frombut only as well or as badly as reported here:D&D of text snippets in Writer seems to work well;D&D of slides in Impress works only partly (see commend #10),and if I continue, the corruption happens (see).Ha, I spoke too soon, it must have been some weird temporary glitch; simple d&d in Writer *does* work normally for me. And I indeed can reproduce the slide re-ordering problem. Will now try to see if reverting the patch helps.Yes, after git revert e4450c54aee85b295b933e91d207fd8220c01107 drag-and-drop in the slide sorter seems to work fine... Over to Lubos;)Looked into it with Lubos a bit and I now have a fair idea what to look for and where to debug... will do that in the coming days. (Lubos has no Mac.)I debugged this during the flight home and found out the root cause to the problem (but not how to fix it): On the Mac, all the drag-and-drop action happens during the call to pSlideSorterViewShell->StartDrag() in the Initialize method. Thus no wonder that mpDragAndDropContext is null in the ProcessDragEvent() as it has not been initialized yet, and is in fact initialised only after the drag-and-drop already has finished.I have a vague feeling that the same thing might happen on Windows, too, but will have to build me a fresh Windows build to verify. (I vaguely remember seeing something similar happening back in the days while working on the GTK port to Windows.)(Nope, does not happen on Windows.)New to LibreOffice (OpenOffice user for many years) I first posted this the other day in Ask LibreOffice."Using Version 3.6.2.2 (Build ID: da8c1e6) on a MacAir running Mac OS X Lion 10.7.5 I cannot re-organize Impress slides by any method described in Help: Slide Sorter, Slide pane in Outline, etc. Occasionally a slide will move but only to the front of the slide deck. Occasionally the moved slide will replace another one. Usually after enough attempts LibreOffice crashes."I have now discovered the workaround posted: attempting to move a slide beyond the active window, then bringing it back into the window produces the thumbnail (which previously did not render). With the thumbnail visible I can drop the slide into position. This appears to work in Slide Sorter, or the Normal view also.This is a copy of the Comment posted today forwhich seems to be superseded by this bug.If you need more info I'm(In reply to)(probably not the best way to report but that's the occasion:)Now that this seems related to the drag and drop function on mac, there is another issue that has been annoying me on the mac version for quite a while (i.e. I think all 3.5 and 3.4 version are concerned):one should wait a while (~1 second) when moving a border of any shape to have the proper behavior. Otherwise a click on the handle and move immediately, the complete object is moved.Boudry: thanks for your input - but please -never- clutter a single focused bug with an unrelated issue - please file a new bug for your problem.Tor - any cycles to debug this and/or get a stack trace from the constructor and Initialize methods on Mac so others can jump in ?Thanks ! :-)Michael: The core surprising point that Lubos's patch wasn't aware of was that all the drag-and-drop happens during the call to pSlideSorterViewShell->StartDrag(); that returns only after the whole drag-and-drop operation has finished.For now, I fixed it in master by just reverting the patch for MacOSX only:commit 192a0eb2beccee5349c3c7b60208aa95eb985f35Author: Tor Lillqvist <>Date: Wed Nov 7 15:50:21 2012 +0200 fdo51023: Revert e4450c54aee85b295b933e91d207fd8220c01107 for Mac OS X See bug for discussion. Basically, the root cause to the problem is that on the Mac, all the drag-and-drop action happens during the call to pSlideSorterViewShell->StartDrag() in the Initialize method. Thus no wonder that mpDragAndDropContext is null in the ProcessDragEvent() as it has not been initialized yet, and is in fact initialised pointlessly only after the drag-and-drop already has finished. Reverted just for Mac OS X and ifdefified in a straightforward even if ugly fashion. Change-Id: Icfb62fb24a5c72fda39c8bcea125267c99ecf624 .../controller/SlsSelectionFunction.cxx | 42 ++++++++++++++++++++ 1 files changed, 42 insertions(+), 0 deletions(-)Thanks Tor - should work for now - it'd be nice to cleanup the Mac abstraction in some deep future I imagine.Pushed to -3-6...VERIFIED as FIXEDwith LOdev 4.0.0.0.alpha0+ (Build ID: 32315e; pull time: 2012-11-13 00:32:26)on Mac OS X 10.6.8 (Intel):sorting slides by drag and drop in the slide sorter and/or in the left panel labelled “Slides” now works again like in older LibreOffice versions; also the data corruption and crashes seem to be gone (at least I can no longer reproduce it by the simple steps listed in).Thank you, Tor, Michael, et. all.!***has been marked as a duplicate of this bug. ***Some meta data cleanup:tag “bibisectrequest” can be removed; added missing target:xxx tags; corrected Platform; assigned to Tor, who did the most important work for fixing this issue.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***target is 3.6.4, not 3.4.6 :-)
id=51973	Problem description: Calc always hangs while pasting the cell content copied from the top of a column (C1) containing a simple formula (A1*B1) to rest of the cells all the way to the end of the same column(down to C1048576).Steps to reproduce:1. .... Open a new spreadsheet in Calc.2. .... Fill A1 with a random number. (e.g. '1')3. .... Fill B1 with a random number. (e.g. '2')4. .... Fill C1 with a formula '=A1*A2'5. .... Copy C1.6. .... Select C2 and press Ctrl + down arrow to move to the end of the column C.7. .... Press Ctrl + Shift + up arrow to select(highlight) the entire column from the bottom up and return to C1.8. .... While holding Ctrl, click C1 to exclude the cell from the current (highlighted) selection.9. .... Press Ctrl + v to paste the previously copied cell content of C1 to the rest of the cells in the column.Current behavior: Calc hangs and stops responding.Expected behavior: The copied cell content/formula is applied/pasted to the selected cells.Platform (if different from the browser): Browser: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C) Confirmed.The first time I tried this, it eventually came out of the hang after less than 20 minutes. The cells were pasted correctly.I then tried a similar thing (but selecting almost the whole column, ) and it hung for 30 minutes+ before I killed it.Trying on a new document, I was able to paste the same formula into 300,000 rows in around 7 minutes.All the while the CPU was at full utilisation.My results suggest this is a performance / scaling problem.FWIW, trying the same thing in Excel, works instantly.Please pay attention to this issue ASAP! I am unable to work with my spreadsheet in which a simple multiplication formula (A cell * B cell) was applied to the very bottom of the sheet and after saving the document I am unable to batch delete the cell content without freeze and 100% system resource.The 18MB file takes 10 minutes to open, 10 seconds to switch between sheets and doesn't unfreeze for the last 14 hours after batch content deletion is assigned to the column with the formula.Both LO 3.5.5 and LO 3.6 RC1 constantly crash during handling of the spreadsheet, while OO 3.4, at least, freezes and doesn't crash.I imagine this is a pure performance / scalability issue in the spreadsheet - we're working on these as a long term task. Then again - it'd be really nice to get a stacktrace of where it crashes / hangs if possible.May I send you the sample file over e-mail? It's a non-disclosure document which requires confidentiality. The file size is around 18-19MB.Seems solved in LibreOffice 3.6.0.4rc(In reply to)Win7x64UltimateTested. The spreadsheet doesn't crash but it still takes several minutes to open and hangs during batch deletion of the cells with pasted formula.Now takes 15 seconds to Paste on LO 3.6.0.4 Win Vista SP1 32bit.Deletion of the pasted cells takes roughly 5 seconds.I was also able to repeat the test (during the same session) without any problems.15 seconds is not ideal, but it is at least somewhat expected.We're doing some major structural work here for 3.7/4.0 see the blog at eg.The expectation is that this will be very much quicker for 3.7/4.0 - and there is not much that can be done for 3.6 - so marking FIXED.
id=51819	Via IRC by _nedRWhen Ubuntu crashes and has to be restarted via commandlineAfter restarting the PC and starting LibreOffice and, of cource, recovering the file, the password protecion got lost.... I managed to reproduce this on Ubuntu 12.04 (LibreOffice v3.5.3) by doing the following steps:1. Save and close whatever documents you may have open in LibreOffice2. Open a new document in LibreOffice (Writer, Calc, Draw, or Impress); Enter some data into it.3. Save the document with a password in any file-format.4. Go to Tools>Options; Select the Load/Save>General page of options; Ensure the entry "Save AutoRecovery information every" is checked and set the "Minutes" value to 1 minute and press OK.5. Enter some more data.6. After waiting for at least 1 minute for the AutoRecovery info to be saved, open up a terminal and kill soffice.bin7. Open LibreOfficeExpected behaviour :- LibreOffice Should display the File AutoRecovery Dialog box. On clicking Next; It should prompt for a password before recovering the document.Actual behaviour :- LibreOffice successfully recovers the file without asking for the password. Furthermore when you save the file, it is saved without a password.I tried to reproduce this error on my Windows partition which had LibreOffice v 3.4.1 but couldn't, so I imagine this is a recent regression.I also wonder whether this implies that the AutoRecovery file is stored unencrypted on the filesystem, because that would be less than ideal from a security point of view.Indeed I can reproduce it in the way described...And I see the problem in 3.5.3 too. And in 3.4.6.But not in 3.3.4 ...So it has to do with the major encryption change in that time?(set version to 3.4.6 releasehave checkd 3.4.0, that does not have the problem!but I did not check versions 3.4.1-3.4.5 .. )hmm, it does happen for the first time in 3.4.6 !This bug is happening to me in Windows XP Home SP3 in LO 4.0.0.3 (Build ID: 7545bee9c2a0782548772a21bc84a9dcc583b89).After a crash, or a power failure, all of the open files lose their passwords. The files that weren't open at the time of the crash don't lose their passwords.It might have something to do with the Save with password checkbox in the Save As dialog box becoming unticked. Perhaps the Recovery function doesn't recover the password.This is a major problem to me because the info in the files really needs to be password protected.I think that LO is better than OpenOffice, but I'll be using OO until this problem is fixed.Confirmed here: Windows XP, LibreOffice 3.6.5.2Unfortunately also confirmed that the recovery file is saved WITHOUT ANY protection, fully unencrypted into the backup directory (user/backup)!IMHO it is a very nasty bug in terms of security, that should seriously be taken into account, and resolved as soon as possible!Now by switched on recovery the "password protected" document gets saved every 5-10 minutes without ANY protection, easily recoverable by not much advanced techniques (eg. undeleting the backup file). It is a MAJOR problem in terms of security, and users definitely should be warned of this, making them switch off the auto-recovery as a temporary workaround.Changed title to stress importance.Nominating as HardHack...As well as the password being lost in LO, OO 3.4.1 Build 9593 on Windows XP Home SP3 loses it as well. The computer crashed and blue-screened. When the document was re-opened, the password protection had disappeared. My previous post:Now I'm thinking of using OxygenOffice instead. But I bet it has the same bug because OxygenOffice is built from OpenOffice!I really ask you to be patient...This issue is being raised - thanks Florian for bringing it to my attention - I will be letting the appropriate people know about itIt's great to hear that this issue is finally receiving the attention it deserves. Thanks, guys!Patches / volunteer developer input most welcome - of course.On pc Debian x86-64 with master sources updated today, I don't reproduce this.Now, perhaps I missed something since autorecovery didn't even appear (although I had run a kill -9)(This is an automated message.)LibreOffice development currently prioritizes bugs with the so called MAB (most annoying bugs) -- as this bug has not run through that process (including writing a short rationale for this bug being a candidate and other who are watching the tracker bug silently approving that rationale etc.) its priority is set to high. Note this is effectively no change in the urgency assigned to this bug, as we are currently not making a difference between high and highest and severity is untouched.You can find out more about MABs and how the process works by contacting libreoffice qa on irc:The QA wiki page also gives you hints on how to get in contact with the team (if IRC fails you, your next best choice is the mailing list):Any update on this, is anybody working on it?Should not be a critical security bug taken more into account, or at least the users warned?And why got the hard hack stuck in the proposed state, should not it be accepted to start the work?Is this bug maybe an NSA "feature"? (Just kidding... hopefully)Just tried, still present in 4.1.4.2Sorry to say this, but if there is no progress, I will try to inform the users and the media directly about this.It is a serious security bug, introduced in 3.4.6 (!), completely ignored for more than 1,5 year (!!) now.The users have the right to know about this security issue, even if it could potentially cast some negative light on LO.- thanks for your feedback; security is clearly important to you - if you're deeply concerned about your data in this way, I would strongly suggest using an encrypted disk: that way document level security is less important, and your data safer overall.If you want to turn your passion into something constructive here, you are more than welcome to work with us to study the code, provide a patch and address the issue: as a community we're eager to help get new people involved, with code pointers, build instructions etc. The ability to type, think and dedicate time to improving the code for others are the only pre-requisites to starting the journey to be an elite coder: you can do it !In the absence of that your suggested approach is unlikely to win many friends in the community you care about; no doubt the underlying issue will be fixed one day - in the medium term I want to get rid of autosave altogether and stream unsaved edits to the file in question as/when we do that encryption will no doubt be part of the picture.All the best.(In reply to)To be honest I never look at the wording in the dialog on document recovery.Could it be that there is space there to inform users to check password protected files that were active when a crash occured?@Michael Meeks - thanks for your answer, but I think you clearly not understood the severe of this bug.To clear some point:1. Security is not important only for me, it is important for everybody who uses password-protection.2. _I_ personally know how to circumvent this bug, but a lot of people does not even dream of having such a big security hole in LO (for more than 1 year), so they are totally helpless against it.3. You advertised the encryption changes in 3.5 as "more secure", while it is just the opposite, saving now a password-protected document every 10-15 minutes completely unencrypted all over the file system.4. I am pretty sure, that it would take only a 30-45 minute debugging session for an experienced developer to find the hole and fix it (maybe just some false flag set somewhere); and I am also almost sure, that nobody took the time to do it from the dev team in the past 1,5 year.5. I tried to download and compile the sources last year to fix this issue, but it was anything else than easy or self-explaining. Maybe I will try again now, but cannot promise anything.6. If somebody without any dev. experience finds in LO a severe security issue, than he has to fix it himself, or nothing happens? And even if he did it, would you accept a security patch from anybody out there, outside of the core team? Sorry, but it sounds a bit lame... (NSA sends its greetings)7. Since 3.5 a lot of minor changes / improvements were made, so there were clearly no resource problem to fix such an issue.8. You did not even accept the proposed hard hack (a critical security bug!) without even explaining why.9. The users DO have the right to know about this issue, and I am pretty sure that if they did, this bug would get a lot more noise and complaining.10. I am just a regular user not a developer, but "to turn my passion into something constructive here" I suggest you to take a look aroundandand maybe in a short time this bug could be fixed at last without further headaches.: about building LO you can find great help here:I'm not going to comment too much more on this but let me just correct one thing. Fixing this will likely take days or weeks of dev time not the 30-45 minutes that was stated. If you're not a develop working on our code you can't possibly know how much time something takes to fix so throwing out numbers is just another good way to not make friends in the community.Please feel free to build LibreOffice as Julien has provided a link and we have an IRC chat where we can also help. I have almost no CS background and I build based on those instructions.Also if you're running Linux these are good instructions:"There are two kinds of cryptography in this world: cryptography that will stop your kid sister from reading your files, and cryptography that will stop major governments from reading your files."This bug although applicable in case 2 also (for which you can workaround by encrypting your file system), has more to do with case 1. eg:- Your system crashes (say power failure). Someone else (say your spouse) uses your computer when the power comes back; opens LibreOffice, gets prompt to recover files. opens document you didn't want them to see (say divorce filing you have been drafting). This bug is very nasty for that reason - Its well-hidden, and manifests itself in a very bad way.This bug is a regresssion since version 3.4.1. My question is -has the architecture changed so much that it is hard for a developer to issue a fix? Asking someone else who is not an expert coder, to issue a fix is unrealistic. I imagine it would take at least a month of effort, for a normal developer, just to familiarize himself with the architecture of a large s/w system like LibreOffice.Yes since that release a lot of lines have changed. Even for experts it takes some time to track down what is going on (millions of lines of code, developers can only be familiar with so much of it, and once they move to a new section, they have to re-familiarize themselves if they have to go back).Thanks for the links, but I think, you did not get the picture.This bug is a problem not for me, but for LO.A professional system cannot afford such security holes, especially not for such a long time.Just imagine some headlines:"Everybody can open your 'protected' LibreOffice documents without knowing the password""LibreOffice developers waiting for a newbie to fix the issue at last"It is a bit absurd, isn't it?I filed a lot of bugs into different systems, but nobody ever wanted to make me, a user responsible for fixing the bug (especially not a security one).I think, the people who were participated in the 3.5 changes should take a look into it, solve the issue ASAP and then this bug should be buried silently as deep as possible (it is not really a good ad for LO, which I personally like very much).I will not post here again (completely useless), but I will inform the other users about this issue if there is no progress this week.and once again - these threats are meaningless. FLOSS is a community - we've done what we can to get you to actually help solve the problem and you have refused to offer anything more than threats and comments. If you ever want to actually help the project, feel free to email me personally as I have more than 10x what I can possibly handle on my plate and would love for someone (you) to volunteer to deal with some of them(In reply to)Okay, although this might sound impolite: Repo steps1) Start LibeOffice2) Open an encrypted file3) Enter password4) Crash OS5) Log into the same user account ([a] with no password [b] with the text on a note right in front of the PC)Let me phrase this way. The document has to be encrypted in RAM, as well as the password. IF someone really loves to, it will ever be possible...The bad thing about this bug is, that LibO forgets, that it is password protected....You did understand, that without YOU (or someone else) paying for this fix it might take weeks, without months???What has to be changed:1) Save recovery file with password ("", if not specified)2) After crash, try to open it with "" pw (ask for password otherwise) [for every opened document]Quoting chromium source: "Be wary of surveillance by secret agents or people standing behind you."Anyway, any code pointers. I found these:I am not a dev, neither do I have spare time to help more.... (Yes, we are doing this for free)Maybe this is the routine:It says that "if the document was loaded with a password, it should be stored with password" and also seems to set the password, but something not OK with it.Maybe a quick debugging would show what is really missing.removing regression keyword as nothing in the comments suggest it is one.Bjoern - haven't verified butsays something about a version workingThere are also a number of differences in the code paths used between save and autosave that create a number of problems; not least with image and macro loss/corruption in some circumstances that have been there ~forever and need unwinding =)Confirming regression.Initial test with LO 3.3.4 Mac OSXCreate Writer documentType some textSave with passwordSet preferences to autosave every 1 minuteKeep typing more textAfter 1.5 minutes, force kill LO 334Restart LO 334, autorecovery proposes to recover document and asks for password.Save and close document and LO.Start LO 3.5.7Load file.Enter passwordCheck autorecovery settings to same as for LO 334Enter some more text, wait 1.5 minForce kill appRestart LO 357, autorecovery proposes to recover document but does not ask for password. Document recovered without password.Upon new save after further data entry, no password is requested.Save, close document and LO.Regression.(In reply to)As does, where Cor had already confirmed that it worked in 3.3.4 and not 3.4.6.@- one really simple thing you can do to help us narrow down is figure out exactly what version the bug came into the code.To do this:Just go through and download/install/test. Let us know at what point it breaks. Apparently it is between 3.3.4 & 3.4.6 (test pre-releases and releases). This way we can at least get a smaller chunk of code to investigate(sorry aboyt removing the regression keyword -- I only checked comments up to the point in time when it was added, no later comments).(In reply to)OK, so the results are:Version Branch Date Bug3.3.4.1 3.3 2011-08-04 -3.4.0.1 3.4 2011-05-19 -3.4.1.3 3.4 2011-06-27 -3.4.2.3 3.4 2011-07-26 X3.4.3.2 3.4 2011-08-25 XSo it seems to slip in somewhere between 3.4.1 and 3.4.2 (and not 3.4.6)(If I can help more just let me know)Here you can get even closer (via FTP) HTTP Link does not work:Try to download a version, which is quite in the middle of the range you want to know of....3.4.1.3-3.4.2.3I would start with 3.4.2-rc1, because there are the most # of changes...(In reply to)OK, the updated results:Version Date Bug?3.4.1.3 2011-06-27 -3.4.2.1 2011-07-14 X3.4.2.2 2011-07-21 X3.4.2.3 2011-07-26 XSo it was already in 3.4.2.1Have found this commit in this range:Maybe some significance?Thanks for investing some time into helping us narrow down when and possibly how this bug came about. I've pinged Markus about it to see what he thinkspossibly related: fdo#37825/fdo#38561.Some more info:AOO had the same bug as(or):Its patch was then cherry picked into LibO:And now AOO has also the same bug as this one:Just an idea:if PROP_ENCRYPTIONDATA would also be put into lNewArgs in this routine (as from the original document it will be cleared later in preDoSaveAs_Impl):... it would maybe solve the problem?(unfortunately cannot try myself...)A quick recap on the foregoing (for future reference):* we know now, what made this security issue appear: see,* we have a (possible) solution to fix it: see* the necessary changes seem to be fairly simple: 3-4 new lines to add into one file, mostly copy&paste (see)* we are waiting for a developer who has some free hours to actually make the changes, test it and (hopefully) commit itSo it seems that we users cannot help more to get this issue solved at long last (if yes, let us know).Just stubled in, here.My system isn't that fast so test-compiling would last quite long ...But if one of the maintainers could check out if maybe this could work - modified lines according to mentioned3233 // if the document was loaded with a password, it should be 3234 // stored with password 3235 utl::MediaDescriptor lNewArgs; 3236 OUString sPassword = lOldArgs.getUnpackedValueOrDefault(utl::MediaDescriptor::PROP_PASSWORD(), OUString()); 3237 if (!sPassword.isEmpty())- 3238 lNewArgs[utl::MediaDescriptor::PROP_PASSWORD()] <<= sPassword;- 3239 + 3238 {+ 3239 lNewArgs[utl::MediaDescriptor::PROP_PASSWORD()] <<= sPassword;+ 3240 OUString sEncryptionData = lOldArgs.getUnpackedValueOrDefault(utl::MediaDescriptor::PROP_ENCRYPTIONDATA(), OUString());+ 3241 lNewArgs[utl::MediaDescriptor::PROP_ENCRYPTIONDATA()] <<= sEncryptionData;+ 3242 }+ 3243I added this to 4.1 MAB.Has anyone tested this with the 4.2 branch? I assume nothing changed but it would be good to know for sure.So I tried to reproduce this in (In reply to)I tried to reproduce this in 4.1.4.2.Created document, typed, saved with password. Typed more into document and crashed LO. Re-opened the document and started the recovery. Was immediately asked for password. I will continue to "stress test" this, but it doesn't seem to be present in this build.(In reply to)The problem here is that sPassword is empty.So, no, it does not work.One would need to investigate why it's empty.(In reply to)SID_PASSWORD, PROP_PASSWORD are deprecated and don't work in most cases. That there are still a few users out there is unfortunate and this bug was introduced with the m106.This code needs to be converted to use SID_ENCRYPTIONDATA which is used all over the place now and is the one making it possible to use the new encryption algorithms.However debugging how to fix this special issue would take a while. I did it in the past for 3.4 and 3.5 to fix most of the m106 regressions but don't have time right now to look into this.git grep SID_ENCRYPTIONDATA should give enough code pointers that show how this should be done and after that it is a good bit of debugging to follow the property though the different XPropertySetsSecurity issues need special handling and absolute priority. Having bugs like this existing for more than one sub version is poor practice. Surely they should be blockers for the next version? Having one active like this one for more than 18 months is IMHO absolutely unacceptable. Do I need to escalate to one of the discussion lists? It seems crucial for an acceptable product that users can be confident that security issues are being handled quickly and with the highest priority.Hi Mike,Genuine security issues do; rest assured. However - volunteering other people's priority and focus is not something you can do. Since the issue is particularly important to you - can you expand on what you're doing to solve this (apparently unacceptable to you) situation ? escalation is unlikely to solve the problem - it has already been assessed by the security team & determined insufficiently serious.As/when there is a patch, we can perhaps move here.User should be confident that we take security issues seriously. However, the level of shrillness and noise around this issue has (at least for me) radically reduced my interest in doing any work to tackle it: it is not acceptable to harass developers. Having said that, very happy to mentor anyone wanting to contribute constructively here. I hope that re-assures you.All the best.@VolkerTwer @Matúš Kukan @Markus MohrhardThanks for taking time for this issue!It seems we are only a small step away from a working patch!Unfortunately I cannot create one, but I think sg like this would be necessary:InsideOUString sPassword = lOldArgs.getUnpackedValueOrDefault(utl::MediaDescriptor::PROP_PASSWORD(), OUString());if (!sPassword.isEmpty()) lNewArgs[utl::MediaDescriptor::PROP_PASSWORD()] <<= sPassword;+ css::uno::Sequence< css::beans::NamedValue > aEncryptionData = getUnpackedValueOrDefault(utl::MediaDescriptor::PROP_ENCRYPTIONDATA(), css::uno::Sequence< css::beans::NamedValue >() );+ if (aEncryptionData.getLength() > 0)+ lNewArgs[utl::MediaDescriptor::PROP_ENCRYPTIONDATA()] <<= aEncryptionData;So PROP_ENCRYPTIONDATA would be put into lNewArgs too, when needed.IMHO this issue in LibO was introduced this way:1. m106 was merged, and LibO started to use PROP_ENCRYPTIONDATA. At that time the recovery was working without problems, butwas introduced.2.was fixed with these commits:(BTW SID_ENCRYPTIONDATA is cleared twice now due to the two different commits)The first commit introduced this issue, as now ENCRYPTIONDATA is cleared in PreDoSaveAs_Impl from the original document, and it is not put into the property set inside implts_saveOneDoc.So I think the solution could be to put this into the set too.@chtfn @Ryan DunlopHi, I just tried these versions, all of them seem to have the bug too (so it is in the 4.2 branch too):Version Date Bug?4.1.4.2 2013-12-12 X4.1.5.3 2014-02-07 X4.2.0.4 2014-01-29 X4.2.1.1 2014-02-14 X4.2.2.1 2014-02-28 X(The backup file was always unencrypted and for the recovering no password was needed.)@mike.hallHi, I already tried to inform the security team about this issue (although maybe not with the best methods), interestingly they did not find it important enough (perhaps Michael pulled some strings there too?), so it seems, that we must try to solve this issue on our own somehow...@Michael MeeksSorry, but I would be really eager to know what _you_ personally did to solve this issue since you took notice of it (besides maybe playing down its importance, effectively blocking it inside the dev team and forcing your own personal lower standards of security on the whole user base)?Hi Sayt, So - first, I am encouraged by your attempt to provide a patch and to discuss the code: that is to be applauded - if there is a real patch to test, and people are actively engaging with the code trying to contribute and understand what is wrong and help out that is -awesome- and I appreciate it. I'm personally interested in helping mentor such people, there is no shortage quite simple problems that just need a bit of research to fix in LibreOffice, and it'd be great to have help with them.Ah - so perhaps I was the only one that bothered to reply to you =)I reproduce those in order not to comment on them :-) I basically like your challenge; it is a reflection of mine - if you want something done, -you- need to do it =) Ask not what LibreOffice can do for you etc. ... In this case I'm privileged to have Matus work for me, and (as I was encouraged by Volker's patch) I asked him to take a look at / review / test it.In terms of personal contribution here, my hope is to provide some context, and de-escalation =) All the best.Great to hear, that Matúš is working on it "officially"! (really did not get it until now)If I can help in anything (testing, etc.) just let me know! (except compiling for which sadly my current machine is way too old - maybe after getting a newer one somehow...)BTW I find your strategy really great (and practical) to try to get the users involved into the community and the developing process through the issues important for them.Just a small remark: security issues may not be the ideal candidates for this purpose, maybe they need a bit more special handling (quicker response, more focus from experienced developers, etc.)But I personally really enjoyed browsing the code through the web interface and trying to spot the problem, and surely will try to do this for other issues too, so the strategy definitely functions :-)Thanks for working on this issue! (and sorry for the "shrillness")I think you're missing the point that our developers are almost all volunteers - so telling them what to do is impossible and disrespectful of their time. This really isn't the security concern you've made it seem to be. You tried going to the user list and multiple users (some of our experienced users) commented and none agreed with you. Furthermore, we pointed out that the real solution is encrypting a hard drive - we can't be responsible for users not knowing how to really secure their data. Lastly - commenting over and over again on the bug just makes the bug less useful as it just clogs the bug with comments that don't really say much other than "this is important TO ME" - and like I said - you tried getting other users to agree and none did on the list (there are thousands on that list by the way).To say the least this wasn't the ideal way to push this bug - if a bug is a high priority for you - pay for a fix, or learn how to code. Else, asking us to develop processes to force volunteers to work on a bug is very unlikely to happen.Rest assured for real security bugs you likely would have gotten more positive response from the community (users, devs, QA, etc . . .). If you actually want to contribute and become one of the thousands of volunteers putting in hours of time for free - get in touch, I have plenty of non code related tasks that need done and you can see how it can become irksome when users push for you to dedicate your time in ways that you don't find to be the most productive use of time(In reply to)Just to clarify something here. Let us not call this issue a security issue. It is maybe a privacy issue if you want to give this bug a special name. Accusing us of not caring or not caring enough about security issues is not winning much friends. As Michael already mentioned earlier it has been analyzed by the security team in the past and been classified as normal bug or if you want to call it like that, "privacy" issue.I hope that it makes a bit clearer why this bug has not seen the attention that you would have preferred. There will always be bugs where users and developers have different expectations but it would be nice to not accuse us of not caring enough.Thanks a lot for working on a fix. As you hopefully see it is much more productive to look at an issue yourself than trying to force other people to fix your bugs.As you might have seen if you participate in fixing a bug we'll assist you bug just asking other people to fix it does not work.Your patch looks correct if it works. If it still does not work you would need to debug it a bit and see where we either expect a SID_PASSWORD or somehow still clear the SID_ENCRYPTIONDATA.If you are intersted in these kind of tasks you can try to remove the remaining SID_PASSWORD which might hide a few more similar problems.@Joel MaderoThanks, got the lesson, Mr. QA!Just please take a look on this issue, what you (QA) and what we (users) did to get this issue solved.QA: suggesting to download and install the old versions (which in fact was a good idea), but not really more, not even accepted the Hard Hack.Users: we found the routine, where (with high probability) the problem is, worked out patches, found the first version for the problem, etc.Yes, I was a bit (too) pushy, but without this IMHO we were nowhere near now. You had 1,5 years to solve this issue on your own agenda, which brought what: literally nothing!I really do not understand your attitude toward users trying to patch a security (!) regression (!): you are handling us as we were some criminals, etc. Instead of being glad to have such responsible users who are BTW doing your duties (the QA or an automated test should catch such security regressions even before publishing).Don't worry, I will not comment on this bug anymore, or on any other one.(In reply to)Indeed, great analysis etc, I've tried your patch and it works!Great catch!I think you would like to contribute your patch ?Can you create it with help ofor just give me your name & e-mail adrress and I will create it for you.And we would need your license statement too as described inAdd yourself to the developers list there or we will do it for you after the license statement.Thanks a lot for helping LibreOffice by filling bugs and also helping to fix them!MatuÅ¡ Kukan committed a patch related to this issue.It has been pushed to "master":fdo#51819: autorecovery: fix saving password in protected documents.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Dear allCan I ask why this fix is not integrated into 4.1 and 4.2?Because it needs additional testing to make it into 4.2 - I believe 4.1 is nearing EOL so making it into that branch might be a bit harder but I could be wrong.It's in gerrit for 4.2:needs one developer / reviewer and some testing I guess; I'd be happy to see people playing with autosave some across many components before shipping it personally. Luckily testing is something anyone can do with master builds for each component - it'd be great to get user feedback on setting a v. short (1 minute?) autosave time and doing some live editing of odt/odp/ods, doc/xls/xlsx etc. and seeing how it behaves.MatuÅ¡ Kukan committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#51819: autorecovery: fix saving password in protected documents.It will be available in LibreOffice 4.2.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.MatuÅ¡ Kukan committed a patch related to this issue.It has been pushed to "libreoffice-4-1":fdo#51819: autorecovery: fix saving password in protected documents.It will be available in LibreOffice 4.1.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.MatuÅ¡ Kukan committed a patch related to this issue.It has been pushed to "libreoffice-4-2-3":fdo#51819: autorecovery: fix saving password in protected documents.It will be available already in LibreOffice 4.2.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=52392	CreatedScreenshoot with the symbols that appear, and how it's seen in the bibliographic index.Problem description: When you create a new entry in the Bibliographic database, the fields that you don't fill are autofilled with a buggy triangle symbol.Then, if you add a bibliographic entry from the database to the document, and you have an index, the symbols are shown.Appears in both 3.5.5.3 and 3.5.5.2.Steps to reproduce:1. From Tools -> Bibliographic database, create a new bibliographic entry filling only the Identifier and for example the Type.2. Click on another entry or close the database navigator.Current behavior:The newly created one will be filled by symbols where there were no data.Inserting into the document a reference to this new entry and updating a default Bibliographic Index will make appear these symbols into the index.It does not happen when adding a new bibliography entry internally to the document and not to the database.You can try to delete the "auto-filled" fields in the database, but it's difficult, you have to do from the leftiest cell to rightest, otherwise it gets filled another time.Expected behavior:Not to fill up the empty fields with symbols.Platform (if different from the browser): Browser: Mozilla/5.0 (X11; Linux x86_64; rv:12.0) Gecko/20100101 Firefox/12.0 Iceweasel/12.0 Bug also present in newer versions 3.6.x.This doesn't occur on 3.5.4.2, where a new bibliography entry created via the Table view inserts no strange characters. I will try and reproduce on later versions to confirm.I seem to recall that this was already reported somewhere, but don't know if it got fixed.AlexConfirming in 3.6.3 rc1I note however, that the problem seems to have been created by entries made with 3.5.4 or earlier, because the new entry I made in 3.5.4.2 shows up in 3.6.3rc1 with garbled data in the fields which displayed as empty in 3.5.4.2.AlexNominating for MAB, only problem is that 3.5 branch will no longer be maintained after 3.5.7 and this most probably won't be fixed for that release (which is at rc2 pending final release). This means that it will go into the 3.6.x MAB list, sigh and who knows when that will get dealt with.AlexAdding Cedric and Andras to CC.Any chance of taking a look ? Looks like something got screwed up when the bibliography database was updated in source.AlexResetting to earliest version identified as problem showing up ==> 3.5.5.3AlexThis is also a regression on 3.5.4.2 where the problem does not show up (although the garbled data entry seems to have been inserted nonetheless, see).AlexReproduced in base (open file LibOPRofile/database/biblio.odb) in my 3.6 dev tree.Seems to do that only on VARCHAR fields, not on LONGVARCHAR fields.OK, the problem is that when writing out a NULL value (a concept that the DBF file format does not support), the field in the DBF file is written as all null characters ('\0') instead of blanks ('\0x20'). It should be blanks.This happens in connectivity/source/drivers/dbase/DTable.cxx, function connectivity::dbase::ODbaseTable::UpdateBuffer, line 1826: // If the variable is bound at all? if ( !rRow.get()[nPos]->isBound() ) { // No - the next field. nByteOffset += nLen; continue; }Basically, this function makes a distinction between NULL and "not bound". This distinction is bogus in case of a new row insertion, and an unset value should be treated as a NULL is treated (that is, write out an empty string).But in the case of a row _update_, it makes sense not to touch fields that are not set (they should not be changed!).So either we parametrise UpdateBuffer to make the distinction or not, or InsertRow sets all unbound fields to NULL.I'll fix it. Taking bug.Fixed in my development treeLionel Elie Mamane committed a patch related to this issue.It has been pushed to "master":fdo#52392 dbase: correctly NULL out non-filled in fields in inserted rowsThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Lionel Elie Mamane committed a patch related to this issue.It has been pushed to "libreoffice-3-6":fdo#52392 dbase: correctly NULL out non-filled in fields in inserted rowsIt will be available in LibreOffice 3.6.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=52434	CreatedSpreadsheet created in LO prior to ver. 3.6 RC2Row heights are all messed up when spreadsheets created prior to LO 3.6 RC1 are opened. I made adjustments by restoring the row height to the original state and saved it, but when it is reopened the row height is reverted to the incorrect setting. For example, the attachment's row height is set at 0.50cm yet the spreadsheet forcibly sets it at 0.82cm. Clearly, this version is not even close to a release candidate. 'RC1' -> 'RC2' On the first line.Duplicate of?BTW, this bug make Calc 3.6 completely unusable...CreatedOther Sample DocumentNow I am really really worried: reporter's sample looks perfect for me with Server Installation of "LibreOffice 3.6.0.2 rc German UI/Locale [Build-ID: 815c576] on German WIN7 Home Premium (64bit) , but I still see problem with attached "Other Sample Document" and 3.6.0.21) Open Calc a with new document2) Type "test" in A13) Resize row 1 simply by dragging4) Save the new document5) ReopenAccording to my archives, files created on February 15, 2012 opens with correct row heights, while the files created on March 8, 2012 reproduces the error. It may not be the version issue but I thought this may help in the investigation.Nevermind. I see partial row height problems from February files. Strangely, only some rows have changed its heights instead of all rows with uniform height.The question is: did anybody reproduce any problem here? "Not Properly" is a rather poor description, I do not understand the problem at all.Row 3 of attachment "Spreadsheet created in LO prior to ver. 3.6 RC2" has height 8.03 mm with Server Installation of "LibreOffice 3.6.0.2 rc German UI/Locale [Build-ID: 815c576] on German WIN7 Home Premium (64bit) andwith "LibreOffice 3.5.5.3. German UI/Locale [Build-ID: 7122e39-92ed229-498d286-15e43b4-d70da21] on German WIN7 Home Premium (64bit) @Josh KimAre you sure that you attached a document with row height?Unfortunately important information is missing.May be hints on <> will help you to find out what information will be useful to reproduce your problem? If you believe that that is really sophisticated please as for Help on a user mailing listPlease:- Write a meaningful Summary describing exactly what the problem is.- Attach a sample document (not only screenshot) or refer to an existing sample document in an other Bug with a link; to attach a file to this bug report, just click on "Add an attachment" right on this page. It would be useless to attach a document saved from 3.6.0.2, we need the version saved from 3.5.5 (or similar) showing correct hight for row 3 (5.0mm?) with 3.5.5- Attach screenshots with comments if you believe that that might explain the problem better than a text comment. Best way is to insert your screenshots into a DRAW document and to add comments that explain what you want to show- Contribute a document related step by step instruction containing every key press and every mouse click how to reproduce your problem (similar to example in)– if possible contribute an instruction how to create a sample document from the scratch- add information -- what EXACTLY is unexpected (Open document with 3.5 shows .... open document with 3.6.0.2 shows ...) find out whether it's a FILESAVE or a FILEOPEN problem -- how you launch LibO and how you opened the sample document @vitriol:Were you able to detect any problem with reporter's sample?(In reply to)No, I can't see the problem opening the attached sample document, but also I can't view any change applied to original height.The changes seem saved because are visible if the document is opened with version 3.5.xCreatedMy sample was misleading as the document was saved with the new row height (0.82cm) instead of the original (0.5cm). I reverted to LO 3.5.5. and attached the original sample which displayed different row height in LO 3.6.0.2.Comment onMy sample was misleading as the document was saved with the new row height (0.82cm) instead of the original (0.5cm). I reverted to LO 3.5.5. and attached the original sample which displayed different row height in LO 3.6.0.2.I@Rainer BielefeldSorry if I missed a lot of details. Basically, I opened the document (the same one in the latest attachment) simply by double-clicking the file from the explorer and LO 3.6.0.2 displayed the row height (0.82cm) different from the original setting (0.5cm). The reason why the initial attachment did not show any flaw was due to my fault of deleting the confidential information from the document and saving it with the new row height information (and I apologize for the confusion). The new attachment is saved in the latest LO 3.5.5.3 and due to the reversion to the stable release, I do not have LO 3.6.0.2 to test out the symptom since I am unable to perform parallel installations of the two versions. Please advise if the attachment displays the symptom, otherwise I would have to revert to 3.6.0.2 to reproduce the error.With reporters New sample I see the problem as per "- FORMATTING: FILEOPEN reverts Row Height to optimum", what has been marked as DUP of.My observation is that 3.6.0.2 does not open with exact optimum row height shown when opened with 3.5.5, but with row height very close nearby that value (here: 3.6.0.2 opens with row height 8.08 mm, 3.5.5 indicates8.03 mm as optimumSo DUP for now.@Josh KimThank you for additional information!Please feel free to reopen this Bug if you find evidence that we have an independent issue here (for example: your problem still exists after Fix for.*** This bug has been marked as a duplicate of***
id=52433	here is a writer-memory-eater-file (10 Mb) that lead to crash . each time i save, it eats memory (some hundreds of Mb) without giving it back. after some save cycles, Libro crashes due to memory exhaustion on winXP this is related to images included in the file. removing the images, problem disappears. The images come from impress slides copy-pastereproduced on 3.5.5 (winxp & linux) and 3.7-master (linux) file too large for attachmentyou can download it hereReproducible under Linux x86_64 (Ubuntu 11.10) with LO 3.5.5.3 and LO 3.6.1.0+ (Build ID: 10ae81a)No crash for me but obviously memory leak. The only mean to recover the RAM is to close LO. Closing the file does not release the RAM.Best regards. JBFNOT reproduced in libro3.3.2 linuxafter a first raise, memory globally remains stable over modify/saving cycles***has been marked as a duplicate of this bug. ***here are more tests regarding older versions, on winXP (VM)3.4.6rc2 --> OK, no problem, the memory is not eaten3.5.0rc1 --> PROBLEM, the memory is eaten at each "save file"Regression does appear in oldest version of bibisect-3.5.tar.lzma and must be olderunder Linux x86_64 (Ubuntu 12.04)LibrO 3.4.6.2 --> memory is eaten !!! (so,seems only applying on winXP ???)NOT repoducible on Windows 7 x64 SP1 with Version 3.6.1.2 (Build ID: e29a214)I have a small .odt file, less than 40 kB. In it, however, I embed 50 or so 10 megapixel jpegs as LINK. For each image there is a table. The image is inside a table cell. Each table has its own frame.When I save that file, or when autosave runs, or when I export it to pdf, writer crashes. In process explorer I can see that prior to the crash it touches all the images. Writers working set goes up continually and eventually, above 1.5GB, writer crashes. For each image writer uses about 25MB when saving, about 5MB prior to saving and about 140MB with the text file only. With 50 images this leads to 140+50*(25+5)=1.64GB.I run Windows XP and, as 32 bit system, it does not like this. 64 bit systems may not be affected.Even it there is no chrash, the saving times are annoying.If the working set does not reach 1.5GB, the memory is sometimes given back, sometimes not, depending on the odt file used.I have reports that OO3.0 leaves the image files alone, as it should. And saves are fast as they should when only links are used.[Reproducible] with Server installation (own profile) of "LibreOffice 3.5.6.2 German UI/Locale [Build-ID: e0fbe70-5879838-a0745b0-0cd1158-638b327] on German WIN7 Home Premium (64bit) [Reproducible] with Server installation of Master "LibO-dev 3.5.0 – WIN7 Home Premium (64bit) English UI [(Build ID:d337f79-a24c961-2865670-9752b71-7f8fd43 2fdd60d-fd28b6a-fd7bf20-aa369cb-28da3fb 6a9633a-931d089-ecd263f-c9b55e9-b31b807 82ff335-599f7e9-bc6a545-1926fdf)]" from (July 2011)Each 'Save - as' under new name increases memory consumption of soffice.bin additional 400MB (or so), when required memory becomes bigger than 1.5GB LibO Crashes on my PCI will nominate this one as HardHack on <>[Reproducible] with LibreOffice 3.5.7 on Ubuntu 12.04 32 bits; at each save, memory increase (after having saved, memory used is larger than before saving) but no crash.[Reproducible] with LibreOffice 3.5.7 on Windows 7 Home Premium 64 bits; at each save, memory increase, crash of LibreOffice when memory used by soffice.bin over 1.5 GBytes.[Reproducible] with LibreOffice 3.6.3 on Windows 7 Home Premium 64 bits; at each save, memory increase, crash of LibreOffice when memory used by soffice.bin is over 1.5 GBytes.Bug was not existing with LibreOffice 3.4.6 on Windows 7 Home Premium 64 bits; bug doesn't exist with Apache OpenOffice 3.4.1 on Windows 7 Home Premium 64 bits.It seems related to a recent regression, appeared in LibreOffice 3.5.xOh no - this is a disasterous image management is utterly shambolic issue.Checkout- this is a really nasty issue that will take several man weeks to fix properly - a very very hard hack sadly.No doubt it could be 'fixed' in a trivial way - but that would risk loosing images shared with other documents I suspect.It seems there are two problems:- a bad and buggy images management inherited from OpenOffice and StarOffice that would probably require weeks of man work to be fixed.- this bug, a memory leak that appears when you save a file with images from writer; this bug is NOT inherited from OpenOffice and has appeared in LibreOffice 3.5.1, and is present on any version of LibreOffice 3.5 and 3.6, and was not in 3.4.x.Solving this bug could be probably done by analyzing what changes have been done in the images management between LibreOffice 3.4.6 and 3.5.1, identifying the regression, and correct the bug.This might not take weeks.Note that for several users, like me, LibreOffice is no longer usable (I have switched to Apache OpenOffice, waiting for this bug to be corrected).For 3.6.2.2 on Windows XP and a quite small odt file containing large images as embedded links, 1. I cannot confirm a memory leak when saving, the memory comes back, sometimes it takes a while2. I can confirm a crash when saving with lots of images as the memory goes beyond 1,5 GB. Writer opens all the images in succession and does not seem to close them and giving back the memory before opening further (as seen in Process Explorer). Same when exporting to pdf.So there may be two unrelated problems. As to the second one: writer shouldn't even touch the images when saving as odt. Hard to imagine that this is hard to fix. Any hint as to a similar bug or should I file this as a new one?@taestom<>Please do not touch the dashboard ;-)Hello,I have tested version 3.6.4 with Windows 7 SP1, and bug is still there.Moving this to 3.6 MAB because 3.5 is at the of its cycle and we will be closing the meta tracker for 3.5 MAB.++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++Confirmed On:Version 4.1.0.0.alpha0+ (Build ID: 871712ad62bb01359c29713a148a5673e26df1a)Bodhi LinuxIs it possible that the memory leak in the example file () is related to the use of StarView Metafile (SVM) graphics (88 of the 89 included pictures)? The sample also includes MS Word text styles e.g., in styles.xml there are entries like:<style:style style:name="WW-Titre1234567891011121314151617181920212223242526272829303132333435363738" style:family="paragraph"><style:style style:name="WW8Num5z0" style:family="paragraph">A cleaner test file might narrow down the source of the problem.(In reply to)Hello,I can see the memory leak with a writer file with jpeg pictures (several tens), and no SVM one. Regards.Hello,The bug persists on LibreOffice 4.0.3 on Windows 7 Pro x64 and Ubuntu 13.04.Is there any workaround or alternative to get around this bug? I can't use my odt files.(In reply to)Hello,There are very few workarounds:- to shut down LibreOffice periodically to recover the RAM,before Writer crashes,- to use some system util programs to periodically recover RAM (there are some available for Windows),- to use OpenOffice while the bug is not corrected in LibreOffice (it is what I did, I switched to OpenOffice 3.4.1; when saving a writer file with images the RAM used by soffice increases considerably, like in LibreOffice, but unlike in LibreOffice there is no memory leak: after having saved the file the amount of RAM used by soffice goes back to the initial value).Regards,M. Nallino(In reply to)Here is a detailed workaround in order to free RAM on Windows:Download "sysinternals utilities" suite from Microsoft download site.Use "RAMMap.exe" jointly with LibreOffice (keep RAMMap running).After each file save, in RAMMap go to "Empty" menu, click on "Empty Working Sets". This forces LibreOffice to release its memory ("soffice.bin" used RAM goes down to 20 MB after an "Empty Working Sets").M. NallinoThanks for the replies, I'll try that, but that's just half of the problem. The other half is that the memory comspumtion skyrockets on saving files with lot of images, is there a workaround for this? or is this another bug?(In reply to)Hello,Unfortunately there are two distinct problems:- OpenOffice up to 3.4.1 or LibreOffice up to 3.4.6 have a very bad management of images: you may copy / paste them in Writer, or just add an html link, but in all cases, when you save your file, the RAM used by the process "soffice" reaches very high values (I have a file with 127 images and, when I save it, the RAM used by soffice reaches some 1.4GB!).- LibreOffice, all 3.5.x, 3.6.x, 4.0.x versions, has another problem: one part of the amount of the RAM is not released after having saved; next time, RAM will increase from an higher bottom value and will reach an higher maximum value, and some part will not be released, and so on; after a few saves, Writer will crash.There is no workaround for the 1st problem (high RAM consumption), you just need to have a lot of RAM in your computer to avoid an extensive use of page swapping (that slows down your computer). I have used OpenOffice and LibreOffice on computers having just 1GB RAM, I have just to say that you have time to do plenty of things when Writer is in save mode. (Now my computer has 16GB of RAM, and it is no longer a problem!)For the memory leak, workarounds are to use OpenOffice 3.4.1, or LibreOffice 3.4.6, or, if you still want / need to use more recent versions of LibreOffice to free the RAM periodically by shutting down LibreOffice or by using an external memory management program.I still don't know when / if this bug will be corrected in LibreOffice, and I just hope that the bug will not appear in the next announced release of OpenOffice, the 4.0 (it might be there, if it is a library related bug, with a new release using an updated set of libraries).In that case, I would stay with OpenOffice 3.4.1 or even switch to MS Office 2013 ;-)!Of course, I would be very glad to use a reliable version of LibreOffice 3.6.x or 4.0.x, since it offers lots of functions, but, at this time, I can't.Best regards,M. Nallinonot sure why regression isn't on this one:says it worked in 3.4 and is broken in 3.5, adding regression because of this.Well this bug is quite extreme. I had assumed that if people genuinely wanted a fix - they might help out development by providing a leak trace from eg. valgrind. That takes a few minutes to run - and makes our life -incredibly- easier. If there was a trace on this bug months ago when I first saw it - I would have done some development work on it ( JFYI ).Here is how to build that - I would appreciate it if this ended up on some QA page:valgrind --leak-check=full --show-reachable=yes --num-callers=50 ./soffice.bin /opt/libreoffice/tmp/CR_CM_120625.odt 2>&1 | tee /tmp/val-leak.txtThen attach /tmp/val-leak.txt for analysis. The app runs 80x slower - this is a pain in the backside - but it's just as much of a pain for me as you :-)Createdlarge memory leakAs expected it is the hideous horror of the image cache, and the horrible UNO mess around it, and the lack of sane lifecycle management, caching, well - anything really around images. The big trace is:==13133== 205,217,708 bytes in 141 blocks are possibly lost in loss record 9,694 of 9,694==13133== at 0x402ACB9: operator new[](unsigned int) (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)==13133== by 0x9C84DC9: X11SalBitmap::Create(Size const&, unsigned short, BitmapPalette const&) (salbmp.cxx:701)==13133== by 0x52AD0F3: ImpBitmap::ImplCreate(Size const&, unsigned short, BitmapPalette const&) (impbmp.cxx:58)==13133== by 0x527D764: Bitmap::Bitmap(Size const&, unsigned short, BitmapPalette const*) (bitmap.cxx:125)==13133== by 0x526F497: Bitmap::ImplReadDIB(SvStream&, Bitmap&, unsigned long, unsigned char) (bitmap2.cxx:147)==13133== by 0x526F9EC: Bitmap::Read(SvStream&, unsigned char, unsigned char) (bitmap2.cxx:119)==13133== by 0x526FA5D: operator>>(SvStream&, Bitmap&) (bitmap2.cxx:94)==13133== by 0x52BE8D2: MetaBmpScaleAction::Read(SvStream&, ImplMetaReadData*) (metaact.cxx:1858)==13133== by 0x52C67DA: MetaAction::ReadMetaAction(SvStream&, ImplMetaReadData*) (metaact.cxx:227)==13133== by 0x529F4AB: operator>>(SvStream&, GDIMetaFile&) (gdimtf.cxx:2770)==13133== by 0x52B0528: operator>>(SvStream&, ImpGraphic&) (impgraph.cxx:1686)==13133== by 0x52A8511: operator>>(SvStream&, Graphic&) (graph.cxx:577)==13133== by 0x5234AEA: GraphicFilter::ImportGraphic(Graphic&, String const&, SvStream&, unsigned short, unsigned short*, unsigned long, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue>*, WMF_EXTERNALHEADER*) (graphicfilter.cxx:1560)==13133== by 0x5234C76: GraphicFilter::ImportGraphic(Graphic&, String const&, SvStream&, unsigned short, unsigned short*, unsigned long, WMF_EXTERNALHEADER*) (graphicfilter.cxx:1326)==13133== by 0x11F955B8: SwGrfNode::ImportGraphic(SvStream&) (ndgrf.cxx:452)==13133== by 0x11F96983: SwGrfNode::SwapGraphic(GraphicObject*) (ndgrf.cxx:1014)==13133== by 0x11F96A86: SwGrfNode::LinkStubSwapGraphic(void*, void*) (ndgrf.cxx:967)==13133== by 0x4BC827C: GraphicObject::GetSwapStream() const (link.hxx:123)==13133== by 0x4BC8CD0: GraphicObject::ImplAutoSwapIn() (grfmgr.cxx:203)==13133== by 0x4BC9450: GraphicObject::GetGraphic() const (grfmgr.cxx:732)==13133== by 0x11F953C4: SwGrfNode::onGraphicChanged() (ndgrf.hxx:131)==13133== by 0x11E65EE0: SwDoc::Insert(SwPaM const&, GraphicObject const&, SfxItemSet const*, SfxItemSet const*, SwFrmFmt*) (doc.cxx:1059)==13133== by 0x1211B955: SwXFrame::attachToRange(com::sun::star::uno::Reference<com::sun::star::text::XTextRange> const&) (unoframe.cxx:2281)==13133== by 0x1211CCE6: SwXFrame::attach(com::sun::star::uno::Reference<com::sun::star::text::XTextRange> const&) (unoframe.cxx:2469)==13133== by 0x1219198A: SwXText::insertTextContent(com::sun::star::uno::Reference<com::sun::star::text::XTextRange> const&, com::sun::star::uno::Reference<com::sun::star::text::XTextContent> const&, unsigned char) (unotext.cxx:617)==13133== by 0x10AC7ADB: XMLTextImportHelper::InsertTextContent(com::sun::star::uno::Reference<com::sun::star::text::XTextContent>&) (txtimp.cxx:1170)==13133== by 0x10AA5168: XMLTextFrameContext_Impl::Create(unsigned char) (XMLTextFrameContext.cxx:743)==13133== by 0x10AA69DC: XMLTextFrameContext_Impl::XMLTextFrameContext_Impl(SvXMLImport&, unsigned short, rtl::OUString const&, com::sun::star::uno::Reference<com::sun::star::xml::sax::XAttributeList> const&, com::sun::star::text::TextContentAnchorType, unsigned short, com::sun::star::uno::Reference<com::sun::star::xml::sax::XAttributeList> const&) (XMLTextFrameContext.cxx:1089)==13133== by 0x10AA6CFF: XMLTextFrameContext::CreateChildContext(unsigned short, rtl::OUString const&, com::sun::star::uno::Reference<com::sun::star::xml::sax::XAttributeList> const&) (XMLTextFrameContext.cxx:1507)==13133== by 0x109A74EE: SvXMLImport::startElement(rtl::OUString const&, com::sun::star::uno::Reference<com::sun::star::xml::sax::XAttributeList> const&) (xmlimp.cxx:682)==13133== by 0x10BE60F6: sax_expatwrap::SaxExpatParser_Impl::callbackStartElement(void*, char const*, char const**) (sax_expat.cxx:827)==13133== by 0x10BF14FD: doContent (xmlparse.c:2469)==13133== by 0x10BF1C04: contentProcessor (xmlparse.c:2105)==13133== by 0x10BF31FB: XML_ParseBuffer (xmlparse.c:1651)==13133== by 0x10BE67B6: sax_expatwrap::SaxExpatParser_Impl::parse() (sax_expat.cxx:765)==13133== by 0x10BE759E: sax_expatwrap::SaxExpatParser::parseStream(com::sun::star::xml::sax::InputSource const&) (sax_expat.cxx:553)==13133== by 0x1222D746: ReadThroughComponent(com::sun::star::uno::Reference<com::sun::star::io::XInputStream>, com::sun::star::uno::Reference<com::sun::star::lang::XComponent>, String const&, com::sun::star::uno::Reference<com::sun::star::uno::XComponentContext>&, char const*, com::sun::star::uno::Sequence<com::sun::star::uno::Any> const&, rtl::OUString const&, bool, bool) (swxml.cxx:182)==13133== by 0x1222DED5: ReadThroughComponent(com::sun::star::uno::Reference<com::sun::star::embed::XStorage>, com::sun::star::uno::Reference<com::sun::star::lang::XComponent>, char const*, char const*, com::sun::star::uno::Reference<com::sun::star::uno::XComponentContext>&, char const*, com::sun::star::uno::Sequence<com::sun::star::uno::Any> const&, rtl::OUString const&, bool) (swxml.cxx:372)==13133== by 0x1222FB8B: XMLReader::Read(SwDoc&, String const&, SwPaM&, String const&) (swxml.cxx:921)==13133== by 0x121ACCBC: SwReader::Read(Reader const&) (shellio.cxx:177)==13133== by 0x1226ABDD: SwDocShell::Load(SfxMedium&) (docshini.cxx:532)==13133== by 0x47F443D: SfxObjectShell::LoadOwnFormat(SfxMedium&) (objstor.cxx:3048)==13133== by 0x47FE4BA: SfxObjectShell::DoLoad(SfxMedium*) (objstor.cxx:710)==13133== by 0x481F319: SfxBaseModel::load(com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) (sfxbasemodel.cxx:1887)==13133== by 0x486A612: SfxFrameLoader_Impl::load(com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&, com::sun::star::uno::Reference<com::sun::star::frame::XFrame> const&) (frmload.cxx:597)==13133== by 0xF9F9540: framework::LoadEnv::impl_loadContent() (loadenv.cxx:1166)==13133== by 0xF9FA5CB: framework::LoadEnv::startLoading() (loadenv.cxx:400)==13133== by 0xF9B8343: framework::LoadDispatcher::impl_dispatch(com::sun::star::util::URL const&, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&, com::sun::star::uno::Reference<com::sun::star::frame::XDispatchResultListener> const&) (loaddispatcher.cxx:119)==13133== by 0xF9B86AE: framework::LoadDispatcher::dispatchWithReturnValue(com::sun::star::util::URL const&, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) (loaddispatcher.cxx:65)==13133== by 0x447B535: comphelper::SynchronousDispatch::dispatch(com::sun::star::uno::Reference<com::sun::star::uno::XInterface> const&, rtl::OUString const&, rtl::OUString const&, long, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) (synchronousdispatch.cxx:69)Which is why this bug depends on- "image caching / management is utterly shambolic."I suspect the fix for:Is related to this - but then again, I don't believe we want to loose images on autosave in order to fix this leak ;-)0389b77a3cbea09ddbae238d7934d4c6349a8d37Did I mention - that the tracker: "image management is utterly shambolic" is there to track this important task ? it needs doing, no-one has done it, and volunteers are much appreciated: there is -so- much that is really really silly about our image management including the infamous "graphics cache" that ...Hello,It seems that Apache OpenOffice 4.0 has changed the way memory is managed. I have a large file (260 MB, 387 pages, 129 jpeg pictures). When I open it with OpenOffice 3.4.1, or with LibreOffice 3.6.6 (the latest version I have tested, under Windows 7), the memory used by "soffice.bin" is some 400 MB. When I open it with AOO 4.0, the memory used is some 950 MB.When I save with AOO 3.4.1 or LO 3.6.6, memory used increases up to 1500 MB (and comes back to 400 MB with AOO 3.4.1, or 600 MB with LO 3.6.6 --> here is the memory leak).However, when I save it with AOO 4.0, the memory used constantly decreases, down to some 90 MB. With future use (write / save) of AOO 4.0 memory stays in the range 90 - 125 MB, decreasing to 90 MB at each save.It seems that there is a memory release mechanism that has been used in AOO 4.0.The result is that both peak and average memory used is lower than with AOO 3.4.1 and that there is still no memory leak, unlike with LO 3.5x and further versions.Maybe the way memory is managed by AOO 4.0 could be analysed, and used in a future release of LO?Best regards, M. NallinoCreatedWindows 7 TaskmanagerCreatedWindows 7 Ressource (monitor) [Filesave, the other was fileopen)CreatedNO Memory leak --> FILESAVEHi,So I finished testing.I got a memory leak on saving the file. When I used the format Flat ODT (fodt) I didn't get one. So this might help you and every developer trying to work on this bug.The downside for you that this needs twice the place on your hard drive....[Somehow the bug got assigned to meSorry for the mail spam, changing component@Florianwhich version did you use for your latest tests? 4.0.4, 4.1.0 or 4.2alpha?I do think master.... (Sorry, sometimes forgetting)But can you confirm the improvement using fodt..?I confirm RAM-eating from test document inusing LibO 4.0.4 on Win7 64bit.I also confirm Florian's observations regarding .fodt saving... RAM-eating does not happen with the .fodt saved test document.moving bug from mab3.6 list to mab4.0 list since 3.6.x is EOL.Creatednew valgrind traceOn pc Debian x86-64 with master sources updated yesterday, I still reproduce the problem. I attached a new valgrind trace.(This is an automated message.)Setting priority to highest as this is a 4.0 MAB. This is part of an effort to make the importance of MAB reflected in priority too.still reproducible with version 4.2.1.0.0+ under Ubuntu 13.10 x86-64Best regards. JBFI can confirm a similar problem with metafiles in LibreOffice Version: 4.1.3.2 Build ID: 410m0(Build:2) on Ubuntu 13.10.For this test I created a file with 2 pages. Page 1 is covered with an imported SVG image. Page 2 is covered with an imported emf or wmf image.When only the first page with the SVG is visible, the program works normally. On every redraw the program allocates approximately 2MB of memory which is released soon afterwards.As soon as the emf/wmf image from page 2 becomes visible, the program starts allocating approximately 2MB on every redraw and this memory is never released. This soon consumes all the available memory and hangs the system with a lot processes going into "disk sleep" state, probably because LibreOffice is swapping objects in and out of memory.If I make the wmf/emf image smaller, less memory is being lost.This is what I think is going on: to render an embedded metafile a temporary raster buffer is allocated which is never released after the rendering is complete.Moving to mab4.1 () because:- 4.0 reached EOL (End Of Life)- bug confirmed in later versionif you guys still reproduce this bug under 4.2.x please move it to the mab 4.2 list () since 4.1.x is END OF LIFEStill reproducible for me with LibO 4.2.5.0.0+ under Ubuntu 14.04 x86-64Moving to MAB 4.2 list.Best regards. JBFI wonder iffixes this too ?Yeah, reverting that fix locally, on each save the memory usage jumps, restore that fix and it remains stable. I'll call that fixed byIndeed no memory leak anymore in LO 4.2 and LO 4.3 with the bugdoc.Thank you very much :-)Best regards. JBF
id=52639	CreatedDatabase could not be opend after opening report-builder for new reportI open the report-builder and want to edit a new report. I changed nothing and close the report - not saving the report.I close the database - nothing to save.Then I want to open the database for a second time - the database could not be opened.In META-INF there is the file manifest.xml.When I close LO 3.6.0.4rc this file is changed to 0 kB.This happens every time with the attached file in LO 3.6.0.4rc CreatedShown a destroyed *.odb-file after report-builder was opened for new reportCreatedShows the undistroyed file - open, try to edit a report.Choose "Create Report in Design View" under LO 3.6.0.4 32bit rpm Linux. The Report_Designer opens. Close the Report-Designer. Close the database and LO. Then open LO and try to open the database. It couldn't be opened, because there is no content in META-INF/manifest.xml.NOT Reproducible with Server Installation of "LibreOffice 3.6.0.4 rc German UI/Locale [Build-ID: 932b512] on German WIN7 Home Premium (64bit) My Steps:0. Download sample, 0.1. Start LibO (With inactive Experimental Features) > Start Center appears1. Open without registering from File Dialog > Document Main View appears2. Click 'Database Pane -> Reports'3. 'Tasks Pane -> Create Report in Design View' > Report Builder appears4. Click into Page Header field > Context related properties appear5. Menu 'File -> Close' > Report Builder will be closed, Document Main View appears6. Menu 'File -> Exit' > Document Closed, LibO TerminatedNow I restart from 0.1Everything works fineLinux related? Damaged User Profile? Something completely different?@sasha:Can you check this very urgent problem?@Robert:Of course this one may be very serious, but please do not mark Bugs as "blocker" in this stadium.Unfortunately important information is missing in the report:Please:- Attach screenshots with comments if you believe that that might explain the problem better than a text comment. Best way is to insert your screenshots into a DRAW document and to add comments that explain what you want to show- Contribute a document related step by step instruction containing every key press and every mouse click how to reproduce your problem (similar to example in)– if possible contribute an instruction how to create a sample document from the scratch (did you observe the problem also with an other database?)- add information -- concerning your OS (Version, Distribution, Language) -- concerning your LibO localization (UI language, Locale setting) –- Libo settings that might be related to your problems (Experimental Features activated)? -- how you launch LibO and how you opened the sample document –- If you can contribute an AOOo Issue that might be useful -- everything else crossing your mind after you read linked textsI have tested this the following way:1. Destroy the old User-Profile.2. Start LO.3. Create a new database. 4. Don't register - I won't work with this database under writer ore another program.( - ) You can create a little table, put some content in it. I have tested it with a new table and without; same behaviour as followed.5. Start the Report-Builder (not the wizard).6. Close the Report-Builder (nothing to save, you haven't created any report)7. Close the database and LO (nothing to save ...)8. Open LO9. Try to open the database.9a) In German version appears: "Allgemeiner Fehler" ("General Problem")9b) Base opened, but could not connect to tables ("No Driver-class '' found")There is nothing else to explain with pictures. It's a new profile, a new database. It first appears under 3.6.0.2 (this was the first 3.6-Version I tested). This bug appears every time on my system. My System is OpenSuSE 32bit.I did not try new Database Table, but sample document again with blank new user profile; still not reproducible.Still ma suspect: Linux related? Particular Java problem?@Robert: What JRE Version do you use?If nobody finds the time to test this problem here with Linux today, you should add someone else to CC who was involved in one of the report builder bugs listed in the Wiki and ask for Help@Julien:Can you help with a test on Linux?I have just tried it with the following Java:1. jre1.6.0_292. 1.6.0_24 from openjdk3. jre1.6.0_22Behaviour is all the same. Create Database, open Report-Creating, close (nothing to save), close LO, try to open the created database again - wouldn't work.LO 3.3.4 presents the "filter-selection" window, when I try to open the file, also LO 3.6, when I don't try to open it from the "Recent Documents".Just another notice:The database could be reopened, when you do not close LO. But when you close the whole LO it couldn't be opened any more. So the *.odb-file seems to get corrupt while closing LO.Rainer: sorry, for the moment i only got access to an iphone. I'll be able to test when I come back home, next Saturday.Another notice: Database is not destoyed in LO 3.6.0.4 on Linux x86-64. Tried this with OpenSuSE 12.1.All persons, who could not confirm this bug, have noticed, that the report-wizard won't work on their systems. Also on Linux x86-64. When I try the report-wizard the whole office will crash. When I try it an Linux x86 (32bit-rpm) the wizard works.[Reproduced] in 3.6.0.4 on Fedora 64 bit (installed from libreoffice.org)used first attachment and initial descriptionNot reproduced in 3.5.5. Therefore regressionNot reproduced in 3.3.4. Writes: "Oracle report builder required".Problem seems to be:There are a lot of tests, also with Linux, where the database is not destroyed. I tested this with 64-bit-rpm on a OpenSUSE 12.1-System. It works.Other problem with *.deb: Seems to be, that the report-builder could not be closed whithout crashing the whole LO.And another hint: When I don't close the whole LO I can reopen the database. And when I kill the LO-process (Ctrl-Alt-Esc in SuSE) I can also open the database again. The deleting of the *.odb-file happens, when the whole LO is closed in the norml way without any errormessage.FYI:Given the fact that this issue is reproducible (see), I have added it to our list of LibO 3.6 most annoying bugs ().On pc Debian x86-64, with master sources updated today, I tried to reproduce the problem by following(without creating table), I didn't succeed.Base opened normally then I could click on Table tab (but not surprising it's ok since there wasn't any table).I noticed these logs during closing anyway:warn:legacy.osl:9759:1:/home/julien/compile-libreoffice/libo/dbaccess/source/core/dataaccess/ModelImpl.cxx:926: caught an exception!in function:static bool dbaccess::ODatabaseModelImpl::commitStorageIfWriteable_ignoreErrors(const com::sun::star::uno::Reference<com::sun::star::embed::XStorage>&)type: com.sun.star.uno.RuntimeExceptionmessage: unsatisfied query for interface of type com.sun.star.io.XStream!warn:legacy.osl:9759:1:/home/julien/compile-libreoffice/libo/dbaccess/source/core/dataaccess/ModelImpl.cxx:832: ODatabaseModelImpl::commitRootStorage: could commit the storage!warn:legacy.osl:9759:1:/home/julien/compile-libreoffice/libo/unotools/source/config/configmgr.cxx:208: OSL_ASSERT: items_.empty()Createdbt + console msgs on masterI reproduced the crash (with same config than my previous comment).This time, i created a table with some lines in it, noticed these logs during first insert:warn:legacy.osl:10009:1:/home/julien/compile-libreoffice/libo/dbaccess/source/core/api/RowSetCache.cxx:851: ORowSetCache::moveWindow: m_nStartPos not smaller than m_nEndPoswarn:legacy.osl:10009:1:/home/julien/compile-libreoffice/libo/dbaccess/source/ui/browser/genericcontroller.cxx:1343: SbaTableQueryBrowser::openHelpAgent: could not get a dispatcher!Then I saved the table, launch report creation (without using wizard), then cancelled so no report.Finally I closed LO and had a crash.Sorry, the line "warn:legacy.osl:10009:1:/home/julien/compile-libreoffice/libo/dbaccess/source/ui/browser/genericcontroller.cxx:1343:SbaTableQueryBrowser::openHelpAgent: could not get a dispatcher!" appeared only when I launched report creation not during insert.I tried the same with 3.6 sources updated today, I had the same behaviour.BTW, here are my Java info:java version "1.6.0_24"OpenJDK Runtime Environment (IcedTea6 1.11.3) (6b24-1.11.3-2)OpenJDK 64-Bit Server VM (build 20.0-b12, mixed mode)Now there are more tests, that reproduced the bug. Problem: we can not describe the configuration by, for example, "Linux - all". In mailinglists I heard, that it works with *.deb 32bit (Ubuntu) and 64bit (Debian). An here Julien reported: crash. ()I tested with OpenSuSE 11.4, 32bit rpm - *.odb has beeen destroyed. With OpenSuSE 12.1, 64bit rpm it works. And here Sasha reported: crash. ()One day ago I had the same crash-problem with all wizards (I have not tested it before). Could you please have a look on?In my case was not a crash. All was looking correctly. But during exiting of office ODB file becomes slightly shorter. And next time this file impossible to open.Hi Sasha,what OS are you using?The problems don´t occur using Windows as OS, but only using Linux (also).Linux Fedora 64 bitI have tested it now on another PC with OpenSuSE 11.4, 32bit rpm. There it works. So I had a look at the difference between the same systems, both working with KDE.The GUI in the system, which could reopen the databases, looks rather old - don't know why, but it's the same in LO 3.3.4 an this system. When I want to save or open a file an old Gnome-dialog appears. I haven't installed the whole Gnome on this machine, because I am working with KDE. Seems, that the integration in KDE won't work right.Another hint for this system: When I start LO at the shell I see: GLIBCXX_3.4.11 not found. This system hasn't all the repositories with very new software integrated.I have a 64-bit-rpm-System, where it looks like this description - and there databases could be reopened too.The system, which could not open databases, when used the report-builder, shows a integrated design to KDE. When I want to open a file ore save a file an old KDE-dialog appears - looks like the old konqueror from KDE 3. It is the first time in LO, that a system-Dialog for saving and opening appears in this system.@sasha: which GUI is on your machine?KDE 4 and Gnome 3. Reproducible on both (corruption of odb in 3.6.0)Installed using rpm files from libreoffice.org. No desktop integration modules installed. User profile is fresh.Reproduced odb corruption also on Linux Alt6 64 bit, KDE. Used the same installation files as for Fedora.Experimented also on Windows XP 32 bit with 3.6.0:After exiting LibreBase window disappears, but program remains in memory. Impossible to start office again. I need use Ctrl-Alt-Del and kill soffice.bin.Only then possible to start LibreBase again.What about odb file: during exiting of office this file changes (no propose to save changes, just silent saving). But remains openable.Cannot reproduce with freshly created embedded HSQL database with LibreOffice 3.6.0.4 (Build ID: 932b512) (official deb binaries) on Debian GNU/Linux amd64.Cannot reproduce withwith LibreOffice 3.6.0.4 (Build ID: 932b512) (official deb binaries) on Debian GNU/Linux amd64.Yes, I also already saw that effect, but I did not see a possible relation to the problem here. I will watch that more carefully.I tried to reproduce and found a crasher when closing report wizard, please see the. I wonder if it might be related.Otherwise, I can find a way to reproduce this problem. I am afraid that it is a memory corruption and it behaves different way on different systems.(In reply to)Hi Petr,what do mean with "memory corruption": main memory = ram = physical defect or a problem in the code of LO?Createdvalgrind logs on masterI retrieved Valgrind logs if it can help.This bug describes, that the creating of a report destroys *.odb-files. The only system, where this happens - as I see from the comments - is Linux with *.rpm-packages 32bit and 64bit. And it didn't happen with every system, where these packages are installed. Only person, which has reproduced and commented it here is sahsha (and)There are other problems with the wizard of the report-builder. This is reported in. The problems with the wizard seem to be problems of *.deb-packages.The bug reported here has nothing to do with the wizard. Only opening and closing of "Create Report in Design View" without saving anything is, what I make in LO-Base. I close normally without any problem Base. When I reopen at this moment the database it works - but only at this session. When I close LO in the normal way the database-file is corrupted. When I close LO by killing the process the database could be opened again.Here is the difference between those versions of Linux-rpm, which don't destroy the database by editing a report (or opening a wizard) and on the other hand, which destroy databases.The following I see on the shell, when LO works in the right way with databases:(soffice:2011): Gtk-WARNING **: /opt/libreoffice3.6/program/../ure-link/lib/libstdc++.so.6: version `GLIBCXX_3.4.11' not found (required by /usr/lib64/gtk-2.0/2.10.0/engines/liboxygen-gtk.so)You see a warning on every *.rpm-version, which works with LO and base in the right way, don't destroys databases and looks a little bit like very old Gnome-desktop. The dialog for opening files in LO is an old Gnome-dialog - under KDE.This warning didn't appear at systems, which destroy the database in the way I have written in the former comments.Is the "stdlibs" rpm provided by LibreOffice installed on the affected systems?If it is, try to uninstall it.If it is not, try to install it.In all cases, please report results before/after.(In reply to)It has been installed. Databases were corrupted after closing LO.Have uninstalled it, tested - same problem.I think the version stdlibs of LO is for "old" Linux-Systems. But the systam I have is updated with all patches ...(In reply to)Drats.Exactly; but if it is installed, it is always used,even on newer systems. This can cause problems with*other* components (such as QT or GTK+ themes) thatexpect a newer stdlibs than what is distributed withLibreOffice. That's why it is recommended to installthe LO stdlibs only if necessary.(if the stdlibs on the systems are *older*than the ones distributed with LibreOffice,using the LO ones should AFAIK not hurt.)I think the "looks like a very old Gnome" that you reportis caused by the presence of LibreOffice's stdlibs:the GTK+ theme cannot be loaded. That's the meaning of thewarning you report:(soffice:2011): Gtk-WARNING **:/opt/libreoffice3.6/program/../ure-link/lib/libstdc++.so.6: version`GLIBCXX_3.4.11' not found (required by/usr/lib64/gtk-2.0/2.10.0/engines/liboxygen-gtk.so)You should get this warning if and only if the LO stdlibs are installed(on a system where the GTK themes have been compiled against a newerstdlibs than what is shipped with LO).As you were reporting that the warning is linked to presence of this bug,my hunch was that there was something about the stdlibs in LO or on thesystem that caused something to go wrong.In other words: this message not connected with this problem."Is the "stdlibs" rpm provided by LibreOffice installed on the affected systems?"Little hint: When I uninstall it on the machines, were the bug didn't appear and the GTK-Warning appears, the GTK-Warning has gone and LO uses the dialog of my system (KDE, Dolphin). Good for my eyes, but didn't solve the problem directly. Its the system, where stdlibs seems nothing to do and the dialogs look like old konqueror-dialogs of KDE - with stdlibs and without stdlibs.The bug happens under KDE and Gnome, so it isn't a connection between KDE and LO.Stephan Bergmann committed a patch related to this issue.It has been pushed to "master":Related fdo#52639: Do not destroy Implementations with mutex locked(In reply to)That commit addresses the crash fromupon exiting LO (and I intend to get it backported to LO 3.6.1; it is a regression introduced with the new service manager in LO 3.6.0). I consider that crash unrelated to the problem discussed in this issue, though.Stephan Bergmann committed a patch related to this issue.It has been pushed to "libreoffice-3-6":Related fdo#52639: Do not destroy Implementations with mutex lockedIt will be available in LibreOffice 3.6.1.after trying out a lot of things, i have to disagree with Stephan for once :)first, the corruption problem does not occur in a "dev-install"installation with symlinks; i could only reproduce it bybuilding "archive" instsets and running those; i only mentionthis because finding this out wasted a lot of time :(then it seems that the commit inactually _does_ fixthe corruption problem. i don't know exactly why that is, but myguess is that at shutdown some attempt is made to save the documentwhile the ServiceManager is being disposed, and that happened to"partially" succeed before the commit in such a way that acorrupted document was produced, while with the commit it fails completely.please somebody verify this in tinderbox builds that have the fix.(In reply to)Where could I get these builds. Is it difficult to install for somebody, who only installs *.rpm with a packagemanager?(In reply to)you can find them here:it's not obvious to tell which upload has the fix, but looking at the githashes in the *_build_info.txt it seems that this one should have the fix:***has been marked as a duplicate of this bug. ***forgot to mention: with a 3.5.5 dbgutil build where the bug does NOT happeni get this telling assertion on shutdown: dbaccess/source/core/dataaccess/ModelImpl.cxx:937: caught an exception! in function:static bool dbaccess::ODatabaseModelImpl::commitStorageIfWriteable_ignoreErrors(const com::sun::star::uno::Reference<com::sun::star::embed::XStorage>&) type: com.sun.star.lang.DisposedException message: service manager instance has already been disposed! context: N9stoc_smgr23ORegistryServiceManagerE dbaccess/source/core/dataaccess/ModelImpl.cxx:843: ODatabaseModelImpl::commitRootStorage: could commit the storage!in 3.6, with the fix i get a slightly different assertionabout some XStream interface missing, and without the fixi get no assertion on shutdown.that's why i think something tries to save the document on shutdown,and this has always failed until the new service manager in 3.6.i wonder if _trying_ to save the document at this stage in shutdownis a bug by itself, and what to do about that;Lionel can think about this problem if he likes :)I have verified, that it works now with Version 3.6.1.0+ (Build ID: cd656ac).The problem with the wizards has also gone.Thank you, it took a load of my mind.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***
id=53410	CreatedOn the left an included component is selected and the expected behavior can be seen, on the right an excluded component is selected and the problem can be seenProblem description: Directory of the installation disappears and cannot be modified if a component is selected which is excluded from the install. Same behavior appears with the disk space button.Steps to reproduce:1. Double-click on the installer2. Choose custom installation3. Choose a component which is not intended to be installed (the ones with the X marks) or make a component not to install.Current behavior:- Path of the "Install to" directory disappears- Space button disappearsExpected behavior:Regardless of the selected components, both the installation directory path and the query of disk space should be always available.Platform: Windows 7 64-bit Let me start by apologizing that it took this long to address this. That being said, I can confirm this. Windows 8LibreOffice 3.5.7 (our version field is oldest version that we can confirm the problem)Setting to:NewCritical - inability to install essentially - a lot of people want to install to a separate drive and this only allows it if you install the entire suite. This being said, unlike Microsoft Office or other suites, each component is part of a larger individual product so not installing one thing is not saving you much at all in terms of space. None the less I think critical is appropriate.HighestMost Annoying BugAdditional info that makes it even worse:If you select your separate drive prior to deselecting a component, it actually installs to the appropriate drive but then it's a corrupt install and you can't run it.Thanks for reporting!Well, in 4.2 there will be no possibility to (misguidedly) pick and choose among "components" (meaning Writer, Calc, Draw etc) any more. Which is good. Despite the marketing, LibreOffice is not a "suite" of separate programs. It has never worked properly anyway to pick and choose among these "components"; leaving out some "component" has made some use cases of other "components" fail, etc.But as such, this bug is still present, if one de-selects on of the (truly) optional components, the possibility to change installation location disappears.Could someone test if this is still an issue in 4.1?Tor Lillquist is right.see:basically this means that this issue will not be present anymore in future LibO releases.I change status to RESOLVED WONTFIX
id=53070	CreatedSample MS Access 2007 databaseProblem description: Steps to reproduce:1. Start LibreOffice2. Click on 'Database'3. Choose 'connect to an exisiting database'4. Select 'MS Access 2007'5. Click 'Browse', se;ect the file, and click 'open'6. Click 'Finish', and 'save'.7. Click on 'Finish.Current behavior:When opening the attached database, LibreOffice becomes unresponsive.Expected behavior:The database is opened for editing.Platform (if different from the browser): Browser: Mozilla/5.0 (Windows NT 6.0; rv:14.0) Gecko/20100101 Firefox/14.0.1 ***has been marked as a duplicate of this bug. ***Created2nd Sample MS Access 2007 DatabaseCreated3rd MS Access sample mdbCreated4th MS Access sample mdb@ReginaPlease: an you have a look at this bugreport. What is your opinion?I cannot open the database samples with Microsoft Access 2007. So there is something wrong with the files.Nevertheless, I had already reported inthat LibO 3.6.1 hangs when I try to open an *.accdb database file via driver "MS Access 2007".AFAIK, the driver "MS Access 2007" is not intended to be used with *.mdb database files. So the 3rd and 4th sample are irrelevant.(In reply to)@John:I'm right in thinking that you have created your database samples with Microsoft Access 2007 and now you want to open this in LibreOffice/Base?I understand Regina that she can´t open the database samples with Microsoft Access 2007. Can it be that something is wrong with database samples?(In reply to)I downloaded the files from the public Microsoft.com website, and want to open them with LibreOffice.(In reply to)I just tried to open them with Microsoft Office 2010, and that works as expected. Perhaps they are MsOffice 2010 files, and MsOffice 2010 isnt supported with LibreOffice ?(In reply to)For the *.mdb files, I didnt choose 'Access 2007', but 'Microsoft Access' in LibreOffice. Im sorry that the initial bug description didnt mention that.Hi John,please create a new summary of your procedure, e.g. like1) I have downloaded four MS Access files (attachments 1-4) from the public Microsoft.com website.2) Now I want to open them with LibreOffice xxx (post what version).3) <next steps similar in your original bugreport but in more details> x) describe misbehavior.Poste your guess:Perhaps MsOffice 2010 files aren´t supported with LibreOffice.(In reply to)Would this be sufficient ? :Steps to reproduce:1. Download sample files from the Microsoft.com public website, or download the attachments from this bug report.2. If the attachments were used, unzip the attachmnents.3. Download 'master~2012-08-30_00.35.51_LibO-Dev_3.7.0.0.alpha0_Win_x86_install_en-US.msi' from4. Install 'master~2012-08-30_00.35.51_LibO-Dev_3.7.0.0.alpha0_Win_x86_install_en-US.msi' 5. Start MibreOffice master~2012-08-30_00.35.51_LibO-Dev_3.7.0.0.alpha04. Click on 'Database'4. Choose 'connect to an exisiting database'5. For the other 1st and 2nd *.accdb files, select 'MS Access 2007.' For the 3rd and 4th *.mdb files. select 'MS Access'. 6. Click 'Browse', select the file, and click 'open'7. Click 'Finish', and 'Save'.8. Click on 'Finish.Current behavior:When opening the filee, LibreOffice becomes unresponsive.Expected behavior:The database is opened for editing.Why is the status still 'NEEDINFO' ? What further info is needed, or do I need to deliver ? Thanks.Hi John,your bugreport must be confirmed. To reproduce takes much time. On average I edit 1 bug in 1 or 2 days because there are most vague informations. I will test your bugreport if I have time.But perhaps another person has time?Surely, this report is a duplicate of Regina's problems that she mentioned already :AlexOr alternatively, I would take Regina's comment as confirmation that the problem is reproducible.My problem inwas that I couldn't write/update the datasets, but at least I could load the tables, which would mean that that this current bug is an even further regression over 43187.Am confirming this bug with regard to Regina's comments.Alex***has been marked as a duplicate of this bug. ***I also managed to reproduce this yesterday, with an Access 2007 MONDIAL.accdb file and 3.6.1.AlexI am having almost the exact same problem, but with a ".mdb" file, using the "Microsoft Access" driver. This is on 3.6.1.2 Win Vista 32bit.I can open the database using the ODBC driver.The database file is confidential information so I cannot upload it.Should I create a new bug report for this? Or is it probably the same issue?Modified the bug title because the issue also occurs with the attached MS Access sample .mdb files (3rd sample and 4th sample).***has been marked as a duplicate of this bug. ***Hello,This problem occurs with Lbo 3.6.2regardsNicolasAdd comment for previous message : With MS-Access 2003 -> file freezes/hangs NicolasCreatedProcess monitor detail with 4th MS Access sample mdbOS: Windows XP (32-bit and 64-bit)LibreOffice:Version 3.6.4.0+ (Build ID: a4b919d)Version 3.6.2.2 (Build ID: da8c1e6)W2008R2@20-With-Symbol-Bytemark-Hosting/../master~2012-10-01_05.02.30_LibO-Dev_3.7.0.0.alpha0_Win_x86LibreOffice Base freezes when you try to connect to the Microsoft database.As it seems to me the reason for the error is the same as here (). These releases have only one common feature: they compiled the MS_VCR-2008 SP1.There is no error in:LibreOffice 3.5.7.2; Build ID: 3215f89-f603614-ab984f2-7348103-1225a5b/Win-x86@6/../master~2012-09-24_21.00.28_LibO-Dev_3.7.0.0.alpha0_Win_x86@:You use the MS_VCR-2008 (version 001500002102, non SP1). Please compile the W2008R2@16-minimal_build /LibO-Dev_3.7.0.0.alpha0_Win_x86 with JDK 1.6.0_u21-u33. It is possible that your release will solve this problem.My test with Server Installation of "LibreOffice 3.6.4.0+ English UI/ German Locale [Build-ID: a4b919d],{tinderbox: Win-x86@9 pull time 2012-10-10 19:11:32} on German WIN7 Home Premium (64bit) 0. Download / unzip Test kit 2012-08-02 08:19 UTC, John Smith 1. Launch LibO2. Click "New Database" button in LibO Start Center > Database Wizard appears3. Select "Connect to existing Database - MS Access 2007 <Next>4. Browse for Test Kit contents "TS102483123.accdb", <Open> -> <Next> > Wizard Step 3 dialog appears5. Yes, Register + "Open for Editing" <Finish> > Save Dialog appears6. Save "New Database.ODF" in same folder Expected: Database will be opened Actual: Error Message "The connection to the data source "New Database" could not be established. The connection could not be created. May be the necessary data provider is not installed"Same when I exactly follow reporter's steps and finish in my step 4Same with LibO 3.4.5 and 3.3.3 and AOOo 3.4.1I wonder why I always get error messages instead of freeze?Hello, Answr to:1- I download hereMicrosoft Visual C++ 2008 Service Pack 1 Redistributable Package (the same ofLibreOffice 3.5.6, I don't found this version -> 3.5.7.2 mentioned in your post)2- remove olds versions of Microsoft Visual C++ 20083- Setup this verion Visual C++ 2008 9.0.30729.61614- test to open MS-access 2003 database5- freeze /hang :-(Please confirm the Vc++ version is 99.0.30729.6161 or give me a link to donwload it.RegardsNicolas(In reply to)1.2. I used MC_VCR_9.0.21022.8_x86:- this version is specified in manifests of binary and executable files.Hello APE,I did the test with Visual C++ MC_VCR_9.0.21022.8_x86 and already had the same probleme (freeze).Please note this problem occur with LibreOffice-3.6.2 (not with libo 3.5.7 mention in your post).RegardsNicolas(In reply to)Nicolas! MS_VCR's version installed in the system, is not important in this bug. I think that an Built environment used to compile the LibO-3.6(7).x_Win_x86 is reason of an error. MS_VCR-9.0.21022 and JDK-1.6.0_u16-u35 should be used in the assembly all LibOffices (now - 3.5.7 only).Fridrich uses MSVCR-9.0.30729 (this is SP1).ape***has been marked as a duplicate of this bug. ***(In reply to)On a 64bit OS, Microsoft Jet is not installed by default. You need to installThe duplicatedescribes that LO-3.5 worked better => we need to look at it => added into MABs.Well, this bug affects only limited group of users. It has already been in the earlier 3.6 releases => it can't block the next bugfix release => lowering the severity a bit.Added “regression” keyword according toand.I confirm the problem with version 3.6.2.2 and Access 2000 .mdb files.O/S is Windows XP and Windows 7.(In reply to)--(In reply to)--Sorry, but I can not open your files in Microsoft Access 2007 sp3 32-bit RUS: "Unrecognized database format <filename>. (Error 3343)".Created5th MS Access (2000) sample mdbAttached a very simple mdb made with MS Access 2000.Creating a Base document by connecting to existing Access database does produce the .odb with the link to the mdb, but on opening, Base freezes.(LibO 3.6.3RC2, Windows XP)@LionelI'm sorry to disturb you, but the previous time LibO couldn't open mdb files, you where the master that overpowered the bug. Would it be possible that you have a look at this bug?It may not be a blocker, but it certainly is a seriour nuisance for private users companies that transferred from MS Office to LibreOffice.I quite willing to test daily builds on Windows, if you want me toSorry amateur opine.There is a bug in the LibO_3.5.x. Import DOCX-file containing formulas Microsoft Office 2003, will start The Equation Editor (EQNEDT32.EXE) in the background.This error appeared after fixing that bug. It seems that the ability to access libraries of Microsoft’s external programs has been disabled in the LibO_3.6.x. Therefore, the two regressions were born at the same time: this and the. See also.Can't connect to other ADO sources either, so it seems our whole ADO driver is bust (the Access and Access 2007 "drivers" are just alternative names for the ADO driver with a preconfigured 'magic' data source URL).This would need some love from a developer with a Windows build and/or a QA person with a windows debug build. I'd love to see the equivalent of gdb's "thread apply all bt full" at the moment of the freeze.I'd be very happy to cooperate with a LibO-on-Windows developer.I've looked a bit at the log of changes in connectivity/source/drivers/ado. What strikes me as weird is:Commit 8256eb0205fcddb79a67be13d6507b2653ff5e08Author: Matúš Kukan <> 2012-04-07 14:09:40Committer: David Tardon <> 2012-05-29 07:24:43 connectivity: remove unused adabas filesREMOVES files:connectivity/source/drivers/ado/AKeyColumn.cxxconnectivity/source/drivers/ado/AKeyColumns.cxxCommit fc6d226a0ed0e493a33d5f82edcedec0ddd37ec7Author: David Tardon <> 2012-03-10 19:00:43Committer: David Tardon <> 2012-03-12 08:53:56 WaE: missing braces around initializer for 'unsigned char [8]'------------------ connectivity/source/drivers/ado/adoimp.cxx ------------------index 14f5f52..3c05419 100644@@ -41,7 +41,7 @@ using namespace com::sun::star::sdbc; using namespace com::sun::star::sdbcx; -#define MYADOID(l) {l, 0,0x10,0x80,0,0,0xAA,0,0x6D,0x2E,0xA4};+#define MYADOID(l) {l, 0,0x10,{0x80,0,0,0xAA,0,0x6D,0x2E,0xA4}}; const CLSID ADOS::CLSID_ADOCONNECTION_21 = MYADOID(0x00000514); const IID ADOS::IID_ADOCONNECTION_21 = MYADOID(0x00000550);Are we double-plus extra sure that this does not change the value of e.g. ADOS::CLSID_ADOCONNECTION_21?One thing to try is to revert these commits (or parts thereof) and see if it makes a difference. Or also some bibisect love to try to find the exact commit which introduced this bug.(In reply to)It is not weird at all, actually. git log says these files had never been compiled.Yes. Both CLSID and IID are typedef'd from GUID, which is declared astypedef struct _GUID { DWORD Data1; WORD Data2; WORD Data3; BYTE Data4[8];} GUID;(). The commit just adds braces around the initializer for the Data4 array.(In reply to)...------@David Tardon:David, let's recover the files that have been deleted on May 29: 1. Access problems began at about this time. 2. I think that the patch has not been used in LibO-35. 3. The patch (made by March 12) eliminates problems with connecting to the Access-98\2000.(In reply to)I repeat: these files have nothing to do with it. I merged a branch that converted module connectivity (where the ado driver is placed) to gbuild at that date. In all probability the problem was caused by that conversion (missing exported symbols, most likely).No. But neither were the files.Huh?***has been marked as a duplicate of this bug. ***David Ostrovsky committed a patch related to this issue.It has been pushed to "master":fdo#53070 fix access violationThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.David Ostrovsky committed a patch related to this issue.It has been pushed to "master":fdo#53070 add complete unit testThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.David Ostrovsky committed a patch related to this issue.It has been pushed to "libreoffice-3-6":fdo#53070 fix access violationIt will be available in LibreOffice 3.6.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.The patch works with ADO connection to MS-SQL-Server 2003 (see also)Thank you David!
id=53872	Downloaded the daily build no-moz (21/08) of Mac OSX1) Loaded a ODB file (attached)2) Clicked on Reports3) Double-clicked on ELEVE4) Crash Mac OSX 10.8 Mountain LionAlex Createdtest odb file with reportCreatedapple crash traceThe same file, opened with LO 3.5.5.3, does not cause a crash, but an error message is displayed.reproducible every timeCreatedbt with symbols on masterOn pc Debian x86-64 with master sources updated today, I reproduced the problem.I attached bt with symbolsCreatedproposed patchThe problem is on this line:1189 sal_Int32 nSectionHeight = xFixedLine->getSection()->getHeight();No test is made to know if xFixedLine->getSection() exists or not.I attached a proposed patch, perhaps naive/wrong but which allows to open the report.lionel: what do you think about this patch? If ok, I can push it on master.As Julien also reproduced on Debian, updating OS/platform and changing subject line.Alex@JulienHave there been any recent changes in section height calculation that might have inadvertently caused this ?Alex(In reply to)By looking at the git history of the file reportdesign/source/filter/xml/xmlExport.cxx, it's like this since the beginning (09/07/2007).BTW, could you indicate how did you create this report? Did you use a specific option for example?(In reply to)Ah OK.I didn't create it, it was supplied by someone from the French user/discussion list with a problem they were attempting to solve.In LO 3.5.5, the same report causes a Java AWT thread attachment error on MacOSX, and refuses to load. I've opened a separate bug report for that because it is Mac specific (no-one else could reproduce it on other OSes, and Lionel doesn't have a Mac to test on, so I put Thorsten on CC). Alex(In reply to)My money is on "for some reason, the control in xFixedLine, when it was *created* / loaded, was not attached to a section, while it should have been".It could be for a reason similar to what happened in, but that is just a wild guess.Alex: I'll try your file tonight with 3.5 and 3.6 sources.Just thinking for possible changes which could have happened between different versions:- section management- exception managementAbout your, what's the fdo?With 3.5 sources updated yesterday and 3.6 sources updated today, I reproduced the pb with an equivalent stacktrace.I submited the patch for reviewing (see)There is something wrong with fixed lines in reportbuilder reports for a long time... See e.g.,, ...I wouldn't be too surprised if the ultimate reason for all these bugs were one and the same.This is *definitely* a larger problem with linking controls to their enclosing section: With a debug build, I get:warn:legacy.osl:23098:1:/home/master/src/libreoffice/workdirs/libreoffice-3.6/reportdesign/source/ui/report/FixedTextColor.cxx:161: caught an exception!in function:virtual void rptui::FixedTextColor::handle(const com::sun::star::uno::Reference<com::sun::star::uno::XInterface>&)type: com.sun.star.uno.RuntimeExceptionmessage: unsatisfied query for interface of type com.sun.star.report.XSection!context: N12reportdesign15OReportDrawPageEwarn:legacy.osl:23098:1:/home/master/src/libreoffice/workdirs/libreoffice-3.6/reportdesign/source/ui/report/FormattedFieldBeautifier.cxx:132: FormattedFieldBeautifier::setPlaceholderText: invalid peer!warn:legacy.osl:23098:1:/home/master/src/libreoffice/workdirs/libreoffice-3.6/reportdesign/source/ui/report/FormattedFieldBeautifier.cxx:125: caught an exception!in function:void rptui::FormattedFieldBeautifier::setPlaceholderText(const com::sun::star::uno::Reference<com::sun::star::uno::XInterface>&)type: com.sun.star.uno.RuntimeExceptionwarn:legacy.osl:23098:1:/home/master/src/libreoffice/workdirs/libreoffice-3.6/reportdesign/source/ui/report/FixedTextColor.cxx:161: caught an exception!in function:virtual void rptui::FixedTextColor::handle(const com::sun::star::uno::Reference<com::sun::star::uno::XInterface>&)type: com.sun.star.uno.RuntimeExceptionmessage: unsatisfied query for interface of type com.sun.star.report.XSection!context: N12reportdesign15OReportDrawPageEwarn:legacy.osl:23098:1:/home/master/src/libreoffice/workdirs/libreoffice-3.6/reportdesign/source/ui/report/FixedTextColor.cxx:161: caught an exception!in function:virtual void rptui::FixedTextColor::handle(const com::sun::star::uno::Reference<com::sun::star::uno::XInterface>&)type: com.sun.star.uno.RuntimeExceptionmessage: unsatisfied query for interface of type com.sun.star.report.XSection!context: N12reportdesign15OReportDrawPageEwarn:legacy.osl:23098:1:/home/master/src/libreoffice/workdirs/libreoffice-3.6/reportdesign/source/ui/report/FixedTextColor.cxx:161: caught an exception!in function:virtual void rptui::FixedTextColor::handle(const com::sun::star::uno::Reference<com::sun::star::uno::XInterface>&)type: com.sun.star.uno.RuntimeExceptionmessage: unsatisfied query for interface of type com.sun.star.report.XSection!context: N12reportdesign15OReportDrawPageEwarn:legacy.osl:23098:1:/home/master/src/libreoffice/workdirs/libreoffice-3.6/reportdesign/source/ui/report/FixedTextColor.cxx:161: caught an exception!in function:virtual void rptui::FixedTextColor::handle(const com::sun::star::uno::Reference<com::sun::star::uno::XInterface>&)type: com.sun.star.uno.RuntimeExceptionmessage: unsatisfied query for interface of type com.sun.star.report.XSection!context: N12reportdesign15OReportDrawPageEwarn:legacy.osl:23098:1:/home/master/src/libreoffice/workdirs/libreoffice-3.6/reportdesign/source/ui/report/FormattedFieldBeautifier.cxx:132: FormattedFieldBeautifier::setPlaceholderText: invalid peer!warn:legacy.osl:23098:1:/home/master/src/libreoffice/workdirs/libreoffice-3.6/reportdesign/source/ui/report/FormattedFieldBeautifier.cxx:125: caught an exception!in function:void rptui::FormattedFieldBeautifier::setPlaceholderText(const com::sun::star::uno::Reference<com::sun::star::uno::XInterface>&)type: com.sun.star.uno.RuntimeExceptionwarn:legacy.osl:23098:1:/home/master/src/libreoffice/workdirs/libreoffice-3.6/reportdesign/source/ui/report/FormattedFieldBeautifier.cxx:132: FormattedFieldBeautifier::setPlaceholderText: invalid peer!warn:legacy.osl:23098:1:/home/master/src/libreoffice/workdirs/libreoffice-3.6/reportdesign/source/ui/report/FormattedFieldBeautifier.cxx:125: caught an exception!in function:void rptui::FormattedFieldBeautifier::setPlaceholderText(const com::sun::star::uno::Reference<com::sun::star::uno::XInterface>&)type: com.sun.star.uno.RuntimeExceptionwarn:legacy.osl:23098:1:/home/master/src/libreoffice/workdirs/libreoffice-3.6/reportdesign/source/ui/report/FormattedFieldBeautifier.cxx:132: FormattedFieldBeautifier::setPlaceholderText: invalid peer!warn:legacy.osl:23098:1:/home/master/src/libreoffice/workdirs/libreoffice-3.6/reportdesign/source/ui/report/FormattedFieldBeautifier.cxx:125: caught an exception!in function:void rptui::FormattedFieldBeautifier::setPlaceholderText(const com::sun::star::uno::Reference<com::sun::star::uno::XInterface>&)type: com.sun.star.uno.RuntimeExceptionwarn:legacy.osl:23098:1:/home/master/src/libreoffice/workdirs/libreoffice-3.6/reportdesign/source/ui/report/FormattedFieldBeautifier.cxx:132: FormattedFieldBeautifier::setPlaceholderText: invalid peer!warn:legacy.osl:23098:1:/home/master/src/libreoffice/workdirs/libreoffice-3.6/reportdesign/source/ui/report/FormattedFieldBeautifier.cxx:125: caught an exception!in function:void rptui::FormattedFieldBeautifier::setPlaceholderText(const com::sun::star::uno::Reference<com::sun::star::uno::XInterface>&)type: com.sun.star.uno.RuntimeExceptionwarn:legacy.osl:23098:1:/home/master/src/libreoffice/workdirs/libreoffice-3.6/dbaccess/source/ui/browser/genericcontroller.cxx:1350: SbaTableQueryBrowser::openHelpAgent: could not get a dispatcher!warn:configmgr:23098:14:/home/master/src/libreoffice/workdirs/libreoffice-3.6/configmgr/source/propertynode.cxx:83: non-nillable property without valueSetting version to 3.5 daily as per(In reply to)Therefore removed from "LibO 3.6 most annyoing bugs" and "LibO 3.7 most annyoing bugs", and added to "LibO 3.5 most annyoing bugs".Aha! Reverting: commit 05218c101df486302bf4cfe8be23ad840daa3f73 Author: Michael Stahl <> Commit: Miklos Vajna <> fdo#53154: fix report design wizard crash: As described by Stephan in the bug report, the XAggregation usage in OSection of SvxFmDrawPage is broken; replace it by explicit forwarding of the XDrawPage, XShapeGrouper, XFormsSupplier2 methods; it seems to fix the crash here. Also get rid of horrid refcount manipulation etc. while at it. (cherry picked from commit 8ec791316c1d90b25e85c94ad105e9cc62e568e2) Change-Id: Ib08830d2092bd2026db5b57c1c2e165b946889b3 Signed-off-by: Miklos Vajna <>Fixes this crash. Michael Stahl, this is your commit, so you might have a clue why it makes controls orphan of their section? Thanks in advance for taking a look.(In reply to)I'm trying to understand that commit. One weird thing catches my eye: it introduces a private m_xDrawPage_Tunnel data member to class reportdesign::OSection, but never sets it.yes that is evidently caused by the XAggregation removal;the call to getSection accesses (through a pile of macros) the un-aggregated SvxDrawPage:#0 SdrPage::getUnoPage (this=0x4bfc3a0) at svx/source/svdraw/svdpage.cxx:1798#1 0x00007fe4e51dfd42 in SvxShape::getParent (this=0x463dcd8) at svx/source/unodraw/unoshape.cxx:3856#2 0x00007fe4e1359157 in reportdesign::OShapeHelper::getParent<reportdesign::OFixedLine> (_pShape=0x4872f30) at reportdesign/source/core/inc/Tools.hxx:174#3 0x00007fe4e1351fb3 in reportdesign::OFixedLine::getParent (this=0x4872f30) at reportdesign/source/core/api/FixedLine.cxx:445#4 0x00007fe4e1350e55 in reportdesign::OFixedLine::getSection (this=0x4872f30) at reportdesign/source/core/api/FixedLine.cxx:255#5 0x00007fe4e0849ac3 in rptxml::ORptExport::exportAutoStylewhich is then queried for reportdesign::XSection unsuccessfully:#0 SdrPage::getUnoPage (this=0x4bfc3a0) at svx/source/svdraw/svdpage.cxx:1798#1 0x00007fe4e51dfd42 in SvxShape::getParent (this=0x463dcd8) at svx/source/unodraw/unoshape.cxx:3856#2 0x00007fe4e1359157 in reportdesign::OShapeHelper::getParent<reportdesign::OFixedLine> (_pShape=0x4872f30) at reportdesign/source/core/inc/Tools.hxx:174oops, query is here:#0 reportdesign::lcl_getSection (_xReportComponent=uno::Reference to { _vptr.XInterface = 0x7fe4e16c0368}) at reportdesign/source/core/api/Tools.cxx:34#1 0x00007fe4e1350e97 in reportdesign::OFixedLine::getSection (this=0x4872f30) at reportdesign/source/core/api/FixedLine.cxx:255Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-3-5":fdo#53872: reportdesign: fix section drawpage crash:It will be available in LibreOffice 3.5.7.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Commits for other branches:libreoffice-3-6master:
id=53929	Createdfile to demonstrate incorrect pivottable behaviorProblem description: When creating a pivottable from data in spreadsheet, the vertical aggregation/grouping is incorrect - it contains multiple equal entries.Steps to reproduce:1. create a simple data table according to attached file.2. create pivottable with vertical aggregation values from column "x-axis", horizontal aggregation values from "y-axis" and sum-values from "z-axis"3. look at created tableCurrent behavior:vertical aggregation contains multiple equal entriesExpected behavior:unique vertical aggregation values(open attached file in LO 3.5.5.4 and actualize pivottable)Platform (if different from the browser): Win7 x64, LO 3.6Browser: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:14.0) Gecko/20100101 Firefox/14.0.1 Createdscreenshot of data values for pivottableCreatedscreenshot of pivottable produced by LO 3.6Createdscreenshot of pivottable produced by LO 3.5.5.3Confirming & taking it.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#53929: Pivot table uses case insensitive string comparison.Fixed on master. Request for 3.6 backport has been sent out.back-ported; thrilled to see the unit test so it can never recur :-)Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-3-6":fdo#53929: Pivot table uses case insensitive string comparison.It will be available in LibreOffice 3.6.2.***has been marked as a duplicate of this bug. ***@Koheiquestion please:does that mean you (re)-introduced case-sensifity in a aggregation-function? (Hope not)Martin
id=53988	Installed Libreoffice 3.6 with no issues. Tried to execute it and got the following message:Unhandled exception:InvalidRegistryException:file:///C:Program%20Files%20(x86)/LibreOffice%203.6/program/../share/extension/wiki-publisher/components.rdb: duplicate<implementationname="com.sun.star.wikiOptionsEventHandlerImpl">Followed by:Runtime Error!Program: C:\Program Files (x86)\LibreOffice 3.6\program\soffice.binThis application has requested the Runtime to terminate it in an unusual way.Please contact the application's support team for more information. *** This bug has been marked as a duplicate of***See workaround/fix at
id=52177	When writing a .odt document on Libreoffice Writer in Ubuntu 12.04 with Gnome 3 (using Gnome Shell, not Unity), if word autocompletion occurs too fast, the whole Gnome 3 environment freezes, with keyboard not respondig (LEDs don't change state when pressing those keys) leaving as only alternative to force shutdown of the laptop computer using power button and restart the entire operating system, possibly loosing lattest changes in document and risking to filesystem corruption.My graphic card is an Intel HD integrated card and mi processor Intel Core i7. I have no problem with this on Ubuntu 12.04 gnome shell with LibO 3.5.4.Perhaps some kind of driver bug.You could try reporting it to Ubuntu directly on Launchpad.I also have no problems with Ubuntu 12.04 and gnome-shell 3.4.1 and LibO 3.6.0Not positive what the issue is but you might at least start here:
id=54985	CreatedTest OneFails in Libreoffice 3.5.6 and 3.6.1.2. When trying to open the following two attached samples, Libreoffice popups a character set prompt screen but selecting any does not help as the output is always corrupted with garbage symbols.VersusOpenOffice 3.4.1 opens up these two files perfectly fine without any type of character set prompt. CreatedTest TwoSame with 3.6.lVersion 3.6.0.4 (Build ID: 932b512) has no problem at all. This is a very bad regression in the 3.6.1 new DOC import code.On pc Debian x86-64 with master sources updated today, I reproduced the problem.I noticed a lot of this log:/home/julien/compile-libreoffice/libo/sw/source/core/text/porlay.cxx:1258: Heavy InitScriptType() confusionMiklos: one for you?***has been marked as a duplicate of this bug. ***Comment onTest OneImproved MIME type.Comment onTest TwoImproved MIME type.CreatedValid .doc file displays as garbageStill broken in latest Win32 and Linux builds. See attached; fine in MS Word Viewer on Win32, broken in LO.Createdsame .doc showing corruption on Writer but OK in CalligraKDEs office suite displays .doc fine tooI don't reproduce this on 3.6.4 Win7.Tom: if you reproduce the problem with 3.6.4, don't hesitate to reopen this tracker.This was a fresh install on Win XP on Saturday, so would have been 3.6.4.My local machine is Ubuntu 12.10, which ships a slightly older version, but it does have the same issue.Tom*** This bug has been marked as a duplicate of***This isn't a duplicate. The bug it's meant to duplicate was fixed in 3.6.4 but this doesn't fix this issue.That issue also talks about an ASCII filter window, which doesn't appear here (see screen shots).(In reply to)"Fresh": do you mean with a brand new LO profile (see)?If not, could you rename your LO directory profile and test again?If you still reproduce, could you answer these questions- did you install any specific fonts?- did you install any specific extensions?Bug is no longer reproducible on Windows 7 and latest LO. Clean Windows 7 LO 3.6.4.3 install with new UserProfile directory and no other extension or system fonts.1) Tests One - Opened CORRECTLY with no artifacts.2) Tests Two - Opened CORRECTLY with no artifacts.3) Tom's "Valid Doc" - Opened CORRECTLY with no artifacts.import of these bugdocs was fixed by ef9f9b750eac2966634c385a2021716c4de0e4cd=> duplicate*** This bug has been marked as a duplicate of***
id=54457	Createdstack traceUsing libreoffice-3-6~2012-08-30_21.14.28_LibO-Dev_3.6.2.0_Linux_x86-64_helppack-deb_en-USLinux Mint 12 64bit1) Configure an ODBC DSN connecting to a mysql server2) Create and register an ODB with the mysql ODBC driver using the db creation wizard. In my specific case, I was using the tables from phpmyadmin3) Close LO4) Start LO, open new Writer document5) Press F4 to open the data source browser (DSB)6) Navigate down through the tables, either by clicking or moving the down arrow key.7) Crash/opt/libreoffice3.6/program/pythonloader.py:60: UnicodeWarning: Unicode equal comparison failed to convert both arguments to Unicode - interpreting them as being unequal if 1 == os.access( encfile( path ), os.F_OK) and not path in sys.path:## A fatal error has been detected by the Java Runtime Environment:## SIGSEGV (0xb) at pc=0x00007fa1f0c0795c, pid=9778, tid=140334157261056## JRE version: 6.0_26-b03# Java VM: Java HotSpot(TM) 64-Bit Server VM (20.1-b02 mixed mode linux-amd64 compressed oops)# Problematic frame:# C [libdbalo.so+0x15395c] cppu::WeakComponentImplHelper11<com::sun::star::sdbc::XWarningsSupplier, com::sun::star::sdbc::XResultSet, com::sun::star::sdbc::XResultSetMetaDataSupplier, com::sun::star::sdbc::XRow, com::sun::star::sdbc::XCloseable, com::sun::star::sdbc::XColumnLocate, com::sun::star::sdbcx::XRowLocate, com::sun::star::sdbcx::XColumnsSupplier, com::sun::star::sdbc::XResultSetUpdate, com::sun::star::sdbc::XRowUpdate, com::sun::star::lang::XServiceInfo>::getImplementationId()+0x18a5c## An error report file with more information is saved as:# /home/alex/Téléchargements/LODEBS/LibO-Dev_3.6.2.0_Linux_x86-64_helppack-deb_en-US/DEBS/hs_err_pid9778.log## If you would like to submit a bug report, please visit:##[error occurred during error reporting , id 0xb]Stack trace included.Alex Don't have any debug symbols with the build, but this is the bt at SIGSEV :Program received signal SIGSEGV, Segmentation fault.0x00007fffd225095c in ?? () from /opt/libreoffice3.6/program/../program/libdbalo.so(gdb) bt#0 0x00007fffd225095c in ?? () from /opt/libreoffice3.6/program/../program/libdbalo.so#1 0x00007fffd2250b1b in ?? () from /opt/libreoffice3.6/program/../program/libdbalo.so#2 0x00007fffd2251095 in ?? () from /opt/libreoffice3.6/program/../program/libdbalo.so#3 0x00007fffd1913b97 in ?? () from /opt/libreoffice3.6/program/../program/libfrmlo.so#4 0x00007fffd19155af in ?? () from /opt/libreoffice3.6/program/../program/libfrmlo.so#5 0x00007fffd1915f0a in ?? () from /opt/libreoffice3.6/program/../program/libfrmlo.so#6 0x00007fffd27a3a7d in ?? () from /opt/libreoffice3.6/program/../program/libdbulo.so#7 0x00007fffd2813250 in ?? () from /opt/libreoffice3.6/program/../program/libdbulo.so#8 0x00007fffd28143fd in ?? () from /opt/libreoffice3.6/program/../program/libdbulo.so#9 0x00007fffd2816330 in ?? () from /opt/libreoffice3.6/program/../program/libdbulo.so#10 0x00007fffd2829420 in ?? () from /opt/libreoffice3.6/program/../program/libdbulo.so#11 0x00007ffff37a70aa in Timer::ImplTimerCallbackProc() () from /opt/libreoffice3.6/program/libvcllo.so#12 0x00007fffe9a58893 in ?? () from /opt/libreoffice3.6/program/libvclplug_gtklo.so#13 0x00007fffe7d73a5d in g_main_context_dispatch () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#14 0x00007fffe7d74258 in ?? () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#15 0x00007fffe7d74429 in g_main_context_iteration () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#16 0x00007fffe9a58b30 in ?? () from /opt/libreoffice3.6/program/libvclplug_gtklo.so#17 0x00007ffff379fd81 in Application::Yield(bool) () from /opt/libreoffice3.6/program/libvcllo.so#18 0x00007ffff379fe37 in Application::Execute() () from /opt/libreoffice3.6/program/libvcllo.so#19 0x00007ffff7925b0d in ?? () from /opt/libreoffice3.6/program/libsofficeapp.so#20 0x00007ffff37a6717 in ?? () from /opt/libreoffice3.6/program/libvcllo.so#21 0x00007ffff37a67e5 in SVMain() () from /opt/libreoffice3.6/program/libvcllo.so#22 0x00007ffff7951697 in soffice_main () from /opt/libreoffice3.6/program/libsofficeapp.so#23 0x000000000040070b in ?? ()#24 0x00007ffff70f930d in __libc_start_main (main=0x400700, argc=1, ubp_av=0x7fffffffe7f8, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffffffe7e8) at libc-start.c:226#25 0x000000000040066a in ?? ()#26 0x00007fffffffe7e8 in ?? ()#27 0x000000000000001c in ?? ()#28 0x0000000000000001 in ?? ()#29 0x00007fffffffea91 in ?? ()#30 0x0000000000000000 in ?? ()Cannot reproduce in my 3.6 dev tree.Alex: I don't know if a daily dbg LO package exists, found nothing hereor missed it.Could you try with LO Mint package (think about installing libreoffice-dbg)?Next solution, build the sources (not very complicated if you follow) and give it a try.In your case (you seem to use Mysql, Odbc, ...), autogen.lastrun should contain at least these options:--enable-debug--enable-dbgutil--enable-symbols--with-system-odbc--enable-ext-mysql-connector--with-system-mysql(In reply to)Hi Julien,No, there isn't one that I can see either.I have added the Ubuntu PPA, but that is only at 3.5.4 at the moment, and I'm not even sure that it came with libreoffice-dbg, will have to check. The stock Mint 12 comes with LO 3.4.4 and debug symbols, but I didn't have a problem there.Not an option I'm afraid, too little disk space, and too slow a machine for building - it takes approximately 2 days for my LO build to complete on that machine (single processor, 756Mb RAM), and that's even when using ccache to speed things up :-/AlexManaged to test on 3.5.4.2 Ubuntu PPA with debug symbolsProgram received signal SIGSEGV, Segmentation fault.btdbaccess::ORowSet::impl_restoreDataColumnsWriteable_throw (this=0x20ec520) at /build/buildd/libreoffice-3.5.4/dbaccess/source/core/api/RowSet.cxx:12591259 /build/buildd/libreoffice-3.5.4/dbaccess/source/core/api/RowSet.cxx: Aucun fichier ou dossier de ce type. in /build/buildd/libreoffice-3.5.4/dbaccess/source/core/api/RowSet.cxx(gdb) (gdb) cContinuing.[Thread 0x7fffdca8f700 (LWP 7231) exited][Thread 0x7fffd8a49700 (LWP 7226) exited][Thread 0x7fffdc28e700 (LWP 7222) exited][Thread 0x7fffe45dd700 (LWP 7212) exited][Thread 0x7fffed521700 (LWP 7207) exited][Thread 0x7fffe4dde700 (LWP 7216) exited]Program terminated with signal SIGSEGV, Segmentation fault.Hmm, so this is now reproducible for me in 3.5.4.2 as well, resetting version number back to earlier version.AlexApparently somewhere in here :void SAL_CALL ORowSet::moveToCurrentRow( ) throw(SQLException, RuntimeException){ ::connectivity::checkDisposed(ORowSet_BASE1::rBHelper.bDisposed); ::osl::ResettableMutexGuard aGuard( *m_pMutex ); checkPositioningAllowed(); if ( !m_pCache->m_bNew && !m_bModified ) // nothing to do if we're not on the insertion row, and not modified otherwise return; if ( rowDeleted() ) // this would perhaps even justify a RuntimeException .... // if the current row is deleted, then no write access to this row should be possible. So, // m_bModified should be true. Also, as soon as somebody calls moveToInsertRow, // our current row should not be deleted anymore. So, we should not have survived the above // check "if ( !m_pCache->m_bNew && !m_bModified )" ::dbtools::throwSQLException( DBACORE_RESSTRING( RID_STR_ROW_ALREADY_DELETED ), SQL_FUNCTION_SEQUENCE_ERROR, *this ); if ( notifyAllListenersCursorBeforeMove( aGuard ) ) { positionCache( MOVE_NONE_REFRESH_ONLY ); ORowSetNotifier aNotifier( this ); // notification order // - cursorMoved notifyAllListenersCursorMoved(aGuard); // - IsModified // - IsNew aNotifier.fire(); }}FWIW :myodbc : 5.1.6-1unixODBC : 2.2.14p2-2ubuntu1mysql : 5.1.63-0ubuntu0.11.10.1On pc Debian x86-64 testing (updated today) with master sources updated today, 3.6 and 3.5 updated some days ago, on each test, I created a brand new LO profile, I didn't reproduce the problem.libmyodbc version: 5.1.10-2+b1unixodbc version: 2.2.14p2-5mysql server version: 5.5.24-7Perhaps there's something specific in your base, could you give SQL to recreate your base (structure + data)?It seems to be an older bug. It seems to be somehow related to the specific setup. It can't block the next bugfix release => reducing the severity a bit.I have just reproduced the crash on a 32bit LO 3.5.4.2 as supplied by Ubuntu 12.04.libmyodbc_5.1.10mysql 5.5.24-0ubuntu0.12.04.1 (Ubuntu)/etc/odbcinst.ini[MySQL]Description = MySQL driverDriver = /usr/lib/i386-linux-gnu/odbc/libmyodbc.soDriver64 = /usr/lib/i386-linux-gnuSetup = /usr/lib/i386-linux-gnu/odbc/libmyodbc5.soSetup64 = /usr/lib/i386-linux-gnuUsageCount = 1CPTimeout = 0CPTimeToLive = 0CPProbe = DisableGetFunctions = 0DontDLCLose = 1ExFetchMapping = 1Threading = 3FakeUnicode = 0/etc/odbc.ini[mysql]Description = Mysql accessDriver = MySQLDatabase = mysqlServer = 127.0.0.1First 4 tables of mysql db :CREATE TABLE `columns_priv` ( `Host` char(60) COLLATE utf8_bin NOT NULL DEFAULT '', `Db` char(64) COLLATE utf8_bin NOT NULL DEFAULT '', `User` char(16) COLLATE utf8_bin NOT NULL DEFAULT '', `Table_name` char(64) COLLATE utf8_bin NOT NULL DEFAULT '', `Column_name` char(64) COLLATE utf8_bin NOT NULL DEFAULT '', `Timestamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, `Column_priv` set('Select','Insert','Update','References') CHARACTER SET utf8 NOT NULL DEFAULT '', PRIMARY KEY (`Host`,`Db`,`User`,`Table_name`,`Column_name`)) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='Column privileges' CREATE TABLE `db` ( `Host` char(60) COLLATE utf8_bin NOT NULL DEFAULT '', `Db` char(64) COLLATE utf8_bin NOT NULL DEFAULT '', `User` char(16) COLLATE utf8_bin NOT NULL DEFAULT '', `Select_priv` enum('N','Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N', `Insert_priv` enum('N','Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N', `Update_priv` enum('N','Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N', `Delete_priv` enum('N','Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N', `Create_priv` enum('N','Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N', `Drop_priv` enum('N','Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N', `Grant_priv` enum('N','Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N', `References_priv` enum('N','Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N', `Index_priv` enum('N','Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N', `Alter_priv` enum('N','Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N', `Create_tmp_table_priv` enum('N','Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N', `Lock_tables_priv` enum('N','Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N', `Create_view_priv` enum('N','Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N', `Show_view_priv` enum('N','Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N', `Create_routine_priv` enum('N','Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N', `Alter_routine_priv` enum('N','Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N', `Execute_priv` enum('N','Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N', `Event_priv` enum('N','Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N', `Trigger_priv` enum('N','Y') CHARACTER SET utf8 NOT NULL DEFAULT 'N', PRIMARY KEY (`Host`,`Db`,`User`), KEY `User` (`User`)) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='Database privileges' CREATE TABLE `event` ( `db` char(64) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL DEFAULT '', `name` char(64) NOT NULL DEFAULT '', `body` longblob NOT NULL, `definer` char(77) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL DEFAULT '', `execute_at` datetime DEFAULT NULL, `interval_value` int(11) DEFAULT NULL, `interval_field` enum('YEAR','QUARTER','MONTH','DAY','HOUR','MINUTE','WEEK','SECOND','MICROSECOND','YEAR_MONTH','DAY_HOUR','DAY_MINUTE','DAY_SECOND','HOUR_MINUTE','HOUR_SECOND','MINUTE_SECOND','DAY_MICROSECOND','HOUR_MICROSECOND','MINUTE_MICROSECOND','SECOND_MICROSECOND') DEFAULT NULL, `created` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, `modified` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00', `last_executed` datetime DEFAULT NULL, `starts` datetime DEFAULT NULL, `ends` datetime DEFAULT NULL, `status` enum('ENABLED','DISABLED','SLAVESIDE_DISABLED') NOT NULL DEFAULT 'ENABLED', `on_completion` enum('DROP','PRESERVE') NOT NULL DEFAULT 'DROP', `sql_mode` set('REAL_AS_FLOAT','PIPES_AS_CONCAT','ANSI_QUOTES','IGNORE_SPACE','NOT_USED','ONLY_FULL_GROUP_BY','NO_UNSIGNED_SUBTRACTION','NO_DIR_IN_CREATE','POSTGRESQL','ORACLE','MSSQL','DB2','MAXDB','NO_KEY_OPTIONS','NO_TABLE_OPTIONS','NO_FIELD_OPTIONS','MYSQL323','MYSQL40','ANSI','NO_AUTO_VALUE_ON_ZERO','NO_BACKSLASH_ESCAPES','STRICT_TRANS_TABLES','STRICT_ALL_TABLES','NO_ZERO_IN_DATE','NO_ZERO_DATE','INVALID_DATES','ERROR_FOR_DIVISION_BY_ZERO','TRADITIONAL','NO_AUTO_CREATE_USER','HIGH_NOT_PRECEDENCE','NO_ENGINE_SUBSTITUTION','PAD_CHAR_TO_FULL_LENGTH') NOT NULL DEFAULT '', `comment` char(64) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL DEFAULT '', `originator` int(10) unsigned NOT NULL, `time_zone` char(64) CHARACTER SET latin1 NOT NULL DEFAULT 'SYSTEM', `character_set_client` char(32) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL, `collation_connection` char(32) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL, `db_collation` char(32) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL, `body_utf8` longblob, PRIMARY KEY (`db`,`name`)) ENGINE=MyISAM DEFAULT CHARSET=utf8 COMMENT='Events' CREATE TABLE `func` ( `name` char(64) COLLATE utf8_bin NOT NULL DEFAULT '', `ret` tinyint(1) NOT NULL DEFAULT '0', `dl` char(128) COLLATE utf8_bin NOT NULL DEFAULT '', `type` enum('function','aggregate') CHARACTER SET utf8 NOT NULL, PRIMARY KEY (`name`)) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='User defined functions'These are the first 4 tables in any standard mysql database.AlexOf the four tables, only "db" has any data in it, which concerns one entry relating to the rights I have to access and use the db. I have all rights on the server (localhost), from any machine, except for GRANT.In its behaviour, this bug looks very much like the JDBC bug crash that can be produced under the same modus operandi on Mac and which you also confirmed recently on x86_64.Alex(In reply to)Alex, could you retrieve a backtrace with symbols.You don't need to build here, just install libreoffice-dbg and follow the stepsof this link:If you don't have time, I'll give a try tonight.Anyway, thank you for your last feedback and don't give up for MacOs Build,you'll make it at the end :)Remember : the crash occurs when traversing down the table list that appears inthe left hand pane of the DSB, for me, it is systematically when I reach the4th table in the table list. The three previous tables display fine.The bug also reminds me of a similar problem we had a while ago with navigatingthe tree view listing of Basic macros which come pre-installed with LO. In thatbug, if you clicked anywhere in the middle of the list and started navigating,there was no crash, but if you started from the first entry of the list, acrash could be systematically reproduced after traversing down through the listafter about the third or fourth entry.Alex(In reply to)Am looking at doing that now :-)Eventually, with any luck :-))AlexPerhaps a dup of fdo#37529 ()? The stacktrace may confirm it.Createdfull backtrace(In reply to)The backtrace seems the same as 37529:- dbaccess::ORowSet::impl_setDataColumnsWriteable_throw- dbaccess::ORowSet::moveToInsertRowLionel: what do you think about this "naive" fix here:?Assuming it is a dupe of 37529, because same backtrace*** This bug has been marked as a duplicate of***In the daily build of 13/09/2012, I'm still getting a crash with an ODBC connection, so re-opening. Enclosing backtrace, unfortunately no symbols on downloads from dailies.AlexCreatedODBC crash traceTested on x86 with daily/Linux-x86_10-Release-Configuration/libreoffice-3-6/2012-09-13_10.35.29/libreoffice-3-6~2012-09-13_10.35.29LibO-Dev_3.6.3.0_Linux_x86_install-deb_en-US.tar.gzAlex, (In reply to)This build does not contain my fix for. Please retest with a later daily build.See in file:tinderbox: pull time 2012-09-13 10:35:29that's before my fix was committed to libreoffice-3-6 branchAlso: core:0c3fcef9e38726b03e91aaeb2bb0817bc4f3769dIf you look at, you see that this commit is before mine:*** This bug has been marked as a duplicate of***
id=54157	This is the meta issue to track the most annoying bugs in LibreOffice 3.7.x releases. It helps developers to concentrate on bugs that are most important for users. Also it helps users to be aware of potential problems.If anyone wants to raise a bug as “most annoying” for the release, please add the ID of that bug to the field “Depends on”, and don’t forget to leave a comment here that explains in a few words why that bug should be privileged.For details, criteria and further instructions, please see A first nomination: “- CRASH on launch when loading local libiconv.2.dylib ("liblangtag.0.dylib requires version 8.0.0 or later, but libiconv.2.dylib provides version 7.0")”.This bug makes it impossible to test the daily builds on MacOS X.I added all who were in CC for "- LibreOffice 3.6 most annoying bugs" to CC here, please feel free to remove yourself if you do not want to get info concerning latest 3.7 MAB.Add "- CRASH - opening database report" - RegressionAdd "- MAILMERGEe-mail as PDF sends damaged documents", what makes Mailmerge assistant unusable for e-mail as PDFRemoved("CRASH - opening database report") again, because it is now already listed as an LibO 3.5 most annyoing bug.Nominating: PRINTING comments in Writer inline or WYSIWYGIt's not bug, it's an enhancement, but since I saw you are working on Writer comments in 3.7, this would be nice bug to solve.Lo can't print comments WYSIWYG or inline, it adds them to page end or document end which makes it less usable since you have to search text for line on which comment is reffering (you have to count lines, there is no marker).I was in need of this feature today since I printed revision of contract on which I had a lot of comments.LO has great commenting system (same as Word) but horrible comment printing which should get this much needed upgrade.drop- move it to 3.5 MABs where it belongs; the lowest version with the bug should be used.Added- “CRASH when accessing "General" tab of file "Properties" dialog ("File > Properties...") for any saved document”AddingHybrid PDF export are corruptedadding- LOdev 3.7 won't install. Error 1935. this affects 24 Sep build. previous 3 buils did install.Adding- “Letter spacing and ‘expand single word’ do not work anymore”.Not the most terrible bug in the world, but a blameful regression, which would make MS and AOO folks laugh at us and our users angry with us, introduced between 2012-09-20 and 2012-09-24.Adding- “UI: Hang when accessing ‘Insert > Manual Break...’”.Endless hang, at least on Mac OS X. Introduced between 27th and 30th September.Add "- CRASH when create or modify Character Style or Paragraph Style"Add "- UI: Find Bar incomplete, empty, input pane is missing". Ease workaround using "Find & Replace", but no working 'Find' is a serious limitation. Confirmation for Mac / Linux still missing.(In reply to)Really added it. Now also confirmed for Linux and Mac OS.I add "- EDITING: CRASH when Format Cells (menu and Context menu)"; unthinkable to release without possibility to format cellsAdded- “CRASH when accessing ‘Tools > Outline Numbering...’”.Makes complete outline numbering feature inaccessible. Regression introduced between 2012-09-27 and 2012-10-04.For the record:Markus Mohrhard has added- “saving with password removes all content”. (Thank you, Markus, for emphasizing this important issue!)Adding 2 master regressions. Both have been git bisected and first bad commit identified.1.- FILEOPEN PPTX image background rendered incorrectly. Currently reproducible in Windows, but not Linux. (No Mac to test)2.- FILEOPEN existing document: 2 columns Table of contents exceeds page width. Affect both Windows and Linux.Add "- CRASH when closing specific .odg files", many Drawings affected!are we going to rename this meta-issue as LibO 4.0 MAB?We have no builds with that Version, no 4.0 Version in Bugzilla, so currently please leave this one as 3.7 MAB tracker.Please adapt all relevant tools to 4.0 (renaming or creating new ones) simultaneously after that has been reasoned and some notes have been left in the Wiki.Although the latest 4.0 code is simply further development of the Master, it might be appropriate to create a new 4.0 Master Version for Bugzilla and leave 3.7.0.0.alpha0+, because for most users it will be worrying to have lots of bugs for Version 4.0 (due to vrsion picker) without any 4.0 Version mentioned in the comments.I add "- FILEOPEN particular .docx shows all text frames filling complete page size and more", what makes lots of .docx unusableI add "- No WINDOWS daily Master builds available for QA"Added- “LOdev 3.7.0.0.alpha0 daily build does not start at all: system liblangtag.1.dylib not found”.This makes the current master builds for Mac OS X completely worthless: I can not do any QA work with master builds as long as this bug exists.I add "- CRASH when scroll down on (Writer) HELP contents - Common Help Topics - General Information - General Glossary"Added*- “UI: Visual glitches with the new Widget Layout: Buttons cut off in ‘Insert Table’ dialog”*- “UI: Visual glitches with the new Widget Layout: cursor does not blink in ‘Name’ field of ‘Insert Table’ dialog”Both bugs seem really minor, but I add them following a suggestion by Caolán McNamara. Similar visual glitches appear in many other dialog windows, and there is a chance that fixing these two bugs will improve the look of the other dialogs, too. This is why these two bugs are quite important, and are added here.**** Renamed to “LibreOffice 3.7/4.0 most annoying bugs” *****Because LibreOffice 3.7 has been renamed to LibreOffice 4.0 now, we have to adapt this meta bug report accordingly. But it would be a bit irritating if we would simply rename it to “LibreOffice 4.0 most annoying bugs”, because it has started for version 3.7, and all comments talk about “3.7”. On the other hand it would be (IMHO) overkill to create a new, separate “LibreOffice 4.0 most annoying bugs” report; this approach would (falsely!) suggest that 3.7 and 4.0 were different versions and branches.Therefore the best solution (there is no perfect one!) seems to follow Rainer’s suggestion atto rename the present meta bug to “LibreOffice 3.7/4.0 most annoying bugs”.One could argue that this name is a bit irritating in itself, but this timethe irritation has the advantage to remind us (if we ever manage to forget it ;-)of the version history, i.e. of 4.0 being the continuation of 3.7 ...I hope that everybody can live with this solution :-)Added- “Mac OSX Daily installation package to small and invalid”.Tinderbox 27 seems to produce invalid daily builds.Adding some confirmed regressions:*- VIEWING of particular DRAW OLE object incomplete, pixel picture in it is missing*- OLE Pictures are not displayed*- Font list is unsorted in 'insert special character' dialog*- Wrong text rotation in SVG Export (rotated text appears as non-rotated)Still UNCONFIRMED:*- UI: Cell formatting dialog shows characters as squares for some languagesI add "- UI: Master pages styles change view to "Default" instead of being applied", because a very basic function is broken what makes impress more or less unusable for creation of new presentations.I added. I'm afraid it's also a bit of an enhancement, but a very much needed one.Cropping in LibreOffice Writer is pretty much impossible the way it's currently implemented, and someone actually showed this issue to me as the reason they don't use LibreOffice.Removed- please add MAB's to the open tracker of the lowest version they are found in: in this case 3.5 (at). This helps us have a good view of bugs specific to each versionI add "- Wizards for Fax and Letter do not work", I think we can not ship 4.0 with such a visible bug.I hesitated quite a while to add "- CRASH when FILESAVE .doc as .html", but its a crash and not a too exotic action causing the crash.I add "- EDITING: CRASH when manage conditional formatting - double click range"Add: crash when creating a Table of Contents.Createdread error on picturesComment onread error on picturesnot a .txt, not a patch, seems to be here accidently, I will open a nw Bug for thisAdd "- UI: Conditional Formatting for cells shown incorrectly and and incompletely in CF dialog", we can't ship 4.0 without ability to edit CFAdd bug 56058 "FILEOPEN: LibreOffice cannot open .docx file in strict variant"This should be solved soon, because with release of Word 2013 such files will be produced from those who care of standards.I add "- EDITING CRASH in menu 'Format - Conditional Formatting - Contition - Condition'", looks like a blockerI add "- BUGZILLAASSISTANT: Submit fails with error message "It looks like you didn't come from the right page ..."". Although it's not directly related to this LibO version, it would be a bad setback for pre release testing of 4.0 to have no BSAI add- autocorrect entries in the [All] list are saved as English(USA).regression from the 3.6.x branch... it can really mess up autocorrect language lists.I add "- FILESAVE in different path structure destroys relative hyperlinks": blocker!I add "- EDITING: CRASH when copy paste multiple pictures from file explorer"I nominate: comments in XLS files are shown in white on yellow, so unreadable.added- evil shape lifecycle issue causing import crashers for RTF, DOCX etc.I add- “FILESAVE: Creating a new document version no longer working”.An important regression, makes the versions feature completely useless.Reported and confirmed on Mac OS X, please test on other platforms ...I nominate( UI: Number dropdown list in Tools > Outline Numbering is empty) as this regression make Outline numbering impossible.I add "- FILESAVE as ppt and pps (MSO97): rejected by MSO with warning message". Completely broken .ppt export more or less a blocker?I add "- EDITING: PAGE FORMAT page layaut -> Only right -> CRASH" because of the regression with LibreOffice 3.6.I nominate "- CRASH when FILEOPEN particular .docx (MSO2007)" because of the regression with version 3.6.4.3.Adding- CONDITIONAL FORMATTING after copy/paste sheet only visible in 'CF-Manage', not in 'CF-CF', and without effectConditional formatting is a critical feature of a spreadsheet and it is not possible to copy sheets between files without losing the conditional formatting.The bug is partially fixed as copying within a file works in 4.0 beta 1, but conditional formatting does not appear in CF-Manage at all when copying between files.This makes it impossible for me to upgrade from the 3.5 branch.has been there forever and a day - it belongs better vs. 3.6 I think.(In reply to)Definitely right -- movedto 3.6 MAB list.I add "- CRASH when edit CONDITIONAL FORMATTING"I add "- : tools -> options -> advanced -> enable macro recording" because of the 'setting loss'. Can't find this feature in 3.6.4.3, so I think this is a 'new feature' of 4.0.adding- print dialog not shown. prints file directlyrecent regression with effect on a very basic and frequently used function.(In reply to)Works as intended. Not a bug.AddIf you select "impress remote" menu item by mistake and don't have android device to connect, the dialog window never close and you have to kill Impress loosing your last editing.I add "- FILESAVE as .docx: loss of page background picture (watermark)" because of data loss.I nominate "- [CRASH] new document, close without saving crashes Impress" because of the basic function to 'close without saving'... following I need to add this bug in mab4.0 and set priority to 'Highest' and 'Critical'.Add "- FILEOPEN .xlsx: "IF" condition not calculated": very basic function, additional functions might be affected.I add "- Extensions Update fails with error "Cannot create folder"": it's a serious problem that LibO lost ability for Extensions update.Would like to suggest addingThis regression results in significant visual differences where a user has depended on derived formats for calculated cells. The intention in 4.0.0.0B2 is obviously to follow what happened in 3.6.n.n as the expected derived formats do appear when sheet layout is changed - see issue report for details(In reply to)Yup, it sounds like an important regression.(In reply to)Really added ;-)I nominate"Copy and paste chart fails if the source sheet does not have the default name" as it make impossible to cleanly move a chart if the sheet has been renamed.Nominating: cannot open .odt files on CIFS (Windows share) filesystem.Add- create new Impress/Draw document, add slide/page, close without saving crashes Impress, Draw.Add- Install fails if .NET Framework 4.0 (Client) is not presentI nominate: links in spreadsheets broken by default (they don't update even if the user clicks yes to update them)Adding- VIEWING: Pages do not have a drop shadow. UI regression, no document shadow and bad visual glitch.I nominate "- EDITING: Copy 4 or more slides then crash" because of the regression with 3.6 branch;I nominatewhich is a regression: Inserting a section, inserts 2 sections with the same name.Nominatingbecause it makes it close to impossible to paste charts from Calc to Writer, with the only obvious workaround being to use older LibO version.Oops, wrong fieldNominatingIt is on MAB 3.6 already. Still valid for LO 4.0RC1.Add "- Wizards for Fax and Letter do not launch", very visible and might affect many users!I nominate- Paragraph styles line spacing does not stick. This bug is a very annoying regression which is preventing me from being able to upgrade from version 3.4.6. It is also very simple to duplicate.59516 = the MySQL native connector do not longer install with Windows 7&8,who uses LO as frontend to Mysql is out of buisinessI nominate "- [FILEOPEN][FILESAVE]: General Error while opening/closing .odt files" because of an error message every time you open/save an ODT file (Mac osx only)I add "- RTL VIEWING: Increasing size of dialogs to right or bottom causes artifacts": very fixible and makes new "resizable dialogs" feature more or less unusable for RTL UIAdd- Copy range cells and paste special as RTF in Writer does not workI add "- EDITING: CRASH when paste in outline view after SLIDESHOW". It seems that not many users are affected, but a crash is crash!addingit seems quite a serious regressionI'm nominating. Footnotes with headers enabled in a large document make it unusable and will cause it to crash. This bug is keeping me from being able to upgrade from version 3.4.6 and is very likely related towhich was recently fixed.Added. User profile is not imported to version 4.0.0. Users expect this AND nearly all users are effected. Hence I expect a lot of user complaints and a bad press, if this bug is not corrected.add sdremote deadlock:- it's pretty annoying to kill soffice remotely[sic] while presenting.I nominate "- LibreLogo: view -> toolbars: LibreLogo has name "Add-on 1"" because you can't find LibreLogo with it's proper name in the toolbar list. (it's now called "Add-on 1"). Because this is a big feature (already wide spread on blogs and fora) ... I nominate it to mab4.0Nominatingbecause it prohibits the use of Calc in version 4.0.0.1 for a large number of usersAdd 60012: Python stuff does not work in the release builds on MACAdd: calculation errors with localized Calc on some Linuxes. It afftects only some distros but it seems that it affects quite some people :-(I add "- TEMPLATE related: Page margin changes unexpectedly on page two": currently roots still unclear, but impossibility to create sane new Writer documents might affect may users.I have added. It is very important from translators point of view.Please fix it before release LO 4.0Add- FILEOPEN: Error reading file after inserting commentThe document can not be opened...PromoteCrash in Impress when inserting hyperlinkAdd "- Fails to update 4.0.0.0.beta2 By 4.1.0.0. Master"! Of course it is probably related to my PC, if not it would be very annoying. Anything I can do to help debugging before I uninstall 4.0.0.2 to get 4.0.0.3 on my PC?Adding(BASIC: Can't set an object to NamedValue structure) because it's a regression and there is no workaroundmany macros are brokenAdd 59259: Impress print freezes with some master pages. Too slow SVG conversion or too big resolution?Add 60250: Broken mirrored page layout on the the 2nd page. IMHO, it might affect quite some users.I add "- PRINTING: TABLE borders, borders around paragraphs and footer, some graphic elements missing". Makes Writer more or less unusableI add "- EDITING: CONDITIONAL FORMATTING destroyed after copy-paste cell". For me that's a no goI add "- EDITING: Copy cells with CONDITIONAL FORMATTING formula with wrong references after paste" because of datalossAddingFormatting: Appears to have no effect on numbers. After loading a sheet one cannot change the formating of calculated cells. Workaround available but extremely confusing.I removedbecause it's a DUP.I add "- FILEOPEN: FORMATTING of value-related color, localized decimal separator and Currency VIEWING need Complete Recalculation": Simple workaround, but very visibleI would like to add(LibreOffice's support of the "recent documents" feature of the Windows 7 Start menu broken) because it is a regression introduced by 3.6. It broke a most covenient way to work with the Windows 7 start menu.nominatingas a regression in core handling of XAccessible caret and cursor events affecting accessibilityI nominateas it is a regression which make fields (like cross-reference) useless.Added. This bug with importance major exists already in Version 3.3.1. It's just time to solve this problem.I add "- Custom animation: only the first line is animated" to this list because of the regression, many affected people and very important (basic) function of a presentation.Saving a new document as docx results in corrupted file, whereas saving as docx from existing document does not.I add "- MinGW: Tinderbox @7 does not deliver 4.1 Master builds" together with "- Tinderbox @6 does not deliver 4.1 Master builds": Master regression survey completely broken for WINI add "- Show Variable field shows no content in Page Header/Footer, Frames, Sections": Makes LibO unusable for nearby any professional user, suspect for datalossAdding- [Template manager]: Can not copy styles between different files and templates- [Template manager] Creating new template directory is unnecessarily hard has various duplicates/closely related issuesAdd- [Template manager] [accessibility] UI broken for key board navigation- FORMATTING [accessibility] Tab/keyboard behaviour in dialog Conditional formatting strange(In reply to)replacing 61468 withregards accessibility of Template ManagerI add "- CRASH when FILESAVE particular .ods with links to other documents .xlsx"As per suggestion in the dev list - adding: On inserting New Row/column does not inherit the style of cells in tableAdded. I know people are not supposed to uninstall LibreOffice :) but it looks pretty bad that the uninstall dialog is filled with squares. This is a regression from version 3.6Nominating- LC_CTYPE instead of LC_NUMERIC used to determine decimal separator and native numberingNominating- Calc deletes current sheet, not right-clicked on sheet when trying to delete opposite directionality sheetsRemoving 48043 - this is a massively long standing bug that is not specific to 4.0 - it's unclear to me that it's a MAB as well - please nominate with a comment rather than adding to the deps list :-) Extending the MAB list is not a panacea, at some length people are no longer interested in fixing bugs in a huge bug list that can never be got under control ;-) On the other hand 53030 seems a much more suitable candidate - though is that a 4.0 specific issue ? if not it needs to go in the 3.6 MAB list.Thanks !On Thu, Mar 14, 2013 at 10:00:01PM +0000,wrote:Its MABness (rather then just ABness) can be discussed; this kind ofissues is a pet peeve of mine, but I kinda see your point. However, it*was* added with a comment:On Thu, Mar 14, 2013 at 09:48:51PM +0000,wrote:Michale Meeks added, -- FILEOPEN, FILESAVE, "Could not save document, error in writing sub document context.xml" then corrupt file. But that looks to be same issue asand--both listed as unconfirmed but with additional detail.in 60588 suggests this may have been improved with 4.0.2.1.Added- PRINTING: Do not print borderless tables if past from Calc because it's rather common activity.I add "- CONDITIONAL FORMATTING: formulas move TWICE the number of rows inserted or deleted", what destroys users' documentsI add "- particular OLE objects suppress PRINTING of .wmf", "- CALC OLE object PRINTING with missing cell borders"These unpredictable printing results make Writer 4.0 unusable for any professional working.I nominate, it is a dataloss bug in XLSX export filter.Added- this bug prevents users from removing text from draw and then resave a document. Text reappears upon opening document again (despite a save looking like it happened)I have additedbecause it is here since 4.0.0.3 and a lot a pleople have reported it as a marked dup, also it doesn't look good.Nominating: Personas doesn't work anymore. A new functionality completely unusable.- The Amazing Moving Tab StopsThis is an MAB because the user cannot open a file he saved without having to change the formatting.(In reply to)Sorry, I remove it for now, because it is still UNCONFIRMED.addingCurrently, using Word completion is more an annoyance then an advantageI add "- SVG Export ignores line width", what makes SVG export totally unusable.adding 63142, even the most trivial presentations use bulleted lists and without being able to promote/demote items this is breaking basic functionalityadd- Linked contents from external source (web page or local file) not updated (edit) various duplicates (and issues looking as such)I nominate.Although this bug is fixed in Master it should be cherry picked to 4.0.3 ASAP since Marketing made a big deal about this new feature and now it is broken (not LO's fault but still looks bad that it doesn't work at all)Createdillustration of loss of Master slide format/layout when saving as pptxIf editing/saving as pptx, Master slide format and layout is lost. Text is still there but in text boxes outside the Master format, thus requiring to be recopied/repasted into the Master layout - big timewaster. Does not occur if edit/save and re-open in .odp, but apparently impossible to save as pptx without loss of Master slide formatting.Also impossible to edit Master font size if saving as pptx - that's a different bug of course! haven't reported it yet.(In reply to)This is(In reply to)This bug does NOT occur if file is saved as .pptThus bug seems related to pptx format onlyLorraine T: thanks for nominating a bug - please don't discuss details of that specific bug inside this tracker bug, and please don't attach any test files here either, otherwise this tracker issue will become a mess. You need to file those details in a separate issue, and attach them there - also, it is best to nominate an issue with a single comment and link to the bug, and let another QA person add it to the DependsOn list. Anyhow - thanks for your work !addedand marked it as a blocker bug. It appears like a certain group of our users cannot use presentation at all in LibreOffice 4. Everyone is getting the same error messageI'm adding 60651 as we are still having EMFPlus issues with Visio images. Many of the issues are being looked into/fixed byand, but still some issues.I am adding, it is extremely problematic for OSX users (and apparently some Linux users), and seems to be linked to page size defaults, which in turn causes printing to screw up. Unfortunately, it has been around since LO 3.3.x, and was reset in the initial bugzilla clean-up fiasco. Since then, it has languished in purgatory.Added- serious scaling issue exporting WMFs to PDF.There are many bug reports for images in .docx. Here isbut it shouldn't be here, rather on MAB 3.6, so I move it there.Nominatingas such regressions are not acceptable in professional software.- Writer corrupts DOCX file containing TOC, recovery not possible with Office 2010 - shouldn't be here, rather on MAB 3.6, so I move it there.addingFILE SAVE: A newline is added after pictures (anchored as character) when saved as doc fileeven suggests that it affects also some fields.Anyway, a nasty one, that didn't (for me and OP) occur in 4.0.2I nominate. Rows to repeat are written correctly, but they are wrong set, when open the document. You can see from the lots of duplicates, that many users are affected by this bug.Hate to submit this with all the more major bugs. The Help on Writer Default Templates needs to be updated to 4.0.3. The Help text does not relate to what is displayed in the Menu. BTW, love the ability to "export" to a PDF. Don't lose it! Thanks for all the great work you do!!!Nominated- relatively simple image(s) in a docx format, re-saving it in LibreOffice corrupts the image(s) - Microsoft Office spits out a corruption error and the resulting recovered file looks terribleadding- IDE object catalog latency on big librariesWaiting a couple of seconds trying to switch tabs in the Basic IDE is too much- it has always been unnecessarily cumbersome to move rows around. Excel has a context menu option called "Insert cut cells", which I miss dearly in LibreCalc.Adding- Macros: macros allways disabled in files created from templates when working via Templatemanager: File > New > TemplateAdding- Edit > Select All doesn't work on a document beginning with a table.It's more than 2 years old. Is it that hard to fix?seems to be a candidate to me: its a regression of LibreOffice 4.0.4 vs. previous 4.0.x versions. Not yet marking it as blocking this one as it needs confirmation still.Really addedto the list.Hi,I would like to nominate: "- request new feature: ability deleting borders of cell from adjacent cell". Beside of the titel IMHO it is annoying, because the right border of A1 != left border of B1. This is unlike Excel handels and not intuitive.(In reply to)Do we really want to add enancement requests here? Especially such ones that least some people feel are a low priority ones ()?I would like to nominate a major regression from 3.6 -> 4.0- [Template manager]: Can not copy styles between different files and templatesThe new template manager lacks some features, which the old one has... People can't upgrade from 3.6.7 until this is fixed...addVIEWING: Particular border style and width invisible for zoom 100% + Scale 100% there is more to this than some borders dissapearing at various zoom levels, there are some horribly artefacts, seeadded" FILEOPEN: 8 page word document only displays page one" It is a regression since 4.0.x and only opens 1 of the 8 pages.I am nominatingThis is a major blocker that will not allow users with languages with multiple diacritics on characters to be able to use Libre Office.In short, these characters will disappear when preceding characters in the same word are formatted (bolded, background color changed, etc.). Some good test cases are on the original bug list.Regression from 3.6.x as the problem did not exist there. Same problem in Windows and Linux.Update, I have just seen it started *after* 4.0.0.3 (a colleague was able to confirm that Windows 4.0.0.3 does *not* have this problem)(In reply to)Bug inherited from OOo, no regression, existing workaround. So not a MAB as proposed by several comments. And, as fixing it require large changes, it will not be fixed in 4.0 branch which is almost at its end-of-life.add- FORMATTING: Turning on and of direct Bold or Italic in one paragraph, changes that attribute in the next paragraph, when the style there does have Bold or Italic (edit)I add:- FILEOPEN: PPTX import with shapes causes text to disappear.Text on shapes seems like a common scenario for PPTX import and so it should work. Currently, the text is lost. The same PPT works just fine so this isn't the problem of a missing LibreOffice feature, just a bug in import.Adding, when save file as DOCX, date and time fields become static text ("Date (fixed)", "Time (fixed)").Adding- EDITING: insert sheet from file - 'modify link' feature not working. And it is not saved.Added- PIVOTTABLE: Pivot table reset sorting after editing layaoutAdded.Named ranges are broken after delete a sheet, and undo delete step doesn't recover the name range.Hereby I nominate: "- DATALOSS: Graph data tables swapping data in x and y axis in writer documents resulting in incorrect graphs"Please reviseNominating fdo#41169 -- it breaks all keyboard shortcuts on all non-latin layouts hard on Gnome >=3.6. Strictly speaking, this is an old bug, but with newer Gnome versions being widely used, it is gaining a lot of relevance.Bug fdo#71409 Excessive duplicate accessible focused events for Calc input lineUsing repeatedly F2 and [Enter], enter data becomes slower every time. At the end you need to close and reopen the file to work with it.is simple to reproduce and consistently limits the number of times I can save and reopen an xlsx file without manually fixing all formulas which include the CEILING function. The unconditional adding of ",1" to the end of the function parameter list each time may be a simple mistake somewhere in either the saving or opening code.Its annoyance is not related to its simplicity as much as its effective and consistent limiting of the number of times the file can be modified, closed and reopened without manual intervention. It was initially reported against 3.3 and is still present in LibreOffice 4.1.Nominated- Inability to install to separate drive on Windows if you don't install all components. I'm surprised that this one snuck by for so long - it was unconfirmed for over a year :-/ That being said it has been around for a long time (possibly since branching from OOo) but I think it deserves MAB position. If you do a custom install and deselect a component you lose the ability to install to a custom destination. Additionally if you select a custom destination first and then later deselect the component it installs to the right drive but then it's a corrupt install and you can't run LibreOffice.added- EDITING: Frequent freezes when scrolling large document with many picturesregression of the 4.0.x branch. works fine in 3.6.7Remove developer list for bulk change.Readding developer list.Added- FORMATTING: Negative indents in styles not saved properly. This regression bug makes Impress in 4.0 and later unusable for any presentations built with a negative ident style. I and other users affected by this bug are forced to remain with the 3.6.x series to be able to use Impress (which I do every single day for work), and it's a pain to recreate the styles if the file is accidentally opened and saved with a later version.Makes LibreOffice Writer unusable for scientific writing. References inside frames, for example figure captions, are broken.Continuing the cleaning of mab4.0. Only bugs not yet reported reproducible in 4.1 or 4.2 should remain.AddedFILESAVE: text doesn't fit into text boxes when exporting to .PPTXThis bug is a major interoperability issue with MSO, reported by many users.(In reply to)Please readCLOSING since 4.0.x reached end of life.all still open bugs have been moved to the mab4.1 list.please do not add anymore bugs to the current list.Hi all,The MAB docs on the wiki have been updated to reflect the newPriority-based system for categorizing bugs:The old MAB tracker bugs (mab4.3, mab4.4, etc.) will remain inBugzilla for historical reference, but should be ignored for currentwork. ......................FINAL mab4.0 STATS......................fixed bugs -> 156open bugs -> 0......................
id=55442	CreatedScreenshotToday I did several attempts to submit a bug, but I failed from Seamonky and Firefox browser (no others tested). Steps how to reproduce:1. Go to <>2. Click 'Get Help' -> 'Bub' Assistant appears3. Component = Drawing Sub Component = FILEOPEN version = 3.3.0 Beta2 Subject = paticular .CDR (7) shows pixel picture text contents blue instead of read Long Description: see at the end of the report 4. <Submit> Expected: bug Report Submission Actal: : I get Message "It looks like you didn't come from the right page (you have no valid token for the" ---- Long Description ----Steps to reproduce:1. Open attached "staefa.cdr" in LibO 3.6 Expected: Text is red Actual: Text is blue I created this document in 2001 and can't remember whether I scanned that or made a snapshot of a PDF or whatever else.Browser: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:15.0) Gecko/20120909 Firefox/15.0.1 SeaMonkey/2.12.1 <=>shows not more Bug reports with BSA since 2012-09-23, the day where we got the update for Bugzilla.@Rob:That's urgent, can you help?This is what actually returned by bugzilla. I transformed it into plain text.--->8---It looks like you didn't come from the right page (you have no valid token for the create_bug action while processing the 'post_bug.cgi' script). The reason could be one of:* You clicked the "Back" button of your web browser after having successfully submitted changes, which is generally not a good idea (but harmless).* You entered the URL in the address bar of your web browser directly, which should be safe.* You clicked on a URL which redirected you here without your consent, in which case this action is much more critical.Are you sure you want to commit these changes anyway? This may result in unexpected and undesired results.[button]Confirm Changes[/button]Or throw away these changes and go back to index.cgi.--->8---FromAlso, tested by submitted a new bug via this bugzilla interface, it sent a "token" field when doing POST post_bug.cgiIn conclusion, we need a token string. But I don't know how to get it in BSA.Possible solutions in my thoughts:(A) Change BSA to use Bugzilla REST APIBut this requires much works, both by fdo admin and libo sides.(B) Use Bugzilla API (XML-RPC)(C) Maybe some configurations / hacks to turn off checking for token will help. But this will be less secure and I don't know if this is possible.Or are there more possible solutions that I can't think of? Probably ;)Ouch, the "token" field is in page enter_bug.cgi?product=LibreOffice&bug_status=UNCONFIRMEDand appears as: <input type="hidden" name="token" value="$token_value">If only we could get it into BSA ...(In reply to)Beware! Token is NOT the same as in enter_bug.cgi (product selection page)CreatedUNTESTED patchOne of admins please apply the attached patch and see whether it works. Thanks.Createdfixes the bugThe bugassistant works again with this patch. As can be verified through this link:Can the website point back again to the bugassistant?I made an error with the patch I send. I committed the correct one now:Many thanks for Korrawit for the heads up.
id=52226	While working on a .docx or .xlsx file, pictures are replaced with "read error" message when opening file.Steps to reproduce are given here::1- started docx document in Office 2010 on Windows 7, added text, a fewpictures, and table of contents.2- opened docx in LO 3.5.4 on Mac Lion. Made various edits and added about 13jpeg photos using Insert > Picture > From File in various places in thedocument. I did crop one of the images in LO and edited a few with "Edit withExternal Tool" (Mac Preview rotation) and all seemed okay from those. 3- re-Saved the file as docx and dropboxed it4- re-opened the docx file at work today and got the following results. Probably all recent comments on this bugare also about the same bug. [Quotation fromcontinued: Results after step 4:]* MS Office 2010 will not open it now and says it has an error.* Libreoffice 3.5.4 on Windows 7 will open it, but there are read-error notices where the pictures should be. * I also notice that the file is 4MB, which would be small considering that manypictures. They would have been a few MB each. * Also, the few images that were added originally in step 1 are still present andokay. All other images are missing with read-error.----@okko7:Thank you very much for moving the discussion to a new bug report! I will see if I can reproduce (and therefore confirm) this new report ...(Changed 'Component' to 'LibreOffice', because not only Writer is affected, but also Calc, and maybe Impress).Another symptom of the horrific design behind image management.CreatedSample .docx file with missing images, created with LibO 3.5.5.3REPRODUCIBLE withLibreOffice 3.5.5.3 (Build ID: 7122e39-92ed229-498d286-15e43b4-d70da21), German langpack installed, on MacOS X 10.6.8 (Intel).To test, I used the steps given by Geoff King in:My results are even worse: I added 2 PNG images and one JPEG image to the page, and all three are lost: I only see grey rectangles with the broken image symbol and the red notice "Read-Error". The images also lost the wrap settings I added to them -- both the direction of wrap-around (Before or After or Parallel ...) and the distance for text from the image margins are missing, all reset to default values. Only the position and size of all three images seems to be correct.Updated Status and SummaryAlso REPRODUCIBLE with LibreOffice 3.6.0.1 (Build ID: 73f9fb6), German langpack installed, again on MacOS X 10.6.8 (Intel).Creating and editing an .docx file following the steps cited ingives me exactly the same results as said in.However, at least for now I can't reproduce the bug with Impress, so AFAIK Writer (.docx) and Calc (.xlsc) files are affected. (But maybe someone else can manage to reproduce this with Impress, to, so keep on testing ;-)I seem to have a similar problem on Ubuntu 12.10 with LO 3.6.2.2 : Since I started exchanging .odt documents between my system and a Windows system with Microsoft Office, using tracked changes and comments.Every so often my images disappear with the message "Read-Error" and the broken image icon.Version 3.6.0.2 (Build ID: 360m1(Build:102)) on Mint Linux Maya, same problem.BIG problem!FYI using Version 3.6.0.2 (Build ID: 360m1(Build:102)) on Mint Linux, problem remains.***has been marked as a duplicate of this bug. ***Issue is still present with Version 4.0.0.3.***has been marked as a duplicate of this bug. ***It looks like the problem is not specifically related to autosaving, but to saving in odt in general, since a similar problem was reported inand. The problem can be reproduced by:1. open and odt file with images2. change it3. save it (as odt)4. save as docx5. close the document6. open the docx version: images are missingIf step 3 is omitted, the docx file is OK.So I suggest thatandbe marked as duplicates of this one.Milos***has been marked as a duplicate of this bug. ***This issue has been there through all of the V4 versions up to 4.0.2.I can observe this bug every day : I receive docx files from colleagues which contain inserted images. I open them using LibreOffice and save them again as docx, usually using a different name, open them again : images have disappeared, either giving a read error or just an empty box ( I have observed both problems within the same file). When I open the resulting docx file with a zip programm and have a look in the mdeia folder I can see actually many imageXX.png or .emf files that either only contain a white rectangle or are corrupted. I have done this very fast after opening, I would guess before autosave has saved, the problem does not occur, so I actually also believe that this has something to do with the autosaving. This is a very annoying bug as everytime I return a document to a colleague all of the images are lost. I hope that this will be resolved rapidly. CheersOliverStill present in version 4.0.3, 'losing' images in docx and xlsx files severely reduces interoperability LibreOffice - MS Office.***has been marked as a duplicate of this bug. ***I notice the same and a DOCX file. If I save and keep it as ODT, no problem.I've not NEEDed to use DOCX. If ODT is not an option for you, I suggest that you use DOC as a temporary workaround.If you notice that graphics saved in DOCX with earlier versions of LO, please mark this as a REGRESSION in Whiteboard.Something odd in this reporting: I see version indicated as "3.5.3 release", but detailed reports shows "3.5.4" to be the earliest version the bug is observed. Please confirm if this is a mistake.Perhaps it was mistakenly indicated by someone reporting the bug for 3.5.5.3. As I've learn, the version indicated should be the first version the bug is noticed. In any case, please correct it to avoid confusions.Out of interest, please could someone else test using v4.1.0.1? Previously I had been able to reproduce this issue with a docx file easily, but after trying today I was unable to reproduce the problem and am keen to find out if this was a fluke or not. Tested on Win8 64bit.Thanks a lot for looking into this matter, Rob.I hope this time, the bug will get tackled sooner. Unlike my original report (), which went unnoticed for over 4 months and in the meanwhile the file from the download link had been automatically removed. ^^(30 days no download)I reuploaded the unchanged files toThe bug with the read error DOES exist in the official Pre-Release Version:----Version: 4.1.0.1Build ID: 1b3956717a60d6ac35b133d7b0a0f5eb55e9155OS: Windows 7, 64bit (but with the x86 executables, as the only ones available)Language: German for both----The saved and broken png-Image (rename *.docx to *.zip and open \word\media\) consists as before only of the first 8 bytes, a part of the png header, instead of the 8034 bytes of the original png.I padded the original png with zeros at the end to about 16KiB (i.e. all the same logical files and sizes, but physical filesize is bigger.) and when the changed document - removed/added a space somewhere - is saved, the picture gets saved without the zeros at the end, i.e. the filesize is read/computed from the png header before saving. () Therefore, it's not the physical file that is kept!Tracking the pn RAM andng contents/datastructure i debugging the program step by step should reveal, why only the first 8 bytes are saved. My guess for the bug:Overwriting or not setting the stored file length or using/setting/computing the wrong value. (including the one that is calculated from the png-header informations)I don't have enough time in the next weeks/months to setup the LibreOffice development tools and look into the source code, but if you can provide me a download link to the next binaries (english only would be OK), I can test it again on my PC for sure.Sry for the misplacement, it should read as follows:---Tracking the png contents/datastructure in RAM and debugging the program step by step should reveal, why only the first 8 bytes are saved.---I'll try to help but am not a coder on the project, apologies if I gave that impression. The debugging method suggested is probably beyond me right now (in skill and available time). Looking at the example files you've provided though, it certainly does look as though the PNG file only consists of the PNG signature as described here:(confirmed by loading the file in a hex editor and it matches perfectly).Have confirmed this does still occur in 4.1.0.1 under both of the methods described above.To re-iterate...METHOD 1:Ensure Save AutoRecovery information is on, and set to save every 1 minute to make testing easier.Open an ODT document with an image, save as DOCX format.Add a space to the document text.Wait until the automatic recovery save is performed.Save the DOCX file.Once re-opened the images will be missing.METHOD 2:Open an ODT document with an image, save as DOCX format.Export a PDF document, either using the button in the toolbar or the File > Export as PDF menu option.Add a space to the document text.Save the DOCX file.Once re-opened the images will be missing.This behaviour occurs when when Save AutoRecovery information is switched off.It should be noted I did not get consistent results with how many images were not displayed. In one of my first tests, all images were removed. In subsequent tests, just the image on the first page was removed.After reading, that no file specific content is saved and the 8 bytes are exactly the png file signature, I tried something else.Instead of a png file in the MS docx file I used a JPEG file (saved as such inside the docx * ) and got interesting results:When a read error occurs, the JPEG file is now an empty 8 bytes PNG file! The file name stays the same and only the file extension is changed to png. This means in my case, the PDF export most probably replaces a pointer/reference or the file content and overwrites it with an empty png datastructure.Files of the experiments can be found at.I see two (relatively) simple solutions to this problem:- Find the address of the JPEG datastructure in RAM and track it and all its references/pointers/members/fields. One of these gets changed when it shouldn't and you have the culprit codeline.- (As workaround) Make a deep copy of the complete, currently displayed document and use this for auto-save and pdf export. The PDF in my experiments was exported correctly.Please inform some other developers, who could work on this issue as it is really annoying having to keep a manual backup of all files, when working together with someone who uses MS Office with docx as standard file format and the Office Version might not be able to open odt files.* rename *.docx to *.zip and go to /word/media/ in the archivemoving this bug from the mab3.6 list to the mab4.0 list since 3.6.x is EOL and bug is confirmed in 4.0.x and 4.1.x releases.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***(This is an automated message.)Setting priority to highest as this is a 4.0 MAB. This is part of an effort to make the importance of MAB reflected in priority too.A college has just experienced a similar problem three times in the last week, all in the same .ods document. It probably happened during autosaves. The file has about 110 images, a mixture of svm and png.The missing images are represented as "<draw:image xlink:href=""><text:p/>" and the images also disappeared from the Pictures folder.This is with LO 4.1.1.2 running on Windows XP.I have not been able to reproduce the problem.I just came across this issue with most png images in a docx file, using Writer 4.1.5.1 (Build ID: e0a1805d063a472a7b281ae3977a26d42a48b20).Moving this issue to MAB 4.1 as 4.0 reached its EOL a while ago.The document in issue in 46547 now makes my LibreOffice write crash.SummaryThis bug has been confirmed in several versions on many platforms.gives steps used to reproduce with worse results than reported in description, andconfirms that those steps work in a different version.reports a problem exchanging .odt documents between systems;suggests the problem is with odt rather than autosaving and gives steps to reproduce problems with odt.reports problems with docx files and believes the problem is related to autosave.gives 2 methods of reproducing bugs when changing between odt and docx.reports problems with JPEG files becoming empty 8 byte png files and suggests two ideas for solutions.reports problems with ods files as well.***has been marked as a duplicate of this bug. ***still reproducible under Win7x64 using LibO 4.2.3.3 and 4.3.0.0.alpha1+Build ID: a1dd961c3093f5f7624e4d1f2240e9120fd13f23TinderBox: Win-x86@39, Branch:master, Time: 2014-05-06_11:47:48moving to mab4.2 list since 4.1.x is END OF LIFEAs a professional engineer I write many reports and most have the need for images. A picture is worth ....Because of this persistent bug I and many of my colleagues have given up using LO. I am an advocate of open source and I am keenly disappointed that this major bug has not been even allocated to anyone, let alone resolved.Like many things a bug often produces illogical results that manifest themselves differently in different circumstances. The only way I have found to make LO probably produce a report with images is to have all images saved somewhere, together with a decent picture viewer, and then to write the text leaving sufficient space on a page to accomodate the images later, but not in their correct position of course. Once all the text is in place and I have a saved docx then I re-open and insert each picture in its appropriate place, only ever moving forward in the document and ensuring the picture does not cause leaps from page to page. Fortunately the default wrap aids this process. Also make sure any page headings, footers, numbering and the like are done before putting in any images.. Then export ASAP as a pdf, which seems pretty reliable, certainly before you save... As you may imagine this process is pretty tiresome and a degree stressful. If I need to make further modifications then I use the Serif PagePlus publication software as that allows import of pdfs and subsequent re-export as pdf.From my experiences any deviation or similar that causes some significant structural change in the document seems to create a finite probability of one or more images being lost. I am not convinced this is just an autosave problem because of evidence without it. It is perhaps a possibility however that on occasion autosave does make changes, but it may be more likely that the damage is done already. But because the affected pages were not being visibly present it was not noticed that going back a bit and re-editing actually caused the problem. It is also likely that there is more than one error.Just to add to the story this 'image leak' problem occurs also when I am using a doc or an odt file. Sometimes it does not leak, but in the next hour my hopes are again dashed. I have never seen it happen on a one page doc with one image.Apologies for the lengthy message. I have really tried to use LO but my patience is wearing mighty thin. Please, please do something.This explanation hit the nail on the head. I agree and have been steering people like myself who use images in their docs away from LO for this very reason. It simply can’t be trusted. And like this person stated, IMMEDIATELY exporting to a PDF is the only way to ensure the desired result … but then no more editing without starting over at the beginning.(As a note, some functions in Tables have similar inconsistencies. I’ve written about this before, but had less than desirable results.)I do hope a copy of this note goes to every officer in the LO organization. Sadly.Otherwise LO is very good.From:Sent: ‎Thursday‎, ‎May‎ ‎8‎, ‎2014 ‎3‎:‎46‎ ‎PMTo: Croil HunteronfromAs a professional engineer I write many reports and most have the need forimages. A picture is worth ....Because of this persistent bug I and many of my colleagues have given up usingLO. I am an advocate of open source and I am keenly disappointed that thismajor bug has not been even allocated to anyone, let alone resolved.Like many things a bug often produces illogical results that manifestthemselves differently in different circumstances. The only way I have found to make LO probably produce a report with images isto have all images saved somewhere, together with a decent picture viewer, andthen to write the text leaving sufficient space on a page to accomodate theimages later, but not in their correct position of course. Once all the textis in place and I have a saved docx then I re-open and insert each picture inits appropriate place, only ever moving forward in the document and ensuringthe picture does not cause leaps from page to page. Fortunately the defaultwrap aids this process. Also make sure any page headings, footers, numberingand the like are done before putting in any images.. Then export ASAP as apdf, which seems pretty reliable, certainly before you save... As you mayimagine this process is pretty tiresome and a degree stressful. If I need tomake further modifications then I use the Serif PagePlus publication softwareas that allows import of pdfs and subsequent re-export as pdf.From my experiences any deviation or similar that causes some significantstructural change in the document seems to create a finite probability of oneor more images being lost. I am not convinced this is just an autosave problem because of evidence withoutit. It is perhaps a possibility however that on occasion autosave does makechanges, but it may be more likely that the damage is done already. But becausethe affected pages were not being visibly present it was not noticed that goingback a bit and re-editing actually caused the problem. It is also likely thatthere is more than one error.Just to add to the story this 'image leak' problem occurs also when I am usinga doc or an odt file. Sometimes it does not leak, but in the next hour my hopesare again dashed. I have never seen it happen on a one page doc with oneimage.Apologies for the lengthy message. I have really tried to use LO but mypatience is wearing mighty thin. Please, please do something.You are receiving this mail because: You are on the CC list for the bug.FWIW there's a reasonable chance this is fixed in 4-2-5/4.3.0I am sad to report that with the latest version downloaded yesterday that the problem with images disappearing is still present.I have tried using links instead to embedding images but with the same result.After saving when I come back and reopen my presentation the link shows but does not display a picture. If I duplicate the slide the image link works and the picture displays. When I close and return the link may or may not work. Or maybe some other link does not work. It is random. So- embedded images disappear at random. Linked images disappear at random.I am sad. I will have to use the product from Redmond Washington to get my work done. Running on Windows 8.1 will presently try on Opensuse and see if the results are better. If there is any change in the behavior I will post a note here.Hi BryanWhich version exactly did you test this on?CheersVersion: 4.2.4.2Build ID: 63150712c6d317d27ce2db16eb94c2f3d7b699f8 is what is on my laptop.I just now started L.O. and opened my presentation. Once again most of the links display pictures but some do not. The ones that do not display are different than the ones that did not display when I last opened the presentation.When I first started trying to build a presentation I embedded pictures only to have the pictures disappear entirely. With links at least the link info is there and I can duplicate the slide and have it work until the next time I save. then it is random as to what works and what does not the next time I open the presentation.Thanks Bryan.We will be able to test this with 4.2.5 really soon an check if Caolán was right.Caolán, can we have more details about your assumption?Followingand usingI still reproduce the problem with LO 4.2.5.2.To reproduce:1. open the attached document2. change it (add a space)3. save it (as ODT)4. save as DOCX - WITHOUT CHANGING5. close the document6. open the DOCX version: images are missing(In reply to)Simple to reproduce - also with 4.3.0.2thanksUseful comment on role of autosaveComment with summary of some of the casesI've seen the problem recently with a writer document and a presentation. Not too complicated, both losing one of the images while editing.I've spend time and time to try to reproduce. Not..As I've written somewhere else in one of the many occurrences of this problem:Knowing that there are various in memory copies of a document, and in Impress maybe related to various views (side panel, normal view, slide sorter, ..) it may be well possible that there is a problem in synchronising those copies.This is supported by some other comments too.This will help to _not_ reproduce the problem ;) ... but alas neither is a guaranty that it won't happen, nor does it help as a reliable solution to do reproduce it..hmm, mywas meant forI can reproduce #41 so I will fix thatCaolan McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: fdo#52226 swap in graphics on .docx and .rtf exportThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "master":Related: fdo#52226 ensure graphics are swapped in on DrawingML::WriteImageThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.So, the reproducible one is fixed. The xlxs I cannot reproduce, but the speculative fix might resolve that if someone is able to reliably reproduce it for testing purposesCaolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-2":Resolves: fdo#52226 swap in graphics on .docx and .rtf exportIt will be available in LibreOffice 4.2.7.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-2":Related: fdo#52226 ensure graphics are swapped in on DrawingML::WriteImageIt will be available in LibreOffice 4.2.7.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-3":Related: fdo#52226 ensure graphics are swapped in on DrawingML::WriteImageIt will be available in LibreOffice 4.3.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-3-0":Resolves: fdo#52226 swap in graphics on .docx and .rtf exportIt will be available already in LibreOffice 4.3.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-3":Resolves: fdo#52226 swap in graphics on .docx and .rtf exportIt will be available in LibreOffice 4.3.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Coalan, would you please take a look atwhich looks a similar loss of image issue related to auto-save in Impress?the current fix forhad no effect on it, but I wonder if these 2 issues are somewhat related and fixable in a similar way.***has been marked as a duplicate of this bug. ***@Coalan: I wish to thank you for your work on this bug. I haven't had the occasion to test this yet, but do so as soon as possible. Out of curiority: Can you explain in a few words what that bug was about and maybe a bit about the magic you did to solve it? Thanks again!Createdscreenshot: reproduced in 4.3.1.1Hi all,This issue is not fixed. Today I reproduce in version 4.3.1.1 Win7, when I was trying to translate the LibreOffice 4.2 Guide in Writer:It seems images lost at the time when LO is saving auto-recovery info while you are editing the file *at the same time*. Set auto-recovery intevel to 1 minute to observe the lost of images (as I said, you have to keep editing when LO is auto-saving.)The patch is surely included in version 4.3.1.1, as it was build on 07-Aug-2014 11:20. So the patch may not solve the problem.Thanks!By the way, I do not reproduce in any way in version 4.1.6.2 release. In 4.3.1.1 it's very easy to reproduce. It blocks users from editing files with many images in it. Seems like a regression in 4.3.Should a new bug report be filed?please do not reopen bugs, file new ones, especially in a case like this where there multiple problems and a huge number of comments@Kevinif you open a new report please put the link to this one under "See Also"(In reply to)I filedto report the problem I reproduce in 4.3.1.1.
id=55413	I open a complex workbook with 21 spreadsheets liked to each other with formulas and it opens and works in LibreOffice 3.5.6. I can save, close and re-open with no problems.When work on the the same workbook in LibreOffice 3.6.2, save it, close it and re-open the same document a number of the formulas change as an extra line is added into the sheets during the save/open process.This breaks all the relative referencing in the cells and looks like an extra line has been added.This makes the 3.6.2 update useless. Could you please attach a test document showing the issue?CreatedThe enclosed document is an example of what happens when opening a document and re-saving in LibreOffice 3.6.xI have found this problem exists in 3.6.1 and 3.6.2I have not tested this in 3.6.0.The problem does not exist in 3.5.6 and I can open the same spreadsheet and it does not add an extra line close the the top of the sheet.I removed many sheets in the workbook and the problem is still present.I plan to try removing more data to see if any other factors are a cause.This is a drawing file and not a calc file. Are you maybe talking about a problem inside draw or impress?CreatedThis attachement shows the worksheet openen in 3.6, then saved and re-openedThe following attachment shows a sheet opening in 3.6 saved under a different file name and then re-opened. It adds and extra line in the spreadsheet and line 33.This is still a odg file! IF you want to save a calc file use ODS and not ODG.Comment onThis attachement shows the worksheet openen in 3.6, then saved and re-openedBy adding comments to line 33 and line 34 seems to stop the addition of an extra line at 32. I wonder if some has damaged the file causing the erratic behaviorCreatedAttachement of the spreadsheet after an open and save in 3.5 then re-open and re-save in 3.6This the spreadsheet that will open fine and line 33 is the word Name, after opening and saving in 3.6 the word name is now on line 36.CreatedAfter a re-save in 3.6 seems to have gained some linesThis is the after saving in 3.6 Name is now on line 36 the only change was open and save with different name.Changing the contents of Cells A31, A32, A33 and A34 seemed to solve the problem.Just testing this on the main document with the work-around.Yep, that worked. Something in the spreadsheet caused LibreOffice to think that an extra line existed somewhere between line 32 and line 35.and when I remove the comments in row 32 and row 33 the problem comes back and an extra line is added at row 32.This just rather random but reproducible.I will leave using LibreOffice 3.6.x as this will cause problems.In LibreOffice 3.6.1.2.Create a new spreadsheet.Fill rows 2 to 15 with a series starting with 35 and going up to 50.Insert a row and keep inserting rows until the number 35 is on row 35.Save the sheet and close it.Re-open the sheet, the number 35 is now on row 37.Now that is a problem.Just followed the way to repoduce the problem as described inin LibreOffice version 3.6.2.2.After reopen the file there was not added an extra line.So maybe this issue is solved now?I have downloaded and test 3.6.2 and the issue is still present.Open the original file and save it with a different file name then open the new file the extra line is still added creating a problem with the formulas in the spreadsheet.Release 3.6.2 does not solve the problem.Thanks for the update.I have re-tested the method used and can not reproduce the problem.I can open the spreadsheet uploaded save it with a different name and reproduce the problem.contains a spreadsheet with the problem.If you could please review this is may help isolate the problem.ThanksCreatedFile before save as, this file contains the correct line locationsThe file is the file version saved in 3.5 without an extra line.The attachment inseems to be a broken file check filteype with file----------------file Pricing\ 2012\ J6.odsPricing 2012 J6.ods: XML document textcheck integrity with zip :----------------zip -T Pricing\ 2012\ J6.ods zip warning: expected 16 entries but found 13zip error: Zip file structure invalid (Pricing 2012 J6.ods)-> Trying to open this file opens the dialog for textimport.So I can not do any more testing with this file.After saving the attachment inwith a new name and reopend the file I can reproduce the problem.BUT : After deleting the comment in cell D-31 and saving with a new name and reopening the new file there are no extra lines and everything is fine.So it seems the comment causes the problem.I can confirm that deleting the comment solves the problem.Showing it, changing it is not enough.Adding a comment on row 31 (tested on column A,B C,D) seems to be an issue.Adding a comment on row 32 does not cause a problem.How did you discover this as a solution?Thanks for nailing this down.is useful to reproduce and even fix this problem.It is a nasty bug and I hope that we will fix it soon. Well, I am not aware of other similar bugs, so it looks like less typical scenario. The bug was already in older 3.6.x releases => we should not block 3.6.3 with other useful fixes => lowering the severity a bit. I hope that we could fix this for 3.6.4 because it is regression and potential data loss.Whatever it was, it appears to be fixed, tried in 4-1 and 4-2.
id=55447	We want BBQ! Can confirm this.Do something about it!No BBQ, because Alex is lame!Pizzzzzzzzzaaaaaaaaaaaaaaaa ;)Only lamers don't do BBQ :P(In reply to)+1 :) BBQ is for losers ... ;)Grillen?;-) GeraldJaaaaa!!!!!!!Am 29.09.2012 17:46, schrieb:>>>Jipidipiduk Käääääääääääääääääääääääääääsekrainer pls...Is this fixed yet? Srsly, this was assigned a year ago, did this Alex guy at least got the fire going? If this isnt getting the attention it deserves, I as a user will not grill with you anymore and not recommend your free BBQ to my friends and instead go eating in a exhilarating expensive and overpriced restaurant in protest.This will teach you!!1!(In reply to)Ask Florian. It's his personal note, when he doesen't get something to eat during a LO-weekend in Essen (you know: the town "Essen", translated to English "Eating").I will close this bug, because I have eaten enough there. It's not our bug.
id=55696	Createdscreenshot of the input chart (right) copied to the presentation, showing its data table ()This applies to the intel Mac OS 10.4 and Linux AMD64 versions of libreoffice, both 3.6.2.1 and 3.6.2.2. are affected. Here's the bug:1. create a chart with Y error bars (did not try X) from 2 columns, one with the values and the second column with the error bar values (tested "bars" and "lines")2. copy the chart to any other component, i.e. write, presentation, drawing3, the error bars get changed. A look at the chart data table in draw or presentation shows that the error bar values are now the same as the chart values.example (pos. / neg. error bars with same value or with different values)1;0.12;0.153;0.2turns into1;1;12;2;23;3;3in the chart data tableI think this bug is really impairing when you want to keep your chart a vector graphics as it should be.Thanks for your great effort, I me and my wife really like libreoffice. Same here with LO 3.6.2.2 when copy an chart with y error bars from calc to Writer. This seems to be a regression cause it works well in LO 3.5.7.Also open an .odt witch include an chart with error bars (from Openoffice) with LO 3.5.7 it is displayed correctly, but not with LO 3.6.2.2.bug still exist in in 3.6.3 when (tested with LO portable):- open an .odt- copy an chartThanks for bugreportPlease, attach odt or ods document that demonstrates this problemCreated(LO: 3.6.3.2 Build ID: 58f22d) The chart was copied from Calc to Writer and Impress.Note that, when you want "Paste special" (Edit -> Paste special) you get weird stuff from the list.Thanks for attachmentUsing second attachment, reproduced in 3.5.7 and 3.6.3 on RFR 17 64 bitand in 3.6.3 on Windows XP 32 bitBut not reproduced in 3.4.2, 3.5.0, 3.5.4 on Windows XP 32 bitTherefore regression, backported from 3.6May be already fixed in 3.6.4Bug is still present in LO 4.0 beta 2***has been marked as a duplicate of this bug. ***Actually this bug has been reported before,However, the assigned person of(Rafael Dominguez) seems to be not working on it, and has ignored my emails, so I wouldn't mark this new as a duplicate in the hope that someone else more proactive will take the lead.*** This bug has been marked as a duplicate of***
id=56315	  Thank you for your report – unfortunately important information is missing.Please readas it will help you find out what information will be useful to reproduce your problem.Dear Bug Submitter,This bug has been in NEEDINFO status with no change for at least 6 months. Please provide the requested information as soon as possible and mark the bug as UNCONFIRMED. Due to regular bug tracker maintenance, if the bug is still in NEEDINFO status with no change in 30 days the QA team will close the bug as INVALID due to lack of needed information.For more information about our NEEDINFO policy please read the wiki located here:If you have already provided the requested information, please mark the bug as UNCONFIRMED so that the QA team knows that the bug is ready to be confirmed.Thank you for helping us make LibreOffice even better for everyone!Warm Regards,QA TeamDear Bug Submitter,Please read this message in its entirety before proceeding.Your bug report is being closed as INVALID due to inactivity and a lack of information which is needed in order to accurately reproduce and confirm the problem. We encourage you to retest your bug against the latest release. If the issue is still present in the latest stable release, we need the following information (please ignore any that you've already provided):a) Provide details of your system including your operating system and the latest version of LibreOffice that you have confirmed the bug to be presentb) Provide easy to reproduce steps – the simpler the betterc) Provide any test case(s) which will help us confirm the problemd) Provide screenshots of the problem if you think it might helpe) Read all comments and provide any requested informationOnce all of this is done, please set the bug back to UNCONFIRMED and we will attempt to reproduce the issue. Please do not:a) respond via email b) update the version field in the bug or any of the other details on the top section of FDO
id=55715	Createdods , odt and corrupt docx sample filesProblem description: I am not able to save doc. with chart as docx format (MS Word 2007/2010 XML) because file is always corrupt.Steps to reproduce:1. create an chart in CALC and leave it open2. create a new Writer text document and copy-paste chart from CALC to WRITER3. save as docx4. open it in MW word or Libre officeCurrent behavior:- When docx file is opened in In Libre Office chart is missing.- When it is opened in MS Off Word 2003 error message appears: "There was an error opening the file"Expected behavior:correct docx file Platform (if different from the browser): Browser: Mozilla/5.0 (Windows NT 5.1; rv:15.0) Gecko/20100101 Firefox/15.0.1 In case of text only content docx file was correct for me.The problem still exists in LO 4.0.0.3 (portable) so I have changed the release to 4.0.0.3.Thanks for reporting.I followed your steps to create testcase.I can't confirm that it resolve in a corrupt docx, but I can confirm that opening the file using Word (for Mac 2011) result in an empty document. When you click in the document where the table should be, it selects an empty rectangle.Opening the file again using LibreOffice shows the table correctly.Tested using Mac OSX 10.8.2 and LibreOffice 4.0.1.2 rc.@bug reporter: the bug version is the old version of LibreOffice you can reproduce this behavior. Therefore I mark this again as a bug of 3.6.1.2.Kind regards,Joren-------------------LibreOffice is powered by a team of volunteers, every bug is confirmed (triaged) by human beings who mostly give their time for free. We invite you to join our triaging by checking out this link:There are also other ways to get involved including with marketing, UX, documentation, and of course developing -CreatedHow it looks like in Word for Mac 2011Sorry for the noise, I was copying the *table* not the chart as you said. I can fully confirm your behavior (corrupt file message in word and data loss when reopening using LibreOffice). Also reproducible using LibreOffice Version 4.1.0.0.alpha0+ (Build ID: 5fcb553c862d407aadb0320925723d3c2f70bfe)TinderBox:, Branch:master, Time: 2013-02-26_22:56:53This result in data loss and I think this is a very common used function. Therefore I mark this as Highest Critical and I'm going to place it on the MAB-list.Kind regards,JorenIs this bug related to #40594 ? From what I can tell they appear to be. I just wanted to include a reference here for clarity, but will leave it to someone with more knowledge to confirm if this is the case or not.(In reply to)Thanks for your search and comment Owen. Really appreciated. I read the bug report and at first I wouldn't mark it as a duplicate, but when reading this() it is almost sure this is a duplicate.Thanks to Owen we can mark it as such.@Bug reporter: if this behavior us still reproducible afteris fixed, please REOPEN this bug.Kind regards,Joren*** This bug has been marked as a duplicate of***
id=57030	Impress crashes when using custom shapes:- Open Impress- Add a Custom Shape (for example Up Arrow)- Save presentation (doesn't matter what format)- Close the presentation.It doesn't exit cleanly but gives a: Exited with code '139' Rob: On which env are you?Could you take a look to fdo#55974 (), it could be a dup.I'm using the master on Ubuntu 12.04 x86_64My master has commit 65d4e59fedc4ce6b0aa1ead3f55cecf5921a0c6f as last commit which is from 2012-11-05 21:39:36The file indoesn't crash here, so I'm afraid it isn't a dup.Rob, which platform are you using? Windows or Linux?Well, crash on exit should not break the release. It is suspicious, annoying, worth fast fixing but it does not break the primary function. So, lowering the severity a bit. Also adding Muthu into CC who is working on Impress as well.Rob: sorry in fact I don't reproduce this one. However during closing I've got this on console:Error: File /home/julien/compile-libreoffice/libo/sal/osl/all/debugbase.cxx, Line 138: unexpected number of 19SvxUnoTextRangeBase: 1; Expected: 0warn:legacy.osl:8194:1:/home/julien/compile-libreoffice/libo/unotools/source/config/configmgr.cxx:202: OSL_ASSERT: items_.empty()I have fixed the crash in masterChecked with 'LibO-Dev_4.0.0.0.beta1_Linux_x86-64_install-deb_en-US', Kubuntu 12.10. No error messages noticed on exit
id=57569	Createdpatch to LibreOffice 3.5.7.2 which fixed the deadlock in PyUNOProblem description: Setting any writable attributes of a PyUNO component (in my case a custom PyUNO component implementing the service 'com.sun.star.sheet.Solver') results in a dead-lock on Linux when the built-in GUI tries to set any attribute on the implemented PyUNO component. A detailed Apache OpenOffice bug report which points to a working fix to the problem:Using the above, I have applied a patch on LibreOffice 3.5.7.2 and it has solved the problem. I believe this patch should be applied in all released versions of LibreOffice. Current behavior:LibreOffice hangs completely.Expected behavior:Writing Python attributes from other languages (like C++) should not freeze the whole office package and it ought to work. Operating System: Ubuntu i take it the CPython GIL is not recursive?that code is obviously broken in that case.that patch you attached is identical to the ApacheOO SVN commitcited in the AOO bug. my understanding is that due to the messylicensing situation we can only apply that on master and the 4.0 branch,but not the 3.6 branch.thanks for pointing out this problem and its solution."i take it the CPython GIL is not recursive?"I suppose so... The patch has fixed my problem and it doesn't seem to cause problems."my understanding is that due to the messy licensing situation we can only apply that on master and the 4.0 branch, but not the 3.6 branch"Well, given the very trivial nature of the fix (it's merely swapping code lines), I find this rather weird.Please try to doublecheck you cannot apply this fix on earlier versions indeed.Thanks for your consideration.
id=57956	Problem description: Making drawings or presentation, it is often convenient to be able to adjust (scale) the character width (e.g. to make a word or a sentence look better inside a box, etc. Openoffice and Libreoffice have a function for this under the character formatting menu.Unfortunately, in recent LibO this does not work anymore (in the preview the text is scaled, but in the final display it is not). Steps to reproduce:1. Open LibO draw or presentation2. Create a text box, write something into it3. Select the text4. Select Format -> Character -> Position5. Set a scaling different from 100% for the character width (here you see the preview text getting larger for scales above 100% and tight for scales less than 100%)6. Press OK... and see that nothing actually changes!Current behavior:Text width gets scaled only in the preview, when you press OK to apply the formatting to the text in a text box, the text stays the same regardless of the text width scaling factorExpected behavior:The formatted text should increase or decrease its horizontal scale depending on the scaling factor being selected.Notes:1) This is certainly a regression2) This breaks the formatting of previously prepared documents and particularly of presentations (due to the fact that I am using text scaling in a template, almost all my presentations and lectures are broken and cannot be played properly).3) AOO is OK on this. Confirmed with LO 4.1.0.0-Master on Ubuntu 12.04 x86_64Sadly confirm on 3.6.4.3 (ID: 2ef5aff) @ Ubuntu 32-bitWhat's up, doc???Works Ok in 3.6.2.2 (ID: 360m1(Build:2)) @ Ubuntu 32-bitBug in 3.6.4.3 (ID: 2ef5aff) @ Ubuntu 32-bitRunning bisect on this one:git bisect start# good: [65fd30f5cb4cdd37995a33420ed8273c0a29bf00] source-hash-d6cde02dbce8c28c6af836e2dc1120f8a6ef9932git bisect good 65fd30f5cb4cdd37995a33420ed8273c0a29bf00# bad: [5b4b36d87517a6ea96ff8c84c46b12f462fc9a1a] source-hash-8450a99c744e9005f19173e4df35d65640bcf5c4git bisect bad 5b4b36d87517a6ea96ff8c84c46b12f462fc9a1a# good: [16b0b88cbd4ef0f51816e97277e40c5cf78f7bf9] source-hash-099198a4224778fe6e43f5dc13b5b9b1b4dc828cgit bisect good 16b0b88cbd4ef0f51816e97277e40c5cf78f7bf9# good: [f28b8f9a6c47fa59bf98fffe937a2f2db7a2445a] source-hash-a581d31b227623e09d2970a91214fda398f98edagit bisect good f28b8f9a6c47fa59bf98fffe937a2f2db7a2445a# bad: [114fd3b76bcba890e6d702d00cef910f1493c262] source-hash-64ab96cd15e52da88781e720d6f031dbcd0ba902git bisect bad 114fd3b76bcba890e6d702d00cef910f1493c262# good: [6af64581913aa7ce3fcf0890fe671830d416a6ea] source-hash-06a8ca9339f02fccf6961c0de77c49673823b35fgit bisect good 6af64581913aa7ce3fcf0890fe671830d416a6ea# good: [7e20e241c1d8819d8d5edb7894baeddde33f9d3a] source-hash-2c270eeff422ef93100376ce0717a131d4f3cc2fgit bisect good 7e20e241c1d8819d8d5edb7894baeddde33f9d3a# good: [62b2ae5ee4cc77ad0b399c5a716ef526023d13ab] source-hash-e9960f36675a025c0536dec30ae56c50f4adecb1git bisect good 62b2ae5ee4cc77ad0b399c5a716ef526023d13ab# good: [e7627bbadeb1ab2ff16757dd240d55c0023f8257] source-hash-5b195fbcf7a441aeb193f6abd08b877e580938e0git bisect good e7627bbadeb1ab2ff16757dd240d55c0023f8257# good: [48ad81cc86b8858bfaa923854139e56fce18d28a] source-hash-98a77cef93663a0ae41dcc2c2858b418aeaaa40egit bisect good 48ad81cc86b8858bfaa923854139e56fce18d28aLooks like this bug :***has been marked as a duplicate of this bug. ***Confirmed in 4.0RC1Confirming the severity of this issue. We had to roll back some users because this feature was a part of their work flow.I'm not 100% sure, but I think this is a related commit to this topic that might introduce the bug:range:Still broken both in 4.0RC2 and 3.6RC2.An additional glitch in 4.0RC2.The corresponding field for controlling this parameter, named 'scalewidth' and tunable as a % value, in 4.0RC2 appears under a heading that says 'Rotation' rather than 'Scaling' as it should.I can confirm that is it also broken in Writer:Version 4.0.0.2 .0.2 (Build ID: Gentoo official package)Looks like this went through in 3.6.5 final and 4.0 RC 3.Joren: Thank you again for bi-bisecting!I've bisected this, and it turns out that I've caused this:fa694a21b806ed7837c1337ec49a4b299c478393 is the first bad commitcommit fa694a21b806ed7837c1337ec49a4b299c478393Author: Jan Holesovsky <>Date: Fri Oct 12 17:41:49 2012 +0200 fdo#55931 Fix renderding of subscript/superscript with Autofit Text. We are using font metrics to compute the stretch ratio for autofit; but that collides with nPropr property of SvxFont - it is then counted twice, ie. in the case of nPropr == 25, we actually behave as if it was much less; and worse, only in the horizontal direction. Change-Id: Idba62f1e3f40802651b93f1344e376048866b1b6:040000 040000 cc99d0a8cdfa165747d486fc39154a03717e9c5b 0fc9636bb0a0ddcd9cecbaa5133e1983969f5f73 M editengCan look first on Monday, unfortunately not earlier.CreatedMinimal testcase.Jan Holesovsky committed a patch related to this issue.It has been pushed to "master":fdo#55931, fdo#57956: Fix both autofit and stretched width.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.I believe this is fixed now. The patch is pending a review for 4.0.I have been able to reproduce the bug in 4.0.0.3.But it has been fixed in 4.0.2.1 and in the daily build of today. Have set it to verified.@Kendy: Hmm, since this is appearing on 3.6.4 but the commit causing it was done after 3.6.0, is this a micro release regression, can we backport the fix?***has been marked as a duplicate of this bug. ***Fixed in 3.6.7, setting target:
id=57061	The personal data folder changed from LOdev\3 to LOdev\4 but nothing was imported (and the now useless LOdev\3 folder was left behind...)Maybe the \3 folder can be optionally left around (in case people want to go back). I would recommend that during install user input was requested. Something like "Your personal data has been migrated to version 4. Would you like to remove the outdated personal folder?"NOTE: This was observed in Version 4.0.0.0.alpha0+ (Build ID: a2b3ee)master~2012-11-13_06.07.28_LibO-Dev_4.0.0.0.alpha0_Win_x86_install_en-USfrom Tinderbox Win-x86@6 ***has been marked as a duplicate of this bug. ***Some more information additional info (confirmation for Mac by Roman, developers working on that, ...) from mailing listThank you, Pedro, for reporting this,and thank you, Rainer, for CCing me!REPRODUCIBLE also on Mac OS X (10.6.8, Intel) withLOdev 4.0.0.0.alpha0+ (Build ID: 32315e; pull time: 2012-11-13 00:32:26).This master build for Mac OS X correctly creates the user profile folder at ~/Library/Application Support/LOdev/4/user/ ^-- as expected. But it does NOT migrate any settings from the /LOdev/3/user folder to the /LOdev/4/user/ folder; not even the most general settings, like my user name, or the selected JRE appear in the /LOdev/4/user/ profile. It seems that the new (4) user profile is created from scratch, without attempting to copy any data from the old (3) user profile folder. → Changed Platform to All/All.→ Increased Importance: IMHO this is at least a “major” issue, because when LibO 4.0 will be released, most users will expect that all their settings are correctly imported, and we would get bad press if we would not do that.About the question: what to do with the old (3) user profile:(In reply to)This option could be a good idea. But if it is too complicated to implement such an option, please do NOT remove the old user profile folder by default; just leave it there! There always will be some downgraders, and other people -- like me -- switch between LibreOffice versions daily, just depending on the kind of task they need to accomplish.Random notes:* Migration of extension information (stored in berkeleydb files within the user profile) needs to coordinate with potential removal of berkeleydb support from LO, cf. <> "minutes of ESC call ..."* It appears that on case-insensitive file systems (Mac OS X, Windows), existing "3" user profiles got the "MIGRATED" flag file (<> "disable multiple migrations via MIGRATED stamp file") erroneously added when running LO 3 already, cf. <> "User installation migrated onto itself." This needs to be taken into account when trying to migrate from existing "3" user profiles.The idea to ask for user input is that LO/TDF passes responsibility to the user: if the user chooses to delete then s/he can't complain later that it was removed. If s/he chooses to keep it, s/he can't complain that there are left-overs.Hmm, the supported migration paths are configured in registry, see the"Migration" section atI see only the release versions there. It seems that migration from"Dev" builds has never been supported. I guess that Dev builds couldinherit configuration from a release build but not from the older Devbuilds.The best solution would be to produce build-specific registry entry. Iam not sure how to do it easily.Anyway, the migration should work in the official Alpha, Beta, RCbuilds.Bug still exists in versions 4.0.0.1 and 4.0.0.2.Reproduced with Win 7, 32 bit, LO version 3.6.4. Then install version 4.0.0.1.Also reproduced with Win 8, 64 bit and version 4.0.0.2. Importance increased, hence users expect that all their data and settings of the user profile are still available, if they update to version 4.0.x AND all users with changes of their user profile are affected.Hence I expect a lot of user complaints, if this bug is not corrected. Furthermore it will not really raise the image of LibreOffice especially at the start of a new major release (Version 4.x.x). IMHO it's necessary to correct this problem before the release of version 4.0.0.Harald - can you confirm that if you move away your user profiles; and run a released 3.x version - then run the 4.0 version - it does not import those settings ?FWIW - I hate this "not upgrading from -dev versions" thing - it was the underlying cause of tons of mangledness in this code for the last 3.x series releases and we need to stop distinguishing between -dev and non-dev releases wrt. migration I think [ perhaps having a different config directory for each -dev release ;-] But of course that requires some time + thought, and re-working the desktop/ code I guess [ I can't be working on this now sadly ].@Michael:Somehow this all is rather unclear, I wonder what moron made status here NEW ;-)The only fact that counts is whether a 4.0 rc makes the job to update from a 3.x user Profile (and it should do that for any user profile starting from 3.3, and also OOo Profiles should be imported as far as possible (at least some basics like personal data like name ...)All tests I see here are from Master(?!) and to be honest, I currently I do not know whether a LODev Profile is intended to be updated from where ever. I think this definitively is not an ...alpha+ Version's bug.More or less reproducible with "LibO 4.0.0.2 rc - GERMAN UI / German Locale [Build ID: 5991f37846fc3763493029c4958b57282c2597e)]" {tinderbox: @6, pull time 2013-01-24 07:20(?)} on German WIN7 Home Premium (64bit). The effects were obvious, all my Extensions, Macros, own toolbars, security settings and so on were lost.BUT===I did not check whether there might have been an existing /4 user profile from any test before, and so my result does not count. Of course an existing /4 Profile should not be overwrittenI will do an update test under controlled, clean test conditions Some additional thoughts and info:It might be risky all import all Extensions, there might be some not working with 4.0. Eventually they should all be disabled with a comment "please check ..."I did the Brute-force Method for my /4 Profile update and simply copied the /3 Profile to the /4 folder, and everything worked and all 3.6 settings were back after new launch of LibO.My request to Roman, Pedro, ...Can you please retry an update wit non-WIN-OS with definitively not existing /4 Profile from 3.6 to 4.0.0.2RC. All existing other profiles should be hidden to avoid interferences of our test environments (or explicitly state that your update was that way)?Hello Michael,I'm not sure if I understand your question correctly, so don't hesitate to ask me again if necessary. What I did is:(1) LO version 3.6.4 is installed on Win 7 as a standard installation (no parallel installation). User profile in directory /3.(2) Install LO version 4.0.0.1 with Windows Installer. The version 3.6.4 is removed automatically during installation. /3 user profile still exists after installation.(3) Start LO version 4.0.0.1. A new /4 user profile is created. The /3 profile still exists too. Data from the /3 profile have not been moved to the new /4 profile.Michael as I understood it, you asked me to run version 3.x and then to run version 4.0. In the procedure above, it is not possible to do this, hence either only ver. 3.x or 4.0 is installed.What I expect: From"You do not have to de-install any previously-installed version of LibreOffice. If you do have an existing installation of LibreOffice, all your preferences will be preserved and that old installation will simply be overwritten."Also please make sure that the file "MIGRATED" is missing in the directory with "LibreOffice 3" user configuration. It is created there once the configuration is migrated. The file prevents multiple migrations and helps to find what is the last used configuration.(In reply to)Agreed.This just shows that I bothered to do an early test of a Master and report it with 2 MONTHS in advance. This was ignored as "should work".Ideally this should behave as Firefox (check for compatibility/new versions)I tested that as well and it workedI can retry anything you need but on Win (XP and/or 7) only.It works for me. I have just tested it with the 4.0.0.2 build on Windows and the configuration was migrated.Note that I had to remove the file C:\Users\pmladek\AppData\Roaming\LibreOffice\3\MIGRATED and the already existing C:\Users\pmladek\AppData\Roaming\LibreOffice\4 configuration.I guess that the confusion here is caused by the MIGRATION file and Dev builds. Once you run 4.0 Dev build, it migrates the LibreOffice\3 configuration and crates the MIGRATED file in the LibreOffice\3 user config dir. When you install 4.0 release build, it ignores LibreOffice\3 configuration because it has already been migrated. Also it ignores LODev\4 configuration because it is from the Dev build and thus potentially broken.I am not sure what is the idea behind the MIGRATION file but it has been there for ages. I guess that it was introduced to avoid another can of worms when migrating OOo-2.x to OOo-3.x.Note that normal users should not be affected by this bug because they do not install dev builds.(In reply to)See: "It appears that on case-insensitive file systems (Mac OS X, Windows), existing '3' user profiles got the 'MIGRATED' flag file (<> 'disable multiple migrations via MIGRATED stamp file') erroneously added when running LO 3 already, cf. <> 'User installation migrated onto itself.'"See commit linked above.I had assumed that the issue with the MIGRATED file had been addressed (<> "minutes of ESC call ...": "Completed Action Items: need to rename the MIGRATED flag and unwind / test re-migration (Michael): apparently no need to do this - the new directory name takes care of it." But it does not look like the issue is addressed (and I fail to see how the new directory name, LibreOffice\4 on Windows, would take care of anything there).The best solution is probably to either (a) change the name of the flag file from MIGRATED to MIGRATED4 for LO 4 (MIGRATION_STAMP_NAME in MigrationImpl::alreadyMigrated in desktop/soruce/migration/migration.cxx) or (b) get rid of the flag file completely by effectively reverting the commit linked above. Case (a) has the advantage that, when migrating existing user profiles to LO 4 and such a migration leads to a broken LO 4 profile, the user can get out of that by just removing the broken LO 4 profile and starting over. Both cases have the disadvantage that if an old profile already caused migration problems once in the past (but only once, as it was flagged as MIGRATED afterwards), it may cause migration problems now again.I will take care to get solution (a) into libreoffice-4-0-0.@Petr:That's quite nearby what I wanted to test and expected to see in my laboratory, so I think there is no need for my announced test?@Stephan:Thank you for assigning to you!Tested on Mac OX 10.6 and recent LO 4.0.0.2: No migration, brand new /LibreOffice/4/ - folder.No "MIGRATION" file found in /LibreOffice/3/user/(In reply to)The file in question would rather be .../LibreOffice/3/MIGRATED (note both directory and file name are different from what you state).Started from zero on a Win7 x64 machine (deleted LibreOffice personal data folder)*Nothing* was imported from 3.6.4.3 to 4.0.0.2File .../LibreOffice/3/MIGRATED is present but it is NOT related to LOdev (this machine NEVER had Dev build installed)Stephan Bergmann committed a patch related to this issue.It has been pushed to "master":fdo#57061: Use a new MIGRATION4 flag file for profile migration LO 3 -> 4The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.requested backport of the fix fromto libreoffice-4-0 (<>) and libreoffice-4-0-0 (<>)Stephan Bergmann committed a patch related to this issue.It has been pushed to "libreoffice-4-0":fdo#57061: Use a new MIGRATION4 flag file for profile migration LO 3 -> 4It will be available in LibreOffice 4.0.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Stephan Bergmann committed a patch related to this issue.It has been pushed to "libreoffice-4-0-0":fdo#57061: Use a new MIGRATION4 flag file for profile migration LO 3 -> 4It will be available already in LibreOffice 4.0.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.I checked this problem again with 4.0.0.3. There is an improvement to version 4.0.0.2, but as I checked it is not completely solved.My System: Win 7 Prof., German, 32bitThis is what I did:Step [A]: Preparations in order to get a clean system:(1) All LibreOffice versions and help packs deinstalled.(2) Folders "C:\Program Files\LibreOffice 3.6" and "C:\Program Files\LibreOffice 4.0" don't exist.Some folders with LibreOffice administrative installations still exist in C:\Program Files. They are named "LibreOffice 3.x.x Parallel".(3) No existing user profiles, that means I renamed them to "...AppData\Roaming\XXX-LibreOffice"Step [B]: Installation of version 3.6.4:(1) Main installer, typical installation(2) Installation of German built-in help.All 2 packages are installed in "C:\Program Files\LibreOffice 3.6". Step [C]: Create and modify user profile with version 3.6.4:(1) Start LO 3.6.4. A user profile "...\AppData\Roaming\LibreOffice\3" is created. In folder "...\3" a file called "MIGRATED" has been created too !!!(2) Modify user profile, I did this: (a) Open an existing text file and close file. (Recent document) (b) Resize LibreOffice window (c) Change an option. I unchecked the option "Tips" (d) Open new text document and create an autotext and use it.(3) Close and start LO again. All changes of the user profile are still in effect. Close LO again.Step [D]: Installation of version 4.0.0.3:(1) Main installer, typical installation(2) Installation of German built-in help.All 2 packages are installed in "C:\Program Files\LibreOffice 4.0". Version 3.6.4 is replaced completely. The folder "C:\Program Files\LibreOffice 3.6" still exists, but it is empty.Step [E]: Start version 4.0.0.3 and check the user profile:(1) Start LO. A user profile "...\AppData\Roaming\LibreOffice\4" is created. The profile "../3" still exists. In folder ".../3 the file "MIGRATED" still exists. Additionally a new file called "MIGRATED4" has been created !!!(2) (a) Recent Document: not migrated !!! (b) Window size: not migrated !!! (c) Tips unchecked, migrated. (d) Autotext: migrated.(3) Close LO.(4) Rename profile "..\4" to "..\X4", rename "..\3" to "..\4".(5) Start LO 4.0.0.3. Now all 4 changes of the user profile are in effect.If you do the same procedure with 4.0.0.2 the result is different:(1) Start LO. A user profile "...\AppData\Roaming\LibreOffice\4" is created. The profile "../3" still exists. In folder ".../3 the file "MIGRATED" still exists. A file called "MIGRATED4" is not created. (2) (a) Recent document: not migrated !!! (b) Window size: not migrated !!! (c) Tips unchecked not migrated !!! (d) Autotext not migrated !!!(3) Close LO.(4) Rename "..\4" to "..\X4", rename "..\3" to "..\4".(5) Start LO 4.0.0.3. Now all 4 changes of the user profile are in effect.Conclusion: It seemed to me that parts of the user profile are migrated now (4.0.0.3), but not all. Hence bug reopened (with hesitation...)Excellent testing!(In reply to)I believe this proves that Migration CAN and SHOULD be improved.I opened a topic inbut no one seems to be worried or (HOPEFULLY) they are using their time to fix the problem instead of writing :)Thank you for reopening the BUG ;)I now also checked the migration of changes of the user interface (customizing). These changes are also not migrated. The general procedure is the same like in. First open a new text document. Then I did these changes in version 3.6.5:(a) Display of additional tool bar: View > Toolbars > Drawing(b) Display of additional icon in toolbar: context menu on toolbar Standard > Visible Buttons > New Document From Template(c) Change order of a menu: Tools > Customize... > Menus > LibreOffice Writer Menus: I just moved the item "New" below "Open..."After installing 4.0.0.3 the changes of the user profile made with 3.6.5 are lost !!!I do not know, if my problems according migrating the user profile are general problems. If this is the case I am not sure if it is a good idea to release RC3 hence I expect user complaints.Some general thoughts according migration from version 3.6.x to 4.0.x:(1) Is it not the easiest way just to copy (or rename?) the /3 user profile to a new /4 profile, if LO does not find a /4 profile at start? When I did this manually it always works for me. (2) The files "MIGRATED" or "MIGRATED4" are just confusing. As I understood they are necessary for development. Is it not better to banish them from a release version and find another solution for development?(3) Is it really necessary to use different folders for the user profile (".../3", ".../4", ...) when changing the first digit of the LO version? Is there possibly a compatibility problem? If not the "/3" or "/4" folder could be removed from the path.By the way: Does someone know if there is a forward compatibility of LO 3.6.x to /4 user profiles if they are renamed to /3? This may be interesting for users who like to go back from version 4.0.x to 3.6.x or for exchange of profiles between different systems or users.In reply toand:In general, what parts of an old user profile are migrated is controlled by configuration settings in the /org.openoffice.Setup/Migration tree (see officecfg/registry/data/org/openoffice/Setup.xcu). The data that is present there is apparently mostly what had been there for the migration from OOo 2 to OOo 3 already. The reason why certain parts of a user profile had been excluded from migration back than are probably lost to history.Note that this user profile migration code already kicked in on Linux during the LO 3 timeframe, when <> "fdo#32263" moved the location of the user profile from ~/.libreoffice/3 to ~/.config/libreoffice/3 and <> "default config location has changed, look in old config dir when migrating" enabled LO's migration code to migrate from an existing ~/.libreoffice/3 to a new ~/.config/libreoffice/3.Therefore, at least my assumption would have been that that migration worked acceptably, or else (Linux) users would already have complained when upgrading from old LO 3 versions (that used ~/.libreoffice/3) to newer LO 3 versions (that used ~/.config/libreoffice/3) about settings getting lost. However, re-checking that now, things like the list of recently used documents indeed were not migrated back then, either. Apparently nobody looked at the migration machinery in detail, whether it works acceptably for migrating individual settings to a new LO 4 user profile.Addressing specific items from the above comments:* List of recently used documents: This apparently manifests itself in configuration items (in the user profile's user/registrymodifications.xcu) in the /org.openoffice.Office.Histories tree, which is not included in the migrated data. Whether there ever was or still is any good (technical) reason for that I do not know offhand.* Window sizes: These apparently manifest themselves in configuration items (in the user profile's user/registrymodifications.xcu) in the /org.openofice.Office.Views tree, which is not included in the migrated data. Again, wheter there ever was or still is any good (technical) reason for that I do not know offhand, but the odd format in which this data is saved makes it not unlikely that this was considered too fragile for migration at least in the past.* Autotexts: These apparently manifest themselves as files in the user/autotext/ directory, which explicitly are migrated (cf. ".*/autotext/.*" listed in /org.openoffice.Setup/Migration/SupportedVersions['OpenOffice.org3+OpenOffice.org2+StarOffice8+StarSuite8+Libreoffice3']/MigrationSteps['Common']/IncludedFiles in officecfg/registry/data/org/openoffice/Setup.xcu), and indeed an existing ~/.config/libreoffice/3/user/autotext/mytexts.bau is copied to ~/.config/libreoffice/4/user/autotext/mytexts.bau and works fine in LO 4 at least when I try that out with my local master build on Linux. So this needs further verification.* View - Toolbars - Drawing: This apparently manifests itself in configuration items (in the user profile's user/registrymodifications.xcu) in the /org.openoffice.Office.UI.WriterWindowState tree, which is not included in the migrated data. Again, wheter there ever was or still is any good (technical) reason for that I do not know offhand, but, again, the format in which this data is saved makes it not unlikely that this was considered too fragile for migration at least in the past.* context menu on toolbar Standard > Visible Buttons > New Document From Template: This apparently manifests itself in the file user/config/soffice.cfg/modules/swriter/toolbar/standardbar.xml. The migration data mentioned above lists ".*/config/soffice.cfg/modules/.*/toolbar/custom.*\.xml", but that apparently does not match this file, so it is not copied. What's the story there I do not know.* Tools > Customize... > Menus: This apparently manifests itself in the file user/config/soffice.cfg/modules/swriter/menubar/menubar.xml, which is not included in the migrated data. Again, what's the story there I do not know.* "Is it not the easiest way just to copy (or rename?) the /3 user profile to a new /4 profile, if LO does not find a /4 profile at start?" While most of the old data could indeed be reused, a new major release is generally considered a good point in time for incompatible changes in user profile data, thus demanding more sophisticated migration than wholesale copy/rename. There is at least some changes (like changing bundled extensions into core parts, and changing the database format for information about installed extensions) that benefited from this for LO 4.* "The files 'MIGRATED' or 'MIGRATED4' are just confusing. As I understood they are necessary for development." No, see <> "disable multiple migrations via MIGRATED stamp file" for the reason the MIGRATED file got introduced. Having said that, I personally think that design is flawed, and we best get rid of those flag files again; I have that on my to-do list.* "Does someone know if there is a forward compatibility of LO 3.6.x to /4 user profiles if they are renamed to /3?" There is no guarantee for that to work. If it works, it works by chance, not by design.(In reply to)Also verified that it works fine on Windows when migrating from <> to <>.Argh, this is in line with "Autotext: migrated." from, so forget about this. I had apparently misread that as if it claimed "not working."(In reply to)The user folder should be copied...IMHO a very good idea ;)From a non-LibO developers point: Is there a possibility to check weather there were any major changes?Finally I did some changes:- Changed priority to highest (IMHO release of 4.0 _should_ be postponed because of this bug. If we expect, that something isn't working it should even not be called Beta, it should be called Alpha or even Daily! [I am very sorry for how this statement sounds like, it's a little bit too direct ;)]- I changed the URL. Oiginal URL:I am sorry but this can't be taken as a blocker. Yes, it is annoying that some setting is lost. Though, it does not affect the functionality of the software. It is still well usable.Is it really a blocker when user lost the list of recently used documents or few 3rd-party extensions that even might need an update to work with the new release? Are these the most critical problems in this release?All linux users lost similar level of setting with the switch from LO-3.4 to LO-3.5 and I am not aware of any strong complains.BTW: I am very surprised by the sentence:--- cut --- "If we expect, that something isn't working it should even not be called Beta, it should be called Alpha or even Daily!--- cut ---I am sorry but this is non-realistic. It would mean that we would not be able to release next few years until we fix all bugs and regressions caused by all fixes. Note that it would include implementing all missing features for 100% import/export from/into the supported file formats to avoid any potential "data loss". Unfortunately, the software would be very outdated in compare with the competitors at this point.Please, read also. The time based release means that .0 release is intended for enthusiasts. It might include include even annoying bugs.I am sorry if the above sounded too strong. It was just a reaction on the previous quite strong comment. I wanted to emphasize that the situation is not that easy and we have to see it from different point of views :-)(In reply to)If you describe it like that noTrueYou are very right at this point. But the problem is: We can't fix that later on ( or only for 5.0 which definitely is not in the very near future...)+1Year I totally understand your point, but here my reason for this sharp sentence above (I didn't get it sound more friendly - sorry for that)Of course. And the most important aspect: You have more experience on how to release a program :-)But please read my rephrased argument ( it isn't sharp any more AND you were not too strong):If we didn't do it in 4.0 we have to do it with 5.0 [2016-2018 IMHO] --> We should do this ASAP with (if that is possible) 5.0 testing builds...(In reply to)No. Those were examples. I think we have no idea of the extent of loss.But here are some more problemsThen it's ok because people don't complain?That is a Developer perspective. From a USER and PUBLIC perception it is a MAJOR update. So having a BAD .0 release is simply BAD marketing.If renaming the \3 to \4 folder solves many problems, maybe comparing what is the difference between the renamed \4 and the imported \4 could bring major improvements?I tried LO4 RC3 and discovered all my personal settings gone.....now I am here, and I am discovering there is a debate going on the relevance of this.I do not pretend to be right on this issue, but one fact is clear: after realizing this, I downgraded back to 3.6.5 - no doubt about it. I have dozens and dozens of toolbar personalizations, to say the least.I do hope this can be fixed, at least indicating a "manual" way to recover your profile after the install of 4.0I tried simply to replace the contents of the user/libreoffice/4/user with those of the user/libreoffice/3/user, but it did not work. Is there another more successful way?ThanksHi there. Andy - continuing to use 3.6.x is fine of course - we should have this fixed for 4.0.1 in a few weeks more - along with plenty of other issues. It'd be great to have more testing (and MAB prioritisation) further in advance of 4.1 I guess - though Pedro did a great job to file this in September and we sucked at prioritising / identifying it as an issue it seems. Florian - you're quite right - the apparently endless problems of migration are really irritating ... we need to come up with some creative regression tests for it I think to avoid issues in future.I tested my theory and it works perfectly. Even extensions are migrated. At least under Windows :)If the user does a Custom install of 3.x to %ProgramFiles%\LibreOffice\ (no version in the name) then when updating to 4.0 just install to the same folder. Then before running for the first time just make a copy of the whole \3 folder (in Windows located at %AppData%\LibreOffice\) and rename it to 4.This is what Windows users expect to happen ;)Maybe TDF can humor Windows users (even if they are a minority of LO users) by making the installer work the way they expect it to work? I believe this would be a good starting point to attract more Windows users...>Heh ;-) the whole idea of the migration code is to end up with a clean, and well understood state that does not have tons of legacy twists, turns, variants and potential problems in it.Having said that - it's clear that we also intend to migrate far more than we do - work needed; help appreciated etc.Hi Pedro, I am trying to grasp your workaround correctly, forgive for my inability to precisely understand each step from you previous post.you write:If the user does a Custom install of 3.x to %ProgramFiles%\LibreOffice\ (no version in the name) then when updating to 4.0 just install to the same folder.What does this mean? Of course I have my present LO3.6.5 install in a "\libreoffice3.6" folder in "\programfiles". Should I uninstall this from "\libreoffice 3.6" and reinstall the same release in a "\libreoffice" only folder? And my settings will be fully migrated, right?After this step 1, step 2 is installing 4.003 in the same "\libreoffice" only folder, i.e. overwriting the 3.6.5 install of the step before, correct?then you write: Then before running for the first time just make a copy of the whole \3 folder (in Windows located at %AppData%\LibreOffice\) and rename it to 4.At this point, step 3 involves that before running the 4.003 upgrade, i move to the "appdata\libreoffice" folder and clone the "\3" into a "\4" one.After this I should be able to run the 4.003 release with all my beloved personal settings at their place, right?If you confirm (or adjust where I am wrong), tomorrow I try give it a try and let you know. Thanks for now!Hence there is the risk that users lose parts of their user profile, IMHO users should be at least informed that (1) there may be problems with the migration of the user profile from Version 3.6.x to 4.0.0, (2) it is recommended to backup the user profile of the 3.6.x version, in order to be able to recover the user profile or parts of it in case of a data loss.To my opinion the release notes website page would be a reasonable place for this information.Additional info: At the German discuss mailing list a user reported that his AutoCorrect and AutoText data are lost in both (/3 and /4) profiles while installing 4.0.0.3. Hence he made a backup of his profile he could recover his data. In the moment I believe that this not a general problem. I asked the user to reproduce this behaviour.It is mentioned atI have just modified many settings in "Tools/Options/LibreOffice Calc" with 3.6. It seems that everything is migrated to 4.0 => it looks promissing with the "Tools/Options" setting.I also tried to do some changes in toolbard and they were not migrated => we should fix this.I wonder if we could check all this somehow more systematically.The toolbars setting is stored under 3/user/config/soffice.cfg/modules while most of the other setting is stored in 3/user/registrymodifications.xcuPetr Mladek committed a patch related to this issue.It has been pushed to "master":migrate menu and toolbars customization (fdo#57061)The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Petr Mladek committed a patch related to this issue.It has been pushed to "libreoffice-4-0":migrate menu and toolbars customization (fdo#57061)It will be available in LibreOffice 4.0.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.(In reply to)I strongly agree with Pedro. This should have been a blocker. The release criteria page on the TDF wiki () specifically calls out data loss as a valid symptom of a blocker bug, and this bug meets the other conditions. It is these kinds of bugs that lead many IT managers in the US to steer away from FOSS and that freak out typical users who are using a previous version. I expect that many non-programmer users who update, and then discover that settings are lost will feel alienated, and will drop LO Writer for another word processing program. I am very concerned that bad migration stories will prove to be a marketing disaster, especially with TDF's major PR for 4.0.In:This absolutely affects the functionality of the software. Users can no longer do what they were doing before without massive time commitment to reset everything manually. It is very important to remember the differing perspectives between developers and users. Otherwise eventually it will only be the developers using the software.more from:I agree that the recently used documents list is not high priority: it is transient data that just adds a little efficiency to using the software. However, the extension list is definitely high priority for many users. I would bet you that even most users who heavily use extensions don't even know which ones they have installed. They will attempt to do things in LO 4.0 that worked in their 3.X installation, but won't work now. They may have no idea that this is because of an extension! They may spend significant trouble-shooting the problem to no avail, and just leave LO. Some users have spent many hours customizing their AutoText or AutoCorrect entries, keyboard shortcuts, toolbars and menus. Not migrating those should definitely have been a blocker in my opinion, or at least there should have been clear, easy-to-find information about the bug, with a big warning on the download page.Again, a lack of understanding of the typical user. 99% (at least) of users will never post anything to Bugzilla or LO mailing lists or anywhere else. If they get majorly frustrated with the software, they will just go use a different word processor.This is also a misunderstanding of the typical user. How would the typical user even find this page? On www.libreoffice.org, no page has a link to the release plan summary. Only 2 pages have a link to the release plan. One is is the pre-releases page, where it is labeled "release schedule", a page unlikely to be read by a typical user.The other is the release policy page, where again the release plan is referred to "release schedule". Typical users are not likely to think there would be something important to them in a "release policy". Even if they do read that page, it says the reasons for 2 maintained branches are large deployments and Linux distribution, not bugs. It goes on to say "as a general rule, The Document Foundation advises all users to upgrade to the new version as soon as possible." And "It is not correct to assume that versions from previous branches are 'safer' or 'more stable'." This would seem to indicate that TDF wants single users to upgrade ASAP, with no mention of the migration or any other bugs.And even if by some miracle a user gets to the release plan page, s/he is not likely to think there would be something important to them in a "release plan".Now the LO home page redirects to a huge, splashy announcement of 4.0, which certainly seems aimed at the general user. No mention of annoying bugs, no mention of the release plan philosophy. The page that the download button takes you to also says nothing about annoying bugs or the release plan, nor even any indication that the user should consider downloading an earlier version. There is a link to what is labeled as the release notes page. (Which is not a real release notes page, since it doesn't even describe what is new in the release.)This "release notes" page says that 4.0.0: "contains many exciting new features, and is suitable for early adopters and private power users",and that 3.6.5: "contains many exciting new features, and is the recommended version for home and corporate users."The first 7 words are the same. Those two sentences make it sound like there may be extra fancy, specialized features in 4.0.0, not that it might be buggy. The very bottom sentence of the 4.0.0 release notes finally mentions bugs, and links to the real release notes page on the TDF wiki for "a few annoying bugs". I believe the typical user of a previous version would consider major settings loss far more than annoying. Finally, on that page, is a link to this bug. This bug is long and technical, with a vague title, and no succinct description of the problem.So .... A user gets excited by the flashy announcement on the home page, and attempts to download 4.0. On their second clicked-through page, s/he may see the line about some bugs. S/he might follow that link to the third clicked-through page, which mentions that some settings are not migrated. It isn't until s/he reaches the fourth clicked-through page where there is even a chance of the user understanding what settings are not migrated.I am not writing all this to attack Petr or any other developer. I am a strong FOSS supporter, and am thrilled to use LO. I am very, very grateful for all the time and energy you all donate to the project! I am just concerned that not keeping in mind the perspectives of typical users will eventually doom the project. It has happened before on other projects.I realize that much of this post touches on larger issues than just this bug. If there is another appropriate place to post this, let me know.I am not a programmer, but am happy to help out in other ways.It is hard to say who is right. I have heard quite positive feed back about 4.0 so far. I am sure that some people will get annoyed and I am not happy about that but it was not easy to decide.BTW: I am going through the setting and working on patch to improve the migration. The situation in 4.0.0 was not that bad. Majority of the Tools/Options setting was migrated. The list of recent documents and toolbars personalization seem to be the biggest missing part.Just did an 4.0.0.3 installation over an 3.6.4.3 one via msi deployment on a Windows 7 Prof. x64 workstation.The personal data is well migrated, but seems the user modified paths from Options - LibreOffice - Paths are not migrated. At least the modified template and autotext paths do not show up in the configuration dialog.Another report about this happening. I updated from LO 3.5.? to 4.0.0.3 on a Windows 7 machine and lost all of my custom dictionaries, extensions (well, I only had one), key mappings and other preferences. The App Data/Roaming/Libre Office/3/ folder contains to files, MIGRATED (date implies it's from a previous update) and MIGRATED4, as well as the folder user. Is there any way I can manually get this data into LO4? And will a bugfix actually help in cases like mine where the damage already has been done?Petr Mladek committed a patch related to this issue.It has been pushed to "master":migrate even more user setting (fdo#57061)The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Hi Paul, I'm sorry you got bitten by this issue; however - we have a time based release schedule, and this was not a sufficiently critical issue to hold the release (nor was there a fix in sight for it as/when we went live).TDF repeatedly, and emphatically states that "IT managers" should be paying for a professionally supported product version. These versions tend not to be based from a .0 release, better they come with real L3 support that can fix bugs and issues, and without which any migration is likely to fail. So - if your claim is that vanilla LibreOffice at a point-zero release is not adequate for an IT manager - you are quite correct.We can of course improve the wording of our announcements always; in the Free Software world, it's well understood that a point-zero release is always less polished than a point-<N> one :-) we can articulate that better of course.However - driving too many people away may defeat the point: without testers the software will not improve. On that topic, it would be great to have more people running master builds and reporting problems against them to help find problems (such as this) much earlier.Anyhow - thanks for your input ! noted.Petr Mladek committed a patch related to this issue.It has been pushed to "master":migrate also custom accelerators setting (fdo#57061)The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.I went though the officecfg/registry/data/org/openoffice/Office files from LO-3.6 sources and enabled migration of few more items: + paths setting + recently opened files + recovery setting (enable/disable; time) + ODF import/export setting + font anti aliasing setting + windows and toolbars setting (visibility, position, docking) + custom acceleratorsIt seems to work fine and looks safe. People have already complained about many of these items.I was not brave enough to enable few other items, for example:Ah, I hate the TAB+ENTER combination in bugzilla because it submit the message when I do not wan't. Anyway, let's continue.I was not brave enough to enable some other items, for example: + Office/Canvas + Office/ProtocolHandler + Office/Stripting + Office/SFX + Office/UI/CalcCommands + Office/UI/WriterCommands + I was not sure what they mean and how to modify them + They looked a bit strange + I wonder if they can be modified by the UI at all + Office/FormWizard + Office/WebWizard + Office/Common/Help/Registration + Office/DataAccess/Bibliography + Office/DataAccess/DataSources + the Writer wizard and the other stuff was explicitly disabled in the past, I guess that there was a reason for thisThe three last commits should solve most of the mentioned problems.If I did not miss anything, the only remaining problem are the extensions. AFAIK, Stephan mentioned somewhere that the user-specific extensions are migrated. So, the problem is only with system wide extensions but it can't be solved easily. Anyway, the same problem was with any update, for example between 3.4 and 3.5 or between 3.5 and 3.6 => this was always problem => it should not be part of this bug.=> I would consider it as FIXED. Feel free to reopen it if I missed something.If you have already migrated your configuration with LO-4.0.0.3 or earlier, you still have chance to migrate also the missing stuff.One possibility is to migrate it once again. The problem is that you lose the changes that you already did in LO-4.0. Anyway, the steps are: 1. stop LO 2. remove libreoffice/4 user configuration 3. remove libreoffice/3/MIGRATED4 file 4. start LO 4 againAnother possibility is to copy only the missing parts: 1. copy libreoffice/3/config/soffice.cfg/modules/* into libreoffice/4/config/soffice.cfg/modules to migrate changes inside toolbars and menus (new items, visible items, different order) 2. copy the interesting parts from libreoffice/3/registrymodifications.xcu to libreoffice/4/registrymodifications.xcu The file seems to be well formatted and alphabetically sorted. The content is relatively easy to understand. You need to copy whole lines and better whole sections with similar prefix. For example, lines starting with <item oor:path="/org.openoffice.Office.UI.WriterGlobalWindowState/UIElements define positions of extra elements in Writer, especially toolbars. Or lines starting with <item oor:path="/org.openoffice.Office.Histories/Histories describe the recently opened files.(In reply to)@kliems, which extensions was that, and was it installed per-user or shared?***has been marked as a duplicate of this bug. ***(In reply to)It was the Zotero plugin (). I can't really remember in which way is was installed -- presumably I installed as suggested on the linked page.From a practical perspective I'm more concerned with my dictionaries and auto-complete entries, as reinstalling extensions is no big deal.(In reply to)Ah, that Zotero extension ("tunneled in" via a Zotero-LibreOffice-Plugin-3.5.4.xpi Firefox extension) might indeed be special. Likely that it results in the LO extension being installed shared; and shared extensions are not migrated, see.Petr Mladek committed a patch related to this issue.It has been pushed to "libreoffice-4-0":migrate even more user setting (fdo#57061)It will be available in LibreOffice 4.0.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Petr Mladek committed a patch related to this issue.It has been pushed to "libreoffice-4-0":migrate also custom accelerators setting (fdo#57061)It will be available in LibreOffice 4.0.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Hence there was a complaint on the german user mailing list, I checked the migration of macros with version 4.0.0.3. According my test macros are not migrated. I used the same procedure like in. If necessary I can provide a step-by-step description.Petr: Is the migration of macros also solved with your patches?BTW: Thanks for your commitment.I checked the migration of several items of the user profile again. Some parts are still not migrated. Hence reopened.Used version: Version 4.0.1.0+ (2013-02-19 08.45.16)(Build ID: 847371bdd92f90b74f33f226f9487d5dbff249b)Result of test:* Recent documents (OK)* LO Window size (NOT MIGRATED)* Some randomly tested options: - Tips (OK) - User data (OK) - „Enable macro recording“ and „Enable experimental features“ (NOT MIGRATED) - Paths > My documents (NOT MIGRATED) - Appearance > Document background (NOT MIGRATED) - Writer > General > Settings > Tab stops (OK)* AutoTexts (OK)* Display additional tool bar (OK)* Additional visible icon in tool bar (OK)* Remove (i.e. not visible) icon from tool bar (OK)* Change order in Menu (OK)* Additional item in Menu (OK)* Macros (NOT MIGRATED) (macro created with macro recorder, macro inserts just some words) * Customize keyboard (NOT MIGRATED) (I assigned „Style > Paragraph > Heading 6“ to CTRL+6)Petr Mladek committed a patch related to this issue.It has been pushed to "master":migrate even more configuration setting (fdo#57061)The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.First, harald-koester@, thanks a lot for testing and great summary.I have pushed another fix into master and nominated it for 4.0.2 and 4.0.1.2 releases. It fixes migration of: * LO Window size * „Enable macro recording“ and „Enable experimental features“ and few more options * Paths > My documents * Macros (macro created with macro recorder, macro inserts just some words) The following two items worked for me with 4.0.1.1 build on Linux, so there was nothing to do: * Tools/Options/LibreOffice/Appearance/Document background * Customize keyboard (assigned „Style > Paragraph > Heading 6“ to CTRL+6 it Tools/Customization/Keyboard)harald-koester@:I am not sure why the two last things did not work for you. Could you please try it once again with the 4.0.1.1 build.BTW: harald-koester@ what system are you testing on, please? Linux or Windows or ...?Hi Petr,(In reply to)OK, I'll try it again on Saturday or Sunday.My System: Win 7 Prof.harald-koester@, I have two more ideas what might went wrong.1. Note that the migration works only in two ways: + LibreOffice -> LibreOffice (between official builds) + LibreOffice -> LODev (from official 3.x build to daily 4.x build) , so you need to do the original changes using the official LibreOffice-3.x build. I guess that you know this but just for sure :-) 2. There is one known limitation. The Tools/Options/LibreOffice/Appearance setting is not correctly migrated from LibreOffice -> LODev build. There is used the "LibreOffice" vs. "LODev" identification => this can't be tested only with official RC builds. If you used LODev daily build of 4.X, it explains why the Appearance > Document background setting was not migrated in your case.3. The shortcuts are localization-specific. You do not see your changes if you use different localization for 3.X and 4.X builds. I guess that you use your native language localization for 3.x and the English localization for the 4.X daily build => this might explain the non-migrated keyboard customization.Could you please confirm that you used a daily LODev build with another localization for testing?Here are new test results:User profile created with version 3.6.5 release, UI: GermanMigration tested with version 4.0.1.1, UI: GermanMigrated items:* Recent documents (OK)* LO Window size (NOT MIGRATED)* Some randomly tested options: - LibreOffice > User data (OK) - LibreOffice > General > Tips (OK) - LibreOffice > Memory > Undo > Steps (OK) - LibreOffice > Advanced > „Enable macro recording“ and „Enable experimental features“ (NOT MIGRATED), different options cathegory in Version 3.6.x: LibreOffice > General - LibreOffice > Paths > My documents (NOT MIGRATED) - LibreOffice > Appearance > Document background (OK) - Load/Save > General > Save > Edit document properties... (OK) - Language Settings > Show UI elements for East Asien Writing (OK) - Writer > General > Settings > Tab stops (OK) - Writer > Table > Heading (OK) - Writer/Web > Grid > Resolution > vertical und horizontal (OK)* AutoTexts (OK)* Display additional tool bar (OK)* Additional visible icon in tool bar (OK)* Remove (i.e. not visible) icon from tool bar (OK)* Change order in Menu (NOT MIGRATED !!!) Was OK with Version 4.0.1.0+ (2013-02-19 08.45.16) !!!* Additional Item in Menu (OK)* Macros (NOT MIGRATED) (macro created with macro recorder, macro inserts just some words)* Customize keyboard (OK)Petr, your asumptions ofrelating to the appearance and the short cut settings seemed to be correct, both items are migrated now.Petr Mladek committed a patch related to this issue.It has been pushed to "libreoffice-4-0":migrate even more configuration setting (fdo#57061)It will be available in LibreOffice 4.0.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Harald, thanks a lot for retesting. The following items should get fixed by the last commit: * LO Window size * Some randomly tested options: - LibreOffice > Advanced > „Enable macro recording“ and „Enable experimental features“ - LibreOffice > Paths > My documents * Macros (macro created with macro recorder, macro inserts just some words)I am waiting for one more approval, so I am pretty sure that it will be in 4.0.1.2 build.-------The only remaining this is: * Change order in Menu (NOT MIGRATED !!!) Was OK with Version 4.0.1.0+ (2013-02-19 08.45.16) !!!I did the following test in Writer: * Add "Bibliography Database" into "File" menu, just after "Close" (OK) * Move "Safe" before "Close" in the "File" menu (NOT MIGRATED) * Move "Zoom" on top of the "View" menu (OK)So, the menu migration partly works. LO-4.0 has the new menu entry "File/Safe As Template". I guess that LO-4.0 somehow enforced the updated "Save *" section and blocked moving the "Save" menu entry. I think that it is a corner case and not-worth fixing.Harald, what changes you did in the menus, please?Do you see the problem with more menu entries?Petr Mladek committed a patch related to this issue.It has been pushed to "libreoffice-4-0-1":migrate even more configuration setting (fdo#57061)It will be available already in LibreOffice 4.0.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.(In reply to)I did this 2 tests:(1) In the Writer menu "File" I moved the item "New" below "Open...". This was not migrated.(2) In the same menu I added the Command "Application > Extended Tips" at the end of the menu. This works. (But I just observed another problem: I tested the migration with the German UI. In order to tell you the right English names for the different items I changed to the English UI. But the language of the new inserted menu entry still is in German !! Just for your information. I think this is not a migration problem.) Hence I only performed the mentioned two test cases, I can't estimate if there are more problems with the migration of the menus. From my point of view there are some more test cases necessary in order to get a good 'feeling': change menu items not only in Writer, delete items from the menu, rename menu items, add a new menu group, add submenus, ....I intend to do some more tests according the migration of the menu, but you know, it's not a 5-minute-task ....I made some more tests according migration of menu changes.User profile created with version 3.6.5 release, UI: GermanMigration tested with version 4.0.1.1, UI: GermanHere are the results:(1) Change order: Writer menu: File: „New“ moved on position down (below „Open...“) (NOT MIGRATED)Worked with Version 4.0.1.0+ (2013-02-19 08.45.16)(2) Change order: Writer menu: Table > „Split cells...“: moved 3 postions lower (below „Split table...“) (NOT MIGRATED)(3) Add Item: Writer menu: „File“, „Extended tips“ added to last position (OK)(4) Delete item: Writer menu: Format > „Styles and Formatting“ deleted (NOT MIGRATED)(5) Rename item: Writer menu: View, name of „Ruler“ changed (NOT MIGRATED)(6) Change order in submenu: Writer menu: Format > Anchor > „To page“ moved to the end of submenu (NOT MIGRATED)(7) Add item in submenu: Writer menu: Item added to submenu „Insert“ > „Object“ (OK) (8) Delete item in submenu: Writer menu: Edit > Changes > item „Comment...“ deleted (NOT MIGRATED)(9) Rename item in submenu: Writer menu: Tools > Update > „Page Formatting“ renamed (OK)(10) Rename default menu group. Writer menu: Is not possible. I don‘t know if this is intended.(11) Rename subgroup: Writer Menu: Insert > „Fields“ renamed (OK)(12) Move group: Writer Menu: Move „Edit“ one position to the right (NOT MIGRATED)(13) Create new menu group in Writer menu: Add 3 random items to group and additional one item with a submenu with 2 random items. New group with all items is migrated, but the name of the group is not migrated. After migration the wrong menu group name is „CustomMenu1“. The names of all menu items are correct. (ONLY PARTLY MIGRATED)(14) Change order: Calc menu: View > „Navigator“ moved up 4 postions (below „Status Bar“) (NOT MIGRATED)(15) Add item: Calc Menu: one item inserted in group „Data“ (OK) (16) Delete item: Calc menu: Edit > item „Plug-in“ deleted (NOT MIGRATED)(17) Another observations with all the menu changes above: Writer menu: View: There are two items „Zoom“ with different functions in this menu group: The item, which is wrong here opens the dialog „Zoom & View Layout“ (ITEM WRONGLY ADDED)(18) And another observations also with the menu changes above: Writer menu: In group „File“ a submenu with 4 items has been wrongly inserted between „Digital Signatures..“ and „Preview in Web browser“. The name of this submenu is „TemplateMenu“. This name is not translated to German. The first item of the submenu has not got name, i.e. there is only an empty place. (SUBMENU WRONGLY ADDED)Update: just installed 4.0.1.2Many progresses in user data migration.However some settings are still not migrated:1) Java version is not selected (was manually selected in 3.6.5.2)2) Online update checking was manually unselected in 3.6.5.2 and is selected again in 4.0.1.2Because pathnames where changed, all Shared extensions were lost and need to be reinstalled. More on this in the QA mailing list.I too, tried 4.0.1.2:I uninstalled 3.6.5 from the "Libreoffice 3.6" folder;I the installed 4.0.1.2 in the default "libreoffice 4.0" folder.Unfortunately, no personal setting was migrated, starting from personalized toolbars, which are gone and replaced by the standard ones.Am I missing something?Shouldn't the 4.0.1 solve this?Maybe I have to install it in the same "libreoffice 3.6" folder of the previous version?Or I should not uninstall 3.6.5 before installing 4.0.1?Any hint is really welcome, thanks(In reply to)Please, read the. You need to remove the "libreoffice/4" configuration and also the "libreoffice/3/MIGRATED4" file to trigger the migration.I see. I have now solved my own case by applying Pedro's advice (basically, first moving the 3.6 install in a generic "libreoffice" folder, and then installing 4.0.1.2 on top of it, plus some other details).However, I thought that the 4.0.1 sub-release was aiming at giving user an effortless migration experience from 3.x.... if you still have to fiddle with hidden files and folders in "appdata/libreoffice", I would say the process is not ready for prime time yet.(In reply to)That was not the only goal of 4.0.1Fixes in the 4.0.x branch will continue until version 4.1.0 is released.So keep posting problems on this bug report.For further discussion go to(In reply to)The fixes will help people who newer started 4.0.0 but they start testing the 4.0 release with 4.0.1 build. The fiddling with the hidden files and folders is needed only for people who already migrated with 4.0.0 release and they want to do it once again with the improved 4.0.1.By other words, we could not fix already migrated configuration automatically. It would remove changes that people made with 4.0.0.I have finally got time to look at the migration problems again and I am able to fix only one thing easily. The rest is more complicated :-(1. Java setting is not migrated (by Pedro) + one reason is that we do not copy user/config/javasettings*.xml + but even if we copy the file, it does not help because there is modified the list of supported vendors in /opt/libreoffice4.0/ure/share/misc/javavendors.xml; This change would cause re-detection and reset to the default java even if we do not move the migration. We could do better but this is an old bug. It would happen even if we did 3.7 instead of 4.0. I would suggest to solve it separately.2. Online update checking was manually unselected in 3.6.5.2 and is selected again in 4.0.1.2 (by Pedro) + This can be fixed by enabling the migration for "/org.openoffice.Office.Jobs" in officecfg/registry/data/org/openoffice.Grr, i have this "TAB" + "Enter" behavior in bugzilla. Let me continue: + I am going to put the fix for the online checking after some investigation3. Many changes in menu entries are not migrated (by Harald) + it seems that the menu entries are filtered by a pretty old code added by+ IMHO, the problem is that the code does not know if the menu entries were added/removed/renamed by the user or by the new version. It has to guess and it seems to be using the following approach: a) it ignores renamed entries because they might be renamed by the new version; It helps to be compatible with help and tutorials; By other words, it always enforces the name from the new version; This explains the non-renamed menu items - problem 5, 13, 16 from. d) It ignore moved entries because the move could be caused by new version. It again helps to be compatible with help and tutorials. The only exception are menu entries added by the user, see below. By other words, it resets the order according to the new menu. It keeps the entries that are not longer in the new menu on the location where they were before. This explains the non-migrated moves - problems 1, 2, 6, 12, 14 b) It tries to do not lose any user added entry. It keep all entries from the old user menu that are not in the new menu. This explains the forgotten menu entry - problem 18 from. c) It tries to do not loose any new menu entry from the new application. It keep all entries from the new menu that are not in the old user menu. This explains the non-deleted entries - problems 4, 8, 16, 17 from. Note that the two zoom items are caused by non-deleted old "Zoom" entry. So, it is explained. The questions is what to do with it. I do not see any easy solution. The current logic sounds reasonable. If we want to solve it properly, we would need to store information about all menu changes between all old OOo and LO release and use it in the update logic. This would be a real hard hack and I am not sure if it is worth the effort. It would be actually needed even for update between minor versions that modify menu entries as well. If we want to better solve the menu migration, I would open separate enhancement bug for it.Petr Mladek committed a patch related to this issue.It has been pushed to "master":Migrate also Java and Online Update setting (fdo#57061)The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.(In reply to)Well done Petr ;)Since these are all bug fixes (and not new features) can't they be cherry picked to the 4.0.x branch so that they can be tested and added to 4.0.2?Petr Mladek committed a patch related to this issue.It has been pushed to "libreoffice-4-0":Migrate also Java and Online Update setting (fdo#57061)It will be available in LibreOffice 4.0.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.82 comments later can we close this as FIXED and give Petr a big thank you? ;)I have opened separate bugs to track the two remaining problems: +for enhancing java migration +for enhancing custom menus and toolbars migrationAll other mentioned problems should be fixed in 4.0.2.1 build. Please, note that you need to manually trigger the migration if you want to try it again, see thefor more details.Let's close this long bug and keep fingers crossed :-)Well done, Petr :)Just updated to 4.0.2.1All settings that I modified were imported, even the Updates check.Kudos!(In reply to)You bet. I'm very surprised that this happened at all. I had deliberately skipped 4.0, in anticipation that such gross errors would be eliminated in the next release (4.0.1.2), which I installed. Dead wrong.Fortunately, I know how to manually move the user files. Those who don't and have much customization done could be screaming mad. (On the safe side, I had even backed up the whole folder just before installing.)Good this this is fixed for the next release. Still, I think it's very important to trace how this could have happened, and implement some kind of protocol to prevent it.Kumara - we have such a protocol; it is called pre-release builds. I'm glad you agree that this is important, so you can get involved in testing those quite easily - please do so. Master builds -should- be usable for daily work, and in some cases have more bug fixes than the release builds.Failing that - you could contribute some unit tests for migration - currently there are zero of them; it would be fantastic to have some :-) Failing that, if you can't program, then getting involved with manual testing & bug triage is greatly appreciated.Thanks !Michael, I'm aware of testing the pre-release builds. I don't recall having done it before, and am very grateful to people who have. I should consider doing it, but admit that I'm unable to at this time.At any rate, this isn't exactly the protocol I wasn't speaking about. Perhaps "protocol" is not the right word to use. I'm interested in solving a bigger "bug": the *reason* such a bug happened despite the existing testing protocol. (There are other surprising bugs on LO4.) Could it be that the alloted time frame for testing is not long enough? Could it be that the range of testers isn't wide enough? ("Range" as in the variety of people who uses LO in different ways.) We need to ask such questions.I apologise if I'm using a wrong platform for this. Let me know if there's a better place to discuss this. Come to think of it, this kind of work is more suitable for me than testing, as I'm unwilling to risk losing data.This isn't the right place to discuss this, and if you're saying that the best you can do is suggest better ways for other people to volunteer their time, I'm afraid you can stand in a long line. There are hundreds of suggestions for us to implement changes but often times people say exactly what you said "I don't have the time to help". I am part of the QA team, if you'd like to get involved with testing, triaging and making better and more efficient check systems, please feel free to contribute through QA, if not, I'm sure you can understand that a group of overworked volunteers will hit snags occasionally, we do our best and are constantly putting in tens of hours a week for no pay to make our process better.If you have specific suggestions on how to make QA better (which is what you're saying), please send emails to QA mailing list. The more specific the better as general comments aren't very useful.Just to give you an idea of what we face, over 1,000 bugs/enhancements were reported in February alone, we have a very small team to manually sort through these, confirm issues, and then of course help developers priortize. With millions of users worldwide, the ratio of QA testers/triagers to users becomes mind numbing.As these comments have clearly gone off from the main topic of the bug, I ask that you end it here and move it to the QA mailing list where it is more appropriate.forgot to say:@Pedro - thanks so much for so much work on this one. If you have just a little time a week to help out QA we would love to have you join our team :) Please feel free to email me directly, join our mailing list and of course chat with us on #libreoffice-qa :-D
id=58392	Problem description: Default printer not found/recognizedSteps to reproduce:1. display FILE2. display PRINTER SETTINGS3. Default printer never found/recognizedCurrent behavior:Cannot print!Expected behavior: can print! Operating System: Windows 7Last worked in: 3.6.3.2 release works for me in 3.6.4.3 release (Vista 64bit)default printer correctly shownFred: could you rename your LO directory profile (see) and try again?Incarus tells us via IRC he can reproduce this bug -> bug status to NEWIncarus' system info:Windows 7 64bitLibreoffice 3.6.4.3It isn't reproducible anymore with LO4.0 b2Because off 'Edit Collision with Julien' -> Set status to 'NEW'***has been marked as a duplicate of this bug. ***I cannot confirm this.Marking as WFM.@Fred - please try with latest release of 3.6 with a fresh profile. If you still have problems please mark as UNCONFIRMED (might have to set to NEEDINFO -> UNCONFIRMED). If we get more info this will be a critical bug so upping the importance right now just in case
id=58324	CreatedThe ODT file to show this problem.Problem description: I upload a mi4.odt to show this problem.In version 3.5.4, the chinese character 𥅽 can be shown correctly even though the current font did not contain this unicode character (see attachment lo-3.5.4.png).But in version 4.0 beta, Writer would not show any character (see lo-4.0-beta1.png ), unless I manually selected a font that contains the unicode chinese character𥅽.In shorts, Libreoffice 4.0 do not find other fonts to display unicode chinese characters while this characters not found in current font, but Libreoffice 3.5.4 can do it automatically.Is it a problem of PANGO ?Note:If you were using Debian, you will need to install fonts-arphic-uming or fonts-arphic-ukai to show this unicode chinese character.You can download and extract them from the deb file if you were not Debian user:Steps to reproduce:1. Install fonts-arphic-uming or fonts-arphic-ukai (Debian or Ubuntu), but do not set these 2 fonts as default font in Writer.2. Open mi4.odt with Libreoffice 4.0 beta1 or 3.5.43. You will see nothing there if you open it with Libreoffice 4.0 beta1, but you will see a chinese word if you open it with Libreoffice 3.5.4.Current behavior: Libreoffice 4.0 do not find other fonts to display unicode chinese characters while this characters not found in current font.Expected behavior:If the unicode character not found in the current font, Libreoffice 4.0 beta should try to search other fonts that contains this unicode character and to display it.Operating System: DebianLast worked in: 3.5.4 release CreatedScreenshot: Libreoffice 4.0 beta failed to find other font to display the unicode word.CreatedScreenshot: Libreoffice 3.5.4 find other font to display the unicode word automatically.Could some developer close it as NOTABUG?(In reply to)It's not a bug? For what?hmm... seems to work here, all LO 3.5/3.6/4.0/master versions i've tried(incl. 4.0.0.0.beta1) show a chinese glyph for the bugdoc, thoughobviously from a different font than in the screenshot.i wonder, is this because i'm using a "newer" version of thefont in the document? (testing on Fedora 17)i don't know how to check if there is indeed some fallback goingon here; probably only Caolan can debug this...All respected contributor,I find that if we close a document using the windows upper right corners cross button (even after saving it), during re opening the LibreOffice it starts the recovery process! But if we close the document from menu, then this problem does not happen.I believe rectifying this would help millions of user around the world. Even in OO 2.0 I also found this problem.Since I am new to this bug reporting area I might have posted it to wrong place. Apologies for inconveniences.Thank you,Ferdouscaolanm->minhsien0330: This "works for me" with those fonts installed. So presumably its because I have additional fonts installed which fontconfig suggests as better replacements.So in order for me to attempt to reproduce this bug I need to a) get the full list of fonts you have installed so that I can synchronize my installed fonts with your installed fonts.fc-list -v > /tmp/fontlist.txtand attach /tmp/fontlist.txt hereb) get the output of "locale -a" because that can affect the suggested fallback font too.caolanm@fk: Open a new bug for your different problem which is unrelated to this issue.Createdfont listDear Caolán McNamara:The fontlist.txt is attached here.And the result of "locale -a" is:CC.UTF-8en_US.utf8POSIXzh_TW.utf8Thanks a lot!Createdfont list (new)Sorry, I added and removed some fonts, so I generate a new font list here.Thanks a lot~The word processor should not substitute arbitrary fonts for documents and display random glyphs with them.caolanm->urmas; There's nothing arbitrary about it, if a font is missing or cannot render a requested glyph we request a suitable replacement from fontconfig. Obviously the result depends on the input font, requested glyph and available installed fonts.surrogate pair seems to be getting chopped upCaolan McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: fdo#58324 keep both halves of surrogate pairs if glyph isn't foundThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.fixed for 4-1, patch submitted for 4-0 reviewCaolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-0":Resolves: fdo#58324 keep both halves of surrogate pairs if glyph isn't foundIt will be available in LibreOffice 4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Dear Caolán McNamara:I tried the daily builds(Time: 2013-01-21_10:33:51), and I found this problem is really soloved.Thank you so much!Best Regards,Minhsien0330
id=58691	CreatedLO PivottableI created a pivottable with LO4.000b2. It works with some (less severe) problems: 1. bad performance with larger data tables (in a pivot table with 450 lines x 230 columns it takes up to 25 sec. to update after using the filter buttons), 2. column filter buttons become nonfunctional when they exceed the rectangular cell range of the pivot table (try to use the filter button "Datum" in the attached "Pivottable_Test.ods").However, when saving this document as Excel 2007/2010 (XLSX), and reopening, all pivottable functionality is lost: the table is still there, but without filter buttons and all the other logic behind. A showstopper! This exported file also shows the fat cell borders mentioned in #58356.In my opinion, the Pivottable seems to need a good amount of bugfixing and a more efficient code for being usable in everyday work. So, please don't add new features until the existing don't work. Thanks for reporting @paulchen.Confirmed, columns filter and save/load xlsx, issues.Wintx64UltimateVersion 4.0.0.0.beta2 (Build ID: 4104d660979c57e1160b5135634f732918460a0)Curious, changing the Data subtotal on a column field to automatic, makes the column filter again available for both columns (Datum & Probenummer).The pivot table functionality is lost when exporting into XLSX also with LO-3.6 and 3.5. So, it is not a regression => can't block the release => lowering the severity a bit.Note that the OOXML import/export filters are work in progress. It is being improved in every LO release.Kohei, Muthu, Noel, could you please have a look? I am not sure who of you works on the XLSX import/export.Changing platform to all because I also reproduce this in Linux (Ubuntu 13.10 and Fedora 20)***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***MABs should be priority highest.The master branch should do a better job on this. Still not perfect (and probably never will be due to incompatibilities between Excel and Calc's pivot tables), but it's better than nothing.@paulchenplease retest with LibO 4.3.4 or 4.4.0.0 alpha and tell if the issue persists.Actually there are 3 different issues in this bug report:1."Bad performance with larger data tables"This issue is resolved because of the pivot table dialog change in version 4.3, see:The corrosponding bug report is.2. "Column filter buttons become nonfunctional when they exceed the rectangular cell range of the pivot table"This is still reproducible in version 4.4.0 beta 1.This is the same issue as described in.3. "when saving this document as Excel 2007/2010 (XLSX), and reopening, all pivottable functionality is lost"This is still reproducible in version 4.4.0 beta 1.This is the same issue as described in.So, I believe it is safe to close this bug, and keep tracking the still reproducibleandinstead.@tommy27: I suggest to close this bug, and addto MAB4.3.ok. did it.What does mean Resolved *Moved* here?Best regards. JBFI was uncertain how to label this since it has been splitted in 3 different reports.my interpretation of the MOVED status is that we "move" the discussion about the present generic bug (3 issues into one) to the other 3 specific bug reports.If I'm wrong please correct me.
id=59248	File/Wizrads/Letter and File/Wizards/Fax does nothing in LO-4.0.0.1 build on Linux x86_64. Works without problem (apart from a noticeable delay between selecting the menu entry and having the corresponding dialog show up) with my local (--enable-dbgutil) current libreoffice-4-0 build on Linux x86_64 (Fedora 17).I reproduce the problem with Version 4.0.0.1+ (Build ID: f49e469d93749547520ae34c52d26f17bcc32cf) under Ubuntu 12.04 x86-64 FR.Best regards. JBFit can be reproducible on master and on 4.0 RC1.Something has been changed in the python3 implementation and now it fails to import API elements.Simple way to test it:import unofrom com.sun.star.awt.VclWindowPeerAttribute import OKHm, started to fail for me too now after a fresh local master build.Stephan Bergmann committed a patch related to this issue.It has been pushed to "master":fdo#59248: Remove remaining dangling view of ViewHandler.pyThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Requested backport to libreoffice-4-0 as <>.Stephan Bergmann committed a patch related to this issue.It has been pushed to "libreoffice-4-0":fdo#59248: Remove remaining dangling view of ViewHandler.pyIt will be available in LibreOffice 4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Verified in Version 4.0.0.1+ (Build ID: e523186e59632ef824eb3262edd0c63e388af6e) under Ubuntu 12.04 x86-64.Each wizard starts as expected.Best regards. JBF***has been marked as a duplicate of this bug. ***Still reproducible using Mac OSX 10.8.2. Both Letter and Fax doesn't open...LibreOffice Versie 4.0.0.2 .0.2 (Bouw-id: 408fe71bd18616c467b3dcd7ab6756528ffcae2)TinderBox: MacOSX TDF Release, Branch:libreoffice-4-0, Time: 2013-01-22_15:37:59Dutch UITherefore I mark this as REOPENED.Note:Also tested with Linux Mint 14 x64: NOT reproducible using 4.0.0.2 rc2.(In reply to)PS: I did reset my user profile and completely re-install LO, still reproducibleI can reproduce this, too, with <> on Mac OS X 10.7.5.(In reply to)I can /not/ reproduce it with my own local build of libreoffice-4-0-0. I tracked it down to a general problem with Python in the above "official" LO build, see. (So marking this bug as fixed again.)
id=59259	Run Impress (Debian GNU/Linux 64, confirmed by other person with Windows 7 x64, libreoffice 4.0RC1), select one of the following "master pages": sunset metropolis vintage.Then "File -> Print..."behaviour expected:the print dialog should show upWhat happens:program just freezes (CPU is not 100%, but even so also the UI, KDE in my case, seems trashing until you kill LiBo) I can confirm this behavior, using 'Sunset', 'Metropolis' or 'Vintage' layout. I also can add that selecting one of this 'Master pages' will result in a short 'freeze' (1 second or so). When file -> print, a complete freeze. After a while I can use the dialog again. Good catch Marco!All these templates are using SVG picture on the background. LO-4.0 started to use another library to read SVG pictures, so it is most likely related.I add some Draw and Writer hackers into CC.Hmm, I am able to print to file on openSUSE-12.2-x86_64 with 4.0.0.2 packages. But it takes ages.Observation: 1 slide in the generated postscript has the following size: + 5.1 MB with Sunset SVG background + 0.4 MB with DNA PNG backgroundI guess that we generate very high resolution when printing SVG pictures.Hmm, I would not block the 4.0.0 release because of this problem. The print takes ages but it is possible. .0 release is intended for early adopters and might include even annoying bugs. Though, we should fix it ASAP => slightly lowering severity and adding into MABs(In reply to)Well, let's say that 50% of Impress users are using those templates, and for them printing is essentially broken (takes ages = unusable/hangs/perception that does no work and it's frozen).In addition is a regression (don't know technically, but an user passes from a release where this works to one that does not)We are going to upset a lot of people and receive a lot of bad reviews due to this ("there is some new interesting feature but impress printing is broken, a sigh of the low quality of the suite/development/whatever").Do we have some hurry or better release when most problematic bugs are fixed?I would do the latterLook atplease.Something went wrong here, this one has nothing to do withJan Holesovsky committed a patch related to this issue.It has been pushed to "libreoffice-4-0":fdo#59259: Suppress the expensive parts when we are only writing to metafile.It will be available in LibreOffice 4.0.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Fixed now. Really nasty, thank you for the report!Jan Holesovsky committed a patch related to this issue.It has been pushed to "master":fdo#59259: Suppress the expensive parts when we are only writing to metafile.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Jan Holesovsky committed a patch related to this issue.It has been pushed to "libreoffice-4-0-3":fdo#59259: Suppress the expensive parts when we are only writing to metafile.It will be available already in LibreOffice 4.0.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=59629	CreatedFile for exempleIn LibreOffice 4.0.0.0.beta2 (Build ID: 4104d660979c57e1160b5135634f732918460a0) on Ubuntu 12.04.1.1) Make some long text with two or more bullet2) Custom animation: select the text of the first bullet and animate it3) Do the them for the other bullet4) Launch slide show (F5)5) See that on line the first line of the bullet's text are animated (see video for example)Expected: animate all the text like with LibreOffice 3.5 Video: file test with LibreOffice 3.5 and 4.0:Tested in :Version 4.0.0.1+ .0.1 (Build ID: 65634f0aea686be7cdf313f66893a06ccd44880)same problem : Only first line of a list item is animated and the text on lines following the first line is displayed, also before animation ...Can't reproduce on:Version 4.1.0.0.alpha0+ (Build ID: daa3de275b74ecb85eea3e1d3764ca357a8e2b5Bodhi LinuxMarking as WORKSFORME@reporter - please test with Release Candidate 2 with a fresh profile, if it's still an issue reopen the bug and we'll get a 2nd QA member to check it out.Thanks!@ Joel Madero:I reproduce the bug with a fresh profile on Ubuntu 12.04 with LibreOffice 4.0.0.3 (Build ID: 7545bee9c2a0782548772a21bc84a9dcc583b89This bug shouldn't be marked as NEW until an independent QA tester verifies it. Moving back to UNCONFIRMED until that happens.Also, in general it is against policy for a reporter to report their own bug as a MAB. QA or an independent person should do this. Lastly, only confirmed bugs (again independently confirmed) can be a MAB, removing MAB blocker.@ Joel Madero: My apologizeNo worries :-D One of the QA team members will look at it shortly (possibly myself), thanks for your understanding!CreatedBug ImpressComment onBug ImpressHi,I have a similar problem than Vulcain.I use LibreOffice 4.0.1.0+ (Build ID: a5acd33bc54cbc00f2194c923641fbd0ab45d80)My problem doesn't exist with LibreOffice 3.6I have created a slide with 2 blocks (text).The first text is not animated.The second one is animated with the animation "Apparition" after mouse click.When I start the display of the slide, the two blocks appear with on line missing in the first block ! If I click on my mouse, the missing line appears !I was unable to verify on:Version 4.1.0.0.alpha0+ (Build ID: 6c89f2e74aa9b202d6d6a41a178ba9aadb2b10e)Date: Mon Feb 18 23:17:44 2013 +0100+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++Because of this I am updating this bug again to RESOLVED - WFMI am also attaching a document that I just created that shows that animation indeed works.@ Those seeing the issue - please open my attachment and see if it works for you@ Ticrob - that seems like a separate issue and should be reported separatelyThanks all for your patience, understanding and assistanceCreatedTwo bullets with animationI can still reproduce this behavior using Linux Mint 14 x64 with LibreOffice 4.0.0.3 release and Version 4.1.0.0.alpha0+ (Build ID: c5c5d87e8838b372968481483a5e20f5c5f56e3) with YOUR attachment. Can't reproduce using Joel's attachment or try it from scratch.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Okay, due all those duplicates... let's reopen this one.I can reproduce this behavior only when I add a custom animation to the whole Textbox.@thorsten, Radek: following 'FindTheExpert' I think both of you are the one to 'ping'?Following these many duplicates I think many people are affected + regression. I hope I can bibisect this one.Kind regards,JorenI'll place this bug on the MAB4.0 list, following duplicate bugs this is a regression 3.6 vs 4.0. (I'll try to investigate this later).***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Createdbibisect40 log@Thorsten: see attachment :-). I hope that'll help kill this bug.Thanks in advance,Joren***has been marked as a duplicate of this bug. ***Due the massive amount of duplicate bug reports and thus affected users, I raise priority to 'Critical Highest'.Thanks for your time reporting and bughunting.Kind regards,Joren***has been marked as a duplicate of this bug. ***Same problem for meUbuntu 12.04 LibreOffice 4.0.0.3if the animation has one line per bullet/number it works fine, as soon as one bullet/number has more than one line of text it animates only some lines.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***It seems like this one is a bit wider problem then just custom animation being only first line - see. I believe these are all duplicates with the same root cause.Regression caused by rebasing on AOO 3.4, found & adapted one more fix from Armin.Nice! Thanks Thorsten :) Just pinged Michael about this also just to see if he knew anything about it.Again, thanks for the fix, seems like this was a super MABCherry-picked to 4-0, 4-0-1 review pending.Forgive my ignorance, but I see that this bug has been marked as "resolved - fixed" but I do not see a patch or a new version where it is has been fixed. Am I missing something?Commits in master and libreoffice-4-0, reviews for -4-0-1 pending here currently:***has been marked as a duplicate of this bug. ***(In reply to)I tested my custom animation case which failed in 4.0.0.3 using last night's version 4.0.0.3 (Build ID: 7545bee9c2a0782548772a21bc84a9dcc583b89) and it presented properly, so I say that it is fixed.Per last comment, marking as verifiedI'm sorry but I don't get it: how can I install this fix?thanks(In reply to)The 4.0.1 update will have it (planned for next week)***has been marked as a duplicate of this bug. ***Hello Jacques,Just to set the scene - I have just bought a projector that has an inbuiltdisplay program to project Microsoft Office files, includingppt presentations, from a memory stick. I therefore (for the first time)saved my presentation as a Microsoft ppt file and the result was disastrouswith lots of missing pictures and text when displayed using the projector’sOffice Viewer, but appeared okay when I reimported back into Libre Officeon my computer.Saving it as a pptx file was even worse on the projector and it did notre-import correctly back into Libre Office.Any ideas?Best regards,JonathanSent from Laptop *From:**Sent:* 27 February 2013 12:27*To:**Subject:* [] Custom animation: only the first line is animated *<> on bug59629 <> from*(In reply to<>)> I'm sorrybut I don't get it: how can I install this fix?>The 4.0.1 update will have it (planned for next week)------------------------------You are receiving this mail because: - You are on the CC list for the bug.@JonathanIt's for the bug here, not for a projector who could not read a closed format like ppt or complex format like pptx /Oxml. Test with odp/ODF ;-)For your problem, give a call to your vendor or to the constructor or ask to a forumVersion 4.0.0.3 release1.- You create a new presentation.2.- Erase objects3.- Create a new TEXT object with a long line (a lot of words).4.- Remove option "Fit width to text" in context pop menu "Position and Size..."See that THREE lines are created.5.- Select rectangle and Add custom effect Wipe.6.- Now change Direction to left.Unwanted effects:line disappears effects. It makes a mess.If you insert ALL new lines with the enter key the problem does not occur.(In reply to)We naturally can't fix 4.0.0.3 without a time machine. 4.0.1 (due this week) will have this fixed - please only reopen this bug if you can *still* reproduce the problem with the prerelease builds fromPerfect with version 4.0.1.2Fixed is ok. Sorry.(In reply to)Please do not change the bug version! This version should be the oldest version of LibreOffice that reproduce the behavior.Changed to earliest version.@EVERYONE - please do not change any of the top information without understanding what we use that information for. We use comments to say we've tested it on newer versions, the version field should NEVER get newer, only older if we can confirm on older releases. Thank youThe problem is still present in 4.0.1 RC2 (4.0.1.2).Animated text is not working. The last lines in any text box are not animated at all.In addition, the background image that I set in the master slide (a simple blue rectangle) is not shown.One strange thing is that even if I downloaded and installed the 4.0.1.2 deb package (Ububtu 12.10, gnome shell) the "about" says 4.0.1.1 (Build ID: 400m0(Build:1)). Aptitude (packet manager) confirms that the version installed is 4.0.1.2.Is it possible that the libreoffice server is giving a 4.0.1.1 version mistakenkly named 4.0.1.2?Any workaround or suggestion?This bug really sucks. And tomorrow morning I should be teaching my class...Sorry. I got confused with the package isntallation. I had both the 4.0.1.1 and the 4.0.1.2 installed at the same time. I can now confirm that the animation bug is resolved in the 4.0.1.2 release.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Doesn't occur in 4.0.2.1 anymore. Bug is verfied.
id=60088	LibreOffice installation through the main repository of Kubuntu 12.04.01.Any time a doc or xls document is open the Writer or Cacl respectively crash if user tryes to save, save as..., print or export as PDF. None of the change are recordered in the recovery.This can be reproduced every time no matter size of document (even a blank page causes the issue). After te first crash, any new document cannot be open due to 'no sufficient rights to access the file'. When trying to make a launch through termonal, the message is "user <username> doesn't exist".This can be reporoduced independantly in a small office 3 computers with 5 users (similar instalations).The issue is critical as it makes the office suite not usable.gk Hi. I'm sorry you're having that problem. I tested this using Ubuntu 12.04, but with LO Version 4.0.0.2 (Build ID: 408fe71bd18616c467b3dcd7ab6756528ffcae2). I did not encounter this issue when trying to export as pdf, or print to file. I used existing and new documents. I only recently stopped using LO 3.4 on Ubuntu, and did not experience a similar issue, but I can't speak for 3.5 specifically.
id=59886	Createdzip file containing current behavior, expected behavior, and the file saved as ODTProblem description: date (fixed) field won't save correctly to docxSteps to reproduce:1. create new text document2. insert a date (fixed) field3. save as docx4. close and re-open docx fileCurrent behavior:docx document displays "Date (fixed)"Expected behavior:display the date Operating System: Mac OS XVersion: 4.0.0.1 rc [Reproducible] with "LibO 4.0.0.2 rc - GERMAN UI / German Locale [Build ID: 5991f37846fc3763493029c4958b57282c2597e)]" {tinderbox: @6, pull time 2013-01-24 07:20(?)} on German WIN7 Home Premium (64bit), also for Time (fixed) I see the effect when I open saved document with MS WORD Viewer and with LibOSame for (MSO2007) and OOXMLRTF, DOC, and others not affected.Already Reproducible (for document created with LibO 4.0) with * server installation of "LibreOffice 3.5.7.2 rc German UI/Locale [Build-ID: 3215f89-f603614-ab984f2-7348103-1225a5b] on German WIN7 Home Premium (64bit)* Server Installation of "LibreOffice 3.4.5 English UI [Build ID: OOO340m1 (Build:502)]" parallel Server installation on German WIN7 Home Premium (64bit) Still worked fine with * Server Installation of "LibreOffice 3.3.3 English UI/ German Locale [OOO330m19 (Build:301) tag libreoffice-3.3.3.1] on German WIN7 Home Premium (64bit) So might have been introduced with 3.4?@Layton NelsonThank you for your attention!@Michael:Please set Status to ASSIGNED and add yourself to "Assigned To" if you accept this Bug or forward the Bug if it's not your turfBehavior still occurs in Writer from all versions of 4.0.0 and 4.1.0 release on Windows XP and Windows 7.To repeat the issue: In any writer document, insert today's date or time from the menu, i.e. Insert/Fields/Date, Insert/Fields/Time, Insert/Fields/Other/Date(fixed), or Insert/Fields/Other/Time(fixed).Then save as Microsoft Word 2007/2010 XML (.docx) or Office Open XML Text (.docx)Close the document and reopen.The reopened document shows the date or time wrong as the text 'Date (fixed)' or 'Time (fixed)' instead of the actual date or time.Can reproduce in LibreOffice 4.0.5.2 and 4.1.1.2.Createdthe ODT file with data and time fieldCreatedthe same file saved as .DOCX (MS OFFICE 2007/2010)Date and time fields become "Date (fixed)" and "Time (Fixed)"(This is an automated message.)Setting priority to highest as this is a 4.0 MAB. This is part of an effort to make the importance of MAB reflected in priority too.Set from "normal" to "critical" as there is DATA LOSS.Please downgrade if someone disagree.Moving to mab4.1 () because:- 4.0 reached EOL (End Of Life)- bug confirmed in later versionCan reproduce in LibreOffice in 4.2.0.4I mentioned <> inthat I have seen a bibliography entry changed to "Bibliography entry" after save as docx and reload. That sounds similar to this bug, although that bug is mostly about fields being lost.still reproducible with 4.2.3.3 and 4.3.0.0.alpha1+Build ID: f76026a43acc65465882924796d93e635c35fd90TinderBox: Win-x86@39, Branch:master, Time: 2014-05-04_06:34:33lpha1+moving to mab4.2 list since 4.1.x is END OF LIFEIt happens also with input text field of word!I can work on word input field using openoffice via reflection, but I can't do the same with libreoffice, whenever I open a word document containing those text fields they become simple text!LibreOffice_4.2.4Has this problem disappeared in 4.3? If not, is there any chance of adding this to m.a.b. 4.3 (given that 4.2 is near to its end, and it is a genuinely annoying bug)?Can reproduce bug in LibreOffice 4.3.3.2Can this bug become part of mab 4.3 (given that it was in mab 4.2, which is at end-of-life)?(In reply to sdc.blanco from)No. QA people will do this at the time at a proper time.moving to mab4.3 list. has anybody tried it with 4.4.x or 4.5.x daily builds?Eilidh McAdam committed a patch related to this issue.It has been pushed to "master":fdo#59886 export fixed date and time fields to docx.It will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Eilidh McAdam committed a patch related to this issue.It has been pushed to "master":fdo#59886 unit tests for DOCX fixed date field import/export.It will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.issue still reproducible under Win8.1 x64 using LibO 4.4.3.2can anyone retest with 5.0.x to see if the patch really fixed the problem?Tested in Ubuntu 14.04 with LibreOffice 5.0.0.5 the issue is gone.The Date(fixed) is shown correctly on LibreOffice after re-opening the file.Also opened in MS Word 2002 and it works correctly.I changed the status to Resolved (Fixed) if anyone see's different behaviour feel free to change back.Confirm fixed inWindows 7 x86,Version: 5.0.0.5Build ID: 1b1a90865e348b492231e1c451437d7a15bb262bLocale: zh-CN (zh_CN)
id=59782	Problem description: LibreOffice crashes when I try to open the font list (for example in Writer), even in the Preferences | Fonts. The fonts permissions are OK, I compared them to the one on another Mac OS X Lion. I also tried to delete the user preferences, but didn't work, still the same crash. It's a font related problem.Operating System:Mac OS X Lion 10.7.5Steps to reproduce:1. Start LibreOffice2. Click on Text Document3. Select the Font ComboboxCurrent behavior:It crashes.Expected behavior:Showing the font list.This is the crash report:Process: soffice [72842]Path: /Applications/LibreOffice.app/Contents/MacOS/sofficeIdentifier: org.libreoffice.scriptVersion: 3.6.4.3 (???)Code Type: X86 (Native)Parent Process: launchd [411]Date/Time: 2013-01-23 22:47:57.401 +0100OS Version: Mac OS X 10.7.5 (11G63)Report Version: 9Sleep/Wake UUID: AE414432-6808-4025-A1AC-8A5CD7ECACB4Interval Since Last Report: 304897 secCrashes Since Last Report: 7Per-App Interval Since Last Report: 5826 secPer-App Crashes Since Last Report: 5Anonymous UUID: BCEDEBD2-76AB-40A1-92A7-E313C1D10890Crashed Thread: 0 Dispatch queue: com.apple.main-threadException Type: EXC_BAD_ACCESS (SIGSEGV)Exception Codes: KERN_INVALID_ADDRESS at 0x00000000aa4831e0VM Regions Near 0xaa4831e0: __LINKEDIT 000000008fee2000-000000008fef5000 [ 76K] r--/rwx SM=COW /usr/lib/dyld--> Submap 0000000090000000-00000000ac000000 r--/rwx machine-wide submap mapped file 0000000090000000-0000000090005000 [ 20K] r-x/r-x SM=COW Object_id=d568858Application Specific Information:objc[72842]: garbage collection is OFFPerforming @selector(showPreferences:) from sender NSMenuItem 0x1c73d2a0Thread 0 Crashed:: Dispatch queue: com.apple.main-thread0 com.apple.ApplicationServices.ATS 0x90803c2b ProcessSingleMorphRun + 46281 com.apple.ApplicationServices.ATS 0x90805918 ApplyMorphForRun + 5872 com.apple.ApplicationServices.ATS 0x90801e20 ApplyMorph + 1603 com.apple.ApplicationServices.ATS 0x90801c54 _eLLCLayoutText + 2534 com.apple.ApplicationServices.ATS 0x907eaa34 LLCLayoutText + 775 com.apple.QD 0x95cd499e ATSULayoutGlyphs(TATSUGlyphRecordArray*, ATSLineLayoutLineParams*, long, ATSUTab const*, unsigned long, __CFString const*, unsigned short const*, unsigned long, unsigned long) + 17326 com.apple.QD 0x95cf2a7c TTextLineLayout::LayoutGlyphVector(TATSUGlyphRecordArray*, ATSLineLayoutLineParams*, TLayoutControls*, long, unsigned long) + 1747 com.apple.QD 0x95cead0a TTextLineLayout::EnsureLayoutIsUpToDate(unsigned long, unsigned char, unsigned long, TATSUGlyphRecordArray**) + 9368 com.apple.QD 0x95ced49e TTextLineLayout::GetGlyphBounds(unsigned long, unsigned long, long, long, unsigned short, unsigned long, ATSTrapezoid*, unsigned long*) + 1709 com.apple.QD 0x95cd7476 ATSUGetGlyphBounds + 14610 libvcllo.dylib 0x01aefcff ATSLayout::GetTextWidth() const + 19111 libvcllo.dylib 0x01aef7ed ATSLayout::AdjustLayout(ImplLayoutArgs&) + 2912 libvcllo.dylib 0x0192675d OutputDevice::ImplLayout(String const&, unsigned short, unsigned short, Point const&, long, long const*, bool) const + 41313 libvcllo.dylib 0x01928814 OutputDevice::GetTextArray(String const&, long*, unsigned short, unsigned short) const + 13214 libvcllo.dylib 0x01928980 OutputDevice::GetTextWidth(String const&, unsigned short, unsigned short) const + 4815 libvcllo.dylib 0x01849e1f ImplListBoxWindow::ImplUpdateEntryMetrics(ImplEntryType&) + 38316 libvcllo.dylib 0x0184d93d ImplListBoxWindow::InsertEntry(unsigned short, ImplEntryType*) + 10917 libvcllo.dylib 0x0184db2e ImplListBox::InsertEntry(unsigned short, String const&) + 11018 libvcllo.dylib 0x018214f5 ComboBox::InsertEntry(String const&, unsigned short) + 5319 libsvtlo.dylib 0x00c10459 FontNameBox::Fill(FontList const*) + 44120 libcuilo.dylib 0x21b105a5 SvxFontSubstTabPage::Reset(SfxItemSet const&) + 13321 libcuilo.dylib 0x21b93383 OfaTreeOptionsDialog::SelectHdl_Impl() + 317122 libcuilo.dylib 0x21b93981 OfaTreeOptionsDialog::ShowPageHdl_Impl(void*) + 1723 libsvtlo.dylib 0x00be0bc2 SvLBox::SelectHdl() + 3424 libsvtlo.dylib 0x00beb333 SvTreeListBox::Select(SvLBoxEntry*, unsigned char) + 13125 libsvtlo.dylib 0x00bd7708 SvImpLBox::SetCursor(SvLBoxEntry*, unsigned char) + 53626 libsvtlo.dylib 0x00bd7eeb ImpLBSelEng::SetCursorAtPoint(Point const&, unsigned char) + 9127 libvcllo.dylib 0x01a7bc41 SelectionEngine::SelMouseButtonDown(MouseEvent const&) + 27328 libsvtlo.dylib 0x00bda982 SvImpLBox::MouseButtonDown(MouseEvent const&) + 56229 libvcllo.dylib 0x01acc12f ImplHandleMouseEvent(Window*, unsigned short, unsigned char, long, long, unsigned long, unsigned short, unsigned short) + 167930 libvcllo.dylib 0x01acd4d2 ImplWindowFrameProc(Window*, SalFrame*, unsigned short, void const*) + 85031 libvcllo.dylib 0x01b2f288 -[SalFrameView sendMouseEventToFrame:button:eventtype:] + 52032 libvcllo.dylib 0x01b2b421 -[SalFrameView mouseDown:] + 11333 com.apple.AppKit 0x9bd6cdcd -[NSWindow sendEvent:] + 753334 com.apple.AppKit 0x9bd05f77 -[NSApplication sendEvent:] + 478835 libvcllo.dylib 0x01b210fc -[VCL_NSApplication sendEvent:] + 10836 libvcllo.dylib 0x01ad89cd AquaSalInstance::Yield(bool, bool) + 121337 libvcllo.dylib 0x017eff60 Application::Yield(bool) + 9638 libvcllo.dylib 0x01a38a55 Dialog::Execute() + 11739 libcuilo.dylib 0x21b9463b OfaTreeOptionsDialog::Execute() + 10740 libcuilo.dylib 0x21af3f07 VclAbstractDialog_Impl::Execute() + 2341 libsfxlo.dylib 0x00500eb9 SfxApplication::OfaExec_Impl(SfxRequest&) + 119342 libsfxlo.dylib 0x0059426d SfxDispatcher::Call_Impl(SfxShell&, SfxSlot const&, SfxRequest&, unsigned char) + 52543 libsfxlo.dylib 0x0058a8d8 SfxBindings::Execute_Impl(SfxRequest&, SfxSlot const*, SfxShell*) + 10444 libsfxlo.dylib 0x005adc8a SfxDispatchController_Impl::dispatch(com::sun::star::util::URL const&, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&, com::sun::star::uno::Reference<com::sun::star::frame::XDispatchResultListener> const&) + 393045 libsfxlo.dylib 0x005aefdf SfxOfficeDispatch::dispatch(com::sun::star::util::URL const&, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) + 36746 libfwklo.dylib 0x1c2da4ed framework::WindowCommandDispatch::impl_dispatchCommand(rtl::OUString const&) + 82947 libfwklo.dylib 0x1c2db04d framework::WindowCommandDispatch::impl_notifyCommand(void*) + 25348 libvcllo.dylib 0x018046ce VclEventListeners::Call(VclSimpleEvent*) const + 49449 libvcllo.dylib 0x01ab5033 Window::CallEventListeners(unsigned long, void*) + 13150 libvcllo.dylib 0x01ab6816 Window::Command(CommandEvent const&) + 3851 libvcllo.dylib 0x01aca895 ImplCallCommand(Window*, unsigned short, void*, unsigned char, Point*) + 24552 libvcllo.dylib 0x01acd37d ImplWindowFrameProc(Window*, SalFrame*, unsigned short, void const*) + 50953 libvcllo.dylib 0x01b0e047 -[MainMenuSelector showDialog:] + 11954 libvcllo.dylib 0x01b0dfa0 -[MainMenuSelector showPreferences:] + 8055 com.apple.CoreFoundation 0x900aed11 -[NSObject performSelector:withObject:] + 6556 com.apple.AppKit 0x9bda5663 -[NSApplication sendAction:to:from:] + 23257 com.apple.AppKit 0x9be98caf -[NSMenuItem _corePerformAction] + 53658 com.apple.AppKit 0x9be9892c -[NSCarbonMenuImpl performActionWithHighlightingForItemAtIndex:] + 17159 com.apple.AppKit 0x9be97fb5 -[NSMenu _performActionWithHighlightingForItemAtIndex:sendAccessibilityNotification:] + 7960 com.apple.AppKit 0x9c173ef7 -[NSMenu performActionForItemAtIndex:] + 6561 com.apple.AppKit 0x9c173f2a -[NSMenu _internalPerformActionForItemAtIndex:] + 4562 com.apple.AppKit 0x9c17815b -[NSMenuItem _internalPerformActionThroughMenuIfPossible] + 10663 com.apple.AppKit 0x9bfde670 -[NSCarbonMenuImpl _carbonCommandProcessEvent:handlerCallRef:] + 17264 com.apple.AppKit 0x9be0e246 NSSLMMenuEventHandler + 45265 com.apple.HIToolbox 0x93600c0c _InvokeEventHandlerUPP(OpaqueEventHandlerCallRef*, OpaqueEventRef*, void*, long (*)(OpaqueEventHandlerCallRef*, OpaqueEventRef*, void*)) + 3666 com.apple.HIToolbox 0x9347c313 _ZL23DispatchEventToHandlersP14EventTargetRecP14OpaqueEventRefP14HandlerCallRec + 160267 com.apple.HIToolbox 0x9347b790 _ZL30SendEventToEventTargetInternalP14OpaqueEventRefP20OpaqueEventTargetRefP14HandlerCallRec + 48268 com.apple.HIToolbox 0x93490571 SendEventToEventTarget + 7669 com.apple.HIToolbox 0x936010d0 _ZL18SendHICommandEventmPK9HICommandmmhPKvP20OpaqueEventTargetRefS5_PP14OpaqueEventRef + 48270 com.apple.HIToolbox 0x9360113a SendMenuCommandWithContextAndModifiers + 7071 com.apple.HIToolbox 0x9366c98d SendMenuItemSelectedEvent + 27572 com.apple.HIToolbox 0x934ccd79 _ZL19FinishMenuSelectionP13SelectionDataP10MenuResultS2_ + 12973 com.apple.HIToolbox 0x9365d88c _ZL14MenuSelectCoreP8MenuData5PointdmPP13OpaqueMenuRefPt + 60874 com.apple.HIToolbox 0x934c4a2a _HandleMenuSelection2 + 63675 com.apple.HIToolbox 0x934c47a9 _HandleMenuSelection + 5376 com.apple.AppKit 0x9bd0bbd2 _NSHandleCarbonMenuEvent + 30277 com.apple.AppKit 0x9bc9c4d6 _DPSNextEvent + 219678 com.apple.AppKit 0x9bc9b752 -[NSApplication nextEventMatchingMask:untilDate:inMode:dequeue:] + 11379 libvcllo.dylib 0x01ad89af AquaSalInstance::Yield(bool, bool) + 118380 libvcllo.dylib 0x017eff60 Application::Yield(bool) + 9681 libvcllo.dylib 0x017f0061 Application::Execute() + 9782 libsofficeapp.dylib 0x000784db desktop::Desktop::Main() + 617183 libvcllo.dylib 0x017f9582 ImplSVMain() + 35484 libvcllo.dylib 0x01ad7d7b AquaSalInstance::handleAppDefinedEvent(NSEvent*) + 7585 libvcllo.dylib 0x01b211cb -[VCL_NSApplication sendEvent:] + 31586 com.apple.AppKit 0x9bc97b21 -[NSApplication run] + 100787 com.apple.AppKit 0x9bf28ac5 NSApplicationMain + 105488 libvcllo.dylib 0x01ad9337 ImplSVMainHook(int*) + 34389 libvcllo.dylib 0x017f9611 SVMain() + 1790 libsofficeapp.dylib 0x000a74e5 soffice_main + 43791 org.libreoffice.script 0x00001f0e main + 3092 org.libreoffice.script 0x00001872 _start + 21693 org.libreoffice.script 0x00001799 start + 41Thread 1:0 libsystem_kernel.dylib 0x9b1a683e __psynch_cvwait + 101 libsystem_c.dylib 0x93ddde78 _pthread_cond_wait + 9142 libsystem_c.dylib 0x93d857f5 pthread_cond_timedwait + 473 libuno_sal.dylib.3 0x00014928 rtl_cache_wsupdate_all(void*) + 2804 libsystem_c.dylib 0x93dd9ed9 _pthread_start + 3355 libsystem_c.dylib 0x93ddd6de thread_start + 34Thread 2:: Dispatch queue: com.apple.libdispatch-manager0 libsystem_kernel.dylib 0x9b1a790a kevent + 101 libdispatch.dylib 0x97ae4e04 _dispatch_mgr_invoke + 9692 libdispatch.dylib 0x97ae3853 _dispatch_mgr_thread + 53Thread 3:0 libsystem_kernel.dylib 0x9b1a702e __workq_kernreturn + 101 libsystem_c.dylib 0x93ddbccf _pthread_wqthread + 7732 libsystem_c.dylib 0x93ddd6fe start_wqthread + 30Thread 4:0 libsystem_kernel.dylib 0x9b1a702e __workq_kernreturn + 101 libsystem_c.dylib 0x93ddbccf _pthread_wqthread + 7732 libsystem_c.dylib 0x93ddd6fe start_wqthread + 30Thread 5:0 libsystem_kernel.dylib 0x9b1a5e2e __accept_nocancel + 101 libsystem_kernel.dylib 0x9b1a530d accept + 392 libuno_sal.dylib.3 0x0000754a osl_acceptPipe + 583 libsofficeapp.dylib 0x000a434e desktop::OfficeIPCThread::execute() + 464 libuno_salhelpergcc3.dylib.3 0x004d1da2 salhelper::Thread::run() + 345 libuno_salhelpergcc3.dylib.3 0x004d2152 threadFunc + 186 libuno_sal.dylib.3 0x0000dc12 osl_thread_start_Impl + 4347 libsystem_c.dylib 0x93dd9ed9 _pthread_start + 3358 libsystem_c.dylib 0x93ddd6de thread_start + 34Thread 6:0 libsystem_kernel.dylib 0x9b1a683e __psynch_cvwait + 101 libsystem_c.dylib 0x93ddde78 _pthread_cond_wait + 9142 libsystem_c.dylib 0x93d857f5 pthread_cond_timedwait + 473 libuno_sal.dylib.3 0x00031b29 osl_waitCondition + 2814 libupdchk.dylib 0x1dbc66b0 (anonymous namespace)::InitUpdateCheckJobThread::run() + 1445 libupdchk.dylib 0x1dbb6652 threadFunc + 186 libuno_sal.dylib.3 0x0000dc12 osl_thread_start_Impl + 4347 libsystem_c.dylib 0x93dd9ed9 _pthread_start + 3358 libsystem_c.dylib 0x93ddd6de thread_start + 34Thread 7:0 libsystem_kernel.dylib 0x9b1a683e __psynch_cvwait + 101 libsystem_c.dylib 0x93ddde78 _pthread_cond_wait + 9142 libsystem_c.dylib 0x93d8582a pthread_cond_wait + 483 libuno_sal.dylib.3 0x00031a78 osl_waitCondition + 1044 liblnglo.dylib 0x1d82a0a3 GrammarCheckingIterator::DequeueAndCheck() + 25635 libuno_sal.dylib.3 0x0000dc12 osl_thread_start_Impl + 4346 libsystem_c.dylib 0x93dd9ed9 _pthread_start + 3357 libsystem_c.dylib 0x93ddd6de thread_start + 34Thread 8:0 libsystem_kernel.dylib 0x9b1a683e __psynch_cvwait + 101 libsystem_c.dylib 0x93ddde78 _pthread_cond_wait + 9142 libsystem_c.dylib 0x93d857f5 pthread_cond_timedwait + 473 libuno_sal.dylib.3 0x00031b29 osl_waitCondition + 2814 configmgr.uno.dylib 0x0aab9c9b configmgr::Components::WriteThread::execute() + 435 libuno_salhelpergcc3.dylib.3 0x004d1da2 salhelper::Thread::run() + 346 libuno_salhelpergcc3.dylib.3 0x004d2152 threadFunc + 187 libuno_sal.dylib.3 0x0000dc12 osl_thread_start_Impl + 4348 libsystem_c.dylib 0x93dd9ed9 _pthread_start + 3359 libsystem_c.dylib 0x93ddd6de thread_start + 34Thread 0 crashed with X86 Thread State (32-bit): eax: 0x0b5b3500 ebx: 0x00002118 ecx: 0x0b5a1210 edx: 0x9eecfce0 edi: 0x00000011 esi: 0x11a724d4 ebp: 0xbfffbf98 esp: 0xbfffba10 ss: 0x0000001f efl: 0x00210a07 eip: 0x90803c2b cs: 0x00000017 ds: 0x0000001f es: 0x0000001f fs: 0x00000000 gs: 0x00000037 cr2: 0xaa4831e0Logical CPU: 1Binary Images: 0x1000 - 0x1ff7 +org.libreoffice.script (3.6.4.3 - ???) <F4A8D041-8B26-9639-91C9-8C7B5D3DF8E0> /Applications/LibreOffice.app/Contents/MacOS/soffice 0x5000 - 0x44ffb +libuno_sal.dylib.3 (??? - ???) <54386225-921A-880E-536B-0B00E33C1290> /Applications/LibreOffice.app/Contents/ure-link/lib/libuno_sal.dylib.3 0x64000 - 0xcdfe3 +libsofficeapp.dylib (??? - ???) <BE3D31D5-7A96-BE84-BCD1-816A15385965> /Applications/LibreOffice.app/Contents/MacOS/libsofficeapp.dylib 0x100000 - 0x220ff7 +libcomphelpgcc3.dylib (??? - ???) <CA0C3D40-512A-1471-5202-8803E05D2DA0> /Applications/LibreOffice.app/Contents/MacOS/libcomphelpgcc3.dylib 0x2fb000 - 0x32cfeb +libuno_cppu.dylib.3 (??? - ???) <C5357207-4466-0014-FC44-65DADB44A95D> /Applications/LibreOffice.app/Contents/ure-link/lib/libuno_cppu.dylib.3 0x340000 - 0x409fe3 +libuno_cppuhelpergcc3.dylib.3 (??? - ???) <9C7FA61E-22CF-9BD0-2D5E-CC35381892FA> /Applications/LibreOffice.app/Contents/ure-link/lib/libuno_cppuhelpergcc3.dylib.3 0x487000 - 0x4acff7 +libdeploymentmisclo.dylib (??? - ???) <5616F78D-D4AE-603C-F73D-F9D385276185> /Applications/LibreOffice.app/Contents/MacOS/libdeploymentmisclo.dylib 0x4c7000 - 0x4cbff7 +libi18nisolang1gcc3.dylib (??? - ???) <DDFB8FA6-6C50-33B0-B989-1824663415E4> /Applications/LibreOffice.app/Contents/MacOS/libi18nisolang1gcc3.dylib 0x4d0000 - 0x4d3ffb +libuno_salhelpergcc3.dylib.3 (??? - ???) <445B68A3-51B0-1036-711E-0406FCDD962F> /Applications/LibreOffice.app/Contents/ure-link/lib/libuno_salhelpergcc3.dylib.3 0x4d9000 - 0x839fef +libsfxlo.dylib (??? - ???) <2CB2BAFB-F005-222D-291D-86CAABF8E7AD> /Applications/LibreOffice.app/Contents/MacOS/libsfxlo.dylib 0xa32000 - 0xafafe7 +libsvllo.dylib (??? - ???) <C715A824-2983-D877-DBAB-2ECB290E1AB3> /Applications/LibreOffice.app/Contents/MacOS/libsvllo.dylib 0xb6a000 - 0xe87feb +libsvtlo.dylib (??? - ???) <B6985A40-D4E1-7C43-36D5-9B7DD3F0418F> /Applications/LibreOffice.app/Contents/MacOS/libsvtlo.dylib 0x1061000 - 0x12b4fef +libtklo.dylib (??? - ???) <837259DC-A4D5-B510-93AE-0558403147D5> /Applications/LibreOffice.app/Contents/MacOS/libtklo.dylib 0x1516000 - 0x1587fff +libtllo.dylib (??? - ???) <D077F75C-6986-C7C0-20AD-81D8A4A2A37D> /Applications/LibreOffice.app/Contents/MacOS/libtllo.dylib 0x15b1000 - 0x160dffb +libucbhelper4gcc3.dylib (??? - ???) <8B81FB01-286C-5AC5-3402-4C565AC63FDC> /Applications/LibreOffice.app/Contents/MacOS/libucbhelper4gcc3.dylib 0x164d000 - 0x1751ffb +libutllo.dylib (??? - ???) <6AAE7C8F-A653-E8AC-C1B1-153CD3838296> /Applications/LibreOffice.app/Contents/MacOS/libutllo.dylib 0x17df000 - 0x1bb4fe7 +libvcllo.dylib (??? - ???) <4A241792-B397-C474-DA60-4DAEEBEB0E8F> /Applications/LibreOffice.app/Contents/MacOS/libvcllo.dylib 0x1d4e000 - 0x1d63feb +libreg.dylib.3 (??? - ???) <AF57E7B9-FE36-3B69-1297-361ED2A0E370> /Applications/LibreOffice.app/Contents/ure-link/lib/libreg.dylib.3 0x1d6c000 - 0x1d76ff3 +libxmlreader.dylib (??? - ???) <E838ADFC-6E6C-DAB0-C6D5-848253BCA862> /Applications/LibreOffice.app/Contents/ure-link/lib/libxmlreader.dylib 0x1d7c000 - 0x1d96ff3 +libstore.dylib.3 (??? - ???) <ACE94E6C-3F14-30AE-9BD8-158BCA881BD5> /Applications/LibreOffice.app/Contents/ure-link/lib/libstore.dylib.3 0x1da5000 - 0x1e36fff +libxcrlo.dylib (??? - ???) <2D33C9E6-E945-3F36-F7ED-81900B0BD796> /Applications/LibreOffice.app/Contents/MacOS/libxcrlo.dylib 0x1e79000 - 0x1fdafe7 +libdb-4.7.dylib (??? - ???) <FD53B142-5B3D-56CD-5A27-E09384ABA3C6> /Applications/LibreOffice.app/Contents/MacOS/libdb-4.7.dylib 0x1ff0000 - 0x2081ffb +libbasegfxlo.dylib (??? - ???) <726FA37C-753A-ABB1-1998-E8CF4D3CBA76> /Applications/LibreOffice.app/Contents/MacOS/libbasegfxlo.dylib 0x20b3000 - 0x2135ff7 +libfwelo.dylib (??? - ???) <AF6EC72D-8A8F-E0C8-0B78-B856A4510344> /Applications/LibreOffice.app/Contents/MacOS/libfwelo.dylib 0x217f000 - 0x2198fe7 +libsaxlo.dylib (??? - ???) <C77E7EF3-D1AA-3999-41CE-8C4ED84E7312> /Applications/LibreOffice.app/Contents/MacOS/libsaxlo.dylib 0x21a9000 - 0x22f7fff +libsblo.dylib (??? - ???) <5D796493-B161-8096-8EBA-14552FE0ECCA> /Applications/LibreOffice.app/Contents/MacOS/libsblo.dylib 0x23bb000 - 0x2409feb +libsotlo.dylib (??? - ???) <148A5A1D-A6D3-53FE-968A-2E6485AC2934> /Applications/LibreOffice.app/Contents/MacOS/libsotlo.dylib 0x2435000 - 0x2463ffb +libfwilo.dylib (??? - ???) <31E7C927-581C-9EB6-5DE9-10ADF4B503C2> /Applications/LibreOffice.app/Contents/MacOS/libfwilo.dylib 0x2481000 - 0x2489fef +libi18nutilgcc3.dylib (??? - ???) <22044A98-BECF-2A0E-3981-5904679839E1> /Applications/LibreOffice.app/Contents/MacOS/libi18nutilgcc3.dylib 0x249d000 - 0x24b3ff7 +libjvmfwk.dylib.3 (??? - ???) <F4C94F52-9ECC-985F-1E25-EB0574AE7C5D> /Applications/LibreOffice.app/Contents/ure-link/lib/libjvmfwk.dylib.3 0x24bd000 - 0x25cdff3 +libicuuc.dylib.49 (49.1.1 - compatibility 49.0.0) <259B894C-DC8A-AA1D-895B-378C429DA334> /Applications/LibreOffice.app/Contents/MacOS/libicuuc.dylib.49 0x2627000 - 0x262bfff +libjvmaccessgcc3.dylib.3 (??? - ???) <B0D8E06E-D7FF-E89D-313D-74DE9356859E> /Applications/LibreOffice.app/Contents/ure-link/lib/libjvmaccessgcc3.dylib.3 0x2631000 - 0x265eff3 +libicule.dylib.49 (49.1.1 - compatibility 49.0.0) <4896B6B1-CD34-A1E9-7047-80D270876792> /Applications/LibreOffice.app/Contents/MacOS/libicule.dylib.49 0x2673000 - 0x26a9fe7 +liblcms2.2.dylib (3.3.0 - compatibility 3.0.0) <E1B654B3-2015-E742-EAC9-DB794B2C7F45> /Applications/LibreOffice.app/Contents/MacOS/liblcms2.2.dylib 0x26c8000 - 0x27e0ff7 +libcairo.2.dylib (11003.2.0 - compatibility 11003.0.0) <0B7462E7-4E0D-C9AC-8BC8-15E81C8CAD3F> /Applications/LibreOffice.app/Contents/MacOS/libcairo.2.dylib 0x2824000 - 0x282aff7 +libAppleRemotelo.dylib (??? - ???) <D848BE56-B679-531A-8F3E-08B41A0EBA1F> /Applications/LibreOffice.app/Contents/MacOS/libAppleRemotelo.dylib 0x2832000 - 0x3951ff7 +libicudata.dylib.49 (49.1.1 - compatibility 49.0.0) <8E93F4EC-A83A-462F-6FFE-A7283E8F170A> /Applications/LibreOffice.app/Contents/MacOS/libicudata.dylib.49 0x3fa9000 - 0x3fabfff +com.Logitech.Control Center.Scroll Enhancer Loader (2.6.0 - 2.6.0) /Library/InputManagers/*/LCC Scroll Enhancer Loader.bundle/Contents/MacOS/LCC Scroll Enhancer Loader 0x3fb1000 - 0x3fb2fff +com.1passwd.InputManager (2.5.8 - 5968) <4A20D22A-BB25-15AC-6E72-8631964A8239> /Library/InputManagers/*/1PasswdIM.bundle/Contents/MacOS/1PasswdIM 0x3fe4000 - 0x3fe5ff3 +com.quark.QXPScriptingAdditions.Bundle (7.0 - 7.0) <C817465E-19DC-66B4-10A6-25F072EA2032> /Library/ScriptingAdditions/QXPScriptingAdditions.osax/Contents/MacOS/QXPScriptingAdditions 0x3fe9000 - 0x3fecff7 +net.culater.SIMBL.osax (0.9.9 - 0.9.9) <FB5B987E-B3AE-8F9B-7BAE-2C635D76A7F2> /Library/ScriptingAdditions/SIMBL.osax/Contents/MacOS/SIMBL 0x7abc000 - 0x7ad7ff7 +com.randomapplications.sizewellplugin (??? - 0.8.2) <C2EC0A81-BACE-F140-BBF0-6A7D69C778A2> /Users/USER/Library/Application Support/SIMBL/*/SizeWell.bundle/Contents/MacOS/SizeWell 0x7af1000 - 0x7afdfff +libgcc3_uno.dylib (??? - ???) <6D201D32-53A3-9415-6107-F5929E06CE5C> /Applications/LibreOffice.app/Contents/ure-link/lib/libgcc3_uno.dylib 0x7b36000 - 0x7c01ff7 +bootstrap.uno.dylib (??? - ???) <E0358BB5-770F-CBEE-6B51-0C83128F9415> /Applications/LibreOffice.app/Contents/ure-link/lib/bootstrap.uno.dylib 0xaa85000 - 0xab1eff3 +configmgr.uno.dylib (??? - ???) <0227754F-DEF1-ED47-2285-464290479534> /Applications/LibreOffice.app/Contents/MacOS/configmgr.uno.dylib 0xb440000 - 0xb447ff3 +localebe1.uno.dylib (??? - ???) <6FE92791-B1DF-B482-F704-60E43233B42A> /Applications/LibreOffice.app/Contents/MacOS/localebe1.uno.dylib 0xb469000 - 0xb46fff3 +libspllo.dylib (??? - ???) <08909878-F286-26B5-5FCB-F55862BBF305> /Applications/LibreOffice.app/Contents/MacOS/libspllo.dylib 0xb479000 - 0xb48cfe3 +liblocaledata_en.dylib (??? - ???) <D7E2C99D-A16F-23D6-594B-17A84029BE6A> /Applications/LibreOffice.app/Contents/MacOS/liblocaledata_en.dylib 0xb760000 - 0xb8dafff +i18npool.uno.dylib (??? - ???) <BFCD0E8F-8788-9AFF-7267-3145A8E92802> /Applications/LibreOffice.app/Contents/MacOS/i18npool.uno.dylib 0xb968000 - 0xbad5fe3 +libicui18n.dylib.49 (49.1.1 - compatibility 49.0.0) <0E107A7F-D029-34B5-32DE-9D19BA0B61BA> /Applications/LibreOffice.app/Contents/MacOS/libicui18n.dylib.49 0xbbfb000 - 0xbc00ff3 +ucpexpand1.uno.dylib (??? - ???) <8C351AED-7C7F-1BF0-0BEA-D4F5751CCBB0> /Applications/LibreOffice.app/Contents/MacOS/ucpexpand1.uno.dylib 0xbc59000 - 0xbc84ff7 +introspection.uno.dylib (??? - ???) <37BD7D00-8EA1-BB58-90E7-3BCB41EE0A68> /Applications/LibreOffice.app/Contents/ure-link/lib/introspection.uno.dylib 0xbd5d000 - 0xbdbafe7 +libunoxmllo.dylib (??? - ???) <43254C66-51C3-F66D-7848-913CA0500D08> /Applications/LibreOffice.app/Contents/MacOS/libunoxmllo.dylib 0xc310000 - 0xc366ff7 +libucpchelp1.dylib (??? - ???) <A3EA8E52-4E55-34E2-076C-C6301EE29039> /Applications/LibreOffice.app/Contents/MacOS/libucpchelp1.dylib 0xe3ae000 - 0xe3aeffd +cl_kernels (??? - ???) <B7EABA66-F6D7-4594-9725-4F9FF1980B60> cl_kernels0x104b3000 - 0x104b5fff libCoreFSCache.dylib (??? - ???) <9E7CBE71-566C-36E9-A49F-C5FF6956D76F> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libCoreFSCache.dylib0x10521000 - 0x10682fe3 +libsal_textenc.dylib (??? - ???) <40D164FC-99C1-F643-5AA4-E5A493F63297> /Applications/LibreOffice.app/Contents/ure-link/lib/libsal_textenc.dylib0x1079d000 - 0x107a5ffb +macbe1.uno.dylib (??? - ???) <ED20C942-9CBD-127F-501C-776440B37E18> /Applications/LibreOffice.app/Contents/MacOS/macbe1.uno.dylib0x107e4000 - 0x10831ff3 +libucb1.dylib (??? - ???) <DD9210FF-82FC-7AB6-0C7B-97F8278D9C5C> /Applications/LibreOffice.app/Contents/MacOS/libucb1.dylib0x10c6e000 - 0x10cc9ffb +libucpfile1.dylib (??? - ???) <1A8D4312-26D2-9F83-742C-51C4D139ADC0> /Applications/LibreOffice.app/Contents/MacOS/libucpfile1.dylib0x10cf7000 - 0x10d47fe3 +libfilterconfiglo.dylib (??? - ???) <63EA6D7F-4E35-B63C-4A17-25075619F22F> /Applications/LibreOffice.app/Contents/MacOS/libfilterconfiglo.dylib0x10d8f000 - 0x10e73fff +libdrawinglayerlo.dylib (??? - ???) <F06A2D2A-EB41-F189-D2F7-ABAFDD0E20AD> /Applications/LibreOffice.app/Contents/MacOS/libdrawinglayerlo.dylib0x1ac8d000 - 0x1acd6feb +libuuilo.dylib (??? - ???) <E0B20BBB-A729-6081-8794-AE4C2BF0617B> /Applications/LibreOffice.app/Contents/MacOS/libuuilo.dylib0x1ad02000 - 0x1b76cff7 +libswlo.dylib (??? - ???) <47681842-EC16-5F97-39B9-5DFA41A283FC> /Applications/LibreOffice.app/Contents/MacOS/libswlo.dylib0x1bce8000 - 0x1bcf2ff3 +libswdlo.dylib (??? - ???) <12BAFDCD-0202-598C-712C-04CC1D06F720> /Applications/LibreOffice.app/Contents/MacOS/libswdlo.dylib0x1bcfd000 - 0x1bda0ffb +libvbahelperlo.dylib (??? - ???) <7B551825-1C0A-7017-CD84-5CB2C5610013> /Applications/LibreOffice.app/Contents/MacOS/libvbahelperlo.dylib0x1be1d000 - 0x1beb5feb +libmsfilterlo.dylib (??? - ???) <6FAECF52-3A5A-5E69-6282-FA2DA39ED6F2> /Applications/LibreOffice.app/Contents/MacOS/libmsfilterlo.dylib0x1c031000 - 0x1c0dfff3 +libxstor.dylib (??? - ???) <2464C875-C50F-CF32-56DF-A4272706E7BA> /Applications/LibreOffice.app/Contents/MacOS/libxstor.dylib0x1c11f000 - 0x1c140ff7 +reflection.uno.dylib (??? - ???) <C079B373-28F0-F496-2B92-4EEAB09FF919> /Applications/LibreOffice.app/Contents/ure-link/lib/reflection.uno.dylib0x1c16b000 - 0x1c17dff7 +libfileacc.dylib (??? - ???) <ECAE90D2-46D7-9619-344A-5317894C6846> /Applications/LibreOffice.app/Contents/MacOS/libfileacc.dylib0x1c18d000 - 0x1c1bdff7 +expwrap.uno.dylib (??? - ???) <0A362ADF-3765-5260-C047-9FCD258BA533> /Applications/LibreOffice.app/Contents/MacOS/expwrap.uno.dylib0x1c1e3000 - 0x1c20eff7 +fsstorage.uno.dylib (??? - ???) <A25C6DE9-9B25-0987-1098-4D5882C2D1DD> /Applications/LibreOffice.app/Contents/MacOS/fsstorage.uno.dylib0x1c27b000 - 0x1c4f6ffb +libfwklo.dylib (??? - ???) <EEFEF538-31D4-F80A-779A-B564FD7FAF40> /Applications/LibreOffice.app/Contents/MacOS/libfwklo.dylib0x1c64f000 - 0x1c66cfe7 +libavmedialo.dylib (??? - ???) <C0AC1D2F-0869-C5CE-A6A7-02969090B679> /Applications/LibreOffice.app/Contents/MacOS/libavmedialo.dylib0x1c689000 - 0x1c6b3ff3 +libcanvastoolslo.dylib (??? - ???) <D0642765-0C86-6189-1F2C-9E38C237327A> /Applications/LibreOffice.app/Contents/MacOS/libcanvastoolslo.dylib0x1c800000 - 0x1c9f5fe3 +libsvxlo.dylib (??? - ???) <06EDF574-8E0A-C93F-D42D-3A2B86646B9A> /Applications/LibreOffice.app/Contents/MacOS/libsvxlo.dylib0x1cb80000 - 0x1cd04fe7 +libeditenglo.dylib (??? - ???) <F4A9E6A5-1E0A-52C6-2C04-0210F2EC34E3> /Applications/LibreOffice.app/Contents/MacOS/libeditenglo.dylib0x1ce03000 - 0x1d369feb +libsvxcorelo.dylib (??? - ???) <A0D9E4BD-D3A3-D745-06F4-344C833FEF5A> /Applications/LibreOffice.app/Contents/MacOS/libsvxcorelo.dylib0x1d77c000 - 0x1d7cdffb +libcppcanvaslo.dylib (??? - ???) <19E7E726-4381-23BC-8B64-81276EC708FA> /Applications/LibreOffice.app/Contents/MacOS/libcppcanvaslo.dylib0x1d7fe000 - 0x1d879fff +liblnglo.dylib (??? - ???) <2B30BA3D-611E-F7D7-AD51-31759E12F202> /Applications/LibreOffice.app/Contents/MacOS/liblnglo.dylib0x1d8d5000 - 0x1d94dff3 +libpackage2.dylib (??? - ???) <E57D09BF-A6B5-4260-E883-BB76600EC2A4> /Applications/LibreOffice.app/Contents/MacOS/libpackage2.dylib0x1d9ff000 - 0x1da06ff7 +libmcnttype.dylib (??? - ???) <3D609DA3-357A-30E8-C982-5E94B2ED4212> /Applications/LibreOffice.app/Contents/MacOS/libmcnttype.dylib0x1da10000 - 0x1da28ff3 +stocservices.uno.dylib (??? - ???) <B5FFDC2B-910A-EBE2-04A6-D05D8867A095> /Applications/LibreOffice.app/Contents/ure-link/lib/stocservices.uno.dylib0x1db16000 - 0x1db1fff6 libcldcpuengine.dylib (2.0.19 - compatibility 1.0.0) <95A88DC8-E5EE-363F-9275-214D5AB7A2EF> /System/Library/Frameworks/OpenCL.framework/Libraries/libcldcpuengine.dylib0x1db60000 - 0x1db96fe3 +libhelplinkerlo.dylib (??? - ???) <4F967A7E-04E9-8349-AB90-5BFE8AA659E4> /Applications/LibreOffice.app/Contents/MacOS/libhelplinkerlo.dylib0x1dba7000 - 0x1dbefffb +libupdchk.dylib (??? - ???) <2D001F8C-12B5-65E5-15A7-8BEDCB4A05C6> /Applications/LibreOffice.app/Contents/MacOS/libupdchk.dylib0x1fcfb000 - 0x20098feb +libxolo.dylib (??? - ???) <C480363C-06FD-0820-011A-98204B444B2A> /Applications/LibreOffice.app/Contents/MacOS/libxolo.dylib0x2063f000 - 0x206e7ff7 unorm8_bgra.dylib (2.0.19 - compatibility 1.0.0) <99A967D2-5577-396B-BD11-56EAFF962AB2> /System/Library/Frameworks/OpenCL.framework/Libraries/ImageFormats/unorm8_bgra.dylib0x2105f000 - 0x2111ffef +libdeployment.dylib (??? - ???) <1B45BE57-AA5B-F8C1-9DC7-81518EF02CC3> /Applications/LibreOffice.app/Contents/MacOS/libdeployment.dylib0x211b3000 - 0x212faff3 +libclucene.dylib (??? - ???) <C4FDDB7D-07CD-7ADD-EE1A-AC99511F5E1C> /Applications/LibreOffice.app/Contents/MacOS/libclucene.dylib0x21a00000 - 0x21cc6fe3 +libcuilo.dylib (??? - ???) <555FF878-BD8A-55EF-4788-C9D2EC10520A> /Applications/LibreOffice.app/Contents/MacOS/libcuilo.dylib0x8fe84000 - 0x8feb6aa7 dyld (195.6 - ???) <3A866A34-4CDD-35A4-B26E-F145B05F3644> /usr/lib/dyld0x90005000 - 0x9000fff2 com.apple.audio.SoundManager (3.9.4.1 - 3.9.4.1) <2A089CE8-9760-3F0F-B77D-29A78940EA17> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/CarbonSound.framework/Versions/A/CarbonSound0x90010000 - 0x90012ffb libRadiance.dylib (??? - ???) <4721057E-5A1F-3083-911B-200ED1CE7678> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/Resources/libRadiance.dylib0x90013000 - 0x90013fff com.apple.audio.units.AudioUnit (1.7.3 - 1.7.3) <2E71E880-25D1-3210-8D26-21EC47ED810C> /System/Library/Frameworks/AudioUnit.framework/Versions/A/AudioUnit0x90014000 - 0x901ebfe7 com.apple.CoreFoundation (6.7.2 - 635.21) <4D1D2BAF-1332-32DF-A81B-7E79D4F0A6CB> /System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation0x901ec000 - 0x901ffff8 com.apple.MultitouchSupport.framework (231.4 - 231.4) <083F7787-4C3B-31DA-B5BB-1993D9A9723D> /System/Library/PrivateFrameworks/MultitouchSupport.framework/Versions/A/MultitouchSupport0x90252000 - 0x904d7fe3 com.apple.QuickTime (7.7.1 - 2339) <FC82F13B-1788-3766-8681-7A3B1EFAE02D> /System/Library/Frameworks/QuickTime.framework/Versions/A/QuickTime0x904e3000 - 0x904e3fff libOpenScriptingUtil.dylib (??? - ???) <E4C22B65-9493-31D5-9D46-19BD70975587> /usr/lib/libOpenScriptingUtil.dylib0x905e7000 - 0x905fcfff com.apple.speech.synthesis.framework (4.0.74 - 4.0.74) <92AADDB0-BADF-3B00-8941-B8390EDC931B> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/SpeechSynthesis.framework/Versions/A/SpeechSynthesis0x90660000 - 0x90664ff3 libsystem_network.dylib (??? - ???) <62EBADDA-FC72-3275-AAB3-5EDD949FEFAF> /usr/lib/system/libsystem_network.dylib0x9067e000 - 0x9068efff com.apple.LangAnalysis (1.7.0 - 1.7.0) <6D6F0C9D-2EEA-3578-AF3D-E2A09BCECAF3> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/LangAnalysis.framework/Versions/A/LangAnalysis0x9068f000 - 0x906a9fff com.apple.Kerberos (1.0 - 1) <D7920A1C-FEC4-3460-8DD0-D02491578CBB> /System/Library/Frameworks/Kerberos.framework/Versions/A/Kerberos0x906aa000 - 0x906b2ff3 liblaunch.dylib (392.39.0 - compatibility 1.0.0) <9E6135FF-C2B1-3BC9-A160-B32D71BFA77C> /usr/lib/system/liblaunch.dylib0x906b3000 - 0x9074ffff com.apple.ink.framework (10.7.5 - 113) <05CAFB64-D3B8-3973-87EA-CB8BBE580F6B> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Ink.framework/Versions/A/Ink0x90750000 - 0x9075eff7 libxar-nossl.dylib (??? - ???) <5BF4DA8E-C319-354A-967E-A0C725DC8BA3> /usr/lib/libxar-nossl.dylib0x907ac000 - 0x90827ffb com.apple.ApplicationServices.ATS (317.12.0 - ???) <4D124B65-3D43-32E9-B296-3671347BB888> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/ATS0x90900000 - 0x90908ff5 libcopyfile.dylib (85.1.0 - compatibility 1.0.0) <A1BFC320-616A-30AA-A41E-29D7904FC4C7> /usr/lib/system/libcopyfile.dylib0x90909000 - 0x9094aff9 libcurl.4.dylib (7.0.0 - compatibility 7.0.0) <9FD420FB-7984-3A07-8914-BB19E687D38B> /usr/lib/libcurl.4.dylib0x90965000 - 0x90969ff7 com.apple.OpenDirectory (10.7 - 146) <4986A382-8FEF-3392-8CE9-CF6A5EE4E365> /System/Library/Frameworks/OpenDirectory.framework/Versions/A/OpenDirectory0x91118000 - 0x9111bffb com.apple.help (1.3.2 - 42) <DDCEBA10-5CDE-3ED2-A52F-5CD5A0632CA2> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Help.framework/Versions/A/Help0x911ae000 - 0x912ccfec com.apple.vImage (5.1 - 5.1) <7757F253-B281-3612-89D4-F2B04061CBE1> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vImage.framework/Versions/A/vImage0x912cd000 - 0x912e9ff5 com.apple.GenerationalStorage (1.0 - 126.1) <E622F823-7D98-3D13-9C3D-7EA482567394> /System/Library/PrivateFrameworks/GenerationalStorage.framework/Versions/A/GenerationalStorage0x92692000 - 0x926b4ff8 com.apple.PerformanceAnalysis (1.11 - 11) <453463FF-7C42-3526-8C96-A9971EE07154> /System/Library/PrivateFrameworks/PerformanceAnalysis.framework/Versions/A/PerformanceAnalysis0x926b5000 - 0x926b8ffd libCoreVMClient.dylib (??? - ???) <B8F8916D-F12A-3D95-ABF3-999D57B7D581> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libCoreVMClient.dylib0x926b9000 - 0x926bfffd com.apple.CommerceCore (1.0 - 17) <71641C17-1CA7-3AC9-974E-AAC9EB641035> /System/Library/PrivateFrameworks/CommerceKit.framework/Versions/A/Frameworks/CommerceCore.framework/Versions/A/CommerceCore0x926c6000 - 0x926c6ff0 com.apple.ApplicationServices (41 - 41) <BED33E1D-C95C-3654-9A3A-0CB3607F9F10> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/ApplicationServices0x92704000 - 0x92705fff libsystem_blocks.dylib (53.0.0 - compatibility 1.0.0) <B04592B1-0924-3422-82FF-976B339DF567> /usr/lib/system/libsystem_blocks.dylib0x92851000 - 0x92852ff7 libsystem_sandbox.dylib (??? - ???) <5CFCCFB7-CF29-3E04-801D-8532AE004768> /usr/lib/system/libsystem_sandbox.dylib0x92a61000 - 0x92d3bff7 com.apple.RawCamera.bundle (4.00 - 658) <F72D5DF2-406B-3310-AC16-F0AB434237DE> /System/Library/CoreServices/RawCamera.bundle/Contents/MacOS/RawCamera0x92d3c000 - 0x92d58ff1 libPng.dylib (??? - ???) <F084226B-14F0-36C0-B5EC-22C78406D2B6> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/Resources/libPng.dylib0x92d59000 - 0x92d97fff libRIP.A.dylib (600.0.0 - compatibility 64.0.0) <AF1174F9-4402-31EB-9C84-AB644E5865DF> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/Resources/libRIP.A.dylib0x92d98000 - 0x92e00fff libc++.1.dylib (28.4.0 - compatibility 1.0.0) <B24814AB-CA77-3B9D-8FAB-58C9B4FD3A16> /usr/lib/libc++.1.dylib0x93131000 - 0x93183ff7 libFontRegistry.dylib (??? - ???) <C2B84661-A62D-3FFF-8D8C-BC697E9BDF4C> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/Resources/libFontRegistry.dylib0x93184000 - 0x93184ff2 com.apple.CoreServices (53 - 53) <7CB7AA95-D5A7-366A-BB8A-035AA9E582F8> /System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices0x93185000 - 0x93186ff0 libunc.dylib (24.0.0 - compatibility 1.0.0) <BCD277D0-4271-3E96-A4A2-85669DBEE2E2> /usr/lib/system/libunc.dylib0x93187000 - 0x931e5ff7 com.apple.coreui (1.2.2 - 165.11) <340B0B83-1407-3AB4-BCAB-505C29303EE2> /System/Library/PrivateFrameworks/CoreUI.framework/Versions/A/CoreUI0x931ff000 - 0x93473ff3 com.apple.CoreImage (7.99.1 - 1.0.1) <C4B2DD2A-8E45-31CD-9B25-2AC1CA252B14> /System/Library/Frameworks/QuartzCore.framework/Versions/A/Frameworks/CoreImage.framework/Versions/A/CoreImage0x93474000 - 0x937baff3 com.apple.HIToolbox (1.9 - ???) <E5EA9EEF-3CCA-36A0-8688-DA2E64E2256C> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/HIToolbox.framework/Versions/A/HIToolbox0x937bb000 - 0x93852ff3 com.apple.securityfoundation (5.0 - 55116) <EB53CEF7-4836-39FD-B012-6BC122ED4CE9> /System/Library/Frameworks/SecurityFoundation.framework/Versions/A/SecurityFoundation0x93aa7000 - 0x93aeaffd libcommonCrypto.dylib (55010.0.0 - compatibility 1.0.0) <4BA1F5F1-F0A2-3FEB-BB62-F514DCBB3725> /usr/lib/system/libcommonCrypto.dylib0x93af0000 - 0x93c46fff com.apple.audio.toolbox.AudioToolbox (1.7.3 - 1.7.3) <F09C7075-2C4E-3A4F-A372-95D700125513> /System/Library/Frameworks/AudioToolbox.framework/Versions/A/AudioToolbox0x93c47000 - 0x93c7dff7 com.apple.AE (527.7 - 527.7) <7BAFBF18-3997-3656-9823-FD3B455056A4> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/AE.framework/Versions/A/AE0x93cd2000 - 0x93d01ff7 libsystem_info.dylib (??? - ???) <37640811-445B-3BB7-9934-A7C99848250D> /usr/lib/system/libsystem_info.dylib0x93d02000 - 0x93d03ff4 libremovefile.dylib (21.1.0 - compatibility 1.0.0) <6DE3FDC7-0BE0-3791-B6F5-C15422A8AFB8> /usr/lib/system/libremovefile.dylib0x93d49000 - 0x93d7cfef libtidy.A.dylib (??? - ???) <E962D8EC-6B9D-35B7-B586-F07D92302ADD> /usr/lib/libtidy.A.dylib0x93d7d000 - 0x93e48fff libsystem_c.dylib (763.13.0 - compatibility 1.0.0) <52421B00-79C8-3727-94DE-62F6820B9C31> /usr/lib/system/libsystem_c.dylib0x93e49000 - 0x93e59ff7 libCRFSuite.dylib (??? - ???) <CE616EF3-756A-355A-95AD-3472A876BEB9> /usr/lib/libCRFSuite.dylib0x93e5a000 - 0x93e85fff com.apple.GSS (2.2 - 2.0) <2C468B23-FA87-30B5-B9A6-8C5D1373AA30> /System/Library/Frameworks/GSS.framework/Versions/A/GSS0x93f28000 - 0x93f2bff7 libmathCommon.A.dylib (2026.0.0 - compatibility 1.0.0) <69357047-7BE0-3360-A36D-000F55E39336> /usr/lib/system/libmathCommon.A.dylib0x93f57000 - 0x94067fe7 libsqlite3.dylib (9.6.0 - compatibility 9.0.0) <34E1E3CC-7B6A-3B37-8D07-1258D11E16CB> /usr/lib/libsqlite3.dylib0x94068000 - 0x94069ff7 libquarantine.dylib (36.7.0 - compatibility 1.0.0) <46980EC2-149D-3CF7-B29A-401FB89C275D> /usr/lib/system/libquarantine.dylib0x94090000 - 0x940cdfef libGLImage.dylib (??? - ???) <FC13D46F-69C4-3BA1-A5E8-52C2EC8B7D58> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGLImage.dylib0x940ce000 - 0x941dfff7 libJP2.dylib (??? - ???) <2B5EB147-F845-30DF-87C4-D2D3C3D0680A> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/Resources/libJP2.dylib0x94222000 - 0x94272ffa libTIFF.dylib (??? - ???) <CAD45E49-FD7C-37FA-A118-AEB526B90E67> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/Resources/libTIFF.dylib0x943ec000 - 0x943fafff com.apple.opengl (1.8.1 - 1.8.1) <766AFB12-A2CB-3A55-B662-FC9FFCAE0008> /System/Library/Frameworks/OpenGL.framework/Versions/A/OpenGL0x943fb000 - 0x94424fff com.apple.shortcut (2.1 - 2.1) <60000F49-6309-34B1-88A1-588DC566C8DF> /System/Library/PrivateFrameworks/Shortcut.framework/Versions/A/Shortcut0x94425000 - 0x9450dfff libxml2.2.dylib (10.3.0 - compatibility 10.0.0) <1841196F-68B5-309F-8ED1-6714B1DFEC83> /usr/lib/libxml2.2.dylib0x9450e000 - 0x9450efff com.apple.vecLib (3.7 - vecLib 3.7) <8CCF99BF-A4B7-3C01-9219-B83D2AE5F82A> /System/Library/Frameworks/vecLib.framework/Versions/A/vecLib0x9450f000 - 0x94531ffe com.apple.framework.familycontrols (3.0 - 300) <6735D7ED-7053-3AB8-B144-E7F70A124CCD> /System/Library/PrivateFrameworks/FamilyControls.framework/Versions/A/FamilyControls0x94532000 - 0x9483cff3 com.apple.Foundation (6.7.2 - 833.25) <4C52ED74-A1FD-3087-A2E1-035AB3CF9610> /System/Library/Frameworks/Foundation.framework/Versions/C/Foundation0x9483d000 - 0x948fdffb com.apple.ColorSync (4.7.4 - 4.7.4) <0A68AF35-15DF-3A0A-9B17-70CE2A106A6C> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ColorSync.framework/Versions/A/ColorSync0x95650000 - 0x9566dfff libresolv.9.dylib (46.1.0 - compatibility 1.0.0) <2870320A-28DA-3B44-9D82-D56E0036F6BB> /usr/lib/libresolv.9.dylib0x9566e000 - 0x956aeff7 libauto.dylib (??? - ???) <984C81BE-FA1C-3228-8F7E-2965E7E5EB85> /usr/lib/libauto.dylib0x956af000 - 0x956b6ff7 libsystem_notify.dylib (80.1.0 - compatibility 1.0.0) <47DB9E1B-A7D1-3818-A747-382B2C5D9E1B> /usr/lib/system/libsystem_notify.dylib0x956b7000 - 0x957afff7 libFontParser.dylib (??? - ???) <71B33EB1-27F8-3C68-B940-FC61A3CFE275> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/Resources/libFontParser.dylib0x957b0000 - 0x957b0fff libffi.dylib (??? - ???) <58A2AA81-461E-3581-9A8C-880A3BDA2D6A> /usr/lib/libffi.dylib0x95b83000 - 0x95c53ffb com.apple.ImageIO.framework (3.1.2 - 3.1.2) <2092785C-795A-3CDF-A1B4-6C80BA3726DD> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/ImageIO0x95c54000 - 0x95c68ff7 com.apple.CFOpenDirectory (10.7 - 144) <665CDF77-F0C9-3AFF-8CF8-64257268B7DD> /System/Library/Frameworks/OpenDirectory.framework/Versions/A/Frameworks/CFOpenDirectory.framework/Versions/A/CFOpenDirectory0x95c69000 - 0x95d0dfff com.apple.QD (3.40 - ???) <3881BEC6-0908-3073-BA44-346356E1CDF9> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/QD.framework/Versions/A/QD0x95d0e000 - 0x95d6fffb com.apple.audio.CoreAudio (4.0.3 - 4.0.3) <7A14BE52-6789-3CE3-9AE9-B733F4903EB1> /System/Library/Frameworks/CoreAudio.framework/Versions/A/CoreAudio0x95d70000 - 0x95e33fff com.apple.CoreServices.OSServices (478.49 - 478.49) <5AF33605-C893-3F60-89CF-1BC9C0BC35AF> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/OSServices.framework/Versions/A/OSServices0x95e34000 - 0x95f43ff7 com.apple.DesktopServices (1.6.5 - 1.6.5) <CEC069D7-37A3-3D25-A3BB-39DE99FDA46E> /System/Library/PrivateFrameworks/DesktopServicesPriv.framework/Versions/A/DesktopServicesPriv0x95f44000 - 0x95f48ffa libcache.dylib (47.0.0 - compatibility 1.0.0) <98A82BC5-0DD9-3212-9CAE-35A77278EEB6> /usr/lib/system/libcache.dylib0x96021000 - 0x96095fff com.apple.CoreSymbolication (2.2 - 73.2) <FA9305CA-FB9B-3646-8C41-FF8DF15AB2C1> /System/Library/PrivateFrameworks/CoreSymbolication.framework/Versions/A/CoreSymbolication0x9644b000 - 0x96479fe7 libSystem.B.dylib (159.1.0 - compatibility 1.0.0) <30189C33-6ADD-3142-83F3-6114B1FC152E> /usr/lib/libSystem.B.dylib0x96509000 - 0x96596ff7 com.apple.CoreText (220.22.0 - ???) <EA7210A7-DECC-3F76-8A66-D4E41859B3C6> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreText.framework/Versions/A/CoreText0x96655000 - 0x96658ff7 libcompiler_rt.dylib (6.0.0 - compatibility 1.0.0) <7F6C14CC-0169-3F1B-B89C-372F67F1F3B5> /usr/lib/system/libcompiler_rt.dylib0x966c1000 - 0x966efff7 com.apple.DictionaryServices (1.2.1 - 158.3) <8D03D180-D834-39F3-A106-78E0B22A7893> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/DictionaryServices.framework/Versions/A/DictionaryServices0x966ff000 - 0x96722fff com.apple.CoreVideo (1.7 - 70.3) <4234C11C-E8E9-309A-9465-27D6D7458895> /System/Library/Frameworks/CoreVideo.framework/Versions/A/CoreVideo0x96723000 - 0x96b25ff6 libLAPACK.dylib (??? - ???) <00BE0221-8564-3F87-9F6B-8A910CF2F141> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libLAPACK.dylib0x96b26000 - 0x9745172b com.apple.CoreGraphics (1.600.0 - ???) <DD7CDD67-FC4F-36FE-962F-2EA7EF3FC780> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/CoreGraphics0x97452000 - 0x9757eff9 com.apple.CFNetwork (520.5.1 - 520.5.1) <F3C606BF-6DCF-33CD-981B-7253C9E3113A> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/CFNetwork.framework/Versions/A/CFNetwork0x976e9000 - 0x97709ff7 com.apple.RemoteViewServices (1.5 - 44.2) <11C87337-FF29-3976-A230-6387D96563C5> /System/Library/PrivateFrameworks/RemoteViewServices.framework/Versions/A/RemoteViewServices0x978a0000 - 0x978abffc com.apple.NetAuth (1.0 - 3.0) <C07853C0-AF32-3633-9CEF-2480860C12C5> /System/Library/PrivateFrameworks/NetAuth.framework/Versions/A/NetAuth0x979c4000 - 0x979c6ff9 com.apple.securityhi (4.0 - 1) <BD367302-73C3-32F4-8080-E389AE89E434> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/SecurityHI.framework/Versions/A/SecurityHI0x979c7000 - 0x979c8fff liblangid.dylib (??? - ???) <C8C204E9-1785-3785-BBD7-22D59493B98B> /usr/lib/liblangid.dylib0x979c9000 - 0x979ceff7 libmacho.dylib (800.0.0 - compatibility 1.0.0) <56A34E97-518E-307E-8218-C5D43A33EE34> /usr/lib/system/libmacho.dylib0x979fb000 - 0x97a5dffb com.apple.datadetectorscore (3.0 - 179.4) <3A418498-C189-37A1-9B86-F0ECB33AD91C> /System/Library/PrivateFrameworks/DataDetectorsCore.framework/Versions/A/DataDetectorsCore0x97a5e000 - 0x97a5efff com.apple.Accelerate.vecLib (3.7 - vecLib 3.7) <22997C20-BEB7-301D-86C5-5BFB3B06D212> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/vecLib0x97a5f000 - 0x97a63ffd IOSurface (??? - ???) <EDDBEE65-1EB8-33A7-9972-E361A3508234> /System/Library/Frameworks/IOSurface.framework/Versions/A/IOSurface0x97a64000 - 0x97a6fffb com.apple.speech.recognition.framework (4.0.21 - 4.0.21) <A1764D2F-EB84-33DC-9ED5-CDA3B468FF3E> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/SpeechRecognition.framework/Versions/A/SpeechRecognition0x97a70000 - 0x97a71fff libDiagnosticMessagesClient.dylib (??? - ???) <DB3889C2-2FC2-3087-A2A2-4C319455E35C> /usr/lib/libDiagnosticMessagesClient.dylib0x97a72000 - 0x97ae1fff com.apple.Heimdal (2.2 - 2.0) <2E1B8779-36D4-3C62-A67E-0034D77D7707> /System/Library/PrivateFrameworks/Heimdal.framework/Versions/A/Heimdal0x97ae2000 - 0x97af0fff libdispatch.dylib (187.10.0 - compatibility 1.0.0) <1B857064-288D-3919-B81A-38E9F4D19B54> /usr/lib/system/libdispatch.dylib0x97bca000 - 0x97bf2ff7 libxslt.1.dylib (3.24.0 - compatibility 3.0.0) <AB530FB2-8BD1-3328-95E8-CF449F0429CA> /usr/lib/libxslt.1.dylib0x97bf3000 - 0x97c37fff com.apple.MediaKit (12 - 602) <6E429DD7-8829-37DE-94AF-940FB70F2FB9> /System/Library/PrivateFrameworks/MediaKit.framework/Versions/A/MediaKit0x97f2a000 - 0x97fb1fff com.apple.print.framework.PrintCore (7.1 - 366.3) <EEC03CAB-7F79-3931-87FE-4DF0B767BF47> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/PrintCore.framework/Versions/A/PrintCore0x97fb2000 - 0x97fbbff3 com.apple.CommonAuth (2.2 - 2.0) <C3FD6EC2-8EB3-38FB-BBB7-05009CA49024> /System/Library/PrivateFrameworks/CommonAuth.framework/Versions/A/CommonAuth0x98073000 - 0x98098ff9 libJPEG.dylib (??? - ???) <743578F6-8C0C-39CC-9F15-3A01E1616EAE> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/Resources/libJPEG.dylib0x98099000 - 0x980a7fff libz.1.dylib (1.2.5 - compatibility 1.0.0) <E73A4025-835C-3F73-9853-B08606E892DB> /usr/lib/libz.1.dylib0x980a8000 - 0x980a8ffe libkeymgr.dylib (23.0.0 - compatibility 1.0.0) <7F0E8EE2-9E8F-366F-9988-E2F119DB9A82> /usr/lib/system/libkeymgr.dylib0x980a9000 - 0x980b0ff8 libCGXCoreImage.A.dylib (600.0.0 - compatibility 64.0.0) <4F9DD9D1-F251-3661-A3C6-B1F550B084B0> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/Resources/libCGXCoreImage.A.dylib0x982b3000 - 0x982e7ff3 libTrueTypeScaler.dylib (??? - ???) <C2D2257F-11E6-336C-BBA8-934BD9214728> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/Resources/libTrueTypeScaler.dylib0x98342000 - 0x9853aff7 com.apple.CoreData (104.1 - 358.14) <C1730963-F75D-3338-B65F-D50235538B28> /System/Library/Frameworks/CoreData.framework/Versions/A/CoreData0x9853b000 - 0x9853eff9 libCGXType.A.dylib (600.0.0 - compatibility 64.0.0) <16DCE20A-9790-369A-94C1-B7954B418C77> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/Resources/libCGXType.A.dylib0x9856e000 - 0x985d2fff com.apple.framework.IOKit (2.0 - ???) <94827954-5906-36C4-819B-24CDAFD85C72> /System/Library/Frameworks/IOKit.framework/Versions/A/IOKit0x985d3000 - 0x985dbfff com.apple.DiskArbitration (2.4.1 - 2.4.1) <28D5D8B5-14E8-3DA1-9085-B9BC96835ACF> /System/Library/Frameworks/DiskArbitration.framework/Versions/A/DiskArbitration0x985dc000 - 0x98666ffb com.apple.SearchKit (1.4.0 - 1.4.0) <CF074082-64AB-3A1F-831E-582DF1667827> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/SearchKit.framework/Versions/A/SearchKit0x98750000 - 0x9875bff3 libCSync.A.dylib (600.0.0 - compatibility 64.0.0) <D6E17FD4-ECA0-3EEE-BFC5-F6A42A21AB5D> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/Resources/libCSync.A.dylib0x9875c000 - 0x98769fff libGL.dylib (??? - ???) <A72F14F7-1836-34AB-9F08-67836CB966E4> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib0x987cd000 - 0x987cefff com.apple.TrustEvaluationAgent (2.0 - 1) <4BB39578-2F5E-3A50-AD59-9C0AB99472EB> /System/Library/PrivateFrameworks/TrustEvaluationAgent.framework/Versions/A/TrustEvaluationAgent0x987cf000 - 0x987f9ff1 com.apple.CoreServicesInternal (113.19 - 113.19) <F7A309D1-DCB4-38DE-8248-E16D0182AA6C> /System/Library/PrivateFrameworks/CoreServicesInternal.framework/Versions/A/CoreServicesInternal0x987fa000 - 0x9883aff7 com.apple.NavigationServices (3.7 - 193) <16A8BCC8-7343-3A90-88B3-AAA334DF615F> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/NavigationServices.framework/Versions/A/NavigationServices0x9883d000 - 0x9899fffb com.apple.QuartzCore (1.7 - 270.5) <6D0EC7FC-11E5-35FB-A08A-3B438E89FBDB> /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore0x989a0000 - 0x989ddff7 libcups.2.dylib (2.9.0 - compatibility 2.0.0) <007A1877-E981-3007-A8FA-9B179F4ED6D1> /usr/lib/libcups.2.dylib0x98a00000 - 0x98a49ff7 libGLU.dylib (??? - ???) <9AF7AD51-16E3-3674-B60E-30EE499D7B46> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGLU.dylib0x98a97000 - 0x98aa0fff libc++abi.dylib (14.0.0 - compatibility 1.0.0) <FEB5330E-AD5D-37A0-8AB2-0820F311A2C8> /usr/lib/libc++abi.dylib0x98b84000 - 0x98d38ff3 libicucore.A.dylib (46.1.0 - compatibility 1.0.0) <4AFF6FC3-6283-3934-8EFC-CA227CA11164> /usr/lib/libicucore.A.dylib0x98d39000 - 0x98d46fff com.apple.HelpData (2.1.2 - 72.2) <330C6B7F-2512-37B7-B2FF-24E1804E9426> /System/Library/PrivateFrameworks/HelpData.framework/Versions/A/HelpData0x98d47000 - 0x98d4bfff com.apple.CommonPanels (1.2.5 - 94) <3A988595-DE53-34ED-9367-C9A737E2AF38> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/CommonPanels.framework/Versions/A/CommonPanels0x98d4c000 - 0x98d4cfff libdnsinfo.dylib (395.11.0 - compatibility 1.0.0) <7EFAD88C-AFBC-3D48-BE14-60B8EACC68D7> /usr/lib/system/libdnsinfo.dylib0x98d4d000 - 0x98d62ff7 com.apple.ImageCapture (7.1.0 - 7.1.0) <E5FCA336-7E47-343E-A82D-CCCA5BCD5929> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/ImageCapture.framework/Versions/A/ImageCapture0x98d63000 - 0x98d67fff libGIF.dylib (??? - ???) <2ADFED97-2228-343D-9A53-207CBFDE7984> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/Resources/libGIF.dylib0x990dd000 - 0x991dcffb com.apple.DiskImagesFramework (10.7.4 - 331.7) <31A74A7E-E2AE-313D-A7C4-6DFCF0F22C9A> /System/Library/PrivateFrameworks/DiskImages.framework/Versions/A/DiskImages0x991dd000 - 0x99242ff7 libvDSP.dylib (325.4.0 - compatibility 1.0.0) <4B4B32D2-4F66-3B0D-BD61-FA8429FF8507> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libvDSP.dylib0x99243000 - 0x99277ff8 libssl.0.9.8.dylib (44.0.0 - compatibility 0.9.8) <567E922C-E64F-321B-9A47-6B18BF481625> /usr/lib/libssl.0.9.8.dylib0x99bc1000 - 0x9a036ff7 FaceCoreLight (1.4.7 - compatibility 1.0.0) <3E2BF587-5168-3FC5-9D8D-183A9C7C1DED> /System/Library/PrivateFrameworks/FaceCoreLight.framework/Versions/A/FaceCoreLight0x9a037000 - 0x9a04dffe libxpc.dylib (77.19.0 - compatibility 1.0.0) <0585AA94-F4FD-32C1-B586-22E7184B781A> /usr/lib/system/libxpc.dylib0x9a04e000 - 0x9a0e4ff7 com.apple.LaunchServices (480.40 - 480.40) <D5C0DEF9-398C-3742-8C4E-875C3365EC8B> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/LaunchServices.framework/Versions/A/LaunchServices0x9a0e5000 - 0x9a0f0fff libkxld.dylib (??? - ???) <14E79D7A-B6C2-35C5-B56D-D343BEC2A106> /usr/lib/system/libkxld.dylib0x9a0f1000 - 0x9a127ff4 com.apple.LDAPFramework (3.2 - 120.2) <CCEB43CD-3861-33CC-8D9B-588F415A7028> /System/Library/Frameworks/LDAP.framework/Versions/A/LDAP0x9a128000 - 0x9a1b5fe7 libvMisc.dylib (325.4.0 - compatibility 1.0.0) <F2A8BBA3-6431-3CED-8CD3-0953410B6F96> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libvMisc.dylib0x9a1b6000 - 0x9a1b6fff com.apple.Carbon (153 - 153) <A75A970B-6D82-3451-8D3E-05B1A130ABDE> /System/Library/Frameworks/Carbon.framework/Versions/A/Carbon0x9a1b7000 - 0x9a29aff7 libcrypto.0.9.8.dylib (44.0.0 - compatibility 0.9.8) <BD913D3B-388D-33AE-AA5E-4810C743C28F> /usr/lib/libcrypto.0.9.8.dylib0x9a29b000 - 0x9a2d2fef com.apple.DebugSymbols (2.1 - 87) <EB951B78-31A5-379F-AFA1-B5C9A7BB3D23> /System/Library/PrivateFrameworks/DebugSymbols.framework/Versions/A/DebugSymbols0x9a2df000 - 0x9a2f8ffb com.apple.ScriptingBridge (1.2.1 - ???) <21A258EA-C4B7-3DCE-A041-3A2FBA08C24C> /System/Library/Frameworks/ScriptingBridge.framework/Versions/A/ScriptingBridge0x9a2f9000 - 0x9a5c8ffb com.apple.security (7.0 - 55148.6) <8DF67BDD-C98F-3B7E-AC63-D468407FA82D> /System/Library/Frameworks/Security.framework/Versions/A/Security0x9a5c9000 - 0x9aaa5ff6 libBLAS.dylib (??? - ???) <134ABFC6-F29E-3DC5-8E57-E13CB6EF7B41> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib0x9aaa6000 - 0x9ab87ff7 com.apple.DiscRecording (6.0.4 - 6040.4.1) <08BADDAD-FA79-3872-9387-EEE2A9FAA2F0> /System/Library/Frameworks/DiscRecording.framework/Versions/A/DiscRecording0x9ab88000 - 0x9ab8fffd com.apple.NetFS (4.0 - 4.0) <D0D59145-D211-3E7C-9062-35A2833FA99B> /System/Library/Frameworks/NetFS.framework/Versions/A/NetFS0x9afc2000 - 0x9b024ff3 libstdc++.6.dylib (52.0.0 - compatibility 7.0.0) <266CE9B3-526A-3C41-BA58-7AE66A3B15FD> /usr/lib/libstdc++.6.dylib0x9b025000 - 0x9b02dff3 libunwind.dylib (30.0.0 - compatibility 1.0.0) <E8DA8CEC-12D6-3C8D-B2E2-5D567C8F3CB5> /usr/lib/system/libunwind.dylib0x9b02e000 - 0x9b030ff7 libdyld.dylib (195.5.0 - compatibility 1.0.0) <637660EA-8D12-3B79-B644-041FEADC9C33> /usr/lib/system/libdyld.dylib0x9b04f000 - 0x9b096ff5 com.apple.opencl (2.0.19 - 2.0.19) <7689E7B9-EE5A-3F74-8699-4CDED9162260> /System/Library/Frameworks/OpenCL.framework/Versions/A/OpenCL0x9b0ab000 - 0x9b0aeffc libpam.2.dylib (3.0.0 - compatibility 3.0.0) <6FFDBD60-5EC6-3EFA-996B-EE030443C16C> /usr/lib/libpam.2.dylib0x9b0af000 - 0x9b0b6ff9 libsystem_dnssd.dylib (??? - ???) <EBEAF723-84F8-3544-8FB2-31B7771B50D0> /usr/lib/system/libsystem_dnssd.dylib0x9b0b7000 - 0x9b18daab libobjc.A.dylib (228.0.0 - compatibility 1.0.0) <2E272DCA-38A0-3530-BBF4-47AE678D20D4> /usr/lib/libobjc.A.dylib0x9b18e000 - 0x9b1acff7 libsystem_kernel.dylib (1699.32.7 - compatibility 1.0.0) <79179F83-457A-3539-A76B-E960D2108109> /usr/lib/system/libsystem_kernel.dylib0x9b1ad000 - 0x9b1b3ffb com.apple.print.framework.Print (7.4 - 247.3) <CB075EEE-FA1F-345C-A1B5-1AB266FC73A1> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Print.framework/Versions/A/Print0x9b1b8000 - 0x9b1c8fff libsasl2.2.dylib (3.15.0 - compatibility 3.0.0) <D6F728DA-990A-32A3-86FA-4A3F4D88E309> /usr/lib/libsasl2.2.dylib0x9b1c9000 - 0x9b1d4ffe libbz2.1.0.dylib (1.0.5 - compatibility 1.0.0) <4A7FCD28-9C09-3120-980A-BDF6EDFAAC62> /usr/lib/libbz2.1.0.dylib0x9b1d5000 - 0x9b251ff3 libType1Scaler.dylib (??? - ???) <C931AA06-5086-3A0E-873B-47459AD3CDD3> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/Resources/libType1Scaler.dylib0x9b252000 - 0x9b26fff3 com.apple.openscripting (1.3.3 - ???) <0579A4CB-FD6F-3D7F-A17B-AC0F2CF11FC7> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/OpenScripting.framework/Versions/A/OpenScripting0x9b27a000 - 0x9b27afff com.apple.Accelerate (1.7 - Accelerate 1.7) <4192CE7A-BCE0-3D3C-AAF7-6F1B3C607386> /System/Library/Frameworks/Accelerate.framework/Versions/A/Accelerate0x9b2e2000 - 0x9b33bfff com.apple.HIServices (1.21 - ???) <91EC636D-AC27-3332-BA1C-FD7301917429> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/HIServices.framework/Versions/A/HIServices0x9b33c000 - 0x9b33dffd libCVMSPluginSupport.dylib (??? - ???) <4B0476F9-950D-3EB7-BD83-F65AF0B05F0E> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libCVMSPluginSupport.dylib0x9b3d7000 - 0x9b3e8fff libbsm.0.dylib (??? - ???) <54ACF696-87C6-3652-808A-17BE7275C230> /usr/lib/libbsm.0.dylib0x9ba09000 - 0x9ba64ff3 com.apple.Symbolication (1.3 - 91) <4D12D2EC-5010-3958-A205-9A67E972C76A> /System/Library/PrivateFrameworks/Symbolication.framework/Versions/A/Symbolication0x9bb41000 - 0x9bc31ff1 libiconv.2.dylib (7.0.0 - compatibility 7.0.0) <9E5F86A3-8405-3774-9E0C-3A074273C96D> /usr/lib/libiconv.2.dylib0x9bc33000 - 0x9bc33fff com.apple.Cocoa (6.6 - ???) <650273EF-1ABC-334E-B745-B75AF028F9F4> /System/Library/Frameworks/Cocoa.framework/Versions/A/Cocoa0x9bc34000 - 0x9bc91ffb com.apple.htmlrendering (76 - 1.1.4) <743C2943-40BC-36FB-A45C-3421A394F081> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/HTMLRendering.framework/Versions/A/HTMLRendering0x9bc92000 - 0x9c727ff6 com.apple.AppKit (6.7.5 - 1138.51) <B9D3DCA0-9765-354E-9730-75A45A97DDFD> /System/Library/Frameworks/AppKit.framework/Versions/C/AppKit0x9c75a000 - 0x9c7d0fff com.apple.Metadata (10.7.0 - 627.37) <F54AED70-95C5-3561-8C87-D9E5539E98A4> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/Metadata.framework/Versions/A/Metadata0x9c7d1000 - 0x9c819ff7 com.apple.SystemConfiguration (1.11.3 - 1.11) <68B92FEA-F754-3E7E-B5E6-D512E26144E7> /System/Library/Frameworks/SystemConfiguration.framework/Versions/A/SystemConfiguration0x9c81a000 - 0x9c820fff libGFXShared.dylib (??? - ???) <9C9834EB-B794-38C8-9B90-31D8CB234F86> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGFXShared.dylib0x9c821000 - 0x9cb23fff com.apple.CoreServices.CarbonCore (960.25 - 960.25) <C613B0DA-B401-3DC7-B626-6E20D4DDC8A8> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/CarbonCore.framework/Versions/A/CarbonCore0x9cee0000 - 0x9cf31ff9 com.apple.ScalableUserInterface (1.0 - 1) <C3FA7E40-0213-3ABC-A006-2CB00B6A7EAB> /System/Library/Frameworks/QuartzCore.framework/Versions/A/Frameworks/ScalableUserInterface.framework/Versions/A/ScalableUserInterfaceExternal Modification Summary: Calls made by other processes targeting this process: task_for_pid: 3 thread_create: 0 thread_set_state: 0 Calls made by this process: task_for_pid: 0 thread_create: 0 thread_set_state: 0 Calls made by all processes on this machine: task_for_pid: 431339 thread_create: 2 thread_set_state: 0VM Region Summary:ReadOnly portion of Libraries: Total=259.3M resident=124.8M(48%) swapped_out_or_unallocated=134.5M(52%)Writable regions: Total=155.4M written=30.0M(19%) resident=69.2M(45%) swapped_out=116K(0%) unallocated=86.3M(55%) REGION TYPE VIRTUAL=========== =======ATS (font support) 32.8MCG backing stores 10.0MCG image 124KCG raster data 14.2MCG shared images 3504KCoreGraphics 8KCoreImage 4KCoreServices 5164KMALLOC 56.2MMALLOC guard page 64KMemory tag=240 4KMemory tag=242 12KMemory tag=243 4KOpenCL 8KStack 68.1MVM_ALLOCATE 26.8M__CI_BITMAP 80K__DATA 15.5M__DATA/__OBJC 108K__IMAGE 528K__IMPORT 536K__LINKEDIT 73.9M__OBJC 1520K__PAGEZERO 4K__TEXT 185.3M__UNICODE 544Kmapped file 384.3Mshared memory 312Kshared pmap 10.0M=========== =======TOTAL 889.4MModel: MacPro1,1, BootROM MP11.005C.B08, 4 processors, Dual-Core Intel Xeon, 2.66 GHz, 8 GB, SMC 1.7f10Graphics: ATI Radeon HD 6xxx, ATI Radeon HD 6xxx, PCIe, 1024 MBMemory Module: DIMM Riser A/DIMM 1, 2 GB, DDR2 FB-DIMM, 667 MHz, 0x014F, 0x5453324741504D41435036552D5420202020Memory Module: DIMM Riser A/DIMM 2, 2 GB, DDR2 FB-DIMM, 667 MHz, 0x014F, 0x5453324741504D41435036552D5420202020Memory Module: DIMM Riser B/DIMM 1, 2 GB, DDR2 FB-DIMM, 667 MHz, 0x014F, 0x5453324741504D41435036552D5420202020Memory Module: DIMM Riser B/DIMM 2, 2 GB, DDR2 FB-DIMM, 667 MHz, 0x014F, 0x5453324741504D41435036552D5420202020AirPort: spairport_wireless_card_type_airport_extreme (0x14E4, 0x87), Broadcom BCM43xx 1.0 (5.10.131.36.15)Bluetooth: Version 4.0.8f17, 2 service, 11 devices, 1 incoming serial portsNetwork Service: Built-in Ethernet 1, Ethernet, en0Network Service: Built-in Ethernet 2, Ethernet, en1Serial ATA Device: WDC WD6000HLHX-01JJPV0, 600,13 GBSerial ATA Device: ST3250820AS P, 250,06 GBSerial ATA Device: WDC WD20EADS-00S2B0, 2 TBSerial ATA Device: SAMSUNG HD103UJ, 1 TBSerial ATA Device: ASUS DRW-24B5STUSB Device: Keyboard Hub, apple_vendor_id, 0x1006, 0xfd400000 / 2USB Device: Apple Keyboard, apple_vendor_id, 0x0221, 0xfd420000 / 3USB Device: USB RECEIVER, 0x046d (Logitech Inc.), 0xc50e, 0x3d100000 / 2USB Device: Bluetooth USB Host Controller, apple_vendor_id, 0x8206, 0x5d200000 / 3USB Device: Smart-UPS 2200 FW:COM 02.1 / UPS.05.I, 0x051d (American Power Conversion), 0x0003, 0x5d100000 / 2FireWire Device: built-in_hub, 800mbit_speedFireWire Device: iSight, Apple Computer, Inc., 200mbit_speedOperating System: Mac OS XVersion: 3.6.4.3 release dedalo: useful bt but please next time put it on a file and attach the file so the bug is still easy to read.Did you install any specific fonts? If yes which ones and could you attach them?Could you try to retrieve the strace too? (see)I add some developers that could hack on MAC or did something with fonts into CC. I wonder if the backtrace might somehow help.IMHO, the strace would be helpful because if could point to the problematic font.Anyway, it seems to be somehow specific to your system. Such bugs, could not block releases with other useful fixes and improvements => lowering the severity a bit.yeah, its very likely triggered by a specific font, so we'd need to know what font is it. a strace would help with finding that outSorry for the delay. The font was causing the problem was Silicon.ttf (). When I removed it, I was able to retrieve the font list again.But, I'm sorry to tell you, LibreOffice was still crashing over and over again just clickin around on a random cell. The font list started to work when I removed that font, but LibreOffice was crashing all the time.I think it's something related the fonts anyway, dunno which one. I had to reinstall the system to fix the problem (first time in 6 years, I always upgraded since Panther).And, this is another hint for you: I did the Lion installation from scratch, I installed the Silicon font again, and it works, no more crashes. So the font itself is not the problem. It's something related fonts, but not that font in particular. I'm sure it's something relating fonts because LibreOffice failed when I have first installed, then removed a lot of fonts. I had the Silicon font installed for years, so it can't be the problem, but it was causing the crash on the font list apparently.I can check, but I'm not sure is still on my Time Machine backup, for the font list. That might help you? Tell me if I can recover some information for you.dedalo: on Lion installation from scratch, when you installed the Silicon font, you said you had no more crash but is the font list display ok?Yes Julien, it is and the Silicon is displayed on the list.Installing that specific Silicon font under MacOSX gives from the mac font installera) "1 serious error was found. Do not use this font, <corrupt font name>"b) "may cause system problems or even crashes if installed"which is a pretty scary set of warnings :-)anyway, even with it installed LibreOffice doesn't crash for me on MacOSX (and Linux version under valgrind with font installed is also silent), so we don't have a reproducible scenario.I think it's best to close this bug as it's gotten a bit confused and with freshly installed fonts it works. If there is information about a specific font that causes a reproducible crash then feel free to log a new bug about that font.
id=60588	CreatedFile, that can help to reproduce bugI can not safe a dokument. In Lithuanian i see eror:Klaida įrašomas dokumentas Be pavadinimo 1:Rašymo klaida.Klaida rašant podokumentį content.xmlAfter time program cyclic try save dokument, creates many empty (0 B size) files in /.config/libreoffice/4/user/backup/ , it consumes RAM, I can not do any action in program – i must kill LibreOffice.How to reproduce? 1. Open attached file.2. Write some additional text.3. Do nothink for ~20 minutes4. Write somethink in adition.5. Try to safe file. CreatedError messageI can reproduce a bug, see picture (attached)I do not know how it was possible that such a critical bug is not yet resolved. LO 4.0 can't be used at all because of that.Hi. I am sorry you are having this problem. I did try to reproduce this using LibreOffice Version 4.0.2.1. I set my language locale to Lithuanian. I opened the document you provided and made a change. I then waited 20+ minutes, added another change, and tried to save. My save was successful- no errors.Which Linux platform are you using?Another Question: I see in your attachment that you have chosen to view nonprinting characters. Does the fail to save only occur when you have View -> Nonprinting characters?Version: Version 4.0.2.1 (Build ID: 7e5467ff8f30d821f4fbf69cb2769163eb64c2c)Platform: Ubuntu Linux 12.04 LTS x64----------------------------------------------LibreOffice is powered by a team of volunteers, every bug is confirmed (triaged) by human beings who mostly give their time for free. We invite you to join our triaging by checking out this link:There are also other ways to get involved including with marketing, UX, documentation, and of course developing -(In reply to)Probably duplicated inassigned mab4.0, any chance you can retest in a parralel pre 4.0.2 build to confirm?NOT reproducible with reporter's sample document and Server Installation of "LibO 4.0.0.3 - GERMAN UI / German Locale [Build ID: 7545bee9c2a0782548772a21bc84a9dcc583b89)]" {tinderbox: @6, pull time 2013-01-31 11:30(?)} on German WIN7 Home Premium (64bit) with separate new User Profile:1. opened copy of sample document from LibO start center2. Typed "x" behind end of all text3. Menu 'File -> Save' > Saved without problems4. Typed an "y" behind the "x"5. Waited half an hour6. typed "z"7. Menu 'File -> Save' > Saved without problemsLinux Related?But "- FILEOPEN, FILESAVE, "Could not save document, error in writing sub document context.xml" then corrupt file." has been confirmed for ALL OS incl WIN.@Mindaugas Baranauskasseems to be fixed for 4.0.1.2. Can you please try?If your problem persists please contribute a more detailed step by step instruction, may be there is a small detail I do different to your proceeding?I can not reproduce after update to LibreOffice 4.0.1.2. (in accordance to)We can close this bug.Thank you for the test, let's make it a DUP what helps to keep overview.Please feel free to reopen this Bug if you find evidence that we have an independent issue here.*** This bug has been marked as a duplicate of***
id=60804	1. Open component (spreadsheet for instance)2. Go to File -> Print3. Click on options tab4. Check "print to file"5. Click on "Print to file" button at bottomResult - CRASHExpected - No crash, save dialog comes up for pdf creationMakes triage work quite difficult without this option. Regression since 4.0.0.3 release I can confirm this using Mac OSX 10.8.2 LibreOffice Version 4.1.0.0.alpha0+ (Build ID: 871712ad62bb01359c29713a148a5673e26df1a)TinderBox:, Branch:master, Time: 2013-02-13_00:15:32Also can reproduce using Linux Mint 14 x64 and LibreOffice Version 4.1.0.0.alpha0+ (Build ID: cbc722733bb272b0f26efec09b478bed9a3cdb9)Console output:terminate called after throwing an instance of 'com::sun::star::uno::DeploymentException'Exited with code '134'Can't bibisect this using bibisect40 package.This feature works using latest version ( Version 4.1.0.0.alpha0+ (Build ID: 8450a99c744e9005f19173e4df35d65640bcf5c )Createdbacktrace logHey Stephan,this one is for you. This regression is related to the uno conversion from Noel in print3.cxxFound the bug, somehow I forgot to make SalGtkFilePicker.cxx implement XFilePicker3.Will have a fix in a day or so.Noel Grandin committed a patch related to this issue.It has been pushed to "master":fix fdo#60804 - Print to File leads to CrashThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Noel, is this fixed? It's at least assigned so setting to assigned.@stevebell: I see you changed the bug status from NEW to ASSIGNED, but there is nobody in the 'assigned to' field. Therefore I mark it back to NEW.(In reply to)Sorry about my previous comment, I think I was handling a bit to fast.Because of the fix of Noel, I mark this as RESOLVED FIXED. @Joel: I think you know what to do if this is still reproducible ;-)Sorry for the status ping-pong.
id=60270	This is the meta issue to track the most annoying bugs in LibreOffice 4.1.x releases. It helps developers to concentrate on bugs that are most critical for users. Also it helps users to be aware of potential problems.If anyone wants to raise a bug as “most annoying” for the release, please add the ID of that bug to the field “Depends on”, and don’t forget to leave a comment here that explains in a few words why that bug should be privileged.For details, criteria and further instructions, please see I am marking this as NEW to get it out of our UNCONFIRMED list :-D Presumably, any bug here will be indeed....confirmed and NEWAdd "- EDITING: CRASH when 'Format - Bullets and Numbering'"- Causes thin gaps to appear in borders, borders look as if they are stitched together and jaggies appear on non-rectangular borders in print. Bug doesn't appear in OpenOffice which would make some users print the documents from OpenOffice to avoid this.I add "- CRASH when click 'Add' in EXTENSIONS Manager"I add "- FILEOPEN other document via document-hyperlink in LibO3.6-document fails with error message"Add 60945: 'File -> Save as' shows 'Open' dialog instead of "Save As" dialog => hard to safe filesI nominate: several icons are lost, mainly in the Navigator, Styles and Formatting and Formula bar of Calc. Very visible regression.I add "- MinGW: Tinderbox @7 does not deliver 4.1 Master builds" together with "- Tinderbox @6 does not deliver 4.1 Master builds": Master regression survey completely broken for WIN(Please excuse me for the MAB noise!)I add "- CRASH when FILEOPEN databases"I nominate "- 3d scene displays 90deg right turned" on this MAB list. Seems like a display bug only, because it is saved correctly.I nominate "- Cannot scroll horizontally using trackpad" (Mac OSX bug only, as far we can see) because of the regression 4.0 vs 4.1 and the fact it makes scrolling horizontally using the trackpad useless. You can only scroll in one direction.I add "- EDITING: CRASH when click on contents". More or less no editing possible with WriterI nominate "- Impress crashes on setting master pages" because of the regression 4.0 vs 4.1.I addbecause it makes LibreOffice unusable for Unity users.Add: It seems to be impossible to create new databaseAdding. Asian vertical mode is completely dysfunctional. It was working in 4.0.Adding- cannot save any text to ppt.addbecause this is there sinds 3.3 and becomse worser sinds 4.01 and makes the "contour" feature unusable and documents started in prevsiuos versions un-editableAdded 2 very visible bugs:: superscript broken, gives subscript instead, even in auto-correction: Header & footer blue tags empty (no visible text)I nominate "- EDITING: letters move around during editing/typing" (Mac OSX) due the fact of the markable regression vs 4.0. For some users this was reproducible with older versions, especially with zoom level != 100%. Now it is always reproducible.Hello @ll,I would like to nominate #64984 as it is IMHO a regression to 4.0.3 ... :(I nominate "- Area button in toolbar result in crash". Note: Windows-only so far.Add 65022: crash when selecting "Format -> Paragraph/Page". It is basic operation.adding 58317 - UI Pivot Table - Choosing Results to <current sheetname> in More does not set the cell address field enabledI nominate "- Crash on display/paste Arabic text"I nominate: automatic non-breaking space before specific punctuation marks in French texts broken. Regression.Add: Too big font when editing presentation. The text is even harder to read. It is high visible regression.- python stuff broken in LO 4.1 on Windows. Wizards and mail merge does not work., regression wrt to 4.0, "new database wizard" does not do what it shows it will do.: report wizard now creates legacy reports instead of reportbuilder reports. Existing long-standing (from OO.org era) feature is now unavailable.adding- FORMATTING: Incorrect formatting text and colors of cells when opening in xlsx-files in CalcAdd- UI LibreOffice native file dialog does not offer selection list to choose from names that have the same startAdd- Document properties: Editing-time adding up incompleteHello @ll,I would like to add "- EDITING: Base crashes with queries with keyword "LIKE" in GUI-Mode", as it is IMHO a showstopper ... :(Sorry for the inconvenienceThomas.I nominatewhich make impossible to save a document if "always create a backup copy" option is checked.add- doesn't retain font settings: after save as and again opening of presentation, font is changedGood morning :)I would like the following bugs to nominate as MABs (if you think, they are not adequate, feel free to remove them, but it would be nice, if you could explain your decision ... ;) ):1.- Crash, when inserting URL (as Joel has written, it may be an user error, but as it is the default selection, I think it happens more often ... :( ).2.- Crash when scrolling to a file with auto-updated links in it3.- Crash, when Undo is used too often (not really a crash, what someone told me at first, but more something like "changed document, which will not ask for saving" thingie ... :( )4.- Writer: hyphenation is not always used in line break algorithm (as it is a regression to 4.0.4 and making hyphenation unusable with Germanophone version of LO 4.1.0.1 ... :( )5.- LO 4.1.0.1 doesn't save path to own certificates (because it is not possible to use own certiicates beside of Firefox ones ... :( ).Sorry for the inconvenienceThomas.I would like to nominatewhich, in, Jose L. Domingo on 2013-03-13, has presented his investigations. It seems that this is the same asand.thanks, Ian.As described in, when save a writer file as docx, the text frame is lost (while it still shows up when open with MS OFFICE).This blocks my work.I add but 66508 "Coping a chart will make Calc crass.". I think this bug is serious because now charts/copying is useles, slows down work and loses data.I nominate. It causes data loss and is a very common action (adding words to personal dictionary)I'd like to nominate:losing images when working with docx without extra backup of the files can have pretty bad consequences.(This bug exists since 3.5.3 but is still present in 4.1.0.1. I hope this is the right MAB.)Please don't add a known MAB to more than one version - otherwise it is impossible to see critical new bugs in 4.1. The image issue is a deeply annoying long-standing design issue that needs some funding for the several man weeks it takes to fix.I nominatebecause you cannot edit pps/ppsx Presentations.I nominate– hyphenation is broken.: previously in mab4.2, reproduced on 4.1.0.2 (rc2).- Clipboard API has lost functionalityseems this affects some extensions so moving to MAB; Function GETPIVOTDATA() always return #REF!Add the: unable to edit presentation master pagesoutdated install instructions: README in tarballI nominate: Title and Heading styles are mixed for several UI languages (FR, PT, Afrikaans, ...)I added: Cell (range) name lost after FILESAVE after other sheet has been deleted. It courses data loss.I added- No autocalculation of a cell referenced to a cell, if a column was inserted before -- stops productive work and calculation of cells doesn't work properly.Adding- Some fields don't fit into Options dialogSeveral duplicates (so it must be annoying to several people), leaves parts of options dialog inaccessible.add 67246 - FILEOPEN General input/output error for particular xls fileAdding- Edit > Select All doesn't work on a document beginning with a table.It's more than 2 years old. Is it that hard to fix?removed 37606 since it's reproducibile in 3.3.1, so mab4.1 is not its place.Adding the- Segmentation fault for Base, on 4.1.0.4, Gentoo, Kernel 3.10.1. I listed the compilation options.suggestingas MAB, ~700% performance regression vs. 4.0.x in loading ods filesAdding- By using full screen applications and then restore them, the toolbar disappears in normal viewAdding- EDITING Data > Validity broken (for list entries at least)Adding- EDITING: copied and pasted cells containing formulas are not recalculatedadding- [FILESAVE] Saving xls file which has cell with formula result #DIV/0! deleted formula, data lossSo it get's on the radar of the appropriate developer ;)Adding: datalossHereby I nominate "- ODG file forgets styles"Added- a edit to a basic file results in loss of data. Bibisected & test file availableNominated- complete loss of functionality for labels with 4.1 - regressionAdding- DATALOSS: Some cells with hyperlinks in XLS loose content on IMPORTI nominate the personaswhich appears to effect .deb versions of 4.1. Although personas provides no "useful" function in LibO, it is a great emotional aid in personalising LibO and adding company branding. Although I can manually bypass the problem, this would not be in the skill level of the normal user.AddedFormulas with error result disappear after reload, when file is saved as xls.Adding, data loss of formulas with error result when saving to .xlsAdding- EDITING: BUG: calc crashes on spell checkI would like to nominate. This bug is half fixed, for XLS files, but it's still not fixed for ODS files.It's an regression introduced in 4.1.I'm adding it here to keep it on dev radar. If you don't think it should be here please delete it.I propose- Cannot copy styles between different files and templates, I continuously have to close LO 4.1 and open LO 3.6 to transfer styles from documents to templates, especially for Calc.Chris"Writer incorrectly displays non-numbered list dot" Dot's are seen as unknown character since 4.1 beta 1Beta 2 sorryI added"Writer incorrectly displays non-numbered list dot" Dot's are seen as unknown character since 4.1 beta 2 sorry for the spamAdded regressions- FILEOPEN SMB File is Locked By Unknown User messageand- FILESAVE: Files locked after saved on network driveNote that it seems thatalso has slipped in 4.0.5I add- FILESAVE: Style Font name incompatible with older versions. Users can't force other users to upgrade their installation, just to correctly open their presentation. (Seems like a partially fixed)addedmsvcr100.dll not found after upgrade from 4.1.0 to 4.1.1 on Windows.already reported by 2 users.sorry, I meantnot 68576. I'm editing correct numbers.I add"Crash on launch on OS X"4.1.1 doesn't work with some Mac users forcing them to revert to 4.0.5AddedCrash when click Help bottom after select some functions in formula wizard.I think the issue is with the new functions in 4 like AVERAGEIF( )(In reply to)That was meant to bethat was already present and got removed from the list instead again.. re-adding.Added- seems like we have another help issue - draw is linking to impress help that isn't useful for draw making it pretty confusing for users trying to accomplish headers/footers on master documents in drawAddedSVG-images used as page background are rendered as bitmap / rasterized in LO (4.1.1.2) itself and even in generated PDFs or printouts. This worked fine in v3.4.5.I nominate two related bugs:Add dataloss: "thisComponent.store" corrupts the macro library password"Save As" a document containing a macro library protected by password corrupts the password of the macro libraryThey meet three criteria (Blocker Bug Definition): data loss, security bug, unusable function(In reply to)I think that is theadding- SLIDESHOW: Customized slideshow broken; shows all slides(In reply to)I think this is *not* the same bug as in.There is mentioned that the problem discussed in 62461 works fine in LO v3.6.5.Tested this bug (68927) with LO v3.6.5.2 () and the problem can also be reproduced (image is *still* rasterized). So two conclusions can be made:1. this bug (68927) must have been reintroduced in a version > 3.4.5and <= 3.6.5.22. the bugs 68927 and 62461 can *not* be the sameAddedWhen any text around in the cell format around @ format, this text is added to cell content when the file is reloaded.Added- FILESAVE: FILEOPEN: save document as docx and reopen result in an freeze/endless loop. It's an old bug from LO 3.6, but since 4.0 is approaching to EOL, I add it here.adding bugAdding, FILESAVE and FILEOPEN: Joined cells in table cause table distortion after save to doc and docx and reopen in LO.This is an old bug, first reported in Sep 2012, and still reproducable in 4.1.2.3. In my opinion, table distortion = data loss.adding- Other: field command "time (fixed)" does not work when used in a writer template file (regressions since 4.1.0.0rc1 IIRC)HiI am proposing #67370: automatic hyphenation is not visible in text files exported as tagged PDF. Since PDF/A-1 format forces tagging, PDF/A-1 are affected as well. And PDF/A-1 were supposed to be readable and accessible in long-term future. This will be huge issue for government, business and NGO users when they switch to 4.1.Seethere for bibisect log.Windows seems to be not affected by this issue. Mac OS X builds have not been tested.Best regardsMirosław ZalewskiHi,Let me be 'brave' and add:- [EDITING] Selecting with mouse: too fast changing to next/previous page- EDITING: Large document with many pictures causes freezing in Writer when scrolling with scroll bar(In reply to)Of course, the real brave people will be the dev(s) that, seeing the progress of improvements and cleaning up, will dive into these smelly issues :)Adding- EDITING: cell is not updated when referenced cell becomes empty due to sortFixed in master, but worth to fix in 4.1. too?Addingre: structured outline limitations... and that anchor does point to my comment cherry-picking a relatively solve-able corner case. In legal documents, the ability to comply with court rules is important.because doing editing only to discover some list formatting is unexpectedly unchangeable is even more frustrating; I bet the author offeels the same way about their related problem.Adding: reproducible crash (SEGFAULT) under not-yet-determined conditions when switching focus from one window to the other (LibreOffice Base forms).please add bugdocx not saving page colorNominatedRegression which makes LibreOffice lose the ability to print some borders. Also seems to affect performance. Simple test document available and bibisect is completedAddedSeems like drag & drop is freezing up KDE4, also it looks like a regressionThis bug seems to be affecting quite a few users from the amount of comments/dupes.I would like to nominate, a regression in which pasting charts with "data series in rows" from Calc into Writer/Impress results in badly mangled charts. This makes LO 4.1 difficult to use for presenting results. Bug is not present in LO 4.0.(In reply to)should be a duplicated of, see my comments there, so 68249 should not be on this list.is already on MAB4.1 list.Hi John & suokunlong - thanks for the nominations, John you're right that was a very annoying bug :-)I add"Help -> About LibreOffice" Logo not smooththis issue doesn't affect productivity and is just a matter of aesthetics... however I feel that this ugly about logo could be used against the LibO project to discredit the quality of the project.I mean, somebody could argue that "LibO comes out with a scrambled about box, would you dare editing your documents with such a buggy software?"I nominatewhich is a regression freezing LibreOffice in some case.I add- EDITING: Crash on nested table delete (previously titled "Copy Paste Crash"). While the specific situation may not be too common, I experience some crashes with recent LoDev 4.1 that I can't trace, so at least solving this one would rule this out.adding- properties dialog expands to screen size if long comment is enteredadded because the API does not use a PNG image that is embedded in the ODF file in addition to SVG drawing.Adding, LO shows 2D pie chart as 3D (and shows 3D as 2D) in xls and xlsx.adding- when multiple spreadsheets containing VBA macros are opened simultaneously, the last opened document is always considered the "Active" Document/Worksheet/Cell, even if a previous spreadsheet has the focus. Additionally, if the "last opened" document is closed, references to something in the "Active" context fail completely.Nominated- writer hangs if you open a doc with a table in the footer. This is a recent regression (4.1), the bug has been bibisected.Thanks allNominating Bug "70499 - FILEOPEN Cannot select unprotected cells in XSLX sheet with worksheet protection" as it is an issue with anyone needing to fill in partially protected xlsx forms, which potentially affects an array of different cases.was a dupe of.I nominatewhich is a regression from 4.1.3. It make the functions wizard in Calc less interesting to use. (ATM the bug is marked for version 4.2 but it is reproducible in 4.1.5.0.0+ and I guess in 4.1.4.1 but this version number is not available in BZ).Best regards. JBFAddingthat has the same cause as. Present in 4.1.4.1Add: Text disappear when editing a 90deg Textbox.This feature worked without problems in LO 4.0.x. So it may prevent users to update to the most actual version.- Fax-Wizard - Personal Data are only partial adoptedThe wizards are available to start a new fax (etc.) document from scratch. If the personal data are not adopted in the created fax document (and are not in the correct order) the wizard is not useful. This is also a very visible issue, because normal office users will create documents using a wizard.I nominate "- Impress hangs on creating new style"I consideras highly critical. It practically means no conditional formatting until fixed. I found many duplicates, conditional formatting seems really messy in many ways. Evil thinkers consider it "a good example for what goes wrong in LibreOffice development" .This bug must be fixed.add- FORMATTING: Toggling off bold/italic does not turn it off, but instead applies no-bold/no-italic. This messes up any style afterwards that has bold/italic in it (until Clear Direct Formatting is used) ..Adding: one Unix, one cannot anymore open / modify embedded databases on a non-local filesystems.I nominateFunction GETPIVOTDATA does not work as it did upto 4.0.6I nominateGETPIVOTDATA does not work as it did up to 4.0.6Nominating:- Default value of "Show cell grid lines" checkbox on sidebar. Highly visible new feature semi-broken, several duplicates, seems annoying enough.- SIDEBAR: Wrong Paragraph spacing values after opening Properties deck. Again, new and visible feature half-broken, making the sidebar pretty annoying to use for me.Add- Writer's UI crashes when scrolling pages if formatting marks are visible: the work of Writer is broken in Windows XP within a single release (between 4.1.4.2 and 4.1.5.0.0+).Added- very simple test document is locking LibreOffice on multiple platforms. Bibisected and confirmed it's a regression that came in somewhere in the early days of 4.0Removing developer list for bulk change.readding after bulk change.AddCrash when writing into a section with columns, with highest priority - SophieAddCalc required Cltr+Shift+F9 in some conditions => some formula are recalculated, but not all, and user doesn't know itBug - 67712; FORMCONTROLS: anchored to cell but changes position after reopeningThere is regression and Data LossI nominate: regression and datalossadding- FILESAVE: Crashes when trying to save a particular docx file(2013-12-03 ..)Added- "FILESAVE Images in .docx and .xlsx files show "Read-Error", probably corrupted by auto-save"Moved from MAB 4.0 since 4.0 reached EOL.Pretty big show-stopper as it seriously impedes collaborating with colleagues who decide to work with a docx file.Has been a MAB since 3.6.Addedfile corruption on saving as xls - SophieContinuing the cleaning of mab4.0. Only bugs not yet reported reproducible in 4.1 or 4.2 should remain.NominatingIt's almost impossible to open that specifix XLSX file.- FORMATTING: Formating numbers in Data Pilot table does not work anymore (regression)Nominating this bug, because it is a regression (to 4.0.0.x and still here in 4.2.0.4) and because it is really annoying to do the formating for each and every data pilot table / pivot table once and once again after the data is refreshed.(In reply to)FWIW, this never worked, so not a regression. If it ever appeared to have worked before, it was a fluke.added, comments lost on the page that is copied to another one. SophieNominated- Impossible to copy just values from spreadsheet into a table in Writer - inherited by OOo but quite annoying.a couple dupes and a few users involved. Plus I guess it was reported during OOo days and had 100+ "votes" on their infra.Nomintated- results of simple formulas are being quasi lost with xlsx but if you just edit the formula by removing the last character ')' and then put the character back the formula works as expected.- UI mouse pointer disappears during presentation and does not come back after exiting presentationNominating this bug, because it is a regression (to 4.0 series and still in 4.2) and because it is really annoying, I have to restart LibreOffice in order to use my mouse again.Nominating- Password-protected documents saved unencrypted for auto-recoveryBug is serious security issue. Regression apparently appeared in 3.4.2.1 and is assumed to be still present in the 4.2 branch.Hereby I nominate "- LibreOffice Writer text highligthing is not compatible with Microsoft Word DOC and DOCX (highlighting transforms to background color)"(In reply to)Seconded. It's the most important problem in exchanging document with my collegues at work.I nominate "- Detective "Trace Precedents" or "Trace Dependents" pointing to a different tab does not provide reference cells".Though the bug or rather missing feature is old I consider it to be very important. I find it impracticable to understand complex spreadsheets without a "detective", which works across worksheets. Therefore, I consider MS Excel to be necessary for understanding a complex spreadsheet, even if one works primarily with LibreOffice Calc.Removed- was an enhancement request that does not belong on the list.(In reply to)done :)AddedSample ods file crash at opening.please do not add new bugs here. the 4.1.x branch won't probably have other release after 4.1.6. new annoying bugs should be posted to the mab4.2 or mab4.3 lists.existing mab4.1 which are still reproducible in 4.2.x branch can be moved to the mab4.2 list.Ok. all existing mab4.1 have been moved to the mab4.2 list.marking this as CLOSED FIXEDusing spareadsheet, when i try to add new line in Cell ... means writing more than one line in a cell, save changes, close the file and re-open it, cell content appears all in single line. new line character is lost. i'm saving my file as .xlsx file. (MS Excel 2007/20010 etc. ) format.closing MAB againplease DO NOT reopen this bugHi all,The MAB docs on the wiki have been updated to reflect the newPriority-based system for categorizing bugs:The old MAB tracker bugs (mab4.3, mab4.4, etc.) will remain inBugzilla for historical reference, but should be ignored for currentwork. ......................FINAL mab4.1 STATS......................fixed bugs -> 137open bugs -> 0......................Hi all,The MAB docs on the wiki have been updated to reflect the newPriority-based system for categorizing bugs:The old MAB tracker bugs (mab4.3, mab4.4, etc.) will remain inBugzilla for historical reference, but should be ignored for currentwork. ......................FINAL mab4.1 STATS......................fixed bugs -> 137open bugs -> 0......................
id=62758	If I try to add LibreOffice 4.0.1 MSI to a GPO I recieve the error:"Add operation failed. Unable to extract deployment information from the package."It's not possible to proceed, deployment is not possible at all. This happens on every machine, also those where LibreOffice is and was never installed. This bug exists since you migrated to the single MSI file in 3.5. This issue does not exists in 3.4.x. CreatedAdd operation failed screenshotLooks like the Language value causes this:1033,1078,1118,1025,1101,1610,1059,1026,2117,1093,2121,1150,1603,5146,1027,1029,1106,1030,1031,1604,2129,1032,2057,7177,1553,1034,1061,1069,1065,1035,1036,2108,1084,1110,1095,1037,1081,1050,1038,1057,1039,1040,1041,1079,1087,1107,1099,1042,1111,1120,1574,1134,1108,1063,1062,1605,1071,1100,1104,1112,1102,1109,1044,1121,1043,2068,1580,1132,1154,2162,1096,1094,1045,2070,1046,1048,1049,1569,1103,1606,1113,2074,2133,1669,1051,1060,1052,3098,1579,1072,1053,1089,1097,1098,1064,1054,1074,1055,1073,1092,1152,1058,1091,1075,1066,1076,2052,3076,5124,1028,1077Reducing to this works:1033,1078,1118,1025,1101,1610,1059,1026,2117,1093,2121,1150,1603,5146,1027,1029,1106,1030,1031,1604,2129,1032,2057,7177,1553,1034,1061,1069,1065,1035,1036,2108,1084,1110,1095,1037,1081,1050,1038,1057,1039,1040,1041,1079,1087,1107,1099,1042,1111,1120Entering only one more LCID and it's no longer working.Same bug in LibreOffice_4.0.2.1_Win_x86.msiSee also Troubleshooting section of*** This bug has been marked as a duplicate of***
id=62038	CreatedExample presentation with eps imageI just upgraded to 4.0.1 and I noticed that eps files don't display at all in presentation mode. They display fine in edit mode.It used to work fine in 3.6.5.I attach an example presentation with an eps file in it. I see it in edit mode, but when I press F5 the image doesn't display. More or less [Reproducible] with Server Installation of "LibO 4.0.0.3 - GERMAN UI / German Locale [Build ID: 7545bee9c2a0782548772a21bc84a9dcc583b89)]" {tinderbox: @6, pull time 2013-01-31 11:30(?)} on German WIN7 Home Premium (64bit) with separate new User Profile:In Edit mode I see brown rectangle borders (what probably is a separate bug, the picture should show a chart graph "Pointspread function"), in SLIDESHOW the picture is not visible at all, no placeholder, nothing!@Thorsten:Please change Status to ASSIGNED and add yourself to "Assigned To" if you accept this Bug or forward the Bug if it's not your turfeps images were made using R. They show in the slide editing mode but not in slideshow. Also missing when exporting to pdf.Bug is still present with version 4.0.2I also noticed that the plots from .eps files disappear when I save the file as PDF.- I select "Export as PDF" in the File menu- It creates a pdf file but the plot from the .eps doesn't show.(In reply to)The same problem happens when exporting to PDF with Writer.Btw, this bug seems similar to:- : EPS images are not shown when PDF is exportedBug still there in 4.0.3Bug still there in 4.0.4***has been marked as a duplicate of this bug. ***Also a bug for me on Fedora 19 with libreoffice-impress-4.1.0.1-8.fc19.x86_64I noticed that this happens when you have a picture that is a metafile.(when you click it, bottom left shows 'metafile selected') A very clunky work-around is to copy, and then 'paste special' as bitmap.In Version 4.1.0.4Build ID: 89ea49ddacd9aa532507cbf852f2bb22b1ace28 running on OpenSuSE Linux eps images are not visible in presentation mode nor are they in an exported pdf.Just tested version 4.0.5.2 and bug is still there.Bug still there in 4.1.1.2***has been marked as a duplicate of this bug. ***adjust version according toStill present in LibreOffice 4.1.2.3 410m0(Build:3) on Debian. This forces a downgrade for this user.On pc Debian x86-64 with master sources updated today, I can reproduce this.During file opening, I noticed this:warn:legacy.osl:5132:1:sal/osl/unx/file.cxx:341: FileHandle_Impl::readAt(): not seekableand this when doing F5:warn:sfx.control:5132:1:sfx2/source/control/dispatch.cxx:1530: Childwindow slot missing: 10365warn:sfx.control:5132:1:sfx2/source/control/dispatch.cxx:1530: Childwindow slot missing: 10365(This is an automated message.)LibreOffice development currently prioritizes bugs with the so called MAB (most annoying bugs) -- as this bug has not run through that process (including writing a short rationale for this bug being a candidate and other who are watching the tracker bug silently approving that rationale etc.) its priority is set to high. Note this is effectively no change in the urgency assigned to this bug, as we are currently not making a difference between high and highest and severity is untouched.You can find out more about MABs and how the process works by contacting libreoffice qa on irc:The QA wiki page also gives you hints on how to get in contact with the team (if IRC fails you, your next best choice is the mailing list):Createdeps file made with matplotlibHere is a simple eps file made with matplotlib. If I drop it into an impress slide then it shows in edit mode, but is not visible in presentation mode.tested on 4.1 and 4.2.0.3 on fedora 20 linux.From `git bisect bad`:--------------------3f239c0dbc91ea922758438ecbddf6dc7203c268 is the first bad commitcommit 3f239c0dbc91ea922758438ecbddf6dc7203c268Author: Bjoern Michaelsen <>Date: Tue Dec 11 01:59:31 2012 +0000 source-hash-ae4e4a11d4300f7448cb6bd170fcb034542caddc commit ae4e4a11d4300f7448cb6bd170fcb034542caddc Author: Rene Engelhard <> AuthorDate: Tue Nov 6 21:24:32 2012 +0100 Commit: Rene Engelhard <> CommitDate: Tue Nov 6 21:24:32 2012 +0100 typo... Change-Id: I2c7968194afbcf74967cd16c639dce7de858a513:100644 100644 c09b92a8ddf24b8738a7cd3a695ae1e4482d354c 6b13afd13f023cedac65a896318de4aa55dead27 M autogen.log:100644 100644 bcee1e11bd693642ca5a6330175b58082e5dcdd0 54d2377f5b3afd6ed668b3e24cb877c289119ec5 M ccache.log:100644 100644 75677cef16786d2cc95c0d8f301482278ca055c3 d18a6ebcd3b8537c3dd3dbc16e862fb6370ecb8a M commitmsg:100644 100644 83b4ecc0ecb3e031c804d49f45f854e95d5cc961 d482c00e5fff6081c6b87b637fd9ffaf3e1e2c6c M dev-install.log:100644 100644 91437b9974ffada7e049273419bb8c66c91c0539 abf45ab9609c77a5ab952aa310eafe8c2ffaf85c M make.log:040000 040000 45c0bab8b669778ab523c8f65a25e8c9afde604a f4bfa15b2f72d3df5675b07bcf32254a819b9d19 M optFrom `git bisect log`:--------------------# bad: [793dbf6f80f497dfe587d560d6257f42a24273f6] source-hash-1581b1fc3ac82a7bd62df968226e98604a4ca52d# good: [65fd30f5cb4cdd37995a33420ed8273c0a29bf00] source-hash-d6cde02dbce8c28c6af836e2dc1120f8a6ef9932git bisect start 'latest' 'oldest'# bad: [8092559c5013969ebda017d79200463b9b975038] source-hash-fd84daf696a368c2c7561b5253b32a63ecdeca4agit bisect bad 8092559c5013969ebda017d79200463b9b975038# good: [2bdbcaf93e4616633a733de7eb88ba19571929ac] source-hash-cf04745f7a027594fd64a493c276a8280dbccfe1git bisect good 2bdbcaf93e4616633a733de7eb88ba19571929ac# good: [f823dd19086ed09fb8e2072050e963cf1bfcd5fe] source-hash-b679a2a02180c017bd8b596fb2e4f283bad93b75git bisect good f823dd19086ed09fb8e2072050e963cf1bfcd5fe# good: [8cf46b05e525ac3602433613f227f0dcacc44035] source-hash-1692cf6854ff7adbb2bd47f2f7ec2b3de51864f3git bisect good 8cf46b05e525ac3602433613f227f0dcacc44035# bad: [3cb56a12a43a7c2a43954dc7694a6f6bde544f98] source-hash-41c2b0375773b2d2945d75e255ea6bb6c7fd378dgit bisect bad 3cb56a12a43a7c2a43954dc7694a6f6bde544f98# bad: [6178060e0e995b23fb5fe35c52b1fba67bd0760d] source-hash-44b96a2fce52b6e3e683dc917fab219cf75001dbgit bisect bad 6178060e0e995b23fb5fe35c52b1fba67bd0760d# good: [c01053e32bdb3d0b413b71ddde869618fa5d2624] source-hash-4316e643ef345b0f673b4a03a80a4b7cb3185588git bisect good c01053e32bdb3d0b413b71ddde869618fa5d2624# bad: [8125b06dfe80e260ff2108fab3c85eb03ec2608b] source-hash-683758efb22d08a4cf211a6d985148f513da2a90git bisect bad 8125b06dfe80e260ff2108fab3c85eb03ec2608b# bad: [3f239c0dbc91ea922758438ecbddf6dc7203c268] source-hash-ae4e4a11d4300f7448cb6bd170fcb034542caddcgit bisect bad 3f239c0dbc91ea922758438ecbddf6dc7203c268***has been marked as a duplicate of this bug. ***Wow, we have a 'solution'!!? ;-)With Ubuntu 14.04 (LO 4.2.3.3) when I open my old .odp files containing eps and svg images, I get an Error:"General Error. General input/output error." and that's it.The solution here is, that files showing wrong svg-s and eps-s earlier, by now do not load at all any longer.Meaning, files created with LO 3.6 simply cannot open any longer. I don't know if this really has to do with this bug, but I think so, since all other files (not containing these image types) open properly. I wonder, if this ought not be put at the upper echelon of all bugs!?Then, the name of this software should be changed.We cannot call this software as LibreOffice 4.You can call this, for example, LimitOffice, PityOffice, whatever you want, but other than LibreOffice.The reason is so obvious that I don't need to say.Is somebody doesn't understand, I will write.@taka:Yep. I noticed you re-opened because someone had 'dup'-ed 76359 to here. The problem does apply to ALL AND ANY .eps here; and to ALL AND ANY .svg here; though the .svg-s are often only modified, cut off on a margin, or whatnot.I agree, a software that runs happily without .eps and without .svg is totally useless, at least to me: because these are features that MS Office had always neglected. I, as computer scientist, consider all sorts of .jp[e]g and stuff child-play. The only useful and sustainable method to draw an image is one with infinite resolution; not a pixel- or block-based 'little helper'. With Libreoffice falling back to the lowly abilities of MS Office, I fail to see any reason to stick with it. (I know what I'll hear next: "that's the beauty of choice!") But those voices will be voices of nincompoops, because regression is not "choices" but sh***y project management.It's because of bugs like this that I don't think LibreOffice is viable for scientific work. I'm not sure why I stopped using Latex but it is clearly superior to LibreOffice (and MS Office). Also, now there are many web sites that let you collaborate on Latex documents (for free). With the ease of interweaving R computations and graphics into documents, there is really no reason to use LibreOffice. The fact that this bug has not been fixed in over a year (and the maintainers of LibreOffice could not care less) clearly means that LibreOffice is not being used by researchers. So I've re-learned how to use Latex and doubt I'll ever use LibreOffice again. (MS Office is even worse - you can't format numbers in Word tables - explains why you see so many poorly designed tables.)Let's give more visibility to this bug by nominating it as MAB.Here are some reasons:- old bug- regression- impacts at least a whole category of users (scientific ones)- no workaround- seems to happen with every eps file (if not, any example of an odp containing eps which works well?)About this last one, if it's confirmed, we should change the title of this tracker and indicate that all eps are concerned and so fdo#76359 would be a dup indeed.Thorsten/Caolán: I don't know if it's a rendering/vcl problem or Impress/Draw specific pb.As noted on, with the ImageMagick application installed, Windows builds of LibreOffice do import and render EPS content into Impress, Writer and Draw.But can confirm that for Windows builds of LibreOffice with ImageMagick also installed--they do not render slide elements during Slide show presentation wef. the 3.6.x -> 4.0.0 transition. On Windows 7 sp1, 64-bitThe "RNE Sample for.odp" from Roman E's 2012-11-28 Test kit, and "example-eps-problem.odp" example presentation attached to this bug renders correctly in both edit and during slideshow with Version 3.6.5.2 (Build ID: 5b93205). And are also both correctly rendered in edit and Slideshow mode inVersion 3.6.7.2 (Build ID: e183d5b).On the same system for the two presentations the EPS render in edit mode but do not render (i.e. no image rendered just the slide title) for the Version 4.0.6.2 (Build ID: 2e2573268451a50806fcd60ae2d9fe01dd0ce24) build.On the same system the EPS renders in edit mode but is not rendered in SlideshowVersion: 4.1.5.3Build ID: 1c1366bba2ba2b554cd2ca4d87c06da81c05d24Finally on the same Windows system EPS no longer renders in edit mode nor slideshow mode. Just a black image fill is present in edit mode--and slide has no image.Version: 4.2.0.4Build ID: 05dceb5d363845f2cf968344d7adab8dcfb2ba71Even if the eps file contains a bitmap preview, it does not work. :-(Until the bug is corrected, you have the following workaround for new presentations: use Draw to convert your EPS file in bitmap.step 1: insert the eps image in a new Draw documentstep 2: select and copy the image by ctrl+Cstep 3: go to Impress and do paste special as bitmap.Best regards. JBF***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***I wonder if we should add the bug reports on identically the same problem with SVG (including mine) as dups here? When I search the bug list for SVG, I hit a good number of people who have likewise lost all abilities to show/export SVG-s.(e.g. 62284, 64075, 76988, 76353)Before that, someone with more insight ought to confirm that both are actually linked. At least here, using EPS and SVG, both disappeared at the same time from my slide shows and exports - with the up[down]grade from 3.6 to 4.X.X.And someone to change the title, please. This applies to all images; it is a generic problem. The title suggests otherwise. This is why it failed to jump onto the MAB list (which currently contains items with much lower blocker capabilities).***has been marked as a duplicate of this bug. ***Caolan McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: fdo#62038 EPS not rendered in drawinglayer code pathsThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-2":Resolves: fdo#62038 EPS not rendered in drawinglayer code pathsIt will be available in LibreOffice 4.2.5.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Createdtest ODP impress with inserted EPS and EMFconfirming resolved fixed on Windows 7 sp1, 64-bitVersion: 4.3.0.0.alpha1+Build ID: 0b03f7ed575838f90e6b1ebec3538a3a214f81fbTinderBox: Win-x86@39, Branch:master, Time: 2014-04-30_01:30:46However, several helper files are requiredpstoedit -- pstoedit.exe ()GhostScript -- gswin32c.exe ()ImageMagick -- convert.exe ()test ODP impress with inserted EPS and example EMF renderings, and resulting PDF export attachedCreatedExport to PDF of test ODP impress with inserted EPS and EMFGood, that's a starting point ...Can someone please be good enough to also test on Linux; and, pleeeeze, with SVGs (e.g. the very simple one that I attached to my bug report, and would de-scale the whole picture when opened with 4.X.X)?Confirming resolved fixed for master and version 4.2.5.0.0+ under Linux. Tested with Ubuntu 14.04 x86-64.Thank you very much Caolán !!!Best regards. JBFUwe,(In reply to)Caolan worked it up on Linux, so pretty sure it is covered there.Quality of SVGs really are another issue. Have the outstanding MAB 4.1for handling SVG previews (wef 4.0.0 converting to PNG rather than rendering as vector) on hold to "do it right in 4.2"Alas, so the troubles with the transitions 3.6 to 4.X.X remain unresolved for me, and a number of others in the scientific community (see, by Rick), since my images are mostly in svg, and rendered 'okay' earlier. Yes, I filed the svg bug as well, last year. As of now, it seems to be quite unnoticed.(Could it be that LO has a problem with QA and QC?)Uwe, there's only one way for an opensource project to go: one bug at a time and priorities have to be set facing over 9k open bugs.Please link the remaining bugs you are referring to and let this one rest since it is fixed.Open other bugs for any remaining bugs not already filed. thanks(In reply to)The problem is that too many users do not consider useful to contribute to QA ...I commented your bug report closed as duplicate of this one :Best regards. JBF***has been marked as a duplicate of this bug. ***I wish the patch applied to also ver. 4.1.X because this bug is so serious that people cannot use.taka: 4.1.6 is the last official LO version from TDF to be released (see) so the patch can only backported in unofficial TDF versions.This bug is (still ?) present in 4.3.1 on Windows and OS X.When opening presentation mode, my .eps images do not show on Windows (8) and OS X (x86_64, 10.9). On Linux (x86_64, Arch) however, the images show fine.In edit mode, everything is fine. SVGs also show fine in both modes on all OSs.(In reply to)Seefor the list of "helper" files that ARE necessary to be installed on Windows. And, on OSX IIRC both ghostscript and pstoedit will be necessary (have always been necessary) to work with .EPS files in OOo, AOO and LibreOffice.Resetting this issue resolved fixed -- so please follow along withThis now works on Linux Mint, but you have to upgrade from the ppa. Thecurrent version still has the bug.Here's how I did it.sudo apt-get remove libreofficesudo apt-get install python-software-propertiessudo apt-add-repository pp:libreoffice/libreoffice-4-3 (Notice, not -4-2)sudo apt-get updatePeter>>>>>>>Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=62461	CreatedSVG fileLO-4.x.x creates new ODG file with violation of format, if an SVG picture inserted into the file.1. Run LibreDraw-3.6.5.2. Insert SVG file (attached).3. Save the file as "365.odg".4. Unzip the file “365.odg” and make sure that inside there is only an SVG drawing.5. Open the file "365.odg" using LibreDraw-4.1.0.0 or LibreDraw-4.0.2.6. Save the file as "410.odg".7. Unzip the file “410.odg” and make sure that inside there are 2 pictures: PNG and SVG.8. Open the file "410.odg", using LibreDraw-3.6.5.9. Save the file as "410-365.odg".10. Unzip the file “410-365.odg” and make sure that inside there is only a PNG image.11. Read the file "410.odg/content.xml". You can see the bug - two different images were put on the same place:<draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="8cm" svg:height="10.35cm" svg:x="11.5cm" svg:y="2.15cm"> <draw:image xlink:href="Pictures/100002010000026E00000324983C42CB.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad" /> <draw:image xlink:href="Pictures/200000010000545600006D24A7271475.svg" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"> <text:p /> </draw:image> </draw:frame> This is the LO-4’s bug only. Do it: 1. Follow steps 1-7 (Description). 2. Open the file «410.odg/conten.xml» using a text editor. 3. Change points of images. Write:<draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="8cm" svg:height="10.35cm" svg:x="11.5cm" svg:y="2.15cm"> <draw:image xlink:href="Pictures/100002010000026E00000324983C42CB.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad" /> - <draw:image xlink:href="Pictures/200000010000545600006D24A7271475.svg" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"> <text:p /> </draw:image> </draw:frame>as:<draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="8cm" svg:height="10.35cm" svg:x="11.5cm" svg:y="2.15cm"> <draw:image xlink:href="Pictures/200000010000545600006D24A7271475.svg" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad" /> - <draw:image xlink:href=" Pictures/100002010000026E00000324983C42CB.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"> <text:p /> </draw:image> </draw:frame>. 4. Save this file. 5. Back up the contents of the folder "410" in the ZIP archive. 6. Rename the archive «410.zip» in «410edit.odg» 8. Open the file "410edit.odg", using LibreDraw-3.6.5. 9. Save the file as "410edit-365.odg". 10. Unzip the file “410edit-365.odg” and make sure that inside there is only a SVG image. 11. Read the file "410edit-365.odg/content.xml". This bug is absent:<draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="8cm" svg:height="10.35cm" svg:x="11.5cm" svg:y="2.15cm"> <draw:image xlink:href="Pictures/200000010000545600006D24A7271475.svg" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad" /> <text:p /> </draw:image> </draw:frame>The file “410edit-365.odg” is identical to the original file “365.odg”.CreatedLO-4(dev_4.1.0.0) loses qualityLook at the picture (an attachment). You will compare the quality of work LibreOffice_3.6.5.2 ArchLinux_build-1 (above) and LibreOfficeDev_4.1.0.0_Win_x86 (below). It can be seen that LibreOfficeDev_4.1.0.0_Win_x86 displays and print bitmap (PNG image) losing quality.CreatedApacheOO-3.4.1 loses quality It is possible that this bug came from the ASF:"LibreOffoce 4.0 ReleaseNotes: Draw: - Multi-image support in ODF allowing a bitmap + SVG representation eg. (Armin Le-Grand - Apache)". ApacheOpenOffice-3.4.1 works on the same algorithm (picture in attachment):content.xml (apacheOO-3.4.1):- <draw:page draw:name="page1" draw:style-name="dp1" draw:master-page-name="Обычный">- <draw:frame draw:style-name="gr1" draw:text-style-name="P1" draw:layer="layout" svg:width="18.999cm" svg:height="4.094cm" svg:x="1.129cm" svg:y="12.825cm"> <draw:image xlink:href="Pictures/10000201000005F3000001480C4D13B2.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad" /> - <draw:image xlink:href="Pictures/101D738500022ADA0000779DACC7D2B8.svg" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"> <text:p /> </draw:image> </draw:frame> </draw:page> </office:drawing>CreatedODG files for exampleI imagine the multi-image support is a feature giving a fallback image for renderers that can't render SVG (I guess). It shouldn't really affect LibreOffice at all.So - I'm trying to unwind the user-visible bug from- I would hope that we would load/render the SVG fallback properly, however it is clear that the new SVG code produces rather lower quality output than the older one - though it is retained as vectors :-)Can you be more specific on the problems - I see some pretty serious drop-offs in SVG rendering here as the main bug: I see only six of the large document icons rendered eg.CreatedThis image shows the file in Inkscape.Createdsimple file with 2 SVGConvert SVG image in a PNG bitmap takes a lot of time because DPI is changing and PNG smoothes. Compare the time required for programs (LO-3.6.5 vs. LO-4.x.x) to open this simple file.Save the file in LibreOffice-4.x.x and look at its size.This's not quality loss, this's corruption.(In reply to)Michael,LO 4.0 rasterize SVG to PNG and stores both original SVG and corresponding PNG at the same position on the page.LO 3.6 doesn't read it the same way and "cleans-up" an ODF file by removing original SVG.So if you resave original SVG-containing ODF with 4.0 and then resave result from 3.6, you will end up with a file with PNG (only) instead of SVG.If I properly understand how ODF works, probably PNG could be stored by 4.0 as 'ObjectReplacement'. I believe in such a case it would not conflict with existing SVG.What I'm not sure though is how LO 3.6 will react on it. Eg. will it take 4.0 rendered PNG or render SVG on its own? In the latter case the whole idea of storing PNG would be destroyed.(In reply to)That probably worth a separate bug, to compare SVG rendering in LO 4.0 and 3.6 and track regressions (if any).I think the good (by time consuming) approach would be to run both over W3C test set.Createdfilter's work (AOO-3.4.1 vs. LO-4.0.3)Michael,Apache OpenOffice-3.4.1 uses a bilinear filter to output each additional PNG image. This is a quick filter of low quality. Therefore:- Apache Draw opens the file with the time that is acceptable to the user;- no messages in The Apache Bugzilla.LibreOffice-4.x.x uses the Lanczos filter to output each additional image:“Release Notes 3.6 > Core: … Added Lanczos algorithm for resizing of images and use it instead of interpolate algorithm. This change has increased the quality of images when reducing image resolution in PDF export. fdo#46378 (Tomaž Vajngerl)”This filter determines the transparency of the color at each point of each additional PNG image. Therefore, the filter works slowly, but with high quality.I found the bug because of this.You can compare works of filters if you look the picture in the attachment. In the image: at the top - Apache bilinear filter; at the bottom – the Lanczos filter (LibreOffice_4.x.x).I think that we have needs for return to LibreOffice-3.6.5.Hm, much more serious. Read:(filters and storage)(filters and storage)(Impress)(Writer; ODT file contains the backup PNG image)FWIW, this is perfectly valid ODF, changing title accordingly. C.f. the zeroOrMore image/ole/applet etc. inside draw:frame in the odf1.2 RNG schema. It is of course unfortunate that 3.6.x picks the less-ideal graphic.CreatedODT and ODP files by LO-3.6.5 and LO-4.1.0(In reply to)--You try to work with files (an attachment) in LibreOffice-3.6.5, then - in LibreOffice-4.x.x.LO-4 makes stop using SVG files in the ODT, ODP and ODG documents.Is not that enough to go back to the old algorithm?--P.S. I understand that reducing the severity of the error is the most correct and shortest route to success.(In reply to)--I think that:A. If the patch provides good work to other Office programs, but hinders the work of LibreOffice, this patch should be canceled.B. The user of such a program can start using LibreOffice or perform these steps. 1. Extract the SVG file from the ODF container: 2. Export SVG file into a PNG image using Inkscape. 3. Replace in the ODF file native SVG drawing at this PNG image.CreatedKarbon-2.6.2 opened a file created by LibreDraw-4.x.xNo comment...I got bitten by this when I used my laptop to display a presentation created on my desktop (which has been updated to a newer version). The rather complex lineart with text that I used was rendered unreadable.Michael, the user visible bugs are:1) I insert lineart because it is _required_ for my use. As a user of libreoffice I do not care about implementations that cannot display it. If you want to fix such cases, convert the svg to ODF drawings, or make it possible to disable such compatibility features.2) Filesize is unnecessarily increased by saving PNG in addition. Again, such compatibility options belong in the separate "compatible" ODF format, or should be activated by user-intervention.3) this 'feature' as currently implemented breaks compatibility with older versions of libreoffice and external tools (see previous comment). In the case of LO-3.x, only the png will be shown and subsequently saved, and thus causes a severe compatibility problem (the vector art is lost for ever and replaced by a badly rendered png). Again, the point of vector art is to prevent having bitmaps in the file. I do not like LO trying to second-guess my goals by doing such conversions behind my back. Its like saving bad quality JPGs for every embedded PNG. Such things are nicely available by right clicking the image where you can modify the compression setting. Same could be done for SVG, but do not do it automatically!btw, from the spec:"Each child element of a frame is a different representation of the same content. The order of content elements reflects the document author's preference for rendering, with the first child element being preferred. That means that consumers should render the first child element that they support. A frame may contain multiple content elements, but shall contain at least one content element."In most cases, it is obvious that the document author, (i.e. me) prefers the content that he actually inserted. It may well be that older versions of OO.org will fail with this (that seems to have been Armin's reasoning for putting png first), but that only stresses the need for configuration of this feature and is not an excuse for breaking the spec.CreatedPNG by LibO-4.2.0 alpha1LidreOfficeDev-4.2.0.0 began to understand the mask. But, nevertheless, problems arise when creating PNG (see attachment):1. Object "Globe (Web template)" is lost.2. Size (in pixels) is less than the size of the original SVG file. The time required to display the image on the screen has not changed. This is indirect evidence that the filter each time re-converts the SVG file to PNG image and PNG, embedded in the file when you first save, do not use.(In reply to)Proof: 1. File 410.odg extracted from the archive (). 2. File 410.odg\Pictures\10000201000005F3000001484CF701B4.png extracted and then opened for viewing with using the external program such as IrfanView. 3. Start LibO Draw 4.1.x and open the file 410.odt. 4. Compare the pictures.(In reply to)Sorry, start LibO Draw 4.2.0.0_alpha1 and open the file «410.odt».I raised the status to "critical" because:1. LibO-4.x.x creates an additional PNG file which API does not use.2. Broken continuity versions (3.6.x vs 4.x.x).3. Earlier versions of the program (3.6.7) do its work much better.Caolan McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: fdo#62461 put preferred image firstThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Ordered with favourite first, followed by fallback. Seems to work ok, testing appreciated. Proposed for 4-1 asthanks. Will test early next week!(In reply to)Surely you changed the status to unconfirmed by mistake : without explanation, just after a patch has been pushed.Changed back to fixed.Best regards. JBFA bug shouldn't be listed at two MABs, removing it from the second (4.2) one.Tested by recompiling fedora (fc20 branch) libreoffice with a patch based on the one in. Confirmed that older versions of libreoffice (3.6.7) now correctly read the svg file. However, saving in that version will drop the png copy from the file (cannot be helped, and is better than dropping the svg).I assume that Armin put the png first to facilitate backwards compatability with OO.org versions that did not include svg support. Apparently these versions did not follow the spec well enough to check for alternative fallback images. However, i did not go through the trouble to test this. We should, however, ask ourself the question what is the purpose of this fallback image if there is no use-case for it (i.e. the software that does not support svg, also does not know how to read fallback images).In my opinion, interoperability between LO 3.6.x and 4.x is more important than with ancient OO.org versions, so I think the new way is a more sane default. The user-visible bug for me personally is thus fixed.Whether the original reporter is happy with the resolution I do not know as problems may remain:- interoperability with 3rd party programs not dealing well with multiple images- not asking for user confirmation and defaulting to including bitmap copies for vectorart images, thereby increasing file-size (perhaps without reason as explained above).JBF: sorry, I quickly replied and it seems bugzilla defaults to putting unconfirmed in the bug status window when I add comments, I did not notice and thus inadvertently changed the status.Seems the patch will be rejected for 4.1:Also, it is not clear to me whether Michael understood that this breaks compatibility with LO in a minor way in order to maintain compatibility with much older OO versions in a bigger way.(I could be convinced by a good argumentation, but the point seems not to have been addressed).Since this is a 4.1mab, I guess it does now make sense to reopen.I propose an alternative fix for 4.1 by making the order depended on a setting.Most obvious would be to save it in the wrong way for the 1.2 Compat ODF format.(and this would avoid adding extra options).Comments?Changed importance to reflect the new policy - SophieSince the only 4.1.X version to be released is 4.1.6 and I suppose this one will contain only critical bug fixes (like crashes for example), I propose to close this tracker.Just to be sure everything is still ok on 4.2 branch, I made the following quick test with 4.2 sources updated some days ago:- create a brand new file on Writer- insert SVG- save in odt- rename odt->zip- unzip- check svg is before png it's ok.Any thought?lets keep this closed, reopening bugs is really problematic. If there is still a bone of contention in some area I think its now better to open a new bug about that
id=63019	Can not filter a table (autofilter). When i use autofilter, the software hangs I am not able to reproduce this. I tested the official 4.0.2.1 and 4.0.2.2 builds on SLED11-SP2 x86_64. I tried to create and play with autofilter and it worked fine.hfrancod@ could you please provide more details? 1. What system are you using, please? (Linux vendor, architecture) 2. Did you get the packages fromor from any other location, please? 3. Could you please attach a test document the steps to reproduce the problems?The best form is: 1. Open test document in Calc 2. Select in menu.... 3. Do this 4. Do that ....Result: ...Expected result: ...Createdattachment-24296-0.htmlok1. Ubuntu 13.04 unity x86_64 bits2. i have get the packages from distribution Ubuntu 13.043. open 03marzo 13.odsit is not possible disable filterwhen i try to filter LO calc block. It is necessaire to close the windowsLe 02/04/2013 18:14,a écrit :>>>>>>>>Createdattachment-24296-1.datCreated03 marzo 13.odsHmm, I am still not able to reproduce the freeze with your document and the official TDF build. It might be related to the system libraries used by the Ubuntu build => adding Ubuntu maintainer into CC.Anyway, the autofilter in the document behaves strange way: + If I sort the column "A" descending, it moves the title line to the row "79". I would expect that the title line stays in the row "1". This problems go away when I remove the filter and create it again only for the columns "A-L". By other words, only for the columns that have some string in the title cell. + Also I had troubles to remove the filter. I had to choose both menu entries: "Data/Filer/Remove Filter" and "Data/Filter/Hide Autofilter". I am not sure how is this supposed to work. Maybe there were more filters defined at the same time.I add some Calc hackers who could comment on this.The freeze is not reproducible with the official build. The strange behavior is visible also with older releases and can be solved => this bug should not block the official 4.0 bugfix releases with other useful fixes => lowering the severity a bit.Created03 marzo 13.ods where I removed the filters.I attach the document where I removed the filters. It might help you to continue the work.Alternatively, you could try the official packages from.BTW: Is this a new problem with L0-4.0.2.1? Were you able to edit the same document with older LO Ubuntu builds without problems?i can edit the same document with older Ubuntu 12.04 LO 3.5.7.2Version ID : 350m1(Build:2) without problems2013/4/3 <>>>>>>>>>Dear Bug Submitter,This bug has been in NEEDINFO status with no change for at least 6 months. Please provide the requested information as soon as possible and mark the bug as UNCONFIRMED. Due to regular bug tracker maintenance, if the bug is still in NEEDINFO status with no change in 30 days the QA team will close the bug as INVALID due to lack of needed information.For more information about our NEEDINFO policy please read the wiki located here:If you have already provided the requested information, please mark the bug as UNCONFIRMED so that the QA team knows that the bug is ready to be confirmed.Thank you for helping us make LibreOffice even better for everyone!Warm Regards,QA TeamThe filter applied wasn't an AutoFilter but a Standard filter with filter buttons displayed and explicitly defined to have no column headers, hence those entries were treated as normal data and sorted.Closing this bug as apparently nobody could reproduce the originally reported problem with hang/freeze.
id=64002	Recovery window will not function after crash. It appears and freezes the program. The two buttons on the window do not function, can't recover nor refuse the recovery. Recovery window remains on top and there is no way to close or delete it rendering the whole program non functioning.I have deleted the whole LibreOffice from my computer and reinstalled still the recovery window will appear. I have rebooted the computer and then reinstalled LibreOffice, still the recovery window appears. I am no longer able to use LibreOffice at all.Is there any way to delete the Recovery window? HELP!Ed Mack Thanks for reporting!Does an user profile reset resolve this issue? (guide:)Kind regards,Joren*** This bug has been marked as a duplicate of***
id=65582	Problem description: There is no way to create a list in a cell. If you already have one that exists, it works properly. If you want to modify / create a new one, it will not work. Steps to reproduce:1. ....Menu/Data/Validity/Criteria/Allow (List)2. ....Do anything except hit cancel. You can literally do nothing except hit enter and it will take away an existing list.3. ....Current behavior:No list will be created. Any existing list will be deleted.Expected behavior: Create or modify lists. Operating System: FedoraVersion: 4.1.0.0.beta2 ReproducibleWin7x64UltimateVersion: 4.1.0.0.beta2 Build ID: 33224f4f11a05cfad2249e812fcc2975fbb61f6Works with a cell range but now with a list.*** This bug has been marked as a duplicate of***Hi GerardF,it is not easy to understand why an older bug is a duplicate of a newer.If there is a reason to do so, maybe a little explanation for the reporter it is not a bad idea.Soory. I did not paid attention that this one was older. :(Otherwise, it may be better to leave things as they are.The other bug is MAB 4.1 (4.1 most annoying bugs). So we have more chances that a dev have a look.Thanks Gerard.
id=66513	CreatedThe xls file generate by my software Paradox (zip)I generate a xls file with a software call "Paradox", it open with ms office without any problem, but in LibreOffice it looks with chinese characters, the file is confidential, but I attach here, thanks for the answer. ***has been marked as a duplicate of this bug. ***On pc Debian x86-64 with master sources updated today, I reproduced the problem.Here are some console logs:warn:oox.storage:16268:1:oox/source/helper/zipstorage.cxx:70: ZipStorage::ZipStorage exception opening input storage: warn:oox.storage:16268:1:oox/source/helper/zipstorage.cxx:70: ZipStorage::ZipStorage exception opening input storage: warn:oox.storage:16268:1:oox/source/helper/zipstorage.cxx:70: ZipStorage::ZipStorage exception opening input storage: warn:oox.storage:16268:1:oox/source/helper/zipstorage.cxx:70: ZipStorage::ZipStorage exception opening input storage: warn:oox.storage:16268:1:oox/source/helper/zipstorage.cxx:70: ZipStorage::ZipStorage exception opening input storage: warn:oox.storage:16268:1:oox/source/helper/zipstorage.cxx:70: ZipStorage::ZipStorage exception opening input storage: warn:oox.storage:16268:1:oox/source/helper/zipstorage.cxx:70: ZipStorage::ZipStorage exception opening input storage: warn:oox.storage:16268:1:oox/source/helper/zipstorage.cxx:70: ZipStorage::ZipStorage exception opening input storage: warn:oox.storage:16268:1:oox/source/helper/zipstorage.cxx:70: ZipStorage::ZipStorage exception opening input storage: warn:oox.storage:16268:1:oox/source/helper/zipstorage.cxx:70: ZipStorage::ZipStorage exception opening input storage: warn:oox.storage:16268:1:oox/source/helper/zipstorage.cxx:70: ZipStorage::ZipStorage exception opening input storage: warn:oox.storage:16268:1:oox/source/helper/zipstorage.cxx:70: ZipStorage::ZipStorage exception opening input storage: warn:oox.storage:16268:1:oox/source/helper/zipstorage.cxx:70: ZipStorage::ZipStorage exception opening input storage: warn:oox.storage:16268:1:oox/source/helper/zipstorage.cxx:70: ZipStorage::ZipStorage exception opening input storage: warn:oox.storage:16268:1:oox/source/helper/zipstorage.cxx:70: ZipStorage::ZipStorage exception opening input storage: warn:legacy.osl:16268:1:sc/source/ui/docshell/impex.cxx:624: lcl_appendLineData: data overflowwarn:vcl:16268:1:vcl/generic/fontmanager/fontconfig.cxx:892: In glyph fallback throwing away the language property of fr because the detected script for '0xb01' is Oriya and that language doesn't make sense. Autodetecting instead.I am able to open the file with LO 3.4. It fails with all newer versions.It seems that there is some problem with the type detection because some version tries to open the file as using the CSV filter and some as a normal ASCII text.I do not see the warnings on the console log. I wonder if they are produced by a debug build or so.They mean some problems with uncompressing and might be related to the wrong type detection.We need to fix the bug because it blocks the user. On the other hand, it is pretty old and nobody reported it yet, so it must be a kind of corner case. The "Paradox" software probably generates a bit non-standard documents => it should not block the next bugfix release with many other fixes and improvements => lowering the severity a bitI can't even open the file in Excel 2010, idles for a while with "opening MS-Office" and when cancelling that says "The file is corrupt and cannot be opened."
id=61056	In calc spreadsheet I choose to reprint the first row on all pages.In preview mode I can see all is Ok - the titel/row appears on every page.After saving the spreadsheet in ODS formatwith LibreOffice 4 and open again the ODS file the information is lost.With LibreOffice 3.5 it was Ok Hi Peter, thanks for reporting.I can reproduce with:Win7x64UltimateVersion 4.0.0.3 (Build ID: 7545bee9c2a0782548772a21bc84a9dcc583b89)Setting only the first row $1 to repeat, it is lost with reload.Setting several rows $1:$4, the first row is lost with reload.If the row 1 is in the rows to repeat range, is always lost after reload, the rest or range remains.It is regression in a basic feature of the spreadsheets, from Version 3.6.5.2 (Build ID: 5b93205)Createdtitel row not there on following pages*** This bug has been marked as a duplicate of***
id=66232	LO 4.1.0.1 on Win7x64; IE10When clicking on a hyperlink to a .odt file and selecting Open, the file isn't opened.If LO isn't open yet, the task manager shows that soffice.bin and soffice.exe processes are started, and soffice.exe displays activity and consumption of memory, until it reaches ~25 MB memory consumption. Then it seems to hang: no memory usage change, no CPU use. No UI is displayed. However, if in this state I try to open another document from a local drive, it is opened normally. If LO is already started, it simply doesn't open the document from a web page.In both cases, after such attempt to load a document by clicking a hyperlink, LO cannot be closed (neither by clicking the cross at top right, nor by File->Exit LO). Kill process is needed.As a testcase, I tried some documents from Bugzilla, e.g.from.IIRC, neither 4.0.4 nor 3.6.x had this problem. Correction:LO 3.6.3.2 cannot open the links when it is not opened in advance, but it doesn't "hang"; instead, it displays the message box saying the following:"LibreOffice 3.6Unknown option: -EmbeddingUsage: soffice [options] [documents...]Options:<... a long list of command line options ...>"Clicking the OK button closes LO.If it is already started, it opens such files normally, and no problems to close LO after that.The behaviour of 3.6.3 differs from what happens in 4.1; besides, it seem to be fixed in. That's why I beleive that this is a distinct bug, and don't set version to an older version.This only happens if the MIME type of the downloaded file is set correctly (e.g., application/vnd.oasis.opendocument.text), and no download managers are used.IE shows two dialogs before trying to open the file: first is to choose what to do: Open, Save or Save As. Second (after choosing Open) is security warning saying that "A website wants to open web content using this program on your computer" and soffice.exe doesn't have a valid signature.When the opening fails, three events are generated by this bug in the Application Log: Application Error 1000 (faulty application soffice.bin 4.1.0.0, faulty module emserlo.dll 4.1.0.1, exception 0xc0000005), and two Windows Error Reporting events 1001.Windows 8LibreOffice - 4.1 RC1LibreOffice - 4.0.4.2I can confirm the behavior on 4.1 but not on 4.0 so indeed a regressionNew - confirmedCritical - opening a document directly from web browser is common task - with IE still being the default of Windows (who knows why...) we should expect 4.1 to open the file just like it did in 4.0. Furthermore, the lock of the software makes it a bit more serious.Highest - very common thing to want to doAndras, Christian - any ideas ? some signing problem on Windows ?I tried LO 4.1.0.2 in Windows 8 (IE10) and LO 4.1.0.1 on Windows 7 (IE10). I reproduced the bug on Windows 8 but not on Windows 7, which is confusing, because the reported had the bug under Windows 7.However, I did not see anything in Event Viewer's Application log. Also, I did not see any problem with signatures.I compared the Process Monitor output of LO 4.0.4 and LO 4.1.0.2 and I see no difference, the .odt file was opened on both case. I suspect that the bug is somewhere in desktop/source/app, IE10 starts LO in headless state or something like that.CreatedDialogs screenshotsJust some clarification:there's no problem with signature (I suppose). I may have made slightly misleading descriptions above. Let's try to be more clear this time :)When I open example link fromfrom MS IE browser, it will naturally emit these dialogs:1. To choose the action: Open / Save / Save As.2. To confirm the action of the LibreOffice program installed on the computer to interact with the web page (thus breaking the IE protected mode).They are usual dialogs, that don't have anything strange.I only wanted to show the exact steps required to reproduce the dug. Because if you have, say, a download manager that intercepts the download and calls LO itself, then you will not see these dialogs, and will be unable to reproduce the bug. Similarly, if you try to download a file that have not MIME properly set, then IE will simply download the file and then start its associated program, instead of doing this "interaction of program and WEB page" thing, in which case you will not see these dialogs, and will be unable to reproduce the bug.Hope this helps. Please ask if you need some additional info.OK, I reproduced the bug with Windows7/IE10, too.I compared the command lines of LibreOffice's invocations.Windows XP - IE8 (good):-o C:\Documents and Settings\Administrator\Local Settings\Temporary Internet Files\Content.IE5\LYH5XXZ4\bug[1].odt --writer Windows 7 - Firefox (good):C:\Users\timar\AppData\Local\Temp\bug-2.odtWindows 7/8 - IE10 (bad):--nodefault --nologo -EmbeddingThe filename is not passed vie the command line, yet I see it in the Process Monitor, so it is passed by other means.The --nologo --nodefault switches come from the registry, for example for .odt from HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{F616B81F-7BB8-4F22-B8A5-47428D59F8AD}\LocalServer32This explains, why opening works even from IE10, when LibreOffice is not installed (just extracted to disk with msiexec /a, a.k.a. administrative install), because in this case nothing is written to registry.The real question is, why did LibreOffice's behaviour change between 4.0 and 4.1. 4.0 works with the same registry settings.Fridrich - you were looking for Windows specific regressions to look into ? :-) this looks like a nice one ...(In reply to)Adding Repro tags to the Whiteboard per Joel's repro notes.I could not reproduce the bug, when I took embedserv sources from 4.0 and build 4.1 with it.I bisected it, and it turned out that Noel Grandin's commit broke it.(In reply to)I assume thatis wrong there and the last line should readinstead.Thanks, it works with this fix, indeed.Andras Timar committed a patch related to this issue.It has been pushed to "master":fdo#66232 fix opening files via COM serverThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Andras Timar committed a patch related to this issue.It has been pushed to "libreoffice-4-1":fdo#66232 fix opening files via COM serverIt will be available in LibreOffice 4.1.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Unfortunately, the fix doesn't work with 4.2.2.1 and IE11 under Win7x64. Also,indicates that the problem remains in 4.1.5 (while it should have been fixed for 4.1.4).***has been marked as a duplicate of this bug. ***(In reply to)I meant(In reply to)Tested under Win7x64 using Internet Explorer 11 and Opera 12.16I use LibO 4.2.3.3 portable version from WinPenPack which is set as default .odt opening application in my PC.If I click on thathyperlink both browser show me an "open/save" dialog and if I select "open" LibO is correctly launched and loads that file.so it seems to me that it's fixed. what about you Mike? does a regular LibO 4.2.3.3 installation still has the bug or has it been finally fixed?(In reply to)That's the point. As it was noted in, the problem doesn't manifest itself in "administrative"/"portable" installations.I do confirm that the problem is still REPRODUCIBLE with IE11 and LO 4.2.3.3 under Win7x64. Specifically: in NORMAL installation of LO, if I click the abovementioned link in IE, the dialog shows up prompting if I want to open or save the file; then if I chose "Open", it shows another dialog asking that I confirm the action by LibreOffice, and after I confirm, nothing is shown. Task manager shows that LO is started, but UI isn't displayed.thanks Mike for feedback. I move this to mab4.2 list.please Mike, tell if issue is still present with 4.3.x or 4.4.xif yes, this bug has to be moved to mab4.2 list since 4.2.x is END OF LIFEUnfortunately yes, 4.3.4.1 still has it.Cannot say anything about 4.4 - have not yet installed it to handle MIME associations in IE.Confirmed bug on version 4.3.6.2 under W7+IE11.Process launch was analized via wmic:root\cli>process get Name,Caption,CommandLine,ProcessId,ParentProcessIdand action between Firefox and IE was compared.Clicking on a link in Firefox starts LibreOffice as follows:FIREFOXscalc.exe "C:\Program Files (x86)\LibreOffice 4\program\scalc.exe" -o "C:\Users\DMANIA~1\AppData\Local\Temp\HBED14_OpereEdili_20141103-2.ods"soffice.exe "C:\Program Files (x86)\LibreOffice 4\program\scalc.exe" -o "C:\Users\DMANIA~1\AppData\Local\Temp\HBED14_OpereEdili_20141103-2.ods" --calcsoffice.bin "C:\Program Files (x86)\LibreOffice 4\program\scalc.exe" "-o" "C:\Users\DMANIA~1\AppData\Local\Temp\HBED14_OpereEdili_20141103-2.ods" "--calc" "-env:OOO_CWD=2C:\\Users\\DMANIA~1\\AppData\\Local\\Temp"We have evidence that Firefox downloads the file and than calls LO for opening.Clicking on a link in IE starts LO as follows, but with UI no-interface, LO must be stopped via taskmanager:IEXPLORERsoffice.exe "C:\Program Files (x86)\LibreOffice 4\program\soffice.exe" --nodefault --nologo -Embeddingsoffice.bin "C:\Program Files (x86)\LibreOffice 4\program\soffice.exe" "--nodefault" "--nologo" "-Embedding" "-env:OOO_CWD=2C:\\WINDOWS\\system32"Tha ActiveX component which should take care of this part ""is apparently not working anymore.Removing the --nodefault option from registry for LO launching (example: HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{30A2652A-DDF7-45e7-ACA6-3EAB26FC8A4E}\LocalServer32) modify behaviour as follows:Clicking on a link in IE starts LO with general UI interface which react but cannot be closed, just via taskmanager.NOTE!!!In(now closed) same problem is reported for OpenOffice.Operating System: Windows 7OO Version: 4.1.5.3 releaseQuestion: is ActiveX component common to OO and LO?(In reply to DiegoM from)I'm afraid that OP ofsimply used wrong name for LO. AOO have no version 4.1.5.3.I'll try to look into this soonish.Confirmed bug on LibreOffice version 4.3.7.2 under W7+IE11, with or without (*) ActiveX component installed..Backgrading LO to 4.0.6.2 solve the issue, with or without (*) ActiveX component installed.(*) be unshure if deinstallation really removes this ActiveX.Submitted patch to gerrit -Mike Kaganski committed a patch related to this issue.It has been pushed to "master":tdf#66232: Cannot open files by COM2It will be available in 5.0.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Bug is confirmed for LO v.4.4.3.2-RC2 (RC for actual fresh LO).I checked the fix from Mike Kaganski, and it worked. Well done, thanks. Backport to 4-4 proposed:Bug for me is SOLVED with Daily version master~2015-05-04_03.49.24_LibreOfficeDev_5.0.0.0.alpha1_Win_x86.Test bed as follows:- Win7 64 bit- IExplorer 11- ActiveX LO component installation was CheckedWeb page used for test contains 1 link to .ODT and 3 links to .ODS:Clicking on the links opens the files from IE Browser as expected.NOTE: File-set association must be manually configured, automatic association does not work with installer this build!Bug in actual Still version is heavy affecting all migration projects to LO.Please consider if backport the solution to v. 4.3.(In reply to DiegoM from)TDF does not plan more releases from the 4.3 code line. You can backport the fix yourself, and build yourself, or you can buy professional support.4.4.3 was released today. It is binary-equal to 4.4.3.2_RC2, where the bag is confirmed.I had a look to. Did not understand if backport to 4.4 is confirmed or not.I would like to "press" for have this fix backported to 4.4.4, remarking the importance for the "real world" of LO users.Tanks,diegoIt was too late for 4.4.3. I'm positive that it will be part of 4.4.4.Great! It's allready a 4.4.4 build to test?Mike Kaganski committed a patch related to this issue.It has been pushed to "libreoffice-4-4":tdf#66232: Cannot open files by COM2It will be available in 4.4.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.(In reply to DiegoM from)go here and grab a 4.4.4 daily
id=65675	This is a meta issue to track the most annoying bugs in LibreOffice 4.2.x releases. It helps developers to focus on bugs that are most critical for users. Also it helps users to be aware of potential problems.If anyone wants to raise a bug as “most annoying” for the release, please add the ID of that bug to the field “Depends on”, leave a short description of the bug, and explain in few words why that bug should get privileged, for example: Add bug #XXXXX: Writer ignores page size setting. The default size is Letter. The document format is often broken when printing on A4 paper in Europe.For details, criteria and further instructions, please see In nominate 60245 , add better autocomplete (ie intellisense) for Calc functions.Justin - most annoying bugs are something like blocker bugs; and enhancements likeare not really appropriate unless this is cripplingly debilitating. Also - such bugs belong on the MAB list of the oldest version that they affect; thanks for filing though !Nominating 65924, makes the Writer really ugly. Cannot fix myself in the following few days, so better to track it properly :-)Adding(Base): report design wizard silently does not start on MacOS X.Really add the.Adding– badly looking About window, since this might mean the SVG reader has regressed.Add: Auto Filter Sort Results in CrashAdd: Crash when deleting field added in Report Design modeAdded- can't save new autocorrect entriesa basic Writer functionality is brokenNominate"Open button and File Open stopped working" and"[FILEOPEN] XML filter: Excel-2007 XML file don't open", because these are a regression into the Master release:a)– between 21st (ID:e8c0708ee9d0c01cbe0bdcb38ac14e34bdceef32, TinderBox: Win-x86@6-debug, Branch: master, Time: 2013-08-21_20:26:24) and 23rd (ID:45ef1eda9e8851d454237d91b7fc46299fd621eb, TinderBox: Win-x86@6-debug, Branch: master, Time: 2013-08-23_07:32:04) August;b)– between 13rd (ID:73c02c20b19702dbe662fe0d80601049f015d8ac, TinderBox: Win-x86@6-debug, Branch: master, Time: 2013-08-13_21:26:14) and 21st (ID:e8c0708ee9d0c01cbe0bdcb38ac14e34bdceef32, TinderBox: Win-x86@6-debug, Branch: master, Time: 2013-08-21_20:26:24) August.@kendy: Adding error 69517 "LibreOfficeDev-4.2.0.0 (Win-x86@39) cannot start under Windows XP" because it is not possible testing program on Windows XP 32\64-bit, which are supported (look at readme.txt file).--ape(In reply to)--Sorry,@kendy:Sorry, that's my confusion. I found the Assembly log file, which specifies to use MSVCR-2012u1. The LibreOfficeDev-4.2.0.0_ Win-x86@39 runs on Windows XP 32\64-bit after installing MSVCR-2012 update3. So is FIXED.--apeAdding 70664 - can not display images inserted into Firebird embedded dbI nominatebecause we can't ask users to have users / testers to live with broken packages on their install.Hereby I nominate- Can't scroll down in Calc and Writer on Mac osxA blocker for Mac OSX users.adding- StartCenter: it is not possible to easily navigate through recent used files with the keyboardadded because the API does not use a PNG image that is embedded in the ODF file in addition to SVG drawing.added 70989 only because it's a new feature - not terribly annoying but the new statistics function doesn't correctly show the cell range selected in "output" range, instead it only shows the first cell of the selection. For a new feature we probably should have it working right out the gate :-DI add- FILEOPEN: FORMATTING: formatting error in a file with two tablesInterestingly this old 4.0.x bug seems fixed in 4.1.3.2 but still affects the 4.2.x branch (including 4.2.0.0.alpha1+ Time: 2013-11-15_23:44:51)Adding fdo#71694 can't create Index and tables in pre 4.1.4.added- LO 4.2: Wizards "Document Converter" and "Euro Converter" not working.Added"impossible to set printing page size manually". The actual paper size, which is set in the printer properties, is ignored. It is broken since version 4.1.2. The problem has produced several bug reports. Besides the here added 67576 it seems, that the following bugs are duplicate or at least related:"PRINTING: Paper Size and Orientation Fail in Brochure and Multi-Up Printing""Print dialog preview in Draw does not update with paper size change""Other: Page size when printing""PRINTING: Printing envelopes does not respect user inputted sizes""PRINTING: Difficulties with combining smaller pages on a bigger one"Nominating: Background color for legend area hides the legend This regression may suggest that some data are lost, so a bad user experience.Adding: Animated GIFs are not displayed correctly in Impress, while they are displayed correctly in Writer.This is a regression.Nominating: this regression make impossible to access the integrated / local help.RegressionEDITING: Small capitals are showed like capitals in editor from 4.1...adding"When you update the Index the words A) 1) and I) dissapear in LoDEV, in 4.1 works perfectly"adding[TEMPLATE MANGER] / [UI] selecting available templates not possible below the second row in the listAdding regression, matrix case insensitive string comparisons don't work anymore.Add: Text disappear when editing a 90deg Textbox.This feature worked without problems in LO 4.0.x. So it may prevent users to update to the most actual version.Add: There is a broken Debian menu integration because of wrong file permissionsI add- Certain graphics lost in PDF export if lossless compression used. Regression from the 4.1.x branch, affects Windows and Linux.Adding: The custom dictionary is not initialized at startupNominating- Other: Page Number begins at 0.Just compare the different page numbering in the recently published "LibreOffice 4.1 Draw Guide", DG41-DrawGuideLO.odt[1] – at first with LO v4.1.3.2 (correct), and then with LO-Dev v4.2.0.0.beta2 (messed up).[1](Full book 4.1.x branch)RegressionEDITING: Wrong font rendering of SVG graphics in the editor (PDF export is fine) from 4.1Addingregression in UAA <-> Windows Java Accessibility API JAB bridge as potential Windows build release blocker--Accessibility regressionAdding Startup is slow due to the new startcenter, not confirmed but really importantadd- Clear direct formatting over more paragraphs freezes LibreOfficeAdding- switching default locale leads to weird number format codes behavior.Nominated- appears like we have a new chart feature coming through (circles of some kind) but it's quite broken. Doesn't work at all in 4.1, in 4.2 and 4.2 it's just broken and shows incorrect charts + missing datanominated- chart legends aren't showing up on a file that they show up in 4.1, confirmed regression, very popular feature. This might even be a blocker to be honest but I left it as a criticalI nominatebecause it is a severe performance regression in sorting.Best regards. JBFAdd: Formula (Math) inserted in Writer have wrong subscript positionIt makes almost Math formula unusable in WriterAdding:- Writer's UI crashes when scrolling pages if formatting marks are visible;- LibO-4.2 is crashed when you open ODFver.1.0\1.1 created by LibO-3.5\6Nominate: "- LOOKUP function results in #N/A"adding- FORMATTING: The Entry # dissapears from the Entry in the TOC when adding text separatorsAdding correctly #72632 Formula (Math) inserted in Writer have wrong subscript positionIt makes almost Math formula unusable in WriterAddQuick functions in status bar in Calc are wrong if multiple selectionadding- FILEOPEN: Draw 4.2 corrupts figures combined in previous versionadding- FILEOPEN Interaction on image (jump to slide #) lost on openingadding- UI: when vertical scrolling a sheet with the scrollbar the screen is not refreshed from the first row that was not displayedmakes scrolling ungly and very user unfriendlyNominating please 50855 (similar to 71783) which regressed somewhere between 4.1.4 and 4.2-beta2. We have thousands of documents that are broken because Nimbus Sans font does not render correctly. There is no reasonable work around and we literally will not be able to upgrade over this issue.I nominatewhich make PresenterConsole unusable (Regression).Temporary removing dev-list for bulk change.Readding developer list after bulk change.Nominating- PNG files in Writer badly distorted regression over 4.1.3.2I nominate, the sidebar meta-bug. Since sidebar is on by default in 4.2, all the issues with it gain a lot more visibility, and we can't hide behind the excuse of it being experimental anymore.A few bugs listed there are relatively innocent, while others can distort formatting (like) or cause crashes (, if it gets confirmed), meaning it gets really annoying pretty soon.makes the Calc Function Wizard quite useless.addedPRINTING: Long text flowing outside a Cell not printedHereby I nominate '- Editing: Cell formula not updating on redo, even with a forced recalculation'AddIt was solved in 4.2.0 RC2 but reappeared in 4.2.0 RC3Sum button in Calc gives #REFI nominatewhich make dates filtering unusable in Calc 4.2.Best regards. JBFNominating 74077, trivial to reproduce data corruption, regression against 4.1 using default file format.add- Calc crashes when inserting a columnAddFormula link to other sheet not updated in some caseVery difficult to detect such behavior for user.Bug bibisectedAddedWorking with videos in presentation is essential functionality and has been broken for a long time on OSX.#65070 please add this bug - page background graphic is not displayed#66581 - please add this bug - embedded objects are not imported from XLSX#73994 - please add this bug - ODS are about 12 times bigger than imported XLSXMakes LibreOffice Writer unusable for scientific writing. References inside frames, for example figure captions, are broken.Nominating- all spaces lost during font conversation.#73860 and #50855 seem possibly related : spacing between characters during font render. Nimbus Sans and Helvetica are similar fonts.please add #65074_____________________________________________________________________________bug is not entirely fixed in LibreOffice 4.2_____________________________________________________________________________XLSX cells with 2 conditional formatting rules are not displayed correctly:1. p.ex. cell values =$H$13:$H$427 have a color scale 2. cell values equal or smaller than =MIN(H$13:H$428)*1,1 should be bold (Arial unicode, size 10)In LibreOffice 4.2 the second rule is bold but wrong font and not changeableSpreadsheet can be downloaded here:_____________________________________________________________________________Behavior before LibreOffice 4.2:_____________________________________________________________________________cells with with conditional formatting sometimes show the numbers not centered and without points; cell borders are not shown (see for example I13 to I21..)Steps to reproduce:Spreadsheet can be downloaded here:screenshot from Excel:screenshot from LibreOffice:Current behavior:cells with with conditional formatting sometimes show the numbers not centered and without points; cell borders are not shownExpected behavior:All cells in the main table must contain centered numbers with thousand points. Operating System: Windows 8Version: 4.0.3.3 releaseI nominateClicking the "Apply" button should NOT close the hyperlink dialog.added- 'customize toolbar' brokenbasic UI feature not working at all in 4.2.0.4 and causing crash in 4.3.0.o.alpha+Nominated- spreadsheet is losing comments upon save - regressionadded- The program’s Frost if the option ‘Expert Configuration’ is used (Windows only).Added,,- Content piece of the table’s large cell is lost (FILEOPEN; DOC, DOCX, RTF filter).Added. It hits pretty much every CJK user out there.add- Templatemanagement Dialog To Change/Edit Existing Template will crash LibreOfficeAdd, Calc crashes when undo inserted commentsHi, adding(Paste Special skip empty cells broken)I nominate: Textfield or Picture inside a chart is hiddenThat is a regressionNominating 74553: regression vs. 4.1.4, datalossNominating: Formula expressions are altered => data loss.Nominating: Formula expressions are lost => data loss.AddLibO freeze with Label WizardNominating, SUMPRODUCT function treat empty cells as 1 when there are calculations or comparisons or functions as last parameter, and ranges with empty cells in others ranges.added, crash while inserting cellsAddupdate Catalan dictionaries and related resources; ca-ES and ca-ES-valencia localesAdd, extracting a sheet to copy or move it lose some contents. Sophienominating 74979: seems to corrupt ~all sxc files on either load or safe, regression, 2 downstream dupes, one fdo dupe.(In reply to)sxc export has been removed on master, it's an ancient format superceded by .ods. Is this really worth a MAB? I think not.I nominate- Other: crash when undo 'delete row above' with comments in rows belowI'm nominating: Opening HTML files that have <!DOCTYPE ...>s that are not on the first line of the file cause LibreOffice to show the HTML source code. To get the HTML contents to be displayed (instead of the source), I have to open the HTML file in a text editor and make sure <!DOCTYPE ...> is on the first line. The average user, though, doesn't know how to work with HTML code, and won't know how to get the file to work. So, I am nominating this for the LibreOffice 4.2 most annoying bugs list. I'm not the only one that experienced this issue ().Adding, interoperability problem with many duplicatesI would endorse an enhancement regarding this bug. Although not severe, it has been coming up as an issue since Version 3.5.5.3. I suggest either:a) enable custom dictionary as a Writing Aid during initial installation. The manual equivalent is: Go to Tools>Options>Language Settings>Writing Aids>User-defined dictionaries and enable User defined dictionary "standard [ALL]")AND/ORb) if the above dictionary isn't enabled, but a user opts to add a word to the custom dictionary during spell-checking/correcting procedures, then the user is prompted to give the application permission to enable this dictionary.(In reply to)AddedRanges in COUNT() function are not well counted if there isn't a range as the last parameter of the function.Problem description: Steps to reproduce:1. ....open a LibO (writer) document. Copy and paste from within that LibO (writer) document to within that LibO document.2. ....Open a web page or non-LibO document and copy web page text or url 3. ....Past that text/url into the still open LibO (writer) documentCurrent behavior: The copied text from step 1 is pasted into the documentExpected behavior: The copied text from the web page/non-LibO document should be pasted into the document.Current work around is to close all LibO documents, which clears the LibO clipboard. Re-open the LibO document and paste before doing any cut/copy from within LibOPreviously reported inwhich does not appear in current known bug list. Also see running issue in OpenOfficeSuccessfully submited now as@Ed Barnatplease do not discuss unrelated bugs here and do not change version field.this is the list for MOST ANNOYING BUGS of the 4.2.x branch.bugs about other branches have no place here.I add- Draw and Impress are slow to start on Windows platformevident performance regression from 4.1.x (8 seconds to load instead of 1)Linux and Mac testers welcome.Addedwrong results for MATCH and VLOOKUP functions, regression from 3.3.4Nominated- when misspelled word is in a cell, right clicking in the cell goes into edit the cell vs. opening the context menu, offering word suggestions, etc . . .Can someone consider adding this bug to MAB 4.2Formula in writer is shrinked instead of keeping same size when changing border space in writer styleThere is no workaround and i's a functionality lossShould notbe added here - critical security issue? I can't see it being followed elsewhere, apologies if I am mistaken.- text cut-off when exporting .odp to .pdf (OSX only) I would like to nominate this annoying bug.I added the‘function does not work Edit> Fill> Series> AutoFill’, because the important ‘AutoFill’ function has stopped working in LibreOffice-4.2.x. This is a regression to LibreOffice-4.1.5.Nominated- 4.2 regression where settings are not being read correctly for error bars in x/y charts. Appears like data loss to users but the data is saved, just not called on correctlyNominated- formulas are changing for links to external sheets which could be a nightmare if working on complex sheets. This is a regression in 4.2Nomintated- changing named ranges is causing crashes and the crashes can be silent (no crash but when you try to save it then crashes). It's fixed in 4.3 but I wanted to put it here so it's backported (hopefully)Add: LibreOffice Writer text highligthing is not compatible with Microsoft Word DOC and DOCX (highlighting transforms to background color)This bug has very long history and it is a great interoperability problem. Please fix it as soon as possible. It breaks normal document exchange with MS Word users and drop negative light on LOO in MSO users eyes.Added, cells references are changed without notice opening a xls file.Please consider: Pivot tables from OOXML documents can not be usedIt is really annoying and has a many duplicates.Sorry, it should be, not.Nominated 46635(In reply to)Promote: Calc, insert/delete rows crashesRegression from 4.2.2.1Add: Calc crash when sorting in specific caseAddedPRODUCT function returns incorrect results in array formulaAdded:FILESAVE: missing <w:spacing w:after="0" w:before="0"/> in new document.docxWithout fixing, it's impossible to interoperate with MSO 2010 (when you send someone a docx file created from LibreOffice, what the others see is totally different in MSO.- frames with borders disabled have borders again on reload of documentAdding, FILESAVE: .xlsx new functions are saved without _xlfn. prefix and lead to #NAME? error when reloadedhello all,i need to ask something. i have submitted a code to libreoffice as aninitial step to participate in gsoc. since then, i am receiving variousemails about other bugs. since i am new to GSOC, i dont know what should bemy next step. can you please tell me about thatOn Wed, Apr 2, 2014 at 8:38 PM, <> wrote:>>>>>>Addregression in 4.2.3 RC2 against 4.2.3 RC1Math formula lost their Area settingsAddCrash in Writer with Stylist in sidebarAdded #76324 ()Calc becomes daaaaaamn sloooooow and even crashes when comments are used intensively.I add- FILESAVE: .odt file written by LO 4.2.x won't open in older LO branches and AOOthis represent important .odt interoperability issue between LibO 4.2.x, other LibO versions and AOO as well.Hereby I nominate "- FILESAVE: Character formatting is not preserved when file is saved, closed, and re-opened."(Even) reproducible with .ods file format, and a regression vs 4.1-versionsadding- Can't launch Fax, Agenda or Letter wizard(regression in 4.2.4.1)adding- EDITING: Instability when pasting calc data that includes a formula into writer (As calc8 object)adding- copy cells from calc and paste in writer makes libreoffice crashAdded- complete loss of conditional formatting if you delete a sheet. Simple steps to reproduce, reproduced on 4.2.2.3 and master built last week. Reporter says works fine in 4.1movingfrom 4.1 MAB to 4.2 since 4.1 development is closed. VBA macro "ActiveDocument" doesn't always apply to the document that the user is working in.Nominatingto the list. It's there since 4.1 or earlier and stays already in the master. The wizzard could not be used to create a fax since it was migrated to Python.Moving(Memory leak when saving a doc text with many svm images) from MAB 4.1 to MAB 4.2 because LO 4.1 is reaching its End-Of-Life.Best regards. JBFMoving(dataloss: "thisComponent.store" corrupts the macro library password) from MAB 4.1 to MAB 4.2 because LO 4.1 is reaching its End-Of-Life.RegardsPierre-Yves(In reply to)Sorry it is 68981Symbols being imported incorrectly from docx files - this was reported in the past and then corrected, now it's broken again.Added- Editing a simple draw object within writer and going to format->layer results in total crash. The bug has been around since the branch point (confirmed on 3.3.0.4) but none the less, nasty enough that I thought it belonged on the list.Thanks!Added 78801 - very recent regression, affects 4.2.4.2 release and 4.3 masterCopy + paste from website to writer results in no image being pasted. bibisectedAdding.Autotexts get an unneccessary linebreak appended when created via "Autotext" > "New (Text only)".See also:(with screenshots)Added- complete loss of comments for docx. Regression.BibisectedAdded- regressionDOCX file opens fine but when you try to save it again as a docx it crashes LibreOffice. It's a pretty complex document (75+ pages) - I will tear it apart if asked to do so but a bibisect is available so maybe that's sufficient. I will ask OP to try to narrow down the document also.added- regression, bibisectedPretty simple document is unable to be opened at all in LibreOffice. Might be a minor release regression (from the bibisect it seemed likely).(In reply to)...except that you actually removed it, too :) Adding it back.May I suggest?Add: sorting broken with references to other sheet. Regression introduce in 4.2.5But 40780 () makes sound useless on Linux, and has gone unfixed for years.Adding- FILESAVE as .xlsx destroys link tolinked contents.It's dataloss, old annoying bug, and is scaring away many advanced users such as me, an accountant.Nominate- "VIEWING: Switching of view layouts causes change of viewing position of document"Application Error dialog appears after closing LibO Writer which has some relationship with the sidebarAdded- regressionIt appears likes some fonts make it so that LibreOffice won't start up. Example font attached to the bug. BibisectedNominateNominate also, which is a similar yet different bug.Regression - worked in 4.1Editing a document which has a large image in itRegression - worked in 4.1: Editing a document which has a large image in itRegression - worked in 3.3.0: embedded fonts not loading correctly when file opened after LibO has already loaded(Can't Move Cursor Between Footnotes with Up/Down Arrow Keys. Need to Click with Mouse) is a very frustrating regression for heavy users of footnotes.Nominate: Option to disable documents thumbnails on the New Start ScreenNominate(UI: FILESAVE with 'Open file read-only' not offered in Draw and Impress).This is a missing feature for Draw and Impress already implemented in Writer and Calc. A user can't share a document with an edit password.Adding this old annoying bug:- UI: Function list category "Last Used" always inserts function from the top and duplicates existing list.Regression - worked in 4.1.6: Attached odt opens with a dialog with only an 'OK' button and when clicked, closes LibORegression - works in 4.1.6: Saving the attached file to docx freezes LibOadding- SVG: Text from SVG no longer displayed in LibreOffice: Autosave repeated loop freezes UI if file isnt saved prior to autosave. I've closed 4 of these bugs in the last 2 weeks.Added- Chart Legend name lost on saving.PromoteCrash on sorting single line. Regression between 4.2.4.2 and 4.2.5.0I nominate: search/find/replace has been broken for many releases when using footnotes in Writer.(In reply to)No. Issue ofdoes not even appear valid with current 4.3.0 or 4.4.0.0alpha+ and the directional search of the reworked find bar and its navigate button.To be aMAB, the issue first needs to be confirmed and reworked with better STR and sample documents.Nominating: undo after moving/dragging cell change formula Regression against 4.1.6.2, dataloss, no workaroundRegression - effects only 4.1 and 4.2: Opening .ods crashes calcis a regression from 4.0 and is really getting to be quite annoying.I suggest this bug: spellchecker works wrong if there are Cyrillic symbols in the path to Libre folder, appeared in 4.2.5.2It makes LiO (especially Writer) unusable for many non-English users as they don't get why their documents are totally underlined as misspelled while others don't have this problem. The problem also migrated to 4.3.X.Xadding- self-contained pivot table, dataloss after after save and reopenadding- FILESAVE: relative file hyperlinks saved as absoluteIs it realised that issue 67712 (bibisected) effectively makes use of form controls and drawing objects impossible in LibreOffice >= 4.1 ?Is setting 'Importance' appropriate to reflect that?Added- regressionDeleting an image from a docx file and then saving as a native odt results in the file reappearing after closing the file and reopening it. Test file and bibisect on bugNominating: regression, affects some usersWorking in 4.1.6.2 and 4.2.4.2, but not working in 4.2.0.0.beta1, 4.2.5.2, 4.3.0.2Added(FILESAVE FILEOPEN Writer does not preserve position of images in its own RTF files) LibreOffice can't handle rtf files with images.Regression - worked in 4.1: All endnote text is gone after a missing formulaAdded- regressionSerious data loss in a simple docx file. Bibisected with clear/easy reproducible steps.Nominating 81336 - IS NULL SQL query no longer executes, returns "STATEMENT TOO COMPLEX" error message - regresionI add- FILEOPEN: Cells are missing importing RTF fileregression between 4.2.3 and 4.2.4 releasesAdding- file corruption when writing to external storage - regression over 4.2.3.3 and 4.1.6.2Added- FORMATTING: Can't Create a Border Around a Chart - it results in a loss of basic Calc functionality and is a broken feature that worked in 4.1Added-A basic spreadsheet with formulas referencing another sheet. Inserting a sheet screws up the formulas.Nominating: image as link not preserved after filesave while auto-save activatedRegression against 4.3.0.0.beta1 and 4.2.4.2Movedto MAB4.2, as MAB4.0 was closed already.David Tardon reopened that bug and assigned to himself :-)Nominating, it results in meta-data (file modification date/time and file size) loss for users on older versions of MacOS X, effectively rendering LO unusable for anyone who needs to track modification dates.Added, charts do not show correctly in XLSX when open with libreoffice. Affects all chart types.I suggest this bugWhen insert symbols (like U+0301, U+0300, U+0340, U+0341), which apply to the previous symbol, insertion process doesn't work properly. Seems like it uses wrong font.It slows down the work so much (as you have to use "workaround"), that often it's easier to work in notepad and then copy\paste certain text into Writer. This is not normal work.I found it in 4.2.3 but maybe the bug is also in earlier versions.Add: cannot paste anything into the new inline input fields, defeating much of their functionalityReOne obvious use for the input field is for serial or identification numbers that must be printed on several different forms or several times in one page, information that is often provided from another electronic source and which is extremely prone to human error if manually retyped instead of copied.The current implementation breaks the ability to paste this kind of information into a template that was designed around the old method.The entire interface is currently designed to make the user think that whatever they need to do to edit an input field should be done by clicking and then inserting the information and not by using a non-obvious keyboard shortcut (Ctrl-F9) or going into the variables menu in a manner that defeats the entire purpose of an "input" field.We're talking about a difference of maybe 1-3 seconds for the old implementation versus 10-20 seconds for each field that requires pasted data. When you're dealing with dozens of these fields in an office full of distractions and urgent interruptions (the kind where you must open up a new document and work on something else, meaning you lose your place in what you were doing before) this adds up to significant loss of productivity.Nominating: Setting default language to "None" doesn't stick, but reverts to "English USA". This is very inconvenient for me (and others I expect) that work in multiple minority languages. I set "None" as the default so I can keep "check spelling as I type" enabled, but it won't pop the "red squiggles" until I define the langauge of the document.: no more slideshow, a serious regression on windows 8.1Added 76389:AutoFilter not hilighted after loading a file with AutoFilter set.Added 77479:AutoFilter lost after sortingAdded. It's export analog mab was fixed, but the import still remains broken.Added. It's export analog mab was fixed, but the import still remains broken.Correction. Added, the import analog of.LO does not save the pdf files in the path of which the file was opend.If we use windows dialogs, LO saves/esports the pdf files somewhere but NOT in the original path from which the file was opened.Same situation when opening a file within a network with the ms file manager.While the saving of the file meanwhile works, the pdf export / save as does not use the same path.Windows 7 pro 32 bit, windows network.Please change it! We are donater of LO an OO since long time, and we are really very very annoyed by this bug!Thanke you for your fast change.LO does not save the pdf files in the path of which the file was opend.If we use windows dialogs, LO saves/esports the pdf files somewhere but NOT in the original path from which the file was opened.Same situation when opening a file within a network with the ms file manager.While the saving of the file meanwhile works, the pdf export / save as does not use the same path.Windows 7 pro 32 bit, windows network.Please change it! We are donater of LO an OO since long time, and we are really very very annoyed by this bug!Thanke you for your fast change.Hi Klaus Langguth,You broke our MAB list!This is a meta bug which tracks the most annoying bugs. Please do not change the fields of this one.To report a bug, you should file a saparate bug report. If the bug you filed should belong to this MAB list, QA members will do it.Thanks!Nominating(graphical elements created in earlier Calc versions don't have their position honoured in later versions). Nominating because in some use cases this causes catastrophic data loss; this is effective data loss with risk of total.Would it be possible not to move unfixed bugs from MAB lists? People like me are trying to find a stable version of LO to install on office computers. But if MAB lists are cleared then there is no way of knowing how stable each version is. If stableness can be measured by the number of MAB bugs that is.Since the MAB4.1 has been cleared so just how stable 4.1 is? 4.2 is supposed to be stable (still?) but just look at the number of MAB Bugs.At least please don't clear this list until 4.2 reaches its EOL."At least please don't clear this list until 4.2 reaches its EOL."What I meant to say is that please don't clear this list until 4.3 becomes stable (or still).(In reply to)Please, don't discuss this on the MAB list. MAB is a tool for QA and developers, if you want your own list, you can build it by yourself using named tag in Bugzilla, see at the very bottom this page. SophieI nominate: regression affecting scientific publications.My lap top has Windows Vista Home Premium installed (English language). Having used Libre Office for about 9 months (a 4.1 version?)for no apparent reason an error message appears "The system cannot find the file specified," when I try to access any file. I have tried upgrading with no improvement and my restore points don't go back far enough. Would be grateful for some help.(In reply to)@JamesNot clear what your issue might be, but this issue is a tracking bug for established major bugs with all facets of the 4.2 release of LibreOffice.Please use the Bug Submission Assistant to formulate and submit your issue, found here:Adding. Cursor positioning in a document where frames are used has been broken for a very long time and is very annoying.(In reply to)would concur with nomination -- adding issue to MABAdding. ODF file isnt being saved with the footer option of having different footers on the first and other pages, resulting in dataloss.Nominate: crash after undo moving any column/row in sheet which contain formula rangeRegression against 4.1.6.2Nominate 79546do I have to add it, or will the nomination committee do that for me?adding- OSX - no video playback in slideshow fullscreen display mode on OSX 10.9Added, with cut&past between different sheets, dependant formulas are modified but without includes the new sheet to the reference.Nominatedsince it represents a major loss of functionality in impress 4.2+, only noticeable when viewing sideshow.Added- data loss for comments with .docxAdding- Code signing broken by OSX 10.9.5This is going to affect an ever increasing number of Mac users upon each new install / upgrade of LibreOfficeAdded- regression + loss of data + bibisectedSavings a relatively straight forward spreadsheet as xls causes loss of data screwing up formulasAdded"Chart not exported to PDF"Added- PRINTING: Images do not print or export to PDFAdded, grid lines are messed up in Calc, regression, affects simple editing work, bibisected.Hi KevinI just removedas the 4.2 branch will not have any bugfix release anymore. I see it is reproducible in the 4.3 branch, so please nominate it as a 4.3 MAB on.Cheers! :)(In reply to chtfn from)not correct, the 4.2.x branch will have a new 4.2.7 update (the last) in a few days. then the official END-OF-LIFE is expected by 19 2014see:I see it is reproducible in the 4.3 branch, so please nominate itplease do not mess things removing/adding MABs without knowing the exact procedures.that bug which is reproducible in 4.2.x has to stay in the mab4.2 list (I'm gonna put it back there) and will moved to the mab4.3 list only after the official EOL of the 4.2.x branchthe mab4.2 to mab4.3 migration will be done by QA people by that time.(In reply to tommy27 from)Hi Tommy. Thank you for checking.I assumed 4.2.7 was out already as (1) I already got a 4.2.7 update on Ubuntu a few days ago and (2) the release plan states that 4.2.7 should have been out by the 26th of October (yesterday).So I am sorry if in fact 4.2.7 is not officially out yet, I just had two good reasons to believe it was.I am aware of the the "exact procedures". I have participated in MAB transfers before. In the wiki, the following is written:"If there are no further releases of a LibreOffice version (or “branch”; e.g., 3.5.x), we close the MAB tracking bug for that version, and move all remaining MAB listed for that version to the MAB tracking bug for the next version – you do not need to do that yourself."I assumed 4.2.7 was out, therefore I knew there was no further release for the 4.2 branch. I then asked Kevin to nominate that bug in 4.3 MAB as this is what should be done according to the wiki (no use of adding a MAB if no extra bugfix version is planned). This not me starting a "migration", even though I think we should get cracking on that before the 4.2 EOL as MABs hanging out here after 4.2.7 will have no visibility at all (and, once again, it is what is recommended on the wiki).Thank you.sorry for sounding rude in the previous post.the 4.2.7 is not officially out yet but besides this I ask everybody here to hold on migrating mab4.2 to the mab4.3 list.It's better to wait a few weekes for the exact 4.2.x EOL to be sure that no critical issue pops out in the meantime and that no extra release will be necessary.(In reply to tommy27 from)No worries. Sure, that actually makes a lot of sense. It should be worded that way on the wiki to make it clear for everybody then, I am sure most QA people agree on that.ThanksLibO 4.2.7 has been finally released today.as said before the END OF LIFE of the 4.2.x branch is set on november 19th.please do not start any mab4.2 to mab4.3 migration until then.anyway feel free to retest the current mab4.2 which are still open [1] against the 4.3.x branch (4.3.3 released today) or against 4.4.x master, and post a new comment in the report page of that specific bug telling your findings (still reproducible, not reproducible, changed, etc. etc.)I'll personally move all residual 4.2mabs into the 4.3mab list after november 19th, so again do not start any migration until then.[1]adding- FILEOPEN: LibO 4.2.x incorrectly changes row height - various issues related/ look the same, - at least one duplicate, - bibisected, - clear example to reproduceAddingand. A feature was back ported to the stable 4.2.7 release. This new, incompatible sort breaks many peoples spreadsheets.(Seeand its many dupes) The necessary fixes were not back ported, so sorting with 4.2.7 or 4.3.2 can result in data loss.I nominate bug:Cross reference handling broken when exporting to doc / docxSame bug still exists in 4.3 ()I suggest to add this- "OpenSymbol font is not retained after an upgrade", that surfaces graduallyNominate- Document crashes when editing tables. Causes data loss for any unsaved data. Bugs 81923 and 79569 may be related.The LibO 4.2.x branch reached today it's end of life (EOL) and will be no longer supported.This meta-bug is going to be closed, so please do not add any new bug here.If you find a bug which qualifies as a most annoying bug (MAB) according to these criterias () and is still reproducible in current LibO 4.3.x branch, please add it to the mab4.3 list ().All the unfixed existing mab4.2 will be now reviewed and if still reproducible, moved to that list as well.For the record here's the full list of the residual 4.2.x MABs at the time I'm writing:: FORMATTING Fit to Frame for text boxes is broken: ODT containing multi-page table with table setting "Keep with next paragraph" is pushed to next page: If you insert an envelope into a document only the envelope is printed (Mac OS X): Target for paste cells from column in Calc into TABLE will be single cell instead of column: cropped pictures in .docx file are mangled and in wrong place: Impress Custom Animation Sound Effect not audible in Slide Show: FILEOPEN: concurrent access to AFP shared files impossible - total lock on file: All hotkeys are language dependent, don't work in non-Latin keyboard layout.: FILESAVE: Cross-references to numbered items (object, graphic, table) turn to plain text on export to .doc or .docx: EDITING: Drag and drop images into Writer opens Draw (OS X >= 10.7): VIEWING: Heading - Footer - Pagebreak lines appear somewhere in the page: Embedded Pictures disappear from Presentation (ODP) [Summary:,. Temporary advise:]: image caching / management is utterly shambolic: FILEOPEN: File not opening (win only): FILESAVE: Writer hangs after saving a big document: FILESAVE: images lost after saving to new file name and immediately exporting to PDF: FILEOPEN LibO 3.3 documents shows Writer OLE object contents shifted right / down in object after edit of object because of page border issue: Writer: Incorrect numbering when cells are merged in the table: EDITING: Attempting paste into find bar with Edit:Paste (or Cmd-V on OS X) pastes into document: EDITING: Replication of frames when record changes (redlining) is on: FILEOPEN: Can't Open .uop file: [Task]: FILEOPEN .ods / .ots spreadsheet from former LibO version or OOo shows graphic elements at wrong position: Embedded HSQLDB calls flush (CHECKPOINT) too often: FILESAVE: DOC files created in LO lose drawings (anchored as character probably - and grouped?) after field update in MS Word 2007: EDITING Report builder: mouse-move control: gap between mouse position: FILESAVE and FILEOPEN: Joined cells in table cause table distortion after save to doc and docx and reopen in LO: FILEOPEN - FILESAVE: very slow opening of .xlsx and freeze when saving: Wrong text rotation in SVG Export (rotated text appears as non-rotated): PIVOTTABLE: export to Excel 2007/2010 breaks functionality: RTL VIEWING: Increasing size of dialogs to right or bottom causes artifacts: FILESAVE as .docx: Date (fixed), Time (fixed) fields become static field name text: FILESAVE: FILEOPEN: save document as docx and reopen result in an freeze/endless loop: FORMATTING: Square root and cdot are not correct displayed under Windows 8: Brackets (..),{..},[..] inverted )..(,}..{,]..[ when switch to RTL text direction with all fonts (Affect : calc, impress, draw).: [Template manager]: Can not copy styles between different files and templates: editing/formatting: pasting formatted font messes up formatting of bullets: UI: FILESAVE with 'Open file read-only' not offered in Draw and Impress: LibO Writer text highligthing not compatible with MS Word DOC and DOCX (highlighting transforms to background color): inconvenient localized symbol code: inserting/deleting rows: data integrity problem when sum of the charts of the opened documents exceeds the Options->Memory->Number of objects: FILEOPEN: cannot open .odt files by clicking on a hyperlink in IE: FILEOPEN: MS .pptx Textbox size imported wrong size: Problems changing focus to inside frame: FILEOPEN SMB File claimed to be "Locked By Unknown User" when opened via double-click in Explorer if LO Explorer Shell Extensions are installed: form controls and draw objects anchored to cell but changes position after reopening: FILESAVE: part of the comment text is lost in .docx using "save" toolbar button or "save" menu item: SIDEBAR: Wrong Paragraph spacing values after activating the Properties pane: FORMATTING: Toggling off bold/italic does not turn it off, but instead applies no-bold/no-italic. This messes up any style afterwards that has bold/italic in it (until Clear Direct Formatting is used).: FILEOPEN: PPTX import with shapes causes text to disappear: Chart not exported to PDF: [EDITING] Selecting with mouse: too fast changing to next/previous page: UI mouse pointer disappears during presentation and does not come back after exiting presentation: Excessive duplicate accessible focused events for Calc input line [a11y]: text not rendered fully (cut off) when editing 90deg rotated rectangle: EDITING: undo leads to duplication for operations that involve of drag-and-drop (Slide pane, text areas): EDITING: Unable to edit .odb file with non-local URL: Fax-Wizard - Personal Data are only partial adopted: Different font substitutes used for view in Writer vs. export for PDF: FILEOPEN writer doesn't show the chart numbers nor parts of this docx file: EDITING: Layout Loop when writing into a section with 3 columns: EDITING: Calc crash copying text in Input Bar from 4.2.0.3 and pasting to 4.1, also pasting from 4.2.5.dev to 4.3.0.0.alpha1+: Pictures in Writer look ugly on the screen: 'Install' button in update dialog is never activated: Can't Move Cursor Between Footnotes with Up/Down Arrow Keys. Need to Click with Mouse: FILEOPEN: Impress pictures not displayed in slideshow: OS X integration: selecting a file in Open File dialog adds resource fork, changes size and mod date: FILESAVE: Comments lost on export to .docx: OpenSymbol font is not retained after an upgrade: CALC becomes very slow with 5000+ comments: Calc: Used AutoFilter not highlighted when set in Calc and saved as XLS: FILESAVE: After deleting an image in a loaded file, it reappears in saved odf.: MAILMERGE: Wrong record Number in Mailing: Calc: State of AutoFilter lost after sorting: FILEOPEN: LibO 4.2.x incorrectly changes row height: RTF File Imported Incorrectly - Pages Being Merged (Overlapping): self-contained pivot table, dataloss after after save and reopen: Grid lines messed up when editing certain spreadsheet file: PRINTING: Images move when printing/creating PDF: OSX - no video playback in slideshow fullscreen display mode on OSX 10.9: CRASH after undoing multi-line cell merge: docx export of ducks beaks MS Import ...: XLSX IMPORT: Data plots in chart not visible when cells have formula, needs Ctrl+Shift+F9 (Steps in): FILESAVE - writing to external storage corrupts ODF file: EDITING: Document corruption and crash when editing tables: FILEOPEN: formula error reading an xls fileHi all,The MAB docs on the wiki have been updated to reflect the newPriority-based system for categorizing bugs:The old MAB tracker bugs (mab4.3, mab4.4, etc.) will remain inBugzilla for historical reference, but should be ignored for currentwork. ......................FINAL mab4.2 STATS......................fixed bugs -> 186open bugs -> 0......................
id=61095	CreatedExample of the bugCalc closes when I put the simbol = for an equation in libreoffice 4.0.0. I am using Ubuntu 12.04 , You marked the bug as 4.0.0.0.alpha1, is this the version you are using? If so please upgrade to the stable release 4.0.0.3 release. Marking as NEEDINFO. If you're still seeing this issue with 4.0.0.3 release please do the following:If you're still seeing the issue mark the status as UNCONFIRMED and let us know your results. Thanks!CreatedWhen calc restarts show me this window after the bugLibreOffice_4.0.0.3_Linux_x86_deb, this is the versión i installed in Spanish, i did what you tell me, i changed the name of the user folder, to "user-old", and i still having the bug.Any extensions installed?(In reply to)No, it's clean of any extensions.CreatedCalc Bug VideoHi, here it's a short video about the Calc bug that i'm having, i hope this can help to fix it. thanksSeems like a duplicate of?(In reply to)Yes it's the same problem, but my problem it's in ubuntu 12.04, it's not possible for me to make a custom installation of libreoffice in ubuntu 12.04, because i do it from the terminal. Any suggestions?*** This bug has been marked as a duplicate of***Why was this reopened as UNCONFIRMED? We have acknowledged that this is a duplicate. Marking as dupe again.*** This bug has been marked as a duplicate of***@ Reporter - please don't reopen the bug. Leave a comment if you'd like and QA can reopen as it's own issue if we find it necessary but as of now, we are on the same page that this is a duplicate of
id=61113	CreatedThe steps to reproduce this problem.Problem description: First page (Writer) do not apply margin settings.Steps to reproduce:1. Using Writer, Creat a new blank odt file, click the menu Format > Page.2. Select Page layout to "Mirrored", setting Inner margin to "4.0", and clicking "Apply" or "OK".3. You will see nothing happens in the first page.Current behavior:First page in Writer do not apply margin settings.Expected behavior:After clicking "Apply" or "OK", the first page should apply the new margin settings.Operating System: DebianVersion: 4.0.0.3 release See in special*** This bug has been marked as a duplicate of***
id=66924	I load the attached slide deck, switch to master page view; select slide 2 in the left-hand slide sorter and try to delete the creative-commons picture.As soon as I try to select in the items on that page, I switch (as if by magic) to slide 1 - and the images disappear; that looks pretty odd to me. Createdsample slides.I see it the build from 4-1-0 branch as well.Thorsten, Muthu, could you please have a look, ASAP?I am not sure whether we should block the 4.1.0 release because of this. It is impossible to edit master slide because it does not stay in the master page view. On the other hand, it probably does not cause any data loss.In fact it seems that it very difficult to leave to master mode: if you close the master view and choose to edit another slide, you go back in the master view.You need to close the master view at least two times before being able to edit the slide.I get the same behavior with and without the sidebar.Version tested : Version: 4.1.1.0.0+ (Build ID: 48bcea3710f14091e2e4fd078a31f278bce0c19)Best regards. JBFI did some more testing and here is my observation: + I am able to edit the first master slide in any presentation + I am NOT able to edit the other master slides if I choose them using the left hand slide sorter. If I click anywhere in the other master slide it jumps back to the previously edited slide; it means: + it jumps back to the first master slide if you did some editing before + it even leaves the "master view" and jumps back to the "normal view" if you did not not do anything else before (did not edit 1st master slide; did not edit other slides in the normal view A workaround seems to be to click on the first master slide in the central edit window and navigate to the other master slide using the [Pgdn] button. Then I am able to edit them. + I have troubles to leave the "master view". If I edit a master slide, leave the "master view" and try to edit the real slide, it jumps back to the "master view". A workaround is to close the "mast view" once again; then it stays in the normal view. + IMPORTANT: I see these problems only with more master slides. I do not see them in presentations with only single master slideThis bug is nasty but it affects only power users who could use the workarounds or wait for a bugfix release. We need to fix this for 4.1.1 but I would not block the 4.1.0 release because of this.I have mentioned it at.I am going to increase the priority but lower the severity to critical.It seems that David reset priority and severity to the older values when adding himself to CC :-)bibisect log:# bad: [4118d739dbd71e16057ea926ef3ef696025d3b67] source-hash-5bd6a5110bb812f82a81e73422a7b14851f84441# good: [68ce28f8d3ca05b1329580ed9f3e6ba0c82fbb26] source-hash-9f0f289c51765c671cbc8ef317c81e6fa42c6718git bisect start 'master' 'latest'# good: [e877ef94e2df78928f4c2af3ba7c99657f4f1886] source-hash-e46564a0a6a74da90785a1b910d33e2b5bfdcfd9git bisect good e877ef94e2df78928f4c2af3ba7c99657f4f1886# skip: [d43a96e8f17f73bd4be6af586132358d2883500f] source-hash-b2d08d759ee755cb5722553e01fb6d007ac9ffbegit bisect skip d43a96e8f17f73bd4be6af586132358d2883500f# skip: [05028c83ffea91506baec9829872a8bfa72a4e40] source-hash-59db0cb6752f269893e2697bf561643aec92bdf1git bisect skip 05028c83ffea91506baec9829872a8bfa72a4e40# bad: [700dad893e4ac8f865dfc7a047022f3e1b0bd3c1] source-hash-20e1181461adaae3289a5ef943ec5c4b75cc1570git bisect bad 700dad893e4ac8f865dfc7a047022f3e1b0bd3c1# good: [556e6277d7ae436a4bee1d8f9760b5238b8932b4] source-hash-d89012691b53def37118b0d892b50476d4e987b7git bisect good 556e6277d7ae436a4bee1d8f9760b5238b8932b4# bad: [78e8a3ced23d601da8a2357daf03a3e8f22c16a6] source-hash-1fadebef054b811d8d6487d45d76dea1990e1268git bisect bad 78e8a3ced23d601da8a2357daf03a3e8f22c16a6# good: [850682b3d95da8ae1a599c1a5e9064a480d13d76] source-hash-0314533d3ba5a2601bc18037c4a1fbc6a54910d3git bisect good 850682b3d95da8ae1a599c1a5e9064a480d13d76# skip: [51f094cf62f3f4b4f68f9c77f052d896a97e04e6] source-hash-0143805a565418d2a114c16b7eeba3b784176d9egit bisect skip 51f094cf62f3f4b4f68f9c77f052d896a97e04e6# good: [c648b138202c9f97ac5ca8b39e08117486839adf] source-hash-cdad97557a729ecbbe0236f7998647c5249a005fgit bisect good c648b138202c9f97ac5ca8b39e08117486839adf# bad: [790409f95b1bc4fc76e1e78c1395ed692a184ca8] source-hash-5dc41015ed10d4b4bd0eaa59e8cd6c0b1b96cc04git bisect bad 790409f95b1bc4fc76e1e78c1395ed692a184ca8# good: [0ab93000f1bffa3fa728fc7a673b722277b1b241] source-hash-08bb8fca4144608237418d64b1479840c408256fgit bisect good 0ab93000f1bffa3fa728fc7a673b722277b1b241# only skipped commits left to test# possible first bad commit: [790409f95b1bc4fc76e1e78c1395ed692a184ca8] source-hash-5dc41015ed10d4b4bd0eaa59e8cd6c0b1b96cc04# possible first bad commit: [05028c83ffea91506baec9829872a8bfa72a4e40] source-hash-59db0cb6752f269893e2697bf561643aec92bdf1# possible first bad commit: [d43a96e8f17f73bd4be6af586132358d2883500f] source-hash-b2d08d759ee755cb5722553e01fb6d007ac9ffbe# possible first bad commit: [51f094cf62f3f4b4f68f9c77f052d896a97e04e6] source-hash-0143805a565418d2a114c16b7eeba3b784176d9eMost probable cause is commit 0143805a565418d2a114c16b7eeba3b784176d9e .right, it is 0143805a565418d2a114c16b7eeba3b784176d9eCreatedpartial revertThis makes it work again. base class ::Activate/::DeActivate calls SfxShell::BroadcastContextForActivation so remove the explicit calls to that from sd and revert back to calling the base one which does that. There must be something that depends on the original behaviourCaolan McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: fdo#66924 switching to master view is brokenThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-1":Resolves: fdo#66924 switching to master view is brokenIt will be available in LibreOffice 4.1.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-1-0":Resolves: fdo#66924 switching to master view is brokenIt will be available already in LibreOffice 4.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Miklos Vajna committed a patch related to this issue.It has been pushed to "libreoffice-4-1-0":Partially revert "Resolves: fdo#66924 switching to master view is broken"It will be available already in LibreOffice 4.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.This makes the non-sidebar master view editing work beautifully. I wonder though - if you select text with the sidebar showing, and (eg.) use the drop-down button for underline style, there is some 'orrible focus foo going on between the sidebar and the document - such that the popup doesn't stay popped-up but gets confused.Then again - perhaps that's completely unrelated - thanks for the fix ! :-)focus foo problem wrt to drop down in sidebar underline exists with/without this patch, so appears unrelated. I would *expect* the code changed here to only affect things when switching slides/slide views.File a new bug ?, and/or find that widget and tweak its WinBits to be more like the WinBits of the working dropdown of the fontcolor widget.Caolan McNamara committed a patch related to this issue.It has been pushed to "master":Revert "Resolves: fdo#66924 switching to master view is broken"The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=67070	On openSUSE 12.3, 64-bit LinuxLO 4.1 beta and up to the recent RC3 does not open password protected file nor does it saves a new file with password protection. Trying to open a password protected file ends with the following error:The password is incorrect. The file cannot be openedTrying to save a writer or calc file with password protection results in the following error:Error saving the document Untitled1:General Error.General input/output error. Bojan could you please provide an example file to test against and name the PW in the file description.After providing that, please re-set this bug to UNCONFIRMED.Createdpassword protected fileSorry my ignorance, but I can not find the way to reset the bug tounconfirmed..On 21 July 2013 14:20, <> wrote:>>>>>>>Hi guys. I had the same problem opening a password protected file that was saved using version 4.0.2.My installation:LibreOffice_4.1.0.4_Linux_x86-64_debUbuntu 13.04 x64This is my fist post here, so forgive me if I'm doing something wrong. The file has personal data, so I cannot attach it. If needed, I can try to reproduce using another file.Please let me know if I can help to fix this. I'm a Developer, but I haven't worked with LibreOffice code.Thanks.CreatedPassword protected spreadsheet (passwd: 12345)Password protected spreadsheet (passwd: 12345)I've attached a password protected spreadsheet.Password = 12345The file was created in version 4.0.2.2 and can be opened with success in that version.It can't be opened in 4.1.0.4 (incorrect password)I had the same problem in Ubuntu 12.04 64 bit.Password-protected writer-documents created with LO 4.0.2 can't be openend in LO 4.1.04, saying wrong password.My workaround:"sudo ln -s /usr/lib/libsqlite.so.0 /opt/libreoffice4.1/program/libsqlite3.so"No it works. But it works only, if I open the document with LO. If I open the document directly from a filemananger, LO says still "wrong password".Scientific Linux 6.4, 64 bitThis bug almost gave me heart failure.When I upgraded from Old: LibreOffice_4.0.4_Linux_x86-64_rpm.tar.gz New: LibreOffice_4.1.0_Linux_x86-64_rpm.tar.gz Version: 4.1.0.4 Build ID: 89ea49ddacd9aa532507cbf852f2bb22b1ace28I was no longer able to open my encrypted documents (or save them with a password either). The following error was reported: The password is incorrect. The file cannot be openedThe following work around corrected the problem: # ln -s /usr/lib64/libsqlite3.so.0 /opt/libreoffice4.1/program/libsqlite3.soThe "#" means "root" user. The work around corrected the save as with password error too, which was an I/O Error.Please fix this immediately, before you give some folks real heart attacks.Many thanks,-T*** This bug has been marked as a duplicate of***This is actually a dupe of.Make sure to subscribe the other bug if you want to be notified of changes.
id=67252	A file generated in Excel 2010 is showing formular with 'msoxl:=C80*F80'.Seems to be name space related.Expected behavior:Convert to formula and show the calculated valueBehavior:Showing 'msoxl:=C80*F80'Seems to be a regression. Hi,can you pls test this in 4.1.0 release?Thanks,CorCreatedTest file created in Excel Starter 2010Hi, I have attached a file created in Excel Starter 2010 and saved as Open Document format. This has been tested against LibreOffice 64 bit version Linux and Windows 4.1.0.4 which is identical to the released version.Also version 4.2.0.0.alpha0+Build ID: 7857d772f7f82a33de506cd10e4298aa092bfe8f has been tested with the same result.I find this as a highly critical bug.I haved raised this to highest level as any editing of the file using LibreOffice destroys the file when saved.Can also add that version 4.0.4.2 also have this bug.Tested on Windows.Hi,Can others pls confirm this behaviour?thanks!Cor*** This bug has been marked as a duplicate of***Have this bug on 4.1.0.4 Windows, on test file.Also it comes along with wrong interpretation of decimal separator in formula: dot is read, and produces an error as locale specific is comma.
id=67665	Createdan errorneous ODG and reference PDFSteps to reproduce:1. get Liberation font set ()2. start Libreoffice in your Windows 7 64bit3. open the ODG attachment4. compare with PDF attachment created from the file5. If the problem was reproduced properly: instead of Liberation fonts (as show in PDF), you will see Times New Roman in the whole text (ODG)6. Change styles to Liberation fonts7. Save the ODG8. Goto 2. Mmh, strange. I can reproduce the behavior when I open your attached ODG. From step 6 I fail to reproduce it. Changing the font back to 'Liberation Sans', save it, reopen it -> correct font.Can you reproduce this problem every time, also from scratch?Kind regards,JorenYou don't have to get any font set- just try setting the default style to anything else - save, close, reopen - styles aren't saved.Thank you for reporting this issue! I have been able to confirm the issue on:Version: 4.2.0.0.alpha0+Build ID: 09a4c4d176ff97ab8ff4027af83a549991667baf Date: Tue Jul 30 19:05:34 2013 +0300 Platform: Bodhi Linux 2.2 x64+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +As I've been able to confirm this problem I am marking as:New (confirmed)Critical - complete loss of data for styles - can break any draw/impress document that uses custom stylesHighest - relatively popular feature (styles) + regressionKeywords - regressionWhiteboard Status - bibisected+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +LibreOffice is powered by a team of volunteers, every bug is confirmed (triaged) by human beings who mostly give their time for free. We invite you to join our triaging by checking out this link:and join us on freenode at #libreoffice-qaThere are also other ways to get involved including with marketing, UX, documentation, and of course developing -. Lastly, good bug reports help tremendously in making the process go smoother, please always provide reproducible steps (even if it seems easy) and attach any and all relevant material2dfc8547708ece603fe3d62ec31cb73c1ad0fe7c is the first bad commitcommit 2dfc8547708ece603fe3d62ec31cb73c1ad0fe7cAuthor: Jean-Baptiste Lallement <>Date: Tue Mar 12 20:47:48 2013 +0000 source-hash-fea303a3d7422d26b7d4ea26126b0769e66dda40 commit fea303a3d7422d26b7d4ea26126b0769e66dda40 Author: Urs Fässler <> AuthorDate: Fri Mar 1 11:05:30 2013 +0100 Commit: Michael Meeks <> CommitDate: Fri Mar 1 12:18:45 2013 +0000 translation of German comments in file sd/source/filter/html/pubdlg.cxx Change-Id: I7c4963560bab186721ec5ef95461a4dcb6994351:100644 100644 83da8bfa7da01660e4cc59c8a41da104b3003c1b 60d32746b3a465da2b86c4d968e755e379b64eed M autogen.log:100644 100644 bb9f3bf110a693816b1ca27a2213544de05c8e09 c246ce6fdb0143830ae9dce06f0646b6d814f0e2 M ccache.log:100644 100644 ffd216fbec84ffaa39419ee97ad73b198189890e a03ca66d03cdc8aeefd6c1db627040b909f98b62 M commitmsg:100644 100644 006447e3cf204a30c9aaa909207e7f98b905bef8 2eed45fe7014c3d817ac021cd472ab9ac8be2f37 M dev-install.log:100644 100644 8f21f6f3a7c2fb2298d4392387020a4874e25b89 dd769a786d7609ae758a0ef753fa8678dec5718d M make.log:040000 040000 26d4e4d23578e4e7cb9edff66233e8dfb34e2f11 b01149b08ac26b704f0d19a8fc3edeefe33fb765 M opt# bad: [4118d739dbd71e16057ea926ef3ef696025d3b67] source-hash-5bd6a5110bb812f82a81e73422a7b14851f84441# good: [3e7462bd65e692bf0592d5b080b7716341b62a47] source-hash-1eddfce9894fd05315173744f495619189093dc7git bisect start 'latest' 'oldest'# bad: [086c82fbd0a50dbf5dd28e8bcc7a6d702cea124e] source-hash-c74f2edfce221960fe546e88f2b3222d69d53598git bisect bad 086c82fbd0a50dbf5dd28e8bcc7a6d702cea124e# good: [3367a5f4f0d1768c35ed32ac1956abf5c3ab4e0d] source-hash-cc9cd7af3beb13eede23c6c60506c6e8c329e29dgit bisect good 3367a5f4f0d1768c35ed32ac1956abf5c3ab4e0d# bad: [8609688fe6682504b3e6bc675e209db988d3acc1] source-hash-de69091d34d8102c0b56194d603ed9e66699d34cgit bisect bad 8609688fe6682504b3e6bc675e209db988d3acc1# good: [a0da7886ec5c1ecfc0b5a1e9a85a18459a764761] source-hash-a82f7b20539e60f1cf599afcceaf865bef297a66git bisect good a0da7886ec5c1ecfc0b5a1e9a85a18459a764761# bad: [fc3244a3c07d510a46baf5f999d378d07277fe1d] source-hash-5e8402ade84ab1816d32793e3476521e1c5b1027git bisect bad fc3244a3c07d510a46baf5f999d378d07277fe1d# good: [7e77cca7155e14b96615173a7a68c2826750e6f5] source-hash-c7ef87aa8db6d892491891dcda6bfbaa1ad1d0d2git bisect good 7e77cca7155e14b96615173a7a68c2826750e6f5# bad: [71441d60f3e4303a8f0ba04754f46fac09bf3f54] source-hash-5ff1afbf1ef1dbea81c156572e7cd125bde70778git bisect bad 71441d60f3e4303a8f0ba04754f46fac09bf3f54# bad: [917b8fc1dcc2f28ff6602528a130118eb79a8149] source-hash-24ba80686c9028b4f6dd1f63bfe905c029068b11git bisect bad 917b8fc1dcc2f28ff6602528a130118eb79a8149# bad: [2dfc8547708ece603fe3d62ec31cb73c1ad0fe7c] source-hash-fea303a3d7422d26b7d4ea26126b0769e66dda40git bisect bad 2dfc8547708ece603fe3d62ec31cb73c1ad0fe7cThorsten - perhaps you can pinpoint who broke it?range:thanks to JoelProbably introduced due commit:and/orSame as.Kind regards,JorenThis works with .odt , so my guess is that Draw is missing import code that apply the font information from the import filter to its styles.Bug also exists in Version: 4.1.1.0.0+; Build ID: 09a8fb1d90964d51d93a7e23a8d4af832fa614a; TinderBox: Linux-x86_64@31-Release-Configuration-RHEL5-Baseline, Branch:libreoffice-4-1, Time: 2013-08-05_23:28:45(In reply to)OK, then this seems the same as what is mentioned here***has been marked as a duplicate of this bug. ***Marked 67565 as duplicate.Fromthere"Steps to reproduce problem:-- Open attached document.- On first page of attached document, right-click on top-left text box with text "Force feedback input" and select "Edit style".- Change the font to Arial.- Watch all text in Times font change to Arial.- Save document.- Close document.- Open document.- Look in horror as all text is back to Times again!!!!!"I edit the summary of this bug a bitThis is a killer bug. What can be done to speed up getting it assigned and getting a patch out there to fix it? It is forcing people to switch to alternative packages to LibreOffice. Some of us upgraded because of awful bugs in previous versions, so going back to older versions is not even really an option. I am asking this out of innocence as a long time supporter of Free Software. I cannot imagine having a bug that stops the application dead in its tracks and then not fixing it. I would sell my soul to the devil for a reasonable fix that is released so ordinary folk can use it.Well, its XMLTextExportPropertySetMapper::ContextFontFilter that kills the export of the font info. The mentioned bibisect commits put all fonts into the FontAutoStylePool and ContextFontFilter gets called multiple times and ends up filtering out all info about the font via that GetFontAutoStylePool()->Find area.Caolan McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: fdo#67665 font names filtered out on odp/odg exportThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-1":Resolves: fdo#67665 font names filtered out on odp/odg exportIt will be available in LibreOffice 4.1.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-1-1":Resolves: fdo#67665 font names filtered out on odp/odg exportIt will be available already in LibreOffice 4.1.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.I can confirm that in the build listed below it is fixed for me.Version: 4.1.2.0.0+Build ID: d422eeed14f34e8595f795135be847fe5b6c555TinderBox: Win-x86@6-debug, Branch:libreoffice-4-1, Time: 2013-08-23_01:32:45***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***@Caolán McNamara: Still not fixed completely, as it's now incompatible with older versions. see. thanks.The font is now saved, in the actual daily - at least for me. But the indent on the first line is still not saved (probably this is the own, and can not be fixed together)(In reply to)by "older versions" I meant 4.0.X.Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=67892	Createderror dialog 1Issue:LibreOffice 4.1 on Linux can not open any OpenDocument files (.odt, .ods, etc) from Samba shares. It can however open Microsoft Office Created files (.doc, .docx, .xls, etc).What happens:1. Create a test.odt on your local machine, save it. Confirm it can be opened post save2. Copy .odt to samba share3. try and open test.odt (or any pre-exisiting file) you will be prompted with dialog box saying file is corrupt and do you want to repair (image1)4. if you say 'yes' to repair it opens it in LibreOffice Math.5. if you say 'no' you get a dialog box that says file could not be repaired, press ok. (image2)6. It then repeats this process of steps 3&5 two more times before giving you 'General input / output error' (image3)What should happen:1. Create a test.odt on your local machine, save it. Confirm it can be opened post save2. Copy .odt to samba share3. Open file from share.Software information:Workstation:$ lsb_release -rdDescription: Ubuntu 12.04.2 LTSRelease: 12.04$ apt-cache policy libreofficelibreoffice: Installed: 1:4.1.0-0ubuntu1~precise1~ppa1 Candidate: 1:4.1.0-0ubuntu1~precise1~ppa1 Version table: *** 1:4.1.0-0ubuntu1~precise1~ppa1 0 500precise/main amd64 Packages 100 /var/lib/dpkg/status 1:3.5.7-0ubuntu4 0 500precise-updates/main amd64 Packages 1:3.5.4-0ubuntu1.1 0 500precise-security/main amd64 Packages 1:3.5.2-2ubuntu1 0 500precise/main amd64 Packages Createderror dialog 2Createderror dialog 3*** This bug has been marked as a duplicate of***
id=67453	CreatedFile name says it all. -- MarcProblem description: Steps to reproduce:1. Load a particular .odg file with LibreOffice closed (double-click on file)2. LibreOffice will try to load the file, but close instead of load it3. Alternatively, start LibreOffice4. Try to open .odg file5. LibreOffice will not load file and remain on empty pageExpected behavior:Should open file instead of crashing or remaining on a blank page. It crashes the 4.0.x branch BUT works fine on our new 4.1.x branch.This topic was discussed on the user list, introduced by a user and I confirmed it was indeed crashing 4.0.4.2 . See [] Operating System: AllVersion: 4.0.4.2 release No crash for me but it doesn't open with 4.0.4 opens fine with 4.1 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++In general we'd like more info when someone is reporting someone else's bug - and we'd prefer the actual reporter to report so they can answer these types of questions directly - examples include:How was the file made? LibreOffice (if so what version?), openoffice (if so what version?), some other software (if so what software, what version)What OS is experiencing the crash? Like I said, for me no crash, just doesn't open, LibreOffice continues to work fineDid it work on previous versions of 4, or any other version for that matter prior to 4.1 for reporter? Also it's good for users to get a bugzilla account and get comfortable with our system so that they can report future problems - else they start thinking they can just report on the ML and get action - which is not the case - QA rarely monitors the list and we don't want users getting false expectations++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++That being said because I can confirm it won't open on some versions of 4 I went ahead and bibisected - since it's been fixed someone will need to cherry pick the fix for 4.0 release9a5620ca6473969359f262802c76daf35cbcbb5d is the first bad commitcommit 9a5620ca6473969359f262802c76daf35cbcbb5dAuthor: Bjoern Michaelsen <>Date: Tue Dec 11 01:59:31 2012 +0000 source-hash-ae4e4a11d4300f7448cb6bd170fcb034542caddc commit ae4e4a11d4300f7448cb6bd170fcb034542caddc Author: Rene Engelhard <> AuthorDate: Tue Nov 6 21:24:32 2012 +0100 Commit: Rene Engelhard <> CommitDate: Tue Nov 6 21:24:32 2012 +0100 typo... Change-Id: I2c7968194afbcf74967cd16c639dce7de858a513:100644 100644 c09b92a8ddf24b8738a7cd3a695ae1e4482d354c 6b13afd13f023cedac65a896318de4aa55dead27 M autogen.log:100644 100644 bcee1e11bd693642ca5a6330175b58082e5dcdd0 54d2377f5b3afd6ed668b3e24cb877c289119ec5 M ccache.log:100644 100644 75677cef16786d2cc95c0d8f301482278ca055c3 d18a6ebcd3b8537c3dd3dbc16e862fb6370ecb8a M commitmsg:100644 100644 83b4ecc0ecb3e031c804d49f45f854e95d5cc961 d482c00e5fff6081c6b87b637fd9ffaf3e1e2c6c M dev-install.log:100644 100644 91437b9974ffada7e049273419bb8c66c91c0539 abf45ab9609c77a5ab952aa310eafe8c2ffaf85c M make.log:040000 040000 45c0bab8b669778ab523c8f65a25e8c9afde604a f4bfa15b2f72d3df5675b07bcf32254a819b9d19 M opt# bad: [5b4b36d87517a6ea96ff8c84c46b12f462fc9a1a] source-hash-8450a99c744e9005f19173e4df35d65640bcf5c4# good: [65fd30f5cb4cdd37995a33420ed8273c0a29bf00] source-hash-d6cde02dbce8c28c6af836e2dc1120f8a6ef9932git bisect start 'latest' 'oldest'# good: [16b0b88cbd4ef0f51816e97277e40c5cf78f7bf9] source-hash-099198a4224778fe6e43f5dc13b5b9b1b4dc828cgit bisect good 16b0b88cbd4ef0f51816e97277e40c5cf78f7bf9# good: [f28b8f9a6c47fa59bf98fffe937a2f2db7a2445a] source-hash-a581d31b227623e09d2970a91214fda398f98edagit bisect good f28b8f9a6c47fa59bf98fffe937a2f2db7a2445a# good: [114fd3b76bcba890e6d702d00cef910f1493c262] source-hash-64ab96cd15e52da88781e720d6f031dbcd0ba902git bisect good 114fd3b76bcba890e6d702d00cef910f1493c262# bad: [47498a36f7af8f54e6e3dda89cd4708802a409e6] source-hash-19f4ebd8a54da0ae03b9cc8481613e5cd20ee1e7git bisect bad 47498a36f7af8f54e6e3dda89cd4708802a409e6# good: [f4e2d84db194943180f3e7ed4adce5f8e377d9bc] source-hash-806d18ae7b8c241fe90e49d3d370306769c50a10git bisect good f4e2d84db194943180f3e7ed4adce5f8e377d9bc# bad: [fb4214f9d134b556582a4a5280e5458de5f8eebd] source-hash-683758efb22d08a4cf211a6d985148f513da2a90git bisect bad fb4214f9d134b556582a4a5280e5458de5f8eebd# good: [e2e46267c18c2706de771a08472ebfce19f68520] source-hash-4316e643ef345b0f673b4a03a80a4b7cb3185588git bisect good e2e46267c18c2706de771a08472ebfce19f68520# bad: [9a5620ca6473969359f262802c76daf35cbcbb5d] source-hash-ae4e4a11d4300f7448cb6bd170fcb034542caddcgit bisect bad 9a5620ca6473969359f262802c76daf35cbcbb5dThanks Marc for reporting - wasn't trying to lecture you as I obviously know that you're a contributor to the project - just trying to make sure that QA gets what they need and that users learn how to do things the right way instead of bugs through ML - which I see occasionally but I tend not to do more than say "you should report this on FDO" and link to the how to report a bug wiki.@Thorsten - can you use the bibisect to try to figure out what patch fixed it on 4.1 and see if we can backport it to the 4.0 branch?The file was not sent in by the original reporter on the mailing list but another user sent me a file but did not want to be involved with the bug reporting. No idea why.Marc*** This bug has been marked as a duplicate of***Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=68314	CreatedWhat is Format Paint Brush.Problem description: Format Paint Brush has no functionSteps to reproduce:1. Select any word or paragraph that has customized format in Writer.2. Click "Format Paint Brush " on toolbar of Writer.3. Move the cursor to apply the format to any other words or paragraphs, but nothing happened.Current behavior:Format Paint Brush has no function.Expected behavior:Format Paint Brush can apply the format to some words or paragraph.Operating System: DebianVersion: 4.1.0.4 release CreatedThe file to test the paragraph format coping.I tried Libreoffice 4.1.1-rc1, the Format Paint Brush can copy the Font Format, but it can not copy the Paragraph Format.You can download attachment PaintBrush-paragraph.odt to test this problem with Libreoffice 4.1.1-rc1.Thank you~Behaviour of format paintbrush has changed since 4.0: by default only character formatting is copied, to include paragraph formatting hold down Ctrl when you select the text (or Ctrl+Shift for copying only paragraph formatting).*** This bug has been marked as a duplicate of***Stanislav Horacek:Thanks for your explaining, now I know it's a new feature. :)
id=68315	I have an .odb file which uses ODBC to connect to a postgresql database located on another computer. Inside the .odb file there are several forms defined. Since LO 4.0 whenever I change data in any of these forms and press the "save record" button, I get:Error updating the current recordthe target rows is out of the rowsetSQL-Status: HY107Error code: 20And the next time I press the "save record" button, LO crashes.This bug makes LO 4.0 completely unusable for me since I can do no work on my database. I am stuck with using LO 3.6.x which works fine. The error message seems to originate from the odbc-postgresql package. Since this is identical for my installation of LO 3.6 and LO 4.0 it seems that LO 4.0 sends different information to the ODBC driver than it used to do in version 3.6You have reported this behavior for Linux. Which version do you use? Have a look here for special problem ODBC / MariaDB in openSUSE:I use Ubuntu 12.04. The bug you mention is similar but different. For example, I can view any amount of data in the forms but as soon as I change some I get an error message, and at the second try a crash. Also, my database is PostgreSQL not mySQLI have now setup ODBC for postgresql on OpenSUSE 12.3 64bit. I could open the folder public, could see the tables, but when I try to open the tables LO 4.* crashes immediately. When I try the same with any 3.* version (have tested 3.3.4, 3.6.6.2 and 3.6.7.2) LO hangs and the whole KDE-windowmanager is very slow.The only way to get LO open a table of postgresql with ODBC is to use the packages, which are packed by OpenSUSE itself. With this packages (LO 4.1.0.4) I could see the content of the tables, could try a input, but it fails with an error "7", query ... «)». So ODBC isn't usable with postgresql on my system at all.The direct connection between postgresql and the OpenSUSE-packages of LO is running without problems.Where do you get the packages from, when LO is working together with ODBC and Postgresql?Server (on a different machine than the LO client):- Ubuntu 12.04 32bit- postgresql-9.1 version 9.1.9-0ubuntu12.04Client:- Ubuntu 12.04 32bit- odbc-postgresql version 1:09.00.0310-2LO 3.6.6 installed manually from the libreoffice web page-> this combination works fine. The only reason I am installing manually from the webpage is because of the report-builder package which is not included in the Ubuntu12.04 version of LO. But before I noticed this I installed the standard Ubuntu12.04 LO version (3.5 I believe) which also worked fine. All LO 3.x versions I have tried work equally well.LO 4.0 (4.1 has the same problems as described in this bug report): - debprecise mainWhat I have also noticed (in LO 3.x) is that accessing postgresql directly from LO without going through ODBC doesn't work properly.Could you try to retrieve and attach some bts? (see)Lionel: thought you might be interested in this one.CreatedbacktraceVersion: 4.1.0.4Build ID: 410m0(Build:4)Jan: thank you for your feedback. I update the status to NEW since a bt has been provided.Version field of bug report is *oldest* version where the bug has been reproduced. Resetting to 4.0.4.2 since Jan says he gets this bug with 4.0.Cannot reproduce on Debian GNU/Linux with LibreOffice Version: 4.1.2.0.0+ (my development tree) and odbc-postgresql 1:09.02.0100-2 and unixodbc 2.2.14p2-5 and server 9.0.6.Please:1) attach the .odb file you are using2) attach a SQL dump of the database with which you have the problem; you can fill it with dummy data if the data is personal / confidential / ...3) Give an exact description of what to do to reproduce the bug (open which form, change what data to what, ...)Also give the relevant entries in odbcinst.ini and odbc.iniCreatedThe .odb file, reduced to the minimum to reproduce the bugCreatedThe .odb file, reduced to the minimum to reproduce the bugCreatedThe database SQL dumpUse pgadmin3 to import into an empty database called "Villages" (capital V) with owner postgresTo reproduce the bug:- Create an empty database "Villages" (capital V!) with owner postgres- Import the SQL dump into this database using pgadmin3- Create an odbc connection in /etc/odbc.ini:[Villages-local]Description = Connection to postgresql Villages database (local copy)Driver = PostgreSQL UnicodeTrace = NoTraceFile = /tmp/psqlodbc.logDatabase = VillagesServername = localhostUserName = Password = Port = ReadOnly = NoRowVersioning = NoShowSystemTables = NoShowOidColumn = NoFakeOidIndex = NoConnSettings = - Open the .odb file- Open the only form (it might ask for the password of the postgres user)- Edit a field, e.g. set "houses" to 10- Click on the "save" icon at the bottom of the window. An error message pops up- Click again. CrashesCreated/etc/odbcinst.iniserver 9.1+129ubuntu1odbc-postgresql 1:09.00.0310-2unixodbc 2.2.14p2-5ubuntu3OK, reproduced. Here's why I did not get the problem: in edit / database / advanced settings / special settings, I *unset* "Ignore the privileges from the database driver" and I *set* "Respect the result set type from the database driver". Which (if/when they work), are the preferred settings anyway, since they are work-arounds for bugs / incompleteness in the ODBC driver.Changing the settings solved this problem for me. Though I don't think I ever edited them. But the database file .odb is several years old... Maybe you could have an automatic warning pop up if an old file is loaded with these settings?Lionel Elie Mamane committed a patch related to this issue.It has been pushed to "master":fdo#68315 odbc update *reads* a bookmark, not *writes* a bookmarkThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.I've fixed the crash, and the reason for the "the target rows is out of the rowset" error message; backport to 4.0.x and 4.1.x pending review.I still cannot get PostgreSQL/ODBC to work with the option "Respect the result set type from the database driver" unset. The update fails with 'syntax error in query near "where"'. However, you say that LibreOffice 3.6.x works for you, it does not for me; it fails with the same error.So I'm closing this bug with the assumption that the situation is back to what it was for LibreOffice 3.6.Lionel Elie Mamane committed a patch related to this issue.It has been pushed to "libreoffice-4-1":fdo#68315 odbc update *reads* a bookmark, not *writes* a bookmarkIt will be available in LibreOffice 4.1.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Thanks for this patch."However, you say that LibreOffice 3.6.x works for you, it does not for me; it fails with the same error."The identical files attached here work fine with LO Version 3.6.6.2 (Build ID: f969faf)BTW when I create a NEW database with ODBC connector in LO 4.1, by default the options areSET: Ignore privilges from db driverUNSET: Respect result set from db driverwhich is exactly the opposite of what you said in a previous comment should be set!(In reply to)They work for me with 3.6 only if I additionally set UpdatableCursors = Yesin the DSN (in ~/.odbc.ini). With this additional setting,it works also with LibreOffice 4.0 and 4.1 AFTER applying my patch.(In reply to)Yes, it is a conundrum. These values are good to work with buggy drivers (that lie about their capacities and the user's permissions). The values I have given are good for working with non-buggy drivers (that give correct information about their capacities and the user's permissions). Which ones should be the default? There is no way to win...Lionel Elie Mamane committed a patch related to this issue.It has been pushed to "libreoffice-4-0":fdo#68315 odbc update *reads* a bookmark, not *writes* a bookmarkIt will be available in LibreOffice 4.0.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=68566	CreatedThe file that is working with 4.0.4 and fails with 4.1.0I have a spreadsheet created with Libreoffice 4.0.4 which includes a master table into which I enter a sort of address book, listing lastname, firstname, position, roles, phone numbers, email and postal addresses.I use an auto filter to be able to sort that table using the column headers.Within the same file I have sheets for a subset of the information of the master table. All is working perfect in 4.0.4 and when I upgraded to the 4.1.0 release the following issues came up and made me downgrade back to the 4.0.4 release:1) If you enter an email address in one cell on the master sheet the email is recognized as URI and reformated as a mailto link. This was no issue in 4.0.4, but in 4.1.0 other sheets refering to this column using a formular like: =T(Master.J22) do no longer get me the text from the master table but generate an empty cell. Seems that if the master contains text only (no URI) the reference is working, if its converted to a URI the reference is broken, and all child sheets show empty cells instead of showing the email address.2) If you use the master table to resort the address list, the information is not always updated on the child sheets. E.g on the master I have roles for some persons. These roles are e.g. chief, leader team 1, leader team2, clerk, etc.In 4.0.4 I was able to sort the table by role to have all assigned roles at the top of the table. The child sheets reflected this and content sorting order matched the master.In 4.1.0 the roles will show according the sorting order as well as in their original position they have been before the master was resorted using a different criteria.Hope this is clear. I attach the sample file used. I made the first two entries on the master sheet URLs again, and they show on the child sheet using 4.0.4 correctly, but are empty on 4.1.0. Using lastname / function sorting again the dependent sheets are working fine on 4.0.4 and fail on 4.1.0. Operating System: Mac OS XVersion: 4.1.0.4 release Please, could explain step by step what to do on your file to reproduce the problem?Your file opens without problem with versions 4.2.0.0.beta2+, 4.1.5.0+ and 4.0.6 under Ubuntu 13.10 x86-64Best regards. JBFWhat I understand:1st presume bug: The T() function returns an empty string instead off the cell text when cell contains an URL.2nd presume bug: When sorting "master sheet", other sheets are not refreshed.Both presume bug are not reproducible with 4.1.3.Update with a most recent vesion and tell us if you still reproduce.Hi,thanks for having a look at my issue. I appreciate this very much.I just downloaded LibreOffice 4.1.3.2 and can confirm that the T(..) function now seems to work, because the mailto: URIs on the master sheet will produce the email address as text on the sheet called "AdressListe". So one issue is remaining.The sheet is used for our voluntary fire-fighter department. For this we hand out the telephone/address list to all members of the fire-fighters.The sheet called "TelefonListe" should be sorted using the column "Fkt-Sort". The goal is to have all people that have a specific role in the fire department at the top of the "TelefonListe" sheet so that their phone numbers are listed first.The lastname column on the master sheet is used to sort the sheet "AddressList" in alphabetical order based on the peoples last name.I can confirm that the sorting bug remains in the 4.1.3.2 version while in 4.0.4 it is working well. This is what you need to do:1) Go on the master sheet and sort by lastname.2) Verify that the members are sorted on the TelefonListe and AdressListe sheets in alphabetical order. Especially in the TelefonListe the functional role of the people should be the same on the master and on the TelefonListe. 3) I now print the AdressListe sheet to have that sheet in alphabetical order.4) Next I use the Fkt-Sort column on the master sheet to sort the list based on the functional role of the fire-fighters.5) Now you go on the TelefonListe sheet to see if the list has been sorted. With 4.1.3.2 the names are sorted correctly, but the column with the functional roles is not. When I use the release 4.0.4 the functional roles are sorted correct and reflect the order on master sheet.Hope this helps you to figure out whats going wrong here.Regards and many thanks,MichaelOne more thing. The behavior looks to me, as if in 4.0.x releases clears table cells on dependent sheets before filling them again. Thats why the functional roles appear correct in that release. In 4.1 releaes this seems to have been optimized such that cell data is overwritten with the new data depending on sorting results. However if an empty cell is put on top of a cell that previously contained data, then the cell content is no longer cleared. Therefore in 4.1.x the sorting appears broken in the dependent sheets for columns that do not contain data in every cell.Does this make sense?The content ofhas been deleted by Tollef Fog Heen <>who provided the following reason:ConfidentialThe token used to delete this attachment was generated at 2014-05-05 15:33:48 UTC.It is impossible to test further without a test file.If you still encounter this bug with current stable version, could you attach an anonymized version of your original file ? An easy mean to anonymize your file is to replace all alphabetical character by x and numerical character by 9.Thank you for your understanding.Best regards. JBFRemoving comma from whiteboard (please use a space to delimit values in this field)(In reply to)I just tested the bug with the lastest release of 4.3.1 and it got worse. Sorting does not at all work on dependent tables. I added again a sample file.CreatedSample file to reproduce the bug of sortingComments are in the file. Can be used to reproduce the issue. File working well with 4.1 release and is not working with 4.2 or 4.3 releases of LibreOffice.CreatedFile working with 4.2.4.2 - but not with newer Office suiteI just realized that the 4.3.1 messed up my test file I uploaded before. This one is working with 4.2.4.2 just fine, but breaks e.g. with 4.2.5 or 4.3.1set back status to UNCONFIRMEDConfirming onVersion: 4.3.2.2Build ID: edfb5295ba211bd31ad47d0bad0118690f76407dOSX 10.9.51) Open attachment of2) Sort on master sheet with Lastname ascending - data sorted accordingly3) Click on Dependent sheet - note that data has not been sortedSort and update work inVersion: 4.1.4.2Build ID: 0a0440ccc0227ad9829de5f46be37cfb6edcf72therefore regression(In reply to Alex Thurgood from)Looks similar withwhich is marked as not a bug. New sorting behavior since 4.3.1 and 4.2.7Perhaps this report should also be closed.(In reply to ign_christian from)Unfortunately, yes, but as a duplicate of 81633 (which is weird because actually much later bug declaration) - the behaviour will be configurable in LO 4.4 release and will not be backported - see bug 81663 for more details. Sigh.*** This bug has been marked as a duplicate of***Too bad that I need this for my work...I tend to agree to some other guy saying that this basic functionality (not updating references) should not have been introduced in the first place on the otherwise wonderful working calc on the 4.2 branch.But what can I say. The guy that had the desire to get this for me intuitive and natural working thing removed from a stable version came first and won.If I would have a vote: revert that change, and have the new configurable feature introduced with V4.4.Anyway I appreciate that you are having a look at my issues. Thank you all.This is literally like asking for a bug to be reintroduced into LibreOffice....Kohei was nice enough to add an option for users to bring the bug back if they so choose.Anyways - feel free to download a daily 4.4 build or of course wait for releaseFair enough - I do not understand what the original bug was. It can't be that the bug is that one feels that its unexpected that referenced cells worked as in 4.2.6 which was that sorting was updating references. Because that to me is not a bug but was expected behavior ...(In reply to Joel Madero from)I disagree. It is _not always_ a bug. The difficulty is to know when in which case it is a bug and in which case it is a feature. That is the reason why a configuration option was necessary. Please try again my test file in.I asked the ESC to consider the decision to revert this commit for branches 4.2 and 4.3.Best regards. JBFIt will not be backported - there is a new string involved - translation and all that fun stuff. So 4.4 it is.(In reply to Jean-Baptiste Faure from)Hope that reverting commits is possible. Unless we're facing dozens new bug report with similar issue until early 2015 and after 4.2.7 released.Also not reverting the commit . . . removing myself from ccFor the records, 4.2.8 and 4.3.5 will restore the old behavior, for 4.4 the UpdateReferenceOnSort option will default to false/unchecked for compatibility.
id=68588	warn:vcl.layout:6720:1:include/vcl/builder.hxx:256: widget "embeddeddbList" not found in .uiwarn:vcl.layout:6720:1:include/vcl/builder.hxx:258: .ui widget "embeddeddbList" needs to correspond to vcl type 7ListBoxsoffice.bin: /home/master/src/libreoffice/workdirs/libreoffice-4.2/include/vcl/builder.hxx:259: T* VclBuilder::get(T*&, rtl::OString) [with T = ListBox]: Assertion `w && dynamic_cast<T*>(w)' failed.This seems to come fromcommit 04d1e80ac7091ec2bf31c8617e832d5fe15350beAuthor: Andrzej J.R. Hunt <>Date: Tue Jul 30 12:27:10 2013 +0200 Add embedded database selector to db setup dialog. This allows for choosing between the HSQLDB driver (currently default) and the firebird driver for embedded databases. Change-Id: I3734440fedf9f07b28f9cfd806dafbe6610393f7 Reviewed-on:Reviewed-by: Luboš Luňák <> Tested-by: Luboš Luňák <>Probably you forgot to commit a new .ui file, or changes to one? My master build is a bit older, but looking at a fresh "git fetch" of master, I don't see any changes to any .ui file that introduces a "embeddeddblist" widget.Reproduced on:commit 9a9ee66f0d9dd126ed31db096b77f9c67355411bAuthor: Lionel Elie Mamane <>Date: Wed Aug 14 17:36:50 2013 +0200 fixup handling of unsigned values I've been unable to reproduce this on either of my systems:-My current development system with a rather old working tree (based on two week old master) works fine as expected (this is the system where I created/tested the patch).-New system, built from clean, only in use since last week (and no development work done on it yet), with the following commit:commit 7bc88db8c500b41fe926fb99cd403accd696e671Author: Andrzej J.R. Hunt <>Date: Tue Aug 27 20:52:37 2013 +0100 Implemet setNull. (firebird-sdbc) Change-Id: I9fd53a5e8b5d1dba467fa8064f9f2ea1b93f26df(Couldn't reproduce a week ago on the same machine either.)The .ui changes are definitely in that commit though -- maybe there is something specific to your machine that is preventing the updated .ui file from being used?Re-reproduced withcommit 4033532e9ffb004ab5864401aa1af0c69fc024ecAuthor: Lionel Elie Mamane <>Date: Tue Aug 27 18:28:37 2013 +0200 release m_aLengthVector even when m_aBindVector is emptyLooking at commit 04d1e80ac7091ec2bf31c8617e832d5fe15350be more closely, it indeed contains the string "embeddeddbList" in the .ui file... So frankly, I'm not sure what is wrong.I took a look at the core file in gdb; it seems to me that the code looks for "embeddeddbList" in dbaccess/uiconfig/ui/generalpagedialog.ui, while it is "only" in dbaccess/uiconfig/ui/generalpagewizard.ui.To resolve any doubt, when you say you cannot reproduce, you are testing by opening an *existing* (non-embedded) .odb file, going to menu edit, submenu database, entry "connection type", right? *Not* the new database wizard. The new database wizard also opens correctly for me. This bug is about changing the connection type of an existing .odb file.#18 0x00007f2814d5308d in VclBuilder::get<ListBox> (this=0x258bad0, ret=@0x261bcb8: 0x0, sID="embeddeddbList") at /home/master/src/libreoffice/workdirs/libreoffice-4.2/include/vcl/builder.hxx:259#19 0x00007f2814d520ed in VclBuilderContainer::get<ListBox> (this=this@entry=0x261bc10, ret=@0x261bcb8: 0x0, sID="embeddeddbList") at /home/master/src/libreoffice/workdirs/libreoffice-4.2/include/vcl/builder.hxx:392#20 0x00007f2814d5c3c0 in dbaui::OGeneralPage::OGeneralPage (this=this@entry=0x261ba20, pParent=pParent@entry=0x246f350, _rUIXMLDescription="dbaccess/ui/generalpagedialog.ui", _rItems=...) at /home/master/src/libreoffice/workdirs/libreoffice-4.2/dbaccess/source/ui/dlg/generalpage.cxx:68#21 0x00007f2814d5e769 in dbaui::OGeneralPageDialog::OGeneralPageDialog (this=0x261ba20, pParent=0x246f350, _rItems=...) at /home/master/src/libreoffice/workdirs/libreoffice-4.2/dbaccess/source/ui/dlg/generalpage.cxx:451#22 0x00007f2814d3ed68 in dbaui::ODbTypeWizDialog::createPage (this=0x246f350, _nState=<optimized out>) at /home/master/src/libreoffice/workdirs/libreoffice-4.2/dbaccess/source/ui/dlg/dbwiz.cxx:243#23 0x00007f2831996970 in svt::OWizardMachine::GetOrCreatePage (this=this@entry=0x246f350, i_nState=i_nState@entry=0) at /home/master/src/libreoffice/workdirs/libreoffice-4.2/svtools/source/dialogs/wizardmachine.cxx:254(gdb) frame 18#18 0x00007f2814d5308d in VclBuilder::get<ListBox> (this=0x258bad0, ret=@0x261bcb8: 0x0, sID="embeddeddbList") at /home/master/src/libreoffice/workdirs/libreoffice-4.2/include/vcl/builder.hxx:259259 assert(w && dynamic_cast<T*>(w));(gdb) print w$1 = (Window *) 0x0(gdb) print *this$3 = { <boost::noncopyable_::noncopyable> = {<No data fields>}, members of VclBuilder: m_aModuleMap = empty boost::ptr_map, m_aDeferredProperties = std::__debug::map with 0 elements, m_aChildren = std::__debug::vector of length 6, capacity 8 = {{ m_sID = "PageGeneral", m_pWindow = 0x261d1c0, m_nResponseId = 0, m_aPackingData = { m_bVerticalOrient = false, m_nPosition = -1 } }, { m_sID = "datasourceTypePre", m_pWindow = 0x244c970, m_nResponseId = 0, m_aPackingData = { m_bVerticalOrient = false, m_nPosition = -1 } }, { m_sID = "datasourceTypeLabel", m_pWindow = 0x244d020, m_nResponseId = 0, m_aPackingData = { m_bVerticalOrient = false, m_nPosition = -1 } }, { m_sID = "datasourceType", m_pWindow = 0x244d750, m_nResponseId = 0, m_aPackingData = { m_bVerticalOrient = false, m_nPosition = -1 } }, { m_sID = "datasourceTypeHelp", m_pWindow = 0x25a7420, m_nResponseId = 0, m_aPackingData = { m_bVerticalOrient = false, m_nPosition = -1---Type <return> to continue, or q <return> to quit--- } }, { m_sID = "specialMessage", m_pWindow = 0x25a7c00, m_nResponseId = 0, m_aPackingData = { m_bVerticalOrient = false, m_nPosition = -1 } }}, m_aMenus = std::__debug::vector of length 0, capacity 0, m_sID = "PageGeneral", m_sHelpRoot = "dbaccess/ui/generalpagedialog/", m_pStringReplace = 0x7f2835337bb1 <desktop::ReplaceStringHookProc(rtl::OUString const&)>, m_pParent = 0x261ba20, m_bToplevelHasDeferredInit = false, m_bToplevelHasDeferredProperties = false, m_bToplevelParentFound = false, m_pParserState = 0x261a870, m_xFrame = empty uno::Reference}Apologies -- I completely misunderstood what was going on (I'd never used the dialog before since I'd only used embedded dbs) -- I've managed to reproduce now.I'm trying to fix this by testing for the presence of embeddeddbList in the dialog code before trying to use it now (alternatively I could test for the dialog name but that might be too brittle).FYI. the patch fixing this is now in gerrit:Andrzej J.R. Hunt committed a patch related to this issue.It has been pushed to "master":fdo#68588 Move embeddeddbList into OGeneralPageWizard.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=68607	CreatedOffending document docx formatProblem description: Steps to reproduce:1. Open the document2. ....3. ....Current behavior: Shows one page onlyExpected behavior: Show first of eight pages Operating System: Windows 7Version: 4.0.4.2 release Thank you for your bug report, I can reproduce this bug running LibreOffice.Version: 4.1.1.2Build ID: 7e4286b58adc75a14f6d83f53a03b6c11fa2903 on Mac osx 10.8.4. this is a regression from 3.6.7 since 4.0.xAlso an issue on Windows 7 sp1, 64bitVersion: 4.2.0.0.alpha0+Build ID: 2d95a1bfd6e0adff791d9e381f0ec37470312522(2013-08-20)Document consists of a single formatted Table that spans 8 pages (US Letter, with 1/2" margins).In LibreOfficeDev master, document opens with a single table, but only two pages. However, the entire table is present, and can be selected/pasted into a new LODev Writer document. The paste action generates all 8 pages in the new document and the table is fully intact from the original.Document opens correctly formatted in Apache OpenOffice 4.0, and MS Office 2013Confirm the regressionVersion 3.6.7.2 (Build ID: e183d5b)in admin install on Windows 7 sp1 64bit.Document opens correctly with the table spanning 8 viewable pages.If it's not inherited from our friends, then a bibisect might help find this.LODev Version 4.0.0.0.beta1(Build ID: 87906242e87d3ddb2ba9827818f2d1416d80cc7)(2012-12-07)It came in as 8 pages, but the first 3 1/2 pages of table are blank. Table starts to display starting halfway down 4th page, pages 5 - 8 are correct.So there was DOC/DOCX filter work being done during the 3.7 master phase. I'll see if I can find where/when the import filter drops the additional pages between 4.0.0 and 4.0.4.2Always a joy... meanwhile if someone with keys to the bibsects wants to try, they may get there first :)As I try to bibisect this regression, I see two different badbehaviours.The temporally first "bad" behaviour here is different from theoriginal report: Writer is aware that the document has nine pages, butthe first three and a bit pages are blank. Display of text startspart way down a line of text. So, on the assumption that displayingtext of page 1 is "good" and displaying a blank page 1/9 is "bad",bibisect tells me ... 7b32edd2389319e0d394368c4109201528c41f7e is the first bad commit commit 7b32edd2389319e0d394368c4109201528c41f7e Author: Bjoern Michaelsen <> Date: Tue Dec 11 02:50:26 2012 +0000 source-hash-44b96a2fce52b6e3e683dc917fab219cf75001db commit 44b96a2fce52b6e3e683dc917fab219cf75001db Author: Peter Foley <> AuthorDate: Fri Nov 9 08:25:42 2012 -0500 Commit: Peter Foley <> CommitDate: Fri Nov 9 08:25:55 2012 -0500 fix lcms2 for mac Change-Id: If2477b9a391d75672a349ba240ceb61e0b06611a :100644 100644 6b13afd13f023cedac65a896318de4aa55dead27 6d85145f7ba0ead31c84e60a4f7ea59af07f4e83 M autogen.log :100644 100644 0063e52dfa489f0913856b4d390a6dbaf3bf7c2b 4b626e19ae2cab663f8d71d383fe61cbf4d954fd M ccache.log :100644 100644 92384a56b82df79bfe49d9b5829f20262b45cb48 e0429ebae3b3157170625d15b9f2e3a2dfe2a199 M commitmsg :100644 100644 60a70480d7fe01f507e8df9a52a826399be70704 c263d2d4d032933f70146ad485a22b6660569a9e M dev-install.log :100644 100644 7e7a596557e3553eb7c28ffa30dea1f0540e9ed5 cd8e792a15abc6fcbe35a181c280e27d5f384ba5 M make.log :040000 040000 cbe3c5d02cb655be461366d3d0facb94bf5c6043 6e626fa3ce8a5f98caeab77c01ce9ab6766dcbae M optand the output from `git bisect log` is # bad: [5b4b36d87517a6ea96ff8c84c46b12f462fc9a1a] source-hash-8450a99c744e9005f19173e4df35d65640bcf5c4 # good: [65fd30f5cb4cdd37995a33420ed8273c0a29bf00] source-hash-d6cde02dbce8c28c6af836e2dc1120f8a6ef9932 git bisect start 'latest' 'oldest' # good: [16b0b88cbd4ef0f51816e97277e40c5cf78f7bf9] source-hash-099198a4224778fe6e43f5dc13b5b9b1b4dc828c git bisect good 16b0b88cbd4ef0f51816e97277e40c5cf78f7bf9 # good: [f28b8f9a6c47fa59bf98fffe937a2f2db7a2445a] source-hash-a581d31b227623e09d2970a91214fda398f98eda git bisect good f28b8f9a6c47fa59bf98fffe937a2f2db7a2445a # good: [114fd3b76bcba890e6d702d00cef910f1493c262] source-hash-64ab96cd15e52da88781e720d6f031dbcd0ba902 git bisect good 114fd3b76bcba890e6d702d00cef910f1493c262 # bad: [47498a36f7af8f54e6e3dda89cd4708802a409e6] source-hash-19f4ebd8a54da0ae03b9cc8481613e5cd20ee1e7 git bisect bad 47498a36f7af8f54e6e3dda89cd4708802a409e6 # good: [f4e2d84db194943180f3e7ed4adce5f8e377d9bc] source-hash-806d18ae7b8c241fe90e49d3d370306769c50a10 git bisect good f4e2d84db194943180f3e7ed4adce5f8e377d9bc # good: [fb4214f9d134b556582a4a5280e5458de5f8eebd] source-hash-683758efb22d08a4cf211a6d985148f513da2a90 git bisect good fb4214f9d134b556582a4a5280e5458de5f8eebd # bad: [7b32edd2389319e0d394368c4109201528c41f7e] source-hash-44b96a2fce52b6e3e683dc917fab219cf75001db git bisect bad 7b32edd2389319e0d394368c4109201528c41f7e # good: [6095212a5bd192017c6a20ee10de26a163372e8c] source-hash-a599f5b4b51848e3b397d471c9d12b373caadcef git bisect good 6095212a5bd192017c6a20ee10de26a163372e8cOn the assumption that opening the document with nine pages even ifthe first 3 pages are blank is "good" and that opening the documentwith 1 page whether blank or showing text is "bad", bisect tells me... 5bd1638c8d760b3a646054cfa8abf69e785ddd67 is the first bad commit commit 5bd1638c8d760b3a646054cfa8abf69e785ddd67 Author: Jean-Baptiste Lallement <> Date: Tue Mar 12 16:49:53 2013 +0000 source-hash-2d907dcca7edde8cd02446cf7322556095ba447f commit 2d907dcca7edde8cd02446cf7322556095ba447f Author: Tor Lillqvist <> AuthorDate: Wed Feb 20 15:26:00 2013 +0200 Commit: Tor Lillqvist <> CommitDate: Wed Feb 20 16:43:21 2013 +0200 s/FaultBack/Fallback/ Change-Id: I9ecf4f57770151c1e4976c57d1f93982f35ac0fb :100644 100644 086733e5ccf68a2f407cf266d66741a7e95f7a13 75e2e82f87cb65723f484b40c6d2b9857c5eebda M autogen.log :100644 100644 0478bb064fc1a1d3b34f9ba8567e8f2254c541b3 376d532b2d3dd80b5590eb59a40c7541c5920674 M ccache.log :100644 100644 93177c199c9945fab789d19dcb2d066462490820 1b4e76290f0cafbcaf17728aa9b9a86220f1bb5d M commitmsg :100644 100644 2fbfe6487af073e1532ee9f2bbc93df414b4abd8 125391857546dec8cf5f7f907b4f9db2906daa99 M dev-install.log :100644 100644 d5d9e6274bf48f525142067fee62ac652f807f2f 35ec0047fe17b3b790fe514ac5753b3f557c1b9a M make.log :040000 040000 be362fc2c7b5fdd95db2287be7e5b608c295f428 c070995233ff32acaa5a362c5611e3472d103a65 M optand `git bisect log` says ... # bad: [4118d739dbd71e16057ea926ef3ef696025d3b67] source-hash-5bd6a5110bb812f82a81e73422a7b14851f84441 # good: [3e7462bd65e692bf0592d5b080b7716341b62a47] source-hash-1eddfce9894fd05315173744f495619189093dc7 git bisect start 'latest' 'oldest' # bad: [086c82fbd0a50dbf5dd28e8bcc7a6d702cea124e] source-hash-c74f2edfce221960fe546e88f2b3222d69d53598 git bisect bad 086c82fbd0a50dbf5dd28e8bcc7a6d702cea124e # good: [3367a5f4f0d1768c35ed32ac1956abf5c3ab4e0d] source-hash-cc9cd7af3beb13eede23c6c60506c6e8c329e29d git bisect good 3367a5f4f0d1768c35ed32ac1956abf5c3ab4e0d # bad: [8609688fe6682504b3e6bc675e209db988d3acc1] source-hash-de69091d34d8102c0b56194d603ed9e66699d34c git bisect bad 8609688fe6682504b3e6bc675e209db988d3acc1 # bad: [a0da7886ec5c1ecfc0b5a1e9a85a18459a764761] source-hash-a82f7b20539e60f1cf599afcceaf865bef297a66 git bisect bad a0da7886ec5c1ecfc0b5a1e9a85a18459a764761 # bad: [872ce1bed9806a36f0bec7eb1a1d09ceff38bdd6] source-hash-3d46b39491af97ba360fb92182501e6b399f4f56 git bisect bad 872ce1bed9806a36f0bec7eb1a1d09ceff38bdd6 # good: [a32a7357d8155228a87bce38c205c67b848af39c] source-hash-e0210c3ef0ed56a6b45934e2ecb5b42b99808199 git bisect good a32a7357d8155228a87bce38c205c67b848af39c # good: [3e5c28677b95d304c3f61ff27555071b2188cb79] source-hash-ae1fbbfb690cb35eae7d56ae190d637d834697aa git bisect good 3e5c28677b95d304c3f61ff27555071b2188cb79 # bad: [029bcd656063cbe8f4b84860e94a421f3556cea6] source-hash-7c351c32ea9b34f7b798c2487854753bb4693110 git bisect bad 029bcd656063cbe8f4b84860e94a421f3556cea6 # bad: [5bd1638c8d760b3a646054cfa8abf69e785ddd67] source-hash-2d907dcca7edde8cd02446cf7322556095ba447f git bisect bad 5bd1638c8d760b3a646054cfa8abf69e785ddd67***has been marked as a duplicate of this bug. ***OK in 4.0.1.2 (2013-02-28) showing 8 pages and full table when opened.Bad in 4.0.2.1 (2013-03-14) showing as just 1 page, but full table intact--just not showing.So somewhere prior to -- 4.0.2.1 (2013-03-14)commit 1696ec904079360cf35a39f403aabc49699e8844I just checked the bugdoc, this is the same situation as described here:Erm, except that here surely no wrapping would be performed, while there that's not so clear. I'll do a port of 8fe8bd6c3b5b1a539b7370f8c457fa69c061d2de for the DOCX filter, that should help here.Miklos Vajna committed a patch related to this issue.It has been pushed to "master":fdo#68607 bnc#816593 DomainMapperTableHandler: don't always start a frameThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.-4-1 review:Miklos Vajna committed a patch related to this issue.It has been pushed to "libreoffice-4-1":fdo#68607 bnc#816593 DomainMapperTableHandler: don't always start a frameIt will be available in LibreOffice 4.1.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Thanks Miklos - nice work :-)Will it also be in 4.0.x?Confirmed working correctly on master...Version: 4.2.0.0.alpha0+Build ID: 5b74c6563cfc802b5330fb82500be9d6cd835fe2TinderBox: Win-x86@39, Branch:master, Time: 2013-09-09_18:53:01Will verify agains a 4.1.3 TB when available.Thanks, Miklos!Hi Timur,Sorry, I don't think so. The fix had 5 dependent commits, I fear backporting to -4-0 would need even more dependency hunting, so ATM I don't plan to do so.MiklosMigrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=68981	CreatedLibraryPassword.ods (after step 5)HelloWhen a document (calc/writer...) contains a macro in a library protected by password and runs "thisComponent.store" instruction, the password no longer allows to open the library.Steps to Reproduce:Open the attached LibraryPassword.ods spreadsheet and continue to step 6, or follow steps 1-5 below and continue.1. File> New> Spreadsheet2. Tools> Macros> Organize> LibO Basic, click Organizer, tab Libraries, location:Untitled 1, click New, name Library1, Ok3. Click Password: foo (confirm), Ok4. Click Edit: in Module1 of Library1, create the following macro:sub MainthisComponent.storeEnd Sub5. Save the document normally (without using the macro Main) and close it.6. Reopen the document7. Tools> Macros> Run macro> LibraryPassword.ods> Library> Module1> Main.8. Tools> Macros> Organize> LibO Basic> LibraryPassword.ods> LibraryType the password (foo).Expected result: password verified and ability to editActual result: error message "Incorrect Password", access deniedRemarks:- Reproduced (fr-users) with Windows XP & 4.1.0.4- Does not occur with OpenOffice- By cons, once the password corrupted with LibreOffice, it is also rejected with OpenOffice- Does not seem to occur with 3.x releases- Bug vicious, macros always work and you can not see that the library cannot be edited- Thousands of lines of code currently inaccessible, besides the bug fix, a recovery process corrupted documents would be welcomeBest regardsPierre-Yves May be related toAdded the keyword dataloss in the summary.(This is an automated message.)Setting priority to highest as this is a 4.1 MAB. This is part of an effort to make the importance of MAB reflected in priority too.please retest against newly released LibO 4.2.4.2if issue is still there please move it to the mab4.2 listHello(In reply to)Still occurs in Version: 4.2.4.2Build ID: 63150712c6d317d27ce2db16eb94c2f3d7b699f8move to mab4.2Cannot reproduce on mastercommit 82e1456e9ae19cd536c11b2bdda7a79909269c15Author: Markus Mohrhard <>Date: Fri May 30 05:15:01 2014 +0200 remove fsanitize=address from libgetuid.so makefile Change-Id: I3d292638b76ed09d84df36d096f70c9496a23fdfwhich, in particular, has the fix for. This bugs also "smells" like a DUP of, so marking as such. Please reopen if you can reproduce with any version whereis fixed: - 4.2.5.1 (RC1):- any nightly (4.2, 4.3 or master) build after 26 May:*** This bug has been marked as a duplicate of***Migrating Whiteboard tags to Keywords: (dataloss)[NinjaEdit]
id=68983	CreatedLibraryPassword.odt (after step 5)HelloMay be related to"Save As" a document containing a macro library protected by password corrupts the password of the macro librarySteps to Reproduce:Open the attached LibraryPassword.odt document and continue to step 6, or follow steps 1-5 below and continue.1. File> New> Text document2. Tools> Macros> Organize> LibO Basic, click Organizer, tab Libraries, location:Untitled 1, click New, name Library1, Ok3. Click Password: foo (confirm), Ok4. Click Edit: in Module1 of Library1, create the following macro:sub Mainmsgbox "Hello"End Sub5. Save the document and *close it*.6. Reopen the document7. File> Save As> Test.odt 8. Tools> Macros> Organize> LibO Basic> Test.odt > Library1Type the password (foo).Expected result: password verified and ability to editActual result: error message "Incorrect Password", access deniedRemarks: Bug vicious, macros always work and you can not see that the library cannot be editedBest regardsPierre-Yves HelloStill occurs on windows 7 with Version: 4.1.3.1Build ID: b42498da0e3f91b17e51b55c8295ec4f8f22087RegardsPierre-YvesReported in AOO Spanish forum:(This is an automated message.)Setting priority to highest as this is a 4.1 MAB. This is part of an effort to make the importance of MAB reflected in priority too.Still occurs on ubuntu 14.04 with Version: 4.2.4.1Build ID: d4c441391e20647b3d2e8dde4d20aa868e77e515moving to the mab4.2 list since 4.1.x is end of liferegression in LO 4.0.4.2 from:commit c2816cf4b51fd84aa530653acaa48112bb55a4a6Author: Noel Power <>AuthorDate: Wed May 8 20:48:22 2013 +0100 hopefully this fixed the strange autorecovery related dataloss fdo#42899 this is looking pretty bad, the META-INF/manifest.xml is missingthe encryption data ... actually it is missing the whole entry for Module1.xml <manifest:file-entry manifest:full-path="Basic/Standard/script-lb.xml" manifest:media-type="text/xml"/> <manifest:file-entry manifest:full-path="Basic/script-lc.xml" manifest:media-type="text/xml"/> <manifest:file-entry manifest:full-path="Basic/Library1/Module1.bin" manifest:media-type=""/> <manifest:file-entry manifest:full-path="Basic/Library1/script-lb.xml" manifest:media-type="text/xml"/>is a possibly patch, seems to work on a quick test, I'd love if someone could give this a really good whirl (in particular with other saving scenarios (e.g. mixed libraries and/or dialogs etc.) unfortunately these days my time is limited :/Michael Stahl committed a patch related to this issue.It has been pushed to "master":fdo#68983: Revert "remove #if 0 block (from ...The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "master":fdo#68983: basic: if the library is not loaded fully, copy source storageThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#68983: Revert "remove #if 0 block (from ...It will be available in LibreOffice 4.2.5.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#68983: basic: if the library is not loaded fully, copy source storageIt will be available in LibreOffice 4.2.5.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-4-3":fdo#68983: Revert "remove #if 0 block (from ...It will be available in LibreOffice 4.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-4-3":fdo#68983: basic: if the library is not loaded fully, copy source storageIt will be available in LibreOffice 4.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.lost track of this one...so this was fixed by reverting the previous fix for,which introduced this bug, and also the fix forwhich was also introduced by the reverted commit, andfixingdifferently, quite similar to what Noelproposed in(but slightly differently, sincei actually wrote that commit before reading Noel's comment).***has been marked as a duplicate of this bug. ***HiVerified WORKSFORME on Windows 7/64 & Version: 4.2.5.1Build ID: 881bb88abfe2992c6cede97c23e64a9885de87deI confirm it also solvesThank you :)RegardsPierre-Yves
id=69517	Windows XP 64-bit EditionWin-x86@39/master~2013-09-18_08.18.05_LibreOfficeDev_4.2.0.0.alpha0_Win_x86.msi: Vendor=tinderbox MsiProductVersion=4.2.0.0.alpha0 ProductCode={E814501C-32CE-4958-A93A-24AFB27F3364} buildid=125769a4a15cf6f4b9ef9d0e757ac55bd9e26509--LibreOfficeDev-4.2.0.0 cannot start.Error message: soffice.exe - Entry Point Not Found The procedure entry point GetTickCount64 could not be located in the dynamic link library KERNEL32.dll.-- It turns out that in 32-bit library is searching for 64-bit entry point procedure. This is a critical error, because the new ‘Win-x86@6-debug’ daily builds don't publish from September 6. GetTickCount64 function available only in Windows Vista and up. Source:(In reply to)--Thanks, But there is no information on the exclusion of Windows XP from the list of supported operating systems. Therefore, I confirm the status "critical" for this bug. Most likely the error is caused by building a package on a computer with Windows-7/8.(In reply to)From what I understand, the list of supported platforms is for released versions, not for daily builds.Probably It was caused by using Windows SDK 8, which doesn't support building for WinXP. See(In reply to)--Maxim, the question about the operating system arises whenever there is no log assembly. The Win-x86@39 does not contain such the file (build-name_build_info.txt). I have to guess what is the reason for the failure start.--ape(In reply to)Something like?(In reply to)As you can see from that log (line 34), it uses Visual C++ 2012, which comes with SDK 8.0 according to.Also according to, Visual Studio 2012 Update 1 contains a repacked version of previous SDK (7.1) which can be used with VC 2012 to target WinXP.Maxim, thank You.Kendy…History and Memory suggests to me that NT-5.1\2 did not have a chance of success. We'll have to wait for the beta.ape@Maxim, Kendy:Sorry, that's my confusion. I found the Assembly log file, which specifies to use MSVCR-2012u1. The LibreOfficeDev-4.2.0.0_ Win-x86@39 runs on Windows XP 32\64-bit after installing MSVCR-2012 update3. So is FIXED.--ape@Kendy,A bit late, but got around today to doing an /A administrative install of TB 39 Windows build of master onto a 32-bit Windows XP sp3Version: 4.2.0.0.alpha0+Build ID: 0d0d3a0540dad2d0f417e21df1183dfc33964357TinderBox: Win-x86@39, Branch:master, Time: 2013-09-30_23:58:26I'd installed the Microsoft Visual C++ 2012 Redistributable (x86), 11.0.60610.1, signed June 10 2013.But on launch I am receiving error:soffice.exe - Entry Point Not FoundThe procedure entry point GetTickCount64 could not be located in the dynamic link library KERNEL32.dllLooks to be the same issue as OP, but on 32-bit XP. So question if the TB 39 build system has the Visual Studio Update 3 apparently needed to support Windows XP builds, and if the _WIN32_WINNT declaration is set correctly? Should we be able to run this on 32-bit Windows XP? If so what C++ runtime is needed if not the Visual C++ Redistributable for Visual Studio 2012 Update 3 available at:Is it really worth it to have a bug open for something that is not an error in the source code, and not an error in an official build, but just a suboptimal configuration of a tinderbox? Where do we promise that tinderbox builds would be usable on XP?Markus provides a hint on building in a note to the Dev list.need to build with "--with-windows-sdk=7.1A" flagLooking at the full build logs suggests that is not yet happening for the TB 39 builds of master.(In reply to)Sorry but if the "fix" is as simple as a compiler flag (or a compiler version upgrade), then tracking the issue in BZ certainly is appropriate and in the best interest of the project. This is especially true for the Windows and OS X builds where substantive QA and UX feedback will only occur if the project infrastructure provides functional TB builds for testing.While it is common place for folks on Linux to roll their own--not at all so for the Windows or OS X user community.(In reply to)Nowhere. But it is frequently asked to QA people to start testing Master builds as soon as possible in order to report bugs early in development.Of course if TDF prefers to ignore Windows XP or exclude it from early testing it just needs to say so.@: Pedro; V Stuart Foote I changed the status to "fixed" because the TDF has not defined any member of the Community (for example, Luboš or Fridrich) having a computer with the necessary configuration, as one of the builders of the MSI package. I think that we have no right to demand that the volunteers replaced programs on their computers in order to satisfy our interests.Best regards, ape@ape, you neglected to actually set the issue to fixed.But that aside, TB 39 is TDF owned hardware issued/loaned to Kendy for TinderBox build needs. Maintaining it is a volunteer effort as always--which he's done with finesse. Also, a read of the TB Status page and logs () shows today's posted 2013-10-03 7:14 TB 39 build was not built with the "--with-windows-sdk=7.1A" compile flag; but the 2013-10-03 10:51 build was. Meaning that later today or tomorrow at the latest we will know if the issue has been fully resolved with a working build for 32-bit Windows XP.When available we can check out the build and then correctly close this incident.StuartOn Windows XP sp3 32-bit as guest OS in VMWare WorkstationVersion: 4.2.0.0.alpha0+Build ID: 050248fea53adb6a14b649c5f84dd69a8faff997TinderBox: Win-x86@39, Branch:master, Time: 2013-10-04_08:16:05This TB 39 build of master installs and runs without issue.Setting Resolved Fixed.LibO-Dev_4.2.0.0.alpha0+ (ID: 050248fea53adb6a14b649c5f84dd69a8faff997, TinderBox: Win-x86@39, Time: 2013-10-04_08:16:05) started on Windows XP 64-bit sp2 (last update).
id=70355	CreatedExample of bug described.See attached document.Open the document in LibreOffice 3.6 to see the graphs as they should be. Open the document in versions 4.0, 4.1, or 4.2 and the x/y axis of the data tables will be reversed causing the graphs to show incorrect data.For example, if you were looking at it as if it were a spreadsheet, everything from Row 1 is put into Column A, everything from Row 2 is put into Column B, and so on. After further testing, exporting the document to pdf or saving as a doc also seems to distort the graphs (even in 3.6).Is it possible to show a screenshot showing the difference between both LibreOffice versions?I can't see anything wrong using Mac OSX 10.8.5 with LibreOffice Version: 4.1.2.3Build ID: 40b2d7fde7e8d2d7bc5a449dc65df4d08a7dd38All charts/graphs looks correct (and logical) to me.Kind regards,JorenCreatedScreenshot of data table from 3rd bar graph in document (Bad, version 4.0-4.2)Screenshot of data table from 3rd bar graph in document (Bad, version 4.0-4.2)CreatedScreenshot of data table from 3rd bar graph in document (Good, version 3.6)Screenshot of data table from 3rd bar graph in document (Good, version 3.6)Screenshots of an example data table added. No edits have been made, this is the same document, just opened in different LibreOffice versions.CreatedScreenshot of 3rd bar graph in document (Bad, version 4.0-4.2)Screenshot of 3rd bar graph in document (Bad, version 4.0-4.2)CreatedScreenshot of 3rd bar graph in document (Good, version 3.6)Screenshot of 3rd bar graph in document (Good, version 3.6)Added screenshots of the bar graph itself. Notice that the bar graph remains valid; however, the data has been rearranged as described in the original post.Thanks for your extra screenshots and information!I can reproduce this behavior, tested using LibreOffice 4.1.2.3 in comparison with Version 3.6.0.4 (Build ID: 932b512); Using Mac OSX 10.8.5Adding Calc/chart experts, because I think this is a regression in the Chart-component.@Joel: what do you think about the priority of this bug? Looks to me definitely MAB4.0, not sure about the priority.Kind regards,JorenCreatedScreenshot in Version 4.0.6.1This is what I see inWin7x64 UltimateVersion 4.0.6.1 (Build ID: 7168152d13aa529ba3718c9ae3700216a574137)I am not in an error is the same as in 3.6Hm since it's been around since 4.0.0.3 and we've had releases since then, IMHO not a blocker but I'm happy with it being a critical bug since it's affecting a very common feature + it's a regression. Markus - let us know if you want a bibisectAn interesting issue - of course a bisect is always useful for a regression; Muthu has done most work in the chart world in recent times though Markus is now doing a chunk of work there ...There is no change on top of my mind that could bring this regression.Yes, a bisect would be really helpful.There is one change in the embedded object handling coming from the AOO rebase that is most likely related.Sadly we can't revert this patch but it changes the initialization order of chart objects which makes some of the import hacks in the chart uno implementation fail. I have looked into it before and fixed one that was similar for calc but there are surely more issues related to this change out there.From `git bisect`: 305763174e4eed88f03bba7df1276cdf26be9a0c is the first bad commit ... commit bb5196b40cc5f8f2d4f221e61a20d572ce504558 ...and from `git bisect log`: # bad: [d31848bf3b700a22d127d7c775a0f910a7e133d0] source-hash-86cbe18a6143bf054c31f69dc97368dfdd3ad374 # good: [3e7462bd65e692bf0592d5b080b7716341b62a47] source-hash-1eddfce9894fd05315173744f495619189093dc7 git bisect start 'latest' 'oldest' # good: [578fb08152ad11454e2f09ad6f8c8e527da817de] source-hash-4e3e171262aed0e52fa76158950d5be770249e80 git bisect good 578fb08152ad11454e2f09ad6f8c8e527da817de # bad: [efb04c1c794ef7fc4cda1eb80880d333ca969a5e] source-hash-7908692490120350f2ad45241f7b19ba52dc0489 git bisect bad efb04c1c794ef7fc4cda1eb80880d333ca969a5e # good: [b46b5a58fcaec85eefb31b23afb0fc389a0c5334] source-hash-34c1b7bdd0bca4753f66a7d17ef46647a64a319e git bisect good b46b5a58fcaec85eefb31b23afb0fc389a0c5334 # good: [3791268ce3e6f9e570f02c09d586fd8e9f2485c3] source-hash-51daa4de4fbb86903aeb9cdfefbb089e8d00c001 git bisect good 3791268ce3e6f9e570f02c09d586fd8e9f2485c3 # bad: [8f14f077f5faef9b7660ddf5ebcd188eb3042372] source-hash-dd5c0b2db451ff4d6fac7a72770758513583d468 git bisect bad 8f14f077f5faef9b7660ddf5ebcd188eb3042372 # good: [f066d428aeb365ac57d1863b9a574d82cddec974] source-hash-c99b97d306211fe346a7d0a5208aa99118208fc5 git bisect good f066d428aeb365ac57d1863b9a574d82cddec974 # bad: [a2f22aae2d4c64e7426980214bc9e63237223647] source-hash-83f77ab0661df992f241e5f9ecb1aa8f8eaeafec git bisect bad a2f22aae2d4c64e7426980214bc9e63237223647 # bad: [305763174e4eed88f03bba7df1276cdf26be9a0c] source-hash-bb5196b40cc5f8f2d4f221e61a20d572ce504558 git bisect bad 305763174e4eed88f03bba7df1276cdf26be9a0c # good: [08a8f062763014582190ae8742fabc657cfa9078] source-hash-e67c21ee0696cde7538016a813a5cbf39fb803b0 git bisect good 08a8f062763014582190ae8742fabc657cfa9078Thanks Terrence :)!Range:(In reply to)This one? :Looks indeed very related (title = transpose, what actually happened here).Dangit :)Kind regards,JorenCommit 14fa5488a829936275f79a7693b13da55114220e was reverted by Markus in 2013-11-02 19 -->Not reproducible in 4.1.4 nor 4.2.0Should we close it?Since the commit that was reverted was identified - going to mark as FIXED.Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=70805	Load the attached, edit the data chart - remove the last empty line, save, reload - notice the chart is mashed again :-) Createdtest document ...Affects 4.1 as well.***has been marked as a duplicate of this bug. ***(This is an automated message.)Setting priority to highest as this is a 4.1 MAB. This is part of an effort to make the importance of MAB reflected in priority too.please retest under 4.2.x and move to mab4.2 list if bug is still present since 4.1.x is EOLReviewed on Windows 7 sp1, 64-bit withVersion: 4.2.2.1Build ID: 3be8cda0bddd8e430d8cda1ebfd581265cca5a0fand also a recent dev build of 4.3.0alpha1+ masterVersion: 4.3.0.0.alpha1+Build ID: 45c89d62b527abec07072074484bd596ab1aa04aTinderBox: Win-x86@39, Branch:master, Time: 2014-05-15_02:54:28and attachment toChart seems correctly formatted for both.Setting Resolved WFM.@Michael M., closing OK?
id=68906	Problem description: I have done a clean reinstall of OSX 10.8.4 and noticed some problems since the time.I have a PPTX presentations (3 slides) which I try to open, then I try to add new slide and the Libre Office is gone.The most important thing here is: the presentations contains 3 slides, a title slide and 2 normal slides. I can add another title slide (with I right-click between slide number 1 (title) and 2). But it crashes while clicking between 2nd and 3rd slide on at the end.I tried to reinstall it - no luck. I tried the same file on my second MacBook (with the same OSX) and it works pretty well.The same occurs while pasting the whole page ofand scrolling it down. Well it sometimes occurs unexptected quits or just paste 3-4 pages instead of everything.I would like to share the PPTX file however it's company related so I would like to send it to someone, just not to publish it on the Internet. Please contact me for the file.Summary about a hardware:MacBookPro 13 Early 20112.7 GHz i7 + 16GB 1333MHz DDR3 + Intel HD3000I'm pasting a report from OSX:Process: soffice [1762]Path: /Applications/LibreOffice.app/Contents/MacOS/sofficeIdentifier: org.libreoffice.scriptVersion: 4.1.1.2 (???)Code Type: X86 (Native)Parent Process: launchd [135]User ID: 501Date/Time: 2013-09-03 21:17:47.155 +0200OS Version: Mac OS X 10.8.4 (12E55)Report Version: 10Interval Since Last Report: 852215 secCrashes Since Last Report: 7Per-App Crashes Since Last Report: 3Anonymous UUID: D522DC0A-D612-669D-9A03-76A7FA623174Crashed Thread: 0 Dispatch queue: com.apple.main-threadException Type: EXC_BAD_ACCESS (SIGBUS)Exception Codes: KERN_PROTECTION_FAILURE at 0x0000000000000000VM Regions Near 0:--> __PAGEZERO 0000000000000000-0000000000001000 [ 4K] ---/--- SM=NUL /Applications/LibreOffice.app/Contents/MacOS/soffice __TEXT 0000000000001000-0000000000002000 [ 4K] r-x/rwx SM=COW /Applications/LibreOffice.app/Contents/MacOS/sofficeThread 0 Crashed:: Dispatch queue: com.apple.main-thread0 libbasegfxlo.dylib 0x035685f4 basegfx::B2DPolyPolygon::operator=(basegfx::B2DPolyPolygon const&) + 201 libsvxcorelo.dylib 0x0d9e9db5 SdrTextObj::ImpSetContourPolygon(SdrOutliner&, Rectangle&, unsigned char) const + 4212 libsvxcorelo.dylib 0x0d9ea369 SdrTextObj::TakeTextRect(SdrOutliner&, Rectangle&, bool, Rectangle*, bool) const + 12573 libsvxcorelo.dylib 0x0d9e8fb0 SdrTextObj::ImpSetupDrawOutlinerForPaint(bool, SdrOutliner&, Rectangle&, Rectangle&, Rectangle&, Fraction&) const + 4964 libsvxcorelo.dylib 0x0d9e93b4 SdrTextObj::UpdateOutlinerFormatting(SdrOutliner&, Rectangle&) const + 2765 libsvxcorelo.dylib 0x0db02f0b SvxTextEditSourceImpl::SetupOutliner() + 1396 libsvxcorelo.dylib 0x0db040f6 SvxTextEditSourceImpl::GetBackgroundTextForwarder() + 10627 libeditenglo.dylib 0x0d5db8b9 SvxEditSourceAdapter::GetTextForwarderAdapter() + 418 libsvxlo.dylib 0x0f2df208 accessibility::AccessibleTextHelper_Impl::GetTextForwarder() const + 4409 libsvxlo.dylib 0x0f2e0c46 accessibility::AccessibleTextHelper_Impl::SetEditSource(std::auto_ptr<SvxEditSource>) + 8610 libsvxlo.dylib 0x0f2e0cda accessibility::AccessibleTextHelper::SetEditSource(std::auto_ptr<SvxEditSource>) + 4211 libsvxlo.dylib 0x0f2e0d77 accessibility::AccessibleTextHelper::AccessibleTextHelper(std::auto_ptr<SvxEditSource>) + 10312 libsvxlo.dylib 0x0f2d9349 accessibility::AccessibleShape::Init() + 88913 libsvxlo.dylib 0x0f2e45b5 accessibility::ChildrenManagerImpl::GetChild(accessibility::ChildDescriptor&, long) + 32514 libsvxlo.dylib 0x0f2e4710 accessibility::ChildrenManagerImpl::CreateAccessibilityObjects(std::vector<accessibility::ChildDescriptor, std::allocator<accessibility::ChildDescriptor> >&) + 12815 libsvxlo.dylib 0x0f2e7ea2 accessibility::ChildrenManagerImpl::Update(bool) + 45016 libsdlo.dylib 0x0eb54aa3 accessibility::AccessibleDrawDocumentView::propertyChange(com::sun::star::beans::PropertyChangeEvent const&) + 64317 libuno_cppuhelpergcc3.dylib.3 0x0037accf cppu::OPropertySetHelper::fire(long*, com::sun::star::uno::Any const*, com::sun::star::uno::Any const*, long, unsigned char) + 147118 libsdlo.dylib 0x0ed56029 sd::DrawController::FirePropertyChange(long, com::sun::star::uno::Any const&, com::sun::star::uno::Any const&) + 5719 libsdlo.dylib 0x0ed5882d sd::DrawController::FireSwitchCurrentPage(SdPage*) + 54120 libsdlo.dylib 0x0ee1304b sd::DrawViewShell::SwitchPage(unsigned short) + 338721 libsdlo.dylib 0x0ee25963 sd::DrawViewShell::ExecCtrl(SfxRequest&) + 366722 libsfxlo.dylib 0x0082c3a8 SfxDispatcher::Call_Impl(SfxShell&, SfxSlot const&, SfxRequest&, unsigned char) + 36023 libsfxlo.dylib 0x0082c8b8 SfxDispatcher::PostMsgHandler(SfxRequest*) + 29624 libsfxlo.dylib 0x0078e849 SfxHintPoster::LinkStubDoEvent_Impl(void*, void*) + 2525 libvcllo.dylib 0x01a55acd ImplWindowFrameProc(Window*, SalFrame*, unsigned short, void const*) + 633326 libvcllo.dylib 0x01a629d8 AquaSalInstance::Yield(bool, bool) + 31227 libvcllo.dylib 0x01723d94 Application::Yield(bool) + 8428 libvcllo.dylib 0x01723e4c Application::Execute() + 6029 libsofficeapp.dylib 0x0006f29a desktop::Desktop::Main() + 764230 libvcllo.dylib 0x0172a1f2 ImplSVMain() + 22631 libvcllo.dylib 0x01a61a21 AquaSalInstance::handleAppDefinedEvent(NSEvent*) + 12932 libvcllo.dylib 0x01a9dcfb -[VCL_NSApplication sendEvent:] + 31533 com.apple.AppKit 0x9206062c -[NSApplication run] + 95134 com.apple.AppKit 0x920035f6 NSApplicationMain + 105335 libvcllo.dylib 0x01a622e7 ImplSVMainHook(int*) + 34336 libvcllo.dylib 0x0172a22a SVMain() + 2637 libsofficeapp.dylib 0x0009d765 soffice_main + 32538 org.libreoffice.script 0x00001f4e main + 3039 org.libreoffice.script 0x00001f25 start + 53Thread 1:0 libsystem_kernel.dylib 0x91ce18e2 __psynch_cvwait + 101 libsystem_c.dylib 0x99465280 _pthread_cond_wait + 8332 libsystem_c.dylib 0x994eb0e0 pthread_cond_timedwait$UNIX2003 + 703 libuno_sal.dylib.3 0x000149bb rtl_cache_wsupdate_all(void*) + 2514 libsystem_c.dylib 0x994605b7 _pthread_start + 3445 libsystem_c.dylib 0x9944ad4e thread_start + 34Thread 2:0 libsystem_kernel.dylib 0x91ce20ee __workq_kernreturn + 101 libsystem_c.dylib 0x994630ac _pthread_workq_return + 452 libsystem_c.dylib 0x99462e79 _pthread_wqthread + 4483 libsystem_c.dylib 0x9944ad2a start_wqthread + 30Thread 3:: Dispatch queue: com.apple.libdispatch-manager0 libsystem_kernel.dylib 0x91ce29ae kevent + 101 libdispatch.dylib 0x945cec71 _dispatch_mgr_invoke + 9932 libdispatch.dylib 0x945ce7a9 _dispatch_mgr_thread + 53Thread 4:0 libsystem_kernel.dylib 0x91ce20ee __workq_kernreturn + 101 libsystem_c.dylib 0x994630ac _pthread_workq_return + 452 libsystem_c.dylib 0x99462e79 _pthread_wqthread + 4483 libsystem_c.dylib 0x9944ad2a start_wqthread + 30Thread 5:0 libsystem_kernel.dylib 0x91ce20ee __workq_kernreturn + 101 libsystem_c.dylib 0x994630ac _pthread_workq_return + 452 libsystem_c.dylib 0x99462e79 _pthread_wqthread + 4483 libsystem_c.dylib 0x9944ad2a start_wqthread + 30Thread 6:0 libsystem_kernel.dylib 0x91ce20ee __workq_kernreturn + 101 libsystem_c.dylib 0x994630ac _pthread_workq_return + 452 libsystem_c.dylib 0x99462e79 _pthread_wqthread + 4483 libsystem_c.dylib 0x9944ad2a start_wqthread + 30Thread 7:0 libsystem_kernel.dylib 0x91ce0e9a __accept + 101 libuno_sal.dylib.3 0x0000787a osl_acceptPipe + 582 libsofficeapp.dylib 0x0009b6f4 desktop::OfficeIPCThread::execute() + 2763 libuno_salhelpergcc3.dylib.3 0x004e3be2 salhelper::Thread::run() + 344 libuno_salhelpergcc3.dylib.3 0x004e3ef2 threadFunc + 185 libuno_sal.dylib.3 0x0000e54e osl_thread_start_Impl + 3986 libsystem_c.dylib 0x994605b7 _pthread_start + 3447 libsystem_c.dylib 0x9944ad4e thread_start + 34Thread 8:0 libsystem_kernel.dylib 0x91ce1b3e __recvfrom + 101 libsdlo.dylib 0x0ee8f3dd sd::DiscoveryService::run() + 2532 libsdlo.dylib 0x0ee8ee52 threadFunc + 183 libuno_sal.dylib.3 0x0000e54e osl_thread_start_Impl + 3984 libsystem_c.dylib 0x994605b7 _pthread_start + 3445 libsystem_c.dylib 0x9944ad4e thread_start + 34Thread 9:0 libsystem_kernel.dylib 0x91ce18e2 __psynch_cvwait + 101 libsystem_c.dylib 0x99465280 _pthread_cond_wait + 8332 libsystem_c.dylib 0x994eb0e0 pthread_cond_timedwait$UNIX2003 + 703 libuno_sal.dylib.3 0x0002eb08 osl_waitCondition + 2804 libupdchk.dylib 0x0fb1c550 (anonymous namespace)::InitUpdateCheckJobThread::run() + 1445 libupdchk.dylib 0x0fb0ec22 threadFunc + 186 libuno_sal.dylib.3 0x0000e54e osl_thread_start_Impl + 3987 libsystem_c.dylib 0x994605b7 _pthread_start + 3448 libsystem_c.dylib 0x9944ad4e thread_start + 34Thread 10:0 libsystem_kernel.dylib 0x91ce18e2 __psynch_cvwait + 101 libsystem_c.dylib 0x99465280 _pthread_cond_wait + 8332 libsystem_c.dylib 0x994eb095 pthread_cond_wait$UNIX2003 + 713 libuno_sal.dylib.3 0x0002ea52 osl_waitCondition + 984 liblnglo.dylib 0x0e71e029 GrammarCheckingIterator::DequeueAndCheck() + 4255 libuno_sal.dylib.3 0x0000e54e osl_thread_start_Impl + 3986 libsystem_c.dylib 0x994605b7 _pthread_start + 3447 libsystem_c.dylib 0x9944ad4e thread_start + 34Thread 0 crashed with X86 Thread State (32-bit): eax: 0x117a6130 ebx: 0xbfffe85c ecx: 0x117cc3f6 edx: 0x00000000 edi: 0x117a1ea0 esi: 0x00000000 ebp: 0xbfffe808 esp: 0xbfffe7e0 ss: 0x00000023 efl: 0x00010202 eip: 0x035685f4 cs: 0x0000001b ds: 0x00000023 es: 0x00000023 fs: 0x00000000 gs: 0x0000000f cr2: 0x00000000Logical CPU: 2Binary Images: 0x1000 - 0x1ff7 +org.libreoffice.script (4.1.1.2 - ???) <7063B240-8402-F175-FA30-FCCBBAE4F702> /Applications/LibreOffice.app/Contents/MacOS/soffice 0x5000 - 0x42ff7 +libuno_sal.dylib.3 (0) <28B6C94E-7ACF-7B46-661B-99A0FB93EF20> /Applications/LibreOffice.app/Contents/ure-link/lib/libuno_sal.dylib.3 0x5e000 - 0xceff7 +libsofficeapp.dylib (0) <E7D32E64-41F8-FEA5-1CF5-BDD6EA73AD91> /Applications/LibreOffice.app/Contents/MacOS/libsofficeapp.dylib 0xf8000 - 0x221ff7 +libcomphelper.dylib (0) <E3FEDA2D-BA45-5FEA-F591-AEC7085F234B> /Applications/LibreOffice.app/Contents/MacOS/libcomphelper.dylib 0x2e1000 - 0x30ffe7 +libuno_cppu.dylib.3 (0) <49F2A085-B9FB-CD7A-FA93-D61CA47D78C6> /Applications/LibreOffice.app/Contents/ure-link/lib/libuno_cppu.dylib.3 0x31d000 - 0x3f3feb +libuno_cppuhelpergcc3.dylib.3 (0) <E3B36958-FD99-6E20-7881-515404BB2CC9> /Applications/LibreOffice.app/Contents/ure-link/lib/libuno_cppuhelpergcc3.dylib.3 0x46d000 - 0x496fff +libdeploymentmisclo.dylib (0) <3BD72668-E5D7-9BA8-8A35-208C9BD5DE02> /Applications/LibreOffice.app/Contents/MacOS/libdeploymentmisclo.dylib 0x4ad000 - 0x4ccfe7 +libi18nlangtag.dylib (0) <7FF6D787-55CC-B5B4-F11B-B12B02350C43> /Applications/LibreOffice.app/Contents/MacOS/libi18nlangtag.dylib 0x4e2000 - 0x4e5ff7 +libuno_salhelpergcc3.dylib.3 (0) <79CA1052-FF5A-AD0F-9E9F-85CAF92F80C5> /Applications/LibreOffice.app/Contents/ure-link/lib/libuno_salhelpergcc3.dylib.3 0x4ea000 - 0x916ff7 +libsfxlo.dylib (0) <50B60D2E-7088-64F3-7A00-D4AF02582064> /Applications/LibreOffice.app/Contents/MacOS/libsfxlo.dylib 0xaed000 - 0xbbcffb +libsvllo.dylib (0) <9ECD0BD1-FC7E-CE2B-8A18-1EBC67B99ECD> /Applications/LibreOffice.app/Contents/MacOS/libsvllo.dylib 0xc1d000 - 0xec6ff3 +libsvtlo.dylib (0) <C4DCD18A-AD2B-A71F-B26E-3DB6455F4130> /Applications/LibreOffice.app/Contents/MacOS/libsvtlo.dylib 0x1043000 - 0x12a4fe3 +libtklo.dylib (0) <2C31C37C-1DA8-2F07-6E06-D3DA288822B4> /Applications/LibreOffice.app/Contents/MacOS/libtklo.dylib 0x147c000 - 0x14dfff3 +libtllo.dylib (0) <63F03533-F14C-7CC4-5FD1-90CC8B943953> /Applications/LibreOffice.app/Contents/MacOS/libtllo.dylib 0x1501000 - 0x155efeb +libucbhelper.dylib (0) <789425E1-1A1A-FAC1-F506-5FA3A098E8E4> /Applications/LibreOffice.app/Contents/MacOS/libucbhelper.dylib 0x159a000 - 0x169cff7 +libutllo.dylib (0) <3C1EFD51-A10F-3115-26B1-4FA4FE305C6A> /Applications/LibreOffice.app/Contents/MacOS/libutllo.dylib 0x170b000 - 0x1bbffef +libvcllo.dylib (0) <AD7C30AC-F867-6C15-0F93-39140ED438E1> /Applications/LibreOffice.app/Contents/MacOS/libvcllo.dylib 0x1d34000 - 0x1e46ffb +libicuuc.dylib.51 (51.1) <098EE8FF-1E64-840D-63BE-822C733EA592> /Applications/LibreOffice.app/Contents/MacOS/libicuuc.dylib.51 0x1e98000 - 0x33dfff7 +libicudata.dylib.51 (51.1) <41B482A1-9D85-40E9-B442-BC59EBCD8A9B> /Applications/LibreOffice.app/Contents/MacOS/libicudata.dylib.51 0x33e1000 - 0x33f7ff3 +libreg.dylib (0) <D6DACB83-2D3C-19A0-354D-4F081440DBA4> /Applications/LibreOffice.app/Contents/ure-link/lib/libreg.dylib 0x33ff000 - 0x3427ff7 +libunoidl.dylib (0) <A0A226D1-B811-D42C-4ED3-2D303DF1263E> /Applications/LibreOffice.app/Contents/ure-link/lib/libunoidl.dylib 0x3430000 - 0x3438ff3 +libxmlreader.dylib (0) <9FD9C556-7457-CD24-5C1A-C57794E8EAA0> /Applications/LibreOffice.app/Contents/ure-link/lib/libxmlreader.dylib 0x343d000 - 0x3457ff3 +libstore.dylib (0) <FB748704-FE8E-A317-33CB-DF6B8850F2A3> /Applications/LibreOffice.app/Contents/ure-link/lib/libstore.dylib 0x3460000 - 0x34fafeb +libxmlscriptlo.dylib (0) <D202E335-DCF0-D57A-5B32-7B77E98DCDF7> /Applications/LibreOffice.app/Contents/MacOS/libxmlscriptlo.dylib 0x3528000 - 0x35beffb +libbasegfxlo.dylib (0) <1CA55292-72B1-25D8-2E1F-E316998E2113> /Applications/LibreOffice.app/Contents/MacOS/libbasegfxlo.dylib 0x35e0000 - 0x3705ffb +libdrawinglayerlo.dylib (0) <404E89DB-C357-142B-8806-0A6A0E157EB4> /Applications/LibreOffice.app/Contents/MacOS/libdrawinglayerlo.dylib 0x3789000 - 0x380dfff +libfwelo.dylib (0) <1EB85CC4-A140-C9B1-FC08-4B50CC64FDB9> /Applications/LibreOffice.app/Contents/MacOS/libfwelo.dylib 0x384e000 - 0x3863fe7 +libsaxlo.dylib (0) <D0FED58F-4CEB-B772-F40C-349C559548BB> /Applications/LibreOffice.app/Contents/MacOS/libsaxlo.dylib 0x3870000 - 0x39ccff3 +libsblo.dylib (0) <E14749FF-B1E1-9DAF-57EE-D7D499E1C311> /Applications/LibreOffice.app/Contents/MacOS/libsblo.dylib 0x3a5c000 - 0x3ab0ff7 +libsotlo.dylib (0) <CAC2DAE1-F9B0-2824-7F9D-5E5DBEE824C7> /Applications/LibreOffice.app/Contents/MacOS/libsotlo.dylib 0x3ad4000 - 0x3b04ffb +libcanvastoolslo.dylib (0) <BC033AEB-BEAC-3EB8-4AD7-9E9D8034B1B5> /Applications/LibreOffice.app/Contents/MacOS/libcanvastoolslo.dylib 0x3b22000 - 0x3b73fff +libcppcanvaslo.dylib (0) <F9B92117-832C-4B2E-4694-CE34D4A00851> /Applications/LibreOffice.app/Contents/MacOS/libcppcanvaslo.dylib 0x3b93000 - 0x3bcdfef +libnspr4.dylib (1) <559B1E9B-C26F-8CF3-5C3F-ECE5424F9211> /Applications/LibreOffice.app/Contents/MacOS/libnspr4.dylib 0x3bf4000 - 0x3d36ff7 +libnss3.dylib (1) <16D48199-01B7-AA8B-F39B-AF988F1ED709> /Applications/LibreOffice.app/Contents/MacOS/libnss3.dylib 0x3dd2000 - 0x3df7fe7 +libsmime3.dylib (1) <03606FBA-D239-3128-98D7-3E5DBAE8C2A9> /Applications/LibreOffice.app/Contents/MacOS/libsmime3.dylib 0x3e16000 - 0x3e25fe3 +libi18nutil.dylib (0) <C52E6382-3AFE-6EC5-AC55-54107F805D1D> /Applications/LibreOffice.app/Contents/MacOS/libi18nutil.dylib 0x3e2f000 - 0x3e32ffb +libjvmaccess.dylib (0) <3CA80193-0590-3457-EA1F-2581B818DA80> /Applications/LibreOffice.app/Contents/ure-link/lib/libjvmaccess.dylib 0x3e38000 - 0x3e7bfff +libicule.dylib.51 (51.1) <9F622B22-9BF7-AE1F-86D1-D725824C93BB> /Applications/LibreOffice.app/Contents/MacOS/libicule.dylib.51 0x3e90000 - 0x3ecbfe7 +liblcms2.2.dylib (3.4) <B80EA706-4FD3-26C6-05FC-14C0633AB143> /Applications/LibreOffice.app/Contents/MacOS/liblcms2.2.dylib 0x3eeb000 - 0x3ef0ff7 +libAppleRemotelo.dylib (0) <04144F23-77B9-DB83-1667-9DEC13A89247> /Applications/LibreOffice.app/Contents/MacOS/libAppleRemotelo.dylib 0x3ef6000 - 0x3f11fe7 +libnssutil3.dylib (1) <A90477B2-DFF2-BF15-4095-9D7C3F02E483> /Applications/LibreOffice.app/Contents/MacOS/libnssutil3.dylib 0x3f29000 - 0x3f2ffff +libplc4.dylib (1) <0A1891B3-A5ED-54E3-E8BD-BF2672C8E4C2> /Applications/LibreOffice.app/Contents/MacOS/libplc4.dylib 0x3f38000 - 0x3f3efff +libplds4.dylib (1) <67AFE497-41E6-14E3-D411-680C56836A22> /Applications/LibreOffice.app/Contents/MacOS/libplds4.dylib 0x3f46000 - 0x3f5eff7 +libjvmfwk.dylib (0) <8CF28181-1A9E-F658-303E-2DDB9EDB6D5A> /Applications/LibreOffice.app/Contents/ure-link/lib/libjvmfwk.dylib 0x3f66000 - 0x3f93ff3 +libfwilo.dylib (0) <A03523DB-6A20-F13D-FABF-462E56C9F0C3> /Applications/LibreOffice.app/Contents/MacOS/libfwilo.dylib 0x42cf000 - 0x42dcff3 com.apple.Librarian (1.1 - 1) <68F8F983-5F16-3BA5-BDA7-1A5451CC02BB> /System/Library/PrivateFrameworks/Librarian.framework/Versions/A/Librarian 0x5cae000 - 0x5cbcfff com.apple.iokit.IOHIDLib (1.8.1 - 1.8.1) <C47149AC-AE13-37B9-A244-567E644F040A> /System/Library/Extensions/IOHIDFamily.kext/Contents/PlugIns/IOHIDLib.plugin/Contents/MacOS/IOHIDLib 0x5cca000 - 0x5cd5ffb +libgcc3_uno.dylib (0) <0CE0AE21-AC3F-2CED-F5D3-1617E587360F> /Applications/LibreOffice.app/Contents/ure-link/lib/libgcc3_uno.dylib 0x5d02000 - 0x5d02ff7 +_bisect.so (???) <77AE8F1E-672D-5788-EAC6-047A989AADAA> /Applications/LibreOffice.app/Contents/MacOS/LibreOfficePython.framework/Versions/3.3/lib/python3.3/lib-dynload/_bisect.so 0xa05e000 - 0xa064ffb +liblocalebe1lo.dylib (0) <05E22F8B-943F-2CA8-AF31-875736290EC3> /Applications/LibreOffice.app/Contents/MacOS/liblocalebe1lo.dylib 0xa183000 - 0xa221fe7 +libconfigmgrlo.dylib (0) <D3FE4389-B532-2E98-8EEC-A1EE11E3943F> /Applications/LibreOffice.app/Contents/MacOS/libconfigmgrlo.dylib 0xa2e9000 - 0xa2eeffb +libspllo.dylib (0) <ECB061E1-C1C7-0ACA-2E9E-BDFE323698FF> /Applications/LibreOffice.app/Contents/MacOS/libspllo.dylib 0xa387000 - 0xa38bfff +libpythonloaderlo.dylib (0) <6707DE56-B667-47DD-FCB9-CC6C9CE6E978> /Applications/LibreOffice.app/Contents/MacOS/libpythonloaderlo.dylib 0xa403000 - 0xa404ff7 +_heapq.so (???) <A644F314-0D51-0A0A-BE2C-E25DB90FE6C2> /Applications/LibreOffice.app/Contents/MacOS/LibreOfficePython.framework/Versions/3.3/lib/python3.3/lib-dynload/_heapq.so 0xa676000 - 0xa689ff3 +liblocaledata_en.dylib (0) <6D2B338B-0D4F-E9A6-99CE-63468C7B578D> /Applications/LibreOffice.app/Contents/MacOS/liblocaledata_en.dylib 0xaa90000 - 0xabfdfef +libi18npoollo.dylib (0) <1B13EAF3-0FAE-AD1A-FE27-21B3223CCEFC> /Applications/LibreOffice.app/Contents/MacOS/libi18npoollo.dylib 0xac67000 - 0xadf8fef +libicui18n.dylib.51.1 (51.1) <68629251-291A-50D4-F3D4-89CA2163F3DE> /Applications/LibreOffice.app/Contents/MacOS/libicui18n.dylib.51.1 0xaf74000 - 0xafbffeb +libuuilo.dylib (0) <19186F1B-7738-FE83-D4AE-EEB8B5242D73> /Applications/LibreOffice.app/Contents/MacOS/libuuilo.dylib 0xb0be000 - 0xb0c7fff +libmacbe1lo.dylib (0) <A3A9E10B-CBBA-B5C1-670C-562622D3BE85> /Applications/LibreOffice.app/Contents/MacOS/libmacbe1lo.dylib 0xc834000 - 0xc883feb +libucb1.dylib (0) <D75EE666-5FB4-E60E-8295-134E134D444C> /Applications/LibreOffice.app/Contents/MacOS/libucb1.dylib 0xc8a8000 - 0xcb62ff7 +libfwklo.dylib (0) <FC9AAB07-655D-C096-A852-CE59BDDF1C80> /Applications/LibreOffice.app/Contents/MacOS/libfwklo.dylib 0xcc80000 - 0xccdefef +libucpfile1.dylib (0) <F9D0A094-2FCD-ABE6-E47B-853933FAAE01> /Applications/LibreOffice.app/Contents/MacOS/libucpfile1.dylib 0xcd35000 - 0xcd4cfff +stocservices.uno.dylib (0) <EC31D6DD-D02D-17BC-3C73-28A95A7A9400> /Applications/LibreOffice.app/Contents/ure-link/lib/stocservices.uno.dylib 0xcd61000 - 0xcdb1ffb +libfilterconfiglo.dylib (0) <61623BB0-176F-0EE0-68D9-E313EE746A3C> /Applications/LibreOffice.app/Contents/MacOS/libfilterconfiglo.dylib 0xce13000 - 0xd217fe7 +libooxlo.dylib (0) <5F63CD44-04C6-64CE-3A1E-D097C13847E0> /Applications/LibreOffice.app/Contents/MacOS/libooxlo.dylib 0xd4cc000 - 0xd669fe7 +libeditenglo.dylib (0) <9EBE6D00-B05F-F2D0-DC30-B8844CBDAEF4> /Applications/LibreOffice.app/Contents/MacOS/libeditenglo.dylib 0xd74e000 - 0xd7f7ff7 +libmsfilterlo.dylib (0) <A91607FF-8EEA-3783-71C7-1D1ED58BB579> /Applications/LibreOffice.app/Contents/MacOS/libmsfilterlo.dylib 0xd832000 - 0xde3efff +libsvxcorelo.dylib (0) <CE49EC05-E618-422C-FC5D-D0E92B50BFD4> /Applications/LibreOffice.app/Contents/MacOS/libsvxcorelo.dylib 0xe1bc000 - 0xe59afef +libxolo.dylib (0) <CC8F939F-44F1-79C1-7B18-00C50D7FB3D8> /Applications/LibreOffice.app/Contents/MacOS/libxolo.dylib 0xe6f7000 - 0xe77bfef +liblnglo.dylib (0) <0BCA43CD-22BF-9850-9264-5FE3E2C82AAF> /Applications/LibreOffice.app/Contents/MacOS/liblnglo.dylib 0xe7ca000 - 0xe7e9feb +libavmedialo.dylib (0) <7FC66A94-46E4-423F-B3BE-8E0B15CD07A6> /Applications/LibreOffice.app/Contents/MacOS/libavmedialo.dylib 0xe808000 - 0xe8bcfe7 +libxstor.dylib (0) <C8B407AB-07BB-C166-EFB7-287FE96A053D> /Applications/LibreOffice.app/Contents/MacOS/libxstor.dylib 0xe8e5000 - 0xe913ff3 +libfastsaxlo.dylib (0) <6CE56424-A658-9EFB-994A-3F18AF865C9E> /Applications/LibreOffice.app/Contents/MacOS/libfastsaxlo.dylib 0xe993000 - 0xea0bfff +libpackage2.dylib (0) <9DB0EF32-5C11-72B7-6343-29943CB979A2> /Applications/LibreOffice.app/Contents/MacOS/libpackage2.dylib 0xea80000 - 0xea88ff7 +libmcnttype.dylib (0) <DEFA85EB-9B7B-CA98-5B80-9B4DF9A6979A> /Applications/LibreOffice.app/Contents/MacOS/libmcnttype.dylib 0xea90000 - 0xefe2feb +libsdlo.dylib (0) <79C1EB2F-8150-4F60-3610-0226E76B34C6> /Applications/LibreOffice.app/Contents/MacOS/libsdlo.dylib 0xf2c3000 - 0xf558fe7 +libsvxlo.dylib (0) <CA2BF229-AFC8-29CE-3330-894A3638A930> /Applications/LibreOffice.app/Contents/MacOS/libsvxlo.dylib 0xf6f0000 - 0xf733fff +libxmlsecurity.dylib (0) <31E1C781-442B-8340-D51A-EEE851D489F1> /Applications/LibreOffice.app/Contents/MacOS/libxmlsecurity.dylib 0xf761000 - 0xf82aff3 com.apple.Bluetooth (4.1.4 - 4.1.4f2) <09A08285-00DD-3F8A-995B-18E2BF86E14B> /System/Library/Frameworks/IOBluetooth.framework/Versions/A/IOBluetooth 0xf87a000 - 0xf884fff com.apple.CoreBluetooth (100.6 - 1) <CE611C93-31FA-3C0E-9193-F6734162004C> /System/Library/Frameworks/IOBluetooth.framework/Versions/A/Frameworks/CoreBluetooth.framework/Versions/A/CoreBluetooth 0xfacc000 - 0xfaecffb +reflection.uno.dylib (0) <EA5E843D-E6EB-8FAE-000F-16529EDD5AC0> /Applications/LibreOffice.app/Contents/ure-link/lib/reflection.uno.dylib 0xfb02000 - 0xfb48fff +libupdchk.dylib (0) <BE59CBF0-B5BD-8444-E7B9-47B6FF39C253> /Applications/LibreOffice.app/Contents/MacOS/libupdchk.dylib0x102f7000 - 0x10358ffb +libunoxmllo.dylib (0) <E7DD31A8-B256-016E-BAD7-9C4FA847E549> /Applications/LibreOffice.app/Contents/MacOS/libunoxmllo.dylib0x10958000 - 0x109acffb +libspelllo.dylib (0) <03E8512C-A06C-D5A6-89F9-3DD41AFD6536> /Applications/LibreOffice.app/Contents/MacOS/libspelllo.dylib0x109c9000 - 0x109ceff7 +array.so (???) <869617C9-FD62-95CD-5CAF-01BE57D6C0BD> /Applications/LibreOffice.app/Contents/program/LibreOfficePython.framework/Versions/Current/lib/python3.3/lib-dynload/array.so0x10a78000 - 0x10a81ffb +libMacOSXSpelllo.dylib (0) <ED63D483-67A6-E03C-A2C4-5268440F5ED2> /Applications/LibreOffice.app/Contents/MacOS/libMacOSXSpelllo.dylib0x10a8d000 - 0x10ac4fe3 +libpyuno.dylib (0) <F6D247A5-BFD7-F65A-3314-4F526DFB434C> /Applications/LibreOffice.app/Contents/MacOS/libpyuno.dylib0x10ad5000 - 0x10d20fff +LibreOfficePython (3.3) <3E354B4D-D32C-CB73-AF3B-0BAF0FCF89C0> /Applications/LibreOffice.app/Contents/MacOS/LibreOfficePython.framework/Versions/3.3/LibreOfficePython0x10f5e000 - 0x10f75ffb +invocation.uno.dylib (0) <2765AB0B-02A9-4758-8D07-5AC84B4FD296> /Applications/LibreOffice.app/Contents/ure-link/lib/invocation.uno.dylib0x10f83000 - 0x10fabfff +introspection.uno.dylib (0) <C6976B15-7D3B-E7AF-EDE1-7F7AE1670152> /Applications/LibreOffice.app/Contents/ure-link/lib/introspection.uno.dylib0x10fbf000 - 0x10fc8fff +invocadapt.uno.dylib (0) <3D867617-9C61-C672-4993-62CB15A9206A> /Applications/LibreOffice.app/Contents/ure-link/lib/invocadapt.uno.dylib0x10fe0000 - 0x10feaff7 +_socket.so (???) <CD2A8943-489B-3940-969B-AAA537D9711D> /Applications/LibreOffice.app/Contents/program/LibreOfficePython.framework/Versions/Current/lib/python3.3/lib-dynload/_socket.so0x110f6000 - 0x11106ff7 +libhyphenlo.dylib (0) <7A22ECCF-3EC4-4B52-DA23-8FEF0E7E019B> /Applications/LibreOffice.app/Contents/MacOS/libhyphenlo.dylib0x11123000 - 0x11134fff +liblnthlo.dylib (0) <61175B99-0D39-A62F-EA88-AA8640028526> /Applications/LibreOffice.app/Contents/MacOS/liblnthlo.dylib0x11151000 - 0x11216feb +libdeployment.dylib (0) <644A5373-66D9-9FE3-CD3C-55FC33DBD9FE> /Applications/LibreOffice.app/Contents/MacOS/libdeployment.dylib0x1127b000 - 0x112b1ff7 +libhelplinkerlo.dylib (0) <B744CB9F-601B-5B0B-2063-92729A6909EC> /Applications/LibreOffice.app/Contents/MacOS/libhelplinkerlo.dylib0x112be000 - 0x11408ff7 +libclucene.dylib (0) <8124070F-5FAA-8F30-F26E-30B4FC31C29C> /Applications/LibreOffice.app/Contents/MacOS/libclucene.dylib0x11591000 - 0x115adff7 +libanimcorelo.dylib (0) <5C875488-6D9D-50E3-8D8C-E61315093934> /Applications/LibreOffice.app/Contents/MacOS/libanimcorelo.dylib0x11678000 - 0x11685ff7 +libfileacc.dylib (0) <DBAE8C35-D944-3CCB-012A-3F79707493C2> /Applications/LibreOffice.app/Contents/MacOS/libfileacc.dylib0x11691000 - 0x116c7fe3 +libexpwraplo.dylib (0) <2E5DE512-9E3C-593C-40C4-A5AF9F4B03B2> /Applications/LibreOffice.app/Contents/MacOS/libexpwraplo.dylib0x116da000 - 0x116f1ff3 +libscnlo.dylib (0) <B99456AD-A9B4-E126-87A7-AD11E9EC8B06> /Applications/LibreOffice.app/Contents/MacOS/libscnlo.dylib0x11800000 - 0x1182effb +libfsstoragelo.dylib (0) <E5CC063F-9595-DBC2-6E2A-4E477D5B3377> /Applications/LibreOffice.app/Contents/MacOS/libfsstoragelo.dylib0x11883000 - 0x11888fff +libucpexpand1lo.dylib (0) <D68214C3-27AC-F8F4-7A77-07FFAB00C22C> /Applications/LibreOffice.app/Contents/MacOS/libucpexpand1lo.dylib0x12fdb000 - 0x130c4ff3 +libPresenterScreenlo.dylib (0) <BA7D264F-D7E4-FAA8-2856-514D8B0FA07F> /Applications/LibreOffice.app/Contents/MacOS/libPresenterScreenlo.dylib0x13183000 - 0x1320afe7 +liblocaledata_euro.dylib (0) <5C62115A-9AFE-2A71-A10E-4E2F9C44B5E5> /Applications/LibreOffice.app/Contents/MacOS/liblocaledata_euro.dylib0x1340b000 - 0x134e5feb +libacclo.dylib (0) <FDC74135-557D-C6A7-5645-CA72B2F9850E> /Applications/LibreOffice.app/Contents/MacOS/libacclo.dylib0x135c1000 - 0x135c5fff +proxyfac.uno.dylib (0) <22703ECA-8999-5F29-4D5E-8FDFAB336A03> /Applications/LibreOffice.app/Contents/ure-link/lib/proxyfac.uno.dylib0x8feb1000 - 0x8fee3e57 dyld (210.2.3) <4D38DEED-9837-3202-B8E9-41272D01EA2C> /usr/lib/dyld0x90007000 - 0x90051ff7 com.apple.framework.CoreWLAN (3.3 - 330.15) <74C4B50F-7016-341F-8261-D379B8F0CC97> /System/Library/Frameworks/CoreWLAN.framework/Versions/A/CoreWLAN0x9012a000 - 0x9050dfff com.apple.HIToolbox (2.0 - 626.1) <ECC3F04F-C4B7-35BF-B10E-183B749DAB92> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/HIToolbox.framework/Versions/A/HIToolbox0x907fb000 - 0x90810fff com.apple.ImageCapture (8.0 - 8.0) <B8BD421F-D5A9-3FB4-8E89-AD5CFC0D4030> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/ImageCapture.framework/Versions/A/ImageCapture0x90811000 - 0x90858ff3 com.apple.CoreMedia (1.0 - 926.104) <D0E3BE86-12ED-31BE-816F-E72D757A9F2F> /System/Library/Frameworks/CoreMedia.framework/Versions/A/CoreMedia0x90859000 - 0x908f4fff com.apple.CoreSymbolication (3.0 - 117) <2BBBE224-301D-3931-AEF2-DD967A6E9172> /System/Library/PrivateFrameworks/CoreSymbolication.framework/Versions/A/CoreSymbolication0x908f5000 - 0x908fffff com.apple.speech.recognition.framework (4.1.5 - 4.1.5) <B855E8B4-2EE3-3BFF-8547-98A0F084F9AF> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/SpeechRecognition.framework/Versions/A/SpeechRecognition0x90900000 - 0x90909ff9 com.apple.CommonAuth (3.0 - 2.0) <34C4768C-EF8D-3DBA-AFB7-09148C8672DB> /System/Library/PrivateFrameworks/CommonAuth.framework/Versions/A/CommonAuth0x909e1000 - 0x90a26ff7 com.apple.NavigationServices (3.7 - 200) <F6531764-6E43-3AF3-ACDD-8A5551EF016A> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/NavigationServices.framework/Versions/A/NavigationServices0x90a4d000 - 0x90b88ff7 libBLAS.dylib (1073.4) <FF74A147-05E1-37C4-BC10-7DEB57FE5326> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib0x90b89000 - 0x90c72ff7 libxml2.2.dylib (22.3) <015A4FA6-5BB9-3F95-AFB8-B9281E22685B> /usr/lib/libxml2.2.dylib0x90c77000 - 0x90c89fff libbsm.0.dylib (32) <DADD385E-FE53-3458-94FB-E316A6345108> /usr/lib/libbsm.0.dylib0x90c8a000 - 0x90c98ff3 libsystem_network.dylib (77.10) <7FBF5A15-97BA-3721-943E-E77F0C40DBE1> /usr/lib/system/libsystem_network.dylib0x90c99000 - 0x90de7ff3 com.apple.CFNetwork (596.4.3 - 596.4.3) <547BD138-E902-35F0-B6EC-41DD06794B22> /System/Library/Frameworks/CFNetwork.framework/Versions/A/CFNetwork0x90ea0000 - 0x90eaafff com.apple.DisplayServicesFW (2.7.2 - 357) <5042CDAE-5580-3204-B675-745DA083E7AA> /System/Library/PrivateFrameworks/DisplayServices.framework/Versions/A/DisplayServices0x910f0000 - 0x910f8fff libcopyfile.dylib (89) <4963541B-0254-371B-B29A-B6806888949B> /usr/lib/system/libcopyfile.dylib0x91150000 - 0x913c1ffb com.apple.RawCamera.bundle (4.05 - 690) <1B2DF4B6-1229-36E3-86CF-5006E2A6DBB2> /System/Library/CoreServices/RawCamera.bundle/Contents/MacOS/RawCamera0x913c2000 - 0x915aaffb com.apple.CoreFoundation (6.8 - 744.19) <DDD3AA21-5B5F-3D8F-B137-AD95FCA89064> /System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation0x915ab000 - 0x915abfff libkeymgr.dylib (25) <D5E93F7F-9315-3AD6-92C7-941F7B54C490> /usr/lib/system/libkeymgr.dylib0x915ac000 - 0x9160efff libc++.1.dylib (65.1) <C0CFF9FF-5D52-3EAE-B921-6AE1DA00A135> /usr/lib/libc++.1.dylib0x9160f000 - 0x9168bff3 com.apple.Metadata (10.7.0 - 707.11) <F9BB5BBE-69D0-3309-8280-2303EB1DC455> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/Metadata.framework/Versions/A/Metadata0x9168c000 - 0x916bfffb com.apple.GSS (3.0 - 2.0) <9566A96D-C296-3ABD-A12A-E274C81C0B25> /System/Library/Frameworks/GSS.framework/Versions/A/GSS0x916c0000 - 0x91980ff3 com.apple.security (7.0 - 55179.13) <000FD8E9-D070-326A-B386-51314360FD5C> /System/Library/Frameworks/Security.framework/Versions/A/Security0x91981000 - 0x919d0ff6 libTIFF.dylib (850) <78E121A6-92A2-3120-883C-7AA3C2966F9C> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libTIFF.dylib0x919d4000 - 0x919ddfff com.apple.DiskArbitration (2.5.2 - 2.5.2) <89822A83-B450-3363-8E9C-9B80CB4450B1> /System/Library/Frameworks/DiskArbitration.framework/Versions/A/DiskArbitration0x919de000 - 0x91ae9ff7 libJP2.dylib (850) <3FFCEFA6-317A-34AF-8D99-AEBB017543C5> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libJP2.dylib0x91aea000 - 0x91af6ffa com.apple.CrashReporterSupport (10.8.3 - 418) <03BC564E-35FE-384E-87D6-6E0C55DF16E3> /System/Library/PrivateFrameworks/CrashReporterSupport.framework/Versions/A/CrashReporterSupport0x91af7000 - 0x91b5dfff com.apple.print.framework.PrintCore (8.3 - 387.2) <0F7665F5-33F0-3661-9BE2-7DD2890E304B> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/PrintCore.framework/Versions/A/PrintCore0x91b5e000 - 0x91b60ffd libCVMSPluginSupport.dylib (8.9.2) <D6D0BB75-42DA-3772-AB5E-CBD59B343393> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libCVMSPluginSupport.dylib0x91b61000 - 0x91c5fff7 libFontParser.dylib (84.6) <7D3EB3CC-527E-3A74-816A-59CAFD2260A4> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/Resources/libFontParser.dylib0x91ca0000 - 0x91cccff7 libsystem_info.dylib (406.17) <AA5611DB-A944-3072-B6BE-ACAB08689547> /usr/lib/system/libsystem_info.dylib0x91ccd000 - 0x91ce7ffc libsystem_kernel.dylib (2050.24.15) <9E58DCC0-D5FF-37E1-AA7F-F2206719E138> /usr/lib/system/libsystem_kernel.dylib0x91ce8000 - 0x91d80fff com.apple.CoreServices.OSServices (557.6 - 557.6) <8DEEED08-A4B3-3B08-8C2A-BDDBF005B43F> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/OSServices.framework/Versions/A/OSServices0x91d81000 - 0x91d87fff libGFXShared.dylib (8.9.2) <F3B0E66D-5C47-3A5A-A2CD-F0C58E8322C3> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGFXShared.dylib0x91d88000 - 0x91d8fff3 com.apple.NetFS (5.0 - 4.0) <1F7041F2-4E97-368C-8F5D-24153D81BBDB> /System/Library/Frameworks/NetFS.framework/Versions/A/NetFS0x91d98000 - 0x91dadfff com.apple.speech.synthesis.framework (4.1.12 - 4.1.12) <DE68CEB5-4959-3652-83B8-D2B00D3B932D> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/SpeechSynthesis.framework/Versions/A/SpeechSynthesis0x91dae000 - 0x91dd0fff libc++abi.dylib (26) <3AAA8D55-F5F6-362B-BA3C-CCAF0D3C8E27> /usr/lib/libc++abi.dylib0x91dd1000 - 0x91deeff7 libresolv.9.dylib (51) <B9742A2A-DF15-3F6E-8FCE-778A58214B3A> /usr/lib/libresolv.9.dylib0x91def000 - 0x91e31ffb com.apple.RemoteViewServices (2.0 - 80.6) <AE962502-4539-3893-A2EB-9D384652AEAC> /System/Library/PrivateFrameworks/RemoteViewServices.framework/Versions/A/RemoteViewServices0x91e73000 - 0x91eeeff3 com.apple.CorePDF (2.2 - 2.2) <5A52A1CF-4801-3E6C-BF6E-E5E75A8DBD8F> /System/Library/PrivateFrameworks/CorePDF.framework/Versions/A/CorePDF0x91eef000 - 0x91f06ff4 com.apple.CoreMediaAuthoring (2.1 - 914) <DEB24207-C250-3308-8C97-E4FA700A8616> /System/Library/PrivateFrameworks/CoreMediaAuthoring.framework/Versions/A/CoreMediaAuthoring0x91f07000 - 0x92ac3ff3 com.apple.AppKit (6.8 - 1187.39) <ACA24416-D910-39B8-9387-52A6C6A561F8> /System/Library/Frameworks/AppKit.framework/Versions/C/AppKit0x92ac4000 - 0x92aedff7 libRIP.A.dylib (332) <521E60A6-A768-3CB8-B10D-D10EECD68A94> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/Resources/libRIP.A.dylib0x93827000 - 0x93827ffd libOpenScriptingUtil.dylib (148.3) <87895E27-88E2-3249-8D0E-B17E76FB00C1> /usr/lib/libOpenScriptingUtil.dylib0x93828000 - 0x9382cffc libGIF.dylib (850) <45CD8B8F-7324-3187-B01C-8E16C04F33FA> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libGIF.dylib0x9382d000 - 0x9390efff libcrypto.0.9.8.dylib (47.1) <E4820342-4F42-3DEB-90DB-DE5A66C5585E> /usr/lib/libcrypto.0.9.8.dylib0x9390f000 - 0x93d0bfeb com.apple.VideoToolbox (1.0 - 926.104) <4275B89E-F826-3F65-ACE1-89052A9CAC6B> /System/Library/Frameworks/VideoToolbox.framework/Versions/A/VideoToolbox0x93d0c000 - 0x93d4bff7 com.apple.bom (12.0 - 192) <0637E52C-D151-37B3-904F-8656B2FD44DD> /System/Library/PrivateFrameworks/Bom.framework/Versions/A/Bom0x945ca000 - 0x945dcff7 libdispatch.dylib (228.23) <86EF7D45-2D97-3465-A449-95038AE5DABA> /usr/lib/system/libdispatch.dylib0x945dd000 - 0x94629fff libcorecrypto.dylib (106.2) <20EBADBA-D6D6-36F0-AE80-168E9AF13DB6> /usr/lib/system/libcorecrypto.dylib0x9462a000 - 0x9462afff libSystem.B.dylib (169.3) <D7C4320E-C2EA-3A09-A413-D1F78382050D> /usr/lib/libSystem.B.dylib0x94692000 - 0x946a2ff7 libsasl2.2.dylib (166) <D9080BA2-A365-351E-9FF2-7E0D4E8B1339> /usr/lib/libsasl2.2.dylib0x946a3000 - 0x946fefff com.apple.htmlrendering (77 - 1.1.4) <5C0C669F-AE07-3983-B38F-EB829B5CE609> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/HTMLRendering.framework/Versions/A/HTMLRendering0x946ff000 - 0x94700fff libsystem_sandbox.dylib (220.3) <C532F6A6-7E85-38F3-8660-EC1066DF67BE> /usr/lib/system/libsystem_sandbox.dylib0x94701000 - 0x94765ff3 libstdc++.6.dylib (56) <F8FA490A-8F3C-3645-ABF5-78926CE9C62C> /usr/lib/libstdc++.6.dylib0x94766000 - 0x9485eff9 libsqlite3.dylib (138.1) <AD7C5914-35F0-37A3-9238-A29D2E26C755> /usr/lib/libsqlite3.dylib0x9485f000 - 0x94883fff com.apple.PerformanceAnalysis (1.16 - 16) <1F963AEF-27CF-3FEB-BE9C-4C15AFE56DEA> /System/Library/PrivateFrameworks/PerformanceAnalysis.framework/Versions/A/PerformanceAnalysis0x94884000 - 0x94891ff7 com.apple.AppleFSCompression (49 - 1.0) <166AA1F8-E50A-3533-A3B5-8737C5118CC3> /System/Library/PrivateFrameworks/AppleFSCompression.framework/Versions/A/AppleFSCompression0x94892000 - 0x94892fff com.apple.ApplicationServices (45 - 45) <677C4ACC-9D12-366F-8A87-B898AC806DD9> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/ApplicationServices0x94893000 - 0x948cefef libGLImage.dylib (8.9.2) <9D41F71E-E927-3767-A856-55480E20E9D9> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGLImage.dylib0x948cf000 - 0x948f8fff libxslt.1.dylib (11.3) <0DE17DAA-66FF-3195-AADB-347BEB5E2EFA> /usr/lib/libxslt.1.dylib0x948f9000 - 0x949a8ff7 com.apple.CoreText (260.0 - 275.16) <873ADCD9-D361-3753-A220-CDD289196AD8> /System/Library/Frameworks/CoreText.framework/Versions/A/CoreText0x949b0000 - 0x949b1fff libDiagnosticMessagesClient.dylib (8) <39B3D25A-148A-3936-B800-0D393A00E64F> /usr/lib/libDiagnosticMessagesClient.dylib0x949b2000 - 0x949cbfff com.apple.Kerberos (2.0 - 1) <9BDE8F4D-DBC3-34D1-852C-898D3655A611> /System/Library/Frameworks/Kerberos.framework/Versions/A/Kerberos0x94d45000 - 0x94d69fff libJPEG.dylib (850) <36FEAB05-86C5-33B9-9DE9-5FAD8AEBA15F> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libJPEG.dylib0x94d6a000 - 0x94d6bfff liblangid.dylib (116) <E13CC8C5-5034-320A-A210-41A2BDE4F846> /usr/lib/liblangid.dylib0x94d6c000 - 0x9500fff3 com.apple.CoreImage (8.4.0 - 1.0.1) <C25B9EEC-4824-3088-BC08-2EA516C0728C> /System/Library/Frameworks/QuartzCore.framework/Versions/A/Frameworks/CoreImage.framework/Versions/A/CoreImage0x95010000 - 0x95013ff7 com.apple.TCC (1.0 - 1) <437D76CD-6437-3B55-BE2C-A53508858256> /System/Library/PrivateFrameworks/TCC.framework/Versions/A/TCC0x95014000 - 0x9506bff7 com.apple.ScalableUserInterface (1.0 - 1) <2B5E454B-BC49-3E85-B54D-1950397C448C> /System/Library/Frameworks/QuartzCore.framework/Versions/A/Frameworks/ScalableUserInterface.framework/Versions/A/ScalableUserInterface0x9506c000 - 0x950b3ff7 com.apple.framework.CoreWiFi (1.3 - 130.13) <1961CC70-C00D-31DE-BAB5-A077538CD5CB> /System/Library/Frameworks/CoreWiFi.framework/Versions/A/CoreWiFi0x950b4000 - 0x950b6ffb libRadiance.dylib (850) <83434287-A09E-3A3F-A1AC-085B563BA46D> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libRadiance.dylib0x950b7000 - 0x950d3fff libPng.dylib (850) <26AD967A-D55E-3C5A-A643-D9953136DE58> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libPng.dylib0x950d4000 - 0x951ecff7 com.apple.coreavchd (5.6.0 - 5600.4.16) <F024C78B-4FAA-38F1-A182-AD0A0A596CBE> /System/Library/PrivateFrameworks/CoreAVCHD.framework/Versions/A/CoreAVCHD0x951ed000 - 0x95235ff5 com.apple.opencl (2.2.19 - 2.2.19) <968DD067-49D0-3B71-A96B-B3579698D992> /System/Library/Frameworks/OpenCL.framework/Versions/A/OpenCL0x95236000 - 0x9523afff com.apple.OpenDirectory (10.8 - 151.10) <B9244697-CB05-3BD3-80A7-D188B3747B03> /System/Library/Frameworks/OpenDirectory.framework/Versions/A/OpenDirectory0x9523b000 - 0x9529fff7 com.apple.datadetectorscore (4.1 - 269.3) <C11C2014-298E-3E2B-9F5D-02CCD3CA4AB3> /System/Library/PrivateFrameworks/DataDetectorsCore.framework/Versions/A/DataDetectorsCore0x952ee000 - 0x953dfffc libiconv.2.dylib (34) <B096A9B7-83A6-31B3-8D2F-87D91910BF4C> /usr/lib/libiconv.2.dylib0x953e0000 - 0x9540bfff com.apple.shortcut (2.2 - 2.2) <FA94F2BF-37E1-3F16-9085-7BCCB815BAE9> /System/Library/PrivateFrameworks/Shortcut.framework/Versions/A/Shortcut0x9540c000 - 0x95466fff com.apple.Symbolication (1.3 - 93) <2C7B4F90-8834-3BCB-81BF-001B31452FB6> /System/Library/PrivateFrameworks/Symbolication.framework/Versions/A/Symbolication0x95498000 - 0x95b24ff3 com.apple.CoreAUC (6.16.13 - 6.16.13) <3DCF4456-AF8D-3E87-B00C-C56055AF9B8E> /System/Library/PrivateFrameworks/CoreAUC.framework/Versions/A/CoreAUC0x95b25000 - 0x95b75ff7 com.apple.CoreMediaIO (308.0 - 4155.4) <E2FF59A9-3728-3D17-A1AD-84DC1BDA2146> /System/Library/Frameworks/CoreMediaIO.framework/Versions/A/CoreMediaIO0x95b76000 - 0x95b7dfff liblaunch.dylib (442.26.2) <310C99F8-0811-314D-9BB9-D0ED6DFA024B> /usr/lib/system/liblaunch.dylib0x95b7e000 - 0x95b80fff com.apple.securityhi (4.0 - 55002) <027D2D24-4043-3B43-90F3-112FB46903E8> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/SecurityHI.framework/Versions/A/SecurityHI0x95b81000 - 0x95ea1ff3 com.apple.Foundation (6.8 - 945.18) <BDC56A93-45C5-3459-B307-65A1CCE702C5> /System/Library/Frameworks/Foundation.framework/Versions/C/Foundation0x95ea2000 - 0x95ea2fff com.apple.CoreServices (57 - 57) <956C6C6D-A5DD-314F-9C57-4A61D41F30CE> /System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices0x95ea3000 - 0x95f0bff7 com.apple.framework.IOKit (2.0.1 - 755.24.1) <70DE925B-51E8-3C65-8928-FB49FD823D94> /System/Library/Frameworks/IOKit.framework/Versions/A/IOKit0x95f0c000 - 0x96084ff5 com.apple.QuartzCore (1.8 - 304.3) <F2EFC117-CDC6-3252-A4A8-880965764385> /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore0x96085000 - 0x960bcffa com.apple.LDAPFramework (2.4.28 - 194.5) <23668AB5-68EA-37D2-978E-C9EF22BF8C0C> /System/Library/Frameworks/LDAP.framework/Versions/A/LDAP0x960c1000 - 0x960cdffe libkxld.dylib (2050.24.15) <BEC097B0-9D9A-3484-99DB-0F537E71963E> /usr/lib/system/libkxld.dylib0x960ce000 - 0x960cffff libquarantine.dylib (52.1) <094A1501-373E-3397-B632-8F7C5AC8EFD5> /usr/lib/system/libquarantine.dylib0x96100000 - 0x96103ffc libCoreVMClient.dylib (32.3) <35B63A60-DF0A-3FB3-ABB8-164B246A43CC> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libCoreVMClient.dylib0x96104000 - 0x96131ffe libsystem_m.dylib (3022.6) <9975D9C3-3B71-38E3-AA21-C5C5F9D9C431> /usr/lib/system/libsystem_m.dylib0x96132000 - 0x9639fffb com.apple.imageKit (2.2 - 673) <CDB2AC11-6D60-34A7-83F9-F6E7DA25F97B> /System/Library/Frameworks/Quartz.framework/Versions/A/Frameworks/ImageKit.framework/Versions/A/ImageKit0x963a0000 - 0x96529ff7 com.apple.vImage (6.0 - 6.0) <1D1F67FE-4F75-3689-BEF6-4A46C8039E70> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vImage.framework/Versions/A/vImage0x9652a000 - 0x96534ffe com.apple.bsd.ServiceManagement (2.0 - 2.0) <9732BA61-D6F6-3644-82DA-FF0D6FEEFC69> /System/Library/Frameworks/ServiceManagement.framework/Versions/A/ServiceManagement0x96535000 - 0x96535fff com.apple.Accelerate (1.8 - Accelerate 1.8) <4EC0548E-3A3F-310D-A366-47B51D5B6398> /System/Library/Frameworks/Accelerate.framework/Versions/A/Accelerate0x9657c000 - 0x9657fff9 libCGXType.A.dylib (332) <07B59FCC-6229-37C2-9870-70A18E2C5598> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/Resources/libCGXType.A.dylib0x96580000 - 0x9658cff7 com.apple.NetAuth (4.0 - 4.0) <4983C4B8-9D95-3C4D-897E-07743326487E> /System/Library/PrivateFrameworks/NetAuth.framework/Versions/A/NetAuth0x9658d000 - 0x965e7ff3 com.apple.ImageCaptureCore (5.0.4 - 5.0.4) <6313E06F-37FD-3606-BF2F-87D8598A9983> /System/Library/Frameworks/ImageCaptureCore.framework/Versions/A/ImageCaptureCore0x965f3000 - 0x96624fff com.apple.DictionaryServices (1.2 - 184.4) <A31BB2CE-6965-3610-8B11-EA26EC6D7EEA> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/DictionaryServices.framework/Versions/A/DictionaryServices0x96625000 - 0x96741ffb com.apple.desktopservices (1.7.4 - 1.7.4) <782D711D-7930-324A-9015-686C2F86DBA3> /System/Library/PrivateFrameworks/DesktopServicesPriv.framework/Versions/A/DesktopServicesPriv0x96742000 - 0x967a3fff com.apple.audio.CoreAudio (4.1.1 - 4.1.1) <A3B911DB-77DF-3037-A47A-634B08E5727D> /System/Library/Frameworks/CoreAudio.framework/Versions/A/CoreAudio0x967a4000 - 0x967adfff com.apple.CommerceCore (1.0 - 26.1) <8C28115C-6EC1-316D-9237-F4FBCBB778C5> /System/Library/PrivateFrameworks/CommerceKit.framework/Versions/A/Frameworks/CommerceCore.framework/Versions/A/CommerceCore0x967ae000 - 0x967bcfff libxar.1.dylib (105) <343E4A3B-1D04-34A3-94C2-8C7C9A8F736B> /usr/lib/libxar.1.dylib0x967be000 - 0x967e9ff9 com.apple.framework.Apple80211 (8.4 - 840.22.1) <DBC31BEB-B771-315F-852D-66ADC3BD75A1> /System/Library/PrivateFrameworks/Apple80211.framework/Versions/A/Apple802110x967ea000 - 0x967ebfff libremovefile.dylib (23.2) <9813B2DB-2374-3AA2-99B6-AA2E9897B249> /usr/lib/system/libremovefile.dylib0x967ec000 - 0x967eefff libdyld.dylib (210.2.3) <05D6FF2A-F09B-309D-95F7-7AF10259C707> /usr/lib/system/libdyld.dylib0x967ef000 - 0x96831ff7 libcups.2.dylib (327.6) <D994A44F-CCDD-3D40-B732-79CB88F45908> /usr/lib/libcups.2.dylib0x96832000 - 0x968c4ffb libvMisc.dylib (380.6) <6DA3A03F-20BE-300D-A664-B50A7B4E4B1A> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libvMisc.dylib0x968c5000 - 0x9693fff7 com.apple.securityfoundation (6.0 - 55115.4) <69D92A90-971C-3CD3-BAB1-ADF958C568BC> /System/Library/Frameworks/SecurityFoundation.framework/Versions/A/SecurityFoundation0x96940000 - 0x96949ffd com.apple.audio.SoundManager (4.0 - 4.0) <ABC5FE40-B222-36EB-9905-5C8C4BFD8C87> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/CarbonSound.framework/Versions/A/CarbonSound0x9694a000 - 0x9697dfff libssl.0.9.8.dylib (47.1) <1725A506-BD80-39D5-8EE8-78D2FBBE194C> /usr/lib/libssl.0.9.8.dylib0x96988000 - 0x9698cfff com.apple.CommonPanels (1.2.5 - 94) <6B3E7E53-7708-3DA2-8C50-59C2B4735DE1> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/CommonPanels.framework/Versions/A/CommonPanels0x9698d000 - 0x96daafff FaceCoreLight (2.4.1) <B12C8721-EFB3-30A2-9A1B-ABCDF5670764> /System/Library/PrivateFrameworks/FaceCoreLight.framework/Versions/A/FaceCoreLight0x96dab000 - 0x96daeffc libpam.2.dylib (20) <FCF74195-A99E-3B07-8E49-688D4A6F1E18> /usr/lib/libpam.2.dylib0x96daf000 - 0x96ddcffb com.apple.CoreServicesInternal (154.3 - 154.3) <A452602B-67CB-39C4-95EB-E59433C65774> /System/Library/PrivateFrameworks/CoreServicesInternal.framework/Versions/A/CoreServicesInternal0x96ddd000 - 0x96e38ff7 com.apple.AppleVAFramework (5.0.19 - 5.0.19) <3C43A555-0A22-3D7C-A3FB-CFADDDA43E9B> /System/Library/PrivateFrameworks/AppleVA.framework/Versions/A/AppleVA0x96e39000 - 0x96e39fff com.apple.Accelerate.vecLib (3.8 - vecLib 3.8) <908B8D40-3FB5-3047-B482-3DF95025ECFC> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/vecLib0x96e3a000 - 0x96ebfff7 com.apple.SearchKit (1.4.0 - 1.4.0) <454E950F-291C-3E95-8F35-05CA0AD6B327> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/SearchKit.framework/Versions/A/SearchKit0x96ec3000 - 0x97305fff com.apple.CoreGraphics (1.600.0 - 332) <67E70F21-A0F1-356F-90B7-4B90C468EE2C> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/CoreGraphics0x97306000 - 0x973a3ff7 com.apple.PDFKit (2.8.4 - 2.8.4) <639CF802-BE94-39C5-AC97-B5B42FF910C2> /System/Library/Frameworks/Quartz.framework/Versions/A/Frameworks/PDFKit.framework/Versions/A/PDFKit0x973a4000 - 0x973e6fff libcurl.4.dylib (69.2) <8CC566A0-0B25-37E8-A6EC-30074C3CDB8C> /usr/lib/libcurl.4.dylib0x973e7000 - 0x973e7fff com.apple.Cocoa (6.7 - 19) <354094F0-F36B-36F9-BF5F-FD60590FBEB9> /System/Library/Frameworks/Cocoa.framework/Versions/A/Cocoa0x973e8000 - 0x974f5057 libobjc.A.dylib (532.2) <FA455371-7395-3D58-A89B-D1520612D1BC> /usr/lib/libobjc.A.dylib0x974fc000 - 0x97655ffb com.apple.audio.toolbox.AudioToolbox (1.9 - 1.9) <8BF022FC-C38A-34AA-8469-D98294094659> /System/Library/Frameworks/AudioToolbox.framework/Versions/A/AudioToolbox0x97656000 - 0x97661fff libcommonCrypto.dylib (60027) <8EE30FA5-AA8D-3FA6-AB0F-05DA8B0425D9> /usr/lib/system/libcommonCrypto.dylib0x97664000 - 0x97664fff com.apple.vecLib (3.8 - vecLib 3.8) <83160DD1-5614-3E34-80EB-97041016EF1F> /System/Library/Frameworks/vecLib.framework/Versions/A/vecLib0x97665000 - 0x97665fff libsystem_blocks.dylib (59) <3A743C5D-CFA5-37D8-80A8-B6795A9DB04F> /usr/lib/system/libsystem_blocks.dylib0x97666000 - 0x97676ff2 com.apple.LangAnalysis (1.7.0 - 1.7.0) <875363E7-6D02-3229-A9DD-E5A5568A7D61> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/LangAnalysis.framework/Versions/A/LangAnalysis0x97677000 - 0x97683ff8 libbz2.1.0.dylib (29) <7031A4C0-784A-3EAA-93DF-EA1F26CC9264> /usr/lib/libbz2.1.0.dylib0x97684000 - 0x97932ffb com.apple.MediaToolbox (1.0 - 926.104) <DD264DFD-9AFB-38E2-A44C-B463DCB721A0> /System/Library/Frameworks/MediaToolbox.framework/Versions/A/MediaToolbox0x97933000 - 0x97975fff libauto.dylib (185.4) <3098A75E-438E-3F18-BAAC-CD8F1CC7C2F7> /usr/lib/libauto.dylib0x97978000 - 0x9797cffe libcache.dylib (57) <834FDCA7-FE3B-33CC-A12A-E11E202477EC> /usr/lib/system/libcache.dylib0x9797d000 - 0x97d35ffa libLAPACK.dylib (1073.4) <9A6E5EAD-F2F2-3D5C-B655-2B536DB477F2> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libLAPACK.dylib0x97d36000 - 0x97d66ff3 libtidy.A.dylib (15.10) <F2F4E000-E305-3089-91E6-3DB0ED07E74A> /usr/lib/libtidy.A.dylib0x97d83000 - 0x97d87fff com.apple.IOSurface (86.0.4 - 86.0.4) <6431ACB6-561B-314F-9A2A-FAC1578FCC86> /System/Library/Frameworks/IOSurface.framework/Versions/A/IOSurface0x97d8a000 - 0x97f46ffd libicucore.A.dylib (491.11.3) <FF55E176-7D66-3DBB-AF86-84744C47A02C> /usr/lib/libicucore.A.dylib0x981e2000 - 0x98218ffb com.apple.DebugSymbols (98 - 98) <9A9ADA0A-E487-3C8F-9998-286EE04C235A> /System/Library/PrivateFrameworks/DebugSymbols.framework/Versions/A/DebugSymbols0x98219000 - 0x98223fff libsystem_notify.dylib (98.5) <7EEE9475-18F8-3099-B0ED-23A3E528ABE0> /usr/lib/system/libsystem_notify.dylib0x98224000 - 0x98237ff9 com.apple.MultitouchSupport.framework (235.29 - 235.29) <451701B6-03CE-3F26-9FF0-92D8DA1467EE> /System/Library/PrivateFrameworks/MultitouchSupport.framework/Versions/A/MultitouchSupport0x982d6000 - 0x982ecfff com.apple.CFOpenDirectory (10.8 - 151.10) <D90DB5D4-6565-3726-B88A-21336CBE9170> /System/Library/Frameworks/OpenDirectory.framework/Versions/A/Frameworks/CFOpenDirectory.framework/Versions/A/CFOpenDirectory0x982ed000 - 0x9830dffd com.apple.ChunkingLibrary (2.0 - 133.3) <FA45EAE8-BB10-3AEE-9FDC-C0C3A533FF48> /System/Library/PrivateFrameworks/ChunkingLibrary.framework/Versions/A/ChunkingLibrary0x9830e000 - 0x9841bff3 com.apple.ImageIO.framework (3.2.1 - 850) <C964E877-660E-3482-ACF9-EC25DFEAF307> /System/Library/Frameworks/ImageIO.framework/Versions/A/ImageIO0x9841c000 - 0x984c6fff com.apple.LaunchServices (539.9 - 539.9) <C0E0CFFF-3714-3467-87DA-4A6F0AF1953B> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/LaunchServices.framework/Versions/A/LaunchServices0x984c7000 - 0x984caff7 libcompiler_rt.dylib (30) <CE5DBDB4-0124-3E2B-9105-989DF98DD108> /usr/lib/system/libcompiler_rt.dylib0x98517000 - 0x98525fff com.apple.opengl (1.8.9 - 1.8.9) <1872D2CD-00A8-30D1-8ECC-B663F4E4C530> /System/Library/Frameworks/OpenGL.framework/Versions/A/OpenGL0x98526000 - 0x9854bffb com.apple.framework.familycontrols (4.1 - 410) <B1755756-BEA2-3205-ADAA-68FCC32E60BD> /System/Library/PrivateFrameworks/FamilyControls.framework/Versions/A/FamilyControls0x9854c000 - 0x985bbffb com.apple.Heimdal (3.0 - 2.0) <964D9952-B0F2-34F6-8265-1823C0D5EAB8> /System/Library/PrivateFrameworks/Heimdal.framework/Versions/A/Heimdal0x985bc000 - 0x985bdffd com.apple.TrustEvaluationAgent (2.0 - 23) <E42347C0-2D3C-36A4-9200-757FFA61B388> /System/Library/PrivateFrameworks/TrustEvaluationAgent.framework/Versions/A/TrustEvaluationAgent0x985be000 - 0x987eefff com.apple.QuartzComposer (5.1 - 284) <4E8682B7-EBAE-3C40-ABDB-8705EC7952BD> /System/Library/Frameworks/Quartz.framework/Versions/A/Frameworks/QuartzComposer.framework/Versions/A/QuartzComposer0x987ef000 - 0x987effff com.apple.quartzframework (1.5 - 1.5) <9018BE5B-4070-320E-8091-6584CC17F798> /System/Library/Frameworks/Quartz.framework/Versions/A/Quartz0x987f0000 - 0x9880dfff libxpc.dylib (140.43) <C628073D-51A0-3541-A665-1121520508C6> /usr/lib/system/libxpc.dylib0x9880e000 - 0x98868ffb com.apple.AE (645.6 - 645.6) <44556FF7-A869-399A-AEBB-F4E9263D9152> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/AE.framework/Versions/A/AE0x98869000 - 0x9886cff3 com.apple.AppleSystemInfo (2.0 - 2) <4639D755-8A68-31C9-95C4-7E7F70C233FA> /System/Library/PrivateFrameworks/AppleSystemInfo.framework/Versions/A/AppleSystemInfo0x99009000 - 0x99062fff com.apple.QuickLookFramework (4.0 - 555.5) <4E381B7B-7EB5-37FD-9BA7-517DB48D07A7> /System/Library/Frameworks/QuickLook.framework/Versions/A/QuickLook0x99063000 - 0x99121ff3 com.apple.ColorSync (4.8.0 - 4.8.0) <EFEDCB37-4F20-3CEC-A185-5D2976E11BAC> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ColorSync.framework/Versions/A/ColorSync0x99122000 - 0x9939eff7 com.apple.QuickTime (7.7.1 - 2599.31) <3839E1F3-7948-3E68-9AE1-A0CEE8C59212> /System/Library/Frameworks/QuickTime.framework/Versions/A/QuickTime0x993b3000 - 0x993d8ff7 com.apple.CoreVideo (1.8 - 99.4) <A26DE896-32E0-3D5E-BA89-02AD23FA96B3> /System/Library/Frameworks/CoreVideo.framework/Versions/A/CoreVideo0x993d9000 - 0x993e0ffb libunwind.dylib (35.1) <E1E8D8B3-3C78-3AB1-B398-C180DC6DCF05> /usr/lib/system/libunwind.dylib0x993e1000 - 0x993e1fff com.apple.Carbon (154 - 155) <17F1B675-E054-3D2C-900B-C9CE69F1FC31> /System/Library/Frameworks/Carbon.framework/Versions/A/Carbon0x993e4000 - 0x9943bff3 com.apple.HIServices (1.20 - 417) <B8410ABC-E0DB-31EB-B923-17F3B65B5F4C> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/HIServices.framework/Versions/A/HIServices0x9943c000 - 0x99449ff7 com.apple.HelpData (2.1.4 - 85) <1E180AEF-53FF-3D8B-9513-7FCA1B25A4AB> /System/Library/PrivateFrameworks/HelpData.framework/Versions/A/HelpData0x9944a000 - 0x99507feb libsystem_c.dylib (825.26) <6E35A83F-1A5B-3AF9-8C6D-D7B57B25FB63> /usr/lib/system/libsystem_c.dylib0x99538000 - 0x9966bff3 com.apple.MediaControlSender (1.7 - 170.20) <7B1AC317-AFDB-394F-8026-9561930E696B> /System/Library/PrivateFrameworks/MediaControlSender.framework/Versions/A/MediaControlSender0x9966c000 - 0x99672fff com.apple.print.framework.Print (8.0 - 258) <12AEAD24-6924-3923-9E4A-C5D21231E639> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Print.framework/Versions/A/Print0x99673000 - 0x99674fff libdnsinfo.dylib (453.19) <3B523729-84A8-3D0B-B58C-3FC185060E67> /usr/lib/system/libdnsinfo.dylib0x99675000 - 0x99675ffd com.apple.audio.units.AudioUnit (1.9 - 1.9) <F7638E43-F885-372E-9DAE-24D0C21AA66E> /System/Library/Frameworks/AudioUnit.framework/Versions/A/AudioUnit0x99676000 - 0x998cfff5 com.apple.JavaScriptCore (8536 - 8536.30) <24A2ACA7-6E51-30C6-B9AE-17A77E511735> /System/Library/Frameworks/JavaScriptCore.framework/Versions/A/JavaScriptCore0x998dc000 - 0x998eaff7 libz.1.dylib (43) <245F1B61-2276-3BBB-9891-99934116D833> /usr/lib/libz.1.dylib0x998eb000 - 0x998f5fff libCSync.A.dylib (332) <86C5C84F-11EC-39C0-9FAC-A93FDEEC3117> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/Resources/libCSync.A.dylib0x998f6000 - 0x99a53ffb com.apple.QTKit (7.7.1 - 2599.31) <B9AE5675-22B0-3AA9-903F-2195DA0B04F5> /System/Library/Frameworks/QTKit.framework/Versions/A/QTKit0x99a54000 - 0x99a5bfff libsystem_dnssd.dylib (379.38.1) <4F164CA8-4A4F-3B27-B88A-0926E2FEB7D4> /usr/lib/system/libsystem_dnssd.dylib0x99a5c000 - 0x99a7aff3 com.apple.openscripting (1.3.6 - 148.3) <F3422C02-5ACB-343A-987B-A2D58EA2F5A8> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/OpenScripting.framework/Versions/A/OpenScripting0x99a7b000 - 0x99a7cffd libunc.dylib (25) <58599CBF-E262-3CEA-AFE1-35560E0177DC> /usr/lib/system/libunc.dylib0x99a7d000 - 0x99b31fff com.apple.coreui (2.0 - 181.1) <C15ABF35-B7F5-34ED-A461-386DAF65D96B> /System/Library/PrivateFrameworks/CoreUI.framework/Versions/A/CoreUI0x99b32000 - 0x99c06ff3 com.apple.backup.framework (1.4.3 - 1.4.3) <6EA22ED3-BA18-3A37-AE05-5D6FDA3F372F> /System/Library/PrivateFrameworks/Backup.framework/Versions/A/Backup0x99c07000 - 0x99c9eff7 com.apple.ink.framework (10.8.2 - 150) <A9C3B735-7D5F-3D7D-AA70-2CC852D09CDE> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Ink.framework/Versions/A/Ink0x99c9f000 - 0x99d07fe7 libvDSP.dylib (380.6) <55780308-4DCA-3B10-9703-EAFC3E13A3FA> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libvDSP.dylib0x99d08000 - 0x99d56ffb libFontRegistry.dylib (100) <3B8350C2-4D8F-38C4-A22E-2F855D7E83D1> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/Resources/libFontRegistry.dylib0x99d57000 - 0x99d5afff com.apple.help (1.3.2 - 42) <AD7EB1F0-A068-3A2C-9D59-38E59CEC0D96> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Help.framework/Versions/A/Help0x99dd8000 - 0x99ddcff7 libmacho.dylib (829) <5280A013-4F74-3F74-BE0C-7F612C49F1DC> /usr/lib/system/libmacho.dylib0x99dec000 - 0x99ee0ff3 com.apple.QuickLookUIFramework (4.0 - 555.5) <5A62C87F-5F74-380B-8B86-8CE3D8788603> /System/Library/Frameworks/Quartz.framework/Versions/A/Frameworks/QuickLookUI.framework/Versions/A/QuickLookUI0x99ee1000 - 0x9a0f8fff com.apple.CoreData (106.1 - 407.7) <EC4B8297-8E01-3778-A8A4-E8747F91109D> /System/Library/Frameworks/CoreData.framework/Versions/A/CoreData0x9a0f9000 - 0x9a108fff libGL.dylib (8.9.2) <1082B9A5-9AA3-35D4-968B-3A3FE15B1ED7> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib0x9a109000 - 0x9a40eff7 com.apple.CoreServices.CarbonCore (1037.6 - 1037.6) <4DB4B0C9-1377-3062-BE0E-CD3326ACDAF0> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/CarbonCore.framework/Versions/A/CarbonCore0x9a40f000 - 0x9a484ff7 com.apple.ApplicationServices.ATS (332 - 341.1) <BEE998BC-E4A5-3BA0-A6B5-31A1DFA1522C> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/ATS0x9a485000 - 0x9a49cfff com.apple.GenerationalStorage (1.1 - 132.3) <DD0AA3DB-376D-37F3-AC5B-17AC9B9E0A63> /System/Library/PrivateFrameworks/GenerationalStorage.framework/Versions/A/GenerationalStorage0x9a49d000 - 0x9a4e1ff7 libGLU.dylib (8.9.2) <F33F6C73-7F89-3B5B-A50F-2AB57BBA314D> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGLU.dylib0x9a4e2000 - 0x9a507ff7 com.apple.quartzfilters (1.8.0 - 1.7.0) <F6A88D89-AB4A-3217-9D65-C2C259B5F09B> /System/Library/Frameworks/Quartz.framework/Versions/A/Frameworks/QuartzFilters.framework/Versions/A/QuartzFilters0x9a508000 - 0x9a527ff3 com.apple.Ubiquity (1.2 - 243.15) <E10A2937-D671-3D14-AF8D-BA25E601F458> /System/Library/PrivateFrameworks/Ubiquity.framework/Versions/A/Ubiquity0x9a580000 - 0x9a620ff7 com.apple.QD (3.42.1 - 285.1) <BAAC13D2-1312-33C0-A255-FAB1D314C324> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/QD.framework/Versions/A/QD0x9a621000 - 0x9a63efff libCRFSuite.dylib (33) <C9D72D0C-871A-39A2-8AFB-682D11AE7D0D> /usr/lib/libCRFSuite.dylib0x9a63f000 - 0x9a68dff3 com.apple.SystemConfiguration (1.12.2 - 1.12.2) <15B4EFFC-22D1-3517-BE8C-7947DAA24729> /System/Library/Frameworks/SystemConfiguration.framework/Versions/A/SystemConfigurationExternal Modification Summary: Calls made by other processes targeting this process: task_for_pid: 7 thread_create: 0 thread_set_state: 0 Calls made by this process: task_for_pid: 0 thread_create: 0 thread_set_state: 0 Calls made by all processes on this machine: task_for_pid: 1847 thread_create: 1 thread_set_state: 0VM Region Summary:ReadOnly portion of Libraries: Total=276.9M resident=211.1M(76%) swapped_out_or_unallocated=65.8M(24%)Writable regions: Total=120.5M written=29.4M(24%) resident=72.5M(60%) swapped_out=0K(0%) unallocated=48.0M(40%) REGION TYPE VIRTUAL=========== =======CG backing stores 11.6MCG image 4KCG raster data 1212KCG shared images 1248KCoreServices 2084KIOKit 8KMALLOC 66.9MMALLOC guard page 48KMALLOC_LARGE (reserved) 512K reserved VM address space (unallocated)Memory tag=240 4KMemory tag=242 12KMemory tag=35 4400KStack 69.1MVM_ALLOCATE 24.3M__DATA 12.4M__DATA/__OBJC 200K__IMAGE 528K__LINKEDIT 62.9M__OBJC 2532K__OBJC/__DATA 4K__PAGEZERO 4K__TEXT 214.0M__UNICODE 544Kmapped file 115.3Mshared memory 10.5M=========== =======TOTAL 599.9MTOTAL, minus reserved VM space 599.4MModel: MacBookPro8,1, BootROM MBP81.0047.B27, 2 processors, Intel Core i7, 2.7 GHz, 16 GB, SMC 1.68f99Graphics: Intel HD Graphics 3000, Intel HD Graphics 3000, Built-In, 512 MBMemory Module: BANK 0/DIMM0, 8 GB, DDR3, 1333 MHz, 0x029E, 0x434D5341384758334D314131333333433920Memory Module: BANK 1/DIMM0, 8 GB, DDR3, 1333 MHz, 0x029E, 0x434D5341384758334D314131333333433920AirPort: spairport_wireless_card_type_airport_extreme (0x14E4, 0xD6), Broadcom BCM43xx 1.0 (5.106.98.100.17)Bluetooth: Version 4.1.4f2 12041, 2 service, 18 devices, 1 incoming serial portsNetwork Service: Ethernet, Ethernet, en0Serial ATA Device: Samsung SSD 840 PRO Series, 512.11 GBSerial ATA Device: HGST HTS721010A9E630, 1 TBUSB Device: hub_device, 0x0424 (SMSC), 0x2513, 0xfd100000 / 2USB Device: hub_device, 0x0409 (NEC Corporation), 0x005a, 0xfd120000 / 4USB Device: CFUDMA_SD Reader, 0x05dc (Lexar Media, Inc.), 0xb035, 0xfd123000 / 7USB Device: ANT USBStick2, 0x0fcf (Dynastream Innovations Inc.), 0x1008, 0xfd122000 / 6USB Device: PA241W, 0x0409 (NEC Corporation), 0x02b8, 0xfd121000 / 5USB Device: IR Receiver, apple_vendor_id, 0x8242, 0xfd110000 / 3USB Device: FaceTime HD Camera (Built-in), apple_vendor_id, 0x8509, 0xfa200000 / 3USB Device: hub_device, 0x0424 (SMSC), 0x2513, 0xfa100000 / 2USB Device: Apple Internal Keyboard / Trackpad, apple_vendor_id, 0x0246, 0xfa120000 / 5USB Device: BRCM2070 Hub, 0x0a5c (Broadcom Corp.), 0x4500, 0xfa110000 / 4USB Device: Bluetooth USB Host Controller, apple_vendor_id, 0x821a, 0xfa113000 / 6Operating System: Mac OS XVersion: 4.1.1.2 rc Side note. I removed my local prefs from $HOME/Library/Application Support/LibreOffice. Crashes still occurs.I found the same presentation just extended to about 100 slides and saved in ODS format. No crashes so far.About pasting the article from WikiTravel.First, the day I did a clean install of OSX I could paste it fully then it has been crashing while scrolling.I came back to the issue today and reinstalled LibreOffice. Now when I try to paste a wholel article I get only 3 pages (it should about about 17 pages) and then while scrolling crashes or freezes.I don't think it would be easy to reproduce on other instances. However, I can fully help with debuging it on my machine if anyone is interested?Still working on the issue.This is what I figured out.1. The PPTX file works without any problems on OpenOffice. Only LibreOffice issue related.2. The problem with pasting only 3 pages of 20 or so from WikiTravel is Firefox issue related. The same happens with OpenOffice, apart from it doesn't crash. Interesting thing is that pasting the article from Firefox to TextEdit or vim works fine. 3. There is no crashes now when article is copied from Safari. Then the whole article is pasted and no issues.So, there is still the issue with PPTX. I would like to share the file to any developers if needed.Thanks.***has been marked as a duplicate of this bug. ***Backtrace attached, so marking as NEW. Alsocontains a similar crash.(In reply to)Hi Bartosz Skowron,Would be great if you could attach your PPTX file. You can replace all the confidential information with some junk. Thanks.Also please test with the latest 4.1.2 release, and report the results. I think that your problem is related to, which has been fixed in 4.1.2. Thanks.I have upgraded to 4.1.2.3 and the problems are gone. However there is a new issue related to.A new problem exists while pasting a whole page.Then press cmd+q (quit) and the document is gone but you can't fully quit the LibreOffice. There is still icon in Dock and menubar, more - you can open or create new documents but you CAN'T quit LibreOffice (only by using Force Quit).Also, try to select all text fromand paste to LibreOffice then it freezes while saving.(In reply to)Great! So I'll close this bug.Let's not mix two completely unrelated bugs. Would be great if you could open a new bug report for this problem and post the link to it here, so we could continue that discussion over there.Opened here #70758
id=70941	This is the LibreOffice most annoying bugs meta tracker. For a description and details about most annoying bugs please visit. Bugs should only be added to this list by QA or Developers or by users if requested by a Quality Assurance (QA) member or a developer. If you feel like a bug you have submitted qualifies, please review the wiki listed above, and if the bug is particularly nasty (crasher, severe loss of data, etc...) please email the QA mailing list with the bug number and a short description of the bug so that the QA team can determine if the bug should be added to this list.For any questions, concerns or suggestions please email the QA mailing list: no french version of this bug report . I cannot say it in english thus i go forward in french, sorry :Dans libre office calc, à un certain moment, lors de la sélection d'une cellule, le programme se bloque et fait continuellement des sauvegardes du fichier.Ce fichier est irrécupérable par la suite !Added (hopefully correctly) as instructed by @michael_meeksMight not crash anything nor lose data as such, but gives appearance of lost data and indicates (a) file compatibility issue and (b) potential ODF compliance issue; both are serious from a user/adoption perspective.Bug 23631 doesn't belong here.@Joel: this is single LibreOffice MAB beyond 4.2 version, right?Unfortunately that hasn't been completely vetted yet so I don't think we're doing that quite yet - when we do, we should do ALL bugs at the same time but we need to figure out procedures a bit to ensure that bugs get tested appropriately and frequently enough.Joel, what's up with this? I do not get the purpose of this empty MAB bug.Created oct 2013 lastmonths ago. A single bug I see which I just tested and WORKSFORME.So setting this to INVALID. If this bug will be put to major use, why not create it again, when it's really needed.Currently it's just empty and cluttering the bug tracker without helping anybody.
id=71749	CreatedThe word document as exampleA word document (created with Word – Version 2000 9.0.9626 SP3) does not open with the following version of LibreOfficeVersion: 4.1.3.2 Build ID: 70feb7d99726f064edab4605a8ab840c50ec57aIn the following casewhen the table [production detail is inserted in a footnote].The document opens normaly if this table is inserted in the body instead of footnote.And it opens – in both cases – with LibreOffice 3.5.7.3 Please provide us with a document that makes LibreOffice crash as the one you attached is just showing a good document opening correctly.Marking as NEEDINFO - once document is attached please mark as UNCONFIRMED and we'll try to pinpoint the issue.Thanks!CreatedExampleLibreoffice loops while opening such files.CreatedExample #2 - Word doc with table in footnote crashes LOPrioritizing:Critical - crash/infinite loopHighest - default for critical bugs, seems appropriate here as we have a regression as wellConfirmedRegression bibisectedregressionmab4.2+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++73eaae9d1e97ec4b1f434cf01b5c1f97a5d8389e is the first bad commitcommit 73eaae9d1e97ec4b1f434cf01b5c1f97a5d8389eAuthor: Bjoern Michaelsen <>Date: Wed Oct 16 11:07:50 2013 +0000 source-hash-5da10275a7475efdbfd9de14ea58cf8f4c6c1582 commit 5da10275a7475efdbfd9de14ea58cf8f4c6c1582 Author: Stephan Bergmann <> AuthorDate: Fri Mar 1 17:09:45 2013 +0100 Commit: Stephan Bergmann <> CommitDate: Fri Mar 1 17:18:29 2013 +0100 Related rhbz#915743: Abort UCB call from SvtMatchContext_Impl::Stop ...as otherwise the SvtMatchContext_Impl thread can continue to run for arbitrarily long, and the other thread calling Stop() and join() will block. However, especially the WebDAV UCP does not properly support aborting commands, see 260afe56fd6b2f34de8290f3cdb7d1df5b88f8a8 " neon commands cannot be aborted", so this is not yet enough to actually fix rhbz#915743 "thread deadlock/slow join in insert->hyperlink in impress." Change-Id: I0da899f824763e1b3d19bb5b38d906feb690b623:100644 100644 fd22aadcebcf1ca20b6c2fcdb9e135deeb9b5885 8a0f14e1bb71d7ecdf8086c62e9769bb7f2d09b8 M autogen.log:100644 100644 5af869ab53b50329a270e7d4e2587f802bf68afb 8519bf956c5e06a85818d380070eedc0ef846790 M ccache.log:100644 100644 63cd7351c9d6feb098661a5783d51bb172d8a306 33abac29aad7182260562465482b493d94b78a83 M commitmsg:100644 100644 e9ea867065a69fa4f0fbbb5c2abb40baeeabd307 21fc5294b2cb922862b78327b6b8a3cd953f38b5 M dev-install.log:100644 100644 4c087a5ff52a8cef08f31417ac650666b1d9d0af c1cc87465560a589137349c81641a62968242386 M make.log:040000 040000 ece742cbaf9101d015210ea8da6c00ad7a4457c7 9ff9cbceea1fe6b0ad1b17fe9068b2c8e32a6cbb M opt# bad: [25428b1e953636f74986622c5df614f04c150ed1] source-hash-cb4e009c4539c535108021934e545194b35cad9d# good: [f0f6c65eb764f0303f59c58d320e9b0d5a894377] source-hash-4b9740b4ec3987e1d4d2ad6d20b4dcf996a4fa2egit bisect start 'latest' 'oldest'# bad: [a72833796a7e527d9efc9ca6d8fe9b579e469105] source-hash-1472b5f87314fe660ef1a7b254e51272669f12f6git bisect bad a72833796a7e527d9efc9ca6d8fe9b579e469105# bad: [4300c48268179afe8db66410fad04436183407cd] source-hash-753310b7db6a36aeaae36cef3bfca970e9310569git bisect bad 4300c48268179afe8db66410fad04436183407cd# good: [280c5141ea58e6b50f7d46546a9c52891225eeff] source-hash-ba446dd58a4ad324d242afcd5b28d3b4dff5a881git bisect good 280c5141ea58e6b50f7d46546a9c52891225eeff# bad: [8734d0269629a270d9e97cb5176bcc6b76338a54] source-hash-07352f07ce40ef40e9b73fd05aa4f9c5eac38290git bisect bad 8734d0269629a270d9e97cb5176bcc6b76338a54# bad: [b42797d9346abe9681bf36768258d309b83d17da] source-hash-ee53857e984fea54b7dc08b99079b38766f0b796git bisect bad b42797d9346abe9681bf36768258d309b83d17da# bad: [4384f6d33ec00ba3566675d505ee585a2af5be6d] source-hash-310fb291ccfb817a3503785af143828682c0c1f1git bisect bad 4384f6d33ec00ba3566675d505ee585a2af5be6d# bad: [817b9556dbb6406a10ff28416e98ff343df491e7] source-hash-b15f095293c6127ecaef2f0fa3a1683e72392835git bisect bad 817b9556dbb6406a10ff28416e98ff343df491e7# bad: [73eaae9d1e97ec4b1f434cf01b5c1f97a5d8389e] source-hash-5da10275a7475efdbfd9de14ea58cf8f4c6c1582git bisect bad 73eaae9d1e97ec4b1f434cf01b5c1f97a5d8389eThere may be a clue in the fact that (1) LibreOffice disables menu option Insert > Table in a footnote, and (2) pasting a table into a footnote causes a crash.reports this last problem.dont get a crash here but infinite loop somewhere in ww8 filter...regression from:commit 8bccae5d816abace259c9a1d0249e7195a2490d0Author: Bjoern Michaelsen <>AuthorDate: Wed Feb 13 02:49:57 2013 +0100Commit: Miklos Vajna <>CommitDate: Fri May 24 15:55:47 2013 +0200 fdo#43105: apply old sw-nested-positionned-tables-ww8-import-fix.diffused to work in 4.0.3.2, broken in 4.0.4.2Ahhh, great. sw-nested-positionned-tables-ww8-import-fix.diff was an old go-oo flr "fix" with all the joys of a quick and dirty insanely unhealthy looking hack including a "goto" statement. But without that, we would regress fdo#43105 (which also won a mab status)Michael Stahl committed a patch related to this issue.It has been pushed to "master":fdo#71749: sw: WW8: don't loop on tables in footnotesThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.looks like the filter did some special casing to not modify the bStartTab/bStopTab vars inside footnotes but the crude patch checked forthe modifications triggered from that in its loop condition....fixed on master(In reply to)the author was immediately obvious from the ugly coding styleMichael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#71749: sw: WW8: don't loop on tables in footnotesIt will be available in LibreOffice 4.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-4-1":fdo#71749: sw: WW8: don't loop on tables in footnotesIt will be available in LibreOffice 4.1.5.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-4-1-4":fdo#71749: sw: WW8: don't loop on tables in footnotesIt will be available already in LibreOffice 4.1.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=71409	Createdaccessible-event listenerSteps to reproduce:1. Launch the attached accessible event listener in a terminal2. Launch Calc3. Press F2 followed by Escape4. Repeat Step 3 several timesExpected results: There would not be duplicate accessible focused events.Actual results: The number of duplicate accessible focused events grows with each repetition.Impact: The more cells which the user edits, the more sluggish his/her Calc + Assistive Technology user experience becomes.(I'll build LibreOffice and, if I am successful, will verify that this issue persists in master. But experience over the years has proven that until it's reported by me or an Orca user, the problem persists.)========================PRESSED: F2 object:state-changed:focused False [table | Sheet Sheet1] object:state-changed:focused True [text frame | Cell A3] object:state-changed:focused True [paragraph | ] object:state-changed:focused True [paragraph | ]RELEASED: F2PRESSED: Escape object:state-changed:focused False [paragraph | ] object:state-changed:focused False [paragraph | ] object:state-changed:focused True [text frame | Input line] object:state-changed:focused True [text frame | Input line] object:state-changed:focused False [paragraph | ] object:state-changed:focused False [text frame | Cell A3] object:state-changed:focused True [table | Sheet Sheet1] object:state-changed:focused False [text frame | Input line] object:state-changed:focused False [text frame | Input line] object:state-changed:focused True [paragraph | ] object:state-changed:focused True [paragraph | ]RELEASED: EscapePRESSED: F2 object:state-changed:focused False [paragraph | ] object:state-changed:focused False [paragraph | ] object:state-changed:focused False [paragraph | ] object:state-changed:focused True [text frame | Input line] object:state-changed:focused True [text frame | Input line] object:state-changed:focused True [text frame | Input line] object:state-changed:focused False [table | Sheet Sheet1] object:state-changed:focused True [text frame | Cell A3] object:state-changed:focused False [text frame | Input line] object:state-changed:focused False [text frame | Input line] object:state-changed:focused False [text frame | Input line] object:state-changed:focused True [paragraph | ] object:state-changed:focused True [paragraph | ] object:state-changed:focused True [paragraph | ] object:state-changed:focused True [paragraph | ]RELEASED: F2PRESSED: Escape object:state-changed:focused False [paragraph | ] object:state-changed:focused False [paragraph | ] object:state-changed:focused False [paragraph | ] object:state-changed:focused False [paragraph | ] object:state-changed:focused True [text frame | Input line] object:state-changed:focused True [text frame | Input line] object:state-changed:focused True [text frame | Input line] object:state-changed:focused True [text frame | Input line] object:state-changed:focused False [paragraph | ] object:state-changed:focused False [text frame | Cell A3] object:state-changed:focused True [table | Sheet Sheet1] object:state-changed:focused False [text frame | Input line] object:state-changed:focused False [text frame | Input line] object:state-changed:focused False [text frame | Input line] object:state-changed:focused False [text frame | Input line] object:state-changed:focused True [paragraph | ] object:state-changed:focused True [paragraph | ] object:state-changed:focused True [paragraph | ] object:state-changed:focused True [paragraph | ]RELEASED: Escape (In reply to)Confirmed. This problem persists in master: LibreOfficeDev 4.2 Version: 4.2.0.0.alpha1+ Build ID: e9fdc84698a19e0ff2be9d676c84cc214cbc4f3dAlso bumping the importance from medium to high.Hi Joanmarie, thanks for reporting.Thanks to this report I have can identified the issue I was having working with calc, after a while working with a file enter data becomes slower with the time. It seemed a question of time working with the spreadsheet. But it is possible to reproduce using repeatedly F2 and [Enter], more visible if there is a formula in the cell. Doesn't happen pasting in a cell.I was not able find so far as to reproduce the problem.Reproducible:Wint7x64UltimateVersion 4.0.6.2 (Build ID: 2e2573268451a50806fcd60ae2d9fe01dd0ce24)Version: 4.1.4.0.0+ Build ID: d6ee64b75581cbeb92534271ee6f4e87f07aa5cVersion: 4.2.0.0.alpha0+ Build ID: df21d317dacc4533ac999f3c3088765393842676 TinderBox: Win-x86@42, Branch:master, Time: 2013-11-05_00:13:53Added to Mab 4.0You can reproduce this problem on the Mac too. And in a way that you can clearly see the impact this bug has on end users.Steps to reproduce (basically the same as the opening report):1. Launch LibreOffice and get into Calc2. Launch the VoiceOver screen reader with Cmd+F53. Press F2 followed by Escape4. Repeat step 3Each time you press F2, VoiceOver will say "edit text" and when you press Escape it will include the cell name (e.g. "Cell A1 edit text"). As you continue repeating step 3:The first thing you'll notice is an increasing delay in the amount of time it takes for VoiceOver to announce that you are back in the cell (the "Cell A1 edit text" message).After a few more repetitions, before you get the message that you are back in the cell, VoiceOver announces "LibreOffice busy". As you continue repeating step 3, there is an increasing delay between the time you hear "LibreOffice busy" to the time you are told you are back in the cell.confirmed in Linux kernel 2.6.32-358.23.2.el6.x86_64 with Gnome v2. DE and LODevVersion: 4.2.0.0.alpha1+Build ID: f99736820a23cb7e37139607713658dea1c69dd4TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2013-11-17_23:56:22Seems fixed in:Win7x64UltimateVersion: 4.2.0.0.beta2+ Build ID: 02180aed7dc0b8c5f9cc23b319adc2386a9aab69TinderBox: Win-x86@42, Branch:libreoffice-4-2, Time: 2013-12-08_08:48:31but remains in:Version: 4.1.5.0.0+ Build ID: 812963c5ff6e1c4685eddb830a82a69a3801d82(This is an automated message.)Setting priority to highest as this is a 4.0 MAB. This is part of an effort to make the importance of MAB reflected in priority too.Moving to mab4.1 () because:- 4.0 reached EOL (End Of Life)- bug confirmed in later version(In reply to)4.1.x is now END OF LIFE (latest release is 4.1.6).if you confirm the issue is gone in any of 4.2.x final releases we may mark this as RESOLVED WORKSFORMEAs I know it's long to be solved.I forgot to report here my last verifications:- To see the problem is needed to install with accessibility tools (at the end of installation).- Disable the option Menu/Tools/LibreOffice/Accessibility/Miscellaneous options - Support assistive technology tools it's no possible, restarting it's enable again.It's truly a pain work in calc with this issue, specially with a bit large spreadsheets.I need to review again and report.Please retain as MAB for now.Still reproducible with:Win7x64UltimateVersion: 4.2.4.1 Build ID: d4c441391e20647b3d2e8dde4d20aa868e77e515Version: 4.2.5.0.0+ Build ID: 59906c3d54e6541185f4bf85b1d1c70530198059 TinderBox: Win-x86@42, Branch:libreoffice-4-2, Time: 2014-04-30_09:30:13With an install from scratch, installing Support assistive technology tools, there are not activated by default. And the option to enable/disable "Support assistive technology" works fine after restart LibreOffice.IMO it must stay at MAB, for me calc is near to unusable with Accessibility tools activated.moving to MAB 4.2 with close of MAB 4.1please retest with LO 4.3.4.1 or 4.4.0.0 beta2if bug is still reproducible please move this bug to mab4.3 list since 4.2.x is EOLCONFIRMED in LO 4.4.0.0.beta2 and LO 4.3.5.1 on Ubuntu 14.04(In reply to Joanmarie Diggs from)Needed to install python-pyatspi package to use the listener.CONFIRMED: This still affect the LibreOffice 4.3 and 4.4 branches.thanks Robinson for confirmation, however MAB rules say that a bug can't be in more than one mab list, and should stay only in the older active mab list, in this case the mab4.3 list.so I'm removing it from mab4.2 and mab4.4 list.(In reply to tommy27 from)I know that the wiki says that, but I think that we should revisit the policy -- I was actually just mulling the situation on IRC.Perhaps the MAB tag can be one bug, and the versions can be a separate tag in the Whiteboard. I'll bring up something on the QA list.bc87fae0fc661b44769d71e41a0e8ce3dac3e857 is the first bad commitcommit bc87fae0fc661b44769d71e41a0e8ce3dac3e857Author: Bjoern Michaelsen <>Date: Tue Apr 24 23:20:22 2012 +0200 source-hash-f176c9ba7be7f3051a52b9f57b56124038c0cfd6 commit f176c9ba7be7f3051a52b9f57b56124038c0cfd6 Author: Luboš Luňák <> AuthorDate: Mon Dec 12 18:11:17 2011 +0100 Commit: Luboš Luňák <> CommitDate: Mon Dec 12 19:01:44 2011 +0100 fix docx hyperlink writing This is a rewrite of the fix for fdo#35826, needed for writing the document from bnc#706138 as docx. The sequence there is startURL(), runText(), endRun(), endUrl(), startUrl(), runText(), endUrl(), endRun(), so by the second endRun(), it is needed to close both the previous and current hyperlink run.:100644 100644 667b7a2b3aaad36686a048ec622be1fd26616060 3eaeee61bd5fa0f3d8f6c9b6ec3f463dc9d494f5 M ccache.log:100644 100644 1229c909f7bed7dde1f0393b90c984eabbab9f2c 55db144259b3df131a412f6be8fa35e33e2f60ec M commitmsg:100644 100644 2f6c623f4e5c5965e70543edbf39d6fd3091061a 7a0c14b66a0e1587b4149debbdbb7c2418a98b73 M dev-install.log:100644 100644 f90ce629cb38af243d7f4fca65cb21f7a05485cc 32241ae1bc69be7d0705c82c8242315fb6eca750 M make.log:040000 040000 b0d767299d9ff3967b6f134deee3e46b45305f21 2e711a87a2be36d3183b7c70566dd576fb20799c M opt$ git bisect log# bad: [423a84c4f7068853974887d98442bc2a2d0cc91b] source-hash-c15927f20d4727c3b8de68497b6949e72f9e6e9e# good: [65fd30f5cb4cdd37995a33420ed8273c0a29bf00] source-hash-d6cde02dbce8c28c6af836e2dc1120f8a6ef9932git bisect start 'latest' 'oldest'# bad: [e02439a3d6297a1f5334fa558ddec5ef4212c574] source-hash-6b8393474974d2af7a2cb3c47b3d5c081b550bdbgit bisect bad e02439a3d6297a1f5334fa558ddec5ef4212c574# bad: [8f4aeaad2f65d656328a451154142bb82efa4327] source-hash-1885266f274575327cdeee9852945a3e91f32f15git bisect bad 8f4aeaad2f65d656328a451154142bb82efa4327# bad: [369369915d3582924b3d01c9b01167268ed38f3b] source-hash-45295f3cdceb4c289553791071b5d7f4962d2ec4git bisect bad 369369915d3582924b3d01c9b01167268ed38f3b# good: [351622aec2dff3cc3bbbb020ad0097c4322d2a21] source-hash-2c4537471c932b65e6f72e41881b505c4bbad12cgit bisect good 351622aec2dff3cc3bbbb020ad0097c4322d2a21# bad: [378efb6e51212a05d1bd4b85c916eec5753c1744] source-hash-d453788ac0476cc02b929b0907718ca771d6d956git bisect bad 378efb6e51212a05d1bd4b85c916eec5753c1744# bad: [1a3c4b54a8782fe0f4bdba221e87012a92e4d323] source-hash-a330f38093e2643a26239557050561afae9ff23dgit bisect bad 1a3c4b54a8782fe0f4bdba221e87012a92e4d323# good: [cf86b7f14a98d2d81a5cd93507acb35ff6775d8b] source-hash-85c6244b85b29c1d2bb9d89b62e9512dd65378b5git bisect good cf86b7f14a98d2d81a5cd93507acb35ff6775d8b# bad: [bc87fae0fc661b44769d71e41a0e8ce3dac3e857] source-hash-f176c9ba7be7f3051a52b9f57b56124038c0cfd6git bisect bad bc87fae0fc661b44769d71e41a0e8ce3dac3e857# good: [0641af017cb9ec5ecca3eb879dded60fadf3ac78] source-hash-a1b970a10e00b34ab6d8608cb02247b8f0195573git bisect good 0641af017cb9ec5ecca3eb879dded60fadf3ac78# first bad commit: [bc87fae0fc661b44769d71e41a0e8ce3dac3e857] source-hash-f176c9ba7be7f3051a52b9f57b56124038c0cfd6The output of the bibisect does not make sense to me, the pointed commit seems totally unrelated with this problem; in fact, that commit only affects Writer code when this problem happens in Calc.@Jacobo:The result from bibisect 43all refers to a range rather than a single commit, so the culprit is between the source commits mentioned in bc87fae0fc and bc87fae0fc~1This began at the below commit.Adding Cc: to; Any chance you could take a look at this? Thankscommit c7551439a9ff4073a0b652329357be46d07b2c91Author: Noel Power <>Date: Sun Dec 11 16:40:52 2011 +0000 fix autocorrection sync problem with input/formulabar also, * make the GetEditView explicitly create EditEngine/EditView *always* * remove the bogus GetLine method * reset NotifyHdl when stopping the edit engineSpecifically it's the part of the above relating to inputwin.cxx/hxxUnfortunately some intervening change means that simply reverting this doesn't seem to fix the problem - possibly the one which removed the argument from InitEditEngine() (i.e. 4b6e0d42d72f8d2f5a18a0e0af595d884d96f552)Each time F2 is pressed I see two calls toaccessibility::AccessibleTextHelper_Impl::addAccessibleEventListenerwhile when Esc is pressed there is only one call toaccessibility::AccessibleTextHelper_Impl::removeAccessibleEventListenerThe two add calls are specifically#0 accessibility::AccessibleTextHelper_Impl::addAccessibleEventListener (this=0x1ac5e60, xListener=uno::Reference to (AtkListener *) 0x7fffc81142e0) at /home/asbel/Development/LibreOffice/core/svx/source/accessibility/AccessibleTextHelper.cxx:1583#0 accessibility::AccessibleTextHelper_Impl::addAccessibleEventListener (this=0x1c1a720, xListener=uno::Reference to (DocumentFocusListener *) 0x7fffc884b940) at /home/asbel/Development/LibreOffice/core/svx/source/accessibility/AccessibleTextHelper.cxx:1583while the single remove call is#0 accessibility::AccessibleTextHelper_Impl::removeAccessibleEventListener (this=0x1c1a720, xListener=uno::Reference to (DocumentFocusListener *) 0x7fffc884b940) at /home/asbel/Development/LibreOffice/core/svx/source/accessibility/AccessibleTextHelper.cxx:1590so if I understand correctly we are endlessly accumulating listener references to AtkListener*s without ever removing themThanks for the code pointers, I will try to get my hands on the code next week and maybe checkat the same time.Matthew Francis has (kindly) located the two places where we add the accessible listeners; to fix this we should first reproduce the problem; second put a couple of breakpoints into:addAccessibleEventListener and removeAccessibleEventListenerget a full (with symbols) backtrace from each of these.Clearly one of those code-paths is not going on to call removeAccessibleEventListener - hence the problem =)It'd be great to have help to fix this for the impaired.Thanks !CreatedBacktrace - addAccessibleEventListener (AtkListener)I'll add the backtraces one for each breakpoint mentioned in.CreatedBacktrace - addAccessibleEventListener (DocumentFocusListener)CreatedBacktrace - removeAccessibleEventListener (DocumentFocusListener)The AtkListener:is leaked through this trace as you see; thanks for that.It seems like the problem is the AtkObjectWrapper we have holds this context: css::uno::Reference<css::accessibility::XAccessibleContext> mpContext;We then connect an AtkListener to another interface on this Context:AtkObject *atk_object_wrapper_new( const ::com::sun::star::uno::Reference< ::com::sun::star::accessibility::XAccessible >& rxAccessible, AtkObject* parent )... // Attach a listener to the UNO object if it's not TRANSIENT... uno::Reference< accessibility::XAccessibleEventBroadcaster > xBroadcaster(xContext, uno::UNO_QUERY); if( xBroadcaster.is() ) xBroadcaster->addAccessibleEventListener( static_cast< accessibility::XAccessibleEventListener * > ( new AtkListener(pWrap) ) );So - now we have the object that we hold a reference on - that holds a reference to the new AtkListener UNO object - which (in turn) holds a GObject reference to us (ie. the pWrap AtkObjectWrapper).I -imagine- that therein lines the reference loop & the problem =)The AtkListener:is leaked through this trace as you see; thanks for that.It seems like the problem is the AtkObjectWrapper we have holds this context: css::uno::Reference<css::accessibility::XAccessibleContext> mpContext;We then connect an AtkListener to another interface on this Context:AtkObject *atk_object_wrapper_new( const ::com::sun::star::uno::Reference< ::com::sun::star::accessibility::XAccessible >& rxAccessible, AtkObject* parent )... // Attach a listener to the UNO object if it's not TRANSIENT... uno::Reference< accessibility::XAccessibleEventBroadcaster > xBroadcaster(xContext, uno::UNO_QUERY); if( xBroadcaster.is() ) xBroadcaster->addAccessibleEventListener( static_cast< accessibility::XAccessibleEventListener * > ( new AtkListener(pWrap) ) );So - now we have the object that we hold a reference on - that holds a reference to the new AtkListener UNO object - which (in turn) holds a GObject reference to us (ie. the pWrap AtkObjectWrapper).I -imagine- that therein lines the reference loop & the problem =)I imagine that a patch a bit like:Storing this guy: uno::Reference< accessibility::XAccessibleEventBroadcaster > xBroadcaster(xContext, uno::UNO_QUERY);On the Wrapper itself as an UNO reference (along with the AtkListener?)And in the:void atk_object_wrapper_dispose(AtkObjectWrapper* wrapper)removing the event listener - -might- make this work nicely ;-)Of course - not poked in the debugger to see whether that thing is disposed, and if so by whom etc. you'd hope that someone was disposing those things =)Failign that - quite possibly the specific implementation of XAccessibleEventBroadcasterin this case is not calling 'disposing' properly when the F2/Escape cycle happens; not sure ... =)Migrating Whiteboard tags to Keywords: (bibisected easyHack difficultyInteresting SkillCpp TopicCleanup)[NinjaEdit]JanI is default CC for Easy Hacks (Add Jan; remove LibreOffice Dev List from CC)[NinjaEdit]Dear all,I've done test and the problem is still present in version 5.1.2.Best regards.The good news is, for LibreOffice 5.2 this is gone with the gtk3 backend.The bad news is, it persists when using the gtk2 backend, i.e. for a gtk3 enabled build invoked with SAL_USE_VCLPLUGIN=gtk (note gtk instead of gtk2).On the other hand that might provide a a hint to look at the gtk2 specific code and see if there's something obviously different from the gtk3 code.While my suggestion may make it an easy hack - I don't think its a great candidate =)I'm taking a cursory look at this now.Createdaccessible-event listener adjusted for python3I've slightly modified the original listener script to adopt to python3 & specify the Atspi version.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":tdf#71409: properly remove itself from the context it listens.It will be available in 5.3.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#71409: Prevent the a11y code from creating an edit view instance.It will be available in 5.3.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.@Koheynice to see you hacking the LibO code againKohei Yoshida committed a patch related to this issue.It has been pushed to "master":tdf#71409: Use weak reference to avoid potential circular references.It will be available in 5.3.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":tdf#71409: Stop listening to objects going out-of-focus.It will be available in 5.3.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.I'll take it for now.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":tdf#71409: always create edit engine instance for the input window.It will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.So, this bug has exposed a number of distinct issues around the accessibility code, and with the last commit I think things are a little bit more under control.I'll mark this bug resolved for now. If you see any other issues please report it as a separate bug.Re-opening. My last fix is apparently crap.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":tdf#71409: Let's not crash the function wizard dialog.It will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Hopefully the last commit finally nails it...
id=72005	Createdexample of chart with hidden legendSteps to reproduce (or open the attached bugdoc):1/ open a new spreadsheet2/ create a chart3/ set the legend4/ fill the legend area with a color; keep the transparency to the default (no transparency)5/ save the filecurrent behavior: the legend is hiddenexpected behavior: the legend is visibleOpen the file saved at step 5 with LibreOffice 4.1 and note that the legend is visible.In 4.2 version, add transparency to the legend area: the legend becomes visible.The good news is that there is no dataloss, however set the severity to major because uninformed user may believe that her data are corrupted.Best regards. JBF Set keyword to regression: works as expected in version 4.1.xBest regards. JBFHello Jean-Baptiste,I confirm : with your attachment opened in LO 4.3.0.0.alpha0+Build ID: 4b9304ecdd067307e24e4388fe1addcab9e85bd0TinderBox: Win-x86@42, Branch:master, Time: 2013-11-22_22:53:41Windows 7 Home Premium,legend area is greyed.Legend contents are visible when I open this document on LO 4.1.3.2.Adding tranparency makes contents become visible in LO 4.3.I set status to NEW and Platform to All.JacquesCONFIRMED 4.2.0.0.beta2 + Ubuntu 12.04.3(In reply to)opened docNOREPRO verified with LO 4.1.2.2ConfirmedSounds good to me.***has been marked as a duplicate of this bug. ***Carrying over importance as set by Joel Madero for:"Critical - loss of data (or at least a reading error that makes users think the data is lost), main component (chart legends are very common)Highest - regression"I'm looking into this right now.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#72005: Insert the border rectangle to the bottom of the stack.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#72005: Add @since tag to the API documentation.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Request for 4.2 backport is underway:Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#72005: Insert the border rectangle to the bottom of the stack.It will be available in LibreOffice 4.2.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Now fixed.Thank you very much Kohei for this fix.Verified in version 4.2.1.0+Best regards. JBF***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Thanks for the fix - seen in 4.2.1.1 ubuntu 13.10.
id=72284	CreatedThe template file that is refered to in the bug report and which I downloaded from Xero help websiteProblem description: I use the Xero accounting website. They allow you to define your own templates for invoices. To do this you need to download one of their docx files and modify it to your needs. After making my changes I try to save it, when the program just crashes.Steps to reproduce:1. Open the attached file "Packingslipandinvoicetemplate.docx"2. Make any change to the document.3. Save it, as a docx fileCurrent behavior:When saving the document Write just crashes. The main window just disappears. On restart I get the option to recover the file, but it is at the same state as I opened it originally.Expected behavior:I expect the file to be saved correctly without Write crashing.Operating System: UbuntuVersion: 4.1.3.2 release Reproducible:Win7x64UltimateVersion: 4.1.4.1 Build ID: 414ce1317b94ce49e6044b84baf237918e9a659Even saving as odt, open odt and save again as docx, crash.File "Packingslipandinvoicetemplate.docx" is saved correctly without Write Crashing after making changes to the document.Operating System: Windows 7Verified on Build:libo-master~2013-12-11_02.11.28_LibreOfficeDev_4.3.0.0.alpha0_Win_x86.crashes in 4.2.0.4 tooChanged importance to reflect the new policy - SophieConfirmed:4.2.0.4:OSXI can reproduce a crash using Windows 8.1 Version: 4.1.4.2 Build ID: 0a0440ccc0227ad9829de5f46be37cfb6edcf72I can't reproduce a crash using Version: 4.3.0.0.alpha0+Build ID: 514a6de4822523164ef66916198e36944a826db3TinderBox: Win-x86@39, Branch:master, Time: 2014-03-21_00:39:06So marking as RESOLVED WORKSFORME (we don't know what patch fixed this issue, so not FIXED.If you still can reproduce a crash using version 4.3.0-master versions, please feel free to reopen this bug.Kind regards,JorenDownloaded attachment, opened it, tried to save as docx - libreoffice crashed.I use libreoffice 1:4.2.2~rc1-0ubuntu1~precise1 from ppa.(In reply to)Yes, and that's why I mentioned I used version 4.3.0, which is not released yet (will be released in Week 30 , Jul 21, 2014 - Jul 27, 2014 (see))Please retest using version 4.3.0 which you can download here:The fix, we don't know, will probably not be backported to 4.2 branch.No crash for me with dev. version 4.2.4.0.0+ (Build ID: fc70d91713332676dd2b8aa77d67684258493b15) under Ubuntu 13.10 x86-64Best regards. JBF
id=72394	LibreOffice 4.2 Beta 2 for MacOS X 10.9 freezes when saving any change in the Preferences (Options) windows. The problem happens with 32 and 64 bit versions, and you have to kill the program using Force Quit. Tested on two different MacBook, with different processors.To reproduce, launch LibreOffice, open a document (even a new one), open the Preference window, change one of the options in one of the panels (I tried with several combinations), hit Save to apply the change. The cursor does not change shape for a few seconds, then changes to the multi-colour wheel and stays as such forever (until you force quit the program). Hi Italo,thanks for reporting the problem. No problem on Ubuntu.Might be Mac-specific?Cheers,CorMmh, can't reproduce this one. Tested using Mac OSX 10.9 with a mid 2010 Macbook Pro 13".@Foss: any chance to reproduce this one :)?After a clean install of LO 4.2 Beta 2, I managed to find the culprit, and was able to reproduce the problem on Windows too. The freeze happens when you change a path in the Path section of the Options (Preferences in MacOS). I tried to change the Template path, and when I pushed OK the program froze. On Windows, I waited several hours, without any result. Tested on MacOS 10.9 and Windows 7, same behaviour on both OS.Confirmed on OS X 10.9 LO Version: 4.3.0.0.alpha0+Build ID: 5e01904de993caa3d497a8f6c82a846336e70eefTinderBox: MacOSX-x86@49-TDF, Branch:master, Time: 2013-12-06_02:05:01***has been marked as a duplicate of this bug. ***pls seetooStephan Bergmann committed a patch related to this issue.It has been pushed to "master":fdo#72394 Don't endlessly expand $(share_subdir_name) into itselfThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Stephan Bergmann committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#72394 Don't endlessly expand $(share_subdir_name) into itselfIt will be available in LibreOffice 4.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=72614	When I try to create a new style via right-click in the Styles and Formatting tab of the sidebar, Impress hangs with near-100% CPU usage.Steps to reproduce:1) Open Impress2) Open the Styles and Formatting tab on the sidebar3a) Right-click on any existing style, or3b) Right-click on empty area below existing styles4) Choose "New..."Expected result: dialog to create a new style appears.Observed result: Impress hangs with nearly 100% CPU usage.LibreOffice 4.1.4.2 (this version is absent from the above list), DEBs published by TDF.Creating a new style in a similar way works in Writer, Calc and Draw. Windows is also affected, tried with 4.1.1.2. Setting platform and version accordingly.Thanks for reporting, but please report bugs with status UNCONFIRMED. They only should change to NEW until someone was able to reproduce this behavior. Thanks in advance.But I can reproduce this behavior ;-) , tested using Mac OSX 10.9 with LibreOffice 4.1.4.2 RC and LibreOffice Version: 4.2.0.0.beta2 Build ID: 1a27be92e320f97c20d581a69ef1c8b99ea9885dLooks a critical bug to me.(In reply to)Ah, sorry, I thought bugzilla would set the correct initial status by default. Apparently not :)Not reproduce in LO 4.2.0.1 and LO 4.1.5+ Win 7 x64(This is an automated message.)Setting priority to highest as this is a 4.1 MAB. This is part of an effort to make the importance of MAB reflected in priority too.I investigated this bug:It seems we should NOT have a new option in the Presentation Styles, because the standard template window (F11) does not show the "New" option when click with right mouse button for Presentation Styles.I can "fix" the issue by adding a "bCanNew = sal_False" in the end of SfxCommonTemplateDialog_Impl::InvalidateBindings(this function is inside of file sfx2/source/dialog/templdlg.cxx), so it don't show the New options for the Presentation Style. But in this case, it does not show the New for Image Styles too...So, where can I proceed here? I'll try to track how these bindings are created and set, and maybe I'll try to find the code of standard template windowChanged importance to reflect the new policy - Sophie(In reply to)>tested under Win7x64LibO 4.2.3.3 hangs with both 3a and 3b steps so bug is still there unlikesays.LibO 4.3.0.0alpha1+ (*)doesn't hang with 3a and does nothing with 3b, anyway I'm not enough experienced with Impress style to tell if that behaviour is correct or not.what do you think?(*) Version: 4.3.0.0.alpha1+Build ID: 0b03f7ed575838f90e6b1ebec3538a3a214f81fbTinderBox: Win-x86@42, Branch:master, Time: 2014-04-30_02:30:23still reproducible in 4.2.4.2 moving to mab4.2 list since 4.1.x is END OF LIFEexperienced user opinion about 4.3.x behaviour is welcome.***has been marked as a duplicate of this bug. ***This was fixed in*** This bug has been marked as a duplicate of***
id=72949	CreatedExample spreadsheetThe attached sheet works in 4.1.4.2 and previous, but produces incorrect dsums in 4.2.0.1.The Interest sheet sums the balances within each interest range, in the criteria to the right, from the AC Cashflow sheet. The total should be 120.The criteria select a range of rates to sum. (eg > 0.005 and <= 0.0055).In 4.2.0.1, the result sometimes seems to depend on whether the Interest sheet is before or after the AC Cashflow sheet. Move the sheet, and you may get a different answer. When the sum is wrong, it is as if the lower bound has been ignored. The Interest sheet then sums balances up to a specific rate, rather than between the 2 rates in the criteria, and gives a total much larger than 120.It took me a long time to find this since I have a very involved set of financial sheets that produced different results for reasons that were very obscure. I narrowed it down to this dsum. CreatedSample file with first condition duplicated.Hi tim, thanks for reporting, important catch.Confirmed.Win7x64UltimateVersion: 4.2.0.1 Build ID: 7bf567613a536ded11709b952950c9e8f7181a4aIf I open your sample file in 4.2, I can see the issue, after doing a trials seems that function calculation doesn't take care of the first condition, except for B4 duplicating the first condition shows the calculations right. Attached file.The bug is with all database functions.A regression and a blocker for 4.2, broke the calculations without any notice.Investigating.Eike Rathke committed a patch related to this issue.It has been pushed to "master":resolved fdo#72949 evaluate criteria on the query rangeThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Eike Rathke committed a patch related to this issue.It has been pushed to "libreoffice-4-2":resolved fdo#72949 evaluate criteria on the query rangeIt will be available in LibreOffice 4.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Thanks Eike.Sorry for the delay in check.Seems solved:Win7x64Ult.Version: 4.1.6.0.0+ Build ID: 80df333af59124d484f7d87d83ba0acaef003ebVersion: 4.2.0.2 Build ID: cd65d6220c5694ee7012d7863bcde3455c9e3c30Version: 4.2.1.0.0+ Build ID: d72321b665f54946cf603e6f30740f31151c898f TinderBox: Win-x86@42, Branch:libreoffice-4-2, Time: 2014-01-16_02:01:06Version: 4.3.0.0.alpha0+ Build ID: 42f551d524a1df46f6a311d5897ac30bd8fc1aaf TinderBox: Win-x86@39, Branch:master, Time: 2014-01-15_22:44:37I have just checked in my main spreadsheet now on 4.2.0 RC2. Fixed. Thanks very much.
id=72953	I have a complex set of many tens of sheets, with many containing graphs of data in other sheets. In 4.0.2.1 all the graph legends are empty. They are OK in 4.1.4.2.I have tried to replicate the problem with a simple pair of sheets, one with a simple graph of the data in the other, but am so far unable to do so. I will keep trying and attach one later if I can.I cannot attach the file that shows the problem, or even send it by pm, because it contains highly personal financial data. I may be able to cut it down to just one non-sensitive example. CreatedSpreadsheet demonstrating the problemThe attached has 2 sheets - a graph and some data. In 4.2.0.1 the legend is blank. In 4.1.4.2 and previous is it not.This was created by deleting all non-relevant parts of a rather complex set of sheets. I'm hoping none of that data remains - I have looked. There are some empty macro modules (one per sheet) but that seems to be all. I'd be grateful if someone could inform me if I have left something other than the 2 sheets.Hey Tim -You are correct - and this looks quite nasty. Good catch.Verified onUbuntu 13.10LibreOffice 4.1.3.2 works fineLibreOffice 4.2.0.1 rc & 4.3 master built just a few days ago are both broken.Marking as:NewCritical - loss of data (or at least a reading error that makes users think the data is lost), main component (chart legends are very common)Highest - regressionConfirmedRegressionCC'ing Markus - think this one might be yours (or kohei's perhaps)I tried with some of my documents and the charts showed fine there. Looking further into it, I found that the legend disappears only if it has background colour set (in the sample provided here, it has white background). That problem is tracked at- resolving this one as duplicate.*** This bug has been marked as a duplicate of***OK - thanks. I can see that if I change the transparency the legend appears.When I tried creating a simple graph from scratch in 4.1.4.2 I couldn't reproduce the problem. I can't say I have ever set the background deliberately, but most of my graphs originally come from an Excel 2003 workbook, and that may be the source of the background colour.I'll wait for #72005 (and others) to get fixed before migrating to 4.2.Migrating Whiteboard tags to Keywords: ()Remove redundant 'ConfirmedRegression'[NinjaEdit]
id=73113	CreatedSample file with not working lookup functionI found that LOOKUP function is not working in many files created in previous versions of Libreoffice. A file attached to this report is an example of merging 2 datasets using LOOKUP function. In sheet "Kopa" there is LOOKUP, which is still working and in sheet "C" there is LOOKUP in column E, which is not working any more in 4.2.0.1 (showing #N/A for me in all rows, except cell E37, where correct result is shown). In 4.1.4.2 with the same locale settings (Latvian) everything works fine.Sheet "C" column F contains SUMIF function, which works fine with the same search criteria.I found similar problem with not working DAVERAGE function in previously created files.System: Ubuntu 13.04. 32 bit. Hi Andis, thanks for reporting.Confirmed.Win7x64Ultimate.Version: 4.2.0.1.0+ Build ID: 241eef7ca9b863ceb1f7f457a4bb2931b5d37f17 TinderBox: Win-x86@42, Branch:libreoffice-4-2, Time: 2013-12-28_23:19:40Last version working:Version: 4.1.5.0.0+ Build ID: 56381a9b28dbe4caf6e3d0a92dfddcddcebe349Regression and a blocker for 4.2, broke calculations with a common and basic function.In relation with Database function, there is a reported bug:So confirmed regression, non-OS specific (platforms -> all).c64ee04f962f148e5496ee63c1b85f5339d0cecd is the first bad commitcommit c64ee04f962f148e5496ee63c1b85f5339d0cecdAuthor: Bjoern Michaelsen <>Date: Thu Oct 17 14:30:14 2013 +0000 source-hash-022c54742e7997bf46a608f1ab0b500f2537f7f5 commit 022c54742e7997bf46a608f1ab0b500f2537f7f5 Author: Tor Lillqvist <> AuthorDate: Tue Jun 25 07:19:41 2013 +0300 Commit: Tor Lillqvist <> CommitDate: Tue Jun 25 07:19:41 2013 +0300 WaE: private field 'mrCells' is not used Change-Id: I0ab3fabb82c839f5194b0e20eb834dd86635a609:100644 100644 4b10c5c8ddbedca0971e0839a8acc603792a447c 483b58760a06de929b32eafde25a67466c622502 M ccache.log:100644 100644 54c63dd94c275598f317bb54ddfdd27aaad5d8a1 fcfaf4eddaf5f8c7a66f90a052cbf2c7473cdc9b M commitmsg:100644 100644 e607019f9ceabe4513be6de63f5724c67ece57f9 3e023e83e964fd4b90d7bdf45eab489c7382956c M dev-install.log:100644 100644 2d16d57e331ca5fab2ec46ad12fe030528c544bb 47ead046b9af75e2384d8d8f51767edfa54d5dc8 M make.log:040000 040000 3aaab4081e7400904dc31731c74182db7e18493c 82a20807f2d069e8294cfa6e30778214a869a341 M opt# bad: [25428b1e953636f74986622c5df614f04c150ed1] source-hash-cb4e009c4539c535108021934e545194b35cad9d# good: [f0f6c65eb764f0303f59c58d320e9b0d5a894377] source-hash-4b9740b4ec3987e1d4d2ad6d20b4dcf996a4fa2egit bisect start 'latest' 'oldest'# good: [a72833796a7e527d9efc9ca6d8fe9b579e469105] source-hash-1472b5f87314fe660ef1a7b254e51272669f12f6git bisect good a72833796a7e527d9efc9ca6d8fe9b579e469105# bad: [b21386bf459ae47bd6e461ea94cea6a06729a1ff] source-hash-570fe620e9d573cfc9fc260e6518563c6a6c1a3cgit bisect bad b21386bf459ae47bd6e461ea94cea6a06729a1ff# good: [8febbf1f26867388acf1d005b58978cbe4130d16] source-hash-7275a051677b5646e56623b3addc783880ce8e9bgit bisect good 8febbf1f26867388acf1d005b58978cbe4130d16# bad: [3897b261df824b9e25e5226d4fc17f28bfca2274] source-hash-61db96daa87754af24355d7ac94ee0305f22ff87git bisect bad 3897b261df824b9e25e5226d4fc17f28bfca2274# good: [cd4dab4f7cd1e732b0a3ca1eaadb9d52e6863867] source-hash-b139f6fedfcf3cbed0eadeb007e2155b576413d2git bisect good cd4dab4f7cd1e732b0a3ca1eaadb9d52e6863867# bad: [c133035ff38a0a861975e299b0debff65eff64d1] source-hash-344d80ee1d3829b28c18135ac4f0500d4b69aeddgit bisect bad c133035ff38a0a861975e299b0debff65eff64d1# bad: [633649b99650518c34fa17096a08fdce1955e0a6] source-hash-4d5fc661d37d03129b8054e494c03bed1933231dgit bisect bad 633649b99650518c34fa17096a08fdce1955e0a6# bad: [c64ee04f962f148e5496ee63c1b85f5339d0cecd] source-hash-022c54742e7997bf46a608f1ab0b500f2537f7f5git bisect bad c64ee04f962f148e5496ee63c1b85f5339d0cecd# first bad commit: [c64ee04f962f148e5496ee63c1b85f5339d0cecd] source-hash-022c54742e7997bf46a608f1ab0b500f2537f7f5Corresponding range:Setting it to the right component.Taking.Eike Rathke committed a patch related to this issue.It has been pushed to "master":resolved fdo#73113 not string cell does not mean no string at cellThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Eike Rathke committed a patch related to this issue.It has been pushed to "libreoffice-4-2":resolved fdo#73113 not string cell does not mean no string at cellIt will be available in LibreOffice 4.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#73113: Write unit test for LOOKUP.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Dear Sirs,I am using Libreoffice 4.2.1.1 in XP SP3.I have document with lots of lookup functions created on openoffice 3.x releases.I can confirm there is still bug in lookup function.Lookup function still returns N/A The function works well on MS Excel and Openoffice but not on Libreoffice.I kind you to ask to fix this matter a.s.a.pKind Regards,Burak Ural@Burak:Do you have a failing sample document you could attach?CreatedSample file regarding lookup function bugLookup function works only if all data is current sheet. If data is called from another sheet , it fails.Using Libreoffice 4.2.1.1 on Windows XP SP3.I uploaded a sample file in my previous post just now.Please test yourself.Kind Regards,Burak UralIt's better to file a new bug for a new test case. Reopening should be done only when the original test case fails. But I'll leave the decision up to Eike.Hi Burak,search vector must be sorted,(),and your are looking in the wrong column, data for search vector are in Sheet2.B not in Sheet2.Awith data sorted by Sheet2.B, your formula should be:G3: =LOOKUP(F3;Sheet2.$B$3:$B$16;Sheet2.$A$3:$A$16)For me not a bug. If you are not agree, please as Kohei has suggested file a new bug.IMO, Eike can reset the status to Resolved Fixed.I am sorry , I made some error during creating a sample file.I did test and confirm :1- Even unsorted it is working.2- It is working if the data is in different sheet.3- It is NOT working if the search area is bigger actual area filled with data.For example:1 a z2 b x3 c y4 d v5 e tIf I use formula =lookup(a1;b1:b100;c1;c100) - imagining I will enter more data in future - so I set search area much longer b100 instead of b5 , the result becomes N/A.Other spreadsheet software does not get affected of empty cells.Would you please classify this as a bug and fix it?Sorry for the previous confusion but I just found out why exactly my calculations were not working.Kind Regards,Burak Urala1;b1:b100;c1;c100 = > a1;b1:b100;c1:c100Typing mistake ; instead of :Just in case if you think I used a wrong formula.The bug exists if the search area is bigger than actual data area.(In reply to)That's an entirely different issue. I'll close this bug once again.Try again oncefinds its way into the stable branch. You are still welcome to file a new bug with your test case too then we can verify if that's really a duplicate of.After doing some more tests, I can confirm this problem I have , is definitely specific to the file I work with.Please there are other formulas with empty cells and they are working fine.Whatever the reason do not think anymore it is not about formulas.In my document there are 406 lines with data.I have added more data and after 500 lines , the formula began to work.I could not produce the same situation with entering data to a new sheet and creating same number of data using a lookup function that has more search area defined.Sorry for taking your time.It is likely that your problem is an incarnation of one of the other VLOOKUP bugs fixed for 4.2.2/4.2.3.Setting this one RESOLVED again.Unfortunately that is not so.I mean it has nothing to do with Vlookup bug fixed.This is something like for example the page preview disapperance bug.Sometimes, while working on Calc, I place a picture into the document.I click print preview and all I get is an empty page.I copy whole sheet into another sheet and it gets normal.There is something wrong within the depths of openoffice/libreoffice code that fails sometimes for some reason...In this case, I have a long xls with 5 sheets and some formulas.The last sheet has the calculation formula from other sheets and while other sheets has 400 and 700 lines, the formula covers 1000 lines of other sheets.Interestingly in Libreoffice 4.1.2.2 , the lookup formula referencing 2nd sheet works fine. Lookup formula referencing first sheet was giving N/A until I filled up to 500 lines with data and deleted the data returning to previous stage, however the lookup code worked fine after this.Yesterday, I downloaded 4.2.3.1 release current on the main download page.I wanted to test the original xls to see how the lookup code would react.Interestingly this time even the previous working lookup referencing 2nd sheet did not work.I again entered junk data up to 1000 lines and removed and it worked fine.However this only happens with my xls sheet. I can not produce it with a small self made sheet. So something out there , I have no idea.Regards,Burak UralPleae Burak, could you hear what developers said and have a bit of confidence in them.Looking in the bugas in theKohei have informed,In that bug the last patch is 2014-03-13 15:43:04 UTC 4.2.3.1 was compiled (Windows) 13-Mar-2014 21:15so it's not possible the patch is in 4.2.3.1I have verified it is fixed in daily releases:Version: 4.2.4.0.0+ Build ID: b5b9da46ceae23b25e963087d00b0ae5b4785c93 TinderBox: Win-x86@42, Branch:libreoffice-4-2, Time: 2014-03-13_23:32:39Version: 4.3.0.0.alpha0+ Build ID: 12ae7672f285da1d4c730315e8db23b3396b71cc TinderBox: Win-x86@39, Branch:master, Time: 2014-03-14_00:18:00Please have a bit of patience (the patience is the mother of the science) and stop adding new comments in this report, it doesn't help in any way.Migrating Whiteboard tags to Keywords: (bibisected)Remove redundant 'ConfirmedRegression'[NinjaEdit]
id=73168	Createdscreen shots of crashCrash with a message "JRE is Defective" while running Oracle Java 1.7.0_45 (or Sun 1.6 0_45 or Sun 1.6 0_22 or Sun 1.6 0_18)---------------------------------------------------LibreOffice crashes in several circumstances. In this instance I am editing a cell function "=ROUND(D41*0.2,2)". When I do I get the message "LibreOffice requires a Java runtime environment (JRE) to perform this task The selective JRE is defective. Please select another version or install a new JRE and select it under Tools - Options - LibreOffice - Advanced.". I do this and the situation still occurs.I used to have this problem occasionally with earlier versions of LibreOffice and a switch of JRE in the "Tools - Options - LibreOffice - Advanced" tab would fix it. Nothing seems to fix it now and it just crashes and crashes. I have had to install Open office just to get work done. I have used LibreOffice for a number of years and like it. It would be great to resolve this and get back to it.Any suggestions please? Hi Maurice, thanks for reporting.I think LibreOffice doesn't need java with functions.In any case verify you are using a 32 bits java, 64 bits doesn't work.Try resetting the user profile, sometimes solves strange issues.Have you added some extension?Link about change user profile.Maurice reports by E-mail that he has removed his profile, and the problems persist.Maurice - can you confirm that you have no extensions installed ? This is not the 1st instance of problems in calc around formula editing and Java - I suspect that we attempt to use the scripting framework to check if there are any scripts present in each language (or something similarly silly), and this blows up with Java. what does "Tools->Extension Manager" show ? (another screenshot would be awesome).Maurice - can you report whether Calc continues to work if you hit 'ok' ? I appreciate it throws up a scary looking dialog but ... it shoudl continue to work.It sounds like we've got some problem here rather than all of the installed JRE's being defective of course :-)What would be really helpful would be to get a better exception message out of that beastie I guess.Stephan - any thoughts ? marking a MAB anyway.void SAL_CALL JavaInteractionHandler::handle( const Reference< XInteractionRequest >& Request ) throw (RuntimeException)is where the error comes from: com::sun::star::java::JavaVMCreationFailureException e4;... else if ( anyExc >>= e4 ) { if( !(m_bShowErrorsOnce && m_bVMCreationFailure_Handled)) { // Java not correctly installed, or damaged SolarMutexGuard aSolarGuard; m_bVMCreationFailure_Handled = true;#ifdef MACOSX ErrorBox aErrorBox( NULL, SvtResId( ERRORBOX_JVMCREATIONFAILED_MAC ) );#else ErrorBox aErrorBox( NULL, SvtResId( ERRORBOX_JVMCREATIONFAILED ) );#endif aErrorBox.SetText(SvtResId( STR_ERROR_JVMCREATIONFAILED ).toString()); nResult = aErrorBox.Execute(); } elseI guess we could try to provide / tunnel through more useful data here from the exception ? then again there is no useful information in the exception as it is thrown either.stoc/source/javavm/javavm.cxx: css::java::JavaVMCreationFailureException exc( OUString("JavaVirtualMachine::getJavaVM failed because Java is defective!"), static_cast< cppu::OWeakObject * >(this), 0); askForRetry(css::uno::makeAny(exc));I guess (?).Thanks !Createdattachment-7005-0.htmlMichaelThis will obviously sounds completely stupid but what extension are youtalking about.The screenshots pdf attached ("131231 Bug report 73168 screenshots") showsa number of extensions which I have not myself consciously installed.Going bacck to my crashing spreadsheet, When I had pressed OK to the "JREis Defective" message it did not crash immediatelybut as soon as I tried to put in an "=" formula, up popped the message. Ithen pressed the ESC keyand up popped the "Runtime Error!":"Program:This application has requested the runtime to terminate in an unusual way.Please contact the application's support team for more information".I then pressed Okay and it automatically and instantaneously closedLibreofficeI recovered the spreadsheet and sods law but I can't now get it to crash!Yesterday several different calc files were crashing.Very puzzling!MossOn Tue, Dec 31, 2013 at 9:46 AM, <> wrote:>>>>>>>>>>>>>>>>>>>Createdattachment-7005-1.datCreated131231 Bug report 73168 screenshots.pdfIn:seems NUMBERTEXT extension leads to a similar issue with the '='.* Maurice, the reason that LO tries to instantiate a JVM as soon as you are "editing a cell function '=ROUND(D41*0.2,2)'" is probably the CalcStockAddIn.oxt extension you have installed (per). Maybe the problem disappears if you disable or remove that extension.* The "The selected JRE is defective" error box ultimately must be caused by one of the four uses of JFW_PLUGIN_E_VM_CREATION_FAILED in jvmfwk/plugins/sunmajor/pluginlib/sunjavaplugin.cxx (i.e., either unable to load the JVM lib, no JNI_CreateJavaVM exported from that lib, or an error when calling that JNI_CreateJavaVM). On Windows, this is most likely caused by the JVM lib depending on other libs (like a C++ runtime lib) that cannot be found; maybe do_msvcr71_magic (jvmfwk/plugins/sunmajor/pluginlib/sunjavaplugin.cxx) does not work as intended for some reason.I don't think I installed the CalcStockAddIn.oxt extension but I have nowdisabled it. Very many thanks for your help. I hope it works. All seemsgood at the moment! Fingers crossed.Thanks againOn Mon, Jan 6, 2014 at 1:02 PM, <> wrote:>>>>>>Maurice please only reply via browser not via mail. Otherwise the bug tracker will be cluttered with lots of useless info. Thanks for understanding.Changed importance to reflect the new policy - SophieMaurice does this persist with 4.2.0.4?I'm on version 4.1.4.2 now. I disabled the CalcStockAddIn and I haven't crashed since. Many thanks for the helpThanks for the feedback ! Stephan - is there any way we can protect against JVM's missing native symbols like that ? ... or is it a lost cause ? =)It would be great to know what the stack trace is/was when that add-in was in-use and the error message came up; I wonder ifmay have fixed this too.Can anyone reproduce this ? and/or Stephan - is there a way that we can easily simulate this for unit testing in calc - injecting a bad JRE somehow ?I'm in the process of cleaning the mab4.1 list.is this bug still reproducible in LibO 4.2.x?if YES, move it to mab4.2if NO, mark it as RESOLVED WORKSFORMEMany thanks
id=73216	Problem description: Wenn you save a calc file in .xslx format the format changes fromSteps to reproduce:1. Put some numbers in the sheet2. Save the file in .xlsx format3. Re-open the format4. you will see that the number changed to #### also the format changes.Current behavior: the format changes and the number get changed to ####seefor this. Expected behavior:The format doesn't change. Version: 4.2.0.1 Build ID: 7bf567613a536ded11709b952950c9e8f7181a4aSeems that there was no problem in beta 1 (I didn't test beta 2)Operating System: Mac OS XVersion: 4.2.0.1 rcLast worked in: 4.1.4.2 release Hi Thomas,thank for the clear report & video. No problem on Ubuntu.Thanks Cor,Seems that is cann't reproduce this after I have reset my user profile for the second time. I find it still a wired bug but I will close it.Migrating Whiteboard tags to Keywords: (possibleRegression)[NinjaEdit]
id=73565	CreatedAutofilter on date bugCreate a spredsheet document.Set the first column as "Date" format.Name the first line as "Date" for header.Then enter 3 dates, one by line.Generate an autofilter.Click on the down arrow, and.... "dummy" ?See screenshot Createdscreenshot with correct meta fileConfirmed with Version: 4.3.0.0.alpha0+Build ID: fb7899e2423d26710200e46f66cf85894525afecTinderBox: Win-x86@39, Branch:master, Time: 2014-01-08_04:02:07Regression between 4.1.4 and 4.2.0.Still there in the latest 4.2.0.3 (4.2 RC3)I hope it'll be fixed before official release :/Bouh! This make filtering on dates unusable. Adding to MAB 4.2Best regards.CCing Calc devsBug still there in final 4.2.0.4Bug still there in version 4.2.1.1 Build ID: d7dbbd7842e6a58b0f521599204e827654e1fb8b Linux X64 DEB***has been marked as a duplicate of this bug. ***We need a test document. I can't reproduce this.Createdtest document showing the problemHere is a test document. I added a list of dates in the column A and set the autofilter.Best regards. JBFThanks. Hmm it still works for me. Perhaps this is French locale specific, since the dates are locale-specific.Yup, switching LANG to fr_FR.utf-8 and it's reproducible.I got this.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#73565: Populate date members in a locale-safe way.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.4.2 backport:Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#73565: Populate date members in a locale-safe way.It will be available in LibreOffice 4.2.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Fixed.(In reply to)Thank you very much Kohei !Verified fixed on version 4.2.3.0.0+. :-)Do you plan a backport to 4.2.2 ?Best regards. JBF(In reply to)I tried, but gerrit is not coorporating.git push origin HEAD:refs/for/libreoffice-4-2-2Counting objects: 13, done.Delta compression using up to 8 threads.Compressing objects: 100% (7/7), done.Writing objects: 100% (7/7), 1.45 KiB, done.Total 7 (delta 6), reused 0 (delta 0)remote: Resolving deltas: 100% (6/6)remote: Processing changes: refs: 1, done remote: (W) No changes between prior commit 018244d and new commit 430b872To ssh://logerrit/core.git ! [remote rejected] HEAD -> refs/for/libreoffice-4-2-2 (no changes made)error: failed to push some refs to 'ssh://logerrit/core.git'And there *is* a change between the commit. Sorry I don't have time to investigate this right now. I need to move on.Thanks Kohei, nice the new selection for dates.Verified in:Version: 4.2.3.0.0+ Build ID: 7af1124f83df4d96f6ebe58536de7c51406df661 TinderBox: Win-x86@42, Branch:libreoffice-4-2, Time: 2014-02-20_11:39:39Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-2-2":fdo#73565: Populate date members in a locale-safe way.It will be available already in LibreOffice 4.2.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***
id=74009	Problem description: When a spreadsheet cell has long text value (text over-flowing outside cell width), the over-flowed part was not printed, both for print preview and actual printing.Reproduced in Ubuntu 13.10 x86 and Windows 8 X86. This is a regression against 4.1.4.2.Steps to reproduce:1. Start Calc, input "abcdefghijklmnopqrstuvwxyz" in A1 (some of the chars are outside the cell width)2. Print preview, you only see "abcdefghijklmn"3. Print the file, you only got "abcdefghijklmn" on the paper.Expected behavior:You got "abcdefghijklmnopqrstuvwxyz", both in print preview mode and actual printing.I believe this should be a blocker of 4.2.0 release. Operating System: AllVersion: 4.2.0.3 rcLast worked in: 4.1.4.2 release Bug confirmed under Windows XP Pro x86 SP3.It is indeed a regression from branch 4.1. And a bad one...Confirmed using Version: 4.2.0.3Build ID: c63c03decdf780d8fb80823950665b782ec9ecd0 Ubuntu 13.10I don't think it's a bloker but should be on the MAB, so I reduce to critical and set Highest for the new MAB policy.For me this behavior is not a bug:1/ spreadsheet is not a word processor2/ it is the responsibility of the user to manage the visibility of its data3/ if you write in the next cell on the right, the part of the text that overflow outside the cell becomes not visible, exactly as in the preview. It is true even if you put a blank character in the adjoining cell.4/ you can manage the text formatting so that long text is automatically wrapped in the cell.5/ use cell fusion when it is useful.That said, what seems buggy is the following:1/ type a long text in the cell A1 so that it overflow outside the cell2/ menu File > Page Preview ==> only the part of the text which is inside the cell width is visible3/ type a long text in cell A2 so that it overflow outside the cell4/ menu File > Page Preview ==> same behavior as in 2/5/ now, merge the cells in A1 so that the merged cell A1 contains the entire text6/ menu File > Page Preview ==> all the text in A2 is now visible.So it seems that the cell width in column A used in the preview (idem in pdf export) is the width of A1, not the real width of the cell. I think it is not the intended behavior that the apparent width of a cell depends on the width of another cell.Best regards. JBFI guess this bug may be caused by the patch of. (Sorry I just guess, I am not a developer nor IT professional.No longer reproducible using the latest from libreoffice-4-2 branch as of today.It was reproducible as of mid last week. So, I guess some of the fixes that went in must have fixed it.Someone please verify this.It didn't make it into the 4.2.0 branch. So I guess this will be fixed in 4.2.1.I'll mark this as resolved for 4.2.1. Still reproducible using the libreoffice-4-2-0 branch, but it's gone in the libreoffice-4-2 branch. No idea which change has fixed it, so I'll use WORKSFORME.
id=73805	CreatedThe test document (appending further text causes error)Problem description: When I write more than two lines in a section consisting of three columns, LO-Writer crashes.Steps to reproduce:1. Open attached document2. Append any text to the first column.Current behavior: The application stops working.Expected behavior: The application should continue working and the entered text should be wrapped to the second column. Operating System: Windows (other)Version: 4.1.4.2 release I confirm this bug on the two versions below. I'm changing the priority to highest blocker since this bug causes frequent freezes.I tested using:WIN 8x86-64Version: 4.2.0.2Build ID: cd65d6220c5694ee7012d7863bcde3455c9e3c30andVersion: 4.1.4.2Build ID: 0a0440ccc0227ad9829de5f46be37cfb6edcf72On pc Debian x86-64 with master sources updated today, I can reproduce this.I tried some gdb and noticed this:3 breakpoint keep y 0x00002aaac8e98b66 in SwLayoutFrm::ContainsCntnt() const at /home/julien/compile-libreoffice/libo/sw/source/core/layout/findfrm.cxx:105 breakpoint already hit 691 timesSeeMichael: one for you?Tested with versions master, 4.2.1.0.0+ and 4.2.0.2 on Ubuntu 13.10 x86-64. No crash for me but LO freezes with what seems an infinite loop. There is something strange in the test file: 1/ it has 2 lines in the first column and nothing in column 2 and 32/ the section is formatted with the option "Evenly distribute contents to all columns"These 2 facts are incompatible: with 2/ we should have one line in column 1 and one line in column 2.If I go to Format > Section > Options > Tab Column and uncheck the option, then I do not reproduce the freeze anymore. If I insert some text, go back to the column tab and recheck this option, it still works as expected.Last thing, I can't reproduce the problem from an empty file:a/ insert a section with 3 columnsb/ type some text in column 1whatever is the option chosen for the text distribution in the columns.Hope this helps. Best regards. JBFthat's amazing - this loops (on Linux) in every version of LO and OOo i tried,back to OOo 3.0.1. so no regression. but very good reproducer document :)lots of assertions like this:warn:legacy.osl:6156:1:sw/source/core/layout/flowfrm.cxx:2532: <SwFlowFrm::MoveBwd(..)> - layout loop control for layout action <Move Backward> applied!warn:legacy.osl:6156:1:sw/source/core/layout/layact.cxx:851: LoopControl_2 in Interrupt formatting in SwLayAction::InternalActionwith 2 or 4 or 5 columns it doesn't loop.un-checking "Evenly distribute contents to all columns" makes it not loop.if the first-line indent of the paragraph in the section is set to 0then it loops just for a couple of seconds and the document is theneditable again.(In reply to)i guess Widow / Orphan settings have something to do with this.freeze still reproducible under Win7x64 using 4.2.3.3moving it to mab4.2 list since 4.1.x is END OF LIFEJust for information, I can reproduce this on pc Debian x86-64 with master sources updated yesterday.***has been marked as a duplicate of this bug. ***retested under Win8.1 x64both LibO 4.3.4.1 and 4.5.0.0alpha freeze after adding text to 1st columnmoving bug to mab4.3 list since 4.2.x is EOLI can reproduce this from scratch.1. New Text Document.2. Press Enter (if no empty paragraph then red arrow syndrome).3. Insert → Section → Columns → 3 and Insert.4. Place cursor in section and right click → Paragraph → Text Flow → check both Orphan and Widow control and OK.5. Save and reload document.6. Type enough text for two lines in the first column.7. Save and reload document.8. Place cursor at the end of the text in the first column of the section and type some more text.Result:Hang.If step 2 is left out then the cursor disappears to the right while typing. After saving, additional text causes a red arrow to pop up in the first column.Windows Vista 64Version: 4.4.4.3Build ID: 2c39ebcf046445232b798108aa8a7e7d89552ea8On pc Debian x86-64 with master sources updated today, I could reproduce the loop with Gordo's example.I noticed these logs on console:warn:legacy.osl:24138:1:sw/source/core/layout/flowfrm.cxx:2395: <SwFlowFrm::MoveBwd(..)> - layout loop control for layout action <Move Backward> applied!Dropping Severity -> critical (we've deprecated the 'blocker' value)Bug still in 5.1.0.3 win 8.1
id=74104	Createdtest document which crashes LO 4.2Steps to reproduce:1/ open the test document in Impress version 4.2.0.32/ select and copy the typographic quote at the end of the texte in "L'apostrophe"3/ move the cursor somewhere in the text4/ ctrl+H5/ type ' (single quote) in the search field and ctrl+V in the replace field6/ hit search button , the hit replace button7/ hit replace button until the end of the file==> crash when search & replace comes at the endCrash has been reproduced on MS-Windows and Ubuntu (French QA mailing-list)It seems that some other special characters trigger the crash.Best regards. JBF It's much worse than reported here:Open fileCtrl + hsearch for the letter areplace with esdo replace over and over until it reaches the end, results in a crashUbuntu 13.10 Version 4.2.0.3No crash with 4.1.3.2Thorsten - you want this one?Importance should be highest if it is a MAB.Maybe this bug andhave the same root cause. Both describe a crash when the end of the file is reached.Best regards. JBFconfirmed with latest 4.2.0.4 under Seven x64(In reply to)Asmentioned, this still affects 4.2.0.4, which is now an official release...It does indeed look like this bug is related to. Also, it appears that both bugs affect both Draw and Impress.To sum up, Using Find, Find & Replace, or Spell check in either Draw or Impress will cause LO to crash when it searches again from the beginning of the document.Yeah - a bibisect would be nice on this one. Adding whiteboard status. This is why 4.2.0 is for people who want cutting edge vs. completely stable ;) For those people definitely stick with 4.1 series a bit longerregression according to*** This bug has been marked as a duplicate of***Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#74104 fdo#73904 backport Message dialog creation from message stringsIt will be available in LibreOffice 4.2.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.***has been marked as a duplicate of this bug. ***Migrating Whiteboard tags to Keywords: (bibisectrequest)[NinjaEdit]
id=74014	Cell formula not updating.Step to Produce :Method 1.1. Column having values 20, 10, 25, 30, 10. & Sum in the 6th row.2. Just cut the 1-5 row cell values, sum cell is become zero. 3. Just undo the operation, Values comes back in cell, but still sum cell is zero.4. Press f9 in sum cell. No change in the sum value.5. You need type a value in 1-5 cell to update the sum formula or close & open file again to update.Method 2.1. Column having values 20, 10, 25, 30, 10. & Sum in the 12th row cell.2. Copy first 4 values.3. Paste using un-formated[ Paste special option] in 5-8 cell.4. No change in the sum value.5. Press f9 in sum cell. No change in the sum value.6. You need type a value in 1-8 cell to update the sum formula or close & open file again to update. CreatedSample documentsample document for testing.Reproducible, tested using Mac OSX 10.9 with LibreOffice Version: 4.3.0.0.alpha0+Build ID: 8fd7a53d3cf1ed788c705cafb443801203787c9dTinderBox: MacOSX-x86@49-TDF, Branch:master, Time: 2014-01-22_00:10:03Not reproducible using LibreOffice Versie: 4.1.4.2 Build ID: 0a0440ccc0227ad9829de5f46be37cfb6edcf72I'm not that experienced with Calc-matter, so I hope someone else can determine it's a big bug or not :). Marking as regression for sure.Kind regards,JorenDiscussed this one on IRC with Markus and Joel. Marking as Critical HIGHEST. Will affect many users and it's a pretty nasty bug. Thanks for reporting!@Eike: ping :). Looks a nasty one.Kind regards,JorenReproducible.Win7x64UltimateVersion: 4.2.0.3 Build ID: c63c03decdf780d8fb80823950665b782ec9ecd0Version: 4.2.1.0.0+ Build ID: 23221e48495262d0384c9169a0d8a01db8a5dab5 TinderBox: Win-x86@42, Branch:libreoffice-4-2, Time: 2014-01-21_13:02:45Version: 4.3.0.0.alpha0+Build ID: 77637324abc193d831bb4a0fa6f9a91ef3601960 TinderBox: Win-x86@39, Branch:master, Time: 2014-01-22_16:19:04No issue with:Version: 4.1.6.0.0+ Build ID: 873be8f3ff28fd06b531b17d2c7cc41cbc1385eIn both cases hard recalc does the job.Maybe the cells aren't set as dirty after undo.I don't quite get Method 2. My questions are inline.(In reply to)Do you mean put values in A1:A5 and put formula "=SUM(A1:A5)" in A12? or is the formula "=SUM(A1:A11)"?I assume copying A1:A4?This I don't get. When I paste-special at this point, I get the dialog containing "Selection", "Operation", "Options", "Shift cells". But your step seems to suggest the other paste special dialog.Could you clarify on this?Method 1, on the other hand, was reproducible, and I have a fix at the ready.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#74014: Write unit test for this first.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#74014: Broadcast cells on undoing of "cut".The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.4.2 Backport request:Createdsample option(In reply to)Picture is attached. Sorry for confusing with menu paste special.Createdsample 2Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#74014: Better fix, to re-use existing method.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#74014: Broadcast cells on undoing of "cut".It will be available in LibreOffice 4.2.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.(In reply to)Thanks. This distinction is important since the paste icon and the paste dialog have two totally different code paths.And it's interesting that the bug hits only with "Unformatted text" paste.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#74014: More on broadcasting at appropriate places.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#74014: Add unit test for pasting an unformatted text into cells.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#74014: Broadcast changes during undo and redo after paste.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.These additional changes fixed scenario 2, plus undo and redo after that, which was not a part of the original report.Backport request for 4.2 is on-going.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#74014: Brodcast only when pasting, not during file import.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#74014: More on broadcasting at appropriate places.It will be available in LibreOffice 4.2.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#74014: Broadcast changes during undo and redo after paste.It will be available in LibreOffice 4.2.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.k. All fixes are in the 4.2.x branch. I'll mark this fixed.Sorry Kohei but still reproducible for me with:Win7x64Ult.Version: 4.2.1.0.0+ Build ID: 684a0308dcb847f816967202ba87f536b83dcb4e TinderBox: Win-x86@42, Branch:libreoffice-4-2, Time: 2014-02-10_23:09:14With the sample file in- Deleting D2:D6- D16 recalc the sum => 72- Undo- D16 doesn't recalc remains 72- F9, D16 recalc the sum => 1954.2 backport:Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#74014: Additional test.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#74014: Broadcast here....The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#74014: Broadcast here....It will be available in LibreOffice 4.2.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Fixed again.Thanks Kohei.Verified fixed.Win7x64UltimateVersion: 4.2.1.0.0+ Build ID: 58df669ac734f4740cf1112867edb808789aae43TinderBox: Win-x86@42, Branch:libreoffice-4-2, Time: 2014-02-12_13:26:56Thanks for swift reponse & fixing the bug. I will install & check the changes. :-)***has been marked as a duplicate of this bug. ***I can confirm this bug again in LO 4.2.5.2, LO 4.3.0.2 (RC2) and LO 4.4.x (daily build 11th July).by Jaise James perfectly explains the steps to reproduce the issue: it seems to be exactly the same bug.Is it possible the unit test failed? Or it was temporarily disabled during the development process and not enabled again?Also note the Whiteboard is targeting 4.3.0 but the fix isn't currently available.Works as expected for me with LibreOffice 4.3.1.0.0+ build at home under Ubuntu 14.04 x86-64According to the help (search "recalculate"), F9 force to recalculate the modified formulas. To force to recalculate all formulas use ctrl+maj+F9Best regards. JBFI can still confirm the bug on LO 4.3.0 RC3, which should became the final release. Same with LO 4.4 daily (15th july) and LO 4.2.5.2.Steps to reproduce:1. Open a new spreadsheet, with A1 = 10, A2 = 20, A3 = 302. Set A4 = SUM(A1:A3), so you will see A4 = 60 (A1+A2+A3= 10+20+30 = 60)3. Delete A2 and A4 will correctly become 40 (A1+A2+A3= 10+0+30 = 40)4. Undo the change: A2 will become again 20, but A4 remains 40 (!!)5. Press f9 in A4: no change in the sum value. Press Ctrl+Maiusc+F9: it works and A4 becomes 606. Try to undo/redo the change multiple times: one time you will see a correct recalculation, one time not.The Whiteboard however is still targeting 4.3.0.(In reply to)Hi Teo91, I think bug with undo after delete (your case) has been reported in. So it's different from this bug.@ign_christianThank you, that is the correct bug indeed.I close again this report, reverting it to RESOLVED FIXED.Removing comma from Whiteboard (please use a space to delimit values in this field)[NinjaEdit]
id=74457	My work writing a book suddenly got deleted at around page 50....I have no back up....Cannot find the file anywhere...what can I do ?I was using libreOffice 4.1.0.4 Hi Alexander,Sorry to read. Pls make sure that you have backups of your work.And go for user support if you have any questions about how to safely edit without dumping half of your work or so...For exmaple there is a group of users with a great variety of skills that can offer help with questions:Regards,Cor
id=74226	Problem description: Start Draw from Writer/Calc... or via the separate application icon and it crashesSteps to reproduce:1. Start DrawCurrent behavior:It crashesExpected behavior:It shouldn't Operating System: Windows 7Version: 4.2.0.4 rcLast worked in: 4.1.4.2 release ***has been marked as a duplicate of this bug. ***Hi,I can't reproduce the crash under Windows 7.Is it a clean install, or an upgrade from 4.1/4.0? If it's an upgrade, please try to reset the user profile as described at, and report if it solves your problem.I removed 4.1 before installing 4.2.Just to be sure, I deleted the user profile, but it still crashesI removed LibreOffice 4.2 and all folders from previous versions including the profile folder and made a clean install of 4.2. The problem still remains.Operating system: Windows 8.1 64 bitFabian/kuhntandreas: did you install any specific fonts? If yes, for the test, could you uninstall them (or put them aside) and give it a new try?***has been marked as a duplicate of this bug. ***Would be great if someone who have the crash could upload a backtrace. Instructions are atCreatedcrash analysisSet status to "new" after attaching a crash reportthx to HelmutCreatedmore complete debug***has been marked as a duplicate of this bug. ***@mstahl, could this be related to <> "vcl: try to fix sizes in ImplBlendToBitmap()" (given thatmight suggest a memory corruption, and ImplBlendToBitmap may get called during OutputDevice::ImplDrawAlpha)it is quite possible that the commit inwould do somethingabout the problem; the stack frames from OutputDevice::DrawBitmapEx downlook familiar... the old code looks wrong and has probably only workedby accident.but i'm not quite sure if there is something relying onrSrcBuffer.mnHeight being used, say if it is smaller thanrDstBuffer.mnHeight; we'll see if we get a bug report aboutthat on master... with an additional std::min thrown init should be safe to backport to 4.2 i guess.Hi,WFM with Version: 4.2.1.0.0+Build ID: 92346fb7714ca7c6a467771d8a8b01305c1b17d1TinderBox: Win-x86@42, Branch:libreoffice-4-2, Time: 2014-01-31_00:15:33but not withVersion: 4.2.0.4Build-ID: 05dceb5d363845f2cf968344d7adab8dcfb2ba71@Win 7 x64***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-4-2":vcl: try to fix sizes in ImplBlendToBitmap (related: fdo#74226)It will be available in LibreOffice 4.2.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.not sure how to test this, potentially it's a bug likethathappens to work when built with MSVC2012 but not when built with 2010?Hello,Not sure it is related, but my LibO 4.2.0.4 crashes when attempting to open big ODG files (lots of drawings, lots of images, created with former versions), or complex PDF...Tried 4.2.1.0, same crashes.***has been marked as a duplicate of this bug. ***Same here, draw crashes as soon as I try to open it.Draw-4.1 which was previously installed on the same Windows-7 machine worked flawless.Jean: it's not the same case since you've got a crash when you open big odg files not just at the start of Draw. Please fill a new bugreport.For those who encountered this bug:For the test, following the Michael's commit on 4.2, could you give a try to the daily build? (see) and tell us if the bug is fixed or not?Thank you in advance!note that checking with a build from the @42 tinderbox won't give conclusive results (only if you could reproduce the crash with builds from that bot at some point) - it uses different compiler. So even if it works with builds from that machine, it doesn't mean the problem is fixed.What needs to be done is to find what is different from the system where it crashes, from those where it can be run without problem.What version of java do those have installed?Maybe all using same virus checker?Why does it crash only for some people is the big question here...The actual DEV will work!tested DEV: libo-42~2014-02-10_23.09.14_LibreOfficeDev_4.2.1.0.0_Win_x86.msiOS: Win7 Pro x64Java: Version 7 Update 51 (Build 1.7.0_51-b13)(In reply to)My completely unchecked assumption after just a very high-level look was that it might have to do with varying pixel color depth.(In reply to)Finally I'm able to reproduce the crash. It's related to the window size. The crash occurs only if the window not large enough to show the whole page in the slides pane. Then it crashes for me with the same backtrace as provided above.***has been marked as a duplicate of this bug. ***Reproducible with a build of @42 tinderbox from 2014-02-03_09:29:12, but not with a build from 2014-02-10_23:09:14. So looks fixed.***has been marked as a duplicate of this bug. ***To verify that the bug really is fixed with the current code, please try with the 4.2.1 RC1 build - if it doesn't occur with that build, then indeed the problem was solved in the meantime.7.2.1 RC1 works!RC 4.2.1.1 works for me, too.2 confirms, that this is fixed, thus setting to Resolved | Fixed.So all who are stuck with this issue and need to get work done please follow Christian Lohmaier's link in.Many thanks, 4.2.1.1 is o.k. I can work in draw.Am .02.2014, 14:39 Uhr, schrieb <>:>***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***
id=74333	CreatedSpreadsheet with a chart and text on this chart isn't shown with LO 4.2.0.4. in CalcOpen a Calc-document with a chart. Write text (with the textbox of the drawing-toolbar) on this chart. Save the file. Reopen it.With LO up to 4.1.4.2 the text is shown well, with LO 4.2.0.4 the text has gone. It's the same behavior in Calc or Writer. But notice the preview in LO 4.2.0.4 - it shows the text written on the chart. CreatedText-document with a chart isn't shown in Writer since LO 4.2.0.4Hi,The text is not *over* the chart but is *inside* the chart.You need to open the chart to insert the text.Change Title to agree with procedure.CreatedTest file with a chart on sheet "Feuille 1" containing numerous textfields and picturesOn sheet "Figure 1", each line has a number between brackets, two pictures show equation used for X and Y values and some Title and comments are added as textfields.Everything is ok in LibO 4.1.5.1 (except the last value "(4)" which appears bigger than it should.With LibO 4.2.0.4, no text, no picture at all.CreatedScreen shot of previous test file with LibO 4.1.5 RC1All texts and pictures are OKCreatedScreen shot of previous test file with LibO 4.2.0 RC4All texts and pictures disappeared.The additional content gets lost on reading. I can generate an additional text box inside the chart using version 4.3 and save it. It can be seen, when the file is opened by Apache OpenOffice, but it is lost, when I reopen the file in LibreOffice version 4.3.Bug NOT present with Version: 4.2.0.0.alpha1+Build ID: d366c9b20ec86f3fe521812a0c22def3bfd1f05eTinderBox: Win-x86@47-TDF, Branch:master, Time: 2013-11-14_07:51:04Bug confirmed with Version: 4.2.0.0.beta1Build ID: f4ca7b35f580827ad2c69ea6d29f7c9b48ebbac7which was build on: 2013-11-23_11:29Trying to bibisectThere are only 'skip'ped commits left to test.The first bad commit could be any of:3f4e0d91dcb02a64c961fa8b9ce02b58a0be2da33936d414a5394bc6f13a2903c1be5288828d0e3fgit bisect log# bad: [f36b371d24b8b7212e611431b1c26449dc2a5375] source-hash-1581b1fc3ac82a7bd62df968226e98604a4ca52d# good: [24c6e7658aaf3e673948c97db16265a2f6cd2432] source-hash-90830788b1f8fd61ea86135712868aeda395edd0git bisect start 'latest' 'oldest'# good: [ddb00a71f5ed8b8e4fa2157a519614c69af6477c] source-hash-5d0051efb99c6cbd0dc4dd655a71e7435159f6bcgit bisect good ddb00a71f5ed8b8e4fa2157a519614c69af6477c# good: [ddb00a71f5ed8b8e4fa2157a519614c69af6477c] source-hash-5d0051efb99c6cbd0dc4dd655a71e7435159f6bcgit bisect good ddb00a71f5ed8b8e4fa2157a519614c69af6477c# good: [c18767dea6ff322d3625806c98a7048d61403be2] source-hash-4ac9fa7a887d09edf7f1fc38f155a93cff30ac97git bisect good c18767dea6ff322d3625806c98a7048d61403be2# good: [024c6b9c9d5e995242d69d24958a64e907dc30fb] source-hash-9ab89a7599f79092027ae86b5b4cd0e3d67b8b4dgit bisect good 024c6b9c9d5e995242d69d24958a64e907dc30fb# bad: [174dd5e8aac55aa53b2ef3116aac9f7c4f7def72] source-hash-5a3143c1a44d4c9d922aa33812d7c428664a8cf9git bisect bad 174dd5e8aac55aa53b2ef3116aac9f7c4f7def72# good: [f67315a2d234934add3a6bc5dd7b8df58304dcef] source-hash-3dab6fcbedf21c1d2971527f6f99fa46d3d45514git bisect good f67315a2d234934add3a6bc5dd7b8df58304dcef# bad: [3936d414a5394bc6f13a2903c1be5288828d0e3f] source-hash-d7e4e5d35e66dbfcc30576d198e393661d84f616git bisect bad 3936d414a5394bc6f13a2903c1be5288828d0e3f# skip: [3f4e0d91dcb02a64c961fa8b9ce02b58a0be2da3] source-hash-e79c706ddda21f850fe3c5a867bacf3982e5b112git bisect skip 3f4e0d91dcb02a64c961fa8b9ce02b58a0be2da3# only skipped commits left to test# possible first bad commit: [3936d414a5394bc6f13a2903c1be5288828d0e3f] source-hash-d7e4e5d35e66dbfcc30576d198e393661d84f616# possible first bad commit: [3f4e0d91dcb02a64c961fa8b9ce02b58a0be2da3] source-hash-e79c706ddda21f850fe3c5a867bacf3982e5b112Update version(In reply to)I confirm this bug in LibreOfficeDev 4.3.0.0.alpha0+:Build ID: 4402efc18ae16e279d55858946d2c8b8972f3f9fTinderBox: Win-x86@39Branch: masterTime: 2014-03-04_00:54:43OS: Windows XP sp2 64-bit Edition(In reply to)I confirm this bug in LibreOfficeDev 4.3.0.0.alpha0+:Build ID: 4402efc18ae16e279d55858946d2c8b8972f3f9fTinderBox: Win-x86@39Branch: masterTime: 2014-03-04_00:54:43OS: Windows XP sp2 64-bit EditionCreatedchart_text.ods exported to the ODC (chart) fileThere are two interesting points (use LibreOffice 4.1.6.0.0+).1. Open the file "chart_text.ods" ().2. Select the chart.3. Save the selection as a "chart_text.odc" (see an attachment).4. Open the file using LibreOffice(Chart) 4.1.6.0.0+.5. There is not text box here.6. Open the file "Eckert.ods" ().7. Select the chart.8. Try to save the selection as a chart – "Eckert.odc".9. You get crash of LibreOffice 4.1.6.0.0+. This made me think that the problem is not only in the Calc. Maybe the ODC format (as the file) is written incorrectly. Please seetoo.--Markus! Please do not disable the ability to create ODC files. Maybe someone will develop the format. ODC files are very well suited for the processing and reporting of statistical 3D arrays.CreatedLO-4.1.6 - OK (my confusion)Sorry, that's my confusion. LibreOffice-4.1.6.0.0+ opens the Chart file correctly. The description of the ODC file is writing up correctly.I made a mistake, because not looked the version of LibreOffice. It was 4.3.0.0 +.CreatedEckert.ods exported to the ODC (chart) file Eckert.odc by LO-4.1.6.0.0+Created'chart_text.ods' exported to 'chart_text-42.odc' file by LibO-4.2.2.1Look atand chart_text-42.odc (an attachment):the lines:- <style:style style:name="gr1" style:family="graphic"> <style:graphic-properties draw:stroke="none" svg:stroke-color="#000000" draw:fill="none" draw:fill-color="#ffffff" fo:min-height="1.747cm" /> </style:style>- <style:style style:name="P1" style:family="paragraph"> <style:text-properties fo:font-family="Arial" style:font-style-name="Fett" style:font-family-generic="swiss" style:font-pitch="variable" fo:font-size="14pt" fo:font-weight="bold" style:font-size-asian="24pt" style:font-size-complex="24pt" /> </style:style>- <style:style style:name="T1" style:family="text"> <style:text-properties fo:font-family="Arial" style:font-style-name="Fett" style:font-family-generic="swiss" style:font-pitch="variable" fo:font-size="14pt" fo:font-weight="bold" style:font-size-asian="24pt" style:font-size-complex="24pt" /> </style:style>- <text:list-style style:name="L1">- <text:list-level-style-number text:level="1" style:num-format="A"> <style:list-level-properties /> <style:text-properties fo:color="#000000" fo:font-size="100%" /> </text:list-level-style-number>- <text:list-level-style-number text:level="2" style:num-format="A"> <style:list-level-properties text:space-before="0.8cm" /> <style:text-properties fo:color="#000000" fo:font-size="100%" /> </text:list-level-style-number>+ <text:list-level-style-number text:level="3" style:num-format="A"> <style:list-level-properties text:space-before="1.6cm" /> <style:text-properties fo:color="#000000" fo:font-size="100%" /> </text:list-level-style-number>- <text:list-level-style-number text:level="4" style:num-format="A"> <style:list-level-properties text:space-before="2.4cm" /> <style:text-properties fo:color="#000000" fo:font-size="100%" /> </text:list-level-style-number>- <text:list-level-style-number text:level="5" style:num-format="A"> <style:list-level-properties text:space-before="3.2cm" /> <style:text-properties fo:color="#000000" fo:font-size="100%" /> </text:list-level-style-number>- <text:list-level-style-number text:level="6" style:num-format="A"> <style:list-level-properties text:space-before="4cm" /> <style:text-properties fo:color="#000000" fo:font-size="100%" /> </text:list-level-style-number>- <text:list-level-style-number text:level="7" style:num-format="A"> <style:list-level-properties text:space-before="4.8cm" /> <style:text-properties fo:color="#000000" fo:font-size="100%" /> </text:list-level-style-number>- <text:list-level-style-number text:level="8" style:num-format="A"> <style:list-level-properties text:space-before="5.6cm" /> <style:text-properties fo:color="#000000" fo:font-size="100%" /> </text:list-level-style-number>- <text:list-level-style-number text:level="9" style:num-format="A"> <style:list-level-properties text:space-before="6.4cm" /> <style:text-properties fo:color="#000000" fo:font-size="100%" /> </text:list-level-style-number>- <text:list-level-style-number text:level="10" style:num-format="A"> <style:list-level-properties text:space-before="7.2cm" /> <style:text-properties fo:color="#000000" fo:font-size="100%" /> </text:list-level-style-number> </text:list-style> </office:automatic-styles> between:- <style:style style:name="ch8" style:family="chart"> <style:graphic-properties svg:stroke-color="#b3b3b3" draw:fill-color="#cccccc" /> </style:style>and:- <office:body>- <office:chart>- <chart:chart svg:width="16cm" svg:height="9cm" xlink:href=".." xlink:type="simple"have been omitted in the description (content.xml).CreatedThe text block was added in the chart by LibO-4.2.2.1It seems to me that the reason is how the program (LbO-4.2.x and LibODev-4.3.0) reads the chart. See the ‘chart_text_42new.odc’ file (an attachment). I've completed these steps (using LibreOffice-4.2.2.1): 1. Open the ‘chart_text.ods’ file (): the text box is not displayed. 2. Select the chart. 3. Create a new text block. 4. Save as a new chart - ‘chart_text_42new.odc’. You can see the new text in LibO-4.1.6. But you will not see the new text, if you open a new chart by LibO-4.2.2 or LibODev-4.3.0.Added DATALOSS in the summary, because even if the hidden data are still there, the user can't know that unless she has the mean to open the file with a previous version like 4.1.x. Manny Linux users with the version provided by their distribution are not able to install another version. So for them it is a dataloss.Set severity accordingly.Best regards. JBFIt is not useful or even working correctly in its current form. It was just a hack to allow testing of copy&paste issues through import&export.As long as nobody is showing up who improves the situation it is a much better idea to hide this feature behind the dbgutil flag so only developers who know what they are doing can mess with it.I think the generated documents are not even valid as I used an incredibly ugly hack to get odc export working.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***This bug is still present in LO 4.2.3.3. I can see the textbox (inserted in 4.2) if I open the document with a previous version (tested with 3.5). It is an essential feature for scientific graphing (that was working before).Markus Mohrhard committed a patch related to this issue.It has been pushed to "master":fix missing service factory during import, related fdo#74333, cp#1000057The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Markus Mohrhard committed a patch related to this issue.It has been pushed to "master":the chart root shape has to be at the bottom, fdo#74333, cp#1000057The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Fixed with Version: 4.3.0.0.alpha1+Build ID: c6c286f14468d341f5fd88edc39a37175a1b6caaThanks Markus :)I hope it could be merged to 4.2 branch quite soon.I reopened this bug because the patch has not yet been included in the code of LibreOffice-4.2.5.0.0+.@apethis is not the correct procedure.once a bug is FIXED in a branch (i.e. 4.3.x) you should not REOPEN if it's still present in older branch (i.e. 4.2.x) but rather ask for backport, if it is technically feasible.(In reply to)@tommy27:OK. Let LibO-4.2 contains the bug, which was not in LibO-4.1 and is not in LibO-4.3.Sorry, but I will not ask for anything because Laurenеt BP had done this two weeks ago.How can I ask for backport? We need a fix in 4.2 branch. We will adopt LO4.2 in our college (fall 2014) since we need the new features of 4.2 and 4.3 will not be as stable at this moment.I understand that it is too late for 4.2.4, but it's not the end of 4.2...Markus Mohrhard is the developer that fixed it in 4.3.xhe probably knows if this can be safely backported or not to 4.2.xI think he's on CC list so he should see your requestOK, so please Markus let us know if it can be backported to 4.2.Backport of a371f5de634195785c9e4b90118049b3c8260ac6 to LibO4-2 proposed through commit 9467I wanted to backport in the same way 3b2ec44912ca2e0548d8078d2edf17fa10856553 but I got a compilation error:.../sd/source/ui/unoidl/unopage.cxx: In member function ‘com::sun::star::uno::Any SdGenericDrawPage::getNavigationOrder()’:.../sd/source/ui/unoidl/unopage.cxx:2673:53: error: ‘com::sun::star::container::XIndexAccess’ is an ambiguous base of ‘SdGenericDrawPage’ return Any( Reference< XIndexAccess >( this ) ); ^I've no idea how to go further.However, commit 9467 is sufficient to fix the bug in LibO 4.2(In reply to)I have abandoned that review request. Unless you understand the code and know why I did not backport it I would very much appreciate if you don't try to backport it.***has been marked as a duplicate of this bug. ***This bug is 90% solved in LO4.3 but there is still a problem if you don't change the font size in the textbox.I have filled a new bug:- DATALOSS: default font size not saved in chart textboxPlease, do not reopen a closed bug without explanation and very strong arguments.If the bug is old, it is surely better to fill a new bug report because the problem cause is probably different.Set back to resolved / fixed.Best regards. JBFMigrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=74553	CreatedExample document in order to reproduce the bug.Problem description: Steps to reproduce:(1) Open attached document with LibreOffice versions 4.2.0 and 4.1.4.(2) Compare document in both versions: In sheet “übersicht” the contents of the following cells miss in version 4.2.0: C3:I3, C7:I9, L2:S2, L11:S11, M29:S29, L30:S44.Expected behavior: No missing of contents. Operating System: Windows 7Version: 4.2.0.4 releaseLast worked in: 4.1.4.2 release Additional info:This bug was first reported on the German user ML by Ueli Jäggi and Karsten Börner. According Karsten the bug appears also with Win XP.I do not reproduce with Version: 4.2.0.4Build ID: 05dceb5d363845f2cf968344d7adab8dcfb2ba71 under Ubuntu 13.10. I display the same content than 4.1.4 under Debian, it seems that no content is missing - Left as Unconfirmed - SophieThis bug was reported from me and i testet it in Windows 7 and Windows 8.1.Hi Sophie,hmm... two people report the bug. You not.How can this contradiction be resolved?Are the steps - described by Harald - not informative enough?Or: do you do the steps and can find no problems?Or: is this a problem of the OS (Windwos <-> Debian)I have added Robert:@Robert: have you any idea?I can confirm the buggy behavior in sheet "übersicht". Opening the file in LO 4.2.0.4 don't show content and no formular in this fields.Opening the same in LO 4.1.4.2 show the content and formular.@sophie: Do you really see the content of sheet "übersicht" in cell C3=169?I will attach a screenshot with the missing content.My system: OpenSUSE 12.3 64bit rpm.CreatedShows the sheet, opened in LO 4.2.0.4 with OpenSUSE 12.3 64bit rpmHi there,I can confirm the bug in LibreOffice Calc 4.2.0.4 on Windows 7 Pro. XLS files have the contents of some cells missing.(In reply to)It is wrong to set the Platform to Windows. I have confirmed it for Linux also.If you seeit appears also on WinXP - thought it isn't a 64bit-system ... So I set it back to all/all.@robertHuge apologies Robert. I misunderstood the bug reporting process and thought I was adding additional information to the report- not changing it.Just for completeness: not reproducable in 4.1.4 on Ubuntu 13.10, but reproducable on 4.2.0 on Ubuntu trusty, indeed a regression.(In reply to)Oups, sorry, checking again this morning, I confirm that the content is missing with 4.2.0.4 Ubuntu 43.10 x64again sorry for the wrong testing yesterday. Sophieconfirmed -- regression from 4.1.5 -> 4.2.0.4 on Windows 7 sp1, 64-bitadding to mab4.2 as suggested***has been marked as a duplicate of this bug. ***In addition tomarked duplicate, believeis also related.In that issue, a referential formula pulling values from another sheet is being corrupted. But that is corrupted formulas versus dropped cell values/formulas.Likely the same cause though.I'm looking into it.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#74553: Write unit test for this.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#74553: Write unit test for this.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#74553: Use the shared formula column position Excel tells you...The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#74553: Use the shared formula column position Excel tells you...The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.4.2 Backport request:Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#74553: Use the shared formula column position Excel tells you...It will be available in LibreOffice 4.2.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Fixed.Verified with version 4.2.3. Function works as expected. Hence status set to CLOSED.
id=74556	Steps to reproduce :- open a new Spreadsheet,- fill in a comment for cell A1, then another comment for cell A2,- quickly press twice on the "Undo" icon.CALC crashes. Confirmed with Version: 4.2.0.4Build ID: 05dceb5d363845f2cf968344d7adab8dcfb2ba71 Ubuntu 13.10 x64 -I will try to add a backtrace.Change Plateform, importance, set to New - SophieCreatedbacktrace of the crashattaching the bt of the crash - SophieCrash reproducible with version 4.2.1.0.0+ (Build ID: 8cab77b3b26a5469d67235dd233d3996a1fa3677) on Ubuntu 13.10 x86-64.Best regards. JBFnot reproducible on 4.1.4 on Ubuntu 13.10 -- thus a regression.I'm looking into this.I think I fixed the originally reported problem, and also fixed a similar crasher during undo and redo after copy and paste. I'll push my fix shortly.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#74556: Write test for ReleaseNote().The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#74556: Have ReleaseNote() really release note rather than destroying it.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#74556: Correctly handle note captions life cycles.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.For 4.2 backport:Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#74556: Correctly handle note captions life cycles.It will be available in LibreOffice 4.2.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#74556: Correctly handle note captions life cycles.It will be available in LibreOffice 4.2.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.This is now in 4.2.x.***has been marked as a duplicate of this bug. ***
id=74936	Problem description: WordArt / Fontwork not fully functional.Steps to reproduce:1. Open MS Word 20072. Write text in a new Word 2007 document3. Save this document in text.docx4. Close Word5. Open text.docx with LibreOffice6. Insert the 10th Fontwork7. Save text.docx in docx format8. Close LibreOffice9. Open text.docx with Word 2007WORDART DOESN'T APPEARS. Operating System: Windows XPVersion: 4.1.4.2 release Hi there,please include an example docx file to save devs and testers time and steps 1-4. thxI can't because I haven't got Word 2007 in my computer. I will see i I can at my work. Not sure.Dear Bug Submitter,This bug has been in NEEDINFO status with no change for at least 6 months. Please provide the requested information as soon as possible and mark the bug as UNCONFIRMED. Due to regular bug tracker maintenance, if the bug is still in NEEDINFO status with no change in 30 days the QA team will close the bug as INVALID due to lack of needed information.For more information about our NEEDINFO policy please read the wiki located here:If you have already provided the requested information, please mark the bug as UNCONFIRMED so that the QA team knows that the bug is ready to be confirmed.Thank you for helping us make LibreOffice even better for everyone!Warm Regards,QA TeamDear Bug Submitter,Please read this message in its entirety before proceeding.Your bug report is being closed as INVALID due to inactivity and a lack of information which is needed in order to accurately reproduce and confirm the problem. We encourage you to retest your bug against the latest release. If the issue is still present in the latest stable release, we need the following information (please ignore any that you've already provided):a) Provide details of your system including your operating system and the latest version of LibreOffice that you have confirmed the bug to be presentb) Provide easy to reproduce steps – the simpler the betterc) Provide any test case(s) which will help us confirm the problemd) Provide screenshots of the problem if you think it might helpe) Read all comments and provide any requested informationOnce all of this is done, please set the bug back to UNCONFIRMED and we will attempt to reproduce the issue. Please do not:a) respond via email b) update the version field in the bug or any of the other details on the top section of FDO
id=74824	CreatedArea of spreadsheet under scrutiny.Problem description: Trying to insert cells into a row with "Merged and Centered" cells crashes LibreOffice.Steps to reproduce: 1. Open attached ODS file. 2. Select cells D10:E14 3. Hit 'Ctrl+Shift+=' to open the "Insert Cells" dialog box. 4. Select "Shift cells right" 5. Hit "Okay".Please see attached screenshots for a visual reference.Current behavior:Calc crashes, throwing a dialog box to the screen that says "Block position not found!"Expected behavior:Calc should not crash, and cells should be inserted as per the selected area.Operating System: UbuntuVersion: 4.2.0.4 release CreatedInsert Cells dialog boxCreatedCalc crashing with weird dialog boxCreatedExample ODS file that can trigger crash.Confirmed with Version: 4.2.0.4Build ID: 05dceb5d363845f2cf968344d7adab8dcfb2ba71 Ubunt 13.10 x64. I'll add a bt of the crash - SophieCreatedback trace of the crashCreatedconsole logs + bt with symbolsOn pc Debian x86-64 with master sources updated today, I reproduced this.I attached console logs + bt.Kohei: bt shows mdds part, one for you?I'll take it.This one was hitting a bug in mdds. Fixing that in mdds was enough to fix this.Just released a new version of mdds (0.10.2) that contains the fix for this use case.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#74824: Update mdds to 0.10.2 which fixes one crasher bug.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.4.2 backport request:Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#74824: Update mdds to 0.10.2 which fixes one crasher bug.It will be available in LibreOffice 4.2.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Fixed in 4.2.1.Kevin Hunter committed a patch related to this issue.It has been pushed to "master":Test for fdo#74824.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=74999	Createdexcel fileProblem description: I open the attached file test2.xls with libreoffice which was most recently saved with excel 2013 and all the forumla are missing from column M. This results in incorrect numbers in other cells which depend on it.Steps to reproduce:1. Open with lo4.2.0.4 and observe col M2. Open with excel and observe col MCurrent behavior: Col M is misssing all formula when compared to excel.Expected behavior: I expect all my formula to be there. Operating System: AllVersion: 4.2.0.4 releaseLast worked in: 4.1.4.2 release Createdtesting fileI also have the same problem since upgrading to version 4.2, my file has formula in cells B6 to J6 but only B6 and C6 appear when the file is opened in LibreOfficeApparently this issue was fixed in version 4.2.1Createdtest file xlsCreatedtest file xlsx(In reply to)Apparently it was not the case. I have 2 files savedas xls and xlsx from Excel 2010.The xlsx file appears fine in LibreOffice butin the xls file, the formulae in column S to AE are allmissing when opened using LibreOffice 4.2.1, 4.2.2 and 4.2.3.(Both files appear fine in Excel)This is critical as data are permanently lost if the xls file is saved again using LOI can not reproduce in 4.2.4.2. All the attached excel files are opened fine, formulars are still there, not missing.Could you please upgrade to 4.2.4 and test again, thanks.CreatedPrint screenPrint screen file attached.Even latest LO version doesn't solve the problem.I am now currently using LO 4.2.4.2 and Excel 2010 ver 14.0.7116.5000 64bit on Windows 7 64 bit.CreatedScreenshot 4.3.0 beta2 ubuntu 14.04 (works OK)Hi jkonecny,It works OK for me with 4.3.0.0 beta2, ubuntu 14.04 x86, see my screenshot.I see the platform field was set to ALL, did you really tested it under linux?Also, if possible would you please install 4.3.0.0 beta2 and have a test? Thanks.I don't recall if it was tested under linux or not. I may have left the platform on the default and that may be "all". Nonetheless this bug forced us to buy ms office for a few users. Once those few had it everyone wanted it. Now we have a 50 user license and don't use LO anymore.Createdopen with 4.3.0.0 beta2 (works OK)(In reply to)Sorry, the previous comment was for my_wong.This comment is for jkonecny. Your file works OK for me with 4.3.0.0 beta2 also, see screenshot.(In reply to)Sorry to hear that.Then now I have to wait for my_wong's feedback.Thanks.Createdscreen shotI just tried with 4.3beta2 windows 7 64bit and it works!I hope it stays that way when 4.3 is launched but I noted other issue(not related to this) with 4.3beta using another another file.In fact thealso works fine with 4.2.4I mark this bug as WORKSFORME then.Migrating Whiteboard tags to Keywords: (possibleRegression)[NinjaEdit]
id=75053	CreatedTest file to delete column B, and check formula in column CProblem description:When deleting column referenced in other formula, formula are modified but do not content #REF! as they should, even if they display #REF!.When undo deletion, formula are wrongly restored, and display #REF!, even after Ctrl+Shift+F9Steps to reproduce:1. Create new file (or open attached document) with values in column A, column B=2*A, column C=B+A2. Delete column B=> Column C display #REF! which is normal3. Click on a formula in column CCurrent behavior:Formula is "=A2+A2"Expected behavior:Formula should be "=#REF!2+A2"Second steps:4. Hit Ctrl+Z to undoCurrent behavior:Column B is restored (OK).In column C, only the first formula in C2 is correctly restored: other cells display #REF! and formula is "=A3+A3"Expected behavior:Column B and C should be restored. Formula in C3, C4,... should be "=B3+A3"Confirmed on Win7, Version: 4.2.0.0.alpha0+Build ID: 4a8f7ddc290d1ea3131de6611b6833b77ac7ab1fTime: 2013-08-28_11:14Regression against Version: 4.2.0.0.alpha0+Build ID: 2f6cbe13e61c44d4bab8192a4708b698d3d9da33TinderBox: Win-x86@6-debug, Branch:master, Time: 2013-07-25_00:00:21 Confirmed with LibO 4.2.1 RC1Oups! Please correct references in the description above: after step 2, replace column C by column B of course.Steps to reproduce:1. Create new file (or open attached document) with values in column A, column B=2*A, column C=B+A2. Delete column B=> Column *B* display #REF! which is normal3. Click on a formula in column *B*Current behavior:Formula is "=A2+A2"Expected behavior:Formula should be "=#REF!2+A2"Second steps:4. Hit Ctrl+Z to undoCurrent behavior:Column B is restored (OK).In column C, only the first formula in C2 is correctly restored: other cells display #REF! and formula is "=A3+A3"Expected behavior:Column B and C should be restored. Formula in C3, C4,... should be "=B3+A3"HelloReproduced on windows 7/64 with Version: 4.2.1.1Build ID: d7dbbd7842e6a58b0f521599204e827654e1fb8bRegardsPierre-vesAlso reproduced on windows 7/64 with Version: 4.3.0.0.alpha0+Build ID: e076b5290e706b8a69abd397a9f255eba6a0cd1aTinderBox: Win-x86@39, Branch:master, Time: 2014-02-13_23:23:34RegardsPierre-YvesAlso in:Win7x64UltimateVersion: 4.2.0.4 Build ID: 05dceb5d363845f2cf968344d7adab8dcfb2ba71Version: 4.2.2.1 Build ID: 3be8cda0bddd8e430d8cda1ebfd581265cca5a0fVersion: 4.2.3.0.0+ Build ID: 4274001144adeb0b0a1e7da05d52c1bedbe899e5 TinderBox: Win-x86@42, Branch:libreoffice-4-2, Time: 2014-02-27_08:31:36Last working:Version: 4.1.6.0.0+ Build ID: d86ecb8512d19d8dcf073ceb1fd9813554397bdI think clearly MAB, broken formulas deleting column and after undo.Kohei, *,yet another...On Windows 7 sp1, 64-bit with same loss of formula reference with <Ctrl>+Z undoVersion: 4.3.0.0.alpha0+Build ID: f839b5dd16c05c0eda21345ec36ec0cb024eb732TinderBox: Win-x86@47-TDF, Branch:MASTER, Time: 2014-02-23_09:54:38no improvement with work on-- so still issue with today'sVersion: 4.3.0.0.alpha0+Build ID: 95b401558466954453d490456be01beb6d747806TinderBox: Win-x86@39, Branch:master, Time: 2014-02-27_23:09:22 build on Windows.Adjusting title to reflect the incorrect cell formulas following <Ctrl>+Z 'undo' of a column deletion.I hope all these bug fixing craze will end one day.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#75053: Write test for this.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#75053: Adjust reference update on shift for formula groups.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.4.2 backport request:Issue is resolved fixed on Windows 7 sp1, 64-bit withVersion: 4.3.0.0.alpha0+Build ID: c3c6d7f886088b57869b6978309e7a39cba32bbbTinderBox: Win-x86@39, Branch:master, Time: 2014-03-01_09:52:43Should have added that backport for 4.2.x () remains to be finalized.Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#75053: Adjust reference update on shift for formula groups.It will be available in LibreOffice 4.2.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.HelloWORKSFORME on windows 7/64 with Version: 4.2.3.1Build ID: 3d4fc3d9dbf8f4c0aeb61498a81f91c5b7922f13Thank you :)RegardsPierre-YvesThanks Kohei.Verified Win7x64:Version: 4.2.3.1 Build ID: 3d4fc3d9dbf8f4c0aeb61498a81f91c5b7922f13Version: 4.2.4.0.0+ Build ID: e1823627f35e4419880769fdd05acddbd0a9c25c TinderBox: Win-x86@42, Branch:libreoffice-4-2, Time: 2014-03-18_14:25:19Version: 4.3.0.0.alpha0+ Build ID: 12ae7672f285da1d4c730315e8db23b3396b71cc TinderBox: Win-x86@39, Branch:master, Time: 2014-03-14_00:18:00
id=75358	Problem description: Upon upgrading to 4.1 and above Libreoffice installs. The desktop icon appears. No error messages are shown. It is reported that Libreoffice has installed successfully. However Libreoffice and its components do not open. No error messages appear.Steps to reproduce:1. .... Install on Windoqs XP2. .... Successful installation3. .... Attempt to run Libreoffice Current behavior: Libreoffice does not open. No error messages appear.Expected behavior: Libreoffice opens Operating System: Windows XPVersion: 4.1.5.1 rc Windows XP Service Pack 3 installedMy system has Java installed (Version 7 Update 51)Did you download LO from?Did you install any LO specific extensions?Could you rename your LO directory profile and give it a new try? (see)About Java, do you use a 32 bits Java version?LO was downloaded fromMy system is 32bit as I assume is JavaNo LO specific extensions were installed. Regarding the LO profile instructions - I have removed the 4.1 and higher versions and am currently using 4.0.6.2 which is working fine.I take it you want me to remove 4.0. Then install 4.2. if it does not open then rename the LO profile to something random and then try using the program - am I correct?I have checked the current LO profile and it shows two directories one named " 3 " and the other " 4 ".(In reply to)Ok so no problem then. (LO is 32 bits only on Windows for the moment, that's why I had asked)OkYes. At the next launch of LO, since it won't find its directory profile, it'll create a brand new one automatically.Yes, it's because you had once LO 3.X.X version. If you don't have any customization or something you can drop the " 3" one.Update - I uninstalled 4.0. I installed 4.2.Install was successful - no error messagesLO would not open - no error messages.I removed all folders in the LO profile directory in application data.I rebooted.I tried safe mode - LO opened.I restarted and entered XP normally. LO does not open. I checked the LO profile directory - there are no directories such as " 3 " and " 4 " as I previously described above.Weird indeed, if you tried 4.2.1 (which fixed a similar problem on 4.2.0)Did you install any specific fonts? If yes, could you uninstall them/put them aside for the test and give it a new try?Does it fail for all the LO apps or just for some of them (Calc, Writer, Impress, ...)?Do you have ApacheOpenOffice installed too? (or had you ever installed it?)Anyway, could you try the raw method?- uninstall any LO/Apache OpenOffice- remove LO directory profile (even if you already did it)- remove any LO/Apache OpenOffice remnant directories in program files- clean your Windows registry with a free tool (eg: ccleaner)- install againIf you still reproduce the problem, you might try to retrieve some interesting information by following this link:Did you install any specific fonts? If yes, could you uninstall them/put them aside for the test and give it a new try?NODoes it fail for all the LO apps or just for some of them (Calc, Writer, Impress, ...)?YES ALL APPSDo you have ApacheOpenOffice installed too? (or had you ever installed it?)NO & NOAnyway, could you try the raw method? ***** WILL NOW WORK THROUGH THIS- uninstall any LO/Apache OpenOffice- remove LO directory profile (even if you already did it)- remove any LO/Apache OpenOffice remnant directories in program files- clean your Windows registry with a free tool (eg: ccleaner)- install againTry to uncheck Options/View/Graphics output options.(In reply to)OKI have tried a repair install - made no difference. I have looked at the LO program directory - I have noticed that there is no "soffice.exe" visible.I am now doing another uninstall and will check for any remnant directories."Weird indeed, if you tried 4.2.1 (which fixed a similar problem on 4.2.0)"You never answered that. You said you installed 4.2. Which exact version did you try?(In reply to)Installed 4.2.1OK - I have removed 4.2.1, run Wise registry and Drive cleaner. Checked for any remnant directories - none found.I am now installing 4.2.1 again - This time I am loading it to my G Drive rather than my C Drive.Will update you shortly.Many thanks KarlAt last - I now have 4.2.1 working Thank you for your assistance. I remain baffled as to what the problem was. Looking at my G Drive there are a lot more directories and files than appeared on the C Drive installation. I am now confused as to why several installations on my C Drive were not including critical files and directories - repeatedly.Any how I am now happy and can use the latest LO - Hurrah.Thanks again.Thank you for your feedback Karl, I put it RESOLVED/WFM.
id=75130	Certain Cell borders made with Calc (4.2.1.1 RC1) are lost when saved to XLS and reopened with CalcI feel that most of the issues are export related as import of borders from a XLS file made using Excel is almost perfect now.The following export works fineSingle Line Borders 0.75 -> Translates to normal Excel BorderSingle Line Borders 1.75 -> Translates to thick Excel BorderSingle Line Borders 2.50 -> Translates to thickest Excel BorderDots 0.75 -> Translates to Excel DotsLong Dash 1.75 -> Translates to Thick Excel DashAll Double Lines -> Translates to Excel Double LineThe export issues are:Single Line Borders 0.05 -> not saved (should be saved as hairline)Dots 0.05 -> not saved (should be saved as 0.75 dots)Dots 1.75 -> saved as Border 1.75 (should be saved as 0.75 dots...?)Dots 2.50 -> saved as Border 2.50 (should be saved as 0.75 dots...?)Dash 0.05 and 0.75 -> not saved (should be saved as 0.75 dash)Dash 1.75 -> saved as Border 1.75 (should be saved as 0.75 dash...?)Dash 2.50 -> saved as Border 2.50 (should be saved as 0.75 dash...?)Long Dash 0.05 -> not savedLong Dash 0.75 -> saved as Single Line Border 0.05Long Dash 2.50 -> saved as Single Line Border 2.50 Unlike Cacl, excel has no option to change the border thickness. The thickness is assigned with the style. So we cannot expect all Borders in calc to be saved as xls. I think some issues can be avoided if the default line thickness in calc is made as 0.75 to match that of Excel. Repro in 4.2.1.1, ubuntu 13.10 x86. Is a regression against 4.2.0 release.Set as Highest Critial.This issue not only happen when export to .xls, but also .xlsx.Createddocument before saveCreateddocument on saveCreateddocument after reopeningAny New Border added on cells getting lost on saving as xls file. Version with problem is 4.2.1 rc1. Used OS windows XP sp3Existing border preserves saved using old versions & copy-paste also preserves on save. But If add a new border, on save it lost & reopen shows no border.guess it's most likely due to big border re-write (commit 9a19e8d838753128504274e1885eb3ce8ec1dbb8)In my testing, only the hairline is lost on save, while the rest look okay.CreatedTest document that contains ALL Excel line types.Test document that contains ALL Excel line types.I'll focus on just preserving the Excel line types during opening and re-saving. The rest are different issues that should be handled in different bugs (due to the larger scope of the whole border line issues).And the dashed line becomes hairline on resave. Those 2 are the only issues I see.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#75130: Move these tests to the export test and test their export.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#75130: Export cell borders to xls and xlsx correctly.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.4.2 backport request:Not only single line, Dots, dash and Long Dash of 0.05 thick are not saved when exported to XLS also dash of 0.75 is not saveddots and dash of 1.75 and 2.5 thickness are saved as single line of 1.75 and 2.5In import from XLS only Dash Dot Dash and Dot Dot Dash are not imported properly (are imported as single line 0.75 thick). We cannot expect calc to import it as such since the two formats are not supported in Calc. However instead of single line 0.75 thick, it could have been imported as dashes.I don't know if I should be asking this, but can border styles/thickness not supported by Excel be made to hide from the border menu when the file save type is XLS or if the file opened is XLS(In reply to)Please don't do this here. Focus on the bug reported.(In reply to)Don't mix multiple issues please. As I said inwhich I repeat here"I'll focus on just preserving the Excel line types during opening and re-saving. The rest are different issues that should be handled in different bugs (due to the larger scope of the whole border line issues)."Other issues such as missing border types MUST be handled separately from this bug. Thanks for your corporation.And just be upfront, those line types that we don't currently support will NOT be retained when re-saving to Excel. They will become solid lines for now. When we have a chance to support those missing line types, those types will be saved back to Excel intact.Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#75130: Export cell borders to xls and xlsx correctly.It will be available in LibreOffice 4.2.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.I know we still have a lot of work to be done on borders. These things take time and we can only do it one at a time.Fixed.***has been marked as a duplicate of this bug. ***Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-2-2":fdo#75130: Export cell borders to xls and xlsx correctly.It will be available already in LibreOffice 4.2.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Createdscreenshot, LiO v 4.2.4.2 (same applies for 4.2.5.2)Createdscreenshot, LiO v 4.2.4.2 (same applies for 4.2.5.2)Versions 4.2.4 and 4.2.5 (maybe 4.2.3) are turning solid outline of the cell thinner than 0,75pt into dot outline when exporting in excel .xls or .xlsxNot sure if it's a bug or a feature but assuming that you can't (in easy way at least) set the default thickness of outline once for every new created document, this behaviour is kind of very annoyingHere's the screenshot of what I'm talking about(In reply to)@Alex:For this behaviour you mentioned above, I have already filed a bug report:- Normal cell borders are showing dashed/dotted when export to xlsx/xls and reopen in MSOI add it to SEE ALSO of this bug.However, for this bug (75130), it had been UNCONFIRMED->NEW->RESOLVED-FIXED. Althrough the issue you mentioned may be related, I don't think you should set this back to UNCONFIRMED.I'll add you tocc list, and I am setting this one back to RESOLVED FIXED
id=75025	This is a meta issue to track the most annoying bugs in LibreOffice 4.3.x releases. It helps developers to focus on bugs that are most critical for users. Also it helps users to be aware of potential problems.If anyone wants to raise a bug as “most annoying” for the release, please add the ID of that bug to the field “Depends on”, leave a short description of the bug, and explain in few words why that bug should get privileged, for example:Add bug #XXXXX: Writer ignores page size setting. The default size is Letter. The document format is often broken when printing on A4 paper in Europe.For details, criteria and further instructions, please see added- FILEOPEN: DOCX: Figures with text which are on canvas become rectangles (regression from 4.2.x see)Add: LibreOffice Writer text highligthing is not compatible with Microsoft Word DOC and DOCX (highlighting transforms to background color)This bug has very long history and it is a great interoperability problem. Please fix it as soon as possible. It breaks normal document exchange with MS Word users and drop negative light on LOO in MSO users eyes.added- CRASH printing with all applicationsreproduced under Windows. Linux and Mac testers are welcome.Adding "- right-click 'Picture...' dialog does not appear"Nominating "- Menus are getting invisible when hovering"Hereby I nominate "- VIEWING: Page not visible in Libreoffice Draw". This makes Draw quite unusable.Added,Crash pasting a text copied from Input Bar(Formula Bar) from others 4.2 versions.I add- Slideshow: does not go to next slide or animation by mouse clickregression from 4.2.xmakes Impress almost unusable.added- LibO crashes as soon as one enters text in a moduleNominating "- OLE content isn't visible when loading document prior to LibreOffice 4.3"Added-Regression - currently when making a 2nd custom style it replaces the first. You can no longer have more than 1AddedBackground color applied through styles is not seen after save/reopen of document. Regression from 4.2.4.2, potential of affecting enough users where I think it belongs on the list.BibisectedAdded- regressionOn Windows XP LibreOffice crashes when Tools -> Options -> Language Settings -> Languages is selectedAdded- regressionFollowing a set of steps and then undoing results in crash/loss of dataBibisectedAdded- regressionSaving as docx and then opening the file in MSO 2013 (only version affected) results in periods in indexes being removed. If bibisect is needed please request it on the bugAdded- regressionMakes LibO unusable/freeze in 4.2.4 and 4.3 beta in Linux and Windows.Added- regressionCrashes 4.2.4 and 4.3 beta in Linux and Windows due to removing rows from Calc.Add: sorting with references to other sheet is broken. Regression from 4.2AddedCrashes 3.6 to 4.3 beta in Linux after undoing from merging cellsAdded- DOCX DATALOSS: Line breaks lostafter edit-and-save.This is a regression against 4.2.x.Regression - worked in 4.2.4 and 4.2.6: Start Center left application column has icons with black filling: No 'Save a Copy' option in any other module but Writer(In reply to)Not a MAB (enhancement request).I think this old bug should belong to one of the MAB list:- UI: Function list category "Last Used" always inserts function from the top and duplicates existing listIt still exists in version 4.3.0.0 beta2 and 4.2.5.1.(In reply to)if the buig is already present in 4.2.x you should file it in the mab4.2 list.so I'm removing it from mab4.3Adding- Database file with thunderbird address book as data source crashes LibreOffice.It's a 4.3 regression.Adding- The "Spellcheck of entire document has been completed" dialog hangs when doing spell check in an Impres.This is a regression in LibreOffice 4.3.Added(Spell check does not work in Impress Presentation anymore)This is a regression in LibreOffice 4.3.and 80140 can be reproduced also with Draw.When you press F7 (or Tools->Spelling) I can confirm two behaviour. With a blank document (odp or odg) I reproduce the, with a document with some content I can reproduce the.Adding- DOCX IMPORT: Wrong underline applied to list style.This causes wrong formating when open DOCX file.It's a regression in 4.3.0.0 beta2, and still exists in 4.3.0 RC1.Regression - works in 4.2: background color missing around images when at 0% transparencyNew feature - not implemented properly: picture dialog transparency tab linked to background transparency rather than image transparency: MS Publisher file that crashes all non-distro provided libreoffice installations: deleting a few characters from attached file freezes LibO.Confirmed on 3.3 to master.expert configuration has some pretty annoying issues that need some love soon.nominating,adding- Properties "Create from" of index/table are changed on saveAdding: Retina support has regressed in 4.3 and LibreOffice windows are pixellated again.adding- CONFIGURATION: macro-warning: path for trusted locations from previous LibreOffice, is corrupted by updateAdding- FORMATTING: lost of style inheritance(drama when using Draw and Impress :( )Reason - new feature: Crash when opening an .odp containing 3D modeladded- regressionODS causing a crash, bibisected and backtrace on the bugAdded- regressionQuite serious but we don't know exactly what is triggering it (reproduced by a few people though)Enable Quick Starter causes crash in LibreOffice. Reproduced with XPSp3, and W7Added- Insert -> Link to External Data completely brokenregression + bibisectedAdded- sort resulting in crash (regression between 4.3 and current build of 4.3, could be related to fix fori nominatenominatingandaddendum:all three are regressions.first one covering lost conditional formatting’s, 2nd too and the third is about the duplex print setting which is ignored since about 4.0further i nominateEDITING: impossible to change existing math catalog element's font face without its name auto-switched to Unicode value as it's a regression and exists since 3.4.6 and is even worse since #80650 , because it would provide a work-around.Added- dictionaries completely broken in 4.3.0.3 rc (works fine in beta1)(In reply to)I second this as a blocker for the 4.3.0 release. Even thoughhas a fix for 4.3.1 I think it such a big regression from 4.3.0.1 that an RC4 should be considered.: no more slideshow, a serious regression on windows 8.1.(In reply to)Cannot replicate this issue under Win 7 & 8.1 using:Version: 4.2.5.2Build ID: 6ff819b65674ae6c83f3cbab9e4a4c2b292a7a94Version: 4.3.0.3Build ID: 08ebe52789a201dd7d38ef653ef7a48925e7f9f7The test slideshow fromand my own test files display perfectly in all the above configurations, both with and without hardware acceleration.Nominating: upward fill handle / dragging cell with formula can only done 1 cell up Regression against 4.2.xNominating: no quickstarter icon in systray (Win7), regressionAdded,- regression to LibreOffice 4.2.x- Insert SVG file breaks the program (Windows OS)- [FILEOPEN] SVG Insert->From File takes 2+ time longer in 4.3 (Linux OS)Nominating: “StartCenter displays thumbnails of password-protected files”. Duplicates of it just keep popping up.ading- UI Icon Create New Folder in dialog File Save (As) closes dialog and doesn't show the needed dialogadding- EDITING Opening file doesn't place the cursor on the last position of editingNominating: conditional format not copied to other cellRegression against 4.2Nominating: reference to another sheet lost after cell dragging or cut-pasteRegression introduced in 4.3.1.1, works correctly in 4.3.0.4Nominating 79549 as we have severe problems in MaOS X displaying video. Users cannot use Audio/Video properlyAdded- FILESAVE: PPTX: error saving presentation with table, regression, works in 4.2.Added- regressionCrasher if you copy and paste data from a spreadsheet after closing the source document (prior to pasting).Add- Opening this XLSX in Calc does not display all conditional formatsAdd- embedded fonts are double and also non-used fonts are embedded - but the used font is not embeddedAdd- spreadsheet background doesn't get displayed/importedAdd- embedded objects do not get imported from XLSXAdding: Calc is not accessible to screen readers on Linux if sheet is modified [a11y]The result of this bug is Calc becoming unusable with screen readers, once they modify a cell they stop receiving accessible events. It seems to affect Windows and Linux users, so probably OS X version is affected too.Added: unable to do global find / replace on large spreadsheet.Regression regarding version 4.1.x and first 4.2.xNominate: black fields in pivot table, only for Mac OS XA user confirmed that it's not occured in 4.2.x, affects many usersmovedfrom mab4.2 to mab4.3nominate"Shift click to select multiple drawings does not work if picture there"Nominating #84752# which is a regression, worked fine in 4.2 and broken in 4.3 and Master. Impact is 100 users that use these types of ODT documents as part of daily use. Opening and navigating is so slow, it's unusable. MAB criteria met: freeze and unusual function. No work around exists.I add- crash in paste special when combine options link and format4.3.x regression causing crash in very simple paste special action.Added- Wrong frame-background in exported PDFRegression, bibisected.Adding "- LO Crash when editing legendbox"-> Regression and CRASHSince 4.2 is close to EoL, I add- "Save ODT as DOC or DOCX turns on Show Changes when Record Changes also on" here. It can confuse some users.(In reply to Timur from)please do not file 4.2.x bugs into the mab4.3 list until the real EOL of the 4.2.x branch is reached which is november 2014.I'm removing it from the 4.3.x list.if you will file that bug in the mab4.2 list.Added- crasher with a simple copy of a table from presentation, regressionadded- clicking on update seems to be causing a crash for some users.Added- array formulas are being changed without user intending them to change. This is a regression that has been bibisected.I add again- "Save ODT as DOC or DOCX turns on Show Changes when Record Changes also on" here. Not a damage, but it can confuse.Added- Page Numbering restarts when paragraph width is adjusted. This causes loss of data and prevents printing. Unacceptable in enterprise. This is a regression that has been bibisected.Add: Graphic didn't automatic update when change variabele (recalculation not triggered).Added: Filter operator "AND" is changed to "OR" after save and reopen.Added- FILEOPEN: PPTX Import background color of table is set to blueThis bug is present in 4.2, 4.3 and 4.4 versions ()@shunesburg69, *,(In reply to shunesburg69 from)Assume you referring to- FORMATTING: Fontwork-formatted text is duplicated, affecting only OS X builds. A bit down in the weeds, but for OSX users depending on it an annoyance to be sure. Adding it to mab4.3 with a note on mab4.4--no need to cross post.Have also added it to.Sorry and thank you for the correction.Migrating from 4.2 which reached EOL:Cross reference handling broken when exporting to doc / docxSame bug still exists in 4.3 ()adding- PIVOTTABLE: pivot table not saved in xlsxAdded- crasher when inserting table in impress. BT with symbols on the bug.- Target for paste cells from column in Calc into TABLE will be single cell instead of columnPlease fix it, its extremely annoying bug.Adding self to CC if not already onIn Mac OS X 10.6/10.7, LO 4.2/4.3 messes with files on the filesystem that the user did not even choose to open, which I think is a serious violation.I am doing what I can to help fix it, but I could really use some developer support.Added- it's pretty embarassing that some of our standard presentation templates don't work correctly in slideshow mode, and repeated duplicates confirm that this is annoying users.Added- FILEOPEN: DOC import splits the page into two - Section break problem.Added- crash Printing from print preview with comments printing in margin causes crash. Not a regression, appears to have always has this problemNote: Crash is only if you (1) print from print dialog; and (2)print comments in the marginAdded, Inserting a row in a sheet change references in other sheets in formula without relation with inserted row.Adding- FORMATTING Line spacing Proportional < 100% ignored for paragraphs in tablesIt took me an hour or so to fiddle out why some documents do not open with the same number of pages in 4.3.4 and higher, then before.So people that stumble over this, may be pretty much lost and desperate..Added- regressionSaving a pptx as a ppt with draw elements results in the draw elements disappearing. Complete loss of data.Add- Search/Find "continue at the beginning" ignores previous footnotes (regression).This bug breaks trust in a basic function and is especially bad since users might not even realize anything is wrong. I've even submitted papers with obvious errors that could have easily been caught if search/find worked correctly.Added- regression + serious hangCalc spreadsheets hang when there is long multi-line text in cells. Kohei did some work on it and added a calgrind along with some code pointers some time ago - thought it was fixed but apparently people are still seeing the issue.adding- EDITING Opening file doesn't place cursor on last position of saving (a tough one..)I add- FILEOPEN: text paragraph indentation/tab stops in .DOCX displayed incorrectlyI remove- FORMATTING Line spacing Proportional < 100% ignored for paragraphs in tables, because it was RESOLVED as NOTABUGAdding- TABLE: Setting cell number format of empty cells is ignored - breaks number recognition (edit) Calculation in Writer tables is one of the nice USP's - a pity that it is made so hard with issues around number recognitionRegression - worked in 4.1: Saving to html embeds images rather than referencing itBugs affecting Writer's embedding of images, OLEs, etc. when a border is added around them, which also causes compatibility problems.: Image/OLE should have 'spacing to content' disabled: Borders shrink image/OLE size rather than appearing on the outsidesAdded- FILESAVE: Calc lost comments when more time save file odsWhilst at the time of writing this bug is closed, the fault still exists and the report is valid, it just requires substantiation.adding EDITING: Footers/headers break SHIFT+PGDN selectionAdded- regression + bibisectedDeleting a sheet that has no relationship to formulas on other sheets ruins the formulas on those sheets. Simple test document attached.Adding- resize image (picture) together with frame does not workIt is an often discussed issue in trainings with end users (they do not understand the behaviour), and inserting, captering and resizing a picture is an often done activity by them.Since EoL is near, will MABs stay or not? That was useful, but seems like not the most efficient tool. There was an idea to have only Importance, but personally, I would like to see raised priority for bugs marked as regression, bisected, have-backtrace.Yes we are trying to abandon MAB and replace with severity/importance. These fields will soon be locked out for users and only be available to contributors - this is to ensure consistency and objectivity in deciding the severity/importance. We are hoping to do a test run of this in the next month or so. We have no plans on making a MAB 5 (although this may change).Insert Image how headersIf an image is inserted into the header by the command: Ctrl + Shift + O> Format page-> Encabezamiento-> Activate (Mas) -> Como (picture), it does well, but to save and close the file this image disappears, no matter the format in which it is stored, always disappears. (Sorry for my English is not my language)undo damage from last edit- Long image inserted at the end of page goes beyond margin and over footerThis bug effects NOT ONLY "long" images, but _all images_ embedded in paragraphs near the end of a page."Overlapping" images (over footers and/or below pagemargins) make LO completly useless if you plan to put some images in paragraphs. And using images is not an advanced way to style documents, right?!Hi all,The MAB docs on the wiki have been updated to reflect the newPriority-based system for categorizing bugs:The old MAB tracker bugs (mab4.3, mab4.4, etc.) will remain inBugzilla for historical reference, but should be ignored for currentwork. ......................FINAL mab4.3 STATS......................fixed bugs -> 99open bugs -> 57......................for the record, here is the list of the residual open bugs that I'm going to remove from the "Depends on" field:: FORMATTING: Fit to Frame for text boxes is broken: ODT containing multi-page table with table setting "Keep with next paragraph" is pushed to next page: If you insert an envelope into a document only the envelope is printed (Mac OS X): cropped pictures in .docx file are mangled and in wrong place: Impress Animation Sound Effect not played after file moved: VIEWING: Heading - Footer - Pagebreak lines appear somewhere in the page: FILEOPEN LibO 3.3 documents shows Writer OLE object contents shifted right/down in object after edit of object because of page border issue: Writer: Incorrect numbering when cells are merged in the table: TABLE: Setting cell number format of empty cells is ignored - breaks number recognition: Search / Find 'continue at the beginning' skips / ignores previous footnotes: EDITING: Attempting paste into find bar with Cmd-V on OS X pastes into document: EDITING: Replication of frames when record changes (redlining) is on: Embedded HSQLDB calls flush (CHECKPOINT) too often: EDITING Report builder: mouse-move control: gap between mouse position: FILESAVE: Joined cells in table cause table distortion after save to DOC, DOCX: FILESAVE: FILEOPEN: save document as docx and reopen result in an freeze/endless loop: FORMATTING: Square root and cdot are not correct displayed under Windows 8: Brackets (..),{..},[..] inverted )..(,}..{,]..[ when switch to RTL text direction with all fonts: [Template manager]: Can not copy styles between different files and templates: EDITING: Footers/headers break SHIFT+PGDN selection: editing/formatting: pasting formatted font messes up formatting of bullets: FILEOPEN: PPTX Import background color of table is set to light blue: inserting/deleting rows: data integrity problem when sum of the charts of the opened documents exceeds the Options->Memory->Number of objects: XLSX embedded objects do not get imported (just icons, not clickable): FILEOPEN: MS .pptx Textbox with stacked text imported wrong size: Problems changing focus to inside frame: FILESAVE: part of the comment text is lost in .docx using "save" toolbar button or "save" menu item: FILEOPEN: PPTX import with shapes causes text to disappear: EDITING: Selecting with mouse: too fast changing to next/previous page: Excessive duplicate accessible focused events for Calc input line [a11y]: text not rendered fully (cut off) when editing 90deg rotated rectangle: EDITING: undo leads to duplication for operations that involve of drag-and-drop (Slide pane, text areas): EDITING: Unable to edit .odb file with non-local URL: Fax-Wizard - Personal Data are only partial adopted: FILEOPEN writer doesn't show the chart numbers nor parts of this docx file: Impress template not rendered correctly (vintage, metropolis, sunset): EDITING: Layout Loop when writing into a section with 3 columns: 'Install' button in update dialog is never activated: FILEOPEN: Impress pictures not displayed in slideshow: OpenSymbol font is not retained after an upgrade: Calc: Used AutoFilter not highlighted when set in Calc and saved as XLS: MAILMERGE: Wrong record Number in Mailing: RTF File Imported Incorrectly - Pages Being Merged (Overlapping): PIVOTTABLE: pivot table not saved in xlsx: PRINTING: Images move when printing/creating PDF: OSX - no video playback in slideshow fullscreen display mode on OSX: XLSX IMPORT: Data plots in chart not visible when cells have formula, needs Ctrl+Shift+F9: PIVOTTABLE: Black color on fields of Pivot Table Layot window (Mac OS X only): FILEOPEN: text paragraph indentation/tab stops in .DOCX displayed incorrectly: EDITING, FORMATTING: diagram didn't automatic update when change variabele (recalculation not triggered): FILEOPEN: DOC import splits the page into two - Section break problem: Add warning about data loss when creating pivot table and deleting data source: Spacing to content should be disabled for images: resize image (picture) together with frame does not work: DATALOSS FILESAVE: xlsx pivot table corrupted after save with LO and re-open with MS Office: When opening .PPTX impress file, and then resaving as .PPT file. The Smiley/drawing clipart is not shown.: Adding a border and spacing to content shrinks the size on an imageI set status to RESOLVED MOVED to reflect the new way to handle Most Annoying Bugs.when we closed this MAB page in october 2015, 57 bugs were still open.now 1 year and few months later, 36 are left. LibO keeps improving. here's the list of the residual bugs. feel free to retest with latest LibO 5.3.x or 5.4.x dev releases.I'll be back next year to see how many are still there.here's the current list.------------------------------------------------------------------: If you insert an envelope into a document only the envelope is printed (Mac OS X): cropped pictures in .docx file are mangled and in wrong place: Impress Animation Sound Effect not played after file moved: VIEWING: Heading - Footer - Pagebreak lines appear somewhere inthe page: FILEOPEN LibO 3.3 documents shows Writer OLE object contents shifted right/down in object after edit of object because of page border issue: EDITING: Replication of frames when record changes (redlining) is on: Embedded HSQLDB calls flush (CHECKPOINT) too often: EDITING Report builder: mouse-move control: gap between mouse position: FILESAVE: Joined cells in table cause table distortion after save to DOC, DOCX: Brackets (..),{..},[..] inverted )..(,}..{,]..[ when switch to RTL text direction with all fonts: editing/formatting: pasting formatted font messes up formatting of bullets: inserting/deleting rows: data integrity problem when sum of thecharts of the opened documents exceeds the Options->Memory->Number of objects: XLSX embedded objects do not get imported (just icons, not clickable): FILEOPEN: MS .pptx Textbox with stacked text imported wrong size: FILESAVE: part of the comment text is lost in .docx using "save"toolbar button or "save" menu item: FILEOPEN: PPTX import with shapes causes text to disappear: EDITING: Selecting with mouse: too fast changing to next/previous page: text not rendered fully (cut off) when editing 90deg rotated rectangle: EDITING: Unable to edit .odb file with non-local URL: Fax-Wizard - Personal Data are only partial adopted: FILEOPEN writer doesn't show the chart numbers nor parts of thisdocx file: Impress template not rendered correctly (vintage, metropolis,sunset): EDITING: Layout Loop when writing into a section with 3 columns: 'Install' button in update dialog is never activated: FILEOPEN: Impress pictures not displayed in slideshow: Calc: Used AutoFilter not highlighted when set in Calc and savedas XLS: RTF File Imported Incorrectly - Pages Being Merged (Overlapping): PRINTING: Images move when printing/creating PDF: OSX - no video playback in slideshow fullscreen display mode onOSX: PIVOTTABLE: Black color on fields of Pivot Table Layot window(Mac OS X only): FILEOPEN: text paragraph indentation/tab stops in .DOCX displayedincorrectly: EDITING, FORMATTING: diagram didn't automatic update when changevariabele (recalculation not triggered): Spacing to content should be disabled for images: DATALOSS FILESAVE: xlsx pivot table corrupted after save with LOand re-open with MS Office: When opening .PPTX impress file, and then resaving as .PPT file.The Smiley/drawing clipart is not shown.: Adding a border and spacing to content shrinks the size on animage(In reply to tommy27 from)Thanks for making up this list Tommy.Did you also have the opportunity to check (some) if they may be fixed and the reports have been overseen?
id=75737	Hello AllI am using libre office 4.1.4 version on Windows 7 platform. I have installed VS 2012. When i am trying to convert MS Doc to PDF, by calling bootstrap() in order to intitialize the Reference <ComponentContext> variable. Here it gives error:Get following error::Microsoft C++ exception: com::sun::star::container::NoSuchElementException at memory location 0x0992d5bc.Microsoft C++ exception: com::sun::star::uno::DeploymentException at memory location 0x0992d750.Microsoft C++ exception: cppu::BootstrapException at memory location 0x0992d8d8.Help is required what fix need to be done, in order to fix it.With VS2010 - libre Office 4.1.4 works fine, able to convert MS Doc to PDF.RegardsVikram HelloI tried the same thing with version 4.2.1, but get error missing library: icppu.libRegardsVikramplease provide a minimal working example, source code plus exact instructions how you build and run it, that demonstrates your problemHelloProject Enviroment is using VS2012::WPF Based UI -> Launches CLR Project (dll)-> Launches C++ based Project(dll).In C++ projrect, Libre Office SDK API call::Reference <ComponentContext> ref = bootstrap();bootstap SDK API calls fails.RegardsVikramthat is much too vague to tell why it failsDear Bug Submitter,This bug has been in NEEDINFO status with no change for at least 6 months. Please provide the requested information as soon as possible and mark the bug as UNCONFIRMED. Due to regular bug tracker maintenance, if the bug is still in NEEDINFO status with no change in 30 days the QA team will close the bug as INVALID due to lack of needed information.For more information about our NEEDINFO policy please read the wiki located here:If you have already provided the requested information, please mark the bug as UNCONFIRMED so that the QA team knows that the bug is ready to be confirmed.Thank you for helping us make LibreOffice even better for everyone!Warm Regards,QA TeamDear Bug Submitter,Please read this message in its entirety before proceeding.Your bug report is being closed as INVALID due to inactivity and a lack of information which is needed in order to accurately reproduce and confirm the problem. We encourage you to retest your bug against the latest release. If the issue is still present in the latest stable release, we need the following information (please ignore any that you've already provided):a) Provide details of your system including your operating system and the latest version of LibreOffice that you have confirmed the bug to be presentb) Provide easy to reproduce steps – the simpler the betterc) Provide any test case(s) which will help us confirm the problemd) Provide screenshots of the problem if you think it might helpe) Read all comments and provide any requested informationOnce all of this is done, please set the bug back to UNCONFIRMED and we will attempt to reproduce the issue. Please do not:a) respond via email b) update the version field in the bug or any of the other details on the top section of FDO
id=75754	CreatedMaris Invoice from IntextGentlemen hiAttached is an invoice created in Libre Writer and when sent by gmail to my son on his iPhone 5 he is unable to open it - Can you please tell me how to convert this file into a Microsoft Word document version 2007- Have tried all your suggestions and none seem to work.I am using Microsoft Windows 7RegardsRoger IrwinPS - I think your product is really excellant Roger, this is not a helpdesk but a bug tracker.Please post your question here:Besides this being the totally wrong place for questions, it is against all rules to set your own bug to Highest / Critical.
id=75694	Createdexample odt that fails to save as docxProblem description: Content of comments deleted when saving to docx (data loss!). I believe this only happens when the first comment spans a block of text (i.e. select a word and hit alt-ctl-c) rather than a point comment (without a selected word); but it is hard to pin down.Steps to reproduce:1. Open LO and begin a new text document.2. Type "one two three four".3. Select the word "two", and hit "alt-ctl-c"; type "blah" into the comment box.4. Save as .odt, and quit.5. Open the .odt; save out as .docx, and quit.6. Open the .docx. The comment is blank, and "blah" does not appear in the source.If instead of selecting a word in (3), the cursor is placed somewhere, the comment saves properly.Attached is an example odt.Confirmed that this persists in 4.2.1.1 Operating System: DebianVersion: 4.1.5.3 release take a look at- Last comment text is lost if you save as .docx without shifting the focus to another text areaare you describing the same issue or a different one?(In reply to)A different issue. This bug appears whether or not I move the cursor after creating the comment.Other notes:1. it is necessary to close the document, and re-open it before saving out as docx. if I create a document, save as .odt, and save as .docx; or just save directly as .docx, this does not occur.2. if I do exactly the same steps, but first save as .docx, then close, and re-open and save as .odt, there is no problem. I am attaching examples: docx-then-odt.{odt,docx} : WORKS odt-then-docx.{odt,docx} : BROKEN3. this is serious: I first noticed this because of a document from someone else in which, when I saved as .docx to send back to them, all their comments would become blank. (major data loss) this is the minimal reproducible example.4. this affects .odt: in my testing, I have occasionally seen examples where the file saved *as .odt* has lost the contents of the comments, or the author of some comments. I haven't been able to make a reproducible example, though.Createdsaved first as odt (broken)Createdsaved first as odt (broken): subsequent save as docxCreatedsaved first as docx (works): docxCreatedsaved first as docx (works), subsequent save as odtUbuntu 13.10LibreOffice 4.2.2.1 rcPlease reset your user profile - I can confirm on the file you provided but cannot confirm on a new document. Marking as WFM since I cannot reproduce from fresh steps provided. Something is strange about that document you provided.If resetting your profile does not work - please COMPLETELY purge LibreOffice and then reinstall - preferably from a PPA/repository but if not just install from our site but again, make sure libreoffice is 100% purged, and you are using a fresh profile.If all of this fails set it back to UNCONFIRMED and we'll see what else we can try. Thanks!Purged (deleted) profile, and it still does exactly as before.(In reply to)oops. purging libreoffice, reporting back shortly.OK; I have purged libreoffice (confirmed with `locate libreoffice`) and the profile, and reinstalled 4.2.2.1 (downloaded manually); the issue persists unchanged.Quite strange! Okay requesting input here.I am able to reproduce this bug in this version and OO 4.2.4.2(Build ID: 63150712c6d317d27ce2db16eb94c2f3d7b699f8).Received a document in .doc format and then added comments. Saved to .docx format with comments.On opening, the comments were blank and with "(no author) (no date)" as their metadata.(In reply to)Confirmed with LO 4.2.3.2 under Windows XP. Comment contents are lost when saving an odt as docx.CONFIRMED following the 6 steps on:LibreOffice deb X86_64 on Ubuntu 13.04 installed in parallel with fresh user profiles* Version: 4.1.5.3* Build ID: 1c1366bba2ba2b554cd2ca4d87c06da81c05d24* with Italian Langpack and Italian Helppack* Version: 4.1.6.2* Build ID: 40ff705089295be5be0aae9b15123f687c05b0a* with Italian Langpack and Italian Helppack* Version: 4.2.4.2* Build ID: 63150712c6d317d27ce2db16eb94c2f3d7b699f8* with Italian Langpack and Italian Helppack* Version: 4.2.2.1* Build ID: 3be8cda0bddd8e430d8cda1ebfd581265cca5a0f* with Italian Langpack and Italian HelppackNOT CONFIRMED (the comments are saved correctly) on:* Version: 4.3.0.0.alpha1+* Build ID: b5f45a51638901ea679bf238ab460283e41bc622* TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2014-05-19_06:16:16* Version: 4.3.0.0.alpha1* Build ID: 46cfcd5a05aa1d13fecd73f5a25b64b8d8dd6781From `git bisect bad`: 109d2f4e645885b7e8fd7d1922ddbb9edfd303c3 is the first bad commit commit 109d2f4e645885b7e8fd7d1922ddbb9edfd303c3 Author: Bjoern Michaelsen <> Date: Wed Dec 7 03:30:31 2011 +0100 source-hash-d419bfc9f7e6114af7461fab17dc0782397e5433 commit d419bfc9f7e6114af7461fab17dc0782397e5433 Author: Rene Engelhard <> AuthorDate: Wed Aug 24 00:27:00 2011 +0200 Commit: Rene Engelhard <> CommitDate: Wed Aug 24 00:33:30 2011 +0200 <sys/prctl.h> is not available on kFreeBSD :100644 100644 327caa244afc01a2c9bb1223bdd14377b7fa714e d9a8780ced0719430dc7a87b690870ffad6519d4 M autogen.log :100644 100644 37b74648fdc021ef7aea0dcea42713086d0f09d7 5b7f0490fcd8febe812f9e40a269618f81a8cf64 M ccache.log :100644 100644 a959327c5b8f6fbb087af82032eccae35182da55 7890d604acd38686a8bdcf84f49898566786ad30 M commitmsg :100644 100644 94a31c5c53fb9828441944314e29a957cd7a7766 32e66fd8088573b6ce0d8996dca1a3a0db48617b M dev-install.log :100644 100644 ef64e110effff2d7895a09dc1089d5e0e4e00b84 f24bb4887a18c1485d0ea061ea763bb4cf5121a8 M make.log :040000 040000 1e21c3169faa1abfbd098944d9c241fdda04b148 83a8b438fbaeac1270ded9e0717e324ec63bb4a4 M optand from `git bisect log`: # bad: [793dbf6f80f497dfe587d560d6257f42a24273f6] source-hash-1581b1fc3ac82a7bd62df968226e98604a4ca52d # good: [65fd30f5cb4cdd37995a33420ed8273c0a29bf00] source-hash-d6cde02dbce8c28c6af836e2dc1120f8a6ef9932 git bisect start 'latest' 'oldest' # bad: [8092559c5013969ebda017d79200463b9b975038] source-hash-fd84daf696a368c2c7561b5253b32a63ecdeca4a git bisect bad 8092559c5013969ebda017d79200463b9b975038 # bad: [2bdbcaf93e4616633a733de7eb88ba19571929ac] source-hash-cf04745f7a027594fd64a493c276a8280dbccfe1 git bisect bad 2bdbcaf93e4616633a733de7eb88ba19571929ac # bad: [c2d3eb302c01963bb4730f0a35de5a83320bc778] source-hash-03591233c18c90158b3567f24fa332cd7c52a7ee git bisect bad c2d3eb302c01963bb4730f0a35de5a83320bc778 # bad: [f00432157d6f47a8fc098291fd2ac183ec2ec738] source-hash-5a212d501ee1c8ae2b7b9517a4ff486e61cac0fd git bisect bad f00432157d6f47a8fc098291fd2ac183ec2ec738 # bad: [077613cc9e1bb1cd2e38f4648081c14f856dd34f] source-hash-e5f71ca7c27259360a401d94ed6a53038608b941 git bisect bad 077613cc9e1bb1cd2e38f4648081c14f856dd34f # bad: [9ec082498e3baecd8af1cf37f24bc5241a5ee0fe] source-hash-a0a1c3f4fb730ed3614593c3d8ddb50c23204c29 git bisect bad 9ec082498e3baecd8af1cf37f24bc5241a5ee0fe # bad: [7cfa56b115e13355ad4c090239f10cd1d55ab1d8] source-hash-f7d71e379edf2c29d53182458342d7a5ce1446d6 git bisect bad 7cfa56b115e13355ad4c090239f10cd1d55ab1d8 # bad: [c4ac84e0f27bd6f6a355eadf14938fab72c1f492] source-hash-01f5362e7982cc1e5b8c9fa7216c892667971737 git bisect bad c4ac84e0f27bd6f6a355eadf14938fab72c1f492 # bad: [109d2f4e645885b7e8fd7d1922ddbb9edfd303c3] source-hash-d419bfc9f7e6114af7461fab17dc0782397e5433 git bisect bad 109d2f4e645885b7e8fd7d1922ddbb9edfd303c3confirmed with 4.2.4.2 under Win7x64Miklos - sounds odd to me =) you did some work around this - right ?reproducible with LibO 4.2.6.2not reproducible anymore with LibO 4.3.3.2 and 4.4.0.0 alpha2status RESOLVED WORKSFORMEMigrating Whiteboard tags to Keywords: (needsDevEval, bibisected)[NinjaEdit]
id=75946	CreatedDOCX Document created by Libre office and containing more pages of text. After opening this document in libre Office 4.1.5.3 it displays only 2 pages from more previously createdIn teh stable version under Debian Jessie I have crated a document with docx extension. After I edit the document and save it, it contains the text I have entered (In the file included in the document word/document.xml I can see the changes), but if I open the whole document in Libre office, then only short part of the text (2 pages of 4 or 5 originally saved) is displayed to me. ... the document has been created and is opened in the same libre office version/installation. I just created it opened the document 2 days later and this effect occurs.This is a very big problem, which cost me many hours of work. I have saved the document regularily uring the work.Createddocument.xmlI have found the document.xml has been generated in the wrong way by the Libre Office save mechanism.I have reformatted it so it can be seen better (in the attachment) and there is the following error if I try tov alidate the xml document:The 'w:hyperlink' start tag on line 1281 position 5 does not match the end tag of 'w:p'. Line 1288, position 5.I looked there, and there is really the problem with the missing hyperlink tag.CreatedRepaired document with removed invalid hyperlink tagssame error was also on the line 1444.It seems this occurs every time, if I write the hyperlink paragraph and on the same line behind the hyperlink I add also the text comment, which is not formatted as hyperlink, but like the normal text, then still in the document.xml, there is generated a starting tag like <w:hyperlink r:id="rId31">- it seems the procedure, creating the hyperlink tag automatically generates in this case the start for new hyperlink in such case, but not always - in the text lower there I can find it also correctly. But somehow it that way it can be generated, I guess - just make in the paragraph the hyperlink and try to add text behind the hyperlink into the same paragraph.I have removed the lines with invalid hyperlink start before this simple text, so it were the lines (in the previously uploaded document.xml): <w:hyperlink r:id="rId27"> <w:hyperlink r:id="rId31"> <w:hyperlink r:id="rId36"> <w:hyperlink r:id="rId39"> <w:hyperlink r:id="rId46"> <w:hyperlink r:id="rId49"> <w:hyperlink r:id="rId52">And I have inserted the document.xml back to the original odt archive and now it opens (There is also 1 Problem for me, because I have reformattted the document.xml in order to be able to perform the repair, so it has inserted a lot of <TAB> characters into the document, but this is not so big problem for me.)So, it seems, the problem is in the LibreOffice export procedure to docx, which created the invalid document.xml file and the importer then does not import anything, what is behind the first false (unfinished) hyperlink tag, what seems to be the expected behavior for such cases.I assumeis the already corrupted file, please attach the file before it was corrupted and the steps take to reproduce the corruption. => NEEDINFO(also please dont confirm your OWN reports by moving them from UNCONFIRMED to NEw, thanks)Sorry for changing the status.Unfortunatelly, I have reated the document in libre office directly and just saved it as docx, so there is was odt available. I will try to reproduce the steps again.Sorry for typing errors:... there was no odt created...Unfortunatelly, I canot reproduce it right now. What I remember, there was involved also the copy of the text with the links from Iceweasel (Firefox) :-(.Would close it as not reproducable usually, but making it a dupe of fdo#76316 now as they appear to be very similar.*** This bug has been marked as a duplicate of***
id=75950	CreatedBase file to generate the xlsx with the bug.From 4.2.1 saving in xlsx format, references with sheet name are broken, substituting the sheet name with #REF!! (f aca="false">SUM(#REF!!C3:C6)</f)Saving the attached file as xlsx, and reopen as xlsx, shows the issue.Regression from last working.Version: 4.2.0.4 Build ID: 05dceb5d363845f2cf968344d7adab8dcfb2ba71Issue in:Win7x64UltimateVersion: 4.2.1.1 Build ID: d7dbbd7842e6a58b0f521599204e827654e1fb8bVersion: 4.2.3.0.0+ Build ID: f41da077c76ee8a70fbcf4fe62e0bfb1fabc1a1c TinderBox: Win-x86@42, Branch:libreoffice-4-2, Time: 2014-03-07_23:04:18Version: 4.3.0.0.alpha0+ Build ID: 335a8a84fe6349fd716d4978346cfff9c884dd9b TinderBox: Win-x86@39, Branch:master, Time: 2014-03-07_23:59:04From question in ask: Thank you for reporting this issue! I have been able to confirm the issue on:Version: 4.3.0.0.alpha0Date: Tue Feb 25 19:58:48 2014 +0100 Platform :Ubuntu 13.10DE: GNOME3+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +As I've been able to confirm this problem I am marking as:New (confirmed)Critical - basic formulas being broken with xlsx saveHighestKeywords - regression - m.a.riosv says it works in 4.2.0.4 so this is a minor release regressionMAB4.2+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +LibreOffice is powered by a team of volunteers, every bug is confirmed (triaged) by human beings who mostly give their time for free. We invite you to join our triaging by checking out this link:and join us on freenode at #libreoffice-qaThere are also other ways to get involved including with marketing, UX, documentation, and of course developing -. Lastly, good bug reports help tremendously in making the process go smoother, please always provide reproducible steps (even if it seems easy) and attach any and all relevant materialHi Joel, thanks for adding to mab, seems a clear case for it.I'm on this.BTW, that attached file contains FORMULA function which Excel doesn't seem to have. When exporting it as xlsx those cells will break when opening in Excel. Just FYI.Ah, Excel added FORMULATEXT function in Excel 2013 and we map our FORMULA to that one. Unfortunately I only have Excel 2007 here on my machine so I can't verify that part, but then this bug report is about references not the FORMULA function mapping...I'll exclude round-tripping with FORMULA functions which should be handled in a separate bug. That appears to be an pre-existing problem.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#75950: Add test for this.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#75950: Just set the right grammar and be done with it.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.4.2 backport request:Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#75950: Just set the right grammar and be done with it.It will be available in LibreOffice 4.2.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Fixed.I loaded 4.2.3.1. The bug does not yet appear to be resolved. While the reference in the cell appears to be correct, the value displayed is incorrect. For example, in the sheet I tested, the formula in the cell appears as =$Coefficients.I20 both before and after saving. However, after saving the sheet the value appears as 0 regardless of the value in the cell referenced although the correct value appears before saving the sheet.(In reply to)That's a different bug and is handled in different bug report.Thanks Kohei.Verified Win7x64.Version: 4.2.3.1 Build ID: 3d4fc3d9dbf8f4c0aeb61498a81f91c5b7922f13Version: 4.2.4.0.0+ Build ID: e1823627f35e4419880769fdd05acddbd0a9c25c TinderBox: Win-x86@42, Branch:libreoffice-4-2, Time: 2014-03-18_14:25:19Version: 4.3.0.0.alpha0+ Build ID: 12ae7672f285da1d4c730315e8db23b3396b71cc TinderBox: Win-x86@39, Branch:master, Time: 2014-03-14_00:18:00***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***I can confirm that the specific (errant) behavior I originally reported is indeed fixed in Calc v.4.2.3.3. Thanks to all who orchestrated the correction.As a note to caxilbund's, I reported a similar experience in, though it's not a bug. About the same time the sheet reference issue arose, I found that certain formulas were displaying numeric zero, even if they were simply copying a text entry from another cell. It turned out to be a manual versus automatic recalculation issue. At the guidance of m.a.riosv, I set the Recalculation-on-file-load option to Always and all is good. From the Calc menu, choose Tools > Options... > LibreOffice Calc > Formula.I think a similar issue occurs as follows:Create 2 sheets, say Sheet1 and Sheet2Type some numbers in cells of Sheet1.Then refer to them on Sheet2 e.g.: =Sheet1.A1 etc.Sum these the cells of Sheet2 e.g.: =SUM(A1:A3)Select the cell that has the sum (and the next to it) and move them lower.In Sheet2, the Sheet1 references will disappear, leaving you with =A1 !!!Sorry I meant to have theas bug reopened!I can't reproduce your issue with:Versión: 4.2.8.2 Id. de compilación: 48d50dbfc06349262c9d50868e5c1f630a573ebdNot being the same issue, please open a new bug report, is the way, and best to avoid long threads. You can comment about this one in the new.Reclosed as fixed,
id=76663	Example: enter following in cells A1:A4: 0.1, 0.2, 0.3, 0.4. In cell C1 enter following array function: {=PRODUCT(1+A1:A4)-1}. Correct answer is 1.4024 = ((1.1)*(1.2)*(1.3)*(1.4))-1. LibreOffice Calc ver. 4.0.6.2 returns answer of 1.1840, which is equivalent to {=PRODUCT(1+A2:A4)-1} or ((1.2)*(1.3)*(1.4))-1. LibreOffice Calc is performing the computation, but ignoring the first number in cell A1. The error is not obvious on its face and might not be detected. The consequences could be devastating for users relying on LibreOffice to perform critical work. CreatedSample fileHi Mike, thanks for reporting.Reproducible:Win7x64Ult.Version 4.0.6.2 (Build ID: 2e2573268451a50806fcd60ae2d9fe01dd0ce24)Version: 4.3.0.0.alpha0+ Build ID: 926435ef5ab26e647c09887d471bde25b24e1c16 TinderBox: Win-x86@39, Branch:master, Time: 2014-03-22_00:09:58Last working:Versión 3.6.7.2 (ID de compilación: e183d5b)Createdsample fileReproduced on version 4.1.5.3 op openSUSE 13.1; changed platform in bug header.Changed sample file; removed irrelevant parts of function call and added function call in 2 steps to show the correct result.In sc/source.core/tool/interpr6.cxx, IterateMatrix(...), lines ScMatrix::IterateResult aRes = pMat->Product(bTextAsZero); fRes *= aRes.mfRest;produce the wrong result.I will dig further when I have some more time.Google Spreadsheets performs the calculation correctly. The formula is entered as: "ArrayFormula(product(1+A1:A4)-1)" (ignore the quotes "").(In reply to)Yes, it is clear that Calc does not calculate correctly in the case of{=PRODUCT(1+A1:A4)-1}whereas{=PRODUCT(A1:A4)-1}is calculated correctly.Internally, these 2 formulas are calculated differently.Unfortunately, I haven't found time yet to look into the problem thoroughly as I am currently working on at least two other bugs.Let's hope that either someone else*) will fix this before I finish my current bug fixes, otherwise it will take some more time.*: I could give some code pointers to start with.Added some traces to find out where the calculation starts going wrong.The problem is in /sc/source/core/tool/scmatrix.cxx, functionScMatrix::IterateResult ScMatrixImpl::Product(bool bTextAsZero),which produces the wrong result.Traces show that the WalkElementBlocks::operator() produces a wrong intermediate result:(code snippet: class WalkElementBlocks : std::unary_function<MatrixImplType::element_block_node_type, void> [...] void operator() (const MatrixImplType::element_block_node_type& node) { switch (node.type) { case mdds::mtm::element_numeric: { typedef MatrixImplType::numeric_block_type block_type; block_type::const_iterator it = block_type::begin(*node.data); block_type::const_iterator itEnd = block_type::end(*node.data); for (; it != itEnd; ++it) { if (mbFirst) { maOp(maRes.mfFirst, *it); SAL_WARN( "76663", "WalkElementBlocks::operator() mbFirst = true, maRes.mfFirst=" << maRes.mfFirst << ", maRes.mfRest=" << maRes.mfRest << ", maRes.mnCount=" << maRes.mnCount ); mbFirst = false; } else maOp(maRes.mfRest, *it); SAL_WARN( "76663", "WalkElementBlocks::operator() maRes.mfFirst=" << maRes.mfFirst << ", maRes.mfR est=" << maRes.mfRest << ", maRes.mnCount=" << maRes.mnCount ); } maRes.mnCount += node.size; } break;)traces:warn:76663:32404:1:sc/source/core/tool/scmatrix.cxx:1009: WalkElementBlocks::operator() mbFirst = true, maRes.mfFirst=0, maRes.mfRest=1, maRes.mnCount=0warn:76663:32404:1:sc/source/core/tool/scmatrix.cxx:1014: WalkElementBlocks::operator() maRes.mfFirst=0, maRes.mfRest=1, maRes.mnCount=0 <<== msRes.mfRest should be 1.1 !!warn:76663:32404:1:sc/source/core/tool/scmatrix.cxx:1014: WalkElementBlocks::operator() maRes.mfFirst=0, maRes.mfRest=1.2, maRes.mnCount=0warn:76663:32404:1:sc/source/core/tool/scmatrix.cxx:1014: WalkElementBlocks::operator() maRes.mfFirst=0, maRes.mfRest=1.56, maRes.mnCount=0warn:76663:32404:1:sc/source/core/tool/scmatrix.cxx:1014: WalkElementBlocks::operator() maRes.mfFirst=0, maRes.mfRest=2.184, maRes.mnCount=0warn:76663:32404:1:sc/source/core/tool/scmatrix.cxx:1661: ScMatrixImpl::Product aRes.mfFirst=0, aRes.mfRest=2.184, aRes.mnCount=4@Kohei: I took the liberty to cc you. Since you committed most changes of /sc/source/core/tool/scmatrix.cxx, could you give me a hint where to look for the cause of the problem?(In reply to)Well, you already have found the problem area. Beyond that, I can't really give you any extra hint without myself taking a deeper look into it.I'll take a good look at this.=PRODUCT({1.1,1.2,1.3,1.4}) is a much simpler way to demonstrate the problem.Yup, indeed. The first element of a matrix was always skipped for PRODUCT. Will fix this.And we did have a unit test for this, but unfortunately the first value in the test was 1. So it wasn't detecting the first value being skipped. Duh! I'll fix that as well.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#76663: Better test to really test PRODUCT with array input.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#76663: Let's not skip the first element of a matrix in PRODUCT.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.4.2 backport:(In reply to)@Kohei: thank you for your fast fix! Judging by the timestamps of the comments, you took 45 minutes to fix it plus improve the unittest plus backport to 4.2. It would have taken me at least tenfold that time and I learned from your patch how the iterating takes place (hadn't completely figured that out yet).Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#76663: Let's not skip the first element of a matrix in PRODUCT.It will be available in LibreOffice 4.2.5.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Pending review for 4-2-4 atKohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-1":fdo#76663: Let's not skip the first element of a matrix in PRODUCT.It will be available in LibreOffice 4.1.7.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Pending review for 4-1-6 atI'll mark this fixed meanwhile.***has been marked as a duplicate of this bug. ***Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-2-4":fdo#76663: Let's not skip the first element of a matrix in PRODUCT.It will be available already in LibreOffice 4.2.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-1-6":fdo#76663: Let's not skip the first element of a matrix in PRODUCT.It will be available already in LibreOffice 4.1.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Following Kohei Yoshida's patch announcement, I just downloaded and installed Version: 4.1.6.2, Build ID: 40ff705089295be5be0aae9b15123f687c05b0a, and tested with the array formula {=PRODUCT(1+A1:A4)}. On my computer, the problem persists, skipping the value in A1 (first element of the matrix).(In reply to)Mike, version 4.1.6.(rc)2 was out before Kohei's patch was pushed and is not yet the release version, but a release candidate. I expect it will be in the next version (4.1.6.3), scheduled later this week.Thanks. Welcome news. Eagerly awaited.There was no 4.1.6.3 and the release was build before the change appeared on the branch. It would be in 4.1.7 if we released that.Verified with:Win7x64UltimateVersion: 4.2.5.0.0+ Build ID: b26b9606efa30c0a44e20dcf638fbd1e27f05089 TinderBox: Win-x86@42, Branch:libreoffice-4-2, Time: 2014-05-06_06:43:43Version: 4.3.0.0.alpha1+ Build ID: a1dd961c3093f5f7624e4d1f2240e9120fd13f23 TinderBox: Win-x86@39, Branch:master, Time: 2014-05-06_11:47:48Still in:Version: 4.2.4.2 Build ID: 63150712c6d317d27ce2db16eb94c2f3d7b699f8Filename: LibreOffice_4.2.4.2_Win_x86.msiPath: /libreoffice/old/4.2.4.2/win/x86/LibreOffice_4.2.4.2_Win_x86.msiSize: 209M (219451392 bytes)Last modified: Mon, 05 May 2014 22:19:21 GMT (Unix time: 1399328361)(In reply to)Are you sure?I have it fixed in version 4.2.4.2, Build ID: 63150712c6d317d27ce2db16eb94c2f3d7b699f8 on Windows 7-64No, please forgive me, I don't know what I did.Retrying again works for me with Version: 4.2.4.2 Build ID: 3150712c6d317d27ce2db16eb94c2f3d7b699f8Thanks Winfried.
id=76842	HelloBackground:We are a local government authority who made the decision to use an open source (StarOffice) office product when our XP desktop was deployed, back in 2006.Just over a year ago, we completed a move to Windows 7, and used this as an opportunity to replace StarOffice with LibreOffice.Current situation:On the whole, we don't receive many LibreOffice-related calls, but one which keeps plaguing us is one where LibreOffice keeps hanging on start.We've found a number of posts which suggest deleting the %appdata%\3\user\config\javasettings_windows_x86.xml file, and this does work, but due to the randomness of the fault, this isn't that great an option, seeing as we have more than 8500 users.Has this issue be fixed in more recent versions of LibreOffice?Are there any other files/registry/configurations changes which we could make to eradicate this problem?Please let me know if you need any more information.James Hi James, the version you indicated is rather old, did you test with 4.1.5 which is the last stable version? Hanging on start could depend on many different factors, so it's not easy if you don't have a recurrent case to analyse. SophieThanks for the repliesWe are using rather an old version, but on my travels whilst researching this issue, it seemed others were reporting it still exists in more recent versions too.We recently switched from Java 1.6.0_29 to 1.7.0_21 and had a huge number of calls from people who could no longer use LO.Whether these people had LO open when the Java update installed, I don't know, but this could be a good way of trying to reproduce the fault.CreatedClick on LO WriterCreatedErrorCreatedCorrupted fileCreatedFixed file after deleting duff oneCaught one in the act. This machine had Java 1.6.0_29 and was upgraded (via SCCM) to 1.7.0_21. The install routine we wrote for JRE1.7 uninstalls 1.6 and SHOULD delete the %appdata%\3\user\config\javasettings_windows_x86.xml file.The machine crashed out when trying to open ANY LibreOffice componenent, but after deleting the file and allowing it to recreate, it fired up first time.I've attached the file which was recreated after deleting the corrupted one, just for comparison. The Java folder is obviously different, but the rest of the file appears to be very similar.We've also tried unticking 'Java' in the LO settings, but it still tries checking for it. Why?If the file gets recreated each time, why store it at all?This is becoming a MASSIVE problem for us as the Java update gathers pace.Our service desk has taken over 90 calls since Monday and we've had to issue an emergency (hopefully) short-term botch which allows users to easily delete the file via a shortcut.We really need a fix for this.Can anyone help?FromHi James,On Thu, 2014-04-03 at 08:06 +0000, wrote:Of course Collabora can help - if you're willing / able to pay for support there. Just in case that's an option; it'd be interesting to have some moredetails: * why LibreOffice 3.6.x ? - is it for the legacy StarOffice binary file importers ? + assuming so - up-stream TDF do no 3.6.x releases anymore. * what deployment methods do you use to deploy fixes ? Of course, the ideal is that, assuming we can get the business pieces together, that we can find a workaround here for you that doesn't require a new build - but there's some hours of code reading & investigation needed first. Anyhow - if you're interested; we have the engineers that can do the work. ATB, Michael.Can Collabora please stop buzzing me with fake offers of help? I've already had a lengthy waste of time phone chat with Tim Isles, who, rather than wanting to help, was simply touting for business.He said Collabora couldn't help, well, not unless we spent a lot of money purchasing your 'hardened' version of LibreOffice and taking out a support contract, neither of which we are willing to do.What a great Open Source community spirit. Yeah, use our buggy software for free, but then pay us to fix the bugs.Thanks for absolutely nothing.James, can you understand that we are only volunteers here? by helping with Collabora or any other certified company you want, you are ensuring the continuity of the product you chosed to use and participate to the LibreOffice ecosystem. Now back to your bug, we need more information to understand what is happening in your particular environment and it's more than probable that with this missing information, no volunteers from the QA team will try to qualify your bug, not because he doesn't want whatever the time it will cost him, but because he can't.Back to need info - SophieThanks SophieSo what information would you like?I've posted screenshots and have posted before and after examples of the offending file.(In reply to)You didn't answer: did you test with 4.1.5 which is the last stable version?For your information, even if we provide a fix solving your problem, it will only be in our next version, we won't backport it to 3.6.1.2 which is EOL for us. This is why Collabora is not a fake offer of help, only professional support would fix a version that is EOL for the community. SophieJames; your approach to private mail is refreshingly unconventional. So, let me excerpt my reply:Sorry to waste your time; Tim works for me, I'll pass on the feedback.TDF doesn't encourage anyone to use 3.6.x - it's obsolete. TDF ingenerally encourages enterprises to engage commercial support over thelonger term to avoid exactly this sort of issue. One example might be:"The Document Foundation encourages large organizations deployingLibreOffice to do so in conjunction with a support partner, who cancarefully assess specific requirements, help manage migration andprovide bespoke fixes for identified issues. Purchasing LibreOfficesupport from a TDF partner also provides enterprises with an indirectmeans to contribute financially to the project, thereby funding itsdevelopment, improving its stability, and accelerating its growth."etc. I'm sorry for the situation you find yourself in; but on the other hand - have to sign the cheques for my engineers.All this aside - it is unlikely but possible that someone might help you for free; as such it may be useful to have more information here - particularly around what is possible for your scenario. I imagine in the absence of any new build - we'd need (somehow) to drop a new file or delete a file to work around this; as such it'd be useful to know what the capabilities of your central desktop management system is; so leaving NEEDINFO for now.It'd also be nice to confirm if the StarOffice binary file format issue is what keeps you on 3.6.x ? if not updating would be an option, if so - its a bit of a problem really.All the best.We haven't tested with 4.1.5, but if you Google the problem, there's evidence of this issue existing with other version.As I mentioned previously, upgrading 8500+ machines isn't a swift fix.I totally understand your comments about this support working on a voluntary basis, but if I was volunteering at a homeless shelter, I wouldn't be trying to sell people my brand of gravy to enhance the flavour of their free meal, I'd either give it to them for free (cos I'm kind), or not mention the gravy at all.When I posted this, I knew any help would be given on a goodwill, 'forum' type basis, and TBH I would rather nobody helped, than have people almost holding me to ransom by telling me I must purchase their services before I could or would get help.I'm grateful for your interest, but moving straight to the new version without some sort of guarantee the problem has been resoved would be too risky.Would you like some free gravy?(In reply to)
id=76995	CreatedContains document to print, data base, step by step - 3 files in tosend folderProblem description: I don't have an English version installed, so menus name could be not exactly the one expectedWhile printing type letters ( File --> print --> yes to question, "do you wish to print type letters"I wish to print the record number in the data baseSteps to reproduce:1. Create a Mailing document for a xls or ods file as data base2. Insert in the document the record number as explained in:Insert --> Fields --> Other --> Database --> type = record number3. Print a type letterFile --> Print --> yes to the question :"do you wish to print a type letter"Current behavior:1) If I create a unic file containing all documents, all the documents have the same number ( empty or a value)2) If I create an ODT file for each document, each one has a correct number ( from 1 to the number of file in DB or result of filter on DB)3) If I create an PDF file for each document, all the documents have the same number ( empty or a value)4) If I do the same tests with mailing assistant(Tools --> Mailing assistant)Even the ODT files for each document ( as in step 2) are wrongExpected behavior:Each document, using any print mode, has a record number in the data base or in the result of a filter in the data base.I expect to print that one ( which is not a page number)I have the same issue wit Apache OpenOffice 4.0.1I have recently installed LibreOffice and last OpenOffice version. I was able to use this option since 2006, with a previous OOO version, I don't remember wich one, may be before it became Apache.I use this option to print fiscal documents once a year. I attach list_mvt.ods the database, on which a filter should be applied: Nom not empty andMontant > 0then "Lejeune" should have number 3 when printingbulletin.odt is the document to printchange the database in order to link it to list_mvt.odsetapes.odt contains step by step screen shots ( In French)Operating System: Windows 7Version: 4.1.5.3 release HelloI reproduce on windows 7/64 & Version: 4.2.3.2Build ID: 7c5c769e412afd32da4d946d2cb0c8b0674e95e0Thank you for reportingRegardsPierre-YvesThe last feature version, working correctly, I used, is the one of OOo 3.3.0 ( before Oracle)still there with:Version: 4.2.5.2Build ID: 6ff819b65674ae6c83f3cbab9e4a4c2b292a7a94and even worse as, except I am wrong, standard Filter applied on data document doesn't workon list_mvt.ods the database, a filter should be applied: Nom not empty andMontant > 0But has no effect, and is not saved ( File --> print --> yes to question, "do you wish to print type letters" --> define and apply the filter).Not working with 4.3.x.(In reply to)Forget my comment about filter, this is managed inTo summarize, record number is wrong in versions: 4.1.5.3, 4.2.5.2, 4.2.6.2, 4.3.0.4 of LibreOffice and also Apache OpenOffice 4.1.0at least.Mailmerge has recently been refactored heavily on master, could you please test a recent daily build, details see:Hi,WithVersion: 4.4.0.0.alpha0+Build ID: 9aa36a1ad39e37c372cc833a44fba450b8cc30cdTinderBox: Win-x86@42, Branch:master, Time: 2014-10-09_03:25:27With File --> Print :1) If I create a unic file containing all documents, all the documents have the same number ( empty or a value)2) If I create an ODT file for each document, each one has a correct number ( from 1 to the number of file in DB or result of filter on DB)3) If I create an PDF file for each document, all the documents have the same number ( empty or a value)4) If I do the same tests with mailing assistant(Tools --> Mailing assistant)Even the ODT files for each document ( as in step 2) are wrongBernardHi,I did the test with:Version: 4.4.0.0.alpha0+Build ID: 7f900e2e2f5faa0a568209791c57cb024f14fe33TinderBox: Win-x86@51-TDF, Branch:MASTER, Time: 2014-10-10_00:12:08Still not working, same results I described while opening the bug.Version: 4.4.0.0.alpha0+Build ID: 7f900e2e2f5faa0a568209791c57cb024f14fe33TinderBox: Win-x86@42, Branch:master, Time: 2014-10-10_00:12:03Not working, same behaviour described when I created the bugOnly individual odt files are correctSorry, I had not completely tested.I re-tested with File > Print.If I use standard filter to select one or several records, record number is wrong when printed record(s) is(are) saved as single or individual odt document. Record number seems to be an incremental number starting to 1.But when I print all the records as single or individual document, record number is correct in both cases (not the same number, but I think that is an increment like in my test with only several records).Hi,I did the test with:Version: 4.4.0.0.alpha1+Build ID: 9ecac3874d179b1d7aa6b45337001b1def06a9ddTinderBox: Win-x86@42, Branch:master, Time: 2014-10-22_06:31:01still not working with or without filter.Same behaviour I described when I opened the bug.Thanks for your time.This bug still occur inVersion: 4.4.3.2Build ID: 88805f81e9fe61362df02b9941de8e38a9b5fd16Locale: en_US--------------------I have the same problem. Mail merge render 400 pages, but it appeared 800. Changing Format --> Page --> Page --> Layout Setting Page Layout: Right and Left displaying similar result withPage Layout : Only rightbest regards,putudesame behaviour with:Version: 5.0.2.2Build ID: 37b43f919e4de5eeaca9b9755ed688758a8251feLocale : fr-FR (fr_FR)Oliver Specht committed a patch related to this issue.It has been pushed to "master":tdf#76995: updated cached value on Evaluate() of db name fieldIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Createdresults with 5.1.0.0Hi,Thanks for your update.Sorry for the delay.I did test on Windows 10 64 bitsWith :Version: 5.1.0.0.alpha1+ (x64)Build ID: d667e3210b12c7ce3b3727e2a0e369a520fbaaa4Threads 4; Ver: Windows 6.19; Render: default; TinderBox: Win-x86_64@42, Branch:master, Time: 2015-11-25_01:47:38Locale: fr-FR (fr_FR)JAVA 64 bits 1.8.0_66It is better but one case is not working: when individual pdf files are generated , all contain the data of the first records.Othewhise, individual odt, single pdf, single odt are workingI attach the results in test5100.zip (got with the testcase attached previously)Version: 5.1.0.0.beta2+Build ID: 52ac1a717b1869cb7d2ee710f50a15e216ced76cThreads 8; Ver: Windows 6.2; Render: GL; TinderBox: Win-x86@62-merge-TDF, Branch:libreoffice-5-1, Time: 2015-12-06_22:28:00Locale: fr-FR (fr_FR)Same behaviour than discribed in previous comment and attached results.- results for individual odt, single pdf, single odt are correct- results for individual pdf are not correct, all the files contains the data of the first record in the data base.I did the test with:Version: 5.2.3.3 (x64)Build ID: d54a8868f08a7b39642414cf2c8ef2f228f780cfThreads CPU : 8; Version de l'OS :Windows 6.19; UI Render : par défaut; Locale : fr-FR (fr_FR); Calc: groupMy test case is working.Thanksis the bug still present or not?In my environment Version: 5.2.3.3 (x64), ( see my previous comment)with my testcase, attached to this bug when it was opened, it works.so this means RESOLVED WORKSFORME
id=77080	When inserting rows in some distance to the cell containing summation, then the summation area is changed in severely wrong manner - totally unexpected.See examples (calc files and screenshot)1) Summations in row 5 and in row 9 (each column E)2) Marking some row numbers at the left border and choosing "insert rows" in the right-mouse-click context menue (and inserting nummer "5" in one of the new cells) shows correct and expected behaviour: the summations are not affected.3) Marking as much row numbers at the left border, that row 5 also is marked (to insert 4 rows above former row 3) - then the summation area is enlarged, wrongly including rows 5 to 8 (new counting), even though rows 7 and 8 are not changed, only transferred downwards.Expected behaviour: row 9 is not changed, relative adresses in the summation should still relate only to this row itself (before: row 5, afterwards: row 9) with no change into an rectangle area.4) Marking more row numbers at the left border and choosing "insert rows" leads to an even stranger behaviour: the summation area is enlarged, containing other blocks of numbers now.I proposed severity "major" and priority "high", since this behaviour really affected some complex spreasheets of mine during the last months.1) Totally wrong numbers arised (apparently in random manner)2) It was not easy to identify the source of that confusion.3) And even with that knowledge now - it is still much work to check all summations within the spreadsheet that could have been affected when inserting some rows. Createdspreadsheets before and after inserting rows, screenshots showing areas used in the formulafile upload was not successfully in the first stepHi. Your step-by-step is hard to follow, because the screenshots don't show the "ABCD" landmarks.You say that 1)-2) is right ; which is wrong, 1)-2)-3) or 1)-3) ? I didn't manage to reproduce the bug (LibO 4.2.2.1 on Win7). It would be kind of you to provide a more explicit step-by-step.Createdspreadsheet & screenshots, before & after inserting rowsload the spreadsheet and look at the screenshots to test the bugToday I updated manually (!!) LO, uninstalling vers. 4.2.2 and installing thevers. 4.2.2.3. Still the same bug exists!my OS is 64-bit Windows7 SP1edit; unistalling 4.2.2.1edit; unistalling 4.2.2.1This may be the same bug I just found. I have a spreadsheet with some cells containing sums of other cells. If I insert new rows above the sum range, the sum range is not adjusted correctly. The end of the range is correctly increased by the number of rows added, but the beginning of the range stays at the original value. The effect is that the formula now sums too many rows.I insert the rows by selecting several rows, then using Insert > Rows in the menu. The number of rows inserted does not seem to matter. If rows are deleted instead, both the start and end of the sum range are adjusted correctly.I found this in 4.2.3.3. I upgraded to 4.2.4.2, hoping that it had been fixed, but it's still there. I am using Windows 7.I tested this with version 4.0.1.2 on my old XP computer, and it does NOT have this bug.As I write this, I've done a little more playing around, and this seems to happen only if the rows I have selected in order to do the insert overlap the sum range. Example:Cell E14 contains =SUM(E4:E13)I want to add 7 rows after row 1, so I select rows 2-8 and then choose Insert > Rows in the menu.7 rows are added; cell E14 is now E21 and contains =SUM(E4:E20)It should contain =SUM(E11:E20), since the rows I added are outside the sum range.I've looked at Steffen's attachments now, and am pretty sure it is the same bug. Looking further at the bug lists, #77647 seems to be the same thing, and is listed as fixed in 4.2.5.0. That appears to be scheduled for release in June. I can probably work around the bug until then (just use multiple, smaller inserts that don't overlap the sum range).CreatedWorkflow video insertion/deletion rowsComment onWorkflow video insertion/deletion rowsLO vers. 4.2.4.2Using the command "insert rows above", after Selecting a row with a cell containing a reference to a range, the range is altered. Unexpected results, operating on the same Resulting range, even with the use of "Delete selected rows". The same thing happens with any command that uses the range.FURTHER COMMENTS:When this bug happens in a large spreadsheet, it causes the program to crash.When the crashed file is restored authomatically at the next start, in all the cells where there were functions, these are substituted by numbers!!This unaspected modification is "invisible": it happens without any warning from the program.On the contrary, using MS Office to open the restored ods file, a warning of defective file is given, and the "modified" cells are highlighted as errors.Now I'm back to using "Apache OpenOffice" vers. 4.1.0, as it does not have this very dangerous bug.Seems that enough informations provided, set UNCONFIRMEDI think we need expert opinion here.As Nancy said, perhaps duplicate to(In reply to)Following the test case, I can't reproduce under LO 4.2.5.2 - Ubuntu 12.04 x86. Perhaps related tofixing.Please REOPENED if anyone can reproduce in latest stable release(In reply to)Christian,maybe this bug was fixed under your "LO 4.2.5.2 - Ubuntu 12.04 x86".But I confirm that this bug still exists in the test ods file, opened with my LO 4.2.4.2 (Build ID: 63150712c6d317d27ce2db16eb94c2f3d7b699f8), which is the latest stable release in my Windows7 64-bit SP1 Operating system.Mariano, you can only reopen a bug if you can reproduce with same or higher version...not with older.. And don't forget to reset user profile to make sure its freshness.4.2.5 has arrived for Windows:*) Anyway, curently LO has no 64bit version for Windows
id=77328	I'm working on a rather large file (>100 pages) with a lot of footnotes (> 100 per chapter, 6 chapters).ODT format.Cross references to footnotes are all wrong, both page numbers and footnote number.If I enter a cross reference (e.g. "see footnote n. 23, at page 40"), it then outputs a reference to some other footnote and page (e.g. "see footnote n. 2, at page 5"). Usually it refers to low numbers, like in the example.Unfortunately I can not provide the file as an example, but I think the problem can be easily replicated since it shows in all computer I have worked with, since at least v. 4.1 of LO.In the file there are also Zotero references.For a research paper like mine this makes LO unusable, so please do something about it asap! Confirming this bug for a document involving 133 footnotes, the final section of which (from fn. 127 onwards) needed to repeat fn. 127 as a cross-reference 4 times, and fns. 128-129 as cross-references once each. When attempted in the original document, the cross-references would appear as references to random footnotes, often about halfway through the document (e.g., a cross-ref. intended for fn. 127 would appear -- and link to -- fn. 66). When I copied that section out of the document and into a new document, set up the cross-references as necessary with only 13 footnotes, and then copied it back to the original document, it appears to have worked. This is clearly not a solution had I needed the cross-references to be to distant sections of the document.Createdfootnotes are zero-numberedComment onfootnotes are zero-numberedI'm working on a large .odt file with 248 pages, 71870 words, 499467 characters. If I try to add a corss reference to a footnote, the list shows many of them zero-numbered.Createdfootnotes are no more zero-numbered clicking on the firstIf I click on the first zero-numbered footnote, numbers change starting from 1 and links do work.EDIT: I tried once again but it didn't work. Sorry. Footnotes numbers are still zero. Clicking on a cross reference goes to the wrong footnote.So, LibreOffice is unusable for me. Shall I remove all cross references to footnotes?I want to report similar bug for LO 4.2.4.2 debian paketIn a document with 393197 characters, 49543 words, 119 pages 26 chapters and 198 footnotes the cross references to chapter of a footnote always contains ??.cross references to footnote number and footnote page, that didn't work in 4.2.3.3 seem to be fixed in 4.2.4.2.I've tried this on 4.1.6.2 and notice no issues with a footnote 88 on page 48 (Total 77 pages). Can you all please provide the earliest version this bug is seen? The version field says 4.2.2.1 while OP says "at least v. 4.1".According to, "cross references to footnote number and footnote page, that didn't work in 4.2.3.3 seem to be fixed in 4.2.4.2." Can others confirm?Now I'm using LibreOffice 4.2.5.2.If I open an ".odt" document containing 608068 characters and 298 pages and immediately I try to add a cross-reference, footnotes numbers start always from 0, so the bug still remains.But if I try again after having done something, footnotes start from 1.It appears a random behaviour; don't know what unlock the program.Never CONFIRMED so UNCONFIRMED is the appropriate status.Please provide a sample document. You can anonymize with this:Change back to UNCONFIRMED after you have provided the document.Dear Bug Submitter,This bug has been in NEEDINFO status with no change for at least6 months. Please provide the requested information as soon aspossible and mark the bug as UNCONFIRMED. Due to regular bugtracker maintenance, if the bug is still in NEEDINFO status withno change in 30 days the QA team will close the bug as INVALIDdue to lack of needed information.For more information about our NEEDINFO policy please read thewiki located here:If you have already provided the requested information, pleasemark the bug as UNCONFIRMED so that the QA team knows that thebug is ready to be confirmed. Thank you for helping us make LibreOffice even better for everyone!This NEEDINFO Message was generated on: 2015-06-08Warm Regards,QA TeamDear Bug Submitter,Please read this message in its entirety before proceeding.Your bug report is being closed as INVALID due to inactivity and a lack of information which is needed in order to accurately reproduce and confirm the problem. We encourage you to retest your bug against the latest release. If the issue is still present in the latest stable release, we need the following information (please ignore any that you've already provided):a) Provide details of your system including your operating system and the latest version of LibreOffice that you have confirmed the bug to be presentb) Provide easy to reproduce steps – the simpler the betterc) Provide any test case(s) which will help us confirm the problemd) Provide screenshots of the problem if you think it might helpe) Read all comments and provide any requested informationOnce all of this is done, please set the bug back to UNCONFIRMED and we will attempt to reproduce the issue. Please do not:a) respond via email b) update the version field in the bug or any of the other details on the top section of FDOMessage generated on: 2015-07-18
id=77331	If there is a text box inside a chart (either in Calc, or if the chart was pasted into Draw). After saving the file, closing it, and opening it again, all the text boxes are gone.The text boxes also disappear if the chart is simply copy-pasted.I used LibreOffice 4.1.5 until today and this didn't happen. I'll go back to it, as this bug is a a complete no-go for LibreOffice 4.2.x...Thanks andall the best! I just tested on version 4.2.2 and the same happens.All the text boxes inside charts disappear.Hi Blargh, thanks for reporting.I can reproduce the issue with:Win7x64UltimateVersion: 4.2.0.4 Build ID: 05dceb5d363845f2cf968344d7adab8dcfb2ba71Version: 4.2.3.3 Build ID: 6c3586f855673fa6a1576797f575b31ac6fa0ba3Version: 4.3.0.0.alpha0+ Build ID: f9cc0daec26016722bf5260e4e2634e6dcfe25a2 TinderBox: Win-x86@39, Branch:master, Time: 2014-04-12_01:41:16Last version working:Version: 4.1.6.0.0+ Build ID: 0b772a163b2536fc55aa3b4de925119e33af769Creating the text box with 4.2 or 4.3 and saving, saves the text box because if you open the file with 4.1.6 it is there.Seems the issue is opening with 4.2/4.3.Regression from 4.1.6*** This bug has been marked as a duplicate of***
id=77731	CreatedError message received when trying to save recordAfter successfully creating 17 records in "Form" mode, the program won't save the 18th and won't let me add any new records to the database. Pop-up message says:Error inserting the new recordS1000 General error java.lang.NullPointerException in statementINSERT INTO "Art"("Address","AmountPaid","City","CollectionID","CopyrightYear","DatePurchased","Discount","EditionNumber","EmailAddress","FirstName","Insured","ItemType","LastName","PaymentMethod","PhoneNumber","Photo","PurchasedAt","SalePrice","SalesTax","ShippingCost","StateOrProvince","Title") VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)] Make a copy of the database. Delete all personal data in the database and attach the empty (or filled with dummies) database to this bug. So somebody elese could have a look at it.Without any example it is impossible to get the same error.You are using the internal HSQLDB?Where is the Primarykey in your table "Art"?Could you reproduce the same with any dummy-data?CreatedA sample of the DB form used when LO stopped allowing records to be addedThe "add record" button is greyed out on this dummy database form as well as on the original. The original stopped adding new records after #17. The dummy won't even get beyond Record #1 whether I hit "add record" or "next record." Hoping someone can duplicate this bug and suggest a work-around.CreatedSample of the DB form used when LO would not "Add Record"This a dummy of the original DB form that stopped allowing "Save Record" and "Add Record" after 17 records created. For some reason, the "dummy" will not add a record beyond #1.Any chance there's a work-around for this bug?If not, the LO database is totally USELESS.(In reply to)You have added only a form, not the database. Please attach the *.odb-file.Following Robert's comment, I put it as NEEDINFO.Judith: may I suggest you to give a try to 4.2.4 since there won't be any new official release with 4.1 branch? (last 4.1.X version is 4.1.6)No feedback since several months, I put it INVALID since we can't even give it a try.Judith: don't hesitate to reopen this tracker if you still reproduce this with last LO version (4.2.6 or 4.3.0) and please attach an example file in this case.
id=78108	Problem description: LibreOffice is unstable (all open apps crash simultaneously) when attempting to paste moderately complex data from Calc to WriterSteps to reproduce:1. Open a pre-existing ods or xls file with 10+ columns, 50+ rows, some formulas, formatting and filters2. select a grid with 5+ columns, 20+ rows and a mixture of formatting, hit ctrl-C3. create a new writer doc, hit ctlr-v to paste in the data from calcCurrent behavior:Both calc and writer crash after a second or two. Documents are recoverable but the paste does not work at allExpected behavior:Data is pasted into writer as a calc8 objectIssue:I have not been able to isolate this issue to a single condition (eg: certain formatting). However, LIbreOffice was not unstable in this manner before I upgraded from Ubuntu 13.10 to 14.04 (and thus got a LibreOffice upgrade to 4.2.3.3 Operating System: UbuntuVersion: 4.2.3.3 release With further testing, the problem seems to relate to attempts to paste a data range from Calc to Writer, which contains formulas in at least one column.I have attached a very simple spreadsheet which can be used to reproduce the problem. just select all the cells that have content, and attempt to paste them into a new Writer doc - kaboom!CreatedSample calc file which can be used to demonstrate this bugHi Simon,Thanks for reporting!Works fine in 4.2.2Crashes in 4.2.3.rc1 and 4.2.4.rc1Just to be clear, this is the exact version reported by my copy of Libre Office:Version: 4.2.3.3Build ID: 420m0(Build:3)I don't think this is the release candidate?Same problem here.LibreOffice version: 4.2.3.3 build id 420m0 (Build:3) shipped with Ubuntu 14.04 LTSsee@simon: yes, that is correct. I mentioned the first version with the bug*** This bug has been marked as a duplicate of***The copy-paste Calc8 cells to Impress is still there in LO 4.2.4.2.It closes all files and starts the recovery.Bob,(In reply to)See, fix is in place for master and backported to 4.2.5.0 builds. Test there and please report under the 77806 issue.*** This bug has been marked as a duplicate of***
id=78489	LO starts normally. After selecting a document to work on it closes randomly. Clicking on the icon afterwards gives no result. The program will not restart.Did a clean install twice. Same result. Please try resetting your user profile and let us know if that helps:Should this be still reproducible for you with the latest LO release please set this bug back to UNCONFIRMED. Should this issue be solved set it to WORKSFORME.Setting to NEEDINFO until more detail is provided.Which windows is this happening on?Windows 8.1Was running v4.2.3.2 previously, no problems.Tried removing the old profile and reinstalling from scratch. Still same problem. Program opens, and then when a document is selected (tried creating a new Writer document), the program immediately closed and would not reopen.reinstalled LO 4.2.3.3 no problems. Program works great.(In reply to)Per, set as WORKSFOEME.
id=79194	Createdsome text and screen shots of the runtime errorProblem description: printing a document o spreadsheet generates a runtime error R6025 and crashes the application. The printing goes out, but partially if there were more than one page.Steps to reproduce:1. Create a document with some text2. Select File Print or the printing button3. Select the any printer installed4. The error apears but the printing goes oCurrent behavior:Printing a document or spreadsheet crashes LO with runtime error R6025Expected behavior:Just print the document or spreadsheet. Operating System: Windows 8Version: 4.3.0.0.beta1Last worked in: 4.2.4.2 release Createdwinxp crash screenshot when printingWhen I was trying to print in Windows XP LibreOffice 4.3 beta 1 crash, then the attached window pop up.However, I do not see the "runtime error R6025", maybe because it's Win XP. So I am marking this as NEW.(In reply to)By the way, the printing process continues, both when it's actual print or "print to file (.PRN)".looks similar to- CRASH printing with all applicationsmaybe a duplicate.the "Runtime error 6025" could be Win8 specificI decided to mark this as a duplicate.see also:you are free to reopen if you believe this is a different bug*** This bug has been marked as a duplicate of***Migrating Whiteboard tags to Keywords: (possibleRegression)[NinjaEdit]
id=79236	1. open a blank writer document2. Type some words3. Select the words and right-click 'edit paragraph style'4. change spacing below paragraph in the 'indents & spacing' tab and press OK5. right-click again on the selected text and click 'paragraph...'6. change spacing below paragraph to zero and press OK7. press undo twice8. LibO crahsesTested on Linux Mint with LibO 4.3 beta 1. Doesnt happen in 4.2.5. ubuntu 14.04 x64LibreOffice 4.3 beta1ConfirmedNewCritical - crasher/loss of dataHighest - regression + not horribly complicated to reproduce - afraid that there might be other ways to trigger the same crash52472371d4cd1e7d386e3780b9e986fcb4ea1da2 is the first bad commitcommit 52472371d4cd1e7d386e3780b9e986fcb4ea1da2Author: Bjoern Michaelsen <>Date: Tue May 20 10:16:41 2014 +0000 source-hash-944c78ecb91608f4c3e9bab32fdbc90c67326525 commit 944c78ecb91608f4c3e9bab32fdbc90c67326525 Author: Andrzej Hunt <> AuthorDate: Fri Apr 25 20:25:48 2014 +0100 Commit: Andrzej Hunt <> CommitDate: Sat Apr 26 08:24:36 2014 +0100 fdo#75489 Pass toolbar context menu commands to toolbar for handling. The toolbar context menu is handled by the toolbar manager, however the items are provided and managed by the toolbar itself -- previously any events on the list of toolbar items in the context menu were silently discarded, whereas now we pass them on to the owning toolbar. Change-Id: Ia17718c3ff8acfba1b6d655022dd9469932f3493:100644 100644 df7df9357f7ca1ecb4a9fb78f23774ae0075025c fa6afcb40a1990b220e346ee12647f81728f2f2b M ccache.log:100644 100644 8186336dc64fc91cff8a087490f54ca1584e4892 a03c81a56c3e0e34002c292723e3ab9cf4abf916 M commitmsg:100644 100644 9b48d132f39b397fc8d692d7daf7bf14e7c4b687 8673fadbb0d3fd57e58689b702c3b99a993cca9e M make.log:040000 040000 ae652e2ca7716809f637e49a6f79ce5f9cb529d1 ec6f85e2f9ba743959b62b182d705f755095f837 M opt# bad: [a92705c1fabafddd43d175a0714855cd22551232] source-hash-c15927f20d4727c3b8de68497b6949e72f9e6e9e# good: [6ab7f53af36f13bbefdd4e4fcbd3d1ea432a77d9] source-hash-22029c7e17b4cb48acb058d47ec9c3b6b8b6b294git bisect start 'latest' 'oldest'# good: [bebf9d31c8fe9de96798484288a0fffc4d54917d] source-hash-09e5de8278dd8f13adcf614db35c8a8a04ba8e47git bisect good bebf9d31c8fe9de96798484288a0fffc4d54917d# good: [fac643700ecfabc737836bbed068776f34037d53] source-hash-40a61d93ade494fa98c23a9fd8776c8dadf8f30fgit bisect good fac643700ecfabc737836bbed068776f34037d53# bad: [44e392733ca46fb0fde9664f8b33ff4da5295caa] source-hash-062e69f40b749aa8a6058c3e6ca328af86aeb45bgit bisect bad 44e392733ca46fb0fde9664f8b33ff4da5295caa# good: [3e370810edadd040e63cef076594a2058603b344] source-hash-ddd4b159531e835539e86f76c56d1013de46a2bdgit bisect good 3e370810edadd040e63cef076594a2058603b344# skip: [c05d75aa2ab2065c8953a1649866074f2e0a75f1] source-hash-28fc951233a58fb4d8515ed4380140aaee0afd32git bisect skip c05d75aa2ab2065c8953a1649866074f2e0a75f1# good: [304c44989cd8e7d5074eeb53ca14c54b3b6e2e16] source-hash-f05861de995f8d4edb1a97c616d050f55ec04c32git bisect good 304c44989cd8e7d5074eeb53ca14c54b3b6e2e16# good: [1fd4b5c55c33b4df5d8b74e00fa49d45cf5927a5] source-hash-9f06e4bc3a56806061f759770f758ad3c7ddf09cgit bisect good 1fd4b5c55c33b4df5d8b74e00fa49d45cf5927a5# skip: [495dc74dce0a63505cc339db9d2ee708f31d1e84] source-hash-4158d8843d50d50e9830c8dc24af8722de77f4afgit bisect skip 495dc74dce0a63505cc339db9d2ee708f31d1e84# good: [ecbd42c0caaeb7db276bb0004a9f6a7133086bb1] source-hash-da1425650b0c3e0921d2c9d51d461aca99038650git bisect good ecbd42c0caaeb7db276bb0004a9f6a7133086bb1# good: [6efa4f17265c3af9378f78bb28570f75c3d88723] source-hash-2e41702ed4f224f195d33054e2e714f546b4442cgit bisect good 6efa4f17265c3af9378f78bb28570f75c3d88723# bad: [52472371d4cd1e7d386e3780b9e986fcb4ea1da2] source-hash-944c78ecb91608f4c3e9bab32fdbc90c67326525git bisect bad 52472371d4cd1e7d386e3780b9e986fcb4ea1da2# first bad commit: [52472371d4cd1e7d386e3780b9e986fcb4ea1da2] source-hash-944c78ecb91608f4c3e9bab32fdbc90c67326525fixed on masterMichael Stahl committed a patch related to this issue.It has been pushed to "master":fdo#79236: sw: Undo of changing style crashes on invalid item (-1)The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-4-3":fdo#79236: sw: Undo of changing style crashes on invalid item (-1)It will be available in LibreOffice 4.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael if you can checkas it seems to be a similar crash due to undo.Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]Xisco Fauli committed a patch related to this issue.It has been pushed to "master":tdf#79236: Add uitestIt will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=79315	CreatedTest caseSteps to reproduce:1. Open attached test case.2. Save as .docx.3. Open again with Word.The exported document will place the picture in a slightly different position.Related to. Repro, tested using windows 8.1 with LibreOffice Version: 4.4.0.0.alpha0+Build ID: a35d92197d850527bd294eb6197b5bf83109d5beTinderBox: Win-x86@39, Branch:master, Time: 2014-05-29_10:21:12Also the image is not completely visible anymore (see attached comparison screenshot).Kind regards,JorenCreatedComparison, original left, roudtripped right** Please read this message in its entirety before responding **To make sure we're focusing on the bugs that affect our users today, LibreOffice QA is asking bug reporters and confirmers to retest open, confirmed bugs which have not been touched for over a year.There have been thousands of bug fixes and commits since anyone checked on this bug report. During that time, it's possible that the bug has been fixed, or the details of the problem have changed. We'd really appreciate your help in getting confirmation that the bug is still present.If you have time, please do the following: Test to see if the bug is still present on a currently supported version of LibreOffice (4.4.3 or later)If the bug is present, please leave a comment that includes the version of LibreOffice and your operating system, and any changes you see in the bug behavior If the bug is NOT present, please set the bug's Status field to RESOLVED-WORKSFORME and leave a short comment that includes your version of LibreOffice and Operating SystemPlease DO NOT Update the version field Reply via email (please reply directly on the bug tracker) Set the bug's Status field to RESOLVED - FIXED (this status has a particular meaning that is not appropriate in this case)If you want to do more to help you can test to see if your issue is a REGRESSION. To do so: 1. Download and install oldest version of LibreOffice (usually 3.3 unless your bug pertains to a feature added after 3.3)2. Test your bug 3. Leave a comment with your results;4a. If the bug was present with 3.3 - set version to "inherited from OOo"; 4b. If the bug was not present in 3.3 - add "regression" to keywordFeel free to come ask questions or to say hello in our QA chat:Thank you for your help!-- The LibreOffice QA Team This NEW Message was generated on: 2015-06-08Now the behavior is different: the exported file cannot be opened with Word 2010. A "damaged file" dialog appears.Now the bug causes loss of data and is always reproducible, so I'm rising the priority.Tested in Linux with LibreOffice Version: 5.0.0.0.alpha1+Build ID: bbdd739d6e2024f57e692e646295644faf44af22Dropping Severity -> critical (we've deprecated the 'blocker' value)** Please read this message in its entirety before responding **To make sure we're focusing on the bugs that affect our users today, LibreOffice QA is asking bug reporters and confirmers to retest open, confirmed bugs which have not been touched for over a year.There have been thousands of bug fixes and commits since anyone checked on this bug report. During that time, it's possible that the bug has been fixed, or the details of the problem have changed. We'd really appreciate your help in getting confirmation that the bug is still present.If you have time, please do the following:Test to see if the bug is still present on a currently supported version of LibreOffice (5.1.6 or 5.2.3If the bug is present, please leave a comment that includes the version of LibreOffice and your operating system, and any changes you see in the bug behavior If the bug is NOT present, please set the bug's Status field to RESOLVED-WORKSFORME and leave a short comment that includes your version of LibreOffice and Operating SystemPlease DO NOTUpdate the version fieldReply via email (please reply directly on the bug tracker)Set the bug's Status field to RESOLVED - FIXED (this status has a particular meaning that is not appropriate in this case)If you want to do more to help you can test to see if your issue is a REGRESSION. To do so:1. Download and install oldest version of LibreOffice (usually 3.3 unless your bug pertains to a feature added after 3.3)2. Test your bug3. Leave a comment with your results.4a. If the bug was present with 3.3 - set version to "inherited from OOo";4b. If the bug was not present in 3.3 - add "regression" to keywordFeel free to come ask questions or to say hello in our QA chat:Thank you for helping us make LibreOffice even better for everyone!Warm Regards,QA TeamMassPing-UntouchedBug-20161108Now the bug behaves like originally reported, there is no data loss. See.Version: 5.1.6.2.0+Build ID: 5.1.6.2-1.fc24CPU Threads: 4; OS Version: Linux 4.8; UI Render: default; Locale: en-US (en_US.UTF-8); Calc: group
id=79392	Windows7-Ultimate, 64bit, LibO 4.2.4.2 releaseWorkflow to reproduce:1. Open .csv file (from attachment)2. position cursor on any NON_EMPTY row (e.g. row 4) and select whole row3. select whole of spreadsheet including and below selected row by pressing CTRL-SHIFT plus "cursor-down"4. delete selected part of sheet by pressing CTRL plus "-"--> crash with error message: "Fatal Error", "block position not found"br, WMPS: minmum version to reproduce:1. create new spreadsheet,2. enter at least 2 cells of data (into cells A1 and A2)3. position on row header of row 2 (selecting whole row)4. press CTRL-Shift + "cursor down" (selects whole sheet starting from row 2)5. press ctrl+"-" to delete--> crash Created.CSV example data filemini file to reproduceSelecting row 1 does NOT crash Calc, selection must start at row > 1 WITH data in itbr, WMConfirmed the crash in Windows XP and Linux Mint with 4.2.4 and 4.3 beta.On a side note, only 4.2.4 has ctrl+shift+down selecting the whole down part, with others versions you have to keep pressing it until it hits a row that has no data in it before it will select the whole rest of it. Must have to do with the selection hitting the last row in Calc.#0 0x00000030ac45f0e1 in __cxa_throw () from /lib64/libstdc++.so.6#1 0x00007f70df510410 in mdds::multi_type_vector<mdds::mtv::custom_block_func3<mdds::mtv::default_element_block<52, svl::SharedString>, mdds::mtv::noncopyable_managed_element_block<53, EditTextObject>, mdds::mtv::noncopyable_managed_element_block<54, ScFormulaCell> > >::get_block_position (this=0x2f23800, pos_hint=..., pos=1048576, start_row=@0x7fff9d346c48: 1048576, block_index=@0x7fff9d346c40: 1) at /home/caolan/LibreOffice/libreoffice-4-2/workdir/UnpackedTarball/mdds/include/mdds/multi_type_vector_def.inl:660#2 0x00007f70df4fb8cf in mdds::multi_type_vector<mdds::mtv::custom_block_func3<mdds::mtv::default_element_block<52, svl::SharedString>, mdds::mtv::noncopyable_managed_element_block<53, EditTextObject>, mdds::mtv::noncopyable_managed_element_block<54, ScFormulaCell> > >::position (this=0x2f23800, pos_hint=..., pos=1048576) at /home/caolan/LibreOffice/libreoffice-4-2/workdir/UnpackedTarball/mdds/include/mdds/multi_type_vector_def.inl:1311#3 0x00007f70df5fcb24 in ScColumn::DeleteRow (this=0x2f23740, nStartRow=3, nSize=1048573) at /home/caolan/LibreOffice/libreoffice-4-2/sc/source/core/data/column3.cxx:239#4 0x00007f70df8a46a4 in ScTable::DeleteRow (this=0x2f23740, rRegroupCols=..., nStartCol=0, nEndCol=1023, nStartRow=3, nSize=1048573, pUndoOutline=0x7fff9d347cad) at /home/caolan/LibreOffice/libreoffice-4-2/sc/source/core/data/table2.cxx:246#5 0x00007f70df6e3101 in ScDocument::DeleteRow (this=0x28a1858, nStartCol=0, nStartTab=0, nEndCol=1023, nEndTab=0, nStartRow=3, nSize=1048573, pRefUndoDoc=0x384b010, pUndoOutline=0x7fff9d347cad, pTabMark=0x7fff9d347b90) at /home/caolan/LibreOffice/libreoffice-4-2/sc/source/core/data/document.cxx:1369#6 0x00007f70dfd65061 in ScDocFunc::DeleteCells (this=0x28a4b40, rRange=..., pTabMark=0x341d360, eCmd=DEL_DELROWS, bRecord=true, bApi=false) at /home/caolan/LibreOffice/libreoffice-4-2/sc/source/ui/docshell/docfunc.cxx:2331#7 0x00007f70e01bdcb7 in ScViewFunc::DeleteCells (this=0x3314bb0, eCmd=DEL_DELROWS, bRecord=true) at /home/caolan/LibreOffice/libreoffice-4-2/sc/source/ui/view/viewfunc.cxx:1537#8 0x00007f70e006252a in ScCellShell::ExecuteEdit (this=0x331e040, rReq=...) at /home/caolan/LibreOffice/libreoffice-4-2/sc/source/ui/view/cellsh1.cxx:288how hard can this spreadsheet hacking be anywayCaolan McNamara committed a patch related to this issue.It has been pushed to "master":Related: fdo#79392 std::out_or_range -> terminateThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: fdo#79392 don't access after last row, when last row is max last rowThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-3":Resolves: fdo#79392 don't access after last row, when last row is max last rowIt will be available in LibreOffice 4.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.fixed in master and 4-3, review on gerrit for 4-2we'll need unit test for this.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-2-5":Resolves: fdo#79392 don't access after last row, when last row is max last rowIt will be available already in LibreOffice 4.2.5.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-2":Resolves: fdo#79392 don't access after last row, when last row is max last rowIt will be available in LibreOffice 4.2.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Migrating Whiteboard tags to Keywords: (bibisectrequest)[NinjaEdit]
id=79552	When I make OpenDocument format and save it to test make sure to supported to KingSoft Office. In fact, this format is not supported to open KingSoft Office. Can you fix it in the next version? CreatedError to open...CreatedOpenDocument SampleIncluding .ods, .odp format also not supported this document formatI used validatorwhich indeed gave:Test document sample.odt/styles.xml[2,4986]: Error: unexpected attribute "style:contextual-spacing"Test document sample.odt/styles.xml[2,5818]: Error: unexpected attribute "style:contextual-spacing"Test document sample.odt/styles.xml[2,6517]: Error: unexpected attribute "style:contextual-spacing"Test document sample.odt/styles.xml[2,7766]: Error: unexpected attribute "style:contextual-spacing"Test document sample.odt/styles.xml[2,8545]: Error: unexpected attribute "style:contextual-spacing"Test document sample.odt/styles.xml[2,8995]: Error: unexpected attribute "style:contextual-spacing"Test document sample.odt/styles.xml[2,9530]: Error: unexpected attribute "style:contextual-spacing"Test document sample.odt/styles.xml[2,10066]: Error: unexpected attribute "style:contextual-spacing"Test document sample.odt/styles.xml: Info: 8 errors, no warningsTest document sample.odt/content.xml[2,3117]: Error: unexpected attribute "style:contextual-spacing"Test document sample.odt/content.xml[2,3389]: Error: unexpected attribute "officeooo:rsid"Miklos: thought you might be interested in this one.I put result ofin my previous comment.(In reply to)@Daniel: I don't understand, if KingSoft Office doesn't support ODF (and it doesn't support at all AFAIK), then why you don't ask KingSoft to add this support? What *we* can do about that?@Julien: About those errors, it's not really a bug, seefor more information.Thank you Maxim for these information.I thought about a problem with KingSoft first but wanted to give a try to a Validator. Just to be complete, what about "officeooo:rsid"? Is it a false positive too?(In reply to)Yes, see. If you go to Tools->Options...->Load/Save->General and choose "1.2" ODF format (not the "Extended"), you won't get this.Thank you again Maxim! :)So let's put this bugtracker at NOTOURBUG
id=79546	This is an OSX specific bug in response to the closure of.How to reproduce :1) Start Impress2) Insert a video file3) Start slideshow displayResult : no video playback, blank screenExpected : video should play and be visible with soundN.B. The video files tested play fine on OSX with either Quicktime, VLC, or MPlayerX, so please don't tell me I need codec xyz... Createdtes avi file plays in mplayerxCreatedwebm fileCreatedMP4 fileCreatedwmv filesee also :Can't add test ogv file, too big at 14Mb, even when compressedCreatedtest ogv fileTests on OSX 10.9.3Master Version: 4.4.0.0.alpha0+Build ID: f961cf50a7bcdcb173aa835db7bd891841947c31ImpressInsert AVI : OKPreview : YesPreview Playback : NothingFullscreen slideshow : nothingOS supports full playback via : MplayerXInsert MP4 : OKPreview : YesPreview Playback : sound onlyFullscreen slideshow : partial sound / dropout, no videoOS supports full playback via : MplayerX / VLC / QuicktimeInsert Webm : okPreview : yesPreview Playback : sound onlyFullscreen slideshow : sound onlyOS supports full playback via : MplayerX / VLCInsert WMV : okPreview : yesPreview Playback : sound onlyFullscreen slideshow : sound onlyOS supports full playback via : MplayerX / VLCInsert ogv : okPreview : yesPreview Playback : sound onlyFullscreen slideshow : sound onlyOS supports full playback via : MplayerX / VLCLibreOffice 3.3.0 OOO330m19 (Build:6)tag libreoffice-3.3.0.4MP4 plays fullscreen with soundno stillno previewAVI doesn't play in fullscreenno stillno previewOther test files not supported for insert (greyed out)Tested 3.3.1, 3.3.2, 3.3.3, 3.3.4 : identical results as to 3.3.0LibreOffice 3.4.2 OOO340m1 (Build:203)Insert AVI : OKPreview : YesPreview Playback : NothingFullscreen slideshow : nothingOS supports full playback via : MplayerXInsert MP4 : OKPreview : NoPreview Playback : sound onlyFullscreen slideshow : yesOS supports full playback via : MplayerX / VLC / QuicktimeLibreOffice 3.4.3 OOO340m1 (Build:302)identical results to 3.4.2LibreOffice 3.4.5 OOO340m1 (Build:502)identical results to 3.4.2LibreOffice 3.5.2.2 Build ID: 281b639-6baa1d3-ef66a77-d866f25-f36d45fwebm, ogv, wmv files now selectable in Finder, but not insertable (file format not supported)avi, mp4 results identical behaviour to previous versionsLibreOffice 3.5.3.2 Build ID: 235ab8a-3802056-4a8fed3-2d66ea8-e241b80webm, ogv, wmv files now selectable in Finder, but not insertable (file format not supported)avi, mp4 results identical behaviour to previous versionsLibreOffice 3.5.4.2 Build ID: 165a79a-7059095-e13bb37-fef39a4-9503d1webm, ogv, wmv files now selectable in Finder, but not insertable (file format not supported)avi, mp4 results identical behaviour to previous versionsLibreOffice 3.5.7.2 Build ID: 3215f89-f603614-ab984f2-7348103-1225a5bwebm, ogv, wmv files now selectable in Finder, but not insertable (file format not supported)avi, mp4 results identical behaviour to previous versionVersion 3.6.3.2 (Build ID: 58f22d5)webm, ogv, wmv files now selectable in Finder, but not insertable (file format not supported)avi, mp4 results identical behaviour to previous versionVersion 3.6.7.2 (Build ID: e183d5b)webm, ogv, wmv files now selectable in Finder, but not insertable (file format not supported)avi, mp4 results identical behaviour to previous versionVersion 4.0.0.0.alpha1+ (Build ID: 8d87128c6bcbac26520a8fef7ae5a6256a82410)ImpressInsert AVI : OKPreview : NoPreview Playback : NothingFullscreen slideshow : nothing, totally blank screenOS supports full playback via : MplayerX MP4 plays fullscreen with soundno stillno previewOther formats not insertable via Finder, greyed outVersion 4.0.5.2 (Build ID: 5464147a081647a250913f19c0715bca595af2f)Insert AVI : OKPreview : NoPreview Playback : NothingFullscreen slideshow : nothing, totally blank screenOS supports full playback via : MplayerX MP4 plays fullscreen with soundno stillno preview, only soundwebm selectable from Finder, but unsupported file formatOther formats not insertable via Finder, greyed outVersion: 4.1.4.2Build ID: 0a0440ccc0227ad9829de5f46be37cfb6edcf72All formats selectable in Finder, only AVI and MP4 insertableMP4 plays fullscreen with soundno stillno video preview, sound audibleAVI doesn't play in fullscreenno stillno previewVersion: 4.2.0.4Build ID: 05dceb5d363845f2cf968344d7adab8dcfb2ba71Formats selectable in Finder, but all fail to be inserted (file format not supported)Version: 4.3.0.0.alpha1+Build ID: c15927f20d4727c3b8de68497b6949e72f9e6e9e--enable-vlc build switchwebm selectable, insertablestill : yespreview play : sound onlyfullscreen play : sound only, white screenavi selectable, insertablestill : yespreview play : nofullscreen play : no, white screenmp4 selectable, insertablestill : yespreview play : sound onlyfullscreen play : sound only, white screenogv selectable, insertablestill : yespreview play : sound onlyfullscreen play : sound only, white screenAnother additional problem when leaving preview or slidescreen display mode is that the mouse cursor disappears completely until you click outside the LO application window. This is particularly annoying :)(In reply to)Fullscreen playback okFullscreen playback okregression over 4.1.4.2 for mp4 playbackNote that the AOO plugin provided for a similar AOO bug looks for AOO 4.1 and so does not install on LO.Further tests :1) Insert test avi2) Preview play3) Fullscreen slideshow play ns1:~ alex$ lldb /Volumes/HD1/Shared/Repos/LO/core/instdir/LibreOfficeDev.app Current executable set to '/Volumes/HD1/Shared/Repos/LO/core/instdir/LibreOfficeDev.app' (x86_64).(lldb) runProcess 27496 launched: '/Volumes/HD1/Shared/Repos/LO/core/instdir/LibreOfficeDev.app/Contents/MacOS/soffice' (x86_64)Warning: option --ffmpeg-threads no longer exists.Warning: option --ffmpeg-threads no longer exists.Warning: option --ffmpeg-threads no longer exists.Warning: option --ffmpeg-threads no longer exists.[0x105911ab0] freetype spu text error: Breaking unbreakable line[0x105911ab0] freetype spu text error: Breaking unbreakable line[0x104ab74b0] freetype spu text error: Breaking unbreakable line[0x104ab74b0] freetype spu text error:4) Add new slide5) Insert webm file6) Preview play7) Fullscreen slideshow playWarning: option --ffmpeg-threads no longer exists.Warning: option --ffmpeg-threads no longer exists.Warning: option --ffmpeg-threads no longer exists.Warning: option --ffmpeg-threads no longer exists.[0x105e30eb0] freetype spu text error: Breaking unbreakable line8) Add new slide9) Insert webm file10) Preview play11) Fullscreen slideshow playWarning: option --ffmpeg-threads no longer exists.Warning: option --ffmpeg-threads no longer exists.[wmv3 @ 0x104e67a00] Extra data: 8 bits left, value: 0[wmv3 @ 0x10593a200] Extra data: 8 bits left, value: 0[wmv3 @ 0x105ac2400] Extra data: 8 bits left, value: 0[0x104a246b0] freetype spu text error: Breaking unbreakable line[wmv3 @ 0x104a18000] Extra data: 8 bits left, value: 0Warning: option --ffmpeg-threads no longer exists.Warning: option --ffmpeg-threads no longer exists.[wmv3 @ 0x104a18000] Extra data: 8 bits left, value: 0[wmv3 @ 0x104af0800] Extra data: 8 bits left, value: 0[0x105a89eb0] freetype spu text error: Breaking unbreakable line[wmv3 @ 0x104df2000] Extra data: 8 bits left, value: 0[wmv3 @ 0x105d69a00] Extra data: 8 bits left, value: 0Warning: option --ffmpeg-threads no longer exists.Warning: option --ffmpeg-threads no longer exists.[0x10480ecb0] freetype spu text error: Breaking unbreakable lineWarning: option --ffmpeg-threads no longer exists.Warning: option --ffmpeg-threads no longer exists.[wmv3 @ 0x105a92a00] Extra data: 8 bits left, value: 0[wmv3 @ 0x105a92a00] Extra data: 8 bits left, value: 0[wmv3 @ 0x105bcd400] Extra data: 8 bits left, value: 0[0x104cf8ab0] freetype spu text error: Breaking unbreakable line[wmv3 @ 0x105d6de00] Extra data: 8 bits left, value: 0[wmv3 @ 0x104aa7a00] Extra data: 8 bits left, value: 01) Insert test ogv2) Preview play3) Fullscreen slideshow playWarning: option --ffmpeg-threads no longer exists.Warning: option --ffmpeg-threads no longer exists.[theora @ 0x104d84400] 7 bits left in packet 82[ogg @ 0x104ddb000] Broken file, keyframe not correctly marked.[theora @ 0x104d84400] 7 bits left in packet 82[ogg @ 0x104ddb000] Broken file, keyframe not correctly marked.[theora @ 0x104ddb000] 7 bits left in packet 82[ogg @ 0x104968e00] Broken file, keyframe not correctly marked.Warning: option --ffmpeg-threads no longer exists.Warning: option --ffmpeg-threads no longer exists.[theora @ 0x105931000] 7 bits left in packet 82[ogg @ 0x1058bce00] Broken file, keyframe not correctly marked.[theora @ 0x105803000] 7 bits left in packet 82[ogg @ 0x1058fd200] Broken file, keyframe not correctly marked.[theora @ 0x104bdf400] 7 bits left in packet 82[ogg @ 0x104b98600] Broken file, keyframe not correctly marked.[theora @ 0x104b98600] 7 bits left in packet 82[ogg @ 0x104bdf400] Broken file, keyframe not correctly marked.1) Insert test mp42) Preview play3) Fullscreen slideshow playWarning: option --ffmpeg-threads no longer exists.Warning: option --ffmpeg-threads no longer exists.[0x104e19cb0] freetype spu text error: Breaking unbreakable line[0x104e19cb0] freetype spu text error: Breaking unbreakable lineWarning: option --ffmpeg-threads no longer exists.Warning: option --ffmpeg-threads no longer exists.[0x105c5c6b0] freetype spu text error: Breaking unbreakable line[0x105c5c6b0] freetype spu text error: Breaking unbreakable line[0x1058dfcb0] freetype spu text error: Breaking unbreakable line[0x1058dfcb0] freetype spu text error: Breaking unbreakable lineCreatedfull backtraceA full backtrace obtained through loading an Impress file containing a slide for each media type and then attempting full screen display of slideshowAdding Michael, Tor for your info - if not interested / available / appropriate, please remove youselves.(This is an automated message.)LibreOffice development currently prioritizes bugs with the so called MAB (most annoying bugs) -- as this bug has not run through that process (including writing a short rationale for this bug being a candidate and other who are watching the tracker bug silently approving that rationale etc.) its priority is set to high. Note this is effectively no change in the urgency assigned to this bug, as we are currently not making a difference between high and highest and severity is untouched.You can find out more about MABs and how the process works by contacting libreoffice qa on irc:The QA wiki page also gives you hints on how to get in contact with the team (if IRC fails you, your next best choice is the mailing list):And regressions () get ignored as no longer being MAB ?I give up. Seriously, what is the point of all the testing if this is the kind of "automated" response that a QAer gets ? When was this decided ?I don't see it in the minutes of the latest dev IRC, merely that a discussion took place.Alex, don't take this personally. I don't think it was done in bad intention.Raising back to "highest" since* broken core functions (or is using videos in presentations not a core functionality?)* happens frequently, 100% of times to be exactso from the flowchart this qualifies as Highest, Blocker.Maybe because it's "only" OSX makes it less bad? Also video usage in presentation is still a major pain on all platforms (linux seems to work a little if you're lucky, while OSX and windows seem to be completely broken. So it would be great of the dev team, to address this core functionality bug.(In reply to)Steve, not taking it personally at all, just a tad narked that yet again, a whole swathe of reports get the automatic whitewash treatment - surely, if the keyword regression is in the report, then the query used to decide whether or not to send out the automatic response is not working properly ?Compare that with the fact that a new feature, introduced in 4.3 development (the OSX toolbar gradient) and which happens to not work as intended gets prioritized to MAB because it is a regression. Either it is a regression because the new development, aimed at and for OSX, screwed up LO on OSX only, as in the present video mess up, or else one takes the view that as it is a newly implemented feature that doesn't work properly, and it shouldn't have made it into the mainstream product (I thought that was what we had the "experimental" setting for). In the latter case, it shouldn't then become a MAB. Anyway, I digress.Does changing the importance back to highest put back the link to MAB, it doesn't appear to have done that. Bjoern's reset appears to have removed this from the MAB list, since the link is no longer referenced.Hi Alex; Wow this is a hugely long bug to read =) I didn't have time to get to the end of it.Any mention of VLC / Mplayer is a red-herring. We tried to integrate with VLC for GSOC, and wrote some code for that, and its a nightmare in its current state.So - I'd say step #1 - check that we're not turning that on in product builds for any platform; it's likely to break stuff.If there is any program/*avmediavlc* library inside the install, can you delete it and see if that fixes things ?Beyond that - I imagine that this is something bisectable if it used to work and now is broken.Looking here on Linux for no reason I understand libavmediavlc.so exists on my system. I guess a simple fix here is to simply turn that off with extreme prejudice.please Mac users, retest with 4.3.x or 4.4.x recent buildsif bug is still present please move this from mab4.2 list to mab4.3 list since 4.2.x reached the end of lifeStill present in 4341 and master 4500 alphaVideo playback with the test files attached to the bug report :MP4 : audio and video playback in Impress preview and fullscreen mode3GP : audio and video playback In Impress preview and fullscreen modeFLV, WEBM, OGV, AVI - unsupported and can not even be inserted into Impress slideCreatedSmall 3GP test fileI tested this with TDF build 4.4.2.2 on OS X 10.9. Maybe it is not perfect, but I did not experience dramatic problems. Video playback worked in slideshow mode for most of the formats. See(In reply to Andras Timar from)In master dev alpha 500, attempting to start slideshow in fullscreen with a MOV video inserted into a slide leads to a reproducible crash.CreatedMPG fileInstead of documenting what does not work. I thought I would say a case that does.I have found that an MPEG file work with both video and audio in presentations, but only if I use the 'link' option rather than embed.Forgot to say that I am using 5.0.1rc2 on Mac OS X 10.10.5@Vossman The best thing to do at the moment is update the following wiki:andOnce the wiki has more data, it will be much easier for devs to prioritize and tackle proper video support in LO.Dropping Severity -> critical (we've deprecated the 'blocker' value)Migrating Whiteboard tags to Keywords: (notBibisectable)For comparison, Keynote 6.6.2 supports insertion of and allows fullscreen playback of :WebM : YESMOV : YESMP4 : YESMKV : YESWith MacOS Sierra 10.12.1 and a recent daily build of LO 5.3.0.0.alpha1+ I can import and play *.mov, *.mpg and *.mp4 files if I drag and drop them from Finder to Impress. Menu -> Insert -> Audio or Video isn't working though.Version: 5.3.0.0.alpha1+Build ID: 6984fd5a756f1e01e94da14f01df5a0e20791630CPU Threads: 4; OS Version: Mac OS X 10.12.1; UI Render: default; Layout Engine: new; TinderBox: MacOSX-x86_64@49-TDF, Branch:master, Time: 2016-11-05_02:01:59Locale: nl-NL (nl_NL.UTF-8); Calc: group
id=79651	While testing,is fine in version prior to 4.2, but with 4.2.4 and 4.3 beta, all 11 pages are flattened to a single page, which will rev up the CPU and pretty much stop LibO from working. This was tested in Linux Mint and Windows XP. Thought this hadnt been reported.*** This bug has been marked as a duplicate of***Migrating Whiteboard tags to Keywords: (bibisectrequest)[NinjaEdit]
id=79818	Createdtest docx fileProblem Description:The attached DOCX file has 5 line breaks (Shift+Enter). After edit-and-save with libreoffice 4.3.0 beta2, 4 line breaks are lost, only 1 is remaining.Steps to reproduce:1. Open the attached test file;2. Do some editing (for example, insert some blank paragraghs below);3. Save the file and reopen.Current behaviour:The 4 line breaks below the first line is lost.Expected:Line breaks should remain the same as it was.Version: 4.3.0 beta 2. (Works OK in 4.2.5.1)OS: Windows XP SP3. Hi suokunlong,I reproduce using LO 4.3.0.0.beta2+Build ID: 4b5975b1f777c85259bc38afbfae8e1160fbebbeTinderBox: Win-x86@42, Branch:libreoffice-4-3, Time: 2014-06-08_21:29:21& Windows 7 Home Premium.I set Status to NEW.Regards,JacquesAdded to MAB4.3 list.it works on master but is broken on libreoffice-4-3 branch... was fixed by:commit 8555c24e069dc00071eaad23c711f1d1375e5afcAuthor: Ravindra Vidhate <>AuthorDate: Wed May 21 14:54:35 2014 +0530 fdo#78887 <w:br> tag is not being preserved after export.*** This bug has been marked as a duplicate of***
id=79641	This is a meta issue to track the most annoying bugs in LibreOffice 4.4.x releases. It helps developers to focus on bugs that are most critical for users. Also it helps users to be aware of potential problems.If anyone wants to raise a bug as “most annoying” for the release, please add the ID of that bug to the field “Depends on”, leave a short description of the bug, and explain in few words why that bug should get privileged, for example:Add bug #XXXXX: Writer ignores page size setting. The default size is Letter. The document format is often broken when printing on A4 paper in Europe.For details, criteria and further instructions, please see adding- crash in extension manager deleting an extension after upgrading itI add- autocorrect slow-down got worseworking with large autocorrect lists in 4.4 master causes long freezes while you type.I add- FILEOPEN: pictures in .xls spreadsheets no longer displayedvery evident regression. may affect lot of users and files.Hereby I nominate "- Crasher in Format:Page... menu item". Mac OSX only so far.Adding"Crash in Format Page"Should add: seems not to be frequent, but it is awfull when one lose many formulaes in a text without any solution !@jmg74this list is reserved to bugs that are specific to the 4.4.x branchthe bug you added is already present in older branches so it does not belong to this list and I'll remove it.if you think that it qualifies as a MAB you should file it to the proper list which is currently mab4.2 (see the link under See Also)Added- regressionData corruption with relatively simple draw objectsAdded- regression + crasherSomething is going on with the interaction with sections and the table of contents where if an entry in the TOC is removed and then you try to export as PDF you get a crash. Native ODF fileAdding"FILESAVE: Crash when save in ODF 1.0/1.1". It is aacrash and a regression (introduced around 2014-07-02).added- FILEOPEN: .DOCX textbox margins incorrectly set in 4.4.xinteroperability regression in 4.4.x (works fine in 4.3.2.2)Added- critical regression.Spreadsheet is not drawing correctly when it loads - resulting in massive black areas on the sheet and inability to use it at all. So far only confirmed with:TinderBox: Win-x86@42.Does not affect: TinderBox: Win-x86@39I add- F11 "Styles and Formatting" not working when sidebar hiddenprobably a side effect of sidebar incorporation of that floating panel in 4.4.xsee:adding- Chapter numbers (Outline numbering) not included in Table of Contents (TOC)Adding- Segmentation fault when I press Ctrl-ZRegression introduced between 4.4.0.0 alpha2 -> beta1 that causes a crash in Draw, Writer, and probably other components if you try to undo changes w/Ctrl-Z when editing macros.Add: Critical regression automatic recalculation formulas and graphicsNominatingfor loss of formatting style--area fill and transparency--of coincident image frames and text frames occurring when an .ODT document is saved and reopened. Causes image in an image frame visible during a Writer edit session to become invisible on reopen.This bug is present in 4.2, 4.3 and 4.4 versions ()@shunesburg69, *,(In reply to shunesburg69 from)Assume you are referring to-- FORMATTING: Fontwork-formatted text is duplicated. That has been added to mab4.3 (). Won't be listed in both mab lists.Added- crasher regression in calc.Insert -> Diagram results in crash.Added- regressionLooks like Hebrew language is completely broken on master - might affect other RTL languages as well.I add- TOOLBAR: Underlined letters in new drop downs not workingaffects new 4.4.x toolbar drop downs like the new color picker, line spacing, and insert tableAdded. Bibisected + Regression + Apparent Data LossComplex sheet shows empty with 4.4 but shows appropriate data in 4.3. Bibisectedadding- UI:Line Numbering. Include header or footer not preserved and has no effect on countingAdded- regressionInability to save basic .doc as odt, worked fine in 4.3, broken on 4.4.Adding- [FILE OPEN/SAVE] field Insert ▸ Field ▸ Page Title not saved / reloadedAdding- CRASH when attempting to add ToC to documentPromoteMath object cannot be seen during slide showAdded- regression + crashPasting a cell that has a comment into a lot of other cells causes a hard freeze. Works fine in 4.3.5, broken in 4.4 beta 2 (and master).AddedSome users are experiencing completely black menus in 4.4adding- FILEOPEN: White Background Appears in Impress Text Boxesvery nasty Impress regression IMHO.adding- Please add UI for new LO 4.4. feature "Text Background Color in Draw"(for now, I think best is to change the feature info on the wiki..)grouped formulas lose listeners when split, recalculation brokenAdd: The style drop-down in Writer is too narrow, causing the edit style button to overlap the style text. This has been introduced in 4.0.Adding: “TOOLBAR: drop downs not having sufficient space on the right and bottom”. It looks horrible under Windows!AddedSign result with a rest between a number and an array is changed.AddingCalc crashes when applying subtotalsAdding: the View page in Settings is crushed because of an overly long checkbox label related to OpenGL, which doesn’t wrap in multiple lines.AddedLibreOffice hangs "Create Report in Design View" in base.When opening on Mac OS X the Finnish version of LibreOffice 4.4., in it's eneral section of Preferences the fourth part "User Interface" and "Graphic Output" collapse partially. In English version these are OK.(In reply to Julehti from)That isalready on this MAB listing.Added- linked images read error, flickering, freezeEvident to some degree in all OS, various hardware.PromotePosition of legend is lost in chart if it is manually placedadding (reopened)FILESAVE loses Fontwork/shape objectsI nominatebecause this regression makes paragraphs with background looking very ugly.Best regards. JBFAdded"Calc: Date decreased by 1 depending on Timezone"Same bug recurrence in 4.4.0.And this bug has been fixed in the master.Please adopt this fix in the next release.Added: Textboxes in charts are not preserving their font size when file is reopened after inital creation. This issue can be worked around by changing the font size and then restoring it back to 12, But very annoying having to do this each time I make a chart for my physics lab reports.Nominated-- Sidebar: incorrect conflicting widget attachment causing graphic artifacts when the sidebar is docked on the left.seems somehow incomplete.adding- Any text placed on a slide is NOT shown when starting the slideshow from that slideEmbarrassing problem for people running presentations on WindowsAdded- regression + bisectedImages embedded in password protected document are lost on saveI nominatewhich breaks PDF export on MacOS-X.Best regards. JBFAdding- FORMATTING, FILESAVE: Header and footer background images are not savedThere have been multiple duplicates of this, so clearly it's causing some painAddingTarget for paste cells from column in Calc into TABLE will be single cell instead of columnAs its a usual operation that people shouldn't put much thought into and works in MSO ().Note that MSO also has more user friendly options to paste from Excel to Word that enables on right click and gives features like this extension does(thankfully an extension works so far even though it can be slow and its been out ages ago) only in more appealing way with preview of what will happen once you choose a paste method. But those are additions currently a bug fix that will enable an easy way to paste from Calc to Writer's table will do way more that those UI changes you're making.Add: This bug causes significant readability issues due to broken kerning depending on window size introduced in 4.4 for OS X users.Apparently our window management of color dialogs doesn't play nice with Elementary OS - already a few dupes marked.Developer from i3 posted some findings that seem on point inAdded- crasher with simple Thai document. Regression, gtbtrace log attached and bibisected.Added- crasher, regression, simple highlight/copy causes crash. BisectedAdded- crasher on sort. Regression in 4.4. BisectedOutline numbering bug in Word docs after re-opening the doc:This bug is very, very, very, very, very, very, very, annoying because chapter numbering is one of the most used features of a Word Processor. And the .doc(x) format is one of the most used in the world. Basically you can NOT use LibO to edit a Word doc in which the chapters are automatically numbered, which is EVERY document ever produced by mankind. Please fix asap if you can.(In reply to meneerjansen00 from)Did you do some good tests, before writing that? I cannot confirm the problem as a general issue. (Would have been unlikely, that such an issue would have gone unnoticed for years.)(In reply to meneerjansen00 from)removedfrom mab4.4 -- assigned toAdding- Saving as .docx adds the outline number, which is not applied, before the header after reopening(In reply to V Stuart Foote from)s///Added- regression + bibisectedSaving a presentation file as pptx strips all hyperlinks from the presentation. It's been around for awhile but seems pretty nasty.: formulas in Writer do not update when adding/deleting last rowSeefor succinct description.adding- Bad-quality antialiasing for PNG images, looks terribly ugly ..CreatedOutline numbering gets restarted every time doc is openedOutline numbering gets restarted every time doc is opened(In reply to Cor Nouws from)Yes this is a general issue. See(). That bug report was opened 2012-06-06. In comment number 8 there the user named Rainer Bielefeld Retired says: "Same effect with AOOo 3.4.1, so seems inherited from OOo.". He also said: "If this is a general problem that is very serious [...]".Reproduce this bug by making a fresh Writer document. Apply outline numbering to Heading 1. Save as .doc or .docx, exit. Reopen. Apply Heading 1 to some text in the middle of doc. Added chapter gets no outline number. After reapplying outline numbering to 'Heading 1' numbering is wrong (i.e. the headings formatted in this "session" get numbers starting from 1). See uploaded example doc.Comment onOutline numbering gets restarted every time doc is openedAttached file contains a doc w/ outline numbering applied to Heading 1. Every time the doc is reopened (which I call a "session") and style 'Heading 1' is applied to some text in the middle of the doc, then that heading gets no number. If one reapplies outline numbering to 'Heading 1' then the outline numbering of the text to which 'Heading 1' was applied in this session restarts at 1.(In reply to meneerjansen00 from)-- "Outline Numbering for DOCX not working when new headings inserted in between", and related-- "FILEOPEN DOC/DOCX: automatic numbering in numbered lists different from Word numbering" are both long present import/export filter issues.Native ODF format of outline numbers are not affected when kept in that format, so while annoying the bugs are not really new nor are they MAB candidates.Also, no need to attach issue specific files to the Metabugs--attachements belong with the individual issues.(In reply to V Stuart Foote from)I take it then that we do not have to count on (work starting on) a fix for this bug to come anytime soon? That will be quite disappointing for a lot of LO users I'm afraid...(In reply to meneerjansen00 from)Not at all, work on the WW8 import/export filters is continual. For example, if you follow the samples and discussion ofthere has been noted improvement. Otherwise, concise test cases with annotated comparisons in the XML of OOXML and ODF rendering of the sample documents will provide needed incentive to devs for correcting the filters. That as opposed to general statements that it is "not working".In general, differences in XML structure--in describing styles and direct formatting--is what goes awry with the filter conversion process. Microsoft handles things "differently" in OOXML to the XML LO composes in ODF. The filters have to resolve the difference--an ongoing development task. The MS .DOC formats are more robust (and less dynamic), but do also have round trip filter issues--just fewer of them.Filing useful bug reports aside, a user can put the onus back on Microsoft and export from there as ODF (e.g. .odt), rather than OOXML (e.g. .docx). Or in a more parochial sense work only in LibreOffice rendered ODF--that is what LibreOffice as a project is obliged to support.(In reply to V Stuart Foote from)I'm afraid I do not see a lot of improvement in that bub. I do see some discussions. But no patch or suggested solution. I'm sorryI'm afraid you lost me there. I'm willing to do anything youy want me to. But I do not understand what y'all would like me to give. Is the example doc not good enough? Can you not reproduce the bug? Please help me to provide you with the proper testing documents. On a side note, the description inis crystal clear to me. And very reproducable. I'm afraid I do not know waht the devs would like more. If I would, I'd provide y'all with what you want in the bug report you want. I'd like to help or provide input, but I really do not know how anymore.commnent #3 is so clear already...In this hard dog eat dog worl I'm afraid the smaller fish has to accept that the bigger fish is boss. Same thing goed for LaTeX (www.latex-project.org) and any other way to produce documents.Best regards, Jansen@V Stuart Foote I'm gonna have to read up on the Office Open XML (OOXML) format/file type (which, confusingly to me, is called .docx in LO), the native Word 2007 (and higher Word versions) file format (also called .docx) and ye 'ol .doc format. This is not to be confused w/ the 'open document file' (ODF) format which, I believe, has been used by Libre- and OpenOffice since a long time. Documents in the ODT format have the extension .odT (with the T from Text, not the D for document) which is also confusing to me (I thought that native LO and 'ye 'ol OOo documents ndend in .odF). I found a nice article about this:Sorry for all this off topic stuff by me that really belongs in a chat or support forum. I'm getting old. Back in the days there was only M$ Word (i.e. .doc) and OpenOffice (which I thought saved in the .odf extension).As for now, what I did to create a document that my Word loving friends can read, edit and save is: 1. Open Libre Office.2. Create new Writer document.3. Write some text.4. Choose: File > Save as > Microsoft Word 97/2000/XP/2003 (.doc). FYI: I used to choose .doc because I thought that .docx was less well supported in OOo/LO... 5. Or I choose: File > Save as > Microsoft Word 2007/2010/2013 XML (.docx)I never even noticed that in LO there's also an option way down at the bottom called "Office Open XML (.docx)". Until today I've never heard of this format. Until today I really couldn't give a rats *ss 'bout M$'s fiddling w/ .doc and .docx format. I just don't care. If people want to use proprietary software and operating systems that's their problem, not mine. Boy was I wrong! I'll try to create an .docx LO (that is Office Open XML, not Microsoft .docx!) document and I'll test if the outline numbering probelm is also there.As for me the question remains how MS Word 2007+ handles OOXML .docx files that were created by LO. Does it leave LO's .docx format intact or not? And how does LO handle M$ created .docx files, does the outline numbering bug appear of doesn't it? To be continued. Hope y'all will forgive me all the confusion I might have created and the overly long comments that posted here. One is never to old to learn. :-)1. Reading the blog that I mentioned earlier is highly recommended for all people who have ever used MS Office '97 to 2003! See:It clarifies why there are two ways of saving a document as .docX!2. Tried to reproduce the bug by making a document in LO and saving it in Office Open OOXML format (i.e. NOT MS's version of OOXML/docX!).3. Bug still there.4. When one saves the document in LO's native open document format (ODF, confusingly ending in .odT) bug is not there.Conclusion: the bug does not have anything to do with Microsoft's crappy implementation of the OOXML standard. The bug has to do w/ the way Libre Office generates a document in the the OPEN document standard OOXML (confusingly also called .docx, not LO's fault, see aforementioned blog).This bug, strangely enough, probably has nothing to do w/. Microsoft!CreatedTwo documets made w/ LO in OOXML format and re-saved as...Two test documents. Both made in LO. One is saved as OOXML (LO's version of OOXML, not MS's version!). The other was made in LO, saved as OOXML (it had the bug) and after that saved as .odT which only made the bug disappear after reapplying ALL outline numbered styles. So using .odt as an intermediate when ou receice a Word doc will not work.(In reply to meneerjansen00 from)No worries, only request is that comments be moved to the affected, or, and not continue on this meta issue tracker :)Its just noise here...Darn it! Posted my last few comments in this MAB instead of the bug report itself! Sorry, sorry, sorry!(In reply to V Stuart Foote from)Copied my last few comments to. Awfully sorry for all the mixes up and the confusion. A moderator might delete my last few comments here, if possible...Added- Long image inserted at the end of page goes beyond margin and over footerThis bug effects NOT ONLY "long" images, but _all images_ embedded in paragraphs near the end of a page."Overlapping" images (over footers and/or below pagemargins) make LO completly useless if you plan to put some images in paragraphs. And using images is not an advanced way to style documents, right?!(Sorry, added this @ MAB4.3 too :/)Hi all,The MAB docs on the wiki have been updated to reflect the newPriority-based system for categorizing bugs:The old MAB tracker bugs (mab4.3, mab4.4, etc.) will remain inBugzilla for historical reference, but should be ignored for currentwork. ......................FINAL mab4.4 STATS......................fixed bugs -> 52open bugs -> 7......................for the record, here is the list of the residual open bugs that I'm going to remove from the "Depends on" field:: Target for paste cells from column in Calc into TABLE will be single cell instead of column: EDITING: Writer TABLE does not update sum when adding or deleting row: DATALOSS: default font size not saved in chart textbox: FILEOPEN: .DOCX textbox margins incorrectly set in 4.4.x: Bad-quality antialiasing for PNG images, looks terribly ugly: TOOLBAR: Underlined letters in new drop downs not working: Sidebar: Undocked sidebar is an unusable size without resizing, doesn't expand automatically I set status to RESOLVED MOVED to reflect the new way to handle Most Annoying Bugs.
id=78477	CreatedTrueType font fileGreetings, I'm using LibreOffice 4.1.4.2 from the backports repository of Debian Linux 7, with some thousand files in my ~/.font directory, which keeps growing up as I'm collecting fonts since a long time ago. It was possible to isolate, via strace, a segmentation fault in libvcllo.so, which prevented LibreOffice from starting at all. Removing from ~/.fonts just a couple of fonts (one is attached here; they seem to belong to the same family) allowed LibreOffice to start flawlessly again. Opening the fonts with gnome-font-viewer allowed to see they're made only of numeric digits and some symbol; which is not expected to cause a segmentation fault anyway. It must be something in the file structure. I'm unsure about the weakness creating this problem, apparently due to some poor handling of bad/unexpected data. If it's located in lower level components used by libvcllo.so, then I shall move the problem to the Debian maintaners for sure. If, however, it is due to LibreOffice itself, solving this problem might even close unconfirmed/unreproduceable situations sharing the same cause; which seems an opportunity too important to ignore. Is anyone capable/willing to test this with other versions of LibreOffice and/or Linux? The test isn't supposed to corrupt your system, if the behavior is the same I experienced then it will be sufficient to remove the offending font to get LibreOffice running again. Thanks. best regards Marcello Is this bug still valid / reproducible with the latest LO release? Currently 4.2.4:Please also try resetting your user profile and let us know if that helps:Should this be still reproducible for you with the latest LO release please set this bug back to UNCONFIRMED. Should this issue be solved set it to WORKSFORME.Setting to NEEDINFO until more detail is provided.(In reply to)Yes. That took more than expected, sorry for the delay.Debian 7 apparently does not allow to remove Libreoffice packages coming from their repository without taking down GNOME3 itself. I had no time to test a mixed setup on that same workstation.The tests continued within a lower priority x86_64 machine, a PearOS6.1 (Ubuntu 12.04 derivative) which was born with an old LO3 so seldom used I couldn't tell when the last time was. A freshly downloaded LO4.2.4.2 (thanks for the direct link) was put in place even before thinking to test LO3 itself. The problem turned to be reproduceable with no differences at all.Analysis details follow.The splash screen with the progress bar will just disappear while the progress bar is still incomplete and nothing more will happen. The segfault is silent, so difficult to detect that one could doubt that an error of such magnitude actually took place. If you launch LO from a terminal window, you will get nothing on stdout nor stderr. Check the dmesg command for the latest system events, and it's there.The output from 'strace -f loffice' will report the open system call for the offending font (the one provided or, supposedly, any other one causing the same effect) just a few lines before the segfault. That was the only hint suggesting to remove the last font accessed by the application.That was not needed, as the old and new version of LO on the test system are different by major release. Removing the two offending fonts (which were already on place, as I periodically rsynced some data from a network share) was sufficient.Now. Thanks for your attention.Really strange one - at first I thought it was a bug with the font but it's a regression. Ubuntu 14.04LibreOffice 4.2.4.2 releaseCritical - crasher but unlikely to affect many users (very specific to this font or some extra fonts, blockers are only for crashers that are affecting a majority of our users)Highest - regressionMost Annoying Bug - think this qualifiesReproducible Steps:Download the font and place it in ~/.fontReconfigure your font cache (Ubuntu this is "sudo dpkg-reconfigure fontconfig")Try running LibreOffice and see the crash every time.1c3f60eb0c69e2de954da5c7fdc8f3c3eda04a3b is the first bad commitcommit 1c3f60eb0c69e2de954da5c7fdc8f3c3eda04a3bAuthor: Bjoern Michaelsen <>Date: Wed Oct 16 03:01:27 2013 +0000 source-hash-8cc6699ade4e1e1b7b00d7034b12c3aec2ed50e9 commit 8cc6699ade4e1e1b7b00d7034b12c3aec2ed50e9 Author: Stephan Bergmann <> AuthorDate: Sat Jan 12 21:36:45 2013 +0100 Commit: Stephan Bergmann <> CommitDate: Mon Jan 14 08:28:29 2013 +0100 -Werror,-Wtautological-constant-out-of-range-compare ...comparing enum eOption with -1 Change-Id: I927b71d1e9988a39ffc1be585ab4bdecfd16b226:100644 100644 7f1a86df8b948ff723ca82a887d466cae6d7cb8e 94706a873e7a411d7a96baab006e561345286a29 M autogen.log:100644 100644 fc98faf560d47ba9c481ff8cc08d376f933cf9f5 1a44913a0415b4611a5400a82e7c42701bc9391f M ccache.log:100644 100644 5a35512fa26ffd691c1d34b9629eb928b9eb2152 bd38fe1e9da5aecb7725279e86229418668769a1 M commitmsg:100644 100644 352e470e5838a9bcd057849455f0f2510509214f 85a49c2f959ada586ba0d87b6035caac1480cb4a M dev-install.log:100644 100644 fbdd784b6ee0bff4b22b2fd5d25d3233f63c0f90 7cb096984bebd622b3d16c82bda011a4c8bf067e M make.log:040000 040000 2dee41feeffa94fc2a13caf9eaabefa1edabcc68 f278976b8e764385e3a8bdcd2741c6a7d4089ef7 M opt# bad: [423a84c4f7068853974887d98442bc2a2d0cc91b] source-hash-c15927f20d4727c3b8de68497b6949e72f9e6e9e# good: [65fd30f5cb4cdd37995a33420ed8273c0a29bf00] source-hash-d6cde02dbce8c28c6af836e2dc1120f8a6ef9932git bisect start 'latest' 'oldest'# bad: [e02439a3d6297a1f5334fa558ddec5ef4212c574] source-hash-6b8393474974d2af7a2cb3c47b3d5c081b550bdbgit bisect bad e02439a3d6297a1f5334fa558ddec5ef4212c574# good: [8f4aeaad2f65d656328a451154142bb82efa4327] source-hash-1885266f274575327cdeee9852945a3e91f32f15git bisect good 8f4aeaad2f65d656328a451154142bb82efa4327# bad: [9995fae0d8a24ce31bcb5e9cd0459b69cfbf7a02] source-hash-8600bc24bbc9029e92bea6102bff2921bc10b33egit bisect bad 9995fae0d8a24ce31bcb5e9cd0459b69cfbf7a02# good: [51b63dca7427db64929ae1885d7cf1cc7eb0ba28] source-hash-806d18ae7b8c241fe90e49d3d370306769c50a10git bisect good 51b63dca7427db64929ae1885d7cf1cc7eb0ba28# good: [d65a58c31c8da044ef66ae4517fa2fe74cec0019] source-hash-2e053cf5ea4d93a2e1845e795a9c7fe1e08c84afgit bisect good d65a58c31c8da044ef66ae4517fa2fe74cec0019# good: [00f5ea8ff23485332a8009f8017ae95cd5f83fa4] source-hash-4ef5ed9d21de767ce1b4c70d73cf15994b38dcdbgit bisect good 00f5ea8ff23485332a8009f8017ae95cd5f83fa4# good: [b9da5d7ef8baf81aa867fc44cb6d8ebb6036201b] source-hash-ec376c2934e77fd1b56da892cfe2c1393f4c8156git bisect good b9da5d7ef8baf81aa867fc44cb6d8ebb6036201b# good: [2432222b43bc847d69313b670fb66f5481c6510e] source-hash-194ba3a2cacbb5438dfcb8fb35167055e01ca251git bisect good 2432222b43bc847d69313b670fb66f5481c6510e# bad: [31bac4fcc40da1e460b132be36dfa002e52919d0] source-hash-d55155cad0926f61b5745260196b93e95471d06agit bisect bad 31bac4fcc40da1e460b132be36dfa002e52919d0# bad: [1c3f60eb0c69e2de954da5c7fdc8f3c3eda04a3b] source-hash-8cc6699ade4e1e1b7b00d7034b12c3aec2ed50e9git bisect bad 1c3f60eb0c69e2de954da5c7fdc8f3c3eda04a3b# first bad commit: [1c3f60eb0c69e2de954da5c7fdc8f3c3eda04a3b] source-hash-8cc6699ade4e1e1b7b00d7034b12c3aec2ed50e9The font is seriously broken, no font tool that I have is able to process it (either crashes or rejects it), namely it seems to have an invalide ‘name’ table. LibreOffice seems to be crashing in psp::PrintFontManager::analyzeTrueTypeFamilyName() (quite expected), but I don’t have a master build to farther debug it.Caolan McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: fdo#78477 ensure offset + sizeof(value) is in boundsThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-3":Resolves: fdo#78477 ensure offset + sizeof(value) is in boundsIt will be available in LibreOffice 4.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.and review avail in gerrit for 4-2Caolan McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-2":Resolves: fdo#78477 ensure offset + sizeof(value) is in boundsIt will be available in LibreOffice 4.2.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=79834	CreatedSample SVGLO 4.3 beta2 takes 2+ times more to open the attached SVG comparing to LO 4.2. Would be great to have a callgrind profile of course;unset MALLOC_CHECK_unset MALLOC_PERTURB_unset G_SLICEexport SAL_DISABLE_FLOATGRAB=1export OOO_EXIT_POST_STARTUP=1export OOO_DISABLE_RECOVERY=1valgrind --tool=callgrind --simulate-cache=yes --dump-instr=yes ./soffice.bin --splash-pipe=0 <file-to-test>is what we'd need I think to chew over [ with debugging symbols of course ].adding keyword regression since this is a regression.CreatedExamples of bitmapsI confirm this bug in Lubuntu-13.10 (Asus EeePC-1015n).Look at an attachment. It's possible that LibO-4.3.0.beta2 incorrectly creates the bitmap.The mistake was born 4 weeks ago.Attempt to insert this SVG file () as image in the text document (Writer-4.3.0.beta2) crashed LO-dev in Windows (XP & Seven). So - critical status of this bug.CreatedODT by Writer-4.3 (Lubuntu)(This is an automated message.)Setting priority to highest as this is a MAB. This is part of an effort to make the importance of MAB reflected in priority too.seeplease verify(In reply to V Stuart Foote from)--OK in LibO Dev_4.3.5.0.0+ (ID: 9a612f1d08eea858111ad5e161dc548c5173250a, TinderBox: Win-x86@51-TDF, Branch:libreoffice-4-3, Time: 2014-11-12_10:22:18); OS - Windows XP 64&32-bit EditionMigrating Whiteboard tags to Keywords: (perf bibisectRequest )[NinjaEdit]
id=79091	Createdthe error message in germanProblem description: As mentioned in the subject title, i can't install libreoffice versions newer than 4.1.3 with the last failed try on versoin 4.2.4I did the checksum test within 7zip but no error occuredSteps to reproduce:1. installation stops when the stup tries to copy some files (at least it is telling me that)Current behavior:I have to stick with version 4.1.3, which is a little bit frustrating, because i want to be up to date.Expected behavior:i just want to install libreoffice Operating System: Windows 7Version: 4.2.4.2 release Could you please check md5/sha checksums of your download?Hello,I installed version 4.3.1.2 without problems on win7. Please, could you test with newer version? Setting bug as needinfo, set as unconfirmed again if problem still occurs in newer version. Thank you.Dear Bug Submitter,This bug has been in NEEDINFO status with no change for at least6 months. Please provide the requested information as soon aspossible and mark the bug as UNCONFIRMED. Due to regular bugtracker maintenance, if the bug is still in NEEDINFO status withno change in 30 days the QA team will close the bug as INVALIDdue to lack of needed information.For more information about our NEEDINFO policy please read thewiki located here:If you have already provided the requested information, pleasemark the bug as UNCONFIRMED so that the QA team knows that thebug is ready to be confirmed. Thank you for helping us make LibreOffice even better for everyone!Warm Regards,QA TeamHad same error upon trying to install 4.3.7 which was originally running. Now have no working LibreOffice!(In reply to Fred W. Bergmann from)Please Download the files again (if you get the error twice, try another download mirror) Confirm the checksum of the filesNever had this problem ever, and I install LibreOffice *every* *new* *release* on at least four Windws machines (from Vista to 8).Please download the files again, check the md5/sha checksums of the downloaded files, and report back. Setting the status as NEEDINFO again.Dear Bug Submitter,Please read this message in its entirety before proceeding.Your bug report is being closed as INVALID due to inactivity anda lack of information which is needed in order to accuratelyreproduce and confirm the problem. We encourage you to retestyour bug against the latest release. If the issue is stillpresent in the latest stable release, we need the followinginformation (please ignore any that you've already provided):a) Provide details of your system including your operating system and the latest version of LibreOffice that you have confirmed the bug to be presentb) Provide easy to reproduce steps – the simpler the betterc) Provide any test case(s) which will help us confirm the problemd) Provide screenshots of the problem if you think it might helpe) Read all comments and provide any requested informationOnce all of this is done, please set the bug back to UNCONFIRMEDand we will attempt to reproduce the issue. Please do not:a) respond via email b) update the version field in the bug or any of the other details on the top section of our bug tracker-- The LibreOffice QA Team This INVALID Message was generated on: 2015-05-06Warm Regards,QA TeamI tried to install the latest version 5.0.1 even downloaded multiple times from different mirrors but gives the same error. I even tried to install still version 4.4.5 but same error arises.Installation failure with error code 1335, problem with libroffice1.cabstatus NEW because of confirmation by another user in the previous commentI also revert status to 4.2.4 which is the earliest version the bug was reproduced
id=79113	I have uninstalled libreoffice 4.1.6.2, I have removed libreoffice folders from program files, I have removed libreoffice folder from user's application data and installed libreoffice 4.3.0 beta1. If I open a libreoffice program and I try to write something LO crashes. Furthermore if I don't write nothing but I access to the Tools->options menu and if I click on the Language settings->languages item LO crashes as well.:(Operating System: Windows XPVersion: 4.3.0.0.beta1 Could you please try to get a backtrace following the instructions on?It crashing after typing something is related to the auto spell check issue mentioned in.i can confirm (Win XP SP3, LibO 4.3 beta1) it crashes after visiting language settings -> languages in tools -> options.The first issue reported is a duplicate ofThe second issue is currently being checked out.In the future please report 1 bug per issue. Thanks!This IS the same Python 3.3.3 related issue of. See that bug for work around to allow continued testing on Windows XP.*** This bug has been marked as a duplicate of***beta1 builds for windows onhave been replaced with a fixed version if the problem still occurs after deinstalling the old beta and reinstalling the fixed one, please reopen this issue.
id=80025	Description:When I open a ODB file which uses thunderbird address book as its data source, viewing or editing a table will make libreoffice crash. Steps to reproduce:1. Start Base.2. In the databse wizard window, choose "connect to an existing database: Thunderbird/Icedove address book", next;3. In the next window, choose "do not register the databse" and "open the database for editing", click "Finish", then choose a location and filename to save the odb file;4. In the database window, click "Tables", then either: * Double-click any of the two tables, or * Right-click->EditCurrent Behaviour:LibreOffice Base crashes.Expected:LibreOffice do not crash, and allow me to edit or view the tables.OS: Ubuntu 14.04 x86Reproducible with Version: 4.3.0.0.beta2, Build ID: a06aa316117a6ff0f05c697c82831c227812d810Do not reproduce with Version 4.2.5.2, Build ID: 61cb170a04bb1f12e77c884eab9192be736ec5f5JRE Version:$ dpkg -l | grep "jre"ii icedtea-7-jre-jamvm:i386 7u55-2.4.7-1ubuntu1 i386 Alternative JVM for OpenJDK, using JamVMii openjdk-7-jre:i386 7u55-2.4.7-1ubuntu1 i386 OpenJDK Java runtime, using Hotspot JITii openjdk-7-jre-headless:i386 7u55-2.4.7-1ubuntu1 i386 OpenJDK Java runtime, using Hotspot JIT (headless) Reproduced on openSUSE with 4.3.0.0.beta1 and 4.3.0.0.beta2.4.2.4.2 does not crash.Changing Status to NEW and updating affected LibreOffice Version.Julien Nabet committed a patch related to this issue.It has been pushed to "master":Resolves: fdo#80025 Crash with Thunderbird/Icedove address bookThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.My fault here.gerrit for 4.3:Julien Nabet committed a patch related to this issue.It has been pushed to "libreoffice-4-3":Resolves: fdo#80025 Crash with Thunderbird/Icedove address bookIt will be available in LibreOffice 4.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Thanks to Thomas' review, let's put this one to FIXED.
id=80009	CreatedSingle page that causes the crashProblem description: Page crashed with little orange iconSteps to reproduce:1. Open the attached and scroll over pageCurrent behavior: It crashesExpected behavior: It shouldnt Operating System: UbuntuVersion: 4.2.3.3 release Confirmed on Linux Mint that it crashes 4.2.4, 4.2.6, and 4.4 alpha. In 4.3, it doesnt crash, but the page is not viewable though the left scrollbar works. Opens successfully in 4.1.6.Createddialog appears with an 'OK' buttonOnce you press the OK button, libreoffice shuts down.8aabf2aee6514311020b855a95a6e44bab3a5b0d is the first bad commitcommit 8aabf2aee6514311020b855a95a6e44bab3a5b0dAuthor: Bjoern Michaelsen <>Date: Wed Nov 27 09:32:23 2013 +0000 source-hash-0aa9ced531b8d85ad067c1d156a9708eea628d78 commit 0aa9ced531b8d85ad067c1d156a9708eea628d78 Author: Tor Lillqvist <> AuthorDate: Wed Nov 6 00:43:06 2013 +0200 Commit: Tor Lillqvist <> CommitDate: Wed Nov 6 00:44:28 2013 +0200 It's types.rdb now, not udkapi.rdb any more Change-Id: If6e8c4862ec628eb4c052e0fd237f5aef89db8eb:100644 100644 ce5cd8dc3c3a6fdc22ae8e4f63897ab07254eddb 867d2798c91ad285850e29c0e8d0f40548dff4fb M ccache.log:100644 100644 405359894d6958b64eb7f2beb6f8a48550779f95 e461af99260d551289a2dd1f188119438cf1fc19 M commitmsg:100644 100644 0c7b842ac949f66eaa350d1ac25b0d6ccc407841 ab6adaea7a96b5d6d10dda3f10504fd1f005cfcf M make.log:040000 040000 216184b3333359e5a1395b47d1551dd3b61d2f04 d765efa8f9bd443222a2a557954f9dd4997fd3e7 M opt# bad: [423a84c4f7068853974887d98442bc2a2d0cc91b] source-hash-c15927f20d4727c3b8de68497b6949e72f9e6e9e# good: [65fd30f5cb4cdd37995a33420ed8273c0a29bf00] source-hash-d6cde02dbce8c28c6af836e2dc1120f8a6ef9932git bisect start 'latest' 'oldest'# good: [e02439a3d6297a1f5334fa558ddec5ef4212c574] source-hash-6b8393474974d2af7a2cb3c47b3d5c081b550bdbgit bisect good e02439a3d6297a1f5334fa558ddec5ef4212c574# bad: [4850941efe43ae800be5c76e1102ab80ac2c085d] source-hash-980a6e552502f02f12c15bfb1c9f8e6269499f4bgit bisect bad 4850941efe43ae800be5c76e1102ab80ac2c085d# skip: [a043626b542eb8314218d7439534dce2fc325304] source-hash-9379a922c07df3cdb7d567cc88dfaaa39ead3681git bisect skip a043626b542eb8314218d7439534dce2fc325304# skip: [aba65c3e4c0df07e4909aeefb758cdb688242bf6] source-hash-827524abfb4b577d08276fde40929a9adfb7ff1agit bisect skip aba65c3e4c0df07e4909aeefb758cdb688242bf6# skip: [aba65c3e4c0df07e4909aeefb758cdb688242bf6] source-hash-827524abfb4b577d08276fde40929a9adfb7ff1agit bisect skip aba65c3e4c0df07e4909aeefb758cdb688242bf6# bad: [c81a8a0dcfc1ed095a80e4485c89dd0fcaf73f31] source-hash-c69ed33628ec0b7abf6296539cf280d6c4265930git bisect bad c81a8a0dcfc1ed095a80e4485c89dd0fcaf73f31# bad: [c81a8a0dcfc1ed095a80e4485c89dd0fcaf73f31] source-hash-c69ed33628ec0b7abf6296539cf280d6c4265930git bisect bad c81a8a0dcfc1ed095a80e4485c89dd0fcaf73f31# good: [1d4980621741d3050a5fe61b247c157d769988f2] source-hash-89d01a7d8028ddb765e02c116d202a2435894217git bisect good 1d4980621741d3050a5fe61b247c157d769988f2# skip: [89110ca258fa7a15dfc546acfb39e76fc3eb2a44] source-hash-e450a2c506ac7cd4433b0f93fc750a89919bc03cgit bisect skip 89110ca258fa7a15dfc546acfb39e76fc3eb2a44# good: [1cca92a409385d9288c28a54d5e3008e56728bc0] source-hash-7be7824bbbdeee6fa998b950e6046ab37fe690cbgit bisect good 1cca92a409385d9288c28a54d5e3008e56728bc0# skip: [5fa28ce2931a35ae64ae08d3904cfb76d24459d8] source-hash-2304beaca33c63b94df99cb827716f00ce259f9agit bisect skip 5fa28ce2931a35ae64ae08d3904cfb76d24459d8# good: [2a9ff869c5638dc5c3aa387d0fe55c3291c86288] source-hash-01b7e04172889cbc9e4ac404b105e18ddc062d6fgit bisect good 2a9ff869c5638dc5c3aa387d0fe55c3291c86288# good: [387dd1052972d27a3065a249b357e50e0a29829b] source-hash-35836f350861b33a0c28307a413eff76d0433d1egit bisect good 387dd1052972d27a3065a249b357e50e0a29829b# good: [387dd1052972d27a3065a249b357e50e0a29829b] source-hash-35836f350861b33a0c28307a413eff76d0433d1egit bisect good 387dd1052972d27a3065a249b357e50e0a29829b# good: [09fe6d4400fefeaa099d0deb9b77c77992ab897b] source-hash-56364430108893afbcf5d2b51c5aaa37e393e7ccgit bisect good 09fe6d4400fefeaa099d0deb9b77c77992ab897b# good: [09fe6d4400fefeaa099d0deb9b77c77992ab897b] source-hash-56364430108893afbcf5d2b51c5aaa37e393e7ccgit bisect good 09fe6d4400fefeaa099d0deb9b77c77992ab897b# bad: [8aabf2aee6514311020b855a95a6e44bab3a5b0d] source-hash-0aa9ced531b8d85ad067c1d156a9708eea628d78git bisect bad 8aabf2aee6514311020b855a95a6e44bab3a5b0d# bad: [8aabf2aee6514311020b855a95a6e44bab3a5b0d] source-hash-0aa9ced531b8d85ad067c1d156a9708eea628d78git bisect bad 8aabf2aee6514311020b855a95a6e44bab3a5b0d# good: [11ac44b0fb233f1f98e2f083598f6720a04e457f] source-hash-3c01203ea657b9a3538f9956591b3d4da5fce6e7git bisect good 11ac44b0fb233f1f98e2f083598f6720a04e457f# first bad commit: [8aabf2aee6514311020b855a95a6e44bab3a5b0d] source-hash-0aa9ced531b8d85ad067c1d156a9708eea628d78It is strange: if you open the file with LO 4.0 and show the non-printable characters, LO 4.0 find 2 empty paragraphs more than LO 4.1 at the end of the document.In LO 4.1 ctrl+A (Select All) does nothing, but it works in LO 4.0In LO 4.0 ctrl+A then delete then save under another name --> the new file opens fine in LO 4.2.6.0+ you see only the first numbering (1.1) but the word count in the status bar says 29 words, 166 characters. I do not see any text in the content.xml file of the .odt archive.I think that something went wrong when the original MS-Word file has been converted into ODF but LO should'nt crash.Best regards. JBFHi Diarmuid,Was the file originally a ms word document? And if so, can you provide us with that file.the reason is the image which has ridiculous 5 kilometer clipping area: fo:clip="rect(531404.655cm, 0cm, 0cm, 0cm)"that causes some overflow in drawing layer, a rectangle withnegative height, an IllegalArgumentException that is not handled,and then a crash...it's of course also triggered by our good friend commit 2e51675so this is related to, presumably the documentwas a WW8 doc that has been converted to ODF?looks like we need some cut-off value there too...fixed on masterMichael Stahl committed a patch related to this issue.It has been pushed to "master":fdo#80009: xmloff: ignore excessive fo:clip valuesThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-4-3":fdo#80009: xmloff: ignore excessive fo:clip valuesIt will be available in LibreOffice 4.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#80009: xmloff: ignore excessive fo:clip valuesIt will be available in LibreOffice 4.2.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=80139	Createdtest case odp fileDescription:When I was testing Moztrap case #40, I found that spell check does not work in Impress odp file anymore.Steps to reproduce:1. Open the attached odp file;2. Press F7 in your keyboard.Current Behaviour:"Spelling and Grammar: [Language]" window does not pop up. (Actually it pops up, but vanished immediately)Expected Behaviour:"Spelling and Grammar: [Language]" window pops up, and allow me to "change" and "ignore" the spelling errors.OS: Ubuntu 14.04 X86Version: 4.3.0.0.beta2Build ID: a06aa316117a6ff0f05c697c82831c227812d810It works OK in 4.2.5.2, so it's a regression in 4.3.0.0 beta2.Note: Another bug behaviour I have found: When change the language of the test file to English-USA, then put your mouse cursor in one of the text box and press F7, the "Spellcheck of entire document has been completed." dialog pops up but can not be closed anymore, you have to kill the soffice.bin process.(I will report a saparate bug for this behaviour.) Addedto "see also".Hi suokunlong, Here, I don't reproduce. F7 opens Spelling and Grammar but give the same behaviour than in your other report(80140).Have a nice day,JacquesConfirmed on Impress AND Draw with LibreOffice:* Version: 4.3.0.0.beta2* Build ID: a06aa316117a6ff0f05c697c82831c227812d810* OS Ubuntu 14.04 x86_64----* Changed arch to All because both x86 and x86_64 are affected.* Added MAB 4.3* importance: ----highest -> this is a MAB----critical -> can't use spellcheckCreatedstrace log with empty new documentstrace log with empty new document.Createdstrace log with proposed test documentstrace log with proposed test documentSamme fundamental problem as 80140 apparently, seems to work now anyway*** This bug has been marked as a duplicate of***
id=80292	Steps:1. Start LibreOffice;2. File - New - HTML Document;3. Table - Insert - Table: 8 rows 8 columnsCurrent Result:It always insert a table with only one column.Reproduce with: 4.2.5.2, 4.3.0.1Ubuntu 14.04 x86Functionality broken -> Blocker Well...I assume few people uses libreoffice to design HTML document, so I lower it to CRITICAL.HiI'm not sure: have you show displayed the non printing characters?You will see the columns (not table columns).Tested on windows 7/64 & Version: 4.2.5.1Build ID: 881bb88abfe2992c6cede97c23e64a9885de87deVersion: 4.3.0.1Build ID: 67f5430184326974072b65403ef1d9d934fc4481RegardsPierre-YvesCreatedbt console from master sourcesOn pc Debian x86-64 with master sources updated today (+ enable-dbg), I had a crash.I don't know if it's related but thought it might be interested because we can see console logs like these:warn:vcl.layout:9616:1:vcl/source/window/builder.cxx:1598: probably need to implement swlo-TableNameEdit or add a makeswlo-TableNameEdit functionwarn:vcl:9616:1:vcl/source/window/builder.cxx:212: missing either source label3 or target nameedit member of Mnemonic Widget Mappingwarn:vcl.layout:9616:1:include/vcl/builder.hxx:268: widget "nameedit" not found in .uiwarn:vcl.layout:9616:1:include/vcl/builder.hxx:270: .ui widget "nameedit" needs to correspond to vcl type 4EditCaolán: one for you? (I attached bt which shows a vcl part)(If needed, I can create a separate bugtracker)(In reply to)Hi pierre-yves, thanks for you info, I checked again, and I see that:When I insert a 8*8 table, there are really 8 columns, the only porblem is that the columns have no right and left borders applied, so they look like one-column.When I save the HTML document with 8*8 table and view HTML source, I see the following for each <td> tag:<td width="13%" ... border-right: none;...>So maybe the "border-right: none" caused the problem.When you insert a table, it should never by default to set top-bottom borders to not-none but left-right borders to none.So maybe I should close this one as WORKSFORME, and open another report on table border issue?Createdan HTML document with 8*8 table created with LibreOfficeThis HTML document was created with libreoffice 4.3.0.1. (File - New - HTML Document)The table was inserted by "Table - Insert - Table".Hi(In reply to)Perhaps? Sorry, I do not know enough html to provide proper noticeRegardsPierre-YvesI closed this bug and filed a new bug:- HTML Document: Insert Table always insert a table with no right and left border
id=80384	Chart Legend lost on saving.Step to create .1. In Writer, specify the Legend using chart data table.2. Save & reopen one legend is lost.3. If again save & reopen, next legend also lost. Createdorginal chartCreatedOn reopen first timeCreatedOn reopen second timeCreatedsample documentJaise, please see. Does it appear with 100% transparency?I reproduce with version 4.3.0.1 and 4.2.5.2.Steps to reproduce:1. Open, double-click the chart so that you can edit it;2. "Right-click -> Chart Data Table";3. Input "aaa" and "bbb" for the first and second Y values, respectively.4. Click somewhere else of the page, then save the file.5. Reopen.Current Behaviour:You only see "aaa" in the legend names. Redo step 2 you will find that legend name for 1st Y value is now empty, while "aaa" has gone to the 2nd Y value.Set to NEW.Set version to 4.2.5.2.Legend name loss = Dataloss. -> Highest Critical.This bug does look like a dupe ofto me.Also as noted onby Kohei::If I create a new sample document using 4.3.0.2 or older (I did test an own build Linux Mint 17 x64 Version: 4.4.0.0.alpha0+ Build ID: 25b18c6fe055035a1d5f835cf178acd55a585811) I can not reproduce the issue anymore.Kind regards,Joren*** This bug has been marked as a duplicate of***Chart created by Libreoffice old versions not having legends. Sample screen shot attachedCreatedlibreoffice 4.2 chartCreatedlibreoffice 4.3 rc3 chartHow can I recover the charts saved in old version*** This bug has been marked as a duplicate of***
id=80392	Createdthe gdb "bt full" traceWe use Open/Libreoffice since 2006 and we love it! (I had to use MS Word since version 6, so I really love it)But now I am facing a issue, there I cannot find a workaround.I have a document, with a lot of changes tracking a lot of comments on authoring and also some images. The doc is 14 pages long.If I try to insert a heading or sometimes only a text on a specific place in the doc, libreoffice is running into a loop an beginns to count page numbers. I killed it with the doc size of 15.000 pages, since the application was unresponsive.I created a gdb file, which hopefully will help.best wishes,hkaisOperating System: AllVersion: 4.2.3.3 release Hi Hkais,I would recommend you upgrade to 4.2.4 or 4.2.5 and see if that helps.problem still exists on windows, linux and also on the current version 4.2.5.2reverted back to ubuntu managed version of libreofficesince I was not sure, I have opened a new bug.which happens now on the same docand maybe it is correlated toHello Hkais,Is it possible for you to share the document with us and provide us steps for us to reproduce it.Hello Jay,see alsoI cannot provide you the doc with the details right now. How can we workaround the issue? (I could create a dev environment, if it helps, but would need some support on it)As you see I have managed to provide stacktraces, so I think I could provide also more details on the errors, if someone hepls me.Hi Hkais,Is it possible for you to check earlier versions of libreoffice, which you can open the document with and scramble its contents without it crashing, so that you can provide us with a sample document.You can find portable of old versions at these linksSetting this to NEW as it as a backtrace that devs can look at and i had set to to NeedAdvice.CreatedOriginal file, wich, If I open in Document writer, go on endless page creation loopWhen I open that document in .docx, or I convert it to .odt, the document go to endless page creation.Thanks for your help on that strange case.Migrating Whiteboard tags to Keywords: (needAdvice)I can't repro this in LibreOffice 5.1 with the sample file, either by adding headings and typing text, or by saving to ODT.Can you please try again with the latest version and if it still happens, try to give any more guidance on how to repro?So openingin master and the endless page counting happens without me doing any editing and it reached over 2 thousand pages before i closed the document when the document only has 56 pages and all during that time its eating 80+ percent of my cpu.In earlier versions, like the OP mentioned, once you start editing the document (i was adding page breaks on radom pages), the endless page counting happens and if it doesnt happen, attempt to go to the last page of the document and you'll see it start then. I can reproduce this in 3.3.0, so its inherited.Something is majorly broken with this.Version: 5.2.0.0.alpha0+Build ID: 31e037c348ef0e04393926891617fde1b0051a35CPU Threads: 2; OS Version: Linux 4.2; UI Render: default; TinderBox: Linux-rpm_deb-x86@71-TDF, Branch:master, Time: 2016-03-04_00:22:37Locale: en-US (en_US.UTF-8)Interesting; I can get to the bottom of the document with ctrl-end after load - but clicking into the document there gives me a hang:Thread 1 (Thread 0x7f0b252bf9c0 (LWP 25053)):#0 0x00007f0afa4a9a02 in SwCacheObj::GetPrev() (this=0x5005790) at /data/opt/libreoffice/master/sw/source/core/inc/swcache.hxx:147#1 0x00007f0afa4a7b04 in SwCache::Check() (this=0x28064a0) at /data/opt/libreoffice/master/sw/source/core/bastyp/swcache.cxx:45#2 0x00007f0afa4a9017 in SwCache::Insert(SwCacheObj*) (this=0x28064a0, pNew=0x4fd7e90) at /data/opt/libreoffice/master/sw/source/core/bastyp/swcache.cxx:334#3 0x00007f0afa4a9932 in SwCacheAccess::_Get() (this=0x7ffd65184520) at /data/opt/libreoffice/master/sw/source/core/bastyp/swcache.cxx:462#4 0x00007f0afa9329c3 in SwCacheAccess::Get() (this=0x7ffd65184520) at /data/opt/libreoffice/master/sw/source/core/inc/swcache.hxx:266#5 0x00007f0afaadfc54 in SwTextLineAccess::GetPara() (this=0x7ffd65184520) at /data/opt/libreoffice/master/sw/source/core/text/txtcache.cxx:47#6 0x00007f0afaa7407a in SwTextFrame::Format(OutputDevice*, SwBorderAttrs const*) (this=0x509f930, pRenderContext=0x2b50c80) at /data/opt/libreoffice/master/sw/source/core/text/frmform.cxx:1807#7 0x00007f0afa8f6c5d in SwContentFrame::MakeAll(OutputDevice*) (this=0x509f930) at /data/opt/libreoffice/master/sw/source/core/layout/calcmove.cxx:1392 ... this frame never completes [!] ...#8 0x00007f0afa8f137d in SwFrame::PrepareMake(OutputDevice*) (this=0x509f930, pRenderContext=0x2b50c80) at /data/opt/libreoffice/master/sw/source/core/layout/calcmove.cxx:341#9 0x00007f0afa9db773 in SwFrame::Calc(OutputDevice*) const (this=0x509f930, pRenderContext=0x2b50c80) at /data/opt/libreoffice/master/sw/source/core/layout/trvlfrm.cxx:1799#10 0x00007f0afa94299f in SwHeadFootFrame::FormatSize(long, SwBorderAttrs const*) (this=0x5090ea0, nUL=674, pAttrs=0x4942580) at /data/opt/libreoffice/master/sw/source/core/layout/hffrm.cxx:253#11 0x00007f0afa943298 in SwHeadFootFrame::Format(OutputDevice*, SwBorderAttrs const*) (this=0x5090ea0, pRenderContext=0x2b50c80, pAttrs=0x4942580) at /data/opt/libreoffice/master/sw/source/core/layout/hffrm.cxx:418#12 0x00007f0afa8f4317 in SwLayoutFrame::MakeAll(OutputDevice*) (this=0x5090ea0) at /data/opt/libreoffice/master/sw/source/core/layout/calcmove.cxx:909#13 0x00007f0afa8f137d in SwFrame::PrepareMake(OutputDevice*) (this=0x5090ea0, pRenderContext=0x2b50c80) at /data/opt/libreoffice/master/sw/source/core/layout/calcmove.cxx:341#14 0x00007f0afa9db773 in SwFrame::Calc(OutputDevice*) const (this=0x5090ea0, pRenderContext=0x2b50c80) at /data/opt/libreoffice/master/sw/source/core/layout/trvlfrm.cxx:1799#15 0x00007f0afa96c045 in lcl_FormatLay(SwLayoutFrame*) (pLay=0x5090ea0) at /data/opt/libreoffice/master/sw/source/core/layout/pagechg.cxx:357#16 0x00007f0afa96c010 in lcl_FormatLay(SwLayoutFrame*) (pLay=0x508df80) at /data/opt/libreoffice/master/sw/source/core/layout/pagechg.cxx:354#17 0x00007f0afa96c4e3 in SwPageFrame::PreparePage(bool) (this=0x508df80, bFootnote=false) at /data/opt/libreoffice/master/sw/source/core/layout/pagechg.cxx:453#18 0x00007f0afa96edb8 in SwFrame::InsertPage(SwPageFrame*, bool) (this=0x50a73d0, pPrevPage=0x50a4f50, bFootnote=false) at /data/opt/libreoffice/master/sw/source/core/layout/pagechg.cxx:1226#19 0x00007f0afa9099be in SwFrame::GetNextLeaf(MakePageType) (this=0x50a73d0, eMakePage=MAKEPAGE_INSERT) at /data/opt/libreoffice/master/sw/source/core/layout/flowfrm.cxx:983#20 0x00007f0afa90928e in SwFrame::GetLeaf(MakePageType, bool) (this=0x50a73d0, eMakePage=MAKEPAGE_INSERT, bFwd=true) at /data/opt/libreoffice/master/sw/source/core/layout/flowfrm.cxx:793#21 0x00007f0afa90c17e in SwFlowFrame::MoveFwd(bool, bool, bool) (this=0x50a7478, bMakePage=true, bPageBreak=false, bMoveAlways=false) at /data/opt/libreoffice/master/sw/source/core/layout/flowfrm.cxx:1839#22 0x00007f0afa8f5c8f in SwContentFrame::MakeAll(OutputDevice*) (this=0x50a73d0) at /data/opt/libreoffice/master/sw/source/core/layout/calcmove.cxx:1225#23 0x00007f0afa8f1945 in SwFrame::PrepareCursor() (this=0x2fcccf0) at /data/opt/libreoffice/master/sw/source/core/layout/calcmove.cxx:416#24 0x00007f0afa4d77a2 in SwCursorShell::UpdateCursor(unsigned short, bool) (this=0x2ed1d80, eFlags=6, bIdleEnd=false) at /data/opt/libreoffice/master/sw/source/core/crsr/crsrsh.cxx:1716#25 0x00007f0afa4d0dd6 in SwCursorShell::EndAction(bool, bool) (this=0x2ed1d80, bIdleEnd=false, DoSetPosX=true) at /data/opt/libreoffice/master/sw/source/core/crsr/crsrsh.cxx:294#26 0x00007f0afa4d1023 in SwCursorShell::EndCursorMove(bool) (this=0x2ed1d80, bIdleEnd=false) at /data/opt/libreoffice/master/sw/source/core/crsr/crsrsh.cxx:330#27 0x00007f0afa94cae2 in SwLayIdle::SwLayIdle(SwRootFrame*, SwViewShellImp*) (this=0x7ffd65185f90, pRt=0x2a8f8a0, pI=0x29f5eb0) at /data/opt/libreoffice/master/sw/source/core/layout/layact.cxx:2229#28 0x00007f0afadfa8ac in SwViewShell::LayoutIdle() (this=0x2ed1d80) at /data/opt/libreoffice/master/sw/source/core/view/viewsh.cxx:719#29 0x00007f0afa66e700 in sw::DocumentTimerManager::DoIdleJobs(Idle*) (this=0x2878a70, pIdle=0x2878a88) at /data/opt/libreoffice/master/sw/source/core/doc/DocumentTimerManager.cxx:119#30 0x00007f0afa66e43b in sw::DocumentTimerManager::LinkStubDoIdleJobs(void*, Idle*) (instance=0x2878a70, data=0x2878a88) at /data/opt/libreoffice/master/sw/source/core/doc/DocumentTimerManager.cxx:81#31 0x00007f0b1c8fbcff in Link<Idle*, void>::Call(Idle*) const (this=0x2878aa8, data=0x2878a88) at /data/opt/libreoffice/master/include/tools/link.hxx:84#32 0x00007f0b1ce4b929 in Idle::Invoke() (this=0x2878a88) at /data/opt/libreoffice/master/vcl/source/app/idle.cxx:25Really though - I'm not writer expert; what advice can I give ? there is some bug specific to this document; and it'd be great to fix it. Un-CC'ing =)@Oliver: Samuel suggested i add you here. :D'needsConfirmationAdvise' is only used for unconfirmed bugs. Removing it from this bug.[NinjaEdit]I've already seen the bt provided by Michael (see) in other bugs.It should be good to list them all and put them in "See also" but, obviously, fixing this tough one may help in quite some bugs.Createdshorter reproducercut this down to a 3 page document which reproduces the problem
id=80813	Spreadsheet appears to open and display properly, but immediately crashes. System is unable to recover it. Further, the crash scenario also occurs when formulae are copied from the old spreadsheet and pasted into the 4.2.5.2 version. This is being experienced with the portable version of Calc. Hello Mike,Please send us a sample file that shows this behaviour, so we can test against it.CreatedOffending WorkbookHere is the specific workbook referenced above. I have successfully opened up other workbooks and Writer documents. Note that this was originally developed under 3.(early) on Ubuntu Linux and used with, I believe 3.6 portable for Windows.Hi Mike,Thank you for sample file. I have confirmed that it crashes in Linux Mint in 4.1.6, 4.2.5, 4.2.6. It doesnt crash in 3.6.7, 4.0.6 or 4.3.0.Createdbacktrace from linuxCreatedformatting correctedI could open the file in OpenOffice 4.01 and I found errors in sheet1 and sheet2.All cells with currencies was formatted as 'Standard' but showed correct as currency (RED for negative values and BLACK for positive with a $ in front)Column F in sheet1 has an error in conditional formatting (second condition should be between 1000,1 and 2000 - not between 100,1 and 2000)After correcting the errors I could open the file in LibreOffice 4.2.5Loads fine for me in master (4.4) and in libreoffice-4-3 (4.3.0rcs).I can get it to crash in libreoffice 4.2.<n> immediately after load though.A trace with symbols is:#0 0xae0e6a50 in ScPatternAttr::GetItem (this=0x8bb01a0, nWhichP=129) at /data/opt/libreoffice/libreoffice-4-2/sc/inc/patattr.hxx:71#1 0xae11a326 in ScColumn::GetNeededSize (this=0x8780298, nRow=37, pDev=0x880c450, nPPTX=0, nPPTY=0, rZoomX=1/1, rZoomY=1/1, bWidth=true, rOptions=...) at /data/opt/libreoffice/libreoffice-4-2/sc/source/core/data/column2.cxx:145#2 0xae1eea72 in ScTable::GetNeededSize (this=0x8780018, nCol=8, nRow=37, pDev=0x880c450, nPPTX=0, nPPTY=0, rZoomX=1/1, rZoomY=1/1, bWidth=true, bTotalSize=true) at /data/opt/libreoffice/libreoffice-4-2/sc/source/core/data/table1.cxx:452#3 0xae16b360 in ScDocument::GetNeededSize (this=0x8707394, nCol=8, nRow=37, nTab=0, pDev=0x880c450, nPPTX=0, nPPTY=0, rZoomX=1/1, rZoomY=1/1, bWidth=true, bTotalSize=true) at /data/opt/libreoffice/libreoffice-4-2/sc/source/core/data/document.cxx:3937#4 0xae165ff9 in ScDocument::IdleCalcTextWidth (this=0x8707394) at /data/opt/libreoffice/libreoffice-4-2/sc/source/core/data/documen8.cxx:644#5 0xae389d79 in ScModule::IdleHandler (this=0x86f86c8) at /data/opt/libreoffice/libreoffice-4-2/sc/source/ui/app/scmod.cxx:1951#6 0xb6b5b1f4 in Call (pCaller=0x86f8720, this=0x86f8730) at /data/opt/libreoffice/libreoffice-4-2/include/tools/link.hxx:123#7 Timer::Timeout (this=0x86f8720) at /data/opt/libreoffice/libreoffice-4-2/vcl/source/app/timer.cxx:225#8 0xb6b5b2a7 in Timer::ImplTimerCallbackProc () at /data/opt/libreoffice/libreoffice-4-2/vcl/source/app/timer.cxx:121#9 0xb37dd3d0 in CallCallback (this=<optimized out>) at /data/opt/libreoffice/libreoffice-4-2/vcl/inc/saltimer.hxx:53#10 sal_gtk_timeout_dispatch (pSource=pSource@entry=0x8dd8368) at /data/opt/libreoffice/libreoffice-4-2/vcl/unx/gtk/app/gtkdata.cxx:834#11 0xb5ed97de in g_main_dispatch (context=0x84ca200, context@entry=0x8513b08) at gmain.c:3066#12 g_main_context_dispatch (context=context@entry=0x84ca200) at gmain.c:3642Valgrind shows this guy ...==30310== Invalid read of size 4==30310== at 0x10517A4D: ScPatternAttr::GetItem(unsigned short) const (patattr.hxx:71)==30310== by 0x1054B325: ScColumn::GetNeededSize(long, OutputDevice*, double, double, Fraction const&, Fraction const&, bool, ScNeededSizeOptions const&) const (column2.cxx:145)==30310== by 0x1061FA71: ScTable::GetNeededSize(short, long, OutputDevice*, double, double, Fraction const&, Fraction const&, bool, bool) (table1.cxx:452)==30310== by 0x1059C35F: ScDocument::GetNeededSize(short, long, short, OutputDevice*, double, double, Fraction const&, Fraction const&, bool, bool) (document.cxx:3937)==30310== by 0x10596FF8: ScDocument::IdleCalcTextWidth() (documen8.cxx:644)==30310== by 0x107BAD78: ScModule::IdleHandler(void*) (scmod.cxx:1951)==30310== by 0x51A21F3: Timer::Timeout() (link.hxx:123)==30310== by 0x51A22A6: Timer::ImplTimerCallbackProc() (timer.cxx:121)==30310== by 0x94723CF: sal_gtk_timeout_dispatch (saltimer.hxx:53)...==30310== Address 0xfbe3ddc is 12 bytes inside a block of size 24 free'd==30310== at 0x402B6AD: operator delete(void*) (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)==30310== by 0x49DDB53: SfxItemPool::Remove(SfxPoolItem const&) (itempool.cxx:886)==30310== by 0x1057DBE6: ScDocumentPool::Remove(SfxPoolItem const&) (docpool.cxx:637)==30310== by 0x10514060: ScAttrArray::SetPatternArea(long, long, ScPatternAttr const*, bool, ScEditDataArray*) (attarray.cxx:505)==30310== by 0x105141F4: ScAttrArray::SetPattern(long, ScPatternAttr const*, bool) (attarray.cxx:349)==30310== by 0x10523A7E: ScColumn::ApplyAttr(long, SfxPoolItem const&) (column.cxx:747)==30310== by 0x1054A62C: ScColumn::SetNumberFormat(long, unsigned long) (column2.cxx:2927)==30310== by 0x10625D29: ScTable::SetNumberFormat(short, long, unsigned long) (table2.cxx:1871)==30310== by 0x1059B4AB: ScDocument::SetNumberFormat(ScAddress const&, unsigned long) (document.cxx:3403)==30310== by 0x105FDE96: ScFormulaCell::InterpretTail(ScFormulaCell::ScInterpretTailParameter) (formulacell.cxx:1686)==30310== by 0x10600C40: ScFormulaCell::Interpret() (formulacell.cxx:1337)==30310== by 0x1060114E: ScFormulaCell::MaybeInterpret() (formulacell.cxx:2165)==30310== by 0x10601282: ScFormulaCell::IsValue() (formulacell.cxx:2196)==30310== by 0x10570059: lcl_GetCellContent(ScRefCellValue&, bool, double&, rtl::OUString&, ScDocument const*) (conditio.cxx:742)==30310== by 0x105735E0: ScConditionEntry::IsCellValid(ScRefCellValue&, ScAddress const&) const (conditio.cxx:1262)==30310== by 0x10573674: ScConditionalFormat::GetCellStyle(ScRefCellValue&, ScAddress const&) const (conditio.cxx:1906)==30310== by 0x1058BE41: ScDocument::GetCondResult(ScRefCellValue&, ScAddress const&, ScConditionalFormatList const&, std::vector<unsigned long, std::allocator<unsigned long> > const&) const (documen4.cxx:816)==30310== by 0x1058C1EC: ScDocument::GetCondResult(short, long, short) const (documen4.cxx:802)==30310== by 0x1054B054: ScColumn::GetNeededSize(long, OutputDevice*, double, double, Fraction const&, Fraction const&, bool, ScNeededSizeOptions const&) const (column2.cxx:134)==30310== by 0x1061FA71: ScTable::GetNeededSize(short, long, OutputDevice*, double, double, Fraction const&, Fraction const&, bool, bool) (table1.cxx:452)==30310== by 0x1059C35F: ScDocument::GetNeededSize(short, long, short, OutputDevice*, double, double, Fraction const&, Fraction const&, bool, bool) (document.cxx:3937)==30310== by 0x10596FF8: ScDocument::IdleCalcTextWidth() (documen8.cxx:644)==30310== by 0x107BAD78: ScModule::IdleHandler(void*) (scmod.cxx:1951)==30310== by 0x51A21F3: Timer::Timeout() (link.hxx:123)==30310== by 0x51A22A6: Timer::ImplTimerCallbackProc() (timer.cxx:121)...It seems that calling:const SfxItemSet* pCondSet = pDocument->GetCondResult( nCol, nRow, nTab );can delete the pPattern we are relying on - which is rather unfortunate.Since the code is the same for 4.3 and 4.4 - it is somewhat unclear why this doesn't fail there too - presumably well worth investigating that =)Ideally all these pointers would have fast intrusive references on them I suppose.Pushed a patch to gerrit, awaiting review from Kohei / Markus.Michael Meeks committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#80813 - avoid FMR by re-fetch pattern after a potential re-calculation.It will be available in LibreOffice 4.2.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Removing bibisectrequest - doesn't seem necessary since there is a backtrace and Michael has already pushed a patchStill not completely happy about why this doesn't happen in 4.3 / master - the code looks ~the same there; perhaps we don't do load time calculation and its just hidden; but I loaded the same doc. in valgrind and did a shift-ctrl-F9 to force re-calc and ... nothing; so ...Reluctantly closing for now; should be in the next 4.2.x ...
id=80650	Createdbroken symbol tableas summarized, in some localized LO editions some of the symbols are missing (at least de and zh_CN).it seems to be platform independent as it has been verified on windows 7 / 8 and ubuntu 14.04.even the examples at the elements dock are lacking of the original greek signs.maybe a re-occurrence of #37869, but i guess 64945 is the interesting one to look at. Confirmed that it shows in 4.1.6 and 4.2.5 with zh_cn but not in arabic UI. Confirmed it doesnt show in 4.3.0 with zh_cn, japanese, arabic, and even KeyID (qtz) UIs.Createdmissing symbols in chinese UIWorking in DE Version: 4.2.1.1Build-ID: d7dbbd7842e6a58b0f521599204e827654e1fb8bVersion: 4.3.0.0.beta1 [en of course]Build-ID: b7cfa1eab1cb1e94f71d6df6612b73f231d0bf92NOT Working in Version: 4.3.0.1 DEBuild-ID: 67f5430184326974072b65403ef1d9d934fc4481So a nasty regression between 4.2 and 4.3 affecting all Math usersAdding it to MABAlso reproduce with 4.2.5.2, Fedora 20 x86, zh_CN UI. Changing version accordingly.Switching to en_US UI do not resolve the problem.Created3.6.7.2 screenshot (works OK)It works OK in 3.6.7.2 release.Created4.2.5.2 screenshot (does not work)It does not work in 4.2.5.2Created4.3.0.1 screeshot (does not work)It does not work in 4.3.0.1.I also tried to remove all the "libobasis4.3-[lang]", but still do not work.Confirmed in 4.3.0.4 (Windows 8.1), german GUI; WorkaroundI've found the following workaround quirk:Replacing the "..program\resource\smde.res" resp. "smfr.res", "smes.res" etc. bythe english version *smen.res* will do the trick: lower case greek symbols à la "%pi" are working again.Problem: I can live with a partial untranslated GUI, but not with a non functional formula editor. So I can still use all my 15 year old math documents...Confirming the bug on x86_64 build of LibreOffice 4.3.0.4 on GNU/Linux, CS locale. Build ID: 62ad5818884a2fc2e5780dd45466868d41009ec0(In reply to)Thank you,this workaround works also on GNU/Linux. The appropriate file is located in package libobasis<version>-<lang>-math_*. For me the smcs.res from libobasis4.2-cs-math_4.2.5.2-2_amd64.deb works fine.Btw.: it seems, that the libobasis4.3-en-gb-math_4.3.0.4-4_amd64.deb file also includes broken symbol definition, since it did not help me.Thaks once again.Still not fixed in 4.3.1.1 (Windows 8.1), german GUI; WorkaroundHad to adapt the workaround quirk:I've found the following workaround quirk:Replacing the "..program\resource\smde.res" resp. "smfr.res", "smes.res" etc. bythe english version *smen-US.res* (was smen.res in older vesion) will do the trick: lower case greek symbols à la "%pi" are working again.Another workaround:Replacing the smde.res (or others) by an old version from 4.2 works too, and it has the advantage using the correct spelling (by replacing with the smen_US.res one must then use the english spelling of variables).(In reply to)Workaround works for me (Win 8.1). Thanx.Just to let you know: The bug occurs only when updating. A fresh installation (done on a new tablet pc with no LibreOffice installed) works as expected.With Mageia 5 ( Build ID: 4.3.1.1-1.mga5 ), I have this problem.Not reproducible for me under Ubuntu 14.04 x86-64:- Version: 4.3.2.0.0+ (Build ID: b2d54aa61607e477cb4b81f1a70e555ee3adb0af)- Version: 4.4.0.0.alpha0+ (Build ID: e6369973702286d92bfc34ab8305d4a9bcf5c27e)both versions build at home.Best regards. JBFSame problem with LO 4.3.1.1 french/Win Seven 64Dataloss : with french LO 4.3.1.11 - create a doc including a formula with a working version of LO or AOO2 - in the formula just add %pi, close the formula editor (you can see π)3 - with LO 4.3.1.1 open the doc (you still can see π), open the formula. you can see %PI has replaced %pi. Close the editor then you will see that Π has replaced π4 - make any change to the doc, save and close5 - Open the doc with a working LO or AOO the Π is definitively in the formulaAs this bug seems to be in 4.2.5.2 shouldn't it be a MAB 4.2, not a MAB 4.3 ?And, as there is an unusable function and data loss, shouldn't it be a blocker ?I have the same problem in LO 4.3.1.1 and 4.3.0.4.A bibisect would be fantastic here in helping us resolve the problem:(In reply to)@Joel: I don't know how we can do a bibisect on this bug: it appears *only* with locales, and intermediate builds are only English US (if I'm not wrong).No problem in 4.2.6.2 french LO/7x64Still broke in version 4.3.1.2 Windows 8, x64, german locale***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***All suggestions below don't work with LO for MAC OS X in pt-Br.***has been marked as a duplicate of this bug. ***Yes, still buggy, also on Debian GNU/Linux x86_64, version 4.3.1.2...(In reply to)***has been marked as a duplicate of this bug. ***Can't be bibisected.***has been marked as a duplicate of this bug. ***Hi, I tried all workarounds in the Italian locale with no success: any substitution of smit.res with the US version from the same install or the italian version from Openoffice 4.0.1 did not get the symbols back.I have now painstakingly readded manually all missing Greek letters one by one, I am still not sure this works with already existing formulas since in some experiments when re-editing old formulas lowercase names of symbols added manually when turned into uppercase.I have experimented a little bit more and tragically my manual effort to recreate missing symbols in the formula catalog does NOT work 100%:- when I create a formula I can insert lowercase Greek letters and they appear correctly;- upon re-editing such formulas, all Greek letters that have an UPPERCASE equivalent (for example sigma and SIGMA) are automatically turned into uppercase, corrupting your formula completely.You are then forced to reconvert manually to lower case all symbols that are actually so; but this works only until the next editing, when the devilish automatic uppercase conversion will take place again....Any workaround to this would be greatly welcome.Further, complicated, news:the problem described in the previous comment (unwanted automatic uppercase conversion) seems to appear not always but in only some instances:- when you edit the formula for the first time after opening the file where it is contained, but not in further editing instances in the same session. If you close the file and reopen it, the first editing will induce it again.- when you copy and paste the formula between two different document types: for example, if you have a formula in a Writer doc and copy and paste it into a new calc sheet, wrong uppercase conversion will take place; if you instead copy and paste it into another Writer doc, it will not. The same will happen in the opposite direction (from a calc sheet to a writer doc), and also when copying it to an Impress file etc from a different file type.For anybody needing to create and edit many formula, this a complete nightmare.Thus, creating manually the lowercase symbols is not a practically useful workaround.Thanks for your attentionI am sorry, but all efforts to clarify a defined mechanism for the problem is failing. Now I am experiencing unwanted uppercase conversion even in the same document when I copy and paste a second instance of a formula.What is happening seems to be somehow changing from time to time.As told in, this bug should be considered as a blockerUnusable function and data loss In one week 6 bugs has been marked as a duplicate of this one, 16 users are following this bugLO 4.3.2.1 should be for this week, and the bug isn't solved (is anyone working on it ?)The only workaround is to go back to 4.2.6Do you have the problem with a fresh installation (uninstall first the current version) and a clean new user profile?Still no problem for me with LO 4.3.2.0.0+ build at home under Ubuntu 14.04 x86-64 with en-US and FR langpacks.Best regards. JBFWhat do you mean by a "fresh" install? If you simply uninstall the previous version before installing the new one, all your personalized settings will be maintained, and this is probably not what you mean by a "clean new user profile".However, the problem is that I have literally dozens if not hundreds of personalised settings, and I would have to ponder carefully if this trial is worth wiping them all and restart personalizing the program again from scratch. A hell of a waste of time to be sure.I could do this experiment on an old PC in my office, maybe tomorrow I'll give it a try.In any case, to be clear all my posts refer exclusively to LibreOffice Italian localization. I have never tried any other.No need to delete - just back up the folder and delete the original. Then you can at least see if it's profile related:I have now uninstalled 4.3.1 and installed again 4.3.0.4, the missing symbols in the catalog problems - as well as the uppercase unwanted conversion - seems to be there as well.Downgrading to 4.2.6.3 the uppercase automatic conversion is NOT present.I had re-aded lowercase Greek letters manually, so I cannot tell if they would automatically be here now - however, the iGreek category that exhibited the same problem is now restored, so probably everything is Ok here with 4.2.6***has been marked as a duplicate of this bug. ***@AndyYou said to have added all missing Greek letters. Did you add also their lowercase names? Else, they will not be recognized in your formulas.regards,JacquesActually I don't think there should be any difference between fresh install and update/reinstall, at least on GNU/Linux. Since the bug is caused by broken symbol table for Math (e.g. smcs.res in CS locale), included in package libobasisX.Y-cs-math_X.Y.A.B-C_amd64.deb and installed in /opt/libreoffice4.3/program/resource, which is not a directory changeable by user, the behaviour should be the same in both cases (unless a user-defined symbol table exists in user's profile folder).Another proof of guilt of this file is its filesize. In version 4.2.5.2, which works good for me, its filesize is 63152 bytes (in package libobasis4.2-cs-math_4.2.5.2-2_amd64.deb). In version 4.3.0.4, which is the first broken, the filesize of smcs.res shrunk to 60716 bytes, and in 4.3.1.2 the filesize is the same.A funny thing is, that the conversion from lowercase greek letters to uppercase greek letters appears ONLY with broken symbol table. When I use older smcs.res file from LO 4.2.5.2, it does not appear.My suggestion is simply to compare smXX.res files from older locales of LO and if they are larger than current ones, there is a large probability, that this locale is currently buggy.Regards,Karel Hruska(In reply to)In response to Jacques:You said to have added all missing Greek letters. Did you add also their lowercase names? Else, they will not be recognized in your formulas.Yes, I have added them in the sense that I:- clicked the "edit..." button in the Catalog window;- in the editing window I clicked on the lowercase Greek letter I wanted in the matrix showing all symbols;- then I modified its name in the first field in the lower half of the window, giving it the name it had in older releases;- for example, when you choose the lowercase sigma this fields shows "Ux03C3", I replaced this text with "sigma", then clicked on "add" the buttons on the lower right side of the windowThe same procedure was repeated manually for all other lowercase Greek letter missing, i.e. all those whose name does not begin with the prefix "var" (these are the only ones left in 4.3.1). This would have been annoying but doable if it resolved the issue while waiting for a fix; however the problem is that this manually created symbols caused the "unwanted uppercase conversion" when using the manually created symbols that I described. It looks as if there were an auto-check of formula code correctness, and this could not take into account symbols added by the user...I have partially solved the problem after I removed the LO user config files, in MAC [~/Library/Application/LibreOffice] after that the lowercase Greek letters works in default user interface. However, if I change the user interface to PT-BR the problem returns.To me, the Greek letters is more important that the user interface.Please let me for once add a comment which is "political" rather than "technical": to me, the difficulties caused by bugs such as this are not only due to my own production work with LO. If it were just for this (which is of course important) any workaround, even a difficult to implement one, would do.The problem is that I am a teacher and use LO in lectures continuously, and do this both because it a free software and to spread its usage and appreciation.So how can I go in class to teach statistics and tell students that the app is so buggy that you cannot write math formulas anymore, or that you must apply arcane procedures to be able to do that again, or that you must change locale?So I agree, to ME personally, locale is quite unimportant, but for the context where I use LO with the public, switching locale to a foreign one is simply unthinkable, unless you do not care making LO the object of blatant complaints, people not wanting to use it, etc.Unfortunately this is at present the case also with another bug, n. 83461, related to a significant bug in the "frequency" function, something that I use everyday in class. If you have a look at it and would like to express interest, it would be nice. Thanks for your attention,Confirmed in 4.3.1.2, locale LT (Lithuanian), system Kubuntu 14.04 (64b): lower-case "beta" is missing.On pc Debian x86-64 with LO Debian package 4.3.0.4, I could reproduce this.However, I don't reproduce this with master sources updated yesterday.Could someone give a try to a daily build (master sources)? (see)Hi Julien,There's no issue with master. Problems come with locale helppack installation, and errors in "smxx.res". There, uppercase letters wording only is the visible difference.JacquesAnother workaround I found with Arch Linux' s Fresh package of 4.3.1.2. If you add the symbols manually in your locale and then change the interface language to English, the lower-to-upper conversion stops somehow and even reverts. Not sure why though.Another workaround I found with Arch Linux' s Fresh package of 4.3.1.2. If you add the symbols manually in your locale and then change the interface language to English, the lower-to-upper conversion stops somehow and even reverts. Not sure why though.I can reproduce this issue on 4.3.1.2/OSX with the "de" language pack.However, if I take a fresh build from master and add the contents of the "de" language pack from 4.3.1.2*, it works as expected - e.g. a lower case %sigma is now shown correctly.Although mixing and matching versions and langpacks is probably not recommended in general, if the problem is in fact already fixed in master this might provide a path for finding where through bisection?(* Language packs don't seem to be built for the dailies and I'm not sure of the procedure for building them from source)Functionality is still broken in 4.3.2.1 French Seven/x64broken symbol tableI confirmed same problem with version 4.3.1.2 French, installed on Windows 7 (built).Uncontrolled lower to upper case modifications. Tried to uninstall, delete all personal settings in "Roaming", then re-install same built. No way, still the same mess. Old files created with with version V4.1 and read-only protected (were not modified with v4.3) are immediately contaminated when opened with v 4.3.1.2.This is a plain disaster, due to the high number of formulae that need now to be restored.I will try replace my French locale version by a US one, but hope it will support the French keyboard and already written text with accents and special character set.I hope someone will be able to fix that bug, otherwise the efforts of all non-English LO communities that need Math will become a bit vain... regards, FTfound the problemDavid Tardon committed a patch related to this issue.It has been pushed to "master":fdo#80650 src transl. merge must be case sensitiveThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.***has been marked as a duplicate of this bug. ***David Tardon committed a patch related to this issue.It has been pushed to "libreoffice-4-3":fdo#80650 src transl. merge must be case sensitiveIt will be available in LibreOffice 4.3.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.David Tardon committed a patch related to this issue.It has been pushed to "libreoffice-4-3-2":fdo#80650 src transl. merge must be case sensitiveIt will be available already in LibreOffice 4.3.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.This is truly good news.BUT is there any date for the 4.3.2 release? I checked the official release planning and it seems that 4.3.2 should already be out as an RC, but there is no trace of it on the web site.This is extremely important to me because I have to install LO in our laboratories at the university for the forthcoming semester, and I have to decide which version to use.At the moment I could use 4.2.6 to avoid math formula problems, but that release has another relevant problem for us (text objects in Calc graphs disappear after saving and reopening files; this has been solved in 4.3.x).Need a backport to LibreOffice 4.2.7, please***has been marked as a duplicate of this bug. ***(In reply to)I do not see this problem in 4.2.6.3.(In reply to)4.3.2 RC2 is released today. You can download it via dev-build server:It shows in the release notes that this bug is fixed in RC2.I am sorry, but I don't think, that the bug will be fixed at least in Czech localization of LO 4.3.2.2. I have downloaded the Czech translation and the filesize of smcs.res is still 60716 bytes, which is the wrong one (see). I am afraid, that the bug will be reopened...If my impressions are wrong, please apologize me...Karel Hruska(In reply to)Bug is fixed for me with fr UI:- Win 7, LibO 4.3.2.2 (Build ID: edfb5295ba211bd31ad47d0bad0118690f76407d) parallel install with si-gui- examples in left tab are fine- old documents containing formula with lower Greek letters are fine- create a new document with formula with lower Greek letters, save, close LibO; reopened document is fineSorry, I tried LO 4.3.2.2 in Wine and the symbol set is full.My apologies and thank you for fixing the bug!Karel Hruska(In reply to)***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Sorry guys,on Mac OsX 10.10 with LO 4.3.2.2 and German language pack the bug is NOT fixed.Perhaps the symptoms have changed slightly. Now small greek letters won't become large ones, but they simply don't exist anymore:E.g. a %pi in a math formula will be shown as %pi even after closing the formula editor.As professor in electrical engineering using LO for all lectures this is a severe show stopper.Please fix this ASAP!!!!!!please open a new clean report with the current new status of the bug and put this bug link under See Also(In reply to Harry from)@Harry,Please test a build of 4.4.0 alpha1+ for OSX as well and report result against that on a new bug.Thanks.Please also note: As discussed on, it may be necessary to reset your user profile before the fix is effectiveOK guys,removing the profile and reinstalling LO afterwards worked out alright.Thank you very much for your quick response!I still having some issues with a varphi now being a phi and the varphi being something really weird but since that has changed a while ago I will check if a correspond has already been reported.
id=80910	Problem description: Steps to reproduce:1. open "edit paragraph style" by right click2. choose tab "background"3. choose a colour as a background colour4. click OK5. save the file6. open the fileCurrent behavior:The background colour of the paragraph has disappearedExpected behavior:to find the paragraph with the choosen background colour Operating System: Windows 7Version: 4.3.0.2 rcLast worked in: 4.2.4.2 release thanks for reporting pu.I can confirm the issue. Format > Paragraph does save the background settingOK in 4252 > regressionCiao,Coralready problem in 430beta1, maybe earlier, so must look for duplicate issues..hmm, no dups found here..Ah :)*** This bug has been marked as a duplicate of***
id=80755	The startcenter has started showing the content of password protected ODS, ODT and xlxs in the preview.It seems to happen with all my documents.These apreview is persistent after closing the app and reopening/rebooting as if its caching the imag on file open.This behaviour only occurs after the document has been opened in 4.3.0.1Obviously this is a major confidentiality issueNo real reason for attachments/images as the behaviour appears consistent. Operating System: Mac OS XVersion: 4.3.0.1 rcLast worked in: 4.2.5.2 release Confirmed in 4.3.0.1 - Ubuntu 12.04 x86. Just tried with ODS, XLS, XLSX.I think it's not regression since doc preview it's just implemented in 4.3. But I raise the importance since it's about confidentiality.If not honoring password set status, then possibly related to work for enhancement of fdoand***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Isn't the issue here, rather than the generation of previews (suppression handled with an Expert Confuration stanza-- objstor.cxx --), that the LO defaults now are for a HistoryItem thumbnail preview to be written in base64 to the HistoryInfo for each element of the recent document list.ref: unotools/historyoptions.hxx HISTORY_PROPERTYNAME_THUMBNAILSo, a thumbnail preview, in addition to being added to the ODF document (or not), is also being recorded for each document into each user's profile in the registrymodifications.xcu file, and isn't that where the StartCenter preview is being pulled from?So, if preview of Password protected documents in the StartCenter are not desiered, seems that should be handled with an Expert Configuration stanza to not store a base64 thumbnail with the HistoryInfo for those items.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Adding this as a regression as this behaviour didnt happen with 4.2 with odt files and now does.@Kendy:Looks likeis causing this, it should not generate a thumbnail if a password is set.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Setting priority to highest as this is a MAB. This is part of an effort to makethe importance of MAB reflected in priority too.Best regards. JBFMaxim Monastirsky committed a patch related to this issue.It has been pushed to "master":fdo#80755 Don't generate thumbnails for encrypted filesThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Thank you very much Maxim for this fix. It works for me on existing password protected files if I modify the file properties (menu File > Properties). It seems it is not enough to save again the document in the master.Do you plan to backport your fix to the 4.3 branch ?Best regards. JBFIs this fixed or are parts missing? Assigning Maxim.(In reply to)Hmm... it doesn't work for me that way. As long as the file is in the recent list, it will show a thumbnail. Only doing Save As or clearing the recent list (or at least removing the individual file) would help.Actually in that case the last saved thumbnail will show (which doesn't necessarily reflect the current look of the document). No new thumbnail will be generated. The reason is that the current code doesn't overwrite existing thumbnail with an empty one. I can of course change this, but I wonder whetherit's a good idea?Sure.(In reply to)On windows 7 sp1 64-bit, en-US withVersion: 4.4.0.0.alpha0+Build ID: 32ce5ae15a8f156b4681c36d248b6731df3457c6TinderBox: Win-x86@42, Branch:master, Time: 2014-08-25_01:27:12The thumbnail view inserted on the Start Center is now the generic ODF icon by document type. Verified with an ODT and ODG document, so looks correct.verified on OSX 10.9.4 as well.I'm unsure about that. Having a clean solution would be great. But on the other hand, this is now fixed and there's always the workaround of manually removing the files from the start center.So instead of spending more dev time on this specific issue and potentially introduce other problems, I think it's best to go with the fix as is.Oh and thanks for tackling this most critical bug. Depending on your environment this is a rather dangerous bug and users privacy and security should be taken serious. So it's great to see this bug go.As this bug is a MAB for 4.3, shouldn't we wait for the backport and verification on 4.3 to mark it as verified fixed?Best regards. JBFAfaik there's no policy for that. Those waiting / pending states do not exist in bugzilla. So feel free to proceed as you like. But yes, since it's a critical fix, maybe should be tested on 4.3 as well as soon as the backport is there.Maxim Monastirsky committed a patch related to this issue.It has been pushed to "libreoffice-4-3":fdo#80755 Don't generate thumbnails for encrypted filesIt will be available in LibreOffice 4.3.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Verified fixed in version 4.3.2.0.0+ (Build ID: ff518ba8a6d2ed88c7992ead856d7f7987a04919) build at home under Ubuntu 14.04 x86-64.Thank you very much, Maxim !Best regards. JBF***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Still occurs in a little different behavour in 4.3.3.2. When you create a NEW document and save it password protected, than the created document is shown in the start center with as readable thumbnail! Only when you remove the thumbnail from the start center and reopen the document with "File->Open" it is recognized as a protected document an the thumbnail is iconized.(In reply to Rudolf Kollien from)Can't reproduce with 4.3.3.2 under Fedora 20. Could you please try with a clean profile?(One thing that could happen is that you had in the past some non-protected document with the same path. Each time you open the start center, it checks the availability of all the recent files. If some file is missing - it doesn't remove it from the list, but just hides it. So it's possible that the thumbnail actually left from an old file with the same name, that you had at some point in the past.)In this case unfortunately no: it's a completely new document with an unique name. Never had a document named like the one.I can confirm the following:* If you open a NEW file and save it first time round with a password, then NO content is displayed in the thumbnail. (Desired behaviour)* If you have a normal unprotected file already written before and you decide to save it with a password, then some content of the file (taken before the password implementation) is still visible in the thumbnail. (Can be undesired)Version: 4.3.2.2.0+ Build ID: 430m0(Build:2) backport on Debian Wheezy(In reply to Rudolf Kollien from)I'm repeating my request: Please try with a new profile. (You can backup your current profile, and put it in place after testing, so you won't lose any of your settings.)Can confirm this on 4.3.3.2 MacOSX.Created NEW profile with NEW user and performed the described steps. Results as described by Stamatis. (In reply to Stamatis from)So basically the issue now is with overwriting previously non-protected document, with a protected version? In that case it was kind of expected according to what I wrote in(that we don't remove old thumbnail if there's no new one). but I thought it will be only an issue when upgrading to the non-affected version, and I definitely didn't take into account this particular use-case. So I would like to know, how common is this scenario / how much is this annoying?I think, it isn't so uncommon. When writing a new document, i always emphasize my users to strictly save the document before printing. Once the (new) document is finished, the user decides if the content is confidential and password protected or not.The other point of view is: Shouldn't the thumbnail reflect the contents/layout of the document? In this case, i mean, the thumbnail must always be updated on closing/saving the document. At this point, password protection can be recognized and the thumbnail can be removed or simply updated as "confidental" or "secret" or something else. Or i'm wrong?I think that this scenario (retro-password protect an existing file) is quite common with users and I second the idea that once password is in place the thumbnail should become a generic one, independently of any previous instances.Maxim Monastirsky committed a patch related to this issue.It has been pushed to "master":Related: fdo#80755 Always update the thumbnailIt will be available in 4.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Now the thumbnail is always updated, so resaving with a password will remove the old thumbnail. Please test it with 4.4 daily, and if there are no apparent regressions (like missing thumbnails in some cases), I think it should be possible to backport this to 4.3 as well.***has been marked as a duplicate of this bug. ***Migrating Whiteboard tags to Keywords: (bibisectRequest)[NinjaEdit]
id=81004	DrawF2, hit document, type some textInsert special characterSelect that oneOpen dialog Format > Character > Opens empty and in a few seconds: crash Createdtest file with special characteralready problem in Alpha 1Confirm with 4.3.0.2, Win XP SP3.David Tardon committed a patch related to this issue.It has been pushed to "master":fdo#81004 this looks like a mis-merge to meThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.David Tardon committed a patch related to this issue.It has been pushed to "libreoffice-4-3":fdo#81004 this looks like a mis-merge to meIt will be available in LibreOffice 4.3.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.David Tardon committed a patch related to this issue.It has been pushed to "libreoffice-4-3-0":fdo#81004 this looks like a mis-merge to meIt will be available already in LibreOffice 4.3.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=80927	Problem description: Windows XP Pro SP3, LibreOffice 4.3.0.1 AND 4.3.0.2Despite of updating an existing version (4.2.5.2) or a clean install, LibreOffice works normally until I enable Quickstarter. With Quickstarter enabled – no matter if I try to open a document or simply try to start LibreOffice Start Center – the software crashes with no visible error message. Instead, it pops-up an empty frame which can only be dismissed via Windows Task Manager.Disabling Quickstarter allows LibreOffice to start again normally.Steps to reproduce:1. Start LibreOffice2. Enable Quickstarter and close Libreoffice leaving Quickstarter running3. Start LibreOffice againCurrent behavior: LibreOffice runs only if Quickstarter is disabledExpected behavior: LibreOffice running with Quickstarter enabled Operating System: Windows XPVersion: 4.3.0.2 rcLast worked in: 4.2.5.2 release hi, a few questions:1- did you experience the same issue in 4.3.0.1 as well?2- which exact steps you do to activate quickstarter?3- how did you disable quickstarter after the crash?Hi Tommy27,1 - I did experience de same issue in version 4.3.0.1.2 - To activate Quickstarter (because the option to activate during installation is ignored by the software): 2.1 - Tools > Options > LibreOffice > Memory > Load LibreOffice during system start-up3 - To disable I used the hardest way, I uninstalled the software and deleted all remaining traces by hand (folders, files and registry keys I was able to find) and then installed again. Probably I could simply erase the shortcut in my "Startup" folder, but I preferred do perform a clean install.I do not reproduce it with LibO 4.3.0.2 under Win7x64is there any other WinXP user who can test?I did experienced it with 4.3.0.2 in Windows 8.1 (64) environment. Had to uninstall the software and start over with a clean setup. I am not sure if I was able to have quickstarter installed with 4.3.0.1, but I´m pretty sure I had trouble with it, and may be I disabled it. It definitely doesn.t work in the current release 4.3.0.2. The same happens on a machine running Windows 7.I use the spanish localized versión of LibreOffice.By the way, if a new release is updated, the install option button does not have any effect on activating quickstarter. It has to be setup from the Tools | options | Memory menú as koenig.ralph explains. This is happening since a long time ago, perhaps from versión 3. On the other hand, a completely clean installation allows the activation of quickstarter right from the install options.Hi, I reproduce with Win XP SP3, LibreOffice 4.3.0.2.Steps:1. Enable Quickstarter (tools-options-memory-Load LibreOffice during system start-up)2. Close libreoffice by clicking the "X" button. (program still running at backgound)3. Start libreoffice again.If you kill the libreoffice related process from system monitor, then LibreOffice can start up again, but if you close again you can not start it another time (you have to kill the process again to make it able to start.)With this bug, quickstarter do not work at all.Set to NEW.QuickStarter worked for me on windows in the previous versions, so REGRESSION.Bibisectrequest.do you have chance to test it over a Win7 machine?Tested and reproduced with LibreOffice 4.3.0.beta2, Windows 7 X86.It's even worse, killing the process or resetting user profile do not work. The only way to make it start up again is to reisntall.Important info:I have Apache OpenOffice installed along with libreoffice in my Win Xp machine;and I have libreoffice 4.3.0.beta2 and 4.2.4.2 install in parrel in my Win7 machine.Based on the following description on the release note page:I think the crash has sth to do with the above (AOO and Parrel install)good hint. i did not reproduce that issue on Win7x64 and I have no AOO installed.Oh wait...I uninstalled other versions and only installed 4.3.0.2 on my win7 machine, still freezes....@tommy27, will you try to start "LibreOffice" (rather than Writer, Calc, etc..) when you enabled quickstarter?Hi, I ticked "Tools > Options > LibreOffice > Memory > Load LibreOffice during system start-up"then closed LibO and relaunched it from the desktop icon shortcut.no crash under Win7x64 with version 4.3.0.2 Build ID: 14ed55896fdfcb93ff437b85c4f3e1923d2b1409Hion my win8.1 (64 bit) machine libre is working even quickstart is turned on, but it won't really start. I can't see it on my windows quicklanch bar even if I started writer. But I can use writer, calc, ...But on my win8.1 32 bit if I turn quicklach on it freezes. write, calc won't start.ps: you don't need to reinstall it again to use libre if you got that error, simply rename quickstart.exeforgot to mention: 4.3.0.1 and 4.3.0.2Removing BibisectRequest as this seems to be Windows only - if it's confirmed in Linux please add BibisectRequest again (CamelCase).hican't reproduce the error on my linux 32 bit4.3.0.2: the error still exists both on 32 and 64 bit win8.14.3.0.3: the error still exists both on 32 and 64 bit win8.1libreoffice 4.3.x craches without AOO installed. Enabling QuickStart is enough to make libre crash.4.3.0.4: the error still exists both on 32 and 64 bit win8.1***has been marked as a duplicate of this bug. ***Having Same issue:32-bit System the problem causes LO to crash constantly when starting soffice.exe which is what runs when quickstart.exe is run. Can intermittently get soffice.exe and swriter.exe etc to run. 64-bit System the problem is that I can run soffice.exe seemingly no problem but the quickstart utility doesn't show in the system tray.Neither of these allows quickstart utility to run in the system tray.Going back to 4.2.5 for now as these issues make 4.3 unusable."the version field of the bug should show the earliest version manifesting the bug"4.3.0.0.beta1 is earlier but I'm too tired of changing it again....I am seeing the same behaviour with the release version 4.3.Running Windows 8.1 x64One interesting thing I observed in WinXP, 4.3.0.4:1. Enable quick starter;2. Start "LibreOffice Writer/Calc/Impress...";-> Freeze at libreoffice logo.3. Kill all "soffice" related processes;4. Start "LibreOffice" (Rather than "Writer/Calc/Impress)-> The start center opens successfully. And you can start a component from start center with no problem now.5. Now start any component from sytem application menu-> Component started successfully.(With this workaround, you dont need to reinstall libreoffice anymore, as discussed in.)(Bad thing is that, there is no quick start systray shown at all the above steps.)Problem also exists on my Win 8.1 Update 1 system (with 4.3.0.4)4.3.1.1: the error still exists both on 32 and 64 bit win8.1Just another confirmation here: LibreOffice with enabled quickstart constantly crashes on Win 8.1 x64 with German locale.Wasn't able to resolve this yet, but will report, if Kevin Suo's Workaround for XP works in 8.1, too.As long as this isn't fixed, I propose hiding the quickstart option or marking it "experimental", so unexperienced users don't run into this problem.If you rename or delete the quickstart.exe the option disappears from Memory menu.Just like in the portable version***has been marked as a duplicate of this bug. ***(In reply to)I confirm that LibreOffice works when the "Quickstarter" case is not checked at the installation setup.Confirm crash with Quickstarter enabled on W7 SP1 with LO 4.3.0.4***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***IIRC Andras was looking at something like this, but - he's on vacation until Monday I think ...(In reply to)We have 2 patches in gerrit, I have no idea why they haven't been integrated.I can reproduce this bug in 4.3.0.4 Win7 x64.It was not present from the time of installation, started after some time.Now i can reproduce it on almost every start of both Quickstarter and single apps like writer.On startup the program freezes for 6-8 minutes, and almost all other programs also freezes, in this period, not even CTRL+ALT+DELETE can't open the Windows joblist, until LibreOffice decies to un-freeze.(In reply to)UPDATEI uninstalled 4.3.0.4 and then installed 4.3.1.1, that fixed the bug for me(In reply to)lucky you ;)I tried but not for me ;(can you see the icon on the systemtray?If someone can reproduce this with a debug build - it'd be fantastic to have a stack trace of where it has hung. Windbg should be able to get that for us.Hacks to disable the quick-starter are all very well, but that's a useful feature, and we should get to the root cause here ASAP.(In reply to)where can I find a "debug build"?(In reply to)is what you mean?Andras Timar committed a patch related to this issue.It has been pushed to "libreoffice-4-3":fdo#80927 - quickstart causing trouble on windows, disable itIt will be available in LibreOffice 4.3.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kevin Suo's method killing the processes didn't work for me on Win 8.1 x64 so I had to rename quickstart.exe to make LO work again.@Michael:I would also like to help tracking down the original cause of the failing quickstarter to help return to functioning status.As far as I can see, though, to get a stack trace using WinDbg I will need to run LibreOffice before I can select it to be tracked by WinDbg - since the crash appears during start-up, I'm not sure if this can work.Is there any way to have WinDbg monitor a file/process during start-up?libo-43~2014-08-25_08.45.25 got the error. waiting the next build, thanks all the effort.Andras Timar committed a patch related to this issue.It has been pushed to "libreoffice-4-3-1":fdo#80927 - quickstart causing trouble on windows, disable itIt will be available already in LibreOffice 4.3.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.just downloaded 2014-08-26_10.56.01there is no quickstart.exe and no option at all to turn it on (tools/option/memory)yes, the quickstart option has been disabled in 4.3.1.I don't know if that was a temporary measure until devs find a fix to enable it again or if the quickstart option has been definitively dropped off.2014-08-27_08.14.09: quickstarter.exe is still missingYes - it is disabled until we resolve the crash - this was done on purpose***has been marked as a duplicate of this bug. ***2014-08-28_10.53.34: quickstarter.exe is still missing: "this was done on purpose"LO 3.4.1.2 is so fast than I really don't miss quickstarter.Congratulations guys...Quickstart.exe still missing in 4.3.2 :(Please don't even think about discontinuing the quickstarter completely, as it really speeds up opening LO dramatically. All those, who try to tell you, that it's not needed anymore due to superfetch (windows Vista and higher) are wrong. Just take a stopwatch and try it, before telling such things!For me not having quickstart.exe is a complete showstopper, will revert back to 4.2.6_secfix.Completely agree. We user atom PC-s, and we r missing quickstart. Now it take 3-4x more times to start libre. Hope see QS soon.Anyone that can get a stack trace of the quickstarter crash, with debugging symbols - would make a large contribution to having the bug fixed =)Endless comments of the form "this feature is really important to me" combined with no activity at all around solving it are extremely counter-productive.(In reply to)How can I make it crash, when its not available??? Any way to get the quickstarter back? Its not available at install. I already tried the Quickstart.exe of 4.2.6_Secfix, but this doesn't seem to work.You can go back to the latest version that has the crash and then debug it.(In reply to)As for comments like this - they really don't add anything to the bug report. If it's a show stopper please consider: (1) submitting a patch, (2) finding someone that you know to submit a patch, or (3) wait for a VOLUNTEER to accept fixing the issue. This is a community, saying "this is a showstopper" doesn't inspire anyone to give their time literally for free. For people who use these kinds of words, I truly hope that you join one of our teams (not necessarily dev team) and contribute back to the community that gives tens of thousands of hours at no charge.If you're interested in QA (where we need more people quite bad) please contact me directly - it'll get you much further than going on bug reports and calling them "showstoppers"CreatedWinDBG Result of LibO 4.3.0.4 beeing unresponsive with Quickstart enabledGood Morning :)@Michael Meeks, Joel Madero and everyone else who felt me being "rude" or disrespectful yesterday: I'm very sorry, that my posts were received that way, that was not my intention. I absolutely have the highest respect of any LibO contributor and the spare-time many of them bring into the project.As requested by Michael Meeks, I just uploadet a WinDbg Result (don't know if this is what's called a stack trace?). I hope a developer can see more information in it then me, because to me it seems its missing any vital information. Problem is, that actually LibO is NOT crashing, but unresponsive. It uses almost no CPU Cycles, so I guess its waiting for something that's not happening.I also have memory dumps of soffice.bin (214MB) and soffice.exe (35MB) that were made with the hanging LibO. If this is of help to a developer, I can upload it to my ftp and share the URL with a developer over PM (don't want to make full memory-dumps public, due to privacy).CreatedWinDBG Result of LibO 4.3.0.4 beeing unresponsive with Quickstart enabledWinDBG Result of LibO 4.3.0.4 beeing unresponsive with Quickstart enabled.Hi there; thanks so much for the trace :-)So - this is tantelising =) you attached the debugger, got to the point that you could ask for a stack trace, and then continued ;-) you need to type:~* kAt least I think so by reading:Thanks !CreatedWinDBG Result of LibO 4.3.0.4 beeing unresponsive with Quickstart enabledHehe... I knew I wasn't done right. Thanks Michael for pointing me to the right command. File is updated...Any more things I can read from WinDbg? Its still running ;)CreatedWinDBG Result of LibO 4.3.0.4 beeing unresponsive with Quickstart enabledAnother run. Forgot the symbol-server on the previous one :/@buzilla2 - thanks for the kind words. I tend to default to what I said just because we literally hear it every day. If you go through the few thousand bugs, at least 1 in 10 have someone screaming "this is a blocker! Fix it now!" or some such thing and . . . as you can imagine, it can become tiring/unmotivating/etc . . . reading it every day.BTW the offer still stands for you to join QA ;) We could use people with your skills (people who can follow instructions, do debugs, and write polite messages). Let me know if you have literally any free time and I'll help onboard you.That being said - thanks so much for going the extra step and helping us narrow down the problem. Moving this back to NEW@Michael - should we somehow get those large files from bugzilla2?@Joel Madero: Have you received my mail yesterday?I started to work on this, I have everything I need (Windows, debugger, reproduced problem, etc.). Let's see, if I can get anywhere with it...Thanks Andras - good luck :)So far, I bisected the problem, and it went wrong at:sfx: Use constructor feature for ShutdownIcon.At that time there were a lot commits like this, they looked like a mechanical conversions to me. Maybe this one contains a trivial error, that went in unnoticed. Maybe Stephan or Matus can see it quickly.Before this commit the quickstart icon appeared in systray, after this it did not, I only saw soffice.bin and soffice.exe in task manager. I think it is the root of the problem, quickstart component is not initialized properly.(In reply to Andras Timar from)Oh - great catch Andras, thanks!So, yes, it's wrong and somehow got unnoticed.I've tried to fix it in:(ignore that CR: -1)Could someone please verify if this works?Then we could try to fix that unit test.Matus, thanks for your patch! Now the QuickStart icon appears on the systray, the only problem with it that I get a crash dialog and LibreOffice restart, when I want to exit from it (right click on the systray icon, and select exit from the popup menu).Maybe the crash is not related (and I'm testing libreoffice-4-3 not master).(9ffbc.9eabc): C++ EH exception - code e06d7363 (first chance)(9ffbc.9eabc): Access violation - code c0000005 (first chance)First chance exceptions are reported before any exception handling.This exception may be expected and handled.vcllo!Timer::ImplTimerCallbackProc+0x5d:693c001d 8b4a0c mov ecx,dword ptr [edx+0Ch] ds:002b:dddddde9=???????? // find timer where the timer handler needs to be called pTimerData = pSVData->mpFirstTimerData; while ( pTimerData ) { // If the timer is not new, was not deleted, and if it is not in the timeout handler, then // call the handler as soon as the time is up. if ( (pTimerData->mnTimerUpdate < pSVData->mnTimerUpdate) &&/* CRASH HERE ->*/ !pTimerData->mbDelete && !pTimerData->mbInTimeout ) { // time has expired***has been marked as a duplicate of this bug. ***(In reply to Andras Timar from)it most likely is, see my comment to <>Matúš Kukan has committed a patch related to this issue.It has been pushed to "master":fdo#80927: css.office.Quickstart should be single-instance service.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.***has been marked as a duplicate of this bug. ***4.3.3.1 quickstart is working thanks Matúš and András and everyone(In reply to Kiss-Kálmán Dániel from)Credit is due to Stephan Bergmann in the first place. :)Just testet in 4.3.4 DevBuild: Quickstart starts and exits correctly, and also any other Quickstart function seems to work perfectly :)Many thanks to everyone involved in fixing this :)great to hear that. this bug is a nice example of good workflow and teamwork between users, QA and developers. thumbs up for everybody!!!I set status to VERIFIED.Is this fixed in 4.3.3 or should I wait for 4.3.4? I am still on 4.2 branch because of this bug.(In reply to Massimo from)see the Whiteboard field: target:4.3.3 target:4.4.0it means that the fix is already implemented in versions 4.3.3 and 4.4.0 so you can safely upgrade to 4.3.3(In reply to tommy27 from)Thanks, it works perfectly!
id=81008	Createdtext with first-page header 'Sermon St Gregory's Offchurch' that won't let itself be altered.Problem description: I previously reported first/subsequent header problems (in May) with the previous release of LO: first header appearing on second page as well with associated forced new page and reformatting of the paragraph going over the page change.This seems to have been fixed, but now the first header in my template won't let itself be overwritten. I have changed the header and saved, closed the doc and found the original version when I reopened. I have done this twice.Steps to reproduce:1. .... Open document attached2. .... Change text in first page header3. .... Save and closeCurrent behavior: On reopening, the original text of header reappearsExpected behavior: the altered text should appear Operating System: Mac OS XVersion: 4.1.6.2 release Dear florinequals,I can confirm that it doesnt work in 4.2.5 and 4.3.1 but does in 4.1.6 on Linux Mint. What is weird is that the thumbnail that appears in the start center in 4.3, show it with the altered text.Setting Priority:Critical - substantial data loss on a very simple test caseHighest - MAB 4.2 (regression + serious data loss)f2554751603ad8537257b3cf52d6171056c76eeb is the first bad commitcommit f2554751603ad8537257b3cf52d6171056c76eebAuthor: Bjoern Michaelsen <>Date: Fri Oct 18 05:12:11 2013 +0000 source-hash-f42768fe0b60ecbbe9c68d775329bf28c0690131 commit f42768fe0b60ecbbe9c68d775329bf28c0690131 Author: Caolán McNamara <> AuthorDate: Mon Sep 2 11:00:05 2013 +0100 Commit: Caolán McNamara <> CommitDate: Mon Sep 2 12:22:34 2013 +0100 Resolves: fdo#68794 blank placeholders when there is no known language yet Change-Id: I7f43144bd61ddc575d8b7094567433fdfd5ee291:100644 100644 201a17de07e17bd7debfdfe6ca43381e0cbfb343 12e94aaaed81846299f7c651da9b7cdfdaea5416 M ccache.log:100644 100644 6cc4c780f897b089bb359873db4fccd70b0c81e5 3ea3177036d3389e1c40e9c6c93c81c233297cd7 M commitmsg:100644 100644 2153cb6a9483927f005548244e5b98d99dca72c1 0078d4a35a067ec61accb624b78ced5467d42364 M dev-install.log:100644 100644 5544a3ca7ed6b28cc305c7b50b859e415b2e25d0 43dbebe038278acde4ca66aa7e8abcced5bdd20c M make.log:040000 040000 c053397df7eeda869c774fb1a0ef0d24e38b7e90 e21ced5098ed0fafcf81768c9d8e8f8e4e34888f M opt# bad: [423a84c4f7068853974887d98442bc2a2d0cc91b] source-hash-c15927f20d4727c3b8de68497b6949e72f9e6e9e# good: [65fd30f5cb4cdd37995a33420ed8273c0a29bf00] source-hash-d6cde02dbce8c28c6af836e2dc1120f8a6ef9932git bisect start 'latest' 'oldest'# good: [e02439a3d6297a1f5334fa558ddec5ef4212c574] source-hash-6b8393474974d2af7a2cb3c47b3d5c081b550bdbgit bisect good e02439a3d6297a1f5334fa558ddec5ef4212c574# bad: [4850941efe43ae800be5c76e1102ab80ac2c085d] source-hash-980a6e552502f02f12c15bfb1c9f8e6269499f4bgit bisect bad 4850941efe43ae800be5c76e1102ab80ac2c085d# skip: [a043626b542eb8314218d7439534dce2fc325304] source-hash-9379a922c07df3cdb7d567cc88dfaaa39ead3681git bisect skip a043626b542eb8314218d7439534dce2fc325304# skip: [aba65c3e4c0df07e4909aeefb758cdb688242bf6] source-hash-827524abfb4b577d08276fde40929a9adfb7ff1agit bisect skip aba65c3e4c0df07e4909aeefb758cdb688242bf6# bad: [c81a8a0dcfc1ed095a80e4485c89dd0fcaf73f31] source-hash-c69ed33628ec0b7abf6296539cf280d6c4265930git bisect bad c81a8a0dcfc1ed095a80e4485c89dd0fcaf73f31# bad: [1d4980621741d3050a5fe61b247c157d769988f2] source-hash-89d01a7d8028ddb765e02c116d202a2435894217git bisect bad 1d4980621741d3050a5fe61b247c157d769988f2# good: [ba096f438393091574da98fe7b8e6b05182a8971] source-hash-8499e78ca03c792f4fa2650e02b519094ba0baa8git bisect good ba096f438393091574da98fe7b8e6b05182a8971# good: [e75547cbd2d9d480ba13e119a8df8098c9d3a0a3] source-hash-69f686774cfeb803fdd63ed1ef07ff70550930degit bisect good e75547cbd2d9d480ba13e119a8df8098c9d3a0a3# good: [bac2489ff3b644bd046102e379bff5a6c6c469d9] source-hash-621c1e491e56db5416da1c763aaff862e8ede67agit bisect good bac2489ff3b644bd046102e379bff5a6c6c469d9# good: [0b24b35122b1aec8721035679954b10f82a23540] source-hash-cdab3d619ca0389d4c14e3b50fb66bbadcf5c52fgit bisect good 0b24b35122b1aec8721035679954b10f82a23540# good: [21be8eddb95a12408b74f43d3effb9dc9821e99e] source-hash-bcc51fb2ebdf77a1cc089857775fd742085b45b6git bisect good 21be8eddb95a12408b74f43d3effb9dc9821e99e# good: [e33eaf662f84503c8de782d6677d9eb1b0b0d96b] source-hash-6c3d74e8b779b1eb2d9779ed84f1518e078113c4git bisect good e33eaf662f84503c8de782d6677d9eb1b0b0d96b# bad: [f2554751603ad8537257b3cf52d6171056c76eeb] source-hash-f42768fe0b60ecbbe9c68d775329bf28c0690131git bisect bad f2554751603ad8537257b3cf52d6171056c76eeb# first bad commit: [f2554751603ad8537257b3cf52d6171056c76eeb] source-hash-f42768fe0b60ecbbe9c68d775329bf28c0690131Thank you!!On 12 Jul 2014, at 06:31,wrote:It looks like this is fixed by b4ccde72b8e2e45e7276d5b08b182495a1b1a617 (master) / bcbeac44ca54f41fb80a027214b9eb2ec1eb14dd (libreoffice-4-3)Using the steps to reproduce, I tested that the bug is reproducible in bcbeac44ca54f41fb80a027214b9eb2ec1eb14dd^ (commit before) and not in bcbeac44ca54f41fb80a027214b9eb2ec1eb14dd.This fix will be available in LibreOffice 4.3.2(In reply to Luke Deller from)Thus closing as FIXED.Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=81056	  Or something; the attached document creates problems for MS Office on import. Miklos chased this down and had this to say:<vmiklos> mmeeks: moment, i think i know what's the problem<vmiklos> mmeeks: so it seems word freezes if we put an anchored itage inside a textbox, even if the markup allows to do so; i changed the anchored duck to an inline one, and with that both LO and Word is happy with the docx, i updated it in SparkleShare.<vmiklos> mmeeks: if you can file a ticket for that, then later i think it would make sense to turn "anchored image in textbox" into "inline image in textbox" automatically on export, so that this works out of the box.I guess a gap between the spec. and the reality etc.My Word 2010 hangs in an infinite loop trying to load this .duckx.Createdduckness.(This is an automated message.)Setting priority to highest as this is a MAB. This is part of an effort to make the importance of MAB reflected in priority too.please retest with 4.3.x and 4.4.x and tell if a new duck file created with newer LibO releases still freezes MS Office.unfortunately I hav no MS Word to test.if bug persists please move this report to mab4.3 list since 4.2.x is end of lifemoreover was this really a mab4.2?I see the version was set to 4.4 alpha... so maybe it's a mab4.4please checkHey Michael -So I can confirm the issue with your file but if I open it with beta 2 and then save it as a new docx it opens fine.Am I missing something here or is it resolved? For now I am removing from 4.2 MAB (as it's end of life) and tossing this into NEEDINFO.If you can still confirm this issue with beta2 or master can you let us know how to create the file from scratch? Or attach an odt that we can save as docx to see the issue.Of course if it's still repro for you, we can toss it onto 4.4 mab (assuming it just popped up in 4.4 and not an earlier release, in which case 4.3 mab :) )Thanks!*** This bug has been marked as a duplicate of***
id=81113	The WebQuery function (Insert->Link to external data) does not work anymore.Steps to reproduce:1. New Calc;2. Insert - Link to external data3. Paste any one of the following links to the url field:...(any url which contains a table in it)4. Hit ENTER.Current Behaviour:Nothing happens.Expected Behaviour:Calc should load the webpage for a while, then a dialog pops up to ask you for import options, then available tables/ranges appear in the box.OS: Ubuntu 14.04 x86LibreOffice 4.3.0.2.It works in 4.2.5.2, -> Regression. WebQuery is a functionality that many people uses to fetch data from the web and import to calc.Hope this functionality come back in 4.3 soon.More info: WebQuery works as expected using macro in 4.3.0.2:sub myWebQuery dim document as object dim dispatcher as object document = ThisComponent.CurrentController.Frame dispatcher = createUnoService("com.sun.star.frame.DispatchHelper") dim args1(2) as new com.sun.star.beans.PropertyValue args1(0).Name = "FileName" args1(0).Value = "" args1(1).Name = "FilterName" args1(1).Value = "calc_HTML_WebQuery" args1(2).Name = "Source" args1(2).Value = "HTML_TABLES dispatcher.executeDispatch(document, ".uno:InsertExternalDataSource", "", 0,args1()) end subConfirmed it doesnt work in 4.3.1 and master, but works in 4.2.6.For this link:as provided in, it also does NOT work in LibreOffice 4.2.5.2 (when hit ENTER, no tables are shown in the "available tables/ranges" box).But it works in 3.6.7.2.However, in 4.2.5.2, all other links I tested works fine.So I keep the version as 4.3.0.2, and addas see also.Prioritizing:Critical - completely broken feature (although I think major would have been sufficient, I'll trust others judgment here :) )Highest - regression + 100% broken (mab)So I hope that this bibisect is correct - I based it on the import dialog coming up vs. nothing coming up withThat being said - with bibisect even waiting quite awhile I never saw tables come up (strange, no crash or anything, just hung, maybe had I waited longer it would have worked).ae44e45a06e1e642fc72b259e50e59837a9dda3f is the first bad commitcommit ae44e45a06e1e642fc72b259e50e59837a9dda3fAuthor: Bjoern Michaelsen <>Date: Sat May 10 21:04:53 2014 +0000 source-hash-004b403d75356e7184c24c6b51f8fef04171d3a1 commit 004b403d75356e7184c24c6b51f8fef04171d3a1 Author: Jan Holesovsky <> AuthorDate: Fri Dec 13 09:15:11 2013 +0100 Commit: Jan Holesovsky <> CommitDate: Fri Dec 13 13:01:28 2013 +0100 startcenter: Full thumbnail size (256px), upscale if necessary. Change-Id: I8ae72249853a03b1dfca0ecd10eef47e9aa7cbfe:100644 100644 12d300b8bbc9cd20399720e053baf95633f5fb1c ede470279c103eac5ce6a6cf4d4384ba331e7140 M ccache.log:100644 100644 8b4af6d8655bc49024d8a358d094dafb84ec96c6 f12f19b2889099a40c30e520466ff48508db3c2e M commitmsg:100644 100644 0d296e6436e5e802de8c4f20f1f0831416e3e16f 2e5489b0db88575e308918070102ad674013094a M make.log:040000 040000 cfc34e4273fc06efa5eecb27ff9ad21a4e3ecf7e 745d4b4528db21a0a03febba8c159be924265f11 M opt# bad: [423a84c4f7068853974887d98442bc2a2d0cc91b] source-hash-c15927f20d4727c3b8de68497b6949e72f9e6e9e# good: [65fd30f5cb4cdd37995a33420ed8273c0a29bf00] source-hash-d6cde02dbce8c28c6af836e2dc1120f8a6ef9932git bisect start 'latest' 'oldest'# good: [e02439a3d6297a1f5334fa558ddec5ef4212c574] source-hash-6b8393474974d2af7a2cb3c47b3d5c081b550bdbgit bisect good e02439a3d6297a1f5334fa558ddec5ef4212c574# bad: [4850941efe43ae800be5c76e1102ab80ac2c085d] source-hash-980a6e552502f02f12c15bfb1c9f8e6269499f4bgit bisect bad 4850941efe43ae800be5c76e1102ab80ac2c085d# skip: [a043626b542eb8314218d7439534dce2fc325304] source-hash-9379a922c07df3cdb7d567cc88dfaaa39ead3681git bisect skip a043626b542eb8314218d7439534dce2fc325304# skip: [aba65c3e4c0df07e4909aeefb758cdb688242bf6] source-hash-827524abfb4b577d08276fde40929a9adfb7ff1agit bisect skip aba65c3e4c0df07e4909aeefb758cdb688242bf6# good: [c81a8a0dcfc1ed095a80e4485c89dd0fcaf73f31] source-hash-c69ed33628ec0b7abf6296539cf280d6c4265930git bisect good c81a8a0dcfc1ed095a80e4485c89dd0fcaf73f31# good: [30cde618212ecaf5725321372bd1b8339f8e2b9f] source-hash-137f872aa8e6e598e7c7ed1ffa4d21e580e22bdbgit bisect good 30cde618212ecaf5725321372bd1b8339f8e2b9f# bad: [306d62ec4b911895f08f2bb8efefebed7ac795f0] source-hash-735bd120c9ee2d9bb3514907936c27efb75d7282git bisect bad 306d62ec4b911895f08f2bb8efefebed7ac795f0# good: [835ce851abe657bb5a8238693ea924287e6890c0] source-hash-1e53784811458563b36fd4cbaa15c2f526a7161bgit bisect good 835ce851abe657bb5a8238693ea924287e6890c0# good: [7d9e0cb59cf7fe20b31a5c291238b5391834c278] source-hash-c828319753558e25a48ce7808604bcc648f2483dgit bisect good 7d9e0cb59cf7fe20b31a5c291238b5391834c278# bad: [03bcabfd9fda01b23178104f5c1b8e2e0053e6b2] source-hash-007bf2b8c04090920b54e914ac75fc13720b450cgit bisect bad 03bcabfd9fda01b23178104f5c1b8e2e0053e6b2# bad: [ae44e45a06e1e642fc72b259e50e59837a9dda3f] source-hash-004b403d75356e7184c24c6b51f8fef04171d3a1git bisect bad ae44e45a06e1e642fc72b259e50e59837a9dda3f# first bad commit: [ae44e45a06e1e642fc72b259e50e59837a9dda3f] source-hash-004b403d75356e7184c24c6b51f8fef04171d3a1@David: Probably a regression from:commit 735dc598cd38c76aeeaa37df57f1d0018fe294c8Author: David Tardon <>Date: Mon Dec 9 20:11:43 2013 +0100 handle Keynote package format too Change-Id: I3023bcba0a3d3bd83aca56e4ef72a892da5b55cfAny HTML content is mis-detected as "impress_AppleKeynote".David Tardon committed a patch related to this issue.It has been pushed to "master":fdo#81113 always run the actual detectionThe patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.David Tardon committed a patch related to this issue.It has been pushed to "libreoffice-4-3":fdo#81113 always run the actual detectionIt will be available in LibreOffice 4.3.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Verified fixed inVersion: 4.4.0.0.alpha0+Build ID: 461e46904ffa29820be1ccb64cdb9cb6d4469b6cTinderBox: Win-x86@39, Branch:master, Time: 2014-07-17_08:23:11Verified in Version: 4.3.1.0.0+Build ID: 76a4eee58830b7faf4fa0a89e82df36e352d5b06build at home under Ubuntu 14.04 x86-64 Best regards. JBF***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=81351	Createdlinux backtraceWhile working on an ods file in Calc, i selected a few columns and sorted them and when i undid the sort, Calc would crash immediately in 3.6.7 or crash after deselecting the sorted columns by clicking on another cell in 4.2.5, 4.3.1 and master. Steps:1) Open soon to be attached file2) select column A through F3) click the sort ascending button in the toolbar4) deselect the selection5) press ctrl+z to undo6) deselect the selectionObserved: CrashesExpected: Not to CrashI tested this on Windows 7 with 4.2.4 and it didnt crash, so looks like its a linux only issue. :)Createdsample ods fileIt doesn't crash on master, especially afterwhich has reworked the sorting algorithm (and its undo / redo) quite a bit. I bet that change also fixes this problem.Hi Jay, I did not reproduce the crash following your steps. But I do encounter a crash with the following steps:1. Sort the data;2. Undo (from toolbar icon)3. Redo. --> Crash.Ubuntu 14.04 x86, Version 4.3.0.2.Should I report a seperate bug, or my steps are the same as yours?Hi Kevin,Well why not post your backtrace here and the devs can figure it out.(In reply to)Also reproduce the crash follow the above steps, inVersion: 4.3.1.0.0+Build ID: 27fec073a8e78aad1979160bc4c8d9a4aafc3e82TinderBox: Linux-rpm_deb-x86@45-TDF, Branch:libreoffice-4-3, Time: 2014-07-08_16:41:08(In reply to)A build with dbg is 1GB+ large, takes 10+ hours for me to download, so I do not have it now.Maybe I can try to build from source if I have time, but not now.(In reply to)Well, following this comment your build is from 2014-07-08. The commit/rework Kohei is referring to inis about a fix that is in Libreoffice-4-3 branch since 2014-07-15 16:16:01 (GMT) (see)So you might want to retest this using a newer version of Version: 4.3.1.0.0+ (after 2014-07-15 16:16:01 at least :-) ).@Kevin: you mind retesting this?Kind regards,Joren(In reply to)Following my steps in(rather than Jay's steps in),I reproduce the crash in:Version 4.2.6.1Build ID: 5fdddf655fba363e34f755715238d0943a44857eWindows XP SP3I do not reproduce the crash in:Version: 4.3.1.0.0+Build ID: 5536b127a105123de6f64dcf8f53dfa277faef3cTinderBox: Win-x86@42, Branch:libreoffice-4-3, Time: 2014-07-16_10:15:31So, Kohei must be right.However, Jay says he encounter crash with different steps, and stated it does not crash in Windows 7.@Jay do you have a chance to confirm with the 2014-07-16 build?Sorry for making this bug too complex, but I commented different steps to reproduce crash than what Jay originally reported.I can confirm that my steps are resolved in 4.3.1+, but I am not sure whether Jay's steps are resolved also.So maybe it's too early to mark this as FIXED?Right, lets mark it as NEEDINFO until Jay retest it :-). Sorry about the mistakeCreatedlinux backtrace from 4.2.7Doesnt crash in the latest 4.3.1 but still crashes in the lastest 4.2.7.Tests following the steps by Jay:No crash for me in Version: 4.2.6.0.0+Build ID: 11d6ae6df8dfff1db182ac455d4abcaf7c18ded1 build at home under Ubuntu 14.04But crash if I make a redo after step 6No crash in version 4.3.1.0.0+ Build ID: 6ace1e560373284a116c645bca82ff78ef112576 build at home under Ubuntu 14.04 x86-64No crash even if I make a redo after step 6.Best regards. JBFHi JBF,Well i'm using the official tinderbox builds on Linux Mint 13 (ubuntu 12.04). I'm assuming that if someone looks into the backtrace, they could find out what is going wrong.Hi, Version: 4.3.0.4Build ID: 62ad5818884a2fc2e5780dd45466868d41009ec on Mac Os X If you delete the contents of a cell to which another cell is linked (either = to or part of a formula) and you then undo the delete linked cells are not updated.(In reply to)It appears that the Recalculate cell is not working - if you save and re-open it then corrects itself.Seems like it has been fixed.Version: 4.2.7.0.0+Build ID: c46620ffd96638377018e6da0d31c46c4b4d3016TinderBox: Linux-rpm_deb-x86@45-TDF, Branch:libreoffice-4-2, Time: 2014-08-29_05:39:56Migrating Whiteboard tags to Keywords: (BibisectRequest)[NinjaEdit]
id=81511	Problem description: Steps to reproduce:1. download 4.3.0.3 and install 2. open spreadsheet 3. test spellingCurrent behavior:all words marked as suspect and needed to be added to dictionaryExpected behavior: Operating System: Windows (other)Version: 4.3.0.2 rc Confirmed:Windows 7LibreOffice 4.3.0.3 rc, default English language installNote: Works fine in 4.3.0 beta1Critical - major feature not working at allHighestMABSee also:- VIEWING EDITING: spellchecker works wrong if there are Cyrillic symbols in the path to Libre folderand duplicates- SPELL: Spelling dictionaries not working- EDITING: Spell Checker not working in Writer 4.3.0.3 (Win8) - Underlines everything!this looks like a stopper issue.IMHO we cannot release 4.3.0 with this bug unfixedWait, this looks to have been caused withjust before 4.3.0.3 was buttoned up.And, looks to have been corrected already with@László, could you confirm that please.On Windows 7 sp1, 64-bit, en-US withVersion: 4.3.1.0.0+Build ID: 0ad283adb51b3a1bb777e6341e61541d4bffaa44TinderBox: Win-x86@42, Branch:libreoffice-4-3, Time: 2014-07-21_07:26:59it seems OK without all words highlighted, but no dictionary's to work against with this TB build.So, with a 4.3.0.4 re-roll, should be good.(In reply to)I think an RC4 is needed... are developers aware of this?(In reply to)Yes, it's fixed now but I don't see the fix on libreoffice-4-3-0 branch, only on libreoffice-4-3. I don't think it's a show stopper, in fact there may be quite a few MABs in a .0 release. Nobody expects a perfect release. It is worth mentioning in the release notes that LibreOffice will not find its spellchecker dictionaries on Windows, and 4.3.1 will have a fix a month later. FYI on libreoffice-4-3 branch, it went wrong with 5536b127a105123de6f64dcf8f53dfa277faef3c.Fixes are: 24e9950f68ca57c454dbb35cf8562d82e76a42e7 and 0ad283adb51b3a1bb777e6341e61541d4bffaa44(In reply to)Ok, but the lack of a dictionary is a quite striking flaw that every user will notice as soon as it starts typing... it's a major feature lije Joel pointed out.unfortunately a lot of people do not read release notes.prepare to see a lot of complains and critics about this.I still think that we should post-pone the 4.3.0 release of a few days and integrate that fix of the 4.3.1 inside the 4.3.0for the reputation of LibO it would be better to wait one week more for 4.3.0 instead of releasing a version that will look so uncomplete and unprofessional.just my 2 cents. please discuss these with other devs and QA guys.I have to agree with Tommy and suggest that this is a major blocker, normally .1 release will fix trivial issues and improvements to the (new) feature set, whereas a broken spell check (element that was working well before) will affect all users and in my opinion represents a significant application failure. As a fix exists, surely this is worth putting into an RC4 before public release.always think about first time users... people who's using LibO for the very first time... the first impact with a non functioning spellchecker which is a basic feature of any word processor could be detrimental for LibO reputation.***has been marked as a duplicate of this bug. ***For 4.3.0 see:ESC decided that there will be RC4 (at least on Windows, which is affected by the bug).Verified (on Windows 7 64-bit) withLibreOffice 4.3.0.4Build ID: 62ad5818884a2fc2e5780dd45466868d41009ec0.
id=81396	Open a spreadsheet and create two columns of data. Plot the data on a line chart. Annotate chart. Plot is visible and annotations including axis and grid settings are working. Save and close sheet. Re open sheet. When loaded the chart and data and grid and annotations are present but the plot is not visible on the grid. Only one point is visible and is the last data point on the columns of data. Using MS office open and save formats (xlsx in this case). Have not tried native format.Also picking a file to open from a file explorer list always opens the libra office file behind the file explorer window which is annoying. Using:Win 7 x64Core i5All updates for win 7 installed.version 4.2.5.2 just installed. Createdtest ods file with chartHi Tom,when I plot a line chart and save as XLSX, the plots are not missing, but the plot color are changed.Steps to observe:1. Save the attached ods file to XLSX.So: please confirm whether the plots are missing, or the plots color are changed (to white?) so that you can not see them.#1Open test chart.ods file.Plot shows diamonds as orange and squares as dark blue.Save as MS XLSx.Open xlsx file and plots are rendered in light blue for both plots not orange and dark blue as before.#2Open Test chart.ods file.Change plot to connect dots.Save as ms xlsx. Won't let me save. xlsx and other forms not on pick list. Had to save ods, close ods and reopen then save to xlsx.Open xlsx file and find no change to plots. Colors as in ods and dots connected.In my file I am plotting one column of data against another column not against the cell number as you show in the test file. In my case the plot is gone except for one dot which is the last data point in the two columns. I moved the mouse around hoping to hit another data point in case it was white but no go. Opening the data series format dialog shows the original dark blue color so it has not changed. There seem to be several bugs causing multiple but similar behavior.-Tom S.On 7/15/2014 9:32 PM,wrote:>>>>>>Tom, please attache an (ods) file from which we can reproduce the data series lost issue. I am not able to repro from scratch.PS. next time you make comments in this bug, please do it directly from the webpage, replying from email will add unwanted information to bugzilla.Thanks.(In reply to)I do not confirm this. XLSX is in the pick list. Are you sure you are saving using libreoffice, not Apache OpenOffice? (AOO do not have xlsx in the list).Createdtest ods fileTom has send me a test file. Based on his file, I can now confirm this critical bug.Steps to reproduce:1. Save the attached test ods file as xlsx;2. Reopen the xlsx file in libreoffice.Current Behaviour:All plots are not shown, except the one plot which has no formula in it's cell.A CTRL+SHIFT+F9 will bring all plots back again.The exported xlsx file opens fine in MSO 2010, so this is an XLSX IMPORT problem.This affects all chart types.Reproducibe with:Version: 4.3.1.0.0+, Build ID: 5536b127a105123de6f64dcf8f53dfa277faef3c, TinderBox: Win-x86@42, Branch:libreoffice-4-3, Time: 2014-07-16_10:15:31and 4.2.6.1, Build ID: 5fdddf655fba363e34f755715238d0943a44857eWindows XP SP3.The exported xlsx file opens file in Apache OpenOffice 4.2. It's a possible regression.Createdthe exported XLSX file(In reply to)Tested with attached file, Also confirm that hard recalc needed in: 4.1.6.2, 4.0.6.2 Not reproduced in: 3.6.7.2 (plot & line still exists, but charts slightly stretched after saving)IF reproduce from scratch with XY chart, Hard recalc not resolved the issue in: 4.1.6.2, 4.0.6.2, 3.6.7.2Issue solved with hard recalc in: 4.2.6.1Plot & line still exist in 3.6.7.2 with attached file, but missing if reproduce from scratch. Perhaps not a regression.Tested under Ubuntu 12.04 x86With 4.2.5.2 changing the option in:Menu/Tools/Options/LibreOffice calc/Formula - Recalculation on file load Excel 2077 and newer to always recalculate, do the job.Works for me with:Win7x64Version: 4.4.0.0.alpha0+ Build ID: 32551a546c83874f08aba9c0adb7a38230fa2e36 TinderBox: Win-x86@39, Branch:master, Time: 2014-07-19_07:47:52I think this option was implemented to reduce the loading time with large files. Hard recalc is an usual action in calc, in fact some functions need it to be recalculated.OTH, It's not too much clear for me why this one is in MAB, I think we need to be more strict about that, not the first developer commenting about he doesn't take too much care on MABs. I think the problem now is how to find the patch to ask the dev for backport at least to 4.3Yes if we set "Always Recalculate" to Excel 2007 and newer, it works as expected.Confirmed in 4.3.0.3 and 4.2.6.1But I think not many users know about this, maybe some notice in release notes or documentation would be helpful to many users.(In reply to)Yes this is true, but it's only a workaround.I am not sure what you mean by "works for me". Does the chart loaded with all plots shown correctly when you open with 4.4.0.0.alpha0+?I tried with 4.4.0.0.alpha0+ TinderBox: Win-x86@42, Branch:master, Time: 2014-07-21_06:04:54, it's the same bug behaviour.Under "Menu/Tools/Options/LibreOffice calc/Formula - Recalculation on file load", it's also set as "Never" for ODS format, but chart loads OK in ODS file.I think it may be related.It's OK to implement sth to speedup the loading of xlsx file, but should make sure that what we see are corroct. (For this case, the chart shown is totally wrong!)As a normal user, they should never know this. I even do not know the "CTRL+SHIFT+F9" feature before I come to bugzilla and find it in the bug reports in which someone tells to "Hard Recalc". Also, Hald Recalc is not on the UI "Tools - Cell Contents". What a normal user may find is to use the "Recalculate" submenu, but that does not solve the problem.Just like Tom S. who reported this bug, he did not find the reason why his chart is showing only one plot. He must have tried his best to find a solution, but did not find it. I then got his test file, and spent 2 hours and finally find out the reason.If his speadsheet has formulas in all the cells, there would be not even one plot shown, which will be even harder to find the reason. See also this one in our Chinese libreoffice discuss forum:It's still reproducible in daily builds, so no patch.(In reply to)I mean, this "XLSX: always recalculate" option is not selected by default in a fresh user profile.By defalut, "ODS" is also set to "Never recalculate", but shows correct chart when load.CreatedConfiguration that makes it works. registrymodifications.xcuInvestigating a bit, I have found that with 4.4 works for me with the attached configuration file (in the root profile directory), and with a resetting of the user profile not without change the option or with a hard recalc.But I'm not able to find which option is different in Menu/Tools/Options with this file, perhaps a hidden option makes the difference.Maybe someone is able to find what it's the option making the difference with the attached file.still reproducible under Win8.1 using 4.5.0.0.alpha0+Build ID: 84a6d8eeaab540e5b2ea3baffd919903dff8c247TinderBox: Win-x86@39, Branch:master, Time: 2014-11-22_23:41:04Locale: it_ITmoving to mab4.3 list since 4.2.x is end of lifeMost likely the fix inis correct. Actually I fixed the same problem in the past already.Markus Mohrhard committed a patch related to this issue.It has been pushed to "master":the cells need to be imported before we handle charts, tdf#81396It will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Bug fixed with:Version: 5.1.0.0.alpha1+Build ID: 229583f298b9de05e1ad1727e233d597995099e3-GLTinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-11-22_23:09:05Locale: fr-FR (fr_FR)Thanks Markus :)Migrating Whiteboard tags to Keywords: (possibleRegression)[NinjaEdit]
id=81617	CreatedbugdocSteps to reproduce:1/ open the attached bugdoc2/ select rows 2 to 43/ click on the button "Sort ascending"LO 4.3.1.0.0+ crashes by segmentation fault. Backtrace follows.Best regards. JBF Createdbacktrace of the crashCannot reproduce with LO 4.3RC3 OS X 10.9.4cannot reproduce with Ubuntu 14.04 LO 4.2.5.2so adding regression, but we need someone with LO 4.3 to confirm.Missed to add the build ID of my 4.3.1.0.0+ : Build ID: f6445efb0e5c3de099f0425825fe1e6e8271dfb9Clean build (make distclean > ./autogen.sh > make) on Ubuntu 14.04 x86-64I guess the crash is linked to the fix forwhich, if I am not wrong, is not in LO 4.3.0.3.Best regards. JBFTested on openSUSE with 4.3.0.3 (RC3), cannot reproduce the crash.Confirmed:Ubuntu 14.04 x64LibreOffice 4.4 built: Mon Jul 21 13:38:10 2014 -0400Priority:NewCritical - crasher with relatively common steps (just a sort) + regressionHighest - regression on a crasher that likely will affect many usersMAB 4.3This bug now affects 4.2.7.0.0+ Build ID: f5949d09321e3ac62538df0e70e58284bd1cab32 since the backport of fix for. Best regards. JBF@JBF - why did you lower severity/priority and change back to x64? :-DSet version number to unspecified because it affects development versions of each branch 4.2, 4.3 and master.Version: 4.2.7.0.0+ Build ID: f5949d09321e3ac62538df0e70e58284bd1cab32Version: 4.3.1.0.0+ Build ID: f6445efb0e5c3de099f0425825fe1e6e8271dfb9Master : seeBest regards. JBFAfter discussion on IRC, master is a better version number here.Best regards. JBF(In reply to)Probably I did not update the webpage before adding a new comment. Set back as you did.Best regards.JBFKohei/Markus/Eike: one for you? bt shows mdds partReverting "fdo#81309: Adjust references during sort."on version 4.3.1.0.0+ (build ID: f6445efb0e5c3de099f0425825fe1e6e8271dfb9) under Ubuntu 14.04 x86-64 solves the problem for me.Best regards. JBFFYI I'm very overloaded with customer bugs at the moment and there is no end in sight. I'll try to find time during some of my weekend time, but please be very very patient.(In reply to)Julien, seeing mdds doesn't mean the problem is in the mdds, just like seeing stl in the stacktrace doesn't mean it's a bug in STL. So many folks make this incorrect assumption in so many bug reports it's starting to get to me a bit.Kohei: Ok, sorry for this, I'll try to keep this in mind :-)Createdbt with master sourcesOn pc Debian x86-64 with master sources updated yesterday (+dbg enabled), I could reproduce the crash (the bt is quite different from the existing one).Just before advance instruction, I displayed the value of nLenght2, it was:-1717986910 (!)(whereas distance with end iterator = 10)I had tried another time and had another value.It could be due to something not initialized.I'll take this.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#81617: Write test for this first.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#81617: Split formula groups at sort range boundaries.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Fixed on master. Luckily it was an easy fix.With master sources updated to include the patch, I don't reproduce the bug.Thank you Kohei!Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#81617: Split formula groups at sort range boundaries.It will be available in LibreOffice 4.2.7.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-3":fdo#81617: Split formula groups at sort range boundaries.It will be available in LibreOffice 4.3.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=81806	CreatedWriter document which demonstrates the crashPaste/undo actions in tables with merged cells cause document corruption and crashesObserved on OSX with LO 4.2.5.2. Other platforms unknownSteps to reproduce1. Load the attached Writer document(which contains a 3x3 table in which A2:A3 and B2:C2 are merged cells, and the letters "a" "b" and "c" are placed in cells C1, B2 and C3 respectively)2. Select and cut the range C1:C3 (the three cells containing the "a" "b" and "c")3. Place the cursor in cell B24. Repeatedly paste then undoResultDespite the fact that the selection is unchanged, and the cursor is not moved, the three charaters are placed differently in each paste-undo cycle. After a couple of cycles, the table structure is corrupted and LO crashes CreatedCrash dumpStill occurs in 4.3.0.4 releaseDear Matthew,Thank you for submitting the bug. I can confirm that the bug is available in 3.3.0, 3.6.7, 4.2.5, and 4.3.1. It will crash between 2 to 4 paste and undo cycles.Createdlinux backtrace(This is an automated message.)LibreOffice development currently prioritizes bugs with the so called MAB (most annoying bugs) -- as this bug has not run through that process (including writing a short rationale for this bug being a candidate and other who are watching the tracker bug silently approving that rationale etc.) its priority is set to high. Note this is effectively no change in the urgency assigned to this bug, as we are currently not making a difference between high and highest and severity is untouched.You can find out more about MABs and how the process works by contacting libreoffice qa on irc:The QA wiki page also gives you hints on how to get in contact with the team (if IRC fails you, your next best choice is the mailing list):CreatedLinux dbg bt of TB45 dbg build with symbols and source refsBacktrace with recent 32-bit Linux TB45-debug buildOn Fedora 20, 32-bit en-US with debug buildVersion: 4.4.0.0.alpha1+Build ID: d59b9b4af36148e4d8df8f3e3492116d378642e2TinderBox: Linux-rpm_deb-x86@45-TDF-dbg, Branch:master, Time: 2014-11-06_03:11:43SIGABRT crash, assertion while finding pointer positionpBlock->pData[ nOffset... BigPtrEntry::GetPos()You can reproduce the basic issue with an even simpler document:1. Insert Table with 2 columns, 1 row2. Type a in column 1, b in column 23. Highlight and cut4. GO to column2, paste (note how it just shows a5. Undo6. Paste again (now it shows a and b!)This simple case doesn't seem to crash, but does likely show the underlying bug. A similar issue happens if you do 1 column, 2 rows. The first paste adds a new row. The undo removes it and then a and b are both pasted in the same 2nd row.***has been marked as a duplicate of this bug. ***(This is an automated message.)Setting priority to highest as this is a MAB. This is part of an effort to make the importance of MAB reflected in priority too.issue remains with 4.3 and 4.4 builds. Moving to mab4.3try that with the correct bug id for mab4.3What I see is that undo always leaves a pam that points to the start of the undone area and a mark to the end of the undone area, even if that area is empty. (In the normal where there is a selection this can be seen by selecting something, deleting it, and undoing and the newly undeleted stuff is again selected)The table overwrite/paste thing looks to see if a mark is set and goes off to "do something very complex" if its set. So if after each undo cycle, you physically click at the point where the cursor is flashing (which clears the mark) and then paste, undo, *click*, paste you get a wonderfully stable experience.So it seems reasonable to me to "do the simple thing" if there is no mark, or if the mark and point are the same, i.e. there is nothing actually selected by the PaM.Caolán McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: tdf#81806 crash on certain table paste+undo+page cyclesIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-5-0":Resolves: tdf#81806 crash on certain table paste+undo+page cyclesIt will be available in 5.0.0.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-4":Resolves: tdf#81806 crash on certain table paste+undo+page cyclesIt will be available in 4.4.5.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=82042	CreatedDemo spreadsheetProblem description: Moving a column corrupts the screen; pressing control-Z to un-do the move crashes the processSteps to reproduce:1. Open the attached "crasher.ods" spreadsheet2. Click in column I header to select entire column I3. Click on in cell I8 (or any cell in col I), drag to col G & release the mouse(screen corrupted at this point)4. Type Control-ZCurrent behavior: crash (probably segfault)Expected behavior: column copy works, and LO doesn't crashNote: This demo spreadsheet contains spanned columns, but not involving the area being moved. I tried constructing a simpler demo spreadsheet and the problem does not appear, so the crash may be related to the spanned cells. Operating System: UbuntuVersion: 4.4.0.0.alpha0+ Master Bug observed running Version: 4.3.1.0.0+Build ID: 0ad283adb51b3a1bb777e6341e61541d4bffaa44TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:libreoffice-4-3, Time: 2014-07-21_07:30:30Test System:Kubuntu 14.04 (KDE 4.13.2)LibreOffice 4.2.4.2- When I open the file, column G is wide.- When I drag column I over, column G takes the width of column I (is that corrupted?)- Ctrl+Z does crash the application, though I can drag the column G data back to column I successfully before trying Ctrl+G.Have elevated to high/major because of crash.The "corruption" seen on my system is as if column I is rendered narrower than usual (showing truncated original content), plus an "extra" column squished in and the edges of the columns no longer align with the edges of the column labels.I'll attach a brief (about 10 second) video showing how it looks on my system.Createdvideo screen-capture showing corrupted rendering (mp4)I can reproduce crash with LO 4.2.6.2 - Ubuntu 12.04 x86 without rendering corruption.Found that problem is with SUMIF function.Steps to reproduce from scratch:1. In new spreadsheet, in cell A1 type: =SUMIF(B1:B2;1)2. Click column B header to select entire column B3. Click on in any cell in column B, drag to column C & release the mouse4. UndoNot tested yet with similar function like SUMIFS or SUMPRODUCT(In reply to)Another variations of step 1 to reproduce crash: - in cell A1 type one of the following: =SUM(B1:C1) =SUM(B1:B2) =COUNTBLANK(B1:B2) =AVERAGE(B1:B2)- in cell B3 type =SUM(B1:B2) Seems reproducible with all functions which has range.Also reproduced in:Version: 4.2.7.0.0+Build ID: 546cd96371b5ae012e4f3bfe963ea299e1dcec54TinderBox: Linux-rpm_deb-x86@45-TDF, Branch:libreoffice-4-2, Time: 2014-07-30_13:16:10No crash in 4.1.6.2 -> regressionCreatedbt with master sourcesOn pc Debian x86-64 with master sources updated today, I could reproduce this.I attached a bt.bibisected:bbc3e332548c8e2aa5648ca68a69e713cbf21580 is the first bad commitcommit bbc3e332548c8e2aa5648ca68a69e713cbf21580Author: Bjoern Michaelsen <>Date: Mon May 12 00:14:14 2014 +0000 source-hash-fa40f7df971b1aaabccc11668a987336f50e3b0d commit fa40f7df971b1aaabccc11668a987336f50e3b0d Author: Miklos Vajna <> AuthorDate: Sat Mar 15 17:36:49 2014 +0100 Commit: Miklos Vajna <> CommitDate: Sat Mar 15 17:40:46 2014 +0100 rtftok: OPEN_M_TOKEN -> RTFTokenizer::lookupMathKeyword() Change-Id: I60d0e65d0e7f37b2d5cded64cee1270c51ed5b3d:100644 100644 22186839f42f5d422f85906177e65a5a86aab3c6 67cf4d993a8880c8e558da6b353cea364e230330 M ccache.log:100644 100644 2a2fa2a93aeee93d774a245fa6928cd0f71ee7b4 1b45c18989cb85a070dde3282d4d88c740b546fa M commitmsg:100644 100644 32730498dfcfe90ba8e20e3de525cf584f324c8b fa3e2cdec7e5f609dddff4d1452f663a2fca7ebe M make.log:040000 040000 c6cc4459e2dbc27c9c690bdb7289682a4d54260b 834530fad4ed019169a143c964faa33bf7cd7032 M opt# bad: [423a84c4f7068853974887d98442bc2a2d0cc91b] source-hash-c15927f20d4727c3b8de68497b6949e72f9e6e9e# good: [65fd30f5cb4cdd37995a33420ed8273c0a29bf00] source-hash-d6cde02dbce8c28c6af836e2dc1120f8a6ef9932git bisect start 'latest' 'oldest'# good: [e02439a3d6297a1f5334fa558ddec5ef4212c574] source-hash-6b8393474974d2af7a2cb3c47b3d5c081b550bdbgit bisect good e02439a3d6297a1f5334fa558ddec5ef4212c574# good: [4850941efe43ae800be5c76e1102ab80ac2c085d] source-hash-980a6e552502f02f12c15bfb1c9f8e6269499f4bgit bisect good 4850941efe43ae800be5c76e1102ab80ac2c085d# good: [a900e72b6357882284c5955bdf939bf14269f5fb] source-hash-dd1050b182260a26a1d0ba6d0ef3a6fecc3f4e07git bisect good a900e72b6357882284c5955bdf939bf14269f5fb# skip: [e80660c5a1d812cd04586dae1f22767fc3778c4a] source-hash-07c60c8ee2d1465544a6a39e57bc06b3690b8dfbgit bisect skip e80660c5a1d812cd04586dae1f22767fc3778c4a# bad: [df9bcaed2faa2a8d11b19f877cdff3a12a887278] source-hash-6ba9692d8bbe3e3c245aca9a7c928e81178d05f1git bisect bad df9bcaed2faa2a8d11b19f877cdff3a12a887278# bad: [9d57c189d74551d2b3770cc81139ea10a62e672f] source-hash-5b5e62650354788e50b44f32c22b687b2018aba9git bisect bad 9d57c189d74551d2b3770cc81139ea10a62e672f# bad: [ce81582766413e76a63c047bfd6227ab12fcd866] source-hash-3d1b1eea83703919c43620f9adef05e5b24c4bedgit bisect bad ce81582766413e76a63c047bfd6227ab12fcd866# good: [4e0843c411a14e3065f96f196eeb4d603664f97f] source-hash-51605bf98220d7e54dee20af17c33cebe23a0813git bisect good 4e0843c411a14e3065f96f196eeb4d603664f97f# bad: [bfba063779a12bca219e4a9fba9bba8b67821ec1] source-hash-86a32589e90ee983159fb5b2c6a594428ab7d422git bisect bad bfba063779a12bca219e4a9fba9bba8b67821ec1# bad: [ba00e7cba37a309a8eed876fe76a0286a8898174] source-hash-1eb20c97e4d0f644efcf46aedac619a9765488c3git bisect bad ba00e7cba37a309a8eed876fe76a0286a8898174# bad: [bbc3e332548c8e2aa5648ca68a69e713cbf21580] source-hash-fa40f7df971b1aaabccc11668a987336f50e3b0dgit bisect bad bbc3e332548c8e2aa5648ca68a69e713cbf21580# first bad commit: [bbc3e332548c8e2aa5648ca68a69e713cbf21580] source-hash-fa40f7df971b1aaabccc11668a987336f50e3b0dReproducible with Version: 4.4.0.0.alpha0+Build ID: 8957c9419af8a1bc56b7e6cb248dc3fd57708589TinderBox: Win-x86@42, Branch:master, Time: 2014-08-19_05:34:52***has been marked as a duplicate of this bug. ***CreatedSimple SampleThis simple sample shows that the crash also will appear for an UNDO of moveing a cells range not touching formula's range and without any contents:In Simple Sample 1. Select range I9:M192. Click I9, Drag and Drop Range, release mouse button in O93. UNDO -> Crash (90% reproducible)Good catch Bugcruncher.. I can also reproduce that with moving column D (which is not referenced to formula in A1) to column E on step 2-3 in.Reproduced either with moving column A (which contain the formula) to column C.Tested with LO 4.3.1.1 - Ubuntu 12.04 x86 I think we should raise importance since it's also reproduced with moving any column/row.@Ign - when you raise something to highest please add to the MAB list tracker and leave a comment on the tracker saying why you added it. highest is reserved exclusively for MAB :)Thanks!Done Joel.. :)The latest master branch no longer reproduces, which has a very similar backtrace to this one. Can someone please try to reproduce this using the latest master that contains?Thanks.I do confirm that the crash isn't reproducible with a build from 527462c2fe9c21e567a9c49f2d63be5a08f7a91c but it's reproducible with a build from 8e4defe4b59a72fbe82f94b26e233ba36640c739Excellent! That commit has been backported to 4.2 and 4.3 branches, so the fix should appear in their next respective release.Let's add the targets from fdo#79441 (as indicated in the commit quoteed)Wow..thanks all.. That commit could saves many peoples life :)Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=82367	CreatedThis is the LibreOffice 4.2.6 and 4.3.0 Save as... window, no options under field "Name", cant save anything.Sorry for my English is not my native language. I just upgraded LibreOffice version 4.1.6 to 4.2.6 on Win XP and there is problems with the Save As... window. I cant save any document in any application (Writer, Calc, Draw...). Under the "Name" field does not appear anything. All window behaviour is erratic. This problem also appears in version 4.3.0. Default profile used after installation. Previous version uninstalled and registry cleaned. No problems on LibreOffice 4.1.6.Attachment images with the problem. CreatedThis is the LibreOffice 4.2.6 and 4.3.0 Save as... window, no options under field "Name", cant save anything.Sorry this is the correct attachment with the image inside (first time I fill a possible bug).CreatedLibreOffice 4.1.6 Save as... window, all is ok.This is the Save as... window of LibreOffice 4.1.6, I can save all my documents with the desired options.On Win7 with LO 4.2.6, I don't reproduce this.When saying "Default profile used", you mean you use a brand new LO profile? (see)I can NOT confirm this bug. For me it works fine with Hungarian locals.Windows XP SP2LO: 4.2.6.2 Build id.: 185f2ce4dcc34af9bd97dec29e6d42c39557298f(In reply to)To explain better I will discuss the steps that I followed. To use LibreOffice 4.2.6 I did a full uninstall of previous LibreOffice 4.1.6 with Revo Uninstaller and I cleaned the registry of bad entries with CCleaner. Then I deleted the entire LibreOffice folder of Program Files (if exist) and the folder Libreoffice on \Documents and Setting\<user name>\Application Data\libreoffice.I do a custom install of LibreOffice 4.2.6 only with Spanish user interface and spanish dictionary the rest of the elements are disabled. When the installation finish I run Writer, it start windowed, and LibreOffice creates its own LibreOffice folder (this is the default profile that I referred) on \Documents and Setting\<user name>\Application Data\ with default options after installation.Every works properly but when I'm going to save my document the Save as... window appears as in the image attached. No options under Name, the save and cancel button does not respond, I can only close that window by clicking the x in the upper right corner.If I uninstall version 4.2.6 and install the 4.1.6 whit same custom install options everything works correctly.CreatedSame problems opening somethingI tried doing a fresh FULL install of LibreOffice 4.2.6, not only I can not save a document but I can not open or export, I have the same problem. I did not realize before because I just tried to write something and save it.Again if I go back to version 4.1.6 I have no problem. I will try to install it on another PC and if the problem disappears I have to stay with version 4.1.6. I've been using LibreOffice since it was born and so far I have not had any problem with it. It's weird.LibreOffice 4.2.6.2Id. de compilación: 185f2ce4dcc34af9bd97dec29e6d42c39557298fMD5: 3477D936CA4A5A8DD6A4BE79A2FB4FE5SHA1: 1DA5FB126C2251736BFEDD4721E3010B05AF3F99*** This bug has been marked as a duplicate of***
id=82554	libreoffice will creat a thumbnail when open a encrypted file,the thumbnail is large enough to check the thumbnail's content,so the encrypted file will leak it's message.So,i think libreoffice shouldn't creat encrypted file's thumbnail . I always save my passwords in encrypted ODS files,so i think it's a big bug.*** This bug has been marked as a duplicate of***
id=83016	CreatedText Grid tab in 4.3.0In the 4.3.0 release, the page style dialog had a 'Text Grid' tab that isnt available in the 4.3.2 or master releases. Was this removed on purpose.Steps:1) Open writer2) Right-click > Page... Just confirmed this doesnt effect 4.3.1.1.If a bug affects 4.3.0 but not 4.3.1, then why did you file it, when 4.3.0 is already released and no changes can be made to it (because time can’t be reversed)? 4.3.1 is the next bugfix release.Or am I missing something?The bug effect 4.3.2 and master and is correct in 4.3.0 and 4.3.1.1. :)Hi Jay,This tab depends on the Asian languages support (Tools->Options...->Language Settings), so make sure you have this turned on.Hi Maxim,Yep you are right i didnt have asian language turned on in the options. sorry about that. :)
id=81125	...inputfn=sys.stdin.buffer.read() inputStream = self.svcmgr.createInstanceWithContext("com.sun.star.io.SequenceInputStream", self.context)inputStream.initialize((uno.ByteSequence(inputfn),))document = self.desktop.loadComponentFromURL("private:stream", "_blank", 0, UnoProps(Hidden=True, ReadOnly=True, InputStream=inputStream)...# at this point document is `None'. So the following code throws AttributeErrordocument.storeToURL(outputurl, tuple(outputprops))=> AttributeError: 'NoneType' object has no attribute 'storeToURL'This worked fine in 4.2 Createdloading a document via private:streamWe have the same problem!It's easy to verify. In LibreOffice SDK in the OfficeBean project part, there is a small test class loading an empty writer document: "bean/test/Test.java"Please change the code which is loading the document from:b.loadFromURL("private:factory/swriter", null);to java.io.FileInputStream fis = new java.io.FileInputStream( "/temp/test.odt");b.loadFromStream( fis, null );I have attached the full java class for convenience. Create a test document of your choice in "/temp/test.odt", run the test and see it fail. The returned XComponent is null!We have an application in healthcare business with ~5000 daily users. Please help! They can't work with LO now!@Kelvin: I'm able to reproduce this with 4.3.0.4 but not with 4.3.1.0.0+ from 2014-08-02_22:03:26, so I'm closing this bug as WORKSFORME. I suspect it's related towhich was fixed recently. Please test with a recent dev build, and feel free to reopen the bug in case it didn't fix your problem (preferably set the status to UNCONFIRMED).@Stephan: Your Java code works perfectly for me with 4.3.0.4 under Fedora 20. Anyway it doesn't seem to be related to the original bug, so if you still have this problem please open a separate report. Thanks!Hi Maxim, I tested it only with Windows. I will download the latest nightly build and if that won't work, I check it on Linux. ThxI installed nightly build from 2nd August 4.3.1.0.0 on my Windows Machine and it works! I uninstalled this version and tried the current release 4.3.0.4 and it fails again! There is definitly a bug in the current version.I (and my users) can wait for 4.3.1 release - everything is fine for me!
id=83084	Observed on OSX 10.9.4 / 4.4 master (310a852e012ecfc10e813bea64438c1a862bb2c0):Steps to reproduce1. Create a blank presentation2. Click on "Slide Show - Start from first Slide"It will then die with the attached backtrace.There is also some debug output about corrupt OpenGL vertex shaders - also attached.Not yet tested on other platforms. CreatedBacktrace (4.4 master)CreatedDebug outputnot reproducible under Win7x64 using 4.4.0.0.alpha0+Build ID: f4246fab77113147b36706a1f3d93e8724ff826bTinderBox: Win-x86@42, Branch:master, Time: 2014-08-23_03:27:09Put it at NEW since there's a bt.Markus/Zolnai: looking at git history searching from OGL, I thought you might be interested in this one.It is fixed already in my OSX branch. I might need to backport some of these fixes to master to prevent some problems.We are using the OpenGL canvas because the ones in the list before it are not implemented on OSX.This only affects OSX. On Linux we use the cairo backend and on Windows the DX9 backend.Markus Mohrhard committed a patch related to this issue.It has been pushed to "master":avoid picking the incomplete OGL canvas, fdo#83084The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Just picked the commit from my feature/mac-opengl-fixes branch. That should fix your issue.Thanks for the help. That did indeed do the trick, and allowed me to get on with reproducing the bug I was actually trying to reach :)
id=83174	CreatedSample DocumentProblem description: Many of my documents crash when I try to send the document as PDF. No Crash with PDF export.Crash vanishes with Rightclick ► Update TOCMight be related to- EDITING: CRASH when "select all" on page with picture or object anchored to page I did not test other 4.4 versionsSteps to reproduce:1. Open Sample Document (attachment)2. Menu {File ► Send ► E+mail as PDF ► only page 1 ► Send} » CRASH Operating System: Windows 7Version: 4.4.0.0.alpha0+ MasterLast worked in: 4.2.6.2 release Tested with Windows 7 x64 with Version: 4.4.0.0.alpha0+ Build ID: 5ef4bdc7b15686e55fa19f2e98a828763a0cfae6 TinderBox: Win-x86@42, Branch:master, Time: 2014-09-03_10:10:14. Could reproduce the bugIf you remove the section it will workConfirmed regression - marking asMajor - crasher but kind of a corner case (not going to affect the vast majority of users)Highest - regression + crasherI cannot reproduce this failure. Tried on both Linux and Windows, on debug build, on: 9aad656156fbf76288e8a281760e60f1eccc6622 .On pc Debian x86-64 with master sources updated yesterday, I don't reproduce the crash but noticed these console logs:warn:sfx.dialog:4061:1:sfx2/source/dialog/tabdlg.cxx:852: CreateInputItemSet not implementedwarn:sfx.dialog:4061:1:sfx2/source/dialog/tabdlg.cxx:852: CreateInputItemSet not implementedwarn:sfx.dialog:4061:1:sfx2/source/dialog/tabdlg.cxx:852: CreateInputItemSet not implementedwarn:sfx.dialog:4061:1:sfx2/source/dialog/tabdlg.cxx:852: CreateInputItemSet not implementedwarn:sfx.dialog:4061:1:sfx2/source/dialog/tabdlg.cxx:852: CreateInputItemSet not implemented(process:4136): GLib-CRITICAL **: g_slice_set_config: assertion 'sys_page_size == 0' failedcrash was fixed by commit 99cd15fa238886d23bdc429dc1133157d799487a*** This bug has been marked as a duplicate of***
id=81233	I just lost a document to the Cut / Paste feature not working after closing Libre Office Writer 4.2.5 RC2.In LibreOffice Writer hit Ctrl+X on some text, close the program and then attempt to paste to Google Docs or another program.My clipboard is cleared. If I didn't save my document (which I didn't) - my text in the clipboard is completly wiped out.This is a _extreemly_ critical bug for _all_ users as it diminishes functionality. Dear elecricprism,Thank you for reporting. This is a problem with the Linux clipboard system and has been reported before and its hoped that it will be fixed.*** This bug has been marked as a duplicate of***May I suggest that LO checks whether the Linux Clipboard is in use and if so displays a warning message on exit as this is the standard for other office suites?Something like:"There is text stored in the clipboard, this text will be deleted once Libre Writer is closed, do you want to continue?"[Yes] [No]Hi elecricprism,This is a linux problem that we hope libreoffice will decide to use a workaround to fix for its linux users. This problem effects all linux applications, which is why its recommended to use a clipboard manager like parcellite to solve it for all apps.
id=81214	As mentioned in, ifis loaded in 4.2 and above, all text in endnotes after the missing formula in endnote 43 arent being displayed, including the period right after the formula.shows how it looks in LibO 4.1 (left) and 4.2 (right). Reproducible, Version: 4.4.0.0.alpha0+Build ID: f511a2915ed856f048fd7dd91fd9f7537b1e0479 Linux Mint 17 x64.broke between 4.2.0.1 and 4.2.0.2regression from:commit 59003de73eff0da22d01f2fd3cddc78bf3a3a3f8Author: Michael Meeks <>Date: Fri Dec 20 16:18:48 2013 +0000 fastparser: fix load regressionHow curious; presumably some debug in saveException / throwException would show us what's up there; I'll have a look ...And yet, interestingly no exception is thrown or saved in this case (according to gdb at least).Disabling threaded parsing also causes the same effect; most curious ! will try reverting my patch ...And indeed - reverting fixes it: more and more interesting =) perhaps gdb just lieth to me.The problem seems to be:+ XML_StopParser( mpParser, /* resumable? */ XML_FALSE );in the 'saveException' method; apparently we don't want to do this in some cases; I imagine some event handler fires an exception and we want to just carry on parsing - but which one ... most curious; will add some printfs =)The real problem is that footnote reading throws a ton of exceptions inside 'startElement' of the form:unsatisfied query for interface of type com.sun.star.lang.XComponent!=) but apparently the old parser was more tolerant of that; so perhaps we should be too - disabled stopping the XML parser immediately on that, and the missing footnotes are back.Michael Meeks committed a patch related to this issue.It has been pushed to "master":fdo#81214 - tolerate exceptions thrown inside XFastParser callbacks.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Meeks committed a patch related to this issue.It has been pushed to "libreoffice-4-3":fdo#81214 - tolerate exceptions thrown inside XFastParser callbacks.It will be available in LibreOffice 4.3.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Meeks committed a patch related to this issue.It has been pushed to "libreoffice-4-2":fdo#81214 - tolerate exceptions thrown inside XFastParser callbacks.It will be available in LibreOffice 4.2.7.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Meeks committed a patch related to this issue.It has been pushed to "libreoffice-4-2-6":fdo#81214 - tolerate exceptions thrown inside XFastParser callbacks.It will be available already in LibreOffice 4.2.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Migrating Whiteboard tags to Keywords: (bibisected, DataLoss)[NinjaEdit]
id=83709	Createdlinux backtraceSteps:1) In cell A1, type a few letters2) Using the mouse, drag cell the cell to another location3) Press undo4) LibO CrashTested in 4.2.6 and master. Regression as it doesnt happen in 4.1.6. Jay,Just a couple of questions:(1) In the backtrace I see class names starting Sc... . Did your crash really happen in Writer?(2) How do you drag a cell with the mouse? All I can accomplish is to extend the selection, in both Writer and Calc.You know what to do with bug status.Thanks,Terry.Hi Terry,Thats my mistake, its calc. In order to drag a cell, select the cells you want to drag, and then the next time you click on the selected cells, you will be able to drag it.Hi Jay.. I can't reproduce crash with LO 4.3.1.2 and 4.2.6.2 portable under Win7 x86Have you tried resetting user profile?(In reply to)Sorry..it's 4.2.6.3Though libO crashing due to the profile is still a bug, i reset it just for the fun of it and it still crashes. So it seems it wasnt as straight forward as i thought it was with my steps mentioned in the description, so i'll upload the file it happened to me in.Createdsample fileSteps:1) open file2) drag A137 which has the text .uno:InsertSound to another cell3) undo4) crashThanks for the test file Jay. Confirm reproducible with LO 4.2.6.3 - Ubuntu 12.04 x86Possibly same root cause withsince cell L117 contains a SUM function with range.I think I have a possible reason for varying results!With master commit f74a633, fetched 2014-08-23, configured: --enable-option-checking=fatal --enable-dbgutil --enable-crashdump --without-system-postgresql --without-myspell-dicts --with-extra-buildid --without-doxygen --with-external-tar=/home/terry/lo_hacking/git/src --enable-online-updatebuilt on debian wheezy 64-bit, I see the following various results:(a) running on debian-wheezy, in which ldd identifies itself as ldd (Debian EGLIBC 2.13-38+deb7u4) 2.13, the program segfaults in boost::unordered::detail::table <boost::unordered::detail::set <std::allocator<ScBroadcastAreaEntry> , ScBroadcastAreaEntry , ScBroadcastAreaHash , ScBroadcastAreaEqual > >::begin (this=0x0). Note: - You did notice the NULL `this` pointer, didn't you? - Jay's attached backtrace shows a different segfault.(b) running in a chroot environment to debain-sid, in which ldd identifies itself as ldd (Debian GLIBC 2.19-10) 2.19, I see no crash.The bibisect versions of LibreOffice do not run in debian-wheezy. Ishall look for a partition with an intermediate version of ubuntuwhich will run the bibisect-43all versions.Just for completeness, here is how to drag a cell:(*) Click in the cell and hold the mouse button down. There is little visible result.(*) Drag the mouse to another cell and continue to hold the mouse button down. The program shades a rectangle of cells as selected.(*) Drag the mous back to the original cell. The program highlights just the original cell as selected.(*) Release the mouse button. The original cell is still selected.(*) Click in the original cell and drag it where you want it to be.Can someone check if this commithas fixed this crasher?In the daily dbgutil bibisect, the crash disappears between theversions of 2014-09-02 and 2094-09-03. So, I can readily believe thatis that commit that fixed it.Please ignore my earlier comment about different versions of systemlibraries.Terry.Terry, thanks for checking. The same commit has been backported to both 4.2 and 4.3 branches. So, the next release of the respective branch should have the fix.Let's add the targets from fdo#79441 (as indicated in the commit quoteed)
id=84043	Problem description: Opening file fails after savingFound issue on version 4.2.4.2Downloaded update, reproduced on 4.2.6.3Steps to reproduce:1. Open before.odp2. save3. close file4. open before.odpsame error if 1. Open before.odp2. save as after.odp3. close file4. open after.odpCurrent behavior:fails with error"Read-Error.Format error discovered in the file in sub-document styles.xml at position 2,438212(row,col)."Expected behavior:Opens correctly, no error Operating System: Mac OS XVersion: 4.2.4.2 release hmm the document reproducing the bug is too big to attach (7 MB). Please email me and I'll mail you the document (odp).Createdbefore.odp with pictures removedI removed the pictures from the .odp (opened it as a package file and deleted the Pictures folder).I get the same error as the reporter after saving on Win7 64-bit 4.3.0.4 and 4.4.0.0.alpha0+status NEW and platform ALL according to confirmation in previous posthave you guys tried 4.3.2.2 release?Just confirmed the problem persists on Win 7 64-bit 4.3.2.2 and today's 4.4.0.0 dev build.Presumably the problem is caused bycommit 13ef16423e78d3ea825172594f08c47d2f9bfd09Author: Armin Le Grand <>Date: Wed Nov 21 13:23:01 2012 +0000 For backward compatibility take mirrorings in setTransformation into account Also found an error in SdrObjCustomShape::TRGetBaseGeometry when MirrorY was used (cherry picked from commit 4116c33b12d3787c406f0348f89efcb1cf409507)Caolán McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: fdo#84043 don't create duplicate Mirrored[X|Y] propertiesIt will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.I have a fix anyway that will allow the document to be loaded, saved and reloaded without error. review for 4-4 asand it that passes muster then will add for 4-3 afterwardsthis is a really horrible bug; Beluga / tommy please if you triage a bug where LO can't read a file in the default format (ODF) that it wrote itself CC me immediately.Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-4":Resolves: fdo#84043 don't create duplicate Mirrored[X|Y] propertiesIt will be available in 4.4.0.0.beta2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-3":Resolves: fdo#84043 don't create duplicate Mirrored[X|Y] propertiesIt will be available in 4.3.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-2":Resolves: fdo#84043 don't create duplicate Mirrored[X|Y] propertiesIt will be available in 4.2.8.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "master":fdo#84043: add a test for the bugIt will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-4-4":fdo#84043: add a test for the bugIt will be available in 4.4.0.0.beta2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-3-5":Resolves: fdo#84043 don't create duplicate Mirrored[X|Y] propertiesIt will be available in 4.3.5.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=83798	Document with some paragraphs Heading1, Heading2set numbering in Tools > Outline numbering > Document shows numberingInsert TOC (Insert > Indexes and Tables > Indexes and Tables ..)Make sure that at the tab Entries the E# (for Chapter No) is placed at the Structure line OK > No numbering in TOCI'll attach a sample document Createdtest file with TOC etcI work on Ubuntu 32 bitsVersion: 4.4.0.0.alpha0+Build ID: 8e4defe4b59a72fbe82f94b26e233ba36640c739TinderBox: Linux-rpm_deb-x86@45-TDF, Branch:master, Time: 2014-09-02_01:46:56Reproducible for me with Version: 4.4.0.0.alpha0+Build ID: a65459eae58f342787abe4c766912f964a8383bebuilt at home under Ubuntu 14.04 x86-64With LO 4.3.3.0.0+ updating the TOC shows the chapter numbering in the TOC.Best regards. JBFStill exist in 4.4 beta1(In reply to geraldg from)The version field is for the oldest version the bug was reproduced in, so I changed it back.Thanksbibisect range:f7fac105102c6df21242dc30ee7174aee6507bb3..baf7b38e387b857c46dbe3d01cde166a7381bf63regression from:commit 0a1b1511faaa3302429d93ccdad3eb41dc8f36cbAuthor: Tobias Lippert <>AuthorDate: Sun Jun 1 14:24:51 2014 +0200Commit: Caolán McNamara <>CommitDate: Fri Jun 6 12:19:12 2014 +0000 Unittest generation of text for chapter entries in the TOCcommit 26259e0cca3bc4d8f45337b0cafea2eed8eb32f9Author: Tobias Lippert <>AuthorDate: Sun Jun 1 14:22:48 2014 +0200Commit: Caolán McNamara <>CommitDate: Fri Jun 6 08:08:08 2014 +0000 Unittest generation of page number placeholders in table of contents... ehhh ... so presumably we need better unit tests :)fixed on masterMichael Stahl committed a patch related to this issue.It has been pushed to "master":fdo#83798: sw: fix generation of ToX with chapter numbersIt will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-4-4":fdo#83798: sw: fix generation of ToX with chapter numbersIt will be available in 4.4.0.0.beta2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Varun committed a patch related to this issue.It has been pushed to "master":Add test for tdf#83798 ToC missing chapter numbersIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=84075	Createdlinux backtraceSteps:1) Open Calc2) Goto Format > Page...3) CrashVersion: 4.4.0.0.alpha0+Build ID: 510bb3fab28dffcdd5ff544b85063e8cc3d3f48eTinderBox: Linux-rpm_deb-x86@45-TDF, Branch:master, Time: 2014-09-17_22:09:19 Confirmed for master on both OSX and Linux.4.4 bibisect puts the first bad build at 2014-07-02-> NEWFollowing up with a plain bisect within the one-day range identified by the bibisect, this seems to be another result of:commit 7d9bb549d498d6beed2c4050c402d09643febdfaAuthor: Armin Le Grand <>Date: Mon Jun 2 15:00:50 2014 +0000 Related: #i124638# Second step of DrawingLayer FillAttributes...(Calc is broken completely for the following few commits, then when it comes back this bug is reproducible)CreatedOSX backtraceIncidentally I get a rather different backtrace both on OSX and Linux.The OSX version is as attached.*** This bug has been marked as a duplicate of***
id=84095	Setting:On a Mac and on a Windows PC I installed the the whole OpenType (OTF) font-family of "Akzidenz-Grotesk Pro+":Internal font-data of the font files:font-family: "Akzidenz-Grotesk Pro"font-styles:* postscript-name: AkzidenzGroteskPro-Light full-name: Akzidenz-Grotesk Pro Light style-name: Light* postscript-name: AkzidenzGroteskPro-Md full-name: Akzidenz-Grotesk Pro Med style-name: Medium* postscript-name: AkzidenzGroteskPro-Regular full-name: Akzidenz-Grotesk Pro Regular style-name: Regular* postscript-name: AkzidenzGroteskPro-It full-name: Akzidenz-Grotesk Pro Italic style-name: Italic* postscript-name: AkzidenzGroteskPro-LightIt full-name: Akzidenz-Grotesk Pro LightIt style-name: Light Italic* postscript-name: AkzidenzGroteskPro-MdIt full-name: Akzidenz-Grotesk Pro MedItal style-name: Medium Italic* postscript-name: AkzidenzGroteskPro-Bold full-name: Akzidenz-Grotesk Pro Bold style-name: Bold* postscript-name: AkzidenzGroteskPro-Super full-name: Akzidenz-Grotesk Pro Super style-name: Super* postscript-name: AkzidenzGroteskPro-BoldIt full-name: Akzidenz-Grotesk Pro BoldIt style-name: Bold Italic* postscript-name: AkzidenzGroteskPro-SuperItalic full-name: Akzidenz-Grotesk Pro SuperIt style-name: Super Italic* postscript-name: AkzidenzGroteskPro-LightEx full-name: Akzidenz-Grotesk Pro Light Ext style-name: Light Extended* postscript-name: AkzidenzGroteskPro-MdEx full-name: Akzidenz-Grotesk Pro Med Ext style-name: Medium Extended* postscript-name: AkzidenzGroteskPro-Ext full-name: Akzidenz-Grotesk Pro Ext style-name: Regular Extended* postscript-name: AkzidenzGroteskPro-LigExtIt full-name: Akzidenz-Grotesk Pro LightExtIt style-name: Light Extended Italic* postscript-name: AkzidenzGroteskPro-MedExtIt full-name: Akzidenz-Grotesk Pro MedExtIt style-name: Medium Extended Italic* postscript-name: AkzidenzGroteskPro-ExtItalic full-name: Akzidenz-Grotesk Pro ExtItalic style-name: Regular Extended Italic* postscript-name: AkzidenzGroteskPro-BoldEx full-name: Akzidenz-Grotesk Pro Bold Ext style-name: Bold Extended* postscript-name: AkzidenzGroteskPro-BoldExIt full-name: Akzidenz-Grotesk Pro BoldExtIt style-name: Bold Extended Italic* postscript-name: AkzidenzGroteskPro-LightCn full-name: Akzidenz-Grotesk Pro Light Cnd style-name: Light Condensed* postscript-name: AkzidenzGroteskPro-MdCn full-name: Akzidenz-Grotesk Pro Med Cnd style-name: Medium Condensed* postscript-name: AkzidenzGroteskPro-Cn full-name: Akzidenz-Grotesk Pro Cnd style-name: Regular Condensed* postscript-name: AkzidenzGroteskPro-CnIt full-name: Akzidenz-Grotesk Pro CndIt style-name: Condensed Italic* postscript-name: AkzidenzGroteskPro-LightCnItalic full-name: Akzidenz-Grotesk Pro LightCndIt style-name: Light Condensed Italic* postscript-name: AkzidenzGroteskPro-MdCnIt full-name: Akzidenz-Grotesk Pro MedCndIt style-name: Medium Condensed Italic* postscript-name: AkzidenzGroteskPro-BoldCn full-name: Akzidenz-Grotesk Pro Bold Cnd style-name: Bold Condensed* postscript-name: AkzidenzGroteskPro-XBd full-name: Akzidenz-Grotesk Pro ExtraBold style-name: Extra Bold* postscript-name: AkzidenzGroteskPro-XBdCn full-name: Akzidenz-Grotesk Pro XBd Cnd style-name: Extra Bold Condensed* postscript-name: AkzidenzGroteskPro-BoldCnIt full-name: Akzidenz-Grotesk Pro BoldCndIt style-name: Bold Condensed Italic* postscript-name: AkzidenzGroteskPro-XBdCnIt full-name: Akzidenz-Grotesk Pro XBdCndIt style-name: Extra Bold Condensed Italic* postscript-name: AkzidenzGroteskPro-XBdIt full-name: Akzidenz-Grotesk Pro ExtraBldIt style-name: Extra Bold ItalicThen I created a document on the Mac and opened it on Windows. LibO on Windows showed a replacement font, although I correctly installed exactly the same font files in both systems.Then I created a document on Windows and opened it on the Mac: Same problem here.The I created a document with NeoOffice on my Mac and also this document is compatile only with NeoOffice.In all three ODT documents contain the text "Font test for error finding." formatted with "Akzidenz-Grotesk Pro Light"I upacked all three documents with a zip-extractor and opened the content.xml in order to verify the internal font representation. I found out, that every single one of the three progams used another representation:*** LibreOffice 4.3.2.2 Mac – Slovene language ***<?xml version="1.0" encoding="UTF-8"?><office:document-content xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0" xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0" xmlns:table="urn:oasis:names:tc:opendocument:xmlns:table:1.0" xmlns:draw="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0" xmlns:fo="urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0" xmlns:xlink="" xmlns:dc="" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:number="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0" xmlns:svg="urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0" xmlns:chart="urn:oasis:names:tc:opendocument:xmlns:chart:1.0" xmlns:dr3d="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0" xmlns:math="" xmlns:form="urn:oasis:names:tc:opendocument:xmlns:form:1.0" xmlns:script="urn:oasis:names:tc:opendocument:xmlns:script:1.0" xmlns:ooo="" xmlns:ooow="" xmlns:oooc="" xmlns:dom="" xmlns:xforms="" xmlns:xsd="" xmlns:xsi="" xmlns:rpt="" xmlns:of="urn:oasis:names:tc:opendocument:xmlns:of:1.2" xmlns:xhtml="" xmlns:grddl="#" xmlns:officeooo="" xmlns:tableooo="" xmlns:drawooo="" xmlns:calcext="urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0" xmlns:loext="urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0" xmlns:field="urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0" xmlns:formx="urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0" xmlns:css3t="" office:version="1.2"><office:scripts/><office:font-face-decls><style:font-face style:name="Akzidenz-Grotesk Pro" svg:font-family="&apos;Akzidenz-Grotesk Pro&apos;"/><style:font-face style:name="Linux Libertine O" svg:font-family="&apos;Linux Libertine O&apos;"/><style:font-face style:name="Lucida Sans1" svg:font-family="&apos;Lucida Sans&apos;" style:font-family-generic="swiss"/><style:font-face style:name="Akzidenz-Grotesk Pro1" svg:font-family="&apos;Akzidenz-Grotesk Pro&apos;" style:font-adornments="Svetlo" style:font-pitch="variable"/><style:font-face style:name="Lucida Sans" svg:font-family="&apos;Lucida Sans&apos;" style:font-family-generic="system" style:font-pitch="variable"/><style:font-face style:name="SimSun" svg:font-family="SimSun" style:font-family-generic="system" style:font-pitch="variable"/></office:font-face-decls><office:automatic-styles><style:style style:name="P1" style:family="paragraph" style:parent-style-name="Standard"><style:text-properties style:font-name="Akzidenz-Grotesk Pro1" fo:font-weight="250" officeooo:rsid="00037d29" style:font-size-asian="10.5pt"/></style:style></office:automatic-styles><office:body><office:text><text:sequence-decls><text:sequence-decl text:display-outline-level="0" text:name="Illustration"/><text:sequence-decl text:display-outline-level="0" text:name="Table"/><text:sequence-decl text:display-outline-level="0" text:name="Text"/><text:sequence-decl text:display-outline-level="0" text:name="Drawing"/></text:sequence-decls><text:p text:style-name="P1">Font test for error finding.</text:p></office:text></office:body></office:document-content>*** LibreOffice 4.3.1.2 Windows – German language ***<?xml version="1.0" encoding="UTF-8"?><office:document-content xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0" xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0" xmlns:table="urn:oasis:names:tc:opendocument:xmlns:table:1.0" xmlns:draw="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0" xmlns:fo="urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0" xmlns:xlink="" xmlns:dc="" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:number="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0" xmlns:svg="urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0" xmlns:chart="urn:oasis:names:tc:opendocument:xmlns:chart:1.0" xmlns:dr3d="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0" xmlns:math="" xmlns:form="urn:oasis:names:tc:opendocument:xmlns:form:1.0" xmlns:script="urn:oasis:names:tc:opendocument:xmlns:script:1.0" xmlns:ooo="" xmlns:ooow="" xmlns:oooc="" xmlns:dom="" xmlns:xforms="" xmlns:xsd="" xmlns:xsi="" xmlns:rpt="" xmlns:of="urn:oasis:names:tc:opendocument:xmlns:of:1.2" xmlns:xhtml="" xmlns:grddl="#" xmlns:officeooo="" xmlns:tableooo="" xmlns:drawooo="" xmlns:calcext="urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0" xmlns:loext="urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0" xmlns:field="urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0" xmlns:formx="urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0" xmlns:css3t="" office:version="1.2"><office:scripts/><office:font-face-decls><style:font-face style:name="Mangal1" svg:font-family="Mangal"/><style:font-face style:name="Akzidenz-Grotesk Pro Light" svg:font-family="&apos;Akzidenz-Grotesk Pro Light&apos;" style:font-adornments="Light" style:font-family-generic="modern" style:font-pitch="variable"/><style:font-face style:name="Liberation Serif" svg:font-family="&apos;Liberation Serif&apos;" style:font-family-generic="roman" style:font-pitch="variable"/><style:font-face style:name="Liberation Sans" svg:font-family="&apos;Liberation Sans&apos;" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Mangal" svg:font-family="Mangal" style:font-family-generic="system" style:font-pitch="variable"/><style:font-face style:name="Microsoft YaHei" svg:font-family="&apos;Microsoft YaHei&apos;" style:font-family-generic="system" style:font-pitch="variable"/><style:font-face style:name="SimSun" svg:font-family="SimSun" style:font-family-generic="system" style:font-pitch="variable"/></office:font-face-decls><office:automatic-styles><style:style style:name="P1" style:family="paragraph" style:parent-style-name="Standard"><style:text-properties style:font-name="Akzidenz-Grotesk Pro Light" fo:font-weight="250" officeooo:rsid="001209ef" officeooo:paragraph-rsid="001209ef" style:font-size-asian="10.5pt"/></style:style></office:automatic-styles><office:body><office:text><text:sequence-decls><text:sequence-decl text:display-outline-level="0" text:name="Illustration"/><text:sequence-decl text:display-outline-level="0" text:name="Table"/><text:sequence-decl text:display-outline-level="0" text:name="Text"/><text:sequence-decl text:display-outline-level="0" text:name="Drawing"/></text:sequence-decls><text:p text:style-name="P1">Font test for error finding.</text:p></office:text></office:body></office:document-content>*** NeoOffice 3.4.1 – English language***<?xml version="1.0" encoding="UTF-8"?><office:document-content xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0" xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0" xmlns:table="urn:oasis:names:tc:opendocument:xmlns:table:1.0" xmlns:draw="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0" xmlns:fo="urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0" xmlns:xlink="" xmlns:dc="" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:number="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0" xmlns:svg="urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0" xmlns:chart="urn:oasis:names:tc:opendocument:xmlns:chart:1.0" xmlns:dr3d="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0" xmlns:math="" xmlns:form="urn:oasis:names:tc:opendocument:xmlns:form:1.0" xmlns:script="urn:oasis:names:tc:opendocument:xmlns:script:1.0" xmlns:ooo="" xmlns:ooow="" xmlns:oooc="" xmlns:dom="" xmlns:xforms="" xmlns:xsd="" xmlns:xsi="" xmlns:rpt="" xmlns:of="urn:oasis:names:tc:opendocument:xmlns:of:1.2" xmlns:rdfa="#" xmlns:field="urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0" xmlns:formx="urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0" office:version="1.2"><office:scripts/><office:font-face-decls><style:font-face style:name="Akzidenz-Grotesk Pro" svg:font-family="&apos;Akzidenz-Grotesk Pro&apos;"/><style:font-face style:name="Linux Libertine O" svg:font-family="&apos;Linux Libertine O&apos;"/><style:font-face style:name="Tahoma1" svg:font-family="Tahoma"/><style:font-face style:name="Akzidenz-Grotesk Pro Light" svg:font-family="&apos;Akzidenz-Grotesk Pro Light&apos;" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Arial" svg:font-family="Arial" style:font-family-generic="system" style:font-pitch="variable"/><style:font-face style:name="MS Mincho" svg:font-family="&apos;MS Mincho&apos;" style:font-family-generic="system" style:font-pitch="variable"/><style:font-face style:name="Tahoma" svg:font-family="Tahoma" style:font-family-generic="system" style:font-pitch="variable"/></office:font-face-decls><office:automatic-styles><style:style style:name="P1" style:family="paragraph" style:parent-style-name="Standard"><style:text-properties style:font-name="Akzidenz-Grotesk Pro Light"/></style:style></office:automatic-styles><office:body><office:text><text:sequence-decls><text:sequence-decl text:display-outline-level="0" text:name="Illustration"/><text:sequence-decl text:display-outline-level="0" text:name="Table"/><text:sequence-decl text:display-outline-level="0" text:name="Text"/><text:sequence-decl text:display-outline-level="0" text:name="Drawing"/></text:sequence-decls><text:p text:style-name="P1">Font test for error finding.</text:p></office:text></office:body></office:document-content>*** Conclusion ***The font represantion of LibreOffice Mac differs from LibreOffice Windows as well as both differ from NeoOffice. Thus documents created with LibreOffice Mac can neither be used with LibreOffice Windows nor with NeoOffice and vice versa. The font handling of all three programs is incompatible. Additional informtion:*** LibreOffice 4.3.2.2 Mac – Slovene language ***stores the font name in a way, that is either incompable with the windows version of LibO or even loses formatting**** .odt ****uses a broken name, that contains a combination of the family-name + the number "1" and the font-adornment "Svetlo", which is the slovene UI-translation for "Light"<style:font-face style:name="Akzidenz-Grotesk Pro1" svg:font-family="&apos;Akzidenz-Grotesk Pro&apos;" style:font-adornments="Svetlo" style:font-pitch="variable"/>**** .rtf ****uses only the family-name. when saved and opened again it falls back from light to regular style, because the style-information is lost{\f5\fnil\fprq0\fcharset0 Akzidenz-Grotesk Pro;}{\f6\fnil\fprq2\fcharset0 Akzidenz-Grotesk Pro;}*** LibreOffice 4.3.1.2 Windows – German language ***uses the full-name**** .odt ****<style:font-face style:name="Akzidenz-Grotesk Pro Light" svg:font-family="&apos;Akzidenz-Grotesk Pro Light&apos;" style:font-adornments="Light" style:font-family-generic="modern" style:font-pitch="variable"/>*** NeoOffice 3.4.1 – English language ***using the full-name**** .odt ****<style:font-face style:name="Akzidenz-Grotesk Pro Light" svg:font-family="&apos;Akzidenz-Grotesk Pro Light&apos;" style:font-family-generic="swiss" style:font-pitch="variable"/>*** Microsoft Word 2008 for Mac ***both, DOCX and RTF, are usisng the full-name**** .docx ****<w:rFonts w:ascii="Akzidenz-Grotesk Pro Light" w:hAnsi="Akzidenz-Grotesk Pro Light"/>**** .rtf ***uses the full-name but show also documents using the postscript-name properly:{\f35\fbidi \fnil\fcharset0\fprq2{\*\panose 02000506040000020003}Akzidenz-Grotesk Pro Light;}*** Apple Pages Pages´09 Version 4.3 (1048) ***uses the postscript-name<sf:fontName><sf:string sfa:string="AkzidenzGroteskPro-Light"/></sf:fontName>*** Bean Version 3.2.5 ***uses either the full-name or the postscript-name**** .odt ****uses the full-name<style:font-face style:name="Akzidenz-Grotesk Pro Light" svg:font-family="Akzidenz-Grotesk Pro Light"/>**** .rtf ****although using the postscript-name compatible with Microsoft Word 2008 for Mac, thus shows also documents using the full-name properly:{\fonttbl\f0\fnil\fcharset0 AkzidenzGroteskPro-Light;}Proposed solution:As NeoOffice does it the right way and is compatible with LibreOffice for Windows, copy the font handling code from NeoOffe 3.4.1 (should be GPL).Temporary solution for Mac users:Use NeoOffice instead of LibreOffice, until the problem with LibreOffice is solved.Additional information:Both, LibreOffice Windows and NeoOffice, do recognize and correctly handle postscript-names given in an ODT-file:<style:font-face style:name="AkzidenzGroteskPro-Light" svg:font-family="AkzidenzGroteskPro-Light"/><style:text-properties style:font-name="AkzidenzGroteskPro-Light"/>LibreOffice Mac doesn't and shows replacement Fonts einstead.No independent confirmation, setting status back to unconfirmed.Please, don't set your onw bugs as NEW.Best regards. JBFIs there no freely available version of this font family ? Otherwise, it is going to be hard to reproduce.@sarutat : please check the other OTF/font issues affecting Mac versions of LO via bugzilla, this one might well be a duplicate.As for using NeoOffice code, it would have to be LGPL3/MPL in order to be acceptable for the LO codebase - if it is just GPL, it won't be accepted.Dear Bug Submitter,This bug has been in NEEDINFO status with no change for at least6 months. Please provide the requested information as soon aspossible and mark the bug as UNCONFIRMED. Due to regular bugtracker maintenance, if the bug is still in NEEDINFO status withno change in 30 days the QA team will close the bug as INVALIDdue to lack of needed information.For more information about our NEEDINFO policy please read thewiki located here:If you have already provided the requested information, pleasemark the bug as UNCONFIRMED so that the QA team knows that thebug is ready to be confirmed. Thank you for helping us make LibreOffice even better for everyone!Warm Regards,QA TeamDear Bug Submitter,Please read this message in its entirety before proceeding.Your bug report is being closed as INVALID due to inactivity anda lack of information which is needed in order to accuratelyreproduce and confirm the problem. We encourage you to retestyour bug against the latest release. If the issue is stillpresent in the latest stable release, we need the followinginformation (please ignore any that you've already provided):a) Provide details of your system including your operating system and the latest version of LibreOffice that you have confirmed the bug to be presentb) Provide easy to reproduce steps – the simpler the betterc) Provide any test case(s) which will help us confirm the problemd) Provide screenshots of the problem if you think it might helpe) Read all comments and provide any requested informationOnce all of this is done, please set the bug back to UNCONFIRMEDand we will attempt to reproduce the issue. Please do not:a) respond via email b) update the version field in the bug or any of the other details on the top section of our bug tracker-- The LibreOffice QA Team This INVALID Message was generated on: 2015-05-06Warm Regards,QA Team
id=84499	Createdcrash dialogWhile working on bu 76834, i noticed thatandwould crash libreoffice master.Version: 4.4.0.0.alpha0+Build ID: 0a32edcdc2bda75a7536ce7f88c91cbc56e7afb1TinderBox: Win-x86@39, Branch:master, Time: 2014-09-24_00:4 This is a regression as the 4.3.3 daily i have opened it.Hi Jay,I reproduce with LO 4.4.0.0.alpha0+Build ID: 5aeb852efcabdd51545d5d41c92f4bf3cef1d663TinderBox: Win-x86@39, Branch:master, Time: 2014-09-08_07:01:57& Windows 7 Home Premium.Works with LO 4.3.2.2 Build ID: edfb5295ba211bd31ad47d0bad0118690f76407dSet status to NEW,JacquesI doubt its actually a recent thing. I believe its the old windows specific assert, just that its only visible in a debugging version and not a release version*** This bug has been marked as a duplicate of***Migrating Whiteboard tags to Keywords: (bibisectRequest)[NinjaEdit]
id=84556	CreatedThe original file in ods formatProblem description: Steps to reproduce:1. Save the ods file with formulas in C column in xls format 2. Close Spreadsheet and re-open the xls file3. Look to the C column and you can see the problemCurrent behavior:Openening the xls file I see an RIF! error in the C columnExpected behavior:Openening the xls file I have to see the formulas results in the C column. If you open the same file with Excel all seems ok Operating System: Windows 7Version: 4.3.2.2 release Seems to be a regression.Confirmed:ubuntu 14.04 running E17NewCritical - loss of data for common formatHighest - MAB - regression loss of data92e8808c5d3f3e54366b8bf66bcbd7bb65089c3e is the first bad commitcommit 92e8808c5d3f3e54366b8bf66bcbd7bb65089c3eAuthor: Bjoern Michaelsen <>Date: Thu Oct 17 23:58:22 2013 +0000 source-hash-d1cbaee70d3f922937a1993914436c8fc899ebfc commit d1cbaee70d3f922937a1993914436c8fc899ebfc Author: Krisztian Pinter <> AuthorDate: Sun Aug 11 18:35:52 2013 +0200 Commit: Jan Holesovsky <> CommitDate: Tue Aug 13 18:35:03 2013 +0200 startcenter: Add file type filter to RecentDocsView Change-Id: Ib42721e00f60590fc947ba8ec5f615227641e754:100644 100644 c7c065976a76e393b9da7048dca2189f813a33b5 dbcceea06d1fde9eac2e2d28af44b78629fb5ef5 M ccache.log:100644 100644 e103c2d16b016303019675f20bdd46e348d8759a a439348d471f12086ba610835399eca1c2f67d34 M commitmsg:100644 100644 e20c6dc7cc9a5e6d0fb821802603f72488157100 0ff970a5fbcf31b664a221a8445aeb8881b87bd2 M dev-install.log:100644 100644 3ce23c5e04f3696c6e99b32413b87939abd8ff06 66be52e34295eed7b0e0d8838255bcc23079394d M make.log:040000 040000 92e40bec5e8aa3fe86788672caa720c19cd69cfe 00776b62e2c8065968d7d5e9a300d78e88e4fc6e M opt# bad: [423a84c4f7068853974887d98442bc2a2d0cc91b] source-hash-c15927f20d4727c3b8de68497b6949e72f9e6e9e# good: [65fd30f5cb4cdd37995a33420ed8273c0a29bf00] source-hash-d6cde02dbce8c28c6af836e2dc1120f8a6ef9932git bisect start 'latest' 'oldest'# good: [e02439a3d6297a1f5334fa558ddec5ef4212c574] source-hash-6b8393474974d2af7a2cb3c47b3d5c081b550bdbgit bisect good e02439a3d6297a1f5334fa558ddec5ef4212c574# bad: [4850941efe43ae800be5c76e1102ab80ac2c085d] source-hash-980a6e552502f02f12c15bfb1c9f8e6269499f4bgit bisect bad 4850941efe43ae800be5c76e1102ab80ac2c085d# skip: [a043626b542eb8314218d7439534dce2fc325304] source-hash-9379a922c07df3cdb7d567cc88dfaaa39ead3681git bisect skip a043626b542eb8314218d7439534dce2fc325304# skip: [aba65c3e4c0df07e4909aeefb758cdb688242bf6] source-hash-827524abfb4b577d08276fde40929a9adfb7ff1agit bisect skip aba65c3e4c0df07e4909aeefb758cdb688242bf6# skip: [aba65c3e4c0df07e4909aeefb758cdb688242bf6] source-hash-827524abfb4b577d08276fde40929a9adfb7ff1agit bisect skip aba65c3e4c0df07e4909aeefb758cdb688242bf6# bad: [c81a8a0dcfc1ed095a80e4485c89dd0fcaf73f31] source-hash-c69ed33628ec0b7abf6296539cf280d6c4265930git bisect bad c81a8a0dcfc1ed095a80e4485c89dd0fcaf73f31# bad: [c81a8a0dcfc1ed095a80e4485c89dd0fcaf73f31] source-hash-c69ed33628ec0b7abf6296539cf280d6c4265930git bisect bad c81a8a0dcfc1ed095a80e4485c89dd0fcaf73f31# bad: [1d4980621741d3050a5fe61b247c157d769988f2] source-hash-89d01a7d8028ddb765e02c116d202a2435894217git bisect bad 1d4980621741d3050a5fe61b247c157d769988f2# good: [ba096f438393091574da98fe7b8e6b05182a8971] source-hash-8499e78ca03c792f4fa2650e02b519094ba0baa8git bisect good ba096f438393091574da98fe7b8e6b05182a8971# bad: [e75547cbd2d9d480ba13e119a8df8098c9d3a0a3] source-hash-69f686774cfeb803fdd63ed1ef07ff70550930degit bisect bad e75547cbd2d9d480ba13e119a8df8098c9d3a0a3# good: [4984b2bcccf87dab80d9c47fb934d4ea0c08bd28] source-hash-89aeec9b1d2f771310eeb0fa4c820c19599df0f7git bisect good 4984b2bcccf87dab80d9c47fb934d4ea0c08bd28# good: [f6a86d8812bc1db2fee07af4d54b7af6a553cc59] source-hash-e4ebe80be51fb33545091aa4f0bbc0ea2fe674f0git bisect good f6a86d8812bc1db2fee07af4d54b7af6a553cc59# bad: [92e8808c5d3f3e54366b8bf66bcbd7bb65089c3e] source-hash-d1cbaee70d3f922937a1993914436c8fc899ebfcgit bisect bad 92e8808c5d3f3e54366b8bf66bcbd7bb65089c3e# good: [6dab1aaf04879f7ed6ca8baace99020b7f709443] source-hash-417d1c2b13cbd70300d2921b5667dfadc7e25895git bisect good 6dab1aaf04879f7ed6ca8baace99020b7f709443# first bad commit: [92e8808c5d3f3e54366b8bf66bcbd7bb65089c3e] source-hash-d1cbaee70d3f922937a1993914436c8fc899ebfcI believe this was introduced in 4.2 not 4.3 - version should be updated to reflect thisReproduced with LO 4.2.0.0.beta1 and 4.2.7.0.0+ Time: 2014-09-29_15:46:48Not reproduced with LO 4.1.6.2 - Ubuntu 12.04 x86Unable to find the pattern to repro from scratch.Btw WPS Office 2014 can read the formula in saved XLS file.still reproducible in LibO 4.4.0.0.alpha2+Build ID: b021b5983c62e266b82d9f0c5c6d8d8900553827TinderBox: Win-x86@42, Branch:master, Time: 2014-11-12_00:19:18LibO 4.2.x reached the end of life.moving this mab4.2 to mab4.3 list.Behaviour appears to have changed from the below commit.commit a592b81558c41e71c0f139d86489b163148ea8b7Author: Kohei Yoshida <>Date: Fri Aug 9 12:09:44 2013 -0400 Export shared formulas to xls, from the new shared formula in the core. Turns out we don't export shared formulas to xlsx, so no work is needed there. Change-Id: I85604f3b80c95c5b6179bbdac41e758c5de7854aMarkus Mohrhard committed a patch related to this issue.It has been pushed to "master":relative refs wrap around in xls, fdo#84556It will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Markus Mohrhard committed a patch related to this issue.It has been pushed to "master":add test for fdo#84556It will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Markus Mohrhard committed a patch related to this issue.It has been pushed to "libreoffice-4-4":relative refs wrap around in xls, fdo#84556It will be available in 4.4.0.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Markus Mohrhard committed a patch related to this issue.It has been pushed to "libreoffice-4-3":relative refs wrap around in xls, fdo#84556It will be available in 4.3.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Tor Lillqvist committed a patch related to this issue.It has been pushed to "master":Also relative row references need to wrap around, like fdo#84556 for columnsIt will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Tor Lillqvist committed a patch related to this issue.It has been pushed to "libreoffice-4-4":Also relative row references need to wrap around, like fdo#84556 for columnsIt will be available in 4.4.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=84608	Createdlinux backtraceIf you right-click on a toolbar and press 'customize', LibO crashes.Version: 4.4.0.0.alpha0+Build ID: 0ada00bd9b4f10861d37b8802564a2ace7385aa2TinderBox: Linux-rpm_deb-x86@45-TDF, Branch:master, Time: 2014-10-01_06:15:34On windows, the customize dialog appears and when i click cancel, there is a Fatal Error dialog that appears with 'Access violation - no RTTI data!' and then it crashes.Version: 4.4.0.0.alpha0+Build ID: 6a6e8628bdbe60931ce8e7fa9f4bb66170f7737bTinderBox: Win-x86@39, Branch:master, Time: 2014-09-30_00:24:33This bug has been there for the last couple of days, but i was waiting for it to fix itself, but it seems it hasnt been. On pc Debian x86-64 with master sources updated today, I could reproduce this.The problem is here specifically:#0 0x00002aaaabc98630 in __dynamic_cast () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6#1 0x00002aaab0ec30c6 in Menu::SetPopupMenu (this=0x2bef410, nItemId=1, pMenu=0x0) at /home/julien/compile-libreoffice/libreoffice/vcl/source/window/menu.cxx:778#2 0x00002aaac44525f1 in framework::ToolBarManager::ImplClearPopupMenu (this=0x2bf0de0, pToolBar=0x2bf0890) at /home/julien/compile-libreoffice/libreoffice/framework/source/uielement/toolbarmanager.cxx:1590#3 0x00002aaac445431a in framework::ToolBarManager::MenuSelect (this=0x2bf0de0, pMenu=0x2bef410) at /home/julien/compile-libreoffice/libreoffice/framework/source/uielement/toolbarmanager.cxx:1993#4 0x00002aaac4453619 in framework::ToolBarManager::LinkStubMenuSelect (pThis=0x2bf0de0, pCaller=0x2bef410) at /home/julien/compile-libreoffice/libreoffice/framework/source/uielement/toolbarmanager.cxx:1819Noel: I don't know if you use automatic tools to fix c cast style with C++ cast style but, do you think there could be other cases like this one?(BTW: great job indeed to remove all the c cast style! Hope nobody will add some ones in new code! :-))
id=84620	Createdtest fileHow to reproduce:1) Open attached file with Writer.2) When you open the style dropdown menu, go to the first style (on top) and then go down holding the arrow on keyboard.What happens:Crash Confirmed.Version: 4.4.0.0.alpha0+Build ID: 0ada00bd9b4f10861d37b8802564a2ace7385aa2TinderBox: Linux-rpm_deb-x86@45-TDF, Branch:master, Time: 2014-10-01_06:15:34Createdlinux backtrace
id=84810	Start CalcWrite some text in A1Copy cell A1 to clipboardSet cursor in A3 (or elsewhere)Edit > Paste specialCheck option "Link" and check option "Paste all"Paste ==> Crash.The crash is caused by the combination of options "Link" and "Format".This workflow does not crash in LibreOffice 4.2.6It crashes at least since Version Version: 4.4.0.0.alpha0+Build ID: dacab84536f61f79a5422e1d8d394019ec62f3ecTinderBox: Win-x86@39, Branch:master, Time: 2014-06-04_04:27:18 I can confirm with Version: 4.4.0.0.alpha0+Build ID: ced24ffba2fa1754c466b7944b0ee06d21292706TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2014-10-04_21:31:09Createdgdbtracereproducible under Win7x64 using 4.3.0.4 and 4.4.0.0.alpha0+ Build ID: 9177329a425cf70b515d1f266132838894fe54c6TinderBox: Win-x86@42, Branch:master, Time: 2014-10-06_00:13:13works fine in 4.2.6.2, hence 4.3.x regression.I think this could be placed in the mab4.3 list.45c77fb1c7bee047221a8c6bea9919291281f09e is the first bad commitcommit 45c77fb1c7bee047221a8c6bea9919291281f09eAuthor: Bjoern Michaelsen <>Date: Sun May 11 05:25:38 2014 +0000 source-hash-f1b1e73227471192682d303a58618ca8bd65a74d commit f1b1e73227471192682d303a58618ca8bd65a74d Author: Caolán McNamara <> AuthorDate: Sat Jan 25 20:19:29 2014 +0000 Commit: Caolán McNamara <> CommitDate: Sat Jan 25 20:56:30 2014 +0000 coverity#1158347 Uncaught exception Change-Id: Iacaf59724b71d810270545d1e9dd04d59125cc92bibisect-43only$ git bisect loggit bisect start# bad: [a92705c1fabafddd43d175a0714855cd22551232] source-hash-c15927f20d4727c3b8de68497b6949e72f9e6e9egit bisect bad a92705c1fabafddd43d175a0714855cd22551232# good: [6ab7f53af36f13bbefdd4e4fcbd3d1ea432a77d9] source-hash-22029c7e17b4cb48acb058d47ec9c3b6b8b6b294git bisect good 6ab7f53af36f13bbefdd4e4fcbd3d1ea432a77d9# bad: [bebf9d31c8fe9de96798484288a0fffc4d54917d] source-hash-09e5de8278dd8f13adcf614db35c8a8a04ba8e47git bisect bad bebf9d31c8fe9de96798484288a0fffc4d54917d# bad: [20d42d26a12e5ded00b3510d2d9e254e7876dc78] source-hash-c1503da35d8879366da13258837cf0084a536809git bisect bad 20d42d26a12e5ded00b3510d2d9e254e7876dc78# good: [df997ea92f012344541d1cf25eb1ff402e6de210] source-hash-7f5494f3c4bf14209a119c6b21c02e10075503aegit bisect good df997ea92f012344541d1cf25eb1ff402e6de210# good: [2efdfdeffbeb25fedb9a63c5d0e3168e03349f24] source-hash-d1ba55a28cd40134356faf3e01971491086591d9git bisect good 2efdfdeffbeb25fedb9a63c5d0e3168e03349f24# good: [1bcf9fe42f3009920b180819ada17589b453486a] source-hash-d803483f6a5938b0d0708b8db74b30c511dd8e31git bisect good 1bcf9fe42f3009920b180819ada17589b453486a# good: [6d88943bd809766f2c3a1de72552d6da601aee7a] source-hash-4f3012fc05fa0eeae412d9e2bfca3d7e60914a8cgit bisect good 6d88943bd809766f2c3a1de72552d6da601aee7a# bad: [754758306196c05e5a4bf6c6562e8b40c4793cfd] source-hash-8df4ce0ebe1240ed8f6def3af8f810e3f207555fgit bisect bad 754758306196c05e5a4bf6c6562e8b40c4793cfd# bad: [45c77fb1c7bee047221a8c6bea9919291281f09e] source-hash-f1b1e73227471192682d303a58618ca8bd65a74dgit bisect bad 45c77fb1c7bee047221a8c6bea9919291281f09e# first bad commit: [45c77fb1c7bee047221a8c6bea9919291281f09e] source-hash-f1b1e73227471192682d303a58618ca8bd65a74dThis one's the culpritcommit 80ea2822c368e6655d216c32904268fc335ef6a4Author: Kohei Yoshida <>Date: Fri Jan 24 11:38:47 2014 -0500 Optimize copy-n-pasting of single cell replicated over a range. This is a very common operation. Let's speed it up a bit. TODO : Handle cell comments. Change-Id: I5442bf19008475a9427b889c1eb641cacd8ff161Patch pending:
id=84847	CreatedSAMPLE FILE: =================== A sample file is attached. Try sorting on the 1st column, then try again with the 2nd column. It is useful to display the formulas using: TOOLS->OPTIONS->LibreOff Sorting functions with relative references fails. ----------------------------------------------------------------------BRIEF DESCRIPTION OF BUG: ===================When I sort rows that include a function with relative references such as SUM(E3:G3), the relative references are not updated properly.Note, if the relative references are NOT inside a function argument,the sort works correctly. ----------------------------------------------------------------------EXAMPLE OF BUG: ===================For example, if I consider the following spreadsheet(which is sorted on the 1st column):-----------------------------------------------------------------ann fff =E1+F1+G1 =SUM(E1:G1) 1 2 3barney eee =E2+F2+G2 =SUM(E2:G2) 4 5 6charlie ddd =E3+F3+G3 =SUM(E3:G3) 7 8 9-----------------------------------------------------------------If I now sort on the 2nd column {ddd,eee,fff} the result is WRONG:-----------------------------------------------------------------charlie ddd =E1+F1+G1 =SUM(E3:G3) 7 8 9barney eee =E2+F2+G2 =SUM(E2:G2) 4 5 6ann fff =E3+F3+G3 =SUM(E1:G1) 1 2 3-----------------------------------------------------------------Note the relative references are handled correctly when I use"=E1+F1+G1" but not when they are inside the argument of the function: "=SUM(E3:G3)"-----------------------------------------------------------------------TESTED ON: ===================I have verifed this bug in Version 4.3.1.2 on BOTH Ubuntu Linux (12.04, and 14.04) and Windows (Version 7). -----------------------------------------------------------------------THE BUG WAS NOT PRESENT BEFORE: ===================I also verified that this bug is NOT present in Version 4.1.x.x. -----------------------------------------------------------------------WORK-AROUND: ===================The only work-around I know is to revert back to Version 4.1.x.x. -----------------------------------------------------------------------SAMPLE FILE: ===================A sample file is attached. Try sorting on the 1st column, then try again with the 2nd column. It is useful to display the formulas using: TOOLS->OPTIONS->LibreOfficeCalc->VIEW->Display Formulas-----------------------------------------------------------------------COMMENTS: ===================I consider this bug to be ESSENTIAL/TOP-MOST priority. For example, with the current bug I cannot use LibreOffice for basic functions as sorting class grades by name or by test score.CreatedFile to demonstrate Calc BugKnown problem. Already tracked by bug report 81633.The more recent version not affected is 4.2.6.3Best regards. JBF*** This bug has been marked as a duplicate of***
id=85128	CreatedThe file referred to in the descriptionIn the attached file there are three sheets with tables. Impress consistently crashes when selecting one of these tables and do a ctr-C.I find Impress to be very unstable. I encountered a lot of crashes. Not only this problem (which I submit because it is consistent and therefor repeatable) but also when simply working with objects and text blocks. This morning I was working for a few hours and had at least a dozen chrashes. Saving insanely frequent does improe this slightly.I will try the still again and if I encounter the same behaviour I am very sorry to say that I see no other option than to buy M$ Office... :-( I'm back on the still version (4.2.6.3) and I am very happy to say that the consistent crashing does not appear in this version. I will continue using Impress (intensively) and will report again if crashed start te reappear.By the way, thanks for al the great work. Although being a bit put off by the problems experienced, I am really glad to be able to continue working with LO.CreatedWindbg info (no reproduce, EH exception)I do not reproduce the crash in Win7 X64, LibreOffice 4.3.3.1Build ID: 7d55112667c8fcddb67bc3803796b46c93aa56b0However, during debuging, every time I was trying to select a table, I got the following:(ef4.a48): C++ EH exception - code e06d7363 (first chance)@ E Moen:If you have time, please follow the instructions here to attach a backtrace:This is very helpful for devs to solve this issue. Thanks!Hi Kevin,I can probably find some time this weekend. I will try and report back.Additional: I'm on Windows 8.1 (64)Regards,E. MoenCreatedBacktrace when copying the tableCreatedBacktrace copying some stuff and editing it until crashHello,Done some backtracking, resulting in two files: BT1 and BT2.BT1This is the analysis of the table copying problem.BT2This is another analysis of a crash that I also found to happen almost certain. What I did was: copying some objects (squares, arrows and some text) from one file to the other (both files obviously opened) and after that, some random editing (make squares smaller, move some text, rearrange an arrow etc.). After something like 10 to 15 of these actions Impress crashed. I have seen this happening a lot.Hope this helps.Cheers,EgbertSet to NEW as there is backtrace with symbles.@Meon: If you have time please test with version 4.3.3 RC1. There are chances this issue is fixed in this version.CreatedBacktrack table copy problem on 4.3.3 RC1Hi,Done a backtrack on 4.3.3 RC1. Ihm afraid the problem is still there. Details in the attached BT3 file.Cheers,EgbertCreatedBacktrace on Kubuntu 14.04, with LO 4.3.3.2I'm having the same problem on Kubuntu 14.04 with LO 4.3.3.2. Just uploaded the backtrace, let me know if you need an example file, or anything else that would be helpful.I get the crash copying slides that contain a table, not just copying a table. Dragging and dropping works fine.Createdbt with debug symbolsOn pc Debian x86-64 with 4.3 sources updated today, I could reproduce the crash.But I don't reproduce the crash with master sources (future 4.4.0) updated yesterday.E Moen: I compared with fdo#85113 and there's the same bt + both seem ok with master sources. Could you tell if your tables were previously animated?No. No previous animation. Interesting fact: as I had to proceed with this presentation so as a work around I used Open Office (sorry for that). Although sluggish, OO did not crash on me when copying the tables.Have you tested with a fresh profile?.If not please do so.Also this is not a blocker - please do not revert the change as blockers have a very particular meaning and this does not meet that criteria.Setting to:Critical - routine crashes with backtraceHighest - going to add this to MAB as it's a consistent crash that results in loss of data.Thanks!Some time ago I did try working with a clean profile. I did not make any difference.***has been marked as a duplicate of this bug. ***I was having the same problem in Mac OS X. I first noticed the problem in 4.3.5, this appears to fixed in 4.3.6rc1.I did not see any problem using 4.2.8.2 on Linux. I do not use Windows.*** This bug has been marked as a duplicate of***
id=84854	On Windows 7 sp1, 64-bit en-US withVersion: 4.4.0.0.alpha0+Build ID: 7f900e2e2f5faa0a568209791c57cb024f14fe33TinderBox: Win-x86@42, Branch:master, Time: 2014-10-10_00:12:03Calc suddenly having issues with drawing its screen--background, foreground and borders of cells are being painted black as cells on sheet are traversed with cursor movements. Data entered seems to be present, and renders as a Thumbnail view.An existing spreadsheet will open and can be manipulated. Creatednewly created spreadsheet having drawing issuesWhere did you find 10-10? I can only find 2014-10-06Cannot reproduce: W7 w/(In reply to Joel Madero from)And yes everything was fine on the last TB39 build...Version: 4.4.0.0.alpha0+Build ID: 9177329a425cf70b515d1f266132838894fe54c6TinderBox: Win-x86@39, Branch:master, Time: 2014-10-06_01:02:02On Windows Vista, I tried Version: 4.4.0.0.alpha0+ Build ID: 86a3fe47a66950e26d23d7d7f2680fa7d4fb0839 TinderBox: Win-x86@39, Branch:master, Time: 2014-10-05_02:45:20 Version: 4.4.0.0.alpha0+ Build ID: 7f900e2e2f5faa0a568209791c57cb024f14fe33 TinderBox: Win-x86@42, Branch:master, Time: 2014-10-10_00:12:03 Version: 4.4.0.0.alpha0+ Build ID: 276a046d5256b14478ab283f420654df6ae76b55 TinderBox: Win-x86@42, Branch:master, Time: 2014-10-08_00:21:52with no visible problem. In each I created a new spreadsheet,ehntered data in a few cells, saved the file, closed the file,and opened the file.Stuart,Can you attach a spreadsheet for which you have rendering problem?Terry.Createdsimple calc ODS documentCalc is generating an ODS document, and calculating cell values--it has just lost its drawing interface for the actual table view.Createdscreen clip ofopen in CalcCreatedscreen clip of Start Center -- showing the thumbnail of the ODSDid a removal and fresh download, MD5/SHA256 hashes on both downloads match aslibo-master~2014-10-10_00.12.03_LibreOfficeDev_4.4.0.0.alpha0_Win_x86.msiMD5 c733ba5e829c6354e0ecd6b89a8884dfSHA-256 21211271e06f43c7e6696a4bd6c4d876265ffba343a46d9ea884a4e0495fdfa2Performed another /A administrative install, and configured in parallel.Exactly same results if creating a new ODS, or working with test ODS posted. Everything else seems OK, but just the drawing of the Spreadsheet elements are not refreshing with this build on Windows 7 sp1, 64-bit en-US.Something affection Calc only, so it is weird.Thanks for the link V Stuart Foote:Confirmed:Windows 7Version: 4.4.0.0.alpha0+Build ID: 7f900e2e2f5faa0a568209791c57cb024f14fe33TinderBox: Win-x86@42, Branch:master, Time: 2014-10-10_00:12:03Reproducible steps:Open LibreOfficeCreate new sheet.Immediately notice black boxes, inability to use spreadsheet correctly.Adding to 4.4 mab.Andrzej - have we merged our calc / tiled rendering goodness yet ? =)Not reproducible for me with Version: 4.4.0.0.alpha0+Build ID: 96adec2fd56d1ca09d679c0966567c674d812dfb updated few hours ago and built at home under Ubuntu 14.04 x86-64Best regards. JBFOn Windows 7 sp1, 64-bit en-US with today's TB42 buildVersion: 4.4.0.0.alpha0+Build ID: 7dc6c9af4ba313f054331f5130470d83d875bc16TinderBox: Win-x86@42, Branch:master, Time: 2014-10-11_13:41:48Issue reproducible for repainting the display of the spreadsheet table which seems to otherwise be functional.With Windows Vista running Version: 4.4.0.0.alpha0+ Build ID: 7f900e2e2f5faa0a568209791c57cb024f14fe33 TinderBox: Win-x86@42, Branch:master, Time: 2014-10-10_00:12:03and file "Loss-management-benchmarking Rev 1 (2).xlsx" attachedto<>, theprogram blacks out each cell as it is selected. The blacknessremains as the selection moves on.As before, I still see no problem with the .ods attached to thisbug report.Terry.I can confirm these issues too under both Linux and Windows. I've narrow it down to:Move this one to a common place too.- Goodvcl, sd: fix some TempFile leaks from vcl Graphic in cppunit tests- BADOn Windows 7 sp1, 64-bit en-USTB39 off line from 6th (which was correct), checked TB42 and no drawing issue through the 2014-10-09 build, so a regression somewhere in-=OK=-Version: 4.4.0.0.alpha0+Build ID: 276a046d5256b14478ab283f420654df6ae76b55TinderBox: Win-x86@42, Branch:master, Time: 2014-10-08_00:21:52Version: 4.4.0.0.alpha0+Build ID: 9aa36a1ad39e37c372cc833a44fba450b8cc30cdTinderBox: Win-x86@42, Branch:master, Time: 2014-10-09_03:25:27-=Goes Bad, loss of calc table rendering=-Version: 4.4.0.0.alpha0+Build ID: 7f900e2e2f5faa0a568209791c57cb024f14fe33TinderBox: Win-x86@42, Branch:master, Time: 2014-10-10_00:12:03Version: 4.4.0.0.alpha0+Build ID: 7dc6c9af4ba313f054331f5130470d83d875bc16TinderBox: Win-x86@42, Branch:master, Time: 2014-10-11_13:41:48Terry E.'s linked attachement 107727 .XLSX opens without issue with the TB42 builds from 2014-10-08 & 09, but then has the same drawing issue with TB42 builds for 2014-10-10 & 11. So issue is not affecting just .ODS format.Also, existing .ODS documents render correctly through the TB42 build on the 9th, but fail for build from 10th or 11th.I've further narrowed it down to:As of JDK version 1.5, show() and hide() in Dialog have been deprecated- BADSo the new range isRemains an issue with TB42 builds of master, and TB39 is off line.Version: 4.4.0.0.alpha0+Build ID: c967872d46a7cfd7c52063068313d5ec0356453eTinderBox: Win-x86@42, Branch:master, Time: 2014-10-13_00:02:37I have tracked down the first bad commit to "fdo#81356: convert Fraction to boost::rational<long> - wip"Juan, can you please look into this?(In reply to Luke from)So, what are the exact steps / settings / etc. to reproduce this? I see no problem with my Linux build.Literally 1: start libreoffice2: Start calc3: Try doing anythingImmediately black is seen and the black grows. I've only confirmed on Windows with the link provided inWell, it is affecting TB39 debug builds as well.Version: 4.4.0.0.alpha0+Build ID: c862be08158f502c42752f025d5cc6384285c688TinderBox: Win-x86@39, Branch:master, Time: 2014-10-13_14:55:05CreatedWinDbg StackTrace -- ~* k of Calc session launchOn Windows 7 sp1, 64-bit en-USStack Trace for WinDbg (6.3.96000.16384 x86) of TB39 debug buildVersion: 4.4.0.0.alpha0+Build ID: c862be08158f502c42752f025d5cc6384285c688TinderBox: Win-x86@39, Branch:master, Time: 2014-10-13_14:55:05Launch of LO from soffice.exe, attach to soffice.bin and issue WinDbg command: sxe -c "!pe;g" clr Open a new Calc document. Cursor R movement A1 -> A2 Then capture trace of all threads with WinDbg command: ~* kCreatedWinDbg stack trace after LO session endJust tail end of WinDbg session followingCreatedStack Trace of sb xstor call assertion failSorry for the noise of attaching another Stack Trace, but guess there is some chance thatand this bug are related.I just got another stack trace that looks very similar to crash of Draw when sidebar view is open.Get an Assertion failed in xstor.dll reference.h at line 402sblo!basic::SfxLibraryContainer::init_Impl --namecont.cxx--See attached WinDbg trace...Coincidence, or maybe just being attached to the Debug session?(In reply to V Stuart Foote from)They are not. The description ofsays it happenewithon build from Oct 8 already. The Fraction->boost::rational change that caused this bug has been pushed on Oct 9.CreatedNon trivial changes in "fdo#81356 .." 47a2d764Hi!Due that the commit "fdo#81356: convert Fraction to boost::rational<long> - wip"is a long one, i attach a file with the non trivial modifications ()I did a visual inspection of changes under sc module and only found trivial replacements.Note that due the old Fraction class allows the use of invalid rational values the problems can exists in another places thanthe listed in the attachSaw that David T. had poked at the fraction rational code, unfortunately thus far that is not the issue for the screen drawing with calc...Still an issue on Windows 7 sp1, 64-bit en-US withVersion: 4.4.0.0.alpha0+Build ID: defa080e585fb351bc4049b2f280d2e7e5256f6eTinderBox: Win-x86@39, Branch:master, Time: 2014-10-15_00:35:53I need to use a build after 10/11, because of, but Calc has been hosed by this issue. If you don't have a fix in the pipeline (I see nothing in gerrit), please undo commit 47a2d7642d249d70b5da0c330a73f3a0032e4bba so the rest of us can use Calc again. Confirmed on Win 7 32 bit Version: 4.4.0.0.alpha0+Build ID: defa080e585fb351bc4049b2f280d2e7e5256f6eTinderBox: Win-x86@42, Branch:master, Time: 2014-10-15_01:10:51ANDmy own build on 10/14 on Ubuntu 14.10hardware: dual core P4 3Ghz with ATI Radeon HD 4250...we're not going to make special accommodations so a single user can use daily builds.Joel,How are QA members supposed to do their job if developers commit patches that make major components unusable without even a fix in the pipeline? How long should any single developer be allowed to break master? We're going on a week now. A month, a year? Your blog is about demands. I did not demand. I made a suggestion with a "please" saying IF they did not "have a fix in the pipeline". How is this unreasonable? I have now reproduced this bug on a Win 8 laptop, Win 7 desktop, and Ubuntu 14.10 desktop. In addition, it seems this bug is reproducible by everyone here once they started using builds after 10/10, except oddly the commiter.And by the way, this includes you. SeeSo, NO, this is NOT about special accommodations for a SINGLE USER. This is about everyone, including the entire QA team of volunteers who can't do their job, because a major component is completely broken.(In reply to Joey Reid from)I do not reproduce the problem on my own build under Ubuntu 14.04 x86-64. even when I install my build on another PC under Xubuntu 14.04 x86-64 with a Unity session.Best regards. JBFCan anyone reproduce this with 64-bit build? And reciprocally, is there anyone who does not reproduce it with 32-bit build?I can reproduce this bug with a core T2400 CPU and ATI X1400 laptop under both Win 7, Mint 16, and Ubuntu 14.4. What GPUs do people who can reproduce this have? Could this be an ATI/AMD issue? For those with Linux who can't reproduce it, what happens when you test it from a 32-bit install such as a bootable USB flash or VM?I reproduce it under Win7x64 with a NVidia GeForce 9300M GS GPU NB9MUbuntu 14.04 x64 with Intel graphics cardDavid T., *,Reproducible on On 32-bit Fedora20 (VMWare Workstation 10.3, nVidia Quadro K2000)Version: 4.4.0.0.alpha0+Build ID: 3b6ee58652d99accd610425264114d1d5b3330dfTinderBox: Linux-rpm_deb-x86@45-TDF, Branch:master, Time: 2014-10-15_21:41:26Not reproducible on 64-bit Fedora20 (VMWare Workstation 10.3, nVidia Quadro K2000)Version: 4.4.0.0.alpha0+Build ID: 7f71e99e3f35e7b94aa426f588276d05bf86bf09TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2014-10-16_07:55:06So, always producible on 32-bit, not producible on 64-bit.GPU for 32-bit no impact (Intel, AMD, nVIDIA), all fail.On Fedora 20, 32-bit with LXDE DE spin (VMWare Workstation 10.0.2, nVidia GTX260)Prepped with a yum install of libreoffice 4.2.6.3 for any dependencies.Confirmed issues with this DE and build for Calc window repainting with prior TB45 buildsVersion: 4.4.0.0.alpha0+Build ID: 3b6ee58652d99accd610425264114d1d5b3330dfTinderBox: Linux-rpm_deb-x86@45-TDF, Branch:master, Time: 2014-10-15_21:41:26A test of today's 32-bit build from TB45 (with David T's additional work on the 32-bit Long and BigInt). No joy--the Calc screen paint issues remain.Version: 4.4.0.0.alpha0+Build ID: c68642d535f2ebb7f1cd866ad19b1fd018e7cd6dTinderBox: Linux-rpm_deb-x86@45-TDF, Branch:master, Time: 2014-10-18_23:03:32***has been marked as a duplicate of this bug. ***I had noticed this last week and thought i'd leave it and see if it gets fixed itself but didnt, so i reported a duplicate bug. :)From my linux testing on the available daily builds, it is fine inVersion: 4.4.0.0.alpha0+Build ID: ce5cc7afb0f1c99237d04e0c754527c725d8491cTinderBox: Linux-rpm_deb-x86@45-TDF, Branch:master, Time: 2014-10-06_19:35:48and broken inVersion: 4.4.0.0.alpha0+Build ID: 227ca23324fabd77abae1b7eb6186ba11d519faeTinderBox: Linux-rpm_deb-x86@45-TDF, Branch:master, Time: 2014-10-09_14:20:58Unfortunately, there isnt any 7th and 8th october builds to track it down more.bibisected ()The 4.4 bibisect should be out late next week to early the week after that. It would be fantastic if we could get a bibisect as soon as that comes out (assuming this isn't fixed in the meantime)Not reproducible on OSX 10.10Version: 4.4.0.0.alpha0+Build ID: d807cba9ee60cb1404b54addf9cd3e54de89f331***has been marked as a duplicate of this bug. ***Jphilips and Joel,There is no need to track anything down or bibisect. I manually, commit by commit, tracked this down to"fdo#81356: convert Fraction to boost::rational<long> - wip"A major component, Calc, has been unusable for almost 2 weeks now in all Windows builds and 32-bit Linux builds. May I respectfully request that we revert the patch so we can all use Calc again? Once this extremely critical bug has been resolved on a private branch, they can always reintroduce it.Luke, *,(In reply to Luke from)Guess I was not clear enough regardsandbisect identification of the issue. Sorry Joel.At this point, David and Juan have been on task and look to be closing in on the issue with SC drawing layerSuggest we see how that goes before any serious consideration of reverting things, Juan's boost::rational work will result in more stable and maintainable code going forward--this impact on 32-bit builds has been just an annoying hiccup.This issue is still reproducible on Version: 4.4.0.0.alpha1+Build ID: d0be09322d127e7d517851db38c764d57fbab2dccomes after David's last patch and the issue is still not resolved. Could we please start the discussion over the pros and cons of reverting commit 47a2d7642d249d70b5da0c330a73f3a0032e4bba? If Juan and David can't get this resolved soon, I think it's best for them to work off of a private branch.@Luke, noticed the summary change, so where can one get a 64-bit Windows build of LibreOffice? ;) This issue affects only 32-bit builds--done for Windows and Linux. And if we were still rolling 32-bit builds of master for OS X (TB 49) suspect it would be present there as well.FWIW yes still with us in todays TB39 32-bit debug build for Windows Version: 4.4.0.0.alpha1+Build ID: 9ecac3874d179b1d7aa6b45337001b1def06a9ddTinderBox: Win-x86@39, Branch:master, Time: 2014-10-22_06:32:56Confirmed on :Version: 4.4.0.0.alpha1+Build ID: a8c24b25fd9fb21097a08a22797bf61b59099ea1TinderBox: Win-x86@42, Branch:master, Time: 2014-10-21_06:31:17BernardI just discovered this today on Windows.Calc looks fine when you set the zoom level at 82% or below. Anything above that and the repaint starts to behave whacky.(In reply to Kohei Yoshida from)Actually change 82 to 75. at 75% zoom level Calc looks normal & scrolling appears to repaint correctly, though it still does wrong repaint here and there...(In reply to Kohei Yoshida from)Similar result with an affected 32-bit Linux build, at 75% the screen drawing is close to normal. But still glitches--like opening the Help --> About LibreOffice dialog which leaves residuals.Version: 4.4.0.0.alpha0+Build ID: c68642d535f2ebb7f1cd866ad19b1fd018e7cd6dTinderBox: Linux-rpm_deb-x86@45-TDF, Branch:master, Time: 2014-10-18_23:03:32Createdcapture of 1024x768 screen, after zooming from 65% to 95%With the mention of zoom factors in comments,, and 53, I seesomething that I find interesting.On my Toshiba Satellite model P200D-FT6 running Windows Vista SP232-bit, the system tray has an icon with initials "ATI" and mouseovertext "1440 x 900, (0<degree symbol>), Color:32 Bpp)", runningLibreOffice Version: 4.4.0.0.alpha1+ Build ID: 9ecac3874d179b1d7aa6b45337001b1def06a9dd TinderBox: Win-x86@39, Branch:master, Time: 2014-10-22_06:32:56I opened fdo_84854_testCalc.ods with the LibreOffice window"restored", and here is what I see:(1) At zoom factor 65%, approached from either direction, the display looks good.(2) I selected cell D3.(3) I clicked on the "+" in the zoom control three times, increasing the zoom factor to 95%. The row and column headings expand and the heavy outline of cell D3 expands and moves to stay aligned with the headings. The rest of the data area is not resized; without that rezising the data area still shows fragments of the cell-selection-box from smaller zoom factors. The cell borders from the smaller zoom factor are visible within the resized cell-selection-box of cell D3.(4) Another "+" in the zoom control increases the zoom factor to 100%. The data area looks good in every respect.(5) Another "+" in the zoom control increases the zoom factor to 110%. Again, the row and column headers expand, and the cell-selection-box is positioned and sized in accord with the new zoom factor. The rest of the data area remains at 100%, and it shows a fragment of the cell-selection-box as it was at 100%.(6) I dragged the About box around and closed it. Unlike the result that Stuart reports in, the data area was unchanged.When I changed the desktop area to 800 x 600 and then to 1024 by 768,results are unchanged.With the daily dbgutil bibisect version 2014-10-22, which is of course64-bit, I of course see no rendering artifacts. However, there is avisible lag (125 ms., at a guess) between painting the dark borderaround the selected cell and painting the rest of the data area. Youget to choose whether this observation is enlightening or merelyamusing <grin />.HTH,Terry.I can confirm this bug on the build machines of LHM (Ubuntu 12.04 32bit). I also confirm the bisected commit 47a2d7642d249d70b5da0c330a73f3a0032e4bbaBisect Report and Log:Screenshot of the error:I am adding these to the attachements as well.Createdgit-bisect logCreatedScreenshot on Ubuntu 12.04 LHM 32bitCreatedButtons invisible in 4.4 alphaI believe the issues with buttons and charts being invisible are related to this screen drawing issue.File used taken from this bug report:CreatedChart invisible in 4.4 alphaFile source:@Beluga, *,(In reply to Beluga from)As you'd mentioned during yesterdays QA IRC meeting.Yes I'd agree it is likely that screen painting issues caused by this regression are impacting import filters for both the XLS and OOXML spreadsheets referenced.On Windows 7 sp1 64-bit en-US withVersion: 4.4.0.0.alpha1+Build ID: 9ecac3874d179b1d7aa6b45337001b1def06a9ddTinderBox: Win-x86@39, Branch:master, Time: 2014-10-22_06:32:56Likely a manifestation of the drawing issues, the buttons do render, at grotesque size (still absent their diacritics on the text labels) when zoom is set to 65%. Likewise the chart is present (with legend items incorrect) but also far oversize. As if they can't identify an anchor and a scaling factor for placement.Thank you all for helping with this, and for finding out the exact commit that caused this!I have reverted the change, and the follow-up work there, Calc again works for me on Windows.The plan now is to use boost::rational in a less invasive way :-)The patches that fix this are:Yup. I can verify that it's all working again. :-)Fix verified for Ubuntu 12.04 LHM 32bitBoth files where I reported problems before are rendered correctly byLibreOffice: Version: 4.4.0.0.alpha1+ Build ID: 0a82645c360158f9cc0fdabe2a52f1ff8f981bed TinderBox: Win-x86@39, Branch:master, Time: 2014-10-24_06:59:23With reversion verified fixed on Windows 7 sp1, 64-bit en-US withVersion: 4.4.0.0.alpha1+Build ID: 0a82645c360158f9cc0fdabe2a52f1ff8f981bedTinderBox: Win-x86@39, Branch:master, Time: 2014-10-24_06:59:23Jan,On behalf of everyone with 32-bit systems and everyone on Windows, I want to thank you for taking the time to fix this issue. I can now get back to triaging bug reports.(In reply to Joey Reid from)No, quite the contrary--the decision to revert was the ESC's, the issue is not "fixed" and if anything an apology is due to David T. and Juan P. from the community for not hanging in there while the issues with the refactoring were resolved.The boost::rational refactoring for Fraction is a nice piece of code--it just needs a bit more work and review to make it right on 32-bit implementations. It is no different than the work Kohei did with the calc refactoring at 4.3--just a little more apparent to users of 32-bit builds.The price of QA and early adopters being intolerant of regressions caused by substantive rework of the code in master is stagnation of the project, and discouragement of talented developers to attempt any of the many things that could be improved in the code.I have no doubt that given a few more build cycles, the regression would have been resolved--and we'd have the Fraction structures implemented with more robust boost::rational methods. That is a shame.Stuart***has been marked as a duplicate of this bug. ***Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=86172	The new Help instalation file file is corrupt, the user interface does not bring up answers when typed into the search field. Version: 4.3.2.2Build ID: edfb5295ba211bd31ad47d0bad0118690f76407 The field search engine does not even load wrong answers. It does nothing at all. Test to see if it's because I'm using a Secondary partition, installed in user titled folder. unistall 4.3.2 and install 4.3.3then tell if it fix thingsThe software has issues when installed on a secondary partition, the issue consists of the folder pertaining to my name and in this folder was the libre office installed. It seems there may be restrictions being imposed in the software preventing it from functioning in a folder with someone's name. Example: D:/Myrealname/LibreOffice4/I use other softwares in the folder, there are no Computer security rights restrictions regarding the folder and drive. There may be issues with the factor of an anti-hack measure for DOS coding i use. Example: #^@%:/MyRealname/LibreOffice4 #^@% is the name I gave the Hardrive or partition. All other software's function properly except LibreOffice. I re-installed the LibreOffice on the OS hardrive Partion, it began to function.The OS drive partition use a similar name,Example: C:/Program Files/Libre Office4/it is $%&^*:PRogram Files/Libre Office4/The Libre Office Help File will not work on another partion other than The OS drive PArtition. All in all it is working now. It would be nice if the software were able to function on the second partition, in the folder Which is my name, for copyright purposes. Thank you for your assistance any how.The Idea was to have every File Created to have the Administrator privileges and rights coding in file creation in my name for every file I type using Libre Office. Which means because the Libre Office is installed in a folder with my name it will also put the program's instalation folder information in the Key file link layer docet.If you notice when you open administrator setting each Windows comes with a code serial which translates to the Computer User name. I want that code come through Libre Office on every file I create in the Core kernel of the Libre office file. Not even if they hack the file they can't say it's their own and Libre Office can clain rights on premises to protect client user reputation on file in any legal matter.Computer forensics will identify the file as a Client user document of Libre Office with the client's name.
id=85806	First of all, Hebrew is reversed. Second, When writing Hebrew words and then enter spaces the words gets distorted. To reproduce:***************Switch to RTL and Hebrew keyboard. 1. bug - reversed order:write some words in hebrew. Expected:The words are written RTL - letter after letter. Actual:the words written in reverse. All letters are added on the right. 2. bug - distortion when adding spaces or other words (This is already happening on 3.2. )Write 2 words in Hebrew and then add spacesExpected:the first words remains the same and spaces are added to its left.Actual:The words get distorted. The above bugs happens only on MAC. Every time (Fully reproducible). All of the above apply also to Arabic. The commit I built was 1071eccd037390774b6d3f1aade9af02fd2cbe54(But, as I said the second bug happens even on the 3.2 version). Small fix - none of the problems happens on the prior versions just on the master.Confirming that RTL doesn't work on master Version: 4.4.0.0.alpha2+Build ID: c1358e5dc875bb923f4b5472ba615ebd19f0d057tried Hebrew and ArabicArabic seems to work OK in LO 4322 - regressionif this bug is only happening on Mac and not Win/Linux then probably it's a bug in VCL, not Writer.CloudOn says they have a fix for this but they have been too busy to submit it.Yes. Found the bug. It's in the ctlayout.cxx. Will be soon submitted (sorry. no free time lately :)(This is an automated message.)LibreOffice development currently prioritizes bugs with the so called MAB (most annoying bugs) -- as this bug has not run through that process (including writing a short rationale for this bug being a candidate and other who are watching the tracker bug silently approving that rationale etc.) its priority is set to high. Note this is effectively no change in the urgency assigned to this bug, as we are currently not making a difference between high and highest and severity is untouched.You can find out more about MABs and how the process works by contacting libreoffice qa on irc:The QA wiki page also gives you hints on how to get in contact with the team (if IRC fails you, your next best choice is the mailing list):Gal Bar-Nissan, any news...? Would be nice to get this fixed in 4.4.Please read this message in its entirety and do not revert change.This is simply an update to the priority/severity of the bug. Blockers are reserved for incredibly rare cases which this bug does not meet. We use an objective standard of what is or is not a blocker and this does not count as a blocker.Setting priority:Critical - major loss of functionalityHighest - adding to MAB because of this functionality loss plus regression.Again please do NOT change the severity back as it does not help at all in pushing the bug forward and instead only confuses our objective standards - leading to developers not trusting the system. Setting to blocker will have zero impact towards moving the bug forward.Thanks for your understanding.pushed a fixing patch:galbarnissan committed a patch related to this issue.It has been pushed to "master":fdo#85806: Hebrew and Arabic is not working on MACIt will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.galbarnissan committed a patch related to this issue.It has been pushed to "libreoffice-4-4":fdo#85806: Hebrew and Arabic is not working on MACIt will be available in 4.4.0.0.beta2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Assuming that the above commits are the complete fix for this, I’m closing this report.
id=86216	CreatedVery small spreadsheet that demonstrates BUG 2Quite simply, for my spreadsheet, SORT on LibreOffice CALC (4.1 something) that shipped with Ubuntu 12.04 worked, and version 4.2.7.2 does not. I have tested it again on my Ubuntu 12.04 machine and the same operations work properly. I have included an example spreadsheet with only 6 cells of data that demonstrates BUG 2.Potential for Work AroundsIt is not convenient to use only my 12.04 machine, it is at a different geographical location. It is not convenient to downgrade my 14.04 machine to 12.04, it is a touch screen laptop and 12.04 does not give me functionality. Attempts to just downgrade LibreOffice have not been readily successful. Background: Size of my SpreadsheetMy spreadsheet is very large (12 tabs, 2500+ rows in one tab, columns up to W and Z used in two tabs), however, 4.2.7.2 cannot handle sorting even a fraction of it, where 4.1-something can still sort it. The spreadsheet saves as 1.7M in size. BUG 1: Crashes when trying to Sort:If I try to sort 2582 (actually anything more than about 1/3 of that) rows of data spread across columns A-W by column C and D, or D and C, LibreOffice 4.2.7.2 crashes outright. That was really irritating. This problem has existed since I installed 14.04 on a new machine, 4-5 months ago. I have been using filters on column C to avoid sorting as a band-aid, waiting for someone to recognize they broke it, and fix it. BUG 2: Not correctly re-referencing formuli after the sortToday I discovered another problem. LibreOffice 4.2.7.2 is mangling smaller sorts. I have about 100 rows of data in columns A to W. Column A is text. Column B is a formula that does string manipulations on A to convert one style of label to another style of label. (The labels in column A took on form historically and changed form in 2010. Column B redoes labels into a numerical number. Old labels are rendered into a number that makes them sort properly with numbers from the new style. The labels are job numbers.) The formuli in B6 is: =IF(A6="","",IF(MID(A6,7,1)=".",VALUE(MID(A6,2,7)),VALUE(MID(A6,3,1))*1000+VALUE(MID(A6,4,3))+VALUE(MID(A6,2,1))/10))Nothing terribly bizzare, and, certainly not illegal in any way. If I highlight the block A6-A8, and sort by column B ascending, then the data in column A (no formuli) is in proper order (like it remembered HOW to sort by B), but the formula in B6 is now:=IF(A8="","",IF(MID(A8,7,1)=".",VALUE(MID(A8,2,7)),VALUE(MID(A8,3,1))*1000+VALUE(MID(A8,4,3))+VALUE(MID(A8,2,1))/10))the cell numbers in formuli are not being properly preserved to refer to the data they were originally referring to in its NEW location. They are now referring to where the data was. The data in A6 was in A8 before the sort. When it was moved from A8 to A6 in the sort, the references in the formuli in the matching rows was not changed from A8 to A6. Other cells in the rows being sorted do refer to other tabs of the sheet, and use functions like SUMIF and INDEX and MATCH to get all the data referring to one job in one row. All these formuli are mucked up in exactly the same manner at column B formuli, but, they are way more complicated and a complete formuli and all dependent data cannot be pasted here as easily as the formula for column B. In my sheet, in a given column, some rows have formuli dependent on other cells or tabs, some have constants or strings. Editing the formuli to be correct on the top row and copying them down will erase the constants and strings and replace them with formuli that result in different data than existed before the sort. This goes to the very heart of what a sort is. If one does not notice it mucking up, years of work can be mangled beyond repair. Fortunately an assistant mangled this sheet once before years ago by failing to sort all columns, I managed to repair it and since then I have paranoidly saved the file with a new version number every time I save it. I was able to go back, but this is not allowing me to go forward. Attached is a small paste from my spreadsheet, a sheet with only A6-B8 in it (same formuli as above). This is what it looks like to me before shorting by B ascending:S14004.1 14004.1S12082.1 12082.1S12015.4 12015.4This is what is looks like after sorting by B ascending:S12015.4 14004.1S12082.1 12082.1S14004.1 12015.4This is obviously wrong. Please contact me atif there is some default setting of 4.2.7.2 that makes its sorts completely different than every spreadsheet program that went before it that I can correct and make it sort the way every earlier spreadsheet program sorted. Edits:edit one:(The labels in column A took ONE form historically and changed form in 2010. Column B redoes labels into a numerical number. Old labels are rendered into a number that makes them sort properly with numbers from the new style. The labels are job numbers.)edit two:Nothing terribly bizzare, and, certainly not illegal in any way. If I highlight the block A6-A8, and sort by column B ascending, then the data in column A (no formuli) is in proper order (like it remembered HOW to sort by B), but the formula in B6 is now:obviously should read:Nothing terribly bizzare, and, certainly not illegal in any way. If I highlight the block A6-B8, and sort by column B ascending, then the data in column A (no formuli) is in proper order (like it remembered HOW to sort by B), but the formula in B6 is now:(In reply to m_j_malone from)Hiya,Sorry to hear that you're experiencing a regression (and crash) in LibreOffice.Given that the 4.2 line just had its last release, could you please verify your results in our (newer) 4.3 branch? Thanks!Please attach an example of a spreadsheet that demonstrates this problem. (If the file is too large to attach, please try compressing it. If it's still too big, leave a note and we'll get the file another way :-)This sounds like it could be a separate bug. Please file a new bug report for it.Thanks!Once you've attached the example spreadsheet (and hopefully filed #2 as a new bug report), please change the status back to 'UNCONFIRMED'.Thanks!Status -> NEEDINFOHow about you just forget Bug1 and answer Bug2? I cannot post that spreadsheet, it is propriety and I did post a spreadsheet for bug 2. I have no time to go through the hassle of downloading 4.3 and testing it. I downgraded to a version that works. When Ubuntu comes out with a new long term service release, I might upgrade, if I have the time. Right now I am kind of busy fixing my mangled spreadsheets. I see bug #2 hit the news already.Too bad LibreOffice did not warn me in a really obvious way that they changed something so fundamental and standardized across other spreadsheets before the sorting mangled my spreadsheet.(In reply to m_j_malone from)We've got literally thousands of bug reports filed against LibreOffice. We're trying to go through them as quickly and efficiently as possible, so please help us out by filing just one bug per report.It's really hard for us to track down a crash or a performance problem without having the ability to reproduce the problem ourselves. This page can help you remove any proprietary information from your document before you post it:LibreOffice 4.2 will reach End of Life in 1 week:...at that point we'll need someone to reproduce this bug using a modern build of LibreOffice (either 4.3 or a pre-release/dev build of 4.4). That helps us to confirm that the problem still exists in versions we're currently shipping.Upgrading is totally up to you. If you upgrade, you can help us identify if the crashing problem still exists, which in turn will allow us to improve LibreOffice not just for you, but for everyone. I think it's a clear win-win situation for both of us.Your test file is corrupted or faulty, when I open it with LO 4.2.6 or LO 4.4.0.0.alpha2 I get Err:502 in B1:B3. If it is the result of the sorting, please attach alse the test file in its state before sorting.Set status to NEEDINFO. Please set it back to UNCONFIRMED once you have provided requested informations. Thank you for your understanding.Best regards. JBFHere is a second, even simpler spreadsheet that 4.2.7.2 cannot sort properly. Ask it to sort by column B ascending with A1-B2 as the range. As for the process described for altering a spreadsheet to remove confidential data, I have examined it. The process would not remove the uniqueness of the numbers of the spreadsheet. I might recommend that LO add a 2 functions to anonymize data in a range. The first function goes through each cell in the defined range. It examines the contents and replaces it and all identical occurences of that data (either numerical or text) with a random equivalent everywhere in all tabs of the spreadsheet. For occurrences found within the defined range, they are marked as "done" and are not doubly randomized. Text becomes random text of similar length. Numbers become random numbers (never zero) of similar parameters. So $5.45 becomes $10.71, but never 6.024E24 for instance. The second function does not make global searches and replaces, the data in each cell is just replaced with random data of similar nature. Therefore two occurences of $5.45 become different amounts. One might then randomize a spreadsheet with little manual labour while maintaining the action of MATCH and SUMIF operations. If the linking of these functions were not preserved in the randomization of my spreadsheet, it would completely change the nature of sorting it. However, someone will no doubt point out there is some other archane system for making suggestions.Returning to the problem of 4.2.7.2 not sorting correctly, In this reference:Lukebenes reportedly supplied a spreadsheet that 4.2.7 could not sort properly (the same way 4.2.6 did) with either setting of the secret setting. Luke (lukebenes) wrote (in part) on 2014-11-11: ...To be clear, with 4.2.7 there is no way to return to the old style sorting routine. Some spreadsheets that worked fine in Excel and 4.26 require UpdateRefs=True, while others require it to be false. Others are broken with either UpdateRefs setting because of bugs introduced in this new sorting routine. Is it any wonder users are confused?I recommend taking his sample spreadsheets from that thread test_offset.ods and Calc bug.ods and verify those. This matter is so urgent, I hope someone can use a little imagination and use these sources in other bug reports as tests.CreatedEven smaller file that sorting A1-B2 by column B ascending fails in 4.2.7.2Jean-Baptiste Faure, you are the same person who proposed the preposterous:That lead to all the problems and mangled my spreadsheet and many others. I do not consider you either sufficiently knowledgeable because of all the damage you have cause, nor sufficiently independent to resolve this bug. I ask that you recuse yourself from this matter. Before you go citing what various other programs promised to do with sorting, like you do here:And attack what Microsoft has written, you should know, I do not care what any other spreadsheet program developer wrote. I want 4.2.7.2 to work like 3.5 did on Ubuntu 12.04 (yes, that is a correction) because this was compatible with what Excel did. I have been told 4.2.6 is compatible with Excel also. I have downgraded to 4.1.6.2 and it behaves as Excel did. Anything that you change that makes LibreOffice incompatible with what previous versions, and other spreadsheet programs DID and leads to mangling of spreadsheets is not an enhancement, it is breaking it.(In reply to m_j_malone from)Please, explain. I reportedto show that the fix forintroduced a regression when sorting spreadsheets like.Best regards. JBFEnd the mangling that is going on right now out there in the field. That should be the #1 priority. The priority should NOT be polishing FRESH and STILL and discussing obscurities and poorly composed spreadsheets that never would have worked with a cut and paste hand-sort model of what sort is conceptually. You cannot make every stupid use of links work in every case with sort without violating the concept of what a sort is. Again, if you want something that is not a cut-and-paste model sort of records, create a new button called MANGLE for it so there is no confusion. Call it the mangle enhancement. So it appears Kohei Yoshida introduced a bug in some obscure use to correct for some badly written sheet. Then after discussion with you, and with your cooperation introduced another bug and a secret option that does not work properly (like other spreadsheet programs) in either setting. This was then pushed out to existing working versions, with your assistance and cooperation. Even after being shown proof, you defended this noconforming behaviour as an enhancement. And I have yet to see any unequivocally statement that all traces of this debacle have been withdrawn from 4.2.7.2 -- the first and the second change so that 4.2.7.2 works as previous versions and other spreadsheets do. I hear what others have said, that it is not possible, now that the bad code is in 4.2.7.2, only creating an upgrade version without any of this bad code in it, 4.2.8 for instance, will solve this problem. And you seem completely oblivious to the users out there STILL using a mangling version of 4.2.7.2 (because that is what was delivered with Ubuntu 14.04 LTS) who STILL have not noticed they are mangling their old spreadsheets every time they have sorted them. What is the plan to stop the mangling that is going on right now ? If 4.2.6.2 is absent of any trace of this foolishness, then why did someone not copy it to a new directory called 4.2.8 and trigger an update of all 4.2.7.2 to code that works like other spreadsheets do ? End the mangling, that should be priority #1, not this overly detail oriented discussion referencing bug reports. WIND IT BACK. Do it now. Why was that not done several days ago? Today is Friday, a lot of people have automated backups that run on the weekend. Their hope to retrieve a non-mangled version of their years-old spreadsheet might be gone by Monday. Oh, oh, is the excuse going to be that this is free software, all software has bugs, we are just volunteers ? How long would it take to copy all of 4.2.6.2 (or whatever works like other spreadsheets do, and earlier versions of LibreOffice did) to 4.2.8 and save people years of pain. To me it seems so easily done that it would be like not helping an old lady up off the sidewalk. You just have no concept of how valuable old spreadsheets are to people, even when told, over days, over several threads, bug reports. I want to hear in all these threads, an unequivocal statement, all of this foolishness has been completely extracted from the code and will never appear in any future version. So now some plain-English questions you might be able to answer. I do not want to hear any more euphemisms like regression or gobbledy-gook about current, fresh, whatever, or citations to other bug reports that are just as difficult to read through, or have to run one more badly composed sample sheet through 4.1.6.2 to discover, there was never a problem before you started monkeying with it. When, what date and time, will it be safe to accept updates to LibreOffice through the Ubuntu software centre ?When will there be a plain English assurance that all traces of this foolishness have been completely and utterly removed from the pipeline? Or are there people at LibreOffice still clinging to this as an "enhancement" and are leaving it in in any form, even as an option? Anything less than a clear statement of a complete and utter withdrawl of all parts of this from the pipeline, will say to me, all versions of LibreOffice past 4.1.6.2 (the version I currently use) are potential years of work-destroying poison that are incompatible with every other spreadsheet program and are to be avoided at all costs. Daily I will have to uncheck to decline updates to LibreOffice through the software centre. One day that will just become too much tedium, and I will move to another office package. When others finally discover their sheets have been mangled for more than a week now, with you fully aware of it, and you have done nothing to push functional software to their machine through updates, and they read even a fraction of these pages, I doubt many of them will even give LibreOffice a second chance. End the mangling that is going on right now out there in the field. That should be the #1 priority. Then a clear statement so I believe you and all of LibreOffice finally understand.Works as expected with versions 4.3.4 and master (4.4.0.0.alpha2) whatever the value of the option UpdateReferenceOnSort is.Please, try again with the last update of the version 4.2.7 provided by Ubuntu.Closing as WorksForMe.
id=86402	Hello and thanks,I have 3 problems: two with password encrypted spreadsheet files, one withhe using English and Persian in one file, as follows:1. I have an excel 2007 file, which I've encrypted with one password for viewing and editing. LibreOffice Calc opens with the password, but won't let me edit, and although I've hit many keys, when I want to close, doesn't ask for saving, which of course means it has opened as a read-only file. I think it is because Calc accepts one password only.2. Now, I have another xlsx file, with the same password for viewing and opening, but with different name and contents from the former. When I want to open this latter while the former is open, it asks for password, but won't let me type my password in the box!I have saved these two files as .ods too, yet the same problem exists without any change.3. Another problem is that when I type in Persian, I cannot see upper part of the characters (this exists in the Writer too, and in the worst form ever possible, which I'll report right after this one), and worse than that, when I open an excel file (*.xlsx), the sheets of which have a right-to-left order, and I add another sheet, no matter what I do, this last one will have a left-to-right order!These bugs are making me use Microsoft Office yet, and I don't want to; it's an agony to do your work partially: some parts on another system with MsOffice, and some on my own Kubuntu.Thanks again for bearing with me to the end of this endless report! :-) Hello,Thank you for filing the bug. Please send us a sample document, as this makes it easier for us to verify the bug. I have set the bug's status to 'NEEDINFO', so please do change it back to 'UNCONFIRMED' once you have attached a document.(Please note that the attachment will be public, remove any sensitive information before attaching it.)How can I eliminate confidential data from a sample document?Thank youHello and sorry for late answer. I, unfortunately, have deleted the files, but I know what exactly I'd done immediately before the issue showed up, so, I'll make two again as soon as I can, and let you know.Thanks againDear Bug Submitter,This bug has been in NEEDINFO status with no change for at least 6 months. Please provide the requested information as soon as possible and mark the bug as UNCONFIRMED. Due to regular bug tracker maintenance, if the bug is still in NEEDINFO status with no change in 30 days the QA team will close the bug as INVALID due to lack of needed information.For more information about our NEEDINFO policy please read the wiki located here:If you have already provided the requested information, please mark the bug as UNCONFIRMED so that the QA team knows that the bug is ready to be confirmed.Thank you for helping us make LibreOffice even better for everyone!Warm Regards,QA TeamThis NEEDINFO message was generated on: 2015-07-18Dear Bug Submitter,Please read this message in its entirety before proceeding.Your bug report is being closed as INVALID due to inactivity and a lack of information which is needed in order to accurately reproduce and confirm the problem. We encourage you to retest your bug against the latest release. If the issue is still present in the latest stable release, we need the following information (please ignore any that you've already provided):a) Provide details of your system including your operating system and the latest version of LibreOffice that you have confirmed the bug to be presentb) Provide easy to reproduce steps – the simpler the betterc) Provide any test case(s) which will help us confirm the problemd) Provide screenshots of the problem if you think it might helpe) Read all comments and provide any requested informationOnce all of this is done, please set the bug back to UNCONFIRMED and we will attempt to reproduce the issue. Please do not:a) respond via email b) update the version field in the bug or any of the other details on the top section of FDOMessage generated on: 2015-09-03
id=86552	In the macro editor of DrawCtrl-A, Ctrl-X, Ctrl-ZIt was segmentation fault occurs After running the above.[My Macros & Dialogs] standardModule1Ctrl-A,Ctrl-X,Ctrl-ZProgram received signal SIGSEGV, Segmentation fault.0x00007ffff10c669d in rtl::OUString::isEmpty (this=0x7fffd826d840) at /home/buildslave/source/libo-core/include/rtl/ustring.hxx:406406 /home/buildslave/source/libo-core/include/rtl/ustring.hxx: No such file or directory.(gdb) bt#0 0x00007ffff10c669d in rtl::OUString::isEmpty (this=0x7fffd826d840) at /home/buildslave/source/libo-core/include/rtl/ustring.hxx:406#1 0x00007ffff1366285 in TextEngine::ImpGetRightToLeft (this=0x7fffd825c650, nPara=3, nPos=177, pStart=0x0, pEnd=0x0) at /home/buildslave/source/libo-core/vcl/source/edit/texteng.cxx:2968#2 0x00007ffff1363370 in TextEngine::CreateLines (this=0x7fffd825c650, nPara=3) at /home/buildslave/source/libo-core/vcl/source/edit/texteng.cxx:2293#3 0x00007ffff135f8f5 in TextEngine::FormatDoc (this=0x7fffd825c650) at /home/buildslave/source/libo-core/vcl/source/edit/texteng.cxx:1568#4 0x00007ffff135f26b in TextEngine::FormatAndUpdate (this=0x7fffd825c650, pCurView=0x7fffd8333ac0) at /home/buildslave/source/libo-core/vcl/source/edit/texteng.cxx:1467#5 0x00007ffff1374544 in TextUndoManager::UndoRedoEnd (this=0x3d16ff0) at /home/buildslave/source/libo-core/vcl/source/edit/textundo.cxx:124#6 0x00007ffff137439a in TextUndoManager::Undo (this=0x3d16ff0) at /home/buildslave/source/libo-core/vcl/source/edit/textundo.cxx:87#7 0x00007ffff45c29e9 in SfxViewFrame::ExecHistory_Impl (this=0x7fffd82700b0, rReq=...) at /home/buildslave/source/libo-core/sfx2/source/view/viewfrm.cxx:945#8 0x00007ffff45be41d in SfxStubSfxViewFrameExecHistory_Impl (pShell=0x7fffd82700b0, rReq=...) at /home/buildslave/tinderboxbuild/workdir/SdiTarget/sfx2/sdi/sfxslots.hxx:688#9 0x00007ffff42794aa in SfxShell::CallExec (this=0x7fffd82700b0, pFunc=0x7ffff45be3fa <SfxStubSfxViewFrameExecHistory_Impl(SfxShell*, SfxRequest&)>, rReq=...) at /home/buildslave/source/libo-core/include/sfx2/shell.hxx:209#10 0x00007ffff42a09f5 in SfxShell::ExecuteSlot (this=0x7fffd82700b0, rReq=..., pIF=0x3bc3fa0) at /home/buildslave/source/libo-core/sfx2/source/control/shell.cxx:453#11 0x00007fffc5a7740e in basctl::Shell::ExecuteCurrent (this=0x7fffd82781c0, rReq=...) at /home/buildslave/source/libo-core/basctl/source/basicide/basides1.cxx:193#12 0x00007fffc5a84261 in SfxStubbasctl_ShellExecuteCurrent (pShell=0x7fffd82781c0, rReq=...) at /home/buildslave/tinderboxbuild/workdir/SdiTarget/basctl/sdi/basslots.hxx:153#13 0x00007ffff42794aa in SfxShell::CallExec (this=0x7fffd82781c0, pFunc=0x7fffc5a8423e <SfxStubbasctl_ShellExecuteCurrent(SfxShell*, SfxRequest&)>, rReq=...) at /home/buildslave/source/libo-core/include/sfx2/shell.hxx:209#14 0x00007ffff4270bf7 in SfxDispatcher::Call_Impl (this=0x7fffd826f180, rShell=..., rSlot=..., rReq=..., bRecord=true) at /home/buildslave/source/libo-core/sfx2/source/control/dispatch.cxx:260#15 0x00007ffff4273a95 in SfxDispatcher::_Execute (this=0x7fffd826f180, rShell=..., rSlot=..., rReq=..., eCallMode=RECORD) at /home/buildslave/source/libo-core/sfx2/source/control/dispatch.cxx:862#16 0x00007ffff42609d2 in SfxBindings::Execute_Impl (this=0x7fffd82705e0, aReq=..., pSlot=0x7fffc5e23f30, pShell=0x7fffd82781c0) at /home/buildslave/source/libo-core/sfx2/source/control/bindings.cxx:1204#17 0x00007ffff42de1b3 in SfxDispatchController_Impl::dispatch (this=0x3ff2f00, aURL=..., aArgs=..., rListener=...) at /home/buildslave/source/libo-core/sfx2/source/control/unoctitm.cxx:851#18 0x00007ffff42dbf05 in SfxOfficeDispatch::dispatch (this=0x7fffc5e48908, aURL=..., aArgs=...) at /home/buildslave/source/libo-core/sfx2/source/control/unoctitm.cxx:365#19 0x00007ffff348e1f7 in svt::AsyncAccelExec::impl_ts_asyncCallback (this=0x3fe81b0)---Type <return> to continue, or q <return> to quit--- at /home/buildslave/source/libo-core/svtools/source/misc/acceleratorexecute.cxx:475#20 0x00007ffff348e17f in svt::AsyncAccelExec::LinkStubimpl_ts_asyncCallback (pThis=0x3fe81b0, pCaller=0x0) at /home/buildslave/source/libo-core/svtools/source/misc/acceleratorexecute.cxx:468#21 0x00007ffff10cbfd2 in Link::Call (this=0x3fe81b8, pCaller=0x0) at /home/buildslave/source/libo-core/include/tools/link.hxx:139#22 0x00007ffff1608aab in vcl::EventPoster::DoEvent_Impl (this=0x3fe81b0, pEvent=0x0) at /home/buildslave/source/libo-core/vcl/source/helper/evntpost.cxx:53#23 0x00007ffff1608a67 in vcl::EventPoster::LinkStubDoEvent_Impl (pThis=0x3fe81b0, pCaller=0x0) at /home/buildslave/source/libo-core/vcl/source/helper/evntpost.cxx:49#24 0x00007ffff10cbfd2 in Link::Call (this=0x4739a20, pCaller=0x0) at /home/buildslave/source/libo-core/include/tools/link.hxx:139#25 0x00007ffff1268f80 in ImplHandleUserEvent (pSVEvent=0x46ef6c0) at /home/buildslave/source/libo-core/vcl/source/window/winproc.cxx:1920#26 0x00007ffff126a42b in ImplWindowFrameProc (pWindow=0x3bc6300, nEvent=22, pEvent=0x46ef6c0) at /home/buildslave/source/libo-core/vcl/source/window/winproc.cxx:2491#27 0x00007ffff16f1a3d in SalFrame::CallCallback (this=0x3bc6c70, nEvent=22, pEvent=0x46ef6c0) at /home/buildslave/source/libo-core/vcl/inc/salframe.hxx:242#28 0x00007ffff16f1572 in SalGenericDisplay::DispatchInternalEvent (this=0xf6b2f0) at /home/buildslave/source/libo-core/vcl/generic/app/gendisp.cxx:90#29 0x00007fffe3f44a0d in GtkData::userEventFn (data=0x618bb0) at /home/buildslave/source/libo-core/vcl/unx/gtk/app/gtkdata.cxx:935#30 0x00007fffe3f44a68 in call_userEventFn (data=0x618bb0) at /home/buildslave/source/libo-core/vcl/unx/gtk/app/gtkdata.cxx:945#31 0x00007fffeca01355 in g_main_context_dispatch () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#32 0x00007fffeca01688 in ?? () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#33 0x00007fffeca01744 in g_main_context_iteration () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#34 0x00007fffe3f43997 in GtkData::Yield (this=0x618bb0, bWait=true, bHandleAllCurrentEvents=false) at /home/buildslave/source/libo-core/vcl/unx/gtk/app/gtkdata.cxx:575#35 0x00007fffe3f478bc in GtkInstance::Yield (this=0x618b00, bWait=true, bHandleAllCurrentEvents=false) at /home/buildslave/source/libo-core/vcl/unx/gtk/app/gtkinst.cxx:420#36 0x00007ffff163c01e in ImplYield (i_bWait=true, i_bAllEvents=false) at /home/buildslave/source/libo-core/vcl/source/app/svapp.cxx:360#37 0x00007ffff1638a73 in Application::Yield () at /home/buildslave/source/libo-core/vcl/source/app/svapp.cxx:392#38 0x00007ffff1638a21 in Application::Execute () at /home/buildslave/source/libo-core/vcl/source/app/svapp.cxx:341#39 0x00007ffff785bfc4 in desktop::Desktop::Main (this=0x7fffffffdfe0) at /home/buildslave/source/libo-core/desktop/source/app/app.cxx:1638#40 0x00007ffff164015a in ImplSVMain () at /home/buildslave/source/libo-core/vcl/source/app/svmain.cxx:160#41 0x00007ffff1640250 in SVMain () at /home/buildslave/source/libo-core/vcl/source/app/svmain.cxx:193#42 0x00007ffff789ff6d in soffice_main () at /home/buildslave/source/libo-core/desktop/source/app/sofficemain.cxx:93#43 0x00000000004009b7 in sal_main () at /home/buildslave/source/libo-core/desktop/source/app/main.c:48#44 0x000000000040099d in main (argc=1, argv=0x7fffffffe2c8) at /home/buildslave/source/libo-core/desktop/source/app/main.c:47(gdb) I can reproduce that bug with Version: 4.4.0.0.beta1 Build ID: 9af3d21234aa89dac653c0bd76648188cdeb683e.But I can't see this issue with Version: 4.4.0.0.alpha1+ Build ID: b800d0b6ad74ce4a9adb23b865dd174d1eefa47b (latest of 44alpha2only bibisect repo).(In reply to TANAKA Hidemune from)CONFIRMED with LO 4.4.0.0.beta1 + Ubuntu 14.04Just1) Open a new Draw document2) Tools -> Macros -> Organize Macros -> LibreOffice Basic3) Click 'Edit' button4) Ctrl-A, Ctrl-X, Ctrl-ZAnd Boom! LibreOffice crashes.Status -> NEWI'll prioritize that as High/Critical, as it crashes consistently, but Macro editing isn't a very common activity for users.Hmm, so probably a regression. We'll be updating the bibisect repository to include the period from the alpha1 - beta1 very shortly.(In reply to Robinson Tryon (qubit) from)NOREPRO with 4.4.0.0.alpha2 + Ubuntu 14.04, so definitely a regression.(In reply to Robinson Tryon (qubit) from)Same crashing behavior when editing Macros in Writer (and probably other Components).(Use correct version in Version Field)Git bisect points at this commit:commit 63d8977f9fb0618d36dc8e0ee2f8068b1af92fe6Author: Michaël Lefèvre <>Date: Sat Nov 15 11:41:49 2014 +0100 fdo#75757 remove inheritance from std::vector For TextDoc, also removing ToolsListAlso setting component to BASIC as this isn't related to drawing - the BASIC IDE behaves the same wherever it's opened fromMichaël LefèvreCould you please look into this regression? Thanks!(In reply to Luke from)Yes I will, but not before december 20th.You could revert my commit if we need to fix it ASAP. It's just code cleaning, not really a feature.(This is an automated message.)Setting priority to highest as this is a MAB. This is part of an effort to make the importance of MAB reflected in priority too.it'll be this problem hereTextNode* GetNode(sal_uInt16 pos) { return &maTextNodes[pos]; }where that returned Node belongs to maTextNodes and will be deleted along with it, but the undo code tries to get maTextNodes to *release* that node and pass ownership to it and will manage it itself, which can't work the way the code is right now.Caolán McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: fdo#86552 undo want to take ownership of nodes, but can'tIt will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-4":Resolves: fdo#86552 undo want to take ownership of nodes, but can'tIt will be available in 4.4.0.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Migrating Whiteboard tags to Keywords: (regression)[NinjaEdit]
id=86624	CreatedTest file with legend manually placedDescription: Legend in chart appears always at top left corner if it has been manually placedSteps to reproduce:1. Create a chart2. Click and drop legend to move it inside Chart3. Save4. ReloadActual behavior:Legend appears at top left cornerExpected behavior:Legend should be at the place it has been placedReproduced with LibO 4.4.0.0.beta1Not reproduced with LibO 4.3.4.1 Reproduced with- Version: 4.4.0.0.alpha2+Build ID: 6143fa5a89d9528fc11fed1e7fe96b9280d411a4TinderBox: Win-x86@42, Branch:master, Time: 2014-11-10_22:48:21- Version: 4.4.0.0.alpha1+Build ID: 9ecac3874d179b1d7aa6b45337001b1def06a9ddTinderBox: Win-x86@42, Branch:master, Time: 2014-10-22_06:31:01- Version: 4.4.0.0.alpha0+Build ID: 6a6e8628bdbe60931ce8e7fa9f4bb66170f7737bTinderBox: Win-x86@42, Branch:master, Time: 2014-09-29_23:55:43NOT reproduced with- Version: 4.4.0.0.alpha0+Build ID: 37b9ea92ba81d74764a2345a9c75c65bfd272d2bTinderBox: Win-x86@42, Branch:master, Time: 2014-08-26_09:37:01So regression introduced between 2014-08-26_09:37:01 and 2014-09-29_23:55:43***has been marked as a duplicate of this bug. ***This sounds like it was the same as.If so, which of the two should be marked as a duplicate?bibisected by Michael Weghorn 2015-01-30 19:48:26 UTCfrom$ git bisect log# bad: [4a3091e95fa263d3e2dd81e56e83996f0bb12287] source-hash-2b5b04e1e62914bf0902dfd7943cdc44499c47a6# good: [812c4a492375ac47b3557fbb32f5637fc89d60d9] source-hash-dea4a3b9d7182700abeb4dc756a24a9e8dea8474git bisect start 'latest' 'oldest'# good: [5d0dfb8e62ae61a240f8313c594d4560e7c8e048] source-hash-0c6cd530de13f80795881f61064f1bf1dcc4ea81git bisect good 5d0dfb8e62ae61a240f8313c594d4560e7c8e048# good: [7dfacd0b8bd828331d74c0f79de6e8924bc4e6a5] source-hash-f93ce4f7eb90093d0ea3115d0a1c614612676dbdgit bisect good 7dfacd0b8bd828331d74c0f79de6e8924bc4e6a5# bad: [a42da134cd542144fca7ba14cce86c2b409fc18a] source-hash-beadebc0f7eb5582fcb8dcb082d19afdf2751876git bisect bad a42da134cd542144fca7ba14cce86c2b409fc18a# bad: [5f697ca821720f76105e5539f0408e68a0647481] source-hash-f9695150942341a755a43996d4639eb623d7640bgit bisect bad 5f697ca821720f76105e5539f0408e68a0647481# bad: [3b00b662438462a4b73b0531ffa6192fc7e72638] source-hash-0a5cd87e591d7f87bfab92716079af719259f143git bisect bad 3b00b662438462a4b73b0531ffa6192fc7e72638# good: [b4320c4383b3d61076ac1794797bd3162612889d] source-hash-da21f7da44dc577a08ea3bc210083dc8decf18bcgit bisect good b4320c4383b3d61076ac1794797bd3162612889d# bad: [e1690f3a96306b42e829d63cb23a48e4b90603b5] source-hash-3d394257945f6b0a4bc4b5ea397a3942a59c5d06git bisect bad e1690f3a96306b42e829d63cb23a48e4b90603b5# bad: [5de848a6e0a36f6ba90e6c32fd126942fde3293c] source-hash-fd0a49bdd7cf7979d18feff003d1b5fbe53fdc14git bisect bad 5de848a6e0a36f6ba90e6c32fd126942fde3293c# bad: [153f4f2366399a0459129b5161cda0f3b9c0dfbc] source-hash-647f83afb618acbf75c8c6f0a4531bd1e76d8a7egit bisect bad 153f4f2366399a0459129b5161cda0f3b9c0dfbc# first bad commit: [153f4f2366399a0459129b5161cda0f3b9c0dfbc] source-hash-647f83afb618acbf75c8c6f0a4531bd1e76d8a7e(In reply to Michael Weghorn from)Yes, it is a duplicate. An algorithm of the bug reproduction is the same.But I am interested in another thing. Why did not we set "bloked"? Our rules of the version release suggest that a regression compared with the previous version is a reason to block the release.However, we stated that everything was normal, it was just a working situation.Why do we produce the program with unusable functionality?I've got the same problem in 4.4.0.3 (40m0(Build:3) ) after upgrade.I confirm this bug. The bug first occured after upgrading from Version 4.3.5~rc2-0ubuntu1~precise1 to4.4.0-rc3-0ubuntu1-precise1.I am using Ubuntu 12.04***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Hello,As i told in, tried to get out of the stable branch by testing the 4.4.0.3., where i discovered this bug, that forbids me to use libreoffice : what is more important in profesional use than diagrams ? So i came back to stable branch.Please note also that the legend moves also when i generate pdf, so i cannot even place all legends then makes pdf to keep the rigth view.Hello,The bug is still there on version 4.4.1.1I'm using Windows XPStill a problem in Version: 4.4.1.2 Build ID: 40m0(Build:2) (ubuntu 14.04).I can confirm the problem remains with the windows 4.4.1.2 version as well. Build ID: 45e2de17......Setting priority to highest as this is a 4.4 MAB. This is part of an effort tomake the importance of MAB reflected in priority too.The same problem with 4.4.2.1Linux 32bit (mageia4)Really annoying. This also happens for charts in writer.This seems to have been introduced by the below commit commit b067ead2ee8f162374c81b35190b0201a306ae04 Author: Kohei Yoshida <> AuthorDate: Wed Sep 24 16:16:54 2014 -0400 Commit: Kohei Yoshida <> CommitDate: Wed Sep 24 16:19:27 2014 -0400 Don't update chart view when the controllers are locked. Change-Id: I8468925e63db3a5cc5ef3e0f942d22478fd0863e***has been marked as a duplicate of this bug. ***For such a high priority issue things seems strangely quiet here. It's not even assigned yet. With no projected fix in sight I am having to considering downgrading my version, which will be somewhat painful since other previously resolved problems will come back and bite me in thecposterior.Is there any likelihood of getting some information about when or if this problem will be looked at?Still present in Version: 4.4.2.2, Build ID: 40m0(Build:2), Locale: en_GBLegend is moved if you copy the chart. It means that you cannot even copy-and-paste a chart correctly.However, the legend is not moved if you export the chart.My version: 4.4.2.2This makes the involved LO versions useless if legend should be moved.The file modified with 4.4 opened with Version: 4.3.6.2 looks good: the legend is in the position where it was moved to in 4.4, although 4.4 does not display it correctly.(In reply to Matthew Francis from)I can confirm that this commit introduced the bug, with the ability to skip update if controllers are locked. However in SchXMLLegendContext::StartElementopengrok.libreoffice.org/xref/core/xmloff/source/chart/SchXMLLegendContext.cxx#197 xLegendShape->setSize( aLegendSize );there is a call to impl_updateView() (through ChartView::getRectangleOfObject)and there it needs an update.I proposed a dirty fix in ChartView::getRectangleOfObject if it is called for a legend:may be not so nice, but it fixes the bug on my master. May be Kohei would have a better way to fix it.***has been marked as a duplicate of this bug. ***Should be noted that the start center thumbnail shows the legend in the correct location.(In reply to Jay Philips from)What you see in start center, is just a preview image stored when the file was saved. It is not calculated by LibO. So, in this case, image just says that when the file was saved, legend was at the right place.The solution I proposed is not acceptable.(In reply to Laurent BP from)No this is incorrect.<kendy> jphilipz: ... there are 2 thumbnails: one in ODF, one for the startcenter.<kendy> jphilipz: In the older LibreOffice versions, the one from the file were shown, now we use the one in the profile.Still present in 4.4.3.1Linux 32 bitReturning it back to 4.4 master.***has been marked as a duplicate of this bug. ***I've done some debugging and found the following results:1) creating a chart with arbitrary location of the legend; and saved it to .ods.2) I've unzipped the .ods file3) I've examined ~/Object 1/content.xmlthere's a tag <chart: legend svg:x="XVALUE" svg:y="YVALUE" ...it seems that XVALUE and YVALUE contain the correct legend's location, in cm.Then I've reopened the .ods file and the legend moved to top-left corner of the chart.4) I've resaved the incorrect location of the legend into a new .ods file5) I've unzipped the new .ods file6) examining ~/Object 1/content.xmlThe XVALUE and YVALUE are not both set to zero (since the legend was in the top-left corner).My conclusion is that since the XVALUE and YVALUE were properly saved, the problem is during opening of the .ods file.Also. If I use one of the presents (top, bottom, left, right) for the legend position the content.xml file has chart:legend-position="MYPOSITION".8) Then if I manually edit content.xml to change "MYPOSITION" to "MYPOSITION2"9) rezip the files back to .ods file10) opening the newely zipped .ods file in Calc properly reflects MYPOSITION2 for the legend.This further concludes that during the opening Calc has trouble parsing the svg:x="XVALUE" and svg:y="YVALUE" values. But it has no trouble parsing chart:legend-position="POSITION" when top/bottom/left/right is used.Markus Mohrhard committed a patch related to this issue.It has been pushed to "master":it works if we first set the size and then the position, tdf#86624It will be available in 5.0.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Markus Mohrhard committed a patch related to this issue.It has been pushed to "master":add test for tdf#86624It will be available in 5.0.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Thanks moggi :)I'll test it as soon as possible.I can confirm that bug is fixed on master.It now needs to be backported on 4.4. Surely too late for 4.4.3, but would be great for 4.4.4 ;)Backport to 4.4 is on the way :)Markus Mohrhard committed a patch related to this issue.It has been pushed to "libreoffice-4-4":it works if we first set the size and then the position, tdf#86624It will be available in 4.4.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.It works for me on win XP.LO 4.4.4 daily of 2015-05-11Thanks.Works for me - ubuntu Version: 4.4.4.2 Build ID: 40m0(Build:2) Locale: en_GB.UTF-8Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=86897	CreatedSample part of content.xml, double format tags after "T31" and "T32"For the third time in two months I had this Format Error in different ODS-charts. In the attached sample (part) double format tags are found after "T31" in col 3884 and again after "T32" in col 4169. It is possible to repair the chart but annojing and needs quite some knowledge about XML format and a good editor.In LO and OO Forums several help requests concerning this error can be found.I hope this bug can be fixed soon. Perhaps also a general tool to repair XML format errors would be helpful. If it exists already it should be mentioned in the help of LO. Daniel, do you happen to have a step-by-step recipe to reproduce the bug?the relevant of the attachment:<style:style style:name="T31" style:family="text"> <style:text-properties fo:font-style="normal" style:font-style-asian="normal" xstyle:font-style-comple="normal" fo:font-style="italic" style:font-style-asian="italic" style:font-style-complex="italic" fo:color="#008000"/></style:style>duplicate attributes fo:font-style style:font-style-asian style:font-style-complexhas anybody fixed something like this recently?(In reply to Michael Stahl from)Not at the moment. I was not able to locate the cell in the original chart. But I will have a look at the other chart where that happened.I could imagine it has something to do with formatting one of several words in a cell as "italic".I fixed it just by deleting the duplicate attributes as you cited them. That was the advice I got in the LO-forum. See also:ah it's a spreadsheet, not a chart document, so duplicate ofwhich i found today, and that one has a reproducer...*** This bug has been marked as a duplicate of***
id=86636	CreatedFirst screen with black menuesI have opend LO 4.4.0.0beta1 on OpenSUSE 12.3 64bit. Have also installed a lot of other LO-versions. I couldn't chose any entry in the menu because the menu is totally black. Then I started a database-file and get a screnn with some damaged icons and black menuline above.This version of LO seems to be unusable here.I started LO on KDE. No version of LO does show such a behavior up to LO 4.4.0.0alpha. Beta1 is the first ... CreatedSecond screen of Base-file with black menu and damaged iconslooks like a duplicate of- Transient / HiContrast theme mis-selection race on start try changing Linux theme and see if it fix things.it seems there's some conflict between some Linux and Windows themes.*** This bug has been marked as a duplicate of***(In reply to tommy27 from)Isn't a duplicate. When I start ICEWM or XFCE, the wrong high-contrast-theme appears the first time. The menue isn't black.When I open it under KDE 4.10.5 the menue disappears and the high-contrast-theme appears. I open a file and close the file (click on the black right upper corner of the window, where the 'x' should be) and the wrong theme has been gone - but the black background for menu is already there.Ok, I revert status to UNCONFIRMEDPlease read this message in its entirety and do not revert change.This is simply an update to the priority/severity of the bug. Blockers are reserved for incredibly rare cases which this bug does not meet. We use an objective standard of what is or is not a blocker and this does not count as a blocker.Setting priority:Normal - this is just a normal bug...nothing particularly special about it.High - regression.Again please do NOT change the severity back as it does not help at all in pushing the bug forward and instead only confuses our objective standards - leading to developers not trusting the system. Setting to blocker will have zero impact towards moving the bug forward.Thanks for your understanding.(In reply to Joel Madero from)This has been the first time I set a bug to "BLOCKER". Who will decide it isn't? I couldn't test this version of LO in my desktop-environmemt, because I couldn't see anything in the menue.This version is unusable for me. There are many regressions in bugs I have reported. The regressions are set to "medium" - because I could work with a workaround. But with this regression I couldn't work at all.So it definitely isn't based on "this prevents ME from using the software." Blockers must be discussed thoroughly within QA, then presented to the ESC to determine if it is indeed a blocker...to be honest in 3 years I think I've seen 2-3 blockers....it is very rare.For more information you can see:Basically we need solid proof that this affects a wide (very very wide) amount of people, affecting multiple platforms, and essentially completely preventing (lots) of people from using the software. That is the only time we'd block a release.(In reply to robert from)NOREPRO with LO 4.4.0.0.beta2 + Ubuntu 14.04 (64bit) + Unity.Hmmm...I had no issues w/previous builds either.(In reply to robert from)If I understand correctly:1) You have issues under multiple WMs2) For ICEWM and XFCE, the issues only appear the first time you load LibreOffice (?)3) The worst behavior (e.g. with black menu) is under KDEQuestion: Do you have a high-contrast theme enabled? (intentionally)(In reply to Robinson Tryon (qubit) from)This is. It appears with every WM here. Not the black menue.Yes, but only with OpenSUSE 12.3 64bit rpm. Tested it with OpenSUSE 13.1 64bit rpm on another system - there the black menu (and also the high-contrast-theme when opening first time) doesen't appear.The enabled theme is oxygen. Have opened both systems and switched all to the same behavior in KDE - but couldn't get away the black menu (and also the high-contrast-theme when opening first time).The difference between both systems: There are some other WMs installed on the system with the buggy behavior. Had to install this WMs for getting the right screenshots for LO-Base-Handbook in Germany.Confirmed w/ openSUSE 13.1, KDE4 de 4.11.5, LibreOfficeDev_4.4.0.0.beta1_Linux_x86-64_rpm installed in parallel w/o desktop integrationchanged importance according to flowchart as it makes LibO totally unusable and happens at every launch.However prio only to HIGH (and not to highest) as only one platform seems to be affected (so far)Adding self to CC if not already onLet's put this on MAB list if it's so critical.Adding now.For those of you seeing this problem, a bibisect would be really helpful to get it fixed...I'm still not convinced that this is a blocker, nor am I convinced that the problem has been clearly described...but none the less a bibisect would help.(In reply to Joel Madero from)Problem: All users, who could confirm this bug, use OpenSUSE. If I understand it the right way bibisecting isn't possible with OpenSUSE.Next problem: The bug doesn't appear on every OpenSUSE-installation. Could be the same OpenSUSE-installation on other hardware would work right with LO 4.4.*RegardsRobert(In reply to Joel Madero from)+10000. Why was this added to MAB?Because others have a different opinion and it's good to respect those too ;) Seems like for some people this bug makes LibreOffice literally unuseable. That being said - I'd prefer lowering it to major-highest, but I've already done enough fiddling with this bug....So please write down, what should be described better. I have added screenshots, which would show the problem. I wrote down the system where the bug appears. This is a system, where all version up to 4.4.0.0 alpha wouldn't show this error. First apperas with 4.4.0.0.Beta1.... and with this buggy behavior LO is totally unusable with the system I described. Or is there anybody, who would say: "Black menues - doesn't matter, I know all the shotcuts, and know where to press with the mouse. Buttons mustn't have a description."?(In reply to robert from)Hi Robert,It would be great to check the 4.5 (i.e. master) branch to confirm the problem there as well. If it's not present there, that'll definitely help us track down the problematic commit(s).Feel free to grab a build from this tinderbox:Reproducible with Master: 4.5.0.0.alpha0+ Build ID: b3c6f2765602290fecd1f1e291e11667b6b446b6TinderBox: Linux-rpm_deb-x86_64@46-TDF Branch:master, Time: 2015-01-09_23:42:42Locale: de_DEinstalled in parallel w/o desktop integration on openSUSE 13.1, KDE4 de 4.11.5If there are special criteria (eg SUSE of KDE) can that then be please added to the summary? IS really convenient for others looking in/through bugs. thanks :)(In reply to Cor Nouws from)We have tried to look for this special citeria:OpenSUSE: Bug appears with 12.3 and 13.1 64bit - but not every time. I had a netbook with 31.1 64bit and it worked well.KDE: Bug appears on both systems only with KDE, not, for example, with xfce. But if you start xfce on this systems, you could see in XFCE the high-contrast theme, when you start LO (). This doesent appear on systems, where this bug also doesn't appear.We have also searched for graphic cards - aren't the same on systems with the bug (Intel, Radeon).Have updated my system to OpenSUSE 13.2 and openend LO 4.4.0.2 again. Seems the bug has gone there - don't know why.4.4.0.3 still unusable in my environment (see)CreatedRHEL-6 (Scientific Linux 6.6) black menusSee RHEL-6.6-LO-88686.txt for system details.CreatedRHEL-6 (Scientific Linux 6.6) black menu, system detailsSystem details for screenshot RHEL-6.6-LO-88686.jpgProblem confirmed for Scientific Linux 6.6 (clone of RHEL 6.6, all TUV patches applied).Window Manager: TUV original KDE KWin 4.3.4NVidia Quadro NVS 300 and NVidia binary drivers (from ELrepo, 340.65)Xorg-X11 7.7: Option "AIGLX" "True"Version has to be the first the bug appears. First version is LO 4.4.0.0beta1 - see description of this bug.Checked for RHEL-7 (Scientific Linux 7.0): Bug does not show up here.CreatedGrafic errors on openSUSE 13.2 64-bitOn openSUSE 13.2 64-bit, KDE 4.14.4 i see a lot of grafic errors on the menus.Please don't manipulate the severity/importance. This is not a blocker. Moving back to critical.***has been marked as a duplicate of this bug. ***Please note that LO is completely unusable for me, I had to downgrade to 4.3.5.2I reproduced the problem on two fully updated CentOS 6.6 systems on which stock KDE packages are installed.4.4.1.2-2.x86_64 does not fix the problem on Scientific Linux release 6.6 (Carbon) x86_64.Same problem under CentOS 6.6, KDE with LO 4.4.2.2: menus and UI components are black or *completely* messed up, impossible to work.Workaround:1. export OOO_FORCE_DESKTOP=none2. make sure the two options "Use OpenGL for all rendering" and "Force OpenGL even if blacklisted" are disabled.This will provide no-frills, ugly but working UI on KDE.@irisx: thanks! Your workaround works well in my environment (see) for both 4.4.2.2 and Master-20150110Removing comma from Whiteboard (please use a space to delimit values in this field)Since reports show this to be inconsistently reproducible even on the same OS (Linux), this needs to be assumed to be caused by buggy graphics drivers. Closing as NOTOURBUG, please refer this to the Xorg maintainer of your distro first. Reopen this bug only, if there is qualified proof these display errors are caused by illegal/insensible requests of LibreOffice from the display server.I find it rather hard to believe that it's a problem with the drivers of the distro given that I can reproduce the bug on 3 completely different systems- one AMD based with a separate NVIDIA Corporation GT218 based video card, using NVidia's drivers- one AMD based with onboard video, using ATI's drivers on a Radeon HD 8570D- one MSI B75MA-P45 with integrated Intel video; this is the only system which runs the drivers provided by the distribution.Migrating Whiteboard tags to Keywords: (bibisectRequest)[NinjaEdit]
id=86984	Open in Writer a document with header or/and footer and some lines.In Tools, choose Line Numbering and check Show Numbering Click OK.Line count appears in the margin. Open again Line Numbering and check Include header and footer.Click OK.None change.Open Line Numbering and see Include header and footer isn't checked.Observed on:LO 4.4.0.0.beta1 Build ID: 9af3d21234aa89dac653c0bd76648188cdeb683e Locale: fr_FR& Windows 7 Home Premium.Jacques Works as expected in LO 4.5.0.0.alpha0+Build ID: 736b040cb158308e002d24cee8c33e794b2f59a1TinderBox: Win-x86@39, Branch:master, Time: 2014-12-01_15:20:47Locale: fr_FRso I close this as Works for me.JacquesI reopen this one.Does not work in 4.0.0.rc1 and it's announced as new feature..will mark as MABhmm. seems to work with ENG_US but not with Dutch_NL locale?Can confirm described behaviour even for German de_de UI in Win7/64 LibO 4.4.0.0.beta2 .No recounting is startet and displaxed and looking in the numbering properties shows, that the check of the "include head and footer" disapear.Hi,I confirm that all works with English UI but "Include header and footer" not efficient with French Locale.regards,JacquesIf I understand this chain right: It works properly on EN locale but not for FR?or is it something else...?Hi Muthu,If I ask for the English UI when French integrated Help is installed, all works.The same with Dutch Locale, I think.Regards,Jacques(In reply to Muthu from)Yes, when I set UI to English, it works.When I set UI to Dutch, it doesn't.Confirmed by***has been marked as a duplicate of this bug. ***confirm this bug, forVersion: 4.4.0.1.0+ID build: 310c6e617f48ac94f2bd982b2dca6c05c06a2d51TinderBox: Win-x86@51-TDF, Branch:libreoffice-4-4, Time: 2015-01-04_20:52:31Locale: ru_RUOS: Windows 7 x86-64Muthu Subramanian committed a patch related to this issue.It has been pushed to "master":fdo#86984: UI Line numbering works only for EN_USIt will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Muthu Subramanian committed a patch related to this issue.It has been pushed to "libreoffice-4-4":fdo#86984: UI Line numbering works only for EN_USIt will be available in 4.4.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Hi mutu,Thanks!The most recent daily for me is d1c9bd13ec7af93f5368dfda6d6d3c955f0b0816 so I'm not yet able to check.Will do later again,Ciao,CorI just checked in Master 4.5.0.0.alpha0+ Build ID: 39e9e3ee8369eeb00025291e637f0bb2a8f87ed2TinderBox: Linux-rpm_deb-x86@45-TDF, Branch:master, Time: 2015-02-07_22:46:27Locale: nl_NLWorks fine there. So this is fixed. Thanks!(Not yet checked in 4.4 code line)Verified fixed in LibreOffice 4.4.2.0.0+ built at home under Ubuntu 14.10 x86-64.Best regards. JBF
id=87204	Hi, wanted to load and save this Excel-presentation:and LO crashes as soon as I want to save it as LO-presentation. I can confirm crash with LO 4.3.4, win7.I can confirm crash Version: 4.5.0.0.alpha0+Build ID: 31e8084fc07c3de09230c0f0c6ed947b3de98df1TinderBox: Win-x86@42, Branch:master, Time: 2014-12-07_06:59:33Can not reproduce on Linux.Createdproblematic documentThis issue is still present inVersion: 5.0.1.2Build ID: 81898c9f5c0d43f3473ba111d7b351050be20261Locale: es-ES (es_ES)on Windows 7 (64-bit)If someone still reproduces it on Windows with last stable LO version 5.0.3, any chance for a bt?I opened thefile then a slideshow started automatically.I manually quit the slideshow then the show ended and after a while, Impress was killed automatically.It's not my expected result.My dev build:Version: 5.4.0.0.alpha0+Build ID: f35d29c8388744be1f95ec4acfca12eec706911aCPU Threads: 2; OS Version: Linux 4.9; UI Render: default; VCL: gtk3; Locale: en-US (en_US.UTF-8); Calc: group(In reply to fiftyigfuci_f_mi from)It could be interesting to retrieve a bt (see).Indeed, it might be a dup of tdf#105188The crash report was successfully uploaded.crashreport.libreoffice.org/stats/crash_details/17b8cefb-de2f-4bd7-bcf3-4d741ca24cb2Filed at least forand.***has been marked as a duplicate of this bug. ***Similar reports (a lot!):(In reply to Timur from)Raising severity and priority! Thanks for triaging this.Crash repro with 4.1, not with 4.0.5 (although it was slow) for. I'll mark as regression so far. I didn't test Stefan'sand steps fromnor.Because of the hint to(GDI problem) I have made new tests with the spreadsheet document "Test_Comment_Crash.ods" attached to.Result: I think that the first "Save" or "Autosave" creates very much GDI objects.First I have increased the GDI quote in Windows from 10000 to 60000 to prevent the crashes (and reatarted the system to activate the change). A new test with my document gave no crash (but after document was saved and LO should be closed, shutdwon of LO was hanging - see). Then I have "installed" Nirsoft GDIView to see the GDI objects counter at further tests.The counters I have seen at the several tests were not exactly the same, but they were in the same ranges always. The figures below are from one of the tests. When the document was opened and I had navigated to the first sheet ("Altix I bis III") the GDI counter ("All GDI") was 125. After the four first comments were inserted and before the document was saved the GDI counter was 255.This means that every comment has increased the counter by 27 or 28, although the comments are hidden. I don't if this correct or not. Because the comments are not shown I think only the bitmanp counter should be increased by 1. While the document was saved the GDI counter has extremly increased from 255 to 9873!!!After some additional comments have been inserted the old limit of 10.000 was exceeded.Interestingly:- Only at the first save (or maybe also Autosave) the GDI counter increases extremly. At additional saves the counter has not increased or increased only slightly. - At "Undo" the GDI counter does not decrease and at "Redo" it does not increase.These tests were made with LO 5.3.0.2 (x64).I've tested this with a build that contains fix for, and I can't reproduce the crash.Createddebug from procdump dumpConfirm. No crash and saving as before, slow. I'd kindly ask Stefan to test all those before closing. But, I get dump with procdump with error cppu3.dll!uno_type_equalData.Should that be considered the same bug?(In reply to Timur from)No. I'd treat that as a different issue.Test withVersion: 5.4.0.0.alpha0+Build ID: b41186a2fc49e440890b8c86e5367352ffaf9cd6CPU Threads: 4; OS Version: Windows 6.19; UI Render: default; TinderBox: Win-x86@42, Branch:master, Time: 2017-01-26_01:50:40Locale: de-DE (de_DE); Calc: groupFirst I have tested only the duplicate:Result:No crashes, GDI counter increases only slightly while file was saved. OK!But I have seen in GDIView, that GDI counter fast increases when sheet is edited. First I have thougt that this is related to insert of comments. But then I have seen that GDI counter also increases when cells ar selected by mouse click and also only by scrolling in the document. Finally it exceeds the limit and LO crashes. See alsoin!After this I have tried to open at the same time the attached documents from(2x ods), from(foo.odp) and from(0-Einleitung.pps).Depending on the sequence how documents were opened there were several problems. I have not analized completely until now.Caolán/Khaled: thought you might be interested in this one since gdi is related to fonts rendering (not only) so vcl part.There is lots of duplicate communication going on here. I'll close this as duplicate.*** This bug has been marked as a duplicate of***
id=87119	ReferenceThis spreadsheet loads correctly into 4.1.5, 4.1.6, 4.2.7, and 4.3.4. In 4.4beta (and reported by raal, on 4.5 alpha and 4.3.6) much of the spreadsheet does not load correctly (e. g. look at the T Rank sheet). Raal reports that it does load correctly on 4.4alpha.This was determined in conjunction with filing(which is not related).This spreadsheet is quite complex, using names as unparameterized macros. I can confirm:with Version: 4.4.0.0.alpha0+Build ID: dea4a3b9d7182700abeb4dc756a24a9e8dea8474I can see data on sheet TrankNo data with Version: 4.4.0.0.alpha1+Build ID: b800d0b6ad74ce4a9adb23b865dd174d1eefa47b; bibisectable with 44alpha2onlyDataloss.On the sheet are data loaded through names, for example =rr_dName : rr_dRange: IF(B12="";bk;T(OFFSET($'All results'.$E$1;$P12;0))&T(altern))Yes, that's what I've done for most of the spreadsheet, used names rather than actual formulas in cells. That greatly reduces the size of the spreadsheet, and also makes it easy (if slow) to change the definition of a column (or other repetitive expression).Bibisect results from 44alpha2only:0777cd085a7633a48e03d25948cc67fce87b7ac7 is the first bad commitcommit 0777cd085a7633a48e03d25948cc67fce87b7ac7Author: Bjoern Michaelsen <>Date: Sat Nov 8 08:52:37 2014 +0000 source-hash-b800d0b6ad74ce4a9adb23b865dd174d1eefa47b commit b800d0b6ad74ce4a9adb23b865dd174d1eefa47b Author: Noel Grandin <> AuthorDate: Thu Nov 6 10:13:15 2014 +0200 Commit: Noel Grandin <> CommitDate: Thu Nov 6 13:52:55 2014 +0200 svl: remove unused code Change-Id: I5a01162d2925eede97f1cdc24aa876179b8b43b4# bad: [0777cd085a7633a48e03d25948cc67fce87b7ac7] source-hash-b800d0b6ad74ce4a9adb23b865dd174d1eefa47b# good: [812c4a492375ac47b3557fbb32f5637fc89d60d9] source-hash-dea4a3b9d7182700abeb4dc756a24a9e8dea8474git bisect start 'latest' 'oldest'# good: [8677ba6e74a774fb44ec7831f14e53d8663f59ed] source-hash-eb213e490d9a366477b921d1a408d85c4638499egit bisect good 8677ba6e74a774fb44ec7831f14e53d8663f59ed# good: [33e2222277083d3a30c0020aa4b05d54aeed6131] source-hash-34fe0d32505f64fdef20828c26547cc7f8453212git bisect good 33e2222277083d3a30c0020aa4b05d54aeed6131# good: [c9da176038b97f22406b17ed2f013c596a4fc266] source-hash-91b65e0a73b35a745921831b73f5f4589bb889b7git bisect good c9da176038b97f22406b17ed2f013c596a4fc266# good: [4561a0c9b06d62052f401feeba76f01831e17ca3] source-hash-6a4b976bd0818c2f60b879594d393baad9a0f346git bisect good 4561a0c9b06d62052f401feeba76f01831e17ca3# good: [cf48d4cf0e32cbdfe968c06bd439e2d6982c9642] source-hash-2ec4c8b07427af868e32e14aaefd20649c1135d6git bisect good cf48d4cf0e32cbdfe968c06bd439e2d6982c9642# good: [f856b595e1be50d9af817fab560cbb25f5305b7e] source-hash-f18fd73e287b781e953a3c4bfa05b55f39880a35git bisect good f856b595e1be50d9af817fab560cbb25f5305b7e# good: [cc9a130a364bd74934c8a335006a450dabb10101] source-hash-12bcfec04fcbe6425e327109ad47cd2b2b80d2bdgit bisect good cc9a130a364bd74934c8a335006a450dabb10101# first bad commit: [0777cd085a7633a48e03d25948cc67fce87b7ac7] source-hash-b800d0b6ad74ce4a9adb23b865dd174d1eefa47bI believe that this is perfectly acceptable as a MAB. Marking appropriately.Follow-up plain bisect points to this commit:ef809ce9480182ea5c4f77843f72d1d45bd48c35 is the first bad commitcommit ef809ce9480182ea5c4f77843f72d1d45bd48c35Author: Tor Lillqvist <>Date: Wed Nov 5 00:34:35 2014 +0200 More work on the new OpenCL options Now the new options show up in the "Detailed Calculation Settings" dialog and are saved and restored from the per-user configuration. The code that manipulates the "Detailed Calculation Settings" dialog is quite ugly with all its manual hiding and showing of widgets depending on which detail it is that is being edited. This also means that the dialog cannot be designed using Glade. But no time now to re-work this. Change-Id: I03a3a51d902084e73aab5a787b588d22ea7578f2And indeed when I disable OpenCL the attached spreadsheet works again(Options - Calc - Formula - Detailed Calculation Settings - Custom - Enable OpenCL for some formula computation: False)Adding Cc:This commit (on master) might fix this problem, but I am not able to test because of some unrelated bug:commit 6eb155dea00a1e312fdc3339406bf168a93a25e7Author: Tor Lillqvist <>Date: Tue Dec 9 12:45:41 2014 +0200 Don't use of the broken "Software" group interpreter FormulaGroupInterpreterSoftware is known to be broken, says moggi. We should not use it as a fallback to OpenCL. Not sure whether it makes sense, but let's keep it in the code for now. Make using it conditional on setting the environment variable SC_ALLOW_BROKEN_SOFTWARE_INTERPRETER (to any value). Only a developer who wants to work on it should set that. sc::FormulaGroupInterpreter::getStatic() can now return NULL, adapt callers accordingly. This might fix fdo#87119, but I am not able to check, as the document from that bug causes an unrelated assertion for me. Change-Id: I24454f46332014cbcbf696252059b9743f3c84d6 sc/source/core/data/formulacell.cxx | 4 +++- sc/source/core/tool/formulagroup.cxx | 7 +++++-- sc/source/core/tool/interpr5.cxx | 12 ++++++++---- 3 files changed, 16 insertions(+), 7 deletions(-)How is it supposed to look? Could you attach a screenshot please. I don't have any 4.[123] build handy to compare with.CreatedExpected content of the 'T Rank' sheetI have one of those from earlier - here you goIf it contains more than nothing at all it's probably workingCreatedBroken "T Rank" sheet(in contrast, this is what it looks like when broken - empty)After taking care of the assertions I was able to verify that indeed the fix helps. Will cherry-pick to libreoffice-4-4.(The unrelated assertion, which prevents loading the test document in an assertions-enabled build, is fixed by the patch atI did not commit that directly, I want some Calc expert to approve it.)The same patch submitted to gerrit for the libreoffice-4-4 branch, too:Note that per Raal's comment inthis shows up in 4.3.6 also.It can't be the same bug in 4.3.6 as the use of OpenCL was not turned on by default in 4.3, and thus there shouldn't be a way to get to the related "Software" Formula Group Interpreter code-path. Unless one turns on OpenCL use intentionally, which I think is not recommended in 4.3.Tor Lillqvist committed a patch related to this issue.It has been pushed to "libreoffice-4-4":fdo#87119: Don't use of the broken "Software" group interpreterIt will be available in 4.4.0.0.beta3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Let's call this fixed now.The current nightly (12/19 linux x86_64) fails to start, so I can't test it.It works. The failure to start problem appears to have been due to my .config/libreofficedev directory. Removing it and allowing libreoffice to recreated it fixed that problem.Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=87760	Steps to reproduce:1. Create a new text document in Writer2. Add new table, say, 2x2 (doesn't matter, may be reproduced with 1x1)3. Put caret to cell A1, menu Format->Character->Font Effects->check Hidden4. Menu View->uncheck Nonprinting Characters (default Ctrl+F10)5. Show Draw Functions (menu View->Toolbars->Drawing), Draw a Rectangle, so that its top-right corner is above cell A1. This makes the rectangle to be anchored to that cell.Expected result: the rectangle is drawn, and possibly is hidden, as it is anchored to the hidden paragraphActual result: writer crashes, and recovery dialog hangs, it is impossible to close it gracefully, only task kill helps.Tested with: 4.2.5.2 and 4.3.5.2 under Win7x64.Marking HIGH/CRITICAL as it is crash, affects the component that is used by most users, but the functionality is not very common. Also reproducible with Version: 4.5.0.0.alpha0+Build ID: 57626f2132f73e4e42b31e364b25c5867336e718TinderBox: Win-x86@42, Branch:master, Time: 2014-12-26_09:26:33Locale: ru_RUand with OOo 3.3.0 under Win7x64 -> Inherited from OOo,as well as with 4.3.5.2 under Ubuntu 14.04 64-bit -> All OS.TESTING on Ubuntu 14.04 + LO 4.4.0.1(In reply to Mike Kaganski from)clicked "OK"Was already unchecked for me.Ok (I'm not entirely sure about the specifics of where the corners of the rectangle should lie)I drew the rectangle, and nothing happened.I can't repro. Maybe just an issue on Windows?(In reply to Robinson Tryon (qubit) from)I poked around a bit more, and was able to crash the program if I drew the rectangle as follows:- Top corners in A1- Bottom corners in A2(No recovery dialog for me on Ubuntu)CONFIRMED: Crash on drawing rectangleStatus -> NEW(In reply to Robinson Tryon (qubit) from)Yes, you are right.I didn't mention it in.Also, starting with 4.4.0.0.beta1 under Windows, the recovery dialog no more hangs, and after cancelling it, another error message appears:---------------------------LibreOfficeDev 4.4 - Fatal Error---------------------------Unknown SEH Exception---------------------------ОК ---------------------------As this is a MAB: Priority -> HighestOn pc Debian x86-64 with master sources updated yesterday or with 4.3 sources updated some days ago, I don't reproduce this even if I begin rectangle at top left of first cell and end it at bottom right of the last cell.CreatedScreencast (Windows)This screencast is to clarify how to reproduce this bugCreatedbt with debug symbolsThank you Mike for your screencast!On pc Debian x86-64 with master sources updated today, I could reproduce the crash, I attached a bt.Michael: the problem is here: 1593 pAnch = aPos.nNode.GetNode().GetCntntNode()->getLayoutFrm( GetLayout(), &aPoint, 0, false ); 1594 1595 if( !bAtPage )(see)gdb session indicates that aPos.nNode.GetNode().GetCntntNode() is empty so no pAnch here.Any idea what to do?Caolán McNamara committed a patch related to this issue.It has been pushed to "master":Related: fdo#87760 don't crash on searching for a place to put the anchorIt will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolán McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: fdo#87760 if we can't anchor at hidden text then...It will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-3":Resolves: fdo#87760 if we can't anchor at hidden text then...It will be available in 4.3.7.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-4":Resolves: fdo#87760 if we can't anchor at hidden text then...It will be available in 4.4.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "master":sw: redo check in SwFEShell::FindAnchorPos() a bit (related: fdo#87760)It will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=87845	CreatedJava error log after LO crashWhen calling 'Pring Preview' (either from menu or through the icon) LO crashes, leaving some messages about a Java issue in my terminal:frank@maniac:/opt/libreoffice4.4/program$ ./swriter ## A fatal error has been detected by the Java Runtime Environment:## SIGSEGV (0xb) at pc=0x00007f2b0fa39ef8, pid=6150, tid=139823975573632## JRE version: Java(TM) SE Runtime Environment (7.0_72-b14) (build 1.7.0_72-b14)# Java VM: Java HotSpot(TM) 64-Bit Server VM (24.72-b04 mixed mode linux-amd64 compressed oops)# Problematic frame:# C [libswlo.so+0xa79ef8] SwView::GetDocShell()+0x8## Failed to write core dump. Core dumps have been disabled. To enable core dumping, try "ulimit -c unlimited" before starting Java again## An error report file with more information is saved as:# /tmp/hs_err_pid6150.log## If you would like to submit a bug report, please visit:##This bug even occours with an empty document. Attached you'll find the corresponding error log. TESTING w/Ubuntu 14.04 + LO Version: 4.5.0.0.alpha0+Build ID: 783ba49aa0cd068c7e3dacdd3c13e9c37cf52e22TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2014-12-18_11:21:12Locale: en_US(In reply to Frank Berke from)NOREPRO: Print Preview opens fine for me here with LO 4.5.0 (master) and 4.4.0.1Tested 4.4.0.1 with Java 6 and Java 7 (1.7.0_65).I'm using the java-7-openjdk package. I'd try that and see if it works well for you.Additionally: I wouldn't expect Print Preview to rely on Java. Could you please attach the document you had open? (Sanitize before uploading:)Thanks!Status -> NEEDINFO(please change status back to UNCONFIRMED after you attach the sample file)The crash did not occour with any special document - even a newly openend empty one did the trick for me.I changed my JVM from 7 to 8, but still got the same effect.Then I removed my ~/.config/libreoffice directory to force LO 4.4 to create a new one. With LO now on its default settings, print preview works again. I will try to migrate my templates, autotexts and wordbooks step by step to see if any of them is the culprit.The Navigator is the component causing the problem. Having it open, either docked or in floating mode, it crashes LO for sure. Once you close the Navigator (by pressing F5), Print Preview works again without problems.This never happened with any previous LO version before.I can confirm with Version: 4.4.0.0.beta2+Build ID: e1de94244c1b0419c1c3415c02381e8b7a87abe0TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:libreoffice-4-4, Time: 2014-12-14_11:45:23Createdgdb log(In reply to raal from)Yep -- Same crashing behavior with 4.4.0.1 for me on Ubuntu 14.04.Status -> NEWHigh possibility of data loss, soBlocks -> mab4.4Priority -> highestCONFIRMED on Ubuntu 14.04 withLO Version: 4.5.0.0.alpha0+Build ID: 783ba49aa0cd068c7e3dacdd3c13e9c37cf52e22TinderBox: Linux-rpm_deb-x86_64@46-TDFBranch:masterTime: 2014-12-18_11:21:12Locale: en_USworks fine 4.5 latest nightly from today osx 10.10.14.4.RC1 confirmed on OSX 10.10.1.crashlog attached.per definition this is WORKSFORME, but still MAB for 4.4Created4.4rc1 crasher on OSX 10.10.1all platforms is correct.(In reply to foss from)I'm CONFIRMING this bug on Ubuntu 14.04 withLO Version: 4.5.0.0.alpha0+Build ID: 5c60dab390d66a4d5abeaf548efecf3913b90839TinderBox: Linux-rpm_deb-x86_64@46-TDFBranch:masterTime: 2014-12-31_00:20:30Locale: en_USPossible that it's been fixed in the last 2 days... or that behavior isn't consistent across platforms?(In reply to Robinson Tryon (qubit) from)Hmm... I can still CONFIRM the bug on OS X 10.9.5 +LO Version: 4.5.0.0.alpha0+Build ID: 4d3b725000e537ce6199f0abd1c80580c9bf95c8TinderBox: MacOSX-x86_64@49-TDFBranch:masterTime: 2015-01-02_10:08:47Locale: en_Status -> NEWTests on Ubuntu 14.04:- 4.3.5.2 - NOREPRO- 4.4.0.0 beta1 - NOREPRO- 4.4.0.0.beta2 - CONFIRMEDpossible a regression from b5c1f352522c34a744ad0226e73904ce5af81b11sorry about that, fixed on masterbtw the JVM crash report is a red herring, you always get that if LO has loaded the JVM, the line with the crash address clearly indicates it's a problem in LO's C++ code:# Problematic frame:# C [libswlo.so+0xa79ef8] SwView::GetDocShell()+0x8Michael Stahl committed a patch related to this issue.It has been pushed to "master":fdo#87845: sw: fix crash in navigator dialog when view is closedIt will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-4-4":fdo#87845: sw: fix crash in navigator dialog when view is closedIt will be available in 4.4.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-4-4-0":fdo#87845: sw: fix crash in navigator dialog when view is closedIt will be available in 4.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.***has been marked as a duplicate of this bug. ***Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=87876	Createdoptions dialogOn the Tools > Options dialog and goto the view entry and the new entries added under graphics output are crushing the entries in the column to the left of it. This is likely being caused by the long text label 'Force OpenGL even if blacklisted (might expose driver bugs)'. How can I see these OpenCL entries? I don't have them in my LO 4.4.0.0.beta1. Do I have something to enable to see them?You have to have 4.4 or master to see them. You can easily get it from hereCreatedclip of dropdown menu open, shows full width@Jay, *,Dialog can be resized horizontally if space is available. Otherwise not really an issue as the dropdown list is fully readable. Only the exposed item in the widget is truncated, and that pretty minor. Even the 'old' view in your clip shows truncated. Resolving invalid.No regression, dropdown list items are fully readable. Also, as the dialog can be expanded or shrunk as user prefers there is no loss of function.Resolving invalid.Hi Stuart,By default, the dialog should look as we intend it to look and IMHO, that is the not case here. In the old version, we could read 'Automatic' fully, and actually looking at the older version again, there isnt a reason for 'Use system font for user interface' to be on two rows when there was so much space on the right. So if anything, 'Force OpenGL even if blacklisted (might expose driver bugs)' should be allowed to be on multiple rows so it doesnt cramp items on the left column, and the left column should be increased so 'Use system font for user interface' appears on one row.OK, back to new... if you really want to fix it.line #101The containing Gtk frames/grids have the same padding 12 left and 6 top, 6 between rows with nothing set right.So would be two ways to "fix" this visually, move the "(might expose driver bugs)" warning to its own Gtk label, or figure out a way to add a line break to the overly long label for the GtkCheckButton--I think that can be done. Adolfo?Either should relax the width truncation of the frames at the dialogs default width, I don't think we'd want to make the width any wider as it would look bad and consume too much screen.CreatedOptions Dialogue with German LocalisationThe situation is even worse in the German localisation. Have a look to the attached screen shot.Oh, I forgot to mention the LO version and my system: Ver. 4.4.0.3, Win7.Will have a look.Please don’t use UX-Advise for these obvious bugs…***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***OK, this is a new reincarnation of, and the same fix will probably work. Although I’d much prefer to just fix the label (either by adding a line break or by splitting into two labels), that will annoy a tiny bunch of vocal people in libreoffice-l10n and don’t want to receive death threats.I'd go for the wrap Adolfo as it is the easiest solution, as i'm assuming the string text likely will changed in the future and having it across 2 labels wont work well with translation.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Not only German Localisations affected. For example, UK also.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Caolán McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: fdo#87876 full text of war and peace used as checkbox labelIt will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.for 4-4 where I force a wrap to get it to fit and not have to change translations. And for 4-5 I'll change the text to be a more reasonable length.Caolán McNamara committed a patch related to this issue.It has been pushed to "master":Related: fdo#87876 make checkbox label shorter, move warning into tooltipIt will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-4":Resolves: fdo#87876 full text of war and peace used as checkbox labelIt will be available in 4.4.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.***has been marked as a duplicate of this bug. ***@Caolán, *,Looks good in 4.5.0 master with the warning in the tooltip.Version: 4.5.0.0.alpha0+Build ID: 233da237ad4b593c945903c3b32185a540025516TinderBox: Win-x86@62-TDF, Branch:MASTER, Time: 2015-02-10_16:44:04Locale: en_US=-=-=The line wrap for 4.4.1 works, but is still truncating the left column of widgets--impacting the User Interface: Icon size and style area's dropdown menu. Dialog, does open out to full size of selection when the drop down is activated.So workable, just a little ugly.Version: 4.4.2.0.0+Build ID: dd53735c5fe98fa4f8da4bf214a04b7883bf73c8TinderBox: Win-x86@42, Branch:libreoffice-4-4, Time: 2015-02-11_15:55:36Locale: en_USwould fix that if it gets inCaolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-4":Related: fdo#87876 calculate ideal width after icon style entries are addedIt will be available in 4.4.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***This is broken again in master Version: 5.0.0.0.alpha1+Build ID: 950055bcb06c8edcd9062c71184f02bf8e0604e6Locale : fr_I only see the problem in FR locale and not en-USEnclosing screenshotCreatedView pane FR locale master 27/04/2015That's now a different bug of "French translations out of date on master", I hacked in a line-break for 4-4, then shortened the string there because that was a hugely long set of works for an option in any language and move all the english text inside the brackets into a tooltip. If the French trans is updated then from the visual above I see that the long string and the one above will be approx the same length and all will presumably be well@Alex: as Caolán said this is an issue you should report to the Franch translation team, but after 5.0 is in beta. Do not report anything translation-related for alphas, as it’s obvious that we translators are just starting working on them. And, in future avoid reopening fixed issues like that, which just generates useless bug mail to everyone subscribed to this and associated bugs. Thanks.
id=88378	CreatedTest document (crasher.odt)Applying the "flip" option to an image causes an immediate crash (exit code 139 => segfault). The image had been previously rotated several times.The document was originally created from scratch in LO4.4 and functioned correctly, but was saved as a .doc; when later re-opened, rotations were un-done; I re-saved as .odt, reopened that, and tried to re-rotate the image but any attempt immediately crashes.STEPS TO REPRODUCE:1. Open the attached crasher.odt2. select the image (lower left corner)3. Rightclick->image...4. On the Image tab, check "Flip" HorizontallyRESULTS: Instant crash TESTING with Ubuntu 14.04 + LO 4.4.0.2(In reply to Jim Avera from)Ayupwait for it.... (LibreOffice stayed up for just a second)...yep, there it is!CONFIRMED: LibreOffice does the old crasherooStatus -> NEWHardware -> (Generalize)Blocks -> MAB 4.4Priority -> highestSeverity -> criticalJim: Thanks for the great bug report!TESTING again on Ubuntu 14.04 +LO Version: 4.5.0.0.alpha0+Build ID: 84c69550bcb8139669de9cf98b51c35f21fe853dTinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2015-01-13_08:44:23Locale: en_US(In reply to Robinson Tryon (qubit) from)In 4.5 this step is now:(Right click) -> Format ImageTEST RESULTS:4.5-master (see version above): Crash4.2.5.2: Crash4.2.0.1: Crash3.5.7.2: NOREPRO - horizontal and vertical flip okayKeywords -> regressionWhiteboard -> bibisectRequest(4.2 Builds: In both builds tested, an empty (?) warning dialog appeared (with an "!" in a triangle), but upon closing the dialog, the program quit/crashed)Blocks: Changing mab4.4 -> mab4.3 (The earliest active branch on which we can reproduce)(In reply to Robinson Tryon (qubit) from)>Sorry that should read:4.3.5.2: Crash4.2.0.1: Crash(4.3/4.2 Builds: In both builds tested, an empty (?) warning dialog appeared(with an "!" in a triangle), but upon closing the dialog, the programquit/crashed)Caolán McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: fdo#88378 flipping by reversing co-ord system no longer worksIt will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-3":Resolves: fdo#88378 flipping by reversing co-ord system no longer worksIt will be available in 4.3.7.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-3-6":Resolves: fdo#88378 flipping by reversing co-ord system no longer worksIt will be available in 4.3.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-4-4":Resolves: fdo#88378 flipping by reversing co-ord system no longer worksIt will be available in 4.4.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Migrating Whiteboard tags to Keywords: (bibisectRequest)[NinjaEdit]
id=88398	CreatedSample containing formulas to demonstrate issueTo address the cell in the previous row / same column, I use the formula =INDIREKT(ADRESSE(ZEILE()-1;SPALTE())) since using e.g. =A14 results in "#REF!"-error when deleting a line where a cell is referenced (which I do frequently).But at least in 4.4.0 RC 1+2, if I change the cell content, the cell in the next line is NOT updated. Only after closing and reopening the document, changes are visible in lower cells.Attached is an example sheet. To test my issue, please open it and enter another date in A16. After pressing ENTER, A17(,A18,...) should display the same date just entered. On my system, it does not. A17,... remain set to the value they had when opening the document.Is that intended behaviour? I found no settings to change ... so I consider this a (serious?) bug. CreatedWhat it looks like on my (W8.1/64) systemI can confirm with Version: 4.4.1.0.0+Build ID: b460414bcd1dfd2f260696e306c49c56585c6464TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:libreoffice-4-4, Time: 2015-01-11_05:32:52No problem in 4.3.5, win7 -> regressionInspecting.Btw, a less expensive (calculation performance wise as no back and forth string conversion is involved) way to address the previous cell of a column is =OFFSET(A15,-1,0) in A15, =OFFSET(A16,-1,0) in A16, ... this can be copied/filled down as well. This apparently also doesn't suffer from the bug reported.My bad, OFFSET does exhibit the same bug (which actually is helpful), but nevertheless would be the better expression.Thanks for the hint to quicker code and for working on the issue.While replacing "=INDIREKT(ADRESSE(ZEILE()-1;SPALTE()))" with "=VERSCHIEBUNG(A15;-1;0)" I noticed that if the cell that I enter e.g. "=VERSCHIEBUNG(A15;-1;0)" into was formatted as text ("@") before entering the formula, then the formula is literally displayed as cell value instead of the vulue of the cell above.(In reply to Olav Seyfarth from)That's a feature.Createdsimple reproducer with instructionsEike Rathke committed a patch related to this issue.It has been pushed to "master":fdo#88398 disable grouped listeners for nowIt will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Eike Rathke committed a patch related to this issue.It has been pushed to "master":add unit test for fdo#88398It will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Pending reviewfor 4-4for 4-4-0Note that this only disables the new group listeners for now to fix the nasty bug, a follow-up should implement the missing parts. I'll give code pointers and findings here later.The cause was that during unsharing the formula group the grouped area listeners were discarded with mxGroup->endAllGroupListening(), as necessary, but not re-established for the newly formed two groups (or single cells, depending on length of group and split position). Here the area happened to be BCA_LISTEN_ALWAYS because of INDIRECT() being used in the originally reported document, but the same scenario is hit with ordinary areas as can be seen with the simple reproducer document I attached.In this case that happened in ScColumn::DetachFormulaCell() called via ScColumn::GetPositionToInsert() and could quite easily be fixed by letting sc::SharedFormulaUtil::unshareFormulaCell() return two ScFormulaCellGroupRef that could be used to re-establish listeners via SharedFormulaUtil::startListeningAsGroup()However, there is a bunch of other places that call sc::SharedFormulaUtil::unshareFormulaCell() or sc::SharedFormulaUtil::splitFormulaCellGroup() or sc::SharedFormulaUtil::unshareFormulaCells() or sc::SharedFormulaUtil::splitFormulaCellGroups(), also in cell mass handlers, that would either discard the group area listeners or leave the listeners unadjusted. Some of them tricky and where re-establishing the listeners after each single split would not be desirable as a resulting group could get split again in the same loop. All of them need to be inspected and adapted before the group area listeners can be reactivated. That is more work than probably can be reliably done until 4.4.0.3 on Monday, which is why I disabled the group area listeners for now.I've come up with a correct fix for this, and with it, we don't have to disable the entire group area listeners. I'll push my fix shortly.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#88398: Re-enable formula group listeners.It will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "master":fdo#88398: Handle group listeners correctly when splitting formula group.It will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-4":fdo#88398: Handle group listeners correctly when splitting formula group.It will be available in 4.4.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Kohei Yoshida committed a patch related to this issue.It has been pushed to "libreoffice-4-4-0":fdo#88398: Handle group listeners correctly when splitting formula group.It will be available in 4.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Thank you so much. Just tested RC3 - it fixes the issue I reported.
id=88786	Createdfile to show the array formula errorProblem description: Steps to reproduce:1. Input 1 in A1, 2 in A2, 3 in A3.2. Input array formula 10-A1:A3 in B1:B33. Result is wrong.Current behavior: Opencalc shows -9,-8,-7 in B1,B2,B3Expected behavior: Opencalc shows 9,8,7 in B1,B2,B3 Hi @water.gian, thanks for reporting.Reproducible.Win7x64Version: 4.4.0.3 Build ID: de093506bcdc5fafd9023ee680b8c60e3e0645d7Version: 4.4.1.0.0+ Build ID: cd2434655c94814598daa8105cab0af314a6adf7 TinderBox: Win-x86@42, Branch:libreoffice-4-4, Time: 2015-01-23_02:40:36Version: 4.5.0.0.alpha0+Build ID: e3c0025461bdf55e62a308a76c3aa0a35109f076 TinderBox: Win-x86@39, Branch:master, Time: 2015-01-24_02:19:31Last working for me:Version: 4.3.7.0.0+ Build ID: db4be3fee9369d8a0bb2df07c25564f19eb564edTinderBox: Win-x86@51-TDF, Branch:libreoffice-4-3, Time: 2015-01-23_21:42:55With the array first works fine.{=-A1:A3+10}Really a dangerous issue.I'm taking care of this.On masterPending review for 4-4Eike Rathke committed a patch related to this issue.It has been pushed to "master":Resolves: tdf#88786 correct matrix sub operationIt will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Can I just put in a plea for a fix before 4.5.0. Array formulae producing the negative of the true result is a major issue and will easily go unnoticed since most users BELIEVE THEIR SPREADSHEET.When and if users discover this, since a lot of them will be using these functions for financial calculations, it is quite dangerous to let them continue without warning.CheersPaulFix will be in 4.4.1 withjust that the commit notification didn't add it to this bug here.(In reply to Eike Rathke from)Thanks. I won't modify all my spreadsheets then :)Really terrible issue as it affect only few array formulas. I found it in spreadsheet with several thousands of array formulas and only 1 formula was affected, at least I didn't found other errors.
id=88935	CreatedFlickering Image frameI always use linked images. They are on the local drive. When scrolling within the document, sooner or later it happens the image-frames begin flickering alternate showing 'Read error' and the path. The document freezes (see attached image). No chance to continue. I have to kill the swriter-process. Most of time this happens at the moment moving between the pages. Note that i use an exclamation mark within the path. With 4.3.5 and earlier i didn't experience this problem, also with documents containing a lot of images.I can't provide a document to reproduce. Asuming it should contain several linked images including caption-frame to raise the problem. @Nicolo, *,Kind of a minimal issue report. We are going to need to know what Windows OS and locale, what GPU are your using, what GPU settings (Options -> View -> Graphics output) you've selected for LibreOffice, what graphic image formats you are linking and having issues with.Sorry but please we need you to provide a test case of some sort (4 to 5 page Writer document, and a dozen junk images linked and captioned). Verify that it is also is actually having the issues with your configuration, and then zip it up and post as an attachment.The test case is going to be needed to allow consistent attempts to reproduce under different OS and GPU configurations.Thanks!Specifications: Windows 7 Professional, Service Pack 1, locale Swiss German, Graphics card NVIDIA GeoForce GTX 650, 8 GB RAM, Intel Core i7 CPU.All images within the document are linked. They are within the attached zip-file, subdirectory 'Abbildungen'. Majority jpg, some png. The error happens casualy, it's not a specific image. Scroll down and up, at the beginning the images display correct. Sometimes, when swiching between pages, the flickering starts as described in my first post.View.. Graphics Output: - Use hardware acceleration: yes- Use anti-aliasing: yes- Use OpenGL for all rendering: no- Force OpenGL even if blacklisted..:noThe problem occours often and soon with the sample document.Please download the sample document with images-subdirectory here (21 MB):Thanks a lot for your efforts. Looking forward to the investigation results.Kind regardsNicoloCreatedsample document and image for flickering behaviorThis is a sample document to reproduce the bug on a MacBook Air (Intel HD Graphics 3000 384 MB, OS X 10.9.5 (13F34)).The flickering stops as soon you click on an image. Once you start scrolling it starts again flickering. With only one linked image you can also see a temporary error message on each new position when scrolling the document. It seems that the linked images get reloaded every time for each new scroll position. What a waste of CPU time!RegardsThomasJust a note that I also have this very same error. And it is a show stopper preventing me from migrating from Apache OpenOffice.CreatedMS Stacktrace of mini-dump during thrashConfirmingOn Windows 7 sp1, 64-bit en-US 12 GB Ram with nVidia GTX-260 and 2GB vRam Version: 4.4.0.3Build ID: de093506bcdc5fafd9023ee680b8c60e3e0645d7Locale: en_USwith default memory/cache settingsFirst couple pages/images load, then scrolling of document triggers issue of multiple Read-Error and file:///xxxxx links pairs being drawn to into the image frame.StackTrace attached of MS Minidump during race condition.sfxlo!SvFileObject::GetGraphic_Implvcllo!GraphicFilter::ImportGraphicand then hangs for JPEG reader.Also present on Linux 64-bit (Fedora 20), although it seems a bit more robust than Windows and allows further scrolling within the test document and linked files. Scrolling up and down in the document will eventually trigger the Read Error -- Path cycling--but with Linux able to scroll away and then back onto the page.Version: 4.5.0.0.alpha0+Build ID: d1c9bd13ec7af93f5368dfda6d6d3c955f0b0816TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2015-01-28_01:15:30Locale: en_USAdding to 4.4 MABConfirmed on LibreOffice 4.4.0.3 (Windows 7 sp1, 64-bit)It happens (at least) with .svg, .jpg, and .png images.(In reply to blargh from)Graphics Output: - Use hardware acceleration: yes - Use anti-aliasing: yes - Use OpenGL for all rendering: no - Force OpenGL even if blacklisted (...):noSame here:Ubuntu 14.04NVIDIA binary driver 331.113Version 4.4.0.3happens with .pngregression from 4.3Using Page Up and Page Down instead of scrolling with the mouse is a temporary workaround for me.(In reply to mace from)In Windows, this doesn't work. The document just becomes unusable after a couple of figures are loaded.Back to 4.3 for me..This seems like the same issue:***has been marked as a duplicate of this bug. ***Seems to also manifest with remotely linked--by URL--images.Createdsample document using remote linked with URL imagesNot just locally linked images, remote linked images also manifest this issue.So, this issue has been present in builds of master through 20150208. But it seems to be resolved with TB62 20150210 builds of master onward. The 20150208 TB62 build was still bad.So,Are these two commits responsible? Serendipity, or were they targeted at this?Could others confirm the fix? Especially on more complex documents with linked images that had been failing.The "svtool/GraphicManager: properly decrease mnUsedSize on unregister ops" patch was already pushed down to 4.4 and is in TBs for 4.4.2 already.And, things seem well behaved with documents with linked images on at this point with Version: 4.4.2.0.0+Build ID: dd53735c5fe98fa4f8da4bf214a04b7883bf73c8TinderBox: Win-x86@42, Branch:libreoffice-4-4, Time: 2015-02-11_15:55:36Locale: en_USBut should the "sw: avoid temporary object creation to build GraphicPrimitive2D" be cherrypicked down to 4.4 as well?(In reply to V Stuart Foote from)This patch fixes a performance regression related to image loading so it seemed a good idea to backport and it might fix this bug (so verification would be appreciated).This other change also improves the performance, but by default we backportsonly bug fixes, so if this one has no visible effect, then I would not cherrypick it.Tested on Windows 7 sp1, 64-bit en-US--against's 40 page .ODT with multiple local linked files with Version: 4.5.0.0.alpha0+Build ID: 40b1e8266e47792d354cd457c652bfb0f0a21e69TinderBox: Win-x86@62-TDF, Branch:MASTER, Time: 2015-02-11_00:13:43Locale: en_USand also with Version: 4.4.2.0.0+Build ID: dd53735c5fe98fa4f8da4bf214a04b7883bf73c8TinderBox: Win-x86@42, Branch:libreoffice-4-4, Time: 2015-02-11_15:55:36Locale: en_USwhich does not have the "sw: avoid temporary object creation to build GraphicPrimitive2D"; it seems fully functional now with just the "svtool/GraphicManager: properly decrease mnUsedSize on unregister ops" patch.Setting resolved, but if folks discover a specific case that continues to cause issue please reopen.Version: 4.4.2.0.0+Build ID: dd53735c5fe98fa4f8da4bf214a04b7883bf73c8Same environment:Tried around with the file i submitted in the 2nd comment. Now it behaves like version 4.3.6.x. Scrolling up and down the appearing image-frame shortly shows the 'Read error' before the image loads. One time it flickered again, but no freezing - could continue without closing the file.So it's fixed, but the showing up 'Read error' isn't trustworthy. Thank's for the efforts.(In reply to Nicolo from)Great! Thank you for verifying.Yes, I see it also, but I don't believe the "Read error" message has ever been more than a nuisance. Since the image is linked, believe it fails with "Read error" message once on screen paint, before processing the link to locate the image.Zolnai Tamás committed a patch related to this issue.It has been pushed to "master":Test for tdf#88935It will be available in 4.5.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.(In reply to Commit Notification from)Thank you Zolnai!Will version 4.4 be patched?(In reply to blargh from)This patch adds only a test case to avoid the same issue in the future.The bugfix is already in 4.4.2.(In reply to Zolnai Tamás from)Perfect! Many thanks!pedroAs mentioned inand confirmed by further comments the 'Read Error' message showing up shortly was 'always there'. But i experience reguarly that the 'Read Error' stays longer and the CPU gets more and more occupied. Some times Writer is blocked for some seconds, or longer, then the menu is available again. Yesterday it was for longer and the CPU was getting hot. Writer didn't freeze completely anymore since this bug was closed, but the basically the problem seems still to be there. It happens regularly with documents containing linked images.My specs are described in(with always the latest Development Versions of LibreOffice and now with 4.4.4.3) and there is also a link to sample document.Kind regards@Nicoloplease do not change version...as written below the version field (even it seems nobody pays attention to it) it has to indicate EARLIEST AFFECTED not LATEST affected so I revert it to 4.4.0.3as the whiteboard indicate the target is 4.5.0 (now called 5.0.0) so there's no surprise you still see the bug in the 4.4.4.3 release since the fix it's only in the 5.0.x branchdid you effectively test the 5.0.0.2 RC release?if some kind of problems persist in that release I suggest to open a clean new report about that and put the current one under "see also"it's always better to open a new one instead of reopening an old fixed issue with lot of comments, expecially when the bug evolved and is not exactly the same as in the original reportso reverting status to RESOLVED FIXED(In reply to tommy27 from)....sorry, did not notice that the 4.5.0 target indicated a testcase and that the fix was already present in 4.4.2anyway I still think you should open a new report about residual issues to avoid further confusion.Migrating Whiteboard tags to Keywords: (regression)[NinjaEdit]
id=89554	Createdsample docSteps:1) Open attached document2) Drag the table on page 1 to page 63) CrashTested and this crash also occurs in 3.3.0, but required undoing the drag and repeating it a few times.Version: 4.5.0.0.alpha0+Build ID: 4cf69df2f543b023f4ec3d4279c5ac11a2a819d9TinderBox: Linux-rpm_deb-x86@45-TDF, Branch:master, Time: 2015-02-21_03:46:34 Createdlinux backtraceConfirmed on LibreOffice 4.4.0 on openSUSE.CreatedbacktraceIt does freeze for a little bit and then it is possible to click on things but they do not work. Going into print preview and coming back out and everything works. Does crash on close.I narrowed the problem down to dragging a table over a page break with a different page style. I thought that two page view might have been involved but the same happens in singe page view.1. New Text Document.2. Enter some empty paragraphs.3. Insert -> Manual Break -> select style First page or Index and OK.4. On first page, Insert table.5. Select table and drag with mouse to second page.Result:Hangs for about 10 - 20 seconds and then application mostly unresponsive.Also, something interesting is that dragging a table results in the new table having the same name.Windows Vista 64Version: 4.4.4.3Build ID: 2c39ebcf046445232b798108aa8a7e7d89552ea8Version: 5.1.0.0.alpha1+Build ID: 89b5967658392d27fb3147e85abb2b5c1c34b101TinderBox: Win-x86@39, Branch:master, Time: 2015-06-24_04:10:17Used the wrong bug prefix on the fix for this
id=88941	CreatedPDF formatting of LO 4.3 and LO 4.4After converting a Writer document with LO 4.4 to PDF some text formatting is lost. I returned to LO 4.3 since PDF exporting is crucial to me. See attached image. Your screenshot show width justified text in 435 and left justified text in 440 - just checking, but I take it that the paragraph attributes weren't changed in between in the actual ODT ?In order for us to be able to test this, we would need your document, or a similar reduced size one that displays the odd behaviour.Setting to NEEDINFO, if information requested is provided, please set back to UNCONFIRMEDCreatedtestfile, justified text, bigger spaced textNot reproducible for me with version 4.4.1.0.0+ built at home under Ubuntu 14.10 x86-64.Best regards. JBFCan not reproduce on Windws 7 sp1, 64-bit en-US withVersion: 4.4.0.3Build ID: de093506bcdc5fafd9023ee680b8c60e3e0645d7Locale: en_USor withVersion: 4.5.0.0.alpha0+Build ID: 4b9a9ce8a0e5e0716dad9a9ec87d16237e534dc2TinderBox: Win-x86@39, Branch:master, Time: 2015-01-31_09:49:44Locale: en_USCorrectly formatted gs based print to PDF, and correct formatting on Export to PDFConfirmed > NEWOSX 10.10.2, LO latest nightly from 2015-01-31Open test file, use LO's own pdf export. Open exported PDF, both issues can be confirmed. Alignment of text on right side is not justified and spacing in mail address is gone.***has been marked as a duplicate of this bug. ***Confirmed in LO 4.4 Mac OS YosemiteVersión: 4.4.0.3Id. de compilación: de093506bcdc5fafd9023ee680b8c60e3e0645d7Configuración regional: es_Note that I originally saw this under Mavericks.I confirm the bug***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***The bug is still present in LibreOffice 4.4.1, Mac OS X version :Version: 4.4.1.2Build ID: 45e2de17089c24a1fa810c8f975a7171ba4cd432Locale : fr_(This is an automated message.)LibreOffice development currently prioritizes bugs with the socalled MAB (most annoying bugs). As this bug has not runthrough that process (including writing a short rationale forthis bug being a candidate and other who are watching thetracker bug silently approving that rationale etc), its priorityis set to high. Note this is effectively no change in theurgency assigned to this bug, as we are currently not making adifference between high and highest and severity is untouched.You can find out more about MABs and how the process works bycontacting the QA Team on IRC:The QA wiki page also gives you hints on how to get in contactwith the team (if IRC fails you, your next best choice is themailing list):(This is NOT an automated message.)If the LO team is not interested in their own Bugzilla, why then reporting bugs anyway? On the other hand LO 4.3 runs well on OSX. So anyone relying on the PDF feature (like I do) should stay with 4.3 and be happy. LO 4.3 should run problem free the next 10 years on all upcoming OSX versions.(In reply to deepflight5 from)There's a simply workaround for this bug, try to use OSX own pdf printer instead. Just press cmd+p for the printer dialog and choose save as pdf.But that's a very feature-deprived workaround as the export doesn't then include things like a table of contents, active links for cross-references, etc.I do a weekly newsletter that includes SVG vector graphics. Exported via the OSX Quartz engine all SVG ends up as garbage in Apple's Preview. Exported via the GhostScript of LibreOffice all SVG is in Preview just fine. So this workaround is not really working for me and my readers. (In Adobe Acrobat Reader the OSX exported PDF just looks perfect, but many readers of my newsletter are OSX users and rely on Preview.)This bug is very annoying. Could some devemopers try to resolve it ASAP ?Regards***has been marked as a duplicate of this bug. ***Hi,This bug is still present il LO 4.4.2.1 Mac OS X.RegardsExperience with similar PDF/GhostScript problems in former incarnations of OOo/LO teaches, that this bug might be around for a very long time. So better stick to LO 4.3 on OSX since this is the last version working correctly. Except from the newly designed buttons and minor fixes you will miss nothing of importance. LO 4.3 runs just fine. Only update to 4.4+ on your Windows and Linux computers.(In reply to deepflight5 from)Keyword -> regressionWhiteboard -> bibisectRequest (**NOTE: If someone wants to track this down with existing OSX bibisect work. For further information, someone could git-bisect this bug directly!)Removing “Blocks 42082”. Seefor why.(In reply to deepflight5 from)Who ever said we’re not interested? You’re right. NOBODY. You’re just reacting like a jerk who can’t even bother to read what the message was about.It is very surprising that this bug has not already been added to MAB 4.4.We receive many questions on this subject on our FR users mailing-list.Done yet.Best regards. JBFThe bug appears also in DrawVersion: 4.4.0.3Build ID: de093506bcdc5fafd9023ee680b8c60e3e0645d7Locale: it_Osx 10.10.2(In reply to Veronika from)Confirming that "Export to PDF" of text entered in Draw document as justified, looses some of its formatting in the resulting PDF.The bug still exists in version 4.4.2.2. :-(4.4.3.1 still affected***has been marked as a duplicate of this bug. ***I can confirm this bug affects the 64-bit versions of LO 4.4.2.2 and 4.4.3.2 on OS X 10.9.5 (Mavericks).I cannot, however, provide a copy of the document in question as it relates to an imminent legal matter.The work-around has been to revert to LO 4.3.7 which works normally (and with less crashes than OOo 4.1.1, as well as less irritation than saving as docbook and converting to pdf with pandoc via LaTeX).This is really serious bug for Mac's users. I don't see we can expect fix in LO 5.0. It is a bad signal for LO reputation. Seriously, the newer LO wouldn't be released without fix of this.I completely agree with deepjungle.maca!That is really really annoying bug.I also had to downgrade to 4.3.In addition to the versions I confirmed in, we can now add:Version: 5.0.0.0.alpha1+Build ID: 2ca7795a6a723c701f295323fcc3f6c52ad37976TinderBox: MacOSX-x86_64@49-TDF, Branch:master, Time: 2015-05-18_00:48:47Locale: en-US (en.UTF-8)Attempting to do a version bisection, you too can download old versions here:3.6.7.2(x86): correct formatting!4.0.0.0(x86): correct formatting!4.3.7.2: correct formatting!4.4.0.0beta1: BAD formating4.4.0.2: BAD formating4.4.3.2: BAD formatingUnfortunately, the first beta of 4.4 has the bug. So, the bug was introduced between 4.3 and 4.4 making it harder to track down the commit that did it.Changing version from 4.4.0.3 to 4.4.0.0beta1. I could not find the 4.4 alpha series.***has been marked as a duplicate of this bug. ***Two work-arounds for this ...First, the easy and obvious one, which we all no doubt already use: keep a copy of 4.3.x handy for exporting to PDF.Advantage: the output is always what we expect.Disadvantages: it's a 650MB work-around which needs to be installed somewhere, ideally in a location that won't conflict with 4.4 and may have unintended consequences when accessing user profiles, especially if both are open or active at the same time.Second, the more fiddly one, which takes a lot of trial and error to get right: it is possible to convert to PDF via Pandoc and LaTeX in a form closer to what was intended.Requirements: Pandoc (available from pandoc.org), latexdiff (available from macports.org or tug.org), latexmk (available from macports.org or tug.org), texlive-latex (available from macports.org or tug.org), texlive-latex-extra (available from macports.org or tug.org), texlive-latex-recommended (available from macports.org or tug.org). Alternatively the much smaller BasicTeX package (available from tug.org) can be substituted for a full installation, but it may require additional work to support all available fonts.Method: save ODF as Microsoft .docx, edit as necessary (at minimum remove footers and page numbering) and then in the Terminal run (in the directory where the file is):pandoc -f docx -t latex -o file.pdf file.docxNote: that images are not included, points and bullets lose their content and tables take a bit of fiddling to word wrap correctly (may require faking it with multiple table rows and hiding the borders). The output will always look like a LaTeX document, noticably different from LibreOffice and other PDFs. Page numbering is automatic by default with numbers in the centre at the bottom of the page. Also note that the best results with pandoc were achieved with Microsoft's docx format, both Docbook and HTML conversions resulted in extremely annoying editing challenges before producing the PDF (though a preliminary run using HTML could produce a LaTeX file with the relevant code to insert images to be pasted into another LaTeX conversion from a .docx file).Advantages: Does not require two versions of LibreOffice, avoids user profile conflicts, saves space from second copy of LibreOffice (if BasicTex used or if LaTeX was installed anyway).Disadvantages: LaTeX tools and libraries take more space than a second copy of LibreOffice (unless BasicTex is used), requires additional editing specific to producing the PDF, loses pictures (can be restored by exporting to LaTeX .tex first and editing the LaTeX code manually or with a LaTeX editor).Recommendation: If you don't use LaTeX for anything else already and/or have no familiarity with it, do not use this workaround. If you have used LaTeX and are cautious with available disk space, try the BasicTex variant of this work-around. If you are more familiar with LaTeX then you might consider this work-around.So, which do I use? Both, with a full LaTeX installation, it depends on the target audience of whatever the document is. If I don't use LaTeX I have to shutdown LibreOffice 4.4 before launching 4.3. I've got 4.3.7.2 installed in /Applications/ and 4.4.3.2 installed in $HOME/Applications/ (to apply the language pack I copied the pack's bzipped tarball from the installer into $HOME/Applications/LibreOffice.app/ and extracted it via the Terminal).LO 5.0 beta1 was released and no fix for this issue. Please, can any of LO developers gives us when they want to fix this? Because PDF export has becomes a bit useless function since LO 4.4 for Mac user. For me it is a crucial function.***has been marked as a duplicate of this bug. ***I managed to build 4.4.0.0alpha2 and it has the formatting error. 4.4.0.0alpha1 would not compile for me.Timeline of bug:20 Nov 2014: 4.4.0.0beta1 tag created (release has bug) 6 Nov 2014: 4.4.0.0alpha2 tag created (compile has bug)19 Oct 2014: 4.4.0.0alpha1 tag created (unknown)13 Oct 2014: 4.4 branch freezeremember 4.3 branch does not have this bug, so I want to assume the bug was introduced in October 2014.Possible files involved:vcl/source/outdev/text.cxxvcl/source/gdi/sallayout.cxx "To justify a text string, Writer calls OutputDevice::GetTextArray()"vcl/source/gdi/pdfwriter.cxxvcl/source/gdi/pdfwriter_impl.cxxI do not know enough about these files to make a judgement, but there were a lot of changes. I was playing around with git to see the changes between the file and the October 4.3 branch (version 4.3.3.2):git diff libreoffice-4.4.0.0.alpha2 libreoffice-4.3.3.2 vcl/source/gdi/pdfwriter_impl.cxxI just confirmed that this applies to both Calc and Presentation as well. So, perhaps we can remove Writer/Draw from title of bug, but it applies to all justified text.An additional rendering glitch concerns italics and superscripted words within justified text, the test.pdf shows gaps before superscripted characters but this also happens with italicised text too.Createdtest.pdf shows excessive gaps before superscripted wordssee previous commentThis seems to have been introduced by the below commit.Adding Cc: to; Could you possibly take a look at this one? Thankscommit cd3d26b7edbce67805259a71e4118223e02ebdd4Author: Norbert Thiebaud <>Date: Fri Jul 18 18:21:12 2014 +0200 vcl consitent use of long for corrdinate most of length in vcl are calculated in 'long' but array of X position tend to be in sal_Int32. As a prep work to be able to support 'double' as the base type of Device Coordinate, harmonize the use of 'long' for non-float coordinate. Change-Id: I7cb33301ff6a5e2c62247b36a4e07e168a58a323Norbert Thiebaud committed a patch related to this issue.It has been pushed to "master":tdf#88941 Revert "vcl quartz: Add support back for DXArray tweaking"It will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Norbert Thiebaud committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#88941 Revert "vcl quartz: Add support back for DXArray tweaking"It will be available in 5.0.0.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.This seems to be corrected now, at least the 5.1 alpha build of this morning ()correctly justifies the test .odt file when exporting to pdf. (I did not make more tests)Since 5.x stable may be a bit far off, it would be good to push this back also to the 4.x branch.Thanks for the patch and finding the bug.verified fix as of.thanks so much Norbert, for looking into this bug affecting a lot of OS X users.Un énorme merci à Norbert Thiebaud qui a corrigé ce bug gênant.A huge thank you to Norbert Thiebaud who corrected this annoying bug.Just FYI, here is an interview of Norbert :The weird gaps before superscripted or italicised words is no longer present either, can confirm fixed here. so I can finally delete 4.3.x! It would be good to see this go into 4.4.x too. A thank you to Norbert for taking the time to revert this.Confirmed that this has fixed the errors I was seeing (with the same document referred to originally) in this build:Version: 5.1.0.0.alpha1+Build ID: 0251e61640b94094918406b33ee7b05564409febTinderBox: MacOSX-x86_64@49-TDF, Branch:master, Time: 2015-07-06_23:27:49Locale: en-US (en.UTF-8)Thanks for the fix, I'm looking forward to a stable deployment later in the year.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Print to PDF is not a option from Impress because doesn't use native print dialogs and page format is fixed to Portrait. Impress is generally Landscape.***has been marked as a duplicate of this bug. ***This problem is still happening through today, July 30th, 2015, so it does not seem to be fixed, at least not for Writer. I hope this can be fixed in version 5.0, as noted in some of the comments below. Thank you.(In reply to maxx366 from)@maxx: in which version of 5.0 ? The fix was only supposed to be integrated as from 5.0.0.3, so it should be in rc4 currently available to download. If it isn't then we need to bump this open again, or try and find out why the fix hasn't yet gone into 5.0.x(In reply to Alex Thurgood from)Thanks for the quick reply. I was only perusing the comments with my reference to version 5.0 -- I am not testing it because I'm just a normal user and probably lack the knowledge to best apply the advance releases. Based on your comment, however, perhaps I will try rc4. Thanks.(In reply to Alex Thurgood from)Perhaps I wasn't clear; sorry. When I wrote that the problem was still happening through today, I meant with all versions of Libre 4.4, including the one that was released earlier today (4.4.5). To avoid it, I opted to revert to version 4.3.7 until the bug is fixed. Thanks.(In reply to maxx366 from)This issue was fixed in today's general release of version 5.0 -- thank you very much!Is there a reason this is not being backported — you have a fix for a major platform bug in the 4.4 series yet haven't backported it yet?(In reply to maxx366 from)I confirm that the bug was fixed in version 5.0Thanks!!@norbert: could this be backported to 4.4 ?***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***You reply to my bug report 95838 that this is a duplicate of. 88941, however, concerns only PDF export. The bug I reported can be seen in LO during text editing as words cut with an invisible right portion.It is claimed that this bug has been corrected in LO 5.0, however, as I have indicated, it is still there in LO 5.0.1CreatedIllustration that right margin justification is faulty in 4.3.7.1 as well(In reply to uwehob from)No, that is all correct--this is fixed. The patch for incorrect justification in PDF was not back ported to the LO 4.4 releases. Your PDF example shows the correct handling of justified text in PDF for 5.0.3 (as patched at 5.0.0.3).As to issues of, agree with Ben M that is a different issue, and closing as duplicate was incorrect. Comments there.Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=89245	Images as part of a page header were lost in Libreoffice Calc. Hello Joerg,Thank you for reporting the bug. Unfortunately without clear steps to reproduce it, we cannot track down the origin of the problem. Please provide a clearer set of step-by-step instructions on how to reproduce the problem.I can produce the bug in the following way1. Create a new spreadsheeth document2. Type anything in3. Select >>Format >>Page >>Page Header >>more... >>Background >>as: Graphic4. Select the graphics file (in my case a PNG-Graphic), select position (in my case upper right)5. Click OK6. Look into the page preview, the page is shown as expected! The logo is placed in the upper right corner.7. Save the document8. Close Libreoffice9. Open the document a second time10. Look into the page preview, there is no Graphic!This bug is new in version 4.4. There are no problems in version 4.3. I use the german version of Libreoffice, so the translation of the buttons etc. can be uncorrect.I have opened the .ods-document with an file archiver (ark under linux). In the directory "pictures" no files are stored.@Joerg: Thank you very much for your fast reply to raal's comment and additional information to reproduce this bug.Reproducible with LO 4.4.0.3, Win 8.1Because of lot's of broken builds (Format -> Page = Crash) it is very hard to bibisect.Bibisect results from 44:Format - Page breaks as ofsource-hash-a7e1ffc248bed431693c6d50c02e7c936c67f360and is fixed as of one ofsource-hash-b9789a63191830a74569ed46f4292968818b5fe2source-hash-973eb2f6db60c0939299a968a3121e3310e6d1f5These should correspond to the below source commits7d9bb549d498d6beed2c4050c402d09643febdfa (break), andf9aa686432c0ba62c6f440302d5a35856496a786 (fix) respectively.There's nothing that looks relevant between those two for sc/source/core/data/documen9.cxx (which both touch), so I'm going to assume it was probably the former commit that broke the retention of background images.Adding Cc: to; Could you possibly take a look at this? Thankscommit 7d9bb549d498d6beed2c4050c402d09643febdfaAuthor: Armin Le Grand <>AuthorDate: Mon Jun 2 15:00:50 2014 +0000Commit: Miklos Vajna <>CommitDate: Tue Jul 1 13:30:09 2014 +0200 Related: #i124638# Second step of DrawingLayer FillAttributes... for Writer objects, now added support for Paragraph and PageStyle (including Header and Footer) for direct attributes and style attributes (cherry picked from commit cc25c58f7052827bfebdc9fbeec668c8fa29ed1b)commit f9aa686432c0ba62c6f440302d5a35856496a786Author: Caolán McNamara <>Date: Wed Oct 15 17:00:57 2014 +0100 Resolves: fdo#81496 crash in calc format page Change-Id: Ic70f6f605e13a5c95b504f1bf0322e11313a21e7Contributing to the forum postI just tried and can confirm the bug also to be present in the recent 32-bit build for Windows: Version: 4.4.1.2 Build ID: 45e2de17089c24a1fa810c8f975a7171ba4cd432Locale: de_DEinstalled from msi, running under Win8.1Header AND Footer were switched back to 'Colour', 'No Fill' after reload.Confirmed with the 44max bibisect repo that the saving of header images breaks betweencommit 7d9bb549d498d6beed2c4050c402d09643febdfaAuthor: Armin Le Grand <>AuthorDate: Mon Jun 2 15:00:50 2014 +0000Commit: Miklos Vajna <>CommitDate: Tue Jul 1 13:30:09 2014 +0200 Related: #i124638# Second step of DrawingLayer FillAttributes...and commit 9e9e9e4748695a626609b380d8cc4a191c54d83aAuthor: Miklos Vajna <>AuthorDate: Mon Jun 30 11:57:32 2014 +0200Commit: Miklos Vajna <>CommitDate: Tue Jul 1 13:30:11 2014 +0200 SwXPageStyle: fix FirstIsShared handling Between these two a file with such a header image fails to save at all. (There are a couple more possible commits directly between the above, but all part of the same series of Apache merges)***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Affects Writer equally to Calc, so setting Component -> LibreOfficeAdded as an MAB because of the number of independent reportsSetting:Importance -> highest (because MAB)Severity -> critical (because data loss and no workaround)Same problem also affecting calc template on both Win and Linux version 4.4I have a ots (calc template) with graphic header and footer that suffers from the same issue when saved as an ods and also opening as a new document from the LO interface. However when I open the same template from a file manager, the header and footer are retained.I'm seeing this in both Linux and Windows (4.4.2.2)Very critical -- Affecting the adoption of LO in our office.Please treat as urgentI can confirm this bug on ArchlinuxLibreoffice Version: 4.4.2.2Build-ID: 4.4.2.2 Arch Linux build-1Kernel 3.19.3-3-ARCH #1 SMP PREEMPT Wed Apr 8 14:24:22 CEST 2015 i686 GNU/LinuxKDE 4.14.6The bug occurs also in version LibreOffice Still 4.3.6-3 on my laptop(In reply to libreoffice from)My grahic was a .gif file and with .jpg and .png the graphic is gone after filesave and reopening. Reopening the format -> side dialog without closing let crash libreoffice.This bug appears to be fixed in LibreOffice 4.4.3.2 on Windows.(In reply to max+freedesktop from)Hi, tried it on an existing file in Calc and the same problem still occurs. Anyone else confirm?Version: 4.4.3.2Build ID: 88805f81e9fe61362df02b9941de8e38a9b5fd16Locale: en_GBOS: Windows 7 x64(In reply to Alex from)Yes, I take that back. It seems to be fixed in Writer, but not in Calc.I tried to insert the image with a Macro: oStyleFamilies = ThisComponent.getStyleFamilies() oPageStyles = oStyleFamilies.getByName("PageStyles") oPageDefault = oPageStyles.getByName("Default") oPageDefault.HeaderBackGraphicURL = imageURLThis is only possible if a string is entered. With ConvertToUrl(), the value is not set and remains empty. imageURL="/home/riwollis/logo.gif" is possible imageURL="file:///home/riwollis/logo.gif" don't work.Here is my workaround:sub kopf_setzen oGetGal = CreateUnoService("com.sun.star.gallery.GalleryThemeProvider") oGalSchnitte = oGetGal.getByName("Schnitte") oDoc = ThisComponent oStyleFamilies = ThisComponent.getStyleFamilies() oPageStyles = oStyleFamilies.getByName("PageStyles") oPageStylesDef = oPageStyles.getByName("Default")'Werte für das Logo ermitteln For i = 0 To oGalSchnitte.Count - 1 itemAktuell = oGalSchnitte.getByIndex(i) itemTitel = itemAktuell.Title if itemTitel = "logo" then SchnittURL = itemAktuell.URL end if next i sSchnittfilePath=SchnittURL SchnittURL = ConvertToUrl(sSchnittfilePath) oPageStylesDef.HeaderBackColor = -1 oPageStylesDef.HeaderBackgroundColor = -1 oPageStylesDef.HeaderBackGraphicFilter = "GIF - Graphics Interchange Format" oPageStylesDef.HeaderBackGraphicURL = SchnittURL oPageStylesDef.HeaderBackGraphicLocation = 3 oPageStylesDef.HeaderBackTransparent = Trueend subThe other pictures of my template are also stored in the gallery. It is also possible to store the grafic in the directory of template. You can set this macro as event.***has been marked as a duplicate of this bug. ***Hi! Tried 4.4.4.3 and Calc still crashes but it seems a bit more robust than last time. Before all I had to do was:1. Format >> Page >> Header(Tab)2. More >> Background >> As Graphic >> Add graphic3. OK >> OK4. Format >> Page5. Program CrashNow it's the following:1. Format >> Page >> Header(Tab)2. More >> Background >> As Graphic >> Add graphic3. OK >> OK4. File >> Export as PDF >> Export >> Save5. Format >> Page6. Program CrashAlso it's still not saving even if you don't follow these steps.Can anyone confirm this?(In reply to Alex from)Running 4.4.4.3, I cannot reproduce the crash - though the issue itself persists.***has been marked as a duplicate of this bug. ***in Version 5.0.0.5 this Bug and the same problem still occursVersion: 5.0.0.5Build-ID: 5.0.0.5 Arch Linux build-1Gebietsschema: de-DE (de_DE.UTF-8)Kernel: 4.1.4-1-ARCHKDE 4.14.10(In reply to libreoffice from)Hi friend,Thanks for confirming! When you change the field version, there is (or should be) a warning on the page. Please do read that the next time :) It will inform you that the version field reflects the earliest version that the bug occurs. I'll set that back for now.Cheers - CorThe problem is that commit Armin's 7d9bb549d498d6beed2c4050c402d09643febdfa added CTF_PM_REPEAT_OFFSET_X..CTF_PM_FILLTRANSNAME defines in include/xmloff/PageMasterStyleMap.hxx with values that collide with existing CTF_PM_HEADERGRAPHICFILTER..CTF_PM_HEADERGRAPHICURL. I'll take care of this.Miklos Vajna committed a patch related to this issue.It has been pushed to "master":tdf#89245 xmloff: fix Calc header background image savingIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Miklos Vajna committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#89245 xmloff: fix Calc header background image savingIt will be available in 5.0.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Miklos Vajna committed a patch related to this issue.It has been pushed to "libreoffice-4-4":tdf#89245 xmloff: fix Calc header background image savingIt will be available in 4.4.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.let's try that again...***has been marked as a duplicate of this bug. ***Happens again in version 4.4.5.2!!!! Every time I close calc and open the document again there is no picture either in header nor in footer. 100% reproducible. In the earlier versions it happened from time to time. Now it is permananent :((In reply to Piotr from)read, or look at the whitebaord -- not until the 4.4.6 release, or move to Fresh 5.0.1Sorry to bother again but I just installed fresh version 5.0.1.2 and the same happens again. Every time. I tried to copy old document with pictures and after file save pictures dissapear. I tried to create a new one. It's all the same.both of you look atit will be in 5.0._2_(In reply to Piotr from)Message #30 #31 #32 says patched versions are:It will be available in 5.1.0.It will be available in 5.0.2.It will be available in 4.4.6.Kindly try one of thoseSo marking as resolved again.(In reply to Norbert Thiebaud from)Sorry, my fault, 5.0.2 or a build of master 5.1.0alpha0+Please never reopen bugs if you are not a member of the QA team, especially if you have not even tried out patched builds (which are specified in the whiteboard, as others have mentioned before) in order to verify a fix. Enough with the bugmail noise.Migrating Whiteboard tags to Keywords: (dataLoss, bibisected)[NinjaEdit]
id=89615	After saving an .odt file in writer with lots of comments, the file cannot be opened anymore (Lesefehler: Formatfehler). After unzipping the file and editing content.xml, I discover that there is a "style" tag which has two "office:name" attributes with identical values.This has happened twice with the same document. (I can provide the document but it is kind of semi-confidential, don't want to upload it here).Please let me know if you need any further information! Sorry, forgot to include version:Version: 4.3.3.2Build-ID: 430m0(Build:2)on Ubuntu 14.10 64 bit, German language(In reply to Titus Stahl from)You could try this:Set to NEEDINFO.Change back to UNCONFIRMED after you have an example file for us. Thanks.Createdtestcasethis is a testcase. basically, if I change anything in the document and save it, it cannot be opened anymore.Version: 4.4.2.2Build-ID: 40m0(Build:2)Gebietsschema: de_DEon Ubuntu 15.04, 64-bitCreatedSmall document with changes and notes: example of an opening error.This type of error is very common if you keep changes and notes in the same document. Changing notes will very, very often crash the document.Went back from 5.0 to 4.4 because of the large number of crashes with documents like these.Running on Ubuntu 15.04 64 bits.a regression from the AOO imported range annotation feature,commit 0761f81643a6890457e9ef7d913ab5c88c2593a4this was fixed in LO 4.4.4 bycommit 804ec2289115a65c74ddff478b7469801debf7e4Author: Caolán McNamara <>AuthorDate: Wed Apr 22 14:10:38 2015 +0100 fix assert on export of ooo63141-1.doc to odt if bAutoStyles is true then the mbDoSomething of the SvXMLElementExport is false, and the ctor/dtor doesn't do anything so any attributes added to the exporter are not cleared by the SvXMLElementExport dtor so only add the attribute if bAutoStyles if false and might as well extend the block to cover the use of SvXMLElementExport and use the other ctor which defaults mbDoSomething on***has been marked as a duplicate of this bug. ***
id=90057	Inserting a video into impress with master crashes LibreOffice. Tested this on Linux Mint 17 XFCE 64-bit and Xubuntu 14.04 32-bit. I let LO run for 5 minutes before forcing it to quit.Version: 4.5.0.0.alpha0+Build ID: de145fb467f2a168261915d63b47d3cd3b03d732TinderBox: Linux-rpm_deb-x86@45-TDF, Branch:master, Time: 2015-03-15_09:51:29Version: 4.5.0.0.alpha0+Build ID: e3167924fd28c8b854f23139dbf49f53e6282ef7TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2015-03-17_03:10:47 Which type of video? (I mean which format video and audio codec)?Would it be possible you attach or put it available somewhere?It will happen with any media file, but i was using the avi file found at ().@Qubit: did this happen to you when you were testing on Ubuntu?On pc Debian x86-64 with master sources updated today, I could reproduce this.I noticed these console logs:warn:sd.core:23142:1:sd/source/core/PageListWatcher.cxx:95: ImpPageListWatcher::GetSdPage(PK_STANDARD): page number 1 >= 1warn:avmedia:23142:1:avmedia/source/viewer/mediawindow_impl.cxx:277: failed to create media player service com.sun.star.comp.avmedia.Manager_VLCMichael: thought you might be interested in this one since it concerns including video.In fact, it fails with com.sun.star.comp.avmedia.Manager_VLC but it succeeds with com.sun.star.comp.avmedia.Manager_GStreamerSo I've kept on with gdb + ctrl-C at random and, seeing the bts, I wonder if it could be due to idle/timer last changes.I believe(simply enabling the media playback toolbar) may also be effected by this issue.(In reply to Jay Philips from)No crashes for me with the test media when I did my initial tests. What's the specific file url?(In reply to Robinson Tryon (qubit) from)It crashes with any of the test files in master. Also noticed the wiki link to the owncloud of the test files doesnt work. :D(In reply to Jay Philips from)Weird. I'll grab a master build and try it myself.Uggh. Yeah, our ownCloud integration keeps on getting broken. I'll poke infra to fix that straightaway.TESTING on Ubuntu 14.04 with LibreOffice master (daily):Version: 4.5.0.0.alpha0+Build ID: bdad6d0fe492a2334cb27ef54fc5d1cba17d1970TinderBox: Linux-rpm_deb-x86_64@46-TDF,Branch:master,Time: 2015-03-19_00:36:37Locale: en_US(In reply to Jay Philips from)REPRO Steps:1) Open Impress2) Insert -> Media -> Audio or Video (dialog opens up)3) I selected and inserted big_buck_bunny_480p_stereo_avidemux_30sec.avi from the set of test media ()RESULT: LibreOffice hangs ----Testing on the same machine, but with LO 4.2.6.3:1) Open Impress2) Insert -> Movie and Sound (dialog opens up)3) I selected and inserted big_buck_bunny_480p_stereo_avidemux_30sec.avi from the set of test media ()RESULT: No hang/no crashKeywords -> regressionWhiteboard -> bibisectRequestThis started on the same date as, which is to say 2015-03-07: source-hash-333f8a76341f5b4921e89012d133007503e49612in the 4.5 dbgutil bibisect tree - and I think that is going to turn out to be the more relevant report. Most likely inserting a video hangs too because that automatically selects the inserted object, which in turn shows the media toolbarTobias - potentially linked to the idle/timer work =)Bisected to the same range as- seemp3 crashes LO too.Its fixed now thathas been fixed.Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=90082	CreatedODP File and two screen shotsAttached is a ZIP file with- an ODP file with one slides that has a box with text in in- a screen shot of the editing view- a screen shot of the presentation viewIn the presentation view the box is visible but not the text. Reproducible with LO 4.4.1.2, Win 8.1Note: If you insert a second slide and start the presentation and then go on the second slide back to the first slide then everything is visible.This problem occurs on the first slide shown in a presentation. So if you have 3 slides and you start with slide 2, the text will not be shown.As soon as you navigate to another slide, the content is rendered correctly.Changed to Highest importance. Actually, I think it should have a Blocker status too, because the presentation mode is a core function of IMPRESS and if it does not work it is a broken core function (see Bug Priority Triage Flowchart)-Simple test to reproduce:1. Open IMPRESS2. In a new presentation write any word3. Start the presentationResult: Empty white screen.4. With the mouse scroll down to get to the end of the presentation and then scroll back upResult: Text is visible.(In reply to A (Andy) from)in 4.4.2.1 is not reproducedVersion: 4.4.2.1ID build: 93fc8832889bf050a10ec6d0171dae213adc9b55Locale: ru_RUOS: Windows 7 HB x86On Windows, if I uncheck Tools > Options > LibreOffice > View > Use hardware acceleration, bug disappears.This issue is fixed in LibO 4.4.2.1 (hopefully)*** This bug has been marked as a duplicate of***
id=90238	CreatedScreenshot of "LibreOffice has stopped working" bugAfter updating to LibreOffice 4.4.1.2, I often (at least half the time) get a message that "LibreOffice has stopped working" after exiting Calc. I have attached a screenshot. This appears to be a totally random event --- I cannot detect any causality. CreatedScreenshot of "LibreOffice has stopped working" bugYou could try this trick:Please try to reset profile as said inand let as know. Screenshot is probably other..That fixed it!Thanks for testing! As this was some strange glitch and not really a bug, I'll change the status to INVALID.I have been entering data into my calc spreadsheet for about 15 minutes and then I get a window that says that 'LibreOffice has stopped responding'. And I loose everything I have entered.This has happened 3 times to me now.Very frustrating!!!(In reply to Herb from)Please create a new bug report for your problem.
id=90077	Steps:1) Open impress2) View > Toolbars > Media PlaybackThis is a regression as this doesnt happen with 4.4 daily.Version: 4.5.0.0.alpha0+Build ID: de145fb467f2a168261915d63b47d3cd3b03d732TinderBox: Linux-rpm_deb-x86@45-TDF, Branch:master, Time: 2015-03-15_09:51:29 Specifically, I see a hang rather than a crash. It starts at 2015-03-07: source-hash-333f8a76341f5b4921e89012d133007503e49612in the 4.5 dbgutil bibisect treeThe recent idle/timer work landed in that range, and I don't see anything else obvious, so it seems plausible that this could be fallout from that.(The toolbar contains elements which look like they should update on timers, so maybe that's why?)Adding Cc: to; Could you possibly take a look at this one? ThanksSetting -> NEW as already confirmedSomewhere in the range9e678c14e4fc8e58b1e0530744f648fa3958d338^1..d05a64df34fd143670cb939b72abfb32d6b714c7(not individually buildable)Still reproducible, Windows 7 x64 and LibreOffice Version: 5.1.0.0.alpha1+Build ID: 6a626955eb8b803fa58a58baafaa2a06ab4761f2TinderBox: Win-x86@39, Branch:master, Time: 2015-05-30_07:46:48Locale: nl-BE (nl_BE)Noel Grandin committed a patch related to this issue.It has been pushed to "master":tdf#90077 fix freeze when enabling media toolbar in ImpressIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Noel Grandin committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#90077 fix freeze when enabling media toolbar in ImpressIt will be available in 5.0.0.0.beta4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.***has been marked as a duplicate of this bug. ***Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=90757	CreatedThis is the file described above that causes the crashBug originally filed onasWhere it is described by apport assoffice.bin crashed with SIGSEGV in ScDocShell::AdjustRowHeight()I was asked by Ubuntu bug squad to file an upstream bug report.Here are instructions on how to reproduce the crashI just confirmed that I can cause this problem at will. Here are the steps:Open Libre Office Calc.Select the file I included, NEWMAST_core_5e_crashed_sort.ods, from Recent Documents File>Recent Documents>NEWMAST_core_5e_crashed_sort.odsThe file appears to open just fine.Select column U by clicking in the U column header; in the status panel at the bottom of Libre Calc you should see Selected 1048576 rows, 1 columnSort the column itself Data>Sort...Up comes a panel that suggests you can extend the selection or use the current selection. Click "Current Selection".Up comes a panel that offers various sorting options; leave as is and click "Ok".Libre Calc crashes. This can be confirmed by restarting Libre Calc which offers to recover from a crash on that document, and it recovers successfully.Apport is automatically triggered which filed this bug report in the first instance.Note that normally one would want to sort the entire sheet by one or more columns, but in this application I am just sorting the column to look for non-blank data and I will Undo the sort subsequently. Createdbt with debug symbolsOn pc Debian x86-64 with master sources updated today, I could reproduce this.This began at the below commit.Adding Cc: to; Could you possibly take a look at this one? Thanks commit 9a568c41ccd1ccf6073758973da5914a44f629d2 Author: Eike Rathke <> AuthorDate: Fri Dec 5 21:32:06 2014 +0100 Commit: Eike Rathke <> CommitDate: Fri Dec 5 21:40:27 2014 +0100 Ctrl+A and Data Sort took ages to broadcast ALL cells ... now that also empty cells are to be broadcasted. Set dirty and broadcast only the effective data range as determined by Sort. This is more a workaround, a cleaner solution would be to refactor the SetDirty() algorithm to iterate only through broadcasters and use AreaBroadcast() to notify area listeners. However, this can also be easily backported to 4-3. Change-Id: I6d68ca0088cec6a8328a3e93364ac928ef69babeI tried on Fedora 21 with master dbgutil build and current 4-4 (to be 4.4.4) and 4.4.3, but could not reproduce.@Matthew:How did you determine that commit? Did you really bisect, or actually bibisect?However, this#7 0x00002aaaca38082f in ScDocShell::AdjustRowHeight (this=0x29cc960, nStartRow=1, nEndRow=0, nTab=0) at /home/julien/compile-libreoffice/libreoffice/sc/source/ui/docshell/docsh5.cxx:373looks suspicious with nStartRow > nEndRow, which is propagated down to the other functions on the stack.Hi Eike,I'm the person who reported the bug.Would you be so kind as to confirm that when you say "I tried on Fedora 21 with master dbgutil build and current 4-4 (to be 4.4.4) and 4.4.3, but could not reproduce" you mean using the file I uploaded and sorted only on column U?The reason I ask is that when I originally reported this on Launchpad, the person triaging bugs could not reproduce it until I sent the actual data and instructions.Thanks very much! And my apologies in advance if this is a dumb question!***has been marked as a duplicate of this bug. ***(In reply to Eike Rathke from)Actually bisected (well, used a pre-release 1:1 bibisect tree for 5.0 master, but same thing ;)It still crashes for me on master as of 98436c4b53639d86f261ac630c46d32e3c7b8e28 (2015-05-04)@Chris:I did what you described, sorting only on entire selected column U.This makes no sense, ScDocShell::AdjustRowHeight() is not even executed from ScDBDocFunc::Sort() in this constellation because the previous call to ScDocument::HasUniformRowHeight() in ScDBDocFunc::Sort() determined all heights are uniform in the range (bUniformRowHeight=true).However, I know what could go wrong if it actually was executed.. and indeed, when resizing one row (e.g. 3) before the sort I can reproduce.Eike Rathke committed a patch related to this issue.It has been pushed to "master":Resolves tdf#90757 ensure start row / end row order makes senseIt will be available in 5.0.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Pending review for 4-4(In reply to Eike Rathke from)Thanks, @Eike. I look forward to testing the patch.Eike Rathke committed a patch related to this issue.It has been pushed to "libreoffice-4-4":Resolves tdf#90757 ensure start row / end row order makes senseIt will be available in 4.4.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.***has been marked as a duplicate of this bug. ***Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=90773	CreatedSample PresentationOpening impress presentations take a very long time with LibreOffice 5. Using the small sample presentation attached LibreOffice Impress has the following response times:LibreOffice 4.4.3: 5 sLibreOffice 5.0.0: 45 sDegradiation of loading time seems to depend on the number of slides contained within the presentation:(1) With 10 or less slides loading times of LibreOffice 4.4.3 and LibreOffice 5 are similar.(2) With 30 slides (sample presentation) loading times of LibreOffice 5 are much worse than loading times of LibreOffice 4.4.3.LibreOffice 5 is compiled from the current revision from master. Loading LibreOffice itself is included within the measurements. As LibreOffice has been loaded from SSD the time allotted to loading LibreOffice is very small in relation to loading the presentation itself using LibreOffice 5.The problem has been observed on Mac OS X 10.10.3 with LibreOffice 5. It doesn't seem to be present in earlier releases of LibreOffice. @Thorsten : please indicate exactly how you opened the file so that I can test in a comparable manner, as you mention that document loading times also included app startup time.If the problem is in the app startup time, then overall times for opening a giving document are all the more relative.Setting to NEEDINFO pending requested information. Please set to UNCONFIRMED once you have provided that information.Right mouse button click on Sample.odp file, the choose Open with :LibreOfficeVersion: 4.4.2.2Build ID: c4c7d32d0d49397cad38d62472b0bc8acff48dd6Locale : fr_Time : 26.6 secondsRun test with Version: 5.0.0.0.alpha1+Build ID: da36fc8c9564199b8c2f8f28c2e4d04d9862a2d4TinderBox: MacOSX-10.10@61, Branch:master, Time: 2015-04-21_21:09:35Locale: fr_I couldn't use the context menu "open with LibreOfficeDev" as this fails with a service configuration error and LO refuses to start, so I started LibreOfficeDev separately, and then dragged and dropped the file onto the StartCenterTime : 1 min 32.8 secondsIn other words, a F-fold increase in loading time.CONFIRMING, REGRESSIONManaged to repeat the test with LODev daily via the context menu (some user config corruption problem prevented this in my previous test apparently)Time : 1 min 39.9 secondsI have repeated the test with the Sample document, and there is a minor delay: LibreOffice 4.4.3.1 has opened the file in less than 2 seconds, and LibreOffice 5.0 Alpha in less than 5 seconds. The delay is visible with a 99MB presentation (over 100 slides), which is opened by LibreOffice 4.4.3.1 in less than 5 seconds and by LibreOffice 5.0 Alpha in over 40 seconds. Actually, the file is loaded fast (more or less, the same time for both LibreOffice versions), but the visualization takes significantly longer.FWIW, my test bed :Mac mini Server (mi-2010)2,66 GHz Intel Core 2 Duo4 Go 1067 MHz DDR3NVIDIA GeForce 320M 256 MoI have just tried this on one of my own Impress ODP files that contains just 35 slides of text (no images, no drawings or tables)Select file in Finder, right mouse button click, Open withLO is not running previous to launch.LO4422 : 17.5 secondsLO5 dev alpha daily 21/04/2015 : 1 minute 48.5 seconds !!!Another of my presentations contains 50 slides, coloured background, some images, but mostly text.LO4422 : 6.6 secondsLO5dev daily 21/04 : 2 minutes 33.8 secondsI have noticed that the problem is more marked when one switches application context after shutdown of LibreOffice, i.e. when one clicks on another application window before opening an ODP file.There are no blockers!I noticed more severe performance problems with Impress. Moving objects with arrow keys has very long delays and is in many cases not completed correctly. I don't know whether this is due to the same reason as opening files with long delays or another problem with a different reason.The development version of Impress is not usable for creating presentations for now. I had to switch back to LO 4.4.3.Problem is still present - with LO 5.0 beta as well as with LO 5.1 from master.The issue concerning object moves with arrow keys seems to be a different issue, because I'm able to reproduce it now. I will file a different bug.The issue seems to have disappeared using LO from master. It is still present in LO 5.0 beta. I recommend fixing it in LO 5.0 beta too.The issue seems to have disappeared in LO 5.0 beta too. There are still other performance issues with Impress. Impress seems to become slow when working for a while, e.g. 10 or 15 minutes. Compared with LO 4.4 Impress performs still worse.Significant Impress performance issues still exist in LO 5.0.1, 5.0.2, and master. Typing of characters as well as inserting objects and many other operations become very slow after a while. Creating a presentation with Impress from LO 5 is very annoying. I'm able to use LO 5 with Writer and Calc, for Impress I have to use LO 4.5.@ QA: It seems this regression is getting less attention. As the original FILEOPEN issue seems to be resolved, is it reasonable to file a dedicated new issue to raise attention?(In reply to Thorsten Wagner from)Yes, please do. The developers (and the rest of us) can easily get bogged-down in comments and bug-change history that's unrelated and irrelevant to the particular issue that remains.If the FILEOPEN problem is fixed, please mark the bug as RESOLVED WORKSFORME so we can clear it off the open pile :-)The original FILEOPEN issue seems to be resolved. I will file another bug for the general performance issue.Migrating Whiteboard tags to Keywords: (notBibisectable perf)[NinjaEdit]Dear All!I am using laptop with Core i5 3rd generation, 4GB RAM. I working with LibreOffice 5.3.0.3. My problem is the presentation files take too long to open when I open them. I opened LibreImpress file of size 9.9 MB which contains mostly charts and tables, some images, it takes around 7-8 mins. average to open the file every time. Please help to resolve the issue.Thanks,Peeyush
id=90913	How to test :1) Start LO2) Close StartCenter3) Cmd-O to open Finder dialogVersion: 4.4.2.2Build ID: c4c7d32d0d49397cad38d62472b0bc8acff48dd6Locale : fr_0.01 secondsVersion: 5.0.0.0.alpha1+Build ID: 950055bcb06c8edcd9062c71184f02bf8e0604e6Locale : fr_58.2 secondsOSX 10.10.3Mac mini Server (mid-2010)2,66 GHz Intel Core 2 Duo4 Gb 1067 MHz DDR3NVIDIA GeForce 320M 256 Mo Note that subsequent openings of the Finder dialog are quasi-instantaneousAn alternative test, e.g. when invoking the File Save dialog for the first time, leads to the same poor performanceBuild switches, fwiw :--with-ant-home=/Volumes/BUILDHD/Shared/packages/apache-ant-1.9.2--without-junit--enable-64-bit--with-extra-buildid--enable-ext-nlpsolver--enable-ext-google-docs--enable-ext-languagetool--enable-ext-diagram--enable-ext-typo--enable-ext-validator--enable-ext-watch-window--enable-extra-template--enable-extra-gallery--enable-ext-wiki-publisher--enable-extension-integration--with-lang=fr--with-help--enable-epm--with-package-format=dmg--enable-ext-mariadb-connector--with-system-mariadb--enable-bundle-mariadb--with-myspell-dictsTested on nightly build :Version: 5.0.0.0.alpha1+Build ID: 38992b419a4655eba9b85d337edbb208fd2fff95TinderBox: MacOSX-10.10@61, Branch:master, Time: 2015-04-27_23:59:04Time to display of Finder dialog : 48.3 secondsCreatedProfile of Cmd-OAttached a screen capture of Profile with OSX profiling tool. Thr first spike appears when CMd-O is released and then nothing happens, literally until the next group of spikes which is when the Finder dialog gets displayed.This doesn’t qualify “critical” importance.(In reply to Adolfo Jayme from)Whatever. I'm quite sure someone in the communication department will be able to spin something positive out of it.I read this :and set to high/major instead.Confirming this. Imo has been going on in the nightly for a while and is very annoying because it is a basic function you almost always use whenever you use LO. → NEWGets better and better :Version: 5.1.0.0.alpha1+Build ID: 55431a84c264a8bcca593b9207aae0ad81d10f30Locale : fr-FR (fr.UTF-8)Time to open Finder dialog from fresh start : 2 minutes 3 seconds2 minutes to open a ******* dialog, if that isn't critical, I don't know what is.I am declaring this critical. We have more than doubled the time to open the dialog on the same hardware in the space of a month.(In reply to Alex Thurgood from)Hi Alex,This does look like a serious perf regression.Whiteboard -> perfAre you able to reproduce with current master or 5.1 beta 1 builds? Thanks!"Current" master builds for osx are not available. cloph has been busy trying to fix and sounds like they should be coming back fairly soon.keep an eye on:@Robinson: I can confirm that withVersion: 5.1.0.0.alpha1+Build ID: 7565f3c3b1ed189265a85c301e9483cddde32483TinderBox: MacOSX-x86_64@49-TDF, Branch:master, Time: 2015-11-19_06:19:57Locale: de-DE (de.UTF-8)this is no longer a problem. (which is very confusing, because I think I ran into this exact bug with this version).Sorry, no exact info but still wanted to add my findings.@Alex: what's the status of this bug on your machine with latest nightlies?(In reply to Robinson Tryon (qubit) from)Yep.Version: 5.2.0.0.alpha0+Build ID: 098e9dc376346ad13c63fdef292ab640d89c6a21Threads 2; Ver: -; Render: default; 2 min 05 sReproduced w10.11.1 + LO Version: 5.2.0.0.alpha0+Build ID: 1fd41f43eb73c373cb94d32d82c5fb7a7e243367Threads 4; Ver: -; Render: default; TinderBox: MacOSX-x86_64@49-TDF, Branch:master, Time: 2015-12-03_23:48:44Locale: de-DE (de.UTF-8)1) Start LO2) Close StartCenter3) Cmd-O to open Finder dialog26 seconds.@Robinson: please escalated to dev department.Cannot reproduce on 10.11.2 public beta 15C48a and:Version: 5.2.0.0.alpha0+Build ID: 1fd41f43eb73c373cb94d32d82c5fb7a7e243367Threads 8; Ver: -; Render: GL; Close StartCenter and ⌘o opens the file dialog instantly for me.(In reply to steve -_- from)Done: I brought this up during ESC on Thurs.(In reply to Iandol from)Hmm... let's compare that with steve's repro environment:* Same version of OSX (modulo a micro-point-version bump).* Same LibreOffice (exact same Build ID)* Render: default vs. GLIandol/Steve: Can each of you try switching to use other render, and then report results? Thanks!Version: 5.2.0.0.alpha0+Build ID: 8a086a2c08efe2037957b959109e72b8bb3e27b7Threads 4; Ver: -; Render: GL; TinderBox: MacOSX-x86_64@49-TDF, Branch:master, Time: 2015-12-07_08:16:55Locale: de-DE (de.UTF-8)OpenGL enabled → save as dialog instantly showsOpenGL disabled → save as dialog instantly showsSorry, those results are contradictory to my previous statement (where I also ran into the spinning beachball and long wait time for the save dialog).The Use OpenGL switch makes no difference to me with regard to opening time of the dialog.(In reply to Alex Thurgood from)Version: 5.2.0.0.alpha0+Build ID: eb38493c4101d8777052267ee83a5d4f883dd9acThreads 2; Ver: -; Render: default; Locale: fr-FR (fr.UTF-8)(In reply to Alex Thurgood from)I would add that activating OpenGL causes LO to instantly crash and restart if I call up the About dialog (another new bug report in the offing)It would be good if we could compare physical machine specs. I notice coincidentally that :- in my case, I only have 2 threads running- in Steve's case, he has 4 threads running- and in Iandol's case, he has 8 threads runningCould it be that we have a thread race condition which is dependent on the hardware ? For example, I only have 2 cores (2,66 GHz Intel Core 2 Duo) - how does LO use the available cores on a machine ?Tetsesd on MacBook Pro (Retina, 15 pouces, fin 2013)2,6 GHz Intel Core i716 Go 1600 MHz DDR3NVIDIA GeForce GT 750M 2048 Mowith Version: 5.2.0.0.alpha0+Build ID: 4754afddc3030347ef49b401a9b798cea8fe523cThreads 8; Ver: -; Render: default; TinderBox: MacOSX-x86_64@49-TDF, Branch:master, Time: 2015-12-09_07:17:31Locale: fr-FR (fr.UTF-8)Time to open dialog : 3.6 seconds(In reply to Alex Thurgood from)Compare that with my own master build (built on Macmini) from last night on same test machine :Version: 5.2.0.0.alpha0+Build ID: eb38493c4101d8777052267ee83a5d4f883dd9acThreads 8; Ver: -; Render: default; Locale: fr-FR (fr.UTF-8)Time to open dialog : 20.4 seconds(In reply to Alex Thurgood from)OSX 10.11.1Mac mini Server (mid-2010)2,66 GHz Intel Core 2 Duo4 Gb 1067 MHz DDR3NVIDIA GeForce 320M 256 MoTDF Nightly build Version: 5.2.0.0.alpha0+Build ID: 4754afddc3030347ef49b401a9b798cea8fe523cThreads 2; Ver: -; Render: default; TinderBox: MacOSX-x86_64@49-TDF, Branch:master, Time: 2015-12-09_07:17:31Locale: fr-FR (fr.UTF-8)Time to open dialog : 1 min 37.2 secondsMigrating Whiteboard tags to Keywords: (notBibisectable, perf)With latest master dbgutil, the initial Finder window opens more quickly, but first selection of any file takes so long that OSX considers the app to be not responding.By first selection of any file, I mean that when one selects a file with the mouse in the Finder dialog list of files, the Open button is not activated for more than a minute.No repro with 10.12.1 Final Build (16B2555) on a Macbook Air6.1, Intel Core i5 Dual Core with:Version: 5.2.2.2Build ID: 8f96e87c890bf8fa77463cd4b640a2312823f3adCPU Threads: 4; OS Version: Mac OS X 10.12.1; UI Render: default; Close StartCenter and ⌘O opens instantly a responsive file dialog.same here w latest master on 10.12.1OK, so let's close this as WFM. I still get a ca. 30s delay between activating Cmd-O and obtaining a responsive Finder dialog where I can open a file, on first start of LibreOffice on my test platform (macmini 2010). Further successive startups are much quicker (2-5s).
id=90809	CreatedThe problem documentPlease open the attachment then ctrl-end to go to the last character then press backspace. This will crash the Writer. I can not reproduce with LO 4.4.2.2, win7I can confirm with Version: 5.0.0.0.alpha1+Build ID: badec7478035008f514e0976a94438fe2e32dc40TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2015-04-22_01:28:24LO 4.3.3No crash with LibreOffice 3.5.0 Build ID: d6cde02 , regressionCreatedgdbtracecommit 7e1458eeba4fb40a796b1318a034410a97b6b24bAuthor: Bjoern Michaelsen <>Date: Thu Oct 17 16:03:09 2013 +0000 source-hash-926275d07184d441b3bfa1ceca26c4c1f2bc61db commit 926275d07184d441b3bfa1ceca26c4c1f2bc61db Author: Tomaž Vajngerl <> AuthorDate: Wed Jul 3 22:05:30 2013 +0200 Commit: Tomaž Vajngerl <> CommitDate: Wed Jul 3 22:05:30 2013 +0200 Compiler error fixes in PolynomialRegressionCurveCalculator Change-Id: Ie78e10fea0b798fae5ce2cee96798bcc65bbccbe:100644 100644 01a521d81b05da62fc741f4064b361b8fc660907 66d8b904195e1d73dd269aa03bc111d2e66c9469 M ccache.log:100644 100644 8cac93c0ec3bcfc227282d1749f0cfdbd09d2f1b c69e50d0e426322517161edf3feff6f55ae114de M commitmsg:100644 100644 e4f1b8f0fa234364dce0bcb5cf8250b29f79554c a1de2224c5ad6b755aea158667df86c3ee2bbf88 M dev-install.log:100644 100644 fb93205802763858eb230d6dbff4d0a562b16671 cf5579f82b33e1dd85a0da6308b126647bd335d3 M make.log:040000 040000 d81597b06f640c259130c06a16e8b026acfc3867 27d70a3fd54fcc828456bf70a677f3652c744754 M opt# bad: [423a84c4f7068853974887d98442bc2a2d0cc91b] source-hash-c15927f20d4727c3b8de68497b6949e72f9e6e9e# good: [65fd30f5cb4cdd37995a33420ed8273c0a29bf00] source-hash-d6cde02dbce8c28c6af836e2dc1120f8a6ef9932git bisect start 'latest' 'oldest'# good: [e02439a3d6297a1f5334fa558ddec5ef4212c574] source-hash-6b8393474974d2af7a2cb3c47b3d5c081b550bdbgit bisect good e02439a3d6297a1f5334fa558ddec5ef4212c574# bad: [4850941efe43ae800be5c76e1102ab80ac2c085d] source-hash-980a6e552502f02f12c15bfb1c9f8e6269499f4bgit bisect bad 4850941efe43ae800be5c76e1102ab80ac2c085d# skip: [a043626b542eb8314218d7439534dce2fc325304] source-hash-9379a922c07df3cdb7d567cc88dfaaa39ead3681git bisect skip a043626b542eb8314218d7439534dce2fc325304# skip: [aba65c3e4c0df07e4909aeefb758cdb688242bf6] source-hash-827524abfb4b577d08276fde40929a9adfb7ff1agit bisect skip aba65c3e4c0df07e4909aeefb758cdb688242bf6# skip: [aba65c3e4c0df07e4909aeefb758cdb688242bf6] source-hash-827524abfb4b577d08276fde40929a9adfb7ff1agit bisect skip aba65c3e4c0df07e4909aeefb758cdb688242bf6# bad: [c81a8a0dcfc1ed095a80e4485c89dd0fcaf73f31] source-hash-c69ed33628ec0b7abf6296539cf280d6c4265930git bisect bad c81a8a0dcfc1ed095a80e4485c89dd0fcaf73f31# bad: [c81a8a0dcfc1ed095a80e4485c89dd0fcaf73f31] source-hash-c69ed33628ec0b7abf6296539cf280d6c4265930git bisect bad c81a8a0dcfc1ed095a80e4485c89dd0fcaf73f31# bad: [1d4980621741d3050a5fe61b247c157d769988f2] source-hash-89d01a7d8028ddb765e02c116d202a2435894217git bisect bad 1d4980621741d3050a5fe61b247c157d769988f2# bad: [ba096f438393091574da98fe7b8e6b05182a8971] source-hash-8499e78ca03c792f4fa2650e02b519094ba0baa8git bisect bad ba096f438393091574da98fe7b8e6b05182a8971# good: [9daa289e178460daaafa4b3911031df5b8736218] source-hash-704292996a3731a61339b1a4a5c90c9403aa095fgit bisect good 9daa289e178460daaafa4b3911031df5b8736218# bad: [34eab3946c46bb7273ba4ca395db9c4421dd232f] source-hash-e962805b31074d6b6a2ed0db6452769448337553git bisect bad 34eab3946c46bb7273ba4ca395db9c4421dd232f# bad: [7f958321368b190c941b23cc219d62d0420415af] source-hash-b3f41543851e9985c6c7ba133c32753c9bc732c1git bisect bad 7f958321368b190c941b23cc219d62d0420415af# bad: [7e1458eeba4fb40a796b1318a034410a97b6b24b] source-hash-926275d07184d441b3bfa1ceca26c4c1f2bc61dbgit bisect bad 7e1458eeba4fb40a796b1318a034410a97b6b24b# good: [bb5ad7a1787aa87f172ccc8ed1f5be8374184a8f] source-hash-6bf79576aeca243db553ed3b5eade492dc35337bgit bisect good bb5ad7a1787aa87f172ccc8ed1f5be8374184a8f# good: [f558a584cdbd1eed10f886939a5cc2e86049b08c] source-hash-61db96daa87754af24355d7ac94ee0305f22ff87git bisect good f558a584cdbd1eed10f886939a5cc2e86049b08c# first bad commit: [7e1458eeba4fb40a796b1318a034410a97b6b24b] source-hash-926275d07184d441b3bfa1ceca26c4c1f2bc61dbOn pc Debian x86-64 with master sources updated today, I don't reproduce this.Crashed.5.0 said:soffice.bin: malloc.c:3689: _int_malloc: Assertion `(unsigned long) (size) >= (unsigned long) (nb)' failed.My master is not from today, though..Ubuntu 15.04 64-bit Version: 4.4.2.2Build ID: 40m0(Build:2)Locale: en_USVersion: 5.0.0.0.alpha1+Build ID: 0cd88d27ecd87c8c5791418bcac6ab1684ece74aTinderBox: Linux-rpm_deb-x86_64@46-TDF-dbg, Branch:master, Time: 2015-04-30_00:38:48Locale: en_US.UTF-8This seems to have begun at the below commit.Adding Cc: to; Could you possibly take a look at this one? Thankscommit 92ffe57f6bf40ec0f19e2abed24721137c569063Author: Khaled Hosny <>Date: Sat Jun 15 14:24:21 2013 +0200 Don't shrink text from fallback fonts This code is bogus in multiple ways: * It scales text based on ascent or descent, but this makes no sense as those control line height and nothing else, if one is to scale two different fonts to \u201cfit\u201d together, cap or x height would be more appropriate. This results in some text being ridiculously shrunk. * Not only that, but it is comparing apples to oranges; original font ascent/descent with the bounding box of the fallback glyphs, which results in different scale ratios depending on the shape of the glyphs at hand, which leads to all sorts of funny and irregular text. * Even worse, the PDF export is completely broken in this case; it uses the scaled down glyph widths but the unscaled font size, resulting in cramped unreadable text.That commit is two years old, and I can’t reproduce the crash with my 4.3 installation nor with (a few months old) master build. The crash does not seem to be in a code affected by this commit.stack trace looks like a memory corruptioncan reproduce valgrind and ASAN warnings on masterthis is not a regression, the Thai break iterator was always doing thisfixed on masterMichael Stahl committed a patch related to this issue.It has been pushed to "master":tdf#90809: i18npool: fix crash in Thai break iteratorIt will be available in 5.0.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#90809: i18npool: fix crash in Thai break iteratorIt will be available in 5.0.0.0.beta2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-4-4":tdf#90809: i18npool: fix crash in Thai break iteratorIt will be available in 4.4.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=91064	Steps to reproduce:1. Open any Word Docx with a Chart such asorin a recent 5.0 build of Calc2. Save as Docx3. Open in MS Word4. Repeat Steps 1-3 in build of Calc before 2015-04-23In recent builds, Words says "We're sorry. We can't open 016.docx because we found a problem with its contents. The file is corrupt and cannot be opened."Bad:Version: 5.0.0.0.alpha1+Build ID: 93f0b14458a618ad575cd446680e5c4aa7d87bdcI have to boot into Windows to bisect this bug. Is there a tinderbox that saves Windows builds for more than a few days? Before the windows tinderbox builds faded into the ether, I bisected this down to: Version: 5.0.0.0.alpha1+Build ID: 0ecf20cd185813327613c01bc6cbff9721cef1f1goodVersion: 5.0.0.0.alpha1+Build ID: 393c51cee8bc3de5a2a9f4e04161c59e8712f631badpossible culprit:Miklos what do you think? Also I was testing against MSO 2013.A quick way to reproduce this bug is in Writer1. Create a blank file 2. "save as" DOCX 3. Open in Word 2013Verified this is caused by:Last known good commit:861a86dfca00bc42b57d70621605d5831e6305a5Luke please add an empty document saved as docx from Office 2013. Thank you!Tested this with all the below combinations and MS Word gave an error each time saying that it doesnt understand the version number and could couldnt open it or would repair the file. Seems the AppVersion tag is exclusive to MSO version numbers.5.0.0.0.alpha1$Linux_x86 LibreOffice_project/1aa43709f1eafe76bb5b2c658bf88c16bb73ea4f5.0.0.0.alpha1$Linux_x86 LibreOffice_project5.0.0.0.alpha15.0.05.05.000CreatedEmpty document saved as docx from Office 2013(In reply to Luke from)Indeed, reverting this commit resolves the problemKind regards,JorenJay and Radu,If you don't have an immediate fix for this issue, can you please revert commit 480ca7434a330b2678f9ef287cffd6d9cf27bed5? Markus is in the midst of a major cleanup of the chart OOXML export code, but I have no way of testing if his fixes also also working in MSO.Joren De Cuyper committed a patch related to this issue.It has been pushed to "master":tdf#91064: Revert "tdf#89790 DOCX: saving LO version number in app.xml"It will be available in 5.0.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Patch reverted. It looks like Microsoft only accept it own versions.Nice work though Radu!Kind regards,Joren
id=91096	Tested with master build on OSX1) Start Impress2) Insert > Medi > Video3) Choose MOV file4) Press F5 to start presentationCRASH Works in Version: 4.4.2.2Build ID: c4c7d32d0d49397cad38d62472b0bc8acff48dd6Locale : fr_CreatedPartial btCreatedFull btConfirmed on separate machine with daily buildThe crash occurs irrespective of the content of the slides. CHanged title accordingly.Could be related to tdf#91960 - might be good to check if it's fixed after that; having said that the trace is rather different.Version: 5.1.0.0.alpha1+Build ID: e2281331b1ab40288494ab3659d9c66e13d3e905Locale : fr-FR (fr.UTF-8)Confirming fixed with
id=91025	Whether it be FORMATTING or EDITING the program adds line return characters into the FOOTNOTE and ENDNOTE sections of a longer (at least, greater than 27,000 words) document so that there may be pages of white space inserted between the number and the entry, or the entry and the next number. Opening a 90 page document then can produce thousands of extra pages to then be manually reformatted. This book has to get out. I do not want to have to go out and buy and learn Windows software to make this happen. LibreOffice 4.2Ubuntu 14.14 LTS, 64 bit on both Intel NUK 54250 & Compal laptop FL91 Thanks.Patrick Please give a try to a recent LO version (see).Indeed 4.2 branch is EOL (End Of Life) and 4.3 branch will be very soon.So let's wait for your feedback for the moment.Dear Bug Submitter,This bug has been in NEEDINFO status with no change for at least6 months. Please provide the requested information as soon aspossible and mark the bug as UNCONFIRMED. Due to regular bugtracker maintenance, if the bug is still in NEEDINFO status withno change in 30 days the QA team will close the bug as INVALIDdue to lack of needed information.For more information about our NEEDINFO policy please read thewiki located here:If you have already provided the requested information, pleasemark the bug as UNCONFIRMED so that the QA team knows that thebug is ready to be confirmed. Thank you for helping us make LibreOffice even better for everyone!Warm Regards,QA TeamDear Bug Submitter,Please read this message in its entirety before proceeding.Your bug report is being closed as INVALID due to inactivity anda lack of information which is needed in order to accuratelyreproduce and confirm the problem. We encourage you to retestyour bug against the latest release. If the issue is stillpresent in the latest stable release, we need the followinginformation (please ignore any that you've already provided):a) Provide details of your system including your operating system and the latest version of LibreOffice that you have confirmed the bug to be presentb) Provide easy to reproduce steps – the simpler the betterc) Provide any test case(s) which will help us confirm the problemd) Provide screenshots of the problem if you think it might helpe) Read all comments and provide any requested informationOnce all of this is done, please set the bug back to UNCONFIRMEDand we will attempt to reproduce the issue. Please do not:a) respond via email b) update the version field in the bug or any of the other details on the top section of our bug trackerWarm Regards,QA TeamThis INVALID Message was generated on: 2016-05-09
id=91721	Wile testingon master build OSX, I get a systematic crash when I change a default textbox controlto a listbox control, and then try to access the new control's properties via the context menu.1) Create sample ODB file containing a table with ID, and two VARCHAR fields, populate with some sampe data.2) Create a form via the form creation wizard. Accept the defaults.3) Save the database.4) Open the newly created form in Form design mode, select one of the textbox controls which are bound to VARCHAR and swap it for a listbox (right mouse button, "enter group", right mouse button on textbox control, "replace with" listbox).5) Still keeping the selected control, right mouse button click to activate the multiple selection property of the control.6)Close the properties window7) Save form.8) Attempt to redisplay the fields properties via right mouse button click ==>> CRASHreproducible 100%regression over LO 4432 CreatedFull btVCLPtr shenanigans ?Backtrace without symbols is not usable, so remove keyword.(In reply to Lionel Elie Mamane from)Sorry about that, I'd forgotten that I haven't got a debug build - on OSX --enable-dbgutil has been failing sinceCreatedbt with debug symbolsOn pc Debian x86-64 with master sources updated today, I don't reproduce this exactly.I mean, I don't have a crash after saving the form and opening again the properties.I got a crash after having enabled multiselection on field, saved, at the very moment when I close the form.So perhaps my bt is completely unrelated.Laszlo - can you take a look at this one ? it looks rather like the bindings bits you nailed before; but will take some investigation. I guess one thing to do would be to try to write a unit test to reproduce similar looking scenarios in eg. sfx2/qa/cppunit/test_controlleritem.cxx - which I created the other day. That test shows a double-dispose is just fine; but (somehow) I guess the ID is changing causing this crash.The lame fix is to bail out of ::Release() when nId >= pCaches.size() - but I'd like to understand and have a unit test that shows how and why that happens these days =) but possibly the fix is as simple as that (?) ;-)I guess we are doing:#4 0x00002aaaae92f63a in SfxBindings::Release(SfxControllerItem&) (this=0x2e24b00, rItem=...) at /home/julien/compile-libreoffice/libreoffice/sfx2/source/control/bindings.cxx:1033... from the same 'this' or object ...#15 0x00002aaaae92caee in SfxBindings::~SfxBindings() (this=0x2e24b00, __in_chrg=<optimized out>) at /home/julien/compile-libreoffice/libreoffice/sfx2/source/control/bindings.cxx:291#16 0x00002aaaae92cb90 in SfxBindings::~SfxBindings() (this=0x2e24b00, __in_chrg=<optimized out>) at /home/julien/compile-libreoffice/libreoffice/sfx2/source/control/bindings.cxx:295which perhaps causes the grief. Either way writing a custom SfxControllerItem to provoke that and unit testing it would be great; thanks !László Németh committed a patch related to this issue.It has been pushed to "master":tdf#91721: fix crash during listbox control editing in database formIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.László Németh committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#91721: fix crash during listbox control editing in database formIt will be available in 5.0.0.0.beta4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=91748	CreatedPreview of Special Character is very small. Please make it bigger, bolder and crispierPreview of Special Character is very small. Please make it bigger, bolder and crispier. Works ok in 4.4. Regression.Win 7 Pro 64-bit, Version: 4.4.3.2Build ID: 88805f81e9fe61362df02b9941de8e38a9b5fd16Locale: fi_FIVersion: 5.1.0.0.alpha1+Build ID: bf9c96238e33f63922af35c0c77ceb83ff447d3eTinderBox: Win-x86@39, Branch:master, Time: 2015-05-27_07:04:47Locale: fi-FI (fi_FI)Ubuntu 15.04 64-bit Version: 4.4.2.2Build ID: 40m0(Build:2)Locale: en_USVersion: 5.1.0.0.alpha1+Build ID: be01d68420086fc36ecf26b5f597ba7c6b29b369TinderBox: Linux-rpm_deb-x86_64@46-TDF-dbg, Branch:master, Time: 2015-05-28_03:30:12Locale: en-US (en_US.UTF-8)***has been marked as a duplicate of this bug. ***The dialog is ignoring the document font and rendering the grid with the UI font and size.(In reply to Adolfo Jayme from)confirming on Windows 8.1 withVersion: 5.0.0.0.beta3 (x64)Build ID: 96345c15d8ab19c49014f055fe41ba8e1f421e5cLocale: en-US (en_US)Yes but just the repaint of the canvas is corrupt. The Special Characters dialog is not refreshing the display window to display selected fontset. It seems stuck on Liberation Serif and is painting those mappings.But, the working fontset seems to follow drop down, and is making character picks from the selected font if it has corresponding glyphs defined.So, think function is correct, but the display rendering of the dialog is broken.***has been marked as a duplicate of this bug. ***Tomaž Vajngerl committed a patch related to this issue.It has been pushed to "master":tdf#91748 fix preview of special charactersIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Tomaž Vajngerl committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#91748 fix preview of special charactersIt will be available in 5.0.0.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.CreatedLO50RC1 still has the problem on OSXSorry, but I can still see this in LO50RC1 on OSX.Did you try to select another character - one that is not "space"? :)CreatedAnother proofTomaž, seveda, of course I did.(In reply to miles from)The problem is also still present on Linux x86_64***has been marked as a duplicate of this bug. ***Yeah, only the preview in the right side got fixed, but not the grid.***has been marked as a duplicate of this bug. ***fixed the grid.***has been marked as a duplicate of this bug. ***The grid of gylyps for selected fonts is still not redrawn correctly on drop down selection of font, as in dupeDoesn't seem like any bibisection is required here, so removing bibisectRequestStill affected (experiencing the symptoms described in the several duplications) on Ubuntu 14.04 LTS 64-bit with LibO Version: 5.0.0.5, Build ID: 00m0(Build:5), Locale: en-GB (en_GB.UTF-8).Am looking forward to a fix arriving in my neck of the woods!On Windows 10 Pro 64-bit en-US withVersion: 5.0.3.1 (x64)Build ID: fd8cfc22f7f58033351fcb8a83b92acbadb0749e-GLLocale: en-US (en_US)as well asVersion: 5.1.0.0.alpha1+Build ID: 07bc49b43187ecc691d98eec1b9b129cf92efd70TinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-10-15_22:30:35Locale: en-US (en_US)Residual issues of dupedo seem to be resolved.STR1. Open Writer2. Open Special Character dialog3. select "Liberation Serif" in fontlist dropdown4. navigate to the "Miscellaneous Symbols" on the subset drop down5. select a sharp ♯ (U+266F) grid of glyphs defined in Liberation Serif is rendered, with preview of the ♯6. select "DejaVu Sans" in fonlist dropdown different grid of glyphs as defined in DejaVu Sans is rendered, and ♯ changes7. select "Caldea" in fontlist dropdown (or another font without a glyph for ♯) different grid of glyphs as defined in Caldea is rendered--there is no U+266F glyph defined and the ♯ preview receives a substitution (I can't tell which font or the mechanism of that substitution).But, this all seems to be working correctly now for 5.0.3 and 5.1.0alpha1+ (master). Please test, but closing WFM.=-=p.s. - It might be better if the preview in a case where the glyph is not defined for the font showed a generic "not defined this font" error. But that would be a different issue.(Using Ubuntu 14.04.3 with LO 5.0.2.2)I have to second the P.S. by V. Stuart Foote.Specifically, if a character/glyph is displayed on the right side of the Insert Special Characters dialog, and a different font is then chosen that doesn't contain that character/Unicode block, the "Subset" becomes blank and the previous sample character (in the previous font) remains displayed along with the grid of lower ASCII characters from the new font.Of course, once a valid Subset for the new font is chosen, things correct themselves, but this could be confusing to many users and isn't very elegant. Clearing the sample character display upon any new selection in the Subset OR font before proceeding would seem to be called for.But the regression itself seems to have been corrected.
id=91789	Createdbacktrace1. New Text Document.2. Click on header part of document to get blue popover and click on it.3. Click on blue popover again and Format Header.4. Cancel Page dialogue.5. Exit application.Result:Crash.Or1. New Text Document.2. Right click on document → Page.3. In Header tab, check “Header on” and OK.4. Right click on document → Page.5. Cancel Page dialogue.6. Exit application.Result:Crash.Windows Vista 64Version: 5.1.0.0.alpha1+Build ID: cba920edf88bef06a6689e7847c5789dd3ee67b7TinderBox: Win-x86@39, Branch:master, Time: 2015-06-01_04:22:29 I can confirm crash with Version: 5.1.0.0.alpha1+Build ID: cba920edf88bef06a6689e7847c5789dd3ee67b7TinderBox: Win-x86@39, Branch:master, Time: 2015-06-01_04:22:29***has been marked as a duplicate of this bug. ***1. Format > Page … Header2. Turn Header of or set Same on first and next pages (see duplicate issue)3. OK4. File > Close .. choose Disgard .. Crash***has been marked as a duplicate of this bug. ***# bad: [dda106fd616b7c0b8dc2370f6f1184501b01a49e] source-hash-0db96caf0fcce09b87621c11b584a6d81cc7df86# good: [5b9dd620df316345477f0b6e6c9ed8ada7b6c091] source-hash-2851ce5afd0f37764cbbc2c2a9a63c7adc844311git bisect start 'latest' 'oldest'# good: [0c30a2c797b249d0cd804cb71554946e2276b557] source-hash-45aaec8206182c16025cbcb20651ddbdf558b95dgit bisect good 0c30a2c797b249d0cd804cb71554946e2276b557# bad: [2ce02b2ce56f12b9fcb9efbd380596975a3a5686] source-hash-17d714eef491bda2512ba8012e5b3067ca19a5begit bisect bad 2ce02b2ce56f12b9fcb9efbd380596975a3a5686# bad: [e4deb8a42948865b7b23d447c1547033cb54535b] source-hash-ce46c98dbeb3364684843daa5b269c74fce2af64git bisect bad e4deb8a42948865b7b23d447c1547033cb54535b# good: [15e8b5cc6b4784fecd63b2a5a04ac086b3e9fc01] source-hash-26b500afcaed704db7a300836f466517c309ee77git bisect good 15e8b5cc6b4784fecd63b2a5a04ac086b3e9fc01# bad: [73235831b07a9812413e0b0f5d0ba24b89206933] source-hash-6934ad423afd43d4d5c3788d0c020164309aaffagit bisect bad 73235831b07a9812413e0b0f5d0ba24b89206933# good: [dfc554b5db5524f4a3c4b0c9c74fceffb4b72308] source-hash-d4267231754c1e6b03c7723a6fecc46750e7c780git bisect good dfc554b5db5524f4a3c4b0c9c74fceffb4b72308# bad: [ef2fab55f93993a74ca27fddb3a18cf9164a1932] source-hash-144ab285566afa18790356b5497573290ee710bfgit bisect bad ef2fab55f93993a74ca27fddb3a18cf9164a1932# bad: [43807575eac7b39e7d7b33113ecf26060bc93ca5] source-hash-bf56e080cc092cacc779add9dfc7e7df291eef41git bisect bad 43807575eac7b39e7d7b33113ecf26060bc93ca5# good: [0c92c0589cce2ec956b2a8a44cd6fcc12853262d] source-hash-29492f2901ba80aba5da35a4b1780b14ff090878git bisect good 0c92c0589cce2ec956b2a8a44cd6fcc12853262d# bad: [68f4758bd5ec36ed8753b0f12098d34d37d52ca5] source-hash-5229726b4d4e7d76f410d221f8f8cd8abcfd5a19git bisect bad 68f4758bd5ec36ed8753b0f12098d34d37d52ca5# bad: [41e8b42d520cb2aa2dcff3bf3a87b0bcadada6b5] source-hash-f7424ed710e54bb2437a28380b03ed7c26290edcgit bisect bad 41e8b42d520cb2aa2dcff3bf3a87b0bcadada6b5# good: [1568d523eb6569db6206e9d633f2c352e2105b1d] source-hash-a21948bddfefa8554fb2d468616ec1bfda128e9dgit bisect good 1568d523eb6569db6206e9d633f2c352e2105b1d# good: [fae0e8583cf7a430582973a2209cbd27a98321df] source-hash-e3167924fd28c8b854f23139dbf49f53e6282ef7git bisect good fae0e8583cf7a430582973a2209cbd27a98321df# first bad commit: [41e8b42d520cb2aa2dcff3bf3a87b0bcadada6b5] source-hash-f7424ed710e54bb2437a28380b03ed7c26290edcThus seems to be caused by:commit f7424ed710e54bb2437a28380b03ed7c26290edcAuthor: Zolnai Tamás <>Date: Sun Mar 15 13:29:53 2015 +0100 SfxTabDialog: avoid changing const input parameter * SfxTabDialog constructor has a const pointer parameter pointing to the input set and also the corresponding member is a const pointer which indicated that set is not changed by the dialog, but this is not true, const is casted away and the input set is changed. * So use a copy of the input set instead, pointed by a non-const member, so we can spare some const cast and misunderstandings. * GetRefreshedSet not behaves as a getter method, but changes the input set instead, so redeclare it accordingly. Change-Id: Ic63f9ae68c50e65d4498b20f597547c1c075b94eNot reproducable on todays master with gtk3 backend.Crashes with a the 5.1 debug bibisect repo through the whole range though:0x00007ffff334a2d2 in std::_Hashtable<SfxPoolItem*, std::pair<SfxPoolItem* const, unsigned int>, std::allocator<SfxPoolItem*>, std::__detail::_Select1st, std::equal_to<SfxPoolItem*>, std::hash<SfxPoolItem*>, std::__detail::_Mod_range_hashing, std::__detail::_Default_ranged_hash, std::__detail::_Prime_rehash_policy, std::__detail::_Hashtable_traits<false, false, true> >::_M_bucket_index(SfxPoolItem* const&, unsigned long) const () from /home/bjoern/bibisect/lo-linux-dbgutil-daily/opt/program/libsvllo.so(gdb) bt#0 0x00007ffff334a2d2 in std::_Hashtable<SfxPoolItem*, std::pair<SfxPoolItem* const, unsigned int>, std::allocator<SfxPoolItem*>, std::__detail::_Select1st, std::equal_to<SfxPoolItem*>, std::hash<SfxPoolItem*>, std::__detail::_Mod_range_hashing, std::__detail::_Default_ranged_hash, std::__detail::_Prime_rehash_policy, std::__detail::_Hashtable_traits<false, false, true> >::_M_bucket_index(SfxPoolItem* const&, unsigned long) const () from /home/bjoern/bibisect/lo-linux-dbgutil-daily/opt/program/libsvllo.so#1 0x00007ffff3347602 in std::_Hashtable<SfxPoolItem*, std::pair<SfxPoolItem* const, unsigned int>, std::allocator<SfxPoolItem*>, std::__detail::_Select1st, std::equal_to<SfxPoolItem*>, std::hash<SfxPoolItem*>, std::__detail::_Mod_range_hashing, std::__detail::_Default_ranged_hash, std::__detail::_Prime_rehash_policy, std::__detail::_Hashtable_traits<false, false, true> >::find(SfxPoolItem* const&) () from /home/bjoern/bibisect/lo-linux-dbgutil-daily/opt/program/libsvllo.so#2 0x00007ffff3344957 in std::__cxx1998::unordered_map<SfxPoolItem*, unsigned int, std::hash<SfxPoolItem*>, std::equal_to<SfxPoolItem*>, std::allocator<SfxPoolItem*> >::find(SfxPoolItem* const&) () from /home/bjoern/bibisect/lo-linux-dbgutil-daily/opt/program/libsvllo.so#3 0x00007ffff33412ad in std::__debug::unordered_map<SfxPoolItem*, unsigned int, std::hash<SfxPoolItem*>, std::equal_to<SfxPoolItem*>, std::allocator<SfxPoolItem*> >::find(SfxPoolItem* const&) () from /home/bjoern/bibisect/lo-linux-dbgutil-daily/opt/program/libsvllo.so#4 0x00007ffff333d014 in SfxItemPool::Remove(SfxPoolItem const&) () from /home/bjoern/bibisect/lo-linux-dbgutil-daily/opt/program/libsvllo.so#5 0x00007ffff3363d5f in SfxItemSet::~SfxItemSet() () from /home/bjoern/bibisect/lo-linux-dbgutil-daily/opt/program/libsvllo.so#6 0x00007fffb29dd8fc in SwAttrSet::~SwAttrSet() () from /home/bjoern/bibisect/lo-linux-dbgutil-daily/opt/program/../program/libswlo.so#7 0x00007fffb29da7c5 in SwFmt::~SwFmt() () from /home/bjoern/bibisect/lo-linux-dbgutil-daily/opt/program/../program/libswlo.so#8 0x00007fffb2e0be55 in SwFrmFmt::~SwFrmFmt() () from /home/bjoern/bibisect/lo-linux-dbgutil-daily/opt/program/../program/libswlo.so#9 0x00007fffb2e0be8a in SwFrmFmt::~SwFrmFmt() () from /home/bjoern/bibisect/lo-linux-dbgutil-daily/opt/program/../program/libswlo.so#10 0x00007fffb2e027ba in ?? () from /home/bjoern/bibisect/lo-linux-dbgutil-daily/opt/program/../program/libswlo.so#11 0x00007fffb2e03c57 in SwFmtHeader::~SwFmtHeader() () from /home/bjoern/bibisect/lo-linux-dbgutil-daily/opt/program/../program/libswlo.so#12 0x00007fffb2e03cac in SwFmtHeader::~SwFmtHeader() () from /home/bjoern/bibisect/lo-linux-dbgutil-daily/opt/program/../program/libswlo.so#13 0x00007ffff333b5db in SfxItemPool::Delete() () from /home/bjoern/bibisect/lo-linux-dbgutil-daily/opt/program/libsvllo.so#14 0x00007ffff333a668 in SfxItemPool::~SfxItemPool() () from /home/bjoern/bibisect/lo-linux-dbgutil-daily/opt/program/libsvllo.so#15 0x00007fffb29deece in ?? () from /home/bjoern/bibisect/lo-linux-dbgutil-daily/opt/program/../program/libswlo.so#16 0x00007fffb29deefe in ?? () from /home/bjoern/bibisect/lo-linux-dbgutil-daily/opt/program/../program/libswlo.so#17 0x00007ffff333a94a in SfxItemPool::Free(SfxItemPool*) () from /home/bjoern/bibisect/lo-linux-dbgutil-daily/opt/program/libsvllo.so#18 0x00007fffb2b4bb68 in SwDoc::~SwDoc() () from /home/bjoern/bibisect/lo-linux-dbgutil-daily/opt/program/../program/libswlo.so#19 0x00007fffb2b4bea8 in SwDoc::~SwDoc() ()Just reproduced the crash on RHEL 6.7 64-bit LibreOffice 5.0.2.2 with the steps defined on the original bug report.Tested with current master on Linux and Windows, where it works.If you want to verify this bug, please use master newer than 1/12/2015.Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=91880	Was trying to define a degraded fill style from Yellow to Yellow 10, Angle 30°, Border: 60%Crash when appliedwarn:legacy.osl:4227:1:/home/philippe/src/git-repo/libreoffice/master/basegfx/source/polygon/b2dtrapezoid.cxx:655: Trapezoid decomposer in illegal state (!)warn:legacy.osl:4227:1:/home/philippe/src/git-repo/libreoffice/master/basegfx/source/polygon/b2dtrapezoid.cxx:655: Trapezoid decomposer in illegal state (!)warn:legacy.osl:4227:1:/home/philippe/src/git-repo/libreoffice/master/basegfx/source/polygon/b2dtrapezoid.cxx:655: Trapezoid decomposer in illegal state (!)warn:legacy.osl:4227:1:/home/philippe/src/git-repo/libreoffice/master/basegfx/source/polygon/b2dtrapezoid.cxx:655: Trapezoid decomposer in illegal state (!)warn:legacy.osl:4227:1:/home/philippe/src/git-repo/libreoffice/master/basegfx/source/polygon/b2dtrapezoid.cxx:655: Trapezoid decomposer in illegal state (!) #0 0x00007fffe20fb960 in gdk_x11_screen_get_screen_number () from /usr/lib/x86_64-linux-gnu/libgdk-x11-2.0.so.0#1 0x00007fffe34cfacf in GtkSalGraphics::GtkSalGraphics (this=0x1df1330, pFrame=0x0, pWindow=0x103e140) at /home/philippe/src/lodev/master/vcl/unx/gtk/gdi/salnativewidgets-gtk.cxx:69#2 0x00007fffe34c87c0 in GtkInstance::CreateVirtualDevice (this=0x607200, pG=0x2a32a60, nDX=@0x7fffffffb958: 869, nDY=@0x7fffffffb960: 56, nBitCount=24, pGd=0x0) at /home/philippe/src/git-repo/libreoffice/master/vcl/unx/gtk/app/gtkinst.cxx:327#3 0x00007ffff201b288 in VirtualDevice::InnerImplSetOutputSizePixel ( this=0x2a34900, rNewSize=..., bErase=false, pBuffer=..., bTopDown=false) at /home/philippe/src/git-repo/libreoffice/master/vcl/source/gdi/virdev.cxx:339#4 0x00007ffff201b605 in VirtualDevice::ImplSetOutputSizePixel ( this=0x2a34900, rNewSize=..., bErase=false, pBuffer=..., bTopDown=false) at /home/philippe/src/git-repo/libreoffice/master/vcl/source/gdi/virdev.cxx:396#5 0x00007ffff201b92e in VirtualDevice::SetOutputSizePixel (this=0x2a34900, rNewSize=..., bErase=false) at /home/philippe/src/git-repo/libreoffice/master/vcl/source/gdi/virdev.cxx:444#6 0x00007fffefe5d6e7 in (anonymous namespace)::VDevBuffer::alloc(OutputDevice&, Size const&, bool, int) () from /home/philippe/src/lodev/master/instdir/program/libdrawinglayerlo.so#7 0x00007fffefe5d96a in drawinglayer::impBufferDevice::impBufferDevice(OutputDevice&, basegfx::B2DRange const&, bool) () from /home/philippe/src/lodev/master/instdir/program/libdrawinglayerlo.so#8 0x00007fffefe7075c in drawinglayer::processor2d::VclProcessor2D::RenderMaskPrimitive2DPixel(drawinglayer::primitive2d::MaskPrimitive2D const&) () from /home/philippe/src/lodev/master/instdir/program/libdrawinglayerlo.so#9 0x00007fffefe6e7fb in drawinglayer::processor2d::VclPixelProcessor2D::processBasePrimitive2D(drawinglayer::primitive2d::BasePrimitive2D const&) () from /home/philippe/src/lodev/master/instdir/program/libdrawinglayerlo.so#10 0x00007fffefe57d95 in drawinglayer::processor2d::BaseProcessor2D::process(com::sun::star::uno::Sequence<com::sun::star::uno::Reference<com::sun::star::graphic::XPrimitive2D> > const&) () from /home/philippe/src/lodev/master/instdir/program/libdrawinglayerlo.so#11 0x00007fffefe6ecc1 in drawinglayer::processor2d::VclPixelProcessor2D::processBasePrimitive2D(drawinglayer::primitive2d::BasePrimitive2D const&) () from /home/philippe/src/lodev/master/instdir/program/libdrawinglayerlo.so#12 0x00007fffefe57d95 in drawinglayer::processor2d::BaseProcessor2D::process(com::sun::star::uno::Sequence<com::sun::star::uno::Reference<com::sun::star::graphic::XPrimitive2D> > const&) () from /home/philippe/src/lodev/master/instdir/program/libdrawinglayerlo.so#13 0x00007fffefe6ecc1 in drawinglayer::processor2d::VclPixelProcessor2D::processBasePrimitive2D(drawinglayer::primitive2d::BasePrimitive2D const&) () from /home/philippe/src/lodev/master/instdir/program/libdrawinglayerlo.so#14 0x00007fffefe57d95 in drawinglayer::processor2d::BaseProcessor2D::process(com::sun::star::uno::Sequence<com::sun::star::uno::Reference<com::sun::star::graphic::XPrimitive2D> > const&) () from /home/philippe/src/lodev/master/instdir/program/libdrawinglayerlo.so#15 0x00007fffefe6ecc1 in drawinglayer::processor2d::VclPixelProcessor2D::processBasePrimitive2D(drawinglayer::primitive2d::BasePrimitive2D const&) () from /home/philippe/src/lodev/master/instdir/program/libdrawinglayerlo.so#16 0x00007fffefe57d95 in drawinglayer::processor2d::BaseProcessor2D::process(com::sun::star::uno::Sequence<com::sun::star::uno::Reference<com::sun::star::graphic::XPrimitive2D> > const&) () from /home/philippe/src/lodev/master/instdir/program/libdrawinglayerlo.so#17 0x00007fffc91cba31 in sdr::contact::ObjectContactOfPageView::DoProcessDisplay (this=0x1e64830, rDisplayInfo=...) at /home/philippe/src/git-repo/libreoffice/master/svx/source/sdr/contact/objectcontactofpageview.cxx:301#18 0x00007fffc91cb137 in sdr::contact::ObjectContactOfPageView::ProcessDisplay (this=0x1e64830, rDisplayInfo=...) at /home/philippe/src/git-repo/libreoffice/master/svx/source/sdr/contact/objectcontactofpageview.cxx:122#19 0x00007fffc920dd28 in SdrPageWindow::RedrawAll (this=0x1e816e0,Missed this:(soffice:5989): Gtk-CRITICAL **: IA__gtk_widget_get_screen: assertion 'GTK_IS_WIDGET (widget)' failed(In reply to Philippe Jung from)Reproduced. Somehow it tried to change Yellow 10 to Pale yellow when adding the gradient, but I noticed it and modified properly..Ubuntu 15.04 64-bit Version: 5.1.0.0.alpha1+Build ID: 0d754a386fb44f970f33a3e71b2f0f3cfb7c4598TinderBox: Linux-rpm_deb-x86_64@46-TDF-dbg, Branch:master, Time: 2015-06-09_16:20:41Locale: en-US (en_US.UTF-8)***has been marked as a duplicate of this bug. ***Changing priority as this is basic functionality of applying a gradient on a slide.I can't reproduce this crash. There was some ping-pong between kendy and markus in that method recently, so perhaps it was fixed by them by that, can I get a re-test or a precise set of how-to-reproduce1. New Impress document2. Right-click title object, Area3. Gradients-tab, Add new gradient: Yellow to Yellow 10, Angle 30°, Border: 60%4. After adding, change Pale yellow back to Yellow 10, click modify5. Area-tab, Fill: Gradient, select newly created gradient6. Ok, crashDoesn't crash on Windows.Win 7 Pro 64-bit Version: 5.1.0.0.alpha1+Build ID: 80ec99db4325a439a8a3f1d420d0a80f8bf9c439TinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-06-16_00:00:20Locale: fi-FI (fi_FI)Ubuntu 15.04 64-bit Version: 5.1.0.0.alpha1+Build ID: 9ef671364ff9fbb552a5433053af9283d12d90c7TinderBox: Linux-rpm_deb-x86_64@46-TDF-dbg, Branch:master, Time: 2015-06-16_08:38:45Locale: en-US (en_US.UTF-8)Thanks, I can reproduce this nowCaolán McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: tdf#91880 Invalidate graphics when the gtk window is destroyedIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-5-0":Resolves: tdf#91880 Invalidate graphics when the gtk window is destroyedIt will be available in 5.0.0.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.I think the above solves this. I find it hard to reproduce reliably but the above seems to fix it. Give it a good bashing.Now with 100% less crashing.Ubuntu 15.04 64-bit Version: 5.1.0.0.alpha1+Build ID: fb6dd2a73074b9695bd8ddf7ba40f1819b03024eTinderBox: Linux-rpm_deb-x86_64@46-TDF-dbg, Branch:master, Time: 2015-06-17_23:54:33Locale: en-US (en_US.UTF-8)
id=91917	With the last commits in the branch 5.0 clicking somewhere in the text does not move the cursor there. It works only if you make a selection.Steps to reproduce:1/ open a new empty text document in Writer2/ type DT+F3 (autotext for dummy text) or something else long enough==> the cursor is at the beginning of the text.3/ click somewhere, for example in lines 4 or 5==> the cursor does not move4/ do a selection: click+drag then click ==> the cursor is moved at the end of the selection.Tested with a new user profile.Version: 5.0.0.0.beta1+Build ID: 9b345e42d24b06a2b508e567e9ac0e361c3a576dUbuntu_15.04_x86-64Locale: fr-FR (fr_FR.UTF-8)Best regards. JBF Worked one day ago ==> regressionWorks as expected if I go back to this commit:Version: 5.0.0.0.beta1+Build ID: 1b3d17ba7cd45dc0431b9b1809d908a7a066d9a1Ubuntu_15.04_x86-64Locale: fr-FR (fr_FR.UTF-8)Best regards. JBFWell, the problem is in this commit:author Michael Stahl <> Fri, 5 Jun 2015 23:56:07 +0200 (23:56 +0200)committer Michael Stahl <> Sat, 6 Jun 2015 00:35:56 +0200 (00:35 +0200)SwCrsrShell::UpdateCrsr() calls SwTextFrm::GetCharRect(), which doeslayout. It happens that a SdrObject is moved around during layout,which calls SwDrawContact::Changed(), which believes that there isno layout active because there is no SwLayAction andViewShell::EndAction() has already been called, so we get recursivelayout-in-layout action.Change-Id: Iad8df4910e3c661150bdf5ac7d777792e69a8f71(cherry picked from commit 587006cac508616f486aea45e265a170bcccdc87)Works as expected until the previous commit:Build ID: 4d8acde1b820c2548839b1632bc28f2988001941Best regards. JBFAdditionally: the Enter key create a new paragraph (visible if you show the non printable characters) but does not move the cursor in front of this new paragraph.That make working with this build of LO-Writer not possible. So increasing the severity. ==> blocker.Best regards. JBFConfirmed.Win 7 Pro 64-bit Version: 5.1.0.0.alpha1+Build ID: be8512f99bc9ab18e55aabe01cc0ab1e6baea9e6TinderBox: Win-x86@39, Branch:master, Time: 2015-06-08_05:58:40Locale: fi-FI (fi_FI)Ubuntu 15.04 64-bit Version: 5.1.0.0.alpha1+Build ID: 47cddc662efc470505f0b76427fa3092bae5550aTinderBox: Linux-rpm_deb-x86_64@46-TDF-dbg, Branch:master, Time: 2015-06-07_00:54:53Locale: en-US (en_US.UTF-8)osx 10.10.3 latest nightly from today confirmed. OS → allthis is a blocker.-> summary adapted.Best regards. JBFoops, fixed on masterMichael Stahl committed a patch related to this issue.It has been pushed to "master":tdf#91917 tdf#91602: avoid layout recursion differentlyIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#91917 tdf#91602: avoid layout recursion differentlyIt will be available in 5.0.0.0.beta3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Thank you very much !Verified fixed in Version: 5.0.0.0.beta2+Build ID: 45e1b4cad938a8ac1c865df527dcc536d4c80920Ubuntu_15.04_x86-64Locale: fr-FR (fr_FR.UTF-8)built at home.Best regards. JBFProblem is gone now.Win 7 Pro 64-bit Version: 5.1.0.0.alpha1+Build ID: d28102b1ed0c31500bbc68453a7b7613bd2bfa06TinderBox: Win-x86@39, Branch:master, Time: 2015-06-09_01:06:39Locale: fi-FI (fi_FI)fixed on osx as well. Thanks.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***
id=92074	CreatedbacktraceI dont know the exact steps that cause this, but this has happened to me twice in the last hour when applying a gradient to a slide master in Impress.Version: 5.1.0.0.alpha1+Build ID: 3754474cdea72ebe7f09457ef82a5c3131d06b78TinderBox: Linux-rpm_deb-x86@45-TDF, Branch:master, Time: 2015-06-13_07:55:37 *** This bug has been marked as a duplicate of***
id=92094	CreatedbacktraceWas working in impress and pressing on a textbox and then jumping into edit mode and then out of edit mode and messing with the formatting and it crashed. Hopefully the crash report tells why.Version: 5.1.0.0.alpha1+Build ID: 3754474cdea72ebe7f09457ef82a5c3131d06b78TinderBox: Linux-rpm_deb-x86@45-TDF, Branch:master, Time: 2015-06-13_07:55:37 Candidate for VclPtrSame backtrace asand commit id is from before that crash, so I believe this is a duplicate of that fixed issue*** This bug has been marked as a duplicate of***
id=92148	Note: I spotted this bug in 5 Beta1, but it's still present in 5 Beta3 for me.When Math is started or a Math formula is inserted anywhere else, a sidebar appears on the left. I thought it takes up too much space and tried to undock or remove it, which didn't work, so I resized it to "very thin".LibreOffice then locked up, with the icons in said sidebar constantly flickering.What's worse is that LOffice REMEMBERS this resize after forced shutdown, so any future attempts to open Math result in an instantly locked up window. It happened at least acouple of times that the repainting of the leftpanel of the Draw window made my entire desktop unresponsive. Onlythrough a text console was I able to end LibreOffice. Hence I amassigning severity CRITICAL.The problem is still apparent in the daily dbgutil bibisect repositoryversion 2015-06-19.Working in the 50max bibisect repository, I see from `git bisect good` ... There are only 'skip'ped commits left to test. The first bad commit could be any of: 891b689ba95b9e53609194ee2a1a2d3b8955843c 18afb8632caa524fbc70ed5ce3808e23e5dad16f We cannot bisect more!and from `git bisect log` ... # bad: [dda106fd616b7c0b8dc2370f6f1184501b01a49e] source-hash-0db96caf0fcce09b87621c11b584a6d81cc7df86 # good: [5b9dd620df316345477f0b6e6c9ed8ada7b6c091] source-hash-2851ce5afd0f37764cbbc2c2a9a63c7adc844311 git bisect start 'latest' 'oldest' # good: [0c30a2c797b249d0cd804cb71554946e2276b557] source-hash-45aaec8206182c16025cbcb20651ddbdf558b95d git bisect good 0c30a2c797b249d0cd804cb71554946e2276b557 # bad: [2ce02b2ce56f12b9fcb9efbd380596975a3a5686] source-hash-17d714eef491bda2512ba8012e5b3067ca19a5be git bisect bad 2ce02b2ce56f12b9fcb9efbd380596975a3a5686 # bad: [e4deb8a42948865b7b23d447c1547033cb54535b] source-hash-ce46c98dbeb3364684843daa5b269c74fce2af64 git bisect bad e4deb8a42948865b7b23d447c1547033cb54535b # bad: [15e8b5cc6b4784fecd63b2a5a04ac086b3e9fc01] source-hash-26b500afcaed704db7a300836f466517c309ee77 git bisect bad 15e8b5cc6b4784fecd63b2a5a04ac086b3e9fc01 # bad: [534715525a93b0d7d56ba123d253c927cccf0afe] source-hash-40c9a46b78b8919aae82dd9b94774d63bb9cb4e6 git bisect bad 534715525a93b0d7d56ba123d253c927cccf0afe # good: [c255ade961c9628f72d2fbca268fdf3a4e5f60c2] source-hash-4bdbea5447f36beb9cc33df173a89a49a9918290 git bisect good c255ade961c9628f72d2fbca268fdf3a4e5f60c2 # good: [2b4739cd51404149b1279b86643f1fee719de667] source-hash-8ee20e2691aa6f67c67d40c61a8cd1569458b5a8 git bisect good 2b4739cd51404149b1279b86643f1fee719de667 # good: [9891e7d487540e4650378e546aea5025876d02cf] source-hash-b2f76e0e8a81b456f47b677cd881cc105f781cdb git bisect good 9891e7d487540e4650378e546aea5025876d02cf # skip: [891b689ba95b9e53609194ee2a1a2d3b8955843c] source-hash-01f406bc28f53acc5a2734af637aa8074a5d1813 git bisect skip 891b689ba95b9e53609194ee2a1a2d3b8955843c # good: [4484ce03daa4db83ee9ce6e54396d6f1a0ddcb2a] source-hash-6a3c5af4eb96d03110fcbc856c6920bfcf4063c7 git bisect good 4484ce03daa4db83ee9ce6e54396d6f1a0ddcb2a # bad: [18afb8632caa524fbc70ed5ce3808e23e5dad16f] source-hash-d05a64df34fd143670cb939b72abfb32d6b714c7 git bisect bad 18afb8632caa524fbc70ed5ce3808e23e5dad16f # good: [b02369ea724c86023b074987f04fd60f956c4618] source-hash-4cd7b4ab8aeaf61f5e30e4b63e039b7bb9519e85 git bisect good b02369ea724c86023b074987f04fd60f956c4618 # good: [b52e9a820cbacc502e51aeae755415ea1ac8994a] source-hash-100c518e980f6abdc93c727c524b738200236bf2 git bisect good b52e9a820cbacc502e51aeae755415ea1ac8994a # good: [cfa6015c1d535c8e22bef6a6abb9363c757693d1] source-hash-9e678c14e4fc8e58b1e0530744f648fa3958d338 git bisect good cfa6015c1d535c8e22bef6a6abb9363c757693d1 # only skipped commits left to test # possible first bad commit: [18afb8632caa524fbc70ed5ce3808e23e5dad16f] source-hash-d05a64df34fd143670cb939b72abfb32d6b714c7 # possible first bad commit: [891b689ba95b9e53609194ee2a1a2d3b8955843c] source-hash-01f406bc28f53acc5a2734af637aa8074a5d1813Note commit message ... commit d05a64df34fd143670cb939b72abfb32d6b714c7 Author: Tobias Madl <> Date: Fri Mar 6 14:48:18 2015 +0100 Timer/Idle: adapted inherited funktions Change-Id: I7714a4638b03d020820b276028c0819ef054fa26Any workaround for this? LibreOffice remembers this configuration, making Math totally unusable, even after apt purge and reinstall...Tobias,Can you help us out with this bug? Can you suggest who I should goto?Seeing that the problem persists across executions of LibreOffice andthat it has the potential to lock up the entire desktop, I think itdeserves early attention.J,I am pretty sure that resetting your user profile will let you useMath again.If you are willing to muck around in your user profile with a texteditor, this might work for you. I made the "persists acrossexecutions of LibreOffice" go away by finding this inuser/registrymodifications.xcu ... <item oor:path="/org.openoffice.Office.Views/Windows"> <node oor:name="smath/30382" oor:op="replace"> <prop oor:name="Visible" oor:op="fuse"> <value xsi:nil="true"/> </prop> <node oor:name="UserData"> <prop oor:name="Data" oor:op="fuse" oor:type="xs:string"> <value>V2,V,0,AL:(4,16,0/0/20/0,20;574)</value>All this and more was on one line; I have broken it up here forreadability. I changed the last bit of that to <value>V2,V,0,AL:(4,16,0/0/300/0,300;0)</value>HTH,Terry.Seeing that the problem persists across executions of LibreOffice andthat it has the potential to lock up the entire desktop, I am settingseverity HIGHEST.Hello Terrence,Atm i'm pretty busy by doing my exams. But maybe Juergen Funk () can have a look over this. I passed my current work on to him, until i get more time again. I'm very sorry for this right now.But on the first look and problems till now it is a task which isn't executed any more. Maybe this could help.regards TobiSetting component = Formula Editor.Jonas,Can you help us out on this bug report? I see it as fairly urgent:5.0.0 RC3 is scheduled within a week.I shall also send an email to.Tobias,Thank you for your help. Having added you to the cc, I am leaving itto you to remove yourself if you are so inclined.Terry.Hi Terrence,at the moment i am very busy too, but i try to look asap.I have me add to ccHello J, Terrence, *,I can confirm this bug with LOVersion: 5.0.0.3Build-ID: f79b5ba13f5e6cbad23f8038060e556217e66632Gebietsschema: de-DE (de_DE.UTF-8)(parallel installed, following the instructions from, and with Germanophone lang- as well as helppack) on Debian Testing AMD64,LOVersion: 5.0.1.0.0+Build ID: b0153639c17d40061480a7bbde11fa0249e3051fTinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:libreoffice-5-0, Time: 2015-07-14_03:50:43Locale: de-DE (de_DE.UTF-8)(also parallel installed)andVersion: 5.1.0.0.alpha1+Build ID: 9be553f4c61f220ebbe212dc76cb9cce4ae1c106TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2015-07-13_22:45:19Locale: de-DE (de_DE.UTF-8)(see above ... ;) )All leads to a hang ... :( @Terrence: Is it not easier to rename the user directory instead of editing an XML file? BTW: What does this "V2,2... value do? I have tried it, but other than resizing the sidebar, it still hangs ... :(HTH and HANDThomas.@thackertYes, it is easier to rename-away the user directory. That, of course,discards any other customizations that the user has made.By "still hangs" do you mean right away or after you again reduce thesize of the sidebar? I see the latter problem.Terry.Caolán McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: tdf#92148 SmElementsControl invalidates itself from paint endlesslyIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-5-0":Resolves: tdf#92148 SmElementsControl invalidates itself from paint endlesslyIt will be available in 5.0.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.I see the problem fixed in daily dbgutil bibisect repo, version2015-07-23, source hash e92a8b9.Thnks you, Caolán.@J : When you see the fix for yourself, please advance the bug statusto VERIFIED.Just checked, it's solved.Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=92166	CreatedbacktraceSteps:1) Open Writer Web2) Add some text3) Activate html source view and save html4) Deactivate html source view5) Click in the interface6) CrashVersion: 5.1.0.0.alpha1+Build ID: 9ef671364ff9fbb552a5433053af9283d12d90c7TinderBox: Linux-rpm_deb-x86@45-TDF, Branch:master, Time: 2015-06-16_08:47:30 Reproduced crash.Win 7 Pro 64-bit Version: 5.1.0.0.alpha1+Build ID: 437210d58f32177ef1829d704f7f4d2f1bbfbfddTinderBox: Win-x86@39, Branch:master, Time: 2015-06-18_07:21:56Locale: fi-FI (fi_FI)Createdconsole+bt with debug symbolsOn pc Debian x86-64 with master sources updated yesterday, I could reproduce this.I attached console logs and btThanks - looks like a post-dispose silly =)Nailed this, and another issue wrt. bogusly switching back to the source view related to a missing dispose. Just queued up in the CI:Thanks !Michael Meeks committed a patch related to this issue.It has been pushed to "master":tdf#92166 - dispose the SwSrcEditWindow properly.It will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Meeks committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#92166 - dispose the SwSrcEditWindow properly.It will be available in 5.0.0.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=92304	I am trying to compile libreoffice 5.1.0.0 on ubuntu 15.04in the begining , I got error could not find function krb5_sendauth.upon using option --without-krb5this error gone but another error appears ascould not find function 'gss_init_sec_context' required for GSSAPI Did you do all these before starting to compile:Get the dependencies:sudo apt-get build-dep libreofficeIf you get configure: error: could not find function 'krb5_sendauth' required for Kerberos 5, because of lp#1366631 you need to:sudo apt install libkrb5-devDear Bug Submitter,This bug has been in NEEDINFO status with no change for at least6 months. Please provide the requested information as soon aspossible and mark the bug as UNCONFIRMED. Due to regular bugtracker maintenance, if the bug is still in NEEDINFO status withno change in 30 days the QA team will close the bug as INVALIDdue to lack of needed information.For more information about our NEEDINFO policy please read thewiki located here:If you have already provided the requested information, pleasemark the bug as UNCONFIRMED so that the QA team knows that thebug is ready to be confirmed. Thank you for helping us make LibreOffice even better for everyone!Warm Regards,QA TeamDear Bug Submitter,Please read this message in its entirety before proceeding.Your bug report is being closed as INVALID due to inactivity anda lack of information which is needed in order to accuratelyreproduce and confirm the problem. We encourage you to retestyour bug against the latest release. If the issue is stillpresent in the latest stable release, we need the followinginformation (please ignore any that you've already provided):a) Provide details of your system including your operating system and the latest version of LibreOffice that you have confirmed the bug to be presentb) Provide easy to reproduce steps – the simpler the betterc) Provide any test case(s) which will help us confirm the problemd) Provide screenshots of the problem if you think it might helpe) Read all comments and provide any requested informationOnce all of this is done, please set the bug back to UNCONFIRMEDand we will attempt to reproduce the issue. Please do not:a) respond via email b) update the version field in the bug or any of the other details on the top section of our bug trackerWarm Regards,QA TeamThis INVALID Message was generated on: 2016-05-09
id=92213	CreatedbacktraceSteps:1) Open Impress2) Draw shape3) right-click > Area4) Select bitmap tab5) Select water6) Press okay to close dialog7) CrashRegression as this doesnt happen in 4.4 daily.Version: 5.1.0.0.alpha1+Build ID: 3ecef8cedb215e49237a11607197edc91639bfcdTinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2015-06-20_01:01:56 No repro.Win 7 Pro 64-bit Version: 5.1.0.0.alpha1+Build ID: 3ecef8cedb215e49237a11607197edc91639bfcdTinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-06-19_23:16:58Locale: fi-FI (fi_FI)Ubuntu 15.04 64-bit Version: 5.1.0.0.alpha1+Build ID: 3ecef8cedb215e49237a11607197edc91639bfcdTinderBox: Linux-rpm_deb-x86_64@46-TDF-dbg, Branch:master, Time: 2015-06-20_00:06:19Locale: en-US (en_US.UTF-8)Can't reproduce a crash; but I do get at:(soffice:30646): Gdk-WARNING **: gdkdrawable-x11.c:952 drawable is not a pixmap or windowwhich may be related.Createdtrace from a glogv breakpoint and a bit of debugging.Odd indeed; I guess something is uninitialized, already released or otherwise unexpected in the VirtualDevice's mpGraphics =)#5 0x00007ffff0d1f893 in VirtualDevice::InnerImplSetOutputSizePixel (this=0x24982e0, rNewSize=Size = {...}, bErase=false, pBuffer=..., bTopDown=false) at /data/opt/libreoffice/master/vcl/source/gdi/virdev.cxx:339339 pNewVirDev = pSVData->mpDefInst->CreateVirtualDevice( mpGraphics, nNewWidth, nNewHeight, mnBitCount );Hi Kendy; looks rather plausibly related to:b0cd381de11340de8e72020f774a64d3ade6bbd9Initialize X11SalVirtualDevice with appropriate SalGraphics.+ GtkSalGraphics *pGtkSalGraphics = dynamic_cast<GtkSalGraphics*>(pG);+ assert(pGtkSalGraphics);+ return CreateX11VirtualDevice(pG, nDX, nDY, nBitCount, pGd,+ new GtkSalGraphics(pGtkSalGraphics->GetGtkFrame(), pGtkSalGraphics->GetGtkWidget()));Seems like the GtkSalGraphics is not always associated with a parented frame, but sometimes another virtual device (?) or ... something ;-)It'd be great if you could take a look.Thanks !This crashed for Rishabh and he asked me to confirm it and then i reported it. :DCreatedconsole logsOn pc Debian x86-64 with master sources updated today, I don't reproduce the crash.But console warnings logs have increased since some days.The original was fixed with 6bf39b2f4ea4e880d8414b04269405e6b48efe23 I believe, and then later reworked by Moggi in 12b73697ed5787a621910623d76a6e241b04bd1a, c4f63de0eebf8ba5c58e269c9a3763c42448424e, and 7b2e70f0c83dc333f3ad2e4584703c306269f466.I'll see if I can reproduce the "drawable is not a pixmap or window" warnings; but they are not that rare from what I recall, could be totally unrelated.I was able to reproduce the crash with libreoffice-5-0 (25a5cce5acea051a4dd1ba097d540c43e8de31a3)on OpenSuSE 13.1 (x86_64), but with SAL_USE_VCLPLUGIN=gen, the problem doesn't occur.The fresh libreoffice-5-0 build (99db209005634a7342d7043485cdbef5b510e199) doesn't crash.I tried to bibisect the crash (via ssh -X), but I have got the following gtk library problem:~/libreoffice-4-4/bibisect/lo-linux-dbgutil-daily> opt/program/soffice** (soffice:4295): WARNING **: Couldn't connect to accessibility bus: Failed to connect to socket /tmp/dbus-BpdI55feet: Connection refused/home/nemeth/libreoffice-4-4/bibisect/lo-linux-dbgutil-daily/opt/program/soffice.bin: symbol lookup error: /home/nemeth/libreoffice-4-4/bibisect/lo-linux-dbgutil-daily/opt/program/libvclplug_gtk3lo.so: undefined symbol: gtk_gesture_swipe_newI cannot reproduce this issue in Version: 5.0.0.5Build ID: 1b1a90865e348b492231e1c451437d7a15bb262bIt does not crash.CreatedbacktraceStill happening, though it didnt happen as easily as it did when i first reported the bug, but after attempting it a few times and jumping between the gradients, hatching and bitmaps tabs a few times and pressing 'OK', it keeps on crashing.Version: 5.0.2.0.0+Build ID: aff9057c35827ec7a6219b1c752f7525db64cdcaTinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:libreoffice-5-0, Time: 2015-08-13_06:15:07Locale: en-US (en_US.UTF-8)Version: 5.1.0.0.alpha1+Build ID: 5d6ef74eea5d73b8cd17f313ad87138d56dc76ceTinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2015-08-18_01:28:44Locale: en-US (en_US.UTF-8)Backtrace looks like tdf#93102:#1 0x00007ffff6033b6c in ToolBox::GetItemState(unsigned short) const () from /home/jay/Desktop/LibO_betas/LibreOfficeDev_5.1.0.0.alpha1_Linux_x86-64_deb/install/opt/libreofficedev5.1/program/libmergedlo.so#2 0x00007ffff56a25cf in SvxSuperContourDlg::StateHdl(ContourWindow*) () from /home/jay/Desktop/LibO_betas/LibreOfficeDev_5.1.0.0.alpha1_Linux_x86-64_deb/install/opt/libreofficedev5.1/program/libmergedlo.so#3 0x00007ffff56de52f in GraphCtrl::UpdateHdl(Idle*) () from /home/jay/Desktop/LibO_betas/LibreOfficeDev_5.1.0.0.alpha1_Linux_x86-64_deb/install/opt/libreofficedev5.1/program/libmergedlo.so#4 0x00007ffff623f87f in ImplSchedulerData::Invoke() () from /home/jay/Desktop/LibO_betas/LibreOfficeDev_5.1.0.0.alpha1_Linux_x86-64_deb/install/opt/libreofficedev5.1/program/libmergedlo.so#5 0x00007ffff623f9ef in Scheduler::ProcessTaskScheduling(bool) () from /home/jay/Desktop/LibO_betas/LibreOfficeDev_5.1.0.0.alpha1_Linux_x86-64_deb/install/opt/libreofficedev5.1/program/libmergedlo.soBut I added some more disposing goodness there. Can't reproduce this myself however. Is there any chance that you can install debuginfo for your system's gtk+ libraries, even if we don't have them for:Thread 1 (Thread 0x7ffff7f9da40 (LWP 10895)):#0 0x00007fffe29f0960 in gdk_x11_screen_get_screen_number () from /usr/lib/x86_64-linux-gnu/libgdk-x11-2.0.so.0#1 0x00007fffe32b86cb in GtkSalGraphics::GtkSalGraphics(GtkSalFrame*, _GtkWidget*) () from /home/jay/Desktop/LibO_betas/LibreOfficeDev_5.0.0.0.alpha1_Linux_x86-64_deb/install/opt/libreofficedev5.0/program/libvclplug_gtklo.soframe #1 - we should have them from the system for frame #0 =) I wonder what's up with the GdkX11Screen that's in-use there.Thanks !Michael Meeks committed a patch related to this issue.It has been pushed to "master":tdf#92213 - avoid potential crasher from unusual idle handler.It will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.(In reply to Michael Meeks from)Looked in my package manager and found libgtk-3-0-dbg, is that the package? I'm running LO in gtk2 mode though. Is it easier just to run the backtrace in the daily debug builds fine ()?I'd expect something similar for the gtk2 packages =) but it looks sensible.Ah - yes; probably =) if you can reproduce there - thanks !Createdbacktrace from dbg buildIt crashed. Hope it give you what you need.Version: 5.1.0.0.alpha1+Build ID: b2363e98af7b0281279617e43b8fec5b898b9120TinderBox: Linux-rpm_deb-x86_64@70-TDF-dbg, Branch:master, Time: 2015-08-25_23:42:26Locale: en-US (en_US.UTF-8)Michael Meeks committed a patch related to this issue.It has been pushed to "master":tdf#92213 - don't crash fetching pixelctl a11y peer for un-parented window.It will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.The trace shows an obscure a11y crasher; it has a bogus assert and/or NULL ptr de-reference in the code where it should fail gracefully. Just pushed a fix to master; can you verify & propose it for -5-0 =) I guess the missing piece with your system is that you have a11y enabled - it'd be useful to mention that in bug reports./me hopes this bug can now stay closed =)Thanks !Createdbacktrace(In reply to Michael Meeks from)Unfortunately i wouldnt know how to do this. :DI enabled a11y on my system but never actually used it, so it never came to mind when reporting the bug. :DUnfortunately i doesnt seem to be fixed.Version: 5.1.0.0.alpha1+Build ID: 0c1d3f0c17296c113358228cf36596347fd045e3TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2015-08-31_23:36:34Locale: en-US (en_US.UTF-8)Downloading the new daily dbg to get a better backtrace.Still happening. Dbg build backtrace coming up.Version: 5.1.0.0.alpha1+Build ID: 18c196f0190d9920673cdd9a4dbc158f08959cfdTinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2015-09-26_00:38:50Locale: en-US (en_US.UTF-8)Createddbg backtraceVersion: 5.1.0.0.alpha1+Build ID: 2dea4d270806f47a324cb09c1db7751499930cf7TinderBox: Linux-rpm_deb-x86_64@70-TDF-dbg, Branch:master, Time: 2015-09-19_04:51:40Locale: en-US (en_US.UTF-8)Console log------------------warn:ucb.ucp.gio:9733:1:ucb/source/ucp/gio/gio_content.cxx:401: ignoring GError "The specified location is not supported" for <vnd.sun.star.job:alias=UpdateCheck>warn:legacy.osl:9733:1:vcl/source/gdi/image.cxx:392: ImageAryData::Load: failed to load image 'cmd/lc_changecasetolower.png'warn:legacy.osl:9733:1:vcl/source/gdi/image.cxx:392: ImageAryData::Load: failed to load image 'cmd/lc_changecasetoupper.png'warn:legacy.osl:9733:1:editeng/source/items/frmitems.cxx:476: unknown MemberIdwarn:legacy.osl:9733:1:editeng/source/items/frmitems.cxx:476: unknown MemberIdwarn:legacy.osl:9733:1:basegfx/source/polygon/b2dtrapezoid.cxx:655: Trapezoid decomposer in illegal state (!)warn:legacy.osl:9733:1:basegfx/source/polygon/b2dtrapezoid.cxx:655: Trapezoid decomposer in illegal state (!)warn:legacy.tools:9733:1:sfx2/source/control/statcach.cxx:404: setting state of dirty message(soffice:9733): Gtk-CRITICAL **: IA__gtk_widget_get_screen: assertion 'GTK_IS_WIDGET (widget)' failedClosing this one, as it's already discusses several different issues. The original backtrace is now discussed in.Migrating Whiteboard tags to Keywords: (BibisectRequest)[NinjaEdit]
id=92191	Selecting an ODF file in Finder opens LibreOffice but not the selected file. LibreOffice Vanilla is set as the default app for the selected files.LibreOffice:Version: 4.4.4.2Build ID: 323549d66ffd3888c6a5058f7f6c9f0a279e0d3fLocale: en.UTF-8MacBook Pro Model Identifier: MacBookPro11,3 Processor Name: Intel Core i7 Processor Speed: 2.5 GHz Number of Processors: 1 Total Number of Cores: 4 L2 Cache (per Core): 256 KB L3 Cache: 6 MB Memory: 16 GB Boot ROM Version: MBP112.0138.B14 SMC Version (system): 2.19f12System Version: OS X 10.10.3 (14D136) Kernel Version: Darwin 14.3.0 Boot Volume: Macintosh HD Boot Mode: Normal Works fine onVersion: 5.1.0.0.alpha1+Build ID: 843f7335b2e11dde66d5f6e0f98b98e30eff7119Locale : fr-FR (fr.UTF-8)OSX 10.10.3, so this is a problem specific to the Collabora productTested on Version: 4.4.3.2Build ID: 88805f81e9fe61362df02b9941de8e38a9b5fd16Locale : fr_Can confirm problem, so not specific to Collabora build, and solved in current master. If 4.3.x is to see further releases, would be good to be able to backport, but without knowing which commit fixed it, will be difficult.Closing as WFM because it works in master.(In reply to Alex Thurgood from)Sorry, I meant backport to 4.4.x of course.TDF LibreOffice always works fine for me. I tested 4.4.3.2 on OS X 10.9.5 and on OS X 10.10.3. This is what users report in general, so I accept it as truth.On the other hand, the App Store version does not for for people. Someone reported a line from Console log:22.06.15 19:25:14,270 CoreServicesUIAgent[53491]: Error -60005 creating authorizationI also saw this line once under OS X 10.10.3, but not always. So this can be unrelated. Most of the times nothing is written into the log, and opening file from Finder fails silently. It can be related to sandboxing or to the fancy app name "LibreOffice Vanilla". I can imagine that it would have worked with plain "LibreOffice". Any ideas are welcome.I installed the latest development version Version: 5.1.0.0.alpha1+Build ID: 0e2db2dd3413d760afaa4cfab4c7c224222b949aTinderBox: MacOSX-x86_64@49-TDF, Branch:master, Time: 2015-06-25_06:30:25Locale: en-US (en.UTF-8)and, contrary to the behavior of the Vanilla version, clicking a file in Finder properly starts the program and loads the selected document.***has been marked as a duplicate of this bug. ***has anyone tested the 5.0 RC1 to see if the issue is fixed in the 5.0.x codeline just as in the 5.1.x branch?(In reply to tommy27 from)This bug occurs only for the App Store version.It seems to a sandboxing problem, because I changed the name of the bundle back to LibreOffice and rebuilt the package, and it didn't help.When I tested LOfC 4.3, I saw this line in the log:lsboxd[224]: Denied process 770(UNKNOWN) access to shared list com.collabora.libreoffice.LSSharedFileListdbgutil build of LibreOffice Vanilla:Andrass-Mac-mini:lof-4.4 timar$ LibreOffice\ Vanilla.app/Contents/MacOS/soffice ~/Documents/4.1.0.odtwarn:desktop.app:8085:1:desktop/source/app/app.cxx:235: cannot open /user/extensions/buildid for reading: 21warn:desktop.app:8085:1:unotools/source/ucbhelper/localfilehelper.cxx:205: cannot open directory /user/extensions: 21warn:desktop.app:8085:1:desktop/source/app/app.cxx:246: cannot remove file /registry/com.sun.star.comp.deployment.component.PackageRegistryBackend/unorc: 21warn:desktop.app:8085:1:desktop/source/app/app.cxx:250: cannot create path /user/extensions: 21warn:desktop.app:8085:1:desktop/source/app/app.cxx:254: cannot open /user/extensions/buildid for writing: 21warn:desktop.app:8085:1:desktop/source/app/langselect.cxx:125: ignoring Exception "component context fails to supply service 'com.sun.star.configuration.ReadOnlyAccess' of type 'com.sun.star.container.XHierarchicalNameAccess'"warn:tools.rc:8085:1:tools/source/rc/resmgr.cxx:213: opening dir /Resources/resource/ failedwarn:vcl.app:8085:1:vcl/source/app/IconThemeScanner.cxx:30: Could not determine status for file '/Resources/config/'.libc++abi.dylib: terminating with uncaught exception of type com::sun::star::uno::DeploymentExceptionAbort trap: 6***has been marked as a duplicate of this bug. ***Fixed now in the relevant branches, new builds will be produced and submitted for review soonish.commit 9d930ddacb402f02642a1d0119d258646bf0d7fdAuthor: Tor Lillqvist <>Date: Tue Jun 30 19:42:45 2015 +0300 tdf#92191: Don't use any IPC pipe in a sandboxed OS X app Creating the pipe fails when sandboxed. This caused us to not start the OfficeIPCThread, and that then meant that the file open requests coming in through VCL_NSApplication's application:openFile: method in vclnsapp.mm were not processed properly. The OS takes care of not starting multiple LO apps simultaneously anyway, so we don't really need any pipe, I hope. Change-Id: Ia920520ce2928787313f83199028f9c9942f61f3it’s the vanilla-verion of collabora produxtivity ltd. you get via teh apple app store.(In reply to symcx from)FYI, next release, which is waiting for review in App Store, have this issue fixed.Tor Lillqvist committed a patch related to this issue.It has been pushed to "master":tdf#92191: Don't use any IPC pipe in a sandboxed OS X appIt will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=92366	CreatedbacktraceSteps:1) Open Writer2) Insert Chart3) Click Data Table in toolbar4) Click title bar close button5) CrashVersion: 5.1.0.0.alpha1+Build ID: 63384060ec6610ef08af57b981d028c8a177a028TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2015-06-26_07:23:12 forgot to set priority. ;DI submitted a patch for a different bugtracker, seeI don't reproduce with: LO 5.1.0.0.alpha1+ Build ID: 437210d58f32177ef1829d704f7f4d2f1bbfbfddTinderBox: Win-x86@39, Branch:master, Time: 2015-06-18_07:21:56and Windows 7 Home Premium.Same callstack*** This bug has been marked as a duplicate of***same bt but not the same initial pb.So adjusting status.
id=92611	Createdbacktrace1. New Text Document.2. Tools -> Bibliography Database.3. Close db.Result:Crash.Windows Vista 64Version: 5.1.0.0.alpha1+Build ID: a625cd702700ae1773966a3133d27027d1c4d083TinderBox: Win-x86@39, Branch:master, Time: 2015-07-07_08:23:06 Confirmed:Ubuntu 15.04 x64Version: 5.1.0.0.alpha1+Build ID: ec44f1ae39e44f55ef1b1625fc5f638d2dbf5256Locale: en-US (en_US.UTF-8)Set to:Critical - crash + regressionHighest - equivalent to MAB, regression, crash, loss of dataNote: Major could have been appropriate here but I sided with critical just because it's a single step in a "main menu" item (one level tools -> biblio... is unusable with the crash)Createdbt with debug symbolsOn pc Debian x86-64 with master sources updated today, I could reproduce this.It's equivalent to Gordo's bt with Linux.Michael: thought you might be interested in this one.Wow - this only worked in the past because it leaked I suspect. It seems we have an UNO referenced object which is a static member of another object - which looks really odd to me. Chasing it now ... have a prototype fix.tdf#92611 - unwind UNO lifecycle snafu.Will push when CI has its say =)Noel - this is an interesting one =)It would be fantastic to have a clang plugin that checks for any member (ie. non-heap allocated thing) that implements an UNO interface (or at least uses these helper classes). I wonder if we could easily find more of these to fix left & right ? =)Thanks for the report !Michael Meeks committed a patch related to this issue.It has been pushed to "master":tdf#92611 - unwind UNO lifecycle snafu.It will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Meeks committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#92611 - unwind UNO lifecycle snafu.It will be available in 5.0.0.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.With master sources updated today, I don't reproduce the crash.Thank you Michael! :-)Migrating Whiteboard tags to Keywords: (regression)[NinjaEdit]Xisco Fauli committed a patch related to this issue.It has been pushed to "master":tdf#92611: Add uitestIt will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=92308	Createdlinux backtraceSteps:1) Open Writer2) File > Send > Email Document3) CrashVersion: 5.1.0.0.alpha1+Build ID: 3ecef8cedb215e49237a11607197edc91639bfcdTinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2015-06-20_01:01:56 Reproducible with Version: 5.1.0.0.alpha1+Build ID: a64999511ae654131d997eec9a3d78478cfc1c75TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2015-06-22_05:01:17 /opt/libreofficedev5.1/program/sofficePicked up JAVA_TOOL_OPTIONS: -javaagent:/usr/share/java/jayatanaag.jar ## A fatal error has been detected by the Java Runtime Environment:## SIGSEGV (0xb) at pc=0x00007f2eeef4f0a2, pid=23638, tid=139840669452864## JRE version: Java(TM) SE Runtime Environment (8.0_45-b14) (build 1.8.0_45-b14)# Java VM: Java HotSpot(TM) 64-Bit Server VM (25.45-b02 mixed mode linux-amd64 compressed oops)# Problematic frame:# C [libswlo.so+0x3b10a2] SwDoc::HasInvisibleContent() const+0x252## Failed to write core dump. Core dumps have been disabled. To enable core dumping, try "ulimit -c unlimited" before starting Java again## An error report file with more information is saved as:# /home/user/hs_err_pid23638.log## If you would like to submit a bug report, please visit:#Hi Jay,I reproduce with 5.1.0.0.alpha1+ Build ID: 437210d58f32177ef1829d704f7f4d2f1bbfbfddTinderBox: Win-x86@39, Branch:master, Time: 2015-06-18_07:21:56and Windows 7 Home PremiumAlso with all LO 5 versions:LO 5.0.0.1 Build ID: 9a0b23dd0ab9652e0965484934309f2d49a7758eLO 5.0.0.0.beta3 Build ID: 96345c15d8ab19c49014f055fe41ba8e1f421e5cLO 5.0.0.0.beta1 Build ID: 0a16c3dda4150008d9be6f24cbd15ac198d116d3LO 5.0.0.0.alpha1+ Build ID: 6664859e1e8b3f8b7db8c931b8d0335510c20ce0TinderBox: Win-x86@42, Branch:master, Time: 2015-05-16_03:16:31Works into LO 4.4.4.2JacquesCrashing in 5.0 daily build, so moving version back to that version. Trying to run a bibisect against 50max.Here is the bibisect results, clearly fails in the area of this commit0d72ed4f5bfc65a7938e017f56993ef2f58ecfae is the first bad commitcommit 0d72ed4f5bfc65a7938e017f56993ef2f58ecfaeAuthor: Matthew Francis <>Date: Wed May 27 20:07:10 2015 +0800 source-hash-0d97d25d56a5a8466d698e0f5831f2072c8e8baf commit 0d97d25d56a5a8466d698e0f5831f2072c8e8baf Author: Bjoern Michaelsen <> AuthorDate: Sat Mar 14 18:34:28 2015 +0100 Commit: Bjoern Michaelsen <> CommitDate: Mon Mar 16 13:24:07 2015 +0100 use SwIterator for typed iteration Change-Id: Icc1a04304e182687a306e9d08cbf7d46b0adbee6:040000 040000 0b748f313010b12aba22716dcacba79734f711de e7c8094d348227c370deaeb2b754b5e145ab8b88 M optInteresting.(gdb) #4 0x00007fffac60102e in SwDoc::HasInvisibleContent (this=0x114f070) at /data/opt/libreoffice/master/sw/source/core/doc/doc.cxx:14561456 SwSectionFormat* pSectFormat = rSectFormats[ n ];(gdb) l1451 }1452 1453 const SwSectionFormats& rSectFormats = GetSections();1454 for( SwSectionFormats::size_type n = rSectFormats.size()-1; n; --n )1455 {1456 SwSectionFormat* pSectFormat = rSectFormats[ n ];1457 // don't add sections in Undo/Redo1458 if( !pSectFormat->IsInNodesArr())1459 continue;1460 SwSection* pSect = pSectFormat->GetSection();(gdb) p rSectFormats$1 = (const SwSectionFormats &) @0x10bfb10: {<SwFormatsModifyBase<SwSectionFormat*>> = {<SwVectorModifyBase<SwSectionFormat*>> = {<std::__debug::vector<SwSectionFormat*, std::allocator<SwSectionFormat*> >> = std::__debug::vector of length 0, capacity 0, _vptr.SwVectorModifyBase = 0x7fffadebd470 <vtable for SwSectionFormats+16>, mPolicy = SwVectorModifyBase<SwSectionFormat*>::FreeElements}, <SwFormatsBase> = {_vptr.SwFormatsBase = 0x7fffadebd4a0 <vtable for SwSectionFormats+64>}, <No data fields>}, <No data fields>}We're referencing at index -1 ;-)Bjoern looks strongly like:commit 0d97d25d56a5a8466d698e0f5831f2072c8e8bafAuthor: Bjoern Michaelsen <>Date: Sat Mar 14 18:34:28 2015 +0100 use SwIterator for typed iteration- for( SwSectionFmts::size_type n = rSectFmts.size(); !bRet && (n > 0); )+ for( SwSectionFmts::size_type n = rSectFmts.size()-1; n; --n )***has been marked as a duplicate of this bug. ***Always crash in RC2 on Win7 x86 :Version: 5.0.0.2Build ID: a26d58f11b99b6aeddf7f7884effea188cc6e512Locale : fr-FR (fr_FR)BernardBjoern Michaelsen committed a patch related to this issue.It has been pushed to "master":tdf#92308: Dont crash on "File > Send > Email Document"It will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Waiting for 5.0 review at:Bjoern Michaelsen committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#92308: Dont crash on "File > Send > Email Document"It will be available in 5.0.0.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Sorry for the delay on the trivial fix, I must have overlooked/5 when they initially flew by. => RESOLVED/FIXED now.***has been marked as a duplicate of this bug. ***verified in Version: 5.1.0.0.alpha1+Build ID: 3c45bfb0cabf206f6217f1de9eb5cfa12b78e46fTinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2015-07-04_01:25:39Thanks for the fix.***has been marked as a duplicate of this bug. ***Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]***has been marked as a duplicate of this bug. ***
id=92732	Writer crashes after using the "Edit index entry" dialog window1. Start Writer.2. Input some text.3. Insert one index entry: select a word. select Insert > Index and tables > index entry. click insert click close4. Right click on the just inserted index entry Select "Edit index entry..." Select OK or close or Delete. Writer has done the work with this dialog. but if you continue to work, click anywhere in the writer, and Writer crashes.OS: Win7 32bit.Version: 5.0.0.3 Repro.Win 7 Pro 64-bit Version: 5.1.0.0.alpha1+ (x64)Build ID: e92a8b92072284fd7c37d7bb3e1e8fe72a185f35TinderBox: Win-x86_64@62-TDF, Branch:MASTER, Time: 2015-07-22_21:46:26Locale: fi-FI (fi_FI)TESTING on Ubuntu 14.04 withVersion: 5.1.0.0.alpha1+Build ID: 85ce6a2446deb0f4c01604b6188f969603de9b16TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:master, Time: 2015-07-09_02:29:43Locale: en-US (en_US.UTF-8)(In reply to water.qian from)I chose one of the middle words.CONFIRMED -- I had to click around a few times, but Writer then crashed.CreatedJava crash logConfirmed withUbuntu 15.04 64-bit Version: 5.1.0.0.alpha1+Build ID: 902255645328efde34ddf62227c8278e8dd61ff0TinderBox: Linux-rpm_deb-x86_64@70-TDF-dbg, Branch:master, Time: 2015-07-30_03:52:32Locale: en-US (en_US.UTF-8)Createdhs_err_pid2675.logError logCONFIRMEDCreatedSimple document with index to test bugAlso confirmed with release version 5.0.0.5 on Windows 7 and Windows 10. I've attached a simple test document. Right clicking on one of the index entries and editing it leads to crash after the dialogue box is closed. Works fine in 4.4.5(In reply to Jason from)Hi. I tried to confirm this on Win7 Swedish 64-bit, AMD hw and 64-bit LO 5.005, but unable to provoke crash. I tried both the file index.odt and one of my own creation. No crash. Rgds Per (tested OK also on Win7-64, LO 4.4.5 x86, similar hw)(In reply to Per from)Have to correct myself. Table of Content works, but Alphabetical index fail as reported, sorry, my mistake.Oliver Specht committed a patch related to this issue.It has been pushed to "master":tdf#92732: fix vclptr lifecycle for index entry editing dialogIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Oliver Specht committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#92732: fix vclptr lifecycle for index entry editing dialogIt will be available in 5.0.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Just tested the daily build of 5.1 on a Windows VM and can confirm that index entry editing now works correctly in this build. Thanks!Version: 5.1.0.0.alpha1+Build ID: d417059dae303685de7aa0f4b1c192ffcf5304d5TinderBox: Win-x86@39, Branch:master, Time: 2015-09-05_09:23:01Locale: en-US (en_US)Jason: thanks for verifying!Migrating Whiteboard tags to Keywords: (bibisectRequest)[NinjaEdit]
id=93113	Not sure if this is fixed yet or not but I was having frequent freezes and crashes in the LO 4.4.x so I decided to upgrade to 5.0.4 to see if the bug had been fixed.It hasn't. I'm making a document that uses lots of special characters. The dialog window used to insert them often becomes slow and unresponsive. Often this completely freezes LO. I have to kill the application, restart it, and recover the document.Sometimes, a special character is inserted and it disappears too. Hi David,I reproduce with LO 5.1.0.0.alpha1+ Build ID: 8cfdd81b70ef37927b40497ffd10034f28335034TinderBox: Win-x86@39, Branch:master, Time: 2015-07-24_02:47:18 Locale: fr-FRLO 5.0.0.3 Build ID: f79b5ba13f5e6cbad23f8038060e556217e66632but not with LO 5.0.0.2 Build ID: a26d58f11b99b6aeddf7f7884effea188cc6e512OS : Windows 7 Home PremiumSelecting icon for Special Character, LO freezes.Trying to quit LO by Ctrl+Alt+Suppr, I can see the error message : LibreOffice 5.0 - Fatal errorSEH Exception: ACCESS VIOLATIONSelecting Insert > Special Character, Fatal error message is displayed, LO closes and recovery process is launch.I verified with Writer and Calc, but probably all components affected.Thank you for the report.I can not reproduce with calc:Win7x64UltimateVersion: 5.0.0.5 (x64)Build ID: 1b1a90865e348b492231e1c451437d7a15bb262bMaybe resetting the user profile could help, I think 5.x uses the same profile than 4.x, but I have the 5.0 version with a parallel installation that has their own clean profile.Resetting profile does not make a difference.I cannot comment on Calc because I only use Draw. I use Draw daily for all of my work so when something is broken I usually notice quickly.Also, I am using Linux not Windoze so I would not be surprised if this only affects 64bit linux users.Thanks for test.I can't reproduce also with Draw.Please, does it happen with all Fonts and any subset?, could be useful for devs.Createdincorrect font table (5.0.0.x)CreatedCorrect font table (4.4.5.2)It is an intermittent bug unfortunately.I migrated to the 5.0.0.x release candidates because the freezes were affecting my work so often I was afraid I would corrupt my work document with the frequent document recovery processes.Unfortunately, the freezes also affect the upcoming 5 series.What I have managed to determine is that the font table problem reported in my other bug (probably related to this bug) affects 5.0.0.2, 5.0.0.4, and 5.0.0.5I have downgraded to 4.4.5.2 and the tables are now rendered correctly. I will attach pix to this bug and the other in the hope someone can rectify it.CreatedScreens window when crash.I have not in Win7 subset Domino Tiles.LibreOffice crash after insert characters from Sigoe family font when I try to open again the Insert Special Character box.Step to reproduce:- Create a new file in Draw.- Create a text box- Call Special Character- Select any Segoe Font.- Insert a character, and close the box.- [Enter] in the text box.- Call Special Character again.- LibreOffice crash, seems as if it is trying to select U+FFFF(65535) character, see attached screenshot.CreatedScreenshot Visual Studio message.Win7x64UltimateVersion: 5.0.0.5 (x64)Build ID: 1b1a90865e348b492231e1c451437d7a15bb262brecurses to death where paint ends up forcing a paint on itselfCaolán McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: tdf#93113 crash on revisiting insert special characterIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.proposed for 5.0.1***has been marked as a duplicate of this bug. ***Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-5-0":Resolves: tdf#93113 crash on revisiting insert special characterIt will be available in 5.0.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Does the proposed patch also fix the problem some of us are having with font tables not being displayed correctly or is it just the crash / lock up bug?***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-5-0-1":Resolves: tdf#93113 crash on revisiting insert special characterIt will be available in 5.0.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Isn't this bug fixed for versions 5.0.1 upwards?It continues to appear in 5.0.3 release. Version 5.0.3.2 x64, platform win7 x64 home premium.The crashes appear in the same circumstances as described in.Hi @Petr, I have test with my step to reproduce in, and no issue.Just in case please test disabling Menu/Tools/Options/View/Graphics Output - Use OpenGL for all rendering (restart LibreOffice)Testing again resetting the user profile:Usually it's enough renaming/deleting the file "user/registrymodifications.xcu", it affect all the options in Menu/Tools/Options, and the files "user/basic/dialog.xlc" and "scrip.xlc" are overwritten, additionally custom colors in "user/config/standard.soc" are lost.Hi, Miguel, thanks for your reply.These actions don't have any effect on crashes:(1) Removing Libreoffice, making a clean reinstall, thereby removing all of the old profile.(2) Disabling OpenGL or other graphics options through Menu/Tools/Options/View/Graphics Output.Followed the steps in your. Couldn't go any further than step three, that'sStep to reproduce:- Create a new file in Draw.- Create a text box- Call Special CharacterAt the moment Special Character is called Libreoffice shows Fatal error message and closing message crashes application.There's a slight difference in the platforms used which may be the cause for different behaviour. I got crashes in W. Home premium as inand you tested in W. Ultimate in your. In Home premium I checked Writer, Calc, Impress, Draw. All get special character crashes.Does it happen with any Font or with some in particular?Possibly happens in all of them. Checked some. Liberation serif, Arial, Lucida console, Times new roman. Doesn't make any difference for the crash pattern.
id=93356	Createdexample sort filesimilar to 92787, but happens every time (but not on a simple single column test list).Attempt to SORT immediately crashes Calc. Not sure if this has any bearing on the problem - opened an xls created with MSExcel in LO Calc. Sorted without any issue.Same result with the same file saved as xlsx using MSExcel.I installed OO 4.1.1I am not having any issues with the .ods files.Hi, could you give us steps to reproduce? I've tried to sort your file by date and didn't get any crash. On which range and which column are your sorting? Sophieadded version. SophieCrashed for me. (I have experienced crashes try to sort rows in one of my files also.)LO 5.0.1.2Win-x86Steps to reproduce1. In LO Calc, opened the "example sort file" (2015-08-11 13:44 UTC) (Answered "No" to dialog about updating links.)2. Selected data rows 5 through 77 (clicked 5 in left margin, scrolled down, shift-clicked 77 in left margin.)3. Menu Data / Sort ...4. Alternative A: sort descending by date Sort Key 1: selected Column E (the date column), and selected (*) Descending (descending is important, because it is already sorted in ascending order, and didn't crash if it was left Ascending.) Alternative B: sort ascending by description Sort Key 1: selected Column F (the description column) and left (*) Ascending as is.5. Clicked OK.CRASHED (Sort dialog and Calc spreadsheet window both disappear.)(Often the document recovery dialog appears, but not always.)(On my file, it also crashed in LO 5.0.0.5? and LO 4.4.5.2.)LO did NOT crash for me on the above steps with the development buildmaster~2015-09-01_06.18.16_LibreOfficeDev_5.1.0.0.alpha1_Win_x86(and opening the file from inside LO).(I found the possibly unstable development build after following instructions on, near the bottom. It worked after I figured out that it installs into a separate directory. It does not override the current install. Opening the file from Windows explorer or the start menu will not use the development build.)***has been marked as a duplicate of this bug. ****** This bug has been marked as a duplicate of***Alex, Thanks for the triage efforts, but I don't think this is a duplicate of.* This crash happens always,was intermittent.* In LO 5.0.1.2, the example in this bug always crashes for me, but I was unable to reproduce a crash on the example given in.* (I don't know whether the external file storage type makes a difference, but this bug example is .ods, andexample is .xlsx.) Reverting to NEW for now.[If this bug is indeed fixed when 5.1 is released (see), I expect it could be resolved as worksforme, unless a specific fixed bug can be found.]CreatedWinDbg output from crash in LO 5.0.1.2 on "example sort file" ()This WinDbg includes STACK_TEXT that looks similar to,, Thread 0, leading up to ScTable::SortReorderByRow(in case someone may recognize the bug that hopefully fixed this bug []).(Unlikeworkround,) Sorting a rectangular region rather than rows still causes a crash on this bug's example. I repeated steps from this bug, again on "example sort file", except in step 2, I clicked cell A5, then shift-clicked cell X77, to select the rectangular region containing data cells, not full rows.(The WinDbg output is the same, ignoring differences in hexadecimal data/addresses.)Since this bug seems to appear on Linux, Windows, and MacOS (), changed OS to all.I had a crash in Calc 5.0.0.5 x86/64 under Windows 7.This is the file a friend sent to me (sorry, everything is in Italian):It's made in MS Excel. I try to save in ODS but same issue.1) select cells A8:H13 in the second sheet (called "Gruppi gara1")2) sort by "PROG".The program closes.The problem occurrs even selecting other groups of cells.LO 5.0.1.2 + Ubuntu 14.04(In reply to gekacheka from)Chose this oneYes, CRASH confirmed.Same results with LO 5.0.0.5.Changing Priority -> highest(In reply to gekacheka from)I'll check with a daily build as wellJust in case, I removed LO and then reinstalled again; version is Version: 5.0.1.2Build ID: 00m0(Build:2)Locale: en-GB (en_ZA.UTF-8)I was not having this problem on the default version (Linux Mint 17.2 Cinnamon)This may add light to darkness:I have been playing around with the calc file I originally submitted. Tried various ways to see if I could stop it from crashing.FINALLY!Using the same file as I uploaded (testsort.ods)I select from A5:Q8SortExtend the selection to R8 (the first column to have a formula)SortNow I can select any block or set of rows and sort without crashing.I then tried this on a large file of dataHere, I had to select from A5:Qlastdatarowsort on colFextend to colR (first formula column)sort on colQafter this, I could sort anywhere randomlyBut this needs to be repeated for each sheetIf I save the file to a new name, the "fixed" sheet is OK, but Calc crashes on sheets that have not been fixed.Note that when I open the file using OO-Calc there is no crashingI hope this leads somewhereTESTING on Ubuntu 14.04 + LO Version: 5.1.0.0.alpha1+Build ID: 452b1872af72d7fb31101aa2fa35aeaf18e41a10TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2015-09-02_08:11:07(In reply to Robinson Tryon (qubit) from)YepNO REPRO Seems to be fixed with 5.1, soStatus -> RESOLVED WORKSFORMEI'll leave Priority as highest, and add to Whiteboard: backportRequest:5.0 backportRequest:4.4Elmar: My guess is this is a regression, so if the file sorting does not crash in 4.3, 4.2, or something older, we can mark it as such and then try to track down what commit introduced the problem.Same problem occurs on Version: 5.0.1.2 (x64)Build ID: 81898c9f5c0d43f3473ba111d7b351050be20261The two stack traces both lead up to ScTable::SortReorderByRow(WinDbg:, Mac:attachment 1181172)ScTable::SortReorderByRow is in table3.cxxtable3.cxx was modified 2015-08-13 for"Unexpectedly quit when use Data->Sort (crash)"is a similar problem and is marked FIXED.says the fix was committed to master 2015-08-13 for 5.1.says the fix was committed to 5-0 2015-08-17 for 5.0.2.says the fix was committed to 4-4 2015-08-17 for 4.4.6.No daily builds were available from just before and after these commits.The oldest daily build found for preparing 4.4.6 was 2015-08-20, and it works.The oldest daily build found for preparing 5.0.2 was 2015-08-20, and it works.Based on this partial evidence, marking this a duplicate of.-----------( Latest previous release that does not crash when sorting examples like this: LO 4.4.4.1 or earlier do NOT crash on sorting this example, while LO 4.4.4.2 or later DO CRASH on sorting this example. If a later version is installed, uninstall it before installing earlier one.)( Possible dates of future releases with fix for this problem: LO 5.1 release schedule is not yet defined. LO 5.0.2 is scheduled to be published near the end of September 2015. LO 4.4.6 is scheduled to be published near the middle of October 2015.)*** This bug has been marked as a duplicate of***
id=93539	CreatedFile which crashes LO.odg File attached No crash with Verze: 5.0.0.5 (x64)ID sestavení: 1b1a90865e348b492231e1c451437d7a15bb262band Version: 5.1.0.0.alpha1+ (x64)Build ID: e0b0501452e6a72ba800ae9f536d766f8111ed78TinderBox: Win-x86_64@62-TDF, Branch:MASTER, Time: 2015-08-19_01:09:37Win10no crash too under Win8.1 x64 using LibO 5.0.0.4 and 5.1.0.0.alpha1+Build ID: 7d3fa6bae9f7a755eb2d0ca24bf1afd5f3646bb7TinderBox: Win-x86@39, Branch:master, Time: 2015-08-09_08:38:08Locale: it-IT (it_IT)please tell your Windows version.try also resetting the user profile and give feedback.This happens on Windows 7 Service Pack 1.The installation is totally new (reinstall of Windows 7 & applications after a catastrophic Windows 10 update)LibO 5.0.1.2 has been releases.please, upgrade and retest.Problem solved, no crash with 5.0.1.2 with the same file.nice to hear that.status -> RESOLVED WORKSFORME
id=93667	CreatedbacktraceSteps:1) Open Writer2) Insert > Table of Contents and Index > Indexes and Tables3) CrashIs this a vclptr crash, as it doesnt happen in 4.4 daily?Version: 5.1.0.0.alpha1+Build ID: b712b1f63492a311e4a51cffd516b3e202a140e6TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2015-08-23_06:03:52Locale: en-US (en_US.UTF-8) Seems to be the same problem as in(the second issue there, not the first). It should be fixed whenwill be pushed. If you're going to test that patch, would be useful to also test if it really fixes this crash.*** This bug has been marked as a duplicate of***
id=93989	1) in my build: Chart icon is not working. when clicked it is givingMessageBox LibreOffice5.0 Fatal Error SEH Exception:Access violation!This apparently happens regardless of whether OpenGL is enabled; apparently inserting a chart sets up and/or queries GL in some way even if it is not enabled -> problems.#0 0x00007ffff5f4b5dc in XQueryExtension () from /usr/lib64/libX11.so.6#1 0x00007ffff5f3f8f2 in XInitExtension () from /usr/lib64/libX11.so.6#2 0x00007fffed302fef in XextAddDisplay () from /usr/lib64/libXext.so.6#3 0x00007ffff62d9167 in ?? () from /usr/X11R6/lib64/libGL.so.1#4 0x00007ffff62d91ba in ?? () from /usr/X11R6/lib64/libGL.so.1#5 0x00007ffff62d98ca in ?? () from /usr/X11R6/lib64/libGL.so.1#6 0x00007ffff62db3ba in ?? () from /usr/X11R6/lib64/libGL.so.1#7 0x00007ffff0675483 in OpenGLContext::resetCurrent (this=0x18f0c00) at /devel/libo/libo1/vcl/source/opengl/OpenGLContext.cxx:1420#8 0x00007ffff06750ca in OpenGLContext::prepareForYield () at /devel/libo/libo1/vcl/source/opengl/OpenGLContext.cxx:1348#9 0x00007ffff0d0611f in SalYieldMutex::release (this=0x610740) at /devel/libo/libo1/vcl/generic/app/geninst.cxx:57#10 0x00007fffe0dacbea in GtkYieldMutex::ThreadsLeave (this=0x610740) at /devel/libo/libo1/vcl/unx/gtk3/app/../../gtk/app/gtkinst.cxx:315#11 0x00007fffe0dabe75 in GdkThreadsLeave () at /devel/libo/libo1/vcl/unx/gtk3/app/../../gtk/app/gtkinst.cxx:58#12 0x00007fffe023bc3f in ?? () from /usr/lib64/libgdk-3.so.0#13 0x00007fffe9344a04 in g_main_context_dispatch () from /usr/lib64/libglib-2.0.so.0#14 0x00007fffe9344c48 in ?? () from /usr/lib64/libglib-2.0.so.0#15 0x00007fffe9344cec in g_main_context_iteration () from /usr/lib64/libglib-2.0.so.0#16 0x00007fffe0daa127 in GtkData::Yield (this=0x6105f0, bWait=true, bHandleAllCurrentEvents=false) at /devel/libo/libo1/vcl/unx/gtk3/app/../../gtk/app/gtkdata.cxx:604#17 0x00007fffe0dad00f in GtkInstance::DoYield (this=0x610480, bWait=true, bHandleAllCurrentEvents=false, nReleased=0) at /devel/libo/libo1/vcl/unx/gtk3/app/../../gtk/app/gtkinst.cxx:406#18 0x00007ffff0c4eb96 in ImplYield (i_bWait=true, i_bAllEvents=false, nReleased=0) at /devel/libo/libo1/vcl/source/app/svapp.cxx:362#19 0x00007ffff0c4b32a in Application::Yield () at /devel/libo/libo1/vcl/source/app/svapp.cxx:391#20 0x00007ffff0c4b2cf in Application::Execute () at /devel/libo/libo1/vcl/source/app/svapp.cxx:337Needless to say this works quite well with OpenGL enabled on Windows at least (for me), and without it enabled there too; nasty ... Markus kindly fixed this:Apparently this is indeed Linux specific.Markus Mohrhard committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#93989 - prevent crash with non-vcl OpenGL contextsIt will be available in 5.0.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Best if we don't crash when people click the chart item ;-)Markus Mohrhard committed a patch related to this issue.It has been pushed to "libreoffice-5-0-2":tdf#93989 - prevent crash with non-vcl OpenGL contextsIt will be available in 5.0.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.1k thanks for this fix! Confirming it in LO 5.0.2.2 on Win7 Pro 64bit :-) I'm about to finish a larger scientific document and the crashing EPS export was an annoyance.
id=94063	Createdexample document for reference breakageReferences break when you do so much as put a space behind them.Reproduction:Open attached document.Move the cursor behind one of the 2 references in the table under Headline 3.Hit the space bar.Alternatively:Mark one of the cells with a reference.Cut the cell.Paste the cell somewhere else.WTF? Put a space behind 2 and 2.1 turned into: Error: Reference source not foundWin 7 Pro 64-bit, Version: 5.0.1.2 (32-bit)Build ID: 81898c9f5c0d43f3473ba111d7b351050be20261Locale: fi-FI (fi_FI)Indeed WTF..I see the problem a bit differently: the reference in row 7 col 3 isalready broken in the attachment. Certain user actions cause the displayedtext of that reference to be updated. It may or may not becoincidental that officeotron reports 24 errors in the file.Working in the daily dbgutil bibisect repository, I used the followingSTR...( 1) Load att't.( 2) Type "<Ctrl>+<End>" three times. The caret goes to the end of the document. Row 7 of the table is visible.( 3) <Ctrl>+<click> on the reference in row 7 column 3. Observe that the caret moves just before the reference in question.( 4) For the reference in row 7 column 3, change Selection to "2.1 Subheading asdf". (right-click > Fields...; in pane Selection click "2.1 Subheading asdf".)( 5) <ctrl>+<Click> on that reference. Observe that the caret moves: "2.1 ^Subheading asdf".( 6) File > "Save As..." and save under a new name.( 7) File > Close( 8) In Start Center, File > "Recent Documents" > 1( 9) Type "<Ctrl>+<End>" 3 times. Row 7 of the table is visible.(10) <ctrl>+<Click> on the reference in row 7 column 2. - condition good : Observe the caret moves "2.1 ^Subheading asdf". - condition bad : caret moves before the reference.From `git bisect bad` I get... 7a286d694a0fc1faa6daf6eac93bcf4a59eebe08 is the first bad commit commit 7a286d694a0fc1faa6daf6eac93bcf4a59eebe08 Author: Miklos Vajna <> Date: Thu May 21 05:48:32 2015 +0200 2015-05-21: source-hash-1c9302565aefb5a54b1b7f1478dd6dac724d30ea :100644 100644 7acbb8c8b137cefa170d59c44b2258d3940e13e0 8c3c925d6300868ebc99b4e20b2ab00174080190 M build-info.txt :040000 040000 ef4b5928e9091b35b0865516e8759b757a751b46 7edd2a573ba319f3da3ec5746bab57308ce6eebe M optand from `git bisect log` ... # bad: [2ad98b12d82c4ada5756881f0d6074154976e95c] 2015-10-08: source-hash-2e6feddc53830406fa04b4a0aea49bb8438dc702 # good: [2b392af9c8f54629e3a3a98a8c92fa5af1c6722f] 2015-05-20: source-hash-90e2dabb8d0bb5382234be776c2ad0e2d5d9e224 git bisect start '2ad98b12d82c4ada5756881f0d6074154976e95c' '2b392af9c8f54629e3a3a98a8c92fa5af1c6722f' # bad: [7b4308803bb448efe4d64dcdea03e9d5be6dde9d] 2015-07-29: source-hash-62e2fae93e8894f73560a30ae1e752cbd4c001ad git bisect bad 7b4308803bb448efe4d64dcdea03e9d5be6dde9d # bad: [57aaa0c171166a76dcd09e7092f5ae111d4b5ccb] 2015-06-24: source-hash-2135fe0cef7bcf7160719f1f29ad65f2b064984b git bisect bad 57aaa0c171166a76dcd09e7092f5ae111d4b5ccb # bad: [2ff6fad6384c0192ea61bd9a163c8df3818ba8b3] 2015-06-06: source-hash-587006cac508616f486aea45e265a170bcccdc87 git bisect bad 2ff6fad6384c0192ea61bd9a163c8df3818ba8b3 # bad: [7b138bcf32b52eccf484bd66d9ab5c70a7970805] 2015-05-28: source-hash-be01d68420086fc36ecf26b5f597ba7c6b29b369 git bisect bad 7b138bcf32b52eccf484bd66d9ab5c70a7970805 # bad: [f39c4096f247626f7447321154de73b0c0dbc6b7] 2015-05-24: source-hash-891304bb0ad3af9d8d73f947f25477abf57485a4 git bisect bad f39c4096f247626f7447321154de73b0c0dbc6b7 # bad: [33e7c549fd7aa03e831a939201aa06dd80edb2b0] 2015-05-22: source-hash-edcd1d5a9c88455fd1d52ab25815fc8d439f31ec git bisect bad 33e7c549fd7aa03e831a939201aa06dd80edb2b0 # bad: [7a286d694a0fc1faa6daf6eac93bcf4a59eebe08] 2015-05-21: source-hash-1c9302565aefb5a54b1b7f1478dd6dac724d30ea git bisect bad 7a286d694a0fc1faa6daf6eac93bcf4a59eebe08 # first bad commit: [7a286d694a0fc1faa6daf6eac93bcf4a59eebe08] 2015-05-21: source-hash-1c9302565aefb5a54b1b7f1478dd6dac724d30eaI am removing whiteboard bibisectRequest and setting keyword bisected.Silly me. The daily dbgutil bibisect repository is not "dense". I amremoving keyword bisected and adding whiteboard bibisected.AFAICS the fix for(to test in 4.4.6.3) also fixes this one.Setting whiteboard target accordinglyIn, step (10), I meant row 7 column 3, of course.That said, I see the old behavior in daily dbgutil bibisect version2015-11-18. I am setting bug status NEW.Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit](clearing whiteboard as per)This just works fine in 5.1.2.1 on Ubuntu 32 bits.IMO a WorksForMe as explained in@Terrence Enger / @MalteCan you check please?This works well for me in daily Linux dbgutil bibisect version 2016-03-29.I am setting RESOLVED WORKSFORME. Malte, if you disagree, please set the bug back to UNCONFIRMED.Terry.
id=94225	1.) new document2.) insert a paragraph with text3.) insert an empty paragraf4.) insert a paragraph with text5.) insert an image to the empty paragraph6.) mark all and copy7.) insert the clipboard copy sometimes (at the end of document)8.) Crtl-z (sometimes)9.) -> Fatal Error Could not reproduce.Win 7 Pro 64-bit, Version: 5.0.1.2 (32-bit)Build ID: 81898c9f5c0d43f3473ba111d7b351050be20261Locale: fi-FI (fi_FI)Hi Stefan,Thanks for reporting the bug. Can you provide a document which reproduces this error and is fill up to step 5, so we can continue with the next steps? Which operating system are you running on?Wasnt able to reproduce either.Version: 5.1.0.0.alpha1+Build ID: cbf3fac0a5a1be34b2e1a58da959debd24ebc017TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2015-09-17_07:03:22Locale: en-US (en_US.UTF-8)i confirmed this behavior with my (re)installed 4.4.5.2. too. (win7 64bit/En-US LO en-us too)Yousuf (Jay) Philips, I can't provide a document with "filled" clipboard or Undo-Stack :/So try this:1.) new document2.) insert a paragraph with text ("Asdadad asd asd asda da dasda da" <- don't copy from here!)3.) insert an empty paragraf (so use your return-key)4.) insert a paragraph with text (do it like (1.) )5.) insert an image to the empty paragraph (menu->insert->image, not as link, default)6.) mark all and copy (set cursor at the beginning, hold shift and click after the last character)7.) click after the last charcter (removes "selection")8.) insert the clipboard 10 times (ctrl-v, ctrl-v, ctrl-v ....)9.) undo 11 times (ctrl-z, ctrl-z, ctrl-z, ctrl-z ...)10.) -> Fatal ErrorI hope this helps to reproduce.CreatedBacktrace of crash on WindowsThanks, now I was able to repro. Took more undo steps than 11, though. More like 15.Win 7 Pro 64-bit, Version: 5.0.1.2 (32-bit)Build ID: 81898c9f5c0d43f3473ba111d7b351050be20261Locale: fi-FI (fi_FI)I can reproduce with Version: 5.1.0.0.alpha1+ (x64)Build ID: 09fc6fef2d03ca8558dd6f0eec45d61ceb282cb5TinderBox: Win-x86_64@62-TDF, Branch:MASTER, Time: 2015-09-27_22:33:48TESTING with Ubuntu 14.04 +Version: 5.1.0.0.alpha1+Build ID: 6e8e898acb9f6825104f01d090f447e8dfc7e4a2TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2015-10-01_05:44:30Locale: en-US (en_US.UTF-8)(In reply to Stefan from)Do you then use Ctrl-c to copy?(Wasn't mentioned explicitly, so I'm assuming that step is also done)No crash, so NO REPRO from me.(Also unable to reproduce with 5.0.1.2 on same Ubuntu 14.04 system)Sefan: Can you reproduce this bug with a build of master? You can get a daily build here:(In reply to Robinson Tryon (qubit) from)Per Raal's repro (and my lack of repro), I'm going to changeOS -> WindowsReproduced on Linux (Ubuntu 14.04)Bibisect daily dbgutil repo,2015-09-18: source-hash-9ce08dcc2e32c5554ddf71b79173f8854e0568adSetting OS back to AllLooking at the mixture of crash and no-crash comments, I wonder if theprogram behaviour is dependent on the type of image inserted, or evenupon something in how that imaged is formed. It would be nice ifsomebody would attach a crash-provoking image file. Even nicer wouldbe 4 image files: crash-provoking and not, and from tests on Windowsand Linux.Terry.(In reply to Robinson Tryon (qubit) from)Did you undo about 15 times like I did?CreatedReproducer fileI can reliably reproduce on Linux with the attached file back to the year dotSteps1. Load the file2. Select all (Ctrl+A)3. Copy (Ctrl+C)4. Paste (Ctrl+V) times N5. Undo (Ctrl+Z) times at least NFor current builds from the 5.1 daily dbgutil repo, N is 1For OOo 3.3.0 and other intermediate releases, N may be up to 15Createdgdb on core file on linuxNote that my failure is SIGABRT; the Windows backtrace inshows an ACCESS VIOLATION.'Backtrace' is at line 59, 'backtrace full' at line 124.As I followed the steps in, the crash occurred at step 5with N=1. Note that step 3 does not remove the selection, so step 4replaces the content of the document with a copy of itself; the onlyvisible result is unmarking the selection. I wonder if this was whatMatthew intended?This observation is from master commit f78216d, fetched 2015-09-2102:45 UTC, configured ... CC=ccache /home/terry/lo_hacking/associated/gcc/bin/gcc CXX=ccache /home/terry/lo_hacking/associated/gcc/bin/g++ --enable-option-checking=fatal --enable-dbgutil --enable-crashdump --without-system-postgresql --without-myspell-dicts --with-extra-buildid --without-doxygen --with-external-tar=/home/terry/lo_hacking/git/src --disable-gstreamer-1-0 --enable-gstreamer-0-10 --disable-gtk3built on debian-wheezy with local-built gcc 5.2.0 and its systemlibraries, running chroot'd to debian-sid.*Createdbacktraces compared, Win vs. LinuxI have tried to align the backtraces from Windows and Linux, lookingonly at the function names. Is this helpful? Guidance welcome.Would be great to get a dev to look into this crasher for Writer, as the crasher has become more easily triggerable in recent versions.Cannot repro crash with steps fromor 11 anymore. I wonder, if something really changed? Plz retest, guys.Win 7 Pro 64-bit Version: 5.1.0.0.alpha1+Build ID: fcc2415ade6ae93710bbbda9f7e163045e323105TinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-10-21_16:55:13Locale: fi-FI (fi_FI)I am unable to reproduce this bug. using debian and libreoffice Version: 4.3.3.2Build ID: 430m0(Build:2)Version: 5.1.0.3Build ID: 5e3e00a007d9b3b6efb6797a8b8e57b51ab1f737CPU Threads: 2; OS Version: -; UI Render: default; Locale: en-US (en.UTF-8)OS X 10.9I can reproduce the crash with the steps fromwith N=18, backtrace:Program received signal EXC_BAD_ACCESS, Could not access memory.Reason: KERN_INVALID_ADDRESS at address: 0x00000000000000180x000000011c585094 in SwNoTextFrame::HasAnimation ()(gdb) bt#0 0x000000011c585094 in SwNoTextFrame::HasAnimation ()#1 0x000000011c6773ea in SwFEShell::SelectObj ()#2 0x000000011cd2fa68 in SwWrtShell::Do ()#3 0x000000011cc05e39 in SwBaseShell::ExecUndo ()#4 0x0000000100d12408 in SfxDispatcher::Call_Impl ()#5 0x0000000100d0d39c in SfxBindings::Execute_Impl ()#6 0x0000000100d457fc in SfxDispatchController_Impl::dispatch ()#7 0x0000000100d43f27 in SfxOfficeDispatch::dispatch ()#8 0x0000000111e88c34 in framework::MenuBarManager::Select ()#9 0x0000000111e88569 in framework::MenuBarManager::LinkStubSelect ()#10 0x0000000102a46c3d in Menu::Select ()#11 0x0000000102ab48d3 in ImplWindowFrameProc ()#12 0x0000000102d40f93 in AquaSalInstance::DoYield ()#13 0x0000000102cce29e in Application::Yield ()#14 0x0000000102cce238 in Application::Execute ()#15 0x000000010007c7a2 in desktop::Desktop::Main ()#16 0x0000000102cd2472 in ImplSVMain ()#17 0x0000000102d40be4 in AquaSalInstance::handleAppDefinedEvent ()#18 0x0000000102d758a4 in -[VCL_NSApplication sendEvent:] ()#19 0x00007fff8d1839f9 in -[NSApplication run] ()#20 0x00007fff8d16e783 in NSApplicationMain ()#21 0x0000000102d3fef9 in ImplSVMainHook ()#22 0x0000000102cd309a in SVMain ()#23 0x00000001000a71b9 in soffice_main ()#24 0x0000000100000f20 in main ()Could not reproduce usingVersion: 5.2.0.0.alpha0+Build ID: 29ad0f5d16c9f27fa3d12c3d1337a70cec976bbbCPU Threads: 8; OS Version: Windows 6.1; UI Render: default; Locale: de-DE (de_DE)Tried three times, with more or less graphics (different types). Got a crash after all undo after third try when starting to type, tried to reproduce, but seems not related (crash was in ImplBorderWindow::InitView() due to mpWindowImpl looking bad), could not recreate.Createdconsole bt logsOn pc Debian x86-64 with master sources updated today (+enable-dbgutil), I could reproduce the crash.I attached console logs, bt + some gdb infos about the assertWhen I select all, copy and paste I get internally a select area, a copy of that to a temp doc, delete of the selection and a paste from the temp doc to the document.From the "delete" the graphic is not deleted, but it is pasted to the temp doc and pasted into the document. At this point there is two graphics. The undo seems to be "out" by the number of nodes involved in a graphic.Seems to me that all would be a lot easier if anchored to paragraph acted like anchored to last character of the paragraphI confirm this still exists, by following the steps in, in LO5.3.0alpha.I note the instructions had to be interpreted a bit - when "insert image", actually needed an extra paragraph (blank for me) at the end, before copying.I inserted a GIF file.I've seen this before and did not know why it happened, very good we have steps to reproduce.Debian. Local build:Build ID: 01cad4990d41ed06bb9c0504cef397121ee470f3(2016-08-25)would be great to have a trace with debugging symbols on Linux or Windows - ultimately it looks like a NULL pointer de-reference =) could we bisect it ? =)@MichaelWhat kind of trace do you want? We have backtraces on Linux andWindows. In a recent dbgutil build on Linux, I see the same functionnames from the assertion down to about (IIRC) frame 48.In, Matthew Francis reports reproducing the problem withversions "back to the year dot". I think this forecloses thepossibility of bisecting the bug, right?I note that this bug covers at least an assertion (comments 12 and19), an access violation (comments 4 and 7), and "Fatal Error"(description and), as well as unspecific "crash". Would itbe useful to split off the assertion, for example, into a separate bugreport? My rationale for including the assertion, back at,was merely that it happened with the same STR.Ah - yes, I see your nice trace now Terrence - thanks for that =) if it is an ancient bug, then yes no point in bisecting. The last thing that would be useful would be a valgrind trace - in case it is a memory corruption issue (it seems un-reliable - so quite possibly) rather than a simple logic bug.Thanks !crashreport.libreoffice.org/stats/crash_details/beeff8a3-445c-4f90-8354-7929bd97ba46 forCreatedDrMemory logs.zipAre those of help instead of valgrind? It's Windows access violation.Unfortunately the drmemory trace doesn't appear to show the crash itself, but has a lot of leak reports instead, many of which may be false positives. I'd really prefer a valgrind trace including the real crash, if we can get it; thanks !For those wanting to do a valgrind, you can find instructions here.CreatedValgrind traceOn pc Debian x86-64 with master sources updated today, I retrieved a Valgrind traceThanks Julien - so not a memory corruption then ! just a logic error:warn:svl:2367:1:svl/source/undo/undo.cxx:1171: SfxUndoManager::MarkTopUndoAction(): suspicious call!warn:legacy.osl:2367:1:sw/source/core/attr/calbck.cxx:162: Client inserted while in Modifywarn:legacy.osl:2367:1:sw/source/core/access/acccontext.cxx:442: fire event for disposed frame?warn:legacy.osl:2367:1:sw/source/core/access/acccontext.cxx:442: fire event for disposed frame?warn:sw.core:2367:1:sw/source/core/attr/calbck.cxx:171: a 21SwAccessibleParagraph client added as listener to a 16SwTextFormatColl during client iteration.warn:legacy.osl:2367:1:sw/source/core/access/accmap.cxx:1027: invalid event combinationwarn:legacy.osl:2367:1:sw/source/core/doc/DocumentContentOperationsManager.cxx:2933: splitting non-text node?warn:legacy.osl:2367:1:sw/source/core/undo/rolbck.cxx:517: SwHistoryChangeFormatColl: no ContentNodesoffice.bin: /home/julien/lo/libreoffice/sw/source/core/layout/atrfrm.cxx :1546 : void SwFormatAnchor::SetAnchor(const SwPosition*): l'assertion « !pPos || ((FLY_AT_FLY == nAnchorId) && dynamic_cast<SwStartNode*>(&pPos->nNode.GetNode())) || (FLY_AT_PARA == nAnchorId && dynamic_cast<SwTableNode*>(&pPos->nNode.GetNode())) || dynamic_cast<SwTextNode*>(&pPos->nNode.GetNode()) » a échoué.
id=94350	CreatedsampleSteps:1) Open attached file2) Enter chart edit mode3) Format the data series by setting area to none and set border style to continuous4) Format chart area and change area fill from color to gradient5) CrashRegression as this doesnt happen in 4.4 daily. Possible vclptr? Seems very similar toand.Version: 5.0.3.0.0+Build ID: 4ae70fd6c93087ce66c76d3102ad678bcf01dbf5TinderBox: Linux-rpm_deb-x86_64@46-TDF, Branch:libreoffice-5-0, Time: 2015-09-18_11:42:55Locale: en-US (en_US.UTF-8) Just for the record, on pc Debian x86-64 with master sources updated yesterday, I don't reproduce this.I can't reproduce with:Win10x64Version: 5.0.2.2 (x64) Build ID: 37b43f919e4de5eeaca9b9755ed688758a8251feVersion: 5.0.3.0.0+ Build ID: 4ae70fd6c93087ce66c76d3102ad678bcf01dbf5-GL TinderBox: Win-x86@62-merge-TDF, Branch:libreoffice-5-0, Time: 2015-09-18_12:03:30Version: 5.1.0.0.alpha1+ Build ID: ac226443522c55ab75cab8eed354b999052135a7 TinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-09-18_23:26:58If with a clean reset it happens, then try if some option in Menu/Tools/Options/LibreOffice/View - Graphics outputhas any effect on it.CreatedbacktraceVersion: 5.1.0.0.alpha1+Build ID: 2dea4d270806f47a324cb09c1db7751499930cf7TinderBox: Linux-rpm_deb-x86_64@70-TDF-dbg, Branch:master, Time: 2015-09-19_04:51:40Locale: en-US (en_US.UTF-8)(In reply to Yousuf (Jay) Philips from)Another one to the collection ofand related bugs.No repro.Win 7 Pro 64-bit Version: 5.1.0.0.alpha1+ (x64)Build ID: 9ce08dcc2e32c5554ddf71b79173f8854e0568adTinderBox: Win-x86_64@62-TDF, Branch:MASTER, Time: 2015-09-17_21:43:51Locale: en-US (fi_FI)Was also able to reproduce this with the following steps:1) Open Writer2) Insert Chart3) Enable 3d look in chart type dialog4) Select various data types and then the legend5) Change chart area fill to gradient6) Undo if it hasnt crashed7) Repeat steps 4 to 6 until it crashes, which normally happens on the 3rd attempt for me, but sometimes it takes longer(In reply to Yousuf (Jay) Philips from)Tried this ~8 times, but no crash.Win 7 Pro 64-bit Version: 5.1.0.0.alpha1+ (x64)Build ID: 9ce08dcc2e32c5554ddf71b79173f8854e0568adTinderBox: Win-x86_64@62-TDF, Branch:MASTER, Time: 2015-09-17_21:43:51Locale: en-US (fi_FI)*** This bug has been marked as a duplicate of***
id=94689	I get a crash if I do:1. Start LibreOffice Calc or Writer.2. Click the "New" toolbar button to create a new file.3. Close the new window ("Untitled 2") by clicking the cross icon in the caption bar.4. From the File menu select "Open...".Also tested Impress, problem does not occur.Using LO 5.0.2.2 on Microsoft Windows 7 Professional (version 6.1, build 7601: SP1) I only see the cross icon, when I have one document open.Trick for weird things like this:Win 7 Pro 64-bit, Version: 5.0.2.2 (x64)Build ID: 37b43f919e4de5eeaca9b9755ed688758a8251feLocale: fi-FI (fi_FI)I tested on another computer, same Windows version. I deleted %APPDATA%\Roaming\LibreOffice to create a new profile.The crash still occurred following the steps listed.If you don't see a cross icon, pressing Alt+F4 or double-clicking the icon in the top left also reproduces the problem in my tests.I am unable to make it crash.I asked a colleague to try this and he could reproduce the issue by following the steps. He's using Microsoft Windows 10.Sorry, I was able to make it crash in 5.0.2 after all :)Not crashing in 5.1, though.. Maybe it was already noticed and fixed? I could not find a duplicate report. Let's try to remember to test with 5.0.3 RC1 when it is released:Not crashing in 4.3, marking as regression.Win 7 Pro 64-bit, Version: 5.0.2.2 (x64)Build ID: 37b43f919e4de5eeaca9b9755ed688758a8251feLocale: fi-FI (fi_FI)Version: 5.1.0.0.alpha1+Build ID: 25de5cfa43b2b1cb7d7214470acc7719839e13feTinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-10-01_08:49:54Locale: en-US (fi_FI)CreatedBacktrace of crash on Windows 5.0.2Trace is:'this' is NULL here. sclo.dll!ScDocShell::Execute(SfxRequest & rReq) Line 1102 C++ case SID_OPEN_CALC: { SfxStringItem aApp(SID_DOC_SERVICE, OUString("com.sun.star.sheet.SpreadsheetDocument")); SfxStringItem aTarget(SID_TARGETNAME, OUString("_blank")); GetViewData()->GetDispatcher().Execute( SID_OPENDOC, SfxCallMode::API|SfxCallMode::SYNCHRON, &aApp, &aTarget, 0L); }So presumably GetViewData is NULL ... - hmm... sclo.dll!SfxStubScDocShellExecute(SfxShell * pShell, SfxRequest & rReq) Line 1060 C++ sfxlo.dll!SfxShell::CallExec(void (SfxShell *, SfxRequest &) * pFunc, SfxRequest & rReq) Line 210 C++ sfxlo.dll!SfxDispatcher::Call_Impl(SfxShell & rShell, const SfxSlot & rSlot, SfxRequest & rReq, bool bRecord) Line 261 C++ sfxlo.dll!SfxDispatcher::_Execute(SfxShell & rShell, const SfxSlot & rSlot, SfxRequest & rReq, SfxCallMode eCallMode) Line 849 C++ sfxlo.dll!SfxBindings::Execute_Impl(SfxRequest & aReq, const SfxSlot * pSlot, SfxShell * pShell) Line 1282 C++ sfxlo.dll!SfxDispatchController_Impl::dispatch(const com::sun::star::util::URL & aURL, const com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> & aArgs, const com::sun::star::uno::Reference<com::sun::star::frame::XDispatchResultListener> & rListener) Line 845 C++ sfxlo.dll!SfxOfficeDispatch::dispatch(const com::sun::star::util::URL & aURL, const com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> & aArgs) Line 359 C++ fwklo.dll!framework::MenuBarManager::Select(Menu * pMenu) Line 1037 C++ fwklo.dll!framework::MenuBarManager::LinkStubSelect(void * instance, void * data) Line 973 C++ vcllo.dll!Link<void *,long>::Call(void * data) Line 127 C++ vcllo.dll!Menu::Select() Line 303 C++ vcllo.dll!Menu::ImplCallSelect(void * __formal) Line 2205 C++ vcllo.dll!Menu::LinkStubImplCallSelect(void * instance, void * data) Line 2201 C++ vcllo.dll!Link<void *,long>::Call(void * data) Line 127 C++ vcllo.dll!ImplHandleUserEvent(ImplSVEvent * pSVEvent) Line 2041 C++ vcllo.dll!ImplWindowFrameProc(vcl::Window * _pWindow, SalFrame * __formal, unsigned short nEvent, const void * pEvent) Line 2593 C++ vcllo.dll!SalFrame::CallCallback(unsigned short nEvent, const void * pEvent) Line 247 C++Interesting; the explanation is quite 'simple' ;-) there is an ordering change caused by the Idle re-work; and two idle handlers race each other:an asynchronous focus handling [ huh ] ... races with the 2nd trace: sfxlo.dll!SfxFrameWindow_Impl::GetFocus() Line 174 C++ vcllo.dll!vcl::Window::CompatGetFocus() Line 3975 C++ vcllo.dll!vcl::Window::ImplGrabFocus(unsigned short nFlags) Line 388 C++ vcllo.dll!vcl::Window::GrabFocus() Line 3153 C++ tklo.dll!VCLXWindow::setFocus() Line 1024 C++ fwklo.dll!`anonymous namespace'::Frame::focusGained(const com::sun::star::awt::FocusEvent & aEvent) Line 2346 C++ tklo.dll!FocusListenerMultiplexer::focusGained(const com::sun::star::awt::FocusEvent & evt) Line 76 C++ tklo.dll!VCLXWindow::ProcessWindowEvent(const VclWindowEvent & rVclWindowEvent) Line 587 C++ tklo.dll!VCLXWindow::WindowEventListener(VclSimpleEvent * pEvent) Line 419 C++ tklo.dll!VCLXWindow::LinkStubWindowEventListener(void * instance, void * data) Line 408 C++ vcllo.dll!Link<void *,long>::Call(void * data) Line 127 C++ vcllo.dll!VclEventListeners::Call(VclSimpleEvent * pEvent) Line 64 C++ vcllo.dll!vcl::Window::CallEventListeners(unsigned long nEvent, void * pData) Line 217 C++ vcllo.dll!vcl::Window::PreNotify(NotifyEvent & rNEvt) Line 71 C++ vcllo.dll!SystemWindow::PreNotify(NotifyEvent & rNEvt) Line 185 C++ vcllo.dll!vcl::Window::CompatPreNotify(NotifyEvent & rNEvt) Line 3998 C++ vcllo.dll!ImplCallPreNotify(NotifyEvent & rEvt) Line 61 C++ vcllo.dll!vcl::Window::ImplGrabFocus(unsigned short nFlags) Line 386 C++ vcllo.dll!vcl::Window::GrabFocus() Line 3153 C++ vcllo.dll!vcl::Window::ImplAsyncFocusHdl(void * __formal) Line 1806 C++ vcllo.dll!vcl::Window::LinkStubImplAsyncFocusHdl(void * instance, void * data) Line 1782 C++ vcllo.dll!Link<void *,long>::Call(void * data) Line 127 C++ vcllo.dll!ImplHandleUserEvent(ImplSVEvent * pSVEvent) Line 2041 C++ vcllo.dll!ImplWindowFrameProc(vcl::Window * _pWindow, SalFrame * __formal, unsigned short nEvent, const void * pEvent) Line 2593 C++ vcllo.dll!SalFrame::CallCallback(unsigned short nEvent, const void * pEvent) Line 247 C++ vcllo.dll!ImplHandleUserEvent(HWND__ * hWnd, long lParam) Line 4130 C++ vcllo.dll!SalFrameWndProc(HWND__ * hWnd, unsigned int nMsg, unsigned int wParam, long lParam, int & rDef) Line 5786 C++ vcllo.dll!SalFrameWndProcW(HWND__ * hWnd, unsigned int nMsg, unsigned int wParam, long lParam) Line 5945 C++ user32.dll!_InternalCallWinProc@20() Unknown user32.dll!_UserCallWinProcCheckWow@32() Unknown user32.dll!_CallWindowProcAorW@24() Unknown user32.dll!_CallWindowProcW@20() Unknown opengl32.dll!_wglWndProc@16() Unknown user32.dll!_InternalCallWinProc@20() Unknown user32.dll!_UserCallWinProcCheckWow@32() Unknown user32.dll!_DispatchMessageWorker@8() Unknown user32.dll!_DispatchMessageW@4() Unknown vcllo.dll!ImplSalDispatchMessage(tagMSG * pMsg) Line 600 C++ vcllo.dll!ImplSalYield(bool bWait, bool bHandleAllCurrentEvents) Line 616 C++ vcllo.dll!WinSalInstance::DoYield(bool bWait, bool bHandleAllCurrentEvents, unsigned long nReleased) Line 676 C++ vcllo.dll!ImplYield(bool i_bWait, bool i_bAllEvents, const unsigned long nReleased) Line 358 C++ vcllo.dll!Application::Yield() Line 386 C++ vcllo.dll!Application::Execute() Line 336 C++ sofficeapp.dll!desktop::Desktop::Main() Line 1607 C++ vcllo.dll!ImplSVMain() Line 169 C++ vcllo.dll!SVMain() Line 207 C++ sofficeapp.dll!soffice_main() Line 96 C++ soffice.bin!sal_main() Line 48 C soffice.bin!main(int argc, char * * argv) Line 47 C soffice.bin!WinMain(void * _hinst, void * _dummy, char * _cmdline, int _nshow) Line 47 C soffice.bin!__tmainCRTStartup() Line 618 C soffice.bin!WinMainCRTStartup() Line 466 C kernel32.dll!@BaseThreadInitThunk@12() Unknown ntdll.dll!___RtlUserThreadStart@8() Unknown ntdll.dll!__RtlUserThreadStart@8() UnknownAfter this - an async (?) Close_Foo ...sfxlo.dll!SfxViewFrame::SetViewFrame(SfxViewFrame * pFrame) Line 3302 C++ sfxlo.dll!SfxViewFrame::Close() Line 1122 C++ sfxlo.dll!SfxFrame::DoClose_Impl() Line 170 C++ sfxlo.dll!SfxBaseController::dispose() Line 1030 C++ fwklo.dll!`anonymous namespace'::Frame::setComponent(const com::sun::star::uno::Reference<com::sun::star::awt::XWindow> & xComponentWindow, const com::sun::star::uno::Reference<com::sun::star::frame::XController> & xController) Line 1550 C++ fwklo.dll!`anonymous namespace'::Frame::close(unsigned char bDeliverOwnership) Line 1781 C++ fwklo.dll!framework::pattern::frame::closeIt(const com::sun::star::uno::Reference<com::sun::star::uno::XInterface> & xResource, bool bDelegateOwnership) Line 80 C++ fwklo.dll!framework::CloseDispatcher::implts_closeFrame() Line 492 C++ fwklo.dll!framework::CloseDispatcher::impl_asyncCallback(void * __formal) Line 360 C++ fwklo.dll!framework::CloseDispatcher::LinkStubimpl_asyncCallback(void * instance, void * data) Line 244 C++ vcllo.dll!Link<void *,long>::Call(void * data) Line 127 C++ vcllo.dll!vcl::EventPoster::DoEvent_Impl(vcl::UserEvent * pEvent) Line 54 C++ vcllo.dll!vcl::EventPoster::LinkStubDoEvent_Impl(void * instance, void * data) Line 49 C++ vcllo.dll!Link<void *,long>::Call(void * data) Line 127 C++ vcllo.dll!ImplHandleUserEvent(ImplSVEvent * pSVEvent) Line 2041 C++ vcllo.dll!ImplWindowFrameProc(vcl::Window * _pWindow, SalFrame * __formal, unsigned short nEvent, const void * pEvent) Line 2593 C++ vcllo.dll!SalFrame::CallCallback(unsigned short nEvent, const void * pEvent) Line 247 C++ vcllo.dll!ImplHandleUserEvent(HWND__ * hWnd, long lParam) Line 4130 C++ vcllo.dll!SalFrameWndProc(HWND__ * hWnd, unsigned int nMsg, unsigned int wParam, long lParam, int & rDef) Line 5786 C++ vcllo.dll!SalFrameWndProcW(HWND__ * hWnd, unsigned int nMsg, unsigned int wParam, long lParam) Line 5945 C++ user32.dll!_InternalCallWinProc@20() Unknown user32.dll!_UserCallWinProcCheckWow@32() Unknown user32.dll!_CallWindowProcAorW@24() Unknown user32.dll!_CallWindowProcW@20() Unknown opengl32.dll!_wglWndProc@16() Unknown user32.dll!_InternalCallWinProc@20() Unknown user32.dll!_UserCallWinProcCheckWow@32() Unknown user32.dll!_DispatchMessageWorker@8() Unknown user32.dll!_DispatchMessageW@4() Unknown vcllo.dll!ImplSalDispatchMessage(tagMSG * pMsg) Line 600 C++ vcllo.dll!ImplSalYield(bool bWait, bool bHandleAllCurrentEvents) Line 616 C++ vcllo.dll!WinSalInstance::DoYield(bool bWait, bool bHandleAllCurrentEvents, unsigned long nReleased) Line 676 C++ vcllo.dll!ImplYield(bool i_bWait, bool i_bAllEvents, const unsigned long nReleased) Line 358 C++ vcllo.dll!Application::Yield() Line 386 C++ vcllo.dll!Application::Execute() Line 336 C++ sofficeapp.dll!desktop::Desktop::Main() Line 1607 C++ vcllo.dll!ImplSVMain() Line 169 C++ vcllo.dll!SVMain() Line 207 C++ sofficeapp.dll!soffice_main() Line 96 C++ soffice.bin!sal_main() Line 48 C soffice.bin!main(int argc, char * * argv) Line 47 C soffice.bin!WinMain(void * _hinst, void * _dummy, char * _cmdline, int _nshow) Line 47 C soffice.bin!__tmainCRTStartup() Line 618 C soffice.bin!WinMainCRTStartup() Line 466 C kernel32.dll!@BaseThreadInitThunk@12() Unknown ntdll.dll!___RtlUserThreadStart@8() Unknown ntdll.dll!__RtlUserThreadStart@8() UnknownSets that baby to zero (from another idle handler ...)This breaks the assumption that we will always get a focus -after- the close is done ...What an ugly heap ! =) we need to get the ordering right (or better) to aggressively de-lame-ify the Window/VCL <-> Sfx interaction.Interestingly, after poking at the main-loop for a while I discovered that these are both posted events; so either we're posting them in the wrong order, or emitting them in the wrong order; either being interesting =)Urgh - this bug is a horror - it would be fantastic to have a bibisect of it, we're loosing focus events (somehow) - but quite how is really unclear.Thanks !This is Windows-only.Not reproduced on Linux.Ubuntu 15.10 64-bit Version: 5.0.2.2Build ID: 00m0(Build:2)Locale: en-US (en_US.UTF-8)Createdbibisect logLaszlo - thanks for the bibisect =) am I reading the trace right - does it get us down to just this one commit:git log b9f95769495e8d9885b64f1d68118336a4fc8d38..7aae8772aa18744cb1bbd8348272be99cc882c47commit 7aae8772aa18744cb1bbd8348272be99cc882c47Author: Michael Meeks <>Date: Fri Jun 5 16:37:49 2015 +0100 Clear VclPtr instance reference on removed UserEvents.Thanks, Michael. I tried to bibisect the commit, that fixed this problemin 5.1, and I have got the following one:commit 187445b2d2885ced92be37ffb11cd2a9bb11f8d6Author: Laurent Godard <>Date: Mon Jun 8 10:24:42 2015 +0200 Uno api sidebar unit test tdf#91806 - python test subsequentcheck - correct deck setTitle APi (UI update) - enhance UnoInProcess for flexiility in loading parameterI found the relevant line in it, checked successfully in lo-5-0, andpushed commit to the gerrit:Nice work - thanks Laszlo ! =) pushed to 5-0László Németh committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#94689 fix crash on new file, close file, open fileIt will be available in 5.0.5.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.LibreOffice crashed for me on Windows, but I was not able to recreate the steps to reproduce it; hence I could not write a bug.Thank you for fixing this bug.Fixing is verified in a fresh libreoffice-5-0 build.Michael: thanks for the review and pushing.Óvári: thanks for your comment, I hope, this fix will solve your problem with the next bug fix release of LibreOffice 5.0.Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=94772	CreatedSample fileLibreoffice cannot save certain .odt files. These files were all created with earlier versions of Libreoffice (< 4.3) and contain a large number of mathematical formulas. I first noticed this problem after upgrading to Libreoffice 5.0, however I have also experienced the same problem after downgrading to 4.4.5.Libreoffice has no problem opening the files. However, once the file is modified and a save attempt is made, the following error window comes up:"Error saving the document XXX: General Error: General input/output error." Versions: This bug appears when using Libreoffice 5.0.* and 4.4.5. Openoffice 4.1.1 has no problem opening and saving the same file.OS: This bug was reproducible on MAC-OSX 10.9 and 10.11. I attempted to reproduce the bug using Libreoffice 5.0.2 on Windows 7 and Ubuntu 14.04 but could not.I tried to create a new empty writer file using Libreoffice 5.0.2.2, and paste the contents of the old file into the new file. I am unable to save the new file (same error). I also tried completely wiping Libreoffice from the disk (including Library/Application Support/Libreoffice) and reinstalling, but this made no difference.Interestingly enough, I can open one of these files, select "Save As", choose a new filename, and I am able to save the file. However, if I close and reopen Libreoffice, and then try to edit the new file, the same bug reappears.I have attached a sample file "NOTES1.odt". In addition, Libreoffice appears to create a log file when the save fails called "document_io_logring.txt". I have pasted the contents below.**********************37b43f919e4de5eeaca9b9755ed688758a8251feRethrowBad Zip File, ZipException: Zip END signature not found!RethrowElement does not exist and cannot be created: "Meta.xml"RethrowRethrow/lo/rel50/sfx2/source/doc/objstor.cxx:414: Rethrow/lo/rel50/sfx2/source/doc/objmisc.cxx:260: Resetting Error.Bad Zip File, ZipException: Zip END signature not found!RethrowBad Zip File, ZipException: Zip END signature not found!RethrowElement does not exist and cannot be created: "Meta.xml"Rethrow(THIS REPEATS MANY TIMES)Rethrow/lo/rel50/sfx2/source/doc/objstor.cxx:414: Rethrow/lo/rel50/sfx2/source/doc/objmisc.cxx:260: Resetting Error.Bad Zip File, ZipException: Zip END signature not found!Rethrow/lo/rel50/sw/source/uibase/app/docsh.cxx:498: /lo/rel50/sfx2/source/doc/objmisc.cxx:260: Resetting Error./lo/rel50/sfx2/source/doc/sfxbasemodel.cxx:3124: Storing failed! Confirming onVersion: 5.0.2.2Build ID: 37b43f919e4de5eeaca9b9755ed688758a8251feLocale : fr-FR (fr.UTF-8)regressionWorks fine inVersion: 4.2.4.2Build ID: 63150712c6d317d27ce2db16eb94c2f3d7b699f8Also works properlyonVersion: 4.3.5.2Build ID: 3a87456aaa6a95c63eea1c1b3201acedf0751bd5Migrating Whiteboard tags to Keywords: (bibisectRequest)[NinjaEdit]I am bumping this to highest.Reason: Native format, using strictly LibreOffice (older versions) so this is an intra-program regression using completely native formats. A bibisect would really help move this forward.Did a test with the release candidate LibreOffice 5.1.0.3. That version complained that the file was corrupt. It asked if I wanted to repair the file, so I did and after that everything seems fine. I haven't looked to closely at the file but it seems all formulas etc. is there. Could someone try it with the latest version of LibreOffice Fresh to see if this is fixed there as well.I tested the file with the released version 5.0.1.3, and it worked (no complaints of a corrupt file, it just appeared to save normally). I also tried with several other files that I had which had similar problems, and they all appear to work with the latest release version.
id=94809	CreatedSymbola.docxVersion: 5.0.2.2 (x64)Build ID: 37b43f919e4de5eeaca9b9755ed688758a8251feLocale: en-US (en_US)andVersion: 5.0.2.2Build ID: 00m0(Build:2)Locale: en-US (en_US.UTF-8)Attempting to open the attached Symbola.docx file results in:SEH Exception: ACCESS VIOLATIONTested in Windows 10 & Linux. Opens without issue in Apache OpenOffice 4.1.1 and Kingsoft WPS Writer (both Windows and Linux versions).Note: This does not appear to be a duplicate of 93779 as that bug deals with opening an external application.Full zip of with the attached .docx enclosed is available at:(Symbola Symbol blocks of The Unicode Standard) Reproduced.Opens ok with 4.3.0.1 (takes a while).Win 7 Pro 64-bit, Version: 5.0.2.2 (x64)Build ID: 37b43f919e4de5eeaca9b9755ed688758a8251feLocale: fi-FI (fi_FI)Version: 5.1.0.0.alpha1+Build ID: f830600ece806ec365a4839e79afabe183c5e36dTinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-10-06_22:49:09Locale: en-US (fi_FI)CreatedBacktrace of crash on Windows 5.0.2(In reply to Beluga from)Summary -> Adding [Crash]I believe that this is a duplicate ofwhich is fixed in master and recently backported to the 5.0 series*** This bug has been marked as a duplicate of***(In reply to Caolán McNamara from)Yep, now that I tested again, it only takes some time to open with 5.1.Migrating Whiteboard tags to Keywords: (bibisectRequest)[NinjaEdit]
id=94804	CreatedDocument with error example.I added cross references to the Items listed in the attached file and after i reload the file using FILE-> Reload the cross references are broken.File should look like this:1 References1.1 Build Specifications[1.0] Tester[1.1] x64 BK Driver[1.2] SystemInstallera) Build Tester by right clicking and selecting build.b) Build x64 BK Driver by right clicking and selecting build.c) Build SystemInstaller by right clicking and selecting build. If additional media is requested obtain it from referenced sources.but instead looks like this:1 References1.1 Build Specifications[1.0] Tester[1.1] x64 BK Driver[1.2] SystemInstallera) Build Tester by right clicking and selecting build.b) Build Error: Reference source not found by right clicking and selecting build.c) Build Error: Reference source not found by right clicking and selecting build. If additional media is requested obtain it from referenced sources. Hi Taylo,Thanks for your report.I confirm the problem...1. Open test file2. Ctrl+F2 > Cross references > Numbered paragraphs .. insert one or more3. Save, Close, Reopen > references are shown in a flash, but then it is destroyed.TODOCheck duplicatesCheck version (bibisect)No problem in 4.4.3.2, problem in all later versions***has been marked as a duplicate of this bug. ***Createdcross-reference-numbered paragraphThe same behavior in LO 5.0.1 and 5.0.2 and also if you use cross-reference directly to numbered paragraph - see attached file (open and update fields).This is a critical bug, because every .odt file with cross-references is broken after re-opening it.Createdbibisect logSee bibisect log for details.Each time a new cross reference is inserted a new bookmark is put around the source. These duplicated bookmarks are removed by the patch of 90808 Such duplicates should not be created. The reason for the duplicates is that the inserted mark is of type MarkType::CROSSREF_NUMITEM_BOOKMARK but after save&reload this is converted to a MarkType::CROSSREF_HEADING_BOOKMARK.Now the next insertion cannot find the CROSSREF_NUMITEM_BOOKMARK at the given position and inserts a new one.I am seeing this extensively in Writer for Windows, all versions of LO5 and it was in later releases of 4 as well. About a third of cross-references typically affected.Interestingly, there can be several references to one target, and some fail while others work properly.Also, if you construct a cross-reference of several parts (eg "see clause 26.1(a)(i)" where each part of the clause number is individually referenced) you can get partial failure eg the above reference could appear as:"See clause 26.1[Error-not found!](i)"If you delete and recreate a broken reference, it will fail again every time. But a reference that survives the first reload is stable forever.Normally, if you open the affected file in LO for Mac, there's no problem. The Windows version is far worse affected.This is an important one. In our case, it makes LO unusable in a law office.The only way I could fix the problems was:1) Revert back to LO 3.4.72) Completely remove the faulty cross-references from the document3) Close the document; quit LO4) Reopen everything5) Insert the x-references anewConclusion from these observations: x-references have been erratic all through LO 4 and 5 (thus far). Thank you big time for addressing that.thanks Oliver for fixing the root cause.regression from commit 679faffc68bb854af0f55d0f218698e2f372f00blooks to me there are 2 problems here, firstly the merge problem abovecausing heading-reference to be created instead of numbering-references,second is that in 4.4.x the heading-references stopped working inthis case.commit 9d0c51daea67104349cac26de9839afa8baeb099Author: Michael Stahl <>AuthorDate: Fri May 15 23:57:04 2015 +0200 tdf#90808: sw: fix detection of duplicate CrossRefBookmarks The check for existing bookmark positions is using the wrong position. It must use the Start of the pam, because the constructor of CrossRefBookmark only uses the Start of the pam.so the versions since 4.2.0 or so would create these documentswhere there can be more than one "__RefHeading__" bookmarks on a singleparagraph: every time you try to insert a new CROSSREF_NUMITEM_BOOKMARKit will find that there is no CROSSREF_NUMITEM_BOOKMARK on the paragraphand then wrongly insert another CROSSREF_HEADING_BOOKMARK on it.then with the fix for, we will import only the first of theseCROSSREF_HEADING_BOOKMARK in ODF import, and throw the rest of them awaybecause they are duplicates.if you're lucky then the bookmark that survives is the one that isreferenced by all the fields; if not, then you get lots of"Error: Reference source not found" once you update fields.i'm afraid we'll have to add some horrible hack to load all these corrupted documents.i've added something sufficiently ugly on master now.Oliver Specht committed a patch related to this issue.It has been pushed to "master":tdf#94804: prefix to save cross reference bookmark fixedIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "master":tdf#94804 sw: allow duplicate heading cross reference bookmarksIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Oliver Specht committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#94804: prefix to save cross reference bookmark fixedIt will be available in 5.0.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Oliver Specht committed a patch related to this issue.It has been pushed to "libreoffice-4-4":tdf#94804: prefix to save cross reference bookmark fixedIt will be available in 4.4.7.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.thanks a lot!Hardly dare to ask, but since 4.4.6.2 and 5.0.3.2 are still to be run..Could this be more or less safely done with testing of ..?Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-4-4":tdf#94804 sw: allow duplicate heading cross reference bookmarksIt will be available in 4.4.7.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#94804 sw: allow duplicate heading cross reference bookmarksIt will be available in 5.0.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Verified fixed on LibreOffice 5.0.4.0+ built at home under Ubuntu 15.04 x86-64 with gcc 5.1. Thank you very much.Best regards. JBFOliver Specht committed a patch related to this issue.It has been pushed to "libreoffice-4-4-6":tdf#94804: prefix to save cross reference bookmark fixedIt will be available in 4.4.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-4-4-6":tdf#94804 sw: allow duplicate heading cross reference bookmarksIt will be available in 4.4.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.I confirm fixing the bug in tested version: master~2015-10-18_04.55.50_LibreOfficeDev_5.1.0.0.alpha1 in Win7.But if i can ask, PLEASE(!), release this bug already in the 5.0.3 version and ASAP. I do not know if you understand, how CRITICAL this bug is. I work in a small office using LO, but almost every document we use contains Cross-references, which caused we CAN NOT WORK on existing documents in LO. Downgrading LO is not a solution, because the upgrade from 4.X to 5.X caused loss of all added personal icons in the Toolbars which was horrible, so we are now back on MS Office (using one LO 4.3 and saving everything as .doc) and waiting for fixing the bug in a stable version. My propose for the future - such (from the viewpoint of a user) CRITICAL bugs which causes LO NOT WORKING (because we really can not use the Writer now) should be fixed in a stable version ASAP although in the way the new stable version contains only this one fix...I second Orwel's plea. I am a business technology journalist, and I have raved about LO in the media, so I felt obliged to issue a warning in the national Australian press when this bug hit. It's that damaging to business usersI'm on-side too. But at the same time want to thank you all involved for helping with that nasty bug.Oliver Specht committed a patch related to this issue.It has been pushed to "libreoffice-5-0-3":tdf#94804: prefix to save cross reference bookmark fixedIt will be available in 5.0.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Thank you very much!I just installed the 5.0.3.2 (RC2) and the bug is still present although(should be not present yet). Tested on x64 version (Win7) with the().Could you take a look at this, because it is not fixed as mentioned.I confirm this from my end as well. The bug is still present in the fresh versions of the application.Looking further into this, it may be that references created with older (buggy) versions are the ones that get corrupted. If this is the case, and all we need to do is recreate them one last time, this could be a decent compromise (to many, I hope). However, I cannot find information about this anywhere. Thank you for your further input about this.I confirm the bug occurs on documents of older versions. A manual delete of a cross reference and setting a new one solve the problem. The problem is not solved, if you only re-change the cross-reference (this means, double click it and set it one more time, you have to delete it completely before).I am not sure if recreating the CR one last time suggested by Yvan Rose is meant as an automatically or manually process. It is a good solution if the process will be done automatically by LO. If you suggest to make it manual, this is a horrible vision for me and my colleagues.Imagine, there are hundreds of documents created/re-saved in older LO Version. Some of these documents have more than 10 sites. Doing it manually would cost us hours and hours of work, you have to read all the documents through and think where the cross reference should point to.Sorry for my next words as they are not directly concerned with the solution of the case:I was a big fan of LO, trying to support the LO team mainly with my free time (tests of beta versions, reporting bugs...) and sometimes also with small contributions, but this BUG (present for more than a month) is so terrible that I slowly loose my faith into this product, really. Understand, there are people using LO as the sole office suite. I do not think each bug has the same "weight". There are CRITICAL bugs (causing LO is NOT WORKING in its basic functions properly) and other bugs. This kind of bug is CRITICAL (in my eyes) and makes LO really unworkable with (at least in our small office where almost each document contains cross references and we often go back to old documents).The problem with cross references is long-continuing (let see the bug reports of the past), I remember problems with cross-references in LO 3.5. And the problem occurs repeatedly (solved and than again occurred) in many versions. I think a new Version of LO should be released after more testing. I can not believe this kind of CRITICAL bug where CROSS REFERENCES ARE NOT WORKING could be overlooked and not solved for a such long time.I stopped to use Microsoft Office many years ago because it drove me crazy with repeated bugs of formatting. I feel myself now the same.One more time sorry for this post, but I felt I have to write this words hoping some developers will read it and discuss it in the higher level of Document foundation...there were 2 fixes for this bug, one to fix the creation of new cross references, and one to fix the import of existing documents written by older versions that contain the bad cross references.unfortunately only the first fix got sufficient reviewers to be includedin time for the 5.0.3 release, while the second fix will only be in the 5.0.4release.since this obviously causes confusion i will remove the 5.0.3 from the bugzilla whiteboard.if you are affected by the bug then use LO 4.4.6 or wait for LO 5.0.4.(In reply to Michael Stahl from)Thanks for clarifying, Michael!checked in 4.4.6.3Both this issue and 94063 are fixed there.Adding my thanks here. I have been a supporter of LO for years now, providing my yearly donation and encouraging my students to join in. On the other hand, I too have been experiencing a little bit of what Orwel was voicing earlier, about the quality control side of things. Given my experience as software developer (designer --I don't to programming), I am fully aware that innovation typically comes at the cost of instability. But perhaps The Document Foundation could work on strengthening the testing side of things a little more. If I could anything to help in that respect, for example in terms of voicing my opinion to the right people, I certainly would. (Thank you for any input there, if any.)In the meantime, I am grateful for all the work that everyone has poured in LO, by far the best office suite out there.***has been marked as a duplicate of this bug. ***Varun Dhall committed a patch related to this issue.It has been pushed to "master":Added Test for tdf#94804 cross ref bookmarks created with wrong prefixIt will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Migrating Whiteboard tags to Keywords: (bibisected, dataLoss)[NinjaEdit]verified in 5.1.2.1 on Ubuntu 32 bits
id=94831	CreatedFile that crash LOA file containing an image from an https link does crashing LO.The link isMore, the image cannot be displayed in LO.The image is from an old LO or OpenOffice but a copy-paste works fine with this empty frame.To crash click-right on the empty image frame and try to compress the image. Yes this image does not exists in LO but LO must not crashed.Regards. All works fine in Microsoft Windows.So this issue seems to be specific to Linux (Debian Jessie 8).On pc Debian testing (updated today) x86-64 with LO Debian package 5.0.2.2, I don't reproduce the crash and can see the image (DC Volts...)With master sources updated today, I don't have crash but can't see the image.I noticed these kind of logs:(pkix_CacheCert_Add: PKIX_PL_HashTable_Add for Certs skipped: entry existedwarn:ucb.ucp.webdav:12592:9:ucb/source/ucp/webdav-neon/NeonSession.cxx:1660: Neon received http error: 'Server certificate verification failed: issuer is not trusted'warn:legacy.osl:12592:1:sw/source/core/graphic/ndgrf.cxx:594: Cannot swap in graphicwarn:legacy.osl:12592:1:sw/source/core/graphic/ndgrf.cxx:594: Cannot swap in graphicForgot to indicate this one too:warn:sfx.appl:12592:1:sfx2/source/appl/fileobj.cxx:326: Graphic error [1] - [] URL[]I can confirm crash with Version: 5.1.0.0.alpha1+Build ID: 83ef294dddf3b1ab5cd5f91a792a7d9413a08f1fTinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2015-09-20_07:00:46CreatedgdbtraceNo crash in LO 4.4.2, after compression I can see picture ->regressionThank you Raal for your very quick feedback.bt shows:#0 0x00007ffff62729f1 in JPEGWriter::Write(Graphic const&) () from /opt/libreofficedev5.1/program/libmergedlo.so#1 0x00007ffff6270722 in ExportJPEG(SvStream&, Graphic const&, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const*, bool*) () from /opt/libreofficedev5.1/program/libmergedlo.so --enable-mergedlibs related?Indeed, I tried again with master sources updated today, no image but no crash.Already crashing on 50max tag oldest (source-hash-2851ce5afd0f37764cbbc2c2a9a63c7adc844311) -- thus not a regression introduced in 50 => setting version to 4.4.0~beta1.Might still be bibisectable with e.g. a 44max repo.***has been marked as a duplicate of this bug. ***bibisect-44max: I can reproduce crash with oldest version in bibisect repo: Version: 4.3.0.0.alpha1+Build ID: c15927f20d4727c3b8de68497b6949e72f9e6e9eDoes this crash still happen with 5.0 or better 5.2? I can't crash with either versions.Migrating Whiteboard tags to Keywords: (bibisectRequest)[NinjaEdit](In reply to Joel Madero from)Yes Joel, 5.0.3.2 still do crash.Raal - can you try to bibisect this one with 44all? I can't crash it for the life of me (tested on a variety of packages)Matúš Kukan committed a patch related to this issue.It has been pushed to "master":tdf#94831: Check for null mpReadAccess before first useIt will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Matúš Kukan committed a patch related to this issue.It has been pushed to "libreoffice-5-1":tdf#94831: Check for null mpReadAccess before first useIt will be available in 5.1.0.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Matúš Kukan committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#94831: Check for null mpReadAccess before first useIt will be available in 5.0.5.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=94848	I'll attach a document that reliably crashes for me1. put focus in first paragraph2. open Styles and Formatting3. right click on style Title, choose Modify, click size 20, hit Enter for OK > crash Createddocument that crashes with changing styleChanging title: set (in particular document?) with question mark. It happens too (now and then?) with just a clean document, type foo, apply heading one, change font > CrashNB- tested with clean user profile- Has nothing to do with- crashes too when I use Galaxy (seethere)- Maybe related toQuery I used for checking(In reply to Cor Nouws from)click size 20 = Changed font size to 20.No crash.Win 7 Pro 64-bit, Version: 5.0.2.2 (x64)Build ID: 37b43f919e4de5eeaca9b9755ed688758a8251feLocale: fi-FI (fi_FI)(In reply to Beluga from)The document also crashes for me today..Maybe 32 Bits Linux ??No crash with v5.0.2.2 under mint 17.2 x64.tested again..1. fresh userprofile2. new text document3. type "this is the title" Enter, "more text"4. put cursor back in first line(turn autospellchecking off)5. context menu, Edit paragraph style6. click tab Font7. click size 208. Enter > CrashThis was, more or less, my original problem.Same when I set first line on heading 1 or leave it to default or open the context menu on the second line..or whatever..Now when I use the key board, what I usually do, the program does not crash..How is that for others?@Cor: Would be great to get a backtrace of that crash.(In reply to Cor Nouws from)With LO Debian package 5.0.2.2, I don't reproduce this.About putting cursor back in first line, could you be even more precise?1) with arrow key? with mouse?2) at the beginning of the first line, at the end of it?Also, did you enable accessibility option? If yes, could you disable it for the test?Maxim is right of course, if you can easily reproduce this, could you provide a backtrace?(In reply to Julien Nabet from)Makes no difference.Makes no difference.What option where?T > O > LOffice > Accesibility has one checked in the lower section and four in the upper. Mean that? Unchecking makes no difference.Will do.Createdbacktrace for 94848Let's put this one to NEW since we got a bt.--enable-mergelibs related?Crashing on 5.0.2 with Ubuntu packages (which use mergedlibs). Not reproducable on master (different UI).So:- reproducible with 5.0.2 release builds- NOT reproducible with master@c65ff0723f3b0df108bec006be6d5939d4999e10- NOT reproducible with 50max bibisect repo latestSo not bibisectable (at least with the 50max repo).The UI is different in the cases where it is not reproducible: The tab has three sections "Western Text Font", "Asian Text Font", "CTL Text Font". OTOH, when this is reproducible, there are no such sections and there are Pulldown Widgets instead of ListBoxes.Ok, this is reproducible on 50max latest, when you ensure first that on:Tools->Options->Language Settings->Languages->Default Languages for Documentsboth "Asian" and "Complex Text Layout" are NOT checked.Even with that, I cannot reproduce this on master, so I assume it has been fixed in the meantime.# bad: [dda106fd616b7c0b8dc2370f6f1184501b01a49e] source-hash-0db96caf0fcce09b87621c11b584a6d81cc7df86# good: [5b9dd620df316345477f0b6e6c9ed8ada7b6c091] source-hash-2851ce5afd0f37764cbbc2c2a9a63c7adc844311git bisect start 'latest' 'oldest'# good: [0c30a2c797b249d0cd804cb71554946e2276b557] source-hash-45aaec8206182c16025cbcb20651ddbdf558b95dgit bisect good 0c30a2c797b249d0cd804cb71554946e2276b557# good: [2ce02b2ce56f12b9fcb9efbd380596975a3a5686] source-hash-17d714eef491bda2512ba8012e5b3067ca19a5begit bisect good 2ce02b2ce56f12b9fcb9efbd380596975a3a5686# bad: [40875247f0002056effdf6d2fbe43627691cd86c] source-hash-93f0b14458a618ad575cd446680e5c4aa7d87bdcgit bisect bad 40875247f0002056effdf6d2fbe43627691cd86c# good: [07e62597be0600b763c4d18204799dcf09d2d3d9] source-hash-b2ead407c70f71974a1eac79df09072ff8bd0cc2git bisect good 07e62597be0600b763c4d18204799dcf09d2d3d9# good: [160904095d61878ae1483787bf25f4c4148365e4] source-hash-2049e3ec22db0684683261746188b40428a0d0e2git bisect good 160904095d61878ae1483787bf25f4c4148365e4# bad: [957b579081899413657c40feb8b41b5a43a8e55b] source-hash-74706c4057e027898022ac42de210302cdc92d99git bisect bad 957b579081899413657c40feb8b41b5a43a8e55b# bad: [4daa0b0b691bfc36e5924f61cc046142845c5d70] source-hash-f6d4cd396803f568ca667ed5e4d7725ade99b5dfgit bisect bad 4daa0b0b691bfc36e5924f61cc046142845c5d70# bad: [27de78aa6a89c81519f7882e2201a2fc4b6c5624] source-hash-f016ed2e4f7b8bec79fcaf8e4b566861a7b6ae76git bisect bad 27de78aa6a89c81519f7882e2201a2fc4b6c5624# bad: [8536df1e00d1bbdb1c2e66bde9ed551dff1a08d3] source-hash-4de83e2c322509c0fb1b989f7e4898728fc4a408git bisect bad 8536df1e00d1bbdb1c2e66bde9ed551dff1a08d3# bad: [a8db8c63e0bd595e16fbbffc49911b77bf94da96] source-hash-abce3f30ac8e1c1d40c76de611b6a10d00d7555cgit bisect bad a8db8c63e0bd595e16fbbffc49911b77bf94da96# good: [436a7ed41b8c084b15a17b95027e4d2785a94d97] source-hash-84c73c983577e33dda266bbfcdd89b9e1202906bgit bisect good 436a7ed41b8c084b15a17b95027e4d2785a94d97# bad: [442746c7621790af396a8b6b39c0ccebab02916c] source-hash-aef1826d9ca318a1359a2116e7f146e993413234git bisect bad 442746c7621790af396a8b6b39c0ccebab02916c# good: [53871cea909a0b86726f189bcfdab2890ffcf9e9] source-hash-a31991c4188e91326941fbe510ce70129d1ccde8git bisect good 53871cea909a0b86726f189bcfdab2890ffcf9e9# first bad commit: [442746c7621790af396a8b6b39c0ccebab02916c] source-hash-aef1826d9ca318a1359a2116e7f146e993413234So yet another vclptr fallout regression.for 5-0 backportDennis Francis committed a patch related to this issue.It has been pushed to "libreoffice-5-0":Resolves: tdf#94848 crash on focus with un-cleared but dead mpSubEditIt will be available in 5.0.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.I got a similar crash fromand picked that to -5-0 as well =)Thanks Caolan & Julien.Dennis Francis committed a patch related to this issue.It has been pushed to "libreoffice-5-0-3":Resolves: tdf#94848 crash on focus with un-cleared but dead mpSubEditIt will be available in 5.0.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***I can confirm, that with build 5.0.3.2 the issue now is gone.Migrating Whiteboard tags to Keywords: (bibisected)[NinjaEdit]
id=94924	Createdpartial screen shot of the same situation; original without 0 and incorrectly positive, test with added 0 on next line and correct negative result resultstrange bug found found since last version update, in a calc file, used for many years (bank account, the doc itself and its formulas can be considered as improved).Column D is for incomes;Column E is for outcomes;(hidden) column F is delta result of =D-Ewhen discovered this bug, I had 4 lines with only outcomes, but the results was ... positive.Evaluation by small formula helper was correct (negative)In a further line, if i put a 0 instead of empty cell in INcome, the 4 results turned to negative; if delete the 0, the four lines turned back to positive.Finally, i have set a space instead of the 0, making errors on all the followings lines, the delete back to an empty cell and ... everything back to normal (delta negative when outcome set, positive when income set).Strange, isn't it ?It seems that it's only happens when there is no more "incomes" in further lines, so the bug remains on lasts "outcomes" lines.I had to go back on every sheet ending with outcome lines and doing this space-enter-then-delete-content-of-cell woorkaround to get back correct values over the whole workbook. Hi @Dude76, thanks for reporting.Please could you attach a sample file, as minimal as possible (remember this is a public site) to reproduce the issue.Createdlight file sample reproducing the problemi have strongly enlight the original filevalues in F to line 39 (and to 60 if they were not empty) are OK and negative (outcomes)values from line 61 to 63 are OK and positives (incomes)following values, with no more incomes later, avec positive whereas they are outcomes, so it is KO !i have also noticed that there are impact (due to "false" positive values) on other dependants formulas results (ex : J64)i have put comments in the file too.yes, finaly i can;I believed that my previous "workaround" had definitively solved the problem but not, new values produced the same problem, and, worst, it had impacts the previous ones too :(F64 =D64-E64 = 0 - 665 = -665It's correct in Version: 5.1.0.0.alpha1+Build ID: 8273350ff48f198efc9dc9c5de5519b8cbdc0cb3TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2015-10-07_05:54:26It's incorrect in 5.0.2.2 (x64), win7, but correct after hard recalc (ctrl+shift+f9). Try to do hard recalc (ctrl+shift+f9).I did it. Bad results.The previous results that were "corrected" by the "workaround" are now bad.If with the same version you don't have the same bahavior, maybe it could indicate a corrupted installation ?I will uninstall / reboot / install.I didn't notice the problem in the previous version.Well, missed.re-download the installer, uninstall, reboot, install, the problem remains.other point noticed : when i put/delete a 0 below, it changes the value in F (as previously noticed) but it doesn't changes in cascades the other values.ex in the provided sample:D74: 0 -> F72=>-500 but G72 doesn't refresh the calculated value (could be done by forcing but, well, automatic re-computing is expected)For my trials the issue is in relation with the OpenCL:a) If it is active (Menu/Tools/LibreOffice/OpenCL - OpenCL options), entering zero in D72 produces -500 in F72, deleting the zero on D72 produces 500 in F72, wrong result.b) If it is deactivated, entering zero in D72 produces -500 in F72, deleting the zero on D72 produces -500 in F72, right result.Reproducible:Win10x64Version: 5.0.3.1 (x64) Build ID: fd8cfc22f7f58033351fcb8a83b92acbadb0749eVersion: 5.1.0.0.alpha1+ (x64) Build ID: 09fc6fef2d03ca8558dd6f0eec45d61ceb282cb5TinderBox: Win-x86_64@62-TDF, Branch:MASTER, Time: 2015-09-27_22:33:48Last working for me:Version: 4.4.7.0.0+ Build ID: 2ca166ebbe2adbd8f129403c7f8e5646c70ab67dTinderBox: Win-x86@51-TDF, Branch:libreoffice-4-4, Time: 2015-10-07_06:28:19Really a very bad issue for a spreadsheet.Really thanks (and congrats) for qualifying the origin of the bug.I feel less silly :)I confirm the behavior following the OPENCL setting on my file.Good luck/courage for solving it.Bests regards.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***.Sorry, but would it be possible to get an even simpler sample document that has just one simple description that says explicitly "the cell XX should be X, but with OpenCL turned on, it is Y"I find it hard to parse the comments in the existing Sample.ods...Or actually,is clear enough. (Empty or numeric zero in D72 has different impact on F72 depending on whether OpenCL is on or not.) Will use that to verify any fix I come up with.CreatedReduced sample fileAdded a reduced sample fileRemarkable, for verify the issue, on the reduced sample file with only a few data, reduce the value in:Menu/Tools/Options/LibreOffice calc/Formula - Detailed calculation settings - Custom - Minimum data size for OpenCL useto 2.Introducing a zero and deleting it on D3 changes the result in E3 from -500 to 500.With OpenCL disable result in E3 is always -500.Tor Lillqvist committed a patch related to this issue.It has been pushed to "master":tdf#94924: Fix handling of empty cells in OpenCL subtractionIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Tor Lillqvist committed a patch related to this issue.It has been pushed to "master":tdf#94924: Fix handling of empty cells in OpenCL divisionIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Tor Lillqvist committed a patch related to this issue.It has been pushed to "master":tdf#94924: Return correct #DIV/0! error from AVERAGE in the OpenCL caseIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Tor Lillqvist committed a patch related to this issue.It has been pushed to "master":tdf#94924: Return correct result 0 from OpenCL MIN and MAX when all args emptyIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Tor Lillqvist committed a patch related to this issue.It has been pushed to "master":tdf#94924: Add a more systematic OpenCL unit testIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Tor Lillqvist committed a patch related to this issue.It has been pushed to "master":tdf#94924: Fix thinko from bdef079b39d273d2985d360a52597672c96b43fcIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Tor Lillqvist committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#94924: Fix handling of empty cells in OpenCL subtractionIt will be available in 5.0.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Tor Lillqvist committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#94924: Fix handling of empty cells in OpenCL divisionIt will be available in 5.0.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Tor Lillqvist committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#94924: Return correct #DIV/0! error from AVERAGE in the OpenCL caseIt will be available in 5.0.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Tor Lillqvist committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#94924: Return correct result 0 from OpenCL MIN and MAX when all args emptyIt will be available in 5.0.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Tor Lillqvist committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#94924: Add a more systematic OpenCL unit testIt will be available in 5.0.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Thank you very much @Tor, for such a quick resolution.Verified:Win10x64Version: 5.1.0.0.alpha1+ Build ID: 186f32f63434e16ff5776251657f902d5808ed3d-GL TinderBox: Win-x86@39, Branch:master, Time: 2015-10-16_09:42:47HelloWhat about- EDITING: VLOOKUP wrong result #VALUE in CALC 5.0.2.2.it was marked as duplicate of this bug.Disabiling OpenCL performs well, but if activated it displays #VALUETested today with Version: 5.1.0.0.alpha1+Build ID: d9cf47449e88032803aa4fa3429cd607a074d5ad-GLTinderBox: Win-x86@39, Branch:master, Time: 2015-10-17_11:55:47Locale: es-MX (es_MX)On Windows 10.CreatedVLOOKUP wrong result test fileSorry, but the instructions on Sheet3 of that document don't work. They say at the first step that "correct result displays" but don't say what that correct result should be. (For me, if I follow the instructions exactly, L2 on the Sheet3 displays #N/A. I assume that is not what is expected?)Please, if you want to provide a test document, just provide a sheet where doing a Ctrl-Shift-F9 after toggling "Tools:Options:OpenCL:Allow use of OpenCL" changes calculation results. That is all that is needed. No need to describe multiple steps of saving, loading, copying and pasting. (Having over 100 copies of a formula in sequential rows in a column will make OpenCL be used, as long as the formula uses only operators and functions from the OpenCL-enable-subset.)I assume the problem in the instructions is that the formula should use Movtos.A2, not just A2? Then I see the issue.Anyway, I am not sure if we want to mark all problems in OpenCL as duplicate of this bug or not? Clearly this VLOOKUP issue is not the same as that which affected subtraction, for instance.Tor Lillqvist committed a patch related to this issue.It has been pushed to "master":tdf#94924: If we can't handle strings, don't try to thenIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.I reported a bug, which caused a wrong calculation (see). Turning off OpenCL solves the issue. Can you please check whether your solutions solves the issue inas well. Can I be of any help ?***has been marked as a duplicate of this bug. ***Tor Lillqvist committed a patch related to this issue.It has been pushed to "libreoffice-5-0-3":tdf#94924: Fix several OpenCL problemsIt will be available in 5.0.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Seems like a bibisect isn't needed here as a commit has already been pushed.Can this be closed as FIXED?I think so yes.***has been marked as a duplicate of this bug. ***Tor Lillqvist committed a patch related to this issue.It has been pushed to "libreoffice-5-0":tdf#97150: tdf#94924: If we can't handle strings, don't try to thenIt will be available in 5.0.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Tor Lillqvist committed a patch related to this issue.It has been pushed to "libreoffice-5-0-5":tdf#97150: tdf#94924: If we can't handle strings, don't try to thenIt will be available in 5.0.5.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=95824	Createdbt with debug symbolsOn pc Debian x86-64 with master sources updated today (da05c05edef729a2865158db4086b74785c45208), I've got a crash when opening Formula dialog1) Launch Calc2) Click Function Wizard button=> Crash No repro.Ubuntu 15.10 64-bit Version: 5.1.0.0.alpha1+Build ID: 7272e8df62a12d6172b297d7a82a0265cd1bc44aTinderBox: Linux-rpm_deb-x86_64@70-TDF-dbg, Branch:master, Time: 2015-11-15_00:23:07Locale: en-US (en_US.UTF-8)Win 7 Pro 64-bit Version: 5.1.0.0.alpha1+Build ID: b216cc1b8096eb60c27f67e8c27b7cd756c75e38TinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-11-12_00:06:20Locale: fi-FI (fi_FI)I can confirm with Version: 5.1.0.0.alpha1+Build ID: 7272e8df62a12d6172b297d7a82a0265cd1bc44aTinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2015-11-14_23:41:14Michael: thought you might have some idea about this one. Could it be related to?With this, it seems ok:diff --git a/sc/source/ui/formdlg/formula.cxx b/sc/source/ui/formdlg/formula.cxxindex 7e8262e..e4d466e 100644--- a/sc/source/ui/formdlg/formula.cxx+++ b/sc/source/ui/formdlg/formula.cxx@@ -88,8 +88,7 @@ ScFormulaDlg::ScFormulaDlg( SfxBindings* pB, SfxChildWindow* pCW, } } - if (m_pDoc == nullptr)- m_pDoc = pViewData->GetDocument();+ m_pDoc = pViewData->GetDocument(); m_xParser.set(ScServiceProvider::MakeInstance(SC_SERVICE_FORMULAPARS, static_cast<ScDocShell*>(m_pDoc->GetDocumentShell())),uno::UNO_QUERY); uno::Reference< beans::XPropertySet> xSet(m_xParser,uno::UNO_QUERY); xSet->setPropertyValue(SC_UNO_COMPILEFAP, uno::makeAny(sal_True));It seems it's due to conversion static->member, m_pDoc isn't initialized to nullptr.I submitted the patch to review, seeJulien Nabet committed a patch related to this issue.It has been pushed to "master":tdf#95824: Crash: when opening Function WizardIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=95573	I can't install any extension since I upgrade on El Capitan (OS X 10.11)because the add-on manager freeze when I try. I try lot version of LO and I reset my configuration every time.@shunesburg : please indicate which version of LibreOffice you are using and whether it is AppStore or TDF downloadI use only the TDF LO.I try with the 4.4 and the 5.0, the both can't install any addon.Thanks.Well, I managed to install the Danger Sign gallery extension onVersion: 5.0.2.2Build ID: 37b43f919e4de5eeaca9b9755ed688758a8251feLocale : fr-FR (fr.UTF-8)but something is indeed not right.If I drag and drop an extension file onto the StartCenter, the Extension Manager UI launches and attempts to start the installation of the extension, but then appears to freeze indefintely, yet OSX doesn't see this as a hung app. When I tried to force quit the application via the Dock, I then a request to confirm installation of the extension. If I OK that request, the extension is then installed, so it would seem that the confirmation dialog is not displayed when it should be, or rather it is hidden from the user. Further testing required to nail down the exact problem.Confirming - tried with another gallery extension, the problem was even worse.Context switching seems to help a little, but I couldn't ever get the confirmation to install dialog to appear.This worked previously in OSX 10.10 ==>> regressionCreatedlldb outputokay, so context switching between desktops and other apps, eventually allows the confirmaiton dialog to be displayed, and then activated, but the whole LibreOffice app seems to grind to a hal and become unresponsive.I have enclosed the lldb output from my debug master build, hopefully that should enable one of the devs to see what is going wrong.@Michael: there's a lot of vcl calling in that lldb output, any idea ?when I'm in lldb and the freeze occurs in LO, I don't have access to input any commands to lldb (or at least, I haven't found a way of doing so), lldb appears to be waiting for the LO process to return some further token of information, which never happens (well, at least not until I can regain the focus of the app when the confirmation dialog OK button press is finally accepted.Looks odd; I'd love to see it bibisected (if we have a suitable repo). Sadly there is no easy environment variable for disabling grabs on Mac (that I know of).Also - any chance of a stack trace with debugging symbols (of all threads ?) =) thanks !There is something new?A patch or a future commit?It will be good if the bug could be solved before the 5.1 release.Noticed this before but now looking at it it seems to have gone to far:Clicking "Check for updates" in Extensions Manager on OSX in 5.1RC1 takes ages to check for updates of already installed extensions. I never got it to finish so it might be just stuck. The Extensions Manager just gets unresponsive.Since this could signal a problem of some kind of Internet connection, I manually downloaded LanguageTool 3.2 and installed it in Extension Manager manually over 3.1 by clicking "Add...". And again this installation takes ages, after more than 10 minutes the status is stuck somewhere around 10 % in the graphic representation ... The fans of the laptop started to work so it seems there is some "hard computational work" happening somewhere. Cannot figure out what is happening, but it obviously it is not due to Internet firewall or anything like that.I tried the same with LibreOffice Vanilla 5.0.2.2 (for OSX, the Collabora version in the iTunes) and I am seeing the same problems with updating included spelling/thesaurus extensions (LT cannot be installed since Vanilla does not support use of Java, so I cannot check that).I guess there is some serious error in the updating/checking for updates of extensions on OSX and this is a serious functionality flaw, that should be marked as a stopper on OSX, IMHO.Relatively few of us have Macs unfortunately; making this hard to test. I suspect some threading / event madness - provoked by the new main-loop work. Can you get a dbgutil build and get a log file with SAL_LOG=1 set - or at least the vcl.schedule log domain (both warn and info) is what I'm most interested in =)Norbert, and/or Andras - is that something that's easy to get ?So, testing this again on my latest master dbgutl build (20160104)I started unopkg gui in a lldb session.I was able to add an extension package, e.g. BaseTools-0.0.5.oxtThe extension installed for all users successfully, there was no stall or freeze.I then tried clicking on the Check for updates button, which gave the following console output :warn:sal.osl:60084:4:sal/osl/unx/socket.cxx:951: undefined addressand that is when the GUI freezes. Normally, what should happen is that a window is drawn with a list of all available updates, or else an empty window if none are available. However, this window never gets drawn, and that is why the app appears frozen.lldb remains in an expectant state, apparently waiting for something to happen, but not returning to the active debugging cli (how do I get that back, forcibly, if necessary, to input commands ?)The Mac process monitor app shows that LO has 5 running threads, and is occupying approximately 1.5% CPU, but dropping to 0% when switching context away from app.What I do notice in the Memory usage tab of the Monitor.app, is that the LO process has spawned 238 ports !!However, none of these ports appear to have had any network traffic.Hi Alex; nice debugging - can you get stack traces (even roughly) of all the live threads ? =)Thanks !In that previous test, I left LOdev running a full 6 minutes with no activity, in a seemingly frozen state. None of the buttons on the dialog would respond, I couldn't close the dialog by any means, I couldn't even quit LOdev via the normal menu entry or the dock entry. I had to force quit the app to regain lldb cli debugging control.(In reply to Michael Meeks from)How do I do that, lldb doesn't allow me to input anything from the cli session when LOdev is in that state ?Createdunopkg lldb output plus backtraceSo, forcing a break and killing the process allowed me to return to lldb and request a bt. Had to repeat this though, as lldb re-enters a kind of zombie mode, so the bt output might not be relevant to the particular state.Very odd, the trace you give seems to suggest that there are two dialogs concurrently running, one in each thread: frame #7: 0x000000010974b943 libdeploymentgui.dylib`dp_gui::UpdateDialog::Execute(this=0x0000000106244000) + 83 at dp_gui_updatedialog.cxx:600and frame #14: 0x00000001097280f7 libdeploymentgui.dylib`dp_gui::ServiceImpl::startExecuteModal(this=0x0000000108bdce70, xListener=0x00007fff5fbff3f0) + 2807 at dp_gui_service.cxx:284Which is somewhat interesting and unusual in itself; that 'bWait' is set is good - the app is waiting for events to do something.Are you sure there is no hidden window somewhere ? perhaps the transience / layering is wrong for them somehow ?(In reply to Michael Meeks from)Therein lies the problem - the window although initiated, is never displayed. In my testing with just unopkg (which of course starts an instance of the office in the background and causes the LO icon to appear in the dock), I had just two windows on my screen, the lldb terminal session and unopkg gui window - no amount of context switching, or moving windows around the desktop could make the update check window appear. I fear it is the same for the confirmation dialog window that is supposed to be displayed when installing an extension (as was reported initially in this bug report). Quite why these windows do not appear, or at least do not appear in a sufficient time frame for the user not to give up on the whole experience and kill the office, is beyond my knowledge.It could be the same or similar bug as that which afflicts the first opening of the Finder dialog when attempting a first open or save of a document after launch of LO (see)Hi Alex - thanks so much for persisting =) can we take a new approach ? I'd love to see the output from:export SAL_LOG=1on a dbgutil build. That should show us what the scheduler and quartz backends are doing - either for this case, or for the file-selector one. That is assuming you have a dbgutil build somewhere ?Thanks !I can reproduce the freeze under Fedora 23 too, if installing extensions using File->Open, instead of opening the extension manager first. Reproduced with my own 5.1/master builds, and only with gtk/gtk3 vclplugs, not with gen. Oddly I reproduce the same with Fedora's 5.0.4.2, but not with TDF's 5.0.4.2, nor with my own 5-0 build.Can be of course unrelated to the Mac problem.(In reply to Michael Meeks from)Hi Michael, yes, I have a dbgutil build, but where do I stick the export SAL_LOG=1 ?Do I add it to the sofficerc or some other file or is this something I can pass to lldb in some way ?Oh - you need the SAL_LOG in the environment - so I guess run from a shell and do:export SAL_LOG=1and then re-direct the output of LibreOffice to a file; no idea how to do that on Mac but on Linux:SAL_LOG=1 soffice >& /tmp/sal-log.txtMaxim - could you do the same ? - it'd be great to have that log.Thanks !CreatedSAL_LOG from Fedora 23CreatedSAL_LOG from OSX 10.11.2Shouldn't this be a stopper/blocker for 5.1?Maxim - your linux trace seems to show a live loop - most likely caused by an Invalidate occuring during the Paint of a Window.Any chance you could put a breakpoint in vcl/source/window/paint.cxx (Window::ImplInvalidate) - and get some stack-traces from there - when it is live-locked ?That would give the same symptoms (of not making progress) that we see on Mac, but the mac trace doesn't show the same symptoms - oddly.Thanks !Createdbacktrace 1Createdbacktrace 2Why the progress bar is updated, if I didn't accept the installation yet?Lovely; thanks Maxim ! =) there is (in a nutshell) a busy loop re-setting the progress bar's status there from an idle handler; not great ! but then again the priority of that idle handler is low so it shouldn't -really- affect rendering or making progress here I think - I'm surprised that it seems to.And - wow, this code is just horrific =) again a load of state being updated at 'idle' (ie. now in a busy loop) that is simply not changed from one iteration to the next. Horrors.IMPL_LINK_NOARG_TYPED(ExtMgrDialog, TimeOutHdl, Idle *, void)and the cut/paste coded:IMPL_LINK_NOARG_TYPED(UpdateRequiredDialog, TimeOutHdl, Idle *, void)are inexcusable bad.Michael Meeks committed a patch related to this issue.It has been pushed to "master":tdf#95573 - stop (crazy) busy loop from blocking rendering.It will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Pushed a workaround to master, and a patch for -5-1 to CI:testing much appreciated; since I can't easily test please close if it works for you =)Beyond that this dialog code needs a significant re-write; will create an easy-hack.Thanks Michael, now at least I can click OK to accept the install. But still, the message box respond/redraw is _very_ slow, with a relatively high CPU usage.OnVersion: 5.2.0.0.alpha0+Build ID: ac91a81b7b47fc9eba24455d34e2168309ea51d1CPU Threads: 2; OS Version: -; UI Render: default; Locale: fr-FR (fr.UTF-8)I still don't get a window when I click on Check for Updates...on LO v 5.0.4.2 extension manager starts but is greyed out and doesn't do anything. LO Menues are readable, but application seems to (be busy?) hang. MAC OS 10.11.2 does not say: 'Application isn't answer' in 'Immediatly Finish' - Dialog. (I am german, may be the name of this feature is different. But you can call it by cmd+alt+esc. I can't install any extension and it is not possible to update the rest of installed extentions.Michael Meeks committed a patch related to this issue.It has been pushed to "libreoffice-5-1":tdf#95573 - stop (crazy) busy loop from blocking rendering.It will be available in 5.1.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Confirming what Alex found out in his tests: Checking for updates does not open any window and nothing happens. Also can't close the Extension manager once the "Check for updates" has been initiated.Hope this can be addressed.Version: 5.2.0.0.alpha0+Build ID: 31ad2d7af585e8f35a645482a92bdc37a66e64caCPU Threads: 4; OS Version: Mac OS X 10.11.3; UI Render: default; TinderBox: MacOSX-x86_64@49-TDF, Branch:master, Time: 2016-01-25_23:36:12Locale: de-DE (de.UTF-8)the daily update (libreoffice-5-1/MacOSX-x86_64@49-TDF/2016-02-09_23.51.09) doesn't change anything: no update of extension, impossibility to close the extension window (or LO) once the "update" button has been pressed.Hmm; the check for updates window is opened in a new thread; which inevitably causes problems.I'd strongly prefer to close this bug; and have a new clean bug that's easy for me to catch up with with the limited time I have here.I need some new back-traces, with debugging symbols, of all threads when it is hung & not showing anything.Ideally also - I'd have some SAL_LOG=1 output (as we had for fedora above) from a dbgutil build to see what the scheduler is doing. Without that, and without being able to reproduce it (no Mac) it's hard to get further.ATB.We can just close the bug like that and ignoring all mac users. If you need logs or something else said us what to do.(In reply to shunesburg69 from)Sorry I mean "We can't just close" not "We can just close". I'm not English native sorry.Agree. meeks said "I need some new back-traces, with debugging symbols, of all threads when it is hung & not showing anything."Can someone link precise steps how to produce that debugging info? Otherwise chances are really low, users will be able to produce the requested info.Opening a new, clean bug that isn't packed with irrelevant stuff; and is focused on the separate issue that is not fixed is rather important.As & when there is a new bug, that is focused on the remaining issue - I might find some time to look at this again. Until then; I'm off. Please do CC me on the new bug. As/when this one is closed =)wrt. generating back-traces; there is a lot of documentation on this around the place that google can find:Thanks.***has been marked as a duplicate of this bug. ***Installing new extensions via the add button works in Version: 5.2.0.0.alpha0+Build ID: 144ce8b3ff38a39507a4167662ef5b4aec63907aThreads CPU : 2; Version de l'OS :Mac OS X 10.11.3; UI Render : par défaut; Locale : fr-FR (fr.UTF-8)Closing this bug as FIXED. I have opened a new bug report for the Update hang scenario underplease backport the fix from 5.2.0.0 to 5.1.x, it is going to be the stable version for a long time (and this is the most "unstable" bug there can be).I would like to reopen until it is fixed in 5.1.x.Thanks, m.I think the bugis related to this one.REOPENED is wrong status as we have an older report about the other issue. Reverting status change.Hi Alex - fun - so - is there any chance we can bibisect the -fix- out of the 5.2 / development branch =) then we can back-port it; it is unclear what (beyond my work) fixed this I guess.@ Alex ThurgoodWe can bypass with the "Add" button, but it's not a resolution, it's just a tip.Let's leave status as FIXED, ok..But is false, it doesn't.(In reply to shunesburg69 from)One issue per report. What you are talking about is, not this.It's me who made this report at beginning, and I speak about "install", not update.It's possible that is linked but it's not the same bug.In the title of my report I don't see any word about update:"EXTENSION MANAGER - freeze / hang when attempting to install extensions on OSX 10.11, installation confirmation dialog not displayed".@shunesburg69I verified this bug is fixed:1. download example extension (I used)2. open LO extension manager and click "add"3. selected downloaded extension→ installs fine on 10.11.4 with LO latest master from yesterday.VERIFIED FIXEDIf I am missing something please elaborate, but do not change the bug status.I said it before "Add" button is OK but it's not the usual way to install an addon.When you double click on oxt file, the extension manager try to install but freeze.@Confirmed. Although this may seem odd, it would be really helpful if you could file a new clean bug with exact repro steps about ths issue.I am happy to confirm the new bug since what you write is correct. But this bug here with almost 60 comments, no proper repro steps in the initial report and a misleading title will neither help you, devs or QA. It will just continue to raise frustration.Would that be ok with you to file a new bug?You have right but I'm afraid if I made a new one, the bug should flag as a duplicate.I made a new one ().*** This bug has been marked as a duplicate of***
id=95670	CreatedSample file SUMPRODUCT bugAttached a basic sample file.Where LEFT() inside SUMPRODUCT() works only with SUMPRODUCT() forced as array [Ctrl+Enter]Happens the same with RIGHT(), MID(), T(), N() or DAY().Seems no function works now inside SUMPRODUCT() without an explicit array.Seems a very recent regression:Win10x64Works with:Versión: 4.4.6.2 Id. de compilación: 008d5d0ddffba0b82de2a2c36a65b9cba0a6b328 TinderBox: Win-x86@51-TDF, Branch:libreoffice-4-4, Time: 2015-10-14_08:09:18Version: 5.0.3.2 (x64) Build ID: e5f16313668ac592c1bfb310f4390624e3dbfb75Version: 5.1.0.0.alpha1 (x64) Build ID: 0b48731919433e46e4fda7e5a5ca27c08c28b981Fails with:Version: 4.4.7.0.0+ Build ID: 61a7e6f039294103a1721ec95724d067cf205d0b TinderBox: Win-x86@51-TDF, Branch:libreoffice-4-4, Time: 2015-11-03_20:33:02Version: 5.0.4.0.0+ Build ID: a93c08e8eeb8386d02a015c63d161220d059a6bf-GL TinderBox: Win-x86@62-merge-TDF, Branch:lo-5-0, Time: 2015-11-03_16:36:47Version: 5.1.0.0.alpha1+ (x64) Build ID: 048d47d54d72babe49920ea5e8ff934fe0032125 TinderBox: Win-x86@42, Branch:master, Time: 2015-10-30_19:51:10Version: 5.1.0.0.alpha1+ (x64) Build ID: 04783fd91832fa01a5b096f395edd7ad4f9c0f6b TinderBox: Win-x86_64@62-TDF, Branch:MASTER, Time: 2015-11-07_21:35:01 How can I recognize a bad result?For me the files appear identical in versions you define "works" & "fails".Win 7 Pro 64-bit, Version: 5.0.3.2 (x64)Build ID: e5f16313668ac592c1bfb310f4390624e3dbfb75Locale: fi-FI (fi_FI)Version: 5.1.0.0.alpha1+Build ID: 6da681442b17c723f9408a806e8d2367441ad65aTinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-11-07_23:13:46Locale: fi-FI (fi_FI)Doing a hard recalc [Ctrl+F9] result in C5 is #VALUE!Present also in:Version: 4.4.7.1 Buid Id.: ff36774456acc538223589597da53fd987db12e9changed the version.Didn't test myself, but confirmed per comments above. Since from 4.4.7 probably related toor.Taking.Eike Rathke committed a patch related to this issue.It has been pushed to "master":Resolves: tdf#95670 propagate ForceArray per parameterIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Eike Rathke committed a patch related to this issue.It has been pushed to "master":unit test for tdf#95670It will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Eike Rathke committed a patch related to this issue.It has been pushed to "master":prevent ForceArray propagation on the same token, tdf#95670 follow-upIt will be available in 5.1.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Pending reviewfor 5-0for 4-4for 4-4-7Thanks for the quick fix.Verified:Version: 5.1.0.0.alpha1+Build ID: 32d4c03cba399ada807b8ec113a3928aa9e3ff7bTinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-11-16_23:27:02Version: 5.1.0.0.alpha1+ (x64)Build ID: 32d4c03cba399ada807b8ec113a3928aa9e3ff7bTinderBox: Win-x86_64@62-TDF, Branch:MASTER, Time: 2015-11-16_23:41:46Unverified as per private request by m.a.riosv, thus back to resolved.Not sure I agree, sincealso I am confused how LO then uses the Verified state. But he's the original bug reporter so respecting his wish.(In reply to steve -_- from)Miguel: please explain yourself. The status of this report should rightly now be VERIFIED.VERIFIED: This option is only available when the current bug status is RESOLVED. You can mark a RESOLVED FIXED bug as VERIFIED, when you can confirm it is fixed with the version mentioned in the bug report. It is also pleasant for the developer who fixed the issue, and is a confirmation the problem is solved now. Otherwise a bug reporter can mark their own bug that is in RESOLVED WORKSFORME state as VERIFIED WORKSFORME to verify it is somehow fixed.If I'm not wrong it's pending for revision in versions 4.4 and 5.0., and I don't see your verification for those versions. I you like VERIFY bugs there are 7568 at this time with the status as RESOLVED FIXED not marked as VERIFIED, a great job for to do.Eike Rathke committed a patch related to this issue.It has been pushed to "libreoffice-5-0":Resolves: tdf#95670 propagate ForceArray per parameterIt will be available in 5.0.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Eike Rathke committed a patch related to this issue.It has been pushed to "libreoffice-4-4":Resolves: tdf#95670 propagate ForceArray per parameterIt will be available in 4.4.8.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.To be honest, the “verified-versus-resolved” dispute in this bug report is a bit pathetic…Eike Rathke committed a patch related to this issue.It has been pushed to "libreoffice-4-4-7":Resolves: tdf#95670 propagate ForceArray per parameterIt will be available in 4.4.7.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Honest @Adolfo,Hope you have verified but forgot to inform here.Verified for 4.4.7 4.4.8 5.0.4There is an amazing job for you to do, only 566 are CLOSED on a total of 9110 FIXED.
id=96118	Start Writer. Open the font name list in the toolbar. Click on the slider in the vertical scrollbar of that list.Expected behavior: You can move the slider with the mouse.Seen behavior: The list closes immediately.That happens to font size drop-down list too.The same happens to these lists in the Sidebar.I see this problem inVersion: 5.2.0.0.alpha0+Build-ID: a8860122fecbaa932a48f41a38077f621275be9dThreads 4; Ver: Windows 6.1; Render: default; TinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-11-27_10:34:00Gebietsschema: de-DE (de_DE)It was OK inVersion: 5.1.0.0.alpha1+Build ID: f271602f7193ddf584ea58dc6a468e6842d0781eTinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-11-08_22:37:35Locale: de-DE (de_DE) Hi Regina,Confirmed with LO 5.2.0.0.alpha0+ Build ID: 03c37cee476d14d1d8644ccc7ea5c69d74d9c7f9TinderBox: Win-x86@42, Branch:master, Time: 2015-11-28_00:15:51Locale: fr-FR (fr_FR)Works withLO 5.1.0.0.alpha1+ Build ID: f6bc5b79c31225c02e9500d0ced4bd26f998f82bTinderBox: Win-x86@39, Branch:master, Time: 2015-11-24_01:07:47Locale: fr-FR (fr_FR)& windows 7 Homedisabling OpenGL do no change to this issue.Seems to affect *any* combobox.The problem is not only the scroll bar, but also selecting a different value in list does not change value.It seems to affect ALL combobox in all modules in all UI (toolbar, sidebar, dialog box).I found 1 exception: in Tools > Options > LibreOffice > View: changing icon style does not change value in combobox, but DOES change icon style in UI. On the opposite, other combobox has no effect.Workaround: use arrow key to modify value in comboboxWin 7, Version: 5.1.0.0.beta1-buildfix1Build ID: 13010a13177025f633c9b85adcb3edf6920e44e3Threads 4; Ver: Windows 6.1; Render: default; Locale : fr-FR (fr_FR)(In reply to Laurent BP from)There is a separate bug for it -.Also seeing this in Version: 5.1.0.0.beta2 on Win10_x64*** This bug has been marked as a duplicate of***
id=96119	Start Writer. Open the drop-down list "style" in the Formatting toolbar. Click an item, e.g. Title.Expected behavior: The selected style is applied to the current paragraph.Seen behavior: Nothing happens, the same style is selected as before.I see the same problem in Calc. I see the same problem with the lists: .uno:GrafMode, .uno:XLineStyle, .uno:FillColor, .uno:FillStyle, .uno:CharFontName, Toolbar selection in Customize dialog. There are likely others.I see the error in Version: 5.2.0.0.alpha0+Build-ID: a8860122fecbaa932a48f41a38077f621275be9dThreads 4; Ver: Windows 6.1; Render: default; TinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-11-27_10:34:00Gebietsschema: de-DE (de_DE)It was OK in Version: 5.1.0.0.alpha1+Build ID: f271602f7193ddf584ea58dc6a468e6842d0781eTinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-11-08_22:37:35Locale: de-DE (de_DE) Hi Regina,I reproduce withLO 5.2.0.0.alpha0+ Build ID: 03c37cee476d14d1d8644ccc7ea5c69d74d9c7f9Threads 2; Ver: Windows 6.1; Render: GL; TinderBox: Win-x86@42, Branch:master, Time: 2015-11-28_00:15:51Locale: fr-FR (fr_FR)Windows 7 Home.Worked withLO 5.1.0.0.alpha1+ Build ID: f6bc5b79c31225c02e9500d0ced4bd26f998f82bTinderBox: Win-x86@39, Branch:master, Time: 2015-11-24_01:07:47Locale: fr-FR (fr_FR)***has been marked as a duplicate of this bug. ***Seems to affect *any* comboxbox in the app.It was OK with Version: 5.1.0.0.alpha1+Build ID: 229583f298b9de05e1ad1727e233d597995099e3-GLTinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-11-22_23:09:05Locale: fr-FR (fr_FR)***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***I can reproduce the bug in 5.1.0.0.beta2 (x64), WIN10Hi,This bug is very annoying, it also affects the drop-down lists in Base forms.Still present in 5.1.0.0.beta2 Win7/x86Bernardsimilar issue when attempting to select a different color palette from the drop down in font or highlight color tools.A "workaround" is to use your UP/DOWN key + ENTER to do the selection.Hi, It reproduce in every combobox where I have tried, "Open Remote Dialog", "Font List", "Font Size", "Style List", Setting's combobox etc.Version: 5.1.0.0.beta2 (x64)Build ID: 53054959a12edc6510f51b94ddc9b73d27aedaf6Threads 8; Ver: Windows 6.1; Render: GL;***has been marked as a duplicate of this bug. ***I want fix this, i think monday eveningIs a bibisect really needed here? If not - please remove it from the keywords. If so, just let me know.this commit has make the problem, the removing of the SALEVENT_MOUSEACTIVATE commit dd351dd728687cffe432ce0ec9367ceb80e097fb Author: Noel Grandin <> Date: Tue Nov 24 08:50:39 2015 +0200 loplugin:unusedfields in vcl/ and remove the unused SALEVENT_MOUSEACTIVATE stuff Without of there, when click in the opened list-box it send first the "PreNotify" with "MouseNotifyEvent::LOSEFOCUS"and that close the listbox. After that, it send the mouse-event to a closed window(get a nullptr), that is the reason why the Listbox not get the mouse-click. With this patch, first send the mouse-click and then the "PreNotify"forget my commit, now hereJuergen Funk committed a patch related to this issue.It has been pushed to "master":tdf#96119 Cannot select item with mouse in any combobox / drop down menuIt will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Hi Juergen,Thank you for taking care of this bug. Please commit the patch also to 5-1 branch, which is also affected. Thanks!***has been marked as a duplicate of this bug. ***Hi Maxim look hereport to LO5.1 doneJuergen Funk committed a patch related to this issue.It has been pushed to "libreoffice-5-1":tdf#96119 Cannot select item with mouse in any combobox / drop down menuIt will be available in 5.1.0.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.***has been marked as a duplicate of this bug. ***Thanks!It works now in Version: 5.1.0.1.0+Build-ID: 51a1b41ab4a840544e5454d1d4234b443edd5466Threads 4; Ver: Windows 6.1; Render: GL; TinderBox: Win-x86@62-merge-TDF, Branch:libreoffice-5-1, Time: 2015-12-17_11:44:49Gebietsschema: de-DE (de_DE)***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***It seems the fix for Windows has broken drop down boxes for Linux. See***has been marked as a duplicate of this bug. ***Added CC from.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***How do I upgrade my version beyond 5.1.0.1? Its says I'm up to date. Windows 10. Thank you.How do I upgrade my version beyond 5.1.0.1? Its says I'm up to date. Windows10. Thank you. Note that I'm asking because this bug is still affecting me.5.1.0.3 is here:(In reply to Joel Madero from)Thank you! Installed latest version and now this is fixed :)Let's set it to verified while we're at it.
id=96147	Read-Error.Format error discovered in the file in sub-document content.xml at 2,168126(row,col). please upload test filethen tell your LibO version and O/Sstatus NEEDINFOrevert it to UNCONFIRMED when you answer these questionsCreatedodt file***has been marked as a duplicate of this bug. ***dstrzele/Paolo: Any chance of getting a version of the document one step before the corruption happens, so we can reproduce the buggy saving? This will help us a lot in fixing this. Thanks.Maxim Monastirsky, i'm sorry, but I have no chance: the bug occurs randomly. Today I changed the document three times: twice it went well, once was corrupt.I suspect that my document has problems, because the frequency with which it is corrupt is unacceptable.(With Writer: Version 3 <-> 4 I never had problems)(In reply to Paolo Meozzi from)That's unfortunate. Adding Michael to CC. Maybe he has an idea why is this duplicate fo:background-color="transparent" added to styles.CreatedDocument template and macroI found a pattern! But I do not know how useful.The problem happens when I paste code fragment from Visual Studio (2013), but only when using a particular document template.Since version 4.x (I think), the pasted code from VS maintains the white background and thus change the background that I have assigned to the style "code" in my documents.For this reason I created a macro that applies the style and sets the background transparent the selected text.Everything works fine except in one case:1) I paste a snippet of code from VS (OK)2) applying macro (OK)3) paste the new fragment of VS within the code already formatted. (OK)4) apply the macro again (only) to the fragment just pasted (oh oh!)Save to disk ... and the document is corrupt: the background is set twice, transparent and white.I added the document templates and macros that format text.(In reply to Paolo Meozzi from)Very useful! I reproduced exactly with your steps (but with VS 2015).Version: 5.2.0.0.alpha0+Build ID: 6fd3f3caad1a559165dc9332249cbd0d84930775Threads 1; Ver: Windows 6.1; Render: default; TinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-12-08_23:31:11Createdpreviously saved documentDoes this help?***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***i can't reproduce the problem... but i'm highly suspicious of this commit:commit f880962f5bf26bfaef06bd3f9e67e2d901a2e74cAuthor: Zolnai Tamás <>AuthorDate: Wed Mar 18 10:25:05 2015 +0100 Char highlight: ODT filters Export merges the two background attribute.... which adds another property that exports to the offending fo:background-color attribute, and was added in LO 5.0... that'sjust too much of a coincidence...... alright this reproduces the problem from scratch:Sub Mainc = ThisComponent.Text.createTextCursor()c.setString("foo bar baz")c.goRight(4, false)c.goRight(3, true)msgbox(c.getString())c.CharBackColor = 0c.CharHighlight = 0c.CharBackTransparent = 1End Subfixed on masterMichael Stahl committed a patch related to this issue.It has been pushed to "master":xmloff: tdf#96147: ODF export: fix duplicate fo:background-colorIt will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-5-0":xmloff: tdf#96147: ODF export: fix duplicate fo:background-colorIt will be available in 5.0.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-5-0-5":xmloff: tdf#96147: ODF export: fix duplicate fo:background-colorIt will be available in 5.0.5.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-5-1":xmloff: tdf#96147: ODF export: fix duplicate fo:background-colorIt will be available in 5.1.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=96227	Createdactivity monitor sampleOS X: 10.11.2 Beta (15C48a)LO: Version: 5.1.0.0.beta1-buildfix1Build ID: 13010a13177025f633c9b85adcb3edf6920e44e3Threads 8; Ver: -; Render: default; Locale: en-US (en.UTF-8)I've deleted all my settings in ~/Library/Application Support/LibreOfficeDev to start from fresh, and I see that LibreOfficeDev is causing a 100% CPU use. I've sampled the process and attach the spindump if it will be useful, the top of the stack is: __psynch_cvwait (in libsystem_kernel.dylib) 5418 mach_msg_trap (in libsystem_kernel.dylib) 2807 __accept (in libsystem_kernel.dylib) 2709 kevent_qos (in libsystem_kernel.dylib) 2709 _kernelrpc_mach_port_insert_member_trap (in libsystem_kernel.dylib) 283 objc_msgSend (in libobjc.A.dylib) 155 _pthread_mutex_unlock_slow (in libsystem_pthread.dylib) 138 mk_timer_arm (in libsystem_kernel.dylib) 118 _kernelrpc_mach_port_extract_member_trap (in libsystem_kernel.dylib) 99 _pthread_mutex_lock_slow (in libsystem_pthread.dylib) 78 CFBasicHashFindBucket (in CoreFoundation) 74 pthread_mutex_unlock (in libsystem_pthread.dylib) 64 __CFStringHash (in CoreFoundation) 59 mach_absolute_time (in libsystem_kernel.dylib) 54 pthread_mutex_lock (in libsystem_pthread.dylib) 54 bool objc::DenseMapBase<objc::DenseMap<DisguisedPtr<objc_object>, unsigned long, true, objc::DenseMapInfo<DisguisedPtr<objc_object> > >, DisguisedPtr<objc_object>, unsigned long, objc::DenseMapInfo<DisguisedPtr<objc_object> >, true>::LookupBucketFor<DisguisedPtr<objc_object> >(DisguisedPtr<objc_object> const&, std::__1::pair<DisguisedPtr<objc_object>, unsigned long> const*&) const (in libobjc.A.dylib) 50 CFEqual (in CoreFoundation) 43 10.11.1 confirming. CPU constantly at 100% withVersion: 5.1.0.0.beta1-buildfix1Build ID: 13010a13177025f633c9b85adcb3edf6920e44e3Threads 4; Ver: -; Render: default; Locale: de-DE (de.UTF-8)Status NEWImportance highest blockerKeyword regressionLO should not be released with this regression.*** This bug has been marked as a duplicate of***
id=96195	Hi. Testing Version: 5.1.0.0.beta1-buildfix1Build ID: 13010a13177025f633c9b85adcb3edf6920e44e3Threads 2; Ver: Windows 5.1; Render: default; Locale: es-MX (es_MX) on Windows XP SP3I found the CPU usage high in idle state.In Windows XP SP3 in a PC with intel 2 core duo, the CPU usage is about 50% in idle state.In Windows 10 in a Laptop Corei-7, is about 12% constant, that is 100%/8 cores. CreatedScreenshoots of CPU usage in idle stateI have uninstalled the beta1 and installed Version: 5.1.0.0.alpha1+Build ID: f6bc5b79c31225c02e9500d0ced4bd26f998f82bThreads 2; Ver: Windows 5.1; Render: default; TinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2015-11-24_01:16:59Locale: es-MX (es_MX)and the high cpu usage is not presentSending screenshoot.CreatedScreenshoot of CPU usageAlready fixed, see this thread:***has been marked as a duplicate of this bug. ***reported on osx as well and confirmed. thus platform ALLImportance highest criticalno longer has constant CPU usage at 100% confirming the fix → verifiedMigrating Whiteboard tags to Keywords: (regression)[NinjaEdit]
id=96366	Since some patches by Benjamin Ni Function, Function Wizard has become buggy: 1. enter nested function, let's imagine LOG(POWER(2 ;7) ;6)2. select power function, backspace one symbol in the field "Base"3. I'm automatically thrown away to LOG functionIn LO 5.0 there were no such bug. Why such changes are pushed to master? It has tooked about 15 minutes for me to find bug. Is there any master moderation at all???!! It's not surprising that 5.0.3 feels like apha version...PS: btw, what has changed in formula wizard? I do not see any difference between 5.0 and 5.1. Wiki is requseting for screenshot tested on Windows 7 machine, 64 bit, version 5.1.0.0.beta2 (x64)Reproducible with Version: 5.2.0.0.alpha0+Build ID: de9d0e797903e7ecc19be2b05c7e89d5936ae02dThreads 4; Ver: Linux 4.2; Render: default; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2015-12-03_04:13:00Please don't assign bugs to people when submitting. Grabbing.Eike Rathke committed a patch related to this issue.It has been pushed to "master":tdf#96366 disable treeview results until fix availableIt will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Eike Rathke committed a patch related to this issue.It has been pushed to "libreoffice-5-1":tdf#96366 disable treeview results until fix availableIt will be available in 5.1.0.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Eike Rathke committed a patch related to this issue.It has been pushed to "master":Resolves: tdf#96366 replace Edit...() calls with actually working codeIt will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Eike Rathke committed a patch related to this issue.It has been pushed to "libreoffice-5-1":Resolves: tdf#96366 replace Edit...() calls with actually working codeIt will be available in 5.1.0.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=96847	Android viewer crashes on every file (android 4.4.4)Version: 5.2.0.0.alpha0+Build ID: 4c23184steps:open android vieweropen file in crashtested with ods, odt, odp, doc** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***Build fingerprint: 'Xiaomi/mocha/mocha:4.4.4/KTU84P/5.11.26:user/release-keys'Revision: '0'pid: 17764, tid: 17943, name: Thread-2222 >>> org.example.libreoffice <<<signal 6 (SIGABRT), code -6 (SI_TKILL), fault addr -------- r0 00000000 r1 00004617 r2 00000006 r3 00000000 r4 00000006 r5 00000002 r6 00004617 r7 0000010c r8 7ca2dd18 r9 7c930000 sl 7c0664f0 fp 7ca2dcec ip 71c87f28 sp 7ca2dc70 lr 400c3021 pc 400d1f88 cpsr 000f0010 d0 6e6f697470656378 d1 3a3a726174733a3a d2 7065443a3a6f6e75 d3 45746e656d796f6c d4 4026000000000000 d5 4047800000000000 d6 4026000000000000 d7 0000000b00000000 d8 3f8000003f800000 d9 4391800044c90000 d10 0000000044f08000 d11 0000000000000000 d12 0000000000000000 d13 0000000000000000 d14 0000000000000000 d15 0000000000000000 d16 fffffffffffeae80 d17 3ff0000000000000 d18 4024000000000000 d19 75d93d5d75d93d5d d20 75d93d4975d93d49 d21 75d93d4975d93d49 d22 75d93d3975d93d39 d23 75d93d3975d93d39 d24 0000005b00000059 d25 0000005f0000005d d26 0707070703030303 d27 017a000001720000 d28 014a005301420051 d29 015a005701520055 d30 016a005b01620059 d31 017a005f0172005d scr 80000010backtrace: #00 pc 00021f88 /system/lib/libc.so (tgkill+12) #01 pc 0001301d /system/lib/libc.so (pthread_kill+48) #02 pc 00013231 /system/lib/libc.so (raise+10) #03 pc 00011f67 /system/lib/libc.so #04 pc 0002183c /system/lib/libc.so (abort+4) #05 pc 025915dc /data/app-lib/org.example.libreoffice-1/liblo-native-code.socode around pc: 400d1f68 e8bd00f0 e3700a01 912fff1e e2600000 400d1f78 ea006f79 e92d50f0 e3a07f43 ef000000 400d1f88 e8bd50f0 e3700a01 912fff1e e2600000 400d1f98 ea006f71 e92d50f0 e3a070ee ef000000 400d1fa8 e8bd50f0 e3700a01 912fff1e e2600000 400d1fb8 ea006f69 00000000 e1520003 8a0000ab 400d1fc8 f5d1f040 e92d4001 e3520000 11500001 400d1fd8 08bd8001 f5d1f000 f5d1f040 e3520020 400d1fe8 3a00008f e3520080 3a000084 e2603000 400d1ff8 e213303f 0a000015 e0422003 e1b0cf83 400d2008 44d1c001 44c0c001 24d1c001 24c0c001 400d2018 24d1c001 24c0c001 e1b0ce83 5a000001 400d2028 f4a1030d f480031d 3a000001 f421070d 400d2038 f400071d e1b0cd83 5a000001 f4210a0d 400d2048 f4000a2d 3a000001 f421020d f400023d 400d2058 f5d1f080 f5d1f0c0 e3520902 3a000004 code around lr: 400c3000 447b4b13 42b3e010 4812d10e 44786a1e 400c3010 ec90f7fb e9d8f00d 46224631 efaef00e 400c3020 d00a3001 e00b2400 2b00681b 480ad1eb 400c3030 44782403 ec7ef7fb f001e002 6804fa1b 400c3040 fa18f001 46206005 bf00bd70 0003b3a2 400c3050 0003b396 0003b38e 0003b36a bf7ef7ff 400c3060 4a3e4b3d 43f0e92d 4606b08b 447b460d 400c3070 6823589c 930946a1 f9fcf001 8000f8d0 400c3080 d0482d00 f0104628 280ff80b d8444604 400c3090 ffe4f7ff d1064286 4629200f e8a2f00d 400c30a0 d03c2800 482ee02e f7fb4478 482debc2 400c30b0 e0154478 d11342b0 482b6a06 f7fb4478 400c30c0 4a2aec3a 46332120 447aa801 fc24f013 400c30d0 a8012101 ff22f01a 46061c42 e011d104 400c30e0 28006800 e02cd1e6 46294630 f00d4622 400c30f0 1c43e8de d11e4607 f9bcf001 29046801 CreatedADB debug logSame here.The program initially loads fine, and displays the file chooser. When attempting to load a document using the android viewer, the program crashes immediately. This is true for all documents, presentations and spreadsheets that I have tested (about 5 files, some odt odp, some docx).Build is 5.2.0.0+ (91f41c3), installed from the master-built APK. ADB debug log is attached, the key lines to me appear to be:I/LibreOffice/sofficemain(30374): Unhandled UNO exception: 'component context fails to supply singleton com.sun.star.task.OfficeRestartManager of type com.sun.star.task.XRestartManager'I/stderr (30374): terminate called after throwing an instance of 'com::sun::star::uno::DeploymentException'F/libc (30374): Fatal signal 6 (SIGABRT) in tid 473 (Thread-204)Additionally I get the same error if I attempt to show "more info" from the about dialog.I can reproduce this as well.(Cloph: just realized that you weren't cc'd on this bug)Testing again with Android 5.1.1 +Daily build (master) 2016-03-17 07:18:48 5b3fee11(In reply to mycae from)YepI'm still unable to open any file in the Viewer.I get the error "Unfortunately, LibreOffice Viewer has stopped." if I-> Try to open an ODT, ODS, ODP, or ODG-> or if I click on the 'MORE INFO' linkIf I click "OK" in the error dialog and then try to open another file (the same one or a different one), then LibreOffice appears to crash (taking me back to the home screen).The Android Viewer is completely broken in this state, so bumping up Importance:Severity -> highest***has been marked as a duplicate of this bug. ***Fixed by Christian Lohmaier inBTW it was (first) broken in(part of tdf#74608)Now app crashes at launch, see
id=97033	Createdtest odb fileThis is a clone ofwhich affects current master buildsLibreOffice crashes when editing the attached .odb file. Base will open the file but as soon as I try do anything (access a table, query, form...), all LibreOffice windows will close without any error message, and a restart ofLibreOffice opens in recovery mode.If I open this ODB file in my master build with lldb running, I see this :warn:unoxml:45295:13:unoxml/source/dom/documentbuilder.cxx:296: libxml2 error: Extra content at the end of the documentLine: 544Column: 1Note that I see this after having attempted to change the first record in the very first table and seein LOdev bomb out on me when I tried to save the change or close the table window (I ignored the auto-recovery).This is the output when attempting to save a change to the first record of the first table :warn:vcl:45295:1:vcl/source/window/mouse.cxx:472: Window::ReleaseMouse(): window doesn't have the mouse capturewarn:legacy.osl:45295:1:include/cppuhelper/interfacecontainer.h:479: object is disposedwarn:legacy.osl:45295:1:include/cppuhelper/interfacecontainer.h:479: object is disposedwarn:legacy.osl:45295:9:connectivity/source/drivers/hsqldb/HStorageAccess.cxx:369: No Seekable stream!warn:legacy.osl:45295:9:connectivity/source/drivers/hsqldb/HStorageAccess.cxx:221: Input stream is NULL!2016-01-07T15:41:48.504+0100 SEVERE DataFileCache.setFileModifiedjava.io.IOException: Stream is not valid at com.sun.star.sdbcx.comp.hsqldb.NativeStorageAccess.read(Native Method) at com.sun.star.sdbcx.comp.hsqldb.StorageAccess.readInt(StorageAccess.java:66) at org.hsqldb.persist.RAStorageWrapper.readInt(Unknown Source) at org.hsqldb.persist.DataFileCache.setFileModified(Unknown Source) at org.hsqldb.persist.DataFileCache.saveRows(Unknown Source) at org.hsqldb.persist.Cache.saveRows(Unknown Source) at org.hsqldb.persist.Cache.saveAll(Unknown Source) at org.hsqldb.persist.DataFileCache.defrag(Unknown Source) at org.hsqldb.persist.Log.defrag(Unknown Source) at org.hsqldb.persist.Log.checkpoint(Unknown Source) at org.hsqldb.persist.Logger.checkpointInternal(Unknown Source) at org.hsqldb.persist.Logger.checkpoint(Unknown Source) at org.hsqldb.StatementCommand.getResult(Unknown Source) at org.hsqldb.StatementCommand.execute(Unknown Source) at org.hsqldb.Session.executeCompiledStatement(Unknown Source) at org.hsqldb.Session.executeDirectStatement(Unknown Source) at org.hsqldb.Session.execute(Unknown Source) at org.hsqldb.jdbc.JDBCStatement.fetchResult(Unknown Source) at org.hsqldb.jdbc.JDBCStatement.execute(Unknown Source)Process 45295 stopped* thread #1: tid = 0x61b20a, 0x00000001067c717e libtllo.dylib`DbgUnhandledException(com::sun::star::uno::Any const&, char const*, char const*) + 926, queue = 'com.apple.main-thread', stop reason = signal SIGSEGV frame #0: 0x00000001067c717e libtllo.dylib`DbgUnhandledException(com::sun::star::uno::Any const&, char const*, char const*) + 926libtllo.dylib`DbgUnhandledException(com::sun::star::uno::Any const&, char const*, char const*):-> 0x1067c717e <+926>: movq 0x8(%rcx), %rcx 0x1067c7182 <+930>: movq %rcx, -0x80(%rbp) 0x1067c7186 <+934>: leaq 0xb5935(%rip), %rsi ; "\ncontext: " 0x1067c718d <+941>: leaq -0x88(%rbp), %rdi CreatedbacktraceConfirmed by Julien inofCreatedScreenshot with a table openHi @Alex,I can't reproduce, with or without OpenGL enable.Win10x64Version: 5.2.0.0.alpha0+Build ID: 22e5170af74c635cf55d089f97946b6dc86f82adCPU Threads: 4; OS Version: Windows 6.2; UI Render: default; TinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2016-01-05_23:41:26Java 1.8.0_66 x86.Attached screenshot with a table open. No issue open queries or forms, but first report give 'General error' and others seems a bit slow.@m.a.risov : It isn't the opening that is the problem, it is trying to edit any of the data in the records. What heppens when you try to edit the first text field of the first row of that table, then attempt to save the change, either by closing the table without clicking on the disk icon, or by clicking on the disk icon and then closing the table ?CreatedScreen with table editedHi @Alex, sorry but nothing special happens.As you can see in the screenshot, edited the first record, for text and number. I can close the table, close the DB, open it again and modified data is there.For confirmation, is verified that it's not a profile issue?Alex: your file seems corrupted.Here's the result of a command (from pc Debian testing x86-64):zip -T test.zipreports/Obj11/settings.xml bad CRC 6ca9dad9 (should be 0e002e59) error: invalid compressed data to inflate forms/Obj61/Configurations2/accelerator/current.xmlCan you guys try this file :this is the one I originally used to test, and as Julien says, the file I attached to this current bug report seems to have been corrupted by LO master (the XML stream must be missing a tag somewhere, or has had an unmatched tag inserted, when it crashed.That being said, LO shouldn't crash on a malformed XML stream (especially, if it is one that it has created itself, e.g. due to a crash of the app.)(In reply to Alex Thurgood from)Oh, forget it, that file is already corrupt too. However, as I mentioned in, LO5032 on Mac opens this corrupted file fine, whereas my master dbgutil build crashes when I try to edit anything in the same file (hence this particular bug report).In lldb, the file is indicated as corrupt by this message :warn:unoxml:45295:13:unoxml/source/dom/documentbuilder.cxx:296: libxml2 error: Extra content at the end of the documentLine: 544Column: 1(In reply to Alex Thurgood from)About this error, it could linked to update checking process, see the bugtracker I created tdf#97175in a current Linux master build i've opened every table, query, form and reportin the documentbut the only problem i've found is an assert that doesn't match the attachedbacktrace at all, fixed with commit 7e349c0eee15fa0f9d8d71a3c9e311d2da62e670.oh, one report didn't open with "general error", suppose that's the wrong CRC issue in the zip file.Cannot reproduce any problem opening, opening "Book List" table, editing the first row's "Title" entry (by appending "1"), then clicking the "Save current record" icon; with a local 64-bit, --enable-dbgutil master build on Mac OS X 10.11.no one can apparently reproduce this in master
id=97077	Open the database creation wizard, click Next->Finish, give a name to the file and click Save. This triggers the assert:SfxItemPool::Delete(): Assertion `pImp->ppStaticDefaults' failed.From:commit 43de9a5b0f68a77a10595b3f69c6145cd9be05b6Author: Stephan Bergmann <>Date: Wed Jan 6 16:13:52 2016 +0100 What these SAL_INFO probably want to tell us... ...given the oldest incarnation of the code still available is HACK( "fuer Image, dort gibt es derzeit keine Statics - Bug" ) if ( ppStaticDefaults ) and HACK( "fuer Image, dort gibt es derzeit keine Statics - Bug" ) if ( ppStaticDefaults ) from cf7e1f9cc99e7c260cfab823f2c47f56035bdbd0 "INTEGRATION: CWS visibility03: #i45006# Moved from svtools/source/items/ (for svl/items1.lib)"... ...is that ppStaticDefaults should really be non-null, but "Image" (Draw? Impress?) needed a temporary (?) hack there. Test that assumption by asserting that ppStaticDefaults is non-null. Change-Id: I2a75547618da1d211c44176e4593f6951a0e0298 Confirming onVersion: 5.2.0.0.alpha0+Build ID: c93a43c0c9113bc1c787fe6b3c5e58a8bfd80be0CPU Threads: 2; OS Version: -; UI Render: default; Locale : fr-FR (fr.UTF-8)OSX 10.11.2Createdbt with debug symbolsOn pc Debian x86-64 with master sources updated today, I could reproduce the crash just by clicking "Cancel" button after the wizard started.Createdbt from "OGenericUnoDialog::OnDialogDying: where does this come from?"Also includes a gdb print of *thisStephan Bergmann committed a patch related to this issue.It has been pushed to "master":tdf#97077: So ppStaticDefaults can be null after allIt will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=97411	Open Calc. Insert->Object->Formula... Crash.Looks like a regression of:commit 0e7cd653ea90da388820220bf6a3eb140b57bbd6Author: Maxim Monastirsky <>Date: Mon Jan 25 01:09:03 2016 +0200 tdf#86567 Dropdown for conditional formatting Change-Id: I1ba12a8b7501065e3cd52e17b7c0c83a0f58f9cfHappens only with gtk2 vclplug. Most likely Unity global menu code related (lp#1296715). (Why do we run this code unconditionally on other DEs?) Maxim Monastirsky committed a patch related to this issue.It has been pushed to "master":tdf#97411 ResourceMenuController: Don't forget to dispose MenuBarManagerIt will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=97437	CreatedStrace of the crashSteps:1) open the daily build2) create a new calc spreadsheet3) Enter some random data in Sheet14) create a pivot table using the data as sourceCurrent:LibreOffice crashes. The auto recovery process restore the original Sheet1 and a second sheet with the pivot table.Expected:LibreOffice creates the pivot tablecrash with:Version: 5.2.0.0.alpha0+Build ID: d1a49df6833ff16f5cbaf98534eaae62693e520bCPU Threads: 4; OS Version: Linux 4.4; UI Render: default; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-01-29_02:01:58Locale: it-IT (it_IT.UTF-8)Work fine with:Version: 5.2.0.0.alpha0+Build ID: d95d9d7f908419f397941ef60ac6ced3261c9b87CPU Threads: 4; OS Version: Linux 4.4; UI Render: default; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-01-19_00:40:21Locale: it-IT (it_IT.UTF-8)The crash is a regression related to commit: I can confirm crash with Version: 5.2.0.0.alpha0+Build ID: d1a49df6833ff16f5cbaf98534eaae62693e520bCPU Threads: 4; OS Version: Linux 4.2; UI Render: default; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-01-29_02:01:58Katarina, could you take a look? The crash is a regression related to commit:ThanksSure, Marina was showing me the bug live on hackfestKatarina Behrens committed a patch related to this issue.It has been pushed to "master":tdf#97437: Don't crash when creating new pivot tableIt will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=97796	Insert an image then rotated 90°. Image does not render, with OpenGL activated. With OpenGL activated image renders as expected. bug confirmed using LibO 5.1.0.3 under Win8x64please tell your Windows and LibO version as well.Oscar: please paste here the contents of your file:C:\Users\User\AppData\Roaming\LibreOffice\4\cache\opengl_device.logPlease re-test with Tomaz' fix for=) thanks !*** This bug has been marked as a duplicate of***CreatedMy opengl_device.logPaste text from my opengl_device.log
id=98365	Steps:1) Install Windows x64 build2) Clear the user profile if one already exists3) Open LibreOffice4) CrashThe crash doesnt happen a second time around.Version: 5.1.1.1 (x64)Build ID: c43cb650e9c145b181321ea547d38296db70f36eCPU Threads: 2; OS Version: Windows 6.1; UI Render: default; Locale: en-US (en_US)I tried to capture the backtrace, but this is all i got.CommandLine: E:\LibreOffice\5.1x64\program\soffice.exeSymbol search path is: CACHE*C:\symbols;SRV*Executable search path is: ModLoad: 00000001`3fa90000 00000001`3faa2000 soffice.exeModLoad: 00000000`77b90000 00000000`77d39000 ntdll.dllModLoad: 00000000`77970000 00000000`77a8f000 C:\Windows\system32\kernel32.dllModLoad: 000007fe`fdb70000 000007fe`fdbdc000 C:\Windows\system32\KERNELBASE.dllModLoad: 000007fe`ff620000 000007fe`ff6fb000 C:\Windows\system32\ADVAPI32.dllModLoad: 000007fe`fded0000 000007fe`fdf6f000 C:\Windows\system32\msvcrt.dllModLoad: 000007fe`ff080000 000007fe`ff09f000 C:\Windows\SYSTEM32\sechost.dllModLoad: 000007fe`ff280000 000007fe`ff3ad000 C:\Windows\system32\RPCRT4.dllModLoad: 000007fe`fe040000 000007fe`fedc8000 C:\Windows\system32\SHELL32.dllModLoad: 000007fe`fee00000 000007fe`fee71000 C:\Windows\system32\SHLWAPI.dllModLoad: 000007fe`ff5b0000 000007fe`ff617000 C:\Windows\system32\GDI32.dllModLoad: 00000000`77a90000 00000000`77b8a000 C:\Windows\system32\USER32.dllModLoad: 000007fe`fde60000 000007fe`fde6e000 C:\Windows\system32\LPK.dllModLoad: 000007fe`fdf70000 000007fe`fe039000 C:\Windows\system32\USP10.dllModLoad: 000007fe`fa890000 000007fe`fa97f000 C:\Windows\system32\MSVCR120.dll(ed0.ee0): Break instruction exception - code 80000003 (first chance)ntdll!LdrpDoDebuggerBreak+0x30:00000000`77c3cb70 cc int 30:000> gModLoad: 000007fe`fedd0000 000007fe`fedfe000 C:\Windows\system32\IMM32.DLLModLoad: 000007fe`ff400000 000007fe`ff509000 C:\Windows\system32\MSCTF.dllModLoad: 000007fe`fd800000 000007fe`fd857000 C:\Windows\system32\apphelp.dllntdll!ZwTerminateProcess+0xa:00000000`77be157a c3 ret0:000> !analyze -vLast event: ed0.ee0: Exit process 0:ed0, code 0 debugger time: Thu Mar 3 02:05:47.364 2016 (UTC + 4:00) What happens if you force OpenGL and restart? Does it crash then too? If yes - it's the well known first-time OpenGL crash. (If the system doesn't have proper GL support and it crashes, then OpenGL is disabled for the next time.)(In reply to Maxim Monastirsky from)Yes it does crash. But why does this crash only happen on x64 build, as it doesnt happen when i use a x86 build with no profile.Can you give C:\Users\User\AppData\Roaming\LibreOffice dev\4\cache\opengl_device.log(In reply to Maxim Monastirsky from)Is there a bug report for this issue?Createdopengl_device.log(In reply to Buovjaga from)Here you go. My graphics card only supports OpenGL 1.4, which is to low to render the UI.(In reply to Yousuf (Jay) Philips from)...It looks like you attached to soffice.exe, but you should actually attach to soffice.bin. Could you try this?(In reply to Yousuf (Jay) Philips from)Can't find it right now, but I remember I saw it mentioned somewhere.Createdwindbg(In reply to Maxim Monastirsky from)Here's another try.Createdwindbg2i assume this backtrace is better.I'm getting this in 5.1.3.2. Not sure if it's the same crash, but it occurs under the exact same circumstances as reported here: in x64 build with deleted profile.Even then it doesn't occur every time, but it's been happening regularly.@Meeks: Can you check my backtrace for this first startup crash for windows x64?Hi Jay - so - you sure this is a crash ? ultimately your GL device looks like it should be black-listed so there should be no GL in-use.When we do the first-ever start; on some platforms it is expected that the first run installs and initializes extensions and then the main binary exits with a given return code and should be re-started by the wrapper =) [ at least this used to be the case left & right ].Whether that happens via ZwTerminateProcess I forget =) perhaps not - but ... then again - this trace:does indeed show some GL crash / badness. Can you confirm you generated that trace with this device:because at least my master blacklist has: <blacklist> <entry os="all" vendor="intel" compare="less" version="10.18.14.4264"> <device id="all"/> </entry>Which should knock out your intel 8.15.10.1930 driver ... very strange.Thanks !(In reply to Michael Meeks from)Hi Michael, yes sure.Yes i only run windows 7 on my laptop, which is where this crash report came from.Yes this is quite strange to me as this same thing doesnt happen on the x86 build.I might be encountering a slightly different version of this issue in master, but can't say for sure. Nevertheless, I openedon that, any hints are welcome.Is it better thanks to this?+ <entry os="7" vendor="intel">+ <device id="all"/>+ </entry>See tdf#101138Intel/GL - their windows / GL driver quality is something awful before that date I suspect. It is also quite possible/probable that the 64bit drivers are worse than the 32bit ones ;-) Having said that - as Julien says - if you're running Windows 7 + Intel - the driver should be black-listed by -commit 97fb2a8a43f11dba7c3e82380589b2334d09865aAuthor: Tomaž Vajngerl <>Date: Tue Jul 26 16:21:13 2016 +0900 tdf#101138 opengl: blacklist intel drivers for Win 7So is this still an issue in a recent 5.1.x ? I'd hope not -> marking fixed. Please re-open if you can reproduce with a recent 5.1.xThanks !
id=98847	daily build master~2016-03-16_12.53.35_LibreOfficeDev_5.2.0.0.alpha0_Win_x86.msi is impossible to install LibreOffice on Windows XP! Createderror messageI can confirmIt is not necessarily a bug. Not all buildbots are configured with Windows SDK 7.1.(In reply to Andras Timar from)who it configure? before such was not.(In reply to Andras Timar from)Currently only Tinderboxes #39 and #42 are compiling x86 binaries from the Master branch. #51, #62 and 62-merge-TDF are not working. I can test the build from #42 tomorrow (since the one reported by the user is from #39)How is QA (and users) supposed to know which Windows version each Tinderbox is building for? Would it be possible to include this information on the "Build Target OS" column in?only the Windows32bit-TDF boxes (i.e. #62) compile with Win XP compatibility, so not working with the other dailies is expected/works for me. As it is en-US only build shows that it's not from the 32bit TDF box → please useAs the box is also used to do the actual release builds, and also builds the 5-1 and 5-0 branches it doesn't build master daily, but hopefully often enough...(In reply to Christian Lohmaier from)Thanks Cloph, this build works in XP.
id=98607	CreatedBacktrace of the crashDrag any file to start center.Crash.5.2 built today.64-bit, KDE Plasma 5Version: 5.2.0.0.alpha0+Build ID: 235411c9d47ecba88e46d859ea93bcecefb0c46eCPU Threads: 8; OS Version: Linux 4.4; UI Render: default; Locale: fi-FI (fi_FI.UTF-8) I can confirm with Version: 5.2.0.0.alpha0+Build ID: aaca25d67eb5ea252730cdcf555ecc04ce04a5e6CPU Threads: 4; OS Version: Linux 4.2; UI Render: default; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-02-24_23:58:47No crash wit 5.0.5.2, regressionJust happened to me, too...That's a regression ofThere is inverted condition in DNDEventDispatcher::fireDropEvent.Thanks Maxim - good catch - let me fix that =)Crashes in Window::DecrementLockCount() where mpWindowImpl is NULL, but accessed. Looks like a task for the vcl diggerWhen jumping over 'mpWindowImpl->mnLockCount--;' all works well.Other Window:: methods already use pattern return mpWindowImpl ? mpWindowImpl->mnStyle : 0;another case to use it?Armin: sounds good - we should at least not crash; but I'll add some asserts to those two methods - for some locking pair-up we shouldn't really mis the other part of the pair there I think; at least in debug mode.Fix pushed to gerrit; thanks =)tdf#98607 - fix drag and drop regression.Doesn't affect -5-1 thankfully =)Michael Meeks committed a patch related to this issue.It has been pushed to "master":tdf#98607 - fix drag and drop regression.It will be available in 5.2.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Fixed with 5.2.0.0.alpha1+
id=99008	CreatedODT document and GDB trace.Hello,Writer and the whole system freezes after opening and scrolling downTest.odt.ODT document and GDB trace are attached.System trace are empty.-- System Information:Package: libreoffice-writerVersion: 1:5.1.2~rc1-1Debian Release: 8.3 APT prefers stable APT policy: (990, 'stable'), (500, 'testing-updates'), (500, 'stable-updates'), (500, 'testing')Architecture: amd64 (x86_64)Kernel: Linux 4.4.0-1-amd64 (SMP w/4 CPU cores)Locale: LANG=ru_RU.UTF-8, LC_CTYPE=ru_RU.UTF-8 (charmap=UTF-8)Shell: /bin/sh linked to /bin/dashInit: systemd (via /run/systemd/system)Versions of packages libreoffice-writer depends on:ii libabw-0.1-1 0.1.0-2ii libc6 2.19-18+deb8u3ii libe-book-0.1-1 0.1.1-2ii libetonyek-0.1-1 0.1.1-2ii libgcc1 1:5.3.1-12ii libicu55 55.1-7ii libmwaw-0.3-3 0.3.1-2ii libodfgen-0.1-1 0.1.1-2ii libreoffice-base-core 1:5.1.2~rc1-1ii libreoffice-core 1:5.1.2~rc1-1ii librevenge-0.0-0 0.0.1-3ii libstdc++6 5.3.1-12ii libwpd-0.10-10 0.10.0-2+b1ii libwpg-0.3-3 0.3.0-3ii libwps-0.4-4 0.4.3-1ii libxml2 2.9.1+dfsg1-5+deb8u1ii uno-libs3 5.1.2~rc1-1ii ure 5.1.2~rc1-1ii zlib1g 1:1.2.8.dfsg-2+b1Versions of packages libreoffice-writer recommends:ii libreoffice-math 1:5.1.2~rc1-1Versions of packages libreoffice-writer suggests:pn default-jre | openjdk-8-jre | openjdk-7-jre | openjdk-6-jre <none>ii fonts-crosextra-caladea 20130214-1ii fonts-crosextra-carlito 20130920-1ii libreoffice-base 1:5.1.2~rc1-1pn libreoffice-gcj <none>ii libreoffice-java-common 1:5.1.2~rc1-1Versions of packages libreoffice-core depends on:ii fontconfig 2.11.0-6.3ii fonts-opensymbol 2:102.6+LibO4.3.3-2+deb8u3ii libboost-date-time1.58.0 1.58.0+dfsg-5+b1ii libc6 2.19-18+deb8u3ii libcairo2 1.14.0-2.1ii libclucene-contribs1v5 2.3.3.4-4.1ii libclucene-core1v5 2.3.3.4-4.1ii libcmis-0.5-5v5 0.5.1-2ii libcups2 1.7.5-11+deb8u1ii libcurl3-gnutls 7.38.0-4+deb8u3ii libdbus-1-3 1.10.8-1ii libdbus-glib-1-2 0.102-1ii libdconf1 0.22.0-1ii libeot0 0.01-3ii libexpat1 2.1.0-6+deb8u1ii libexttextcat-2.0-0 3.4.4-1ii libfontconfig1 2.11.0-6.3ii libfreetype6 2.5.2-3+deb8u1ii libgcc1 1:5.3.1-12ii libgl1-mesa-glx [libgl1] 10.3.2-1+deb8u1ii libglew1.13 1.13.0-2ii libglib2.0-0 2.48.0-1ii libgltf-0.0-0v5 0.0.2-4+b1ii libglu1-mesa [libglu1] 9.0.0-2ii libgraphite2-3 1.3.6-1~deb8u1ii libharfbuzz-icu0 0.9.35-2ii libharfbuzz0b 0.9.35-2ii libhunspell-1.3-0 1.3.3-3ii libhyphen0 2.8.8-1ii libice6 2:1.0.9-1+b1ii libicu55 55.1-7ii libjpeg62-turbo 1:1.3.1-12ii liblangtag1 0.5.1-3ii liblcms2-2 2.6-3+b3ii libldap-2.4-2 2.4.40+dfsg-1+deb8u2ii libmythes-1.2-0 2:1.2.4-1ii libneon27-gnutls 0.30.1-1ii libnspr4 2:4.12-1ii libnss3 2:3.23-1ii libodfgen-0.1-1 0.1.1-2ii libpcre3 2:8.35-3.3+deb8u2ii libpng12-0 1.2.50-2+deb8u2ii librdf0 1.0.17-1+b1ii libreoffice-common 1:5.1.2~rc1-1ii librevenge-0.0-0 0.0.1-3ii libsm6 2:1.2.2-1+b1ii libssl1.0.2 1.0.2g-1ii libstdc++6 5.3.1-12ii libx11-6 2:1.6.2-3ii libxext6 2:1.3.3-1ii libxinerama1 2:1.1.3-1+b1ii libxml2 2.9.1+dfsg1-5+deb8u1ii libxrandr2 2:1.5.0-1ii libxrender1 1:0.9.8-1+b1ii libxslt1.1 1.1.28-2+b2ii uno-libs3 5.1.2~rc1-1ii ure 5.1.2~rc1-1ii zlib1g 1:1.2.8.dfsg-2+b1-- no debconf information I can not confirm with Version: 5.2.0.0.alpha0+; win7(In reply to raal from)Hello,Could you test on 5.1.2.1_rc1 version?Needs to be confirmed independently. Changing status back to Unconfirmed. If you want to test, dev version you can download here(In reply to raal from)Please, would you be able to confirm the bug independently for 5.1.2.1 rc?I reproduced this in Windows with LO 5.1.2.2 so bug existed in both platforms. But, I didn't with master~2016-03-27_09.52.41_LibreOfficeDev_5.2.0.0.alpha0_Win_x86 so I'll close as WFM. Please test yourself fromand reopen if proved otherwise.Whether bug will be backported to 5.1 is another issue. Original bug where this was fixed should be found and checked.(In reply to Timur from)This issue was reported for the current 5.1.2 release candidate version of LibreOffice in the hope that it will be fixed in release, didn't it?I guess it doesn't make sense to close the bug until it is fixed in 5.1.2. So it's status DOESNOTWORKSFORYOUYET :-) Otherwise there was no sense to report a bug to the release candidate and certainly makes no sense to fix this bug in 5.1.2 release.That's not how LO works. Please don't reopen unless tested with master.Bug wasn't reproduced with master~2016-03-27_09.53.05_LibreOfficeDev_5.2.0.0.alpha0_Linux_x86-64_deb.tar.gz I hope bugfix would be ported back to 5.1.2 release.I've found similar existing bugs but I haven't found similar bugs that are solved in 5.2.0.0.alpha0 yet.I wouldnt consider a bug fixed if the bug brings a user's session to a halt on LO Fresh.@raal: Can you bibisect this and see where it was fixed.Createdmaster vs 5.1Bug isnt in 5.0.Version: 5.0.5.2Build ID: 55b006a02d247b5f7215fc6ea0fde844b30035b3Locale: en-US (en_US.UTF-8)Bug shows a std::bad_alloc error dialog in 5.1.1 and then crashes.Version: 5.1.1.3Build ID: 89f508ef3ecebd2cfb8e1def0f0ba9a803b88a6dCPU Threads: 2; OS Version: Linux 4.2; UI Render: default; Locale: en-US (en_US.UTF-8)Bug isnt there in master.Version: 5.2.0.0.alpha0+Build ID: 02fb3fd0533222dfea5b6b9232425a5e28cd340fCPU Threads: 2; OS Version: Linux 4.2; UI Render: default; TinderBox: Linux-rpm_deb-x86@71-TDF, Branch:master, Time: 2016-03-29_06:02:35Locale: en-US (en_US.UTF-8)I believe the cause of the problem is the formula renderer, as 5.1 doesnt render formula's correctly, as can be seen in the screenshot. The bug happens after scrolling past the metafile on page 3, which is the formula "S = πR^{2} - πr^{2} = π(R^{2} - r^{2})".Should be in 5.1.3 -> looking at-> target:5.1.3So test with dev5.1:reverse bisecting:8df61b71a38cbab777e01c47efdbdaaa1bd78b2f is the first bad commitcommit 8df61b71a38cbab777e01c47efdbdaaa1bd78b2fAuthor: Norbert Thiebaud <>Date: Fri Mar 18 23:52:12 2016 -0700 source sha:c5bee7b8c1055e5052a261c8755bdb150fb27494 source sha:c5bee7b8c1055e5052a261c8755bdb150fb27494author Noel Grandin <> 2016-03-15 09:05:07 (GMT)committer Noel Grandin <> 2016-03-15 09:07:42 (GMT)commit c5bee7b8c1055e5052a261c8755bdb150fb27494 (patch)tree 1c1f5de891583f0430806ad18c2a3012cf646c88parent 73443fd278811837650160482c34c15e8830f0d3 (diff)tdf#98600 and tdf#98622 fix metafile parsingregression from commit db17d3c1 "new loplugin: memoryvar"*** This bug has been marked as a duplicate of***No bug in LibreOfficeDev 5.1.3.0.0 on Debian GNU/Linux x86-64 (2016-03-31_08.31.30).Is it possible to port back this bug fix to 5.1.2 release?(In reply to Stanislav from)Spoke with the release team and they said it wouldnt be feasible to build another 5.1.2 release just for this fix, so you'll have to wait until 5.1.3 is released or use 5.0.(In reply to Yousuf (Jay) Philips from)Understand. Unfortunately, users do not have neither Still nor the Fresh LibreOffice releases in the current Debian official branches (stable and testing, I mean). Therefore, it is impossible to install 5.0.x (Still) via package into Debian infrastructure.The release plan for LibreOffice and Debian are different, and there are no obvious proposals as for Firefox ESR/Debian, for example:"Mozilla releases new Firefox releases every 6 to 8 weeks.In parallel of these rapid releases, Mozilla proposes a version calledESR which is maintained for about 9 months.On the contrary, Debian having a longer release cycle (about every twoyears), release cycles don't align.Because of the complexity of backporting security fixes, Debian cannotmaintain a deprecated ESR release.To address this packaging issue, once a ESR cycle is over, Debian hasbeen accepting uploads of new ESR releases in the stable release." [1][1]:(In reply to Stanislav from)You can grab 5.0.x from libreoffice.org () or you can wait till next month when debian testing has 5.1.3 in the repo.
id=99691	Createdrecovery on startupSounds likebut iirc the old recovery endless loop had been fixed sometime in between then and now.1. Start latest master2. start center shows3. click any componentCurrently: LO crashes (log attached) or shows recovery dialog with nothing to recover.Expected: a working startup proceedure CreatedLO crash reportIf it happens only with today's build, then most likely it's due to yesterday's cow_wrapper commits, which is already being worked on.master build was done earlier today so your guess could be right. let's give this some time and revisit in a few daysHello steve,Thanks for reporting. Today, Noel Grandin committed f84d9ae0c9edbf5395aa8c9171c0fa1e1a41a6ab which fixes a crash I introduced yesterday. Could you please check again tomorrow and see if this issue is gone?Regardssure will doGone in master build from todayVersion: 5.2.0.0.alpha1+Build ID: ee5850893e15acda1d7ce7cf17da7c80f2fa810aCPU Threads: 4; OS Version: Mac OS X 10.11.4; UI Render: default; TinderBox: MacOSX-x86_64@49-TDF, Branch:master, Time: 2016-05-06_00:59:44Locale: de-DE (de.UTF-8)
id=99743	Createddummy DBOn step 5 of mail merge wizard the preview on the right is missing and when you uncheck the "align to text body" checkbox LibreOffice hangs and then crash.Steps:1) New writer document2) Tool -> mail merge wizard3) On step 1 select "use the current document" -> next4) On step 3 select "Letter" -> next5) Click on "Select a different address list"6) Add the attached dummy DB7) On step 3.2 select "This document shall contain an address block"8) Click the "more" button9) Click on "New" and add the fields "First Name" and "Last name" and click "ok" and "ok"10) on step 3.3 click the button "Match Fields" and combine "First name" with "Nome" and "Last Name" with "Cognome". The preview shows "Mario Rossi" -> "ok"11) click "next"12) on step 4 click "Next" without creating a salutation13) On step 5 uncheck the checkbox "Align to text body"14) hang and crash.Current: on step 5 of the wizard "Adjust layout", the preview on the right is missing and LibreOffice hangs and crashes.Expected: users can uncheck the option and go to step 6 "Edit document"IDEA: something related to?Issue on versions:Version: 5.0.3.2Build ID: e5f16313668ac592c1bfb310f4390624e3dbfb75Locale: it-IT (it_IT.UTF-8)OS: openSUSE Tumbleweed (20160422) (x86_64)Version: 5.0.4.2Build ID: 2b9802c1994aa0b7dc6079e128979269cf95bc78Locale: it-IT (it_IT.UTF-8)OS: openSUSE Tumbleweed (20160422) (x86_64)Version: 5.0.5.2Build ID: 55b006a02d247b5f7215fc6ea0fde844b30035b3Locale: it-IT (it_IT.UTF-8)OS: openSUSE Tumbleweed (20160422) (x86_64)Version: 5.1.2.2.0+Build ID: 10m0(Build:2)CPU Threads: 4; OS Version: Linux 4.5; UI Render: default; Locale: it-IT (it_IT.UTF-8)OS: openSUSE Tumbleweed (20160422) (x86_64)Works on:Version: 4.4.7.2Build ID: f3153a8b245191196a4b6b9abd1d0da16eead600Locale: it_IT.UTF-8OS: openSUSE Tumbleweed (20160422) (x86_64)Version: 5.2.0.0.alpha1+Build ID: eb7593daa4bac21bd68182c8bbbd3ee3bd7b64ddCPU Threads: 4; OS Version: Linux 4.5; UI Render: default; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-05-03_07:06:45Locale: it-IT (it_IT.UTF-8)OS: openSUSE Tumbleweed (20160422) (x86_64) Unconfirmed with v4.4.7.2 under mint 17.3 x64.Confirmed with v5.0.6.1 under mint 17.3 x64.Confirmed with v5.0.0.0b3 under mint 17.3 x64.Unconfirmed with v5.2.0.0a1 under ubuntu 16.04 x64.Seems already fixed with v5.2+, but not backported to v5.0+ and v5.1+.fixed on master, closing the bug. backportRequest:5.1
id=99757	I'm seeing a repeatable build failure on master at the moment with OSX :--with-ant-home=/Volumes/BUILDHD/Shared/packages/apache-ant-1.9.2--without-junit--enable-64-bit--with-extra-buildid--enable-ext-nlpsolver--enable-ext-google-docs--enable-ext-languagetool--enable-ext-diagram--enable-ext-typo--enable-ext-validator--enable-ext-watch-window--enable-extra-template--enable-extra-gallery--enable-ext-wiki-publisher--enable-extension-integration--with-help--enable-epm--with-package-format=dmg--enable-ext-mariadb-connector--with-system-mariadb--enable-bundle-mariadb--with-myspell-dicts--with-lang=fr--with-doxygen=/Applications/Doxygen.app/Contents/Resources/doxygen--disable-firebird-sdbcError output :/bin/sh: line 1: 30857 Abort trap: 6 DYLD_LIBRARY_PATH=${DYLD_LIBRARY_PATH:+$DYLD_LIBRARY_PATH:}"$I/LibreOfficeDev.app/Contents/Frameworks:$I/LibreOfficeDev.app/Contents/Frameworks":$W/LinkTarget/Library:$W/UnpackedTarball/cppunit/src/cppunit/.libs $W/LinkTarget/Executable/cppunittester $W/LinkTarget/CppunitTest/libtest_dbaccess_RowSetClones.dylib --headless "-env:BRAND_BASE_DIR=file://$I/LibreOfficeDev.app/Contents" "-env:BRAND_SHARE_SUBDIR=Resources" "-env:UserInstallation=file://$W/CppunitTest/dbaccess_RowSetClones.test.user" "-env:CONFIGURATION_LAYERS=xcsxcu:file://$I/LibreOfficeDev.app/Contents/Resources/registry xcsxcu:file://$W/unittest/registry" "-env:UNO_TYPES=file://$I/LibreOfficeDev.app/Contents/Resources/types/offapi.rdb file://$I/LibreOfficeDev.app/Contents/Resources/types/oovbaapi.rdb file://$I/LibreOfficeDev.app/Contents/Resources/ure/share/misc/types.rdb" "-env:UNO_SERVICES=file://$W/Rdb/ure/services.rdb file://$W/ComponentTarget/basic/util/sb.component file://$W/ComponentTarget/comphelper/util/comphelp.component file://$W/ComponentTarget/configmgr/source/configmgr.component file://$W/ComponentTarget/connectivity/source/drivers/hsqldb/hsqldb.component file://$W/ComponentTarget/connectivity/source/drivers/jdbc/jdbc.component file://$W/ComponentTarget/connectivity/source/manager/sdbc2.component file://$W/ComponentTarget/dbaccess/util/dba.component file://$W/ComponentTarget/dbaccess/util/dbu.component file://$W/ComponentTarget/dbaccess/util/sdbt.component file://$W/ComponentTarget/dbaccess/source/filter/xml/dbaxml.component file://$W/ComponentTarget/filter/source/config/cache/filterconfig1.component file://$W/ComponentTarget/forms/util/frm.component file://$W/ComponentTarget/framework/util/fwk.component file://$W/ComponentTarget/i18npool/util/i18npool.component file://$W/ComponentTarget/linguistic/source/lng.component file://$W/ComponentTarget/oox/util/oox.component file://$W/ComponentTarget/package/source/xstor/xstor.component file://$W/ComponentTarget/package/util/package2.component file://$W/ComponentTarget/sax/source/expatwrap/expwrap.component file://$W/ComponentTarget/scripting/source/basprov/basprov.component file://$W/ComponentTarget/scripting/util/scriptframe.component file://$W/ComponentTarget/sfx2/util/sfx.component file://$W/ComponentTarget/sot/util/sot.component file://$W/ComponentTarget/svl/source/fsstor/fsstorage.component file://$W/ComponentTarget/svl/util/svl.component file://$W/ComponentTarget/toolkit/util/tk.component file://$W/ComponentTarget/ucb/source/core/ucb1.component file://$W/ComponentTarget/ucb/source/ucp/file/ucpfile1.component file://$W/ComponentTarget/ucb/source/ucp/tdoc/ucptdoc1.component file://$W/ComponentTarget/unotools/util/utl.component file://$W/ComponentTarget/unoxml/source/rdf/unordf.component file://$W/ComponentTarget/unoxml/source/service/unoxml.component file://$W/ComponentTarget/xmloff/util/xo.component" -env:URE_INTERNAL_LIB_DIR=file://$I/LibreOfficeDev.app/Contents/Frameworks -env:LO_LIB_DIR=file://$I/LibreOfficeDev.app/Contents/Frameworks -env:LO_JAVA_DIR=file://$I/LibreOfficeDev.app/Contents/Resources/java --protector $W/LinkTarget/Library/unoexceptionprotector.dylib unoexceptionprotector --protector $W/LinkTarget/Library/unobootstrapprotector.dylib unobootstrapprotector --protector $W/LinkTarget/Library/libvclbootstrapprotector.dylib vclbootstrapprotector "-env:CPPUNITTESTTARGET=$W/CppunitTest/dbaccess_RowSetClones.test" > $W/CppunitTest/dbaccess_RowSetClones.test.log 2>&1## A fatal error has been detected by the Java Runtime Environment:## SIGSEGV (0xb) at pc=0x000000010a855a5c, pid=30857, tid=0x000000000000050f## JRE version: Java(TM) SE Runtime Environment (8.0_92-b14) (build 1.8.0_92-b14)# Java VM: Java HotSpot(TM) 64-Bit Server VM (25.92-b14 mixed mode bsd-amd64 compressed oops)# Problematic frame:# C [libdbalo.dylib+0x15a5c] dbaccess::ORowSetDataColumn::ORowSetDataColumn(com::sun::star::uno::Reference<com::sun::star::sdbc::XResultSetMetaData> const&, com::sun::star::uno::Reference<com::sun::star::sdbc::XRow> const&, com::sun::star::uno::Reference<com::sun::star::sdbc::XRowUpdate> const&, int, com::sun::star::uno::Reference<com::sun::star::sdbc::XDatabaseMetaData> const&, rtl::OUString const&, rtl::OUString const&, std::__1::function<connectivity::ORowSetValue const& (int)> const&)+0x10c## Failed to write core dump. Core dumps have been disabled. To enable core dumping, try "ulimit -c unlimited" before starting Java again## An error report file with more information is saved as:# /Volumes/BUILDHD/Shared/LO/core/hs_err_pid30857.log## If you would like to submit a bug report, please visit:##Fatal exception: Signal 6Stack:/Volumes/BUILDHD/Shared/LO/core/instdir/LibreOfficeDev.app/Contents/Frameworks/libuno_sal.dylib.3+0x336c4(_ZN12_GLOBAL__N_110printStackEi+0x34)[0x1043b26c4]/Volumes/BUILDHD/Shared/LO/core/instdir/LibreOfficeDev.app/Contents/Frameworks/libuno_sal.dylib.3+0x335a8(_ZN12_GLOBAL__N_121signalHandlerFunctionEi+0x328)[0x1043b25a8]/usr/lib/system/libsystem_platform.dylib+0x252a(_sigtramp+0x1a)[0x7fff90a6b52a]Error: a unit test failed, please do one of:make CppunitTest_dbaccess_RowSetClones CPPUNITTRACE="lldb --" # for interactive debugging on OS Xmake CppunitTest_dbaccess_RowSetClones VALGRIND=memcheck # for memory checkingmake[1]: *** [/Volumes/BUILDHD/Shared/LO/core/workdir/CppunitTest/dbaccess_RowSetClones.test] Error 1make[1]: *** Waiting for unfinished jobs....make: *** [build] Error 2 As the bug prevents the build from completing, setting to critical.s1:core alex$ make CppunitTest_dbaccess_RowSetClones CPPUNITTRACE="lldb --"/Applications/Xcode.app/Contents/Developer/usr/bin/make -j 2 -rs -f /Volumes/BUILDHD/Shared/LO/core/Makefile.gbuild CppunitTest_dbaccess_RowSetClones[build CUT] dbaccess_RowSetClones(lldb) target create "/Volumes/BUILDHD/Shared/LO/core/workdir/LinkTarget/Executable/cppunittester"Current executable set to '/Volumes/BUILDHD/Shared/LO/core/workdir/LinkTarget/Executable/cppunittester' (x86_64).(lldb) settings set -- target.run-args "/Volumes/BUILDHD/Shared/LO/core/workdir/LinkTarget/CppunitTest/libtest_dbaccess_RowSetClones.dylib" "--headless" "-env:BRAND_BASE_DIR=file:///Volumes/BUILDHD/Shared/LO/core/instdir/LibreOfficeDev.app/Contents" "-env:BRAND_SHARE_SUBDIR=Resources" "-env:UserInstallation=file:///Volumes/BUILDHD/Shared/LO/core/workdir/CppunitTest/dbaccess_RowSetClones.test.user" "-env:CONFIGURATION_LAYERS=xcsxcu:file:///Volumes/BUILDHD/Shared/LO/core/instdir/LibreOfficeDev.app/Contents/Resources/registry xcsxcu:file:///Volumes/BUILDHD/Shared/LO/core/workdir/unittest/registry" "-env:UNO_TYPES=file:///Volumes/BUILDHD/Shared/LO/core/instdir/LibreOfficeDev.app/Contents/Resources/types/offapi.rdb file:///Volumes/BUILDHD/Shared/LO/core/instdir/LibreOfficeDev.app/Contents/Resources/types/oovbaapi.rdb file:///Volumes/BUILDHD/Shared/LO/core/instdir/LibreOfficeDev.app/Contents/Resources/ure/share/misc/types.rdb" "-env:UNO_SERVICES=file:///Volumes/BUILDHD/Shared/LO/core/workdir/Rdb/ure/services.rdb file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/basic/util/sb.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/comphelper/util/comphelp.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/configmgr/source/configmgr.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/connectivity/source/drivers/hsqldb/hsqldb.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/connectivity/source/drivers/jdbc/jdbc.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/connectivity/source/manager/sdbc2.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/dbaccess/util/dba.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/dbaccess/util/dbu.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/dbaccess/util/sdbt.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/dbaccess/source/filter/xml/dbaxml.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/filter/source/config/cache/filterconfig1.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/forms/util/frm.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/framework/util/fwk.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/i18npool/util/i18npool.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/linguistic/source/lng.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/oox/util/oox.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/package/source/xstor/xstor.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/package/util/package2.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/sax/source/expatwrap/expwrap.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/scripting/source/basprov/basprov.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/scripting/util/scriptframe.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/sfx2/util/sfx.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/sot/util/sot.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/svl/source/fsstor/fsstorage.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/svl/util/svl.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/toolkit/util/tk.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/ucb/source/core/ucb1.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/ucb/source/ucp/file/ucpfile1.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/ucb/source/ucp/tdoc/ucptdoc1.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/unotools/util/utl.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/unoxml/source/rdf/unordf.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/unoxml/source/service/unoxml.component file:///Volumes/BUILDHD/Shared/LO/core/workdir/ComponentTarget/xmloff/util/xo.component" "-env:URE_INTERNAL_LIB_DIR=file:///Volumes/BUILDHD/Shared/LO/core/instdir/LibreOfficeDev.app/Contents/Frameworks" "-env:LO_LIB_DIR=file:///Volumes/BUILDHD/Shared/LO/core/instdir/LibreOfficeDev.app/Contents/Frameworks" "-env:LO_JAVA_DIR=file:///Volumes/BUILDHD/Shared/LO/core/instdir/LibreOfficeDev.app/Contents/Resources/java" "--protector" "/Volumes/BUILDHD/Shared/LO/core/workdir/LinkTarget/Library/unoexceptionprotector.dylib" "unoexceptionprotector" "--protector" "/Volumes/BUILDHD/Shared/LO/core/workdir/LinkTarget/Library/unobootstrapprotector.dylib" "unobootstrapprotector" "--protector" "/Volumes/BUILDHD/Shared/LO/core/workdir/LinkTarget/Library/libvclbootstrapprotector.dylib" "vclbootstrapprotector" "-env:CPPUNITTESTTARGET=/Volumes/BUILDHD/Shared/LO/core/workdir/CppunitTest/dbaccess_RowSetClones.test"(lldb) runProcess 31065 launched: '/Volumes/BUILDHD/Shared/LO/core/workdir/LinkTarget/Executable/cppunittester' (x86_64)dyld: Library not loaded: @__VIA_LIBRARY_PATH__/libuno_sal.dylib.3 Referenced from: /Volumes/BUILDHD/Shared/LO/core/workdir/LinkTarget/Executable/cppunittester Reason: image not foundProcess 31065 stopped* thread #1: tid = 0x1adad3, 0x00007fff5fc01075 dyld`dyld_fatal_error + 1, stop reason = EXC_BREAKPOINT (code=EXC_I386_BPT, subcode=0x0) frame #0: 0x00007fff5fc01075 dyld`dyld_fatal_error + 1dyld`dyld_fatal_error:-> 0x7fff5fc01075 <+1>: nop dyld`dyldbootstrap::start: 0x7fff5fc01076 <+0>: pushq %rbp 0x7fff5fc01077 <+1>: movq %rsp, %rbp 0x7fff5fc0107a <+4>: pushq %r15Createdfull btBadfully I haven't succeeded in building LO on MacOs since 1 year so I can't help here :-( (with enable-dbgtutil + "make" not "make build")(see)(In reply to Julien Nabet from)Hi Julien,Yes, I saw that too. My own dbgutil builds fail in another Writer unit test so I have givenup on them, but this particular build attempt isn't using the --enable-dbgutil switch.Createdsome log with jdk1.8.0_31Hello,as I have some problem with this test, I try compiling some older JDKs: JDK 1.8.0_91 and JDK 1.8.0_31 but I have no success :-~ Notes: - I have also a problem with CppunitTest_sw_mailmerge and the compiled version only "works" when sw is compiled in debug mode :-~ So this can be a different problem- finally, a selected part of the make's output and I attached the generated log:==========================================================================================# Failed to write core dump. Core dumps have been disabled. To enable core dumping, try "ulimit -c unlimited" before starting Java again## An error report file with more information is saved as:# /Users/alonso/sources/LibreOffice/libreoffice/core/hs_err_pid20569.log## If you would like to submit a bug report, please visit:##Fatal exception: Signal 6Stack:/Users/alonso/sources/LibreOffice/libreoffice/core/instdir/LibreOfficeDev.app/Contents/Frameworks/libuno_sal.dylib.3+0x336b4(_ZN12_GLOBAL__N_110printStackEi+0x34)[0x10ab256b4]/Users/alonso/sources/LibreOffice/libreoffice/core/instdir/LibreOfficeDev.app/Contents/Frameworks/libuno_sal.dylib.3+0x33598(_ZN12_GLOBAL__N_121signalHandlerFunctionEi+0x328)[0x10ab25598]/usr/lib/system/libsystem_platform.dylib+0x252a(_sigtramp+0x1a)[0x7fff9621552a][0x7fff55113790]/usr/lib/system/libsystem_c.dylib+0x5e6e7(abort+0x81)[0x7fff8db9a6e7]/Library/Java/JavaVirtualMachines/jdk1.8.0_31.jdk/Contents/Home/jre/lib/server/libjvm.dylib+0x45cf1f(_ZN2os5abortEb+0x19)[0x17bd89f1f]/Library/Java/JavaVirtualMachines/jdk1.8.0_31.jdk/Contents/Home/jre/lib/server/libjvm.dylib+0x579e36(_ZN7VMError14report_and_dieEv+0x8d4)[0x17bea6e36]/Library/Java/JavaVirtualMachines/jdk1.8.0_31.jdk/Contents/Home/jre/lib/server/libjvm.dylib+0x45ea92(JVM_handle_bsd_signal+0x46b)[0x17bd8ba92]/Library/Java/JavaVirtualMachines/jdk1.8.0_31.jdk/Contents/Home/jre/lib/server/libjvm.dylib+0x45af53(_Z13signalHandleriP9__siginfoPv+0x2f)[0x17bd87f53]/usr/lib/system/libsystem_platform.dylib+0x252a(_sigtramp+0x1a)[0x7fff9621552a][0x7f8ec409a7b8]/Users/alonso/sources/LibreOffice/libreoffice/core/instdir/LibreOfficeDev.app/Contents/Frameworks/libdbalo.dylib+0x6db7f(_ZN8dbaccess7ORowSet27execute_NoApprove_NoNewConnERN3osl15ResettableGuardINS1_5MutexEEE+0xf5f)[0x111215b7f]/Users/alonso/sources/LibreOffice/libreoffice/core/instdir/LibreOfficeDev.app/Contents/Frameworks/libdbalo.dylib+0x6ffa0(_ZN8dbaccess7ORowSet7executeEv+0xf0)[0x111217fa0]/Users/alonso/sources/LibreOffice/libreoffice/core/workdir/LinkTarget/CppunitTest/libtest_dbaccess_RowSetClones.dylib+0x3180(_ZN12RowSetClones4testEv+0xbe0)[0x10ed56180]/Users/alonso/sources/LibreOffice/libreoffice/core/workdir/UnpackedTarball/cppunit/src/cppunit/.libs/libcppunit-1.13.0.dylib+0x34815(_ZNK7CppUnit21TestCaseMethodFunctorclEv+0x65)[0x10ab9c815]/Users/alonso/sources/LibreOffice/libreoffice/core/workdir/UnpackedTarball/cppunit/src/cppunit/.libs/libcppunit-1.13.0.dylib+0x23198(_ZNK7CppUnit14ProtectorChain14ProtectFunctorclEv+0x28)[0x10ab8b198]/Users/alonso/sources/LibreOffice/libreoffice/core/workdir/UnpackedTarball/cppunit/src/cppunit/.libs/libcppunit-1.13.0.dylib+0x23198(_ZNK7CppUnit14ProtectorChain14ProtectFunctorclEv+0x28)[0x10ab8b198]/Users/alonso/sources/LibreOffice/libreoffice/core/workdir/LinkTarget/Library/unoexceptionprotector.dylib+0x16f4(_ZN12_GLOBAL__N_14Prot7protectERKN7CppUnit7FunctorERKNS1_16ProtectorContextE+0x34)[0x10af326f4]/Users/alonso/sources/LibreOffice/libreoffice/core/workdir/UnpackedTarball/cppunit/src/cppunit/.libs/libcppunit-1.13.0.dylib+0x23198(_ZNK7CppUnit14ProtectorChain14ProtectFunctorclEv+0x28)[0x10ab8b198]/Users/alonso/sources/LibreOffice/libreoffice/core/workdir/UnpackedTarball/cppunit/src/cppunit/.libs/libcppunit-1.13.0.dylib+0x41ef(_ZN7CppUnit16DefaultProtector7protectERKNS_7FunctorERKNS_16ProtectorContextE+0x4f)[0x10ab6c1ef]/Users/alonso/sources/LibreOffice/libreoffice/core/workdir/UnpackedTarball/cppunit/src/cppunit/.libs/libcppunit-1.13.0.dylib+0x23198(_ZNK7CppUnit14ProtectorChain14ProtectFunctorclEv+0x28)[0x10ab8b198]/Users/alonso/sources/LibreOffice/libreoffice/core/workdir/UnpackedTarball/cppunit/src/cppunit/.libs/libcppunit-1.13.0.dylib+0x21e6e(_ZN7CppUnit14ProtectorChain7protectERKNS_7FunctorERKNS_16ProtectorContextE+0x6ce)[0x10ab89e6e]/Users/alonso/sources/LibreOffice/libreoffice/core/workdir/UnpackedTarball/cppunit/src/cppunit/.libs/libcppunit-1.13.0.dylib+0x54983(_ZN7CppUnit10TestResult7protectERKNS_7FunctorEPNS_4TestERKNSt3__112basic_stringIcNS6_11char_traitsIcEENS6_9allocatorIcEEEE+0x63)[0x10abbc983]/Users/alonso/sources/LibreOffice/libreoffice/core/workdir/UnpackedTarball/cppunit/src/cppunit/.libs/libcppunit-1.13.0.dylib+0x33f92(_ZN7CppUnit8TestCase3runEPNS_10TestResultE+0x302)[0x10ab9bf92]/Users/alonso/sources/LibreOffice/libreoffice/core/workdir/UnpackedTarball/cppunit/src/cppunit/.libs/libcppunit-1.13.0.dylib+0x34ecd(_ZN7CppUnit13TestComposite15doRunChildTestsEPNS_10TestResultE+0x7d)[0x10ab9cecd]/Users/alonso/sources/LibreOffice/libreoffice/core/workdir/UnpackedTarball/cppunit/src/cppunit/.libs/libcppunit-1.13.0.dylib+0x34d4a(_ZN7CppUnit13TestComposite3runEPNS_10TestResultE+0x5a)[0x10ab9cd4a]/Users/alonso/sources/LibreOffice/libreoffice/core/workdir/UnpackedTarball/cppunit/src/cppunit/.libs/libcppunit-1.13.0.dylib+0x34ecd(_ZN7CppUnit13TestComposite15doRunChildTestsEPNS_10TestResultE+0x7d)[0x10ab9cecd]/Users/alonso/sources/LibreOffice/libreoffice/core/workdir/UnpackedTarball/cppunit/src/cppunit/.libs/libcppunit-1.13.0.dylib+0x34d4a(_ZN7CppUnit13TestComposite3runEPNS_10TestResultE+0x5a)[0x10ab9cd4a]/Users/alonso/sources/LibreOffice/libreoffice/core/workdir/UnpackedTarball/cppunit/src/cppunit/.libs/libcppunit-1.13.0.dylib+0x612de(_ZN7CppUnit10TestRunner13WrappingSuite3runEPNS_10TestResultE+0x4e)[0x10abc92de]/Users/alonso/sources/LibreOffice/libreoffice/core/workdir/UnpackedTarball/cppunit/src/cppunit/.libs/libcppunit-1.13.0.dylib+0x544c2(_ZN7CppUnit10TestResult7runTestEPNS_4TestE+0x52)[0x10abbc4c2]/Users/alonso/sources/LibreOffice/libreoffice/core/workdir/UnpackedTarball/cppunit/src/cppunit/.libs/libcppunit-1.13.0.dylib+0x61608(_ZN7CppUnit10TestRunner3runERNS_10TestResultERKNSt3__112basic_stringIcNS3_11char_traitsIcEENS3_9allocatorIcEEEE+0x68)[0x10abc9608]/Users/alonso/sources/LibreOffice/libreoffice/core/workdir/LinkTarget/Executable/cppunittester+0x272e(_ZNK12_GLOBAL__N_123ProtectedFixtureFunctor3runEv+0x36e)[0x10aae072e]/Users/alonso/sources/LibreOffice/libreoffice/core/workdir/LinkTarget/Executable/cppunittester+0x1964(main+0x4e4)[0x10aadf964]/usr/lib/system/libdyld.dylib+0x35ad(start+0x1)[0x7fff9349c5ad]Alex: for the test could you try with minimum autogen.input--enable-werror--enable-dbgutil--disable-firebird-sdbcafter having updated your master sources?Indeed, it's been working for me (except I've got to add a return to workaround renamed tdf#100147) since some days only!If it works, you'll be able then to try to add some other options in autogen.input.Osnola: what do you have in your autogen.input?About Java, I cleaned up every version by following this linkI quote:"sudo rm -rf /Library/Java/JavaVirtualMachines/jdk<version>.jdksudo rm -rf /Library/PreferencePanes/JavaControlPanel.prefPanesudo rm -rf /Library/Internet\ Plug-Ins/JavaAppletPlugin.pluginsudo rm -rf /Library/LaunchAgents/com.oracle.java.Java-Updater.plistsudo rm -rf /Library/PrivilegedHelperTools/com.oracle.java.JavaUpdateHelpersudo rm -rf /Library/LaunchDaemons/com.oracle.java.JavaUpdateHelper.plistsudo rm -rf /Library/Preferences/com.oracle.java.Helper-Tool.plist" and installed the last jdk 1.8 version.Hi Julien,Yes this now appears to be WFM
id=99961	Createdfull btMaster build Version: 5.2.0.0.alpha1+Build ID: 5e0bdb52e9411dda2cd1086005b469fd833dca9fThreads CPU : 2; Version de l'OS :Mac OS X 10.11.4; UI Render : par défaut; Locale : fr-FR (fr.UTF-8)Any time I attempt to load a new Writer/Calc/Impress/Draw/Math document, either directly from the command line, or via the StartCenter, I get an immediate crash.BT attached. Build switches :--with-ant-home=/Volumes/BUILDHD/Shared/packages/apache-ant-1.9.2--without-junit--enable-64-bit--with-extra-buildid--enable-extra-template--enable-extra-gallery--enable-extension-integration--with-help--enable-epm--with-package-format=dmg--enable-ext-mariadb-connector--with-system-mariadb--enable-bundle-mariadb--with-myspell-dicts--with-lang=fr--with-doxygen=/Applications/Doxygen.app/Contents/Resources/doxygen--disable-firebird-sdbcI can't build a debug build as this currently fails in several places on OSX.Fixed somehow in my build from last night (21/05)
id=100032	Bodhi MokshaVersion: 5.2.0.0.alpha1+Build ID: 369ca1d72bc877c6ccce991c92ae1a246956ca57CPU Threads: 2; OS Version: Linux 3.16; UI Render: default; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-05-22_14:48:27Locale: en-US (en_US.UTF-8)Steps to Reproduce1) Open writer;2) Select dropdown from bullet on the sidebar3) Click on the first bullet styleResult: Crash You mean from Styles and formatting - List styles - List 1? I don't get a crash.Arch Linux 64-bit, KDE Plasma 5Version: 5.3.0.0.alpha0+Build ID: 60041cb237ea73c2c1885dd6afd99d88780c2dfcCPU Threads: 8; OS Version: Linux 4.5; UI Render: default; Locale: fi-FI (fi_FI.UTF-8)Built on May 26th 2016Seems fixed in 5.2 beta.
id=99784	We can't install an extension on OS X by double click on oxt file. ***has been marked as a duplicate of this bug. ***Confirmed → NEWVersion: 5.2.0.0.alpha1+Build ID: b871a97d35a4160b7403c07bfac10aaa744fbbfdCPU Threads: 4; OS Version: Mac OS X 10.11.4; UI Render: default; TinderBox: MacOSX-x86_64@49-TDF, Branch:master, Time: 2016-05-11_01:01:27Locale: de-DE (de.UTF-8)Reproduce steps1. download any extension from the extension website e.g. " Copy only visible cells" from2. double click downloaded .oxt fileCurrentlyLibreoffice extension manager opens and installation starts but gets stuck after a few secondsExpectedInstallation should work just as it does when clicking "Add..." in the extension manager.The bug with "Add..." button is already fix (), but not for the double click.CreatedScreenshot of malloc trace using Instruments.appFWIW, I am enclosing an Instruments.app trace of malloc behaviour on LO-dev master. Note the profile is relatively smooth at the beginning, when LO is launched. The memory heap increases continuously when I drag and drop an extension onto the LO app icon in the dock and the install extension dialog appears (at which point the app stops responding).CreatedCall tree after dropping extension file onto LO app iconEnclosed is a compressed file with the call tree obtained via the Instruments.app with LO master on OSX. This represents all calls made up to the point where the extensions UI is displayed after having dropped an OXT file onto the LO app icon in the dock.CreatedTime profile of user callsThis file is a compressed text file of a time profile of user calls when LO-dev master is already running and an extension (OXT) file is dropped onto the app icon in the dock.I am having the same exact problem.LO Version: 5.1.4.2Mac 10.11.5I followed the procedure of going to the Extension Manager and choosing an extension from the open file dialog. The same exact thing happens where it starts for a few seconds but then hangs. If I leave it running, I get a memory error from my Mac stating that my system is about to run out of memory.This happens regardless of what extension I try to install.Hi, I'm just a whiner with nothing new to provide. But *please*, can this be assigned and fixed? I've been waiting and hoping for months now. I promise a $20USD donation to document foundation upon this bug being fixed and released.Ricky CharletI have this very same problem in OSX 10.11.6 with LibreOffice 5.1.4.2, and the Add button on the extension manager do NOT work either, so it seems I cannot install extensions at all.This problem is still there also in LO 5.2.0.4 (on OSX 10.11.6).As well as the update of existing extensions.This is a blocker for OSX releases.Until this is solved no LO releases should go out.The extensions system is a basic subsystem of LibreOffice, it must work or there should be a warning in the install/release notes and download page that this major feature is not working on OSX at all.We don't have blockers I'm afraid - time-based releases don't allow them.Coercing others into solving your favourite problems is not going to work. So - lets think of more positive ways.The ultimate reason why this bug is not fixed is: I don't have a Mac, I don't have access to a Mac, I'm not going to buy a Mac on my own $, and I don't have much time - even if I could solve the above.If someone can give me remote access to a Mac with a pre-build LibreOffice with debugging symbols, a console, and so on - then it would be easy enough to make progress here I think.Can you provide that ? (NB. if Apple were not quite so hyper-lame about forbidding virtualisation - then we could all debug and fix Mac problems, as we can do for Windows & Linux).Alex - the time profile looks interesting, but nothing jumps out of it. The bug is almost certainly quite trivial - an Idle handler or Timeout is being created inside another Idle handler or Timeout - and is starving the UI from being re-rendered. We just need to catch that and re-prioritise.(In reply to Michael Meeks from)Hi Michael,Is there any tool that you know of and which does not involve jumping through hoops to get it to work on OSX that I might be able to use to bring this along further ?CreatedApple traceFWIW, I am enclosing an Apple trace against my master 530 build which is produced when I force kill a hung LO process after dropping an OXT file onto the LO icon in the OSX Dock - don't know whether that helps muchI'm on Mac. If you said me what you need (log, test…) to fix the problem, I can made it for you. If you need I have Teamviewer and I can let you made some test by yourself.Hi shunesberg - it would be awesome if you could do some of this remote debugging. Getting a build of master with --enable-dbgutil configured into it (from clean) would be really helpful; and then doing:export SAL_LOG=+INFO.vcl.schedule+WARN.vcl.scheduleinto the environment, and running and stashing the output of that while making it hang. Clearly it's a priority problem.If you could get that - I think we'd make some progress. Failing that - putting some breakpoints into vcl/source/app/scheduler.cxx to see what new Idle/Timeout task is being added, at what priority in order to make these bad things happen - would be great to find out =)Thanks !@Michael : I added a scheduler trace containing the output from the terminal with the SAL command you indicated. I don't think that is going to help much as it doesn't seem to identify which code path is responsible. This is just a short sample of the output, as I managed to bring my Mac mini to its knees by letting it run for 2 minutes or so. The same messages just seem to get respawned constantly.CreatedSAL schedule exportI ran that SAL export against my master debug enabled build@Michael Meeks: What would I do to run with "--enable-dbgutil".Where I type "export SAL_LOG=+INFO.vcl.schedule+WARN.vcl.schedule"I'm not a hacker, I don't know what to do. And the English it's not my native language.When I run in a terminal with:/Applications/LibreOfficeDev.app/Contents/MacOS/soffice(the option "--enable-dbgutil" is not recognized)But When I try to a drop of an oxt file on LibreOffice, the result is:warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-af/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-an/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-ar/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-be/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-bg/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-bn/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-br/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-bs/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-ca/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-cs/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-da/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-de/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-el/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-et/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-gd/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-gl/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-gu/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-he/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-hi/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-hr/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-hu/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-is/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-it/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-kmr-Latn/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-lo/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-lt/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-lv/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-ne/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-nl/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-no/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-oc/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-pl/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-pt-BR/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-pt-PT/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-ro/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-ru/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-si/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-sk/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-sl/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-sr/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-sv/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-sw/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-te/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-th/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-uk/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-vi/META-INF/manifest.xml>warn:desktop.deployment:15413:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-zu/META-INF/manifest.xml>I try an other test with the opening of a oxt by double click:warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-af/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-an/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-ar/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-be/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-bg/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-bn/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-br/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-bs/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-ca/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-cs/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-da/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-de/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-el/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-et/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-gd/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-gl/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-gu/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-he/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-hi/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-hr/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-hu/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-is/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-it/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-kmr-Latn/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-lo/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-lt/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-lv/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-ne/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-nl/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-no/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-oc/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-pl/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-pt-BR/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-pt-PT/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-ro/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-ru/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-si/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-sk/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-sl/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-sr/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-sv/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-sw/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-te/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-th/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-uk/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-vi/META-INF/manifest.xml>warn:desktop.deployment:15462:1:desktop/source/deployment/registry/package/dp_package.cxx:1430: cannot create UCB Content for <file:///Applications/LibreOfficeDev.app/Contents/Resources/../Resources/extensions/dict-zu/META-INF/manifest.xml>Hmm; --enable-dbgutil is what you'd pass to configure before compiling the software ;-) so - not a run-time parameter - it builds a -much- larger build with symbols, and logging and so on inside itself.Alex - thanks for the trace; if you are churning debug that fast from that place - then it is indeed an idle handling issue; it is strange that we get:info:vcl.schedule:1182:1:vcl/source/app/scheduler.cxx:242: Have active idle vcl::Window maPaintIdleso frequently - and yet (apparently) no UI update. I guess I need access to a Mac to poke at this one.I now have access to a remote Mac (thanks to Cloph), but - unfortunately - a truck-load of extraordinarily time-consuming business problems to solve - which can't wait, so getting a Mac setup, learning XCode, debugging etc. is not something I can get to in the next week or two I think; sorry ...***has been marked as a duplicate of this bug. ***(In reply to Michael Meeks from)@Michael : I have a VM allocation trace profile produced with Apple XCode Instruments.The trace itself is 1.36Gb of data, it can be opened and analysed in the Instruments.app provided with the XCode developer tools.I have compressed this trace to a zip file, but even then, it weighs in at 300Mb.I am providing a link to this on my Dropbox account for anyone that is interested, has access to the XCode tools, and likes to poke around ;-)FWIW, the profile is of interest with regard to this bug from approximately 1.19 minutes from the start. What precedes that is LO starting up, and the call up and display of the StartCenter. The OpenGL code called just before malloc goes wild is the graphical UI action of dragging and dropping an OXT file via the UI onto the StartCenter window (this is actually really slow to do physically on a debug build but I got there in the end).The problems, at least with the mallocs, and the stalling of the application, appear to start after that, so the calls that you are probably interested in will be from 1.19 min onwards.Hi Alex; wow - sounds awesome. Is there any chance of some screencast / video of what goes on / wrong here ? - also I'm surprised to hear of OpenGL being used (by us) on the Mac - I believe it is off by default there - but of course, it's prolly used by the backend. Quite possibly we have some invalidate loop - where we invalidate during painting - might be worth looking for that - with a breakpoint in eg.void Window::ImplInvalidate( const vcl::Region* pRegion, InvalidateFlags nFlags )that guy (vcl/source/window/paint.cxx).Thanks !(In reply to Michael Meeks from)I'll see what I can do. I'm not very "au fait" with screen recording software on Mac, but I can try and set a breakpoint where you indicated and see what happens.on board quicktime allows screenrecordingsScreenshot on MacOS is not difficult:For recording screen: Open "QuickTime Player" in the "File" menu you can see "New Screen Recording". For more details, see here:***has been marked as a duplicate of this bug. ***Bug confirmed.Any extension, even the more simplest one.Still present on LO 5.2.2.2, under MacOS 10.10Is there a way to install manually any extension, such as unzip and put on the right ~/Library/ folder ?BTW, this bug is major, not critical. WindowsIS critical, not major.The difference ? You can use LO without any extension, according to this #99784, but you cannot use LO Draw without crash with #99763.(In reply to Gaétan RYCKEBOER from)From a terminal :Example/Applications/LibreOffice.app/Contents/MacOS/unopkg add /Users/alex/Downloads/HelpAuthoring-3.1.3.oxtOK, so I created a video screen capture of the malloc trace using the Apple XCode Instruments app. As the video is larger than the allowed size for upload to BZ, I have uploaded it to my public Dropbox space, and will provide a link below :Hi Alex; I watched the video - it shows the memory increasing - which in itself is interesting - but unfortunately doesn't give us a good idea of where those memory allocations actually come from =) Can we not use the tool to explore what the stack trace of those allocations is ? ie. where in the 8 millions lines does it come from (it could be in the extension too FWIW ;-). Without that this is very much a "something leaks" type report.Thanks !(In reply to Michael Meeks from)Hi Michael,That is precisely what the Instruments.trace file is for. It contains a hierarchical tree list of all calls made, but as far as I can tell, you can only exploit this file via the Instruments.app. In reality, the trace file is a compressed folder containing various objects that Instruments.app knows how to read and display and allows the user to pinpoint the calls being made at any given point along the profile. If the trace is coupled to symbols and source code, which it can be, and which I haven't undertaken, one can apparently examine the code path in even greater detail, but all of that is beyond me, I'm afraid.It seems to me that the problem isn't just a LO regression, but also affected by changes introduced with MacOS El Capitan.- Mavericks 10.9.5 & Yosemite 10.10.5: the problem described starts between LO 5.0.6.3 (working) - 5.1.0.1 (failing), without high CPU usage.- MacOS Sierra 10.12: haven't found a working version yet.CreatedXcode Instruments Memory Allocation LO 5.0.6.3 on Sierra 10.12Memory Allocation after double click on the extension.(In reply to Alex Thurgood from)I have a longer more - informative - SAL schedule trace output. Reproduction steps:1. I downloaded " Copy only visible cells" from2. Start LO and wait for the start centre to appear3. double click downloaded .oxt fileThe follow output is repeating itself over and over:info:vcl.schedule:821:6:vcl/source/app/svapp.cxx:509: DoYield with active idles returns: timeoutinfo:vcl.schedule:821:6:vcl/source/app/scheduler.cxx:174: Invoke task unknowninfo:vcl.schedule:821:6:vcl/source/app/svapp.cxx:525: Leave ImplYieldinfo:vcl.schedule:821:6:vcl/source/app/svapp.cxx:478: Enter ImplYield: wait: one event: 0info:vcl.schedule:821:6:vcl/source/app/scheduler.cxx:206: Calculating minimum timeout:info:vcl.schedule:821:6:vcl/source/app/scheduler.cxx:237: Have active timer Timer to destroy drawinglayer reference deviceupdate min period from 60000 to 60000info:vcl.schedule:821:6:vcl/source/app/scheduler.cxx:237: Have active timer Auto save timerupdate min period from 60000 to 60000info:vcl.schedule:821:6:vcl/source/app/scheduler.cxx:242: Have active idle unknowninfo:vcl.schedule:821:6:vcl/source/app/scheduler.cxx:237: Have active timer unknownupdate min period from 60000 to 63info:vcl.schedule:821:6:vcl/source/app/scheduler.cxx:264: Calculated minimum timeout as 63 and has active idlesVersion: 5.3.0.0.alpha0+Build ID: a9afa89e953f0f32acf26b143717e7d067cbc75aCPU Threads: 4; OS Version: Mac OS X 10.12.1; UI Render: default; TinderBox: MacOSX-x86_64@49-TDF, Branch:master, Time: 2016-10-13_05:13:57Locale: nl-NL (nl_NL.UTF-8); Calc: groupCreatedSAL_LOG=+INFO.vcl.schedule+WARN.vcl.scheduleHi Telesto - thanks for doing that; it is interesting that (absent any time details - which is a shame) by line numbers we have a log of 380k lines - and we're getting PaintIdle handling all the way through, and towards teh end:382002 info:vcl.schedule:821:6:vcl/source/app/scheduler.cxx:174: Invoke task vcl::Window maPaintIdleSo - in theory we're continuing to process idle events, and render things too.I'm rather confused - people use the word 'hang' and so on - can someone make a video of just the app failing ? what happens ? - sorry the bug is by now unbelievably long and totally un-readable in linear time.Thanks for debugging !***has been marked as a duplicate of this bug. ***@Michael Meeks. As requested:Accidentally I also recorded(opening any document by double-click never opens the file. mouse movement required for the file to open)The ZippyShare thing is a virus / phishing / malware infested nightmare - AFAICS =) the two times I went there I ended up with some fake virus junk =) I created and mailed you an account on our demo server instead. Thanks =)(In reply to Michael Meeks from)Screenrecordering with corresponding terminal output (including time details)Thanks for the movie. So - I'm trying to understand the description here. There is talk of a crash/hang - and yet the UI appears to be rendered. The dialog appears to stop when it is at some low %age of "Adding copyvisicells.oxt" [Cancel].Can someone who has a Mac report on whether the rest of the app is working - ie. is it possible to load files, interact with existing LibreOffice windows, etc. while extensions are being installed (on other platforms) and on Mac - and is it possible to close the window while this is installing ?(In reply to Michael Meeks from)On a Mac none of the windows respond to any interactions, including closing.(In reply to Michael Meeks from)Hi Michael,No, the remainder of the app is to all intents and purposes unresponsive. Only a forced kill allows the user to shut all app windows. None of the toolbars react to clicks, whether in the unopkg gui or any other LO open windows, even the main application menu at the top of the screen is unresponsive.Soo - looking at the code quickly which is in:desktop/source/deployment/gui/dp_gui_extensioncmdqueue.cxxIt -looks- strongly as if this is some threaded use of VCL that is assuming that things are thread-safe that are not:void ProgressCmdEnv::progressSection( const OUString &rText, const uno::Reference< task::XAbortChannel > &xAbortChannel ){ m_xAbortChannel = xAbortChannel; m_nCurrentProgress = 0; if ( m_pDialogHelper ) { m_pDialogHelper->updateProgress( rText, xAbortChannel ); m_pDialogHelper->updateProgress( 5 ); }}Which does all manner of dodgy stuff like: DialogHelper::PostUserEvent( LINK( this, UpdateRequiredDialog, startProgress ), reinterpret_cast<void*>(bStart) );which ultimately does:m_nEventID = Application::PostUserEvent( rLink, pCaller, true/*bReferenceLink*/ )Which does some somewhat 'optimistic' code around in Application::PostUserEvent - which may well deadlock; it requires the SolarMutex for this case.Looks like another instance of people assuming that the vcl main-loop and event posting is thread-safe.Still - there are so few events, and so little going on this is unlikely to be the cause of the issue.I imagine that PostUserEvent is (somehow) not working nicely on Mac when called from a different thread in this case - but impossible to debug without a mac.CreatedLLDB BacktraceCreatedLLDB BacktraceI did try to step somewhat through opening process of an OXT, but I haven't really a clue what i'm searching for. Or what is relevant or not (novice)In thread 11 strtmpl.cxx doens't seem to work right (I guess). And maybe there is also a problem in Thread 1 with the Font Registry, because of a Libsystem mallocThe log is quite long. For a general impression I would advice to search for: 'bt' (Match Whole Word Only) and 'unwind'Backtrace looks normal enough - it looks like the thread that does the install is getting on with its business - not blocking, and the main UI thread is in the process of doing / pushing some deferred rendering events; so - nothing too surprising there. Perhaps it is worth waiting much longer to take a trace - when it has truly hung =)CreatedLLDB Backtrace when stuckA retry. I did a backtrace after OXT adding stuck and a few steps forward. I also 'unwinded' thread 1, 6, and 10 (search for unwind)Great trace Telesto, and nice to have in text too - no need to have the 's' stepping after the nice symbols backtrace though: frame #2: 0x00007fff8d6eb6ad libsystem_pthread.dylib`_pthread_mutex_lock_slow + 285 frame #3: 0x00007fff783f95de CoreFoundation`CFRunLoopPerformBlock + 670 frame #4: 0x00007fff76295053 AppKit`-[NSEvent _postAtStart:] + 191 frame #5: 0x0000000114e09c4d libvcllo.dylib`ImplSalStartTimer(nMS=41) + 701 at saltimer.cxx:84 frame #6: 0x0000000114e09f39 libvcllo.dylib`AquaSalTimer::Start(this=0x0000600000003820, nMS=41) + 25 at saltimer.cxx:126 if( pEvent ) [NSApp postEvent: pEvent atStart: YES];deadlocks against: frame #10: 0x00007fff779a8c26 HIToolbox`_BlockUntilNextEventMatchingListInModeWithFilter + 71 frame #11: 0x00007fff76092b79 AppKit`_DPSNextEvent + 1093 frame #12: 0x00007fff767a81c3 AppKit`-[NSApplication(NSEvent) _nextEventMatchingEventMask:untilDate:inMode:dequeue:] + 1637 frame #13: 0x0000000114e02ef6 libvcllo.dylib`AquaSalInstance::DoYield(this=0x00006080000be8a0, bWait=false, bHandleAllCurrentEvents=false, nReleased=0) + 998 at salinst.cxx:628 frame #14: 0x0000000114c928f0 libvcllo.dylib`ImplYield(i_bWait=false, i_bAllEvents=false, nReleased=0) + 1744 at svapp.cxx:505Which is somewhat amazing ...Of course the gymnastics going on here to implement the sal timer callback API is pretty horrible, although since timers are protected by the solar mutex - perhaps posting an event to the main thread in order to set a timer event does make some sense (?) The: if( pSalData->mpFirstInstance->isNSAppThread() ) ... do the real stuff ... } else { ... post this event ... }It does seem extraordinary that ::Yield() when called by two separate threads on the Mac hangs this way. Norbert - any ideas ? =)Within the backtrace I noticed the following errors:- “cannot write pidfile "- "cannot open pidfile "- @"AppKit cannot convert carbon event class '%.4s' to CGEventRef."- @"AppKit cannot convert carbon mouse event of kind '%ld' to CGEventRef."- @"AppKit cannot convert carbon mouse events of button '%ld' to CGEventRef."- @"WARNING: nextEventMatchingMask should only be called from the Main Thread! This will throw an exception in the future."- THE_PROCESS_HAS_FORKED_AND_YOU_CANNOT_USE_THIS_COREFOUNDATION_FUNCTIONALITY___YOU_MUST_EXEC__May be a duplicate of the bug you just fixed Noel =) at least the root bug ...CreatedBUILDLOG; LLDB Backtrace and SAL_LOGThe main issue still persists, but most errors and warnings found in the previous backtrace are gone. However: CoreFoundation`CFRunLoopAddTimer is still complaining about: __THE_PROCESS_HAS_FORKED_AND_YOU_CANNOT_USE_THIS_COREFOUNDATION_FUNCTIONALITY___YOU_MUST_EXEC__Main issue seems to be frame 13 libsofficeapp.dylib`desktop::Desktop::Main:desktop::Desktop::HandleBootstrapErrors at app.cxx:836desktop::(anonymous namespace)::MakeStartupConfigAccessErrorMessage at app.cxx:399desktop::(anonymous namespace)::FatalError at app.cxx:432I used:Version: 5.4.0.0.alpha0+Build ID: a564821eb9e991774195120e6965b2a8b1419dc5CPU Threads: 4; OS Version: Mac OS X 10.12.2; UI Render: default; Locale: en-US (en_US.UTF-8); Calc: groupThis could be a duplicate of:- can you test a build with that fix included ?Nope, adding an extension on OS X by double click isn't working with:Version: 5.4.0.0.alpha0+Build ID: b52167df08511239c3d08904a3d12a3c92141f38CPU Threads: 4; OS Version: Mac OS X 10.12.1; UI Render: default; TinderBox: MacOSX-x86_64@49-TDF, Branch:master, Time: 2016-12-09_23:41:33Locale: nl-NL (nl_NL.UTF-8); Calc: groupAdding with the the extension manager does work (mostly), but everything is a far to slow. Just opening the extension manager dialog on a 'cold start' takes around 12 seconds. The adding proces is also way to slow using 100% CPU (1,4 GHz Intel Core i5) However, the dialogs in between respond well.***has been marked as a duplicate of this bug. ***CreatedLLDB Backtrace, Build Log, Instruments Time ProfileIssue still persists. Updated backtraceVersion: 5.4.0.0.alpha0+Build ID: 2d54ffbf18d461c846535d539d704d45aff059b1CPU Threads: 4; OS Version: Mac OS X 10.12.2; UI Render: default; Locale: en-US (en_US.UTF-8); Calc: groupThe extension adding process seems to be Thread 9. Row 7778 (and further) of the Time Profile results.CreatedLLDB Backtrace, Build Log, Instruments Time Profile, Instruments AllocationsMaking progress, but still not working:Version: 5.4.0.0.alpha0+Build ID: 88f561204d7cee25633df8117cc8d7e1ebd8e9adCPU Threads: 4; OS Version: Mac OS X 10.12.2; UI Render: default; Locale: en-US (en_US.UTF-8); Calc: groupNote: LLDB backtrace, Instruments Time Profile and Instruments Allocations are done in separate runsIs there anything I could do? Is there a safe way for allowing someone to remote debug on my iMac computer? I have the latest iMac (Retina 4K, 21.5-inch, Late 2015, Intel Iris Pro Graphics 6200 1536 MB, 8 GB 1867 MHz DDR3, 3.1 GHz Intel Core i5) with Mac OS X Sierra with all system updates and patches installed (Mac OS X 10.12.2). I am also familiar with programming and debugging a bit and know how to use XCode or NetBeans. I would really like to help out.TDF bought me a Mac to debug this on; I've even got soffice.bin in the debugger, and the extension downloaded ;-) but - waiting for some spare time to get to this.@jazzjohannes if you come hang out on the irc channel we could help you get libreoffice building on your machine. Be warned that it is somewhat of an arduous process. Then you'd need to run it under a debugger and explore up and down the stack. Somewhere we are taking locks in the "wrong" order.This issue is a serious problem for all of us who depend on extensions - e.g. academics who need to install the plug-in for Zotero, Endnote or another reference management software. We'd appreciate if a solution could be found - after all, this bug hasn't been resolved since May last year! Thanks a lotThe same for French users.The only way to get a real spell/grammar checker is with Grammalecte extension.CreatedLLDB BacktraceTwo backtraces with a different perspective. BT between adding an extension and license agreement, done with:Done with build +/- 12 Jan 2017Version: 5.4.0.0.alpha0+Build ID: 88f561204d7cee25633df8117cc8d7e1ebd8e9adCPU Threads: 4; OS Version: Mac OS X 10.12.2; UI Render: default; Locale: en-US (en_US.UTF-8); Calc: groupBT while opening Extension ManagerDone with build +/- 4 Jan 2017Version: 5.4.0.0.alpha0+Build ID: 88f561204d7cee25633df8117cc8d7e1ebd8e9adCPU Threads: 4; OS Version: Mac OS X 10.12.2; UI Render: default; Locale: en-US (en_US.UTF-8); Calc: groupCreatedLLDB Backtrace1. BT between adding an extension and license agreement. Still some delay remaining, but making quite some progress2. BT after double clicking OXT extension in finder.3. A few off-topic backtraces Version: 5.4.0.0.alpha0+Build ID: 562edf0f09ba4e82fb9186aa75ee88fd7f68d18fCPU Threads: 4; OS Version: Mac OS X 10.12.1; UI Render: default; Locale: nl-NL (nl_NL.UTF-8); Calc: groupCreatedLLDB Backtrace1. BT between adding an extension and license agreement. Still some delay remaining, but making quite some progress2. BT after double clicking OXT extension in finder.3. A few off-topic backtraces Version: 5.4.0.0.alpha0+Build ID: 562edf0f09ba4e82fb9186aa75ee88fd7f68d18fCPU Threads: 4; OS Version: Mac OS X 10.12.1; UI Render: default; Locale: nl-NL (nl_NL.UTF-8); Calc: groupCreatedSAL_LOG=+TIMESTAMP+INFO,+WARNSmall addition to the BT from yesterdayCreatedLLDB Backtrace, BUILDLOG, SAL_LOG1. BT between adding an extension and license agreement using the extension manager. Still a 10-15 sec delay remaining, but quite OK2. BT after double clicking OXT extension in finder (still broken)Done with:Version: 5.4.0.0.alpha0+Build ID: 562edf0f09ba4e82fb9186aa75ee88fd7f68d18fCPU Threads: 4; OS Version: Mac OS X 10.12.1; UI Render: default; Locale: nl-NL (nl_NL.UTF-8); Calc: groupI build without using compiler plugins, it didn't work out of the box using the pre-canned (LODE) setup.--> Cannot find Clang headers to build compiler plugins, plugins disabled***has been marked as a duplicate of this bug. ***CreatedLLDB Backtrace, Build LogLLDB Backtraces1. BT between dialog 'For whom do you want to install the extension' and the license agreement. Still a 8 second delay. Everything else is working fine (except the progress bar;)2. BT after double clicking OXT extension in finder (isn't working; still stuck)3. A few off-topic backtraces (but probably related) Version: 5.4.0.0.alpha0+Build ID: 6dce9c6757823b9e89863716ae70ff4e8ddd4e60CPU Threads: 4; OS Version: Mac OS X 10.12.1; UI Render: default; Locale: nl-NL (nl_NL.UTF-8); Calc: groupDid get a few build warnings:ld: warning: directory not found for option '-L/Users/demo/lode/dev/core/workdir/LinkTarget/StaticLibrary'ld: warning: directory not found for option '-L/Users/demo/lode/dev/core/workdir/LinkTarget/Library'ld: warning: directory not found for option '-L/Users/demo/lode/dev/core/instdir/LibreOfficeDev.app/Contents/Frameworks'ld: warning: directory not found for option '-L/Users/demo/lode/dev/core/instdir/LibreOfficeDev.app/Contents/Frameworks'ld: warning: directory not found for option '-L/Users/demo/lode/dev/core/workdir/LinkTarget/Library'CreatedLLDB Backtrace, BUILDLOGI noticed that my last few backtraces didn't contain 'code-pointers'. Sorry for that. Again some backtraces:1. BT between dialog 'For whom do you want to install the extension' and the license agreement. Still a 8 second delay. Everything else is working fine (except the progress bar;)2. BT after double clicking OXT extension in finder (isn't working; still stuck)3. A few off-topic backtraces (but probably related) Version: 5.4.0.0.alpha0+Build ID: b78c6d8efd9531243e62a388bffc3f071d9a56ebCPU Threads: 4; OS Version: Mac OS X 10.12.2; UI Render: default; Locale: en-US (en_US.UTF-8); Calc: groupCreatedBUILDLOG; LLDB Backtrace and SAL_LOGUpdated backtraces:Version: 5.4.0.0.alpha0+Build ID: 273823de644f2086377795d3afb51a39d30bfeaaCPU Threads: 4; OS Version: Mac OS X 10.12.2; UI Render: default; Locale: en-US (en_US.UTF-8); Calc: groupThe libi18nlangtag trace seems quite interesting:"LanguageTag::registerImpl: can't resolve system!""LanguageTag::registerImpl: can't register for 0x"CreatedLLDB backtrace Time Profile SalAquaPickerThe response of pressing the add button in the extension manager is a bit slow. The button press is at frame 70Version: 5.4.0.0.alpha0+Build ID: 273823de644f2086377795d3afb51a39d30bfeaaCPU Threads: 4; OS Version: Mac OS X 10.12.4; UI Render: default; Locale: en-US (en_US.UTF-8); Calc: group(In reply to Telesto from)Bonjour!If I may interfere (my apologies by advance if this is completely off topic),I find that many GUI actions are slow on my mac and I have to keep quiet while editing using graphical displacement of objects in drawing or impress.I always keep a delay of ~0.5 seconds between clicking and dragging an object otherwise it often finishes off-screen.This might be a related problem or not, but I though I better let you know.Thank you all for the efforts on this critical problem (for mac users).Vincent.CreatedXcode Time Profile and some code peeksXcode Instruments Time Profile between 'For whom do you want to install the extension' and the license agreement and a bunch of screenshots while peeking at the code (using Instruments)Version: 5.4.0.0.alpha0+Build ID: 273823de644f2086377795d3afb51a39d30bfeaaCPU Threads: 4; OS Version: Mac OS X 10.12.4; UI Render: default; Locale: en-US (en_US.UTF-8); Calc: groupCreatedLLDB Backtrace, SAL_LOGIt feels like LibO is running smoother. However there is still a noticeable delay's when opening menu's. I have added backtrace of dyld`dyldbootstrap when launching LibO.Version: 5.4.0.0.alpha0+Build ID: a8538f0774bd0fabf6012d735d1e86b3ff1c291fCPU threads: 4; OS: Mac OS X 10.12.4; UI render: default; Locale: en-US (en_US.UTF-8); Calc: group
id=100182	I create or edit an index. Then I store the document. When I load it again, all entries and keywords for index are lost.Best regards, Helmut Wolff! No repro with Version: 5.3.0.0.alpha0+Build ID: 86d84ae4bba0d4c45bc13232645318291a8aed75CPU Threads: 4; OS Version: Linux 4.4; UI Render: default; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-05-26_14:33:24Please attach test file and write steps how to reproduce. Thanks.CreatedWith Writer-Version 5.1.4.1 I have no Problemsteps:open filedelete "Inhaltsverzeichnis"Insert - Table of contents and index - Table of contentsInsert table of contents - OKSave, close, reopenTable of contents is here, no problemVersion: 5.3.0.0.alpha0+Build ID: 2712fc0869e5ba3b7a1da41e0ce72431d3b0deeeCPU Threads: 1; OS Version: Windows 6.19; UI Render: default; TinderBox: Win-x86@42, Branch:master, Time: 2016-06-02_22:41:55Dear raal,I reproduce your decleration, I have no success.I work with the german Language-Version of LibreOffice.What Language-Version is yours?Perhaps the reason is diffrent keywords between diffrent Language-Versions.Best regards, Helmut!Helmut: did you use 5.2 beta1 or some other build of 5.2?To all : I tested with Version 5.2.0.0.beta1 , 5.2.0.0.alpha(x) , also 5.3.0.0.alpha0.Best regards Helmut!@Helmut -Thanks for being super patient. Can you try with a fresh profile? I also cannot reproduceBodhi MokshaLibreOffice Version: 5.3.0.0.alpha0+Build ID: d534e939d4b9c8ac09cd1e7e28e5ad43d1ee56ecCPU Threads: 2; OS Version: Linux 3.16; UI Render: default; Locale: en-US (en_US.UTF-8)To all,My OS is "Windows 8.1 64Bit".My Localisation of LibreOffice is "de-DE (de_DE)".Userprofile I've refreshed, before I tested.Notice:Version till 5.1.5.0.a0 is ok.Version 5.2.x and above is not ok.Best regards, Helmut Wolff!To all,I've just tested with Version 5.2.1.0.a0 - It's failed too.My Question is: What's the diffrenz between "5.1.x.x" and "5.2.x.x and above"?Best regards, Helmut Wolff!(In reply to wolff-ohlenberg from)The difference is many new features and also some fixes. Not all fixes get backported from the freshest release to the "still" branch.To all,How I can create an Index successfully with versions 5.2.x and above?Best regards, Helmut Wolff!Helmut: if you keep changing the status to NEEDINFO, you will be sabotaging the chances of anyone looking at your report. NEEDINFO is only meant for *the reporter*, when they are asked a question.To all,Sorry for setting status on NEEDINFO.How I can create an Index successfully with versions 5.2.x and above?My problem: My Indexes are not saving.Best regards, Helmut Wolff!I tried with German UI and no problem.Version: 5.2.0.4 (x64)Build-ID: 066b007f5ebcc236395c7d282ba488bca6720265CPU-Threads: 4; BS-Version: Windows 6.1; UI-Render: Standard; Gebietsschema: fi-FI (fi_FI)I can reproduce on Windows v 5.2.0.4How to reproduce:- Open file in Writer- Select a word- Insert > Table of Contents and Index > Index Entry- Click Insert button- Save and close- Reopen file- Index entries are now missing (ie. not tagged as index entries)This bug seems to wipe index entries from any file which contained them, including files produced in previous versions and not resaved in this one. Since files can contain hundreds or thousands of index entries, and since it is not immediately obvious that the entries have been wiped from the file (you have to be observant enough to spot that the field shadings are missing, or you have to update the alphabetical index), this bug has the potential to wipe out many hours of work.My system:Version: Windows v 5.2.0.4OS: Windows 10Settings: works with 'vanilla' settings on new installationSee also this bug report of the same issue in the libreoffice package for Ubuntu:(In reply to NDG from)Oh dear, you are right :(Arch Linux 64-bit, KDE Plasma 5Version: 5.2.0.4Build ID: 5.2.0-1CPU Threads: 8; OS Version: Linux 4.6; UI Render: default; Locale: fi-FI (fi_FI.UTF-8)Arch Linux 64-bit, KDE Plasma 5Version: 5.3.0.0.alpha0+Build ID: c7fd6532682a12d8981e6b19b4fbb75d6d3c412cCPU Threads: 8; OS Version: Linux 4.7; UI Render: default; Locale: fi-FI (fi_FI.UTF-8); Calc: groupBuilt on August 30th 2016Issue introduced in range 7289a140fc68dc898ba2b2357cc960968195f236..766524b13b3e69cc16cf19b826f62222d7f15ea5problem commit appears to be 3e6ba91e2d6d362f4af91566e740f5dbc310e026Caolán McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: tdf#100182 index entries lost on saveIt will be available in 5.3.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-5-2":Resolves: tdf#100182 index entries lost on saveIt will be available in 5.2.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.***has been marked as a duplicate of this bug. ***I have now installed prerelease 5.2.2.2 (Build ID: 8f96e87c890bf8fa77463cd4b640a2312823f3ad). I can verify that alphabetical index entries no longer disappear when a file is saved and reopened. The bug appears to have been fixed.Thank you very much indeed for you care, attention and good work in resolving this issue. Well done!Yep, verified fixed in 5.3 as well.Arch Linux 64-bit, KDE Plasma 5Version: 5.3.0.0.alpha0+Build ID: 3be5deadcb46e09d84d99b2b108b65b06ff356e9CPU Threads: 8; OS Version: Linux 4.7; UI Render: default; Locale: fi-FI (fi_FI.UTF-8); Calc: groupBuilt on September 24th 2016Hi,I'm a teacher and I have given LibreOffice to all my students:Versión: 5.2.1.2Id. de compilación: 31dd62db80d4e60af04904455ec9c9219178d620Subprocesos de CPU: 1; Versión de SO: Windows 5.1; Renderizado de IU: predeterminado; Configuración regional: es-BO (es_BO); Calc: groupEvery time the students setup the index entries they are gone after save. It's impossible to use that really important feature!I could not find information about this problem on the net except here. From what I read, I have to download a patch, I downloaded this file:Index of /daily/libreoffice-5-2/Win-x86@62-merge-TDF/current:libreoffice-5-2~2016-09-28_16.00.05_LibreOfficeDev_5.2.3.0.0_Win_x86_sdk.msi After install it didn't fix the problem, I read that the problem is already fixed, but how can I fix it? what file should I download in order to fix the problem? Should I tell the students to change LibreOffice version?Please help me the students are very disappointed with this experience.Thank you!Since this bug is continuing to cause confusion, I would like to post the following workaround. These are generic instructions – your operating system might have slightly different ways of doing things (eg. using a Linux package manager), but hopefully the general principle will make sense.Workaround- Go to the main LibreOffice download site at- Scroll down to the heading "Available Versions".- If a version starting with 5.3 (or any version higher than that) is available as a 'released' version (not a 'development' version), download that.*- If there is no version 5.3 or higher, download version 5.1.5.- Uninstall LibreOffice 5.2.x (where x is some version number).- Install LibreOffice 5.1.5 in its place.- Follow the steps in(above) to see if the problem still occurs. It should not occur now.What's going on here:- The bug described on this page exists only in LibreOffice 5.2.x. Any other version of LibreOffice should not have the bug.*note: at time of writing, this version is no yet available, but it will be available in the futureGeorge: you installed the *SDK*, not the actual LibreOffice: LibreOfficeDev_5.2.3.0.0_Win_x86_sdk.msi <- this is the wrong file.This would have been the correct file:***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***
id=100286	Encountered today on master 5.3.0 alpha, both on Linux and OSX1) Start the DB creation wizard.2) Choose a connection to an existing DB3) Clicking on Next has no effect. The only option is to Cancel.regression The same result is encountered when trying to attempt to create a new embedded hsqldb ODB file.Version: 5.3.0.0.alpha0+Build ID: 4d49c9601c9b3e26a336e08e057d299895683480Threads CPU : 4; Version de l'OS :Linux 3.19; UI Render : par défaut; Locale : fr-FR (fr_FR.UTF-8)On pc Debian x86-64 with master sources updated today, I could reproduce this.But even worse, just clicking "Next" with by default option "Create a new DB", does nothing.Maxim Monastirsky committed a patch related to this issue.It has been pushed to "master":tdf#100286 Fix deactivate flagsIt will be available in 5.3.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.With master sources updated today, I don't reproduce this.Thank you Maxim!
id=100303	After updating to LO 5.1.3.2 on Ubuntu Xenial, Base Reports (built with ORB) crash when trying to apply conditional formatting to a field. LO Base is connected to MySQL in MySQL native mode. To reproduce:1. open/create a report2. select a field3. Format - Conditional formatting4. Create a condition, select a format (bold, color, italics, whatever)5. ApplyA message box pops-up with "std::bad_cast" and the whole of LO Base crashes.Existing reports containing conditional formatting created before the update to LO 5.1.3.2 do run properly, with fields being conditionally applied. However, when trying to edit these and modify their conditional formatting, the same bug happens and LO Base crashes. Please install the debug package and try to get a backtrace:Fred :Please provide a sample DB with instructions for testing, thanks.@Fred :I have created a sample ODB file with embedded hsql.I create a report using the wizard, and save it.I then right mouse button click on the report and choose Edit. The report definition opens for editing.If I right mouse button click on a selected field, I don't see any Formatting entry. Even if I display the Properties for the control, in the General tab, I only see entries for "Conditional Print Expression" and "Formatting"Please explain what it is you are doing.@AlexCreate a report, put in a field. Select the field, then Menu Format - Conditional formatting...Condition 1 : "Expression is", enter a condition, select a format (like a different font color). Click OK, a message box comes up and Base crashes entirely.Createdgdbtrace log@Fred : thanks.I can not reproduce with Version: 5.1.3.2Build ID: 644e4637d1d8544fd9f56425bd6cec110e49301bThreads CPU : 8; Version de l'OS :Mac OS X 10.11.5; UI Render : par défaut; Locale : fr-FR (fr.UTF-8)I chose an ID field in my report, then Conditional Formmatting with function ISEVEN() and red font. Saved the report, executed the report which gave correct font colour for even numbered ID values, no crash.@Fred: are you using the distrib provided version (or PPA) of LO or TDF-provided download ?@AlexAm using the distro provided version of LO, which gets updated as I apply system updates. I do apply updates on a very regular basis.Hello all,I conducted further testing. I set up a Debian Jessie VM in which I upgraded LO to 5.1.3.2 and again, same crashes when trying to use some conditional formatting in reports.Still in Debian Jessie, I then reverted back to LO 4.3.3 (official version in the official repo) and there, perfect, no crash. I saved the odb, opened it up in LO 5.1.3.2 and it ran fine, with conditional format. But again, it crashed if I tried to modify anything relative to conditional formatting.Back in Ubuntu Xenial, I installed a snap version of LO 5.2.0 beta and again, ORB crashed repeatedly when defining conditional formatting.Every time, with those different distros and those different LO versions, I tested both with my existing ODB file and with a new, blank one. Crashes occurred every single time, be it with my existing ODB or with a new one.I am surprised nobody can reproduce the crash -- I tried it on 2 different linux distros (although related -- Ubuntu Xenial and Debian Jessie), and on both distros ORB crashed exactly in the same way when trying to define a conditional format on a field, as previously described.Fred : which JDK is running on those machines when the crash occurs ?are you using the distrib provided ORB or have you installed the ORB from the extensions download site ?Unfortunately, my Ubuntu provided version of LO 503rc2 on LinuxMint 17.3 is so unstable that it crashes as soon as I try and create any kind of database report. Just starting the wizard is enough to bring it to its knees. Will try a master build on it later.Reproduced on my own master build :Version: 5.3.0.0.alpha0+Build ID: dabee9834be560c0b2ca174e88002f0eae1d155aThreads CPU : 4; Version de l'OS :Linux 3.19; UI Render : par défaut; Locale : fr-FR (fr_FR.UTF-8)Linux Mint 17.3I used an ODB file connecting via the native mysql connector to a locally hosted mysql server. Created an initial report with the ORB, then edited the report to add conditional formatting to one of the three fields in the report, changing the font background colour to red on condition of a certain value. As soon as I pressed the OK button, LO crashed.ConfirmingHmm, no symbols in my master build :(gdb) bt full#0 0x00007ffff7551c37 in __GI_raise (sig=sig@entry=6) at ../nptl/sysdeps/unix/sysv/linux/raise.c:56 resultvar = 0 pid = 27319 selftid = 27319#1 0x00007ffff7555028 in __GI_abort () at abort.c:89 save_stage = 2 act = {__sigaction_handler = {sa_handler = 0x0, sa_sigaction = 0x0}, sa_mask = {__val = {0, 140737333868734, 140737351947559, 140733193388037, 0, 1, 140737342741808, 140737346644072, 140737333868734, 78947984, 140737351976149, 140737353693488, 140737343678253, 1, 140737353696016, 78985680}}, sa_flags = 10, sa_restorer = 0x7ffff7f93a00} sigs = {__val = {32, 0 <repeats 15 times>}}#2 0x00007ffff6c4d535 in __gnu_cxx::__verbose_terminate_handler() () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6No symbol table info available.#3 0x00007ffff6c4b6d6 in ?? () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6No symbol table info available.#4 0x00007ffff6c4a799 in ?? () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6No symbol table info available.#5 0x00007ffff6c4b34a in __gxx_personality_v0 () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6Is there a reproducer for this with a simpler embedded database case, i.e. download this and click here ?CreatedbacktraceCreatedtest odb file(In reply to Caolán McNamara from)1) Load the test file in LO2) Click on Forms3) Right mouse button click on the form and choose Edit.4) Select RefTache with the mouse and then choose Format-Conditional Formatting from the main menu.5) Select is "equal to" in the condition drop down menu and enter the number 4. Then select a different coloured font.6) Press OK7) Crash.(In reply to Alex Thurgood from)Sorry, not Forms, but Reports, of course in step 2.Caolán McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: tdf#100303 Report crashes on close of conditional formatting dialogIt will be available in 5.3.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.5-25-1Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-5-2":Resolves: tdf#100303 Report crashes on close of conditional formatting dialogIt will be available in 5.2.0.2.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-5-1":Resolves: tdf#100303 Report crashes on close of conditional formatting dialogIt will be available in 5.1.5.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=100328	Createdconsole bt logsOn pc Debian x86-64 with master sources updated yesterday, I had a crash when closing Design Report.1) Launch Base2) Create brand new odb file (hsqldb)3) Click Reports4) Click Design Report (not wizard)5) Just close report=> crash Bodhi MokshaVersion: 5.3.0.0.alpha0+Build ID: 7c983445656e1f1942cf2d7398a77342004ed168CPU Threads: 2; OS Version: Linux 3.16; UI Render: default; Locale: en-US (en_US.UTF-8)Confirmed.Setting to:NewCritical - crash doing a really basic thing with base;Highest - regression in current master*** This bug has been marked as a duplicate of***
id=100435	CreatedTest databaseRunning Version: 5.2.0.0.beta2Build ID: ae12e6f168ba39f137fc110174a37c482ce68fa4CPU Threads: 8; OS Version: Linux 4.4; UI Render: default; Locale: en-GB (en_GB.UTF-8)On ubuntu 16.04.Open the attached database.In Forms, edit AlbumArtists. Modify the size of the Filter Button.The form is marked as modified (on the 'save' button).But nothing happens when I try to save, and there is no 'save' option on the file menu. Hi Tim, FYI, this is a known issue, but I need to find the previous report.Hmm, the previous issue I was looking for was the fact that the Save button always appears as if changes were made even if the form had been saved and no other changes were made, whereas you are saying that there is no Save entry in the menu.I will check against my master build.Version: 5.3.0.0.alpha0+Build ID: 637371d4d90c2403f02d588ebe745368014b1032CPU Threads: 2; OS Version: Mac OS X 10.11.5; UI Render: default; Locale: fr-FR (fr.UTF-8)Tim, there should be an entry in the main File menu called "Update -", the keyboard shortcut for which is Ctrl-S (or Cmd-S on the Mac). This saves the form changes for me. Quite why the wording was changed to Update is beyond me, that was clearly a UX decision, probably because of the new Save button with the dropdown menu.The fact that the Save button doesn't change to represent the new state of the form is.Setting as WFM unless there is something I have missed.(In reply to Alex Thurgood from)I tried 'update'. It doesn't work, and the 'save' button still indicates that there are outstanding edits. On closing the edit form and re-opening it has not changed.And if I do an edit and close the form without attempting to update/save it doesn't ask if I want to save the form.I have reopened this (apologies if that's a break in protocol).There is no method by which I can save an edited form. That's critical for me.(In reply to Alex Thurgood from)Can you reproduce the problem I have in 5.2? If this is not fixed, version 5.2 will be totally unusable.With Version: 5.2.0.0.beta2Build ID: ae12e6f168ba39f137fc110174a37c482ce68fa4CPU Threads: 2; OS Version: Mac OS X 10.11.5; UI Render: default; Locale: fr-FR (fr.UTF-8)1) Opened test ODB file.2) Opened form in Form edit (design) mode.3) Re-sized push button.4) Closed form without saving5) CrashRetried using same steps as in, except that I tried :- saving with Cmd-S- saving via the File - Update menu entryMade no difference, each time I close the form window, I get a crash.Additionally, whilst the menu entry appears to be activated, the changes to the form are not saved.ConfirmingCaolan : the sudden crashing on window dispose sounds like something you might be interested in ?Note that I couldn't reproduce in my master build so maybe a fix has gone in that needs backporting ?The crash referred to inis (fixed)(In reply to Alex Thurgood from)My system doesn't crash in 5.2 beta at the time I try to save, it just refuses to save (or update as it is now called for reasons that escape me).The save problem was also fixed by the commit of.*** This bug has been marked as a duplicate of***I just tested this for the failure to save in 5.2.0.0.So, in Version: 5.2.0.1Build ID: fcbcb4963bda8633ba72bd2108ca1e802aad557dCPU Threads: 8; OS Version: Linux 4.4; UI Render: default; Locale: en-GB (en_GB.UTF-8)All is OK. There is no crash, and I can save the edited form.I'm also happy to see that I can still 'Save' rather than 'Update' :-)Should I close this?(In reply to tim from)@Tim : it is already closed, since marking as DUP closes the report, but adds a link to the other report.(In reply to Alex Thurgood from)Sorry. Since neither it, nor 100140 is, marked 'closed' I assumed I should do so.Further, the actions causing a crash on this report are quite different from those in 100140, and I saw nothing about being unable to save a form there, so I had no proof that 100140 actually fixed this problem as well as that in 100140.Does 'Closed' not mean anything extra?
id=100664	Bodhi MokshaVersion: 5.3.0.0.alpha0+Build ID: c1ab6613ae7b45f2d90aafd6c6a829a471ceca55CPU Threads: 2; OS Version: Linux 3.16; UI Render: default; Locale: en-US (en_US.UTF-8)Repo Steps:1. Open writer;2. Tools -> Autocorrect -> AutoCorrect Options...Result: Crash On pc Debian x86-64 with master sources updated today (612ebb9b972fde18b1492b601116a8c03adb2912), I don't reproduce this.I tried with gtk3, gtk, gen, kde4 rendering.On Fedora 23 64-bit LXDE withVersion: 5.3.0.0.alpha0+Build ID: f07aa1136ee68329a2b5f7cb88d2a8b5c83f474bCPU Threads: 1; OS Version: Linux 4.2; UI Render: default; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-06-28_01:15:53Locale: en-US (en_US.UTF-8)Can't reproduce.No repro in Version: 5.3.0.0.alpha0+Build ID: e74382fd6385138b164df5e4f93a0e7df2857f2cCPU Threads: 2; OS Version: Linux 4.4; UI Render: GL (or Default); TinderBox: Linux-rpm_deb-x86@71-TDF, Branch:master, Time: 2016-06-28_00:20:24Locale: nl-NL (nl_NL.UTF-8)I'll try to build again and see what happens.No longer an issue in recent build. Closing
id=100896	Description:LibreOffice crash when: -I click hyperlink icon; -I use the shortcut Ctrl+K; -I go on Insert>Hyperlink.Affected version:Version: 5.3.0.0.alpha0+Build ID: 29e91d5eedd2bf20504ce9ada625d33fec19dc9eCPU Threads: 2; OS Version: Linux 4.1; UI Render: default; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-06-16_23:05:06Locale: it-IT (it_IT.UTF-8)OS: openSUSE Leap 42.1 (x86_64) (In reply to pietro.pangallo from)WRONG AFFECTED VERSION:Crash on:Version: 5.3.0.0.alpha0+Build ID: 54f2a4184d1296814e64cfeab1d06ae90d002357CPU Threads: 2; OS Version: Linux 4.1; UI Render: default; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-07-08_01:43:14Locale: it-IT (it_IT.UTF-8); Calc: groupOS: openSUSE Leap 42.1 (x86_64)Works on:Version: 5.3.0.0.alpha0+Build ID: 29e91d5eedd2bf20504ce9ada625d33fec19dc9eCPU Threads: 2; OS Version: Linux 4.1; UI Render: default; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time:2016-06-16_23:05:06Locale: it-IT (it_IT.UTF-8)OS: openSUSE Leap 42.1 (x86_64)CreatedGDB trace of the crashArch Linux 64-bit, KDE Plasma 5Version: 5.3.0.0.alpha0+Build ID: ab1b351840160655a9f0caedbb35e9fdf203c5a0CPU Threads: 8; OS Version: Linux 4.6; UI Render: default; Locale: fi-FI (fi_FI.UTF-8); Calc: groupBuilt on July 16th 2016Caolán McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: tdf#100896 crash in hyperlink dialogIt will be available in 5.3.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=100883	Amazingly on Windows adding a *((int *)42) = 42; into the OpenCL code paths to test crash recovery - results in the CL driver passing the test - but not on master/4.3.This is due to the SEH exception handling throwing an exception there, which is caught; we fall-back to traditional calculation - and "life is good" ;-) unfortunately this mis-tags a failing CL kernel as a passing one.Need a way to count such failures in the shared opencl/ module. Of course, I tested various scenarios before pushing this - but mostly correctly compiled CL formulae that yielded the wrong results =) exercising the OpenCLZone was the issue I guess.Fixes pushed to gerrit.Michael Meeks committed a patch related to this issue.It has been pushed to "master":tdf#100883 - opencl impls. that use SEH are still bad.It will be available in 5.3.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Meeks committed a patch related to this issue.It has been pushed to "libreoffice-5-1":tdf#100883 - opencl impls. that use SEH are still bad.It will be available in 5.1.5.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Meeks committed a patch related to this issue.It has been pushed to "libreoffice-5-2":tdf#100883 - opencl impls. that use SEH are still bad.It will be available in 5.2.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=100813	Createdthis is the problematic document that i could not open it in libreoffice because of the crash.hi every one. i have a very valuable docx document. every times, when i want to open this document, libreoffice crashes immediately and wants to recover my document. but unfortunately recovery also has no result and libreoffice crashes for me after completion of recovery. i tested this documents on windows and also i realized that this file makes libreoffice crash even on linux, i dont know about mac and other operating systems. this file can be open in openoffice and microsoft office without any error and crashes. i use windows xp and even it causes the crash on windows ten. i tested many versions of libreoffice since version 4.3.0 and even the newest version which is 5.1.4.2 now. i am not shure about the previous versions before 4.3.0steps to reproduce:1- double click in this document. current behaviour:sometimes libreoffice crashes and wants to recover this file. sometimes fatal error SEH exception access violation. expected behaviour:this document can be opened properly without any crash. hope you solve this bug for me. i pray for you and request Allah's mercy and grace for you. Unconfirmed with v3.3.4 under windows 7 x64.Confirmed with v5.1.4.2 under windows 7 x64.Confirmed with v4.1.6.2 under mint 16 x64.Opens fine, but seems to crash on doing repagination ?!Caolán McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: tdf#100813 crash during pagination of particular docxIt will be available in 5.3.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.hi. could you please solve this bug in libreoffice 5.1 for me to use on windows xp? version 5.3 forshure does not support xp and i cant use my document. what was the document's problem? as i mentioned, for me after many seconds after openning, libreoffice crashes. fatal error seh exception access violation and sometimes, do to unexpected error, libreoffice crashed. and wants to recover my file and again crash! i even cant read its content because of crash shure i cant set page number which you told it crashes after pagination.its in review queue asCaolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-5-1":Resolves: tdf#100813 crash during pagination of particular docxIt will be available in 5.1.5.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-5-2":Resolves: tdf#100813 crash during pagination of particular docxIt will be available in 5.2.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Hi Caolán(In reply to Commit Notification from)Version 5.1.5.1 x64 (RC1) still crashes when opening the attached file under Windows 10.Maybe patch was not included in time for 5.1.5.1 (compiled on Jul 13th)?Pedro, you can see for yourself (by clicking on 5.1) that it was included: wiki.documentfoundation.org/ReleasePlanCaolán, I also have a crash with libo-master~2016-07-12_09.25.31_LibreOfficeDev_5.3.0.0.alpha0_Win_x86. Should this one be reopen?caolan->timur:I definitely fixed *a* bug with this cause it doesn't crash for me under Linux anymore and if I revert my fix it crashes again. I guess there must be another problem. Is there any automated crash report backtrace associated with your master windows failure ?CreatedBacktrace of v5.1.5.1 x64 crash under Windows 10Thank you for the tip on the Release Plan, timur. But because the patch was added the day before RC1 was compiled I wasn't sure it was in. If it is, then here is the backtrace.Caolán McNamara committed a patch related to this issue.It has been pushed to "master":Related: tdf#100813 crash in this doc on scrolling past page 44It will be available in 5.3.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.CreatedBacktrace of LO 5.3+ 32-bit crash under Windows 7 x64(In reply to Caolán McNamara from)I'm aware of automated crash report from 5.2. but I don't know how it's used, and how backtrace is created.doesn't say, and it should.I attach my backtrace from WinDBG.The most recent bug I found here in scrolling past page 44 was in SwFlowFrame::IsKeep which is at the top of Pedros bt, so that's promising.Timur's though is in some other place which hasn't triggered locally yet.Timur's one though does state that the unwind info might be wrong, while Pedro's doesn't. Perhaps they are the same underlying problem. Lets wait until there are builds available with the above fix and have another test then.***has been marked as a duplicate of this bug. ***Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-5-2":Related: tdf#100813 crash in this doc on scrolling past page 44It will be available in 5.2.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Createdstack trace end of initial load offromstack trace taken at the end of filter import load of the document, a second analyze -v trace from initial attempt to scroll the page that hangs things in GetVbaEventProcessorCreatedanalyze -v and trace when trying to scrollCreatedstack trace on scroll of originalwith 2016-07-21 TB39 buildwill revisit both documents when another TB39 build with today's patch to flowfrm.cxx rollsCreatedBacktrace of LO 5.3+ 32-bit crash with master~2016-07-21_23.52.45Again crash on fileopne, without scrolling, with master~2016-07-21_23.52.45_LibreOfficeDev_5.3.0.0.alpha0_Win_x86.Presumably pBoss is null, but without being able to reproduce it its probably pointless to continue to handle each local oddity as they come up. I might have a windows environment in a few weeks to be try and reproduce the full set of issues, until then someone else can have a try.On todays TB39 build with second patch.On Windows 10 Pro 64-bit en-US withVersion: 5.3.0.0.alpha0+Build ID: 9dc3356f1499a2b90078be86ca7470eb2e96aba8CPU Threads: 8; OS Version: Windows 6.19; UI Render: default; TinderBox: Win-x86@39, Branch:master, Time: 2016-07-21_23:52:45Locale: en-US (en_US); Calc: CLRunning with OpenGL disabled (what one would expect for a user still on Windows XP) neither test document "crashes", the first scrolls backward and forward across page 44. The second takes a loooong time to open, but then behaves scrolling and paging.And, no apparent issue with OpenGL enabled.With 32-bit WinDbg attached, had some issues with RTL in en-US local, but those were are 1st & 2nd instance hangs. Without the debugger attached the documents seemed to function.Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-5-1":Related: tdf#100813 crash in this doc on scrolling past page 44It will be available in 5.1.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.(In reply to Commit Notification from)Was this patch committed only to the 5.1 branch? Unfortunately there aren't any Windows daily builds except for the Master branch.I tried a daily from the Master branch and it still crashedcrashreport.libreoffice.org/stats/crash_details/c6a87fff-47a9-4ec7-8a89-0397fcb1fea9Version: 5.3.0.0.alpha0+Build ID: 4a6329badc9c8679945d1a1ec225e26e15d7bfd2CPU Threads: 4; OS Version: Windows 6.2; UI Render: GL; TinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2016-07-30_10:25:39Locale: pt-PT (pt_PT); Calc: CL(In reply to Pedro from)There are two patches to flowfrm.cxx on master and both have been back-ported to the 5.1, and 5.2 builds. Both present on current master, and 5.2.0.4--but just the first is in 5.1.5.21.--- a/sw/source/core/layout/flowfrm.cxx+++ b/sw/source/core/layout/flowfrm.cxx@@ -2017,6 +2017,9 @@ bool SwFlowFrame::MoveBwd( bool &rbReformat ) } SwFootnoteBossFrame * pOldBoss = m_rThis.FindFootnoteBossFrame();+ if (!pOldBoss)+ return false;+ SwPageFrame * const pOldPage = pOldBoss->FindPageFrame(); SwLayoutFrame *pNewUpper = nullptr; bool bCheckPageDescs = false;2.--- a/sw/source/core/layout/flowfrm.cxx+++ b/sw/source/core/layout/flowfrm.cxx@@ -227,9 +227,9 @@ bool SwFlowFrame::IsKeep( const SwAttrSet& rAttrs, bool bCheckIfLastRowShouldKee { const SwAttrSet* pSet = nullptr; - if ( pNxt->IsInTab() )+ SwTabFrame* pTab = pNxt->IsInTab() ? pNxt->FindTabFrame() : nullptr;+ if (pTab) {- SwTabFrame* pTab = pNxt->FindTabFrame(); if ( ! m_rThis.IsInTab() || m_rThis.FindTabFrame() != pTab ) pSet = &pTab->GetFormat()->GetAttrSet(); }CreatedBacktrace of v5.2.0.4 x64 crash under Windows 10If those patches are included in 5.2.0.4 than I'm afraid it's not fixed yet.The document still crashes LO 5.2.0.4 under Win10 x64 and WinXP x86 (no problem with Win7 x64). Added a backtrace under Win 10 x64making this "platform: Windows" as perthis doesnt happen to crash on Linux anymore ...(In reply to Björn Michaelsen from)Actually it crashes LibreOffice on Win XP AND on Windows 10 but not on Windows 7.CreatedBacktrace of v5.2.1.1 x64 crash under Windows 10(In reply to Björn Michaelsen from)Setting Platform back to All. Document consistently crashes LibreOffice 5.2.0.4 under Ubuntu 14.04 LTS 64-bitAdding keyword 'bibisectRequest'.Does this now become a duplicate of?(In reply to Caolán McNamara from)The document in this bug report does not contain any images at all so the problem is not the same. But maybe the patch for 102073 also solved this problem. I will check when 5.2.3 is out.no crash with Version: 5.3.0.0.alpha0+Build ID: e2f6c7f0d0cc14f851d7028ff846c5dc658a81c6CPU Threads: 4; OS Version: Linux 4.4; UI Render: default; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-10-11_00:37:49I can reproduce crash on win7: Version: 5.3.0.0.alpha0+Build ID: a9717054dcb59010c95bdbfdb440ac12e8703796CPU Threads: 1; OS Version: Windows 6.1; UI Render: default; TinderBox: Win-x86@42, Branch:master, Time: 2016-10-12_06:32:34It seems that this remains Windows-only fileopen bug now, as already noted, since Linux can be open. Tested with master.This is crash report with LO 5.2.0.4 on Windows 7:crashreport.libreoffice.org/stats/crash_details/58616547-7caa-4311-ac55-5c8ea5cb75e6This is crash report with LO 5.2.3.3 on Windows 7:crashreport.libreoffice.org/stats/crash_details/a8ddf995-7fcd-402a-9c7c-e7f607db222aWindows master also crashes.This docx has 202 pages in MSO, 170 pages in OO 3.3. (aligned left), 17 pages in LO 4.1.6 (still aligned left) 18 pages in LO 4.2.8. (aligned right), how to find for versions which crash on fileopen or scroll started from LO 4.3, 241 pages in Linux 5.3+ master (which is actually rather fine).If bibisectRequest makes sense here at all, that would be for fileopen bug. But I wouldn't call this a regression, so I remove it.Removing 'bibisectRequest' keyword as this is not a regression as per(In reply to Xisco Faulí from)Added back regression and bibisectRequestTook a little time to test with older versions (because the document never crashed OpenOffice): LibreOffice branches 3.3, 3.4 and 3.5 load the document without crash. The first branch that crashes is 3.6 (tested with version 3.6.7.2 under Windows 10)Found a different crash with this document, and reported it in.Crashes in LO 5.2.2.2 on MacOS.Document now opens correctly under Windows 10 running version 5.3.0.1!Was there a specific patch committed that can be back-ported to branch 5.2?LO 5.3 beta 1 on Windows opens it with 199 pages and scrolls without crash. Seems like solved in 5.3. So this should be WorksForMe.But, since there were fixes here, I close as Fixed and change title to note that Windows fix came in another bug. PS I don't get why reports indon't refer to bugs like this one.Does it still crash when using the old layout engine?(In reply to Khaled Hosny from)Yes.For testers: The layout is seen in Help-About. To use disable new/use old layout engine it one needs to set environment variable SAL_NO_COMMON_LAYOUT=1.(In reply to Timur from)Thank you for the instructions, Timur. I can confirm that with Layout Engine: old the document still crashes LibreOffice. This means that the bug is fixed in 5.3 but can not be back-ported, right?This is not about simple bugfix that can be backported, it's new development, Harfbuzz layout engine from 5.3. Note: Since old code is dropped in 5.4, no layout is shown in Help-About there.FYI The document still crashes 5.3.0.1 under Windows XP.(In reply to Pedro from)That is fine, please post the crashreport link for its stacktrace and the signature it shows.(In reply to V Stuart Foote from)Unfortunately there is no Crash Report link. The Crash Report dialog just shows Error.Any suggestions?(In reply to Pedro from)That is a shame, if the "Breakpad" based report gatherer is not running to catch a minidump and submit it to the project crashreport server, you have to revert to catching the dump/mini-dump yourself and analyze--or catch the stack trace--either done with WinDbg against symbols for the project.=-ref-=Unfortunately the document now crashes LibO 5.3.0.2 under Win7 x64.This is the first version that crashes LibO under Win7Maybe this is related to the changes in issue #104969 ?Here is the Crash Reportcrashreport.libreoffice.org/stats/crash_details/c04bc87c-dbec-4a56-b3b2-28b4db85f06b(In reply to Pedro from)It doesn't crash for me inVersion: 5.4.0.0.alpha0+Build ID: db4badfc971b9cc60809c3408f579bae04a77c34CPU Threads: 1; OS Version: Windows 6.1; UI Render: default; TinderBox: Win-x86@42, Branch:master, Time: 2017-01-10_23:25:07Locale: es-ES (es_ES); Calc: group(In reply to Xisco Faulí from)Another crash, with an empty profilecrashreport.libreoffice.org/stats/crash_details/b3748eb2-0ab0-4c4c-bbfd-11525f4dff24Version: 5.3.0.2 (x64)Build ID: 5ad7b2889021c491af62f7930a4b1cb631392f16CPU Threads: 8; OS Version: Windows 6.1; UI Render: default; Layout Engine: new; Locale: pt-PT (pt_PT); Calc: groupSo, those both are crashes against signature "rtl_uString_acquire", added to the signature block.And with 5.3.0.2 on Windows 8.1 64-bit I also reproduce a crash, but at a different location and more in line with the issues that Caolán had already squashed.But on Windows 8.1 Ent 64-bit en-US withVersion: 5.3.0.2 (x64)Build ID: 5ad7b2889021c491af62f7930a4b1cb631392f16CPU Threads: 8; OS Version: Windows 6.29; UI Render: GL; Layout Engine: new; Locale: en-US (en_US); Calc: groupWith and without OpenGL rendering with new rendering, on scrolling through the document I receive the original crash between page 36 and 44.STR.Openthe .docx religious text in RTL Persian with "Traditional Arabic" font.Scroll or page to page 36, at the bottom there is a large block of footnotes held as rows in a table. On opening, they are compressed over top of each. A zoom into the page causes the table to expand removing the over written. Continue to scroll to page 43 there is another large table holding foot notes, it too will expand. Scroll back up to page 36 and then down to 43. Shortly have a crash.=-crash reports-= against SwContentFrame::MoveFootnoteCntFwd(bool,SwFootnoteBossFrame *)following Stuart's steps I can reproduce it inVersion: 5.4.0.0.alpha0+Build ID: db4badfc971b9cc60809c3408f579bae04a77c34CPU Threads: 1; OS Version: Windows 6.1; UI Render: default; TinderBox: Win-x86@42, Branch:master, Time: 2017-01-10_23:25:07Locale: es-ES (es_ES); Calc: groupbut not inVersion: 5.4.0.0.alpha0+Build ID: 4b3e8de6b3cb971b02aa0cb90aceb9e104071d3bCPU Threads: 4; OS Version: Linux 4.8; UI Render: default; VCL: gtk2; Locale: ca-ES (ca_ES.UTF-8); Calc: groupRaising severity and priorityI can reproduce a crash under Linux with that table on page 43 if I click in it and then press tab a lot to move around inside it.commit 1281bd5d87361fa516cdf247b055aeb4bb5e13fbAuthor: Mike Kaganski <>Date: Wed Jan 18 09:25:55 2017 +0300 tdf#104181 related: don't throw on this documentadded a check for the null pOldBoss I see in 5.3 to master to make it assert in debugging versions and continue without crashing in non-debug versions. I've added a 5-3 variant to not crash atand 5-3 atthis may help the windows crashCaolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-5-2":Related: tdf#100813 don't crash traversing table in page 43It will be available in 5.2.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Caolán McNamara committed a patch related to this issue.It has been pushed to "master":Related: tdf#100813 don't crash traversing table in page 43 master has...It will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.hi Caolánthanks extremely for your efforts to resolve my issues.i realy appreciate it and admire it.i pray for you and request divine extreme mercy for you in my five times daily prayers.could you please also solve it for libreoffice 5.2.5.2 also?i realy wish that open all of my books without any problem with libreoffice.most of my books are in docx format which the users of microsoft office give me.and also does it solve my issue related to?it was a very important book for me and God bless you for solving it.(In reply to Commit Notification from)(In reply to Commit Notification from)hi pedro, stuart and all testers and programmers that helped me to use libreoffice more properly and without worried about openning and reading my books!you are very helpful and i dont forget your kindness and goodness!in the five times daily prayers, i remember you and request divine special blessings and graces for you all.also hi Caoláni realy appreciate your efforts and endeaversto resolving my issues.i sincerely pray for you in my five time daily prayers and request divine extremely mercy and blessings for you.could you please provide the patch for version 5.2.5.2 of libreoffice too?i realy admire you and your tireless efforts to help people even for free!i realy wish that can open all of my documents properly without any hang or crash with libreoffice.most of my documents are in docx format which users of microsoft office give me.does your patch also resolve the problems with other books which i have?i mean that is this bug duplicate of theand also this bug which you mentioned its a duplicate of this bug?i meancould you please test these two bugs and compare the result with the current one?could you please solve this issue with libreoffice 5.2.5.2 also?i tried different versions of openoffice since 4.1.1 until the current version 4.1.3 and it does not crash for me.i mentioned this and asked these questions because i am not a programmer and i am completely unfamiliar with coding and computer programming.but also i realy wish that i can open my documents and read all of them completely as soon as possible!Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-5-3":Related: tdf#100813 don't crash traversing table in page 43It will be available in 5.3.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Createdcomparison MSO Writer 2010 and masterI can no longer reproduce the crash inVersion: 5.4.0.0.alpha0+Build ID: b41186a2fc49e440890b8c86e5367352ffaf9cd6CPU Threads: 1; OS Version: Windows 6.1; UI Render: default; TinderBox: Win-x86@42, Branch:master, Time: 2017-01-26_01:50:40Locale: es-ES (es_ES); Calc: groupHowever, I see that some of the table's data isn't display now. Is that expected?See the image attachedyeah, basically writer doesn't support tables in footnotes (try it in the ui and its not allowed) but the apis the docx import uses don't enforce that, so you get glitches with tables in footnotes. Not crashing is good enough for this bug.(In reply to Caolán McNamara from)But since MS Word does allow to insert tables (and apparently people use it) wouldn't it make sense for LibreOffice to use it too?Furthermore, when a document containing a footnote table is saved as ODT the whole table is simply eliminated without any warning (and the user will only realize this when the document is reopened)Is there some document rule that says that tables in footnotes are not acceptable?If such a rule exists, then the text in the table should be converted to footnote text, if not then tables in footnotes are a missing feature...(In reply to zahra from)excuse me, sorry for my mistake.i meant bug100959and 101125i could open my books in versions 5.1.6 and 5.2.5 under windows xp.i cant access newer versions of windows and i appreciate you if you test them in 5.2.5, 5.1.6 and 5.3.0 with different windows.i did not test these books with 5.3.0 and i am grateful to your help.This document consistently crashes LibreOffice 5.3.1.1 under Windows 7 x64 (but not under Windows 10 x64)Here is the crashreport (with a blank profile)crashreport.libreoffice.org/stats/crash_details/700f6008-729d-4542-a23d-4425cf2557f6(In reply to Pedro from)It doesn't crash for me inVersión: 5.3.0.3Id. de compilación: 7074905676c47b82bbcfbea1aeefc84afe1c50e1Subpr. de CPU: 1; Versión de SO: Windows 6.1; Repr. de IU: predet.; Motor de trazado: HarfBuzz; Configuración regional: es-ES (es_ES); Calc: groupHowever, I would suggest to create a follow-up bug as this one is quite large already. Thankshi.today i downloaded libreoffice 5.2.6.1 and installed it.its extremely great and compatible with xp beyond my immagination!i dont know how to appreciate God for its great favor, also you and all developers to helped me eventually find my favorite version and open all of my books properly!i have more than 90 islamic books in different folders!they are realy divine treasury for me.today i tested them and i could open them in 5.2.6.1 without crash!its incredible and one divine miracle for me!i dont know how appreciate God for this extremely great favor and also you all developers and programmers that helped me my dream (openning my documents without crash and complete compatibility with windows xp) became a reality!i am extremely happy and i cant discribe my happiness and feeling in english.even openning my books speed is increased very much in 5.2, i dont have any crash after exiting on windows xp and i study all of my books without any afraid!i should be grateful to this favor for my lord.because God says in the quran:And as for the favor of your Lord, do announce [it].i sincerely pray for you in my five times obligotary prayers because God says:And when you are greeted with a greeting, greet with a better [greeting] than it or return it; surely Allah takes account of all things.and also i pray for you and i am sure for acceptance in the divine court.because God is extremely merciful, accepts our prayers and said:And when My servants ask you concerning Me, then surely I am very near; Ianswer the prayer of the suppliant when he calls on Me, so they should answer Mycall and believe in Me that they may walk in the right way.you presented me the best version of your program for free, and i present my sincere and honest prayer which i always remember you, your kindness and i request divine infinite mercy, graces, blessings, bounties and favors for you all.
id=100964	Opened databases with this version:Version: 5.3.0.0.alpha0+Build ID: a2c557d80ac68c06ea59586245a7431e061938f0CPU Threads: 4; OS Version: Linux 4.1; UI Render: default; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-07-15_23:35:01Locale: de-DE (de_DE.UTF-8); Calc: groupThe whole part of the window for tables, queries, forms and reports is blank - without any header, without any content.Impossible to work with a database with this version of LO. ***has been marked as a duplicate of this bug. ***I also confirm this.Win 7 Pro 64-bit Version: 5.3.0.0.alpha0+Build ID: 28ac6fdc11559b58ac62089300aa99530b0b822dCPU Threads: 4; OS Version: Windows 6.1; UI Render: default; TinderBox: Win-x86@42, Branch:master, Time: 2016-07-18_02:54:20Locale: fi-FI (fi_FI); Calc: CLAlso confirming in my 5.3 alpha master buildChanging keyword bibisectRequest to bibisected.Working in the daily Linux dbgutil bibisect repository ondebian-stretch, I see that the bug came in somewhere in the 66 commitsbetween ... commit date s-h good c0a7b9f 2016-06-27 74c01bb bad 120e803 2016-06-28 f07aa11Createdoutput from "git bisect bad" and "git bisect log"Further to, I did my testing using embedded HSQLDB.Caolán McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: tdf#100964 singlevalfields cleanup took wrong branchIt will be available in 5.3.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Tested withVersion: 5.3.0.0.alpha0+Build ID: 0ccb3ccc4c7bafeb2fbbd689c90f710bc65d37e0CPU Threads: 4; OS Version: Linux 4.1; UI Render: default; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-07-20_23:34:15Locale: de-DE (de_DE.UTF-8); Calc: groupCould see tables, queries, forms and reports now. Works as expected. Thanks to Caolán.
id=101380	On my master build Version: 5.3.0.0.alpha0+Build ID: 3e7a6544da370f641b21fd03a86a1c84d6ea6576CPU Threads: 2; OS Version: Mac OS X 10.11.6; UI Render: default; Locale: fr-FR (fr.UTF-8); Calc: groupwhen I try to run a python script from the Run Macros dialog, I see a list of available script entries in the left hand pane of the the dialog, however, none of the python scripts are displayed in the right hand pane, which means one can not select them to be executed. CreatedScreenshot of Run Macro dialogIn lldb, I am seeing this when I try and descend the macro entry tree (left hadn window) :Python exception: <class 'TypeError'>: Expected bytes object or ByteSequence, got <class 'str'> instead., traceback follows File "/Applications/LibreOfficeDev.app/Contents/Resources/pythonscript.py", line 596, in getChildNodes self.funcnames = self.provCtx.getFuncsByUrl( self.uri ) File "/Applications/LibreOfficeDev.app/Contents/Resources/pythonscript.py", line 386, in getFuncsByUrl src = readTextFromStream( self.sfa.openFileRead( url ) ) File "/Applications/LibreOfficeDev.app/Contents/Resources/pythonscript.py", line 156, in readTextFromStream code = uno.ByteSequence( "" ) File "/Applications/LibreOfficeDev.app/Contents/Resources/uno.py", line 279, in __init__ raise TypeError("Expected bytes object or ByteSequence, got %s instead." % type(value))This works in LO5152A long time ago, in, there was also this exchange :has this re-surfaced again ?I have exatly the same problem with my Linux build from masterVersion: 5.3.0.0.alpha0+Build ID: 428a1da60b88415e7db21353a42bed85b8b76ed9Threads CPU : 4; Version de l'OS :Linux 4.4; UI Render : par défaut; Locale : fr-FR (fr_FR.UTF-8); Calc: groupLinuxMint 18 SarahNow fixed in Version: 5.3.0.0.alpha0+Build ID: 3a668616968dbce778c54ec56847828efa7bdb6dCPU Threads: 2; OS Version: Mac OS X 10.11.6; UI Render: default; Locale: fr-FR (fr.UTF-8); Calc: groupFixed by following commit :
id=101726	Createdcrash documentreproduce1. open attached file2. select sheet "Monat"3. select column A and press ⌘1 (menubar Format > Cells)Sadly I am not presented with a crash log. The recovery dialog automatically shows up after the crash, recovery works, repeat and enjoy endless loop. Version: 5.3.0.0.alpha0+Build ID: 3e6052ce1b9a24f82358e574de32919fa2b6499fCPU Threads: 4; OS Version: Mac OS X 10.11.6; UI Render: default; TinderBox: MacOSX-x86_64@49-TDF, Branch:master, Time: 2016-08-23_01:56:05Locale: de-DE (de.UTF-8); Calc: groupand persisting with nightly from todayNo crash.. maybe I should update to the latest.Win 7 Pro 64-bit Version: 5.3.0.0.alpha0+ (x64)Build ID: 264466bd604d7613aa0a5e4b34c149ad66414580CPU Threads: 4; OS Version: Windows 6.1; UI Render: default; TinderBox: Win-x86_64@62-TDF, Branch:MASTER, Time: 2016-08-21_21:59:38Locale: fi-FI (fi_FI); Calc: CLMight be MacOs only bug, let's specify hardware for the moment.No crash.Win 7 Pro 64-bit Version: 5.3.0.0.alpha0+Build ID: 1e84b23839d96068c862e746c9162db79d2c8c62CPU Threads: 4; OS Version: Windows 6.1; UI Render: default; TinderBox: Win-x86@39, Branch:master, Time: 2016-08-25_05:49:05Locale: fi-FI (fi_FI); Calc: CLComment oncrash documentcrash not related to any specific documentCreatedscreencastNot related to specific document. Screencast added showing instant crash on selecting Format > Cells with empty sheet.@Alex could you try to repor this on your macOS machine?Version: 5.3.0.0.alpha0+Build ID: 03f576466c9f110fbef8923604908654d59484a6CPU Threads: 2; OS Version: Mac OS X 10.11.6; UI Render: default; Locale: fr-FR (fr.UTF-8); Calc: groupConfirming, spectacular !Will try and get a bt. it makes no difference whether the shortcut or the menu Format > Cell is used, both produce a crash.Createdfull bt debug build osx 10.11.6This assertion fails:include/svl/itemset.hxx: class SVL_DLLPUBLIC SfxItemSet... template<class T> const T* GetItem(sal_uInt16 nWhich, bool bSearchInParent = true) const { const SfxPoolItem* pItem = GetItem(nWhich, bSearchInParent); const T* pCastedItem = dynamic_cast<const T*>(pItem); assert(!pItem || pCastedItem); // if it exists, must have the correct type return pCastedItem; }Kendy - any thoughts on that ? =)My guess would be that it is down to commit 200e336d1d5c036b5ecd308d93e4131274b1efb8 (only the change in sc/source/ui/inc/attrdlg.hxx), but of course bibisect / bisect would be most appreciated.Then again, the commit is a year old (was confused that it was in August too, but did not check the year). Really, need a bibisect here I fear.Reverting status change as bibisectRequest is not a valid reason for NEEDINFO (and will cause the report to be ignored by bibisecters most likely).works in Version: 5.3.0.0.alpha0+Build ID: 40fc2c1a0d2ebdf47131651045107c9d5abb850dCPU Threads: 4; OS Version: Mac OS X 10.12; UI Render: default; TinderBox: MacOSX-x86_64@49-TDF, Branch:master, Time: 2016-10-20_06:13:56Locale: de-DE (de_DE.UTF-8); Calc: group
id=101648	After I have opened a file which has a table-template element, I see this template in the new category "Table" in the Style&Formatting pane in the sidebar. If I right-click the item I get a context menu with the items New, Modify and Delete. After I click item Modify, I get the error messageFatal Errorfile:///F:/LO_daily/program/../share/config/soffice.cfg/modules/swriter/ui/templatedialog32.uiAfter I click the OK-button (no other option exists) LibreOffice crashes.The file templatedialog32.ui does not exist, templatedialog16.ui is the last one. I have used version Version: 5.3.0.0.alpha0+Build ID: 6431e91eca9e44684066a32ed3d6411509dac781CPU Threads: 4; OS Version: Windows 6.1; UI Render: default; TinderBox: Win-x86@42, Branch:master, Time: 2016-08-21_06:34:00Locale: de-DE (de_DE); Calc: groupExpected behavior: In case an option is not finished, it should not be offered or it shows a message box "not yet implemented", but never crashes.For testing you can use the attachment from. I get the same error and crash when I chose New.Createdbt with symbolsOn pc Debian x86-64 with master sources updated yesterday, I could reproduce this.I included some extra gdb traces.The problem is76 : SfxStyleDialog(pParent, 77 "TemplateDialog" + OUString::number((sal_uInt16)nRegion), 78 "modules/swriter/ui/templatedialog" + 79 OUString::number((sal_uInt16)nRegion) + ".ui", 80 rBase)nRegion = SfxStyleFamily::Table(sal_uInt16)nRegion = 32See also31 // This is used as a flags enum in sw/, but only there, 32 // so I don't pull in o3tl::typed_flags here 33 enum class SfxStyleFamily { 34 None = 0x00, 35 Char = 0x01, 36 Para = 0x02, 37 Frame = 0x04, 38 Page = 0x08, 39 Pseudo = 0x10, 40 Table = 0x20, 41 Cell = 0x40, 42 All = 0x7fff 43 };Yes the dialog wasnt created during GSoC and not sure if it will be. Likely the entry should be disabled in the menu for the time being.@ubap: Any plans to do this now that GSoC is over?***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***The same problem with LO 5.3.0.1 on macOS.file:///Applications/LibreOffice.app/Contents/Resources/../Resources/config/soffice.cfg/modules/swriter/ui/templatedialog32.ui***has been marked as a duplicate of this bug. ***Just confirmed that this bug still exists in 5.3.0RC2.1. Open document.2. Open Styles and Formatting tab on the sidebar.3. Click on the 'Table Styles' icon to bring up the 'Table Styles' tab.4. Right click on any style and in the context menu click either 'New' or 'Modify'.At this point a dialog pops up. It is titled: 'LibreOffice 5.3 - Fatal Error'. It contains the following error message: 'file:///home/timothy/Downloads/opt/LibreOffice_5.3.0.2_Linux_x86-64_deb/DEBS/install/opt/libreoffice5.3/program/../share/config/soffice.cfg/modules/swriter/ui/templatedialog32.ui'. When the user clicks okay, LibreOffice immediately exits.I also confirm this on 5.3.0rc2. It is important to note that this crash can also result on INFORMATION LOSS:1- Open a new document and insert a table with some data on it2- Apply a table style to that table3- Now right click on the style used → ModifyAs commented, Writer crash. When you open it again it starts the "file recovery" menu as expected, BUT the recovered document is completely EMPTY.The bug lists provided on the release notes for RC2 does NOT include this bug, which is a big problem: it seems that LibO 5.3 will be released with this quite evident and critical bug, a bug that can lead to data loss (see my previous comment), a bug that was reported on the pre alphas. IMO any bug like this one should be considered a "release stopper".QA/UI team: This patch allows to disable table list in sidebar.Should I submit it as a bandaid on gerrit?diff --git a/sw/source/uibase/app/swmodule.cxx b/sw/source/uibase/app/swmodule.cxxindex bd574866f7f9..8a8377940e5a 100644--- a/sw/source/uibase/app/swmodule.cxx+++ b/sw/source/uibase/app/swmodule.cxx@@ -424,11 +424,12 @@ SfxStyleFamilies* SwModule::CreateStyleFamilies() SW_RESSTR(STR_LISTSTYLEFAMILY), Image(BitmapEx(SW_RES(BMP_STYLES_FAMILY_LIST))), SW_RES(RID_LISTSTYLEFAMILY)));-+/* FIXME (see tdf#101648) pStyleFamilies->emplace_back(SfxStyleFamilyItem(SfxStyleFamily::Table, SW_RESSTR(STR_TABLESTYLEFAMILY), Image(BitmapEx(SW_RES(BMP_STYLES_FAMILY_TABLE))), SW_RES(RID_TABLESTYLEFAMILY)));+*/ return pStyleFamilies; }@Julien: is it possible to follow the solution offered by Samuel's work:(In reply to Julien Nabet from)may be just disable context menu? or create micro-window for context menu with message "This function don't work now"?why disable ALL new functional?(In reply to Mike Kaganski from)keyId for table style is ob4wq. A search onapp.src STR_TABLESTYLEFAMILY string.textI didn't find isExperimental in src file, only on ui file.(In reply to kompilainenn from)The second option will be perfect for this situation, I think.Indeed.n the LibreOffice 5.3.0.2 64bit Windows version don't have the bug posted hereUbuntu 64 bit 5.3.1.0.0+ the bug is still present.(In reply to Enio Gemmo from)oh shure - the bug is still present on Win 64. Just checked.My System: Version: 5.3.0.2 (x64)Build-ID: 5ad7b2889021c491af62f7930a4b1cb631392f16CPU-Threads: 4; BS-Version: Windows 6.19; UI-Render: Standard; Layout-Engine: neu; Gebietsschema: de-DE (de_DE); Calc: group(In reply to Julien Nabet from)(In reply to Mike Kaganski from)Disabling the table list in the sidebar or putting it in experimental mode isnt a preferable fix. It would be best to disable the modify entry in the context menu when opened within the table list.@Kendy, @Miklos: This has been created by our student, who unfortunately hasnt fix it, and it would be good if we could rectify it soon.I agree with RGB inThis show stopper bug should lead to either (1) fix it or, if not possible anytime soon, (2) suppress the table styles functionality from the application next version.Leaving such a bug, which makes table styles unusable, is very bad marketing. Hiding the dust under the carpet with the experimental option is, IMO, worse marketing.As a summary: the table styles are known to crash. They may induce data loss, as shown in comment. Leaving such a functionality, experimental or not, is very bad.Same behaviour occurs in Windows and OSX.***has been marked as a duplicate of this bug. ***A few people have mentioned this problem on social media. Given that this is one of the highlighted new features in 5.3, if we can't fix it for 5.3.1, can we at least remove the Modify menu option temporarily until it is fixed?Let's put maximum priority since:- it's a crash- it's a new feature that people will try because we've talked about it on release notes- it impacts every env- it's not basic case but not a corner case too***has been marked as a duplicate of this bug. ***Caolán McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: tdf#101648 disable new/modify of table stylesIt will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.lets just disable the edit/new menu entries for table styles for now cause there's no matching ui for them. backport to 5-3 in gerrit***has been marked as a duplicate of this bug. ***The patch was already commited to libreoffice-5-3 but we did not receive notification here. Updated whiteboard accordingly.Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-5-3":Resolves: tdf#101648 disable new/modify of table stylesIt will be available in 5.3.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.New and Modify are hidden now.***has been marked as a duplicate of this bug. ***
id=101771	In my master debug build LO530 alpha on OSX 10.11.6, I can not save a form in which I have added a control from the control toolbar. When I attempt to save the form, LO hangs, requiring a forced kill.Steps to reproduce:1) Open a database file2) Create a new blank form3) Select a control from the control toolbar with the mouse, and then draw a rectangle on the form to insert the control.4) Now try and save the form by clicking on the Save icon in the main toolbar (Cmd-S).5) The Save dialog window is displayed. Both the "Help" and "Save" buttons are highlighted.6) Click on the "Save" button.7) The dialog does not disappear, and LO hangs (spinning beachball mode). lldb output seems to suggest that a thread gets stuck waiting for a mutex sync operation (something is not releasing the mutex) ?We seem to be beset by these mutex release/locking problems.Createdbacktrace from lldb debugging sessionTested against production release :Version: 5.2.0.4Build ID: 066b007f5ebcc236395c7d282ba488bca6720265Threads CPU : 2; Version de l'OS :Mac OS X 10.11.6; UI Render : par défaut; Locale : fr-FR (fr.UTF-8)No repro.So either a recent regression in master, or else the problem only shows in debug builds.Tested against :Version: 5.3.0.0.alpha0+Build ID: d7ce684cae03e97b23f916a90db55e49f17a1601Threads CPU : 4; Version de l'OS :Linux 4.4; UI Render : par défaut; Locale : fr-FR (fr_FR.UTF-8); Calc: groupon LinuxMint 18 and reproducible.In this build, the Save dialog disappears, but then the Form design window becomes unresponsive, and the mouse cursor displays as crosshairs as if one could draw a new control, but in fact it is impossible to click anywhere in the window other than on the window border "Close" icon. If one attempts to close the window in this way, the system returns a message that the app is unresponsive and offers to kill it.Createdbt with symbolsOn pc Debian x86-64 with master sources updated yesterday, I could reproduce the crash.I noticed that if you waited (about a minute) once the form was created or perhaps once the rectangle was created, it didn't crash.huh, was sure I could reproduce this, reverted...commit 403eefe81b8a0afe888c60452c17d6b2c5d8343fAuthor: Michael Stahl <>Date: Wed Jul 27 15:02:52 2016 +0200 tdf#101136 dbaccess: use SolarMutex in ModelMethodGuardand it worked, but then when I restored that it still worked. Still suspicious I guess, but not certain now.Adding keyword 'bibisectRequest'.Createdbibisect outputHeh. I was just saving this until I had internet access again.Working in the Win32-5.3 bibisect repository on Windows Vista (detailsin attachment), I have determined: commit s-h committed ------- ------- --------------------- good f76ed2d 4acac00 2016-08-03 11:26:42 Z bad 8a5bc37 403eefe 2016-08-03 11:27:44 Zso I am setting keyword bisected.Funny workaround: command line parameter --norestore, at least in thedbgutil repository versions.I have also provoked a similar hang of the main database window whensaving the file during File > Close. I am assuming it is the same bugbecause bibisect points to the same commit. Please excuse the lengthof this comment: I wrote thinking it would be a new bug report.STR---(1) From Start Center, create database with embedded Firebird.(2) In database window, take menu options Tools > SQL... . Program presents window "Execute SQL Statement".(3) In control "Command to execute", enter create table t1 ( id integer not null, field1 varchar(20) not null ); and click button <Execute>. Control Status shows "1: Command successfully executed.".(4) Click button <Close>. Program closes window "Execute SQL Statement" and return focus to the database window.(5) Take menu options File > Close. Program presents prompt "Save Document?".(6) Click button <Save>. Expected : program closes database window and displays Start Center. Observed : After about 10 seconds, the window title changes to "... - LibreOfficeDev Base (Not Responding)" and the cursor changes to the dreaded circling blue whatever-it-is. It is necessary to cancel the program, e.g., with <Alt>+F4. Some odd points, mostly from the daily build noted below ...(*) With an existing .odb, there is no hang.(*) With embedded HSQLDB, the hang occurs in step (5) before the program prompts to save the document.(*) If at the prompt in step (6) I decline to save the file, there is no hang.(*) If I save the the .odb explictly after step (4), there is no hang.(*) If instead of steps (2) through (4), I create a table in Table Design view and save the definition first, the program hangs closing the Table Design window.(*) Given command line parameter --norestore, dbgutil version from 2016-08-23, at least, does not hang.These observations are from Windows Vista; LibreOffice versions aredaily build Version: 5.3.0.0.alpha0+ Build ID: ce95e39f8e952159844e9dc04a1df402bb103634 CPU Threads: 2; OS Version: Windows 6.0; UI Render: default; Locale: en-CA (en_CA); Calc: groupand some versions from the Win32-5.3 bibisect repository.Working in the Win32-5.3 bibisect repository, I have determined: commit s-h committed ------- ------- --------------------- good f76ed2d 4acac00 2016-08-03 11:26:42 Z bad 8a5bc37 403eefe 2016-08-03 11:27:44 ZJust an aside ...Not remembering why O/S=All in this report, I tried to reproduce theproblem on windows. All I got was another example of tdf#101771 "FORMcreation - hang/crash - impossible to save a control created fromcontrol toolbar".With pc Debian x86-64 with master sources updated 2 days ago (ba269f7294e2416659011cbb498a2c6b5f9d5199), I don't reproduce the crash but it hangs.the commit inwas a huge change in Base threading,it is quite likely that it causes some deadlocks somewhere...on Linux, can't reproduce the deadlock inbut i think i fixed itthe assertion inprobably indicates that there's a staleiterator contained in m_aDocuments; probably that's an unrelated problem?it's not clear to me how this could happen from looking at the ODefinitionContainer...on Linux, can't reproduce the deadlock inwith the first fixapplied, it's quite likely that it's the same deadlock,given that --norestore is a work-around and it was in AutoRecoveryplease continue testing master Base for deadlocksMichael Stahl committed a patch related to this issue.It has been pushed to "master":tdf#101771 framework: avoid deadlock in AutoRecoveryIt will be available in 5.3.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.lets set this to fixed cause we think it isI see that the reported bug is fixed between daily Linux dbgutilbibisect repository versions 2016-09-15 and 2016-09-16. Alex, can youverify that it is fixed for you?The problem I mentioned inpersists. I shall file a newbug report for it.I am abandoning my intention to file a new bug report, as I am unableto get consistently reproducible results. Sigh!
id=101924	Steps to reproduce:1. Create any document (Text Document, Spreadsheet, Presentation, Drawing, Database).2. Click "Find & Replace…” on Menu bar.3. Click “Other Options” then click “Sounds like (Japanese)” then click “Sounds…” button.4. Check one of options with'repeat character' marksba/va, ha/fatsi/thi/chi, dhi/zihyu/fyu, byu/vyuse/she, ze/jeia/iyaki/kuProlonged vowels (ka-/kaa)5. Then click “OK” button6. Input “test” in "Find: " input field then “Find Next” button.Your LibreOffice will crash.Current behavior:LO showed dialogue "LibreOffice 5.2 - Fatal Error".Expected behavior:LO found the text.Version: 5.2.1.2Build ID: 31dd62db80d4e60af04904455ec9c9219178d620CPU Threads: 8; OS Version: Mac OS X 10.9.5; UI Render: GL;Locale: en-US (ja.UTF-8); Calc: group Confirming withVersion: 5.3.0.0.alpha0+Build ID: 03f576466c9f110fbef8923604908654d59484a6CPU Threads: 2; OS Version: Mac OS X 10.11.6; UI Render: default; Locale: fr-FR (fr.UTF-8); Calc: groupCreatedlldb session outputNo crash inVersion: 4.4.5.2Build ID: a22f674fd25a3b6f45bdebf25400ed2adff0ff99Locale: fr.UTF-8Crashes as per the bug report withVersion: 5.0.0.2Build ID: a26d58f11b99b6aeddf7f7884effea188cc6e512Locale: en-GB (fr.UTF-8)Reproduced with Ubuntu 16.04 5.3dev.Attempted bibisecting. crashed in oldest52 (lo_linux_debug_daily), but worked in master51 (shouldn't be possible, but I may be missing some commits around that time frame...).On pc Debian x86-64 with master sources updated today, I could reproduce this.with rendering KDE4, I noticed this:warn:vcl:4907:1:vcl/unx/generic/window/salframe.cxx:2018: X11SalFrame::Restore on withdrawn windowX Error: BadMatch (invalid parameter attributes) 8 Major opcode: 42 (X_SetInputFocus) Resource id: 0x1a0071eWith rendering=gen, I've got an empty error message box, then it quits (so impossible in this case to retrieve a bt)With gtk3 rendering, it's very slow (it seems we've got a regression here)I noticed these:warn:vcl:5033:1:vcl/source/window/winproc.cxx:832: ImplHandleKey: Keyboard-Input is sent to a frame without focus#25 0x00002aaaaca293c1 in g_object_new () from /usr/lib/x86_64-linux-gnu/libgobject-2.0.so.0#26 0x00002aaac7866c81 in GtkSalSystem::ShowNativeDialog (this=0x2269930, rTitle="LibreOfficeDev 5.3 - Fatal Error", rMessage="", rButtonNames=std::__debug::list = {...}, nDefaultButton=0) at /home/julien/lo/libreoffice/vcl/unx/gtk3/../gtk/gtksys.cxx:278#27 0x00002aaab43e2a87 in SalGenericSystem::ShowNativeMessageBox (this=0x2269930, rTitle="LibreOfficeDev 5.3 - Fatal Error", rMessage="") at /home/julien/lo/libreoffice/vcl/unx/generic/app/gensys.cxx:103#28 0x00002aaab426b4ea in Application::ShowNativeErrorBox (sTitle="LibreOfficeDev 5.3 - Fatal Error", sMessage="") at /home/julien/lo/libreoffice/vcl/source/app/svapp.cxx:1656#29 0x00002aaaaafb7b61 in desktop::(anonymous namespace)::FatalError (sMessage="") at /home/julien/lo/libreoffice/desktop/source/app/app.cxx:443#30 0x00002aaaaafbc2cf in desktop::Desktop::Main (this=0x7fffffff4a80) at /home/julien/lo/libreoffice/desktop/source/app/app.cxx:1662Finally I noticed this log on some cases:warn:legacy.tools:4754:1:cui/source/options/optjsearch.cxx:211: Transliteration settings differentCaolan: thought you might be interested in this one.The "ShowNativeDialog" is the dialog used to report fatal exceptions. So the core problem is the earlier fatal exception from i18npool.I feel the problem there came from.... commit 1a967fead616b201535449fa812775c88d5b2e3b Author: Eike Rathke <> Date: Tue Mar 24 15:53:23 2015 +0000 do not include non-mask bits in masksmight be the right fix for that.Adding keyword 'bibisectRequest'.Caolán McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: tdf#101924 fatal exception on Sounds like Japanese optionsIt will be available in 5.3.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Thanks Caolán and everyone with all of my heart!I confirmed LO can find the text correctly with "Sounds like(Japanese)" option.Version: 5.3.0.0.alpha0+Build ID: 74fd959945dbbfbc3dcc331a08ff8fc7c6410295CPU Threads: 8; OS Version: Mac OS X 10.9.5; UI Render: default; TinderBox: MacOSX-x86_64@49-TDF, Branch:master, Time: 2016-09-13_23:07:56Locale: ja-JP (ja.UTF-8); Calc: groupCaolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-5-2":Resolves: tdf#101924 fatal exception on Sounds like Japanese optionsIt will be available in 5.2.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.I confirmed works fine on Windows7.But I cannot confirm where dev build for OS X is.Version: 5.2.3.0.0+Build ID: 14f914eb105765386438ae53c83c5ce295648414CPU Threads: 4; OS Version: Windows 6.2; UI Render: default; TinderBox: Win-x86@62-merge-TDF, Branch:libreoffice-5-2, Time: 2016-09-15_13:58:05Locale: ja-JP (ja_JP); Calc: groupLet's put this one to FIXED.Thank you Caolán and Eike! :-)
id=102064	CreatedbacktraceSteps:1) Open writer2) Open a second writer window3) In either of them activate View > Toolbar Layout > Notebookbar4) CrashVersion: 5.3.0.0.alpha0+Build ID: f7513f0f53f2d074c08610a68fb787bb379c31d4CPU Threads: 2; OS Version: Linux 3.19; UI Render: default; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-09-02_23:58:05Locale: en-US (en_US.UTF-8); Calc: group Confirmed in Windows 7 with below master build.Version: 5.3.0.0.alpha0+Build ID: f7513f0f53f2d074c08610a68fb787bb379c31d4CPU Threads: 4; OS Version: Windows 6.1; UI Render: default; Locale: hu-HU (hu_HU); Calc: CLthink this was fixed already, please verifyYes fixed.Version: 5.3.0.0.alpha0+Build ID: 78404fe5549fded2eaf0c5ea6e1ca66039e995afCPU Threads: 2; OS Version: Linux 3.19; UI Render: default; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-09-11_09:14:01Locale: en-US (en_US.UTF-8); Calc: groupLet's consideras the fix and update status.
id=102233	CreatedDOCX that crashes after save & reopen1. Open the attached DOCX2. Save it3. ReloadCrashes.Does not crash in 4.4. Tested crashing both on Windows and Linux. CreatedBacktrace of crash with LibO 5.3Arch Linux 64-bit, KDE Plasma 5Version: 5.3.0.0.alpha0+Build ID: cfde3fd966ae9ef35fe685759e7e19bf0b8466abCPU Threads: 8; OS Version: Linux 4.7; UI Render: default; Locale: fi-FI (fi_FI.UTF-8); Calc: groupBuilt on September 16th 2016On pc Debian x86-64 with master sources updated today, I could reproduce this.It crashes already with 5.0.2.2.No crash with 4.4.5.2.Tested on Win 7.Not reproduced with v5.0.0.5, 5.1.0.3, 5.2.0.4 and 5.2.1.2 / Windows 7.In bt, we can see this:#1 0x00007f5077b909a9 in __dynamic_cast () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6#2 0x00007f507328767d in SfxItemSet::Get (this=0x9db1928, nWhich=94, bSrchInParent=true) at /home/julien/lo/libreoffice/svl/source/items/itemset.cxx:804#3 0x00007f504d07d7d0 in SwAttrSet::GetContent (this=0x9db1928, bInP=true) at /home/julien/lo/libreoffice/sw/inc/fmtcntnt.hxx:52#4 0x00007f504d07d7f9 in SwFormat::GetContent (this=0x9db18f0, bInP=true) at /home/julien/lo/libreoffice/sw/inc/fmtcntnt.hxx:55#5 0x00007f504d496522 in SwNode::GetFlyFormat (this=0xa0f1980) at /home/julien/lo/libreoffice/sw/source/core/docnode/node.cxx:723#6 0x00007f504d49547d in SwNode::IsProtect (this=0xa0f1980) at /home/julien/lo/libreoffice/sw/source/core/docnode/node.cxx:433#7 0x00007f504d4954f5 in SwNode::IsProtect (this=0xa0f1980) at /home/julien/lo/libreoffice/sw/source/core/docnode/node.cxx:439...#366 0x00007f504d4954f5 in SwNode::IsProtect (this=0xa0f1980) at /home/julien/lo/libreoffice/sw/source/core/docnode/node.cxx:439#367 0x00007f504d4954f5 in SwNode::IsProtect (this=0xa0f1980) at /home/julien/lo/libreoffice/sw/source/core/docnode/node.cxx:439...so it seems we entered in a infinite recursive loop.I'll give a try withMiklos: After having retested this one, I noticed the docx resaved was different from the original.Just in main xml content, I got this (with master sources updated today), eg:< <Default Extension="emf" ContentType="image/x-emf" />< <Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" />< <Default Extension="xml" ContentType="application/xml" />< <Default Extension="xlsx" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" />---Any thoughts?Julien Nabet committed a patch related to this issue.It has been pushed to "master":tdf#102233: avoid infinite loop recursion in IsProtect node methodIt will be available in 5.3.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.doesn't crash after that, so lets close it as fixed in master. I haven't queued backports howevergerrit review for 5.2 branch:Julien Nabet committed a patch related to this issue.It has been pushed to "libreoffice-5-2":tdf#102233: avoid infinite loop recursion in IsProtect node methodIt will be available in 5.2.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Verified the fix in 5.3. Thanks a lot, guys!Arch Linux 64-bit, KDE Plasma 5Version: 5.3.0.0.alpha0+Build ID: 7cf444454c0c27e2f6d764164ea880b87163f45aCPU Threads: 8; OS Version: Linux 4.7; UI Render: default; Locale: fi-FI (fi_FI.UTF-8); Calc: groupBuilt on September 27th 2016
id=102347	CreatedsampleSteps:1) Open attachment2) Select all the text and change the font name in the toolbar3) One CPU core maxes out at 100% and UI doesnt refresh properly (e.g. alt+tab back and forth and it wont redraw the document, but will show the blinking cursor)Regression as this doesnt happen in 5.2 daily.Version: 5.3.0.0.alpha0+Build ID: dec8da2a9aadbb6758ee76c30582bd8620a10ecbCPU Threads: 2; OS Version: Linux 3.19; UI Render: default; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-09-21_05:53:33Locale: en-US (en_US.UTF-8); Calc: group Interesting indeed; would love to have this bisected ... thanks =)I can't reproduce with:Win10x64Version: 5.3.0.0.alpha0+Build ID: 3287bc2f91438085b7604773d5e0346fc3c3f452CPU Threads: 4; OS Version: Windows 6.19; UI Render: default; TinderBox: Win-x86@42, Branch:master, Time: 2016-09-18_05:11:16Locale: es-ES (es_ES); Calc: CLVersion: 5.3.0.0.alpha0+Build ID: 4c70a1a6666a079872b8f1966bd398e924dc1d1aCPU Threads: 4; OS Version: Windows 6.19; UI Render: default; TinderBox: Win-x86@42, Branch:master, Time: 2016-09-22_06:54:24Locale: es-ES (es_ES); Calc: CLIn my I3 2-3% of cpu usage.Maybe only Linux issue.There are some things really slow first time LibreOffice is open, more visible in master, i.e. selecting in context menu character or paragraph options, or in calc the format option.Reported bug, perhaps in relation:Format cell dialog very slow to pop upI can't find now but I think there was some bug about the slowness on load font list first time.I thing this is a problem from...commit 6dc1d2706f519d91617ac1a12fc2051d97ef98c0Author: Caolán McNamara <>Date: Mon Jun 15 10:56:33 2015 +0100 another stab at tdf#91393 block paints only if the new requested size is larger than the original and unblock on explicit expose events as well as configure ones ...commit 8f324aebfb94c4b2023894121b954ad4f35eb395Author: Caolán McNamara <>Date: Sun Jun 14 15:49:56 2015 +0100 Resolves: tdf#91393 autotext (etc) not fully drawn...commit e6a1956034c98204e30b0ca40330249d6f6f8155Author: Jan Holesovsky <>Date: Fri Jun 12 15:36:03 2015 +0200 tdf#91301: Don't cache incomplete tabs. After introduction of the Idle processing, something has changed so that the underlying GetGdkWindow() does not update its size fast enough; even though the gtk_window_resize() is called before the Window::Erase() (that actually paints the background) etc.i.e. if you resize the window slightly when cpu is 100% it'll jump back down to low load afterwardsCaolán McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: tdf#102347 configure size/expose might never come...It will be available in 5.3.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.remove this wrong-direction broken stuff. I don't see the original problems anymore to see if they need an additional fix of some other kind.Caolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-5-2":Resolves: tdf#102347 configure size/expose might never come...It will be available in 5.2.3.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=102503	User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:49.0) Gecko/20100101 Firefox/49.0Build Identifier: Version: 5.0.6.3 Build ID: 00m0(Build:3) Locale: en-GB (en_GB.UTF-8) (provided by SUSE)When I save a larger presentation (500 slides, 45 MB) then the save bar moves to the end with 100% CPU load on one core. If all goes right a number of parallel threads is executed then (CPU monitor shows User, IO Wait, and System processes ) and finally the UI is refreshed. In the bad case, which happens, say, every 10th save attempt (could be every other save attempt on bad days) I don't see the parallel processes at the end. The UI is frozen then and I have to kill it forcefully.I saw this behavior in the 4.x.x versions already, even on Windows 8.1, where the behavior was even worse. Interestingly, I used to run SuSE 13.2 in VirtualBox and there the behavior was better. When I moved on to a native SuSE 13.2 installation I saw problems increasing again.Reproducible: SometimesSteps to Reproduce:1. Open large document2. Do some (even minor) modifications3. Save4. Repeat until freeze is seen (about 10 times)Actual Results: UI frozen. Needs to be closed forcefully. The document needs to be recovered after the next start. The changes that were supposed to be saved are lost.Expected Results: Save file including changes done after last successful save.This bug looks similar to 100281 and 98750, but I hope I can provide some new information.SuSE Linux 13.2, Kernel 3.16.7-42-desktop, x86_64=> gdb reports a segmentation fault in the freeze case:[New Thread 0x7fffd28c5700 (LWP 25024)][Thread 0x7fffd28c5700 (LWP 25024) exited][New Thread 0x7fffd28c5700 (LWP 25025)][Thread 0x7fffd28c5700 (LWP 25025) exited]Program received signal SIGSEGV, Segmentation fault.[Switching to Thread 0x7fffbadf2700 (LWP 24910)]0x00007fffb40a7990 in ?? ()(gdb) bt#0 0x00007fffb40a7990 in ()#1 0x00007fffeeb3c705 in cppu::OWeakObject::release() () at /usr/lib64/libreoffice/program/libuno_cppuhelpergcc3.so.3#2 0x00007fffeeadeb71 in cppu::PropertySetMixinImpl::Impl::setProperty(com::sun::star::uno::Reference<com::sun::star::uno::XInterface> const&, rtl::OUString const&, com::sun::star::uno::Any const&, bool, bool, short) const () at /usr/lib64/libreoffice/program/libuno_cppuhelpergcc3.so.3#3 0x00007fffeeadf332 in cppu::PropertySetMixinImpl::setPropertyValue(rtl::OUString const&, com::sun::star::uno::Any const&) () at /usr/lib64/libreoffice/program/libuno_cppuhelpergcc3.so.3#4 0x00007ffff58bcbc7 in ZipOutputEntry::createBufferFile() () at /usr/lib64/libreoffice/program/libmergedlo.so#5 0x00007ffff58e63a2 in DeflateThread::doWork() () at /usr/lib64/libreoffice/program/libmergedlo.so#6 0x00007fffef08d66d in comphelper::ThreadPool::ThreadWorker::execute() () at /usr/lib64/libreoffice/program/libcomphelper.so#7 0x00007fffee22ce36 in salhelper::Thread::run() () at /usr/lib64/libreoffice/program/libuno_salhelpergcc3.so.3#8 0x00007fffee22cffa in threadFunc() () at /usr/lib64/libreoffice/program/libuno_salhelpergcc3.so.3#9 0x00007ffff41af127 in osl_thread_start_Impl() () at /usr/lib64/libreoffice/program/libuno_sal.so.3#10 0x00007ffff34930a4 in start_thread (arg=0x7fffbadf2700) at pthread_create.c:309#11 0x00007ffff3eb1cbd in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:111Reset User Profile?Yes. I cannot provide a sample presentation because it is all copyrighted material which must not become public. I could provide such an individual contributor given the recipient understands this restriction and promises to keep this presentation to himself/herself.Changing it to NEW as the backtrace has been providedHello Gizze,Is it possible that you attach a complete backtraceor a minimal document to reproduce the bug?I could only provide a sample file on a private basis outside this public bug tracking tool because it is subject to copyright. I can produce further traces if needed.CreatedBacktrace produced with soffice --backtraceGizze: would be interesting to hear, if the hangs continue with LibreOffice 5.2.x.(I unpacked the gdbtrace.log and reattached. I don't know why our wiki advised to pack it. I changed the wiki)(In reply to Buovjaga from)Thanks for this suggestion, Buovjaga.I did some further tests with LibreOffice 5.0.6.3:On an old 32-bit Pentium M machine (single threaded) with openSUSE 13.2I was not able to reproduce the problem.With 64-bit openSUSE 13.2 on a virtual machine I saw no crashes in a configuration with just one logical CPU. I observed regular crashes in a configuration with four logical CPUs.Conclusion: Maybe this is a race condition among several processes.This goes in line with the observation that the saving process always crashes towards the end when multiple parallel processes run on separate (logical) CPUs.This is what I found with LibreOffice 5.2.2.2:No crashes seen with 64-bit openSUSE on a virtual machine even in a configuration with four logical CPUsNo crashes seen with a 64-bit openSUSE bare bone installation on a four core CPU.Windows 8.1Frequent crashes still. I don't care about Windows, though. I compiled this presentation on Linux. Maybe we are seeing yet another problem at this point.So this looks good so far. Let me continue my daily work with this setup and see how reliable this LibreOffice version works now.Ok, I changed the OS field to Windows.You could get a backtrace with WinDbg:We should try and care about Windows as well ;)CreatedWindows BacktraceIndeed, we should care about Windows as well if we care about LibreOffice. Note that I usually do not work on Windows. Therefore the problem at hand may be an interoperability issue different from the problem I had on Linux originally.Anyway, I created a Windows backtrace following the instructions on the "How to get a backtrace with WinDbg" page. The symbol resolution does not seem to work properly yet. If this backtrace is not good enough let me know and include some hints to improve its quality.CreatedDebian BacktraceI have the same problem with Version 5.2.2.2.0+ from the Jessie Backports under Debian 8.6.Impress hangs ALWAYS. For example, when I open a new document and am going to save it, Impress freezes. This bug can be reproduced and makes Impress completely useless.I did not have problems with former versions.Not sure, how to proceed, but we seem to have a confirmation with bbugs's experience, so setting to NEW.the stack trace in the description matchessame for the one inis quite clever, yes this crash is a racestack apparently shows an error-box being displayed, not sure what to make of that, maybe the race didn't cause a crash but some exception instead...back-trace is useless, something killed soffice.bin before the stack could be obtainedi think the multi-threaded zip problem reported by "Gizze" should be fixed in current 5.1 / 5.2 releases, so maybe "bbugs" is seeing a different bug, but hard to tell without a proper backtrace.hello bbugs,could it be possible that you provide a backtrace with debugging symbols? You can download it fromand get the backtrace followingSetting the bug to NEEDINFO for the time being. Change it to NEW once the backtrace is providedcould be the same issue.(In reply to Michael Stahl from)Good news from my side:I have been working on Linux with 5.1 for a week now and I have not seen a single crash on save.Resolving - as presumed fixed - is that ok Gizze - would love to know if it continues to work for you ? if other similar (or even different ;-) problems recur - it would be great to open new bugs for them and mark this one as 'See Also' if they're related.Thanks !(In reply to Michael Meeks from)I have not seen a single crash on save on Linux ever since I went to version 5.1.So the Linux part of this can be closed from my side. That's what I cared about most, so this ticket could be closed.However, the Windows side does not seem to be clean yet, but that could be another issue (e.g. interoperability since I compiled the respective presentation on Linux). The Windows save operation seems to freeze earlier. So maybe it would be better to follow up on tickets related to the save operation which were submitted by Windows users.I am wondering, though, whether bbugs' observations should be handled further on this ticket.Thanks a lot for your support on this!(In reply to Gizze from)The Windows side can be followed up on in.(In reply to Aron Budea from)OK! Thanks again for all the support on this.
id=103063	Createdoffending .docx fileAttached you find a .docx file that makes at least libreoffice-5.0.4.2-3.fc23.x86_64 and libreoffice-5.1.5.2-9.fc24.x86_64 crash on import.On import it says: "Due to an unexpected error, LibreOffice crashed…" and so on, without further details on the precise error.When I run oowriter with "--backtrace" I get the following:<snip>warning: Currently logging to gdbtrace.log. Turn the logging off and on to make the new setting effective.[Thread debugging using libthread_db enabled]Using host libthread_db library "/lib64/libthread_db.so.1".[New Thread 0x7fffe090c700 (LWP 22474)]Detaching after fork from child process 22475.warning: Corrupted shared library list: 0x5555557986d0 != 0x5555557973f0[New Thread 0x7fffd5be5700 (LWP 22480)][New Thread 0x7fffd53e4700 (LWP 22481)][New Thread 0x7fffce763700 (LWP 22484)][New Thread 0x7fffcdf62700 (LWP 22485)][New Thread 0x7fffbbfff700 (LWP 22499)][New Thread 0x7fffba5b2700 (LWP 22502)][Thread 0x7fffd5be5700 (LWP 22480) exited]Detaching after fork from child process 22507.[New Thread 0x7fffd5be5700 (LWP 22513)][New Thread 0x7fffb266e700 (LWP 22515)][Thread 0x7fffb266e700 (LWP 22515) exited]Program received signal SIGSEGV, Segmentation fault.0x00007fffb2739dae in writerfilter::dmapper::DomainMapper_Impl::finishParagraph(std::shared_ptr<writerfilter::dmapper::PropertyMap>) () from /usr/lib64/libreoffice/program/../program/libwriterfilterlo.so#0 0x00007fffb2739dae in writerfilter::dmapper::DomainMapper_Impl::finishParagraph(std::shared_ptr<writerfilter::dmapper::PropertyMap>) () at /usr/lib64/libreoffice/program/../program/libwriterfilterlo.so#1 0x00007fffb26f9e37 in writerfilter::dmapper::DomainMapper::lcl_utext(unsigned char const*, unsigned long) () at /usr/lib64/libreoffice/program/../program/libwriterfilterlo.so#2 0x00007fffb27d16ca in writerfilter::ooxml::OOXMLFastContextHandler::endOfParagraph() () at /usr/lib64/libreoffice/program/../program/libwriterfilterlo.so#3 0x00007fffb27cf43d in writerfilter::ooxml::OOXMLFactory::endAction(writerfilter::ooxml::OOXMLFastContextHandler*, int) () at /usr/lib64/libreoffice/program/../program/libwriterfilterlo.so#4 0x00007fffbab1bd50 in (anonymous namespace)::Entity::endElement() () at /usr/lib64/libreoffice/program/../program/libexpwraplo.so#5 0x00007fffee67ce13 in xmlParseEndTag2 () at /lib64/libxml2.so.2#6 0x00007fffee68299f in xmlParseTryOrFinish () at /lib64/libxml2.so.2#7 0x00007fffee6844bb in xmlParseChunk () at /lib64/libxml2.so.2#8 0x00007fffbab1dc45 in sax_fastparser::FastSaxParserImpl::parse() () at /usr/lib64/libreoffice/program/../program/libexpwraplo.so#9 0x00007fffbab21265 in sax_fastparser::FastSaxParserImpl::parseStream(com::sun::star::xml::sax::InputSource const&) () at /usr/lib64/libreoffice/program/../program/libexpwraplo.so#10 0x00007fffb27cd3f4 in writerfilter::ooxml::OOXMLDocumentImpl::resolve(writerfilter::Stream&) () at /usr/lib64/libreoffice/program/../program/libwriterfilterlo.so#11 0x00007fffb27bfa6c in WriterFilter::filter(com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) () at /usr/lib64/libreoffice/program/../program/libwriterfilterlo.so#12 0x00007ffff467c471 in SfxObjectShell::ImportFrom(SfxMedium&, com::sun::star::uno::Reference<com::sun::star::text::XTextRange> const&) () at /usr/lib64/libreoffice/program/libsfxlo.so#13 0x00007ffff46814ce in SfxObjectShell::DoLoad(SfxMedium*) () at /usr/lib64/libreoffice/program/libsfxlo.so#14 0x00007ffff46b474f in SfxBaseModel::load(com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) () at /usr/lib64/libreoffice/program/libsfxlo.so#15 0x00007ffff473d26f in (anonymous namespace)::SfxFrameLoader_Impl::load(com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&, com::sun::star::uno::Reference<com::sun::star::frame::XFrame> const&) () at /usr/lib64/libreoffice/program/libsfxlo.so#16 0x00007fffcd150b6b in framework::LoadEnv::impl_loadContent() () at /usr/lib64/libreoffice/program/../program/libfwklo.so#17 0x00007fffcd151878 in framework::LoadEnv::startLoading() () at /usr/lib64/libreoffice/program/../program/libfwklo.so#18 0x00007fffcd0e372d in framework::LoadDispatcher::impl_dispatch(com::sun::star::util::URL const&, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&, com::sun::star::uno::Reference<com::sun::star::frame::XDispatchResultListener> const&) () at /usr/lib64/libreoffice/program/../program/libfwklo.so#19 0x00007fffcd0e4568 in framework::LoadDispatcher::dispatchWithReturnValue(com::sun::star::util::URL const&, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) () at /usr/lib64/libreoffice/program/../program/libfwklo.so#20 0x00007ffff5a7654d in comphelper::SynchronousDispatch::dispatch(com::sun::star::uno::Reference<com::sun::star::uno::XInterface> const&, rtl::OUString const&, rtl::OUString const&, int, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) () at /usr/lib64/libreoffice/program/libcomphelper.so#21 0x00007ffff7933c22 in desktop::DispatchWatcher::executeDispatchRequests(std::vector<desktop::DispatchWatcher::DispatchRequest, std::allocator<desktop::DispatchWatcher::DispatchRequest> > const&, bool) () at /usr/lib64/libreoffice/program/libsofficeapp.so#22 0x00007ffff793ed60 in desktop::OfficeIPCThread::ExecuteCmdLineRequests(desktop::ProcessDocumentsRequest&) () at /usr/lib64/libreoffice/program/libsofficeapp.so#23 0x00007ffff791af78 in desktop::Desktop::OpenClients() () at /usr/lib64/libreoffice/program/libsofficeapp.so#24 0x00007ffff791c250 in desktop::Desktop::OpenClients_Impl(void*) () at /usr/lib64/libreoffice/program/libsofficeapp.so#25 0x00007ffff266e0eb in ImplWindowFrameProc(vcl::Window*, SalFrame*, unsigned short, void const*) () at /usr/lib64/libreoffice/program/libvcllo.so#26 0x00007ffff28d6df6 in SalGenericDisplay::DispatchInternalEvent() () at /usr/lib64/libreoffice/program/libvcllo.so#27 0x00007fffd934b2f9 in GtkData::userEventFn(void*) () at /usr/lib64/libreoffice/program/libvclplug_gtklo.so#28 0x00007fffd934b371 in call_userEventFn () at /usr/lib64/libreoffice/program/libvclplug_gtklo.so#29 0x00007fffeb5d1e3a in g_main_context_dispatch () at /lib64/libglib-2.0.so.0#30 0x00007fffeb5d21d0 in g_main_context_iterate.isra () at /lib64/libglib-2.0.so.0#31 0x00007fffeb5d227c in g_main_context_iteration () at /lib64/libglib-2.0.so.0#32 0x00007fffd934a7f7 in GtkData::Yield(bool, bool) () at /usr/lib64/libreoffice/program/libvclplug_gtklo.so#33 0x00007ffff28666e1 in Application::Yield() () at /usr/lib64/libreoffice/program/libvcllo.so#34 0x00007ffff2866775 in Application::Execute() () at /usr/lib64/libreoffice/program/libvcllo.so#35 0x00007ffff791d6eb in desktop::Desktop::Main() () at /usr/lib64/libreoffice/program/libsofficeapp.so#36 0x00007ffff286b731 in ImplSVMain() () at /usr/lib64/libreoffice/program/libvcllo.so#37 0x00007ffff286b782 in SVMain() () at /usr/lib64/libreoffice/program/libvcllo.so#38 0x00007ffff79430f2 in soffice_main () at /usr/lib64/libreoffice/program/libsofficeapp.so#39 0x000055555555483b in main ()Thread 9 (Thread 0x7fffd5be5700 (LWP 22513)):#0 0x00007ffff7329eb9 in pthread_cond_timedwait@@GLIBC_2.3.2 () at /lib64/libpthread.so.0#1 0x00007ffff7bae1be in osl_waitCondition () at /usr/lib64/libreoffice/program/libuno_sal.so.3#2 0x00007fffcd103e33 in framework::WakeUpThread::execute() () at /usr/lib64/libreoffice/program/../program/libfwklo.so#3 0x00007ffff4e23b26 in salhelper::Thread::run() () at /usr/lib64/libreoffice/program/libuno_salhelpergcc3.so.3#4 0x00007ffff4e23d2a in threadFunc () at /usr/lib64/libreoffice/program/libuno_salhelpergcc3.so.3#5 0x00007ffff7bbcd57 in osl_thread_start_Impl(void*) () at /usr/lib64/libreoffice/program/libuno_sal.so.3#6 0x00007ffff732460a in start_thread () at /lib64/libpthread.so.0#7 0x00007ffff763ca4d in clone () at /lib64/libc.so.6Thread 8 (Thread 0x7fffba5b2700 (LWP 22502)):#0 0x00007ffff7630fdd in poll () at /lib64/libc.so.6#1 0x00007fffd769d05c in x11::SelectionManager::dispatchEvent(int) () at /usr/lib64/libreoffice/program/libvclplug_genlo.so#2 0x00007fffd769d2fd in x11::SelectionManager::run(void*) () at /usr/lib64/libreoffice/program/libvclplug_genlo.so#3 0x00007ffff7bbcd57 in osl_thread_start_Impl(void*) () at /usr/lib64/libreoffice/program/libuno_sal.so.3#4 0x00007ffff732460a in start_thread () at /lib64/libpthread.so.0#5 0x00007ffff763ca4d in clone () at /lib64/libc.so.6Thread 7 (Thread 0x7fffbbfff700 (LWP 22499)):#0 0x00007ffff7630fdd in poll () at /lib64/libc.so.6#1 0x00007fffd7681665 in ICEConnectionWorker () at /usr/lib64/libreoffice/program/libvclplug_genlo.so#2 0x00007ffff7bbcd57 in osl_thread_start_Impl(void*) () at /usr/lib64/libreoffice/program/libuno_sal.so.3#3 0x00007ffff732460a in start_thread () at /lib64/libpthread.so.0#4 0x00007ffff763ca4d in clone () at /lib64/libc.so.6Thread 6 (Thread 0x7fffcdf62700 (LWP 22485)):#0 0x00007ffff7630fdd in poll () at /lib64/libc.so.6#1 0x00007fffeb5d216c in g_main_context_iterate.isra () at /lib64/libglib-2.0.so.0#2 0x00007fffeb5d24f2 in g_main_loop_run () at /lib64/libglib-2.0.so.0#3 0x00007fffebbf3336 in gdbus_shared_thread_func () at /lib64/libgio-2.0.so.0#4 0x00007fffeb5f8835 in g_thread_proxy () at /lib64/libglib-2.0.so.0#5 0x00007ffff732460a in start_thread () at /lib64/libpthread.so.0#6 0x00007ffff763ca4d in clone () at /lib64/libc.so.6Thread 5 (Thread 0x7fffce763700 (LWP 22484)):#0 0x00007ffff7630fdd in poll () at /lib64/libc.so.6...skipping...#7 0x00007ffff763ca4d in clone () at /lib64/libc.so.6Thread 8 (Thread 0x7fffba5b2700 (LWP 22886)):#0 0x00007ffff7630fdd in poll () at /lib64/libc.so.6#1 0x00007fffd769d05c in x11::SelectionManager::dispatchEvent(int) () at /usr/lib64/libreoffice/program/libvclplug_genlo.so#2 0x00007fffd769d2fd in x11::SelectionManager::run(void*) () at /usr/lib64/libreoffice/program/libvclplug_genlo.so#3 0x00007ffff7bbcd57 in osl_thread_start_Impl(void*) () at /usr/lib64/libreoffice/program/libuno_sal.so.3#4 0x00007ffff732460a in start_thread () at /lib64/libpthread.so.0#5 0x00007ffff763ca4d in clone () at /lib64/libc.so.6Thread 7 (Thread 0x7fffbbfff700 (LWP 22883)):#0 0x00007ffff7630fdd in poll () at /lib64/libc.so.6#1 0x00007fffd7681665 in ICEConnectionWorker () at /usr/lib64/libreoffice/program/libvclplug_genlo.so#2 0x00007ffff7bbcd57 in osl_thread_start_Impl(void*) () at /usr/lib64/libreoffice/program/libuno_sal.so.3#3 0x00007ffff732460a in start_thread () at /lib64/libpthread.so.0#4 0x00007ffff763ca4d in clone () at /lib64/libc.so.6Thread 6 (Thread 0x7fffcdf62700 (LWP 22870)):#0 0x00007ffff7630fdd in poll () at /lib64/libc.so.6#1 0x00007fffeb5d216c in g_main_context_iterate.isra () at /lib64/libglib-2.0.so.0#2 0x00007fffeb5d24f2 in g_main_loop_run () at /lib64/libglib-2.0.so.0#3 0x00007fffebbf3336 in gdbus_shared_thread_func () at /lib64/libgio-2.0.so.0#4 0x00007fffeb5f8835 in g_thread_proxy () at /lib64/libglib-2.0.so.0#5 0x00007ffff732460a in start_thread () at /lib64/libpthread.so.0#6 0x00007ffff763ca4d in clone () at /lib64/libc.so.6Thread 5 (Thread 0x7fffce763700 (LWP 22869)):#0 0x00007ffff7630fdd in poll () at /lib64/libc.so.6#1 0x00007fffeb5d216c in g_main_context_iterate.isra () at /lib64/libglib-2.0.so.0#2 0x00007fffeb5d227c in g_main_context_iteration () at /lib64/libglib-2.0.so.0#3 0x00007fffeb5d22b9 in glib_worker_main () at /lib64/libglib-2.0.so.0#4 0x00007fffeb5f8835 in g_thread_proxy () at /lib64/libglib-2.0.so.0#5 0x00007ffff732460a in start_thread () at /lib64/libpthread.so.0#6 0x00007ffff763ca4d in clone () at /lib64/libc.so.6Thread 4 (Thread 0x7fffd53e4700 (LWP 22866)):#0 0x00007ffff763d71d in accept () at /lib64/libc.so.6#1 0x00007ffff7bb4974 in osl_acceptPipe () at /usr/lib64/libreoffice/program/libuno_sal.so.3#2 0x00007ffff793fd05 in desktop::OfficeIPCThread::execute() () at /usr/lib64/libreoffice/program/libsofficeapp.so#3 0x00007ffff4e23b26 in salhelper::Thread::run() () at /usr/lib64/libreoffice/program/libuno_salhelpergcc3.so.3#4 0x00007ffff4e23d2a in threadFunc () at /usr/lib64/libreoffice/program/libuno_salhelpergcc3.so.3#5 0x00007ffff7bbcd57 in osl_thread_start_Impl(void*) () at /usr/lib64/libreoffice/program/libuno_sal.so.3#6 0x00007ffff732460a in start_thread () at /lib64/libpthread.so.0#7 0x00007ffff763ca4d in clone () at /lib64/libc.so.6Thread 2 (Thread 0x7fffe090c700 (LWP 22859)):#0 0x00007ffff7329eb9 in pthread_cond_timedwait@@GLIBC_2.3.2 () at /lib64/libpthread.so.0#1 0x00007ffff7b96bfb in rtl_cache_wsupdate_all(void*) () at /usr/lib64/libreoffice/program/libuno_sal.so.3#2 0x00007ffff732460a in start_thread () at /lib64/libpthread.so.0#3 0x00007ffff763ca4d in clone () at /lib64/libc.so.6Thread 1 (Thread 0x7ffff7f06a40 (LWP 22841)):#0 0x00007fffb2739dae in writerfilter::dmapper::DomainMapper_Impl::finishParagraph(std::shared_ptr<writerfilter::dmapper::PropertyMap>) () at /usr/lib64/libreoffice/program/../program/libwriterfilterlo.so#1 0x00007fffb26f9e37 in writerfilter::dmapper::DomainMapper::lcl_utext(unsigned char const*, unsigned long) () at /usr/lib64/libreoffice/program/../program/libwriterfilterlo.so#2 0x00007fffb27d16ca in writerfilter::ooxml::OOXMLFastContextHandler::endOfParagraph() () at /usr/lib64/libreoffice/program/../program/libwriterfilterlo.so#3 0x00007fffb27cf43d in writerfilter::ooxml::OOXMLFactory::endAction(writerfilter::ooxml::OOXMLFastContextHandler*, int) () at /usr/lib64/libreoffice/program/../program/libwriterfilterlo.so#4 0x00007fffbab1bd50 in (anonymous namespace)::Entity::endElement() () at /usr/lib64/libreoffice/program/../program/libexpwraplo.so#5 0x00007fffee67ce13 in xmlParseEndTag2 () at /lib64/libxml2.so.2#6 0x00007fffee68299f in xmlParseTryOrFinish () at /lib64/libxml2.so.2#7 0x00007fffee6844bb in xmlParseChunk () at /lib64/libxml2.so.2#8 0x00007fffbab1dc45 in sax_fastparser::FastSaxParserImpl::parse() () at /usr/lib64/libreoffice/program/../program/libexpwraplo.so#9 0x00007fffbab21265 in sax_fastparser::FastSaxParserImpl::parseStream(com::sun::star::xml::sax::InputSource const&) () at /usr/lib64/libreoffice/program/../program/libexpwraplo.so#10 0x00007fffb27cd3f4 in writerfilter::ooxml::OOXMLDocumentImpl::resolve(writerfilter::Stream&) () at /usr/lib64/libreoffice/program/../program/libwriterfilterlo.so#11 0x00007fffb27bfa6c in WriterFilter::filter(com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) () at /usr/lib64/libreoffice/program/../program/libwriterfilterlo.so#12 0x00007ffff467c471 in SfxObjectShell::ImportFrom(SfxMedium&, com::sun::star::uno::Reference<com::sun::star::text::XTextRange> const&) () at /usr/lib64/libreoffice/program/libsfxlo.so#13 0x00007ffff46814ce in SfxObjectShell::DoLoad(SfxMedium*) () at /usr/lib64/libreoffice/program/libsfxlo.so#14 0x00007ffff46b474f in SfxBaseModel::load(com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) () at /usr/lib64/libreoffice/program/libsfxlo.so#15 0x00007ffff473d26f in (anonymous namespace)::SfxFrameLoader_Impl::load(com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&, com::sun::star::uno::Reference<com::sun::star::frame::XFrame> const&) () at /usr/lib64/libreoffice/program/libsfxlo.so#16 0x00007fffcd150b6b in framework::LoadEnv::impl_loadContent() () at /usr/lib64/libreoffice/program/../program/libfwklo.so#17 0x00007fffcd151878 in framework::LoadEnv::startLoading() () at /usr/lib64/libreoffice/program/../program/libfwklo.so#18 0x00007fffcd0e372d in framework::LoadDispatcher::impl_dispatch(com::sun::star::util::URL const&, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&, com::sun::star::uno::Reference<com::sun::star::frame::XDispatchResultListener> const&) () at /usr/lib64/libreoffice/program/../program/libfwklo.so#19 0x00007fffcd0e4568 in framework::LoadDispatcher::dispatchWithReturnValue(com::sun::star::util::URL const&, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) () at /usr/lib64/libreoffice/program/../program/libfwklo.so#20 0x00007ffff5a7654d in comphelper::SynchronousDispatch::dispatch(com::sun::star::uno::Reference<com::sun::star::uno::XInterface> const&, rtl::OUString const&, rtl::OUString const&, int, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) () at /usr/lib64/libreoffice/program/libcomphelper.so#21 0x00007ffff7933c22 in desktop::DispatchWatcher::executeDispatchRequests(std::vector<desktop::DispatchWatcher::DispatchRequest, std::allocator<desktop::DispatchWatcher::DispatchRequest> > const&, bool) () at /usr/lib64/libreoffice/program/libsofficeapp.so#22 0x00007ffff793ed60 in desktop::OfficeIPCThread::ExecuteCmdLineRequests(desktop::ProcessDocumentsRequest&) () at /usr/lib64/libreoffice/program/libsofficeapp.so#23 0x00007ffff791af78 in desktop::Desktop::OpenClients() () at /usr/lib64/libreoffice/program/libsofficeapp.so#24 0x00007ffff791c250 in desktop::Desktop::OpenClients_Impl(void*) () at /usr/lib64/libreoffice/program/libsofficeapp.so#25 0x00007ffff266e0eb in ImplWindowFrameProc(vcl::Window*, SalFrame*, unsigned short, void const*) () at /usr/lib64/libreoffice/program/libvcllo.so#26 0x00007ffff28d6df6 in SalGenericDisplay::DispatchInternalEvent() () at /usr/lib64/libreoffice/program/libvcllo.so#27 0x00007fffd934b2f9 in GtkData::userEventFn(void*) () at /usr/lib64/libreoffice/program/libvclplug_gtklo.so#28 0x00007fffd934b371 in call_userEventFn () at /usr/lib64/libreoffice/program/libvclplug_gtklo.so#29 0x00007fffeb5d1e3a in g_main_context_dispatch () at /lib64/libglib-2.0.so.0#30 0x00007fffeb5d21d0 in g_main_context_iterate.isra () at /lib64/libglib-2.0.so.0#31 0x00007fffeb5d227c in g_main_context_iteration () at /lib64/libglib-2.0.so.0#32 0x00007fffd934a7f7 in GtkData::Yield(bool, bool) () at /usr/lib64/libreoffice/program/libvclplug_gtklo.so#33 0x00007ffff28666e1 in Application::Yield() () at /usr/lib64/libreoffice/program/libvcllo.so#34 0x00007ffff2866775 in Application::Execute() () at /usr/lib64/libreoffice/program/libvcllo.so#35 0x00007ffff791d6eb in desktop::Desktop::Main() () at /usr/lib64/libreoffice/program/libsofficeapp.so#36 0x00007ffff286b731 in ImplSVMain() () at /usr/lib64/libreoffice/program/libvcllo.so#37 0x00007ffff286b782 in SVMain() () at /usr/lib64/libreoffice/program/libvcllo.so#38 0x00007ffff79430f2 in soffice_main () at /usr/lib64/libreoffice/program/libsofficeapp.so#39 0x000055555555483b in main ()A debugging session is active. Inferior 1 [process 22841] will be killed.Quit anyway? (y or n) [answered Y; input not from terminal]...skipping...#7 0x00007ffff763ca4d in clone () at /lib64/libc.so.6Thread 8 (Thread 0x7fffba5b2700 (LWP 22886)):#0 0x00007ffff7630fdd in poll () at /lib64/libc.so.6#1 0x00007fffd769d05c in x11::SelectionManager::dispatchEvent(int) () at /usr/lib64/libreoffice/program/libvclplug_genlo.so#2 0x00007fffd769d2fd in x11::SelectionManager::run(void*) () at /usr/lib64/libreoffice/program/libvclplug_genlo.so#3 0x00007ffff7bbcd57 in osl_thread_start_Impl(void*) () at /usr/lib64/libreoffice/program/libuno_sal.so.3#4 0x00007ffff732460a in start_thread () at /lib64/libpthread.so.0#5 0x00007ffff763ca4d in clone () at /lib64/libc.so.6Thread 7 (Thread 0x7fffbbfff700 (LWP 22883)):#0 0x00007ffff7630fdd in poll () at /lib64/libc.so.6#1 0x00007fffd7681665 in ICEConnectionWorker () at /usr/lib64/libreoffice/program/libvclplug_genlo.so#2 0x00007ffff7bbcd57 in osl_thread_start_Impl(void*) () at /usr/lib64/libreoffice/program/libuno_sal.so.3#3 0x00007ffff732460a in start_thread () at /lib64/libpthread.so.0#4 0x00007ffff763ca4d in clone () at /lib64/libc.so.6Thread 6 (Thread 0x7fffcdf62700 (LWP 22870)):#0 0x00007ffff7630fdd in poll () at /lib64/libc.so.6#1 0x00007fffeb5d216c in g_main_context_iterate.isra () at /lib64/libglib-2.0.so.0#2 0x00007fffeb5d24f2 in g_main_loop_run () at /lib64/libglib-2.0.so.0#3 0x00007fffebbf3336 in gdbus_shared_thread_func () at /lib64/libgio-2.0.so.0#4 0x00007fffeb5f8835 in g_thread_proxy () at /lib64/libglib-2.0.so.0#5 0x00007ffff732460a in start_thread () at /lib64/libpthread.so.0#6 0x00007ffff763ca4d in clone () at /lib64/libc.so.6Thread 5 (Thread 0x7fffce763700 (LWP 22869)):#0 0x00007ffff7630fdd in poll () at /lib64/libc.so.6#1 0x00007fffeb5d216c in g_main_context_iterate.isra () at /lib64/libglib-2.0.so.0#2 0x00007fffeb5d227c in g_main_context_iteration () at /lib64/libglib-2.0.so.0#3 0x00007fffeb5d22b9 in glib_worker_main () at /lib64/libglib-2.0.so.0#4 0x00007fffeb5f8835 in g_thread_proxy () at /lib64/libglib-2.0.so.0#5 0x00007ffff732460a in start_thread () at /lib64/libpthread.so.0#6 0x00007ffff763ca4d in clone () at /lib64/libc.so.6Thread 4 (Thread 0x7fffd53e4700 (LWP 22866)):#0 0x00007ffff763d71d in accept () at /lib64/libc.so.6#1 0x00007ffff7bb4974 in osl_acceptPipe () at /usr/lib64/libreoffice/program/libuno_sal.so.3#2 0x00007ffff793fd05 in desktop::OfficeIPCThread::execute() () at /usr/lib64/libreoffice/program/libsofficeapp.so#3 0x00007ffff4e23b26 in salhelper::Thread::run() () at /usr/lib64/libreoffice/program/libuno_salhelpergcc3.so.3#4 0x00007ffff4e23d2a in threadFunc () at /usr/lib64/libreoffice/program/libuno_salhelpergcc3.so.3#5 0x00007ffff7bbcd57 in osl_thread_start_Impl(void*) () at /usr/lib64/libreoffice/program/libuno_sal.so.3#6 0x00007ffff732460a in start_thread () at /lib64/libpthread.so.0#7 0x00007ffff763ca4d in clone () at /lib64/libc.so.6Thread 2 (Thread 0x7fffe090c700 (LWP 22859)):#0 0x00007ffff7329eb9 in pthread_cond_timedwait@@GLIBC_2.3.2 () at /lib64/libpthread.so.0#1 0x00007ffff7b96bfb in rtl_cache_wsupdate_all(void*) () at /usr/lib64/libreoffice/program/libuno_sal.so.3#2 0x00007ffff732460a in start_thread () at /lib64/libpthread.so.0#3 0x00007ffff763ca4d in clone () at /lib64/libc.so.6Thread 1 (Thread 0x7ffff7f06a40 (LWP 22841)):#0 0x00007fffb2739dae in writerfilter::dmapper::DomainMapper_Impl::finishParagraph(std::shared_ptr<writerfilter::dmapper::PropertyMap>) () at /usr/lib64/libreoffice/program/../program/libwriterfilterlo.so#1 0x00007fffb26f9e37 in writerfilter::dmapper::DomainMapper::lcl_utext(unsigned char const*, unsigned long) () at /usr/lib64/libreoffice/program/../program/libwriterfilterlo.so#2 0x00007fffb27d16ca in writerfilter::ooxml::OOXMLFastContextHandler::endOfParagraph() () at /usr/lib64/libreoffice/program/../program/libwriterfilterlo.so#3 0x00007fffb27cf43d in writerfilter::ooxml::OOXMLFactory::endAction(writerfilter::ooxml::OOXMLFastContextHandler*, int) () at /usr/lib64/libreoffice/program/../program/libwriterfilterlo.so#4 0x00007fffbab1bd50 in (anonymous namespace)::Entity::endElement() () at /usr/lib64/libreoffice/program/../program/libexpwraplo.so#5 0x00007fffee67ce13 in xmlParseEndTag2 () at /lib64/libxml2.so.2#6 0x00007fffee68299f in xmlParseTryOrFinish () at /lib64/libxml2.so.2#7 0x00007fffee6844bb in xmlParseChunk () at /lib64/libxml2.so.2#8 0x00007fffbab1dc45 in sax_fastparser::FastSaxParserImpl::parse() () at /usr/lib64/libreoffice/program/../program/libexpwraplo.so#9 0x00007fffbab21265 in sax_fastparser::FastSaxParserImpl::parseStream(com::sun::star::xml::sax::InputSource const&) () at /usr/lib64/libreoffice/program/../program/libexpwraplo.so#10 0x00007fffb27cd3f4 in writerfilter::ooxml::OOXMLDocumentImpl::resolve(writerfilter::Stream&) () at /usr/lib64/libreoffice/program/../program/libwriterfilterlo.so#11 0x00007fffb27bfa6c in WriterFilter::filter(com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) () at /usr/lib64/libreoffice/program/../program/libwriterfilterlo.so#12 0x00007ffff467c471 in SfxObjectShell::ImportFrom(SfxMedium&, com::sun::star::uno::Reference<com::sun::star::text::XTextRange> const&) () at /usr/lib64/libreoffice/program/libsfxlo.so#13 0x00007ffff46814ce in SfxObjectShell::DoLoad(SfxMedium*) () at /usr/lib64/libreoffice/program/libsfxlo.so#14 0x00007ffff46b474f in SfxBaseModel::load(com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) () at /usr/lib64/libreoffice/program/libsfxlo.so#15 0x00007ffff473d26f in (anonymous namespace)::SfxFrameLoader_Impl::load(com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&, com::sun::star::uno::Reference<com::sun::star::frame::XFrame> const&) () at /usr/lib64/libreoffice/program/libsfxlo.so#16 0x00007fffcd150b6b in framework::LoadEnv::impl_loadContent() () at /usr/lib64/libreoffice/program/../program/libfwklo.so#17 0x00007fffcd151878 in framework::LoadEnv::startLoading() () at /usr/lib64/libreoffice/program/../program/libfwklo.so#18 0x00007fffcd0e372d in framework::LoadDispatcher::impl_dispatch(com::sun::star::util::URL const&, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&, com::sun::star::uno::Reference<com::sun::star::frame::XDispatchResultListener> const&) () at /usr/lib64/libreoffice/program/../program/libfwklo.so#19 0x00007fffcd0e4568 in framework::LoadDispatcher::dispatchWithReturnValue(com::sun::star::util::URL const&, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) () at /usr/lib64/libreoffice/program/../program/libfwklo.so#20 0x00007ffff5a7654d in comphelper::SynchronousDispatch::dispatch(com::sun::star::uno::Reference<com::sun::star::uno::XInterface> const&, rtl::OUString const&, rtl::OUString const&, int, com::sun::star::uno::Sequence<com::sun::star::beans::PropertyValue> const&) () at /usr/lib64/libreoffice/program/libcomphelper.so#21 0x00007ffff7933c22 in desktop::DispatchWatcher::executeDispatchRequests(std::vector<desktop::DispatchWatcher::DispatchRequest, std::allocator<desktop::DispatchWatcher::DispatchRequest> > const&, bool) () at /usr/lib64/libreoffice/program/libsofficeapp.so#22 0x00007ffff793ed60 in desktop::OfficeIPCThread::ExecuteCmdLineRequests(desktop::ProcessDocumentsRequest&) () at /usr/lib64/libreoffice/program/libsofficeapp.so#23 0x00007ffff791af78 in desktop::Desktop::OpenClients() () at /usr/lib64/libreoffice/program/libsofficeapp.so#24 0x00007ffff791c250 in desktop::Desktop::OpenClients_Impl(void*) () at /usr/lib64/libreoffice/program/libsofficeapp.so#25 0x00007ffff266e0eb in ImplWindowFrameProc(vcl::Window*, SalFrame*, unsigned short, void const*) () at /usr/lib64/libreoffice/program/libvcllo.so#26 0x00007ffff28d6df6 in SalGenericDisplay::DispatchInternalEvent() () at /usr/lib64/libreoffice/program/libvcllo.so#27 0x00007fffd934b2f9 in GtkData::userEventFn(void*) () at /usr/lib64/libreoffice/program/libvclplug_gtklo.so#28 0x00007fffd934b371 in call_userEventFn () at /usr/lib64/libreoffice/program/libvclplug_gtklo.so#29 0x00007fffeb5d1e3a in g_main_context_dispatch () at /lib64/libglib-2.0.so.0#30 0x00007fffeb5d21d0 in g_main_context_iterate.isra () at /lib64/libglib-2.0.so.0#31 0x00007fffeb5d227c in g_main_context_iteration () at /lib64/libglib-2.0.so.0#32 0x00007fffd934a7f7 in GtkData::Yield(bool, bool) () at /usr/lib64/libreoffice/program/libvclplug_gtklo.so#33 0x00007ffff28666e1 in Application::Yield() () at /usr/lib64/libreoffice/program/libvcllo.so#34 0x00007ffff2866775 in Application::Execute() () at /usr/lib64/libreoffice/program/libvcllo.so#35 0x00007ffff791d6eb in desktop::Desktop::Main() () at /usr/lib64/libreoffice/program/libsofficeapp.so#36 0x00007ffff286b731 in ImplSVMain() () at /usr/lib64/libreoffice/program/libvcllo.so#37 0x00007ffff286b782 in SVMain() () at /usr/lib64/libreoffice/program/libvcllo.so#38 0x00007ffff79430f2 in soffice_main () at /usr/lib64/libreoffice/program/libsofficeapp.so#39 0x000055555555483b in main ()A debugging session is active. Inferior 1 [process 22841] will be killed.Quit anyway? (y or n) [answered Y; input not from terminal]</snip> Createdgdbtrace.log as attachment, without additional line breaksI also attached the gdbtrace.log output here as an attachment, might be easier to read than the inline paste, given the line breaks that added.Open in Win10x64 with:Versión: 5.0.6.2 (x64)Id. de compilación: b3fbfa99158a1030fb79f0ba72b6851afc3c7895-GLConfiguración regional: es-ES (es_ES)Version: 5.1.6.1 (x64)Build ID: f3e25ec0581f5012f54d8810dcddd5824f4ee374CPU Threads: 1; OS Version: Windows 6.19; UI Render: default; Locale: es-ES (es_ES); Calc: CLVersion: 5.2.2.2 (x64)Build ID: 8f96e87c890bf8fa77463cd4b640a2312823f3adCPU Threads: 1; OS Version: Windows 6.19; UI Render: GL; Locale: es-ES (es_ES); Calc: CLCrash with:Version: 5.3.0.0.alpha0+Build ID: ed5ca17dce1d088ce3fbbb3a30f748ba92cd07d9CPU Threads: 4; OS Version: Windows 6.19; UI Render: default; TinderBox: Win-x86@42, Branch:master, Time: 2016-10-09_05:40:51Locale: es-ES (es_ES); Calc: CLRepro crash.Arch Linux 64-bitLibreOffice 3.3.0 OOO330m19 (Build:6)tag libreoffice-3.3.0.4Arch Linux 64-bit, KDE Plasma 5Version: 5.3.0.0.alpha0+Build ID: ff2a399b61f34f7920e594e8cbb6c19045b24956CPU Threads: 8; OS Version: Linux 4.7; UI Render: default; Locale: fi-FI (fi_FI.UTF-8); Calc: groupBuilt on October 7th 2016Unconfirmed with v3.3.4 under windows 7 x64.Unconfirmed with v5.1.5.2 under windows 7 x64.Unconfirmed with v5.2.2.2 under windows 10 x64.Loads just fine on these configs, might crash on others.On Windows 8.1, it loads the document in 3.6.7, 4.2.8, 5.2.1 but its missing around 8 pages and with master the loading document progress bar would sit at 95% and wont go any further. On Linux it crashes when loading.Createdsample docx without footnotesSo i decided to play with the xml and deleted /word/footnotes.xml and remove all the <w:footnoteReference> tags from /word/document.xml and the document opened fine with all its pages on linux, so hopefully that narrows it down.Re-tested with v5.2.2.2 under ubuntu 16.04 x64. Indeed the crash doesn't exists anymore w/o footnotes.Createdconsole bt logsOn pc Debian x86-64 with master sources updated today, I could reproduce this.I attached a bt with symbols (+ console logs)The first question on these "filepen MS/OOXML file" should be the source and file history. This docx has 366 errors on OpenXML validation. Surely, LO shouldn't crash and bug is valid. crashreport.libreoffice.org/stats/crash_details/69dbc810-65ae-48ad-a8e4-4476da4910b4Other similar crashes:Caolán McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: tdf#103063 don't crash on importing this fileIt will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Verified inVersion: 5.4.0.0.alpha0+Build ID: 4b3e8de6b3cb971b02aa0cb90aceb9e104071d3bCPU Threads: 4; OS Version: Linux 4.8; UI Render: default; VCL: gtk2; Locale: ca-ES (ca_ES.UTF-8); Calc: groupSAXParseException is the same as inHi Caolán,Can it be backported to 5.3?Caolánwrote "doesn't go on to successfully open the docx, but it doesn't crash" which if fine for me because "we don't know this file source and history and it has 366 errors on OpenXML validation."But, there's sth. I don't understand: after "file format error message", why is there "loading document..." in status bar, until we open some other file?Verified inVersion: 5.4.0.0.alpha0+Build ID: fc53cce64400430cdc21f79c959d75fb9a26d13dCPU Threads: 4; OS Version: Linux 4.8; UI Render: default; VCL: gtk2; Locale: ca-ES (ca_ES.UTF-8); Calc: group
id=103178	Steps to reproduce:1. Open a document containing a Chart ( ie.)2. Select a Chart, press F2 and add some text3. Click outside the chart4. Select the same chart again, press F2 and try to add some text -> No text is added at this point ( this is a bug too, but it's probably related )5. Close the document ( either saving or not )Observed behaviour: Calc crashesExpected behaviour: Calc doesn't crashReproduced in Version: 5.3.0.0.alpha0+Build ID: ae94c223e2e21e42fc7feca72402b910e5eab5c7CPU Threads: 4; OS Version: Linux 4.2; UI Render: default; Locale: ca-ES (ca_ES.UTF-8); Calc: groupbut not in Version: 5.0.0.0.alpha1+Build ID: 0db96caf0fcce09b87621c11b584a6d81cc7df86Locale: ca-ES (ca_ES.UTF-8)thus, adding regression Regression introduced in rangeRepro.Createdbt with symbolsOn pc Debian x86-64 with master sources updated yesterday, I could reproduce this.CreatedValgrind trace@raal, one for you?Regression introduced by:author Maxim Monastirsky <> 2016-02-01 16:39:51 (GMT)committer Maxim Monastirsky <> 2016-02-02 09:32:36 (GMT)commit 11d605cc5a0c221d2423b6e63f502db660d085d2 (patch)tree 018a88d0fe4e56ec0c69a40596227cb70dfdf847parent 8b65dec8e0fdfc8564597e90aff91b971e23f7ce (diff)tdf#84843 Stop using PseudoSlots for drawing slotsInstead of fighting with this obsolete thing, let'sjust kill it. This fixes disabling in read-only doc,as well as pressed/unpressed states.Adding Cc: to Maxim MonastirskyReproducible with Version: 5.3.0.0.alpha1Build ID: f4ca1573fcf445164c068c1046ab5d084e1b005fCPU Threads: 8; OS Version: Windows 6.2; UI Render: default; Locale: es-MX (es_MX); Calc: groupIn Windows 10 and Windows XP SP3Even without adding text, just selecting the chart and then clicking back in the spreadsheet, moving the mouse pointer or trying to save the file crashes the application.This is the Chart cash reportcrashreportThanks for reporting. I'll take a look.Maxim Monastirsky committed a patch related to this issue.It has been pushed to "master":tdf#103178 Final SID can differ from the original oneIt will be available in 5.3.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.for 5-2With master sources updated today (928776b734c6aa188151bbce048d5bef4486dce7), I don't reproduce this indeed.Thank you Maxim!Maxim Monastirsky committed a patch related to this issue.It has been pushed to "libreoffice-5-2":tdf#103178 Final SID can differ from the original oneIt will be available in 5.2.4.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=103393	Version: 5.3.0.0.alpha1 (x64)Build ID: f4ca1573fcf445164c068c1046ab5d084e1b005fCPU Threads: 8; OS Version: Windows 6.1; UI Render: default; Locale: en-AU (en_AU); Calc: groupWith the new "Table Styles" sidebar, any attempt to modify a table style crashes LO.Steps to reproduce:1. Insert a table (any size) into a Writer page.2. In the "Styles & Formatting" sidebar select the new "Table Styles" tab.3. Apply any of the available styles to the table.4. Right click on the applied style and select "Modify" from the context menu.5. LO will crash with: LibreOfficeDev 5.3 - Fatal Errorfile:///C:/Program%20Files/LibreOfficeDev%205/program/../share/config/soffice.cfg/modules/swriter/ui/templatedialog32.ui Repro.Backtrace failed:/home/user/libreoffice/instdir/program/gdbtrace:9: Error in sourced command file:No stack.Arch Linux 64-bit, KDE Plasma 5Version: 5.3.0.0.alpha0+Build ID: 3498ed37527b7af795f00dc6a55c11e65a313186CPU Threads: 8; OS Version: Linux 4.7; UI Render: default; Locale: fi-FI (fi_FI.UTF-8); Calc: groupBuilt on October 18th 2016*** This bug has been marked as a duplicate of***
id=103236	Description:When I select a slide transition that my system does not support (maybe because of low OPENGL version?) like Honeycomb, Impress crashes. It would be nice if Libreoffice filtered out of the list every effect that is not supported in Slide Transition or Custom Animation. Or just maybe when clicking the effect, display a message "Effect is not supported in your system".Steps to Reproduce:1. Select a slide transition that my system does not supportActual Results: Impress crashesExpected Results:Impress should just deny applying the effect with a message or filter it out of the list previously.Reproducible: AlwaysUser Profile Reset: YesAdditional Info:Windows 7 SP1 (32bit and 64bit systems)Various OPENGL versionsUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0 5.0 branch is EOL. Could you give a try to last stable LO version 5.2.2?(In reply to Julien Nabet from)Yes, it still happens with 5.2.2The systems with Windows 7 SP1 that crash Impress are in a lab which I don't access right now. But I did a fresh install of LO v5.2.2 in a laptop with XP SP3 and it shows the same behavior.The slide transitions that work are:Wipe, Wheel, Uncover, Random Bars, Checkers, Shape, Box, Wedge, Venetian, Cut, Cover, Dissolve, Random, Comb, Push, Split, Diagonal.The slide transitions that DON'T work and immediately crash Impress upon clicking on them are:Fade, Tiles, Cube, Circles, Helix, Fall, Turn Around, Iris, Turn Down, Rochade, 3D Venetian, Static, Fine Dissolve, Vortex, Ripple, Glitter, Honeycomb, Newsflash.OpenGL Extensions Viewer 3.0 reports for my system with XP SP3:Renderer: Intel 915GMVendor: IntelMemory: 128 MBVersion: 1.4.0 - Build 4.14.10.3984Shading language version: N/AMax texture size: 2048 x 2048Max texture coordinates: 8Max vertex texture image units: 0Max texture image units: 16Max geometry texture units: 0Max anisotropic filtering value: 4Max number of light sources: 16Max viewport size: 2048 x 2048Max uniform vertex components: 0Max uniform fragment components: 0Max geometry uniform components: 0Max varying floats: 0Max samples: 0Max draw buffers: 0Extensions: 51GL_3DFX_texture_compression_FXT1GL_ARB_depth_textureGL_ARB_fragment_programGL_ARB_multitextureGL_ARB_point_parametersGL_ARB_shadowGL_ARB_texture_border_clampGL_ARB_texture_compressionGL_ARB_texture_cube_mapGL_ARB_texture_env_addGL_ARB_texture_env_combineGL_ARB_texture_env_crossbarGL_ARB_texture_env_dot3GL_ARB_transpose_matrixGL_ARB_vertex_programGL_ARB_window_posGL_EXT_abgrGL_EXT_bgraGL_EXT_blend_colorGL_EXT_blend_func_separateGL_EXT_blend_minmaxGL_EXT_blend_subtractGL_EXT_clip_volume_hintGL_EXT_compiled_vertex_arrayGL_EXT_cull_vertexGL_EXT_draw_range_elementsGL_EXT_fog_coordGL_EXT_multi_draw_arraysGL_EXT_packed_pixelsGL_EXT_rescale_normalGL_EXT_secondary_colorGL_EXT_separate_specular_colorGL_EXT_shadow_funcsGL_EXT_stencil_two_sideGL_EXT_stencil_wrapGL_EXT_texture3DGL_EXT_texture_compression_s3tcGL_EXT_texture_env_addGL_EXT_texture_env_combineGL_EXT_texture_filter_anisotropicGL_IBM_texture_mirrored_repeatGL_NV_blend_squareGL_NV_texgen_reflectionGL_SGIS_generate_mipmapGL_WIN_swap_hintWGL_ARB_buffer_regionWGL_ARB_extensions_stringWGL_ARB_make_current_readWGL_ARB_pbufferWGL_ARB_pixel_formatWGL_EXT_swap_controlCore featuresv1.1 (100 % - 7/7)v1.2 (100 % - 8/8)v1.3 (100 % - 9/9)v1.4 (100 % - 15/15)v1.5 (33 % - 1/3)v2.0 (10 % - 1/10)v2.1 (0 % - 0/3)v3.0 (0 % - 0/23)v3.1 (0 % - 0/8)v3.2 (0 % - 0/9)v3.3 (0 % - 0/9)v4.0 (0 % - 0/13)v4.1 (0 % - 0/7)OpenGL driver version check (Current: 6.14.10.3984, Latest known: 6.14.10.3943):Latest version of display drivers foundAccording the database, you are running the latest display drivers for your video card.Compiled vertex array supportThis feature improves OpenGL performance by using video memory to cache transformed vertices.Multitexture supportThis feature accelerates complex rendering such as lightmaps or environment mapping.Secondary color supportThis feature provides an alternate method of coloring specular highlights on polygons.S3TC compression supportThis feature improves texture mapping performance in some applications by using lossy compression.No texture edge clamp supportThis feature adds clamping control to edge texel filtering. Some programs may not render textures correctly (black line on borders.)Vertex program supportThis feature enables a wide variety of effects via flexible vertex programming (equivalent to DX8 Vertex Shader.)Fragment program supportThis feature enables a wide variety of effects via per pixel programming (equivalent to DX9 Pixel Shader.)Texture anisotropic filtering supportThis feature improves the quality of texture mapping on oblique surfaces.No OpenGL Shading Language supportThis may break compatibility for applications using per pixel shading.No Frame buffer object supportThis may break compatibility for applications using render to texture functions.Extension verification: GL_ARB_debug_output was not found, but has the entry point glGetPointerv GL_ARB_imaging was not found, but has the entry point glBlendEquation WGL_EXT_extensions_string was not found, but has the entry point wglGetExtensionsStringEXT GL_ARB_vertex_buffer_object was not found, but is available in driver version 1.4.0 - Build 4.14.10.4020Thank you for your feedback. I put back version back because this field corresponds to the oldest LO version where the bug can be encountered.billy78: in your lab with Win7 if you install LO 5.2.2, it should be ok thanks toIndeed, this patch blacklist Intel drivers for Windows 7.Michael: should we blacklist Intel drivers for XP too?Julien, I think that I *did* try 5.2.2 and also crashed in my lab. However, since now I'm not really sure for the earliest version that the probleam appeared, on Monday I'll do a completely fresh install of LO 5.0.0, 5.1.0, 5.2.0 and 5.2.2 in my lab and also report opengl data.(In reply to billy78 from)Ok, think about renaming your LO directory profile (seehttps://wiki.documentfoundation.org/UserProfile#Windows) so it'll force LO to check Windows config during its next launch.Certainly - for anything < Windows 10 - the -Intel- drivers appear un-enumbered by things like thread-safety, testing, reliability.A patch to the XML to implement that much appreciated ! =)Then again - I could swear that GL should not be enabled on Windows XP at all - if it is that worries me generally, we should disable it there completely I think.Thanks.(In reply to Michael Meeks from)I agreeIndeed, I just noticed this: 47 <entry os="xp" vendor="all"> 48 <device id="all"/>So at least on XP, OpenGL should be disabled.(see)Would there be some bug on blacklist management?Billy: just to be sure, Force OpenGL option isn't checked, is it?Julien, Force OpenGL is not checked. Only "Use hardware acceleration" and "Use anti-aliasing" are checked, but these make no difference if I uncheck them too.I've done some tests with portable LO versions on my XP SP3 and I suspect that tomorrow I'll experience the same results for Win7:v5.0.0 does not crash (complex transitions just don't do anything)v5.1.0 and v5.1.5 do not crash (complex transitions just don't do anything)v5.2.0, v5.2.1 and v5.2.2 crash with the transitions that I have mentioned.I will change the earliest LO version affected to 5.2.0 (release, since I don't know about beta and RC) and I'll post the results with Win7 tomorrow.***has been marked as a duplicate of this bug. ***Here's my comment from the other bug report:"Reproduced with v5.2.1.2 / Windows 7.Filing crash report wasn't offered, and WinDbg backtrace was useless, the only result of the analysis was that the application had exited.This is the content of opengl_device.log:DriverVersion: 2.7.1.6DriverDate: 6-18-2010DeviceID: PCI\VEN_102B&DEV_2539&SUBSYS_0040102B&REV_01AdapterVendorID: 0x102bAdapterDeviceID: 0x2539AdapterSubsysID: 0x0040102bDeviceKey: System\CurrentControlSet\Control\Video\{CC00E15A-1A8D-4171-B4B3-930DEB562651}\0000DeviceString: Matrox Millennium P690 PCIe x16"I have just finished my tests in a Win7 SP1 32-bit laptop.Transitions work up to v5.2.0 beta1 (alpha1 and beta1). From beta2 and above (beta2 and all RCs) transitions crash.OpenGL Viewer reports:Renderer: Mobile Intel(R) 4 Series Express Chipset FamilyVendor: IntelMemory: 0 MBVersion: 2.1.0 - Build 8.15.10.2057Shading language version: 1.20 - Intel Build 8.15.10.2057Max texture size: 4096 x 4096Max texture coordinates: 0Max vertex texture image units: 16Max texture image units: 16Max geometry texture units: 0Max anisotropic filtering value: 2Max number of light sources: 16Max viewport size: 4096 x 4096Max uniform vertex components: 512Max uniform fragment components: 1024Max geometry uniform components: 0Max varying floats: 41Max samples: 0Max draw buffers: 7Extensions: 77GL_3DFX_texture_compression_FXT1GL_ARB_color_buffer_floatGL_ARB_depth_textureGL_ARB_draw_buffersGL_ARB_draw_instancedGL_ARB_fragment_programGL_ARB_fragment_shaderGL_ARB_half_float_pixelGL_ARB_multitextureGL_ARB_occlusion_queryGL_ARB_pixel_buffer_objectGL_ARB_point_parametersGL_ARB_point_spriteGL_ARB_shader_objectsGL_ARB_shading_language_100GL_ARB_shadowGL_ARB_texture_border_clampGL_ARB_texture_compressionGL_ARB_texture_cube_mapGL_ARB_texture_env_addGL_ARB_texture_env_combineGL_ARB_texture_env_crossbarGL_ARB_texture_env_dot3GL_ARB_texture_floatGL_ARB_texture_non_power_of_twoGL_ARB_texture_rectangleGL_ARB_transpose_matrixGL_ARB_vertex_buffer_objectGL_ARB_vertex_programGL_ARB_vertex_shaderGL_ARB_window_posGL_ATI_separate_stencilGL_EXT_abgrGL_EXT_bgraGL_EXT_blend_colorGL_EXT_blend_equation_separateGL_EXT_blend_func_separateGL_EXT_blend_minmaxGL_EXT_blend_subtractGL_EXT_clip_volume_hintGL_EXT_compiled_vertex_arrayGL_EXT_draw_range_elementsGL_EXT_fog_coordGL_EXT_framebuffer_objectGL_EXT_multi_draw_arraysGL_EXT_packed_pixelsGL_EXT_rescale_normalGL_EXT_secondary_colorGL_EXT_separate_specular_colorGL_EXT_shadow_funcsGL_EXT_stencil_two_sideGL_EXT_stencil_wrapGL_EXT_texture3DGL_EXT_texture_compression_s3tcGL_EXT_texture_env_addGL_EXT_texture_env_combineGL_EXT_texture_filter_anisotropicGL_EXT_texture_lod_biasGL_EXT_texture_rectangleGL_EXT_texture_sRGBGL_EXT_texture_swizzleGL_IBM_texture_mirrored_repeatGL_NV_blend_squareGL_NV_conditional_renderGL_NV_texgen_reflectionGL_SGIS_generate_mipmapGL_SGIS_texture_edge_clampGL_SGIS_texture_lodGL_WIN_swap_hintWGL_ARB_buffer_regionWGL_ARB_extensions_stringWGL_ARB_make_current_readWGL_ARB_pbufferWGL_ARB_pixel_formatWGL_ARB_pixel_format_floatWGL_EXT_extensions_stringWGL_EXT_swap_controlCore featuresv1.1 (100 % - 7/7)v1.2 (100 % - 8/8)v1.3 (100 % - 9/9)v1.4 (100 % - 15/15)v1.5 (100 % - 3/3)v2.0 (100 % - 10/10)v2.1 (100 % - 3/3)v3.0 (21 % - 5/23)v3.1 (25 % - 2/8)v3.2 (0 % - 0/10)v3.3 (0 % - 0/10)v4.0 (0 % - 0/14)v4.1 (0 % - 0/7)v4.2 (0 % - 0/13)v4.3 (0 % - 0/23)v4.4 (0 % - 0/10)v4.5 (0 % - 0/11)vARB 2015 (0 % - 0/13)vARB 2016 (0 % - 0/1)OpenGL driver version check (Current: 2.1.0 - Build 8.15.10.2057, Latest known: 2.1.0 - Build 8.15.10.1808):Latest version of display drivers foundAccording the database, you are running the latest display drivers for your video card.No ICD registry entryThe current OpenGL driver doesn't expose the SOFTWARE/Microsoft/Windows (NT)/CurrentVersion/OpenGLDrivers registry entry. Unable to detect the driver version, driver revision name and filename.Multitexture supportThis feature accelerates complex rendering such as lightmaps or environment mapping.Secondary color supportThis feature provides an alternate method of coloring specular highlights on polygons.S3TC compression supportThis feature improves texture mapping performance in some applications by using lossy compression.Texture edge clamp supportThis feature improves texturing quality by adding clamping control to edge texel filtering.Vertex program supportThis feature enables a wide variety of effects via flexible vertex programming (equivalent to DX8 Vertex Shader.)Fragment program supportThis feature enables a wide variety of effects via per pixel programming (equivalent to DX9 Pixel Shader.)Texture anisotropic filtering supportThis feature improves the quality of texture mapping on oblique surfaces.Occlusion test supportThis feature provides hardware accelerated culling for objects.Point sprite supportThis feature improves performance in some particle systems.OpenGL Shading Language supportThis feature enables high level shading language for shaders.Frame buffer object supportThis feature enables render to texture functionality.Extension verification: GL_ARB_color_buffer_float has the entry point glClampColorARB missing!GL_ARB_draw_buffers has the entry point glDrawBuffersARB missing!GL_ARB_multitexture has the entry point glActiveTextureARB missing!GL_ARB_multitexture has the entry point glClientActiveTextureARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord1dARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord1dvARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord1fARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord1fvARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord1iARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord1ivARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord1sARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord1svARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord2dARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord2dvARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord2fARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord2fvARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord2iARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord2ivARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord2sARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord2svARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord3dARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord3dvARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord3fARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord3fvARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord3iARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord3ivARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord3sARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord3svARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord4dARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord4dvARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord4fARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord4fvARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord4iARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord4ivARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord4sARB missing!GL_ARB_multitexture has the entry point glMultiTexCoord4svARB missing!GL_ARB_occlusion_query has the entry point glBeginQueryARB missing!GL_ARB_occlusion_query has the entry point glDeleteQueriesARB missing!GL_ARB_occlusion_query has the entry point glEndQueryARB missing!GL_ARB_occlusion_query has the entry point glGenQueriesARB missing!GL_ARB_occlusion_query has the entry point glGetQueryObjectivARB missing!GL_ARB_occlusion_query has the entry point glGetQueryObjectuivARB missing!GL_ARB_occlusion_query has the entry point glGetQueryivARB missing!GL_ARB_occlusion_query has the entry point glIsQueryARB missing!GL_ARB_point_parameters has the entry point glPointParameterfARB missing!GL_ARB_point_parameters has the entry point glPointParameterfvARB missing!GL_ARB_shader_objects has the entry point glAttachObjectARB missing!GL_ARB_shader_objects has the entry point glCompileShaderARB missing!GL_ARB_shader_objects has the entry point glCreateProgramObjectARB missing!GL_ARB_shader_objects has the entry point glCreateShaderObjectARB missing!GL_ARB_shader_objects has the entry point glDeleteObjectARB missing!GL_ARB_shader_objects has the entry point glDetachObjectARB missing!GL_ARB_shader_objects has the entry point glGetActiveUniformARB missing!GL_ARB_shader_objects has the entry point glGetAttachedObjectsARB missing!GL_ARB_shader_objects has the entry point glGetHandleARB missing!GL_ARB_shader_objects has the entry point glGetInfoLogARB missing!GL_ARB_shader_objects has the entry point glGetObjectParameterfvARB missing!GL_ARB_shader_objects has the entry point glGetObjectParameterivARB missing!GL_ARB_shader_objects has the entry point glGetShaderSourceARB missing!GL_ARB_shader_objects has the entry point glGetUniformLocationARB missing!GL_ARB_shader_objects has the entry point glGetUniformfvARB missing!GL_ARB_shader_objects has the entry point glGetUniformivARB missing!GL_ARB_shader_objects has the entry point glLinkProgramARB missing!GL_ARB_shader_objects has the entry point glShaderSourceARB missing!GL_ARB_shader_objects has the entry point glUniform1fARB missing!GL_ARB_shader_objects has the entry point glUniform1fvARB missing!GL_ARB_shader_objects has the entry point glUniform1iARB missing!GL_ARB_shader_objects has the entry point glUniform1ivARB missing!GL_ARB_shader_objects has the entry point glUniform2fARB missing!GL_ARB_shader_objects has the entry point glUniform2fvARB missing!GL_ARB_shader_objects has the entry point glUniform2iARB missing!GL_ARB_shader_objects has the entry point glUniform2ivARB missing!GL_ARB_shader_objects has the entry point glUniform3fARB missing!GL_ARB_shader_objects has the entry point glUniform3fvARB missing!GL_ARB_shader_objects has the entry point glUniform3iARB missing!GL_ARB_shader_objects has the entry point glUniform3ivARB missing!GL_ARB_shader_objects has the entry point glUniform4fARB missing!GL_ARB_shader_objects has the entry point glUniform4fvARB missing!GL_ARB_shader_objects has the entry point glUniform4iARB missing!GL_ARB_shader_objects has the entry point glUniform4ivARB missing!GL_ARB_shader_objects has the entry point glUniformMatrix2fvARB missing!GL_ARB_shader_objects has the entry point glUniformMatrix3fvARB missing!GL_ARB_shader_objects has the entry point glUniformMatrix4fvARB missing!GL_ARB_shader_objects has the entry point glUseProgramObjectARB missing!GL_ARB_shader_objects has the entry point glValidateProgramARB missing!GL_ARB_texture_compression has the entry point glCompressedTexImage1DARB missing!GL_ARB_texture_compression has the entry point glCompressedTexImage2DARB missing!GL_ARB_texture_compression has the entry point glCompressedTexImage3DARB missing!GL_ARB_texture_compression has the entry point glCompressedTexSubImage1DARB missing!GL_ARB_texture_compression has the entry point glCompressedTexSubImage2DARB missing!GL_ARB_texture_compression has the entry point glCompressedTexSubImage3DARB missing!GL_ARB_texture_compression has the entry point glGetCompressedTexImageARB missing!GL_ARB_transpose_matrix has the entry point glLoadTransposeMatrixdARB missing!GL_ARB_transpose_matrix has the entry point glLoadTransposeMatrixfARB missing!GL_ARB_transpose_matrix has the entry point glMultTransposeMatrixdARB missing!GL_ARB_transpose_matrix has the entry point glMultTransposeMatrixfARB missing!GL_ARB_vertex_buffer_object has the entry point glBindBufferARB missing!GL_ARB_vertex_buffer_object has the entry point glBufferDataARB missing!GL_ARB_vertex_buffer_object has the entry point glBufferSubDataARB missing!GL_ARB_vertex_buffer_object has the entry point glDeleteBuffersARB missing!GL_ARB_vertex_buffer_object has the entry point glGenBuffersARB missing!GL_ARB_vertex_buffer_object has the entry point glGetBufferParameterivARB missing!GL_ARB_vertex_buffer_object has the entry point glGetBufferPointervARB missing!GL_ARB_vertex_buffer_object has the entry point glGetBufferSubDataARB missing!GL_ARB_vertex_buffer_object has the entry point glIsBufferARB missing!GL_ARB_vertex_buffer_object has the entry point glMapBufferARB missing!GL_ARB_vertex_buffer_object has the entry point glUnmapBufferARB missing!GL_ARB_vertex_program has the entry point glBindProgramARB missing!GL_ARB_vertex_program has the entry point glDeleteProgramsARB missing!GL_ARB_vertex_program has the entry point glDisableVertexAttribArrayARB missing!GL_ARB_vertex_program has the entry point glEnableVertexAttribArrayARB missing!GL_ARB_vertex_program has the entry point glGenProgramsARB missing!GL_ARB_vertex_program has the entry point glGetProgramEnvParameterdvARB missing!GL_ARB_vertex_program has the entry point glGetProgramEnvParameterfvARB missing!GL_ARB_vertex_program has the entry point glGetProgramLocalParameterdvARB missing!GL_ARB_vertex_program has the entry point glGetProgramLocalParameterfvARB missing!GL_ARB_vertex_program has the entry point glGetProgramStringARB missing!GL_ARB_vertex_program has the entry point glGetProgramivARB missing!GL_ARB_vertex_program has the entry point glGetVertexAttribPointervARB missing!GL_ARB_vertex_program has the entry point glGetVertexAttribdvARB missing!GL_ARB_vertex_program has the entry point glGetVertexAttribfvARB missing!GL_ARB_vertex_program has the entry point glGetVertexAttribivARB missing!GL_ARB_vertex_program has the entry point glIsProgramARB missing!GL_ARB_vertex_program has the entry point glProgramEnvParameter4dARB missing!GL_ARB_vertex_program has the entry point glProgramEnvParameter4dvARB missing!GL_ARB_vertex_program has the entry point glProgramEnvParameter4fARB missing!GL_ARB_vertex_program has the entry point glProgramEnvParameter4fvARB missing!GL_ARB_vertex_program has the entry point glProgramLocalParameter4dARB missing!GL_ARB_vertex_program has the entry point glProgramLocalParameter4dvARB missing!GL_ARB_vertex_program has the entry point glProgramLocalParameter4fARB missing!GL_ARB_vertex_program has the entry point glProgramLocalParameter4fvARB missing!GL_ARB_vertex_program has the entry point glProgramStringARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib1dARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib1dvARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib1fARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib1fvARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib1sARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib1svARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib2dARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib2dvARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib2fARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib2fvARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib2sARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib2svARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib3dARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib3dvARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib3fARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib3fvARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib3sARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib3svARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib4NbvARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib4NivARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib4NsvARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib4NubARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib4NubvARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib4NuivARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib4NusvARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib4bvARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib4dARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib4dvARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib4fARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib4fvARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib4ivARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib4sARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib4svARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib4ubvARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib4uivARB missing!GL_ARB_vertex_program has the entry point glVertexAttrib4usvARB missing!GL_ARB_vertex_program has the entry point glVertexAttribPointerARB missing!GL_ARB_vertex_shader has the entry point glBindAttribLocationARB missing!GL_ARB_vertex_shader has the entry point glGetActiveAttribARB missing!GL_ARB_vertex_shader has the entry point glGetAttribLocationARB missing!GL_ARB_window_pos has the entry point glWindowPos2dARB missing!GL_ARB_window_pos has the entry point glWindowPos2dvARB missing!GL_ARB_window_pos has the entry point glWindowPos2fARB missing!GL_ARB_window_pos has the entry point glWindowPos2fvARB missing!GL_ARB_window_pos has the entry point glWindowPos2iARB missing!GL_ARB_window_pos has the entry point glWindowPos2ivARB missing!GL_ARB_window_pos has the entry point glWindowPos2sARB missing!GL_ARB_window_pos has the entry point glWindowPos2svARB missing!GL_ARB_window_pos has the entry point glWindowPos3dARB missing!GL_ARB_window_pos has the entry point glWindowPos3dvARB missing!GL_ARB_window_pos has the entry point glWindowPos3fARB missing!GL_ARB_window_pos has the entry point glWindowPos3fvARB missing!GL_ARB_window_pos has the entry point glWindowPos3iARB missing!GL_ARB_window_pos has the entry point glWindowPos3ivARB missing!GL_ARB_window_pos has the entry point glWindowPos3sARB missing!GL_ARB_window_pos has the entry point glWindowPos3svARB missing!GL_ATI_separate_stencil has the entry point glStencilFuncSeparateATI missing!GL_ATI_separate_stencil has the entry point glStencilOpSeparateATI missing!GL_EXT_blend_color has the entry point glBlendColorEXT missing!GL_EXT_blend_equation_separate has the entry point glBlendEquationSeparateEXT missing!GL_EXT_blend_func_separate has the entry point glBlendFuncSeparateEXT missing!GL_EXT_blend_minmax has the entry point glBlendEquationEXT missing!GL_EXT_color_subtable was not found, but has the entry point glColorSubTableEXT GL_EXT_compiled_vertex_array has the entry point glLockArraysEXT missing!GL_EXT_compiled_vertex_array has the entry point glUnlockArraysEXT missing!GL_EXT_draw_range_elements has the entry point glDrawRangeElementsEXT missing!GL_EXT_fog_coord has the entry point glFogCoordPointerEXT missing!GL_EXT_fog_coord has the entry point glFogCoorddEXT missing!GL_EXT_fog_coord has the entry point glFogCoorddvEXT missing!GL_EXT_fog_coord has the entry point glFogCoordfEXT missing!GL_EXT_fog_coord has the entry point glFogCoordfvEXT missing!GL_EXT_framebuffer_object has the entry point glBindFramebufferEXT missing!GL_EXT_framebuffer_object has the entry point glBindRenderbufferEXT missing!GL_EXT_framebuffer_object has the entry point glCheckFramebufferStatusEXT missing!GL_EXT_framebuffer_object has the entry point glDeleteFramebuffersEXT missing!GL_EXT_framebuffer_object has the entry point glDeleteRenderbuffersEXT missing!GL_EXT_framebuffer_object has the entry point glFramebufferRenderbufferEXT missing!GL_EXT_framebuffer_object has the entry point glFramebufferTexture1DEXT missing!GL_EXT_framebuffer_object has the entry point glFramebufferTexture2DEXT missing!GL_EXT_framebuffer_object has the entry point glFramebufferTexture3DEXT missing!GL_EXT_framebuffer_object has the entry point glGenFramebuffersEXT missing!GL_EXT_framebuffer_object has the entry point glGenRenderbuffersEXT missing!GL_EXT_framebuffer_object has the entry point glGenerateMipmapEXT missing!GL_EXT_framebuffer_object has the entry point glGetFramebufferAttachmentParameterivEXT missing!GL_EXT_framebuffer_object has the entry point glGetRenderbufferParameterivEXT missing!GL_EXT_framebuffer_object has the entry point glIsFramebufferEXT missing!GL_EXT_framebuffer_object has the entry point glIsRenderbufferEXT missing!GL_EXT_framebuffer_object has the entry point glRenderbufferStorageEXT missing!GL_EXT_multi_draw_arrays has the entry point glMultiDrawArraysEXT missing!GL_EXT_multi_draw_arrays has the entry point glMultiDrawElementsEXT missing!GL_EXT_paletted_texture was not found, but has the entry point glColorTableEXT GL_EXT_paletted_texture was not found, but has the entry point glGetColorTableEXT GL_EXT_paletted_texture was not found, but has the entry point glGetColorTableParameterfvEXT GL_EXT_paletted_texture was not found, but has the entry point glGetColorTableParameterivEXT GL_EXT_secondary_color has the entry point glSecondaryColor3bEXT missing!GL_EXT_secondary_color has the entry point glSecondaryColor3bvEXT missing!GL_EXT_secondary_color has the entry point glSecondaryColor3dEXT missing!GL_EXT_secondary_color has the entry point glSecondaryColor3dvEXT missing!GL_EXT_secondary_color has the entry point glSecondaryColor3fEXT missing!GL_EXT_secondary_color has the entry point glSecondaryColor3fvEXT missing!GL_EXT_secondary_color has the entry point glSecondaryColor3iEXT missing!GL_EXT_secondary_color has the entry point glSecondaryColor3ivEXT missing!GL_EXT_secondary_color has the entry point glSecondaryColor3sEXT missing!GL_EXT_secondary_color has the entry point glSecondaryColor3svEXT missing!GL_EXT_secondary_color has the entry point glSecondaryColor3ubEXT missing!GL_EXT_secondary_color has the entry point glSecondaryColor3ubvEXT missing!GL_EXT_secondary_color has the entry point glSecondaryColor3uiEXT missing!GL_EXT_secondary_color has the entry point glSecondaryColor3uivEXT missing!GL_EXT_secondary_color has the entry point glSecondaryColor3usEXT missing!GL_EXT_secondary_color has the entry point glSecondaryColor3usvEXT missing!GL_EXT_secondary_color has the entry point glSecondaryColorPointerEXT missing!GL_EXT_stencil_two_side has the entry point glActiveStencilFaceEXT missing!GL_EXT_texture3D has the entry point glTexImage3DEXT missing!GL_NV_conditional_render has the entry point glBeginConditionalRenderNV missing!GL_NV_conditional_render has the entry point glEndConditionalRenderNV missing!WGL_ARB_buffer_region has the entry point wglCreateBufferRegionARB missing!WGL_ARB_buffer_region has the entry point wglDeleteBufferRegionARB missing!WGL_ARB_buffer_region has the entry point wglRestoreBufferRegionARB missing!WGL_ARB_buffer_region has the entry point wglSaveBufferRegionARB missing!WGL_ARB_buffer_region has been added to the extensions list of Mobile Intel(R) 4 Series Express Chipset Family WGL_ARB_extensions_string has the entry point wglGetExtensionsStringARB missing!WGL_ARB_extensions_string has been added to the extensions list of Mobile Intel(R) 4 Series Express Chipset Family WGL_ARB_make_current_read has the entry point wglGetCurrentReadDCARB missing!WGL_ARB_make_current_read has the entry point wglMakeContextCurrentARB missing!WGL_ARB_make_current_read has been added to the extensions list of Mobile Intel(R) 4 Series Express Chipset Family WGL_ARB_pbuffer has the entry point wglCreatePbufferARB missing!WGL_ARB_pbuffer has the entry point wglDestroyPbufferARB missing!WGL_ARB_pbuffer has the entry point wglGetPbufferDCARB missing!WGL_ARB_pbuffer has the entry point wglQueryPbufferARB missing!WGL_ARB_pbuffer has the entry point wglReleasePbufferDCARB missing!WGL_ARB_pbuffer has been added to the extensions list of Mobile Intel(R) 4 Series Express Chipset Family WGL_ARB_pixel_format has the entry point wglChoosePixelFormatARB missing!WGL_ARB_pixel_format has the entry point wglGetPixelFormatAttribfvARB missing!WGL_ARB_pixel_format has the entry point wglGetPixelFormatAttribivARB missing!WGL_ARB_pixel_format has been added to the extensions list of Mobile Intel(R) 4 Series Express Chipset Family WGL_ARB_pixel_format_float has been added to the extensions list of Mobile Intel(R) 4 Series Express Chipset Family WGL_EXT_extensions_string has the entry point wglGetExtensionsStringEXT missing!WGL_EXT_extensions_string has been added to the extensions list of Mobile Intel(R) 4 Series Express Chipset Family WGL_EXT_swap_control has the entry point wglGetSwapIntervalEXT missing!WGL_EXT_swap_control has the entry point wglSwapIntervalEXT missing!WGL_EXT_swap_control has been added to the extensions list of Mobile Intel(R) 4 Series Express Chipset Family GL_ARB_depth_buffer_float was not found, but is available in driver version 2.1.0 - Build 6.14.10.5237 GL_ARB_framebuffer_object was not found, but is available in driver version 2.1.0 - Build 6.14.10.5237 GL_ARB_framebuffer_sRGB was not found, but is available in driver version 2.1.0 - Build 6.14.10.5237 GL_ARB_half_float_vertex was not found, but is available in driver version 2.1.0 - Build 6.14.10.5237 GL_ARB_texture_compression_rgtc was not found, but is available in driver version 2.1.0 - Build 6.14.10.5237 GL_ARB_texture_rg was not found, but is available in driver version 2.1.0 - Build 6.14.10.5237 GL_ARB_vertex_array_object was not found, but is available in driver version 2.1.0 - Build 6.14.10.5237 GL_EXT_draw_buffers2 was not found, but is available in driver version 2.1.0 - Build 6.14.10.5237 GL_EXT_framebuffer_blit was not found, but is available in driver version 2.1.0 - Build 6.14.10.5237 GL_EXT_packed_depth_stencil was not found, but is available in driver version 2.1.0 - Build 6.14.10.5237 GL_EXT_packed_float was not found, but is available in driver version 2.1.0 - Build 6.14.10.5237 GL_EXT_texture_edge_clamp was not found, but is available in driver version 2.1.0 - Build 6.14.10.5237 GL_EXT_texture_shared_exponent was not found, but is available in driver version 2.1.0 - Build 6.14.10.5237 GL_EXT_transform_feedback was not found, but is available in driver version 2.1.0 - Build 6.14.10.5237I'm sorry for the previous long post, I don't know how to edit it :-(BTW, when I'm saying that transitions work up to v5.2.0 beta1, I mean that they don't make Impress crash. They actually do nothing during preview.CreatedODP with Fade on the 2nd slideI too have Impress crashing LO upon custom slide transition. Test file attached above. OpenGL disabled.However I recall not having this problem with 5.0 seriesI first encountered it on 5.1.5 (Still!)Then upon upgrading to the latest release 5.2.2, the same happens.I too have Impress crashing LO upon custom slide transition. Test file attached above. OpenGL disabled.However I recall not having this problem with 5.0 seriesI first encountered it on 5.1.5 (Still!)Then upon upgrading to the latest release 5.2.2, the same happens.Windows 7 + Intel GL is known to be a horror gallery. We should black-list that, the problem I guess is that we need to disable GL for presentations as well - separately somehow.Probably - we should disable Impress GL transitions for actively black-listed hardware/os/version combinations - that would solve this bug, rather than over-complicating things.Patches most welcome.(In reply to Michael Meeks from)That's one way to solve it, but I've also seen those fancy transitions working perfectly on my computer (Win7). It seems when some patch is made to fix a bug for another OS, things go down on this one: either some custom animation effects don't work properly (like popping in when "Fly In" is chosen), or crashing.Btw, I recall now that 5.0.6 was ok for me.I don't know why I set 5.0.0.5 as earliest version... adjusting to beta 2 based on Billy78's triage in. Thanks!***has been marked as a duplicate of this bug. ***(In reply to Aron Budea from)That saves me (and probably many others) the confusion. :-)I'm still puzzled by "that is not supported (maybe because of low OPENGL version)". I can't see how OpenGL got "lowered" on 5.2. If this is unrelated, I suggest removing this part.Are you mixing up OpenGL with OpenCL?(In reply to Kumāra from)I don't have any knowledge about Impress transitions and I thought that the crashes occurred due to not high enough OpenGL version in my system. I have no idea what OpenCL is and how it is related. If you think that this part should be removed from the title, please do so :-)(In reply to billy78 from)Thanks for clarifying, Billy.I asked because you wrote: "Various OPENGL versions". What do you mean?Another thing: What do you mean by "They actually do nothing during preview." in?I'd like to make the Summary clearer, but before that please confirm this: You have "Automatic Preview" enabled?(In reply to Kumāra from)Actually, this report was set to 5.0.0.5 originally.Also, it seems to vary based on GPU capabilities, since the system I reproduced this with () crashes with 5.1.0.3, but not with 5.0.0.5.GLView reports 1.3 for the card.(In reply to Kumāra from)I have "Automatic Preview" enabled. Clicking in a non-crashing transition, makes the grey background around the slide to go black for a second (like a transition for the slide is being displayed, but actually there is no effect, the contents appear in their place) and then the slide becomes active again. No visible effect is being applied to the slide. During slideshow, no transition is being applied, the slides appear like they have no transition.The matter is probably explained here:Hello,experiencing the same on all Windows computers I tried (all Win 7). On Linux this works without issues.I can confirm with 5.2.2 and 5.2.3 is broken on Win, GL is reported to be disabled. (side note: if I force-enable it, LO enters endless crash-restart loop during startup...).Graphics card is Intel on both Win and Linux.Also, this bug seems to me to be related to.(In reply to Martin Sourada from)<snip>Are the the same type/model?Unfort(In reply to Kumāra from)Unfortunately not. I don't have win on my linux machine (notebook) and linux on the windows machines (desktops) and my CentOS can't seem to be able to produce bootable liveusb... :/FWIW, the Linux machine reports its card as:00:02.0 VGA compatible controller: Intel Corporation Haswell-ULT Integrated Graphics Controller (rev 0b)The Windows one as:Intel G41 Express ChipsetAnd another Windows machine (also crashing) has:ATI Radeon HD 4550***has been marked as a duplicate of this bug. ***Ndarbant, please don't hijack an existing bug report for your different issue, open a new one instead.This was a bit tricky, as it already crashed with the oldest commit in repo bibisect-win32-5.1, but not for the same reason (that was some VclPtr fallout that got fixed for the first 5.0 release, 5.0.0.5). A reverse bibisect first identified the fixing commit (90e901b3f92b3c537aaf0dab83de2a9b073e761f,), and the second bibisect starting from that commit identified the real offending commit, referenced below.I used my hw setup fromfor bibisecting this crash.Adding Cc: to Emmanuel Gil Peyrot, and also adding Cc: to Tomaž Vajngerl, please take a look.author Emmanuel Gil Peyrot <> 2015-12-09 21:39:31 (GMT)committer Tomaž Vajngerl <> 2015-12-12 08:31:51 (GMT)"opengl: Add Geometry Shader support to OpenGLHelper"Note: if anyone else does not get the crash starting from major release 5.1.0.3 (billy78?), only from 5.2.0.4, that is likely a separate issue, and needs to be traced down separately.(In reply to Aron Budea from)In my previous tests, I got the crash from 5.2.0 beta2, not from earlier versions.(In reply to billy78 from)Ok, actually, they are very likely related, since they affect the same slide transitions, and as I found there were a bunch of commits affecting those. However, if you could do a bibisect to identify the particular commit that broke this on your system, that would provide additional details to the dev picking up this bug report, and would be appreciated.For bibisecting this particular bug, you need Cygwin, bibisect-win32-5.2 git repository from [1] (6 GB), and to take the steps described there (about 15 mins of work).[1]Btw, I linked the commit from 5.1 branch in my previous comment, the same change in the master branch is:(In reply to Aron Budea from)I just want to comment that I greatly appreciate your work on this. Thank you very much! Mmmuah!Noticed this in last week's ESC minutes (17-01-26) regarding the bug:"+ ongoing investigation; Win XP + OGL [!] ..."Note that this bug definitely affects Windows 7 (no experience with other versions).***has been marked as a duplicate of this bug. ***Did anything change in 5.3? I did a clean install of 5.3.0.3 (first stable release of 5.3) and all transitions don't crash Impress now! The newer transition just don't do anything, but at least they don't crash the application! Can anyone else confirm this?I'm still getting a crash with the mentioned transitions using a 5.4 daily build from 2017-01-29.(In reply to Aron Budea from)5.2.5.1 : crash5.3.0.3 : no crash: nocrash(In reply to billy78 from)Since we started getting the (otherwise very similar) crash at different versions, it could be that the cause affecting your system has been resolved, but the one affecting my system is still there. Nevertheless, it's good to hear the crash is gone for you.
id=103719	Cannot connect to distant database MySQL : crash.Cannot test JDBC Connection : crashLibreOffice : 5.1.6.2Mac OS X 10.12.1 (latest version)Java SDK 1.8.0_112 (latest version) @PJG51 : please provide more detail, at present there isn't enough to work with.1) Which version of the JDBC connector ?2) How precisely are you connecting over JDBC via the connector, in other words which setup did you choose when you created the ODB file - there are 2 possibilities, and both are not necessarily equal.3) What kind of network connection are you using ? internal LAN, internet remote host, etc ?4) Any particular table structure we should be aware of ? (MEMO fields, BLOBs, etc) ?Setting to NEEDINFO pending requested information, please set back to UNCONFIRMED once you have provided all of the above informationWhich version of the JDBC connector ?Java SDK 1.8.0_112 (latest version)MysqlConnector java 5.1.40 (latest version)How precisely are you connecting over JDBC via the connector, in other words which setup did you choose when you created the ODB file - there are 2 possibilities, and both are not necessarily equal.It's a MySql Database created before the update with wich I worked before without problem.What kind of network connection are you using ? internal LAN, internet remote host, etc ?A standard distant base on my server or lacal base with MAMP, it's the same thing.Any particular table structure we should be aware of ? (MEMO fields, BLOBs, etc) ?No one.Would it be possible you retrieve some debug information? (see)and attach information with this link?Would it be possible you retrieve some debug information?No debug information.LO quits with a message : … unexpected error… etc… following files will be recovered… but there is no file !And LO starts again.No repro withVersion: 5.2.1.2Build ID: 31dd62db80d4e60af04904455ec9c9219178d620Threads CPU : 2; Version de l'OS :Mac OS X 10.12; UI Render : par défaut; Locale : fr-FR (fr_FR.UTF-8); Calc: groupusing MySQL Connector/J 5.1.39 to a LAN mysql instance.@PJG51 : what I meant with type of JDBC connection is what is the connection type you see displayed in the bottom left hand corner of the main database window when you open the file ?@PJG51 : In my setup, I'm using the specific MySQL JDBC setup code provided by LO. This displays as MySQL(JDBC) in the bottom left hand corner of the main Base window.I am using JDK 1.8.0_102So, I set up a normal (i.e. default JDBC choice via the wizard) JDBC connection with the following configuration strings :jdbc: mysql://xxx.xxx.xxx.xxx/mydatabase?zeroDateTimeBehavior=convertToNullwhere xxx.xxx.xxx.xxx is an IPV4 address on my LAN using the default mysql 3306 portand driver class :com.mysql.jdbc.Driverand this works fine too, no crashes, in LibreOfficeVersion: 5.2.1.2Build ID: 31dd62db80d4e60af04904455ec9c9219178d620Threads CPU : 2; Version de l'OS :Mac OS X 10.12; UI Render : par défaut; Locale : fr-FR (fr_FR.UTF-8); Calc: groupThe zeroDateTimeBehaviour property is just to avoid error messages when opening tables with mysql zero dates, it doesn't make a difference to whether or not I can open my tables.Updated my JDK installation to JDK 1.8.0_112, no crashes when loading ODB file or opening tables once the ODB is loaded.@PJG51 : there must be something more specific that is causing the crash. Without a sample table and sample data (DML/DDL statements or SQL dump) or other salient details with which to reproduce the crash, we won't be able to move forward much with this report.OK, so just tested against 5162 downloaded today, and I can reproduce the crash.This is clearly a regression, and shouldn't have happened in a version that is supposed to be "stable".CONFIRMINGThe crash occurs irrespective of the JDBC connection type. I could reproduce both with a simple JDBC connection, and a MySQL(JDBC) connection.OK, so running LO 5162 in lld, I see this when the authentication dialog is filled in and I click on OK to send authentication data :libc++abi.dylib: terminating with unexpected exception of type jfw_plugin::MalformedVersionExceptionProcess 2170 stopped* thread #1: tid = 0x1394e5f, 0x00007fff925d2dda libsystem_kernel.dylib`__pthread_kill + 10, queue = 'com.apple.main-thread', stop reason = signal SIGABRT frame #0: 0x00007fff925d2dda libsystem_kernel.dylib`__pthread_kill + 10libsystem_kernel.dylib`__pthread_kill:-> 0x7fff925d2dda <+10>: jae 0x7fff925d2de4 ; <+20> 0x7fff925d2ddc <+12>: movq %rax, %rdi 0x7fff925d2ddf <+15>: jmp 0x7fff925cbd6f ; cerror_nocancel 0x7fff925d2de4 <+20>: retq (lldb) The malformed version exception smells like a Java version recognition error - sigh. Has this silly bug raised its head again ? I thought this had been fixed for the 5.1.x branch by Caolan ?@Stephan : more jfw woes, it appears.Createdfull btAlex: I think 5.1 is EOL indeed, I don't think there'll be an LO 5.1.7.If I well understood, there's no reproduction of this pb in 5.2 branch.Should it be WFM with target 5.2.2 ?Tested against Version: 5.1.5.2Build ID: 7a864d8825610a8c07cfc3bc01dd4fce6a9447e5Threads CPU : 2; Version de l'OS :Mac OS X 10.12; UI Render : par défaut; Locale : fr-FR (fr_FR.UTF-8); Calc: groupNo crash.(In reply to Julien Nabet from)Hi Julien,Indeed, no crashing in 5.2.1.2 (although I haven't tested 5.2.3 yet). Even if I understand that 5.1.x is going to be EOL, I really hate how we can release a "bug fix release" for an EOL branch that introduces a regression like this - it really reflects poorly on the way we do things, especially as we encourage people to upgrade to latest bug fixed release.5.2.x is at the moment classed as "Fresh", whereas 5.1.x is "Still", and I quote from the relevant web site page "LibreOffice Still is the stable version that has undergone more testing (over a longer time)." This kind of marketing speak clearly creates a mismatch between user expectations and the reality of developing our code base.(In reply to Alex Thurgood from)Looks like <> "" was only backported to libreoffice-5-1-5, but not to libreoffice-5-1, so the fix disappeared again from LO 5.1.6. (And follow-up <> "Related: tdf#101057 inherit MalformedVersionException from std::exception" appears to not have been backported to any libreoffice-5-1*.Thanks Stephan. So an unfortunate happenstance indeed.@PJG51 : sorry to say, but your only alternative currently is to either downgrade to 5.1.5.2, or to switch to 5.2.x.No crashes with Version: 5.2.3.3Build ID: d54a8868f08a7b39642414cf2c8ef2f228f780cfCPU Threads: 2; OS Version: Mac OS X 10.12; UI Render: default; Locale: fr-FR (fr_FR.UTF-8); Calc: groupClosing as WFM because 5.1.x will be EOL in less than a month and as Julien has mentioned, I doubt that there will be any further releases in the 5.1.x line before end of November 2016 (at least, I don't see any programmed as such in the release plan).Last tries…I connected again JDK 1.8.0_91 and it works well, with LO 5.1.6.2 and Sierra 10.12.1.Strange, isn't it ?With JDK 1.8.0_112 all version of LO from 5.1.3.x to 5.1.6.2 crashes attempting to connect to com.mysql.jdbc.Driver.PJG(In reply to PJG51 from)No, given that the underlying issue is about Java runtime versions with a three digit "update number" ("_112") and that one has a two-digit one ("_91").The theory is that LO 5.1.5 should work (or else there's maybe yet another issue that's causing a crash for you with LO 5.1.5).***has been marked as a duplicate of this bug. ***
id=104083	Description:Create a new ODB (embedded hsqldb) file using the DB wizard.When attempting to save the file, LO Base crashes.Console output indicates that the file flags are causing mdworker to crash.Steps to Reproduce:1. Create a new ODB file using DB wizard. No need to add tables.2. Attempt to save the new file to local disk space.Actual Results: LO Base hangs indefinitely. Forced kill is required to remove process.The mdworker process SIGBARTs when trying to analyze the file. As this uses the Spotlight code from LO, LO appears to hang as a result.Expected Results:The file should be saved without causing the LO process to hang. The mdworker process should not die when calling the LO Spotlight importer code.Reproducible: AlwaysUser Profile Reset: NoAdditional Info:User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:49.0) Gecko/20100101 Firefox/49.0 CreatedConsole traceI can confirm LO Base hangs indefinitely. Forced kill is required to remove process.The mdworker process didn't SIGBART, this time. But I have seen it happen, if I remember correctly.Version: 5.3.0.0.alpha1+Build ID: 6984fd5a756f1e01e94da14f01df5a0e20791630CPU Threads: 4; OS Version: Mac OS X 10.12.1; UI Render: default; Layout Engine: new; TinderBox: MacOSX-x86_64@49-TDF, Branch:master, Time: 2016-11-05_02:01:59Locale: nl-NL (nl_NL.UTF-8); Calc: group
id=103939	Open any database file and then go to Tables on the panel on the left side.The color profile on the Mac is set to generic, so this is not it. LO even loads the database file, it only crashes when Java is involved, it seems.I tested with JDK 8 Update 101, 111, and 112. It happens with all of those versions. It actually works with the very old Java 8 Update 74.I am not sure whether this is a Java or LO issue. Testing with :Version: 5.1.6.2Build ID: 07ac168c60a517dba0f0d7bc7540f5afa45f0909Threads CPU : 2; Version de l'OS :Mac OS X 10.12.1; UI Render : par défaut; Locale : fr-FR (fr_FR.UTF-8); Calc: groupI don't get a crash, but I get the following error message instead :Impossible d'établir la connexion à la source de données "2014 freshman books".Statut SQL: HY000La connexion n'a pas pu être établie. La base de données a été créée par une version plus récente de LibreOffice.This is of course an incorrect error message for a file that was created with a previous version of LO (and not a newer one).OK, I can reproduce this with another ODB file.Confirming.Yet another major regression in an EOL allegedly "still" bug-fixed release...CreatedTest Beispiel_Sport.odb with which LO crashesCreatedTest 2014_freshman_books.odb which can't be opened due to alleged version mismatchrefers to the test using the "version mismatch" ODB attached file.refers to the test using "Test ODB which crashes" file.If I try and open the 5.1.6 crasher ODB file in Version: 5.2.3.3Build ID: d54a8868f08a7b39642414cf2c8ef2f228f780cfThreads CPU : 2; Version de l'OS :Mac OS X 10.12.1; UI Render : par défaut; Locale : fr-FR (fr_FR.UTF-8); Calc: groupI get a first error message that the db can't be opened due to an incorrect "SA" authentication identifier, then I get a subsequent error message :Impossible d'établir la connexion à la source de données "Beispiel_Sport".tatut SQL: HY000La connexion n'a pas pu être établie. La base de données a été créée par une version plus récente de LibreOffice.The first error message with 5233 is :Statut SQL: 28501Code d'erreur: -4001invalid authorization specification - not found: SAI'm using JDK 1.8.0_112I also get a crash in LO 5142 with Beispiel_Sport.odb as soon as I click on the Tables icon.As I get the same authentication error message Statut SQL: 28501Code d'erreur: -4001invalid authorization specification - not found: SAwith LO5032 and Apple's JavaforOSX in combination with Oracle JDK 1.8.0_112, and in view of Gerhard's original comment with respect to JDK 1.8.0_74, I'm going to hasard a guess that this is a problem with the JDK subversion numbers above 100 again and some incompatibility with hsqldb.jar.Sigh, this gives the same backtrace as the report that was closed the other day because 51xx is EOL....Createdbacktrace from lldb debugging sessionStephan: thought you might be interested in this one. Indeed, even if it concerns Base, it seems related to Java part (according to the bt provided by Alex)In contrast to LO 5.1.6.2, I can browse the tables with LO 5.2.3.3, and even open forms.One thing is strange, though. In the list of available Java runtimes, LO 5.2.3.3 shows 3 times the version 1.8.0_112, and once 1.8.0_74. It seems it replaces the Java updates 101 and 111 with 112.LO 5.1.6.2 shows the Java runtimes correctly, but on the other hand browsing tables only works in conjunction with Java update 74 with that version.I could open yet another Base ODB file in LO 5233 without causing a crash, however this hadn't previously been opened by LO 5162.When I then attempted to open this other ODB files in LO 5162, I get the error message of. Any subsequent attempt to open the same file in LO5233 leads to the same message, so the file is effectively corrupt.This means that both LO 5233 and LO5162 corrupt existing ODB files when used with a JDK 1.8.0 > 99@Stephan - any advice ?From "I tested with JDK 8 Update 101, 111, and 112. It happens with all of those versions. It actually works with the very old Java 8 Update 74." inand "terminating with unexpected exception of type jfw_plugin::MalformedVersionException" inthis is apparently a duplicate of(i.e., the fix forabout three-digit Java update version in LO 5.1.5 missing in 5.1.6).(If any other specific issues mentioned in this bug's various comments remain, please file new bugs for those.)*** This bug has been marked as a duplicate of***(In reply to Gerhard Schaber from)(That 5.2 regression should be fixed now with <> "Fix regression in bubbleSortVersion".)Thanks. Does this affect other versions as well?(In reply to Gerhard Schaber from)That regression presumably got introduced into master towards LO 5.2 (so any LO 5.2.x and upcoming 5.3 would be affected, but no 5.1.x or earlier); fixes are in libreoffice-5-2 (towards LO 5.2.4) and master (towards LO 5.3).
id=103690	Description:NOTE: I had a LibreOfficeDev.app installed for a while before this because LibreOffice 5.2.2 had a bug where it would hang on open. Not sure if that's related.macOS popped up a report window, which I'm sure contains useful data. I noticed LibreOffice tried switching from my integrated GPU to the discrete one before crashing as well.Process: soffice [27147]Path: /Applications/LibreOffice.app/Contents/MacOS/sofficeIdentifier: org.libreoffice.scriptVersion: 5.2.3003 (5.2.3003)Code Type: X86-64 (Native)Parent Process: ??? [1]Responsible: soffice [27147]User ID: 501Date/Time: 2016-11-03 22:38:15.974 +0100OS Version: Mac OS X 10.12.1 (16B2555)Report Version: 12Anonymous UUID: 2B075655-A9B8-7021-17E1-E48A4DD31850Sleep/Wake UUID: 837D39A7-5126-4FE3-B849-7E4831C2FCD7Time Awake Since Boot: 44000 secondsTime Since Wake: 1800 secondsSystem Integrity Protection: enabledCrashed Thread: 0 Dispatch queue: com.apple.main-threadException Type: EXC_BAD_ACCESS (SIGSEGV)Exception Codes: KERN_INVALID_ADDRESS at 0x0000000000000000Exception Note: EXC_CORPSE_NOTIFYTermination Signal: Segmentation fault: 11Termination Reason: Namespace SIGNAL, Code 0xbTerminating Process: exc handler [0]VM Regions Near 0:--> __TEXT 00000001033f5000-00000001033f6000 [ 4K] r-x/rwx SM=COW /Applications/LibreOffice.app/Contents/MacOS/sofficeThread 0 Crashed:: Dispatch queue: com.apple.main-thread0 libvcllo.dylib 0x0000000105e3b3cd Application::GetSolarMutex() + 131 libvcllo.dylib 0x0000000105f0df5f -[VCL_NSApplication screenParametersChanged:] + 152 com.apple.CoreFoundation 0x00007fff892625ec __CFNOTIFICATIONCENTER_IS_CALLING_OUT_TO_AN_OBSERVER__ + 123 com.apple.CoreFoundation 0x00007fff892624eb _CFXRegistrationPost + 4274 com.apple.CoreFoundation 0x00007fff89262252 ___CFXNotificationPost_block_invoke + 505 com.apple.CoreFoundation 0x00007fff89220972 -[_CFXNotificationRegistrar find:object:observer:enumerator:] + 20186 com.apple.CoreFoundation 0x00007fff8921f95b _CFXNotificationPost + 6677 com.apple.Foundation 0x00007fff8ac4d0e3 -[NSNotificationCenter postNotificationName:object:userInfo:] + 668 com.apple.AppKit 0x00007fff8727c1c6 -[NSApplication _reactToScreenInvalidationImmediately:] + 3999 com.apple.AppKit 0x00007fff8727c003 __44-[NSApplication _reactToScreenInvalidation:]_block_invoke + 5910 com.apple.CoreFoundation 0x00007fff8926c30c __CFRUNLOOP_IS_CALLING_OUT_TO_A_BLOCK__ + 1211 com.apple.CoreFoundation 0x00007fff8924d634 __CFRunLoopDoBlocks + 35612 com.apple.CoreFoundation 0x00007fff8924d176 __CFRunLoopRun + 189413 com.apple.CoreFoundation 0x00007fff8924c7b4 CFRunLoopRunSpecific + 42014 com.apple.HIToolbox 0x00007fff887e8fbc RunCurrentEventLoopInMode + 24015 com.apple.HIToolbox 0x00007fff887e8cf9 ReceiveNextEventCommon + 18416 com.apple.HIToolbox 0x00007fff887e8c26 _BlockUntilNextEventMatchingListInModeWithFilter + 7117 com.apple.AppKit 0x00007fff86ed2b79 _DPSNextEvent + 109318 com.apple.AppKit 0x00007fff875e81c3 -[NSApplication(NSEvent) _nextEventMatchingEventMask:untilDate:inMode:dequeue:] + 163719 com.apple.AppKit 0x00007fff86ec753d -[NSApplication run] + 92620 com.apple.AppKit 0x00007fff86e921ad NSApplicationMain + 123721 libvcllo.dylib 0x0000000105eb89fd ImplSVMainHook(int*) + 39722 libvcllo.dylib 0x0000000105e3ff8a SVMain() + 2623 libsofficeapp.dylib 0x00000001034a4f4b soffice_main + 21924 org.libreoffice.script 0x00000001033f5f20 main + 1625 libdyld.dylib 0x00007fff9e3b9255 start + 1Thread 1:0 libsystem_kernel.dylib 0x00007fff9e4e7c8a __psynch_cvwait + 101 libsystem_pthread.dylib 0x00007fff9e5d196a _pthread_cond_wait + 7122 libuno_sal.dylib.3 0x0000000103405e82 rtl_cache_wsupdate_all(void*) + 1303 libsystem_pthread.dylib 0x00007fff9e5d0aab _pthread_body + 1804 libsystem_pthread.dylib 0x00007fff9e5d09f7 _pthread_start + 2865 libsystem_pthread.dylib 0x00007fff9e5d0221 thread_start + 13Thread 2:0 libsystem_kernel.dylib 0x00007fff9e4e84e6 __workq_kernreturn + 101 libsystem_pthread.dylib 0x00007fff9e5d07b5 _pthread_wqthread + 14262 libsystem_pthread.dylib 0x00007fff9e5d0211 start_wqthread + 13Thread 3:0 libsystem_kernel.dylib 0x00007fff9e4e84e6 __workq_kernreturn + 101 libsystem_pthread.dylib 0x00007fff9e5d0622 _pthread_wqthread + 10232 libsystem_pthread.dylib 0x00007fff9e5d0211 start_wqthread + 13Thread 4:0 libsystem_kernel.dylib 0x00007fff9e4e84e6 __workq_kernreturn + 101 libsystem_pthread.dylib 0x00007fff9e5d07b5 _pthread_wqthread + 14262 libsystem_pthread.dylib 0x00007fff9e5d0211 start_wqthread + 13Thread 5:0 libsystem_kernel.dylib 0x00007fff9e4e84e6 __workq_kernreturn + 101 libsystem_pthread.dylib 0x00007fff9e5d07b5 _pthread_wqthread + 14262 libsystem_pthread.dylib 0x00007fff9e5d0211 start_wqthread + 13Thread 6:0 libsystem_kernel.dylib 0x00007fff9e4e84e6 __workq_kernreturn + 101 libsystem_pthread.dylib 0x00007fff9e5d07b5 _pthread_wqthread + 14262 libsystem_pthread.dylib 0x00007fff9e5d0211 start_wqthread + 13Thread 7:Thread 0 crashed with X86 Thread State (64-bit): rax: 0x00000001060b39d0 rbx: 0x000061000005ae20 rcx: 0x0000618000105bb0 rdx: 0x000060000004fea0 rdi: 0x0000000000000000 rsi: 0x0000000105fc2d70 rbp: 0x00007fff5c808980 rsp: 0x00007fff5c808980 r8: 0x0000000000000000 r9: 0x0000000000000000 r10: 0x001fb801001fb880 r11: 0x0000000105f0df50 r12: 0x0000000000000000 r13: 0x000061000006ba00 r14: 0x000060000004fea0 r15: 0x0000000000000000 rip: 0x0000000105e3b3cd rfl: 0x0000000000010202 cr2: 0x0000000000000000 Logical CPU: 0Error Code: 0x00000004Trap Number: 14Binary Images: 0x1033f5000 - 0x1033f5fff +org.libreoffice.script (5.2.3003 - 5.2.3003) <01984524-504A-3B08-AAF0-2E55D9BEF61D> /Applications/LibreOffice.app/Contents/MacOS/soffice 0x1033fe000 - 0x103445ff7 +libuno_sal.dylib.3 (0) <A7AC7E2F-866F-3472-A9DA-CB2FA0D5E143> /Applications/LibreOffice.app/Contents/Frameworks/libuno_sal.dylib.3 0x103472000 - 0x1034fdff7 +libsofficeapp.dylib (0) <91A62E80-DBE3-370B-B326-9EEC7A3532A6> /Applications/LibreOffice.app/Contents/Frameworks/libsofficeapp.dylib 0x103547000 - 0x103548fff +libclewlo.dylib (0) <6A76A434-CEC0-32F9-9D85-EC7F3459D39D> /Applications/LibreOffice.app/Contents/Frameworks/libclewlo.dylib 0x103555000 - 0x10366bff7 +libcomphelper.dylib (0) <64FD67C6-F330-37E8-84F6-1F266F62B060> /Applications/LibreOffice.app/Contents/Frameworks/libcomphelper.dylib 0x103743000 - 0x10376afff +libuno_cppu.dylib.3 (0) <F3720F2F-DC5A-3753-9047-412BAC196DC0> /Applications/LibreOffice.app/Contents/Frameworks/libuno_cppu.dylib.3 0x103783000 - 0x103842fff +libuno_cppuhelpergcc3.dylib.3 (0) <49AB8E09-77DB-36EB-B74D-ACD73E5F765C> /Applications/LibreOffice.app/Contents/Frameworks/libuno_cppuhelpergcc3.dylib.3 0x1038c8000 - 0x1038edfff +libdeploymentmisclo.dylib (0) <706BB4F6-093F-37EA-BB37-7E4A82F8E0D5> /Applications/LibreOffice.app/Contents/Frameworks/libdeploymentmisclo.dylib 0x10390b000 - 0x103abcfff +libeditenglo.dylib (0) <AFABFE2F-EE59-34C1-9A59-F96997219D08> /Applications/LibreOffice.app/Contents/Frameworks/libeditenglo.dylib 0x103bca000 - 0x103be3fff +libi18nlangtag.dylib (0) <F6F1BA1D-ADC4-3485-BE02-7C985B8CBDFA> /Applications/LibreOffice.app/Contents/Frameworks/libi18nlangtag.dylib 0x103bf4000 - 0x103c08ff7 +libopencllo.dylib (0) <24665414-84E0-3DDE-9D91-7E54AD3961D2> /Applications/LibreOffice.app/Contents/Frameworks/libopencllo.dylib 0x103c1b000 - 0x103c1eff7 +libuno_salhelpergcc3.dylib.3 (0) <AABA9F42-61F1-3AC6-8D15-B17414411107> /Applications/LibreOffice.app/Contents/Frameworks/libuno_salhelpergcc3.dylib.3 0x103c2a000 - 0x103d87fff +libsblo.dylib (0) <2019384A-F7F8-3CCE-9557-655CDAD4CA83> /Applications/LibreOffice.app/Contents/Frameworks/libsblo.dylib 0x103e31000 - 0x104220fff +libsfxlo.dylib (0) <93053DC0-59FC-33C7-83F7-48B2F0417047> /Applications/LibreOffice.app/Contents/Frameworks/libsfxlo.dylib 0x10446b000 - 0x10454afff +libsvllo.dylib (0) <CBD93D21-8AF1-3DE5-8AAA-CD25C9C6D186> /Applications/LibreOffice.app/Contents/Frameworks/libsvllo.dylib 0x1045c4000 - 0x104bbcfff +libsvxcorelo.dylib (0) <53B6EE08-E11C-30A3-AEB2-7A589844ED24> /Applications/LibreOffice.app/Contents/Frameworks/libsvxcorelo.dylib 0x104f85000 - 0x105229fff +libsvtlo.dylib (0) <0E3ED212-0779-34A8-A70A-0DB8B2C35F16> /Applications/LibreOffice.app/Contents/Frameworks/libsvtlo.dylib 0x1053f7000 - 0x10568ffff +libtklo.dylib (0) <B13C0F5F-B8CE-35E6-90AB-90A2F887D19D> /Applications/LibreOffice.app/Contents/Frameworks/libtklo.dylib 0x1058af000 - 0x10590dff7 +libtllo.dylib (0) <B66F29C4-D55B-3337-A429-4C2D66C9713B> /Applications/LibreOffice.app/Contents/Frameworks/libtllo.dylib 0x10593c000 - 0x10599cff7 +libucbhelper.dylib (0) <F2D46927-C44F-3CA8-A097-C792BB74DE17> /Applications/LibreOffice.app/Contents/Frameworks/libucbhelper.dylib 0x1059eb000 - 0x105adffff +libutllo.dylib (0) <C269AE27-BD01-3B07-BC63-B2075CDDCDB8> /Applications/LibreOffice.app/Contents/Frameworks/libutllo.dylib 0x105b70000 - 0x106078fff +libvcllo.dylib (0) <8C6312C7-7349-3A69-8031-37CFEEED09EF> /Applications/LibreOffice.app/Contents/Frameworks/libvcllo.dylib 0x106272000 - 0x1063bdfff +libicuuc.dylib.57 (0) <A95D88F3-BC67-3FC3-977D-A0001A25AA9F> /Applications/LibreOffice.app/Contents/Frameworks/libicuuc.dylib.57 0x106431000 - 0x106448fff +libreglo.dylib (0) <D6B8690B-0875-3A32-9090-CA987AB4B363> /Applications/LibreOffice.app/Contents/Frameworks/libreglo.dylib 0x106458000 - 0x1064bdfff +libunoidllo.dylib (0) <A342777C-ED75-3E2E-81DF-92E2BD653948> /Applications/LibreOffice.app/Contents/Frameworks/libunoidllo.dylib 0x1064d5000 - 0x1064ddfff +libxmlreaderlo.dylib (0) <D8820C9F-300E-39EF-941A-CF2B2F73B727> /Applications/LibreOffice.app/Contents/Frameworks/libxmlreaderlo.dylib 0x1064e7000 - 0x1064fafff +libstorelo.dylib (0) <F511C3CC-98DE-3DF7-BB32-A078D9F18D81> /Applications/LibreOffice.app/Contents/Frameworks/libstorelo.dylib 0x10650d000 - 0x106530ff7 +liblangtag.1.dylib (0) <C2AFC462-8FBE-3DE5-BA43-7C2918792487> /Applications/LibreOffice.app/Contents/Frameworks/liblangtag.1.dylib 0x106540000 - 0x107d8efff +libicudata.dylib.57 (0) <8FD5A75E-28E7-3C0F-9254-F2C724B34102> /Applications/LibreOffice.app/Contents/Frameworks/libicudata.dylib.57 0x107db6000 - 0x107e40fff +libxmlscriptlo.dylib (0) <64E4DB39-C079-3047-A71D-4FA0DBCAC2DB> /Applications/LibreOffice.app/Contents/Frameworks/libxmlscriptlo.dylib 0x107e7f000 - 0x107effff7 +libbasegfxlo.dylib (0) <A5B8FDA0-BDBC-3EAA-B908-DE9313A6DED0> /Applications/LibreOffice.app/Contents/Frameworks/libbasegfxlo.dylib 0x107f2c000 - 0x107f3efff +libsaxlo.dylib (0) <B16A0F85-2FF1-3267-8D96-ABC48814D528> /Applications/LibreOffice.app/Contents/Frameworks/libsaxlo.dylib 0x107f52000 - 0x1082f2fff +libxolo.dylib (0) <FEDA1C58-E314-3AB4-A645-0608258F1155> /Applications/LibreOffice.app/Contents/Frameworks/libxolo.dylib 0x1084b2000 - 0x108535ff7 +liblnglo.dylib (0) <AFA0F72D-48D5-3BD8-9FDD-D54B736E3904> /Applications/LibreOffice.app/Contents/Frameworks/liblnglo.dylib 0x108596000 - 0x1085e6ff7 +libsotlo.dylib (0) <E7000D83-99D2-3CF6-B69E-45FE7ABFEEB1> /Applications/LibreOffice.app/Contents/Frameworks/libsotlo.dylib 0x10861d000 - 0x10862dfff +libi18nutil.dylib (0) <587C4FAE-F5A3-30B3-A32C-12A3EFD59D9B> /Applications/LibreOffice.app/Contents/Frameworks/libi18nutil.dylib 0x108642000 - 0x108662fff +libjvmfwklo.dylib (0) <C7D256A3-CC23-3805-9E42-6E02D7AF4738> /Applications/LibreOffice.app/Contents/Frameworks/libjvmfwklo.dylib 0x108678000 - 0x108862ff7 +libicui18n.dylib.57 (0) <46874876-4F6C-3AC7-AB84-0AFBDD043BCF> /Applications/LibreOffice.app/Contents/Frameworks/libicui18n.dylib.57 0x10894b000 - 0x10894efff +libjvmaccesslo.dylib (0) <1B8288E8-817F-3843-A801-579A22DE359B> /Applications/LibreOffice.app/Contents/Frameworks/libjvmaccesslo.dylib 0x108957000 - 0x10895dff7 +libAppleRemotelo.dylib (0) <646FCBF7-0AE7-3FBF-ADB1-8EDC2D8D96A5> /Applications/LibreOffice.app/Contents/Frameworks/libAppleRemotelo.dylib 0x108967000 - 0x1089acfff +libcurl.4.dylib (0) <D4BAF6AE-D4E8-3383-902E-1DC48AF53B43> /Applications/LibreOffice.app/Contents/Frameworks/libcurl.4.dylib 0x1089bb000 - 0x108a09fff +libnspr4.dylib (0) <A8B2E6FE-914F-34E1-9C7E-CD2A08C317C9> /Applications/LibreOffice.app/Contents/Frameworks/libnspr4.dylib 0x108a38000 - 0x108be4fff +libnss3.dylib (0) <961209B8-2E6B-3A7D-B0CC-31CFD1BEFBC7> /Applications/LibreOffice.app/Contents/Frameworks/libnss3.dylib 0x108c98000 - 0x108ccdff7 +libsmime3.dylib (0) <42733475-6AF3-3BE8-9EEA-6153EF60DA8F> /Applications/LibreOffice.app/Contents/Frameworks/libsmime3.dylib 0x108cf1000 - 0x108cf6ff7 +libplc4.dylib (0) <40C0CDEE-19E3-3526-A555-654B4ED5C126> /Applications/LibreOffice.app/Contents/Frameworks/libplc4.dylib 0x108cfe000 - 0x108d48ff7 +liblcms2.2.dylib (0) <F7BF8850-B53D-3CC4-9C21-2A5C62845C35> /Applications/LibreOffice.app/Contents/Frameworks/liblcms2.2.dylib 0x108d63000 - 0x108dcdff7 +libGLEW.1.12.0.dylib (0) <74C17001-D349-3EC1-B994-753D5BDA83FD> /Applications/LibreOffice.app/Contents/Frameworks/libGLEW.1.12.0.dylib 0x108e08000 - 0x108e34ff7 +libnssutil3.dylib (0) <30FE897D-5A4E-3535-B8FB-B4C919E051E5> /Applications/LibreOffice.app/Contents/Frameworks/libnssutil3.dylib 0x108e5a000 - 0x108e5dfff +libplds4.dylib (0) <9B5B8BCC-371F-3D80-92F2-556672625B2A> /Applications/LibreOffice.app/Contents/Frameworks/libplds4.dylib 0x108e67000 - 0x108e6bffb com.apple.agl (3.3.1 - AGL-3.3.1) <0B0E6527-C8E2-3162-BED1-DC2DD8DD2F95> /System/Library/Frameworks/AGL.framework/Versions/A/AGL 0x108e7a000 - 0x108f68fff +libdrawinglayerlo.dylib (0) <45546AFB-565D-3A5D-850A-87BA03F1E3C1> /Applications/LibreOffice.app/Contents/Frameworks/libdrawinglayerlo.dylib 0x109000000 - 0x109073fff +libfwelo.dylib (0) <FDBBF6CE-EB14-339B-B4F2-2BA57FB42738> /Applications/LibreOffice.app/Contents/Frameworks/libfwelo.dylib 0x1090c3000 - 0x1090f1fff +libcanvastoolslo.dylib (0) <BB20AC14-822C-3EF0-A8CE-9C35EA199914> /Applications/LibreOffice.app/Contents/Frameworks/libcanvastoolslo.dylib 0x109117000 - 0x109160ff7 +libcppcanvaslo.dylib (0) <A5D8846D-C19E-3F07-9EE4-CCB6C66B00FB> /Applications/LibreOffice.app/Contents/Frameworks/libcppcanvaslo.dylib 0x10918b000 - 0x1091a6fff +libfwilo.dylib (0) <58305779-5B28-3182-8C1E-DD080DEA70D8> /Applications/LibreOffice.app/Contents/Frameworks/libfwilo.dylib 0x1091c1000 - 0x109322ff7 +libdbtoolslo.dylib (0) <73940787-3DE4-3F08-B419-D728BC43B706> /Applications/LibreOffice.app/Contents/Frameworks/libdbtoolslo.dylib 0x1097ff000 - 0x109816ff3 libCGInterfaces.dylib (331.5) <C02EBC60-D365-38B2-8725-DA65A48A4ADA> /System/Library/Frameworks/Accelerate.framework/Frameworks/vImage.framework/Versions/A/Libraries/libCGInterfaces.dylib 0x10a1b2000 - 0x10a26cff7 com.apple.AMDRadeonX3000GLDriver (1.46.22 - 1.4.6) <73D84096-2E00-3579-98C9-53395DCE65EE> /System/Library/Extensions/AMDRadeonX3000GLDriver.bundle/Contents/MacOS/AMDRadeonX3000GLDriver 0x10a297000 - 0x10a2d4287 dyld (421.2) <13A9466A-2576-3ABB-AD9D-D6BC16439B8F> /usr/lib/dyld 0x10a322000 - 0x10b2a9ff7 +libavmedialo.dylib (0) <3417F9D2-47CB-3ED8-839E-66334514E275> /Applications/LibreOffice.app/Contents/Frameworks/libavmedialo.dylib 0x10d98d000 - 0x10db33fff GLEngine (12.4.5) <A4E7F3A2-5025-3C7D-AAF5-6187601A8C00> /System/Library/Frameworks/OpenGL.framework/Resources/GLEngine.bundle/GLEngine 0x10db71000 - 0x10dce7ffb libGLProgrammability.dylib (12.4.5) <6F6A4BA1-2DB2-3D22-9BEE-E45F6455BAE1> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGLProgrammability.dylib 0x10df9f000 - 0x10e28eff7 com.apple.driver.AppleIntelHD3000GraphicsGLDriver (10.2.10 - 10.0.2) <02978E0D-71B7-3B1C-A584-6ADBA799D380> /System/Library/Extensions/AppleIntelHD3000GraphicsGLDriver.bundle/Contents/MacOS/AppleIntelHD3000GraphicsGLDriver 0x10e45b000 - 0x10e661ffb ATIRadeonX3000SCLib.dylib (1.46.22) <EC0391A5-37BD-3174-8003-56121D413F81> /System/Library/Extensions/AMDRadeonX3000GLDriver.bundle/Contents/MacOS/ATIRadeonX3000SCLib.dylib 0x10e6bd000 - 0x10e6e7ffb GLRendererFloat (12.4.5) <9C53418B-2B6F-3B16-AA50-EF8CD632B05F> /System/Library/Frameworks/OpenGL.framework/Resources/GLRendererFloat.bundle/GLRendererFloat 0x7fff85d52000 - 0x7fff85d52fff com.apple.Accelerate (1.11 - Accelerate 1.11) <409E886A-9B89-3EF5-B434-BDFC1896A918> /System/Library/Frameworks/Accelerate.framework/Versions/A/Accelerate 0x7fff85d6b000 - 0x7fff863abfe3 com.apple.vImage (8.1 - ???) <85E957AD-3D7D-38C3-A0FA-CCD98FBE8C37> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vImage.framework/Versions/A/vImage 0x7fff863ac000 - 0x7fff86573fef libBLAS.dylib (1185) <0D55CF73-6DBD-3D15-B500-189479638551> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib 0x7fff86574000 - 0x7fff8658bfff libBNNS.dylib (14) <43A9B06E-3C21-3CE6-B0C1-99DA172DEEB0> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBNNS.dylib 0x7fff8658c000 - 0x7fff86997fff libLAPACK.dylib (1185) <E7AE9C48-6E42-3EB7-A257-D48E0CB48D00> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libLAPACK.dylib 0x7fff86998000 - 0x7fff869aefff libLinearAlgebra.dylib (1185) <08F00EFB-B477-3421-906E-3D364E607E6A> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libLinearAlgebra.dylib 0x7fff869af000 - 0x7fff869b5fff libQuadrature.dylib (3) <120F6228-A3D4-3184-89D7-785ADC2AC715> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libQuadrature.dylib 0x7fff869b6000 - 0x7fff869c9ff7 libSparseBLAS.dylib (1185) <912E3D25-27C0-3245-B64C-3CAD43A5D633> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libSparseBLAS.dylib 0x7fff869ca000 - 0x7fff86b17ff7 libvDSP.dylib (600) <12217266-9823-3C9B-AA5E-A8BD1BD46F24> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libvDSP.dylib 0x7fff86b18000 - 0x7fff86bcffff libvMisc.dylib (600) <73623707-9367-3D0F-9874-0B69FACEBB7F> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libvMisc.dylib 0x7fff86bd0000 - 0x7fff86bd0fff com.apple.Accelerate.vecLib (3.11 - vecLib 3.11) <B4B785D8-CB43-3E5D-AE81-1F27885AA112> /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/vecLib 0x7fff86e8c000 - 0x7fff87b6cff3 com.apple.AppKit (6.9 - 1504.60) <5DA1E013-575C-34D5-A028-1639EB7B0040> /System/Library/Frameworks/AppKit.framework/Versions/C/AppKit 0x7fff87b7e000 - 0x7fff87b7efff com.apple.ApplicationServices (48 - 48) <3E1395EA-C661-3318-9B87-9857BB81021B> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/ApplicationServices 0x7fff87b7f000 - 0x7fff87bedff7 com.apple.ApplicationServices.ATS (377 - 422.1) <FF4D9FCA-D799-3ED1-B5F8-3D81C29342D0> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/ATS 0x7fff87c87000 - 0x7fff87db5ff7 libFontParser.dylib (194.2) <E29F233F-773A-3070-874A-83799BDF0B5D> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/Resources/libFontParser.dylib 0x7fff87db6000 - 0x7fff87e00fff libFontRegistry.dylib (196.2) <8AEE7F4E-60F0-33BB-99E4-5381EF1FEC6F> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/Resources/libFontRegistry.dylib 0x7fff87e5d000 - 0x7fff87e8ffff libTrueTypeScaler.dylib (194.2) <A8520109-5F65-3144-ABF7-E22B98A74287> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/Resources/libTrueTypeScaler.dylib 0x7fff87efb000 - 0x7fff87fa5ff7 com.apple.ColorSync (4.12.0 - 502) <C86F8032-83DD-34EB-A4CB-87E96F25CF1C> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ColorSync.framework/Versions/A/ColorSync 0x7fff87fa6000 - 0x7fff87ff6fff com.apple.HIServices (1.22 - 590) <109A9893-313B-3467-9892-062F49D1FF0D> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/HIServices.framework/Versions/A/HIServices 0x7fff87ff7000 - 0x7fff88006ff3 com.apple.LangAnalysis (1.7.0 - 1.7.0) <47D1A017-91A4-37F3-93E0-3923CD6ED2DE> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/LangAnalysis.framework/Versions/A/LangAnalysis 0x7fff88007000 - 0x7fff88054fff com.apple.print.framework.PrintCore (12 - 491) <B7CC15C1-AF50-37F3-8AF6-65F8CDC323F0> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/PrintCore.framework/Versions/A/PrintCore 0x7fff88055000 - 0x7fff88090fff com.apple.QD (3.12 - 310) <8F718290-DD82-36CE-9AF0-EFB6D31A49F4> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/QD.framework/Versions/A/QD 0x7fff88091000 - 0x7fff8809cff7 com.apple.speech.synthesis.framework (6.0.15 - 6.0.15) <23EA6076-ECDF-3A50-81E7-3CE6451DC8C4> /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/SpeechSynthesis.framework/Versions/A/SpeechSynthesis 0x7fff8809d000 - 0x7fff882abff7 com.apple.audio.toolbox.AudioToolbox (1.14 - 1.14) <BA73DBAD-A9D2-3BA7-BCDB-4790D6C8B460> /System/Library/Frameworks/AudioToolbox.framework/Versions/A/AudioToolbox 0x7fff882ac000 - 0x7fff882acfff com.apple.audio.units.AudioUnit (1.14 - 1.14) <C49668FF-2971-3E30-92BB-09E0720E74A5> /System/Library/Frameworks/AudioUnit.framework/Versions/A/AudioUnit 0x7fff88415000 - 0x7fff88799ff7 com.apple.CFNetwork (807.1.3 - 807.1.3) <336BFAD9-1BAE-368E-8C48-B9F1CC251C67> /System/Library/Frameworks/CFNetwork.framework/Versions/A/CFNetwork 0x7fff887b3000 - 0x7fff887b3fff com.apple.Carbon (154 - 157) <AB71A31F-5B15-3BF5-8532-591EACD07B21> /System/Library/Frameworks/Carbon.framework/Versions/A/Carbon 0x7fff887b4000 - 0x7fff887b7fff com.apple.CommonPanels (1.2.6 - 98) <DDA2DF0B-86E7-34B6-B688-D7371DBC8A63> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/CommonPanels.framework/Versions/A/CommonPanels 0x7fff887b8000 - 0x7fff88abcfff com.apple.HIToolbox (2.1.1 - 856.6) <DAF74CE6-8B6B-3347-B299-FE860B517D38> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/HIToolbox.framework/Versions/A/HIToolbox 0x7fff88abd000 - 0x7fff88ac0ff7 com.apple.help (1.3.5 - 49) <27C5F9FE-838F-3807-A4AC-D99470185B10> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Help.framework/Versions/A/Help 0x7fff88ac1000 - 0x7fff88ac6fff com.apple.ImageCapture (9.0 - 9.0) <E3E757FD-4060-33A4-A2AC-85EFBD987FCE> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/ImageCapture.framework/Versions/A/ImageCapture 0x7fff88ac7000 - 0x7fff88b5eff3 com.apple.ink.framework (10.9 - 219) <B44BA36D-7549-3EB2-8CF6-E171885194FB> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Ink.framework/Versions/A/Ink 0x7fff88b5f000 - 0x7fff88b79fff com.apple.openscripting (1.7 - 172) <B204BF70-C4AA-3699-8493-66E6645A92A8> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/OpenScripting.framework/Versions/A/OpenScripting 0x7fff88b7a000 - 0x7fff88b7bff3 com.apple.print.framework.Print (12 - 267) <CA7E9448-0903-34C8-AAF6-9070B52BF70E> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/Print.framework/Versions/A/Print 0x7fff88b7c000 - 0x7fff88b7eff7 com.apple.securityhi (9.0 - 55006) <FFB3F28C-B982-34EF-8510-8D6D10975404> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/SecurityHI.framework/Versions/A/SecurityHI 0x7fff88b7f000 - 0x7fff88b85ff7 com.apple.speech.recognition.framework (6.0.1 - 6.0.1) <A20B0F7B-C32A-3FF1-BB75-BAC0EE4EF889> /System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/SpeechRecognition.framework/Versions/A/SpeechRecognition 0x7fff88c65000 - 0x7fff88c65fff com.apple.Cocoa (6.11 - 22) <5EEB0A26-F1C2-3D57-8441-52C0B80C2A6A> /System/Library/Frameworks/Cocoa.framework/Versions/A/Cocoa 0x7fff88d9b000 - 0x7fff88e2bff7 com.apple.audio.CoreAudio (4.3.0 - 4.3.0) <4082E8CC-568A-364A-9AF0-92F30F067D42> /System/Library/Frameworks/CoreAudio.framework/Versions/A/CoreAudio 0x7fff88e2c000 - 0x7fff88e3fff3 com.apple.CoreBluetooth (1.0 - 1) <73A2B185-70E4-3535-A653-E1BC74584E55> /System/Library/Frameworks/CoreBluetooth.framework/Versions/A/CoreBluetooth 0x7fff88e40000 - 0x7fff8913afff com.apple.CoreData (120 - 752.2) <51AB540E-01AE-3207-8DE5-3E912FA9B5DF> /System/Library/Frameworks/CoreData.framework/Versions/A/CoreData 0x7fff8913b000 - 0x7fff891c7fff com.apple.CoreDisplay (1.0 - 1) <ACA3B0B8-6900-3445-B202-C5C312421E44> /System/Library/Frameworks/CoreDisplay.framework/Versions/A/CoreDisplay 0x7fff891c8000 - 0x7fff8965bfff com.apple.CoreFoundation (6.9 - 1348.15) <A372C4F3-C484-38F1-947E-04712740B2AD> /System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation 0x7fff8965c000 - 0x7fff89cfcff7 com.apple.CoreGraphics (2.0 - 1070.8) <F40EC0F4-D013-3FE4-9FF6-2B8019CA037D> /System/Library/Frameworks/CoreGraphics.framework/Versions/A/CoreGraphics 0x7fff89cfd000 - 0x7fff89f3cff7 com.apple.CoreImage (12.0.0 - 451) <4A79760F-FD23-3055-9569-5F038818993F> /System/Library/Frameworks/CoreImage.framework/Versions/A/CoreImage 0x7fff8a097000 - 0x7fff8a097fff com.apple.CoreServices (775.8.2 - 775.8.2) <FE7B0765-C41F-3FD9-8FD7-094466AAD0EB> /System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices 0x7fff8a098000 - 0x7fff8a0e9ff7 com.apple.AE (712 - 712) <0EF17D7E-6BA4-3555-BC38-9BD0CC5B82A3> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/AE.framework/Versions/A/AE 0x7fff8a0ea000 - 0x7fff8a3c5fff com.apple.CoreServices.CarbonCore (1159 - 1159) <837B7ECF-7E62-3210-988C-63D7AB4EAA88> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/CarbonCore.framework/Versions/A/CarbonCore 0x7fff8a3c6000 - 0x7fff8a3f9fff com.apple.DictionaryServices (1.2 - 274) <302B8678-D057-3CF8-ACA7-7424A4A6A00A> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/DictionaryServices.framework/Versions/A/DictionaryServices 0x7fff8a3fa000 - 0x7fff8a402ffb com.apple.CoreServices.FSEvents (1230 - 1230) <8836E7D0-844F-36F9-9601-B630BB82336B> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/FSEvents.framework/Versions/A/FSEvents 0x7fff8a403000 - 0x7fff8a56efff com.apple.LaunchServices (775.8.2 - 775.8.2) <7389590A-0E30-3294-B39C-F179D237F6C4> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/LaunchServices.framework/Versions/A/LaunchServices 0x7fff8a56f000 - 0x7fff8a61fffb com.apple.Metadata (10.7.0 - 1075.17) <40F7E6E2-B58B-34E1-B97B-26756ECDB947> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/Metadata.framework/Versions/A/Metadata 0x7fff8a620000 - 0x7fff8a67ffff com.apple.CoreServices.OSServices (775.8.2 - 775.8.2) <C949CF81-3510-3987-AEB4-9A961B738DA2> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/OSServices.framework/Versions/A/OSServices 0x7fff8a680000 - 0x7fff8a6f0fff com.apple.SearchKit (1.4.0 - 1.4.0) <F1B3EF8D-E820-317C-AC7F-8F056C246874> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/SearchKit.framework/Versions/A/SearchKit 0x7fff8a6f1000 - 0x7fff8a737ff7 com.apple.coreservices.SharedFileList (38 - 38) <6C5A3FBB-9502-3725-AC3A-AE7B1528BBD4> /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/SharedFileList.framework/Versions/A/SharedFileList 0x7fff8a7c4000 - 0x7fff8a90fffb com.apple.CoreText (352.0 - 544.1) <3229A726-303B-3B09-A014-8708C3BEF2D1> /System/Library/Frameworks/CoreText.framework/Versions/A/CoreText 0x7fff8a910000 - 0x7fff8a945fff com.apple.CoreVideo (1.8 - 234.0) <48C31E93-87C2-31F4-97E7-9E54C1EA8E7D> /System/Library/Frameworks/CoreVideo.framework/Versions/A/CoreVideo 0x7fff8a946000 - 0x7fff8a9b7ffb com.apple.framework.CoreWLAN (11.0 - 1200.25.1) <0425CA71-50D9-32DC-8693-CAE6CB3B799D> /System/Library/Frameworks/CoreWLAN.framework/Versions/A/CoreWLAN 0x7fff8a9e7000 - 0x7fff8a9f2ff3 com.apple.DirectoryService.Framework (10.12 - 194) <829AFAAD-5742-332D-B84D-AF161FB57660> /System/Library/Frameworks/DirectoryService.framework/Versions/A/DirectoryService 0x7fff8a9f3000 - 0x7fff8aab1ff7 com.apple.DiscRecording (9.0.3 - 9030.4.5) <BB73A94D-1A40-3F62-9BD9-82DEE9DB8FE9> /System/Library/Frameworks/DiscRecording.framework/Versions/A/DiscRecording 0x7fff8aab2000 - 0x7fff8aab7fff com.apple.DiskArbitration (2.7 - 2.7) <566D5C06-13E8-3638-B2EC-2B834D5F04F1> /System/Library/Frameworks/DiskArbitration.framework/Versions/A/DiskArbitration 0x7fff8ac46000 - 0x7fff8afedffb com.apple.Foundation (6.9 - 1349) <08A463B1-296E-3AC1-B8D3-01A75B0785A8> /System/Library/Frameworks/Foundation.framework/Versions/C/Foundation 0x7fff8b019000 - 0x7fff8b04afff com.apple.GSS (4.0 - 2.0) <4F3C9982-457C-3731-85DB-8CE1A72621B0> /System/Library/Frameworks/GSS.framework/Versions/A/GSS 0x7fff8b0fe000 - 0x7fff8b1a1fff com.apple.Bluetooth (5.0.1 - 5.0.1f7) <406E3901-F5D3-3996-84F7-32975EBE8F86> /System/Library/Frameworks/IOBluetooth.framework/Versions/A/IOBluetooth 0x7fff8b1a2000 - 0x7fff8b237ff7 com.apple.framework.IOKit (2.0.2 - 1324.21.1) <EEFE7FF0-CE41-326A-A571-8AA0B2E89271> /System/Library/Frameworks/IOKit.framework/Versions/A/IOKit 0x7fff8b238000 - 0x7fff8b23effb com.apple.IOSurface (153.1 - 153.1) <849B0928-3D37-3977-9670-19979DB4EE4D> /System/Library/Frameworks/IOSurface.framework/Versions/A/IOSurface 0x7fff8b292000 - 0x7fff8b3ebff7 com.apple.ImageIO.framework (3.3.0 - 1570.2) <E7D7EE8F-F96C-3D9C-8C32-6878C00C5ED4> /System/Library/Frameworks/ImageIO.framework/Versions/A/ImageIO 0x7fff8b3ec000 - 0x7fff8b3f0fff libGIF.dylib (1570.2) <FC19393B-4D30-3B63-897E-15BE1DBA9030> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libGIF.dylib 0x7fff8b3f1000 - 0x7fff8b4e2fff libJP2.dylib (1570.2) <84DB1AB5-8C2A-30CD-BFDA-8C882023E523> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libJP2.dylib 0x7fff8b4e3000 - 0x7fff8b506fff libJPEG.dylib (1570.2) <D1943174-2A17-3482-A67C-9EE6B31EBD94> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libJPEG.dylib 0x7fff8b507000 - 0x7fff8b52dfff libPng.dylib (1570.2) <723EFF56-B176-30F8-B5C9-51AEDC4A8F42> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libPng.dylib 0x7fff8b52e000 - 0x7fff8b530ff3 libRadiance.dylib (1570.2) <19162142-F424-3BE0-BCFB-A835EE7A6451> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libRadiance.dylib 0x7fff8b531000 - 0x7fff8b58afff libTIFF.dylib (1570.2) <72AB88A4-2D95-31CD-AE15-8F15F7F558E4> /System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libTIFF.dylib 0x7fff8c14c000 - 0x7fff8c165ff7 com.apple.Kerberos (3.0 - 1) <49DCBE1A-130C-3FBF-AAEA-AF9A518913AC> /System/Library/Frameworks/Kerberos.framework/Versions/A/Kerberos 0x7fff8c166000 - 0x7fff8c19cfff com.apple.LDAPFramework (2.4.28 - 194.5) <850BB4C5-2548-33A5-B00C-0600CA59EE59> /System/Library/Frameworks/LDAP.framework/Versions/A/LDAP 0x7fff8c94c000 - 0x7fff8c9a3ff7 com.apple.Metal (85.85 - 85.85) <EF221C0E-9638-312B-9455-FF3C69180C45> /System/Library/Frameworks/Metal.framework/Versions/A/Metal 0x7fff8d0b9000 - 0x7fff8d0c1fff com.apple.NetFS (6.0 - 4.0) <6614F9B8-0861-338B-8FF0-8E402F96141C> /System/Library/Frameworks/NetFS.framework/Versions/A/NetFS 0x7fff8d295000 - 0x7fff8d29dff7 libcldcpuengine.dylib (2.8.4) <B43FD148-4550-3EB1-9971-F5EFC0456CCE> /System/Library/Frameworks/OpenCL.framework/Versions/A/Libraries/libcldcpuengine.dylib 0x7fff8d466000 - 0x7fff8d4b4ff3 com.apple.opencl (2.8.6 - 2.8.6) <819DE36A-893E-3100-8430-EEB9D7023672> /System/Library/Frameworks/OpenCL.framework/Versions/A/OpenCL 0x7fff8d4b5000 - 0x7fff8d4ceffb com.apple.CFOpenDirectory (10.12 - 194) <BDD22B3E-4149-366A-A974-942280861DD4> /System/Library/Frameworks/OpenDirectory.framework/Versions/A/Frameworks/CFOpenDirectory.framework/Versions/A/CFOpenDirectory 0x7fff8d4cf000 - 0x7fff8d4daff7 com.apple.OpenDirectory (10.12 - 194) <E1125140-E42C-369C-8DC8-D0935767B275> /System/Library/Frameworks/OpenDirectory.framework/Versions/A/OpenDirectory 0x7fff8d4db000 - 0x7fff8d4ddfff libCVMSPluginSupport.dylib (12.4.5) <AF349AF5-ACC9-32C8-98BE-1DC9523156C5> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libCVMSPluginSupport.dylib 0x7fff8d4de000 - 0x7fff8d4e1ff7 libCoreFSCache.dylib (150) <991F00EB-B1B4-3351-9D83-C11E4920C360> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libCoreFSCache.dylib 0x7fff8d4e2000 - 0x7fff8d4e5fff libCoreVMClient.dylib (150) <06276E05-1FB2-3748-A236-1F66468A1755> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libCoreVMClient.dylib 0x7fff8d4e6000 - 0x7fff8d4eeffb libGFXShared.dylib (12.4.5) <67ABA30E-DA8A-336C-8137-11CD0D455741> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGFXShared.dylib 0x7fff8d4ef000 - 0x7fff8d4fafff libGL.dylib (12.4.5) <920D2CC5-D64F-35A5-8C54-4A5731AEC552> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib 0x7fff8d4fb000 - 0x7fff8d537ff7 libGLImage.dylib (12.4.5) <BEDFA6BF-0D9C-35ED-9DDD-FDBB1F6AAF95> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGLImage.dylib 0x7fff8d6af000 - 0x7fff8d6efff3 libGLU.dylib (12.4.5) <79C811DC-7904-3A7D-A983-B3E8D5439336> /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGLU.dylib 0x7fff8e057000 - 0x7fff8e065fff com.apple.opengl (12.4.5 - 12.4.5) <B33F90DE-B86B-38E3-BCDB-5C8B4952D84B> /System/Library/Frameworks/OpenGL.framework/Versions/A/OpenGL 0x7fff8ed77000 - 0x7fff8ef71fff com.apple.QuartzCore (1.11 - 449.39.5) <B1815529-31B4-3FD0-923D-C3E964F844FF> /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore 0x7fff8f4d7000 - 0x7fff8f7f2ff7 com.apple.security (7.0 - 57740.20.22) <7E95D13A-0D52-36A9-A1C4-C21EE26AB2AB> /System/Library/Frameworks/Security.framework/Versions/A/Security 0x7fff8f7f3000 - 0x7fff8f869ff7 com.apple.securityfoundation (6.0 - 55132.20.1) <8DDEA805-C6F7-3EF9-990F-136617DB942D> /System/Library/Frameworks/SecurityFoundation.framework/Versions/A/SecurityFoundation 0x7fff8f893000 - 0x7fff8f896ff3 com.apple.xpc.ServiceManagement (1.0 - 1) <A88DACDF-71A9-3974-8D8D-DAA2B64F2CA5> /System/Library/Frameworks/ServiceManagement.framework/Versions/A/ServiceManagement 0x7fff8fc1b000 - 0x7fff8fc8cff7 com.apple.SystemConfiguration (1.14 - 1.14) <013957CA-2708-31F0-845D-11E271C96B94> /System/Library/Frameworks/SystemConfiguration.framework/Versions/A/SystemConfiguration 0x7fff91b3f000 - 0x7fff91b44ff7 com.apple.APFS (1.0 - 1) <AB6F6CA1-7C94-3E60-9AEB-045D0BB45884> /System/Library/PrivateFrameworks/APFS.framework/Versions/A/APFS 0x7fff922a4000 - 0x7fff922bfff3 com.apple.AppContainer (4.0 - 307.20.1) <AE48030D-760D-3C46-A5EB-FD09B42543ED> /System/Library/PrivateFrameworks/AppContainer.framework/Versions/A/AppContainer 0x7fff922ce000 - 0x7fff922f0ffb com.apple.framework.Apple80211 (12.0 - 1200.37) <25299C0F-7A30-3BAA-9945-DB1515F68A2C> /System/Library/PrivateFrameworks/Apple80211.framework/Versions/A/Apple80211 0x7fff922f1000 - 0x7fff92300fdb com.apple.AppleFSCompression (88 - 1.0) <D3A6F5F9-2132-34B5-933F-DF5D6733DE8B> /System/Library/PrivateFrameworks/AppleFSCompression.framework/Versions/A/AppleFSCompression 0x7fff923f6000 - 0x7fff9248197f com.apple.AppleJPEG (1.0 - 1) <B4C3209B-58A5-359F-A898-F61B6C40E5E9> /System/Library/PrivateFrameworks/AppleJPEG.framework/Versions/A/AppleJPEG 0x7fff924b1000 - 0x7fff924b9ffb com.apple.AppleSRP (5.0 - 1) <F105D2D2-8A12-3361-9C9D-E405668CAF75> /System/Library/PrivateFrameworks/AppleSRP.framework/Versions/A/AppleSRP 0x7fff9289d000 - 0x7fff9291bff7 com.apple.backup.framework (1.8.1 - 1.8.1) <792B4983-DE9A-377D-8338-93719706D12F> /System/Library/PrivateFrameworks/Backup.framework/Versions/A/Backup 0x7fff93539000 - 0x7fff93560ffb com.apple.ChunkingLibrary (172 - 172) <83E91936-305D-32A4-A256-5582B96B1852> /System/Library/PrivateFrameworks/ChunkingLibrary.framework/Versions/A/ChunkingLibrary 0x7fff93e7b000 - 0x7fff93e86ffb com.apple.CommerceCore (1.0 - 580.11) <C9E17FD2-48F3-3F86-9BF6-A723A6111CAC> /System/Library/PrivateFrameworks/CommerceKit.framework/Versions/A/Frameworks/CommerceCore.framework/Versions/A/CommerceCore 0x7fff93e87000 - 0x7fff93e90ffb com.apple.CommonAuth (4.0 - 2.0) <D561391D-80B8-35F8-9EFF-1ACC89895E38> /System/Library/PrivateFrameworks/CommonAuth.framework/Versions/A/CommonAuth 0x7fff94494000 - 0x7fff9449cffb com.apple.frameworks.CoreDaemon (1.3 - 1.3) <212D3DB2-DC44-329F-B810-238DF156D1EE> /System/Library/PrivateFrameworks/CoreDaemon.framework/Versions/B/CoreDaemon 0x7fff945ac000 - 0x7fff945bdff7 com.apple.CoreEmoji (1.0 - 39.1) <54432658-8481-3F33-ADED-B60684311E11> /System/Library/PrivateFrameworks/CoreEmoji.framework/Versions/A/CoreEmoji 0x7fff9489f000 - 0x7fff948cfff3 com.apple.CoreServicesInternal (276 - 276) <CCB21255-89DC-3F53-A6D6-8FA8F693C837> /System/Library/PrivateFrameworks/CoreServicesInternal.framework/Versions/A/CoreServicesInternal 0x7fff94b58000 - 0x7fff94be2fff com.apple.CoreSymbolication (61050) <15C4AF49-2F85-3265-B53F-4925616C746E> /System/Library/PrivateFrameworks/CoreSymbolication.framework/Versions/A/CoreSymbolication 0x7fff94be3000 - 0x7fff94d21fcf com.apple.coreui (2.1 - 426.9.1) <A7672B5D-9972-34B8-968A-188D422083AE> /System/Library/PrivateFrameworks/CoreUI.framework/Versions/A/CoreUI 0x7fff94d22000 - 0x7fff94dc1ffb com.apple.CoreUtils (4.3 - 430.70) <946F5089-9F8D-3595-8208-AD945B26D267> /System/Library/PrivateFrameworks/CoreUtils.framework/Versions/A/CoreUtils 0x7fff94e11000 - 0x7fff94e76ff3 com.apple.framework.CoreWiFi (12.0 - 1200.25.1) <8DAD3903-9A77-3E50-99C4-3C5708FB25B1> /System/Library/PrivateFrameworks/CoreWiFi.framework/Versions/A/CoreWiFi 0x7fff94e77000 - 0x7fff94e84fff com.apple.CrashReporterSupport (10.12 - 816) <BF292E0C-6CDB-3149-8177-4EF5DD72D544> /System/Library/PrivateFrameworks/CrashReporterSupport.framework/Versions/A/CrashReporterSupport 0x7fff94f2a000 - 0x7fff94fa1ff3 com.apple.datadetectorscore (7.0 - 539) <AA02538E-706E-305B-AABA-FA9A6F4C1B8C> /System/Library/PrivateFrameworks/DataDetectorsCore.framework/Versions/A/DataDetectorsCore 0x7fff94fdb000 - 0x7fff9501afff com.apple.DebugSymbols (137 - 137) <B229F3F7-250B-3151-8048-CEA7BF80FA52> /System/Library/PrivateFrameworks/DebugSymbols.framework/Versions/A/DebugSymbols 0x7fff9501b000 - 0x7fff9512cfff com.apple.desktopservices (1.11.1 - 1.11.1) <03518A59-79B1-3B16-B923-52D6EFF04ADB> /System/Library/PrivateFrameworks/DesktopServicesPriv.framework/Versions/A/DesktopServicesPriv 0x7fff95131000 - 0x7fff95207ff7 com.apple.DiskImagesFramework (444.20.3 - 444.20.3) <D7B9FFE2-65D7-33AE-A50B-6EB46CAC0157> /System/Library/PrivateFrameworks/DiskImages.framework/Versions/A/DiskImages 0x7fff952ba000 - 0x7fff952bcffb com.apple.EFILogin (2.0 - 2) <201CA489-CD74-35A2-AC1C-A2458161A7AF> /System/Library/PrivateFrameworks/EFILogin.framework/Versions/A/EFILogin 0x7fff953f8000 - 0x7fff95829ff7 com.apple.vision.FaceCore (3.3.2 - 3.3.2) <DEB42099-6927-332C-8D3E-D45096318D25> /System/Library/PrivateFrameworks/FaceCore.framework/Versions/A/FaceCore 0x7fff95831000 - 0x7fff9584efff com.apple.framework.familycontrols (4.1 - 410) <44D53004-A83C-3A78-8565-F707393A5504> /System/Library/PrivateFrameworks/FamilyControls.framework/Versions/A/FamilyControls 0x7fff96b64000 - 0x7fff96b64fff libmetal_timestamp.dylib (600.0.48.26) <681B9F09-0673-3C38-B636-9D77D338D1AF> /System/Library/PrivateFrameworks/GPUCompiler.framework/libmetal_timestamp.dylib 0x7fff96b65000 - 0x7fff96b70fff libGPUSupport.dylib (12.4.5) <58268BB1-97B9-3BB7-A51F-947D18F64822> /System/Library/PrivateFrameworks/GPUSupport.framework/Versions/A/Libraries/libGPUSupport.dylib 0x7fff96b71000 - 0x7fff96b7cff3 libGPUSupportMercury.dylib (12.4.5) <A08E7321-32C4-3008-97C3-870B6AB1E63D> /System/Library/PrivateFrameworks/GPUSupport.framework/Versions/A/Libraries/libGPUSupportMercury.dylib 0x7fff96e2e000 - 0x7fff96e4aff7 com.apple.GenerationalStorage (2.0 - 259) <43D40063-BD46-3008-8992-FF092B7C9A58> /System/Library/PrivateFrameworks/GenerationalStorage.framework/Versions/A/GenerationalStorage 0x7fff97540000 - 0x7fff975b6ffb com.apple.Heimdal (4.0 - 2.0) <418DD668-7288-3D33-BAFE-959DB96D0351> /System/Library/PrivateFrameworks/Heimdal.framework/Versions/A/Heimdal 0x7fff97bc9000 - 0x7fff97bd0ffb com.apple.IOAccelerator (288.15 - 288.15) <DE5BC493-2F4E-3388-A887-DA5AD7BAD3F4> /System/Library/PrivateFrameworks/IOAccelerator.framework/Versions/A/IOAccelerator 0x7fff97bd2000 - 0x7fff97be6ff3 com.apple.IOPresentment (1.0 - 25) <40934217-996A-3DDB-A8C4-484CA0F0222B> /System/Library/PrivateFrameworks/IOPresentment.framework/Versions/A/IOPresentment 0x7fff97be7000 - 0x7fff97c09ff7 com.apple.IconServices (74.1 - 74.1) <F7B83970-4A72-3186-BBB3-90FA86C3E263> /System/Library/PrivateFrameworks/IconServices.framework/Versions/A/IconServices 0x7fff97ceb000 - 0x7fff97e9ffff com.apple.LanguageModeling (1.0 - 123) <10152D7F-C7C0-34AA-A295-D712D16C76E6> /System/Library/PrivateFrameworks/LanguageModeling.framework/Versions/A/LanguageModeling 0x7fff97ecc000 - 0x7fff97ed0ff7 com.apple.LoginUICore (4.0 - 4.0) <DB0F1DBE-12A8-3848-9D8B-97353C5D3C23> /System/Library/PrivateFrameworks/LoginUIKit.framework/Versions/A/Frameworks/LoginUICore.framework/Versions/A/LoginUICore 0x7fff985c0000 - 0x7fff985f4ff3 com.apple.MediaKit (16 - 840) <2035FF47-C7E6-3F73-A335-AC0BFBB1DB36> /System/Library/PrivateFrameworks/MediaKit.framework/Versions/A/MediaKit 0x7fff9874b000 - 0x7fff987c3fef com.apple.MetalPerformanceShaders.MetalPerformanceShaders (1.0 - 1) <EDE6F9AA-B863-3936-BA54-177B769080FD> /System/Library/PrivateFrameworks/MetalPerformanceShaders.framework/Versions/A/MetalPerformanceShaders 0x7fff98945000 - 0x7fff9896dfff com.apple.MultitouchSupport.framework (368.4 - 368.4) <18778258-70B1-31BF-845D-1FACBF280108> /System/Library/PrivateFrameworks/MultitouchSupport.framework/Versions/A/MultitouchSupport 0x7fff98a1a000 - 0x7fff98a24fff com.apple.NetAuth (6.0 - 6.0) <D57D5888-0290-3295-A1C4-D673D4DCB497> /System/Library/PrivateFrameworks/NetAuth.framework/Versions/A/NetAuth 0x7fff99200000 - 0x7fff99241ff7 com.apple.PerformanceAnalysis (1.145 - 145) <73A73364-EFB6-3D0A-A7EA-7F924359B3C9> /System/Library/PrivateFrameworks/PerformanceAnalysis.framework/Versions/A/PerformanceAnalysis 0x7fff998a7000 - 0x7fff998d2ffb com.apple.ProtectedCloudStorage (1.0 - 1) <614C38AC-9D97-30D8-A196-02688634B584> /System/Library/PrivateFrameworks/ProtectedCloudStorage.framework/Versions/A/ProtectedCloudStorage 0x7fff998d3000 - 0x7fff998edfff com.apple.ProtocolBuffer (1 - 249) <D8B7694B-B598-3728-8583-9C4CC0F05B64> /System/Library/PrivateFrameworks/ProtocolBuffer.framework/Versions/A/ProtocolBuffer 0x7fff99907000 - 0x7fff9992aff3 com.apple.RemoteViewServices (2.0 - 124) <280DB828-4613-3DF8-ACBA-C91989B64347> /System/Library/PrivateFrameworks/RemoteViewServices.framework/Versions/A/RemoteViewServices 0x7fff9a55d000 - 0x7fff9a560fff com.apple.SecCodeWrapper (4.0 - 307.20.1) <2BBC8E7C-7B28-39D2-8273-2BA5ED7DAC45> /System/Library/PrivateFrameworks/SecCodeWrapper.framework/Versions/A/SecCodeWrapper 0x7fff9a5ee000 - 0x7fff9a66afff com.apple.Sharing (671.15 - 671.15) <37C29D52-CA6E-3E30-9CCF-F7B4A8DE6B9B> /System/Library/PrivateFrameworks/Sharing.framework/Versions/A/Sharing 0x7fff9a68b000 - 0x7fff9a8ecfff com.apple.SkyLight (1.600.0 - 108.11) <720141AF-56A6-35C8-B05E-5BF6BA539B53> /System/Library/PrivateFrameworks/SkyLight.framework/Versions/A/SkyLight 0x7fff9aac6000 - 0x7fff9aad2fff com.apple.SpeechRecognitionCore (3.0.15 - 3.0.15) <BE386037-4B61-341F-80E2-5D8B5B50C8BC> /System/Library/PrivateFrameworks/SpeechRecognitionCore.framework/Versions/A/SpeechRecognitionCore 0x7fff9b1b6000 - 0x7fff9b222ff3 com.apple.Symbolication (61080.2) <8AB6B520-E8DE-392F-8B86-52098D2A2BA2> /System/Library/PrivateFrameworks/Symbolication.framework/Versions/A/Symbolication 0x7fff9b40b000 - 0x7fff9b437ff3 com.apple.framework.SystemAdministration (1.0 - 1.0) <335EB091-8DF2-3311-BF41-2A9C17ECAE66> /System/Library/PrivateFrameworks/SystemAdministration.framework/Versions/A/SystemAdministration 0x7fff9b619000 - 0x7fff9b61fff7 com.apple.TCC (1.0 - 1) <787E8FD8-21A7-39E6-87D4-6AD09156C5A0> /System/Library/PrivateFrameworks/TCC.framework/Versions/A/TCC 0x7fff9b6ab000 - 0x7fff9b86cff3 com.apple.TextureIO (1.35 - 1.35) <63D75E50-F3C2-3E8E-A49B-F53531C24C54> /System/Library/PrivateFrameworks/TextureIO.framework/Versions/A/TextureIO 0x7fff9b8e0000 - 0x7fff9b8e1fff com.apple.TrustEvaluationAgent (2.0 - 28) <6793B664-C4FC-3CD4-B0E7-25B9933391AC> /System/Library/PrivateFrameworks/TrustEvaluationAgent.framework/Versions/A/TrustEvaluationAgent 0x7fff9b8e2000 - 0x7fff9ba71ffb com.apple.UIFoundation (1.0 - 489) <0CD14719-FC52-3AC5-87EF-775437927990> /System/Library/PrivateFrameworks/UIFoundation.framework/Versions/A/UIFoundation 0x7fff9ca70000 - 0x7fff9ca72ffb com.apple.loginsupport (1.0 - 1) <03B57D6F-C210-32BC-B384-5B0E95660283> /System/Library/PrivateFrameworks/login.framework/Versions/A/Frameworks/loginsupport.framework/Versions/A/loginsupport 0x7fff9cac7000 - 0x7fff9cae2ff7 libCRFSuite.dylib (34) <BACC371B-6153-36B5-BC54-3BCF26FBB221> /usr/lib/libCRFSuite.dylib 0x7fff9cae3000 - 0x7fff9caeefff libChineseTokenizer.dylib (21) <09E74E18-ADB2-30D2-A858-13691CB1186C> /usr/lib/libChineseTokenizer.dylib 0x7fff9caef000 - 0x7fff9cb7fff7 libCoreStorage.dylib (540) <A1E0A6CD-EB83-3564-A905-19DBCC3EC70E> /usr/lib/libCoreStorage.dylib 0x7fff9cb80000 - 0x7fff9cb81ff3 libDiagnosticMessagesClient.dylib (102) <422911A4-E273-3E88-BFC4-DF6470E48242> /usr/lib/libDiagnosticMessagesClient.dylib 0x7fff9cb82000 - 0x7fff9cd95fff libFosl_dynamic.dylib (16.37) <D5551823-1E3D-3BDE-968C-BF022EE4958D> /usr/lib/libFosl_dynamic.dylib 0x7fff9cdb9000 - 0x7fff9cdb9fff libOpenScriptingUtil.dylib (172) <D025E180-BB3B-3FFA-98FC-B6835354D723> /usr/lib/libOpenScriptingUtil.dylib 0x7fff9cdba000 - 0x7fff9cdbdffb libScreenReader.dylib (477.10.20) <B48924E9-5301-3141-9D62-ADA2852D5BAA> /usr/lib/libScreenReader.dylib 0x7fff9cdbe000 - 0x7fff9cdbfff3 libSystem.B.dylib (1238) <CFC3669C-FB44-3A51-8815-1E84A168F3C5> /usr/lib/libSystem.B.dylib 0x7fff9ce2b000 - 0x7fff9ce56ffb libarchive.2.dylib (41.20.1) <FC116AC3-EB4A-3252-821C-4E1703879C82> /usr/lib/libarchive.2.dylib 0x7fff9ce57000 - 0x7fff9cf31fe7 libate.dylib (1.12.12) <1371D20C-3A80-37A5-AB94-09C4C4F67B01> /usr/lib/libate.dylib 0x7fff9cf35000 - 0x7fff9cf35ff3 libauto.dylib (187) <5BBF6A00-CC76-389D-84E7-CA88EDADE683> /usr/lib/libauto.dylib 0x7fff9cf36000 - 0x7fff9cf46ff3 libbsm.0.dylib (34) <20084796-B04D-3B35-A003-EA11459557A9> /usr/lib/libbsm.0.dylib 0x7fff9cf47000 - 0x7fff9cf55ff7 libbz2.1.0.dylib (38) <6FD3B63F-0F86-3A25-BD5B-E243F58792C9> /usr/lib/libbz2.1.0.dylib 0x7fff9cf56000 - 0x7fff9cfacff7 libc++.1.dylib (307.4) <BEE86868-F831-384C-919E-2B286ACFE87C> /usr/lib/libc++.1.dylib 0x7fff9cfad000 - 0x7fff9cfd7fff libc++abi.dylib (307.2) <1CEF8ABB-7E6D-3C2F-8E0A-E7884478DD23> /usr/lib/libc++abi.dylib 0x7fff9cfd8000 - 0x7fff9cfe8ffb libcmph.dylib (6) <2B5D405E-2D0B-3320-ABD6-622934C86ABE> /usr/lib/libcmph.dylib 0x7fff9cfe9000 - 0x7fff9cffeffb libcompression.dylib (34) <AEF908E6-C0FE-3884-BD45-FB37A035545D> /usr/lib/libcompression.dylib 0x7fff9cfff000 - 0x7fff9cfffff7 libcoretls.dylib (121.1.1) <F3BAB54C-DA82-37C3-A218-46FEB179D555> /usr/lib/libcoretls.dylib 0x7fff9d000000 - 0x7fff9d001ffb libcoretls_cfhelpers.dylib (121.1.1) <D12709F3-BBE3-3CF7-9070-C2A0803F5526> /usr/lib/libcoretls_cfhelpers.dylib 0x7fff9d0bb000 - 0x7fff9d19fff3 libcrypto.0.9.8.dylib (64) <4CB423CE-0B86-334A-9335-FEE75198024F> /usr/lib/libcrypto.0.9.8.dylib 0x7fff9d331000 - 0x7fff9d33cfff libcsfde.dylib (540) <F4208351-A781-35D5-B230-101CBA0F58E7> /usr/lib/libcsfde.dylib 0x7fff9d33d000 - 0x7fff9d390ff7 libcups.2.dylib (450) <04CA1F55-4B70-3D65-B4B1-62F6C271A9EF> /usr/lib/libcups.2.dylib 0x7fff9d391000 - 0x7fff9d3e0ff7 libcurl.4.dylib (95) <7FFE0024-36CD-3040-923F-1DE911FE5459> /usr/lib/libcurl.4.dylib 0x7fff9d40a000 - 0x7fff9d40afff libenergytrace.dylib (15) <A1B040A2-7977-3097-9ADF-34FF181EB970> /usr/lib/libenergytrace.dylib 0x7fff9d41a000 - 0x7fff9d41fff7 libheimdal-asn1.dylib (498.20.2) <C9B5464F-4A2E-3E3F-B514-B0911B5CB0DA> /usr/lib/libheimdal-asn1.dylib 0x7fff9d420000 - 0x7fff9d512ff7 libiconv.2.dylib (50) <42125B35-81D7-3FC4-9475-A26DBE10884D> /usr/lib/libiconv.2.dylib 0x7fff9d513000 - 0x7fff9d738fff libicucore.A.dylib (57132.0.1) <C8176937-9271-3F0E-829D-F3BBB9DD44B5> /usr/lib/libicucore.A.dylib 0x7fff9d73e000 - 0x7fff9d73ffff liblangid.dylib (126) <3F4530C9-8BE1-3AA7-9A82-98694D240866> /usr/lib/liblangid.dylib 0x7fff9d740000 - 0x7fff9d759ffb liblzma.5.dylib (10) <44BD0279-99DD-36B5-8A6E-C11432E2098D> /usr/lib/liblzma.5.dylib 0x7fff9d75a000 - 0x7fff9d770ff7 libmarisa.dylib (5) <2183D484-032D-3DE5-8984-3A14006E034E> /usr/lib/libmarisa.dylib 0x7fff9d771000 - 0x7fff9da1bfff libmecabra.dylib (744.2.2) <C6C3EA2C-1DC7-3DCB-8A20-C645E38524AB> /usr/lib/libmecabra.dylib 0x7fff9da4e000 - 0x7fff9dac7ff3 libnetwork.dylib (856.20.4) <5012EFF3-8FF4-317D-B328-AB21E3B5CA8C> /usr/lib/libnetwork.dylib 0x7fff9dac8000 - 0x7fff9de9d127 libobjc.A.dylib (706) <47104A1B-13E8-369F-BC36-27FF465809FD> /usr/lib/libobjc.A.dylib 0x7fff9de9e000 - 0x7fff9de9fff7 libodfde.dylib (23) <4DFCC459-2C07-38C6-871F-94DA3677F1EA> /usr/lib/libodfde.dylib 0x7fff9dea0000 - 0x7fff9dea4fff libpam.2.dylib (21) <352F8FF6-2248-3594-B357-8D031DEFB06C> /usr/lib/libpam.2.dylib 0x7fff9dea5000 - 0x7fff9ded5ff7 libpcap.A.dylib (67) <450DB888-2C0C-3085-A5F1-69324DFE902C> /usr/lib/libpcap.A.dylib 0x7fff9def3000 - 0x7fff9df0fffb libresolv.9.dylib (64) <A244AE4C-00B0-396C-98FF-97FE4DB3DA30> /usr/lib/libresolv.9.dylib 0x7fff9df4a000 - 0x7fff9df5cffb libsasl2.2.dylib (209) <5A177BA8-362D-32DA-8D14-69AB191648B3> /usr/lib/libsasl2.2.dylib 0x7fff9df5f000 - 0x7fff9e0a0ffb libsqlite3.dylib (252) <A531C105-64D7-37C0-B999-9320047B71C5> /usr/lib/libsqlite3.dylib 0x7fff9e18e000 - 0x7fff9e191ffb libutil.dylib (47.20.1) <CB688ED6-D995-34CB-A8EB-C42B20061F58> /usr/lib/libutil.dylib 0x7fff9e192000 - 0x7fff9e19ffff libxar.1.dylib (354) <AAFCF321-8100-3622-880B-9661DCA35D69> /usr/lib/libxar.1.dylib 0x7fff9e1a3000 - 0x7fff9e292ffb libxml2.2.dylib (30.11) <26676155-64CE-323F-B73C-AD77AF5982E8> /usr/lib/libxml2.2.dylib 0x7fff9e293000 - 0x7fff9e2bcfff libxslt.1.dylib (15.8) <FFF5DD45-F544-34B2-BE3C-DB877DC60081> /usr/lib/libxslt.1.dylib 0x7fff9e2bd000 - 0x7fff9e2ceff3 libz.1.dylib (67) <46E3FFA2-4328-327A-8D34-A03E20BFFB8E> /usr/lib/libz.1.dylib 0x7fff9e2dd000 - 0x7fff9e2e1ff7 libcache.dylib (79) <84E55656-FDA9-3B29-9E4F-BE31B2C0AA3C> /usr/lib/system/libcache.dylib 0x7fff9e2e2000 - 0x7fff9e2ecfff libcommonCrypto.dylib (60092.20.1) <31040F10-5E57-3B9C-8D5B-33AD87D1BEE8> /usr/lib/system/libcommonCrypto.dylib 0x7fff9e2ed000 - 0x7fff9e2f4fff libcompiler_rt.dylib (62) <486BDE52-81B4-3446-BD72-23977CAE556F> /usr/lib/system/libcompiler_rt.dylib 0x7fff9e2f5000 - 0x7fff9e2fdfff libcopyfile.dylib (138) <0DA49B77-56EC-362D-98FF-FA78CFD986D6> /usr/lib/system/libcopyfile.dylib 0x7fff9e2fe000 - 0x7fff9e380fdb libcorecrypto.dylib (442.20.2) <2684CC01-087E-33E2-8219-AAA3BBD9BFD7> /usr/lib/system/libcorecrypto.dylib 0x7fff9e381000 - 0x7fff9e3b3fff libdispatch.dylib (703.20.1) <877B505D-826C-3246-84F7-0F850636039E> /usr/lib/system/libdispatch.dylib 0x7fff9e3b4000 - 0x7fff9e3b9ff3 libdyld.dylib (421.2) <7BFA3476-6210-3BCB-8CE8-9B952F87BD84> /usr/lib/system/libdyld.dylib 0x7fff9e3ba000 - 0x7fff9e3baffb libkeymgr.dylib (28) <09CD7CA6-46D2-3A9F-B9F1-7C4CA5CA0D68> /usr/lib/system/libkeymgr.dylib 0x7fff9e3bb000 - 0x7fff9e3c7ffb libkxld.dylib (3789.21.3) <F12B5274-44AD-3268-A793-31EF351A4BD9> /usr/lib/system/libkxld.dylib 0x7fff9e3c8000 - 0x7fff9e3c8fff liblaunch.dylib (972.20.3) <7AB2E2EA-8B47-3420-87CE-5EE18A4EEE49> /usr/lib/system/liblaunch.dylib 0x7fff9e3c9000 - 0x7fff9e3cefff libmacho.dylib (894) <1EAE5ADD-490C-3B1F-9F97-447BA8E0E90F> /usr/lib/system/libmacho.dylib 0x7fff9e3cf000 - 0x7fff9e3d1ff3 libquarantine.dylib (85) <F3E47D7C-8776-327C-9426-DD7DEB30DBDD> /usr/lib/system/libquarantine.dylib 0x7fff9e3d2000 - 0x7fff9e3d3ffb libremovefile.dylib (45) <C4FC07FF-ED86-382E-B06F-33C34718080C> /usr/lib/system/libremovefile.dylib 0x7fff9e3d4000 - 0x7fff9e3ecff7 libsystem_asl.dylib (349.1.1) <F0987490-8427-367F-B302-A05A7D61FEBF> /usr/lib/system/libsystem_asl.dylib 0x7fff9e3ed000 - 0x7fff9e3edff7 libsystem_blocks.dylib (67) <B8C3701D-5A91-3D35-999D-2DC8D5393525> /usr/lib/system/libsystem_blocks.dylib 0x7fff9e3ee000 - 0x7fff9e47bfef libsystem_c.dylib (1158.20.4) <5F9531F5-EDA3-3D25-A827-3E0FD6B392BA> /usr/lib/system/libsystem_c.dylib 0x7fff9e47c000 - 0x7fff9e47fffb libsystem_configuration.dylib (888.20.5) <CDC55FCB-C1FC-350D-A919-5DBCFC835B63> /usr/lib/system/libsystem_configuration.dylib 0x7fff9e480000 - 0x7fff9e483fff libsystem_coreservices.dylib (41.2) <5DE691C6-7EE6-3210-895D-9EA3ECBC09B4> /usr/lib/system/libsystem_coreservices.dylib 0x7fff9e484000 - 0x7fff9e49cffb libsystem_coretls.dylib (121.1.1) <8F7E9B12-400D-3276-A9C5-4546B0258554> /usr/lib/system/libsystem_coretls.dylib 0x7fff9e49d000 - 0x7fff9e4a3fff libsystem_dnssd.dylib (765.20.4) <28E52C39-DF10-340F-A3EC-C0119AF6361F> /usr/lib/system/libsystem_dnssd.dylib 0x7fff9e4a4000 - 0x7fff9e4cdfff libsystem_info.dylib (503) <C686B834-5E7D-382C-AF6E-44AB78EE83E2> /usr/lib/system/libsystem_info.dylib 0x7fff9e4ce000 - 0x7fff9e4f0ff7 libsystem_kernel.dylib (3789.21.3) <EC53F92A-0DFA-3027-A220-414A01F17B2E> /usr/lib/system/libsystem_kernel.dylib 0x7fff9e4f1000 - 0x7fff9e538fe7 libsystem_m.dylib (3121.4) <7F86C291-B105-31C1-9923-90EBAB22B73F> /usr/lib/system/libsystem_m.dylib 0x7fff9e539000 - 0x7fff9e557ff7 libsystem_malloc.dylib (116) <F9840080-4C2C-3F3B-8087-7C738F12A1C7> /usr/lib/system/libsystem_malloc.dylib 0x7fff9e558000 - 0x7fff9e5afff3 libsystem_network.dylib (856.20.4) <2BAFB24F-999C-3148-BDD8-F28E05F716F7> /usr/lib/system/libsystem_network.dylib 0x7fff9e5b0000 - 0x7fff9e5b9ff3 libsystem_networkextension.dylib (563.20.3) <971DD3AD-D17A-32FF-95DE-0A5A979E68AE> /usr/lib/system/libsystem_networkextension.dylib 0x7fff9e5ba000 - 0x7fff9e5c3ff3 libsystem_notify.dylib (165.20.1) <EAD023A2-AD3F-31C8-9489-274B9A42DA61> /usr/lib/system/libsystem_notify.dylib 0x7fff9e5c4000 - 0x7fff9e5ccfe7 libsystem_platform.dylib (126.1.2) <2F2D6A81-C36C-353D-B27B-A6643A32375E> /usr/lib/system/libsystem_platform.dylib 0x7fff9e5cd000 - 0x7fff9e5d7ff7 libsystem_pthread.dylib (218.20.1) <46375095-4731-3034-9D87-396DE95FC697> /usr/lib/system/libsystem_pthread.dylib 0x7fff9e5d8000 - 0x7fff9e5dbff7 libsystem_sandbox.dylib (592.21.2) <2D42A2BF-A7AF-352A-A821-D8F6E85A63AC> /usr/lib/system/libsystem_sandbox.dylib 0x7fff9e5dc000 - 0x7fff9e5ddfff libsystem_secinit.dylib (24) <A54B8FEF-E792-3C54-8E0B-E80A376662F2> /usr/lib/system/libsystem_secinit.dylib 0x7fff9e5de000 - 0x7fff9e5e5fff libsystem_symptoms.dylib (532.1.1) <8FB7CA37-79EF-3651-B5B9-B5E1E0947067> /usr/lib/system/libsystem_symptoms.dylib 0x7fff9e5e6000 - 0x7fff9e606ff7 libsystem_trace.dylib (518.20.8) <C029B910-A65F-35F6-B194-B933B454EAB4> /usr/lib/system/libsystem_trace.dylib 0x7fff9e607000 - 0x7fff9e60cffb libunwind.dylib (35.3) <9F7C2AD8-A9A7-3DE4-828D-B0F0F166AAA0> /usr/lib/system/libunwind.dylib 0x7fff9e60d000 - 0x7fff9e636ff7 libxpc.dylib (972.20.3) <85EB25FD-218F-38EE-9E69-391CC8EBE6C5> /usr/lib/system/libxpc.dylibExternal Modification Summary: Calls made by other processes targeting this process: task_for_pid: 0 thread_create: 0 thread_set_state: 0 Calls made by this process: task_for_pid: 0 thread_create: 0 thread_set_state: 0 Calls made by all processes on this machine: task_for_pid: 50789 thread_create: 1 thread_set_state: 0VM Region Summary:ReadOnly portion of Libraries: Total=363.9M resident=0K(0%) swapped_out_or_unallocated=363.9M(100%)Writable regions: Total=147.3M written=0K(0%) resident=0K(0%) swapped_out=0K(0%) unallocated=147.3M(100%) VIRTUAL REGION REGION TYPE SIZE COUNT (non-coalesced) =========== ======= ======= Accelerate framework 128K 2 Activity Tracing 256K 2 CG backing stores 248K 3 CG image 8K 3 CoreUI image file 156K 4 Kernel Alloc Once 8K 2 MALLOC 114.9M 35 MALLOC guard page 32K 7 OpenGL GLSL 256K 4 STACK GUARD 56.0M 8 Stack 11.0M 8 VM_ALLOCATE 3892K 20 __DATA 24.0M 316 __GLSLBUILTINS 2588K 2 __IMAGE 528K 2 __LINKEDIT 140.0M 67 __TEXT 223.8M 292 __UNICODE 556K 2 mapped file 42.5M 7 shared memory 16.4M 15 =========== ======= ======= TOTAL 637.2M 781 Model: MacBookPro8,2, BootROM MBP81.0047.B2C, 4 processors, Intel Core i7, 2 GHz, 16 GB, SMC 1.69f4Graphics: Intel HD Graphics 3000, Intel HD Graphics 3000, Built-InGraphics: AMD Radeon HD 6490M, AMD Radeon HD 6490M, PCIe, 256 MBMemory Module: BANK 0/DIMM0, 8 GB, DDR3, 1333 MHz, 0x029E, 0x434D5341384758334D314131333333433920Memory Module: BANK 1/DIMM0, 8 GB, DDR3, 1333 MHz, 0x029E, 0x434D5341384758334D314131333333433920AirPort: spairport_wireless_card_type_airport_extreme (0x14E4, 0xD6), Broadcom BCM43xx 1.0 (5.106.98.100.24)Bluetooth: Version 5.0.1f7, 3 services, 17 devices, 1 incoming serial portsNetwork Service: Wi-Fi, AirPort, en1Serial ATA Device: TOSHIBA MK5065GSXF, 500,11 GBSerial ATA Device: MATSHITADVD-R UJ-8A8USB Device: USB 2.0 BusUSB Device: FaceTime HD Camera (Built-in)USB Device: HubUSB Device: Apple Internal Keyboard / TrackpadUSB Device: BRCM2070 HubUSB Device: Bluetooth USB Host ControllerUSB Device: USB 2.0 BusUSB Device: HubUSB Device: USB ReceiverUSB Device: IR ReceiverThunderbolt Bus: MacBook Pro, Apple Inc., 22.1Steps to Reproduce:1. Start up2. Have it crash.Actual Results: It crashesExpected Results:It shouldn't crashReproducible: SometimesUser Profile Reset: NoAdditional Info:After a couple of times having it crash, it seems to have stopped crashing. I can now open documents. I hope the crash reports leaves enough of a trail to stop this from happening.It seems LibreOffice keeps my GPU pegged to discrete, which sucks, but might be an unrelated issue. Why does an office suite need my heavy, energy-hungry GPU?User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36 I am of a mind to flag this as DUPLICATE ofEither it is a dup of that bug, which was seemingly resolved for most people when Apple updated OSX to 10.12.1, or in the alternative, the problem no longer exists for you as you indicate that LO no longer crashes, so this would be WFM.*** This bug has been marked as a duplicate of***@Nicolas : if you want to open a new bug report requesting that LO not require the discrete graphics chip (request for enhancement), be my guest - someone might hopefully take an interest one day.Unfortunately, it happened again today. So this might not be the same thing. Note that I _am_ running OSX 10.12.1 and LO 5.2.3 (release). I'll attach another crash report.CreatedSecond crash, macOS reportFunny observation, when I start "soffice" from the command-line, it starts up normally. Perhaps that's what I did earlier when I sad it started to work. Starting it from the Dock or Finder makes it crash reliably.This works:$ /Applications/LibreOffice.app/Contents/MacOS/sofficeRegrettably, starting it via Instruments (from xcode) also doesn't crash.My internet is too slow to download the gigantic LO repo so I loaded up LO in a debugger and disassembled Application::GetSolarMutex(), the function in which the sefault (NULL pointer) dereference happened:(lldb) disaslibvcllo.dylib`Application::GetSolarMutex:-> 0x102a823c0 <+0>: pushq %rbp 0x102a823c1 <+1>: movq %rsp, %rbp 0x102a823c4 <+4>: callq 0x102a85050 ; ImplGetSVData() 0x102a823c9 <+9>: movq 0x8(%rax), %rdi 0x102a823cd <+13>: movq (%rdi), %rax ; THIS IS THE OFFENDING LINE 0x102a823d0 <+16>: popq %rbp 0x102a823d1 <+17>: jmpq *0xa8(%rax) 0x102a823d7 <+23>: nopw (%rax,%rax)So, we expect to see a NULL pointer in %rdi, because it's trying to dereference that and placing it into %rax. Let's check the register state.Thread 0 crashed with X86 Thread State (64-bit): rax: 0x000000010b3989d0 rbx: 0x000060800005ec00 rcx: 0x0000608000115c30 rdx: 0x0000600000248640 rdi: 0x0000000000000000 rsi: 0x000000010b2a7d70 rbp: 0x00007fff5751a980 rsp: 0x00007fff5751a980 r8: 0x0000000000000000 r9: 0x0000000000000000 r10: 0x001faa01001faa80 r11: 0x000000010b1f2f50 r12: 0x0000000000000000 r13: 0x0000608000071380 r14: 0x0000600000248640 r15: 0x0000000000000000 rip: 0x000000010b1203cd rfl: 0x0000000000010202 cr2: 0x0000000000000000Indeed. %rdi is 0. Normally in such a short function I'd assume %rdi is the first argument, as detailed in the calling convention (). However, we can see that %rdi is actually *(%rax + 8). And %rax is the return value of the call to ImplGetSVData(). We know from the thread state that %rax contains 0x000000010b3989d0, which isn't very useful right now since we don't have a core dump. How is ImplGetSVData() implemented?EDIT: Got the sources.comphelper::SolarMutex& Application::GetSolarMutex(){ ImplSVData* pSVData = ImplGetSVData(); return *(pSVData->mpDefInst->GetYieldMutex());}So mpDefInst is somehow NULL. Why?(lldb) disas -n ImplGetSVDatalibvcllo.dylib`ImplGetSVData: 0x102a85050 <+0>: pushq %rbp 0x102a85051 <+1>: movq %rsp, %rbp 0x102a85054 <+4>: pushq %r14 0x102a85056 <+6>: pushq %rbx 0x102a85057 <+7>: movq 0x27596a(%rip), %rbx ; (anonymous namespace)::rtl_Instance<ImplSVData, rtl::Static<ImplSVData, (anonymous namespace)::private_aImplSVData>::StaticInstance, osl::Guard<osl::Mutex>, osl::GetGlobalMutex, int, int>::m_pInstance 0x102a8505e <+14>: testq %rbx, %rbx 0x102a85061 <+17>: jne 0x102a850f0 ; <+160> 0x102a85067 <+23>: callq 0x102b93dfa ; symbol stub for: osl_getGlobalMutex 0x102a8506c <+28>: movq %rax, %r14 0x102a8506f <+31>: movq (%r14), %rdi 0x102a85072 <+34>: callq 0x102b93d58 ; symbol stub for: osl_acquireMutex 0x102a85077 <+39>: movq 0x27594a(%rip), %rbx ; (anonymous namespace)::rtl_Instance<ImplSVData, rtl::Static<ImplSVData, (anonymous namespace)::private_aImplSVData>::StaticInstance, osl::Guard<osl::Mutex>, osl::GetGlobalMutex, int, int>::m_pInstance 0x102a8507e <+46>: testq %rbx, %rbx 0x102a85081 <+49>: jne 0x102a850e8 ; <+152> 0x102a85083 <+51>: movb 0x275ca7(%rip), %al ; guard variable for rtl::Static<ImplSVData, (anonymous namespace)::private_aImplSVData>::StaticInstance::operator()()::instance 0x102a85089 <+57>: testb %al, %al 0x102a8508b <+59>: jne 0x102a850da ; <+138> 0x102a8508d <+61>: leaq 0x27593c(%rip), %rbx ; rtl::Static<ImplSVData, (anonymous namespace)::private_aImplSVData>::StaticInstance::operator()()::instance 0x102a85094 <+68>: movl $0x360, %esi ; imm = 0x360 0x102a85099 <+73>: movq %rbx, %rdi 0x102a8509c <+76>: callq 0x102b948f8 ; symbol stub for: __bzero 0x102a850a1 <+81>: movw $0x100, 0x275bee(%rip) ; rtl::Static<ImplSVData, (anonymous namespace)::private_aImplSVData>::StaticInstance::operator()()::instance + 708, imm = 0x100 0x102a850aa <+90>: movl $0xffffffff, 0x275c0c(%rip) ; rtl::Static<ImplSVData, (anonymous namespace)::private_aImplSVData>::StaticInstance::operator()()::instance + 748, imm = 0xFFFFFFFF 0x102a850b4 <+100>: movw $0x4000, 0x275c07(%rip) ; rtl::Static<ImplSVData, (anonymous namespace)::private_aImplSVData>::StaticInstance::operator()()::instance + 752, imm = 0x4000 0x102a850bd <+109>: leaq 0xeec(%rip), %rdi ; ImplSVData::~ImplSVData() 0x102a850c4 <+116>: leaq -0x2ce0cb(%rip), %rdx 0x102a850cb <+123>: movq %rbx, %rsi 0x102a850ce <+126>: callq 0x102b948fe ; symbol stub for: __cxa_atexit 0x102a850d3 <+131>: movb $0x1, 0x275c56(%rip) ; rtl::Static<ImplSVData, (anonymous namespace)::private_aImplSVData>::StaticInstance::operator()()::instance + 863 0x102a850da <+138>: leaq 0x2758ef(%rip), %rbx ; rtl::Static<ImplSVData, (anonymous namespace)::private_aImplSVData>::StaticInstance::operator()()::instance 0x102a850e1 <+145>: movq %rbx, 0x2758e0(%rip) ; (anonymous namespace)::rtl_Instance<ImplSVData, rtl::Static<ImplSVData, (anonymous namespace)::private_aImplSVData>::StaticInstance, osl::Guard<osl::Mutex>, osl::GetGlobalMutex, int, int>::m_pInstance 0x102a850e8 <+152>: movq (%r14), %rdi 0x102a850eb <+155>: callq 0x102b93e66 ; symbol stub for: osl_releaseMutex 0x102a850f0 <+160>: movq %rbx, %rax 0x102a850f3 <+163>: popq %rbx 0x102a850f4 <+164>: popq %r14 0x102a850f6 <+166>: popq %rbp 0x102a850f7 <+167>: retq 0x102a850f8 <+168>: movq %rax, %rdi 0x102a850fb <+171>: callq 0x1027bc6f0 ; __clang_call_terminateWell, that's annoying... The code?ImplSVData* ImplGetSVData() { return &private_aImplSVData::get();}Heavily inlined. And private_aImplSVData is?namespace{ struct private_aImplSVData : public rtl::Static<ImplSVData, private_aImplSVData> {};}What the...? I have no idea what this is. A class inheriting from a class that takes two template parameters, including itself (Curiously Recurring Template Pattern?). Sure. The strange thing is that private_aImplSVData is mentioned only on the 3 lines I've already printed out. It's empty. I suppose ImplSVData is the true meat here, then. It's defined as:struct ImplSVData{ SalData* mpSalData = nullptr; SalInstance* mpDefInst = nullptr; // Default SalInstance Application* mpApp = nullptr; // pApp VclPtr<WorkWindow> mpDefaultWin; // Default-Window bool mbDeInit = false; // Is VCL deinitializing // Tons of stuff more.}Right, so the second pointer plainly never gets initialized.Anyway, back to this rtl::Static thingy, which I assume is some sort of fancy wrapper to make a singleton out of everything, the Java programmers' dream. It's a doozy, we find it in core/include/rtl/instance.hxx:/** Helper base class for a late-initialized (default-constructed) static variable, implementing the double-checked locking pattern correctly. @derive Derive from this class (common practice), e.g. <pre> struct MyStatic : public rtl::Static<MyType, MyStatic> {}; ... MyType & rStatic = MyStatic::get(); ... </pre> @tparam T variable's type @tparam Unique Implementation trick to make the inner static holder unique, using the outer class (the one that derives from this base class)*/#if HAVE_THREADSAFE_STATICStemplate<typename T, typename Unique>class Static {public: /** Gets the static. Mutual exclusion is implied by a functional -fthreadsafe-statics @return static variable */ static T & get() { static T instance; return instance; }};#elsetemplate<typename T, typename Unique>class Static {public: /** Gets the static. Mutual exclusion is performed using the osl global mutex. @return static variable */ static T & get() { return *rtl_Instance< T, StaticInstance, ::osl::MutexGuard, ::osl::GetGlobalMutex >::create( StaticInstance(), ::osl::GetGlobalMutex() ); }private: struct StaticInstance { T * operator () () { static T instance; return &instance; } };};#endifOne very interesting thing to note here is that the disassembly of ImplGetSVData I posted earlier contained calls to ::osl::GetGlobalMutex. Which means that for some reason on macOS Sierra, something thinks we don't HAVE_THREADSAFE_STATICS. I'm pretty sure we do on macOS Sierra, with any recent GCC or Clang for sure, and I bet this one was built with xcode (thus Clang).This () SO answer implies that -f(no-)threadsafe-statics flag is GCC specific. Indeed I can't find it in my clang(1) man page. So that might be another "bug", basically assuming that the compiler is GCC.I won't even paste the code of rtl_Instance here (it's in the same file), but suffice to say that a lot of text is spent on indicating how/why it can be optimized on which compilers. Just avoiding this shenanigans would thus be a good optimization, it seems.Anyhow. It's pretty clear that our ImplSVData is just not being initialized, and it's being called for the first time by GetSolarMutex, which obviously didn't expect an uninitialized ImplSVData back.The LO codebase is not familiar to me, so I'll leave it to someone with experience to figure out why ImplSVData is not being initialized.ThanksBy the way, normally I'd set a watchpoint on the variable I want within a successful run to see how it's supposed to be initialized. Sadly, I'd need to set a watchpoint on this now: 0x102a850e1 <+145>: movq %rbx, 0x2758e0(%rip) ; (anonymous namespace)::rtl_Instance<ImplSVData, rtl::Static<ImplSVData, (anonymous namespace)::private_aImplSVData>::StaticInstance, osl::Guard<osl::Mutex>, osl::GetGlobalMutex, int, int>::m_pInstanceMore anaonymous namespaces than I can count. This is where my knowledge of LLDB stops. If anyone has an idea how to set a watchpoint on that, I'm all ears.I'm getting more and more the feeling like this is some weird synchronization issue.GOOD: /Applications/LibreOffice.app/Contents/MacOS/sofficeGOOD: lldb /Applications/LibreOffice.app/Contents/MacOS/sofficeBAD: Open from dockBAD: Open from spotlightSo I couldn't debug it while it was in a bad state, I thought. Then I tried the next best thing: debug it as fast as possible. while : ; do if pgrep soffice ; then lldb -p $(pgrep soffice) ; fi ; doneIt's crude, but it works. Basically, attach to libreoffice as fast as possible after startup.I did: lldb> b CreateSalInstanceTo see whether it was actually being called (that's the thing that creates the object that gets assigned to mpDefInst). See core/vcl/source/app/svmain.cxx: // Initialize Sal pSVData->mpDefInst = CreateSalInstance(); if ( !pSVData->mpDefInst ) return false;It's also one of only 3 lines that modify it: $ ag 'mpDefInst =' core/vcl/inc/svdata.hxx:312: SalInstance* mpDefInst = nullptr; // Default SalInstance core/vcl/source/app/svmain.cxx:290: pSVData->mpDefInst = CreateSalInstance(); core/vcl/source/app/svmain.cxx:587: pSVData->mpDefInst = nullptr;Anyway, I ran it and it stopped at CreateSalInstance, indicating it was being called. Continuing the process afterwards made it keep going without a crash. Rats, I seem to have turned a "bad" invocation into a good one by debugging it.Next time, I tried putting a breakpoint on DeInitVCL, which is where mpDefInst gets reset to NULL. However, after setting the breakpoint, the process crashed with the well known bad access. So not every bad invocation turns good... or was it because I set the breakpoint on a different function? Process 34503 stopped * thread #1: tid = 0x60fec, 0x00007fff9e4e041a libsystem_kernel.dylib`mach_msg_trap + 10, queue = 'com.apple.main-thread', stop reason = signal SIGSTOP frame #0: 0x00007fff9e4e041a libsystem_kernel.dylib`mach_msg_trap + 10 libsystem_kernel.dylib`mach_msg_trap: -> 0x7fff9e4e041a <+10>: retq 0x7fff9e4e041b <+11>: nop libsystem_kernel.dylib`mach_msg_overwrite_trap: 0x7fff9e4e041c <+0>: movq %rcx, %r10 0x7fff9e4e041f <+3>: movl $0x1000020, %eax ; imm = 0x1000020 Executable module set to "/Applications/LibreOffice.app/Contents/MacOS/soffice". Architecture set to: x86_64-apple-macosx. (lldb) b DeInitVCL Breakpoint 1: where = libvcllo.dylib`DeInitVCL(), address = 0x00000001118e8720 (lldb) run There is a running process, detach from it and restart?: [Y/n] n (lldb) cont Process 34503 resuming (lldb) Traceback (most recent call last): Process 34503 stopped * thread #1: tid = 0x60fec, 0x00000001118e43cd libvcllo.dylib`Application::GetSolarMutex() + 13, queue = 'com.apple.main-thread', stop reason = EXC_BAD_ACCESS (code=1, address=0x0) frame #0: 0x00000001118e43cd libvcllo.dylib`Application::GetSolarMutex() + 13 libvcllo.dylib`Application::GetSolarMutex: -> 0x1118e43cd <+13>: movq (%rdi), %rax 0x1118e43d0 <+16>: popq %rbp 0x1118e43d1 <+17>: jmpq *0xa8(%rax) 0x1118e43d7 <+23>: nopw (%rax,%rax) (lldb)Bingo. It's not exactly what I wanted, but at least I can see what's actually filled in in the ImplSVData struct returned by ImplGetSVData() now. Remembering that %rax contains a pointer to the ImplSVData. (lldb) memory read --size 8 --format x --count 8 $rax 0x111b5c9d0: 0x00007fb4d7800000 0x0000000000000000 0x111b5c9e0: 0x00007fff50d67bd0 0x0000000000000000 0x111b5c9f0: 0x0000000000000000 0x0000000000000000 0x111b5ca00: 0x0000000000000000 0x0000000000000000Taking its data layout by hand again: struct ImplSVData { SalData* mpSalData = nullptr; SalInstance* mpDefInst = nullptr; // Default SalInstance Application* mpApp = nullptr; // pApp VclPtr<WorkWindow> mpDefaultWin; // Default-Window bool mbDeInit = false; // Is VCL deinitializing // Tons of stuff more. }Which basically tells me everything is NULL/false/... except for mpSalData and mpApp. Some digging teaches us that mpSalData and mpApp are always set together, so that makes sense. That's done here: Application::Application() { // useful for themes at least, perhaps extensions too OUString aVar("LIBO_VERSION"), aValue(LIBO_VERSION_DOTTED); osl_setEnvironment(aVar.pData, aValue.pData); ImplGetSVData()->mpApp = this; InitSalData(); }Apparently, a global variable is set with the object that's being constructed (->mpApp = this). Neat. InitSalData() does something similar, but for ->mpSalData.At this point I'm pretty sure that the InitVCL() code ran: bool InitVCL() { if( pExceptionHandler != nullptr ) return false; EmbeddedFontsHelper::clearTemporaryFontFiles(); if( !ImplGetSVData()->mpApp ) { pOwnSvApp = new Application(); } InitSalMain(); ImplSVData* pSVData = ImplGetSVData(); // remember Main-Thread-Id pSVData->mnMainThreadId = ::osl::Thread::getCurrentIdentifier(); // Initialize Sal pSVData->mpDefInst = CreateSalInstance(); if ( !pSVData->mpDefInst ) return false; // ...But why is mpDefInst NULL then, in our bad runs? Are two threads racing? One trying to initialize everything (InitVCL) and the other somewhere calling GetSolarMutex()? If that's the case, that should be visible in our other thread stacktraces. It was a good theory, but using "thread backtrace all" tells me that's not the case. Argh.Wow, quite a lot of debugging information there. As I'm not a dev, I'm putting Michael on CC, he might have an idea of what is going on here if there is a scheduler problem somewhere.@Michael : any idea, perchance ?I can confirm the crash. It did happen to me also, but didn't think much about it. I thought I triggered it myself somehow. I did catch it in a debug run with LO Version: 5.3.0.0.alpha1+Build ID: f9f1042773795aa82bc0034122fac8271e3dabc7CPU Threads: 4; OS Version: Mac OS X 10.12.1; UI Render: default; Layout Engine: old; Locale: nl-NL (nl_NL.UTF-8); Calc: groupCreatedSAL_LOG=+TIMESTAMP+INFO,+WARNCreatedMacOS crash reportNicolas - wow, great analysis work here; would be good to have a debugging trace with debug information (I guess). You seem to have got a good grasp of how the VCL backend is created - nice code-reading; of course - why this blows up as it tries to take the SolarMutex I have no idea - would be good to poke around at the global ImplSvData instances after the crash (?) ideally with debuginfo for nice type dumping etc. (?)Telesto - thanks for the trace- - but I believe it is an un-related crash:Thanks for chasing ! also - if you need interactive help #libreoffice-dev on irc.freenode.net is the best place ... I'm 'mmeeks' there.CreatedMacOS crash reportCorrect MacOS crash reportMaybe I'm wrong but is there some relation with? It sounds similar to me.CreatedSAL_LOG=+TIMESTAMP+INFO+WARNThis issue is quite easy the reproduce. The only thing needed is high CPU usage when starting LO.CreatedLLDB backtraceMaybe its helpful.The trace with symbols is beautiful - thanks Telesto - and the solution (I guess) is fairly trivial:libvcllo.dylib`SolarMutexGuard::SolarMutexGuard(this=0x00007fff5fbfd670) + 21 at svapp.hxx:1410 frame #3: 0x0000000107a16577 libvcllo.dylib`::-[VCL_NSApplication screenParametersChanged:](self=0x000000010ffba610, _cmd="screenParametersChanged:", pNotification=0x00000001110008f0) + 55 at vclnsapp.mm:450 frame #4: 0x00007fff809c259c CoreFoundation`__CFNOTIFICATIONCENTER_IS_CALLING_OUT_TO_AN_OBSERVER__ + 12 frame #5: 0x00007fff809c249b CoreFoundation`_CFXRegistrationPost + 427...... frame #22: 0x00007fff7e5f31ad AppKit`NSApplicationMain + 1237 frame #23: 0x00000001078ca89a libvcllo.dylib`ImplSVMainHook(pnInit=0x00007fff5fbff954) + 522 at salinst.cxx:211bool ImplSVMainHook( int * pnInit ){... const char* pArgv[] = { aByteExe.getStr(), nullptr };** NSApplicationMain( 1, pArgv );} I guess we are not expecting this to go emitting events - or somesuch. frame #24: 0x000000010776c37c libvcllo.dylib`SVMain() + 44 at svmain.cxx:220int SVMain(){ int nRet;** if( !Application::IsConsoleOnly() && ImplSVMainHook( &nRet ) ) return nRet; else return ImplSVMain();} frame #25: 0x0000000100241606 libsofficeapp.dylib`::soffice_main() + 534 at sofficemain.cxx:165 frame #26: 0x0000000100000efd soffice`sal_main + 13 at main.c:48We are called-back by events from main before we have initialized VCL and before we have setup the SolarMutex - which is somewhat silly =) We expect ImplSVMain:int ImplSVMain(){ // The 'real' SVMain() ImplSVData* pSVData = ImplGetSVData(); SAL_WARN_IF( !pSVData->mpApp, "vcl", "no instance of class Application" ); int nReturn = EXIT_FAILURE; bool bInit = isInitVCL() || InitVCL();To initialize and setup VCL.So - I guess the question is - why do we have this hook ? (would be good to read the git annotate / logs for the init hook) - and why do we get events during that 'Main' call, and what is the best fix - is it to initialize the solar mutex earlier ? or ... unclear =) Tor may have some quick ideas =)***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***I'm far from an expert reading debug information, but I created a list of warning/errors I found in the back trace which I suppose shouldn't be there. It's quite possible that some of the things I noticed, don't cause this crash in particular (but there could be a relation with the list of outstanding macOS related issues) CoreFoundation`_CFXNotificationPost __THE_PROCESS_HAS_FORKED_AND_YOU_CANNOT_USE_THIS_COREFOUNDATION_FUNCTIONALITY___YOU_MUST_EXEC__\@"*** attempt to post distributed notification '%s' thwarted by sandboxing.%s%s"\CoreFoundation`CFRunLoopRunSpecific:__THE_PROCESS_HAS_FORKED_AND_YOU_CANNOT_USE_THIS_COREFOUNDATION_FUNCTIONALITY___YOU_MUST_EXEC__\AppKit`_DPSNextEvent:@"Could not alloc empty CGEvent"\"CGEventRef _DPSCreateCGEventFromCarbonEvent(EventRef)"  @"<Unknown Function>""/Library/Caches/com.apple.xbs/Sources/AppKit/AppKit-1504.60/GraphicsContext.subproj/CGDPSReplacement.m" --> @"<Unknown File>"@"AppKit cannot convert carbon event class '%.4s' to CGEventRef."\@"AppKit cannot convert carbon mouse event of kind '%ld' to CGEventRef."\@"AppKit cannot convert carbon mouse events of button '%ld' to CGEventRef."\@"got unrecognized event, eventClass is %x, eventKind is %d"\_DPSNextEvent.has_ConvertMatchingCGEvents -> @"found event in concurrent event queue, looping around to get it"\CGEventGetIntegerValueField --> @"Force event behavior:%d"\AppKit`NS ApplicationMain:@"NSDelegateClass" --> @"No Info.plist file in application bundle or no NSPrincipalClass in the Info.plist file, exiting"\@"Initial Storyboard controller is neither a NSWindowController nor a NSViewController: %@, from %@"\@"Unable to load nib file: %@, exiting"\Telesto - the cause is pretty clear; cf. my analysis in #21 - but why this hook exists, and why it goes processing events so early is very unclear.I have never understood *why* OOo (and what now then is LO) is structured to work on the Mac the way it is. Presumably this was never documented back when it was done. Was it ericb who did this work back in the days? Or Sun people? Did they leave any readable longer documentation or even some a condensed rationale?My guess is that they wanted the VCL code on Mac, once contortions at start-up have been done, to behave as if it was on an X-style windowing system, and they did some ugly hacks to make it seem so while having to touch as little code elsewhere as possible.Possibly it would have made more sense to actually make OOo be structured like a canonical Mac app, and instead adapt more code all over the place (vcl, framework, whatever) to work both in that case and in the X and Win32 cases.Not sure whether the Windows code manages more successfully to merge concepts of two fundamentally different windowing systems?Or am I confused/misguided, is it in fact so that it is the X code that jumps through hoops to be Windows-like? (And the Mac code too, then.) And the Windows code which is most "native" and has least weird tricks?I suspect hdu could be the best person to spread some light here, but he is not involved any more, is he?Useful keyword to google for are: ericb, ooo, aqua, port. (For some reason the OOo project to make it run natively (as opposed to using X11) on Mac OS X was called the "Aqua" port, even if, as far as I understand it, "Aqua" was just the name of the desktop theme of the time, and never has been the name of any API.)I’m far of an expert, and I don’t want to intrude. But maybe it’s wise to investigate the cause a bit more deeply, before acting. I should note that:- I have two macOS 10.12.1 installations: one for testing, one for regular usage. Only the testing system, on which I installed XCode, is badly affected. It seems to be some sort of file corruption, because I have trouble with all versions I tested (4.4/5.0)- On my regular system I have had some issues with a few daily builds (around 5 November) crashing SIGSEGV 11 on launch, but I haven’t had an issue with LO 5.2.3.3 or more recent daily builds.- On my regular system I’m able to crash Activity Monitor with SIGSEGV 11 in some circumstances while starting LibreOfficeDev, but I’m not sure whether it’s related.CreatedmacOS crashreports Activity MonitorIn my experience LO runs once after installing and then crashes every time afterwards. For a time I also associated this with installing the language pack (PL in my case), but it seems to have no bearing (I was simply installing LO, running it once and then installing the language pack, running it again and crash).The workaround mentioned by someone on IRC to disable graphics card switching in power saving options works for me.I'm on MBP 6,2 (dual graphics Intel and Nvidia 330M), macOS Sierra 10.12.1, trying to use LO 5.2.3.3.I also have a Mac Pro at work which I think had the crashing, too, despite not having dual graphics. I'll try to look into it tomorrow.Is it time to confirm the bug?@Dominik: Thanks for the additional input. This bug is NEW since it has been confirmed on 2016-11-07. No need to confirm further.Using a newly created User Account seems to fix the issue ()(In reply to Telesto from)Ah, that is interesting. I'll try in a sec.My Mac Pro runs LO just fine. It doesn't come with switching graphics.I just tested with a new user profile on my MBP. LO ran just fine, but it turns out the new account had graphics switching turned off by default. Turning it on, LO started crashing at once.(In reply to Dominik from)Sounds like.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Alex How can this be a duplicate? I can reproduce the problem and the solution every time. I'm running MACOS X 10.12.2 and LibreOffice 5.2.4 (Newly Released).These are the steps I go through every time and if I bring it up this way it works.Closing the Terminal.app, under the Utilities folder, will terminate the entire "LIbreOffice" program, but The Terminal Window remains open.I don't know if I'm explaining this so anyone can understand it, because I'm not (by profession), a programmer. However, I can see somewhere in the compiled version of "soffice" Exec file, the script is telling the Terminal.app to exec first, THEN to execute LIbreOffice.Here's how I now have to use this application:1. I execute "soffice" from the MacOS folder in the Contents folder2. I Wait for the Terminal.app to execute and bring up the Terminal Window3. I keep the Terminal.app running paying attention to the messages printed in the window.4. After a short time Maybe 5 second) LibreOffice comes up "Normally"5. Using the "Quit LIbreOffice" on the menu file, I can see the Terminal.app being told to exit and LibreOffice ends.If the Terminal.app is not running, LibreOffice will crash every time.Also, if you try and execute LibreOffice in the Applications Folder, it will crash every time.ADDITIONAL INFORMATION:Below is what I saw on the "Terminal" Window as LibreOffice executes from the MAC OS directory using the soffice Exec file."Last login: Sat Jan 7 13:12:59 on console-bash: PATH: command not found-bash: PATH: command not found/Applications/LibreOffice.app/Contents/MacOS/soffice ; exit;Macintosh:~ millersranch$ /Applications/LibreOffice.app/Contents/MacOS/soffice ; exit;"Below are the results returned and printed to the Terminal window screen after you've pressed "Quit LibreOffice" in the application.logoutSaving session......copying shared history......saving history...truncating history files......completed.Deleting expired sessions...none found.[Process completed]Please NOTE: After the [Process completed] statement, the Terminal App stays open. You have to close it manually.This Bug reports something about the "User Profile" and something about a "Switch" being set to "ON". I don't know where this switch is and I have deleted previous User profiles from the LibreOffice/4/user directory. If there is a "Patch" for this, I don't know where to find it. Seeing how this Bug is also happening under MacOS 10.12.2 and continues under LibreOffice 5.2.4.1, tells me this can't be the same problem as reported here. I don't need to change a "Switch" or my "User Profile" to use the application as described above. This problem appears to be a PATH statement problem as indicated by the Terminal Results:-bash: PATH: command not found-bash: PATH: command not foundI can use the application this way without changing any of the things mentioned in this Bug report. I don't have any stack trace/backtrace software to print out the errors or how the program is executing. I just know it works every time when I apply the procedure above. I will continue to use it this way, until someone figures out why the "LibreOffice.app doesn't work from the Applications directory.The crash seems to occur in three situations:1. Systems with dual graphics chips and "Automatic graphics switching" enabled2. A change in the default profile configuration (I suspect non-default bash settings)3. Restarting a Mac while running LibreOffice and "Reopening windows when logging back in" selected (and the first two situations don’t apply)I don’t have a dual graphic system. So can't help there. I can confirm howeveris working for point 2. Console output when starting:demos-MacBook-Air:~ demo$ /Applications/LibreOfficeDev2017.app/Contents/MacOS/sofficewarn:sfx.control:528:1:sfx2/source/control/dispatch.cxx:562: Unflushed dispatcher!Console output when closingwarn:sfx.control:528:1:sfx2/source/control/dispatch.cxx:562: Unflushed dispatcher!warn:sal.osl.pipe:528:1:sal/osl/unx/pipe.cxx:395: shutdown() failed: Socket is not connectedwarn:sal.osl.pipe:528:3:sal/osl/unx/pipe.cxx:436: accept() failed: Software caused connection abortwarn:unotools.config:528:1:unotools/source/config/configmgr.cxx:167: ConfigManager not emptyVersion: 5.4.0.0.alpha0+Build ID: 2d54ffbf18d461c846535d539d704d45aff059b1CPU Threads: 4; OS Version: Mac OS X 10.12.2; UI Render: default; Locale: en-US (en_US.UTF-8); Calc: groupTemporary fix for the user profile related crashes: Disabling JAVA will prevent most/all crashes. LibreOffice -> Preferences -> Advanced -> Deselect "Use a Java runtime environment"Please when you update or add comments to this post, you specify if you're referring to the Windows OS or MACOS. I've tried the suggested fix inon my MacBook Pro and nothing changed.It would be very helpful to include the steps you took to make this "Temporary Fix" successful.Example:1. Start Libreoffice2. Select Preferences3. Select Advanced4. Under Java Options, Uncheck "Use Java Runtime Environment"5. ....Here it should be noted whether you need to restart your Computer or just LibreOffice to have these changes take effect.After this box was unchecked, I closed LO and tried to restart the program without shutting down the Computer. The results were LO still crashed.I feel these types of comments will help everyone track this problem.Update:After Deselecting the JAVA Runtime environment, LO did work on the first try after the MAC was restarted. However, further attempts to use the application failed. I've gone back to starting/using LO the way it works for me.In 5.2.2, I was able to work around the problem by reopening. It would stay open the second time each day.In 5.2.5, I am not able to work around the problem.Each time, MacOS verifies LibreOffice, then LibreOffice opens and crashes.(In reply to Telesto from)I don't ever remember selecting that, but I reinstalled 5.2.2, found and deselected that, reopened 5.2.5 in the dmg, and had it crash again.
id=104107	Description:Opening any Base file in LO5233 previously created with an older version of LibreOffice, i.e. before 5233, causes that file to become corrupted on closing and shutting down of LibreOffice, even if no changes have occurred in the database file. Even LO5233 can no longer display any of the objects within the file if is subsequently re-opened in LO5233. An error message is displayed.Steps to Reproduce:1. Open an ODB file created with a previous version of Base in LO52332. Click on Tables3. Make no changes, close the file.4. Close LibreOffice5. Re-start LibreOffice6. Load the same ODB file7. Try clicking on the Tables icon - an error message is displayed, but no table list8. Try any other db object that was previously available in the file (queries, reports, etc) - the same error message is displayed.Actual Results: The ODB file has been corrupted and will not open in any other version of LibreOffice.Expected Results:The file should open in any other version of LibreOffice without incident.Reproducible: AlwaysUser Profile Reset: NoAdditional Info:User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:49.0) Gecko/20100101 Firefox/49.0 Seeing this in lldb :Process 877 launched: '/Applications/LibreOffice.app/Contents/MacOS/soffice' (x86_64)2016-11-22T12:43:27.530+0100 SEVERE DataFileCache.reset commitjava.io.IOException: No OutputStream at com.sun.star.sdbcx.comp.hsqldb.NativeStorageAccess.write(Native Method) at com.sun.star.sdbcx.comp.hsqldb.StorageAccess.write(StorageAccess.java:86) at com.sun.star.sdbcx.comp.hsqldb.StorageAccess.writeLong(StorageAccess.java:124) at org.hsqldb.persist.RAStorageWrapper.writeLong(Unknown Source) at org.hsqldb.persist.DataFileCache.reset(Unknown Source) at org.hsqldb.persist.Log.checkpointClose(Unknown Source) at org.hsqldb.persist.Log.checkpoint(Unknown Source) at org.hsqldb.persist.Log.checkpoint(Unknown Source) at org.hsqldb.persist.Logger.checkpointInternal(Unknown Source) at org.hsqldb.persist.Logger.checkpoint(Unknown Source) at org.hsqldb.persist.Logger.open(Unknown Source) at org.hsqldb.Database.reopen(Unknown Source) at org.hsqldb.Database.open(Unknown Source) at org.hsqldb.DatabaseManager.getDatabase(Unknown Source) at org.hsqldb.DatabaseManager.newSession(Unknown Source) at org.hsqldb.jdbc.JDBCConnection.<init>(Unknown Source) at org.hsqldb.jdbc.JDBCDriver.getConnection(Unknown Source) at org.hsqldb.jdbc.JDBCDriver.connect(Unknown Source)2016-11-22T12:43:27.559+0100 SEVERE checkpoint failed - recoveredorg.hsqldb.HsqlException: file input/output errorerror java.io.IOException: No OutputStream closing file - file /Users/alex/Downloads/copie.odb.data at org.hsqldb.error.Error.error(Unknown Source) at org.hsqldb.persist.DataFileCache.reset(Unknown Source) at org.hsqldb.persist.Log.checkpointClose(Unknown Source) at org.hsqldb.persist.Log.checkpoint(Unknown Source) at org.hsqldb.persist.Log.checkpoint(Unknown Source) at org.hsqldb.persist.Logger.checkpointInternal(Unknown Source) at org.hsqldb.persist.Logger.checkpoint(Unknown Source) at org.hsqldb.persist.Logger.open(Unknown Source) at org.hsqldb.Database.reopen(Unknown Source) at org.hsqldb.Database.open(Unknown Source) at org.hsqldb.DatabaseManager.getDatabase(Unknown Source) at org.hsqldb.DatabaseManager.newSession(Unknown Source) at org.hsqldb.jdbc.JDBCConnection.<init>(Unknown Source) at org.hsqldb.jdbc.JDBCDriver.getConnection(Unknown Source) at org.hsqldb.jdbc.JDBCDriver.connect(Unknown Source)Caused by: java.io.IOException: No OutputStream at com.sun.star.sdbcx.comp.hsqldb.NativeStorageAccess.write(Native Method) at com.sun.star.sdbcx.comp.hsqldb.StorageAccess.write(StorageAccess.java:86) at com.sun.star.sdbcx.comp.hsqldb.StorageAccess.writeLong(StorageAccess.java:124) at org.hsqldb.persist.RAStorageWrapper.writeLong(Unknown Source) ... 14 more2016-11-22T12:43:27.561+0100 SEVERE checkpoint failed - see previous error2016-11-22T12:44:19.578+0100 SEVERE DataFileCache.reset commitjava.io.IOException: No OutputStream at com.sun.star.sdbcx.comp.hsqldb.NativeStorageAccess.write(Native Method) at com.sun.star.sdbcx.comp.hsqldb.StorageAccess.write(StorageAccess.java:86) at com.sun.star.sdbcx.comp.hsqldb.StorageAccess.writeLong(StorageAccess.java:124) at org.hsqldb.persist.RAStorageWrapper.writeLong(Unknown Source) at org.hsqldb.persist.DataFileCache.reset(Unknown Source) at org.hsqldb.persist.DataFileCache.close(Unknown Source) at org.hsqldb.persist.DataFileCache.defrag(Unknown Source) at org.hsqldb.persist.Log.defrag(Unknown Source) at org.hsqldb.persist.Log.checkpoint(Unknown Source) at org.hsqldb.persist.Logger.checkpointInternal(Unknown Source) at org.hsqldb.persist.Logger.checkpoint(Unknown Source) at org.hsqldb.StatementCommand.getResult(Unknown Source) at org.hsqldb.StatementCommand.execute(Unknown Source) at org.hsqldb.Session.executeCompiledStatement(Unknown Source) at org.hsqldb.Session.executeDirectStatement(Unknown Source) at org.hsqldb.Session.execute(Unknown Source) at org.hsqldb.jdbc.JDBCStatement.fetchResult(Unknown Source) at org.hsqldb.jdbc.JDBCStatement.execute(Unknown Source)2016-11-22T12:44:19.751+0100 SEVERE DataFileCache.reset commitjava.io.IOException: No OutputStream at com.sun.star.sdbcx.comp.hsqldb.NativeStorageAccess.write(Native Method) at com.sun.star.sdbcx.comp.hsqldb.StorageAccess.write(StorageAccess.java:86) at com.sun.star.sdbcx.comp.hsqldb.StorageAccess.writeLong(StorageAccess.java:124) at org.hsqldb.persist.RAStorageWrapper.writeLong(Unknown Source) at org.hsqldb.persist.DataFileCache.reset(Unknown Source) at org.hsqldb.persist.DataFileCache.close(Unknown Source) at org.hsqldb.persist.DataFileCache.defrag(Unknown Source) at org.hsqldb.persist.Log.defrag(Unknown Source) at org.hsqldb.persist.Log.checkpoint(Unknown Source) at org.hsqldb.persist.Logger.checkpointInternal(Unknown Source) at org.hsqldb.persist.Logger.checkpoint(Unknown Source) at org.hsqldb.StatementCommand.getResult(Unknown Source) at org.hsqldb.StatementCommand.execute(Unknown Source) at org.hsqldb.Session.executeCompiledStatement(Unknown Source) at org.hsqldb.Session.executeDirectStatement(Unknown Source) at org.hsqldb.Session.execute(Unknown Source) at org.hsqldb.jdbc.JDBCStatement.fetchResult(Unknown Source) at org.hsqldb.jdbc.JDBCStatement.execute(Unknown Source)2016-11-22T12:44:19.824+0100 SEVERE DataFileCache.reset commitjava.io.IOException: No OutputStream at com.sun.star.sdbcx.comp.hsqldb.NativeStorageAccess.write(Native Method) at com.sun.star.sdbcx.comp.hsqldb.StorageAccess.write(StorageAccess.java:86) at com.sun.star.sdbcx.comp.hsqldb.StorageAccess.writeLong(StorageAccess.java:124) at org.hsqldb.persist.RAStorageWrapper.writeLong(Unknown Source) at org.hsqldb.persist.DataFileCache.reset(Unknown Source) at org.hsqldb.persist.DataFileCache.close(Unknown Source) at org.hsqldb.persist.Log.close(Unknown Source) at org.hsqldb.persist.Logger.close(Unknown Source) at org.hsqldb.Database.close(Unknown Source) at org.hsqldb.StatementCommand.getResult(Unknown Source) at org.hsqldb.StatementCommand.execute(Unknown Source) at org.hsqldb.Session.executeCompiledStatement(Unknown Source) at org.hsqldb.Session.executeDirectStatement(Unknown Source) at org.hsqldb.Session.execute(Unknown Source) at org.hsqldb.jdbc.JDBCStatement.fetchResult(Unknown Source) at org.hsqldb.jdbc.JDBCStatement.execute(Unknown Source)2016-11-22T12:44:19.825+0100 SEVERE error closing logorg.hsqldb.HsqlException: file input/output errorerror java.io.IOException: No OutputStream closing file - file /Users/alex/Downloads/copie.odb.data at org.hsqldb.error.Error.error(Unknown Source) at org.hsqldb.persist.DataFileCache.reset(Unknown Source) at org.hsqldb.persist.DataFileCache.close(Unknown Source) at org.hsqldb.persist.Log.close(Unknown Source) at org.hsqldb.persist.Logger.close(Unknown Source) at org.hsqldb.Database.close(Unknown Source) at org.hsqldb.StatementCommand.getResult(Unknown Source) at org.hsqldb.StatementCommand.execute(Unknown Source) at org.hsqldb.Session.executeCompiledStatement(Unknown Source) at org.hsqldb.Session.executeDirectStatement(Unknown Source) at org.hsqldb.Session.execute(Unknown Source) at org.hsqldb.jdbc.JDBCStatement.fetchResult(Unknown Source) at org.hsqldb.jdbc.JDBCStatement.execute(Unknown Source)Caused by: java.io.IOException: No OutputStream at com.sun.star.sdbcx.comp.hsqldb.NativeStorageAccess.write(Native Method) at com.sun.star.sdbcx.comp.hsqldb.StorageAccess.write(StorageAccess.java:86) at com.sun.star.sdbcx.comp.hsqldb.StorageAccess.writeLong(StorageAccess.java:124) at org.hsqldb.persist.RAStorageWrapper.writeLong(Unknown Source) ... 12 moreI suspect that the issue is Java-related.FWIW, I'm using JDK 1.8.0-112This is also almost certainly only a MacOS problem, hence the addition of Stephan to CC.Createdbacktrace from lldb debugging sessionCreatedCorrupted test fileCannot reproduce with a local build of recent master on macOS 10.12 with JDK 1.8.0_112: Downloaded.odb fromand followed the steps from; both DEMOTABLE in the Tables and in the Forms sections opens fine. (Can reproduce the error "The connection to the data source 'copie' could not be established. The connection could not be established. The database was created by a newer version of LibreOffice." when using this bug's, though.)Seems to be this in the properties-file:--------------------#HSQL Database Engine 2.3.2#Tue Nov 22 12:43:27 CET 2016version=2.3.2modified=yes--------------------Must be this:--------------------#HSQL Database Engine 1.8.0.10#Fri Oct 07 18:57:44 CEST 2016...version=1.8.0...modified=yes...--------------------Could it be you have installed a newer version of HSQLDB? Then see. It's an old problem, has been gone sometimes and turned up again.On my setup (Mac OSX 11.6 LibreOffice Base v 5.2.3.3 and Oracle Java JDE 1.8.0_111) I can open your demo file in SPLIT MODE showing a single table DEMOTABLE (in the table list) with 4 records. No problems closing and reopening the file in this manner.(In reply to robert from)Don't think I've configured my user profile to include the extra jar path, but I will check.(In reply to robert from)No, I just checked, I don't have any other hsqldb.jar in my LO config.(In reply to Stephan Bergmann from)Hi Stepha, yes, I can open the original file.odb too. However, when you close that file, shut down LO, restart LO and try to open the file again, it is then that I get the error messages.(In reply to Alex Thurgood from)I did follow all the steps 1--8 fromwhen trying to reproduce the problem.Arrghh, OK, forget all of this, I thought I couldn't find a second hsqldb JAR in my LO config, but I was wrong, so this is just a re-confirmation of. When I removed the offending path and restarted LO5233 I could open, close and re-open old ODB files normally.Sorry for all the noise.
id=104162	Createddocx file causing LibreOffice to crashLibreOffice Writer 5.2.3.3 (on openSUSE 13.2 and openSUSE Tumbleweed for x86-64) crashes when opening the attached docx file. The file was created with Microsoft Word 2010 and seems to contain nothing remarkable other than a comment.Reproducibility: AlwaysSteps to reproduce:$ libreoffice test.docxExpected behaviour:LibreOffice should open and display the file.Observed behaviour:The following dialog appears as soon as LibreOffice starts:LibreOffice Document RecoveryDue to an unexpected error, LibreOffice crashed. All the files you were working on will now be saved. The next time LibreOffice is launched, your files will be recovered automatically. I can also reproduce the problem with 5.3.0 Beta1:Version: 5.3.0.0.beta1Build ID: 690f553ecb3efd19143acbf01f3af4e289e94536CPU Threads: 4; OS Version: Linux 3.16; UI Render: default; VCL: gtk2; Layout Engine: new; Locale: en-CA (en_CA.utf8); Calc: groupConfirming crash with:Version: 5.3.0.0.beta1Build ID: 690f553ecb3efd19143acbf01f3af4e289e94536CPU Threads: 4; OS Version: Windows 6.2; UI Render: default; Layout Engine: new; Locale: nl-NL (nl_NL); Calc: CLCrash report:Hello Tristan, *,thank you very much for reporting this bug :) I can reproduce it withOS: Debian Testing AMD64LO: Version: 5.3.0.0.beta1Build-ID: 690f553ecb3efd19143acbf01f3af4e289e94536CPU-Threads: 4; BS-Version: Linux 4.5; UI-Render: Standard; VCL: gtk2; Layout-Engine: neu; Gebietsschema: de-DE (de_DE.UTF-8); Calc: groupand back toLO: Version: 4.3.7.2Build-ID: 8a35821d8636a03b8bf4e15b48f59794652c68babut not withLO: Version 4.0.0.3 (Build ID: 7545bee9c2a0782548772a21bc84a9dcc583b89)(all parallel installed, following the instructions from). So it seems, that somewhere between 4.0.0.3 and 4.3.7.2 it was introduced. Sorry, that I have no further version installed between the two ones ... :(As I can confirm your bug, I will set "Version" to 4.3.7.2.HTHThomas.Confirmed in Version: 5.3.0.0.alpha1+Build ID: 4ebf1ea7cb66fc3e6b94cd38dd233aaead69f3d5CPU Threads: 4; OS Version: Linux 4.8; UI Render: default; VCL: gtk3; Layout Engine: new; Locale: ca-ES (ca_ES.UTF-8); Calc: group(In reply to thackert from)No crash in 4.3.0.4, general input-output error in 4.4.0.3.Created"soffice --backtrace" outputCreatedbzip2'ed "soffice --strace" outputRegression introduced by:author Miklos Vajna <> 2014-08-14 11:54:18 (GMT)committer Miklos Vajna <> 2014-08-14 13:55:44 (GMT)commit d1278ef4849661b9ae0eb7aaf4d74fbf91ccaf11 (patch)tree 07e1c063cbd015b90c8be638197ad6e15e531b07parent ffdc8780eba3ec34e502b01b9a54401627ee25c5 (diff)bnc#865381 DOCX import: handle <w:hideMark> table cell propertyAdding Cc: to Miklos VajnaOn pc Debian x86-64 with master sources updated today, I could reproduce this.gdb gives this:(gdb) frame 5#5 0x00002aaadca6adec in writerfilter::dmapper::lcl_emptyRow (rTableRanges=std::__debug::vector of length 4, capacity 4 = {...}, nRow=0) at /home/julien/lo/libreoffice/writerfilter/source/dmapper/DomainMapperTableHandler.cxx:899899 uno::Reference<text::XTextRangeCompare> xTextRangeCompare(rRowSeq[0][0]->getText(), uno::UNO_QUERY);(gdb) p rRowSeq$4 = uno::Sequence of length 1 = {uno::Sequence of length 2 = {empty uno::Reference, empty uno::Reference}}(gdb) p rRowSeq[0]$5 = uno::Sequence of length 2 = {empty uno::Reference, empty uno::Reference}I'll take care of this; the special thing about the bugdoc is that it has a comment that contains a table and that table contains a <w:hideMark/>.Miklos Vajna committed a patch related to this issue.It has been pushed to "master":tdf#104162 DOCX import: fix crash on <w:hideMark/> in a comment tableIt will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Miklos Vajna committed a patch related to this issue.It has been pushed to "libreoffice-5-3":tdf#104162 DOCX import: fix crash on <w:hideMark/> in a comment tableIt will be available in 5.3.0.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.hello.thanks extremely for helping to resolve bugs and make your program for your users better and better every day.could you please also fix this bug for version 5.2.6 also?i wish that use 5.2 and can open and read my documents without any bug!thanks extremely for your help,i remember you in my five times daily prayers,pray for you and request divine infinite mercy for you.Commit cherry-picked for 5.2 branch waiting for review here:(In reply to Julien Nabet from)hi julien.thanks extremely for your quick reply and patch.i admire your efforts, appreciate you and pray for you sincerely.i request divine extreme mercy and graces for you.i waite for fixing this.(In reply to zahra from)Just to say that Miklos made the patch (it's him you must thank not me! :-)). I just cherry-picked (ie. retrieved) for gerrit review in 5.2 branch. For the moment, we must wait for some people approve it (or not!) so it may available for 5.2.6Miklos Vajna committed a patch related to this issue.It has been pushed to "libreoffice-5-2":tdf#104162 DOCX import: fix crash on <w:hideMark/> in a comment tableIt will be available in 5.2.6.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.(In reply to Commit Notification from)hi miklos.i also appreciate your great work, pray for you and invoke divine extreme blessings, mercy and graces for you.i pray this for you and all developers and supporters of libreoffice.i wish that i was programmer and could help you in improving your program, not only reporting bugs!
id=104227	Open a *.odb-file connected to internal Firebird (FB 3 - LO 5.3). Example see here:Input some value in one table.Save the row with changing to next row.Go back to the first row.Change the enty.Go to next row.LO will crash immediately.Tested with Version: 5.3.0.0.beta1Build-ID: 690f553ecb3efd19143acbf01f3af4e289e94536CPU-Threads: 4; BS-Version: Linux 4.1; UI-Render: Standard; VCL: kde4; Layout-Engine: neu; Gebietsschema: de-DE (de_DE.UTF-8); Calc: group Same behavior here withVersion: 5.3.0.0.alpha1+Build ID: 883024d657fb45c7da459017d2f936aac5644bfbCPU Threads: 4; OS Version: Linux 4.1; UI Render: default; VCL: kde4; Layout Engine: new; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-11-21_22:42:51Locale: de-DE (de_DE.UTF-8); Calc: groupChanging column and moving next row - crash of whole LO.Reproduce with a new table in a database.But with an exusting table, LO crashes only when closing and saving table.Version: 5.4.0.0.alpha0+Build ID: 719f7cb94ce783349fb1cf366a78edd9996d3e37CPU Threads: 2; OS Version: Windows 6.1; UI Render: default; TinderBox: Win-x86@42, Branch:master, Time: 2016-11-27_03:58:17Locale: fr-FR (fr_FR); Calc: group(In reply to ribotb from)Could you please give me a hint where to search for this version? Couldn't find it in the daily-folder.(In reply to robert from)I can't test this on my current master build, as the test file fails to draw any UI elements other than a grey application window and the two white background window frames, per attached screenshot...CreatedScreenshot of test file on loading in master alpha 540(In reply to Lionel Elie Mamane from)Seems there is nothing for Linux 64bit rpm. So no test possible here.NEW perReproduced also withVersion: 5.4.0.0.alpha0+Build ID: 150afc29c951d5fc9c40ff8a72f5178c32383f8cCPU Threads: 4; OS Version: Linux 4.1; UI Render: default; VCL: kde4; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-12-03_01:02:49Locale: de-DE (de_DE.UTF-8); Calc: groupon OpenSUSE 42.1 64bit rpm LinuxOn pc Debian x86-64 with master sources updated yesterday (+enable-dbgutil and gtk3), application doesn't react after giving a try and I must reboot my laptop.sorry, forgot to say I must reboot only when I used GDB (with export SAL_NO_MOUSEGRABS=1))Without gdb, it just crashesCreatedbt with symbolsInstead of using "make debugrun", I launched LO as usual then used attaching process (see).I could retrieve a bt.It seems to be an infinite recursive loopIt seems there's a confusion about sqlsubtypes, "decimal" and "numeric"Reading src/common/dsc.h from Firebird package included in LO: 445 // Exact numeric subtypes: with ODS >= 10, these apply when dtype 446 // is short, long, or quad. 447 448 const SSHORT dsc_num_type_none = 0; // defined as SMALLINT or INTEGER 449 const SSHORT dsc_num_type_numeric = 1; // defined as NUMERIC(n,m) 450 const SSHORT dsc_num_type_decimal = 2; // defined as DECIMAL(n,m)In connectivity/source/drivers/firebird/ResultSet.cxx, we can see: 458 case SQL_SHORT: 459 if(nSqlSubType == 0 || nSqlSubType == 1) //numeric or decimal 460 return getString(nColumnIndex); 461 return getShort(nColumnIndex); 462 case SQL_LONG: 463 if(nSqlSubType == 0 || nSqlSubType == 1) //numeric or decimal 464 return getString(nColumnIndex); 465 return getInt(nColumnIndex); 468 case SQL_DOUBLE: 469 if(nSqlSubType == 0 || nSqlSubType == 1) //numeric or decimal 470 return getString(nColumnIndex); 471 return getDouble(nColumnIndex); 480 case SQL_INT64: 481 if(nSqlSubType == 0 || nSqlSubType == 1) //numeric or decimal 482 return getString(nColumnIndex); 483 return getLong(nColumnIndex);so comment doesn't correspond to code.Whereas this part is ok: 581 else if ((aSqlType == SQL_SHORT || aSqlType == SQL_LONG 582 || aSqlType == SQL_DOUBLE || aSqlType == SQL_INT64) 583 && (aSqlSubType == 1 || aSqlSubType == 2)) 584 { 585 // decimal and numeric typesSeeI gave a try by changing the four:if(nSqlSubType == 0 || nSqlSubType == 1)byif(nSqlSubType == 1 || nSqlSubType == 2)and I haven't reproduced the crash with it.I submitted a patch to review on master here:Julien Nabet committed a patch related to this issue.It has been pushed to "master":tdf#104227: fix subtypes DECIMAL/NUMERIC in resultsetIt will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Julien Nabet committed a patch related to this issue.It has been pushed to "libreoffice-5-3":tdf#104227: fix subtypes DECIMAL/NUMERIC in resultsetIt will be available in 5.3.0.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Robert: could you please give a new try once the patch will be included in the daily build?Have tested withVersion: 5.4.0.0.alpha0+Build ID: 63bf040056b64e0bf32a36277c54deee566de4fcCPU Threads: 4; OS Version: Linux 4.1; UI Render: default; VCL: kde4; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-12-06_00:37:50Locale: de-DE (de_DE.UTF-8); Calc: groupCould confirm the bug has gone with the patch. Thank you, Julien.I will set this one to RESOLVED and FIXED.Wastack committed a patch related to this issue.It has been pushed to "master":tdf#104227 query boolean like infos correctlyIt will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Thank you Robert for your feedback, let's put this one to VERIFIED.
id=104316	Description:I attempted to open the ODB file mentioned in:Upon loading of the file, the test file fails to draw any UI elements other than a grey application window and the two white background window frames, per attached screenshot...In addition, the remaining UI of the application becomes unresponsive to mouse clicks or keyboard activation. The only way to regain control is to force kill the application.Steps to Reproduce:1. Open ODB file indicated in descriptionActual Results: See descriptionExpected Results:Access and functionality to all usual UI objects should be possible. Currently, no work is possible with the embedded Firebird 3 ODBReproducible: AlwaysUser Profile Reset: NoAdditional Info:User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:50.0) Gecko/20100101 Firefox/50.0 CreatedUI on ODB file loadJust for information, I can't test anything about Base because of tdf#103667I can't open or create Base file (Hsqldb or Firebird).I can open and edit tables, but not create a new one, all task are greyed out for tables, queries, forms and reports.Version: 5.3.0.0.alpha1+Build ID: 172325bedf69bbc162f3c1948264451c90c105a3CPU Threads: 4; OS Version: Windows 6.19; UI Render: GL; Layout Engine: new; TinderBox: Win-x86@39, Branch:master, Time: 2016-11-21_05:26:40Locale: es-ES (es_ES); Calc: groupTested this withVersion: 5.4.0.0.alpha0+Build ID: 150afc29c951d5fc9c40ff8a72f5178c32383f8cCPU Threads: 4; OS Version: Linux 4.1; UI Render: default; VCL: kde4; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-12-03_01:02:49Locale: de-DE (de_DE.UTF-8); Calc: groupCouldn't reproduce with OpenSUSE 42.1 64bit rpm Linux.On macOS 10.12.1 with master sources updated yesterday, I could give a try after having disabled autorecovery (which makes LO crash)I don't reproduce the problem.(In reply to Julien Nabet from)Hi Julien,Yes, disabling the autosave feature enabled me to open the file and tables. So, this behaviour is linked to, in which case, I shall try it again (with autosave re-activated, after I have rebuilt from master.Alex: any update about this tracker?I think that if it works with autorecovery disabled, it means that the pb is only tdf#103515.issue doesn't happen now with:Version: 5.4.0.0.alpha0+Build ID: 2e9c02feca732f6dd012ccbe5d7c6853c64075a5CPU Threads: 4; OS Version: Windows 6.19; UI Render: default; TinderBox: Win-x86@39, Branch:master, Time: 2016-12-20_00:19:54Locale: es-ES (es_ES); Calc: CL@Julien : still a problem for me on OSX when I re-activate autosave onLibreOfficeDev 5400alpha0+BuildID: e34cf2adc385d1b04e36e1fdb80cfaced1b7dee5CPU Threads: 2; OS Version: Mac OSX 10.12.1; UI Render: default; Locale: fr-FR (fr_FR.UTF-8); Calc: groupIf the StartCenter is already open and displaying on screen and I try to open a FB3 file from the recent file list, nothing happens - no ODB file is loaded, the StartCenter dialog becomes unresponsive.I can however force reload or refresh the app by opening the same file via the LibreOffice File > Recent menu - this then swaps the StartCenter window for the Base window, however, that window is now non-responsive to mouse clicks or key strokes.Attempting to quit LibreOffice via the menu fails, nothing happens.If I drag and drop the ODB file directly onto the LO app icon in the OSX Dock, the Base window frame gets drawn incompletely, the same as in the attached file I had already posted.De-activating autosave again, and restarting LO allows me to open the FB3 ODB file correctly once more.Note that I'm using a debug-enabled buildCreatedScreenshot when running Lodev under lldbI took a screenshot of what the app looks like when running under lldb when it attempts to draw various UI elements of the FB3 ODB file with autosave turned off.Createdlldb session output with btAlso enclosed a bt of the lldb session - the mutex yield dbg assert is there, but there appear to be other problems.Alex: could you give an update with autosave enabled?The daily build you use must containWith Version: 5.4.0.0.alpha0+Build ID: 40fb49446b456459a4cdfa6fff0013b7ffef82e8CPU Threads: 2; OS Version: Mac OS X 10.12.2; UI Render: default; Locale: fr-FR (fr_FR.UTF-8); Calc: groupdebug build,the test file doesn't even load any more, when AutoSave is turned on, I just see the StartCenter with the grey background indicating that I've clicked the file to load it. I have to force quit the application, none of the menus respond.If I ignore the StartCenter (e.g. close it) and then drag and drop the test file onto the LO icon in the Dock, again, nothing happens, the file doesn't load, and I'm left with a running LO application in an indeterminate state. If I then repeat the drag and drop maneuver, I get the same incomplete UI of the main Base app window as obtained previously and shown with my screenshot.(In reply to Alex Thurgood from)Ouch!Any chance for a new stacktrace to see if it's still the same.On MacOs 10.12.2, with master sources updated 2 days ago and autorecovery enabled, I could open the file and opened the tables.My autogen.input contains this:--enable-debug--enable-werror--enable-dbgutil--with-lang=en-US it fr de es pt ru cs hu pl nl
id=104481	Createdvideo with the problem in actionIn a Writer document, with an image pre-existing or a new image inserted, when is edited the wrap condition (right click->Wrap->an option) for that image, shows an error (without a description) and close immediatly... the Libreoffice data isVersion: 5.3.0.0.beta1+Build ID: 9218c5decc2d8a883d56a8fd657eac27e796b764CPU Threads: 4; OS Version: Linux 4.4; UI Render: default; VCL: gtk2; Layout Engine: new; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:libreoffice-5-3, Time: 2016-12-07_14:35:14Locale: es-MX (en_US.UTF-8); Calc: group On pc Debian x86-64 with master sources updated today, I could reproduce this.It seems gtk2 only. Indeed, I don't reproduce this with gtk3I don't know how to retrieve a bt here since there's no segfault.No repro with gtk2.Arch Linux 64-bit, KDE Plasma 5Version: 5.4.0.0.alpha0+Build ID: 1fce5b024e9f25c3fcef2537a22474ece0dc416fCPU Threads: 8; OS Version: Linux 4.8; UI Render: default; VCL: gtk2; Locale: fi-FI (fi_FI.UTF-8); Calc: groupBuilt on December 10th 2016On pc Debian x86-64 with master sources updated today, I still reproduce thisWhen error popup displayed, I just breaked on gdb and had this bt:(gdb) bt#0 0x00002aaaab3c256d in poll () at ../sysdeps/unix/syscall-template.S:84#1 0x00002aaaacc599f6 in ?? () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#2 0x00002aaaacc59d82 in g_main_loop_run () from /lib/x86_64-linux-gnu/libglib-2.0.so.0#3 0x00002aaac6feee83 in gtk_dialog_run () from /usr/lib/x86_64-linux-gnu/libgtk-x11-2.0.so.0#4 0x00002aaac6c6faf9 in GtkSalSystem::ShowNativeDialog (this=<optimized out>, rTitle=..., rMessage=..., rButtonNames=std::__debug::list = {...}, nDefaultButton=0) at /home/julien/lo/libreoffice/vcl/unx/gtk/gtksys.cxx:290#5 0x00002aaab4a0c5bf in SalGenericSystem::ShowNativeMessageBox (this=0x5555574226e0, rTitle="LibreOfficeDev 5.4 - Fatal Error", rMessage="") at /home/julien/lo/libreoffice/vcl/unx/generic/app/gensys.cxx:103#6 0x00002aaab4923a54 in Application::ShowNativeErrorBox (sTitle="LibreOfficeDev 5.4 - Fatal Error", sMessage="") at /home/julien/lo/libreoffice/vcl/source/app/svapp.cxx:1661#7 0x00002aaaaafa4bfe in desktop::(anonymous namespace)::FatalError (sMessage="") at /home/julien/lo/libreoffice/desktop/source/app/app.cxx:447#8 0x00002aaaaafad13c in desktop::Desktop::Main (this=<optimized out>) at /home/julien/lo/libreoffice/desktop/source/app/app.cxx:1699#9 0x00002aaab492ca21 in ImplSVMain () at /home/julien/lo/libreoffice/vcl/source/app/svmain.cxx:185#10 0x00002aaab492caef in SVMain () at /home/julien/lo/libreoffice/vcl/source/app/svmain.cxx:223#11 0x00002aaaaafe1504 in soffice_main () at /home/julien/lo/libreoffice/desktop/source/app/sofficemain.cxx:166#12 0x00005555555549f9 in sal_main () at /home/julien/lo/libreoffice/desktop/source/app/main.c:48#13 0x0000555555554a47 in main (argc=<optimized out>, argv=<optimized out>) at /home/julien/lo/libreoffice/desktop/source/app/main.c:47Ah - the trace looks like one for an un-caught exception I'm afraid - unfortunately an exception with no message, location or anysuch: hmm =) nasty. We'd need to run under gdb and put a break-point in __cxa_throw before doing the operation to get a good trace =)Could be related to the fix for- worth checking perhaps =)Probably a duplicate of?Can someone try it in a build withincluded?(In reply to Xisco Faulí from)I don't reproduce the crash with this patch. Let's put this one to FIXED then.Ismael/Xisco/Buovjaga: don't hesitate to reopen this tracker if you still reproduce the crash.I can no longer reproduce it inVersion: 5.4.0.0.alpha0+Build ID: 7a1add76d542e9929c1feab9e06949990e236616CPU Threads: 4; OS Version: Linux 4.8; UI Render: default; VCL: gtk3; Locale: ca-ES (ca_ES.UTF-8); Calc: group(In reply to Xisco Faulí from)Just to be sure Xisco, you gave a try with gtk2? (I read VCL: gtk3 on your comment)(In reply to Julien Nabet from)You're right!!!Verified inVersion: 5.4.0.0.alpha0+Build ID: 7a1add76d542e9929c1feab9e06949990e236616CPU Threads: 4; OS Version: Linux 4.8; UI Render: default; VCL: gtk2; Locale: ca-ES (ca_ES.UTF-8); Calc: group
id=104534	How to reproduce:Create chartSelect a column (double click - open Data Series)Go to AreaSelect PatternCrashes as soon as i click on "Pattern" CreatedGDB trace of the crash with 5.4 masterRepro.Arch Linux 64-bit, KDE Plasma 5Version: 5.4.0.0.alpha0+Build ID: a564821eb9e991774195120e6965b2a8b1419dc5CPU Threads: 8; OS Version: Linux 4.8; UI Render: default; VCL: kde4; Locale: fi-FI (fi_FI.UTF-8); Calc: groupBuilt on December 9th 2016Createdbt with symbolsOn pc Debian x86-64 with master sources updated today, I could reproduce this.I had to use kde4 rendering because of tdf#104551Surprisingly, I retrieved a bt a bit different from the Buovjaga's one.I submitted a patch to review for master sources, seeJulien Nabet committed a patch related to this issue.It has been pushed to "master":tdf#104534: Retrieve list of patternsIt will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Julien Nabet committed a patch related to this issue.It has been pushed to "libreoffice-5-3":tdf#104534: Retrieve list of patternsIt will be available in 5.3.0.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Let's put this one to FIXED now.Verified fix on master. Thanks, Julien :)Arch Linux 64-bit, KDE Plasma 5Version: 5.4.0.0.alpha0+Build ID: 1fce5b024e9f25c3fcef2537a22474ece0dc416fCPU Threads: 8; OS Version: Linux 4.8; UI Render: default; VCL: kde4; Locale: fi-FI (fi_FI.UTF-8); Calc: groupBuilt on December 10th 2016
id=104537	CreatedGDB trace of the crash with 5.4 masterOpenEdit Form1Select the control objectRight-click on itThis does not yet crash in 5.3 beta1.This does not crash on Windows.Unfortunately, I was unable to advance to this stage while in GDB. It crashes already when opening the form for editing. I have nevertheless attached the trace.I tried attaching GDB to the process after entering form editor, but I was unable to make GDB work. It just stood there in (gdb) prompt.Arch Linux 64-bit, KDE Plasma 5Version: 5.4.0.0.alpha0+Build ID: a564821eb9e991774195120e6965b2a8b1419dc5CPU Threads: 8; OS Version: Linux 4.8; UI Render: default; VCL: kde4; Locale: fi-FI (fi_FI.UTF-8); Calc: groupBuilt on December 9th 2016Win 10 64-bitVersion: 5.4.0.0.alpha0+Build ID: cb598029835477326b190bc99abd31a487cc5a91CPU Threads: 4; OS Version: Windows 6.19; UI Render: default; TinderBox: Win-x86@42, Branch:master, Time: 2016-12-09_00:49:18Locale: fi-FI (fi_FI); Calc: group Unconfirmed with Version: 5.3.0.0.alpha1+Build ID: 883024d657fb45c7da459017d2f936aac5644bfbCPU Threads: 2; OS Version: Linux 4.4; UI Render: default; VCL: gtk2; Layout Engine: new; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-11-21_22:42:51Locale: en-US (en_US.UTF-8); Calc: singleConfirmed with Version: 5.4.0.0.alpha0+Build ID: cb598029835477326b190bc99abd31a487cc5a91CPU Threads: 2; OS Version: Linux 4.4; UI Render: default; VCL: gtk2; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-12-09_00:51:36Locale: en-US (en_US.UTF-8); Calc: singleTo reproduce I do:Edit Form1Click the textboxSelect the control object with RMBSelect 'visible buttons > select'CrashOn pc Debian x86-64 with master sources updated today, I don't reproduce this.(tested with gtk3/gtk/kde4 and gen rendering).True, I can't repro with a fresh build. I also fiddled with the Visible setting. WFM.Arch Linux 64-bit, KDE Plasma 5Version: 5.4.0.0.alpha0+Build ID: 1fce5b024e9f25c3fcef2537a22474ece0dc416fCPU Threads: 8; OS Version: Linux 4.8; UI Render: default; VCL: kde4; Locale: fi-FI (fi_FI.UTF-8); Calc: groupBuilt on December 10th 2016
id=104488	The original document was taken from().I saved the original document from OOXML docx to binary doc using WPS Office (Linux) and then opened the .doc in Libreoffice. Scrolled it from the begining of the document to the end for several times and Libreoffice hanged. Saved it into odt, but in odt it also hangs.Reproduced on Libreoffice 5.2.4 and 5.3 beta1 nightly build 08.12.2016 I hangs completely, making to high load on the CPU and/or the graphical system (Xorg)please upload here the exact version of the file that makes LibO hangsCreateddocForgot to attach it. I can't reproduce freezing on another computer with KDE. The first was with Unity (but I don't think that the DE matters)(In reply to Mikhail Novosyolov from)..making NO high load.. (to-->no)(sorry mor misspelling)Scrolling down and then up again inVersion: 5.4.0.0.alpha0+Build ID: 7fc84a8e6678e3d0399983f5a078c9b2beb6ee4bCPU Threads: 4; OS Version: Linux 4.8; UI Render: default; VCL: gtk3; Locale: ca-ES (ca_ES.UTF-8); Calc: groupI get the following error: 'object has been already disposed' and then LibreOffice is closed automaticallyCreatedscreenshotError inisn't displayed in GTk2, but LibreOffice hangs anyway.Version: 5.4.0.0.alpha0+Build ID: 7fc84a8e6678e3d0399983f5a078c9b2beb6ee4bCPU Threads: 4; OS Version: Linux 4.8; UI Render: default; VCL: gtk2; Locale: ca-ES (ca_ES.UTF-8); Calc: groupI can't reproduce the hang inVersion: 4.5.0.0.alpha0+Build ID: 2851ce5afd0f37764cbbc2c2a9a63c7adc844311Locale: ca_ESthus, this is a regression. Raising importanceI can reproduce it inVersion: 5.2.0.4Build ID: 066b007f5ebcc236395c7d282ba488bca6720265CPU Threads: 4; OS Version: Linux 4.8; UI Render: default; Locale: ca-ES (ca_ES.UTF-8)but not in Version: 5.1.6.2Build ID: 07ac168c60a517dba0f0d7bc7540f5afa45f0909CPU Threads: 4; OS Version: Linux 4.8; UI Render: default; Locale: ca-ES (ca_ES.UTF-8); Calc: group@raal, could you please bisect this one whenever you have some time? it's a critical one and should be fixed asap. RegardsI cannot reproduce this bug on windows. Mikhail, what is your OS?On linux command line error: (soffice:10366): Gtk-CRITICAL **: gtk_grid_attach: assertion 'GTK_IS_GRID (grid)' failedCreatedthe same .doc converted to .odt, also hangsLinux. But I could not reproduce the bug on the same version of Libreoffice in KDE with KWin (Intel graphics). The bug is reproducable in Unity with Compiz (by default) (Nvidia Optimus, Nvidia off by Prime, working on Intel).Can someone test it with other Window managers?regression introduced in rangeCreateda backtracelang::DisposedException is thrown at accessibility::AccessibleContextBase::ThrowIfDisposed.@Michael, Could it be possible that this was introduced by one of your commits here?it doesn't crash inVersion: 5.4.0.0.alpha0+Build ID: 634589b340316ba64b731b4d923c1056be415494CPU Threads: 4; OS Version: Linux 4.8; UI Render: default; VCL: x11; Locale: ca-ES (ca_ES.UTF-8); Calc: groupCreatedgdb backtrace***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Michael Stahl committed a patch related to this issue.It has been pushed to "master":tdf#104488 editeng,svx: throw less Accessible exceptionsIt will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "master":tdf#104488 sw: assert if exception escapes from UpdateAccessible()It will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "master":tdf#104488 SwAccessibleMap: dispose sub-shapes of group shapesIt will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.regression from:commit b299aa7c64adc2de86c367888e6ccb73c4b31bc2Author: Michael Stahl <>AuthorDate: Thu Feb 25 23:24:53 2016 +0100 sw: restore some Dispose calls in a11y codefixed on master, hopefully all AccessibleShapes should be disposed at the right time nowMichael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-5-3":tdf#104488 editeng,svx: throw less Accessible exceptionsIt will be available in 5.3.0.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-5-3":tdf#104488 sw: assert if exception escapes from UpdateAccessible()It will be available in 5.3.0.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-5-3":tdf#104488 SwAccessibleMap: dispose sub-shapes of group shapesIt will be available in 5.3.0.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Michael Stahl committed a patch related to this issue.It has been pushed to "libreoffice-5-2":tdf#104488 editeng,svx: throw less Accessible exceptionsIt will be available in 5.2.5.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.
id=104567	Description:LibreOffice is crashing will closingSteps to Reproduce:1.Open attached file in Draw2.Open Writer (New document)3.Copy the smiley in Draw4.Paste it into the new Writer document5.Close Draw6.Close Writer (Click No save)Actual Results: CrashExpected Results:No crashReproducible: AlwaysUser Profile Reset: NoAdditional Info:Version: 5.4.0.0.alpha0+Build ID: b894104a0b02a9b074c76feb925389d7bee6a493CPU Threads: 4; OS Version: Windows 6.19; UI Render: default; TinderBox: Win-x86@39, Branch:master, Time: 2016-12-10_01:00:52Locale: nl-NL (nl_NL); Calc: CLUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0 CreatedExample filenot reproducible using LibO 5.2.3.3 under Win8.1 x64reproducible using LibO 5.4.0.0.alpha0+Build ID: 33f5bc54aaa7fe7aa9335726e30f9c349155e04dCPU Threads: 4; OS Version: Windows 6.2; UI Render: default; TinderBox: Win-x86@62-merge-TDF, Branch:MASTER, Time: 2016-12-01_23:21:05Locale: it-IT (it_IT); Calc: groupstatus NEWedited summary notesThis seems to have begun at the below commit.Adding Cc: to Tomaž Vajngerl; Could you possibly take a look at this one? Thanksauthor Tomaž Vajngerl <> 2016-11-23 16:01:46 (GMT)committer Tomaž Vajngerl <> 2016-11-24 14:26:30 (GMT)commit c53cf1dfc5eacd8fee6b2b549ec6b59ad927e01c (patch)tree d606badf14936a325876ea089389517cc637d253parent 93154946452fdedad9b8b536ec3d9704a4707304 (diff)tdf#103852 avoid clipboard deadlocke06c68b74e0c470815a67a3c784224d86ff9b85c is the first bad commitcommit e06c68b74e0c470815a67a3c784224d86ff9b85cAuthor: Norbert Thiebaud <>Date: Thu Nov 24 11:30:51 2016 -0800 source sha:c53cf1dfc5eacd8fee6b2b549ec6b59ad927e01c git bisect log# bad: [479ca41474b9720803421ab7717aa69fa6c60528] source sha:f8c463b393885b660500bf4f7f73b4fb90ce2389# good: [defb73f1c6e2a66dbd21ba89e684f57427e8bc4b] source sha:5b168b3fa568e48e795234dc5fa454bf24c9805egit bisect start 'origin/master' 'oldest'# good: [1c50425620ffbce30bb57f9ff19ef3c5d20d69f1] source sha:b62f4c2cd9685618fff2270760ce0787880f1c8dgit bisect good 1c50425620ffbce30bb57f9ff19ef3c5d20d69f1# good: [70770f0ce4d3672d5cd2759605adb44d867e7208] source sha:0b7e11a2a7ade0b565c18d1deb58c19848f6ceefgit bisect good 70770f0ce4d3672d5cd2759605adb44d867e7208# good: [ce5c761b06e108ba3a25fccda8acb9d3c2aedaba] source sha:ea6b378221efea0392c5085d621ff38a612ade3egit bisect good ce5c761b06e108ba3a25fccda8acb9d3c2aedaba# good: [d385e273cdb47c051f2718c82758a9ad10364233] source sha:40f8c14be28aeb78fe758264b43a255d2bfd4938git bisect good d385e273cdb47c051f2718c82758a9ad10364233# good: [48729d96c1f2aff794a59c54c71efa3ac119a3a9] source sha:ebf04205508227a245885ecb367f1fc8abbd6591git bisect good 48729d96c1f2aff794a59c54c71efa3ac119a3a9# good: [817b5433ac03e8b48c207374aae11cae3f13f798] source sha:75fb3f79c3ba5e94740cea947527477bba50b358git bisect good 817b5433ac03e8b48c207374aae11cae3f13f798# bad: [14162cabb15aa4fb34db3cba75b14ca7c8d70a4b] source sha:8114a779143a7f0042d7e15b476037315ed2b4c3git bisect bad 14162cabb15aa4fb34db3cba75b14ca7c8d70a4b# bad: [60bccbcbaa004096130e1d63a7ed9830ff009740] source sha:2ce21dd8b9075486f92c18ac007f61a27062ce63git bisect bad 60bccbcbaa004096130e1d63a7ed9830ff009740# good: [4ae8806d9031c7907e8b54489b4368ce60807688] source sha:29dbac6fe556eb27067155c3be0c566b5328995cgit bisect good 4ae8806d9031c7907e8b54489b4368ce60807688# good: [f2c1df4e70c54ce4ab134976530c7f93b84d6500] source sha:93154946452fdedad9b8b536ec3d9704a4707304git bisect good f2c1df4e70c54ce4ab134976530c7f93b84d6500# bad: [4b46fd89a6bbb5b62b032d5db20a1c6ac928445c] source sha:4f8eff151e8ec71eb1a5b6757d9b17d3224d67cagit bisect bad 4b46fd89a6bbb5b62b032d5db20a1c6ac928445c# bad: [da22ce871d82bc6a5dba828f1a19f75000681a8e] source sha:c100e38b49512512b11a0c594f244a4937bc6d66git bisect bad da22ce871d82bc6a5dba828f1a19f75000681a8e# bad: [e06c68b74e0c470815a67a3c784224d86ff9b85c] source sha:c53cf1dfc5eacd8fee6b2b549ec6b59ad927e01cgit bisect bad e06c68b74e0c470815a67a3c784224d86ff9b85c# first bad commit: [e06c68b74e0c470815a67a3c784224d86ff9b85c] source sha:c53cf1dfc5eacd8fee6b2b549ec6b59ad927e01c***has been marked as a duplicate of this bug. ***No repro anymore with:Version: 5.4.0.0.alpha0+Build ID: a7c51323b7343f82b5aea6098f5d5e31a8bad0e9CPU Threads: 4; OS Version: Windows 6.19; UI Render: default; TinderBox: Win-x86@42, Branch:master, Time: 2016-12-29_23:35:20Locale: nl-NL (nl_NL); Calc: CLProbably fixed by:process all outstanding events before shutdown, tdf#104969, tdf#104286, tdf#104399
id=104572	Steps to reproduce:- In draw / impress make (for example) a rectangle.- Open writer- Copy the rectangle from draw/impress- in writer select RMB > paste special > more options- now a box appears with an exclamation mark and LO crashes.If you select paste special from the menu, then it works, no crash.Tested with ubuntu 16.04 x64.Confirmed with Version: 5.4.0.0.alpha0+Build ID: b52167df08511239c3d08904a3d12a3c92141f38CPU Threads: 2; OS Version: Linux 4.4; UI Render: default; VCL: gtk2; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-12-10_00:00:32Locale: en-US (en_US.UTF-8); Calc: singlebutUnconfirmed with Version: 5.3.0.0.alpha1+Build ID: 883024d657fb45c7da459017d2f936aac5644bfbCPU Threads: 2; OS Version: Linux 4.4; UI Render: default; VCL: gtk2; Layout Engine: new; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-11-21_22:42:51Locale: en-US (en_US.UTF-8); Calc: single Confirmed inVersion: 5.4.0.0.alpha0+Build ID: 7fc84a8e6678e3d0399983f5a078c9b2beb6ee4bCPU Threads: 4; OS Version: Linux 4.8; UI Render: default; VCL: gtk2; Locale: ca-ES (ca_ES.UTF-8); Calc: groupbut not inVersion: 5.4.0.0.alpha0+Build ID: 7fc84a8e6678e3d0399983f5a078c9b2beb6ee4bCPU Threads: 4; OS Version: Linux 4.8; UI Render: default; VCL: gtk3; Locale: ca-ES (ca_ES.UTF-8); Calc: groupCreatedbacktraceRegression introduced by:author Kohei Yoshida <> 2016-11-22 03:56:46(GMT)committer Kohei Yoshida <> 2016-11-22 13:18:00(GMT)commit 87e040fd0f04307534920d0765af6d5878794a98 (patch)tree 8faa3f12d311d9c1fc205d9c333e2b15da934894parent a0ef7474521413c8967559a635e6fdc0d88f1df6 (diff)tdf#71409: Stop listening to objects going out-of-focus.This helps eliminate the number of AtkListener objects growingover time.Closing this as duplicate of*** This bug has been marked as a duplicate of***Weird that you closed this one, as the other one is newer...
id=104639	CreatedThe spreadsheet that causes the problemThis bug was filed from the crash reporting server and is br-d7061fa5-8884-4459-a081-2559abfe61c3.=========================================This crash situation happens when the spreadsheet is relatively large (in the present case 500 rows by 30 columns). I get this problem each year when I reach a complete year of administrative data. The spreadsheet then starts causing the following problems:- regular crashes- impossibility to use save as or PDF export on Write files- erratic application of conditional formatting to the wrong cells. Confirming with:Version: 5.4.0.0.alpha0+Build ID: ba6b35fc68a01aff72b39eb7809bacb326068668CPU Threads: 4; OS Version: Windows 6.19; UI Render: default; TinderBox: Win-x86@39, Branch:master, Time: 2016-12-13_06:07:39Locale: nl-NL (nl_NL); Calc: CLAssertion failed!Program: ...iles (x86)V-ibreOfficeDev 5'program\sofficeapp.dllFile: C:/cygwin/home/tjnderbox/master/des.../officei.. .ead.cxxLine: 951Expression: ImlpcThread.isOFor information on how your program can cause an assertionfailure, see the Visual C++ documentation on asserts(Press Retry to debug the application - JIS must be enabled)Confirmed as perGlobally tested no repro with:Versie: 5.3.0.0.beta1 (x64)Build ID: 690f553ecb3efd19143acbf01f3af4e289e94536CPU Threads: 4; Versie besturingssysteem:Windows 6.19; UI Render: standaard; Layout Engine: new; Locale: nl-NL (nl_NL); Calc: CLMemory usage is over the chart however. 2,4GB on file opening with 5.3.0.0.beta1 (x64), substantial less with 5.4.0.0, but still 1.4GB.I tried in my Win 10 VM, no repro. Same with my slower Win 7 laptop.Win 7 Pro 64-bit Version: 5.4.0.0.alpha0+Build ID: ba6b35fc68a01aff72b39eb7809bacb326068668CPU Threads: 4; OS Version: Windows 6.1; UI Render: default; TinderBox: Win-x86@39, Branch:master, Time: 2016-12-13_06:07:39Locale: fi-FI (fi_FI); Calc: groupCreatedWinDBG BacktraceVersion: 5.4.0.0.alpha0+Build ID: d538d3d84172a74dfe97d59a6d3daf9a45459cabCPU Threads: 4; OS Version: Windows 6.19; UI Render: default; TinderBox: Win-x86@39, Branch:master, Time: 2016-12-14_00:28:59Locale: nl-NL (nl_NL); Calc: CL
id=104620	Steps:1. Open2. Scroll downObserved behaviour: LibreOffice crashes right awayReproduced in:Version: 5.4.0.0.alpha0+Build ID: 634589b340316ba64b731b4d923c1056be415494CPU Threads: 4; OS Version: Linux 4.8; UI Render: default; VCL: gtk2; Locale: ca-ES (ca_ES.UTF-8); Calc: groupandVersion: 5.4.0.0.alpha0+Build ID: 634589b340316ba64b731b4d923c1056be415494CPU Threads: 4; OS Version: Linux 4.8; UI Render: default; VCL: gtk3; Locale: ca-ES (ca_ES.UTF-8); Calc: groupbut not inVersion: 5.4.0.0.alpha0+Build ID: 634589b340316ba64b731b4d923c1056be415494CPU Threads: 4; OS Version: Linux 4.8; UI Render: default; VCL: x11; Locale: ca-ES (ca_ES.UTF-8); Calc: group Confirmed with 5.4 daily build (2016-12-10_00:00:32) / Ubuntu 16.04.I can't reproduce it inVersion: 5.3.0.0.alpha1+Build ID: ada8a2123ea655142be74a11c23e042a0109d5f8CPU Threads: 4; OS Version: Linux 4.8; UI Render: default; VCL: gtk3; Layout Engine: new; Locale: ca-ES (ca_ES.UTF-8); Calc: groupCaolán, would you mind to take a look whenever you have time?Xisco, I'll give it a try but if you have a bt to attach, it could be interesting.Createdbacktraceit looksand this one crash at core/sw/source/core/access/accmap.cxx. Adding to See Also*** This bug has been marked as a duplicate of***this isn't a duplicate of the other bug, being master-only and having a completely different stack.regression from:commit ae06f4be6bbdebc10a88c386064d548848e57f80Author: Michael Stahl <>AuthorDate: Wed Dec 7 14:04:24 2016 +0100 tdf#101464 tdf#91260 sw: a11y for partially off-page drawing objectfixed on master.Michael Stahl committed a patch related to this issue.It has been pushed to "master":tdf#101464 tdf#91260 tdf#104620 sw: fix null SwPageFrame crashIt will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.***has been marked as a duplicate of this bug. ***On pc Debian x86-64 with master sources updated today, I don't reproduce this anymore (gtk2/gtk3)
id=104649	is about a crash when opening/scrolling, and has been fixed in Linux. However, there's still a crash upon deleting the text and undoing the deletion.1. open,2. select all,3. delete,4. undo.=> crashTested with 5.3beta2 / Ubuntu 16.04. Confirmed inVersion: 5.4.0.0.alpha0+Build ID: 634589b340316ba64b731b4d923c1056be415494CPU Threads: 4; OS Version: Linux 4.8; UI Render: default; VCL: gtk3; Locale: ca-ES (ca_ES.UTF-8); Calc: groupCreatedbacktraceCreatedbt with symbolsOn pc Debian x86-64 with master sources updated today, I could reproduce this.The weird thing is I get a different bt than Xisco's one.Xisco: if you give a try with a build containing, perhaps you'll get my bt.(I gave a new try with a build containing it, I still reproduce the same bt I had attached)I can reproduce it inVersion: 5.2.0.0.alpha1+Build ID: 5b168b3fa568e48e795234dc5fa454bf24c9805eCPU Threads: 4; OS Version: Linux 4.8; UI Render: default; Locale: ca-ES (ca_ES.UTF-8)InVersion: 5.0.0.0.alpha1+Build ID: 0db96caf0fcce09b87621c11b584a6d81cc7df86Locale: ca-ES (ca_ES.UTF-8)it doesn't crash but it LibreOffice hangs when doing Ctrl+ZJust a couple of observations from debian-stretch ...(*) daily Linux dbgutil bibisect repository version 2016-12-22 exits before displaying any GUI.(*) bibisect-43all version oldest segfaults before dislaying any GUI.I wonder if this bug has been present since the beginning of LibreOffice.Also fails on my win64 lo 5.2.4 released (AMD hw) on Win7.I get unexpected crash and lo attempt to repair the document (always failing with new crash in a loop - never actually seeing the document). When skipping the repair, the document finally opens but I get "SEH Exception: ACCESS VIOLATION" and lo writer disappears without a trace...Writer feels more unstable generally than previous release (I often get unexpected crash and repair also in other more simple documents in odt-format)
id=104687%0D%0A	Description:regression, Version: 5.4.0.0.alpha0+Build ID: b29ae3dace6a6a2e24e531bb648cd3cb97ea3225CPU Threads: 4; OS Version: Linux 4.4; UI Render: default; VCL: gtk2; TinderBox: Linux-rpm_deb-x86_64@70-TDF, Branch:master, Time: 2016-12-14_10:19:59Steps to Reproduce:1.write text to cell2.copy3.right click -> paste only -> textActual Results: crashExpected Results:text pastedReproducible: AlwaysUser Profile Reset: NoAdditional Info:User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:50.0) Gecko/20100101 Firefox/50.0 Could be a dup of tdf#104481 put in see also.Anyway, I could reproduce this on pc Debian x86-64 with master sources updated today.I put the max priority because:- it's a crash- it's a regression- it's a basic use caseit looks more like a duplicate ofRegression introduced by:author Kohei Yoshida <> 2016-11-22 03:56:46 (GMT)committer Kohei Yoshida <> 2016-11-22 13:18:00 (GMT)commit 87e040fd0f04307534920d0765af6d5878794a98 (patch)tree 8faa3f12d311d9c1fc205d9c333e2b15da934894parent a0ef7474521413c8967559a635e6fdc0d88f1df6 (diff)tdf#71409: Stop listening to objects going out-of-focus.This helps eliminate the number of AtkListener objects growingover time.Adding Cc: to Kohei Yoshida***has been marked as a duplicate of this bug. ***On pc Debian x86-64 with master sources updated today, I confirm than just reverting 87e040fd0f04307534920d0765af6d5878794a98 (quoted by Xisco) makes the bug not reproduceable.I tried to understand why it doesn't work on gtk2 but I'm a bit lost.I noticed this part on gtk2#31 0x00002aaac8dc7dc0 in GtkData::Yield (this=0x5555558ae320, bWait=true, bHandleAllCurrentEvents=false) at /home/julien/lo/libreoffice/vcl/unx/gtk/gtkdata.cxx:499#32 0x00002aaac8dcc1b9 in GtkInstance::DoYield (this=0x5555558b9cc0, bWait=true, bHandleAllCurrentEvents=false, nReleased=0) at /home/julien/lo/libreoffice/vcl/unx/gtk/gtkinst.cxx:427#33 0x00002aaab5b599ad in ImplYield (i_bWait=true, i_bAllEvents=false, nReleased=0) at /home/julien/lo/libreoffice/vcl/source/app/svapp.cxx:506#34 0x00002aaab5b55784 in Application::Yield () at /home/julien/lo/libreoffice/vcl/source/app/svapp.cxx:551on gtk3, it goes to vcl/unx/gtk/gtkinst.cxx:427 not in vcl/unx/gtk/gtkdata.cxx:499 but I suppose it's expected.Caolan: since it concerns vcl and a difference of treatment between gtk2/gtk3, thought you might be interested in this one.BTW, will LO abandon gtk2 soon or it isn't expected at all in near future (some months)?Any chance of a back-trace with symbols ? what does the this object look like inside stopListening ? in particular is it a simple NULL mpWrapper de-reference ?Michael: I had put a part of bt here:I got it by typing Ctrl-C when there was the empty popup error.I didn't keep the complete one of.Given the fact that we don't get a crash but an abort, where should I put a break in gdb to retrieve something interesting?Could be that Michael Stahl fixed this in? =)(In reply to Michael Meeks from)it's still reproducible inVersion: 5.4.0.0.alpha0+Build ID: 5a20df55ff829978c880b22e0a1f32c35d0ba30fCPU Threads: 4; OS Version: Linux 4.8; UI Render: default; VCL: gtk2; Locale: ca-ES (ca_ES.UTF-8); Calc: groupCreated3 bts got with __cxa_throwMichael: I followed your advice fromHope these 3 bt help.Revertingmake disappear the crash here but not for tdf#104481@julien FWIW gtk2 isn't going away in any short to medium termCaolán McNamara committed a patch related to this issue.It has been pushed to "master":Resolves: tdf#104687 gtk2 paste cell text under a11y is fatalIt will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.brute force fix, following bt3 and makes it work here again. Might want to check the other gtk2 things after using a popup menu to see if there are also fixedCaolán McNamara committed a patch related to this issue.It has been pushed to "libreoffice-5-3":Resolves: tdf#104687 gtk2 paste cell text under a11y is fatalIt will be available in 5.3.0.1.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Thank you Caolán for the fix. I've retrieved it and gonna test it once local build will be finished. Hope it'll help for tdf#104481 too.Concerning gtk2, thank you for your feedback, I wasn't sure about it.With master sources updated yesterday (which includes the fix for this bugtracker), I don't reproduce the crash.The weird thing is I don't see any log corresponding to this part:catch (const uno::Exception& e) { SAL_INFO("vcl.a11y", "exception: " << e.Message);}After changing locally SAL_INFO to SAL_WARN for the test, I got this:warn:vcl.a11y:17405:1:vcl/unx/gtk/a11y/atkutil.cxx:106: exception: so no exception message here.(idem for tdf#104481)
id=104573	Using an 5.4 master debug build (sources are from 2016-12-10) in Windows 7.1. Open Start Center or an application, Writer for example.2. Click Open File, open File -> Open... or select Open from the toolbar.=> assertion failed: SolarMutex not locked.Same with Save.Version: 5.4.0.0.alpha0+Build ID: 289124284f98bbea442871455cf7da5fe9ef3aaeCPU Threads: 4; OS Version: Windows 6.1; UI Render: GL; Locale: hu-HU (hu_HU); Calc: CL Caused byAlso asserts on dragging files to Start Center windowLet's add Noel to CC.could I get a backtrace(s) please?CreatedCall stackI could only get a call stack from VS debugger, I hope it's helpful.Noel Grandin committed a patch related to this issue.It has been pushed to "master":tdf#104573 - Assertion failed: SolarMutex not locked when tryingIt will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.CreatedAssertion dragging to StartCenter - call stack from VSSorry, didn't notice that Only my code is not uncheckedCreatedThe second assertion after the first was said to "Break"Noel Grandin committed a patch related to this issue.It has been pushed to "master":tdf#104573 - Assertion failed: SolarMutex not lockedIt will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.Noel Grandin committed a patch related to this issue.It has been pushed to "master":tdf#104573 - Assertion failed: SolarMutex not lockedIt will be available in 5.4.0.The patch should be included in the daily builds available atin the next 24-48 hours. Moreinformation about daily builds can be found at:Affected users are encouraged to test the fix and report feedback.CreatedDrag-n-Drop 3CreatedDrag-n-Drop 4And now it's impossible to open the OpenFile dialog - an unhandled exception is thrown.The patch that started this and all of the follow on commits have all been reverted until I have time to do this better. Sorry for the noise.So can we close the bug Noel ? =)
id=104607	Steps:1. Open2. Scroll to the bottom of the document3. Scroll up4. File -> CloseObserved behaviour: LibreOffice crashesReproduced inVersion: 5.4.0.0.alpha0+Build ID: 634589b340316ba64b731b4d923c1056be415494CPU Threads: 4; OS Version: Linux 4.8; UI Render: default; VCL: gtk3; Locale: ca-ES (ca_ES.UTF-8); Calc: group No repro with:Version: 5.4.0.0.alpha0+Build ID: 84f2ff67a7e404febf710b1dc7f66d06745c503fCPU Threads: 4; OS Version: Windows 6.19; UI Render: default; TinderBox: Win-x86@42, Branch:master, Time: 2016-12-09_23:20:01Locale: nl-NL (nl_NL); Calc: CLNo crash.Arch Linux 64-bit, KDE Plasma 5Version: 5.4.0.0.alpha0+Build ID: 1fce5b024e9f25c3fcef2537a22474ece0dc416fCPU Threads: 8; OS Version: Linux 4.8; UI Render: default; VCL: kde4; Locale: fi-FI (fi_FI.UTF-8); Calc: groupBuilt on December 10th 2016Version: 5.4.0.0.alpha0+Build ID: cb598029835477326b190bc99abd31a487cc5a91CPU Threads: 4; OS Version: Windows 6.19; UI Render: default; TinderBox: Win-x86@42, Branch:master, Time: 2016-12-09_00:49:18Locale: fi-FI (fi_FI); Calc: groupI can't reproduce it inVersion: 5.4.0.0.alpha0+Build ID: 634589b340316ba64b731b4d923c1056be415494CPU Threads: 4; OS Version: Linux 4.8; UI Render: default; VCL: x11; Locale: ca-ES (ca_ES.UTF-8); Calc: groupbut I can with gtk3 and gtk2CreatedGDB trace of the crash with 5.4 masterOk, I could repro with GTK3, but as mentioned by Xisco, there needs to be an additional step of saving the file as .DOCX and then continuing from step 2.Xisco reproduced on GTK2 as well. Gen does not cause it.Arch Linux 64-bit, KDE Plasma 5Version: 5.4.0.0.alpha0+Build ID: 1fce5b024e9f25c3fcef2537a22474ece0dc416fCPU Threads: 8; OS Version: Linux 4.8; UI Render: default; VCL: gtk3; Locale: fi-FI (fi_FI.UTF-8); Calc: groupBuilt on December 10th 2016Caolán, would you mind to take a look at this one whenever you have time?*** This bug has been marked as a duplicate of***
