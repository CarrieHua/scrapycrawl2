id=18612	I have some nfs4 mounts triggered by puppet. Sometimes (50% or more) they get mounted readonly when they should be mounted readwrite. This only occurs whenusing puppet. If I do the mount commands by hand they always get mounted readwrite. The obvious thing is to suspect puppet (or my configuration of it) but running puppetd with strace shows:2779 execve("/sbin/mount.nfs4", ["/sbin/mount.nfs4", "fs:/var.Fedora13/spool", "/var/spool", "-o", "rw,intr,intr"], [/* 27 vars */]) = 02779 mount("fs:/var.Fedora13/spool", "/var/spool", "nfs4", 0, "intr,intr,addr=10.0.0.1,clientaddr=10.0.2.245") = 02781 execve("/bin/mount", ["/bin/mount"], [/* 31 vars */]) = 02782 execve("/bin/mount", ["/bin/mount", "-o", "remount", "/var/spool"], [/* 31 vars */]) = 02783 execve("/sbin/mount.nfs4", ["/sbin/mount.nfs4", "fs:/var.Fedora13/spool", "/var/spool", "-o", "rw,remount,intr"], [/* 27 vars */]) = 02783 mount("fs:/var.Fedora13/spool", "/var/spool", 0xb77b7b7a, MS_REMOUNT, "intr,addr=10.0.0.1,clientaddr=10.0.2.245") = 0The "rw" flag is clear to see, yet the mount is "ro":# grep '/var/spool ' /proc/mountsfs:/var.Fedora13/spool /var/spool nfs4 ro,relatime,vers=4,rsize=131072,wsize=131072,namlen=255,hard,proto=tcp,port=0,timeo=600,retrans=2,sec=sys,clientaddr=10.0.2.245,addr=10.0.0.1 0 0The /etc/exports on the server contains:/export 10.0.0.0/8(rw,fsid=0,no_subtree_check,async,no_root_squash)/export/var.Fedora13 *(rw,no_root_squash,async)And /export/var.Fedora13 is a mount point for a logical volume.The only odd things about the puppet triggered mount are that there are two mount system calls in quick succession (a mount followed by a remount) and the "intr" flag is doubled up, which I expect is supposed to be harmless.If I don't start puppetd and manually run the mount commands, I never see the problem.If I do "mount -o remount /var/spool" again, the mount is then changed to "rw".I don't see this problem using nfs3. Very strange! I wonder if there is some sort of race condition, or some data structure not locked when it should be? If this is still seen with modern kernels please update/re-open the bugThis bug is still in 3.17.3-200.fc20.x86_64.One extra quirk is that if there is a bunch of such puppet mounts say /var/cache/man, /var/spool, /var/spool/cups etc, they all end up mounted ro. Then if I do "mount -o remount" for ONE of them, they ALL are remounted rw.Somewhere in the kernel the correct rw mount attributes must be known even though the status in /proc/mounts is ro. Also the mount behaves as ro (ie you can't write to it).
id=33292	Createdls -l /dev/inputHello.I got a new Thinkpad E420s the otherday and have come across a odd problem. This laptop has a touchpad and a trackpoint. Sometimes the trackpoint will be detected and sometimes it will not.Distro: Arch LinuxWhen the trackpoint is detected:*rmmod psmouse results in mouse0 and mouse2 disappearing (ls /dev/input). mouse1 = usb logitech mouse*modprobe psmouse results in mouse0 (the trackpoint) being detected and created right away. However, it takes about 20 seconds for the trackpoint (mouse2) to be created.When the trackpoint is NOT detected I simply have mouse0 (touchpad) and mouse1 (usb logitech mouse)Work / Solution*Reboot into Windows 7. Insure trackpoint works (always does). Reboot into Linux device is detected. In my tests it seems that the device stops getting detected after 6-8 reboots. However, I did also have the problem after resuming from suspend-to-ram.Let me know what information I need to provide and any way that I can help. Createddmesg - trackpoint worksCreateddmesg - no trackpointIt seems that the trackpoint will get detected after a while. I noticed that the trackpoint was detected and started to work after 40 minutes uptime.Apr 18 06:39:40 skynet kernel: [ 7.220899] input: SynPS/2 Synaptics TouchPad as /devices/platform/i8042/serio1/input/input6Apr 18 06:39:40 skynet kernel: [ 7.768977] input: Logitech USB-PS/2 Optical Mouse as /devices/pci0000:00/0000:00:1d.0/usb2/2-1/2-1.2/2-1.2:1.0/input/input7Apr 18 06:39:40 skynet kernel: [ 7.769205] generic-usb 0003:046D:C03D.0001: input,hidraw0: USB HID v1.10 Mouse [Logitech USB-PS/2 Optical Mouse] on usb-0000:00:1d.0-1.2/input0Apr 18 06:39:40 skynet kernel: [ 7.801948] input: Integrated Camera as /devices/pci0000:00/0000:00:1d.0/usb2/2-1/2-1.6/2-1.6:1.0/input/input8Apr 18 06:59:27 skynet kernel: [ 1197.429868] input: PS/2 Generic Mouse as /devices/platform/i8042/serio1/serio2/input/input9As you can see it took about 20 minutes to detect the trackpoint ("PS/2 generic Mouse")I will attach the kernel.log file.Running: 2.6.38.3Createdkernel.logAs you can see, the trackpoint was detected about 20 minutes after the touchpad.I have a similar problem with the X220, from what I found was, if you disable the touchpad in the bios, the trackpoint will work flawlessly. It will be recognized as a IBM Trackpoint device. If you enable the touchpad, the trackpoint is setup as a pass-through device and psmouse_probe() fails to get a valid ID from the controller. Digging deeper it seems like the controller is NAKing ID requests. Could this be a firmware/bios issue?It is found that limiting the ps/2 protocol use to bare (modprobe psmouse proto=bare) makes both the trackpoint and touchpad work on X220. Does this also fix Thinkpad E420s, too?As far as I can tell this seems to fix the problem! However, it is still listed as a "PS/2 Generic Mouse" which isn't a big issue.Is it possible to have psmouse load with proto=bare for this mouse/touchpad? How would something like this be done in the kernel/module (curious)?Just discovered it works, BUT I lose the ability to scroll and do the two finger tap, middle click using the clickpad/touchpad.The trackpoint is detected when the psmouse.c driver realizes it has lost synchronization. So it is probably misdetecting and trying to parse a different protocol. Which also explains why parsing proto=bare works.The question is now: Why is there a difference in functionality when proto=bare is used and when psmouse degrades the protocol by itself.What information is needed from us experiencing the bug to try and address this? Do we need i8042.debug from the time we boot until the time the trackpoint is detected?When using proto=bare, only one input device appears to be detected by psmouse, and both trackpoint and touchpad operate through that device. On the other hand, this device isn't detected to be a touchpad, so the evdev Xorg driver is used instead of the synaptics driver. That's why tapping, and every other touchpad-specific feature does not work.If this is still seen please re-open/update the bug and also post a summary to- thanksThis bug is still present in kernel 3.6.2 on my Thinkpad L430.Likewise, still a problem in kernel 3.6.2-1 on Lenovo Thinkpad L530. Using `psmouse proto=impr` makes the trackpoint usable, but disables multitouch functionality.Still having this problem too, kernel 3.6.2 on Thinkpad E420sI posted this on linux-input sometime back, but either forgot to attach the log files, or they got stripped:I'll attach the log files here instead.Createdi8042.debug output from modprobing psmouse until i8042 settlesCreatedi8042.debug output between attempting to move the undetected trackpoint and i8042 settling againI'm also having this problem on a Lenovo L430 but logged it against.At least the case with the Lenovo L430 touchpad & trackpoint is that when the device is detected as ETPS/2 Elantech Touchpad touching the trackpoint sends a series of bytes which confuses the elantech driver. And leads to lost sync at byte 6 / driver resynced messages.If imps protocol is forced, both trackpoint and touchpad work fine, but advanced configuration possibilities are lost. What I've figured out so far is that in the Elantech/synaptics mode the trackpoint sends 6 byte PS/2ish data:0x30 0x00 0x00 0x06 0xf5 0xfc0x30 0x00 0x00 0x06 0xfa 0xfd0x30 0x00 0x00 0x06 0xfb 0xfe0x30 0x00 0x00 0x06 0xfb 0xfd0x30 0x00 0x00 0x06 0xfb 0xfe0x30 0x00 0x00 0x06 0xf5 0xfb0x30 0x00 0x00 0x06 0xf9 0xfe0x30 0x00 0x00 0x06 0xf5 0xfb0x30 0x00 0x00 0x06 0xfa 0xfd0x30 0x00 0x00 0x06 0xf5 0xfb0x30 0x00 0x00 0x06 0xfa 0xfdWhich should be parsed separately by the Elantech driver or some other driver? Any way the format seems to be something like this1st byte: [possibly Y overflow?, possibly X overflow?, Y sign, X sign, ??, Middle Btn, Right Btn, Left Btn]2nd byte: No idea, most of the time either 0x00 or 0x803rd byte: No idea, most of the time either 0x00 or 0x804th byte: No idea about the 1st half, lower half is 0x6 for trackpoint events5th byte: Rest of the X movement6th byte: Rest of the Y movementWith this I at least was able to hack the elantech driver so that the trackpoint and touchpad are usable, however the problem (besides the unknown data) is that I have no idea how to detect if the device has a trackpoint, so can't really create a patch that would be suitable for other configurations.I have no idea about the elantech+synaptics combination. However, I had a patch() which was to solve the detection of synaptics trackpoint issue mentioned above. Please give it a try and any feedback will be appreciated.(In reply to)This patch didn't change the behavior on an L430 for me but it's an Elantech trackpad. Still see the following in my message log: Nov 8 23:55:52 l430kl kernel: [ 950.573824] psmouse serio1: elantech: assuming hardware version 3 (with firmware version 0x350f02)Nov 8 23:55:52 l430kl kernel: [ 950.587737] psmouse serio1: elantech: Synaptics capabilities query result 0xb9, 0x15, 0x0c.Nov 8 23:55:53 l430kl kernel: [ 950.657384] input: ETPS/2 Elantech Touchpad as /devices/platform/i8042/serio1/input/input14Nov 8 23:56:01 l430kl kernel: [ 959.193698] psmouse serio1: Touchpad at isa0060/serio1/input0 lost sync at byte 6Nov 8 23:56:01 l430kl kernel: [ 959.279526] psmouse serio1: Touchpad at isa0060/serio1/input0 lost sync at byte 6Nov 8 23:56:01 l430kl kernel: [ 959.294517] psmouse serio1: Touchpad at isa0060/serio1/input0 lost sync at byte 6Nov 8 23:56:01 l430kl kernel: [ 959.309014] psmouse serio1: Touchpad at isa0060/serio1/input0 lost sync at byte 6Nov 8 23:56:01 l430kl kernel: [ 959.323015] psmouse serio1: Touchpad at isa0060/serio1/input0 lost sync at byte 6Nov 8 23:56:01 l430kl kernel: [ 959.323024] psmouse serio1: issuing reconnect requestThe timeouts are generated as soon as I touch the trackpoint which doesn't function.Still seeing this problem on my thinkpad e420s, the exact behaviour for me is this:after sleep/wake or start up the touchpad takes a few seconds to be detected, after that I click a trackpoint button, the touchpad stops working for a few seconds, when it starts working again one of two things happens:1. the trackpoint and buttons start working again, along with the touchpad2. the touchpad is working but continuing to press the buttons or trackpoint does nothingit seems completely random which of the above happens, if 2 happens I have to call rmmod psmouse && modprobe psmouse to restart the above, has same effect as sleep/wake. The amount of time it waits varies as well.this is the output from scenario 1, good:[57553.675253] psmouse serio1: synaptics: serio: Synaptics pass-through port at isa0060/serio1/input0[57553.759237] input: SynPS/2 Synaptics TouchPad as /devices/platform/i8042/serio1/input/input19[57563.997514] psmouse serio6: (null) at synaptics-pt/serio0/input0 lost synchronization, throwing 1 bytes away.[57565.808609] input: PS/2 Generic Mouse as /devices/platform/i8042/serio1/serio6/input/input20and 2, bad:[57533.017205] psmouse serio1: synaptics: serio: Synaptics pass-through port at isa0060/serio1/input0[57533.105277] input: SynPS/2 Synaptics TouchPad as /devices/platform/i8042/serio1/input/input18[57553.675233] psmouse serio1: synaptics: Touchpad model: 1, fw: 8.0, id: 0x1e2b1, caps: 0xd001a3/0x940300/0x120c00, board id: 1719, fw id: 727581This is on 3.7.6Fujitsu Lifebook E754, Debian testing, Linux 4.4.6-1 (2016-03-17) x86_64 GNU/Linux...[ 11.040041] psmouse serio5: (null) at synaptics-pt/serio0/input0 lost synchronization, throwing 2 bytes away.[ 12.633371] input: PS/2 Generic Mouse as /devices/platform/i8042/serio2/serio5/input/input9[ 12.782945] psmouse serio2: TouchPad at isa0060/serio2/input0 lost sync at byte 1[ 12.783532] psmouse serio2: TouchPad at isa0060/serio2/input0 lost sync at byte 1[ 12.784136] psmouse serio2: TouchPad at isa0060/serio2/input0 lost sync at byte 1[ 12.784761] psmouse serio2: TouchPad at isa0060/serio2/input0 lost sync at byte 1[ 12.785281] psmouse serio2: TouchPad at isa0060/serio2/input0 lost sync at byte 1[ 12.785285] psmouse serio2: issuing reconnect request...
id=11143	Latest working kernel version:2.6.25Earliest failing kernel version:2.6.26Distribution:openSuSE11.1Hardware Environment:Software Environment:Problem Description:arch/powerpc/Makefile... 77 ifeq ($(CONFIG_PPC64),y)... 93 else 94 LDFLAGS_MODULE += arch/powerpc/lib/crtsavres.o 95 endif...if external modules are build against the source tree, then linking will fail because there is no arch/powerpc/lib/crtsavres.o binary.I see a make scripts and make prepare target, which copies /usr/src/linux/scripts sources to /usr/src/linux-obj/<arch>/<flavor>/Maybe the ctrsavres.S has to be copied as well?Now, if I knew how kbuild works, I could provide a patch. But I do not know, so I opened this bug in the hope that it gets fixed for 2.6.26.1Steps to reproduce: Also happens on 2.6.26.5CreatedFix linking modules against crtsavres.oFix linking modules against crtsavres.oPreviously we got CC drivers/char/hw_random/rng-core.mod.o LD [M] drivers/char/hw_random/rng-core.ko/there/src/buildroot.git.ppc/build_powerpc_nofpu/staging_dir/usr/bin/powerpc-linux-uclibc-ld: arch/powerpc/lib/crtsavres.o: No such file: No such file or directory * Makefile (LDFLAGS_MODULE_PREREQ): New variable to hold prerequisite files for modules. * arch/powerpc/Makefile: add crtsavres.o to LDFLAGS_MODULE_PREREQ. * scripts/Makefile.modpost (cmd_as_o_S): Copy from Makefile.build. (cmd_ld_ko_o): Also link LDFLAGS_MODULE_PREREQ. Provide rule to build objects from assembler.Signed-off-by: Bernhard Reutner-Fischer <see head of patch>Works For Me (tm). Please apply (or adjust if you dislike some aspect).HTH && cheers,BernhardCC'ing Sam since it touches kbuild.Please install.This patch is incomplete, the target .o (or .c) file is not exported.The SuSE, and likely any other kernel-source, tree need also arch/powerpc/lib/crtsavres.c exported....<built-in>:0: fatal error: opening dependency file arch/powerpc/lib/.crtsavres.o.d: No such file or directory...Andreas, can you have a look as well, about what we do in kernel-source for kmp packages?I suspect that generallyobjhdr-$(CONFIG_MODULES) += $(LDFLAGS_MODULE_PREREQ)should be ok since these are all generated. Not sure where to stick the sources of LDFLAGS_MODULE_PREREQ for installation though.Just a thought..Broken on 2.6.27.4, too.Still broken on 2.6.28.3.The patch above fixes the build in case I have write access to the source tree, but this is a new requirement, in the past only read access was enough. (For example when building as a user and the source tree is installed from a distro package.)Still broken in 2.6.30.5.CreatedFix linking modules against crtsavres.oShould export the target .o file, as suggested inby Olaf Hering.It seems that LDFLAGS_MODULE_PREREQ as provided by these patches should be built from some sort of prepare target (potentially modules_prepare?). This is because, as it stands currently it is not possible to build a kernel's external modules using the provided patches in parallel (i.e using DistCC or make -j) Since each module is now forced to rebuild the LDFALGS_MODULE_PREREQ target, each thread has the potential to trample over another's compilation.If this is still seen on modern kernels then please re-open/updateThis issue is still there in 3.14 and 3.15-rc4.arch/powerpc/lib/crtsavres.o is needed to build external modules, but is not created by 'make modules_prepare'That still happens on 3.17. The module doesn't even need to be external.Compiling with M=<some module> also causes the compilation breakage:$ LANG=C PATH=/opt/gcc-4.9.1-nolibc/powerpc64-linux/bin:$PATH CROSS_COMPILE=powerpc64-linux- make ARCH=powerpc M=drivers/media/ WARNING: Symbol version dump ./Module.symvers is missing; modules will have no dependencies and modversions. Building modules, stage 2. MODPOST 562 modules LD [M] drivers/media//common/b2c2/b2c2-flexcop.kopowerpc64-linux-ld: cannot find arch/powerpc/lib/crtsavres.o: No such file or directory LD [M] drivers/media//common/btcx-risc.komake[1]: *** [drivers/media//common/b2c2/b2c2-flexcop.ko] Error 1make[1]: *** Waiting for unfinished jobs....powerpc64-linux-ld: cannot find arch/powerpc/lib/crtsavres.o: No such file or directorymake[1]: *** [drivers/media//common/btcx-risc.ko] Error 1Still present in 4.5.0Reference from Debian BTS:
id=76631	Hi.This is already since quite a while.My Fujitsu Lifebook E782 has a (presumably) Gobi 3000 UMTS modem.It's enabled in the BIOS, a SIM card is plugged... and it actually worked before (unfortunately I don't remember in which kernel version, but it must be something before 3.10, since I've did that report before:Currently I run $ uname -aLinux heisenberg 3.14-1-amd64 #1 SMP Debian 3.14.4-1 (2014-05-13) x86_64 GNU/Linuxand everything else is Debian sid.In the meantime the thing doesn't even show up anymore in:$ lsusb Bus 004 Device 002: ID 8087:0024 Intel Corp. Integrated Rate Matching HubBus 004 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hubBus 003 Device 009: ID 04f2:b2fc Chicony Electronics Co., Ltd Bus 003 Device 004: ID 0489:e052 Foxconn / Hon Hai Bus 003 Device 010: ID 0b97:7772 O2 Micro, Inc. OZ776 CCID Smartcard ReaderBus 003 Device 003: ID 0b97:7761 O2 Micro, Inc. Oz776 1.1 HubBus 003 Device 002: ID 8087:0024 Intel Corp. Integrated Rate Matching HubBus 003 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hubBus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hubBus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hubor:$ lspci 00:00.0 Host bridge: Intel Corporation 3rd Gen Core processor DRAM Controller (rev 09)00:02.0 VGA compatible controller: Intel Corporation 3rd Gen Core processor Graphics Controller (rev 09)00:14.0 USB controller: Intel Corporation 7 Series/C210 Series Chipset Family USB xHCI Host Controller (rev 04)00:16.0 Communication controller: Intel Corporation 7 Series/C210 Series Chipset Family MEI Controller #1 (rev 04)00:16.3 Serial controller: Intel Corporation 7 Series/C210 Series Chipset Family KT Controller (rev 04)00:19.0 Ethernet controller: Intel Corporation 82579LM Gigabit Network Connection (rev 04)00:1a.0 USB controller: Intel Corporation 7 Series/C210 Series Chipset Family USB Enhanced Host Controller #2 (rev 04)00:1b.0 Audio device: Intel Corporation 7 Series/C210 Series Chipset Family High Definition Audio Controller (rev 04)00:1c.0 PCI bridge: Intel Corporation 7 Series/C210 Series Chipset Family PCI Express Root Port 1 (rev c4)00:1c.2 PCI bridge: Intel Corporation 7 Series/C210 Series Chipset Family PCI Express Root Port 3 (rev c4)00:1c.7 PCI bridge: Intel Corporation 7 Series/C210 Series Chipset Family PCI Express Root Port 8 (rev c4)00:1d.0 USB controller: Intel Corporation 7 Series/C210 Series Chipset Family USB Enhanced Host Controller #1 (rev 04)00:1f.0 ISA bridge: Intel Corporation QM77 Express Chipset LPC Controller (rev 04)00:1f.2 SATA controller: Intel Corporation 7 Series Chipset Family 6-port SATA Controller [AHCI mode] (rev 04)00:1f.3 SMBus: Intel Corporation 7 Series/C210 Series Chipset Family SMBus Controller (rev 04)0a:00.0 Network controller: Intel Corporation Centrino Advanced-N 6205 [Taylor Peak] (rev 34)0b:00.0 Unassigned class [ff00]: Realtek Semiconductor Co., Ltd. RTS5229 PCI Express Card Reader (rev 01)Any ideas?Cheers,Chris. Still in 3.19That seems to work again since some versions:$ lsusb Bus 002 Device 002: ID 8087:0024 Intel Corp. Integrated Rate Matching HubBus 002 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hubBus 001 Device 008: ID 04f2:b2fc Chicony Electronics Co., Ltd Bus 001 Device 007: ID 1199:9011 Sierra Wireless, Inc. Bus 001 Device 005: ID 0489:e052 Foxconn / Hon Hai Bus 001 Device 006: ID 0b97:7772 O2 Micro, Inc. OZ776 CCID Smartcard ReaderBus 001 Device 003: ID 0b97:7761 O2 Micro, Inc. Oz776 1.1 HubBus 001 Device 002: ID 8087:0024 Intel Corp. Integrated Rate Matching HubBus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hubBus 004 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hubBus 003 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hubIt's the 1199:9011 Sierra Wireless, Inc..(at least since kernel 4.2.5)And the problem is back with 4.2.6Taking that with the regression back... I booted again with 4.2.5 an the problem remained there as well. So it must have been something else that I did, which had solved the problems for a few boots (though I cannot think of anything that could be)... or there's simply something racy.Attached is a kernel.log from when it worked... with several boots... at one of them it failed and then one sees these:Nov 6 02:07:31 heisenberg kernel: [ 2.365832] usb 1-1.5: new full-speed USB device number 5 using ehci-pciNov 6 02:07:31 heisenberg kernel: [ 2.437874] usb 1-1.5: device descriptor read/64, error -32Nov 6 02:07:31 heisenberg kernel: [ 2.613975] usb 1-1.5: device descriptor read/64, error -32Nov 6 02:07:31 heisenberg kernel: [ 2.774938] scsi 6:0:0:0: Direct-Access JetFlash Transcend 8GB 8.07 PQ: 0 ANSI: 2Nov 6 02:07:31 heisenberg kernel: [ 2.776289] sd 6:0:0:0: [sdb] 15687678 512-byte logical blocks: (8.03 GB/7.47 GiB)Nov 6 02:07:31 heisenberg kernel: [ 2.776578] sd 6:0:0:0: [sdb] Write Protect is offNov 6 02:07:31 heisenberg kernel: [ 2.776663] sd 6:0:0:0: [sdb] Mode Sense: 03 00 00 00Nov 6 02:07:31 heisenberg kernel: [ 2.776924] sd 6:0:0:0: [sdb] No Caching mode page foundNov 6 02:07:31 heisenberg kernel: [ 2.776996] sd 6:0:0:0: [sdb] Assuming drive cache: write throughNov 6 02:07:31 heisenberg kernel: [ 2.790075] usb 1-1.5: new full-speed USB device number 6 using ehci-pciNov 6 02:07:31 heisenberg kernel: [ 2.862110] usb 1-1.5: device descriptor read/64, error -32Nov 6 02:07:31 heisenberg kernel: [ 3.038213] usb 1-1.5: device descriptor read/64, error -32Nov 6 02:07:31 heisenberg kernel: [ 3.126525] clocksource: Switched to clocksource tscNov 6 02:07:31 heisenberg kernel: [ 3.208589] sdb: sdb1 sdb2 sdb3Nov 6 02:07:31 heisenberg kernel: [ 3.210394] sd 6:0:0:0: [sdb] Attached SCSI removable diskNov 6 02:07:31 heisenberg kernel: [ 3.214232] usb 1-1.5: new full-speed USB device number 7 using ehci-pciNov 6 02:07:31 heisenberg kernel: [ 3.622509] usb 1-1.5: device not accepting address 7, error -32Nov 6 02:07:31 heisenberg kernel: [ 3.694575] usb 1-1.5: new full-speed USB device number 8 using ehci-pciNov 6 02:07:31 heisenberg kernel: [ 4.102771] usb 1-1.5: device not accepting address 8, error -321-1.5 is apparently the Gobi device,.. in the cases it worked, these "not accepting address" messages didn't appear.Chris.Createdkern.log
id=63641	CreatedInclude "3D controller" in vgaarb initalizationThis issue arises when laptops with nvidia optimus are used, the secondary video card is not defined as a VGA device, instead (on the Zenbook UX32VD) it's defined as:01:00.0 3D controller: NVIDIA Corporation GF117M [GeForce 610M/710M / GT 620M/625M/630M/720M] (rev ff)Note the "3D controller" rather than the main video card00:02.0 VGA compatible controller: Intel Corporation 3rd Gen Core processor Graphics Controller (rev 09)When booting, the vgaarb reports[ 0.675021] vgaarb: device added: PCI:0000:00:02.0,decodes=io+mem,owns=io+mem,locks=none[ 0.675025] vgaarb: loaded[ 0.675027] vgaarb: bridge control possible 0000:00:02.0Then when the nvidia kernel module is loaded[ 83.698441] bbswitch: enabling discrete graphics[ 84.210385] [drm] Initialized nvidia-drm 0.0.0 20130102 for 0000:01:00.0 on minor 1[ 84.210397] NVRM: loading NVIDIA UNIX x86_64 Kernel Module 331.13 Sun Sep 29 22:56:10 PDT 2013[ 84.536244] vgaarb: this pci device is not a vga device[ 84.540504] nvidia 0000:01:00.0: irq 49 for MSI/MSI-Xvgaarb complains that the the nvidia graphics is not a vga device.A patch is available here (and attached)Which adds "3D controller" to the vgaarb detectionWhen booting with the patch applied:[ 0.679875] vgaarb: device added: PCI:0000:00:02.0,decodes=io+mem,owns=io+mem,locks=none[ 0.679881] vgaarb: device added: PCI:0000:01:00.0,decodes=io+mem,owns=none,locks=none[ 0.679883] vgaarb: loaded[ 0.679884] vgaarb: bridge control possible 0000:01:00.0[ 0.679886] vgaarb: no bridge control possible 0000:00:02.0And loading the nvidia module[ 90.357188] vgaarb: device changed decodes: PCI:0000:01:00.0,olddecodes=io+mem,decodes=none:owns=none[ 90.357530] [drm] Initialized nvidia-drm 0.0.0 20130102 for 0000:01:00.0 on minor 1[ 90.357536] NVRM: loading NVIDIA UNIX x86_64 Kernel Module 331.13 Sun Sep 29 22:56:10 PDT 2013[ 90.642917] nvidia 0000:01:00.0: irq 49 for MSI/MSI-XIt looks like the vgaarb complaint is just a warning, since everything works the same, but should vgaarb be patched to handle this? problems with the non free Nvidia setup should be directed to NvidiaThis bug would arise the same if the nouveau driver is used.This bug is due to the device's PCI ID being listed as a "3D controller" instead of a VGA device, meaning that vgaarb doesn't properly setup its interfaces.Please examine the patch.In which case please provide a trace with nouveau and submit the patch to the lists as per Documentation/SubmittingPatches.From my reading of the PCI spec though the existing code is correct.I guess this is fixed by nowFWIW, it also manifests itself on a MacBook Pro MacBookPro4,1 with a single…01:00.0 VGA compatible controller: NVIDIA Corporation G84M [GeForce 8600M GT] (rev a1)…although rather erratically, but if it does, then every 30 seconds for aslong as the system is up.I have only seen these messages after having booted in EFI mode.Note that adding such 3D controllers to VGA arbitration may have some side-effects not immediately visible (such as blacklight controls that stop working).Have a look atfor such a case.How are the GPUs wired to displays when the nvidia one is flagged as 3D controller?Does the nvidia card have access to displays (via multiplexer) or does it require frames to be passed to Intel card for display? In the second case the nvidia chip is just a graphics/3D accelerator!The vgaarb is being triggered by closed nvidia driver (or maybe userspace) that tries to move VGA IO mappings around when it should not, ending up with vgaarb complaining about a PCI device it is asked to operate on while that device is not a candidate for arbitration.
id=120491	Createdalsa-info.txtHi,sound blaster z 1102:0023 doesn't work on ubuntu 16.04 4.4.14 (4.4.0-25-generic) only front line out works everything else doesn't work (i don't have spdif device didn't test) spdif input detected and working but no sound from front line outextracted latest dsp firmware from windowz driver, new firmware didn't change anythinghda-verb /dev/snd/hwC1D1 0x15 GET_PIN_SENSE 0nid = 0x15, verb = 0xf09, param = 0x0value = 0x2cat /sys/class/sound/hwC1D1/init_pin_configs 0x0b 0x010140100x0c 0x014580f00x0d 0x014570f00x0e 0x01c530f00x0f 0x0221401f0x10 0x022160110x11 0x020120140x12 0x37a791f00x13 0x908700f00x18 0x500000f0Pin 0x0b (Green Line Out, Rear side): present = YesPin 0x0c (Purple SPDIF Out, Rear side): present = NoPin 0x0d (Yellow SPDIF Out, Rear side): present = NoPin 0x0e (Blue SPDIF In, Rear side): present = YesPin 0x0f (Green Headphone, Front side): present = NoPin 0x10 (Orange Headphone, Front side): present = NoPin 0x11 (Grey Line Out, Front side): present = YesPin 0x12 (Pink Mic, Mobile-In): present = YesPin 0x13 (Internal Line In): present = NoPin 0x18 (Not connected): present = No i should sell this card it's dead end anyway1102:0023 works fine(all ports) with freebsd 11 but only generic hda driver supportedverbose info with pin config from freebsdhdacc0: <Creative CA0132 HDA CODEC> at cad 1 on hdac0hdaa0: <Creative CA0132 Audio Function Group> at nid 1 on hdacc0hdaa0: Subsystem ID: 0x11020023hdaa0: NumGPIO=0 NumGPO=0 NumGPI=0 GPIWake=1 GPIUnsol=1hdaa0: Original pins configuration:hdaa0: nid 0x as seq device conn jack loc color mischdaa0: 11 410140f0 15 0 Line-out None 1/8 Rear Green 0hdaa0: 12 014520f0 15 0 SPDIF-out Jack Optical Rear Grey 0hdaa0: 13 010170f0 15 0 Line-out Jack 1/8 Rear Yellow 0hdaa0: 14 01c510f0 15 0 SPDIF-in Jack Optical Rear Black 0hdaa0: 15 412000f0 15 0 Headphones None Unknown Rear Unknown 0hdaa0: 16 022140f0 15 0 Headphones Jack 1/8 Front Green 0hdaa0: 17 418120f0 15 0 Line-in None 1/8 Rear Grey 0hdaa0: 18 01a190f0 15 0 Mic Jack 1/8 Rear Pink 0hdaa0: 19 50d000f0 15 0 Digital-in None Unknown Internal Unknown 0hdaa0: 24 500000f0 15 0 Line-out None Unknown Internal Unknown 0hdaa0: Patched pins configuration:hdaa0: nid 0x as seq device conn jack loc color mischdaa0: 11 410140f0 15 0 Line-out None 1/8 Rear Green 0 DISAhdaa0: 12 014520f0 15 0 SPDIF-out Jack Optical Rear Grey 0hdaa0: 13 010170f0 15 0 Line-out Jack 1/8 Rear Yellow 0hdaa0: 14 01c510f0 15 0 SPDIF-in Jack Optical Rear Black 0hdaa0: 15 412000f0 15 0 Headphones None Unknown Rear Unknown 0 DISAhdaa0: 16 022140f0 15 0 Headphones Jack 1/8 Front Green 0hdaa0: 17 418120f0 15 0 Line-in None 1/8 Rear Grey 0 DISAhdaa0: 18 01a190f0 15 0 Mic Jack 1/8 Rear Pink 0hdaa0: 19 50d000f0 15 0 Digital-in None Unknown Internal Unknown 0 DISAhdaa0: 24 500000f0 15 0 Line-out None Unknown Internal Unknown 0 DISAhdaa0: 5 associations found:hdaa0: Association 0 (15) out:hdaa0: Pin nid=12 seq=0hdaa0: Association 1 (15) out:hdaa0: Pin nid=13 seq=0hdaa0: Association 2 (15) in:hdaa0: Pin nid=14 seq=0hdaa0: Association 3 (15) out:hdaa0: Pin nid=16 seq=0hdaa0: Association 4 (15) in:hdaa0: Pin nid=18 seq=0hdaa0: Tracing association 0 (15)hdaa0: Pin 12 traced to DAC 5hdaa0: Association 0 (15) trace succeededhdaa0: Tracing association 1 (15)hdaa0: Pin 13 traced to DAC 6hdaa0: Association 1 (15) trace succeededhdaa0: Tracing association 2 (15)hdaa0: Unable to trace pin 14 to ADC 7, undo traceshdaa0: Unable to trace pin 14 to ADC 8, undo traceshdaa0: Pin 14 traced to ADC 9hdaa0: Association 2 (15) trace succeededhdaa0: Tracing association 3 (15)hdaa0: Pin 16 traced to DAC 3hdaa0: Association 3 (15) trace succeededhdaa0: Tracing association 4 (15)hdaa0: Pin 18 traced to ADC 7hdaa0: Association 4 (15) trace succeededhdaa0: Looking for additional DAC for association 0 (15)hdaa0: Looking for additional DAC for association 1 (15)hdaa0: Looking for additional ADC for association 2 (15)hdaa0: Looking for additional DAC for association 3 (15)hdaa0: Looking for additional ADC for association 4 (15)hdaa0: Tracing input monitorhdaa0: Tracing other input monitorshdaa0: Tracing nid 14 to outhdaa0: Tracing nid 18 to outhdaa0: Tracing beeperhdaa0: Pin sense: nid=16 sense=0x80000000 (connected)hdaa0: Pin sense: nid=18 sense=0x80000000 (connected)hdaa0: FG config/quirks: forcestereo ivref50 ivref80 ivref100 ivrefpcm0: <Creative CA0132 (Rear Digital)> at nid 12 and 14 on hdaa0pcm0: Playback:pcm0: Stream cap: 0x00000005 AC3 PCMpcm0: PCM cap: 0x000a01e0 16 24 bits, 44 48 88 96 KHzpcm0: DAC: 5pcm0: pcm0: nid=12 [pin: SPDIF-out (Grey Jack)]pcm0: + <- nid=5 [audio output] [src: pcm]pcm0: pcm0: Record:pcm0: Stream cap: 0x00000005 AC3 PCMpcm0: PCM cap: 0x000a01f0 16 24 bits, 32 44 48 88 96 KHzpcm0: ADC: 9pcm0: pcm0: nid=9 [audio input]pcm0: + <- nid=14 [pin: SPDIF-in (Black Jack)] [src: dig1]pcm0: pcm0: Speaker/Beep Volume (OSS: speaker): -46/0dBpcm0: +- ctl 5 (nid 20 out): -46/0dB (32 steps) + mutepcm0: pcm0: Mixer "vol" -> "none": child=0x00000010pcm0: Mixer "pcm": parent="vol"pcm0: Mixer "speaker":pcm0: Soft PCM mixer ENABLEDpcm0: Playback channel set is: Front Left, Front Right, pcm0: Playback channel matrix is: 2.0 (unknown)pcm0: Automatically set rec source to: dig1pcm0: Recording channel set is: Front Left, Front Right, pcm0: Recording channel matrix is: 2.0 (unknown)random: harvesting attach, 8 bytes (4 bits) from pcm0pcm1: <Creative CA0132 (Rear Analog)> at nid 13 and 18 on hdaa0pcm1: Playback:pcm1: Stream cap: 0x00000001 PCMpcm1: PCM cap: 0x000a05e0 16 24 bits, 44 48 88 96 192 KHzpcm1: DAC: 6pcm1: pcm1: nid=13 [pin: Line-out (Yellow Jack)]pcm1: + <- nid=6 [audio output] [src: pcm]pcm1: pcm1: Record:pcm1: Stream cap: 0x00000001 PCMpcm1: PCM cap: 0x000a01e4 16 24 bits, 16 44 48 88 96 KHzpcm1: ADC: 7pcm1: pcm1: nid=7 [audio input]pcm1: + <- nid=18 [pin: Mic (Pink Jack)] [src: mic]pcm1: pcm1: Microphone Volume (OSS: mic): 0/30dBpcm1: +- ctl 1 (nid 7 in 0): 0/23dB (24 steps)pcm1: +- ctl 4 (nid 18 out): 0/30dB (4 steps)pcm1: pcm1: Recording Level (OSS: rec): 0/23dBpcm1: +- ctl 1 (nid 7 in 0): 0/23dB (24 steps)pcm1: +- ctl 4 (nid 18 out): 0/30dB (4 steps)pcm1: pcm1: Mixer "vol" -> "none": child=0x00000010pcm1: Mixer "pcm": parent="vol"pcm1: Mixer "mic":pcm1: Mixer "rec":pcm1: Soft PCM mixer ENABLEDpcm1: Playback channel set is: Front Left, Front Right, pcm1: Playback channel matrix is: 2.0 (disconnected)pcm1: Automatically set rec source to: micpcm1: Recording channel set is: Front Left, Front Right, pcm1: Recording channel matrix is: 2.0 (connected)random: harvesting attach, 8 bytes (4 bits) from pcm1pcm2: <Creative CA0132 (Front Analog Headphones)> at nid 16 on hdaa0pcm2: Playback:pcm2: Stream cap: 0x00000001 PCMpcm2: PCM cap: 0x000a05e4 16 24 bits, 16 44 48 88 96 192 KHzpcm2: DAC: 3pcm2: pcm2: nid=16 [pin: Headphones (Green Jack)]pcm2: + <- nid=3 [audio output] [src: pcm]pcm2: pcm2: Mixer "vol" -> "none": child=0x00000010pcm2: Mixer "pcm": parent="vol"pcm2: Soft PCM mixer ENABLEDpcm2: Playback channel set is: Front Left, Front Right, pcm2: Playback channel matrix is: 2.0 (connected)random: harvesting attach, 8 bytes (4 bits) from pcm2Pin configs from windowz registry and they are same as freebsd configsthat's all for now stay tune :)NID: 11Node: 0x0bPin: 0x410140f0Verb 00B71CF0 00B71D40 00B71E01 00B71F41 NID: 12Node: 0x0cPin: 0x014520f0Verb 00C71CF0 00C71D20 00C71E45 00C71F01 NID: 13Node: 0x0dPin: 0x010171f0Verb 00D71CF0 00D71D71 00D71E01 00D71F01 NID: 14Node: 0x0ePin: 0x01c510f0Verb 00E71CF0 00E71D10 00E71EC5 00E71F01 NID: 15Node: 0x0fPin: 0x412000f0Verb 00F71CF0 00F71D00 00F71E20 00F71F41 NID: 16Node: 0x10Pin: 0x022140f0Verb 01071CF0 01071D40 01071E21 01071F02 NID: 17Node: 0x11Pin: 0x418120f0Verb 01171CF0 01171D20 01171E81 01171F41 NID: 18Node:0x12Pin:0x01a190f0Verb 01271CF0 01271D90 01271EA1 01271F01 NID: 19Node:0x13Pin:0x50d000f0Verb 01371CF0 01371D00 01371ED0 01371F50 NID: 24Node:0x18Pin:0x500000f0Verb 01871CF0 01871D00 01871E00 01871F50little digging with hd audio utility from windows sidei found some widget controls and they were enabled with windows driverso i tried one by one or all of them I got sound from rear but it was static noise in loud :)hda-verb /dev/snd/hwC1D1 0x0b SET_PIN_WIDGET_CONTROL 0x40 > Out Enablehda-verb /dev/snd/hwC1D1 0x10 SET_PIN_WIDGET_CONTROL 0xc0 > Out Enable/H-phone enablehda-verb /dev/snd/hwC1D1 0x0f SET_PIN_WIDGET_CONTROL 0x00 > it's enabled with 0x40 connected with front panel jack this is for disablehda-verb /dev/snd/hwC1D1 0x11 SET_PIN_WIDGET_CONTROL 0x44 > Out Enablehda-verb /dev/snd/hwC1D1 0x15 SET_PIN_WIDGET_CONTROL 0xe7 > In enable/Out enable/H-phone out enable#!/bin/bashCA0132fs=/sys/devices/virtual/sound/hdaudioC0D1/hwC1D1echo "0x0b 0x410140f0" > $CA0132fs/user_pin_configsecho "0x0c 0x014520f0" > $CA0132fs/user_pin_configsecho "0x0d 0x010170f0" > $CA0132fs/user_pin_configsecho "0x0e 0x01c510f0" > $CA0132fs/user_pin_configsecho "0x0f 0x412000f0" > $CA0132fs/user_pin_configsecho "0x10 0x022140f0" > $CA0132fs/user_pin_configsecho "0x11 0x418120f0" > $CA0132fs/user_pin_configsecho "0x12 0x01a190f0" > $CA0132fs/user_pin_configsecho "0x13 0x50d000f0" > $CA0132fs/user_pin_configsecho "0x18 0x500000f0" > $CA0132fs/user_pin_configsecho 1 > $CA0132fs/reconfig@Takashi IwaiHi, I suppose so this card won't work anytime soon with linux am i right ?Createdalsa-info with generic driverwith generic module pin configs correctly detected as windows/freebsd driverbut no sound both sidesI have the same problem, 1102:0023.
id=134661	CreateddmesgI hit this while running xfs_fsr on some files. I do not have any issues running 4.1.27 (and below). System continues running without problem, no files corrupted.swapper/1: page allocation failure: order:0, mode:0x2204010...SLUB: Unable to allocate memory on node -1 (gfp=0x2000000)...DMA-API: cacheline tracking ENOMEM, dma-debug disabledAfter three stack dumps, no more errors appears, maybe related to DMA-API debug? CreatedconfigCurrently, running 4.4.23, no issues. I guess this was fixed in 4.4.17 with commit 5b3114b2af2fe1cf6d465d594faefaea6c1f328b [mm, sl[au]b: add __GFP_ATOMIC to the GFP reclaim mask]Reopening, just happens again.[168399.414448] mc: page allocation failure: order:0, mode:0x2204010[168399.414455] CPU: 0 PID: 29746 Comm: mc Tainted: P O 4.4.23 #1[168399.414457] Hardware name: System manufacturer System Product Name/M2N32-SLI DELUXE, BIOS ASUS M2N32-SLI DELUXE ACPI BIOS Revision 1603 12/17/2007[168399.414459] 0000000000000000 ffff880112f8b6a8 ffffffff811bf07a 0000000002204010[168399.414463] 0000000000000000 ffff880112f8b730 ffffffff810caa02 ffffffff8163e7c8[168399.414465] ffffffff8163e8b8 0000000000000000 ffffffff8163f9b0 ffffffff00000002[168399.414468] Call Trace:[168399.414474] [<ffffffff811bf07a>] dump_stack+0x4d/0x63[168399.414477] [<ffffffff810caa02>] warn_alloc_failed+0xe2/0x130[168399.414480] [<ffffffff810cd6f1>] __alloc_pages_nodemask+0x6e1/0x830[168399.414483] [<ffffffff8110269c>] new_slab+0x27c/0x2e0[168399.414486] [<ffffffff81104647>] ___slab_alloc.constprop.27+0x2e7/0x3c0[168399.414489] [<ffffffff811c3aae>] ? radix_tree_node_alloc.isra.1+0x2e/0x70[168399.414491] [<ffffffff810c8250>] ? mempool_alloc_slab+0x10/0x20[168399.414494] [<ffffffff810c84e2>] ? mempool_alloc+0x62/0x160[168399.414496] [<ffffffff811d05f8>] ? find_next_bit+0x18/0x20[168399.414499] [<ffffffff8109d75d>] ? __module_text_address+0xd/0x60[168399.414502] [<ffffffff810a0b80>] ? is_module_text_address+0x10/0x30[168399.414504] [<ffffffff81104738>] __slab_alloc.isra.24.constprop.26+0x18/0x20[168399.414506] [<ffffffff811047e0>] kmem_cache_alloc+0xa0/0xd0[168399.414509] [<ffffffff811c3aae>] radix_tree_node_alloc.isra.1+0x2e/0x70[168399.414511] [<ffffffff811c3b71>] __radix_tree_create+0x81/0x200[168399.414513] [<ffffffff811c3d23>] radix_tree_insert+0x33/0xc0[168399.414516] [<ffffffff811e1b7c>] add_dma_entry+0x9c/0x150[168399.414519] [<ffffffff811e1f66>] debug_dma_map_sg+0x116/0x140[168399.414528] [<ffffffffa00a3e65>] ata_qc_issue+0x185/0x360 [libata][168399.414533] [<ffffffffa00a9fa0>] ? ata_scsi_invalid_field+0x40/0x40 [libata][168399.414538] [<ffffffffa00aa258>] ata_scsi_translate+0xb8/0x190 [libata][168399.414543] [<ffffffffa00ac4d9>] ata_scsi_queuecmd+0xa9/0x260 [libata][168399.414549] [<ffffffffa005c5a1>] scsi_dispatch_cmd+0x81/0xd0 [scsi_mod][168399.414553] [<ffffffffa005f209>] scsi_request_fn+0x2b9/0x530 [scsi_mod][168399.414556] [<ffffffff8119bfcd>] __blk_run_queue+0x2d/0x40[168399.414559] [<ffffffff8119fbfc>] blk_flush_plug_list+0x1dc/0x250[168399.414561] [<ffffffff8119ff67>] blk_finish_plug+0x27/0x40[168399.414564] [<ffffffff810d1669>] __do_page_cache_readahead+0x1a9/0x230[168399.414566] [<ffffffff810d17c3>] ondemand_readahead+0xd3/0x280[168399.414568] [<ffffffff810d19f0>] page_cache_async_readahead+0x80/0x90[168399.414571] [<ffffffff810c7372>] generic_file_read_iter+0x3c2/0x580[168399.414574] [<ffffffff8110f604>] __vfs_read+0xa4/0xd0[168399.414576] [<ffffffff8110fda0>] vfs_read+0x90/0x140[168399.414578] [<ffffffff81110a9a>] SyS_read+0x4a/0xb0[168399.414582] [<ffffffff8133b0d7>] entry_SYSCALL_64_fastpath+0x12/0x66[168399.414583] Mem-Info:[168399.414587] active_anon:380840 inactive_anon:318914 isolated_anon:0 active_file:85899 inactive_file:142515 isolated_file:0 unevictable:0 dirty:9552 writeback:25587 unstable:0 slab_reclaimable:13222 slab_unreclaimable:11858 mapped:168956 shmem:203495 pagetables:10058 bounce:0 free:6192 free_pcp:33 free_cma:0[168399.414596] DMA free:14708kB min:28kB low:32kB high:40kB active_anon:0kB inactive_anon:0kB active_file:92kB inactive_file:20kB unevictable:0kB isolated(anon):0kB isolated(file):0kB present:15992kB managed:15908kB mlocked:0kB dirty:0kB writeback:0kB mapped:60kB shmem:0kB slab_reclaimable:4kB slab_unreclaimable:140kB kernel_stack:0kB pagetables:0kB unstable:0kB bounce:0kB free_pcp:0kB local_pcp:0kB free_cma:0kB writeback_tmp:0kB pages_scanned:0 all_unreclaimable? no[168399.414598] lowmem_reserve[]: 0 3297 3866 3866[168399.414605] DMA32 free:8960kB min:6768kB low:8460kB high:10152kB active_anon:1332320kB inactive_anon:1057420kB active_file:298184kB inactive_file:493948kB unevictable:0kB isolated(anon):0kB isolated(file):0kB present:3521408kB managed:3449772kB mlocked:0kB dirty:32800kB writeback:88644kB mapped:580740kB shmem:683148kB slab_reclaimable:44364kB slab_unreclaimable:38988kB kernel_stack:5616kB pagetables:34800kB unstable:0kB bounce:0kB free_pcp:12kB local_pcp:12kB free_cma:0kB writeback_tmp:0kB pages_scanned:12 all_unreclaimable? no[168399.414607] lowmem_reserve[]: 0 0 569 569[168399.414613] Normal free:1100kB min:1168kB low:1460kB high:1752kB active_anon:191040kB inactive_anon:218236kB active_file:45320kB inactive_file:76092kB unevictable:0kB isolated(anon):0kB isolated(file):0kB present:655360kB managed:583256kB mlocked:0kB dirty:5408kB writeback:13704kB mapped:95024kB shmem:130832kB slab_reclaimable:8520kB slab_unreclaimable:8304kB kernel_stack:1568kB pagetables:5432kB unstable:0kB bounce:0kB free_pcp:120kB local_pcp:120kB free_cma:0kB writeback_tmp:0kB pages_scanned:0 all_unreclaimable? no[168399.414615] lowmem_reserve[]: 0 0 0 0[168399.414617] DMA: 5*4kB (UME) 6*8kB (UME) 5*16kB (UME) 1*32kB (E) 3*64kB (UME) 2*128kB (UE) 3*256kB (UME) 2*512kB (ME) 2*1024kB (ME) 3*2048kB (UME) 1*4096kB (M) = 14708kB[168399.414628] DMA32: 1018*4kB (UE) 191*8kB (UME) 198*16kB (UME) 6*32kB (UM) 0*64kB 0*128kB 0*256kB 0*512kB 0*1024kB 0*2048kB 0*4096kB = 8960kB[168399.414635] Normal: 277*4kB (UME) 6*8kB (ME) 0*16kB 0*32kB 0*64kB 0*128kB 0*256kB 0*512kB 0*1024kB 0*2048kB 0*4096kB = 1156kB[168399.414642] 432371 total pagecache pages[168399.414644] 458 pages in swap cache[168399.414645] Swap cache stats: add 20940, delete 20482, find 470/676[168399.414646] Free swap = 16698372kB[168399.414647] Total swap = 16777212kB[168399.414648] 1048190 pages RAM[168399.414649] 0 pages HighMem/MovableOnly[168399.414650] 35956 pages reserved[168399.414652] SLUB: Unable to allocate memory on node -1 (gfp=0x2000000)[168399.414654] cache: radix_tree_node, object size: 576, buffer size: 584, default order: 1, min order: 0[168399.414656] node 0: slabs: 3042, objs: 42588, free: 0[168399.414657] DMA-API: cacheline tracking ENOMEM, dma-debug disabledLooking around, there is a similar downstream report about PF on 4.4.X, same order/flags, but different scenario, hereI am currently running with min_free_kbytes with 32MiB instead of default of ~8MiB, to see if happens at some time.I just hit the issue again, at least this time was due memory pressure, and high swap activity due writing to tmpfs, reading from xfs.According to my understand about debug message, there are at least sufficient free pages of order 0 in all zones. So this is a bug? Any hint how to track it?[457301.466722] mkvmerge: page allocation failure: order:0, mode:0x2204010[457301.466729] CPU: 0 PID: 29877 Comm: mkvmerge Tainted: P O 4.4.27 #1[457301.466732] Hardware name: System manufacturer System Product Name/M2N32-SLI DELUXE, BIOS ASUS M2N32-SLI DELUXE ACPI BIOS Revision 1603 12/17/2007[457301.466734] 0000000000000000 ffff880002583578 ffffffff811be0aa 0000000002204010[457301.466737] 0000000000000000 ffff880002583600 ffffffff810c99b2 ffffffff8163e548[457301.466740] ffffffff8163e638 0000000000000000 ffffffff8163f730 ffff880000000002[457301.466742] Call Trace:[457301.466748] [<ffffffff811be0aa>] dump_stack+0x4d/0x63[457301.466752] [<ffffffff810c99b2>] warn_alloc_failed+0xe2/0x130[457301.466755] [<ffffffff810cc6a1>] __alloc_pages_nodemask+0x6e1/0x830[457301.466758] [<ffffffff810e2d9c>] ? list_lru_add+0x5c/0x70[457301.466761] [<ffffffff8110165c>] new_slab+0x27c/0x2e0[457301.466763] [<ffffffff81103607>] ___slab_alloc.constprop.27+0x2e7/0x3c0[457301.466766] [<ffffffff811c282e>] ? radix_tree_node_alloc.isra.1+0x2e/0x70[457301.466768] [<ffffffff81060847>] ? update_curr+0x77/0x100[457301.466772] [<ffffffff8116dca2>] ? kernfs_path_locked+0x32/0x80[457301.466774] [<ffffffff811bab91>] ? cfq_remove_request+0xf1/0x180[457301.466777] [<ffffffff8109c51d>] ? __module_text_address+0xd/0x60[457301.466779] [<ffffffff8109f940>] ? is_module_text_address+0x10/0x30[457301.466782] [<ffffffff811036f8>] __slab_alloc.isra.24.constprop.26+0x18/0x20[457301.466784] [<ffffffff811037a0>] kmem_cache_alloc+0xa0/0xd0[457301.466786] [<ffffffff811c282e>] radix_tree_node_alloc.isra.1+0x2e/0x70[457301.466788] [<ffffffff811c28f1>] __radix_tree_create+0x81/0x200[457301.466790] [<ffffffff811c2aa3>] radix_tree_insert+0x33/0xc0[457301.466793] [<ffffffff811e07dc>] add_dma_entry+0x9c/0x150[457301.466795] [<ffffffff811e0bc6>] debug_dma_map_sg+0x116/0x140[457301.466804] [<ffffffffa00cce65>] ata_qc_issue+0x185/0x360 [libata][457301.466809] [<ffffffffa00d2fa0>] ? ata_scsi_invalid_field+0x40/0x40 [libata][457301.466814] [<ffffffffa00d3258>] ata_scsi_translate+0xb8/0x190 [libata][457301.466819] [<ffffffffa00d54d9>] ata_scsi_queuecmd+0xa9/0x260 [libata][457301.466825] [<ffffffffa00605a1>] scsi_dispatch_cmd+0x81/0xd0 [scsi_mod][457301.466830] [<ffffffffa0063209>] scsi_request_fn+0x2b9/0x530 [scsi_mod][457301.466832] [<ffffffff81087552>] ? lock_timer_base.isra.2+0x52/0x70[457301.466835] [<ffffffff8119af9d>] __blk_run_queue+0x2d/0x40[457301.466837] [<ffffffff811bc321>] cfq_insert_request+0x441/0x560[457301.466840] [<ffffffff8119a7a0>] __elv_add_request+0x120/0x200[457301.466842] [<ffffffff8119ebfa>] blk_flush_plug_list+0x20a/0x250[457301.466845] [<ffffffff8119ef37>] blk_finish_plug+0x27/0x40[457301.466847] [<ffffffff810d0619>] __do_page_cache_readahead+0x1a9/0x230[457301.466849] [<ffffffff810d0773>] ondemand_readahead+0xd3/0x280[457301.466852] [<ffffffff811c2be3>] ? radix_tree_lookup_slot+0x13/0x30[457301.466854] [<ffffffff810d09a0>] page_cache_async_readahead+0x80/0x90[457301.466856] [<ffffffff810c6322>] generic_file_read_iter+0x3c2/0x580[457301.466859] [<ffffffff8122fdec>] ? tty_write_unlock+0x2c/0x30[457301.466882] [<ffffffffa1547c91>] xfs_file_read_iter+0xe1/0x230 [xfs][457301.466884] [<ffffffff8110e5c4>] __vfs_read+0xa4/0xd0[457301.466887] [<ffffffff8110ed60>] vfs_read+0x90/0x140[457301.466889] [<ffffffff8110fa5a>] SyS_read+0x4a/0xb0[457301.466891] [<ffffffff8110eac1>] ? SyS_lseek+0x71/0xc0[457301.466894] [<ffffffff81339d17>] entry_SYSCALL_64_fastpath+0x12/0x66[457301.466896] Mem-Info:[457301.466900] active_anon:335339 inactive_anon:229031 isolated_anon:94 active_file:179287 inactive_file:173874 isolated_file:0 unevictable:0 dirty:7 writeback:13282 unstable:0 slab_reclaimable:17357 slab_unreclaimable:14029 mapped:63270 shmem:243360 pagetables:8301 bounce:0 free:13411 free_pcp:30 free_cma:0[457301.466908] DMA free:14812kB min:128kB low:160kB high:192kB active_anon:0kB inactive_anon:0kB active_file:16kB inactive_file:0kB unevictable:0kB isolated(anon):0kB isolated(file):0kB present:15992kB managed:15908kB mlocked:0kB dirty:0kB writeback:0kB mapped:4kB shmem:0kB slab_reclaimable:0kB slab_unreclaimable:140kB kernel_stack:0kB pagetables:0kB unstable:0kB bounce:0kB free_pcp:0kB local_pcp:0kB free_cma:0kB writeback_tmp:0kB pages_scanned:4 all_unreclaimable? no[457301.466910] lowmem_reserve[]: 0 3368 3938 3938[457301.466917] DMA32 free:30112kB min:27916kB low:34892kB high:41872kB active_anon:1213184kB inactive_anon:748588kB active_file:599120kB inactive_file:581508kB unevictable:0kB isolated(anon):376kB isolated(file):0kB present:3521408kB managed:3449784kB mlocked:0kB dirty:24kB writeback:44668kB mapped:224304kB shmem:824696kB slab_reclaimable:59260kB slab_unreclaimable:46048kB kernel_stack:5152kB pagetables:28336kB unstable:0kB bounce:0kB free_pcp:120kB local_pcp:120kB free_cma:0kB writeback_tmp:0kB pages_scanned:0 all_unreclaimable? no[457301.466919] lowmem_reserve[]: 0 0 569 569[457301.466925] Normal free:8720kB min:4720kB low:5900kB high:7080kB active_anon:128172kB inactive_anon:167536kB active_file:118012kB inactive_file:113988kB unevictable:0kB isolated(anon):0kB isolated(file):0kB present:655360kB managed:583256kB mlocked:0kB dirty:4kB writeback:8460kB mapped:28772kB shmem:148744kB slab_reclaimable:10168kB slab_unreclaimable:9928kB kernel_stack:1104kB pagetables:4868kB unstable:0kB bounce:0kB free_pcp:0kB local_pcp:0kB free_cma:0kB writeback_tmp:0kB pages_scanned:20 all_unreclaimable? no[457301.466927] lowmem_reserve[]: 0 0 0 0[457301.466930] DMA: 5*4kB (UM) 5*8kB (UM) 6*16kB (UM) 2*32kB (M) 2*64kB (UM) 1*128kB (U) 2*256kB (UM) 1*512kB (M) 1*1024kB (M) 2*2048kB (UM) 2*4096kB (ME) = 14812kB[457301.466940] DMA32: 1660*4kB (UE) 2932*8kB (UME) 3*16kB (M) 0*32kB 0*64kB 0*128kB 0*256kB 0*512kB 0*1024kB 0*2048kB 0*4096kB = 30144kB[457301.466947] Normal: 931*4kB (UMEH) 87*8kB (UMEH) 42*16kB (UMEH) 10*32kB (H) 7*64kB (H) 5*128kB (H) 3*256kB (H) 3*512kB (H) 0*1024kB 0*2048kB 0*4096kB = 8804kB[457301.466956] 621801 total pagecache pages[457301.466958] 25305 pages in swap cache[457301.466960] Swap cache stats: add 3463261, delete 3437956, find 806762/945655[457301.466961] Free swap = 14921044kB[457301.466962] Total swap = 16777212kB[457301.466963] 1048190 pages RAM[457301.466964] 0 pages HighMem/MovableOnly[457301.466965] 35953 pages reserved[457301.466967] SLUB: Unable to allocate memory on node -1 (gfp=0x2000000)[457301.466969] cache: radix_tree_node, object size: 576, buffer size: 584, default order: 1, min order: 0[457301.466971] node 0: slabs: 6075, objs: 85050, free: 0[457301.466972] DMA-API: cacheline tracking ENOMEM, dma-debug disabledIt happens again after the last report, even with now min_free_kbytes=65536.swapper/1: page allocation failure: order:0, mode:0x2204010CPU: 1 PID: 0 Comm: swapper/1 Tainted: P O 4.4.30 #1Hardware name: System manufacturer System Product Name/M2N32-SLI DELUXE, BIOS ASUS M2N32-SLI DELUXE ACPI BIOS Revision 1603 12/17/2007 0000000000000000 ffff880127d039d8 ffffffff811be2ca 0000000002204010 0000000000000000 ffff880127d03a60 ffffffff810c99d2 0000000000000046 ffff880127d03a20 0000000000000000 ffffffff8163f730 0000000000000000Call Trace: <IRQ> [<ffffffff811be2ca>] dump_stack+0x4d/0x63 [<ffffffff810c99d2>] warn_alloc_failed+0xe2/0x130 [<ffffffff810cc6c1>] __alloc_pages_nodemask+0x6e1/0x830 [<ffffffff812f8e7d>] ? __udp_queue_rcv_skb+0x4d/0xd0 [<ffffffff8110165c>] new_slab+0x27c/0x2e0 [<ffffffff81103607>] ___slab_alloc.constprop.27+0x2e7/0x3c0 [<ffffffff812cbf80>] ? ip_local_deliver_finish+0x1b0/0x200 [<ffffffff811c2a4e>] ? radix_tree_node_alloc.isra.1+0x2e/0x70 [<ffffffff8109c51d>] ? __module_text_address+0xd/0x60 [<ffffffff8109f940>] ? is_module_text_address+0x10/0x30 [<ffffffff811036f8>] __slab_alloc.isra.24.constprop.26+0x18/0x20 [<ffffffff811037a0>] kmem_cache_alloc+0xa0/0xd0 [<ffffffff811c2a4e>] radix_tree_node_alloc.isra.1+0x2e/0x70 [<ffffffff811c2b11>] __radix_tree_create+0x81/0x200 [<ffffffff811c2cc3>] radix_tree_insert+0x33/0xc0 [<ffffffff811e0a5c>] add_dma_entry+0x9c/0x150 [<ffffffff811e0c35>] debug_dma_map_page+0x125/0x160 [<ffffffffa050cf77>] nv_alloc_rx_optimized+0xf7/0x380 [forcedeth] [<ffffffffa051544e>] nv_napi_poll+0x8e/0x660 [forcedeth] [<ffffffff8129722e>] net_rx_action+0x16e/0x250 [<ffffffff8103a5ff>] __do_softirq+0xef/0x200 [<ffffffff8103a86c>] irq_exit+0x9c/0xb0 [<ffffffff81004f8e>] do_IRQ+0x5e/0xf0 [<ffffffff8133ab7c>] common_interrupt+0x7c/0x7c <EOI> [<ffffffff8100bc6d>] ? amd_e400_idle+0x4d/0xb0 [<ffffffff81051cba>] ? atomic_notifier_call_chain+0x3a/0x50 [<ffffffff8100c13a>] arch_cpu_idle+0xa/0x10 [<ffffffff8106d8e5>] default_idle_call+0x25/0x30 [<ffffffff8106da50>] cpu_startup_entry+0x160/0x230 [<ffffffff8101f6a3>] start_secondary+0xf3/0x100Mem-Info:active_anon:414027 inactive_anon:185584 isolated_anon:0 active_file:141507 inactive_file:144188 isolated_file:0 unevictable:0 dirty:94191 writeback:5273 unstable:0 slab_reclaimable:36464 slab_unreclaimable:15353 mapped:90991 shmem:187398 pagetables:9793 bounce:0 free:20520 free_pcp:431 free_cma:0DMA free:14760kB min:256kB low:320kB high:384kB active_anon:0kB inactive_anon:16kB active_file:28kB inactive_file:0kB unevictable:0kB isolated(anon):0kB isolated(file):0kB present:15992kB managed:15908kB mlocked:0kB dirty:0kB writeback:0kB mapped:28kB shmem:0kB slab_reclaimable:0kB slab_unreclaimable:148kB kernel_stack:0kB pagetables:0kB unstable:0kB bounce:0kB free_pcp:0kB local_pcp:0kB free_cma:0kB writeback_tmp:0kB pages_scanned:0 all_unreclaimable? nolowmem_reserve[]: 0 3297 3866 3866DMA32 free:58008kB min:55836kB low:69792kB high:83752kB active_anon:1471608kB inactive_anon:573624kB active_file:490640kB inactive_file:499144kB unevictable:0kB isolated(anon):0kB isolated(file):0kB present:3521408kB managed:3449780kB mlocked:0kB dirty:272280kB writeback:18588kB mapped:324644kB shmem:639412kB slab_reclaimable:118836kB slab_unreclaimable:51468kB kernel_stack:5856kB pagetables:33168kB unstable:0kB bounce:0kB free_pcp:788kB local_pcp:580kB free_cma:0kB writeback_tmp:0kB pages_scanned:0 all_unreclaimable? nolowmem_reserve[]: 0 0 569 569Normal free:9312kB min:9440kB low:11800kB high:14160kB active_anon:184500kB inactive_anon:168696kB active_file:75360kB inactive_file:77608kB unevictable:0kB isolated(anon):0kB isolated(file):0kB present:655360kB managed:583256kB mlocked:0kB dirty:104484kB writeback:2504kB mapped:39292kB shmem:110180kB slab_reclaimable:27020kB slab_unreclaimable:9796kB kernel_stack:1232kB pagetables:6004kB unstable:0kB bounce:0kB free_pcp:936kB local_pcp:248kB free_cma:0kB writeback_tmp:0kB pages_scanned:2432 all_unreclaimable? nolowmem_reserve[]: 0 0 0 0DMA: 4*4kB (UM) 3*8kB (M) 4*16kB (UM) 2*32kB (M) 2*64kB (UM) 1*128kB (U) 2*256kB (UM) 1*512kB (M) 1*1024kB (M) 2*2048kB (UM) 2*4096kB (ME) = 14760kBDMA32: 1354*4kB (UME) 1066*8kB (UME) 1090*16kB (UME) 598*32kB (UME) 91*64kB (UME) 13*128kB (UM) 0*256kB 0*512kB 0*1024kB 0*2048kB 0*4096kB = 58008kBNormal: 310*4kB (UE) 74*8kB (UME) 144*16kB (UME) 122*32kB (UME) 18*64kB (UME) 1*128kB (U) 0*256kB 0*512kB 0*1024kB 0*2048kB 0*4096kB = 9320kB475032 total pagecache pages1900 pages in swap cacheSwap cache stats: add 348763, delete 346863, find 129357/152922Free swap = 16683500kBTotal swap = 16777212kB1048190 pages RAM0 pages HighMem/MovableOnly35954 pages reservedSLUB: Unable to allocate memory on node -1 (gfp=0x2000000) cache: radix_tree_node, object size: 576, buffer size: 584, default order: 1, min order: 0 node 0: slabs: 7429, objs: 104006, free: 0DMA-API: cacheline tracking ENOMEM, dma-debug disabledSeems to be "fixed" (workaround?) by enabling TRANSPARENT_HUGEPAGE+COMPACTION.
id=60111	Reported by Radim Krčmář <>:PCIe switch upstream port can be connected directly to the PCIe root busin QEMU; ASPM does not expect this topology and dereferences NULL pointerwhen initializing.I have not confirmed this can happen on real hardware, but it is presentedas a feature in QEMU, so there is no reason to panic if we can recover.The dereference happens with topology defined by -M q35 -device x3130-upstream,bus=pcie.0,id=upstream \ -device xio3130-downstream,bus=upstream,id=downstream,chassis=1where on line drivers/pci/pcie/aspm.c:530 (alloc_pcie_link_state+13): parent = pdev->bus->parent->self->link_state;"pdev->bus->parent->self == NULL", because "pdev->bus->parent" has no"->parent", hence no "->self".Even though discouraged by QEMU documentation, one can set up eventopology without the upstream port -M q35 -device xio3130-downstream,bus=pcie.0,id=downstream,chassis=1so "pdev->bus->parent == NULL", because "pdev->bus" is the root bus.The patch checks for this too, because I do not like *NULL.Right now, PCIe switch has to connect to the root port -M q35 -device ioh3420,bus=pcie.0,id=root.0 \ -device x3130-upstream,bus=root.0,id=upstream \ -device xio3130-downstream,bus=upstream,id=downstream,chassis=1 Createddmesg with aspm bugCreatedlspci -vv with pcie_aspm=offAfter opening this bz, I found this Red Hat report of the same issue:Reproduced with v3.10-rc1 with the following qemu invocation:/usr/local/bin/qemu-system-x86_64 -M q35 -enable-kvm -m 512 \ -device x3130-upstream,bus=pcie.0,id=upstream \ -device xio3130-downstream,bus=upstream,id=downstream,chassis=1 \ -drive file=ubuntu.img,if=none,id=mydisk \ -device ide-drive,drive=mydisk,bus=ide.0 \ -drive file=scratch.img,id=disk1 \ -device virtio-blk-pci,bus=downstream,id=virtio-disk1,drive=disk1 \ -nographic -kernel ~/linux/arch/x86/boot/bzImage \ -append "console=ttyS0,115200n8 root=/dev/sda1 ignore_loglevel"Createdpatch to deal with this topologyThis patch *would* avoid the issue, but it's a fair bit of code andcomments that future code readers would have to wade through, and theonly benefit is for topologies that are completely invalid and willnever be seen in real hardware. Therefore, I'm inclined to do nothingright now.I think that we could also avoid this issue by reworking our ASPMsupport, and if we were to do anything, that's what I would prefer.For example, consider the following (legal and common) topology: 00:1c.0 Root Port (bridge leading to [bus 01-03]) 01:00.0 Upstream Port (bridge leading to [bus 02-03]) 02:00.0 Downstream Port (bridge leading to [bus 03])When we initialize ASPM link state for 02:00.0, we look all the way upto the link state for 00:1c.0 (the"pdev->bus->parent->self->link_state" in alloc_pcie_link_state()). Ithink that's crazy. ASPM is fundamentally a feature of a *link*, andthe only link directly related to 02:00.0 is the one leading*downstream* to device 03:00.0.I know there are latency questions where we do care about upstreamlinks, and there's commit 46bbdfa44c, which is what originally addedthis "pdev->bus->parent->self->link_state" expression. It suggeststhat we need to check the whole hierarchy up to the root port. Butthere's not enough information in the changelog to really explain it.So I strongly support rework that would simplify ASPM managementoverall. I just don't want to add point fixes that only handlespecial cases, especially when they don't occur in the real world.I'm closing this as invalid because the simulated machine where the problem occurs has an invalid PCIe topology (an Upstream Port with no Downstream Port or Root Port above it). As far as I know, there is no valid topology, e.g.,a real hardware machine in the field, that would cause this failure.Reopening because Serge Semin <> reported two systems that hit this issue:Serge, can you please attach complete dmesg logs and "lspci -vv" output for these systems?Createdboot log with issueCreatedlog of successful bootBoot log when issue is fixed by the provided patchCreatedlspci -vvnnt; lspci -vv; logsLog of lspci utility output on the system with fixed issue. As you can see ASPM is enabled everywhere except 1:00.0 Upstream port.CreatedPatch to fix the issueI don't know what the previous patch did to fix the problem, but mine just checks whether the parent bus of having secondary link current device is not root. So we have two cases:1) Traditional PCIe bus topology: |RC ---------------- bus 0 (root bus - root complex) |[RP] | | bus 1 (leading to a first Upstream/Downstream device) | |US0 --------------- bus 2 (device virtual bus) |[DS2]In accordance with the algorithm it creates "struct pcie_link_state" for RP and DS2. So when we get "pdev->bus->parent->self->link_state" for DS2, we retrieve RP's link state structure.2) Root-port-less PCIe bus topology: |RC+RP (Host-PCIe bridges is merged with root port) | | bus 1 (root bus) | |US0 --------------- bus 2 (device virtual bus) |[DS2]First of all algorithm doesn't create link state structure for root port since there is no one. So when algorithm tries to enumerate [DS2] and create link state structure, it calls "pdev->bus->parent->self->link_state". Since "RC+RP" is not ordinary PCI device, but Host-PCI bridge, bus 1 turns out to be root bus without upstream device, so "pdev->bus->parent->self"-pointer of the bus is NULL. That's how NULL dereference happens.So the fix is easy. Just check whether the parent bus isn't root bus.Of course, such method has a drawback. When we apply the attached patch, bus 1 turns out to be considered as root bus. It means, that PCIe link of the bus can't change state, so ASPM service is not enabled for US0 port. As you can see ASPM is disabled for device 1:00.0 of the attached "lspci -vv" log. As a consequence if PCIe bus has nothing, but US0 device directly connected to the merged RC+RP, ASPM will be de-facto disabled.(In reply to Radim Krčmář from)Notes from dmesg () and lspci (): Linux version 3.10.0-0.rc6.git0.2.fc20.x86_64 () (gcc version 4.8.1 20130612 (Red Hat 4.8.1-2) (GCC) ) #1 SMP Mon Jun 17 15:02:16 UTC 2013 PCI host bridge to bus 0000:00 00:03.0 Upstream Port bridge to [bus 01-02] 01:00.0 Downstream Port bridge to [bus 02] 02:00.0 virtio SCSI (non-PCIe) BUG: unable to handle kernel NULL pointer dereference at 0000000000000088 IP: [<ffffffff813218f1>] pcie_aspm_init_link_state+0x701/0x7d0No ASPM possible anywhere. 01:00.0 should be the upstream end of a Link where ASPM could potentially be used, but the downstream device(02:00.0) is not a PCIe device. We should fix ASPM to handle this gracefullyinstead of crashing.(In reply to fancer from)Notes from dmesg () and lspci (): Linux version 3.19.12-cnccu () (gcc version 5.2.0 (crosstool-NG ) ) #0 SMP Wed Sep 7 11:04:07 MSK 2016 PCI host bridge to bus 0000:01 01:00.0 Upstream Port bridge to [bus 02-06] 02:02.0 Downstream Port bridge to [bus 03-05] 02:04.0 Downstream Port bridge to [bus 06] 03:00.0 Upstream Port bridge to [bus 04-05] 03:00.1 Endpoint 04:00.0 Downstream Port bridge to [bus 05] 06:00.0 Legacy Endpoint CPU 0 Unable to handle kernel paging request at virtual address 00000060, epc == 80316d78, ra == 80316d28 ASPM is possible on: - 02:02.0 (link to 03:00.0, 03:00.1; both PCIe devices) - 02:04.0 (link to 06:00.0)ASPM is not possible on 04:00.0 (PCIe downstream port but no device on the other end).Again, we should fix ASPM to handle this gracefully instead of crashing. I don't have a proposal yet.
id=37982	Hi,This devices produce a broken joystick extra device which puzzled me for a while.This device has 2 HID interfaces like a lot of keyboards (One for the regular device, and one for the extra buttons).Looking at the HID report description (following) it seems that the parsing of the second descriptor is at fault producing a full featured event device that support every thing (which is annoying since it produce a spurious broken joystick device). Createdrdesc output of the first entryCreatedrdesc output of the second entryComment onrdesc output of the second entryOups this got altered while I trying to understand how hid workedCreatedrdesc output of the second entryThis is still happening with Kernel 3.7.8 and udev-197 in a Gentoo Linux. If you have access to joystick tools you can calibrate this /dev/input/js0 with jscal -c /dev/input/js0, and at least it won't interfere with the programs, also plug first your gamepad so /dev/input/js0 get's assigned to it first.It's a very annoying bug if you want to use wine or other programs.Any ideas on how to fix it?.Also other keyboard and mouse devices from microsoft suffer the same problem like can be seen on the following links:lsusb -v:Bus 002 Device 005: ID 045e:0750 Microsoft Corp. Wired Keyboard 600Device Descriptor: bLength 18 bDescriptorType 1 bcdUSB 1.10 bDeviceClass 0 (Defined at Interface level) bDeviceSubClass 0 bDeviceProtocol 0 bMaxPacketSize0 8 idVendor 0x045e Microsoft Corp. idProduct 0x0750 Wired Keyboard 600 bcdDevice 1.10 iManufacturer 1 Microsoft iProduct 2 Wired Keyboard 600 iSerial 0 bNumConfigurations 1 Configuration Descriptor: bLength 9 bDescriptorType 2 wTotalLength 59 bNumInterfaces 2 bConfigurationValue 1 iConfiguration 0 bmAttributes 0xa0 (Bus Powered) Remote Wakeup MaxPower 100mA Interface Descriptor: bLength 9 bDescriptorType 4 bInterfaceNumber 0 bAlternateSetting 0 bNumEndpoints 1 bInterfaceClass 3 Human Interface Device bInterfaceSubClass 1 Boot Interface Subclass bInterfaceProtocol 1 Keyboard iInterface 0 HID Device Descriptor: bLength 9 bDescriptorType 33 bcdHID 1.11 bCountryCode 0 Not supported bNumDescriptors 1 bDescriptorType 34 Report wDescriptorLength 65 Report Descriptors: ** UNAVAILABLE ** Endpoint Descriptor: bLength 7 bDescriptorType 5 bEndpointAddress 0x81 EP 1 IN bmAttributes 3 Transfer Type Interrupt Synch Type None Usage Type Data wMaxPacketSize 0x0008 1x 8 bytes bInterval 10 Interface Descriptor: bLength 9 bDescriptorType 4 bInterfaceNumber 1 bAlternateSetting 0 bNumEndpoints 1 bInterfaceClass 3 Human Interface Device bInterfaceSubClass 0 No Subclass bInterfaceProtocol 0 None iInterface 0 HID Device Descriptor: bLength 9 bDescriptorType 33 bcdHID 1.11 bCountryCode 0 Not supported bNumDescriptors 1 bDescriptorType 34 Report wDescriptorLength 106 Report Descriptors: ** UNAVAILABLE ** Endpoint Descriptor: bLength 7 bDescriptorType 5 bEndpointAddress 0x82 EP 2 IN bmAttributes 3 Transfer Type Interrupt Synch Type None Usage Type Data wMaxPacketSize 0x0008 1x 8 bytes bInterval 10Device Status: 0x0000 (Bus Powered)Seems to be a problem in the hid parser, that default some inputs to a joystick if it miss interpret some of the values (for some good or wrong reasons). But last time I check was when I created the bug report.If this is still present in modern kernels please update the bugStill valid as of kernel-3.10Seems to still be valid as of 3.18.2And still in 3.19.2Relevant:Relevant (2009):Can I get output of /proc/bus/input/devices for that mouse please?For my keybord it exposes the following (kernel 3.14.x but I guess it doesn't mater):I: Bus=0003 Vendor=045e Product=0750 Version=0111N: Name="Microsoft Wired Keyboard 600"P: Phys=usb-0000:00:1d.0-1.6/input0S: Sysfs=/devices/pci0000:00/0000:00:1d.0/usb2/2-1/2-1.6/2-1.6:1.0/0003:045E:0750.0003/input/input20U: Uniq=H: Handlers=kbd event17B: PROP=0B: EV=120013B: KEY=1000000000007 ff9f207ac14057ff febeffdfffefffff fffffffffffffffeB: MSC=10B: LED=7I: Bus=0003 Vendor=045e Product=0750 Version=0111N: Name="Microsoft Wired Keyboard 600"P: Phys=usb-0000:00:1d.0-1.6/input1S: Sysfs=/devices/pci0000:00/0000:00:1d.0/usb2/2-1/2-1.6/2-1.6:1.1/0003:045E:0750.0004/input/input21U: Uniq=H: Handlers=kbd event18 js0B: PROP=0B: EV=10001fB: KEY=4c37fff072ff32d bf54445600000000 c00000000000001 30f908b17c007 ffff7bfad951dfff febeffdfffefffff fffffffffffffffeB: REL=40B: ABS=ffffff01000701ffB: MSC=10 From my understanding it was due to a default behaviour of the descriptor parser. It is falling back to a dummy joystik input in case of error, and the keyboard device descriptor has a constructor private interface, for the multimedia keys, that was wrongly parsed leading to the creation of the dummy joystick device.Has there been any progress on this Dmitry?This issue still occurs on 4.6 series.Any advise on where to starting look to fix this issue?I think there was an udev rule that banned the device creation on some distribution for these kind of devices. So it maybe be the wiser temporary solution, without touching the kernel code.Yes, there is udev rules.Since I have one of the keyboards that causes the issue. I thought I might have a go at fixing it but would like some advise on a good place to start.Ahh, ok I thought you meant a quick fix.I looked at the code again, and I don't seems to find the place I was thinking was causing the issue. From my memory, the place I had find was a bug in the hid descriptor parser, that was miss interpreting some vendor private range field, making the device mutate to a joystick. So if I remember well, it was in interaction between drivers/hid/hid-{core,input}.c and drivers/input/input.c.CreatedFirst attempt to patch the issue and uniformise fixes.The attached patch tries to uniformise the patching of microsoft keyboard.I add Microsoft media 600 (that I own) and 7k (that Alistair Leslie-Hughes owns) that were tested with the patch.The only small deviation I made from original code is that Microsoft Wireless Receiver Model 1028 check is now stronger (I was not able to test it or find a copy of the report descriptor to ensure it is correct)CreatedPatch V2, add Microsoft Digital Media 3KV1 workaround.CreatedProposed upstream patchThis is the patch I sent upstream which should solve all Microsoft devices.Reference:I took the time to update my kernel with the patch, and so far everything is good. I successfully tried various multimedia keys (using hid-microsoft since my keybord was not work-arounded). And /dev/input/js0 is gone.So the new patch seems good for me and should be good for almost all Microsoft Digital Media Keyboard series (since they seems to share the same report descriptors).Will see with a bit longer testing but ok for me.
id=115221	Createddmesg output[ 21.434822] BUG: unable to handle kernel NULL pointer dereference at 0000000000000014[ 21.435516] IP: [<ffffffffc0392a4a>] usb_audio_probe+0x2ca/0x9a0 [snd_usb_audio]I have a PreSonus AudioBox iTwo causing this issue.I updated from torvalds git today On Thu, Mar 24, 2016 at 02:34:00AM +0000,wrote:Please send to themailing list.That patch fixed itSorry I believe I jumped the gun no this one. I'll continue on the mailing list.
id=12323	As described in the LKML thread at, calling recv() with MSG_PEEK on an AF_UNIX socket only reads a single skb. Wine uses AF_UNIX sockets for its named pipe implementation and runs into this bug. The patch posted atworks for me, but probably doesn't handle fd passing correctly, as the mail already mentions. If this is still seen on modern kernels then please re-open/updateCreatedTest caseThis still exists on modern kernels (tried 3.5.0-17-generic), it'd be awesome if it could be fixed.Here's a short Python script to demonstrate the problem. It passes on FreeBSD and Mac OS.This bug can be resolved with the following commits: - 4613012db1d911f80897f9446a49de817b2c4c47- 9f389e35674f5b086edd70ed524ca0f287259725- e9193d60d363e4dff75ff6d43a48f22be26d59c7
id=103971	Createddmesg when inserting moduleSwapped out for a new wifi+bt card on my laptop (prior's bluetooth did not work, wifi did) in hopes of getting functional bluetooth on my laptop.bluetooth is completely non-functioning; using bluetoothctl gives the prompt but will not accept new text; rfkill only shows the wifi side of the card; hcitool dev returns no devices.Attached are dmesg when inserting the ath3k module and lsusb verbose mode for the device. Createdlsusb verbose description of deviceCrap... now I feel stupid. Updated to linux-firmware-git from the aur and it didn't work, set it aside for the day and today it works; productId changed from 3002 to 3005, which is really weird I think, but it seems that's how it is supposed to work.And apparently I spoke too soon. Still broke with the upstream git repo's ath3k-1.fw file (md5:1211fa34c09e10ba48381586b7c3883d), but the same file within(md5:24cfee59a24f336dfae838a0de6445a0) functions properly. (To be frank I have not the slightest clue as to where ubuntu got this file)This issue has been in existance for at least a year and a half () and still no resolution. I think its high time that something be done.Createdfunctioning ath3k-1.fw
id=191971	Hello.The beginning of the manpage user_namespaces(7) says that user namespaces isolate credentials, including keys.However, from what I have heard, there is currently no support for isolating keyrings in user namespaces.Please verify this information, as it may have changed. Sorry. I'm closing this. If you can provide some concrete information that the page is incorrect ("from what I've heard" is not enough), please reopen.I remember a discussion about that in systemd-devel mailing list. This seems to be the first post of mine where I asked about container limitations. I have no other resource at the moment.David,Michał Zegan raises in this bug a detail I've never been very clear on. Perhaps you could comment.At the start of the user_namespaces(7) page, there is this text: User namespaces isolate security-related identifiers and attributes, in particular, user IDs and group IDs (see creden‐ tials(7)), the root directory, keys (see keyrings(7)), and capa‐ bilities (see capabilities(7)).The question is: what part of "keys" is virtualized by user namespaces? Looking at kernel/user_namespace.c suggests it is the persistent keyring, so that is we have say UID 1000 in an outer userns mapped to (say) 0 in an inner userns, then those two UIDs would have separate persistent keyrings, whereas the user keyring (and user-session keyring) would be shared across the namespaces. Is this correct?Thanks,MichaelThe following seems relevant:Subject: Re: Keyrings, user namespaces and the user_structFrom: David Howells <dhowells@xxxxxxxxxx>Date: Wed, 26 Oct 2016 12:43:18 +0100Cc: dhowells@xxxxxxxxxx, simo@xxxxxxxxxx, keyrings@xxxxxxxxxxxxxxx, linux-security-module@xxxxxxxxxxxxxxx, containers@xxxxxxxxxxxxxxxxxxxxxxxxxxFor the moment, I'll restore this bug to "open" state. Let's see if David Howells has some input.
id=9503	Software Environment: bugzilla.kernel.orgProblem Description: incomplete online documentation of bugzilla.kernel.org status and resolution fieldsSteps to reproduce:at the time of this writing the above URL show "Resolution: CODE_FIX", yet CODE_FIX is not documented in the accompanying bug's life cycle documentation page:Only FIXED, INVALID etc. are documented there.I suppose FIXED is somehow different from CODE_FIX.I cannot judge whether this is a bug in bugzilla itself or in its customization for Kernel.org. Mozilla's bugzilla life cycle documentation differs from that of kernel.org (e.g. Mozilla has no status CLOSED).It would be great if all values of all fields were documented.The "advanced bug search" page proposes the following search keywords, and I've added annotations about which are mentioned in the bug's life cycle documentation page.Status:NEW documentedREOPENED documentedASSIGNED documentedRESOLVED documentedVERIFIED documentedREJECTED DEFERREDNEEDINFOCLOSED documentedResolution:CODE_FIX ?PATCH_ALREADY_AVAILABLE ?INVALID documentedWILL_NOT_FIX probably documented as WONTFIXWILL_FIX_LATER ?DUPLICATE documentedUNREPRODUCIBLE presumably documented as WORKSFORMEDOCUMENTED ?INSUFFICIENT_DATAMOVED documentedRegards, Jörg Höhle Alan, why did you close this documentation bug as OBSOLETE? Being 6 years old doesn't automatically make a bug obsolete. This particular bug is still current, as the documentation page only describes 5 resolutions out of 11 possible values as of 2014-01-02 - OBSOLETE is not even among those 5. Sorry for nitpicking.Because the bugzilla has been completely revamped since the date it was filed so all the old ones got closed.Also bugzilla problems are now mostly handled via the Linux Foundation ticketing system.Of the undocumented ones they seem to get used asREJECTED generally gets used much as CLOSED/INVALIDDEFERRED I don't think we use these days but its nigh on impossible to remove statuses, packages or anything old from the setupNEEDINFO - waiting information from someoneCODE_FIX - patch curing this problem is submittedPATCH_ALREADY_AVAILABLE - much the same but mostly used to close bugs giving a duplicate fixWILL_FIX_LATER - a bug that is a real bug but cannot be fixed in the shorter term (eg because it needs long term infrastructure changes)DOCUMENTED - whatever has been reporting was/will be documented as expected behaviourUNREPRODUCIBLE - akin to worksforme but also covers stuff that can't be reproduced for other reasons (eg lack of information, obscure hardware)INSUFFICIENT_DATA - there isn't enough information to actually do anything useful with the reportbut the kernel bugzilla is a fairly ad-hoc operation.Might be a small project for someone to write them up nicely and send them on to the bugzilla admin emailActually the other distinction with PATCH_ALREADY_AVAILABLE and CODE_FIX is that the former tends to get used when a report is filed where the code was already fixed in some releases and the latter when the code is fixed as a result of or concurrently with the bug
id=36552	From version 2.6.38 and 2.6.39 I am detected impossibility using radio for ProVideo PV951.The TV tuner work fine and full on versions 2.6.30-2.6.32.In dmesg, on 2.6.38, I see correct detect information:[root@roman bt8xx]# dmesg | grep bttv[ 8.696808] bttv: driver version 0.9.18 loaded[ 8.696812] bttv: using 8 buffers with 2080k (520 pages) each for capture[ 8.696880] bttv: Bt8xx card found (0).[ 8.697273] bttv 0000:01:09.0: PCI INT A -> Link[APC2] -> GSI 17 (level, low) -> IRQ 17[ 8.697283] bttv0: Bt878 (rev 17) at 0000:01:09.0, irq: 17, latency: 32, mmio: 0xfdeff000[ 8.697317] bttv0: using: ProVideo PV951 [card=42,insmod option][ 8.697362] bttv0: gpio: en=00000000, out=00000000 in=00ffffff [init][ 8.697421] bttv0: tuner type=2[ 9.469224] bttv0: registered device video0[ 9.469276] bttv0: registered device vbi0[ 9.469323] bttv0: registered device radio0[ 9.484292] bttv0: PLL: 28636363 => 35468950 .. okBut at send ioctl requests to /dev/radio0 I get errors: "Invalid argument", for VIDIOCGTUNER, VIDIOCGAUDIO. This is not a bug. The legacy V4L1 API were removed. You need to update your radio program to one that uses V4L2 API.(In reply to)Thanks you for direction, you are right.I have rewrited the code for gkrellm-radio module to V4L2 and it work fine up to kernel 2.6.38. But on last 2.6.39 I get other problem.The function VIDIOC_G_TUNER return zero value for "rangelow" and "rangehigh" and radio do not work.My VIDIOC_G_TUNER call code:struct v4l2_tuner vt;vt.index = 0;if(ioctl(radio_fd, VIDIOC_G_TUNER, &vt) < 0) return;fact = (vt.capability & V4L2_TUNER_CAP_LOW) ? 16000 : 16; rangelow = ((float)vt.rangelow)/fact; rangehigh = ((float)vt.rangehigh)/fact;For addition I call "v4l2-ctl -d /dev/radio --all -L" for different kernels:---------- For kernels 2.6.32 - 2.6.38:-----------Driver Info (not using libv4l2): Driver name : bttv Card type : BT878 radio (ProVideo PV951) Bus info : PCI:0000:01:09.0 Driver version: 0.9.18 Capabilities : 0x00010000 TunerVideo input : 0 (Radio: ok)Audio input : 0 (Radio)Frequency: 1622900 (101.431250 MHz)Tuner: Name : Radio Capabilities : 62.5 Hz stereo Frequency range : 65.0 MHz - 108.0 MHz Signal strength/AFC : 25%/0 Current audio mode : stereo Available subchannels: stereo mute (bool) : default=0 value=1----------------------------------------------------------- For kernels 2.6.39.2(3):-----------Driver Info (not using libv4l2): Driver name : bttv Card type : BT878 radio (ProVideo PV951) Bus info : PCI:0000:01:09.0 Driver version: 0.9.18 Capabilities : 0x00010000 TunerVideo input : 0 (Radio: ok)Audio input : 0 (Radio)Frequency: 0 (0.000000 MHz)Tuner: Name : Radio Capabilities : 62.5 kHz Frequency range : 0.0 MHz - 0.0 MHz Signal strength/AFC : 0%/0 Current audio mode : mono Available subchannels: mute (bool) : default=0 value=1------------------------------------------------This is probably an already-fixed regression. The patches for it were at Kernel 3.0. Greg recently emailed the additions of those patches on his tree, so, they'll likely appear at the next 2.6.39 stable Kernel.Could you please double check if everything is ok with 3.0 kernel?Thanks!(In reply to)On kernel version 3.0.0 the bug also present now.(In reply to)And on 3.0.1 the bug present.The problem appear by partial check for option "bttv radio=1". For thatoption /dev/radio0 is created but checking for radio into functioncheck_mode() see only to device's flag ".has_radio", which clear for"ProVideo PV951 (42)" card.Replacing card to "Pace TV & Radio Card (101)" resolve the problem for me.I think for fix that behavior need set flag ".has_radio" or RADIO maskfor flag "bttv radio=1".
id=25642	I'm sure this issue has been raised before, but I don't recognise it from any existing entries in bugzilla. It is a very long-standing problem, but I have at least found a reasonable workaround for it.Basically, I have a Logitech Quickcam Communicate Deluxe, USB ID 046d:0992. This is a UVC camera. The problem is that the first time I try to use this camera after booting the PC, sometimes I get a picture and the rest of the time I get a black video window. My previous workaround was to unplug the camera, unload the uvcvideo module and then replug the camera, hoping that the next time it would work. Sometimes it did, and sometimes it didn't. More recently, I have discovered the joys of the guvcview application which allows me to do the following instead:a) Go to the Image Controls tabb) Change the "Exposure, Auto" option from "Aperture Priority Mode" to "Manual"c) Slide the "Exposure (Absolute)" control as far left as I can. This restores the picture, although the picture isn't ideal.d) Change "Exposure, Auto" back to "Aperture Priority Mode" again, which increases the picture quality. After this, the camera is fine.So presumably the black screen was never blank, it was just completely dark. But the effect looks very much like "broken". Is there some kind of race condition with the camera's initial settings? This bug still exists in 3.12.5. No, the pixies haven't fixed it.ThanksI've just retested this with 3.16.2, and now my workaround with the "Aperture Priority Mode" no longer works. Instead, guvcview just outputs the following message over and over again:Ignoring empty buffer ...Ignoring empty buffer ...Aha - finally an interesting development: I *am* getting a picture when I set my camera for RGB3 and GBR3 output. The "Ignoring empty buffer" message is for MJPG output, YUYV output gives a black video window, wherease both YU12 and YV12 output give a green video window.
id=41032	Differences of the device running attached to a computer running a 64 bit kernel compared to the 32 bit version: - Volume control buttons "+" and "-" are not repeat buttons. - Some commands given from the remote control are recalled up to minutes after they've been issued and are then delivered to the application. This happens even if the device is dis-/reconnected. - With enabled debug output (cf. patch below) in cinergyT2-core.c the driver continuously outputs lines like thesecinergyT2: key: ed 41 be 3 0cinergyT2: key: 72 73 8c 6d 65cinergyT2: key: 64 65 9a 63 6fcinergyT2: key: 75 64 9b 2f 63 at a rate of about 16 per second to the system log.--- linux/drivers/media/dvb/dvb-usb__/cinergyT2-core.c 2010-04-02 00:59:14.000000000 +0200+++ linux/drivers/media/dvb/dvb-usb/cinergyT2-core.c 2010-05-31 19:18:35.000000000 +0200@@ -29,6 +29,9 @@ #include "cinergyT2.h"+#undef deb_rc+#define deb_rc(a...) err(a)+ /* debug */ int dvb_usb_cinergyt2_debug; There were lots of changes at the RC code since 2.6.32 or even 2.6.35. You should test it with the Kernel 3.0 and see if the problems are still there.Also, some IR sensors are very sensible to infrared interferences. Be sure that the sensor is not receiving direct sunlight or direct light from a lamp.(In reply to)Checked it with 3.0.1 and the problems are - slightly modified - still there: - Sometimes after switching channels "+"/"-" behave as repeat buttons for some time and then stop sometimes even while still being pressed. - Late delivery of RC commands still happens but I have not checked the disconnect/reconnect. - The lines are still printed to the system logs.There is no direct light source shining on the sensor.Since the latest 3.0.38 the phantom dataSince the latest 3.0.38 the phantom data problem is gone and the repeat buttons (e.g. volume) now work. In 3.0.35 was affected by all of the three problems, 3.0.37 had at least the repeat issue (did not check other issues).The issue is back again in 3.0.43.Can we close this as the kernel for your testing is obsolete. If you would like to test against a newer kernel and see if this bug is stillvalid.Cheers NickThe bug is still valid. I have compiled the modules with CONFIG_DVB_USB_DEBUG=y. As soon as I enable rc debugging echo 32 > /sys/module/dvb_usb/parameters/debug echo 32 > /sys/module/dvb_usb_cinergyT2/parameters/debugthe syslog fills with kernel: repeated key (non repeatable)and kernel: key: x x xx xx xx [x stands for a hex digit]messages.
id=93581	CreatedHDD info (hdparm -I)I have a brand new Seagate 8TB archive disk: Model=ST8000AS0002-1NA17Z, FwRev=AR13, SerialNo=.....I formatted this with LUKS + ext4 to use as an archive disk under Ubuntu 14.04 with an updated mainline kernel (3.19.0-031900-generic #201502091451). I use this instead of the stock Ubuntu kernel due to buggy Haswell PM support in everything < 3.17.The mainboard is a MSI B85M-P45 with BIOS 10.5 first, but I also upgraded to 10.8 and tried again, no help.hdparm and smartmontools all report no errors with the device. I also tested multiple SATA cables and power cables, which work fine with other SATA devices (one SSD and one WD HDD).When I copy data onto this disk (using rsync or the Ubuntu desktop), after some time (~200MB to ~5GB) the copy process stops and I see this in dmesg:[ 329.994134] ata1.00: exception Emask 0x0 SAct 0x7fffffff SErr 0x0 action 0x6 frozen[ 329.994148] ata1.00: failed command: WRITE FPDMA QUEUED[ 329.994151] ata1.00: cmd 61/40:00:80:ef:db/05:00:01:00:00/40 tag 0 ncq 688128 out[ 329.994151] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 329.994152] ata1.00: status: { DRDY }[ 329.994154] ata1.00: failed command: WRITE FPDMA QUEUED[ 329.994155] ata1.00: cmd 61/40:08:c0:f4:db/05:00:01:00:00/40 tag 1 ncq 688128 out[ 329.994155] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 329.994157] ata1.00: status: { DRDY }[ 329.994157] ata1.00: failed command: WRITE FPDMA QUEUED(repeated)[ 329.994254] ata1.00: cmd 61/40:f0:40:ea:db/05:00:01:00:00/40 tag 30 ncq 688128 out[ 329.994254] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 329.994255] ata1.00: status: { DRDY }[ 329.994257] ata1: hard resetting link[ 335.356764] ata1: link is slow to respond, please be patient (ready=0)[ 340.007083] ata1: COMRESET failed (errno=-16)[ 340.007088] ata1: hard resetting link[ 345.377757] ata1: link is slow to respond, please be patient (ready=0)[ 350.028074] ata1: COMRESET failed (errno=-16)[ 350.028078] ata1: hard resetting link[ 355.394766] ata1: link is slow to respond, please be patient (ready=0)[ 366.312881] sdd: detected capacity change from 31876710400 to 0After I see this, the disk is usually inaccessible and unusable until I hard reset (power cycle) the system. A soft reboot does not help.With "libata.force=noncq" I get this instead:[ 43.622595] EXT4-fs (dm-4): mounted filesystem with ordered data mode. Opts: (null)[ 89.804533] ata1.00: exception Emask 0x0 SAct 0x0 SErr 0x0 action 0x6 frozen[ 89.804548] ata1.00: failed command: WRITE DMA EXT[ 89.804551] ata1.00: cmd 35/00:80:00:d0:e4/00:4a:01:00:00/e0 tag 14 dma 9764864 out[ 89.804551] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 89.804552] ata1.00: status: { DRDY }[ 89.804554] ata1: hard resetting link[ 90.236318] ata1: SATA link up 6.0 Gbps (SStatus 133 SControl 300)[ 90.883929] ata1.00: configured for UDMA/133[ 90.884028] ata1.00: device reported invalid CHS sector 0[ 90.884031] ata1: EH complete[ 173.794464] ata1.00: exception Emask 0x0 SAct 0x0 SErr 0x0 action 0x6 frozen[ 173.794479] ata1.00: failed command: WRITE DMA EXT[ 173.794481] ata1.00: cmd 35/00:80:80:84:2f/00:4a:02:00:00/e0 tag 3 dma 9764864 out[ 173.794481] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 173.794482] ata1.00: status: { DRDY }[ 173.794485] ata1: hard resetting link[ 174.226249] ata1: SATA link up 6.0 Gbps (SStatus 133 SControl 300)[ 174.737999] ata1.00: configured for UDMA/133[ 174.738171] ata1.00: device reported invalid CHS sector 0[ 174.738175] ata1: EH complete[ 208.784935] ata1.00: exception Emask 0x0 SAct 0x0 SErr 0x0 action 0x6 frozen[ 208.784950] ata1.00: failed command: WRITE DMA EXT[ 208.784952] ata1.00: cmd 35/00:c0:40:d5:3b/00:3a:02:00:00/e0 tag 13 dma 7700480 out[ 208.784952] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 208.784954] ata1.00: status: { DRDY }[ 208.784956] ata1: hard resetting link[ 214.142219] ata1: link is slow to respond, please be patient (ready=0)[ 218.787931] ata1: COMRESET failed (errno=-16)[ 218.787946] ata1: hard resetting link[ 224.145236] ata1: link is slow to respond, please be patient (ready=0)[ 228.790896] ata1: COMRESET failed (errno=-16)[ 228.790912] ata1: hard resetting link[ 234.148199] ata1: link is slow to respond, please be patient (ready=0)[ 263.825359] ata1: COMRESET failed (errno=-16)[ 263.825364] ata1: limiting SATA link speed to 3.0 Gbps[ 263.825365] ata1: hard resetting link[ 268.846805] ata1: COMRESET failed (errno=-16)[ 268.846810] ata1: reset failed, giving up[ 268.846812] ata1.00: disabled[ 268.846816] ata1.00: device reported invalid CHS sector 0[ 268.846822] ata1: EH complete[ 268.846866] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 268.846867] sd 0:0:0:0: [sda] CDB: [ 268.846868] Write(16): 8a 00 00 00 00 00 02 3b d5 40 00 00 3a c0 00 00[ 268.846873] blk_update_request: I/O error, dev sda, sector 37475648[ 268.846909] EXT4-fs warning (device dm-3): ext4_end_bio:317: I/O error -5 writing to inode 201195635 (offset 109051904 size 4194304 starting block 4683944)[ 268.846910] Buffer I/O error on device dm-3, logical block 4683944[ 268.846913] Buffer I/O error on device dm-3, logical block 4683945[ 268.846914] Buffer I/O error on device dm-3, logical block 4683946[ 268.846914] Buffer I/O error on device dm-3, logical block 4683947[ 268.846915] Buffer I/O error on device dm-3, logical block 4683948[ 268.846916] Buffer I/O error on device dm-3, logical block 4683949[ 268.846917] Buffer I/O error on device dm-3, logical block 4683950[ 268.846918] Buffer I/O error on device dm-3, logical block 4683951[ 268.846919] Buffer I/O error on device dm-3, logical block 4683952[ 268.846920] Buffer I/O error on device dm-3, logical block 4683953[ 268.846969] EXT4-fs warning (device dm-3): ext4_end_bio:317: I/O error -5 writing to inode 201195635 (offset 109051904 size 4194304 starting block 4684112)[ 268.847011] EXT4-fs warning (device dm-3): ext4_end_bio:317: I/O error -5 writing to inode 201195635 (offset 109051904 size 4194304 starting block 4684280)[ 268.847056] EXT4-fs warning (device dm-3): ext4_end_bio:317: I/O error -5 writing to inode 201195635 (offset 109051904 size 4194304 starting block 4684448)[ 268.847096] EXT4-fs warning (device dm-3): ext4_end_bio:317: I/O error -5 writing to inode 201195635 (offset 109051904 size 4194304 starting block 4684616)[ 268.847125] EXT4-fs warning (device dm-3): ext4_end_bio:317: I/O error -5 writing to inode 201195635 (offset 109051904 size 4194304 starting block 4684784)[ 268.847142] EXT4-fs warning (device dm-3): ext4_end_bio:317: I/O error -5 writing to inode 201195635 (offset 113246208 size 4194304 starting block 4684800)[ 268.847188] EXT4-fs warning (device dm-3): ext4_end_bio:317: I/O error -5 writing to inode 201195635 (offset 113246208 size 4194304 starting block 4684968)[ 268.847230] EXT4-fs warning (device dm-3): ext4_end_bio:317: I/O error -5 writing to inode 201195635 (offset 113246208 size 4194304 starting block 4685136)[ 268.847272] EXT4-fs warning (device dm-3): ext4_end_bio:317: I/O error -5 writing to inode 201195635 (offset 113246208 size 4194304 starting block 4685304)[ 268.847431] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 268.847432] sd 0:0:0:0: [sda] CDB: [ 268.847433] Write(16): 8a 00 00 00 00 00 02 3c 10 00 00 00 45 40 00 00[ 268.847437] blk_update_request: I/O error, dev sda, sector 37490688[ 268.848085] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 268.848086] sd 0:0:0:0: [sda] CDB: [ 268.848087] Write(16): 8a 00 00 00 00 00 02 3c 55 40 00 00 45 40 00 00[ 268.848103] blk_update_request: I/O error, dev sda, sector 37508416[ 268.849382] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 268.849384] sd 0:0:0:0: [sda] CDB: [ 268.849385] Write(16): 8a 00 00 00 00 00 02 3c 9a 80 00 00 45 40 00 00[ 268.849390] blk_update_request: I/O error, dev sda, sector 37526144[ 268.849909] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 268.849910] sd 0:0:0:0: [sda] CDB: [ 268.849911] Write(16): 8a 00 00 00 00 00 02 3c df c0 00 00 04 40 00 00[ 268.849915] blk_update_request: I/O error, dev sda, sector 37543872[ 268.849951] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 268.849952] sd 0:0:0:0: [sda] CDB: [ 268.849952] Write(16): 8a 00 00 00 00 00 02 3c e4 00 00 00 05 40 00 00[ 268.849956] blk_update_request: I/O error, dev sda, sector 37544960[ 268.850011] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 268.850012] sd 0:0:0:0: [sda] CDB: [ 268.850012] Read(16): 88 00 00 00 00 02 ff 84 10 28 00 00 00 08 00 00[ 268.850016] blk_update_request: I/O error, dev sda, sector 12876779560[ 268.850023] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 268.850024] sd 0:0:0:0: [sda] CDB: [ 268.850024] Write(16): 8a 00 00 00 00 00 16 00 31 00 00 00 08 00 00 00[ 268.850028] blk_update_request: I/O error, dev sda, sector 369111296[ 268.850068] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 268.850070] sd 0:0:0:0: [sda] CDB: [ 268.850071] Write(16): 8a[ 268.850073] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 268.850074] sd 0:0:0:0: [sda] CDB: [ 268.850074] Write(16):[ 268.850075] 00 00 00 00 02 ff 80 10 08 00 00 00 08 00 00[ 268.850092] blk_update_request: I/O error, dev sda, sector 12876517384[ 268.850093] 8a 00 00 00 00 02 ff 80[ 268.850095] Buffer I/O error on dev dm-3, logical block 1609564161, lost async page write[ 268.850096] 10 80 00 00 00 08 00 00[ 268.850098] blk_update_request: I/O error, dev sda, sector 12876517504[ 268.850100] Buffer I/O error on dev dm-3, logical block 1609564176, lost async page write[ 268.850101] Buffer I/O error on dev dm-3, logical block 1609564192, lost async page write[ 268.850105] Buffer I/O error on dev dm-3, logical block 1609568289, lost async page write[ 268.850107] Buffer I/O error on dev dm-3, logical block 1609596954, lost async page write[ 268.850214] EXT4-fs error (device dm-3): ext4_find_entry:1289: inode #201195523: comm pool: reading directory lblock 0[ 268.850907] Buffer I/O error on dev dm-3, logical block 11, lost async page write[ 268.850911] Buffer I/O error on dev dm-3, logical block 384, lost async page write[ 268.850914] Buffer I/O error on dev dm-3, logical block 4194313, lost async page write[ 268.850916] Buffer I/O error on dev dm-3, logical block 4194314, lost async page write[ 268.850918] Buffer I/O error on dev dm-3, logical block 4194315, lost async page write[ 268.851198] Aborting journal on device dm-3-8.[ 268.851214] EXT4-fs (dm-3): Delayed block allocation failed for inode 201195635 at logical offset 44672 with max blocks 2048 with error 30[ 268.851215] EXT4-fs (dm-3): This should not happen!! Data will be lost[ 268.851215] [ 268.851217] EXT4-fs error (device dm-3) in ext4_writepages:2395: Journal has aborted[ 268.851218] EXT4-fs (dm-3): previous I/O error to superblock detected[ 268.851238] JBD2: Error -5 detected when updating journal superblock for dm-3-8.[ 268.851491] EXT4-fs (dm-3): previous I/O error to superblock detected[ 268.851543] EXT4-fs error (device dm-3): ext4_journal_check_start:56: Detected aborted journal[ 268.851545] EXT4-fs (dm-3): Remounting filesystem read-only[ 268.851557] EXT4-fs (dm-3): previous I/O error to superblock detected[ 268.851598] EXT4-fs error (device dm-3) in ext4_da_write_end:2652: IO failure[ 268.851610] EXT4-fs (dm-3): previous I/O error to superblock detected[ 298.891785] scsi_io_completion: 31 callbacks suppressed[ 298.891799] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 298.891800] sd 0:0:0:0: [sda] CDB: [ 298.891801] Write(16): 8a 00 00 00 00 00 00 00 10 60 00 00 00 08 00 00[ 298.891805] blk_update_request: 31 callbacks suppressed[ 298.891806] blk_update_request: I/O error, dev sda, sector 4192[ 298.891809] buffer_io_error: 7 callbacks suppressed[ 298.891810] Buffer I/O error on dev dm-3, logical block 12, lost async page write[ 359.379609] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 359.379621] sd 0:0:0:0: [sda] CDB: [ 359.379622] Read(16): 88 00 00 00 00 02 ff 80 91 08 00 00 00 08 00 00[ 359.379627] blk_update_request: I/O error, dev sda, sector 12876550408[ 359.379651] EXT4-fs error (device dm-3): ext4_find_entry:1289: inode #201195523: comm rsync: reading directory lblock 0[ 359.379653] EXT4-fs (dm-3): previous I/O error to superblock detectedSometimes I also see this:[ 202.092355] ata1: link is slow to respond, please be patient (ready=0)[ 206.740359] ata1: COMRESET failed (errno=-16)[ 206.740363] ata1: hard resetting link[ 212.100352] ata1: link is slow to respond, please be patient (ready=0)[ 216.748316] ata1: COMRESET failed (errno=-16)[ 216.748321] ata1: hard resetting link[ 222.108331] ata1: link is slow to respond, please be patient (ready=0)[ 251.800305] ata1: COMRESET failed (errno=-16)[ 251.800310] ata1: limiting SATA link speed to 3.0 Gbps[ 251.800311] ata1: hard resetting link[ 256.824303] ata1: COMRESET failed (errno=-16)[ 256.824308] ata1: reset failed, giving up[ 256.824309] ata1.00: disabled[ 256.824311] ata1.00: device reported invalid CHS sector 0[ 256.824312] ata1.00: device reported invalid CHS sector 0[ 256.824314] ata1.00: device reported invalid CHS sector 0[ 256.824315] ata1.00: device reported invalid CHS sector 0[ 256.824315] ata1.00: device reported invalid CHS sector 0[ 256.824316] ata1.00: device reported invalid CHS sector 0[ 256.824317] ata1.00: device reported invalid CHS sector 0[ 256.824318] ata1.00: device reported invalid CHS sector 0[ 256.824319] ata1.00: device reported invalid CHS sector 0[ 256.824320] ata1.00: device reported invalid CHS sector 0[ 256.824322] ata1.00: device reported invalid CHS sector 0[ 256.824324] ata1.00: device reported invalid CHS sector 0[ 256.824325] ata1.00: device reported invalid CHS sector 0[ 256.824327] ata1.00: device reported invalid CHS sector 0[ 256.824328] ata1.00: device reported invalid CHS sector 0[ 256.824330] ata1.00: device reported invalid CHS sector 0[ 256.824331] ata1.00: device reported invalid CHS sector 0[ 256.824332] ata1.00: device reported invalid CHS sector 0[ 256.824333] ata1.00: device reported invalid CHS sector 0[ 256.824335] ata1.00: device reported invalid CHS sector 0[ 256.824337] ata1.00: device reported invalid CHS sector 0[ 256.824338] ata1.00: device reported invalid CHS sector 0[ 256.824340] ata1.00: device reported invalid CHS sector 0[ 256.824341] ata1.00: device reported invalid CHS sector 0[ 256.824342] ata1.00: device reported invalid CHS sector 0[ 256.824343] ata1.00: device reported invalid CHS sector 0[ 256.824344] ata1.00: device reported invalid CHS sector 0[ 256.824345] ata1.00: device reported invalid CHS sector 0[ 256.824346] ata1.00: device reported invalid CHS sector 0[ 256.824347] ata1.00: device reported invalid CHS sector 0[ 256.824348] ata1.00: device reported invalid CHS sector 0[ 256.824357] ata1: EH complete[ 256.824374] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 256.824376] sd 0:0:0:0: [sda] CDB: [ 256.824376] Write(16): 8a 00 00 00 00 00 02 a2 1a 80 00 00 05 40 00 00[ 256.824381] blk_update_request: I/O error, dev sda, sector 44178048[ 256.824403] EXT4-fs warning (device dm-4): ext4_end_bio:317: I/O error -5 writing to inode 201195637 (offset 134217728 size 8388608 starting block 5521744)[ 256.824405] Buffer I/O error on device dm-4, logical block 5521744[ 256.824407] Buffer I/O error on device dm-4, logical block 5521745[ 256.824408] Buffer I/O error on device dm-4, logical block 5521746[ 256.824409] Buffer I/O error on device dm-4, logical block 5521747[ 256.824410] Buffer I/O error on device dm-4, logical block 5521748[ 256.824410] Buffer I/O error on device dm-4, logical block 5521749[ 256.824411] Buffer I/O error on device dm-4, logical block 5521750[ 256.824412] Buffer I/O error on device dm-4, logical block 5521751[ 256.824413] Buffer I/O error on device dm-4, logical block 5521752[ 256.824414] Buffer I/O error on device dm-4, logical block 5521753[ 256.824453] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 256.824453] sd 0:0:0:0: [sda] CDB: [ 256.824454] Write(16): 8a 00 00 00 00 00 02 a2 15 40 00 00 05 40 00 00[ 256.824458] blk_update_request: I/O error, dev sda, sector 44176704[ 256.824473] EXT4-fs warning (device dm-4): ext4_end_bio:317: I/O error -5 writing to inode 201195637 (offset 134217728 size 8388608 starting block 5521576)[ 256.824528] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 256.824529] sd 0:0:0:0: [sda] CDB: [ 256.824529] Write(16): 8a 00 00 00 00 00 02 a2 10 00 00 00 05 40 00 00[ 256.824533] blk_update_request: I/O error, dev sda, sector 44175360[ 256.824550] EXT4-fs warning (device dm-4): ext4_end_bio:317: I/O error -5 writing to inode 201195637 (offset 134217728 size 8388608 starting block 5521408)[ 256.824604] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 256.824605] sd 0:0:0:0: [sda] CDB: [ 256.824605] Write(16): 8a 00 00 00 00 00 02 a2 0f 00 00 00 01 00 00 00[ 256.824609] blk_update_request: I/O error, dev sda, sector 44175104[ 256.824613] EXT4-fs warning (device dm-4): ext4_end_bio:317: I/O error -5 writing to inode 201195637 (offset 125829120 size 8388608 starting block 5521376)[ 256.824641] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 256.824642] sd 0:0:0:0: [sda] CDB: [ 256.824642] Write(16): 8a 00 00 00 00 00 02 a2 09 c0 00 00 05 40 00 00[ 256.824646] blk_update_request: I/O error, dev sda, sector 44173760[ 256.824660] EXT4-fs warning (device dm-4): ext4_end_bio:317: I/O error -5 writing to inode 201195637 (offset 125829120 size 8388608 starting block 5521208)[ 256.824709] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 256.824710] sd 0:0:0:0: [sda] CDB: [ 256.824710] Write(16): 8a 00 00 00 00 00 02 a2 04 80 00 00 05 40 00 00[ 256.824714] blk_update_request: I/O error, dev sda, sector 44172416[ 256.824729] EXT4-fs warning (device dm-4): ext4_end_bio:317: I/O error -5 writing to inode 201195637 (offset 125829120 size 8388608 starting block 5521040)[ 256.824780] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 256.824781] sd 0:0:0:0: [sda] CDB: [ 256.824782] Write(16): 8a 00 00 00 00 00 02 a1 ff 40 00 00 05 40 00 00[ 256.824785] blk_update_request: I/O error, dev sda, sector 44171072[ 256.824800] EXT4-fs warning (device dm-4): ext4_end_bio:317: I/O error -5 writing to inode 201195637 (offset 125829120 size 8388608 starting block 5520872)[ 256.824851] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 256.824851] sd 0:0:0:0: [sda] CDB: [ 256.824852] Write(16): 8a 00 00 00 00 00 02 a1 fa 00 00 00 05 40 00 00[ 256.824856] blk_update_request: I/O error, dev sda, sector 44169728[ 256.824872] EXT4-fs warning (device dm-4): ext4_end_bio:317: I/O error -5 writing to inode 201195637 (offset 125829120 size 8388608 starting block 5520704)[ 256.824923] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 256.824924] sd 0:0:0:0: [sda] CDB: [ 256.824924] Write(16): 8a 00 00 00 00 00 02 a1 f4 c0 00 00 05 40 00 00[ 256.824928] blk_update_request: I/O error, dev sda, sector 44168384[ 256.824943] EXT4-fs warning (device dm-4): ext4_end_bio:317: I/O error -5 writing to inode 201195637 (offset 125829120 size 8388608 starting block 5520536)[ 256.824994] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 256.824995] sd 0:0:0:0: [sda] CDB: [ 256.824996] Write(16): 8a 00 00 00 00 00 02 a1 ef 80 00 00 05 40 00 00[ 256.825000] blk_update_request: I/O error, dev sda, sector 44167040[ 256.825018] EXT4-fs warning (device dm-4): ext4_end_bio:317: I/O error -5 writing to inode 201195637 (offset 125829120 size 8388608 starting block 5520368)[ 256.828553] EXT4-fs error (device dm-4) in ext4_ext_truncate:4669: IO failure[ 256.833847] Buffer I/O error on dev dm-4, logical block 0, lost sync page write[ 256.839020] Aborting journal on device dm-4-8.[ 256.839052] Buffer I/O error on dev dm-4, logical block 976781312, lost sync page write[ 256.839070] JBD2: Error -5 detected when updating journal superblock for dm-4-8.[ 272.135941] EXT4-fs (dm-4): previous I/O error to superblock detected[ 272.135976] scsi_io_completion: 84 callbacks suppressed[ 272.135979] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 272.135980] sd 0:0:0:0: [sda] CDB: [ 272.135981] Write(16): 8a 00 00 00 00 00 00 00 10 00 00 00 00 08 00 00[ 272.135986] blk_update_request: 84 callbacks suppressed[ 272.135987] blk_update_request: I/O error, dev sda, sector 4096[ 272.135990] Buffer I/O error on dev dm-4, logical block 0, lost sync page write[ 272.135995] EXT4-fs error (device dm-4): ext4_journal_check_start:56: Detected aborted journal[ 272.135996] EXT4-fs (dm-4): Remounting filesystem read-only[ 272.135997] EXT4-fs (dm-4): previous I/O error to superblock detected[ 272.136005] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 272.136006] sd 0:0:0:0: [sda] CDB: [ 272.136006] Write(16): 8a 00 00 00 00 00 00 00 10 00 00 00 00 08 00 00[ 272.136011] blk_update_request: I/O error, dev sda, sector 4096[ 272.136012] Buffer I/O error on dev dm-4, logical block 0, lost sync page writeAfter this happens, the disk is remounted read-only. Unmounting works (usually), but when I remount I get this:[ 375.476195] EXT4-fs (dm-4): previous I/O error to superblock detected[ 375.476273] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 375.476274] sd 0:0:0:0: [sda] CDB: [ 375.476275] Write(16): 8a 00 00 00 00 00 00 00 10 00 00 00 00 08 00 00[ 375.476280] blk_update_request: I/O error, dev sda, sector 4096[ 375.476285] Buffer I/O error on dev dm-4, logical block 0, lost sync page write[ 375.476290] EXT4-fs error (device dm-4): ext4_put_super:780: Couldn't clean up the journal[ 375.479299] ------------[ cut here ]------------[ 375.479305] WARNING: CPU: 2 PID: 3233 at /home/kernel/COD/linux/fs/block_dev.c:67 bdev_inode_switch_bdi+0x86/0x90()[ 375.479306] Modules linked in: snd_hda_codec_hdmi(E) intel_rapl(E) iosf_mbi(E) x86_pkg_temp_thermal(E) intel_powerclamp(E) coretemp(E) kvm_intel(E) snd_hda_codec_realtek(E) kvm(E) snd_hda_codec_generic(E) snd_seq_midi(E) snd_seq_midi_event(E) snd_rawmidi(E) snd_hda_intel(E) snd_hda_controller(E) snd_hda_codec(E) snd_hwdep(E) serio_raw(E) snd_pcm(E) snd_seq(E) shpchp(E) mei_me(E) mei(E) lpc_ich(E) snd_seq_device(E) snd_timer(E) snd(E) soundcore(E) tpm_infineon(E) 8250_fintek(E) intel_smartconnect(E) mac_hid(E) rfcomm(E) bnep(E) bluetooth(E) parport_pc(E) ppdev(E) nls_iso8859_1(E) lp(E) parport(E) uas(E) usb_storage(E) dm_crypt(E) hid_generic(E) usbhid(E) hid(E) mxm_wmi(E) crct10dif_pclmul(E) crc32_pclmul(E) ghash_clmulni_intel(E) aesni_intel(E) aes_x86_64(E) lrw(E) gf128mul(E) glue_helper(E) ablk_helper(E) cryptd(E) i915(E) i2c_algo_bit(E) ahci(E) libahci(E) drm_kms_helper(E) r8169(E) mii(E) drm(E) wmi(E) video(E)[ 375.479332] CPU: 2 PID: 3233 Comm: umount Tainted: G E 3.19.0-031900-generic #201502091451[ 375.479333] Hardware name: MSI MS-7817/CSM-B85M-E45 (MS-7817), BIOS V10.8 12/11/2014[ 375.479334] 0000000000000043 ffff88014d177d68 ffffffff817c4c00 0000000000000007[ 375.479335] 0000000000000000 ffff88014d177da8 ffffffff81076e87 0000000000000000[ 375.479337] ffff8802146031b0 ffff880214603238 ffffffff81c66d00 ffff8801d236ac00[ 375.479338] Call Trace:[ 375.479342] [<ffffffff817c4c00>] dump_stack+0x45/0x57[ 375.479345] [<ffffffff81076e87>] warn_slowpath_common+0x97/0xe0[ 375.479346] [<ffffffff81076eea>] warn_slowpath_null+0x1a/0x20[ 375.479348] [<ffffffff8122bd26>] bdev_inode_switch_bdi+0x86/0x90[ 375.479349] [<ffffffff8122cf81>] __blkdev_put+0x81/0x1b0[ 375.479350] [<ffffffff8122d10b>] blkdev_put+0x5b/0x160[ 375.479353] [<ffffffff811f706d>] kill_block_super+0x4d/0x80[ 375.479354] [<ffffffff811f72a9>] deactivate_locked_super+0x59/0x80[ 375.479356] [<ffffffff811f7f6e>] deactivate_super+0x4e/0x70[ 375.479358] [<ffffffff81213a93>] cleanup_mnt+0x43/0x90[ 375.479360] [<ffffffff81213b32>] __cleanup_mnt+0x12/0x20[ 375.479362] [<ffffffff81093e8f>] task_work_run+0xaf/0xf0[ 375.479364] [<ffffffff81015077>] do_notify_resume+0xc7/0xd0[ 375.479367] [<ffffffff817d21cf>] int_signal+0x12/0x17[ 375.479368] ---[ end trace a6291ba43b98e010 ]---[ 375.485916] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 375.485919] sd 0:0:0:0: [sda] CDB: [ 375.485920] Read(16): 88 00 00 00 00 00 00 00 00 00 00 00 00 02 00 00[ 375.485935] blk_update_request: I/O error, dev sda, sector 0[ 377.355569] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 377.355582] sd 0:0:0:0: [sda] CDB: [ 377.355583] Read(16): 88 00 00 00 00 00 00 00 00 00 00 00 00 02 00 00[ 377.355588] blk_update_request: I/O error, dev sda, sector 0[ 380.211836] sd 0:0:0:0: [sda] FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 380.211839] sd 0:0:0:0: [sda] CDB: [ 380.211840] Read(16): 88 00 00 00 00 00 00 00 00 00 00 00 00 02 00 00[ 380.211845] blk_update_request: I/O error, dev sda, sector 0[ 380.219851] show_signal_msg: 168 callbacks suppressed[ 380.219855] gvfs-udisks2-vo[2354]: segfault at 8 ip 000000000040fb14 sp 00007fffed821a70 error 4 in gvfs-udisks2-volume-monitor[400000+24000]After this the disk is totally inaccessible.How can I fix this? Any help welcome.Thank you! I now compiled linux-drm-nightly as of today (git 89271faca1 from cgit.freedesktop.org) and the situation has improved a little: when writing to the disk, I get the below output about once a minute, and a pause and (probably) a bus reset, but no more crashes and unusable disks until reboot.[ 597.912997] ata1.00: device reported invalid CHS sector 0[ 597.912999] ata1.00: device reported invalid CHS sector 0[ 597.913001] ata1.00: device reported invalid CHS sector 0[ 597.913009] ata1: EH complete[ 735.622011] ata1.00: NCQ disabled due to excessive errors[ 735.622014] ata1.00: exception Emask 0x0 SAct 0x7fffffff SErr 0x0 action 0x6 frozen[ 735.622017] ata1.00: failed command: WRITE FPDMA QUEUED[ 735.622019] ata1.00: cmd 61/c0:00:c0:1f:78/0f:00:05:00:00/40 tag 0 ncq 2064384 out[ 735.622019] res 40/00:01:00:00:00/00:00:00:00:00/40 Emask 0x4 (timeout)[ 735.622021] ata1.00: status: { DRDY }[ 735.622022] ata1.00: failed command: WRITE FPDMA QUEUED[ 735.622023] ata1.00: cmd 61/00:08:80:2f:78/2b:00:05:00:00/40 tag 1 ncq 5636096 out[ 735.622023] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)...[ 735.622118] ata1.00: status: { DRDY }[ 735.622119] ata1.00: failed command: WRITE FPDMA QUEUED[ 735.622121] ata1.00: cmd 61/40:f0:80:1a:78/05:00:05:00:00/40 tag 30 ncq 688128 out[ 735.622121] res 40/00:01:00:00:00/00:00:00:00:00/40 Emask 0x4 (timeout)[ 735.622122] ata1.00: status: { DRDY }[ 735.622123] ata1: hard resetting link[ 736.166005] ata1: SATA link up 6.0 Gbps (SStatus 133 SControl 300)[ 736.168745] ata1.00: configured for UDMA/133[ 736.168855] ata1.00: device reported invalid CHS sector 0[ 736.168857] ata1.00: device reported invalid CHS sector 0...I also tried to use "libata.force=1:1.5G" to artificially slow down the wire speed and this seems to make those errors appear less often, while also slowing down the disk noticeably.Anything else I should or can try?Closing. It was a bad disk after all - Linux was right in spitting countless errors at me :-(I have to reopen this bug. Even with 4.0.0-rc7 (freedesktop git checkout as of yesterday), after changing cabling, replacing the disk itself, changing the harddisk position inside the PC case and retrying all of the above again, I still get these timeout errors with all consequences (filesystem being corrupt, remounted read-only, etc) when copying large amounts of data.The new disk is - according to SMART - perfectly OK and works as long as I do not copy large amounts of data (roughly for up to 30 minutes). In the syslog output, I can detect no references to hardware errors - only timeouts. This might be due to the "shingled tracks" of this disk, which require rewriting adjacent tracks after write processes, which might cause the timeouts on the OS side (but that's just a guess).Anything else I can try? Is there a way to increase the DMA timeout values so the OS waits longer? Here is my hardware again:00:1f.2 SATA controller: Intel Corporation 8 Series/C220 Series Chipset Family 6-port SATA Controller 1 [AHCI mode] (rev 05) (prog-if 01 [AHCI 1.0]) Subsystem: Micro-Star International Co., Ltd. [MSI] Device 7817 Flags: bus master, 66MHz, medium devsel, latency 0, IRQ 27 I/O ports at f0b0 [size=8] I/O ports at f0a0 [size=4] I/O ports at f090 [size=8] I/O ports at f080 [size=4] I/O ports at f060 [size=32] Memory at f7d1a000 (32-bit, non-prefetchable) [size=2K] Capabilities: [80] MSI: Enable+ Count=1/1 Maskable- 64bit- Capabilities: [70] Power Management version 3 Capabilities: [a8] SATA HBA v1.0 Kernel driver in use: ahci[ 0.936755] ata2: SATA link up 6.0 Gbps (SStatus 133 SControl 300)[ 0.938199] ata2.00: ATA-9: ST8000AS0002-1NA17Z, AR13, max UDMA/133[ 0.938201] ata2.00: 15628053168 sectors, multi 16: LBA48 NCQ (depth 31/32), AAHere is the syslog output:[ 1481.390943] ata2.00: exception Emask 0x0 SAct 0x3fffffff SErr 0x0 action 0x6 frozen[ 1481.390957] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.390960] ata2.00: cmd 61/c0:00:c0:89:1d/25:00:55:00:00/40 tag 0 ncq 4947968 out[ 1481.390960] res 40/00:01:00:4f:c2/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.390961] ata2.00: status: { DRDY }[ 1481.390962] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.390964] ata2.00: cmd 61/00:08:80:af:1d/15:00:55:00:00/40 tag 1 ncq 2752512 out[ 1481.390964] res 40/00:01:00:4f:c2/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.390965] ata2.00: status: { DRDY }[ 1481.390966] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.390968] ata2.00: cmd 61/40:10:80:c4:1d/05:00:55:00:00/40 tag 2 ncq 688128 out[ 1481.390968] res 40/00:00:00:4f:c2/00:00:00:00:00/40 Emask 0x4 (timeout)[ 1481.390969] ata2.00: status: { DRDY }[ 1481.390969] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.390971] ata2.00: cmd 61/80:18:c0:c9:1d/20:00:55:00:00/40 tag 3 ncq 4259840 out[ 1481.390971] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.390972] ata2.00: status: { DRDY }[ 1481.390973] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.390975] ata2.00: cmd 61/00:20:40:ea:1d/15:00:55:00:00/40 tag 4 ncq 2752512 out[ 1481.390975] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.390975] ata2.00: status: { DRDY }[ 1481.390976] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.390978] ata2.00: cmd 61/c0:28:40:ff:1d/10:00:55:00:00/40 tag 5 ncq 2195456 out[ 1481.390978] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.390979] ata2.00: status: { DRDY }[ 1481.390980] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.390981] ata2.00: cmd 61/c0:30:00:10:1e/0f:00:55:00:00/40 tag 6 ncq 2064384 out[ 1481.390981] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.390982] ata2.00: status: { DRDY }[ 1481.390983] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.390985] ata2.00: cmd 61/80:38:c0:1f:1e/1f:00:55:00:00/40 tag 7 ncq 4128768 out[ 1481.390985] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.390986] ata2.00: status: { DRDY }[ 1481.390986] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.390988] ata2.00: cmd 61/c0:40:40:3f:1e/10:00:55:00:00/40 tag 8 ncq 2195456 out[ 1481.390988] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.390989] ata2.00: status: { DRDY }[ 1481.390990] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.390991] ata2.00: cmd 61/40:48:00:50:1e/05:00:55:00:00/40 tag 9 ncq 688128 out[ 1481.390991] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.390992] ata2.00: status: { DRDY }[ 1481.390993] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.390995] ata2.00: cmd 61/40:50:40:55:1e/05:00:55:00:00/40 tag 10 ncq 688128 out[ 1481.390995] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.390996] ata2.00: status: { DRDY }[ 1481.390996] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.390998] ata2.00: cmd 61/40:58:80:5a:1e/05:00:55:00:00/40 tag 11 ncq 688128 out[ 1481.390998] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.390999] ata2.00: status: { DRDY }[ 1481.391000] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.391002] ata2.00: cmd 61/40:60:c0:5f:1e/05:00:55:00:00/40 tag 12 ncq 688128 out[ 1481.391002] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.391002] ata2.00: status: { DRDY }[ 1481.391003] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.391005] ata2.00: cmd 61/40:68:00:65:1e/05:00:55:00:00/40 tag 13 ncq 688128 out[ 1481.391005] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.391006] ata2.00: status: { DRDY }[ 1481.391007] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.391008] ata2.00: cmd 61/40:70:40:6a:1e/05:00:55:00:00/40 tag 14 ncq 688128 out[ 1481.391008] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.391009] ata2.00: status: { DRDY }[ 1481.391010] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.391012] ata2.00: cmd 61/40:78:80:6f:1e/05:00:55:00:00/40 tag 15 ncq 688128 out[ 1481.391012] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.391012] ata2.00: status: { DRDY }[ 1481.391013] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.391015] ata2.00: cmd 61/40:80:c0:74:1e/05:00:55:00:00/40 tag 16 ncq 688128 out[ 1481.391015] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.391016] ata2.00: status: { DRDY }[ 1481.391016] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.391018] ata2.00: cmd 61/40:88:00:7a:1e/05:00:55:00:00/40 tag 17 ncq 688128 out[ 1481.391018] res 40/00:01:00:00:00/00:00:00:00:00/40 Emask 0x4 (timeout)[ 1481.391019] ata2.00: status: { DRDY }[ 1481.391020] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.391021] ata2.00: cmd 61/40:90:40:7f:1e/05:00:55:00:00/40 tag 18 ncq 688128 out[ 1481.391021] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.391022] ata2.00: status: { DRDY }[ 1481.391023] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.391025] ata2.00: cmd 61/40:98:80:84:1e/05:00:55:00:00/40 tag 19 ncq 688128 out[ 1481.391025] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.391026] ata2.00: status: { DRDY }[ 1481.391026] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.391028] ata2.00: cmd 61/40:a0:c0:89:1e/06:00:55:00:00/40 tag 20 ncq 819200 out[ 1481.391028] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.391029] ata2.00: status: { DRDY }[ 1481.391030] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.391031] ata2.00: cmd 61/40:a8:00:90:1e/05:00:55:00:00/40 tag 21 ncq 688128 out[ 1481.391031] res 40/00:ff:00:00:00/00:00:00:00:00/40 Emask 0x4 (timeout)[ 1481.391032] ata2.00: status: { DRDY }[ 1481.391033] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.391035] ata2.00: cmd 61/80:b0:40:95:1e/0a:00:55:00:00/40 tag 22 ncq 1376256 out[ 1481.391035] res 40/00:01:00:4f:c2/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.391036] ata2.00: status: { DRDY }[ 1481.391036] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.391038] ata2.00: cmd 61/40:b8:c0:9f:1e/05:00:55:00:00/40 tag 23 ncq 688128 out[ 1481.391038] res 40/00:01:00:4f:c2/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.391039] ata2.00: status: { DRDY }[ 1481.391040] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.391042] ata2.00: cmd 61/c0:c0:00:a5:1e/0f:00:55:00:00/40 tag 24 ncq 2064384 out[ 1481.391042] res 40/00:01:00:4f:c2/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.391043] ata2.00: status: { DRDY }[ 1481.391043] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.391045] ata2.00: cmd 61/c0:c8:c0:b4:1e/0f:00:55:00:00/40 tag 25 ncq 2064384 out[ 1481.391045] res 40/00:00:00:4f:c2/00:00:00:00:00/40 Emask 0x4 (timeout)[ 1481.391046] ata2.00: status: { DRDY }[ 1481.391047] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.391048] ata2.00: cmd 61/40:d0:80:c4:1e/05:00:55:00:00/40 tag 26 ncq 688128 out[ 1481.391048] res 40/00:01:00:00:00/00:00:00:00:00/40 Emask 0x4 (timeout)[ 1481.391049] ata2.00: status: { DRDY }[ 1481.391050] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.391052] ata2.00: cmd 61/40:d8:c0:c9:1e/05:00:55:00:00/40 tag 27 ncq 688128 out[ 1481.391052] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.391053] ata2.00: status: { DRDY }[ 1481.391053] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.391055] ata2.00: cmd 61/40:e0:00:cf:1e/06:00:55:00:00/40 tag 28 ncq 819200 out[ 1481.391055] res 40/00:01:00:4f:c2/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.391056] ata2.00: status: { DRDY }[ 1481.391057] ata2.00: failed command: WRITE FPDMA QUEUED[ 1481.391058] ata2.00: cmd 61/40:e8:40:d5:1e/05:00:55:00:00/40 tag 29 ncq 688128 out[ 1481.391058] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1481.391059] ata2.00: status: { DRDY }[ 1481.391061] ata2: hard resetting link[ 1481.822885] ata2: SATA link up 6.0 Gbps (SStatus 133 SControl 300)[ 1482.366486] ata2.00: configured for UDMA/133[ 1482.366573] ata2.00: device reported invalid CHS sector 0[ 1482.366576] ata2.00: device reported invalid CHS sector 0[ 1482.366578] ata2.00: device reported invalid CHS sector 0[ 1482.366581] ata2.00: device reported invalid CHS sector 0[ 1482.366583] ata2.00: device reported invalid CHS sector 0[ 1482.366586] ata2.00: device reported invalid CHS sector 0[ 1482.366589] ata2.00: device reported invalid CHS sector 0[ 1482.366591] ata2.00: device reported invalid CHS sector 0[ 1482.366593] ata2.00: device reported invalid CHS sector 0[ 1482.366596] ata2.00: device reported invalid CHS sector 0[ 1482.366597] ata2.00: device reported invalid CHS sector 0[ 1482.366600] ata2.00: device reported invalid CHS sector 0[ 1482.366602] ata2.00: device reported invalid CHS sector 0[ 1482.366604] ata2.00: device reported invalid CHS sector 0[ 1482.366606] ata2.00: device reported invalid CHS sector 0[ 1482.366609] ata2.00: device reported invalid CHS sector 0[ 1482.366611] ata2.00: device reported invalid CHS sector 0[ 1482.366613] ata2.00: device reported invalid CHS sector 0[ 1482.366615] ata2.00: device reported invalid CHS sector 0[ 1482.366617] ata2.00: device reported invalid CHS sector 0[ 1482.366619] ata2.00: device reported invalid CHS sector 0[ 1482.366621] ata2.00: device reported invalid CHS sector 0[ 1482.366623] ata2.00: device reported invalid CHS sector 0[ 1482.366626] ata2.00: device reported invalid CHS sector 0[ 1482.366628] ata2.00: device reported invalid CHS sector 0[ 1482.366630] ata2.00: device reported invalid CHS sector 0[ 1482.366632] ata2.00: device reported invalid CHS sector 0[ 1482.366634] ata2.00: device reported invalid CHS sector 0[ 1482.366636] ata2.00: device reported invalid CHS sector 0[ 1482.366637] ata2.00: device reported invalid CHS sector 0[ 1482.366650] ata2: EH complete[ 1633.454773] ata2.00: exception Emask 0x0 SAct 0x7fdfffff SErr 0x0 action 0x6 frozen[ 1633.454788] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454790] ata2.00: cmd 61/40:00:00:a5:94/05:00:55:00:00/40 tag 0 ncq 688128 out[ 1633.454790] res 40/00:01:00:4f:c2/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454791] ata2.00: status: { DRDY }[ 1633.454792] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454794] ata2.00: cmd 61/c0:08:40:aa:94/0f:00:55:00:00/40 tag 1 ncq 2064384 out[ 1633.454794] res 40/00:01:00:4f:c2/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454795] ata2.00: status: { DRDY }[ 1633.454796] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454798] ata2.00: cmd 61/80:10:00:ba:94/0a:00:55:00:00/40 tag 2 ncq 1376256 out[ 1633.454798] res 40/00:00:00:4f:c2/00:00:00:00:00/40 Emask 0x4 (timeout)[ 1633.454799] ata2.00: status: { DRDY }[ 1633.454800] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454801] ata2.00: cmd 61/40:18:80:c4:94/05:00:55:00:00/40 tag 3 ncq 688128 out[ 1633.454801] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454802] ata2.00: status: { DRDY }[ 1633.454803] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454805] ata2.00: cmd 61/40:20:c0:c9:94/05:00:55:00:00/40 tag 4 ncq 688128 out[ 1633.454805] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454805] ata2.00: status: { DRDY }[ 1633.454806] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454808] ata2.00: cmd 61/40:28:00:cf:94/06:00:55:00:00/40 tag 5 ncq 819200 out[ 1633.454808] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454809] ata2.00: status: { DRDY }[ 1633.454810] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454811] ata2.00: cmd 61/40:30:40:d5:94/05:00:55:00:00/40 tag 6 ncq 688128 out[ 1633.454811] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454812] ata2.00: status: { DRDY }[ 1633.454813] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454815] ata2.00: cmd 61/80:38:80:da:94/0a:00:55:00:00/40 tag 7 ncq 1376256 out[ 1633.454815] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454816] ata2.00: status: { DRDY }[ 1633.454816] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454818] ata2.00: cmd 61/40:40:00:e5:94/05:00:55:00:00/40 tag 8 ncq 688128 out[ 1633.454818] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454819] ata2.00: status: { DRDY }[ 1633.454820] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454821] ata2.00: cmd 61/40:48:40:ea:94/05:00:55:00:00/40 tag 9 ncq 688128 out[ 1633.454821] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454822] ata2.00: status: { DRDY }[ 1633.454823] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454825] ata2.00: cmd 61/80:50:80:ef:94/0a:00:55:00:00/40 tag 10 ncq 1376256 out[ 1633.454825] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454826] ata2.00: status: { DRDY }[ 1633.454826] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454828] ata2.00: cmd 61/40:58:00:fa:94/05:00:55:00:00/40 tag 11 ncq 688128 out[ 1633.454828] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454829] ata2.00: status: { DRDY }[ 1633.454830] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454832] ata2.00: cmd 61/40:60:40:ff:94/05:00:55:00:00/40 tag 12 ncq 688128 out[ 1633.454832] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454832] ata2.00: status: { DRDY }[ 1633.454833] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454835] ata2.00: cmd 61/40:68:80:04:95/05:00:55:00:00/40 tag 13 ncq 688128 out[ 1633.454835] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454836] ata2.00: status: { DRDY }[ 1633.454837] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454838] ata2.00: cmd 61/40:70:c0:09:95/05:00:55:00:00/40 tag 14 ncq 688128 out[ 1633.454838] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454839] ata2.00: status: { DRDY }[ 1633.454840] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454842] ata2.00: cmd 61/40:78:00:0f:95/06:00:55:00:00/40 tag 15 ncq 819200 out[ 1633.454842] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454842] ata2.00: status: { DRDY }[ 1633.454843] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454845] ata2.00: cmd 61/40:80:40:15:95/05:00:55:00:00/40 tag 16 ncq 688128 out[ 1633.454845] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454846] ata2.00: status: { DRDY }[ 1633.454847] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454848] ata2.00: cmd 61/40:88:80:1a:95/05:00:55:00:00/40 tag 17 ncq 688128 out[ 1633.454848] res 40/00:01:00:00:00/00:00:00:00:00/40 Emask 0x4 (timeout)[ 1633.454849] ata2.00: status: { DRDY }[ 1633.454850] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454852] ata2.00: cmd 61/80:90:c0:1f:95/0a:00:55:00:00/40 tag 18 ncq 1376256 out[ 1633.454852] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454853] ata2.00: status: { DRDY }[ 1633.454853] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454855] ata2.00: cmd 61/80:98:40:2a:95/1f:00:55:00:00/40 tag 19 ncq 4128768 out[ 1633.454855] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454856] ata2.00: status: { DRDY }[ 1633.454857] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454858] ata2.00: cmd 61/40:a0:c0:49:95/05:00:55:00:00/40 tag 20 ncq 688128 out[ 1633.454858] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454859] ata2.00: status: { DRDY }[ 1633.454860] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454862] ata2.00: cmd 61/80:b0:00:05:94/2a:00:55:00:00/40 tag 22 ncq 5570560 out[ 1633.454862] res 40/00:01:00:4f:c2/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454863] ata2.00: status: { DRDY }[ 1633.454863] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454865] ata2.00: cmd 61/40:b8:80:2f:94/1a:00:55:00:00/40 tag 23 ncq 3440640 out[ 1633.454865] res 40/00:01:00:4f:c2/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454866] ata2.00: status: { DRDY }[ 1633.454867] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454869] ata2.00: cmd 61/40:c0:c0:49:94/05:00:55:00:00/40 tag 24 ncq 688128 out[ 1633.454869] res 40/00:01:00:4f:c2/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454869] ata2.00: status: { DRDY }[ 1633.454870] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454872] ata2.00: cmd 61/80:c8:00:4f:94/20:00:55:00:00/40 tag 25 ncq 4259840 out[ 1633.454872] res 40/00:00:00:4f:c2/00:00:00:00:00/40 Emask 0x4 (timeout)[ 1633.454873] ata2.00: status: { DRDY }[ 1633.454874] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454875] ata2.00: cmd 61/80:d0:80:6f:94/0a:00:55:00:00/40 tag 26 ncq 1376256 out[ 1633.454875] res 40/00:01:00:00:00/00:00:00:00:00/40 Emask 0x4 (timeout)[ 1633.454876] ata2.00: status: { DRDY }[ 1633.454877] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454879] ata2.00: cmd 61/c0:d8:00:7a:94/0f:00:55:00:00/40 tag 27 ncq 2064384 out[ 1633.454879] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454880] ata2.00: status: { DRDY }[ 1633.454880] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454882] ata2.00: cmd 61/80:e0:c0:89:94/0b:00:55:00:00/40 tag 28 ncq 1507328 out[ 1633.454882] res 40/00:01:00:4f:c2/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454883] ata2.00: status: { DRDY }[ 1633.454884] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454885] ata2.00: cmd 61/40:e8:40:95:94/05:00:55:00:00/40 tag 29 ncq 688128 out[ 1633.454885] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1633.454886] ata2.00: status: { DRDY }[ 1633.454887] ata2.00: failed command: WRITE FPDMA QUEUED[ 1633.454889] ata2.00: cmd 61/80:f0:80:9a:94/0a:00:55:00:00/40 tag 30 ncq 1376256 out[ 1633.454889] res 40/00:ff:00:00:00/00:00:00:00:00/40 Emask 0x4 (timeout)[ 1633.454890] ata2.00: status: { DRDY }[ 1633.454891] ata2: hard resetting link[ 1633.774755] ata2: SATA link up 6.0 Gbps (SStatus 133 SControl 300)[ 1634.469553] ata2.00: configured for UDMA/133[ 1634.469661] ata2.00: device reported invalid CHS sector 0[ 1634.469669] ata2.00: device reported invalid CHS sector 0[ 1634.469674] ata2.00: device reported invalid CHS sector 0[ 1634.469679] ata2.00: device reported invalid CHS sector 0[ 1634.469685] ata2.00: device reported invalid CHS sector 0[ 1634.469689] ata2.00: device reported invalid CHS sector 0[ 1634.469694] ata2.00: device reported invalid CHS sector 0[ 1634.469699] ata2.00: device reported invalid CHS sector 0[ 1634.469705] ata2.00: device reported invalid CHS sector 0[ 1634.469709] ata2.00: device reported invalid CHS sector 0[ 1634.469713] ata2.00: device reported invalid CHS sector 0[ 1634.469719] ata2.00: device reported invalid CHS sector 0[ 1634.469723] ata2.00: device reported invalid CHS sector 0[ 1634.469728] ata2.00: device reported invalid CHS sector 0[ 1634.469732] ata2.00: device reported invalid CHS sector 0[ 1634.469737] ata2.00: device reported invalid CHS sector 0[ 1634.469741] ata2.00: device reported invalid CHS sector 0[ 1634.469746] ata2.00: device reported invalid CHS sector 0[ 1634.469751] ata2.00: device reported invalid CHS sector 0[ 1634.469757] ata2.00: device reported invalid CHS sector 0[ 1634.469760] ata2.00: device reported invalid CHS sector 0[ 1634.469766] ata2.00: device reported invalid CHS sector 0[ 1634.469772] ata2.00: device reported invalid CHS sector 0[ 1634.469775] ata2.00: device reported invalid CHS sector 0[ 1634.469781] ata2.00: device reported invalid CHS sector 0[ 1634.469785] ata2.00: device reported invalid CHS sector 0[ 1634.469790] ata2.00: device reported invalid CHS sector 0[ 1634.469795] ata2.00: device reported invalid CHS sector 0[ 1634.469800] ata2.00: device reported invalid CHS sector 0[ 1634.469805] ata2.00: device reported invalid CHS sector 0[ 1634.469832] ata2: EH complete[ 1708.462804] ata2.00: exception Emask 0x0 SAct 0x7fffffdf SErr 0x0 action 0x6 frozen[ 1708.462813] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.462821] ata2.00: cmd 61/c0:00:40:ea:da/25:00:55:00:00/40 tag 0 ncq 4947968 out[ 1708.462821] res 40/00:01:00:4f:c2/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1708.462825] ata2.00: status: { DRDY }[ 1708.462828] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.462834] ata2.00: cmd 61/80:08:00:10:db/1c:00:55:00:00/40 tag 1 ncq 3735552 out[ 1708.462834] res 40/00:01:00:4f:c2/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1708.462837] ata2.00: status: { DRDY }[ 1708.462840] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.462846] ata2.00: cmd 61/80:10:80:2c:db/0a:00:55:00:00/40 tag 2 ncq 1376256 out[ 1708.462846] res 40/00:00:00:4f:c2/00:00:00:00:00/40 Emask 0x4 (timeout)[ 1708.462849] ata2.00: status: { DRDY }[ 1708.462852] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.462858] ata2.00: cmd 61/40:18:00:37:db/05:00:55:00:00/40 tag 3 ncq 688128 out[ 1708.462858] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1708.462860] ata2.00: status: { DRDY }[ 1708.462863] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.462869] ata2.00: cmd 61/c0:20:40:3c:db/0f:00:55:00:00/40 tag 4 ncq 2064384 out[ 1708.462869] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1708.462872] ata2.00: status: { DRDY }[ 1708.462874] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.462880] ata2.00: cmd 61/40:30:40:a7:d9/33:00:55:00:00/40 tag 6 ncq 6717440 out[ 1708.462880] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1708.462883] ata2.00: status: { DRDY }[ 1708.462885] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.462891] ata2.00: cmd 61/40:38:80:da:d9/05:00:55:00:00/40 tag 7 ncq 688128 out[ 1708.462891] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1708.462894] ata2.00: status: { DRDY }[ 1708.462896] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.462902] ata2.00: cmd 61/c0:40:c0:df:d9/0f:00:55:00:00/40 tag 8 ncq 2064384 out[ 1708.462902] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1708.462905] ata2.00: status: { DRDY }[ 1708.462907] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.462913] ata2.00: cmd 61/80:48:80:ef:d9/0a:00:55:00:00/40 tag 9 ncq 1376256 out[ 1708.462913] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1708.462916] ata2.00: status: { DRDY }[ 1708.462918] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.462924] ata2.00: cmd 61/00:50:00:fa:d9/08:00:55:00:00/40 tag 10 ncq 1048576 out[ 1708.462924] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1708.462927] ata2.00: status: { DRDY }[ 1708.462930] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.462935] ata2.00: cmd 61/40:58:00:02:da/05:00:55:00:00/40 tag 11 ncq 688128 out[ 1708.462935] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1708.462938] ata2.00: status: { DRDY }[ 1708.462941] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.462946] ata2.00: cmd 61/c0:60:40:07:da/08:00:55:00:00/40 tag 12 ncq 1146880 out[ 1708.462946] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1708.462949] ata2.00: status: { DRDY }[ 1708.462952] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.462957] ata2.00: cmd 61/80:68:00:10:da/0a:00:55:00:00/40 tag 13 ncq 1376256 out[ 1708.462957] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1708.462960] ata2.00: status: { DRDY }[ 1708.462963] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.462968] ata2.00: cmd 61/40:70:80:1a:da/05:00:55:00:00/40 tag 14 ncq 688128 out[ 1708.462968] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1708.462971] ata2.00: status: { DRDY }[ 1708.462974] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.462979] ata2.00: cmd 61/40:78:c0:1f:da/05:00:55:00:00/40 tag 15 ncq 688128 out[ 1708.462979] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1708.462982] ata2.00: status: { DRDY }[ 1708.462985] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.462990] ata2.00: cmd 61/40:80:00:25:da/05:00:55:00:00/40 tag 16 ncq 688128 out[ 1708.462990] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1708.462993] ata2.00: status: { DRDY }[ 1708.462995] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.463001] ata2.00: cmd 61/40:88:40:2a:da/05:00:55:00:00/40 tag 17 ncq 688128 out[ 1708.463001] res 40/00:01:00:00:00/00:00:00:00:00/40 Emask 0x4 (timeout)[ 1708.463004] ata2.00: status: { DRDY }[ 1708.463007] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.463012] ata2.00: cmd 61/40:90:80:2f:da/05:00:55:00:00/40 tag 18 ncq 688128 out[ 1708.463012] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1708.463015] ata2.00: status: { DRDY }[ 1708.463018] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.463023] ata2.00: cmd 61/40:98:c0:34:da/05:00:55:00:00/40 tag 19 ncq 688128 out[ 1708.463023] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1708.463026] ata2.00: status: { DRDY }[ 1708.463028] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.463034] ata2.00: cmd 61/80:a0:00:3a:da/0a:00:55:00:00/40 tag 20 ncq 1376256 out[ 1708.463034] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1708.463037] ata2.00: status: { DRDY }[ 1708.463039] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.463045] ata2.00: cmd 61/40:a8:80:44:da/05:00:55:00:00/40 tag 21 ncq 688128 out[ 1708.463045] res 40/00:ff:00:00:00/00:00:00:00:00/40 Emask 0x4 (timeout)[ 1708.463048] ata2.00: status: { DRDY }[ 1708.463050] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.463056] ata2.00: cmd 61/40:b0:c0:49:da/05:00:55:00:00/40 tag 22 ncq 688128 out[ 1708.463056] res 40/00:01:00:4f:c2/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1708.463059] ata2.00: status: { DRDY }[ 1708.463061] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.463067] ata2.00: cmd 61/00:b8:00:4f:da/01:00:55:00:00/40 tag 23 ncq 131072 out[ 1708.463067] res 40/00:01:00:4f:c2/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1708.463070] ata2.00: status: { DRDY }[ 1708.463072] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.463078] ata2.00: cmd 61/40:c0:00:50:da/05:00:55:00:00/40 tag 24 ncq 688128 out[ 1708.463078] res 40/00:01:00:4f:c2/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1708.463081] ata2.00: status: { DRDY }[ 1708.463083] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.463089] ata2.00: cmd 61/40:c8:40:55:da/05:00:55:00:00/40 tag 25 ncq 688128 out[ 1708.463089] res 40/00:00:00:4f:c2/00:00:00:00:00/40 Emask 0x4 (timeout)[ 1708.463092] ata2.00: status: { DRDY }[ 1708.463094] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.463100] ata2.00: cmd 61/c0:d0:80:5a:da/0c:00:55:00:00/40 tag 26 ncq 1671168 out[ 1708.463100] res 40/00:01:00:00:00/00:00:00:00:00/40 Emask 0x4 (timeout)[ 1708.463103] ata2.00: status: { DRDY }[ 1708.463105] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.463111] ata2.00: cmd 61/80:d8:40:67:da/1f:00:55:00:00/40 tag 27 ncq 4128768 out[ 1708.463111] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1708.463114] ata2.00: status: { DRDY }[ 1708.463116] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.463122] ata2.00: cmd 61/80:e0:c0:86:da/0e:00:55:00:00/40 tag 28 ncq 1900544 out[ 1708.463122] res 40/00:01:00:4f:c2/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1708.463125] ata2.00: status: { DRDY }[ 1708.463127] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.463133] ata2.00: cmd 61/c0:e8:40:95:da/24:00:55:00:00/40 tag 29 ncq 4816896 out[ 1708.463133] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1708.463136] ata2.00: status: { DRDY }[ 1708.463138] ata2.00: failed command: WRITE FPDMA QUEUED[ 1708.463144] ata2.00: cmd 61/40:f0:00:ba:da/30:00:55:00:00/40 tag 30 ncq 6324224 out[ 1708.463144] res 40/00:ff:00:00:00/00:00:00:00:00/40 Emask 0x4 (timeout)[ 1708.463147] ata2.00: status: { DRDY }[ 1708.463152] ata2: hard resetting link[ 1708.894676] ata2: SATA link up 6.0 Gbps (SStatus 133 SControl 300)[ 1709.820112] ata2.00: configured for UDMA/133[ 1709.820218] ata2.00: device reported invalid CHS sector 0[ 1709.820221] ata2.00: device reported invalid CHS sector 0[ 1709.820223] ata2.00: device reported invalid CHS sector 0[ 1709.820225] ata2.00: device reported invalid CHS sector 0[ 1709.820226] ata2.00: device reported invalid CHS sector 0[ 1709.820228] ata2.00: device reported invalid CHS sector 0[ 1709.820229] ata2.00: device reported invalid CHS sector 0[ 1709.820231] ata2.00: device reported invalid CHS sector 0[ 1709.820233] ata2.00: device reported invalid CHS sector 0[ 1709.820234] ata2.00: device reported invalid CHS sector 0[ 1709.820235] ata2.00: device reported invalid CHS sector 0[ 1709.820237] ata2.00: device reported invalid CHS sector 0[ 1709.820238] ata2.00: device reported invalid CHS sector 0[ 1709.820239] ata2.00: device reported invalid CHS sector 0[ 1709.820240] ata2.00: device reported invalid CHS sector 0[ 1709.820241] ata2.00: device reported invalid CHS sector 0[ 1709.820242] ata2.00: device reported invalid CHS sector 0[ 1709.820244] ata2.00: device reported invalid CHS sector 0[ 1709.820245] ata2.00: device reported invalid CHS sector 0[ 1709.820246] ata2.00: device reported invalid CHS sector 0[ 1709.820247] ata2.00: device reported invalid CHS sector 0[ 1709.820249] ata2.00: device reported invalid CHS sector 0[ 1709.820250] ata2.00: device reported invalid CHS sector 0[ 1709.820251] ata2.00: device reported invalid CHS sector 0[ 1709.820252] ata2.00: device reported invalid CHS sector 0[ 1709.820254] ata2.00: device reported invalid CHS sector 0[ 1709.820255] ata2.00: device reported invalid CHS sector 0[ 1709.820256] ata2.00: device reported invalid CHS sector 0[ 1709.820258] ata2.00: device reported invalid CHS sector 0[ 1709.820259] ata2.00: device reported invalid CHS sector 0[ 1709.820268] ata2: EH complete[ 1762.478653] ata2.00: NCQ disabled due to excessive errors[ 1762.478667] ata2.00: exception Emask 0x0 SAct 0x7fff7fff SErr 0x0 action 0x6 frozen[ 1762.478669] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478672] ata2.00: cmd 61/80:00:40:6a:f6/0a:00:55:00:00/40 tag 0 ncq 1376256 out[ 1762.478672] res 40/00:01:00:4f:c2/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1762.478673] ata2.00: status: { DRDY }[ 1762.478674] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478676] ata2.00: cmd 61/40:08:c0:74:f6/05:00:55:00:00/40 tag 1 ncq 688128 out[ 1762.478676] res 40/00:01:00:4f:c2/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1762.478677] ata2.00: status: { DRDY }[ 1762.478678] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478680] ata2.00: cmd 61/40:10:00:7a:f6/1b:00:55:00:00/40 tag 2 ncq 3571712 out[ 1762.478680] res 40/00:00:00:4f:c2/00:00:00:00:00/40 Emask 0x4 (timeout)[ 1762.478681] ata2.00: status: { DRDY }[ 1762.478682] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478684] ata2.00: cmd 61/80:18:40:95:f6/0a:00:55:00:00/40 tag 3 ncq 1376256 out[ 1762.478684] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1762.478685] ata2.00: status: { DRDY }[ 1762.478685] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478687] ata2.00: cmd 61/80:20:c0:9f:f6/0a:00:55:00:00/40 tag 4 ncq 1376256 out[ 1762.478687] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1762.478688] ata2.00: status: { DRDY }[ 1762.478689] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478691] ata2.00: cmd 61/40:28:40:aa:f6/0e:00:55:00:00/40 tag 5 ncq 1867776 out[ 1762.478691] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1762.478692] ata2.00: status: { DRDY }[ 1762.478693] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478695] ata2.00: cmd 61/80:30:80:b8:f6/17:00:55:00:00/40 tag 6 ncq 3080192 out[ 1762.478695] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1762.478695] ata2.00: status: { DRDY }[ 1762.478696] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478698] ata2.00: cmd 61/c0:38:00:d0:f6/24:00:55:00:00/40 tag 7 ncq 4816896 out[ 1762.478698] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1762.478699] ata2.00: status: { DRDY }[ 1762.478700] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478702] ata2.00: cmd 61/80:40:c0:f4:f6/20:00:55:00:00/40 tag 8 ncq 4259840 out[ 1762.478702] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1762.478703] ata2.00: status: { DRDY }[ 1762.478704] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478705] ata2.00: cmd 61/40:48:40:15:f7/1a:00:55:00:00/40 tag 9 ncq 3440640 out[ 1762.478705] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1762.478706] ata2.00: status: { DRDY }[ 1762.478707] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478709] ata2.00: cmd 61/00:50:80:2f:f7/15:00:55:00:00/40 tag 10 ncq 2752512 out[ 1762.478709] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1762.478710] ata2.00: status: { DRDY }[ 1762.478711] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478713] ata2.00: cmd 61/00:58:80:44:f7/16:00:55:00:00/40 tag 11 ncq 2883584 out[ 1762.478713] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1762.478714] ata2.00: status: { DRDY }[ 1762.478715] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478716] ata2.00: cmd 61/c0:60:80:5a:f7/18:00:55:00:00/40 tag 12 ncq 3244032 out[ 1762.478716] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1762.478717] ata2.00: status: { DRDY }[ 1762.478718] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478720] ata2.00: cmd 61/80:68:40:73:f7/0a:00:55:00:00/40 tag 13 ncq 1376256 out[ 1762.478720] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1762.478721] ata2.00: status: { DRDY }[ 1762.478722] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478724] ata2.00: cmd 61/80:70:c0:7d:f7/0a:00:55:00:00/40 tag 14 ncq 1376256 out[ 1762.478724] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1762.478725] ata2.00: status: { DRDY }[ 1762.478725] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478727] ata2.00: cmd 61/c0:80:40:bf:f5/2e:00:55:00:00/40 tag 16 ncq 6127616 out[ 1762.478727] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1762.478728] ata2.00: status: { DRDY }[ 1762.478729] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478731] ata2.00: cmd 61/40:88:00:ee:f5/1a:00:55:00:00/40 tag 17 ncq 3440640 out[ 1762.478731] res 40/00:01:00:00:00/00:00:00:00:00/40 Emask 0x4 (timeout)[ 1762.478732] ata2.00: status: { DRDY }[ 1762.478733] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478735] ata2.00: cmd 61/c0:90:40:08:f6/07:00:55:00:00/40 tag 18 ncq 1015808 out[ 1762.478735] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1762.478736] ata2.00: status: { DRDY }[ 1762.478737] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478738] ata2.00: cmd 61/40:98:00:10:f6/05:00:55:00:00/40 tag 19 ncq 688128 out[ 1762.478738] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1762.478739] ata2.00: status: { DRDY }[ 1762.478740] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478742] ata2.00: cmd 61/40:a0:40:15:f6/05:00:55:00:00/40 tag 20 ncq 688128 out[ 1762.478742] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1762.478743] ata2.00: status: { DRDY }[ 1762.478744] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478746] ata2.00: cmd 61/80:a8:80:1a:f6/0a:00:55:00:00/40 tag 21 ncq 1376256 out[ 1762.478746] res 40/00:ff:00:00:00/00:00:00:00:00/40 Emask 0x4 (timeout)[ 1762.478747] ata2.00: status: { DRDY }[ 1762.478747] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478749] ata2.00: cmd 61/80:b0:00:25:f6/0a:00:55:00:00/40 tag 22 ncq 1376256 out[ 1762.478749] res 40/00:01:00:4f:c2/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1762.478750] ata2.00: status: { DRDY }[ 1762.478751] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478753] ata2.00: cmd 61/80:b8:80:2f:f6/0a:00:55:00:00/40 tag 23 ncq 1376256 out[ 1762.478753] res 40/00:01:00:4f:c2/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1762.478754] ata2.00: status: { DRDY }[ 1762.478755] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478757] ata2.00: cmd 61/c0:c0:00:3a:f6/0f:00:55:00:00/40 tag 24 ncq 2064384 out[ 1762.478757] res 40/00:01:00:4f:c2/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1762.478758] ata2.00: status: { DRDY }[ 1762.478758] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478760] ata2.00: cmd 61/40:c8:c0:49:f6/06:00:55:00:00/40 tag 25 ncq 819200 out[ 1762.478760] res 40/00:00:00:4f:c2/00:00:00:00:00/40 Emask 0x4 (timeout)[ 1762.478761] ata2.00: status: { DRDY }[ 1762.478762] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478764] ata2.00: cmd 61/40:d0:00:50:f6/05:00:55:00:00/40 tag 26 ncq 688128 out[ 1762.478764] res 40/00:01:00:00:00/00:00:00:00:00/40 Emask 0x4 (timeout)[ 1762.478765] ata2.00: status: { DRDY }[ 1762.478766] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478768] ata2.00: cmd 61/40:d8:40:55:f6/05:00:55:00:00/40 tag 27 ncq 688128 out[ 1762.478768] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1762.478769] ata2.00: status: { DRDY }[ 1762.478769] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478771] ata2.00: cmd 61/40:e0:80:5a:f6/05:00:55:00:00/40 tag 28 ncq 688128 out[ 1762.478771] res 40/00:01:00:4f:c2/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1762.478772] ata2.00: status: { DRDY }[ 1762.478773] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478775] ata2.00: cmd 61/40:e8:c0:5f:f6/05:00:55:00:00/40 tag 29 ncq 688128 out[ 1762.478775] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1762.478776] ata2.00: status: { DRDY }[ 1762.478777] ata2.00: failed command: WRITE FPDMA QUEUED[ 1762.478778] ata2.00: cmd 61/40:f0:00:65:f6/05:00:55:00:00/40 tag 30 ncq 688128 out[ 1762.478778] res 40/00:ff:00:00:00/00:00:00:00:00/40 Emask 0x4 (timeout)[ 1762.478779] ata2.00: status: { DRDY }[ 1762.478781] ata2: hard resetting link[ 1763.022682] ata2: SATA link up 6.0 Gbps (SStatus 133 SControl 300)[ 1763.934823] ata2.00: configured for UDMA/133[ 1763.934936] ata2.00: device reported invalid CHS sector 0[ 1763.934938] ata2.00: device reported invalid CHS sector 0[ 1763.934940] ata2.00: device reported invalid CHS sector 0[ 1763.934941] ata2.00: device reported invalid CHS sector 0[ 1763.934943] ata2.00: device reported invalid CHS sector 0[ 1763.934944] ata2.00: device reported invalid CHS sector 0[ 1763.934946] ata2.00: device reported invalid CHS sector 0[ 1763.934947] ata2.00: device reported invalid CHS sector 0[ 1763.934949] ata2.00: device reported invalid CHS sector 0[ 1763.934951] ata2.00: device reported invalid CHS sector 0[ 1763.934953] ata2.00: device reported invalid CHS sector 0[ 1763.934954] ata2.00: device reported invalid CHS sector 0[ 1763.934956] ata2.00: device reported invalid CHS sector 0[ 1763.934957] ata2.00: device reported invalid CHS sector 0[ 1763.934959] ata2.00: device reported invalid CHS sector 0[ 1763.934960] ata2.00: device reported invalid CHS sector 0[ 1763.934962] ata2.00: device reported invalid CHS sector 0[ 1763.934963] ata2.00: device reported invalid CHS sector 0[ 1763.934965] ata2.00: device reported invalid CHS sector 0[ 1763.934966] ata2.00: device reported invalid CHS sector 0[ 1763.934967] ata2.00: device reported invalid CHS sector 0[ 1763.934969] ata2.00: device reported invalid CHS sector 0[ 1763.934970] ata2.00: device reported invalid CHS sector 0[ 1763.934971] ata2.00: device reported invalid CHS sector 0[ 1763.934973] ata2.00: device reported invalid CHS sector 0[ 1763.934974] ata2.00: device reported invalid CHS sector 0[ 1763.934975] ata2.00: device reported invalid CHS sector 0[ 1763.934976] ata2.00: device reported invalid CHS sector 0[ 1763.934978] ata2.00: device reported invalid CHS sector 0[ 1763.934979] ata2.00: device reported invalid CHS sector 0[ 1763.934987] ata2: EH complete[ 1827.374614] ata2.00: exception Emask 0x0 SAct 0x0 SErr 0x0 action 0x6 frozen[ 1827.374628] ata2.00: failed command: WRITE DMA EXT[ 1827.374631] ata2.00: cmd 35/00:c0:40:d5:19/00:28:56:00:00/e0 tag 29 dma 5341184 out[ 1827.374631] res 40/00:01:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1827.374632] ata2.00: status: { DRDY }[ 1827.374634] ata2: hard resetting link[ 1827.806569] ata2: SATA link up 6.0 Gbps (SStatus 133 SControl 300)[ 1827.854797] ata2.00: configured for UDMA/133[ 1827.854910] ata2.00: device reported invalid CHS sector 0[ 1827.854914] ata2: EH complete[ 1860.398557] ata2.00: exception Emask 0x0 SAct 0x0 SErr 0x0 action 0x6 frozen[ 1860.398565] ata2.00: failed command: WRITE DMA EXT[ 1860.398572] ata2.00: cmd 35/00:80:80:b0:21/00:34:56:00:00/e0 tag 30 dma 6881280 out[ 1860.398572] res 40/00:ff:00:00:00/00:00:00:00:00/40 Emask 0x4 (timeout)[ 1860.398574] ata2.00: status: { DRDY }[ 1860.398578] ata2: hard resetting link[ 1860.718530] ata2: SATA link up 6.0 Gbps (SStatus 133 SControl 300)[ 1861.560847] ata2.00: configured for UDMA/133[ 1861.560958] ata2.00: device reported invalid CHS sector 0[ 1861.560971] ata2: EH complete[ 1892.398591] ata2.00: exception Emask 0x0 SAct 0x0 SErr 0x0 action 0x6 frozen[ 1892.398600] ata2.00: failed command: WRITE DMA EXT[ 1892.398608] ata2.00: cmd 35/00:00:40:c0:22/00:2a:56:00:00/e0 tag 11 dma 5505024 out[ 1892.398608] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[ 1892.398612] ata2.00: status: { DRDY }[ 1892.398617] ata2: hard resetting link[ 1897.758499] ata2: link is slow to respond, please be patient (ready=0)[ 1902.406499] ata2: COMRESET failed (errno=-16)[ 1902.406506] ata2: hard resetting link[ 1907.766490] ata2: link is slow to respond, please be patient (ready=0)[ 1912.414544] ata2: COMRESET failed (errno=-16)[ 1912.414556] ata2: hard resetting link[ 1917.774496] ata2: link is slow to respond, please be patient (ready=0)[ 1947.454483] ata2: COMRESET failed (errno=-16)[ 1947.454495] ata2: limiting SATA link speed to 3.0 Gbps[ 1947.454500] ata2: hard resetting link[ 1952.478482] ata2: COMRESET failed (errno=-16)[ 1952.478493] ata2: reset failed, giving up[ 1952.478498] ata2.00: disabled[ 1952.478508] ata2.00: device reported invalid CHS sector 0[ 1952.478522] ata2: EH complete[ 1952.479208] sd 1:0:0:0: [sda] tag#13 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 1952.479216] sd 1:0:0:0: [sda] tag#13 CDB: Write(16) 8a 00 00 00 00 00 56 22 c0 40 00 00 2a 00 00 00[ 1952.479220] blk_update_request: I/O error, dev sda, sector 1445118016[ 1952.479266] EXT4-fs warning (device dm-3): ext4_end_bio:317: I/O error -5 writing to inode 230687853 (offset 380370944 size 5505024 starting block 180639240)[ 1952.479271] Buffer I/O error on device dm-3, logical block 180639240[ 1952.479277] Buffer I/O error on device dm-3, logical block 180639241[ 1952.479281] Buffer I/O error on device dm-3, logical block 180639242[ 1952.479284] Buffer I/O error on device dm-3, logical block 180639243[ 1952.479287] Buffer I/O error on device dm-3, logical block 180639244[ 1952.479290] Buffer I/O error on device dm-3, logical block 180639245[ 1952.479293] Buffer I/O error on device dm-3, logical block 180639246[ 1952.479296] Buffer I/O error on device dm-3, logical block 180639247[ 1952.479300] Buffer I/O error on device dm-3, logical block 180639248[ 1952.479303] Buffer I/O error on device dm-3, logical block 180639249[ 1952.479463] EXT4-fs warning (device dm-3): ext4_end_bio:317: I/O error -5 writing to inode 230687853 (offset 380370944 size 5505024 starting block 180639408)[ 1952.479629] EXT4-fs warning (device dm-3): ext4_end_bio:317: I/O error -5 writing to inode 230687853 (offset 380370944 size 5505024 starting block 180639576)[ 1952.479796] EXT4-fs warning (device dm-3): ext4_end_bio:317: I/O error -5 writing to inode 230687853 (offset 385875968 size 8388608 starting block 180639744)[ 1952.479953] EXT4-fs warning (device dm-3): ext4_end_bio:317: I/O error -5 writing to inode 230687853 (offset 385875968 size 8388608 starting block 180639912)[ 1952.480116] EXT4-fs warning (device dm-3): ext4_end_bio:317: I/O error -5 writing to inode 230687853 (offset 385875968 size 8388608 starting block 180640080)[ 1952.480271] EXT4-fs warning (device dm-3): ext4_end_bio:317: I/O error -5 writing to inode 230687853 (offset 385875968 size 8388608 starting block 180640248)[ 1952.480435] EXT4-fs warning (device dm-3): ext4_end_bio:317: I/O error -5 writing to inode 230687853 (offset 385875968 size 8388608 starting block 180640416)[ 1952.480588] sd 1:0:0:0: [sda] tag#14 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 1952.480593] sd 1:0:0:0: [sda] tag#14 CDB: Write(16) 8a 00 00 00 00 00 56 22 ea 40 00 00 05 40 00 00[ 1952.480596] blk_update_request: I/O error, dev sda, sector 1445128768[ 1952.480643] EXT4-fs warning (device dm-3): ext4_end_bio:317: I/O error -5 writing to inode 230687853 (offset 385875968 size 8388608 starting block 180640584)[ 1952.480837] sd 1:0:0:0: [sda] tag#15 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 1952.480842] sd 1:0:0:0: [sda] tag#15 CDB: Write(16) 8a 00 00 00 00 00 56 22 ef 80 00 00 2b 00 00 00[ 1952.480845] blk_update_request: I/O error, dev sda, sector 1445130112[ 1952.480895] EXT4-fs warning (device dm-3): ext4_end_bio:317: I/O error -5 writing to inode 230687853 (offset 385875968 size 8388608 starting block 180640752)[ 1952.482184] sd 1:0:0:0: [sda] tag#16 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 1952.482190] sd 1:0:0:0: [sda] tag#16 CDB: Write(16) 8a 00 00 00 00 00 56 23 1a 80 00 00 05 40 00 00[ 1952.482193] blk_update_request: I/O error, dev sda, sector 1445141120[ 1952.482417] sd 1:0:0:0: [sda] tag#17 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 1952.482422] sd 1:0:0:0: [sda] tag#17 CDB: Write(16) 8a 00 00 00 00 00 56 23 1f c0 00 00 10 c0 00 00[ 1952.482426] blk_update_request: I/O error, dev sda, sector 1445142464[ 1952.483019] sd 1:0:0:0: [sda] tag#18 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 1952.483024] sd 1:0:0:0: [sda] tag#18 CDB: Write(16) 8a 00 00 00 00 00 56 23 30 80 00 00 24 c0 00 00[ 1952.483027] blk_update_request: I/O error, dev sda, sector 1445146752[ 1952.484124] sd 1:0:0:0: [sda] tag#19 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 1952.484129] sd 1:0:0:0: [sda] tag#19 CDB: Write(16) 8a 00 00 00 00 00 56 23 55 40 00 00 0a 80 00 00[ 1952.484132] blk_update_request: I/O error, dev sda, sector 1445156160[ 1952.484479] sd 1:0:0:0: [sda] tag#20 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 1952.484484] sd 1:0:0:0: [sda] tag#20 CDB: Write(16) 8a 00 00 00 00 00 56 23 5f c0 00 00 05 40 00 00[ 1952.484486] blk_update_request: I/O error, dev sda, sector 1445158848[ 1952.484679] sd 1:0:0:0: [sda] tag#21 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 1952.484683] sd 1:0:0:0: [sda] tag#21 CDB: Write(16) 8a 00 00 00 00 00 56 23 65 00 00 00 0a 80 00 00[ 1952.484686] blk_update_request: I/O error, dev sda, sector 1445160192[ 1952.485039] sd 1:0:0:0: [sda] tag#22 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 1952.485043] sd 1:0:0:0: [sda] tag#22 CDB: Write(16) 8a 00 00 00 00 00 56 23 6f 80 00 00 0f c0 00 00[ 1952.485046] blk_update_request: I/O error, dev sda, sector 1445162880[ 1952.504835] Buffer I/O error on dev dm-3, logical block 1845493761, lost async page write[ 1952.504846] Buffer I/O error on dev dm-3, logical block 1845559025, lost async page write[ 1952.504854] Buffer I/O error on dev dm-3, logical block 180355075, lost async page write[ 1952.504859] Buffer I/O error on dev dm-3, logical block 180355076, lost async page write[ 1952.504863] Aborting journal on device dm-3-8.[ 1952.504865] Buffer I/O error on dev dm-3, logical block 180355077, lost async page write[ 1952.504869] Buffer I/O error on dev dm-3, logical block 180355078, lost async page write[ 1952.504973] Buffer I/O error on dev dm-3, logical block 976781312, lost sync page write[ 1952.505004] JBD2: Error -5 detected when updating journal superblock for dm-3-8.[ 1952.505634] EXT4-fs error (device dm-3) in ext4_reserve_inode_write:4837: Journal has aborted[ 1952.506684] Buffer I/O error on dev dm-3, logical block 0, lost sync page write[ 1952.506952] EXT4-fs error (device dm-3): mpage_map_and_submit_extent:2128: comm kworker/u8:0: Failed to mark inode 230687853 dirty[ 1952.506957] EXT4-fs (dm-3): previous I/O error to superblock detected[ 1952.507076] Buffer I/O error on dev dm-3, logical block 0, lost sync page write[ 1952.507097] EXT4-fs error (device dm-3) in ext4_writepages:2419: Journal has aborted[ 1952.507100] EXT4-fs (dm-3): previous I/O error to superblock detected[ 1952.507164] Buffer I/O error on dev dm-3, logical block 0, lost sync page write[ 1952.507319] EXT4-fs (dm-3): previous I/O error to superblock detected[ 1952.507408] EXT4-fs error (device dm-3): ext4_journal_check_start:56: Detected aborted journal[ 1952.507414] EXT4-fs (dm-3): Remounting filesystem read-only[ 1952.507417] EXT4-fs (dm-3): previous I/O error to superblock detected[ 1952.507507] EXT4-fs (dm-3): ext4_writepages: jbd2_start: 1024 pages, ino 230687854; err -30Thank you!Update: error also occurs when increasing timeout in /sys/block/sda/device/timeout to 120 (seconds). Will try 240s next. (But is this a solution?)Increasing the timeout to 240s brings the following error after about 15min of disk write activity:[ 1080.132256] INFO: task jbd2/dm-3-8:2557 blocked for more than 120 seconds.[ 1080.132265] Tainted: G OE 4.0.0-rc7+ #7[ 1080.132268] "echo 0 > /proc/sys/kernel/hung_task_timeout_secs" disables this message.[ 1080.132271] jbd2/dm-3-8 D ffff880213f43a98 0 2557 2 0x00000000[ 1080.132280] ffff880213f43a98 ffffffff81c164e0 ffff880210d3a800 0000000000000000[ 1080.132287] ffff880213f43fd8 0000000000000000 7fffffffffffffff 0000000000000002[ 1080.132292] ffffffff817b57a0 ffff880213f43ab8 ffffffff817b4f77 ffff880213f43ac8and[ 1175.528192] ata2.00: exception Emask 0x0 SAct 0x7ffeffff SErr 0x0 action 0x6 frozen[ 1175.528198] ata2.00: failed command: WRITE FPDMA QUEUED[ 1175.528202] ata2.00: cmd 61/c0:00:c0:34:cf/0f:00:74:00:00/40 tag 0 ncq 2064384 out[ 1175.528202] res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)repeated with "tag 1" .. "tag 31" [ 1175.528383] ata2: hard resetting link[ 1175.964132] ata2: SATA link up 6.0 Gbps (SStatus 133 SControl 300)[ 1176.748041] ata2.00: configured for UDMA/133[ 1176.748138] ata2.00: device reported invalid CHS sector 0[ 1176.748142] ata2.00: device reported invalid CHS sector 0When write activity pauses, the disk LED is constantly lit and the disk sounds as if it were "doing something", so the pauses are apparently OK. But Linux doesn't think so and eventually times out.According to this article, the disk seems to work as designed - and the OS should be able to cope with long(er) timeouts because the disk needs time to perform an internal garbage collection after large writes, similar to TRIM on SSDs. However, in their tests the write performance was bad but writes never completely stopped so there were no timeouts (as far as I can see) like in my case.I need to decide within the next week whether I keep this disk or exchange it for a smaller non-shingled disk at a slightly higher price (e.g. WD Green 6TB): is this a pure Linux issue, should I keep the disk and wait for Linux to support it, or are chances that I got another bad disk and I should give up on Seagate (again)?Please reply.Thank you!See also.I have the same failure with the same drive and newer kernels. But kernel 3.16.0-4-amd (Debian build) and 3.18.10 had uptimes of 19 and 26 days respectly. I have tried all new kernels since, but they crash my system (including 4.0.1).I'm experiencing similar problems with three different Seagate Archive 8TB drives. I used 3.18 patched with multipath-tcp to fill the drives with existing data and switched to 4.0.7 afterwards to make use of overlayfs merged in 3.19. After this change, I was unable to successfully write larger amounts of data (>10GiB) to the disk without having severe problems like others mentioned before.I support the idea that the drive is doing some kind of internal garbage collection between writes and seems unaccessible during that time. This can even be observed by running the drives with 4.0 until the error occurs and then rebooting to 3.18. The drive will still be unaccessible after rebooting and spit out ATA errors. Even my UEFI doesn't show the drive identifier at that point. After powering down the system for a few seconds, the drive seems to continue to work just fine.Thanks for filing this bug, I was unable to connect the dots myself and would have never guessed that this is actually caused by the kernel. I started to replace hardware and was going crazy about this problem.I'm recreating my SnapRAID parity drive at the moment and the parity drive has written over 2TiB without a single error in dmesg on 3.18.6.I also raised this issue with someone at Seagate, I hope they're interested in this too.Thank you!Just to echo a "me too".I've had the same expierence on 4.0.7 and 4.0.6.3.14 works without issue.I have some more notes here.Just another data point: I have exactly the same issue as OP with 4.0.4 and 4.0.8 kernels. As many ppl are reporting: 3.14/3.16/3.18=OK; 3.19/4.x=NOK I definitely think this is kernel regression in kernel support(tollerance) for SMR DM drives.Following patch (0006-revert-Implement-ATA_DEV_ZAC.patch) on 4.0.8 allows me to successful write 7T of test data without any SATA error. Without patch drive interface goes down after 50-150G of writes.Patch effectively reverts:From 9162c6579bf90b3f5ddb7e3a6c6fa946c1b4cbeb Mon Sep 17 00:00:00 2001From: Hannes Reinecke <>Date: Wed, 5 Nov 2014 13:08:21 +0100Subject: libata: Implement ATA_DEV_ZAC andFrom f9ca5ab832e7ac5bc2b6fe0e82ad46d536f436f9 Mon Sep 17 00:00:00 2001From: Hannes Reinecke <>Date: Wed, 5 Nov 2014 13:08:22 +0100Subject: libata-scsi: Update SATL for ZAC drivesI don't have time to go deeper but looking on code I think issue might be around line 1965 in libata-scsi.cworking:<------>const u8 versions[] = {<------><------>0x60,<->/* SAM-3 (no version claimed) */<------><------>0x03,<------><------>0x20,<->/* SBC-2 (no version claimed) */<------><------>0x02,<------><------>0x60<-->/* SPC-3 (no version claimed) */<------>};non-working:<------>const u8 versions[] = {<------><------>0x00,<------><------>0x60,<->/* SAM-3 (no version claimed) */<------><------>0x03,<------><------>0x20,<->/* SBC-2 (no version claimed) */<------><------>0x02,<------><------>0x60<-->/* SPC-3 (no version claimed) */<------>};CreatedWorkaround patch for kernel 4.0+Hi,Thanks for finding this solution. I have two questions:1. I guess this patch is not the final solution, because it is removing previously added functionality that, to my understanding, was supposed to help for handling SMR drives. Wouldn't this be needed sooner or later? Is this issue further investigated?2. I have checked all releases up to kernel v4.2 rc7. The problematic code is still in everywhere after v3.18. Does anybody have information when this issue would be fixed for good in the mainline Kernel?Best regards, JörgGot this problem with 2 different Samsung 8Tb SMR drives. The issue is very annoying. Any chance to see it fixed?CreatedBisect to locate error for Seagate ST8000AS0002 archive drivedescription: Motherboardproduct: M4A88TD-M EVOModel Family: Seagate Archive HDDDevice Model: ST8000AS0002-1NA17ZFirmware Version: AR13Bisect log attached.The last working (good) version I'm sure has the commits that have previously been recommended to be reverted.With some failures, drive is accessible and responds to smartctl other times it's not. Upon failure the machine must be switched off to get access to the drive. Even then the drive can sometimes report a smart error in bios. It will then restore itself.Using the patch atgit checkout v3.19 git apply <patch>compiled but didn't fix the problem.git checkout v3.19 git revert f9ca5ab832e7ac5bc2b6fe0e82ad46d536f436f9 9162c6579bf90b3f5ddb7e3a6c6fa946c1b4cbebcompiled but didn't fix the problem.The smart end-to-end error attribute has started to climb on the drive so will switch back to 3.18 to eliminate hardware error.sweeneygj@, if you have a chance, could you please bisect this issue between v3.18 and v3.19 tags?(In reply to Arzeets from)Thought I did that:(In reply to sweeneygj from)Successfully wrote 600GB with 3.18.21. Drive appears OK.Sorry, missed your previous comment. The commit you mentioned has been reverted in 4.3 treeDid you check if reverting this commit at recent kernels (e.g. v4.2) fixes the problem?git checkout v4.2git revert 34b48db66e08ca1c1bc07cf305d672ac940268dcuname -r4.2.0-gjs-archive--00001-g6a62234-dirtyAfter ~3G of writing 'WRITE FPDMA QUEUED' errors and 'device reported invalid CHS sector 0' reported in log.This is just a ddrescue of a drive. In either case (fail/ok) the drive pauses after the first ~3G of data is written. Drive responds to smartctl.(In reply to sweeneygj from)Whereas ...git checkout v3.19git revert 34b48db66e08ca1c1bc07cf305d672ac940268dcuname -r3.19.0-gjs-archive--00001-g25ec59cWrote 100GB OK without problems.It sounds like there is a regression in v3.19..v4.2 and another bisect is needed.CreatedBisect 4.1 to 4.2 to locate 2nd Seagate SMR bug#For each bisect testgit revert --no-commit 34b48db66e08#run testgit reset --hard(In reply to Arzeets from)git checkout v4.2git revert --no-commit 34b48db66e08 4f258a46346c1.2TB of data wrote without error.thinks 4f258a46346c may be cause of an error too.Both v4.3-rc1 and v4.3-rc2 require git revert --no-commit 4f258a46346cfor ST8000AS0002 to work without error.Margin, the offending commit is commit 4f258a46346c03fa0bbb6199ffaf4e1f9f599660 Author: Martin K. Petersen <> Date: Tue Jun 23 12:13:59 2015 -0400 sd: Fix maximum I/O size for BLOCK_PC requestsAny ideas?Hmm, it looks like my hypothesis inwas wrong. With 2 commits mentioned inI still have problem - but very rare. However patch fromgives me stable operation (I/m not able to trigger NCQ issue with any tests like 15T of constantly writing data or heavy random r/w operations). Can somebody do test withpatch?(In reply to warpme from)SeeRight. Today (after 2 weeks of no-problems) I received series of IO_errors leading to XFS shutdown. It looks like withpatch, bug is still present - only different load is needed to trigger it. Today I'll build 4.1.9 with reverted 4f258a46346c03fa0bbb6199ffaf4e1f9f599660 and do some tests.(In reply to warpme from)Seeand.34b48db66e08 is reverted in 4.3Revert 34b48db66e08 in 4.1.x to test 4f258a46346c. For my ddrescue task, at some point between 3GB and 15GB the error would occur and the drive would be inaccessible.Can you also check smart data before and after - does the end-to-end value change?FYI: after reverting 34b48db66e08 and 4f258a46346c on 4.1.8 I successfully passed 134 iterations of test. Vanilla kernel kills drive after 3-5 tests...(In reply to warpme from)Can you test 4.3-rc2 with and without reverting 4f258a46346c?oh, I have set of device drivers specific patches + some additional kernel modules. All this needs to be ported to new kernel ver. All this is on running 24/7 home server serving TV/media/surveillance/Internet on whole home. I will try but might be not easy...(In reply to warpme from)Easier to just try 4.1.8 with only 34b48db66e08 reverted.Sorry about the delay. Just got back from vacation.I'm a bit confused as to why 4f258a46346c would be the culprit as it should only affect sizing of BLOCK_PC requests which none of these are presumably are (I see WRITE FPDMA QUEUED in the log above which would be a REQ_TYPE_FS).The only way my patch would change the behavior for FS requests would be if somehow the ata host did not set max_hw_sectors and is using the new, larger default introduced by Christoph's patch. But I don't see anything obvious in libata that would suggest max_hw_sectors is not getting set.Anyway. I'll look at it in detail tomorrow.Worth noting, I tried these drives with NCQ disabled, and they still behaved the same way. I can't test anymore as I'm using the drive. I'm running with an old kernel for now (3.14)What about kernel 3.19? Is there anything I can do to fix/workaround this issue? I have installed Ubuntu server 15.04 on x86-64 platform.Any news?Hi Futuref,I am also running Ubuntu and have the same problems. There are also older Kernels for Ubuntu 15.04 (Vivid). See:I did downgrade Ubuntu 15.04 to 3.18.x kernels and that works well for me. The problem seems to start with the 3.19 Kernels and I do not have any problems with the Seagate Archive drives and the 3.18 Kernel. I also did not find a good work-around for the 3.19 and newer kernels.For the time being this works well for me and I plan to stay at this kernel version until the problem is solved and the solution made it into the Ubuntu mainline kernel.Hello joergn,I was excatly looking for such concrete instructions :)Doing the downgrade to 3.18.x made it work again.The drive just goes and goes...Thank you so much!Here's another data point. I'd been experiencing the same issues (albeit with BTRFS). Now running kernel 4.3rc5-1 and all is well again. Discussion is here:(In reply to Warren Hughes from)According to that thread, you started with 4.1.10 and moved to 4.3-rc4. 34b48db66e08 is reverted in 4.3 which was the original issue.Now 4f258a46346c is suspect in 4.3.Not a BTRFS user but its wiki states data chunks are 1GiB, presumably that is what the balance is 'moving'.The ddrescue task,, throws errors anywhere between 3GB and 15GB on ext4 on LUKS.Can you run ddrescue writing >15GB without error using 4.3rc5-1?(In reply to sweeneygj from)I'd love to but both my SMR drives are part of my BTRFS pool so I can't direct a write to a single drive :-(If you have BTRFS then 'balance' operation is an easy way to trigger this error. With 4.1 kernel 'btrfs balance' fails after 10 minutes for me. Haven't tried recent kernel.(In reply to Arzeets from)OK great, will be starting a balance today - will report backUnfortunately, I also see these errors with 3.18.22 (-31822-lowlatency) on Ubuntu 15.04 with a Seagate 8 TB drive. I will try if 3.18.21 works as others said this version was working for them.Hi Mario and others,I am on Ubuntu 15.04 and Kernel 3.18.22 since ubuntu made that version available on their server. I have 3 of the 8TB drives and they were stable with all the 3.18 Kernels I tried. I must however say that I did not do a serious stress test but use them by pushing larger media files to the drives. Maybe I am just lucky. Any later Kernel I tried did cause massive problems with my usage profile.What did you do in order to see the error?Has anybody tried Ubuntu 15.10 with its 4.2 Kernel yet? I am a little bit hesitant to upgrade because of the potential problems.I'm not 100% sure it is the same fault but my headless machine died again today with 3.18.21-generic while doing a BTRFS send/receive to the 8 TB drive. After a reboot, df says it stopped at 275 GB of ~5TB total amount of data to be transferred. The machine had no other duties. Before the send/receive, a ~14h long SMART self-test completed and it has found no errors.A related response from a Seagate engineer... in April :(I will try if it works if I suspend the send/receive from time to time so the drive can flush its buffers.Why not getting in contact with Seagate directly? Are there any devs who could talk to Seagate kernel spezialists?I have written an email to, but did not get a response yet.I guess it would help to build up a sustainable solution.Createddmesg of the session where I'm experiencing problems on 3.14, ncq disabledI just replaced one of my 8TB Archive HDDs because it was faulty, the drive wouldn't even start properly in the end. I assume this was unrelated to the problem here.Now that I've gotten the replacement, I've added partitions, encrypted the partition with dm-crypt and created an ext4 filesystem on top of that.Then I started recovering my data via SnapRaid, after around 200GiB the sata errors started to come back up. I attached the complete dmesg for reference.I'm using kernel 3.14.51 with NCQ disabled.I've talked to Adrian Palmer in the past, I also tried to make him aware of the problems we're having here. I really hope I can get this drive to work sometime soon without having to constantly worry about problems...(In reply to Johannes from)No "device reported invalid CHS sector 0" which I and the OP get.Is the drive responding to smartctl?(In reply to sweeneygj from)Yes, although slower than usual, the drive was responding to smartctl -a.The errors you're seeing where also coming up continously even after I unmounted and luksClosed the device. I eventually shut the machine down.(In reply to Johannes from)Does it report any reallocated sectors, pending or uncorrectable sectors?For 3.14.51, I would shred -v -n 1 /dev/NEW_DRIVEand see if that completes.(In reply to Johannes from)Same usage pattern here, different kernel: 4.3-rc6 built using.CreatedLogs of the session a day afterI just started the machine again and tried to continue my SnapRAID restore procedure. I attached the dmesg of that session, after very few MiB written and read, the drive started to throw errors again. You can seen this in the upper area of the attached log.After rebooting the machine (what else can I do at this point), the drive started spitting these even before I unlocked my root volume. You will find this in the lower area of the file.[ 6.270466] ata2: link is slow to respond, please be patient (ready=0)[ 10.887959] ata2: COMRESET failed (errno=-16)[ 16.275040] ata2: link is slow to respond, please be patient (ready=0)[ 20.892532] ata2: COMRESET failed (errno=-16)[ 26.279609] ata2: link is slow to respond, please be patient (ready=0)[ 55.903535] ata2: COMRESET failed (errno=-16)[ 55.904200] ata2: limiting SATA link speed to 3.0 Gbps[ 60.930808] ata2: COMRESET failed (errno=-16)[ 60.931481] ata2: reset failed, giving upAt this point, I'm pretty much lost on what to do with these drives. I will check whether writing data to the disk (e.g. via shred) is at all possible.(In reply to Johannes from)[From dmesg][ 797.639563] cdb[0]=0x88: 88 00 00 00 00 00 06 ab 56 00 00 00 02 00 00 00[ 797.639574] end_request: I/O error, dev sdb, sector 111891968[ 797.639620] sd 1:0:0:0: [sdb] Unhandled error code[ 797.639622] sd 1:0:0:0: [sdb] [ 797.639624] Result: hostbyte=0x04 driverbyte=0x00[ 797.639626] sd 1:0:0:0: [sdb] CDB: [ 797.639627] cdb[0]=0x8a: 8a 00 00 00 00 00 99 c0 41 50 00 00 00 10 00 00[ 797.639636] end_request: I/O error, dev sdb, sector 2579513680I would scan the drive for errors first.(In reply to Johannes from)I've seen that behavior too on the drives—or where they don't even show up at all. You need to do a full power cycle to bring them back. A reset/reboot is not sufficient.[Honestly, this strikes me as a drive firmware bug.]Createddmesg and smartctl after letting the drive 'settle'(In reply to Anthony DeRobertis from)Yes, this is what I noticed too.Yesterday, the drive went even further. After doing full power cycle, the drive didn't come back up (COMRESET failed before opening my encrypted /, not showing up in lsblk). Even I physically moved it into another machine, the drive didn't show up in Linux and even Windows 7. However, I noticed a periodic, even rhythmic noise from the device so I guessed it was 'doing' something, so I let it sit for at least 20min, then the noise had stopped.I rebooted the machine and the drive was visible in both Linux and Windows. I then moved the drive back to the original machine where I started the SnapRAID restoration procedure. Because I restored around 370G so far, SnapRAID verified this first so it read around 370G, which worked flawlessly until around 360G, then I got input/output errors and SnapRAID stopped. The attachment contains a log of this session plus a smartctl -a.I'm now running a full test with 'SeaTools' (on Windows, the FreeDOS based ones are plain buggy), I _think_ this drive is faulty. Sorry for the noise here, I hope this can be figured out....(In reply to Johannes from)Two AR13 and one AR15 firmware versions, the latter is now suspect. Are the AR13 file sizes significantly less than a snapraid parity file?Written with 3.14.51 too?Just to add another three datapoints, running btrfs on two AR15 drives:4.3-rc7 with reverted 4f258a46346c --> reliably gets ata errors during btrfs-scrub / when writing large amounts of data.4.3-rc7 with reverted 9162c6579bf9 f9ca5ab832e7 --> initial btrfs-scrub passed, very sporadic errors later on, but can kill your raid anyway.4.3-rc7 with reverted 9162c6579bf9 f9ca5ab832e7 4f258a46346c --> no ata errors after some days of activity... yet.(In reply to Georg Lukas from)raid ..... with archive drives?Regarding f9ca5ab832e7, see.Can you test the following?git checkout v4.3-rc7git revert 4f258a46346cgit apply <patch linked to in>It would be better to test on a single drive: can you safely btrfs delete device?(In reply to sweeneygj from)So far all the information I could find regarding that combination was that it is not advised by Seagate, due to the SMR performance characteristics. By using BTRFS, which only writes actual data during rebuilds, I hoped to mitigate that "problem".Has been running for over a week now with different I/O patterns and without problems.Unfortunately no. I'm currently running a degraded RAID1 with one disk only, which hopefully amounts to something like a single individual disk ;)Figured out what's going on. Patch coming...Please try this:Georg Lukas, I compiled 4.3 with reverted 3 patches you mentioned (9162c6579bf9 f9ca5ab832e7 4f258a46346c) and ran 'btrfs balance' on my machine. With stock 4.3 kernel the balance crashes few minutes after start. With reverted 3 patches it was running ~30 hours without any error, then I got this one:kernel: ------------[ cut here ]------------kernel: WARNING: CPU: 0 PID: 12039 at fs/btrfs/extent-tree.c:2093 __btrfs_inc_extent_ref.isra.22+0x207/0x270 [btrfs]()kernel: BTRFS: Transaction aborted (error -17)kernel: Modules linked in: nct6775 hwmon_vid btrfs intel_rapl iosf_mbi xor x86_pkg_temp_thermal intel_powerclamp coretemp kvm_intel kvm crct10dif_pclmul crc3kernel: kernel: CPU: 0 PID: 12039 Comm: kworker/u4:4 Not tainted 4.3.0-1-ARCH #1kernel: Hardware name: To Be Filled By O.E.M. To Be Filled By O.E.M./H61M/U3S3, BIOS P2.20 07/30/2012kernel: Workqueue: btrfs-extent-refs btrfs_extent_refs_helper [btrfs]kernel: 0000000000000000 000000000ae6b08b ffff88010bfafae8 ffffffff812bbc59kernel: ffff88010bfafb30 ffff88010bfafb20 ffffffff81074f42 0000000000000000kernel: ffff88007abd9800 ffff880117a3e2d0 0000000000000005 00000000ffffffefkernel: Call Trace:kernel: [<ffffffff812bbc59>] dump_stack+0x4b/0x72kernel: [<ffffffff81074f42>] warn_slowpath_common+0x82/0xc0kernel: [<ffffffff81074fdc>] warn_slowpath_fmt+0x5c/0x80kernel: [<ffffffffa06ea437>] __btrfs_inc_extent_ref.isra.22+0x207/0x270 [btrfs]kernel: [<ffffffffa06efa12>] __btrfs_run_delayed_refs+0xca2/0x10d0 [btrfs]kernel: [<ffffffff810a4a9c>] ? __enqueue_entity+0x6c/0x70kernel: [<ffffffffa06f2bf2>] btrfs_run_delayed_refs+0x82/0x290 [btrfs]kernel: [<ffffffffa06f2e37>] delayed_ref_async_start+0x37/0x90 [btrfs]kernel: [<ffffffffa0739127>] btrfs_scrubparity_helper+0x77/0x2e0 [btrfs]kernel: [<ffffffffa07393ce>] btrfs_extent_refs_helper+0xe/0x10 [btrfs]kernel: [<ffffffff8108cfeb>] process_one_work+0x14b/0x440kernel: [<ffffffff8108d328>] worker_thread+0x48/0x4a0kernel: [<ffffffff81579940>] ? __schedule+0x340/0xa60kernel: [<ffffffff8108d2e0>] ? process_one_work+0x440/0x440kernel: [<ffffffff8108d2e0>] ? process_one_work+0x440/0x440kernel: [<ffffffff81092e68>] kthread+0xd8/0xf0kernel: [<ffffffff81092d90>] ? kthread_worker_fn+0x170/0x170kernel: [<ffffffff8157de9f>] ret_from_fork+0x3f/0x70kernel: [<ffffffff81092d90>] ? kthread_worker_fn+0x170/0x170kernel: ---[ end trace 47f32383c2e64422 ]---kernel: BTRFS: error (device sdd) in __btrfs_inc_extent_ref:2093: errno=-17 Object already existskernel: BTRFS info (device sdd): forced readonlykernel: BTRFS: error (device sdd) in btrfs_run_delayed_refs:2851: errno=-17 Object already existskernel: BTRFS: error (device sdd) in __btrfs_inc_extent_ref:2093: errno=-17 Object already existskernel: BTRFS: error (device sdd) in btrfs_run_delayed_refs:2851: errno=-17 Object already existsI do not know if it is specific to HDD with SMR or it just a btrfs bug. I remounted the partition and started balance again - this time it finished after about 10 more hours.Thus reverting those 3 commits definitely improves situation.Martin, thanks, I am going to try your patch in the next few days and then provide you my feedback.(In reply to Martin K. Petersen from)Works for me. Applied to 4.3 and 240GB transferred without error.hmm I also have some of these drives (ST8000AS0002-1NA17Z Firmware Version: AR13) and interestingly I've never had these problems...I always ran at Debian sid (which is right now kernel 4.2.6) but I guess I got one of the first drives that were sold in Germany (when did they come out?) so I must have started with an older version.Also, I use btrfs on those drives and once send/received one nearly full fs (6TB or so) in one bunch to another 8TB disk... and I noticed no single error[0]So either the difference is btrfs, or something in Debian... or perhaps that I'm always running these devices via a USB/SATA bridge (with USB3.0 though)... so perhaps I never ran into these issues because of the slowness of the bridge.HTH[0] Well I have other problems now, but I guess these are purely btrfs related:Hi, just wanted to chime in, in case this helps things further along.I'm experiencing the same problems as everyone else here.I'm running Debian Jessie (current stable), with a own compiled kernel 4.3.0 and using BTRFS as a filesystem.I have a server with 4 drive hotswappable drive bay.I bought a 8TB Seagate HD, stuck it in the bay, and proceeded to copy data to it. After about 40GB, the drive stopped responding and I noticed a lot of kernel errors. I figured the drive was faulty, so I ordered a replacement from amazon.So the replacement arrived. I figured, this time I'd test it out first before I integrate it into my storage array. I hooked up the drive to usb-sata adapter, formatted with btrfs and proceeded to rsync my data onto it.This ran the whole night and I managed to copy 670GB of data onto it. Via USB2.0 the data rate topped at about 20MB/s. I figured the drive is good, so I put into the drive bay of my server. Now directly attached via SATA.And lo and behold, dmesg errors again. Just like everyone else has been reporting.I'm not sure if it's simply the lower transfer speed, or the things are differently managed via a USB interface.By the way, when the drive was attached via USB, I had it connected to a different computer running Debian Jessie with the 4.2.0 kernel.I've now downgraded my server to kernel 3.16 to see if the errors still persist.Just a Comment from my side. This is definitely not just BTRFS related as I am having the same issues using EXT4 on 4.1 kernel (Ubuntu)...I'd say the circumstances that provoke this issue are clear now. We should all test the patch of Martin innow with kernel 4.3 in order to get this patch into the next kernel version asap. I'll start a send/receive of ~6TB during the weekend.Martin,It is possible to prepare patchfor 4.1 mainline?I have 24/7 server running 4.1.8 with Seagate 8T SMR and all problems listed in this bugreport. I can easily test how Your fix is working in 4.1 kernel.(In reply to Robert Krig from)Just wanted to mention, rsync has been running for a few hours now. Copied a further 900GB of Data. No kernel error messages what so ever on the standard Debian Jessie kernel "3.16.0-4-amd64 #1 SMP Debian 3.16.7-ckt11-1+deb8u5"Martin K. Petersen, I was running Arch with 4.3 kernel + your patch and it makes the error go away.I was running 'btrfs balance' for more than 24 hours now with spikes of additional read/write traffic. Arch 4.3 kernel with your patch handles it. No any kernel messages/errors. Everything looks good now.Thanks Martin for the patch. When it is accepted upstream please 'CC' stable kernel also. It would be great to see it in 4.3 as well.Hello together, as this ticket was created on the branch 4.19.x, I was wondering if this branch might get patched too, Ubuntu is running on it...Ubuntu 15.10 (Wily)v4.3-0-g6a13feb with 7c4fbd5 fromUbuntu scripts fromModel Number: ST8000AS0002-1NA17ZFirmware Revision: AR13I'm filling a new btrfs with ~6T. This seems to be working. I'm only on 160G, but it failed long before this with the the generic amd64 Ubuntu 14.04.3 LTS and 15.10 kernels. I will report if "WRITE FPDMA QUEUED" returns.Thank you very much, Martin K. Petersen!Is there anywhere else I should post in support of the patch?It looked like a very small conflict to apply it to Ubuntu-4.2.0-19.23-0-g22ed8ce, but for me it was easier to just build v4.3.(In reply to Martin K. Petersen from)Thanks Martin for supplying the patch, I applied it to kernel 4.3.0 and booted a J1900N-D3V board with the ST8000AS0002-1NA17Z FW AR13 with it, SATA2 3Gbps.Created a 2.3T partition (after a first 5T one), btrfs single d/m/s profile and started filling it by rsyncing data over Gbit LAN. 1.5TB transferred with roughly 50MB/s transferspeed total average, no ATA errors in dmesg. Then I put the drive in an H87M-PRO board, SATA3 6Gbps. Same transfertest, also no ATA errors in dmesg. The 5T partition is bcache + dm-crypt + btrfs(compress-force=zlib,nossd) that I have filled with kernel 3.18.22 on an AMD E-350 board, also without ATA errors in dmesg (total average roughly 10MB/s).Then doing 3x parallel dd_rescue /dev/sdX file (3 independent SATA devices, files on 5T) resulted in ATA errors soon after transfers started. After about 150GB in total, the 5T fs went ro and kernel BUG in btrfs/extent-tree.c due to the I/O errors I assume.My machine successfully transferred a 5 TB btrfs subvolume with kernel 4.3 and Martin's patch. I will compare the data now but everything looks good so far. Thank you Martin!Hi, will this bug ever officially been fixed? How can i fix this bug without changing the kernel, now i cant use my virtualbox, because of an missing 'modprobe vboxdrv' .. Without the fix my hdd is clicking all the time and is slow and same times unaccessible. With w7 it worked fine.How can i add the fix to the existing kernel?Hi, kernel 4.4 was just released. I checked the changelogs but I didn't see any mention of this bugfix. Does anyone know if the patch that fixes this bug has already been implemented in upstream kernel 4.4 release?Good news, Martin's patch was accepted:Your commit has been added to the upstream scsi tree On branch "fixes"This patch is scheduled to be pushed for 4.4Great news!!! And this patch should be absolutely backported to stable kernel as well.This patch is part of upstream kernel now. Its upstream sha is ca369d51b3e1649be4a72addd6d6a168cfb3f537Thanks for your work Martin. Could you please send it to stable maillist please? The change should be really backported to previous kernel versions.I am running a btrfs balance on 4.4rc4 (which has the patch) and can confirm it seems to be working. No errors so far, and the balance is almost done.I have upgraded the kernel from 4.3.0+patch to 4.4.0-rc4. /sys/block/sdb/device/queue_depth is 31, 3Gbps SATA (chipset limit), the disk is an iSCSI target and roughly 400G extra has been written/pushed to it so far. No errors, all runs fine.I compiled 4.4.0-rc5 and gave it a try. I am not facing any ATA errors like before but now drive is sooo slow (and also quite warm). For writing data (I do copy with Midnight Commander) it shows almost 1MB/s. I don't know are my problems now related to luks or something else. I am running ext4 inside luks container.I get many following sets.[ 2280.116086] INFO: task kworker/u8:0:2535 blocked for more than 120 seconds.[ 2280.116092] Tainted: P O 4.4.0-rc5 #1[ 2280.116094] "echo 0 > /proc/sys/kernel/hung_task_timeout_secs" disables this message.[ 2280.116096] kworker/u8:0 D 0000000000000001 0 2535 2 0x00000000[ 2280.116106] Workqueue: writeback wb_workfn (flush-251:1)[ 2280.116110] ffff8800994786c0 ffff8801c8284e40 ffff8801c5efc000 ffff8801c5efb670[ 2280.116114] 7fffffffffffffff ffff8801cffda1d0 ffff8801c5efb708 ffffffff81559830[ 2280.116118] ffffffff81559121 0000000000000000 ffffffff8155bb49 7fffffffffffffff[ 2280.116122] Call Trace:[ 2280.116129] [<ffffffff81559830>] ? bit_wait+0x60/0x60[ 2280.116133] [<ffffffff81559121>] ? schedule+0x31/0x80[ 2280.116136] [<ffffffff8155bb49>] ? schedule_timeout+0x189/0x250[ 2280.116140] [<ffffffff81559830>] ? bit_wait+0x60/0x60[ 2280.116144] [<ffffffff8155879d>] ? io_schedule_timeout+0x9d/0x100[ 2280.116148] [<ffffffff810aa495>] ? prepare_to_wait_exclusive+0x55/0x80[ 2280.116151] [<ffffffff81559847>] ? bit_wait_io+0x17/0x60[ 2280.116155] [<ffffffff81559627>] ? __wait_on_bit_lock+0x47/0xa0[ 2280.116158] [<ffffffff81559830>] ? bit_wait+0x60/0x60[ 2280.116161] [<ffffffff815596ee>] ? out_of_line_wait_on_bit_lock+0x6e/0x80[ 2280.116165] [<ffffffff810aa870>] ? autoremove_wake_function+0x40/0x40[ 2280.116174] [<ffffffffa02229cb>] ? do_get_write_access+0x1fb/0x450 [jbd2][ 2280.116178] [<ffffffff811f4168>] ? __find_get_block+0xe8/0xf0[ 2280.116182] [<ffffffff811f4446>] ? __getblk_gfp+0x26/0x50[ 2280.116187] [<ffffffffa0222c6a>] ? jbd2_journal_get_write_access+0x4a/0x60 [jbd2][ 2280.116210] [<ffffffffa0274d86>] ? __ext4_journal_get_write_access+0x36/0x70 [ext4][ 2280.116222] [<ffffffffa0247a1e>] ? ext4_reserve_inode_write+0x6e/0x90 [ext4][ 2280.116238] [<ffffffffa026eb15>] ? ext4_ext_insert_extent+0x6e5/0x1300 [ext4][ 2280.116250] [<ffffffffa0247a7f>] ? ext4_mark_inode_dirty+0x3f/0x1c0 [ext4][ 2280.116273] [<ffffffffa026eb15>] ? ext4_ext_insert_extent+0x6e5/0x1300 [ext4][ 2280.116285] [<ffffffffa027cad9>] ? ext4_mb_new_blocks+0x139/0x4a0 [ext4][ 2280.116296] [<ffffffffa027216e>] ? ext4_ext_map_blocks+0x3de/0xd00 [ext4][ 2280.116299] [<ffffffff81155e0c>] ? find_get_pages_tag+0x10c/0x160[ 2280.116308] [<ffffffffa02450d5>] ? ext4_map_blocks+0x165/0x490 [ext4][ 2280.116316] [<ffffffffa0248167>] ? ext4_writepages+0x567/0xcc0 [ext4][ 2280.116319] [<ffffffff811ec52d>] ? __writeback_single_inode+0x3d/0x290[ 2280.116321] [<ffffffff811ecbfe>] ? writeback_sb_inodes+0x1de/0x3e0[ 2280.116323] [<ffffffff811ece81>] ? __writeback_inodes_wb+0x81/0xb0[ 2280.116325] [<ffffffff811ed13f>] ? wb_writeback+0x1ef/0x280[ 2280.116327] [<ffffffff811ed846>] ? wb_workfn+0x1e6/0x340[ 2280.116330] [<ffffffff8108554f>] ? process_one_work+0x19f/0x3d0[ 2280.116332] [<ffffffff810857cd>] ? worker_thread+0x4d/0x450[ 2280.116335] [<ffffffff81085780>] ? process_one_work+0x3d0/0x3d0[ 2280.116337] [<ffffffff8108b29d>] ? kthread+0xbd/0xe0[ 2280.116339] [<ffffffff8108b1e0>] ? kthread_create_on_node+0x170/0x170[ 2280.116342] [<ffffffff8155cd8f>] ? ret_from_fork+0x3f/0x70[ 2280.116344] [<ffffffff8108b1e0>] ? kthread_create_on_node+0x170/0x170After many of these I get [ 3445.343562] perf interrupt took too long (2508 > 2500), lowering kernel.perf_event_max_sample_rate to 50000Then errors are gone, but bad performance stays.Is that drive almost full?SMR drives will slow down a lot when they start to fill.No, I have managed to copy less than 1gb. It's sooo slow.I dont think SMR disk speed would ever reduce to these speeds.(In reply to shan from)btrfs rebalance was doing ~55MB/sec for a few days straight to ours. That was with -rc4, and about 70% full. The "blocked for more than 120 seconds" messages are I suspect just telling you what you already know—it's going slow.Suggest checking smartctl, iostat, etc.I did many tests, removed luks, tried with plain ext4, attached straight to sata (I used it from the usb docking station). Funny thing was that from usb docking station it copied 800Mb fast (at least Midnight commander showed show), before it froze. Attached to sata it copied 1600Mb fast before frozage.Then I started to play with partition table and noticed that parted and fdisk made partitions which always gave warning about alignment? "Warning: The resulting partition is not properly aligned for best performance.".Then I created partition with gparted and now parted showed:(parted) align-check opt 1 1 alignedAnd voila now I have managed to achieve those ~55MB/sec speeds.Hmm sounds quite worrying... while it's understandable that you may suffer from some performance penalty when you fs (or any other block layer) isn't aligned, one shouldn't suffer from freeze... :(May indicate that the fix isn't complete yet.I have now copied 6TB of data and everything seems to work.But, I have got two of those "Blocked for more than 120" messages and I thought that disk will freeze again, but with both cases it continued with good speed. This happened when I had copied around 70GB.There was something about ext4 lazy init, If I remember correctly (I lost logs), also there were some messages related the source I copied data from (seeks errors with USB drive). It could be that errors with source made these "blocked" messages.Found the logs for those two "blocked for more than 120". I think these are not related to the source, the source errors happened later.Dec 25 09:17:22 i7 kernel: [ 1560.020132] INFO: task ext4lazyinit:2009 blocked for more than 120 seconds.Dec 25 09:17:22 i7 kernel: [ 1560.020141] Not tainted 4.4.0-rc6-amd64 #1Dec 25 09:17:22 i7 kernel: [ 1560.020144] "echo 0 > /proc/sys/kernel/hung_task_timeout_secs" disables this message.Dec 25 09:17:22 i7 kernel: [ 1560.020148] ext4lazyinit D ffff88042fa95940 0 2009 2 0x00000000Dec 25 09:17:22 i7 kernel: [ 1560.020157] ffff8803f86ecf40 ffff88041d6b2180 ffff8803d8c10000 ffff8803d8c0fcf8Dec 25 09:17:22 i7 kernel: [ 1560.020163] 7fffffffffffffff ffff8803f86ecf40 0000000000001000 000077ff80000000Dec 25 09:17:22 i7 kernel: [ 1560.020168] ffffffff81586291 0000000000000000 ffffffff81589069 7fffffffffffffffDec 25 09:17:22 i7 kernel: [ 1560.020174] Call Trace:Dec 25 09:17:22 i7 kernel: [ 1560.020186] [<ffffffff81586291>] ? schedule+0x31/0x80Dec 25 09:17:22 i7 kernel: [ 1560.020193] [<ffffffff81589069>] ? schedule_timeout+0x189/0x250Dec 25 09:17:22 i7 kernel: [ 1560.020209] [<ffffffffa06dfd4c>] ? dm_make_request+0x6c/0xc0 [dm_mod]Dec 25 09:17:22 i7 kernel: [ 1560.020214] [<ffffffff8158590d>] ? io_schedule_timeout+0x9d/0x100Dec 25 09:17:22 i7 kernel: [ 1560.020219] [<ffffffff81587651>] ? wait_for_completion_io+0xf1/0x130Dec 25 09:17:22 i7 kernel: [ 1560.020229] [<ffffffff8109c470>] ? wake_up_q+0x60/0x60Dec 25 09:17:22 i7 kernel: [ 1560.020237] [<ffffffff812bfa30>] ? blkdev_issue_zeroout+0x1f0/0x260Dec 25 09:17:22 i7 kernel: [ 1560.020260] [<ffffffffa022f6f2>] ? ext4_init_inode_table+0x182/0x370 [ext4]Dec 25 09:17:22 i7 kernel: [ 1560.020284] [<ffffffffa024b6a3>] ? ext4_lazyinit_thread+0x123/0x2b0 [ext4]Dec 25 09:17:22 i7 kernel: [ 1560.020305] [<ffffffffa024b580>] ? init_once+0x60/0x60 [ext4]Dec 25 09:17:22 i7 kernel: [ 1560.020313] [<ffffffff8109152d>] ? kthread+0xcd/0xf0Dec 25 09:17:22 i7 kernel: [ 1560.020319] [<ffffffff81091460>] ? kthread_create_on_node+0x190/0x190Dec 25 09:17:22 i7 kernel: [ 1560.020326] [<ffffffff8158a2cf>] ? ret_from_fork+0x3f/0x70Dec 25 09:17:22 i7 kernel: [ 1560.020332] [<ffffffff81091460>] ? kthread_create_on_node+0x190/0x190Dec 25 09:35:22 i7 kernel: [ 2639.936652] INFO: task ext4lazyinit:2009 blocked for more than 120 seconds.Dec 25 09:35:22 i7 kernel: [ 2639.936661] Not tainted 4.4.0-rc6-amd64 #1Dec 25 09:35:22 i7 kernel: [ 2639.936664] "echo 0 > /proc/sys/kernel/hung_task_timeout_secs" disables this message.Dec 25 09:35:22 i7 kernel: [ 2639.936667] ext4lazyinit D ffff88042fa95940 0 2009 2 0x00000000Dec 25 09:35:22 i7 kernel: [ 2639.936676] ffff8803f86ecf40 ffff88041d6b2180 ffff8803d8c10000 ffff8803d8c0fcf8Dec 25 09:35:22 i7 kernel: [ 2639.936682] 7fffffffffffffff ffff8803f86ecf40 0000000000001000 000077ff80000000Dec 25 09:35:22 i7 kernel: [ 2639.936687] ffffffff81586291 0000000000000000 ffffffff81589069 7fffffffffffffffDec 25 09:35:22 i7 kernel: [ 2639.936693] Call Trace:Dec 25 09:35:22 i7 kernel: [ 2639.936705] [<ffffffff81586291>] ? schedule+0x31/0x80Dec 25 09:35:22 i7 kernel: [ 2639.936712] [<ffffffff81589069>] ? schedule_timeout+0x189/0x250Dec 25 09:35:22 i7 kernel: [ 2639.936728] [<ffffffffa06dfd4c>] ? dm_make_request+0x6c/0xc0 [dm_mod]Dec 25 09:35:22 i7 kernel: [ 2639.936733] [<ffffffff8158590d>] ? io_schedule_timeout+0x9d/0x100Dec 25 09:35:22 i7 kernel: [ 2639.936739] [<ffffffff81587651>] ? wait_for_completion_io+0xf1/0x130Dec 25 09:35:22 i7 kernel: [ 2639.936748] [<ffffffff8109c470>] ? wake_up_q+0x60/0x60Dec 25 09:35:22 i7 kernel: [ 2639.936756] [<ffffffff812bfa30>] ? blkdev_issue_zeroout+0x1f0/0x260Dec 25 09:35:22 i7 kernel: [ 2639.936780] [<ffffffffa022f6f2>] ? ext4_init_inode_table+0x182/0x370 [ext4]Dec 25 09:35:22 i7 kernel: [ 2639.936803] [<ffffffffa024b6a3>] ? ext4_lazyinit_thread+0x123/0x2b0 [ext4]Dec 25 09:35:22 i7 kernel: [ 2639.936824] [<ffffffffa024b580>] ? init_once+0x60/0x60 [ext4]Dec 25 09:35:22 i7 kernel: [ 2639.936831] [<ffffffff8109152d>] ? kthread+0xcd/0xf0Dec 25 09:35:22 i7 kernel: [ 2639.936838] [<ffffffff81091460>] ? kthread_create_on_node+0x190/0x190Dec 25 09:35:22 i7 kernel: [ 2639.936844] [<ffffffff8158a2cf>] ? ret_from_fork+0x3f/0x70Dec 25 09:35:22 i7 kernel: [ 2639.936851] [<ffffffff81091460>] ? kthread_create_on_node+0x190/0x190Hmm what exactly did you mean with "freeze" in the first place?The system being unresponsive for a while, but then continuing without any errors except e.g. those 120s blocked messages?Cause that could be just "normal" (or a pointer that the IO scheduler could be improved ;)... but if "freeze" means the system crashed or became unresponsive forever, that would be a "real" bug.Those "blocked for more than 120" are probably no reason to worry much.Did you experience any other fs corruptions then?Before first bugfix, yes I lost everything (I am using luks). After fix I haven't faced any corruption (At least luks container is still intact).Hmm problem is that I dont know how Midnight Commander works, but that is my "frontend" where I see this frozage. Frontend shows me progress of copying process. It shows nice bar where first 800Mb goes really fast to the disk before it freezes, it is normal behaviour (at some point) because it waits for data to be really written to the disk (sync). During progress it calculates the average speed. After this 800Mb Midnight commander is unresponsive and average speed goes as low as some kilobits/s. I can try to stop copying process or shutdown the computer but it takes many minutes (Even tens of) until something is responded from midnight commander.So, continuing without errors... Yes but with that ~2KB/s speed. There seems to be 10 of those blocked for messages and after that no errors on logs, but this frozage continues until I managed to restart computer and stop that copying process. This was before I recreated partition table. Currently after my partition table fix I think it is "normal operation" because after both of those "blocked for" messages copying continued with reasonable speeds ~70MB/s. And I didn't face em anymore (7TB copied now) seems to be much slower at the end, but if I have understood correctly it's the feature of this disk.Unfortunately, using the latest kernel doesn't work for me.Ubuntu wily, Kernel 4.4-rc7 from Ubuntu mainline ppa:[Tue Dec 29 20:14:09 2015] - sd 2:0:0:0: [sdb] tag#24 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[Tue Dec 29 20:14:09 2015] - sd 2:0:0:0: [sdb] tag#24 CDB: Read(16) 88 00 00 00 00 00 50 68 4a 60 00 00 00 20 00 00[Tue Dec 29 20:14:09 2015] - blk_update_request: I/O error, dev sdb, sector 1349012064[Tue Dec 29 20:14:09 2015] - BTRFS error (device sdb): bdev /dev/sdb errs: wr 6387463, rd 69213, flush 4398, corrupt 0, gen 0[Tue Dec 29 20:14:09 2015] - sd 2:0:0:0: [sdb] tag#25 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[Tue Dec 29 20:14:09 2015] - sd 2:0:0:0: [sdb] tag#25 CDB: Write(16) 8a 00 00 00 00 00 50 68 4a 60 00 00 00 08 00 00[Tue Dec 29 20:14:09 2015] - blk_update_request: I/O error, dev sdb, sector 1349012064[Tue Dec 29 20:14:09 2015] - BTRFS error (device sdb): bdev /dev/sdb errs: wr 6387464, rd 69213, flush 4398, corrupt 0, gen 0[Tue Dec 29 20:14:09 2015] - sd 2:0:0:0: [sdb] tag#26 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[Tue Dec 29 20:14:09 2015] - sd 2:0:0:0: [sdb] tag#26 CDB: Read(16) 88 00 00 00 00 00 50 67 73 80 00 00 00 20 00 00[Tue Dec 29 20:14:09 2015] - blk_update_request: I/O error, dev sdb, sector 1348957056[Tue Dec 29 20:14:09 2015] - BTRFS error (device sdb): bdev /dev/sdb errs: wr 6387464, rd 69214, flush 4398, corrupt 0, gen 0[Tue Dec 29 20:14:09 2015] - sd 2:0:0:0: [sdb] tag#27 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[Tue Dec 29 20:14:09 2015] - sd 2:0:0:0: [sdb] tag#27 CDB: Write(16) 8a 00 00 00 00 00 50 67 73 80 00 00 00 08 00 00[Tue Dec 29 20:14:09 2015] - blk_update_request: I/O error, dev sdb, sector 1348957056[Tue Dec 29 20:14:09 2015] - BTRFS error (device sdb): bdev /dev/sdb errs: wr 6387465, rd 69214, flush 4398, corrupt 0, gen 0[Tue Dec 29 20:14:11 2015] - BTRFS warning (device sdb): lost page write due to IO error on /dev/sdb[Tue Dec 29 20:14:11 2015] - BTRFS warning (device sdb): lost page write due to IO error on /dev/sdb[Tue Dec 29 20:14:11 2015] - BTRFS warning (device sdb): lost page write due to IO error on /dev/sdb[Tue Dec 29 20:18:32 2015] - scsi_io_completion: 934 callbacks suppressed[Tue Dec 29 20:18:32 2015] - sd 2:0:0:0: [sdb] tag#4 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[Tue Dec 29 20:18:32 2015] - sd 2:0:0:0: [sdb] tag#4 CDB: Read(16) 88 00 00 00 00 03 a3 81 2a 00 00 00 00 08 00 00[Tue Dec 29 20:18:32 2015] - blk_update_request: 937 callbacks suppressed[Tue Dec 29 20:18:32 2015] - blk_update_request: I/O error, dev sdb, sector 15628052992[Tue Dec 29 20:18:32 2015] - sd 2:0:0:0: [sdb] tag#5 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[Tue Dec 29 20:18:32 2015] - sd 2:0:0:0: [sdb] tag#5 CDB: Read(16) 88 00 00 00 00 03 a3 81 2a 00 00 00 00 08 00 00[Tue Dec 29 20:18:32 2015] - blk_update_request: I/O error, dev sdb, sector 15628052992[Tue Dec 29 20:18:32 2015] - Buffer I/O error on dev sdb, logical block 1953506624, async page read[Tue Dec 29 20:20:13 2015] - sd 2:0:0:0: [sdb] tag#7 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[Tue Dec 29 20:20:13 2015] - sd 2:0:0:0: [sdb] tag#7 CDB: Read(16) 88 00 00 00 00 03 a3 81 2a 00 00 00 00 08 00 00[Tue Dec 29 20:20:13 2015] - blk_update_request: I/O error, dev sdb, sector 15628052992[Tue Dec 29 20:20:13 2015] - Buffer I/O error on dev sdb, logical block 1953506624, async page read[Tue Dec 29 20:20:44 2015] - sd 2:0:0:0: [sdb] tag#9 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[Tue Dec 29 20:20:44 2015] - sd 2:0:0:0: [sdb] tag#9 CDB: Read(16) 88 00 00 00 00 03 a3 81 2a 00 00 00 00 08 00 00[Tue Dec 29 20:20:44 2015] - blk_update_request: I/O error, dev sdb, sector 15628052992[Tue Dec 29 20:20:44 2015] - Buffer I/O error on dev sdb, logical block 1953506624, async page read[Tue Dec 29 20:20:44 2015] - sd 2:0:0:0: [sdb] tag#10 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[Tue Dec 29 20:20:44 2015] - sd 2:0:0:0: [sdb] tag#10 CDB: Read(16) 88 00 00 00 00 03 a3 81 2a 00 00 00 00 08 00 00[Tue Dec 29 20:20:44 2015] - blk_update_request: I/O error, dev sdb, sector 15628052992[Tue Dec 29 20:20:44 2015] - Buffer I/O error on dev sdb, logical block 1953506624, async page read[Tue Dec 29 20:20:46 2015] - sd 2:0:0:0: [sdb] tag#12 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[Tue Dec 29 20:20:46 2015] - sd 2:0:0:0: [sdb] tag#12 CDB: Read(16) 88 00 00 00 00 03 a3 81 2a 00 00 00 00 08 00 00Hi, I own those drives too and I'm facing problems too. :-)I made some tests with different hardware configuration so if you experience some issue too, perhaps this (very long) comment can help you to find a solution to be able to use your hardware.I bought some of these drives to backup personal data (two 4Tb RAID1). My idea was to regularly backup both RAID arrays on one drive, while older copies are kept on others drives in lockers in some different geographical locations, then regularly swap the drive who receives frequent updates with one of the drives kept in different geographical places.Like other people in this thread, I want to use the ext4 file system on a LUKS volume. Perhaps it can fool the hard drive internal garbage collection other people talked about if this use case prevents linear writing.Since I own a e-SATA/USB 3.0 dock, I was innocently planning to use it to sync my data on the frequent backup drive. I've read some people in this thread tried to use these drives this way too.It's a very bad idea to use a dock with this kind of hard drives and does not work at all. I tried 3.18.0, 3.18.21, 4.3.3 and 4.4.0-rc7 kernels with my hard drive dock without success.This is my test:1. plug2. cryptsetup luksFormat3. cryptsetup luksOpen4. mkfs.ext45. mount6. umount7. cryptsetup luksClose8. unplugIn two cases (detailed below), I tried to write some files between steps 5. and 6.For information, that is what the kernel printed in dmesg about my dock when used in USB 3.0 mode:[ 4336.726082] usb 4-1: new SuperSpeed USB device number 2 using xhci_hcd[ 4336.740496] usb 4-1: New USB device found, idVendor=174c, idProduct=55aa[ 4336.740503] usb 4-1: New USB device strings: Mfr=2, Product=3, SerialNumber=1[ 4336.740508] usb 4-1: Product: ASM1053E[ 4336.740511] usb 4-1: Manufacturer: asmedia[ 4336.740515] usb 4-1: SerialNumber: 123456789012[ 4336.741640] usb 4-1: USB controller 0000:0b:00.0 does not support streams, which are required by the UAS driver.[ 4336.741648] usb 4-1: Please try an other USB controller if you wish to use UAS.I've not used any USB 3.1 / UAS dock so I can't tell if it works.When I plug the hard drive I get:[ 4337.740121] sd 12:0:0:0: Attached scsi generic sg12 type 0[ 4337.747901] sd 12:0:0:0: [sdk] Spinning up disk...[ 4338.750173] ...................ready[ 4356.971833] sd 12:0:0:0: [sdk] 15628053168 512-byte logical blocks: (8.00 TB/7.27 TiB)[ 4356.971835] sd 12:0:0:0: [sdk] 4096-byte physical blocks[ 4356.974430] sd 12:0:0:0: [sdk] Write Protect is off[ 4356.974433] sd 12:0:0:0: [sdk] Mode Sense: 43 00 00 00[ 4356.977029] sd 12:0:0:0: [sdk] Write cache: enabled, read cache: enabled, doesn't support DPO or FUA[ 4357.002553] sd 12:0:0:0: [sdk] Attached SCSI disk[ 5277.631070] sdk: sdk1With 4.3 kernels I get that doing a mkfs.ext4:[ 5756.790494] INFO: task mkfs.ext4:21464 blocked for more than 120 seconds.[ 5756.790503] Tainted: G OE 4.3.3-040303-generic #201512150130[ 5756.790506] "echo 0 > /proc/sys/kernel/hung_task_timeout_secs" disables this message.[ 5756.790509] mkfs.ext4 D ffff88083ecd6980 0 21464 18542 0x00000000[ 5756.790517] ffff8807ab0c3d08 0000000000000086 ffff88081aefaa00 ffff8807719daa00[ 5756.790523] ffff8807ab0c4000 ffff8807ab0c3e40 ffff8807ab0c3e38 ffff8807719daa00[ 5756.790527] 0000000000000000 ffff8807ab0c3d20 ffffffff817e7a53 7fffffffffffffff[ 5756.790532] Call Trace:[ 5756.790545] [<ffffffff817e7a53>] schedule+0x33/0x80[ 5756.790551] [<ffffffff817eab19>] schedule_timeout+0x189/0x250[ 5756.790558] [<ffffffff8138fe83>] ? __blk_run_queue+0x33/0x40[ 5756.790562] [<ffffffff81395e9b>] ? blk_queue_bio+0x33b/0x350[ 5756.790570] [<ffffffff817e8473>] wait_for_completion+0xb3/0x140[ 5756.790576] [<ffffffff810a7b20>] ? wake_up_q+0x60/0x60[ 5756.790580] [<ffffffff8138af8b>] submit_bio_wait+0x6b/0x90[ 5756.790585] [<ffffffff81397b7d>] blkdev_issue_flush+0x5d/0x90[ 5756.790591] [<ffffffff8123be25>] blkdev_fsync+0x35/0x50[ 5756.790596] [<ffffffff81234b8b>] vfs_fsync_range+0x4b/0xb0[ 5756.790602] [<ffffffff81003b13>] ? prepare_exit_to_usermode+0xa3/0x100[ 5756.790607] [<ffffffff81234c4d>] do_fsync+0x3d/0x70[ 5756.790611] [<ffffffff81003bbc>] ? syscall_return_slowpath+0x4c/0x120[ 5756.790616] [<ffffffff81234ee0>] SyS_fsync+0x10/0x20[ 5756.790621] [<ffffffff817ebab6>] entry_SYSCALL_64_fastpath+0x16/0x75Some time it also printed:[ 5896.684697] sd 12:0:0:0: timing out command, waited 360s[ 5896.684712] blk_update_request: I/O error, dev sdk, sector 0Increasing the '/sys/block/sdk/device/timeout' value only hide "task blocked for more than N seconds" messages but does not prevent "I/O error" messages to print.The mkfs.ext4 took 12 minutes to finish. During this time, the hard drive was not available (I was not able to query SMART data for example).I don't know if that I/O error message means my file system is broken or not.After the mkfs was complete, I tried to mount the file system, it took 6 minutes. Then I tried to unmount the file system immediately without writing something, it took 35 minutes to unmount.I've tried that with 3.18.0, 3.18.21, 4.3.3 and 4.4.0-rc7 kernels without success. I got the exact same behavior each time.During all my tests, these are the process that triggered a "task blocked for more than 120 seconds':- ext4lazyinit- jbd2/dm-7-8- mkfs.ext4- mount- pool- smartctlOne time I tried to write some data on the hard drive (using rsync), it took more than one hour to write around 300Mb.Then I tried to use my hard drive with the same dock in e-SATA mode (with a 4.3.3 kernel).The kernel printed that in dmesg on hotplug, formating with LUKS, doing some smart queries, and creating a file system:[ 9809.935995] ata7: exception Emask 0x10 SAct 0x0 SErr 0x4050000 action 0xe frozen[ 9809.935999] ata7: irq_stat 0x00000040, connection status changed[ 9809.936000] ata7: SError: { PHYRdyChg CommWake DevExch }[ 9809.936004] ata7: hard resetting link[ 9819.926107] ata7: softreset failed (1st FIS failed)[ 9819.926111] ata7: hard resetting link[ 9829.923484] ata7: softreset failed (1st FIS failed)[ 9829.923494] ata7: hard resetting link[ 9830.986743] ata7: SATA link up 6.0 Gbps (SStatus 133 SControl 300)[ 9831.023104] ata7.00: ATA-9: ST8000AS0002-1NA17Z, AR13, max UDMA/133[ 9831.023112] ata7.00: 15628053168 sectors, multi 0: LBA48 NCQ (depth 31/32), AA[ 9831.024383] ata7.00: configured for UDMA/133[ 9831.024394] ata7: EH complete[ 9831.024645] scsi 6:0:0:0: Direct-Access ATA ST8000AS0002-1NA AR13 PQ: 0 ANSI: 5[ 9831.025124] sd 6:0:0:0: [sdl] 15628053168 512-byte logical blocks: (8.00 TB/7.27 TiB)[ 9831.025133] sd 6:0:0:0: [sdl] 4096-byte physical blocks[ 9831.025224] sd 6:0:0:0: Attached scsi generic sg12 type 0[ 9831.025300] sd 6:0:0:0: [sdl] Write Protect is off[ 9831.025308] sd 6:0:0:0: [sdl] Mode Sense: 00 3a 00 00[ 9831.025361] sd 6:0:0:0: [sdl] Write cache: enabled, read cache: enabled, doesn't support DPO or FUA[ 9831.081474] sdl: sdl1[ 9831.082197] sd 6:0:0:0: [sdl] Attached SCSI disk[ 9878.059460] ata7.00: exception Emask 0x10 SAct 0x2000 SErr 0x480000 action 0x6 frozen[ 9878.059464] ata7.00: irq_stat 0x08000000, interface fatal error[ 9878.059465] ata7: SError: { 10B8B Handshk }[ 9878.059467] ata7.00: failed command: WRITE FPDMA QUEUED[ 9878.059470] ata7.00: cmd 61/fa:68:08:10:00/00:00:00:00:00/40 tag 13 ncq 128000 out res 40/00:68:08:10:00/00:00:00:00:00/40 Emask 0x10 (ATA bus error)[ 9878.059472] ata7.00: status: { DRDY }[ 9878.059474] ata7: hard resetting link[ 9888.052845] ata7: softreset failed (1st FIS failed)[ 9888.052855] ata7: hard resetting link[ 9898.046139] ata7: softreset failed (1st FIS failed)[ 9898.046144] ata7: hard resetting link[ 9933.026910] ata7: softreset failed (1st FIS failed)[ 9933.026915] ata7: limiting SATA link speed to 3.0 Gbps[ 9933.026916] ata7: hard resetting link[ 9938.027583] ata7: softreset failed (1st FIS failed)[ 9938.027594] ata7: reset failed, giving up[ 9938.027598] ata7.00: disabled[ 9938.027619] ata7: EH complete[ 9938.027672] sd 6:0:0:0: [sdl] tag#14 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 9938.027679] sd 6:0:0:0: [sdl] tag#14 CDB: Write(16) 8a 00 00 00 00 00 00 00 10 08 00 00 00 fa 00 00[ 9938.027683] blk_update_request: I/O error, dev sdl, sector 4104[ 9938.027792] program smartctl is using a deprecated SCSI ioctl, please convert it to SG_IO[ 9938.027839] program smartctl is using a deprecated SCSI ioctl, please convert it to SG_IO[ 9938.027868] program smartctl is using a deprecated SCSI ioctl, please convert it to SG_IO[ 9938.031307] sd 6:0:0:0: [sdl] tag#21 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 9938.031316] sd 6:0:0:0: [sdl] tag#21 CDB: Read(16) 88 00 00 00 00 03 a3 81 27 80 00 00 00 08 00 00[ 9938.031321] blk_update_request: I/O error, dev sdl, sector 15628052352[ 9938.031362] sd 6:0:0:0: [sdl] tag#22 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 9938.031366] sd 6:0:0:0: [sdl] tag#22 CDB: Read(16) 88 00 00 00 00 03 a3 81 27 80 00 00 00 08 00 00[ 9938.031368] blk_update_request: I/O error, dev sdl, sector 15628052352[ 9938.031371] Buffer I/O error on dev sdl1, logical block 1953506032, async page read[ 9938.035775] sd 6:0:0:0: [sdl] tag#24 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 9938.035788] sd 6:0:0:0: [sdl] tag#24 CDB: Read(16) 88 00 00 00 00 00 00 00 00 00 00 00 00 08 00 00[ 9938.035795] blk_update_request: I/O error, dev sdl, sector 0[ 9938.035837] sd 6:0:0:0: [sdl] tag#25 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 9938.035845] sd 6:0:0:0: [sdl] tag#25 CDB: Read(16) 88 00 00 00 00 00 00 00 00 00 00 00 00 08 00 00[ 9938.035851] blk_update_request: I/O error, dev sdl, sector 0[ 9938.035857] Buffer I/O error on dev sdl, logical block 0, async page read[ 9938.035942] sd 6:0:0:0: [sdl] tag#26 FAILED Result: hostbyte=DID_BAD_TARGET driverbyte=DRIVER_OK[ 9938.035949] sd 6:0:0:0: [sdl] tag#26 CDB: Read(16) 88 00 00 00 00 00 00 00 00 00 00 00 00 08 00 00[ 9938.035953] blk_update_request: I/O error, dev sdl, sector 0[ 9938.035958] Buffer I/O error on dev sdl, logical block 0, async page readThe hard drive went completely wrong during the mkfs.ext4 step and that step was not able to finish, I had to force the hard-drive / dock shutdown leaving the hard drive with an incomplete ext4 file system on an opened LUKS volume (very bad).Then I tried to use the hard drive on an internal SATA III plug. It's not convenient since I want to be able to hotplug it only at backup time, and these strange hard drives seem to not have standard screw hole on the underside (I can only screw on 2 screws instead of 4 on my bays like my other 4Tb Seagate hard drives). But I need to know if these drives works on internal SATA, because if not I bought expensive paperweight instead of hard drives !I tried it on a 3.18.0 kernel only (my test is not finished), but it works.The mkfs.ext4 took only seconds. Then I started to rsync my whole file tree (two file systems on two 4Tb RAID1 volumes). It started fastly then around first 100Gb it slowed down. Since that it's continuing without error. It's slow but it works. It took 2Tb of data in 12 hours, so it will take some days to complete the test. It's not a problem to me if it's so slow since next rsync will only update modified files (it will be far far faster next time to only write differences).The kernel printed some 'task blocked for more than 120 seconds' but I never got any 'I/O error'.So, it seems to works only when I use an internal SATA III connection. If someone wants to use one of these drive, an external dock is not yet an option. If something can be optimized in the kernel to improve the hard drive management, some improvement must be done in e-SATA and USB code too to be able to use theses drives in external docks. If you plan to use an external dock and can't plug your drive internally (using an hotswap bay if you need hotswap), do not buy these drives, you will lose your money.Since I need to hotplug my drives easily, I bought a SATA III hotplug tray-less bay that fit in a 5.25" CD enclosure. I've not received it yet but I did not expect any issue and it's probably the only current solution for people wanting to hotplug/hotunplug these drives. I strongly recommend to buy one bay with an integrated fan since I noticed that these drives can heat a lot !I found two interesting trayless hard drive hotplug bay to put in a CD enclosure :* Icy Dock TurboSwap MB171SP-B[]+ trayless+ can get 3.5" hard drives (and 2.5" drives if you need that one day)+ integrated 80mm fan (probably not very noisy, and you can replace it with a bigger one if you have the space)+ variable fan speed (front button)+ poweron/off front button- underside fan (you need to keep space below, it probably does not work correctly if you stack multiple of them).* StarTech HSB110SATBK []+ trayless+ can get 3.5" hard drives+ integrated 40mm bottom fan+ you can stack multiple one (bottom fan)+ screen displaying hard drive temperature and fan speed+ can adapt automatically fan speed according to hard drive temperature (plus some button to manage that) and buzz some alarm in case of big problem- the fan is probably very noisy (very small, like the one you find in rackable servers)- this bay costs twice the price (compared to the other one)I've bought the first one and I will receive it soon. If you have bought some of these 8Tb Archive hard drives and want to be able to hotplug them, it's probably the only solution available to you currently. I chose the first one since I only need to power it at backup time, and I can just put the fan to max speed during this time, and monitoring hard drive temperature using SMART. If I got some issues I will tell you.I hope the kernel will receive updates soon to speed-up the writing, but with that kind of bay, you can already hotplug your hard drive today. You'll probably have to wait more more longer to be able to use them on some USB 3/e-SATA docks which is not an option at all today.After the end of my current test (in some days), I will try to reproduce it on a blank disk using a newer kernel.Sounds just like my case.I managed to get my drive to somehow working state after creating proper partition table. Fdisk and parted made partitions which always gave warning about alignment? "Warning: The resulting partition is not properly aligned for best performance.", and always performance was terrible, and that unmounting took ages.After I created partition table with gparted, alignment was ok and drive worked quite well, (parted) align-check opt 1 1 alignedYou can check the above command with qparted and see is it aligned.I created my partition with alignment in mind :)root@box:~# cat /sys/block/sdk/queue/physical_block_size4096root@box:~# cat /sys/block/sdk/queue/optimal_io_size 0root@box:~# cat /sys/block/sdk/queue/minimum_io_size 4096root@box:~# cat /sys/block/sdk/alignment_offset 0root@box:~# parted /dev/sdkGNU Parted 3.2Using /dev/sdkWelcome to GNU Parted! Type 'help' to view a list of commands.(parted) mklabel gpt(parted) mkpart primary 4096s 100%(parted) align-check optimal 11 aligned(parted) unit TB(parted) printModel: ATA ST8000AS0002-1NA (scsi)Disk /dev/sdk: 8,00TBSector size (logical/physical): 512B/4096BPartition Table: gptDisk Flags: Number Start End Size File system Name Flags 1 0,00TB 8,00TB 8,00TB primaryI finally discovered something wrong in my computer case that can prevent me to fit correctly the Icybox bay so I canceled the Icybox order I did to buy the Startech one. I hope it's OK since the Startech one is an older product that was designed years before 8Tb drives exist (and on his side, Icybox officially claims 8Tb drive support), and since I already found incompatible stuff with these 8Tb Seagate drives (screw holes incompatible with my computer case internal trays), I'm a bit apprehensive.On his side, the drive already wrote 3Tb without any errors, with a rough average 50MB/s writing rate, which is the rate Henk Slager had with a 4.3 kernel patched with Martin K. Petersen changes. On my side I'm still running a 3.18 kernel, I will try a 4.4-rc7 one soon.(More senior members, correct me if I'm wrong with the following)But guys,... this bug isn't about block layer alignment optimisations, is it?If one doesn't align the blocks properly, one likely gets some warnings and bad performance. There are many resources out there how to do it right... and most current tools will do everything right out of the box (by auto-detection) or simply fall back to some smart alignment values (e.g. 2048S) which also work out-of-the box for most cases.What this bug, AFAIU, is about: actual data corruptions, block errors, that happen on these SMR devices (typically the 8TB one from Seagate).So if you still see block errors / corruptions like the original posters did - even though you have the patch in place - just post.If you see other corruption errors or completely unexpected performance issues, which may be related to SMR... open a new issue, reference it here.But we probably don't need message from everyone who ever sees the typical "process blocked for 120s" message.Best,:-)Well, my comment shows one use case with I/O errors while creating a file-system on the drive and one use case where the drive go wrong for real, needing an hardware shutdown of the drive while the file-system is mounted.I wrote my comment because I read some messages above about people playing with these drives with external (i.e. not internal SATA) link, and I think it was useful to assess the situation. The same way we probably don't need "process blocked for 120s" messages by everyone, we probably don't need reports on non-SATA use cases. My intent was to point the fact that until theses drives work correctly on SATA link, it's pointless to try to get them working with other links through various interface. It seems clear that the fixes to get them working over SATA are not sufficient to get them working over something else, so if someone wants to try some new kernel or patch, he must know his test is only valid over SATA cable, otherwise he can mark out as faulty a patch that works.Also, I added (and yes it was free and it fixes nothing upstream) a comment to help other people who can't use their drives today for the usage they bought them for (currently, since I can't use my drives for what I've bought them for, my drives are just expensive paperweights). While waiting for fixes being mainlined, it's good to share functional workarounds. It looks like some people have expensive paperweights since 10 months.So to quote yourself:Yes, using an USB/SATA bridge adds some other issues that can hide fixes, it's good to know this use case it's not a valid test (proving that is the main purpose of my comment, which is precious).Hi,Here I have one 8 TB in SATA and another one that's the external version, which is UAS USB3.0.My use case is backup and archival (rsync, attic/borg backup, snapraid).Filesystem is btrfs, and we also have an AES-encrypted DM in the mix.The one thing I can tell for now, is that running 4.4.0-rc8 I still get errors such as:UAS:[ 4554.977414] sd 18:0:0:0: [sdt] tag#18 data cmplt err -71 uas-tag 20 inflight: CMD [ 4554.978207] sd 18:0:0:0: [sdt] tag#18 CDB: Write(10) 2a 00 50 28 d3 c5 00 00 80 00[ 4554.982406] xhci_hcd 0000:00:14.0: ERROR Transfer event for disabled endpoint or incorrect stream ring[ 4554.983193] xhci_hcd 0000:00:14.0: @00000000d89916f0 00000000 00000000 04000000 0b048001SATA, infinite IO to offline device (btrfs issue?):Jan 06 00:16:05 Bidule systemd-journald[28106]: Missed 8 kernel messagesJan 06 00:16:05 Bidule kernel: sd 14:0:0:7: rejecting I/O to offline deviceJan 06 00:16:05 Bidule systemd-journald[28106]: Missed 9 kernel messagesJan 06 00:16:05 Bidule kernel: sd 14:0:0:7: rejecting I/O to offline deviceOn top of the usual stuff which has been reported earlier.And I've always been able to perform small transactions (which leads me to think that the mkfs issues could be unrelated); all the trouble I have is whenever I do lots of writes (dozens / hundrds of GB) on the devices.So far I haven't been able to fill one of these in a single shot, except when throttling the write speed to about 20 MB/s, which would give time to the disks to do their garbage collection.@Thomas DEBESSE: As I've said, if people still actually see corruptions I have absoltely nothing against them posting. To the contrary, I'm happy that people actively test and report.I rather meant the the growing number of "it's just slow when alignment doesn't fit reports",... and even to those people I didn't mean it offensive,.. it just easily clutters up this bug more (as my own two messages now as well ^^) and makes it less likely that the actual issues get fixed.:-)(In reply to Thomas DEBESSE from)>IIRC 4.4.0-rc3 is the first fully patched kernel with respect to this bug report.That is, it contains the reversionand patch.Prior to this, 3.18.21 is reported ok in.Between 3.18.21 and 4.4.0-rc3 you should expect bugs.Edgestore DAS200 via e-Sata and ICY DOCK MB971SP-B working fine using m/b and drive in.(In reply to sweeneygj from)Thats correct, I am using this drive quite successfully nowadays in the meaning that I am able to write many gigabytes of data on it (Ubuntu Server 15.10, Kernel 4.2 over SATA). But still I have a bad feeling about some weird "click" and "clack" noises of the drive while active.Might these noises have to do with this bug ticket? Like powerstate is corrupted or prevented? Or other issue in parking the head? The noises are quite loud...I have Upgraded to 4.4.0 running Ubuntu server 15.10 but I am still receiving errors. I copied a couple hundred gigs from one 8tb drive to the other (mirror) and received the errors also with the final 4.4.0 release (Ubuntu mainline kernel)...I am using ext4 fs...(In reply to alex.wellmann from)Are you sure your drive is not merely dead?What is the output of `smartctl -l error /dev/sda` and `smartctl -H /dev/sda` (adapt `/dev/sda` with your own drive path)?Here, these drives work well on 4.4.0 kernel from ubuntu mainline when used on direct SATA link (I never seen them working on USB3/e-SATA links).Your drive is probably just dead. I don't know if it can be a problem on the SATA chipset side but it really looks like an hardware fault on the hard drive side.That's also what i thought (hardware failure) but the drives work fine on Windows without any issues and are Connected via SATA directly to the MB (Intel C226 chipset). Smartctl also shows no issues for both drives:smartctl 6.4 2014-10-07 r4002 [x86_64-linux-4.4.0-040400-generic] (local build)Copyright (C) 2002-14, Bruce Allen, Christian Franke, www.smartmontools.org=== START OF READ SMART DATA SECTION ===SMART Error Log Version: 1No Errors Loggedsmartctl 6.4 2014-10-07 r4002 [x86_64-linux-4.4.0-040400-generic] (local build)Copyright (C) 2002-14, Bruce Allen, Christian Franke, www.smartmontools.org=== START OF READ SMART DATA SECTION ===SMART overall-health self-assessment test result: PASSEDI've also replaced all SATA cables before I knew that this probably software related...Oh yes I found similar lines in a Linux 4.3 dmesg I recorded some days before (but I'm ok with 4.4):```[ 9878.059465] ata7: SError: { 10B8B Handshk }[ 9878.059467] ata7.00: failed command: WRITE FPDMA QUEUED[ 9878.059470] ata7.00: cmd 61/fa:68:08:10:00/00:00:00:00:00/40 tag 13 ncq 128000 out res 40/00:68:08:10:00/00:00:00:00:00/40 Emask 0x10 (ATA bus error)[ 9878.059472] ata7.00: status: { DRDY }```So it looks software related…(In reply to alex.wellmann from)Not good news.See.You were running 4.1,, and now run 4.4.0-040400-generic For both SMR drive can you postsmartctl -A /dev/sdX Assuming they have a single partition:parted /dev/sdX align-check optimal 1Can you shred the 2nd SMR drive with different sizes (10G/100G/500G/...)?shred -v -s 10G -n 1 Using 4.4.0-rc4 here with snapraid parity builds and no errors.Main Drive:smartctl 6.4 2014-10-07 r4002 [x86_64-linux-4.4.0-040400-generic] (local build)Copyright (C) 2002-14, Bruce Allen, Christian Franke, www.smartmontools.org=== START OF READ SMART DATA SECTION ===SMART Attributes Data Structure revision number: 10Vendor Specific SMART Attributes with Thresholds:ID# ATTRIBUTE_NAME FLAG VALUE WORST THRESH TYPE UPDATED WHEN_FAILED RAW_VALUE 1 Raw_Read_Error_Rate 0x000f 119 099 006 Pre-fail Always - 206075680 3 Spin_Up_Time 0x0003 090 090 000 Pre-fail Always - 0 4 Start_Stop_Count 0x0032 100 100 020 Old_age Always - 811 5 Reallocated_Sector_Ct 0x0033 100 100 010 Pre-fail Always - 0 7 Seek_Error_Rate 0x000f 078 061 030 Pre-fail Always - 69294250 9 Power_On_Hours 0x0032 094 094 000 Old_age Always - 5715 10 Spin_Retry_Count 0x0013 100 100 097 Pre-fail Always - 0 12 Power_Cycle_Count 0x0032 100 100 020 Old_age Always - 169183 Runtime_Bad_Block 0x0032 098 098 000 Old_age Always - 2184 End-to-End_Error 0x0032 100 100 099 Old_age Always - 0187 Reported_Uncorrect 0x0032 100 100 000 Old_age Always - 0188 Command_Timeout 0x0032 100 098 000 Old_age Always - 21475164174189 High_Fly_Writes 0x003a 099 099 000 Old_age Always - 1190 Airflow_Temperature_Cel 0x0022 077 052 045 Old_age Always - 23 (Min/Max 19/35)191 G-Sense_Error_Rate 0x0032 100 100 000 Old_age Always - 0192 Power-Off_Retract_Count 0x0032 100 100 000 Old_age Always - 159193 Load_Cycle_Count 0x0032 100 100 000 Old_age Always - 1005194 Temperature_Celsius 0x0022 023 048 000 Old_age Always - 23 (0 19 0 0 0)195 Hardware_ECC_Recovered 0x001a 119 099 000 Old_age Always - 206075680197 Current_Pending_Sector 0x0012 100 100 000 Old_age Always - 0198 Offline_Uncorrectable 0x0010 100 100 000 Old_age Offline - 0199 UDMA_CRC_Error_Count 0x003e 200 200 000 Old_age Always - 59240 Head_Flying_Hours 0x0000 100 253 000 Old_age Offline - 1407 (192 231 0)241 Total_LBAs_Written 0x0000 100 253 000 Old_age Offline - 62824382504242 Total_LBAs_Read 0x0000 100 253 000 Old_age Offline - 97371030204Mirror Drive (there seems to be the issue):=== START OF READ SMART DATA SECTION ===SMART Attributes Data Structure revision number: 10Vendor Specific SMART Attributes with Thresholds:ID# ATTRIBUTE_NAME FLAG VALUE WORST THRESH TYPE UPDATED WHEN_FAILED RAW_VALUE 1 Raw_Read_Error_Rate 0x000f 119 100 006 Pre-fail Always - 223354776 3 Spin_Up_Time 0x0003 092 090 000 Pre-fail Always - 0 4 Start_Stop_Count 0x0032 100 100 020 Old_age Always - 502 5 Reallocated_Sector_Ct 0x0033 100 100 010 Pre-fail Always - 0 7 Seek_Error_Rate 0x000f 077 060 030 Pre-fail Always - 57320876 9 Power_On_Hours 0x0032 095 095 000 Old_age Always - 4553 10 Spin_Retry_Count 0x0013 100 100 097 Pre-fail Always - 0 12 Power_Cycle_Count 0x0032 100 100 020 Old_age Always - 54183 Runtime_Bad_Block 0x0032 095 095 000 Old_age Always - 5184 End-to-End_Error 0x0032 001 001 099 Old_age Always FAILING_NOW 2401187 Reported_Uncorrect 0x0032 100 100 000 Old_age Always - 0188 Command_Timeout 0x0032 100 091 000 Old_age Always - 25770262588189 High_Fly_Writes 0x003a 100 100 000 Old_age Always - 0190 Airflow_Temperature_Cel 0x0022 076 055 045 Old_age Always - 24 (Min/Max 19/34)191 G-Sense_Error_Rate 0x0032 100 100 000 Old_age Always - 0192 Power-Off_Retract_Count 0x0032 100 100 000 Old_age Always - 99193 Load_Cycle_Count 0x0032 100 100 000 Old_age Always - 585194 Temperature_Celsius 0x0022 024 045 000 Old_age Always - 24 (0 19 0 0 0)195 Hardware_ECC_Recovered 0x001a 119 100 000 Old_age Always - 223354776197 Current_Pending_Sector 0x0012 100 100 000 Old_age Always - 0198 Offline_Uncorrectable 0x0010 100 100 000 Old_age Offline - 0199 UDMA_CRC_Error_Count 0x003e 200 200 000 Old_age Always - 0240 Head_Flying_Hours 0x0000 100 253 000 Old_age Offline - 273 (229 40 0)241 Total_LBAs_Written 0x0000 100 253 000 Old_age Offline - 88190076516242 Total_LBAs_Read 0x0000 100 253 000 Old_age Offline - 52861305865result is for both "1 aligned"Same issue here. Brand new Samsung Archive 8 TB "fails" after rsyncing ~250GB.Tested on Arch with fresh 4.4.0-mainline kernel. Single ext4 partition over LUKS. Full dmesg in the attached file. Please let me know if you need any extra details.Createddmesg from boot to drive failure after rsyncing ~250 GB of dataI ran shred with 10G/100G/500G without any issues. I also checked dmesg for errors but it was clean (no issues). In addition I fired up windows and checked with SeaTools for errors (the end-to-end errors made me nervous) but according to the software all is good. I assume that the end-to-end errors are a result of of issues shown in the logs. I use these drives for some time now - so it is not surprising that errors occurred due to the kernel issues (right?)...I'm using the 8 TB (AR15) in combination with btrfs on a gentoo 4.3.3 kernel and am experiencing some very strange slowdowns. I have managed to copy 15 TB without trouble and after copy, I like to run rsync -car --progress to verify that the data copied matches the original (bit rot experiences from the past).In this case, it verified maybe 5 TB but looking at the rsync progress I see speeds slowing down after a few hours. The last few files went around 256 kb/s - 2 mb/s. Even slower then what I expect from the garbage collection progress.Additionally, I see kworker going mad: 9012 root 20 0 0,0m 0,0m 0,0m R 99,3 0,0 0,0m 698:42.28 kworker/u8:22 Looking at the btrfs bits, I see they have been active cumulatively but are 'standing still' for this bit: 2658 root 20 0 0,0m 0,0m 0,0m S 0,0 0,0 0,0m 44:35.55 btrfs-transacti I don't know if this is purely a btrfs thing or the SMR causing havoc in the driver stack.From what I understood however, the bad performance of the SMR drives was mostly due to writing to the drivers, with the rsync job really only reading, I'm a little puzzled at to what is going on.dmesg is clean (for reading, when writing i see my LSI controller complaining about delays, but I kind of expected that. After I am able to verify my data is safely copied, I'll give the 4.4 kernel a spin and see if that improves this at all.A slight nuance, I accidentally got my rsync commands wrong and was copying as a subdirectory instead of comparing, so the slow speed may be attributed as to the drive being being written full (about 50gb). The rsync job is running with the proper arguments now and will monitor strange CPU loads.one update: after shredding on the second drive, I have repartioned it and setup a single partition again in EXT4. now i am copying the files from the first drive using rsync and after 4TB of writes strangely still no errors in dmesg...Just tried shreding the drive with 'sudo shred -v -n 1 /dev/sde'.After ~200 GB shred started reporting errors:shred: /dev/sde: error writing at offset 228231399936: Input/output errorshred: /dev/sde: error writing at offset 228231400448: Input/output errorshred: /dev/sde: error writing at offset 228231400960: Input/output error[..]Dmesg:[66136.982973] ata2.00: exception Emask 0x0 SAct 0x100000 SErr 0x0 action 0x6 frozen[66136.982977] ata2.00: failed command: WRITE FPDMA QUEUED[66136.982980] ata2.00: cmd 61/80:a0:00:8e:88/00:00:1a:00:00/40 tag 20 ncq 65536 out res 40/00:00:00:00:00/00:00:00:00:00/40 Emask 0x4 (timeout)[66136.982981] ata2.00: status: { DRDY }[66136.982983] ata2: hard resetting link[66142.319497] ata2: link is slow to respond, please be patient (ready=0)[66147.012756] ata2: COMRESET failed (errno=-16)[66147.012763] ata2: hard resetting link[66152.345957] ata2: link is slow to respond, please be patient (ready=0)[66157.042530] ata2: COMRESET failed (errno=-16)[66157.042535] ata2: hard resetting link[66162.375757] ata2: link is slow to respond, please be patient (ready=0)[66192.091844] ata2: COMRESET failed (errno=-16)[66192.091849] ata2: limiting SATA link speed to 1.5 Gbps[66192.091851] ata2: hard resetting link[66197.105067] ata2: COMRESET failed (errno=-16)[66197.105072] ata2: reset failed, giving up[66197.105073] ata2.00: disabled[66197.105084] ata2: EH complete[66197.105097] scsi_io_completion: 96 callbacks suppressed[66197.105100] sd 1:0:0:0: [sde] tag#21 UNKNOWN(0x2003) Result: hostbyte=0x04 driverbyte=0x00[66197.105102] sd 1:0:0:0: [sde] tag#21 CDB: opcode=0x8a 8a 00 00 00 00 00 1a 88 8e 00 00 00 00 80 00 00[66197.105103] blk_update_request: 143 callbacks suppressed[66197.105104] blk_update_request: I/O error, dev sde, sector 445156864[66197.105218] sd 1:0:0:0: [sde] tag#22 UNKNOWN(0x2003) Result: hostbyte=0x04 driverbyte=0x00[66197.105221] sd 1:0:0:0: [sde] tag#22 CDB: opcode=0x8a 8a 00 00 00 00 00 1a 88 8e 01 00 00 00 7f 00 00[66197.105222] blk_update_request: I/O error, dev sde, sector 445156865[66197.105302] sd 1:0:0:0: [sde] tag#23 UNKNOWN(0x2003) Result: hostbyte=0x04 driverbyte=0x00[66197.105305] sd 1:0:0:0: [sde] tag#23 CDB: opcode=0x8a 8a 00 00 00 00 00 1a 88 8e 02 00 00 00 7e 00 00[66197.105306] blk_update_request: I/O error, dev sde, sector 445156866[66197.105374] sd 1:0:0:0: [sde] tag#24 UNKNOWN(0x2003) Result: hostbyte=0x04 driverbyte=0x00[66197.105377] sd 1:0:0:0: [sde] tag#24 CDB: opcode=0x8a 8a 00 00 00 00 00 1a 88 8e 03 00 00 00 7d 00 00[..](In reply to alex.wellmann from)[Fedora F23, drive set up with single ext4 partition on top of LUKS]4.4.0 works for me:uname -r;ddrescue /dev/sdc image.dd image.log4.4.0-gjs-archive-GNU ddrescue 1.20Press Ctrl-C to interruptrescued: 1027 GB, errsize: 0 B, current rate: 110 MB/s ipos: 1027 GB, errors: 0, average rate: 81368 kB/s opos: 1027 GB, run time: 3h 30m 33s, remaining time: 5h 16mtime since last successful read: 0sNo errors reported.(In reply to alex.wellmann from)I would agree, see.(In reply to Bartłomiej Romański from)Your dmesg inhas this:[ 3418.329343] ata2.00: device reported invalid CHS sector 0Does 'CHS sector 0' occur with the shred too?Just to confirm, this drive hasn't been written to by anything other than kernel 4.4.0 ?(In reply to Oliver from)See.(In reply to sweeneygj from)No. Such error does not occur in dmesg while shredding.No. I've tried using this drive with 4.3 before. Then I've switched to 4.4, repartitioned and tried again. Any chance it was in any way permanently broken by 4.3? If yes, can I "reset" it somehow?(In reply to sweeneygj from)512 bytes apart ..... bad disk?From:[66197.105104] blk_update_request: I/O error, dev sde, sector 445156864 445156864 x 512 = 227920314368'smartctl -A /dev/sdX' and check attributes 5, 197 and 198 equal 0.I would surface scan the drive.smartctl -t short /dev/sdXsmartctl -t long /dev/sdXor use seatools to check.The original reporter of this bug had a bad drive,.'smartctl -A /dev/sdb' looks fine.'smartctl -t short /dev/sdb' completed without errors, long test running now (936 minutes to complete :/).Full output below:=== START OF READ SMART DATA SECTION ===SMART Attributes Data Structure revision number: 10Vendor Specific SMART Attributes with Thresholds:ID# ATTRIBUTE_NAME FLAG VALUE WORST THRESH TYPE UPDATED WHEN_FAILED RAW_VALUE 1 Raw_Read_Error_Rate 0x000f 113 096 006 Pre-fail Always - 52311640 3 Spin_Up_Time 0x0003 093 092 000 Pre-fail Always - 0 4 Start_Stop_Count 0x0032 100 100 020 Old_age Always - 40 5 Reallocated_Sector_Ct 0x0033 100 100 010 Pre-fail Always - 0 7 Seek_Error_Rate 0x000f 060 060 030 Pre-fail Always - 1074340 9 Power_On_Hours 0x0032 100 100 000 Old_age Always - 26 10 Spin_Retry_Count 0x0013 100 100 097 Pre-fail Always - 0 12 Power_Cycle_Count 0x0032 100 100 020 Old_age Always - 35183 Runtime_Bad_Block 0x0032 098 098 000 Old_age Always - 2184 End-to-End_Error 0x0032 100 100 099 Old_age Always - 0187 Reported_Uncorrect 0x0032 100 100 000 Old_age Always - 0188 Command_Timeout 0x0032 099 099 000 Old_age Always - 17180131334189 High_Fly_Writes 0x003a 100 100 000 Old_age Always - 0190 Airflow_Temperature_Cel 0x0022 067 057 045 Old_age Always - 33 (Min/Max 23/37)191 G-Sense_Error_Rate 0x0032 100 100 000 Old_age Always - 0192 Power-Off_Retract_Count 0x0032 100 100 000 Old_age Always - 36193 Load_Cycle_Count 0x0032 100 100 000 Old_age Always - 45194 Temperature_Celsius 0x0022 033 043 000 Old_age Always - 33 (0 4 0 0 0)195 Hardware_ECC_Recovered 0x001a 113 100 000 Old_age Always - 52311640197 Current_Pending_Sector 0x0012 100 075 000 Old_age Always - 0198 Offline_Uncorrectable 0x0010 100 075 000 Old_age Offline - 0199 UDMA_CRC_Error_Count 0x003e 200 200 000 Old_age Always - 0240 Head_Flying_Hours 0x0000 100 253 000 Old_age Offline - 5 (37 130 0)241 Total_LBAs_Written 0x0000 100 253 000 Old_age Offline - 1868257948242 Total_LBAs_Read 0x0000 100 253 000 Old_age Offline - 106309=== START OF READ SMART DATA SECTION ===SMART Self-test log structure revision number 1Num Test_Description Status Remaining LifeTime(hours) LBA_of_first_error# 1 Extended offline Self-test routine in progress 90% 26 -# 2 Short offline Completed without error 00% 26 -(In reply to Bartłomiej Romański from)Not tested but:smartctl -t select,445156864-445764455 /dev/sdXshould scan the problem area.If it helps... while a proper solution is found, I have had no problems doing 10 TBs of writes using the blkio controller to limit write speed: for x in "8:160" "65:48"; do echo "$x 80000000" | sudo dd of=/sys/fs/cgroup/blkio/blkio.throttle.write_bps_device; doneI went gradually up from 30 MB/s to 80 MB/s and then I got tired because it was good enough for me.In my experience, the drives are fine, false positive reports of write failures are not recorded by SMART which would be the case if it was a disk write failure.both smartctl tests finished without any errors:=== START OF READ SMART DATA SECTION ===SMART Self-test log structure revision number 1Num Test_Description Status Remaining LifeTime(hours) LBA_of_first_error# 1 Extended offline Completed without error 00% 40 -# 2 Short offline Completed without error 00% 26 -(In reply to Bartłomiej Romański from)So the drive is OK.If there is a bug, running shred again should trigger it. However, seeand. Same kernel and hardware, two different results.If the bug fromappears again, you may need to go back to 3.18.X and see if rsync triggers the error.Finally, I've just shred an old 750GB drive and got I/O errors. No smart errors. so shred errors can be ignored.The drive seems to be working fine now. I've followed the protip I've got in private:- turn off the PC- disconnect power cable from the drive- wait a few minutes (to be super sure!)- reconnect the drive and start the systemAfter this "very hard reboot" the drive is magically working fine. I've mananged to shred the whole 8TB and rsync ~1.5T without any errors.Thank you for all your help.I'm running 4.4 since release and it seems to run without problems now, big thanks especially to Martin.However, 4.3 introduced a i915 suspend/hibernate bug that has not been fixed in 4.4 (). Is there any way the SMR patch in question can be backported to 4.1 lts? IMHO, a patch like this even qualifies for inclusion in an lts release such as 4.1.CreatedLog of drives interfering with other disks on same controllerHey,That patch works like a charm some of the time. But if I have disks on the same controller it seems to cause a cascading failure of all disks on that controller.So the configuration of that 4 channel SATA controller is:/dev/sdi /dev/sdj are in a btrfs raid1 both seagates 8TB disks/dev/sdg /dev/sdh are in a md raid1 both western digital 1TB disks# uname -aLinux marvin 4.4.0-rc8-amd64 #1 SMP Debian 4.4~rc8-1~exp1 (2016-01-04) x86_64 GNU/LinuxIf I copy data to the btrfs at some point in the future everything will fail disabling all devices on the controller. I have tried to increase the SATA timeouts and have also tried throttling the data using blkio but that just delays the failure. I'm trying to copy from a raid5 in the same host to the seagates 8TB drives. If I do it without any throttling it will fail within minutes of the rsync actually starting to copy data.I can confirm this behavior.Having another disk on the same controller makes one of the disks unusable.In my case, I can't even mount the file system.Disconnecting one disk resolves the issue.
id=43197	I use at Ubuntu 12.04:I: Bus=0011 Vendor=0002 Product=000f Version=0000N: Name="FSPPS/2 Sentelic FingerSensingPad"P: Phys=isa0060/serio1/input0S: Sysfs=/devices/platform/i8042/serio1/input/input9U: Uniq=H: Handlers=mouse0 event9B: PROP=8B: EV=bB: KEY=2420 0 30000 0 0 0 0 0 0 0 0B: ABS=2608000 3Until kernel 3.2.0-24-generic touchpad it was defined as a mouse, configured in the settings of the mouse. Worked boundary scrolling. Multi-touch is not working.With this Kernel 3.2.0-24 touchpad appeared in the settings, became multi-function, but the boundary was lost scrolls.Dvuhpaltsevy scrolling works. Also in the middle of the strip under the scrolling on the touchpad appeared a place that throws the pointer in the upper left corner.Now I tested kernel 3.4-rc4 and it`s have bug. Touchpad works very bad. This bug in Launchpad bug tracker -FYI - "Dvuhpaltsevy" means "double-finger".(In reply to)[...]If I understand it correctly, two finger(dvuhpaltsevy?) scrolling and edge(boundary) scrolling are mutually exclusive. That is, once you enabled two finger scrolling, edge scrolling will be disabled.But it is not working. Edge scroll does not work, and with two finger scrolling area in the middle of the touchpad, which is used for normal scrolling transition occurs in the upper left corner. It is this section of the touchpad is not working properly, which is very annoying.I would also like to return back midle scrolling, because two-finger scrolling is awkward to me. I like the behavior that was when the touchpad is defined as a mouse.Now I use the old kernel.Sorry for my bad English.My original error message in Russian posted here [1]. I'll be glad if someone will add or correct my bug report message in English.[1] -(In reply to)I have really hard time making sense of the original report as well. What is the difference between "краевая прокрутка" and "однопальцевый скроллинг"?Re: two finger vs. edge scrolling - I am not sure what display manager you are using, but in KDE if two finger scrolling is enabled then edge scrolling is automatically disabled. I am not sure what behavior Gnome/Unity has. It could also be that touchpad dimensions are not quite right.Re: jumps into upper left corner: where is the scrolling area located? You are saying that it in in the middle of the touchpad, which does not make sense. The scrolling areas are usually marked along the right and/or bottom edge of the touchpad.Re: "return back midle scrolling" - what is it exactly?Re: "I like the behavior that was when the touchpad is defined asa mouse" - boot with psmouse.proto=imps or add "options psmouse proto=imps" (depending on whether psmouse is built into the kernel or is a loadable module).Thanks.It's the same thing.The boundary value MUST turn off scrolling, but not disabled.The entire touchpad works correctly (no edge scrolling), but that this part [1] of the pressing one or two fingers sends the cursor in the upper left corner.To work scrolling in one finger mode with midle scrolling. Now it not work.[1] - Photo of touchpad.Red marked area of ​​hitting a finger on which is getting the cursor in the upper left corner.The touchpad is detected as a mouse, and began work as well as in the old core. This behavior suits me. The scroll work.Thank you!But this is a temporary solution does not eliminate malfunction of the touchpad. Please do not close the bug until it is fixed.Hi Leks13, Need your help to provide the packet dump generated during edge scrolling. You'll need to rebuild psmouse.ko by adding following two lines at the beginning of drivers/input/mouse/sentelic.c:#define FSP_DEBUG#define DEBUG Additionally, what's the hardware revision are you using(dmesg | grep Finger)? According to the photo you provided, it doesn't seem like an ASUS UX[23]1 to me.How can I do?Can you provide step by step instructions?It`s china notebook Quanta UW3(DNS (0136475)).dmesg | grep Finger[ 12.748805] psmouse serio1: sentelic: Finger Sensing Pad, hw: 14.1.1, sw: 1.0.0-K[ 12.813665] input: FSPPS/2 Sentelic FingerSensingPad as /devices/platform/i8042/serio1/input/input6:~$ cat /lib/modules/`uname -r`/kernel/drivers/input/mouse/sentelic.ccat: /lib/modules/3.2.0-24-generic/kernel/drivers/input/mouse/sentelic.c: File not found:~$ cd /lib/modules/`uname -r`/kernel/drivers/input/mouse/:/lib/modules/3.2.0-24-generic/kernel/drivers/input/mouse$ lsappletouch.ko gpio_mouse.ko logibm.ko psmouse.ko synaptics_i2c.kobcm5974.ko inport.ko pc110pad.ko sermouse.ko vsxxxaa.ko I do not know what to do. Simply create a new file sentelic.c? And then what?(In reply to)You'll need to get the full kernel source code to rebuild kernel.should give you some hints. For example: $ apt-get source linux-image-3.2.0-24-generic $ sudo apt-get build-dep linux-image-3.2.0-24-generic $ cd linux-3.2.0 $ chmod +x debian/scripts/misc/* debian/scripts/* $ debian/rules updateconfigs $ vi drivers/input/mouse/sentelic.c # add #define FSP_DEBUG and #define DEBUG $ env skipabi=true fakeroot debian/rules binary-generic If nothing goes wrong, you should see a installable package such like ../linux-image-3.2.0-24-generic_3.2.0-24.37_i386.deb in the parent directory.Okay.When I rebuild and restart in new kernel where I found debug messages?What I will post to bug report?(In reply to)After booting with the FSP_DEBUG enabled kernel, you should see something like the following in your dmesg when finger is on the FSP:[ 183.114646] psmouse serio1: sentelic: -0117064ms Absolute packets: 58, 73, 5f, 05; abs_x: 461, abs_y: 381[ 183.126820] psmouse serio1: sentelic: -0117052ms Absolute packets: 58, 70, 5e, 03; abs_x: 448, abs_y: 379[ 183.139041] psmouse serio1: sentelic: -0117036ms Absolute packets: 58, 6c, 5e, 0b; abs_x: 434, abs_y: 379[ 183.151250] psmouse serio1: sentelic: -0117024ms Absolute packets: 58, 69, 5e, 03; abs_x: 420, abs_y: 379[ 183.163416] psmouse serio1: sentelic: -0117012ms Absolute packets: 58, 66, 5e, 07; abs_x: 409, abs_y: 379[ 183.175596] psmouse serio1: sentelic: -0117000ms Absolute packets: 58, 64, 5e, 01; abs_x: 400, abs_y: 377[ 183.199941] psmouse serio1: sentelic: -0116976ms Absolute packets: 58, 00, 00, 00; abs_x: 0, abs_y: 0[ 183.212173] psmouse serio1: sentelic: -0116964ms Absolute packets: 58, 00, 00, 00; abs_x: 0, abs_y: 0[ 183.224369] psmouse serio1: sentelic: -0116952ms Absolute packets: 58, 00, 00, 00; abs_x: 0, abs_y: 0 I'll need the message generated whilst you're performing edge scrolling(particularly the one with "cursor jumping back to top-left corner when moving through the red-mark area"). Thanks!Hmm...I`m build kernel, install it, reboot to it, but I don`t have a message in dmesg!Before build a have two files: linux-image-3.2.0-24-generic_3.2.0-24.37_i386.deb, linux-headers-3.2.0-24-generic_3.2.0-24.37_i386.deb. I install this and reboot. I don`t undestand why I don`t have report about touchpad.My redacted drivers/input/mouse/sentelic.c pasted todmesg | grep psmouse[ 16.503933] psmouse serio1: hgpk: ID: 10 00 64[ 16.716690] psmouse serio1: sentelic: Finger Sensing Pad, hw: 14.1.1, sw: 1.0.0-KI have only this, after reboot to my new build kernel.(In reply to)[...]You'll have to put DEBUG & FSP_DEBUG before various #include lines, something like:#define DEBUG#define FSP_DEBUG/*- * Finger Sensing Pad PS/2 mouse driver. * ...My edge scrollingIn this moment cursor has been moved to left top corner of the screenI hope the logs will help.(In reply to)I presume that you're moving your finger from top-right to bottom-right corner, right? What looks strange to me is that the y coordinate(62) is still far from the red zone, which should be about half of the height(300+) if I read your image correctly.In this dump, was starting from the red zone(line 6 ~ 38) and then moving toward the bottom-right corner? Is line 58 ~ 59 the time your finger crossing/entering the red zone?How I tested - I wrote last message in dmesg, moved in top right to bottom right, and posted all before this wrote message.Red zone just below the middle. Figure I depicts a little bit wrong.toward the bottom-right corner?I don`t know. I started scrolling around the red zone and ended up after moving the pointer to the red zone in the upper left corner.Createdtesting zone for jumpy cursorNeed Leks13 to test if cursor jumping still occurs when finger is moving on the yellow/blue zone. If cursor still jumps back to top-left corner, please also provide the packet dump.Yellow zone testing video[1], log[2].[1] -[2] -If you move your finger across the touchpad from the top down, then hit the finger at the end of the touchpad the cursor moves sharply up the screen (just up, but not in the top left).Blue zone.The touchpad works strange: sometimes ok, sometimes not. In two pass log sealed touch pad from top to bottom. The first pass - everything is normal, the second - the cursor jumped to the top left corner.I do not know what the reason, and play it does not always work. Maybe that plays the role of the force pressing or something, but when working for the touchpad are spontaneous movements occur several times per hour and is very annoying.Createdbash script for retrieving FSP production informationPlease post the result returned by this script(sudo bash fsp_sn.sh). Thanks!sudo sh fsp_sn.sh [sudo] password for leks13: fsp_sn.sh: 9: fsp_sn.sh: cannot create /sys/bus/serio/drivers/psmouse/serio*/page: Directory nonexistentfsp_sn.sh: 10: fsp_sn.sh: cannot create /sys/bus/serio/drivers/psmouse/serio*/getreg: Directory nonexistentfsp_sn.sh: 12: fsp_sn.sh: cannot create /sys/bus/serio/drivers/psmouse/serio*/getreg: Directory nonexistentfsp_sn.sh: 14: fsp_sn.sh: cannot create /sys/bus/serio/drivers/psmouse/serio*/getreg: Directory nonexistentfsp_sn.sh: 17: fsp_sn.sh: cannot create /sys/bus/serio/drivers/psmouse/serio*/page: Directory nonexistentsn: 0000, 0000, 0000Sorry. This is true result:sudo bash fsp_sn.shsn: 4004, 4187, 4210Createdpatch to filter bad movementHi Leks13, Please try to see if this patch works for you or not. You'll need to rebuild/re-install the patched kernel source. Steps to apply patch(takingbuilding steps as an example): $ cd linux-3.2.0/drivers/input/mouse $ patch < filter_bad_movement.patchNo. It`s don`t worked correctly.Edge srolling - not work.Jump zone - has come out less often, but sometimes it throws the cursor still.Two-finger scrolling - not work.Yes, let them work, defined as a mouse. I was quite happy. Also, it bothers small number of users. Much more often make synaptic touchpad.(In reply to)Oops, I got it wrong. Please move the "abs_x = GET_ABS_X(packet);" and "abs_y = GET_ABS_Y(packet);" lines after the filter if statement. Something like:case FSP_PKT_TYPE_ABS: if ((packet[0] == 0x48 || packet[0] == 0x49) && packet[1] == 0 && packet[2] == 0) { /* * filtering out erratic movement which will cause * unexpected cursor jumping to top-left corner */ packet[3] &= 0xf0; } abs_x = GET_ABS_X(packet); abs_y = GET_ABS_Y(packet); if (packet[0] & FSP_PB0_MFMC) { ...I fixed it this[1]. Is that true? Just do not want to once again build the core. It's too long on the Atom.[1] -I build kernel, apped #32 patch.But it work bad. Two-finger scrolling - work.Edge scrolling - not work.Jump zone - has come out less often, but sometimes it throws the cursor still.I got an email about the bug, but I can not answer it. The letter is not delivered.I have this error:"This message was created automatically by mail delivery software.A message that you sent could not be delivered to one or more of itsrecipients. This is a permanent error. The following address(es) failed:SMTP error from remote mail server after RCPT TO:<>: host yggdrasil.sentelic.com [203.69.18.18]: 554 5.7.1 Service unavailable; Client host [91.219.194.22] blocked using ru.countries.nerd.dk; Your IP is in ru, rejected based on geographical location"I will reply to the letter publicly in the ticket.I use Ubuntu 12.04 and $ uname -aLinux flamme 3.2.0-24-generic #39-Ubuntu SMP Mon May 21 16:51:22 UTC 2012 i686 i686 i386 GNU/LinuxThis is standart kernel in Ubuntu repository.This is filter_bad_movement.patch -This is sentelic.c no patch -Patch process this -This is sentelic.c after patch -Great. Tested the new driver - everything works great.How does the touchpad work with two finger scroll with patches and a newer kernel? I am currently running Ubuntu 12.04 with kernel 3.2.0-24-generic on an Asus UX21E, and it's basically unusable.Also "Disable touchpad while typing" does not work either.Or should I open a separate bug about these issues since the one reported here seems to be solved.(In reply to)Please try the patch - we need more testers to make sure it works well before getting the patch applied (Disabling touchpad while typing is not done within the kernel so I'd recommend opening the bug with your distro and having them route it properly.Thanks.CreatedPatch to filter out data causing errating movementsThe latest version of the patchI followed this procedure to build the kernel with the latest patch: $ apt-get source linux-image-3.2.0-24-generic $ sudo apt-get build-dep linux-image-3.2.0-24-generic $ cd linux-3.2.0 $ chmod +x debian/scripts/misc/* debian/scripts/* $ debian/rules updateconfigs $ vi drivers/input/mouse/sentelic.c # add #define FSP_DEBUG and #define DEBUG $ cd linux-3.2.0/drivers/input/mouse $ patch < filter_bad_movement.patch $ cd - $ env skipabi=true fakeroot debian/rules binary-generic $ cd .. $ sudo dpkg -i linux-headers-3.2.0-24-generic_3.2.0-24.39_amd64.deb linux-image-3.2.0-24-generic_3.2.0-24.39_amd64.debThis did not improve two finger scroll at all.Palm detection doesn't work either, which makes typing a hassle. Is this something that is kernel or distro specific?Also, is there a way to set driver patches without recompiling the entire kernel? Maybe load it like a module or something similar? Compiling the kernel takes a while, which makes testing potential fixes more difficult.filter_bad_movement.patch - it`s old wrong patchI used the latest patch (), just forgot to change the name to "sentelic.patch" in the comment.(In reply to)Since you already have FSP_DEBUG and DEBUG defined at the beginning of sentelic.c, please do two fingers scrolling first and then use dmesg to get packet dump for analysis. Thanks.Patch work fine in Ubuntu 12.04 on my touchpad(3.2.0-24-generic).After loading for a comfortable working with edge scrolling needed to run "synclient RightEdge = 900" (the value may change depending on the laptop).Thank you all for corrected bug.CreatedA dmesg debug report featuring two finger scroll jumping to (x,y)=(0,0)Note at the end of the log how I am scrolling down a page and (x, y) suddenly resets to abs pos (0, 0).Created(x, y) getting stuck alternating between two sets of coordinatesNotice close to the end how the absolute coordinates shift between two sets of coordinates very quickly:[ 562.271845] psmouse serio4: sentelic: 00263060ms Absolute packets: 7c, 80, 56, 0f; abs_x: 515, abs_y: 347[ 562.279471] psmouse serio4: sentelic: 00263068ms Absolute packets: 78, a4, 81, 03; abs_x: 656, abs_y: 519[ 562.284430] psmouse serio4: sentelic: 00263072ms Absolute packets: 7c, 80, 56, 0a; abs_x: 514, abs_y: 346[ 562.291770] psmouse serio4: sentelic: 00263080ms Absolute packets: 78, a4, 82, 01; abs_x: 656, abs_y: 521[ 562.296709] psmouse serio4: sentelic: 00263084ms Absolute packets: 7c, 80, 56, 0d; abs_x: 515, abs_y: 345[ 562.304887] psmouse serio4: sentelic: 00263092ms Absolute packets: 78, a3, 82, 0a; abs_x: 654, abs_y: 522[ 562.310118] psmouse serio4: sentelic: 00263096ms Absolute packets: 7c, 80, 56, 09; abs_x: 514, abs_y: 345[ 562.317782] psmouse serio4: sentelic: 00263104ms Absolute packets: 78, a3, 82, 07; abs_x: 653, abs_y: 523[ 562.323105] psmouse serio4: sentelic: 00263112ms Absolute packets: 7c, 80, 55, 0f; abs_x: 515, abs_y: 343This resulted in the web page I was trying to scroll down scrolling up and down very quickly on the spot.Createdv2 patch to filter out bad movementHi Eddie, Please revert sentelic.patch and try this one instead. Thanks.Createddmesg with latest filter patch () appliedBehavior is a -lot- better; I don't get the crazy up-down-up-down-up-down lockup any longer. However, if I'm scrolling down a long page, it sometimes scrolls to the top of the page all of a sudden, which is very annoying.(In reply to)Looks to me the jumping was caused by 1446.818497 and 1446.843775. I probably misunderstood how input_mt_report_slot_state() works. Dmitry, should we simply stop calling fsp_set_slot() upon receiving bad movement(0,0) in multi-finger(MFMC) case?I think if a device truly sends garbage data sometimes then we need to completely ignore such packets and not adjust slot state, since contact will "recover" in the next packet(s).(In reply to)[...]Interesting... It appears to me that the final 7c, 00, 00, 00 doesn't cause these jumps. Not sure if this is the same with Eddie's observation; however, I can reproduce similar jumping by putting two fingers at two places(in opposite direction. For example, one at the top left and the other at the bottom right corner), hold two fingers for a few seconds, then move both of them away -- now the browser scroll bar starts to roll. If that's the case, we probably have to fix the code by _not_ invoking fsp_set_slot() unless two fingers' coordinates are ready. That is, accumulate both fingers' packets and report at once with something like the xxx_report_semi_mt_data() found in other touchpad drivers.CreatedScroll jumps up and down continously until I remove hand from trackpadMy last comment about the latest patch fixing jumping up and down was wrong. See end of attached dmesg.This happens while I'm scrolling down and one finger "moves ahead" of the other. In my case I was scrolling down with my right hand, and my middle finger moved from being horizontal with my ring finger to being about 2 centimeters farther down.Createdv3 patch to filter out bad movementHi Eddie, Please see if this patch works for you. Thanks.Createddebug output filter patch 3Latest patch gives a much better result overall.However, the crazy fast scroll still occurs sometimes. I have attached a debug report.(In reply to)How does the crazy fast scroll look like? Does it scroll back all the way to the top most page or just scroll back a short distance?I can see the Y coordinate of the first finger jumps back from 750 to 597 at 1567.914751. I'm wondering if this could be filtered in the userland as the kernel driver may need more resource to keep the track of movement history before applying certain heuristics to ignore such jumpy packet.(In reply to)Both can happen, actually. But the most annoying (and more common) is if you're scrolling down a page and it suddenly goes really fast either to the top or to the bottom of the page (it can also happen).Createddmesg output seems normal, as far as I can tellI just noticed a slightly disconcerting bug -- after resuming from suspend, I can no longer use two finger scroll. Edge scrolling works normally if I switch to it.(In reply to)There's a typo in the v3 patch. Please try to change the 'fgrs = 1' to 'fgrs = 2' after the 'MFMC 1st finger' line and see if it helps: } else if (IS_MFMC_FGR1(packet[0])) { /* MFMC 1st finger */ fgrs = 2; /* * accumulate the coordaintes and proceed to * the next run */... The above bug should be observable before entering to suspend mode, though.I have notebook DNS X300 (china export)In windows installed drivers sentelic and work fine.In linux (Ubuntu 12.04) touchpad not detect. Tap working, scroll not working, configure utils show only mouse.$ xinput list⎡ Virtual core pointer id=2 [master pointer (3)]⎜ ↳ Virtual core XTEST pointer id=4 [slave pointer (2)]⎜ ↳ ImPS/2 Generic Wheel Mouse id=11 [slave pointer (2)]$ dmesg |grep PS/2[ 1.140559] i8042: PNP: PS/2 Controller [PNP0303:PS2K,PNP0f03:PS2M] at 0x60,0x64 irq 1,12[ 1.146588] mousedev: PS/2 mouse device common for all mice[ 2.551662] input: ImPS/2 Generic Wheel Mouse as /devices/platform/i8042/serio2/input/input5$ fspc -hFSP not detected.Any patches not helped meI have ubuntu 12.04 amd64 version(In reply to)[...]Booting with FSP_DEBUG and DEBUG enabled driver could help. Otherwise, you may want to boot with i8042.debug=1 to get the full I/O log.I have a MSI CR640 laptop with Sentelic touchpad. It worked well without any scrolling support before 3.4. After upgrading to 3.4, the cursor became jumpy and any scrolling still wasn't working. After applying v3 patch (and modifying one line as said in later comment) from this thread, the cursor doesn't jump, two-finger vertical scrolling partially works (it usually scrolls but when i put finger up, it returns to original position) and edge scrolling doesn't work. I tried changing hscroll attribute in /sys/devices/platform/i8042/serio2, but it didn't do anything.(In reply to)[...]Would you please be more specific about what the 'original position' refersto? For example, if you do a two-finger vertical scrolling from top-most edgeto bottom-most edge, does the cursor returns all-the-way to top-most edge afterfingers moving away? Or does it scrolls back, say, perhaps 1/10 of currentscreen height?Which window manager are you using? In Gnome/Unity configuration menu,two fingers scrolling and edge scrolling are mutual exclusive -- you can onlyhave one of them activated at any given moment. Another possibility of non-working edge scrolling is that pad dimensionsdon't match to your physical hardware. To confirm this, you'll need to loadthe FSP_DEBUG and DEBUG enabled driver(seeand) andthe packet dump will reveal what the max X/Y are when you're putting one fingeron the bottom-right corner.hscroll only works in relative coordinates mode, which doesn't apply to theconfiguration you're running with.(In reply to)I'm sorry, I just used it wrong. I put one finger down and moved another, but I need to move both :)I'm using KWin. Are there any problems or should I try the FSP_DEBUG?(In reply to)Hmm, KDE accepts both scrolling settings being enabled at the same time.I don't know if turning two finger scrolling would make any difference.You can get/set current scrolling state by running synclient or xinput, though: $ synclient | grep Scroll # get current scrolling options $ synclient VertEdgeScroll=1 # enable vertical edge scrolling $ synclient VertTwoFingerScroll=1 # enable vertical two finger scrolling If you don't have the time to rebuild the kernel with FSP_DEBUG, tweakingthe RightEdge parameter probably helps but you'll have to guess the valuesince you don't have the accurate geometric information(which probably isn'tcorrect enough in current driver): $ synclient | grep RightEdge # get the right edge boundary $ synclient RightEdge=?? # reduce the value and see if right edge scrolling can be detectedCreatedv4 patch to filter out bad movementCorrecting typo for the number of fingers in MFMC 1st finger case. v3 patch will generate staggered report(one vs. two fingers) which will confuse the user land.Createdv5 patch to filter out bad movementThis updated patch revert to the original last_mt_fgrs workaround to allowfinger movement after two to one finger transition taking place.Hopefully this addressesas well.I can confirm that the latest patch fixed the issue with two-finger-scroll not working after resuming from suspend. Good job!Createdindeferend i/o log$ dmesg|grep sentel[ 2.474127] psmouse serio2: sentelic: READ REG: 0x00 is 0x00 (rc = -1)$ synclient Couldn't find synaptics properties. No synaptics driver loaded?$ xinput ⎡ Virtual core pointer id=2 [master pointer (3)]⎜ ↳ Virtual core XTEST pointer id=4 [slave pointer (2)]⎜ ↳ ImExPS/2 Generic Explorer Mouse id=11 [slave pointer (2)]⎣ Virtual core keyboard id=3 [master keyboard (2)] ↳ Virtual core XTEST keyboard id=5 [slave keyboard (3)] ↳ Power Button id=6 [slave keyboard (3)] ↳ Video Bus id=7 [slave keyboard (3)] ↳ Power Button id=8 [slave keyboard (3)] ↳ Sleep Button id=9 [slave keyboard (3)] ↳ AT Translated Set 2 keyboard id=10 [slave keyboard (3)]Not working scroll and any touchpad configure utils.Help me please :)Thanks!(In reply to)[...]Missing the 'fc' response.Should be 'fa' instead.[ 2.470551] i8042: [347] 91 -> i8042 (command)[ 2.470766] i8042: [347] f4 -> i8042 (parameter)[ 2.474091] i8042: [348] fa <- i8042 (interrupt, 3, 12)[ 2.474127] psmouse serio2: sentelic: READ REG: 0x00 is 0x00 (rc = -1) It looks to me that EC response is one byte slower. Will there be anydifference if you increase FSP_CMD_TIMEOUT2 from 30 to something larger(ex: 2500)?(In reply to)did not help(In reply to)Please post i8042.debug dump, thanks.Createddmesg log after timeout 2500My dmesg after FSP_CMD_TIMEOUT2=2500 in drivers/input/mouse/sentelic.c and recompileHow far off is this to hit mainline kernel?Even if the patch isn't perfect, shouldn't current improvements be eligible for 3.6?Createdpatch for upstream submissionPatch based on v5 with additional S-O-B and Tested-by tags for Dmitry's review.This patch has not helped me, too. Have to throw the laptop in the trash :((In reply to)[ 2.327464] i8042: [308] 91 -> i8042 (command)[ 2.327733] i8042: [309] 66 -> i8042 (parameter)[ 2.330645] i8042: [309] fe <- i8042 (interrupt, 3, 12)[ 2.330652] i8042: [309] 91 -> i8042 (command)[ 2.330876] i8042: [309] 88 -> i8042 (parameter)[...][ 4.825925] i8042: [934] 91 -> i8042 (command)[ 4.826090] i8042: [934] f3 -> i8042 (parameter)[ 4.829576] i8042: [934] fc <- i8042 (interrupt, 3, 12) According to the above log, driver failed to detect the hardware because command88 timed out. I'm afraid that this patch won't help you as the problem you're running intoseems to be EC related. There are a few MUX error in your log:[ 1.227636] i8042: [33] 90 -> i8042 (command)[ 1.228579] i8042: [33] f2 -> i8042 (parameter)[ 1.233864] i8042: [35] MUX error, status is 25, data is fc[ 1.233875] i8042: [35] fe <- i8042 (interrupt, 2, 12, timeout)[ 1.233931] i8042: [35] 90 -> i8042 (command)[ 1.235031] i8042: [35] ed -> i8042 (parameter)[ 1.240302] i8042: [36] MUX error, status is 25, data is fc[ 1.240313] i8042: [36] fe <- i8042 (interrupt, 2, 12, timeout) Not sure if there are any other i8042 knobs to workaround this problem. PerhapsDmitry can shed some light for us?(In reply to)There are lots of boxes that have iffy MUX implementation, try booting with i8042.nomux to disable the active multiplexing and stay in legacy mode.Thank you!!! After add parameter i8024.nomux, my touchpad works. $ xinput⎡ Virtual core pointer id=2 [master pointer (3)]⎜ ↳ Virtual core XTEST pointer id=4 [slave pointer (2)]⎜ ↳ FSPPS/2 Sentelic FingerSensingPad id=11 [slave pointer (2)]⎣ Virtual core keyboard id=3 [master keyboard (2)] ↳ Virtual core XTEST keyboard id=5 [slave keyboard (3)] ↳ Power Button id=6 [slave keyboard (3)] ↳ Video Bus id=7 [slave keyboard (3)] ↳ Power Button id=8 [slave keyboard (3)] ↳ Sleep Button id=9 [slave keyboard (3)] ↳ AT Translated Set 2 keyboard id=10 [slave keyboard (3)]Pavel, could you please open a separate bug and post output of dmidecode for your box?Hi, is this still actual? when this will get upstream?i've got a Medion Akoya P6631 Laptop with Sentelic Touchpad:$ xinput⎡ Virtual core pointer id=2 [master pointer (3)]⎜ ↳ Virtual core XTEST pointer id=4 [slave pointer (2)]⎜ ↳ FSPPS/2 Sentelic FingerSensingPad id=13 [slave pointer (2)]i also had this erratic movements and jumps to the upper left corner also scrolling didn't work neither edge nor two-finger...i rebuilt this kernel:$ uname -r3.2.0-29-generic-paeby: $ apt-get source linux-image-3.2.0-29-generic-pae $ sudo apt-get build-dep linux-image-3.2.0-29-generic-pae $ cd linux-3.2.0 $ chmod +x debian/scripts/misc/* debian/scripts/* $ debian/rules updateconfigs $ cd drivers/input/mousethen i first applied this patch:as for fsp_drv_ver[] = "1.0.0-K" i had...and afterwards the last patch from this thread $ patch < *.patch $ cd - $ env skipabi=true fakeroot debian/rules binary-generic-pae $ cd .. $ sudo dpkg -i linux-headers-3.2.0-29-generic-pae_3.2.0-29.46_i386.deblinux-image-3.2.0-29-generic-pae_3.2.0-29.46_i386.deb $ sudo rebootafter this my touchpad doesn't has this erratic movements anymore and all options from touchpad settings work except 'disable when typing' and 'sensitivity' i couldn't figure out rightly...but edge scrolling was a bit difficult to hit / unresponsive... so i additionally made this changes:$ synclient | grep Edge LeftEdge = 38 RightEdge = 929 TopEdge = 38 BottomEdge = 673 VertEdgeScroll = 1 HorizEdgeScroll = 1 EdgeMotionMinZ = 30 EdgeMotionMaxZ = 160 EdgeMotionMinSpeed = 1 EdgeMotionMaxSpeed = 96 EdgeMotionUseAlways = 0 AreaLeftEdge = 0 AreaRightEdge = 0 AreaTopEdge = 0 AreaBottomEdge = 0$ synclient RightEdge=900$ synclient BottomEdge=650with this mods my touchpad nearly works perfectly :) thanks a lot!so some minor bugs i have: sometimes it generates a rigth-click or double-click(for marking an area) at scroll beginning and one time it scrolled very very fast but that's all not that problemso i hope i did everything right especially for kernel (like modules or so or as i'm in need of the additional bumblebee driver for nvidia optimus support) but i think everything should be the same as before just with touchpad support? am i right???as last question: how do i make this edge modification remaining after reboot?thanks in advance all the best eliblA patch referencing this bug report has been merged in Linux v3.6-rc7:commit 30ebb7fa0e3e92145b859ad6e44aa6dc636b4103Author: Tai-hwa Liang <>Date: Wed Sep 19 11:10:47 2012 -0700 Input: sentelic - filter out erratic movement when lifting fingerUsing 3.6 final from kernel.ubuntu.com/~kernel-ppa/mainline/ I still have erratic movement with my Sentelic touchpad.It either scrolls to top, scrolls the reverse direction when lifting the fingers, continues scrolling same/reverse direction after lifting the fingers, or flickers intently when trying to hold the fingers still in the middle of a scroll.Is there any kernel change that hasn't been merged yet, any patch that is outside the scope of the kernel, any configuration that needs to be done with synclient or is Ubuntu building their kernels in a way that ignores these fixes?Patrik,Have you tried running with a kernel you patched yourself? If it works, then the issue is probably because Ubuntu somehow ignored the fixes.Is this fix supposed to work also with Sentelic touchpad in UX31?I tried 3.6.5 kernel and it still doesn't work. Even with i8024.nomux kernel parameter.It works however with driver from.it's a pity that this patch is still not applied to mainline cause it's an essential bugfix (for my touchpad) without the use is very annoying.so please ubuntu people/ mainline maintainer submit this patch!!!built now custom kernel 3.5.0 with this patch for ubuntu 12.10for other people with sentelic touchpad just build your own kernel the way i did 5 posts above it should work for the most the same wayall the best(In reply to)Which patch do you mean?I just checked and I guess you seem to mean patch?Can you verify my guess is indeed correct?@Dimitry: the patch I mentioned above indeed is not yet in mainline... Oversight?(In reply to)completely ;)Could someone in charge make a statement which kernel is going to include this patch?Looks like we've got progress.With vanilla version 3.7.1 of the kernel touchpad doesn't work but as a bonus it's not possible to patch it with driver fromcause there are errors during compilation.I'm back to 3.6.0 with mentioned patch.Please could someone summarize the current status of this bugreport?I have a Syntelic touchpad that suffers from a similar problem: scrolling only happens in the corners. No edge scrolling, no two-finger scrolling (Fedora 17, stock kernel 3.6.10).I noticced that you're using the synclient application to control scrolling, however I'm only getting an error:$ synclientCouldn't find synaptics properties. No synaptics driver loaded?Does it mean I have a kernel problem or xorg?I know this might be the wrong place to ask, but I noticed some people here got synclient to work and I don't know a better place.Does anyone know when these patches will be included in mainline kernel?There was the following change applied to mainline:commit a25461659050b913e114d282bf58823682eb56b6Author: Christophe TORDEUX <>Date: Mon Dec 24 09:20:40 2012 -0800 Input: sentelic - only report position of first finger as ST coordinates Report only the position of the first finger as absolute non-MT coordinates, instead of reporting both fingers alternatively. Actual MT events are unaffected. This fixes horizontal and improves vertical scrolling with the touchpad. Cc:Signed-off-by: Christophe TORDEUX <> Signed-off-by: Dmitry Torokhov <>It went into 3.8. If 3.8 still exhibits the bad behavior then we have to look again.For the record it's still pretty annoying on a Fedora 20 w/3.14 kernel.Agreed. This issue is still reproducible on the latest Ubuntu with 3.14 kernel. It's not the horizontal scrolling that was fixed with the commit Dmitry mentions that's bugging me. It's really annoying: on my Zenbook I keep scrolling down with two fingers and sometimes it's scrolling the page all the way to the top instead.Hello guys!I use a Clevo W310CZ laptop with a sentelic touchpad,on Ubuntu 14.04 LTS, and the 3.13.0-30-generic kernel.Using the touchpad is really a pain!It works good some time, then the cursor gets completely mad.I do not think I have the "mouse jumping to upper left corner" already described there. I would rather say that the cursor moves faster and jumps *anywhere* on the screen.WHAT I DID:I disabled every 'DoubleFinger'-like occurence with synclientI also tried to patch the kernel but I think this one (3.13.0-30-generic) already contained the patched part. Below is the original "sentelic.c" as I found it:*** if ((packet[0] == 0x48 || packet[0] == 0x49) && packet[1] == 0 && packet[2] == 0) { /* * Ignore coordinate noise when finger leaving the * surface, otherwise cursor may jump to upper-left * corner. */ packet[3] &= 0xf0; } abs_x = GET_ABS_X(packet); abs_y = GET_ABS_Y(packet);***so, the patch "sentelic.patch" described sooner in this thread does nothing.Question:what more can I try to fix this problem? Does anyone still have this problem with this kernel?Could using an older kernel (eg 3.2) with ubuntu 12.04 help in any way?Thank youHello,I used too a Clevo W310CZ laptop with a sentelic touchpad and ubuntu 14.04.I'm agree with Zigma description : "cursor jumps *anywhere* on the screen"I had to send back my laptop for a refound after a ten-day struggle...I had "i8042.nomux=1 i8042.reset=1" to my GRUB_CMDLINE_LINUX_DEFAULT (/etc/default/grub).erratic jump/selection seems to be less frequently but still present...I use toosynclient PalmMinZ=1synclient PalmMinWidth=1synclient MaxSpeed=1to minimize erratic jump/selection...Generally with regressions as described here the best tool is bisection. I have seen noone attempt that with this bug.I tested ubuntu mainline kernel (linux-headers-3.16.0-031600-generic_3.16.0-031600.201408031935_amd64.deb)Still erratic jump/selection.to complet bug's description : I also found that if I restart the computer when the cursor is crazy, the cursor is blocked in the middle of the screen (only the right click works).I need to reboot several times to have the possibility to move the cursor.I'm afraid that the problems is also in the hardware or firmware level of the touchpad. Because if I restart on Windows (when the cursor is blocked on Ubuntu), the cursor is also blocked in the middle of the screen on Windows.However, if I only use Windows (never boot on Ubuntu), I never have a problem with cursor...
id=73691	ONBOARD SSD has died, never been used, now boot up takes 5 minutes.Attempted to block it with libata.force. Does nothingata:[ 0.000000] Command line: BOOT_IMAGE=/vmlinuz-3.13-1-amd64 root=/dev/mapper/g0-root ro quiet libata.force=2:disable acpi_backlight=vendor[ 0.000000] BIOS-e820: [mem 0x00000000a6fbf000-0x00000000a6ffefff] ACPI data[ 0.000000] Kernel command line: BOOT_IMAGE=/vmlinuz-3.13-1-amd64 root=/dev/mapper/g0-root ro quiet libata.force=2:disable acpi_backlight=vendor[ 0.000000] Memory: 3891500K/4042096K available (4809K kernel code, 693K rwdata, 1620K rodata, 988K init, 952K bss, 150596K reserved)[ 0.062077] perf_event_intel: PEBS disabled due to CPU errata, please upgrade microcode[ 0.201335] _OSC request data:1 1f 0 [ 0.216819] ACPI : EC: GPE = 0x17, I/O: command/status = 0x66, data = 0x62[ 0.660782] Write protecting the kernel read-only data: 8192k[ 0.783414] libata version 3.00 loaded.[ 0.827909] ata1: SATA max UDMA/133 abar m2048@0xc0507000 port 0xc0507100 irq 42[ 0.827912] ata2: SATA max UDMA/133 abar m2048@0xc0507000 port 0xc0507180 irq 42[ 0.827914] ata3: DUMMY[ 0.827916] ata4: SATA max UDMA/133 abar m2048@0xc0507000 port 0xc0507280 irq 42[ 0.827918] ata5: SATA max UDMA/133 abar m2048@0xc0507000 port 0xc0507300 irq 42[ 0.827920] ata6: DUMMY[ 1.147146] ata1: SATA link up 3.0 Gbps (SStatus 123 SControl 300)[ 1.148444] ata1.00: ATA-8: Hitachi HTS545050A7E380, GG2OA610, max UDMA/133[ 1.148454] ata1.00: 976773168 sectors, multi 16: LBA48 NCQ (depth 31/32), AA[ 1.149749] ata1.00: configured for UDMA/133[ 6.509616] ata2: link is slow to respond, please be patient (ready=0)[ 11.159774] ata2: COMRESET failed (errno=-16)[ 16.522235] ata2: link is slow to respond, please be patient (ready=0)[ 21.172402] ata2: COMRESET failed (errno=-16)[ 26.534865] ata2: link is slow to respond, please be patient (ready=0)[ 56.228611] ata2: COMRESET failed (errno=-16)[ 56.228685] ata2: limiting SATA link speed to 1.5 Gbps[ 61.254949] ata2: COMRESET failed (errno=-16)[ 61.255024] ata2: reset failed, giving up[ 61.575095] ata4: SATA link down (SStatus 0 SControl 300)[ 61.895247] ata5: SATA link down (SStatus 0 SControl 300)[ 85.642445] EXT4-fs (dm-1): mounted filesystem with ordered data mode. Opts: (null)[ 127.322928] EXT4-fs (dm-2): mounted filesystem with ordered data mode. Opts: (null)[ 127.459851] EXT4-fs (dm-4): mounted filesystem with ordered data mode. Opts: (null) libata is not getting the parameter at all. Your initrd probably doesn't automatically parse the kernel command line to extract module params. Please consult with your distro on how to specify module params for modules loaded from initrd.If you can build your kernel with libata built-in, this'd be easy to verify. I'm closing the bug as INVALID for now.Thanks.I have confirmed that the 'correct' method is to create a file in /etc/modprobe.d/ with options libata force=2:disableFollowed by updating the initramfs.As seen with:ata2.00: FORCE: horkage modified (disable)(on my virtual machine)HOWEVER...as the original bug reports - disable fails, it does indeed fail to do as intended. (the intention of the author of this patch was for onboard SSD that had failed and soldiered onto the board).My syslog / dmesg reports:ata2: PATA max UDMA/33 cmd 0x1f0 ctl 0x3f6 bmdma 0xd000 irq 14BEFORE the FORCE disables it.The problem with the users machine above, occurs at the ata2: part. BEFORE the disable kicks in. Which it never does, since ata2: reset failed, giving up; kicks in before a device is recognised to be disabled.So basically if libata.force only disables after the probe, i need to know how to disable the probe....Happy for further information to be provided and this bug closed as invalid again, as long as i can get the users machine working as this libata.force is supposed to do...Thanks . .also filed with debian - find more information there if neccessary, or advise on there if debian can do anything different with their kernel, thanks.Set Bug forwarded-to-address to ''. Request was from Ben Hutchings <> to. (Sat, 03 May 2014 19:57:17 GMT) Full text and rfc822 format available.Please note the user tested with arch linux and the same issue, i will happily test with a few different distro's. but any information like, libata.force doesn't disable the probe because, we need a new patch, this is not what libata.force is for. etc would be good. thanksAnthony F. McInerney(In reply to Tejun Heo from)libata.force=2:disable didn't affect slow boot times in my case, but libata.force=rstonce shortened delay from +60 seconds to +8 seconds.I think it proves that initrd parses kernel command line to extract module params, and at least libata.force=rstonce affects system.same problem here, libata.force=2:disable is completely ignored, but libata.force=2:rstonce works fine, and produces the following confirmation in dmesg:[ 0.857339] ata2: FORCE: link flag 0x200 forced -> 0x200when set to disable there is no message, and no effectTested on 3.16.1Okay, just tested libata.force=N:disable and it works as intended. It doesn't inhibit probing. It just disables the device after it's recognized. Using norst can probably avoid delay due to broken devices.Thanks.
id=75291	I'm the original poster of the (5 yo) Ubuntu bug, quoting:"My Acer Aspire 5930G has an internal 5-in-1 card reader. Testing with an SD card (no alternative media available), the reader is only listed by lspci if the SD card is present in the reader at boot time."Reading, I was hoping that kernel 3.12-rc1 and later would fix this issue for me, but unfortunately, it persists with Ubuntu 14.04 (uname -a: Linux razor 3.13.0-24-generic #46-Ubuntu SMP Thu Apr 10 19:11:08 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux) Thanks for reporting this again, Bernhard. I'm embarrassed that nothing has happened in over 5 years.Tasos mentioned () that doing "echo 1 > /sys/bus/pci/rescan" after the card was inserted caused it to be recognized. Does that make any difference on your system?I know the launchpad report has similar logs, but I think they're from older kernels and we've made significant changes since then, so would you mind doing the following? - Boot with SD card in slot - Collect complete "lspci -vv" and dmesg output and attach hereand - Boot with empty SD card slot - Insert SD card - Try "echo 1 > /sys/bus/pci/rescan" - Collect complete "lspci -vv" and dmesg output and attach hereCreateddmesg output with SD card inserted at boot timeCreatedlspci -vv output with SD card inserted at boot timeCreateddmesg output with *no* SD card inserted at boot time, after forced PCI rescanCreatedlspci -vv output with *no* SD card inserted at boot time, after forced PCI rescanBjörn,no need to be embarrassed. I guess I just should've reported this bug upstream earlier instead of waiting for Ubuntu devs to do something about it.Anyway, forcing rescan via "echo 1 | sudo tee /sys/bus/pci/rescan" unfortunately didn't result in the SD card becoming available -- logs attached. (Just doing echo 1 > /sys/bus/pci/rescan gives "Permission denied", as does sudo'ing that command). I also tried sudo sh -c "echo 1 > /sys/bus/pci/rescan" -- doesn't make the SD card available, either.With SD inserted at boot time, the card is available. Logs attached.I used a SanDisk 64 GB SDXC card for testing (exFAT formatted, with required drivers installed via exfat-fuse and exfat-utils Ubuntu packages).Amazingly, updating by BIOS from V1.15 (06/13/2008) to V1.23 (10/28/2008) (as suggested by) did indeed fix this issue for me. Sorry for the noise!(I guess I'm part of a small group of PC owners whose system was shipped with that BIOS version before it was fixed a couple of months later, and who never updated. The strange thing is that the SD card had been properly recognized under Windows before, i.e. using the old BIOS.)I'm setting this to RESOLVED OBSOLETE, hope that's okay.Closing this is fine.It would be better if we could fix this without requiring a BIOS update, since it *does* work with Windows even with the old BIOS. But I don't know how much value there is in doing that.With the new BIOS, is the SD card reader (05:00.0) present all the time, whether a card is inserted or not?Would you mind collecting a new "lspci -vv" output as root? The ones you collected don't show the PCIe capability details. Also, if you could attach an acpidump (see), that would be great.Based on the dmesg, it looks like we're using acpiphp (not pciehp) for the SD card reader. I don't see any hotplug events in the dmesg log, but I don't know whether acpiphp logs anything by default. I added Rafael in case he has any interest in this.I might've started the party too early.Today, the SD isn't working. Maybe last time I hadn't really shut down but rebooted from a state in which I had the SD inserted before, and that lead to a false positive. Now I'm the one who's embarrassed.Anyway, attaching acpidump and sudo lscpci -vv output as requested.Createdsudo lspci -vv outputCreatedsudo acpidump outputCreateddisassembled acpidump (DSDT, all SSDT*)I now tested with 3.15-rc8; unfortunately, the issue's still present.uname -aLinux razor 3.15.0-031500rc8-generic #201406012235 SMP Mon Jun 2 02:36:11 UTC 2014 x86_64 x86_64 x86_64 GNU/LinuxWhat I doe see in dmesg after inserting an SDXC card is:[ 2847.188289] ACPI: \_SB_.PCI0.RP04: ACPI_NOTIFY_BUS_CHECK event[ 2847.188349] ACPI: \_SB_.PCI0.RP04: Bus check in hotplug_event()I wonder if this is related to. Mika, any thoughts on this?Since BUS_CHECK notifications are targeted to the root port (RP04) instead of the host bridge, I think it's not the same issue.Bernhard, can you retry with the 3.15-rc8 (or 3.15) kernel so that you have CONFIG_DYNAMIC_DEBUG=y and "acpiphp.dyndbg=+p" and attach the resulting dmesg here?Sorry for not getting back to this earlier. The reason is that this is only erratically reproducible. I've had a couple of successful tries, but with 3.15-rc8 and 3.15, with the relevant dmesg part being[ 134.436478] ACPI: \_SB_.PCI0.RP04: ACPI_NOTIFY_BUS_CHECK event[ 134.436501] ACPI: \_SB_.PCI0.RP04: Bus check in hotplug_event()[ 134.436589] pci 0000:05:00.0: [197b:2382] type 00 class 0x088000[ 134.436609] pci 0000:05:00.0: reg 0x10: [mem 0x00000000-0x000000ff][ 134.436880] pci 0000:05:00.2: [197b:2381] type 00 class 0x080501[ 134.436897] pci 0000:05:00.2: reg 0x10: [mem 0x00000000-0x000000ff][ 134.437100] pci 0000:05:00.3: [197b:2383] type 00 class 0x088000[ 134.437116] pci 0000:05:00.3: reg 0x10: [mem 0x00000000-0x000000ff][ 134.437316] pci 0000:05:00.4: [197b:2384] type 00 class 0x088000[ 134.437334] pci 0000:05:00.4: reg 0x10: [mem 0x00000000-0x000000ff][ 134.444053] pci 0000:05:00.0: BAR 0: assigned [mem 0xf4000000-0xf40000ff][ 134.444061] pci 0000:05:00.2: BAR 0: assigned [mem 0xf4000100-0xf40001ff][ 134.444068] pci 0000:05:00.3: BAR 0: assigned [mem 0xf4000200-0xf40002ff][ 134.444073] pci 0000:05:00.4: BAR 0: assigned [mem 0xf4000300-0xf40003ff][ 134.444101] pci 0000:05:00.0: no hotplug settings from platform[ 134.444116] pci 0000:05:00.2: no hotplug settings from platform[ 134.444130] pci 0000:05:00.3: no hotplug settings from platform[ 134.444144] pci 0000:05:00.4: no hotplug settings from platform[ 134.501114] jmb38x_ms 0000:05:00.3: enabling device (0000 -> 0002)[ 134.536601] sdhci: Secure Digital Host Controller Interface driver[ 134.536604] sdhci: Copyright(c) Pierre Ossman[ 134.551997] sdhci-pci 0000:05:00.0: SDHCI controller found [197b:2382] (rev 0)[ 134.552026] sdhci-pci 0000:05:00.0: enabling device (0000 -> 0002)[ 134.552121] mmc0: no vqmmc regulator found[ 134.552122] mmc0: no vmmc regulator found[ 134.552209] mmc0: SDHCI controller on PCI [0000:05:00.0] using ADMA[ 134.552229] sdhci-pci 0000:05:00.2: SDHCI controller found [197b:2381] (rev 0)[ 134.552239] sdhci-pci 0000:05:00.2: enabling device (0000 -> 0002)[ 134.552273] sdhci-pci 0000:05:00.2: Refusing to bind to secondary interface.[ 134.841018] mmc0: new SDXC card at address aaaa[ 134.857378] mmcblk0: mmc0:aaaa SU64G 59.4 GiB [ 134.858587] mmcblk0: p1Just now, I'm running on 3.15-rc8 (and haven't unfortunately set acpiphp.dyndbg=+p upon booting), and the SD card isn't shown upon insertion; dmesg, again, is only[ 134.436478] ACPI: \_SB_.PCI0.RP04: ACPI_NOTIFY_BUS_CHECK event[ 134.436501] ACPI: \_SB_.PCI0.RP04: Bus check in hotplug_event()I believe that it't rather likely to work if I try it shortly after bootup, and rather unlikely after a longer uptime. One thing I'll try to track down is if it's related to this laptop's hardware bluetooth button (whose state isn't stored when shutting down, so I usually turn it off intuitively shortly after bootup. Just turning it on again right now didn't cause the SD to be recognized, however.)I should probably permanently add acpiphp.dyndbg=+p to my kernel boot arguments...Createdacpiphp debug patchCan you try with the attached patch (and acpiphp.dyndbg=+p)? It adds more debug to the acpiphp driver which could shed some light into this. Please attach the complete dmesg.(the patch applies on top of v3.15).CreatedOutput logs from dmsg, lspci and acpidump commandsHi.This problem stills happening today. I'm using a Debian Sid (unstable) fully updated and I got the same behaviour: It reads the card if I boot it with, but can't find it if there wasn't any sd card in the boot time. In windows it works normal, and the sdcard chipset is also Jmicron.```$ uname -aLinux bunsen 4.7.0-1-amd64 #1 SMP Debian 4.7.2-1 (2016-08-28) x86_64 GNU/Linux```With `CONFIG_DYNAMIC_DEBUG=y and acpiphp.dyndbg=+p` appended to kernel boot, I did the following commands and saved the output:```dmesg >> card.dmesg.outdmesg -k >> card.dmesg-k.outsudo lspci -vv >> card.lspci-vv.outsudo acpidump > card.acpidump.out```The first run `card.*` I did after a boot with a card at boot time.The `nocard.*` logs I did after boot the system without any card. Then I inserted a card, and save the logs as `postcard.*`. Then after the `echo 1 > /sys/bus/pci/rescan` command, I saved it as `postcard-rescan.*`.I attached the jmicron.tar.xz to this thread with all this files. The acpidump command if from Debian sid package `acpica-tools`. I did not tryied the patch in this list yet.
id=97101	In the default configuration by Fedora 21, I experience close to 100% packet loss when trying to use my wifi with Intel Centrino Advanced-N 6205 [Taylor Peak] while using bluetooth 4.0 audio while at the same time. Also, the bluetooth connection times out really often.However, if I load iwlwifi with 11n_disabled=1, I don't even get any noticeable slow down or bluetooth drop outs.Therefore, either this conflict should be fixed (I suppose it's some sort of driver bug since both bluetooth and wifi use that chip at the same time I guess?) or bluetooth activation should auto-disable the n-standard of the wifi for this particular chip.I'm not entirely sure the bluetooth actually uses this chip as well, if not this bug report is probably wrong. This is my lspci output:jonas@cyberman#8: lspci00:00.0 Host bridge: Intel Corporation 2nd Generation Core Processor Family DRAM Controller (rev 09)00:02.0 VGA compatible controller: Intel Corporation 2nd Generation Core Processor Family Integrated Graphics Controller (rev 09)00:16.0 Communication controller: Intel Corporation 6 Series/C200 Series Chipset Family MEI Controller #1 (rev 04)00:19.0 Ethernet controller: Intel Corporation 82579LM Gigabit Network Connection (rev 04)00:1a.0 USB controller: Intel Corporation 6 Series/C200 Series Chipset Family USB Enhanced Host Controller #2 (rev 04)00:1b.0 Audio device: Intel Corporation 6 Series/C200 Series Chipset Family High Definition Audio Controller (rev 04)00:1c.0 PCI bridge: Intel Corporation 6 Series/C200 Series Chipset Family PCI Express Root Port 1 (rev b4)00:1c.1 PCI bridge: Intel Corporation 6 Series/C200 Series Chipset Family PCI Express Root Port 2 (rev b4)00:1c.3 PCI bridge: Intel Corporation 6 Series/C200 Series Chipset Family PCI Express Root Port 4 (rev b4)00:1c.4 PCI bridge: Intel Corporation 6 Series/C200 Series Chipset Family PCI Express Root Port 5 (rev b4)00:1d.0 USB controller: Intel Corporation 6 Series/C200 Series Chipset Family USB Enhanced Host Controller #1 (rev 04)00:1f.0 ISA bridge: Intel Corporation QM67 Express Chipset Family LPC Controller (rev 04)00:1f.2 SATA controller: Intel Corporation 6 Series/C200 Series Chipset Family 6 port SATA AHCI Controller (rev 04)00:1f.3 SMBus: Intel Corporation 6 Series/C200 Series Chipset Family SMBus Controller (rev 04)03:00.0 Network controller: Intel Corporation Centrino Advanced-N 6205 [Taylor Peak] (rev 34)0d:00.0 System peripheral: Ricoh Co Ltd PCIe SDXC/MMC Host Controller (rev 07)jonas@cyberman#8: This chip doesn't support Bluetooth.Ok, the bluetooth device is this one apparently: Broadcom Corp. BCM2045B (BDC-2.1)It's connected through the usb hub internally which is why it's not listed on lspci but only lsusb.Nevertheless, the intel wifi chip's n-standard results in great conflicts with the bluetooth when enabled. Maybe the broadcom chip still transmits through the intel one? (I heard that is sometimes the case in modern laptops, bt and wifi using the same chip to transmit)Anyway, you'll probably know a lot better what the potential problem is here. I can only tell disabling n wifi helps, and therefore maybe that should be done automatically.There is no communication between the 2 chips. Nothing can be done here.There is an obvious problem: wifi stops working when bluetooth is enabled when those two chips are combined in a laptop.There is at least one possible obvious solution: auto-disable the n-standard through the kernel driver as soon as bluetooth is used.And you say nothing can be done? Are you saying implementing such behavior in the kernel would be impossible? That seems very unlikely. (disclaimer: I'm not a kernel developer myself.)Reopening with a better title that involves both chips, because the issue still appears to be real, no matter how not nice the first proposal of a fix might be.Unless this is limited to my machine of course - I'd be happy to see other people reporting who have a similar machine... I have a Thinkpad X220 here with the listed intel centrino wifi and broadcom bluetooth chip.Intel can't do much here. Removing Intel. You can ask for support from Broadcom. Good luck.Due to Emmanuel's suggestion that this should maybe be fixed on the Broadcom/Bluetooth side of things, changing component to "Bluetooth".Problem in a nutshell:* iwlwifi 11n_disabled=0 with Centrino Advanced-N 6205 gets greatly shaken by BCM2045B A2DP audio connections (wifi almost stops working entirely, it's like a 56kbps modem)* iwlwifi 11n_disabled=1 with Centrino Advanced-N 6205 coexists nicely with the bluetooth, however, that is not the default.Well I no longer have the specific hardware in question...This component does have a kernel maintainer though, right?
id=46951	After commit a424948dde8421089826e2f782d0efe9e565707e (see below), and now still in Kernel 3.4.10, USB will not work at all when the power controls of the according PCI device and in the usb subdirectory are set to "auto".For example:echo auto > /sys/devices/pci0000:00/0000:00:1a.7/power/controlecho auto > /sys/devices/pci0000:00/0000:00:1a.7/usb1/power/controlIt also only stops working when *both* are set to "auto". This is also triggered when using the "tunables" in the powertop program, and maybe by default in some distributions.Tested on a Fujitsu Lifebook T2020.If this behavior is not a specific hardware related issue in this notebook, the commit should maybe get reverted?I already reported this to LKML a while ago but did get no reply, so bugzilla is probably a better place to report it.I bisected to find exactly this commit to be the issue:a424948dde8421089826e2f782d0efe9e565707e is the first bad commitcommit a424948dde8421089826e2f782d0efe9e565707eAuthor: Rafael J. Wysocki <>Date: Sun Nov 6 22:21:46 2011 +0100 PCI/ACPI/PM: Avoid resuming devices that don't signal PME Modify pci_acpi_wake_dev() to avoid resuming PME-capable devices whose PME Status bits are not set, which may happen currently if several devices are associated with the same wakeup GPE and all of them are notified whenever at least one of them signals PME. Signed-off-by: Rafael J. Wysocki <> Signed-off-by: Jesse Barnes <>:040000 040000 bd5d78ae9ff2b75713725ed6e16d997b0017937df801b576ab380baa48b8c19523323aa6cca0b8cb M drivers Probably this specific device needs to be blacklisted if we can't find an easy cure for itThis is still in 3.7.1Great, everything seems to work again in 3.7.4! This was maybe from one of the PCI changes in 3.7.2 (maybe 0635ca9a8069d8b12debcf0e99cab47a5437997f ? I didn't check..) But probably not important, as it works again. Thanks!Sorry this was a false positive, I have to reopen. The situation only changed. It seems now that the specific USB ports occupied with a device at bootup seem to stay in working condition, even if later power management is activated for them and different devices get unplugged/replugged on that port.
id=86861	1. Installed Gateway RTL8185L 802.11ABG Mini PCI wifi card into a Fujitsu Stylistic ST4121 replacing its Mini PCI combo modem & prism2 wifi device.2. Power on, Debian boots (3.16-2-686-pae), but system is frozen before graphical login.3. No SysRq response (from vendor Infrared keyboard, don't have a wired keyboard handy).4. Hold power until device shuts off.5. Boot Debian rescue mode is not frozen6. Add blacklist rtl818x_pci via /etc/modprobe.d/ to get into multi-user.After reboot into normal multi-user mode :# modprobe rtl818x_pci[24260.769593] ieee80211 phy1: Selected rate control algorithm 'minstrel_ht'[24260.771547] ieee80211 phy1: hwaddr 00c0a8d7232b, RTL8185vD + rtl8225# lspci01:0d.0 Ethernet controller: Realtek Semiconductor Co., Ltd. RTL-8185 IEEE 802.11a/b/g Wireless LAN Controller (rev 20) Subsystem: Realtek Semiconductor Co., Ltd. Device 8225 Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV+ VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Latency: 64 (8000ns min, 16000ns max), Cache Line Size: 32 bytes Interrupt: pin A routed to IRQ 5 Region 0: I/O ports at 2400 [size=256] Region 1: Memory at e0201400 (32-bit, non-prefetchable) [size=512] Capabilities: [50] Power Management version 2 Flags: PMEClk- DSI- D1+ D2+ AuxCurrent=375mA PME(D0-,D1+,D2+,D3hot+,D3cold+) Status: D0 NoSoftRst- PME-Enable- DSel=0 DScale=0 PME- Kernel driver in use: rtl818x_pci# iwconfigwlan0 IEEE 802.11bg ESSID:off/any Mode:Managed Access Point: Not-Associated Tx-Power=0 dBm Retry short limit:7 RTS thr:off Fragment thr:off Encryption key:off Power Management:on# ifconfig wlan0 upSystem immediately deadlocks, no messages from the kernel.I have verified that the hardware works via ndiswrapper and a suitable RTL8185L driver for Windows XP platform. Temporary workaround is to #include <linux/delay.h> and then stuff 'udelay(2);' into all of the io functions in drivers/net/wireless/rtl818x/rtl8180/rtl8180.hDriver loads, works correctly with some light load testing.How to determine where the timing is falling over?For what it's worth, this is a bug in GCC 4.9.1 and not the linux kernel. Recompiled with -O0 and works great.Maybe it is not a bug in GCC. Also happens with gcc 4.8.3 as compiler. How to debug?Hello,Thank you for reporting this.It doesn't really semms a GCC bug. As you have find out, this problem is somewhat tining-sensitive. Adding explicit delays or disabling GCC optimizations has probably the same effect: delaying things..When timings in the order of uS matters, then a lot of things may play a role.Recently the rtl818x driver got a lot of modifications. Have you ever tried with a older kernel (say 3.13)?If it worked then it could be a bug introduced with recent patches (or they just made arose an hidden timing problem). If it didn't then I can exclude those patches.Indeed I have another report about a system crash like yours that happens with older kernel. I couldn't ever end up with any soulution.. Maybe your discover about IO delays have finally enlighed things a bit :)Actually I think the vendor driver implements 20us delays on all MMAP write accessors. I thought this was just conservative for whose write accesses that might require delay (for example RF/BB access), but I didn't tought the HW could crash the whole system.. (I'm thinking about the HW hitting some weird internal condition that causes the HW itself to mess the PCI bus).AFAIK the kernel IO accessors guareantee access ordering wrt themselfes and I took some care to put memory barriers where IO accesses should be ordered wrt to DMA memory. It is still possible I missed something here, or that some PCI posting issue is tricking things, but indeed the problem could be really a true HW requirement not to see IO accesses too fast after writing some register. BTW I'll give a colser look to the code double-checking barriers and related things..Maybe it could also worth to try adding explicit delays only to write accesses where it is reasonable to think some clocking resynchronization is involved inside the ASIC. This likely means where BB and possibly Analog frontend and RF interface registers are accessed.If this won't work then probably we have not enough information about the HW in order to infer what it is actually needed to delay, and we probably cannot do something rellay better than really place delays in all write accessors as in the reference driver. Maybe the register writes in the ISR handler might be the only ones that I could still try to save..I will come out with some experimental patches as soon as I have time..AndreaCompiled mainline linux kernel 3.13 and tested. Confirm loading rtl8180.ko is okay but it then does crash on "ifconfig wlan up". Now back to 3.16-3 (3.16.15 debian).cd $LINUXSRC && make EXTRA_CFLAGS="-g -I$(pwd)/drivers/net/wireless/rtl818x" -C /lib/modules/$(uname -r)/build M=$(pwd) drivers/net/wireless/rtl818x/rtl8180/rtl818x_pci.koGood: rtl8180.h after every iowriteNN() is ndelay(20)Good: rtl8180.h unmodified, all source calling rtl818x_iowriteNN() insert ndelay(20) after every callBad: rtl8180.h after every iowriteNN() is ndelay(20), rtl8225.c:rtl8225_rf_stop replace all iowriteNN calls to avoid ndelay. Deadlocks immediately on "ifconfig wlan0 down", consistently.Good: rtl8180.h after every iowriteNN() is ndelay(20), rtl8225.c:rtl8225_rf_stop replace all rtl818x_iowriteNN calls to avoid ndelay, add ndelay(20) after each iowriteNN call.I went through the source, one subroutine at a time and A/B compare "insmod; ifconfig up; ifconfig down; rmmod" with ndelay after every iowrite call and without those calls per function. This amounts to guesswork because I don't understand anything about memory boundries i.e.I suspect problems with at least rtl8225.c:rtl8225_rf_init and rtl8225.c:rtl8225_rf_stop.Thank you a lot for your work!Your test "Bad: rtl8180.h after every iowriteNN() is ndelay(20), rtl8225.c:rtl8225_rf_stop replace all iowriteNN calls ..." is probably the most interesting.If you have let untouched the iowriteNN in rtl8225_write (they still had delays because of modified iowriteNN in rtl8180.h), that is called in rtl8225_rf_stop, then I'd focus on ANAPARAM registers write procedure.As you can see in the code, the procedure for writing ANAPARAM registers involves the actual ANAPARAM register iowrite operation itself, as well as two nested "unlock/re-lock" operations:Unlocking ANAPARAM registers (in order to be able to write them) is achieved by writing CONFIG3 register; unlocking CONFIG3 register is achieved by writing EEPROM_CMD register.Perahps after the unlock operation, before writing the unlocked register, and/or before re-locking, the delay is needed. (Obviously this is just a speculation..) For writing ANAPARAM registers there are utility functions rtl8180_set_anaparam and rtl8180_set_anaparam2. Changing rtl8225_rf_init and rtl8225_rf_stop in order to use those utility functions is indeed shomething that I should had done earlier.. I'm preparing a patch to do this. I will attach here soon.Once applied that patch, it is easy to put delays in rtl8180_set_anaparam and rtl8180_set_anaparam2 and see whether this fix the problem. I will prepare a patch also for this soon.If this is not enough to fix the problem, then maybe the issue happens when unlocking/writing/locking CONFIGX registers (I'm still speculating..). There are probably other places where this is done other than whose related to ANAPARAM registers write.I can eventually try also putting delays every time CONFIGX registers are written. I will eventually prepare a patch for this also.Createdfix rtl8225.c to use aux functions for anaparam writeThis is against 3.16.3.With this patch applied it is easier to test delays in ANAPARAM writing code.(I'll probably also rebase and push to mainline as it also reduce duplicated code and make code cleaner..)Createdadd delays in anaparam write functionsThis can me applied on top of my previous patch I just posted here. It is an _experimental_ patch to see if the problem has to do with the card messing up the PCI bus whenever ANAPARAM registers are written without delays.This adds delays in the following places:- after unlocking anaparam regs, before writing them- after writing anaparam regs, before locking them again.If this turns out to help with the problem, then it's probably worth to try adding also dummy register reads to force PCI posting.Yes, I confirm "[patch] add delays in anaparam write functions" seems to help.Process for this:1. apply "[patch] fix rtl8225.c to use aux functions for anaparam write"2. change rtl8180.h copy and modify rtl818x_iowriteNN routines i.e. +static inline void rtl818x_iowrite32_nd(struct rtl8180_priv *priv,+ __le32 __iomem *addr, u32 val)+{+ iowrite32(val, addr);+}+ static inline void rtl818x_iowrite8(struct rtl8180_priv *priv, u8 __iomem *addr, u8 val) { iowrite8(val, addr);+ ndelay(20); }3. verify driver will load and operate normally with added delay this way (yes, it does operate normally)4. modify anaparam* routines that will be touched by "[patch] add delays in anaparam write functions" to use non-delay *_nd routines5. verify driver now fails at "ifconfig wlan0 up" (yes, hard lock-up of kernel)6. apply udelay(20) as directed by "[patch] add delays in anaparam write functions"7. verify driver will now load and operate normally (Yes, with limited testing it does appear to work again).Hello,Thank you for this tests.Your report seems to confirm that delay after writing anaparam is required, but, because you still kept some other delays in IO accessors, we still don't know if waiting only after writing anaparams is enough to avoid the crash.Can you please try to apply the patches keeping IO accessors in rtl8180.h without any delays to see what happens ? This way the only added delays will be those introduced by the patch "add delays in anaparam write functions".If this is not enough (system still crashes) then I will prepare another patch to add delays also after unlocking CONFIGX registers.Thank youAndrea(In reply to Andrea Merello from)I forgot to say, that the delays are needed or else it does crash.To be sure, I tried again now adding a new patch to my steps inreverting the changes to rtl8180.h and use of *_nd in dev.c; the module inserts as usual but there is a hardlock crash when "ifconfig wlan0 up". I guess the changes in anaparam routines are helpful but there are more troubles still.Ah, OK.I'm going to attach another patch, to be applied in top of those two, that adds also delays surrounding the CONFIGX registers unlocks.Can you please try this?Createdadd dealyts when locking/unlocking CONFIGX regsApplied, "ifconfig wlan0 up" success now. Starting network-manager to bring up connection to home wifi network, and system freeze happens. Last output at printk 10 logging level:[ 1914.016566] IPv6: ADDRCONF(NETDEV_UP): wlan0: link is not ready[ 1935.862172] wlan0: authenticate with xx:xx:xx:xx:xx:xx[ 1935.924098] wlan0: send auth to xx:xx:xx:xx:xx:xx (try 1/3)What is next to try?Hello,Sorry for the huge delay, these are quite busy months for me :(I'm starting to suspect that delays are potentially needed everywere :(Anyway before give up I first of all need to check code again and see if I'm missing something. I will do as soon as I have some spare time.Your last log shown that the crash happens also when the card has been fully initialized.. I think that when the association procedure is ongoing, the driver shouldn't do particular things that may specifically need delays.During this procedure the driver should mainly deal with interrupt status register and DMA kick register.Maybe it could have some callback invoked to configure contention window, IFS* registers, and things like those. But these are all MAC-related stuff.. This seems to refute my initial supposition about interal ASIC busses and reclocking..That's might be more likely a "simplier" ASIC PCI interface problem, loosely related to other ASIC internal things...Maybe it's some weird incompatibilty with the chipset or something like that..Well, I will check the code again and eventually (hopefully) I will come back with other patches, but I'm starting to think that we might have to introduce delays in all write accessors like the reference driver does..Andrea
id=12016	Latest working kernel version: was never workingEarliest failing kernel version: was never workingDistribution: Debian testingHardware Environment: Leadtek Winfast DTV dongle (both variant)Software Environment: vanilla kernelProblem Description:listicka@Listik:~$ tzap -Hx "CT 24"using '/dev/dvb/adapter0/frontend0' and '/dev/dvb/adapter0/demux0'reading channels from file '/home/listicka/.tzap/channels.conf'tuning to 730000000 Hzvideo pid 0x0301, audio pid 0x0311FE_HAS_LOCKFE_HAS_LOCKstatus 07 | signal 72% | snr 0% | ber 2097151 | unc 0 | status 1f | signal 71% | snr 0% | ber 0 | unc 0 | status 1f | signal 71% | snr 0% | ber 0 | unc 0 | Steps to reproduce: Closing as obsolete, if this is seen against a recent kernel please updateAlan this issue is still valid and not fixed even in latest 3.3 kernels!As Alan is stating I would close if this bug is not being updated ortested against newer kernels.Thanks Nick
id=59181	Hi,I'm have notebook hp pavilion sleekbook 15, with ralink rt3290 wireless card.Card works well, but LED is lit constantly, regardless of the connection status.In the directory / sys / class / leds / I found the following directories:rt2800pci-phy1 :: assoc rt2800pci-phy1 :: quality rt2800pci-phy1 :: radioBut echo '0' > brightness of any of these directories does not change the status of the LED.An attempt to write a value to the file trigger after a while resulting in a kernel panic. Createdlspci -vvnnCreateddmesgIs this still a problem on updated kernels ?I don't know. I no more have this cardOk, closing as obsolete.(In reply to Stanislaw Gruszka from)Yes, I still have this problem
id=16058	CreatedThe boot process captured from a serial consoleAs of 2.6.27 if any SCSI disk is attached that has been formatted with a 256 byte sector size, the boot process hangs. 512, 768, and 1024 byte sector disks do not seem to trigger this. The disks in use do NOT have a partition table. They are being used by out applications via the sg_io interface only.A 2.6.26.8 kernel works fine. I have bisected this problem to the following commit:# git bisect good427e59f09fdba387547106de7bab980b7fff77be is first bad commitcommit 427e59f09fdba387547106de7bab980b7fff77beAuthor: James Bottomley <>Date: Sat Mar 8 18:24:17 2008 -0600 [SCSI] make use of the residue value USB sometimes doesn't return an error but instead returns a residue value indicating part (or all) of the command wasn't completed. So if the driver _done() error processing indicates the command was fully processed, subtract off the residue so that this USB error gets propagated. Cc: Alan Stern <> Signed-off-by: James Bottomley <>:040000 040000 d3bad84ebe1bc231e8e7d6267907ca62fd4d0dcdc85f8cb8bd4910724f0101e41054555980727e16 M driversNow, what USB has to do with my SCSI disks is beyond me. I have afeeling that this commit is just uncovering another problem. I've attacheda bootlog from a serial console that ends where the boot hangs.The does the same thing on a 2.6.34 kernel. Anything I can do to help, I'm available.Thanks and regardsMark On Thu, 27 May 2010, Andrew Morton wrote:I'd guess that this has nothing to do with the sector size. Insteadthe drive probably reports a non-zero residue when it shouldn't. Canyou add some debugging printk's to the patch to find out in more detailwhat's going wrong?Alan SternOn Thu, 27 May 2010, Mark Hounschell wrote:I'd do 2.6.27 first, since that's where the problem started. Then move on to 2.6.34. There may be two different problems.Alan SternOn 05/27/2010 04:30 PM, Alan Stern wrote:Yes, I can. But first let me ask, since reverting this patch on at least2.6.32 - 2.6.34 does not help, would it possibly be better if I did alittle more work to find out where it stops working with the above patchreverted or not?MarkOn Fri, 28 May 2010, Mark Hounschell wrote:Probably not hung, just doing a lot of retries. It should time out eventually, but it might take a long time (perhaps as long as 15 minutes). The combination of the block layer and the SCSI layer isn't very good at knowing when to give up.I don't know the answer to any of these questions. They could well bedue to bugs in the driver, and I know nothing about how the aic7xxxdriver works. You should talk to someone who does.In the meantime, you can track this down a little farther by addingprintk's to the appropriate places in drivers/scsi/sd.c. Look atsd_prep_fn() to see why there's 2048 bytes instead of 4096.Alan SternOn 05/27/2010 04:30 PM, Alan Stern wrote:>>>>Alan,I've added some printks in scsi.c and aic7xxx_core.c.A TUR:ahc_calc_residual: Enteredahc_calc_residual: return Case 2 sgptr = 0x00000001ahc_calc_residual: Enteredahc_calc_residual: return Case 5-1 resid = 0xeahc_calc_residual: return Case 5-2 resid = 0xescsi_finish_command: Entered for cmd(6):0x00 0x00 0x00 0x00 0x00 0x00cmd->result = 0x08000002good_bytes = 0x0scsi_finish_command: CompleteAnother TUR:scsi_finish_command: Entered for cmd(6):0x00 0x00 0x00 0x00 0x00 0x00cmd->result = 0x00000000good_bytes = 0x0scsi_finish_command: CompleteA Read Capicity:scsi_finish_command: Entered for cmd(10):0x25 0x00 0x00 0x00 0x00 0x000x00 0x00 0x00 0x00cmd->result = 0x00000000good_bytes = 0x8scsi_finish_command: Completesd 8:0:0:0: [sde] 7260582 256-byte hardware sectors (1859 MB)A Mode Sense:scsi_finish_command: Entered for cmd(6):0x1a 0x00 0x3f 0x00 0x04 0x00cmd->result = 0x00000000good_bytes = 0x4scsi_finish_command: Completesd 8:0:0:0: [sde] Write Protect is offAnother Mode Sense:scsi_finish_command: Entered for cmd(6):0x1a 0x00 0x08 0x00 0x04 0x00cmd->result = 0x00000000good_bytes = 0x4scsi_finish_command: CompleteAnother Mode Sense:ahc_calc_residual: Enteredahc_calc_residual: return Case 5-1 resid = 0x8ahc_calc_residual: return Case 5-2 resid = 0x8scsi_finish_command: Entered for cmd(6):0x1a 0x00 0x08 0x00 0x20 0x00cmd->result = 0x00000000good_bytes = 0x20scsi_finish_command: Completesd 8:0:0:0: [sde] Write cache: disabled, read cache: enabled, supportsDPO and FUAAnother TUR:scsi_finish_command: Entered for cmd(6):0x00 0x00 0x00 0x00 0x00 0x00cmd->result = 0x00000000good_bytes = 0x0scsi_finish_command: CompleteAnother Read Capacity:scsi_finish_command: Entered for cmd(10):0x25 0x00 0x00 0x00 0x00 0x000x00 0x00 0x00 0x00cmd->result = 0x00000000good_bytes = 0x8scsi_finish_command: Completesd 8:0:0:0: [sde] 7260582 256-byte hardware sectors (1859 MB)Another Mode Sense:scsi_finish_command: Entered for cmd(6):0x1a 0x00 0x3f 0x00 0x04 0x00cmd->result = 0x00000000good_bytes = 0x4scsi_finish_command: Completesd 8:0:0:0: [sde] Write Protect is offAnother Mode Sense:scsi_finish_command: Entered for cmd(6):0x1a 0x00 0x08 0x00 0x04 0x00cmd->result = 0x00000000good_bytes = 0x4scsi_finish_command: CompleteAnother Mode Sense:ahc_calc_residual: Enteredahc_calc_residual: return Case 5-1 resid = 0x8ahc_calc_residual: return Case 5-2 resid = 0x8scsi_finish_command: Entered for cmd(6):0x1a 0x00 0x08 0x00 0x20 0x00cmd->result = 0x00000000good_bytes = 0x20scsi_finish_command: Completesd 8:0:0:0: [sde] Write cache: disabled, read cache: enabled, supportsDPO and FUAAnother TUR:scsi_finish_command: Entered for cmd(6):0x00 0x00 0x00 0x00 0x00 0x00cmd->result = 0x00000000good_bytes = 0x0scsi_finish_command: CompleteAnother Read Capacity:scsi_finish_command: Entered for cmd(10):0x25 0x00 0x00 0x00 0x00 0x000x00 0x00 0x00 0x00cmd->result = 0x00000000good_bytes = 0x8scsi_finish_command: Completesd 8:0:0:0: [sde] 7260582 256-byte hardware sectors (1859 MB)Another Mode Sense:scsi_finish_command: Entered for cmd(6):0x1a 0x00 0x3f 0x00 0x04 0x00cmd->result = 0x00000000good_bytes = 0x4scsi_finish_command: Completesd 8:0:0:0: [sde] Write Protect is offAnother Mode Sense:scsi_finish_command: Entered for cmd(6):0x1a 0x00 0x08 0x00 0x04 0x00cmd->result = 0x00000000good_bytes = 0x4scsi_finish_command: CompleteAnother Mode Sense:ahc_calc_residual: Enteredahc_calc_residual: return Case 5-1 resid = 0x8ahc_calc_residual: return Case 5-2 resid = 0x8scsi_finish_command: Entered for cmd(6):0x1a 0x00 0x08 0x00 0x20 0x00cmd->result = 0x00000000good_bytes = 0x20scsi_finish_command: Completesd 8:0:0:0: [sde] Write cache: disabled, read cache: enabled, supportsDPO and FUAFirst READ(10): sde:ahc_calc_residual: Enteredahc_calc_residual: return Case 5-1 resid = 0x800ahc_calc_residual: return Case 5-2 resid = 0x800scsi_finish_command: Entered for cmd(10):0x28 0x00 0x00 0x00 0x00 0x000x00 0x00 0x08 0x00cmd->result = 0x00000000good_bytes == old_good_bytes = 0x800 scsi_get_resid(cmd) = 0x800New good_bytes = 0x0scsi_finish_command: CompleteFrom here it just keeps repeating this read of 8 blocks. (2048 bytes) soit looks like the machine is hung.Now, I know for a fact that _if_ this read CDB is actually being sent tothe drive, it's actual residual count will be zero. These are workingdisks and that read CDB is valid.Why is ahc_calc_residual saying that the residual count is as though theread never took place? I noticed that the first read on all the SATAdrives was for 4096 bytes, why is this one only 2048? Should it havebeen 4096 and ahc_calc_residual assume that?BTW, I'll be in and out all day today so I may not be able to respondquickly.One thing all these machines I have doing this, have in common, is thescsi controller (Aic7xxx).RegardsMarkReply-To:On Fri, 2010-05-28 at 10:58 -0400, Alan Stern wrote:Actually, I think this is a partition read. Each partition managertends to read a page through the page cache. If we get an error, weseem to re-read to fill the cache.I'll take this one ... although we're a bit lacking in documentation forthis driver.I think the 2048 is because something is hardcoded to think 8 sectors isa page.JamesOn 05/28/2010 12:34 PM,wrote:>>>>>>>>>>Your probably right. But is a 256 byte sector really a supported sectorsize for a linux fs on a SCSI disk? When it sees a 768 byte sector disk,it says it's an unsupported size and goes on with the boot processwithout even doing a read for a partition table. Should maybe it bedoing the same for a 256 byte sector disk???RegardsMarkReply-To:On Fri, 2010-05-28 at 15:29 -0400, Mark Hounschell wrote:In theory the block layer can support any power of two sector size (orreally any sector size which is a divisor of the page size). We had ause for 256 byte sectors once, so they're in SCSI. In practice, sincethey're so rare, the code paths are never tested (as you found out) andthere's a more annoying problem which is since the linux base sectorsize is 512, you have to multiply to get from 256 to 512 ... for allother sector sizes you have to divide, so any conversion routine thatonly right shifts would get this wrong.that's because 768 isn't a power of 2, so it's completely unsupportable.Possibly ... I don't know what the 256 byte sector support was for ...all I know is that whatever it was, I don't have one.JamesOn 05/28/2010 04:25 PM, James Bottomley wrote:>from the fdisk man page: -b sectorsize Specify the sector size of the disk. Validvalues are 512, 1024, 2048 or 4096. (Recent kernels know the sectorsize. Use this only on old kernels or to override the kernel's ideas.)So how does one create a linux fs on a 256 byte sectored disk?>>Back in the old days, almost any scsi disk could be formatted with a 256byte sector. At one time it probably made since to support it. But tryto find one that supports that sector size today.In any case, if you can't even partition a 256 byte sector scsi disk inlinux, why would the kernel still claim it supports that format?RegardsMarkOn 05/30/2010 07:51 AM, Mark Hounschell wrote:>>>>>In fact, the attached patch works for me. However, if you wish to pursuefunctional 256 byte sector support, I have plenty of these disks andwill be happy to test what ever you come up with. Not a lot I can reallydo without fdisk support though. Even so, I'm all ears???RegardsMarkReply-To:On Mon, 2010-05-31 at 07:25 -0400, Mark Hounschell wrote:Um, well, since you've got a lot of them that does rather argue againsttheir being obsolete ...fdisk is only the dos label ... there's a lot you can't do with a doslabel. I think parted will allow you to write a label that will work.I've got scsi_debug patched to work with 256 byte sectors. It actuallylooks like this has nothing to do with the residue. What I see is ahang because block is trying to do a zero sized read. I suspectsomething is trying to do a single sector read, which is impossiblesince the linux native sector size is 512 and it's getting rounded down.This might, of course, argue that block cannot now support 256 sectordevices and so they need to be deprecated ... I'll see.JamesOn 05/31/2010 10:02 AM, James Bottomley wrote:>Except I would _never_ attempt to use any of them for an actual Linuxfs. If I did, and again I wouldn't, it would be after formatting themwith a 512 byte sector. Way too slow and small. We only provide supportfor them in an emulation of an old RTOS called MPX-32 using the sg_iointerface.>>>>>>>On 05/31/2010 11:17 AM, Mark Hounschell wrote:>I know your a busy guy, I was just wondering if this BUG is still beinggiven consideration? ThanksMarkReply-To:On Thu, 2010-06-17 at 07:04 -0400, Mark Hounschell wrote:Yes, but it got lost in the merge window. I was investigating where thebreak is ... since the whole of block has allowances for 256 byte sectordevices, it seems that something once used it.JamesThis bug is against obsolete kernel. Please try withnewer kernel to see if it's fixed.Cheers NickThis bug is still valid. A 256 byte sector disk will cause kernel-4.0.2 to hang.Every since this bug was reported I have rolled my own patch that causes 256 byte sector disk to be unsupported for a linux fs. I use these disks in raw mode using sg3 API only. No one would ever use these disks for a linux fs. I would be happy to submit this patch. MarkIt would be good to get this fixed so if you have a patch it would be good to get it upstream. The only users I know of 256 byte/sector are a few ancient USB devices and also retro-computing folk . For the retro stuff the file systems are not native Linux anyway so requiring sg wouldn't be a problem.Createdmake scsi disk 256 byte sector unsupported for linux filesystemsThis patch makes 256 byte sector disks unsupported for linux fs. Since kernel 2.6.x or so I have been unable to boot with a 256 byte sector installed.Feel free to add my signed off by:Signed-off-by: Mark Hounschell <>
id=71641	JFS provides three modes, journal, ordered and writeback.The first mode is denoted as ‘journal mode’in the following context.In the journal mode, data should be written twice, one for the journal area and the other for the client file system. If the journal area and the client file system are both located in the disk, it has at least 50% performance degradation compared to ordered mode.But what if we put the journal area in a ramdisk?I did the following tests. It shows the ext4 with full data journaling has unreasonable performance degradation even the journal area is located in the ramdisk.Test environment-- CPU: Intel(R) Xeon(R) CPU E3-1225 v3 @ 3.20GHzRAM:8GBFilesystem:Ext4Linux version:3.4.6RAID are composed of 6 x 1TB HDCommand: time dd if=/dev/zero of= Write_File bs=1M count=51200Volume_type ordered_mode Journal_mode degradationSingle_disk 173MB/s 144MB/s 17%RAID0 937MB/s 375MB/s 60%RAID5 732MB/s 132MB/s 82%Does anyone know where the bottleneck may be? On Fri, Mar 07, 2014 at 11:39:40AM +0000,wrote:How big was the ramdisk? Since all of the blocks are going throughthe journal, even if it is on the journal, it requires more commitsand thus more checkpoint operations, which means more updates to thedisk. A bigger journal will help minimize this issue.Would you be willing to grab block traces for both the disk and theexternal journal device?I will add that the workload of "dd if=/dev/zero of=file" is probablythe worst case for data=journal, and if that's really what you aredoing, it's a case of "doctor, doctor, it hurts when I do that". Allfile systems modes will have strengths and weaknesses, and your usecase one where I would simply tell people, "don't use that mode".If you want to work on improving it, that's great. Gather data, andif we can figure out an easy way to improve things, great. But I'llwarn you ahead of time this is not necessarily something I view as"unreasonable", nor is it something that I would consider a highpriority thing to fix. - Ted- TedI use two sizes of ramdisk, 128MB and 1024MB. With 1024MB journal area, the performance is slight improved. But performance degradation is still significant. I am willing to grab block traces. Please tell me how to get the traces you want.As you can see that the performance degradation of applying data=journal in raid5 is 80%, which makes it hard to use. If I know where the problem is, I will try to improve it.Thanks for your help.Test command : dd if=/dev/zero of=/share/CACHEDEV2_DATA/orderno5G bs=1M count=5120The results of block trace can be download as follow.The results of btt can be download as follow.There are three folders:/journal -->ext4,data=journal with 375MB/s/order_delalloc -->ext4,data=ordered,delalloc with 937MB/s/order_nodelalloc -->ext4,data=ordered,nodelalloc with 353MB/sThe size of write request with data=ordered,delalloc is 64k mostly.The size of write requests with data=journal and data=ordered,nodelalloc are 4k mostly. If we observe the average Q2Q in btt results, which means time interval between requests, we have/journal 0.00081/order_nodelalloc 0.00031It seems to be the reason of performance degradation.Is any one know why the time interval of requests is significantly longer with data=journal?Could you retry your measurements using the latest kernel? At least 3.11, and preferably 3.13.We significantly optimized the write path for the nodelalloc case in 3.11. That should fix the average size being so small for the nodelalloc case:commit 20970ba65d5a22f2e4efbfa100377722fde56935Author: Theodore Ts'o <>Date: Thu Jun 6 14:00:46 2013 -0400 ext4: use ext4_da_writepages() for all modes Rename ext4_da_writepages() to ext4_writepages() and use it for all modes. We still need to iterate over all the pages in the case of data=journalling, but in the case of nodelalloc/data=ordered (which is what file systems mounted using ext3 backwards compatibility will use) this will allow us to use a much more efficient I/O submission path. Signed-off-by: "Theodore Ts'o" <>(In reply to Theodore Tso from)Thanks for your advice. The kernel version is changed from 3.4 to 3.11. The write throughput of data=journal is still only 40% of data=order. Do you think what may be wrong in this mode ?---------------------Test environment-- CPU: Intel(R) Xeon(R) CPU E3-1225 v3 @ 3.20GHzRAM:8GBFilesystem:Ext4Linux version: ubuntu-saucy with kernel 3.11128MB ramdisk is used as journaling areaRAID0 are composed of 6 x 1TB HDCommand: time dd if=/dev/zero of= Write_File bs=1M count=5120data=journal -> 398MB/sdata=ordered ->1.1GB/sdata=ordered ,nodelalloc -> 1G/sblktrace results can be downloaded inbtt results can be downloaded inFor linux 3.4, the write throughputs are data=journal -> 397MB/sdata=ordered -> 937MB/sdata=ordered ,nodelalloc -> 863MB/s**PS. the previous data is mistaken, please use this version.Could you try changing JBD2_NR_BATCH (defined in include/linux/jbd2.h) from 64 to 256? If that improves, you can try 512, but that might not make a further difference.(In reply to Theodore Tso from)Thanks for your advice. The performance has the following improvement.data=journal JBD2_NR_BATCH=64 -> 398MB/sdata=journal JBD2_NR_BATCH=256 -> 412MB/sdata=ordered ->1.1GB/sDo you have any other suggestions?it's clear this isn't going to get performance up to 1.1 GB/s, but I'm curious how much setting JBD2_NR_BATCH changes things at 512 and 1024 and possibly even 2048. Once it no longer maters a difference, if you could do another blktrace, and also gather lock_stat information, that would be useful.To gather lock_stat information, enable CONFIG_LOCK_STAT, and then "echo 0 > /proc/lock_stat" before you start the workload, and then capture the output of /proc/lock_stat after you finish running your workload/benchmark.If you also regather numbers with lock_stat enabled on a stock 3.11 kernel (and also get a /proc/lock_stat report from a stock 3.11 kernel, with and without data=journal), that would be useful.If it turns out that there is some lock contention going on with some of the jbd2 spinlocks, there are some patches queued for 3.15 that I may have to ask you to try (which will mean going to something like 3.14-rc7 plus some additional patches from the ext4 git tree).Thanks for your benchmarking!(In reply to Theodore Tso from)Thanks for your advice.With the same environment setting and 'dd' command,The benchmarks of JBD2_NR_batch with data=journal are showed as following, JBD2_NR_batch =64 ->386 MB/sJBD2_NR_batch =254 ->400MB/sJBD2_NR_batch =512 ->407MB/sJBD2_NR_batch =1024 with CONFIG_LOCK_STAT enable ->304MB/sJBD2_NR_batch =2048 ->440MB/s---------------------------/proc/lock_stat report with data=journaldata collected at the end of "dd"data collected in the middle of "dd" execution/proc/lock_stat report with data=ordered------------------------------blktrace of JBD2_NR_batch =2048 with data=journalPlease tell me if you need further information.BTW, if we use 1G ramdisk as journal area, the performance with JBD2_NR_batch =2048 can be 571MB/sPlease download the result of blktrace as following,
id=69441	WARNING: CPU: 0 PID: 8625 at fs/sysfs/group.c:214 sysfs_remove_group+0xc6/0xd0()sysfs group ffffffff81cb0680 not found for kobject 'target6:0:0'Modules linked in: usb_storage rfcomm ccm fuse ipt_MASQUERADE xt_CHECKSUM tun ip6t_rpfilter ip6t_REJECT xt_conntrack bnep ebtable_nat ebtable_broute bridge stp llc ebtable_filter ebtables ip6table_nat nf_conntrack_ipv6 nf_defrag_ipv6 nf_nat_ipv6 ip6table_mangle ip6table_security ip6table_raw ip6table_filter ip6_tables iptable_nat nf_conntrack_ipv4 nf_defrag_ipv4 nf_nat_ipv4 nf_nat nf_conntrack iptable_mangle iptable_security iptable_raw iTCO_wdt iTCO_vendor_support vfat fat snd_hda_codec_hdmi snd_hda_codec_realtek x86_pkg_temp_thermal coretemp kvm_intel kvm snd_hda_intel snd_hda_codec snd_hwdep snd_seq crct10dif_pclmul snd_seq_device arc4 crc32_pclmul snd_pcm crc32c_intel iwldvm ghash_clmulni_intel microcode mac80211 uvcvideo cdc_mbim serio_raw videobuf2_vmalloc videobuf2_memops i2c_i801 cdc_ncm btusb videobuf2_core usbnet videodev bluetooth iwlwifi media cfg80211 mii sdhci_pci sdhci cdc_wdm cdc_acm mmc_core snd_page_alloc lpc_ich mfd_core shpchp snd_timer mei_me mei wmi thinkpad_acpi snd soundcore rfkill tpm_tis tpm nfsd auth_rpcgss nfs_acl lockd sunrpc i915 i2c_algo_bit drm_kms_helper drm i2c_core videoCPU: 0 PID: 8625 Comm: umount Not tainted 3.13.0-1.fc21.x86_64 #1Hardware name: LENOVO 3444FHG/3444FHG, BIOS G6ET96WW (2.56 ) 04/29/2013 0000000000000009 ffff880040923b70 ffffffff81685ffa ffff880040923bb8 ffff880040923ba8 ffffffff8106d5ed 0000000000000000 ffffffff81cb0680 ffff8801e4439838 ffff880040b89188 ffff88020810c100 ffff880040923c08Call Trace: [<ffffffff81685ffa>] dump_stack+0x45/0x56 [<ffffffff8106d5ed>] warn_slowpath_common+0x7d/0xa0 [<ffffffff8106d65c>] warn_slowpath_fmt+0x4c/0x50 [<ffffffff812308ae>] ? sysfs_get_dirent_ns+0x4e/0x70 [<ffffffff81231b76>] sysfs_remove_group+0xc6/0xd0 [<ffffffff8141d7a3>] dpm_sysfs_remove+0x43/0x50 [<ffffffff814134f5>] device_del+0x45/0x1c0 [<ffffffff8143e767>] scsi_target_reap_usercontext+0x27/0x40 [<ffffffff81086437>] execute_in_process_context+0x67/0x70 [<ffffffff8143fbe4>] scsi_target_reap+0xc4/0xf0 [<ffffffff81441bb6>] scsi_device_dev_release_usercontext+0xe6/0x120 [<ffffffff81086437>] execute_in_process_context+0x67/0x70 [<ffffffff81441acc>] scsi_device_dev_release+0x1c/0x20 [<ffffffff81412b42>] device_release+0x32/0xa0 [<ffffffff81315f87>] kobject_cleanup+0x77/0x1b0 [<ffffffff81315e35>] kobject_put+0x35/0x70 [<ffffffff81412e37>] put_device+0x17/0x20 [<ffffffff814342cb>] scsi_device_put+0x3b/0x50 [<ffffffff81446760>] scsi_disk_put+0x30/0x50 [<ffffffff81446a92>] sd_release+0x42/0xd0 [<ffffffff811f12ec>] __blkdev_put+0x16c/0x1a0 [<ffffffff811f128e>] __blkdev_put+0x10e/0x1a0 [<ffffffff811f1c2c>] blkdev_put+0x4c/0x120 [<ffffffff811badb4>] kill_block_super+0x44/0x70 [<ffffffff811bb07d>] deactivate_locked_super+0x3d/0x60 [<ffffffff811bb626>] deactivate_super+0x46/0x60 [<ffffffff811d72fc>] mntput_no_expire+0xac/0x140 [<ffffffff811d876e>] SyS_umount+0x8e/0x100 [<ffffffff81694fe9>] system_call_fastpath+0x16/0x1b CreateddmesgCreatedanother warningHi Igor,Does James' latest "target refcounting infrastructure fixes for usb" [1] patchset take care of this for you?[1]I can't reproduce this bug on master branch, so close it as FIXED.We can again reproduce this problem.From RHBZ.This problem has been fixed by commit e63ed0d7a980 ([SCSI] fix our current target reap infrastructure), which is part of 3.15-rc1. It will not be ported to earlier stable kernels until James Bottomley is satisfied that it does not introduce any new bugs. That is why you still see reports of this problem on the distribution Bugzillas from users running 3.13.y and 3.14.y.The bug report should be closed.
id=50281	I have observed that when the linux futexes are contended, the system spends A LOT of time in the spinlocks. I also noticed this to be a problem even when futexes are not used directly from the user code, but when calling malloc/free, rand, glib mutex calls, and other system/library calls that make calls to futex. I understand that this is the nature of the futex, but over 50% of cpu cycles spent in the spinlock seems excessive.I am using kernel 2.6.32-279.9.1.el6.x86_64. My process is running on a 24-core server with 16GB RAM. The process has 700 threads. The excessive time spend in the spinlock happens after a few hours of running the process. The data collected with "perf record" shows that the spinlock is called from the futex called from __lll_lock_wait_private and __lll_unlock_wake_private.Using "top", I observed that the machine is 10% idle, 10% in the user mode, and 90% in the system mode.Using "perf top", I observed the following: 50.73% [kernel] [k] _spin_lock 11.13% [kernel] [k] hpet_msi_next_eventetc... RHEL kernel bugs should go to Red Hat. Its too old and too different for upstream to care aboutTried kernel 3.6.6 downloaded directly from kernel.org. The problem is still there.Here is what is reported by perf top: 61.40% [kernel] [k] _raw_spin_lock 1.54% libc-2.12.so [.] _int_malloc 1.28% libjpeg.so.8.0.2 [.] encode_mcu_huff 1.03% libz.so.1.2.7 [.] longest_match I had 817 threads on my system. 713 of them are waiting on __lll_lock_wait_private.Createdlog of vmstat running in the background that shows the usage of the system before the spin_lock problem happens, and after the problem happensAttached the log of vmstat (vmstat.1352922025.2of3.bz2) running in the background that shows the usage of the system before the spin_lock problem happens, and after the problem happens. My application was running uninterrupted during all the the time vmstats was collecting the data.The log shows that at 2012-11-15 08:25:20 UTC, the system CPU usage on the machine started jumping sporadically from ~30% to 70%. At 2012-11-15 08:39:43 UTC the system cpu usage takes consistently 70% of the CPU.Other data captured by vmstats show the number of context switches in the system more than doubles.Perf top that the majority of the time spent in the system mode was taken by _raw_spin_lock.Configured the system for kdump, and generated a kernel dump with "echo c > /proc/sysrq-trigger" when the system started to exhibit the spinlock problem.Here are the kernel stacks of all the tasks that were running on the system at the time when the crash was generated:PID: 2821 TASK: ffff88030ceb0140 CPU: 0 COMMAND: "squid" #0 [ffff880317c07e30] crash_nmi_callback at ffffffff81038009 #1 [ffff880317c07e40] nmi_handle at ffffffff8157d7fa #2 [ffff880317c07ea0] default_do_nmi at ffffffff8157d938 #3 [ffff880317c07ed0] do_nmi at ffffffff8157db70 #4 [ffff880317c07ef0] end_repeat_nmi at ffffffff8157ce40 [exception RIP: rb_erase+39] RIP: ffffffff812735c7 RSP: ffff880317c03c90 RFLAGS: 00000082 RAX: 0000000000000010 RBX: 0000000000000010 RCX: 0000000000000082 RDX: ffff880317c03c90 RSI: 0000000000000000 RDI: 0000000000000001 RBP: ffffffff812735c7 R8: ffffffff812735c7 R9: 0000000000000000 R10: ffff880317c03c90 R11: 0000000000000082 R12: ffffffffffffffff R13: ffff88030e5ad640 R14: ffff88030dc18e70 R15: 00000000000fffe3 ORIG_RAX: 00000000000fffe3 CS: 0010 SS: 0000--- <NMI exception stack> --- #5 [ffff880317c03c90] rb_erase at ffffffff812735c7 #6 [ffff880317c03c98] __free_iova at ffffffff81482c37 #7 [ffff880317c03cc8] flush_unmaps at ffffffff81484fe8 #8 [ffff880317c03d18] add_unmap at ffffffff814851b5 #9 [ffff880317c03d48] intel_unmap_page at ffffffff81487ca9#10 [ffff880317c03d98] igb_clean_rx_irq at ffffffffa031ac12 [igb]#11 [ffff880317c03e28] igb_poll at ffffffffa031c6b5 [igb]#12 [ffff880317c03e58] net_rx_action at ffffffff814ad1d2#13 [ffff880317c03eb8] __do_softirq at ffffffff8105ee17#14 [ffff880317c03f38] call_softirq at ffffffff81585bbc#15 [ffff880317c03f50] do_softirq at ffffffff81016335#16 [ffff880317c03f70] irq_exit at ffffffff8105ebfd#17 [ffff880317c03f80] do_IRQ at ffffffff81586416--- <IRQ stack> ---#18 [ffff88030cfb1f58] ret_from_intr at ffffffff8157c82a RIP: 00007f3e7b7377ab RSP: 00007fff1f772a70 RFLAGS: 00000246 RAX: 0000000000000000 RBX: 000000001358b7e0 RCX: 0000000000000064 RDX: 0000000000000063 RSI: 00007fff1f772a97 RDI: 0000000000000064 RBP: 00007fff1f772aa0 R8: 0000000000000000 R9: 0000000000001add R10: 0000000000000001 R11: 00007f3e75e813b6 R12: 00007fff1f7731c0 R13: 00007fff1f773228 R14: 0000000000000004 R15: 000000000055f156 ORIG_RAX: ffffffffffffff6d CS: 0033 SS: 002bPID: 11348 TASK: ffff88016d214b60 CPU: 1 COMMAND: "myapp" #0 [ffff880197c07e30] crash_nmi_callback at ffffffff81038009 #1 [ffff880197c07e40] nmi_handle at ffffffff8157d7fa #2 [ffff880197c07ea0] default_do_nmi at ffffffff8157d938 #3 [ffff880197c07ed0] do_nmi at ffffffff8157db70 #4 [ffff880197c07ef0] end_repeat_nmi at ffffffff8157ce40 [exception RIP: futex_wait+125] RIP: ffffffff810b201d RSP: ffff8802b2f83d68 RFLAGS: 00000246 RAX: 0000000000000010 RBX: 0000000000000010 RCX: 0000000000000246 RDX: ffff8802b2f83d68 RSI: 0000000000000018 RDI: 0000000000000001 RBP: ffffffff810b201d R8: ffffffff810b201d R9: 0000000000000018 R10: ffff8802b2f83d68 R11: 0000000000000246 R12: ffffffffffffffff R13: ffff8802b2f83e18 R14: 0000000000000000 R15: 0000000000000002 ORIG_RAX: 0000000000000002 CS: 0010 SS: 0018--- <NMI exception stack> --- #5 [ffff8802b2f83d68] futex_wait at ffffffff810b201d #6 [ffff8802b2f83ed0] do_futex at ffffffff810b303f #7 [ffff8802b2f83ef0] sys_futex at ffffffff810b31bb #8 [ffff8802b2f83f80] system_call_fastpath at ffffffff81584a29 RIP: 00007f63c0ab6e6e RSP: 00007f600fd8c9e0 RFLAGS: 00000293 RAX: 00000000000000ca RBX: ffffffff81584a29 RCX: ffffffffffffffff RDX: 0000000000000002 RSI: 0000000000000080 RDI: 00007f61c4000020 RBP: 0000000000000033 R8: 00007f63cd468a17 R9: 00007f63c14f4420 R10: 0000000000000000 R11: 0000000000000202 R12: 00007f61c66f6d98 R13: 00007f600fd8cb00 R14: 00007f61c66f6da0 R15: 0000000000000033 ORIG_RAX: 00000000000000ca CS: 0033 SS: 002bPID: 13827 TASK: ffff8801417ccb20 CPU: 2 COMMAND: "myapp" #0 [ffff880317c27e30] crash_nmi_callback at ffffffff81038009 #1 [ffff880317c27e40] nmi_handle at ffffffff8157d7fa #2 [ffff880317c27ea0] default_do_nmi at ffffffff8157d938 #3 [ffff880317c27ed0] do_nmi at ffffffff8157db70 #4 [ffff880317c27ef0] end_repeat_nmi at ffffffff8157ce40 [exception RIP: _raw_spin_lock+37] RIP: ffffffff8157c695 RSP: ffff880147139e58 RFLAGS: 00000206 RAX: 0000000000000010 RBX: 0000000000000010 RCX: 0000000000000206 RDX: ffff880147139e58 RSI: 0000000000000018 RDI: 0000000000000001 RBP: ffffffff8157c695 R8: ffffffff8157c695 R9: 0000000000000018 R10: ffff880147139e58 R11: 0000000000000206 R12: ffffffffffffffff R13: ffffffff81d999e0 R14: 00000000d630e477 R15: 00000000000085d9 ORIG_RAX: 00000000000085d9 CS: 0010 SS: 0018--- <NMI exception stack> --- #5 [ffff880147139e58] _raw_spin_lock at ffffffff8157c695 #6 [ffff880147139e60] futex_wake at ffffffff810b1194 #7 [ffff880147139ed0] do_futex at ffffffff810b305b #8 [ffff880147139ef0] sys_futex at ffffffff810b31bb #9 [ffff880147139f80] system_call_fastpath at ffffffff81584a29 RIP: 00007f63c0ab6e9f RSP: 00007f5ff8d5e9e0 RFLAGS: 00000293 RAX: 00000000000000ca RBX: ffffffff81584a29 RCX: ffffffffffffffff RDX: 0000000000000001 RSI: 0000000000000081 RDI: 00007f61c4000020 RBP: 00007f5e7ca01ee0 R8: 00007f61c4000070 R9: 0000000000000000 R10: 0000000000000040 R11: 0000000000000206 R12: 0000000000000000 R13: 0000000000000000 R14: 00007f61c4000020 R15: 00007f61c4000020 ORIG_RAX: 00000000000000ca CS: 0033 SS: 002bPID: 7240 TASK: ffff8801cd460140 CPU: 3 COMMAND: "myapp" #0 [ffff880197c27e30] crash_nmi_callback at ffffffff81038009 #1 [ffff880197c27e40] nmi_handle at ffffffff8157d7fa #2 [ffff880197c27ea0] default_do_nmi at ffffffff8157d938 #3 [ffff880197c27ed0] do_nmi at ffffffff8157db70 #4 [ffff880197c27ef0] end_repeat_nmi at ffffffff8157ce40 [exception RIP: _raw_spin_lock+34] RIP: ffffffff8157c692 RSP: ffff880227a49e58 RFLAGS: 00000212 RAX: 0000000000000010 RBX: 0000000000000010 RCX: 0000000000000212 RDX: ffff880227a49e58 RSI: 0000000000000018 RDI: 0000000000000001 RBP: ffffffff8157c692 R8: ffffffff8157c692 R9: 0000000000000018 R10: ffff880227a49e58 R11: 0000000000000212 R12: ffffffffffffffff R13: ffffffff81d999e0 R14: 00000000d630e477 R15: 00000000000085e0 ORIG_RAX: 00000000000085e0 CS: 0010 SS: 0018--- <NMI exception stack> --- #5 [ffff880227a49e58] _raw_spin_lock at ffffffff8157c692 #6 [ffff880227a49e60] futex_wake at ffffffff810b1194 #7 [ffff880227a49ed0] do_futex at ffffffff810b305b #8 [ffff880227a49ef0] sys_futex at ffffffff810b31bb #9 [ffff880227a49f80] system_call_fastpath at ffffffff81584a29 RIP: 00007f63c0ab6e9f RSP: 00007f5fddd28738 RFLAGS: 00010202 RAX: 00000000000000ca RBX: ffffffff81584a29 RCX: 0000000000000004 RDX: 0000000000000001 RSI: 0000000000000081 RDI: 00007f61c4000020 RBP: 00007f5f0f594170 R8: 0000000000000002 R9: 0000000000000004 R10: 0000000000000029 R11: 0000000000000206 R12: 000000000000011c R13: 0000000000000108 R14: 0000000000000118 R15: 0000000000000029 ORIG_RAX: 00000000000000ca CS: 0033 SS: 002bPID: 19376 TASK: ffff8802e46d6040 CPU: 4 COMMAND: "myapp" #0 [ffff880317c47e30] crash_nmi_callback at ffffffff81038009 #1 [ffff880317c47e40] nmi_handle at ffffffff8157d7fa #2 [ffff880317c47ea0] default_do_nmi at ffffffff8157d938 #3 [ffff880317c47ed0] do_nmi at ffffffff8157db70 #4 [ffff880317c47ef0] end_repeat_nmi at ffffffff8157ce40 [exception RIP: cpuacct_charge+52] RIP: ffffffff81084654 RSP: ffff880317c43d78 RFLAGS: 00000086 RAX: 0000000000000010 RBX: 0000000000000010 RCX: 0000000000000086 RDX: ffff880317c43d78 RSI: 0000000000000018 RDI: 0000000000000001 RBP: ffffffff81084654 R8: ffffffff81084654 R9: 0000000000000018 R10: ffff880317c43d78 R11: 0000000000000086 R12: ffffffffffffffff R13: ffff8802e46d6040 R14: 0000000000032242 R15: ffffffff81d764a0 ORIG_RAX: ffffffff81d764a0 CS: 0010 SS: 0018--- <NMI exception stack> --- #5 [ffff880317c43d78] cpuacct_charge at ffffffff81084654 #6 [ffff880317c43d80] update_curr at ffffffff81091664 #7 [ffff880317c43dc0] entity_tick at ffffffff81091d07 #8 [ffff880317c43df0] task_tick_fair at ffffffff81091e32 #9 [ffff880317c43e10] scheduler_tick at ffffffff810896bb#10 [ffff880317c43e50] update_process_times at ffffffff810666fe#11 [ffff880317c43e80] tick_sched_timer at ffffffff810ae9be#12 [ffff880317c43eb0] __run_hrtimer at ffffffff8107edd3#13 [ffff880317c43f00] hrtimer_interrupt at ffffffff8107f1a6#14 [ffff880317c43f90] smp_apic_timer_interrupt at ffffffff815864f9#15 [ffff880317c43fb0] apic_timer_interrupt at ffffffff815854ca--- <IRQ stack> ---#16 [ffff8801babe5da8] apic_timer_interrupt at ffffffff815854ca [exception RIP: _raw_spin_lock+34] RIP: ffffffff8157c692 RSP: ffff8801babe5e58 RFLAGS: 00000202 RAX: 00000000000085d9 RBX: ffff8802e46d6040 RCX: 00000000c3f6fa9c RDX: 00000000000085db RSI: 00000000d630e477 RDI: ffffffff81d999e0 RBP: ffff8801babe5e58 R8: 00000000952014ee R9: 0000000000000000 R10: 0000000000000000 R11: 0000000000000000 R12: ffff8801babe5dc0 R13: ffff8801babe5db0 R14: ffff8801babe5db0 R15: 0000000000000064 ORIG_RAX: ffffffffffffff10 CS: 0010 SS: 0018#17 [ffff8801babe5e60] futex_wake at ffffffff810b1194#18 [ffff8801babe5ed0] do_futex at ffffffff810b305b#19 [ffff8801babe5ef0] sys_futex at ffffffff810b31bb#20 [ffff8801babe5f80] system_call_fastpath at ffffffff81584a29 RIP: 00007f63c0ab6e9f RSP: 00007f60355d71b0 RFLAGS: 00000246 RAX: 00000000000000ca RBX: ffffffff81584a29 RCX: 0000000000000010 RDX: 0000000000000001 RSI: 0000000000000081 RDI: 00007f61c4000020 RBP: 00007f5efe96d6b0 R8: 0000000000000000 R9: 0000000000000002 R10: 000000000000000d R11: 0000000000000206 R12: 00007f60355d7300 R13: 00007f60355d72c0 R14: 00007f60355d7310 R15: 000000000000000d ORIG_RAX: 00000000000000ca CS: 0033 SS: 002bPID: 4171 TASK: ffff8801e1b29540 CPU: 5 COMMAND: "myapp" #0 [ffff880197c47e30] crash_nmi_callback at ffffffff81038009 #1 [ffff880197c47e40] nmi_handle at ffffffff8157d7fa #2 [ffff880197c47ea0] default_do_nmi at ffffffff8157d938 #3 [ffff880197c47ed0] do_nmi at ffffffff8157db70 #4 [ffff880197c47ef0] end_repeat_nmi at ffffffff8157ce40 [exception RIP: _raw_spin_lock+34] RIP: ffffffff8157c692 RSP: ffff8802aaafbce8 RFLAGS: 00000216 RAX: 0000000000000010 RBX: 0000000000000010 RCX: 0000000000000216 RDX: ffff8802aaafbce8 RSI: 0000000000000018 RDI: 0000000000000001 RBP: ffffffff8157c692 R8: ffffffff8157c692 R9: 0000000000000018 R10: ffff8802aaafbce8 R11: 0000000000000216 R12: ffffffffffffffff R13: ffffffff81d999e0 R14: 00000000d630e477 R15: 00000000000085e5 ORIG_RAX: 00000000000085e5 CS: 0010 SS: 0018--- <NMI exception stack> --- #5 [ffff8802aaafbce8] _raw_spin_lock at ffffffff8157c692 #6 [ffff8802aaafbcf0] futex_wait_setup at ffffffff810b1f09 #7 [ffff8802aaafbd60] futex_wait at ffffffff810b212b #8 [ffff8802aaafbed0] do_futex at ffffffff810b303f #9 [ffff8802aaafbef0] sys_futex at ffffffff810b31bb#10 [ffff8802aaafbf80] system_call_fastpath at ffffffff81584a29 RIP: 00007f63c0ab6e6e RSP: 00007f6336ffc2b8 RFLAGS: 00010206 RAX: 00000000000000ca RBX: ffffffff81584a29 RCX: 00007f6336ffc5ec RDX: 0000000000000002 RSI: 0000000000000080 RDI: 00007f61c4000020 RBP: 0000000000000027 R8: 00000000ffffffff R9: 00000000ffffffff R10: 0000000000000000 R11: 0000000000000202 R12: 00007f6336ffc300 R13: 00007f6336ffc2c0 R14: 000000000000000d R15: 0000000000000027 ORIG_RAX: 00000000000000ca CS: 0033 SS: 002bPID: 2935 TASK: ffff8802e28d7580 CPU: 6 COMMAND: "myapp" #0 [ffff880317c67e30] crash_nmi_callback at ffffffff81038009 #1 [ffff880317c67e40] nmi_handle at ffffffff8157d7fa #2 [ffff880317c67ea0] default_do_nmi at ffffffff8157d938 #3 [ffff880317c67ed0] do_nmi at ffffffff8157db70 #4 [ffff880317c67ef0] end_repeat_nmi at ffffffff8157ce40 [exception RIP: _raw_spin_lock+34] RIP: ffffffff8157c692 RSP: ffff8801b8ad9ce8 RFLAGS: 00000212 RAX: 0000000000000010 RBX: 0000000000000010 RCX: 0000000000000212 RDX: ffff8801b8ad9ce8 RSI: 0000000000000018 RDI: 0000000000000001 RBP: ffffffff8157c692 R8: ffffffff8157c692 R9: 0000000000000018 R10: ffff8801b8ad9ce8 R11: 0000000000000212 R12: ffffffffffffffff R13: ffffffff81d999e0 R14: 00000000d630e477 R15: 00000000000085e4 ORIG_RAX: 00000000000085e4 CS: 0010 SS: 0018--- <NMI exception stack> --- #5 [ffff8801b8ad9ce8] _raw_spin_lock at ffffffff8157c692 #6 [ffff8801b8ad9cf0] futex_wait_setup at ffffffff810b1f09 #7 [ffff8801b8ad9d60] futex_wait at ffffffff810b212b #8 [ffff8801b8ad9ed0] do_futex at ffffffff810b303f #9 [ffff8801b8ad9ef0] sys_futex at ffffffff810b31bb#10 [ffff8801b8ad9f80] system_call_fastpath at ffffffff81584a29 RIP: 00007f63c0ab6e6e RSP: 00007f6192ffc7b8 RFLAGS: 00010287 RAX: 00000000000000ca RBX: ffffffff81584a29 RCX: 000000000000000e RDX: 0000000000000002 RSI: 0000000000000080 RDI: 00007f61c4000020 RBP: 0000000000000048 R8: 7ffffffffffffffe R9: 0000000000000016 R10: 0000000000000000 R11: 0000000000000202 R12: 0000000000000001 R13: 0000000000000001 R14: 00007f63c45927d0 R15: 0000000000000048 ORIG_RAX: 00000000000000ca CS: 0033 SS: 002bPID: 17954 TASK: ffff8801cd460b60 CPU: 7 COMMAND: "myapp" #0 [ffff880197c67e30] crash_nmi_callback at ffffffff81038009 #1 [ffff880197c67e40] nmi_handle at ffffffff8157d7fa #2 [ffff880197c67ea0] default_do_nmi at ffffffff8157d938 #3 [ffff880197c67ed0] do_nmi at ffffffff8157db70 #4 [ffff880197c67ef0] end_repeat_nmi at ffffffff8157ce40 [exception RIP: _raw_spin_lock+32] RIP: ffffffff8157c690 RSP: ffff8801a859de58 RFLAGS: 00000206 RAX: 0000000000000010 RBX: 0000000000000010 RCX: 0000000000000206 RDX: ffff8801a859de58 RSI: 0000000000000018 RDI: 0000000000000001 RBP: ffffffff8157c690 R8: ffffffff8157c690 R9: 0000000000000018 R10: ffff8801a859de58 R11: 0000000000000206 R12: ffffffffffffffff R13: ffffffff81d999e0 R14: 00000000d630e477 R15: 00000000000085de ORIG_RAX: 00000000000085de CS: 0010 SS: 0018--- <NMI exception stack> --- #5 [ffff8801a859de58] _raw_spin_lock at ffffffff8157c690 #6 [ffff8801a859de60] futex_wake at ffffffff810b1194 #7 [ffff8801a859ded0] do_futex at ffffffff810b305b #8 [ffff8801a859def0] sys_futex at ffffffff810b31bb #9 [ffff8801a859df80] system_call_fastpath at ffffffff81584a29 RIP: 00007f63c0ab6e9f RSP: 00007f63157f9238 RFLAGS: 00010202 RAX: 00000000000000ca RBX: ffffffff81584a29 RCX: 0000000000000008 RDX: 0000000000000001 RSI: 0000000000000081 RDI: 00007f61c4000020 RBP: 00000000000000a0 R8: 00007f63cc817078 R9: 000000000000000a R10: 000000000000008e R11: 0000000000000206 R12: 0000000000000001 R13: 0000000000000000 R14: 00007f5f3c0ddb10 R15: 00007f61c4000020 ORIG_RAX: 00000000000000ca CS: 0033 SS: 002bPID: 15440 TASK: ffff880132e67500 CPU: 8 COMMAND: "myapp" #0 [ffff880317c87e30] crash_nmi_callback at ffffffff81038009 #1 [ffff880317c87e40] nmi_handle at ffffffff8157d7fa #2 [ffff880317c87ea0] default_do_nmi at ffffffff8157d938 #3 [ffff880317c87ed0] do_nmi at ffffffff8157db70 #4 [ffff880317c87ef0] end_repeat_nmi at ffffffff8157ce40 [exception RIP: _raw_spin_lock+34] RIP: ffffffff8157c692 RSP: ffff8801494a1e58 RFLAGS: 00000212 RAX: 0000000000000010 RBX: 0000000000000010 RCX: 0000000000000212 RDX: ffff8801494a1e58 RSI: 0000000000000018 RDI: 0000000000000001 RBP: ffffffff8157c692 R8: ffffffff8157c692 R9: 0000000000000018 R10: ffff8801494a1e58 R11: 0000000000000212 R12: ffffffffffffffff R13: ffffffff81d999e0 R14: 00000000d630e477 R15: 00000000000085e6 ORIG_RAX: 00000000000085e6 CS: 0010 SS: 0018--- <NMI exception stack> --- #5 [ffff8801494a1e58] _raw_spin_lock at ffffffff8157c692 #6 [ffff8801494a1e60] futex_wake at ffffffff810b1194 #7 [ffff8801494a1ed0] do_futex at ffffffff810b305b #8 [ffff8801494a1ef0] sys_futex at ffffffff810b31bb #9 [ffff8801494a1f80] system_call_fastpath at ffffffff81584a29 RIP: 00007f63c0ab6e9f RSP: 00007f62ff7fd1a0 RFLAGS: 00000293 RAX: 00000000000000ca RBX: ffffffff81584a29 RCX: 00007f5f2fa3293b RDX: 0000000000000001 RSI: 0000000000000081 RDI: 00007f61c4000020 RBP: 00007f5f0da66df0 R8: 0000000000000001 R9: 0000000000000003 R10: 0000000000000028 R11: 0000000000000206 R12: 0000000000000001 R13: 0000000000000001 R14: 00007f62ff7fdc20 R15: 0000000000000028 ORIG_RAX: 00000000000000ca CS: 0033 SS: 002bPID: 9596 TASK: ffff88027da99580 CPU: 9 COMMAND: "myapp" #0 [ffff880197c87e30] crash_nmi_callback at ffffffff81038009 #1 [ffff880197c87e40] nmi_handle at ffffffff8157d7fa #2 [ffff880197c87ea0] default_do_nmi at ffffffff8157d938 #3 [ffff880197c87ed0] do_nmi at ffffffff8157db70 #4 [ffff880197c87ef0] end_repeat_nmi at ffffffff8157ce40 [exception RIP: _raw_spin_lock+34] RIP: ffffffff8157c692 RSP: ffff8802d8ea5e58 RFLAGS: 00000206 RAX: 0000000000000010 RBX: 0000000000000010 RCX: 0000000000000206 RDX: ffff8802d8ea5e58 RSI: 0000000000000018 RDI: 0000000000000001 RBP: ffffffff8157c692 R8: ffffffff8157c692 R9: 0000000000000018 R10: ffff8802d8ea5e58 R11: 0000000000000206 R12: ffffffffffffffff R13: ffffffff81d999e0 R14: 00000000d630e477 R15: 00000000000085eb ORIG_RAX: 00000000000085eb CS: 0010 SS: 0018--- <NMI exception stack> --- #5 [ffff8802d8ea5e58] _raw_spin_lock at ffffffff8157c692 #6 [ffff8802d8ea5e60] futex_wake at ffffffff810b1194 #7 [ffff8802d8ea5ed0] do_futex at ffffffff810b305b #8 [ffff8802d8ea5ef0] sys_futex at ffffffff810b31bb #9 [ffff8802d8ea5f80] system_call_fastpath at ffffffff81584a29 RIP: 00007f63c0ab6e9f RSP: 00007f61f37fd660 RFLAGS: 00000202 RAX: 00000000000000ca RBX: ffffffff81584a29 RCX: 00007f61c4000030 RDX: 0000000000000001 RSI: 0000000000000081 RDI: 00007f61c4000020 RBP: 00007f5f249dae00 R8: 0000000000000000 R9: 0000000000000017 R10: 0000000000000010 R11: 0000000000000206 R12: 0000000000000001 R13: 0000000000000001 R14: 00007f63c45927d0 R15: 0000000000000010 ORIG_RAX: 00000000000000ca CS: 0033 SS: 002bPID: 14739 TASK: ffff8800e3bcaaa0 CPU: 10 COMMAND: "myapp" #0 [ffff880317ca7e30] crash_nmi_callback at ffffffff81038009 #1 [ffff880317ca7e40] nmi_handle at ffffffff8157d7fa #2 [ffff880317ca7ea0] default_do_nmi at ffffffff8157d938 #3 [ffff880317ca7ed0] do_nmi at ffffffff8157db70 #4 [ffff880317ca7ef0] end_repeat_nmi at ffffffff8157ce40 [exception RIP: _raw_spin_lock+32] RIP: ffffffff8157c690 RSP: ffff8801ad28be58 RFLAGS: 00000206 RAX: 0000000000000010 RBX: 0000000000000010 RCX: 0000000000000206 RDX: ffff8801ad28be58 RSI: 0000000000000018 RDI: 0000000000000001 RBP: ffffffff8157c690 R8: ffffffff8157c690 R9: 0000000000000018 R10: ffff8801ad28be58 R11: 0000000000000206 R12: ffffffffffffffff R13: ffffffff81d999e0 R14: 00000000d630e477 R15: 00000000000085ea ORIG_RAX: 00000000000085ea CS: 0010 SS: 0018--- <NMI exception stack> --- #5 [ffff8801ad28be58] _raw_spin_lock at ffffffff8157c690 #6 [ffff8801ad28be60] futex_wake at ffffffff810b1194 #7 [ffff8801ad28bed0] do_futex at ffffffff810b305b #8 [ffff8801ad28bef0] sys_futex at ffffffff810b31bb #9 [ffff8801ad28bf80] system_call_fastpath at ffffffff81584a29 RIP: 00007f63c0ab6e9f RSP: 00007f6135ffacf0 RFLAGS: 00000283 RAX: 00000000000000ca RBX: ffffffff81584a29 RCX: 0000000000000030 RDX: 0000000000000001 RSI: 0000000000000081 RDI: 00007f61c4000020 RBP: 00007f61c532b650 R8: 00007f63c482f252 R9: 000000000000001b R10: 00000000000001a0 R11: 0000000000000206 R12: 000000000000000b R13: 00007f6135ffa2e0 R14: 00007f6135ffa310 R15: 00000000000001a0 ORIG_RAX: 00000000000000ca CS: 0033 SS: 002bPID: 23664 TASK: ffff880190c57540 CPU: 11 COMMAND: "myapp" #0 [ffff880197ca7e30] crash_nmi_callback at ffffffff81038009 #1 [ffff880197ca7e40] nmi_handle at ffffffff8157d7fa #2 [ffff880197ca7ea0] default_do_nmi at ffffffff8157d938 #3 [ffff880197ca7ed0] do_nmi at ffffffff8157db70 #4 [ffff880197ca7ef0] end_repeat_nmi at ffffffff8157ce40 [exception RIP: _raw_spin_lock+32] RIP: ffffffff8157c690 RSP: ffff880114a55ce8 RFLAGS: 00000202 RAX: 0000000000000010 RBX: 0000000000000010 RCX: 0000000000000202 RDX: ffff880114a55ce8 RSI: 0000000000000018 RDI: 0000000000000001 RBP: ffffffff8157c690 R8: ffffffff8157c690 R9: 0000000000000018 R10: ffff880114a55ce8 R11: 0000000000000202 R12: ffffffffffffffff R13: ffffffff81d999e0 R14: 00000000d630e477 R15: 00000000000085da ORIG_RAX: 00000000000085da CS: 0010 SS: 0018--- <NMI exception stack> --- #5 [ffff880114a55ce8] _raw_spin_lock at ffffffff8157c690 #6 [ffff880114a55cf0] futex_wait_setup at ffffffff810b1f09 #7 [ffff880114a55d60] futex_wait at ffffffff810b212b #8 [ffff880114a55ed0] do_futex at ffffffff810b303f #9 [ffff880114a55ef0] sys_futex at ffffffff810b31bb#10 [ffff880114a55f80] system_call_fastpath at ffffffff81584a29 RIP: 00007f63c0ab6e6e RSP: 00007f5f8f48b400 RFLAGS: 00000212 RAX: 00000000000000ca RBX: ffffffff81584a29 RCX: 0000000000000000 RDX: 0000000000000002 RSI: 0000000000000080 RDI: 00007f61c4000020 RBP: 0000000000000020 R8: 0000000000000007 R9: 00007f5f25ab0110 R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000007 R13: 0000000000000007 R14: 0000000000000000 R15: 0000000000000020 ORIG_RAX: 00000000000000ca CS: 0033 SS: 002bPID: 8488 TASK: ffff880172bbf580 CPU: 12 COMMAND: "myapp" #0 [ffff880317cc7e30] crash_nmi_callback at ffffffff81038009 #1 [ffff880317cc7e40] nmi_handle at ffffffff8157d7fa #2 [ffff880317cc7ea0] default_do_nmi at ffffffff8157d938 #3 [ffff880317cc7ed0] do_nmi at ffffffff8157db70 #4 [ffff880317cc7ef0] end_repeat_nmi at ffffffff8157ce40 [exception RIP: _raw_spin_lock+34] RIP: ffffffff8157c692 RSP: ffff88022a1f5ce8 RFLAGS: 00000202 RAX: 0000000000000010 RBX: 0000000000000010 RCX: 0000000000000202 RDX: ffff88022a1f5ce8 RSI: 0000000000000018 RDI: 0000000000000001 RBP: ffffffff8157c692 R8: ffffffff8157c692 R9: 0000000000000018 R10: ffff88022a1f5ce8 R11: 0000000000000202 R12: ffffffffffffffff R13: ffffffff81d999e0 R14: 00000000d630e477 R15: 00000000000085ec ORIG_RAX: 00000000000085ec CS: 0010 SS: 0018--- <NMI exception stack> --- #5 [ffff88022a1f5ce8] _raw_spin_lock at ffffffff8157c692 #6 [ffff88022a1f5cf0] futex_wait_setup at ffffffff810b1f09 #7 [ffff88022a1f5d60] futex_wait at ffffffff810b212b #8 [ffff88022a1f5ed0] do_futex at ffffffff810b303f #9 [ffff88022a1f5ef0] sys_futex at ffffffff810b31bb#10 [ffff88022a1f5f80] system_call_fastpath at ffffffff81584a29 RIP: 00007f63c0ab6e6e RSP: 00007f60205ad850 RFLAGS: 00000202 RAX: 00000000000000ca RBX: ffffffff81584a29 RCX: 00007f63c14fe120 RDX: 0000000000000002 RSI: 0000000000000080 RDI: 00007f61c4000020 RBP: 0000000000000040 R8: 0000000000000005 R9: 0000000000000000 R10: 0000000000000000 R11: 0000000000000202 R12: 00007f60205adb20 R13: 00007f60205adb20 R14: 0000000000000000 R15: 0000000000000040 ORIG_RAX: 00000000000000ca CS: 0033 SS: 002bPID: 13836 TASK: ffff8802ae8c0aa0 CPU: 13 COMMAND: "myapp" #0 [ffff880197cc7e30] crash_nmi_callback at ffffffff81038009 #1 [ffff880197cc7e40] nmi_handle at ffffffff8157d7fa #2 [ffff880197cc7ea0] default_do_nmi at ffffffff8157d938 #3 [ffff880197cc7ed0] do_nmi at ffffffff8157db70 #4 [ffff880197cc7ef0] end_repeat_nmi at ffffffff8157ce40 [exception RIP: _raw_spin_lock+37] RIP: ffffffff8157c695 RSP: ffff8801cd69fce8 RFLAGS: 00000202 RAX: 0000000000000010 RBX: 0000000000000010 RCX: 0000000000000202 RDX: ffff8801cd69fce8 RSI: 0000000000000018 RDI: 0000000000000001 RBP: ffffffff8157c695 R8: ffffffff8157c695 R9: 0000000000000018 R10: ffff8801cd69fce8 R11: 0000000000000202 R12: ffffffffffffffff R13: ffffffff81d999e0 R14: 00000000d630e477 R15: 00000000000085e9 ORIG_RAX: 00000000000085e9 CS: 0010 SS: 0018--- <NMI exception stack> --- #5 [ffff8801cd69fce8] _raw_spin_lock at ffffffff8157c695 #6 [ffff8801cd69fcf0] futex_wait_setup at ffffffff810b1f09 #7 [ffff8801cd69fd60] futex_wait at ffffffff810b212b #8 [ffff8801cd69fed0] do_futex at ffffffff810b303f #9 [ffff8801cd69fef0] sys_futex at ffffffff810b31bb#10 [ffff8801cd69ff80] system_call_fastpath at ffffffff81584a29 RIP: 00007f63c0ab6e6e RSP: 00007f5fb3cd0d60 RFLAGS: 00000202 RAX: 00000000000000ca RBX: ffffffff81584a29 RCX: 00007f5fb3cd0d80 RDX: 0000000000000002 RSI: 0000000000000080 RDI: 00007f61c4000020 RBP: 00000000000001a8 R8: 0000000000000001 R9: 00007f61c6aa6658 R10: 0000000000000000 R11: 0000000000000202 R12: 00007f5fb3cd1f30 R13: 0000000000000001 R14: 00007f5f1709e460 R15: 00000000000001a8 ORIG_RAX: 00000000000000ca CS: 0033 SS: 002bPID: 7320 TASK: ffff8800e3983540 CPU: 14 COMMAND: "myapp" #0 [ffff880317ce7e30] crash_nmi_callback at ffffffff81038009 #1 [ffff880317ce7e40] nmi_handle at ffffffff8157d7fa #2 [ffff880317ce7ea0] default_do_nmi at ffffffff8157d938 #3 [ffff880317ce7ed0] do_nmi at ffffffff8157db70 #4 [ffff880317ce7ef0] end_repeat_nmi at ffffffff8157ce40 [exception RIP: _raw_spin_lock+34] RIP: ffffffff8157c692 RSP: ffff8801359f3e58 RFLAGS: 00000216 RAX: 0000000000000010 RBX: 0000000000000010 RCX: 0000000000000216 RDX: ffff8801359f3e58 RSI: 0000000000000018 RDI: 0000000000000001 RBP: ffffffff8157c692 R8: ffffffff8157c692 R9: 0000000000000018 R10: ffff8801359f3e58 R11: 0000000000000216 R12: ffffffffffffffff R13: ffffffff81d999e0 R14: 00000000d630e477 R15: 00000000000085e3 ORIG_RAX: 00000000000085e3 CS: 0010 SS: 0018--- <NMI exception stack> --- #5 [ffff8801359f3e58] _raw_spin_lock at ffffffff8157c692 #6 [ffff8801359f3e60] futex_wake at ffffffff810b1194 #7 [ffff8801359f3ed0] do_futex at ffffffff810b305b #8 [ffff8801359f3ef0] sys_futex at ffffffff810b31bb #9 [ffff8801359f3f80] system_call_fastpath at ffffffff81584a29 RIP: 00007f63c0ab6e9f RSP: 00007f5f5b4236e8 RFLAGS: 00000246 RAX: 00000000000000ca RBX: ffffffff81584a29 RCX: 0000000000000000 RDX: 0000000000000001 RSI: 0000000000000081 RDI: 00007f61c4000020 RBP: 00007f5f4f970690 R8: 0000000000000003 R9: 0000000000000007 R10: 0000000000000043 R11: 0000000000000206 R12: 00007f5f3d631a18 R13: 00007f5f5b4239e0 R14: 00007f5f5b4239c0 R15: 0000000000000043 ORIG_RAX: 00000000000000ca CS: 0033 SS: 002bPID: 17265 TASK: ffff880287aa6ae0 CPU: 15 COMMAND: "myapp" #0 [ffff880197ce7e30] crash_nmi_callback at ffffffff81038009 #1 [ffff880197ce7e40] nmi_handle at ffffffff8157d7fa #2 [ffff880197ce7ea0] default_do_nmi at ffffffff8157d938 #3 [ffff880197ce7ed0] do_nmi at ffffffff8157db70 #4 [ffff880197ce7ef0] end_repeat_nmi at ffffffff8157ce40 [exception RIP: _raw_spin_lock+34] RIP: ffffffff8157c692 RSP: ffff88029e017ce8 RFLAGS: 00000212 RAX: 0000000000000010 RBX: 0000000000000010 RCX: 0000000000000212 RDX: ffff88029e017ce8 RSI: 0000000000000018 RDI: 0000000000000001 RBP: ffffffff8157c692 R8: ffffffff8157c692 R9: 0000000000000018 R10: ffff88029e017ce8 R11: 0000000000000212 R12: ffffffffffffffff R13: ffffffff81d999e0 R14: 00000000d630e477 R15: 00000000000085e1 ORIG_RAX: 00000000000085e1 CS: 0010 SS: 0018--- <NMI exception stack> --- #5 [ffff88029e017ce8] _raw_spin_lock at ffffffff8157c692 #6 [ffff88029e017cf0] futex_wait_setup at ffffffff810b1f09 #7 [ffff88029e017d60] futex_wait at ffffffff810b212b #8 [ffff88029e017ed0] do_futex at ffffffff810b303f #9 [ffff88029e017ef0] sys_futex at ffffffff810b31bb#10 [ffff88029e017f80] system_call_fastpath at ffffffff81584a29 RIP: 00007f63c0ab6e6e RSP: 00007f5fd1d109e0 RFLAGS: 00000293 RAX: 00000000000000ca RBX: ffffffff81584a29 RCX: ffffffffffffffff RDX: 0000000000000002 RSI: 0000000000000080 RDI: 00007f61c4000020 RBP: 0000000000000040 R8: 0000000000000001 R9: 0000000000000003 R10: 0000000000000000 R11: 0000000000000246 R12: 00007f5fd1d10ce8 R13: 00000000000000a0 R14: 00000000000000ab R15: 0000000000000040 ORIG_RAX: 00000000000000ca CS: 0033 SS: 002bPID: 23667 TASK: ffff88015f9fd540 CPU: 16 COMMAND: "myapp" #0 [ffff880317d07e30] crash_nmi_callback at ffffffff81038009 #1 [ffff880317d07e40] nmi_handle at ffffffff8157d7fa #2 [ffff880317d07ea0] default_do_nmi at ffffffff8157d938 #3 [ffff880317d07ed0] do_nmi at ffffffff8157db70 #4 [ffff880317d07ef0] end_repeat_nmi at ffffffff8157ce40 [exception RIP: _raw_spin_lock+32] RIP: ffffffff8157c690 RSP: ffff88011a531e58 RFLAGS: 00000216 RAX: 0000000000000010 RBX: 0000000000000010 RCX: 0000000000000216 RDX: ffff88011a531e58 RSI: 0000000000000018 RDI: 0000000000000001 RBP: ffffffff8157c690 R8: ffffffff8157c690 R9: 0000000000000018 R10: ffff88011a531e58 R11: 0000000000000216 R12: ffffffffffffffff R13: ffffffff81d999e0 R14: 00000000d630e477 R15: 00000000000085e8 ORIG_RAX: 00000000000085e8 CS: 0010 SS: 0018--- <NMI exception stack> --- #5 [ffff88011a531e58] _raw_spin_lock at ffffffff8157c690 #6 [ffff88011a531e60] futex_wake at ffffffff810b1194 #7 [ffff88011a531ed0] do_futex at ffffffff810b305b #8 [ffff88011a531ef0] sys_futex at ffffffff810b31bb #9 [ffff88011a531f80] system_call_fastpath at ffffffff81584a29 RIP: 00007f63c0ab6e9f RSP: 00007f5f86c7a5c0 RFLAGS: 00000206 RAX: 00000000000000ca RBX: ffffffff81584a29 RCX: 00007f5f3e8e12f0 RDX: 0000000000000001 RSI: 0000000000000081 RDI: 00007f61c4000020 RBP: 00007f61c48b1140 R8: 0000000000000002 R9: 0000000000000004 R10: 0000000000000037 R11: 0000000000000206 R12: 00007f5f86c7a300 R13: 00007f5f86c7a2c0 R14: 00007f5f86c7a310 R15: 0000000000000037 ORIG_RAX: 00000000000000ca CS: 0033 SS: 002bPID: 16319 TASK: ffff88029e14d500 CPU: 17 COMMAND: "myapp" #0 [ffff880197d07e30] crash_nmi_callback at ffffffff81038009 #1 [ffff880197d07e40] nmi_handle at ffffffff8157d7fa #2 [ffff880197d07ea0] default_do_nmi at ffffffff8157d938 #3 [ffff880197d07ed0] do_nmi at ffffffff8157db70 #4 [ffff880197d07ef0] end_repeat_nmi at ffffffff8157ce40 [exception RIP: _raw_spin_lock+37] RIP: ffffffff8157c695 RSP: ffff880221e3dce8 RFLAGS: 00000212 RAX: 0000000000000010 RBX: 0000000000000010 RCX: 0000000000000212 RDX: ffff880221e3dce8 RSI: 0000000000000018 RDI: 0000000000000001 RBP: ffffffff8157c695 R8: ffffffff8157c695 R9: 0000000000000018 R10: ffff880221e3dce8 R11: 0000000000000212 R12: ffffffffffffffff R13: ffffffff81d999e0 R14: 00000000d630e477 R15: 00000000000085e7 ORIG_RAX: 00000000000085e7 CS: 0010 SS: 0018--- <NMI exception stack> --- #5 [ffff880221e3dce8] _raw_spin_lock at ffffffff8157c695 #6 [ffff880221e3dcf0] futex_wait_setup at ffffffff810b1f09 #7 [ffff880221e3dd60] futex_wait at ffffffff810b212b #8 [ffff880221e3ded0] do_futex at ffffffff810b303f #9 [ffff880221e3def0] sys_futex at ffffffff810b31bb#10 [ffff880221e3df80] system_call_fastpath at ffffffff81584a29 RIP: 00007f63c0ab6e6e RSP: 00007f6023db49e0 RFLAGS: 00000293 RAX: 00000000000000ca RBX: ffffffff81584a29 RCX: ffffffffffffffff RDX: 0000000000000002 RSI: 0000000000000080 RDI: 00007f61c4000020 RBP: 000000000000001d R8: 0000000000000004 R9: 0000000000000001 R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000004 R13: 0000000000000000 R14: 0000000000000000 R15: 000000000000001d ORIG_RAX: 00000000000000ca CS: 0033 SS: 002bPID: 13744 TASK: ffff8802c5645480 CPU: 18 COMMAND: "myapp" #0 [ffff880317d27e30] crash_nmi_callback at ffffffff81038009 #1 [ffff880317d27e40] nmi_handle at ffffffff8157d7fa #2 [ffff880317d27ea0] default_do_nmi at ffffffff8157d938 #3 [ffff880317d27ed0] do_nmi at ffffffff8157db70 #4 [ffff880317d27ef0] end_repeat_nmi at ffffffff8157ce40 [exception RIP: _raw_spin_lock+37] RIP: ffffffff8157c695 RSP: ffff8801bedcdce8 RFLAGS: 00000206 RAX: 0000000000000010 RBX: 0000000000000010 RCX: 0000000000000206 RDX: ffff8801bedcdce8 RSI: 0000000000000018 RDI: 0000000000000001 RBP: ffffffff8157c695 R8: ffffffff8157c695 R9: 0000000000000018 R10: ffff8801bedcdce8 R11: 0000000000000206 R12: ffffffffffffffff R13: ffffffff81d999e0 R14: 00000000d630e477 R15: 00000000000085df ORIG_RAX: 00000000000085df CS: 0010 SS: 0018--- <NMI exception stack> --- #5 [ffff8801bedcdce8] _raw_spin_lock at ffffffff8157c695 #6 [ffff8801bedcdcf0] futex_wait_setup at ffffffff810b1f09 #7 [ffff8801bedcdd60] futex_wait at ffffffff810b212b #8 [ffff8801bedcded0] do_futex at ffffffff810b303f #9 [ffff8801bedcdef0] sys_futex at ffffffff810b31bb#10 [ffff8801bedcdf80] system_call_fastpath at ffffffff81584a29 RIP: 00007f63c0ab6e6e RSP: 00007f5f9eca8600 RFLAGS: 00000287 RAX: 00000000000000ca RBX: ffffffff81584a29 RCX: 00007f5ebc4ddf20 RDX: 0000000000000002 RSI: 0000000000000080 RDI: 00007f61c4000020 RBP: 0000000000000053 R8: 0000000000000002 R9: 0000000000000006 R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000002740 R13: 00007f5f0f5009f0 R14: 00007f5f0f5009f0 R15: 0000000000000053 ORIG_RAX: 00000000000000ca CS: 0033 SS: 002bPID: 6736 TASK: ffff8801728ae080 CPU: 19 COMMAND: "myapp" #0 [ffff880197d27e30] crash_nmi_callback at ffffffff81038009 #1 [ffff880197d27e40] nmi_handle at ffffffff8157d7fa #2 [ffff880197d27ea0] default_do_nmi at ffffffff8157d938 #3 [ffff880197d27ed0] do_nmi at ffffffff8157db70 #4 [ffff880197d27ef0] end_repeat_nmi at ffffffff8157ce40 [exception RIP: _raw_spin_lock+37] RIP: ffffffff8157c695 RSP: ffff8801c5529e58 RFLAGS: 00000202 RAX: 0000000000000010 RBX: 0000000000000010 RCX: 0000000000000202 RDX: ffff8801c5529e58 RSI: 0000000000000018 RDI: 0000000000000001 RBP: ffffffff8157c695 R8: ffffffff8157c695 R9: 0000000000000018 R10: ffff8801c5529e58 R11: 0000000000000202 R12: ffffffffffffffff R13: ffffffff81d999e0 R14: 00000000d630e477 R15: 00000000000085dd ORIG_RAX: 00000000000085dd CS: 0010 SS: 0018--- <NMI exception stack> --- #5 [ffff8801c5529e58] _raw_spin_lock at ffffffff8157c695 #6 [ffff8801c5529e60] futex_wake at ffffffff810b1194 #7 [ffff8801c5529ed0] do_futex at ffffffff810b305b #8 [ffff8801c5529ef0] sys_futex at ffffffff810b31bb #9 [ffff8801c5529f80] system_call_fastpath at ffffffff81584a29 RIP: 00007f63c0ab6e9f RSP: 00007f5f5941f630 RFLAGS: 00000246 RAX: 00000000000000ca RBX: ffffffff81584a29 RCX: 0000000000000004 RDX: 0000000000000001 RSI: 0000000000000081 RDI: 00007f61c4000020 RBP: 00007f61c43c11f0 R8: 0000000000000001 R9: 0000000000000003 R10: 0000000000000020 R11: 0000000000000206 R12: 00007f5eee2ed5f0 R13: 00007f5f5941f6e0 R14: 00007f5f5941f750 R15: 0000000000000020 ORIG_RAX: 00000000000000ca CS: 0033 SS: 002bPID: 4173 TASK: ffff8802c3d1cb60 CPU: 20 COMMAND: "myapp" #0 [ffff880317d47e30] crash_nmi_callback at ffffffff81038009 #1 [ffff880317d47e40] nmi_handle at ffffffff8157d7fa #2 [ffff880317d47ea0] default_do_nmi at ffffffff8157d938 #3 [ffff880317d47ed0] do_nmi at ffffffff8157db70 #4 [ffff880317d47ef0] end_repeat_nmi at ffffffff8157ce40 [exception RIP: _raw_spin_lock+32] RIP: ffffffff8157c690 RSP: ffff8801cc787e58 RFLAGS: 00000206 RAX: 0000000000000010 RBX: 0000000000000010 RCX: 0000000000000206 RDX: ffff8801cc787e58 RSI: 0000000000000018 RDI: 0000000000000001 RBP: ffffffff8157c690 R8: ffffffff8157c690 R9: 0000000000000018 R10: ffff8801cc787e58 R11: 0000000000000206 R12: ffffffffffffffff R13: ffffffff81d999e0 R14: 00000000d630e477 R15: 00000000000085ed ORIG_RAX: 00000000000085ed CS: 0010 SS: 0018--- <NMI exception stack> --- #5 [ffff8801cc787e58] _raw_spin_lock at ffffffff8157c690 #6 [ffff8801cc787e60] futex_wake at ffffffff810b1194 #7 [ffff8801cc787ed0] do_futex at ffffffff810b305b #8 [ffff8801cc787ef0] sys_futex at ffffffff810b31bb #9 [ffff8801cc787f80] system_call_fastpath at ffffffff81584a29 RIP: 00007f63c0ab6e9f RSP: 00007f62fe7fb0b0 RFLAGS: 00000216 RAX: 00000000000000ca RBX: ffffffff81584a29 RCX: 0000000000000000 RDX: 0000000000000001 RSI: 0000000000000081 RDI: 00007f61c4000020 RBP: 0000000000000230 R8: 00000000ffffffff R9: 00007f62fe7fb568 R10: 0000000000000001 R11: 0000000000000206 R12: 0000000000000001 R13: 0000000000000000 R14: 00007f5f3d50e1e0 R15: 00007f61c4000020 ORIG_RAX: 00000000000000ca CS: 0033 SS: 002bPID: 2689 TASK: ffff88018ef72100 CPU: 21 COMMAND: "bash" #0 [ffff88019038ba30] machine_kexec at ffffffff8103f329 #1 [ffff88019038baa0] crash_kexec at ffffffff810bd958 #2 [ffff88019038bb70] oops_end at ffffffff8157d698 #3 [ffff88019038bba0] no_context at ffffffff81048ace #4 [ffff88019038bbf0] __bad_area_nosemaphore at ffffffff81048cdd #5 [ffff88019038bc40] bad_area at ffffffff81048e2e #6 [ffff88019038bc70] do_page_fault at ffffffff81580385 #7 [ffff88019038bd80] page_fault at ffffffff8157cae5 [exception RIP: sysrq_handle_crash+22] RIP: ffffffff81331506 RSP: ffff88019038be38 RFLAGS: 00010092 RAX: 000000000000000f RBX: 0000000000000063 RCX: 0000000000002e98 RDX: 00000000000056f6 RSI: 0000000000000082 RDI: 0000000000000063 RBP: ffff88019038be38 R8: 0000000000000003 R9: 0000000000015360 R10: 000000000000040d R11: 000000000000040e R12: ffffffff81a9b720 R13: 0000000000000286 R14: 0000000000000004 R15: 0000000000000000 ORIG_RAX: ffffffffffffffff CS: 0010 SS: 0018 #8 [ffff88019038be40] __handle_sysrq at ffffffff81331d39 #9 [ffff88019038be80] write_sysrq_trigger at ffffffff81331dea#10 [ffff88019038beb0] proc_reg_write at ffffffff811daaad#11 [ffff88019038bf00] vfs_write at ffffffff81177d08#12 [ffff88019038bf30] sys_write at ffffffff81177ed1#13 [ffff88019038bf80] system_call_fastpath at ffffffff81584a29 RIP: 00007f3a97081450 RSP: 00007fff813d07e0 RFLAGS: 00010206 RAX: 0000000000000001 RBX: ffffffff81584a29 RCX: 0000000000000400 RDX: 0000000000000002 RSI: 00007f3a97981000 RDI: 0000000000000001 RBP: 00007f3a97981000 R8: 000000000000000a R9: 00007f3a97983700 R10: 00000000ffffffff R11: 0000000000000246 R12: 0000000000000002 R13: 00007f3a97344780 R14: 0000000000000002 R15: 00007f3a97344780 ORIG_RAX: 0000000000000001 CS: 0033 SS: 002bPID: 10569 TASK: ffff8802e29b20c0 CPU: 22 COMMAND: "myapp" #0 [ffff880317d67e30] crash_nmi_callback at ffffffff81038009 #1 [ffff880317d67e40] nmi_handle at ffffffff8157d7fa #2 [ffff880317d67ea0] default_do_nmi at ffffffff8157d938 #3 [ffff880317d67ed0] do_nmi at ffffffff8157db70 #4 [ffff880317d67ef0] end_repeat_nmi at ffffffff8157ce40 [exception RIP: _raw_spin_lock+34] RIP: ffffffff8157c692 RSP: ffff8801c5473e58 RFLAGS: 00000216 RAX: 0000000000000010 RBX: 0000000000000010 RCX: 0000000000000216 RDX: ffff8801c5473e58 RSI: 0000000000000018 RDI: 0000000000000001 RBP: ffffffff8157c692 R8: ffffffff8157c692 R9: 0000000000000018 R10: ffff8801c5473e58 R11: 0000000000000216 R12: ffffffffffffffff R13: ffffffff81d999e0 R14: 00000000d630e477 R15: 00000000000085e2 ORIG_RAX: 00000000000085e2 CS: 0010 SS: 0018--- <NMI exception stack> --- #5 [ffff8801c5473e58] _raw_spin_lock at ffffffff8157c692 #6 [ffff8801c5473e60] futex_wake at ffffffff810b1194 #7 [ffff8801c5473ed0] do_futex at ffffffff810b305b #8 [ffff8801c5473ef0] sys_futex at ffffffff810b31bb #9 [ffff8801c5473f80] system_call_fastpath at ffffffff81584a29 RIP: 00007f63c0ab6e9f RSP: 00007f62ffffea60 RFLAGS: 00000216 RAX: 00000000000000ca RBX: ffffffff81584a29 RCX: 00007f61c4000050 RDX: 0000000000000001 RSI: 0000000000000081 RDI: 00007f61c4000020 RBP: 00007f5f4f457880 R8: 0000000000000005 R9: 0000000000000007 R10: 000000000000005f R11: 0000000000000206 R12: 0000000000000001 R13: 0000000000000001 R14: 00007f63c45927d0 R15: 000000000000005f ORIG_RAX: 00000000000000ca CS: 0033 SS: 002bPID: 11341 TASK: ffff88030d763540 CPU: 23 COMMAND: "myapp" #0 [ffff880197d67e30] crash_nmi_callback at ffffffff81038009 #1 [ffff880197d67e40] nmi_handle at ffffffff8157d7fa #2 [ffff880197d67ea0] default_do_nmi at ffffffff8157d938 #3 [ffff880197d67ed0] do_nmi at ffffffff8157db70 #4 [ffff880197d67ef0] end_repeat_nmi at ffffffff8157ce40 [exception RIP: _raw_spin_lock+34] RIP: ffffffff8157c692 RSP: ffff8802d8f6bce8 RFLAGS: 00000206 RAX: 0000000000000010 RBX: 0000000000000010 RCX: 0000000000000206 RDX: ffff8802d8f6bce8 RSI: 0000000000000018 RDI: 0000000000000001 RBP: ffffffff8157c692 R8: ffffffff8157c692 R9: 0000000000000018 R10: ffff8802d8f6bce8 R11: 0000000000000206 R12: ffffffffffffffff R13: ffffffff81d999e0 R14: 00000000d630e477 R15: 00000000000085dc ORIG_RAX: 00000000000085dc CS: 0010 SS: 0018--- <NMI exception stack> --- #5 [ffff8802d8f6bce8] _raw_spin_lock at ffffffff8157c692 #6 [ffff8802d8f6bcf0] futex_wait_setup at ffffffff810b1f09 #7 [ffff8802d8f6bd60] futex_wait at ffffffff810b212b #8 [ffff8802d8f6bed0] do_futex at ffffffff810b303f #9 [ffff8802d8f6bef0] sys_futex at ffffffff810b31bb#10 [ffff8802d8f6bf80] system_call_fastpath at ffffffff81584a29 RIP: 00007f63c0ab6e6e RSP: 00007f6036dd9928 RFLAGS: 00010206 RAX: 00000000000000ca RBX: ffffffff81584a29 RCX: 0000000000010000 RDX: 0000000000000002 RSI: 0000000000000080 RDI: 00007f61c4000020 RBP: 0000000000000230 R8: 00007f5f0c6ce6eb R9: 0000000000000000 R10: 0000000000000000 R11: 0000000000000202 R12: 0000000000000000 R13: 0000000000000000 R14: 00007f63cc5829a0 R15: 00007f61c4000020 ORIG_RAX: 00000000000000ca CS: 0033 SS: 002bCould somebody give me some hints on how to approach this problem?In my user-space code, I don't have any tight loops that might end up calling the futex.It looks like something is holding the futex spinlock for too long, or something has pre-empted the task holding the spinlock (can this happen?) causing all the other running tasks to pile up and contend for the same spinlock. How can I tell who is the owner of the spinlock? Can I get this information from the kernel dump with "crash", or is there another tool that would tell me that?First, please test against a newer kernel or this bug will be made obsolete if not tested.Cheers Nick
id=62901	Createddmesg with ESI Juli@ soud cardI have periodicity error message "exception Emask 0x50 SAct 0x0 SErr 0x4090800 action 0xe frozen" for all sata devices in system when I insert sound card ESI Juli@. Createddmesg without ESI Juli@ soud cardVery strange but without sound card I have trouble with USB[16945.101322] usb 2-5: USB disconnect, device number 21[16945.101436] usb 2-5: Set SEL for device-initiated U1 failed.[16945.101438] usb 2-5: Set SEL for device-initiated U2 failed.[16945.648501] usb 2-5: new SuperSpeed USB device number 22 using xhci_hcd[16945.661603] usb 2-5: New USB device found, idVendor=2109, idProduct=0811[16945.661606] usb 2-5: New USB device strings: Mfr=1, Product=2, SerialNumber=0[16945.661607] usb 2-5: Product: 4-Port USB 3.0 Hub[16945.661607] usb 2-5: Manufacturer: VIA Labs, Inc.[16945.663313] hub 2-5:1.0: USB hub found[16945.663420] hub 2-5:1.0: 4 ports detected[16950.460216] usb 2-5: USB disconnect, device number 22[16950.460492] usb 2-5: Set SEL for device-initiated U1 failed.[16950.460498] usb 2-5: Set SEL for device-initiated U2 failed.[16951.007784] usb 2-5: new SuperSpeed USB device number 23 using xhci_hcd[16951.020475] usb 2-5: New USB device found, idVendor=2109, idProduct=0811[16951.020483] usb 2-5: New USB device strings: Mfr=1, Product=2, SerialNumber=0[16951.020488] usb 2-5: Product: 4-Port USB 3.0 Hub[16951.020492] usb 2-5: Manufacturer: VIA Labs, Inc.[16951.022553] hub 2-5:1.0: USB hub found[16951.022641] hub 2-5:1.0: 4 ports detected[16955.636186] usb 2-5: USB disconnect, device number 23[16955.636295] usb 2-5: Set SEL for device-initiated U1 failed.[16955.636297] usb 2-5: Set SEL for device-initiated U2 failed.[16956.183718] usb 2-5: new SuperSpeed USB device number 24 using xhci_hcd[16956.196528] usb 2-5: New USB device found, idVendor=2109, idProduct=0811[16956.196537] usb 2-5: New USB device strings: Mfr=1, Product=2, SerialNumber=0[16956.196541] usb 2-5: Product: 4-Port USB 3.0 Hub[16956.196546] usb 2-5: Manufacturer: VIA Labs, Inc.[16956.198498] hub 2-5:1.0: USB hub found[16956.198583] hub 2-5:1.0: 4 ports detected[mikhail@localhost ~]$ lspci00:00.0 Host bridge: Intel Corporation 4th Gen Core Processor DRAM Controller (rev 06)00:02.0 VGA compatible controller: Intel Corporation Xeon E3-1200 v3/4th Gen Core Processor Integrated Graphics Controller (rev 06)00:03.0 Audio device: Intel Corporation Xeon E3-1200 v3/4th Gen Core Processor HD Audio Controller (rev 06)00:14.0 USB controller: Intel Corporation 8 Series/C220 Series Chipset Family USB xHCI (rev 04)00:16.0 Communication controller: Intel Corporation 8 Series/C220 Series Chipset Family MEI Controller #1 (rev 04)00:1b.0 Audio device: Intel Corporation 8 Series/C220 Series Chipset High Definition Audio Controller (rev 04)00:1c.0 PCI bridge: Intel Corporation 8 Series/C220 Series Chipset Family PCI Express Root Port #1 (rev d4)00:1c.2 PCI bridge: Intel Corporation 8 Series/C220 Series Chipset Family PCI Express Root Port #3 (rev d4)00:1c.3 PCI bridge: Intel Corporation 82801 PCI Bridge (rev d4)00:1c.4 PCI bridge: Intel Corporation 8 Series/C220 Series Chipset Family PCI Express Root Port #5 (rev d4)00:1f.0 ISA bridge: Intel Corporation Z87 Express LPC Controller (rev 04)00:1f.2 SATA controller: Intel Corporation 8 Series/C220 Series Chipset Family 6-port SATA Controller 1 [AHCI mode] (rev 04)00:1f.3 SMBus: Intel Corporation 8 Series/C220 Series Chipset Family SMBus Controller (rev 04)02:00.0 Ethernet controller: Realtek Semiconductor Co., Ltd. RTL8111/8168/8411 PCI Express Gigabit Ethernet Controller (rev 06)03:00.0 PCI bridge: Intel Corporation 82801 PCI Bridge (rev 41)04:00.0 Multimedia audio controller: VIA Technologies Inc. VT1720/24 [Envy24PT/HT] PCI Multi-Channel Audio Controller (rev 01)05:00.0 Audio device: Creative Labs Device 0012 (rev 01)[mikhail@localhost ~]$ lsusbBus 002 Device 014: ID 2109:0811 Bus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hubBus 001 Device 004: ID 12d1:1506 Huawei Technologies Co., Ltd. Modem/NetworkcardBus 001 Device 007: ID 0a12:0001 Cambridge Silicon Radio, Ltd Bluetooth Dongle (HCI mode)Bus 001 Device 006: ID 046d:c52b Logitech, Inc. Unifying ReceiverBus 001 Device 008: ID 04d9:1503 Holtek Semiconductor, Inc. Shortboard LeftyBus 001 Device 005: ID 05e3:0608 Genesys Logic, Inc. USB-2.0 4-Port HUBBus 001 Device 003: ID 1a40:0201 Terminus Technology Inc. FE 2.1 7-port HubBus 001 Device 002: ID 2109:0811 Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub[mikhail@localhost ~]$The controller is reporting PHY events, meaning that the connection between the controller and your drive is experiencing communication glitches. SATA connections tend to be fairly sensitive to interferences. After all, the cables are unshielded and running at very high frequency. I don't think there's much the driver can do to address the root issue. It's most likely an electrical problem.* Try to force lower connection speed using libata.force kernel parameter.* Move the audio card to a different slot and rearrange the cables.Thanks.How can we explain this? just a coincidence? Why the error happens on all USB and SATA devices simultaneously?[12095.221788] usb 2-5: USB disconnect, device number 14[12095.221899] usb 2-5: Set SEL for device-initiated U1 failed.[12095.221901] usb 2-5: Set SEL for device-initiated U2 failed.[12095.647490] ata2: SATA link up 3.0 Gbps (SStatus 123 SControl 320)[12095.648474] ata1: SATA link up 3.0 Gbps (SStatus 123 SControl 320)[12095.659647] ata2.00: configured for UDMA/133[12095.659650] ata2: EH complete[12095.670155] ata1.00: configured for UDMA/133[12095.670161] ata1: EH completeCreateddmesg with ESI Juli@ soud cardIt looks like your sound card is messing up the system electronically. I don't really think there's much can be done from software side. Contact the manufacturer / try different power supply / try to shield the device somehow / etc...Ok but why without sound card we see this:Createddmesg output on debug kernelWhen I Move the audio card to a different slot system became unbottable, please see this video:Createdsystem log when system became unbottableCreatedphoto of screen when displayed errorsseems hangs occurs after it:окт 15 16:18:20 localhost.localdomain libvirtd[610]: libvirt version: 1.1.3, package: 2.fc20 (Fedora Project, 2013-10-06-19:24:41, buildvm-11.phx2.fedoraproject.org)mean that in system log no more records and last record is above.I am sure this is software bug , because in rescue mode system not hangs when sound card inserted in problem slot.Boot fails because your drive goes away before boot is finished. It's still the same problem, just happening faster. Also, fedora rescue mode doesn't mount or use the hard drive once the kernel and initrd are loaded, so the drive failure going away doesn't really indicate much.Your dmesg is also showing a single bit corruption in slab red zone, which may be caused by several things, but looking at the cluster of failures, I think it's likely that your machine is having serious hardware issues with that audio controller.From the information you've posted so far, it seems highly unlikely this is something which is caused by software. Unrelated devices can't normally cause PHY events on SATA connections through driver issues. I'd strongly suggest taking the offending device out of the system.Very strange because this controller works fine with another motherboard asrock.com/mb/Intel/H61MU3S3Problem begins after upgrade to Haswell desktopFedora in rescue mode mount all partitions difference between usual operation that for audio uses dummy output (no loaded audio driver) and for video used llvmpipe (software video). Maybe audio and video driver contain bug which changed registers or DMA which used by SATA controller?Createdscreenshot of rescue modeCreateddmesg output of rescue modeHmmm... so if you boot the system normally and unload the sound driver, are things okay? I have no idea why the new system is having problem with the audio controller, but the nature of the problem seems very low level. It is possible that the audio driver can do something to put it in a different mode or whatever to work around it but my general feeling is something is going wrong at a very low hardware level.Just a hunch but haswell systems reportedly have issues with certain power supplies because of its idle consumption gets too low. Does disabling all CPU powersaving states from BIOS change anything?Thanks.Very interesting notice! I just added module snd-ice1724 to black list and problem was gone (mean that system with sound card was booted and work properly), but of course sound card not work.# Cat / etc / modprobe.d / blacklist.confblacklist snd-ice1724What does this mean? snd-ice1724 is buggy driver?cc'ing Takashi.Mikhail, it might be that there's something the driver can do to resolve the issue but I'm still much more inclined towards actual hardware problem which can't be worked around from driver side.BTW, have you tried disabling all CPU power saving states from BIOS?Thank.sI don't know of any issue with snd-ice1724 and Juli@ now, so very likely it's an issue triggered by the special hardware combination. Do you have any other PCI sound card (not PCI-e) to check whether it works with this mobo?Also for Haswell, you may try intel_iommu=off boot option. I saw quite a few bugs related with Intel IOMMU on Haswell on DIY machines.I found in BIOS follow options and disable their:CPU Enhanced Halt(C1E)C3 State SupportC6/C7 State SupportRC6(Render Standby)But it not helps and system hangs during boot, if sound card module unblacklisted.Which other BIOS options I should to disable (please see my photos)?CreatedBIOS - Advanced CPU Core SetingsCreatedBIOS - Power ManagementAlso I tried and this option but without any success.Createdsystem log with intel_iommu=off and disable CPU power saving states (hope contain any usefull info)I inserted my old Audigy 2 SB240 soundcard in problem slot. I can boot my system but I see again:6750.482787] ata1: exception Emask 0x50 SAct 0x0 SErr 0x4090800 action 0xe frozen[ 6750.482791] ata1: irq_stat 0x00400040, connection status changed[ 6750.482794] ata1: SError: { HostInt PHYRdyChg 10B8B DevExch }[ 6750.482798] ata1: hard resetting link[ 6750.482829] ata2: exception Emask 0x50 SAct 0x0 SErr 0x4090800 action 0xe frozen[ 6750.482831] ata2: irq_stat 0x00400040, connection status changed[ 6750.482832] ata2: SError: { HostInt PHYRdyChg 10B8B DevExch }[ 6750.482835] ata2: hard resetting link[ 6751.206141] ata1: SATA link up 1.5 Gbps (SStatus 113 SControl 310)[ 6751.207147] ata2: SATA link up 1.5 Gbps (SStatus 113 SControl 310)[ 6751.229030] ata1.00: configured for UDMA/33[ 6751.229035] ata1: EH complete[ 6751.326282] ata2.00: configured for UDMA/33[ 6751.326287] ata2: EH complete[ 6751.571611] ata1: exception Emask 0x50 SAct 0x0 SErr 0x4090800 action 0xe frozen[ 6751.571616] ata1: irq_stat 0x00400040, connection status changed[ 6751.571618] ata1: SError: { HostInt PHYRdyChg 10B8B DevExch }[ 6751.571623] ata1: hard resetting link[ 6751.571655] ata2: exception Emask 0x50 SAct 0x0 SErr 0x4090800 action 0xe frozen[ 6751.571657] ata2: irq_stat 0x00400040, connection status changed[ 6751.571659] ata2: SError: { HostInt PHYRdyChg 10B8B DevExch }[ 6751.571661] ata2: hard resetting link[ 6752.294551] ata1: SATA link up 1.5 Gbps (SStatus 113 SControl 310)[ 6752.294588] ata2: SATA link up 1.5 Gbps (SStatus 113 SControl 310)[ 6752.317522] ata1.00: configured for UDMA/33[ 6752.317527] ata1: EH complete[ 6752.385676] ata2.00: configured for UDMA/33[ 6752.385682] ata2: EH completeCreateddmesg with Audigy 2 SB240 soud cardCreatedsystem log[root@localhost ~]# smartctl -Ai /dev/sdasmartctl 6.2 2013-07-26 r3841 [x86_64-linux-3.11.5-302.fc20.x86_64+debug] (local build)Copyright (C) 2002-13, Bruce Allen, Christian Franke, www.smartmontools.org=== START OF INFORMATION SECTION ===Model Family: SandForce Driven SSDsDevice Model: OCZ-VERTEX3Serial Number: OCZ-H3AU140C2BGX1269LU WWN Device Id: 5 e83a97 eef5a6138Firmware Version: 2.15User Capacity: 90,028,302,336 bytes [90.0 GB]Sector Size: 512 bytes logical/physicalRotation Rate: Solid State DeviceDevice is: In smartctl database [for details use: -P show]ATA Version is: ATA8-ACS, ACS-2 T13/2015-D revision 3SATA Version is: SATA 3.0, 6.0 Gb/s (current: 1.5 Gb/s)Local Time is: Sun Oct 20 12:28:13 2013 YEKTSMART support is: Available - device has SMART capability.SMART support is: Enabled=== START OF READ SMART DATA SECTION ===SMART Attributes Data Structure revision number: 10Vendor Specific SMART Attributes with Thresholds:ID# ATTRIBUTE_NAME FLAG VALUE WORST THRESH TYPE UPDATED WHEN_FAILED RAW_VALUE 1 Raw_Read_Error_Rate 0x000f 120 120 050 Pre-fail Always - 0/0 5 Retired_Block_Count 0x0033 100 100 003 Pre-fail Always - 0 9 Power_On_Hours_and_Msec 0x0032 089 089 000 Old_age Always - 10200h+17m+51.210s 12 Power_Cycle_Count 0x0032 100 100 000 Old_age Always - 181171 Program_Fail_Count 0x0032 000 000 000 Old_age Always - 0172 Erase_Fail_Count 0x0032 000 000 000 Old_age Always - 0174 Unexpect_Power_Loss_Ct 0x0030 000 000 000 Old_age Offline - 67177 Wear_Range_Delta 0x0000 000 000 000 Old_age Offline - 1181 Program_Fail_Count 0x0032 000 000 000 Old_age Always - 0182 Erase_Fail_Count 0x0032 000 000 000 Old_age Always - 0187 Reported_Uncorrect 0x0032 100 100 000 Old_age Always - 0194 Temperature_Celsius 0x0022 030 030 000 Old_age Always - 30 (Min/Max 30/30)195 ECC_Uncorr_Error_Count 0x001c 100 100 000 Old_age Offline - 0/0196 Reallocated_Event_Count 0x0033 100 100 003 Pre-fail Always - 0201 Unc_Soft_Read_Err_Rate 0x001c 100 100 000 Old_age Offline - 0/0204 Soft_ECC_Correct_Rate 0x001c 100 100 000 Old_age Offline - 0/0230 Life_Curve_Status 0x0013 100 100 000 Pre-fail Always - 100231 SSD_Life_Left 0x0013 100 100 010 Pre-fail Always - 0233 SandForce_Internal 0x0000 000 000 000 Old_age Offline - 2795234 SandForce_Internal 0x0032 000 000 000 Old_age Always - 5608241 Lifetime_Writes_GiB 0x0032 000 000 000 Old_age Always - 5608242 Lifetime_Reads_GiB 0x0032 000 000 000 Old_age Always - 6670[root@localhost ~]# smartctl -Ai /dev/sdbsmartctl 6.2 2013-07-26 r3841 [x86_64-linux-3.11.5-302.fc20.x86_64+debug] (local build)Copyright (C) 2002-13, Bruce Allen, Christian Franke, www.smartmontools.org=== START OF INFORMATION SECTION ===Model Family: Seagate Barracuda 7200.14 (AF)Device Model: ST3000DM001-9YN166Serial Number: W1F0N4VTLU WWN Device Id: 5 000c50 05258d1feFirmware Version: CC4CUser Capacity: 3,000,592,982,016 bytes [3.00 TB]Sector Sizes: 512 bytes logical, 4096 bytes physicalRotation Rate: 7200 rpmDevice is: In smartctl database [for details use: -P show]ATA Version is: ATA8-ACS T13/1699-D revision 4SATA Version is: SATA 3.0, 6.0 Gb/s (current: 1.5 Gb/s)Local Time is: Sun Oct 20 12:28:40 2013 YEKT==> WARNING: A firmware update for this drive is available,see the following Seagate web pages:SMART support is: Available - device has SMART capability.SMART support is: Enabled=== START OF READ SMART DATA SECTION ===SMART Attributes Data Structure revision number: 10Vendor Specific SMART Attributes with Thresholds:ID# ATTRIBUTE_NAME FLAG VALUE WORST THRESH TYPE UPDATED WHEN_FAILED RAW_VALUE 1 Raw_Read_Error_Rate 0x000f 116 083 006 Pre-fail Always - 114294736 3 Spin_Up_Time 0x0003 094 092 000 Pre-fail Always - 0 4 Start_Stop_Count 0x0032 100 100 020 Old_age Always - 179 5 Reallocated_Sector_Ct 0x0033 100 100 036 Pre-fail Always - 0 7 Seek_Error_Rate 0x000f 084 060 030 Pre-fail Always - 302132984 9 Power_On_Hours 0x0032 089 089 000 Old_age Always - 10102 10 Spin_Retry_Count 0x0013 100 100 097 Pre-fail Always - 0 12 Power_Cycle_Count 0x0032 100 100 020 Old_age Always - 170183 Runtime_Bad_Block 0x0032 001 001 000 Old_age Always - 141184 End-to-End_Error 0x0032 100 100 099 Old_age Always - 0187 Reported_Uncorrect 0x0032 001 001 000 Old_age Always - 2719188 Command_Timeout 0x0032 098 092 000 Old_age Always - 19 19 3147189 High_Fly_Writes 0x003a 099 099 000 Old_age Always - 1190 Airflow_Temperature_Cel 0x0022 058 051 045 Old_age Always - 42 (Min/Max 41/42)191 G-Sense_Error_Rate 0x0032 100 100 000 Old_age Always - 0192 Power-Off_Retract_Count 0x0032 100 100 000 Old_age Always - 117193 Load_Cycle_Count 0x0032 099 099 000 Old_age Always - 3461194 Temperature_Celsius 0x0022 042 049 000 Old_age Always - 42 (0 22 0 0 0)197 Current_Pending_Sector 0x0012 100 001 000 Old_age Always - 0198 Offline_Uncorrectable 0x0010 100 001 000 Old_age Offline - 0199 UDMA_CRC_Error_Count 0x003e 200 200 000 Old_age Always - 10240 Head_Flying_Hours 0x0000 100 253 000 Old_age Offline - 9318h+00m+56.120s241 Total_LBAs_Written 0x0000 100 253 000 Old_age Offline - 47163341890975242 Total_LBAs_Read 0x0000 100 253 000 Old_age Offline - 274444924102865[root@localhost ~]#Also replace power supply to Toughpower XT 775W, but it's not solve problem :(Createddmesg with Audigy 2 SB240 soud card and Toughpower XT 775WChecking operation with an external SATA controller failed. After connected SSD to an external SATA controller, system can not boot. I see on screen "Reached target Basic System." and nothings happens.Createdboot screenI flashed ROM BIOS of external SATA controller and after it controller begin recognize SATA devices under Linux. Next experiment I plug HDD to external SATA controller and leave SDD in internal MB controller so I see in dmesg messages only for internal controller.Createddmesg with Audigy 2 SB240 soud card and HDD in external SATA controllerNow I am sure this messages added each time after ALSA captures the sound card for play[ 999.183471] ata4: exception Emask 0x50 SAct 0x0 SErr 0x4090800 action 0xe frozen[ 999.183474] ata4: irq_stat 0x00400040, connection status changed[ 999.183475] ata4: SError: { HostInt PHYRdyChg 10B8B DevExch }[ 999.183478] ata4: hard resetting link[ 999.905244] ata4: SATA link up 6.0 Gbps (SStatus 133 SControl 300)[ 999.928388] ata4.00: configured for UDMA/133[ 999.928393] ata4: EH completeAnybody hear me?The fact that both two individual sound cards cause the same problem implies that the problem is generically in the PCI slot specific on your hardware.I guess a similar problem may be triggered by other PCI cards, not only by sound cards, too.This means this problem in PCI or SATA controller.I have a very similar problem:Oct 24 14:02:59 localhost kernel: [ 201.429135] ata1: exception Emask 0x50 SAct 0x0 SErr 0x4090800 action 0xe frozenOct 24 14:02:59 localhost kernel: [ 201.429138] ata1: irq_stat 0x00400040, connection status changedOct 24 14:02:59 localhost kernel: [ 201.429141] ata1: SError: { HostInt PHYRdyChg 10B8B DevExch }Oct 24 14:02:59 localhost kernel: [ 201.429145] ata1: hard resetting linkOct 24 14:03:00 localhost kernel: [ 202.157561] ata1: SATA link up 6.0 Gbps (SStatus 133 SControl 300)Oct 24 14:03:00 localhost kernel: [ 202.158454] ata1.00: configured for UDMA/100Oct 24 14:03:00 localhost kernel: [ 202.158457] ata1: EH completeLots of log files on the RH bugzilla:I don't have a sound card in this box, but I can trigger the error by spiking CPU. Just running glxgears will cause the error to repeat one after another, idle back down and they almost completely disappear. Only seeming to reappear when CPU spikes a bit.Intel(R) Xeon(R) CPU E3-1270 v3 @ 3.50GHz, Supermicro X10SLM-F. I've tried swapping in known good SSDs, and spinning hard drives, swapping memory, power supplies, SATA cables etc.Current kernel is 3.11.4-201.fc19.x86_64, but I've tried 3.11 from Linus's tree and the current RC6 from 3.12, all the same errors.intel_iommu=off has no effect on the errors. Memtest86+ runs for hours without errors.After discussion with Supermicro, this SATA dropping issue is a known design bug with my particular MB model. They sent me a revised version and the problem as disappeared.My problem is not same because my controller is SATA controller: Intel Corporation 8 Series/C220 Series Chipset Family 6-port SATA Controller 1 [AHCI mode] (rev 04)It was possible to reproduce the problem with an empty PCI slot, when you connect the USB stick to the USB port.Look here:[160253.847876] usb 1-1: new high-speed USB device number 48 using xhci_hcd[160253.869555] usb 1-1: New USB device found, idVendor=1005, idProduct=b113[160253.869558] usb 1-1: New USB device strings: Mfr=1, Product=2, SerialNumber=3[160253.869559] usb 1-1: Product: USB DISK 2.0[160253.869560] usb 1-1: Manufacturer: www[160253.869561] usb 1-1: SerialNumber: B48C1F000001[160253.871886] usb-storage 1-1:1.0: USB Mass Storage device detected[160253.872171] scsi2725 : usb-storage 1-1:1.0[160254.876610] scsi 2725:0:0:0: Direct-Access www USB DISK 2.0 PMAP PQ: 0 ANSI: 0 CCS[160254.878423] sd 2725:0:0:0: Attached scsi generic sg5 type 0[160255.153141] sd 2725:0:0:0: [sde] 15654912 512-byte logical blocks: (8.01 GB/7.46 GiB)[160255.153393] sd 2725:0:0:0: [sde] Write Protect is off[160255.153395] sd 2725:0:0:0: [sde] Mode Sense: 23 00 00 00[160255.153616] sd 2725:0:0:0: [sde] No Caching mode page found[160255.153618] sd 2725:0:0:0: [sde] Assuming drive cache: write through[160255.155973] sd 2725:0:0:0: [sde] No Caching mode page found[160255.155976] sd 2725:0:0:0: [sde] Assuming drive cache: write through[160255.156453] sde: sde1[160255.310246] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160255.326007] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160255.326010] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160255.485150] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160255.501076] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160255.501079] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160255.660032] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160255.675775] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160255.675779] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160255.834915] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160255.850699] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160255.850701] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160256.009848] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160256.025663] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160256.025666] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160256.185718] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160256.201561] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160256.201564] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160256.354615] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160256.370409] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160256.370411] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160256.529643] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160256.545263] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160256.545265] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160256.704504] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160256.720339] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160256.720342] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160256.879450] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160256.895116] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160256.895118] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160257.054241] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160257.070052] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160257.070055] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160257.229114] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160257.244908] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160257.244912] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160257.398142] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160257.413792] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160257.413795] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160257.572904] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160257.588866] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160257.588868] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160257.747820] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160257.763666] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160257.763669] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160257.923803] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160257.939481] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160257.939485] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160258.098727] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160258.114417] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160258.114421] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160258.273640] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160258.289353] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160258.289357] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160258.442456] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160258.458208] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160258.458211] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160258.618381] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160258.634136] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160258.634139] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160258.793299] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160258.809015] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160258.809017] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160258.968198] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160258.983916] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160258.983919] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160259.143027] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160259.158798] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160259.158801] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160259.318000] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160259.333732] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160259.333734] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160259.486886] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160259.502651] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160259.502654] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160259.661737] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160259.677651] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160259.677653] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160259.836737] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160259.852533] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160259.852536] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160260.011590] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160260.027352] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160260.027356] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160260.186580] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160260.202226] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160260.202230] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160260.361380] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160260.377106] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160260.377109] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160260.530297] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160260.546044] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160260.546047] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160260.705181] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160260.720955] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160260.720958] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160260.881077] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160260.896833] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160260.896835] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160261.055962] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160261.072804] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160261.072807] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160261.231853] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160261.248490] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160261.248492] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160261.407809] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160261.423517] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160261.423519] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160261.424120] sd 2725:0:0:0: [sde] READ CAPACITY failed[160261.424122] sd 2725:0:0:0: [sde] [160261.424123] Result: hostbyte=DID_ERROR driverbyte=DRIVER_OK[160261.424124] sd 2725:0:0:0: [sde] Sense not available.[160261.576689] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160261.592356] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160261.592359] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160261.751749] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160261.767399] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160261.767402] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160261.926484] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160261.942311] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160261.942315] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160262.101314] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160262.117108] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160262.117111] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160262.276252] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160262.291949] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160262.291951] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160262.451196] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160262.466788] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160262.466791] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160262.620095] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160262.635958] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160262.635962] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160262.796014] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160262.811818] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160262.811821] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160262.971932] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160262.988668] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160262.988671] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160263.147779] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160263.163587] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160263.163590] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160263.322641] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160263.338448] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160263.338452] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160263.497549] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160263.513389] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160263.513392] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160263.667450] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160263.683219] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160263.683222] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160263.842351] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160263.858256] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160263.858259] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160264.017241] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160269.025125] usb 1-1: device descriptor read/8, error -110[160274.134207] usb 1-1: device descriptor read/8, error -110[160274.389136] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160279.397137] usb 1-1: device descriptor read/8, error -110[160284.507169] usb 1-1: device descriptor read/8, error -110[160284.761125] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160289.009522] usb 2-5: USB disconnect, device number 66[160289.010347] usb 2-5: Set SEL for device-initiated U1 failed.[160289.010364] usb 2-5: Set SEL for device-initiated U2 failed.[160289.769102] usb 1-1: device descriptor read/8, error -110[160294.878133] usb 1-1: device descriptor read/8, error -110[160295.133125] usb 1-1: reset high-speed USB device number 48 using xhci_hcd[160300.141155] usb 1-1: device descriptor read/8, error -110[160305.250213] usb 1-1: device descriptor read/8, error -110[160305.351133] sd 2725:0:0:0: Device offlined - not ready after error recovery[160305.351182] sd 2725:0:0:0: rejecting I/O to offline device[160305.351184] sd 2725:0:0:0: killing request[160305.351266] sd 2725:0:0:0: [sde] Asking for cache data failed[160305.351268] sd 2725:0:0:0: [sde] Assuming drive cache: write through[160305.351288] sd 2725:0:0:0: [sde] Attached SCSI removable disk[160305.751745] usb 2-5: new SuperSpeed USB device number 67 using xhci_hcd[160305.766532] usb 2-5: New USB device found, idVendor=2109, idProduct=0811[160305.766535] usb 2-5: New USB device strings: Mfr=1, Product=2, SerialNumber=0[160305.766537] usb 2-5: Product: 4-Port USB 3.0 Hub[160305.766539] usb 2-5: Manufacturer: VIA Labs, Inc.[160305.770056] hub 2-5:1.0: USB hub found[160305.770191] hub 2-5:1.0: 4 ports detected[160305.773101] usb 1-1: USB disconnect, device number 48[160305.781897] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597018[160305.781900] xhci_hcd 0000:00:14.0: xHCI xhci_drop_endpoint called with disabled ep ffff88061f597058[160305.939685] usb 1-1: new high-speed USB device number 49 using xhci_hcd[160306.001549] usb 1-1: device descriptor read/8, error -71[160306.317910] usb 1-1: device descriptor read/8, error -71[160306.571458] usb 1-1: new high-speed USB device number 50 using xhci_hcd[160306.728496] usb 1-1: device descriptor read/8, error -71[160306.893259] usb 1-1: device descriptor read/8, error -71[160307.148103] usb 1-1: new high-speed USB device number 51 using xhci_hcd[160312.156215] usb 1-1: device descriptor read/8, error -110[160317.265186] usb 1-1: device descriptor read/8, error -110[160317.518931] usb 1-1: new high-speed USB device number 52 using xhci_hcd[160322.527117] usb 1-1: device descriptor read/8, error -110[160327.636147] usb 1-1: device descriptor read/8, error -110[160327.737378] hub 1-0:1.0: unable to enumerate USB device on port 1[160396.419966] BUG: sleeping function called from invalid context at mm/slub.c:935[160396.419969] in_atomic(): 1, irqs_disabled(): 1, pid: 662, name: Xorg[160396.419970] INFO: lockdep is turned off.[160396.419971] irq event stamp: 384112[160396.419971] hardirqs last enabled at (384111): [<ffffffff81731b36>] _raw_spin_unlock_irqrestore+0x36/0x70[160396.419990] hardirqs last disabled at (384112): [<ffffffff8173235b>] _raw_spin_lock_irqsave+0x2b/0xa0[160396.419992] softirqs last enabled at (384052): [<ffffffff8107b461>] __do_softirq+0x1a1/0x410[160396.419995] softirqs last disabled at (384043): [<ffffffff8173d63c>] call_softirq+0x1c/0x30[160396.419999] CPU: 6 PID: 662 Comm: Xorg Tainted: G W 3.11.6-301.fc20.x86_64+debug #1[160396.420000] Hardware name: Gigabyte Technology Co., Ltd. Z87M-D3H/Z87M-D3H, BIOS F8 08/03/2013[160396.420001] ffffffff81a2e2bb ffff8807e562dd18 ffffffff817289cc 0000000000000000[160396.420003] ffff8807e562dd40 ffffffff810ad9e9 00000000000000d0 00000000000000d0[160396.420005] 0000000000000009 ffff8807e562dd98 ffffffff811d1ef7 ffffffff815a497d[160396.420007] Call Trace:[160396.420009] [<ffffffff817289cc>] dump_stack+0x54/0x74[160396.420012] [<ffffffff810ad9e9>] __might_sleep+0x179/0x230[160396.420014] [<ffffffff811d1ef7>] __kmalloc+0x67/0x3b0[160396.420018] [<ffffffff815a497d>] ? hid_dump_input+0x7d/0x90[160396.420019] [<ffffffff815a670a>] hid_alloc_report_buf+0x2a/0x30[160396.420023] [<ffffffffa00067f5>] logi_dj_ll_input_event+0xa5/0x1a0 [hid_logitech_dj][160396.420027] [<ffffffff8154a30e>] input_handle_event+0x8e/0x530[160396.420029] [<ffffffff8154a9d0>] input_inject_event+0x1b0/0x250[160396.420031] [<ffffffff8154a863>] ? input_inject_event+0x43/0x250[160396.420032] [<ffffffff8154f08f>] evdev_write+0xef/0x150[160396.420036] [<ffffffff811f1e80>] vfs_write+0xc0/0x1f0[160396.420039] [<ffffffff8121137c>] ? fget_light+0x28c/0x510[160396.420041] [<ffffffff811f28fc>] SyS_write+0x4c/0xa0[160396.420044] [<ffffffff8173bcd9>] system_call_fastpath+0x16/0x1b[160480.112700] ata4.00: exception Emask 0x10 SAct 0xc SErr 0x400100 action 0x6 frozen[160480.112704] ata4.00: irq_stat 0x08000000, interface fatal error[160480.112706] ata4: SError: { UnrecovData Handshk }[160480.112708] ata4.00: failed command: WRITE FPDMA QUEUED[160480.112712] ata4.00: cmd 61/40:10:b8:0c:ec/00:00:9d:00:00/40 tag 2 ncq 32768 out res 40/00:08:50:30:cd/00:00:8d:00:00/40 Emask 0x10 (ATA bus error)[160480.112713] ata4.00: status: { DRDY }[160480.112715] ata4.00: failed command: READ FPDMA QUEUED[160480.112718] ata4.00: cmd 60/28:18:70:79:e3/00:00:01:01:00/40 tag 3 ncq 20480 in res 40/00:08:50:30:cd/00:00:8d:00:00/40 Emask 0x10 (ATA bus error)[160480.112719] ata4.00: status: { DRDY }[160480.112723] ata4: hard resetting link[160480.418451] ata4: SATA link up 6.0 Gbps (SStatus 133 SControl 300)[160480.483190] ata4.00: configured for UDMA/133[160480.483203] ata4: EH completeSorry, but seem USB controller also conflict with SATA controller!!! What's happens?[68768.667386] ata4.00: exception Emask 0x0 SAct 0xf SErr 0x0 action 0x6 frozen[68768.667390] ata4.00: failed command: READ FPDMA QUEUED[68768.667393] ata4.00: cmd 60/20:00:d8:af:3a/00:00:f7:00:00/40 tag 0 ncq 16384 in res 40/00:00:00:4f:c2/00:00:00:00:00/40 Emask 0x4 (timeout)[68768.667394] ata4.00: status: { DRDY }[68768.667395] ata4.00: failed command: READ FPDMA QUEUED[68768.667397] ata4.00: cmd 60/20:08:20:d6:c6/00:00:20:01:00/40 tag 1 ncq 16384 in res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[68768.667398] ata4.00: status: { DRDY }[68768.667399] ata4.00: failed command: READ FPDMA QUEUED[68768.667400] ata4.00: cmd 60/20:10:60:eb:22/00:00:12:01:00/40 tag 2 ncq 16384 in res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[68768.667401] ata4.00: status: { DRDY }[68768.667402] ata4.00: failed command: READ FPDMA QUEUED[68768.667404] ata4.00: cmd 60/20:18:80:eb:22/00:00:12:01:00/40 tag 3 ncq 16384 in res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[68768.667405] ata4.00: status: { DRDY }[68768.667408] ata4: hard resetting link[68768.972048] ata4: SATA link up 6.0 Gbps (SStatus 133 SControl 300)[68768.976093] ata4.00: configured for UDMA/133[68768.976097] ata4.00: device reported invalid CHS sector 0[68768.976099] ata4.00: device reported invalid CHS sector 0[68768.976100] ata4.00: device reported invalid CHS sector 0[68768.976101] ata4.00: device reported invalid CHS sector 0[68768.976112] ata4: EH complete[69490.070624] =============================================================================[69490.070627] BUG filp (Not tainted): Poison overwritten[69490.070628] -----------------------------------------------------------------------------[69490.070629] Disabling lock debugging due to kernel taint[69490.070630] INFO: 0xffff8805352c4e26-0xffff8805352c4e26. First byte 0x69 instead of 0x6b[69490.070634] INFO: Allocated in get_empty_filp+0x61/0x250 age=9755 cpu=1 pid=2465[69490.070637] __slab_alloc+0x3eb/0x4fe[69490.070639] kmem_cache_alloc+0x294/0x340[69490.070640] get_empty_filp+0x61/0x250[69490.070642] path_openat+0x3d/0x6a0[69490.070643] do_filp_open+0x3a/0x90[69490.070645] do_sys_open+0x12e/0x210[69490.070647] SyS_open+0x1e/0x20[69490.070648] system_call_fastpath+0x16/0x1b[69490.070650] INFO: Freed in file_free_rcu+0x43/0x60 age=9723 cpu=1 pid=2465[69490.070651] __slab_free+0x3a/0x382[69490.070652] kmem_cache_free+0x356/0x370[69490.070653] file_free_rcu+0x43/0x60[69490.070655] rcu_process_callbacks+0x20a/0x7e0[69490.070658] __do_softirq+0x107/0x410[69490.070659] call_softirq+0x1c/0x30[69490.070661] do_softirq+0x85/0xc0[69490.070662] irq_exit+0xc5/0xd0[69490.070664] smp_apic_timer_interrupt+0x45/0x60[69490.070665] apic_timer_interrupt+0x72/0x80[69490.070667] selinux_ptrace_access_check+0x95/0x200[69490.070670] security_ptrace_access_check+0x13/0x20[69490.070671] __ptrace_may_access+0x1f9/0x4e0[69490.070673] ptrace_may_access+0x2e/0x50[69490.070675] do_task_stat+0x81/0xb60[69490.070676] proc_tid_stat+0x11/0x20[69490.070677] INFO: Slab 0xffffea0014d4b100 objects=23 used=23 fp=0x (null) flags=0x5ff00000004080[69490.070678] INFO: Object 0xffff8805352c4dc0 @offset=3520 fp=0xffff8805352c58c0[69490.070680] Bytes b4 ffff8805352c4db0: 5a 5a 5a 5a 5a 5a 5a 5a 5a 5a 5a 5a 5a 5a 5a 5a ZZZZZZZZZZZZZZZZ[69490.070681] Object ffff8805352c4dc0: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk[69490.070682] Object ffff8805352c4dd0: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk[69490.070682] Object ffff8805352c4de0: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk[69490.070683] Object ffff8805352c4df0: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk[69490.070684] Object ffff8805352c4e00: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk[69490.070685] Object ffff8805352c4e10: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk[69490.070686] Object ffff8805352c4e20: 6b 6b 6b 6b 6b 6b 69 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkikkkkkkkkk[69490.070686] Object ffff8805352c4e30: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk[69490.070687] Object ffff8805352c4e40: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk[69490.070688] Object ffff8805352c4e50: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk[69490.070689] Object ffff8805352c4e60: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk[69490.070690] Object ffff8805352c4e70: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk[69490.070690] Object ffff8805352c4e80: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk[69490.070691] Object ffff8805352c4e90: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk[69490.070692] Object ffff8805352c4ea0: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk[69490.070693] Object ffff8805352c4eb0: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk[69490.070694] Object ffff8805352c4ec0: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk[69490.070694] Object ffff8805352c4ed0: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk[69490.070695] Object ffff8805352c4ee0: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk[69490.070696] Object ffff8805352c4ef0: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk[69490.070697] Object ffff8805352c4f00: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk[69490.070698] Object ffff8805352c4f10: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b kkkkkkkkkkkkkkkk[69490.070698] Object ffff8805352c4f20: 6b 6b 6b 6b 6b 6b 6b a5 kkkkkkk.[69490.070699] Redzone ffff8805352c4f28: bb bb bb bb bb bb bb bb ........[69490.070700] Padding ffff8805352c5068: 5a 5a 5a 5a 5a 5a 5a 5a 5a 5a 5a 5a 5a 5a 5a 5a ZZZZZZZZZZZZZZZZ[69490.070701] Padding ffff8805352c5078: 5a 5a 5a 5a 5a 5a 5a 5a ZZZZZZZZ[69490.070702] CPU: 2 PID: 2465 Comm: htop Tainted: G B 3.12.0-2.fc21.x86_64+debug #1[69490.070703] Hardware name: Gigabyte Technology Co., Ltd. Z87M-D3H/Z87M-D3H, BIOS F8 08/03/2013[69490.070704] ffff8805352c4dc0 ffff8807bca77b78 ffffffff81742e92 ffff88081e81a1c0[69490.070707] ffff8807bca77bb8 ffffffff811d368d 0000000000000018 ffff880500000001[69490.070709] ffff8805352c4e27 ffff88081e81a1c0 000000000000006b ffff8805352c4dc0[69490.070710] Call Trace:[69490.070712] [<ffffffff81742e92>] dump_stack+0x54/0x74[69490.070714] [<ffffffff811d368d>] print_trailer+0x14d/0x200[69490.070715] [<ffffffff811d387f>] check_bytes_and_report+0xcf/0x110[69490.070717] [<ffffffff811d46f7>] check_object+0x1d7/0x250[69490.070718] [<ffffffff811f8201>] ? get_empty_filp+0x61/0x250[69490.070720] [<ffffffff81740613>] alloc_debug_processing+0x76/0x118[69490.070722] [<ffffffff8174124e>] __slab_alloc+0x3eb/0x4fe[69490.070724] [<ffffffff8174c0f7>] ? _raw_spin_unlock+0x27/0x40[69490.070725] [<ffffffff811d5c34>] ? deactivate_slab+0x544/0x630[69490.070726] [<ffffffff811f8201>] ? get_empty_filp+0x61/0x250[69490.070728] [<ffffffff811d6244>] kmem_cache_alloc+0x294/0x340[69490.070729] [<ffffffff811f8201>] ? get_empty_filp+0x61/0x250[69490.070731] [<ffffffff811f8201>] get_empty_filp+0x61/0x250[69490.070732] [<ffffffff8120725d>] path_openat+0x3d/0x6a0[69490.070735] [<ffffffff810f242d>] ? trace_hardirqs_on+0xd/0x10[69490.070737] [<ffffffff81021b45>] ? native_sched_clock+0x15/0x80[69490.070738] [<ffffffff810eebdd>] ? trace_hardirqs_off+0xd/0x10[69490.070740] [<ffffffff81207ffa>] do_filp_open+0x3a/0x90[69490.070741] [<ffffffff8174c0f7>] ? _raw_spin_unlock+0x27/0x40[69490.070744] [<ffffffff8121724f>] ? __alloc_fd+0xaf/0x200[69490.070746] [<ffffffff811f57fe>] do_sys_open+0x12e/0x210[69490.070747] [<ffffffff811f5914>] SyS_openat+0x14/0x20[69490.070749] [<ffffffff81756229>] system_call_fastpath+0x16/0x1b[69490.070750] FIX filp: Restoring 0xffff8805352c4e26-0xffff8805352c4e26=0x6b[69490.070751] FIX filp: Marking all objects usedCreateddmesg output with 3.12 kernel[75767.329715] ata4.00: exception Emask 0x10 SAct 0x7ff03 SErr 0x0 action 0x6 frozen[75767.329718] ata4.00: irq_stat 0x08000000, interface fatal error[75767.329720] ata4.00: failed command: READ FPDMA QUEUED[75767.329722] ata4.00: cmd 60/20:00:38:ec:c8/00:00:08:01:00/40 tag 0 ncq 16384 in res 40/00:38:b8:ea:c8/00:00:08:01:00/40 Emask 0x10 (ATA bus error)[75767.329723] ata4.00: status: { DRDY }[75767.329724] ata4.00: failed command: READ FPDMA QUEUED[75767.329726] ata4.00: cmd 60/20:08:58:ec:c8/00:00:08:01:00/40 tag 1 ncq 16384 in res 40/00:38:b8:ea:c8/00:00:08:01:00/40 Emask 0x10 (ATA bus error)[75767.329727] ata4.00: status: { DRDY }[75767.329728] ata4.00: failed command: READ FPDMA QUEUED[75767.329730] ata4.00: cmd 60/20:40:d8:ea:c8/00:00:08:01:00/40 tag 8 ncq 16384 in res 40/00:38:b8:ea:c8/00:00:08:01:00/40 Emask 0x10 (ATA bus error)[75767.329731] ata4.00: status: { DRDY }[75767.329732] ata4.00: failed command: READ FPDMA QUEUED[75767.329734] ata4.00: cmd 60/20:48:f8:ea:c8/00:00:08:01:00/40 tag 9 ncq 16384 in res 40/00:38:b8:ea:c8/00:00:08:01:00/40 Emask 0x10 (ATA bus error)[75767.329735] ata4.00: status: { DRDY }[75767.329736] ata4.00: failed command: READ FPDMA QUEUED[75767.329738] ata4.00: cmd 60/20:50:18:eb:c8/00:00:08:01:00/40 tag 10 ncq 16384 in res 40/00:38:b8:ea:c8/00:00:08:01:00/40 Emask 0x10 (ATA bus error)[75767.329739] ata4.00: status: { DRDY }[75767.329739] ata4.00: failed command: READ FPDMA QUEUED[75767.329741] ata4.00: cmd 60/20:58:38:eb:c8/00:00:08:01:00/40 tag 11 ncq 16384 in res 40/00:38:b8:ea:c8/00:00:08:01:00/40 Emask 0x10 (ATA bus error)[75767.329742] ata4.00: status: { DRDY }[75767.329743] ata4.00: failed command: READ FPDMA QUEUED[75767.329745] ata4.00: cmd 60/20:60:58:eb:c8/00:00:08:01:00/40 tag 12 ncq 16384 in res 40/00:38:b8:ea:c8/00:00:08:01:00/40 Emask 0x10 (ATA bus error)[75767.329746] ata4.00: status: { DRDY }[75767.329747] ata4.00: failed command: READ FPDMA QUEUED[75767.329748] ata4.00: cmd 60/20:68:78:eb:c8/00:00:08:01:00/40 tag 13 ncq 16384 in res 40/00:38:b8:ea:c8/00:00:08:01:00/40 Emask 0x10 (ATA bus error)[75767.329749] ata4.00: status: { DRDY }[75767.329750] ata4.00: failed command: READ FPDMA QUEUED[75767.329752] ata4.00: cmd 60/20:70:98:eb:c8/00:00:08:01:00/40 tag 14 ncq 16384 in res 40/00:38:b8:ea:c8/00:00:08:01:00/40 Emask 0x10 (ATA bus error)[75767.329753] ata4.00: status: { DRDY }[75767.329754] ata4.00: failed command: READ FPDMA QUEUED[75767.329756] ata4.00: cmd 60/20:78:b8:eb:c8/00:00:08:01:00/40 tag 15 ncq 16384 in res 40/00:38:b8:ea:c8/00:00:08:01:00/40 Emask 0x10 (ATA bus error)[75767.329757] ata4.00: status: { DRDY }[75767.329758] ata4.00: failed command: READ FPDMA QUEUED[75767.329759] ata4.00: cmd 60/20:80:d8:eb:c8/00:00:08:01:00/40 tag 16 ncq 16384 in res 40/00:38:b8:ea:c8/00:00:08:01:00/40 Emask 0x10 (ATA bus error)[75767.329760] ata4.00: status: { DRDY }[75767.329761] ata4.00: failed command: READ FPDMA QUEUED[75767.329763] ata4.00: cmd 60/20:88:f8:eb:c8/00:00:08:01:00/40 tag 17 ncq 16384 in res 40/00:38:b8:ea:c8/00:00:08:01:00/40 Emask 0x10 (ATA bus error)[75767.329764] ata4.00: status: { DRDY }[75767.329765] ata4.00: failed command: READ FPDMA QUEUED[75767.329767] ata4.00: cmd 60/20:90:18:ec:c8/00:00:08:01:00/40 tag 18 ncq 16384 in res 40/00:38:b8:ea:c8/00:00:08:01:00/40 Emask 0x10 (ATA bus error)[75767.329768] ata4.00: status: { DRDY }[75767.329770] ata4: hard resetting link[75767.634031] ata4: SATA link up 6.0 Gbps (SStatus 133 SControl 300)[75767.754311] ata4.00: configured for UDMA/133[75767.754338] ata4: EH completeCreateddmesg kernel 3.12Mikhail, your problem doesn't seem to be a software issue. You're experiencing a host of *electric* problems on your machine. Those external links fail first because they get affected the most but even the memory bits seem to be flipping. Can you please try put on a different power supply?Thanks.Yes, I try a few known good power supplys.CreatedMemory also work fineHmm... too bad. I have no idea what's going on but the machine seems screwed up in the layer way below where the OS can do anything. I'd try to contact the hardware manufacturer. If it's a custom build, maybe try RMA the motherboard? But, at any rate, you need an electronics engineer instead of an os dev.And, yeah, your ram sticks are likely fine in isolation but when all the stuff are going on, the kernel also reports errors which are highly likely results of bit flips. It's likely that the internal buses are being affected too.Thanks and good luck.[115463.382992] ata4.00: exception Emask 0x0 SAct 0xf SErr 0x0 action 0x6 frozen[115463.382996] ata4.00: failed command: WRITE FPDMA QUEUED[115463.382999] ata4.00: cmd 61/40:00:80:77:18/00:00:9e:00:00/40 tag 0 ncq 32768 out res 40/00:00:00:4f:c2/00:00:00:00:00/40 Emask 0x4 (timeout)[115463.383001] ata4.00: status: { DRDY }[115463.383002] ata4.00: failed command: READ FPDMA QUEUED[115463.383004] ata4.00: cmd 60/28:08:18:fc:64/00:00:13:01:00/40 tag 1 ncq 20480 in res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[115463.383005] ata4.00: status: { DRDY }[115463.383006] ata4.00: failed command: WRITE FPDMA QUEUED[115463.383008] ata4.00: cmd 61/50:10:d8:24:84/00:00:ae:00:00/40 tag 2 ncq 40960 out res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x4 (timeout)[115463.383010] ata4.00: status: { DRDY }[115463.383011] ata4.00: failed command: WRITE FPDMA QUEUED[115463.383013] ata4.00: cmd 61/10:18:d8:fc:b6/00:00:9d:00:00/40 tag 3 ncq 8192 out res 40/00:28:a0:ee:65/00:00:0b:01:00/40 Emask 0x4 (timeout)[115463.383014] ata4.00: status: { DRDY }[115463.383017] ata4: hard resetting link[115463.687794] ata4: SATA link up 6.0 Gbps (SStatus 133 SControl 300)[115463.715289] ata4.00: configured for UDMA/133[115463.715292] ata4.00: device reported invalid CHS sector 0[115463.715294] ata4.00: device reported invalid CHS sector 0[115463.715295] ata4.00: device reported invalid CHS sector 0[115463.715308] ata4: EH complete*** This bug has been marked as a duplicate of***Please do not leave me with this problem!!!Question: I have m/b Gigabyte Z87M-D3H with latest F10 BIOS. When I insert into PCI slot ESI Juli@ sound card my Linux Fedora 20 became unbottable. Red Hat kernel team said that this is hardware problem.3/13/2014 5:00 AMAttachments: dsc01958.jpg Answer: Good day!Thank you for contacting GBT Tech Support.Gigabyte motherboards passes the appropriate certification to be compatible with Microsoft operation systems (certified Windows Hardware Quality Labs / WHQL) Information about the compatibility can be found on the website Microsoft:. All Gigabyte products, all software is developed and tested only for Microsoft operation systems.In your case, GA-Z87M-D3H (rev. 1.x) supports Microsoft Windows 8/7.Also we notify our users that: "Due to different Linux support condition provided by chipset vendors, please download Linux driver from chipset vendors' website or 3rd party website." This information contained on our website.Thus, we can not guarantee stable operation of computer using the operating system LinuxBest Regards,GIGABYTE TechnologyCreatedgigabyte support answer
id=72891	After a recent kernel update to 3.13.6 my USB DVB-C device, a PCTV 510e, stopped working. The device is recognized as usual, and at first it is possible to get a stream from the device. After a while the stream stops, and further data transfer is not possible. This is probably related to a lot of fixes that went in recently to get USB working for bulk transfers.As suggested I tried the media_build approach yesterday to test backports of recent patches that did not went into 3.13. This did not fix the problem however. After a while the error "submit of urb 0 failed (error=-27)" appears in the syslog. Subsequent streams fail silently.Hardware:- Pinnacle Systems PCTV 510e @ 480 Mbps (2304:0242, interface 0, class 0)- em28xx: chip ID is em2884- em28xx: DVB interface 0 found: isoc- Intel® NUC Board DCP847SKE [1] with QS77 chipset [2]- The DVB-C USB stick is connected to a USB 2.0 port (the NUC kit only has USB 2.0 ports)USB tree:/: Bus 02.Port 1: Dev 1, Class=root_hub, Driver=ehci-pci/2p, 480M |__ Port 1: Dev 2, If 0, Class=Hub, Driver=hub/8p, 480M |__ Port 1: Dev 3, If 0, Class=Vendor Specific Class, Driver=em28xx, 480M |__ Port 2: Dev 4, If 0, Class=Hub, Driver=hub/4p, 12M |__ Port 4: Dev 6, If 0, Class=Vendor Specific Class, Driver=mceusb, 12M |__ Port 7: Dev 5, If 0, Class=Vendor Specific Class, Driver=ftdi_sio, 12M[1][2] Further investigation shows that the error is triggered from the ehci scheduler[1]. I'm currently running with some dynamic debugging enabled on those lines, as well as most em28xx debug options turned on.[1]And here is the trace obtained upon failure, showing that the scheduler overflows. Maybe the URB's are not removed from the queue, since this error happens after opening and closing the streams for a while.kernel: em2884 #0/2-dvb: Using 5 buffers each with 64 x 940 byteskernel: em2884 #0 em28xx_init_usb_xfer :em28xx: called em28xx_init_usb_xfer in mode 2kernel: ehci-pci 0000:00:1d.0: request ffff8800ccc59000 would overflow (8136+63 >= 8192)kernel: submit of urb 0 failed (error=-27)kernel: em2884 #0 em28xx_uninit_usb_xfer :em28xx: called em28xx_uninit_usb_xfer in mode 2This was already fixed in media_build, but somehow the backported modules did not load into my kernel. Seems the media_build script does not work completely as intended on my distribution (Arch Linux), I needed to run depmod manually.Apparently the problem still occurs in the backported module, since I got the error again a few minutes ago. So I'm reopening the report again, sorry for the confusion.em2884 #0/2-dvb: Using 5 buffers each with 64 x 940 bytes, alternate 1em2884 #0 em28xx_init_usb_xfer :em28xx: called em28xx_init_usb_xfer in mode 2submit of urb 0 failed (error=-27)em2884 #0 em28xx_uninit_usb_xfer :em28xx: called em28xx_uninit_usb_xfer in mode 2This time I'm sure about the version used.I am also seeing this with a 290e with any of the FC20 3.13 kernels. It works fine with 3.11.10 from the Fedora repo.Please let me know if I can provide anything that would help resolve this.There were some changes to the module made by Frank Schaefer which added analog video and improved USB endpoint and alternate setting handling. Those commits introduced this bug, and there are some weird USB related timing issues that need to be handled.So I'm adding the USB descriptor for my device to this bug report. I have some serious doubts about the correctness of the bNumInterfaces value being reported as "1" by my device, since there are 8 Interface Descriptors present.Between those the various configurations of the endpoints differ, namely the wMaxPacketSize and bInterval. I also think that setting the current value of interval in the urb struct to hardcoded "1" would cause problems on both xHCI hardware (Mauro patched this in is em28xx-audio code [1]).I'm guessing that the current code selects the wrong interface configuration, and that the USB HCI scheduling fails to fill the buffers in time.[1]CreatedOutput of lsusb for PCTV 510e(In reply to beralt from)Which commit are you talking about ?There's nothing unusual with your device descriptor.A single interface (#0) with 8 alternate settings, EP 0x82 = analog video, EP 0x83 = audio, EP 0x84 = DVB.(In reply to schaefer.frank from)The only relevant commit I can think of is this one:And the bug does not appear in 3.12, only in 3.13 and above (including the media_build tree). Using the media_build tree also introduces the debug message about which alternate was used, and that was 1 in my case. That seems right, so maybe this is related to EHCI scheduling instead?Good to know. If there is anything I can do to help let me know.(In reply to beralt from)I doubt that, this change has been introduced with kernel 3.14 and it has not been backported to older kernels. ;-)I can't think of any USB related changes in the em28xx driver between 3.12 and 3.13.How long can you capture before you get the error ?Does it happen with analog and DVB capturing ?(In reply to schaefer.frank from)I tested with the upstream media_tree to check if the bug might have been fixed. But I used a 3.13 kernel in combination with the upstream media tree. I will test against 3.12 too, since I'm suspecting this might be related to changes in the ehci scheduler [1]Then we can rule out the em28xx module? Let me test this by using the upstream code on a 3.12 kernel.It happens with DVB (I do not use analog). I use TVHeadend, and during its EPG data scanning it opens and closes streams, causing the init_usb_xfer calls, followed by stop_urbs when it's done. This is repeated a few times (somewhere around 40 times) and then the ehchi scheduler queue overflows. So it seems that some URB's stay in the queue, despite kill()ing them. The device stops working once the queue is full, and resetting the ehci controller by rebooting is the only solution.[1](In reply to beralt from)I'm not saying that the actual problem isn't in the em28xx driver, but at least nothing has changed here between 3.12 and 3.13.There have indeed been several EHCI scheduling related changes recently.At the moment, I would focus on them.This is something that has been plaguing me for months,i thought it was the AMD E350 motherboard i was using but finding this bug post makes me wonder.I run mythtv-backend 0.27 with 2x PCTV 290e's and get the "submit of urb 0 failed (error=-27)" errors, i get them at least once a week.xubuntu saucy x64 3.13.1-031301-generic.I have the same effect [1] after a while with my PCTV 461e device. I have tried kernels 3.14 and 3.15-rc7.[1] "submit of urb 0 failed (error=-27)"I have seen that also quite often with multiple em28xx based DVB devices.I wanted to git bisect this. I do not get my 461e device to work with media_build and 3.12 though.This is still happening almost every day and requires to unload/load the em28xx modules.Jul 5 08:02:54 foo tvheadend[4115]: linuxdvb: Montage M88DS3103 : DVB-S #0 - failed to config dmx for pid 0 [e=File too large]Jul 5 08:02:54 foo kernel: [463524.477658] submit of urb 0 failed (error=-27)Throwing "options em28xx usb_xfer_mode=0" into /etc/modprobe.d/em28xx.conf seems to avoid the issue for me.HTH.Martin - what kernel version have you tested this option with? Thanks.I am currently running Debian's 3.14 Kernel:Linux foo 3.14-2-amd64 #1 SMP Debian 3.14.15-2 (2014-08-09) x86_64 GNU/LinuxHmm. I've tried this under 3.15.10 on Fedora 20 and it lasted for about 24 hours, but today it failed with:Aug 17 16:17:34 pvr kernel: [28704.791573] submit of urb 0 failed (error=-27)Aug 17 16:17:34 pvr kernel: submit of urb 0 failed (error=-27)Reverting back to 3.11.10.(In reply to Martin Sofaru from)I tried this on 3.16.1 (x86_64) and setting this option avoided the issue for about three days now. So I guess this solves the problem for me too, although I'm not sure why. Setting it to "0" means "prefer isoc". The device used isoc transfers for DVB when the issue did occur, so setting this option should not change anything.Haven't had the problem in 3.16.1 yet and didn't set usb_xfer_mode=0.maybe something has been fixed/changed.Using the module parameter usb_xfer_mode=0 has no effect.Without it, the driver prefers isoc transfers, too (exception: camera devices).I know it's annoying, but someone will have to git bisect it. :/Unfortunately I am seeing exactly the same behaviour with kernel-3.16.2 on Fedora 20. I don't see any evidence of a resolution.Any movement on this? Somebody's commit has broken this, and I've been unable to use this piece of hardware for over 6 months now. (This broken kernel is part of an LTE release of Ubuntu, which I had expected to work as previous versions).em28xx driver is maintained by Mauro, but I think he could not reproduce issue. Also, I suspect that issue is likely seen only certain USB hist controllers as it seems to work for many people.For me, I can see that issues with both USB controllers I have:ASM1042 SuperSpeed USB Host ControllerSB7x0/SB8x0/SB9x0 USB EHCI ControllerIf there is no progress on getting it fixed, can we not roll back all of the patches on this module since the last known working version? Just breaking stuff and then leaving it broken is not good. Not sure what my USB controller is. dmesg dump (including host and TV contoller): [ 0.804139] usb usb1: New USB device found, idVendor=1d6b, idProduct=0002[ 0.804141] usb usb1: New USB device strings: Mfr=3, Product=2, SerialNumber=1[ 0.804144] usb usb1: Product: EHCI Host Controller[ 0.804146] usb usb1: Manufacturer: Linux 3.13.0-36-generic ehci_hcd[ 0.804148] usb usb1: SerialNumber: 0000:00:04.1[ 0.862044] usb usb2: New USB device found, idVendor=1d6b, idProduct=0001[ 0.862047] usb usb2: New USB device strings: Mfr=3, Product=2, SerialNumber=1[ 0.862049] usb usb2: Product: OHCI PCI host controller[ 0.862051] usb usb2: Manufacturer: Linux 3.13.0-36-generic ohci_hcd[ 0.862053] usb usb2: SerialNumber: 0000:00:04.0[ 1.120056] usb 1-4: new high-speed USB device number 2 using ehci-pci[ 1.255914] usb 1-4: New USB device found, idVendor=1b80, idProduct=e409[ 1.255920] usb 1-4: New USB device strings: Mfr=1, Product=2, SerialNumber=0[ 1.255925] usb 1-4: Product: DVB-T TV Stick[ 1.255929] usb 1-4: Manufacturer: ITE Technologies, Inc.[ 1.368077] usb 1-5: new high-speed USB device number 3 using ehci-pci[ 1.503918] usb 1-5: New USB device found, idVendor=1b80, idProduct=e409[ 1.503926] usb 1-5: New USB device strings: Mfr=1, Product=2, SerialNumber=0[ 1.503930] usb 1-5: Product: DVB-T TV Stick[ 1.503935] usb 1-5: Manufacturer: ITE Technologies, Inc.[ 1.616084] usb 1-6: new high-speed USB device number 4 using ehci-pci[ 1.749168] usb 1-6: New USB device found, idVendor=2013, idProduct=024f[ 1.749175] usb 1-6: New USB device strings: Mfr=1, Product=2, SerialNumber=3[ 1.749179] usb 1-6: Product: PCTV 290e[ 1.749184] usb 1-6: Manufacturer: PCTV Systems[ 1.749187] usb 1-6: SerialNumber: 00000006XYS0Only em28xx changes went to (In reply to Martin Sofaru from)We certain(In reply to schaefer.frank from)I looked also all em28xx changes done between 3.12 and 3.13 and I can confirm Frank. There is was no change that touches DTV streaming code. These are all patches:bdee6bd [media] em28xx-video: Swap release order to avoid lock nesting6dbea9f [media] Add support for KWorld UB435-Q V2be353fa [media] V4L2: em28xx: tell the ov2640 driver to balance clock enabling internallyfc5d0f8 [media] V4L2: em28xx: register a V4L2 clock source032f1dd [media] em28xx: fix error path in em28xx_start_analog_streaming()b68cafc [media] em28xx: fix and unify the coding style of the GPIO register write sequencesde0fc46 [media] em28xx: MaxMedia UB425-TC change demod settingsb6c7abb [media] em28xx: MaxMedia UB425-TC switch RF tuner driver to another8d100b2 [media] em28xx: MaxMedia UB425-TC offer firmware for demodulatorIs there anyone who could test kernel 3.12 or older, with latest media drivers (media_build.git). If it works, we can rule out media driver issue.(In reply to Martin Long from)If you can identify what patch broke it, then we can roll the patch back, but, as Antti and Frank pointed, it is very unlikely that this change is related to em28xx. Probably, it is on some other place.Could you please do a git bisect, in order to identify what change broke it?As I commented at the, this error is likely because the USB stack is returning EFBIG when trying to submit URBs to receive the data.The EFBIG return code happens if there's not enough space in a givenUSB bus to reserve traffic for ISOC transfers when submitting theURBs. Changing the URB size helps to reduce the amount of ISOCtransfers, making more unlikely for this bug to happen. However, theem28xx driver already tries to use the max supported size, using theUSB descriptors.There's one easy way to reproduce it: plug two em28xx devices withanalog TV and try to start both. The first analog TV stream willallocate about 60% of the bus traffic, and the Kernel will returnEFBIG when trying to stream at the second one.That's said, on a USB bus where there's just one device connected,this error shouldn't happen, especially for DVB, where the bandwidthrequirements are typically lower.It used to be possible to check how much was allocated for ISOCtraffic via:# cat /sys/kernel/debug/usb/devices T: Bus=02 Lev=00 Prnt=00 Port=00 Cnt=00 Dev#= 1 Spd=5000 MxCh= 1B: Alloc= 0/800 us ( 0%), #Int= 0, #Iso= 0D: Ver= 3.00 Cls=09(hub ) Sub=00 Prot=03 MxPS= 9 #Cfgs= 1P: Vendor=1d6b ProdID=0003 Rev= 3.17S: Manufacturer=Linux 3.17.0-rc6+ xhci_hcdS: Product=xHCI Host ControllerS: SerialNumber=0000:00:14.0C:* #Ifs= 1 Cfg#= 1 Atr=e0 MxPwr= 0mAI:* If#= 0 Alt= 0 #EPs= 1 Cls=09(hub ) Sub=00 Prot=00 Driver=hubE: Ad=81(I) Atr=03(Int.) MxPS= 4 Ivl=256msThe "Alloc" above would indicate how many slots were allocated.However, at least here on an Atom NUC I'm testing (model DE3815TYKE) and latestupstream Kernel + media patches, no matter if I start some traffic or not there, it still shows 0/800, at the USB 2.0 or USB 3.0 ports. It seems that there's a bug somewhere on the USB stack that it is preventing it to show.In any case, the return of EFBIG doesn't imply that there's a bug atem28xx driver or at the usb stack. It is just an indication that thebus has reached its maximum hardware capacity.That's said, I was never ever be able to get EFBIG when there'sjust one isoc device connected into an USB bus.Are you sure that you don't have any other devices connected to the USB bus that also does ISOC transfers?Aren't you trying to start it on a VM or connecting the device via an USB hub?Let me start with the fact that this bug still haunts me, in contrast to what I posted here earlier.I originally found this bug with the tree I gave in my first comment. And I'm pretty sure this is not related to em28xx, since I've looked through the updates and none of them have any indication that it is something to do with this bug.On the other hand I've seen some updates to the EHCI scheduling which has been overhauled after 3.12. I checked the devices on that bus, and the em28xx based device is the only one using ISOC transfers.Note that that this bug only pops up after quite some transfers have taken place. Is there any reason why the EFBIG would occur only after a large number of transfers?And if you remove the em28xx module, and reload it again, it seems you get another round of successful transfers. That's my current work-around by the way.(In reply to beralt from)Ok.Well, I think that non-ISOC devices could also affect, as the EHCI URB scheduler dynamically estimates the amount of traffic needed on an USB bus and recalculates the available bandwidth.I'm not an expert at the EHCI driver. I would guess that the logic that dynamically estimates the bandwidth either has a bug or maybe some trafficburst at the bus makes it to think that the bandwidth needed for other traffic increased, making em28xx to fail.Weird. maybe setting again the alternate (or some other call to the USB functions) makes the ehci driver to reset the traffic counters, and re-start the bandwidth estimation algorithm.counters.I ran PCTV 520e DVB-C channel scan in a loop around 7 hours without problems using kernel 3.11, but latest media drivers top of that. Then I switched to 3.17.0-rc5+, which has same media drivers, started running same scan in a loop and problem occurs in a few minute.It is strong indicator that problem is somewhere on USB stack.Problem could be reproduced rather easily re-tuning device in a loop. Tuning causes USB stream start + stop, which will fail sooner or later.Here is simple command to scan in a loop$ while true; do scandvb intial-channels-file; done(In reply to Martin Long from)Don't cry for a roll back unless you've located the problem.Guys, this is going in circles.If you can reproduce the issue, do a "git bisect v3.13..v3.12" on linus tree.Maybe you can share the work. Please make sure to test "good" revisions for a while.Today I was able to reproducetimes with PCTV 520e, just right after I started scan. But after that, I have been running scan with PCTV 520e and PCTV 292e many hours without a problem. Kernel is 3.17.0-rc5+ (media master). So that bug is very hard, if not impossible, to bisect unless you will find way to reproduce it reliably...(In reply to schaefer.frank from)Well, it seems that it is likely not a problem with the em28xx module, so fair enough. Please, just be aware that not everyone has the skills needed to do a git bisect and compile and install kernels. Just because I don't have the skills to do this doesn't change the fact that I bought a device which was working on my system, and commits have been made on part of the kernel which have since broken this (whether that is the dvb driver or USB, or whatever). And 6 months later the people who do have the skills to fix it seem to be no nearer to getting it working, or even knowing who broke it and how. I completely understand that nobody is getting paid for this, but stuff like this prevents Linux from being accessible to non-technical users. If something can stay months in a broken state, then it will be stop users coming to the platform - especially those who don't have a knowledge of how to debug kernel code!I'm very sorry that I am not able to bisect this. If I was able to then I would be spending my evenings working on this. But, surely you can understand the frustration at not being able to use my hardware for the last 6 months, especially when, until the last couple of days, nobody seems to be interested in fixing it. I do, on the other hand, appreciate the work that some people here are now doing on this.To whom it may concern - I'm in the middle of doing a bisect on this, but it's going to take a week or two. "git bisect" reports there are approximately 13 iterations to test. I'm letting each iteration run for 48 hours before I pronounce it "good"... I've seen it run for 9 hours and then fail, so I want to be sure the good ones really are good.If anyone else is doing/has done this already, let me know and save me some effort! Otherwise, I will report back in a while with results.Finally finished the bisect - it points to this as the first bad commit:"USB: EHCI: handle isochronous underruns with tasklets"I don't really know what I'm looking at regarding kernel USB handling, so I don't know whether that commit is actually *wrong* or whether it's just exposing an issue elsewhere. It does, at least, look like a plausible candidate.I'm using a Hauppauge 290e and my test was to run a channel scan in a loop with a 60 second pause between iterations. It would always successfully pick up channels at first. "Bad" tests were ones where the channel scan would eventually start to fail and I'd see ""submit of urb 0 failed" in the syslog. If it continued to run without problems for 48 hours then I called it a "good" commit.On the bad commits, the longest run before failure was 26 hours. Sometimes it would fail in about 1 hour. I didn't investigate what caused the different lengths of time between failures.I hope that this is enough information for someone with more understanding of the source to investigate. I'd be pleased to give any more information or run any more tests that would help.(In reply to Joe Bryant from)Indeed, many thanks for bisecting.You should report this to the author of the patch (Alan Stern) and CC the linux-usb mailinglist.Considering how long people have suspected this bug might have something to do with the ehci-hcd driver, it's surprising that until now, nobody has asked the maintainer of that driver to take a look.Mauro's comments aren't quite right. EFBIG does not mean the bus's bandwidth is fully committed -- that's what ENOSPC means. Rather, EFBIG means ehci-hcd thinks the driver has tried to submit URBs too far into the future. Consider this example from:kernel: ehci-pci 0000:00:1d.0: request ffff8800ccc59000 would overflow (8136+63 >= 8192)kernel: submit of urb 0 failed (error=-27)The debugging message means that there currently are URBs scheduled for the next 8136 microframes (one microframe = 125 us) and the driver has tried to submit an URB that would last an additional 63 microframes. Since ehci-hcd can't schedule more than 8192 microframes into the future, the submission fails.Tracking this down may require adding some additional debugging lines to ehci-hcd. But for now, the best start would be to record a usbmon trace showing the problem (see Documentation/usb/usbmon.txt). That will show when all the URBs get submitted, where they are placed in the schedule, and where the error occurs.(In reply to Alan Stern from)Ah!For a media application, an additional delay of 63 microframes won't hurtat all. Even a bigger delay won't hurt. The way the media system works isthat it reserves multiple video buffers, each buffer to store a full frame.At 30 frames/s rate (NTSC usual frame frequency), it means that, when abuffer is filled, the next one will only be ready after 33 ms. There are even some devices that only sends URBs in burst, on a minimum of 1 ms interval.What I'm trying to say is that, on those devices, the time that the buffersare filled are not too precise, as they don't need to be, and sometimes thedevice firmware needs to wait for a while, as the device's microcontroller could be busy handling other things (like IR or audio).Createdusbmon traceAttached is a usbmon trace - I was very fortunate in that this time it failed very quickly, and so this is the full trace, over about 15 minutes.This clearly shows a bug in ehci-hcd. To figure out what the bug is, I need more debugging info.Please edit the iso_stream_schedule() function in drivers/usb/host/ehci-sched.c. Shortly after the use_start: label, just before the "status = -EFBIG" line, add a line to print out the values of empty, new_stream, now, base, next, and start. Let's see what they show.Okay, I added the line thus:printk(KERN_ALERT "EFBIG BUG - empty: %d new_stream: %d now: %d base: %d next: %d start: %d\n", empty, new_stream, now, base, next, start);and I got:EFBIG BUG - empty: 1 new_stream: 1 now: 2680 base: 2752 next: 4033 start: 4033CreatedInitialize ehci->last_iso_frame before it gets usedThat's definitely bad... base should always be between now - 1000 and now (modulo the schedule size), not larger than now.Reading through the code, the reason is obvious (and it makes me feel really stupid). It's a simple use-before-initialize bug for ehci->last_iso_frame. The attached patch should fix it. Let me know what happens.Many thanks for the fast patch, Alan. Assuming it's correct, it will of course be a while before I can report back, because it'll just sit there working perfectly the whole time! I will set a test run going as soon as I'm able and report back when it's been going for 48 hours.Looks very promising. I've managed to get my kernel building so I'll also report back in a couple of days.Looks good here - it ran my test for 48 hours with no sign of trouble, before I stopped it myself.Me too. I haven't been running such extensive tests, but it's gone a couple of days without dropping out on my MythTV setup, which is the best it's done so far.Okay, I will submit the patch and credit the two of you with testing it.I've been using this patch on my Fedora 20 box for over a week now (with the latest kernel being used on F20 - 3.17.6) and I've not seen any evidence of an issue. Thanks to all involved in the diagnosis and resolution.What is the lifecycle for the patch? How does it get picked up off the mailing list, and which git tree is it likely to hit first. I've just had a quick scan and haven't seen anything yet. Is there a process which ensures this patch doesn't just sit on the mailing list unnoticed?The patch has been submitted, and Greg K-H (the USB maintainer) will apply it after the current merge window closes. Some time after the patch makes it into the mainline kernel, it will be queued for the various -stable kernels.The first place it will show up is in Greg's USB tree. The only process for making sure the patch gets noticed is to poke Greg if he doesn't pick it up in a timely manner.FYI, the patch is now in the main Linux 3.19-rc7 kernel (commit 6d89252a998a695ecb0348fc2d717dc33d90cae9) and the 3.18.5 stable kernel (commit 99688ecfbc63e2aa90fab5e704c47c4fd6439197). This bug report can be closed.
id=14737	possibly related to thissame symptoms and I upped a lot of info for this bug on there.Also Read this threadI have thus far been able to find similar symptoms all the way back to 2.6.29.6 I've not yet done testing farther. problem is intermittent. It does not appear to affect another nic on the system (however testing of that hasn't been extensive,and a different driver). if I do not reboot the computer and the bug hasn't manifested, it will not manifest (perhaps unless I reload modules or restart interfaces (not tested). Created2.6.31 dmesgCreatednetstat -sCreatedlspci -vv 2.6.32 (while bug not occurring)Created/proc/interrupts (while bug not occurring)Created2.6.32 configupstream router is Linksys WRT54GL (1.1 I think?) running OpenWRT 809.1 and has several other windows systems working fine on it, it had another linux system that ran fine too, on its wireless.Creatednetstat -s (while bug not occurring)(switched to email. Please respond via emailed reply-to-all, not via thebugzilla web interface).On Sat, 5 Dec 2009 07:02:49 GMTwrote:>thanks akpm, I've been watching this thread but now I will try to jump in.Caleb, can you please summarize where we are today, you've done a lot of testing and the thread has gone on a while.Kernels known to fail (after any length):Kernels known to work:Have you been able to try the latest e1000e from 2.6.32? it has some fixes in it, although none right off the top of my head that will fix your issue.I have a couple of related questions, why don't you have irqbalance enabled? Network interrupts should not be migrating across all cpus evenly, at the very least your system should be reconfigured to lock the interrupts to a particular core with smp_affinity. CPU0 CPU1 CPU2 CPU3 0: 119 59 69 70 IO-APIC-edge timer 1: 1 2 1 0 IO-APIC-edge i8042 6: 0 1 0 1 IO-APIC-edge floppy 8: 185 178 175 180 IO-APIC-edge rtc0 9: 0 0 0 0 IO-APIC-fasteoi acpi 12: 0 1 2 3 IO-APIC-edge i8042 16: 761720 767583 765772 762262 IO-APIC-fasteoi uhci_hcd:usb3, EMU10K1 17: 2 1 0 0 IO-APIC-fasteoi ohci1394 18: 0 0 0 2 IO-APIC-fasteoi ehci_hcd:usb1, uhci_hcd:usb8 19: 192022 191598 191809 191886 IO-APIC-fasteoi uhci_hcd:usb5, uhci_hcd:usb7 21: 0 1 1 3 IO-APIC-fasteoi uhci_hcd:usb4, eth0 23: 19600 19263 19489 19502 IO-APIC-fasteoi ehci_hcd:usb2, uhci_hcd:usb6 25: 419910 412980 411109 416834 PCI-MSI-edge i915 26: 233236 233744 233647 233567 PCI-MSI-edge ahci 27: 709493 708677 709630 708963 PCI-MSI-edge eth1NMI: 0 0 0 0 Non-maskable interruptsLOC: 10375694 9592098 6283658 6319369 Local timer interruptsSPU: 0 0 0 0 Spurious interruptsPMI: 0 0 0 0 Performance monitoring interruptsPND: 0 0 0 0 Performance pending workRES: 50103 49240 47545 45606 Rescheduling interruptsCAL: 74174 408 71586 453 Function call interruptsTLB: 49410 53567 50409 52426 TLB shootdownsTRM: 0 0 0 0 Thermal event interruptsTHR: 0 0 0 0 Threshold APIC interruptsMCE: 0 0 0 0 Machine check exceptionsMCP: 271 271 271 271 Machine check pollsERR: 0MIS: 0There is nothing in the ethtool -S statistics that I see that indicates anything is wrong, you've gotten no tx timeouts as far as I can tell, have you had any system panics (possibly seeming unrelated to network?)On Mon, 7 Dec 2009, Andrew Morton wrote:>On Mon, Dec 7, 2009 at 4:53 PM, Brandeburg, Jesse<> wrote:>>2.6.32 - 2.6.29.6 is the range I've tested 2.6.29 only seemed to have10% packet loss with mtr as opposed to the later, higher 30-50% stillthat's abnormal and shouldn't be happening. I haven't tested fartherback yet.flawlessly, none at this point. I've been able to replicate on everyversion tested. given the fact it doesn't happen on every reboot and Irarely reboot this makes it difficult to test. Other than the factthat I've been unable to find a good kernel nothing suggests hardwarefailure. given that some of the other e1000e bugs go back farther thanI've tested...yes. reproducible. whether it occurs as often I'm not sure.is that new with 32? if not I don't know... I'm using arch linux'sconfig as a base, if it's something they should have enabled I canrelay the message.no. My system seems perfectly stable (outside of some end usersoftware bugs, and even then only kopete seems to crash these days,due to me using an experimental protocol). I'm unable to account forthe fact that tests aren't accounting for anything wrong...hmm... thought... possibly iptables is dropping them as INVALID? I'mstill thinking that testing on just this system with one nic hookedinto the other might be a good idea, as the firewall configuration inopenwrt is not straightforward to me, this would also remove any QoSrules that the router is applying, and random packets floating around(that windows boxen are sending).-- Caleb CushingBrandeburg, Jesse wrote, On 12/07/2009 10:53 PM:There are unreplied icmp echos and a lot of tcp retransmits in thefirst one (netstat_after.slave4.log.gz):Ip: 812 total packets received 1 with invalid addresses 0 forwarded 0 incoming packets discarded 802 incoming packets delivered 1048 requests sent outIcmp: 488 ICMP messages received 0 input ICMP message failed. ICMP input histogram: destination unreachable: 2 timeout in transit: 289 echo replies: 197 677 ICMP messages sent 0 ICMP messages failed ICMP output histogram: destination unreachable: 2IcmpMsg: InType0: 197 InType3: 2 InType11: 289 OutType3: 2 OutType69: 675Tcp: 17 active connections openings 0 passive connection openings 14 failed connection attempts 0 connection resets received 0 connections established 45 segments received 49 segments send out 19 segments retransmited 0 bad segments received. 19 resets sentI analyzed tcpdumps from the router and there were really skippedicmp echo requests on input. At the same time nothing wrong in thestats (qdisc, ifconfig, ethtool) of this sending box with e1000e,and the router's ifconfig (I only didn't see router's netstat).Anyway, I doubt it's accidental or router to blame if another NIC,and this e1000e with some boots/kernels(?) can work flawlessly.Btw, after finding this similarly mysterious story below (with thesame NIC) I wonder if the router model can matter here too, butmaybe I'm wrong.Jarek P.Closing as obsolete, if this is still seen versus a modern kernel (3.2+) please update the bugabout 2 months ago which would have been a 3.3 or 3.2 kernel (arch is on 3.4 now) had this problem when I tried connecting my computer directly to the modem. problem doesn't occur when connecting to new router, I suspect because it only happens when I'm connecting at less than a gigabit connection (e.g. modem to pc is probably only 10/100, but router is 10/100/1000 )Sounds like a problem with the devices falling out with one another when negotiating. Something we do see now and then with cheap stuff one end particularly.Bug updated so we know its current
id=82761	When I boot with "intel_iommu=on" parameter, I get these errors repeated over and over again in dmesg:---dmar: DRHD: handling fault status reg 3dmar: DMAR:[DMA Read] Request device [05:00.0] fault addr ff3f4000 DMAR:[fault reason 06] PTE Read access is not set---lspci -vvs 05:00.005:00.0 Ethernet controller: Realtek Semiconductor Co., Ltd. RTL8169 PCI Gigabit Ethernet Controller (rev 10) Subsystem: Realtek Semiconductor Co., Ltd. RTL8169/8110 Family PCI Gigabit Ethernet NIC Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV+ VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz+ UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Latency: 64 (8000ns min, 16000ns max), Cache Line Size: 32 bytes Interrupt: pin A routed to IRQ 19 Region 0: I/O ports at c200 [size=256] Region 1: Memory at f7862000 (32-bit, non-prefetchable) [size=256] Expansion ROM at f7840000 [disabled] [size=128K] Capabilities: [dc] Power Management version 2 Flags: PMEClk- DSI- D1+ D2+ AuxCurrent=375mA PME(D0-,D1+,D2+,D3hot+,D3cold+) Status: D0 NoSoftRst- PME-Enable- DSel=0 DScale=0 PME- Kernel driver in use: r8169lspci -vt-[0000:00]-+-00.0 Intel Corporation Xeon E3-1200 v2/3rd Gen Core processor DRAM Controller +-01.0-[01]--+-00.0 NVIDIA Corporation Device 0fc6 | \-00.1 NVIDIA Corporation Device 0e1b +-02.0 Intel Corporation Xeon E3-1200 v2/3rd Gen Core processor Graphics Controller +-14.0 Intel Corporation 7 Series/C210 Series Chipset Family USB xHCI Host Controller +-16.0 Intel Corporation 7 Series/C210 Series Chipset Family MEI Controller #1 +-1a.0 Intel Corporation 7 Series/C210 Series Chipset Family USB Enhanced Host Controller #2 +-1b.0 Intel Corporation 7 Series/C210 Series Chipset Family High Definition Audio Controller +-1c.0-[02]-- +-1c.1-[03]----00.0 Realtek Semiconductor Co., Ltd. RTL8111/8168B PCI Express Gigabit Ethernet controller +-1c.3-[04-05]----00.0-[05]--+-00.0 Realtek Semiconductor Co., Ltd. RTL8169 PCI Gigabit Ethernet Controller | +-01.0 Realtek Semiconductor Co., Ltd. RTL8169 PCI Gigabit Ethernet Controller | \-02.0 Realtek Semiconductor Co., Ltd. RTL8169 PCI Gigabit Ethernet Controller +-1d.0 Intel Corporation 7 Series/C210 Series Chipset Family USB Enhanced Host Controller #1 +-1f.0 Intel Corporation H77 Express Chipset LPC Controller +-1f.2 Intel Corporation 7 Series/C210 Series Chipset Family 6-port SATA Controller [AHCI mode] \-1f.3 Intel Corporation 7 Series/C210 Series Chipset Family SMBus Controllerdmesg | grep IOMMUIntel-IOMMU: enableddmar: IOMMU 0: reg_base_addr fed90000 ver 1:0 cap c0000020e60262 ecap f0101admar: IOMMU 1: reg_base_addr fed91000 ver 1:0 cap c9008020660262 ecap f0105aIOAPIC id 2 under DRHD base 0xfed91000 IOMMU 1IOMMU 0 0xfed90000: using Queued invalidationIOMMU 1 0xfed91000: using Queued invalidationIOMMU: software identity mapping for device 0000:00:00.0IOMMU: software identity mapping for device 0000:00:01.0IOMMU: software identity mapping for device 0000:00:14.0IOMMU: software identity mapping for device 0000:00:16.0IOMMU: software identity mapping for device 0000:00:1a.0IOMMU: software identity mapping for device 0000:00:1b.0IOMMU: software identity mapping for device 0000:00:1c.0IOMMU: software identity mapping for device 0000:00:1c.1IOMMU: software identity mapping for device 0000:00:1c.3IOMMU: software identity mapping for device 0000:00:1d.0IOMMU: software identity mapping for device 0000:00:1f.0IOMMU: software identity mapping for device 0000:00:1f.2IOMMU: software identity mapping for device 0000:00:1f.3IOMMU: software identity mapping for device 0000:01:00.0IOMMU: software identity mapping for device 0000:01:00.1IOMMU: software identity mapping for device 0000:03:00.0IOMMU: Setting RMRR:IOMMU: Setting identity map for device 0000:00:02.0 [0xcb800000 - 0xcf9fffff]IOMMU: Setting identity map for device 0000:00:14.0 [0xc8d17000 - 0xc8d24fff]IOMMU: Setting identity map for device 0000:00:1a.0 [0xc8d17000 - 0xc8d24fff]IOMMU: Setting identity map for device 0000:00:1d.0 [0xc8d17000 - 0xc8d24fff]IOMMU: Prepare 0-16MiB unity mapping for LPCIOMMU: Setting identity map for device 0000:00:1f.0 [0x0 - 0xffffff]OS: Debian WheezyKernel: 3.16.1 (compiled by hand)If you need more information, just ask. Does it work on 3.17-rc1? Are all of the 8169 NICs on bus 05 up and running? Please provide lspci -vv info for 04:00.0.1) I would prefer stay on stable kernel if it's possible (which commits of 3.17-rc1 would be relevant for this bug?).2) Yes, all of the 8169 NICs are up and running.3) lspci -vvs 04:00.004:00.0 PCI bridge: ASMedia Technology Inc. ASM1083/1085 PCIe to PCI Bridge (rev 03) (prog-if 00 [Normal decode]) Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Bus: primary=04, secondary=05, subordinate=05, sec-latency=32 I/O behind bridge: 0000c000-0000cfff Memory behind bridge: f7800000-f78fffff Secondary status: 66MHz+ FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort+ <SERR- <PERR- BridgeCtl: Parity- SERR- NoISA- VGA- MAbort- >Reset- FastB2B- PriDiscTmr- SecDiscTmr- DiscTmrStat- DiscTmrSERREn- Capabilities: [50] MSI: Enable- Count=1/1 Maskable- 64bit+ Address: 0000000000000000 Data: 0000 Capabilities: [78] Power Management version 3 Flags: PMEClk- DSI+ D1+ D2+ AuxCurrent=0mA PME(D0+,D1+,D2+,D3hot+,D3cold+) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [80] Express (v1) PCI/PCI-X Bridge, MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s <64ns, L1 <1us ExtTag- AttnBtn- AttnInd- PwrInd- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop+ BrConfRtry- MaxPayload 128 bytes, MaxReadReq 512 bytes DevSta: CorrErr- UncorrErr+ FatalErr- UnsuppReq+ AuxPwr- TransPend- LnkCap: Port #1, Speed 2.5GT/s, Width x1, ASPM L0s L1, Latency L0 <2us, L1 <2us ClockPM- Surprise- LLActRep- BwNot- LnkCtl: ASPM Disabled; Disabled- Retrain- CommClk- ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x1, TrErr- Train- SlotClk- DLActive- BWMgmt- ABWMgmt- Capabilities: [c0] Subsystem: Micro-Star International Co., Ltd. Device 7758 Capabilities: [100 v1] Virtual Channel Caps: LPEVC=0 RefClk=100ns PATEntryBits=1 Arb: Fixed- WRR32- WRR64- WRR128- Ctrl: ArbSelect=Fixed Status: InProgress- VC0: Caps: PATOffset=00 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed- WRR32- WRR64- WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=Fixed TC/VC=01 Status: NegoPending- InProgress-(In reply to Ansa89 from)579305f iommu/vt-d: Update to use PCI DMA aliasese17f9ff iommu/vt-d: Use iommu_group_get_for_dev()104a1c1 iommu/core: Create central IOMMU group lookup/creation interfaceI will try 3.17-rc1 (hoping it's enough stable for home-server).Tested with 3.17-rc1: the errors still there, but the spam rate seems lower than 3.16.1 (with 3.16.1 I get the errors repeated a lot of times and the count grows fast; with 3.17-rc1 I get the same errors repeated less times and the count seems to grow slower).After ~10 minutes:dmesg | grep -i dmarACPI: DMAR 0x00000000C8EA83F0 0000B8 (v01 INTEL SNB 00000001 INTL 00000001)dmar: Host address width 36dmar: DRHD base: 0x000000fed90000 flags: 0x0dmar: IOMMU 0: reg_base_addr fed90000 ver 1:0 cap c0000020e60262 ecap f0101admar: DRHD base: 0x000000fed91000 flags: 0x1dmar: IOMMU 1: reg_base_addr fed91000 ver 1:0 cap c9008020660262 ecap f0105admar: RMRR base: 0x000000c8d17000 end: 0x000000c8d24fffdmar: RMRR base: 0x000000cb800000 end: 0x000000cf9fffffDMAR: No ATSR found[drm] DMAR active, disabling use of stolen memorydmar: DRHD: handling fault status reg 3dmar: DMAR:[DMA Read] Request device [05:00.0] fault addr ff3f4000 DMAR:[fault reason 06] PTE Read access is not setdmar: DRHD: handling fault status reg 3dmar: DMAR:[DMA Read] Request device [05:00.0] fault addr ff3f4000 DMAR:[fault reason 06] PTE Read access is not setdmar: DRHD: handling fault status reg 3dmar: DMAR:[DMA Read] Request device [05:00.0] fault addr ff3f4000 DMAR:[fault reason 06] PTE Read access is not setdmar: DRHD: handling fault status reg 3dmar: DMAR:[DMA Read] Request device [05:00.0] fault addr ff3f4000 DMAR:[fault reason 06] PTE Read access is not setdmar: DRHD: handling fault status reg 3dmar: DMAR:[DMA Read] Request device [05:00.0] fault addr ff3f4000 DMAR:[fault reason 06] PTE Read access is not setdmar: DRHD: handling fault status reg 3dmar: DMAR:[DMA Read] Request device [05:00.0] fault addr ff3f4000 DMAR:[fault reason 06] PTE Read access is not setdmar: DRHD: handling fault status reg 3dmar: DMAR:[DMA Read] Request device [05:00.0] fault addr ff3f4000 DMAR:[fault reason 06] PTE Read access is not setdmar: DRHD: handling fault status reg 3dmar: DMAR:[DMA Read] Request device [05:00.0] fault addr ff3f4000 DMAR:[fault reason 06] PTE Read access is not setdmar: DRHD: handling fault status reg 3dmar: DMAR:[DMA Read] Request device [05:00.0] fault addr ff3f4000 DMAR:[fault reason 06] PTE Read access is not setdmar: DRHD: handling fault status reg 3dmar: DMAR:[DMA Read] Request device [05:00.0] fault addr ff3f4000 DMAR:[fault reason 06] PTE Read access is not setdmar: DRHD: handling fault status reg 3dmar: DMAR:[DMA Read] Request device [05:00.0] fault addr ff3f4000 DMAR:[fault reason 06] PTE Read access is not setdmar: DRHD: handling fault status reg 3dmar: DMAR:[DMA Read] Request device [05:00.0] fault addr ff3f4000 DMAR:[fault reason 06] PTE Read access is not setdmar: DRHD: handling fault status reg 3dmar: DMAR:[DMA Read] Request device [05:00.0] fault addr ff3f4000 DMAR:[fault reason 06] PTE Read access is not setdmar: DRHD: handling fault status reg 3dmar: DMAR:[DMA Read] Request device [05:00.0] fault addr ff3f4000 DMAR:[fault reason 06] PTE Read access is not setdmar: DRHD: handling fault status reg 3dmar: DMAR:[DMA Read] Request device [05:00.0] fault addr ff3f4000 DMAR:[fault reason 06] PTE Read access is not setIn the end the bug seems not fixed in 3.17-rc1.Ok, then it's probably not a result of the PCIe-to-PCI bridge since 05:00.0 is the correct requester ID for all the devices behind the bridge. Unfortunately that means that the problem may not be fixable. We're only seeing reads to a single address, which may mean the NIC is using that read to synchronize transaction ordering, ex. using a DMA read to flush a DMA write from the device. If the NIC driver has visibility of this address, then it could attempt to do a coherent mapping for the device(s) to avoid the fault. If it doesn't, then these NICs may simply be incompatible with the IOMMU.Are these 3 separate NICs plugged into PCI slots on the motherboard or is this a single triple-port card with embedded PCIe-to-PCI bridge?You might be able to run the IOMMU in passthrough mode with iommu=pt r8169.use_dac=1, but note the warning in modinfo "use_dac:Enable PCI DAC. Unsafe on 32 bit PCI slot." Unfortunately if you don't enable use_dac, then intel_iommu will ignore the passthrough option for these devices.Also note that this problem has nothing to do with Virtualization/KVM. Drivers/Network or perhaps Drivers/PCI would be a more appropriate classification.I'm guessing this might be the motherboard here: MSI ZH77A-G43Since you're apparently trying to use VT-d on this system for KVM and therefore presumably device assignment, I'll note that you will never be able to successfully assign the conventional PCI devices separately between guests or between host and guests. The IOMMU does not have the granularity to create separate IOMMU domains per PCI slot in this topology. Also, some (all?) Realtek NICs have some strange backdoors to PCI configuration space that make them poor targets for PCI device assignment:(In reply to Alex Williamson from)They are 3 separate NICs plugged into 3 separate PCI slots.I tried using "intel_iommu=pt", but it didn't work (resulted in vt-d disabled).However with "intel_iommu=on iommu=pt" the errors remain (probably because I didn't add "r8169.use_dac=1").I'm on a 64 bit system, but I think it has nothing to with "32 bit PCI slot".I searched for "IOMMU" section but it doesn't exist.I will probably change classification to "Drivers/PCI".(In reply to Alex Williamson from)Yes, that is my motherboard.Yes, I'm trying to do device assignment, but not with those NICs: I want to pass only the nVidia PCIe VGA card to guest; while all NICs (and the integrated VGA card) will remain available to host.It would be nice if there would be a way to prevent IOMMU on these NICs (or something like that).SIDE NOTE: in the qemu commit they talk about RTL8168, but I have real RTL8169 devices (the only RTL8168 device is the integrated NIC and for that device I'm using r8168 driver from realtek compiled by hand).If you are using an out of tree driver, then please take the bug up with the supplier. If you can duplicate it with the in-tree driver then please re-open the bugThe problem is related to 00:05.0 device (Realtek Semiconductor Co., Ltd. RTL8169 PCI Gigabit Ethernet Controller) which actually use the in-tree r8169 driver.The out of tree r8168 driver is used by 00:03.0 device (Realtek Semiconductor Co., Ltd. RTL8111/8168B PCI Express Gigabit Ethernet controller) which has nothing to do with the issue.For testing purpose I also tried using only the in-tree r8169 driver for all devices, but the problem persists.Problem persists also with linux 3.16.2.
id=14434	The touchscreen jitter on Zaurus devices is terrible. Event the ts_lib modules (variance and dejitter) don't help. I've attached the photos, where I tried to draw three vertical lines. As you can see, there are lots of noise peaks.Looks like jitter is caused by noise induced in the touchscreen by the LCD.The issue is reproducible on SL-C1000, SL-C3000, SL-C3100 and SL-C3200 modelsThe issue is reproducible on both ads7846 (CONFIG_TOUCHSCREEN_ADS7846) and corgi_ts (CONFIG_TOUCHSCREEN_CORGI, which is now deprecated) drivers.The issue is not specific to the 2.6.31 version. I can reproduce it on 2.6.22, 2.6.24.4, 2.6.29 and 2.6.32-rc4 CreatedA photo demonstrating the bug.The latest kernel I found where this problem is not reproducible is 2.4.20.I can reproduce this as well.Comparing the code of ads7846 and corgi_ts, I see that ads7846 driver completely misses the part of code that should ensure reading of values only during the blank period.But I suspect, that this code stopped to work correctly even in corgi_ts.Datasheet contains an article about eliminating the noise:I did not yet verify, whether everything is done correctly.I was also facing same problem about noise in ads7846 but later found out tat it was because of hardware issue. check tat plz once again. If ur resistor values some time are slightly more or less than recommended one's it causes a lot of noise. Later i corrected it , now everything works fine. regards,Ravi.This is definitely not a hardware issue, because I observe flawless reading in the NAND diagnostic utility.Well, maybe the report is obsolete, but it is still a problem of kernel:The driver migrated from corgi_ts to ads7846, which also implements filtering.To enable filtering, platform files needs to define it. And it was not done.Thanks for the updateMaybe it would be good to enable event filtering in ads7846 by default using common values from platform files.I guess that no device using ads7846 can live without it, but several devices lack platform definitions to turn it on.Looking at the code, the issue still exist. The patch above is 2 years old and I did not touch it in last years. I never submitted my patch to the upstream, because:- I was not satisfied with its results (still worse than the original Sharp 2.4 code).- The "no regulator" part is not upstream-able as it is.Anyway, the first four lines in the patch bring much smoother touchscreen feedback.
id=93531	I have duplicated the following bug with btrfs-progs v3.18, v3.18.2, v3.19-rc2.btrfs is unable to receive a volume from a send with one parent.me@host$ sudo btrfs send /bak/Portege/2014-06-01 | sudo btrfs rec -v .At subvol /bak/Portege/2014-06-01At subvol 2014-06-01receiving subvol 2014-06-01 uuid=4be3a6c5-be09-594e-a1d6-1a9013d14613, stransid=105481BTRFS_IOC_SET_RECEIVED_SUBVOL uuid=4be3a6c5-be09-594e-a1d6-1a9013d14613, stransid=105481me@host$ sudo btrfs send -p /bak/Portege/2014-06-01 /bak/Portege/2014-12-01_01-02-44 | sudo btrfs rec -vvvvvv . At subvol /bak/Portege/2014-12-01_01-02-44At snapshot 2014-12-01_01-02-44receiving snapshot 2014-12-01_01-02-44 uuid=64beee15-b3a7-8a47-9775-a885d7f1ddaf, ctransid=474567 parent_uuid=4be3a6c5-be09-594e-a1d6-1a9013d14613, parent_ctransid=105481utimes rename .duplicity -> o257-9667-0mkdir o257-473948-0rename o257-473948-0 -> .duplicityutimes chown .duplicity - uid=0, gid=100chmod .duplicity - mode=02775utimes .duplicityrename .ecryptfs -> o258-9667-0mkdir o258-473948-0rename o258-473948-0 -> lost+foundutimes chown lost+found - uid=0, gid=0chmod lost+found - mode=0700utimes lost+foundrmdir lost+foundmkdir o259-473948-0rename o259-473948-0 -> monitorERROR: rename o259-473948-0 -> monitor failed. Directory not emptyNo errors were reported in syslog.Please let me know if you need further info.Thanks! Fixed byI have just compiled and tested, and it does *not* fix this bug on my system.root@ProLiant:/mnt/backup/bug# uname -aLinux ProLiant 3.19.0+ #4 SMP Tue Mar 17 09:41:10 PDT 2015 x86_64 x86_64 x86_64 GNU/Linuxroot@ProLiant:/mnt/backup/bug# btrfs send -p /bak/Portege/2014-06-01 /bak/Portege/2014-12-01_01-02-44 | btrfs rec -vvvv .At subvol /bak/Portege/2014-12-01_01-02-44At snapshot 2014-12-01_01-02-44receiving snapshot 2014-12-01_01-02-44 uuid=b277e2ab-f0af-1e46-a8a3-cd587fd64a53, ctransid=474567 parent_uuid=f80254c5-2f5a-b043-ad3e-e12287f7b7e8, parent_ctransid=105481utimes rename .duplicity -> o257-9667-0mkdir o257-473948-0rename o257-473948-0 -> .duplicityutimes chown .duplicity - uid=0, gid=100chmod .duplicity - mode=02775utimes .duplicityrename .ecryptfs -> o258-9667-0mkdir o258-473948-0rename o258-473948-0 -> lost+foundutimes chown lost+found - uid=0, gid=0chmod lost+found - mode=0700utimes lost+foundrmdir lost+foundmkdir o259-473948-0rename o259-473948-0 -> monitorERROR: rename o259-473948-0 -> monitor failed. Directory not emptyPer Filipe's advice, doesfix that?No, I tested that patch as well and it did not fix the problem. Filipe has a copy of the inode list that causes the problem, and as of a few days ago didn't seem to think it had been fixed yet.- Ames
id=67651	Opening/creating large images (fx 15427 x 12549 pixel) in GIMP under Linux 3.12 causes GIMP to crash. The following messages is typically found in terminal:"(gimp:17857): GLib-ERROR **: gmem.c:110: failed to allocate 16384 bytesProgram received signal SIGTRAP, Trace/breakpoint trap.0x00007ffff3e5a289 in g_logv () from /usr/lib/libglib-2.0.so.0(script-fu:17871): LibGimpBase-WARNING **: script-fu: gimp_wire_read(): error"I am unsure whether this problem lies within gimp, glib or Linux 3.12. This issue has also been filed in the GNOME bug tracker here, have a look for further information on reproduction: Thanks for the report - that is a gimp crash not a kernel one.Actually it looks like you simply ran out of memory and gimp died in protestGIMP developer Mike Henning say that it looks like a Linux kernel bug to him, as Gimp 2.8.8 crashes under Linux 3.12, but not Linux 3.11 and below. See also:I am sorry if this wasn't clear from my initial bug description.The trace was absolutely clear - gimp ran out of memory and died (which is a bit rude of it)(gimp:17857): GLib-ERROR **: gmem.c:110: failed to allocate 16384 bytesSo there are lots of things this could be but they depend upon knowing a fair bit more about your setupCan you provide the output of "dmesg" after this occurs, and the contents of "free" off both boots.The reason I said this was likely a kernel bug is because it disappears when I set the environment variable MALLOC_MMAP_MAX_ to 0 before running gimp (running under otherwise identical conditions).I was under the impression that a normal out of memory condition would result in gimp being killed by the kernel, not malloc returning null. (That message only means that malloc returned null.)This is the output of free before running gimp on my machine:mike@mike-newbox-arch:~$ free -h total used free shared buffers cachedMem: 7.7G 2.5G 5.3G 2.8M 2.8M 1.3G-/+ buffers/cache: 1.1G 6.6GSwap: 0B 0B 0BAs you can see, I have over 6 GB of memory free. Running gimp and creating a 16000x16000 image (about 2.5 GB) then crashes. Only this is appended to dmesg:[ 754.663771] traps: gimp[844] trap int3 ip:7fdb67e07289 sp:7fffcd30c7d0 error:0(I will attach my full kernel log. Other than this line, you're only missing the boot process.)As I stated earlier, I can then successfully create an image with the same dimensions by running gimp like this: MALLOC_MMAP_MAX_=0 gimpFree reports this with that image open:mike@mike-newbox-arch:~$ free -h total used free shared buffers cachedMem: 7.7G 4.9G 2.8G 10M 2.8M 1.4G-/+ buffers/cache: 3.5G 4.2GSwap: 0B 0B 0BBecause of this, I believe it is caused by a change in the kernel mmap implementation. (But then, you can probably diagnose it better than I can.)I have kernel 3.12.5, Arch Linux x86_64, glibc 2.18CreatedOutput of dmesg after reproducing this bug.The kernel (and userspace set policy) try and avoid getting into a situation where there is too much overcommitting of resources. It's quite likely you will see a malloc NULL return from the kernel refusing an mmap especially if fedora uses memcfg and cgroups to stop one set of tasks (eg the desktop) from taking down the entire box.The kernel kill case is an extreme 'worst case scenario' recovery which the rest of the policy tries to avoid allowing to happen in the first place.The fact MALLOC_MMAP_MAX=0 makes it go away does indeed seem suspicious.One thing related to similar failures has been fixed: 2afc745f3e3079ab16c826be4860da2529054dd2Hopefully Andrew has some ideaI also see this change between 3.11 and 3.12. I have seen that it is due to a change in the way maps are handled. Trying a particular sequence of gimp operations with 3.11, I see 1177 entries in /proc/<pid>/maps. Doing the same sequence with the 3.12 kernel, I see 70054 maps entries. The default vm.max_map_count (on my Fedora 19 system) is 65530, so gimp's allocations fail before reaching that 70054 mark.Increasing vm.max_map_count allows gimp to continue working, but something has definitely changed in the way the maps are managed by the kernel.I haven't used gimp in years. Please precisely describe the sequence of steps you're using to create this image. Also, the kernel .config would be useful, thanks.Exactly what I was doing would be somewhat hard for you to reproduce, but here is a simple set of similar steps that demonstrates it. Firstly, I am using 64 bit Fedora 19, updated to the latest package updates. I have the following versions of pertinent packages:kernel-3.12.5-200.fc19.x86_64gimp-2.8.10-4.fc19.x86_64glib2-2.36.3-4.fc19.x86_64My machine has 16 GB of RAM and 16 GB of swap; it has an Intel Core i7 CPU with 4 cores, 2 threads per core.Some steps. Numbers in parentheses are the result of "wc -l maps" in /proc/<pid> for the gimp process.1. run gimp. (1074 maps)2. File -> New. Create an image of 9000x4000 pixels. (29122)3. Scribble a bit in the window with the paintbrush tool. (31123)4. In the layers dialog, duplicate the layer. (29766 -- lower)5. In the layers dialog, right click on the top layer and select "add layer mask"; choose white (full opacity). (37060)6. Scribble a bit in the layer mask. (37551)7. Select Image -> Flatten Image. (46543)More of the same sorts of actions quickly drive the maps count over the maximum and gimp dies an ungraceful death.Doing the same sequence with Kernel 3.11, the maps count never goes about about 1200.I am using the stock kernel from Fedora 19 updates. I didn't build it myself. I'll attach its .config shortly.Created.config file for Fedora 19 3.12 kernel.If you just want the crash, an easier way to reproduce it is:1. Open GIMP2. Go to File->New3. Type in 16000 in for both the width and height.4. Click OK. If another dialog appears, click OK on that too.5. Gimp should now crash on recent kernels.My kernel is the Arch Linux stock kernel. The config can be found here:Cyrill,Gimp is broken due to a kernel bug included in 3.12. It cannot openlarge files without failing memory allocations due to exceedingvm.max_map_count. The relevant bugzilla entries areThey include details on how to reproduce the issue. In my case, afailure shows messages like this (gimp:11768): GLib-ERROR **: gmem.c:110: failed to allocate 4096 bytes (file-tiff-load:12038): LibGimpBase-WARNING **: file-tiff-load: gimp_wire_read(): error xinit: connection to X server lost waiting for X server to shut down /usr/lib64/gimp/2.0/plug-ins/file-tiff-load terminated: Hangup /usr/lib64/gimp/2.0/plug-ins/script-fu terminated: Hangup /usr/lib64/gimp/2.0/plug-ins/script-fu terminated: HangupX-related junk is there was because I was using a headless server andxinit directly to launch gimp to reproduce the bug.Automated bisection using mmtests ()and the configuration file configs/config-global-dhp__gimp-simple (needslocal web server with a copy of the image file) identified the followingcommit. Test case was simple -- try and open the large file described inthe bug. I did not investigate the patch itself as I'm just reportingthe results of the bisection. If I had to guess, I'd say that VMAmerging has been affected.d9104d1ca9662498339c0de975b4666c30485f4e is the first bad commitcommit d9104d1ca9662498339c0de975b4666c30485f4eAuthor: Cyrill Gorcunov <>Date: Wed Sep 11 14:22:24 2013 -0700 mm: track vma changes with VM_SOFTDIRTY bit Pavel reported that in case if vma area get unmapped and then mapped (or expanded) in-place, the soft dirty tracker won't be able to recognize this situation since it works on pte level and ptes are get zapped on unmap, loosing soft dirty bit of course. So to resolve this situation we need to track actions on vma level, there VM_SOFTDIRTY flag comes in. When new vma area created (or old expanded) we set this bit, and keep it here until application calls for clearing soft dirty bit. Thus when user space application track memory changes now it can detect if vma area is renewed. Reported-by: Pavel Emelyanov <> Signed-off-by: Cyrill Gorcunov <> Cc: Andy Lutomirski <> Cc: Matt Mackall <> Cc: Xiao Guangrong <> Cc: Marcelo Tosatti <> Cc: KOSAKI Motohiro <> Cc: Stephen Rothwell <> Cc: Peter Zijlstra <> Cc: "Aneesh Kumar K.V" <> Cc: Rob Landley <> Signed-off-by: Andrew Morton <> Signed-off-by: Linus Torvalds <>On Wed, Jan 22, 2014 at 07:08:16PM +0000, Mel Gorman wrote:Thanks a lot for report, Mel! I'm investigating...On Wed, 22 Jan 2014 19:08:16 +0000 Mel Gorman <> wrote:I've never done this. Can you share the magic recipe for running an Xapp in this way?Thanks.On Wed, Jan 22, 2014 at 11:19:28PM +0400, Cyrill Gorcunov wrote:Mel, here is a quick fix for bring merging back (just in case if youhave a minute to test it and confirm the merging were affected). Itseems I've lost setting up vma-softdirty bit somewhere and procedurewhich tests vma flags mathcing fails, will continue investigating/testingtomorrow.--- mm/mmap.c | 14 ++++++++++++++ 1 file changed, 14 insertions(+)Index: linux-2.6.git/mm/mmap.c===================================================================--- linux-2.6.git.orig/mm/mmap.c+++ linux-2.6.git/mm/mmap.c@@ -893,8 +893,18 @@ again: remove_next = 1 + (end > next-> static inline int is_mergeable_vma(struct vm_area_struct *vma, struct file *file, unsigned long vm_flags) {+ /*+ * VM_SOFTDIRTY should not prevent from VMA merging, if we+ * match the flags but dirty bit -- just mark merged one as+ * a dirty then.+ */+#ifdef CONFIG_MEM_SOFT_DIRTY+ if ((vma->vm_flags ^ vm_flags) & ~VM_SOFTDIRTY)+ return 0;+#else if (vma->vm_flags ^ vm_flags) return 0;+#endif if (vma->vm_file != file) return 0; if (vma->vm_ops && vma->vm_ops->close)@@ -1082,7 +1092,11 @@ static int anon_vma_compatible(struct vm return a->vm_end == b->vm_start && mpol_equal(vma_policy(a), vma_policy(b)) && a->vm_file == b->vm_file &&+#ifdef CONFIG_MEM_SOFT_DIRTY+ !((a->vm_flags ^ b->vm_flags) & ~(VM_READ|VM_WRITE|VM_EXEC|VM_SOFTDIRTY)) &&+#else !((a->vm_flags ^ b->vm_flags) & ~(VM_READ|VM_WRITE|VM_EXEC)) &&+#endif b->vm_pgoff == a->vm_pgoff + ((b->vm_start - a->vm_start) >> PAGE_SHIFT); }On 01/22/2014 11:08 AM, Mel Gorman wrote:Presumably some path is failing to set VM_SOFTDIRTY, thus preventing mmsfrom being merged.That being said, this could cause vma blowups for programs that areactually using this thing.--AndyOn Wed, Jan 22, 2014 at 02:45:53PM -0800, Andy Lutomirski wrote:Hi Andy, indeed, this could happen. The easiest way is to ignore softdirty bitwhen we're trying to merge vmas and set it one new merged. I think this shouldbe correct. Once I finish I'll send the patch. CyrillOn Thu, 23 Jan 2014 09:59:06 +0400 Cyrill Gorcunov <> wrote:Hang on. We think the problem is that gimp is generating vmas which*should* be merged, but for unknown reasons they differ inVM_SOFTDIRTY, yes?Shouldn't we work out where we're forgetting to set VM_SOFTDIRTY? Putting bandaids over this error when we come to trying to merge thevmas sounds very wrong?On Wed, Jan 22, 2014 at 10:09:10PM -0800, Andrew Morton wrote:Yes. One place where I forgot to set softdirty bit is setup_arg_pages. Butit called once on elf load, so it can't cause such effect (but should befixed too). Also there is do_brk where vmasoftdirty is missed too :/Another problem is the potential scenario when we have a bunch of vmasand clear vma-softdirty bit on them, then we try to map new one, flagswon't match and instead of extending old vma the new one will be created.I think (if only I'm not missing something) that vma-softdirty shouldbe ignored in such case (ie inside is_mergeable_vma) and once vma extendedit should be marked as dirty one. Again, I need to think and test more.I'm looking into this as well. CyrillOn Wed, Jan 22, 2014 at 11:52:15AM -0800, Andrew Morton wrote:The relevant part of the test script is# Build a wrapper script to launch gimpcat > gimp-launch.sh << EOF/usr/bin/gimp -i -b "(mmtests-open-image \"$FILENAME\")" -b "(gimp-quit 0)" > $LOGDIR_RESULTS/gimp-out.1 2>&1echo \$? > gimp-exit-codeEOFchmod u+x gimp-launch.sh$TIME_CMD xinit ./gimp-launch.sh 2> $LOGDIR_RESULTS/time.1RETVAL=`cat gimp-exit-code`It's clumsy because the application would start with no window managerand looking at it again, it probably was not even necessary because ofthe -i switch in gimp.Previously when I needed to automate an X app I configured the machine tologin automatically, exported the DISPLAY variable in the test script andused wmctrl to detect if an application had a window displayed yet.On Thu, Jan 23, 2014 at 02:33:25AM +0400, Cyrill Gorcunov wrote:The test case passes with this patch applied to 3.13 so that appearsto confirm that this is related to VM_SOFTDIRTY preventing merges.Unfortunately I did not have slabinfo tracking enabled to double checkthe number of vm_area_structs in teh system.On Thu, Jan 23, 2014 at 02:33:25AM +0400, Cyrill Gorcunov wrote:The test case passes with this patch applied to 3.13 so that appearsto confirm that this is related to VM_SOFTDIRTY preventing merges.Unfortunately I did not have slabinfo tracking enabled to double checkthe number of vm_area_structs in teh system.On Thu, Jan 23, 2014 at 09:55:41AM +0000, Mel Gorman wrote:Thanks a lot, Mel! I'm testing the patch as well (manually though :).I'll send the final fix today.On Thu, Jan 23, 2014 at 02:36:06PM +0400, Cyrill Gorcunov wrote:The patch below should fix the problem. I would really appreaciatesome additional testing.---From: Cyrill Gorcunov <>Subject: [PATCH] mm: Ignore VM_SOFTDIRTY on VMA mergingVM_SOFTDIRTY bit affects vma merge routine: if two VMAs has allbits in vm_flags matched except dirty bit the kernel can't longermerge them and this forces the kernel to generate new VMAs instead.It finally may lead to the situation when userspace applicationreaches vm.max_map_count limit and get crashed in worse case | (gimp:11768): GLib-ERROR **: gmem.c:110: failed to allocate 4096 bytes | | (file-tiff-load:12038): LibGimpBase-WARNING **: file-tiff-load: gimp_wire_read(): error | xinit: connection to X server lost | | waiting for X server to shut down | /usr/lib64/gimp/2.0/plug-ins/file-tiff-load terminated: Hangup | /usr/lib64/gimp/2.0/plug-ins/script-fu terminated: Hangup | /usr/lib64/gimp/2.0/plug-ins/script-fu terminated: HangupInitial problem came from missed VM_SOFTDIRTY in do_brk() routinebut even if we would set up VM_SOFTDIRTY here, there is still a way toprevent VMAs from merging: one can call | echo 4 > /proc/$PID/clear_refsand clear all VM_SOFTDIRTY over all VMAs presented in memory map,then new do_brk() will try to extend old VMA and finds that dirtybit doesn't match thus new VMA will be generated.As discussed to Pavel, the right approach should be to ignoreVM_SOFTDIRTY bit when we're trying to merge VMAs and if mergedsuccessed we mark extended VMA with dirty bit.Reported-by: Mel Gorman <>Signed-off-by: Cyrill Gorcunov <>CC: Pavel Emelyanov <>CC: Andrew Morton <>--- mm/mmap.c | 16 ++++++++++++++-- 1 file changed, 14 insertions(+), 2 deletions(-)Index: linux-2.6.git/mm/mmap.c===================================================================--- linux-2.6.git.orig/mm/mmap.c+++ linux-2.6.git/mm/mmap.c@@ -893,7 +893,15 @@ again: remove_next = 1 + (end > next-> static inline int is_mergeable_vma(struct vm_area_struct *vma, struct file *file, unsigned long vm_flags) {- if (vma->vm_flags ^ vm_flags)+ /*+ * VM_SOFTDIRTY should not prevent from VMA merging, if we+ * match the flags but dirty bit -- the caller should mark+ * merged VMA as dirty. If dirty bit won't be excluded from+ * comparison, we increase pressue on the memory system forcing+ * the kernel to generate new VMAs when old one could be extended+ * instead.+ */+ if ((vma->vm_flags ^ vm_flags) & VM_SOFTDIRTY) return 0; if (vma->vm_file != file) return 0;@@ -1038,6 +1046,8 @@ struct vm_area_struct *vma_merge(struct end, prev->vm_pgoff, NULL); if (err) return NULL;+ else+ prev->vm_flags |= VM_SOFTDIRTY; khugepaged_enter_vma_merge(prev); return prev; }@@ -1057,6 +1067,8 @@ struct vm_area_struct *vma_merge(struct next->vm_pgoff - pglen, NULL); if (err) return NULL;+ else+ area->vm_flags |= VM_SOFTDIRTY; khugepaged_enter_vma_merge(area); return area; }@@ -1082,7 +1094,7 @@ static int anon_vma_compatible(struct vm return a->vm_end == b->vm_start && mpol_equal(vma_policy(a), vma_policy(b)) && a->vm_file == b->vm_file &&- !((a->vm_flags ^ b->vm_flags) & ~(VM_READ|VM_WRITE|VM_EXEC)) &&+ !((a->vm_flags ^ b->vm_flags) & ~(VM_READ|VM_WRITE|VM_EXEC|VM_SOFTDIRTY)) && b->vm_pgoff == a->vm_pgoff + ((b->vm_start - a->vm_start) >> PAGE_SHIFT); }On Thu, Jan 23, 2014 at 04:15:55PM +0400, Cyrill Gorcunov wrote:Forgot to refresh the patch, sorry.---From: Cyrill Gorcunov <>Subject: [PATCH] mm: Ignore VM_SOFTDIRTY on VMA mergingVM_SOFTDIRTY bit affects vma merge routine: if two VMAs has allbits in vm_flags matched except dirty bit the kernel can't longermerge them and this forces the kernel to generate new VMAs instead.It finally may lead to the situation when userspace applicationreaches vm.max_map_count limit and get crashed in worse case | (gimp:11768): GLib-ERROR **: gmem.c:110: failed to allocate 4096 bytes | | (file-tiff-load:12038): LibGimpBase-WARNING **: file-tiff-load: gimp_wire_read(): error | xinit: connection to X server lost | | waiting for X server to shut down | /usr/lib64/gimp/2.0/plug-ins/file-tiff-load terminated: Hangup | /usr/lib64/gimp/2.0/plug-ins/script-fu terminated: Hangup | /usr/lib64/gimp/2.0/plug-ins/script-fu terminated: HangupInitial problem came from missed VM_SOFTDIRTY in do_brk() routinebut even if we would set up VM_SOFTDIRTY here, there is still a way toprevent VMAs from merging: one can call | echo 4 > /proc/$PID/clear_refsand clear all VM_SOFTDIRTY over all VMAs presented in memory map,then new do_brk() will try to extend old VMA and finds that dirtybit doesn't match thus new VMA will be generated.As discussed to Pavel, the right approach should be to ignoreVM_SOFTDIRTY bit when we're trying to merge VMAs and if mergedsuccessed we mark extended VMA with dirty bit.Reported-by: Mel Gorman <>Signed-off-by: Cyrill Gorcunov <>CC: Pavel Emelyanov <>CC: Andrew Morton <>--- mm/mmap.c | 16 ++++++++++++++-- 1 file changed, 14 insertions(+), 2 deletions(-)Index: linux-2.6.git/mm/mmap.c===================================================================--- linux-2.6.git.orig/mm/mmap.c+++ linux-2.6.git/mm/mmap.c@@ -893,7 +893,15 @@ again: remove_next = 1 + (end > next-> static inline int is_mergeable_vma(struct vm_area_struct *vma, struct file *file, unsigned long vm_flags) {- if (vma->vm_flags ^ vm_flags)+ /*+ * VM_SOFTDIRTY should not prevent from VMA merging, if we+ * match the flags but dirty bit -- the caller should mark+ * merged VMA as dirty. If dirty bit won't be excluded from+ * comparison, we increase pressue on the memory system forcing+ * the kernel to generate new VMAs when old one could be extended+ * instead.+ */+ if ((vma->vm_flags ^ vm_flags) & ~VM_SOFTDIRTY) return 0; if (vma->vm_file != file) return 0;@@ -1038,6 +1046,8 @@ struct vm_area_struct *vma_merge(struct end, prev->vm_pgoff, NULL); if (err) return NULL;+ else+ prev->vm_flags |= VM_SOFTDIRTY; khugepaged_enter_vma_merge(prev); return prev; }@@ -1057,6 +1067,8 @@ struct vm_area_struct *vma_merge(struct next->vm_pgoff - pglen, NULL); if (err) return NULL;+ else+ area->vm_flags |= VM_SOFTDIRTY; khugepaged_enter_vma_merge(area); return area; }@@ -1082,7 +1094,7 @@ static int anon_vma_compatible(struct vm return a->vm_end == b->vm_start && mpol_equal(vma_policy(a), vma_policy(b)) && a->vm_file == b->vm_file &&- !((a->vm_flags ^ b->vm_flags) & ~(VM_READ|VM_WRITE|VM_EXEC)) &&+ !((a->vm_flags ^ b->vm_flags) & ~(VM_READ|VM_WRITE|VM_EXEC|VM_SOFTDIRTY)) && b->vm_pgoff == a->vm_pgoff + ((b->vm_start - a->vm_start) >> PAGE_SHIFT); }FYI: This bug hits us in AddressSanitizer, where the allocator creates lotsof adjacent mappings and expects the kernel to merge them.FYI: This bug hits us in AddressSanitizer, where the allocator creates lotsof adjacent mappings and expects the kernel to merge them.FTR, here is a small test case that would fail if the bug is present: #include <stdlib.h>#include <stdio.h>#include <unistd.h>#include <sys/mman.h>#include <assert.h>int main() { char *p = (char*)0x600000000000; size_t i; for (i = 0; i < 100000; i++) { void *addr = p + i * 4096; void *ret = mmap(addr, 4096, PROT_WRITE | PROT_READ, MAP_PRIVATE | MAP_ANONYMOUS, 0, 0); if (addr != ret) { fprintf(stderr, "failed at iteration %zd\n", i); char command[100]; snprintf(command, sizeof(command), "cat /proc/%d/maps | head -30", getpid()); system(command); return 1; } }}On a broken kernel it will print something like this:failed at iteration 6551400400000-00401000 r-xp 00000000 fc:00 20991316 /tmp/a.out00600000-00601000 r--p 00000000 fc:00 20991316 /tmp/a.out00601000-00602000 rw-p 00001000 fc:00 20991316 /tmp/a.out600000000000-600000001000 rw-p 00000000 00:00 0 600000001000-600000002000 rw-p 00000000 00:00 0 600000002000-600000003000 rw-p 00000000 00:00 0 600000003000-600000004000 rw-p 00000000 00:00 0 600000004000-600000005000 rw-p 00000000 00:00 0 ...
id=60697	CreatedEnvironment infoI'm currently on the 3.8.0 kernel with Ubuntu 13.04 (Raring) x64 on a Thinkpad x201. I have hibernation enabled by following the instructions in the official Ubuntu documentation[1].If Bluetooth is disabled before hibernation, on resume it will be re-enabled.I have the latest BIOS installed (1.40-1.15)[2], and can reproduce this issue with the latest mainline kernel available to me (v3.11-rc3-saucy)[3]. I didn't experience this issue with the 3.5.0 kernel (with Ubuntu 12.10 Quantal), so it appears to be a regression.I've done a bisection with this result:I originally logged this issue to the Ubuntu bug tracker[4], but it appears to be an upstream issue and so I was instructed to report here.Attached is more information on my environment and the output of acpidump. Please let me know if there is anything I can do to help resolve this issue.Thanks,Jeff[1][2][3][4] CreatedOutput of acpidumpDoes it help if you append acpi_osi="!Windows 2012" to the kernel's command line?When I add acpi_osi="!Windows 2012" to v3.11-rc4 (which still has this issue), the issue is not present, i.e. Bluetooth stays disabled after resuming.Please attach the output of dmidecode from the affected machine.CreatedOutput of dmidecode --dumpPlease let me know if you need a binary dump as well.I've checked the ASL code firmware has provided, it's not clear to me why win8 mode would affect this functionality. But perhaps thinkpad-acpi maintainer Henrique knows the reason.ASL is not the only thing generally affected by OSI. It simply changes the BIOS' behavior and there's no telling which way.Can you reproduce this issue when the thinkpad-acpi driver is not present?I'm able to reproduce this issue without the thinkpad_acpi module loaded (tested with v3.11-rc5).Createdoutput of dmidecode --dumpCreatedenvironmentI also have trouble with this commit, it disables my hardware switch for enable/disable wifi. See [1] for full explanation.When I add acpi_osi="!Windows 2012" it fixes my issue.dmidecode output uploaded as requested [2] and environment [3][1][2][3](In reply to Jeffery To from)I'm not sure about this, but I remembered bluetooth enable/disable functionality is provided by thinkpad_acpi module. So without that module, can you still disable bluetooth? Or is it that it boots with bluetooth off and when resumed, bluetooth is tured on?(In reply to Wouter Depypere from)Please also attach acpidump, thanks.(In reply to Aaron Lu from)With thinkpad_acpi blacklisted, Bluetooth is enabled on boot. I can't turn it off unless I run "modprobe thinkpad_acpi" beforehand. After turning Bluetooth off, I ran "rmmod thinkpad_acpi" before hibernating. I verified that thinkpad_acpi isn't loaded (with lsmod) before hibernating and after resuming. Bluetooth is enabled on resume.I tried this same test with the acpi_osi="!Windows 2012" kernel parameter (and thinkpad_acpi blacklisted). Bluetooth is disabled on boot. I verified that thinkpad_acpi isn't loaded (with lsmod) before hibernating and after resuming. Bluetooth is disabled on resume.(I remember Bluetooth use to be disabled on boot if I left it disabled on shutdown/reboot; this was usually the case since I rarely use Bluetooth. IIRC this changed after upgrading to Raring / the v3.8 kernel; now it is always enabled, and I installed TLP to "fix" this. I didn't file a report for this since I wasn't sure if it was a bug.)(In reply to Rafael J. Wysocki from)Then there is nothing we can do I'm afraid... Shall I prepare a patch to do the OSI blacklist for the two systems?Hi Jeffery,Do you have Win8 installed? I wonder what the behavior of Win8 is regarding Bluetooth.(In reply to Aaron Lu from)Sorry, I don't have Windows 8. If there's important information to be found, I can find a way to install it.(In reply to Jeffery To from)Not that important to cost you the license fee, just good to know :-) So forget it, even if we know it works or not, it still doesn't give me any hint why.Createdthe output of acpidumpAs requested the output of my acpidump.Aaron: we have dmidecode above, can you add this to the win8 OSI blacklist?Hi Jeffery and Wouter,Is there any side effects when you use acpi_osi="!Windows 2012"? If not, I'll add your system into the win8 blacklist table.(In reply to Aaron Lu from)I added this to my grub config about a month ago and haven't noticed anything particular.(In reply to Jeffery To from)It is the same for me. Added it to grub a few months ago and I haven't experienced anything particular.CreatedDisable win8 mode for ThinkPad X201 and Latitue E6230Please give it a test, no need to specify acpi_osi="!Windows 2012" cmdline option.Please attach dmidecode again without using the --dump option, that option is for debugging not for human eye :-)(In reply to Aaron Lu from)I have tested it with 3.13 and the proposed patch and I can confirm it works for me. I will attach the dmidecode shortly.Creatednew output dmidecode --dump(In reply to Wouter Depypere from)3.13 with the patch also works for me - thanks!CreatedOutput of dmidecode, with patchThanks for the confirm, patch sent out:Createdthinkpad_acpi test patchJeffery,Can you test this patch without Aaron's patch applied?Mathew,I tried your patch with 3.13-rc3 (without Aaron's patch or the acpi_osi parameter). Bluetooth was re-enabled after resuming from hibernate.
id=16226	The original patch has some documentation which seems to be missing in the most recent kernel versions. See Sorry, I can't see this bug as resolved (or obsolete).Still there:And still no documentation:ThanksSetting a kernel version so it doesn't get expired, however you probably want to report this toto actually get it fixed
id=60795	Does not work:root@n1cc[staging]:/sys/fs# mount -t tmpfs tmpfs cgroup/root@n1cc[staging]:/sys/fs# cd cgroup/root@n1cc[staging]:/sys/fs/cgroup# ltotal 0root@n1cc[staging]:/sys/fs/cgroup# mkdir cpusetroot@n1cc[staging]:/sys/fs/cgroup# mount -t cgroup -ocpuset cpuset /sys/fs/cgroup/cpusetmount: cpuset already mounted or /sys/fs/cgroup/cpuset busyroot@n1cc[staging]:/sys/fs/cgroup# uname -aLinux n1cc 3.10-1-amd64 #1 SMP Debian 3.10.3-1 (2013-07-27) x86_64 GNU/LinuxOf course cpuset is not already mounted.Works:root@n1cc[staging]:/sys/fs# mount -t tmpfs tmpfs cgroup/root@n1cc[staging]:/sys/fs# cd cgroup/root@n1cc[staging]:/sys/fs/cgroup# mkdir cpusetroot@n1cc[staging]:/sys/fs/cgroup# mount -t cgroup -ocpuset cpuset /sys/fs/cgroup/cpusetroot@n1cc[staging]:/sys/fs/cgroup# uname -aLinux n1cc 3.9-1-amd64 #1 SMP Debian 3.9.8-1 x86_64 GNU/LinuxMounting cgroups using default options works on both kernels. Works with 3.10.11. I am not sure but it probably started to work after reboot. I was trying to mount cpuset after umounting all cgroups mounted with command:# mount -t cgroup cgroup /sys/fs/cgroupI had the same problem with kernel 3.19.3.If you mount cgroup in /sys/fs/cgroup, it's over.You can unmount it but you'll never be able to mount the cgroup subdirs under a newly created tmpfs, you get 'already mounted or busy'/proc/mounts shows cgroups is not mounted anywhere, if I reboot, everything works.
id=37702	Hello.Since I installed my new DVB-S2-card (Hauppauge WinTV-Nova HD-S2), my Linux-Computer can't shutdown any more. Instead of the usual shutdown process appears an error, as you can see below:QUOTE:...* Unmounting weak filesystem... [ OK ]* Will now halt [14601.256530] cx88[0]/1: IRQ loop detected, disabling interrupts[14601.320433] cx88[0]/1: IRQ loop detected, disabling interrupts[14601.320433] cx88[0]/1: IRQ loop detected, disabling interrupts[14601.378344] cx88[0]/1: IRQ loop detected, disabling interrupts[14601.418702] cx88[0]/1: IRQ loop detected, disabling interrupts[14601.459055] cx88[0]/1: IRQ loop detected, disabling interrupts[14601.499409] cx88[0]/1: IRQ loop detected, disabling interrupts[14601.539764] cx88[0]/1: IRQ loop detected, disabling interrupts[14601.580119] cx88[0]/1: IRQ loop detected, disabling interrupts[14601.620471] cx88[0]/1: IRQ loop detected, disabling interrupts[14601.660824] cx88[0]/1: IRQ loop detected, disabling interrupts[14601.701178] cx88[0]/1: IRQ loop detected, disabling interrupts[14601.741533] cx88[0]/1: IRQ loop detected, disabling interrupts[14601.781884] cx88[0]/1: IRQ loop detected, disabling interrupts...and so on...UNQUOTEI tried a few Linux distributions (i.e. Ubuntu Maverick, Arch Linux, openSUSE) but it's always like that.The only one possibility the aviod these messages is to unload the modules cx88_dvb, cx88_vp3054_i2c, cx88_alsa, cx8800, cx8802 and cx88xx before shutdown. I'm having the same issue with my HVR-1100 tuner card after replacing my old ASUS A8V-VM SE motherboard (AMD Athlon 64) with a Gigabyte GA-870A-USB3 (AMD FX-8120).Someone was having a similar (maybe not exactly the same) issue and fixed it as follows:Regards,AntonioUnfortunately the problem still appears, even with kernel version 3.8.3.Additional information may be necessary?
id=89581	I'm running slackware linux 14 32 bits as a firewall/ipsecgateway with linux 3.18.0I got this error just after 12 hours uptime: WARNING: CPU: 0 PID: 0 at net/sched/sch_generic.c:303 dev_watchdog+0xee/0x174()NETDEV WATCHDOG: eth0 (r8169): transmit queue 0 timed outModules linked in: xfrm4_tunnel af_key authenc xfrm4_mode_tunnel deflate zlib_deflate zlib_inflate ctr twofish_generic twofish_i586 twofish_common serpent_sse2_i586 serpent_generic glue_helper blowfish_generic blowfish_common cbc ecb sha512_generic hmac tunnel4 ipcomp xfrm_ipcomp esp4 xts lrw gf128mul ablk_helper cryptd aes_i586 des_generic md5 sha1_generic sha256_generic nf_nat_pptp nf_nat_proto_gre nf_conntrack_pptp nf_conntrack_proto_gre nf_nat_ftp nf_conntrack_ftp xt_helper xt_mark xt_statistic xt_nat xt_multiport xt_limit xt_tcpudp xt_policy xt_conntrack iptable_mangle iptable_nat nf_conntrack_ipv4 nf_defrag_ipv4 nf_nat_ipv4 nf_nat nf_conntrack iptable_filter ip_tables x_tables uhci_hcd ehci_pci tg3 ehci_hcd 8250 ptp usbcore pps_core serial_core libphy rtc_cmos r8169 usb_common mii processor thermal_sys hwmon loop [last unloaded: af_key]CPU: 0 PID: 0 Comm: swapper/0 Not tainted 3.18.0 #1Hardware name: Hewlett-Packard HP xw4400 Workstation/0A68h, BIOS 786D7 v02.07 10/28/2010 00000000 c125fe2a f580bf6c c10282cb c1202130 f5904000 00000000 02b1e170 00000000 c1028346 00000009 f580bf6c c1302f9c f580bf84 c1202130 c1302fd5 0000012f c1302f9c f5904000 f812e2e0 00000000 80000100 c1202042 f580bfbcCall Trace: [<c125fe2a>] ? dump_stack+0x3e/0x4e [<c10282cb>] ? warn_slowpath_common+0x61/0x74 [<c1202130>] ? dev_watchdog+0xee/0x174 [<c1028346>] ? warn_slowpath_fmt+0x29/0x2d [<c1202130>] ? dev_watchdog+0xee/0x174 [<c1202042>] ? pfifo_fast_dequeue+0xa2/0xa2 [<c1051446>] ? call_timer_fn.isra.30+0xf/0x5a [<c10516b1>] ? run_timer_softirq+0x126/0x16f [<c102a10c>] ? __do_softirq+0x8f/0x16c [<c102a07d>] ? __hrtimer_tasklet_trampoline+0x13/0x13 [<c1002e71>] ? do_softirq_own_stack+0x1a/0x1f <IRQ> [<c102a313>] ? irq_exit+0x31/0x70 [<c101cbec>] ? smp_apic_timer_interrupt+0x30/0x39 [<c1263609>] ? apic_timer_interrupt+0x2d/0x34 [<c1007502>] ? default_idle+0x2/0x3 [<c1007a0f>] ? arch_cpu_idle+0x6/0x7 [<c1046686>] ? cpu_startup_entry+0xeb/0x211 [<c135a95c>] ? start_kernel+0x2d2/0x2d5---[ end trace 71b9cfb317b62846 ]---r8169 0000:10:00.0 eth0: link up Here is dmesg output Linux version 3.18.0 (root@Pleiadi) (gcc version 4.7.1 (GCC) ) #1 SMP Tue Dec 9 16:46:26 CET 2014e820: BIOS-provided physical RAM map:BIOS-e820: [mem 0x0000000000000000-0x000000000009fbff] usableBIOS-e820: [mem 0x000000000009fc00-0x000000000009ffff] reservedBIOS-e820: [mem 0x00000000000e8000-0x00000000000fffff] reservedBIOS-e820: [mem 0x0000000000100000-0x00000000bffc62ff] usableBIOS-e820: [mem 0x00000000bffc6300-0x00000000bfffffff] reservedBIOS-e820: [mem 0x00000000f0000000-0x00000000f3ffffff] reservedBIOS-e820: [mem 0x00000000fec00000-0x00000000fed3ffff] reservedBIOS-e820: [mem 0x00000000fed45000-0x00000000ffffffff] reservedNotice: NX (Execute Disable) protection cannot be enabled: non-PAE kernel!SMBIOS 2.4 present.DMI: Hewlett-Packard HP xw4400 Workstation/0A68h, BIOS 786D7 v02.07 10/28/2010e820: update [mem 0x00000000-0x00000fff] usable ==> reservede820: remove [mem 0x000a0000-0x000fffff] usablee820: last_pfn = 0xbffc6 max_arch_pfn = 0x100000MTRR default type: uncachableMTRR fixed ranges enabled: 00000-9FFFF write-back A0000-BFFFF uncachable C0000-E3FFF write-protect E4000-EFFFF write-back F0000-FFFFF write-protectMTRR variable ranges enabled: 0 base 000000000 mask F80000000 write-back 1 base 080000000 mask FC0000000 write-back 2 disabled 3 disabled 4 disabled 5 disabled 6 disabled 7 disabledx86 PAT enabled: cpu 0, old 0x7040600070406, new 0x7010600070106found SMP MP-table at [mem 0x000f9bf0-0x000f9bff] mapped at [c00f9bf0]initial memory mapped: [mem 0x00000000-0x017fffff]Base memory trampoline at [c009b000] 9b000 size 16384init_memory_mapping: [mem 0x00000000-0x000fffff] [mem 0x00000000-0x000fffff] page 4kinit_memory_mapping: [mem 0x37000000-0x373fffff] [mem 0x37000000-0x373fffff] page 2Minit_memory_mapping: [mem 0x30000000-0x36ffffff] [mem 0x30000000-0x36ffffff] page 2Minit_memory_mapping: [mem 0x00100000-0x2fffffff] [mem 0x00100000-0x003fffff] page 4k [mem 0x00400000-0x2fffffff] page 2Minit_memory_mapping: [mem 0x37400000-0x377fdfff] [mem 0x37400000-0x377fdfff] page 4kBRK [0x0141c000, 0x0141cfff] PGTABLEACPI: Early table checksum verification disabledACPI: RSDP 0x000E7810 000014 (v00 COMPAQ)ACPI: RSDT 0xBFFC6340 000044 (v01 HPQOEM SLIC-WKS 20101028 00000000)ACPI: FACP 0xBFFC63EC 000074 (v01 COMPAQ GLENWOOD 00000001 00000000)ACPI: DSDT 0xBFFC6763 00037B (v01 COMPAQ DSDT_PRJ 00000001 MSFT 0100000E)ACPI: FACS 0xBFFC6300 000040ACPI: SSDT 0xBFFC6ADE 008C6C (v01 COMPAQ DSDT_HW 00000001 MSFT 0100000E)ACPI: APIC 0xBFFC6460 000084 (v01 COMPAQ GLENWOOD 00000001 00000000)ACPI: ASF! 0xBFFC64E4 000063 (v32 COMPAQ GLENWOOD 00000001 00000000)ACPI: MCFG 0xBFFC6547 00003C (v01 COMPAQ GLENWOOD 00000001 00000000)ACPI: TCPA 0xBFFC6583 000032 (v01 COMPAQ GLENWOOD 00000001 00000000)ACPI: SLIC 0xBFFC65B5 000176 (v01 HPQOEM SLIC-WKS 00000001 00000000)ACPI: HPET 0xBFFC672B 000038 (v01 COMPAQ GLENWOOD 00000001 00000000)ACPI: Local APIC address 0xfee000002183MB HIGHMEM available.887MB LOWMEM available. mapped low ram: 0 - 377fe000 low ram: 0 - 377fe000BRK [0x0141d000, 0x0141dfff] PGTABLEZone ranges: DMA [mem 0x00001000-0x00ffffff] Normal [mem 0x01000000-0x377fdfff] HighMem [mem 0x377fe000-0xbffc5fff]Movable zone start for each nodeEarly memory node ranges node 0: [mem 0x00001000-0x0009efff] node 0: [mem 0x00100000-0xbffc5fff]Initmem setup node 0 [mem 0x00001000-0xbffc5fff]On node 0 totalpages: 786276free_area_init_node: node 0, pgdat c13542c0, node_mem_map f5ffe020 DMA zone: 32 pages used for memmap DMA zone: 0 pages reserved DMA zone: 3998 pages, LIFO batch:0 Normal zone: 1744 pages used for memmap Normal zone: 223230 pages, LIFO batch:31 HighMem zone: 4368 pages used for memmap HighMem zone: 559048 pages, LIFO batch:31Using APIC driver defaultACPI: PM-Timer IO Port: 0xf808ACPI: Local APIC address 0xfee00000ACPI: LAPIC (acpi_id[0x01] lapic_id[0x00] enabled)ACPI: LAPIC (acpi_id[0x02] lapic_id[0x01] enabled)ACPI: LAPIC (acpi_id[0x03] lapic_id[0x02] disabled)ACPI: LAPIC (acpi_id[0x04] lapic_id[0x03] disabled)ACPI: LAPIC_NMI (acpi_id[0x01] high edge lint[0x1])ACPI: LAPIC_NMI (acpi_id[0x02] high edge lint[0x1])ACPI: LAPIC_NMI (acpi_id[0x03] high edge lint[0x1])ACPI: LAPIC_NMI (acpi_id[0x04] high edge lint[0x1])ACPI: IOAPIC (id[0x01] address[0xfec00000] gsi_base[0])IOAPIC[0]: apic_id 1, version 32, address 0xfec00000, GSI 0-23ACPI: INT_SRC_OVR (bus 0 bus_irq 0 global_irq 2 dfl dfl)ACPI: INT_SRC_OVR (bus 0 bus_irq 9 global_irq 9 high level)ACPI: IRQ0 used by override.ACPI: IRQ9 used by override.Using ACPI (MADT) for SMP configuration informationACPI: HPET id: 0x8086a201 base: 0xfed00000smpboot: Allowing 2 CPUs, 0 hotplug CPUse820: [mem 0xc0000000-0xefffffff] available for PCI devicessetup_percpu: NR_CPUS:2 nr_cpumask_bits:2 nr_cpu_ids:2 nr_node_ids:1PERCPU: Embedded 14 pages/cpu @f5fd0000 s25664 r0 d31680 u57344pcpu-alloc: s25664 r0 d31680 u57344 alloc=14*4096pcpu-alloc: [0] 0 [0] 1 Built 1 zonelists in Zone order, mobility grouping on. Total pages: 784500Kernel command line: auto BOOT_IMAGE=Linux ro root=801 vt.default_utf8=0PID hash table entries: 4096 (order: 2, 16384 bytes)Dentry cache hash table entries: 131072 (order: 7, 524288 bytes)Inode-cache hash table entries: 65536 (order: 6, 262144 bytes)Initializing CPU#0Initializing HighMem for node 0 (000377fe:000bffc6)Initializing Movable for node 0 (00000000:00000000)Memory: 3115256K/3145104K available (2448K kernel code, 182K rwdata, 788K rodata, 332K init, 404K bss, 29848K reserved, 2236192K highmem)virtual kernel memory layout: fixmap : 0xfff8f000 - 0xfffff000 ( 448 kB) pkmap : 0xff800000 - 0xffc00000 (4096 kB) vmalloc : 0xf7ffe000 - 0xff7fe000 ( 120 MB) lowmem : 0xc0000000 - 0xf77fe000 ( 887 MB) .init : 0xc135a000 - 0xc13ad000 ( 332 kB) .data : 0xc126462f - 0xc1358a40 ( 977 kB) .text : 0xc1000000 - 0xc126462f (2449 kB)Checking if this processor honours the WP bit even in supervisor mode...Ok.SLUB: HWalign=64, Order=0-3, MinObjects=0, CPUs=2, Nodes=1Hierarchical RCU implementation.NR_IRQS:2304 nr_irqs:440 0CPU 0 irqstacks, hard=f5808000 soft=f580a000Console: colour VGA+ 80x25console [tty0] enabledhpet clockevent registeredtsc: Fast TSC calibration using PITtsc: Detected 2400.197 MHz processorCalibrating delay loop (skipped), value calculated using timer frequency.. 4800.39 BogoMIPS (lpj=2400197)pid_max: default: 32768 minimum: 301ACPI: Core revision 20140926ACPI: All ACPI Tables successfully acquiredMount-cache hash table entries: 2048 (order: 1, 8192 bytes)Mountpoint-cache hash table entries: 2048 (order: 1, 8192 bytes)CPU: Physical Processor ID: 0CPU: Processor Core ID: 0Last level iTLB entries: 4KB 128, 2MB 4, 4MB 4Last level dTLB entries: 4KB 256, 2MB 0, 4MB 32, 1GB 0Freeing SMP alternatives memory: 12K (c13ad000 - c13b0000)Enabling APIC mode: Flat. Using 1 I/O APICs..TIMER: vector=0x30 apic1=0 pin1=2 apic2=-1 pin2=-1smpboot: CPU0: Intel(R) Core(TM)2 CPU 6600 @ 2.40GHz (fam: 06, model: 0f, stepping: 06)Performance Events: PEBS fmt0-, 4-deep LBR, Core2 events, Intel PMU driver.perf_event_intel: PEBS disabled due to CPU errata... version: 2... bit width: 40... generic registers: 2... value mask: 000000ffffffffff... max period: 000000007fffffff... fixed-purpose events: 3... event mask: 0000000700000003CPU 1 irqstacks, hard=f5892000 soft=f5894000x86: Booting SMP configuration:.... node #0, CPUs: #1Initializing CPU#1x86: Booted up 1 node, 2 CPUssmpboot: Total of 2 processors activated (9600.78 BogoMIPS)devtmpfs: initializedNET: Registered protocol family 16cpuidle: using governor laddercpuidle: using governor menuACPI: bus type PCI registeredPCI: MMCONFIG for domain 0000 [bus 00-3f] at [mem 0xf0000000-0xf3ffffff] (base 0xf0000000)PCI: MMCONFIG at [mem 0xf0000000-0xf3ffffff] reserved in E820PCI: Using MMCONFIG for extended config spacePCI: Using configuration type 1 for base accessACPI: Added _OSI(Module Device)ACPI: Added _OSI(Processor Device)ACPI: Added _OSI(3.0 _SCP Extensions)ACPI: Added _OSI(Processor Aggregator Device)ACPI: Dynamic OEM Table Load:ACPI: SSDT 0xF5A10000 0004DF (v01 COMPAQ CPU_TM2 00000001 MSFT 0100000E)ACPI: Interpreter enabledACPI: (supports S0 S5)ACPI: Using IOAPIC for interrupt routingPCI: Using host bridge windows from ACPI; if necessary, use "pci=nocrs" and report a bugACPI: PCI Root Bridge [PCI0] (domain 0000 [bus 00-ff])acpi PNP0A08:00: _OSC: OS supports [ExtendedConfig ASPM ClockPM Segments MSI]ACPI BIOS Error (bug): \_SB_.PCI0._OSC: Excess arguments - ASL declared 5, ACPI requires 4 (20140926/nsarguments-189)ACPI Error: [CAPD] Namespace lookup failure, AE_ALREADY_EXISTS (20140926/dsfield-211)ACPI Error: Method parse/execution failed [\_SB_.PCI0._OSC] (Node f58326c0), AE_ALREADY_EXISTS (20140926/psparse-536)acpi PNP0A08:00: _OSC failed (AE_ALREADY_EXISTS); disabling ASPMacpi PNP0A08:00: [Firmware Info]: MMCONFIG for domain 0000 [bus 00-3f] only partially covers this bridgePCI host bridge to bus 0000:00pci_bus 0000:00: root bus resource [bus 00-ff]pci_bus 0000:00: root bus resource [mem 0xf4000000-0xfebfffff]pci_bus 0000:00: root bus resource [io 0x0000-0x0cf7]pci_bus 0000:00: root bus resource [io 0x1000-0x2fff]pci_bus 0000:00: root bus resource [io 0x3000-0x6fff]pci_bus 0000:00: root bus resource [io 0x7000-0xafff]pci_bus 0000:00: root bus resource [io 0xb000-0xffff]pci_bus 0000:00: root bus resource [mem 0x000a0000-0x000bffff]pci_bus 0000:00: root bus resource [mem 0xc0000000-0xefffffff]pci 0000:00:00.0: [8086:277c] type 00 class 0x060000pci 0000:00:01.0: [8086:277d] type 01 class 0x060400pci 0000:00:01.0: PME# supported from D0 D3hot D3coldpci 0000:00:1b.0: [8086:27d8] type 00 class 0x040300pci 0000:00:1b.0: reg 0x10: [mem 0x00000000-0x00003fff 64bit]pci 0000:00:1b.0: PME# supported from D0 D3hot D3coldpci 0000:00:1c.0: [8086:27d0] type 01 class 0x060400pci 0000:00:1c.0: PME# supported from D0 D3hot D3coldpci 0000:00:1c.4: [8086:27e0] type 01 class 0x060400pci 0000:00:1c.4: PME# supported from D0 D3hot D3coldpci 0000:00:1c.5: [8086:27e2] type 01 class 0x060400pci 0000:00:1c.5: PME# supported from D0 D3hot D3coldpci 0000:00:1d.0: [8086:27c8] type 00 class 0x0c0300pci 0000:00:1d.0: reg 0x20: [io 0x4000-0x401f]pci 0000:00:1d.1: [8086:27c9] type 00 class 0x0c0300pci 0000:00:1d.1: reg 0x20: [io 0x4020-0x403f]pci 0000:00:1d.2: [8086:27ca] type 00 class 0x0c0300pci 0000:00:1d.2: reg 0x20: [io 0x4040-0x405f]pci 0000:00:1d.3: [8086:27cb] type 00 class 0x0c0300pci 0000:00:1d.3: reg 0x20: [io 0x4060-0x407f]pci 0000:00:1d.7: [8086:27cc] type 00 class 0x0c0320pci 0000:00:1d.7: reg 0x10: [mem 0xe9004000-0xe90043ff]pci 0000:00:1d.7: PME# supported from D0 D3hot D3coldpci 0000:00:1e.0: [8086:244e] type 01 class 0x060401pci 0000:00:1f.0: [8086:27b8] type 00 class 0x060100pci 0000:00:1f.0: can't claim BAR 7 [io 0xf800-0xf87f]: address conflict with ACPI CPU throttle [io 0xf810-0xf815]pci 0000:00:1f.0: quirk: [io 0xfa00-0xfa3f] claimed by ICH6 GPIOpci 0000:00:1f.0: ICH7 LPC Generic IO decode 1 PIO at 0400 (mask 007f)pci 0000:00:1f.0: ICH7 LPC Generic IO decode 2 PIO at 0480 (mask 000f)pci 0000:00:1f.0: ICH7 LPC Generic IO decode 3 PIO at 0cb0 (mask 000f)pci 0000:00:1f.1: [8086:27df] type 00 class 0x01018apci 0000:00:1f.1: reg 0x10: [io 0x40c0-0x40c7]pci 0000:00:1f.1: reg 0x14: [io 0x40e0-0x40e3]pci 0000:00:1f.1: reg 0x18: [io 0x40c8-0x40cf]pci 0000:00:1f.1: reg 0x1c: [io 0x40e4-0x40e7]pci 0000:00:1f.1: reg 0x20: [io 0x40a0-0x40af]pci 0000:00:1f.1: legacy IDE quirk: reg 0x10: [io 0x01f0-0x01f7]pci 0000:00:1f.1: legacy IDE quirk: reg 0x14: [io 0x03f6]pci 0000:00:1f.1: legacy IDE quirk: reg 0x18: [io 0x0170-0x0177]pci 0000:00:1f.1: legacy IDE quirk: reg 0x1c: [io 0x0376]pci 0000:00:1f.2: [8086:27c1] type 00 class 0x010601pci 0000:00:1f.2: reg 0x10: [io 0x40d0-0x40d7]pci 0000:00:1f.2: reg 0x14: [io 0x40e8-0x40eb]pci 0000:00:1f.2: reg 0x18: [io 0x40d8-0x40df]pci 0000:00:1f.2: reg 0x1c: [io 0x40ec-0x40ef]pci 0000:00:1f.2: reg 0x20: [io 0x40b0-0x40bf]pci 0000:00:1f.2: reg 0x24: [mem 0xe9004400-0xe90047ff]pci 0000:00:1f.2: PME# supported from D3hotpci 0000:01:00.0: [1002:5b63] type 00 class 0x030000pci 0000:01:00.0: reg 0x10: [mem 0xe0000000-0xe7ffffff pref]pci 0000:01:00.0: reg 0x14: [io 0x3000-0x30ff]pci 0000:01:00.0: reg 0x18: [mem 0xe8b00000-0xe8b0ffff]pci 0000:01:00.0: reg 0x30: [mem 0x00000000-0x0001ffff pref]pci 0000:01:00.0: supports D1 D2pci 0000:01:00.1: [1002:5b73] type 00 class 0x038000pci 0000:01:00.1: reg 0x10: [mem 0xe8b10000-0xe8b1ffff]pci 0000:01:00.1: supports D1 D2pci 0000:01:00.0: disabling ASPM on pre-1.1 PCIe device. You can enable it with 'pcie_aspm=force'pci 0000:00:01.0: PCI bridge to [bus 01]pci 0000:00:01.0: bridge window [io 0x3000-0x3fff]pci 0000:00:01.0: bridge window [mem 0xe8b00000-0xe8dfffff]pci 0000:00:01.0: bridge window [mem 0xe0000000-0xe81fffff 64bit pref]pci 0000:10:00.0: [10ec:8168] type 00 class 0x020000pci 0000:10:00.0: reg 0x10: [io 0x2000-0x20ff]pci 0000:10:00.0: reg 0x18: [mem 0xe9600000-0xe9600fff 64bit]pci 0000:10:00.0: reg 0x20: [mem 0xe8500000-0xe850ffff 64bit pref]pci 0000:10:00.0: reg 0x30: [mem 0x00000000-0x0001ffff pref]pci 0000:10:00.0: supports D1 D2pci 0000:10:00.0: PME# supported from D0 D1 D2 D3hot D3coldpci 0000:00:1c.0: PCI bridge to [bus 10]pci 0000:00:1c.0: bridge window [io 0x2000-0x2fff]pci 0000:00:1c.0: bridge window [mem 0xe9400000-0xe96fffff]pci 0000:00:1c.0: bridge window [mem 0xe8500000-0xe87fffff 64bit pref]pci 0000:28:00.0: [10ec:8168] type 00 class 0x020000pci 0000:28:00.0: reg 0x10: [io 0x1000-0x10ff]pci 0000:28:00.0: reg 0x18: [mem 0xe9100000-0xe9100fff 64bit]pci 0000:28:00.0: reg 0x20: [mem 0xe8400000-0xe840ffff 64bit pref]pci 0000:28:00.0: reg 0x30: [mem 0x00000000-0x0001ffff pref]pci 0000:28:00.0: supports D1 D2pci 0000:28:00.0: PME# supported from D0 D1 D2 D3hot D3coldpci 0000:00:1c.4: PCI bridge to [bus 28]pci 0000:00:1c.4: bridge window [io 0x1000-0x1fff]pci 0000:00:1c.4: bridge window [mem 0xe9100000-0xe93fffff]pci 0000:00:1c.4: bridge window [mem 0xe8200000-0xe84fffff 64bit pref]pci 0000:3f:00.0: [14e4:167b] type 00 class 0x020000pci 0000:3f:00.0: reg 0x10: [mem 0xe8a00000-0xe8a0ffff 64bit]pci 0000:3f:00.0: PME# supported from D3hot D3coldpci 0000:00:1c.5: PCI bridge to [bus 3f]pci 0000:00:1c.5: bridge window [mem 0xe8800000-0xe8afffff]pci 0000:00:1e.0: PCI bridge to [bus 05] (subtractive decode)pci 0000:00:1e.0: bridge window [mem 0xf4000000-0xfebfffff] (subtractive decode)pci 0000:00:1e.0: bridge window [io 0x0000-0x0cf7] (subtractive decode)pci 0000:00:1e.0: bridge window [io 0x1000-0x2fff] (subtractive decode)pci 0000:00:1e.0: bridge window [io 0x3000-0x6fff] (subtractive decode)pci 0000:00:1e.0: bridge window [io 0x7000-0xafff] (subtractive decode)pci 0000:00:1e.0: bridge window [io 0xb000-0xffff] (subtractive decode)pci 0000:00:1e.0: bridge window [mem 0x000a0000-0x000bffff] (subtractive decode)pci 0000:00:1e.0: bridge window [mem 0xc0000000-0xefffffff] (subtractive decode)pci_bus 0000:00: on NUMA node 0ACPI: PCI Interrupt Link [LNKA] (IRQs 3 4 5 6 7 10 *11 14 15)ACPI: PCI Interrupt Link [LNKB] (IRQs 3 4 5 6 7 *10 11 14 15)ACPI: PCI Interrupt Link [LNKC] (IRQs 3 4 5 6 7 *10 11 14 15)ACPI: PCI Interrupt Link [LNKD] (IRQs 3 4 *5 6 7 10 11 14 15)ACPI: PCI Interrupt Link [LNKE] (IRQs 3 4 5 6 7 *10 11 14 15)ACPI: PCI Interrupt Link [LNKF] (IRQs 3 4 *5 6 7 10 11 14 15)ACPI: PCI Interrupt Link [LNKG] (IRQs 3 4 5 6 7 10 *11 14 15)ACPI: PCI Interrupt Link [LNKH] (IRQs 3 4 5 6 7 10 11 14 15) *0, disabled.vgaarb: setting as boot device: PCI:0000:01:00.0vgaarb: device added: PCI:0000:01:00.0,decodes=io+mem,owns=io+mem,locks=nonevgaarb: loadedvgaarb: bridge control possible 0000:01:00.0SCSI subsystem initializedlibata version 3.00 loaded.PCI: Using ACPI for IRQ routingPCI: pci_cache_line_size set to 64 bytese820: reserve RAM buffer [mem 0x0009fc00-0x0009ffff]e820: reserve RAM buffer [mem 0xbffc6300-0xbfffffff]HPET: 3 timers in total, 0 timers will be used for per-cpu timerhpet0: at MMIO 0xfed00000, IRQs 2, 8, 0hpet0: 3 comparators, 64-bit 14.318180 MHz counterSwitched to clocksource hpetpnp: PnP ACPI initpnp 00:00: Plug and Play ACPI device, IDs PNP0b00 (active)pnp 00:01: Plug and Play ACPI device, IDs PNP0f13 PNP0f0e (active)pnp 00:02: Plug and Play ACPI device, IDs PNP0303 (active)pnp 00:03: [dma 3]pnp 00:03: Plug and Play ACPI device, IDs PNP0401 (active)pnp 00:04: Plug and Play ACPI device, IDs PNP0501 PNP0500 (active)pnp 00:05: [dma 2]pnp 00:05: Plug and Play ACPI device, IDs PNP0700 (active)system 00:06: [io 0x04d0-0x04d1] has been reservedsystem 00:06: Plug and Play ACPI device, IDs PNP0c02 (active)system 00:07: [io 0x4e00-0x4e01] has been reservedsystem 00:07: [io 0x0400-0x048f] has been reservedsystem 00:07: [io 0x0cb0-0x0cbf] has been reservedsystem 00:07: [io 0xf800-0xf87f] could not be reservedsystem 00:07: [io 0xfa00-0xfa3f] has been reservedsystem 00:07: [io 0xfc00-0xfc7f] has been reservedsystem 00:07: [io 0xfc80-0xfcff] has been reservedsystem 00:07: [io 0x0cb0-0x0cbf] has been reservedsystem 00:07: [io 0xfe80-0xfeff] has been reservedsystem 00:07: Plug and Play ACPI device, IDs PNP0c02 (active)system 00:08: [mem 0x00000000-0x0009ffff] could not be reservedsystem 00:08: [mem 0x00100000-0xbfffffff] could not be reservedsystem 00:08: [mem 0x000d4000-0x000fffff] could not be reservedsystem 00:08: [mem 0xfec01000-0xfecfffff] has been reservedsystem 00:08: [mem 0xfed00400-0xfed3ffff] has been reservedsystem 00:08: [mem 0xfed40000-0xffffffff] could not be reservedsystem 00:08: [mem 0xf0000000-0xf3ffffff] has been reservedsystem 00:08: [mem 0x000cd000-0x000e3fff] has been reservedsystem 00:08: Plug and Play ACPI device, IDs PNP0c01 (active)pnp: PnP ACPI: found 9 devicespci 0000:00:1c.5: bridge window [io 0x1000-0x0fff] to [bus 3f] add_size 1000pci 0000:00:1c.5: bridge window [mem 0x00100000-0x000fffff 64bit pref] to [bus 3f] add_size 200000pci 0000:00:1f.0: BAR 7: [io 0xf800-0xf87f] has bogus alignmentpci 0000:00:1c.5: res[9]=[mem 0x00100000-0x000fffff 64bit pref] get_res_add_size add_size 200000pci 0000:00:1c.5: res[7]=[io 0x1000-0x0fff] get_res_add_size add_size 1000pci 0000:00:1c.5: BAR 9: assigned [mem 0xf4000000-0xf41fffff 64bit pref]pci 0000:00:1b.0: BAR 0: assigned [mem 0xf4200000-0xf4203fff 64bit]pci 0000:00:1c.5: BAR 7: assigned [io 0x5000-0x5fff]pci 0000:01:00.0: BAR 6: assigned [mem 0xe8b20000-0xe8b3ffff pref]pci 0000:00:01.0: PCI bridge to [bus 01]pci 0000:00:01.0: bridge window [io 0x3000-0x3fff]pci 0000:00:01.0: bridge window [mem 0xe8b00000-0xe8dfffff]pci 0000:00:01.0: bridge window [mem 0xe0000000-0xe81fffff 64bit pref]pci 0000:10:00.0: BAR 6: assigned [mem 0xe9400000-0xe941ffff pref]pci 0000:00:1c.0: PCI bridge to [bus 10]pci 0000:00:1c.0: bridge window [io 0x2000-0x2fff]pci 0000:00:1c.0: bridge window [mem 0xe9400000-0xe96fffff]pci 0000:00:1c.0: bridge window [mem 0xe8500000-0xe87fffff 64bit pref]pci 0000:28:00.0: BAR 6: assigned [mem 0xe9120000-0xe913ffff pref]pci 0000:00:1c.4: PCI bridge to [bus 28]pci 0000:00:1c.4: bridge window [io 0x1000-0x1fff]pci 0000:00:1c.4: bridge window [mem 0xe9100000-0xe93fffff]pci 0000:00:1c.4: bridge window [mem 0xe8200000-0xe84fffff 64bit pref]pci 0000:00:1c.5: PCI bridge to [bus 3f]pci 0000:00:1c.5: bridge window [io 0x5000-0x5fff]pci 0000:00:1c.5: bridge window [mem 0xe8800000-0xe8afffff]pci 0000:00:1c.5: bridge window [mem 0xf4000000-0xf41fffff 64bit pref]pci 0000:00:1e.0: PCI bridge to [bus 05]pci_bus 0000:00: resource 4 [mem 0xf4000000-0xfebfffff]pci_bus 0000:00: resource 5 [io 0x0000-0x0cf7]pci_bus 0000:00: resource 6 [io 0x1000-0x2fff]pci_bus 0000:00: resource 7 [io 0x3000-0x6fff]pci_bus 0000:00: resource 8 [io 0x7000-0xafff]pci_bus 0000:00: resource 9 [io 0xb000-0xffff]pci_bus 0000:00: resource 10 [mem 0x000a0000-0x000bffff]pci_bus 0000:00: resource 11 [mem 0xc0000000-0xefffffff]pci_bus 0000:01: resource 0 [io 0x3000-0x3fff]pci_bus 0000:01: resource 1 [mem 0xe8b00000-0xe8dfffff]pci_bus 0000:01: resource 2 [mem 0xe0000000-0xe81fffff 64bit pref]pci_bus 0000:10: resource 0 [io 0x2000-0x2fff]pci_bus 0000:10: resource 1 [mem 0xe9400000-0xe96fffff]pci_bus 0000:10: resource 2 [mem 0xe8500000-0xe87fffff 64bit pref]pci_bus 0000:28: resource 0 [io 0x1000-0x1fff]pci_bus 0000:28: resource 1 [mem 0xe9100000-0xe93fffff]pci_bus 0000:28: resource 2 [mem 0xe8200000-0xe84fffff 64bit pref]pci_bus 0000:3f: resource 0 [io 0x5000-0x5fff]pci_bus 0000:3f: resource 1 [mem 0xe8800000-0xe8afffff]pci_bus 0000:3f: resource 2 [mem 0xf4000000-0xf41fffff 64bit pref]pci_bus 0000:05: resource 4 [mem 0xf4000000-0xfebfffff]pci_bus 0000:05: resource 5 [io 0x0000-0x0cf7]pci_bus 0000:05: resource 6 [io 0x1000-0x2fff]pci_bus 0000:05: resource 7 [io 0x3000-0x6fff]pci_bus 0000:05: resource 8 [io 0x7000-0xafff]pci_bus 0000:05: resource 9 [io 0xb000-0xffff]pci_bus 0000:05: resource 10 [mem 0x000a0000-0x000bffff]pci_bus 0000:05: resource 11 [mem 0xc0000000-0xefffffff]NET: Registered protocol family 2TCP established hash table entries: 8192 (order: 3, 32768 bytes)TCP bind hash table entries: 8192 (order: 4, 65536 bytes)TCP: Hash tables configured (established 8192 bind 8192)TCP: reno registeredUDP hash table entries: 512 (order: 2, 16384 bytes)UDP-Lite hash table entries: 512 (order: 2, 16384 bytes)NET: Registered protocol family 1pci 0000:01:00.0: Video device with shadowed ROMPCI: CLS 64 bytes, default 64futex hash table entries: 512 (order: 3, 32768 bytes)SGI XFS with security attributes, no debug enabledmsgmni has been set to 1716bounce: pool size: 64 pagesBlock layer SCSI generic (bsg) driver version 0.4 loaded (major 253)io scheduler noop registeredio scheduler deadline registeredio scheduler cfq registered (default)pcieport 0000:00:01.0: irq 24 for MSI/MSI-Xpcieport 0000:00:1c.0: irq 25 for MSI/MSI-Xpcieport 0000:00:1c.4: irq 26 for MSI/MSI-Xpcieport 0000:00:1c.5: irq 27 for MSI/MSI-Xahci 0000:00:1f.2: version 3.0ahci 0000:00:1f.2: irq 28 for MSI/MSI-Xahci 0000:00:1f.2: AHCI 0001.0100 32 slots 4 ports 3 Gbps 0xf impl SATA modeahci 0000:00:1f.2: flags: 64bit ncq pm led clo pio slum part scsi host0: ahciscsi host1: ahciscsi host2: ahciscsi host3: ahciata1: SATA max UDMA/133 abar m1024@0xe9004400 port 0xe9004500 irq 28ata2: SATA max UDMA/133 abar m1024@0xe9004400 port 0xe9004580 irq 28ata3: SATA max UDMA/133 abar m1024@0xe9004400 port 0xe9004600 irq 28ata4: SATA max UDMA/133 abar m1024@0xe9004400 port 0xe9004680 irq 28i8042: PNP: PS/2 Controller [PNP0303:KBD,PNP0f0e:PS2M] at 0x60,0x64 irq 1,12serio: i8042 KBD port at 0x60,0x64 irq 1serio: i8042 AUX port at 0x60,0x64 irq 12mousedev: PS/2 mouse device common for all miceTCP: cubic registeredInitializing XFRM netlink socketNET: Registered protocol family 17Using IPI Shortcut modedrivers/rtc/hctosys.c: unable to open rtc device (rtc0)ata1: SATA link up 3.0 Gbps (SStatus 123 SControl 300)ata2: SATA link down (SStatus 0 SControl 300)ata1.00: supports DRM functions and may not be fully accessibleata1.00: failed to get NCQ Send/Recv Log Emask 0x1ata1.00: ATA-9: SAMSUNG MZ7TD256HAFV-000L9, DXT02L5Q, max UDMA/133ata1.00: 500118192 sectors, multi 1: LBA48 NCQ (depth 31/32), AAata4: SATA link down (SStatus 0 SControl 300)ata1.00: supports DRM functions and may not be fully accessibleata1.00: failed to get NCQ Send/Recv Log Emask 0x1ata1.00: configured for UDMA/133scsi 0:0:0:0: Direct-Access ATA SAMSUNG MZ7TD256 2L5Q PQ: 0 ANSI: 5ata3: SATA link down (SStatus 0 SControl 300)sd 0:0:0:0: [sda] 500118192 512-byte logical blocks: (256 GB/238 GiB)sd 0:0:0:0: [sda] Write Protect is offsd 0:0:0:0: [sda] Mode Sense: 00 3a 00 00sd 0:0:0:0: [sda] Write cache: enabled, read cache: enabled, doesn't support DPO or FUA sda: sda1 sda2 < sda5 sda6 sda7 sda8 sda9 sda10>sd 0:0:0:0: [sda] Attached SCSI diskXFS (sda1): Mounting V4 FilesystemXFS (sda1): Ending clean mountVFS: Mounted root (xfs filesystem) readonly on device 8:1.devtmpfs: mountedFreeing unused kernel memory: 332K (c135a000 - c13ad000)loop: module loadedudevd[543]: starting version 182rtc_cmos 00:00: RTC can wake from S4rtc_cmos 00:00: rtc core: registered rtc_cmos as rtc0rtc_cmos 00:00: alarms up to one month, y3k, 114 bytes nvram, hpet irqsSerial: 8250/16550 driver, 4 ports, IRQ sharing enabledr8169 Gigabit Ethernet driver 2.3LK-NAPI loadedr8169 0000:10:00.0: can't disable ASPM; OS doesn't have ASPM controlr8169 0000:10:00.0: irq 29 for MSI/MSI-Xr8169 0000:10:00.0 eth0: RTL8168c/8111c at 0xf8130000, 00:e0:4c:68:48:d2, XID 1c4000c0 IRQ 29r8169 0000:10:00.0 eth0: jumbo features [frames: 6128 bytes, tx checksumming: ko]r8169 Gigabit Ethernet driver 2.3LK-NAPI loadedr8169 0000:28:00.0: can't disable ASPM; OS doesn't have ASPM controlr8169 0000:28:00.0: irq 30 for MSI/MSI-Xr8169 0000:28:00.0 eth1: RTL8168c/8111c at 0xf8132000, 00:e0:4c:68:48:2b, XID 1c4000c0 IRQ 30r8169 0000:28:00.0 eth1: jumbo features [frames: 6128 bytes, tx checksumming: ko]ACPI: bus type USB registeredusbcore: registered new interface driver usbfsusbcore: registered new interface driver hubusbcore: registered new device driver usbpps_core: LinuxPPS API ver. 1 registeredpps_core: Software ver. 5.3.6 - Copyright 2005-2007 Rodolfo Giometti <>ehci_hcd: USB 2.0 'Enhanced' Host Controller (EHCI) DriverPTP clock support registereduhci_hcd: USB Universal Host Controller Interface driveruhci_hcd 0000:00:1d.0: UHCI Host Controlleruhci_hcd 0000:00:1d.0: new USB bus registered, assigned bus number 1uhci_hcd 0000:00:1d.0: irq 20, io base 0x00004000hub 1-0:1.0: USB hub foundhub 1-0:1.0: 2 ports detecteduhci_hcd 0000:00:1d.1: UHCI Host Controlleruhci_hcd 0000:00:1d.1: new USB bus registered, assigned bus number 2uhci_hcd 0000:00:1d.1: irq 18, io base 0x00004020hub 2-0:1.0: USB hub foundhub 2-0:1.0: 2 ports detecteduhci_hcd 0000:00:1d.2: UHCI Host Controlleruhci_hcd 0000:00:1d.2: new USB bus registered, assigned bus number 3uhci_hcd 0000:00:1d.2: irq 21, io base 0x00004040hub 3-0:1.0: USB hub foundhub 3-0:1.0: 2 ports detecteduhci_hcd 0000:00:1d.3: UHCI Host Controlleruhci_hcd 0000:00:1d.3: new USB bus registered, assigned bus number 4uhci_hcd 0000:00:1d.3: irq 22, io base 0x00004060hub 4-0:1.0: USB hub foundtg3.c:v3.137 (May 11, 2014)hub 4-0:1.0: 2 ports detectedserial 00:04: ttyS0 at I/O 0x3f8 (irq = 4, base_baud = 115200) is a 16550Aehci-pci: EHCI PCI platform driverehci-pci 0000:00:1d.7: EHCI Host Controllerehci-pci 0000:00:1d.7: new USB bus registered, assigned bus number 5ehci-pci 0000:00:1d.7: debug port 1ehci-pci 0000:00:1d.7: cache line size of 64 is not supportedehci-pci 0000:00:1d.7: irq 20, io mem 0xe9004000tg3 0000:3f:00.0 eth2: Tigon3 [partno(BCM95755) rev a002] (PCI Express) MAC address 00:1a:4b:44:37:50tg3 0000:3f:00.0 eth2: attached PHY is 5755 (10/100/1000Base-T Ethernet) (WireSpeed[1], EEE[0])tg3 0000:3f:00.0 eth2: RXcsums[1] LinkChgREG[0] MIirq[0] ASF[0] TSOcap[1]tg3 0000:3f:00.0 eth2: dma_rwctrl[76180000] dma_mask[64-bit]ehci-pci 0000:00:1d.7: USB 2.0 started, EHCI 1.00hub 5-0:1.0: USB hub foundhub 5-0:1.0: 8 ports detectedhub 1-0:1.0: USB hub foundhub 1-0:1.0: 2 ports detectedhub 2-0:1.0: USB hub foundhub 2-0:1.0: 2 ports detectedhub 3-0:1.0: USB hub foundhub 3-0:1.0: 2 ports detectedhub 4-0:1.0: USB hub foundhub 4-0:1.0: 2 ports detectedAdding 9076688k swap on /dev/sda10. Priority:-1 extents:1 across:9076688k SStsc: Refined TSC clocksource calibration: 2400.084 MHzSwitched to clocksource tscXFS (sda5): Mounting V4 FilesystemXFS (sda5): Ending clean mountXFS (sda6): Mounting V4 FilesystemXFS (sda6): Ending clean mountXFS (sda7): Mounting V4 FilesystemXFS (sda7): Ending clean mountXFS (sda8): Mounting V4 FilesystemXFS (sda8): Ending clean mountXFS (sda9): Mounting V4 FilesystemXFS (sda9): Ending clean mountrandom: dd urandom read with 85 bits of entropy availabler8169 0000:10:00.0 eth0: link downr8169 0000:10:00.0 eth0: link downr8169 0000:28:00.0 eth1: link downr8169 0000:28:00.0 eth1: link downtg3 0000:3f:00.0: irq 31 for MSI/MSI-Xip_tables: (C) 2000-2006 Netfilter Core Teamnf_conntrack version 0.5.0 (16384 buckets, 65536 max)tg3 0000:3f:00.0 eth2: Link is up at 100 Mbps, full duplextg3 0000:3f:00.0 eth2: Flow control is off for TX and off for RXr8169 0000:28:00.0 eth1: link upr8169 0000:10:00.0 eth0: link upNET: Registered protocol family 15capability: warning: `squid' uses 32-bit capabilities (legacy support in use)nf_conntrack: automatic helper assignment is deprecated and it will be removed soon. Use the iptables CT target to attach helpers instead.random: nonblocking pool is initializedAnd this is .configCONFIG_X86_32=yCONFIG_X86=yCONFIG_INSTRUCTION_DECODER=yCONFIG_PERF_EVENTS_INTEL_UNCORE=yCONFIG_OUTPUT_FORMAT="elf32-i386"CONFIG_ARCH_DEFCONFIG="arch/x86/configs/i386_defconfig"CONFIG_LOCKDEP_SUPPORT=yCONFIG_STACKTRACE_SUPPORT=yCONFIG_HAVE_LATENCYTOP_SUPPORT=yCONFIG_MMU=yCONFIG_NEED_SG_DMA_LENGTH=yCONFIG_GENERIC_ISA_DMA=yCONFIG_GENERIC_BUG=yCONFIG_GENERIC_HWEIGHT=yCONFIG_ARCH_MAY_HAVE_PC_FDC=yCONFIG_RWSEM_XCHGADD_ALGORITHM=yCONFIG_GENERIC_CALIBRATE_DELAY=yCONFIG_ARCH_HAS_CPU_RELAX=yCONFIG_ARCH_HAS_CACHE_LINE_SIZE=yCONFIG_HAVE_SETUP_PER_CPU_AREA=yCONFIG_NEED_PER_CPU_EMBED_FIRST_CHUNK=yCONFIG_NEED_PER_CPU_PAGE_FIRST_CHUNK=yCONFIG_ARCH_HIBERNATION_POSSIBLE=yCONFIG_ARCH_SUSPEND_POSSIBLE=yCONFIG_ARCH_WANT_HUGE_PMD_SHARE=yCONFIG_ARCH_WANT_GENERAL_HUGETLB=yCONFIG_ARCH_SUPPORTS_OPTIMIZED_INLINING=yCONFIG_ARCH_SUPPORTS_DEBUG_PAGEALLOC=yCONFIG_X86_32_SMP=yCONFIG_X86_HT=yCONFIG_X86_32_LAZY_GS=yCONFIG_ARCH_HWEIGHT_CFLAGS="-fcall-saved-ecx -fcall-saved-edx"CONFIG_ARCH_SUPPORTS_UPROBES=yCONFIG_FIX_EARLYCON_MEM=yCONFIG_DEFCONFIG_LIST="/lib/modules/$UNAME_RELEASE/.config"CONFIG_IRQ_WORK=yCONFIG_BUILDTIME_EXTABLE_SORT=yCONFIG_INIT_ENV_ARG_LIMIT=32CONFIG_CROSS_COMPILE=""CONFIG_LOCALVERSION=""CONFIG_HAVE_KERNEL_GZIP=yCONFIG_HAVE_KERNEL_BZIP2=yCONFIG_HAVE_KERNEL_LZMA=yCONFIG_HAVE_KERNEL_XZ=yCONFIG_HAVE_KERNEL_LZO=yCONFIG_HAVE_KERNEL_LZ4=yCONFIG_KERNEL_GZIP=yCONFIG_DEFAULT_HOSTNAME="(none)"CONFIG_SWAP=yCONFIG_SYSVIPC=yCONFIG_SYSVIPC_SYSCTL=yCONFIG_FHANDLE=yCONFIG_USELIB=yCONFIG_HAVE_ARCH_AUDITSYSCALL=yCONFIG_GENERIC_IRQ_PROBE=yCONFIG_GENERIC_IRQ_SHOW=yCONFIG_GENERIC_IRQ_LEGACY_ALLOC_HWIRQ=yCONFIG_GENERIC_PENDING_IRQ=yCONFIG_IRQ_DOMAIN=yCONFIG_IRQ_FORCED_THREADING=yCONFIG_SPARSE_IRQ=yCONFIG_CLOCKSOURCE_WATCHDOG=yCONFIG_ARCH_CLOCKSOURCE_DATA=yCONFIG_CLOCKSOURCE_VALIDATE_LAST_CYCLE=yCONFIG_GENERIC_TIME_VSYSCALL=yCONFIG_GENERIC_CLOCKEVENTS=yCONFIG_GENERIC_CLOCKEVENTS_BUILD=yCONFIG_GENERIC_CLOCKEVENTS_BROADCAST=yCONFIG_GENERIC_CLOCKEVENTS_MIN_ADJUST=yCONFIG_GENERIC_CMOS_UPDATE=yCONFIG_TICK_ONESHOT=yCONFIG_NO_HZ_COMMON=yCONFIG_NO_HZ_IDLE=yCONFIG_NO_HZ=yCONFIG_HIGH_RES_TIMERS=yCONFIG_TICK_CPU_ACCOUNTING=yCONFIG_BSD_PROCESS_ACCT=yCONFIG_TREE_RCU=yCONFIG_RCU_STALL_COMMON=yCONFIG_RCU_FANOUT=32CONFIG_RCU_FANOUT_LEAF=16CONFIG_LOG_BUF_SHIFT=18CONFIG_LOG_CPU_MAX_BUF_SHIFT=12CONFIG_HAVE_UNSTABLE_SCHED_CLOCK=yCONFIG_NAMESPACES=yCONFIG_UTS_NS=yCONFIG_IPC_NS=yCONFIG_PID_NS=yCONFIG_NET_NS=yCONFIG_CC_OPTIMIZE_FOR_SIZE=yCONFIG_SYSCTL=yCONFIG_ANON_INODES=yCONFIG_HAVE_UID16=yCONFIG_SYSCTL_EXCEPTION_TRACE=yCONFIG_HAVE_PCSPKR_PLATFORM=yCONFIG_BPF=yCONFIG_UID16=yCONFIG_SGETMASK_SYSCALL=yCONFIG_SYSFS_SYSCALL=yCONFIG_KALLSYMS=yCONFIG_PRINTK=yCONFIG_BUG=yCONFIG_ELF_CORE=yCONFIG_PCSPKR_PLATFORM=yCONFIG_BASE_FULL=yCONFIG_FUTEX=yCONFIG_EPOLL=yCONFIG_SIGNALFD=yCONFIG_TIMERFD=yCONFIG_EVENTFD=yCONFIG_SHMEM=yCONFIG_AIO=yCONFIG_ADVISE_SYSCALLS=yCONFIG_PCI_QUIRKS=yCONFIG_HAVE_PERF_EVENTS=yCONFIG_PERF_EVENTS=yCONFIG_VM_EVENT_COUNTERS=yCONFIG_SLUB_DEBUG=yCONFIG_COMPAT_BRK=yCONFIG_SLUB=yCONFIG_SLUB_CPU_PARTIAL=yCONFIG_HAVE_OPROFILE=yCONFIG_OPROFILE_NMI_TIMER=yCONFIG_HAVE_EFFICIENT_UNALIGNED_ACCESS=yCONFIG_ARCH_USE_BUILTIN_BSWAP=yCONFIG_HAVE_IOREMAP_PROT=yCONFIG_HAVE_KPROBES=yCONFIG_HAVE_KRETPROBES=yCONFIG_HAVE_OPTPROBES=yCONFIG_HAVE_KPROBES_ON_FTRACE=yCONFIG_HAVE_ARCH_TRACEHOOK=yCONFIG_HAVE_DMA_ATTRS=yCONFIG_HAVE_DMA_CONTIGUOUS=yCONFIG_GENERIC_SMP_IDLE_THREAD=yCONFIG_HAVE_REGS_AND_STACK_ACCESS_API=yCONFIG_HAVE_DMA_API_DEBUG=yCONFIG_HAVE_HW_BREAKPOINT=yCONFIG_HAVE_MIXED_BREAKPOINTS_REGS=yCONFIG_HAVE_USER_RETURN_NOTIFIER=yCONFIG_HAVE_PERF_EVENTS_NMI=yCONFIG_HAVE_PERF_REGS=yCONFIG_HAVE_PERF_USER_STACK_DUMP=yCONFIG_HAVE_ARCH_JUMP_LABEL=yCONFIG_ARCH_HAVE_NMI_SAFE_CMPXCHG=yCONFIG_HAVE_ALIGNED_STRUCT_PAGE=yCONFIG_HAVE_CMPXCHG_LOCAL=yCONFIG_HAVE_CMPXCHG_DOUBLE=yCONFIG_ARCH_WANT_IPC_PARSE_VERSION=yCONFIG_HAVE_ARCH_SECCOMP_FILTER=yCONFIG_SECCOMP_FILTER=yCONFIG_HAVE_CC_STACKPROTECTOR=yCONFIG_CC_STACKPROTECTOR_NONE=yCONFIG_HAVE_IRQ_TIME_ACCOUNTING=yCONFIG_HAVE_ARCH_TRANSPARENT_HUGEPAGE=yCONFIG_MODULES_USE_ELF_REL=yCONFIG_CLONE_BACKWARDS=yCONFIG_OLD_SIGSUSPEND3=yCONFIG_OLD_SIGACTION=yCONFIG_HAVE_GENERIC_DMA_COHERENT=yCONFIG_SLABINFO=yCONFIG_RT_MUTEXES=yCONFIG_BASE_SMALL=0CONFIG_MODULES=yCONFIG_MODULE_UNLOAD=yCONFIG_STOP_MACHINE=yCONFIG_BLOCK=yCONFIG_LBDAF=yCONFIG_BLK_DEV_BSG=yCONFIG_PARTITION_ADVANCED=yCONFIG_MSDOS_PARTITION=yCONFIG_IOSCHED_NOOP=yCONFIG_IOSCHED_DEADLINE=yCONFIG_IOSCHED_CFQ=yCONFIG_DEFAULT_CFQ=yCONFIG_DEFAULT_IOSCHED="cfq"CONFIG_INLINE_SPIN_UNLOCK_IRQ=yCONFIG_INLINE_READ_UNLOCK=yCONFIG_INLINE_READ_UNLOCK_IRQ=yCONFIG_INLINE_WRITE_UNLOCK=yCONFIG_INLINE_WRITE_UNLOCK_IRQ=yCONFIG_ARCH_SUPPORTS_ATOMIC_RMW=yCONFIG_MUTEX_SPIN_ON_OWNER=yCONFIG_RWSEM_SPIN_ON_OWNER=yCONFIG_ARCH_USE_QUEUE_RWLOCK=yCONFIG_QUEUE_RWLOCK=yCONFIG_ZONE_DMA=yCONFIG_SMP=yCONFIG_X86_FEATURE_NAMES=yCONFIG_X86_MPPARSE=yCONFIG_IOSF_MBI=mCONFIG_SCHED_OMIT_FRAME_POINTER=yCONFIG_NO_BOOTMEM=yCONFIG_MCORE2=yCONFIG_X86_INTERNODE_CACHE_SHIFT=6CONFIG_X86_L1_CACHE_SHIFT=6CONFIG_X86_INTEL_USERCOPY=yCONFIG_X86_USE_PPRO_CHECKSUM=yCONFIG_X86_TSC=yCONFIG_X86_CMPXCHG64=yCONFIG_X86_CMOV=yCONFIG_X86_MINIMUM_CPU_FAMILY=5CONFIG_X86_DEBUGCTLMSR=yCONFIG_CPU_SUP_INTEL=yCONFIG_CPU_SUP_AMD=yCONFIG_CPU_SUP_CENTAUR=yCONFIG_CPU_SUP_TRANSMETA_32=yCONFIG_HPET_TIMER=yCONFIG_HPET_EMULATE_RTC=yCONFIG_DMI=yCONFIG_NR_CPUS=2CONFIG_SCHED_MC=yCONFIG_PREEMPT_NONE=yCONFIG_X86_LOCAL_APIC=yCONFIG_X86_IO_APIC=yCONFIG_VM86=yCONFIG_X86_16BIT=yCONFIG_X86_ESPFIX32=yCONFIG_HIGHMEM4G=yCONFIG_PAGE_OFFSET=0xC0000000CONFIG_HIGHMEM=yCONFIG_ARCH_FLATMEM_ENABLE=yCONFIG_ARCH_SPARSEMEM_ENABLE=yCONFIG_ARCH_SELECT_MEMORY_MODEL=yCONFIG_ILLEGAL_POINTER_VALUE=0CONFIG_SELECT_MEMORY_MODEL=yCONFIG_FLATMEM_MANUAL=yCONFIG_FLATMEM=yCONFIG_FLAT_NODE_MEM_MAP=yCONFIG_SPARSEMEM_STATIC=yCONFIG_HAVE_MEMBLOCK=yCONFIG_HAVE_MEMBLOCK_NODE_MAP=yCONFIG_ARCH_DISCARD_MEMBLOCK=yCONFIG_PAGEFLAGS_EXTENDED=yCONFIG_SPLIT_PTLOCK_CPUS=4CONFIG_ZONE_DMA_FLAG=1CONFIG_BOUNCE=yCONFIG_VIRT_TO_BUS=yCONFIG_DEFAULT_MMAP_MIN_ADDR=4096CONFIG_GENERIC_EARLY_IOREMAP=yCONFIG_X86_RESERVE_LOW=64CONFIG_MTRR=yCONFIG_X86_PAT=yCONFIG_ARCH_USES_PG_UNCACHED=yCONFIG_ARCH_RANDOM=yCONFIG_X86_SMAP=yCONFIG_SECCOMP=yCONFIG_HZ_1000=yCONFIG_HZ=1000CONFIG_SCHED_HRTICK=yCONFIG_PHYSICAL_START=0x1000000CONFIG_PHYSICAL_ALIGN=0x1000000CONFIG_ARCH_ENABLE_MEMORY_HOTPLUG=yCONFIG_ACPI=yCONFIG_ACPI_LEGACY_TABLES_LOOKUP=yCONFIG_ARCH_MIGHT_HAVE_ACPI_PDC=yCONFIG_ACPI_PROCESSOR=mCONFIG_X86_PM_TIMER=yCONFIG_HAVE_ACPI_APEI=yCONFIG_HAVE_ACPI_APEI_NMI=yCONFIG_CPU_IDLE=yCONFIG_CPU_IDLE_GOV_LADDER=yCONFIG_CPU_IDLE_GOV_MENU=yCONFIG_PCI=yCONFIG_PCI_GOANY=yCONFIG_PCI_BIOS=yCONFIG_PCI_DIRECT=yCONFIG_PCI_MMCONFIG=yCONFIG_PCI_DOMAINS=yCONFIG_PCIEPORTBUS=yCONFIG_PCIEAER=yCONFIG_PCIEASPM=yCONFIG_PCIEASPM_PERFORMANCE=yCONFIG_PCI_MSI=yCONFIG_HT_IRQ=yCONFIG_PCI_LABEL=yCONFIG_ISA_DMA_API=yCONFIG_AMD_NB=yCONFIG_BINFMT_ELF=yCONFIG_ARCH_BINFMT_ELF_RANDOMIZE_PIE=yCONFIG_CORE_DUMP_DEFAULT_ELF_HEADERS=yCONFIG_BINFMT_SCRIPT=yCONFIG_HAVE_AOUT=yCONFIG_COREDUMP=yCONFIG_HAVE_ATOMIC_IOMAP=yCONFIG_PMC_ATOM=yCONFIG_NET=yCONFIG_PACKET=yCONFIG_UNIX=yCONFIG_UNIX_DIAG=yCONFIG_XFRM=yCONFIG_XFRM_ALGO=yCONFIG_XFRM_USER=yCONFIG_XFRM_IPCOMP=mCONFIG_NET_KEY=mCONFIG_INET=yCONFIG_IP_ADVANCED_ROUTER=yCONFIG_IP_MULTIPLE_TABLES=yCONFIG_IP_ROUTE_MULTIPATH=yCONFIG_IP_ROUTE_VERBOSE=yCONFIG_IP_ROUTE_CLASSID=yCONFIG_NET_IPIP=mCONFIG_NET_IPGRE_DEMUX=mCONFIG_NET_IP_TUNNEL=mCONFIG_NET_IPGRE=mCONFIG_SYN_COOKIES=yCONFIG_INET_ESP=mCONFIG_INET_IPCOMP=mCONFIG_INET_XFRM_TUNNEL=mCONFIG_INET_TUNNEL=mCONFIG_INET_XFRM_MODE_TRANSPORT=mCONFIG_INET_XFRM_MODE_TUNNEL=mCONFIG_INET_LRO=yCONFIG_INET_DIAG=yCONFIG_INET_TCP_DIAG=yCONFIG_INET_UDP_DIAG=yCONFIG_TCP_CONG_ADVANCED=yCONFIG_TCP_CONG_CUBIC=yCONFIG_DEFAULT_CUBIC=yCONFIG_DEFAULT_TCP_CONG="cubic"CONFIG_NET_PTP_CLASSIFY=yCONFIG_NETFILTER=yCONFIG_NETFILTER_ADVANCED=yCONFIG_NETFILTER_NETLINK=mCONFIG_NETFILTER_NETLINK_ACCT=mCONFIG_NETFILTER_NETLINK_QUEUE=mCONFIG_NETFILTER_NETLINK_LOG=mCONFIG_NF_CONNTRACK=mCONFIG_NF_LOG_COMMON=mCONFIG_NF_CONNTRACK_MARK=yCONFIG_NF_CT_PROTO_GRE=mCONFIG_NF_CT_PROTO_UDPLITE=mCONFIG_NF_CONNTRACK_FTP=mCONFIG_NF_CONNTRACK_H323=mCONFIG_NF_CONNTRACK_IRC=mCONFIG_NF_CONNTRACK_BROADCAST=mCONFIG_NF_CONNTRACK_NETBIOS_NS=mCONFIG_NF_CONNTRACK_SNMP=mCONFIG_NF_CONNTRACK_PPTP=mCONFIG_NF_CONNTRACK_SIP=mCONFIG_NF_CONNTRACK_TFTP=mCONFIG_NF_CT_NETLINK=mCONFIG_NF_NAT=mCONFIG_NF_NAT_NEEDED=yCONFIG_NF_NAT_PROTO_UDPLITE=mCONFIG_NF_NAT_FTP=mCONFIG_NF_NAT_IRC=mCONFIG_NF_NAT_SIP=mCONFIG_NF_NAT_TFTP=mCONFIG_NETFILTER_XTABLES=mCONFIG_NETFILTER_XT_MARK=mCONFIG_NETFILTER_XT_CONNMARK=mCONFIG_NETFILTER_XT_SET=mCONFIG_NETFILTER_XT_TARGET_CHECKSUM=mCONFIG_NETFILTER_XT_TARGET_CLASSIFY=mCONFIG_NETFILTER_XT_TARGET_CONNMARK=mCONFIG_NETFILTER_XT_TARGET_CT=mCONFIG_NETFILTER_XT_TARGET_DSCP=mCONFIG_NETFILTER_XT_TARGET_HL=mCONFIG_NETFILTER_XT_TARGET_HMARK=mCONFIG_NETFILTER_XT_TARGET_IDLETIMER=mCONFIG_NETFILTER_XT_TARGET_LOG=mCONFIG_NETFILTER_XT_TARGET_MARK=mCONFIG_NETFILTER_XT_NAT=mCONFIG_NETFILTER_XT_TARGET_NETMAP=mCONFIG_NETFILTER_XT_TARGET_NFLOG=mCONFIG_NETFILTER_XT_TARGET_NFQUEUE=mCONFIG_NETFILTER_XT_TARGET_NOTRACK=mCONFIG_NETFILTER_XT_TARGET_RATEEST=mCONFIG_NETFILTER_XT_TARGET_REDIRECT=mCONFIG_NETFILTER_XT_TARGET_TRACE=mCONFIG_NETFILTER_XT_TARGET_TCPMSS=mCONFIG_NETFILTER_XT_MATCH_ADDRTYPE=mCONFIG_NETFILTER_XT_MATCH_CLUSTER=mCONFIG_NETFILTER_XT_MATCH_COMMENT=mCONFIG_NETFILTER_XT_MATCH_CONNBYTES=mCONFIG_NETFILTER_XT_MATCH_CONNLIMIT=mCONFIG_NETFILTER_XT_MATCH_CONNMARK=mCONFIG_NETFILTER_XT_MATCH_CONNTRACK=mCONFIG_NETFILTER_XT_MATCH_CPU=mCONFIG_NETFILTER_XT_MATCH_DCCP=mCONFIG_NETFILTER_XT_MATCH_DEVGROUP=mCONFIG_NETFILTER_XT_MATCH_DSCP=mCONFIG_NETFILTER_XT_MATCH_ECN=mCONFIG_NETFILTER_XT_MATCH_ESP=mCONFIG_NETFILTER_XT_MATCH_HASHLIMIT=mCONFIG_NETFILTER_XT_MATCH_HELPER=mCONFIG_NETFILTER_XT_MATCH_HL=mCONFIG_NETFILTER_XT_MATCH_IPRANGE=mCONFIG_NETFILTER_XT_MATCH_LENGTH=mCONFIG_NETFILTER_XT_MATCH_LIMIT=mCONFIG_NETFILTER_XT_MATCH_MAC=mCONFIG_NETFILTER_XT_MATCH_MARK=mCONFIG_NETFILTER_XT_MATCH_MULTIPORT=mCONFIG_NETFILTER_XT_MATCH_NFACCT=mCONFIG_NETFILTER_XT_MATCH_OSF=mCONFIG_NETFILTER_XT_MATCH_OWNER=mCONFIG_NETFILTER_XT_MATCH_POLICY=mCONFIG_NETFILTER_XT_MATCH_PKTTYPE=mCONFIG_NETFILTER_XT_MATCH_QUOTA=mCONFIG_NETFILTER_XT_MATCH_RATEEST=mCONFIG_NETFILTER_XT_MATCH_REALM=mCONFIG_NETFILTER_XT_MATCH_RECENT=mCONFIG_NETFILTER_XT_MATCH_STATE=mCONFIG_NETFILTER_XT_MATCH_STATISTIC=mCONFIG_NETFILTER_XT_MATCH_STRING=mCONFIG_NETFILTER_XT_MATCH_TCPMSS=mCONFIG_NETFILTER_XT_MATCH_TIME=mCONFIG_NETFILTER_XT_MATCH_U32=mCONFIG_IP_SET=mCONFIG_IP_SET_MAX=256CONFIG_IP_SET_BITMAP_IP=mCONFIG_IP_SET_BITMAP_IPMAC=mCONFIG_IP_SET_BITMAP_PORT=mCONFIG_IP_SET_HASH_IP=mCONFIG_IP_SET_HASH_IPPORT=mCONFIG_IP_SET_HASH_IPPORTIP=mCONFIG_IP_SET_HASH_IPPORTNET=mCONFIG_IP_SET_HASH_NET=mCONFIG_IP_SET_HASH_NETPORT=mCONFIG_IP_SET_HASH_NETIFACE=mCONFIG_IP_SET_LIST_SET=mCONFIG_NF_DEFRAG_IPV4=mCONFIG_NF_CONNTRACK_IPV4=mCONFIG_NF_LOG_IPV4=mCONFIG_NF_REJECT_IPV4=mCONFIG_NF_NAT_IPV4=mCONFIG_NF_NAT_MASQUERADE_IPV4=mCONFIG_NF_NAT_SNMP_BASIC=mCONFIG_NF_NAT_PROTO_GRE=mCONFIG_NF_NAT_PPTP=mCONFIG_NF_NAT_H323=mCONFIG_IP_NF_IPTABLES=mCONFIG_IP_NF_MATCH_AH=mCONFIG_IP_NF_MATCH_ECN=mCONFIG_IP_NF_MATCH_RPFILTER=mCONFIG_IP_NF_MATCH_TTL=mCONFIG_IP_NF_FILTER=mCONFIG_IP_NF_TARGET_REJECT=mCONFIG_IP_NF_NAT=mCONFIG_IP_NF_TARGET_MASQUERADE=mCONFIG_IP_NF_TARGET_NETMAP=mCONFIG_IP_NF_TARGET_REDIRECT=mCONFIG_IP_NF_MANGLE=mCONFIG_IP_NF_TARGET_ECN=mCONFIG_IP_NF_TARGET_TTL=mCONFIG_IP_NF_RAW=mCONFIG_IP_NF_ARPTABLES=mCONFIG_IP_NF_ARPFILTER=mCONFIG_IP_NF_ARP_MANGLE=mCONFIG_HAVE_NET_DSA=yCONFIG_NET_SCHED=yCONFIG_NET_SCH_HTB=mCONFIG_NET_SCH_HFSC=mCONFIG_NET_SCH_PRIO=mCONFIG_NET_SCH_SFB=mCONFIG_NET_SCH_SFQ=mCONFIG_NET_SCH_TBF=mCONFIG_NET_SCH_INGRESS=mCONFIG_NET_CLS=yCONFIG_NET_CLS_FW=mCONFIG_NET_CLS_U32=mCONFIG_CLS_U32_PERF=yCONFIG_CLS_U32_MARK=yCONFIG_NET_CLS_FLOW=mCONFIG_NET_EMATCH=yCONFIG_NET_EMATCH_STACK=32CONFIG_NET_EMATCH_U32=mCONFIG_NET_EMATCH_META=mCONFIG_NET_CLS_ACT=yCONFIG_NET_ACT_POLICE=mCONFIG_NET_ACT_GACT=mCONFIG_GACT_PROB=yCONFIG_NET_ACT_MIRRED=mCONFIG_NET_ACT_IPT=mCONFIG_NET_ACT_NAT=mCONFIG_NET_SCH_FIFO=yCONFIG_RPS=yCONFIG_RFS_ACCEL=yCONFIG_XPS=yCONFIG_NET_RX_BUSY_POLL=yCONFIG_BQL=yCONFIG_NET_FLOW_LIMIT=yCONFIG_FIB_RULES=yCONFIG_UEVENT_HELPER=yCONFIG_UEVENT_HELPER_PATH="/sbin/hotplug"CONFIG_DEVTMPFS=yCONFIG_DEVTMPFS_MOUNT=yCONFIG_STANDALONE=yCONFIG_FW_LOADER=yCONFIG_EXTRA_FIRMWARE=""CONFIG_ALLOW_DEV_COREDUMP=yCONFIG_GENERIC_CPU_AUTOPROBE=yCONFIG_CONNECTOR=yCONFIG_PROC_EVENTS=yCONFIG_ARCH_MIGHT_HAVE_PC_PARPORT=yCONFIG_PNP=yCONFIG_PNPACPI=yCONFIG_BLK_DEV=yCONFIG_BLK_DEV_LOOP=mCONFIG_BLK_DEV_LOOP_MIN_COUNT=8CONFIG_HAVE_IDE=yCONFIG_SCSI_MOD=yCONFIG_SCSI=yCONFIG_SCSI_DMA=yCONFIG_BLK_DEV_SD=yCONFIG_BLK_DEV_SR=mCONFIG_BLK_DEV_SR_VENDOR=yCONFIG_CHR_DEV_SG=mCONFIG_SCSI_SPI_ATTRS=mCONFIG_ATA=yCONFIG_ATA_ACPI=yCONFIG_SATA_PMP=yCONFIG_SATA_AHCI=yCONFIG_SATA_AHCI_PLATFORM=yCONFIG_NETDEVICES=yCONFIG_MII=mCONFIG_NET_CORE=yCONFIG_TUN=mCONFIG_ETHERNET=yCONFIG_NET_VENDOR_BROADCOM=yCONFIG_TIGON3=mCONFIG_NET_VENDOR_REALTEK=yCONFIG_R8169=mCONFIG_PHYLIB=mCONFIG_INPUT=yCONFIG_INPUT_MOUSEDEV=yCONFIG_INPUT_MOUSEDEV_SCREEN_X=1024CONFIG_INPUT_MOUSEDEV_SCREEN_Y=768CONFIG_INPUT_KEYBOARD=yCONFIG_KEYBOARD_ATKBD=yCONFIG_SERIO=yCONFIG_ARCH_MIGHT_HAVE_PC_SERIO=yCONFIG_SERIO_I8042=yCONFIG_SERIO_SERPORT=mCONFIG_SERIO_LIBPS2=yCONFIG_TTY=yCONFIG_VT=yCONFIG_CONSOLE_TRANSLATIONS=yCONFIG_VT_CONSOLE=yCONFIG_HW_CONSOLE=yCONFIG_VT_HW_CONSOLE_BINDING=yCONFIG_UNIX98_PTYS=yCONFIG_SERIAL_8250=mCONFIG_SERIAL_8250_PNP=yCONFIG_SERIAL_8250_PCI=mCONFIG_SERIAL_8250_NR_UARTS=32CONFIG_SERIAL_8250_RUNTIME_UARTS=4CONFIG_SERIAL_8250_EXTENDED=yCONFIG_SERIAL_8250_SHARE_IRQ=yCONFIG_SERIAL_CORE=mCONFIG_HW_RANDOM=yCONFIG_HW_RANDOM_AMD=yCONFIG_NVRAM=mCONFIG_HPET=yCONFIG_DEVPORT=yCONFIG_PPS=mCONFIG_PTP_1588_CLOCK=mCONFIG_ARCH_WANT_OPTIONAL_GPIOLIB=yCONFIG_HWMON=mCONFIG_THERMAL=mCONFIG_THERMAL_HWMON=yCONFIG_THERMAL_DEFAULT_GOV_STEP_WISE=yCONFIG_THERMAL_GOV_STEP_WISE=yCONFIG_SSB_POSSIBLE=yCONFIG_BCMA_POSSIBLE=yCONFIG_VGA_ARB=yCONFIG_VGA_ARB_MAX_GPUS=16CONFIG_VGA_CONSOLE=yCONFIG_VGACON_SOFT_SCROLLBACK=yCONFIG_VGACON_SOFT_SCROLLBACK_SIZE=64CONFIG_DUMMY_CONSOLE=yCONFIG_HID=mCONFIG_HID_GENERIC=mCONFIG_HID_A4TECH=mCONFIG_HID_APPLE=mCONFIG_HID_BELKIN=mCONFIG_HID_CHERRY=mCONFIG_HID_CHICONY=mCONFIG_HID_CYPRESS=mCONFIG_HID_EZKEY=mCONFIG_HID_KENSINGTON=mCONFIG_HID_LOGITECH=mCONFIG_HID_MICROSOFT=mCONFIG_HID_MONTEREY=mCONFIG_USB_HID=mCONFIG_HID_PID=yCONFIG_USB_OHCI_LITTLE_ENDIAN=yCONFIG_USB_SUPPORT=yCONFIG_USB_COMMON=mCONFIG_USB_ARCH_HAS_HCD=yCONFIG_USB=mCONFIG_USB_DEFAULT_PERSIST=yCONFIG_USB_EHCI_HCD=mCONFIG_USB_EHCI_PCI=mCONFIG_USB_OHCI_HCD=mCONFIG_USB_OHCI_HCD_PCI=mCONFIG_USB_UHCI_HCD=mCONFIG_USB_STORAGE=mCONFIG_RTC_LIB=yCONFIG_RTC_CLASS=yCONFIG_RTC_HCTOSYS=yCONFIG_RTC_SYSTOHC=yCONFIG_RTC_HCTOSYS_DEVICE="rtc0"CONFIG_RTC_INTF_SYSFS=yCONFIG_RTC_INTF_PROC=yCONFIG_RTC_INTF_DEV=yCONFIG_RTC_DRV_CMOS=mCONFIG_CLKSRC_I8253=yCONFIG_CLKEVT_I8253=yCONFIG_I8253_LOCK=yCONFIG_CLKBLD_I8253=yCONFIG_RAS=yCONFIG_FIRMWARE_MEMMAP=yCONFIG_DMI_SCAN_MACHINE_NON_EFI_FALLBACK=yCONFIG_DCACHE_WORD_ACCESS=yCONFIG_EXT2_FS=mCONFIG_XFS_FS=yCONFIG_EXPORTFS=yCONFIG_FILE_LOCKING=yCONFIG_FSNOTIFY=yCONFIG_DNOTIFY=yCONFIG_INOTIFY_USER=yCONFIG_ISO9660_FS=mCONFIG_JOLIET=yCONFIG_ZISOFS=yCONFIG_FAT_FS=mCONFIG_MSDOS_FS=mCONFIG_VFAT_FS=mCONFIG_FAT_DEFAULT_CODEPAGE=437CONFIG_FAT_DEFAULT_IOCHARSET="iso8859-1"CONFIG_PROC_FS=yCONFIG_PROC_SYSCTL=yCONFIG_PROC_PAGE_MONITOR=yCONFIG_KERNFS=yCONFIG_SYSFS=yCONFIG_TMPFS=yCONFIG_NLS=yCONFIG_NLS_DEFAULT="utf8"CONFIG_NLS_CODEPAGE_437=mCONFIG_NLS_ASCII=mCONFIG_NLS_ISO8859_1=mCONFIG_NLS_ISO8859_15=mCONFIG_NLS_UTF8=mCONFIG_TRACE_IRQFLAGS_SUPPORT=yCONFIG_MESSAGE_LOGLEVEL_DEFAULT=4CONFIG_FRAME_WARN=2048CONFIG_ARCH_WANT_FRAME_POINTERS=yCONFIG_HAVE_DEBUG_KMEMLEAK=yCONFIG_DEBUG_MEMORY_INIT=yCONFIG_HAVE_DEBUG_STACKOVERFLOW=yCONFIG_HAVE_ARCH_KMEMCHECK=yCONFIG_PANIC_ON_OOPS_VALUE=0CONFIG_PANIC_TIMEOUT=0CONFIG_DEBUG_BUGVERBOSE=yCONFIG_RCU_CPU_STALL_TIMEOUT=60CONFIG_ARCH_HAS_DEBUG_STRICT_USER_COPY_CHECKS=yCONFIG_USER_STACKTRACE_SUPPORT=yCONFIG_HAVE_FUNCTION_TRACER=yCONFIG_HAVE_FUNCTION_GRAPH_TRACER=yCONFIG_HAVE_FUNCTION_GRAPH_FP_TEST=yCONFIG_HAVE_DYNAMIC_FTRACE=yCONFIG_HAVE_DYNAMIC_FTRACE_WITH_REGS=yCONFIG_HAVE_FTRACE_MCOUNT_RECORD=yCONFIG_HAVE_SYSCALL_TRACEPOINTS=yCONFIG_HAVE_C_RECORDMCOUNT=yCONFIG_TRACING_SUPPORT=yCONFIG_HAVE_ARCH_KGDB=yCONFIG_EARLY_PRINTK=yCONFIG_DOUBLEFAULT=yCONFIG_HAVE_MMIOTRACE_SUPPORT=yCONFIG_IO_DELAY_TYPE_0X80=0CONFIG_IO_DELAY_TYPE_0XED=1CONFIG_IO_DELAY_TYPE_UDELAY=2CONFIG_IO_DELAY_TYPE_NONE=3CONFIG_IO_DELAY_0X80=yCONFIG_DEFAULT_IO_DELAY_TYPE=0CONFIG_DEFAULT_SECURITY_DAC=yCONFIG_DEFAULT_SECURITY=""CONFIG_CRYPTO=yCONFIG_CRYPTO_ALGAPI=yCONFIG_CRYPTO_ALGAPI2=yCONFIG_CRYPTO_AEAD=mCONFIG_CRYPTO_AEAD2=yCONFIG_CRYPTO_BLKCIPHER=mCONFIG_CRYPTO_BLKCIPHER2=yCONFIG_CRYPTO_HASH=yCONFIG_CRYPTO_HASH2=yCONFIG_CRYPTO_RNG=mCONFIG_CRYPTO_RNG2=yCONFIG_CRYPTO_PCOMP=mCONFIG_CRYPTO_PCOMP2=yCONFIG_CRYPTO_MANAGER=mCONFIG_CRYPTO_MANAGER2=yCONFIG_CRYPTO_MANAGER_DISABLE_TESTS=yCONFIG_CRYPTO_GF128MUL=mCONFIG_CRYPTO_WORKQUEUE=yCONFIG_CRYPTO_CRYPTD=mCONFIG_CRYPTO_AUTHENC=mCONFIG_CRYPTO_ABLK_HELPER=mCONFIG_CRYPTO_GLUE_HELPER_X86=mCONFIG_CRYPTO_SEQIV=mCONFIG_CRYPTO_CBC=mCONFIG_CRYPTO_CTR=mCONFIG_CRYPTO_CTS=mCONFIG_CRYPTO_ECB=mCONFIG_CRYPTO_LRW=mCONFIG_CRYPTO_PCBC=mCONFIG_CRYPTO_XTS=mCONFIG_CRYPTO_HMAC=mCONFIG_CRYPTO_CRC32C=yCONFIG_CRYPTO_CRC32C_INTEL=mCONFIG_CRYPTO_CRCT10DIF=mCONFIG_CRYPTO_MD5=mCONFIG_CRYPTO_SHA1=mCONFIG_CRYPTO_SHA256=mCONFIG_CRYPTO_SHA512=mCONFIG_CRYPTO_TGR192=mCONFIG_CRYPTO_AES=yCONFIG_CRYPTO_AES_586=mCONFIG_CRYPTO_AES_NI_INTEL=mCONFIG_CRYPTO_BLOWFISH=mCONFIG_CRYPTO_BLOWFISH_COMMON=mCONFIG_CRYPTO_DES=mCONFIG_CRYPTO_SERPENT=mCONFIG_CRYPTO_SERPENT_SSE2_586=mCONFIG_CRYPTO_TWOFISH=mCONFIG_CRYPTO_TWOFISH_COMMON=mCONFIG_CRYPTO_TWOFISH_586=mCONFIG_CRYPTO_DEFLATE=mCONFIG_CRYPTO_ZLIB=mCONFIG_CRYPTO_LZO=mCONFIG_HAVE_KVM=yCONFIG_BITREVERSE=yCONFIG_GENERIC_STRNCPY_FROM_USER=yCONFIG_GENERIC_STRNLEN_USER=yCONFIG_GENERIC_NET_UTILS=yCONFIG_GENERIC_FIND_FIRST_BIT=yCONFIG_GENERIC_PCI_IOMAP=yCONFIG_GENERIC_IOMAP=yCONFIG_GENERIC_IO=yCONFIG_ARCH_HAS_FAST_MULTIPLIER=yCONFIG_CRC_T10DIF=mCONFIG_CRC32=yCONFIG_CRC32_SLICEBY8=yCONFIG_LIBCRC32C=yCONFIG_ZLIB_INFLATE=mCONFIG_ZLIB_DEFLATE=mCONFIG_LZO_COMPRESS=mCONFIG_LZO_DECOMPRESS=mCONFIG_TEXTSEARCH=yCONFIG_TEXTSEARCH_KMP=mCONFIG_TEXTSEARCH_BM=mCONFIG_TEXTSEARCH_FSM=mCONFIG_HAS_IOMEM=yCONFIG_HAS_IOPORT_MAP=yCONFIG_HAS_DMA=yCONFIG_CPU_RMAP=yCONFIG_DQL=yCONFIG_GLOB=yCONFIG_NLATTR=yCONFIG_ARCH_HAS_ATOMIC64_DEC_IF_POSITIVE=yCONFIG_ARCH_HAS_SG_CHAIN=y could you please share vmlinux for this?Well, I'm not running this system anymore. I'm going to close this bugouchh sorry for the spamI'm running this system with linux 4.16I'm not experimenting any problem.Let me know if you need any kind of information.
id=102401	I'm having issues with Linux 4.2 RC5 with the Displayport audio being deeper then normal. Doesn't seem to happen with 4.1.3 with a backported patch from CreatedPatchReverting Commit 7726e72b3d6879ee5fc743a230eb6f5afa12844b Seems to fix my issues.Are you sure that's the right commit? That commit shouldn't have any affect on DP audio. All it does is move the check for monitor audio support from radeon_atom_encoder_mode_set() into radeon_audio_mode_set(). It doesn't change the hw programming at all.Yes, I just double checked. With the commit, the displayport audio is warped.Huh seems to be the EDID detection. Windows/xrandr --verbose seem to get the EDID right but get-edid doesn't.Replacing drm_detect_monitor_audio(radeon_connector_edid(connector)) with true seems to fix the problem.(In reply to Maxqia from)This means the EDID from your monitor claims not to support audio.Createddmesg logIt works with fglrx, also in the dmesg log it says "[drm:drm_detect_monitor_audio] Monitor has basic audio support"Which is when it should output trueCreatedPossible PatchCreatedUpdated PatchAny Updates?I don't see what this patch changes.Looking back with an extra year of programming knowledge, it seems like commit 7726e72b3d6879ee5fc743a230eb6f5afa12844b doesn't do anything except add a drm_detect_monitor_audio to the hdmi audio pathway ..., before that commit only Displayport was checked for audio. Anyways, issue still present.CreatedExplained Patch
id=45711	CreateddmesgHello all,I've been trying to repair WOL with driver via-velocity. It's been broken for me since kernel 2.6.32. Please note that I'm using the same system so test under 2.6.32 and 3.5.0-8.I've attached dmesg to identify the problem.Thanks a lot for your helpBestPlease see various details:uname -aethtool eth0Settings for eth0: Supported ports: [ TP ] Supported link modes: 10baseT/Half 10baseT/Full 100baseT/Half 100baseT/Full 1000baseT/Half 1000baseT/Full Supported pause frame use: No Supports auto-negotiation: Yes Advertised link modes: 10baseT/Half 10baseT/Full 100baseT/Half 100baseT/Full 1000baseT/Half 1000baseT/Full Advertised pause frame use: No Advertised auto-negotiation: Yes Speed: 1000Mb/s Duplex: Full Port: Twisted Pair PHYAD: 0 Transceiver: internal Auto-negotiation: on MDI-X: Unknown Supports Wake-on: puag Wake-on: g Current message level: 0x00000002 (2) probe Link detected: yescat /proc/acpi/wakeup Device S-state Status Sysfs nodeUSB0 S4 *enabled pci:0000:00:10.0USB1 S4 *enabled pci:0000:00:10.1USB2 S4 *enabled pci:0000:00:10.2EHCI S4 *enabled pci:0000:00:10.4SBRG S5 *enabled pci:0000:00:11.0P2PB S5 *enabled pci:0000:00:13.0lspci -k00:00.0 Host bridge: VIA Technologies, Inc. VX855/VX875 Host Bridge: Host Control (rev 03) Subsystem: VIA Technologies, Inc. Device aa1300:00.1 Host bridge: VIA Technologies, Inc. VX855/VX875 Error Reporting Subsystem: VIA Technologies, Inc. VX855/VX875 Error Reporting00:00.2 Host bridge: VIA Technologies, Inc. VX855/VX875 Host Bus Control Subsystem: VIA Technologies, Inc. VX855/VX875 Host Bus Control00:00.3 Host bridge: VIA Technologies, Inc. VX855/VX875 DRAM Bus Control Subsystem: VIA Technologies, Inc. VX855/VX875 DRAM Bus Control00:00.4 Host bridge: VIA Technologies, Inc. VX855/VX875 Power Management Control Subsystem: VIA Technologies, Inc. VX855/VX875 Power Management Control00:00.5 PIC: VIA Technologies, Inc. VX855/VX875 APIC and Central Traffic Control Subsystem: VIA Technologies, Inc. VX855/VX875 APIC and Central Traffic Control00:00.6 Host bridge: VIA Technologies, Inc. VX855/VX875 Scratch Registers00:00.7 Host bridge: VIA Technologies, Inc. VX855/VX875 North-South Module Interface Control Subsystem: VIA Technologies, Inc. VX855/VX875 North-South Module Interface Control00:01.0 VGA compatible controller: VIA Technologies, Inc. VX855/VX875 Chrome 9 HCM Integrated Graphics Subsystem: VIA Technologies, Inc. VX855/VX875 Chrome 9 HCM Integrated Graphics Kernel modules: viafb00:0f.0 IDE interface: VIA Technologies, Inc. VX855/VX875 EIDE Controller Subsystem: VIA Technologies, Inc. Device aa13 Kernel driver in use: pata_via Kernel modules: pata_via00:10.0 USB controller: VIA Technologies, Inc. VT82xxxxx UHCI USB 1.1 Controller (rev a0) Subsystem: VIA Technologies, Inc. Device aa13 Kernel driver in use: uhci_hcd00:10.1 USB controller: VIA Technologies, Inc. VT82xxxxx UHCI USB 1.1 Controller (rev a0) Subsystem: VIA Technologies, Inc. Device aa13 Kernel driver in use: uhci_hcd00:10.2 USB controller: VIA Technologies, Inc. VT82xxxxx UHCI USB 1.1 Controller (rev a0) Subsystem: VIA Technologies, Inc. Device aa13 Kernel driver in use: uhci_hcd00:10.4 USB controller: VIA Technologies, Inc. USB 2.0 (rev 90) Subsystem: VIA Technologies, Inc. Device aa13 Kernel driver in use: ehci_hcd00:11.0 ISA bridge: VIA Technologies, Inc. VX855/VX875 Bus Control and Power Management Subsystem: VIA Technologies, Inc. Device aa13 Kernel modules: i2c-viapro, vx85500:11.7 Host bridge: VIA Technologies, Inc. VX8xx South-North Module Interface Control Subsystem: VIA Technologies, Inc. Device 732300:13.0 PCI bridge: VIA Technologies, Inc. VX855/VX875 PCI to PCI Bridge Kernel modules: shpchp00:14.0 Audio device: VIA Technologies, Inc. VT8237A/VT8251 HDA Controller (rev 20) Subsystem: VIA Technologies, Inc. VT8237A/VT8251 HDA Controller Kernel driver in use: snd_hda_intel Kernel modules: snd-hda-intel01:03.0 Ethernet controller: VIA Technologies, Inc. VT6120/VT6121/VT6122 Gigabit Ethernet Adapter (rev 11) Subsystem: VIA Technologies, Inc. Device 0110 Kernel driver in use: via-velocity Kernel modules: via-velocitylsmodModule Size Used byipt_MASQUERADE 12663 1 xt_state 12514 0 xt_limit 12541 0 nf_nat_ftp 12595 0 nf_conntrack_ftp 13183 1 nf_nat_ftpiptable_mangle 12646 0 iptable_nat 13016 1 nf_nat 24740 3 ipt_MASQUERADE,nf_nat_ftp,iptable_natnf_conntrack_ipv4 14122 3 iptable_nat,nf_natnf_conntrack 66861 7 ipt_MASQUERADE,xt_state,nf_nat_ftp,nf_conntrack_ftp,iptable_nat,nf_nat,nf_conntrack_ipv4nf_defrag_ipv4 12649 1 nf_conntrack_ipv4iptable_filter 12706 0 ip_tables 18106 3 iptable_mangle,iptable_nat,iptable_filterx_tables 21974 7 ipt_MASQUERADE,xt_state,xt_limit,iptable_mangle,iptable_nat,iptable_filter,ip_tablesrmd160 16664 0 crypto_null 12782 0 xfrm_user 31159 2 ah6 12907 0 ah4 12800 0 esp6 12873 0 esp4 12868 0 xfrm4_mode_beet 12497 0 xfrm4_tunnel 12737 0 tunnel4 13076 1 xfrm4_tunnelxfrm4_mode_tunnel 12546 0 xfrm4_mode_transport 12517 0 xfrm6_mode_transport 12517 0 xfrm6_mode_ro 12458 0 xfrm6_mode_beet 12576 0 xfrm6_mode_tunnel 12546 0 via 45426 0 ipcomp 12655 0 drm 231841 1 viaipcomp6 12658 0 xfrm_ipcomp 13282 2 ipcomp,ipcomp6xfrm6_tunnel 13522 1 ipcomp6tunnel6 13078 1 xfrm6_tunnelaf_key 31531 0 xfrm_algo 14915 7 xfrm_user,ah6,ah4,esp6,esp4,xfrm_ipcomp,af_keycamellia_generic 29212 0 cast6 16773 0 cast5 24976 0 deflate 12545 0 zlib_deflate 26622 1 deflatects 12816 0 ctr 13033 0 gcm 18768 0 ccm 17596 0 serpent_sse2_i586 33732 0 lrw 13127 1 serpent_sse2_i586serpent_generic 29612 1 serpent_sse2_i586xts 12752 1 serpent_sse2_i586gf128mul 14503 2 lrw,xtsblowfish_generic 12474 0 blowfish_common 16635 1 blowfish_generictwofish_generic 16579 0 twofish_i586 12755 0 twofish_common 20985 2 twofish_generic,twofish_i586xcbc 12711 0 sha512_generic 16780 0 des_generic 21191 0 geode_aes 13228 0 cryptd 19821 1 serpent_sse2_i586aes_i586 16956 0 vesafb 13517 1 rfcomm 38103 0 bnep 17790 2 bluetooth 189543 10 rfcomm,bnepparport_pc 32114 0 ppdev 12849 0 binfmt_misc 17292 1 snd_hda_codec_via 46188 1 snd_hda_intel 33028 3 snd_hda_codec 112340 2 snd_hda_codec_via,snd_hda_intelsnd_hwdep 13276 1 snd_hda_codecsnd_pcm 81052 2 snd_hda_intel,snd_hda_codecpadlock_sha 13317 0 snd_seq_midi 13132 0 gpio_vx855 12716 0 padlock_aes 12899 0 via_cputemp 13101 0 hwmon_vid 12723 1 via_cputempkvm_intel 127735 0 snd_rawmidi 25425 1 snd_seq_midikvm 365555 1 kvm_intelsnd_seq_midi_event 14475 1 snd_seq_midisnd_seq 51568 2 snd_seq_midi,snd_seq_midi_eventsnd_timer 28931 2 snd_pcm,snd_seqsnd_seq_device 14137 3 snd_seq_midi,snd_rawmidi,snd_seqsnd 62520 15 snd_hda_codec_via,snd_hda_intel,snd_hda_codec,snd_hwdep,snd_pcm,snd_rawmidi,snd_seq,snd_timer,snd_seq_devicepsmouse 77485 0 i2c_viapro 12969 0 serio_raw 13031 0 soundcore 14635 1 sndvx855 12663 0 shpchp 32325 0 snd_page_alloc 14108 2 snd_hda_intel,snd_pcmmac_hid 13077 0 lp 17455 0 parport 40930 3 parport_pc,ppdev,lpvia_velocity 37619 0 crc_ccitt 12595 1 via_velocitypata_via 13428 3 cat /proc/interrupts CPU0 0: 52 IO-APIC-edge timer 1: 3 IO-APIC-edge i8042 8: 1 IO-APIC-edge rtc0 9: 0 IO-APIC-fasteoi acpi 12: 4 IO-APIC-edge i8042 14: 15952 IO-APIC-edge pata_via 16: 2332 IO-APIC-fasteoi eth0 20: 0 IO-APIC-fasteoi uhci_hcd:usb2 21: 0 IO-APIC-fasteoi uhci_hcd:usb4 22: 0 IO-APIC-fasteoi uhci_hcd:usb3 23: 0 IO-APIC-fasteoi ehci_hcd:usb1 40: 842 PCI-MSI-edge snd_hda_intelNMI: 0 Non-maskable interruptsLOC: 130500 Local timer interruptsSPU: 0 Spurious interruptsPMI: 0 Performance monitoring interruptsIWI: 0 IRQ work interruptsRTR: 0 APIC ICR read retriesRES: 0 Rescheduling interruptsCAL: 0 Function call interruptsTLB: 0 TLB shootdownsTRM: 0 Thermal event interruptsTHR: 0 Threshold APIC interruptsMCE: 0 Machine check exceptionsMCP: 5 Machine check pollsERR: 0MIS: 0 Forgot uname -aLinux srvguigui 3.5.0-8-generic #8-Ubuntu SMP Sat Aug 4 06:50:06 UTC 2012 i686 i686 i386 GNU/LinuxAlso, you'll notice that I tried to force the card to respond to magic packets by adding in /etc/modprobe.d/options via_velocity wol_opts=0*** This bug has been marked as a duplicate of***oops wrongAfter much research, it seems that the last commit concerning WOL actually broke something : commit 2ffa007eaa01cf5fedd6a71f7d43854339a831eeAuthor: françois romieu <romieu@xxxxxxxxxxxxx>Date: Thu Jan 20 04:59:33 2011 +0000The last version of kernel where I can get WOL to work is 2.6.38 (right before that commit).That commit was related to this discussion :Thanks a lot for your help.
id=189551	I had found that SATA SSD have huge difference when connected to onboard motherboard SATA or SAS HBA.All filesystems are ext4:Case 1. SSD #1 connected to motherboard AHCI-SATA (non SAS HBA)using default mount optionThe IOPS is very low and the fsync response time is in the range of 5000 usec/opsCase 2. SSD #1 connected to motherboard AHCI-SATA (non SAS HBA)turn off barrier in the mount optionThe IOPS is high and the fsync response time is in the range of 160 usecs/opsCase 3. SSD #1 connected to Megaraid RAID adapter configured as HBAusing default mount optionThe IOPS is high and the fsync response time is in the range of 400 usecs/opsCase 4. SSD #1 connected to Megaraid RAID adapter configured as HBAturn off barrier in the mount optionThe IOPS is very high and the fsync response time is in the range of 60 usecs/opsCase 5. PCI-e adapter based SSD (AHCI), normal mount optionThe IOPS is low and the fsync response time is in the range of 3000 usecs/opsCase 6. PCI-e adapter based SSD (AHCI), turned off barrier in mount optionThe IOPS is very high and the fsync response time is in the range of 50 usecs/opsSo the findings shows:I) For AHCI-SSD, when using the default mount option (barrier is on), the latency is very high.II) When barrier is on, it does not have huge performance impact when the SATA SSD is connected to SAS HBA.Any comments and ideas are welcome. If you turn off barriers, iops of course goes higher. You're trading off filesystem integrity on power loss for higher performance. The megaraid adapter most likely has some sort of battery / persistent memory backup for its write buffer allowing it to complete flushes faster.So, I'm not sure what the bug is here. Closing as invalid for now. Please feel free to reopen if there's something which is actually broken.For Megaraid, I had configured the port used for SATA SSD to be JBOD.There is battery backup installed on the controller. But as far as I know the battery write-back cache is not enabled for JBOD.FYR:the storcli returned this result:Support JBOD Write cache = No(In reply to Tejun Heo from)Please Refer toI think there are other people having similar problemI would reopen this case for one more time onlyIf it seems normal, please kindly close the case
id=44021	[1.] One line summary of the problem:Internal SD card reader is not working on Dell XPS 17 L502X [2.] Full description of the problem/report:Inserting a SD card into the internal card reader is not recognized on my Dell XPS 17 L502X, unless the computer boots with the SD card inserted. An alternative workaround is presented below. Possible duplicate of this bug (which is for the Dell XPS L701X):[3.] Keywords (i.e., modules, networking, kernel):kernel, SD card reader[4.] Kernel version (from /proc/version):Linux version 3.5.0-030500rc4-generic (apw@gomeisa) (gcc version 4.6.3 (Ubuntu/Linaro 4.6.3-1ubuntu5) ) #201206241635 SMP Sun Jun 24 20:36:03 UTC 2012Also does not work on mainstream Ubuntu kernels (e.g. 3.2.0-25.40 3.2.0-26.41)[5.] Output of Oops.. message (if applicable) with symbolic information resolved (see Documentation/oops-tracing.txt)N/A[6.] A small shell script or example program which triggers the problem (if possible)N/A[7.] EnvironmentUnity/Ubuntu[7.1.] Software (add the output of the ver_linux script here)$ sh /usr/src/linux-headers-3.5.0-030500rc4/scripts/ver_linuxIf some fields are empty or look unusual you may have an old version.Compare to the current minimal requirements in Documentation/Changes. Linux lee-XPS-17 3.5.0-030500rc4-generic #201206241635 SMP Sun Jun 24 20:36:03 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux Gnu C 4.6Gnu make 3.81binutils 2.22util-linux 2.20.1mount supportmodule-init-tools 3.16e2fsprogs 1.42pcmciautils 018Linux C Library 2.15Dynamic linker (ldd) 2.15Procps 3.2.8Net-tools 1.60Kbd 1.15.2Sh-utils 8.13wireless-tools 30Modules Loaded nls_iso8859_1 nls_cp437 vfat fat mmc_block sdhci_pci jmb38x_ms memstick sdhci bnep bbswitch rfcomm parport_pc ppdev binfmt_misc dm_crypt snd_hda_codec_hdmi snd_hda_codec_realtek xt_hl ip6t_rt nf_conntrack_ipv6 nf_defrag_ipv6 ipt_REJECT xt_LOG xt_multiport xt_limit xt_tcpudp joydev arc4 xt_addrtype iwlwifi snd_hda_intel snd_hda_codec xt_state snd_hwdep ip6table_filter snd_pcm ip6_tables snd_seq_midi nf_conntrack_netbios_ns nf_conntrack_broadcast snd_rawmidi snd_seq_midi_event nf_nat_ftp nf_nat nf_conntrack_ipv4 nf_defrag_ipv4 snd_seq nf_conntrack_ftp nf_conntrack coretemp kvm_intel kvm snd_timer snd_seq_device iptable_filter snd ip_tables soundcore x_tables lpc_ich btusb bluetooth dell_laptop dcdbas mac80211 snd_page_alloc cfg80211 hid_generic uvcvideo videobuf2_core videodev dell_wmi videobuf2_vmalloc videobuf2_memops psmouse mei sparse_keymap serio_raw microcode mac_hid wmi lp parport hid_apple ghash_clmulni_intel aesni_intel cryptd aes_x86_64 r8169 usbhid hid i915 drm_kms_helper drm i2c_algo_bit video[7.2.] Processor information (from /proc/cpuinfo):$ cat /proc/cpuinfoprocessor : 0vendor_id : GenuineIntelcpu family : 6model : 42model name : Intel(R) Core(TM) i7-2760QM CPU @ 2.40GHzstepping : 7microcode : 0x23cpu MHz : 800.000cache size : 6144 KBphysical id : 0siblings : 8core id : 0cpu cores : 4apicid : 0initial apicid : 0fpu : yesfpu_exception : yescpuid level : 13wp : yesflags : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp lm constant_tsc arch_perfmon pebs bts nopl xtopology nonstop_tsc aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 cx16 xtpr pdcm pcid sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx lahf_lm ida arat epb xsaveopt pln pts dts tpr_shadow vnmi flexpriority ept vpidbogomips : 4789.18clflush size : 64cache_alignment : 64address sizes : 36 bits physical, 48 bits virtualpower management:processor : 1vendor_id : GenuineIntelcpu family : 6model : 42model name : Intel(R) Core(TM) i7-2760QM CPU @ 2.40GHzstepping : 7microcode : 0x23cpu MHz : 800.000cache size : 6144 KBphysical id : 0siblings : 8core id : 0cpu cores : 4apicid : 1initial apicid : 1fpu : yesfpu_exception : yescpuid level : 13wp : yesflags : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp lm constant_tsc arch_perfmon pebs bts nopl xtopology nonstop_tsc aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 cx16 xtpr pdcm pcid sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx lahf_lm ida arat epb xsaveopt pln pts dts tpr_shadow vnmi flexpriority ept vpidbogomips : 4789.18clflush size : 64cache_alignment : 64address sizes : 36 bits physical, 48 bits virtualpower management:processor : 2vendor_id : GenuineIntelcpu family : 6model : 42model name : Intel(R) Core(TM) i7-2760QM CPU @ 2.40GHzstepping : 7microcode : 0x23cpu MHz : 800.000cache size : 6144 KBphysical id : 0siblings : 8core id : 1cpu cores : 4apicid : 2initial apicid : 2fpu : yesfpu_exception : yescpuid level : 13wp : yesflags : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp lm constant_tsc arch_perfmon pebs bts nopl xtopology nonstop_tsc aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 cx16 xtpr pdcm pcid sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx lahf_lm ida arat epb xsaveopt pln pts dts tpr_shadow vnmi flexpriority ept vpidbogomips : 4789.18clflush size : 64cache_alignment : 64address sizes : 36 bits physical, 48 bits virtualpower management:processor : 3vendor_id : GenuineIntelcpu family : 6model : 42model name : Intel(R) Core(TM) i7-2760QM CPU @ 2.40GHzstepping : 7microcode : 0x23cpu MHz : 800.000cache size : 6144 KBphysical id : 0siblings : 8core id : 1cpu cores : 4apicid : 3initial apicid : 3fpu : yesfpu_exception : yescpuid level : 13wp : yesflags : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp lm constant_tsc arch_perfmon pebs bts nopl xtopology nonstop_tsc aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 cx16 xtpr pdcm pcid sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx lahf_lm ida arat epb xsaveopt pln pts dts tpr_shadow vnmi flexpriority ept vpidbogomips : 4789.18clflush size : 64cache_alignment : 64address sizes : 36 bits physical, 48 bits virtualpower management:processor : 4vendor_id : GenuineIntelcpu family : 6model : 42model name : Intel(R) Core(TM) i7-2760QM CPU @ 2.40GHzstepping : 7microcode : 0x23cpu MHz : 800.000cache size : 6144 KBphysical id : 0siblings : 8core id : 2cpu cores : 4apicid : 4initial apicid : 4fpu : yesfpu_exception : yescpuid level : 13wp : yesflags : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp lm constant_tsc arch_perfmon pebs bts nopl xtopology nonstop_tsc aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 cx16 xtpr pdcm pcid sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx lahf_lm ida arat epb xsaveopt pln pts dts tpr_shadow vnmi flexpriority ept vpidbogomips : 4789.18clflush size : 64cache_alignment : 64address sizes : 36 bits physical, 48 bits virtualpower management:processor : 5vendor_id : GenuineIntelcpu family : 6model : 42model name : Intel(R) Core(TM) i7-2760QM CPU @ 2.40GHzstepping : 7microcode : 0x23cpu MHz : 800.000cache size : 6144 KBphysical id : 0siblings : 8core id : 2cpu cores : 4apicid : 5initial apicid : 5fpu : yesfpu_exception : yescpuid level : 13wp : yesflags : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp lm constant_tsc arch_perfmon pebs bts nopl xtopology nonstop_tsc aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 cx16 xtpr pdcm pcid sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx lahf_lm ida arat epb xsaveopt pln pts dts tpr_shadow vnmi flexpriority ept vpidbogomips : 4789.18clflush size : 64cache_alignment : 64address sizes : 36 bits physical, 48 bits virtualpower management:processor : 6vendor_id : GenuineIntelcpu family : 6model : 42model name : Intel(R) Core(TM) i7-2760QM CPU @ 2.40GHzstepping : 7microcode : 0x23cpu MHz : 800.000cache size : 6144 KBphysical id : 0siblings : 8core id : 3cpu cores : 4apicid : 6initial apicid : 6fpu : yesfpu_exception : yescpuid level : 13wp : yesflags : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp lm constant_tsc arch_perfmon pebs bts nopl xtopology nonstop_tsc aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 cx16 xtpr pdcm pcid sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx lahf_lm ida arat epb xsaveopt pln pts dts tpr_shadow vnmi flexpriority ept vpidbogomips : 4789.18clflush size : 64cache_alignment : 64address sizes : 36 bits physical, 48 bits virtualpower management:processor : 7vendor_id : GenuineIntelcpu family : 6model : 42model name : Intel(R) Core(TM) i7-2760QM CPU @ 2.40GHzstepping : 7microcode : 0x23cpu MHz : 800.000cache size : 6144 KBphysical id : 0siblings : 8core id : 3cpu cores : 4apicid : 7initial apicid : 7fpu : yesfpu_exception : yescpuid level : 13wp : yesflags : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp lm constant_tsc arch_perfmon pebs bts nopl xtopology nonstop_tsc aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 cx16 xtpr pdcm pcid sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx lahf_lm ida arat epb xsaveopt pln pts dts tpr_shadow vnmi flexpriority ept vpidbogomips : 4789.18clflush size : 64cache_alignment : 64address sizes : 36 bits physical, 48 bits virtualpower management:[7.3.] Module information (from /proc/modules):$ cat /proc/modulesnls_iso8859_1 12713 0 - Live 0x0000000000000000nls_cp437 16991 0 - Live 0x0000000000000000vfat 17592 0 - Live 0x0000000000000000fat 61525 1 vfat, Live 0x0000000000000000mmc_block 27390 0 - Live 0x0000000000000000sdhci_pci 18748 0 - Live 0x0000000000000000jmb38x_ms 17646 0 - Live 0x0000000000000000memstick 16605 1 jmb38x_ms, Live 0x0000000000000000sdhci 33144 1 sdhci_pci, Live 0x0000000000000000bnep 18239 2 - Live 0x0000000000000000bbswitch 13396 0 - Live 0x0000000000000000 (O)rfcomm 47561 12 - Live 0x0000000000000000parport_pc 32866 0 - Live 0x0000000000000000ppdev 17113 0 - Live 0x0000000000000000binfmt_misc 17540 1 - Live 0x0000000000000000dm_crypt 23125 0 - Live 0x0000000000000000snd_hda_codec_hdmi 32377 1 - Live 0x0000000000000000snd_hda_codec_realtek 75044 1 - Live 0x0000000000000000xt_hl 12521 6 - Live 0x0000000000000000ip6t_rt 12558 3 - Live 0x0000000000000000nf_conntrack_ipv6 14106 7 - Live 0x0000000000000000nf_defrag_ipv6 13368 1 nf_conntrack_ipv6, Live 0x0000000000000000ipt_REJECT 12576 1 - Live 0x0000000000000000xt_LOG 17453 9 - Live 0x0000000000000000xt_multiport 12597 4 - Live 0x0000000000000000xt_limit 12711 12 - Live 0x0000000000000000xt_tcpudp 12603 18 - Live 0x0000000000000000joydev 17693 0 - Live 0x0000000000000000arc4 12529 2 - Live 0x0000000000000000xt_addrtype 12713 4 - Live 0x0000000000000000iwlwifi 399760 0 - Live 0x0000000000000000snd_hda_intel 34116 3 - Live 0x0000000000000000snd_hda_codec 135092 3 snd_hda_codec_hdmi,snd_hda_codec_realtek,snd_hda_intel, Live 0x0000000000000000xt_state 12578 14 - Live 0x0000000000000000snd_hwdep 13668 1 snd_hda_codec, Live 0x0000000000000000ip6table_filter 12815 1 - Live 0x0000000000000000snd_pcm 97435 3 snd_hda_codec_hdmi,snd_hda_intel,snd_hda_codec, Live 0x0000000000000000ip6_tables 27685 2 ip6t_rt,ip6table_filter, Live 0x0000000000000000snd_seq_midi 13324 0 - Live 0x0000000000000000nf_conntrack_netbios_ns 12665 0 - Live 0x0000000000000000nf_conntrack_broadcast 12589 1 nf_conntrack_netbios_ns, Live 0x0000000000000000snd_rawmidi 30749 1 snd_seq_midi, Live 0x0000000000000000snd_seq_midi_event 14899 1 snd_seq_midi, Live 0x0000000000000000nf_nat_ftp 12704 0 - Live 0x0000000000000000nf_nat 25645 1 nf_nat_ftp, Live 0x0000000000000000nf_conntrack_ipv4 14530 9 nf_nat, Live 0x0000000000000000nf_defrag_ipv4 12729 1 nf_conntrack_ipv4, Live 0x0000000000000000snd_seq 61897 2 snd_seq_midi,snd_seq_midi_event, Live 0x0000000000000000nf_conntrack_ftp 13452 1 nf_nat_ftp, Live 0x0000000000000000nf_conntrack 83299 8 nf_conntrack_ipv6,xt_state,nf_conntrack_netbios_ns,nf_conntrack_broadcast,nf_nat_ftp,nf_nat,nf_conntrack_ipv4,nf_conntrack_ftp, Live 0x0000000000000000coretemp 13641 0 - Live 0x0000000000000000kvm_intel 137718 0 - Live 0x0000000000000000kvm 421965 1 kvm_intel, Live 0x0000000000000000snd_timer 29989 2 snd_pcm,snd_seq, Live 0x0000000000000000snd_seq_device 14497 3 snd_seq_midi,snd_rawmidi,snd_seq, Live 0x0000000000000000iptable_filter 12810 1 - Live 0x0000000000000000snd 83487 16 snd_hda_codec_hdmi,snd_hda_codec_realtek,snd_hda_intel,snd_hda_codec,snd_hwdep,snd_pcm,snd_rawmidi,snd_seq,snd_timer,snd_seq_device, Live 0x0000000000000000ip_tables 27473 1 iptable_filter, Live 0x0000000000000000soundcore 15091 1 snd, Live 0x0000000000000000x_tables 29846 13 xt_hl,ip6t_rt,ipt_REJECT,xt_LOG,xt_multiport,xt_limit,xt_tcpudp,xt_addrtype,xt_state,ip6table_filter,ip6_tables,iptable_filter,ip_tables, Live 0x0000000000000000lpc_ich 17144 0 - Live 0x0000000000000000btusb 18291 0 - Live 0x0000000000000000bluetooth 211654 24 bnep,rfcomm,btusb, Live 0x0000000000000000dell_laptop 17425 0 - Live 0x0000000000000000dcdbas 14490 1 dell_laptop, Live 0x0000000000000000mac80211 555109 1 iwlwifi, Live 0x0000000000000000snd_page_alloc 18572 2 snd_hda_intel,snd_pcm, Live 0x0000000000000000cfg80211 208161 2 iwlwifi,mac80211, Live 0x0000000000000000hid_generic 12493 0 - Live 0x0000000000000000uvcvideo 78170 0 - Live 0x0000000000000000videobuf2_core 33024 1 uvcvideo, Live 0x0000000000000000videodev 125125 2 uvcvideo,videobuf2_core, Live 0x0000000000000000dell_wmi 12681 0 - Live 0x0000000000000000videobuf2_vmalloc 12860 1 uvcvideo, Live 0x0000000000000000videobuf2_memops 13368 1 videobuf2_vmalloc, Live 0x0000000000000000psmouse 92312 0 - Live 0x0000000000000000mei 41423 0 - Live 0x0000000000000000sparse_keymap 13890 1 dell_wmi, Live 0x0000000000000000serio_raw 13215 0 - Live 0x0000000000000000microcode 23029 0 - Live 0x0000000000000000mac_hid 13253 0 - Live 0x0000000000000000wmi 19256 1 dell_wmi, Live 0x0000000000000000lp 17799 0 - Live 0x0000000000000000parport 46562 3 parport_pc,ppdev,lp, Live 0x0000000000000000hid_apple 13375 0 - Live 0x0000000000000000ghash_clmulni_intel 13180 0 - Live 0x0000000000000000aesni_intel 51133 2 - Live 0x0000000000000000cryptd 20530 2 ghash_clmulni_intel,aesni_intel, Live 0x0000000000000000aes_x86_64 17208 1 aesni_intel, Live 0x0000000000000000r8169 62799 0 - Live 0x0000000000000000usbhid 47219 0 - Live 0x0000000000000000hid 100579 3 hid_generic,hid_apple,usbhid, Live 0x0000000000000000i915 525899 3 - Live 0x0000000000000000drm_kms_helper 46931 1 i915, Live 0x0000000000000000drm 277056 4 i915,drm_kms_helper, Live 0x0000000000000000i2c_algo_bit 13564 1 i915, Live 0x0000000000000000video 19412 1 i915, Live 0x0000000000000000[7.4.] Loaded driver and hardware information (/proc/ioports, /proc/iomem)$ cat /proc/ioports0000-0cf7 : PCI Bus 0000:00 0000-001f : dma1 0020-0021 : pic1 0040-0043 : timer0 0050-0053 : timer1 0060-0060 : keyboard 0062-0062 : EC data 0064-0064 : keyboard 0066-0066 : EC cmd 0070-0077 : rtc0 0080-008f : dma page reg 00a0-00a1 : pic2 00c0-00df : dma2 00f0-00ff : fpu 0400-0453 : pnp 00:04 0400-0403 : ACPI PM1a_EVT_BLK 0404-0405 : ACPI PM1a_CNT_BLK 0408-040b : ACPI PM_TMR 0410-0415 : ACPI CPU throttle 0420-042f : ACPI GPE0_BLK 0450-0450 : ACPI PM2_CNT_BLK 0454-0457 : pnp 00:06 0458-047f : pnp 00:04 0500-057f : pnp 00:04 0680-069f : pnp 00:040cf8-0cff : PCI conf10d00-ffff : PCI Bus 0000:00 1000-1003 : pnp 00:04 1004-1013 : pnp 00:04 164e-164f : pnp 00:04 2000-2fff : PCI Bus 0000:0a 2000-20ff : 0000:0a:00.0 2000-20ff : r8169 3000-3fff : PCI Bus 0000:05 4000-4fff : PCI Bus 0000:01 4000-407f : 0000:01:00.0 5000-503f : 0000:00:02.0 5060-507f : 0000:00:1f.2 5060-507f : ahci 5080-5087 : 0000:00:1f.2 5080-5087 : ahci 5088-508f : 0000:00:1f.2 5088-508f : ahci 5090-5093 : 0000:00:1f.2 5090-5093 : ahci 5094-5097 : 0000:00:1f.2 5094-5097 : ahci efa0-efbf : 0000:00:1f.3 ffff-ffff : pnp 00:04$ cat /proc/iomem00000000-0000ffff : reserved00010000-0009d7ff : System RAM0009d800-0009ffff : reserved000a0000-000bffff : PCI Bus 0000:00000c0000-000cefff : Video ROM000e0000-000fffff : reserved 000f0000-000fffff : System ROM00100000-bac8efff : System RAM 01000000-01697e8a : Kernel code 01697e8b-01cda7bf : Kernel data 01dcd000-01f2efff : Kernel bssbac8f000-bade1fff : reservedbade2000-bade9fff : ACPI Non-volatile Storagebadea000-baf1efff : reservedbaf1f000-baf9efff : ACPI Non-volatile Storagebaf9f000-baffefff : ACPI Tablesbafff000-baffffff : System RAMbb000000-bf9fffff : reservedbfa00000-feafffff : PCI Bus 0000:00 c0000000-d3ffffff : PCI Bus 0000:01 c0000000-cfffffff : 0000:01:00.0 d0000000-d3ffffff : 0000:01:00.0 e0000000-efffffff : 0000:00:02.0 f0000000-f20fffff : PCI Bus 0000:01 f0000000-f1ffffff : 0000:01:00.0 f2000000-f207ffff : 0000:01:00.0 f2400000-f27fffff : 0000:00:02.0 f2800000-f2ffffff : PCI Bus 0000:05 f3000000-f30fffff : PCI Bus 0000:0a f3000000-f3003fff : 0000:0a:00.0 f3000000-f3003fff : r8169 f3004000-f3004fff : 0000:0a:00.0 f3004000-f3004fff : r8169 f3100000-f39fffff : PCI Bus 0000:05 f3100000-f31000ff : 0000:05:00.0 f3100000-f31000ff : mmc0 f3100100-f31001ff : 0000:05:00.2 f3100200-f31002ff : 0000:05:00.3 f3100200-f31002ff : jmb38x_ms f3100300-f31003ff : 0000:05:00.4 f3a00000-f3afffff : PCI Bus 0000:04 f3a00000-f3a01fff : 0000:04:00.0 f3a00000-f3a01fff : xhci_hcd f3b00000-f3bfffff : PCI Bus 0000:03 f3b00000-f3b01fff : 0000:03:00.0 f3b00000-f3b01fff : iwlwifi f3c00000-f3c03fff : 0000:00:1b.0 f3c00000-f3c03fff : ICH HD audio f3c04000-f3c040ff : 0000:00:1f.3 f3c05000-f3c0500f : 0000:00:16.0 f3c05000-f3c0500f : mei f3c08000-f3c087ff : 0000:00:1f.2 f3c08000-f3c087ff : ahci f3c09000-f3c093ff : 0000:00:1d.0 f3c09000-f3c093ff : ehci_hcd f3c0a000-f3c0a3ff : 0000:00:1a.0 f3c0a000-f3c0a3ff : ehci_hcd f8000000-fbffffff : PCI MMCONFIG 0000 [bus 00-3f] f8000000-fbffffff : reserved f8000000-fbffffff : pnp 00:09fec00000-fec00fff : reserved fec00000-fec003ff : IOAPIC 0fed00000-fed003ff : HPET 0fed08000-fed08fff : reservedfed10000-fed19fff : reserved fed10000-fed17fff : pnp 00:09 fed18000-fed18fff : pnp 00:09 fed19000-fed19fff : pnp 00:09fed1c000-fed1ffff : reserved fed1c000-fed1ffff : pnp 00:09fed20000-fed3ffff : pnp 00:09fed40000-fed44fff : PCI Bus 0000:00fed45000-fed8ffff : pnp 00:09fed90000-fed93fff : pnp 00:09fee00000-fee00fff : Local APIC fee00000-fee00fff : reservedffd80000-ffffffff : reserved100000000-23e9fefff : System RAM23e9ff000-23fdfffff : reserved23fe00000-23fffffff : RAM buffer[7.5.] PCI information ('lspci -vvv' as root)$ sudo lspci -vvv00:00.0 Host bridge: Intel Corporation 2nd Generation Core Processor Family DRAM Controller (rev 09) Subsystem: Dell Device 0571 Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B+ ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort+ >SERR- <PERR- INTx- Latency: 0 Capabilities: [e0] Vendor Specific Information: Len=0c <?> Kernel driver in use: agpgart-intel00:01.0 PCI bridge: Intel Corporation Xeon E3-1200/2nd Generation Core Processor Family PCI Express Root Port (rev 09) (prog-if 00 [Normal decode]) Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx+ Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Bus: primary=00, secondary=01, subordinate=01, sec-latency=0 I/O behind bridge: 00004000-00004fff Memory behind bridge: f0000000-f20fffff Prefetchable memory behind bridge: 00000000c0000000-00000000d3ffffff Secondary status: 66MHz- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- <SERR- <PERR- BridgeCtl: Parity- SERR- NoISA- VGA- MAbort- >Reset- FastB2B- PriDiscTmr- SecDiscTmr- DiscTmrStat- DiscTmrSERREn- Capabilities: [88] Subsystem: Intel Corporation Device 2010 Capabilities: [80] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [90] MSI: Enable+ Count=1/1 Maskable- 64bit- Address: fee00318 Data: 0000 Capabilities: [a0] Express (v2) Root Port (Slot+), MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s <64ns, L1 <1us ExtTag- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop- MaxPayload 128 bytes, MaxReadReq 128 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend- LnkCap: Port #2, Speed 5GT/s, Width x16, ASPM L0s L1, Latency L0 <1us, L1 <4us ClockPM- Surprise- LLActRep- BwNot+ LnkCtl: ASPM Disabled; RCB 64 bytes Disabled+ Retrain- CommClk- ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 5GT/s, Width x16, TrErr- Train- SlotClk+ DLActive- BWMgmt+ ABWMgmt- SltCap: AttnBtn- PwrCtrl- MRL- AttnInd- PwrInd- HotPlug- Surprise- Slot #1, PowerLimit 75.000W; Interlock- NoCompl+ SltCtl: Enable: AttnBtn- PwrFlt- MRL- PresDet- CmdCplt- HPIrq- LinkChg- Control: AttnInd Unknown, PwrInd Unknown, Power- Interlock- SltSta: Status: AttnBtn- PowerFlt- MRL- CmdCplt- PresDet+ Interlock- Changed: MRL- PresDet+ LinkState- RootCtl: ErrCorrectable- ErrNon-Fatal- ErrFatal- PMEIntEna- CRSVisible- RootCap: CRSVisible- RootSta: PME ReqID 0000, PMEStatus- PMEPending- DevCap2: Completion Timeout: Not Supported, TimeoutDis- ARIFwd- DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis- ARIFwd- LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis-, Selectable De-emphasis: -6dB Transmit Margin: Normal Operating Range, EnterModifiedCompliance+ ComplianceSOS- Compliance De-emphasis: -3.5dB LnkSta2: Current De-emphasis Level: -6dB Capabilities: [100 v1] Virtual Channel Caps: LPEVC=0 RefClk=100ns PATEntryBits=1 Arb: Fixed- WRR32- WRR64- WRR128- Ctrl: ArbSelect=Fixed Status: InProgress- VC0: Caps: PATOffset=00 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed+ WRR32- WRR64- WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=Fixed TC/VC=ff Status: NegoPending- InProgress- Capabilities: [140 v1] Root Complex Link Desc: PortNumber=02 ComponentID=01 EltType=Config Link0: Desc: TargetPort=00 TargetComponent=01 AssocRCRB- LinkType=MemMapped LinkValid+ Addr: 00000000fed19000 Kernel driver in use: pcieport Kernel modules: shpchp00:02.0 VGA compatible controller: Intel Corporation 2nd Generation Core Processor Family Integrated Graphics Controller (rev 09) (prog-if 00 [VGA controller]) Subsystem: Dell Device 0571 Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx+ Status: Cap+ 66MHz- UDF- FastB2B+ ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Latency: 0 Interrupt: pin A routed to IRQ 53 Region 0: Memory at f2400000 (64-bit, non-prefetchable) [size=4M] Region 2: Memory at e0000000 (64-bit, prefetchable) [size=256M] Region 4: I/O ports at 5000 [size=64] Expansion ROM at <unassigned> [disabled] Capabilities: [90] MSI: Enable+ Count=1/1 Maskable- 64bit- Address: fee00018 Data: 0000 Capabilities: [d0] Power Management version 2 Flags: PMEClk- DSI+ D1- D2- AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-) Status: D0 NoSoftRst- PME-Enable- DSel=0 DScale=0 PME- Capabilities: [a4] PCI Advanced Features AFCap: TP+ FLR+ AFCtrl: FLR- AFStatus: TP- Kernel driver in use: i915 Kernel modules: i91500:16.0 Communication controller: Intel Corporation 6 Series/C200 Series Chipset Family MEI Controller #1 (rev 04) Subsystem: Dell Device 0571 Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx+ Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Latency: 0 Interrupt: pin A routed to IRQ 54 Region 0: Memory at f3c05000 (64-bit, non-prefetchable) [size=16] Capabilities: [50] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [8c] MSI: Enable+ Count=1/1 Maskable- 64bit+ Address: 00000000fee00378 Data: 0000 Kernel driver in use: mei Kernel modules: mei00:1a.0 USB controller: Intel Corporation 6 Series/C200 Series Chipset Family USB Enhanced Host Controller #2 (rev 05) (prog-if 20 [EHCI]) Subsystem: Dell Device 0571 Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Latency: 0 Interrupt: pin A routed to IRQ 16 Region 0: Memory at f3c0a000 (32-bit, non-prefetchable) [size=1K] Capabilities: [50] Power Management version 2 Flags: PMEClk- DSI- D1- D2- AuxCurrent=375mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst- PME-Enable- DSel=0 DScale=0 PME- Capabilities: [58] Debug port: BAR=1 offset=00a0 Capabilities: [98] PCI Advanced Features AFCap: TP+ FLR+ AFCtrl: FLR- AFStatus: TP- Kernel driver in use: ehci_hcd00:1b.0 Audio device: Intel Corporation 6 Series/C200 Series Chipset Family High Definition Audio Controller (rev 05) Subsystem: Dell Device 0571 Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx+ Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Interrupt: pin A routed to IRQ 55 Region 0: Memory at f3c00000 (64-bit, non-prefetchable) [size=16K] Capabilities: [50] Power Management version 2 Flags: PMEClk- DSI- D1- D2- AuxCurrent=55mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst- PME-Enable- DSel=0 DScale=0 PME- Capabilities: [60] MSI: Enable+ Count=1/1 Maskable- 64bit+ Address: 00000000fee003b8 Data: 0000 Capabilities: [70] Express (v1) Root Complex Integrated Endpoint, MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s <64ns, L1 <1us ExtTag- RBE- FLReset+ DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop- MaxPayload 128 bytes, MaxReadReq 128 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr+ TransPend- LnkCap: Port #0, Speed unknown, Width x0, ASPM unknown, Latency L0 <64ns, L1 <1us ClockPM- Surprise- LLActRep- BwNot- LnkCtl: ASPM Disabled; Disabled- Retrain- CommClk- ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed unknown, Width x0, TrErr- Train- SlotClk- DLActive- BWMgmt- ABWMgmt- Capabilities: [100 v1] Virtual Channel Caps: LPEVC=0 RefClk=100ns PATEntryBits=1 Arb: Fixed- WRR32- WRR64- WRR128- Ctrl: ArbSelect=Fixed Status: InProgress- VC0: Caps: PATOffset=00 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed- WRR32- WRR64- WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=Fixed TC/VC=01 Status: NegoPending- InProgress- VC1: Caps: PATOffset=00 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed- WRR32- WRR64- WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=1 ArbSelect=Fixed TC/VC=22 Status: NegoPending- InProgress- Capabilities: [130 v1] Root Complex Link Desc: PortNumber=0f ComponentID=00 EltType=Config Link0: Desc: TargetPort=00 TargetComponent=00 AssocRCRB- LinkType=MemMapped LinkValid+ Addr: 00000000fed1c000 Kernel driver in use: snd_hda_intel Kernel modules: snd-hda-intel00:1c.0 PCI bridge: Intel Corporation 6 Series/C200 Series Chipset Family PCI Express Root Port 1 (rev b5) (prog-if 00 [Normal decode]) Control: I/O- Mem- BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Bus: primary=00, secondary=02, subordinate=02, sec-latency=0 I/O behind bridge: 0000f000-00000fff Memory behind bridge: fff00000-000fffff Prefetchable memory behind bridge: 00000000fff00000-00000000000fffff Secondary status: 66MHz- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort+ <SERR- <PERR- BridgeCtl: Parity- SERR- NoISA- VGA- MAbort- >Reset- FastB2B- PriDiscTmr- SecDiscTmr- DiscTmrStat- DiscTmrSERREn- Capabilities: [40] Express (v2) Root Port (Slot+), MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s <64ns, L1 <1us ExtTag- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop- MaxPayload 128 bytes, MaxReadReq 128 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr+ TransPend- LnkCap: Port #1, Speed 5GT/s, Width x1, ASPM L0s L1, Latency L0 <1us, L1 <16us ClockPM- Surprise- LLActRep+ BwNot- LnkCtl: ASPM L1 Enabled; RCB 64 bytes Disabled- Retrain- CommClk- ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x0, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt- SltCap: AttnBtn- PwrCtrl- MRL- AttnInd- PwrInd- HotPlug- Surprise- Slot #0, PowerLimit 10.000W; Interlock- NoCompl+ SltCtl: Enable: AttnBtn- PwrFlt- MRL- PresDet- CmdCplt- HPIrq- LinkChg- Control: AttnInd Unknown, PwrInd Unknown, Power- Interlock- SltSta: Status: AttnBtn- PowerFlt- MRL- CmdCplt- PresDet- Interlock- Changed: MRL- PresDet- LinkState- RootCtl: ErrCorrectable- ErrNon-Fatal- ErrFatal- PMEIntEna- CRSVisible- RootCap: CRSVisible- RootSta: PME ReqID 0000, PMEStatus- PMEPending- DevCap2: Completion Timeout: Range BC, TimeoutDis+ ARIFwd- DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis- ARIFwd- LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis-, Selectable De-emphasis: -6dB Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -3.5dB Capabilities: [80] MSI: Enable- Count=1/1 Maskable- 64bit- Address: 00000000 Data: 0000 Capabilities: [90] Subsystem: Dell Device 0571 Capabilities: [a0] Power Management version 2 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst- PME-Enable- DSel=0 DScale=0 PME- Kernel driver in use: pcieport Kernel modules: shpchp00:1c.1 PCI bridge: Intel Corporation 6 Series/C200 Series Chipset Family PCI Express Root Port 2 (rev b5) (prog-if 00 [Normal decode]) Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Bus: primary=00, secondary=03, subordinate=03, sec-latency=0 I/O behind bridge: 0000f000-00000fff Memory behind bridge: f3b00000-f3bfffff Prefetchable memory behind bridge: 00000000fff00000-00000000000fffff Secondary status: 66MHz- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort+ <SERR- <PERR- BridgeCtl: Parity- SERR- NoISA- VGA- MAbort- >Reset- FastB2B- PriDiscTmr- SecDiscTmr- DiscTmrStat- DiscTmrSERREn- Capabilities: [40] Express (v2) Root Port (Slot+), MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s <64ns, L1 <1us ExtTag- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop- MaxPayload 128 bytes, MaxReadReq 128 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr+ TransPend- LnkCap: Port #2, Speed 5GT/s, Width x1, ASPM L0s L1, Latency L0 <512ns, L1 <16us ClockPM- Surprise- LLActRep+ BwNot- LnkCtl: ASPM L1 Enabled; RCB 64 bytes Disabled- Retrain- CommClk+ ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x1, TrErr- Train- SlotClk+ DLActive+ BWMgmt+ ABWMgmt- SltCap: AttnBtn- PwrCtrl- MRL- AttnInd- PwrInd- HotPlug- Surprise- Slot #1, PowerLimit 10.000W; Interlock- NoCompl+ SltCtl: Enable: AttnBtn- PwrFlt- MRL- PresDet- CmdCplt- HPIrq- LinkChg- Control: AttnInd Unknown, PwrInd Unknown, Power- Interlock- SltSta: Status: AttnBtn- PowerFlt- MRL- CmdCplt- PresDet+ Interlock- Changed: MRL- PresDet- LinkState+ RootCtl: ErrCorrectable- ErrNon-Fatal- ErrFatal- PMEIntEna- CRSVisible- RootCap: CRSVisible- RootSta: PME ReqID 0000, PMEStatus- PMEPending- DevCap2: Completion Timeout: Range BC, TimeoutDis+ ARIFwd- DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis- ARIFwd- LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis-, Selectable De-emphasis: -6dB Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -3.5dB Capabilities: [80] MSI: Enable- Count=1/1 Maskable- 64bit- Address: 00000000 Data: 0000 Capabilities: [90] Subsystem: Dell Device 0571 Capabilities: [a0] Power Management version 2 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst- PME-Enable- DSel=0 DScale=0 PME- Kernel driver in use: pcieport Kernel modules: shpchp00:1c.3 PCI bridge: Intel Corporation 6 Series/C200 Series Chipset Family PCI Express Root Port 4 (rev b5) (prog-if 00 [Normal decode]) Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Bus: primary=00, secondary=04, subordinate=04, sec-latency=0 I/O behind bridge: 0000f000-00000fff Memory behind bridge: f3a00000-f3afffff Prefetchable memory behind bridge: 00000000fff00000-00000000000fffff Secondary status: 66MHz- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort+ <SERR- <PERR- BridgeCtl: Parity- SERR- NoISA- VGA- MAbort- >Reset- FastB2B- PriDiscTmr- SecDiscTmr- DiscTmrStat- DiscTmrSERREn- Capabilities: [40] Express (v2) Root Port (Slot+), MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s <64ns, L1 <1us ExtTag- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop- MaxPayload 128 bytes, MaxReadReq 128 bytes DevSta: CorrErr+ UncorrErr- FatalErr- UnsuppReq- AuxPwr+ TransPend- LnkCap: Port #4, Speed 5GT/s, Width x1, ASPM L0s L1, Latency L0 <512ns, L1 <16us ClockPM- Surprise- LLActRep+ BwNot- LnkCtl: ASPM L1 Enabled; RCB 64 bytes Disabled- Retrain- CommClk+ ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 5GT/s, Width x1, TrErr- Train- SlotClk+ DLActive+ BWMgmt+ ABWMgmt- SltCap: AttnBtn- PwrCtrl- MRL- AttnInd- PwrInd- HotPlug- Surprise- Slot #3, PowerLimit 10.000W; Interlock- NoCompl+ SltCtl: Enable: AttnBtn- PwrFlt- MRL- PresDet- CmdCplt- HPIrq- LinkChg- Control: AttnInd Unknown, PwrInd Unknown, Power- Interlock- SltSta: Status: AttnBtn- PowerFlt- MRL- CmdCplt- PresDet+ Interlock- Changed: MRL- PresDet- LinkState+ RootCtl: ErrCorrectable- ErrNon-Fatal- ErrFatal- PMEIntEna- CRSVisible- RootCap: CRSVisible- RootSta: PME ReqID 0000, PMEStatus- PMEPending- DevCap2: Completion Timeout: Range BC, TimeoutDis+ ARIFwd- DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis- ARIFwd- LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis-, Selectable De-emphasis: -6dB Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -6dB Capabilities: [80] MSI: Enable- Count=1/1 Maskable- 64bit- Address: 00000000 Data: 0000 Capabilities: [90] Subsystem: Dell Device 0571 Capabilities: [a0] Power Management version 2 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst- PME-Enable- DSel=0 DScale=0 PME- Kernel driver in use: pcieport Kernel modules: shpchp00:1c.4 PCI bridge: Intel Corporation 6 Series/C200 Series Chipset Family PCI Express Root Port 5 (rev b5) (prog-if 00 [Normal decode]) Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Bus: primary=00, secondary=05, subordinate=09, sec-latency=0 I/O behind bridge: 00003000-00003fff Memory behind bridge: f3100000-f39fffff Prefetchable memory behind bridge: 00000000f2800000-00000000f2ffffff Secondary status: 66MHz- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort+ <SERR- <PERR- BridgeCtl: Parity- SERR- NoISA- VGA- MAbort- >Reset- FastB2B- PriDiscTmr- SecDiscTmr- DiscTmrStat- DiscTmrSERREn- Capabilities: [40] Express (v2) Root Port (Slot+), MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s <64ns, L1 <1us ExtTag- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop- MaxPayload 128 bytes, MaxReadReq 128 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr+ TransPend- LnkCap: Port #5, Speed 5GT/s, Width x1, ASPM L0s L1, Latency L0 <512ns, L1 <16us ClockPM- Surprise- LLActRep+ BwNot- LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- Retrain- CommClk+ ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x1, TrErr- Train- SlotClk+ DLActive+ BWMgmt+ ABWMgmt- SltCap: AttnBtn- PwrCtrl- MRL- AttnInd- PwrInd- HotPlug+ Surprise+ Slot #4, PowerLimit 10.000W; Interlock- NoCompl+ SltCtl: Enable: AttnBtn- PwrFlt- MRL- PresDet+ CmdCplt- HPIrq- LinkChg- Control: AttnInd Unknown, PwrInd Unknown, Power- Interlock- SltSta: Status: AttnBtn- PowerFlt- MRL- CmdCplt- PresDet+ Interlock- Changed: MRL- PresDet- LinkState+ RootCtl: ErrCorrectable- ErrNon-Fatal- ErrFatal- PMEIntEna- CRSVisible- RootCap: CRSVisible- RootSta: PME ReqID 0000, PMEStatus- PMEPending- DevCap2: Completion Timeout: Range BC, TimeoutDis+ ARIFwd- DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis- ARIFwd- LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis-, Selectable De-emphasis: -6dB Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -3.5dB Capabilities: [80] MSI: Enable- Count=1/1 Maskable- 64bit- Address: 00000000 Data: 0000 Capabilities: [90] Subsystem: Dell Device 0571 Capabilities: [a0] Power Management version 2 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst- PME-Enable- DSel=0 DScale=0 PME- Kernel driver in use: pcieport Kernel modules: shpchp00:1c.5 PCI bridge: Intel Corporation 6 Series/C200 Series Chipset Family PCI Express Root Port 6 (rev b5) (prog-if 00 [Normal decode]) Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Bus: primary=00, secondary=0a, subordinate=0a, sec-latency=0 I/O behind bridge: 00002000-00002fff Memory behind bridge: fff00000-000fffff Prefetchable memory behind bridge: 00000000f3000000-00000000f30fffff Secondary status: 66MHz- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- <SERR- <PERR- BridgeCtl: Parity- SERR- NoISA- VGA- MAbort- >Reset- FastB2B- PriDiscTmr- SecDiscTmr- DiscTmrStat- DiscTmrSERREn- Capabilities: [40] Express (v2) Root Port (Slot+), MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s <64ns, L1 <1us ExtTag- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop- MaxPayload 128 bytes, MaxReadReq 128 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr+ TransPend- LnkCap: Port #6, Speed 5GT/s, Width x1, ASPM L0s L1, Latency L0 <512ns, L1 <16us ClockPM- Surprise- LLActRep+ BwNot- LnkCtl: ASPM L1 Enabled; RCB 64 bytes Disabled- Retrain- CommClk+ ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x1, TrErr- Train- SlotClk+ DLActive+ BWMgmt+ ABWMgmt- SltCap: AttnBtn- PwrCtrl- MRL- AttnInd- PwrInd- HotPlug- Surprise- Slot #5, PowerLimit 10.000W; Interlock- NoCompl+ SltCtl: Enable: AttnBtn- PwrFlt- MRL- PresDet- CmdCplt- HPIrq- LinkChg- Control: AttnInd Unknown, PwrInd Unknown, Power- Interlock- SltSta: Status: AttnBtn- PowerFlt- MRL- CmdCplt- PresDet+ Interlock- Changed: MRL- PresDet- LinkState+ RootCtl: ErrCorrectable- ErrNon-Fatal- ErrFatal- PMEIntEna- CRSVisible- RootCap: CRSVisible- RootSta: PME ReqID 0000, PMEStatus- PMEPending- DevCap2: Completion Timeout: Range BC, TimeoutDis+ ARIFwd- DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis- ARIFwd- LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis-, Selectable De-emphasis: -6dB Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -3.5dB Capabilities: [80] MSI: Enable- Count=1/1 Maskable- 64bit- Address: 00000000 Data: 0000 Capabilities: [90] Subsystem: Dell Device 0571 Capabilities: [a0] Power Management version 2 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst- PME-Enable- DSel=0 DScale=0 PME- Kernel driver in use: pcieport Kernel modules: shpchp00:1d.0 USB controller: Intel Corporation 6 Series/C200 Series Chipset Family USB Enhanced Host Controller #1 (rev 05) (prog-if 20 [EHCI]) Subsystem: Dell Device 0571 Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Latency: 0 Interrupt: pin A routed to IRQ 23 Region 0: Memory at f3c09000 (32-bit, non-prefetchable) [size=1K] Capabilities: [50] Power Management version 2 Flags: PMEClk- DSI- D1- D2- AuxCurrent=375mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst- PME-Enable- DSel=0 DScale=0 PME- Capabilities: [58] Debug port: BAR=1 offset=00a0 Capabilities: [98] PCI Advanced Features AFCap: TP+ FLR+ AFCtrl: FLR- AFStatus: TP+ Kernel driver in use: ehci_hcd00:1f.0 ISA bridge: Intel Corporation HM67 Express Chipset Family LPC Controller (rev 05) Subsystem: Dell Device 0571 Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Latency: 0 Capabilities: [e0] Vendor Specific Information: Len=0c <?> Kernel modules: lpc_ich00:1f.2 SATA controller: Intel Corporation 6 Series/C200 Series Chipset Family 6 port SATA AHCI Controller (rev 05) (prog-if 01 [AHCI 1.0]) Subsystem: Dell Device 0571 Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx+ Status: Cap+ 66MHz+ UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Latency: 0 Interrupt: pin B routed to IRQ 43 Region 0: I/O ports at 5088 [size=8] Region 1: I/O ports at 5094 [size=4] Region 2: I/O ports at 5080 [size=8] Region 3: I/O ports at 5090 [size=4] Region 4: I/O ports at 5060 [size=32] Region 5: Memory at f3c08000 (32-bit, non-prefetchable) [size=2K] Capabilities: [80] MSI: Enable+ Count=1/1 Maskable- 64bit- Address: fee00338 Data: 0000 Capabilities: [70] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot+,D3cold-) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [a8] SATA HBA v1.0 BAR4 Offset=00000004 Capabilities: [b0] PCI Advanced Features AFCap: TP+ FLR+ AFCtrl: FLR- AFStatus: TP- Kernel driver in use: ahci00:1f.3 SMBus: Intel Corporation 6 Series/C200 Series Chipset Family SMBus Controller (rev 05) Subsystem: Dell Device 0571 Control: I/O+ Mem+ BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap- 66MHz- UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Interrupt: pin C routed to IRQ 10 Region 0: Memory at f3c04000 (64-bit, non-prefetchable) [size=256] Region 4: I/O ports at efa0 [size=32] Kernel modules: i2c-i80101:00.0 VGA compatible controller: NVIDIA Corporation Device 124d (rev ff) (prog-if ff) !!! Unknown header type 7f03:00.0 Network controller: Intel Corporation Centrino Advanced-N 6230 (rev 34) Subsystem: Intel Corporation Centrino Advanced-N 6230 AGN Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Interrupt: pin A routed to IRQ 56 Region 0: Memory at f3b00000 (64-bit, non-prefetchable) [size=8K] Capabilities: [c8] Power Management version 3 Flags: PMEClk- DSI+ D1- D2- AuxCurrent=0mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst- PME-Enable- DSel=0 DScale=0 PME- Capabilities: [d0] MSI: Enable+ Count=1/1 Maskable- 64bit+ Address: 00000000fee003d8 Data: 0000 Capabilities: [e0] Express (v1) Endpoint, MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s <512ns, L1 unlimited ExtTag- AttnBtn- AttnInd- PwrInd- RBE+ FLReset+ DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop+ FLReset- MaxPayload 128 bytes, MaxReadReq 128 bytes DevSta: CorrErr+ UncorrErr- FatalErr- UnsuppReq+ AuxPwr+ TransPend- LnkCap: Port #0, Speed 2.5GT/s, Width x1, ASPM L0s L1, Latency L0 <4us, L1 <32us ClockPM+ Surprise- LLActRep- BwNot- LnkCtl: ASPM L1 Enabled; RCB 64 bytes Disabled- Retrain- CommClk+ ExtSynch- ClockPM+ AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x1, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt- Capabilities: [100 v1] Advanced Error Reporting UESta: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UEMsk: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UESvrt: DLP+ SDES- TLP- FCP+ CmpltTO- CmpltAbrt- UnxCmplt- RxOF+ MalfTLP+ ECRC- UnsupReq- ACSViol- CESta: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+ CEMsk: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+ AERCap: First Error Pointer: 00, GenCap- CGenEn- ChkCap- ChkEn- Capabilities: [140 v1] Device Serial Number 88-53-2e-ff-ff-93-bc-ff Kernel driver in use: iwlwifi Kernel modules: iwlwifi04:00.0 USB controller: NEC Corporation uPD720200 USB 3.0 Host Controller (rev 04) (prog-if 30 [XHCI]) Subsystem: Dell Device 04b8 Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx+ Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Interrupt: pin A routed to IRQ 19 Region 0: Memory at f3a00000 (64-bit, non-prefetchable) [size=8K] Capabilities: [50] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=375mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [70] MSI: Enable- Count=1/8 Maskable- 64bit+ Address: 0000000000000000 Data: 0000 Capabilities: [90] MSI-X: Enable+ Count=8 Masked- Vector table: BAR=0 offset=00001000 PBA: BAR=0 offset=00001080 Capabilities: [a0] Express (v2) Endpoint, MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s unlimited, L1 unlimited ExtTag- AttnBtn- AttnInd- PwrInd- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop+ MaxPayload 128 bytes, MaxReadReq 512 bytes DevSta: CorrErr+ UncorrErr- FatalErr- UnsuppReq+ AuxPwr+ TransPend- LnkCap: Port #0, Speed 5GT/s, Width x1, ASPM L0s L1, Latency L0 <4us, L1 unlimited ClockPM+ Surprise- LLActRep- BwNot- LnkCtl: ASPM L1 Enabled; RCB 64 bytes Disabled- Retrain- CommClk+ ExtSynch- ClockPM+ AutWidDis- BWInt- AutBWInt- LnkSta: Speed 5GT/s, Width x1, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt- DevCap2: Completion Timeout: Not Supported, TimeoutDis+ DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis- LnkCtl2: Target Link Speed: 5GT/s, EnterCompliance- SpeedDis-, Selectable De-emphasis: -6dB Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -6dB Capabilities: [100 v1] Advanced Error Reporting UESta: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UEMsk: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UESvrt: DLP+ SDES+ TLP- FCP+ CmpltTO- CmpltAbrt- UnxCmplt- RxOF+ MalfTLP+ ECRC- UnsupReq- ACSViol- CESta: RxErr- BadTLP+ BadDLLP- Rollover- Timeout+ NonFatalErr+ CEMsk: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+ AERCap: First Error Pointer: 00, GenCap- CGenEn- ChkCap- ChkEn- Capabilities: [140 v1] Device Serial Number ff-ff-ff-ff-ff-ff-ff-ff Capabilities: [150 v1] Latency Tolerance Reporting Max snoop latency: 0ns Max no snoop latency: 0ns Kernel driver in use: xhci_hcd05:00.0 System peripheral: JMicron Technology Corp. SD/MMC Host Controller (rev 30) Subsystem: Dell Device 0571 Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Latency: 0 Interrupt: pin A routed to IRQ 16 Region 0: Memory at f3100000 (32-bit, non-prefetchable) [size=256] Capabilities: [a4] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [80] Express (v1) Endpoint, MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s <64ns, L1 <1us ExtTag- AttnBtn- AttnInd- PwrInd- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop- MaxPayload 128 bytes, MaxReadReq 512 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend- LnkCap: Port #1, Speed 2.5GT/s, Width x1, ASPM L0s L1, Latency L0 unlimited, L1 unlimited ClockPM- Surprise- LLActRep- BwNot- LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- Retrain- CommClk+ ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x1, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt- Capabilities: [94] MSI: Enable- Count=1/1 Maskable- 64bit- Address: fffffffc Data: 0000 Kernel driver in use: sdhci-pci Kernel modules: sdhci-pci05:00.2 SD Host controller: JMicron Technology Corp. Standard SD Host Controller (rev 30) (prog-if 01) Subsystem: Dell Device 0571 Control: I/O- Mem+ BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Interrupt: pin A routed to IRQ 16 Region 0: Memory at f3100100 (32-bit, non-prefetchable) [size=256] Capabilities: [a4] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [80] Express (v1) Endpoint, MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s <64ns, L1 <1us ExtTag- AttnBtn- AttnInd- PwrInd- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop- MaxPayload 128 bytes, MaxReadReq 512 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend- LnkCap: Port #1, Speed 2.5GT/s, Width x1, ASPM L0s L1, Latency L0 unlimited, L1 unlimited ClockPM- Surprise- LLActRep- BwNot- LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- Retrain- CommClk+ ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x1, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt- Capabilities: [94] MSI: Enable- Count=1/1 Maskable- 64bit- Address: fffffffc Data: 0000 Kernel modules: sdhci-pci05:00.3 System peripheral: JMicron Technology Corp. MS Host Controller (rev 30) Subsystem: Dell Device 0571 Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Latency: 0 Interrupt: pin A routed to IRQ 16 Region 0: Memory at f3100200 (32-bit, non-prefetchable) [size=256] Capabilities: [a4] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [80] Express (v1) Endpoint, MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s <64ns, L1 <1us ExtTag- AttnBtn- AttnInd- PwrInd- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop- MaxPayload 128 bytes, MaxReadReq 512 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend- LnkCap: Port #1, Speed 2.5GT/s, Width x1, ASPM L0s L1, Latency L0 unlimited, L1 unlimited ClockPM- Surprise- LLActRep- BwNot- LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- Retrain- CommClk+ ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x1, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt- Capabilities: [94] MSI: Enable- Count=1/1 Maskable- 64bit- Address: fffffffc Data: 0000 Kernel driver in use: jmb38x_ms Kernel modules: jmb38x_ms05:00.4 System peripheral: JMicron Technology Corp. xD Host Controller (rev 30) Subsystem: Dell Device 0571 Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Interrupt: pin A routed to IRQ 255 Region 0: Memory at f3100300 (32-bit, non-prefetchable) [disabled] [size=256] Capabilities: [a4] Power Management version 3 Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [80] Express (v1) Endpoint, MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s <64ns, L1 <1us ExtTag- AttnBtn- AttnInd- PwrInd- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop- MaxPayload 128 bytes, MaxReadReq 512 bytes DevSta: CorrErr- UncorrErr- FatalErr- UnsuppReq- AuxPwr- TransPend- LnkCap: Port #1, Speed 2.5GT/s, Width x1, ASPM L0s L1, Latency L0 unlimited, L1 unlimited ClockPM- Surprise- LLActRep- BwNot- LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- Retrain- CommClk+ ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x1, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt- Capabilities: [94] MSI: Enable- Count=1/1 Maskable- 64bit- Address: fffffffc Data: 00000a:00.0 Ethernet controller: Realtek Semiconductor Co., Ltd. RTL8111/8168B PCI Express Gigabit Ethernet controller (rev 06) Subsystem: Dell Device 0570 Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx+ Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Interrupt: pin A routed to IRQ 52 Region 0: I/O ports at 2000 [size=256] Region 2: Memory at f3004000 (64-bit, prefetchable) [size=4K] Region 4: Memory at f3000000 (64-bit, prefetchable) [size=16K] Capabilities: [40] Power Management version 3 Flags: PMEClk- DSI- D1+ D2+ AuxCurrent=375mA PME(D0+,D1+,D2+,D3hot+,D3cold+) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME- Capabilities: [50] MSI: Enable+ Count=1/1 Maskable- 64bit+ Address: 00000000fee00358 Data: 0000 Capabilities: [70] Express (v2) Endpoint, MSI 01 DevCap: MaxPayload 256 bytes, PhantFunc 0, Latency L0s <512ns, L1 <64us ExtTag- AttnBtn- AttnInd- PwrInd- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd+ ExtTag- PhantFunc- AuxPwr- NoSnoop- MaxPayload 128 bytes, MaxReadReq 4096 bytes DevSta: CorrErr+ UncorrErr- FatalErr- UnsuppReq+ AuxPwr+ TransPend- LnkCap: Port #0, Speed 2.5GT/s, Width x1, ASPM L0s L1, Latency L0 <512ns, L1 <64us ClockPM+ Surprise- LLActRep- BwNot- LnkCtl: ASPM L1 Enabled; RCB 64 bytes Disabled- Retrain- CommClk+ ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x1, TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt- DevCap2: Completion Timeout: Not Supported, TimeoutDis+ DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis- LnkCtl2: Target Link Speed: 2.5GT/s, EnterCompliance- SpeedDis-, Selectable De-emphasis: -6dB Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS- Compliance De-emphasis: -6dB LnkSta2: Current De-emphasis Level: -6dB Capabilities: [b0] MSI-X: Enable- Count=4 Masked- Vector table: BAR=4 offset=00000000 PBA: BAR=4 offset=00000800 Capabilities: [d0] Vital Product Data Unknown small resource type 00, will not decode more. Capabilities: [100 v1] Advanced Error Reporting UESta: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UEMsk: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UESvrt: DLP+ SDES+ TLP- FCP+ CmpltTO- CmpltAbrt- UnxCmplt- RxOF+ MalfTLP+ ECRC- UnsupReq- ACSViol- CESta: RxErr+ BadTLP- BadDLLP+ Rollover- Timeout- NonFatalErr+ CEMsk: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+ AERCap: First Error Pointer: 00, GenCap+ CGenEn- ChkCap+ ChkEn- Capabilities: [140 v1] Virtual Channel Caps: LPEVC=0 RefClk=100ns PATEntryBits=1 Arb: Fixed- WRR32- WRR64- WRR128- Ctrl: ArbSelect=Fixed Status: InProgress- VC0: Caps: PATOffset=00 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed- WRR32- WRR64- WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=Fixed TC/VC=ff Status: NegoPending- InProgress- Capabilities: [160 v1] Device Serial Number 5e-00-00-00-68-4c-e0-00 Kernel driver in use: r8169 Kernel modules: r8169[7.6.] SCSI information (from /proc/scsi/scsi)$ cat /proc/scsi/scsiAttached devices:Host: scsi0 Channel: 00 Id: 00 Lun: 00 Vendor: ATA Model: ST9750420AS Rev: 0002 Type: Direct-Access ANSI SCSI revision: 05Host: scsi1 Channel: 00 Id: 00 Lun: 00 Vendor: ATA Model: ST9750420AS Rev: 0002 Type: Direct-Access ANSI SCSI revision: 05Host: scsi5 Channel: 00 Id: 00 Lun: 00 Vendor: HL-DT-ST Model: DVD+-RW GT50N Rev: A101 Type: CD-ROM ANSI SCSI revision: 05[7.7.] Other information that might be relevant to the problem (please look in /proc and include all information that you think to be relevant):N/A[X.] Other notes, patches, fixes, workarounds:There are 2 workarounds that solve this problem.Workaround (a)Booting the system with the SD card in the SD card reader will lead to a mounted deviceWorkaround (b)Insert the SD card$ sudo su -l# echo 1 > /sys/bus/pci/rescanThis will lead to a mounted device (SD card)Note that after either workaround, you can remove and insert SD cards, which are now always recognised.N.B. all the above logs have been gathered after workaround (b) was implemented. FWIW, I used the SD card reader recently, using the workaround of "echo 1 > /sys/bus/pci/rescan" as root. Then, I noticed a few entries in dmesg similar to this:[36964.574442] mmc0: Reset 0x4 never completed.[36964.584408] mmc0: Controller never released inhibit bit(s).[36964.683601] mmc0: Reset 0x2 never completed.[36964.782781] mmc0: Reset 0x4 never completed.[36964.792752] mmc0: Controller never released inhibit bit(s).[36964.891997] mmc0: Reset 0x2 never completed.[36964.991203] mmc0: Reset 0x4 never completed.[36965.001173] mmc0: Controller never released inhibit bit(s).[36965.100354] mmc0: Reset 0x2 never completed.[36965.199537] mmc0: Reset 0x4 never completed.[36965.209532] mmc0: Controller never released inhibit bit(s).[36965.308750] mmc0: Reset 0x2 never completed.[36965.407971] mmc0: Reset 0x4 never completed.[36965.418103] mmc0: Controller never released inhibit bit(s).[36965.517340] mmc0: Reset 0x2 never completed.[36965.616556] mmc0: Reset 0x4 never completed.[36965.715913] mmc0: Reset 0x1 never completed.Reassigning to PCI because this looks like a pciehp/acpiphp issue.This bug still affects XPS users - I'm one of them, with exactly the same symptons. Is there any news about it? Is any information needed?CheersThanks for chiming in, Ivan. I haven't had a chance to start looking at this, but if it's convenient for you, could you attach two complete dmesg logs: (1) when booting with an SD card already inserted, and (2) when booting with the SD card empty, then inserting an SD card later. I don't know what distro or kernel you're using, but if you can make sure the pciehp driver is linked in statically or loaded before inserting the SD card, that would be great.CreateddmesgCreatedlspci -vvvnn before rescanCreatedlspci -vvvnn after rescanCreated.config fileThis bug still exists in 3.10. Nothing seems to happen when I insert my SD card (at least there is no message in dmesg). After forcing rescan the SD card is detected and works well.I've attached my dmesg, an lspci before and after rescan and the .config file I used to build the kernel.v3.12-rc1 contains many acpiphp updates, as well as fixes to thecode that decides whether to use acpiphp or pciehp. Can you pleaseretest with v3.12-rc1 or later, attach the complete dmesg log,and note whether this issue is resolved?3.12-rc1 fixes the bug for me. I've attached a (working) dmesg logCreatedworking dmesgdmesg of 3.12-rc1I can confirm that 3.12.0-031200rc1-generic fixes it for me too. (Thanks for attaching the dmesg log too, Tobe.)Sparhawk's downstream report:I couldn't find it quickly for reference, nor post into See Also/URL fields at top of bug page, as either not implimented or permissions too restrictive. Sorry for the noise.Thank you Tobe, Sparhawk, and Christopher.Can any of you test several card insertion/removal cycles? This might be the same issue as reported in, and Thomas reported there that the first card insertion worked correctly, but the card was not recognized after being removed and inserted a second time.I'm not going to close this issue until we have confirmation that it works for many insert/remove cycles.I have tries 10 insertion/removal cycles. The card was recognized every time.Createddmesg (multiple cycles)Great! Thanks, Tobe. I'm closing this. If anybody continues to see the problem, please attach a dmesg log and reopen this (or open a new bug if it seems like it might be a different issue).I'm still having the problem on an XPS 15 with modified firmware using EFI instead of BIOS. Will upload before and after lspcis as soon as i reboot.CreateddmesgCreatedlspci -vvvnn before rescanCreatedlspci -vvvnn after rescanHi Maarten, sorry I didn't notice your updates here. Can I trouble you to open a new bugzilla entry with a description of the issue you're seeing? I'm not sure you're seeing the same problem reported in this bug.Please also attach your .config to the new bugzilla. From your dmesg log in, it looks like you might not have CONFIG_HOTPLUG_PCI_PCIE enabled. That log shows that we enumerated the SD card reader at timestamp 240, but it sounds like maybe you had to manually rescan with something like echo 1 > /sys/bus/pci/rescanThat shouldn't be necessary, and if CONFIG_HOTPLUG_PCI_PCIE is enabled, I think the kernel should automatically enumerate new devices. My guess is that your system basically hot-adds the card reader when a card is inserted.Hi Bjorn. CONFIG_HOTPLUG_PCI_PCIE did not resolve the problem. I openeddetailing the case.
id=34772	Createddmesg output right after the lock up, obtained via the networkHi there.I have been getting some Oopses/stack traces when I try to use my iBook G4 (with an "ATI Technologies Inc M11 NV/FireGL Mobility T2e" card) and I enable KMS.The userland here is Debian unstable with the DRM from experimental, but I am willing to test anything that you would like me to.For example, attached is the last of a series of such Oopses that I got when I tried to test if a video was playing or not with mplayer.I tried to use 2.6.39-rc{5,6}, but upon boot I get messages telling me that there were failures and that hardware acceleration will be disabled and I that I get is a desktop with colors distorted like if there were some endianness issues.This is, BTW, part of my attempts to get Linux running well on PowerPC, with some of my logs (with photos) present at my homepage:Please, if there is anything that I can provide to fix this, let me know and I will do my best.Thanks, Rogério Brito. Just for the record, I can provide further messages of these: this is as reproducible as I like.In fact, I am now able to reproduce it with kernel 2.6.38 if I boot the iBook G4 with the options:"video=radeonfb:off radeon.agpmode=-1 radeon.modeset=1"and play a video with mplayer.If, OTOH, I leave off the KMS, then I don't get the GPU lockups that I reported.Anyway, things are *way* better with 2.6.38 than with 2.6.39, as with 2.6.39 the kernel doesn't even get the colors correctly---everything that should be red becomes blue and so forth (any kind of endianness problem?).I am attaching here another stacktrace, in case it helps.Regards,Rogério Brito.CreatedA dmesg log from 2.6.39-rc7 showing problems.CreatedThe log of X with the 2.6.39-rc7 kernelCreatedA dmesg log with 2.6.38 kernelPlease, notice the GPU hang with kernel 2.6.38.CreatedLog from X with the kernel 2.6.38(In reply to)That's probably nothing to do with the kernel directly but endianness bugs in the X driver when acceleration is not available.It would be interesting if you could bisect what broke acceleration with radeon.agpmode=-1. Note that you should boot with radeon.no_wb=1 as well for this, as CP writeback was only fixed during the 2.6.39 cycle (in commit dc66b325f161bb651493c7d96ad44876b629cf6a).I was able to reproduce the acceleration initialization failure with the Debian 2.6.39-rc7-powerpc kernel, but not with a self-built 2.6.39 kernel. So this was probably just an intermittent problem during the 2.6.39 cycle, e.g. due to the intermittent broken usage of the DMA API by TTM.As for the GPU lockups, does radeon.dynclks=1 help for those?radeon.dynclks=1 causes the wrong resolution to be selected. It thinks something is conncted to the S-video port with a max resolution of 800x600, so it selects this instead of the native resolution (1024x768).-<6>Console: switching to colour frame buffer device 128x48+<6>[drm] crtc 1 is connected to a TV+<6>Console: switching to colour frame buffer device 100x37+(II) RADEON(0): Printing probed modes for output S-video+(II) RADEON(0): Modeline "800x600"x59.9 38.25 800 832 912 1024 600 603 607 624 -hsync +vsync (37.4 kHz)+(II) RADEON(0): Modeline "640x480"x59.9 25.18 640 656 752 800 480 490 492 525 -hsync -vsync (31.5 kHz)+(II) RADEON(0): Modeline "320x240"x60.1 12.59 320 328 376 400 240 245 246 262 doublescan -hsync -vsync (31.5 kHz) (II) RADEON(0): Output LVDS connected (II) RADEON(0): Output VGA-0 disconnected-(II) RADEON(0): Output S-video disconnected+(II) RADEON(0): Output S-video connected (II) RADEON(0): Using exact sizes for initial modes-(II) RADEON(0): Output LVDS using initial mode 1024x768+(II) RADEON(0): Output LVDS using initial mode 800x600+(II) RADEON(0): Output S-video using initial mode 800x600Hi, Michel.On Fri, May 20, 2011 at 12:11, <> wrote:>OK, then that's a separate issue. Good to know.Oooh, I guess that I made some mess in your head here, taking intoaccount the other messages of us. To clear things up: When I use2.6.38, it works mostly OK if I use radeon.agpmode=-1. It issufficiently stable to the point that I told you that this setting wasOK. But, in fact, if I play a video with mplayer, then it always (sofar, 100% reproducible) causes those GPU lockups, but the computer isstill accessible via the network, so that I can take the logs etc. If,instead, I use 1 instead of -1, then, even with kernel 2.6.38, I getthose lysergide-like :-) pictures that I put on my homepage (but, fordocumentation purposes, I am thinking of uploading here asattachments, as I am quite short of space there).With kernel 2.6.39, I have not been able to get anything working,whether or not I pass any option to the kernel.Summary:* 2.6.38 with KMS and agpmode=-1: OK, up to me trying to play somevideo, then GPU lockups.* 2.6.38 with KMS and agpmode=1: GPU lockups a few seconds after Xloads (it *does* show up, but locks up a few seconds latter).* 2.6.39 with KMS and agpmode=-1: Not OK, even if I don't use anythingaccelerated (problems with colors and software rendering).So, I am not quite sure if it would be the case of bisecting or, atleast, what would be a good starting point. I can, though, try to bootwith many other kernels to see if I can (provided that udev doesn'tstop me).OK. I can try no_wb=1 with agpmode=-1 and report back in a fewmoments, to see if the lockups are still there or not.Right. Thanks for that fix of yours (just read the commit).Regards,Hi there.On Sat, May 21, 2011 at 09:16, <> wrote:Just for the record, 2.6.38 with KMS + agpmode=-1 + no_wb=1 stilllocks up the GPU when I play a video with mplayer.I will try with 2.6.39 with the same settings.Thanks,Another test.On Sat, May 21, 2011 at 09:23, <> wrote:>Just for the record #2, 2.6.38 with KMS + agpmode=-1 + no_wb=1 +dynclks=1 still locks up the GPU when I play a video with mplayer.Besides that, like Andreas, with dynclks=1 the resolution is reducedto be 800x600. I didn't have the opportunity to read the X logsregarding the S-Video port, but, at least for the user, iBooks(differently from PowerBooks) don't have user-accessible S-Video ports(but this doesn't prevent Apple from having inutilized them somehow).Thanks,On Sat, May 21, 2011 at 09:34, <> wrote:Wooow! Oopsen galore with 2.6.39 with KMS + agpmode=-1 + no_wb=1...Five in a row.OK, probably only the first one matters. Then, it stays there anddoesn't load the system... Actually, as I am writing this thing, afterabout 180 seconds, the boot process is continuing and X is beingloaded, but with the wrong colors (the "endianness issue"). I will tryto see if the network is available and attach here what I get fromdmesg.BTW, I hope that you don't mind me providing copious amounts oftesting here (and their results) in the hope to get this fixed... :-)Createddmesg log with 2.6.39-rc7 with KMS + agpmode=-1 + no_wb=1CreatedX log with 2.6.39-rc7 + KMS + agpmode=-1 + no_wb=1With 2.6.39-rc7 + KMS + agpmode=-1 + no_wb=1 + dynclks=1:* I don't get the Oopsen.* the resolution is restricted to 800x600.* XV is not available to mplayer or other applications.I think the XV extension not working is something that has always happened with 2.6.39 kernels.Thanks,Rogério Brito.(In reply to)When the kernel radeon driver fails to initialize acceleration, there's no point in trying any functionality that needs acceleration, such as XVideo.I don't think there's any point doing any more tests with 2.6.39-rc7, as it's obviously suffering from additional issues which only occurred intermittently during the 2.6.39 cycle.(In reply to)Well, I'm afraid less quantity but more quality would be better... It's becoming rather difficult and time-consuming to find the relevant pieces of information in this mass.(In reply to)Has either of you tried agpmode=1 dynclks=1? Does that increase stability at all?I thought there was some kind of multimedia adapter for the external output.Anyway, it should be possible to override the incorrect output detection, either on the kernel command line with something like video=S-video-1:d or later in xorg.conf or during X runtime with something like xrandr.But really, we need to focus on one problem per bug report as much as possible, or things are getting out of hand.(In reply to)No, there's no point in bisecting, as that problem should be gone with 2.6.39 final.no_wb=1 would only have been important for bisecting, to avoid the writeback endianness bug interfering.P.S. beware of Debian package udev version 169-1: IME an initrd generated with that installed prevents the radeon module from being loaded automatically, and when trying to load it manually, it fails to load the CP microcode and consequently fails to initialize acceleration.Hi, Michel.Thank you very much for the attention.(In reply to)OK.Right.Indeed, it is getting out of hand pretty quickly. Do you want me to give you some SSH access to this notebook? Or, if that's not feasible/useful, what would you like me to test as the next step, so that I avoid flooding you with so much data?I will try those. But with which kernel? I have been avoiding compiling a kernel nowadays, since they take ages on this notebook, but I can set up a cross-compilation environment, if necessary.BTW, would you mind sharing your .config?The only external adapter is one to a VGA port. No traces of S-video here.OK, I can file a separate bug for this S-Video issue, then.Thank you so much for your patience,Rogério Brito.apples sells VGA to s-video adapters, so we list both connectors in the driver.(In reply to)Oh, sorry for the ignorance.CreatedAllow forcing on all GPU clocks(In reply to)2.6.38 should be fine for this test. But at some point it'll probably be useful for you to be able to try kernel patches. Once you've built a kernel, building the radeon module with a patch shouldn't take long.E.g., you guys could try this patch, and booting with radeon.dynclks=0, which should force on all GPU clocks. Does that increase stability with agpmode=1 or agpmode=-1?My .config still takes 1-2 hours to build on this 1.6 GHz PowerBook. If that could help you, please ask for it on the debian-powerpc list.Would also be interesting if one of you guys could attach dmesg with agpmode=1.Just for the record,I can still provide the information, as I am going to reinstall Linux on the iBook.Thanks in advance,Rogério Brito.This bug needs to be tested against a newer kernel to see if it's fixed.Cheers NickHi, Nick.On Jun 25 2014,wrote:OK, I think that this may be easier to test than the previous issue, but, ifI recall correctly, this issue was so fragile that almost anything crashedit.Again, as my other e-mail, please ping me if I don't respond, as I amswamped with work.Thanks,
id=43070	O.S.: Fedora 16Kernel versions: a) 3.1.0-7.fc16.i686.PAE b) kernel-3.3.0-4.fc16lsusb command output related to my bluetooth device: Bus 002 Device 003: ID 1131:1001 Integrated System Solution Corp. KY-BT100 Bluetooth AdapterWhen using bluetooth device to download files from other devices, my PC freeze completely (Gnome and Kde).Error message with kernel 3.1.0-7.fc16:Jan 29 16:07:01 localhost rsyslogd: [origin software="rsyslogd"swVersion="5.8.5" x-pid="862" x-info=""] rsyslogd wasHUPedJan 29 16:07:13 localhost kernel: [ 3955.894920] ------------[ cut here]------------Jan 29 16:07:13 localhost kernel: [ 3955.903162] WARNING: atlib/list_debug.c:26 __list_add+0x3e/0x81()Jan 29 16:07:13 localhost kernel: [ 3955.911352] Hardware name: System ProductNameJan 29 16:07:13 localhost kernel: [ 3955.919526] list_add corruption.next->prev should be prev (ff3007f0), but was c04f9031. (next=f0dc0240).Jan 29 16:07:13 localhost kernel: [ 3955.927869] Modules linked in: rfcomm bnepbtusb bluetooth rfkill tcp_lp nls_utf8 ppp_deflate zlib_deflate ppp_asynccrc_ccitt ppp_generic slhc cdc_acm qcaux fuse lockd ip6t_REJECTnf_conntrack_ipv6 nf_defrag_ipv6 nf_conntrack_ipv4 nf_defrag_ipv4ip6table_filter xt_state nf_conntrack ip6_tables snd_hda_codec_hdmisnd_hda_codec_analog ppdev snd_hda_intel snd_hda_codec snd_hwdep snd_seqsnd_seq_device snd_pcm k8temp snd_timer snd soundcore snd_page_alloc parport_pcparport nv_tco i2c_nforce2 asus_atk0110 sunrpc uinput binfmt_misc pata_acpiata_generic pata_amd sata_nv radeon ttm drm_kms_helper drm i2c_algo_biti2c_core [last unloaded: scsi_wait_scan]Jan 29 16:07:13 localhost kernel: [ 3955.973479] Pid: 4561, comm: updatedbTainted: G D W 3.1.0-7.fc16.i686.PAE #1Jan 29 16:07:13 localhost kernel: [ 3955.982870] Call Trace:Jan 29 16:07:13 localhost kernel: [ 3955.992217] [<c0447969>]warn_slowpath_common+0x7c/0x91Jan 29 16:07:13 localhost kernel: [ 3956.001630] [<c05de59d>] ?__list_add+0x3e/0x81Jan 29 16:07:13 localhost kernel: [ 3956.011031] [<c05de59d>] ?__list_add+0x3e/0x81Jan 29 16:07:13 localhost kernel: [ 3956.020300] [<c0447a09>]warn_slowpath_fmt+0x33/0x35Jan 29 16:07:13 localhost kernel: [ 3956.029554] [<c05de59d>]__list_add+0x3e/0x81Jan 29 16:07:13 localhost kernel: [ 3956.038785] [<c04f9031>] ?file_free+0x33/0x33Jan 29 16:07:13 localhost kernel: [ 3956.047952] [<c04f9411>]file_sb_list_add+0x32/0x3bJan 29 16:07:13 localhost kernel: [ 3956.057138] [<c04f697d>]__dentry_open+0xc5/0x256Jan 29 16:07:13 localhost kernel: [ 3956.066337] [<c04f7889>]nameidata_to_filp+0x52/0x5eJan 29 16:07:13 localhost kernel: [ 3956.066347] [<c05024e5>]do_last+0x416/0x52bJan 29 16:07:13 localhost kernel: [ 3956.066354] [<c0500fa0>] ?path_init+0x16a/0x24eJan 29 16:07:13 localhost kernel: [ 3956.066360] [<c05026d0>]path_openat+0xac/0x283Jan 29 16:07:13 localhost kernel: [ 3956.066370] [<c0434d8c>] ?should_resched+0xd/0x27Jan 29 16:07:13 localhost kernel: [ 3956.066380] [<c05d986c>] ?copy_to_user+0x44/0x4bJan 29 16:07:13 localhost kernel: [ 3956.066386] [<c05028f1>]do_filp_open+0x2b/0x6cJan 29 16:07:13 localhost kernel: [ 3956.066394] [<c05d978e>] ?strncpy_from_user+0x34/0x4eJan 29 16:07:13 localhost kernel: [ 3956.066402] [<c050ab7a>] ?alloc_fd+0x53/0xbfJan 29 16:07:13 localhost kernel: [ 3956.066410] [<c04f78f4>]do_sys_open+0x5f/0xe5Jan 29 16:07:13 localhost kernel: [ 3956.066418] [<c04f79a0>]sys_open+0x26/0x2cJan 29 16:07:13 localhost kernel: [ 3956.066427] [<c082c6df>]sysenter_do_call+0x12/0x28Jan 29 16:07:13 localhost kernel: [ 3956.066433] ---[ end tracecac7bee19eb98c78 ]---Jan 29 16:07:14 localhost abrt-dump-oops[785]: abrt-dump-oops: Found oopses: 1Jan 29 16:07:14 localhost abrt-dump-oops[785]: abrt-dump-oops: Creating dumpdirectoriesJan 29 16:07:14 localhost abrtd: Directory 'oops-2012-01-29-16:07:14-785-0'creation detectedJan 29 16:07:14 localhost abrt-dump-oops: Reported 1 kernel oopses to AbrtJan 29 16:07:14 localhost abrtd: Can't open file'/var/spool/abrt/oops-2012-01-29-16:07:14-785-0/uid': No such file or directoryJan 29 16:07:14 localhost abrtd: DUP_OF_DIR:/var/spool/abrt/oops-2012-01-29-16:05:53-785-3Jan 29 16:07:14 localhost abrtd: Dump directory is a duplicate of/var/spool/abrt/oops-2012-01-29-16:05:53-785-3Jan 29 16:07:14 localhost abrtd: Deleting dump directoryoops-2012-01-29-16:07:14-785-0 (dup of oops-2012-01-29-16:05:53-785-3), sendingdbus signal==========================Error message with kernel 3.3.0-4.fc16:FIRST TRY:Mar 27 16:37:39 localhost kernel: [ 264.613369] BUG: unable to handle kernelpaging request at 00200200Mar 27 16:37:39 localhost kernel: [ 264.613449] IP: [<f9ae7a41>]hci_conn_del+0xe1/0x230 [bluetooth]Mar 27 16:37:39 localhost kernel: [ 264.613536] *pdpt = 00000000332be001 *pde= 0000000000000000 Mar 27 16:37:39 localhost kernel: [ 264.613600] Oops: 0002 [#1] SMP Mar 27 16:37:39 localhost kernel: [ 264.613638] Modules linked in: rfcomm bnepbtusb bluetooth rfkill fuse lockd ip6t_REJECT nf_conntrack_ipv4 nf_defrag_ipv4 nf_conntrack_ipv6 nf_defrag_ipv6 xt_state ip6table_filter nf_conntrackip6_tables hwmon_vid snd_hda_codec_hdmi snd_hda_codec_analog snd_hda_intelsnd_hda_codec snd_hwdep snd_seq snd_seq_device snd_pcm ppdev parport_pc parportsnd_timer snd soundcore snd_page_alloc nv_tco i2c_nforce2 k8temp asus_atk0110microcode uinput binfmt_misc sunrpc pata_acpi ata_generic pata_amd sata_nv radeon ttmdrm_kms_helper drm i2c_algo_bit i2c_core [last unloaded: scsi_wait_scan]Mar 27 16:37:39 localhost kernel: [ 264.614295] Mar 27 16:37:39 localhost kernel: [ 264.614295] Pid: 22, comm: khubd Nottainted 3.3.0-4.fc16.i686.PAE #1 System manufacturer System ProductName/[*DELETED*]Mar 27 16:37:39 localhost kernel: [ 264.614295] EIP: 0060:[<f9ae7a41>] EFLAGS:00010246 CPU: 1Mar 27 16:37:39 localhost kernel: [ 264.614295] EIP is athci_conn_del+0xe1/0x230 [bluetooth]Mar 27 16:37:39 localhost kernel: [ 264.614295] EAX: 00200200 EBX: eee73400ECX: c0cb9300 EDX: eee73400Mar 27 16:37:39 localhost kernel: [ 264.614295] ESI: eec40000 EDI: eec40008EBP: f3dc5d64 ESP: f3dc5d3cMar 27 16:37:39 localhost kernel: [ 264.614295] DS: 007b ES: 007b FS: 00d8GS: 00e0 SS: 0068Mar 27 16:37:39 localhost kernel: [ 264.614295] Process khubd (pid: 22,ti=f3dc4000 task=f3cc4b60 task.ti=f3dc4000)Mar 27 16:37:39 localhost kernel: [ 264.614295] Stack:Mar 27 16:37:39 localhost kernel: [ 264.614295] eec40008 f3dc5d64 f9aff47bf3dc5d6c c0535ee9 f9ae1713 f9ae1713 eee73400Mar 27 16:37:39 localhost kernel: [ 264.614295] eec404c8 eec40008 f3dc5d88f9ae7c0d f3dc5d88 f9ae1713 eecb83c0 f3dc5d88Mar 27 16:37:39 localhost kernel: [ 264.614295] eee73400 eec40000 eec4048cf3dc5db4 f9ae28e3 c079f4d5 f3dc5dd0 c079e6e8Mar 27 16:37:39 localhost kernel: [ 264.614295] Call Trace:Mar 27 16:37:39 localhost kernel: [ 264.614295] [<f9aff47b>] ?l2cap_disconn_cfm+0x2b/0x60 [bluetooth]Mar 27 16:37:39 localhost kernel: [ 264.614295] [<c0535ee9>] ?kfree+0xf9/0x120Mar 27 16:37:39 localhost kernel: [ 264.614295] [<f9ae1713>] ?inquiry_cache_flush+0x43/0x70 [bluetooth]Mar 27 16:37:39 localhost kernel: [ 264.614295] [<f9ae1713>] ?inquiry_cache_flush+0x43/0x70 [bluetooth]Mar 27 16:37:39 localhost kernel: [ 264.614295] [<f9ae7c0d>]hci_conn_hash_flush+0x7d/0xf0 [bluetooth]Mar 27 16:37:39 localhost kernel: [ 264.614295] [<f9ae1713>] ?inquiry_cache_flush+0x43/0x70 [bluetooth]Mar 27 16:37:39 localhost kernel: [ 264.614295] [<f9ae28e3>]hci_dev_do_close+0xb3/0x300 [bluetooth]Mar 27 16:37:39 localhost kernel: [ 264.614295] [<c079f4d5>] ?usb_free_urb+0x25/0x30Mar 27 16:37:39 localhost kernel: [ 264.614295] [<c079e6e8>] ?usb_hcd_flush_endpoint+0x38/0x160Mar 27 16:37:39 localhost kernel: [ 264.614295] [<f9ae5664>]hci_unregister_dev+0x44/0x160 [bluetooth]Mar 27 16:37:39 localhost kernel: [ 264.614295] [<f99fe8a2>]btusb_disconnect+0x62/0xe0 [btusb]Mar 27 16:37:39 localhost kernel: [ 264.614295] [<c07a0edf>] ?usb_disable_interface+0x3f/0x50Mar 27 16:37:39 localhost kernel: [ 264.614295] [<c07a314c>]usb_unbind_interface+0x3c/0x130Mar 27 16:37:39 localhost kernel: [ 264.614295] [<c073353b>]__device_release_driver+0x5b/0xb0Mar 27 16:37:39 localhost kernel: [ 264.614295] [<c07335b4>]device_release_driver+0x24/0x40Mar 27 16:37:39 localhost kernel: [ 264.614295] [<c0733073>]bus_remove_device+0xb3/0x110Mar 27 16:37:39 localhost kernel: [ 264.614295] [<c07302ca>] ?device_remove_groups+0x2a/0x40Mar 27 16:37:39 localhost kernel: [ 264.614295] [<c0730508>] ?device_remove_attrs+0x38/0x60Mar 27 16:37:39 localhost kernel: [ 264.614295] [<c0730615>]device_del+0xe5/0x150Mar 27 16:37:39 localhost kernel: [ 264.614295] [<c07a0f86>]usb_disable_device+0x96/0x220Mar 27 16:37:39 localhost kernel: [ 264.614295] [<c0798d40>]usb_disconnect+0xa0/0x140Mar 27 16:37:39 localhost kernel: [ 264.614295] [<c079b33e>]hub_thread+0x99e/0x15a0Mar 27 16:37:39 localhost kernel: [ 264.614295] [<c04117b6>] ?__switch_to+0xa6/0x2b0Mar 27 16:37:39 localhost kernel: [ 264.614295] [<c04654e0>] ?remove_wait_queue+0x40/0x40Mar 27 16:37:39 localhost kernel: [ 264.614295] [<c046e10e>] ?complete+0x4e/0x60Mar 27 16:37:39 localhost kernel: [ 264.614295] [<c079a9a0>] ?usb_remote_wakeup+0x80/0x80Mar 27 16:37:39 localhost kernel: [ 264.614295] [<c0464d12>]kthread+0x72/0x80Mar 27 16:37:39 localhost kernel: [ 264.614295] [<c0464ca0>] ?kthread_freezable_should_stop+0x60/0x60Mar 27 16:37:39 localhost kernel: [ 264.614295] [<c095227e>]kernel_thread_helper+0x6/0x10Mar 27 16:37:39 localhost kernel: [ 264.614295] Code: c0 74 05 f0 80 67 64 fe8b 87 84 02 00 00 8d 57 64 8b 80 00 03 00 00 e8 9e 73 97 c6 89 d8 e8 b7 fe ffff 8b 43 04 8b 13 89 42 04 <89> 10 c7 43 04 00 02 20 00 e8 51 25 9e c6 0f b6 4319 3c 01 0f Mar 27 16:37:39 localhost kernel: [ 264.614295] EIP: [<f9ae7a41>]hci_conn_del+0xe1/0x230 [bluetooth] SS:ESP 0068:f3dc5d3cMar 27 16:37:39 localhost kernel: [ 264.614295] CR2: 0000000000200200Mar 27 16:37:39 localhost kernel: [ 264.650660] ---[ end trace95e09f03ecfbd227 ]---SECOND TRY:Mar 27 16:49:55 localhost kernel: [ 558.081328] BUG: unable to handle kernelpaging request at 0101046cMar 27 16:49:55 localhost kernel: [ 558.082015] IP: [<c0537ae0>]__kmalloc_track_caller+0xb0/0x1d0Mar 27 16:49:55 localhost kernel: [ 558.082015] *pdpt = 0000000032950001 *pde= 0000000000000000 Mar 27 16:49:55 localhost kernel: [ 558.082015] Oops: 0000 [#1] SMP Mar 27 16:49:55 localhost kernel: [ 558.082015] Modules linked in: rfcomm bnepbtusb bluetooth rfkill fuse lockd nf_conntrack_ipv4 nf_defrag_ipv4 ip6t_REJECT nf_conntrack_ipv6 nf_defrag_ipv6 xt_state nf_conntrack ip6table_filterhwmon_vid ip6_tables snd_hda_codec_hdmi snd_hda_codec_analog snd_hda_intelsnd_hda_codec nv_tco snd_hwdep snd_seq snd_seq_device ppdev snd_pcm microcode snd_timerk8temp i2c_nforce2 parport_pc parport snd soundcore snd_page_alloc asus_atk0110 sunrpc uinput binfmt_misc pata_acpi ata_generic pata_amd sata_nv radeon ttmdrm_kms_helper drm i2c_algo_bit i2c_core [last unloaded: scsi_wait_scan]Mar 27 16:49:55 localhost kernel: [ 558.082015] Mar 27 16:49:55 localhost kernel: [ 558.082015] Pid: 1011, comm: dbus-daemonNot tainted 3.3.0-4.fc16.i686.PAE #1 System manufacturer System ProductName/[*DELETED*]Mar 27 16:49:55 localhost kernel: [ 558.082015] EIP: 0060:[<c0537ae0>] EFLAGS:00010246 CPU: 1Mar 27 16:49:55 localhost kernel: [ 558.082015] EIP is at__kmalloc_track_caller+0xb0/0x1d0Mar 27 16:49:55 localhost kernel: [ 558.082015] EAX: 00000000 EBX: ef771840ECX: 0101046c EDX: 000042c3Mar 27 16:49:55 localhost kernel: [ 558.082015] ESI: f3c02580 EDI: c0c7f4c8EBP: f1517c78 ESP: f1517c48Mar 27 16:49:55 localhost kernel: [ 558.082015] DS: 007b ES: 007b FS: 00d8GS: 00e0 SS: 0068Mar 27 16:49:55 localhost kernel: [ 558.082015] Process dbus-daemon (pid:1011, ti=f1516000 task=f2a28c90 task.ti=f1516000)Mar 27 16:49:55 localhost kernel: [ 558.082015] Stack:Mar 27 16:49:55 localhost kernel: [ 558.082015] 000006cd 46f9abc2 f1517c8000000000 c084dc7e c08494c4 000004d0 000002c0Mar 27 16:49:55 localhost kernel: [ 558.082015] 0101046c ef771840 000004d0000001c5 f1517c98 c084dca1 00000000 00000000Mar 27 16:49:55 localhost kernel: [ 558.082015] f3c02180 eecb7b00 00000000f2a28c90 f1517cd4 c08494c4 ffffffff 000001c5Mar 27 16:49:55 localhost kernel: [ 558.082015] Call Trace:Mar 27 16:49:55 localhost kernel: [ 558.082015] [<c084dc7e>] ?__alloc_skb+0x2e/0x200Mar 27 16:49:55 localhost kernel: [ 558.082015] [<c08494c4>] ?sock_alloc_send_pskb+0x164/0x2a0Mar 27 16:49:55 localhost kernel: [ 558.082015] [<c084dca1>]__alloc_skb+0x51/0x200Mar 27 16:49:55 localhost kernel: [ 558.082015] [<c08494c4>]sock_alloc_send_pskb+0x164/0x2a0Mar 27 16:49:55 localhost kernel: [ 558.082015] [<c084961d>]sock_alloc_send_skb+0x1d/0x30Mar 27 16:49:55 localhost kernel: [ 558.082015] [<c08e2abf>]unix_stream_sendmsg+0x2ff/0x3f0Mar 27 16:49:55 localhost kernel: [ 558.082015] [<c0845b8f>]sock_sendmsg+0xff/0x120Mar 27 16:49:55 localhost kernel: [ 558.082015] [<c0557650>] ?__pollwait+0xd0/0xd0Mar 27 16:49:55 localhost kernel: [ 558.082015] [<c066d5e2>] ?_copy_from_user+0x42/0x60Mar 27 16:49:55 localhost kernel: [ 558.082015] [<c08513e4>] ?verify_iovec+0x44/0xb0Mar 27 16:49:55 localhost kernel: [ 558.082015] [<c08467ba>]__sys_sendmsg+0x24a/0x260Mar 27 16:49:55 localhost kernel: [ 558.082015] [<c0847fcb>]sys_sendmsg+0x3b/0x60Mar 27 16:49:55 localhost kernel: [ 558.082015] [<c0848673>]sys_socketcall+0x283/0x2e0Mar 27 16:49:55 localhost kernel: [ 558.082015] [<c04b6a54>] ?__audit_syscall_entry+0xb4/0x2b0 I have a similar problem: It happens sometimes when I have a BT headset connected and restart the PC or bluetootd.Laptop freezes completely with a similar statement from time to time or when you shut down the laptop displays the following message.CreatedKernel Stack Trace during shutdown if bluetoothd is startKernel Stack Trace during shutdown if bluetoothd is start(In reply to)I forgot:Kernel 3.3.3Bluez 4.99Bus 005 Device 002: ID 0a5c:2145 Broadcom Corp. Bluetooth with Enhanced Data Rate IISame problem here, running kernel 3.3.3. When bluetooth is shutdown (for sleep or complete shutdown of my laptop) I get a kernel stack trace about every other time. Sometimes the machine hard freezes.for me after update to kernel 3.4 problem solved! :-)(In reply to)Exactly, which distro do you use? And what kernel version solve your issue? Please, can you report the output of the command uname -r ?I've installed kernel version 3.5.3 and my issue is still present.What's your version of BlueZ? I installed the kernel 3.5.3 and BlueZ 4101. It stopped me fall, rarely kernel crash.(In reply to)I use Fedora 17. The bluez version is 4.98-3.(In reply to)Try the latest BlueZ 4.101.I tried Knoppix 7.0.2 and my PC freeze.I had not any issue with Fedora 13 and with the "same" hardware.I tried different versions of bluez and my PC always freeze using a usb bluetooth adapter.I've just tried Ubuntu Karmic Koala (9.10) and my hardware: sending and receiving files work fine, I have no issue.How I get kernel crash: I plug and unplug my bluetooth adapter several times and the kernel errors appear; or I send file to my Pc using my phone through bluetooth: sometimes I wait a few seconds to send another file after the previous ones but sometimes it is not necessary to wait to.I think it is definitely a bug of recent version kernels.Please tell against newer kernel, as of 2014 this bug shouldbe obsolete.Cheers Nick
id=15154	This is about a longstanding issue, as described in the archives ([0],[1]): > It [the directory] slowly grows every time a file is created, but does not > shrink when files are deleted. It is reset to zero if a directory is > completely emptiedSteps to reproduce, on a freshly formatted JFS:$ touch dummy$ for j in `seq -w 1 100`; do for i in `seq 1 10000`; do touch file.$i done sync rm -f file.* printf "`expr $j \* $i` "; du -sk . done | tee ../jfs.log Which gives us the following result: file directory creations size 130000 1028 KB 260000 2048 KB 390000 3068 KB 510000 4012 KB 640000 5036 KB 770000 6052 KB 900000 7072 KB[0][1] Another report, from Nov 2009:Why was this marked obsolete? This is still an issue with e.g. 3.11.10-200.fc19.i686 - as long as all but one file are removed in a directory, this directory will grow over time as new files are created and deleted:$ rm -f *$ for j in {1..10}; do seq 1 10000 | xargs -I '{}' touch file.'{}' echo "run: $j `ls | wc -l` files `du -sk` KB"; rm -f file.*donerun: 1 10000 files 692 . KBrun: 2 10000 files 692 . KBrun: 3 10000 files 692 . KBrun: 4 10000 files 692 . KBrun: 5 10000 files 692 . KBrun: 6 10000 files 692 . KBrun: 7 10000 files 692 . KBrun: 8 10000 files 692 . KBrun: 9 10000 files 692 . KBrun: 10 10000 files 692 . KB$ touch dummy$ for j in {1..10}; do seq 1 10000 | xargs -I '{}' touch file.'{}' echo "run: $j `ls | wc -l` files `du -sk` KB"; rm -f file.*donerun: 1 10001 files 772 . KBrun: 2 10001 files 848 . KBrun: 3 10001 files 928 . KBrun: 4 10001 files 1004 . KBrun: 5 10001 files 1084 . KBrun: 6 10001 files 1160 . KBrun: 7 10001 files 1240 . KBrun: 8 10001 files 1316 . KBrun: 9 10001 files 1396 . KBrun: 10 10001 files 1472 . KBNow, maybe this one is hard to fix and may not be worth fixing, as very few people seem to be affected. And with the posts on jfs-discussion and this bug the information is out there, so I could understand a WONTFIX, but OBSOLETE?Because it as filed against an ancient now unsupported kernel. Its just part of a mass close of stale old bugs.I suspect it is 'WONTFIX' however.
id=16298	If you accidentally start 2 instancesof xawtv, one of them gets stuck foreverand can't be terminated.This is 100% reproduceable.Here is the stack trace:xawtv D ffff88005d3cd540 0 2712 1 0x00000080ffff88005d3efb28 0000000000000082 0000000000000202 ffff88000000af00ffff88005d3efac8 0000000000000202 ffff88005d3efd38 ffff88005d3effd8ffff88005d3effd8 000000000000f9b0 00000000000157c0 ffff880060e183c8Call Trace:[<ffffffff81064a7d>] ? prepare_to_wait+0x67/0x74[<ffffffffa02336a2>] videobuf_waiton+0x145/0x163 [videobuf_core][<ffffffff8106480b>] ? autoremove_wake_function+0x0/0x34[<ffffffff810e3b92>] ? vfree+0x29/0x2b[<ffffffffa038765a>] saa7134_dma_free+0x45/0x67 [saa7134][<ffffffffa038c947>] buffer_release+0x9/0xb [saa7134][<ffffffffa0233dd7>] videobuf_queue_cancel+0xaf/0xd5 [videobuf_core][<ffffffffa0233e26>] videobuf_streamoff+0x29/0x39 [videobuf_core][<ffffffffa038bde1>] saa7134_streamoff+0x35/0x62 [saa7134][<ffffffffa02b51ea>] __video_do_ioctl+0x13e6/0x3327 [videodev][<ffffffff8128db87>] ? notify_update+0x31/0x33[<ffffffff81291bd7>] ? do_con_write+0x1ba3/0x1bea[<ffffffff8142dcf5>] ? atomic_notifier_call_chain+0x13/0x15[<ffffffff81291bd7>] ? do_con_write+0x1ba3/0x1bea[<ffffffffa02b3a37>] ? might_fault+0x1c/0x1e [videodev][<ffffffffa02b76e3>] video_ioctl2+0x2d4/0x3a1 [videodev][<ffffffff8104bc2c>] ? release_console_sem+0x18d/0x1be[<ffffffff81064afd>] ? remove_wait_queue+0x30/0x3b[<ffffffffa02b311c>] v4l2_ioctl+0x38/0x3a [videodev][<ffffffff8110de87>] vfs_ioctl+0x75/0xa1[<ffffffff8110e3a8>] do_vfs_ioctl+0x47e/0x4c4[<ffffffff81101363>] ? fsnotify_modify+0x67/0x6f[<ffffffff8110e43f>] sys_ioctl+0x51/0x74[<ffffffff81009b02>] system_call_fastpath+0x16/0x1b Bump kernel version.
id=41422	Hello,Everytime I plug an USB device on my laptop it suspends. My laptop is an acer4930G.After some tests(seeand) , the issue comes from this line in my /etc/rc.local .for i in /sys/bus/{pci,i2c}/devices/*/power/control; do echo -n 'auto' > $i;doneThe pci part is guilty of sending a sleep keyboard event when a USB device is plugged in.This event suspend the laptop by default in KDE. I tried changing the action to starting a terminal, and everytime I plug an USB device, a new terminal starts. If I associate the sleep shortcut to nothing, nothing happens.USB devices affected are at least USB thumb drives, USB HDD and USB mice.Other PM settings that may or may not participate in the issue :for i in /sys/class/scsi_host/*/link_power_management_policy; do echo -n 'min_power' > $i; donepcie_aspm=force in the boot lineoptions usbcore autosuspend=1 It's great that the kernel bugzilla is back.Can you please verify if the problem still exists in the latest upstreamkernel?bug closed as there is no response from the bug reporter.please feel free to reopen it if the problem still exists in the latest upstream kernel.Hello,Problem still exists in Kernel 3.3.8, I am using archlinux kernel.um, so the bug is that when you plug in your USB laptop,it sends a key that the distribution has set to suspendthe system?whelp, this is either a bug in the USB/keyboard/input path,or in the distro. Assigning to USB.
id=67831	With the information from this ticket () I have made some tests to show how the schedulers could be improved.First the initial configuration:--------------------------------------------------root@ubuntu:~# tc qdisc add dev eth0 root fq_codelroot@ubuntu:~# tc -s qdisc ls dev eth0qdisc fq_codel 8002: root refcnt 2 limit 10240p flows 1024 quantum 1514 target 5.0ms interval 100.0ms ecn Sent 0 bytes 0 pkt (dropped 0, overlimits 0 requeues 0) backlog 0b 0p requeues 0 maxpacket 256 drop_overlimit 0 new_flow_count 0 ecn_mark 0 new_flows_len 0 old_flows_len 0root@ubuntu:~# ping www.google.com -c 5PING www.google.com (173.194.32.244) 56(84) bytes of data.64 bytes from ber01s09-in-f20.1e100.net (173.194.32.244): icmp_seq=1 ttl=58 time=39.9 ms64 bytes from ber01s09-in-f20.1e100.net (173.194.32.244): icmp_seq=2 ttl=58 time=39.2 ms64 bytes from ber01s09-in-f20.1e100.net (173.194.32.244): icmp_seq=3 ttl=58 time=40.3 ms64 bytes from ber01s09-in-f20.1e100.net (173.194.32.244): icmp_seq=4 ttl=58 time=40.5 ms64 bytes from ber01s09-in-f20.1e100.net (173.194.32.244): icmp_seq=5 ttl=58 time=40.1 ms--- www.google.com ping statistics ---5 packets transmitted, 5 received, 0% packet loss, time 4021msrtt min/avg/max/mdev = 39.268/40.045/40.523/0.500 ms--------------------------------------------------fq_codel is active and the pings are fine while nothing else is being uploaded at the same time. But if I'm uploading a file (for example onor some other filehoster) the time of the pings will increase:--------------------------------------------------root@ubuntu:~# ping www.google.com -c 5PING www.google.com (173.194.32.241) 56(84) bytes of data.64 bytes from ber01s09-in-f17.1e100.net (173.194.32.241): icmp_seq=1 ttl=58 time=156 ms64 bytes from ber01s09-in-f17.1e100.net (173.194.32.241): icmp_seq=2 ttl=58 time=162 ms64 bytes from ber01s09-in-f17.1e100.net (173.194.32.241): icmp_seq=3 ttl=58 time=147 ms64 bytes from ber01s09-in-f17.1e100.net (173.194.32.241): icmp_seq=4 ttl=58 time=170 ms64 bytes from ber01s09-in-f17.1e100.net (173.194.32.241): icmp_seq=5 ttl=58 time=146 ms--- www.google.com ping statistics ---5 packets transmitted, 5 received, 0% packet loss, time 4018msrtt min/avg/max/mdev = 146.074/156.774/170.963/9.239 ms--------------------------------------------------This isn't unexpected because eth0 (1 gbit/s ethernet) isn't working to capacity (but the internet connection is limiting with ~320 kbit/s on the upstream) so fq_codel doesn't schedule.If I force a limit of 128 kbit/s on eth0 and uploading something the result will be different:--------------------------------------------------root@ubuntu:~# tc qdisc del dev eth0 root fq_codelroot@ubuntu:~# tc qdisc add dev eth0 handle 1: root htb default 11root@ubuntu:~# tc class add dev eth0 parent 1:1 classid 1:11 htb rate 128kbitroot@ubuntu:~# tc qdisc add dev eth0 parent 1:11 handle 11: fq_codelroot@ubuntu:~# tc -s qdisc ls dev eth0qdisc htb 1: root refcnt 2 r2q 10 default 11 direct_packets_stat 0 direct_qlen 1000 Sent 547688 bytes 390 pkt (dropped 0, overlimits 921 requeues 0) backlog 0b 1p requeues 0 qdisc fq_codel 11: parent 1:11 limit 10240p flows 1024 quantum 1514 target 5.0ms interval 100.0ms ecn Sent 547688 bytes 390 pkt (dropped 107, overlimits 0 requeues 0) backlog 1506b 1p requeues 0 maxpacket 1506 drop_overlimit 0 new_flow_count 36 ecn_mark 0 new_flows_len 0 old_flows_len 1root@ubuntu:~# ping www.google.com -c 5PING www.google.com (173.194.32.242) 56(84) bytes of data.64 bytes from ber01s09-in-f18.1e100.net (173.194.32.242): icmp_seq=1 ttl=58 time=98.5 ms64 bytes from ber01s09-in-f18.1e100.net (173.194.32.242): icmp_seq=2 ttl=58 time=40.9 ms64 bytes from ber01s09-in-f18.1e100.net (173.194.32.242): icmp_seq=3 ttl=58 time=77.5 ms64 bytes from ber01s09-in-f18.1e100.net (173.194.32.242): icmp_seq=5 ttl=58 time=55.5 ms--- www.google.com ping statistics ---5 packets transmitted, 4 received, 20% packet loss, time 4015msrtt min/avg/max/mdev = 40.904/68.148/98.568/21.878 ms--------------------------------------------------As shown fq_codel does now schedule and causes lower latency (but higher packet loss). I'm seeing such results too with sfq and pfifo_fast (but without the packet loss).Summary: The test shows that forcing the network scheduler to priorize (even with lower bandwidth) the result is much better. The logical consequence is that if the network schedulers would always priorize the network queue and not only if the first device is on working capacity the overall network performance would increase.So here comes the idea: The network schedulers could have an option that forces them to always priorize the network queue. Yes, this expected.The network queue disc are queue schedulers, and queue scheduling requires packets in the queue to have any impact.Go talk about this on the buffer bloat or other mailing list, this is not a bug.It seems you have not understood my post as there are packets in the queue and also it is not a bug I'm talking about.Edit: I have tested this now with limiting to 320 kbit/s and I'm getting the same results (as I expected).I want to try to explain this again:- Having fq_codel as scheduler and uploading something results in a upload with 320 kbit/s and with high pings (as fq_codel doesn't schedule because eth0 is not on working capacity).- If I force a limit of 320 kbit/s to eth0 the pings will be much better.This was tested because of your statement: "You won't see any effect unless the choke point is the output interface."Which is even confirmend with this test. So the idea is simple: If the schedulers would always priorize we would fill the buffer of the router in our wanted order. This way we would simply avoid the most negative bufferbloat effects on the router.If you think this is not true please explain it on my tests as I'm not seeing then why a physical hardcap of 320 kbit/s from the internet connection should behave differently if limiting this directly to eth0.
id=76211	Created0001-drm-i915-don-t-wait-for-power-cycle-when-waiting-for.patchOn a Dell XPS11 convertable (Intel HSW-YLT),i915 resume from S3 got slower in 3.15-rc1Linux 3.14: 400ms Linux 3.15-rc1: 1200msIf the attached patch is reverted, 400ms resume time is restored.Unfortunately, the attached patch also had the dramatic_benefit_ of reducing i915 suspend latency on the same XPS11to under 150ms from over 1300ms.The numbers are different when measured on a Lenovo Yoga2 Pro HSW-ULT,but the trend is the same. The patch increases resume timeto about 700ms from under 400ms, and the patch reducessuspend time to under 300ms from over 1100ms.Obviously, it would be ideal to capture the suspend speedbenefit of this patch without having the resume cost. However,if we have to pick between suspend and resume performance,resume performance is more important.Note that it is easy to graphically measure resume latency with this tool:if analyze_suspend.py is invoked with the -f argument, it alsoproduces an ftrace that can show exactly where the time goes.In the case of 3.15-rc1 on the Dell XPS11:intel_edp_panel_on takes > 1000ms wait_panel_power_cycle takes 800ms wait_panel_status takes 200ms The regressing commit iscommit 1a5ef5b7b4ee4a9514ca10057b08d978431a03e2Author: Paulo Zanoni <>Date: Thu Dec 19 14:29:43 2013 -0200 drm/i915: don't wait for power cycle when waiting for power off(In reply to Len Brown from)Please share these figures with the regressing commit reverted, with the time hogs there.Createdavoid full hotplug detect on resumeThis one may be sufficient. If not, try the next one (or just try the next one for fun, should make things really fast).Createdmake crtc enable asynchronousRe: patch inNo measurable difference.resume in 1246ms becomes 1233msSame time-consumers as above.Here's a copy/paste of the anayze_suspend.py ftrace output,sorry the indenting is not retained.I'll see if i can attach the whole compressed output.0000:00:02.0 resume_general (1212.094 ms @ 141.618 to 1353.712)dpm_run_callback (1212.093 ms @ 141.618)initcall_debug_start (0.023 ms @ 141.619)pm_dev_dbg (0.000 ms @ 141.644)pci_pm_resume (1212.052 ms @ 141.645)pci_has_legacy_pm_support (0.000 ms @ 141.646)pci_pm_default_resume (0.003 ms @ 141.647)i915_pm_resume [i915] (1212.045 ms @ 141.651)dev_get_drvdata (0.000 ms @ 141.651)i915_resume [i915] (1212.043 ms @ 141.653)__i915_drm_thaw [i915] (1212.041 ms @ 141.653)mutex_lock (0.001 ms @ 141.654)i915_gem_restore_gtt_mappings [i915] (88.342 ms @ 141.656)mutex_unlock (0.000 ms @ 229.999)i915_restore_state [i915] (0.710 ms @ 230.000)intel_opregion_setup [i915] (6.124 ms @ 230.710)intel_init_pch_refclk [i915] (0.073 ms @ 236.835)drm_mode_config_reset [drm] (0.001 ms @ 236.909)mutex_lock (0.001 ms @ 236.910)i915_gem_init_hw [i915] (4.437 ms @ 236.911)mutex_unlock (0.000 ms @ 241.349)drm_irq_install [drm] (0.197 ms @ 241.349)intel_modeset_init_hw [i915] (0.469 ms @ 241.546)drm_modeset_lock_all [drm] (0.004 ms @ 242.016)intel_modeset_setup_hw_state [i915] (1071.893 ms @ 242.020)haswell_get_pipe_config [i915] (0.011 ms @ 242.020)haswell_get_pipe_config [i915] (0.013 ms @ 242.031)haswell_get_pipe_config [i915] (0.012 ms @ 242.045)intel_ddi_setup_hw_pll_state [i915] (0.000 ms @ 242.058)intel_ddi_get_hw_state [i915] (0.006 ms @ 242.058)intel_ddi_get_hw_state [i915] (0.005 ms @ 242.064)intel_ddi_get_hw_state [i915] (0.005 ms @ 242.070)intel_ddi_connector_get_hw_state [i915] (0.008 ms @ 242.075)intel_ddi_connector_get_hw_state [i915] (0.008 ms @ 242.084)intel_ddi_connector_get_hw_state [i915] (0.008 ms @ 242.092)intel_ddi_connector_get_hw_state [i915] (0.009 ms @ 242.101)gen6_read32 [i915] (0.002 ms @ 242.110)hsw_write32 [i915] (0.003 ms @ 242.112)intel_crtc_update_dpms [i915] (0.001 ms @ 242.115)intel_dump_pipe_config [i915] (0.001 ms @ 242.117)gen6_read32 [i915] (0.002 ms @ 242.119)hsw_write32 [i915] (0.003 ms @ 242.121)intel_crtc_update_dpms [i915] (0.001 ms @ 242.124)intel_dump_pipe_config [i915] (0.001 ms @ 242.126)gen6_read32 [i915] (0.002 ms @ 242.127)hsw_write32 [i915] (0.003 ms @ 242.129)intel_crtc_update_dpms [i915] (0.001 ms @ 242.132)intel_dump_pipe_config [i915] (0.001 ms @ 242.133)ilk_wm_get_hw_state [i915] (0.031 ms @ 242.135)i915_redisable_vga [i915] (0.007 ms @ 242.167)__intel_set_mode [i915] (1071.285 ms @ 242.174)kmem_cache_alloc_trace (0.009 ms @ 242.174)kmem_cache_alloc_trace (0.005 ms @ 242.183)drm_mode_copy [drm] (0.000 ms @ 242.188)drm_mode_copy [drm] (0.000 ms @ 242.189)drm_mode_set_crtcinfo [drm] (0.000 ms @ 242.190)drm_mode_set_crtcinfo [drm] (0.000 ms @ 242.191)intel_ddi_compute_config [i915] (0.041 ms @ 242.191)intel_pipe_has_type [i915] (0.000 ms @ 242.233)hsw_crtc_supports_ips [i915] (0.000 ms @ 242.233)intel_dump_pipe_config [i915] (0.001 ms @ 242.234)drm_calc_timestamping_constants [drm] (0.000 ms @ 242.236)drm_object_property_set_value [drm] (0.000 ms @ 242.237)haswell_modeset_global_resources [i915] (0.039 ms @ 242.237)drm_vblank_pre_modeset [drm] (0.004 ms @ 242.277)haswell_crtc_mode_set [i915] (0.141 ms @ 242.281)drm_vblank_post_modeset [drm] (0.001 ms @ 242.422)intel_ddi_mode_set [i915] (0.001 ms @ 242.424)haswell_crtc_enable [i915] (1071.018 ms @ 242.425)intel_set_cpu_fifo_underrun_reporting [i915] (0.001 ms @ 242.426)intel_ddi_pre_enable [i915] (1035.452 ms @ 242.428)intel_ddi_get_encoder_port [i915] (0.000 ms @ 242.428)intel_edp_panel_on [i915] (1015.037 ms @ 242.429)edp_have_panel_power [i915] (0.003 ms @ 242.429)wait_panel_power_cycle [i915] (806.108 ms @ 242.433)msecs_to_jiffies (0.000 ms @ 242.433)schedule_timeout_uninterruptible (806.101 ms @ 242.434)wait_panel_status [i915] (0.005 ms @ 1048.536)_pp_ctrl_reg [i915] (0.000 ms @ 1048.541)ironlake_get_pp_control [i915] (0.003 ms @ 1048.542)hsw_write32 [i915] (0.003 ms @ 1048.545)gen6_read32 [i915] (0.002 ms @ 1048.549)wait_panel_status [i915] (208.914 ms @ 1048.552)hsw_write32 [i915] (0.005 ms @ 1257.467)intel_dp_sink_dpms [i915] (1.040 ms @ 1257.473)intel_dp_start_link_train [i915] (11.334 ms @ 1258.514)intel_dp_complete_link_train [i915] (8.031 ms @ 1269.849)intel_ddi_enable_pipe_clock [i915] (0.002 ms @ 1277.882)ironlake_pfit_enable [i915] (0.000 ms @ 1277.885)intel_crtc_load_lut [i915] (1.639 ms @ 1277.886)intel_ddi_set_pipe_settings [i915] (0.007 ms @ 1279.526)intel_ddi_enable_transcoder_func [i915] (0.008 ms @ 1279.534)intel_update_watermarks [i915] (0.086 ms @ 1279.543)intel_enable_pipe [i915] (0.028 ms @ 1279.630)intel_enable_ddi [i915] (0.505 ms @ 1279.659)intel_opregion_notify_encoder [i915] (0.002 ms @ 1280.165)intel_enable_primary_hw_plane [i915] (17.246 ms @ 1280.168)intel_enable_planes [i915] (0.002 ms @ 1297.415)intel_crtc_update_cursor [i915] (0.000 ms @ 1297.417)hsw_enable_ips [i915] (15.990 ms @ 1297.418)mutex_lock (0.001 ms @ 1313.409)intel_update_fbc [i915] (0.031 ms @ 1313.411)mutex_unlock (0.000 ms @ 1313.443)kfree (0.007 ms @ 1313.445)kfree (0.007 ms @ 1313.452)__intel_set_mode [i915] (0.080 ms @ 1313.461)__intel_set_mode [i915] (0.077 ms @ 1313.542)intel_modeset_check_state [i915] (0.292 ms @ 1313.620)drm_modeset_unlock_all [drm] (0.004 ms @ 1313.914)intel_hpd_init [i915] (0.030 ms @ 1313.918)drm_sysfs_hotplug_event [drm] (0.156 ms @ 1313.950)intel_opregion_init [i915] (38.115 ms @ 1314.107)console_trylock (0.005 ms @ 1352.222)queue_work_on (0.031 ms @ 1352.228)mutex_lock (1.432 ms @ 1352.259)mutex_unlock (0.000 ms @ 1353.692)intel_runtime_pm_put [i915] (0.001 ms @ 1353.693)drm_kms_helper_poll_enable [drm_kms_helper] (0.000 ms @ 1353.696)__suspend_report_result (0.000 ms @ 1353.698)initcall_debug_report (0.013 ms @ 1353.699)bugzilla accepts 5MB attachments, but the compressed trace is 9MBthe patch indid not apply to upstream Linux.What should I apply it to?It was based off the drm-intel-nightly branch from git://anongit.freedesktop.org/drm-intel, but that was last week, we've probably had 100 patches land since then...right, it doesn't apply to today's drm-inte-nightly eitherdrm-intel-nightly doesn't boot.So even if you patch did apply there, that branch isn't useful.Also, the fix to this bug must be with a patch that applies to Linux-3.15-rc.So if you can send a patch that applies to upstream Linux, I'll be morethan happy to test it.Can you try the fast-modeset branch of my kernel.org tree?git://git.kernel.org/pub/scm/linux/kernel/git/jbarnes/drm-inteltested:git://git.kernel.org/pub/scm/linux/kernel/git/jbarnes/drm-intelfast-modeset branch, as of top commit:commit 895d2bde2fc067dcc73edfa4857cd6b088fceabbAuthor: Jesse Barnes <>Date: Thu May 15 12:18:41 2014 -0700 drm/i915: make CRTC enable/disable asynchronousit panics on boot.not always.sometimes system freeze, sometime system reset.once I got it to boot and was able to measure suspend/resume.i915 suspend: 115msThis is in parallel with the Lynx Point Audio, which is currently 224msi915 resume: invisible!I ran this back-to-back with analyze_syspend -x2, and did not detect any deferred i915 resume delaying a subsequent suspend. (what happens if a suspend request occurs when your deferred resume has not completed?)So this patch looks like a very interesting prototype, but very unstable.Yeah I don't defer the whole suspend, just the mode set part. And that gets synchronized later on (or at suspend if we suspend again that fast), but as part of a sync_work() call rather than a sync on the whole resume.For the panics, do you have any logs? I didn't see panics here on my MBA when testing, but I probably have a different config than you.unfortunately, no logs on the panics, and deathseemed to come in a variety of ways...They seemed to happen when the screen was not printing charactersand then when things stopped all the only thing on the screenwas something about i915 switching back to text mode -- presumablybecause of the panic that had since scrolled off the screen.drm-intel-nightly has died on boot all my recent attempts to use it --so you might be inheriting something bad from drm-intel tree.If you can re-base base your patch on upstream, then apples/applesmay be more reliable and objective.If there are any knobs to turn that may make the failure morevisible, I'll be happy to turn them. I can also try this treeon another box.Lenovo Yoga2 Pro had no problems booting the same kernel binary(built from kernel in)that the Dell XPS11 struggled with.I rebooted the Yoga2 5 times w/ no issues.suspend/resume also worked fine on the Yoga2.i915 supsend time was 277ms, resume time not visible(/me wonders if we should add trace points to this patch so that analyze_suspend can see when the i915 does this work).Though stable, the Yoga2 277ms is considerably slower than on the Dell XPS11,which suspended in 115ms. Further, this 277ms is the long-polein suspend on the Yoga2, with the next slowest parallel devicetaking 25ms.Createdscreen image of i915 kernel fault from Dell XPS11The Lenovo had vt.handoff=7 on the cmdline and the Dell did not,so I slapped that on the Dell cmdline and it booted, suspended/resumed,but didn't reboot.The good news is that the resulting crash showed on the screen -- imageattached. Hopefully it gives a clue.On the XPS11, in about 10 boot requests, I get 3-4 successful boots,a couple of resets, and twice the stack trace attached in.If you can't read it in the image, the fault address is 0x00..000088(In reply to Len Brown from)commit 46470fc932ac8a0e8317a220b3f4ea4ed903338eAuthor: Mika Kuoppala <>Date: Wed May 21 19:01:06 2014 +0300 drm/i915: Add null state batch to active listshould fix the oops.I extracted's 46470fc932a from drm-intel tree,and applied it on top of jbarnes branch in.On the Lenovo Yoga2 Pro, it works fine -- though it worked fine before.On the Del XPS11,the system is no longer bringing up the GUI -- just the backgroundand the X cursor -- so it seems that the crashes hosed the graphicsconfig on this system somewhat. I'm going to re-test after a re-install.On fresh install of Ubuntu 14.04 on the Dell XPS11,the patch fromapplied on top of the treefromhas booted without problems 5 times in 5 attempts.Jesse, what's the status with the patches?Daniel rejected them based on the assumption that we'd have async atomic mode setting at some point.Well then, what's the status of this bug?We need to re-measure, but iirc the regression was caused by us honoring panel timings, so it was really fixing a bug.We can keep this bug open to track the resume performance in general, or just close it. The resume time should be fixed up after we land the async atomic stuff.(In reply to Jesse Barnes from)Closing. The power sequencing code has changed so much in the past months that any measurements here are not valid anymore. Feel free to reopen with current data.Createdcurrent analyze_suspend outputThis problem still exists in Linux-4.8.0, though the delayon this machine is now 909 ms, rather than 1,200 ms.Attached, please find the analzye_suspend.py output as runon the same laptop as above, installed with Ubuntu 16.10and its 4.8.0-22-generic kernel.Curiously, i915 resume invokes intel_hdmi_detect FOUR TIMES --twice in a kthread, and again twice in-line. This costs 160mseach time it is invoked.
id=71371	Createdlibata-core.c patchCrucial M500 and Micron M500 have broken "queued TRIM" support which leads to file system corruption.Currently the kernel disables "queued TRIM" but not for all models of the drive.It disables it only for models "Micron_M500*" and "Crucial_CT???M500SSD1" (wildcards as in drivers/ata/libata-core.c).I have a Crucial M500 mSATA drive, which shows as "Crucial_CT240M500SSD3" and I am suffering during the last months from frequent filesystem corruption. Disabling queued TRIM command seems to fix the problem.I've been testing it only for the last 20 hours, but I don't see the usual dmesg messages about failed TRIM commands I had until now.The errors I got until now, usually once during every boot and then periodically were like this:[ 62.283352] ata1.00: exception Emask 0x0 SAct 0x1 SErr 0x0 action 0x6[ 62.283356] ata1.00: irq_stat 0x40000008[ 62.283358] ata1.00: failed command: SEND FPDMA QUEUED[ 62.283363] ata1.00: cmd 64/01:00:00:00:00/00:00:00:00:00/a0 tag 0 ncq 512 out[ 62.283363] res 00/00:00:00:00:00/00:00:00:00:00/00 Emask 0x403 (HSM violation) <F>[ 62.283368] ata1: hard resetting link[ 62.590063] ata1: SATA link up 6.0 Gbps (SStatus 133 SControl 300)[ 62.590374] ata1.00: supports DRM functions and may not be fully accessible[ 62.596841] ata1.00: supports DRM functions and may not be fully accessible[ 62.602819] ata1.00: configured for UDMA/133[ 62.613085] sd 0:0:0:0: [sda][ 62.613089] Result: hostbyte=DID_OK driverbyte=DRIVER_SENSE[ 62.613091] sd 0:0:0:0: [sda][ 62.613092] Sense Key : Aborted Command [current] [descriptor][ 62.613094] Descriptor sense data with sense descriptors (in hex):[ 62.613095] 72 0b 00 00 00 00 00 0c 00 0a 80 00 00 00 00 00[ 62.613100] 00 00 00 00[ 62.613102] sd 0:0:0:0: [sda][ 62.613104] Add. Sense: No additional sense information[ 62.613105] sd 0:0:0:0: [sda] CDB:[ 62.613106] Write same(16): 93 08 00 00 00 00 0f 57 56 b8 00 00 00 28 00 00[ 62.613112] end_request: I/O error, dev sda, sector 257382072[ 62.613128] EXT4-fs (dm-4): discard request in group:577 block:17623 count:5 failed with -5[ 62.613130] ata1: EH complete Thanks.See Documentation/SubmittingPatches and send it towith a signed off by and it should get into the kernel.AlanThank you too. It was the first patch I ever send and was accepted!Feel free to change status as resolved if you see fit.Once it's hit the kernel proper. That way it is less likely to get lostCrucial recently released a new firmware update for the M500, MU05, seeDo you know if this update fixes Queued TRIM?Looks like it is fixed in MU05 and patch is ready in libata/for-3.15-fixesSee:(In reply to Pali Rohár from)Great. Thank you!I really don't know *why* this happens, but I have two Intel NUCs with Crucial M500 disks of 128Gb with their new MU05 firmware.When I run kernel 3.14.4 from the kernel-ppa-mainline of Ubuntu this 'fix' to the blacklist is included.The expectation would be that Queued TRIM would work and no errors would appear. But instead the exact errors as in the first post *do* appear and the disk acts very slow.When I switch back to an older kernel (with the old blacklists) the problems disappear.So, there are several hypotheses:1) Crucial did not fix the bug for my specific model (product: Crucial_CT120M50 version: MU05)2) Somehow magically on both of my NUCs the firmware on my SSD is broken3) Enabling Queued TRIM has exposed another before unknown bug.Best would be if more people with other M500 SSDs could check if they also have this problem.If so, the blacklist would have to be more strict again and/or Crucial will have to be notified about this problem.I have Crucial_CT480M500SSD1 with firmware MU05 and that problem still persist. Have to revert that patch before firmware exclusion. If not, it can get you REAL TROUBLE after deleting large files, BROKEN PARTITION TABLE included.We're going to blacklist all firmware versions until we figure this out. However, it would be great if people that experienced problems could forward me any error messages from syslog so I can forward them to Micron.Createddmesg_ioerrJust regular dmesg 2 minutes after boot.I got this in my dmesg when the errors occurred:[ 51.802288] ata4.00: exception Emask 0x1 SAct 0x34000000 SErr 0x0 action 0x6 frozen[ 51.802294] ata4.00: irq_stat 0x40000008[ 51.802299] ata4.00: failed command: READ FPDMA QUEUED[ 51.802307] ata4.00: cmd 60/08:d0:88:da:9f/00:00:09:00:00/40 tag 26 ncq 4096 in[ 51.802307] res 40/00:e4:00:00:00/00:00:00:00:00/a0 Emask 0x1 (device error)[ 51.802311] ata4.00: status: { DRDY }[ 51.802314] ata4.00: failed command: SEND FPDMA QUEUED[ 51.802319] ata4.00: cmd 64/01:e0:00:00:00/00:00:00:00:00/a0 tag 28 ncq 512 out[ 51.802319] res 40/00:e4:00:00:00/00:00:00:00:00/a0 Emask 0x1 (device error)[ 51.802322] ata4.00: status: { DRDY }[ 51.802324] ata4.00: failed command: READ FPDMA QUEUED[ 51.802329] ata4.00: cmd 60/08:e8:f0:49:47/00:00:07:00:00/40 tag 29 ncq 4096 in[ 51.802329] res 40/00:00:00:00:00/00:00:00:00:00/40 Emask 0x5 (timeout)[ 51.802332] ata4.00: status: { DRDY }[ 51.802337] ata4: hard resetting link[ 52.122361] ata4: SATA link up 6.0 Gbps (SStatus 133 SControl 300)[ 52.122808] ata4.00: supports DRM functions and may not be fully accessible[ 52.129420] ata4.00: supports DRM functions and may not be fully accessible[ 52.135470] ata4.00: configured for UDMA/133[ 52.135479] ata4.00: device reported invalid CHS sector 0[ 52.135482] ata4.00: device reported invalid CHS sector 0[ 52.135498] sd 3:0:0:0: [sda] [ 52.135501] Result: hostbyte=DID_OK driverbyte=DRIVER_SENSE[ 52.135504] sd 3:0:0:0: [sda] [ 52.135505] Sense Key : Aborted Command [current] [descriptor][ 52.135510] Descriptor sense data with sense descriptors (in hex):[ 52.135512] 72 0b 00 00 00 00 00 0c 00 0a 80 00 00 00 00 00 [ 52.135525] 00 00 00 00 [ 52.135530] sd 3:0:0:0: [sda] [ 52.135532] Add. Sense: No additional sense information[ 52.135535] sd 3:0:0:0: [sda] CDB: [ 52.135537] Write same(16): 93 08 00 00 00 00 02 25 48 48 00 00 00 08 00 00[ 52.135552] end_request: I/O error, dev sda, sector 35997768[ 52.135571] EXT4-fs (sda1): discard request in group:135 block:24585 count:1 failed with -5[ 52.135572] ata4: EH completeI just booted into 3.14.5-1-ARCH (previously running 3.14.1-1-ARCH) and almost immediately got this:[ 170.458943] ata1.00: exception Emask 0x1 SAct 0xc00 SErr 0x0 action 0x6 frozen[ 170.458948] ata1.00: irq_stat 0x40000008[ 170.458952] ata1.00: failed command: SEND FPDMA QUEUED[ 170.458958] ata1.00: cmd 64/01:50:00:00:00/00:00:00:00:00/a0 tag 10 ncq 512 out res 40/00:54:00:00:00/00:00:00:00:00/a0 Emask 0x1 (device error)[ 170.458961] ata1.00: status: { DRDY }[ 170.458963] ata1.00: failed command: READ FPDMA QUEUED[ 170.458968] ata1.00: cmd 60/08:58:28:fd:93/00:00:07:00:00/40 tag 11 ncq 4096 in res 40/00:00:00:00:00/00:00:00:00:00/00 Emask 0x5 (timeout)[ 170.458971] ata1.00: status: { DRDY }[ 170.458975] ata1: hard resetting link[ 170.779052] ata1: SATA link up 6.0 Gbps (SStatus 133 SControl 300)[ 170.779426] ACPI Error: [DSSP] Namespace lookup failure, AE_NOT_FOUND (20131218/psargs-359)[ 170.779434] ACPI Error: Method parse/execution failed [\_SB_.PCI0.SAT0.SPT0._GTF] (Node ffff8807fe053230), AE_NOT_FOUND (20131218/psparse-536)[ 170.779478] ata1.00: supports DRM functions and may not be fully accessible[ 170.786162] ACPI Error: [DSSP] Namespace lookup failure, AE_NOT_FOUND (20131218/psargs-359)[ 170.786170] ACPI Error: Method parse/execution failed [\_SB_.PCI0.SAT0.SPT0._GTF] (Node ffff8807fe053230), AE_NOT_FOUND (20131218/psparse-536)[ 170.786212] ata1.00: supports DRM functions and may not be fully accessible[ 170.792588] ata1.00: configured for UDMA/133[ 170.792595] ata1.00: device reported invalid CHS sector 0[ 170.792597] ata1.00: device reported invalid CHS sector 0[ 170.792608] sd 0:0:0:0: [sda] [ 170.792610] Result: hostbyte=0x00 driverbyte=0x08[ 170.792612] sd 0:0:0:0: [sda] [ 170.792614] Sense Key : 0xb [current] [descriptor][ 170.792617] Descriptor sense data with sense descriptors (in hex):[ 170.792619] 72 0b 00 00 00 00 00 0c 00 0a 80 00 00 00 00 00 [ 170.792627] 00 00 00 00 [ 170.792631] sd 0:0:0:0: [sda] [ 170.792632] ASC=0x0 ASCQ=0x0[ 170.792634] sd 0:0:0:0: [sda] CDB: [ 170.792636] cdb[0]=0x93: 93 08 00 00 00 00 09 67 2b c8 00 00 00 08 00 00[ 170.792646] end_request: I/O error, dev sda, sector 157756360[ 170.792667] EXT4-fs (dm-1): discard request in group:469 block:25465 count:1 failed with -5[ 170.792675] ata1: EH completeI updated my SSD to MU05 a while ago:[ 1.095937] ata1.00: ATA-9: Crucial_CT480M500SSD1, MU05, max UDMA/133[ 1.095941] ata1.00: 937703088 sectors, multi 16: LBA48 NCQ (depth 31/32), AAI remounted everything nodiscard, hopefully nothing has already gotten corrupted.@Martin K. Petersen: Any news about fixing this FW bug?I forwarded the relevant logs and information to my contacts at Micron. They were looking into it but I haven't gotten any updates recently. I'll poke them again...@Martin K. Petersen: But have they at least confirmed that they are actively working on it? I payed about 500 bucks for my 1TB M500 so I should be able to expect some support from them.I've checked that 3.15.4 is still blacklisting all M500 firmware, which is a good thing. I'm getting M500 over the weekend. Btw if someone can share the steps to replicate this, I'll give it a try.@Martin K. Petersen: anything new?@Martin K. Petersen. I was wondering if you heard anything back from Micron or if there is at least an official acknowledgement that they are looking into it?I have three M500's (1x960Gb, 2x 480GB) and would be nice to know if they are definitely looking into it. Such a shame that this affects only Crucial drives.. My worry is they may not be actively working on M500 as they released two drives after M500..IMHO if Crucial isn't actively working on the M5x0 firmware, they should just release a small firmware update that only disables queued trim and be done with it.I have bought a Crucial M550 for almost a month, but TBH no firmwares available on its website.I've just started getting this issue since upgrading from 3.16.3 -> 3.17.0Previously, in 3.16.3 I had no issues (because of the blacklist):[ 3.879291] ata5.00: disabling queued TRIM support[ 3.879294] ata5.00: ATA-9: Crucial_CT240M500SSD3, MU05, max UDMA/133Now, 3.17.0, I don't get the same message about disabling TRIM (and instead get the discard request failed errors as above)Comparing the two libata-core.c I noticed this, which looks strange (i.e. backwards)... but I'll take a closer look@@ -4261,10 +4327,10 @@ ata_id_c_string(dev->id, model_rev, ATA_ID_FW_REV, sizeof(model_rev)); while (ad->model_num) {- if (glob_match(model_num, ad->model_num)) {+ if (!glob_match(model_num, ad->model_num)) { if (ad->model_rev == NULL) return ad->horkage;- if (glob_match(model_rev, ad->model_rev))+ if (!glob_match(model_rev, ad->model_rev)) return ad->horkage; } ad++;This looks like a regression somehow relating to the introduction of glob.c with commit 428ac5fc056e06dc0b4ed82d5979add9a8c62b35I tried a few different things, and could fix the issue by reverting just that change (this way was easier to test!)$ cp ../linux-3.16.3/drivers/ata/libata-core.c drivers/ata/libata-core.c$ sed -i 's/glob_match/&_old/g' drivers/ata/libata-core.cso glob.c remained, but libata-core used the old function. This worked, NCQ TRIM got disabled as it should. I'm not sure where to go from here - glob.c works fine with the self tests, and that's the only function that has changed between the two releases. I tagged an "else" on the end of the part that should disable NCQ TRIM (to make sure it wasn't trying to disable it and just failing) - the if statement returns false.There's now a patch to fix the 3.17.0 libata-core blacklist bug, available here for people needing it before the merge:Hello. Does this bug affected on adata sp920 too? It seems it is mostly identical ssd drive.I was also getting similar errors on Crucial_CT512MX100.(FYKI:).Someone suggested it's ALPM issue, so after setting SATA link power management policy to max_performance at all times (even on battery power), I am no longer getting the error.echo max_performance > /sys/class/scsi_host/host0/link_power_management_policyCan anyone please check if this fixes the problem for you.Sumit: That's really good data. I'll pass that along to the Micron folks.There's a new firmware for M550 SSDs, the changelog reads:Corrected error handling NCQ Trim CommandsSo is anyone able to confirm that M550 SSDs with MU02 firmware can safely be removed from the blacklist?If only please Crucial would also fix this fo the M500, the hardware is not *that* old that it wouldn't be expected to get new firmware, especially for a crucial error like this.On Wed, Mar 11, 2015, at 09:12,wrote:Well, they just issued a fix for the MX100, with mostly same changelogas the one for the M550. It is supposed to fix the NCQ trim horkage onthe MX100 as well as ALPM-related issues.There is some hope they will get to the M500. But M500 owners shouldmake a pest of themselves demanding the fix through the Crucial officialsupport channels, I think, if it is to become reality.(In reply to Thomas from)I just decided to try this for myself, so I applied this small patch (warning: quick&dirty, not meaned to fix this bug, might cause data corruption if Crucial SSDs other than the MD550 are installed) :diff -Nru linux-3.19.old/drivers/ata/libata-core.c linux-3.19/drivers/ata/libata-core.c--- linux-3.19.old/drivers/ata/libata-core.c 2015-02-09 03:54:22.000000000 +0100+++ linux-3.19/drivers/ata/libata-core.c 2015-03-11 12:29:15.196686954 +0100@@ -4235,7 +4235,7 @@ /* devices that don't properly handle queued TRIM commands */ { "Micron_M[56]*", NULL, ATA_HORKAGE_NO_NCQ_TRIM | ATA_HORKAGE_ZERO_AFTER_TRIM, },- { "Crucial_CT*SSD*", NULL, ATA_HORKAGE_NO_NCQ_TRIM, },+ { "Crucial_CT???M550SSD*", "MU01*", ATA_HORKAGE_NO_NCQ_TRIM, }, /* * As defined, the DRAT (Deterministic Read After Trim) and RZATCompiled the kernel, rebootet, started file options on the SSD (copying files to it and removing files) with discard as a mount option as well as issued manual TRIM commands (via fstrim -v). So far everything seems fine: No errors in dmesg or any other signs of data corruption.Ofc. all of this was with the MU02 firmware:$ hdparm -i /dev/sda/dev/sda: Model=Crucial_CT128M550SSD1, FwRev=MU02, -SNIP-(In reply to Henrique de Moraes Holschuh from)OK, I started to write again in the Crucial Forums about this error. I urge anyone who has the hardware then to also make themselves heard.On Wed, Mar 11, 2015, at 13:34,wrote:I did say official support channels. The Crucial forums are a "usershelping users" thing, even the Crucial people there will tell you to useother channels if you need to get Crucial to actually act on something. No, I don't have the proper contact info on hand, but I suppose thepeople who do RMAs should be able to send you to the proper supportchannel...I think we should refine the queued-trim blacklist to blacklist the M550and MX100 before MU02, tell people about it so that they can test it,and merge it later after some testing.Also, it would be really nice to be able to override TRIM support modeon the kernel command line (off/auto/non-queued/queued).I'm working with the Micron folks to get this resolved. Waiting for one more piece of info and then I'll update our blacklist rules for Crucial/Micron drives. Hopefully within a day or two.I know this has been a long time coming but it was hard to root cause due to Linux being the only OS actually issuing queued TRIM commands.(In reply to Martin K. Petersen from)I'm running my Crucial M550 with the MU02 firmware and with a patched kernel to disable the blacklist (see) since 3 days without any data corruption, so I would say it has been fixed. Anyway, I understand why you want to confirm it with Micron before updating the blacklist rules, any news on this?(In reply to Martin K. Petersen from)I was having this issue on MX100 drive install on 13 inch MacBookPro8,1, I checked the crucial site they have firmware upgrade for MX100 as well (MU01 -> MU02). But when I tried to update the firmware via bootable cd I am getting below error.Firmware Update on /dev/sda failed with status 13.Device Name: /dev/sdaFirmware Update on /dev/sda Faild!STATUS_CODE: 13Your system will now return to normal operation following a reboot.I would really appreciate it if you could please pass this information to micron folks.Latest update:M500: The problems *should* be fixed in MU05. My MU05 is working fine under stress even with ALPM enabled but I know that several of you are seeing problems. Unless I hear otherwise I'm going to leave M500 on the blacklist.M510/M550/MX100: MU05 does contain the relevant fixes. I will blacklist MU01.M600/MX200: Shipped with the fixes in place and all released firmware versions are good to go.BX100: These drives do not support queued TRIM.(In reply to Martin K. Petersen from)I can confirm M500 MU05 is broken/"iffy" - it's what caused me to notice this within minutes of updating:Please leave M500 blacklisted until MU06 is out & tested (if they ever do...)I'm also experiencing this issue on Ubuntu 14.04 LTS using a Crucial_CT240M500SSD1 with MU05 firmware. I constantly get the following messages in dmesg:1198.426617] ata4: SATA link up 1.5 Gbps (SStatus 113 SControl 310)[ 1198.427031] ata4.00: supports DRM functions and may not be fully accessible[ 1198.429981] ata4.00: disabling queued TRIM support[ 1198.433634] ata4.00: supports DRM functions and may not be fully accessible[ 1198.436581] ata4.00: disabling queued TRIM support[ 1198.439868] ata4.00: configured for UDMA/33[ 1198.439917] ata4: EH complete[ 1200.510758] ata4: exception Emask 0x50 SAct 0x0 SErr 0x4090800 action 0xe frozen[ 1200.510766] ata4: irq_stat 0x00400040, connection status changed[ 1200.510772] ata4: SError: { HostInt PHYRdyChg 10B8B DevExch }[ 1200.510781] ata4: hard resetting linkAnd then the follow message periodically:[ 1172.514336] ata4.00: failed command: WRITE FPDMA QUEUED[ 1172.514338] ata4.00: cmd 61/88:b0:90:7b:79/03:00:17:00:00/40 tag 22 ncq 462848 out[ 1172.514338] res 40/00:4c:10:c2:76/00:00:17:00:00/40 Emask 0x50 (ATA bus error)[ 1172.514339] ata4.00: status: { DRDY }The computer runs fine if I'm just browsing or playing music but if I perform multiple disk operations, like downloading a torrent and then waching a movie the performance of the system becomes very slow and frequently freezes the computer. I have to hard reset to recover.Will applying the patch above resolve this?@Martin K. Petersen: Anything new from Micron for M500? Will they fix this problem?@Pali: Since M500 is a couple of generations old I personally doubt they'll update it. Queued TRIM is a niche feature to begin with and unqueued TRIM works fine on these drives.Just to add another data point I have a Micron (not Crucial) M550 which seems to work fine after removing the blacklist entry.Model=Micron_M550_2.5"_7mm_512GB, FwRev=DL04, SerialNo=14260C70054BI don't know if there are any firmware updates for this drive - I can't find them on Micron's site and the Crucial update refuses to apply.Installed a brand new Crucial_CT250MX200SSD1 (MU01) this morning and had the following problem:[ 1.065905] ata3: SATA max UDMA/133 abar m1024@0xfe8ffc00 port 0xfe8ffe00 irq 22[ 1.390156] ata3: SATA link down (SStatus 0 SControl 300)[ 1.397783] ata3: exception Emask 0x10 SAct 0x0 SErr 0x40d0002 action 0xe frozen[ 1.397784] ata3: irq_stat 0x00400040, connection status changed[ 1.397789] ata3: hard resetting link[ 3.000238] ata3: SATA link down (SStatus 0 SControl 300)[ 3.004857] ata3: EH complete[ 3.014985] ata3: exception Emask 0x10 SAct 0x0 SErr 0x40d0002 action 0xe frozen[ 3.019752] ata3: irq_stat 0x00400040, connection status changed[ 3.024583] ata3: limiting SATA link speed to 1.5 Gbps[ 3.029362] ata3: hard resetting link[ 3.753998] ata3: SATA link up 1.5 Gbps (SStatus 113 SControl 310)[ 3.764610] ata3.00: supports DRM functions and may not be fully accessible[ 3.775535] ata3.00: ATA-10: Crucial_CT250MX200SSD1, MU01, max UDMA/133[ 3.785821] ata3.00: 488397168 sectors, multi 16: LBA48 NCQ (depth 31/32), AA[ 3.797454] ata3.00: supports DRM functions and may not be fully accessible[ 3.809415] ata3.00: configured for UDMA/133[ 3.819663] ata3: EH complete[ 3.839699] ata3.00: Enabling discard_zeroes_data[ 3.889700] ata3.00: Enabling discard_zeroes_data[ 3.919664] ata3.00: Enabling discard_zeroes_dataI appear to have fixed the problem by adding the following to libata-core.c:--- linux-4.1.1/drivers/ata/libata-core.c 2015-06-22 06:05:43.000000000 +0100+++ linux-4.1.2/drivers/ata/libata-core.c 2015-07-11 10:04:48.644600782 +0100@@ -4235,6 +4235,8 @@ ATA_HORKAGE_ZERO_AFTER_TRIM, }, { "Crucial_CT*MX100*", "MU01", ATA_HORKAGE_NO_NCQ_TRIM | ATA_HORKAGE_ZERO_AFTER_TRIM, },+ { "Crucial_CT*MX200*", "MU01", ATA_HORKAGE_NO_NCQ_TRIM |+ ATA_HORKAGE_ZERO_AFTER_TRIM, }, { "Samsung SSD 8*", NULL, ATA_HORKAGE_NO_NCQ_TRIM | ATA_HORKAGE_ZERO_AFTER_TRIM, },Was that the correct thing to do ?@rickyxt, @Stuart Foster:The errors you reported look like a different issue than the originally reported in this bug report. It could be related to NCQ TRIM enabled together with ALPM, as it does look like ALPM-caused issues. Or it could be just ALPM-related.Note that marginal SATA cables or connectors can cause this kind of spurious link down problems as well, so please verify that.We know for a fact that the Crucial and Micron SATA SSDs react differently depending on link speed and ALPM level. Slowdown issues (no data corruption) were reported in the Crucial forums, and the slowdowns "went away" when the device was connected to a very fast Intel 6Gbps SATA port (and still showed up on some other 6Gbps ports from other vendors). The slowdowns also went away when ALPM was entirely disabled (regardless of SATA port type/speed/vendor). So, the SSDs did not like ALPM enabled depending on the motherboard (and SATA port configuration) it was connected to.These issues are supposedly fixed by the latest firmware updates for the M550, MX and BX SSDs, but they might not have gone away entirely...In rickyxt's case, the M500 is likely to still have some of the ALPM bugs, as it did not get the latest round of firmware fixes (which would have fixed the NCQ TRIM bug as well). It is likely a very good idea to run M500 SSDs with ALPM disabled. That's how I run mine.In Stuart Foster's case, it is surprising that disabling NCQ trim helped avoid this possibly new issue on the MX200. Still, disabling NCQ TRIM is _always safe_ as far as we know, so it would be a good idea for Stuart to keep it blacklisted for production.Stuart, if you'd like to help track down the issue you noticed in the MX200 MU01 firmware, maybe you could check whether you can easily reproduce the issue, and whether it happens with the four combinations of ALPM enabled/disabled and NCQ TRIM enabled/disabled ?The cable may be the issue as I have currently experienced the problem once with the original cable with my patched kernel. I would liked to investigate further before I condemn the cable though. During the last few hours the unpached kernel is now booting most of the time without showing any issues. This is different to the behaviour this morning when the unpatched kernel borked on every boot. Interestingly I have not yet seen the issue with two other sata cables that I have tried. I would like to try the ALPM enable/disabled test you suggested. What is the easiest way to turn it off, can this be done from the kernel boot parameters ?On Sat, 11 Jul 2015,wrote:You can change ALPM state at runtime in sysfs:/sys/class/scsi_host/host*/link_power_management_policyset to "max_performance" to disable ALPM. set to "medium_power" to enable.Do note that it applies to the entire scsi host, not to a device. Use, e.g."lsscsi" to get the host/device mapping. SCSI Device [6:0:0:0] would be onhost 6.I have run the ALPM/NCQ tests as suggested (4.1.1 kernel ALPM disabled by default) with a known good cable and I have found no issues (the only difference on my tests was that with NCQ disabled the results were insignificantly faster (0.3%) on a 10 minute random read/write test).The cable that was giving me my original problem interestingly only fails with the new MX200 drive and only on one orientation, if I swap it end for end it works perfectly like the other 5 cables I have tried.So in the bin with it and apologies for wasting your time.Stuart: Thanks for the update.FYI: The MX200 supports queued TRIM and shares implementation with M550 and M600. I am not aware of any issues with the latest firmware releases for these drives.(In reply to Martin K. Petersen from)I don't have any M550 or M600's but I do have some M4's and M500's the only thing I see with the M500's on Linux 4.1.2 (ASUS M5A97 PRO and a Lenovo laptop) is:[ 2.657287] ata3: SATA max UDMA/133 abar m1024@0xfeb0b000 port 0xfeb0b200 irq 19[ 2.978232] ata3: SATA link up 6.0 Gbps (SStatus 133 SControl 300)[ 2.978555] ata3.00: supports DRM functions and may not be fully accessible[ 2.978606] ata3.00: failed to get NCQ Send/Recv Log Emask 0x1[ 2.978606] ata3.00: ATA-9: Crucial_CT240M500SSD1, MU05, max UDMA/133[ 2.978608] ata3.00: 468862128 sectors, multi 16: LBA48 NCQ (depth 31/32), AA[ 2.978651] ata3.00: failed to get Identify Device Data, Emask 0x1[ 2.978907] ata3.00: supports DRM functions and may not be fully accessible[ 2.978956] ata3.00: failed to get NCQ Send/Recv Log Emask 0x1[ 2.979001] ata3.00: failed to get Identify Device Data, Emask 0x1[ 2.979003] ata3.00: configured for UDMA/133[ 2.992665] ata3.00: Enabling discard_zeroes_data[ 2.992858] ata3.00: Enabling discard_zeroes_data[ 2.993128] ata3.00: Enabling discard_zeroes_dataThanksI had a request for a customer site review from Crucial after checking the firmware status of all my Crucial SSD's and I happen to comment on the M500 MU05 firmware status and I unexpectedly got the following reply:Hello Stuart,Thank you for your recent survey. I am very sorry to hear that you are disappointed that we haven't updated our M500 MU05 Firmware.We have no plans to release an updated version I am afraid as this is not a widespread issue and only affects a small number of Linux customers. I appreciate some users are having an issue but it is an extremely small number and not affecting a high number of M500's.Our drives have built in garbage collection which is in effect the same as TRIM. This cleans the SSD as it sits idle so this contributes to a clean and healthy drive.If you have any further questions or need further help, just let me know.Kind RegardsJames AndersoneCommerce Sales and Support AgentTel: 0800 013 0330Fax: 0800 013 0336Join the Crucial CommunityForums:Facebook:Twitter:YouTube:Micron Consumer Products Group, a division of Micron Europe Ltd Registered in England, Company No. 02341071 Registered Office: Lâ€™Avenir, Opladen Way, Bagshot Road, Bracknell, Berkshire, UK RG12 0PH(In reply to Stuart Foster from)Thanks for sharing that. It's disappointing, especially considering whatever is broken (and now patched) for the M550 probably shares most of the code with the M500. I guess they think they can make more money by getting us to upgrade. They lost me as a customer a year ago - I won't be buying their products again!I have M550 with Fedora Rawhide installed inside. After updated to MU02 it runs faster than before, and I've only met one time that failed to start the rootfs after new kernel installed.But There is an enclosure for SSD to connect to USB 3.0 port for personal work, I seldom connect my SSD via SATA so I haven't enabled discard in fstab, any suggestions for case like this?
id=48761	xubuntu 12.10rc, x64 with a HA-IR01SV 'vista' mce remoteWhen using the infrared remote, operations are generally buggy compared to lirc. Multiple buttons do not work, and if you hold down a key, it's repetition is buggy (ie holding it down for one second will repeat way faster than it should and for longer, so if you are choosing a selection from a list you will end up at the bottom) It still hasn't been fixed.On Wed, Nov 27, 2013 at 11:17:21PM +0000,wrote:Please send email to the developers of the driver, and
id=50521	Cloning for nouveau+++ This bug was initially created as a clone of+++Both drivers/gpu/drm/i915/intel_acpi.c and drivers/gpu/drm/nouveau/nouveau_acpi.c call _DSM methods with parameters of _DSM(Buffer, Integer, Integer, Integer). The ACPI spec defines the parameters to be _DSM(Buffer, Integer, Integer, Package). On a UL30VT, the AML preforms operations on Arg3 which are not valid for an Integer data type, resulting in ACPI faults. Excerpt of DSDT:Method (_DSM, 4, NotSerialized){ If (LEqual (Arg0, Buffer (0x10) { /* 0000 */ 0xA0, 0xA0, 0x95, 0x9D, 0x60, 0x00, 0x48, 0x4D, /* 0008 */ 0xB3, 0x4D, 0x7E, 0x5F, 0xEA, 0x12, 0x9F, 0xD4 })) { Store (Zero, Local0) Store (ShiftLeft (DerefOf (Index (Arg3, 0x03)), 0x18), Local0) Add (ShiftLeft (DerefOf (Index (Arg3, 0x02)), 0x10), Local0, Local0) Add (ShiftLeft (DerefOf (Index (Arg3, One)), 0x08), Local0, Local0) Add (ShiftLeft (DerefOf (Index (Arg3, Zero)), Zero), Local0, Local0) ...The Index operation is only valid on a Buffer, String, or Package, which is perfectly reasonable given the definition of the _DSM call. Why was this closed as "RESOLVED"? The code is still present in the kernel, and it still causes errors. My _DSM looks identically to the above. (Asus X73SV)It was fixed on August 1st. If you have an older kernel you'll need to updatecommit 6d5c2d8ca3c15a191a8078316e547c1f4e5ad6ebAh .. sorry only Intel was fixed.. Nouveau folks must be slacking ;-)
id=97871	I was doing defragmentation of the /home by following commandsfind /home -type d -print0 | xargs -0 btrfs filesystem defragment -f -clzofind /home -type f -print0 | xargs -0 btrfs filesystem defragment -f -clzonot sure, which one caused the problem, but I got:xargs: btrfs: terminated by signal 11and the processes [btrfs-transacti] and [kworker/u4:1] are in D state, while an user-process is in Dl+ state since the errorI suspect the user-process was reading (or maybe writing, but that's less probable) a file, which was being defragmentedAdditional info:mount: /dev/mapper/encrypted3 on /home type btrfs (rw,noatime,compress=lzo,commit=600,autodefrag,space_cache,subvol=home,device=/dev/mapper/encrypted1,device=/dev/mapper/encrypted2,device=/dev/mapper/encrypted3,device=/dev/mapper/encrypted4)btrfs filesystem df /homeData, RAID5: total=2.68TiB, used=2.66TiBSystem, RAID5: total=96.00MiB, used=204.00KiBMetadata, RAID5: total=7.22GiB, used=3.98GiBGlobalReserve, single: total=512.00MiB, used=0.00Bdmesg:[343650.096174] Kernel BUG at ffffffff8135fc00 [verbose debug info unavailable][343650.104163] invalid opcode: 0000 [#1] SMP [343650.112133] Modules linked in: bridge stp llc xt_conntrack iptable_filter xt_nat iptable_nat nf_conntrack_ipv4 nf_defrag_ipv4 nf_nat_ipv4 nf_nat nf_conntrack ip_tables x_tables[343650.129278] CPU: 0 PID: 756 Comm: btrfs Not tainted 4.0.0 #11[343650.137965] Hardware name: HP ProLiant MicroServer, BIOS O41 10/01/2013[343650.146820] task: ffff8801262a0c60 ti: ffff88017c63c000 task.ti: ffff88017c63c000[343650.156000] RIP: 0010:[<ffffffff8135fc00>] [<ffffffff8135fc00>] btrfs_release_extent_buffer_page+0xf0/0x100[343650.174497] RSP: 0018:ffff88017c63fc48 EFLAGS: 00010202[343650.183920] RAX: 0000000000000001 RBX: ffff8800173679d8 RCX: ffff8803ffc68b69[343650.193456] RDX: 0000000000000000 RSI: ffff880129abe490 RDI: ffff8800173679d8[343650.203013] RBP: ffff8800dc5bc000 R08: 0000000000000000 R09: ffff880129abe490[343650.212655] R10: ffff88017c63fc40 R11: 0000000000000000 R12: ffff8800173679d8[343650.222183] R13: 0000000000000005 R14: 0000000000000000 R15: ffff880003092a20[343650.231594] FS: 00007f7a44543c40(0000) GS:ffff88041fc00000(0000) knlGS:00000000f7772700[343650.241109] CS: 0010 DS: 0000 ES: 0000 CR0: 000000008005003b[343650.250473] CR2: 00007fa5c50ea0d4 CR3: 00000003304e9000 CR4: 00000000000007f0[343650.259998] Stack:[343650.269302] ffff8800173679d8 ffff8800173679d8 ffff8800dc5bc000 ffff880003092aa0[343650.279017] ffff88017c63fce7 ffffffff8135fc4d 0100000000002ee7 ffff880003092a80[343650.288701] ffff880003092a20 ffffffff81314021 ffff880003092a20 ffff8800dc546380[343650.298346] Call Trace:[343650.307745] [<ffffffff8135fc4d>] ? release_extent_buffer+0x3d/0xe0[343650.317600] [<ffffffff81314021>] ? btrfs_release_path+0x21/0xa0[343650.327460] [<ffffffff813140ae>] ? btrfs_free_path+0xe/0x30[343650.337105] [<ffffffff813541bf>] ? btrfs_defrag_leaves+0x22f/0x360[343650.346665] [<ffffffff8133ee22>] ? btrfs_defrag_root+0x52/0xc0[343650.356022] [<ffffffff81372c47>] ? btrfs_ioctl_defrag+0x157/0x1a0[343650.365242] [<ffffffff81374020>] ? btrfs_ioctl+0xd90/0x27d0[343650.374374] [<ffffffff8117bc18>] ? path_openat+0xb8/0x650[343650.383372] [<ffffffff8117d4cc>] ? user_path_at_empty+0x6c/0xc0[343650.392252] [<ffffffff81088a88>] ? update_curr+0x118/0x1a0[343650.400990] [<ffffffff8108a70b>] ? put_prev_entity+0x7b/0x3f0[343650.409516] [<ffffffff81170d85>] ? cp_new_stat+0x115/0x130[343650.417772] [<ffffffff8117f8c0>] ? do_vfs_ioctl+0x2e0/0x4e0[343650.425801] [<ffffffff81170e73>] ? SYSC_newfstat+0x23/0x30[343650.433697] [<ffffffff8173bb84>] ? __schedule+0x234/0x8c0[343650.441398] [<ffffffff8117fb07>] ? SyS_ioctl+0x47/0xa0[343650.448792] [<ffffffff8173fcb6>] ? system_call_fastpath+0x16/0x1b[343650.455983] Code: a8 10 75 27 48 8b 45 00 f6 c4 20 75 1e f0 80 65 01 f7 48 c7 45 30 00 00 00 00 48 89 ef e8 69 21 dc ff eb c3 0f 1f 80 00 00 00 00 <0f> 0b 66 66 66 66 66 2e 0f 1f 84 00 00 00 00 00 55 53 48 89 fb [343650.479201] RIP [<ffffffff8135fc00>] btrfs_release_extent_buffer_page+0xf0/0x100[343650.487143] RSP <ffff88017c63fc48>[343650.495173] ---[ end trace 51f40fe493514bc8 ]--- now there are two more user-processes in D and D+ state, so maybe the user-process I mentioned in the first post is not the cause, but just the consequencethere is also a new line in dmesg:[355879.321672] BTRFS: defrag_file cancelledit is like 3.5 hours after the kernel bugI think it's a different manifestation of a bug that's being fixed in.Guessed from the crash report, it's a BUG_ON on the test_bit with BUFFER_DIRTY, that's the same as the BUG_ON(extent_buffer_under_io) from the referenced patch.4574 if (PagePrivate(page) &&4575 page->private == (unsigned long)eb) {4576 BUG_ON(test_bit(EXTENT_BUFFER_DIRTY, &eb->bflags));4577 BUG_ON(PageDirty(page));4578 BUG_ON(PageWriteback(page));I tried the patch mentioned at the end of your link, but I still get the same error. Also my machine has just 2 cpus. It happened in the dir defrag part.[109581.144481] ------------[ cut here ]------------[109581.152420] Kernel BUG at ffffffff8135fc00 [verbose debug info unavailable][109581.160779] invalid opcode: 0000 [#1] SMP [109581.169035] Modules linked in: bridge stp llc xt_conntrack iptable_filter xt_nat iptable_nat nf_conntrack_ipv4 nf_defrag_ipv4 nf_nat_ipv4 nf_nat nf_conntrack ip_tables x_tables[109581.186654] CPU: 0 PID: 8779 Comm: btrfs Not tainted 4.0.0 #12[109581.195505] Hardware name: HP ProLiant MicroServer, BIOS O41 10/01/2013[109581.204598] task: ffff88032f5e0c60 ti: ffff88007cc08000 task.ti: ffff88007cc08000[109581.213871] RIP: 0010:[<ffffffff8135fc00>] [<ffffffff8135fc00>] btrfs_release_extent_buffer_page+0xf0/0x100[109581.232467] RSP: 0018:ffff88007cc0bc48 EFLAGS: 00010202[109581.242094] RAX: 0000000000000001 RBX: ffff8803441a3af0 RCX: ffff8800db50e491[109581.251886] RDX: 0000000000000000 RSI: ffff880119368b68 RDI: ffff8803441a3af0[109581.261585] RBP: ffff8803ffd16000 R08: 0000000000000000 R09: ffff880119368b68[109581.271432] R10: ffff88007cc0bc40 R11: 0000000000000000 R12: ffff8803441a3af0[109581.281192] R13: 0000000000000005 R14: 0000000000000000 R15: ffff88025fd12750[109581.290837] FS: 00007f4a05497c40(0000) GS:ffff88041fc00000(0000) knlGS:0000000000000000[109581.300500] CS: 0010 DS: 0000 ES: 0000 CR0: 000000008005003b[109581.309928] CR2: 00007f56fac81041 CR3: 000000030ce8f000 CR4: 00000000000007f0[109581.319444] Stack:[109581.328748] ffff8803441a3af0 ffff8803441a3af0 ffff8803ffd16000 ffff88025fd127d0[109581.338424] ffff88007cc0bce7 ffffffff8135fc4d 0c00000000002663 ffff88025fd127b0[109581.348040] ffff88025fd12750 ffffffff81314021 ffff88025fd12750 ffff8800dfb5db80[109581.357638] Call Trace:[109581.366970] [<ffffffff8135fc4d>] ? release_extent_buffer+0x3d/0xe0[109581.376652] [<ffffffff81314021>] ? btrfs_release_path+0x21/0xa0[109581.386394] [<ffffffff813140ae>] ? btrfs_free_path+0xe/0x30[109581.396000] [<ffffffff813541bf>] ? btrfs_defrag_leaves+0x22f/0x360[109581.405531] [<ffffffff8133ee22>] ? btrfs_defrag_root+0x52/0xc0[109581.414874] [<ffffffff81372c47>] ? btrfs_ioctl_defrag+0x157/0x1a0[109581.424084] [<ffffffff81374020>] ? btrfs_ioctl+0xd90/0x27d0[109581.433176] [<ffffffff8117bc18>] ? path_openat+0xb8/0x650[109581.442198] [<ffffffff8117d4cc>] ? user_path_at_empty+0x6c/0xc0[109581.451103] [<ffffffff8117d5c5>] ? do_filp_open+0x45/0xc0[109581.459843] [<ffffffff81170d85>] ? cp_new_stat+0x115/0x130[109581.468282] [<ffffffff8117f8c0>] ? do_vfs_ioctl+0x2e0/0x4e0[109581.476492] [<ffffffff81170e73>] ? SYSC_newfstat+0x23/0x30[109581.484457] [<ffffffff8117fb07>] ? SyS_ioctl+0x47/0xa0[109581.492248] [<ffffffff8173fcb6>] ? system_call_fastpath+0x16/0x1b[109581.499928] Code: a8 10 75 27 48 8b 45 00 f6 c4 20 75 1e f0 80 65 01 f7 48 c7 45 30 00 00 00 00 48 89 ef e8 69 21 dc ff eb c3 0f 1f 80 00 00 00 00 <0f> 0b 66 66 66 66 66 2e 0f 1f 84 00 00 00 00 00 55 53 48 89 fb [109581.523654] RIP [<ffffffff8135fc00>] btrfs_release_extent_buffer_page+0xf0/0x100[109581.531583] RSP <ffff88007cc0bc48>[109581.539556] ---[ end trace ddc185d03ce12e6b ]---In fact, it is a regression. The bug does not exist in 3.19.8, but it is present in 4.0.0.I did the bisecting, it was long, as a single run of "find /home -type d -print0 | xargs -0 btrfs filesystem defragment -f -clzo" takes around 4 hours. I did two runs, to be sure kernel is good.The results of bisecting are surprising:git bisect start# bad: [39a8804455fb23f09157341d3ba7db6d7ae6ee76] Linux 4.0git bisect bad 39a8804455fb23f09157341d3ba7db6d7ae6ee76# good: [fcf4fe0e3e820408890ae137a684e56010c55f99] Linux 3.19.8git bisect good fcf4fe0e3e820408890ae137a684e56010c55f99# good: [bfa76d49576599a4b9f9b7a71f23d73d6dcff735] Linux 3.19git bisect good bfa76d49576599a4b9f9b7a71f23d73d6dcff735# bad: [e29876723f7cb7728f0d6a674d23f92673e9f112] Merge tag 'usb-3.20-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/gregkh/usbgit bisect bad e29876723f7cb7728f0d6a674d23f92673e9f112# good: [3e63430a5cc26bc90a6e33ab33f901196b7b63ac] Merge tag 'media/v3.20-1' of git://git.kernel.org/pub/scm/linux/kernel/git/mchehab/linux-mediagit bisect good 3e63430a5cc26bc90a6e33ab33f901196b7b63ac# good: [6b00f7efb5303418c231994c91fb8239f5ada260] Merge tag 'arm64-upstream' of git://git.kernel.org/pub/scm/linux/kernel/git/arm64/linuxgit bisect good 6b00f7efb5303418c231994c91fb8239f5ada260# bad: [c7d7b98671552abade78834c522b7308bda73c0d] Merge tag 'for-f2fs-3.20' of git://git.kernel.org/pub/scm/linux/kernel/git/jaegeuk/f2fsgit bisect bad c7d7b98671552abade78834c522b7308bda73c0d# good: [cdd305454ebd181fa35b648c0921fe7df27d6f3b] Merge tag 'devicetree-for-3.20' of git://git.kernel.org/pub/scm/linux/kernel/git/robh/linuxgit bisect good cdd305454ebd181fa35b648c0921fe7df27d6f3b# good: [6918584aad8e9c6b9a9be74b15bf9e7dafc2d691] lib/percpu_ida.c: remove redundant includesgit bisect good 6918584aad8e9c6b9a9be74b15bf9e7dafc2d691# good: [8494bcf5b7c4b2416687e233dd34d4c6b6fe5653] Merge branch 'for-3.20/drivers' of git://git.kernel.dk/linux-blockgit bisect good 8494bcf5b7c4b2416687e233dd34d4c6b6fe5653# good: [f28e503429644a794d9bf2793189ff0b0887eb21] f2fs: use f2fs_radix_tree_insert to clean codesgit bisect good f28e503429644a794d9bf2793189ff0b0887eb21# good: [60a3b782b1aaf6e5f8c4f92e99302c48a26d475b] f2fs: avoid variable length arraygit bisect good 60a3b782b1aaf6e5f8c4f92e99302c48a26d475b# good: [cf35248768b08851a26c16059ebca49dc4ad314f] dm crypt: update url in CONFIG_DM_CRYPT help textgit bisect good cf35248768b08851a26c16059ebca49dc4ad314f# good: [a4afe76b2b922e6197944d7be0be7a18b53175ae] dm: inherit QUEUE_FLAG_SG_GAPS flags from underlying queuesgit bisect good a4afe76b2b922e6197944d7be0be7a18b53175ae# bad: [818099574b04c5301eacbbcd441022b353a65466] Merge branch 'akpm' (patches from Andrew)git bisect bad 818099574b04c5301eacbbcd441022b353a65466# bad: [802ea9d8645d33d24b7b4cd4537c14f3e698bde0] Merge tag 'dm-3.20-changes' of git://git.kernel.org/pub/scm/linux/kernel/git/device-mapper/linux-dmgit bisect bad 802ea9d8645d33d24b7b4cd4537c14f3e698bde0# first bad commit: [802ea9d8645d33d24b7b4cd4537c14f3e698bde0] Merge tag 'dm-3.20-changes' of git://git.kernel.org/pub/scm/linux/kernel/git/device-mapper/linux-dmSo dm-3.20? I also had scsi_mod.use_blk_mq=1, which comes new in this commit.I have tried scsi_mod.use_blk_mq=0 with 4.0.0 kernel, but it does not help. The bug is still present. Must be something else from this commit.I have done another bisect with four defrags in a loop, but it looks like sometimes even more than four is needed to catch the bug. It runs now at speed around 2.5 hours per loop. I'll try to increase to 8...The probably wrong results from 4 loops:git bisect start# bad: [39a8804455fb23f09157341d3ba7db6d7ae6ee76] Linux 4.0git bisect bad 39a8804455fb23f09157341d3ba7db6d7ae6ee76# good: [bfa76d49576599a4b9f9b7a71f23d73d6dcff735] Linux 3.19git bisect good bfa76d49576599a4b9f9b7a71f23d73d6dcff735# bad: [e29876723f7cb7728f0d6a674d23f92673e9f112] Merge tag 'usb-3.20-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/gregkh/usbgit bisect bad e29876723f7cb7728f0d6a674d23f92673e9f112# good: [3e63430a5cc26bc90a6e33ab33f901196b7b63ac] Merge tag 'media/v3.20-1' of git://git.kernel.org/pub/scm/linux/kernel/git/mchehab/linux-mediagit bisect good 3e63430a5cc26bc90a6e33ab33f901196b7b63ac# good: [6b00f7efb5303418c231994c91fb8239f5ada260] Merge tag 'arm64-upstream' of git://git.kernel.org/pub/scm/linux/kernel/git/arm64/linuxgit bisect good 6b00f7efb5303418c231994c91fb8239f5ada260# bad: [c7d7b98671552abade78834c522b7308bda73c0d] Merge tag 'for-f2fs-3.20' of git://git.kernel.org/pub/scm/linux/kernel/git/jaegeuk/f2fsgit bisect bad c7d7b98671552abade78834c522b7308bda73c0d# good: [cdd305454ebd181fa35b648c0921fe7df27d6f3b] Merge tag 'devicetree-for-3.20' of git://git.kernel.org/pub/scm/linux/kernel/git/robh/linuxgit bisect good cdd305454ebd181fa35b648c0921fe7df27d6f3b# good: [6918584aad8e9c6b9a9be74b15bf9e7dafc2d691] lib/percpu_ida.c: remove redundant includesgit bisect good 6918584aad8e9c6b9a9be74b15bf9e7dafc2d691# bad: [8494bcf5b7c4b2416687e233dd34d4c6b6fe5653] Merge branch 'for-3.20/drivers' of git://git.kernel.dk/linux-blockgit bisect bad 8494bcf5b7c4b2416687e233dd34d4c6b6fe5653# bad: [6bec0035286119eefc32a5b1102127e6a4032cb2] Merge branch 'for-3.20/bdi' of git://git.kernel.dk/linux-blockgit bisect bad 6bec0035286119eefc32a5b1102127e6a4032cb2# good: [1b30e66f5acc6bf22fff49d4093cf17454f914b7] md: minor cleanup in safe_delay_store.git bisect good 1b30e66f5acc6bf22fff49d4093cf17454f914b7# bad: [c4db59d31e39ea067c32163ac961e9c80198fd37] fs: don't reassign dirty inodes to default_backing_dev_infogit bisect bad c4db59d31e39ea067c32163ac961e9c80198fd37# good: [495a276e1ca96af622edb67ad0f85431935b20d2] block_dev: get bdev inode bdi directly from the block devicegit bisect good 495a276e1ca96af622edb67ad0f85431935b20d2# bad: [b83ae6d421435c6204150300f1c25bfbd39cd62b] fs: remove mapping->backing_dev_infogit bisect bad b83ae6d421435c6204150300f1c25bfbd39cd62b# bad: [de1414a654e66b81b5348dbc5259ecf2fb61655e] fs: export inode_to_bdi and use it in favor of mapping->backing_dev_infogit bisect bad de1414a654e66b81b5348dbc5259ecf2fb61655e# bad: [26ff13047e3dc6c0230a629867e8dbd4a15a7626] nilfs2: set up s_bdi like the generic mount_bdev codegit bisect bad 26ff13047e3dc6c0230a629867e8dbd4a15a7626# first bad commit: [26ff13047e3dc6c0230a629867e8dbd4a15a7626] nilfs2: set up s_bdi like the generic mount_bdev codeI don't think it's a regression, the bug(s) are just hard to hit and highly depend on timings.My analysis of the crash site inis wrong, it's not the BUFFER_DIRTY bugon but the next one, PageDirty. And this is the fix:(on the way to 4.1).Thanks for doing the bisections, must have been "fun". I'll queue the fix for 4.0 stable.I don't know what tricked me, but the patch has been merged to 3.17, reopening.You may be right, the bug is definitely hard to hit, but I still have the feeling it is a regression.I've discovered it still happens for 3.19.0, so the starting points for the bisection were wrong. Actually I didn't have the 3.19.x for very long time before 4.0.0, so maybe I missed the bug in 3.19, but 3.18 was there for long time and it never happened.Anyway, I continue the bisection fun, now between 3.18 and 3.19.I have the defrag 16 times in a loop, but as a side-effect, after so many runs the data on the disk are no more disordered as before. To counter that in each loop I unpack some old backups in a temporary location (about 1.6GB), to create some additional entropy.Till now it is not finished, but it looks like this:git bisect start# good: [b2776bf7149bddd1f4161f14f79520f17fc1d71d] Linux 3.18git bisect good b2776bf7149bddd1f4161f14f79520f17fc1d71d# bad: [bfa76d49576599a4b9f9b7a71f23d73d6dcff735] Linux 3.19git bisect bad bfa76d49576599a4b9f9b7a71f23d73d6dcff735# bad: [54850e73e86e3bc092680d1bdb84eb322f982ab1] zram: change parameter from vaild_io_request()git bisect bad 54850e73e86e3bc092680d1bdb84eb322f982ab1# good: [6b9e2cea428cf7af93a84bcb865e478d8bf1c165] Merge tag 'for_linus' of git://git.kernel.org/pub/scm/linux/kernel/git/mst/vhostgit bisect good 6b9e2cea428cf7af93a84bcb865e478d8bf1c165# good: [b5f185f33d0432cef6ff78765e033dfa8f4de068] Merge tag 'master-2014-12-08' of git://git.kernel.org/pub/scm/linux/kernel/git/linville/wireless-nextgit bisect good b5f185f33d0432cef6ff78765e033dfa8f4de068# bad: [bae41e45b7400496b9bf0c70c6004419d9987819] Merge tag 'sound-3.19-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/tiwai/soundgit bisect bad bae41e45b7400496b9bf0c70c6004419d9987819# good: [45cbdda46b3c7f225e9c7e48aa72f0479f832ea2] Merge remote-tracking branches 'asoc/topic/twl6040', 'asoc/topic/uda134x', 'asoc/topic/uda1380' and 'asoc/topic/wl1273' into asoc-nextgit bisect good 45cbdda46b3c7f225e9c7e48aa72f0479f832ea2# good: [77de61c3975da6f2200935c341e84018ece6ce36] Merge branch 'for-next' into for-linusgit bisect good 77de61c3975da6f2200935c341e84018ece6ce36# bad: [413fd0e3fbf52873f2310eb75bfa6c7b72847277] Merge tag 'fbdev-3.19' of git://git.kernel.org/pub/scm/linux/kernel/git/tomba/linuxgit bisect bad 413fd0e3fbf52873f2310eb75bfa6c7b72847277# good: [5a8bf632fbf2f81c6483b124da5b2bde9ea73981] OMAPDSS: hdmi: Make hdmi_mode_has_audio() more user friedlygit bisect good 5a8bf632fbf2f81c6483b124da5b2bde9ea73981We have like 2 spurious reports of the "EXTENT_BUFFER_DIRTY" bug_on since 2013. The performance of btrfs is gradually improving in small steps so races start to appear more frequently once a "magical speed" threshold is tripped. There are more recent bugs that match that pattern.Briefly looking at the history of find_buffer_extent, it's hard to say where the bug could have been introduced. The lower bound is ~2010 (19fe0a8b787d7c7f9318975b5a8c6e7e5e54e925), the structures were switched from rb_tree to radix-tree.I think it's not worth the time to continue bisecting.
id=47421	I have problems with Samsung SCX-3205 scanner on Toshiba Satellite L855. When is scanner connected to the notebook (via USB) I can see it via `scanimage -L` on first attempt but on any other attempt I can't see it any more, unless I turn the scanner off and on.Currently using 3.5.3-1.fc17.x86_64 kernel (but it also happens with 3.6.0-0.rc4.git2.1.fc18). The latest working kernel is 2.6.39-1.fc16 on that hardware (2.6.40 which was in fact 3.0, I guess, does not work).That scanner with identical OS - Fedora 17 - worked well on Lenovo T510 (Sandy Bridge -- USB 2.0 only), the new Toshiba L855 (Ivy Bridge with USB 3.0 -- xHCI) fails here.I somehow think it's related to the xhci driver, hence Cc-ing Sarah. Is there a way how to disable xhci driver in favor of ehci (xhci and ehci are both compiled-in), so I can try with ehci? Createdlspci.2.6.39-1.fc16.x86_64Createdlspci.3.5.3-1.fc17.x86_64Createdlspci-v.2.6.39-1.fc16.x86_64Createdlspci-v.3.5.3-1.fc17.x86_64Createdlspci-vv.2.6.39-1.fc16.x86_64Createdlspci-vv.3.5.3-1.fc17.x86_64Createdlsusb.2.6.39-1.fc16.x86_64Createdlsusb.3.5.3-1.fc17.x86_64Createdlsusb-v.2.6.39-1.fc16.x86_64Createdlsusb-v.3.5.3-1.fc17.x86_64Createdlsusb-vv.2.6.39-1.fc16.x86_64Createdlsusb-vv.3.5.3-1.fc17.x86_64On Wed, Sep 12, 2012 at 05:06:16PM +0000,wrote:Please post this on themailing list.If this is still seen with modern kernels please updateIt works for me with kernel-3.12.5-302.fc20.x86_64.What update should I provide?It worked for a while but I had to return to USB2 via EHCI. The symptoms are the same: with USB3 via xHCI the scanner appears in output of `scanimage -L` but disappears on second (or any other) attempt to initialize it via scanimage. Reopening.Knowing that it fails on 3.12 is the information needed.This may well not be a kernel bug - some USB1/2 hardware fails on USB3 controllers even though it should all be compatible. From a quick search all the reports I see are Linux rather than Windows however.I suspect this is due to a long-standing xHCI driver bug. There's a proposed fix, but it's still in RFC:Michal: can you try applying that patch and see if it helps?Another related bug report, for reference:Createdkernel warnings with the patch from previous commentTried that patch on top of 3.13.0-0.rc6.git0.1 and it works for me. Tried `simple-scan`, `xsane`, and `scan-image`. However I get kernel warnings when the program e.g. xsane starts and ends. Also especially xsane became sluggish when asked to turn itself off.Kernel warnings follow in the attachment.Thanks for testing Michal. Ok, so I know what the root cause of your issue is. It's not surprising that the patch has race conditions that cause list corruption, since it was a pretty early RFC. I'll need to take the patch and rework it a bit before I get the race conditions worked out.In the meantime, have you tried unplugging and replugging the scanner in between scans? This has worked in the past for other people with this issue.(In reply to Sarah Sharp from)Have to say, I did not at that time. Luckily, this is not needed anymore.I just tested kernel-3.19.3-200.fc21.x86_64 with USB3 with the Samsung scanner and it worked fine for a resolution of 150 DPI, and less. With 300 DPI it got sluggish, the scanning device moved 1 cm ahead and then 0.5 cm back, all the time, I got the scan in the end but the scanning process was one fold slower that with USB2. With DPI set to 2400 it got practically unusable.There were no messages of interest in systemd's journal.Let me know if there's anything I can do to help.Surprisingly, with kernel-4.1.2-200.fc22.x86_64 everything works as expected up to 2400 DPI (the maximum for the scanner).The only concern I have is following message I have three times in the kernel log for 150 DPI scanning, and 42 times for 300 DPI scanning: xhci_hcd 0000:00:14.0: WARN Event TRB for slot 4 ep 6 with no TDs queued?
id=84141	In Linux, when a keyboard is plugged in, it always start with all its LEDs off, even if the active console is in Caps Lock mode.Also, when two keyboards are connected, e.g. a laptop keyboard and a desktop keyboard, the LED state is inconsistent: Pressing Caps Lock in a keyboard has the effect of writing uppercase in both keyboards, but only the LED of the keyboard whose key was pressed is toggled. This works in console, what you describe happens in X which controls LED state by itself.Hmm... It seems they are actually synchronized in tty, but when a new keyboard has just been plugged.Steps to reproduce:1. Login in a tty.2. Press Caps Lock to turn the LED on.3. Plug a second keyboard.The new keyboard starts with the LED off.*but not when a new keyboard has just been plugged.
id=8740	Most recent kernel where this bug did not occur: 2.6.22-1.686 (Trunk Kernel)Distribution: Debian Unstable Hardware:lontra@debian:~$ lspci00:00.0 Host bridge: Intel Corporation Mobile 945GM/PM/GMS/940GML and 945GT Express Memory Controller Hub (rev 03)00:02.0 VGA compatible controller: Intel Corporation Mobile 945GM/GMS/940GML Express Integrated Graphics Controller (rev 03)00:02.1 Display controller: Intel Corporation Mobile 945GM/GMS/940GML Express Integrated Graphics Controller (rev 03)00:1b.0 Audio device: Intel Corporation 82801G (ICH7 Family) High Definition Audio Controller (rev 02)00:1c.0 PCI bridge: Intel Corporation 82801G (ICH7 Family) PCI Express Port 1 (rev 02)00:1c.1 PCI bridge: Intel Corporation 82801G (ICH7 Family) PCI Express Port 2 (rev 02)00:1d.0 USB Controller: Intel Corporation 82801G (ICH7 Family) USB UHCI #1 (rev 02)00:1d.1 USB Controller: Intel Corporation 82801G (ICH7 Family) USB UHCI #2 (rev 02)00:1d.2 USB Controller: Intel Corporation 82801G (ICH7 Family) USB UHCI #3 (rev 02)00:1d.3 USB Controller: Intel Corporation 82801G (ICH7 Family) USB UHCI #4 (rev 02)00:1d.7 USB Controller: Intel Corporation 82801G (ICH7 Family) USB2 EHCI Controller (rev 02)00:1e.0 PCI bridge: Intel Corporation 82801 Mobile PCI Bridge (rev e2)00:1f.0 ISA bridge: Intel Corporation 82801GBM (ICH7-M) LPC Interface Bridge (rev 02)00:1f.2 IDE interface: Intel Corporation 82801GBM/GHM (ICH7 Family) Serial ATA Storage Controller IDE (rev 02)00:1f.3 SMBus: Intel Corporation 82801G (ICH7 Family) SMBus Controller (rev 02)03:00.0 Network controller: Broadcom Corporation Dell Wireless 1390 WLAN Mini-PCI Card (rev 01)05:01.0 Ethernet controller: Realtek Semiconductor Co., Ltd. RTL-8139/8139C/8139C+ (rev 10)05:04.0 CardBus bridge: ENE Technology Inc CB1410 Cardbus Controller (rev 01)05:06.0 FireWire (IEEE 1394): Ricoh Co Ltd Unknown device 083205:06.1 Generic system peripheral [0805]: Ricoh Co Ltd R5C822 SD/SDIO/MMC/MS/MSPro Host Adapter (rev 19)05:06.2 System peripheral: Ricoh Co Ltd Unknown device 0843 (rev 01)05:06.3 System peripheral: Ricoh Co Ltd R5C592 Memory Stick Bus Host Adapter (rev 0a)05:06.4 System peripheral: Ricoh Co Ltd xD-Picture Card Controller (rev 05)Hardware Environment: Output from lspciProblem Description:When using my synaptics touchpad in X my mouse becomes unusable either freezing or jumping around the screen. Originally this seemed to be related to downloading at high rates now it seems to be very sporadic but occurring much more frequently perhaps when the CPU is under a high load. When my mouse freezes it takes a few seconds to resync and then becomes usuable again until it freezes again. My mouse will become unusable several times in 10 minutes essentially rendering it unusable. This occurs under a variety of distributions but appears to have only started to occur since the 2.6.18 series. Here is the output from dmesg:psmouse.c: TouchPad at isa0060/serio4/input0 lost sync at byte 1psmouse.c: Failed to reset mouse on isa0060/serio1psmouse.c: TouchPad at isa0060/serio4/input0 lost sync at byte 1psmouse.c: TouchPad at isa0060/serio4/input0 lost sync at byte 1psmouse.c: TouchPad at isa0060/serio4/input0 lost sync at byte 1psmouse.c: TouchPad at isa0060/serio4/input0 lost sync at byte 1psmouse.c: issuing reconnect requestinput: PS/2 Generic Mouse as /class/input/input10psmouse.c: Failed to enable mouse on isa0060/serio1psmouse.c: Mouse at isa0060/serio1/input0 lost synchronization, throwing 1 bytes away.psmouse.c: TouchPad at isa0060/serio4/input0 lost sync at byte 1psmouse.c: TouchPad at isa0060/serio4/input0 lost sync at byte 1psmouse.c: TouchPad at isa0060/serio4/input0 lost sync at byte 1psmouse.c: TouchPad at isa0060/serio4/input0 lost sync at byte 1psmouse.c: TouchPad at isa0060/serio4/input0 - driver resynched.psmouse.c: TouchPad at isa0060/serio4/input0 lost sync at byte 1psmouse.c: TouchPad at isa0060/serio4/input0 lost sync at byte 1psmouse.c: TouchPad at isa0060/serio4/input0 lost sync at byte 1psmouse.c: TouchPad at isa0060/serio4/input0 lost sync at byte 1psmouse.c: TouchPad at isa0060/serio4/input0 lost sync at byte 1psmouse.c: issuing reconnect requestpsmouse.c: failed to re-enable mouse on isa0060/serio1psmouse.c: resync failed, issuing reconnect requestbcm43xx: Error: Microcode "bcm43xx_microcode5.fw" not available or load failed.bcm43xx: core_up for active 802.11 core failed (-2)bcm43xx: Error: Microcode "bcm43xx_microcode5.fw" not available or load failed.bcm43xx: core_up for active 802.11 core failed (-2)This doesn't seem to be related to bcm43xx becauses when i remove the module (via rmmod bcm43xx) this problem still occurs.Steps to reproduce:Seems to be sporadic but when I am visiting gmail.com it always happens. Does it help if you boot with "ec_intr=2" on the kernel command line? What about acpi=off?Neither ec_intr=2 nor acpi=off helped. The problem was still occurring. FYI, the laptop I am using is a Lenovo 3000 n100. Thanks for the prompt response!ChrisOk, so you are saying that 2.6.17 was ok but since 2.6.18 things went bad? COuld you try narrow it down to a specific 2.6.18-rcX release?Sorry. Post-2.6.18 it seemed to go bad. However, I just bought this laptop a few months ago and the 2.6.18 worked relatively well. I didn't test any kernel earlier than 2.6.18. The kernel 2.6.18-4-686 in Debian Etch worked well here but because of lack of support for brightness and other hardware I upgraded to the 2.6.22-1 kernel. I experienced some issues with losing sync bytes in 2.6.18-4 but not like in the 2.6.22-1 kernel. It froze up but very rarely.Also I do not believe this is an issue of broken hardware as my laptop is very new. Cheers,ChrisHmm. Do you really have external mouse attached? Or do you have only touchpad and kernel is confused?On Tuesday 17 July 2007 10:14:54 am you wrote:>>>>>I have a Synaptics Touchpad and when my mouse becomes unresponsive I use a usb mouse.No, I mean external PS/2 mouse?On Tuesday 17 July 2007 03:52:52 pm you wrote:>>>>>There is no external PS/2 mouse. I just have my built-in Synaptics Touchpad and the usb mouse. I don't believe it's being confused by the mouse as this is occurring before I insert the mouse into the usb slot.However the kernel managed to detect one ;) Could you post your /proc/bus/input/devices?On Tuesday 17 July 2007 09:32:49 pm you wrote:[lontra@localhost ~]$ cat /proc/bus/input/devicesI: Bus=0017 Vendor=0001 Product=0001 Version=0100N: Name="Macintosh mouse button emulation"P: Phys=S: Sysfs=/class/input/input0H: Handlers=mouse0 event0B: EV=7B: KEY=70000 0 0 0 0 0 0 0 0B: REL=3I: Bus=0011 Vendor=0002 Product=0007 Version=0000N: Name="SynPS/2 Synaptics TouchPad"P: Phys=isa0060/serio4/input0S: Sysfs=/class/input/input1H: Handlers=mouse1 event1B: EV=bB: KEY=6420 0 70000 0 0 0 0 0 0 0 0B: ABS=11000003I: Bus=0011 Vendor=0001 Product=0001 Version=ab41N: Name="AT Translated Set 2 keyboard"P: Phys=isa0060/serio0/input0S: Sysfs=/class/input/input2H: Handlers=kbd event2B: EV=120013B: KEY=4 2000000 3802078 f840d001 feffffdf ffefffff ffffffff fffffffeB: MSC=10B: LED=7I: Bus=0003 Vendor=046d Product=c03d Version=0110N: Name="Logitech USB-PS/2 Optical Mouse"P: Phys=usb-0000:00:1d.3-1/input0S: Sysfs=/class/input/input3H: Handlers=mouse2 event3B: EV=7B: KEY=70000 0 0 0 0 0 0 0 0B: REL=103I: Bus=0010 Vendor=001f Product=0001 Version=0100N: Name="PC Speaker"P: Phys=isa0061/input0S: Sysfs=/class/input/input4H: Handlers=kbd event4B: EV=40001B: SND=6I: Bus=0019 Vendor=0000 Product=0002 Version=0000N: Name="Power Button (FF)"P: Phys=button_power/button/input0S: Sysfs=/class/input/input5H: Handlers=kbd event5B: EV=3B: KEY=100000 0 0 0I: Bus=0019 Vendor=0000 Product=0005 Version=0000N: Name="Lid Switch"P: Phys=PNP0C0D/button/input0S: Sysfs=/class/input/input6H: Handlers=event6B: EV=21B: SW=1I: Bus=0019 Vendor=0000 Product=0001 Version=0000N: Name="Power Button (CM)"P: Phys=PNP0C0C/button/input0S: Sysfs=/class/input/input7H: Handlers=kbd event7B: EV=3B: KEY=100000 0 0 0OK, what about booting with i8042.nomux? Does the box have external PS/2 ports?Hello, I have the same problem on a Lenovo 3000 C200.Here my bug report(with some additional information: dmesg, /proc/bus/input/devices file, emerge --info...)I tried with i8042.nomux=1 (see my dmesg ->)It's seem to be better with "nomux=1" but I still lost sync (see the newdmesg).I don't have any external PS/2 ports.Thank you.I do have the same problem, but I have a differnet hardware (seewhich I am maintaing)In my case I am 99% sure that i8042.nomux=1 is totally working it around; the bug is coupled with this old oneThese laptops do have PS2 plugs but they're hard-wired to the keyboard and mouse; theorically, if I would open it I could wire an external keyboard. I have also heard that there are more than the usual 2 PS2 plugs, but I am not sure about this.My feeling is that ACPIPNP is causing the kernel to "eat" some mouse/keyboard IRQs; I am available for further testing.Note: I do have a good amount of C programming experience (for what matters here: sockets, low level hardware, data crunching etc.) but I am relatively new to linux (2 years), and absolutely new to kernel hacking (installed Gentoo on June) - I should be able to understand and try some more technical testcasesCreatedlegolas558.devicesmy /proc/bus/input/devices - note that I have a Synaptics PS/2 Touchpad (integrated)I do use ipw2100 for the wireless LAN and I can remember the problem did not happen when the module was not loaded (tested only with 2.6.22), e.g. when the wireless adaptor was not ON.I am confirming both the issue and the workaround i8042.nomux=1 on my Acer Travelmate 243LC. This problem is clearly an ACPI issue: the symptoms are shown only if at least one of the following acpi modules is loaded: ac, battery, thermal. If I unload all three of them, my touchpad doesn't lose sync.Daniele, Erik,In, Chris (the submitter of this bug) notedthat the issue at hand does not go away with "acpi=off".By definition, that means this bug report has nothing to do with ACPI.If you have an issue which does go away with "acpi=off",then I invite you to submit a new sighting in the ACPI category,or contribute to an existing one, such as.Using acpi=off does nothing. Only i8042.nomux=1 does work around the bugI have managed to track down the cause of my Synaptics touchpad issue. My problem is associated with the orinoco_cs module or a related module. When I use my onboard wireless card using ndiswrapper I do not experience this problem but when I use my Orinoco card which uses the orinoco_cs module I am unable to surf the internet, download, etc. and use my touchpad.This is still present on the 2.6.23 kernel in Fedora too.For me the problem is present for every kernel from 2.6.22 - 2.6.24. I have discovered recently that the problem only exists on the 32-bit x86 architecture, the 64-bit has no such problem. I a this on both 32-bit and 64-bit editions of Fedora and Ubuntu.The current workaround is still i8042.nomux=1, can somebody please confirm this?It didn't resolve the problem completely when I tried on my 2.6.21 kernel ().I'm now using a gentoo-sources-2.6.25 and I haven't seen the problem since.However I had some kernel or X freeze (can't remember) but I don't know if it's related to this kernel option.I also saw that someone was complaining for the same problem using Windows XP.On LDLC (french) (I bough mine there as well):Comment title: "Affichage pointeur souris laisse à désirer".Link:Hi all, i've linked the LP #119194 with this bug as it seems these are the same one,And with LP bug #34501Thanks againI am not sure if this bug is linked to LP #119194, I have never seen parity errors on my caseI have to add that this happens with 2.6.27 on a T400. Setting i8042.nomux=1does _not_ help in my case.Another hint I found somewhere was using i8042.dumbkbd=1, but that did not help here either.I did get some relief, it seems, by setting# echo -n 1 > /sys/devices/platform/i8042/serio1/resetafterOf course, this is just a work-around.I am *NO MORE* using i8042.nomux=1 with kernel 2.6.27-7 (Ubuntu Intrepid Ibex), it seems having been fixed either by activation of nomux through a DMI match or in the kernel source code somewhere.Can somebody please confirm that i8042.nomux=1 is no more necessary to workaround this bug?(In reply to)The i8042.nomux=1 kernel parameter is still necessary.Perhaps we need a patch...(read on)perhaps acpi_osi=Linux can work around the problem (in place of i8042.nomux=1)This could be a duplicate of #12577, whose fix was just included in the Debian linux kernel. I’ll report here if it works for me with that.Unfortunately not. The patch () only patches alps, but here, on my ThinkPad T400, the synaptics driver grabs the device. Maybe a similar patch for the synaptics driver has to be produced?I can confirm that acpi_osi=Linux resolves the issue on x64 ubuntu 10.04 kernel 2.6.32-22If changing osi response indeed fixes the issue then ACPI guys will have to take a look here.Hi, all,does the problem still exist in the latest upstream kernel?On$ uname -aLinux kirk 2.6.36-rc6-amd64 #1 SMP Mon Oct 4 09:56:45 UTC 2010 x86_64 GNU/LinuxI still observer some issues:[ 52.011328] psmouse.c: TouchPad at isa0060/serio1/input0 lost sync at byte 1[ 52.011332] psmouse.c: issuing reconnect request[ 217.087051] psmouse.c: TouchPad at isa0060/serio1/input0 lost sync at byte 4[ 217.087058] psmouse.c: issuing reconnect request[ 287.894903] psmouse.c: TouchPad at isa0060/serio1/input0 lost synchronization, throwing 4 bytes away.[ 288.409026] psmouse.c: resync failed, issuing reconnect request[ 460.823615] psmouse.c: bad data from KBC - timeout[ 460.835107] psmouse.c: TouchPad at isa0060/serio1/input0 lost sync at byte 4[ 460.835113] psmouse.c: issuing reconnect request[ 466.644117] psmouse.c: Failed to enable mouse on synaptics-pt/serio0when having both trackpoint and touchpad enabled. It seems the problem occurs less than earlier (but this is just my impression), but it is definitely still present.marking as a regressionthe problem still exists in the latest upsteam kernel, right?bug closed as there is no response from the bug reporter.please re-open it if the problem still exists in the latest upstream kernel.On 3.2.0, I still have this problem:[ 55.444165] psmouse serio1: TouchPad at isa0060/serio1/input0 lost sync at byte 1[ 55.446370] psmouse serio1: TouchPad at isa0060/serio1/input0 lost sync at byte 1[ 55.448494] psmouse serio1: TouchPad at isa0060/serio1/input0 lost sync at byte 1[ 76.420802] psmouse serio1: TouchPad at isa0060/serio1/input0 lost sync at byte 1[ 76.423256] psmouse serio1: TouchPad at isa0060/serio1/input0 lost sync at byte 1[ 76.423258] psmouse serio1: issuing reconnect requestBut only once since system start so far. I’ll observe it some more...(It seems I lack rights to re-open the bug.)Yes, occurs more often, now also with different text:[ 55.444165] psmouse serio1: TouchPad at isa0060/serio1/input0 lost sync at byte 1[ 55.446370] psmouse serio1: TouchPad at isa0060/serio1/input0 lost sync at byte 1[ 55.448494] psmouse serio1: TouchPad at isa0060/serio1/input0 lost sync at byte 1[ 76.420802] psmouse serio1: TouchPad at isa0060/serio1/input0 lost sync at byte 1[ 76.423256] psmouse serio1: TouchPad at isa0060/serio1/input0 lost sync at byte 1[ 76.423258] psmouse serio1: issuing reconnect request[ 389.906979] psmouse serio1: TouchPad at isa0060/serio1/input0 lost sync at byte 1[ 389.909379] psmouse serio1: TouchPad at isa0060/serio1/input0 lost sync at byte 1[ 389.911666] psmouse serio1: TouchPad at isa0060/serio1/input0 lost sync at byte 1[ 389.943244] psmouse serio1: TouchPad at isa0060/serio1/input0 lost sync at byte 1[ 389.945504] psmouse serio1: TouchPad at isa0060/serio1/input0 lost sync at byte 1[ 389.945507] psmouse serio1: issuing reconnect request[ 650.377282] psmouse serio1: TouchPad at isa0060/serio1/input0 lost synchronization, throwing 5 bytes away.[ 650.888206] psmouse serio1: resync failed, issuing reconnect requestI have same trouble. Notebook Samsung 350u2b. Archlinux.Sometimes touchpad not workinkg.That happens when one finger in the lower right corner, and the other finger onthe center of the touchpad.$ xinput list | grep Touchpad⎜ ↳ ETPS/2 Elantech Touchpad id=12 [slave pointer (2)]$dmesg[ 4335.879836] psmouse serio1: Touchpad at isa0060/serio1/input0 lost sync atbyte 6[ 4335.908340] psmouse serio1: Touchpad at isa0060/serio1/input0 - driverresynced.[ 5018.411486] psmouse serio1: Touchpad at isa0060/serio1/input0 lost sync atbyte 6[ 5018.423943] psmouse serio1: Touchpad at isa0060/serio1/input0 - driverresynced.[ 5029.876019] psmouse serio1: Touchpad at isa0060/serio1/input0 lost sync atbyte 6[ 5029.897982] psmouse serio1: Touchpad at isa0060/serio1/input0 - driverresynced.Solution, Just reload psmouse module.$rmmod psmouse$modprobe psmouseKernel:$uname -aLinux samsung 3.5.4-1-ARCH #1 SMP PREEMPT Sat Sep 15 08:12:04 CEST 2012 x86_64GNU/Linux(In reply to)This is not Synaptics but Elantech touchpad. Could you please open a separate bug report for this?I'm moving this bug from acpi to drivers/input-dev, please correct me if this is not the right component, thanks.I have the same problem on kernel 3.8.3. I found this patch:And it solves the problem. Why it still isn't merged?The patch fromalso fixes the problem for me. Would be nice to see if it can be merged.This is my Touchpad model: psmouse serio1: synaptics: Touchpad model: 1, fw: 7.4, id: 0x1e0b1, caps: 0xd04773/0xe40000/0x5a0400, board id: 3655, fw id: 684465Since 3.9 this extremely bugs me. <3.9 only needed some seconds to get my psmouse up, but since 3.9 I get hangs during usage, may happen several times per minute - quite unusable :( Even worse it sometimes does not recover automatically and makes the whole keyboard unusable - no ctrl+alt+backspace, no shortcuts to fire up e17-everything. I need to sleep + resume my Laptop to get it working again. The first time this happened I thought I had a kernel deadlock. Good luck I just tried to get it Suspended before hard powering off...The weird thing: I did not enable TouchPad in the kernel, I did not install synaptics xorg-driver. I only use the TrackPoint from my Lenovo L520. The touchpad can't be enabled, it's "dead". But I get these errors:[198183.044677] psmouse serio4: TouchPad at isa0060/serio4/input0 lost sync at byte 4[198183.056488] psmouse serio4: TouchPad at isa0060/serio4/input0 lost sync at byte 4[198183.057870] psmouse serio4: TouchPad at isa0060/serio4/input0 lost sync at byte 1[198183.059166] psmouse serio4: TouchPad at isa0060/serio4/input0 lost sync at byte 1[198183.060198] psmouse serio4: TouchPad at isa0060/serio4/input0 lost sync at byte 1[198183.060205] psmouse serio4: issuing reconnect request[198821.998906] psmouse serio4: TouchPad at isa0060/serio4/input0 lost sync at byte 4[198822.000232] psmouse serio4: TouchPad at isa0060/serio4/input0 lost sync at byte 1[198822.019445] psmouse serio4: TouchPad at isa0060/serio4/input0 - driver resynced.If you think this is another issue I will open a new bug report.I just merged Eric's patch and it should be in 3.10, however if there was a significant regression in 3.9 compared to 3.8 that would mean there is another issue, probably outside of the input subsystem. I wonder if you will be to try bisecting this regression.I also had issues with my touchpad [1] in 3.8. Therefore I tested 3.10rc7 to if the patch brought improvement. I must admit compared to 3.8 it's definitely an improvement although the issue is not fixed completely.I still get the dmesg output [2] and I still get an unusable touchpad during heavily typing (just typing a lot a move the touchpad to reproduce). But in comparison to 3.8 it only takes 2 seconds until the touchpad works again (you just need to stop typing).The is also this patch from google [3]. Anyone tried it yet ?[1] psmouse serio4: synaptics: Touchpad model: 1, fw: 7.2, id: 0x1c0b1, caps: 0xd047b3/0xb40000/0xa0000, board id: 71, fw id: 578367[2] smouse serio4: issuing reconnect request[ 176.650713] psmouse serio4: TouchPad at isa0060/serio4/input0 lost sync at byte 4[ 176.652089] psmouse serio4: TouchPad at isa0060/serio4/input0 lost sync at byte 1[ 176.670212] psmouse serio4: TouchPad at isa0060/serio4/input0 - driver resynced.[ 179.109667] psmouse serio4: TouchPad at isa0060/serio4/input0 lost sync at byte 4[ 179.118082] psmouse serio4: TouchPad at isa0060/serio4/input0 lost sync at byte 4[ 179.119450] psmouse serio4: TouchPad at isa0060/serio4/input0 lost sync at byte 1[ 179.124539] psmouse serio4: TouchPad at isa0060/serio4/input0 lost sync at byte 1[ 179.140162] psmouse serio4: TouchPad at isa0060/serio4/input0 lost sync at byte 4[ 179.140175] psmouse serio4: issuing reconnect request[3]Tested Chromium's patch [1] on Kernel 3.8, with no improvement here.[1]Just a small update. I still have this issues in 3.11-rc2 on Lenovo L520.If you need an xev.log or similar, please have a look at Ubuntu's bugreport [1], where I recently filed all these.[1]ThinkPad-L520 with 3.2.0-53-generic and *still* and issue. Since 3.2.0-45 I have this problem and I have no idea how to fix it. I tried many things and none works.I have a new Thinkpad t440s which has this issue, where the touchpad loses sync every few minutes, sometimes resyncing successfully, sometimes locking up and requiring a modprobe psmouse to get going again. This happens with 3.11 and the latest kernel mainline 3.13.1-031301This is being tracked under the ubuntu tracker here:If you need any information, want anything tested, or if there is anything I can do to help fix this then please let me know.Given that the other bug is closed per hardware fail, this one can be closed too.For reference:I am seeing this issue with a Latitude E7440 on Arch Linux with the default 3.16.4 kernel.dmesg output related to this bug (systemd):[ 6135.425681] psmouse serio1: GlidePoint at isa0060/serio1/input0 lost sync at byte 1[ 6135.426716] psmouse serio1: GlidePoint at isa0060/serio1/input0 lost sync at byte 1[ 6135.427730] psmouse serio1: GlidePoint at isa0060/serio1/input0 lost sync at byte 1[ 6135.430819] psmouse serio1: GlidePoint at isa0060/serio1/input0 - driver resynced.[ 6943.621660] psmouse serio1: GlidePoint at isa0060/serio1/input0 lost sync at byte 1[ 6943.624732] psmouse serio1: GlidePoint at isa0060/serio1/input0 - driver resynced.[ 6943.625690] psmouse serio1: GlidePoint at isa0060/serio1/input0 lost sync at byte 1[ 6943.632644] psmouse serio1: GlidePoint at isa0060/serio1/input0 - driver resynced.[ 6943.633638] psmouse serio1: GlidePoint at isa0060/serio1/input0 lost sync at byte 1[ 6943.636722] psmouse serio1: GlidePoint at isa0060/serio1/input0 - driver resynced.uname -a:Linux george 3.16.4-1-ARCH #1 SMP PREEMPT Mon Oct 6 08:22:27 CEST 2014 x86_64 GNU/LinuxRelevant dmidecode info:Handle 0x0004, DMI type 8, 9 bytesPort Connector Information Internal Reference Designator: J1A1 Internal Connector Type: None External Reference Designator: PS2Mouse External Connector Type: PS/2 Port Type: Mouse PortHandle 0x0026, DMI type 21, 7 bytesBuilt-in Pointing Device Type: Touch Pad Interface: Bus Mouse Buttons: 2Relevant lsmod info:i8042 18002 2 libps2,dell_laptopserio 18282 6 serio_raw,atkbd,i8042,psmouseI recently bought an ASUS X553M laptop and have run into this problem. A few observations I would like to share:I downloaded and installed the live Fc20 version of Fedora. It came with a kernel version of 3.11.10-301.fc20.x86_64. The touchpad was working as a mouse - allowing cursor positioning and tapping.After installation the broadcom 4312 14e4:4365 wifi interface was not recognized so applied the process mentioned in the broadcomm site for this adapter. The kernel version changed to 3.16.6-203.chitrai.fc20.x86_64.Wifi worked like a charm. But the touchpad stopped working. However the touchpad now is being recognised as an ELantech touchpad and synclient shows a lot of properties of the device. Working on the touchpad leads to the "psmouse serio4: Touchpad at isa0060/serio4/input0 lost sync at byte 6" messages for every position.I also notice that after the wifi driver was installed and kernel changed #rmmod psmouse gives the following message rmmod: ERROR: Module psmouse is builtin.I did a simple custom compilation to see if compiling on the required hardware platform will fix the issue. It didn't. I have not tried the patch.Hope this helps.The kernel version changed to 3.16.6-203.fc20.x86_64 after the wifi driver fix.3.16.6-203.chitrai.fc20.x86_64 was the vanilla compile. Apologies for the oversight in typing.
id=51111	The file /proc/mounts lists file systems in the order they were mounted. This works great until moving the mount point is introduced. There is ambiguity were we can not till if a sub mount point is actually mounted on top of a parent mount point or behind it. This sequence of commands demonstrate these two cases. (output is provided as a comment for convenience)------------------------------################# preparations #################mkdir -p /tmp/test/m{1,2}/subcd /tmp/testdd if=/dev/zero of=a bs=1024 count=60echo y | mkfs.ext2 amount -o loop a m1mkdir m1/subumount m1cp a b; cp a c##################################### case 1: nothing interisting here #####################################mount -o loop a m1mount -o loop b m1/submount --move m1/sub m2/submount -o loop c m2umount m1grep /tmp/test < /proc/mounts; mountpoint m2; mountpoint m2/sub#/dev/loop2 /tmp/test/m2/sub ext2 rw,relatime,errors=continue 0 0#/dev/loop3 /tmp/test/m2 ext2 rw,relatime,errors=continue 0 0#m2 is a mountpoint#m2/sub is not a mountpointumount m2 m2/sub############################## case 2: we have a problem ##############################mount -o loop a m1mount -o loop b m1/submount -o loop c m2mount --move m1/sub m2/subumount m1grep /tmp/test < /proc/mounts; mountpoint m2; mountpoint m2/sub#/dev/loop2 /tmp/test/m2/sub ext2 rw,relatime,errors=continue 0 0#/dev/loop3 /tmp/test/m2 ext2 rw,relatime,errors=continue 0 0#m2 is a mountpoint#m2/sub is a mountpoint############# clean up #############umount m2/sub m2cd ..; rm -r test------------------------------As you can see the output of /proc/mounts is identical. We can not use it to differentiate between these to cases.The desired output in case 2 is:/dev/loop3 /tmp/test/m2 ext2 rw,relatime,errors=continue 0 0/dev/loop2 /tmp/test/m2/sub ext2 rw,relatime,errors=continue 0 0 2.6.32 is obsolete as far as upstream is concernedIf you can reproduce this with a modern kernel and it still looks like a bug then I would suggest discussing it onand updating the bugI have just repeated this test with the same results on 3.6.7This ambiguity is present on any system that boots with the common switch_root idiom. switch_root moves /sys, /proc, /dev, and /run to the new root and then moves the new root to /. The resulting /proc/mounts shows /sys, /proc, /dev, and /run preceding /. A programmatic traversal of the /proc/mounts entries would incorrectly conclude that / shadows /sys, /proc, /dev, and /run.
id=74961	Createdthe dmesg information of ubuntu 14.04 TLSI got the error from my ASUS K450JF (OS : ubuntu 14.04 ; disk : HGST HTS541010A9E680 1T gpt ; cpu : i7-4700HQ ) .It causes the OS to jam. And ASUS maintenance engineer said " your disk is ok and no bad sectors". So it may be a bug and what is wrong with my laptop.More information in the attachment.error information(from dmesg):[ 190.709673] ata6: exception Emask 0x50 SAct 0x0 SErr 0x4090800 action 0xe frozen[ 190.711097] ata6: irq_stat 0x00400040, connection status changed[ 190.712264] ata6: SError: { HostInt PHYRdyChg 10B8B DevExch }[ 190.713302] ata6: hard resetting link[ 190.713320] ata3: exception Emask 0x50 SAct 0x0 SErr 0x4090800 action 0xe frozen[ 190.713900] ata3: irq_stat 0x00400040, connection status changed[ 190.714523] ata3: SError: { HostInt PHYRdyChg 10B8B DevExch }[ 190.715181] ata3: hard resetting link[ 191.437594] ata6: SATA link up 6.0 Gbps (SStatus 133 SControl 300)[ 191.438545] ata3: SATA link up 1.5 Gbps (SStatus 113 SControl 300)[ 191.439004] ata6.00: ACPI cmd ef/10:06:00:00:00:00 (SET FEATURES) succeeded[ 191.439008] ata6.00: ACPI cmd f5/00:00:00:00:00:00 (SECURITY FREEZE LOCK) filtered out[ 191.439010] ata6.00: ACPI cmd b1/c1:00:00:00:00:00 (DEVICE CONFIGURATION OVERLAY) filtered out[ 191.441546] ata6.00: ACPI cmd ef/10:06:00:00:00:00 (SET FEATURES) succeeded[ 191.441549] ata6.00: ACPI cmd f5/00:00:00:00:00:00 (SECURITY FREEZE LOCK) filtered out[ 191.441550] ata6.00: ACPI cmd b1/c1:00:00:00:00:00 (DEVICE CONFIGURATION OVERLAY) filtered out[ 191.442668] ata6.00: configured for UDMA/133[ 191.442672] ata6: EH complete[ 191.445565] ata3.00: configured for UDMA/133[ 191.448998] ata3: EH complete I got the same error when using ide (BIOS Compatible Mode).And I also got the same error when using Fedora 20(amd64).[ 190.712264] ata6: SError: { HostInt PHYRdyChg 10B8B DevExch }Your disk changed. Thats usually either a cable problem or a power problem (the drive not getting enough power so dropping off the bus). The drive then comes back fine which makes me suspect a power issue.Either way the Linux kernel is simply doing the right things. It sees the hardware report a disconnect/reconnect and it probes the new device. If your box has all its file systems on the "old" device then it'll die.Is there a way to improve it? I use the asus official notebook power now.You would need to find out why the disk is disconnecting, or the cable losing link. You may want to ask for help on the Ubuntu forums about disabling- laptop mode- link power saving (ALPM)and see if either of those help stop the drive misbehaving.Bugzilla is not a support forum however, so you really need to work with your distro.Creatednew error:soft resetting linkYesterday I met another error :May 17 11:20:49 asus-X450JF kernel: [ 50.264331] ata1: drained 65536 bytes to clear DRQMay 17 11:20:49 asus-X450JF kernel: [ 50.264348] ata1.01: exception Emask 0x0 SAct 0x0 SErr 0x0 action 0x6 frozenMay 17 11:20:49 asus-X450JF kernel: [ 50.264350] ata1.01: ST_FIRST: DRQ=1 with device error, dev_stat 0x7FMay 17 11:20:49 asus-X450JF kernel: [ 50.264354] sr 0:0:1:0: CDB: May 17 11:20:49 asus-X450JF kernel: [ 50.264355] Get event status notification: 4a 01 00 00 10 00 00 00 08 00May 17 11:20:49 asus-X450JF kernel: [ 50.264368] ata1.01: cmd a0/00:00:00:08:00/00:00:00:00:00/b0 tag 0 pio 16392 inMay 17 11:20:49 asus-X450JF kernel: [ 50.264368] res 7f/ff:ff:ff:ff:ff/00:00:00:00:00/ff Emask 0x2 (HSM violation)May 17 11:20:49 asus-X450JF kernel: [ 50.264370] ata1.01: status: { DRDY DF DRQ ERR }May 17 11:20:49 asus-X450JF kernel: [ 50.264378] ata1: soft resetting linkMay 17 11:20:50 asus-X450JF kernel: [ 50.550219] ata1.01: configured for UDMA/133May 17 11:20:50 asus-X450JF kernel: [ 50.552101] ata1: EH completeMay 17 11:20:54 asus-X450JF kernel: [ 54.837445] ata4.00: exception Emask 0x0 SAct 0x0 SErr 0x0 action 0x6 frozenMay 17 11:20:54 asus-X450JF kernel: [ 54.837449] ata4.00: failed command: READ DMA EXTMay 17 11:20:54 asus-X450JF kernel: [ 54.837452] ata4.00: cmd 25/00:90:88:63:a0/00:00:33:00:00/e0 tag 0 dma 73728 inMay 17 11:20:54 asus-X450JF kernel: [ 54.837452] res 40/00:01:00:00:00/00:00:00:00:00/40 Emask 0x4 (timeout)May 17 11:20:54 asus-X450JF kernel: [ 54.837453] ata4.00: status: { DRDY }May 17 11:20:54 asus-X450JF kernel: [ 54.874228] ata1: drained 65536 bytes to clear DRQMay 17 11:20:54 asus-X450JF kernel: [ 54.874250] ata1.01: exception Emask 0x0 SAct 0x0 SErr 0x0 action 0x6 frozenMay 17 11:20:54 asus-X450JF kernel: [ 54.874251] ata1.01: ST_FIRST: DRQ=1 with device error, dev_stat 0x7FMay 17 11:20:54 asus-X450JF kernel: [ 54.874254] sr 0:0:1:0: CDB: May 17 11:20:54 asus-X450JF kernel: [ 54.874257] Get event status notification: 4a 01 00 00 10 00 00 00 08 00May 17 11:20:54 asus-X450JF kernel: [ 54.874263] ata1.01: cmd a0/00:00:00:08:00/00:00:00:00:00/b0 tag 0 pio 16392 inMay 17 11:20:54 asus-X450JF kernel: [ 54.874263] res 7f/ff:ff:ff:ff:ff/00:00:00:00:00/ff Emask 0x2 (HSM violation)May 17 11:20:54 asus-X450JF kernel: [ 54.874264] ata1.01: status: { DRDY DF DRQ ERR }May 17 11:20:54 asus-X450JF kernel: [ 54.874271] ata1: soft resetting linkMay 17 11:20:54 asus-X450JF kernel: [ 55.161917] ata1.01: configured for UDMA/133May 17 11:20:54 asus-X450JF kernel: [ 55.163719] ata1: EH completeMay 17 11:20:59 asus-X450JF kernel: [ 59.849536] ata4: link is slow to respond, please be patient (ready=0)May 17 11:21:04 asus-X450JF kernel: [ 64.893643] ata4: device not ready (errno=-16), forcing hardresetMay 17 11:21:04 asus-X450JF kernel: [ 64.893651] ata4: soft resetting linkMay 17 11:21:04 asus-X450JF kernel: [ 65.198303] ata4.00: configured for UDMA/133May 17 11:21:04 asus-X450JF kernel: [ 65.198309] ata4.00: device reported invalid CHS sector 0May 17 11:21:04 asus-X450JF kernel: [ 65.198316] ata4: EH completeMore information in the attachment("new error:soft resetting link").Is the same problem?Why the issue changed from "hard resetting link" to "soft resetting link"?And How to reproduce this issue?Because it appears random.Looks like you turned off ahci mode, so the controller is now operating in the legacy ata_piix mode which can't perform hard resets. The same underlying problem. The connection between the disk controller and disk is not reliable and drops off from time to time. The driver is doing what it can to recover from the issues reported by the hardware. It could be something as simple as the drive not being seated well enough and opening it up and reseating it could resolve the issue or it can be something far more complex electronically. Booting with "libata.force=1.5Gbps" might work around the issue too.Today I tried it(Booting with "libata.force=1.5Gbps" and turn on ahci mode),but got the sample error.Jul 10 10:48:27 chenhao-lp kernel: ata6: exception Emask 0x50 SAct 0x0 SErr 0x4090800 action 0xe frozenJul 10 10:48:27 chenhao-lp kernel: ata6: irq_stat 0x00400040, connection status changedJul 10 10:48:27 chenhao-lp kernel: ata6: SError: { HostInt PHYRdyChg 10B8B DevExch }Jul 10 10:48:27 chenhao-lp kernel: ata6: hard resetting linkJul 10 10:48:27 chenhao-lp kernel: ata3: exception Emask 0x50 SAct 0x0 SErr 0x4090800 action 0xe frozenJul 10 10:48:27 chenhao-lp kernel: ata3: irq_stat 0x00400040, connection status changedJul 10 10:48:27 chenhao-lp kernel: ata3: SError: { HostInt PHYRdyChg 10B8B DevExch }Jul 10 10:48:27 chenhao-lp kernel: ata3: hard resetting linkJul 10 10:48:27 chenhao-lp kernel: ata6: SATA link up 1.5 Gbps (SStatus 113 SControl 310)Jul 10 10:48:27 chenhao-lp kernel: ata3: SATA link up 1.5 Gbps (SStatus 113 SControl 310)Jul 10 10:48:27 chenhao-lp kernel: ata6.00: ACPI cmd f5/00:00:00:00:00:00 (SECURITY FREEZE LOCK) filtered outJul 10 10:48:27 chenhao-lp kernel: ata6.00: ACPI cmd b1/c1:00:00:00:00:00 (DEVICE CONFIGURATION OVERLAY) filtered outJul 10 10:48:27 chenhao-lp kernel: ata6.00: ACPI cmd f5/00:00:00:00:00:00 (SECURITY FREEZE LOCK) filtered outJul 10 10:48:27 chenhao-lp kernel: ata6.00: ACPI cmd b1/c1:00:00:00:00:00 (DEVICE CONFIGURATION OVERLAY) filtered outJul 10 10:48:27 chenhao-lp kernel: ata6.00: configured for UDMA/33Jul 10 10:48:27 chenhao-lp kernel: ata6: EH completeJul 10 10:48:27 chenhao-lp kernel: ata3.00: configured for PIO0Jul 10 10:48:27 chenhao-lp kernel: ata3: EH completeSame as your original report - your disk decided to go away and come back. Nothing there that looks like a Linux bug.See. Nothing here has changed, you need to work through your distribution.Sorry, my description()was not detailed.Yesterday i met it on CentOS 7.0.1406.Now I got the error on centos 7(kernel 3.10)/Ubuntu14.04(kernel 3.13)/Fedora 20.If kernel is OK,my laptop may have some problems.Thank you very much.Now I got more information from asus.They said "It is caused by intel节能模式(intel power saving model) and had no idea to solve the problem".How to turn intel power saving model off? Or,are there any other ways to help solving this problems?I have the same Issue, it cropped up since a week or two ago. After one of the kernel updates (Ubuntu 14.10)... The computer freeses and sometimes the SSD just drops off completely and I need to reboot:[ 518.889172] ata1.00: supports DRM functions and may not be fully accessible[ 518.889202] ata1.00: failed to get NCQ Send/Recv Log Emask 0x1[ 518.889204] ata1.00: configured for UDMA/33[ 518.889221] ata1: EH complete[ 521.271992] ata1: exception Emask 0x50 SAct 0x0 SErr 0x4090800 action 0xe frozen[ 521.271995] ata1: irq_stat 0x00400040, connection status changed[ 521.271997] ata1: SError: { HostInt PHYRdyChg 10B8B DevExch }[ 521.272000] ata1: hard resetting link[ 521.272007] ata3: exception Emask 0x50 SAct 0x0 SErr 0x4090800 action 0xe frozen[ 521.272009] ata3: irq_stat 0x00400040, connection status changed[ 521.272010] ata3: SError: { HostInt PHYRdyChg 10B8B DevExch }[ 521.272012] ata3: hard resetting link[ 521.996402] ata3: SATA link up 1.5 Gbps (SStatus 113 SControl 310)[ 521.997005] ata3.00: ACPI cmd ef/10:06:00:00:00:00 (SET FEATURES) succeeded[ 521.997007] ata3.00: ACPI cmd f5/00:00:00:00:00:00 (SECURITY FREEZE LOCK) filtered out[ 521.997008] ata3.00: ACPI cmd b1/c1:00:00:00:00:00 (DEVICE CONFIGURATION OVERLAY) filtered out[ 521.998019] ata3.00: ACPI cmd ef/10:06:00:00:00:00 (SET FEATURES) succeeded[ 521.998021] ata3.00: ACPI cmd f5/00:00:00:00:00:00 (SECURITY FREEZE LOCK) filtered out[ 521.998022] ata3.00: ACPI cmd b1/c1:00:00:00:00:00 (DEVICE CONFIGURATION OVERLAY) filtered out[ 521.998436] ata3.00: configured for UDMA/33[ 521.998439] ata3: EH complete[ 522.000385] ata1: SATA link up 1.5 Gbps (SStatus 113 SControl 310)[ 522.002339] ata1.00: supports DRM functions and may not be fully accessible[ 522.002437] ata1.00: failed to get NCQ Send/Recv Log Emask 0x1[ 522.002596] ata1.00: supports DRM functions and may not be fully accessible[ 522.002625] ata1.00: failed to get NCQ Send/Recv Log Emask 0x1[ 522.002627] ata1.00: configured for UDMA/33[ 522.002644] ata1: EH complete[ 535.632701] ata3: exception Emask 0x50 SAct 0x0 SErr 0x4090800 action 0xe frozen[ 535.632705] ata3: irq_stat 0x00400040, connection status changed[ 535.632707] ata3: SError: { HostInt PHYRdyChg 10B8B DevExch }[ 535.632710] ata3: hard resetting link[ 535.632717] ata1: exception Emask 0x50 SAct 0x0 SErr 0x4090800 action 0xe frozen[ 535.632719] ata1: irq_stat 0x00400040, connection status changed[ 535.632720] ata1: SError: { HostInt PHYRdyChg 10B8B DevExch }[ 535.632721] ata1: hard resetting linkAlso found this in my log today:May 20 00:43:12 p5q3 kernel: [ 1608.649084] ata3: SError: { HostInt PHYRdyChg 10B8B DevExch }Linux 4.1RC4 x86_64Kubuntu 15.04
id=60533	System became terrible unresponsible during swap process. Switching to tty console gave heavy delay. All programms are stuck. Even mouse pointer begins moving jerks. After end swap process system begins respond. By "end swap process" I mean stop hdd activity. Large amount of memory is still used and still stored on disk. Even any little increasing swap stuck my system. Createdhtop screenshotCreatedhtop screenshotCreatedhtop screenshotCreatedhtop screenshotYou can quickly reproduce this if open in Google Chrome this link:This appears to be a google chrome bug in that it tries to allocate most of your memory - you might want to set vm overcommit to disallow heavy overcommit then chrome would I think be killedI expected that a system with 32Gb of memory will just invincible, but I see that when process kswapd is active it also slows as my other machine on which only 3Gb of memory.It's a shame that any application can cause DDOS system only allocated more memory. I would like to brake only application that allocates memory and not the entire system.vm.overcommit_memory = 2not helps prevent system freezeCreatedhtml for demonstrate system freezeI confirm this, Kernel 3.11-9 (liquorix build) on Debian Testing x64, ICEWEASEL 17.09.The system is Athlon II X4 630 quadcore with 8 GiB of RAM and 8 GiB of swap.Clicking on attachment makes the system freeze within 4 seconds, mouse is heavily slowed down and lagging in 5 second steps. Response to keyboard is very slow. Clicking on tab close does not bring anything.According to htop, 8GiB of RAM and 4GiB of swap were occupied and growing. The case seems to be Kernel vulnerable to denial of service due to performing swap operations as required by unpriviliged process (iceweasel).This is NOT google chrome bug, it is kernel exploit.I was able to switch to TTY, start htop and issue a KILL 15 to firefox (iceweasel). It took about 50 seconds to be killed. The system then easily recovered as I was able to switch back to running Xorg.I suggest to limit the program to the amount of RAM it can get within specified time line, some kind of ulimit. Because the process essentially asks for tremedous amount of RAM and causes whole system to freeze.I don't think that decreasing swapping priority is a good idea, as there are programs that might need less barbaric amounts of RAM causing the system to go into swap, and THAT will slow them all down.It's both a chrome bug and a kernel bug. Chrome shouldn't consume arbitary amounts of memory due to untrusted input and the kernel should have killed it off if resource limits were set. For some reason the latter isn't occuring reliably.Testing a few things this seems to be a graphics driver problem. If I am software rendering and have memory overcommit set to 2 then the kernel says no and chrome gives the 'Aw snap!' window.I wonder if its allocation a bazillion GEM objects and these are not being properly accounted or something.(tentatively reassigning to the graphics guys given that software render + overcommit management seems to fix it)hello, r600g with amd machine specified before, and also samsung r60 plus (r300g) laptop are affected.Both gem and ttm don't account memory allocations for the gpu done on behalf of a process properly to those process. So the OOM badness calculations and rlimits are both ineffective. I've thought cgroups would track kernel memory allocations done in process context (and hence should work properly), but Alan said on irc that cgroups isn't effective, either.Definitely more a feature request than bug imo since this has been missing from the start.Might be a fun gsoc project to fix this ...why DRI - Intel? With nouveau and AMD driver same issue. :(There isn't a way to assign the bug to both Intel and AMD and Nouveau at once - it does affect all three, and it is DRI related. Disable DRI and overcommit works properly on all the platforms affected (and its quite a wide range - it takes out chromebooks, some Android phones, ....)(In reply to Mikhail from)Can confirm. System freeze with swap turned on and I have to use reset. After swapoff -a only Google Chrome tab crash. Kernel version 3.14.2 from Fedora repository, Intel video card.Very very stange but swapoff not helpCan you see my strace?Createdstrace of gnome shellAlan, I see that system begin stuck when free memory less than 30%.For example on my machine 1912MB memory, when I see that allocatedmore than 1300MB, system begins stucking. Stucking not only GUI, sshserver also start being sluggish. And all applications which I triedto launch under remote terminal launched longer than usual.CreatedTrying connect from phone to sshd when GUI interface stuckHey Alan are you here?Let us assume that the blame for the graphics subsystem. Then why slow down sshd so much that I could not connected?Basically, this is a REMOTE KILLSWITCH for *any* affected (any open driver) Linux system, if it has a browser.I don't understand why its "enhancement"?!Its crystal clear how it works - by requesting allocation of huge amount of graphical data via html (image decompression bomb, similar to old tar bombs but via JPG or similar) to a browser, it causes massive requests for RAM/GEM objects. This causes typical symptoms of RAM shortage: drop and termination of caches, reallocation of large parts of kernel into swap (making whole system extremely slow), termination of running userspace applications and refusal to execute any new ones.These requests go completely through any of limiters.Which means - send *any* target Linux system, known to use open driver, a link to a crafted html web page, and it will cease to function in a matter of seconds and will not recover by itself. Unless its equipped with a hexabyte of RAM - then it would survive for a minute.MIkhail: Because it ate all the memoryIs this still seen with current kernels (4.0 era) ?(In reply to Alan from)yes$ uname -r4.0.0-1.fc22.i686+PAEThanks.. I'm going to go rattle a few cages 8)I think it's fair to say we are not working on this. Sorry.Please file any new bug reports at the freedesktop.org bugzilla [1]. Thank you.[1]This is a security bug and a remote DoS attack in Intel drivers over two years old I suggest you review your priorities.Sorry skimmed through the comments too fast.Currently CERT VRF#IFGSJT7ATurns out it's a not just the obvious cases but crashes some other drivers and also works on another OS that apparently overlooked the same issue.For the Linux platforms this is now CVE-2013-7445, non Linux equivalents will get their own CVEThanks, Alan hope fixing this bug solve same problem with a lot of tabs on weak computers with 1Gb RAM.My Nexus 5 with Android 6 hang too when I open 3D game such as "MARVEL Future Fight.This is not only a bug with Intel graphics. Same problem with my 01:00.0 VGA compatible controller: Advanced Micro Devices, Inc. [AMD/ATI] Cape Verde PRO [Radeon HD 7750/8740 / R7 250E] and open source radeon module. On very fresh kernelLinux 4.2.3-1 #1 SMP PREEMPT Sat Oct 3 18:52:50 CEST 2015 x86_64 GNU/Linux(In reply to droidlove from)See.Assigning to dri-devel to get more attention among non-Intel devs.The per file OOM stuff Christian propose might be a good start:kernel 4.8.0-0.rc4 and interface still freeze when free memory is absent:stracing of gnome-shell:# strace -t -p 1489strace: Process 1489 attached19:36:11 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffc860b7690) = 019:36:11 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860b7770) = 019:36:11 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffc860b76c0) = 019:36:11 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860b76c0) = 019:36:12 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860b7840) = 019:36:12 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860bd1d0) = 019:36:12 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860bd120) = 019:36:12 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860bd2b0) = 019:36:12 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860ba8d0) = 019:36:12 munmap(0x7f2403fa5000, 4096) = 019:36:12 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffc860ba8c0) = 019:36:12 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffc860ba820) = 019:36:12 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860ba900) = 019:36:12 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffc860ba850) = 019:36:12 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba850) = 019:36:12 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860ba9d0) = 019:36:12 ioctl(8, DRM_IOCTL_MODE_CURSOR, 0x7ffc860bd400) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860ba9f0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860baad0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860ba9f0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860baad0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860ba9f0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860baad0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860ba9f0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860baad0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860ba9f0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860baad0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860ba9f0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860baad0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860ba9f0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860baad0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffc860ba970) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860baad0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffc860ba970) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860baad0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffc860ba970) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860baad0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffc860ba970) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860baad0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffc860ba970) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860baad0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffc860ba970) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860baad0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffc860ba970) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860baad0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffc860ba970) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860baad0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860ba740) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_EXECBUFFER2, 0x7ffc860ba6d0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860ba6d0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860ba6d0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860ba6d0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860ba6d0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860ba6d0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860ba6d0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860ba6d0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860ba6d0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffc860ba6f0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffc860ba6a0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba6a0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860ba9f0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860baad0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860ba9f0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860baad0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860ba9f0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860baad0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860ba9f0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860baad0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860ba9f0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860baad0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860ba9f0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860baad0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860ba9f0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860baad0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860ba910) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860ba900) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860baad0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860ba910) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860ba900) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860ba940) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860baad0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860bbd00) = 019:36:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffc860bbcf0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffc860bb950) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860bb6c0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_PWRITE, 0x7ffc860bb680) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860bbd00) = 019:36:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffc860bbcf0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffc860bb950) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffc860bb640) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_PWRITE, 0x7ffc860bb680) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860b9a10) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860b9a00) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860b9a40) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860b9bd0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860b98c0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_EXECBUFFER2, 0x7ffc860b9850) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860b9850) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860b9850) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860b9850) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860b9850) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffc860b9870) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffc860b9820) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860b9820) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860b9af0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860b9a60) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860b9a10) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860b9a00) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860b9a40) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860b9bd0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860bd110) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860bd080) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860bd030) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860bd020) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860bd060) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860bd1f0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffc860bd280) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_EXECBUFFER2, 0x7ffc860bd210) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860bd280) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860bd210) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860bd200) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffc860bd1d0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffc860bd1c0) = 019:36:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffc860bd1e0) = 019:36:52 ioctl(8, DRM_IOCTL_MODE_ADDFB, 0x7ffc860bd380) = 019:36:52 ioctl(8, DRM_IOCTL_MODE_PAGE_FLIP, 0x7ffc860bd2d0) = 019:36:52 recvmsg(29, {msg_name=NULL, msg_namelen=0, msg_iov=[{iov_base="\34\0\247\307\37\0@\1\212\1\0\0~\211<\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"..., iov_len=4096}], msg_iovlen=1, msg_controllen=0, msg_flags=0}, 0) = 28819:36:52 recvmsg(29, {msg_namelen=0}, 0) = -1 EAGAIN (Resource temporarily unavailable)19:36:52 poll([{fd=4, events=POLLIN}, {fd=8, events=POLLIN}, {fd=10, events=POLLIN}, {fd=20, events=POLLIN}, {fd=29, events=POLLIN}, {fd=32, events=POLLIN}, {fd=34, events=POLLIN}, {fd=48, events=POLLIN}, {fd=50, events=POLLIN}, {fd=51, events=0}, {fd=53, events=POLLIN}, {fd=59, events=POLLIN}, {fd=60, events=POLLIN}, {fd=63, events=POLLIN}, {fd=72, events=POLLIN}, {fd=73, events=POLLIN}, {fd=80, events=POLLIN}], 17, 0) = 2 ([{fd=4, revents=POLLIN}, {fd=10, revents=POLLIN}])19:36:52 read(4, "\7\0\0\0\0\0\0\0", 16) = 819:36:52 poll([{fd=29, events=POLLIN|POLLOUT}], 1, -1) = 1 ([{fd=29, revents=POLLOUT}])19:36:52 writev(29, [{iov_base="\24\0\6\0\37\0@\1\212\1\0\0\6\0\0\0\0\0\0\0\377\377\377\377", iov_len=24}], 1) = 2419:36:52 recvmsg(29, {msg_name=NULL, msg_namelen=0, msg_iov=[{iov_base="\1 \250\307\0\0\0\0\6\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0", iov_len=4096}], msg_iovlen=1, msg_controllen=0, msg_flags=0}, 0) = 3219:36:52 recvmsg(29, {msg_namelen=0}, 0) = -1 EAGAIN (Resource temporarily unavailable)19:36:52 poll([{fd=29, events=POLLIN|POLLOUT}], 1, -1) = 1 ([{fd=29, revents=POLLOUT}])19:36:52 writev(29, [{iov_base="+4\1\0", iov_len=4}, {iov_base=NULL, iov_len=0}, {iov_base="", iov_len=0}], 3) = 419:36:52 poll([{fd=29, events=POLLIN}], 1, -1) = 1 ([{fd=29, revents=POLLIN}])19:36:52 recvmsg(29, {msg_name=NULL, msg_namelen=0, msg_iov=[{iov_base="\1\1\251\307\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0", iov_len=4096}], msg_iovlen=1, msg_controllen=0, msg_flags=0}, 0) = 3217:01:49 recvmsg(29, {msg_namelen=0}, 0) = -1 EAGAIN (Resource temporarily unavailable)17:01:49 poll([{fd=4, events=POLLIN}, {fd=5, events=POLLIN}, {fd=8, events=POLLIN}, {fd=10, events=POLLIN}, {fd=20, events=POLLIN}, {fd=29, events=POLLIN}, {fd=32, events=POLLIN}, {fd=34, events=POLLIN}, {fd=48, events=POLLIN}, {fd=50, events=POLLIN}, {fd=51, events=0}, {fd=53, events=POLLIN}, {fd=59, events=POLLIN}, {fd=60, events=POLLIN}, {fd=66, events=POLLIN}, {fd=70, events=POLLIN}, {fd=72, events=POLLIN}, {fd=73, events=POLLIN}], 18, 0) = 3 ([{fd=4, revents=POLLIN}, {fd=8, revents=POLLIN}, {fd=10, revents=POLLIN}])17:01:49 read(4, "\1\0\0\0\0\0\0\0", 16) = 817:01:49 epoll_wait(10, [{EPOLLIN, {u32=2906628656, u64=94517956944432}}], 32, 0) = 117:01:49 read(19, "N\t\0\0\0\0\0\0\v,\17\0\0\0\0\0\2\0\0\0\3\0\0\0N\t\0\0\0\0\0\0"..., 13920) = 21617:01:49 read(19, 0x55f6ad406780, 13728) = -1 EAGAIN (Resource temporarily unavailable)17:01:49 read(19, 0x55f6ad406768, 13752) = -1 EAGAIN (Resource temporarily unavailable)17:01:49 read(19, 0x55f6ad406750, 13776) = -1 EAGAIN (Resource temporarily unavailable)17:01:49 read(19, 0x55f6ad406738, 13800) = -1 EAGAIN (Resource temporarily unavailable)17:01:49 read(19, 0x55f6ad406720, 13824) = -1 EAGAIN (Resource temporarily unavailable)17:01:49 read(19, 0x55f6ad406708, 13848) = -1 EAGAIN (Resource temporarily unavailable)17:01:49 read(19, 0x55f6ad4066f0, 13872) = -1 EAGAIN (Resource temporarily unavailable)17:01:49 read(19, 0x55f6ad4066d8, 13896) = -1 EAGAIN (Resource temporarily unavailable)17:01:49 read(19, 0x55f6ad4066c0, 13920) = -1 EAGAIN (Resource temporarily unavailable)17:01:49 write(4, "\1\0\0\0\0\0\0\0", 8) = 817:01:49 read(8, "\2\0\0\0 \0\0\0\200\372\340\257\366U\0\0N\t\0\0r3\17\0 .\2\0\0\0\0\0", 1024) = 3217:01:49 ioctl(8, DRM_IOCTL_MODE_RMFB, 0x7ffd3e0c682c) = 017:01:49 recvmsg(29, {msg_namelen=0}, 0) = -1 EAGAIN (Resource temporarily unavailable)17:01:49 poll([{fd=4, events=POLLIN}, {fd=8, events=POLLIN}, {fd=10, events=POLLIN}, {fd=20, events=POLLIN}, {fd=29, events=POLLIN}, {fd=32, events=POLLIN}, {fd=34, events=POLLIN}, {fd=48, events=POLLIN}, {fd=50, events=POLLIN}, {fd=51, events=0}, {fd=53, events=POLLIN}, {fd=59, events=POLLIN}, {fd=60, events=POLLIN}, {fd=66, events=POLLIN}, {fd=70, events=POLLIN}, {fd=72, events=POLLIN}, {fd=73, events=POLLIN}], 17, 0) = 1 ([{fd=4, revents=POLLIN}])17:01:49 read(4, "\1\0\0\0\0\0\0\0", 16) = 817:01:49 recvmsg(29, {msg_namelen=0}, 0) = -1 EAGAIN (Resource temporarily unavailable)17:01:49 poll([{fd=4, events=POLLIN}, {fd=5, events=POLLIN}, {fd=8, events=POLLIN}, {fd=10, events=POLLIN}, {fd=20, events=POLLIN}, {fd=29, events=POLLIN}, {fd=32, events=POLLIN}, {fd=34, events=POLLIN}, {fd=48, events=POLLIN}, {fd=50, events=POLLIN}, {fd=51, events=0}, {fd=53, events=POLLIN}, {fd=59, events=POLLIN}, {fd=60, events=POLLIN}, {fd=66, events=POLLIN}, {fd=70, events=POLLIN}, {fd=72, events=POLLIN}, {fd=73, events=POLLIN}], 18, 0) = 0 (Timeout)17:01:49 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c6a70) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c6a20) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c6a10) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_PWRITE, 0x7ffd3e0c6ac0) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c6ab0) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c6a00) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c6b90) = 017:01:49 ioctl(8, DRM_IOCTL_MODE_CURSOR, 0x7ffd3e0c6ce0) = 017:01:49 write(4, "\1\0\0\0\0\0\0\0", 8) = 817:01:49 write(4, "\1\0\0\0\0\0\0\0", 8) = 817:01:49 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c3f70) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c3ec0) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c4050) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1e00) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1d50) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ee0) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1e00) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1d50) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ee0) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ed0) = 017:01:49 ioctl(8, DRM_IOCTL_I915_GEM_EXECBUFFER2, 0x7ffd3e0c1e60) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c1e50) = 017:01:52 munmap(0x7ff2e046c000, 32768) = 017:01:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1e40) = 017:01:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1e40) = 017:01:52 munmap(0x7ff2e047c000, 32768) = 017:01:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1e40) = 017:01:52 munmap(0x7ff29ef4c000, 114688) = 017:01:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1e40) = 017:01:52 munmap(0x7ff2a50e8000, 114688) = 017:01:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1e40) = 017:01:52 munmap(0x7ff2a507c000, 114688) = 017:01:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1e40) = 017:01:52 munmap(0x7ff2b59d4000, 114688) = 017:01:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1e40) = 017:01:52 munmap(0x7ff2a41ac000, 114688) = 017:01:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1e40) = 017:01:52 munmap(0x7ff2d3e44000, 114688) = 017:01:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1e40) = 017:01:52 munmap(0x7ff2cec46000, 114688) = 017:01:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1e40) = 017:01:52 munmap(0x7ff2cc208000, 114688) = 017:01:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1e40) = 017:01:52 munmap(0x7ff2ba5ca000, 114688) = 017:01:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1e40) = 017:01:52 munmap(0x7ff2b5938000, 114688) = 017:01:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1e40) = 017:01:52 munmap(0x7ff2b5894000, 114688) = 017:01:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1e40) = 017:01:52 munmap(0x7ff2b5613000, 114688) = 017:01:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1e40) = 017:01:52 munmap(0x7ff2a50c8000, 131072) = 017:01:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1e40) = 017:01:52 munmap(0x7ff29ec88000, 131072) = 017:01:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1e40) = 017:01:52 munmap(0x7ff2a6110000, 131072) = 017:01:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1e40) = 017:01:52 munmap(0x7ff2cfb49000, 131072) = 017:01:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1e40) = 017:01:52 munmap(0x7ff2cc014000, 131072) = 017:01:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1e40) = 017:01:52 munmap(0x7ff2b5a68000, 131072) = 017:01:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1e40) = 017:01:52 munmap(0x7ff2b5874000, 131072) = 017:01:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1e40) = 017:01:52 munmap(0x7ff2b55cb000, 131072) = 017:01:52 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1e40) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c1e80) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c1e30) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1e30) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1e00) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1d50) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ee0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1e00) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1d50) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ee0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1e00) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1d50) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ee0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1fa0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_EXECBUFFER2, 0x7ffd3e0c1f30) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c1f50) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c1f00) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f00) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1e00) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1d50) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ee0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1e00) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1d50) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ee0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1e00) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1d50) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ee0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1fa0) = 017:01:52 ioctl(8, DRM_IOCTL_I915_GEM_EXECBUFFER2, 0x7ffd3e0c1f30) = 017:01:53 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c1f20) = 017:01:53 munmap(0x7ff2e047c000, 32768) = 017:01:53 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1f10) = 017:01:53 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c1f50) = 017:01:53 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c1f00) = 017:01:53 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f00) = 017:01:53 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:53 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:53 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:53 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1e00) = 017:01:53 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1d50) = 017:01:53 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ee0) = 017:01:53 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:01:53 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:01:53 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:01:53 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:53 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:53 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:53 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:53 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:53 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:53 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1e00) = 017:01:53 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1d50) = 017:01:53 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ee0) = 017:01:54 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:01:54 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:01:54 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:01:54 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:54 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:54 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:54 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:54 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:54 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:54 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1e00) = 017:01:54 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1d50) = 017:01:54 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ee0) = 017:01:54 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:01:54 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:01:54 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:01:54 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:54 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:54 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:54 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1fa0) = 017:01:54 ioctl(8, DRM_IOCTL_I915_GEM_EXECBUFFER2, 0x7ffd3e0c1f30) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c1f20) = 017:01:57 munmap(0x7ff2e046c000, 32768) = 017:01:57 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1f10) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c1f50) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c1f00) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f00) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1e00) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1d50) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ee0) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1e00) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1d50) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ee0) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1e00) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1d50) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ee0) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1fa0) = 017:01:57 ioctl(8, DRM_IOCTL_I915_GEM_EXECBUFFER2, 0x7ffd3e0c1f30) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c1f20) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1ef0) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c1ee0) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f00) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1e00) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1d50) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ee0) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1e00) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1d50) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ee0) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1e00) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1d50) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ee0) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1c20) = 017:01:58 ioctl(8, DRM_IOCTL_I915_GEM_EXECBUFFER2, 0x7ffd3e0c1bb0) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c1ba0) = 017:02:00 munmap(0x7ff2e046c000, 32768) = 017:02:00 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1b90) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c1bd0) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c1b80) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1b80) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1e00) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1d50) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ee0) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1e00) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1d50) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ee0) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1e00) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1d50) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ee0) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1c20) = 017:02:00 ioctl(8, DRM_IOCTL_I915_GEM_EXECBUFFER2, 0x7ffd3e0c1bb0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c1ba0) = 017:02:01 munmap(0x7ff2e047c000, 32768) = 017:02:01 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1b90) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c1bd0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c1b80) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1b80) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1e00) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1d50) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ee0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1e00) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1d50) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ee0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1f50) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_EXECBUFFER2, 0x7ffd3e0c1ee0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c1ed0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1ea0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c1e90) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1eb0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1e00) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1d50) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ee0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:02:01 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c3b80) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c3c60) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c3bb0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c3bb0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c3d40) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c3d40) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c3e20) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c3d70) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c3d70) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c3f00) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c3f00) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c3fe0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c3f30) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c3f30) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c40c0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c3fe0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c3f30) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c40c0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c3d30) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_EXECBUFFER2, 0x7ffd3e0c3cc0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c3cb0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c3c80) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c3c70) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c3c90) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c42d0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c42d0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c42d0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c42d0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c42d0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c42d0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c42d0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c4250) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c4250) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c4250) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c4250) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c4250) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c4250) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c4250) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c4250) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c4250) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c4250) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c4250) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c4250) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c40f0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_EXECBUFFER2, 0x7ffd3e0c4080) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c4080) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c4080) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c4080) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c4080) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c4080) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c4080) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c4080) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c4080) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c4080) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c4080) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c4080) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c4080) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c4070) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c4040) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c4030) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4050) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c42d0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c42d0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c42d0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c42d0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c42d0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c42d0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4220) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c43b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c4330) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c4410) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c4360) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4360) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c44e0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c4160) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c40b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c4240) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c3dd0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c3d80) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c3d80) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c4330) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c4410) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c4360) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c4360) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c44e0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c4080) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c4070) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c40b0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c4240) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c3ea0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c3eb0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_EXECBUFFER2, 0x7ffd3e0c3e40) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c3e40) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c3e40) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c3e30) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c3e00) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c3df0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c3e10) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c3d70) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c3d60) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c3d80) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c69f0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c6940) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c6ad0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c66e0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c66f0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_EXECBUFFER2, 0x7ffd3e0c6680) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c6680) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c6670) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c6640) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c6630) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c6650) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c6b60) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_EXECBUFFER2, 0x7ffd3e0c6af0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c6b60) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c6af0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c6ae0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c6ab0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c6aa0) = 017:02:02 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c6ac0) = 017:02:02 ioctl(8, DRM_IOCTL_MODE_ADDFB, 0x7ffd3e0c6c60) = 017:02:02 ioctl(8, DRM_IOCTL_MODE_PAGE_FLIP, 0x7ffd3e0c6bb0) = 017:02:02 poll([{fd=66, events=POLLIN}, {fd=70, events=POLLIN}, {fd=72, events=POLLIN}, {fd=73, events=POLLIN}], 4, 0) = 4 ([{fd=66, revents=POLLIN}, {fd=70, revents=POLLIN}, {fd=72, revents=POLLIN}, {fd=73, revents=POLLIN}])17:02:02 poll([{fd=4, events=POLLIN}, {fd=8, events=POLLIN}, {fd=10, events=POLLIN}, {fd=20, events=POLLIN}, {fd=29, events=POLLIN}, {fd=32, events=POLLIN}, {fd=34, events=POLLIN}, {fd=48, events=POLLIN}, {fd=50, events=POLLIN}, {fd=51, events=0}, {fd=53, events=POLLIN}, {fd=59, events=POLLIN}, {fd=60, events=POLLIN}, {fd=66, events=POLLIN}, {fd=70, events=POLLIN}, {fd=72, events=POLLIN}, {fd=73, events=POLLIN}], 17, 0) = 6 ([{fd=4, revents=POLLIN}, {fd=10, revents=POLLIN}, {fd=66, revents=POLLIN}, {fd=70, revents=POLLIN}, {fd=72, revents=POLLIN}, {fd=73, revents=POLLIN}])17:02:02 read(4, "\2\0\0\0\0\0\0\0", 16) = 817:02:02 write(4, "\1\0\0\0\0\0\0\0", 8) = 817:02:02 poll([{fd=4, events=POLLIN}, {fd=8, events=POLLIN}, {fd=10, events=POLLIN}, {fd=20, events=POLLIN}, {fd=29, events=POLLIN}, {fd=32, events=POLLIN}, {fd=34, events=POLLIN}, {fd=48, events=POLLIN}, {fd=50, events=POLLIN}, {fd=51, events=0}, {fd=53, events=POLLIN}, {fd=59, events=POLLIN}, {fd=60, events=POLLIN}, {fd=66, events=POLLIN}, {fd=70, events=POLLIN}, {fd=72, events=POLLIN}, {fd=73, events=POLLIN}], 17, 0) = 6 ([{fd=4, revents=POLLIN}, {fd=10, revents=POLLIN}, {fd=66, revents=POLLIN}, {fd=70, revents=POLLIN}, {fd=72, revents=POLLIN}, {fd=73, revents=POLLIN}])17:02:02 read(4, "\1\0\0\0\0\0\0\0", 16) = 817:02:02 poll([{fd=4, events=POLLIN}, {fd=8, events=POLLIN}, {fd=10, events=POLLIN}, {fd=20, events=POLLIN}, {fd=29, events=POLLIN}, {fd=32, events=POLLIN}, {fd=34, events=POLLIN}, {fd=48, events=POLLIN}, {fd=50, events=POLLIN}, {fd=51, events=0}, {fd=53, events=POLLIN}, {fd=59, events=POLLIN}, {fd=60, events=POLLIN}, {fd=66, events=POLLIN}, {fd=70, events=POLLIN}, {fd=72, events=POLLIN}, {fd=73, events=POLLIN}], 17, 0) = 5 ([{fd=10, revents=POLLIN}, {fd=66, revents=POLLIN}, {fd=70, revents=POLLIN}, {fd=72, revents=POLLIN}, {fd=73, revents=POLLIN}])17:02:02 poll([{fd=4, events=POLLIN}, {fd=8, events=POLLIN}, {fd=10, events=POLLIN}, {fd=20, events=POLLIN}, {fd=29, events=POLLIN}, {fd=32, events=POLLIN}, {fd=34, events=POLLIN}, {fd=48, events=POLLIN}, {fd=50, events=POLLIN}, {fd=51, events=0}, {fd=53, events=POLLIN}, {fd=59, events=POLLIN}, {fd=60, events=POLLIN}, {fd=66, events=POLLIN}, {fd=70, events=POLLIN}, {fd=72, events=POLLIN}, {fd=73, events=POLLIN}], 17, 0) = 5 ([{fd=10, revents=POLLIN}, {fd=66, revents=POLLIN}, {fd=70, revents=POLLIN}, {fd=72, revents=POLLIN}, {fd=73, revents=POLLIN}])17:02:02 poll([{fd=29, events=POLLIN|POLLOUT}], 1, -1) = 1 ([{fd=29, revents=POLLOUT}])17:02:02 writev(29, [{iov_base="\n4\2\0000\0 \0\2\0\4\0@\r \0\1\0\0\0\0\0\0\0\2\1\4\0\370\5 \0"..., iov_len=584}, {iov_base=NULL, iov_len=0}, {iov_base="", iov_len=0}], 3) = 58417:02:02 recvmsg(29, {msg_namelen=0}, 0) = -1 EAGAIN (Resource temporarily unavailable)17:02:02 sendmsg(26, {msg_name=NULL, msg_namelen=0, msg_iov=[{iov_base="O\0\0\0\0\0\10\0H\0\0\0\0\0\10\0W\0\0\0\0\0\10\0@\0\0\0\0\0\10\0"..., iov_len=704}], msg_iovlen=1, msg_controllen=0, msg_flags=0}, MSG_DONTWAIT|MSG_NOSIGNAL) = 70417:02:02 sendmsg(68, {msg_name=NULL, msg_namelen=0, msg_iov=[{iov_base="&\0\0\0\0\0\10\0\31\0\0\0\0\0\f\0\300\216$\0\1\0\0\0\1\0\f\0\31\0\0\0", iov_len=32}], msg_iovlen=1, msg_controllen=0, msg_flags=0}, MSG_DONTWAIT|MSG_NOSIGNAL) = 3217:02:02 poll([{fd=4, events=POLLIN}, {fd=5, events=POLLIN}, {fd=8, events=POLLIN}, {fd=10, events=POLLIN}, {fd=20, events=POLLIN}, {fd=29, events=POLLIN}, {fd=32, events=POLLIN}, {fd=34, events=POLLIN}, {fd=48, events=POLLIN}, {fd=50, events=POLLIN}, {fd=51, events=0}, {fd=53, events=POLLIN}, {fd=59, events=POLLIN}, {fd=60, events=POLLIN}, {fd=66, events=POLLIN}, {fd=70, events=POLLIN}, {fd=72, events=POLLIN}, {fd=73, events=POLLIN}], 18, 0) = 6 ([{fd=5, revents=POLLIN}, {fd=10, revents=POLLIN}, {fd=66, revents=POLLIN}, {fd=70, revents=POLLIN}, {fd=72, revents=POLLIN}, {fd=73, revents=POLLIN}])17:02:02 timerfd_create(CLOCK_REALTIME, TFD_CLOEXEC) = 5617:02:02 timerfd_settime(56, TFD_TIMER_ABSTIME|TFD_TIMER_CANCEL_ON_SET, {it_interval={0, 0}, it_value={1472990580, 0}}, NULL) = 017:02:02 close(73)17:17:15 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:17:15 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:17:15 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:17:15 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:17:15 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:17:15 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:17:17 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:17:17 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:17:17 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:17:17 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1e00) = 017:17:17 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1d50) = 017:17:17 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1ee0) = 017:17:17 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c1c20) = 017:17:17 ioctl(8, DRM_IOCTL_I915_GEM_EXECBUFFER2, 0x7ffd3e0c1bb0) = 017:17:17 ioctl(8, DRM_IOCTL_I915_GEM_MADVISE, 0x7ffd3e0c1ba0) = 017:17:17 munmap(0x7ff2e02d4000, 32768) = 017:17:17 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1b90) = 017:17:17 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1b90) = 017:17:17 munmap(0x7ff2ba4fc000, 65536) = 017:17:17 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1b90) = 017:17:17 munmap(0x7ff2a4637000, 114688) = 017:17:17 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1b90) = 017:17:17 munmap(0x7ff2b5938000, 114688) = 017:17:17 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1b90) = 017:17:17 munmap(0x7ff2a45c3000, 114688) = 017:17:17 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1b90) = 017:17:17 munmap(0x7ff2a5be5000, 114688) = 017:17:17 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1b90) = 017:17:17 munmap(0x7ff2a5bc9000, 114688) = 017:17:17 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1b90) = 017:17:17 munmap(0x7ff2b5543000, 114688) = 017:17:17 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1b90) = 017:17:20 munmap(0x7ff2a626c000, 114688) = 017:17:20 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1b90) = 017:17:22 munmap(0x7ff2b55cf000, 114688) = 017:17:22 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1b90) = 017:17:22 munmap(0x7ff2a4484000, 114688) = 017:17:22 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1b90) = 017:17:22 munmap(0x7ff2a466f000, 114688) = 017:17:22 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1b90) = 017:17:22 munmap(0x7ff2a4118000, 114688) = 017:17:22 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1b90) = 017:17:22 munmap(0x7ff2b5418000, 114688) = 017:17:22 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1b90) = 017:17:22 munmap(0x7ff2a5e1d000, 131072) = 017:17:22 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1b90) = 017:17:22 munmap(0x7ff2a4078000, 131072) = 017:17:22 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1b90) = 017:17:22 munmap(0x7ff2a45df000, 131072) = 017:17:22 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1b90) = 017:17:22 munmap(0x7ff2a6110000, 131072) = 017:17:22 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1b90) = 017:17:22 munmap(0x7ff2a40f8000, 131072) = 017:17:22 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1b90) = 017:17:22 munmap(0x7ff2b434c000, 131072) = 017:17:22 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1b90) = 017:17:23 munmap(0x7ff2a40d8000, 131072) = 017:17:23 ioctl(8, DRM_IOCTL_GEM_CLOSE, 0x7ffd3e0c1b90) = 017:17:23 ioctl(8, DRM_IOCTL_I915_GEM_CREATE, 0x7ffd3e0c1bd0) = 017:17:23 ioctl(8, DRM_IOCTL_I915_GEM_MMAP, 0x7ffd3e0c1b80) = 017:17:23 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1b80) = 017:17:23 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c1fc0) = 017:17:23 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c1f10) = 017:17:23 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c20a0) = 017:17:23 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:17:23 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 017:17:23 ioctl(8, DRM_IOCTL_I915_GEM_SW_FINISH, 0x7ffd3e0c2260) = 017:17:23 ioctl(8, DRM_IOCTL_I915_GEM_BUSY, 0x7ffd3e0c2180) = 017:17:23 ioctl(8, DRM_IOCTL_I915_GEM_SET_DOMAIN, 0x7ffd3e0c20d0) = 0mouse pointer here freeze
id=58241	with btrfs-next (actually tested with f69417e6bdf734be6b) and this patch on topBtrfs: increase the max global reserve size to 1gig* device is a 60Gb SSD (ocz vertex 2)* mkfs.btrfs -d single -m single (is trimmed during mkfs)* mounted as/dev/sdb1 /mnt/sdb btrfs ro,relatime,ssd,space_cache* machine is a quad core opteron with 8 cpus and 4 GB of memory, the abort was not reproduced on fewer cpus (2) and less ram (2 GB)test script (16 parallel fs_mark creating empty files):#!/bin/shdir=${1:-`pwd`}for i in `seq 16`; do mkdir -p $dir/scratch/$i;donefs_mark -D 5000 -S0 -n 100000 -s 0 -L 200 \ -d $dir/scratch/0 -d $dir/scratch/1 \ -d $dir/scratch/2 -d $dir/scratch/3 \ -d $dir/scratch/4 -d $dir/scratch/5 \ -d $dir/scratch/6 -d $dir/scratch/7 \ -d $dir/scratch/8 -d $dir/scratch/9 \ -d $dir/scratch/10 -d $dir/scratch/11 \ -d $dir/scratch/12 -d $dir/scratch/13 \ -d $dir/scratch/14 -d $dir/scratch/15 \ -d $dir/scratch/15 -d $dir/scratch/16 \---Stacktraces:[ 6406.253070] WARNING: at fs/btrfs/super.c:253 __btrfs_abort_transaction+0x60/0x150 [btrfs]()[ 6406.261605] Hardware name: empty[ 6406.264950] btrfs: Transaction aborted (error -28)[ 6406.265013] Modules linked in: edd(F) nfsv3(F) nfs_acl(F) rpcsec_gss_krb5(F) auth_rpcgss(F) nfs(F) fscache(F) lockd(F) sunrpc(F) af_packet(F) bridge(F) stp(F) llc(F) cpufreq_conservative(F) cpufreq_userspace(F) cpufreq_powersave(F) microcode(F) fuse(F) loop(F) dm_mod(F) ipv6(F) vhost_net(F) macvtap(F) macvlan(F) tun(F) tg3(F) ptp(F) acpi_cpufreq(F) tpm_infineon(F) mperf(F) pps_core(F) kvm_amd(F) kvm(F) amd64_edac_mod(F) ehci_pci(F) i2c_piix4(F) k10temp(F) shpchp(F) sg(F) rtc_cmos(F) edac_core(F) edac_mce_amd(F) i2c_core(F) sr_mod(F) pci_hotplug(F) cdrom(F) floppy(F) button(F) tpm_tis(F) tpm(F) pcspkr(F) tpm_bios(F) mptctl(F) ext3(F) jbd(F) mbcache(F) btrfs(F) raid6_pq(F) zlib_deflate(F) sd_mod(F) crc_t10dif(F) xor(F) crc32c(F) libcrc32c(F) ohci_hcd(F) ehci_hcd(F) usbcore(F) usb_common(F) processor(F) thermal_sys(F) hwmon(F) scsi_dh_hp_sw(F) scsi_dh_emc(F) scsi_dh_alua(F) scsi_dh_rdac(F) scsi_dh(F) ata_generic(F) sata_svw(F) pata_serverworks(F) libata(F) mptsas(F) mptscsih(F) mptbase(F) scsi_transport_sas(F) scsi_mod(F) [last unloaded: microcode][ 6406.265034] Pid: 5920, comm: btrfs-transacti Tainted: GF 3.9.0-default+ #1[ 6406.265036] Call Trace:[ 6406.265067] [<ffffffffa01a5520>] ? __btrfs_abort_transaction+0x60/0x150 [btrfs][ 6406.265078] [<ffffffff8104325a>] warn_slowpath_common+0x7a/0xc0[ 6406.265088] [<ffffffff81043341>] warn_slowpath_fmt+0x41/0x50[ 6406.265115] [<ffffffffa01a5520>] __btrfs_abort_transaction+0x60/0x150 [btrfs][ 6406.265151] [<ffffffffa01be07d>] __btrfs_free_extent+0x1ed/0xa60 [btrfs][ 6406.265185] [<ffffffffa01bea85>] run_delayed_tree_ref+0x195/0x1a0 [btrfs][ 6406.265234] [<ffffffffa01bec51>] run_one_delayed_ref+0x71/0xc0 [btrfs][ 6406.265263] [<ffffffffa01c0f7e>] run_clustered_refs+0x12e/0x4d0 [btrfs][ 6406.265291] [<ffffffffa01c1427>] btrfs_run_delayed_refs+0x107/0x540 [btrfs][ 6406.265340] [<ffffffffa01d0550>] __btrfs_end_transaction+0xe0/0x310 [btrfs][ 6406.265371] [<ffffffffa01d07ab>] btrfs_end_transaction+0xb/0x10 [btrfs][ 6406.265413] [<ffffffffa01d1196>] btrfs_commit_transaction+0x726/0x9d0 [btrfs][ 6406.265419] [<ffffffff81052ffa>] ? del_timer_sync+0x5a/0x70[ 6406.265462] [<ffffffffa01d1533>] ? join_transaction+0x33/0x3b0 [btrfs][ 6406.265467] [<ffffffff810676c0>] ? wake_up_bit+0x40/0x40[ 6406.265500] [<ffffffffa01cb601>] transaction_kthread+0x211/0x220 [btrfs][ 6406.265530] [<ffffffffa01cb3f0>] ? __btree_submit_bio_start+0x10/0x10 [btrfs][ 6406.265541] [<ffffffff81066e36>] kthread+0xc6/0xd0[ 6406.265545] [<ffffffff81066d70>] ? kthread_freezable_should_stop+0x70/0x70[ 6406.265552] [<ffffffff814994bc>] ret_from_fork+0x7c/0xb0[ 6406.265556] [<ffffffff81066d70>] ? kthread_freezable_should_stop+0x70/0x70[ 6406.265559] ---[ end trace 700f6ef08e882995 ]---[ 6406.265565] BTRFS error (device sdb1) in __btrfs_free_extent:5506: errno=-28 No space left[ 6406.265568] BTRFS info (device sdb1): forced readonly[ 6406.265572] BTRFS debug (device sdb1): run_one_delayed_ref returned -28[ 6406.265576] BTRFS error (device sdb1) in btrfs_run_delayed_refs:2634: errno=-28 No space left[ 6406.265612] BTRFS warning (device sdb1): Skipping commit of aborted transaction.[ 6406.265687] BTRFS error (device sdb1) in cleanup_transaction:1449: errno=-28 No space left[ 6406.312674] BUG: unable to handle kernel NULL pointer dereference at 0000000000000008[ 6406.312720] IP: [<ffffffffa01ca262>] btrfs_destroy_marked_extents+0x92/0xe0 [btrfs][ 6406.312723] PGD 12887f067 PUD 11626c067 PMD 0[ 6406.312726] Oops: 0000 [#1] SMP[ 6406.312759] Modules linked in: edd(F) nfsv3(F) nfs_acl(F) rpcsec_gss_krb5(F) auth_rpcgss(F) nfs(F) fscache(F) lockd(F) sunrpc(F) af_packet(F) bridge(F) stp(F) llc(F) cpufreq_conservative(F) cpufreq_userspace(F) cpufreq_powersave(F) microcode(F) fuse(F) loop(F) dm_mod(F) ipv6(F) vhost_net(F) macvtap(F) macvlan(F) tun(F) tg3(F) ptp(F) acpi_cpufreq(F) tpm_infineon(F) mperf(F) pps_core(F) kvm_amd(F) kvm(F) amd64_edac_mod(F) ehci_pci(F) i2c_piix4(F) k10temp(F) shpchp(F) sg(F) rtc_cmos(F) edac_core(F) edac_mce_amd(F) i2c_core(F) sr_mod(F) pci_hotplug(F) cdrom(F) floppy(F) button(F) tpm_tis(F) tpm(F) pcspkr(F) tpm_bios(F) mptctl(F) ext3(F) jbd(F) mbcache(F) btrfs(F) raid6_pq(F) zlib_deflate(F) sd_mod(F) crc_t10dif(F) xor(F) crc32c(F) libcrc32c(F) ohci_hcd(F) ehci_hcd(F) usbcore(F) usb_common(F) processor(F) thermal_sys(F) hwmon(F) scsi_dh_hp_sw(F) scsi_dh_emc(F) scsi_dh_alua(F) scsi_dh_rdac(F) scsi_dh(F) ata_generic(F) sata_svw(F) pata_serverworks(F) libata(F) mptsas(F) mptscsih(F) mptbase(F) scsi_transport_sas(F) scsi_mod(F) [last unloaded: microcode][ 6406.312774] CPU 6[ 6406.312774] Pid: 11504, comm: fs_mark Tainted: GF W 3.9.0-default+ #1 empty empty/S3993[ 6406.312791] RIP: 0010:[<ffffffffa01ca262>] [<ffffffffa01ca262>] btrfs_destroy_marked_extents+0x92/0xe0 [btrfs][ 6406.312792] RSP: 0018:ffff8801161c7828 EFLAGS: 00010292[ 6406.312793] RAX: 0000000000000000 RBX: 0000000000000000 RCX: 0000000000000006[ 6406.312794] RDX: 0000000000000002 RSI: 000000000000081b RDI: 0000000000000006[ 6406.312795] RBP: ffff8801161c7868 R08: 0000000000000000 R09: ffff88010deefde9[ 6406.312796] R10: 0000000000000000 R11: 0000000000000010 R12: 0000000000000001[ 6406.312797] R13: ffff880101442430 R14: ffff8801161c7838 R15: ffff8801161c7830[ 6406.312799] FS: 00000000007e7860(0063) GS:ffff88012fd80000(0000) knlGS:0000000000000000[ 6406.312800] CS: 0010 DS: 0000 ES: 0000 CR0: 000000008005003b[ 6406.312801] CR2: 0000000000000008 CR3: 0000000103758000 CR4: 00000000000007e0[ 6406.312802] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000[ 6406.312803] DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400[ 6406.312805] Process fs_mark (pid: 11504, threadinfo ffff8801161c6000, task ffff88005a150680)[ 6406.312805] Stack:[ 6406.312810] ffff880123bf5000 000000000081bfff 000000000081b000 ffff8801014423f8[ 6406.312812] ffff880123bf5000 ffff88002fb73590 00000000ffffffe4 ffff880101442400[ 6406.312815] ffff8801161c7898 ffffffffa01cbab2 ffff8801161c7878 ffff8801161c7878[ 6406.312815] Call Trace:[ 6406.312834] [<ffffffffa01cbab2>] btrfs_cleanup_one_transaction+0x142/0x170 [btrfs][ 6406.312850] [<ffffffffa01d087d>] cleanup_transaction+0xcd/0x2c0 [btrfs][ 6406.312857] [<ffffffff810676c0>] ? wake_up_bit+0x40/0x40[ 6406.312880] [<ffffffffa01d1172>] btrfs_commit_transaction+0x702/0x9d0 [btrfs][ 6406.312882] [<ffffffff810676c0>] ? wake_up_bit+0x40/0x40[ 6406.312896] [<ffffffffa01b6017>] flush_space+0x227/0x230 [btrfs][ 6406.312910] [<ffffffffa01bada5>] reserve_metadata_bytes+0x2d5/0x490 [btrfs][ 6406.312943] [<ffffffffa01b0518>] ? btrfs_search_slot+0x6f8/0x7e0 [btrfs][ 6406.312945] [<ffffffff810676c0>] ? wake_up_bit+0x40/0x40[ 6406.312962] [<ffffffffa01bb1ed>] btrfs_block_rsv_add+0x3d/0x60 [btrfs][ 6406.312978] [<ffffffffa01d1a28>] start_transaction+0x178/0x4c0 [btrfs][ 6406.312994] [<ffffffffa01d20c3>] btrfs_start_transaction+0x13/0x20 [btrfs][ 6406.313012] [<ffffffffa01e1f12>] btrfs_create+0x42/0x210 [btrfs][ 6406.313016] [<ffffffff811f3999>] ? security_inode_permission+0x19/0x20[ 6406.313021] [<ffffffff8116b2ad>] vfs_create+0xad/0xd0[ 6406.313024] [<ffffffff8116cd38>] lookup_open+0x1b8/0x1d0[ 6406.313026] [<ffffffff811f3999>] ? security_inode_permission+0x19/0x20[ 6406.313029] [<ffffffff8116d02e>] do_last+0x2de/0x780[ 6406.313033] [<ffffffff8116fd6a>] path_openat+0xda/0x400[ 6406.313038] [<ffffffff81035b48>] ? __bad_area_nosemaphore+0x208/0x220[ 6406.313041] [<ffffffff811701d3>] do_filp_open+0x43/0xa0[ 6406.313045] [<ffffffff8117beee>] ? __alloc_fd+0xee/0x150[ 6406.313049] [<ffffffff8115df00>] do_sys_open+0x160/0x1e0[ 6406.313052] [<ffffffff8115dfbc>] sys_open+0x1c/0x20[ 6406.313056] [<ffffffff81499569>] system_call_fastpath+0x16/0x1b[ 6406.313074] Code: 75 c8 77 c5 48 8b 45 c0 8b 90 c8 03 00 00 48 8b 80 e8 01 00 00 48 8b b8 00 03 00 00 48 81 ef 90 01 00 00 e8 f1 22 02 00 48 89 c3 <48> 8b 40 08 48 01 45 d0 48 85 db 74 c2 48 89 df e8 f9 30 02 00[ 6406.313099] RIP [<ffffffffa01ca262>] btrfs_destroy_marked_extents+0x92/0xe0 [btrfs][ 6406.313099] RSP <ffff8801161c7828>[ 6406.313100] CR2: 0000000000000008[ 6406.313697] ---[ end trace 700f6ef08e882996 ]---# btrfs fi df /mnt/sdbData: total=1.01GiB, used=13.95MiBSystem: total=4.00MiB, used=12.00KiBMetadata: total=54.89GiB, used=53.99GiB# btrfs fi showLabel: none uuid: 8a598333-a3f2-4608-9338-62cd070e92f5 Total devices 1 FS bytes used 53.57GiB devid 1 size 55.90GiB used 55.90GiB path /dev/sdb1last words from fs_mark: 96 104400000 0 19700.2 27480537 98 106200000 0 16565.9 28647870 98 108000000 0 8868.5 29284231 Can you try and reproduce on btrfs-next again, Miao had a couple of big fixes for our reservation stuff that may fix you.Today's btrfs-next merged into 3.10-rc3[ 7597.876244] WARNING: at fs/btrfs/super.c:253 __btrfs_abort_transaction+0x60/0x150 [btrfs]()[ 7597.884795] btrfs: Transaction aborted (error -28)[ 7597.889683] Modules linked in: edd(F) nfsv3(F) nfs_acl(F) rpcsec_gss_krb5(F) auth_rpcgss(F) nfs(F) fscache(F) lockd(F) sunrpc(F) af_packet(F) bridge(F) stp(F) llc(F) cpufreq_conservative(F) cpufreq_userspace(F) cpufreq_powersave(F) microcode(F) fuse(F) loop(F) dm_mod(F) vhost_net(F) macvtap(F) macvlan(F) acpi_cpufreq(F) tun(F) mperf(F) kvm_amd(F) ipv6(F) kvm(F) tg3(F) tpm_infineon(F) amd64_edac_mod(F) ptp(F) pps_core(F) edac_core(F) shpchp(F) sg(F) sr_mod(F) pcspkr(F) floppy(F) i2c_piix4(F) tpm_tis(F) cdrom(F) button(F) i2c_core(F) edac_mce_amd(F) k10temp(F) rtc_cmos(F) mptctl(F) tpm(F) tpm_bios(F) ehci_pci(F) pci_hotplug(F) ext3(F) jbd(F) mbcache(F) btrfs(F) raid6_pq(F) zlib_deflate(F) xor(F) crc32c(F) libcrc32c(F) sd_mod(F) crc_t10dif(F) ohci_hcd(F) ehci_hcd(F) usbcore(F) usb_common(F) processor(F) thermal_sys(F) hwmon(F) scsi_dh_hp_sw(F) scsi_dh_emc(F) scsi_dh_alua(F) scsi_dh_rdac(F) scsi_dh(F) ata_generic(F) sata_svw(F) pata_serverworks(F) libata(F) mptsas(F) mptscsih(F) mptbase(F) scsi_transport_sas(F) scsi_mod(F) [last unloaded: microcode][ 7597.892625] CPU: 6 PID: 25005 Comm: fs_mark Tainted: GF 3.10.0-rc3-default+ #66[ 7597.892627] Hardware name: empty empty/S3993, BIOS PAQEX0-3 02/24/2008[ 7597.892628] 00000000000000fd ffff880118afb4c8 ffffffff814906fc ffff880118afb508[ 7597.892632] ffffffff8103f52b ffff8800496e8eb0 00000000ffffffe4 ffff88006af6f310[ 7597.892634] ffff88012a78e000 0000000000001586 ffffffffa02469a0 ffff880118afb568[ 7597.892637] Call Trace:[ 7597.892639] [<ffffffff814906fc>] dump_stack+0x19/0x1d[ 7597.892646] [<ffffffff8103f52b>] warn_slowpath_common+0x6b/0xa0[ 7597.892654] [<ffffffff8103f601>] warn_slowpath_fmt+0x41/0x50[ 7597.892658] [<ffffffffa01a9250>] __btrfs_abort_transaction+0x60/0x150 [btrfs][ 7597.892672] [<ffffffffa01c225d>] __btrfs_free_extent+0x1ed/0xa50 [btrfs][ 7597.892688] [<ffffffffa01c2c55>] run_delayed_tree_ref+0x195/0x1a0 [btrfs][ 7597.892714] [<ffffffffa01c2e21>] run_one_delayed_ref+0x71/0xc0 [btrfs][ 7597.892738] [<ffffffffa01c2f9e>] run_clustered_refs+0x12e/0x4d0 [btrfs][ 7597.892762] [<ffffffffa01c3447>] btrfs_run_delayed_refs+0x107/0x540 [btrfs][ 7597.892791] [<ffffffffa01c39f3>] btrfs_write_dirty_block_groups+0x173/0x310 [btrfs][ 7597.892813] [<ffffffffa01d3dda>] commit_cowonly_roots+0x18a/0x290 [btrfs][ 7597.892839] [<ffffffffa01d4ba9>] btrfs_commit_transaction+0x439/0x920 [btrfs][ 7597.892875] [<ffffffffa01d5588>] ? start_transaction+0x98/0x500 [btrfs][ 7597.892892] [<ffffffffa01b9c57>] flush_space+0x227/0x230 [btrfs][ 7597.892908] [<ffffffffa01beb25>] reserve_metadata_bytes+0x2d5/0x490 [btrfs][ 7597.892934] [<ffffffffa01b4258>] ? btrfs_search_slot+0x6f8/0x7e0 [btrfs][ 7597.892958] [<ffffffff81065050>] ? wake_up_bit+0x40/0x40[ 7597.892963] [<ffffffffa01bef7d>] btrfs_block_rsv_add+0x3d/0x60 [btrfs][ 7597.892986] [<ffffffffa01d5650>] start_transaction+0x160/0x500 [btrfs][ 7597.893005] [<ffffffffa01d5d26>] btrfs_start_transaction+0x16/0x20 [btrfs][ 7597.893032] [<ffffffffa01e5f62>] btrfs_create+0x42/0x210 [btrfs][ 7597.893054] [<ffffffff811ecc99>] ? security_inode_permission+0x19/0x20[ 7597.893058] [<ffffffff81165bbd>] vfs_create+0xad/0xd0[ 7597.893062] [<ffffffff81167648>] lookup_open+0x1b8/0x1d0[ 7597.893064] [<ffffffff811ecc99>] ? security_inode_permission+0x19/0x20[ 7597.893066] [<ffffffff81167941>] do_last+0x2e1/0x790[ 7597.893068] [<ffffffff8116a5fa>] path_openat+0xda/0x400[ 7597.893070] [<ffffffff81032ad8>] ? __bad_area_nosemaphore+0x1f8/0x210[ 7597.893074] [<ffffffff8116aa63>] do_filp_open+0x43/0xa0[ 7597.893076] [<ffffffff8117631e>] ? __alloc_fd+0xde/0x140[ 7597.893080] [<ffffffff81159310>] do_sys_open+0x160/0x1e0[ 7597.893084] [<ffffffff811593c9>] SyS_open+0x19/0x20[ 7597.893087] [<ffffffff8149c292>] system_call_fastpath+0x16/0x1b[ 7597.893092] ---[ end trace b682df8ea25ee1dd ]---[ 7597.893095] BTRFS error (device sdb1) in __btrfs_free_extent:5510: errno=-28 No space left[ 7597.893097] BTRFS info (device sdb1): forced readonly[ 7597.893099] BTRFS debug (device sdb1): run_one_delayed_ref returned -28[ 7597.893101] BTRFS error (device sdb1) in btrfs_run_delayed_refs:2630: errno=-28 No space left[ 7597.893108] BTRFS error (device sdb1) in btrfs_update_root:151: errno=-28 No space left[ 7597.893111] BTRFS warning (device sdb1): Skipping commit of aborted transaction.[ 7597.893112] BTRFS error (device sdb1) in cleanup_transaction:1498: errno=-28 No space left# btrfs fi df /mnt/sdbData: total=1.01GiB, used=13.95MiBSystem: total=4.00MiB, used=12.00KiBMetadata: total=54.89GiB, used=53.86GiBfixed with[PATCH] Btrfs: fix transaction throttling for delayed refsplease re-open if you still hit the bug.Did not crash after the 16x fs_marks, however right after the testMetadata: total=54.89GiB, used=53.42GiBand then I was able to create another 2.5+ million empty files in a single directory,Metadata: total=54.89GiB, used=54.35GiB(and did not wait to fill the whole device again).This seems there's still enough space and enospc is hit prematurely.And as last time, I started to remove everything on the partition and hit the same problem but now with the same -next kernel: 6825.068281] ------------[ cut here ]------------[ 6825.068368] WARNING: at fs/btrfs/super.c:253 __btrfs_abort_transaction+0x60/0x190 [btrfs]()[ 6825.068373] btrfs: Transaction aborted (error -28)[ 6825.068377] Modules linked in: edd(F) nfsv3(F) nfs_acl(F) xt_TCPMSS(F) xt_tcpudp(F) xt_limit(F) xt_pkttype(F) xt_physdev(F) rpcsec_gss_krb5(F) auth_rpcgss(F) nfs(F) fscache(F) lockd(F) sunrpc(F) af_packet(F) bridge(F) stp(F) llc(F) cpufreq_conservative(F) cpufreq_userspace(F) cpufreq_powersave(F) microcode(F) ip6t_REJECT(F) nf_conntrack_ipv6(F) nf_defrag_ipv6(F) ip6table_raw(F) xt_CT(F) ipt_REJECT(F) xt_state(F) iptable_raw(F) iptable_filter(F) ip6table_mangle(F) nf_conntrack_netbios_ns(F) nf_conntrack_broadcast(F) nf_conntrack_ipv4(F) nf_conntrack(F) nf_defrag_ipv4(F) ip_tables(F) ip6table_filter(F) ip6_tables(F) x_tables(F) fuse(F) loop(F) dm_mod(F) ipv6(F) vhost_net(F) macvtap(F) macvlan(F) acpi_cpufreq(F) tun(F) mperf(F) kvm_amd(F) kvm(F) tg3(F) tpm_infineon(F) ptp(F) pps_core(F) shpchp(F) sg(F) sr_mod(F) pci_hotplug(F) mptctl(F) amd64_edac_mod(F) tpm_tis(F) tpm(F) tpm_bios(F) ehci_pci(F) k10temp(F) cdrom(F) edac_core(F) edac_mce_amd(F) rtc_cmos(F) i2c_piix4(F) i2c_core(F) button(F) pcspkr(F) ext3(F) jbd(F) mbcache(F) btrfs(F) raid6_pq(F) zlib_deflate(F) xor(F) crc32c(F) libcrc32c(F) sd_mod(F) crc_t10dif(F) ohci_hcd(F)ehci_hcd(F) usbcore(F) usb_common(F) processor(F) thermal_sys(F) hwmon(F) scsi_dh_hp_sw(F) scsi_dh_emc(F) scsi_dh_alua(F) scsi_dh_rdac(F) scsi_dh(F) ata_generic(F) sata_svw(F) pata_serverworks(F) libata(F) mptsas(F) mptscsih(F) mptbase(F) scsi_transport_sas(F) scsi_mod(F) [last unloaded: microcode][ 6825.068498] CPU: 5 PID: 14016 Comm: rm Tainted: GF 3.10.0-rc5-default+ #4[ 6825.068502] Hardware name: empty empty/S3993, BIOS PAQEX0-3 02/24/2008[ 6825.068506] 00000000000000fd ffff880123a3f7a8 ffffffff814909ac ffff880123a3f7e8[ 6825.068517] ffffffff8103f52b ffff88011c98ea30 ffff8801005e2810 00000000ffffffe4[ 6825.068527] ffff8801250ef000 0000000000001618 ffffffffa02679a0 ffff880123a3f848[ 6825.068536] Call Trace:[ 6825.068550] [<ffffffff814909ac>] dump_stack+0x19/0x1d[ 6825.068562] [<ffffffff8103f52b>] warn_slowpath_common+0x6b/0xa0[ 6825.068572] [<ffffffff8103f601>] warn_slowpath_fmt+0x41/0x50[ 6825.068616] [<ffffffffa01c9250>] __btrfs_abort_transaction+0x60/0x190 [btrfs][ 6825.068671] [<ffffffffa01e248d>] __btrfs_free_extent+0x1ed/0xa50 [btrfs][ 6825.068714] [<ffffffffa01e2e85>] run_delayed_tree_ref+0x195/0x1a0 [btrfs][ 6825.068755] [<ffffffffa01e3051>] run_one_delayed_ref+0x71/0xc0 [btrfs][ 6825.068797] [<ffffffffa01e31ce>] run_clustered_refs+0x12e/0x4d0 [btrfs][ 6825.068828] [<ffffffffa01e3677>] btrfs_run_delayed_refs+0x107/0x580 [btrfs][ 6825.068894] [<ffffffffa024815a>] ? __btrfs_run_delayed_items+0x12a/0x250 [btrfs][ 6825.068940] [<ffffffffa01f5031>] btrfs_commit_transaction+0x3d1/0x920 [btrfs][ 6825.068948] [<ffffffff81065070>] ? wake_up_bit+0x40/0x40[ 6825.068988] [<ffffffffa01d9e67>] flush_space+0x227/0x230 [btrfs][ 6825.069019] [<ffffffffa01ded35>] reserve_metadata_bytes+0x2d5/0x490 [btrfs][ 6825.069069] [<ffffffffa01d70cd>] ? btrfs_block_rsv_check+0x2d/0x70 [btrfs][ 6825.069110] [<ffffffffa02454ac>] ? btrfs_dequeue_delayed_node+0x1c/0x90 [btrfs][ 6825.069152] [<ffffffffa01df132>] btrfs_block_rsv_refill+0x92/0xb0 [btrfs][ 6825.069206] [<ffffffffa01fe36a>] btrfs_evict_inode+0x24a/0x360 [btrfs][ 6825.069221] [<ffffffff8117375f>] evict+0xaf/0x1b0[ 6825.069227] [<ffffffff81173929>] iput_final+0xc9/0x160[ 6825.069233] [<ffffffff81173a08>] iput+0x48/0x60[ 6825.069240] [<ffffffff8116a034>] do_unlinkat+0x214/0x240[ 6825.069247] [<ffffffff8112ca6b>] ? do_munmap+0x37b/0x3c0[ 6825.069254] [<ffffffff8116a27d>] SyS_unlinkat+0x1d/0x40[ 6825.069262] [<ffffffff8149c512>] system_call_fastpath+0x16/0x1b[ 6825.069267] ---[ end trace d4c6af3f0d783823 ]---[ 6825.069274] BTRFS error (device sdb1) in __btrfs_free_extent:5656: errno=-28 No space left[ 6825.069279] BTRFS info (device sdb1): forced readonly[ 6825.069284] BTRFS debug (device sdb1): run_one_delayed_ref returned -28[ 6825.069290] BTRFS error (device sdb1) in btrfs_run_delayed_refs:2676: errno=-28 No space left[ 6825.069296] BTRFS warning (device sdb1): Skipping commit of aborted transaction.[ 6825.069300] BTRFS error (device sdb1) in cleanup_transaction:1497: errno=-28 No space left[ 6847.228907] parent transid verify failed on 55386120192 wanted 101 found 63[ 6847.482861] parent transid verify failed on 55387508736 wanted 101 found 63[ 6847.525526] parent transid verify failed on 55375564800 wanted 101 found 62[ 6847.950036] parent transid verify failed on 55339929600 wanted 101 found 62[ 6848.278092] parent transid verify failed on 55375319040 wanted 101 found 62[ 6848.289842] parent transid verify failed on 55387701248 wanted 101 found 97[ 6848.338574] parent transid verify failed on 55386034176 wanted 101 found 63[ 6848.371677] parent transid verify failed on 55339929600 wanted 101 found 62[ 6848.445688] parent transid verify failed on 55331164160 wanted 101 found 97[ 6849.477550] parent transid verify failed on 55363371008 wanted 101 found 62[ 6853.036145] verify_parent_transid: 1 callbacks suppressed[ 6853.036159] parent transid verify failed on 55332032512 wanted 101 found 62[ 6853.318107] parent transid verify failed on 55375564800 wanted 101 found 62[ 6853.373516] parent transid verify failed on 55375319040 wanted 101 found 62[ 6854.191310] parent transid verify failed on 55331164160 wanted 101 found 97[ 6854.448936] parent transid verify failed on 55386034176 wanted 101 found 63[ 6854.454474] parent transid verify failed on 55387508736 wanted 101 found 63[ 6855.410000] parent transid verify failed on 55332032512 wanted 101 found 62[ 6855.589465] parent transid verify failed on 55386120192 wanted 101 found 63[ 6855.660115] parent transid verify failed on 55363371008 wanted 101 found 62[ 6855.713471] parent transid verify failed on 55371345920 wanted 101 found 63[ 6858.394904] verify_parent_transid: 9 callbacks suppressed[ 6858.394916] parent transid verify failed on 55371345920 wanted 101 found 63[ 6858.551417] parent transid verify failed on 55363371008 wanted 101 found 62[ 6858.838479] parent transid verify failed on 55375564800 wanted 101 found 62[ 6858.952457] parent transid verify failed on 55388659712 wanted 101 found 63[ 6859.045386] parent transid verify failed on 55374524416 wanted 101 found 62[ 6860.017173] parent transid verify failed on 55387701248 wanted 101 found 97[ 6860.030829] parent transid verify failed on 55375319040 wanted 101 found 62[ 6860.055114] parent transid verify failed on 55387701248 wanted 101 found 97[ 6860.070141] parent transid verify failed on 55385735168 wanted 101 found 63[ 6860.083565] parent transid verify failed on 55362277376 wanted 101 found 62[ 6863.618945] verify_parent_transid: 15 callbacks suppressed[ 6863.618958] parent transid verify failed on 55375564800 wanted 101 found 62[ 6864.236475] parent transid verify failed on 55332032512 wanted 101 found 62# btrfsck /dev/sdb1Checking filesystem on /dev/sdb1UUID: d703554d-ef43-4fc9-a664-f7535bcea0a4checking extentschecking fs rootschecking root refsfound 58387365888 bytes used err is 0total csum bytes: 8total tree bytes: 58374512640total fs tree bytes: 57012801536btree space waste bytes: 7369214018file data blocks allocated: 12853248 referenced 12853248Btrfs v0.20+scrub status for d703554d-ef43-4fc9-a664-f7535bcea0a4 scrub started at Mon Jun 17 09:33:16 2013 and finished after 491 seconds total bytes scrubbed: 54.38GiB with 0 errorsso it's in-memory change never written to the device.Createdpatch to fix the rm abortI can't reproduce this but I think it's because we're stealing too much from the global reserve to do our evict, and it's because we aren't committing the transaction because we're using FLUSH_LIMIT. I'm not sure why this is since the last iput should be delayed if we'll deadlock, so we should be able to do FLUSH_ALL which will make us commit the transaction and we'll be good to go. Let me know how this works out for you.The fs-mark phase ended at 94 102600000 0 12492.0 27348181 96 104400000 0 14827.4 25176743 98 106200000 0 9410.2 27342856and aborted.# btrfs fi df /mnt/sdbData: total=1.01GiB, used=13.95MiBSystem: total=4.00MiB, used=12.00KiBMetadata: total=54.89GiB, used=53.79GiBsyslog:[ 9229.804896] BTRFS debug (device sdb1): run_one_delayed_ref returned -28[ 9229.811653] ------------[ cut here ]------------[ 9229.816450] WARNING: at fs/btrfs/super.c:254 __btrfs_abort_transaction+0x60/0x150 [btrfs]()[ 9229.816453] btrfs: Transaction aborted (error -28)[ 9229.816556] CPU: 5 PID: 22554 Comm: fs_mark Tainted: GF 3.10.0-rc6-default+ #5[ 9229.816558] Hardware name: empty empty/S3993, BIOS PAQEX0-3 02/24/2008[ 9229.816565] 00000000000000fe ffff880059c11788 ffffffff8149097c ffff880059c117c8[ 9229.816570] ffffffff8103f37b 00000000ffffffe4 00000000ffffffe4 ffff8801277f4c70[ 9229.816575] ffff8800366aa000 0000000000000a46 ffffffffa024d5c0 ffff880059c11828[ 9229.816576] Call Trace:[ 9229.816588] [<ffffffff8149097c>] dump_stack+0x19/0x1d[ 9229.816597] [<ffffffff8103f37b>] warn_slowpath_common+0x6b/0xa0[ 9229.816605] [<ffffffff8103f451>] warn_slowpath_fmt+0x41/0x50[ 9229.816640] [<ffffffffa01af260>] __btrfs_abort_transaction+0x60/0x150 [btrfs][ 9229.816672] [<ffffffffa01c96f8>] btrfs_run_delayed_refs+0x3d8/0x540 [btrfs][ 9229.816712] [<ffffffffa022d9fa>] ? __btrfs_run_delayed_items+0x12a/0x250 [btrfs][ 9229.816745] [<ffffffffa01daefc>] btrfs_commit_transaction+0x40c/0x9d0 [btrfs][ 9229.816751] [<ffffffff81064f50>] ? wake_up_bit+0x40/0x40[ 9229.816782] [<ffffffffa01bfc37>] flush_space+0x227/0x230 [btrfs][ 9229.816810] [<ffffffffa01c4b05>] reserve_metadata_bytes+0x2d5/0x490 [btrfs][ 9229.816848] [<ffffffffa01ba248>] ? btrfs_search_slot+0x6f8/0x7e0 [btrfs][ 9229.816878] [<ffffffffa01c4f5d>] btrfs_block_rsv_add+0x3d/0x60 [btrfs][ 9229.816911] [<ffffffffa01dbaa8>] start_transaction+0x178/0x4c0 [btrfs][ 9229.816949] [<ffffffffa01dc153>] btrfs_start_transaction+0x13/0x20 [btrfs][ 9229.816983] [<ffffffffa01ec002>] btrfs_create+0x42/0x210 [btrfs][ 9229.816989] [<ffffffff811ecc89>] ? security_inode_permission+0x19/0x20[ 9229.816995] [<ffffffff81165d7d>] vfs_create+0xad/0xd0[ 9229.816999] [<ffffffff81167648>] lookup_open+0x1b8/0x1d0[ 9229.817003] [<ffffffff811ecc89>] ? security_inode_permission+0x19/0x20[ 9229.817007] [<ffffffff81167941>] do_last+0x2e1/0x790[ 9229.817012] [<ffffffff8116a65a>] path_openat+0xda/0x400[ 9229.817017] [<ffffffff81032ad8>] ? __bad_area_nosemaphore+0x1f8/0x210[ 9229.817022] [<ffffffff8116aac3>] do_filp_open+0x43/0xa0[ 9229.817027] [<ffffffff8117637e>] ? __alloc_fd+0xde/0x140[ 9229.817034] [<ffffffff81159300>] do_sys_open+0x160/0x1e0[ 9229.817039] [<ffffffff811593b9>] SyS_open+0x19/0x20[ 9229.817045] [<ffffffff8149c512>] system_call_fastpath+0x16/0x1b[ 9229.817048] ---[ end trace ff5bad5e6bd8fdf5 ]---[ 9229.817052] BTRFS error (device sdb1) in btrfs_run_delayed_refs:2630: errno=-28 No space left[ 9229.817055] BTRFS info (device sdb1): forced readonly[ 9229.817058] BTRFS warning (device sdb1): Skipping commit of aborted transaction.[ 9229.817061] BTRFS error (device sdb1) in cleanup_transaction:1449: errno=-28 No space leftTested with a 3.13.0-rc8-default + the upcomming 3.14 queue (cmason/integration), still reproduces the parent transid verify failures, same stacktrace as.* fresh 8GB filesytem on an SSD* same fs_mark parallel job* fill the filesystem* rm -rf all the files
id=63051	For some months i'm getting on boot some static noise that disappear when the alsactl restore is run. I was unable to understand what was happening until i manage to find what is going on.On boot, after the snd_via82xx module is loaded, the noise show up. Looking at the mixer i can see that all channels are muted, yet if i remove the mute from Line-In (with 0 volume), the noise disappear. Muting again the Line-In, the noise reappears. After loading the alsactl restore, everything works as aspected.Seems that on initialization the snd_via82xx card and alsa aren't correctly setting the Mute on line-in, but later, after the alsactl restore, all is finally correctly setupI've a TV capture card that is connected to the Line-In, that probably supply the noise to the sound card.I think this problem show up the first time around May or June, when i booted to upgrade a kernel (stock kernels). As i only reboot rarelly, it's hard to point a working version, but i can try to boot older versions if needed.i'm on a slackware64-current, with kernel 3.11.5 and the embed card from a old Asus A8V MB:00:11.5 Multimedia audio controller: VIA Technologies, Inc. VT8233/A/8235/8237 AC97 Audio Controller (rev 60)Thanks in advance. This sounds rather like an issue specific to your hardware. Muting the output should suppress the noise, too, basically. But in your case, muting the line-in triggers the noise.And, there are no real development in via82xx driver over years. All commits are trivial changes and/or cleanups, so they shouldn't be the cause.In anyway, please give alsa-info.sh output. Run it with --no-upload option, and attach to the bugzilla (don't paste).CreatedAlsainfo after loading the sound moduleSorry the delay.Here is the alsainfo after loading the module, when it start to make noise. Line-in is muted. Un-muting it will stop the noise,I will upload next the alsainfo after loading the alsactl restore, where the noise stops.Createdalsainfo after the alsactl restoreThanks.But, I don't see the line-in is muted in the alsa-info.sh output of.Take a look at alasctl output section. control.18 { iface MIXER name 'Line Playback Switch' value falseThe "Switch" is the reversed mute (i.e. true = sound on, false = sound off).I guess you meant the volume zero as mute, but it's not always mute, but just the minimal volume. control.19 { iface MIXER name 'Line Playback Volume' value.0 0 value.1 0which is changed after alsactl: control.19 { iface MIXER name 'Line Playback Volume' value.0 8 value.1 8Whether it's worth to fix in the upstream code -- I'm not sure.I've never heard of such a symptom on other machines, and the code has been rock solid over a decade. So, as already mentioned, it smells like a hardware-specific issue.That being said, I'm inclined to close this as WILL_NOT_FIX. If you find it mandatory to be fixed in the upstream code, let me know.After loading the module and running the alsamixer, i can see all channels "Muted". If i unmute it, i get a channel with zero volume.I also found that is not just the line-in, if i unmute the CD, the noise also stops. So i get noise until i unmute the LINE or the CD.I also finally found one of my older kernel where this didn't show up. In kernel 3.9.7 i can load the card module and have no noise (other than a small "pop" on the speakers, that was normal). I will attach the alsa-info for that kernel. I will try too to do a bisect to find where this changed... but either way, if it work on a older kernel, i believe that is not a hardware error.Createdalsa-info for kernel 3.9.7Createdalsa-info for kernel 3.12.2 with the noiseI'm also uploading new alsa-info for kernel 3.12.2the first is after loading the module, next after running alsamixer and only unmuting the LINE to stop the noise. Finally another one where i only unmute the CD insteadCreated3.12.2 CD unmutedCreated3.12.2 LINE unmutedOK, if you're seeing a real regression, let's reopen.Actually I expected the behavior of CD mute. This sounds more logical.But, what I don't understand is why 3.9 kernel works.Did you just install 3.9 kernel on the very same system where 3.12 is running, right? Since there is no real code change between 3.9 and 3.12 about sound/pci/ac97/* and sound/pci/via82xx.c, I wonder what can trigger it.If you compare the alsa-info.sh outputs between 3.9.7 and 3.12.2-boot, you see no difference except for kernel versions and timestamps. They are practically identical.This leads me to a conclusion that the problem isn't in the sound driver but rather in another part.If my guess is right, maybe bisection would be the best way to go, unfortunately...seem strange for MX26 Power Down Control/Status -0:26 = 0f00+0:26 = 030c3.9.7 did have the very same value as 3.12 regarding the register 0x26.but Analog Mixer Status is not ready when 0x26 = 0x0f00bit 2 Analog Mixer Status1: Ready0: Not yetyes, this is the same machine and even the same kernel .config (minus changed features between kernels)... but i found something new!as i was testing old kernels, i decide to try the stock slackware kernel (3.10.17), even if i tested my kernel already (3.10.11) and it had the noise... and it worked!So i have two 3.10 kernels, where one works fine and another makes the noise, pointing me to some .config setting.Ok, just recompile 3.12.2 with the default slackware 3.10.17 .config and it works fine too.So it is a .config setting that is causing this, not a code change.I will try to "bisect" the .config to try to see what config affects the sound card... a quick check shows 1500 different settings (most are drivers).any tip how to "bisect" a .config setting (other than 100% manually)? :)So, do I understand correctly that it's fixed in 3.10.17 while 3.10.11 is bad? And 3.11.x and 3.12.x are all bad? Mysterious...If the change happened between 3.10.11 and 3.10.17, you can try bisect between them, too. (In that case, it'll be a reverse bisection to find out the first "good" commit.) This will be much shorter than between 3.10...3.12.no, its a .config option... in 3.12.2 i have a .config that makes the noise and another one that do not make the noise. I suspect some new feature that i enabled in kernel 3.10, that the slackware team did no enabled in their 3.10 .configare there any ac97 error messages in the system log ?did you change nodelay or CONFIG_SND_AC97_POWER_SAVE ?I see no ac97 errors in my logs and the CONFIG_SND_AC97_POWER_SAVE=y is enabled in both configs... but CONFIG_SND_AC97_POWER_SAVE_DEFAULT is 0 on the working kernels and 120 on the noise making onesyet, the working 3.9 config already had that option at 120just recompile with CONFIG_SND_AC97_POWER_SAVE_DEFAULT=120 and the noise show up.so you are right, it's this option that is making the noise show up on bootOK, good to know this. It clarifies why line-in or CD mixe stops the noise, too. The driver disables the power saving when an analog loopback input is active.Now, it's still interesting to check if any prior mixer setup influences on the noise. For example, what if you mute the output?Note that you can change the powesave delay via sysfs on the fly.e.g. to set it to 5 seconds, run the following as root: echo 5 > /sys/module/snd_via82xx/parameters/power_savethen access to the audio once (play someting or change the mixer value).IIRC, the output is muted when the noise show up, but i will confirm this on next boot... but I don't have the /sys/module/snd_via82xx/parameters/power_save :# find /sys/module/snd_via82xx/ -type f /sys/module/snd_via82xx/notes/.note.gnu.build-id/sys/module/snd_via82xx/taint/sys/module/snd_via82xx/initstate/sys/module/snd_via82xx/coresize/sys/module/snd_via82xx/sections/.bss/sys/module/snd_via82xx/sections/.init.text/sys/module/snd_via82xx/sections/.data/sys/module/snd_via82xx/sections/.text/sys/module/snd_via82xx/sections/__param/sys/module/snd_via82xx/sections/__mcount_loc/sys/module/snd_via82xx/sections/.rodata/sys/module/snd_via82xx/sections/.strtab/sys/module/snd_via82xx/sections/.symtab/sys/module/snd_via82xx/sections/.gnu.linkonce.this_module/sys/module/snd_via82xx/sections/.rodata.str1.1/sys/module/snd_via82xx/sections/.rodata.str1.8/sys/module/snd_via82xx/sections/.note.gnu.build-id/sys/module/snd_via82xx/sections/.exit.text/sys/module/snd_via82xx/parameters/id/sys/module/snd_via82xx/parameters/dxs_support/sys/module/snd_via82xx/parameters/index/sys/module/snd_via82xx/parameters/ac97_clock/sys/module/snd_via82xx/parameters/ac97_quirk/sys/module/snd_via82xx/parameters/dxs_init_volume/sys/module/snd_via82xx/parameters/enable/sys/module/snd_via82xx/parameters/nodelay/sys/module/snd_via82xx/parameters/mpu_port/sys/module/snd_via82xx/parameters/joystick/sys/module/snd_via82xx/refcnt/sys/module/snd_via82xx/uevent/sys/module/snd_via82xx/initsizeam i missing some other kernel option to get this parameter?Then check /sys/module/snd_ac97_codec/parameters/power_saveok, just rebooted (and confirm that all output are muted), set the power_save to 5 and "played" a sound (with everything still muted) and the noise disappeared.after the sound finished, 5 seconds later, the noise returns.OK, then in your case, turning power save off is the solution indeed.We can modify the code not to touch PR2 and PR3, but then it'll be messy, and not worth for just some random machines, I'm afraid.But why did kernel 3.9.x and previous ones didn't have this problem, with the same .config? did something changed?Right now, as a workaround i just blacklist the snd_via82xx and manually load it in rc.local followed by a alsactl restore. Or it's better to change the .config default to 0 and setup the powersave timeout in rc.local via the above /sys parameter, with the mixed already setup? both do the same thing, correct?I'm assume that powersaving still works fine (other than having the line-in and CD muted) :)As long there is a easy (and documented) workaround, this should rare problem (changed default .config powersave timeout, ac97, CD or Line-in connected)Are you sure that power saving is enabled in 3.9.x as default?Double-check whether it really had the same Kconfig regarding CONFIG_SND_AC97_POWER_SAVE and CONFIG_SND_AC97_POWER_SAVE_DEFAULT.Yes, i have this .config for ages, keeping updating it with make oldconfig on each kernel releaseThis is my .config history from what i could restore:/boot/config-3.2.0-k8_64-kms-smp:CONFIG_SND_AC97_POWER_SAVE=y/boot/config-3.2.0-k8_64-kms-smp:CONFIG_SND_AC97_POWER_SAVE_DEFAULT=120/boot/config-3.6.9-k8_64-kms-smp:CONFIG_SND_AC97_POWER_SAVE=y/boot/config-3.6.9-k8_64-kms-smp:CONFIG_SND_AC97_POWER_SAVE_DEFAULT=120/boot/config-3.7.6-k8_64-kms-smp:CONFIG_SND_AC97_POWER_SAVE=y/boot/config-3.7.6-k8_64-kms-smp:CONFIG_SND_AC97_POWER_SAVE_DEFAULT=120/boot/config-3.8.7-k8_64-kms-smp:CONFIG_SND_AC97_POWER_SAVE=y/boot/config-3.8.7-k8_64-kms-smp:CONFIG_SND_AC97_POWER_SAVE_DEFAULT=120 /boot/config-3.9.7-k8_64-kms-smp:CONFIG_SND_AC97_POWER_SAVE=y/boot/config-3.9.7-k8_64-kms-smp:CONFIG_SND_AC97_POWER_SAVE_DEFAULT=120Here the noise show up/boot/config-3.10.11-k8_64-kms-smp:CONFIG_SND_AC97_POWER_SAVE=y/boot/config-3.10.11-k8_64-kms-smp:CONFIG_SND_AC97_POWER_SAVE_DEFAULT=120/boot/config-3.11.8-k8_64-kms-smp:CONFIG_SND_AC97_POWER_SAVE=y/boot/config-3.11.8-k8_64-kms-smp:CONFIG_SND_AC97_POWER_SAVE_DEFAULT=120In this test the noise disappeared/boot/config-3.12.2-smp:CONFIG_SND_AC97_POWER_SAVE=y/boot/config-3.12.2-smp:CONFIG_SND_AC97_POWER_SAVE_DEFAULT=0/boot/config-3.12.3-k8_64-smp:CONFIG_SND_AC97_POWER_SAVE=y/boot/config-3.12.3-k8_64-smp:CONFIG_SND_AC97_POWER_SAVE_DEFAULT=120All this configs are copied after a successful compilation via my kernel build script ( cp .config /boot/config-${version}-smp )It can take some time, but i can try to bisect it from 3.9.0 to 3.10.xYes, bisection would be helpful, at least, for understanding the reason.One possible reason might be that the powersaving didn't work actually on 3.9 or earlier kernels, which was fixed implicitly from 3.10. Let's see...BTW, does the noise still appear even after you unload the sound module?ok, i will try to bisect during this week and report back.and yes, the noise is still there after i removed the the snd_via82xx module. I have not tested yet removing the snd_ac97_codec, will try on next bootjust to update that removing the snd_ac97_codec, the noise is still there. Trying to remove all sound related modules also keeps outputing the noise
id=60824	Summary:CSR Bt dongle became unusable after upgrading from 3.9 (make oldconfig)3.9: root@enkidu4:/home/enkidu# hciconfig hci0hci0: Type: BR/EDR Bus: USB BD Address: 00:1B:10:00:23:9A ACL MTU: 1017:8 SCO MTU: 64:0 UP RUNNING PSCAN RX bytes:922 acl:0 sco:0 events:35 errors:0 TX bytes:404 acl:0 sco:0 commands:35 errors:03.11root@enkidu4:/home/enkidu# hciconfig hci0hci0: Type: BR/EDR Bus: USB BD Address: 00:1B:10:00:23:9A ACL MTU: 1017:8 SCO MTU: 64:0 DOWN RX bytes:922 acl:0 sco:0 events:35 errors:0 TX bytes:404 acl:0 sco:0 commands:35 errors:0root@enkidu4:/home/enkidu# hciconfig hci0 upCan't init device hci0: Operation not supported (95) Hi, Could please run btmon utility to collect HCI logs. You can find btmon in the bluez sources. Start the btmon and then in another shell run:$ hciconfig hci0 down$ hciconfig hci0 upAnd attach the logs here.Hi,I don't have btmon atm, but I have attached log of `hcidump -X` while running `hciconfig hci0 up` on 3.11:HCI sniffer - Bluetooth packet analyzer ver 2.5device: hci0 snap_len: 1500 filter: 0xffffffffffffffff< HCI Command: Read Local Supported Features (0x04|0x0003) plen 0Read Local Supported Features (0x04|0x0003) ncmd 1 status 0x00 Features: 0xff 0xff 0x8d 0xfe 0x9b 0xf9 0x00 0x80< HCI Command: Read Local Version Information (0x04|0x0001) plen 0Read Local Version Information (0x04|0x0001) ncmd 1 status 0x00 HCI Version: 2.0 (0x3) HCI Revision: 0x3000 LMP Version: 2.0 (0x3) LMP Subversion: 0x420b Manufacturer: Broadcom Corporation (15)< HCI Command: Read BD ADDR (0x04|0x0009) plen 0Read BD ADDR (0x04|0x0009) ncmd 1 status 0x00 bdaddr 00:1B:10:00:23:9A< HCI Command: Read Buffer Size (0x04|0x0005) plen 0Read Buffer Size (0x04|0x0005) ncmd 1 status 0x00 ACL MTU 1017:8 SCO MTU 64:0< HCI Command: Read Class of Device (0x03|0x0023) plen 0Read Class of Device (0x03|0x0023) ncmd 1 status 0x00 class 0x420100< HCI Command: Read Local Name (0x03|0x0014) plen 0Read Local Name (0x03|0x0014) ncmd 1 status 0x00 name 'enkidu4-0'< HCI Command: Read Voice Setting (0x03|0x0025) plen 0Read Voice Setting (0x03|0x0025) ncmd 1 status 0x00 voice setting 0x0060< HCI Command: Set Event Filter (0x03|0x0005) plen 1 type 0 condition 0 Clear all filtersSet Event Filter (0x03|0x0005) ncmd 1 status 0x00< HCI Command: Write Connection Accept Timeout (0x03|0x0016) plen 2 timeout 32000Write Connection Accept Timeout (0x03|0x0016) ncmd 1 status 0x00< HCI Command: Read Page Scan Activity (0x03|0x001b) plen 0Read Page Scan Activity (0x03|0x001b) ncmd 1 status 0x00 interval 2048 window 18< HCI Command: Read Page Scan Type (0x03|0x0046) plen 0Read Page Scan Type (0x03|0x0046) ncmd 1 0000: 00 00 ..< HCI Command: Set Event Mask (0x03|0x0001) plen 8 Mask: 0xfffffbff07180000Set Event Mask (0x03|0x0001) ncmd 1 status 0x00< HCI Command: Read Local Supported Commands (0x04|0x0002) plen 0Read Local Supported Commands (0x04|0x0002) ncmd 1 status 0x00 Commands: ffffffffffffcfffffffffff0300ffff07< HCI Command: Write Inquiry Mode (0x03|0x0045) plen 1 mode 1Write Inquiry Mode (0x03|0x0045) ncmd 1 status 0x00< HCI Command: Read Local Extended Features (0x04|0x0004) plen 1 page 1Read Local Extended Features (0x04|0x0004) ncmd 1 status 0x00 page 1 max 0 Features: 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00< HCI Command: Delete Stored Link Key (0x03|0x0012) plen 7 bdaddr 00:00:00:00:00:00 all 1Delete Stored Link Key (0x03|0x0012) ncmd 1 status 0x11 deleted 0 Error: Unsupported Feature or Parameter ValueIf needed, I can also attach logs for 3.9 but it seems, that after applying patch to solve Delete Stored Link Key on broadcom devices, something went wrong on CSR. Also, binary dump is attached.Createdbinary dump of hcidumpYes, please add the logs from 3.9 where it works. Your Bluetooth controller reports that you actually support the Delete Stored Link Key, but then fail to run the command properly. Only the text logs are needed, no binaries.here we go with 3.9:< HCI Command: Read Local Supported Features (0x04|0x0003) plen 0Read Local Supported Features (0x04|0x0003) ncmd 1 status 0x00 Features: 0xff 0xff 0x8d 0xfe 0x9b 0xf9 0x00 0x80< HCI Command: Read Local Version Information (0x04|0x0001) plen 0Read Local Version Information (0x04|0x0001) ncmd 1 status 0x00 HCI Version: 2.0 (0x3) HCI Revision: 0x3000 LMP Version: 2.0 (0x3) LMP Subversion: 0x420b Manufacturer: Broadcom Corporation (15)< HCI Command: Read BD ADDR (0x04|0x0009) plen 0Read BD ADDR (0x04|0x0009) ncmd 1 status 0x00 bdaddr 00:1B:10:00:23:9A< HCI Command: Read Buffer Size (0x04|0x0005) plen 0Read Buffer Size (0x04|0x0005) ncmd 1 status 0x00 ACL MTU 1017:8 SCO MTU 64:0< HCI Command: Read Class of Device (0x03|0x0023) plen 0Read Class of Device (0x03|0x0023) ncmd 1 status 0x00 class 0x000000< HCI Command: Read Local Name (0x03|0x0014) plen 0Read Local Name (0x03|0x0014) ncmd 1 status 0x00 name 'enkidu4-0'< HCI Command: Read Voice Setting (0x03|0x0025) plen 0Read Voice Setting (0x03|0x0025) ncmd 1 status 0x00 voice setting 0x0060< HCI Command: Set Event Filter (0x03|0x0005) plen 1 type 0 condition 0 Clear all filtersSet Event Filter (0x03|0x0005) ncmd 1 status 0x00 < HCI Command: Write Connection Accept Timeout (0x03|0x0016) plen 2 timeout 32000Write Connection Accept Timeout (0x03|0x0016) ncmd 1 status 0x00 < HCI Command: Delete Stored Link Key (0x03|0x0012) plen 7 bdaddr 00:00:00:00:00:00 all 1Delete Stored Link Key (0x03|0x0012) ncmd 1 status 0x11 deleted 0 Error: Unsupported Feature or Parameter Value< HCI Command: Set Event Mask (0x03|0x0001) plen 8 Mask: 0xfffffbff07180000Set Event Mask (0x03|0x0001) ncmd 1 status 0x00< HCI Command: Read Local Supported Commands (0x04|0x0002) plen 0Read Local Supported Commands (0x04|0x0002) ncmd 1 status 0x00 Commands: ffffffffffffcfffffffffff0300ffff07< HCI Command: Write Inquiry Mode (0x03|0x0045) plen 1 mode 1Write Inquiry Mode (0x03|0x0045) ncmd 1 status 0x00< HCI Command: Read Local Extended Features (0x04|0x0004) plen 1 page 1Read Local Extended Features (0x04|0x0004) ncmd 1 status 0x00 page 1 max 0 Features: 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00< HCI Command: Write Default Link Policy Settings (0x02|0x000f) plen 2 policy 0x0f Link policy: RSWITCH HOLD SNIFF PARKWrite Default Link Policy Settings (0x02|0x000f) ncmd 1 status 0x00< HCI Command: Write Scan Enable (0x03|0x001a) plen 1 enable 2Write Scan Enable (0x03|0x001a) ncmd 1 status 0x00< HCI Command: Write Class of Device (0x03|0x0024) plen 3 class 0x420100Write Class of Device (0x03|0x0024) ncmd 1 status 0x00< HCI Command: Write Local Name (0x03|0x0013) plen 248 name 'enkidu4-0'Write Local Name (0x03|0x0013) ncmd 1 status 0x00< HCI Command: Write Scan Enable (0x03|0x001a) plen 1 enable 3Write Scan Enable (0x03|0x001a) ncmd 1 status 0x00< HCI Command: Write Class of Device (0x03|0x0024) plen 3 class 0x520100Write Class of Device (0x03|0x0024) ncmd 1 status 0x00Createdmark Delete Stored Keys as non-critical failurePlease apply this patch and check if it works. Also capture logs and send them here.This is a modified version of a patch Johan Hedberg did some time ago.It seems to work: hciconfig hci0 up really brings dongle up an pairing is possible.Thank you for quick patchThis patch is not ready for upstream, could you please give more information.It would be good have a look on the output of /sys/kernel/debug/usb/devices for the bluetooth controller. Can you provide this?of course I can: T: Bus=02 Lev=01 Prnt=01 Port=08 Cnt=03 Dev#= 9 Spd=12 MxCh= 0D: Ver= 2.00 Cls=e0(wlcon) Sub=01 Prot=01 MxPS=64 #Cfgs= 1P: Vendor=0a12 ProdID=0001 Rev= 1.00S: Manufacturer=Bluetooth v2.0S: Product=Bluetooth V2.0 DongleC:* #Ifs= 4 Cfg#= 1 Atr=a0 MxPwr=100mAI:* If#= 0 Alt= 0 #EPs= 3 Cls=e0(wlcon) Sub=01 Prot=01 Driver=btusbE: Ad=81(I) Atr=03(Int.) MxPS= 16 Ivl=1msE: Ad=82(I) Atr=02(Bulk) MxPS= 64 Ivl=0msE: Ad=02(O) Atr=02(Bulk) MxPS= 64 Ivl=0msI:* If#= 1 Alt= 0 #EPs= 2 Cls=e0(wlcon) Sub=01 Prot=01 Driver=btusbE: Ad=83(I) Atr=01(Isoc) MxPS= 0 Ivl=1msE: Ad=03(O) Atr=01(Isoc) MxPS= 0 Ivl=1msI: If#= 1 Alt= 1 #EPs= 2 Cls=e0(wlcon) Sub=01 Prot=01 Driver=btusbE: Ad=83(I) Atr=01(Isoc) MxPS= 9 Ivl=1msE: Ad=03(O) Atr=01(Isoc) MxPS= 9 Ivl=1msI: If#= 1 Alt= 2 #EPs= 2 Cls=e0(wlcon) Sub=01 Prot=01 Driver=btusbE: Ad=83(I) Atr=01(Isoc) MxPS= 17 Ivl=1msE: Ad=03(O) Atr=01(Isoc) MxPS= 17 Ivl=1msI: If#= 1 Alt= 3 #EPs= 2 Cls=e0(wlcon) Sub=01 Prot=01 Driver=btusbE: Ad=83(I) Atr=01(Isoc) MxPS= 25 Ivl=1msE: Ad=03(O) Atr=01(Isoc) MxPS= 25 Ivl=1msI: If#= 1 Alt= 4 #EPs= 2 Cls=e0(wlcon) Sub=01 Prot=01 Driver=btusbE: Ad=83(I) Atr=01(Isoc) MxPS= 33 Ivl=1msE: Ad=03(O) Atr=01(Isoc) MxPS= 33 Ivl=1msI: If#= 1 Alt= 5 #EPs= 2 Cls=e0(wlcon) Sub=01 Prot=01 Driver=btusbE: Ad=83(I) Atr=01(Isoc) MxPS= 49 Ivl=1msE: Ad=03(O) Atr=01(Isoc) MxPS= 49 Ivl=1msI:* If#= 2 Alt= 0 #EPs= 2 Cls=ff(vend.) Sub=ff Prot=ff Driver=(none)E: Ad=84(I) Atr=02(Bulk) MxPS= 32 Ivl=0msE: Ad=04(O) Atr=02(Bulk) MxPS= 32 Ivl=0msI:* If#= 3 Alt= 0 #EPs= 0 Cls=fe(app. ) Sub=01 Prot=00 Driver=(none)I had the same problem. I have tested on ARM dove 3.11.0 - works fine.I had the same problem too, but patch fixes it.Latest working kernel version: 3.9.11Earliest failing kernel version: 3.10.1 (didn't test with rc versions)lsusb: Bus 006 Device 002: ID 0a12:0001 Cambridge Silicon Radio, Ltd Bluetooth Dongle (HCI mode)/sys/kernel/debug/usb/devices:same as posted by M. Wisniewsk, except first line:T: Bus=06 Lev=01 Prnt=01 Port=00 Cnt=01 Dev#= 2 Spd=12 MxCh= 0Also a problem on Fedora 18 Kernel 3.10 onwards. 3.9.11 is fine.From /sys/kernel/debug/usb/devices :-T: Bus=05 Lev=01 Prnt=01 Port=01 Cnt=01 Dev#= 2 Spd=12 MxCh= 0D: Ver= 1.10 Cls=e0(wlcon) Sub=01 Prot=01 MxPS=64 #Cfgs= 1P: Vendor=0a12 ProdID=0001 Rev= 0.07C:* #Ifs= 2 Cfg#= 1 Atr=00 MxPwr= 0mAI:* If#= 0 Alt= 0 #EPs= 3 Cls=e0(wlcon) Sub=01 Prot=01 Driver=btusbE: Ad=81(I) Atr=03(Int.) MxPS= 16 Ivl=1msE: Ad=82(I) Atr=02(Bulk) MxPS= 64 Ivl=0msE: Ad=02(O) Atr=02(Bulk) MxPS= 64 Ivl=0msI:* If#= 1 Alt= 0 #EPs= 2 Cls=e0(wlcon) Sub=01 Prot=01 Driver=btusbE: Ad=83(I) Atr=01(Isoc) MxPS= 0 Ivl=1msE: Ad=03(O) Atr=01(Isoc) MxPS= 0 Ivl=1msI: If#= 1 Alt= 1 #EPs= 2 Cls=e0(wlcon) Sub=01 Prot=01 Driver=btusbE: Ad=83(I) Atr=01(Isoc) MxPS= 9 Ivl=1msE: Ad=03(O) Atr=01(Isoc) MxPS= 9 Ivl=1msI: If#= 1 Alt= 2 #EPs= 2 Cls=e0(wlcon) Sub=01 Prot=01 Driver=btusbE: Ad=83(I) Atr=01(Isoc) MxPS= 17 Ivl=1msE: Ad=03(O) Atr=01(Isoc) MxPS= 17 Ivl=1msI: If#= 1 Alt= 3 #EPs= 2 Cls=e0(wlcon) Sub=01 Prot=01 Driver=btusbE: Ad=83(I) Atr=01(Isoc) MxPS= 25 Ivl=1msE: Ad=03(O) Atr=01(Isoc) MxPS= 25 Ivl=1msI: If#= 1 Alt= 4 #EPs= 2 Cls=e0(wlcon) Sub=01 Prot=01 Driver=btusbE: Ad=83(I) Atr=01(Isoc) MxPS= 33 Ivl=1msE: Ad=03(O) Atr=01(Isoc) MxPS= 33 Ivl=1msI: If#= 1 Alt= 5 #EPs= 2 Cls=e0(wlcon) Sub=01 Prot=01 Driver=btusbE: Ad=83(I) Atr=01(Isoc) MxPS= 49 Ivl=1msE: Ad=03(O) Atr=01(Isoc) MxPS= 49 Ivl=1msI have the same dongle with the same issue. It has CSR's USB vendor:product ID and Broadcom's HCI manufacturer ID, returns the same set of local commands, but doesn't actually support HCI_Delete_Stored_Link_Key. I worked around it with a quirk, but the above patch also works for me.Hi I have the same issue with a pretty similar device and this patch fixed my issue too. Hope to see it merged soon.0a12:0001 Cambridge Silicon Radio, Ltd Bluetooth Dongle (HCI mode)seems to be a duplicate of this bug.What is preventing the patch to be merged? Without this, the Bluetooth dongle doesn't work.Hi, I have this issue with my bluetooth dongle and 3.10.25 kernel realease..I installed bluez bluez-utils and bluetooth on my raspbian.I see that the patch in attachment fix this issue but I don't find the files to modify bluetooth.h, hci_core.h, hci_core.c on my system. Where am I doing wrong? ThanksAndreaThis regression bug renders Raspberry Pi with Bluetooth devices unusable. Unless the patch makes it into Raspbian, many popular dongles won't work. Building a custom kernel on rPi is not an option for the most of us. Is there are a chance of the patch being accepted any time soon, please?Bugzilla is just tracking its existence - if you want it fixed then I would raise it withI was writing under assumption that they have access to this information since the email address you provided is also in the "Assigned-To" field in the form above. So i thought they will be getting updates from this thread too.(In reply to Alan from)Hi,Isn't that already fixed in bluetooth-next?brSzymonI don't have these files in my kernel...Then the only solution is build a custom kernel? thanksAndreaYes, at lest for now.Judging from information i googled, attached patch is original one and patch inis modified "more elegant" one, however the elegant one does not work in all cases... at least not with Cambridge Silicon Radio chips.I don't know since when, but with linux 3.14.1, the bluetooth dongle works again (at least for me).[ 19.181078] Bluetooth: Core ver 2.18[ 19.181130] NET: Registered protocol family 31[ 19.181133] Bluetooth: HCI device and connection manager initialized[ 19.181152] Bluetooth: HCI socket layer initialized[ 19.181156] Bluetooth: L2CAP socket layer initialized[ 19.181182] Bluetooth: SCO socket layer initialized[ 19.211473] Bluetooth: BNEP (Ethernet Emulation) ver 1.3[ 19.211482] Bluetooth: BNEP filters: protocol multicast[ 19.211502] Bluetooth: BNEP socket layer initialized[33132.996728] usb 3-1: new full-speed USB device number 3 using uhci_hcd[33133.643196] usbcore: registered new interface driver btusb[33135.084957] Bluetooth: RFCOMM TTY layer initialized[33135.084982] Bluetooth: RFCOMM socket layer initialized[33135.084998] Bluetooth: RFCOMM ver 1.11I have the same problem running kernel 3.16. `uname -a`:Linux deneb 3.16.0-25-generic #33-Ubuntu SMP Fri Nov 7 01:53:40 UTC 2014 x86_64 x86_64 x86_64 GNU/LinuxI am using Linux Mint 17 64 bits with the described Bluetooth adapter. `lsusb`:....Bus 004 Device 002: ID 0a12:0001 Cambridge Silicon Radio, Ltd Bluetooth Dongle (HCI mode)....As you have said, there are two different patches (elegant and non-elegant). I see that my kernel (3.16.0-25) has the elegant patch, but not the non-elegant and I can confirm that my bluetooth doesn't work. I see that this non-elegant change hasn't been added to the new kernel versions. Is there any reason for that?Thanks!Carlos(In reply to Carlos from)Could you also provide the HCI log of the failure? If it's this same HCI command that's failing then we'd just need to find a way to set the new quirk flag for your device.Created'hcidump -X' while executing 'hciconfig hci0 up' for carlosgarciaqCreatedcontents of /sys/kernel/debug/usb/devices for carlosgarciaqYeap, this is the exit of 'hcidump -X' while I try to pair with a bluetooth headset using blueman-manager:HCI sniffer - Bluetooth packet analyzer ver 2.5device: hci0 snap_len: 1500 filter: 0xffffffffffffffffCreate Connection (0x01|0x0005) status 0x00 ncmd 1status 0x00 handle 0 bdaddr 00:1E:3D:F1:4D:75 type ACL encrypt 0x00Read Remote Supported Features (0x01|0x001b) status 0x00 ncmd 1status 0x00 handle 0 Features: 0xbf 0x2f 0x83 0xfa 0x88 0x39 0x00 0x80status 0x00 handle 0 reason 0x08 Reason: Connection TimeoutUnknown (0x00|0x0020) ncmd 1 0000: 00 In my first attachement, you can find the 'hcidump -X' while doing:sudo hciconfig hci0 downsudo hciconfig hci0 upIn my second attachment, you'll find the contents of /sys/kernel/debug/usb/devices Thanks! Let me know if this is not what you wanted.Regards,Carlos
id=69761	I have a Toshiba M840 and a few (not all) the FN+FX key mappings are wrong. Here below is a table showing how the key mapping should be and what is actually happening when you press the key combination:Key combination|What should be |What it doesFN+F2 |lower brightness |BatteryFN+F3 |increases brightness |SleepFN+F4 |switch video output |SuspendFN+F5 |touchpad ON/OFF |DisplayFN+F6 |Audio Previous |Audio PreviousFN+F7 |Audio Play |Audio PlayFN+F8 |Audio Next |Audio NextFN+F9 |Audio Lower Volume |Audio Lower VolumeFN+F10 |Audio Raise Volume |Audio Raise VolumeFN+F11 |Audio Mute ON/OFF |0xf8FN+F12 |Wireless ON/OFF Switch|0xf8=============01: None 00.0: 10105 BIOS [Created at bios.186] Unique ID: rdCR.lZF+r4EgHp4 Hardware Class: bios BIOS Keyboard LED Status: Scroll Lock: off Num Lock: off Caps Lock: off Config Status: cfg=no, avail=yes, need=no, active=unknown=============If you need other hardware details please do let me know.ThanksFederico I was requested to create this bug at:Here is more information:hwinfo --keyboard25: PS/2 00.0: 10800 Keyboard [Created at input.226] Unique ID: nLyy.+49ps10DtUF Hardware Class: keyboard Model: "AT Translated Set 2 keyboard" Vendor: 0x0001 Device: 0x0001 "AT Translated Set 2 keyboard" Compatible to: int 0x0211 0x0001 Device File: /dev/input/event0 Device Files: /dev/input/event0, /dev/input/by-path/platform-i8042-serio-0-event-kbd Device Number: char 13:64 Driver Info #0: XkbRules: xfree86 XkbModel: pc104 Config Status: cfg=no, avail=yes, need=no, active=unknownThey were wrong to request it - such keyboard mapping tweaks should be applied from userspace by udev, not in kernel.Ok, I'll get back to them. Thanks.This looks like an incorrect keymap in toshiba_acpi, judging from the output seen in the bugzilla entry above. The evtest shows that the driver already provides the key codes but just gives a wrong value. If so, the kernel should be fixed instead of udev hwdb.Federico, could you give the whole list of scancode <-> keycode mapping on your machine for the keys defined in drivers/platform/x86/toshiba_acpi.c?Also check which ACPI device ID corresponds to ("TOS6200", "TOS6208", "TOS1900"). It appears in sysfs, /sys/bus/acpi/devices/*.OK, if the keys in question are handled by toshiba_acpi then we need to bounce this bug to platform devices guys.I believe below is the info you need, if I have missed something or got something wrong please let me know:1. Just for your reference, since this might be a new Toshiba keyboard layout, this is how it looks like:2. This is the list of ACPI devices under /sys/bus/acpi/devices/ matching TOS*.lrwxrwxrwx 1 root root 0 Apr 8 09:23 TOS0310:00 -> ../../../devices/LNXSYSTM:00/device:00/PNP0A08:00/device:02/TOS0310:00/lrwxrwxrwx 1 root root 0 Apr 8 09:23 TOS1102:00 -> ../../../devices/LNXSYSTM:00/device:00/PNP0A08:00/device:02/TOS1102:00/lrwxrwxrwx 1 root root 0 Apr 8 09:23 TOS1900:00 -> ../../../devices/LNXSYSTM:00/device:00/TOS1900:00/lrwxrwxrwx 1 root root 0 Apr 8 09:23 TOS6205:00 -> ../../../devices/LNXSYSTM:00/device:00/TOS6205:00/3. A few FN+<Key> combination show under event0 and a few under event7, here is the output of evtest for both inputs:a. evtest /dev/input/event0Input driver version is 1.0.1Input device ID: bus 0x11 vendor 0x1 product 0x1 version 0xab41Input device name: "AT Translated Set 2 keyboard"Supported events: Event type 0 (Sync) Event type 1 (Key) Event code 1 (Esc) Event code 2 (1) Event code 3 (2) Event code 4 (3) Event code 5 (4) Event code 6 (5) Event code 7 (6) Event code 8 (7) Event code 9 (8) Event code 10 (9) Event code 11 (0) Event code 12 (Minus) Event code 13 (Equal) Event code 14 (Backspace) Event code 15 (Tab) Event code 16 (Q) Event code 17 (W) Event code 18 (E) Event code 19 (R) Event code 20 (T) Event code 21 (Y) Event code 22 (U) Event code 23 (I) Event code 24 (O) Event code 25 (P) Event code 26 (LeftBrace) Event code 27 (RightBrace) Event code 28 (Enter) Event code 29 (LeftControl) Event code 30 (A) Event code 31 (S) Event code 32 (D) Event code 33 (F) Event code 34 (G) Event code 35 (H) Event code 36 (J) Event code 37 (K) Event code 38 (L) Event code 39 (Semicolon) Event code 40 (Apostrophe) Event code 41 (Grave) Event code 42 (LeftShift) Event code 43 (BackSlash) Event code 44 (Z) Event code 45 (X) Event code 46 (C) Event code 47 (V) Event code 48 (B) Event code 49 (N) Event code 50 (M) Event code 51 (Comma) Event code 52 (Dot) Event code 53 (Slash) Event code 54 (RightShift) Event code 55 (KPAsterisk) Event code 56 (LeftAlt) Event code 57 (Space) Event code 58 (CapsLock) Event code 59 (F1) Event code 60 (F2) Event code 61 (F3) Event code 62 (F4) Event code 63 (F5) Event code 64 (F6) Event code 65 (F7) Event code 66 (F8) Event code 67 (F9) Event code 68 (F10) Event code 69 (NumLock) Event code 70 (ScrollLock) Event code 71 (KP7) Event code 72 (KP8) Event code 73 (KP9) Event code 74 (KPMinus) Event code 75 (KP4) Event code 76 (KP5) Event code 77 (KP6) Event code 78 (KPPlus) Event code 79 (KP1) Event code 80 (KP2) Event code 81 (KP3) Event code 82 (KP0) Event code 83 (KPDot) Event code 85 (Zenkaku/Hankaku) Event code 86 (102nd) Event code 87 (F11) Event code 88 (F12) Event code 89 (RO) Event code 90 (Katakana) Event code 91 (HIRAGANA) Event code 92 (Henkan) Event code 93 (Katakana/Hiragana) Event code 94 (Muhenkan) Event code 95 (KPJpComma) Event code 96 (KPEnter) Event code 97 (RightCtrl) Event code 98 (KPSlash) Event code 99 (SysRq) Event code 100 (RightAlt) Event code 102 (Home) Event code 103 (Up) Event code 104 (PageUp) Event code 105 (Left) Event code 106 (Right) Event code 107 (End) Event code 108 (Down) Event code 109 (PageDown) Event code 110 (Insert) Event code 111 (Delete) Event code 112 (Macro) Event code 113 (Mute) Event code 114 (VolumeDown) Event code 115 (VolumeUp) Event code 116 (Power) Event code 117 (KPEqual) Event code 118 (KPPlusMinus) Event code 119 (Pause) Event code 121 (KPComma) Event code 122 (Hanguel) Event code 123 (Hanja) Event code 124 (Yen) Event code 125 (LeftMeta) Event code 126 (RightMeta) Event code 127 (Compose) Event code 128 (Stop) Event code 140 (Calc) Event code 142 (Sleep) Event code 143 (WakeUp) Event code 155 (Mail) Event code 156 (Bookmarks) Event code 157 (Computer) Event code 158 (Back) Event code 159 (Forward) Event code 163 (NextSong) Event code 164 (PlayPause) Event code 165 (PreviousSong) Event code 166 (StopCD) Event code 172 (HomePage) Event code 173 (Refresh) Event code 183 (F13) Event code 184 (F14) Event code 185 (F15) Event code 191 (F21) Event code 217 (Search) Event code 224 (Brightness down) Event code 225 (Brightness up) Event code 226 (Media) Event code 227 (?) Event code 238 (?) Event type 4 (Misc) Event code 4 (ScanCode) Event type 17 (LED) Event code 0 (NumLock) Event code 1 (CapsLock) Event code 2 (ScrollLock) Event type 20 (Repeat)Testing ... (interrupt to exit)b. evtest /dev/input/event7Input driver version is 1.0.1Input device ID: bus 0x19 vendor 0x0 product 0x0 version 0x0Input device name: "Toshiba input device"Supported events: Event type 0 (Sync) Event type 1 (Key) Event code 113 (Mute) Event code 128 (Stop) Event code 142 (Sleep) Event code 149 (Prog2) Event code 150 (WWW) Event code 152 (Coffee) Event code 155 (Mail) Event code 163 (NextSong) Event code 164 (PlayPause) Event code 165 (PreviousSong) Event code 205 (Suspend) Event code 224 (Brightness down) Event code 225 (Brightness up) Event code 226 (Media) Event code 227 (?) Event code 228 (?) Event code 236 (?) Event code 238 (?) Event code 240 (Unknown) Event code 418 (?) Event code 419 (?) Event code 420 (?) Event code 464 (?) Event code 530 (?) Event type 4 (Misc) Event code 4 (ScanCode)Testing ... (interrupt to exit)4. Here below is the list I was able to match from the list shown in toshiba_acpi.c by using evtest. I have placed a remark when the key combination was triggered on event0 or event7. If this is not what you wanted, please let me know.Here is the list of matches from toshiba_acpi.c to my laptop:KEY_MUTE (event7): type 4 (Misc), code 4 (ScanCode), value 157 type 1 (Key), code 240 (Unknown), value 1KEY_ZOOMOUT (event7): type 4 (Misc), code 4 (ScanCode), value 102 type 1 (Key), code 419 (?), value 1KEY_ZOOMIN (event7): type 4 (Misc), code 4 (ScanCode), value 103 type 1 (Key), code 418 (?), value 1KEY_KBDILLUMTOGGLE: I do not have this keyKEY_ZOOMRESET (event7, not really a key for this but FN+Space is supposed to change the screen resolution. Since we don't have a function for that, I guess it could be assigned for zoom reset, up to you): type 4 (Misc), code 4 (ScanCode), value 139 type 1 (Key), code 420 (?), value 1KEY_COFFEE: I do not have this key KEY_BATTERY: I do not have this keyKEY_SLEEP: I do not have this keyKEY_SUSPEND: I do not have this keyKEY_SWITCHVIDEOMODE (event7): type 4 (Misc), code 4 (ScanCode), value 13e type 1 (Key), code 205 (Suspend), value 1KEY_BRIGHTNESSDOWN (event7): type 4 (Misc), code 4 (ScanCode), value 13c type 1 (Key), code 236 (?), value 1KEY_BRIGHTNESSUP (event7): type 4 (Misc), code 4 (ScanCode), value 13d type 1 (Key), code 142 (Sleep), value 1KEY_WLAN (event7): type 4 (Misc), code 4 (ScanCode), value 158 type 1 (Key), code 240 (Unknown), value 1KEY_TOUCHPAD_TOGGLE (event7): type 4 (Misc), code 4 (ScanCode), value 13f type 1 (Key), code 227 (?), value 1KEY_FN:KEY_PROG2: I do not have this keyKEY_WWW: I do not have this keyKEY_MAIL: I do not have this keyKEY_STOP: I do not have this keyKEY_PREVIOUSSONG (event0): type 4 (Misc), code 4 (ScanCode), value 90 type 1 (Key), code 165 (PreviousSong), value 1KEY_NEXTSONG (event0): type 4 (Misc), code 4 (ScanCode), value 99 type 1 (Key), code 163 (NextSong), value 0KEY_PLAYPAUSE (event0): type 4 (Misc), code 4 (ScanCode), value a2 type 1 (Key), code 164 (PlayPause), value 0KEY_MEDIA: I do not have this keyKEY_RESERVED:KE_END:I notice the volume keys are not mentioned in the list here they are anyway:VolumeDown (event0): type 4 (Misc), code 4 (ScanCode), value ae type 1 (Key), code 114 (VolumeDown), value 0VolumeUP (event0): type 4 (Misc), code 4 (ScanCode), value b0 type 1 (Key), code 115 (VolumeUp), value 0OK, so the key map is completely different from the defined one.Providing the new keymap itself should be easy, but a remaining question is in which condition an alternative keymap has to be applied. As TOS1900 has been added from the very beginning, even before year 2008, it's not specific to TOS1900 binding.I guess a safer option at this moment is to apply the alternative keymap based on DMI string matches. Could you give the output of dmidecode? Then I can provide you a test patch in return.Createddmidecode outputHi Takashi, I have attached the output of dmidecode to the case.Could you try the patch below?CreatedFix patchThanks for the patch Takashi. Most of the keys are working except for Zoom (In/Out/Reset) and Touchpad Toggle. While I couldn't test the video output yet (will do so soon), Gnome does recognize the key as 'Display'.In Gnome, the key shortcut tool does not receive any input for the keys which are not working yet (the others you fix are working and the tool does recognize them correctly).I'm not really concerned about the Zoom keys (while it be great to have them working). The touchpad toggle on the other hand, would be useful to get it to work.Here is the output from evtest, please let me know what else you may need:# evtest /dev/input/event7Input driver version is 1.0.1Input device ID: bus 0x19 vendor 0x0 product 0x0 version 0x0Input device name: "Toshiba input device"Supported events: Event type 0 (Sync) Event type 1 (Key) Event code 113 (Mute) Event code 224 (Brightness down) Event code 225 (Brightness up) Event code 227 (?) Event code 238 (?) Event code 240 (Unknown) Event code 418 (?) Event code 419 (?) Event code 420 (?) Event code 530 (?) Event type 4 (Misc) Event code 4 (ScanCode)Testing ... (interrupt to exit)Zoom Out:Event: time 1397995790.766515, type 4 (Misc), code 4 (ScanCode), value 102Event: time 1397995790.766515, type 1 (Key), code 419 (?), value 1Event: time 1397995790.766515, -------------- Report Sync ------------Event: time 1397995790.766532, type 1 (Key), code 419 (?), value 0Event: time 1397995790.766532, -------------- Report Sync ------------Zoom In:Event: time 1397995824.466953, type 4 (Misc), code 4 (ScanCode), value 103Event: time 1397995824.466953, type 1 (Key), code 418 (?), value 1Event: time 1397995824.466953, -------------- Report Sync ------------Event: time 1397995824.466969, type 1 (Key), code 418 (?), value 0Event: time 1397995824.466969, -------------- Report Sync ------------Zoom Reset:Event: time 1397995965.861597, type 4 (Misc), code 4 (ScanCode), value 139Event: time 1397995965.861597, type 1 (Key), code 420 (?), value 1Event: time 1397995965.861597, -------------- Report Sync ------------Event: time 1397995965.861615, type 1 (Key), code 420 (?), value 0Event: time 1397995965.861615, -------------- Report Sync ------------Touchpad Toggle:Event: time 1397995855.833966, type 4 (Misc), code 4 (ScanCode), value 13fEvent: time 1397995855.833966, type 1 (Key), code 530 (?), value 1Event: time 1397995855.833966, -------------- Report Sync ------------Event: time 1397995855.833984, type 1 (Key), code 530 (?), value 0Event: time 1397995855.833984, -------------- Report Sync ------------If there is anything I can try in order to help, I'll be glad to do it (like changing something in the patch if you need me to.You've been extremely helpful.All generated keycodes (418 = 0x1a2, 419 = 0x1a3, 530 = 0x212) look correct, so the patch should be OK per se. The rest is the issue of the desktop environment, how to interpret such a key code. You may need to set up the desktop services (like some daemon) to react with a key like touchpad toggle.I'm going to submit the patch now to upstream.Ok, please go ahead. Many will appreciate to have these keys working.Azael Avalos suggested that this patch should also be applied for the Toshiba Qosmio X75-A7298 :". . . your model should be added to the DMI matching list, the recently released kernel 3.16-rc1 now comes with the new keymap (commit fe808bfb59d693e07ee23c99542cd64e1f41b8c9)."
id=93021	Steps to reproduce:0) Default subvolume is left its default, eg. it is /1) Create an empty subvolume and place a root file system under it2) Boot with kernel command line such as: root=/dev/mmcblk0p3 rw rootwait rootflags=subvol=/6233) Mount the root subvolume eg. with: "mount /dev/mmcblk0p3 /mnt" so that the subvolume 632 becomes accessible for example snapshotting.4) Try to delete the subvolume called 623 (the only subvolume in addition to root subvolume, the one where we are running the root file system)Obviously we should fail here, but we don't. From this point on, we no longer have the subvolume where the root file system is located. And we are no longer able to read directory listing from / directory (which now points to the subvolume that does not exist any more), but at least some shell commands appear to be still working for a while, at least those that have working directory held open somewhere else than at /. Everything appears to be working normally except that the root directory is suddenly deleted.I don't think this was possible until 3.19. I have been triggering this with my scripts many times by now since we started using 3.19, never had any issues with previous kernel versions. Still reproducible with 4.0-rc4It appears this is no longer reproducible with 4.1-rc4. So I'll mark this as resolved.Strange, I don't see any patch in btrfs that could fix that.from Omar is not merged. AFAIK this serieswill fix that, but it's scheduled for 4.2 .You are right. I see I had accidentally left Omar Sandoval's previous fix proposal on my tree and buried it with a merge. So that's why it didn't reproduce any more for me.I'm reopening this bug so it reflects the current state. Sorry about the noise.
id=194551	/dev/sda: Samsung SSD 850 EVO 2TB/dev/sdb: Samsung SSD 850 EVO 2TB/dev/sdc: ST2000DX002-2DV164/dev/sdd: ST2000DX002-2DV164* each stripe is one one of the SSD and a mirror on a HDD* both HDD are added "writemostly" to the arraynormally i would expect that for heavy read-IO the two HDD drives would sleep and the two SSD working more or less like a RAID0 but as example running a btrfs-srub within a virtual machine on a 1.5 TB vdisk you can hear the rotating disks clearly and there are also unexpected lags while a disk IO auf around 700 MB/sec shows that it's basicly working - but in some cases the performance when opening applications sucks compareable as before with 4x2 TB HDDpretty sure the lags are coming because read-access is also spread to HDD - why is that isntead only hand over writes to them which are expected to keep as slow as without any SSD in the array?/dev/md2: Version : 1.1 Creation Time : Wed Jun 8 13:10:56 2011 Raid Level : raid10 Array Size : 3875222528 (3695.70 GiB 3968.23 GB) Used Dev Size : 1937611264 (1847.85 GiB 1984.11 GB) Raid Devices : 4 Total Devices : 4 Persistence : Superblock is persistent Intent Bitmap : Internal Update Time : Sat Feb 11 15:10:31 2017 State : active Active Devices : 4Working Devices : 4 Failed Devices : 0 Spare Devices : 0 Layout : near=2 Chunk Size : 512K Name : localhost.localdomain:2 (local to host localhost.localdomain) UUID : ea253255:cb915401:f32794ad:ce0fe396 Events : 1818029 Number Major Minor RaidDevice State 4 8 35 0 active sync set-A writemostly /dev/sdc3 5 8 19 1 active sync set-B /dev/sdb3 7 8 51 2 active sync set-A writemostly /dev/sdd3 6 8 3 3 active sync set-B /dev/sda3 Quoting from the mdadm man page, the "--write-mostly" section:"This is valid for RAID1 only and means that...."As RAID10 is not RAID1, it is expected that writemostly doesn't work.it does work but not as effective as it should, otherwise the performance difference of this identical setups (cloned by move 2 disks from one machine to the other and rebuild the RAID's with 2 new disks in both) would not be possible[root@srv-rhsoft:~]$ hdparm -Tt /dev/md2/dev/md2: Timing cached reads: 23974 MB in 1.99 seconds = 12038.71 MB/sec Timing buffered disk reads: 2400 MB in 3.00 seconds = 798.92 MB/sec[root@rh:~]$ hdparm -Tt /dev/md2/dev/md2: Timing cached reads: 22224 MB in 1.99 seconds = 11157.92 MB/sec Timing buffered disk reads: 1084 MB in 3.00 seconds = 361.10 MB/sec RAID10 is more or less RAID0 + RAID1It does not work *at*all*. The raid10 code does not test the write-mostly flag at all. There must be some other explanation for the performance difference.In an abstract sense, this is true.However the code in the md/raid10 module it quite different from the code in the md/raid1 and md/raid0 modules.md/raid1 supports write-mostly and write-behind, which md/raid10 code does not.well, than please change it to a feature requestRAID10 with "writemostly" makes a lot of sense for large storages to get them fast *and* reliable without make it extremly expensive * you don't want RAID5/RAID6 rebuild over many TB* very large SSD für RAID1 are much more expensive than smaller onesso with 4x2 TB disks you get 4 TB useable storage and with "writemostly" which would be in the best case "writeonly" you have a lightening fast RAID0 with good redundancy and most workloads are read-intense with less writesanother benefit: different technologies - it's very unlikely that both disks of a stripe fail at the same time or due rebuild when one half is a SSD and the other a HDDA feature request makes some sense.However, a feature request without code doesn't get a very high priority.I suggest your best bet would be to send email to, telling the list that you would really like write-behind for RAID10, and why using RAID0 over write-behind-raid1 doesn't provide a sufficient solution.Maybe others will agree. Maybe someone will get enthusiastic.I'll re-open this bug and label it as a "feature request", but I don't know that doing so will serve much of a useful purpose.
id=87581	CreateddmesgI notice a random freeze every 5~10 boots with kernel 3.17.1 and 3.17.2,every 5~10 boots a freeze can occur shortly after the load of the kernel, I can see these messages on screen and then nothing, it seems like a freeze ::: running early hook [udev]:: running hook [udev]:: Triggering uvents...sometimes the freeze happens a few seconds after systemd starts ( after the message "mount /home" for example )I suspect the new loading mode of "intel-ucode" package, maybe it can bring some collision/timing problems ?my configuration :archlinux 64 bitscpu pentium dual core E6800 3.33 Ghzati radeon HD4650 PCIe ( radeon open source driver, KMS early start )I use the "kernel mode setting" early start mode, in /etc/mkinitcpio.conf I have this line :MODULES="radeon" CreateddmesgdmesgCreatedthe kernel trace 120 seconds after the freezein fact the culprit is not intel-ucode, because if I disable the microcode update I still have the random freeze on boot,when the freeze occurs few seconds after the start of systemd a kernel message will occur after 120 seconds of inactivity of systemd, here is the screenshot of this message in attachmentI found the culprit: it was systemd 216.3,If I upgrade to the testing version of systemd ( 217.3 ) the bug is gone, no problemswell I was too optimistic, because after further tests I have again the bugI tested with kernel 3.18rc3 and the bug is still here,every 5~10 boots I have a freeze shortly after the kernel has been loaded,it's not normal, because with kernel 3.16.x I don't have this problemplease I need help,when the bug occurs I can read sometimes these error messages ::: running hook [udev]:: Triggering uevents...worker [53] /devices/pci0000:00/0000:00:1f.2/ata8/host7/target7:0:1/7:0:1:0 is taking a long timeworker [60] /devices/pci0000:00/0000:00:1f.2/ata7/host6/target6:0:0/6:0:0:0/block/sr0 is taking a long timeIf I use 3.16.4 then there is no problems, all is ok,so there is a big problem with kernel 3.17.x and 3.18.x, sometimes a bad initialisation at boot with my PC, probably the harddisks and/or the PCI devices, something that triggers a freezeCreatederror message when freeze occurs with kernel 3.17 and 3.18error message when freeze occurs at boot with kernel 3.17 and 3.18another user in archlinux forums has the same problem :I suspect on of these 3 commits to be the culprit for the race condition :commit 1d3408209d43d2e72b5d8dbfb9b60fece399d75bAuthor: Frederic Weisbecker <>Date: Sat Aug 16 18:47:15 2014 +0200 x86: Tell irq work about self IPI support commit 3010279f0fc36f0388872203e63ca49912f648fd upstream. x86 supports irq work self-IPIs when local apic is available. This is partly known on runtime so lets implement arch_irq_work_has_interrupt() accordingly. This should be safely called after setup_arch(). Acked-by: Peter Zijlstra (Intel) <> Cc: Ingo Molnar <> Cc: Paul E. McKenney <> Cc: Peter Zijlstra <> Cc: Thomas Gleixner <> Signed-off-by: Frederic Weisbecker <> Signed-off-by: Greg Kroah-Hartman <>commit 6fd5de08a5337d0d601f6361671813df4f013da9Author: Frederic Weisbecker <>Date: Sat Aug 16 18:37:19 2014 +0200 irq_work: Force raised irq work to run on irq work interrupt commit 76a33061b9323b7fdb220ae5fa116c10833ec22e upstream. The nohz full kick, which restarts the tick when any resource depend on it, can't be executed anywhere given the operation it does on timers. If it is called from the scheduler or timers code, chances are that we run into a deadlock. This is why we run the nohz full kick from an irq work. That way we make sure that the kick runs on a virgin context. However if that's the case when irq work runs in its own dedicated self-ipi, things are different for the big bunch of archs that don't support the self triggered way. In order to support them, irq works are also handled by the timer interrupt as fallback. Now when irq works run on the timer interrupt, the context isn't blank. More precisely, they can run in the context of the hrtimer that runs the tick. But the nohz kick cancels and restarts this hrtimer and cancelling an hrtimer from itself isn't allowed. This is why we run in an endless loop: Kernel panic - not syncing: Watchdog detected hard LOCKUP on cpu 2 CPU: 2 PID: 7538 Comm: kworker/u8:8 Not tainted 3.16.0+ #34 Workqueue: btrfs-endio-write normal_work_helper [btrfs] ffff880244c06c88 000000001b486fe1 ffff880244c06bf0 ffffffff8a7f1e37 ffffffff8ac52a18 ffff880244c06c78 ffffffff8a7ef928 0000000000000010 ffff880244c06c88 ffff880244c06c20 000000001b486fe1 0000000000000000 Call Trace: <NMI[<ffffffff8a7f1e37>] dump_stack+0x4e/0x7a [<ffffffff8a7ef928>] panic+0xd4/0x207 [<ffffffff8a1450e8>] watchdog_overflow_callback+0x118/0x120 [<ffffffff8a186b0e>] __perf_event_overflow+0xae/0x350 [<ffffffff8a184f80>] ? perf_event_task_disable+0xa0/0xa0 [<ffffffff8a01a4cf>] ? x86_perf_event_set_period+0xbf/0x150 [<ffffffff8a187934>] perf_event_overflow+0x14/0x20 [<ffffffff8a020386>] intel_pmu_handle_irq+0x206/0x410 [<ffffffff8a01937b>] perf_event_nmi_handler+0x2b/0x50 [<ffffffff8a007b72>] nmi_handle+0xd2/0x390 [<ffffffff8a007aa5>] ? nmi_handle+0x5/0x390 [<ffffffff8a0cb7f8>] ? match_held_lock+0x8/0x1b0 [<ffffffff8a008062>] default_do_nmi+0x72/0x1c0 [<ffffffff8a008268>] do_nmi+0xb8/0x100 [<ffffffff8a7ff66a>] end_repeat_nmi+0x1e/0x2e [<ffffffff8a0cb7f8>] ? match_held_lock+0x8/0x1b0 [<ffffffff8a0cb7f8>] ? match_held_lock+0x8/0x1b0 [<ffffffff8a0cb7f8>] ? match_held_lock+0x8/0x1b0 <<EOE><IRQ[<ffffffff8a0ccd2f>] lock_acquired+0xaf/0x450 [<ffffffff8a0f74c5>] ? lock_hrtimer_base.isra.20+0x25/0x50 [<ffffffff8a7fc678>] _raw_spin_lock_irqsave+0x78/0x90 [<ffffffff8a0f74c5>] ? lock_hrtimer_base.isra.20+0x25/0x50 [<ffffffff8a0f74c5>] lock_hrtimer_base.isra.20+0x25/0x50 [<ffffffff8a0f7723>] hrtimer_try_to_cancel+0x33/0x1e0 [<ffffffff8a0f78ea>] hrtimer_cancel+0x1a/0x30 [<ffffffff8a109237>] tick_nohz_restart+0x17/0x90 [<ffffffff8a10a213>] __tick_nohz_full_check+0xc3/0x100 [<ffffffff8a10a25e>] nohz_full_kick_work_func+0xe/0x10 [<ffffffff8a17c884>] irq_work_run_list+0x44/0x70 [<ffffffff8a17c8da>] irq_work_run+0x2a/0x50 [<ffffffff8a0f700b>] update_process_times+0x5b/0x70 [<ffffffff8a109005>] tick_sched_handle.isra.21+0x25/0x60 [<ffffffff8a109b81>] tick_sched_timer+0x41/0x60 [<ffffffff8a0f7aa2>] __run_hrtimer+0x72/0x470 [<ffffffff8a109b40>] ? tick_sched_do_timer+0xb0/0xb0 [<ffffffff8a0f8707>] hrtimer_interrupt+0x117/0x270 [<ffffffff8a034357>] local_apic_timer_interrupt+0x37/0x60 [<ffffffff8a80010f>] smp_apic_timer_interrupt+0x3f/0x50 [<ffffffff8a7fe52f>] apic_timer_interrupt+0x6f/0x80 To fix this we force non-lazy irq works to run on irq work self-IPIs when available. That ability of the arch to trigger irq work self IPIs is available with arch_irq_work_has_interrupt(). Reported-by: Catalin Iacob <> Reported-by: Dave Jones <> Acked-by: Peter Zijlstra (Intel) <> Cc: Ingo Molnar <> Cc: Paul E. McKenney <> Cc: Peter Zijlstra <> Cc: Thomas Gleixner <> Signed-off-by: Frederic Weisbecker <> Signed-off-by: Greg Kroah-Hartman <>commit b677a767bcb3b9fbb4c7f921e5ba9577f1577049Author: Peter Zijlstra <>Date: Sat Sep 6 15:43:02 2014 +0200 irq_work: Introduce arch_irq_work_has_interrupt() commit c5c38ef3d70377dc504a6a3f611a3ec814bc757b upstream. The nohz full code needs irq work to trigger its own interrupt so that the subsystem can work even when the tick is stopped. Lets introduce arch_irq_work_has_interrupt() that archs can override to tell about their support for this ability. Signed-off-by: Peter Zijlstra <> Cc: Ingo Molnar <> Cc: Paul E. McKenney <> Cc: Peter Zijlstra <> Cc: Thomas Gleixner <> Signed-off-by: Frederic Weisbecker <> Signed-off-by: Greg Kroah-Hartman <>when I said "freeze" it's not really a freeze, because my keyboard is still alive ( num, shift, alt and caps keys works ), it's a freeze in terms of "the boot has suddenly stopped", it's seems that the kernel or systemd wait something on boot when the random bug occurs, and they can't go further in the boot process, I have to do a reset with the "reset" button,I'm doing a git bisect between 3.16.7 ( who doesn't have the bug ) and kernel 3.17 ( who has the bug ) in order to find the commit who has introduced this bugI found the commit who has introduced the bug after doing a git bisect,the first bad commit is :first bad commit: [045065d8a300a37218c548e9aa7becd581c6a0e8] [SCSI] fix qemu boot hang problemdiff --git a/drivers/scsi/scsi_lib.c b/drivers/scsi/scsi_lib.cindex 9c44392..ce62e87 100644--- a/drivers/scsi/scsi_lib.c+++ b/drivers/scsi/scsi_lib.c@@ -1774,7 +1774,7 @@ static void scsi_request_fn(struct request_queue *q)blk_requeue_request(q, req);atomic_dec(&sdev->device_busy);out_delay:- if (atomic_read(&sdev->device_busy) && !scsi_device_blocked(sdev))+ if (!atomic_read(&sdev->device_busy) && !scsi_device_blocked(sdev))blk_delay_queue(q, SCSI_QUEUE_DELAY);}the author of this faulty commit is Guenter Roeck <> , maybe someone should contact him, in order to warn him that his patch triggers a bug on some PC configuration ( like my PC )Createdthe log of the git bisectthe log of the git bisectCreatedrevert the faulty commit 045065d8a300a37218c548e9aa7becd581c6a0e8I create a patch who solves the bug,this patch reverts the faulty commit 045065d8a300a37218c548e9aa7becd581c6a0e8Createdsecond bisectsecond bisectCreatedincrease the time in line 1779 of scsi_lib.ca new patch who solves the problem by increasing the time ( 40 ms instead of 3 ms ) in line 1779 for blk_delay_queue() functionI solved the mystery,I found that the element who triggers the bug ( random hang at boot withkernel 3.17 and 3.18 ) is the combination of 3 elements :- the use of a SATA DVD burner ( Liteon iHAS124 C ) on a ICH7 Sata controler- the use of a gigabyte motherboard GA-P31-DSL3 ( bios F10A, ICH7controler, intel P31 chipset )- commit 74665016086615bbaa3fa6f83af410a0a4e029ee ( scsi: converthost_busy to atomic_t )If I connect this Sata DVD burner and a sata harddisk by using the SATAports of the motherboard then the bug will occur ( but the bug willoccur only on kernels 3.17 and 3.18, there is no problems with olderkernels, and no problems with Windows 7 )If I disconnect the SATA DVD burner then the bug is gone, no problemswith kernels 3.17 and 3.18,And if I connect the SATA DVD burner on my JMicron SATA/IDE PCIe cardthen there is no problem, no bugs, this is a perfect workaround for myproblem, because I can use kernel 3.17/3.18 without problem with thisconfiguration.But I don't know which element I should blame, my gigabyte motherboard ?( faulty bios ? ) The use of "atomic_t" in scsi source code ? (innapropriate way to handle SATA devices, it breaks compatibility withsome PC configurations ? )Createdtest patchtest patch made by a linux developer who solves the bugThe patch in(increase delay time) solves the issue for me, too: no more hung tasks for some 20 boots.My hardware is a bit different: i7 Haswell (with early microcode upload), MSI Z87-G43 board with SSD, HD and DVD attached to the SATA ports. One common thing may be the JMicron JMB363 SATA/IDE controller on PCIe, used for legacy drives.Hung tasks appeared for the HD attached to the MB and more frequently for IDE DVD drives attached to the JMicron controller. In the first case the file systems on the HD did not show up and mount hung. In the latter case, typically cdrom_id triggered the watchdog message and the start of the kde session did not complete.I had issues with older drives connected to the JMicron controller before. So this is the major suspect for me. Hung tasks only appeared with kernel 3.17, though. I could also try the patch inif it is considered to be less of a workaround.(In reply to gdpt from)yes you should try this patch :the bug seems triggered if a slow device ( DVD burner ) is mixed with a fast device ( hard disk ) on the same IDE/SATA channel,the bug also seems triggered if you use the "IDE emulation mode" option in your bios settings instead of the "AHCI" mode, and if a slow device ( DVD burner ) is connected,so you can try a test : remove your IDE DVD burner, without the DVD burner the bug should disapearThe second patch also seems to solve the issue (>10 boots).Your theory fits my original set-up with different IDE drives on the JMicron controller. Later, I must have set the MB to IDE mode in an attempt to stabilize the system, causing new hangs with the HD and a DVD burner.It seems that my setup is also affected by this bug. I've go GA-MA790X-DS4 motherboard with DVD burner and HD mixed on ATA (not SATA) channel. Patch fromfixes locks also for me (>10 boots).Who's that patch from? And can somebody dust it off and post it w/ proper description?(In reply to Tejun Heo from)this patch comes from a linux developper ( Christoph Hellwig )I also have this issue, although I do not have a intel chipset motherboard, but rather the Gigabyte 990fxa-UD3. I also have a dvd burner attached to my SATA port. I will try removing the DVD burner and reporting back.Removing the DVD burner from the MARVEL SATA connection did not change the issue for me. However switching my MARVEL SATA ports from AHCI back to IDE seems to immediately cause my boot process to be faster and I have yet to run into a boot lockup.
id=48161	I have trouble with Touchpad. (Notebook Samsung 350u2b).OS: Archlinux.Sometimes touchpad not workinkg.That happens when one finger in the lower left corner, and the other finger onthe center of the touchpad.$ xinput list | grep Touchpad⎜ ↳ ETPS/2 Elantech Touchpad id=12 [slave pointer (2)]$dmesg[ 5886.135442] psmouse serio1: Touchpad at isa0060/serio1/input0 lost sync at byte 6[ 5886.147474] psmouse serio1: Touchpad at isa0060/serio1/input0 - driver resynced.[ 5973.254436] psmouse serio1: Touchpad at isa0060/serio1/input0 lost sync at byte 6[ 5973.271490] psmouse serio1: Touchpad at isa0060/serio1/input0 - driver resynced.[ 6008.335635] psmouse serio1: Touchpad at isa0060/serio1/input0 lost sync at byte 6[ 6008.356095] psmouse serio1: Touchpad at isa0060/serio1/input0 - driver resynced.[ 6172.043921] psmouse serio1: Touchpad at isa0060/serio1/input0 lost sync at byte 6[ 6172.079316] psmouse serio1: Touchpad at isa0060/serio1/input0 - driver resynced.[ 7084.386385] psmouse serio1: Touchpad at isa0060/serio1/input0 lost sync at byte 6[ 7084.411297] psmouse serio1: Touchpad at isa0060/serio1/input0 - driver resynced.[ 7299.066706] psmouse serio1: Touchpad at isa0060/serio1/input0 lost sync at byte 6[ 7299.086690] psmouse serio1: Touchpad at isa0060/serio1/input0 - driver resynced.Solution, Just reload psmouse module.$rmmod psmouse$modprobe psmouseKernel:$uname -aLinux samsung 3.5.4-1-ARCH #1 SMP PREEMPT Sat Sep 15 08:12:04 CEST 2012 x86_64GNU/Linux I'm having issues with the touchpad on a Lenovo L430 that I think may be related to this bug. OS: Debian 6.0.6Kernel built from source: $ uname -aLinux l430kl 3.6.3 #1 SMP Mon Oct 22 00:23:26 WET 2012 i686 GNU/Linumodprobe psmouse shows an elantech touchpad: [ 246.143243] psmouse serio1: elantech: assuming hardware version 3 (with firmware version 0x350f02)[ 246.156668] psmouse serio1: elantech: Synaptics capabilities query result 0xb9, 0x15, 0x0c.[ 246.225833] input: ETPS/2 Elantech Touchpad as /devices/platform/i8042/serio1/input/input14As does /proc/bus/input/devices: I: Bus=0011 Vendor=0002 Product=000e Version=0000N: Name="ETPS/2 Elantech Touchpad"P: Phys=isa0060/serio1/input0S: Sysfs=/devices/platform/i8042/serio1/input/input14U: Uniq=H: Handlers=mouse0 event6 B: PROP=1B: EV=bB: KEY=6420 0 30000 0 0 0 0 0 0 0 0B: ABS=2608000 11000003However X11 is seeing a Synaptics touchpad: $ xinput list⎡ Virtual core pointer id=2 [master pointer (3)]⎜ ↳ Virtual core XTEST pointer id=4 [slave pointer (2)]⎜ ↳ SynPS/2 Synaptics TouchPad id=10 [slave pointer (2)]⎜ ↳ PS/2 Generic Mouse id=11 [slave pointer (2)]⎜ ↳ Macintosh mouse button emulation id=12 [slave pointer (2)]⎣ Virtual core keyboard id=3 [master keyboard (2)] ↳ Virtual core XTEST keyboard id=5 [slave keyboard (3)] ↳ Power Button id=6 [slave keyboard (3)] ↳ Video Bus id=7 [slave keyboard (3)] ↳ Sleep Button id=8 [slave keyboard (3)] ↳ AT Translated Set 2 keyboard id=9 [slave keyboard (3)] ↳ ACPI Virtual Keyboard Device id=13 [slave keyboard (3)]On my laptop the trackpad and two buttons below it work but using the "eraser head" produces the lost sync errors and it doesn't function at all: Oct 24 01:07:54 l430kl kernel: [ 522.465744] psmouse serio1: Touchpad at isa0060/serio1/input0 lost sync at byte 6Oct 24 01:07:54 l430kl kernel: [ 522.480254] psmouse serio1: Touchpad at isa0060/serio1/input0 lost sync at byte 6Oct 24 01:07:54 l430kl kernel: [ 522.494767] psmouse serio1: Touchpad at isa0060/serio1/input0 lost sync at byte 6Oct 24 01:07:54 l430kl kernel: [ 522.509280] psmouse serio1: Touchpad at isa0060/serio1/input0 lost sync at byte 6Oct 24 01:07:54 l430kl kernel: [ 522.552569] psmouse serio1: Touchpad at isa0060/serio1/input0 lost sync at byte 6Oct 24 01:07:54 l430kl kernel: [ 522.552578] psmouse serio1: issuing reconnect requestI'm running Debian 6.0.6 with a mainline kernel built from source: Reloading the psmouse module does not fix the problem for me.Sorry that "xinput list" isn't accurate as I was running it remotely (duh). Here's the proper output: $ xinput list⎡ Virtual core pointer id=2 [master pointer (3)]⎜ ↳ Virtual core XTEST pointer id=4 [slave pointer (2)]⎜ ↳ ETPS/2 Elantech Touchpad id=10 [slave pointer (2)]⎣ Virtual core keyboard id=3 [master keyboard (2)] ↳ Virtual core XTEST keyboard id=5 [slave keyboard (3)] ↳ Power Button id=6 [slave keyboard (3)] ↳ Video Bus id=7 [slave keyboard (3)] ↳ Sleep Button id=8 [slave keyboard (3)] ↳ AT Translated Set 2 keyboard id=9 [slave keyboard (3)] ↳ ThinkPad Extra Buttons id=11 [slave keyboard (3)]$So X does see it as an Elantech touchpad. However the touchpoint (or eraser head) and top 3 mouse buttons on the trackpad do not work.p.s. I've tried this with 3.0.4, 3.6.3 and now 3.6.5.I have a L530 and was struggling with the same problem as Keith Lawson.I found a solution, but the patch needs some polishing still:Can you give me feedback on:1) Does the patch solve it on your hardware ?2) what is the result on your hardware of dmesg | grep elantechWhat additional data is required? This bug still exists the last time I tested in 3.10.x. Ulrik sent his patch to the mailing list and didn't receive any response the last time I checked.There also appears to be reports about missing support for this device as recently as Oct 2/2013:Best thing is probably to chase Dmitry up - patches get missed, people get busy - don't assume no response is a no, it may simply be nobody had time to look at it.(In reply to Alan from)Will do. Thanks for the advice.The Patch from the mailing list posted by Ulrik De Bie tries to fix this issue by creating another device inside the elantech driver.But when comparing the output of the following command on an X220t:ls -lah /sys/bus/serio/devicestotal 0drwxr-xr-x 2 root root 0 Nov 23 2013 .drwxr-xr-x 4 root root 0 Nov 23 2013 ..lrwxrwxrwx 1 root root 0 Nov 23 2013 serio0 -> ../../../devices/platform/i8042/serio0lrwxrwxrwx 1 root root 0 Nov 23 2013 serio1 -> ../../../devices/platform/i8042/serio1lrwxrwxrwx 1 root root 0 Nov 23 13:14 serio2 -> ../../../devices/platform/i8042/serio1/serio2With that on my L530:ls -lah /sys/bus/serio/devices total 0drwxr-xr-x 2 root root 0 Nov 23 13:03 ./drwxr-xr-x 4 root root 0 Nov 23 12:59 ../lrwxrwxrwx 1 root root 0 Nov 23 13:10 serio0 -> ../../../devices/platform/i8042/serio0/lrwxrwxrwx 1 root root 0 Nov 23 13:03 serio1 -> ../../../devices/platform/i8042/serio1/To me it seems like a muxing-related problem within the i8042 driver. I will have a look at it later.Regards, SockePatch was resubmitted from a proper git a month ago:I'll send a reminder to Dmitry.With CONFIG_MOUSE_PS2_ELANTECH enabled, my touchpad in a Fujitsu H730 does not work at all but reports the above errors (and does not do much without that option, but better than nothing). Applying the above patch does not change anything when CONFIG_MOUSE_PS2_ELANTECH=y). It claims to be hardware version 4 though. I did not reboot yet, though, but simply reloaded the psmouse driver.[38034.524891] psmouse serio4: elantech: assuming hardware version 4 (with firmware version 0x570f00)[38034.538399] psmouse serio4: elantech: Synaptics capabilities query result 0xc0, 0x14, 0x0c.[38034.628480] input: ETPS/2 Elantech Touchpad as /devices/platform/i8042/serio4/input/input98...[39392.108664] psmouse serio4: Touchpad at isa0060/serio4/input0 lost sync at byte 6[39392.144599] psmouse serio4: issuing reconnect request(In reply to nukleus from)I got in contact with nukleus, and with some other fixes on top of my patch we were able to get the Fujitsu H730 working. I'm verifying a few things still, and then I'll prepare a proper updated patchset to the linux-input mailinglist and Dmitry.Meanwhile this bug is being fixed, to stop the errors/messages on dmesg, do a rmmod psmouse ; modprobe psmouse proto=bareUpdated patch has been posted to linux-input based on reviewing comments from Hans de Goede.Createdelantech_v2.patchThis has been an annoying issue I have eagerly been waiting to see solved for months. For anyone who has an Lenovo L530, this patch works. I patched Gentoo-sources-3.15.0 but the patched files should be identical to the vanilla kernel.$ uname -aLinux localhost 3.15.0-gentoo #6 SMP Mon Jun 16 18:45:55 EDT 2014 x86_64 Intel(R) Core(TM) i5-3320M CPU @ 2.60GHz GenuineIntel GNU/Linux$ dmesg | grep -i mouse[ 1.437205] mousedev: PS/2 mouse device common for all mice[ 2.075761] psmouse serio1: elantech: assuming hardware version 3 (with firmware version 0x350f02)[ 2.090085] psmouse serio1: elantech: Synaptics capabilities query result 0xb9, 0x15, 0x0c.Both patches above lack v4 support, but replicating the stuff done in _v3-functions to the _v4-functions looks easy. I'd be more than happy to test the final patch with my v4 hardware. In the meantime, I'm using Ulriks patches.An updated patch has now been approved by Dmitry (see).A patch set for the Fujitsu H730 was proposed on linux-input:possible duplicatehas similarities: elantech touchpad and lost sync at byte 6
id=41752	Createddmesg when trying to connect the diskHardware: Toshiba Satellite L755USB:08:00.0 USB Controller: NEC Corporation uPD720200 USB 3.0 Host Controller (rev 04)Peripherals: Logilink USB 3.0 to SATA HDD Adapter with Western Digital WD2500JSWhen the external disk is connected to a USB 2.0 port, it is detected and can be mounted. When it is connected to the USB 3.0 port, the drive starts spinning and there are entries in dmesg, but the external disk cannot be mounted. After adding some trace statements to the source (linux-3.1.0-rc3-1-vanilla/drivers/usb/core/hub.c) I found the reason for the failure in function hub_port_reset. Either the Logilink USB 3.0 to SATA HDD Adapter or the NEC Corporation uPD720200 USB 3.0 Host Controller responds to this request by changing the pair status/status change from 0x203/0x1 to 0x2c0/0x51. To this the function hub_port_wait_reset responds with the error code -ENOTCONN.By modifying function hub_port_wait_reset from /* Device went away? */ if (!(portstatus & USB_PORT_STAT_CONNECTION)) return -ENOTCONN; /* bomb out completely if the connection bounced */ if ((portchange & USB_PORT_STAT_C_CONNECTION)) return -ENOTCONN;to if (hub->hdev->descriptor.bcdUSB != 0x300) { /* Device went away? */ if (!(portstatus & USB_PORT_STAT_CONNECTION)) return -ENOTCONN; /* bomb out completely if the connection bounced */ if ((portchange & USB_PORT_STAT_C_CONNECTION)) return -ENOTCONN; } else { if (!(portstatus & USB_PORT_STAT_CONNECTION) && !(portchange & USB_PORT_STAT_C_CONNECTION)) return -ENOTCONN; }I got the disk to run. Timing measured with hdparm is as following:The internal disk: Timing buffered disk reads: 228 MB in 3.04 seconds = 75.02 MB/secThe external disk connected via USB 3.0: Timing buffered disk reads: 172 MB in 3.02 seconds = 56.93 MB/secThe external disk connected via USB 2.0: Timing buffered disk reads: 94 MB in 3.01 seconds = 31.24 MB/secSo the hack seems to work at least partially. There remain two open points:Firstly, I do not know whether there is a firmware bug or a programming bug, though the problem probably is with the firmware.Secondly, when the disk is disconnected from the USB 3.0 port, the entry in /dev remains. When the disk is disconnected from the USB 2.0 port, the corresponding /dev/entry disappears.That's not a feasible fix, because it won't ever allow your device to disconnect (as you noticed when the /dev entry didn't go away).Can you please try updating the firmware on your NEC host controller first? We've had some issues with devices not being able to connect (or at least not connect at high speed) that were fixed with a firmware upgrade.I'll have a look at your dmesg output in the mean time.Your dmesg is completely garbled (lots of unicode characters? Did you upload an executable?). Can you re-upload it?CreatedThe original dmesg unzippedDo not consider the code modification as a fix, but as a hack. I am simply trying to find out why the USB 3.0 port does not work with Linux. With Windows 7, the disk is detected (and shown in the Windows Explorer) on connecting to the port and removed from the Windows Explorer when disconnecting from the port, so the USB 3.0 port seems to conform to USB 3.0 specs to a certain degree.As to updating the firmware: I do not even find the controller on the NEC site. Also, Windows gives the controller another product name (I took the name from lspci). Lastly, I don't even know how to upgrade controller firmware :(. Finally, the hack may prevent the external disk from properly disconnecting. However, I think some trace of a disconnecting event should be found in dmesg. But there is nada - no call to hub_irq, no call of hub_events .. simply nothing.Hello Sarah,the current implementation of function hub_port_wait_reset returns -ENOTCONN even during the ongoing reset. I propose to ignore changes of connection state during reset. So instead of static int hub_port_wait_reset(struct usb_hub *hub, int port1, struct usb_device *udev, unsigned int delay){ int delay_time, ret; u16 portstatus; u16 portchange; for (delay_time = 0; delay_time < HUB_RESET_TIMEOUT; delay_time += delay) { /* wait to give the device a chance to reset */ msleep(delay); /* read and decode port status */ ret = hub_port_status(hub, port1, &portstatus, &portchange); if (ret < 0) return ret; /* Device went away? */ if (!(portstatus & USB_PORT_STAT_CONNECTION)) return -ENOTCONN; /* bomb out completely if the connection bounced */ if ((portchange & USB_PORT_STAT_C_CONNECTION)) return -ENOTCONN; /* if we`ve finished resetting, then break out of the loop */ if (!(portstatus & USB_PORT_STAT_RESET) && (portstatus & USB_PORT_STAT_ENABLE)) { if (hub_is_wusb(hub)) udev->speed = USB_SPEED_WIRELESS; else if (hub_is_superspeed(hub->hdev)) udev->speed = USB_SPEED_SUPER; else if (portstatus & USB_PORT_STAT_HIGH_SPEED) udev->speed = USB_SPEED_HIGH; else if (portstatus & USB_PORT_STAT_LOW_SPEED) udev->speed = USB_SPEED_LOW; else udev->speed = USB_SPEED_FULL; return 0; } /* switch to the long delay after two short delay failures */ if (delay_time >= 2 * HUB_SHORT_RESET_TIME) delay = HUB_LONG_RESET_TIME; dev_dbg (hub->intfdev, "port %d not reset yet, waiting %dms\n", port1, delay); } return -EBUSY;}the following implementation:static int hub_port_wait_reset(struct usb_hub *hub, int port1, struct usb_device *udev, unsigned int delay){ int delay_time, ret; u16 portstatus; u16 portchange; for (delay_time = 0; delay_time < HUB_RESET_TIMEOUT; delay_time += delay) { /* wait to give the device a chance to reset */ msleep(delay); /* read and decode port status */ ret = hub_port_status(hub, port1, &portstatus, &portchange); if (ret < 0) return ret; /* if we`ve finished resetting, then break out of the loop */ if (!(portstatus & USB_PORT_STAT_RESET) && (portstatus & USB_PORT_STAT_ENABLE)) { /* Device went away? */ if (!(portstatus & USB_PORT_STAT_CONNECTION)) return -ENOTCONN; if (hub_is_wusb(hub)) udev->speed = USB_SPEED_WIRELESS; else if (hub_is_superspeed(hub->hdev)) udev->speed = USB_SPEED_SUPER; else if (portstatus & USB_PORT_STAT_HIGH_SPEED) udev->speed = USB_SPEED_HIGH; else if (portstatus & USB_PORT_STAT_LOW_SPEED) udev->speed = USB_SPEED_LOW; else udev->speed = USB_SPEED_FULL; return 0; } /* switch to the long delay after two short delay failures */ if (delay_time >= 2 * HUB_SHORT_RESET_TIME) delay = HUB_LONG_RESET_TIME; dev_dbg (hub->intfdev, "port %d not reset yet, waiting %dms\n", port1, delay); } /* Device went away? */ if (!(portstatus & USB_PORT_STAT_CONNECTION)) return -ENOTCONN; /* bomb out completely if the connection bounced */ if ((portchange & USB_PORT_STAT_C_CONNECTION)) return -ENOTCONN; return -EBUSY;}This allows devices to report a disconnect during reset. Or is there something in the USB specs that prohibits this handling of feature RESET?Here's what I think is happening:[ 681.859162] xhci_hcd 0000:08:00.0: Port Status Change Event for port 1...[ 681.978459] xhci_hcd 0000:08:00.0: get port status, actual port 0 status = 0x1203# The SuperSpeed device shows up fine, port status = enabled, CSC, U0 state, powered, superspeed# slot ID is allocated[ 681.978690] xhci_hcd 0000:08:00.0: set port reset, actual port 0 status = 0x1311# port status = CSC, disabled, port in reset, recovery, powered, superspeed# (Not sure why the port is disabled here.)[ 681.978700] xhci_hcd 0000:08:00.0: Port Status Change Event for port 1[ 682.034421] xhci_hcd 0000:08:00.0: get port status, actual port 0 status = 0x6202c0# status = disconnected, disabled, no reset in progress, inactive link state, powered, unknown speed, connect status changeI think the hot port reset failed here, and we need to do a warm port reset. This is what usually needs to be done when the port link state is in the inactive state. The host controller is supposed to try warm port reset if hot reset fails, but it's possible your host controller does not, or it's possible your host controller is in the middle of an automatic warm port reset when we read the port status register. In any case, I'll whip up a patch to start a warm port reset when the SuperSpeed device state is in inactive and the device is disconnected.CreatedPatch to try warm reset if USB3 port reports a disconnect & inactive link state.Harald, please try out this patch.Created/var/log/messages when the patch is applied (gzipped)Hello Sarah,The suggested patch does not work for my USB 3.0. hub_port_wait_reset does not return an error, but the hub still doesn't work. The disk was plugged in at 20:18:26. Maybe the problem is nowSep 6 20:18:27 HATOSH kernel: [ 88.503250] usb 4-1: Device not responding to set address.Sep 6 20:18:27 HATOSH kernel: [ 88.706747] usb 4-1: device not accepting address 4, error -71A patch referencing this bug report has been merged in Linux v3.2-rc1:commit 10d674a82e553cb8a1f41027bb3c3e309b3f6804Author: Sarah Sharp <>Date: Wed Sep 14 14:24:52 2011 -0700 USB: When hot reset for USB3 fails, try warm reset.My USB3.0 port with kernel 3.2.0-rc1-286-gd291ffb-1-vanilla and later now works out of the box.Status can be set to resolved.A patch referencing a commit referencing this bug report has been merged in Linux v3.5-rc7:commit 8bea2bd37df08aaa599aa361a9f8b836ba98e554Author: Stanislaw Ledwon <>Date: Mon Jun 18 15:20:00 2012 +0200 usb: Add support for root hub port status CASA patch referencing a commit referencing this bug report has been merged in Linux v3.6-rc6:commit 71c731a296f1b08a3724bd1b514b64f1bda87a23Author: Alexis R. Cortes <>Date: Fri Aug 3 14:00:27 2012 -0500 usb: host: xhci: Fix Compliance Mode on SN65LVPE502CP HardwareA patch referencing a commit referencing this bug report has been merged in Linux v3.7-rc1:commit 457a73d346187c2cc5d599072f38676f18f130e0Author: Vivek Gautam <>Date: Sat Sep 22 18:11:19 2012 +0530 usb: host: xhci: Fix Null pointer dereferencing with 71c731a for non-x86 systemsA patch referencing a commit referencing this bug report has been merged in Linux v3.8-rc1:commit b0e4e606ff6ff26da0f60826e75577b56ba4e463Author: Alexis R. Cortes <>Date: Thu Nov 8 16:59:27 2012 -0600 usb: host: xhci: Stricter conditional for Z1 system models for Compliance Mode PatchCreatedMake USB 3.0 work on L755D notebookFor the newer kernels supplied by openSuse, my USB 3.0 device again is not recognised. Tested kernel versions are3.4.63-2.44-desktop3.7.10-1.16-desktop3.11.6-4-desktop3.13.0-rc2-1-gaf91706-1-vanillaTaking the patch "USB: When hot reset for USB3 fails, try warm reset." from Date: Tue, 6 Sep 2011 09:53:01 -0700 with some modification to take account of changes in the hub.c source code, I made a patch that makes my USB 3.0 portwork again.It has been tested with openSuse3.11.6-4-vanilla.Please note that I do not know- what I am really doing- why the patch is working- whether the code in the patch ever was part of hub.c, and if so why it was dropped- what side effects the code may haveAll that I know is that it works.Harald:The upstream kernel has the commit you mentioned (commit 10d674a82e55 "USB: When hot reset for USB3 fails, try warm reset."). When you tested 3.13.0-rc2-1-gaf91706-1-vanilla, the kernel should have had that patch. Did 3.13-rc2 fail as well?Can you point me to a URL for the patch you modified? And post the modified patch that fixes your system?Created0002-USB-When-hot-reset-for-USB3-fails-try-warm-reset.patchSarah,I think You mailed me the original patch (attachment0002-USB-When-hot-reset....). My modification is in attachmentMake_USB3.0_port_work...I have not tried 3.13-rc2 from kernel.org, only the version openSuse offers (3.13.0-rc2-1-gaf91706-1-vanilla). However I also tried a 3.12 kernel direct from kernel.org, that did not work either. To me it looks like your patch got lost somewhere in the later 3.4.x versions, maybe in 3.4.63.Am 02.12.2013, 19:10 Uhr, schrieb <>:>>>>CreatedMake_USB3.0_port_work_with_L755D_notebook.patchI have diffed drivers/usb/core/hub.c for versions 3.12 and 3.13-rc2 from kernel.org and 3.11.6-4-vanilla from openSuse and none of these have the special treatment for (!warm) in hub_port_warm_reset_required that was in the patch from Sarah.Createdrevert of beabe20445c60322719d8f58e9eb9dd4660c1b3e for 3.17.1I just posted to linux-usb mailing list about the issue which I think is the same as this one, I'm gonna copy it here:I have 2 very similar USB3 devices that stopped working sometime afterkernel version 3.3 - they fail to enumerate unless I reload xhci_hcddriver.These are the devices:Basically it's some eSATA->USB3 bridge JMicron chip (I'm guessing it'sthe same one in both devices):Bus 009 Device 002: ID 152d:2509 JMicron Technology Corp. / JMicron USA Technology Corp. JMS539 SuperSpeed SATA II 3.0G BridgeThis is USB controller I am testing them with:01:00.0 USB controller: NEC Corporation uPD720200 USB 3.0 Host Controller (rev 03)I even tried upgrading firmware, with no resultIt appears in system as 2 buses (lsusb -t output):/: Bus 09.Port 1: Dev 1, Class=root_hub, Driver=xhci_hcd/2p, 5000M/: Bus 08.Port 1: Dev 1, Class=root_hub, Driver=xhci_hcd/2p, 480MOne for SuperSpeed devices, another for slower.So here's dmesg for when it fails:[ 195.207408] hub 8-0:1.0: unable to enumerate USB device on port 1[ 196.016556] usb 9-1: device not accepting address 2, error -22[ 196.520572] hub 9-0:1.0: unable to enumerate USB device on port 1And here how it should look (when it works):[ 61.686218] hub 8-0:1.0: unable to enumerate USB device on port 1[ 63.620211] usb 9-1: new SuperSpeed USB device number 2 using xhci_hcd[ 63.636918] usb 9-1: New USB device found, idVendor=152d, idProduct=2509[ 63.636932] usb 9-1: New USB device strings: Mfr=1, Product=11, SerialNumber=3[ 63.636942] usb 9-1: Product: Usb production[ 63.636950] usb 9-1: Manufacturer: JMicron[ 63.636956] usb 9-1: SerialNumber: 00A1234578EA[ 63.638549] scsi5 : usb-storage 9-1:1.0[ 64.926983] scsi 5:0:0:0: Direct-Access Jmicron Corp. 0000 PQ: 0 ANSI: 5[ 64.927925] sd 5:0:0:0: Attached scsi generic sg6 type 0[ 64.929912] sd 5:0:0:0: [sdg] Very big device. Trying to use READ CAPACITY(16).[ 64.930353] sd 5:0:0:0: [sdg] 5860533168 512-byte logical blocks: (3.00 TB/2.72 TiB)[ 64.931031] sd 5:0:0:0: [sdg] Write Protect is off[ 64.931042] sd 5:0:0:0: [sdg] Mode Sense: 28 00 00 00[ 64.931764] sd 5:0:0:0: [sdg] No Caching mode page present[ 64.931772] sd 5:0:0:0: [sdg] Assuming drive cache: write through[ 64.932486] sd 5:0:0:0: [sdg] Very big device. Trying to use READ CAPACITY(16).[ 64.933992] sd 5:0:0:0: [sdg] No Caching mode page present[ 64.933997] sd 5:0:0:0: [sdg] Assuming drive cache: write through[ 64.989015] sdg: sdg1 sdg2 sdg3 sdg4[ 64.992112] sd 5:0:0:0: [sdg] Very big device. Trying to use READ CAPACITY(16).[ 64.993885] sd 5:0:0:0: [sdg] No Caching mode page present[ 64.993898] sd 5:0:0:0: [sdg] Assuming drive cache: write through[ 64.993909] sd 5:0:0:0: [sdg] Attached SCSI diskFirst line doesn't always appear, might depend on kernel version, I'mnot sure.I managed to bisect this down to this commit:beabe20445c60322719d8f58e9eb9dd4660c1b3e(it's from 3.4 branch, included in 3.4.36 release, upstream commit idfrom commit message seems to be invalid, at least it's missing onecharacter).I backported reverse of this commit to 3.17.1 (I can't run 3.4 kerneldue to different issues) and it helps with this issue. Patch attachedin case it is helpful, sorry though for whitespace mess, I used nano:)I doubt that just reverting is acceptable solution for mainstreamkernel, so I'm willing to test some other patches (on top of 3.17.1would be best) or provide additional information so that this issuecould be fixed in next releases.Kernel 3.16.6 still has this bug. The patchMake_USB3.0_port_work_with_L755D_notebook.patchstill fixes this bug.Some new resultsfor USB 3.0 and suspend/resume with openSuse 13.2 :Kernel 3.16.7-32-desktop: USB 3.0 and suspend/resume work out of the boxKernel 3.16.7-32-vanilla: USB 3.0 doesn't work, external monitor connected via HDMI stays black after resume from suspend (see)
id=24912	as written in, you still have to issue two commands: mount --bind /vital_data /untrusted_container/vital_data mount -o remount,ro /untrusted_container/vital_datainstead of just one: mount -o bind,ro /vital_data /untrusted_container/vital_dataand worse - you have to create two entries into fstab per each bind-mount to get some directories binded in read-only.not long ago even `mount` utility was confused by this ridiculous behaviour of kernel [] and reported bind-mount with "ro" option while in reality it was in "rw".now it fixed in `mount` and it shows 'rw' but kernel itself still just ignores 'ro' option unless it passed with redundant command/line in fstab.patch from bug URL fixes the issue and makes kernel properly obey (few last lines need to be tweaked a little to apply).they say [] Fedora, probably, have incorporated the fix but mainstream kernel still is not. what the hell, isn't Linus himself uses Fedora ?this is pain in an ass to set up proper logical paths for fileserver at boot-time and an unexpected behaviour. please, do something with it :( It would nice to be told why this was marked as obsolete rather than just going ahead and doing it.Has bind changed? Has it been removed? Anything.............?It was filed against a kernel we no longer care about. If it is still present in current kernels please update the kernel version accordingly.Bugzilla is not however used as a work queue so if you want to change this send patches to the linux filesystem lists.It's true of ALL kernels. I cannot change the version as I do not have admin access.Isn't "version" imply "starting from X and all the way up" ? Because changing it for every single update over years-persistent bugs would be fantastically ridiculous.And it is a "work queue", at least for issues, if not for improvements. The one that may be not directed to someone in particular, but anyone's unwillingness to fix some clearly incorrect behaviour does not justify its denial for everyone.Especially for such a thing, for the introduction of which quite a fuss was made at the time (read-only binds, that is).A lot of reports get filed and then fixed without anyone even realising, or are invalidated simply by other changes so old ones get closed, they are mostly just noise and their time cost exceeds their value in actually being able to find things that do need sorting out.They are still in the database so searches for things like a specific CD drive or a specific oops pattern can still find them.But if you want it to happen then it's sat in bugzilla since 2010, it's not going to suddenely happen. If you want it to happen then I'd do two things- verify if the change is in Fedora as you claim- either grab the Fedora patch or forward put the upstream patch- test it- submit it.This bug seems worse than it might appear. I don't think it's possible to work around this bug by remounting filesystems if one is working inside a container.For example, the following sandbox fails silently due to this bug and working around the bug by remounting fails with EPERM.#define _GNU_SOURCE#include <assert.h>#include <errno.h>#include <fcntl.h>#include <mntent.h>#include <sched.h>#include <stdbool.h>#include <stdio.h>#include <stdlib.h>#include <string.h>#include <sys/mount.h>#include <sys/prctl.h>#include <sys/stat.h>#include <sys/types.h>#include <sys/wait.h>#include <unistd.h>#include <linux/capability.h>#include <linux/sched.h>#define SHELL "./bin/sh"#define RUNTIME_NAME "sandbox"#define ARRAY_SIZE(A) (sizeof A / sizeof A[0u])static char * const shell_arguments[] = { (char *)SHELL, NULL };static char * const shell_environment[] = { NULL };static char fstab_config[] = "# <file system> <mount point> <type> <options>\n" "proc proc proc ro,nodev,noexec,nosuid\n" "sys sys sysfs ro,nodev,noexec,nosuid\n" "\n" "/dev dev none rbind\n" "\n" "tmpfs run tmpfs none\n" "tmpfs var tmpfs none\n" "\n" "# Allow connecting to X11\n" "/tmp tmp none ro,bind\n" "\n" "/etc etc none ro,bind\n" "\n" "/lib lib none ro,bind\n" "/lib32 lib32 none ro,bind\n" "/lib64 lib64 none ro,bind\n" "/lib64 lib64 none ro,bind\n" "\n" "/bin bin none ro,bind\n" "/sbin sbin none ro,bind\n" "/usr usr none ro,bind\n";struct mount { char const * source; char const * target; mode_t mode; char const * filesystem_type; unsigned long mountflags; char const *data;};int main(void){ int errnum; if (-1 == unshare(CLONE_NEWUSER /* Needed to do the rest of the unsharing */ /* Prevent signals, ptracing of other processes */ | CLONE_NEWPID /* With chroot prevent messing with user files */ | CLONE_NEWNS /* The rest are kind of meh but might as well be done */ | CLONE_NEWIPC | CLONE_NEWUTS | CLONE_NEWNET)) { perror("unshare"); return EXIT_FAILURE; } /* Fork to allow for multithreading and to make the shell less * buggy. */ { pid_t child = fork(); if (-1 == child) { perror("fork"); return EXIT_FAILURE; } if (child != 0) { siginfo_t info; do { errnum = -1 == waitid(P_PID, child, &info, WEXITED) ? errno : 0; } while (EINTR == errnum); if (errnum != 0) { assert(errnum != EINVAL); assert(errnum != ECHILD); assert(false); } return info.si_status; } } FILE * tmp = tmpfile(); if (NULL == tmp) { perror("tmpfile"); return EXIT_FAILURE; } { size_t bytes_to_write = sizeof fstab_config - 1u; if (fwrite(fstab_config, 1u, bytes_to_write, tmp) != sizeof fstab_config - 1u) { perror("fwrite"); return EXIT_FAILURE; } } char tmppath[] = "/proc/self/fd/XXXXXXXXXXX"; sprintf(tmppath, "/proc/self/fd/%i", fileno(tmp)); FILE * fstab = setmntent(tmppath, "r"); if (NULL == fstab) { perror("setmtent"); return EXIT_FAILURE; } if (EOF == fclose(tmp)) { perror("fclose"); return EXIT_FAILURE; } { char const *runtime_dir_string = getenv("XDG_RUNTIME_DIR"); if (NULL == runtime_dir_string) { /* TODO: Fallback somewhere smart */ fputs("missing XDG_RUNTIME_DIR\n", stderr); return EXIT_FAILURE; } if (-1 == chdir(runtime_dir_string)) { perror("chdir"); return EXIT_FAILURE; } } if (-1 == mkdir(RUNTIME_NAME, S_IRWXU)) { errnum = errno; if (errnum != EEXIST) { perror("mkdir"); return EXIT_FAILURE; } } if (-1 == mount(NULL, RUNTIME_NAME, "tmpfs", 0, NULL)) { perror("mount"); return EXIT_FAILURE; } if (-1 == chdir(RUNTIME_NAME)) { perror("chdir"); return EXIT_FAILURE; } for (;;) { errno = 0; struct mntent * entry = getmntent(fstab); if (NULL == entry) { errnum = errno; if (errnum != 0) { perror("getmntent"); return EXIT_FAILURE; } break; } enum { BIND, RBIND, REMOUNT, RO, RW, SUID, NOSUID, NODEV, NOEXEC }; char * const token[] = { [BIND] = "bind", [RBIND] = "rbind", [REMOUNT] = "remount", [RO] = MNTOPT_RO, [RW] = MNTOPT_RW, [SUID] = MNTOPT_SUID, [NOSUID] = MNTOPT_NOSUID, [NODEV] = "nodev", [NOEXEC] = "noexec", NULL }; bool bind = false; bool rec = false; bool remount = false; bool readonly = false; bool readwrite = false; bool suid = true; bool dev = true; bool exec = true; char *value = NULL; { char *subopts = entry->mnt_opts; if (0 == strcmp("none", subopts)) { goto mount; } while (*subopts != '\0') { switch (getsubopt(&subopts, token, &value)) { case BIND: bind = true; break; case RBIND: bind = true; rec = true; break; case REMOUNT: remount = true; break; case RO: readonly = true; break; case RW: readwrite = true; break; case SUID: suid = true; break; case NOSUID: suid = false; break; case NODEV: dev = false; break; case NOEXEC: exec = false; break; default: fprintf(stderr, "No match found for token: /%s/\n", value); goto mount; } } } mount: if (readwrite && readonly) { fprintf(stderr, "Only one of '%s' and '%s' can be specified\n", token[RO], token[RW]); return EXIT_FAILURE; } unsigned long mountflags = 0; if (bind) { mountflags |= MS_BIND; } if (rec) { mountflags |= MS_REC; } if (remount) { mountflags |= MS_REMOUNT; } if (readonly) { mountflags |= MS_RDONLY; } if (!suid) { mountflags |= MS_NOSUID; } if (!dev) { mountflags |= MS_NODEV; } if (!exec) { mountflags |= MS_NOEXEC; } if (-1 == mkdir(entry->mnt_dir, S_IRWXU)) { errnum = errno; if (errnum != EEXIST) { perror("mkdir"); return EXIT_FAILURE; } } if (-1 == mount(0 == strcmp("none", entry->mnt_fsname) ? NULL : entry->mnt_fsname, entry->mnt_dir, entry->mnt_type, mountflags, value)) { perror("mount"); return EXIT_FAILURE; } } if (endmntent(fstab) != 1) { perror("endmntent"); return EXIT_FAILURE; } if (-1 == chdir("..")) { perror("chdir"); return EXIT_FAILURE; } if (-1 == chdir(RUNTIME_NAME)) { perror("chdir"); return EXIT_FAILURE; } if (-1 == chroot("./")) { perror("chroot"); return EXIT_FAILURE; } if (-1 == chdir("/")) { perror("chdir"); return EXIT_FAILURE; } /* Prevent future privilege gains */ if (-1 == prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) { perror("prctl"); return EXIT_FAILURE; } /* Drop all privileges I might possibly have. I'm not sure I need * to do this and I probably can do this in a better way. */ static unsigned long const capability[] = { CAP_CHOWN, CAP_DAC_OVERRIDE, CAP_DAC_READ_SEARCH, CAP_FOWNER, CAP_FSETID, CAP_KILL, CAP_SETGID, CAP_SETUID, CAP_SETPCAP, CAP_LINUX_IMMUTABLE, CAP_NET_BIND_SERVICE, CAP_NET_BROADCAST, CAP_NET_ADMIN, CAP_NET_RAW, CAP_IPC_LOCK, CAP_IPC_OWNER, CAP_SYS_MODULE, CAP_SYS_RAWIO, CAP_SYS_CHROOT, CAP_SYS_PTRACE, CAP_SYS_PACCT, CAP_SYS_ADMIN, CAP_SYS_BOOT, CAP_SYS_NICE, CAP_SYS_RESOURCE, CAP_SYS_TIME, CAP_SYS_TTY_CONFIG, CAP_MKNOD, CAP_LEASE, CAP_AUDIT_WRITE, CAP_AUDIT_CONTROL, CAP_SETFCAP, CAP_MAC_OVERRIDE, CAP_MAC_ADMIN, CAP_SYSLOG, CAP_WAKE_ALARM }; for (size_t ii = 0u; ii < ARRAY_SIZE(capability); ++ii) { if (-1 == prctl(PR_CAPBSET_DROP, capability[ii], 0, 0, 0)) { perror("prctl"); return EXIT_FAILURE; } } /* Favor other processes over this process hierarchy. Only * superuser may lower priorities so this is not stoppable. This * also makes the process hierarchy nicer for the OOM killer. */ if (-1 == setpriority(PRIO_PROCESS, 0, getpriority(PRIO_PROCESS, 0) + 1)) { perror("setpriority"); return EXIT_FAILURE; } execve(SHELL, shell_arguments, shell_environment); perror("execve"); return EXIT_FAILURE;}A hacky alternative is to use overlayfs. For example, "overlayfs lib overlayfs ro,lowerdir=/lib,upperdir=/lib".Unfortunately, overlayfs doesn't work as an alternative for readonly recursive bind mounts.I sent a patch to the LKML to fix this:You might be able to workaround the problem by fetching the sources for your kernel, applying the patch, recompiling and installing the new kernel binary. You would lose whatever kernel signing RedHat might have by doing this though.I just spotted the patch in the URL. It is functionally identical to what I sent to the list. It would have been the right fix, but it was never merged. I stumbled across this bug report in some casual Google searches after I had written that patch, so it had been written independently.while the remount workaround does not work for recursive bind mounts it does seem to work for shared bind mounts which are actually better than recursive bind mounts in many ways.NVM. I must have made a mistake and this doesn't seem to work for shared bind mounts either.The remount workaround does not seem to work for a bind to a subdirectory of a mount and not a direct bind.
id=51481	As reported downstream by me, the kernel fails to compile (at link time).To reproduce: make distcleanmake allyesconfigmakeNote: these steps work on other arch like amd64. Createdbuild.logI can provide an 'emerge --info' just to give you some other info about my system settings:Portage 2.1.11.31 (default/linux/powerpc/ppc64/10.0/64bit-userland, gcc-4.5.4, glibc-2.15-r3, 3.2.34 ppc64)=================================================================System uname: Linux-3.2.34-ppc64-POWER7_-architected-with-gentoo-2.1Timestamp of tree: Sat, 08 Dec 2012 13:00:01 +0000ld GNU ld (GNU Binutils) 2.22app-shells/bash: 4.2_p37dev-java/java-config: 2.1.11-r3dev-lang/python: 2.7.3-r2, 3.2.3dev-util/cmake: 2.8.9dev-util/pkgconfig: 0.27.1sys-apps/baselayout: 2.1-r1sys-apps/openrc: 0.11.8sys-apps/sandbox: 2.5sys-devel/autoconf: 2.13, 2.68sys-devel/automake: 1.11.6sys-devel/binutils: 2.22-r1sys-devel/gcc: 4.5.4sys-devel/gcc-config: 1.7.3sys-devel/libtool: 2.4-r1sys-devel/make: 3.82-r3sys-kernel/linux-headers: 3.6 (virtual/os-headers)sys-libs/glibc: 2.15-r3Repositories: gentoo x-portageACCEPT_KEYWORDS="ppc64"ACCEPT_LICENSE="*"CBUILD="powerpc64-unknown-linux-gnu"CFLAGS="-O2 -pipe"CHOST="powerpc64-unknown-linux-gnu"CONFIG_PROTECT="/etc"CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5.4/ext-active/ /etc/php/cgi-php5.4/ext-active/ /etc/php/cli-php5.4/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"CXXFLAGS="-O2 -pipe"DISTDIR="/usr/portage/distfiles/"FCFLAGS="-O2 -pipe"FEATURES="assume-digests binpkg-logs collision-protect config-protect-if-modified distlocks ebuild-locks fixlafiles merge-sync news parallel-fetch protect-owned sandbox sfperms split-log strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync"FFLAGS="-O2 -pipe"GENTOO_MIRRORS=""LDFLAGS="-Wl,-O1 -Wl,--as-needed -Wl,--hash-style=gnu"MAKEOPTS="-j24"PKGDIR="/usr/portage/packages"PORTAGE_CONFIGROOT="/"PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"PORTAGE_TMPDIR="/var/tmp"PORTDIR="/usr/portage"PORTDIR_OVERLAY="/usr/local/portage"SYNC="rsync://bobolink.gentoo.osuosl.org/gentoo-portage"USE="X acl berkdb bzip2 cli consolekit cracklib crypt cups cxx dbus dri fontconfig fortran gdbm gpm gudev hwdb ibm iconv ipv6 jpeg kde minizip modules mudflap ncurses nls nptl ogg opengl openmp pam pcre png policykit ppc64 pppd qt3support qt4 readline semantic-desktop session ssl tcpd unicode vorbis zlib" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" ELIBC="glibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" LINGUAS="am fil zh af ca cs da de el es et gl hu nb nl pl pt ro ru sk sl sv uk bg cy en eo fo ga he id ku lt lv mk ms nn sw tn zu ja zh_TW en_GB pt_BR ko zh_CN ar en_CA fi kk oc sr tr fa wa nds as be bn bn_BD bn_IN en_US es_AR es_CL es_ES es_MX eu fy fy_NL ga_IE gu gu_IN hi hi_IN is ka kn ml mr nn_NO or pa pa_IN pt_PT rm si sq sv_SE ta ta_LK te th vi ast dz km my om sh ug uz ca@valencia sr@ijekavian sr@ijekavianlatin sr@latin csb hne mai se es_LA fr_CA zh_HK br la no es_CR et_EE sr_CS bo hsb hy mn sr@Latn lb ne bs tg uz@cyrillic xh be_BY brx ca_XV dgo en_ZA gd kok ks ky lo mni nr ns pap ps rw sa_IN sat sd ss st sw_TZ ti ts ve mt ia az me tl ak hy_AM lg nso son ur_PK it fr nb nb_NO hr nan ur tk cs_CZ da_DK de_1901 de_CH en_AU lt_LT pl_PL sa sk_SK th_TH ta_IN tt sco ha mi ven ar_SY el_GR ro_RO ru_RU sl_SI uk_UA vi_VN ar_SY te_IN de_DE es_VE fa_IR fr_FR hu_HU id_ID it_IT ja_JP ka_GE nl_NL sr_BA sr_RS ca_ES fi_FI he_IL jv ru_gold yi eu_ES" PHP_TARGETS="php5-3 php5-4" PYTHON_SINGLE_TARGET="python2_7" PYTHON_TARGETS="python2_7 python3_2" RUBY_TARGETS="ruby18 ruby19" USERLAND="GNU" VIDEO_CARDS="fbdev mach64 mga nv r128 radeon dummy v4l"USE_PYTHON="2.7 3.2"al 3.x version are affected.It got closed because it had no kernel version attached - what is the most recent you tested ?(In reply to Alan from)3.12.6 tested now. the relevant part of the log is:/root/linux-3.12.6/include/asm-generic/dma-mapping-common.h:106:(.text+0x1ffa48c): relocation truncated to fit: R_PPC64_REL24 (stub) against symbol `.debug_dma_sync_single_for_cpu' defined in .text section in lib/built-in.odrivers/built-in.o: In function `dma_unmap_single_attrs':/root/linux-3.12.6/include/asm-generic/dma-mapping-common.h:39:(.text+0x1ffb4fc): relocation truncated to fit: R_PPC64_REL24 (stub) against symbol `.debug_dma_unmap_page' defined in .text section in lib/built-in.odrivers/built-in.o: In function `ipw2100_irq_tasklet':/root/linux-3.12.6/drivers/net/wireless/ipw2x00/ipw2100.c:3222:(.text+0x1ffb89c): relocation truncated to fit: R_PPC64_REL24 (stub) against symbol `_savegpr0_25' defined in .text.save.restore section in arch/powerpc/lib/built-in.o/root/linux-3.12.6/drivers/net/wireless/ipw2x00/ipw2100.c:3222:(.text+0x1ffb8ac): relocation truncated to fit: R_PPC64_REL24 (stub) against symbol `._mcount' defined in .text section in arch/powerpc/kernel/entry_64.odrivers/built-in.o: In function `ipw2100_hw_send_command':/root/linux-3.12.6/drivers/net/wireless/ipw2x00/ipw2100.c:731:(.text+0x1ffd0a8): relocation truncated to fit: R_PPC64_REL24 (stub) against symbol `_savegpr0_25' defined in .text.save.restore section in arch/powerpc/lib/built-in.o/root/linux-3.12.6/drivers/net/wireless/ipw2x00/ipw2100.c:731:(.text+0x1ffd0b8): relocation truncated to fit: R_PPC64_REL24 (stub) against symbol `._mcount' defined in .text section in arch/powerpc/kernel/entry_64.o/root/linux-3.12.6/drivers/net/wireless/ipw2x00/ipw2100.c:743:(.text+0x1ffd1a0): relocation truncated to fit: R_PPC64_REL24 (stub) against symbol `._raw_spin_lock_irqsave' defined in .spinlock.text section in kernel/built-in.o/root/linux-3.12.6/drivers/net/wireless/ipw2x00/ipw2100.c:786:(.text+0x1ffd4bc): relocation truncated to fit: R_PPC64_REL24 (stub) against symbol `.memcpy' defined in .text section in arch/powerpc/lib/built-in.o/root/linux-3.12.6/drivers/net/wireless/ipw2x00/ipw2100.c:790:(.text+0x1ffd4c8): relocation truncated to fit: R_PPC64_REL24 (stub) against symbol `.list_del' defined in .text section in lib/built-in.odrivers/built-in.o: In function `list_add_tail':/root/linux-3.12.6/include/linux/list.h:76:(.text+0x1ffd510): relocation truncated to fit: R_PPC64_REL24 (stub) against symbol `.__list_add' defined in .text section in lib/built-in.odrivers/built-in.o: In function `spin_unlock_irqrestore':/root/linux-3.12.6/include/linux/spinlock.h:348:(.text+0x1ffd590): additional relocation overflows omitted from the output`.exit.data' referenced in section `.exit.text' of drivers/built-in.o: defined in discarded section `.exit.data' of drivers/built-in.o`.exit.data' referenced in section `.exit.text' of drivers/built-in.o: defined in discarded section `.exit.data' of drivers/built-in.old: warning: creating a DT_TEXTREL in object.make: *** [vmlinux] Error 1
id=40492	CreatedKernel's configI discovered a scenario in which menuconfig fails to set FB_BACKLIGHT symbol when needed.In my case, I have propietary nvidia drivers once loaded Xorg, but in the meanwhile, I have configured an uvesafb framebuffer (thus, no other framebuffer active nor compiled).System works ok, but when trying to install nvidiabl[1] (to control nvidia's backlight) I find that FB_BACKLIGHT is not set where it should be because I have BACKLIGHT_CLASS_DEVICE set.The result is that nvidiabl does not compile.The workarround for this now is to enable as a modile any component with support for backlight [Nvidia Framebuffer (CONFIG_FB_NVIDIA), ATI Radeon display (CONFIG_FB_RADEON), etc...]I propose either enabling it automatically with CONFIG_BACKLIGHT_CLASS_DEVICE, or either having a separate option to allow it to be selected manually for external modules.I add an attachment of a kernel config showing this scenario with FB_BACKLIGHT not set nor any other framebuffer than uvesafb Forgot to add URI[1]:We can't have CONFIG_BACKLIGHT_CLASS_DEVICE enable CONFIG_FB_BACKLIGHT (via select) because CONFIG_FB_BACKLIGHT already selects BACKLIGHT_CLASS_DEVICE,so having BACKLIGHT_CLASS_DEVICE select FB_BACKLIGHT would cause a circularkconfig dependency chain. We could possibly do your other suggestion of having a separate kconfig option that could be selected manually for external modules, but we don't go to much effort to support external modules.I'm sending the initial bug report to the linux-fbdev mailing list.I think another solution which will be transparent to users.The source of this problem with nvidiabl is that it is an external module for doing what another modules already do: hability to change backlight of a lcd screen.The defines needed for this app are just limits for backlight, so I think it should depend on CONFIG_BACKLIGHT_LCD_SUPPORT, better than CONFIG_FB_BACKLIGHT to be more generic and because it does not pertain strictly to a framebuffer (can be used inside a running X session for example with other driver than a fb), I suggest changing the condition to define those variables.I'll attach a patch that can solve this issue transparently (and I think it won't harm the rest of drivers).But it is just a suggestion, choose what you find best solution :)CreatedSuggested patch addressing problemAt a minimum, the other place(s) that protect the use of those macros with #ifdef CONFIG_FB_BACKLIGHT also need to be changed to use #ifdef CONFIG_BACKLIGHT_LCD_SUPPORT. Did you do any build testing of your patch?Yes, I applied my path to 3.0.0 and 3.0.1 and rebuilded nvidiabl with success.It is also working good, and does not appear to harm any other software nor any other part of system.CreatedKernel config used with previous patchThis is the new config I used to build kernel once applied that patch.I removed any module I didn't need (that enabled FB_BACKLIGHT) I used as a workarround of this bug.That's why FB_BACKLIGHT is not set here.I(In reply to)By rebuilded I meant I rebuilt everything: kernel, and after nvidiabl, and rebooted to test, and worked as expected.--Sent from my Nokia N9On 16/08/2011 22:51wrote:---from David <> 2011-08-16 19:51:04 ---I(In reply to)By rebuilded I meant I rebuilt everything: kernel, and after nvidiabl, andrebooted to test, and worked as expected.--Configure bugmail:------- You are receiving this mail because: -------You are watching the assignee of the bug.I am reopening this issue, because in version 4.9.6, this is still present.I am suggesting adding an explicit CONFIG_FB_BACKLIGHT so users can enable it manually, even when no dependencies set it automatically. This is very useful in cases of, for example, nvidia card is present on UEFI systems, that no other card depending on it is selecting on kernel (and not using nouveau driver).Can someone take a look of this?
id=42840	Using the brcmsmac driver I'm experiencing random AP disconnects and network hangs. I can usually come out of a hang by simply reconnecting where it will work normally again for a short while. I got a lot of the following in kern.log during the issuesFeb 27 00:30:10 lenny kernel: [ 455.059482] ieee80211 phy0: brcms_c_ampdu_dotxstatus_complete: Pkt tx suppressed, illegal channel possibly 2Feb 27 00:30:10 lenny kernel: [ 455.059494] ieee80211 phy0: AMPDU status: BA Timeout, seq 264, in_transit 15Feb 27 00:30:10 lenny kernel: [ 455.059517] ieee80211 phy0: AMPDU status: BA Timeout, seq 265, in_transit 14Feb 27 00:30:10 lenny kernel: [ 455.059522] ieee80211 phy0: AMPDU status: BA Timeout, seq 266, in_transit 13Feb 27 00:30:10 lenny kernel: [ 455.059527] ieee80211 phy0: AMPDU status: BA Timeout, seq 267, in_transit 12Feb 27 00:30:10 lenny kernel: [ 455.059532] ieee80211 phy0: AMPDU status: BA Timeout, seq 268, in_transit 11Feb 27 00:30:10 lenny kernel: [ 455.059539] ieee80211 phy0: AMPDU status: BA Timeout, seq 269, in_transit 10Feb 27 00:30:10 lenny kernel: [ 455.059544] ieee80211 phy0: AMPDU status: BA Timeout, seq 270, in_transit 9Feb 27 00:30:10 lenny kernel: [ 455.059550] ieee80211 phy0: AMPDU status: BA Timeout, seq 271, in_transit 8Feb 27 00:30:10 lenny kernel: [ 455.059556] ieee80211 phy0: AMPDU status: BA Timeout, seq 272, in_transit 7Feb 27 00:30:10 lenny kernel: [ 455.059561] ieee80211 phy0: AMPDU status: BA Timeout, seq 273, in_transit 6Feb 27 00:30:10 lenny kernel: [ 455.059566] ieee80211 phy0: AMPDU status: BA Timeout, seq 274, in_transit 5Feb 27 00:30:10 lenny kernel: [ 455.059572] ieee80211 phy0: AMPDU status: BA Timeout, seq 275, in_transit 4Feb 27 00:30:10 lenny kernel: [ 455.059576] ieee80211 phy0: AMPDU status: BA Timeout, seq 276, in_transit 3Feb 27 00:30:10 lenny kernel: [ 455.059581] ieee80211 phy0: AMPDU status: BA Timeout, seq 277, in_transit 2Feb 27 00:30:10 lenny kernel: [ 455.059587] ieee80211 phy0: AMPDU status: BA Timeout, seq 278, in_transit 1Feb 27 00:30:10 lenny kernel: [ 455.059592] ieee80211 phy0: AMPDU status: BA Timeout, seq 279, in_transit 0Feb 27 00:30:10 lenny kernel: [ 455.069190] ieee80211 phy0: brcms_c_ampdu_dotxstatus_complete: Pkt tx suppressed, illegal channel possibly 2Feb 27 00:30:10 lenny kernel: [ 455.069193] ieee80211 phy0: AMPDU status: BA Timeout, seq 280, in_transit 3Feb 27 00:30:10 lenny kernel: [ 455.069199] ieee80211 phy0: AMPDU status: BA Timeout, seq 281, in_transit 2Feb 27 00:30:10 lenny kernel: [ 455.069205] ieee80211 phy0: AMPDU status: BA Timeout, seq 282, in_transit 1Feb 27 00:30:10 lenny kernel: [ 455.069210] ieee80211 phy0: AMPDU status: BA Timeout, seq 283, in_transit 0Feb 27 00:30:10 lenny kernel: [ 455.428023] ieee80211 phy0: brcms_c_dotxstatus: INTERMEDIATE but not AMPDUFeb 27 00:30:10 lenny kernel: [ 455.428914] ieee80211 phy0: brcms_c_dotxstatus: INTERMEDIATE but not AMPDUFeb 27 00:30:10 lenny kernel: [ 455.429236] ieee80211 phy0: brcms_c_dotxstatus: INTERMEDIATE but not AMPDUFeb 27 00:30:10 lenny kernel: [ 455.626571] ieee80211 phy0: brcms_c_dotxstatus: INTERMEDIATE but not AMPDUFeb 27 00:30:10 lenny kernel: [ 455.627441] ieee80211 phy0: brcms_c_dotxstatus: INTERMEDIATE but not AMPDUFeb 27 00:30:11 lenny kernel: [ 456.131106] ieee80211 phy0: brcms_c_dotxstatus: INTERMEDIATE but not AMPDUFeb 27 00:30:11 lenny kernel: [ 456.132082] ieee80211 phy0: brcms_c_dotxstatus: INTERMEDIATE but not AMPDUFeb 27 00:30:11 lenny kernel: [ 456.328771] ieee80211 phy0: brcms_c_dotxstatus: INTERMEDIATE but not AMPDUFeb 27 00:30:11 lenny kernel: [ 456.329630] ieee80211 phy0: brcms_c_dotxstatus: INTERMEDIATE but not AMPDUFeb 27 00:30:11 lenny kernel: [ 456.713335] ieee80211 phy0: brcms_c_dotxstatus: INTERMEDIATE but not AMPDUFeb 27 00:30:11 lenny kernel: [ 456.714013] ieee80211 phy0: brcms_c_dotxstatus: INTERMEDIATE but not AMPDUFeb 27 00:30:12 lenny kernel: [ 456.908024] ieee80211 phy0: brcms_c_dotxstatus: INTERMEDIATE but not AMPDUFeb 27 00:30:12 lenny kernel: [ 456.908935] ieee80211 phy0: brcms_c_dotxstatus: INTERMEDIATE but not AMPDUFeb 27 00:30:12 lenny kernel: [ 457.166170] ieee80211 phy0: brcms_c_dotxstatus: INTERMEDIATE but not AMPDUFeb 27 00:30:12 lenny kernel: [ 457.167601] ieee80211 phy0: brcms_c_dotxstatus: INTERMEDIATE but not AMPDU02:00.0 Network controller [0280]: Broadcom Corporation BCM4313 802.11b/g/n Wireless LAN Controller [14e4:4727] (rev 01) Subsystem: Broadcom Corporation Device [14e4:051b] Flags: bus master, fast devsel, latency 0, IRQ 17 Memory at d0400000 (64-bit, non-prefetchable) [size=16K] Capabilities: <access denied> Kernel driver in use: brcmsmac Kernel modules: bcma, brcmsmac Sorry, I figured you need more detailed info from lspci:02:00.0 Network controller [0280]: Broadcom Corporation BCM4313 802.11b/g/n Wireless LAN Controller [14e4:4727] (rev 01) Subsystem: Broadcom Corporation Device [14e4:051b] Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Latency: 0, Cache Line Size: 64 bytes Interrupt: pin A routed to IRQ 17 Region 0: Memory at d0400000 (64-bit, non-prefetchable) [size=16K] Capabilities: [40] Power Management version 3 Flags: PMEClk- DSI- D1+ D2+ AuxCurrent=0mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=2 PME- Capabilities: [58] Vendor Specific Information: Len=78 <?> Capabilities: [48] MSI: Enable- Count=1/1 Maskable- 64bit+ Address: 0000000000000000 Data: 0000 Capabilities: [d0] Express (v1) Endpoint, MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s <4us, L1 unlimited ExtTag+ AttnBtn- AttnInd- PwrInd- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop- MaxPayload 128 bytes, MaxReadReq 128 bytes DevSta: CorrErr+ UncorrErr- FatalErr- UnsuppReq+ AuxPwr+ TransPend- LnkCap: Port #0, Speed 2.5GT/s, Width x1, ASPM unknown, Latency L0 <4us, L1 <64us ClockPM+ Surprise- LLActRep+ BwNot- LnkCtl: ASPM L1 Enabled; RCB 64 bytes Disabled- Retrain- CommClk+ ExtSynch- ClockPM+ AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x1, TrErr- Train- SlotClk+ DLActive+ BWMgmt- ABWMgmt- Capabilities: [100 v1] Advanced Error Reporting UESta: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UEMsk: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UESvrt: DLP+ SDES- TLP- FCP+ CmpltTO- CmpltAbrt- UnxCmplt- RxOF+ MalfTLP+ ECRC- UnsupReq- ACSViol- CESta: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+ CEMsk: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+ AERCap: First Error Pointer: 14, GenCap+ CGenEn- ChkCap+ ChkEn- Capabilities: [13c v1] Virtual Channel Caps: LPEVC=0 RefClk=100ns PATEntryBits=1 Arb: Fixed- WRR32- WRR64- WRR128- Ctrl: ArbSelect=Fixed Status: InProgress- VC0: Caps: PATOffset=00 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed- WRR32- WRR64- WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=Fixed TC/VC=ff Status: NegoPending- InProgress- Capabilities: [160 v1] Device Serial Number 00-00-37-ff-ff-4e-64-27 Capabilities: [16c v1] Power Budgeting <?> Kernel driver in use: brcmsmac Kernel modules: wl, bcma, brcmsmacRight, I've finally found something that may give some better idea as to what is happening. When my network connection hangs and I don't touch anything, after about a minute or so I get the following and then my network connection resumes again.Mar 1 03:12:33 lenny kernel: [ 222.946997] ------------[ cut here ]------------Mar 1 03:12:33 lenny kernel: [ 222.947037] WARNING: at /build/buildd/linux-3.2.0/drivers/net/wireless/brcm80211/brcmsmac/main.c:8234 brcms_c_wait_for_tx_completion+0x99/0xb0 [brcmsmac]()Mar 1 03:12:33 lenny kernel: [ 222.947044] Hardware name: 4334 Mar 1 03:12:33 lenny kernel: [ 222.947048] Modules linked in: parport_pc ppdev dm_crypt rfcomm bnep bluetooth nfsd nfs binfmt_misc lockd fscache auth_rpcgss nfs_acl sunrpc joydev bcma arc4 snd_hda_codec_hdmi snd_hda_codec_conexant brcmsmac mac80211 brcmutil cfg80211 crc8 cordic rts5139(C) uvcvideo videodev v4l2_compat_ioctl32 snd_hda_intel snd_hda_codec snd_hwdep psmouse serio_raw snd_pcm snd_seq_midi snd_rawmidi snd_seq_midi_event snd_seq snd_timer snd_seq_device snd mei(C) soundcore snd_page_alloc ideapad_laptop sparse_keymap mac_hid lp parport atl1c i915 drm_kms_helper drm i2c_algo_bit videoMar 1 03:12:33 lenny kernel: [ 222.947140] Pid: 1238, comm: wpa_supplicant Tainted: G C 3.2.0-17-generic #27-UbuntuMar 1 03:12:33 lenny kernel: [ 222.947145] Call Trace:Mar 1 03:12:33 lenny kernel: [ 222.947162] [<ffffffff8106723f>] warn_slowpath_common+0x7f/0xc0Mar 1 03:12:33 lenny kernel: [ 222.947171] [<ffffffff8106729a>] warn_slowpath_null+0x1a/0x20Mar 1 03:12:33 lenny kernel: [ 222.947192] [<ffffffffa0355b39>] brcms_c_wait_for_tx_completion+0x99/0xb0 [brcmsmac]Mar 1 03:12:33 lenny kernel: [ 222.947208] [<ffffffffa03441bb>] brcms_ops_flush+0x3b/0x60 [brcmsmac]Mar 1 03:12:33 lenny kernel: [ 222.947235] [<ffffffffa02ad31f>] ieee80211_start_sw_scan+0x7f/0x1d0 [mac80211]Mar 1 03:12:33 lenny kernel: [ 222.947259] [<ffffffffa02ad6e5>] __ieee80211_start_scan+0x275/0x2a0 [mac80211]Mar 1 03:12:33 lenny kernel: [ 222.947283] [<ffffffffa02adfc9>] ieee80211_request_scan+0x39/0x60 [mac80211]Mar 1 03:12:33 lenny kernel: [ 222.947311] [<ffffffffa02becfc>] ieee80211_scan+0x6c/0x90 [mac80211]Mar 1 03:12:33 lenny kernel: [ 222.947332] [<ffffffffa02875f8>] nl80211_trigger_scan+0x368/0x620 [cfg80211]Mar 1 03:12:33 lenny kernel: [ 222.947345] [<ffffffff81566d85>] genl_rcv_msg+0x1d5/0x250Mar 1 03:12:33 lenny kernel: [ 222.947354] [<ffffffff81566bb0>] ? genl_rcv+0x40/0x40Mar 1 03:12:33 lenny kernel: [ 222.947362] [<ffffffff81566649>] netlink_rcv_skb+0xa9/0xd0Mar 1 03:12:33 lenny kernel: [ 222.947370] [<ffffffff81566b95>] genl_rcv+0x25/0x40Mar 1 03:12:33 lenny kernel: [ 222.947378] [<ffffffff81565f90>] netlink_unicast+0x2b0/0x300Mar 1 03:12:33 lenny kernel: [ 222.947388] [<ffffffff81532027>] ? memcpy_fromiovec+0x67/0xb0Mar 1 03:12:33 lenny kernel: [ 222.947396] [<ffffffff81566296>] netlink_sendmsg+0x2b6/0x310Mar 1 03:12:33 lenny kernel: [ 222.947406] [<ffffffff8152420e>] sock_sendmsg+0x10e/0x130Mar 1 03:12:33 lenny kernel: [ 222.947416] [<ffffffff8116dc18>] ? __mem_cgroup_commit_charge+0x78/0xe0Mar 1 03:12:33 lenny kernel: [ 222.947425] [<ffffffff8103dbb9>] ? default_spin_lock_flags+0x9/0x10Mar 1 03:12:33 lenny kernel: [ 222.947435] [<ffffffff8105fa4e>] ? try_to_wake_up+0x18e/0x200Mar 1 03:12:33 lenny kernel: [ 222.947441] [<ffffffff81526da1>] ? move_addr_to_kernel+0x71/0x80Mar 1 03:12:33 lenny kernel: [ 222.947450] [<ffffffff81532326>] ? verify_iovec+0x56/0xd0Mar 1 03:12:33 lenny kernel: [ 222.947457] [<ffffffff81525dd6>] __sys_sendmsg+0x396/0x3b0Mar 1 03:12:33 lenny kernel: [ 222.947466] [<ffffffff8107d192>] ? set_current_blocked+0x52/0x70Mar 1 03:12:33 lenny kernel: [ 222.947475] [<ffffffff81013700>] ? handle_signal+0xc0/0x190Mar 1 03:12:33 lenny kernel: [ 222.947483] [<ffffffff8101db74>] ? restore_user_xstate+0x54/0xa0Mar 1 03:12:33 lenny kernel: [ 222.947491] [<ffffffff8101de6f>] ? restore_i387_xstate+0x8f/0x130Mar 1 03:12:33 lenny kernel: [ 222.947498] [<ffffffff81527d39>] sys_sendmsg+0x49/0x90Mar 1 03:12:33 lenny kernel: [ 222.947507] [<ffffffff81661202>] system_call_fastpath+0x16/0x1bMar 1 03:12:33 lenny kernel: [ 222.947513] ---[ end trace 09e64f0f14d3c7a4 ]---I've tried patch found hereand get pretty much the same thing except there's a lot more AMPDU related noise with the same messages in the bug description but much more of them and a crash (as per).If you need anything else, please let me know.Oh and apologies for all the additional comments.I've since replaced my card with an Intel based card so if it helps I'm more than happy to donate the BCM4313 based card to anyone who wants to work on it.I have been digging into this issue last week and reworked the code in mac80211 .flush() code path (which is intrace). I will mention this bug report in the commit message.This still happen on latest kernel.This is the exact backtrace I got. (I originally reported here)[ 471.789161] WARNING: at drivers/net/wireless/brcm80211/brcmsmac/main.c:7968brcms_c_wait_for_tx_completion+0x99/0xb0 [brcmsmac]()[ 471.789164] Hardware name: Aspire E1-571[ 471.789167] Modules linked in: uvcvideo videobuf2_vmalloc videobuf2_memopsvideobuf2_core videodev media fuse aes_x86_64 aes_generic ipt_REJECTip6t_REJECT xt_tcpudp nf_conntrack_ipv6 nf_defrag_ipv6 nf_conntrack_ipv4nf_defrag_ipv4 xt_conntrack nf_conntrack ip6table_filter ip6_tablesiptable_filter ip_tables x_tables snd_hda_codec_hdmi snd_hda_codec_realtek arc4joydev i915 brcmsmac cordic brcmutil mac80211 acpi_cpufreq mperf microcodeghash_clmulni_intel i2c_algo_bit drm_kms_helper drm snd_hda_intel snd_hda_codecsnd_hwdep snd_pcm acer_wmi cryptd cfg80211 intel_agp i2c_i801 sdhci_pci sdhciserio_raw tg3 sparse_keymap snd_page_alloc snd_timer snd soundcore intel_gttiTCO_wdt iTCO_vendor_support mmc_core mei lpc_ich i2c_core mfd_core kvm_intellibphy bcma psmouse processor pcspkr evdev kvm rfkill wmi coretemp crc32c_intelbattery ac button video nfs nfs_acl lockd auth_rpcgss sunrpc fscache ext4 crc16jbd2 mbcache sd_mod sr_mod cdrom ahci libahci libata scsi_mod ehci_hcd usbcoreusb_common[ 471.789283] Pid: 1266, comm: kworker/u:30 Not tainted 3.5.5-1-ARCH #1[ 471.789284] Call Trace:[ 471.789291] [<ffffffff81051a3f>] warn_slowpath_common+0x7f/0xc0[ 471.789293] [<ffffffff81051a9a>] warn_slowpath_null+0x1a/0x20[ 471.789299] [<ffffffffa04d3d29>] brcms_c_wait_for_tx_completion+0x99/0xb0[brcmsmac][ 471.789303] [<ffffffffa04c61bb>] brcms_ops_flush+0x3b/0x60 [brcmsmac][ 471.789312] [<ffffffffa0478f69>] ieee80211_mgd_probe_ap_send+0xc9/0x230[mac80211][ 471.789318] [<ffffffffa047974f>] ieee80211_mgd_probe_ap.part.22+0x10f/0x130[mac80211][ 471.789323] [<ffffffffa04798fe>] ieee80211_sta_monitor_work+0x2e/0x30[mac80211][ 471.789327] [<ffffffff8106ef1a>] process_one_work+0x12a/0x440[ 471.789332] [<ffffffffa04798d0>] ?ieee80211_beacon_connection_loss_work+0x160/0x160 [mac80211][ 471.789335] [<ffffffff8106f77e>] worker_thread+0x12e/0x2d0[ 471.789337] [<ffffffff8106f650>] ? manage_workers.isra.26+0x1f0/0x1f0[ 471.789340] [<ffffffff81074e73>] kthread+0x93/0xa0[ 471.789344] [<ffffffff8148aa24>] kernel_thread_helper+0x4/0x10[ 471.789346] [<ffffffff81074de0>] ? kthread_freezable_should_stop+0x70/0x70[ 471.789348] [<ffffffff8148aa20>] ? gs_change+0x13/0x13This should be fixed currently i.e. on 3.8 .A patch referencing this bug report has been merged in Linux v3.8-rc7:commit 7b2385b95363c9ff49801c19cba2489a05bd6672Author: Arend van Spriel <>Date: Sat Feb 2 14:36:50 2013 +0100 brcmsmac: rework of mac80211 .flush() callback operationLinux 3.8.2 - connection still hangs at some time, now without anything in dmesg.I also still get hangs under 3.8.3, though it looks like it is a lot less frequent than before. I did have these messages in dmesg, which may or may not be related.[ 459.339747] brcmsmac bcma0:0: brcms_c_ampdu_dotxstatus_complete: Pkt tx suppressed, illegal channel possibly 1[ 459.340056] brcmsmac bcma0:0: brcms_c_ampdu_dotxstatus_complete: Pkt tx suppressed, illegal channel possibly 1[ 459.340167] brcmsmac bcma0:0: brcms_c_ampdu_dotxstatus_complete: Pkt tx suppressed, illegal channel possibly 1I don't get hangs with these patches over 3.4-3.6 kernels:But hangs happen with 3.8, which have "v2" of this patch-set.I also get these "Pkt tx suppressed" messages, but I get them much earlier than the hang happens.I spoke to soon when I said it was a lot less frequent. That was based off transferring a large file from a computer on my local network, where it only stalled once. In a more real-world test of updating, it was as bad as before, or maybe even worse. On top of that, a couple times it deauthenticated from my network and would be unable to authenticate again until I restarted. (though I'm sure I could have reloaded the proper modules instead) That update included kernel 3.8.4, and after that update I can't authenticate at all.I am using opensuse with Linux 3.7.10-1.1-desktop on lenovo y570 with BCM4313 (rev 1) and the connection brcmsmac is very bad. There are random disconnects, a lot of packet loss and overall connection is pretty bad.I have similar hardware on my lenovo e135. Wifi have never worked good (3.14.* and 3.15.1). Signal was very weak and device was almost useless. I used wl driver, but it produces ops time to time and binary driver has known disadvantages.I build the kernel 3.16.0. It looks like it works good! It need confirmation, because my access point is very close to notebook.Wifi information:root@debian:/home/andrey# lspci -s 02:00.0 -vvv02:00.0 Network controller: Broadcom Corporation BCM4313 802.11b/g/n Wireless LAN Controller (rev 01) Subsystem: Broadcom Corporation Device 0608 Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx- Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- >SERR- <PERR- INTx- Latency: 0, Cache Line Size: 32 bytes Interrupt: pin A routed to IRQ 17 Region 0: Memory at f0a00000 (64-bit, non-prefetchable) [size=16K] Capabilities: [40] Power Management version 3 Flags: PMEClk- DSI- D1+ D2+ AuxCurrent=0mA PME(D0+,D1-,D2-,D3hot+,D3cold+) Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=2 PME- Capabilities: [58] Vendor Specific Information: Len=78 <?> Capabilities: [48] MSI: Enable- Count=1/1 Maskable- 64bit+ Address: 0000000000000000 Data: 0000 Capabilities: [d0] Express (v1) Endpoint, MSI 00 DevCap: MaxPayload 128 bytes, PhantFunc 0, Latency L0s <4us, L1 unlimited ExtTag+ AttnBtn- AttnInd- PwrInd- RBE+ FLReset- DevCtl: Report errors: Correctable- Non-Fatal- Fatal- Unsupported- RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop- MaxPayload 128 bytes, MaxReadReq 128 bytes DevSta: CorrErr+ UncorrErr- FatalErr- UnsuppReq+ AuxPwr+ TransPend- LnkCap: Port #0, Speed 2.5GT/s, Width x1, ASPM L1, Latency L0 <4us, L1 <64us ClockPM+ Surprise- LLActRep+ BwNot- LnkCtl: ASPM L1 Enabled; RCB 64 bytes Disabled- Retrain- CommClk+ ExtSynch- ClockPM+ AutWidDis- BWInt- AutBWInt- LnkSta: Speed 2.5GT/s, Width x1, TrErr- Train- SlotClk+ DLActive+ BWMgmt- ABWMgmt- Capabilities: [100 v1] Advanced Error Reporting UESta: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UEMsk: DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol- UESvrt: DLP+ SDES- TLP- FCP+ CmpltTO- CmpltAbrt- UnxCmplt- RxOF+ MalfTLP+ ECRC- UnsupReq- ACSViol- CESta: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+ CEMsk: RxErr- BadTLP- BadDLLP- Rollover- Timeout- NonFatalErr+ AERCap: First Error Pointer: 14, GenCap+ CGenEn- ChkCap+ ChkEn- Capabilities: [13c v1] Virtual Channel Caps: LPEVC=0 RefClk=100ns PATEntryBits=1 Arb: Fixed- WRR32- WRR64- WRR128- Ctrl: ArbSelect=Fixed Status: InProgress- VC0: Caps: PATOffset=00 MaxTimeSlots=1 RejSnoopTrans- Arb: Fixed- WRR32- WRR64- WRR128- TWRR128- WRR256- Ctrl: Enable+ ID=0 ArbSelect=Fixed TC/VC=ff Status: NegoPending- InProgress- Capabilities: [160 v1] Device Serial Number 00-00-3d-ff-ff-c1-c0-14 Capabilities: [16c v1] Power Budgeting <?> Kernel driver in use: bcma-pci-bridgeroot@debian:/home/andrey# lsmod | grep brcbrcmsmac 495082 0 cordic 12352 1 brcmsmacbrcmutil 13093 1 brcmsmacbcma 37206 1 brcmsmacmac80211 477834 1 brcmsmaccfg80211 414089 2 brcmsmac,mac80211dmesg:[ 150.628120] cfg80211: Calling CRDA to update world regulatory domain[ 150.716239] bcma: bus0: Found chip with id 0x4313, rev 0x01 and package 0x08[ 150.716272] bcma: bus0: Core 0 found: ChipCommon (manuf 0x4BF, id 0x800, rev 0x24, class 0x0)[ 150.716293] bcma: bus0: Core 1 found: IEEE 802.11 (manuf 0x4BF, id 0x812, rev 0x18, class 0x0)[ 150.716330] bcma: bus0: Core 2 found: PCIe (manuf 0x4BF, id 0x820, rev 0x11, class 0x0)[ 150.729390] bcma: bus0: Bus registered[ 150.736647] cfg80211: World regulatory domain updated:[ 150.736709] cfg80211: DFS Master region: unset[ 150.736716] cfg80211: (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp), (dfs_cac_time)[ 150.736726] cfg80211: (2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)[ 150.736734] cfg80211: (2457000 KHz - 2482000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)[ 150.736742] cfg80211: (2474000 KHz - 2494000 KHz @ 20000 KHz), (N/A, 2000 mBm), (N/A)[ 150.736749] cfg80211: (5170000 KHz - 5250000 KHz @ 80000 KHz), (N/A, 2000 mBm), (N/A)[ 150.736756] cfg80211: (5735000 KHz - 5835000 KHz @ 80000 KHz), (N/A, 2000 mBm), (N/A)[ 150.736763] cfg80211: (57240000 KHz - 63720000 KHz @ 2160000 KHz), (N/A, 0 mBm), (N/A)[ 150.763103] brcmsmac bcma0:0: mfg 4bf core 812 rev 24 class 0 irq 17[ 150.764078] cfg80211: Updating information on frequency 2412 MHz with regulatory rule:[ 150.764087] cfg80211: 2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A mBi, 1900 mBm)[ 150.764094] cfg80211: Updating information on frequency 2417 MHz with regulatory rule:[ 150.764101] cfg80211: 2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A mBi, 1900 mBm)[ 150.764106] cfg80211: Updating information on frequency 2422 MHz with regulatory rule:[ 150.764113] cfg80211: 2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A mBi, 1900 mBm)[ 150.764118] cfg80211: Updating information on frequency 2427 MHz with regulatory rule:[ 150.764124] cfg80211: 2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A mBi, 1900 mBm)[ 150.764129] cfg80211: Updating information on frequency 2432 MHz with regulatory rule:[ 150.764135] cfg80211: 2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A mBi, 1900 mBm)[ 150.764140] cfg80211: Updating information on frequency 2437 MHz with regulatory rule:[ 150.764146] cfg80211: 2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A mBi, 1900 mBm)[ 150.764151] cfg80211: Updating information on frequency 2442 MHz with regulatory rule:[ 150.764157] cfg80211: 2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A mBi, 1900 mBm)[ 150.764162] cfg80211: Updating information on frequency 2447 MHz with regulatory rule:[ 150.764168] cfg80211: 2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A mBi, 1900 mBm)[ 150.764173] cfg80211: Updating information on frequency 2452 MHz with regulatory rule:[ 150.764179] cfg80211: 2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A mBi, 1900 mBm)[ 150.764184] cfg80211: Updating information on frequency 2457 MHz with regulatory rule:[ 150.764189] cfg80211: 2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A mBi, 1900 mBm)[ 150.764194] cfg80211: Updating information on frequency 2462 MHz with regulatory rule:[ 150.764200] cfg80211: 2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A mBi, 1900 mBm)[ 150.764205] cfg80211: Updating information on frequency 2467 MHz with regulatory rule:[ 150.764211] cfg80211: 2457000 KHz - 2482000 KHz @ 20000 KHz), (N/A mBi, 1900 mBm)[ 150.764216] cfg80211: Updating information on frequency 2472 MHz with regulatory rule:[ 150.764222] cfg80211: 2457000 KHz - 2482000 KHz @ 20000 KHz), (N/A mBi, 1900 mBm)[ 150.764227] cfg80211: Disabling freq 2484 MHz as custom regd has no rule that fits it[ 150.764375] cfg80211: Ignoring regulatory request set by core since the driver uses its own custom regulatory domain[ 150.796370] ieee80211 phy0: Selected rate control algorithm 'minstrel_ht'[ 177.998704] brcmsmac bcma0:0: brcms_ops_bss_info_changed: qos enabled: false (implement)[ 177.998732] brcmsmac bcma0:0: brcms_ops_config: change power-save mode: false (implement)[ 177.999544] IPv6: ADDRCONF(NETDEV_UP): wlan0: link is not ready[ 178.794701] cfg80211: Found new beacon on frequency: 2467 MHz (Ch 12) on phy0[ 186.516870] brcmsmac bcma0:0: brcms_ops_bss_info_changed: qos enabled: false (implement)[ 186.516898] brcmsmac bcma0:0: brcms_ops_config: change power-save mode: false (implement)[ 186.517613] IPv6: ADDRCONF(NETDEV_UP): wlan0: link is not ready[ 186.984001] r8169 0000:03:00.0 eth0: link down[ 186.984090] IPv6: ADDRCONF(NETDEV_UP): eth0: link is not ready[ 187.385697] brcmsmac bcma0:0: brcms_ops_bss_info_changed: qos enabled: false (implement)[ 187.385725] brcmsmac bcma0:0: brcms_ops_config: change power-save mode: false (implement)[ 187.386332] IPv6: ADDRCONF(NETDEV_UP): wlan0: link is not ready[ 190.573160] wlan0: authenticate with 00:13:10:f1:ed:d8[ 190.578512] wlan0: send auth to 00:13:10:f1:ed:d8 (try 1/3)[ 190.579977] wlan0: authenticated[ 190.580047] brcmsmac bcma0:0 wlan0: disabling HT/VHT due to WEP/TKIP use[ 190.580055] brcmsmac bcma0:0 wlan0: disabling HT as WMM/QoS is not supported by the AP[ 190.580059] brcmsmac bcma0:0 wlan0: disabling VHT as WMM/QoS is not supported by the AP[ 190.581042] wlan0: associate with 00:13:10:f1:ed:d8 (try 1/3)[ 190.583574] wlan0: RX AssocResp from 00:13:10:f1:ed:d8 (capab=0x471 status=0 aid=1)[ 190.584136] brcmsmac bcma0:0: brcmsmac: brcms_ops_bss_info_changed: associated[ 190.584143] brcmsmac bcma0:0: brcms_ops_bss_info_changed: qos enabled: false (implement)[ 190.584156] wlan0: associated[ 190.584172] IPv6: ADDRCONF(NETDEV_CHANGE): wlan0: link becomes ready[ 191.766557] brcmsmac bcma0:0: brcms_ops_bss_info_changed: arp filtering: 1 addresses (implement)Unfortunately,my previous optimistic comment was wrong. Problem is still alive. One time card worked perfect, but it can not find all available wifi networks and can not find access point.
id=28912	The said mouse is being recongnised as a joystick, interfering with input in games [1] and arcade emulators [2].The following appears in /var/log/messages when you plug the transceiver in:Feb 11 23:40:08 snowball kernel: [37176.263281] usb 4-2: new full speed USB device using uhci_hcd and address 4Feb 11 23:40:08 snowball kernel: [37176.423066] usb 4-2: New USB device found, idVendor=045e, idProduct=0745Feb 11 23:40:08 snowball kernel: [37176.423070] usb 4-2: New USB device strings: Mfr=1, Product=2, SerialNumber=0Feb 11 23:40:08 snowball kernel: [37176.423074] usb 4-2: Product: Microsoft® Nano Transceiver v2.0Feb 11 23:40:08 snowball kernel: [37176.423077] usb 4-2: Manufacturer: MicrosoftFeb 11 23:40:08 snowball kernel: [37176.434375] input: Microsoft Microsoft® Nano Transceiver v2.0 as /devices/pci0000:00/0000:00:1d.2/usb4/4-2/4-2:1.0/input/input13Feb 11 23:40:08 snowball kernel: [37176.435724] generic-usb 0003:045E:0745.0007: input,hidraw0: USB HID v1.11 Keyboard [Microsoft Microsoft® Nano Transceiver v2.0] on usb-0000:00:1d.2-2/input0Feb 11 23:40:08 snowball kernel: [37176.442886] input: Microsoft Microsoft® Nano Transceiver v2.0 as /devices/pci0000:00/0000:00:1d.2/usb4/4-2/4-2:1.1/input/input14Feb 11 23:40:08 snowball kernel: [37176.443441] generic-usb 0003:045E:0745.0008: input,hidraw1: USB HID v1.11 Mouse [Microsoft Microsoft® Nano Transceiver v2.0] on usb-0000:00:1d.2-2/input1Feb 11 23:40:08 snowball kernel: [37176.468551] input: Microsoft Microsoft® Nano Transceiver v2.0 as /devices/pci0000:00/0000:00:1d.2/usb4/4-2/4-2:1.2/input/input15Feb 11 23:40:08 snowball kernel: [37176.472126] generic-usb 0003:045E:0745.0009: input,hiddev96,hidraw2: USB HID v1.11 Device [Microsoft Microsoft® Nano Transceiver v2.0] on usb-0000:00:1d.2-2/input2Please let me know what other info is needed to help resolving this issue.[1][2] Same behavior on gentoo (using kernel 2.6.37.6) with Microsoft Wireless Optical Desktop keyboard and mouse combo, seems to be an old bug, see [1].[1]Collected some similar downstream bugs to be duplicates of the following bug report:Closing as obsolete, if this is still seen on modern kernels please updateStill a problem here on 3.10 series. Please reopen.ThanksProblem still exists with latest kernel (3.15)Still happens in 3.16.1.confirmed with 3.16.4 and A4tech X7 mouse (openSUSE Factory x64)workaround: sudo rm /dev/input/js0But this has to be done after every reboot.A google for "linux recognize mouse as joystick" for example gives you many results of many people experiencing this, some even with keyboards as joysticks on all Distros.I found that this bug exists at least since 2010:"Hello,I have the mouse X7, model XL-750F from A4tech. This mouse was running with Fedora 10 without any problems.Now I have installed Fedora 12 and my mouse pointer always moves to one side or corner of the screen.My second Logitech mouse is working fine. But it is a little bit old.So, if anyone can help my with my A4tech mouse ... "Workaround for MS Sculpt Ergonomic Desktop:updated today to 3.17.1 - still thereworkaround is nice, but not a solution for the average user...what logs etc do you need to fix this?And this is still an issue in 3.18.2No change in 3.19.3. Would love for it to get some more attention.Chiming in to note this also effects Microsoft Mouse 4000 (Model 1383) as well as many other Microsoft-brand wireless devices. Relevant:and a Ubuntu bug report dating back to 2009This is pretty huge for anyone with a Microsoft mouse, as it renders many games unplayable. Workarounds exist but involving udev rules but they are device specific and have mixed results.Still happens in 4.0.1. It's getting absurd at this point.As a workaround, I tried collecting several Vendor/Product IDs that trigger this bug, and created a udev rule for disabling the joystick device for them. I'm sharing this udev rule file at:What is the /proc/bus/input/devices for that mouse please?Created/proc/bus/input/devicesI have a "Microsoft Wireless Desktop 800", which is a tiny wireless receiver for both mouse and keyboard. It gets detected as a joystick with several axes (besides the normal mouse and keyboard).I also have a "Wacom Graphire 4" tablet, that also gets detected as a joystick.Right now I'm using Ubuntu 15.04 with Linux kernel 3.19.0, but this bug exists for several years.Relevant lsusb lines:Bus 001 Device 004: ID 045e:0745 Microsoft Corp. Nano Transceiver v1.0 for BluetoothBus 001 Device 003: ID 056a:0016 Wacom Co., Ltd Graphire 4 6x8I also remember that the following project also got (incorrectly) detected as a joystick:However, I can't provide more info on it because I don't have the hardware anymore and it happened 4 years ago. If you really really want, I can hack that project again on a breadboard, but it might take a while.Still, if you need more info regarding the Microsoft wireless keyboard/mouse, or regarding the Wacom tablet, just ask and I can provide right away.Ubuntu 15.04 bug exist with A4Tech X7 mouse:dmesg:[ 684.641672] usb 1-2.1: new full-speed USB device number 6 using ehci-pci[ 684.914756] usb 1-2.1: New USB device found, idVendor=09da, idProduct=8090[ 684.914761] usb 1-2.1: New USB device strings: Mfr=1, Product=2, SerialNumber=0[ 684.914764] usb 1-2.1: Product: USB Full Speed[ 684.914765] usb 1-2.1: Manufacturer: A4Tech[ 684.916844] input: A4Tech USB Full Speed as /devices/pci0000:00/0000:00:12.2/usb1/1-2/1-2.1/1-2.1:1.0/0003:09DA:8090.0006/input/input18[ 684.917106] hid-generic 0003:09DA:8090.0006: input,hidraw1: USB HID v1.11 Mouse [A4Tech USB Full Speed] on usb-0000:00:12.2-2.1/input0[ 684.919709] input: A4Tech USB Full Speed as /devices/pci0000:00/0000:00:12.2/usb1/1-2/1-2.1/1-2.1:1.1/0003:09DA:8090.0007/input/input19[ 685.025280] hid-generic 0003:09DA:8090.0007: input,hiddev0,hidraw2: USB HID v1.11 Keyboard [A4Tech USB Full Speed] on usb-0000:00:12.2-2.1/input1lsusb:Bus 007 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hubBus 002 Device 002: ID 058f:6364 Alcor Micro Corp. AU6477 Card Reader ControllerBus 002 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hubBus 006 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hubBus 005 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hubBus 001 Device 003: ID 07d1:3a10 D-Link System DWA-126 802.11n Wireless Adapter [Atheros AR9271]Bus 001 Device 005: ID 062a:0201 Creative Labs Defender Office Keyboard (K7310) S Zodiak KM-9010Bus 001 Device 006: ID 09da:8090 A4 Tech Co., Ltd X-718BK Oscar Optical Gaming Mouse <---------------- This is my mouseBus 001 Device 002: ID 05e3:0608 Genesys Logic, Inc. USB-2.0 4-Port HUBBus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hubBus 004 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hubBus 003 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub(In reply to Denilson Figueiredo de Sá from)Thanx!There is A4Tech X7 mouse with that bug:---------------------------------------LSUSB--------------Bus 001 Device 006: ID 09da:8090 A4 Tech Co., Ltd X-718BK Oscar Optical Gaming Mouse---------------------------------------DMESG-------------new full-speed USB device number 6 using ehci-pci[ 684.914756] usb 1-2.1: New USB device found, idVendor=09da, idProduct=8090[ 684.914761] usb 1-2.1: New USB device strings: Mfr=1, Product=2, SerialNumber=0[ 684.914764] usb 1-2.1: Product: USB Full Speed[ 684.914765] usb 1-2.1: Manufacturer: A4Tech[ 684.916844] input: A4Tech USB Full Speed as /devices/pci0000:00/0000:00:12.2/usb1/1-2/1-2.1/1-2.1:1.0/0003:09DA:8090.0006/input/input18[ 684.917106] hid-generic 0003:09DA:8090.0006: input,hidraw1: USB HID v1.11 Mouse [A4Tech USB Full Speed] on usb-0000:00:12.2-2.1/input0[ 684.919709] input: A4Tech USB Full Speed as /devices/pci0000:00/0000:00:12.2/usb1/1-2/1-2.1/1-2.1:1.1/0003:09DA:8090.0007/input/input19[ 685.025280] hid-generic 0003:09DA:8090.0007: input,hiddev0,hidraw2: USB HID v1.11 Keyboard [A4Tech USB Full Speed] on usb-0000:00:12.2-2.1/input1Is there anything one can do to get some attention to this bug? Even with disabling access to the /dev nodes, the mere presence of these bad "joysticks" causes havoc with other gamepads (at least the XBOX360 wireless ones).The Cooler Master Mizar mouse is facing the same issues. Here is a link to the Valve bug report:This is still an issue in Linux 4.2.3.For those inclined to work on kernel code, the following is a good starting point to understanding why current devices are detected as joysticks: * [1] drivers/input/joydev.c:joydev_ids[] * [2] drivers/input/joydev.c:joydev_match() * [3] drivers/input/joydev.c:joydev_dev_is_absolute_mouse()Looking at these three, it appears a joystick device will be created for input devices which have any of the following events... * ABS_X * ABS_WHEEL * ABS_THROTTLE * BTN_JOYSTICK * BTN_GAMEPAD * BTN_TRIGGER_HAPPY... *unless* one of the following is also present (or the device appears to be a an "absolute mouse") * BTN_TOUCH * BTN_DIGI (aka BTN_TOOL_PEN)(You can use a tool like "evemu-record" to determine the events that are sent from specific /dev/input/event* devices)Possible solutions would be to improve the the filtering by adding additional checks that filter out the problem devices without preventing legitimate joysticks from appearing; altering the input/HID drivers that add these events if some events are added incorrectly; or adding a blacklist table to joydev.c that prevents the driver from matching devices with specific IDs.[1]:[2]:[3]:
id=15882	Previously, ath9k had problems where many users reported it would "hang" every so often for about 10 seconds. During this time, the wireless card would not transmit or receive any information. This has been fixed for most cases, EXCEPT WPA2 Enterprise on my campus.I am at the University of Minnesota. We have two wireless networks for students, faculty, etc. One is encrypted: UofM Secure. One is an open network with a login style page: UofM.When I connect to UofM, my wireless works fine. There are no hangs and the connection is very fast as I would expect.However, when I connect to UofM Secure, my connection will have the "hangs" that were previously reported. They usually occur every 1-2 minutes and last for about 10 seconds. I have verified these hangs are not the network itself, as the connection seems to have no issues on a Windows machine. I have also tried using ndiswrapper with a Windows XP Atheros driver, and while this helps the problem it does *not* solve it completely.UofM Secure uses PEAP Version 0 and MSCHAPv2 authentication. I don't know if this helps or is relevant but there it is anyways.I experienced this problem on Ubuntu 9.10 and 10.04. In both cases, I tried installing the "bleeding-edge" compat-wireless ath9k modules. Neither helped the problem at all.If I can be of any more help or provide more information, please let me know. Previous periodic "hangs" were related to scanning. I'm not sure what would account for what you describe -- perhaps something related to rekeying?Can you ensure that wpa_supplicant is using "-dd" in its command line options (either by running it directly or using your distro's configuration scripts)? Please attach the resulting logs here -- thanks!Just a quick update here: I've done some more testing in Ubuntu 10.04... it seems that there, using ndiswrapper *does* fix the problem entirely (but did not in 9.10). The problems ndiswrapper experienced were probably a result the network scanning mentioned previously?Also, I spoke too soon about the unsecured connection it seems. Using ath9k on UofM seemed to work fine one day, but I tried it again and was getting those hangups. Maybe it's location dependent? Trying to roam between access points?I will connect to UofM Secure using wpa_supplicant as John noted above and post back when I get some logs.CreatedDebug log from wpa_supplicant -ddHere is the log from wpa_supplicant that John requested. I ran `wpa_supplicant -i wlan0 -c /etc/wpa_supplicant.conf -dd > /tmp/wpa_supplicant.log 2>&1`. I did some browsing on reddit.com and ensured that I experienced the hangs I described. I think there were two of them before I cut off the connection.Please let me know if there is anything else I can do to help.Thanks for the log -- perhaps someone from Atheros has some insight?Could you please try a recent version of compat-wireless? The patch 'ath9k: fix another source of corrupt frames' and maybe some of the other changes in there might help resolve that kind of problem.Felix: Sorry for the delayed response. I've just now been able to test things out again after finals and everything. Recent versions of compat-wireless don't seem to be working properly on my machine. I tried the very latest one today, and also the bleeding-edge as released on May 11, 2010.After untarring & cd, I ran `scripts/driver-select ath9k`, then `make` and finally `sudo make install`. I am presented with the following:WARNING: Error inserting ath9k_hw (/lib/modules/2.6.32-22-generic/updates/cw/ath9k_hw.ko): Unknown symbol in module, or unknown parameter (see dmesg)WARNING: Error inserting mac80211 (/lib/modules/2.6.32-22-generic/updates/net/mac80211/mac80211.ko): Unknown symbol in module, or unknown parameter (see dmesg)WARNING: Error inserting ath9k_common (/lib/modules/2.6.32-22-generic/updates/cw/ath9k_common.ko): Unknown symbol in module, or unknown parameter (see dmesg)FATAL: Error inserting ath9k (/lib/modules/2.6.32-22-generic/updates/cw/ath9k.ko): Unknown symbol in module, or unknown parameter (see dmesg)This error is from the May 11 compat-wireless. I can rebuild the May 18th and double check its error but I am fairly certain they are the same.`lsmod | grep ath9k` shows that indeed, ath9k was not inserted.The output from dmesg regarding ath9k is as follows (again, May 11 compat-wireless -- latest is the same):[ 3546.065366] ath: disagrees about version of symbol wiphy_apply_custom_regulatory[ 3546.065378] ath: Unknown symbol wiphy_apply_custom_regulatory[ 3546.065690] ath: disagrees about version of symbol freq_reg_info[ 3546.065699] ath: Unknown symbol freq_reg_infoThese errors occurred on an Ubuntu 10.04 32 bit installation, updated.Since I was looking to speed things up on my netbook a bit, I installed Arch on it. It's running the 2.6.34 kernel.Since wireless was still shaky, I tried compiling the bleeding edge compat wireless on it (7/26/2010 nightly).Still no dice. I still get the hangs that I described previously on UofM Secure. When I leave ping running, it seems that the times are not correct but do seem to bear some relation to how long the hangs occur. For example, if there is a ~10 second hang, ping will say that it took ~1 second to get an echo reply. There are also "smaller" hiccups now, where the wireless will hang for just a second or two and ping reports ~150 ms. I would say this is definitely still a problem of UofM Secure.There are still some very minor hiccups on UofM. None of them seem to last more than two seconds or so. Web browsing also seems fine, though I have not investigated this very thoroughly yet so give me some more time to try it out before you take that as a definitive answer. If it continues to act the way it has for these few minutes then I would say the issue is resolved with regards to unsecured networks.I hope that this will satisfy the "NEEDINFO" status that seems to be blocking this bug.Cheers and thanks for all the hard work.Felix, any further ideas?Atheros guys, ping?(In reply to)Can you please you use the latest compat wireless 22 november ?Can you please try with the latest wpa-supplicant(git clone host-apd it).(In reply to)with the latest wpa supplicant ,you can enable BG_SCANwpa_supplicant build configuration (wpa_supplicant/.configfile) add following line:CONFIG_BGSCAN_SIMPLE=yIn the runtime configuration file, add the following line into thenetwork configuration block:bgscan="simple:30:-55:300"(that enables background scans every 300 seconds if signal strength isbetter than -55 and every 30 seconds if worse; in addition, a backgroundscan is triggered whenever the signal strength to the current AP dropsconsiderably)To reduce effect from more frequent scans, you may want to limit whichchannels are scanned (e.g., add scan_freq=2412 2437 2462 to the networkblock). The in hostap.git (development tree), there is also a moreadvanced bgscan module ("learn") that will dynamically generate thislist based on where APs are.(quoted from Jouni's mail about roaming)We need to adjust the bgscan parameters based on your AP's signal strengthsI figured out a workaround for the problem I am experiencing. On the University of Minnesota campus, there are APs all over the place. Running `iwlist wlan0 scan` gives me 30 where I am sitting now. The problem (I am guessing) is linked to roaming between APs when it is not necessary.My workaround is this: run an `iwlist wlan0 scan` and find the BSSID for the AP with the best signal strength. Right click the NetworkManager applet, edit the UofM connection, and set the BSSID to the one you got from the iwlist command.Now my wireless is not so ridiculously slow that I want to jump from the Washington Ave. bridge. It still isn't fast, but it is MUCH more tolerable than it was before.Shafi: I have not tried your fix yet. When I get more time to play with this, I will try it out and get back to you.Also, I want to thank all those working on ath9k and Linux wireless subsystems. Things have certainly come a long way in a short time.Cheers.(In reply to)>really goodOk sureI'm going to close this for now -- please reopen if the info about Shafi's proposed fix becomes available (and the problem persists with 2.6.37 or later).Createdconfig used to build a kernel with improved wireless stability on UMN campus.As this has been driving me crazy for some time, I took it upon myself to figure out what the problem was and fix it if need be. I have several findings so far:1. The connectivity issues seem to stem not from an abundance of access points, but the fact that there are many clients associated. One morning in class I noted that wireless was working exceptionally well (in that particular location, it usually does not). When people started arriving with laptops and using wireless, my connectivity suffered massively.2. Using the minstrel (as opposed to minstrel_ht) rate control algorithm *greatly* improves my connectivity, even when many people are using laptops.I have only been able to test wireless in 2-3 places so far, so not enough to confirm that minstrel_ht is definitively the problem.I'm running Arch Linux on my netbook currently with kernel 2.6.37. I used the Arch Build System to compile a new kernel but modifying config so that minstrel is used instead of minstrel_ht -- see the attachment I added. If minstrel_ht is indeed the culprit, I hope this will inspire someone more knowledgeable than I to fix whatever the problem might be.(In reply to)I think this comment needs some clarification. What happens when you choose minstrel instead of minstrel_ht is that all tx side 802.11n features get disabled - so no MCS rates, no aggregation, etc. You might as well be running the access point in legacy mode...It's highly unlikely that minstrel_ht is the cause of the problem here, it sounds more like certain 802.11n features (most likely aggregation) are causing your issues.- FelixMaybe ath9k needs an option for disabling .11n...Using minstrel was not the cure-all I had hoped for. In the classroom I am in now, there are 15-20 laptops out and presumably all are connected to the wireless.Before (when using minstrel_ht) it would have been a cold day in hell before I could do _anything_ with my wireless connection. Now, it is usable but still annoyingly slow. I can check e-mail and surf the web if I am patient, but it is not in a good enough state for me to apply updates or do any large file transfers. In short, there is a marked improvement using minstrel but things are still in an unacceptable state for me. The slowness is still as previously described: the wireless just seems to hang (stops sending/receiving packets completely).I will also note that I did have to try connecting to UofM Secure several times before it was actually successful (using NetworkManager).At least from my perspective, it looks like there are two separate issues (I don't really have much knowledge of wireless though, so I could quite possibly be wrong). First, any sort of wireless N seems to hinder things when there are even a few other clients connected (5-8). In general, if there are many other clients, wireless speeds are abysmal.(In reply to)Can you please give a try with ATH9K_RATE_CONTROL. hope it works for this particular scenario, as it goes to lower rates when there is lot of congestionif you doubt NetworkManager as the problem, completely disable it and connect to your network using wpa_supplicant.don't know where the problem lies.The attached kernel configuration shows I have CONFIG_ATH9K_RATE_CONTROL=y. Is there something else I have to do to make use of this feature, or is that it?I've tried wicd and plain wpa_supplicant before. I just tried wpa_supplicant again and the connection is still shoddy. I think NetworkManager has been eliminated as the issue at this point.Me either. I have tried disabling power management on the wireless NIC too. I don't get it. It just _completely_ stops transmitting or receiving anything (at least according to `tcpdump -i wlan0`). What might cause such behavior?(In reply to)Yes and it looks like you were already using ath9k rate control.sudo iwconfig wlan0 power off(or)sudo iw dev wlan0 set power_save off(In reply to)The problem is still present even with power save turned off.Hello!I have the same problem - the wireless card would nottransmit or receive any information several seconds before and after Scan Request.My ath9k card is: 03:00.0 Network controller: Atheros Communications Inc. AR9462 Wireless Network Adapter (rev 01) Subsystem: Samsung Electronics Co Ltd Device 4112Wirelass Network is WPA2 Private (PSK/TKIP).(In reply to)AR9462 is a BTCOEX card, pls let me know if you had enabled BTCOEX.if BT is enabled both the LEDS would glow.also could you please try with the patch.Hi all,Sorry for responding to such an old bug (it's almost 2014, amazingly), but I'm having these problems as well.I'm currently at the State University of New York, Stony Brook, and their WPA2 Enterprise network (with their multiple APs) is also on the fritz for me. The open networks are not experiencing this issue.Fedora 19, on backports-3.11-rc3-1, ath9k with Qualcomm Atheros AR9485 rev 01.Power save is off, BTCOEX enabled, LEGACY_RATE_CONTROL is off, PCI is on.Hey Robert,I've since graduated from University but as I recall I did find a solution (unfortunately I forgot to post it here!)I had to set the "nohwcrypt" option to 1 for the ath9k module.This will fix the issue for the current boot or until the module is reloaded:# rmmod ath9k# modprobe ath9k nohwcrypt=1For a permanent fix, use modprobe.d:# echo 'options ath9k nohwcrypt=1' > /etc/modprobe.d/ath9k.confPlease write back and and let me know if this solves your problem, I'd be interested to know!Cheers,JohnHi John, thanks for responding!(In reply to jkoelndorfer from)Hmm... Sadly, this doesn't fix my issue. I already had nohwcrypt before trying anything else.
id=12877	Latest working kernel version: noneEarliest failing kernel version: 2.6.28.1Distribution: Debian LennyHardware Environment: HP DL320G5pSoftware Environment: Debian Lenny host for KVM VMsProblem Description:Every couple of weeks the network of my colo box dies with the following message:[784060.816020] ------------[ cut here ]------------[784060.869153] WARNING: at net/sched/sch_generic.c:226 dev_watchdog+0x121/0x1b8()[784060.953146] NETDEV WATCHDOG: eth0 (tg3): transmit timed out[784061.018138] Modules linked in: esp6 xfrm6_mode_tunnel authenc esp4 xfrm4_mode_tunnel tun kvm_intel kvm xt_NOTRACK ip6table_raw ip6t_LOG nf_conntrack_ipv6 ip6table_filter ip6_tables xt_physdev ipt_LOG xt_tcpudp nf_conntrack_ipv4 nf_defrag_ipv4 xt_state nf_conntrack xt_hashlimit iptable_filter ip_tables x_tables bridge stp llc deflate zlib_deflate zlib_inflate ctr twofish twofish_common camellia serpent blowfish des_generic cbc aes_x86_64 aes_generic xcbc sha256_generic sha1_generic crypto_null af_key dm_crypt ipv6 coretemp loop ipmi_si ipmi_msghandler hpilo hpwdt pcspkr shpchp pci_hotplug container button psmouse serio_raw evdev ext3 jbd dm_mirror dm_region_hash dm_log dm_snapshot dm_mod raid1 md_mod sg sd_mod sr_mod cdrom usbhid hid ata_piix ata_generic libata scsi_mod ide_pci_generic ide_core ehci_hcd tg3 libphy uhci_hcd thermal processor fan thermal_sys[784061.891133] Pid: 0, comm: swapper Not tainted 2.6.28.7 #1[784061.954129] Call Trace:[784061.983133] <IRQ> [<ffffffff802398aa>] warn_slowpath+0xb4/0xda[784062.053147] [<ffffffffa0269998>] dst_output+0x0/0xb [ipv6][784062.118130] [<ffffffff803e35a8>] nf_hook_slow+0x62/0xc3[784062.180139] [<ffffffffa0269998>] dst_output+0x0/0xb [ipv6][784062.245126] [<ffffffff80332437>] __next_cpu+0x19/0x26[784062.305124] [<ffffffff80212a61>] read_tsc+0xa/0x1f[784062.362126] [<ffffffff80251c69>] getnstimeofday+0x52/0xac[784062.426126] [<ffffffff803d9bd1>] dev_watchdog+0x121/0x1b8[784062.490124] [<ffffffff8025015f>] sched_clock_tick+0x8a/0x92[784062.556124] [<ffffffff803d9ab0>] dev_watchdog+0x0/0x1b8[784062.618123] [<ffffffff80241f50>] run_timer_softirq+0x198/0x21a[784062.687118] [<ffffffff80251c69>] getnstimeofday+0x52/0xac[784062.751117] [<ffffffff8023e61a>] __do_softirq+0x83/0x143[784062.814116] [<ffffffff8020d6ec>] call_softirq+0x1c/0x28[784062.876119] [<ffffffff8020ecd0>] do_softirq+0x3c/0x81[784062.936114] [<ffffffff8023e338>] irq_exit+0x3f/0x83[784062.994139] [<ffffffff8021be99>] smp_apic_timer_interrupt+0x92/0xab[784063.068116] [<ffffffff8020cef8>] apic_timer_interrupt+0x88/0x90[784063.138109] <EOI> [<ffffffffa03c4a20>] handle_halt+0x0/0x12 [kvm_intel][784063.217116] [<ffffffff802134fe>] mwait_idle+0x3c/0x46[784063.277113] [<ffffffff8020b0bd>] cpu_idle+0x51/0x92[784063.335127] ---[ end trace 444b547394c96982 ]---[784063.389142] tg3: eth0: transmit timed out, resetting[784063.447106] tg3: DEBUG: MAC_TX_STATUS[ffffffff] MAC_RX_STATUS[ffffffff][784063.524104] tg3: DEBUG: RDMAC_STATUS[ffffffff] WDMAC_STATUS[ffffffff][784063.706035] tg3: tg3_stop_block timed out, ofs=2c00 enable_bit=2[784063.875340] tg3: tg3_stop_block timed out, ofs=2000 enable_bit=2[784064.044372] tg3: tg3_stop_block timed out, ofs=2400 enable_bit=2[784064.213191] tg3: tg3_stop_block timed out, ofs=2800 enable_bit=2[784064.382454] tg3: tg3_stop_block timed out, ofs=3000 enable_bit=2[784064.551295] tg3: tg3_stop_block timed out, ofs=1400 enable_bit=2[784064.720269] tg3: tg3_stop_block timed out, ofs=1800 enable_bit=2[784064.889183] tg3: tg3_stop_block timed out, ofs=c00 enable_bit=2[784065.057321] tg3: tg3_stop_block timed out, ofs=4800 enable_bit=2[784065.226318] tg3: tg3_stop_block timed out, ofs=1000 enable_bit=2[784065.395423] tg3: tg3_stop_block timed out, ofs=1c00 enable_bit=2[784065.564199] tg3: tg3_abort_hw timed out for eth0, TX_MODE_ENABLE will not clear MAC_TX_MODE=ffffffff[784065.769278] tg3: tg3_stop_block timed out, ofs=3c00 enable_bit=2[784065.938319] tg3: tg3_stop_block timed out, ofs=4c00 enable_bit=2[784067.283239] tg3: eth0: No firmware running.[784068.533652] tg3: tg3_abort_hw timed out for eth0, TX_MODE_ENABLE will not clear MAC_TX_MODE=ffffffff[784081.605984] tg3: eth0: Link is down.When it happens I either have to reboot the system or rmmod/modprobe tg3 to get it working again. The interface affected is the routed upstream port of the system, the system doesn't do much more than to route/firewall to an internal bridge where several KVM VMs are connected to. eth0 has a shared physical port with the on-board iLO2, which is still reachable when the problem happens. The switchport bounces a couple of times though.Steps to reproduce: svr02:~# lspci -v00:00.0 Host bridge: Intel Corporation 3200/3210 Chipset DRAM Controller (rev 01) Subsystem: Hewlett-Packard Company Device 31f9 Flags: bus master, fast devsel, latency 0 Capabilities: [e0] Vendor Specific Information <?> 00:01.0 PCI bridge: Intel Corporation 3200/3210 Chipset Host-Primary PCI Express Bridge (rev 01) (prog-if 00 [Normal decode]) Flags: bus master, fast devsel, latency 0 Bus: primary=00, secondary=15, subordinate=1a, sec-latency=0 Capabilities: [88] Subsystem: Hewlett-Packard Company Device 31f9 Capabilities: [80] Power Management version 3 Capabilities: [90] Message Signalled Interrupts: Mask- 64bit- Queue=0/0 Enable+ Capabilities: [a0] Express Root Port (Slot+), MSI 00 Capabilities: [100] Virtual Channel <?> Capabilities: [140] Root Complex Link <?> Kernel driver in use: pcieport-driver Kernel modules: shpchp 00:06.0 PCI bridge: Intel Corporation 3210 Chipset Host-Secondary PCI Express Bridge (rev 01) (prog-if 00 [Normal decode]) Flags: bus master, fast devsel, latency 0 Bus: primary=00, secondary=12, subordinate=14, sec-latency=0 Capabilities: [88] Subsystem: Hewlett-Packard Company Device 31f9 Capabilities: [80] Power Management version 3 Capabilities: [90] Message Signalled Interrupts: Mask- 64bit- Queue=0/0 Enable+ Capabilities: [a0] Express Root Port (Slot+), MSI 00 Capabilities: [100] Virtual Channel <?> Capabilities: [140] Root Complex Link <?> Kernel driver in use: pcieport-driver Kernel modules: shpchp 00:1c.0 PCI bridge: Intel Corporation 82801I (ICH9 Family) PCI Express Port 1 (rev 02) (prog-if 00 [Normal decode]) Flags: bus master, fast devsel, latency 0 Bus: primary=00, secondary=02, subordinate=03, sec-latency=0 Memory behind bridge: fdf00000-fdffffff Capabilities: [40] Express Root Port (Slot-), MSI 00 Capabilities: [80] Message Signalled Interrupts: Mask- 64bit- Queue=0/0 Enable+ Capabilities: [90] Subsystem: Gammagraphx, Inc. Device 0000 Capabilities: [a0] Power Management version 2 Capabilities: [100] Virtual Channel <?> Capabilities: [180] Root Complex Link <?> Kernel driver in use: pcieport-driver Kernel modules: shpchp 00:1c.2 PCI bridge: Intel Corporation 82801I (ICH9 Family) PCI Express Port 3 (rev 02) (prog-if 00 [Normal decode]) Flags: bus master, fast devsel, latency 0 Bus: primary=00, secondary=04, subordinate=06, sec-latency=0 Capabilities: [40] Express Root Port (Slot-), MSI 00 Capabilities: [80] Message Signalled Interrupts: Mask- 64bit- Queue=0/0 Enable+ Capabilities: [90] Subsystem: Gammagraphx, Inc. Device 0000 Capabilities: [a0] Power Management version 2 Capabilities: [100] Virtual Channel <?> Capabilities: [180] Root Complex Link <?> Kernel driver in use: pcieport-driver Kernel modules: shpchp 00:1c.3 PCI bridge: Intel Corporation 82801I (ICH9 Family) PCI Express Port 4 (rev 02) (prog-if 00 [Normal decode]) Flags: bus master, fast devsel, latency 0 Bus: primary=00, secondary=07, subordinate=09, sec-latency=0 Capabilities: [40] Express Root Port (Slot-), MSI 00 Capabilities: [80] Message Signalled Interrupts: Mask- 64bit- Queue=0/0 Enable+ Capabilities: [90] Subsystem: Gammagraphx, Inc. Device 0000 Capabilities: [a0] Power Management version 2 Capabilities: [100] Virtual Channel <?> Capabilities: [180] Root Complex Link <?> Kernel driver in use: pcieport-driver Kernel modules: shpchp 00:1c.4 PCI bridge: Intel Corporation 82801I (ICH9 Family) PCI Express Port 5 (rev 02) (prog-if 00 [Normal decode]) Flags: bus master, fast devsel, latency 0 Bus: primary=00, secondary=0a, subordinate=0c, sec-latency=0 Capabilities: [40] Express Root Port (Slot-), MSI 00 Capabilities: [80] Message Signalled Interrupts: Mask- 64bit- Queue=0/0 Enable+ Capabilities: [90] Subsystem: Gammagraphx, Inc. Device 0000 Capabilities: [a0] Power Management version 2 Capabilities: [100] Virtual Channel <?> Capabilities: [180] Root Complex Link <?> Kernel driver in use: pcieport-driver Kernel modules: shpchp 00:1c.5 PCI bridge: Intel Corporation 82801I (ICH9 Family) PCI Express Port 6 (rev 02) (prog-if 00 [Normal decode]) Flags: bus master, fast devsel, latency 0 Bus: primary=00, secondary=0d, subordinate=11, sec-latency=0 Capabilities: [40] Express Root Port (Slot-), MSI 00 Capabilities: [80] Message Signalled Interrupts: Mask- 64bit- Queue=0/0 Enable+ Capabilities: [90] Subsystem: Gammagraphx, Inc. Device 0000 Capabilities: [a0] Power Management version 2 Capabilities: [100] Virtual Channel <?> Capabilities: [180] Root Complex Link <?> Kernel driver in use: pcieport-driver Kernel modules: shpchp 00:1d.0 USB Controller: Intel Corporation 82801I (ICH9 Family) USB UHCI Controller #1 (rev 02) (prog-if 00 [UHCI]) Subsystem: Hewlett-Packard Company Device 31fe Flags: bus master, medium devsel, latency 0, IRQ 21 I/O ports at 1000 [size=32] Capabilities: [50] PCIe advanced features <?> Kernel driver in use: uhci_hcd Kernel modules: uhci-hcd 00:1d.1 USB Controller: Intel Corporation 82801I (ICH9 Family) USB UHCI Controller #2 (rev 02) (prog-if 00 [UHCI]) Subsystem: Hewlett-Packard Company Device 31fe Flags: bus master, medium devsel, latency 0, IRQ 21 I/O ports at 1020 [size=32] Capabilities: [50] PCIe advanced features <?> Kernel driver in use: uhci_hcd Kernel modules: uhci-hcd 00:1d.2 USB Controller: Intel Corporation 82801I (ICH9 Family) USB UHCI Controller #3 (rev 02) (prog-if 00 [UHCI]) Subsystem: Hewlett-Packard Company Device 31fe Flags: bus master, medium devsel, latency 0, IRQ 21 I/O ports at 1040 [size=32] Capabilities: [50] PCIe advanced features <?> Kernel driver in use: uhci_hcd Kernel modules: uhci-hcd 00:1d.3 USB Controller: Intel Corporation 82801I (ICH9 Family) USB UHCI Controller #6 (rev 02) (prog-if 00 [UHCI]) Subsystem: Hewlett-Packard Company Device 31fe Flags: bus master, medium devsel, latency 0, IRQ 21 I/O ports at 1060 [size=32] Capabilities: [50] PCIe advanced features <?> Kernel driver in use: uhci_hcd Kernel modules: uhci-hcd 00:1d.7 USB Controller: Intel Corporation 82801I (ICH9 Family) USB2 EHCI Controller #1 (rev 02) (prog-if 20 [EHCI]) Subsystem: Hewlett-Packard Company Device 31fe Flags: bus master, medium devsel, latency 0, IRQ 21 Memory at fdcf0000 (32-bit, non-prefetchable) [size=1K] Capabilities: [50] Power Management version 2 Capabilities: [58] Debug port: BAR=1 offset=00a0 Capabilities: [98] PCIe advanced features <?> Kernel driver in use: ehci_hcd Kernel modules: ehci-hcd 00:1e.0 PCI bridge: Intel Corporation 82801 PCI Bridge (rev 92) (prog-if 01 [Subtractive decode]) Flags: bus master, fast devsel, latency 0 Bus: primary=00, secondary=01, subordinate=01, sec-latency=64 I/O behind bridge: 00002000-00003fff Memory behind bridge: fdd00000-fdefffff Prefetchable memory behind bridge: 00000000d8000000-00000000dfffffff Capabilities: [50] Subsystem: Hewlett-Packard Company Device 31fe 00:1f.0 ISA bridge: Intel Corporation 82801IR (ICH9R) LPC Interface Controller (rev 02) Flags: bus master, medium devsel, latency 0 Capabilities: [e0] Vendor Specific Information <?> 00:1f.2 IDE interface: Intel Corporation 82801IR/IO/IH (ICH9R/DO/DH) 4 port SATA IDE Controller (rev 02) (prog-if 8f [Master SecP SecO PriP PriO]) Subsystem: Hewlett-Packard Company Device 31fe Flags: bus master, 66MHz, medium devsel, latency 0, IRQ 20 I/O ports at 1080 [size=8] I/O ports at 1088 [size=4] I/O ports at 1090 [size=8] I/O ports at 1098 [size=4] I/O ports at 10a0 [size=16] I/O ports at 10b0 [size=16] Capabilities: [70] Power Management version 3 Capabilities: [b0] PCIe advanced features <?> Kernel driver in use: ata_piix Kernel modules: ide-pci-generic, ata_generic, ata_piix 00:1f.5 IDE interface: Intel Corporation 82801I (ICH9 Family) 2 port SATA IDE Controller (rev 02) (prog-if 85 [Master SecO PriO]) Subsystem: Hewlett-Packard Company Device 31fe Flags: bus master, 66MHz, medium devsel, latency 0, IRQ 20 I/O ports at 10c0 [size=8] I/O ports at 10c8 [size=4] I/O ports at 10d0 [size=8] I/O ports at 10d8 [size=4] I/O ports at 10e0 [size=16] I/O ports at 10f0 [size=16] Capabilities: [70] Power Management version 3 Capabilities: [b0] PCIe advanced features <?> Kernel driver in use: ata_piix Kernel modules: ide-pci-generic, ata_generic, ata_piix 01:02.0 VGA compatible controller: ATI Technologies Inc ES1000 (rev 02) (prog-if 00 [VGA controller]) Subsystem: Hewlett-Packard Company Device 31fb Flags: bus master, stepping, medium devsel, latency 64, IRQ 5 Memory at d8000000 (32-bit, prefetchable) [size=128M] I/O ports at 3000 [size=256] Memory at fdef0000 (32-bit, non-prefetchable) [size=64K] [virtual] Expansion ROM at fdd00000 [disabled] [size=128K] Capabilities: [50] Power Management version 2 01:04.0 System peripheral: Compaq Computer Corporation Integrated Lights Out Controller (rev 03) Subsystem: Hewlett-Packard Company Device 3305 Flags: medium devsel, IRQ 22 I/O ports at 2800 [size=256] Memory at fdee0000 (32-bit, non-prefetchable) [size=512] Capabilities: [f0] Power Management version 3 Kernel driver in use: hpwdt Kernel modules: hpwdt 01:04.2 System peripheral: Compaq Computer Corporation Integrated Lights Out Processor (rev 03) Subsystem: Hewlett-Packard Company Device 3305 Flags: bus master, medium devsel, latency 64, IRQ 23 BIST result: 00 I/O ports at 3400 [size=256] Memory at fded0000 (32-bit, non-prefetchable) [size=2K] Memory at fdec0000 (32-bit, non-prefetchable) [size=16K] Memory at fde00000 (32-bit, non-prefetchable) [size=512K] [virtual] Expansion ROM at fdd20000 [disabled] [size=64K] Capabilities: [f0] Power Management version 3 Kernel driver in use: hpilo Kernel modules: hpilo 01:04.4 USB Controller: Hewlett-Packard Company Proliant iLO2 virtual USB controller (prog-if 00 [UHCI]) Subsystem: Hewlett-Packard Company Device 3305 Flags: bus master, medium devsel, latency 64, IRQ 23 I/O ports at 3800 [size=32] Capabilities: [f0] Power Management version 3 Kernel driver in use: uhci_hcd Kernel modules: uhci-hcd01:04.6 IPMI SMIC interface: Hewlett-Packard Company Proliant iLO2 virtual UART (prog-if 01) Subsystem: Hewlett-Packard Company Device 3305 Flags: medium devsel, IRQ 22 Memory at fddf0000 (32-bit, non-prefetchable) [size=256] Capabilities: [f0] Power Management version 3 Kernel driver in use: ipmi_si Kernel modules: ipmi_si02:00.0 PCI bridge: Broadcom EPB PCI-Express to PCI-X Bridge (rev b5) (prog-if 00 [Normal decode]) Flags: bus master, fast devsel, latency 0 Bus: primary=02, secondary=03, subordinate=03, sec-latency=64 Memory behind bridge: fdf00000-fdffffff Capabilities: [60] Express PCI/PCI-X Bridge, MSI 00 Capabilities: [90] PCI-X bridge device Capabilities: [b0] Power Management version 2 Capabilities: [100] Advanced Error Reporting <?> Capabilities: [14c] Power Budgeting <?> Kernel modules: shpchp03:04.0 Ethernet controller: Broadcom Corporation NetXtreme BCM5715 Gigabit Ethernet (rev a3) Subsystem: Hewlett-Packard Company NC326i PCIe Dual Port Gigabit Server Adapter Flags: bus master, 66MHz, medium devsel, latency 64, IRQ 1272 Memory at fdff0000 (64-bit, non-prefetchable) [size=64K] Memory at fdfe0000 (64-bit, non-prefetchable) [size=64K] Expansion ROM at <ignored> [disabled] Capabilities: [40] PCI-X non-bridge device Capabilities: [48] Power Management version 2 Capabilities: [50] Vital Product Data <?> Capabilities: [58] Message Signalled Interrupts: Mask- 64bit+ Queue=0/3 Enable+ Kernel driver in use: tg3 Kernel modules: tg303:04.1 Ethernet controller: Broadcom Corporation NetXtreme BCM5715 Gigabit Ethernet (rev a3) Subsystem: Hewlett-Packard Company NC326i PCIe Dual Port Gigabit Server Adapter Flags: bus master, 66MHz, medium devsel, latency 64, IRQ 17 Memory at fdfd0000 (64-bit, non-prefetchable) [size=64K] Memory at fdfc0000 (64-bit, non-prefetchable) [size=64K] Expansion ROM at <ignored> [disabled] Capabilities: [40] PCI-X non-bridge device Capabilities: [48] Power Management version 2 Capabilities: [50] Vital Product Data <?> Capabilities: [58] Message Signalled Interrupts: Mask- 64bit+ Queue=0/3 Enable- Kernel driver in use: tg3 Kernel modules: tg3Reply-To:(switched to email. Please respond via emailed reply-to-all, not via thebugzilla web interface).On Sun, 15 Mar 2009 07:23:00 -0700 (PDT)wrote:On Sun, 2009-03-15 at 14:32 -0700, Andrew Morton wrote:At the time of tx timeout, the registers all return 0xffffffff. Doesthe subsequent reset bring the device back? If the device is broughtback, there should be a link up message and traffic should resume. Ifnot, please provide lspci -vvvxxx on the eth0 device after the failure.Also, when one ethernet port fails, does the other port (from the samedual port device) function ok?Thanks.On 16.03.2009 22:23, Michael Chan wrote:>The port does not pass traffic until I rmmod/modprobe the driver or reset the whole system, it doesn't recover by itself. "[784081.605984] tg3: eth0: Link is down." is the last message I see.I'll send you the lspci output as soon as it happens again.I'm not exactly sure about that, as nowadays there is nothing connected to it anymore. However, when the problem first occured there was, and I'm pretty sure the second port was okay.BernhardOn 16.03.2009 22:23, Michael Chan wrote:>Attached, both after the crash (tg3.crashed) and after I reloaded the module (tg3.reloaded). Additional info, ifdown/ifup does not fix the situation, both take pretty long# ifdown eth0tg3: tg3_abort_hw timed out for eth0, TX_MODE_ENABLE will not clear MAC_TX_MODE=ffffffff# ifup eth0tg3 0000:03:04.0: irq 1272 for MSI/MSI-XADDRCONF(NETDEV_UP): eth0: link is not readyand it stays dead.# rmmod tg3tg3 0000:03:04.1: PCI INT B disabledtg3 0000:03:04.0: PCI INT A disabled# modprobe tg3tg3.c:v3.94 (August 14, 2008)tg3 0000:03:04.0: enabling device (0000 -> 0002)tg3 0000:03:04.0: PCI INT A -> GSI 16 (level, low) -> IRQ 16eth0: Tigon3 [partno(N/A) rev 9003 PHY(5714)] (PCIX:133MHz:64-bit) 10/100/1000Base-T Ethernet 00:21:5a:99:0a:28eth0: RXcsums[1] LinkChgREG[0] MIirq[0] ASF[1] WireSpeed[1] TSOcap[1]eth0: dma_rwctrl[76148000] dma_mask[40-bit]tg3 0000:03:04.1: PCI INT B -> GSI 17 (level, low) -> IRQ 17eth1: Tigon3 [partno(N/A) rev 9003 PHY(5714)] (PCIX:133MHz:64-bit) 10/100/1000Base-T Ethernet 00:21:5a:99:0a:29eth1: RXcsums[1] LinkChgREG[0] MIirq[0] ASF[0] WireSpeed[1] TSOcap[1]eth1: dma_rwctrl[76148000] dma_mask[40-bit]# ifup eth0ADDRCONF(NETDEV_UP): eth0: link is not readydevice eth0 entered promiscuous modetg3: eth0: Link is up at 100 Mbps, full duplex.tg3: eth0: Flow control is off for TX and off for RX.ADDRCONF(NETDEV_CHANGE): eth0: link becomes readyand I'm up and running again.Still no clue about that, I need to find someone who can connect something there.BernhardOn Tue, 2009-03-17 at 15:09 -0700, Bernhard Schmidt wrote:Thanks for the information. The memory enable bit in the PCI commandregister was cleared during tx_timeout. That's why all the registerswere reading 0xffffffff. The tx_timeout code in tg3 would not be ableto reset the chip if that bit was cleared. We need to find out why thatbit was cleared. We should also enhance the tx timeout code so that itcan recover more completely even if the memory enable bit is cleared.Thanks.Hi Bernhard. I talked to Michael about this and we'd like you to trytwo things.1) Can you disable iLo2 and see if you can still reproduce the problem?2) Can you apply the following patch to get more information on when MMIO gets disabled?diff -Nrup 1/drivers/net/tg3.c 2/drivers/net/tg3.c--- 1/drivers/net/tg3.c 2009-02-20 14:41:27.000000000 -0800+++ 2/drivers/net/tg3.c 2009-03-19 09:51:17.000000000 -0700@@ -7799,6 +7799,12 @@ static void tg3_timer(unsigned long __op /* This part only runs once per second. */ if (!--tp->timer_counter) {+ u16 pci_cmd;++ pci_read_config_word(tp->pdev, PCI_COMMAND, &pci_cmd);+ if (!(pci_cmd & PCI_COMMAND_MEMORY))+ printk( KERN_WARNING "PCI Memory Mapped IO Disabled!!!!\n" );+ if (tp->tg3_flags2 & TG3_FLG2_5705_PLUS) tg3_periodic_fetch_stats(tp); On Tue, Mar 17, 2009 at 03:09:03PM -0700, Bernhard Schmidt wrote:Content-Description: tg3.crashedContent-Description: tg3.reloadedOn Thu, Mar 19, 2009 at 09:58:42AM -0700, Matt Carlson wrote:Hello Matt,That will take a few days, I'll ask the on-site guys to check whether wehave an external IP-KVM available. Would switching the uplink connection to eth1 (and not use eth0 inLinux) give some more clue as well?Applied, I'll send you the information as soon as it happens again(which seems to be happening rather often the last couple of days).BernhardOn Thu, Mar 19, 2009 at 11:06:44AM -0700, Bernhard Schmidt wrote:Sure, let's try that. Maybe this is the better way to go anyways. I justlearned that disabling iLo2 doesn't necessarily disable the managementfirmware on the network device.For this to be a meaningful test though, we need to verify that thedriver sign-on messages have a line that reads "ASF[0]" on eth1. Canyou confirm?Thanks.On Thu, Mar 19, 2009 at 11:15:36AM -0700, Matt Carlson wrote:Yes:[1186598.218205] eth0: RXcsums[1] LinkChgREG[0] MIirq[0] ASF[1]WireSpeed[1] TSOcap[1][1186598.281314] eth1: RXcsums[1] LinkChgREG[0] MIirq[0] ASF[0]WireSpeed[1] TSOcap[1]I'll keep the traffic on eth0 now until it breaks again, hopefullyspewing out more debugging info with your patch and then I'll switch toeth1.BernhardOn Thu, Mar 19, 2009 at 09:58:42AM -0700, Matt Carlson wrote:Hello Matt,Not sure this is going to help you. NIC crashed two times tonight, logslook like thisMar 22 04:06:46 svr02 kernel: [1392136.468921] PCI Memory Mapped IO Disabled!!!!Mar 22 04:06:47 svr02 kernel: [1392137.520288] PCI Memory Mapped IO Disabled!!!!Mar 22 04:06:48 svr02 kernel: [1392138.568267] PCI Memory Mapped IO Disabled!!!!Mar 22 04:06:49 svr02 kernel: [1392139.616266] PCI Memory Mapped IO Disabled!!!!Mar 22 04:06:50 svr02 kernel: [1392140.664266] PCI Memory Mapped IO Disabled!!!!Mar 22 04:06:51 svr02 kernel: [1392141.712276] PCI Memory Mapped IO Disabled!!!!Mar 22 04:06:52 svr02 kernel: [1392142.760297] PCI Memory Mapped IO Disabled!!!!Mar 22 04:06:53 svr02 kernel: [1392143.808258] PCI Memory Mapped IO Disabled!!!!Mar 22 04:06:54 svr02 kernel: [1392144.856256] PCI Memory Mapped IO Disabled!!!!Mar 22 04:06:55 svr02 kernel: [1392145.904266] PCI Memory Mapped IO Disabled!!!!Mar 22 04:06:56 svr02 kernel: [1392146.952276] PCI Memory Mapped IO Disabled!!!!Mar 22 04:06:57 svr02 kernel: [1392148.000267] PCI Memory Mapped IO Disabled!!!!Mar 22 04:06:58 svr02 kernel: [1392149.048271] PCI Memory Mapped IO Disabled!!!!Mar 22 04:06:59 svr02 kernel: [1392150.096268] PCI Memory Mapped IO Disabled!!!!Mar 22 04:07:00 svr02 kernel: [1392151.144277] PCI Memory Mapped IO Disabled!!!!Mar 22 04:07:01 svr02 kernel: [1392152.192287] PCI Memory Mapped IO Disabled!!!!Mar 22 04:07:02 svr02 kernel: [1392153.240268] PCI Memory Mapped IO Disabled!!!!Mar 22 04:07:03 svr02 kernel: [1392154.288267] PCI Memory Mapped IO Disabled!!!!Mar 22 04:07:04 svr02 kernel: [1392155.336267] PCI Memory Mapped IO Disabled!!!!Mar 22 04:07:05 svr02 kernel: [1392156.384268] PCI Memory Mapped IO Disabled!!!!Mar 22 04:07:07 svr02 kernel: [1392157.432267] PCI Memory Mapped IO Disabled!!!!Mar 22 04:07:08 svr02 kernel: [1392158.480266] PCI Memory Mapped IO Disabled!!!!Mar 22 04:07:09 svr02 kernel: [1392159.528289] PCI Memory Mapped IO Disabled!!!!Mar 22 04:07:10 svr02 kernel: [1392160.576297] PCI Memory Mapped IO Disabled!!!!Mar 22 04:07:11 svr02 kernel: [1392161.624277] PCI Memory Mapped IO Disabled!!!!Mar 22 04:07:12 svr02 kernel: [1392162.672267] PCI Memory Mapped IO Disabled!!!!Mar 22 04:07:13 svr02 kernel: [1392163.720266] PCI Memory Mapped IO Disabled!!!!Mar 22 04:07:14 svr02 kernel: [1392164.768266] PCI Memory Mapped IO Disabled!!!!at this point the "watchdog" kicked in and did rmmod/modprobe, so Ithink the only thing you can read out of this debugging log is thatthere was no kernel message right before MMIO got disabled and it takesquite a while to fire the Tx timeout.Mar 22 04:07:15 svr02 kernel: [1392165.540078] tg3 0000:03:04.1: PCI INT B disabledMar 22 04:07:16 svr02 kernel: [1392166.817125] tg3: tg3_abort_hw timed out for eth0, TX_MODE_ENABLE will not clear MAC_TX_MODE=ffffffffMar 22 04:07:18 svr02 kernel: [1392168.398844] tg3: eth0: No firmware running.Mar 22 04:07:29 svr02 kernel: [1392179.793309] tg3: eth0: Link is down.Mar 22 04:07:31 svr02 kernel: [1392181.896030] tg3 0000:03:04.0: PCI INT A disabledMar 22 04:07:33 svr02 kernel: [1392183.957132] tg3.c:v3.94 (August 14, 2008)Mar 22 04:07:33 svr02 kernel: [1392184.020034] tg3 0000:03:04.0: enabling device (0000 -> 0002)Mar 22 04:07:33 svr02 kernel: [1392184.086083] tg3 0000:03:04.0: PCI INT A -> GSI 16 (level, low) -> IRQ 16I'm now switching to eth1.BernhardOn Sun, Mar 22, 2009 at 06:21:21AM -0700, Bernhard Schmidt wrote:Actually, it does. :)So traffic on this box must be pretty light for the watchdog to fire off30 seconds after the MMIO problem was detected, right? Interesting.O.K. I eagerly await your results.On 23.03.2009 19:18, Matt Carlson wrote:Hello Matt,[...]Just to make sure I didn't confuse you, the "watchdog" I was talking about here is a shellscript like this, executed every minute---/bin/ping -q -c 5 <defaultgw> > /dev/nullRC=$?if [ ${RC} -ne 0 ]; then rmmod tg3; sleep 5; modprobe tg3; sleep 5; ifup --force eth0fi---at :46 MMIO was disabled, at :00 the cronjob started which took until :15 before detecting the network was dead and reloaded the modulesThe tg3 watchdog (tg3: eth0: transmit timed out, resetting) did not appear at all in this circle, so I guess the checkscript killed the module before.Yes, the NIC is very lightly loaded, around 100kbps / 70pps in each direction with a few occasional spikes.So far so good, but it has only been running ~36 hours, that's not really a stability spree yet :-)I'll keep you updated.BernhardOn Sun, Mar 22, 2009 at 06:21:21AM -0700, Bernhard Schmidt wrote:Bernhard, any word on what happened?On Tue, Mar 31, 2009 at 09:26:17AM -0700, Matt Carlson wrote:So far so good. In the last week my watchdog (cannot reach the defaultgateway) triggered once, but since there were no "PCI Memory Mapped IODisabled!!!!" messages in the logfile I assume that was a real networkproblem. Since the box ran fine for months initially and the first twooccurances of this issue were two weeks apart I cannot say for sure, butit definitely feels better than the "once in two days" in the end.BernhardHi Matt,No crashes in the last two weeks.Do you have any further suggestions how to debug this or should we accept that portsharing doesn't work very well? This is the second problem we can directly attribute to the sharing with the iLO (the first one being the "no IPv6 unless the port is in promiscous mode", we had a thread about this here on netdev a few months ago).BernhardOn Mon, Apr 13, 2009 at 02:54:40PM -0700, Bernhard Schmidt wrote:No, I think we need to get this to work with portsharing. We just needto figure out what it is about it that causes these types of errors.I talked to the firmware maintainer here. We have a couple ideas thatmight uncover what is happening. Our next step is to develop a set oftests that will show under what assumptions the firmware is operating.Once we have that, I'll ask you to patch your driver so that we can seewhat is happening from your end.Stay tuned.Hi all,I'm sorry if I write in wrong bug report but it seams identical like mine.Bug:WARNING: at /tmp/buildd/linux-2.6-2.6.32/debian/build/source_i386_none/net/sched/sch_generic.c:261 dev_watchdog+0xbd/0x15d()Hardware name: 40682VG NETDEV WATCHDOG: eth0 (tg3): transmit queue 0 timed outNETDEV WATCHDOG: eth0 (tg3): transmit queue 0 timed outModules linked in: uinput ppdev lp parport sco bridge stp bnep rfcomm l2cap crc16 vboxnetadp vboxnetflt vboxdrv acpi_cpufreq cpufreq_powersave cpufreq_stats cpufreq_conservative cpufreq_userspace microcode fuse snd_hda_codec_realtek snd_hda_intel snd_hda_codec snd_hwdep snd_pcm_oss snd_mixer_oss snd_pcm snd_seq_midi snd_rawmidi snd_seq_midi_event snd_seq snd_timer uvcvideo btusb videodev v4l1_compat snd_seq_device lib80211_crypt_tkip bluetooth joydev rfkill i2c_i801 snd wl(P) soundcore snd_page_alloc rng_core serio_raw lib80211 evdev pcspkr ac psmouse processor battery ext3 jbd mbcache sd_mod crc_t10dif ide_gd_mod ata_generic usbhid hid usb_storage ide_pci_generic i915 drm_kms_helper drm i2c_algo_bit ata_piix uhci_hcd i2c_core intel_agp piix ehci_hcd libata tg3 video output ide_core usbcore agpgart scsi_mod libphy button nls_base thermal fan thermal_sys [last unloaded: scsi_wait_scan]Pid: 0, comm: swapper Tainted: P 2.6.32-trunk-686 #1Call Trace: [<c1030ba1>] ? warn_slowpath_common+0x5e/0x8a [<c11d778c>] ? dev_watchdog+0x0/0x15d [<c1030bff>] ? warn_slowpath_fmt+0x26/0x2a [<c11d7849>] ? dev_watchdog+0xbd/0x15d [<c102520b>] ? __wake_up+0x29/0x39 [<c1041826>] ? insert_work+0x71/0x78 [<c1041b9f>] ? delayed_work_timer_fn+0x0/0x28 [<c103b360>] ? run_timer_softirq+0x16a/0x1eb [<c1035c80>] ? __do_softirq+0xaa/0x151 [<c1035d58>] ? do_softirq+0x31/0x3c [<c1035e2e>] ? irq_exit+0x26/0x58 [<c1004c91>] ? do_IRQ+0x78/0x89 [<c10037f0>] ? common_interrupt+0x30/0x38 [<f7f7a0d7>] ? acpi_idle_enter_bm+0x246/0x281 [processor] [<c11b5421>] ? cpuidle_idle_call+0x68/0xbb [<c1002388>] ? cpu_idle+0x89/0xa5 [<c1399800>] ? start_kernel+0x30c/0x311---[ end trace 0e630f751e4c6fe2 ]---I have Lenovo IdeaPad S10e (Broadcom NIC)lspci -vnn02:00.0 Ethernet controller [0200]: Broadcom Corporation NetLink BCM5906M Fast Ethernet PCI Express [14e4:1713] (rev 02) Subsystem: Lenovo IdeaPad S10e [17aa:3a23] Flags: bus master, fast devsel, latency 0, IRQ 27 Memory at f0200000 (64-bit, non-prefetchable) [size=64K] Expansion ROM at <ignored> [disabled] Capabilities: <access denied> Kernel driver in use: tg3Problem is when I upload bigger data on eth0, ethernet broke after 10-15 minutes and if I don't restart him with /etc/init.d/networking stop | start he doesn't come back for ~3 minutes.There is no problem with download.I'm sure you have doesn't of mine kerneloops report like this.Thanks.There seem to be many similar bugs already listed - this one seemed most similar to mine. We have a pair of very busy Squid servers using identical Asus server motherboards. The networking on one box intermittently fails. Here's the resulting syslog / dmesg# cat /sys/class/net/eth0/device/vendor 0x14e4# cat /sys/class/net/eth0/device/device 0x1659# uname -r2.6.31.12#cat /var/log/syslogApr 22 23:49:35 kernel: [623449.988504] ------------[ cut here ]------------Apr 22 23:49:35 kernel: [623449.988511] WARNING: at net/sched/sch_generic.c:246 dev_watchdog+0x1be/0x1d0()Apr 22 23:49:35 kernel: [623449.988514] Hardware name: System Product NameApr 22 23:49:35 kernel: [623449.988516] NETDEV WATCHDOG: eth0 (tg3): transmit queue 0 timed outApr 22 23:49:35 kernel: [623449.988518] Modules linked in: ip_gre e1000 via_rhine tg3 libphy r8169 pcnet32 e100 8139too mii w83627ehf vt8231 via686a hwmon_vid coretemp asus_atk0110 hwmonApr 22 23:49:35 kernel: [623449.988533] Pid: 0, comm: swapper Not tainted 2.6.31.12 #2Apr 22 23:49:35 kernel: [623449.988535] Call Trace:Apr 22 23:49:35 kernel: [623449.988540] [<c012864e>] ? warn_slowpath_common+0x6e/0xb0Apr 22 23:49:35 kernel: [623449.988543] [<c034e4fe>] ? dev_watchdog+0x1be/0x1d0Apr 22 23:49:35 kernel: [623449.988546] [<c01286db>] ? warn_slowpath_fmt+0x2b/0x30Apr 22 23:49:35 kernel: [623449.988549] [<c034e4fe>] ? dev_watchdog+0x1be/0x1d0Apr 22 23:49:35 kernel: [623449.988553] [<c011f842>] ? __wake_up+0x42/0x60Apr 22 23:49:35 kernel: [623449.988557] [<c01376f2>] ? insert_work+0x42/0x50Apr 22 23:49:35 kernel: [623449.988560] [<c034e340>] ? dev_watchdog+0x0/0x1d0Apr 22 23:49:35 kernel: [623449.988564] [<c0131149>] ? run_timer_softirq+0xf9/0x1c0Apr 22 23:49:35 kernel: [623449.988567] [<c012d2c0>] ? __do_softirq+0x80/0x100Apr 22 23:49:35 kernel: [623449.988570] [<c012d36d>] ? do_softirq+0x2d/0x40Apr 22 23:49:35 kernel: [623449.988574] [<c0114d94>] ? smp_apic_timer_interrupt+0x54/0x90Apr 22 23:49:35 kernel: [623449.988577] [<c0103676>] ? apic_timer_interrupt+0x2a/0x30Apr 22 23:49:35 kernel: [623449.988581] [<c03f00d8>] ? klist_add_before+0x18/0x50Apr 22 23:49:35 kernel: [623449.988585] [<c0109dc2>] ? mwait_idle+0x42/0x60Apr 22 23:49:35 kernel: [623449.988587] [<c0101d55>] ? cpu_idle+0x35/0x60Apr 22 23:49:35 kernel: [623449.988590] ---[ end trace 346a74434bf31555 ]---Apr 22 23:49:35 kernel: [623449.988592] tg3: eth0: transmit timed out, resettingApr 22 23:49:35 kernel: [623449.988596] tg3: DEBUG: MAC_TX_STATUS[0000000f] MAC_RX_STATUS[00000008]Apr 22 23:49:35 kernel: [623449.988601] tg3: DEBUG: RDMAC_STATUS[00000000] WDMAC_STATUS[00000000]Apr 22 23:49:35 kernel: [623450.089694] tg3: tg3_stop_block timed out, ofs=1400 enable_bit=2Apr 22 23:49:35 kernel: [623450.248154] tg3: eth0: Link is down.# ethtool eth0Settings for eth0: Supported ports: [ TP ] Supported link modes: 10baseT/Half 10baseT/Full 100baseT/Half 100baseT/Full 1000baseT/Half 1000baseT/Full Supports auto-negotiation: Yes Advertised link modes: 10baseT/Half 10baseT/Full 100baseT/Half 100baseT/Full 1000baseT/Half 1000baseT/Full Advertised auto-negotiation: Yes Speed: 1000Mb/s Duplex: Full Port: Twisted Pair PHYAD: 1 Transceiver: internal Auto-negotiation: on Supports Wake-on: g Wake-on: g Current message level: 0x000000ff (255) Link detected: noIf this is still seen on modern kernels then please re-open/update(In reply to Alan from)Yes, kernel 3.13.xxx on x86_64 (HP server DL 385 G8, 4-port broadcom-based nic)Oct 30 14:28:27 Obi-One kernel: [12744.969716] ------------[ cut here ]------------Oct 30 14:28:27 Obi-One kernel: [12744.969739] WARNING: CPU: 0 PID: 0 at /build/buildd/linux-3.13.0/net/sched/sch_generic.c:264 dev_watchdog+0x276/0x280()Oct 30 14:28:27 Obi-One kernel: [12744.969744] NETDEV WATCHDOG: eth0 (tg3): transmit queue 0 timed outOct 30 14:28:27 Obi-One kernel: [12744.969746] Modules linked in: vhost_net vhost macvtap macvlan xt_recent ipt_MASQUERADE iptable_nat nf_nat_ipv4 nf_nat nf_conntrack_ipv4 nf_defrag_ipv4 xt_conntrack nf_conntrack ipt_REJECT xt_CHECKSUM iptable_mangle xt_tcpudp ip6table_filter ip6_tables iptable_filter ip_tables ebtable_nat ebtables x_tables bridge stp llc kvm_amd kvm crct10dif_pclmul dm_multipath crc32_pclmul ghash_clmulni_intel aesni_intel scsi_dh aes_x86_64 lrw gf128mul glue_helper sp5100_tco amd64_edac_mod ablk_helper edac_core i2c_piix4 ipmi_si hpwdt mac_hid hpilo cryptd acpi_power_meter k10temp fam15h_power serio_raw edac_mce_amd parport_pc ppdev lp parport pata_acpi hid_generic psmouse tg3 usbhid hid ahci ptp usb_storage pata_atiixp libahci hpsa pps_coreOct 30 14:28:27 Obi-One kernel: [12744.969868] CPU: 0 PID: 0 Comm: swapper/0 Not tainted 3.13.0-39-generic #66-UbuntuOct 30 14:28:27 Obi-One kernel: [12744.969872] Hardware name: HP ProLiant DL385p Gen8, BIOS A28 11/02/2013Oct 30 14:28:27 Obi-One kernel: [12744.969885] 0000000000000009 ffff880237c03d98 ffffffff8171ece7 ffff880237c03de0Oct 30 14:28:27 Obi-One kernel: [12744.969911] ffff880237c03dd0 ffffffff8106773d 0000000000000000 ffff880831c90000Oct 30 14:28:27 Obi-One kernel: [12744.969940] ffff880832330d80 0000000000000005 0000000000000000 ffff880237c03e30Oct 30 14:28:27 Obi-One kernel: [12744.969957] Call Trace:Oct 30 14:28:27 Obi-One kernel: [12744.969966] <IRQ> [<ffffffff8171ece7>] dump_stack+0x45/0x56Oct 30 14:28:27 Obi-One kernel: [12744.969993] [<ffffffff8106773d>] warn_slowpath_common+0x7d/0xa0Oct 30 14:28:27 Obi-One kernel: [12744.970006] [<ffffffff810677ac>] warn_slowpath_fmt+0x4c/0x50Oct 30 14:28:27 Obi-One kernel: [12744.970020] [<ffffffff816438f6>] dev_watchdog+0x276/0x280Oct 30 14:28:27 Obi-One kernel: [12744.970032] [<ffffffff81643680>] ? dev_graft_qdisc+0x80/0x80Oct 30 14:28:27 Obi-One kernel: [12744.970045] [<ffffffff810742f6>] call_timer_fn+0x36/0x100Oct 30 14:28:27 Obi-One kernel: [12744.970054] [<ffffffff81643680>] ? dev_graft_qdisc+0x80/0x80Oct 30 14:28:27 Obi-One kernel: [12744.970066] [<ffffffff8107528f>] run_timer_softirq+0x1ef/0x2f0Oct 30 14:28:27 Obi-One kernel: [12744.970087] [<ffffffff8106cb8c>] __do_softirq+0xec/0x2c0Oct 30 14:28:27 Obi-One kernel: [12744.970100] [<ffffffff8106d0d5>] irq_exit+0x105/0x110Oct 30 14:28:27 Obi-One kernel: [12744.970112] [<ffffffff81731bc5>] smp_apic_timer_interrupt+0x45/0x60Oct 30 14:28:27 Obi-One kernel: [12744.970127] [<ffffffff8173055d>] apic_timer_interrupt+0x6d/0x80Oct 30 14:28:27 Obi-One kernel: [12744.970135] <EOI> [<ffffffff815d189f>] ? cpuidle_enter_state+0x4f/0xc0Oct 30 14:28:27 Obi-One kernel: [12744.970161] [<ffffffff815d19c9>] cpuidle_idle_call+0xb9/0x1f0Oct 30 14:28:27 Obi-One kernel: [12744.970176] [<ffffffff8101d1de>] arch_cpu_idle+0xe/0x30Oct 30 14:28:27 Obi-One kernel: [12744.970188] [<ffffffff810bed85>] cpu_startup_entry+0xc5/0x290Oct 30 14:28:27 Obi-One kernel: [12744.970204] [<ffffffff8170d1f7>] rest_init+0x77/0x80Oct 30 14:28:27 Obi-One kernel: [12744.970218] [<ffffffff81d36f70>] start_kernel+0x438/0x443Oct 30 14:28:27 Obi-One kernel: [12744.970229] [<ffffffff81d36941>] ? repair_env_string+0x5c/0x5cOct 30 14:28:27 Obi-One kernel: [12744.970245] [<ffffffff81d36120>] ? early_idt_handlers+0x120/0x120Oct 30 14:28:27 Obi-One kernel: [12744.970257] [<ffffffff81d365ee>] x86_64_start_reservations+0x2a/0x2cOct 30 14:28:27 Obi-One kernel: [12744.970264] [<ffffffff81d36733>] x86_64_start_kernel+0x143/0x152Oct 30 14:28:27 Obi-One kernel: [12744.970268] ---[ end trace dc4b8daef1a66ac0 ]---Oct 30 14:28:27 Obi-One kernel: [12744.970275] tg3 0000:04:00.0 eth0: transmit timed out, resettingOct 30 14:28:28 Obi-One kernel: [12746.281243] tg3 0000:04:00.0 eth0: 0x00000000: 0x165714e4, 0x00100446, 0x02000001, 0x00800010Oct 30 14:28:28 Obi-One kernel: [12746.281255] tg3 0000:04:00.0 eth0: 0x00000010: 0xfcbf000c, 0x00000000, 0xfcbe000c, 0x00000000Oct 30 14:28:28 Obi-One kernel: [12746.281258] tg3 0000:04:00.0 eth0: 0x00000020: 0xfcbd000c, 0x00000000, 0x00000000, 0x169d103cOct 30 14:28:28 Obi-One kernel: [12746.281260] tg3 0000:04:00.0 eth0: ....... follows several screens hex dump..... Ethernet controller: Broadcom Corporation NetXtreme BCM5719 Gigabit Ethernet PCIe (rev 01)04:00.0 0200: 14e4:1657 (rev 01) Subsystem: 103c:169d Flags: bus master, fast devsel, latency 0, IRQ 36 Memory at fcbf0000 (64-bit, prefetchable) [size=64K] Memory at fcbe0000 (64-bit, prefetchable) [size=64K] Memory at fcbd0000 (64-bit, prefetchable) [size=64K] [virtual] Expansion ROM at fcb00000 [disabled] [size=128K] Capabilities: [48] Power Management version 3 Capabilities: [50] Vital Product Data Capabilities: [58] MSI: Enable- Count=1/8 Maskable- 64bit+ Capabilities: [a0] MSI-X: Enable+ Count=17 Masked- Capabilities: [ac] Express Endpoint, MSI 00 Capabilities: [100] Advanced Error Reporting Capabilities: [13c] Device Serial Number 00-00-ac-16-2d-72-98-bc Capabilities: [150] Power Budgeting <?> Capabilities: [160] Virtual Channel Capabilities: [230] Transaction Processing Hints Kernel driver in use: tg3rmmod/modprobe tg3 does not help. To restore the connectivity, I have to pull the plug. The connectivity on the other ports is O.K. I don't know if related, but the error is easily triggered when a qemu/KVM guest tries to send a packet via the NIC. There are some unhandled rdmsr/wrmsr warnings from kvm just before the call trace:Oct 30 14:26:20 Obi-One kernel: [12618.383147] device vnet1 entered promiscuous modeOct 30 14:26:20 Obi-One kernel: [12618.408736] virbr0: port 1(vnet1) entered listening stateOct 30 14:26:20 Obi-One kernel: [12618.408760] virbr0: port 1(vnet1) entered listening stateOct 30 14:26:22 Obi-One kernel: [12620.129653] kvm [5194]: vcpu0 unhandled rdmsr: 0xc0011021Oct 30 14:26:22 Obi-One kernel: [12620.129673] kvm [5194]: vcpu0 unhandled rdmsr: 0xc0010112Oct 30 14:26:22 Obi-One kernel: [12620.292889] kvm [5194]: vcpu0 unhandled rdmsr: 0xc0010001Oct 30 14:26:22 Obi-One kernel: [12620.306673] kvm [5194]: vcpu1 unhandled rdmsr: 0xc0011021Oct 30 14:26:22 Obi-One kernel: [12620.409849] virbr0: port 1(vnet1) entered learning stateOct 30 14:26:24 Obi-One kernel: [12622.414480] virbr0: topology change detected, propagatingOct 30 14:26:24 Obi-One kernel: [12622.414493] virbr0: port 1(vnet1) entered forwarding stateOct 30 14:26:24 Obi-One kernel: [12622.414555] IPv6: ADDRCONF(NETDEV_CHANGE): virbr0: link becomes readyOct 30 14:26:25 Obi-One kernel: [12623.137360] kvm [5194]: vcpu0 unhandled rdmsr: 0x3aI am encountering very similar issues as well with kernel 2.6.32-431.29.2 (the latest for CentOS 6.5 at the time of this writing.) and the Tigon NIC with driver 3.136H that my vendor provided me. On average, it occurs every 25 days and requires a reboot of the server. Older drivers yield more frequent unresponsiveness spells. This happens on all the servers in our Hadoop cluster.(Broadcom Corporation NetXtreme BCM5725 Gigabit Ethernet PCIe (rev 10))--------------------------------------Nov 8 04:32:00 whale12 kernel: WARNING: at net/sched/sch_generic.c:261 dev_watchdog+0x26b/0x280() (Not tainted)Nov 8 04:32:00 whale12 kernel: Hardware name: Altus OCP31Nov 8 04:32:00 whale12 kernel: NETDEV WATCHDOG: eth2 (tg3): transmit queue 0 timed outNov 8 04:32:00 whale12 kernel: Modules linked in: iptable_filter ip_tables tg3(U) ptp pps_core autofs4 cpufreq_ondemand powernow_k8 freq_table mperf ipv6 ext3 jbd uinput microcode sg fam15h_power k10temp amd64_edac_mod edac_core edac_mce_amd i2c_piix4 snd_hda_codec_hdmi snd_hda_intel snd_hda_codec snd_hwdep snd_seq snd_seq_device snd_pcm snd_timer snd soundcore snd_page_alloc ext4 jbd2 mbcache sd_mod crc_t10dif pata_acpi ata_generic pata_atiixp ahci radeon ttm drm_kms_helper drm i2c_algo_bit i2c_core dm_mirror dm_region_hash dm_log dm_mod [last unloaded: pps_core]Nov 8 04:32:00 whale12 kernel: Pid: 0, comm: swapper Not tainted 2.6.32-431.29.2.el6.x86_64 #1Nov 8 04:32:00 whale12 kernel: Call Trace:Nov 8 04:32:00 whale12 kernel: <IRQ> [<ffffffff81071b37>] ? warn_slowpath_common+0x87/0xc0Nov 8 04:32:00 whale12 kernel: [<ffffffff81071c26>] ? warn_slowpath_fmt+0x46/0x50Nov 8 04:32:00 whale12 kernel: [<ffffffff8147c75b>] ? dev_watchdog+0x26b/0x280Nov 8 04:32:00 whale12 kernel: [<ffffffff81094ccd>] ? insert_work+0x6d/0xb0Nov 8 04:32:00 whale12 kernel: [<ffffffff8147c4f0>] ? dev_watchdog+0x0/0x280Nov 8 04:32:00 whale12 kernel: [<ffffffff810847f7>] ? run_timer_softirq+0x197/0x340Nov 8 04:32:00 whale12 kernel: [<ffffffff810ac585>] ? tick_dev_program_event+0x65/0xc0Nov 8 04:32:00 whale12 kernel: [<ffffffff8107a5f1>] ? __do_softirq+0xc1/0x1e0Nov 8 04:32:00 whale12 kernel: [<ffffffff810ac65a>] ? tick_program_event+0x2a/0x30Nov 8 04:32:00 whale12 kernel: [<ffffffff8100c30c>] ? call_softirq+0x1c/0x30Nov 8 04:32:00 whale12 kernel: [<ffffffff8100fa75>] ? do_softirq+0x65/0xa0Nov 8 04:32:00 whale12 kernel: [<ffffffff8107a4a5>] ? irq_exit+0x85/0x90Nov 8 04:32:00 whale12 kernel: [<ffffffff815325ea>] ? smp_apic_timer_interrupt+0x4a/0x60Nov 8 04:32:00 whale12 kernel: [<ffffffff8100bb93>] ? apic_timer_interrupt+0x13/0x20Nov 8 04:32:00 whale12 kernel: <EOI> [<ffffffff81315e64>] ? acpi_idle_enter_simple+0x114/0x14bNov 8 04:32:00 whale12 kernel: [<ffffffff81315e60>] ? acpi_idle_enter_simple+0x110/0x14bNov 8 04:32:00 whale12 kernel: [<ffffffff81427567>] ? cpuidle_idle_call+0xa7/0x140Nov 8 04:32:00 whale12 kernel: [<ffffffff81009fc6>] ? cpu_idle+0xb6/0x110Nov 8 04:32:00 whale12 kernel: [<ffffffff8152226c>] ? start_secondary+0x2ac/0x2efNov 8 04:32:00 whale12 kernel: ---[ end trace 38cc645892010c1a ]---Nov 8 04:32:00 whale12 kernel: tg3 0000:02:00.0: eth2: transmit timed out, resettingNov 8 04:32:00 whale12 kernel: hrtimer: interrupt took 3294565 nsNov 8 04:32:00 whale12 kernel: CE: hpet increasing min_delta_ns to 135758 nsecNov 8 04:32:00 whale12 kernel: CE: hpet increasing min_delta_ns to 203636 nsecNov 8 04:32:01 whale12 kernel: CE: hpet increasing min_delta_ns to 305454 nsecNov 8 04:32:01 whale12 kernel: CE: hpet increasing min_delta_ns to 458180 nsecNov 8 04:32:01 whale12 kernel: CE: hpet increasing min_delta_ns to 687270 nsecNov 8 04:32:01 whale12 kernel: CE: hpet increasing min_delta_ns to 1030904 nsecNov 8 04:32:01 whale12 kernel: CE: hpet increasing min_delta_ns to 1546356 nsecNov 8 04:32:01 whale12 kernel: CE: hpet increasing min_delta_ns to 2319534 nsecNov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000000: 0x164314e4, 0x00100406, 0x02000010, 0x00800010Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000010: 0xd006000c, 0x00000000, 0xd005000c, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000020: 0xd004000c, 0x00000000, 0x00000000, 0x89a2152dNov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000030: 0xff500000, 0x00000048, 0x00000000, 0x0000010bNov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000040: 0x00000000, 0x1f000000, 0xc8035001, 0x16002008Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000050: 0x00005803, 0x00000000, 0x0086a005, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000060: 0x00000000, 0x00000000, 0xf1000298, 0x761b000fNov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000070: 0x00071030, 0xd6000700, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000080: 0x164314e4, 0x800000f8, 0x00000000, 0x00000ffeNov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000090: 0x00000000, 0x00000002, 0x00000000, 0x000003e7Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000000a0: 0x8005ac11, 0x00000004, 0x00000122, 0x00020010Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000000b0: 0x112c8d82, 0x00105400, 0x00475c12, 0x10120043Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000000d0: 0x0008081f, 0x00000000, 0x00000000, 0x00010002Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000000f0: 0x00000000, 0x05762100, 0x00000000, 0x47708810Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000100: 0x13c10001, 0x00000000, 0x00000000, 0x00062030Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000110: 0x00002000, 0x00002000, 0x000000a0, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000130: 0x00000000, 0x00000000, 0x00000000, 0x15010003Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000140: 0x01dbdaae, 0x0000089e, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000150: 0x16010004, 0x00000000, 0x00078116, 0x00000001Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000160: 0x1b010002, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000170: 0x00000000, 0x80000001, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000001b0: 0x23010018, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000200: 0x00000000, 0x1f000000, 0x00000000, 0x32000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000210: 0x00000000, 0x49000000, 0x00000000, 0x8f000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000220: 0x00000000, 0x6a000000, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000260: 0x00000000, 0x00000000, 0x00000000, 0x000003e7Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000280: 0x00000000, 0x00000ffe, 0x00000000, 0x00000df1Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000290: 0x00000000, 0x00000427, 0x00000000, 0x00000109Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000300: 0x00000000, 0x00000002, 0x00000000, 0x00000002Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000310: 0x00000000, 0x00000002, 0x00000000, 0x00000002Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000320: 0x00000000, 0x00000002, 0x00000000, 0x00000002Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000330: 0x00000000, 0x00000002, 0x00000000, 0x00000002Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000340: 0x00000000, 0x00000002, 0x00000000, 0x00000002Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000350: 0x00000000, 0x00000002, 0x00000000, 0x00000002Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000360: 0x00000000, 0x00000002, 0x00000000, 0x00000002Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000370: 0x00000000, 0x00000002, 0x00000000, 0x00000002Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000380: 0x00000000, 0x00000002, 0x00000000, 0x00000002Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000390: 0x00000000, 0x00000002, 0x00000000, 0x00000002Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000003a0: 0x00000000, 0x00000002, 0x00000000, 0x00000002Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000003b0: 0x00000000, 0x00000002, 0x00000000, 0x00000002Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000003c0: 0x00000000, 0x00000002, 0x00000000, 0x00000002Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000003d0: 0x00000000, 0x00000002, 0x00000000, 0x00000002Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000003e0: 0x00000000, 0x00000002, 0x00000000, 0x00000002Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000003f0: 0x00000000, 0x00000002, 0x00000000, 0x00000002Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000400: 0x19e04808, 0x00000000, 0x00001000, 0xfff85c80Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000410: 0x0000089e, 0x01dbdaae, 0x0000089e, 0x01dbdaaeNov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000420: 0x0000089e, 0x01dbdaae, 0x0000089e, 0x01dbdaaeNov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000430: 0x00000000, 0x00000000, 0x00000291, 0x000005f2Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000440: 0x00000000, 0x00000000, 0x00000000, 0x0825c1e1Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000450: 0x00000001, 0x00008000, 0x00000000, 0x00000102Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000460: 0x00000008, 0x00002620, 0x03ff0002, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000470: 0x80000000, 0x00000000, 0x00080000, 0x40000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000480: 0x42000000, 0x7fffffff, 0x06000004, 0x7fffffffNov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000500: 0x00000008, 0x00000002, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000540: 0x0000089e, 0x01dbdaaf, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000590: 0x00900110, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000600: 0xffffffff, 0x00f80011, 0x00000000, 0x0000000cNov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000610: 0xffffffff, 0x00000000, 0x00000004, 0x30000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000620: 0x00000040, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000630: 0x01230123, 0x01230123, 0x01230123, 0x01230123Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000640: 0x01230123, 0x01230123, 0x01230123, 0x01230123Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000650: 0x01230123, 0x01230123, 0x01230123, 0x01230123Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000660: 0x01230123, 0x01230123, 0x01230123, 0x01230123Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000670: 0x5f865437, 0xe4ac62cc, 0x50103a45, 0x36621985Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000680: 0xbf14c0e8, 0x1bc27a1e, 0x84f4b556, 0x094ea6feNov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000690: 0x7dda01e7, 0xc04d7481, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000006c0: 0x00000000, 0x00000000, 0x04000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000800: 0x00000000, 0xffffffff, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000810: 0x00000000, 0xffffffff, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000820: 0x00000000, 0x00000000, 0xffffffff, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000830: 0x00000000, 0xffffffff, 0xffffffff, 0xffffffffNov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000840: 0xffffffff, 0xffffffff, 0xffffffff, 0xffffffffNov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000850: 0xffffffff, 0xffffffff, 0xffffffff, 0xffffffffNov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000860: 0xffffffff, 0xffffffff, 0xffffffff, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000880: 0x00000d34, 0x03811964, 0x00000000, 0x00000014Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000890: 0x00000001, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000008f0: 0x007c0001, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000900: 0x397f06a0, 0xffffffff, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000910: 0x00000000, 0xffffffff, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000920: 0x00000000, 0x00000000, 0xffffffff, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000930: 0x00000000, 0xffffffff, 0xffffffff, 0xffffffffNov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000940: 0xffffffff, 0xffffffff, 0xffffffff, 0xffffffffNov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000950: 0xffffffff, 0xffffffff, 0xffffffff, 0xffffffffNov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000960: 0xffffffff, 0xffffffff, 0xffffffff, 0x9c2cf543Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000970: 0x000052f7, 0x00019ad7, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000980: 0x639d31d0, 0x03811964, 0x00000000, 0x88104959Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000990: 0x001a36c3, 0x00279d76, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000c00: 0x0000000a, 0x00000000, 0x00000003, 0x00000001Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000c10: 0x00000000, 0x00000000, 0x00000000, 0x002a0000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000c80: 0x76ddc2b4, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000ce0: 0x78473602, 0x0000000c, 0x0000002a, 0x00040028Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00000cf0: 0x00000000, 0x50000002, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00001000: 0x00000002, 0x00000000, 0xa0007f7f, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00001010: 0x00020021, 0x00007f7f, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00001400: 0x00000006, 0x00000000, 0x00000000, 0x00000001Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00001440: 0x00000002, 0x00000002, 0x00000002, 0x00000002Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00001450: 0x00000002, 0x00000002, 0x00000002, 0x00000002Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00001460: 0x00000002, 0x00000002, 0x00000002, 0x00000002Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00001470: 0x00000002, 0x00000002, 0x00000002, 0x00000002Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00001800: 0x00000016, 0x00000000, 0x00000002, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00001840: 0x00000000, 0x00000000, 0x00000200, 0x00000010Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00001850: 0x0000001f, 0x00000004, 0x00004010, 0x00020002Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00001860: 0x01000000, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00001c00: 0x00000002, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00002000: 0x00000002, 0x00000010, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00002010: 0x00000181, 0x00000001, 0x007bfffd, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00002100: 0x000c3a25, 0x000d9edb, 0x0000000d, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00002110: 0x000c3a25, 0x000d9edb, 0x0000000d, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00002120: 0x000c3a25, 0x000d9edb, 0x0000000d, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00002130: 0x000c3a25, 0x000d9edb, 0x0000000d, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00002140: 0x000c3a25, 0x000d9edb, 0x0000000d, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00002150: 0x000c3a25, 0x000d9edb, 0x0000000d, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00002160: 0x000c3a25, 0x000d9edb, 0x0000000d, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00002170: 0x000c3a25, 0x000d9edb, 0x0000000d, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00002180: 0x000c3a25, 0x000d9edb, 0x0000000d, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00002190: 0x000c3a25, 0x000d9edb, 0x0000000d, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000021a0: 0x000c3a25, 0x000d9edb, 0x0000000d, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000021b0: 0x000c3a25, 0x000d9edb, 0x0000000d, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000021c0: 0x000c3a25, 0x000d9edb, 0x0000000d, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000021d0: 0x000c3a25, 0x000d9edb, 0x0000000d, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000021e0: 0x000c3a25, 0x000d9edb, 0x0000000d, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000021f0: 0x000c3a25, 0x000d9edb, 0x0000000d, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00002200: 0x8856eaf6, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00002250: 0x001a4a69, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00002400: 0x00010012, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00002440: 0x00000000, 0x00000000, 0x00000002, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00002450: 0x00000004, 0x77350000, 0x08001800, 0x00006000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00002470: 0x00000000, 0x00000330, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000024c0: 0x0201a101, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00002800: 0x00000006, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00002c00: 0x00000006, 0x00000000, 0x00000000, 0x000003a5Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00002c10: 0x00000000, 0x00000000, 0x00000019, 0x0000000cNov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00002c20: 0x00020001, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00002d00: 0x00000080, 0x00000040, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003000: 0x00000006, 0x00000000, 0x00000000, 0x000003a5Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003600: 0x00034000, 0x00130000, 0x00110000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003610: 0x00131100, 0x00000000, 0x00130000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003620: 0x80110011, 0x00000000, 0x00000000, 0x3c822080Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003630: 0x00000000, 0x80008000, 0x80001080, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003640: 0x0000000a, 0x00400000, 0x00000020, 0x00000019Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003650: 0x00000171, 0x00000bff, 0x05762100, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003660: 0x00000000, 0x00000000, 0x000400a3, 0x00000202Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003670: 0x0000002a, 0xfeff7fe3, 0x0000000a, 0x00000080Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000036a0: 0x00000000, 0x00000000, 0x00000000, 0x00000400Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000036b0: 0x00000000, 0x07ff003f, 0x07ff07ff, 0x01000004Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000036c0: 0xffffffff, 0x00000000, 0x00000000, 0x5f0e9297Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000036d0: 0x0000019d, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000036e0: 0x80000b19, 0x80800899, 0x00500899, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000036f0: 0x19090900, 0x13180600, 0x00000301, 0x00000001Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003700: 0x00000000, 0x00000000, 0x00000000, 0x00001388Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003710: 0x87fffffd, 0x00000000, 0x00000000, 0x000010dcNov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003720: 0x00000000, 0x00002040, 0x88006000, 0xa0002000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003750: 0x00000000, 0x00000000, 0x0000080b, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003780: 0x0000b7f9, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003c00: 0x00000306, 0x00000000, 0x00000000, 0x00000048Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003c10: 0x00000000, 0x00000035, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003c20: 0x00000000, 0x00000005, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003c30: 0x00000000, 0x00000000, 0x00000004, 0x78f68000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003c40: 0x00000000, 0x00000b00, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003c50: 0x00000000, 0x00000325, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003c80: 0x00000001, 0x00000df1, 0x0000042a, 0x00000109Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003cc0: 0x00000002, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003cd0: 0x00000000, 0x0000000f, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003d00: 0x00000004, 0x7766a000, 0x00000004, 0x79598000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003d10: 0x00000004, 0x774db000, 0x00000004, 0x78fa2000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003d80: 0x00000014, 0x00000000, 0x00000005, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003d90: 0x00000005, 0x00000000, 0x00000014, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003da0: 0x00000005, 0x00000000, 0x00000005, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003db0: 0x00000014, 0x00000000, 0x00000005, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003dc0: 0x00000005, 0x00000000, 0x00000014, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00003dd0: 0x00000005, 0x00000000, 0x00000005, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004000: 0x00000002, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:02 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004010: 0x00000000, 0x002db012, 0x002ee610, 0x01000422Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004020: 0x00000000, 0x00000010, 0x00000010, 0x00000050Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004030: 0x00000000, 0x01080220, 0x002ee010, 0x0046d002Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004040: 0x00479000, 0x00000000, 0x00000010, 0x0047f062Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004400: 0x00000016, 0x00000000, 0x00010000, 0x0000a000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004410: 0x00000000, 0x0000002a, 0x000000a0, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004420: 0x000000fd, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004440: 0x00000000, 0x00000000, 0x00000000, 0x0f000881Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004450: 0x025e0411, 0x00ee00dd, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004700: 0x00030002, 0x00100000, 0x00100010, 0x90650000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004710: 0x795c1ff0, 0x00065494, 0x00100012, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004720: 0x00000000, 0x00000010, 0xf02c0000, 0x795c0020Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004770: 0x000c0404, 0x00000002, 0x00000010, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004800: 0x380303fe, 0x00000000, 0x00000000, 0x00000120Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004810: 0x00000000, 0x0000000a, 0x04069f78, 0x00002a28Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004820: 0x00000079, 0x00000000, 0xf0330000, 0x771af750Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004840: 0x444b6a56, 0x444b6a56, 0x000e2200, 0x79423cdaNov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004850: 0x80ad761f, 0x877705ea, 0x6d6c6d6c, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004860: 0x00000079, 0x11000000, 0x001ff800, 0x56000008Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004870: 0x05ea0081, 0x003e1820, 0x003e1820, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004890: 0x280c0c04, 0x00305400, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000048a0: 0x000f0010, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004900: 0x18030002, 0x00000003, 0x30000000, 0x00000120Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004910: 0x00000040, 0x00000003, 0x0000df7c, 0x00000018Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004920: 0x00000080, 0x023f8000, 0x78473001, 0x0f000030Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004930: 0x78473201, 0x0f000030, 0x78473601, 0x0f000030Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004940: 0x785b3e01, 0x0f000030, 0xa9a95151, 0x17177878Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004950: 0xf0330000, 0x78473030, 0xaf000000, 0x807f007fNov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004960: 0x00000000, 0x78473230, 0xaf000000, 0x40000002Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004970: 0x00028202, 0x00205400, 0x0000001c, 0x000000ffNov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004980: 0x00000080, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004990: 0x00000000, 0x00000000, 0x78473630, 0xaf000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000049a0: 0x00f000db, 0x00000080, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000049b0: 0x77860e01, 0x4a49ec01, 0x78473401, 0x7a7c7e01Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000049c0: 0x78473002, 0x78473202, 0x78473602, 0x785b3e02Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000049d0: 0x77860e02, 0x4a49ec02, 0x78473402, 0x7a7c7e02Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000049f0: 0xf0330000, 0x785b3e30, 0xaf000000, 0x0000ffffNov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004c00: 0x200003fe, 0x00000020, 0x00000000, 0x0000000aNov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004c10: 0x0000001a, 0x00000001, 0x00000003, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004c20: 0x00000000, 0x00000046, 0x00000046, 0x00000006Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004c30: 0x00000000, 0x003ff800, 0x000000b3, 0x000000b3Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004c40: 0x80090000, 0x0df10000, 0x01090427, 0x0df00000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004c50: 0x0108042a, 0x031f0fff, 0x80000000, 0x08261f1fNov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00004c60: 0x00000046, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005000: 0x00009800, 0x80004000, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005010: 0x00000000, 0x00000000, 0x00000000, 0x08000100Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005020: 0x3c04ff00, 0x00000000, 0x00000000, 0x40000020Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005030: 0x00000000, 0x00000025, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005040: 0x00000000, 0x00000000, 0x08000f38, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005080: 0x00009800, 0x80000000, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005090: 0x00000000, 0x00000000, 0x00000000, 0x08000f38Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000050a0: 0x30420080, 0x00000000, 0x00000000, 0x40000020Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000050b0: 0x00000000, 0x00000025, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000050c0: 0x00000000, 0x00000000, 0x08000300, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005100: 0x00009800, 0x80004000, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005110: 0x00000000, 0x00000000, 0x00000000, 0x08000c48Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005120: 0x30630001, 0x00000000, 0x00000000, 0x40000020Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005130: 0x00000000, 0x00000025, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005140: 0x00000000, 0x00000000, 0x08000d94, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005180: 0x00009800, 0x80004000, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005190: 0x00000000, 0x00000000, 0x00000000, 0x08000facNov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000051a0: 0x30840fff, 0x00000000, 0x00000000, 0x40000020Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000051b0: 0x00000000, 0x00000025, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000051c0: 0x00000000, 0x00000000, 0x08000d94, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005200: 0x14830018, 0x00000b50, 0x20000000, 0x5060001dNov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005210: 0x00000000, 0x00000000, 0x03608821, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005220: 0x00008010, 0x14830018, 0x21120010, 0x08000f3cNov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005230: 0x08000000, 0x08007f80, 0x00000000, 0x3c038000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005240: 0x00000000, 0x03608821, 0x14400016, 0xc0010000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005250: 0x06000000, 0x00000000, 0x00008010, 0x08000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005260: 0x00000000, 0x00000000, 0x03608821, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005270: 0x3c038000, 0xc0000000, 0x08007f80, 0x08007f48Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005280: 0x00009800, 0x80000000, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005290: 0x00000000, 0x00000000, 0x00000000, 0x0800010cNov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000052a0: 0x8f643658, 0x00000000, 0x00000000, 0x40000020Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000052b0: 0x00000000, 0x00000025, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000052c0: 0x00000000, 0x00000000, 0x08001bb2, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005300: 0x00009800, 0x80004000, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005310: 0x00000000, 0x00000000, 0x00000000, 0x08001bdcNov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005320: 0x3c020018, 0x00000000, 0x00000000, 0x40000020Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005330: 0x00000000, 0x00000025, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005340: 0x00000000, 0x00000000, 0x08001408, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005380: 0x00009800, 0x80004000, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005390: 0x00000000, 0x00000000, 0x00000000, 0x080002f8Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000053a0: 0x00621024, 0x00000000, 0x00000000, 0x40000020Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000053b0: 0x00000000, 0x00000025, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000053c0: 0x00000000, 0x00000000, 0x0800115e, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005800: 0x00000000, 0x1f000000, 0x00000000, 0x32000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005810: 0x00000000, 0x49000000, 0x00000000, 0x8f000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005820: 0x00000000, 0x6a000000, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005860: 0x00000000, 0x00000000, 0x00000000, 0x000003e7Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005880: 0x00000000, 0x00000ffe, 0x00000000, 0x00000df1Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005890: 0x00000000, 0x00000427, 0x00000000, 0x00000109Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005900: 0x00000000, 0x00000002, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005980: 0x00000002, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00005a00: 0x000f601f, 0x00000000, 0x00010000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00006000: 0x20010082, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00006400: 0x00000000, 0x00000000, 0x00010791, 0xc0000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00006410: 0x05000016, 0x05000016, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00006430: 0x00000000, 0x14e41643, 0x89a2152d, 0x10020000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00006440: 0x0000304f, 0x000002e4, 0x00000000, 0x00000040Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000064c0: 0x00000005, 0x00000004, 0x00000122, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000064d0: 0x00000040, 0x10008d82, 0x00000000, 0x00d75e12Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000064e0: 0x00000031, 0x0008001f, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000064f0: 0x00000002, 0x00000031, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00006500: 0x03e10003, 0x01dbdaae, 0x0000089e, 0x00000003Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00006510: 0x00078116, 0x0005810b, 0x00046105, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00006530: 0x00000001, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00006540: 0x0028081f, 0x0001001e, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00006550: 0x00000001, 0x02800000, 0x0000000f, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00006560: 0x0000000f, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000065f0: 0x00000000, 0x00000059, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00006800: 0x14130034, 0x20081082, 0x000fff18, 0x47392bd1Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00006810: 0x21120010, 0xffffffff, 0x00000000, 0x00000040Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00006880: 0x77fff020, 0x00000040, 0x00801643, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00006890: 0x00800000, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000068a0: 0x00000000, 0x00010001, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000068b0: 0x00040000, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000068c0: 0x00000044, 0x00000000, 0x00000000, 0x00000000Nov 8 04:32:03 whale12 kernel: tg3 0000:02:00.0: eth2: 0x000068e0: 0x00000000, 0x00000000, 0x00000000, 0x000033ccNov 9 03:07:04 whale12 kernel: tg3 0000:02:00.0: eth2: 0x00007510: 0x00000000, 0xefdff7df, 0x00000000, 0x00000000Nov 9 03:07:04 whale12 kernel: tg3 0000:02:00.0: eth2: 0: Host status block [00000000:00000000:(0000:0000:0000):(0000:0000)]Nov 9 03:07:04 whale12 kernel: tg3 0000:02:00.0: eth2: 0: NAPI info [00000000:00000000:(01ec:0000:01ff):0000:(00c8:0000:0000:0000)]Nov 9 03:07:04 whale12 kernel: tg3 0000:02:00.0: eth2: 1: Host status block [00000000:00000000:(0000:0000:0000):(0000:0000)]Nov 9 03:07:04 whale12 kernel: tg3 0000:02:00.0: eth2: 1: NAPI info [00000000:00000000:(0000:0000:01ff):0000:(0000:0000:0000:0000)]Nov 9 03:07:04 whale12 kernel: tg3 0000:02:00.0: eth2: 2: Host status block [00000000:00000000:(0000:0000:0000):(0000:0000)]Nov 9 03:07:04 whale12 kernel: tg3 0000:02:00.0: eth2: 2: NAPI info [00000000:00000000:(0000:0000:01ff):0000:(0000:0000:0000:0000)]Nov 9 03:07:04 whale12 kernel: tg3 0000:02:00.0: eth2: 3: Host status block [00000000:00000000:(0000:0000:0000):(0000:0000)]Nov 9 03:07:04 whale12 kernel: tg3 0000:02:00.0: eth2: 3: NAPI info [00000000:00000000:(0000:0000:01ff):0000:(0000:0000:0000:0000)]Nov 9 03:07:04 whale12 kernel: tg3 0000:02:00.0: eth2: 4: Host status block [00000000:00000000:(0000:0000:0000):(0000:0000)]Nov 9 03:07:04 whale12 kernel: tg3 0000:02:00.0: eth2: 4: NAPI info [00000000:00000000:(0000:0000:01ff):0000:(0000:0000:0000:0000)]Nov 9 03:07:04 whale12 kernel: tg3 0000:02:00.0: tg3_stop_block timed out, ofs=4c00 enable_bit=2Nov 9 03:07:04 whale12 kernel: tg3 0000:02:00.0: eth2: Link is downNov 9 03:07:07 whale12 kernel: tg3 0000:02:00.0: eth2: Link is up at 1000 Mbps, full duplexNov 9 03:07:07 whale12 kernel: tg3 0000:02:00.0: eth2: Flow control is off for TX and off for RXNov 9 03:07:07 whale12 kernel: tg3 0000:02:00.0: eth2: EEE is disabledI have a similar issue. I do not know if it is the same, but some pecularities of my errors messages are:[28499.505795] tg3 0000:09:00.0 eth0: 0: NAPI info [00000084:00000084:(01be:01ba:01ff):0035:(00fd:0000:0000:0000)][28499.609888] tg3 0000:09:00.0: tg3_stop_block timed out, ofs=1400 enable_bit=2[28499.713455] tg3 0000:09:00.0: tg3_stop_block timed out, ofs=c00 enable_bit=2[28499.734396] tg3 0000:09:00.0 eth0: Link is down[28502.109842] tg3 0000:09:00.0 eth0: Link is up at 100 Mbps, full duplex[28502.109859] tg3 0000:09:00.0 eth0: Flow control is on for TX and on for RX[28507.776511] tg3 0000:09:00.0 eth0: transmit timed out, resetting[28509.489027] CE: Reprogramming failure. Giving up(I do not see reprogramming failures in this thread)The backtrace:Sep 8 18:14:12 Fugl kernel: [27407.627909] ------------[ cut here ]------------Sep 8 18:14:12 Fugl kernel: [27407.627929] WARNING: CPU: 4 PID: 0 at /home/kernel/COD/linux/net/sched/sch_generic.c:303 dev_watchdog+0x203/0x210()Sep 8 18:14:12 Fugl kernel: [27407.627936] NETDEV WATCHDOG: eth0 (tg3): transmit queue 0 timed outSep 8 18:14:12 Fugl kernel: [27407.627939] Modules linked in: ppp_mppe ppp_async crc_ccitt pci_stub vboxpci(OE) vboxnetadp(OE) vboxnetflt(OE) vboxdrv(OE) rfcomm bnep dm_crypt arc4 iwldvm uvcvideo mac80211 videobuf2_vmalloc videobuf2_memops videobuf2_core v4l2_common videodev media btusb btrtl btbcm btintel bluetooth iwlwifi snd_hda_codec_hdmi acer_wmi snd_hda_codec_realtek sparse_keymap snd_hda_codec_generic nfsd snd_hda_intel snd_seq_midi snd_hda_codec cfg80211 snd_hda_core auth_rpcgss coretemp snd_seq_midi_event snd_rawmidi snd_hwdep nfs_acl snd_seq i7core_edac nfs kvm_intel snd_pcm snd_seq_device kvm snd_timer shpchp pcspkr joydev snd lpc_ich soundcore lockd serio_raw grace intel_ips edac_core sunrpc mac_hid fscache binfmt_misc parport_pc ppdev lp parport btrfs xor raid6_pq nouveau i2c_algo_bit tg3 ttm drm_kms_helper hid_generic ahci ptp libahci usbhid mxm_wmi psmouse hid drm pps_core wmi videoSep 8 18:14:12 Fugl kernel: [27407.628090] CPU: 4 PID: 0 Comm: swapper/4 Tainted: G OE 4.2.0-040200rc1-generic #201507051635Sep 8 18:14:12 Fugl kernel: [27407.628096] Hardware name: Acer Aspire 8940G /SM80-CP , BIOS V1.3117 04/25/2011Sep 8 18:14:12 Fugl kernel: [27407.628101] 00000000 00000000 ef779ec0 c170b1b2 ef779f00 ef779ef0 c1064a87 c19d4244Sep 8 18:14:12 Fugl kernel: [27407.628114] ef779f1c 00000000 c19d4280 0000012f c163b193 c163b193 00000000 f5d70000Sep 8 18:14:12 Fugl kernel: [27407.628127] fffffd29 ef779f08 c1064af3 00000009 ef779f00 c19d4244 ef779f1c ef779f44Sep 8 18:14:12 Fugl kernel: [27407.628140] Call Trace:Sep 8 18:14:12 Fugl kernel: [27407.628154] [<c170b1b2>] dump_stack+0x41/0x52Sep 8 18:14:12 Fugl kernel: [27407.628163] [<c1064a87>] warn_slowpath_common+0x87/0xc0Sep 8 18:14:12 Fugl kernel: [27407.628172] [<c163b193>] ? dev_watchdog+0x203/0x210Sep 8 18:14:12 Fugl kernel: [27407.628179] [<c163b193>] ? dev_watchdog+0x203/0x210Sep 8 18:14:12 Fugl kernel: [27407.628186] [<c1064af3>] warn_slowpath_fmt+0x33/0x40Sep 8 18:14:12 Fugl kernel: [27407.628194] [<c163b193>] dev_watchdog+0x203/0x210Sep 8 18:14:12 Fugl kernel: [27407.628206] [<c10c3510>] call_timer_fn+0x30/0xf0Sep 8 18:14:12 Fugl kernel: [27407.628217] [<c1099340>] ? rebalance_domains+0x150/0x260Sep 8 18:14:12 Fugl kernel: [27407.628226] [<c163af90>] ? dev_deactivate_queue.constprop.39+0x50/0x50Sep 8 18:14:12 Fugl kernel: [27407.628234] [<c10c4a29>] run_timer_softirq+0x189/0x230Sep 8 18:14:12 Fugl kernel: [27407.628243] [<c163af90>] ? dev_deactivate_queue.constprop.39+0x50/0x50Sep 8 18:14:12 Fugl kernel: [27407.628252] [<c1068723>] __do_softirq+0xb3/0x220Sep 8 18:14:12 Fugl kernel: [27407.628261] [<c1068670>] ? cpu_callback+0x160/0x160Sep 8 18:14:12 Fugl kernel: [27407.628273] [<c10132e2>] do_softirq_own_stack+0x22/0x30Sep 8 18:14:12 Fugl kernel: [27407.628277] <IRQ> [<c1068ab5>] irq_exit+0x95/0xa0Sep 8 18:14:12 Fugl kernel: [27407.628289] [<c1712bf5>] do_IRQ+0x45/0xd0Sep 8 18:14:12 Fugl kernel: [27407.628299] [<c1712073>] common_interrupt+0x33/0x38Sep 8 18:14:12 Fugl kernel: [27407.628310] [<c15c82d1>] ? cpuidle_enter_state+0xb1/0x290Sep 8 18:14:12 Fugl kernel: [27407.628319] [<c15c84e4>] cpuidle_enter+0x14/0x20Sep 8 18:14:12 Fugl kernel: [27407.628327] [<c109ec13>] call_cpuidle+0x33/0x70Sep 8 18:14:12 Fugl kernel: [27407.628335] [<c109ee86>] cpu_startup_entry+0x236/0x2f0Sep 8 18:14:12 Fugl kernel: [27407.628347] [<c1044ad9>] start_secondary+0x169/0x1c0Sep 8 18:14:12 Fugl kernel: [27407.628355] ---[ end trace 8739ccc4b339bf30 ]---Sep 8 18:14:12 Fugl kernel: [27407.628366] tg3 0000:09:00.0 eth0: transmit timed out, resettingSep 8 18:14:13 Fugl kernel: [27408.124476] hrtimer: interrupt took 4367866 nsI have this issue in my SO Centos 7 kernel 3.10[2041786.303995] ------------[ cut here ]------------[2041786.304013] WARNING: at net/sched/sch_generic.c:297 dev_watchdog+0x270/0x280()[2041786.304016] NETDEV WATCHDOG: eno1 (tg3): transmit queue 0 timed out[2041786.304018] Modules linked in: fuse btrfs zlib_deflate raid6_pq xor vfat msdos fat ext4 mbcache jbd2 binfmt_misc ip6t_rpfilter ip6t_REJECT ipt_REJECT xt_conntrack ebtable_nat ebtable_broute bridge stp llc ebtable_filter ebtables ip6table_nat nf_conntrack_ipv6 nf_defrag_ipv6 nf_nat_ipv6 ip6table_mangle ip6table_security ip6table_raw ip6table_filter ip6_tables iptable_nat nf_conntrack_ipv4 nf_defrag_ipv4 nf_nat_ipv4 nf_nat nf_conntrack iptable_mangle iptable_security iptable_raw iptable_filter intel_powerclamp coretemp kvm_intel kvm crc32_pclmul ghash_clmulni_intel aesni_intel lrw gf128mul glue_helper ablk_helper ipmi_ssif cryptd sb_edac iTCO_wdt sr_mod cdrom edac_core hpwdt iTCO_vendor_support wmi usb_storage hpilo ipmi_si pcspkr ipmi_msghandler acpi_power_meter sg lpc_ich mfd_core shpchp ioatdma[2041786.304095] dca pcc_cpufreq ip_tables xfs libcrc32c ata_generic pata_acpi sd_mod crc_t10dif crct10dif_generic syscopyarea sysfillrect sysimgblt i2c_algo_bit drm_kms_helper ttm drm i2c_core crct10dif_pclmul crct10dif_common crc32c_intel serio_raw ata_piix libata tg3 ptp hpsa pps_core dm_mirror dm_region_hash dm_log dm_mod[2041786.304129] CPU: 0 PID: 0 Comm: swapper/0 Not tainted 3.10.0-327.18.2.el7.x86_64 #1[2041786.304132] Hardware name: HP ProLiant DL360p Gen8, BIOS P71 07/01/2015[2041786.304135] ffff880627a03d88 11d300e54b2f2116 ffff880627a03d40 ffffffff81635a0c[2041786.304143] ffff880627a03d78 ffffffff8107b200 0000000000000000 ffff88061d6ac000[2041786.304149] ffff88061d7c7580 0000000000000005 0000000000000000 ffff880627a03de0[2041786.304155] Call Trace:[2041786.304158] <IRQ> [<ffffffff81635a0c>] dump_stack+0x19/0x1b[2041786.304175] [<ffffffff8107b200>] warn_slowpath_common+0x70/0xb0[2041786.304179] [<ffffffff8107b29c>] warn_slowpath_fmt+0x5c/0x80[2041786.304189] [<ffffffff8154d030>] dev_watchdog+0x270/0x280[2041786.304194] [<ffffffff8154cdc0>] ? dev_graft_qdisc+0x80/0x80[2041786.304202] [<ffffffff8108b0a6>] call_timer_fn+0x36/0x110[2041786.304207] [<ffffffff8154cdc0>] ? dev_graft_qdisc+0x80/0x80[2041786.304213] [<ffffffff8108dd97>] run_timer_softirq+0x237/0x340[2041786.304218] [<ffffffff81084b0f>] __do_softirq+0xef/0x280[2041786.304223] [<ffffffff81647adc>] call_softirq+0x1c/0x30[2041786.304233] [<ffffffff81016fc5>] do_softirq+0x65/0xa0[2041786.304238] [<ffffffff81084ea5>] irq_exit+0x115/0x120[2041786.304244] [<ffffffff81648755>] smp_apic_timer_interrupt+0x45/0x60[2041786.304251] [<ffffffff81646e1d>] apic_timer_interrupt+0x6d/0x80[2041786.304253] <EOI> [<ffffffff814d49e2>] ? cpuidle_enter_state+0x52/0xc0[2041786.304267] [<ffffffff814d49d8>] ? cpuidle_enter_state+0x48/0xc0[2041786.304273] [<ffffffff814d4b29>] cpuidle_idle_call+0xd9/0x210[2041786.304280] [<ffffffff8101e4be>] arch_cpu_idle+0xe/0x30[2041786.304287] [<ffffffff810d6445>] cpu_startup_entry+0x245/0x290[2041786.304295] [<ffffffff81625677>] rest_init+0x77/0x80[2041786.304304] [<ffffffff81a8d057>] start_kernel+0x429/0x44a[2041786.304310] [<ffffffff81a8ca37>] ? repair_env_string+0x5c/0x5c[2041786.304316] [<ffffffff81a8c120>] ? early_idt_handlers+0x120/0x120[2041786.304322] [<ffffffff81a8c5ee>] x86_64_start_reservations+0x2a/0x2c[2041786.304327] [<ffffffff81a8c742>] x86_64_start_kernel+0x152/0x175[2041786.304330] ---[ end trace 5fafdeb818cf662c ]---[2041786.304336] tg3 0000:03:00.0 eno1: transmit timed out, resetting[2041787.563458] tg3 0000:03:00.0 eno1: 0x00000000: 0x165714e4, 0x00100446, 0x02000001, 0x00800010[2041787.563481] tg3 0000:03:00.0 eno1: 0x00000010: 0xf6bf000c, 0x00000000, 0xf6be000c, 0x00000000[2041787.563503] tg3 0000:03:00.0 eno1: 0x00000020: 0xf6bd000c, 0x00000000, 0x00000000, 0x169d103c[2041787.563523] tg3 0000:03:00.0 eno1: 0x00000030: 0x00000000, 0x00000048, 0x00000000, 0x00000105[2041787.563544] tg3 0000:03:00.0 eno1: 0x00000040: 0x00000000, 0x6e000000, 0xc8035001, 0x64002008[2041787.563567] tg3 0000:03:00.0 eno1: 0x00000050: 0x00005803, 0x00000000, 0x0086a005, 0x00000000[2041787.563586] tg3 0000:03:00.0 eno1: 0x00000060: 0x00000000, 0x00000000, 0xf0010298, 0x00380081[2041787.563608] tg3 0000:03:00.0 eno1: 0x00000070: 0x000710b0, 0xb0400600, 0x00000000, 0x00000000[2041787.563632] tg3 0000:03:00.0 eno1: 0x00000080: 0x165714e4, 0xc00000d0, 0x00000000, 0x0000071f[2041787.563653] tg3 0000:03:00.0 eno1: 0x00000090: 0x00000000, 0x00000000, 0x00000000, 0x000000ab[2041787.564021] tg3 0000:03:00.0 eno1: 0x000000a0: 0x8010ac11, 0x00000004, 0x00001004, 0x00020010[2041787.564388] tg3 0000:03:00.0 eno1: 0x000000b0: 0x10008d81, 0x00105426, 0x0004cc42, 0x10420040[2041787.564756] tg3 0000:03:00.0 eno1: 0x000000d0: 0x0000001f, 0x00000000, 0x00000000, 0x00000001[2041787.565121] tg3 0000:03:00.0 eno1: 0x000000f0: 0x00000000, 0x05719001, 0x00000000, 0x96002600[2041787.565488] tg3 0000:03:00.0 eno1: 0x00000100: 0x13c10001, 0x00100000, 0x00100000, 0x00000020[2041787.565854] tg3 0000:03:00.0 eno1: 0x00000110: 0x00002000, 0x00000000, 0x000000a0, 0x04000001[2041787.566215] tg3 0000:03:00.0 eno1: 0x00000120: 0x0010000f, 0x03070000, 0x00000000, 0x00000000[2041787.566580] tg3 0000:03:00.0 eno1: 0x00000130: 0x00000000, 0x00000000, 0x00000000, 0x15010003[2041787.566944] tg3 0000:03:00.0 eno1: 0x00000140: 0xf020c180, 0x000040a8, 0x00000000, 0x00000000[2041787.567307] tg3 0000:03:00.0 eno1: 0x00000150: 0x16010004, 0x00000000, 0x0007812c, 0x00000001[2041787.567677] tg3 0000:03:00.0 eno1: 0x00000160: 0x00010002, 0x00000000, 0x00000000, 0x00000000[2041787.568040] tg3 0000:03:00.0 eno1: 0x00000170: 0x00000000, 0x800000ff, 0x00000000, 0x00000000[2041787.568406] tg3 0000:03:00.0 eno1: 0x00000200: 0x00000000, 0x6e000000, 0x00000000, 0x29000000[2041787.568783] tg3 0000:03:00.0 eno1: 0x00000210: 0x00000000, 0xeb000000, 0x00000000, 0x03000000[2041787.569148] tg3 0000:03:00.0 eno1: 0x00000220: 0x00000000, 0xd4000000, 0x00000000, 0x00000000[2041787.569516] tg3 0000:03:00.0 eno1: 0x00000260: 0x00000000, 0x00000000, 0x00000000, 0x000000ab[2041787.569883] tg3 0000:03:00.0 eno1: 0x00000280: 0x00000000, 0x0000071f, 0x00000000, 0x00000eca[2041787.570246] tg3 0000:03:00.0 eno1: 0x00000290: 0x00000000, 0x00000ba0, 0x00000000, 0x00000e5a[2041787.570612] tg3 0000:03:00.0 eno1: 0x00000300: 0x00000000, 0x00000122, 0x00000000, 0x00000000[2041787.570979] tg3 0000:03:00.0 eno1: 0x00000400: 0x18e04806, 0x02400000, 0x00001000, 0x00000900[2041787.571345] tg3 0000:03:00.0 eno1: 0x00000410: 0x000040a8, 0xf020c180, 0x000040a8, 0xf020c180[2041787.571713] tg3 0000:03:00.0 eno1: 0x00000420: 0x000040a8, 0xf020c180, 0x000040a8, 0xf020c180[2041787.572078] tg3 0000:03:00.0 eno1: 0x00000430: 0x00000400, 0x00000000, 0x000001f7, 0x000005f2[2041787.572444] tg3 0000:03:00.0 eno1: 0x00000440: 0x00000000, 0x00000000, 0x00000000, 0x082a0000[2041787.572811] tg3 0000:03:00.0 eno1: 0x00000450: 0x00000001, 0x00008000, 0x00000000, 0x00000102:[2041787.573187] tg3 0000:03:00.0 eno1: 0x00000460: 0x00000018, 0x00002620, 0x01ff0002, 0x00000000[2041787.573550] tg3 0000:03:00.0 eno1: 0x00000470: 0x80000000, 0x00800000, 0x00000000, 0x40000000[2041787.573919] tg3 0000:03:00.0 eno1: 0x00000480: 0x42000000, 0x7fffffff, 0x06000004, 0x7fffffff[2041787.574285] tg3 0000:03:00.0 eno1: 0x00000500: 0x00000008, 0x00000002, 0x00000000, 0x00000000[2041787.574653] tg3 0000:03:00.0 eno1: 0x00000540: 0x0000c434, 0x6bbc0e91, 0x00000000, 0x00000000[2041787.575019] tg3 0000:03:00.0 eno1: 0x00000590: 0x00e00000, 0x00000000, 0x00000000, 0x00000000[2041787.575385] tg3 0000:03:00.0 eno1: 0x000005b0: 0x00000000, 0xc0000000, 0x00000000, 0x00000000[2041787.575753] tg3 0000:03:00.0 eno1: 0x000005c0: 0xe247f120, 0xdd20104a, 0x00000000, 0x00000000[2041787.576118] tg3 0000:03:00.0 eno1: 0x00000600: 0xffffffff, 0x00f800d1, 0x00000000, 0x00001f04[2041787.576482] tg3 0000:03:00.0 eno1: 0x00000610: 0xffffffff, 0x00000000, 0x07c00244, 0x00000000[2041787.576851] tg3 0000:03:00.0 eno1: 0x00000620: 0x00000040, 0x00000000, 0x00000000, 0x00000000[2041787.577213] tg3 0000:03:00.0 eno1: 0x00000630: 0x01230123, 0x01230123, 0x01230123, 0x01230123[2041787.577581] tg3 0000:03:00.0 eno1: 0x00000640: 0x01230123, 0x01230123, 0x01230123, 0x01230123[2041787.577949] tg3 0000:03:00.0 eno1: 0x00000650: 0x01230123, 0x01230123, 0x01230123, 0x01230123[2041787.578313] tg3 0000:03:00.0 eno1: 0x00000660: 0x01230123, 0x01230123, 0x01230123, 0x01230123[2041787.578683] tg3 0000:03:00.0 eno1: 0x00000670: 0xfeb8bed8, 0x47d7204f, 0x6a3e4143, 0x7ffb4c55[2041787.579045] tg3 0000:03:00.0 eno1: 0x00000680: 0x383e53bc, 0x9ccc584d, 0xc0c6d64a, 0x38c28137[2041787.579411] tg3 0000:03:00.0 eno1: 0x00000690: 0x543d36ea, 0x490674f4, 0x00000000, 0x00000000[2041787.579779] tg3 0000:03:00.0 eno1: 0x000006c0: 0x00000000, 0x00000000, 0x04000000, 0x00000000[2041787.580143] tg3 0000:03:00.0 eno1: 0x00000800: 0x00000000, 0xffffffff, 0x00000000, 0x00000000[2041787.580506] tg3 0000:03:00.0 eno1: 0x00000810: 0x00000000, 0xffffffff, 0x00000000, 0x00000000[2041787.580873] tg3 0000:03:00.0 eno1: 0x00000820: 0x00000000, 0x00000000, 0xffffffff, 0x00000000[2041787.581234] tg3 0000:03:00.0 eno1: 0x00000830: 0x00000000, 0xffffffff, 0xffffffff, 0xffffffff[2041787.581599] tg3 0000:03:00.0 eno1: 0x00000840: 0xffffffff, 0xffffffff, 0xffffffff, 0xffffffff[2041787.581969] tg3 0000:03:00.0 eno1: 0x00000850: 0xffffffff, 0xffffffff, 0xffffffff, 0xffffffff[2041787.582332] tg3 0000:03:00.0 eno1: 0x00000860: 0xffffffff, 0xffffffff, 0xffffffff, 0x00000000[2041787.582700] tg3 0000:03:00.0 eno1: 0x00000880: 0x000001e2, 0x0007b78a, 0x00000000, 0x00000005[2041787.583066] tg3 0000:03:00.0 eno1: 0x000008f0: 0x00000001, 0x00000000, 0x00000000, 0x00000000[2041787.583432] tg3 0000:03:00.0 eno1: 0x00000900: 0x00000000, 0xffffffff, 0x00000000, 0x00000000[2041787.583798] tg3 0000:03:00.0 eno1: 0x00000910: 0x00000000, 0xffffffff, 0x00000000, 0x00000000[2041787.584164] tg3 0000:03:00.0 eno1: 0x00000920: 0x00000000, 0x000134f0, 0xffffffff, 0x00000000[2041787.584528] tg3 0000:03:00.0 eno1: 0x00000930: 0x00000000, 0xffffffff, 0xffffffff, 0xffffffff[2041787.584895] tg3 0000:03:00.0 eno1: 0x00000940: 0xffffffff, 0xffffffff, 0xffffffff, 0xffffffff[2041787.585261] tg3 0000:03:00.0 eno1: 0x00000950: 0xffffffff, 0xffffffff, 0xffffffff, 0xffffffff[2041787.585626] tg3 0000:03:00.0 eno1: 0x00000960: 0xffffffff, 0xffffffff, 0xffffffff, 0x00000000[2041787.585994] tg3 0000:03:00.0 eno1: 0x00000980: 0x00001146, 0x0007b78a, 0x00000000, 0x0000002f[2041787.586360] tg3 0000:03:00.0 eno1: 0x00000990: 0x00000002, 0x00000000, 0x00000000, 0x00000000[2041787.586725] tg3 0000:03:00.0 eno1: 0x00000c00: 0x0000000a, 0x00000000, 0x00000003, 0x00000001[2041787.587093] tg3 0000:03:00.0 eno1: 0x00000c10: 0x00000000, 0x00000007, 0x00000000, 0x00560000[2041787.587460] tg3 0000:03:00.0 eno1: 0x00000c80: 0x0262c6c1, 0x00000000, 0x00000000, 0x00000000:[2041787.573187] tg3 0000:03:00.0 eno1: 0x00000460: 0x00000018, 0x00002620, 0x01ff0002, 0x00000000[2041787.573550] tg3 0000:03:00.0 eno1: 0x00000470: 0x80000000, 0x00800000, 0x00000000, 0x40000000[2041787.573919] tg3 0000:03:00.0 eno1: 0x00000480: 0x42000000, 0x7fffffff, 0x06000004, 0x7fffffff[2041787.574285] tg3 0000:03:00.0 eno1: 0x00000500: 0x00000008, 0x00000002, 0x00000000, 0x00000000[2041787.574653] tg3 0000:03:00.0 eno1: 0x00000540: 0x0000c434, 0x6bbc0e91, 0x00000000, 0x00000000[2041787.575019] tg3 0000:03:00.0 eno1: 0x00000590: 0x00e00000, 0x00000000, 0x00000000, 0x00000000[2041787.575385] tg3 0000:03:00.0 eno1: 0x000005b0: 0x00000000, 0xc0000000, 0x00000000, 0x00000000[2041787.575753] tg3 0000:03:00.0 eno1: 0x000005c0: 0xe247f120, 0xdd20104a, 0x00000000, 0x00000000[2041787.576118] tg3 0000:03:00.0 eno1: 0x00000600: 0xffffffff, 0x00f800d1, 0x00000000, 0x00001f04[2041787.576482] tg3 0000:03:00.0 eno1: 0x00000610: 0xffffffff, 0x00000000, 0x07c00244, 0x00000000[2041787.576851] tg3 0000:03:00.0 eno1: 0x00000620: 0x00000040, 0x00000000, 0x00000000, 0x00000000[2041787.577213] tg3 0000:03:00.0 eno1: 0x00000630: 0x01230123, 0x01230123, 0x01230123, 0x01230123[2041787.577581] tg3 0000:03:00.0 eno1: 0x00000640: 0x01230123, 0x01230123, 0x01230123, 0x01230123[2041787.577949] tg3 0000:03:00.0 eno1: 0x00000650: 0x01230123, 0x01230123, 0x01230123, 0x01230123[2041787.578313] tg3 0000:03:00.0 eno1: 0x00000660: 0x01230123, 0x01230123, 0x01230123, 0x01230123[2041787.578683] tg3 0000:03:00.0 eno1: 0x00000670: 0xfeb8bed8, 0x47d7204f, 0x6a3e4143, 0x7ffb4c55[2041787.579045] tg3 0000:03:00.0 eno1: 0x00000680: 0x383e53bc, 0x9ccc584d, 0xc0c6d64a, 0x38c28137[2041787.579411] tg3 0000:03:00.0 eno1: 0x00000690: 0x543d36ea, 0x490674f4, 0x00000000, 0x00000000[2041787.579779] tg3 0000:03:00.0 eno1: 0x000006c0: 0x00000000, 0x00000000, 0x04000000, 0x00000000[2041787.580143] tg3 0000:03:00.0 eno1: 0x00000800: 0x00000000, 0xffffffff, 0x00000000, 0x00000000[2041787.580506] tg3 0000:03:00.0 eno1: 0x00000810: 0x00000000, 0xffffffff, 0x00000000, 0x00000000[2041787.580873] tg3 0000:03:00.0 eno1: 0x00000820: 0x00000000, 0x00000000, 0xffffffff, 0x00000000[2041787.581234] tg3 0000:03:00.0 eno1: 0x00000830: 0x00000000, 0xffffffff, 0xffffffff, 0xffffffff[2041787.581599] tg3 0000:03:00.0 eno1: 0x00000840: 0xffffffff, 0xffffffff, 0xffffffff, 0xffffffff[2041787.581969] tg3 0000:03:00.0 eno1: 0x00000850: 0xffffffff, 0xffffffff, 0xffffffff, 0xffffffff[2041787.582332] tg3 0000:03:00.0 eno1: 0x00000860: 0xffffffff, 0xffffffff, 0xffffffff, 0x00000000[2041787.582700] tg3 0000:03:00.0 eno1: 0x00000880: 0x000001e2, 0x0007b78a, 0x00000000, 0x00000005[2041787.583066] tg3 0000:03:00.0 eno1: 0x000008f0: 0x00000001, 0x00000000, 0x00000000, 0x00000000[2041787.583432] tg3 0000:03:00.0 eno1: 0x00000900: 0x00000000, 0xffffffff, 0x00000000, 0x00000000[2041787.583798] tg3 0000:03:00.0 eno1: 0x00000910: 0x00000000, 0xffffffff, 0x00000000, 0x00000000[2041787.584164] tg3 0000:03:00.0 eno1: 0x00000920: 0x00000000, 0x000134f0, 0xffffffff, 0x00000000[2041787.584528] tg3 0000:03:00.0 eno1: 0x00000930: 0x00000000, 0xffffffff, 0xffffffff, 0xffffffff[2041787.584895] tg3 0000:03:00.0 eno1: 0x00000940: 0xffffffff, 0xffffffff, 0xffffffff, 0xffffffff[2041787.585261] tg3 0000:03:00.0 eno1: 0x00000950: 0xffffffff, 0xffffffff, 0xffffffff, 0xffffffff[2041787.585626] tg3 0000:03:00.0 eno1: 0x00000960: 0xffffffff, 0xffffffff, 0xffffffff, 0x00000000[2041787.585994] tg3 0000:03:00.0 eno1: 0x00000980: 0x00001146, 0x0007b78a, 0x00000000, 0x0000002f[2041787.586360] tg3 0000:03:00.0 eno1: 0x00000990: 0x00000002, 0x00000000, 0x00000000, 0x00000000[2041787.586725] tg3 0000:03:00.0 eno1: 0x00000c00: 0x0000000a, 0x00000000, 0x00000003, 0x00000001[2041787.587093] tg3 0000:03:00.0 eno1: 0x00000c10: 0x00000000, 0x00000007, 0x00000000, 0x00560000[2041787.587460] tg3 0000:03:00.0 eno1: 0x00000c80: 0x0262c6c1, 0x00000000, 0x00000000, 0x00000000:[2041787.606603] tg3 0000:03:00.0 eno1: 0x00002500: 0x00000000, 0x00000000, 0x00000002, 0x00044800[2041787.606969] tg3 0000:03:00.0 eno1: 0x00002510: 0x00000000, 0x00000000, 0x00000002, 0x00040400[2041787.607334] tg3 0000:03:00.0 eno1: 0x00002520: 0x00000000, 0x00000000, 0x00000002, 0x00044c00[2041787.607702] tg3 0000:03:00.0 eno1: 0x00002530: 0x00000000, 0x00000000, 0x00000002, 0x00040800[2041787.608065] tg3 0000:03:00.0 eno1: 0x00002540: 0x00000000, 0x00000000, 0x00000002, 0x00045000[2041787.608425] tg3 0000:03:00.0 eno1: 0x00002550: 0x00000000, 0x00000000, 0x00000002, 0x00040c00[2041787.608788] tg3 0000:03:00.0 eno1: 0x00002560: 0x00000000, 0x00000000, 0x00000002, 0x00045400[2041787.609151] tg3 0000:03:00.0 eno1: 0x00002570: 0x00000000, 0x00000000, 0x00000002, 0x00041000[2041787.609514] tg3 0000:03:00.0 eno1: 0x00002580: 0x00000000, 0x00000000, 0x00000002, 0x00045800[2041787.609881] tg3 0000:03:00.0 eno1: 0x00002590: 0x00000000, 0x00000000, 0x00000002, 0x00041400[2041787.610247] tg3 0000:03:00.0 eno1: 0x000025a0: 0x00000000, 0x00000000, 0x00000002, 0x00045c00[2041787.610611] tg3 0000:03:00.0 eno1: 0x000025b0: 0x00000000, 0x00000000, 0x00000002, 0x00041800[2041787.610980] tg3 0000:03:00.0 eno1: 0x000025c0: 0x00000000, 0x00000000, 0x00000002, 0x00046000[2041787.611346] tg3 0000:03:00.0 eno1: 0x000025d0: 0x00000000, 0x00000000, 0x00000002, 0x00041c00[2041787.611712] tg3 0000:03:00.0 eno1: 0x000025e0: 0x00000000, 0x00000000, 0x00000002, 0x00046400[2041787.612079] tg3 0000:03:00.0 eno1: 0x000025f0: 0x00000000, 0x00000000, 0x00000002, 0x00042000[2041787.612444] tg3 0000:03:00.0 eno1: 0x00002600: 0x00000000, 0x00000000, 0x00000002, 0x00046800[2041787.612813] tg3 0000:03:00.0 eno1: 0x00002610: 0x00000000, 0x00000000, 0x00000002, 0x00042400[2041787.613177] tg3 0000:03:00.0 eno1: 0x00002620: 0x00000000, 0x00000000, 0x00000002, 0x00046c00[2041787.613541] tg3 0000:03:00.0 eno1: 0x00002630: 0x00000000, 0x00000000, 0x00000002, 0x00042800[2041787.613909] tg3 0000:03:00.0 eno1: 0x00002640: 0x00000000, 0x00000000, 0x00000002, 0x00047000[2041787.614272] tg3 0000:03:00.0 eno1: 0x00002650: 0x00000000, 0x00000000, 0x00000002, 0x00042c00[2041787.614636] tg3 0000:03:00.0 eno1: 0x00002660: 0x00000000, 0x00000000, 0x00000002, 0x00047400[2041787.615004] tg3 0000:03:00.0 eno1: 0x00002670: 0x00000000, 0x00000000, 0x00000002, 0x00043000[2041787.615369] tg3 0000:03:00.0 eno1: 0x00002680: 0x00000000, 0x00000000, 0x00000002, 0x00047800[2041787.615736] tg3 0000:03:00.0 eno1: 0x00002690: 0x00000000, 0x00000000, 0x00000002, 0x00043400[2041787.616101] tg3 0000:03:00.0 eno1: 0x000026a0: 0x00000000, 0x00000000, 0x00000002, 0x00047c00[2041787.616465] tg3 0000:03:00.0 eno1: 0x000026b0: 0x00000000, 0x00000000, 0x00000002, 0x00043800[2041787.616833] tg3 0000:03:00.0 eno1: 0x000026c0: 0x00000000, 0x00000000, 0x00000002, 0x00048000[2041787.617198] tg3 0000:03:00.0 eno1: 0x000026d0: 0x00000000, 0x00000000, 0x00000002, 0x00043c00[2041787.617563] tg3 0000:03:00.0 eno1: 0x000026e0: 0x00000000, 0x00000000, 0x00000002, 0x00048400[2041787.617931] tg3 0000:03:00.0 eno1: 0x000026f0: 0x00000000, 0x00000000, 0x00000002, 0x00044000[2041787.618295] tg3 0000:03:00.0 eno1: 0x00002800: 0x00000006, 0x00000000, 0x00000000, 0x00000000[2041787.618665] tg3 0000:03:00.0 eno1: 0x00002c00: 0x00000006, 0x00000000, 0x00000000, 0x00000063[2041787.619031] tg3 0000:03:00.0 eno1: 0x00002c10: 0x00000000, 0x00000000, 0x00000019, 0x0000000c[2041787.619396] tg3 0000:03:00.0 eno1: 0x00002c20: 0x00000004, 0x00000000, 0x00000000, 0x00000000[2041787.619766] tg3 0000:03:00.0 eno1: 0x00002d00: 0x00000080, 0x00000040, 0x00000000, 0x00000000[2041787.620134] tg3 0000:03:00.0 eno1: 0x00003000: 0x00000006, 0x00000000, 0x00000000, 0x00000063[2041787.620499] tg3 0000:03:00.0 eno1: 0x00003400: 0x00000006, 0x00000000, 0x00000000, 0x00000000[2041787.620866] tg3 0000:03:00.0 eno1: 0x00003600: 0x00004600, 0x00170000, 0x00110000, 0x00000000:[2041787.689148] tg3 0000:03:00.0 eno1: 0x00007020: 0x00000000, 0x00000000, 0x00000406, 0x10004000[2041787.689514] tg3 0000:03:00.0 eno1: 0x00007030: 0x00020000, 0x00004c28, 0x001f0000, 0x00000000[2041787.689887] tg3 0000:03:00.0 eno1: 0: Host status block [00000001:0000006e:(0000:076a:0000):(0000:0070)][2041787.690253] tg3 0000:03:00.0 eno1: 0: NAPI info [0000006e:0000006e:(0122:0070:01ff):0000:(00bf:0000:0000:0000)][2041787.690622] tg3 0000:03:00.0 eno1: 1: Host status block [00000001:00000029:(0000:0000:0000):(071f:0000)][2041787.690991] tg3 0000:03:00.0 eno1: 1: NAPI info [00000029:00000029:(0000:0000:01ff):071f:(071f:071f:0000:0000)][2041787.691359] tg3 0000:03:00.0 eno1: 2: Host status block [00000001:000000fd:(0edc:0000:0000):(0000:0000)][2041787.691732] tg3 0000:03:00.0 eno1: 2: NAPI info [000000fd:000000fd:(0000:0000:01ff):0edc:(06dc:06dc:0000:0000)][2041787.692101] tg3 0000:03:00.0 eno1: 3: Host status block [00000001:00000005:(0000:0000:0000):(0000:0000)][2041787.692469] tg3 0000:03:00.0 eno1: 3: NAPI info [00000003:00000003:(0000:0000:01ff):0ba0:(03a0:03a0:0000:0000)][2041787.692841] tg3 0000:03:00.0 eno1: 4: Host status block [00000001:000000d6:(0000:0000:0e5c):(0000:0000)][2041787.693208] tg3 0000:03:00.0 eno1: 4: NAPI info [000000d6:000000d6:(0000:0000:01ff):0e5c:(065c:065c:0000:0000)][2041787.803833] tg3 0000:03:00.0: tg3_stop_block timed out, ofs=1400 enable_bit=2[2041787.906120] tg3 0000:03:00.0: tg3_stop_block timed out, ofs=c00 enable_bit=2[2041787.983443] tg3 0000:03:00.0 eno1: Link is down[2041790.066223] tg3 0000:03:00.0 eno1: Link is up at 100 Mbps, half duplex[2041790.066235] tg3 0000:03:00.0 eno1: Flow control is off for TX and off for RX[2041790.066240] tg3 0000:03:00.0 eno1: EEE is disabledAnamm,Can you try the latest mainline kernel as 3.10 is not currently supported by the kernel community therefore I would like to see if this is reproducible on a newer mainline kernel from the current, 4.7 release cycle.I confirm this bug too. Kernel 4.8.7[ 220.127011] ------------[ cut here ]------------[ 220.127038] WARNING: CPU: 3 PID: 0 at net/sched/sch_generic.c:316 dev_watchdog+0x21d/0x220[ 220.127041] NETDEV WATCHDOG: eth2 (tg3): transmit queue 0 timed out[ 220.127043] Modules linked in: xt_nat xt_recent xt_comment xt_AUDIT iptable_nat nf_nat_ipv4 xt_connmark xt_realm ipt_REJECT xt_addrtype xt_physdev br_netfilter bridge xt_mark xt_CT iptable_raw xt_multiport xt_LOG nf_log_ipv4 nf_log_common nf_nat_sip nf_nat_irc nf_nat_ftp nf_nat nf_conntrack_proto_sctp hpwdt sch_red 8021q garp mrp stp llc hpilo bnx2 cciss[ 220.127079] CPU: 3 PID: 0 Comm: swapper/3 Not tainted 4.8.7-debug1 #6[ 220.127081] Hardware name: HP ProLiant DL380 G5, BIOS P56 05/01/2007[ 220.127083] 0000000000000000 ffff88007fcc3d90 ffffffff81314738 ffff88007fcc3de0[ 220.127086] 0000000000000000 ffff88007fcc3dd0 ffffffff8105b4a6 0000013c00000040[ 220.127089] 0000000000000000 ffff88007b32c000 0000000000000003 0000000000000005[ 220.127092] Call Trace:[ 220.127094] <IRQ> [<ffffffff81314738>] dump_stack+0x4d/0x65[ 220.127105] [<ffffffff8105b4a6>] __warn+0xc6/0xe0[ 220.127107] [<ffffffff8105b50a>] warn_slowpath_fmt+0x4a/0x50[ 220.127110] [<ffffffff8173a3fd>] dev_watchdog+0x21d/0x220[ 220.127112] [<ffffffff8173a1e0>] ? qdisc_rcu_free+0x40/0x40[ 220.127116] [<ffffffff810bb370>] call_timer_fn+0x30/0x120[ 220.127119] [<ffffffff810bb8b1>] run_timer_softirq+0x201/0x480[ 220.127122] [<ffffffff810c31b7>] ? ktime_get+0x37/0xa0[ 220.127126] [<ffffffff8103dd38>] ? lapic_next_event+0x18/0x20[ 220.127129] [<ffffffff810c945d>] ? clockevents_program_event+0x7d/0x120[ 220.127133] [<ffffffff810606bb>] __do_softirq+0xeb/0x270[ 220.127135] [<ffffffff81060a28>] irq_exit+0x98/0xa0[ 220.127137] [<ffffffff8103e8cd>] smp_apic_timer_interrupt+0x3d/0x50[ 220.127142] [<ffffffff818a65ef>] apic_timer_interrupt+0x7f/0x90[ 220.127143] <EOI> [<ffffffff81025f1f>] ? mwait_idle+0x8f/0x160[ 220.127149] [<ffffffff8102642a>] arch_cpu_idle+0xa/0x10[ 220.127152] [<ffffffff81096135>] default_idle_call+0x25/0x30[ 220.127154] [<ffffffff810963ba>] cpu_startup_entry+0x27a/0x2d0[ 220.127157] [<ffffffff8103cbf8>] start_secondary+0xe8/0xf0[ 220.127162] ---[ end trace 2c8116174dc1811a ]---[ 220.127169] tg3 0000:06:00.1 eth2: transmit timed out, resetting[ 220.128003] tg3 0000:06:00.1 eth2: 0x00000000: 0x165f14e4, 0x00100446, 0x02000000, 0x00800010[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000010: 0xf7bc000c, 0x00000000, 0xf7bb000c, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000020: 0xf7ba000c, 0x00000000, 0x00000000, 0x1786103c[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000030: 0x00000000, 0x00000048, 0x00000000, 0x0000020a[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000040: 0x00000000, 0x30000000, 0xc8035001, 0x64002008[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000050: 0x00005803, 0x00000000, 0x0086a005, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000060: 0x00000000, 0x00000000, 0xf0000298, 0x00380081[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000070: 0x000710b0, 0xffbaddff, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000080: 0x165f14e4, 0x40000042, 0x00000000, 0x00000649[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000090: 0x00000000, 0x00000000, 0x00000000, 0x00000736[ 221.381002] tg3 0000:06:00.1 eth2: 0x000000a0: 0x8010ac11, 0x00000004, 0x00001004, 0x00020010[ 221.381002] tg3 0000:06:00.1 eth2: 0x000000b0: 0x10008d81, 0x00105426, 0x0004cc22, 0x10110040[ 221.381002] tg3 0000:06:00.1 eth2: 0x000000d0: 0x0000001f, 0x00000000, 0x00000000, 0x00010000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000000f0: 0x00000000, 0x05720000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000100: 0x13c10001, 0x00100000, 0x00100000, 0x0017f030[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000110: 0x00000000, 0x000031c0, 0x000000a0, 0x05000001[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000120: 0x00181c03, 0x08f80000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000130: 0x00000000, 0x00000000, 0x00000000, 0x15010003[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000140: 0xfd8e8a9b, 0x00002c44, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000150: 0x16010004, 0x00000000, 0x0007811b, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000160: 0x00010002, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000170: 0x00000000, 0x800000ff, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000200: 0x00000000, 0x30000000, 0x00000000, 0xc1000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000210: 0x00000000, 0x3e000000, 0x00000000, 0x77000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000220: 0x00000000, 0x7f000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000260: 0x00000000, 0x00000000, 0x00000000, 0x00000736[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000280: 0x00000000, 0x00000649, 0x00000000, 0x000009fb[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000290: 0x00000000, 0x000003ad, 0x00000000, 0x00000a7d[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000300: 0x00000000, 0x00000184, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000400: 0x18e04806, 0x02400000, 0x00001000, 0x00000d00[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000410: 0x00002c44, 0xfd8e8a9b, 0x00002c44, 0xfd8e8a9b[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000420: 0x00002c44, 0xfd8e8a9b, 0x00002c44, 0xfd8e8a9b[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000430: 0x00000400, 0x00000000, 0x000000a9, 0x000005f2[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000440: 0x00000000, 0x00000000, 0x00000000, 0x04584400[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000450: 0x00000001, 0x00008000, 0x00000000, 0x00000102[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000460: 0x00000018, 0x00002620, 0x01ff0002, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000470: 0x00000000, 0x10000000, 0x00000000, 0x40000042[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000480: 0x42000000, 0x7fffffff, 0x06000004, 0x7fffffff[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000500: 0x00000008, 0x00000002, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000590: 0x00e00000, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000005b0: 0x00000000, 0x00000008, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000005c0: 0x5bbbbbe8, 0xe7d560b7, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000600: 0xffffffff, 0x00f80051, 0x00000000, 0x00001f04[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000610: 0xffffffff, 0x00000000, 0x07c00044, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000620: 0x00000040, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000630: 0x01230123, 0x01230123, 0x01230123, 0x01230123[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000640: 0x01230123, 0x01230123, 0x01230123, 0x01230123[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000650: 0x01230123, 0x01230123, 0x01230123, 0x01230123[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000660: 0x01230123, 0x01230123, 0x01230123, 0x01230123[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000670: 0xe43ef12c, 0xa0f4458d, 0xd216bf6c, 0x4c9eb80d[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000680: 0xd3f7d46c, 0x64bc431e, 0x39ba2e80, 0xef0aac58[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000690: 0xf252af49, 0xc218b638, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000006c0: 0x00000000, 0x00000000, 0x04000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000800: 0x00000000, 0xffffffff, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000810: 0x00000000, 0xffffffff, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000820: 0x00000000, 0x00000000, 0xffffffff, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000830: 0x00000000, 0xffffffff, 0xffffffff, 0xffffffff[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000840: 0xffffffff, 0xffffffff, 0xffffffff, 0xffffffff[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000850: 0xffffffff, 0xffffffff, 0xffffffff, 0xffffffff[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000860: 0xffffffff, 0xffffffff, 0xffffffff, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000880: 0x0007ede0, 0x00090f21, 0x00000000, 0x000004a9[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000890: 0x00000001, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000008f0: 0x00000001, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000900: 0x012be2a4, 0xffffffff, 0x000024cb, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000910: 0x00000000, 0xffffffff, 0x0000007c, 0x00000d4a[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000920: 0x000080a3, 0x00000863, 0xffffffff, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000930: 0x00001ed7, 0xffffffff, 0xffffffff, 0xffffffff[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000940: 0xffffffff, 0xffffffff, 0xffffffff, 0xffffffff[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000950: 0xffffffff, 0xffffffff, 0xffffffff, 0xffffffff[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000960: 0xffffffff, 0xffffffff, 0xffffffff, 0x00041291[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000970: 0x00000001, 0x00000003, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000980: 0x004df920, 0x00090f21, 0x00000000, 0x00049e65[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000990: 0x00000009, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000c00: 0x0000000a, 0x00000000, 0x00000003, 0x00000001[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000c10: 0x00000000, 0x00000007, 0x00000000, 0x004c0000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000c80: 0x000432d9, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000ce0: 0x64a1f882, 0x00000000, 0x0000004c, 0x00040028[ 221.381002] tg3 0000:06:00.1 eth2: 0x00000cf0: 0x00000000, 0x50000034, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00001000: 0x00000002, 0x00000000, 0xa000b3b3, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00001010: 0x512d12e1, 0x0000b3b3, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00001400: 0x00000006, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00001440: 0x00000135, 0x00000135, 0x00000135, 0x00000135[ 221.381002] tg3 0000:06:00.1 eth2: 0x00001450: 0x00000135, 0x00000135, 0x00000135, 0x00000135[ 221.381002] tg3 0000:06:00.1 eth2: 0x00001460: 0x00000135, 0x00000135, 0x00000135, 0x00000135[ 221.381002] tg3 0000:06:00.1 eth2: 0x00001470: 0x00000135, 0x00000135, 0x00000135, 0x00000135[ 221.381002] tg3 0000:06:00.1 eth2: 0x00001480: 0x00001114, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00001800: 0x00000016, 0x00000000, 0x00000165, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00001830: 0x00000000, 0x00000000, 0x00000000, 0x75470000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00001840: 0x75470000, 0x00000000, 0x10000211, 0xc0000001[ 221.381002] tg3 0000:06:00.1 eth2: 0x00001850: 0x0000001f, 0x00000000, 0x00004150, 0x01650165[ 221.381002] tg3 0000:06:00.1 eth2: 0x00001860: 0x10001900, 0x00000000, 0x75471550, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00001c00: 0x00000002, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002000: 0x00000002, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002010: 0x00000181, 0x00000001, 0x00780003, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002100: 0x000decf6, 0x000decf6, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002110: 0x000decf6, 0x000decf6, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002120: 0x000decf6, 0x000decf6, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002130: 0x000decf6, 0x000decf6, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002140: 0x000decf6, 0x000decf6, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002150: 0x000decf6, 0x000decf6, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002160: 0x000decf6, 0x000decf6, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002170: 0x000decf6, 0x000decf6, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002180: 0x000decf6, 0x000decf6, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002190: 0x000decf6, 0x000decf6, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000021a0: 0x000decf6, 0x000decf6, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000021b0: 0x000decf6, 0x000decf6, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000021c0: 0x000decf6, 0x000decf6, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000021d0: 0x000decf6, 0x000decf6, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000021e0: 0x000decf6, 0x000decf6, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000021f0: 0x000decf6, 0x000decf6, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002200: 0x0004a4a0, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002400: 0x00010012, 0x00000000, 0x00246001, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002410: 0x0000000f, 0x00005d00, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002440: 0x00000000, 0x00000000, 0x00000002, 0x00044400[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002450: 0x00000000, 0x755b0000, 0x08001800, 0x00040000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002470: 0x00000000, 0x00000673, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002500: 0x00000000, 0x00000000, 0x00000002, 0x00044800[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002510: 0x00000000, 0x00000000, 0x00000002, 0x00040400[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002520: 0x00000000, 0x00000000, 0x00000002, 0x00044c00[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002530: 0x00000000, 0x00000000, 0x00000002, 0x00040800[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002540: 0x00000000, 0x00000000, 0x00000002, 0x00045000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002550: 0x00000000, 0x00000000, 0x00000002, 0x00040c00[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002560: 0x00000000, 0x00000000, 0x00000002, 0x00045400[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002570: 0x00000000, 0x00000000, 0x00000002, 0x00041000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002580: 0x00000000, 0x00000000, 0x00000002, 0x00045800[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002590: 0x00000000, 0x00000000, 0x00000002, 0x00041400[ 221.381002] tg3 0000:06:00.1 eth2: 0x000025a0: 0x00000000, 0x00000000, 0x00000002, 0x00045c00[ 221.381002] tg3 0000:06:00.1 eth2: 0x000025b0: 0x00000000, 0x00000000, 0x00000002, 0x00041800[ 221.381002] tg3 0000:06:00.1 eth2: 0x000025c0: 0x00000000, 0x00000000, 0x00000002, 0x00046000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000025d0: 0x00000000, 0x00000000, 0x00000002, 0x00041c00[ 221.381002] tg3 0000:06:00.1 eth2: 0x000025e0: 0x00000000, 0x00000000, 0x00000002, 0x00046400[ 221.381002] tg3 0000:06:00.1 eth2: 0x000025f0: 0x00000000, 0x00000000, 0x00000002, 0x00042000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002600: 0x00000000, 0x00000000, 0x00000002, 0x00046800[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002610: 0x00000000, 0x00000000, 0x00000002, 0x00042400[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002620: 0x00000000, 0x00000000, 0x00000002, 0x00046c00[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002630: 0x00000000, 0x00000000, 0x00000002, 0x00042800[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002640: 0x00000000, 0x00000000, 0x00000002, 0x00047000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002650: 0x00000000, 0x00000000, 0x00000002, 0x00042c00[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002660: 0x00000000, 0x00000000, 0x00000002, 0x00047400[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002670: 0x00000000, 0x00000000, 0x00000002, 0x00043000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002680: 0x00000000, 0x00000000, 0x00000002, 0x00047800[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002690: 0x00000000, 0x00000000, 0x00000002, 0x00043400[ 221.381002] tg3 0000:06:00.1 eth2: 0x000026a0: 0x00000000, 0x00000000, 0x00000002, 0x00047c00[ 221.381002] tg3 0000:06:00.1 eth2: 0x000026b0: 0x00000000, 0x00000000, 0x00000002, 0x00043800[ 221.381002] tg3 0000:06:00.1 eth2: 0x000026c0: 0x00000000, 0x00000000, 0x00000002, 0x00048000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000026d0: 0x00000000, 0x00000000, 0x00000002, 0x00043c00[ 221.381002] tg3 0000:06:00.1 eth2: 0x000026e0: 0x00000000, 0x00000000, 0x00000002, 0x00048400[ 221.381002] tg3 0000:06:00.1 eth2: 0x000026f0: 0x00000000, 0x00000000, 0x00000002, 0x00044000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002800: 0x00000006, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002c00: 0x00000006, 0x00000000, 0x00000000, 0x0000072a[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002c10: 0x00000000, 0x00000000, 0x00000019, 0x0000000c[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002c20: 0x00000002, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00002d00: 0x00000080, 0x00000040, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003000: 0x00000006, 0x00000000, 0x00000000, 0x0000072a[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003440: 0x00000000, 0x00000000, 0x00000000, 0x00000110[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003600: 0x00000600, 0x00170000, 0x00110000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003610: 0x00170000, 0x00000000, 0x00130000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003620: 0x00110011, 0x00000000, 0x00000000, 0x400b2080[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003630: 0x00800000, 0x87748774, 0x02c01000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003640: 0x00000000, 0x00000000, 0x00000020, 0x00000019[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003650: 0x00000171, 0x000f03ff, 0x05720000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003660: 0x00000000, 0x00000000, 0x02000000, 0x00000202[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003670: 0x00000000, 0xfef7afe3, 0x00000000, 0x00000020[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003680: 0x30018010, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000036a0: 0x000001a0, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000036b0: 0x0010034c, 0x07ff07ff, 0x07ff07ff, 0x01000004[ 221.381002] tg3 0000:06:00.1 eth2: 0x000036c0: 0xfffffffe, 0x00000000, 0x00000000, 0x0004fb73[ 221.381002] tg3 0000:06:00.1 eth2: 0x000036d0: 0x000001f8, 0x00000000, 0x00000000, 0x00004d3b[ 221.381002] tg3 0000:06:00.1 eth2: 0x000036f0: 0x00000000, 0x00000000, 0x00000000, 0x00012901[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003800: 0x00000001, 0x00000000, 0x0000000e, 0x0516028b[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003810: 0x000001ff, 0x0000009f, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003c00: 0x00000306, 0x00000000, 0x00000000, 0x00000048[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003c10: 0x00000000, 0x00000035, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003c20: 0x00000000, 0x00000005, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003c30: 0x00000000, 0x00000000, 0x00000000, 0x7bc6b000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003c40: 0x00000000, 0x00000b00, 0x00000040, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003c50: 0x00000000, 0x0000072a, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003c80: 0x00000676, 0x00000a36, 0x000003d8, 0x00000aa6[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003cc0: 0x0000012d, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003cd0: 0x00000000, 0x0000000f, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003d00: 0x00000000, 0x7c065000, 0x00000000, 0x7c207000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003d10: 0x00000000, 0x7c26e000, 0x00000000, 0x75582000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003d80: 0x00000014, 0x00000000, 0x00000005, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003d90: 0x00000005, 0x00000000, 0x00000014, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003da0: 0x00000005, 0x00000000, 0x00000005, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003db0: 0x00000014, 0x00000000, 0x00000005, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003dc0: 0x00000005, 0x00000000, 0x00000014, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003dd0: 0x00000005, 0x00000000, 0x00000005, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00003fc0: 0x000325d2, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004000: 0x00000002, 0x00000000, 0x0011c35a, 0x001f072f[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004010: 0x00000000, 0x002c0012, 0x00000490, 0x0084a842[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004020: 0x00000000, 0x00000000, 0x00000010, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004030: 0x00000010, 0x0080a910, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004040: 0x00000000, 0x00000000, 0x01086620, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004050: 0x00000000, 0x00000000, 0x002e1010, 0x00418002[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004060: 0x00419000, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004400: 0x00000016, 0x00000000, 0x00010000, 0x0000a000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004410: 0x00000000, 0x0000002a, 0x000000a0, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004420: 0x0000003d, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004440: 0x00000000, 0x00000000, 0x00000000, 0x091244b6[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004450: 0x02404c20, 0x00e200c2, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004800: 0x380303fe, 0x00000000, 0x00000000, 0x00000120[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004810: 0x00000000, 0x0000000b, 0x00ac97f8, 0x00002a28[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004820: 0x00000019, 0x00000000, 0xf0330000, 0x6127e3a0[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004830: 0x00000000, 0x00000283, 0x00000283, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004840: 0x000000b6, 0x000000b6, 0x000e2200, 0x1936815a[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004850: 0x0fd262ad, 0x736c005a, 0x18171817, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004860: 0x02000019, 0x113bcb72, 0x00100800, 0x42040008[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004870: 0x05ea4980, 0x003e1820, 0x003e1820, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004900: 0x28190404, 0x00305407, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004910: 0x000f001c, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004a00: 0x180303fe, 0x00200000, 0x00200020, 0x9eab0000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004a10: 0x755be4e0, 0x008ca924, 0x00200012, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004a20: 0x00000000, 0x00000000, 0xf02c0000, 0x755be540[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004a30: 0x00000000, 0x00000172, 0x00000172, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004a40: 0x755be480, 0x755be4a0, 0x755be4c0, 0x755be4e0[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004a50: 0x00200020, 0x00200020, 0x00200020, 0x00200020[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004a70: 0x28190404, 0x00305407, 0x000f001c, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004b00: 0x180303fe, 0x00420003, 0x30480000, 0x003601e0[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004b10: 0x003603d2, 0x007c0383, 0x0042d7f4, 0x10000d8c[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004b20: 0x000000b5, 0x025a0000, 0x64a1fa81, 0x0f420048[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004b30: 0x613a5441, 0x0f360038, 0x613a5281, 0x0f360038[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004b40: 0x60fbf041, 0x0f7c0080, 0x98913d34, 0x655ecaba[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004b50: 0xf0330000, 0x64a1fac8, 0xaf050000, 0xb5b400b4[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004b60: 0xf0330000, 0x613a5478, 0xaf040000, 0x4000012f[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004b70: 0xf0330000, 0x613a52b8, 0xaf040000, 0x000000ff[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004b80: 0x020000b4, 0x113bcb72, 0x00100800, 0x42040008[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004b90: 0x05ea4980, 0x28190404, 0x00305407, 0x000f001c[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004ba0: 0x00f00069, 0x020000b4, 0x113bcb72, 0x000f001c[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004bb0: 0x613a5601, 0x613a5c01, 0x613a5a01, 0x613a5801[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004bc0: 0x64a1fa82, 0x613a5442, 0x613a5282, 0x60fbf042[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004bd0: 0x613a5602, 0x613a5c02, 0x613a5a02, 0x613a5802[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004be0: 0x00360042, 0x007c0036, 0x0036004a, 0x00420050[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004bf0: 0xf0330000, 0x60fbf0c0, 0xaf080000, 0x0000ffff[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004c00: 0x200003fe, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004c10: 0x0000002a, 0x00000000, 0x00000006, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004c20: 0x00000000, 0x00000000, 0x00000000, 0x00000006[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004c30: 0x00000000, 0x019d8000, 0x00108000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004c40: 0x00000020, 0x00000000, 0x001d0020, 0x00040020[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004c50: 0xd7a35675, 0x2a675aa5, 0xa63d8a36, 0x632a3232[ 221.381002] tg3 0000:06:00.1 eth2: 0x00004c60: 0x00000020, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005000: 0x00009800, 0x80004000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005010: 0x00000000, 0x00000000, 0x00000000, 0x08002030[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005020: 0x30422000, 0x00000000, 0x00000000, 0x40000020[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005030: 0x00000000, 0x0000001d, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005040: 0x00000000, 0x00000000, 0x0800201c, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005080: 0x00009800, 0x80000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005090: 0x00000000, 0x00000000, 0x00000000, 0x080020ec[ 221.381002] tg3 0000:06:00.1 eth2: 0x000050a0: 0x3484dead, 0x00000000, 0x00000000, 0x40000020[ 221.381002] tg3 0000:06:00.1 eth2: 0x000050b0: 0x00000000, 0x0000001d, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000050c0: 0x00000000, 0x00000000, 0x08000088, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005100: 0x00009800, 0x80000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005110: 0x00000000, 0x00000000, 0x00000000, 0x08002898[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005120: 0x24634521, 0x00000000, 0x00000000, 0x40000020[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005130: 0x00000000, 0x0000001d, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005140: 0x00000000, 0x00000000, 0x0800288c, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005180: 0x00009800, 0x80000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005190: 0x00000000, 0x00000000, 0x00000000, 0x08000078[ 221.381002] tg3 0000:06:00.1 eth2: 0x000051a0: 0x00831824, 0x00000000, 0x00000000, 0x40000020[ 221.381002] tg3 0000:06:00.1 eth2: 0x000051b0: 0x00000000, 0x0000001d, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000051c0: 0x00000000, 0x00000000, 0x08001a52, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005200: 0x09020010, 0x00000000, 0xc0000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005210: 0x14600027, 0x00000000, 0x3c038000, 0xc0000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005220: 0x00000b50, 0x00000000, 0x144001e5, 0x09020010[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005230: 0xc0000000, 0x400b2080, 0xc0000000, 0x14600027[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005240: 0x00000000, 0x3c038000, 0xc0010000, 0x00000b50[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005250: 0x80000000, 0x144001e5, 0x09020010, 0x41504521[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005260: 0x00000000, 0x3c038000, 0x14600027, 0x09020010[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005270: 0x3c038000, 0x144001e5, 0x09020010, 0x80000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005280: 0x00009800, 0x80000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005290: 0x00000000, 0x00000000, 0x00000000, 0x08000078[ 221.381002] tg3 0000:06:00.1 eth2: 0x000052a0: 0x00831824, 0x00000000, 0x00000000, 0x40000020[ 221.381002] tg3 0000:06:00.1 eth2: 0x000052b0: 0x00000000, 0x0000001d, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000052c0: 0x00000000, 0x00000000, 0x08001a9a, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005300: 0x00009800, 0x80004000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005310: 0x00000000, 0x00000000, 0x00000000, 0x08002050[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005320: 0x8f430000, 0x00000000, 0x00000000, 0x40000020[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005330: 0x00000000, 0x0000001d, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005340: 0x00000000, 0x00000000, 0x08000088, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005380: 0x00009800, 0x80004000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005390: 0x00000000, 0x00000000, 0x00000000, 0x08002e04[ 221.381002] tg3 0000:06:00.1 eth2: 0x000053a0: 0x00621024, 0x00000000, 0x00000000, 0x40000020[ 221.381002] tg3 0000:06:00.1 eth2: 0x000053b0: 0x00000000, 0x0000001d, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000053c0: 0x00000000, 0x00000000, 0x08002052, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005800: 0x32000000, 0x32000000, 0x00000001, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005810: 0x73000000, 0x00000000, 0x00000001, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005820: 0xa7000000, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005860: 0x00000000, 0x00000000, 0x00000742, 0x00000742[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005880: 0x0000064a, 0x0000064a, 0x00000a36, 0x00000a36[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005890: 0x000003ad, 0x000003ad, 0x00000aa6, 0x00000aa6[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005900: 0x00000184, 0x00000184, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005980: 0x00000165, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00005a00: 0x000f601f, 0x00000000, 0x00010000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00006000: 0x00010082, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00006400: 0x00000000, 0x00000000, 0x00010891, 0xc0000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00006410: 0x0a000064, 0x0a000064, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00006430: 0x00000000, 0x14e4165f, 0x1786103c, 0x00020000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00006440: 0x0000304f, 0x000002e4, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000064c0: 0x00000010, 0x00000004, 0x00001004, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000064d0: 0x00000000, 0x10008d81, 0x00000000, 0x00315e22[ 221.381002] tg3 0000:06:00.1 eth2: 0x000064e0: 0x00000031, 0x0000001f, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000064f0: 0x00000002, 0x00000031, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00006500: 0x01e10003, 0xfd8e8a9b, 0x00002c44, 0x00000003[ 221.381002] tg3 0000:06:00.1 eth2: 0x00006510: 0x0007811b, 0x00058116, 0x00046113, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00006550: 0x00000000, 0x02800000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000065f0: 0x00000000, 0x00000109, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00006800: 0x141b0034, 0x20099082, 0x01020408, 0x0c51e788[ 221.381002] tg3 0000:06:00.1 eth2: 0x00006810: 0x09020010, 0xffffffff, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00006830: 0xffffffff, 0xffffffff, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00006840: 0x00000000, 0x00000001, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00006890: 0x00000000, 0x88003800, 0x00000000, 0x04102040[ 221.381002] tg3 0000:06:00.1 eth2: 0x000068a0: 0x00000020, 0x00000001, 0x03ff03ff, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000068b0: 0xe0011514, 0x00000000, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x000068e0: 0x00000000, 0x00000000, 0x00000000, 0x0004c728[ 221.381002] tg3 0000:06:00.1 eth2: 0x000068f0: 0x00ff000e, 0x00ff0000, 0x00000000, 0x04444444[ 221.381002] tg3 0000:06:00.1 eth2: 0x00006900: 0xac59cd90, 0x14883791, 0x00000000, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00006920: 0x00000000, 0x00000000, 0x00000001, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00007000: 0x08000008, 0x00000000, 0x00000000, 0x00004af4[ 221.381002] tg3 0000:06:00.1 eth2: 0x00007010: 0x6078fa0d, 0x01c080f1, 0x00d70081, 0x03008200[ 221.381002] tg3 0000:06:00.1 eth2: 0x00007020: 0x00000000, 0x00000000, 0x00000406, 0x10004000[ 221.381002] tg3 0000:06:00.1 eth2: 0x00007030: 0x00060000, 0x00004af8, 0x00160030, 0x00000000[ 221.381002] tg3 0000:06:00.1 eth2: 0: Host status block [00000005:00000032:(0000:072a:0000):(0000:012d)][ 221.381002] tg3 0000:06:00.1 eth2: 0: NAPI info [00000032:00000032:(0184:012d:01ff):0000:(0742:0000:0000:0000)][ 221.381002] tg3 0000:06:00.1 eth2: 1: Host status block [00000001:000000e9:(0000:0000:0000):(0676:0000)][ 221.381002] tg3 0000:06:00.1 eth2: 1: NAPI info [000000c2:000000c2:(0000:0000:01ff):064a:(064a:064a:0000:0000)][ 221.381002] tg3 0000:06:00.1 eth2: 2: Host status block [00000001:00000073:(0a36:0000:0000):(0000:0000)][ 221.381002] tg3 0000:06:00.1 eth2: 2: NAPI info [00000073:00000073:(0000:0000:01ff):0a36:(0236:0201:0000:0000)][ 221.381002] tg3 0000:06:00.1 eth2: 3: Host status block [00000001:0000009d:(0000:0000:0000):(0000:0000)][ 221.381002] tg3 0000:06:00.1 eth2: 3: NAPI info [00000077:00000077:(0000:0000:01ff):03ad:(03ad:03ad:0000:0000)][ 221.381002] tg3 0000:06:00.1 eth2: 4: Host status block [00000001:000000a7:(0000:0000:0aa6):(0000:0000)][ 221.381002] tg3 0000:06:00.1 eth2: 4: NAPI info [000000a7:000000a7:(0000:0000:01ff):0aa6:(02a6:0282:0000:0000)][ 221.490166] tg3 0000:06:00.1: tg3_stop_block timed out, ofs=1400 enable_bit=2[ 221.591718] tg3 0000:06:00.1: tg3_stop_block timed out, ofs=c00 enable_bit=2[ 221.667480] tg3 0000:06:00.1 eth2: Link is down[ 223.744825] tg3 0000:06:00.1 eth2: Link is up at 100 Mbps, half duplex[ 223.746092] tg3 0000:06:00.1 eth2: Flow control is off for TX and off for RX[ 223.746092] tg3 0000:06:00.1 eth2: EEE is disabled[ 285.507432] systemd-journald[1137]: Sent WATCHDOG=1 notification.[ 311.775017] tg3 0000:06:00.1 eth2: transmit timed out, resetting[ 311.776001] tg3 0000:06:00.1 eth2: 0x00000000: 0x165f14e4, 0x00100446, 0x02000000, 0x00800010[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000010: 0xf7bc000c, 0x00000000, 0xf7bb000c, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000020: 0xf7ba000c, 0x00000000, 0x00000000, 0x1786103c[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000030: 0x00000000, 0x00000048, 0x00000000, 0x0000020a[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000040: 0x00000000, 0x52000000, 0xc8035001, 0x64002008[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000050: 0x00005803, 0x00000000, 0x0086a005, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000060: 0x00000000, 0x00000000, 0xf0000298, 0x00380081[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000070: 0x000710b0, 0xffbaddff, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000080: 0x165f14e4, 0x800000f8, 0x00000000, 0x000002ce[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000090: 0x00000000, 0x00000000, 0x00000000, 0x0000043f[ 313.030524] tg3 0000:06:00.1 eth2: 0x000000a0: 0x8010ac11, 0x00000004, 0x00001004, 0x00020010[ 313.030524] tg3 0000:06:00.1 eth2: 0x000000b0: 0x10008d81, 0x00105426, 0x0004cc22, 0x10110040[ 313.030524] tg3 0000:06:00.1 eth2: 0x000000d0: 0x0000001f, 0x00000000, 0x00000000, 0x00010000[ 313.030524] tg3 0000:06:00.1 eth2: 0x000000f0: 0x00000000, 0x05720000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000100: 0x13c10001, 0x00100000, 0x00100000, 0x0017f030[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000110: 0x00000000, 0x000031c0, 0x000000a0, 0x05000001[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000120: 0x00181c03, 0x08f80000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000130: 0x00000000, 0x00000000, 0x00000000, 0x15010003[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000140: 0xfd8e8a9b, 0x00002c44, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000150: 0x16010004, 0x00000000, 0x0007811b, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000160: 0x00010002, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000170: 0x00000000, 0x800000ff, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000200: 0x00000000, 0x52000000, 0x00000000, 0x8a000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000210: 0x00000000, 0x00000001, 0x00000000, 0xa8000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000220: 0x00000000, 0x34000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000260: 0x00000000, 0x00000000, 0x00000000, 0x00000442[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000280: 0x00000000, 0x000002ce, 0x00000000, 0x00000251[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000290: 0x00000000, 0x0000014a, 0x00000000, 0x00000511[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000300: 0x00000000, 0x000001f4, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000400: 0x18e04806, 0x00400000, 0x00001000, 0x00000900[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000410: 0x00002c44, 0xfd8e8a9b, 0x00002c44, 0xfd8e8a9b[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000420: 0x00002c44, 0xfd8e8a9b, 0x00002c44, 0xfd8e8a9b[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000430: 0x00000400, 0x00000000, 0x000000eb, 0x000005f2[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000440: 0x00000000, 0x00000000, 0x00000000, 0x084a0000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000450: 0x00000001, 0x00008000, 0x00000000, 0x00000102[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000460: 0x00000008, 0x00002620, 0x01ff0002, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000470: 0x00000000, 0x10000000, 0x00000000, 0x40000042[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000480: 0x42000000, 0x7fffffff, 0x06000004, 0x7fffffff[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000500: 0x00000008, 0x00000002, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000590: 0x00e00000, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x000005b0: 0x00000000, 0x00000008, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x000005c0: 0x5bbbbbe8, 0xe7d560b7, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000600: 0xffffffff, 0x00f800d1, 0x00000000, 0x00001f04[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000610: 0xffffffff, 0x00000000, 0x07c00284, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000620: 0x00000040, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000630: 0x01230123, 0x01230123, 0x01230123, 0x01230123[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000640: 0x01230123, 0x01230123, 0x01230123, 0x01230123[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000650: 0x01230123, 0x01230123, 0x01230123, 0x01230123[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000660: 0x01230123, 0x01230123, 0x01230123, 0x01230123[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000670: 0xe43ef12c, 0xa0f4458d, 0xd216bf6c, 0x4c9eb80d[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000680: 0xd3f7d46c, 0x64bc431e, 0x39ba2e80, 0xef0aac58[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000690: 0xf252af49, 0xc218b638, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x000006c0: 0x00000000, 0x00000000, 0x04000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000800: 0x00000000, 0xffffffff, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000810: 0x00000000, 0xffffffff, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000820: 0x00000000, 0x00000000, 0xffffffff, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000830: 0x00000000, 0xffffffff, 0xffffffff, 0xffffffff[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000840: 0xffffffff, 0xffffffff, 0xffffffff, 0xffffffff[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000850: 0xffffffff, 0xffffffff, 0xffffffff, 0xffffffff[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000860: 0xffffffff, 0xffffffff, 0xffffffff, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000880: 0x000b979e, 0x00000000, 0x00000000, 0x00000825[ 313.030524] tg3 0000:06:00.1 eth2: 0x000008f0: 0x00000001, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000900: 0x0f2565d3, 0xffffffff, 0x0001839c, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000910: 0x00000000, 0xffffffff, 0x0000004e, 0x0000580c[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000920: 0x000055dd, 0x00002bc8, 0xffffffff, 0x00000006[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000930: 0x00016d4f, 0xffffffff, 0xffffffff, 0xffffffff[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000940: 0xffffffff, 0xffffffff, 0xffffffff, 0xffffffff[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000950: 0xffffffff, 0xffffffff, 0xffffffff, 0xffffffff[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000960: 0xffffffff, 0xffffffff, 0xffffffff, 0x000738c1[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000970: 0x00000003, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000980: 0x000b975e, 0x00000000, 0x00000000, 0x00088b4d[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000990: 0x0000002e, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000c00: 0x0000000a, 0x00000000, 0x00000003, 0x00000001[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000c10: 0x00000000, 0x00000007, 0x00000000, 0x004a0000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000c80: 0x0007855e, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000ce0: 0x6028c442, 0x00000000, 0x0000004a, 0x00040028[ 313.030524] tg3 0000:06:00.1 eth2: 0x00000cf0: 0x00000000, 0x5000004e, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00001000: 0x00000002, 0x00000000, 0xa000b8b8, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00001010: 0x51c71c81, 0x0000b8b8, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00001400: 0x00000006, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00001440: 0x000001cf, 0x000001cf, 0x000001cf, 0x000001cf[ 313.030524] tg3 0000:06:00.1 eth2: 0x00001450: 0x000001cf, 0x000001cf, 0x000001cf, 0x000001cf[ 313.030524] tg3 0000:06:00.1 eth2: 0x00001460: 0x000001cf, 0x000001cf, 0x000001cf, 0x000001cf[ 313.030524] tg3 0000:06:00.1 eth2: 0x00001470: 0x000001cf, 0x000001cf, 0x000001cf, 0x000001cf[ 313.030524] tg3 0000:06:00.1 eth2: 0x00001480: 0x00001114, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00001800: 0x00000016, 0x00000000, 0x000001f4, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00001830: 0x00000000, 0x00000000, 0x00000000, 0x75470000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00001840: 0x75470000, 0x00000000, 0x00000201, 0xc0000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00001850: 0x0000001f, 0x00000000, 0x00004310, 0x01f401f4[ 313.030524] tg3 0000:06:00.1 eth2: 0x00001860: 0x03000000, 0x00000000, 0x75471f10, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00001c00: 0x00000002, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002000: 0x00000002, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002010: 0x00000181, 0x00000001, 0x00780003, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002100: 0x000ca85e, 0x000ca85e, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002110: 0x000ca85e, 0x000ca85e, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002120: 0x000ca85e, 0x000ca85e, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002130: 0x000ca85e, 0x000ca85e, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002140: 0x000ca85e, 0x000ca85e, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002150: 0x000ca85e, 0x000ca85e, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002160: 0x000ca85e, 0x000ca85e, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002170: 0x000ca85e, 0x000ca85e, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002180: 0x000ca85e, 0x000ca85e, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002190: 0x000ca85e, 0x000ca85e, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x000021a0: 0x000ca85e, 0x000ca85e, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x000021b0: 0x000ca85e, 0x000ca85e, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x000021c0: 0x000ca85e, 0x000ca85e, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x000021d0: 0x000ca85e, 0x000ca85e, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x000021e0: 0x000ca85e, 0x000ca85e, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x000021f0: 0x000ca85e, 0x000ca85e, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002200: 0x00088b7c, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002250: 0x00000001, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002400: 0x00010012, 0x00000000, 0x00246001, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002410: 0x0000000f, 0x00005d00, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002440: 0x00000000, 0x00000000, 0x00000002, 0x00044400[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002450: 0x00000000, 0x755b0000, 0x08001800, 0x00040000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002470: 0x00000000, 0x0000037c, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002500: 0x00000000, 0x00000000, 0x00000002, 0x00044800[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002510: 0x00000000, 0x00000000, 0x00000002, 0x00040400[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002520: 0x00000000, 0x00000000, 0x00000002, 0x00044c00[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002530: 0x00000000, 0x00000000, 0x00000002, 0x00040800[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002540: 0x00000000, 0x00000000, 0x00000002, 0x00045000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002550: 0x00000000, 0x00000000, 0x00000002, 0x00040c00[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002560: 0x00000000, 0x00000000, 0x00000002, 0x00045400[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002570: 0x00000000, 0x00000000, 0x00000002, 0x00041000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002580: 0x00000000, 0x00000000, 0x00000002, 0x00045800[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002590: 0x00000000, 0x00000000, 0x00000002, 0x00041400[ 313.030524] tg3 0000:06:00.1 eth2: 0x000025a0: 0x00000000, 0x00000000, 0x00000002, 0x00045c00[ 313.030524] tg3 0000:06:00.1 eth2: 0x000025b0: 0x00000000, 0x00000000, 0x00000002, 0x00041800[ 313.030524] tg3 0000:06:00.1 eth2: 0x000025c0: 0x00000000, 0x00000000, 0x00000002, 0x00046000[ 313.030524] tg3 0000:06:00.1 eth2: 0x000025d0: 0x00000000, 0x00000000, 0x00000002, 0x00041c00[ 313.030524] tg3 0000:06:00.1 eth2: 0x000025e0: 0x00000000, 0x00000000, 0x00000002, 0x00046400[ 313.030524] tg3 0000:06:00.1 eth2: 0x000025f0: 0x00000000, 0x00000000, 0x00000002, 0x00042000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002600: 0x00000000, 0x00000000, 0x00000002, 0x00046800[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002610: 0x00000000, 0x00000000, 0x00000002, 0x00042400[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002620: 0x00000000, 0x00000000, 0x00000002, 0x00046c00[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002630: 0x00000000, 0x00000000, 0x00000002, 0x00042800[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002640: 0x00000000, 0x00000000, 0x00000002, 0x00047000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002650: 0x00000000, 0x00000000, 0x00000002, 0x00042c00[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002660: 0x00000000, 0x00000000, 0x00000002, 0x00047400[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002670: 0x00000000, 0x00000000, 0x00000002, 0x00043000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002680: 0x00000000, 0x00000000, 0x00000002, 0x00047800[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002690: 0x00000000, 0x00000000, 0x00000002, 0x00043400[ 313.030524] tg3 0000:06:00.1 eth2: 0x000026a0: 0x00000000, 0x00000000, 0x00000002, 0x00047c00[ 313.030524] tg3 0000:06:00.1 eth2: 0x000026b0: 0x00000000, 0x00000000, 0x00000002, 0x00043800[ 313.030524] tg3 0000:06:00.1 eth2: 0x000026c0: 0x00000000, 0x00000000, 0x00000002, 0x00048000[ 313.030524] tg3 0000:06:00.1 eth2: 0x000026d0: 0x00000000, 0x00000000, 0x00000002, 0x00043c00[ 313.030524] tg3 0000:06:00.1 eth2: 0x000026e0: 0x00000000, 0x00000000, 0x00000002, 0x00048400[ 313.030524] tg3 0000:06:00.1 eth2: 0x000026f0: 0x00000000, 0x00000000, 0x00000002, 0x00044000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002800: 0x00000006, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002c00: 0x00000006, 0x00000000, 0x00000000, 0x00000676[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002c10: 0x00000000, 0x00000000, 0x00000019, 0x0000000c[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002c20: 0x00000004, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00002d00: 0x00000080, 0x00000040, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003000: 0x00000006, 0x00000000, 0x00000000, 0x00000676[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003440: 0x00000000, 0x00000000, 0x00000000, 0x00000110[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003600: 0x00000600, 0x00170000, 0x00110000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003610: 0x00170000, 0x00000000, 0x00130000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003620: 0x00110011, 0x00000000, 0x00000000, 0x400b2080[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003630: 0x00800000, 0x87748774, 0x02c01000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003640: 0x00000000, 0x00000000, 0x00000020, 0x00000019[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003650: 0x00000171, 0x000f03ff, 0x05720000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003660: 0x00000000, 0x00000000, 0x02000000, 0x00000202[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003670: 0x00000000, 0xfeffafe3, 0x00000000, 0x00000020[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003680: 0x30018010, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x000036a0: 0x000001a0, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x000036b0: 0x0010034c, 0x07ff07ff, 0x07ff07ff, 0x01000004[ 313.030524] tg3 0000:06:00.1 eth2: 0x000036c0: 0xfffffffe, 0x00000000, 0x00000000, 0x0004ff0e[ 313.030524] tg3 0000:06:00.1 eth2: 0x000036d0: 0x000001f8, 0x00000000, 0x00000000, 0x00004d3b[ 313.030524] tg3 0000:06:00.1 eth2: 0x000036f0: 0x00000000, 0x00000000, 0x00000000, 0x00012301[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003800: 0x00000001, 0x00000000, 0x0000000e, 0x0516028b[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003810: 0x000001ff, 0x0000009f, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003c00: 0x00000306, 0x00000000, 0x00000000, 0x00000048[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003c10: 0x00000000, 0x00000035, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003c20: 0x00000000, 0x00000005, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003c30: 0x00000000, 0x00000000, 0x00000000, 0x7bc6b000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003c40: 0x00000000, 0x00000b00, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003c50: 0x00000000, 0x000005fa, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003c80: 0x0000037f, 0x000002e3, 0x000001ec, 0x000005ac[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003cc0: 0x000001c7, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003cd0: 0x00000000, 0x0000000f, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003d00: 0x00000000, 0x7c065000, 0x00000000, 0x7c207000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003d10: 0x00000000, 0x7c26e000, 0x00000000, 0x75582000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003d80: 0x00000014, 0x00000000, 0x00000005, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003d90: 0x00000005, 0x00000000, 0x00000014, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003da0: 0x00000005, 0x00000000, 0x00000005, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003db0: 0x00000014, 0x00000000, 0x00000005, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003dc0: 0x00000005, 0x00000000, 0x00000014, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003dd0: 0x00000005, 0x00000000, 0x00000005, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00003fc0: 0x000a9df5, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004000: 0x00000002, 0x00000000, 0x0011c35a, 0x001f072f[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004010: 0x00000000, 0x0023c012, 0x00000490, 0x0085ec42[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004020: 0x00016a11, 0x00000000, 0x00000010, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004030: 0x00000010, 0x00000050, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004040: 0x00000000, 0x00000000, 0x01081a20, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004050: 0x00000000, 0x00000000, 0x0023c010, 0x00468002[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004060: 0x00474000, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004400: 0x00000016, 0x00000000, 0x00010000, 0x0000a000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004410: 0x00000000, 0x0000002a, 0x000000a0, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004420: 0x0000003d, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004440: 0x00000000, 0x00000000, 0x00000000, 0x0df018c7[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004450: 0x00039d3f, 0x003e003f, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004800: 0x380303fe, 0x00000000, 0x00000000, 0x00000120[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004810: 0x00000000, 0x0000000b, 0x057882f4, 0x00001514[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004820: 0x00000074, 0x00000000, 0xf0330000, 0x61107e48[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004830: 0x00000000, 0x00000301, 0x00000301, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004840: 0x0001da2e, 0x0001da2e, 0x000e2200, 0x74428c76[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004850: 0xa6e90047, 0x29eb05c2, 0x68676867, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004860: 0x02000074, 0x113e9403, 0x00100800, 0xea040008[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004870: 0x05ea4985, 0x003e1820, 0x003e1820, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004900: 0x28190404, 0x00305407, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004910: 0x000f001c, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004a00: 0x180303fe, 0x00200000, 0x00200020, 0x86970000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004a10: 0x755bcf20, 0x008ca924, 0x00200012, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004a20: 0x00000000, 0x00000000, 0xf02c0000, 0x755bcf80[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004a30: 0x00000000, 0x000001d8, 0x000001d8, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004a40: 0x755bcec0, 0x755bcee0, 0x755bcf00, 0x755bcf20[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004a50: 0x00200020, 0x00200020, 0x00200020, 0x00200020[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004a70: 0x28190404, 0x00305407, 0x000f001c, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004b00: 0x180303fe, 0x00360003, 0x30380000, 0x003601e0[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004b10: 0x003603d2, 0x00bf0383, 0x0036c2fc, 0x18002fdc[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004b20: 0x000000c6, 0x025c8000, 0x60380201, 0x0f360038[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004b30: 0x6028c641, 0x0f360038, 0x61106541, 0x0f360038[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004b40: 0x6028d181, 0x0fbf00c8, 0x01fad6cf, 0x746d725a[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004b50: 0xf0330000, 0x60380238, 0xaf040000, 0xc6b900c5[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004b60: 0xf0330000, 0x6028c678, 0xaf040000, 0x400001c9[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004b70: 0xf0330000, 0x61106578, 0xaf040000, 0x000000ff[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004b80: 0x020000b9, 0x113e9403, 0x00100800, 0xea040008[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004b90: 0x05ea4985, 0x28190404, 0x00305407, 0x000f001c[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004ba0: 0x00f000fb, 0x020000b9, 0x113e9403, 0x000f001c[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004bb0: 0x60439441, 0x6028d601, 0x649e9001, 0x6028d801[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004bc0: 0x60380202, 0x6028c642, 0x61106542, 0x6028d182[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004bd0: 0x60439040, 0x6028d602, 0x649e8c40, 0x6028d802[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004be0: 0x00360036, 0x00bf0036, 0x004205ea, 0x003605e2[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004bf0: 0xf0330000, 0x6028d248, 0xaf0c0000, 0x0000ffff[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004c00: 0x200003fe, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004c10: 0x0000002a, 0x00000000, 0x00000006, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004c20: 0x00000000, 0x00000000, 0x00000000, 0x00000006[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004c30: 0x00000000, 0x00000000, 0x00108000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004c40: 0x00000020, 0x00000000, 0x001d0020, 0x00040020[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004c50: 0xeb2e237e, 0x0037e5ad, 0xae1ec2e3, 0x637c5252[ 313.030524] tg3 0000:06:00.1 eth2: 0x00004c60: 0x00000020, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005000: 0x00009800, 0x80000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005010: 0x00000000, 0x00000000, 0x00000000, 0x08002044[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005020: 0x3c034000, 0x00000000, 0x00000000, 0x40000020[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005030: 0x00000000, 0x0000001d, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005040: 0x00000000, 0x00000000, 0x08000088, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005080: 0x00009800, 0x80004000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005090: 0x00000000, 0x00000000, 0x00000000, 0x080020ec[ 313.030524] tg3 0000:06:00.1 eth2: 0x000050a0: 0x30420001, 0x00000000, 0x00000000, 0x40000020[ 313.030524] tg3 0000:06:00.1 eth2: 0x000050b0: 0x00000000, 0x0000001d, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x000050c0: 0x00000000, 0x00000000, 0x08002052, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005100: 0x00009800, 0x80004000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005110: 0x00000000, 0x00000000, 0x00000000, 0x08002898[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005120: 0x3c034150, 0x00000000, 0x00000000, 0x40000020[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005130: 0x00000000, 0x0000001d, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005140: 0x00000000, 0x00000000, 0x0800288c, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005180: 0x00009800, 0x80000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005190: 0x00000000, 0x00000000, 0x00000000, 0x08000078[ 313.030524] tg3 0000:06:00.1 eth2: 0x000051a0: 0x00831824, 0x00000000, 0x00000000, 0x40000020[ 313.030524] tg3 0000:06:00.1 eth2: 0x000051b0: 0x00000000, 0x0000001d, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x000051c0: 0x00000000, 0x00000000, 0x08001a52, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005200: 0x01020000, 0x00000000, 0xc0000000, 0xc0000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005210: 0x14600027, 0xc0000000, 0x3c038000, 0x14600027[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005220: 0x08006f80, 0x00000000, 0x144001e5, 0x01020000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005230: 0x00000000, 0x400b2080, 0x00000000, 0x14600027[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005240: 0x08006f98, 0x3c038000, 0x14600027, 0x08002e44[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005250: 0xc0000000, 0x144001e5, 0x01020000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005260: 0xc0000000, 0x00000000, 0x14600027, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005270: 0x3c038000, 0x00000000, 0x00000b50, 0x80000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005280: 0x00009800, 0x80004000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005290: 0x00000000, 0x00000000, 0x00000000, 0x08000078[ 313.030524] tg3 0000:06:00.1 eth2: 0x000052a0: 0x00831824, 0x00000000, 0x00000000, 0x40000020[ 313.030524] tg3 0000:06:00.1 eth2: 0x000052b0: 0x00000000, 0x0000001d, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x000052c0: 0x00000000, 0x00000000, 0x08002898, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005300: 0x00009800, 0x80004000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005310: 0x00000000, 0x00000000, 0x00000000, 0x08002044[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005320: 0x27bdffe8, 0x00000000, 0x00000000, 0x40000020[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005330: 0x00000000, 0x0000001d, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005340: 0x00000000, 0x00000000, 0x08000088, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005380: 0x00009800, 0x80004000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005390: 0x00000000, 0x00000000, 0x00000000, 0x080020ec[ 313.030524] tg3 0000:06:00.1 eth2: 0x000053a0: 0x30420001, 0x00000000, 0x00000000, 0x40000020[ 313.030524] tg3 0000:06:00.1 eth2: 0x000053b0: 0x00000000, 0x0000001d, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x000053c0: 0x00000000, 0x00000000, 0x08002052, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005800: 0x52000000, 0x52000000, 0x3b000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005810: 0x63000000, 0x00000000, 0x3e000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005820: 0xc8000000, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005860: 0x00000000, 0x00000000, 0x000006c4, 0x000006c4[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005880: 0x0000037f, 0x0000037f, 0x000002e3, 0x000002e3[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005890: 0x000001ec, 0x000001ec, 0x000005ae, 0x000005ae[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005900: 0x000001f4, 0x000001f4, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005980: 0x000001f4, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00005a00: 0x000f601f, 0x00000000, 0x00010000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00006000: 0x00010082, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00006400: 0x00000000, 0x00000000, 0x00010891, 0xc0000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00006410: 0x0a000064, 0x0a000064, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00006430: 0x00000000, 0x14e4165f, 0x1786103c, 0x00020000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00006440: 0x0000304f, 0x000002e4, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x000064c0: 0x00000010, 0x00000004, 0x00001004, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x000064d0: 0x00000000, 0x10008d81, 0x00000000, 0x00315e22[ 313.030524] tg3 0000:06:00.1 eth2: 0x000064e0: 0x00000031, 0x0000001f, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x000064f0: 0x00000002, 0x00000031, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00006500: 0x01e10003, 0xfd8e8a9b, 0x00002c44, 0x00000003[ 313.030524] tg3 0000:06:00.1 eth2: 0x00006510: 0x0007811b, 0x00058116, 0x00046113, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00006550: 0x00000000, 0x02800000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x000065f0: 0x00000000, 0x00000109, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00006800: 0x141b0034, 0x20099082, 0x01020408, 0x0562f715[ 313.030524] tg3 0000:06:00.1 eth2: 0x00006810: 0x01020000, 0xffffffff, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00006830: 0xffffffff, 0xffffffff, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00006840: 0x00000000, 0x00000001, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00006890: 0x00000000, 0x88003800, 0x00000000, 0x04102040[ 313.030524] tg3 0000:06:00.1 eth2: 0x000068a0: 0x00000020, 0x00000001, 0x03ff03ff, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x000068b0: 0xe0011514, 0x00000000, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x000068e0: 0x00000000, 0x00000000, 0x00000000, 0x0004c728[ 313.030524] tg3 0000:06:00.1 eth2: 0x000068f0: 0x00ff000e, 0x00ff0000, 0x00000000, 0x04444444[ 313.030524] tg3 0000:06:00.1 eth2: 0x00006900: 0xe9677f18, 0x148837a7, 0x00000000, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00006920: 0x00000000, 0x00000000, 0x00000001, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00007000: 0x08000008, 0x00000000, 0x00000000, 0x00004af4[ 313.030524] tg3 0000:06:00.1 eth2: 0x00007010: 0x6078fa0d, 0x01c080f1, 0x00d70081, 0x03008200[ 313.030524] tg3 0000:06:00.1 eth2: 0x00007020: 0x00000000, 0x00000000, 0x00000406, 0x10004000[ 313.030524] tg3 0000:06:00.1 eth2: 0x00007030: 0x00060000, 0x00004af8, 0x00160030, 0x00000000[ 313.030524] tg3 0000:06:00.1 eth2: 0: Host status block [00000001:00000052:(0000:05f9:0000):(0000:01c7)][ 313.030524] tg3 0000:06:00.1 eth2: 0: NAPI info [00000052:00000052:(01f4:01c7:01ff):0000:(0082:0000:0000:0000)][ 313.030524] tg3 0000:06:00.1 eth2: 1: Host status block [00000001:000000b0:(0000:0000:0000):(060c:0000)][ 313.030524] tg3 0000:06:00.1 eth2: 1: NAPI info [000000b0:000000b0:(0000:0000:01ff):060c:(060c:060c:0000:0000)][ 313.030524] tg3 0000:06:00.1 eth2: 2: Host status block [00000001:000000a3:(0553:0000:0000):(0000:0000)][ 313.030524] tg3 0000:06:00.1 eth2: 2: NAPI info [000000a3:000000a3:(0000:0000:01ff):0553:(0553:0553:0000:0000)][ 313.030524] tg3 0000:06:00.1 eth2: 3: Host status block [00000001:00000066:(0000:0000:0000):(0000:0000)][ 313.030524] tg3 0000:06:00.1 eth2: 3: NAPI info [00000066:00000066:(0000:0000:01ff):043f:(043f:043f:0000:0000)][ 313.030524] tg3 0000:06:00.1 eth2: 4: Host status block [00000001:0000000d:(0000:0000:081c):(0000:0000)][ 313.030524] tg3 0000:06:00.1 eth2: 4: NAPI info [0000000d:0000000d:(0000:0000:01ff):081c:(001c:001c:0000:0000)][ 313.140630] tg3 0000:06:00.1: tg3_stop_block timed out, ofs=1400 enable_bit=2[ 313.241957] tg3 0000:06:00.1: tg3_stop_block timed out, ofs=c00 enable_bit=2[ 313.316238] tg3 0000:06:00.1 eth2: Link is down[ 315.395006] tg3 0000:06:00.1 eth2: Link is up at 100 Mbps, half duplex[ 315.397025] tg3 0000:06:00.1 eth2: Flow control is off for TX and off for RX[ 315.397025] tg3 0000:06:00.1 eth2: EEE is disabled
id=76971	(from #72551)Can't adjust brightness with widget or fn+F6-F7.acpidump fails:#acpidumpCannot map /dev/memCould not map table at 0x00000000000F0030 length FEDA0000Could not get ACPI tables, AE_ACCESS# ls /sys/class/backlightacpi_video0 intel_backlight toshibaThis works:/sys/class/backlight/intel_backlight$ sudo -s[sudo] password for raphael: root@alphonse:/sys/devices/pci0000:00/0000:00:02.0/drm/card1/card1-eDP-1/intel_backlight# echo 700 > brightness root@alphonse:/sys/devices/pci0000:00/0000:00:02.0/drm/card1/card1-eDP-1/intel_backlight# echo 1000 > brightness interesting lines of acpi_listen:video/brightnessup BRTUP 00000086 00000000 Kvideo/brightnessdown BRTDN 00000087 00000000 Ktried video.use_native_backlight=1 in boot cmdline, and it works: I can set backlight in seven step, but auto settings doesn't (when power supply is out, doesn't diminish etc...) CreatedacpidumpPlease try this version. Also, please attach your dmi info:# dmidecode > dmi.txtCreatedacpidumpCreateddmidecodeyes, your version works...Ping aaron...With 3.16, the default will be using intel_backlight, so I think it's already fixed with v3.16-rc1:commit 751109aad5834375ca9ed0dcfcd85a00cbf872b5Author: Rafael J. Wysocki <>Date: Thu Jun 5 22:47:35 2014 +0200 ACPI / video: Change the default for video.use_native_backlight to 1BlindeKinder,Can you please test v3.16-rc1 or a later kernel? Thanks.yes, it works with 3.16. But it doesn't auto adjust when unplugging power supply.What GUI are you using?I use Gnome-shell 3.10.4Sounds like a lack of functionality of the GUI?I just tried MATE 1.6 on Fedora 19, when I unplug the AC adapter, the backlight is smoothly decreased to half of the current level; and when I plug the adapter, the level is restored. Though the cut it to half sounds not very good, but the GUI indeed did something on adapter plug/unplug.sorry, I reopen, I tried some things around 3.16-rc1 and brightness: impossible adjust brightness after sleep, and it wakes up with ~50%...Sounds two problems?1 impossible adjust brightness after sleep2 doesn't wake up from suspend to memCorrect?For 1, after resume, does the sysfs interface work?To verify:# cd /sys/class/intel_backlight# echo XXX > brightnessFor 2, does v3.15 resume OK? If so, it may be a regression. Please test latest Linus' tree, if problem is also there, open a new bug under the PM/Suspend/Hibernation category. Thanks.I'm not sure I understood point 2: it wakes up, but with ~50% brightness and impossible to adjust.I tried 3.16 rc 5, can't adjust at all: after boot, after sleep, even with acpi boot options (acpi_csi=Linux acpi_backlight=vendor).I misunderstood the ~50%, I thought the system doesn't wake up about ~50% of the time while you obviously mean the backlight level is ~50% after wake up.So after wakeup, does the intel_backlight interface still work?pingSorry for the delay, I was out...I tried 3.16 final, same as.It works with intel_backlight, but now schortcuts (fn) doesn't (just like #72551):^[[18;2~battery PNP0C0A:00 00000080 00000001^[[18;2~^[[18;2~battery PNP0C0A:00 00000080 00000001^[[18;2~battery PNP0C0A:00 00000080 00000001battery PNP0C0A:00 00000080 00000001^[[17;2~battery PNP0C0A:00 00000080 00000001^[[17;2~^[[17;2~battery PNP0C0A:00 00000080 00000001^[[17;2~^[[17;2~^[[17;2~battery PNP0C0A:00 00000080 00000001^[[17;2~^[[17;2~^[[17;2~^[[17;2~battery PNP0C0A:00 00000080 00000001^[[17;2~^[[17;2~^[[17;2~battery PNP0C0A:00 00000080 00000001Did your hotkey(fn) ever work before?CreatedUse alternative keymapPlease test this patch, see if the hotkey works now. Apply on top of v3.16.Sorry, I can't find info on how to apply this patch, not very familiar with kernel compilation... any suggestion?Usually, it is like this:$ git clone$ git apply the_provided_patchbuild kernel and test.If it doesn't apply cleanly, set tree to v3.16 first:$ git reset --hard v3.16$ git apply the_provided_patchok i'll try but i cant download the patch... the link goes to code browserRight click and then choose save.any update?I get an attachment.cgi file, but says: 'fatal: input [or entry?] not recognized' on apply... (my translation)ok I finally succeeded.yes, now it works, without any boot args, and also after wake up. Need more infos?No need, I'll submit that patch and cc you.Patch sent:commit b1bde689dde0d5de9e974390f9a0859a7ec5fd1bAuthor: Aaron Lu <>Date: Thu Oct 23 16:18:02 2014 +0800 toshiba_acpi: Add Toshiba TECRA A50-A to the alt keymap dmi listAgain on 4.4.04...Still on 14.04.
id=15950	Kernel 2.6.31 and at least some earlier kernels.I'm using an old Microtek ScanMaker flatbed scanner connected to a DC395x SCSI card.dc395x 0000:01:07.0: PCI INT A -> Link[APC2] -> GSI 17 (level, low) -> IRQ 17dc395x: Used settings: AdapterID=07, Speed=0(20.0MHz), dev_mode=0x57dc395x: AdaptMode=0x0f, Tags=4(16), DelayReset=1sdc395x: Connectors: ext50 Termination: Auto Low High dc395x: Performing initial SCSI bus resetscsi0 : Tekram DC395(U/UW/F), DC315(U) - ASIC TRM-S1040 v2.05, 2004/03/08scsi 0:0:6:0: Scanner Scanner 1.80 PQ: 0 ANSI: 4 CCSscsi 0:0:6:0: Attached scsi generic sg0 type 6sata_nv 0000:00:05.0: version 3.5When scanning with xsane, after a few minutes I often get a hang in xsane and if I forcibly kill xsane, the scanner is no longer there. When the xsane hang occurs, I see this:dc395x: reselect: w/o disconnected cmds <06-0>dc395x: disconnect: Unexpected reselection <06-0>I'm not sure when this problem started, but it's somewhere in the 2.6.2x region.I'd be happy to recompile, test and debug if needed.Thanks,Tom Reply-To:On Sun, 2010-05-09 at 21:19 +0000,wrote:Retesting isn't necessary. There have only been nine changes to thatdriver in 2.6.2x. The versions of interest (as in works/doesn't work)should be2.6.26 (should be identical to 2.6.31, so just a something else changedsanity check)2.6.25 (lots of pointless changes + sense buffer replacement)2.6.34 (pid removal and sg chaining)2.6.23 (accessors change)2.6.22 (spelling only fix!)JamesI downloaded the .1 versions of kernel's 2.6.22 through 2.6.26, andfound that 2.6.25 and above had no changes in the dc395x.c file, butthat a variety of changes were introduced in 2.6.24 and below. Sincethe older dc395x.c doesn't drop into my current 2.6.31 kernel, I triedrecompiling and running 2.6.24 without success. On Gentoo, thecurrent udev doesn't work with that older kernel, so things likenetworking and X fail to run properly and I was unable to test thescanner. Suggestions?TomOn Sun, May 9, 2010 at 6:07 PM, <> wrote:>>>>>>>>>>>I downloaded the .1 versions of kernel's 2.6.22 through 2.6.26, andfound that 2.6.25 and above had no changes in the dc395x.c file, butthat a variety of changes were introduced in 2.6.24 and below. Sincethe older dc395x.c doesn't drop into my current 2.6.31 kernel, I triedrecompiling and running 2.6.24 without success. On Gentoo, thecurrent udev doesn't work with that older kernel, so things likenetworking and X fail to run properly and I was unable to test thescanner. Suggestions?TomOn Mon, 10 May 2010,wrote:You can use the command-line sane interface scanimage (from the sane-utils package).ThanksGuennadi---Guennadi Liakhovetski, Ph.D.Freelance Open-Source Software DeveloperGuennadi - good call.I was able to go back to kernel 2.6.22.1 (through 2.6.25/24/23) and all versions exhibit the same behavior. With the command-line scanimage software, I eventually see an error returned and the driver resets after a two minute delay.I've removed the regression flag from this bug, but still think there's a problem.TomReopening. Not obsolete. Reproduceable in 3.5.3, which is what I'm using at present. (I can upgrade to a newer version if need-be.)No need - there is one obscure bug fix in early 2013, but nothing else since 2010. You may be the only person on the planet who still uses one!Could be. Haven't found another inexpensive SCSI adapter.I say the driver probably needs to get fixed or removed, though. No point in having it in the kernel giving folks false hope that it'll work!
id=42980	BUG: unable to handle kernel paging request at ffff87ffffffffffIP: [<ffffffffa03311b7>] __direct_map.clone.86+0xa7/0x240 [kvm]PGD 0 Oops: 0000 [#1] PREEMPT SMP CPU 0 Modules linked in: tun cdc_ether usbnet cdc_acm fuse usbmon pci_stub kvm_intel kvm netconsole configfs cfq_iosched blk_cgroup snd_seq_oss snd_seq_midi_event snd_seq bridge snd_seq_device ipv6 snd_pcm_oss snd_mixer_oss stp llc coretemp hwmon usblp snd_hda_codec_hdmi snd_hda_codec_realtek usb_storage ftdi_sio usbserial usbhid hid snd_hda_intel i915 snd_hda_codec drm_kms_helper snd_hwdep drm snd_pcm firewire_ohci tpm_tis 8139too tpm firewire_core xhci_hcd i2c_algo_bit snd_timer 8250_pci 8250_pnp ehci_hcd usbcore snd e1000e 8250 tpm_bios crc_itu_t serial_core snd_page_alloc sg rtc_cmos psmouse i2c_i801 mii usb_common video evdev ata_generic pata_acpi buttonPid: 9995, comm: qemu-system-x86 Not tainted 3.2.2-gentoo #1 /DQ67SWRIP: 0010:[<ffffffffa03311b7>] [<ffffffffa03311b7>] __direct_map.clone.86+0xa7/0x240 [kvm]RSP: 0018:ffff88010bc39b08 EFLAGS: 00010293RAX: ffff87ffffffffff RBX: 000ffffffffff000 RCX: 0000000000000027RDX: 0000000029b55000 RSI: 0000000000000004 RDI: 0000000000000003RBP: ffff88010bc39bb8 R08: ffff87ffffffffff R09: 0000000000113661R10: 00000000c174f000 R11: 080000000000d974 R12: ffff880000000000R13: ffff8803b7e6c240 R14: 0000000000000001 R15: 0000000000000001FS: 0000000000000000(0000) GS:ffff88043e200000(0063) knlGS:00000000f5ffab70CS: 0010 DS: 002b ES: 002b CR0: 0000000080050033CR2: ffff87ffffffffff CR3: 00000001027f1000 CR4: 00000000000426e0DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400Process qemu-system-x86 (pid: 9995, threadinfo ffff88010bc38000, task ffff88000bc154f0)Stack: ffff8803b7e6c240 ffff88010bc39bf0 0000000000000000 0000000000029b55 ffff88010bc39b38 ffffffffa031ae14 00ff88010bc39bb8 0000000000000000 0000000000113661 0000000000029b55 0000000029b55000 ffffffffffffffffCall Trace: [<ffffffffa031ae14>] ? gfn_to_pfn_prot+0x14/0x20 [kvm] [<ffffffffa03316c0>] tdp_page_fault+0x1a0/0x1e0 [kvm] [<ffffffffa032d2e2>] kvm_mmu_page_fault+0x32/0xb0 [kvm] [<ffffffffa0362bec>] handle_ept_violation+0x4c/0xd0 [kvm_intel] [<ffffffffa0368ff4>] vmx_handle_exit+0xb4/0x6f0 [kvm_intel] [<ffffffff8103afad>] ? sub_preempt_count+0x9d/0xd0 [<ffffffffa0329e23>] kvm_arch_vcpu_ioctl_run+0x473/0xf40 [kvm] [<ffffffff8103afad>] ? sub_preempt_count+0x9d/0xd0 [<ffffffffa03197c2>] kvm_vcpu_ioctl+0x392/0x5e0 [kvm] [<ffffffffa031a3ed>] ? kvm_vm_ioctl+0x9d/0x410 [kvm] [<ffffffff81315529>] ? sys_sendto+0x119/0x140 [<ffffffffa0319a65>] kvm_vcpu_compat_ioctl+0x55/0x100 [kvm] [<ffffffff810f81df>] ? fget_light+0x8f/0xf0 [<ffffffff8113ee2e>] compat_sys_ioctl+0x8e/0xff0 [<ffffffff8105df3c>] ? posix_ktime_get_ts+0xc/0x10 [<ffffffff8105f190>] ? sys_clock_gettime+0x90/0xb0 [<ffffffff810860db>] ? compat_sys_clock_gettime+0x7b/0x90 [<ffffffff813c34c9>] sysenter_dispatch+0x7/0x27Code: 89 d0 8d 4c ff 0c 4d 89 e0 48 d3 e8 4c 03 45 a8 25 ff 01 00 00 41 39 f6 89 45 bc 89 c0 49 8d 04 c0 48 89 45 b0 0f 84 e1 00 00 00 <4c> 8b 00 41 f6 c0 01 74 40 4c 8b 0d 89 80 01 00 4d 89 c2 4d 21 RIP [<ffffffffa03311b7>] __direct_map.clone.86+0xa7/0x240 [kvm] RSP <ffff88010bc39b08>CR2: ffff87ffffffffff---[ end trace 4db76b33c09285f5 ]---note: qemu-system-x86[9995] exited with preempt_count 1usb 2-1.2: USB disconnect, device number 77INFO: rcu_preempt detected stall on CPU 3 (t=60000 jiffies)Pid: 3610, comm: kwin Tainted: G D 3.2.2-gentoo #1Call Trace: <IRQ> [<ffffffff810a2949>] __rcu_pending+0x1d9/0x420 [<ffffffff8106f920>] ? tick_nohz_handler+0xe0/0xe0 [<ffffffff810a2f62>] rcu_check_callbacks+0x122/0x1a0 [<ffffffff810504c3>] update_process_times+0x43/0x80 [<ffffffff8106f97b>] tick_sched_timer+0x5b/0xa0 [<ffffffff81063873>] __run_hrtimer.clone.30+0x63/0x140 [<ffffffff810641af>] hrtimer_interrupt+0xdf/0x210 [<ffffffff8101d643>] smp_apic_timer_interrupt+0x63/0xa0 [<ffffffff813c2b8b>] apic_timer_interrupt+0x6b/0x70 <EOI> [<ffffffff810b69a2>] ? __pagevec_free+0x22/0x30 [<ffffffff813c1862>] ? _raw_spin_lock+0x32/0x40 [<ffffffff813c1846>] ? _raw_spin_lock+0x16/0x40 [<ffffffffa0319c3c>] kvm_mmu_notifier_invalidate_page+0x3c/0x90 [kvm] [<ffffffff810e31c8>] __mmu_notifier_invalidate_page+0x48/0x60 [<ffffffff810d6ce5>] try_to_unmap_one+0x3c5/0x3f0 [<ffffffff810d762d>] try_to_unmap_anon+0x9d/0xe0 [<ffffffff810d7715>] try_to_unmap+0x55/0x70 [<ffffffff810e8d21>] migrate_pages+0x2f1/0x4d0 [<ffffffff810e1ec0>] ? suitable_migration_target+0x50/0x50 [<ffffffff810e271f>] compact_zone+0x44f/0x7a0 [<ffffffff810e2c07>] try_to_compact_pages+0x197/0x1f0 [<ffffffff810b7026>] __alloc_pages_direct_compact+0xc6/0x1c0 [<ffffffff810b74f9>] __alloc_pages_nodemask+0x3d9/0x7a0 [<ffffffff813c14b0>] ? _raw_spin_unlock+0x10/0x40 [<ffffffff810cd2fb>] ? handle_pte_fault+0x3bb/0x9f0 [<ffffffff810ec831>] do_huge_pmd_anonymous_page+0x131/0x350 [<ffffffff810cdcae>] handle_mm_fault+0x21e/0x300 [<ffffffff81027dad>] do_page_fault+0x12d/0x430 [<ffffffff810d3854>] ? do_mmap_pgoff+0x344/0x380 [<ffffffff813c1cef>] page_fault+0x1f/0x30 0: 89 d0 mov %edx,%eax 2: 8d 4c ff 0c lea 0xc(%rdi,%rdi,8),%ecx 6: 4d 89 e0 mov %r12,%r8 9: 48 d3 e8 shr %cl,%rax c: 4c 03 45 a8 add -0x58(%rbp),%r8 10: 25 ff 01 00 00 and $0x1ff,%eax 15: 41 39 f6 cmp %esi,%r14d 18: 89 45 bc mov %eax,-0x44(%rbp) 1b: 89 c0 mov %eax,%eax 1d: 49 8d 04 c0 lea (%r8,%rax,8),%rax 21: 48 89 45 b0 mov %rax,-0x50(%rbp) 25: 0f 84 e1 00 00 00 je 0x10c 2b: 4c 8b 00 mov (%rax),%r8 2e: 41 f6 c0 01 test $0x1,%r8b 32: 74 40 je 0x74 34: 4c 8b 0d 89 80 01 00 mov 0x18089(%rip),%r9 # 0x180c4 3b: 4d 89 c2 mov %r8,%r10Appears to be __direct_map()'s if (!is_shadow_present_pte(*iterator.sptep)) { u64 base_addr = iterator.addr;%rax is 0xffff87ffffffffff. That is one less than the base of the direct map of all physical memory. So it looks like the codestatic bool shadow_walk_okay(struct kvm_shadow_walk_iterator *iterator){ if (iterator->level < PT_PAGE_TABLE_LEVEL) return false; iterator->index = SHADOW_PT_INDEX(iterator->addr, iterator->level); iterator->sptep = ((u64 *)__va(iterator->shadow_addr)) + iterator->index; return true;}saw iterator->shadow_addr == -1ULL.That might be INVALID_PAGE assigned to pae_root (but that is masked out in shadow_walk_init()) or a stray -1 due to a completely unrelated bug.Anything interesting about how this was triggered?IIRC, it was pretty out of the blue. I might have had one or both of two KVMs running in the background at the time:- 64-bit Gentoo with a Radeon 5850 passthrough'd (VT-d)- 32-bit Ubuntu with a nested 32-bit KVMYou're a brave one.It wasn't the nested one (at least, it wasn't running in the guest's guest at the moment of the crash), but it might be related.I suppose I should mention I'd been running both of these stable for at least a month now (and the GPU passthrough for nearly a full year). One factor that might (or might not) be related - the GPU fan recently died. When this crash took me down, I removed the GPU, so I won't be able to do any further testing with that setup (unless I find another similar GPU at a good price).vcpu_enter_guest() kvm_mmu_reload() // now root_hpa is valid inject_pending_event() vmx_interrupt_allowed() nested_vmx_vmexit() load_vmcs12_host_state() kvm_mmu_reset_context() // root_hpa now invalid kvm_guest_enter() ... page fault because root_hpa is invalid, oopsCreatedFixPlease test the attached patch.Is there anything I can do to reproduce the problem condition for the test? It seems to only occur about once every 6 months normally.Try running while :; do :; donein the nested (L2) guest, and ping -f the L1 guest from the host.The while/ping thing doesn't reproduce it even before the patch. :(For what it's worth, no crashes in over a month. But it wasn't common enough that it can't be coincidence either...A patch referencing this bug report has been merged in Linux v3.5-rc1:commit d8368af8b46b904def42a0f341d2f4f29001fa77Author: Avi Kivity <>Date: Mon May 14 18:07:56 2012 +0300 KVM: Fix mmu_reload() clash with nested vmx event injectionSorry I didn't report it sooner, but I have had the same crash since June, with this patch. :(Which kernel ?I'm not sure if it was 3.4.0, 3.4.3, or 3.4.4. Since May 17, I have been building all my kernels (including those) with this patch applied.3.4.0:ThanksI just hit this.Host: Intel DQ67SW, Core i7 2600, 24GB RAMBIOS: SWQ6710H.86A.0065.2012.0917.1519Host OS: Fedora 17 kernel-3.6.6-1.fc17.x86_64 qemu-kvm-1.2.0-20.fc17.x86_64L1 Guest OS: RHEL 6.3 kernel-2.6.32-279.14.1.el6.x86_64 qemu-kvm-rhev-0.12.1.2-2.295.el6_3.5.x86_64L2 Guest OS: RHEL 6.3 kernel-2.6.32-279.14.1.el6.x86_64I was running a Pulp sync between a couple of L2 guests when this occurred, which presumably generated quite a bit of traffic across the virtual bridges. I am using Open vSwitch for all of the bridges on the host OS. The virtualized RHEV hypervisors use standard Linux bridges.Please let me know if I can provide any additional information to help track this down.(In reply to)Silly question. Is this patch applicable to the physical host, the L1 guest (virtualized hypervisor), or both?On 11/18/2012 12:10 AM,wrote:The physical host. If you want to run a hypervisor in L2, you need toapply it to L1 as well.(In reply to)OK. If I'm parsing that correctly, it sounds like backporting the patch to the RHEL 6 kernel, so I could run it in the L1 hypervisors, wouldn't help anything.Bummer.Any ideas on how I can make this environment stable?I see that Luke-Jr is also on a DQ67SW, and he's doing PCI passthrough. I do have VT-d enabled, although I'm not actually doing any PCI-passthrough. I that something that could be related to this?I just hit this again (I think). Pretty much out of the blue, with a bunch of VMs running, including at least 2 nested guests.I have been trying to get a kdump of this, and I believe that I was at least somewhat successful. The system didn't dump automatically, but I was able to get it to do so by hitting alt-sysrq-c. The vmcore file is 3.7G, so suggestions as to a place to post it publicly would be appreciated.Please tell against a newer kernel. This bug seems obsolete to me as ofkernel versions released in 2014 time frame.Cheers Nick
id=13941	Subject : x86 Geode issues in kernel >= 2.6.23 and >= 2.6.31-rc4Submitter : "Martin-Éric Racine" <>Date : 2009-08-03 12:58References :This entry is being used for tracking a regression from 2.6.29. Please don'tclose it until the problem is fixed in the mainline. shows a snapshot of the kernel panic in action.FYI Ubuntu's 2.6.31-5.24 package is based on upstream 2.6.31-rc5.shows an updated snapshot of the kernel panic, this time against 2.6.31-rc6.PS:is where the thread about this issue started.PS: contrary to what Rafael said above, this tracks a regression starting with 2.6.31-rcX. Kernels up to and including 2.6.30 are not affected.Yes, that was a mistake, sorry. The right meta-bug is linked, though.Working with Martin-Éric in the Launchpad bug, a bisect seemed to narrow down the following commit:f19d4a8fa6f9b6ccf54df0971c97ffcaa390b7b0 is first bad commitcommit f19d4a8fa6f9b6ccf54df0971c97ffcaa390b7b0Author: Al Viro <>Date: Mon Jun 8 19:50:45 2009 -0400 add caching of ACLs in struct inode No helpers, no conversions yet. Signed-off-by: Al Viro <>On Thursday 20 August 2009, Martin-Éric Racine wrote:On Wednesday 26 August 2009, Martin-Éric Racine wrote:On Sunday 06 September 2009, Martin-Éric Racine wrote:Erm... What issupposed to be about?This is not complete yet, but to give a current status and maybe someone has an idea about the origins. Both, bisecting and looking at the panic show that the code added with the ACL caching framework is the place where the panic happens. The bug happens when __destroy_inode tries to free the i_acl structure. From the disassembly and the panic it can be seen that 0xffffb4ff is the content of i_acl. This looks like the value for ACL_NOT_CACHED (0xffffffff) was partially overwritten by a single byte value.Experimentally swapping around the order of the acl pointers behind the previously existing private pointer lets the system boot.So this might be either an issue with geode which has always being around but went unnoticed as the private pointer was not used or something accesses the inode structure directly with an offset hoping to find the private pointer at that place.On Monday 26 October 2009, Martin-Éric Racine wrote:It should be noted that Stefan Bader has done a significant amount of work to help me narrow down the cause of this bug. He has produced a number of patches that improve the amount and quality of debug info sent by this new ACL caching code and I have routinely submitted a number of dmesg outputs to match. At this point, the collaboration of the LKML to analyze the results and fix the regression introduced by the addition of ACL caching would be extremely desirable.CreatedDebug patch that shows the corruptionWith this patch added to the crashing kernel on the Geode, the invalid pointers get detected and reported. The debug logs show a vast majority (I believe I only saw one single different case) of detections on destroy.CreatedDebug v2 to v5 diffThis is the diff between v2 and v5 of my debugging patches. The interesting part is that solely by immediately testing (reading back) the values of the acl pointers, the problem seems to go away. So really, this sounds like some strange interaction of processor and caches than a race condition. Especially as there have been runs with SMP set to off and still corruption was observed.I can't reproduce it on the hardwares I have here. I use 2.6.31.6 with following patches applied above of it: - BFS - AUFS2and it works well for all LX and GX hardware I have with me.OK, closing as unreproducible. If anyone can reproduce it with 2.6.31.6, please feel free to reopen.I can still reproduce it with 2.6.31.6 and with 2.6.32, so, no, you cannot close it.PS: and as it seems that I cannot re-open it myself, please do it for me.I'm unable to reproduce this bug w/ 2.6.33-rc2, built with gcc version 4.3.2 (Debian 4.3.2-1.1). This really needs a .config supplied in order to reproduce it (I'm started to suspect that this is ubuntu-specific).Martin or Stefan, can you please supply the .config that you're using?I should also note that I am using ext3 w/ POSIX_ACLs enabled, on an LX w/ the following root:/dev/hda1 / ext3 rw,noatime,errors=continue,data=writeback 0 0Createdkernel configThis is the config used on Ubuntu kernels.Here, what I have is the following (replace /dev/hda1 with an UUID statement):/dev/hda1 / ext4 defaults,relatime,errors=remount-ro 0 1Can you please provide a newer .config that the problem occurs with? oldconfig wants to make some large changes to the config when I attempt to use 2.6.32 (and 2.6.31-rc5 fails to build).CreatedThis is Ubuntu's 2.6.32 config.With that .config and 2.6.32 on ext3, I'm afraid that I'm still unable to reproduce theproblem.Things to check: - Are you positive that you're using ext3 and not ext4? - Try building a vanilla 2.6.32 kernel; this may be broken due to a patch thatUbuntu has added - Try building the Ubuntu kernel on an older compiler (I'm using 4.3.2 (Debian4.3.2-1.1)). It could be a compiler bug..Could this be a change in the host compiler to default to -march=i686? This has been reported on Fedora 12, that building the decompression code uses the default arch setting rather than what was set in Kconfig. See:I tried both ext3 and ext4. Same crash regardless.The Ubuntu guys maintain builds of stock kernels i.e. upstream vanilla kernels with the default configuration, packaged as a .deb for convenience, as reference material to test for precisely this sort of regressions. I got the same crash when testing with those.Given Peter's assumption and Andres' third idea, I'd be tempted to blame it on recent host compiler defaults changes.Could Leann or Stefan please point me to instructions on building their stock 2.6.32-9-generic kernel? It's gonna take forever to complete, but I could launch a build of that on the Geode host itself, install it and see if that one boots.Peter: given how recent GCC produce broken i386 code anyhow, would -march=i486 or -march=i586 make more sense as a default base level for x86 kernels?Not sure how recent gcc produces broken i386 code, example please.Either way, there really isn't any point in deviating for -march=i386; even with -march=i686 the differences are minimal (a handful of CMOV).Trying "apt-get --compile source linux-image-2.6.32-9-generic" on the Geode now. I'll report ASAP on whether the resulting package boots any better or not.Repeatedly trying to build 2.6.32 with Peter Anvin's patch following instructions atconsistently fails: CC arch/x86/kernel/alternative.o CC arch/x86/kernel/i8253.o CC arch/x86/kernel/pci-nommu.o CC arch/x86/kernel/tsc.o CC arch/x86/kernel/io_delay.o CC arch/x86/kernel/rtc.o CC arch/x86/kernel/trampoline.o CC arch/x86/kernel/process.oarch/x86/kernel/process.o: final close failed: File truncatedmake[5]: *** [arch/x86/kernel/process.o] Error 1make[4]: *** [arch/x86/kernel] Error 2make[3]: *** [arch/x86] Error 2make[2]: *** [sub-make] Error 2make[1]: *** [/home/q-funk/Projektit/linux-2.6.32/debian/stamps/stamp-build-generic] Error 2make: *** [binary-generic] Error 2This is on a system with 1 GB of RAM and plenty of hard-disk space, so I'm really not sure how this "file truncated" keeps on showing up.Stefan and I built new packages with Peter's patch, but this did not fix it either. Rather, the problem very much seems related to the new ACL caching code.I would not say it is so much related as on this specific hw it shows up with a high chance as a bug in this code. But as it shows in testing, the difference between a working kernel and one that shows the problem is not what the code does, but how long it takes. The only things added were printk's of the cached acl values while allocating the inode and all of a sudden there is no corruption.The same code works on other platforms. At least I don't know of any report that looks like this. Also we cannot say it did not happen before. Just with the acl code there is code in place which visibly crashes at that point. If other structures or fields are affected this might "just" lead to weird effects.We had tests with smp disabled and still got the same issue.Up to now I cannot recall a completely positive reproduction of someone else with the exactly same hw and kernel. So a very very odd hw specific issue cannot be ruled out 100%.The only other option would be a architecture specific problem. Either running at a speed that then allows the allocation being interrupted at an inconvenient time and leaving register values incorrectly. That might probably be some SMI interrupt. But on the other hand I could not really explain why this changes with the additional printks as the occurance of an interrupt would unlikely be related to the speed of the running main thread.Would it be possible that such an interrupt disrupts something like the transfer between cache and memory and that an added read for some reason also causes that value to be written out?Createddmesg -rIt seems that we have some progress.In an attempt to debug this issue, I compared notes with someone on Fedora for whom the same hardware works. As a test, I used their kernel 2.6.31 config (with a couple of small modifications to build specific drivers as built-in) to build my own kernel. Much to my amazement, this kernel boots fine, as long as I specify root=/dev/sda1 on the GRUB cmdline instead of the usual root=UUID=unique-filesystem-hash.However, for some reason, an initrd.img was not automatically created upon installing this custom kernel package. Yet, as soon as I created one using "sudo update-initramfs -k 2.6.31.12-geodelx -c" and rebooted, the kernel failed to boot as before.Just to be safe, I deleted the initrd and rebooted again, letting "udev" perform its work after /sbin/init has been launched by the kernel. Lo and behold, it worked again!As such, it seems that something that gets included in the initramfs image is what messes with the ACL and destroys some inodes and makes the kernel crash in a non-recoverable way.Interestingly enough, we still get the previous error messages about destroyed inodes when booting with this barebone kernel, without an initrd.img, but the error is non-fatal. The output of dmesg -r is attached.Createddmesg -r on kernel 2.6.32This is what shows on Ubuntu's stock kernel for their upcoming Lucid 10.4 release, if I purposely purge the initrd.img and let the kernel boot using whatever drivers it has built-in. As you can see, we indeed succeed at booting, however vcons support doesn't work and, for obvious reasons, whatever goodies we expect to find in the initramfs image are also missing. However, the advantage is that the error I've mentioned appears as usual, but in a non-fatal way. Hopefully, the attached dmesg output can help the LKML developers determine what messes with sysfs on this host.Kernel 2.6.36 magically fixed this. The fix would need to be backported to kernels newer than 2.6.30.Thanks for the heads-up. Regarding the backport... can you use git-bisect to find the fix? Else we have nothing to backport. I'm closing this as unreproducible in the meantime. If you happen to find the fix, please post that here!The issue returned as of 2.6.38-rc1 on the same hardware.Is it still somehow related to the initrd? I.e. can you get 2.6.38-rc7 (or later) to boot without an initrd while with the initrd it does not?2.6.38 final seems to work again as intended, with or without initrd.Nice. Thanks for the update. I'm closing this as unreproducible, since we don't know which commit fixed it.Reopening:If I understand correctly, each kernel version reliably works or doesn't work, but this symptom comes and goes from one kernel version to the next. What kernels have you tested, and what happened with each?Do you think this is a timing-related or memory layout related problem? Any ideas for distinguishing between the two?Ping? I really am curious about that list of kernels you have tested and results, if you happen to have that information available.The issue comes and goes. As I recall, this happens whenever someone changes something in the inode ACL code. I don't have a clue about what causes it.Kernel 3.2 is the last one that works for me.I can reproduce this with 3.4.7, 3.5 and 3.5.1.This bug is old. Please tell against a newer kernel to see if this is still a valid kernel bug.Cheers NickHello to all of you!I can confirm that the bug is there in 3.14.0 and > 2.6.26I tried 2.6.30.10 2.6.32.63 2.6.36 2.6.38.8None of them worksI upgraded recently one such Geode GX-MMX machine from lenny to wheezy and tried to compile more recent kernel few months ago, however all of this failed and finally came along this thread.To verify the source of the issue I downloaded and rebuild almost same 2.6.26 that was working since 2008. This works (despite some issues with gcc-4.7 and with update-initramfs).All the rest is hanging with some mangled output on the consolecat /proc/cpuinfoprocessor : 0vendor_id : Geode by NSCcpu family : 5model : 5model name : Geode(TM) Integrated Processor by National Semiflags : fpu de pse tsc msr cx8 pge cmov mmx mmxext 3dnowext 3dnowbogomips : 665.94thanks in advanceI don't actually have any Geode hardware (haven't for some years) but if you know which was the last release that worked, and which was the first that didn't then it may still be possible to chase downCan you give some short instructions how to proceed?I did not find any patches for 2.6.26So we know that 2.6.26 and 2.6.26.2 is working 2.6.30 is not.Actually I'm more interested in getting something above 2.6.32 working.Is there a chance that this testing can be done on newer version?The absolutely best would be if you could do a "git bisect" between 2.6.26 and 2.6.30.I want to draw the baseline for this testing- compiling is done on Intel 64bit for Geode GX-MMX - compiler is gcc-4.7 on debian wheeze- working config for 2.6.26 used as baseline make ARCH=i386 oldconfig- compiling with make ARCH=i386 -j4 all- added some additional options to gcc Makefile HOSTCC = gcc -m32 -m3dnow -maes -mmmx HOSTCXX = g++ -m32 -m3dnow -maes -mmmxStarting with kernel 2.6.27.1 ( and in 2.6.26 )1. In arch/x86/vdso/Makefile I have to remove "-m elf_i386" (compiling in chrooted i386 on 64)CPPFLAGS_vdso32.lds = $(CPPFLAGS_vdso.lds)-VDSO_LDFLAGS_vdso32.lds = -m elf_i386 -Wl,-soname=linux-gate.so.1+VDSO_LDFLAGS_vdso32.lds = -Wl,-soname=linux-gate.so.1Solving this issue VDSO arch/x86/vdso/vdso32-int80.so.dbggcc: error: unrecognized command line option ‘-m’gcc: error: elf_i386: No such file or directorymake[3]: *** [arch/x86/vdso/vdso32-int80.so.dbg] Error 12. the mutex_lock/_unlock should be marked as __used as described hereLD .tmp_vmlinux1kernel/built-in.o: In function `mutex_lock':(.sched.text+0x726): undefined reference to `__mutex_lock_slowpath'kernel/built-in.o: In function `mutex_unlock':(.sched.text+0x730): undefined reference to `__mutex_unlock_slowpath'make[2]: *** [.tmp_vmlinux1] Error 1Is there a more intelligent way to overcome the above issues?Is this setup useful?Do I have to add some more debugging in the kernel?I'll compile some kernels for testing and send you feedback next weekthanks in advanceregardsHi,from the official download siteall kernels upto 2.6.30.10 worked. 2.6.31 do not workI tested followingconfig-2.6.26config-2.6.27.1config-2.6.27.30config-2.6.27.50config-2.6.28.10config-2.6.29.6config-2.6.30.10config-2.6.30.3config-2.6.31config-2.6.31.14Does this help?Createdattachment-17854-0.htmlHow do I do "git bisect" between last working 2.6.30.10 and 2.6.31?thanksOn Saturday, August 16, 2014 4:12 AM, "" <> wrote:---from H. Peter Anvin <> ---The absolutely best would be if you could do a "git bisect" between 2.6.26 and2.6.30.Hi,thanks for answering.I'm not too familiar with git etc, but I'll try my best. I found this document which seems to be good for the startJust for the record I noticed that 2.6.30 has issue with udev in debian wheezy.Precisely it gets permission denied on locking /run/network/ifstate and thus can not bring up the network. There were other issues with /run as well. In wheezy udev is not starting because kernel higher than 2.6.32 is expected.Hi againcould you please provide instructions (or link with such) that describes the process of bisect-ing.It seems I can not do git clone for some reason.I tried this @home and in the office but no luck.All I get isgit clone git://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-2.6.gitCloning into 'linux-2.6'...fatal: unable to connect to git.kernel.org:git.kernel.org[0: 199.204.44.194]: errno=Die Wartezeit f?r die Verbindung ist abgelaufengit.kernel.org[1: 198.145.20.140]: errno=Die Wartezeit f?r die Verbindung ist abgelaufengit.kernel.org[2: 149.20.4.72]: errno=Die Wartezeit f?r die Verbindung ist abgelaufengit.kernel.org[3: 2001:4f8:1:10:0:1991:8:25]: errno=Das Netzwerk ist nicht erreichbargit clone git://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.gitCloning into 'linux-stable'...fatal: unable to connect to git.kernel.org:git.kernel.org[0: 199.204.44.194]: errno=Die Wartezeit f?r die Verbindung ist abgelaufengit.kernel.org[1: 198.145.20.140]: errno=Die Wartezeit f?r die Verbindung ist abgelaufengit.kernel.org[2: 149.20.4.72]: errno=Die Wartezeit f?r die Verbindung ist abgelaufengit.kernel.org[3: 2001:4f8:1:10:0:1991:8:25]: errno=Das Netzwerk ist nicht erreichbarPS: the german messages are saying "Connection Timeout"traceroute git.kernel.orgtraceroute to git.kernel.org (149.20.4.72), 30 hops max, 60 byte packets 1 10.146.8.4 (10.146.8.4) 0.414 ms 0.437 ms 0.487 ms 2 192.168.192.4 (192.168.192.4) 0.460 ms 0.599 ms 0.738 ms 3 80.109.255.1 (80.109.255.1) 2.979 ms 2.949 ms 2.868 ms 4 at-vie-sk11-pe04-vl-2035.upc.at (84.116.228.98) 104.393 ms 104.270 ms 104.380 ms 5 at-vie-sk11-pe02-vl-2028.upc.at (84.116.228.69) 104.371 ms 104.496 ms 104.501 ms 6 at-vie15a-rd1-vl-2043.aorta.net (84.116.228.129) 103.672 ms 102.080 ms 102.733 ms 7 uk-lon01b-rd1-xe-1-0-1.aorta.net (84.116.132.37) 102.424 ms 103.347 ms 102.573 ms 8 de-fra01a-ri2-xe-4-0-0.aorta.net (84.116.130.138) 103.141 ms 84-116-130-149.aorta.net (84.116.130.149) 102.154 ms 101.613 ms 9 84.116.137.182 (84.116.137.182) 105.509 ms 84.116.137.190 (84.116.137.190) 157.893 ms 84.116.137.186 (84.116.137.186) 105.663 ms10 nyiix.r1.lga1.isc.org (198.32.160.95) 105.398 ms 104.632 ms 104.637 ms11 int-0-0-0-7.r1.pao1.isc.org (149.20.65.137) 175.873 ms 175.884 ms 172.800 ms12 git2.kernel.org (149.20.4.72) 172.420 ms 172.626 ms 172.640 msthanks in advanceregardsI think there is some IPv6 issue here
id=115211	My notebook is thinkpad w500, debian jessie. If i plug in usb mouse/keybord/udisk etc. to notebook's usb port, hibernate/resume is fine, poweroff as it should be. But if i plugin a 4 ports usbhub to notebook which plugin usb device, poweroff after hibernate just success once, next hibernate system do not poweroff and auto resume. If i replug in all of device from the usbhub, system poweroff after hiberate, still just success once, next time hibernate will auto resume without poweroff.I temporary resolve this problem by add custom script called by systemd, the custom script unload moudle ehci_pci/ehci_hcd before kernel do s2disk and load module ehci_pci after kernel resume image. Now system power off/on as it should be.I think it's a bug, kernel should auto take care it, does it? yes, it sounds like you have found an EHCI-specific issue.Did previous versions of the kernel work on this HW configuration properly?Also, can you test Linux-4.5 -- the latest upstream release?I saw the status is marked as 'Resloved', hi andy, is this issue fixed already?As this thread has been marked as code_fix, I assume this problem has been solved and please feel free to reopen if you still see this issue on kernel >= 4.8-rc2, thanks.Thanks for reply, guys.This issue still exist in debian backports kernel 4.9/4.8, including myself compiled kernel 4.9.9.I nerver marked status as 'Resloved'.
id=42688	CreatedSyslog entries - both during error and during boot.kernel: ata1: illegal qc_active transition (3ffff3ff->fffff3fe)When this error occurs, the affected filesystem is remounted read-only (by my option). However, the I/O system is so corrupted that a soft reboot won't work (and sometimes SSH won't accept logins). "Recovery" is by a hard reset only. Fortunately, the affected server has IPMI, so the hard reset can be performed remotely. It seems to happen on a frequency of about once per 36 hours +/- 12 hours, and only with respect to the drive mounted having the root partition.Even if this is caused by a hardware error (however, the system is only 1 year old), there should be a more graceful handling not leading to a system that won't soft-reboot.Hardware:Motherboard: Supermicro H8SCM-F with AMD Opteron 4184 (6-core 2.8GHz 64-bit) and 32GB of ECC DDR3 SDRAM. The SATA interface is an AMD SP5100 SATA2 controller running at 3.0Gbps.Drives: Two Seagate ST32000644NS, SN11, max UDMA/133 1.8TB SATA drives (3,907,029,168 512-byte blocks), and one Optiarc DVD RW AD-7700S v1.03Messages regarding this problem were posted on the kernel and sata-dev mailing lists and to the SATA driver author, but no replies were ever seen. That looks like the controller went completely bonkers. What do you mean by "soft reboot"? If you mean issuing a command, be it "shutdown -r now", "reboot" or whatever else, there isn't much the system can do if the block device backing the root fs is completely gone and the binary in question isn't in memory. If sysrq is enabled, sysrq-b should work. However, if the controller went crazy, it's possible that BIOS would also be unable to access the hard drive. In that case, there really isn't much software can do. If so, just don't use the controller - it's broken.By soft-reboot, I mean any type of reboot short of pulling the reset line to the CPU low.The strange thing is that this situation does not happen with either the second hard drive or the DVD-RW device. It also seems to work for the first 24 hours or so after a reboot. You're the first person to tell me that this is [or may be] a hardware error. As this is a relatively new system, I'll have to check my warranty. Alternatively, I may try moving to another SATA channel as I have three of them but only use two (the DVD-RW drive is a secondary device).It's unlikely but still possible that the condition would follow the drive instead of staying with the port. f.ex, the controller isn't broken per-se but has a corner case bug which makes it fall into erratic behavior when the drive sends certain illegal / error sequence. It would also be interesting to swap the two hard drives and see what happens.As this is happening on a co-located server, making the trip to mess with the hardware isn't a trivial event. However, that alone doesn't invalidate the bug - as this could be caused by some change in the sequence of commands sent to the drive. Before closing the report as a hardware problem, we need to eliminate that possibility.Hmmm... unfortunately, at this point, the easiest possibility to eliminate is hardware problem, which at the same time is the most likely. It may not be trivial to you but doing otherwise is not trivial to other people (me :) without much possibility of improving the situation for anyone other than you. Ruling out hardware failure on your part seems the obvious way forward at this juncture.I'd be happy to help if it turns out not to be a hardware problem but don't want to try to eliminate all other possibilities to save you some trips. You know, I have a job and life too.Thanks.I researching this further, I find that this bug has previously been reported, but as it was reported for a kernel version that was not the current version at the time, it was marked "WONT FIX."References to it being a PROGRAMMING bug:Meanwhile, these reference it as a hardware problem (on dissimilar hardware):Undetermined cause references:Hardware error or not, this error response should give us more information as to what type of error it is precisely. Also, as my system runs for about 36 hours after a hard reboot before the error shows, that implies a programming error over a hardware error.Strange, but this bug continued until I upgraded to version 3.2.9, whereby I have been running for a week now and it has not shown up. Therefore, I'm guessing that it was a result of another problem which has since been fixed -- even if I cannot identify the precise fix which fixed this too.If this were a hardware error with my equipment, I would have expected it to appear "on schedule" about 36 hours after a reboot. That simply hasn't happened.This issue still needs a better explanation as to what the kernel was reporting: Is an "illegal qc_active transition" a hardware or a programming error?Looks as if I was wrong. It happened with 3.2.9 also, but the kernel ran for 12 days before it surfaced, as opposed to only 36 hours on average. Oh well.Well, since my last reply, I had an opportunity to visit the colocated server, unplug then re-plug-in all the SATA cables, and this has not reoccured since. That solution was documented as working for others, and it worked for me too.The documentation around this message still needs work.This bug seems fixed outside of documentation.I would recommend closing it.Cheers Nick
id=43095	Createderror itselfKernel Panic occurs (1-2 times per hour) when loaded (about 60-200mbps) with NIC Intel Corporation 82541GI Gigabit Ethernet Controller.System hangs and only reset helps.Tested it on kernel versions: 3.0.4, 3.2.4, 3.2.14, 2.6.38.2.е1000 driver versions: 8.035, 7.3.21-k8-NAPI.Tried to compile it with the kernel and tried to load as a module. With and without е100 driver.Symptoms are always similar.uname -aLinux HOST 3.0.0-12-generic #20-Ubuntu SMP Fri Oct 7 14:56:25 UTC 2011 x86_64 x86_64 x86_64 GNU/Linux Createdlspci outCreateddmesg outCreatedifconfig outNot much we can do with that trace - if it's still seen in a modern kernel please re-open howeverCreatedbug report with noirqdebug kernel option (kernel 3.7.5)The bug still exists in kernel 3.7.5. But now I can get it only with both NICs loaded (one with e100 driver, another with e1000). All works fine in Windows XP, so it seems not a hardware problem.Createdbug report with pci=bios,nommconf,biosirq,noacpi,usepirq kernel option (kernel 3.7.5)Createdbug report with nosmp kernel option (kernel 3.7.5)Alexander,Try testing kernel 4.5 mainline to see if the issue is still their. If it is then please send the output of your kernel oops attached to this bug report.Nick
id=85601	Hi,I'm using the iwlwifi for my WP2 encrypted 135 Mb/s WiFi network connection. Uploading files on my NAS using SMB is quite depressing. The upload speed begins at around 4.5 MB/s (like on Windows 7 all the time) and then collapses to around 0.6 MB/s after some seconds (10 – 20 secs). I don't find any WiFi or Samba error message in the syslog, but something is definitely wrong.Best Regards,Ettore Atalannm-tool output:- Device: wlan0 [-] ----------------------------------------------------------- Type: 802.11 WiFi Driver: iwlwifi State: connected Default: yes Capabilities: Speed: 135 Mb/s Wireless Properties WEP Encryption: yes WPA Encryption: yes WPA2 Encryption: yes IPv4 Settings: Address: 192.168.2.104 Prefix: 24 (255.255.255.0) Gateway: 192.168.2.1 DNS: 192.168.2.1 This bug is lacking tons of details:I need lspci (to know what device)*full* dmesgthat will be just to start.Createdlspci output(In reply to Emmanuel Grumbach from)This was clear to me.Please see the attachment.Createdfull dmesg(In reply to Emmanuel Grumbach from)Okay.Best Regards,Ettore AtalanCreateddmesg supplement after this problem has happenedPlease feel free to ask for further log files and/or details.Please do the following when traffic doesn't go troughas root:echo 0xC0800000 > /sys/module/iwlwifi/parameters/debugas regular user:ping 192.168.1.1 -c25then, let me know what you see in the ping window, and attach the dmesg to the bug.Thanks.(In reply to Emmanuel Grumbach from)Do you mean no traffic (resp. file upload) at all or when the problem appears while uploading a file to the NAS?BTW, I have no device with this IP address.Best Regards,Ettore Atalan(In reply to Ettore Atalan from)when problem occurs.This seemed to be your gateway - but whatever is in your subnet.Createdcurrent dmesg(In reply to Emmanuel Grumbach from)Output (unfortunately not very helpful):echo 0xC0800000 > /sys/module/iwlwifi/parameters/debug: command not found>Output:PING 192.168.2.1 (192.168.2.1) 56(84) bytes of data.64 bytes from 192.168.2.1: icmp_seq=1 ttl=64 time=2.52 ms64 bytes from 192.168.2.1: icmp_seq=2 ttl=64 time=3.08 ms64 bytes from 192.168.2.1: icmp_seq=3 ttl=64 time=3.05 ms64 bytes from 192.168.2.1: icmp_seq=4 ttl=64 time=4.98 ms64 bytes from 192.168.2.1: icmp_seq=5 ttl=64 time=3.07 ms64 bytes from 192.168.2.1: icmp_seq=6 ttl=64 time=3.19 ms64 bytes from 192.168.2.1: icmp_seq=7 ttl=64 time=1.99 ms64 bytes from 192.168.2.1: icmp_seq=8 ttl=64 time=4.38 ms64 bytes from 192.168.2.1: icmp_seq=9 ttl=64 time=4.04 ms64 bytes from 192.168.2.1: icmp_seq=10 ttl=64 time=3.23 ms64 bytes from 192.168.2.1: icmp_seq=11 ttl=64 time=3.86 ms64 bytes from 192.168.2.1: icmp_seq=12 ttl=64 time=3.96 ms64 bytes from 192.168.2.1: icmp_seq=13 ttl=64 time=2.85 ms64 bytes from 192.168.2.1: icmp_seq=14 ttl=64 time=1.96 ms64 bytes from 192.168.2.1: icmp_seq=15 ttl=64 time=3.18 ms64 bytes from 192.168.2.1: icmp_seq=16 ttl=64 time=1.76 ms64 bytes from 192.168.2.1: icmp_seq=17 ttl=64 time=4.71 ms64 bytes from 192.168.2.1: icmp_seq=18 ttl=64 time=3.25 ms64 bytes from 192.168.2.1: icmp_seq=19 ttl=64 time=4.92 ms64 bytes from 192.168.2.1: icmp_seq=20 ttl=64 time=3.29 ms64 bytes from 192.168.2.1: icmp_seq=21 ttl=64 time=2.83 ms64 bytes from 192.168.2.1: icmp_seq=22 ttl=64 time=3.24 ms64 bytes from 192.168.2.1: icmp_seq=23 ttl=64 time=1.89 ms64 bytes from 192.168.2.1: icmp_seq=24 ttl=64 time=3.32 ms64 bytes from 192.168.2.1: icmp_seq=25 ttl=64 time=3.14 ms--- 192.168.2.1 ping statistics ---25 packets transmitted, 25 received, 0% packet loss, time 24033msrtt min/avg/max/mdev = 1.766/3.271/4.980/0.874 msOkay.You're welcome.Best Regards,Ettore Atalanyour pings look very good...I don't seen any bug on the wifi side here...Is it more likely a SMB/CIFS problem?(In reply to Ettore Atalan from)can't really tell - but you see that your ping response time is fine.I suggest you ping your gateway while you run your transfer - to see what happens.As long as the ping response time is fine, it means you don't have problems from the WiFi side.Createdping outputThe ping is better after the upload speed has dropped.makes senseyour wifi is working perfectly.Closing the bug.I have created a bug report for this in the samba bug tracker.URL:Best Regards,Ettore AtalanThe FTP upload speed is now as slow as with SMB/CIFS after upgrading to Kubuntu 15.04 with Kernel 3.19.PING 192.168.2.1 (192.168.2.1) 56(84) bytes of data.64 bytes from 192.168.2.1: icmp_seq=1 ttl=64 time=3.21 ms64 bytes from 192.168.2.1: icmp_seq=2 ttl=64 time=3.28 ms64 bytes from 192.168.2.1: icmp_seq=3 ttl=64 time=3.12 ms64 bytes from 192.168.2.1: icmp_seq=4 ttl=64 time=4.37 ms64 bytes from 192.168.2.1: icmp_seq=5 ttl=64 time=3.31 ms64 bytes from 192.168.2.1: icmp_seq=6 ttl=64 time=3.33 ms64 bytes from 192.168.2.1: icmp_seq=7 ttl=64 time=12.0 ms (!)64 bytes from 192.168.2.1: icmp_seq=8 ttl=64 time=3.30 ms64 bytes from 192.168.2.1: icmp_seq=9 ttl=64 time=5.00 ms64 bytes from 192.168.2.1: icmp_seq=10 ttl=64 time=3.27 ms64 bytes from 192.168.2.1: icmp_seq=11 ttl=64 time=3.11 ms64 bytes from 192.168.2.1: icmp_seq=12 ttl=64 time=3.27 ms64 bytes from 192.168.2.1: icmp_seq=13 ttl=64 time=4.34 ms64 bytes from 192.168.2.1: icmp_seq=14 ttl=64 time=3.30 ms64 bytes from 192.168.2.1: icmp_seq=15 ttl=64 time=3.29 ms64 bytes from 192.168.2.1: icmp_seq=16 ttl=64 time=5.54 ms64 bytes from 192.168.2.1: icmp_seq=17 ttl=64 time=3.12 ms64 bytes from 192.168.2.1: icmp_seq=18 ttl=64 time=5.17 ms64 bytes from 192.168.2.1: icmp_seq=19 ttl=64 time=3.10 ms64 bytes from 192.168.2.1: icmp_seq=20 ttl=64 time=3.33 ms64 bytes from 192.168.2.1: icmp_seq=21 ttl=64 time=3.26 ms64 bytes from 192.168.2.1: icmp_seq=22 ttl=64 time=2.73 ms64 bytes from 192.168.2.1: icmp_seq=23 ttl=64 time=3.29 ms64 bytes from 192.168.2.1: icmp_seq=24 ttl=64 time=3.33 ms64 bytes from 192.168.2.1: icmp_seq=25 ttl=64 time=4.73 ms--- 192.168.2.1 ping statistics ---25 packets transmitted, 25 received, 0% packet loss, time 24033msrtt min/avg/max/mdev = 2.735/3.968/12.020/1.801 msBest Regards,Ettore AtalanI don't see any problem with the ping times.There is nothing I can do with this.Another problem?Your WiFi device behaves well. That's all I am accountable for.Instead of wasting my time, I'll remove myself from this bug.(In reply to Emmanuel Grumbach from)No, the upload rate of my WiFi device is much slower on Linux (~ 600 KB/s) than on Windows 7 (~ 4.5 MB/s).Who is accountable for the upload rate?
id=53321	Tested kernels with the issue: 3.7.5, 3.7.0Tested kernels without the issue: 3.6.11, 3.4.28 and olderCentOS 6 x86_64All kernels are compiled from the same config ().A screenshot from a router with 4 NICs on bond0 (eth0, eth1) and bond1(eth2, eth3):STEPS TO REPRODUCE ON TEST HOST:Sorry, I have no any managed switches with 802.3ad at home. So I useVirtualbox for bug reporting with two bridged adapters on the guestattached to TAP devices on the host.STEP 1. VIRTUALBOX HOST – INIT:# cat /etc/modprobe.d/bonding.conf:alias bond0 bondingoptions bond0 mode=4 xmit_hash_policy=layer3+4 miimon=100# ip tuntap add dev tap0 mode tap# ip tuntap add dev tap1 mode tap# modprobe -v bond0# ip l set dev tap0 up# ip l set dev tap1 up# ip l set dev bond0 up# ifenslave bond0 tap0 tap1# ip a add 192.168.10.10/24 dev bond0STEP 2. VIRTUALBOX GUEST – INIT:# cat /etc/modprobe.d/bonding.conf:alias bond0 bondingoptions bond0 mode=4 xmit_hash_policy=layer3+4 miimon=100# modprobe -v bond0# ip l set dev p2p1 up# ip l set dev p7p1 up# ip l set dev bond0 up# ifenslave bond0 p2p1 p7p1# ip a add 192.168.10.20/24 dev bond0# ip r add default via 192.168.10.10STEP 3. VIRTUALBOX HOST – INIT SNIFFERS:# tcpdump -n -nn -l -i tap0 > tap0.txt &# tcpdump -n -nn -l -i tap1 > tap1.txt &STEP 4. VIRTUALBOX HOST – GENERATE SOME TRAFFIC:# nmap -sU -v -T 5 192.168.10.20On 3.7.5, 3.7.0 the bonding will place all traffic only to a singleinterface (tap0 or tap1).On 3.6.11, 3.4.28 and older kernels the bonding will place all trafficto both interfaces (tap0 and tap1).# cat /proc/net/bonding/bond0Ethernet Channel Bonding Driver: v3.7.1 (April 27, 2011)Bonding Mode: IEEE 802.3ad Dynamic link aggregationTransmit Hash Policy: layer3+4 (1)MII Status: upMII Polling Interval (ms): 100Up Delay (ms): 0Down Delay (ms): 0802.3ad infoLACP rate: slowMin links: 0Aggregator selection policy (ad_select): stableActive Aggregator Info:Aggregator ID: 1Number of ports: 2Actor Key: 5Partner Key: 17Partner Mac Address: 08:00:27:af:dd:45Slave Interface: tap0MII Status: upSpeed: 10 MbpsDuplex: fullLink Failure Count: 0Permanent HW addr: ba:2f:b5:25:d0:67Aggregator ID: 1Slave queue ID: 0Slave Interface: tap1MII Status: upSpeed: 10 MbpsDuplex: fullLink Failure Count: 0Permanent HW addr: 6a:ce:e4:d0:0c:05Aggregator ID: 1Slave queue ID: 0Any ideas?Thanks Bonding hashes based on flow. To simulate a test with multiple flows you need to test multiple connections with something like netperf or iperf.Hi, StephenThank you for your answer.I tried iperf and found interesting things for you:1) bonding (802.3ad) works perfectly with iptables OUTPUT traffic;2) bonding (802.3ad) DOESN'T works with iptables FORWARD traffic!The new small iperf test script (test.sh):#!/bin/bashfor port in {1000..2000}; do iperf -c 192.168.10.20 --port $port --udp --bandwidth 1K --time 600 > /dev/null 2>&1 &done--------------------------------------------------------------------------------I. TEST OUTPUT trafficRun test.sh on virtualbox host.Result: bonding works. Traffic are balanced between tap0 and tap1.II. TEST FORWARD traffic1. Convert virtualbox host to router:* eth0: 192.168.1.10/24 with connected notebook * bond0: 192.168.10.10/24 (tap0 + tap1) with connected virtualboxnet.ipv4.ip_forward = 1iptables has no rules, FORWARD = ACCEPT2. Run test.sh on the notebook (192.168.1.200)Result: bonding DOESN'T work. It will place all traffic only to a single interface (tap0 or tap1).--------------------------------------------------------------------------------The bug is reproduced on all my *routers* with 3.7.5 kernels too.One of them:* Intel Gigabit ET2 Quad Port Server Adapter (igb.ko)* 500/100Mbps traffic* NAT, ipt_netflow* bond0 (eth0, eth1) + bond1 (eth2, eth3):Screenshot:--------------------------------------------------------------------------------The bug is not reproduced on 3.6.11 and older kernels on the same routers with same configs.–With best regards,Nikolay
id=96521%0D%0A	Question: Why do turbostat Bzy_MHz and the CPU frequencies reported by the intel_pstate driver always seem to be different?Answer: Because turbostat calculates it correctly and the intel_pstate driver does not.This code, from intel_pstate_calc_busy: sample->freq = fp_toint( mul_fp(int_tofp( cpu->pstate.max_pstate * cpu->pstate.scaling / 100), core_pct));basically assumes that tsc is an exact multiple of 100 MHz, which might not be true. For example on my computer (i7-2600K) tsc is 3411.127 MHz and the minimum frequency is 1605 MHz, which is what turbostat reports. intel_pstate reports 1599.9 MHz.Question: Does it really matter?Answer: When digging into subtle differences in response and energy, yes.The suggestion is to do it the way turbostat does. It appears to read TSC from some register. reducing priority to P3 - the user impact is small.I saw a series of patches have been sent out for internal review, which will remove sample->freq, and use tsc * aper/mperf for cpu freq calculation.Fixed by commit ffb810563c0c049872a504978e06c8892104fb6cAuthor: Rafael J. Wysocki <>Date: Sun Apr 10 05:59:10 2016 +0200 intel_pstate: Avoid getting stuck in high P-states when idleWell, it has not been fixed for core platform but only for atom in get_target_pstate_use_cpu_load.Chen, ffb810563c0c049872a504978e06c8892104fb6c has nothing to do with this bug report. That commit is a result of work on.
id=186221	During suspend to mem/freeze, pcieport either take more than 1 second to suspend, or more than 1 second to resume, or even both.analyze_suspend shows that most of the time is spent in acpi_ps_parse_aml. Createdacpidump outputHi, Yu,please confirm if the problem is gone with boot option pcie_ports=compattested on top of 4.9-rc7, with pcie_ports=compat, the resume time for pcieport(0000:00:1c.5) has not dropped, it's 1131ms.so this is not a duplicate ofAccording to suspenresume result based on ftrace, it tooks more than 1 second to finish the following process on device:# cat /sys/devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A08:00/device:66/path\_SB_.PCI0.RP06# cat /sys/devices/LNXSYSTM:00/LNXSYBUS:00/PNP0A08:00/device:66/adr0x001c0005pci_pm_resume_noirq->acpi_device_set_power, thus _PS0 under this device has taken more than 1 second to finish.Method (_PS0, 0, Serialized) // _PS0: Power State 0 { If (((OSDW () && NVME) == 0x00)) { GD56 = 0x01 PSTA = 0x00 Local0 = 0x00 While ((\_SB.PCI0.RP06.PSTA != 0x00)) { If ((Local0 > 0x1388)) { Break } Sleep (0x01) Local0++ } Sleep (0x46) L23D = 0x01 Sleep (0x01) Local0 = 0x00 While (L23D) { If ((Local0 > 0x04)) { Break } Sleep (0x01) Local0++ } LEDM = 0x00 Local0 = (Timer + 0x00989680) While ((Timer <= Local0)) { If (((LACT == 0x01) && (\_SB.PCI0.RP06.SSD0.CLAS == 0x01))) { Break } Sleep (0x0A) } } }Furthermore, according to acpi tracer result by appending: acpi.trace_method_name=_SB.PCI0.RP06._PS0 acpi.trace_state=opcodeit shows that the third while loop is always running until time out,that is to say, the condition of(LACT == 0x01) && (\_SB.PCI0.RP06.SSD0.CLAS == 0x01)is never met.While LACT and _SB.PCI-.RP06.SSD0.CLAS is located in pci config space,I'd rather regard this issue as a firmware problem.Createdthe opcode log during resumed invoking _PS0
id=87121	Provide a local search mechanism, e.g. "where in *this* section/page is the occurrence of foo"?Hierarchic search is very useful to locate an option in the complete hierarchy of options, but a local search just so that we don't have to read all lines one by one in search of a keyword would also be very useful.Thanks. Oops wrong bug..
id=15357	i have two hdds in my system: one for normal work and a second one for backups.the second harddrive is put to sleep after startup and is only accessed, when my automatic backup scripts work around midnight.all partitions on aforesaid drive are unmounted, when it is not in use.when i trigger hibernate, the typical cursor blinking starts and after a few seconds the second hard drive is waken up, all hibernation data is put on the other harddisk and the pc shuts down.this wake up is clearly not related to the bios (there was a blacklisting patch to libata for a similar problem in 2008), but a kernel (libata? or other software) problem. something accesses the second harddrive in a way, that wakes it up unnecessarily, which potentially reduces its lifespan.the harddrive in question is a seagate 7200.8 (ST3250823AS) and is attached to a ICH10 southbridge (8086:3a22) on my intel DG45ID mainboard. i use smartd to monitor the other hdd only. the kernel is a precompiled 2.6.32.8 vanilla AMD64 kernel (from), but the problem is not new/a regression. the system runs ubuntu 9.10. dmesg does not give any hints.--ameno Hmmm.... yeah, that's the drive waking up to process the drive shutdown sequence - FLUSH followed by STANDBY. The driver has been intercepting command sequence and skipping those if the drive already seemed powered down in rather hacky way to work around buggy shutdown implementation. The shutdown implementation has been updated and thus the hacky workaround code was removed last year.The thing is that tracking device power state and buffer cleanliness from driver is messy and skipping FLUSH before cutting the power can be quite dangerous. It would be ideal if the drive don't spin up if there's no data to flush but it seems many drives do. At this point, I'm not quite sure what should be done about this. I'll think more about it.Thanks.and the reason why this does not happen on a normal shutdown is that then the driver is not responsible for flushing itself but userspace? (sorry for the stupid question, but i have no idea how this is implemented :)Hmmm.... not really, the sequence is about the same. It issues FLUSH and then STANDBY. So, even if the drive is in standby mode, it doesn't wake up during shutdown sequence?correct. im not sure it was like that in 2.6.32 (because i rarely shutdown), but it is for sure in 2.6.33 now. i tested it yesterday and i cant hear anything from the second hdd while shutting down, when it was in SLEEP mode before (hdparm -Y).Hmmm... Is the drive mounted? If so, can you unmount it and see whether that makes any difference?Thanks.the drive is never mounted, when i shutdown or hibernate.the partition table looks like this:Disk /dev/sdb: 250.1 GB, 250059350016 bytes255 heads, 63 sectors/track, 30401 cylindersUnits = cylinders of 16065 * 512 = 8225280 bytesDisk identifier: 0x00049c61 Device Boot Start End Blocks Id System/dev/sdb2 32 30401 243947025 83 Linux(i had a small partition in the beginning once and did not reclaim that space)the entire sdb2 partition is a luks(dm)-encrypted ext3.From what I can see, when the drive is in STANDBY, it does not wake up, but in SLEEP, it does because the FLUSH and STANDBY can not be sent to the drive while it is in SLEEP mode. My patches I posted to the mailing list recently fix this by faking the commands while the drive is in SLEEP mode.(if this is actually seen with a modern kernel please update the version!)As my recent comment indicated, it still applies to current git head and bugzilla won't let me edit the version or status.
id=36072	The celestia program often allocates a lot of memory (like 1.5GB on my 2GB machine with 3GB swap) for its textures. I don't know where it stores them (probably not Video memory), but it seems in system RAM, because swap is used much. Sometimes when this happens the kernel crashes. After that I can only sync and reboot the machine with alt-sysrq commands. I have only noticed this with kernel 2.6.38.x, not before. I was using the OSS ati driver 6.14.1, with mesa 7.10.2. All including the kernel seft compiled (for AMD fam10h CPU). I do not understand the first line of the log. Where can I increase the vmalloc size. Is the on the kernel command line? But it should not crash the kernel in any case, just the program.Here is the kernel log:May 19 21:26:52 coolbox kernel: vmap allocation for size 178982912 failed: use vmalloc=<size> to increase size.May 19 21:26:52 coolbox kernel: BUG: unable to handle kernel paging request at b892a45dMay 19 21:26:52 coolbox kernel: IP: [<f9696a50>] ttm_mem_io_lock+0x0/0x20 [ttm]May 19 21:26:52 coolbox kernel: *pde = 00000000 May 19 21:26:52 coolbox kernel: Oops: 0000 [#1] PREEMPT SMP May 19 21:26:52 coolbox kernel: last sysfs file: /sys/devices/LNXSYSTM:00/device:00/PNP0A03:00/device:01/ATK0110:00/hwmon/hwmon0/fan3_inputMay 19 21:26:52 coolbox kernel: Modules linked in: fbcon font bitblit softcursor radeon ttm drm_kms_helper drm agpgart fb fbdev autofs4 cfbcopyarea cfbimgblt cfbfillrect nf_conntrack_ftp xt_tcpudp xt_owner xt_multiport nf_conntrack_ipv4 nf_defrag_ipv4 xt_state nf_conntrack ipt_REJECT ipt_LOG iptable_filter ip_tables x_tables asus_atk0110 snd_seq_oss snd_seq_midi_event snd_seq snd_seq_device snd_pcm_oss snd_mixer_oss cpufreq_conservative cpufreq_ondemand psmouse pcspkr cx88_blackbird firmware_class cx2341x cx8802 tuner_simple tuner_types tda9887 tda8290 tea5767 tuner cx8800 cx88xx rc_core i2c_algo_bit tveeprom v4l2_common videodev btcx_risc videobuf_dma_sg videobuf_core forcedeth snd_hda_codec_via snd_hda_intel snd_hda_codec snd_pcm snd_timer snd soundcore snd_page_alloc i2c_nforce2 i2c_core ext4 mbcache jbd2 crc16 usbhid powernow_k8 processor mperf ohci_hcd ehci_hcd usbcore fuseMay 19 21:26:52 coolbox kernel: May 19 21:26:52 coolbox kernel: Pid: 25014, comm: celestia Not tainted 2.6.38.6 #57 System manufacturer System Product Name/M2N68May 19 21:26:52 coolbox kernel: EIP: 0060:[<f9696a50>] EFLAGS: 00010246 CPU: 3May 19 21:26:52 coolbox kernel: EIP is at ttm_mem_io_lock+0x0/0x20 [ttm]May 19 21:26:52 coolbox kernel: EAX: b892a420 EBX: d03cfc28 ECX: 00000000 EDX: 00000000May 19 21:26:52 coolbox kernel: ESI: f519a40c EDI: b892a420 EBP: d03cfd48 ESP: d03cfbf0May 19 21:26:52 coolbox kernel: DS: 007b ES: 007b FS: 00d8 GS: 0033 SS: 0068May 19 21:26:52 coolbox kernel: Process celestia (pid: 25014, ti=d03ce000 task=f06fb830 task.ti=d03ce000)May 19 21:26:52 coolbox kernel: Stack:May 19 21:26:52 coolbox kernel: f9696f25 d03cfc28 d03cfd80 d03cfc98 f96970e2 f29e2c2c fffffff4 00040002May 19 21:26:52 coolbox kernel: f519a40c f9695c16 f29e2c64 f50135c0 00040001 00000002 00000002 d03cfcd0May 19 21:26:52 coolbox kernel: f519a45c f519a40c 00000000 af3e5000 d03cfc48 d03cfc9c f519a40c d03cfc98May 19 21:26:52 coolbox kernel: Call Trace:May 19 21:26:52 coolbox kernel: [<f9696f25>] ? ttm_mem_reg_iounmap+0x35/0x70 [ttm]May 19 21:26:52 coolbox kernel: [<f96970e2>] ? ttm_bo_move_memcpy+0x182/0x310 [ttm]May 19 21:26:52 coolbox kernel: [<f9695c16>] ? ttm_bo_mem_space+0x306/0x3a0 [ttm]May 19 21:26:52 coolbox kernel: [<f97f4fb0>] ? radeon_bo_move+0xe0/0x330 [radeon]May 19 21:26:52 coolbox kernel: [<f96944d5>] ? ttm_bo_reserve_locked+0xa5/0x120 [ttm]May 19 21:26:52 coolbox kernel: [<f97f4ed0>] ? radeon_bo_move+0x0/0x330 [radeon]May 19 21:26:52 coolbox kernel: [<f9694e15>] ? ttm_bo_handle_move_mem+0x135/0x330 [ttm]May 19 21:26:52 coolbox kernel: [<f9695ddc>] ? ttm_bo_move_buffer+0x12c/0x140 [ttm]May 19 21:26:52 coolbox kernel: [<f9695e86>] ? ttm_bo_validate+0x96/0x120 [ttm]May 19 21:26:52 coolbox kernel: [<f97f5f5a>] ? radeon_bo_list_validate+0x5a/0xe0 [radeon]May 19 21:26:52 coolbox kernel: [<f980d14c>] ? radeon_cs_ioctl+0x7c/0x1a0 [radeon]May 19 21:26:52 coolbox kernel: [<c0206466>] ? prepare_for_delete_or_cut+0x3c6/0x650May 19 21:26:52 coolbox kernel: [<f96b3b51>] ? drm_ioctl+0x191/0x380 [drm]May 19 21:26:52 coolbox kernel: [<c0206466>] ? prepare_for_delete_or_cut+0x3c6/0x650May 19 21:26:52 coolbox kernel: [<f980d0d0>] ? radeon_cs_ioctl+0x0/0x1a0 [radeon]May 19 21:26:52 coolbox kernel: [<c018ccf8>] ? handle_pte_fault+0x88/0x630May 19 21:26:52 coolbox kernel: [<c026006f>] ? prio_tree_insert+0x12f/0x250May 19 21:26:52 coolbox kernel: [<f96b39c0>] ? drm_ioctl+0x0/0x380 [drm]May 19 21:26:52 coolbox kernel: [<c01b1edf>] ? do_vfs_ioctl+0x7f/0x590May 19 21:26:52 coolbox kernel: [<c011df35>] ? do_page_fault+0x185/0x3a0May 19 21:26:52 coolbox kernel: [<c0190bae>] ? mmap_region+0x16e/0x440May 19 21:26:52 coolbox kernel: [<c01351d5>] ? irq_exit+0x35/0x70May 19 21:26:52 coolbox kernel: [<c01b242d>] ? sys_ioctl+0x3d/0x70May 19 21:26:52 coolbox kernel: [<c0206466>] ? prepare_for_delete_or_cut+0x3c6/0x650May 19 21:26:52 coolbox kernel: [<c03979a1>] ? syscall_call+0x7/0xbMay 19 21:26:52 coolbox kernel: [<c0206466>] ? prepare_for_delete_or_cut+0x3c6/0x650May 19 21:26:52 coolbox kernel: [<c0206466>] ? prepare_for_delete_or_cut+0x3c6/0x650May 19 21:26:52 coolbox kernel: Code: 00 00 00 66 31 c0 83 c8 01 89 47 50 eb 9f 90 8d 74 26 00 89 da 89 f0 e8 0f cb ff ff 85 c0 74 a4 89 c5 eb b2 8d b4 26 00 00 00 00 <80> 78 3d 00 74 03 31 c0 c3 84 d2 75 0a 83 c0 28 e8 db f5 cf c6 May 19 21:26:52 coolbox kernel: EIP: [<f9696a50>] ttm_mem_io_lock+0x0/0x20 [ttm] SS:ESP 0068:d03cfbf0May 19 21:26:52 coolbox kernel: CR2: 00000000b892a45dMay 19 21:26:52 coolbox kernel: ---[ end trace 70c887d309b00b2d ]---May 19 21:27:18 coolbox kernel: Emergency Sync completeMay 19 21:27:21 coolbox kernel: Emergency Sync complete I am also using the transparent hugepages feature with is set to 'always' use them.This is getting worse. With kernel 3.0.3, mesa 7.11 I get the crash several seconds after starting celestia each time.Aug 30 00:01:03 coolbox kernel: [drm:radeon_cs_ioctl] *ERROR* Failed to parse relocation -12!Aug 30 00:01:03 coolbox kernel: vmap allocation for size 178982912 failed: use vmalloc=<size> to increase size.Aug 30 00:01:03 coolbox kernel: BUG: unable to handle kernel paging request at 9adc8491Aug 30 00:01:03 coolbox kernel: IP: [<f95daad0>] ttm_bo_move_ttm+0xa0/0xa0 [ttm]Aug 30 00:01:03 coolbox kernel: *pde = 00000000 Aug 30 00:01:03 coolbox kernel: Oops: 0000 [#1] PREEMPT SMP Aug 30 00:01:03 coolbox kernel: Modules linked in: fbcon font bitblit softcursor radeon ttm drm_kms_helper drm autofs4 agpgart fb fbdev cfbcopyarea cfbimgblt cfbfillrect nf_conntrack_ftp xt_tcpudp xt_owner xt_multiport nf_conntrack_ipv4 nf_defrag_ipv4 xt_state nf_conntrack ipt_REJECT ipt_LOG iptable_filter ip_tables x_tables asus_atk0110 snd_seq_oss snd_seq_midi_event snd_seq snd_seq_device snd_pcm_oss snd_mixer_oss cpufreq_conservative cpufreq_ondemand psmouse pcspkr cx88_blackbird firmware_class cx2341x cx8802 tuner_simple tuner_types tda9887 tda8290 tea5767 tuner cx8800 cx88xx rc_core i2c_algo_bit tveeprom v4l2_common videodev btcx_risc videobuf_dma_sg videobuf_core forcedeth snd_hda_codec_via snd_hda_intel snd_hda_codec snd_pcm snd_timer snd soundcore snd_page_alloc i2c_nforce2 i2c_core usbhid powernow_k8 processor mperf ohci_hcd ehci_hcd usbcore fuseAug 30 00:01:03 coolbox kernel: Aug 30 00:01:03 coolbox kernel: Pid: 5484, comm: celestia Not tainted 2.6.40.3 #2 System manufacturer System Product Name/M2N68Aug 30 00:01:03 coolbox kernel: EIP: 0060:[<f95daad0>] EFLAGS: 00010246 CPU: 1Aug 30 00:01:03 coolbox kernel: EIP is at ttm_mem_io_lock+0x0/0x20 [ttm]Aug 30 00:01:03 coolbox kernel: EAX: 9adc8454 EBX: f565dc1c ECX: 00000000 EDX: 00000000Aug 30 00:01:03 coolbox kernel: ESI: e04f8440 EDI: 9adc8454 EBP: f565dd3c ESP: f565dbe4Aug 30 00:01:03 coolbox kernel: DS: 007b ES: 007b FS: 00d8 GS: 0033 SS: 0068Aug 30 00:01:03 coolbox kernel: Process celestia (pid: 5484, ti=f565c000 task=e06347b0 task.ti=f565c000)Aug 30 00:01:03 coolbox kernel: Stack:Aug 30 00:01:03 coolbox kernel: f95dafa5 f565dc1c f565dd74 f565dc8c f95db162 dfdd402c fffffff4 00040002Aug 30 00:01:03 coolbox kernel: e04f8440 f95d9c96 dfdd4064 dfec1640 00040001 00000002 00000002 f565dcc4Aug 30 00:01:03 coolbox kernel: e04f8490 e04f8440 00000000 4bee9000 f5e32860 c0107e69 e04f8440 f565dc8cAug 30 00:01:03 coolbox kernel: Call Trace:Aug 30 00:01:03 coolbox kernel: [<f95dafa5>] ? ttm_mem_reg_iounmap+0x35/0x70 [ttm]Aug 30 00:01:03 coolbox kernel: [<f95db162>] ? ttm_bo_move_memcpy+0x182/0x310 [ttm]Aug 30 00:01:03 coolbox kernel: [<f95d9c96>] ? ttm_bo_mem_space+0x306/0x3a0 [ttm]Aug 30 00:01:03 coolbox kernel: [<c0107e69>] ? nommu_map_page+0x39/0x70Aug 30 00:01:03 coolbox kernel: [<f973b030>] ? radeon_bo_move+0xe0/0x330 [radeon]Aug 30 00:01:03 coolbox kernel: [<f95d8555>] ? ttm_bo_reserve_locked+0xa5/0x120 [ttm]Aug 30 00:01:03 coolbox kernel: [<f95d8bff>] ? ttm_bo_unreserve+0x1f/0x30 [ttm]Aug 30 00:01:03 coolbox kernel: [<f973af50>] ? radeon_move_blit.clone.2+0x1f0/0x1f0 [radeon]Aug 30 00:01:03 coolbox kernel: [<f95d8e95>] ? ttm_bo_handle_move_mem+0x135/0x340 [ttm]Aug 30 00:01:03 coolbox kernel: [<f95d9e5c>] ? ttm_bo_move_buffer+0x12c/0x140 [ttm]Aug 30 00:01:03 coolbox kernel: [<f95d9f06>] ? ttm_bo_validate+0x96/0x120 [ttm]Aug 30 00:01:03 coolbox kernel: [<f973bfd1>] ? radeon_bo_list_validate+0x71/0xc0 [radeon]Aug 30 00:01:03 coolbox kernel: [<f97545e2>] ? radeon_cs_ioctl+0x82/0x1a0 [radeon]Aug 30 00:01:03 coolbox kernel: [<c0206466>] ? print_block+0x376/0x510Aug 30 00:01:03 coolbox kernel: [<f95efbaf>] ? drm_ioctl+0x18f/0x390 [drm]Aug 30 00:01:03 coolbox kernel: [<c0206466>] ? print_block+0x376/0x510Aug 30 00:01:03 coolbox kernel: [<f9754560>] ? radeon_cs_finish_pages+0xa0/0xa0 [radeon]Aug 30 00:01:03 coolbox kernel: [<c014e373>] ? sched_clock_local+0xc3/0x1b0Aug 30 00:01:03 coolbox kernel: [<c010fd5a>] ? x86_pmu_enable+0x1da/0x250Aug 30 00:01:03 coolbox kernel: [<c0173f2d>] ? perf_event_task_tick+0xbd/0x220Aug 30 00:01:03 coolbox kernel: [<f95efa20>] ? drm_version+0x90/0x90 [drm]Aug 30 00:01:03 coolbox kernel: [<c01b7228>] ? do_vfs_ioctl+0x88/0x5e0Aug 30 00:01:03 coolbox kernel: [<c03a6b69>] ? schedule+0x1d9/0x680Aug 30 00:01:03 coolbox kernel: [<c014c86d>] ? hrtimer_interrupt+0x15d/0x270Aug 30 00:01:03 coolbox kernel: [<c0150050>] ? getnstimeofday+0x40/0xe0Aug 30 00:01:03 coolbox kernel: [<c01b77bd>] ? sys_ioctl+0x3d/0x70Aug 30 00:01:03 coolbox kernel: [<c0206466>] ? print_block+0x376/0x510Aug 30 00:01:03 coolbox kernel: [<c03a8e21>] ? syscall_call+0x7/0xbAug 30 00:01:03 coolbox kernel: [<c0206466>] ? print_block+0x376/0x510Aug 30 00:01:03 coolbox kernel: [<c0206466>] ? print_block+0x376/0x510Aug 30 00:01:03 coolbox kernel: Code: 00 00 00 66 31 c0 83 c8 01 89 47 50 eb 9f 90 8d 74 26 00 89 da 89 f0 e8 cf ca ff ff 85 c0 74 a4 89 c5 eb b2 8d b4 26 00 00 00 00 Aug 30 00:01:03 coolbox kernel: EIP: [<f95daad0>] ttm_mem_io_lock+0x0/0x20 [ttm] SS:ESP 0068:f565dbe4Aug 30 00:01:03 coolbox kernel: CR2: 000000009adc8491Aug 30 00:01:03 coolbox kernel: ---[ end trace fed47f0f5bccf5c3 ]---Please attach the full dmesg.AFAICT ttm_bo_move_memcpy() uses old_copy uninitialized in some error paths. Thomas?I think this is the full relevant part of dmesg. Actually it is the content of /var/log/syslog after the machine reboot (with Alt-Sysrq-R). Should I capture something else?(Inthe kernel version is displayed as 2.6.40.3, but that is just a renamed 3.0.3, custom compiled.)(In reply to)Yes, the agp/drm/radeon initialization messages.Ok, this is from /var/log/messages:Aug 29 19:04:49 coolbox kernel: Linux agpgart interface v0.103Aug 29 19:04:49 coolbox kernel: [drm] Initialized drm 1.1.0 20060810Aug 29 19:04:49 coolbox kernel: [drm] radeon kernel modesetting enabled.Aug 29 19:04:49 coolbox kernel: radeon 0000:02:00.0: PCI INT A -> Link[LNEB] -> GSI 16 (level, low) -> IRQ 16Aug 29 19:04:49 coolbox kernel: [drm] initializing kernel modesetting (RV710 0x1002:0x954F).Aug 29 19:04:49 coolbox kernel: [drm] register mmio base: 0xDFFF0000Aug 29 19:04:49 coolbox kernel: [drm] register mmio size: 65536Aug 29 19:04:49 coolbox kernel: ATOM BIOS: 954F.11.12.0.2.AS01Aug 29 19:04:49 coolbox kernel: radeon 0000:02:00.0: VRAM: 512M 0x0000000000000000 - 0x000000001FFFFFFF (512M used)Aug 29 19:04:49 coolbox kernel: radeon 0000:02:00.0: GTT: 512M 0x0000000020000000 - 0x000000003FFFFFFFAug 29 19:04:49 coolbox kernel: [drm] Detected VRAM RAM=512M, BAR=256MAug 29 19:04:49 coolbox kernel: [drm] RAM width 64bits DDRAug 29 19:04:49 coolbox kernel: [TTM] Zone kernel: Available graphics memory: 443484 kiB.Aug 29 19:04:49 coolbox kernel: [TTM] Zone highmem: Available graphics memory: 1037248 kiB.Aug 29 19:04:49 coolbox kernel: [TTM] Initializing pool allocator.Aug 29 19:04:49 coolbox kernel: [drm] radeon: 512M of VRAM memory readyAug 29 19:04:49 coolbox kernel: [drm] radeon: 512M of GTT memory ready.Aug 29 19:04:49 coolbox kernel: [drm] Supports vblank timestamp caching Rev 1 (10.10.2010).Aug 29 19:04:49 coolbox kernel: [drm] Driver supports precise vblank timestamp query.Aug 29 19:04:49 coolbox kernel: radeon 0000:02:00.0: radeon: using MSI.Aug 29 19:04:49 coolbox kernel: [drm] radeon: irq initialized.Aug 29 19:04:49 coolbox kernel: [drm] GART: num cpu pages 131072, num gpu pages 131072Aug 29 19:04:49 coolbox kernel: [drm] Loading RV710 MicrocodeAug 29 19:04:50 coolbox kernel: radeon 0000:02:00.0: WB enabledAug 29 19:04:50 coolbox kernel: [drm] ring test succeeded in 1 usecsAug 29 19:04:50 coolbox kernel: [drm] radeon: ib pool ready.Aug 29 19:04:50 coolbox kernel: [drm] ib test succeeded in 0 usecsAug 29 19:04:50 coolbox kernel: [drm] Radeon Display ConnectorsAug 29 19:04:50 coolbox kernel: [drm] Connector 0:Aug 29 19:04:50 coolbox kernel: [drm] HDMI-AAug 29 19:04:50 coolbox kernel: [drm] HPD1Aug 29 19:04:50 coolbox kernel: [drm] DDC: 0x7e50 0x7e50 0x7e54 0x7e54 0x7e58 0x7e58 0x7e5c 0x7e5cAug 29 19:04:50 coolbox kernel: [drm] Encoders:Aug 29 19:04:50 coolbox kernel: [drm] DFP1: INTERNAL_UNIPHYAug 29 19:04:50 coolbox kernel: [drm] Connector 1:Aug 29 19:04:50 coolbox kernel: [drm] VGAAug 29 19:04:50 coolbox kernel: [drm] DDC: 0x7e40 0x7e40 0x7e44 0x7e44 0x7e48 0x7e48 0x7e4c 0x7e4cAug 29 19:04:50 coolbox kernel: [drm] Encoders:Aug 29 19:04:50 coolbox kernel: [drm] CRT2: INTERNAL_KLDSCP_DAC2Aug 29 19:04:50 coolbox kernel: [drm] Connector 2:Aug 29 19:04:50 coolbox kernel: [drm] DVI-IAug 29 19:04:50 coolbox kernel: [drm] HPD4Aug 29 19:04:50 coolbox kernel: [drm] DDC: 0x7f10 0x7f10 0x7f14 0x7f14 0x7f18 0x7f18 0x7f1c 0x7f1cAug 29 19:04:50 coolbox kernel: [drm] Encoders:Aug 29 19:04:50 coolbox kernel: [drm] CRT1: INTERNAL_KLDSCP_DAC1Aug 29 19:04:50 coolbox kernel: [drm] DFP2: INTERNAL_UNIPHY2Aug 29 19:04:50 coolbox kernel: [drm] Internal thermal controller without fan controlAug 29 19:04:50 coolbox kernel: [drm] radeon: power management initializedAug 29 19:04:50 coolbox kernel: [drm] fb mappable at 0xC0142000Aug 29 19:04:50 coolbox kernel: [drm] vram apper at 0xC0000000Aug 29 19:04:50 coolbox kernel: [drm] size 9216000Aug 29 19:04:50 coolbox kernel: [drm] fb depth is 24Aug 29 19:04:50 coolbox kernel: [drm] pitch is 7680Aug 29 19:04:50 coolbox kernel: fb0: radeondrmfb frame buffer deviceAug 29 19:04:50 coolbox kernel: drm: registered panic notifierAug 29 19:04:50 coolbox kernel: [drm] Initialized radeon 2.9.0 20080528 for 0000:02:00.0 on minor 0If this is still seen in modern (3.2+) kernels, please re-open thanksYes, still happens randomly, on kernel 3.5.3, X.org 1.12, ati driver 6.99.99, Mesa git (9.0):Aug 29 23:46:50 coolbox kernel: [drm:radeon_cs_ioctl] *ERROR* Failed to parse relocation -12!Aug 29 23:47:16 coolbox last message repeated 646 timesAug 29 23:48:07 coolbox last message repeated 554 timesAug 29 23:50:15 coolbox kernel: [drm:radeon_cs_ioctl] *ERROR* Failed to parse relocation -12!Aug 29 23:50:41 coolbox last message repeated 6 timesAug 29 23:50:41 coolbox kernel: vmap allocation for size 178966528 failed: use vmalloc=<size> to increase size.Aug 29 23:50:41 coolbox kernel: [drm:radeon_cs_ioctl] *ERROR* Failed to parse relocation -12!Aug 29 23:50:49 coolbox last message repeated 131 timesAug 29 23:50:58 coolbox kernel: ------------[ cut here ]------------Aug 29 23:50:58 coolbox kernel: kernel BUG at drivers/gpu/drm/ttm/ttm_bo.c:1167!Aug 29 23:50:58 coolbox kernel: invalid opcode: 0000 [#1] SMPAug 29 23:50:58 coolbox kernel: Modules linked in: usb_storage autofs4 nf_conntrack_ftp xt_tcpudp xt_owner xt_multiport nf_conntrack_ipv4 nf_defrag_ipv4 xt_state nf_conntrack ipt_REJECT xt_LOG iptable_filter ip_tables x_tables asus_atk0110 snd_seq_oss snd_seq_midi_event snd_seq snd_seq_device snd_pcm_oss snd_mixer_oss cx88_blackbird cx2341x cx8802 tuner_simple tuner_types tda9887 tda8290 tea5767 tuner cx8800 cx88xx rc_core tveeprom v4l2_common videodev videobuf_dma_sg videobuf_core btcx_risc k10temp forcedeth snd_hda_codec_via snd_hda_intel snd_hda_codec snd_pcm snd_timer snd soundcore snd_page_alloc i2c_nforce2 ext4 mbcache jbd2 crc16 usbhid powernow_k8 mperf ohci_hcd ehci_hcd usbcore usb_common fuse [last unloaded: microcode]Aug 29 23:50:58 coolbox kernel:Aug 29 23:50:58 coolbox kernel: Pid: 19931, comm: celestia Not tainted 2.6.45.3 #93 System manufacturer System Product Name/M2N68Aug 29 23:50:58 coolbox kernel: EIP: 0060:[<c030a069>] EFLAGS: 00010206 CPU: 3Aug 29 23:50:58 coolbox kernel: EIP is at ttm_bo_check_placement+0x19/0x20Aug 29 23:50:58 coolbox kernel: EAX: e1f12c2c EBX: 00002aac ECX: 00000000 EDX: 00000100Aug 29 23:50:58 coolbox kernel: ESI: ec13c468 EDI: ebbf71c0 EBP: 00021240 ESP: eaa33d70Aug 29 23:50:58 coolbox kernel: DS: 007b ES: 007b FS: 00d8 GS: 0033 SS: 0068Aug 29 23:50:58 coolbox kernel: CR0: 8005003b CR2: aa634000 CR3: 2afab000 CR4: 000007f0Aug 29 23:50:58 coolbox kernel: DR0: 00000000 DR1: 00000000 DR2: 00000000 DR3: 00000000Aug 29 23:50:58 coolbox kernel: DR6: ffff0ff0 DR7: 00000400Aug 29 23:50:58 coolbox kernel: Process celestia (pid: 19931, ti=eaa32000 task=ec27a030 task.ti=eaa32000)Aug 29 23:50:58 coolbox kernel: Stack:Aug 29 23:50:58 coolbox kernel: c030b4c9 00000000 00000000 01aac000 e1f12c2c e1f12c00 fffffff4 00000001Aug 29 23:50:58 coolbox kernel: 02aac000 c033bb07 00000000 e1f12c14 00000001 00000000 00000001 00000000Aug 29 23:50:58 coolbox kernel: 00021240 00000000 c033b850 00000001 00000001 00000000 ec13c468 ec13cd38Aug 29 23:50:58 coolbox kernel: Call Trace:Aug 29 23:50:58 coolbox kernel: [<c030b4c9>] ? ttm_bo_init+0x179/0x370Aug 29 23:50:58 coolbox kernel: [<c033bb07>] ? radeon_bo_create+0x197/0x290Aug 29 23:50:58 coolbox kernel: [<c033b850>] ? radeon_bo_clear_va+0x80/0x80Aug 29 23:50:58 coolbox kernel: [<c034c2bc>] ? radeon_gem_object_create+0x5c/0xf0Aug 29 23:50:58 coolbox kernel: [<c034c696>] ? radeon_gem_create_ioctl+0x66/0xf0Aug 29 23:50:58 coolbox kernel: [<c0275cb3>] ? _copy_from_user+0x33/0x70Aug 29 23:50:58 coolbox kernel: [<c034c630>] ? radeon_gem_pwrite_ioctl+0x30/0x30Aug 29 23:50:58 coolbox kernel: [<c02f349c>] ? drm_ioctl+0x36c/0x3d0Aug 29 23:50:58 coolbox kernel: [<c01c645d>] ? sys_umount+0x37d/0x380Aug 29 23:50:58 coolbox kernel: [<c01c645d>] ? sys_umount+0x37d/0x380Aug 29 23:50:58 coolbox kernel: [<c034c630>] ? radeon_gem_pwrite_ioctl+0x30/0x30Aug 29 23:50:58 coolbox kernel: [<c019420a>] ? free_pgtables+0x8a/0xb0Aug 29 23:50:58 coolbox kernel: [<c0193d49>] ? tlb_finish_mmu+0x9/0x30Aug 29 23:50:58 coolbox kernel: [<c02f3130>] ? drm_copy_field+0x70/0x70Aug 29 23:50:58 coolbox kernel: [<c01bc24a>] ? do_vfs_ioctl+0x7a/0x580Aug 29 23:50:58 coolbox kernel: [<c019ab25>] ? do_munmap+0x245/0x300Aug 29 23:50:58 coolbox kernel: [<c01c645d>] ? sys_umount+0x37d/0x380Aug 29 23:50:58 coolbox kernel: [<c01bc77e>] ? sys_ioctl+0x2e/0x50Aug 29 23:50:58 coolbox kernel: [<c0486cc5>] ? syscall_call+0x7/0xbAug 29 23:50:58 coolbox kernel: [<c01c645d>] ? sys_umount+0x37d/0x380Aug 29 23:50:58 coolbox kernel: [<c01c645d>] ? sys_umount+0x37d/0x380Aug 29 23:50:58 coolbox kernel: Code: 8b 6c 24 14 83 c4 18 c3 8d 76 00 8d bc 27 00 00 00 00 8b 0a 85 c9 75 09 83 7a 04 00 75 03 31 c0 c3 8b 52 04 29 ca 39 50 44 76 f3 <0f> 0b 90 8d 74 26 00 8b 4a 14 53 6b d9 50 8b 44 18 1c a8 01 75Aug 29 23:50:58 coolbox kernel: EIP: [<c030a069>] ttm_bo_check_placement+0x19/0x20 SS:ESP 0068:eaa33d70Aug 29 23:50:58 coolbox kernel: ---[ end trace c7e3e649e5a39cf1 ]---This is an out of memory error. Is it still an issue on a newer kernel and gfx stack?I do not have a working celestia at this time so I can't test it in the near future.
id=71801	Createdmessages from 3.13.6System is Debian Lenny, with 3.13.6 vanilla kernel.During shutdown I find the following lines in messages:Mar 10 15:02:43 newton kernel: waiting module removal not supported: please upgradeMar 10 15:02:43 newton kernel: waiting module removal not supported: please upgrade<7>[6985]: VMCI: Module vmci: unloadedMar 10 15:02:43 newton kernel: waiting module removal not supported: please upgradeThe second outputs a particular module (it's a VmWare Workstation one), but the first and the third lines what module do they refer to? Createdconfig 3.13.6changed in 3f2b9c9cdf389e303b2273679af08aab5f153517 module: remove rmmod --wait option. The option to wait for a module reference count to reach zero was in the initial module implementation, but it was never supported in modprobe (you had to use rmmod --wait). After discussion with Lucas, It has been deprecated (with a 10 second sleep) in kmod for the last year. This finally removes it: the flag will evoke a printk warning and a normal (non-blocking) remove attempt.kernel will simply proceed removing module, option is ignored----------those unknown modules simply print nothing on unload, but vmware prints somethingIs the kernel that prints"waiting module removal not supported: please upgrade"not the module itself, right?It would be better if was printed a message that identifies the module.In my opinion, if there's no point in writing a message it's better not to write anything. But if there was a point, it would be better to write something that lets know which the offending module is.I just found that "alsaconf" triggers some of those events (I found it by chance, but I don't know if it's the same that happens during shutdown).kernel prints those messages, yesit is just problem is generic, any module can trigger itIf the kernel prints those messages, it should know what module is being tried to be removed with that unsupported option. Still better would be to read what is trying that.And if it cares to say "please upgrade", it would be better to print some more detail. From a user's perspective, the question that arise is "please upgrade *what*?"I agree more details would be helpful (though I am surprised this is ever triggered). Printing the module name would help, but I'd like to get to the bottom of this before patching: we might have some other useful information to add.
id=51691	CreatedExample scriptOn my AMD Phenom II X6 1045T if a process uses multiple cores it has a very high cpu overhead (an average of 50%) compared to limiting the process to 1 cpu core. In the attachments is:- The script which was used for the test. It creates 2 threads which are in semi-idle (using ~10-20% of one core per thread on my system).- A log which shows top with a process (the script) which needed more cpu power before it was limited with taskset to 1 core. CreatedLog of top using 1 and 2 coresYou need to profile your application and interpreter at a low level - most likely you've got contention problems. Doesn't seem to be a kernel bug hereI have now port the script to C to exclude Python as the source of the problem. The bug appears there too. My cpu usage on 1 core with 2 threads is ~14% and on 2 cores with 2 threads ~21%.CreatedExample in CPlease close the bug, not a kernel problem.Infinite loop of usleeps(0.0000001) will in fact cause 'slight overhead'.usleep defined ranges [0,1000 000], not sure how did that float went unnoticed by compiler.nevermind my last comment.Don't worry - you have helped me to find a potential error in my testcase. I have updated it to use nanosleep() instead but the result is still the same - multiple cores will produce much overhead.CreatedExample in CHere is an updated version of the testcase. It uses now number of online core * 2 as threads because the overhead gets much higher with more threads. Here are the results on my system with 12 threads:Calling ./test will result in a cpu usage of ~185%/600%.Calling taskset -c 0 ./threads will result in a cpu usage of ~30%/600%.CreatedTestcaseCompiling with "gcc -o threads ./threads.c -lpthread".
id=113021	Createdjournalctl log part of shutdownOn a completely fresh installed archlinux install with just base and base-devel installed (UEFI64 dual boot with win10) running shutdown or systemctl poweroff will result in all services being stopped and partitions unmounted but wont fully shutdown. Eventually I see some INFO: task kworker/5:12:116 blocked for more than 120 seconds. not tainted 4.4.1-2 ARCH #1 messages popping up.looking into journalctl I was able to find a call trace and the folks in #systemd informed me to file a bug here.Attached is the part of journalctl running after shutdown is called. I also just noticed lspci completely hangs without producing any output and I can't stop the process. (eventually it starts printing the same blocked > 120s message)I managed to resolve it by installing proprietary nvidea drivers. now lspci produces output as expectedi suppose, then, that this is a bug in the open source nvidia driver.
