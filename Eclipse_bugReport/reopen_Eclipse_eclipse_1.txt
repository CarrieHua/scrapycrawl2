id=302926	REOPENED	Platform	UI	4.6	PC Windows 7	P1 normal	Platform UI Triaged	2010-02-16 04:34 EST by	JTRipper Mising name	2016-11-22 05:42 EST (	3 users	Hello everybody,I set the key binding for Export to Filesystem to CTRL+E. But When I press the buttons in the PHP-editor it just does not work. It works fine in the text editor.The console shows an unhandled exception:java.lang.ClassCastException: org.eclipse.php.internal.core.documentModel.dom.TextImplForPhp cannot be cast to org.eclipse.core.resources.IResource at org.eclipse.ui.dialogs.WizardExportResourcesPage.setupBasedOnInitialSelections(WizardExportResourcesPage.java:532) at org.eclipse.ui.dialogs.WizardExportResourcesPage.createControl(WizardExportResourcesPage.java:244) at org.eclipse.ui.internal.wizards.datatransfer.WizardFileSystemResourceExportPage1.createControl(WizardFileSystemResourceExportPage1.java:107) at org.eclipse.jface.wizard.Wizard.createPageControls(Wizard.java:170) at org.eclipse.jface.wizard.WizardDialog.createPageControls(WizardDialog.java:675) at org.eclipse.jface.wizard.WizardDialog.createContents(WizardDialog.java:549) at org.eclipse.jface.window.Window.create(Window.java:431) at org.eclipse.jface.dialogs.Dialog.create(Dialog.java:1089) at org.eclipse.ui.internal.handlers.WizardHandler.execute(WizardHandler.java:294) at org.eclipse.ui.internal.handlers.HandlerProxy.execute(HandlerProxy.java:294) at org.eclipse.core.commands.Command.executeWithChecks(Command.java:476) at org.eclipse.core.commands.ParameterizedCommand.executeWithChecks(ParameterizedCommand.java:508) at org.eclipse.ui.internal.handlers.HandlerService.executeCommand(HandlerService.java:169) at org.eclipse.ui.internal.keys.WorkbenchKeyboard.executeCommand(WorkbenchKeyboard.java:470) at org.eclipse.ui.internal.keys.WorkbenchKeyboard.press(WorkbenchKeyboard.java:824) at org.eclipse.ui.internal.keys.WorkbenchKeyboard.processKeyEvent(WorkbenchKeyboard.java:880) at org.eclipse.ui.internal.keys.WorkbenchKeyboard.filterKeySequenceBindings(WorkbenchKeyboard.java:569) at org.eclipse.ui.internal.keys.WorkbenchKeyboard.access$3(WorkbenchKeyboard.java:510) at org.eclipse.ui.internal.keys.WorkbenchKeyboard$KeyDownFilter.handleEvent(WorkbenchKeyboard.java:125) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Display.filterEvent(Display.java:1191) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1002) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1027) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1012) at org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:1040) at org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:1036) at org.eclipse.swt.widgets.Widget.wmChar(Widget.java:1368) at org.eclipse.swt.widgets.Control.WM_CHAR(Control.java:4053) at org.eclipse.swt.widgets.Canvas.WM_CHAR(Canvas.java:346) at org.eclipse.swt.widgets.Control.windowProc(Control.java:3946) at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:342) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4589) at org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method) at org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:2410) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3471) at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2405) at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2369) at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2221) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:500) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:493) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)	I do not think this is a pdt bug:) You can try xml/jsp editor and so on.But I will provide you a workaround for php files that in workspace(not work for external files).recover to the old code,because after I change the code,there are double submenu in editor context menu for menu team,compare,replace...As I have said this is not a pdt bug.Still relevant on Neon. Moving to platform.WizardExportResourcesPage doesn't check IStructuredSelection object before cast.The class assumes that the selection has been processed to only include resources, which doesn't seem to be the case for certain code paths.Would you be willing to submit a patch Dawid?(In reply to Brian de Alwis from)I can simply filter non IResource objects or use adapter framework for them. What it's preferable?Both ;) Filter the list by adapting each to IResource.I think the original expected code path usually went through FileSystemExportWizard, whose init() method does: List<?> selectedResources = IDE.computeSelectedResources(currentSelection); if (!selectedResources.isEmpty()) { this.selection = new StructuredSelection(selectedResources); }and IDE.computeSelectedResources() attempts to adapt each instance to IResource.New Gerrit change created:	7.0
id=175882	REOPENED	Platform	UI	3.3	PC Windows XP	P2 normal	Francis Upton IV	2007-02-28 13:31 EST by	Markus Keller	2011-04-21 03:40 EDT (	0 users	I20070227-0800, follow-up toScenario from:- new workspace- go to Resource Perspective- import plug-in "org.eclipse.core.expressions" as source- disable Java and Working Set extensions in the Project Explorer- search for references to method org.eclipse.core.expressions.EvaluationContext.getRoot()- on selected "getRoot()" in Search view, choose context menu > Show In > Project Explorer=> Project Explorer comes to frontExpected: should select the enclosing resource.Seefor a problem description.	Note that you cannot even show *.java files from the Package Explorer in the Project Explorer if the Java content extension is not enabled (since the Package Explorer selection is an ICompilationUnit.CommonNavigator.selectReveal(ISelection) should first try to select each element. If it cannot find an element, it should try to adapt it to IResource and select the result. If that fails as well, it should try to adapt to IWorkbenchAdapter and repeat the process on the result of IWorkbenchAdapter#getParent(..).CreatedPatchReady to go for M7.I took most of your suggestion Marcus, except that I put it in the ProjectExplorer. The CommonNavigator should not know about resources.Released to HEAD 3.6M7Verified in I20100426-0852CreatedImproved patch to consider for 3.7This patch was essentially what was checked into 3.6M7 but it broke some things, seeso it had to be backed out. This should be revisited for 3.7, but the patch is not right.It should do something like try the selection for each level of the tree.Reopened because fixed was backed out to fix	6.0
id=235768	REOPENED	Platform	UI	3.4	PC Windows XP	P2 enhancement	Francis Upton IV	2008-06-05 04:02 EDT by	David Sciamma	2010-03-18 12:05 EDT (	5 users	It could be interesting to be able to use the extensibility of the CNF in an Outline.Currently it is to deeply linked with the CommonNavigator View.	Can you elaborate on this a little more? Exactly what would you like the CNF to do in an outline view?We are interested in an extensible outline. Currently we are developing editors (graphical or forms) for EMF models and the outline is used to provide a treeview of the current edited model.First, models can be extensible so we want to extend the outline to reflect this model extension.But we can also imagine another scenario where several kind of treeview can be defined for a model (just like in the Team Synchronize view) and then the architecture of the CNF is perfect for this usecase.A solution could be to replace all the dependencies on CommonNavigator by an interface.This interface will implemented by CommonNavigator and CommonNavigatorPage (the IContentOutlinePage using CNF)Currently, the framework is not too dependent on CommonNavigator. Here are the methods from CommonNavigator used by the framework :----- CommonNavigator methods ----CommonNavigator.IS_LINKING_ENABLED_PROPERTYgetCommonViewer()getNavigatorContentService()selectReveal(newSelection)isLinkingEnabled()setLinkingEnabled()----- IViewPart methods ----addPropertyListener()removePropertyListener()getSite()getTitle()getViewSite().getActionBars()As you can see, only 5 IViewPart methods are used and can be extracted to an interface.Ok, it sounds like you want an ICommonNavigator interface or something like that so that you can provide your own implementation. But then how are you using the CommonNavigator? (I'm sure I'm missing the point here, please try and help me understand).When you talk about outline, you mean a specific outline implementation? If so, can you give me the class you are talking about. Do you mean that you want to decouple the current outline implementation from the CommonNavigator so you can provide your own?Can you accomplish this by subclassing the CommonNavigator (I know that subclassing is not "allowed" by the API definition, but I'm asking more to find out what you are wanting)?Creating an interface ICommonNavigator would be perfect. Then we can create an implementation extending ICommonNavigator and IContentOutlinePage.I am working on a prototype to test if it is possible and perhaps to initialize a patch if the community is interested.(In reply to)Ok, I would welcome a patch for this. Thanks.CreatedPatch to enable the use of CNF in an OutlineThis patch extracts generic methods from CommonNavigator to a ICommonNavigator interface and proposed a default implementation of this interface for outlines based on IContentOutlinePage.Modified files are all in the org.eclipse.ui.navigator project.This is a first implementation I've done to validate the concept. I currently extend the CommonNavigatorOutline to create a generic extensible outline for EMF models.(In reply to)Your patch has quite a bit of formatting changes which makes it difficult to determine the substantive changes. Can you provide a patch with no formatting changes so the differences only show what actually changed?CreatedUpdated patch using good formatI think it will be easier with this one...Sorry but what is your formatting options ? I cannot find the exact configuration.(In reply to)Generally the default eclipse options are used for formatting, though some projects tend to vary a bit from that sometimes. I'm not sure about the CNF code.Thanks for the patch, it's going to take me a little while to get to this, as I am only a part-time committer and need to devote time to bugs right now. Feel free to ping me (by commenting on the bug report) if you have not heard anything in a while.CreatedPatch supporting CNF in a outline (supporting menu extensions)I forgot to refactor some classes to support popup menu extensions. The new patch fixes this and works well but I don't like the way it is currently done. So I will try to propose another solution soon.Do you plan to integrate this kind of feature in 3.5 ?Do I need to integrate changes in the patch ?Because we really need this behavior to create customizable and extensible outlines.We created a first example of use in the Ecore Tools project and we would be interested to switch from the basic outline to this new extensible CNF-based outline.I have not looked at this yet, and probably won't for a couple of weeks. Assuming I agree it should be done at all (I have no opinion on it right now), it can certainly be done in the 3.5 timeframe. The reason for the delay is I'm focusing on 3.4.1 issues and bugs right now. Thanks for your patch and your patience, and feel free to ping me in a couple of weeks if you like.Do you have some time to look at this patch. This is a blocking point for me, as I wish to contribute an outline based on the CNF for the upcoming Eclipse Papyrus project. I would like to avoid duplicating code and I am so waiting for this feature to be implemented.Any news ?I like this and I want to get it into 3.5, which means it needs to go in soon, and into M6. However, the patch is much larger than 250 lines, and something bigger than 250 lines needs to get all kinds of approval.So here is what I would like to do to get this in:1) You should explain the steps at making the change based on your patch, but excluding your outline implementation. E.g. a) create ICommonNavigator as extracted from CommonNavigator b) any special methods you needed to add to ICommonNavigator c) any extra hooks you needed in other classes (you don't need to explain the mechanical stuff about extracting the interface, just the odd things you found -- including the issues aboutthe menu extensions).If you can do this in the next week or so, I will check it in shortly after that.2) File a different bug report offering the outline implementation. You can create a patch for that once the work on this bug report has completed. I assume your outline implementation will be < 250 lines.It seems that in trying to get CommonNavigator functionality to work as a page for use in a PageBookView, I've been pursuing this issue also.See. Attached are the classes CommonViewerPageView and CommonViewerManager, which is derived from NavigatorViewManager. I have not thoroughly tested all of this it seems to do the trick.Unfortunately the CNF now depends on the CommonViewer to store a pointer to the NavigatorContentExtension (it actually stores this in the TreeItem). I can't think of an straightforwards way to not have this dependency, given that you are not supposed to subclass the views.So I don't think we can do this.If you disagree and have a proposal, please reopen this.Others have been requesting this and we have done some abstraction in the Viewer area for having the viewer remember the CNF content. So I think we should reconsider this.	18.0
id=279390	REOPENED	JDT	Debug	3.5	PC Windows XP	P2 major	JDT-Debug-Inbox	2009-06-07 14:38 EDT by	Mark Foo Bonasoro	2013-12-27 15:56 EST (	7 users	Build ID: M20090211-1700When I try to view the contents of the static variable, Eclipse throws an error,'JDI thread evaluations', Exception processing async thread queue.Steps To Reproduce:1. Create or start using any J2ME project.2. Create a class with at least one static variable as a member.3. Set a breakpoint anywhere, setup a watch for that static variable that you want to view its contents.	The Eclipse Java debugger uses "create string" when creating "String" arguments to call methods like "classForName(String)", etc. We do this to force load classes, as well as to retrieve classes. If the required class is already loaded, we can use an alternate protocol.I'm on vacation this week and next, but perhaps David could push the bug back to JDT debug with his interesting find, and then we can try to improve behavior on the JDT side.Thanks,DarinFrom:David Marques <>To:Craig Setera <>Cc:Darin Wright/Ottawa/IBM@IBMCA, Paula Gustavo-WGP010 <>Date:07/14/2009 11:30 AMSubject:Re: RES: debug issueHello All, I have done a little research about this issue with Sun KVM and I have concluded that Netbeans DOES work on expression evaluation (adding watches to variables) while MTJ does not. I have scanned the debugger/KVM packet transfers and seen some differences on the packets that are sent on Netbeans and on MTJ. What is happening is that MTJ is trying to send a CreateString command () to the KVM and it does not support it so it returns an error reply and an exception is thrown on MTJ side.Regards,David MarquesPushing the bug to JDT as requested by Darin Wright.***has been marked as a duplicate of this bug. ***(In reply to)Reassigning to default inbox.CreatedpatchThis patch avoids creating string objects when the class is already loaded in the target VM.Applied/Fixed. Someone on MTJ needs to test/verify the fix.Createdadditional patchAdditional patch ensures class loaders are compatible.CreatedpatchI broke array allocation, fixed by this patch.Tested it with 3.6 M7 and it is still brokenVersion: 3.6.0Build id: I20100429-1549Tested with: 3.6 M7MJT 1.1Sony Ericsson 2.5.0.6 SDKI'm sorry but this is VERY frustrating to code like this. please fix this T.THow does it fail? What stack traces/error messages appear now? Someone that has access to such a VM needs to attempt to fix/debug this.Install the software I listed. create a hallo world j2me app. create a static variable. put a breakpoint anywhere in the app. run in debug mode. catch the breakpoint, and add the static variable to the watch list. BOOM!Exception processing async thread queueException processing async thread queuejava.lang.UnsupportedOperationExceptionEclipse PlatformVersion: 3.6.0.v20100427-9hF78GQHFvItsz0S5GyW7qqoQ6yMHokFS58Build id: I20100429-1549Mobile Tools JavaVersion: 1.0.1.v200909181641-7W7D7EFFt6Zb-appdsJXoBuild id: 200909181641	11.0
id=390820	REOPENED	Platform	Releng	4.2	PC Windows 7	P2 normal	Platform-Releng-Inbox	2012-10-01 09:14 EDT by	John Arthorne	2016-05-30 13:19 EDT (	4 users	This old documentation:Needs to be updated and migrated to a wiki page:	Initial porting with typo and link-fixes doneClean up commitawaiting review.(In reply to Matthias Mailänder from)I'm having a hard time "reading" the gerrit patch ... does it just deleting an image and html file?Yes, exactly. I convertedto MediaWiki syntax manually(syntax high-lighting ftw).(In reply to Matthias Mailänder from)Ok, and perhaps you should leave a very short "README" (if not very very brief version of an HTML file) that simply contained a pointer to the wiki? But, I'm fine removing those files as is, and you can decide how to handle.Shall I add a link to the wiki intomaybe?(In reply to Matthias Mailänder from)No, that's more a "legal document" which is required to be in every bundle. = = = = = = No, maybe you can educate me. I tried to approve and "push" it ... but, I don't see the change. Does it take a while, or do I need a workspace set up with the special URL and literally fetch it into my workspace and commit from there. I was under the impression Gerrit would put it in the repo. Maybe just takes more than 30 seconds.?Did you press "Publish and Submit" as indicated inat the end of the section?ok, got it that time. Thanks for the link.I (have) finally started actually reading this document, and there are some updates required some obvious, already made a few, and some are "unknown" ... that is, I want to leave this open until we confirm the system actually works as documented there (pretty sure there will changes, link updates, etc.).One bit of the document to update, is the section onThat should be changed to use the "OSGi" form of a bundle, instead of the previous "plugin.xml" form. Plus, I'd like to rename that bundle "org.apache.derby.core" (instead of org.apache.derby) which better matches the Apache documentation.	10.0
id=453379	REOPENED	Platform	User Assistance	4.5	PC Linux	P2 normal	Alexander Kurtakov	2014-11-27 04:10 EST by	Alexander Kurtakov	2017-01-26 02:25 EST (	3 users	Change hardcoded version of jetty-jspc-compiler maven plugin with a property from eclipse-platform-parent being set to jetty version we ship.	Patch against releng.aggregator to add the property:Patch against eclipse.platform.ua that has to be applied after the parent pom one:See also. I'm assuming there is only a loose dependency on the two bugs? (i.e. doesn't matter which is fixed first?)Also, can you briefly summarize the "effects" of this bug that a user sees?(In reply to David Williams from)As long as the version we ship is the same as the one we compile jsps with we are fine.(In reply to David Williams from)Ideally the effect should be that no unexpected breakage should happen - e.g. when using newer jsp/servlet in the jsp which would fail precompilation despite working at runtime.I don't mind making the change in the parent pom .... it's just adding a variable, after all, but I do not know enough about our help and JSPs to know if the change in help is the right one? I mean, it looks like it is, but just saying I do not know. To be more specific, it sounds like you are saying we no longer need org.apache.jasper.glassfish, which was described to me as "being responsible for compiling the JSPs", and is noted elsewhere as problematic (). So, is that true? I guess another way of saying this is have you tried out the change in a local build? Do the JSPs still get pre-compiled?(In reply to Alexander Kurtakov from)Well, let me ask some other ways. Is there a current problem? Specifying it with the old values? Also, Now that I've put the variable in the parent pom, should I change the "9.2.3" value to "9.2.5"? To match the version of Jetty we will (I hope) be using for M4? (and which is in "nightly" builds, for the moment). I guess another way of asking ... does this <jetty-version> variable specify a minimum required? Or the exact version required?Moving to "Help" component, for consideration of the second part of this proposed patch. (If for some reason "won't fix", I should revert the change in parent pom).(In reply to David Williams from)This is in not a fix for that bug. The reason is that there can be other bundles that provide help center content and contain jsp files. These would still have to be compiled no matter whether we precompile or not the jsp files we ship.Yes, works for me.(In reply to David Williams from)There is no current problem. What we achieve by using the same jsp compiler as the Jetty version we ship is - Once Jetty version is updated and it adds some new functionality (jsp related) this would be immediately usable in the jsp files. If the maven jsp compiler plugin is the old one - even if Jetty starts to provide newer functionality it can't be used in platform.ua jsp files as the maven jsp compiler would not have support for it.My idea is to heep things consistent - aka when the target file is updated to change Jetty version, the parent pom is updated too so jsp files are always precompiled with the version of Jetty shipped. This is exact version.(In reply to Alexander Kurtakov from)Ok, thanks. I have increased the version to the jetty that's in there now (as of last night's N-build) and added a comment to help remind me (or others) of what it is for, and when to update it. = = = = <!-- This jetty-version is used by the help system in building the JSPs, and should change when ever our "shipped" version of Jetty changes. --> <jetty-version>9.2.5.v20141112</jetty-version>(In reply to Alexander Kurtakov from)Submitted withCreatederror log from local test buildI have a feeling this is more complicated than we've been lead to believe? My local test build fails with an error related to jetty-jspc-maven-plugin:9.2.5.v20141112:jspcOr, is this a sign something is wrong with our JSP code?(In reply to Dani Megert from)The correct commit is:This failed in "nightly" build, too,So, not just an issue with "my machine". I was thinking of "fixing" it, by reverting the value in parent pom back to 8.1.8.v20121106 but then realized the "bundle name" changed too, from org.mortbay.jetty to org.eclipse.jetty, so just changing the version variable would not suffice. If someone can revert this change soon, I can re-schedule a "nightly" (just, because we are getting very near the end of M4), else, we'll just go straight to I-build at 8 AM Eastern. I suggest this be revisited after M4, unless it's obvious to someone what the "root" problem/fix is?(In reply to David Williams from)I case there is any doubt, on my local "mirror machine" I reverted back to org.mortbay.jetty 8.1.8.v20121106 and the build completed.David, would you please verify on your machine that eclipse.platform.ua is clean before the build is started (with all the new patches) run git clean -fd on it and retry. I have seen such issues in such case.Is git clean -fd run prior to the build?A build with 9.2.5 is running on my machine to checkBuild with 9.2.5 succeeded locally. I'll dig into jspc maven plugin config options so hopefully I can come up with a guess what could be wrong.(In reply to Alexander Kurtakov from)I'm pretty confident both environments I build on are clean (for example, I always remove the "local maven repository" ... in addition to the usual git repo clean up. Also, work to minimize "PATH" and make sure no System wide CLASSPATH set? We also do not use any .m2/setttings.xml file (I mention in case you do). The only thing I'd know to try to to remove git repo and let everything re-clone if you can't find any other explanation.Do we see a solution shortly? Otherwise I'll revert the change for the I-build.(In reply to Dani Megert from)The only property that probably affect it is <useProvidedScope>true</useProvidedScope>. This controls what is added on the class path for the jspc maven plugin. What I tried is with clean ~/.m2 I managed to get the build failing but if I had org.eclipse.help.* in ~/.m2 from previous build it works. Removing the property frommake it works for me in both cases. Can you verify?Probably affected by the switch of jsp implementation in jetty itself -.(In reply to Alexander Kurtakov from)Sorry Alex, I don't have time to verify this at the moment. Either I can revert or you propose a new patch which you're confident to work for the I-build that starts in 3 hours. Thanks.Please revert and let's wait for David to confirm.(In reply to Alexander Kurtakov from)Done withI was thinking we should "try" this again soon? But, didn't work, on my test system. Got this error: [ERROR] Plugin org.mortbay.jetty:jetty-jspc-maven-plugin:9.2.9.v20150224 or one of its dependencies could not be resolved: Failure to find org.mortbay.jetty:jetty-jspc-maven-plugin:jar:9.2.9.v20150224 inAnd, from some of the docs, say, atThey always refer to "9.2.9-SNAPSHOT". Does that mean there is no "released" version yet? ALSO, I am wondering if there is more we can do, from "maven plugin", instead of our (previously used for a long time?) "buildJSPs" ant file? For example, instead of changing "useScope" to false, to add dependencies onorg.eclipse.help, and org.eclipse.help, baseand mark the with <scope>. The whole reason I'm thinking such "a big change" might be worth is, is is. I believe the issue there, is the bundle is "built" in different ways, at different times, so the generated .api_decription is not included.(In reply to David Williams from)Hmmm, on "test builds", could not even find 9.2.9-SNAPSHOT ... we must be missing a "repository". I'll see if jetty dev list will help. [ERROR] Plugin org.mortbay.jetty:jetty-jspc-maven-plugin:9.2.9.SNAPSHOT or one of its dependencies could not be resolved: Failure to find org.mortbay.jetty:jetty-jspc-maven-plugin:jar:9.2.9.SNAPSHOT in(In reply to David Williams from)Oh, from their docs, I think "groupId" has chagned to org.eclipse.jetty(In reply to David Williams from)Blow by blow: yes, this was the only problem with updating the version. With group id corrected, finds it fine. Now results in 'compile errors' as before ... will investigate that a bit before updating but with "results".Status: I give up. For a while anyway. :) Higher priority issues to work on. I tried using "the latest" jetty, and I could not get any further than the attached error log. And tried half a dozen modifications, to no avail. I'm thinking 1) I may need to look at the source of that maven plugin. (It did not seem to behave, as documented). and/or 2) try the more traditional? ways of pre-compiling the JSPs, and maybe that would give me insight into what's missing. But, by all means, JSP/Maven experts are welcome to "take over". The only thing I'd prefer not to do is "install" the bundles (as in mvn clean install) as I think mentioned in a previous comment. That seems like "cheating" and would lead to a more fragile build, according to my intuition. Insights welcome.I think we should try this again in case it is causing. I think fromthe suggestion is to remove <useProvidedScope>true</useProvidedScope>? I'm also curious if the Java used to "run" that maven plugin is the one the build is using, or the one from the BREE? I'll try a few combinations locally.(In reply to David Williams from)closer, maybe? For my first attempt, I just changed the maven plugin to be accurate and current ... did not change useProvidedScope or anything. It seemed to got through the build without error, but trying to use Content Help immediate gave (in the help browser window) the message: = = = = = HTTP ERROR: 500Problem accessing /help/index.jsp. Reason: java.lang.NoClassDefFoundError: org/apache/jasper/runtime/JspSourceImportsPowered by Jetty:// 9.3.5.v20151012= = = = = =Note: in, Joakim Erdfelt said "the JSP Implementation (Apache Jasper) was updated between9.3.2 and 9.3.5 to address a number of bugs. Might have tripped overa new bug, or are now having your code validate properly due to a nowfixed bug."So ... I'm wondering if we have the right version, now? From Orbit, we have "javax.servlet.jsp" version="2.2.0.v201112011158"Tom, I can see in the log where we build org.eclipse.equinox.jsp.jasperAnd, I can see it adds following classes: [DEBUG] adding entry org/eclipse/equinox/internal/jsp/jasper/Activator.class[DEBUG] adding entry org/eclipse/equinox/internal/jsp/jasper/JSPContextFinder$1.class[DEBUG] adding entry org/eclipse/equinox/internal/jsp/jasper/JSPContextFinder.class[DEBUG] adding entry org/eclipse/equinox/internal/jsp/jasper/JspClassLoader$1.class[DEBUG] adding entry org/eclipse/equinox/internal/jsp/jasper/JSPContextFinder$Finder.class[DEBUG] adding entry org/eclipse/equinox/internal/jsp/jasper/JspClassLoader.class[DEBUG] adding entry org/eclipse/equinox/internal/jsp/jasper/BundleProxyClassLoader.class[DEBUG] adding entry org/eclipse/equinox/internal/jsp/jasper/JspClassLoader$2.class[DEBUG] adding entry org/eclipse/equinox/jsp/jasper/JspServlet$BundlePermissionCollection.class[DEBUG] adding entry org/eclipse/equinox/jsp/jasper/JspServlet$ServletConfigAdaptor.class[DEBUG] adding entry org/eclipse/equinox/jsp/jasper/JspServlet$ServletContextAdaptor.class[DEBUG] adding entry org/eclipse/equinox/jsp/jasper/JspServlet$1.class[DEBUG] adding entry org/eclipse/equinox/jsp/jasper/JspServlet.class= = = = = =And, I think this *might* be supplied as a jar inside bundles? If not obvious, I am just "guessing" here, but wondering if you can confirm if this bundle is still correct ... or, could it need updating?For the record, here is the "effective pom" as it appears in the build log. [DEBUG] -----------------------------------------------------------------------[DEBUG] Goal: org.eclipse.jetty:jetty-jspc-maven-plugin:9.3.5.v20151012:jspc (jspc)[DEBUG] Style: Regular[DEBUG] Configuration: <?xml version="1.0" encoding="UTF-8"?><configuration> <classesDirectory default-value="${project.build.outputDirectory}"/> <generatedClasses default-value="${project.build.outputDirectory}"/> <includes default-value="**/*.jsp, **/*.jspx"/> <keepSources default-value="false"/> <mergeFragment default-value="true"/> <pluginArtifacts default-value="${plugin.artifacts}"/> <project default-value="${project}"/> <projectArtifacts default-value="${project.artifacts}"/> <scanAllDirectories default-value="true"/> <tldJarNamePatterns default-value=".*taglibs[^/]*.jar|.*jstl[^/]*.jar$"/> <useProvidedScope default-value="false">true</useProvidedScope> <webAppSourceDirectory default-value="${basedir}/src/main/webapp">/data/shared/eclipse/buildsdavidw/4N/gitCache/eclipse.platform.releng.aggregator/eclipse.platform.ua/org.eclipse.help.webapp</webAppSourceDirectory> <webXml default-value="${basedir}/src/main/webapp/WEB-INF/web.xml"/> <webXmlFragment default-value="${basedir}/target/webfrag.xml"/></configuration>Createdend of log of failed local run(In reply to David Williams from)The build failed, when I removed this element (so default of "false" applied). Attached end-of-log where the failure occurred. I'm not positive what it all means ... but, think is mostly means we need <useProvidedScope>true</useProvidedScope>(In reply to David Williams from)Tom, from a little more searching, it appears "org.apache.jasper.runtime" package comes to "us" from org.apache.jasper.glassfish, which in turn is required by org.eclipse.equinox.jsp.jasper. I've written else where where it would be good to get rid of our dependency on "jasper.glassfish". Here is the "write up" on Orbit's download page, for org.apache.jasper.glassfish 2.2.2: Part of the JSP-2.2 implementation.This bundle, beginning with 2.2.2.v201501122222 embeds JDT compiler 3.8.3 (previous v2012 version had JDT 3.7.1, which caused runtime problems on Java 8). This new version also has optional imports on JDT, so if consumers need a higher level of JDT, they can include it in their plugins, and the newer version will be used. This plugin is considered deprecated. It is not an exemplary modular bundle as Orbit typically provides, and will likely be removed from active builds after Mars. Seefor details.So ... I think time to fix this mess correctly!Back to the original topic of this bug, I think there is a better way to implement it than originally suggested. Originally, it was suggested to have a variable, and then the help web app pom use that variable as the version of the plugin to use. But, from what I've learned sense, it is better to list plugins in the parent pom's <pluginManagement> section. And, there, at least the 'version' is specified, and then any poms that use the plugin do not specify any version, and they will get the version specified by the parent pom. And then no property is required. The one exception to that general rule might be if someone wanted he ability to override the property on the command line, but do not think that applies to this case, Please clarify if there is a use-case for the property, otherwise I will prepare the patches to put into <pluginManagemet> and the help bundle can simply remove the version. (But, we'll wait to at least get some marginally working version :) Right now I am trying out 9.3.3 jetty, to see if "that works", and if so, we can go with that for M3, and at least be a little better off than we were, while we figure out what else has to change to move up to 9.3.5.Agree that pluginManagement is better fit for this case.Createdold vs. new JSPs generatedThis zip contains the "index.jsp" as translated into Java code by our current (old) jetty-jspc-maven-plugin (version 8.1.8.v20121106), and the "new" translation, as done by the new jetty-jspc-maven-plugin (version 9.3.5.v20151012). I obtained these translations by adding <keepSources>true</keepSources>to the plugin's configuration in a local build. (We normally run with the default of false). The generated sources are pretty different, obviously. The most immediate difference, which is what causes the first error if we try to use it, is the main class implements org.apache.jasper.runtime.JspSourceImports. That causes an immediate "class not found" if ran on our help server. There are others I find curious ... not sure if they would produce errors, if we solved the JSPSourceImports problem: 1 the "old one" mentions a glassfish specific class: private org.glassfish.jsp.api.ResourceInjector _jspx_resourceInjector;2. the "new one" mentions a tomcat specific class: private org.apache.tomcat.InstanceManager _jsp_instancemanager;Ideally, some of you experts following this bug would be able to immediate summarize "why different". Is it merely a matter of the Jasper level used? Or is it more a matter that "something is badly wrong"? Or, maybe, even that our JSPs our hopelessly out of date? Or (and, I don't think so, given what I've read, and the few experiments I've tried) some way to "fix" the new version so it runs on our Help server? It seems they both compile during the build, producing .class files, without error (or, else, the error is "hidden" to the build process?). I assume that is because the maven plugins "pull in" what ever they need? From what I can tell, our old JSPs run on "the new server", but presumably only because we pre-compile them with "old" libraries? If we did not pre-compile them, they would not run? That is not good! (But, admit, I've not actually tried it ... maybe I'll try that next?I have learned some important things:Primarily, Jetty has good documentation. :) And it explains the situation pretty clearly. SeeI'll quote the most important points: - From jetty-9.2 onwards, we are using Jasper from Apache as the default JSP container implementation. In previous versions we used Jasper from Glassfish,- if you wish to, you can continue to do soBUT- Jetty maven plugins - jetty-jspc-maven-plugin [...] - will only use Apache JasperSo, our "equinox based Help server adapter" (if that's the right words) assumes the Glassfish jasper implementation. Long term, I think there are several general paths to follow: 1. Change our help server to use the apache jasper implementation. [This is my recommendation, then we could handleat the same time, and leave that old, sloppy orbit glassfish bundle behind us]. 2. We could "drop back" and stay on Jetty 9.1 forever. [This is basically, impossible, or very hard, since we've already released Mars.1 with 9.2 version]3. Perhaps Jetty could improve their maven plugin for "us" and allow an option to specify "glassfish jasper"? [long, long term, I am not sure this is a good idea ... since sounds like glassfish will always be "second class citizen" for Jetty? And, presumably, Jetty moved to apache Jasper for good reasons.] I'll post short term (M3) solution in next comment.(In reply to David Williams from)Whoops, left out another long term solution ... 4. Stop using maven plugin to pre-compile our JSPs, and use "antrun" with out old, currently non-working buildJSPs.xml file. I'm not sure what it would take to get that working, and does "make" us stay on glassfish Jasper, but, it is an option, so wanted to be explicit about it.Short term, I suggest for pre-compiling JSPs, we move to "the last version" that supported glassfish. I have already checked in the required change to the parent pom, under "pluginManagemnt".To use it, this requires our help webapp pom to change ### Eclipse Workspace Patch 1.0#P org.eclipse.help.webappdiff --git pom.xml pom.xmlindex 21ef0a5..bbf6bb7 100644--- pom.xml+++ pom.xml@@ -26 +26 @@- <groupId>org.mortbay.jetty</groupId>+ <groupId>org.eclipse.jetty</groupId>@@ -28 +27,0 @@- <version>8.1.8.v20121106</version>This at least puts us on the "supported" 9.x stream of Jetty, with current namespace. I've tested this, and appears to work, even if our "pre-req" of Jetty is at the 9.2 or 9.3 level. That's not a good long term solution, since if someone dropped "raw" JSPs into the help system, I am not sure they would work with our help server, but, for the short term, would at least be a step forward, IMHO.Really good investigation David.Option 1 sounds like the only long term viable solution.Which bundle explicitly requires glassfish jasper? I can't seem to easily find my way.Dani, and Tom, I think you two will need to make the "executive decision" on what to plan for long term. InTom hints that progress has been made on using Apache Jasper ... but, not sure if people are available to finish that work? Nor how long it would take? [And, then once we decide what to do for Neon, we face a similar decision on what to back-port to Mars, since we released 9.2 version of Jetty there, we might have similar problem, from some adopters, eventually? Or, perhaps its fine ... that our shoe-horn of that old glassfish bundle suffices? I do recommend for M3 we still upgrade to Jetty 3.5. I think we will still have the problem inbut a) don't think Users will see that, and b) I *think* the problem is in our "search client", so will make it possible to track that down.(In reply to Alexander Kurtakov from)Neither can I. :) But, I think it is not an explicit requirement, but is "hooked in" by org.eclipse.equinox.jsp.jasper, in some way? (Or, probably, org.eclipse.equinox.jsp.jasper.registry). Appears like a lot of abstraction and "indirection" is built in, but ... ends up with some assumptions on org.apache.jasper.glassfish (which is a "custom" version).New Gerrit change created:(In reply to Eclipse Genie from)Not sure why the Gerrit build failed. It worked for me locally, so might be a function of how the Gerrit build works (building just one repo, using stuff from previous Nightly builds, if needed)? But I can also make sure my local environment is "in synch" and try again later in the day.(In reply to David Williams from)For the record, I think the Gerrit job failed due to a double oddity of the Gerrit builds. They apparently run as "I-builds". So some of the bundles are "swapped out" for earlier built ones. In fact, if the output log, I see org.eclipse.help.webapp_3.7.0.v20150811-0049BEFORE, the jspc task runs (Note the date from several months ago). BUT, I tried adding a "touch" to the webapp bundle, and it still failed in same way. I do think things would be fine if we did a complete build (since it works on my local system, as both N and I builds). But, should probably only do that if the committer was around to revert. :) It could be something else, but suspect with the full build, the "reactor" has more packages in it, to satisfy the sl4j requirement.(In reply to David Williams from)I've tried everything. Both to reproduce the problem with a "local build", and to fix the Gerrit build. I could do neither. I've supplied more details in- Investigate difference between Gerrit build validation job and the Releng buildbut what ever is the problem with Gerrit, it won't effect our "real" build. I'm confident in the final version of the the patch, which changes group id to org.eclipse.jetty, and removes the version element. Plus, 'touches' the force qualifier update.(In reply to David Williams from)I have narrowed down the reason for the Gerrit build failure -- it is related to Hudon's use of "embedded maven" for their maven task, and them copying a few, but not all, of SLF4J classes into a bundle used by the embedded maven task. I have opened bugs on them, and on Jetty's JSPC maven plugin. Not sure if one is the root problem, or if they both are wrong. Seeand. After realizing the embedded Maven plugin was one of the causes, I did create a new Gerrit job, just like the previous one, but which invoked maven more directly, simply from a bash script.And that invoked the jspc plugin just fine. The output looks very similar to what our current 8.x one does, except the output folder is wrong. It outputs to .../org/apache/jsp/ instead of .../org/eclipse/help/internal/webapp/jspI will investigate the 'configure' options more, and submit a new Gerrit patch.(In reply to David Williams from)No matter what I try, I can not get this to work as expect. I can get the JSP precompiled classes to go into a package (root) of org.eclipse.help.internal.webapp.jsp.org.apache.jsp, but not -- as with 8.x version -- to go into simplyorg.eclipse.help.internal.webapp. Interestingly enough, it still seems to work (from a small bit of testing) but I do not feel comfortable trying to make an incremental change to use the 9.1.5 maven plugin with this and other oddities when our ultimate goal is to use the 9.3.5 maven plugin. That is, the version of the Jetty server we ship is 9.3.5. There are a couple of oddities that contribute to my discomfort. 1. The only place I see "org.apache.jsp" "hard coded" as a package name is in org.apache.jasper. So that makes me think we are ending up with the "wrong" jasper. (not Glassfishes's as we have been using). Of course, there are ways override that and to "set" the package name, but none of them work because, I assume, we are ending up with a mismatched set of plugins on the classpath. 2. In the build log, when the 9.1.5 maven plugin begins processing, I can see Tycho pulling in the 9.3.5 "server stuff" to put on the classpath -- and not 9.1.5 "server stuff". This makes some sense since we have 9.3.5. in our prereqs -- but is a higher version than we want. When 8.1.x begins processing I can see in the log that the 8.1.x server stuff is pulled into classpath even though we do not have that on our classpath. I am not sure if it is Tycho, Maven, or Jetty that is using a "major compatible rule" ... but, in either case, we are not getting exactly what we want or expect when using 9.1.5 maven plugin. Hence, I conclude, we should not change Maven plugins, until we are ready to move off of the glassfish based server and modernize the complete server stack.Or, until someone wants to spend a week or two bullet-proofing that part of the build so we always have the right server on the classpath when we precompile the JSPs. (I tried a few simple things, but ... had little or no effect.)(In reply to David Williams from)I "take this back". After carefully study the docs and source code for the maven plugin, I see there is no way to set the desire package name, from the maven plugin. They just didn't implement it, for some reason. Even putting the jsps in a different source folder, under org.eclipse.help.internal.webapp.jsp still ends up with "org.apache.jsp" *prefixed* to the beginning of the package name. For what its worth, I see on the Tomcat Apache site, for Jasper, the definitive guide, as far as I am concerned, it says "Using Ant is the preferred way to compile web applications using JSPC". This makes me think no maven plugin is as good as the Ant task made for the purpose ... but not positive that is what they meant.But suggest we may want to switch back to using an Ant task for better control.New Gerrit change created:Gerrit changewas merged to [master].Commit:Switching to jetty-jspc-maven-plugin 9.4.0 as we have as a dep pulls jetty 9.4 jars, doesn't create the additional org.apache.jsp package and in general seems to just work.New Gerrit change created:I don't know how I managed to see the package name change in reverse.Gerrit changewas merged to [master].Commit:New Gerrit change created:Gerrit changewas merged to [master].Commit:(In reply to Eclipse Genie from)Moved to 9.0.7 (the last version I managed to get working) to get the same maven groupId - quite important for building from source as org.mortbay.jetty is not available anymore.Ping! M5 is on Friday.Unset target as this would require more work.	63.0
id=207206	REOPENED	Platform	SWT	3.3.1	PC Linux-GTK	P2 major	Grant Gayed	2007-10-23 14:12 EDT by	Preet Shihn	2010-05-27 15:32 EDT (	9 users	Createdthe jvm crash log file Build ID: I20070625-1500Steps To Reproduce:I am using the swt browser (mozilla) for my plugin. I am making extensive XPCOM calls in this application. This happens randomly on linux, so there are no definitive steps to reproduceMore information:I am using the swt browser (mozilla) for my plugin. I am making extensive XPCOM calls in this application. This happens randomly on linux. I am using xulrunner version: 1.8.1.3I have attached the jvm crash log. This log was generated on the following configuration:Operating System: Linux - Ubuntu 7.0432 bit machine	Preet:Could you try what you get with another JVM, like the latest Sun released for Java5?JDK 5.0 Update 13 ?CreatedJVM crash log with Java 5 update 13got the same exception with Java 5 update 13. See the second attached crash log fileCreateda test plugin to reproduce the problemCreatedfiles required by the test pluginI have added a plugin that might help reproduce the problem, and also a zip file containing the test files (html pages) to test the plugin. Steps:1) Unzip the test files somewhere e.g /home/user/testfiles2) use the attached plugin with the standard xulrunner and xpcom plugins3) in the plugin, in class "EditorAction", go to line 61, and replace the "file://" url with the url to where you unzipped the test files (e.g. file:///home/user/testfiles/index.html"4) When you run the plugin in eclipse, it adds a tool bar item. When you click on it loads the web page and automates through the web pages. 5) During the first run you might get a browser security warning. Uncheck "alert me whenever I submit information that is not encrypted" so that we don't see this in the next runs. 6) Let it run for 5-10 minutes. Usually it will crash in the 5-10 minutes.Looking into it now.If I recall correctly, we used to get crashes like this in Linux, inside the GTK/GDK libs. Those crashes were fixed by moving up to a later Linxu distro, with newer GTK.But you seem to be using a pretty recent distro. So this is either another bug in the GTK code, or the Mozilla code is passing bad values to gdk_window_new.Might try to build a debug XULRunner build and see if you can find out anything by debugging the crash.I have tested this issue using the latest versions of GTK (2.12.9) and Eclipse (I20080312 - after fixing). It always crashes.While I was debugging GTK, I noticed that gdk_window_new was called by a destroyed parent.The problem seems to be in the following code:org.eclipse.swt.browser.Mozilla.java (lines 1328-1331, Eclipse 3.3.1.1)nsIBaseWindow baseWindow = new nsIBaseWindow (result[0]);rc = baseWindow.Destroy ();if (rc != XPCOM.NS_OK) error (rc);baseWindow.Release ();I think that calling the Release method after Destroy isn't an error, but unnecessary and causes a crash in this case.If I comment line 1331// baseWindow.Release ();Eclipse won't crash when executing the test from.The steps to check:- import the org.eclipse.swt.gtk.linux.x86 plugin with the source code- open org.eclipse.swt.browser.Mozilla.java and comment the following line// baseWindow.Release ();It is line 1331 in Eclipse 3.3.1.1- start PDE with the plugin from(check wether the Launch configuration includes the org.eclipse.swt.gtk.linux.x86 plugin from the workspace)- call the "Hello, Eclipse World" actionThe result - Eclipse doesn't crash (even when using the older GTK - 2.8.x)(In reply to)Aha, we have spend quite a bit of time working on that one lately and going with a debug build of xulrunner.Let me try that right away.And that works we can re-assign to SWT then.Moving to swt tooI made some extensive tests on SWT 3311 (3347) and XR 1813 latest released at mozilla:and it proves very stable so far.The example is running in a background thread, which swt does not support, and I suspect is what's confusing it in this case. Unfortunately changing the example to run its work in the main thread (done by wrapping the _Engine.execute(...) in a display.syncExec(...)) doesn't get far because it waits on some condition to occur after the first iteration. So I'm not able to confirm whether the background thread use is the cause or not.Though removing the Release() call makes the crash go away, it doesn't seem right at this time because it goes against how ref-counting should and does work throughout the rest of the Browser. If it were to fix a crash in a single-threaded case then putting it in based on observation could be better justified. Can the example be modified to run in the main thread?In my opinion, a background thread isn't a problem in this case. Opening the editor (and SWT/Mozilla functions) is called correctly in the main thread.There are several reasons for that:- the example is executed correctly on Windows- the crash always happens in the Mozilla.onDispose() method. This test case always calls onDispose in the UI thread (I tested that). I can't imagine how would commenting the Release() method prevent the crash if the onDispose method would be called in a non-UI thread. The crash would certainly happen just after the start of the method. The client can't call this method.- JBoss Tools tests are executed in the main thread and crash randomly on Linux. The workaround fromsolves the crash.- while I was debugging GTK, I noticed that the problem was that the gdk_window_new method was called with a destroyed parent.- in the following way you can change this example to be run completely in the main thread1) wrap the _Engine.execute(...) in a display.syncExec(...)2) add a progress listener that will wait for the browser to load a page.3) comment calling the waitForTarget method in the Engine.javaThe example, probably, won't do what is expected, but will crash in the same way.I agree with your opinion related to removing the Release() method, but a potential memory leak is a less problem than a crash.Also, it is the question whether the Release() method is necessary after Destroy().The following is the doc. for the Destroy() method:"Tell the window that it should destroy itself. This call should not benecessary as it will happen implictly when final release occurs on theobject. If for some reaons you want the window destroyed prior to releasedue to cycle or ordering issues, then this call provides that ability.@return NS_OK - Everything destroyed properly.NS_ERROR_UNEXPECTED - This call was unexpected at this time.Perhaps create() has not been called yet."I tried to comment the Destroy() method first. However, Eclipse still crashed. It crashed even if I commented both methods - Release() and Destroy().It doesn't crash only in the case the Release() method is commented.I suppose that there is a bug in the Mozilla GTK implementation.This workaround works correctly, not only for this case, but also for some other cases (JBoss Tools tests, for instance). However, they happen randomly.The workaround could be applied to Linux only. It wouldn't have to be applied to other OS-s.(In reply to)Grant: we did some extensive tests on our side, and that proved very stable, with no side effects.You think it could make the 3.4 cut?is this not something that should go both to 3.3.x and 3.4 ?I don't think there are any more 3.3.x releases planned.I've changed the example to run in the main thread and it still crashes. I have one last avenue I want to investigate, and if that does not help then I'll make the change as suggested. I should know later today and will update here.CreatedpatchI've narrowed it down to a cause that makes more sense. Wrapping the Browser's nsIWebBrowser in a JavaXPCOM object results in the nsIWebBrowser being automatically Release()d later when the object is finalized. The attached patch AddRef()s the nsIWebBrowser when it gets wrapped in order to offset this automatic Release() that happens later. This is essentially equivalent to commenting out the Release()ing of its nsIBaseWindow at dispose time, but only affects cases where Browser.getWebBrowser() is called.fixed > 0409BTW thanks Snjezana for your investigation of this. Your find about commenting baseWindow.Release() was a good hint that there was a reference counting problem.Grant: mucho thanks!The solution fromcauses a memory leak like the solution from(it also adds an unnecessary memory leak on non-Linux platforms).Namely, the code :Class clazz = Class.forName ("org.mozilla.xpcom.Mozilla"); //$NON-NLS-1$Method method = clazz.getMethod ("getInstance", new Class[0]); //$NON-NLS-1$Object mozilla = method.invoke (null, new Object[0]);method = clazz.getMethod ("wrapXPCOMObject", new Class[] {Long.TYPE, String.class}); //$NON-NLS-1$webBrowserObject = method.invoke (mozilla, new Object[] {new Long (webBrowser.getAddress ()), nsIWebBrowser.NS_IWEBBROWSER_IID_STR});adds a reference to the webBrowser object that is released by the Java Garbage collector (XPCOMJavaProxy.finalizeProxy)If we add yet another reference (), the webBrowser object will be leaked. I have checked this using the procedure described on.If the Mozilla.getWebBrowser() method isn't called (using an ordinary web browser), a leak doesn't happen.In the meantime, I found a fix that doesn't cause a leak.The real problem is the Mozilla.getWebBrowser() method. Java XPCOM adds a reference to the webBrowser object in this method and it is released by the Java Garbage collector.It is, however, too late and causes a crash on Linux.I have done the following:- called XPCOMJavaProxy.finalizeProxy() on the webBrowserObject object earlierAt the start of the Mozilla.onDispose() method, I have added the following code :if (webBrowserObject != null) { try { InvocationHandler handler = Proxy.getInvocationHandler(webBrowserObject); Method method = handler.getClass().getDeclaredMethod("finalizeProxy", new Class[] {Object.class}); //method.setAccessible(true); method.invoke(handler, new Object[] { webBrowserObject }); webBrowserObject = null; } catch (Throwable e) {} }Since the XPCOMJavaProxy.finalizeProxy() method mustn't be called more times, we need some assistance within the XULRunner code.I have made the following changes in the XPCOMJavaProxy.java class:- added the following fieldprivate boolean proxyFinalized = false;- changed the finalizeProxy() method to the following:public void finalizeProxy(Object aProxy) throws Throwable { if (!proxyFinalized) { finalizeProxyNative(aProxy); proxyFinalized=true; } super.finalize();}After these changes have been performed, Eclipse doesn't crash and nsWebBrowser objects aren't leaked.OK, I somewhat understand the problem, but not fully. First, I want to apologize to Grant for giving him incorrect information. Snjezana is correct -- 'webBrowserObject' already has the proper number of references.(In reply to)I don't understand why there is a crash at all. The 'webBrowserObject' is set to null after the 'baseWindow' calls. The Java object should not be finalized until that point (at which point it releases the XPCOM object, which should on longer be necessary). What is "too late"?This should not be called by code outside of JavaXPCOM. It would be best to avoid doing this.Why at the start of 'onDispose()'? I'm wondering if this isn't an issue with the interplay between the 'webBrowser' and 'webBrowserObject' Java objects. Snjezana, if you have an Eclipse + Mozilla debug environment set up, can you take a look at something: in 'getWebBrowser()', the XPCOM object that is associated with 'webBrowser' should have a 'refCnt' of at least 1. After the call to 'wrapXPCOMObject', that should increase by one.Then in 'onDispose()', the calls to 'webBrowser.release()' and 'webBrowserObject = null' should each decrease the 'refCnt' of the XPCOM object (the latter using 'finalizeProxy', as you have found out). When refCnt == 0, the XPCOM object is deleted. Is this happening sooner than expected?(In reply to)>This behaves as expected. 'webBrowserObject=null' doesn't decrease the 'refCnt'. It only causes the finalize method to be called.(In reply to)We can call the code I have added (finalizeProxy) anywhere in the OnDispose method before line webBrowserObject = null;I am not at all sure why this code prevents the crash, but have a few ideas:- the onDispose() method is executed before XPCOM finalizeProxy methodWhile the finalize method is executing, it calls gdk_window_new with a destroyed parent what causes the crash.The gdk_window_new method is called from mozdrawingarea.c. In the gtk code (gdkwindow-x11.c) I have tried the following: - ignoring calling gdk_window_new when a parent is destroyed. This causes the "No more handles" error in SWT (there isn't any crash, but Eclipse is blown up)- calling g_main_context_wakeup (I guessed it was called in a non-UI thread) in mozdrawingarea.c before calling gdk_window_new, what didn't have any effect because the method had already been called in the UI thread.- commenting line delete inst;in nsJavaWrapper.cpp (finalizeProxy), prevents the crash. It isn't a fix because it causes a memory leak, but helped me, leading me to conclude that releasing an XPCOM object causes the crash. After all, I can imagine two reasons to cause the crash:- somewhere, between the call onDispose and finalizeProxy - GTK, X server or ... sends an event to the webBrowser object. Since baseWindow is destroyed, this causes the crash. In my opinion, this is the most likely cause. My code prevents this because finalizeProxy is called in the onDispose() method - the reason why I said that the finalizeProxy is called too late.- because of some bug in GTK, g_main_context_wakeup fails to wake up the UI thread what causes the crash. Anyway, I don't think this is the reason. We would have crashes in different places if g_main_context_wakeup wouldn't work correctly.I believe that XPCOM code and Mozilla.java are correct and that the problem is in GTK or in X server because Eclipse and XULRunner work correctly on Windows.(In reply to)>I understand this, but don't know how to solve this issue in some other way. The webBrowser object seems to have to be destroyed earlier (in onDispose) or we have to patch GTK and/or X server code or ... any other idea?(In reply to)This is why I don't like the solution from. You are asking to place code in two different products in order work around a bug in GTK.I think we need to track down this bug and fix that there. In the meantime, the best work around may be to have the AddRef as mentioned in(for GTK only) and just leak the object.So how to we figure out what is actually happening in GTK to cause this crash? Why is gdk_window_new called during the finalize method?(In reply to)My assumption is that either GTK or X Server or ... sends an event(s) to the webBrowser object when its parent is destroyed.I don't know whether this is a bug in GTK, X Server or there is some other cause.In my opinion, it will be difficult to solve it and leaving a known memory leak isn't the best solution.What is certain is that calling finalizeProxy earlier fixes the crash and doesn't introduce a memory leak.The fix is very simple and doesn't require breaking XPCOM API. The finalizeProxy method can stay protected because we already use reflection.It would be enough to prevent calling this method more times. That would even make XPCOM code more robust.Thanks everyone. So, I am assuming that the current fix is the final fix?Is it possible that the mucking with the reference count might have caused a memory leak somewhere?If Browser.getWebBrowser() is used then I think there will be a leak with that instance.So, what would be the alternative to get the WebBrowser instance?Should i reopen this issue for the memory leak, or file another one?There isn't an alternative to getWebBrowser() if a client will be using JavaXPCOM.I started creating a new bug for the leak, but since it reduces to fixing this report's crash without adding the extra ref, I think it makes more sense to just reopen this one.Cool. For now, I think I am happy with a memory leak rather than a nasty crash. :)Any movement on this after it was reopened?([Browser] fix jvm crash without adding extra ref)I think there is a strain of this problem that still exists. I have been consistently seeing similar crash on RedHat Enterprise Linux 4.0 AS. I am attaching the jvm crash log.Trying to figure out why this could be happening, I built a debug build of xulrunner and attached gdb to it to see the stack trace. Here is what it looks like. It is consistently the same:#0 0x00c24dfe in g_type_check_instance_cast () from /usr/lib/libgobject-2.0.so.0#1 0x9e950aea in nsWindow::NativeShow (this=0x8f67398, aAction=0) at /home/fanfare/mozilla/widget/src/gtk2/nsWindow.cpp:2836#2 0x9e94ac15 in nsWindow::Destroy (this=0x8f67398) at /home/fanfare/mozilla/widget/src/gtk2/nsWindow.cpp:396#3 0x9e94a664 in nsWindow::~nsWindow$base (this=0x8f67398) at /home/fanfare/mozilla/widget/src/gtk2/nsWindow.cpp:328#4 0x9e9543a9 in nsChildWindow::~nsChildWindow$delete (this=0x8f67398) at /home/fanfare/mozilla/widget/src/gtk2/nsWindow.cpp:4533#5 0x9e96610b in nsBaseWidget::Release (this=0x8f67398) at /home/fanfare/mozilla/widget/src/xpwidgets/nsBaseWidget.cpp:102#6 0x9e94aa35 in nsWindow::Release (this=0x8f67398) at /home/fanfare/mozilla/widget/src/gtk2/nsWindow.cpp:87#7 0x9df7190e in nsCOMPtr<nsIWidget>::~nsCOMPtr (this=0x8ed6f58) at ../../../dist/include/xpcom/nsCOMPtr.h:583#8 0x9e6b132c in nsWebBrowser::~nsWebBrowser$delete (this=0x8ed6ef8) at /home/fanfare/mozilla/embedding/browser/webBrowser/nsWebBrowser.cpp:127#9 0x9e6b1763 in nsWebBrowser::Release (this=0x8ed6ef8) at /home/fanfare/mozilla/embedding/browser/webBrowser/nsWebBrowser.cpp:174#10 0x9dc0bdc1 in HandleProxyReleaseEvent (self=0x9009c98) at /home/fanfare/mozilla/xpcom/proxy/src/nsProxyRelease.cpp:7#11 0x9dbf990a in PL_HandleEvent (self=0x9009c98)---Type <return> to continue, or q <return> to quit--- at /home/fanfare/mozilla/xpcom/threads/plevent.c:688#12 0x9dbf97ab in PL_ProcessPendingEvents (self=0x8e23c78) at /home/fanfare/mozilla/xpcom/threads/plevent.c:623#13 0x9dbfce16 in nsEventQueueImpl::ProcessPendingEvents (this=0x8e23d08) at /home/fanfare/mozilla/xpcom/threads/nsEventQueue.cpp:448#14 0x9e9561b4 in event_processor_callback (source=0x8e251c8, condition=G_IO_IN, data=0x8e23d08) at /home/fanfare/mozilla/widget/src/gtk2/nsAppShell.cpp:67#15 0x00a4c907 in g_vasprintf () from /usr/lib/libglib-2.0.so.0#16 0x00a2874b in g_main_context_dispatch () from /usr/lib/libglib-2.0.so.0#17 0x00a2a1d2 in g_main_context_acquire () from /usr/lib/libglib-2.0.so.0#18 0x00a2a6b8 in g_main_context_iteration () from /usr/lib/libglib-2.0.so.0#19 0x02f1c827 in Java_org_eclipse_swt_internal_gtk_OS__1g_1main_1context_1itera tion () from /home/fanfare/.iTestConfiguration_3.3/org.eclipse.osgi/bundles/154/1/.cp /libswt-pi-gtk-3448.so#20 0x0118bfa6 in ?? ()#21 0x083924f4 in ?? ()#22 0xbfe4bee8 in ?? ()#23 0x00000000 in ?? ()(gdb)This happens when a window is being closed. It seems like the JavaXPCOM code is trying to release a window object that has already been released. It seems to appear primarily when a chrome window is launched, e.g. the window that asks the user to accept the HTTP certificate. It does not happen all the time, but intermittently, which makes me think that there is some sort of race condition when disposing the window object. I would also like to bring it up again that the original fix caused a memory leak for applications using the getWebBrowser method to access the XPCOM object. FYI, the xulrunner used to do the debug build was mozilla branch FIREFOX_2_0_0_16_RELEASE. The debug build i had was not stripped, so it has all the file names and line numbers. It would be really cool, if someone takes a look at it. Please let me know if I can help with anything.CreatedRHEL JVM crash logThis is the latest crash logAnyone interested in this issue, I would really appreciate if someone investigates into this.I am also interested in fix for this issue. I will really appreciate if some fix or work-around available for it. Thank you so much in advance.I am assuming from the silence on this that no one cares about fixing this any more? We need a fix for this in some way or form - but do not have anyone who is expert in SWT, XPCOM, etc... It will be nice if people who understand this issue get us a fix.I don't think thatis the same issue, so I've createdfor it. This bug (207206) is concerned with finding a fix for this report's original crash that does not require adding an extra reference to the underlying nsIWebBrowser.	37.0
id=347947	REOPENED	Platform	SWT	3.7	PC Mac OS X	P2 normal	Platform-SWT-Inbox	2011-06-01 10:27 EDT by	Oleg Besedin	2016-03-30 02:36 EDT (	16 users	+++ This bug was initially created as a clone of+++We have several tests in JFace test suite that started intermittently fail after the recent Mac OS upgrade.The tests seems to fail on 10.6.7 using both 64 bit and 32 bit VM. The tests fail for both 3.6.2 and 3.7. The tests pass on 10.5.8.This means that there is likely change in behavior in Mac OS 10.6. The failing tests:SimpleVirtualLazyTreeViewerTest testCreation() assertTrue("call to updateElement expected", updateElementCallCount > 0); testRemoveAt() assertEquals(2, ((IStructuredSelection) treeViewer.getSelection()) .size());AbstractTreeViewerTest testRefreshWithAddedChildren() assertNotNull("new child is visible", fViewer.testFindItem(child));StructuredViewerTest testDeleteSibling() assertNotNull("first child is visible", fViewer.testFindItem(first)); testInsertSibling() assertNotNull("new sibling is visible", fViewer .testFindItem(newElement)); testInsertSiblings() assertNotNull("new siblings are visible", fViewer .testFindItem(newElements[i])); testSetInput() assertNotNull("first child is visible", fViewer .testFindItem(firstfirst)); testSomeChildrenChanged() assertNotNull("new sibling is visible", fViewer .testFindItem(newElement)); testWorldChanged() assertNotNull("new sibling is visible", fViewer .testFindItem(newElement));	Please seeand the associated change in the.Ping. Any chance this could be looked into in M2?Changing target milestone to 4.3. This should be looked at early in the cycle.SSQ, please have a look at FH's comments inand.What is the current status of these test failures with the latest versions of Eclipse and Mac OS? Are the failures still happening?Abhishek, can you check whether this is still a problem and continue the investigation if needed? Thanks!(In reply to Arun Thondapu from)The tests are passing now. This bug can be resolved.(In reply to Abhishek Kishore from)You should state here that you've removed the Cocoa exclusion in the tests (ViewerTestCase#disableTestsBug347491), and you should also state the OS version you used to verify.(In reply to Abhishek Kishore from)Resolving the bug as 'WORKSFORME' as the test failures cannot be reproduced anymore. Please reopen in case the problem is seen again.has not been answered. It's no wonder that disabled tests don't fail.There are still problems with virtual trees on the Mac (e.g.), and the JFace tests in org.eclipse.ui.tests could help identify those problems.(In reply to Markus Keller from)Sorry my bad, I assumed the tests were enabled and are passing now.Abhishek, can you please take a re-look at the disabled JFace tests?(In reply to Arun Thondapu from)I'm explicitly running the test cases mentioned in the bug. All of them are passing for me. I'm testing with Luna RC4 on OSX 10.9.3. I'll test on OSX 10.6.x as well, see if it happens.The tests pass in I20140606-1215 on Mac OS X 10.9.3 becauseeffectively disabled them.On the Mac, SetData always seems to be late. But it's hard to identify the real cause, since SWT still doesn't have an API for SetData, see.If SetData can be delayed even if Display#readAndDispatch() returned false, then the API should specify that, and tests should be updated to conform to the API (e.g. by waiting with a timeout).has the interesting analysis of this bug:I see similar set of tests failing on Ubuntu 14.10.We will investigate this post 4.5.We need verify this on OSX 10.11. We'll not be able to investigate this for 4.6. Deferring for now.	15.0
id=130545	REOPENED	Platform	Ant	3.1	PC Windows XP	P2 normal	Platform-Ant-Inbox	2006-03-06 09:27 EST by	Ed Burnette	2013-12-17 09:16 EST (	34 users	3.2M5 on Windows XP SP2, Sun JDK6 beta (but noticed on JDK5 as well)On my RCP product in the Product Configuration editor I click on the Eclipse Product export wizard and click Finish to export the product just like last time. Each time I do this about 10M of permanent generation space is leaked. You can see it being leaked using the plug-in in. According to that tool, the permgen space is:before export: 39793Kafter 1 export: 47788after 2 exports: 58915after 3 exports: 64131 (gc/weak mem management starts to fight it)after 4 exports: 64117 (but isn't quite able to keep up)after 5 exports: 55684 (each one is slower than the last until finally...)after 6 exports: java.lang.OutOfMemoryError: PermGenSpace The dialog says the error occured in build.xml line 147Eclipse won't do any further exports until you restart it at this point.	Export uses AntRunner to run generated scripts. This same problem can be reproduced manually by repeatedly running any ant xml file as an ant build. I did it with a simple xml that just echoed a message to the screen.It looks like the AntClassLoader is staying around after each run along with all the classes it loaded. I used Sun 1.5.0_06-b05So I have Eclipse 3.2 I20060301-0800 running away with the handy little plugin from.So I need some help here to reproduce the problem:Andrew, using OptimizeIt, I see no leakage of an AntClassloader nor with the memory monitor view. What tool did you use to find the specific leakage?I will attach the simple test buildfile that I am using running in the same VM as the workspace (1.5.0_06-b05).Ed, how do you get these numbers...from the hover help in the Memory Manager view?Testing with the simple buildfile:started with used permgen of 34778k run the build 20 times and then ensured to remove all terminated launches waited about 30 seconds (my understanding is that classloader gc is on a different scheduling algorithm than normal gcing)finished with used permgen of 33942kTest buildfile:<project name="Echoing" default="echo1" basedir=".."> <target name="echo1"> <echo message="echo1"/> </target> <target name="echo2"> <echo message="echo2"/> </target> <target name="echo3" description= "An echo3!"> <echo message="echo3"/> </target></project>I used YourKit 5.1. I took a snapshot, launched an ant build, after it finished, waited until I noticed the non-heap memory tick down from a GC, then took another snapshot. The diff shows (among other things) +1 AntClassLoader. Test file is:<project name="x" default="foo" basedir="."> <target name="foo" > <antcall target="f2" /> <antcall target="f2" /> <antcall target="f2" /> <antcall target="f2" /> </target> <target name="f2" > <echo message="hi"/> </target></project>I can send you the snapshots if you like, 16Megs zipped, it doesn't save just a diff.I got my numbers from the hover help in the Memory Manager view. I had noticed the OutOfMemory error before and suspected it was something to do with exporting but couldn't prove it until now.I'm actually getting this error very often now, too. I think it's because I'm using a WTP server definition that deploys via an ANT script and the deployment happens regularly during a development session. IMHO the serverity should be increased because I already reached a state several times where I couldn't close the workbench properly.I'm upping the priority on this, since it's significantly impacting people who use Ant. Unfortunately, because of EclipseCon and some other external (personal) issues, this probably won't get looked at for a couple of weeks.I have not been able to reproduce the problem at the simplest level...using my test case nor Andrew's test case.It would be a great help if someone could confirm being able to reproduce the permgen memory leak with a simple test case.The new variables introduced in the 3.2 stream are the 1.5 or 1.6 VM and any changes to other Ant tasks being used. The Eclipse Ant integration has had limited changes for 3.2 and the AntClassloader has had exactly zero changes for 3.2.As Mike indicated I will not be able to look at this in depth until next week...so please bring your tests cases to EclipseCon.FYI - I'm seeing java.lang.OutOfMemoryError when running Ant builds. This is on Eclipse 3.2M5a with J2SDK1.4.2_11. I've cranked my vmargs way up for now, but watching TaskManager I can see a steady growth in the amount of memory being consumed.The interesting part here is exactly what type of Ant builds you are running. As you know there are many factors that can result in an Ant leak: a bug in the Eclipse Ant integration, a bug in Apache Ant, or a bug in the tasks/types that are executed during the build.I would love a simple reproduceable test case including buildfile.So I have used the eclipseCon opportunity to work with Chris Laffra and he hacked me up a tool to track active classloaders....and it does appear we have a problem of for each Ant build in the same JRE as Eclipse we retain one live classloader.I plan to investigate this problem more tomorrow with all the new tools from eclipseCon etc.Try to find a fix for m6.***has been marked as a duplicate of this bug. ***is to do with loading the files in the ant editor to edit them, not to run them. Removing all includes and comments from the ant file seems to solve the problem. Using ant 1.6.2 and Eclipse 3.1 and the testcase fromjust opening the file results in memory being used and never recovered.The test case I am using is to export 2 plugins from Eclipse to a directory in my local filesystem.I am exporting the org.eclipse.ant.core and org.eclipse.ant.ui pluginsProfiling with YourKit 5.1.2 I am seeing about 10 MB of non heap getting used up for each export. After 3 exports I run out of space.Some of the interesting data that I have seen is that with the YourKit profiler:* if the agent specified as a VM argument (-agentlib:yjpagent), with the test case, I consistently run out of perm gen with three iterations of the test. With the exact same VM, workspace, and test case, as of 10 iterations I had not run out of space.* I get the perm gen out of memory at ~70MB while the non heap view of YourKit claims I have 96MB limitThe bottomw line: Using YourKit and the RPET tools from Chris Laffra talked about at EclipeCon I have not been able to determine the root cause or reason that my custom classloader is not getting "cleaned" up.Is there any point where we *know* we are done with the context and force the class loader to release the classes it's holding onto? It's probably not to big a deal if someone continues to hold onto the object.Yes, the Ant integration knows when the Ant build is complete and could do cleanup but I am not aware of how to force a classloader to release its classes?We may have some tools around in J9 that can help navigate the object space/class space to see what is hanging around. Basically think of Smalltalk allInstances and allReferences like operations.you might also consider a simple tool that uses reflection and rips through all the classes loaded by a loader and nulls out all their fields...Continue investigation but I have no proposal or fix for RC1Has anyone investigated org.apache.tools.ant.AntTypeDefinition? It appears to be created whenever opening or running an ant file, and does not disappear when garbage collection is run, even though all ant files are closed. I set up the Netbeans 6 profiler with Java 6 and looked at what ant classes have the largest number of bytes and generations. According to the profiler new objects are created, which of course leads to a larger number of bytes. Once the file is closed or the file is finished running, these are not garbage collected. Running a manual garbage collection in the profiler does not get rid of this class. Is this worth investigating or has someone else already gone down this path? Related tocontinued conversation in.Permgen OOM reports that might be related (including this one):,,,,,,,.Running the two build files in comments #3 and #4, the classorg.eclipse.ant.internal.ui.launchConfigurations.AntStreamMonitor doesn't seem to be garbage collected and a new object is created each time an ant task is run. From the source, it looks like this class is used for logging the ant build.Looking at the source and the a dump of all objects in memory:AntStreamMonitor is used in the following classes:AntProcessBuildLogger - object never created or is GCAntStreamsProxyRemoteAntBuildListener AntStreamsProxy is used in the following classes:AntProcess - object never created or is GCAntConsoleColorProvider - object never created or is GCRemoteAntRuntimeProcessRemoteAntBuildListener RemoteAntBuildListener is used in the following classes:RemoteAntDebugBuildListener - object never created or is GCAntLaunchDelegate - object never created or is GCRemoteAntRuntimeProcess is used in the following classes:RemoteAntProcessFactory - object never created or is GCLooking at this, for some reason RemoteAntRuntimeProcess is used in RemoteAntProcessFactory but it is not cleaned up by GC.So the following class objects are hanging around after each ant build:AntStreamMonitorAntStreamsProxy,RemoteAntBuildListenerRemoteAntRuntimeProcessAnyone with more Eclipse experience know why these classes would be hanging around? Are they used by some other process that I can't see?Are you ensuring to remove all of your terminated launches and therefore ensure that the associated objects of the Ant launch are able to be Gc'd. You can remove all terminated launches from the Debug view.All launchers are terminated and removed from debug view. The objects are still there after several GC runs and quite a bit of time (1 hour). This is using Eclipse 3.1.2 and no special memory settings.Note this bug still has a 3.2 target.Thanks JohnFor the record, I'm also seeing PermGen OOMs with Eclipse 3.2RC7 + AJDT (no other plugins), with Sun 1.5.0_01-b08. It happens when running the AJDT UI test suite, and the OOM occurs when driving the PDE export process to run generated scripts. Using -XX:MaxPermSize=128m prevents the OOMs.I'm also being hit by this bug using the following code: AntRunner runner = new AntRunner(); runner.setBuildFileLocation(file); runner.setExecutionTargets(getTargets(module[0], action)); runner.setArguments(getArguments(module[0])); runner.run();I don't know how to use many of the PDE memory utilities but I did open Windows Task Manager and traced through the code simultaneously. Without fail, runner.run() absorbs 5-10 meg of memory and it is never reclaimed. Can we increase the severity of this bug?Did anyone come up with a reproducible test case to reproduce the leak from within Eclipse? I..e, steps an end-user can take to cause a leak? I tried PDE export of a simple plugin, and found after 30 iterations absolutely no change in Perm Gen size. I then tried with PDE export of org.eclipse.ant.core and org.eclipse.ant.ui. Again, there was no consistent pattern of growth. Using a profiler I see no class loaders being retained across PDE exports. I ran all these tests on Windows with Sun JDK 1.5.0_05.If anyone has complete end-user steps (with an necessary build scripts), I would be interested in helping to investigate this further.At the time I filed it, it was very reproducable, but with the versions of Eclipse and Java I'm currently using (Eclipse 3.2 RC7, Sun JDK 1.5.0_06 (not _07)) I can no longer reproduce the permgen OOM problem.I have been unable to reproduce this problem as strictly an Ant problem.Changing to remind in case someone can produce a test case on the latest VM(s) with Ant as the culprit.Seen exactly this perm gen error yesterday on 3.2.1/JDK 1.5/Win32 during plugin build via update site project. Restarted Eclipse, tried to reproduce it - no chance. Really weird one...I think the problem is reproducable easily, using the ANT files fromor:But it is important, to set "Run in the same JRE as the workspace" (in the ANT launch configuraton - Tab "JRE").If I run the ANT file fromin an eclipse 3.2 IDE, each time about 2400 KByte vanish (and don't come back).(Measured with MS Windows Task Manager).Hope this helps.Yes, if I run the Ant file fromand set to it to "Run in the same JRE as the workspace", there is a definate permgen growth when viewing the memory via jconsole. Looking at it in jconsole it seems to grow about 600k each time the task is run. This was on Eclipse 3.1.2 on Java 1.5.06 on Linux. The memory is not recovered after closing the project. Here is jmap output for permgen before:Perm Generation: capacity = 27000832 (25.75MB) used = 26983400 (25.733375549316406MB) free = 17432 (0.01662445068359375MB) 99.93543902647149% usedAnd after running 5 times:Perm Generation: capacity = 29622272 (28.25MB) used = 29600696 (28.22942352294922MB) free = 21576 (0.02057647705078125MB) 99.92716291309458% usedRunning jmap -permstat gives strange output. Before running 5 times, there are 55 live classes and 174 dead one, after running 54 live and 79 dead ones. So even though the system has collected some of the dead classes and one of the live classes has also become dead, the amount of memory used still goes up.Haven the problem reproduced now, I think the State should be from "Resolved" to "Reopen". Anyone out who is allowed to do this?I've tried with JDK6 on Eclipse 3.1.2 and still get the same problem, however, if I close the project and the click garbage collect in Jconsole, the perm gen memory goes back down to what it was. Interesting that the perm gen behavior seems to be different on JVM 5 vs 6.Been looking through the heap dumps on 1.6 with hat, using the oql queries listed here.I've also updated to Eclipse 3.2.I've found that a new org.eclipse.ant.internal.core.AntClassLoader is created each time an ant task is run. Looking at the classes it loads, they are either java.* classes that belong to the JVM or org.apache.tools.ant.AntTypeDefinition. AntTypeDefinition itself has a reference to the Eclipse AntClassLoader. So it looks a bit like a circular reference?Testing further with 3.2 and JVM 5 and 6, it looks like permgen memory does go up each time the buildfile fromis run, but it doesn't run out of memory as it is eventually garbage collected. Maybe this is different on a 1.4 JVM?Spreading the word from:***has been marked as a duplicate of this bug. ***I was not able to reproduce this using Eclipse 3.4M5 and Sun Java 1.5.0_11.I used jConsole from 1.6 to connect to the Eclipse process running example from the. I set Ant to "Run in the same JRE as workspace".When I was doing fast sequental runs the PermGen memory size was going from about 38Mb to 51Mb, but then garbage collected back to 37-39Mb.Thanks Oleg. moving to closed.reopeningmarking as not Eclipse***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Reopening,has steps and a fix suggestion to AntRunner to work around the memory issues.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***	51.0
id=3328	REOPENED	Platform	Resources	2.0	All Windows NT	P2 critical	Platform-Resources-Inbox	2001-10-10 22:53 EDT by	Knut Radloff	2016-12-05 13:04 EST (	10 users	I lost the contents of a java file apparently because the disk was full.Scenario:-the disk my workspace is on was full-edit an open java file in Eclipse-save the change-got a message saying that there are changes on the local file system.I didn't make any changes outside Eclipse but said no, don't overwrite anyway.The change I had just made and wanted to save was minor so I went ahead and selected "refresh from local file system" on the file. The refreshed file was emptyand I got an error message "There were errors during the build". It didn't say what kind of errors. Running out of disk space seems like a likely scenario so I should get an appropriate message.Fortunately "Replace from local history" worked and I got the old file contents back.NOTES:PM (9/4/01 9:46:02 AM) Not a common scenario.	Moving to COREPRODUCT VERSION:132This is one of those cases where the history store can barf and be left in an inconsistent state. Chain of events I observed:- attempt to write to history store. IOException due to lack of disk space- The IOException leaves the indexed store in an inconsistent state- attempt to set file contents. Exception- User is notified of that file is out of sync with filesystem (is this the UI just guessing because core threw an exception??).- Attempt to shutdown. The fact that the IndexedStore is broken causes a failure during shutdown... this aborts shutdown in the middle and leaves the tree file in a half-written state- The workspace is now toast. Since the tree is corrupted, there is no way to revive it.Severe!Some safety code has been added to IndexedStore shutdown to ensure that it doesn't blow away the entire shutdown process. However, if the user is out of disk space, shutdown is never going to go well. Closing for now. Perhaps we could revist serialization after 2.0 to see if there are any more opportunities for improvement.Reopening for investigation.Improvements were made at the end of the 2.0 cycle w.r.t. tolerance when running out of disk space.This is still a problem in build 20021017.When a save fails because of no disk space I get a message saying that the file has changed on disk and whether I want to overwrite the changes. This is the same error message I got before. I should get an error message saying that the file could not be saved.When I select no, don't overwrite, I get a message asking whether I want to load the changes from disk. When I select yes, the editor buffer is replaced with a truncated file.The local history is empty at this point, the old file contents is gone! So the current behavior is worse than what I originally PRd.It should be possible to keep the old file contents if the save fails or at least keep a local history of the last state in this scenario. Saving files should be made "more" fail safe.Servicability issue.IFile#setContents is throwing a CoreException with a message "Could not write file: <path>" and a status object containing the original IOException (message running on IBM JDK 1.3.1 sr2: "There is not enough space on disk").AbstractTextEditor is handling the CoreException and infering it occurred because the file was out of sync (producing the wrong message). Shouldn't it test the status object error code to see if it is a IResourceStatus.OUT_OF_SYNC_LOCAL instead?From the point of view of serviceability, I believe Core is doing the right thing here. I openedagainst Platform/Text to report the issue.Closing based on no new work for Core.See referenced bug report () for better reporting the information tothe user.Re-opening for investigation of the missing states problem.We can have so two situations where an out-of-disk-space IOException may arise when saving a file (IFile#setContents) in a full (or near to full) disk.1) when the currently saved state of the file is copied to the local history (may fail expanding the index, or writing the contents) - no exceptions will be raised, only logged, and the saving process will go on - this is good; 2) when the current contents in the editor will replace the existing ones. This may not fail because the new content length can be smaller than the saved one.When "1" happens, data loss shouldn't occur - only new states could not be added. I could reproduce a case where the last state was lost - and this is a bug.When "2" happens, a proper exception is thrown by IFile#setContents to clients. The problem Knut faced (previous state restoration) is a result of the mishandling of the exception by AbstractTextEditor (which allows the user to load the corrupted state from disk).Unfortunately, according to, AbstractTextEditor blinded handling of CoreExceptions is not going to be fixed.Investigating missing states problem.Actually, the behaviour I was observing was correct: the last saved state couldn't be added to the history store (there is no disk space), and that state was lost. But neither the previous states, nor the current one, were lost.In, it seems that there were previously saved states in the local history that aren't there anymore. Is that true, Knut? Do you have steps to reproduce it (I can't)? Thanks.Previous local history states are not deleted, at least I can't reproduce this either. I may not have had any local history when I tested this.Ok, thanks for testing it Knut. Closing (see DJ's comments in).***has been marked as a duplicate of this bug. ***This is not fixed (3.6 and N20100729-2000): org.eclipse.core.resources.IFile.setContents(InputStream, boolean, boolean, IProgressMonitor) throws an exception to report the 'out of disk' condition but at that time it has already already corrupted the file (file is empty).Note that the editor correctly tells this to the user but as just said, the file is already gone at that point, which in my opinion should not happen: the API should not touch/corrupt the file if there's not enough space.To make things worse, the history mechanism does not report the CoreException and just logs an error if it cannot save itself due to out of disk space. In my test scenarios this lead to a state where I was still able to save the file without any feedback in the UI (since no exception) but storing the local history already failed with log entries like this:!ENTRY org.eclipse.core.resources 4 568 2010-08-02 12:12:21.769!MESSAGE Internal error in history store!STACK 1org.eclipse.core.runtime.CoreException: Could not write file: E:\eclipse\workspaces\tmp2\.metadata\.plugins\org.eclipse.core.resources\.history\e3. at org.eclipse.core.internal.filesystem.Policy.error(Policy.java:55) at org.eclipse.core.internal.filesystem.Policy.error(Policy.java:50) at org.eclipse.core.internal.filesystem.local.LocalFile.checkTargetIsNotWritable(LocalFile.java:84) at org.eclipse.core.internal.filesystem.local.LocalFile.mkdir(LocalFile.java:289) at org.eclipse.core.internal.localstore.BlobStore.addBlob(BlobStore.java:52) at org.eclipse.core.internal.localstore.HistoryStore2.addState(HistoryStore2.java:92) at org.eclipse.core.internal.localstore.FileSystemResourceManager.write(FileSystemResourceManager.java:996) at org.eclipse.core.internal.resources.File.internalSetContents(File.java:325) at org.eclipse.core.internal.resources.File.setContents(File.java:364) at org.eclipse.core.internal.resources.File.setContents(File.java:468) at org.eclipse.core.internal.filebuffers.ResourceTextFileBuffer.commitFileBufferContent(ResourceTextFileBuffer.java:391) at org.eclipse.core.internal.filebuffers.ResourceFileBuffer.commit(ResourceFileBuffer.java:325) at org.eclipse.ui.editors.text.TextFileDocumentProvider.commitFileBuffer(TextFileDocumentProvider.java:870) at org.eclipse.ui.editors.text.TextFileDocumentProvider$2.execute(TextFileDocumentProvider.java:795) at org.eclipse.ui.editors.text.TextFileDocumentProvider$DocumentProviderOperation.run(TextFileDocumentProvider.java:132) at org.eclipse.ui.actions.WorkspaceModifyDelegatingOperation.execute(WorkspaceModifyDelegatingOperation.java:69) at org.eclipse.ui.actions.WorkspaceModifyOperation$1.run(WorkspaceModifyOperation.java:106) at org.eclipse.core.internal.resources.Workspace.run(Workspace.java:1975) at org.eclipse.ui.actions.WorkspaceModifyOperation.run(WorkspaceModifyOperation.java:118) at org.eclipse.ui.internal.editors.text.WorkspaceOperationRunner.run(WorkspaceOperationRunner.java:75) at org.eclipse.ui.internal.editors.text.WorkspaceOperationRunner.run(WorkspaceOperationRunner.java:65) at org.eclipse.ui.editors.text.TextFileDocumentProvider.executeOperation(TextFileDocumentProvider.java:456) at org.eclipse.ui.editors.text.TextFileDocumentProvider.saveDocument(TextFileDocumentProvider.java:772) at org.eclipse.ui.texteditor.AbstractTextEditor.performSave(AbstractTextEditor.java:4880) at org.eclipse.ui.texteditor.AbstractTextEditor.doSave(AbstractTextEditor.java:4669) at org.eclipse.ui.texteditor.AbstractTextEditor$TextEditorSavable.doSave(AbstractTextEditor.java:7009) at org.eclipse.ui.Saveable.doSave(Saveable.java:214) at org.eclipse.ui.internal.SaveableHelper.doSaveModel(SaveableHelper.java:349) at org.eclipse.ui.internal.SaveableHelper$3.run(SaveableHelper.java:195) at org.eclipse.ui.internal.SaveableHelper$5.run(SaveableHelper.java:277) at org.eclipse.jface.operation.ModalContext.runInCurrentThread(ModalContext.java:464) at org.eclipse.jface.operation.ModalContext.run(ModalContext.java:372) at org.eclipse.jface.window.ApplicationWindow$1.run(ApplicationWindow.java:759) at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70) at org.eclipse.jface.window.ApplicationWindow.run(ApplicationWindow.java:756) at org.eclipse.ui.internal.WorkbenchWindow.run(WorkbenchWindow.java:2600) at org.eclipse.ui.internal.SaveableHelper.runProgressMonitorOperation(SaveableHelper.java:285) at org.eclipse.ui.internal.SaveableHelper.runProgressMonitorOperation(SaveableHelper.java:264) at org.eclipse.ui.internal.SaveableHelper.saveModels(SaveableHelper.java:207) at org.eclipse.ui.internal.SaveableHelper.savePart(SaveableHelper.java:144) at org.eclipse.ui.internal.EditorManager.savePart(EditorManager.java:1369) at org.eclipse.ui.internal.WorkbenchPage.savePart(WorkbenchPage.java:3334) at org.eclipse.ui.internal.WorkbenchPage.saveEditor(WorkbenchPage.java:3347) at org.eclipse.ui.internal.SaveAction.run(SaveAction.java:76) at org.eclipse.jface.action.Action.runWithEvent(Action.java:498) at org.eclipse.ui.commands.ActionHandler.execute(ActionHandler.java:185) at org.eclipse.ui.internal.handlers.LegacyHandlerWrapper.execute(LegacyHandlerWrapper.java:109) at org.eclipse.core.commands.Command.executeWithChecks(Command.java:476) at org.eclipse.core.commands.ParameterizedCommand.executeWithChecks(ParameterizedCommand.java:508) at org.eclipse.ui.internal.handlers.HandlerService.executeCommand(HandlerService.java:169) at org.eclipse.ui.internal.keys.WorkbenchKeyboard.executeCommand(WorkbenchKeyboard.java:468) at org.eclipse.ui.internal.keys.WorkbenchKeyboard.press(WorkbenchKeyboard.java:786) at org.eclipse.ui.internal.keys.WorkbenchKeyboard.processKeyEvent(WorkbenchKeyboard.java:885) at org.eclipse.ui.internal.keys.WorkbenchKeyboard.filterKeySequenceBindings(WorkbenchKeyboard.java:567) at org.eclipse.ui.internal.keys.WorkbenchKeyboard.access$3(WorkbenchKeyboard.java:508) at org.eclipse.ui.internal.keys.WorkbenchKeyboard$KeyDownFilter.handleEvent(WorkbenchKeyboard.java:123) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Display.filterEvent(Display.java:1253) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1052) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1077) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1062) at org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:1103) at org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:1099) at org.eclipse.swt.widgets.Widget.wmChar(Widget.java:1508) at org.eclipse.swt.widgets.Control.WM_CHAR(Control.java:4268) at org.eclipse.swt.widgets.Canvas.WM_CHAR(Canvas.java:345) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4160) at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:341) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4873) at org.eclipse.swt.internal.win32.OS.CallWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.CallWindowProc(OS.java:2362) at org.eclipse.swt.internal.BidiUtil.windowProc(BidiUtil.java:639) at org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method) at org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:2459) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3655) at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2629) at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2593) at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2427) at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:670) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:663) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:115) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:369) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:592) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:619) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:574) at org.eclipse.equinox.launcher.Main.run(Main.java:1407) at org.eclipse.equinox.launcher.Main.main(Main.java:1383)!SUBENTRY 1 org.eclipse.core.filesystem 4 272 2010-08-02 12:12:21.769!MESSAGE Could not write file: E:\eclipse\workspaces\tmp2\.metadata\.plugins\org.eclipse.core.resources\.history\e3..***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***I experienced this in "Juno" release, Build id: 20120614-1722.I am no longer involved in Platform Core development.	22.0
id=219928	REOPENED	Platform	User Assistance	3.4	PC Windows XP	P2 major	platform-ua-inbox	2008-02-22 05:14 EST by	Martin Oberhuber	2011-11-30 06:46 EST (	4 users	S-3.4M5Open Eclipse and go to the workbenchHelp > Help ContentsIn the Search field, type "standaloneUpdate" press Go--> Nothing is foundNow search for "org.eclipse.update.core.standaloneUpdate"--> 1 hit is found in the Platform Plug-In Developer GuideNow search for "*standaloneUpdate"--> Nothing is found.Not finding these hits is a big limitation IMHO because it makes it impossible to search for terms which appear in fully qualified Java names (with package prefix).Ideally, search should be able to find search strings which do not start at a word beginning (e.g. search "*standalone*"). This has been reported asalready.(word stemming) is also related.Another, probably simpler option, might be to change index generation such that the "." character is allowed as a word separator in addition to normal whitespace. If I'm not mistaken, Web searches such as Google also take any kind of special characters like [.,;'] etc as word separators. When the same algorithm (convert [.,;'] into " ") is used in the search field (as Google etc do), excellent results are returned.Note that as per, searching Google or Eclipse.org is a workaround but it does not return as good results since the local Workbench installation is not considered.	Consider this major since a very great number of potentially important search hits is missed due to the limitation.I agree that this is a serious problem. I'm tentatively targeting Eclipse 3.4, until I start to look into it I can't say for sure how easy or otherwise this will be to fix.I just tried this using 3.4M5 on Windows XP but I got different resultsWhen I searched for "standaloneUpdate" I got 1 hit:"Running update manager from command line"The result is the same with or without the quotes. This is the same result that I get if I search for "org.eclipse.update.core.standaloneUpdate".I don't really know why I would see a different result. Is your system set to use a locale other than English? The search stemming works differently in different locales.Hm, odd. I do get the hits with eclipse-3.3.1.1 on Linux-GTK.I do not get them on WinXP with eclipse-3.4M5 + several other stuff from Ganymede installed. Could any add-ons destroy the Index? Can I force re-indexing?Strange indeed. You can force re-indexing by deleting the configuration directory.I've spent some more time looking into this but I can't reproduce it. I also have been searching for a number of terms separated by "." and have found every one I've tried so far so I'm not sure the problem you saw was due to the "." seperator. Closing as WORKSFORME, if you get new information on how to recreate the problem please reopen the bug.I can reproduce this easily with Eclipse 3.4m7 (I20080502-0100) on WinXP:* Launch Eclipse* Help > Help Contents* In search field, enter "standaloneUpdate" and press GO --> nothing found* Now, enter "org.eclipse.update.core.standaloneUpdate" and press GO --> 1 match is foundSearching for "*standaloneUpdate" also does not yield any hits.Created.log file with errorsMy .log file (see attached) shows several errors about Help document [...] cannot be opened. Help documentation could not be indexed completely.CreatedMy full configurationAttached is my full configuration.Unfortunately I cannot see any hint pointing to a locale. But my Windows XP Control Panel / Regional and Language Options is set to "German (Austria)" with Location = "Austria". On the advanced tab, Language for non-Unicode Programs is set to "English (United States)"My WnXP installation is SP2 EN-US.Now I can reproduce the problem. It does not show up in the "en" locale but I was able to reproduce in the "de" locale. The Lucene search index has different stemming algorithms for different languages and so my guess is that this is the root of the problem. I'll look into this some more to see if the stemming is happening at all in the de locale.The help related error messages you saw are I believe related to the TOC containing refernces to documents that do not exist. I'll look into those to see if that is the case. The equinox error messages I'm less sure about, it appears that the update site was not set up correctly.I've been looking into this some more. The problem also exists in French and Portuguese and seems to be related to a different Analyzer class being used for these languages (GermanAnalyzer, FrenchAnalyzer and BrazilianAnalyzer). Spanish which uses a default analyzer does not have this problem. English which uses an analyzer class defined in org.eclipse.help.base also does not have this problem. Using an analyzer geared to a particular language does have the advantage that search stemming can be used to match plural and other variants of words but it seems to also be the root of this bug. I'm not exactly sure what to do next.So, you are saying that GermanAnalyzer is part of Lucene and therefore out of reach? Then I see two things that can be done: (1) File a bug against Lucene that their Analyzer has issues with "." character. (2) If Lucene doesn't come up with a fixed version in time for 3.5, then investigate the possibility of creating a "Wrapper" analyzer that delegates to the original one for most work but fixes the problems with "." and register that one.I don't claim to be an expert in analyzers but this is what I think is happening. Lucene provides analyzers for several languages, including German which handle search stemming. The Eclipse help system has two of it's own analyzers, one for English and one for languages for which Lucene does not provide a custom analyzer. These analyzers from the help system seem to tokenize in a different way so that anything that is not a letter or digit is treated as a word separator. The ideal solution would be involve refining the behavior of the GermanAnalyzer so that it would tokenize the same way but I haven't yet figured out how to do that. I haven't given up on this bug, I'm just not sure what the next step is.I ran into the same problem when searching for "launchShortcuts" in I20090728-1414 with the de_CH locale. "Launch Shortcuts" found the relevant extension point description.says:"The Eclipse help system has two of it's ownanalyzers, one for English and one for languages for which Lucene does notprovide a custom analyzer."Would it be a better solution to avoid Lucene's custom analyzers altogether, and provide a custom analyzer even for those languages for which Lucene has a custom analyzer?What existing benefits would be lost for those languages for which Lucene has a custom analyzer, and the search is using those custom analyzers today?Is the choice of lucene analyzer bound to the written doc's locale or bound to the locale of the computer on which I'm running?It seems that the problems which Markus and I found should not appear since we are searching in us-english documentation (although we are running on a de_CH or de_AT locale respectively).The analyzer chosen when performing the search from Eclipse depends on the locale of your OS, for an infocenter it is possible to restrict the supported locales to those that actually have content so the problem is not so bad there. An analyzer is used when building the search index and also when performing a search and ideally the same analyzer will be used in both cases. There are language specific analyzers for English, French, German, Portuguese (Brazilian), Japanese, Korean, Czech, Chinese, Greek, Dutch and Russian. For some reason there is no analyzer for Spanish.The main purpose of the analyzer is to match variants of words, so if I search for "cache" I will see matches for "cached", "caches", "cacheing" etc. This works fine if the analyzer used is the same language as the documentation being searched, less well otherwise. It seems that there are two separate issues here:1. The German analyzer is not finding a match to search terms containing periods. I do not know if other language analyzers have the same problem.2. The analyer used when searching is based on the users locale rather than the locale of the documents. I'm not sure what the best solution would be - the analyzer performs both search stemming and tokenization and it is the tokenization that is causing the problem in this case. Although I have not tried this I expect that if the search index was built using a German analyzer and searched using a German analyzer you would start to get the hits for strings containing periods again. Ideally we would use the analyzer based on the locale of the documents, however we then have to allow for the case where some but not all of the documents are translated.I'm open to suggestions on how to fix this.Could you please file a bug for Lucene for this? A German '.' is not that much different from an English '.' after all (except that German interchanges decimal and thousands separators, and de_CH has of course even different rules...).Probably yes. Starting with -nl en_US at least helped in.That would be great. I guess the problem is then that you don't know the language of the doc plug-ins.(In reply to)I don't know how Lucene works exactly, but isn't the Index comprised out of multiple partial indexes (which may be pre-built)? If that's the case then I'm wondering if the Analyzer could pick the locale that was used when creating the Index. That gives Index creators the chance to do it right. Different languages would use different partial indexes.FYI an interesting related discussion at Lucene, also related to pre-indexing and analyzers: []	20.0
id=22592	REOPENED	Platform	Text	2.0	All All	P3 normal	Adam Nielsen	2002-08-20 15:09 EDT by	Peter Burka	2010-02-25 02:08 EST (	4 users	In the Java editor, select several lines of text, moving up.(That is, the cursor should be at the top of the block when you've finished selecting.)Press 'Tab'The lines all indent, and the cursor moves to the bottom of the selection.Block indent should not cause the cursor to move.	Current behavior seems to be standard for our operations that modify blocks of text. For example, selecting "up" and then using paste to replace the selection with another block of text also leaves the cursor at the end. We could argue that either behavior is correct, but in truth if we haven't changed the behavior in >5 years, it's not going to happen now. Particularly, since other code may be relying on how it currently works.Closing for lack of activity. Please re-open if we intend to address this.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Any chance of reopening this? There have been a few dupes filed recently...No plans to change this at the moment. There's no business case and other editors also behave that way.Really? What are some examples of other editors with this behavior?FWIW the Borland C++ IDE is an example of the way it *should* behave, when you indent text there the cursor doesn't move. I've been using Eclipse for many years yet coming from Borland I still get a surprise when the cursor jumps after indenting text. I think the problem is that after you select some text, if you move the cursor immediately it behaves one way, yet if you press tab then move the cursor it behaves differently. Currently if you stare at a block of text you don't know how the cursor is going to behave unless you know whether the tab key has been pressed or not. I think pressing tab should not change the behaviour of the arrow keys.Sure, issues like this are only minor, but when you spend all day using Eclipse it's the little things that start getting to you...(A little off-topic but a related issue is when you press Ctrl+A to select-all. In the Borland IDE the cursor doesn't move, but in Eclipse it jumps to the start or end of the file, which is another pet peeve of mine - since Ctrl+A is so close to Ctrl+S, I often lose my place in the file after attempting to save it.)e.g. UltraEdit.Besides seeing the caret move is there any real usability issue you have?Well, it slows down my development work because I spend more time than I need to scrolling around with the keyboard. I'm one of those people who like formatting my code by hand, so I do spend time indenting blocks of text in and out. When you're working your way through a file it can really become annoying.But I'm afraid that's all it boils down to - fixing this would lower my stress levels :-)We would accept a patch, so if it really bothers you... ;-)Okay, I'm prepared to take your challenge ;-) But I've never hacked on Eclipse before, can you give me a hint which file to start looking at once I've got the code?The affected code is most likely in the 'org.eclipse.jface.text' project. Take a look at- org.eclipse.jface.text.TextViewer.ViewerState.connect(IDocument)- org.eclipse.jface.text.TextViewer.ViewerState.restore(boolean)The hard part is to make sure other scenarios aren't broken.Have a look at, where I mention what I believe is the root cause of this. (it is in TextViewer.ViewerState.connect(), as Dani says)***has been marked as a duplicate of this bug. ***Reopening since someone wants to work on this.Thanks for reminding me on this one.	16.0
id=119083	REOPENED	Platform	UI	3.2	PC All	P3 enhancement	Anthony Hunter	2005-12-02 14:21 EST by	Rodrigo Peretti	2008-09-01 05:48 EDT (	4 users	An important item on our list is gotoMarker() support. In order to support gotoMarker() in our graphical editor, we often cause an item in our editor to be selected, which causes the appropriate property sections to be displayed in the properties view, but after that, there is some work required to ensure the correct tab is visible and the correct widget on that page gets focus, for example. Some of this is a bit hairy currently since it's hard to query for the complete set of visible tabs/sections, and some simple additional API would make this much easier for us.	Do these belong to you? Forward as necessary.Thanks,Correct me if I am wrong, but why is this not a duplicate of?You say your gotoMarker() selects elements in the graphical editor, which displays tabs and sections.Now you want to make use of a proposed active tab and section setter to bring the UI you need into focus.Well, this one might depend on the other but does not really mean it is a duplicate. If you make it a duplicate it means everyone using the properties framework will need to implement goto marker in some way but if the basis is already in the framework, it means less code for everyone else to implement.OK, so if the tabbed properties view implements IGoToMarker, what is your propsal for the IMarker ?The last entry on this bug was a question for the reporter. Is this request no longer useful, or is there some other reason why the conversation stopped?It would still be very useful.Basically the view should handle IGotoMarker but every page would need to contribute some kind of logic that identifies if the marker belongs to it or not. The framework then would give focus to the first page that says so (maybe by delegating the gotoMarker() call to that particular page.This feature was on an IBM internal list for 3.4. No further follow up occurred since July 2007.It would still be useful.(In reply to)I am back to why a view needs to provide an implementation for IGotoMarker . Clearly it is the editor which implements IGotoMarker and it will need to reveal the tabs and sections in the properties view. This would be solved by.And there is no reason why you cannot extend TabbedPropertySheetPage and make it implement IGotoMarker . Right?Why does the framework *have* to provide an implementation for IGotoMarker?	9.0
id=240520	REOPENED	Platform	WebDAV	3.5	PC Windows XP	P3 major	Alexander Gurov	2008-07-11 13:37 EDT by	Tim O'Callaghan	2008-07-31 10:35 EDT (	0 users	Build ID: 3.9.11.5Steps To Reproduce:1. get an account at vax.polarhome.com2. create an FTP target for it in eclipse3. attempt to browse the remote filesystemMore information:I work on C project on a remote VMS server. Currently i use Emacs ange-ftp, but i want to move to eclipse. The problem i have is that the FTP plugin presumably assumes a unix remote filesystem, or cannot cope with a remote VMS one. To give you an example of the difference in directory conventions:Unix=>/home/user/tim VMS=>[home.user.tim]It should be noted that polarhome.com has Linux/Ubuntu, Linux/Mandriva, OpenVMS/Alpha, OpenVMS/VAX, Solaris, Ultrix, OpenBSD, FreeBSD, NetBSD, HPUX, IRIX, QNX, AIX, Tru64, and OPENSTEP servers to test the FTP plugin on.	It seems that report is not related to Subversive (i.e. report is sent to the wrong component). But in case if this report is related in some way to Subversive please note following:We uses external libraries in order to interact with SVN. Unfortunately no one of these libraries have support of the Eclipse Platform virtual file systems. So, we can't resolve this problem without writing a completely new EPL-compatible SVN client library which will interact with the Eclipse specific virtual file systems. From the other side we have no resources to write corresponding library and I will close this report as INVALID.If you think that something will be changed in FTP support please reassign this report to the correct component.Re-assigning miss-assigned module.	2.0
id=374568	REOPENED	Platform	UI	4.1	PC Windows 7	P2 normal	Platform UI Triaged	2012-03-16 17:59 EDT by	Josh Davis	2015-04-06 18:07 EDT (	8 users	Build Identifier: Version: 4.2.0 Build id: I20120314-2200I have found that when I remove menu items from a part menu the items are removed from the MMenu's children list but visually their placeholder remains. When I add the menu items back to the part menu they do not not have labels. See screen shots.Reproducible: AlwaysSteps to Reproduce:1.Add menu items and sub-menus to the part menu2.Remove the items and sub-menus 3.Add the menu items and sub-menus back.	CreatedScreen shots of bugCreatedProject to reproduce bugHi Josh,Could you please attach your shots as separate images (png, gif, jpg, whatever)? We can see those from the bug.PWCreatedOriginal State of the ApplicationCreatedRemove menu items and submenu from part menuCreatedTry to add items back(In reply to)I would like to revise the steps in this comment. To the following...Steps to Reproduce:1.Add menu items and sub-menus to the part menu2.View the menu3.Remove the items and sub-menus 4.View the menu3.Add the menu items and sub-menus back.5.View the menu.Step 2 is important because that is when the initial items are added to the MenuManager that is used behind the scenes. Step 4 and 5 will have the same results because the MenuManager is NOT updated again after the initial viewing on step 2.It doesn't seem like this logic ever expected a menu's contents to change after it has been displayed once. I am basing this on the logic in StackRenderer.showMenu(). If the menuModel doesn't have a Menu object then one is create and the menu listeners are added to the underlying menu manager. If a menu already exists for the menuModel then it is just displayed. When it is displayed the menu listeners aboutToShowMenu method is called. Unfortunately since the menu manager hasn't been updated with the changes that have been made to the menuModel, extra listeners are called that should have been removed. These listeners that are for removed items return an empty string because the text for the menu item is no longer in the localization map.So either the MenuManager needs to be created each time the part menu is displayed (which I tried this by calling renderer.removeGui(element) but that didn't seem to remove the link between the menuModel and the MenuManager in the modelToManager map in MenuManagerRenderer), or the MenuManager needs to be updated with the changes in the menuModel. This would probably involve a change to the IPresentationEngine interface. It would most likely need a updateGui(...) method. I am actually kind of curious as to why the menuManager needed to be kept around? This seems like something that is only needed when the menu is displayed, due to the MMenu menuModel being retained as the model for the menu. The only thing I could think is that that creating the MenuManager each time is expensive. I know this bug has been slated for 4.2.1 and the team is busy with getting 4.2 ready for release. I just wanted to document my research in case it could help after the release.Josh, thanx for the update.Are you removing the IContributionItems from the view MenuManager (that you get from getViewSite().getActionBars())?Are you calling updateActionBars() afterwards?PW(In reply to)Nope. I am not using that in my test project that is attached this bug. I am just using the part menu which is a MMenu. When I click on the part menu to display it the renderer is creating the MenuManager. I am not accessing the MenuManager at all. See MenuManagerRenderer.processContents(MElementContainer<MUIElement> container) which gets the MenuManager for the MMenuIt looks like the MenuManager is created in PartRenderingEngine.createWidget(MUIElement,Object) which is called from PartRenderingEngine.safeCreateGui(MUIElement element, Object parentWidget, IEclipseContext parentContext) which is called the first time the MMenu is displayed.(In reply to)Sorry, you're correct.PWCreatedPossible fix for this bugPossible fix for this bug. The idea behind this fix is to make sure theMMenu model is in sync with the jface MenuManager. Previously items removed from the model AFTER the part was created were NOT removed from the part's MenuManager. After fixing the remove issue, I found that when I added new items to the model they would also not be added to the MenuManager, so I fixed that by handling both the ADD and REMOVE event types in the childUpdater.I can't understand how this issue could get an importance of just normal. Changing the application model at runtime is one of the top ten highlights of e4. We're trying to add dynamically menu- and tool-items. ToolItems are added instantly using an appropriate listener mechanism. Changes to MenuItems either in MainMenu, PartMenu or PopupMenu are visible only after a workbench restart.See code fragments below.Adding ToolItems (Maintoolbar and PartToolbar) works as expected:-------snipMDirectToolItem item = MMenuFactory.INSTANCE.createDirectToolItem();item.setContributionURI("bundleclass://" + "org.mybundle/" + "org.mybundle.TestHandler");URL iconURL=fileLocator.find(Platform.getBundle("org.mybundle"), new Path("icons/smiley_e.png"), null);item.setIconURI(iconURL.toString());item.setToBeRendered(true);item.setVisible(true);MApplication app = (MApplication)((EObject)m_Window).eContainer();MToolBar mainToolbar=(MToolBar) m_ModelService.find( "toolbar:org.eclipse.ui.main.toolbar", app);mainToolbar.getChildren().add(item);--------snipAdding MenuItems does not work:-------snipMDirectMenuItem item = MMenuFactory.INSTANCE.createDirectMenuItem();item.setContributionURI("bundleclass://"+ "org.mybundle/"+ "org.mybundle.TestHandler");URL iconURL=fileLocator.find(Platform.getBundle("org.mybundle"), new Path("icons/smiley_e.png"), null);item.setIconURI(iconURL.toString());item.setToBeRendered(true);item.setVisible(true);m_Window.getMainMenu().getChildren().add(item);--------snipA little correction to:Dynamically added ToolItems are rendered immediately. But if you remove the ToolItem from the application model again, it is not removed from the UI, leaving Zombie ToolItems with no appropriate model element.(In reply to)Hi Josh, Thank you very much for the proposed patch. Would you be able to include some changes?1)In your childUpdater could we treat ADD and REMOVE separately? I think for ADD calling processContents(*) is the best way to include the new MMenuItem.2) For REMOVE, org.eclipse.e4.ui.workbench.UIEvents.EventTags.OLD_VALUE should contain the removed MMenu or MMenuItem.That can be your starting point to remove the IContributionItem for an MMenuItem (retrieved by getContribution(itemModel);) or de-process an entire sub MMenu and its MenuManager (retrieved by getManager(menuModel);), and de-link them from the internal Maps.PW(In reply to)I am trying to apply and update this patch using 4.2.1 (tag R4_2_1) and it is not working as expected. You are correct that OLD_VALUE will give me the delete menu item or menu. When I call MenuManager parentManager = getManager((MMenu) menuModel); which is the same call in processContents(...). It always gives me null for the view menu. Before I thought it gave me a menu manager, which allowed me to remove the item or submenu from the menu manager for the view menu.Here is how I have changed the childUpdater..Object menuModel = event.getProperty(UIEvents.EventTags.ELEMENT);if (UIEvents.isADD(event)) { processContents((MElementContainer<MUIElement>) menuModel);} else if (UIEvents.isREMOVE(event)) { MenuManager parentManager = getManager((MMenu) menuModel); Object oldValue = event.getProperty(UIEvents.EventTags.OLD_VALUE); if (oldValue instanceof MMenu) { MenuManager removedManager = getManager((MMenu) oldValue); processMenuManager(removedManager, parentManager); } else if (oldValue instanceof MMenuItem) { IContributionItem contribution = getContribution((MMenuItem) oldValue); processContributionItem(contribution, parentManager); }}I get null when calling getContribution((MMenuItem) oldValue) in the case when the oldValue is a MMenuItem. I was thinking I could get the parentManager from the ELEMENT and then the contributionItem from the OLD_VALUE. Once I had that I could remove the contributionItem from the parentManager. Apparently I am missing something.In my original patch, each time processContents was called I would go through the parentManager and check to see if the contributionItems in the manager had a MMenuElement if they didn't then I removed them from the menu manager.I guess I don't see how I can do the same here if I can't get the parentManager.I checked the modelToManager in MenuManagerRender and it doesn't have a Menu Manager for my view menu in it. It only has the menu managers for the global menus (File, Help, main.menu). It has been awhile since I did the patch I am sure I am just forgetting something. I am working on the updates. For both this bug and the toolbar bug.I remember now what I am missingI forgot that I have view the menu once before removing items.The menu managers aren't created until the menu is viewed.Once I view the menu the code I posted works. If the menu hasn't been viewed then the menu manager is null. I added a null check that just returns if the parentManager is null.However I need to make a change to the code I put in the previous comment because the OLD_VALUE returns a list if I clear the entire menu. I will make a change for that and then re-attach the patch.(In reply to)CreatedUpdated patch with suggestions from PWUpdated this patch with suggestions fromCreatedAdditional Modification To PatchI updated the patch to call parentManager.update(false) after removing items or menus from the parentManager. This is being done in the processContents after changes are made and I think it needs to be done also when items are removed.Released asThanx Josh.PW(In reply to)Sorry Paul and Josh, I had to revert this as it caused the following severe issues:- Navigator > context menu > New is empty after the first invocation- Package Explorer > context menu > New is empty after the first invocation (see).- Project Explorer > context menu > New has its items duplicated after the first invocationWe never disposed the menus so far, also not in 3.x. Clients who cache and reuse the menus are now no longer working or do strange stuff.(In reply to)OK, Josh, could you please revisit the fix with an eye to the New menu (it might effect Show In as well)PWLooking at this inPWJosh, I've pushed up Patch Set #5 toCould you please confirm that this still fixes your problem? Then I'll review it again, I think we need to change the ADD section.PW(In reply to)What version of the SDK do I need to get the patch to work?I changed my Eclipse to run onVersion: 4.3.0Build id: I20130314-1330Which found several missing imports when I applied your patchI am still having one issueLine 687-688 has this codeici = (IContributionItem) ((IContextFunction) obj) .compute(lclContext);The compiler tells me that compute takes two parameters.(In reply to)It'll have to be amended, as the IContextFunction interface changed in M6 (you have the right build) to have 2 parameters instead of 1. Passing in null is acceptable.PW(In reply to)I tried passing in null, which allowed me to run the test program.In my workflow I get a NPE1. Open app2. View the part menu and submenu3. Press the button to remove the menus4. View the menu (the items in the view menu have been removed. There is an empty item in the submenu)5. NPE occurs when the menu disappearsI will attach a screenshot of the empty menu item and the NPE stack trace.I haven't debugged yet to see why we are getting the NPECreatedBroken Submenu with Patch 5This is a screenshot of the broken submenuoccurs when the user views the part menu after the pressing the button to remove the menu items.CreatedNPE Stack traceI get a NPE when the menu closes after viewing it. This occurs after the menu items have been removed.(In reply to)OK, tracked down that problem. I've updated the change and merged it in. It works for your example project and doesn't interfere with SDK menus (New, Show In, etc).Josh, could you also test to make sure it does what you want?Merged asPW(In reply to)I had to revert that change since it randomly reorders the menus, see.Sorry Dani, I think I'll defer this to Luna.PW	31.0
id=252964	REOPENED	Platform	IDE	3.4.1	PC Windows Vista	P3 minor	Anthony Hunter	2008-10-31 09:07 EDT by	Danail Branekov	2008-11-05 09:54 EST (	0 users	CreatedSample projectBuild ID: M20080703-0800Steps To Reproduce:1. Import the test project attached (the project defines a sample view which should get tabbed properties contributed). For developiing this view I have followed2. Start a runtime workbench3. In the newly started open the properties view4. Open the sample view5. The following log entry appears!ENTRY org.eclipse.ui.views.properties.tabbed 4 4 2008-10-31 14:57:37.196!MESSAGE Contributor my.dummy.contributor cannot be created.More information:Hi,The behaviour described above is due to the implementation of the org.eclipse.ui.internal.views.properties.tabbed.view.TabbedPropertyRegistry class.Whenever such a registry is created with a given contributor id, the plugin registry is searched for contributions. When there are no such contributions, the factory treats the situation as an error. This is not nice because in a given set of installed plugins you may not have contributors to this id (e.g. the user may have disabled contributing plugins for some reason). Probably "INFO" severity would be more approriate here.Best regards, Danail	By design this is an error.You say you are providing a tabbed property sheet page so your workbench part must implement ITabbedPropertySheetPageContributor.You then say that your contributor id is "my.dummy.contributor" but do not provide a propertyContributor extension for it.In your view, simply define the propertyContributor extension without tabs and sections and you are done. Tabs and sections can go in other plug-ins.Hi Anthony,From my design point of view it is pretty fine to have a view which implements the ITabbedPropertySheetPageContributor. If there will be contributors to it or not might be up to other tools.For example, in my case, I am developing something like a framework (which contains a view) which expects other plugins to contribute stuff to it. Therefore this "framework" provides quite a lot of entry points (one of which is the tabbed property feature) for contributors to plug in. The framework itself does not care to provide properties at all - it simply needs to provide functionality to its contributors.As there might be no contributors (the user missed to install them or has simply disabled them) you would get this error entry. Defining a dummy contributor would be simply a workaround and would simply hide the issue.Regards, Danailok, we cannot remove the message to the log, so you are just requesting it be an INFO rather than ERROR?Yes, this is my request. The reason for it is that in our local infrastructure we have an automated test which opens all perspectives and views and verifies that there are error entries in the log file. If this test failed, quality management makes our lives miserable :)Thanks for understanding!	4.0
id=491566	REOPENED	Platform	SWT	4.3	PC Linux	P3 normal	Alexander Kurtakov	2016-04-13 03:28 EDT by	David Williams	2017-01-11 14:12 EST (	12 users	+++ This bug was initially created as a clone of+++Seearoundfor more information. SWT is one of the few components that still specifies executionEnvironment in a POM. In your case, it is in a repository POM for your fragments: pom.xml - eclipse.platform.swt.binariesIt seems to me these days that is just a labor-saving device for "building", but does not perform the usual "runtime checks". I realize that there is long history here, and years ago, I know you had to remove the BREEs from the fragment MANIFESTs, but I believe that is no longer the case. I realize you are busy, but ... would be nice to get completely "clean" of overrides, and get rid of this 3-year-old bug.	The more I think about it, the more I wonder if fragments are *supposed* to have their BREE listed? I seem to recall someone saying that at runtime, the "check" is to simply check the BREE of the host it gets associated to. Anyone know for sure? If true, then the way things are, is probably best.(In reply to David Williams from)At runtime BREEs are used at runtime by fragments. Fragments CAN have BREEs that are different from their host bundle. But I seem to recall that tycho had issues at one time if we had fragments that had different BREEs than their hosts.(In reply to Thomas Watson from)Ok, thanks, Tom. I think Tycho has fixed their problem in Tycho 0.22.0. But, the "fix" might require that SWT set <resolveWithExecutionEnvironmentConstraints>false</resolveWithExecutionEnvironmentConstraints>See. At least, if the BREEs really are different. But, I get the impression that now the BREEs could be the same at 1.7. Or, SWT team, is that not true?BREEs for SWT fragments must have same BREE as as SWT host due to the way things are done - all sources in the host when developing but resulting classes being in fragments.Lakshmi/Arun, should we put BREE in all manifests and drop executionEnvironment from pom or keep the status quo? I'm for the former (more obvious solution) but would like to hear others opinion before pushing for it.I'll proceed with adding BREE to all fragments manifests and drop executionEnvironment next week if no objection by then.New Gerrit change created:Gerrit changewas merged to [master].Commit:A bit later than expected but still - pushed.New Gerrit change created:Gerrit changewas merged to [master].Commit:This uncovered build failure in some plugins dependent on swt but having BREE lower than 1.8 to fail compiling although resolution worked fine with exception like:[ERROR] Failed to execute goal org.eclipse.tycho:tycho-compiler-plugin:0.27.0-SNAPSHOT:compile (default-compile) on project org.eclipse.ant.ui: Compilation failure: Compilation failure:[ERROR] /opt/public/eclipse/builds/4I/gitCache/eclipse.platform.releng.aggregator/eclipse.platform/ant/org.eclipse.ant.ui/Ant Tools Support/org/eclipse/ant/internal/ui/preferences/FileSelectionDialog.java:[ERROR] /*******************************************************************************[ERROR] ^[ERROR] The type org.eclipse.swt.widgets.Composite cannot be resolved. It is indirectly referenced from required .class files[ERROR] 1 problem (1 error)[ERROR] -> [Help 1]Reverted the commit to unbreak the build as it has to be investigated further.(In reply to Alexander Kurtakov from)I've opened, patch pending, to move ant to 1.8.(In reply to Andrey Loskutov from)FWIW, this would not fix the issue as in my local tests with ant.ui moved to 1.8 I experienced same issue with equinox bundles depending on swt ant there would probably be others when equinox moved.(In reply to Andrey Loskutov from)I've set the change to -2 so that it does not get merged until the reason for this bug has been found and fixed. We have other bundles with source level below 1.8 and also clients and they can all still use SWT.In my local ant.ui compiles with Swt and swt.binaries with EE as 1.8(In reply to Sarika Sinha from)Do you do eclipse.platform build with -Pbuild-individual-bundles or whole releng.aggregator build? I'm able to reproduce it only in the later case.(In reply to Alexander Kurtakov from)Right now I have done with Eclipse IDE, Sravan tried using -Pbuild-individual-bundles but it crashed in between.You may know this already, but Tycho 0.22 added an item to target-platform-configuration that (I think) was supposed to help with this sort of issue. See Tycho. It was specifically meant to address(host/fragment BREE mismatch) which sort of sounds like the opposite of the problem you are running into now.The setting is <resolveWithExecutionEnvironmentConstraints>false</resolveWithExecutionEnvironmentConstraints>I once tried setting this for "the whole build" but there was some error then with an Equinox bundle. I do not recall what it was. See. I just mention all this here in case anyone is motivated to experiment, or if anyone understands it better than I do.(In reply to Dani Megert from)Sorry, I had to push Ant's move to 1.8 due to. Please use R4_6_maintenance for further investigations of the problem in this bug.	20.0
id=497444	REOPENED	Platform	SWT	4.6	PC Linux	P3 normal	Alexander Kurtakov	2016-07-07 02:20 EDT by	Lars Vogel	2017-02-16 19:20 EST (	10 users	If I start Eclipse under GTK the progress indicator of the IDE is not updating. I moves to one entry (ltk.ui.refactoring) and stays their until the IDE shows.	Patrik, do you know a way to show the splash if I start a runtime Eclipse from Eclipse? I'm unable to get the spash showing if I start Eclipse from Eclipse and therefore I'm unable to debug this.(In reply to Lars Vogel from)Using the "org.eclipse.sdk.ide" product instead of the application does the trick.If I start with GTK2 the splash screen is updating. Moving to SWT for investigation.The relevant code is in Workbench from the platform.ui repo. In StartupProgressBundleListener#bundleChanged we call the progressMonitor.worked(update) but no UI update happens with GTK3.Leo, could you investigate?I'm working on the webkit port at the moment, (which may take a while). I've added this to my (long) todo list, but if anyone's interested to work on this then by all means... A good starting point might be to do a bisect to see what broke it.Most like this is caused by:if (!OS.GTK3) { /* * Feature in GTK. The progress bar does * not redraw right away when a value is * changed. This is not strictly incorrect * but unexpected. The fix is to force all * outstanding redraws to be delivered. */ long /*int*/ window = paintWindow (); OS.gdk_window_process_updates (window, false); OS.gdk_flush (); }in updateBar() GTK2 enforces updates while GTK3 does not.I'll assign this to Ian.(In reply to Eric Williams from)I have a local patch already for that. I upload that soon.(In reply to Lars Vogel from)No problem, assigning back to you!(In reply to Eric Williams from)Only removing the barrier was wrong, according to Alex (even though it works for me). Would be nice if Ian could have a look.New Gerrit change created:New Gerrit change created:(In reply to Eclipse Genie from)Alternative approach letting Gtk run its event loop instead. Note that this is same code for GTK2 and GTK3. Lars, Eric, Leo please test as this even loop stuff always finds a way to bite.Eric already tested that. Great. For my personal learning: To test this patch, I think I compiled the natives (successful). How can I see if my compilation was successful?Gerrit changewas merged to [master].Commit:Pushed to master. Lars, please test with tomorrow N-build and if fine abandon your patch.(In reply to Alexander Kurtakov from)Will do. If it works, I suggest we downport it to 4.6.1 to have again a moving progress indicator on the Splash under Linux.(In reply to Lars Vogel from)Copy the *.so files to the fragment should be enough.Start inner eclipse instance/or swt snippet and you should see the results.(In reply to Alexander Kurtakov from)Looks great. Thanks. Reopening to downport this fix to 4.6.1.(In reply to Lars Vogel from)I'll make a Gerrit change for the backport in a moment.New Gerrit change created:PMC approval given. We need another committer to review and give +1 for the merge.Gerrit changewas merged to [R4_6_maintenance].Commit:(In reply to Eclipse Genie from)Backport is in master now.Verified in 4.6.1.M20160824-0059.This change introduced.(In reply to Sergey Prigogin from)I merged the partial rollbacks.- Please find out if there is another way of fixing this.- If the OS.gtk_main_iteration_do(..) is no longer used, we should remove the binding.Gerrit changewas merged to [R4_6_maintenance].Commit:(In reply to Eclipse Genie from)Sorry, this commit belongs on the revert bug, not this one.Alex, any chance this can be fixed in 4.6.2 RC3? If not, we should move it out to 4.6.3...Let's move it. I'm out of ideas what to do with it now.Its unlikely this will be fixed in 4.6.3, moving it back to 4.7.	32.0
id=137953	REOPENED	JDT	Core	3.2	All All	P3 enhancement	Ayushman Jain	2006-04-21 10:54 EDT by	Marshall Schor	2013-09-23 03:32 EDT (	3 users	If you use the completion gestures (ctl-space after typing the start of a class name, for instance), it shows types that match, including deprecated ones. It would be good for naive or impatient users to automatically order things so that in the case where two (or more) class names match, to order the deprecated ones below the non-deprecated ones. We had one user complain about this - he accidently picked the deprecated one. (There is a not-very-prominent decoration on the icon indicating it is deprecated - obviously in this case not enough for our user to notice).	Currently, there is an option to filter deprecated elements (Preferences>Java>Editor>Content Assist>Sorting and Filtering>Hide deprecated references) and when this option is disabled, deprecated proposals have a decoration on the icon.But this is true that the deprecation isn't currently a criteria of sorting.It's too late to add this kind of enhancement in 3.2 but this something we should investigate after 3.2.Deferred post 3.2.As of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.Makes sense: we do the same in Open Type. But of course this must only be done if the names exactly match i.e. lower the relevance for the deprecated thing in that case.Ayush, please take a look. Right now deprecated status or otherwise isnot used in computing the relevance of a proposal ?Using JDT 3.9.0, I noticed the following use-case which makes completion favour deprecated types over non-deprecated ones.With JUnit 4.11 in classpath (contains both org.junit and junit.framework packages), type "Assert.assertNonN" without the Assert type being imported, then run Ctrl-Space for completion. The first method suggested is the one from the deprecated type junit.framework,Assert.In such case, I would have prefered JDT to put org.junit.Assert.assertNonNull as first proposal.	5.0
id=326690	REOPENED	JDT	Core	3.7	All All	P3 normal	Ayushman Jain	2010-09-30 12:04 EDT by	Alekseev V.	2010-11-09 02:51 EST (	4 users	Build Identifier: 20100617-1415I have realy fast internet connection.But when i use autocomplete, some code generating or refactoring eclipse use to write arg0, arg1 and so on instead real parmeters names. As i see, it is because it is not waiting untill javadoc is downloaded (even when it is milliseconds on my connection). It is realy anonying. It is especially cool, when developing some ui -- method whith 5 ints.I know, i know, i can attach javadoc and sources localy, but i see no reason to use localy somethin available in the web.Reproducible: SometimesSteps to Reproduce:1. attach online javadoc instad local one2. Use autocomplete on some coomon class, which documentation is not cached localy.3. "Engoy" arg0, arg1 and arg2.	You can increase the timeout on the Java > Editors > Content Assist > Advanced preference page.I've tryed different values of timeout from 1 to 5000, but found no diferencies at all. For example, when i use 5000 (which means 5 seconds!) autocomplete steel appears immidiately witn agrN instead trying to get javadoc for five seconds and show popup only after successfully getting it or 5 seconds passed.(In reply to)OK, then there might be a different problem. Please attach a step by step test case, otherwise I can't do anything since I cannot reproduce the problem.I'll try my best. But if it will be not enough i'll gladly answer more questions.1) First of all i need to use some classes or members i have not used fiew time before (in my last case, when i decided to reopen bug, it was javax.swing.JLabel).2) Then i make autocomplete to appear (type "label." and then "Ctrl+Space"). And i try to access, for example, setText. I type "setTe" and i see only one option in popup "setText(String arg0)". 3) I WTF, but then i move cursor on this line of popup, wait for javadoc to pop up rightwards and then exit popup pressing "ESC" (first pressing "ESC" and then accessing javadoc via "F2" is also an option for me). 4) now when i try "label." -> "Ctrl+Space" -> "setTe" everything is ok -- i see "setText(String text)";of course it is not the great problem for setText, but, for example, "new Insets(int arg0, int arg1, int arg2, int arg3)", when there is no way to determinate which of them is left inset, which is right and so on is the real problem.Are you still using 20100617-1415 or a new build?Using 3.6 and 3.6.1 I cannot reproduce the problem i.e. I always get the expected parameter names. Without more detailed reproducible steps there's nothing I can do here.(In reply to)I'm asking because a new bug got introduced in 3.7 M2 and M3 which caches the raw parameter names (see).OK, I figured it out: parameter names for constructors are broken if the type is not yet imported.Test Case:0. remove source attachment from rt.jar1. paste the following snippet into Package Explorer:------ %< ------class ParamNameBug { void foo() { new String }}------ %< ------2. code assist after "new String"==> no parameter namesQ: is hasNoParameterNamesFromIndex needed at all? If so, why is it needed?(In reply to)sorry what is hasNoParameterNamesFromIndex?(In reply to)this bug looks exactly the same as mine.This is a field and the question is for the developer that has to investigate the issue. Nothing you need to worry about ;-)	10.0
id=343720	REOPENED	JDT	Core	3.7	PC Windows XP	P3 normal	Ayushman Jain	2011-04-25 04:18 EDT by	Deepak Azad	2012-01-31 03:52 EST (	3 users	Content assist proposes 'out - Object', which is incorrect ------------------------------------------------------ void foo(String s) { switch (s) { case "abc": System.out.println("abcd"); break; case "xyz": System.out.println("xyz"); break; case <Ctrl+space> default: System.out.println("oops"); break; } }------------------------------------------------------	This is expected behaviour, since we proposed all the unresolved names also in the list of proposals, to make sure that when one has used a variable previously but not declared it, one can still get a proposal for it. In this case out is an unresolved name.Reopening for further investigation. We need to understand why 'out' is returned. System.out should resolve so it should not be considered as an unresolved reference.Targeting RC1 for the investigation. This doesn't mean this will be fixed. It all depends on the outcome of the investigation.Actually, the name references are all found by parsing the lines of code starting from the enclosing method to the point where assist is invoked. org.eclipse.jdt.internal.codeassist.complete.CompletionParser.getUnspecifiedReference() is the one that records all the names encountered during this parsing. Seefor details. So even though the intention was to propose unresolved references, we ended up proposing all name references.This is why 'out' also ends up being proposed, since the parsing has no notion of whats resolved and whats not. The one thing we can try doing is to cache the unresolved variables that were found during the resolution of the compilation unit just before the call to CompletionEngine.complete(..) (i.e. at the point we report the "*cannot be resolved" errors), and save this list in the enclosing method scope. Then inside CompletionEngine.complete(..) , query the scope and add all these unresolved names as proposals. This way, we will skip resolved names such as 'out' below but still propose unresolved variables such as 'var':void foo(String s) { var = 1; switch (s) { case "xyz": System.out.println("xyz"); break; case <Ctrl+space> default: System.out.println("oops"); break; } }We can also leave it as it is coz I don't think the proposal is such a distraction. It has a low priority and doesn't really appear on top of the list. The above approach, if done will make the code resolution need more memory space in situations other than content assist as well, since the unresolved variables will always be cached. It may improve performance of content assist though, since the extra parsing won't be required.If this is to be attempted, this will have to be moved to 3.8. Olivier, let me know what you think.(In reply to)Sounds good. Since we don't have that many unresolved references I don't expect that list to be very big and therefore I don't think the cost in memory is that high.Definitely for 3.8 given the analysis of the problem.Moving it out of 3.8 plan for now. If we manage to find cycles,we will reconsider.	5.0
id=493833	REOPENED	Platform	SWT	4.5.1	PC Linux	P3 minor	Ben Steffensmeier	2016-05-17 12:46 EDT by	Ben Steffensmeier	2017-02-07 10:37 EST (	6 users	CreatedShows tabs before and after a restore/minimize, they should be the same.When a view stack is minimized and then restored the close button on the view can become hidden behind the minimize button. This only occurs when the rightmost view is selected and the view stack is narrow enough that the view titles are truncated in the tab text. See the attached image for an example.If one of the other views(not rightmost) is selected then the close button is always visible but some of the text on the rightmost view will be cut off. The problem can easily be corrected by selecting a different view or resizing the view stack.To reproduce:1. Open several views in the same stack2. Decrease the width of the view stack until some of the text is cut off of the tab titles3. Select the rightmost view, note the close button('x') on the tab4. Minimize the view stack5. Restore the view stack6. Note the close button('x') is no longer visible on the tab.	Just to make sure: can you reproduce rhis with 4.6 RC1? Can you reproduce this also with GTK2?I just downloaded Neon(4.6.0M7 Build id: 20160505-1310) and I see the same behavior. I am currently running GTK2, I do not know if the same problem exists on GTK3.New Gerrit change created:I have submitted a patch which fixes the problem. It has been tested on linux using both gtk2 and gtk3 and it resolves the problem in both versions. Can someone take a look at the patch and let me know if there are any problems or if it can be merged?Moving to SWT.The patch introduces regression for me on GTK2 - the shortened view titles do not have "..." at the end anymore.Andrey, thanks for taking the time to look at the patch. Unfortunately I do not see the same regression as you. The default theme on GTK2 has the ellipsis("...") disabled, this is what I see both before and after the patch. By removing the org.eclipse.ui.themes plugin from my run configuration I can remove the theme and the ellipsis are enabled, again I get the same behavior both before and after the patch. Is it possible that in your test configuration you were unexpectedly using a theme which does not include ellipsis(swt-simple: false)?Can this patch be retested based on Ben's comment about themes?(In reply to Nathan Jensen from)Sorry, my bad, patch looks good for me, but I'm not SWT committer so I can't merge. @SWT team - anyone?(In reply to Andrey Loskutov from)I'd be happy to review this today on Linux, will need someone to review on Mac and Windows since CTabFolder is cross platform.(In reply to Eric Williams from)I can't actually reproduce this bug on Linux.(In reply to Eric Williams from)Perfectly reproducible for me on RHEL 7.0, on both GTK2/3 implementations.rpm -q gtk2 gtk3gtk2-2.24.22-5.el7.x86_64gtk3-3.8.8-5.el7.x86_64Createdbefore the patch(In reply to Eric Williams from)I've just tested it on Windows, I can reproduce the problem without patch (see my attachment) and I can confirm that the patch fixes the problem.Can we please merge this?Gerrit changewas merged to [master].Commit:Thanks for the patch. Pushed.Createdafter the patchThis change is the reason for misplaced overflow buttons in master.I'm on Windows 7, I20170205-2000, new workspace, open all types in java.lang.annotation, close last editor.I also saw similar drawing errors around the chevron button on macOS in I20170206-2000. Reverted the patch with(In reply to Markus Keller from)Yes, this can be also reproduced if just opening many editors and then constantly resizing window. Sometimes the chevron jumps to wrong position. I'm sorry I haven't tested this case :-(	17.0
id=183101	REOPENED	Platform	UI	3.3	PC Windows XP	P3 normal	Boris Bokowski	2007-04-18 22:57 EDT by	Hiroyuki Inaba	2011-06-21 14:37 EDT (	2 users	Build ID: I20070323-1616Steps To Reproduce:1. Both Project Explorer view and Package Explorer view are displayed. 2. Exit workbench.3. Launch workbench again.More information:When the project is not displayed in Project Explorer view,the project is displayed if the context menu is open onProject Explorer view area.	When the "input" tag line is not exist in the.metadata\.plugins\org.eclipse.ui.workbench\workbench.xmlfile, this phenomenon is occurred. <workbench progressCount="16" version="2.0"> : <window height="978" width="1204" x="1301" y="26"> : <page aggregateWorkingSetId="Aggregate for window 1176775847203" focus="true" label="Workspace - Java"> :==> <input factoryID="org.eclipse.ui.internal.model.ResourceFactory"==> path="/" type="8" /> : </page> : </window> :</workbench>The condition that "Input" tag disappears is not understood.It is not restored by the workbench operation when disappearing once. I was able to evade this phenomenon by inserting the following codes. In org.eclipse.ui.workbench/Eclipse UI/org/eclipse/ui/internal/WorkbenchWindow.javarestoreState(IMemento,IPerspectiveDescriptor) method :// Recreate each page in the window.IWorkbenchPage newActivePage = null;IMemento[] pageArray = memento .getChildren(IWorkbenchConstants.TAG_PAGE);for (int i = 0; i < pageArray.length; i++) { IMemento pageMem = pageArray[i]; String strFocus = pageMem.getString(IWorkbenchConstants.TAG_FOCUS); if (strFocus == null || strFocus.length() == 0) { continue; } // Get the input factory. IAdaptable input = null; IMemento inputMem = pageMem.getChild(IWorkbenchConstants.TAG_INPUT);==> if (inputMem == null) {==> try {==> Workbench workbench = (Workbench) PlatformUI.getWorkbench();==> IAdaptable adaptable = workbench.getDefaultPageInput();==> IPersistableElement persistable = (IPersistableElement)==> (adaptable.getAdapter(IPersistableElement.class));==> inputMem = pageMem.createChild(IWorkbenchConstants.TAG_INPUT);==> inputMem.putString(IWorkbenchConstants.TAG_FACTORY_ID,==> persistable.getFactoryId() );==> persistable.saveState(inputMem);==> } catch (Exception e) {==> // none==> }==> } :Fixed >20070423. (My fix is slightly different, it does not work in terms of the memento.)marking as fixed.Boris, I've reverted these changes since they interfere witht the parts references tests...see.Marking for investigation in RC2.I don't have any time left to do this in 3.3. Please let me know if you found reproducible steps to get into this state without a page input.Removing CommonNavigator because I don't think it has anything to do with that.	8.0
id=208432	REOPENED	Platform	UI	3.4	All All	P3 normal	Boris Bokowski	2007-11-01 11:05 EDT by	Boris Bokowski	2008-02-05 16:53 EST (	2 users	From Ed Merks:	Fixed in HEAD > 20080203. (I chose the simplest possible fix that makes the sublist unmodifiable. Code contributions for a better implementation are welcome!)Verified the simple fix by code inspection on Windows XP using I20080205-0010. However, I am going to reopen this bug because subList returns an observable list, but does not fire change events as the underlying list is modified.To get this right would require real work, for which I don't have enough time right now.	2.0
id=197390	REOPENED	Platform	UI	3.3	All All	P3 normal	Boris Bokowski	2007-07-21 05:33 EDT by	Michael Baranov	2007-07-23 07:31 EDT (	2 users	Build ID: I20070625-1500Steps To Reproduce:Despite the fact that IdentityConverter *IS* able to convert from primitive type values to the respective boxed type, UpdateValueStrategy only creates IdentityConverter in situations as primitive-to-primitive or boxed-to-boxed and not in situations as primitive-to-box or box-to-primitive.Consequences: binding bramework incorrectly requires com.ibm.icu_xxx.jar (3.9 mb) at runtime (referenced class is: com.ibm.icu.text.NumberFormat from class: org.eclipse.core.databinding.UpdateStrategy)More information:this should work out of the box:new UpdateValueStrategy() { @Override protected IConverter createConverter(Object fromType, Object toType) { return new IdentityConverter(Boolean.class, boolean.class); }}	(In reply to)This is by design. If you don't want the full ICU4J you can use the replacement plugin[1].[1]Michael, I hope the replacement plug-in solves your issues. Otherwise, please reopen.Thank for the tip. 2 Concerns, however:1) The replacement plugin seems to be a work in progress and not available yet.2) I still don't see why the described case of box-to-primitive and primitive-to-box should require *any* other library. I still think that org.eclipse.core.databinding.UpdateStrategy is should correctly use (instantiate) IdentityConverter in such cases *before* referencing com.ibm.icu.text.NumberFormat in the code. If you are sure this is as intended, leave it as wontfix. It's easily fixable from library user code.(In reply to)It is available from the download page for any Eclipse build, starting with Eclipse 3.2, in a separate section called "com.ibm.icu.base binary and source Plug-ins".From looking at the code, it seems that the intention was that IdentityConverter be used for the primitive-to-boxed case. I suspect that this is a bug and I'm reopening this bug accordingly.We could use IdentityConverter for the boxed-to-primitive case as well, but I'm not sure how we currently handle the "null" value - do we throw some kind of exception (like IdentityConverter does), or silently convert to zero?primitive-to-boxed is probably the most used type of conversion that occurs with control-to-bean type binding. IMO this case should not require any side libs.I'm not sure either. IMO the same BindingException thrown from IdentityConverter should be propagated up to the user code. IMO no silent conversion should happen in null-to-primitive case. It's 100% the user's responsibility to make sure it never happens or handle it.	5.0
id=218424	REOPENED	PDE	UI	3.4	PC Linux	P3 normal	Chris Aniszczyk	2008-02-09 07:47 EST by	Francis Upton IV	2008-05-08 20:02 EDT (	3 users	Build ID: I20080208-1530Steps To Reproduce:I just upgraded to 3.4M5 and tried to run my junit tests. They use an application, not a product. Instead of running with the desired RCP application, they were starting with the IDE. In the debugger I tracked it down to the fact that the generated config.ini file had an eclipse.product property pointing to the IDE. My 3.3 installation (and 3.4M4) did not do this.It seems that something changed between M4 and M5 to put the eclipse.product property in the config.ini when it should not be there.Also, there seems to be a problem of not using the correct location for the configuration area. I 1) delete the entire contents of workspace/.metadata/.plugins/org.eclipse.pde.core, and start eclipse clean.2) run a Junit plugin test (generate config.ini, clear config, specifies test application not product), and the test fails because it uses the IDE application instead of my RCP application.3) I run a different Junit plugin test case and it runs using the configuration location of the first test case. I tried it a couple more times, they all share the same configuration location.More information:	investigating...I'm having trouble reproducing this problem. Is it possible for you to break this down into a series of simple and reproducible steps? I just tried a few scenarios and everything was generated properly along with launching things properly?One thing you may want to try is to toast your current launch configuration and configure it again.Are you supplying a custom config.ini by any chance?Sorry to waste your time; I'm not sure what happened, but I reinstalled 3.4M5 (I actually ran this on the Ibuild that became 3.4M5, so I wanted to make sure I had a clean installation).Even on the reinstalled version I was able to reproduce the problem by:1) Running the test on the 3.4M4 build2) Exiting eclipse3) Pointing eclipse to 3.4M5 (started with clean)4) Running the test again on 3.4M5, it would get the problem (the generated config.ini would contain an eclipse.product property which made the IDE come up instead of my expected application)5) Deleted and recreated my launch config, same result(but then...)6) Went back to 3.4m4 (clean start) and problem was *there* too.7) Deleted the entire contents of .../.plugins/org.eclipse.pde.code8) Problem went away9) Switched back to 3.4m5 (clean start) and problem was also gone thereI use the default options of having the config.ini generated.So I'm not sure what happened, but I will close this.This happened again.1) Upgrade to 34m7 (did not start -clean the first time)2) Ran a previously working Junit plugin test (that uses a test application (not product)) and it ran the IDE app instead.3) Restarted -clean with same result4) Exited and removed the contents of ../.plugins/org.eclipse.pde.core5) Same problem (runs IDE app)6) Again removed ...pde.core and deleted and re-created the launch config, using all default values except selecting my test application7) Same problem.The config file that is generates looks like this:#Configuration File#Thu May 08 16:24:02 PDT 2008org.eclipse.update.reconcile=falseosgi.install.area=file\:/usr/local/eclipse_deploy/eclipse34m6/eclipseeclipse.p2.profile=SDKProfile/workspaceosgi.framework=file\:/usr/local/eclipse_deploy/eclipse34m6/eclipse/plugins/org.eclipse.osgi_3.4.0.v20080326.jareclipse.buildId=I20080330-1350osgi.bundles=reference\:file\:/usr/local/eclipse_deploy/eclipse34m6/eclipse/plugins/org.eclipse.equinox.simpleconfigurator_0.1.0.v20080310-2148.jar@1\:startorg.eclipse.equinox.simpleconfigurator.configUrl=file\:/home/francis/d/transform/.metadata/.plugins/org.eclipse.pde.core/pde-junit/org.eclipse.equinox.simpleconfigurator/bundles.infoosgi.configuration.cascaded=falseeclipse.product=org.eclipse.sdk.ideosgi.splashPath=file\:/usr/local/eclipse_deploy/eclipse34m6/eclipse/plugins/org.eclipse.platform_3.3.100.I20080320osgi.bundles.defaultStartLevel=4/../p2osgi.ws=gtk(note the line eclipse.product - that should not be there).My launch config XML file is attached (in a minute).CreatedLaunch configurationThe patch provided byfixes this problem, but I think there is an underlying cause that's not yet understood.	6.0
id=496845	REOPENED	Platform	IDE	4.6	PC Linux	P3 minor	Brian de Alwis	2016-06-27 10:10 EDT by	Brian de Alwis	2016-11-24 13:50 EST (	30 users	+++ This bug was initially created as a clone of+++(In reply to Matthias Kurz from)	I thought I created some tests for this code. Oops.I've extracted FileLocationDetails into a separate class and created some tests, including the cases you have above, and they all work.The code in question is: FileLocationDetails details = FileLocationDetails.resolve(initialPath); if (details == null || details.fileInfo.isDirectory() || !details.fileInfo.exists()) { String msg = NLS.bind(IDEWorkbenchMessages.OpenDelayedFileAction_message_fileNotFound, initialPath); MessageDialog.open(MessageDialog.ERROR, window.getShell(), IDEWorkbenchMessages.OpenDelayedFileAction_title, msg, SWT.SHEET);Note that the dialog content is created using the "initalPath" that's provided as an argument, and which is not changed. This argument is taken directly from the SWT.OpenDocument event. That, and the double-dialog ":178:3" case, suggests that the launcher process is somehow changing or interpreting the file paths with a colon.(In reply to Brian de Alwis from)In the native launcher, if there are multiple arguments after the --launcher.openFile that don't start with "-" then those are interpreted as a list of paths. (ie, eclipse --launcher.openFile /some/path/file1.txt some/path/file2.txt)On linux this list of paths is sent to SWT by setting a property on a window, the property is a string with the individual paths delimited using ":" (eclipseGtk.c/setAppWindowPropertyFn)SWT will be the one looking for the ":" and sending the open document event.On windows, it looks like the launcher is sending the paths to SWT one at a time using the SWT_OPENDOC window message, so this won't be an issue there.So if this is an issue on Linux with the colon why not just use + also for jumping to a column and just get rid of the colon syntax?I'm sure we'll find another platform with special behaviour for '+' ;) But enabling '+' should fix everything.I've been unable to figure out any way to pass line information with open(1) on OS X.Retitled and changed OS to Linux, since this seems to be specific to Linux.New Gerrit change created:Gerrit changewas merged to [master].Commit:Brian, if you still target 4.6.1 please send an email to the PMC mailing list for approval.Oops, I forgot all about this. For 4.6.1 I'd rather a more targeted fix.New Gerrit change created:Gerrit changewas merged to [R4_6_maintenance].Commit:Fixed for 4.6.1New Gerrit change created:Gerrit changewas merged to [R4_6_maintenance].Commit:(In reply to Eclipse Genie from)This reverts the change. A reminder for the rules:1. The fix is put into master so that it can be tested and validated that it works.2. The SAME fix is then prepared to backport.3. A second committer reviews that change.4. Component lead or PMC approves the backport.	16.0
id=249687	REOPENED	PDE	UI	3.5	PC Windows XP	P3 major	Chris Aniszczyk	2008-10-04 16:32 EDT by	Simon Archer	2008-10-20 00:42 EDT (	1 user	Using Eclipse 3.5M2Today a misplaced XML element is not reported as an error, when really it should be. For example: <?xml version="1.0" encoding="UTF-8"?> <scr:component name="my.component"> <implementation class="com.ibm.foo.Component"/> <provide interface="javax.sound.sampled.DataLine"/> </scr:component>What wrong with this? It's an easy mistake when hand-editing the XML, but a <provide> element must be nested inside a <service> element, making this XML illegal.While <scr:component> XML elements can exist inside any other XML element, everything within element should be strictly validated against the schema.Note: In this example I have used the 'scr' namespace to emphasize the problem, but it is not strictly needed in this case.	CreatedDSDocumentFactory and DSHyperlinkDetector updatesThose classes were breaking the DS Builder, when the user creates a valid element using a invalid parent, example:<component> <provide> </provide></component>Now, the DSDocumentFactory checks if the parent of a given element is valid before initialize it.Due to this modification, the DSHyperlink was raising an exception, so I put a instanceof validation to solve the problem.I thought to generalize that bug, as we need to warning for any illegal children, even if they are not a valid element, right?So I suggest to:-Add a getAllowedChildren() method in the IDSObject interface, so each element would return which are the allowed tag name for its children-Develop a validateIllegalChildren(IDSObject) method in DSErrorReporter, to check if a used children is valid or not.Comments? :)Would it be possible to validate the XML against the schema published by OSGi?I don't think we should worry about illegal children now.I rather not worry about the schema yet. If we move to EMF-based models, than we can use the schema.done.Actually, I will leave this open, as we have nothing else around this issue.I just wanted to reiterate that validating against invalid child elements is particularly important to guard against misplaced elements. I recently saw a case where a <property> element was nested inside a <service> element when it is only legal to have them as direct children of a <component> element. This sort of problem is tricky to diagnose since it relies on observing the LogService for errors reported by the SCR. Ideally we should have this level of validation for Eclipse 3.5. Raising Severity to Major with the hope that this won't get overlooked.	6.0
id=250450	REOPENED	PDE	UI	3.5	PC Mac OS X - Carbon (unsup.)	P3 enhancement	Chris Aniszczyk	2008-10-10 11:10 EDT by	Pascal Rapicault	2010-05-06 18:23 EDT (	10 users	When I right click on a test to run it as a JUnit plugin test, most of the time it defaults to run the IDE, however I want this test to be run headless.Given that there is no right way to guess which application to run, I would really appreciate if there was a way to have a preference to set the default application to run in those cases.This would represent a really great help for all non-UI involved ppl like us.	Pascal, can't you just choose the application as (Main tab), "No Application <Headless Mode>"This successfully launches the 'org.eclipse.pde.junit.runtime.coretestapplication' which should run things headlessly.Closing this bug as WORKSFORME. If I misunderstand what you want, please reopen.I believe Pascal is referring to the fact that when you use the context menu to Run as Junit Plug-in Test the "headless app" is not the one selected by default.How can we read your mind :)?By using a UI application by default, you include both UI and Core applications. PDE UI gives you an option to change this by setting the application and sharing the launch configuration with your friends.Also, we even check your project for a dependency on SWT. If you depend on SWT, we choose the UI application, if you don't, we choose the headless.What else do you want us to do :)?The part about depending on SWT is good to know. For example, org.eclipse.pde.build.tests is headless. It does not depend on swt directly, but it does use org.eclipse.ui to do an ImportOperation. I'll have to rewrite this to remove the dependency on ui.However, more generally, it may be hard to remove indirect dependencies on swt.One possibility would be to check the Bundle-Activator and see if it extends AbstractUIPlugin. For example, org.eclipse.p2.tests's activator simply implements BundleActivator directly. It does not depend on swt directly but gets it through a dependency on p2.installer.(In reply to)What's wrong with persisting a "PDE Build Tests" launch configuration with the headless application selected? This way, you can at least have things work.This is a bit tricky but I will rename the bug to talk about enhancing our detection around what application to use. I think what we have currently is pretty adequate and has worked.If we can do anything in the short term, please let us know.(In reply to)I do have such a launch configuration saved in my workspace (though not persisted in the bundle itself). Similarly, I have many SomeTestClass.testBug* launch configurations which each run a specific test method.The issue is when running an individual test method (or suite) for which a launch configuration has not been previously created.Another option is when creating a launch configuration for a given test method, check to see if a launch configuration exists for the Test class in general, then copy that configuration and set the test method on it.Or, the project can save a configuration with a blank test class and this configuration can serve as the template for new ones.Just so you hear it again from me :-) I know I can change the application, I know I can share launch configs. My scenario is about using the context menu to initiate the launching of a test (right click on a test class, or a package) and having defaults that make sense to run my application (which is what Andrew was saying in the previous comment).As for changing the severity, remember that it represents my point of view and we are being pretty annoyed by this now that we are writing more tests, so I would appreciate if this could be made more than an enhancement.I agree this is an annoyance.(In reply to)The org.eclipse.osgi.tests project does not depend on SWT. If I choose one of the tests (org.eclipse.osgi.tests.bundles.ClassLoadingBundleTests) and Run As -> JUnit Plug-in Test then PDE will create a new launch configuration which defaults to use the org.eclipse.sdk.ide product to launch. Is this working as designed? From your comment it sounds like a bug.If the tests project does not depend on SWT then it seems reasonable to default to a headless application to launch the test case. Beyond that, I'm not sure how PDE can really make a better guess on what the default application type should be for the test run. If I read Pascal's and others comments correctly they want either of the following:1) A context menu option JUnit Plug-in Test (headless)2) A PDE preference to set what the default application type should be when using the context menu option JUnit Plug-in Test.3) Use a launch configuration stored in the test project as a template when creating new launch configuration for test classes in the same project.Right now I am leaning toward option 3. This way there is no guess work done by PDE.Changing Version tag to something more believable. Note that this is not a statement about when the enhancement request will be addressed (the Target Milestone field is used for that); the Version tag should be set to the version of Eclipse you were using when you saw the need for the enhancement.***has been marked as a duplicate of this bug. ***	10.0
id=253958	REOPENED	PDE	UI	3.5	PC Windows XP	P3 normal	Chris Aniszczyk	2008-11-05 12:03 EST by	Markus Keller	2010-04-29 11:09 EDT (	5 users	I20081104-0916Follow-up to.The "Build" tab of the PDE manifest editor should have UI to set the output.<lib> property for each source.<lib>.	Andrew, if we have something like "source.." listed... is output.. inferred automatically? I'm curious how PDE Build handles this today.Once I have a better understand of things, I'll work on getting the UI perfected.Anything to keep Markus happy :)I'm not sure we want to expose this. The output library for a source folder is defined by the Java build path. If we expose this in the editor, it will have update the project's build path - I think it would be better to infer it from the build path rather than let it be editable in this editor. Is there a reason you want edit it? I'd rather just have a way to synchronize build.properties with the build path.Based on the comments in, I think we should close this one as WONTFIX.If you can pass this behind the scenes that's even better. Closing as wontfix.has been resolved differently, so we need this UI again.Plus UI for.	5.0
id=209022	REOPENED	Platform	SWT	3.3	PC Windows 2000	P3 normal	Carolyn MacLeod	2007-11-07 08:51 EST by	Bjoern Sundin	2010-12-03 05:10 EST (	4 users	CreatedSnippet demonstrating the use of a DateTime widget as CellEditor in a Table within a TableViewerWhile using the DateTime widget as CellEditor Control of acell in a TableViewer I have noticed the following:1) Cannot show the DateTime without border. Other CellEditors show in a"flat" way, the DateTime not. I haven't found any way of influencing the STWstyle in order to remove the border.2) The lower part of the DateTime text is below the cell and thus partly notvisible (this would probably be handled if the border wasn't there or if onecould set the vertical text alignment to top)Also see attached snipped to reproduceVersion: 3.3.0Build id: I20070621-1340	Car to see if this is natively supported or not.I can do this natively on WIndws by adding the following code to createHandle() after the handle is created: if ((style & SWT.BORDER) == 0) { int bits = OS.GetWindowLong (handle, OS.GWL_EXSTYLE); bits &= ~(OS.WS_EX_CLIENTEDGE | OS.WS_EX_STATICEDGE); OS.SetWindowLong (handle, OS.GWL_EXSTYLE, bits); }I am not sure if the check should be: if ((style & SWT.BORDER) == 0) {or: if ((style & SWT.FLAT) != 0) {Grant, do you know which it should be?I think it should be "if ((style & SWT.BORDER) == 0)". This would make it match the DateTime on gtk (no border unless style SWT.BORDER specified) and would also match Spinner on win32 (which is of a very similar nature).Thanks, Grant - I think that's the correct way.Also, I've just noticed that the javadoc for SWT.FLAT says it's only used for buttons and toolbars.Fixed > 20071107.This still seems to be a problem on Vista with 3.4 M5.***has been marked as a duplicate of this bug. ***Reopening so that the Vista bug does not get lost.Please adjust the target milestone, so it does not point at a closed milestone in the past.	8.0
id=60884	REOPENED	Platform	SWT	3.0	PC Windows XP	P3 major	Carolyn MacLeod	2004-05-04 10:07 EDT by	Kim Woods	2006-06-28 14:06 EDT (	8 users	In some dialogs the JAWS screen reader does not appear to read static text correctly. For example select windows, preferences, help - there is grey text on the right hand pane talking about the browser which is never read out.In other dialogs the tab key does not tab to boxes containg read only text so again the screen reader does not read it and the blind user does not know what is going on. This means that Eclipse is not section 508 compliant	This should be fixed in very recent JAWS upgrades (5.00.809).*** This bug has been marked as a duplicate of***I'm not sure this is a duplicate of 21771 as I am using a later level of JAWS V 5.00.844 and this does not read the help dialog described above or some of my own dialog static text.If you are hearing text correctly are there some options I should set on JAWS ???Car can you try this, assuming that your JAWS has the label reading fix?JAWS does read the label in the help preferences as soon as you click on "Help" in the tree. I checked every page in the preferences dialog, and all statics are read correctly as soon as you open each page.There is a known problem with eclipse F1 help dialogs (popups) not having the label text read (we are working on that), and there is a known JAWS problem with INS+B not rereading all controls in a dialog properly (I have reported this to Freedom Scientific).I am running JAWS 5.00.809 on Windows XP with the 6.0 manifest (i.e. to enable Windows common controls version 6.0). The version of eclipse I am running is build 200404270800.Where did you get JAWS 5.00.844? I was under the impression that 5.00.809 was the absolute latest. Frank, do you have any insight on this strange JAWS version? Maybe the JAWS folks have introduced some new problem(s) if their 844 version is not reading static text in dialogs.The current version of JAWS is 5.00.844. They do maintenance releases every so often as they fix bugs. Here's a pointer to that download:OK. I downloaded JAWS 844 and tried it, and *phew* it reads the static labels in the dialogs correctly. I was worried for a minute there that they might have changed something that broke our dialogs. So it looks like we are ok there.Kim, we need to figure out what is different in your installation compared to mine. What version of eclipse are you running? Which Windows OS do you use? If you are running Windows XP, do you have the javaw.exe.manifest file for eclipse located in the jre\bin directory of your Java VM so that you are using version 6.0 of the Windows Common Controls? (I honestly do not know if this would affect MSAA; and in particular, if it would make the Windows Static control more accessible, but it seems to me that it could). Here's a bit more info on that (note that the link below may be split across 2 lines):-home/faq.html#xpthemesHello CarolynI am running XP and I did not have the manifest file in the jre/bin directory -I have added it but it seems to make no difference - do I need to set anything else up????I am using an eclipse build within the workbench product and I experience this problem on bothEclipse 2.1 build 200306271545 with an IBM 1.4.1 JREEclipse 3.0 build 200401301130 with an IBM 1.4.2 JREWhen I mouse button down on the help in the tree view of the preference page it says "Tree view help closed 5 of 14", nothing on the right hand side is read until I hit the tab button and it goes straight to the list view - nothing above the checkbox is read.Is there some JAWS setup or usage that I have not got right - I am very new to JAWS.Kim.There's nothing else you need to set up in either JAWS or eclipse.So, the 2 differences between your setup and mine are:- you are using the IBM JRE and I am using Sun's- your versions of eclipse are older than mineI am going to try the IBM JRE, and if JAWS still works, I'll try using an older eclipse. I'll let you know what happens.Only had time today to try the IBM VM - no difference - JAWS reads the Preferences dialog labels just fine. I tried several pages, including Help. Hopefully tomorrow I will get a minute to go back and try an older eclipse. Is it possible for you to upgrade to today's integration build (it seems pretty stable - I have been using it all day), or are you running a product built on top of eclipse that hasn't upgraded yet? If so, do you know if they will be upgrading to 3.0 when it is released? If so, then JAWS may just work for you when that happens... ;)Tod & Frank, can you please do me a favour?Can you run JAWS on a fairly recent version of eclipse, and see if it reads the label at the top of the "Window->Preferences... Help" page for you?(i.e. The line that reads "The selections determines web browsers used...". Hmmm... the grammar in that sentence is a little off... <g>)Kim has tried it with the May 6 integration build, and it still doesn't work for her. All she gets is JAWS saying "tree view Help closed 4 of 9". I get that, too, but then JAWS also reads the label and the rest of the controls on the right. In fact, for me, JAWS reads pretty much everything on every page of the prefs dialog. Kim and I have both tried running the same OS, VM, eclipse build, and JAWS version (5.00.844) and yet we still somehow have differences.Frank, how do I reset JAWS to its factory defaults absolutely everywhere? Do I have to go around deleting jcf files? Or is there some global "reset" switch somewhere?I have tried both the current version of JAWS, 5.00.844, and a beta of version 5.1 which is not yet available to the public. Neither of them read the static text at the top of the help settings dialog as I tabbed through the fields. Please see my comment onre static text reading.Carolyn,to remove any special settings:1. Go to JAWS50\settings\enu and erase any .JCF files associated with your app. In this case, JAVAW.2. Open the configuration manager with the default configuration file. Select Reset to factory defaults. That should put you back to original settings.I deleted my C:\JAWS50\SETTINGS\enu\javaw.jcf file, and now JAWS does not speak the text at the top of the preference dialog pages (i.e. the help text is not read... i.e. I am experiencing what you are experiencing). Here is the contents of the file that I deleted, as viewed in WordPad:[OSM]VertCaretMaxX=3[Highlight Colors]000000000/236233216=1[WindowClasses]Button=Button[MSAAClasses]SysTreeView32=1I will also attach the file, in case maybe there is some binary component. Frank, I don't see which setting could possibly have fixed the preferences dialog. I tried reassigning the SysTreeView32 window class to MSAA, but that didn't help. Reassigning Button to Button is silly, and of course has no effect. It looks like the vertical caret maximum width is already 3, so I can't change that. And I don't recall how we changed the highlight color.Anyhow, somewhere in this file there may be a hint for the JAWS folks on how they can read our labels in dialogs.CreatedJAWS JCF file that causes Help preference page text to be readWhile attaching this file, I happened to notice a file in the same directorycalled "javaw.jbs". What is that and might it be useful somehow?Carolyn,I think I might put my guess on the highlight. What that told JAWS is that 000000000/236233216 is a highlight and needs to be spoken every time text appears in that color set. 0, of course, is black, but I don't know what the other color is. So that means that black characters on the 236233216 background is treated as if it was a highlighted field.Too funny. I wonder what else has been read correctly for me ever since we added that highlight setting. Hmmm... I wonder if this is considered 508 compliancy? :)Actually, Frank, since JAWS may not get their fixes released until after our 3.0 release, do you mind listing the steps we did to add that highlight setting? Who knows, maybe it might help someone out there. Thanks!Am I reading this correctly that we are down to JAWS fixes and possibly a readme item on highlight settings on this one?Correct - I am not going to do anything else on this AT THIS TIME, until I hear back from the JAWS folks on how it's going with this problem. I sent them (through Frank) a very simple test case. If they can figure out how to read that correctly, then they will be able to read all of our dialogs.I believe Frank and Kim were trying to figure out how to set the highlight so that we can write up the work-around for others to use until it is fixed for real.Reopening this bug report for problem tracking purposes.***has been marked as a duplicate of this bug. ***Just curious, has anyone heard anything back from the JAWS people on this one? The ball has been sitting in their court for a while.Carolyn, do we know the timeframe for the JAWS fix?Here is what the Freedom Scientific (JAWS) people said in June:From Joe: "When a dialog gains focus JAWS is supposed to read the title, the dialog's static text, the group box title and the focused control's prompt, type, state and content."Frank, a few questions for you:1) When does the next version of JAWS ship?2) What is the current status of the Eclipse work with Freedom Scientific?3) Did you ever figure out the steps to repeat that great highlight workaround?Thanks!I should have pasted the entire communication with Freedom Scientific that pertained to INS+B not working the way we expect it to. Here it is:Carolyn, through Frank, said:1. INS+B does not speak the MSAA names, even if giving focus to the control does. INS+B should speak MSAA names if they are available. Relevant eclipse bugs:a. 59813b. 15320c. Note that we are not the only application that would benefit from fixing this - the problem was noted in Photoshop as well.FS Answer:ERNIE: Joe, what is the best definition of the INS+B behavior? I have experienced the following. I recall that a graphic in the tab order would interrupt the speaking of the dialog. I recall that the InstallShield dialog templates had a graphic at the top of the tab order. Although the graphic did not have the "Tab stop" property, it was still a problem. After I placed the graphic at the end of the tab order and re-ordered the other controls, the dialog would speak properly. In my opinion, if the tab order is correct, INS+B should not have a problem. Is this different when using MSAA? Frank DiPalermo indicated that many of the people at IBM think INS+B fails most of the time. If this is true, then I view this as a major bug. Also, didn't JAWS, a long time ago, use to automatically speak the entire dialog contents when the dialog was displayed? Was this removed around JAWS3.5 or 3.7 because people thought that this made JAWS too chatty and that the user could always press INS+B at anytime anyway? Or was this removed because it was unreliable?Joe: When a dialog gains focus JAWS is supposed to read the title, the dialog's static text, the group box title and the focused control's prompt, type, state and content. At no time did it read the entire dialog. Ins+b is supposed to read each control in the dialog in the tab order.Further info from JAWS: They say that this is not a JAWS bug.Here are their notes:1. Window, Preferences, Help is an example.2. JAWS does not read static text as focus moves to the dialog side of the window.3. Alt+Tabbing out and back causes this text to be read.4. This is not a bug. JAWS is not designed to read this kind of text on focus change.5. Eclipse development might like to analyze how static text is used in this situation.Tod & MVM, you & I need to get together to discuss this.Note also that JAWS will probably not be changing the way that INS+B works because they say that all other apps are way too verbose if they actually read all controls. They say that for most eclipse dialogs, they need to go down at least 5 levels of children before they can read all of the pertinent controls, and that's a lot more levels than other applications.Just a further comment on the Ins+B thing:As Carolyn said, JAWS currently looks at objects in the highest level of the hierarchy to determine what to read. We experimented with going down two more levels, but that only resulted in a couple of more Eclipse objects being read from the Preferences dialogs. Going any further results in difficulties in other apps like reading all the list items from a combo box. I am going to write up a procedure whereby JAWS might capture every object and then do some analysis in deciding what to say. Then we'll try to get the Freedom Scientific folks to code it for JAWS 7. We'll keep you informed.Any more on this?	27.0
id=105246	REOPENED	Platform	SWT	3.2	PC Windows XP	P3 normal	Carolyn MacLeod	2005-07-26 19:47 EDT by	Paul Cooper	2006-04-05 11:21 EDT (	0 users	Loading a 15x12 pixel jpeg created in Photoshop but copied from a windows bmp file throws the following exception:org.eclipse.swt.SWTException: Unsupported or unrecognized format at org.eclipse.swt.SWT.error(SWT.java:2691) at org.eclipse.swt.SWT.error(SWT.java:2616) at org.eclipse.swt.SWT.error(SWT.java:2587) at org.eclipse.swt.internal.image.FileFormat.load(FileFormat.java:73) at org.eclipse.swt.graphics.ImageLoader.load(ImageLoader.java:124) at org.eclipse.swt.graphics.ImageData.<init>(ImageData.java:308) at com.swtdesigner.SWTResourceManager.getImage(SWTResourceManager.java:117) at com.swtdesigner.SWTResourceManager.getImage(SWTResourceManager.java:166) at org.ncems.cis.vehicle.ui.SearchPageUI.<init>(SearchPageUI.java:122) at org.ncems.cis.vehicle.uimodel.SearchPageModel.<init>(SearchPageModel.java:38) at org.ncems.cis.vehicle.CISVehicleApp.searchPage(CISVehicleApp.java:98) at org.ncems.cis.vehicle.CISVehicleApp.open(CISVehicleApp.java:171) at org.ncems.cis.vehicle.CISVehicleApp.main(CISVehicleApp.java:64)	Createdjpg that fails to load.That's funny - I can load that image just fine. I ran SWT's "ImageAnalyzer" (comes with the eclipse examples) and it opens it no problem. What version of eclipse are you running? Are you sure you attached the correct jpg? I see a 15 x 12, depth 24 jpg, and it's a little beige-grey shaded triangle pointing up.I'm running Eclipse 3.02You have the right image. I can load larger images just fine, but this one and a companion throw this exception every time I try to load them.Here's sample code that throws the exception every time:import java.io.BufferedInputStream;import java.io.InputStream;import org.eclipse.swt.graphics.Image;import org.eclipse.swt.graphics.ImageData;import org.eclipse.swt.widgets.Display;/** * Class: SWTImageTest * * @author pcooper * Created on Jul 27, 2005 */public class SWTImageTest { private final static String imagePath = "/resources/images/up.jpg"; public SWTImageTest() { Display display = Display.getCurrent(); InputStream is = this.getClass().getResourceAsStream(imagePath); ImageData data = new ImageData(new BufferedInputStream(is)); Image image = new Image(display, data); } public static void main(String[] args) { SWTImageTest test = new SWTImageTest(); }}Are you able to upgrade to eclipse 3.1?Only if I know this bug is fixed in that version. I generally don't like to change my development platform mid-project.Are you saying this bug is fixed in 3.1? I'm using MyEclipse and SWTDesigner, and both will require me to upgrade them as well, so I'd like some assurance that the new version fixes this problem.Thanks.I am running eclipse 3.1 (on WinXP) and it works for me.If you'd like to try it first before upgrading everything else, you could just download eclipse 3.1, then download the 3.1 example plug-ins (from the same download page - just unzip them to the same place as eclipse), and then start eclipse (I use the following command to start eclipse, just FYI, in case you need the extra heap space or something):D:\eclipse\eclipse.exe -data D:\workspace -clean -debug -consolelog -vm d:\jdk1.4.2_06\jre\bin\java -vmargs -Xmx400m -Xms400MWhen eclipse comes up, run the ImageAnalyzer example by going to:Window -> Show View -> Other...SWT Examples -- SWT Example Launcher OKIn the SWT Example Launcher view, expand Stand Alone and select Image AnalyzerClick RunIn the ImageAnalyzer, File -> Open File...find and select your up.jpg, and say Open.If it opens for you without throwing an exception or bringing up an error dialog, then you will be satisfied that eclipse 3.1 opens your problem jpgs.Hope this helps - please let me know so that I can close this bug.Upgraded to Eclipse 3.1.....took a little while to figure out SWT is now a separate download!!!Bug is fixed. Thanks for your assistance!You're welcome. SWT is available separately, yes, but it's still included when you download eclipse - that's how folks usually get it. Sorry you had trouble finding it. The dll's are now rolled into a jar in the eclipse download, which makes it a little tougher to use swt standalone outside of the IDE - you have to find and extract the swt dll's first. However the steps I gave inshould have worked just with the eclipse download. Anyhow, I'm glad it works for you now. We will consider this bug closed.This bug should be marked as WORKSFORME since nothing was changed specificallyfor it.Marking WORKSFORME.Thanks, Billy - good spot.I'm leaving the status alone here for now, but I'm now testing my app OUTSIDE of Eclipse, and I'm getting the exception again. I've searched my PC for any other copy of SWT and there is none. The code works fine running from Eclipse, but starting the app from the commandline under Windows XP SP 2 throws the exception every time.Could someone verify that the submitted code runs standalone OUTSIDE of Eclipse?Thanks.PaulYes, your little snippet fromruns for me outside of eclipse.I did use eclipse to compile the snippet - can't imagine that making any difference.Here's the 3 DOS command lines I used to run it (3rd is split across 4 lines):D:cd D:\workspace\Car\binD:\jdk1.4.2_06\jre\bin\java-classpath .;D:\eclipse\plugins\org.eclipse.swt_3.1.0.jar;D:\eclipse\plugins\org.eclipse.swt.win32.win32.x86_3.1.0.jar-Djava.library.path=D:\eclipse\plugins test.SWTImageTestLet's make the snippet even smaller, so that there are no Java streams to deal with, and definitely no SWTDesigner resource management going on, and let's read the image 100 times (and dispose it each time, so we don't run out of handles). Here's the modified snippet, which runs fine for me:import org.eclipse.swt.graphics.*;import org.eclipse.swt.widgets.*;public class SWTImageTest2 { public static void main(String[] args) { Display display = new Display(); for (int i = 0; i < 100; i++) { Image image = new Image(display, "D:\\temp\\up.jpg"); image.dispose(); } }}I am using the following version of the SWT DLL:swt-win32-3138.dlland the 2 SWT JARs that came with eclipse 3.1:org.eclipse.swt_3.1.0.jarorg.eclipse.swt.win32.win32.x86_3.1.0.jarand I am launching it using Sun's jdk1.4.2_06 VM,and I am running on Win XP SP2.Please note that it is *very* strange that you are getting SWT.ERROR_UNSUPPORTED_FORMAT in FileFormat.load.That should only happen if the first 2 bytes in your file (or stream) are not FFD8, which is the standard "Start Of Image" for JPEG file format. Since your file does indeed start with FFD8, the only thing I can think of that may be happening is some kind of strange intermittent IO error or something. Is this possible?Things that make you go "hmmmmmmm".It looks like the bug is in the ImageData class, and only if you load the image from a resource, AND only if I build the file outside of Eclipse. I can repeat the problem any number of times, using exactly the same versions of everything you are. The only difference is that I build the jar from the command line using an Ant/perl script. The original code throws the same exception every time if I build from the command line.In fact, I've tried 5 different variations of this code, and the only one that blows up is passing ImageData a stream loaded from a resource.Here's my output:C:\dev\Sandbox\make>java -classpath ..\lib\org.eclipse.swt_3.1.0.jar;..\lib\org.eclipse.swt.win32.win32.x86_3.1.0.jar;.\jar\sandbox.jar -Djava.library.path=..\lib SWTImageTestgetImageAsFileStream completedgetImageAsFile completedorg.eclipse.swt.SWTException: Unsupported or unrecognized format at org.eclipse.swt.SWT.error(SWT.java:2942) at org.eclipse.swt.SWT.error(SWT.java:2865) at org.eclipse.swt.SWT.error(SWT.java:2836) at org.eclipse.swt.internal.image.FileFormat.load(FileFormat.java:73) at org.eclipse.swt.graphics.ImageLoader.load(ImageLoader.java:126) at org.eclipse.swt.graphics.ImageDataLoader.load(ImageDataLoader.java:18) at org.eclipse.swt.graphics.ImageData.<init>(ImageData.java:327) at SWTImageTest.getImageAsResource(SWTImageTest.java:62) at SWTImageTest.<init>(SWTImageTest.java:24) at SWTImageTest.main(SWTImageTest.java:75)getImageAsResource completedDoneI can post my code if you want....Again, thanks for spending time on this.OK, past your latest SWTImageTest.java here, and please write down the exact steps you used to create sandbox.jar (I have never used Ant or Perl). Are SWTImageTest.class and up.jpg the only 2 things in the jar?I'll reopen this bug until we either find it or give up <g>.Thanks for plugging away at this. I'll simplify things a little and take Perl out of the equation. But I can generate this problem consistently. If I compile in Eclipse, it works fine, even if I build the jar from the command line. But if I compile from the command line, it throws the exception, even in Eclipse.I'll post source, the ant build.xml file, and the batch file used to compile and run by EOD.Paul, Did you ever figure this one out?I really should close the bug again as "works for me" unless you can see a reason to keep it open.I'll take a look at this problem again next week, as I got taken off this project and put on a more critical one. I'm coming back to it next week, and this will be at the top of my priority list.Sorry for taking so long to get back to it, and thanks for keeping on top of it.	18.0
id=212989	REOPENED	Platform	SWT	3.4	PC Windows XP	P3 normal	Carolyn MacLeod	2007-12-14 04:18 EST by	Marco Trudel	2008-03-26 12:25 EDT (	1 user	CreatedThe snipped that demonstrates the bug.Build ID: 3.416Steps To Reproduce:1. Run the attached snippet2. Press the "next" button to change to the next month.Now, a MessageBox appears informing you about "foobar". When closing it, kind of a slide show will start; The calendar infinitely jumps to the next month.An example to clarify the report:If you open the snippet at the 14. December 2007, then press "next month", "foobar" will appear. After closing the "foobar" MessageBox, the calendar will select:14. January 200814. February 200814. March 200814. April 2008... and so on ...More information:This happens on Windows XP. Reproduced with SWT 3.3 final and SWT 3.4M3.	As workaround, I now first finish processing the SelectionEvent and then open the Message box. The best way I found to do this is:public void widgetSelected(SelectionEvent e){ // SelectionEvent of a DateTime... Display.getDefault().asyncExec(new Runnable() { public void run() { // new MessageBox // this will be executed at the next dispatch // therefore, the SelectionEvent will be completely processed first } });}Not beautiful, but working...CAR, SWT.Selection is usually posted, not sent. Is there a reason you are sending it? If not, please fix it to post (and the other platforms as necessary).Fixed in HEAD > 20071218.Thanks!Thanks :-)Unfortunately, this fix makes this bug even worse:Sorry, of course I meantCreatedSnippet that shows that the applied fix does not solve the bug.Sorry, I have to reopen the bug. The applied patch seems to only fix the snipped I provided. As soon as a fancier code is executed, the same behaviour occures again.I added a new minimized snipped that demonstrates that.Hmmm... the dialog is getting focus and eating the mouse up event, and that is confusing the calendar widget. Steve - any ideas how to work around that?That is the right behaviro (but unwanted). When focus changes, the key up goes to the new focus control.Does sending the event rather than posting it fix it?Nope. When this bug was first opened the event was being sent.I changed it to post.The behavior changed slightly, but the bug is still there.Can I close this bug?The snippet instill shows the strange behavior.andexplain what is going on.shows a "not beautiful but working" <g> workaround using asyncExec.I am not sure what else can be done here. Steve?WONFIX? (it can be worked around with the asyncExec())I am closing this as "won't fix" because the behavior needs to be worked around.I decided to see if any other controls had similar behavior (i.e. repeatedly do something if the mouse stays held down). I noticed that Slider keeps sliding if you hold the mouse button down on the arrow, so I changed "DateTime" to"Slider" in the snippet and ran it. It's kind of fun - you'll have to try it <g>. I'll paste it below. (I'm on Vista, but I think XP will behave similarly).Anyhow, suffice to say that the behavior is not unique to DateTime. Any time a mouse up that is needed to stop some action is eaten by a newly-created dialog or shell, the dialog or shell will need to be created in an async.import org.eclipse.swt.SWT;import org.eclipse.swt.events.SelectionEvent;import org.eclipse.swt.events.SelectionListener;import org.eclipse.swt.layout.FillLayout;import org.eclipse.swt.widgets.Slider;import org.eclipse.swt.widgets.Display;import org.eclipse.swt.widgets.MessageBox;import org.eclipse.swt.widgets.Shell;public class DateTimeSnippet2 implements SelectionListener{ private Shell shell; private Slider dateTime; public DateTimeSnippet2() { shell = new Shell(Display.getDefault()); shell.setLayout(new FillLayout()); dateTime = new Slider(shell, SWT.NONE); dateTime.addSelectionListener(this); shell.pack(); shell.open(); } public static void main(String[] args) { DateTimeSnippet2 snippet = new DateTimeSnippet2(); Display display = Display.getDefault(); while(!snippet.shell.isDisposed()) { if(!display.readAndDispatch()) display.sleep(); } } public void widgetSelected(SelectionEvent e) { if(true) // without this block, the last fix for this bug works { Shell newShell = new Shell(shell, SWT.DIALOG_TRIM|SWT.APPLICATION_MODAL); newShell.open(); newShell.dispose(); } MessageBox mb = new MessageBox(shell, SWT.ICON_INFORMATION|SWT.OK); mb.setText("foo"); mb.setMessage("bar"); mb.open(); dateTime.removeSelectionListener(this); } public void widgetDefaultSelected(SelectionEvent e) { }}Can you provide a snippet that demonstrates the working workaround? The asyncExec does not help in the second snippet. Actually, I changed to MouseListener because I found no way to work around that problem discussed here. If I handle the event in mouseUp(), all is fine. Of course with mouseDown(), the same problem occurs. So maybe it would be a possible fix to send the selection event after the user released the mouse...BTW: using a MouseListener instead of a SelectionListener of course has problems as well, but at least it works for the standard usage of the control.I do not reopen the bug, but I think it should be since there's currently no usable and reliable way of using a SelectionListener with that control.Hmm... rats - I thought you had figured out the fix <g>.I'll take a look at it this afternoon.One question for you first - the snippet seems pretty contrived. Do you actually have a real application situation where you bring up a new shell on selection, close it, and then bring up a dialog?Sure, how would I otherwise have run into this? This is of course only an executable minimal sample of my quite large application. Solely for your convenience ;-)In my application, data is loaded depending on the selected day. There's always a busy dialog with a progressbar and, depending on the loading outcome, other dialogs or message boxes might be shown.CreatedA snippet showing the "async" workaround to fail with "Shell" but work with "MessageBox"On second thought, I think my answer was not really helpful. Of course I do not have such a contrived situation in my application. Just opening a shell in the listener is enough to reproduce the problem. The snippet is actually quite bad.I have now attached another snippet that demonstrates that opening a Shell has another effect than opening a MessageBox. The first still fails with your applied patch, the second works (the same applies to the "async" workaround).Reopening this bug so that the issue is not lost.At present, I do not have time to look at it.	21.0
id=270321	REOPENED	Platform	SWT	3.4.1	PC Windows XP	P3 normal	Carolyn MacLeod	2009-03-27 15:05 EDT by	Hiren Patel	2009-04-01 09:08 EDT (	2 users	CreatedCode SnippetBuild ID: M20080911-1700Steps To Reproduce:1. Create a window that has a Group object that contains a Composite.2.Inside the composite create a text field. See the example snippet.More information:JAWS does not read the group name since the Text field is inside a Composite within the Group. If the Text field is outside the composite, the group name is read fine. If you take a look at the example, it shows a case where you may have the need to combine widgets together and create a reusable method or object. For this purpose it makes sense to have a separate composite inside of the Group. I can understand that due to inner layers, it may not be practical for a screen reader to read the group name, however there is no work around for this problem as well. JAWS can not read the accessibily name that is explicitly set in the code for the text field either.	Frank, here's another bug report for Freedom Scientific: If the MSAA name for an EDIT is set, then please speak it (when the EDIT gets focus). This is how we implement a crude form of 'label-for' Relations in the absence of IA2. Please note that Window-Eyes speaks the MSAA name.Thanks!CarolynCan we leave this bug report opened until we can get one opened from Freedom Scientific? Thanks!	2.0
id=270039	REOPENED	Platform	SWT	3.4.1	PC Windows XP	P3 normal	Carolyn MacLeod	2009-03-25 18:06 EDT by	Hiren Patel	2009-03-27 14:53 EDT (	2 users	I have an eclipse page that I wish to put some warning information. For decorative purposes I would like to prepend the text with an icon. I create a Composite and within it use a Label to embed the image, and use a read only Text field for the warning information so that the JAWS screen reader can read the information. Here's a snippet of code that I am using:Composite composite = new Composite(body, SWT.NONE);composite.setLayout(GridLayoutFactory.fillDefaults().numColumns(2).create());composite.setLayoutData(GridDataFactory.fillDefaults().span(2, 1).create()); Label imageLabel = new Label(composite, SWT.WRAP);imageLabel.setImage(getDefaultImage());imageLabel.getAccessible().addAccessibleListener(new AccessibleAdapter() { @Override public void getName(AccessibleEvent e) { e.result="Default image icon"; }}); Text testLabel = new Text(composite, SWT.WRAP|SWT.READ_ONLY);testLabel.setLayoutData(GridDataFactory.fillDefaults().align(SWT.FILL, SWT.FILL).grab(true, false).hint(250,SWT.DEFAULT).create());testLabel.setText("This is some sample text for JAWS to read."); Since the image is embedded in a Label and the Label preceded the Text object, I believe there is internal code in eclipse to associate the Label to the Text object or it's JAWS that is doing the association. Due to the association, JAWS tries to read the image label. I would like JAWS to read it as the accessible name that I set it to (Default image icon), but some how it is not reading the accessible name and it's reading some random name assigned to the graphic (ie. graphic123). I've noticed this in some of the base Eclipse wizard pages as well. If you check out a sample Wizard, when there is an error message, an icon is associated with the error and the icon is read as "graphicXXX". The text next to the graphic is read fine, but the way the graphic is read is really meaningless and would be confusing to blind users and therefore fail accessibility for our product, based on IBM guidelines. Attached is a sample plugin that depicts the problem above in an editor. Also according the following article, I believe my code is pretty much as suggested.	CreatedSample plugin with the accessibility issueI don't know how to install & run the plug-in because it is not a java project.Would it be possible for you to provide a standalone SWT snippet instead?For example:If you have never written an SWT snippet before, this link might help:Thanks!Instructions for installing the plugin:1. Unzip the zip file provided in the attachment.2. Launch Eclipse 3.4.x3. Click on the Help menu bar -> Software Updates...4. Under the Available Software tab, click on the Add Site... button.5. Click on the Local... button and browse to the "AccessibilitySamplesUpdateSite" directory where you unzipped the file in step 1. Hit OK to add the site.6. Remaining in the Available Software tab, click on the checkbox for the site that was just added, and click the Install... button. Follow the steps to install. It should restart your workbench.7. Upon restart, create a Project by selecting the File menu -> New -> Project. In the dialog select to create a Project from the General folder. Go through the create Project wizard. You will need to provide a project name. I used Sample1.8. Once you are returned to the main workbench window, select the project in the Package Explorer, right click and create a new file. Follow the wizard to create a new file. Name the file acc_test.xml. 9. Once you are returned to the main workbench window, select the file acc_test.xml, right click and choose Open With. You should see an Accessibility Samples Editor option. If so then select it and it will take you to a window, similar to the screenshot below. If you don't see the editor option, choose Other, and you should be taken to a dialog that has the Accessibility Samples Editor. If you still don't see it, then you probably do not have the plugin installed correctly. Please contact me if this is the case.CreatedSample java fileI tried installing as a Software Update, as you suggested, and it seems to want something fromfile:/E:/SAT/Development/workspace_32/AccessibilitySamplesUpdateSite/ - metadatawhich, of course, I don't have.This is with Eclipse 3.5 by the way.I also tried the Sample java file (is it supposed to run standalone?), and as yet I can't get it to compile - I guess I need a ton more stuff in my workspace (I guess I usually just have SWT, and maybe JFace, and maybe ui.workbench. I'll try again another day when I have more time.In the meantime, if you happen to have a minute to create an SWT snippet, that would ensure that I look at your problem sooner.CreatedAssessibility snippetCreatedImage for snippetThanks, Hiren. Sorry it took so long to run the test case - I appreciate your perseverance.I recognize the bug now - it is very old. I am going to mark this bug as a duplicate of an old bug, however I am going to ping the screen reader folks one more time on this - they should be able to look for the MSAA name of a graphic label. I will let you know what happens.*** This bug has been marked as a duplicate of***CreatedAccessibility snippet with a Button.Thanks for your quick reply. I saw the old bug report which claims that JAWS is able to read the MSAA properties of a Button, however I am not seeing this currently. Can you verify whether or not this is true? I attached a snippet with a Button example.Also it appears the other bug report is resolved as well. Is there a bug report against JAWS for the Label issue?(In reply to)They still read the MSAA name of a Button with an image. They were also reading the MSAA name of text Buttons in JAWS 5.0, but sometime after that, they broke it again.Do you have a real-life use case where the MSAA name for a text button really, truly should be different than the Button's text?(In reply to)No - it's all just in old email. I sent an email to one of the JAWS developers today to ask him to look at it again.I am CC'ing Frank to this bug. He is our liason to Freedom Scientific.Frank, I am hoping that you can keep this bug and the oldalive at FS long enough for it to be fixed this time. :)I have a situation with a label followed by a text field, followed by a button in one row. The text field needs to be disabled since the user is supposed to select the button which will take them to a dialog. The dialog collects the user input and upon exiting the dialog, the text field is populated. JAWS currently is not able to read disabled fields and thus as you are tabbling along the first thing you will hit in that row is the button. For a blind person, it would be beneficial for us to be more descriptive in the accessibility name of the button since that is the only chance the user will know what is being asked for.A couple other situations that I have encountered with JAWS, that I was hoping you have some insight on.1. Earlier I mentioned disabled fields being ignored by a screen reader. Do you know what the accessibility guidelines say about that, since a blind user has no indication that there are disabled fields in the page.2. I have several situations in my pages where I organize fields inside of Group objects. Each time, I have a name set for the group. At times JAWS is able to read the name of the group and other times it is not. It appears if you place checkboxes/radio buttons in the Group, it is able to read the name of the group. If you have Label/Text field combinations, then it is not. Are you aware if anyone has encountered this problem?(In reply to)I think you should enable the text field and leave it blank. That is what most applications do in this situation. The user might want to type in the info instead of using the button at all.Regarding 2, please open a new bug for this and provide an SWT snippet that shows the problem. Thanks!CreatedExample of a case that requires a disabled field.Response to:Part 1. I don't think it's reasonable to force text fields to have to stay enabled due to a bug in screen reader software. Please take a look at the graphic attached. Here's an example of a Port value that is requested by the user. The user is expected to hit the Set button, navigate the viewer for the type of port and select it. The user has no idea what to enter in the text field and therefore it doesn't make sense to allow the field to be edittable. One may argue to place the list of port selections in a drop down, however if you notice that the viewer provides a logical grouping that makes it easy for users to search for their desired port. This simply can not be done in a drop down. Going back to the question I had about disabled fields in general, what are your thoughts on that? We have numerous examples of the need to enable/disable fields in general based on user selections and it would a appear that a non-sighted user should be able to know that a field is disabled on a page.Part 2.I will go ahead and open up another bug report. Thanks.Reopening bug for two reasons.1. Can a bug report be opened against Freedom Scientific with regards to the accessibility name for an image inside a Label not being honored. 2. Please seepart 1. I think there is a legitimate case that requires the accessibility name for a Button to be read by JAWS.Sorry meant to saypart 1 notpart 1 above.Frank, how do we "open a bug report" against Freedom Scientific?Thanks!Carolyn	18.0
id=278572	REOPENED	Platform	SWT	3.6	PC Windows XP	P3 normal	Carolyn MacLeod	2009-05-31 19:37 EDT by	Nick	2010-06-26 14:12 EDT (	9 users	StackLayout becomes very slow when using it with a lot of controls.This is because it does not only layout the currently visible controls, but also the invisble onces.To change this only one line of code needs to be changed:protected void layout(Composite composite, boolean flushCache) { Control children[] = composite.getChildren(); Rectangle rect = composite.getClientArea(); rect.x += marginWidth; rect.y += marginHeight; rect.width -= 2 * marginWidth; rect.height -= 2 * marginHeight; // Do not update bounds // when the component will not be visible. // In the update bounds all descendents will // start layouting as well and we do not want this! for (int i = 0; i < children.length; i++) { // Current code: children[i].setBounds(rect); // Should be: // if (children[i] == topControl) children[i].setBounds(rect); children[i].setVisible(children[i] == topControl); }}This worked on my pc.Im am new to SWT so maybe I am wrong,if there is a better way please let me know..Kind Regards, Nick	There is a suggested fix for this. Could someone take a look at it? :)theoretically this change can break clients, in practice I find it unlikely.(In reply to)Remy, is this problem affecting you ?(In reply to)No, not me at the moment. I was actually looking for some other bug that I was CC'd on and found this on my query and noticed that it was assigned to Veronika so I thought I'd punt it back to inbox.We should make this change.Fixed > 20100114.I tested with topControl set to null, and with varying sizes of stack pages, and with Eclipse. I don't see how this could break existing apps. It is safe and simple and it would definitely make StackLayout lay out faster if there are lots of controls not showing.Thanks, Nick!This fix will be in 3.6 M5.(In reply to)I'd have moved the call to setBounds() outside the for(...)Good point. Done.The layout code now reads:... for (int i = 0; i < children.length; i++) { children[i].setVisible(children[i] == topControl); } if (topControl != null) topControl.setBounds(rect);}I have reverted StackLayout back to the original, before the patch, and I am reopening this bug.For some reason, it messes up Eclipse when it starts up on a new workspace.I do not have time to figure out why, so for now I need to just revert.Felipe, maybe you can explain why you thought this could break clients in theory... because it does... Maybe something about not having any content yet. Maybe some of the sub-layouts have been given width or height hints and they need to be forced to set them?I think we may have to close this as "won't fix", and give up on speeding up stack layout for now.is the Eclipse bug, FYI.(In reply to)You may want to look at our use of StackLayout and let us know if we are using StackLayout in an inappropriate way. If it could be argued that our use is broken, we can probably fix the problem on our side by adding a call to layout somewhere.If we use it that way then there are most likely also others out there doing it the same way.I've just filed awhere I'm encountering something similar "strange" when it comes to stack layout because when you use it in an scrolled-composite and do a size calculation it also takes the invisible children into account which might be desired under normal circumstances but not in it the above mentioned use case.	14.0
id=223696	REOPENED	Platform	SWT	3.4	PC Windows XP	P3 major	Kevin Barnes	2008-03-24 13:37 EDT by	Keith Willenson	2013-06-18 11:42 EDT (	5 users	Build ID: I20080207-1530Steps To Reproduce:1. Code:import org.eclipse.swt.SWT;import org.eclipse.swt.graphics.Point;import org.eclipse.swt.graphics.Rectangle;import org.eclipse.swt.printing.PrintDialog;import org.eclipse.swt.printing.Printer;import org.eclipse.swt.printing.PrinterData;import org.eclipse.swt.widgets.Display;import org.eclipse.swt.widgets.Shell;public class helloTest { public static void main(String[] args) throws Exception { Shell s = new Shell(Display.getDefault()); PrintDialog printDialog = new PrintDialog(s, SWT.DIALOG_TRIM | SWT.APPLICATION_MODAL); printDialog.setScope(SWT.SELECTED); PrinterData data = printDialog.open(); if (data != null) { data.scope = PrinterData.SELECTION; System.out.println("print data " + data); Printer printer = new Printer(data); Point dpi = printer.getDPI(); Rectangle clientArea = printer.getClientArea(); Rectangle paperBounds = printer.computeTrim(clientArea.x, clientArea.y, clientArea.width, clientArea.height); double paperWidth = (double) paperBounds.width / (double) dpi.x; double paperHeight = (double) paperBounds.height / (double) dpi.y; System.out.println("client area " + printer.getClientArea()); System.out.println("bounds area " + paperBounds); System.out.println("dpi " + printer.getDPI()); System.out.println("width " + paperWidth + " inches" + ", height " + paperHeight + " inches"); printer.dispose(); printer = null; } data = null; printDialog = null; s.dispose(); s = null; }}2. Select non-default paper in print dialog (under windows right click the printer and select Printer Preferences)3. Note that printout from program still shows 8.5 x 11 paperMore information:Obviously in each of these runs, I am not getting the paper size I expect. This used to work correctly at some point in time. Environment: Eclipse SDK Version: 3.4.0 Build id: I20071213-1700 also Build id: I20080207-1530 also Eclipse 3.3.2 under Java jre1.6.0_03Also Build id: I20080207-1530 under Java jre1.5.0_15Run 1 with ANSI E (34 x 44 in) selected:print data PrinterData {driver = winspool, name = \\PRINTSERVER\HP DesignJet 500 42+HPGL2 Card}client area Rectangle {0, 0, 4863, 5796}bounds area Rectangle {-118, -401, 5099, 6598}dpi Point {600, 600}width 8.498333333333333 inches, height 10.996666666666666 inchesRun 2 with 36 x 24 in selectedprint data PrinterData {driver = winspool, name = CutePDF Writer}client area Rectangle {0, 0, 5100, 6600}bounds area Rectangle {0, 0, 5100, 6600}dpi Point {600, 600}width 8.5 inches, height 11.0 inchesKeith wrote:>>>	This problem blocks our development ability since the application is designed to print maps on large printers. Therefore we need to choose non-default paper sizes.Let's get to the bottom of this. Keith is blocked.Keith, did you see my newsgroup post in answer to your question there?Here it is again:Newsgroups: eclipse.platform.swtSent: Monday, March 31, 2008 3:16 PMSubject: Re: Printing paper sizeHi, Keith.Sorry to take so long to answer you.I don't have that exact printer, but just for fun, I downloaded the driver from HP and ran your snippet.I get the correct output (although I think you meant to say that ANSI E paper is 34" x 44" - see).I am running eclipse 3.4M6 on XP SP2. Are you on XP, or maybe Win2K or Vista?I am running JRE 1.5.0_02, but I don't see how the JRE could make any difference here (I could be wrong, though <g>).Here's my snippet output:print data PrinterData {driver = winspool, name = HP Designjet 500 42+HPGL2 Card}printer bounds Rectangle {0, 0, 20399, 26398}printer client area Rectangle {0, 0, 20163, 25596}printer dpi Point {600, 600}paper width = 33.998333333333335 inches, paper height = 43.99666666666667 inches <<< this is close enough to 34" x 44"...I changed your snippet slightly to use the bounds of the printer instead of the clientArea so that I can more easily see from the output that the selected paper size is correct.Here's the slightly modified snippet (the only other interesting change I made was to use PrinterData.SELECTION instead of SWT.SELECTED, but I doubt that changed anything):import org.eclipse.swt.*;import org.eclipse.swt.graphics.*;import org.eclipse.swt.printing.*;import org.eclipse.swt.widgets.*;public class PrinterPaperSizeTest { public static void main(String[] args) throws Exception { Display display = new Display(); Shell shell = new Shell(display); PrintDialog printDialog = new PrintDialog(shell, SWT.DIALOG_TRIM | SWT.APPLICATION_MODAL); printDialog.setScope(PrinterData.SELECTION); // not SWT.SELECTED PrinterData data = printDialog.open(); if (data != null) { //data.scope = PrinterData.SELECTION; System.out.println("print data " + data); Printer printer = new Printer(data); Rectangle bounds = printer.getBounds(); Rectangle clientArea = printer.getClientArea(); Point dpi = printer.getDPI(); System.out.println("printer bounds " + bounds); System.out.println("printer client area " + clientArea); System.out.println("printer dpi " + dpi); System.out.println( "paper width = " + ((double) bounds.width / dpi.x) + " inches, " + "paper height = " + ((double) bounds.height / dpi.y) + " inches"); printer.dispose(); printer = null; } shell.dispose(); display.dispose(); }}So I'm not sure what could be going wrong for you (I have to ask <grin> - are you *sure* you selected the ANSI E paper and "OK" in the Printing Preferences dialog? <grin>).So I know this isn't much help, but now at least you know that it is working for someone, so maybe you can look at other possible factors.CarolynI just looked at your conversation with Matthew (originally, I thought it was from the newsgroup post - I see now that discussion continued in email).The following info might be interesting (not sure):"When I initially set it up, I selected it and pushed the "Apply" button. It now comes up as the default ...."I will explore that angle for a bit, and see if I see anything.I will also try the "download the driver and pretend to print to it" trick here at home on my Vista machine (not sure if it will have the same result as XP).Will let you know what happens.I downloaded the printer driver from:For the system, I selected "Vista", and at work when I was answering your newsgroup post, I selected "XP".When I run my snippet from, and select the HP Designjet 500, click on Preferences, and select "ANSI E" from the "Size is:" combo, I get the following output:print data PrinterData {driver = winspool, name = HP Designjet 500 42+HPGL2 Card}printer bounds Rectangle {0, 0, 20399, 26398}printer client area Rectangle {0, 0, 20163, 25596}printer dpi Point {600, 600}paper width = 33.998333333333335 inches, paper height = 43.99666666666667 inchesIf I select "ANSI E Oversize", I get:print data PrinterData {driver = winspool, name = HP Designjet 500 42+HPGL2 Card}printer bounds Rectangle {0, 0, 20402, 26402}printer client area Rectangle {0, 0, 20400, 26400}printer dpi Point {600, 600}paper width = 34.00333333333333 inches, paper height = 44.00333333333333 inchesSo this seems to work correctly for me on Vista, too. My JRE here is 1.6.0_01, and I'm running the latest SWT (i.e. post-3.4M6).CreatedHP DesignJet Preferences.pngI created a custom paper size of 36 x 48, and I tried to click "Apply", but there is no "Apply" button (see attachment). Did you perhaps mean that you created a "Print Task Quick Set" and clicked "Save"? Or does your Printing Preferences dialog really have an "Apply" button? Anyhow, I tried running the snippet with and without a "Quick Set" saved, and the result was the same for 36 x 48 paper:print data PrinterData {driver = winspool, name = HP Designjet 500 42+HPGL2 Card}printer bounds Rectangle {0, 0, 21599, 28798}printer client area Rectangle {0, 0, 21363, 27996}printer dpi Point {600, 600}paper width = 35.998333333333335 inches, paper height = 47.99666666666667 inchesThen I selected "ANSI E" again, and got:print data PrinterData {driver = winspool, name = HP Designjet 500 42+HPGL2 Card}printer bounds Rectangle {0, 0, 20399, 26398}printer client area Rectangle {0, 0, 20163, 25596}printer dpi Point {600, 600}paper width = 33.998333333333335 inches, paper height = 43.99666666666667 inchesSo I can't seem to make this fail. I've tried different machines, different OS versions, different VMs. Would you be able to try updating your printer driver?Aha! I think I have at least part of the answer.Steve, we are still using PrintDlg. Perhaps we should be using PrintDlgEx (which has an Apply button - that was the clue <g>). PrintDialogEx is only good for Windows 2000 and up, whereas PrintDlg will also work as far back as 95 & NT.My theory is that because we are using the old dialog function call and the old PRINTDLG struct instead of the new PrintDlgEx with its PRINTDLGEX struct, then anything that was Applied by a user in a PrintDialogEx from another application will not be carried into the old dialog.I cannot test this theory until Monday because I cannot compile a new SWT DLL here at home.Steve, a question for you. Shall I keep both dialogs in the code and test OS version? i.e. Does FileDialog still need to work on 95 & NT?Keep both for now. We'll look at it this morning.Arg! No private email discussions!!@#%$@I appreciate the work Carolyn is putting into solving this problem. My diagnostic process went in a different direction that may or may not be useful to you. Here is what I am experiencing.Also, when I distribute this code to other computers, the same problem occurs.As I see it, the problem seems to be correctly accessing the datareturned from Printer.open(). This assumes that Microsoft CreateDCA orCreateDCW do not somehow rearrange the data when the Device handle iscreated. Perhaps the constants in OS.java need to be updated to matchthe current swt*.dll. I do not have a MS compiler so I can not trace this further. Also I don't know what GetDeviceCaps() does internally.from my code:OS.LOGPIXELSX = 88OS.LOGPIXELSY = 90OS.HORZRES = 8OS.VERTRES = 10PrintDialog printDialog = new PrintDialog(Setup.getPps().getShell(), SWT.DIALOG_TRIM | SWT.APPLICATION_MODAL); printDialog.setScope(SWT.SELECTED); PrinterData data = printDialog.open();data.otherData (from debug)[0] 67 [1] 0 [2] 117 [3] 0 [4] 116 [5] 0 [6] 101 [7] 0 [8] 80 [9] 0 [10] 68 [11] 0 [12] 70 [13] 0 [14] 32 [15] 0 [16] 87 [17] 0 [18] 114 [19] 0 [20] 105 [21] 0 [22] 116 [23] 0 [24] 101 [25] 0 [26] 114 [27] 0 [28] 0 [29] 0 [30] 0 [31] 0 [32] 0 [33] 0 [34] 0 [35] 0 [36] 0 [37] 0 [38] 0 [39] 0 [40] 0 [41] 0 [42] 0 [43] 0 [44] 0 [45] 0 [46] 0 [47] 0 [48] 0 [49] 0 [50] 0 [51] 0 [52] 0 [53] 0 [54] 0 [55] 0 [56] 0 [57] 0 [58] 0 [59] 0 [60] 0 [61] 0 [62] 0 [63] 0 [64] 1 [65] 4 [66] 0 [67] 6 [68] -36 [69] 0 [70] 52 [71] 4 [72] 83 [73] -17 [74] -128 [75] 1 [76] 1 [77] 0 [78] 1 [79] 0 [80] -22 [81] 10 [82] 111 [83] 8 [84] 100 [85] 0 [86] 1 [87] 0 [88] 15 [89] 0 [90] 88 [91] 2 [92] 2 [93] 0 [94] 1 [95] 0 [96] 88 [97] 2 [98] 3 [99] 0 Bytes at [90] = (2 * 256) * (88 * 1) = 600 which works for OS.LOGPIXELSYbut does not work for bytes at [88] OS.LOGPIXELSX. However 88 and 2 also occur at [96].It does not make any sense to me that the printer returns (600, 600) for getDPI()and (0, 0, 5100, 6600) for getClientArea() unless data.otherData is rearranged during Device handle creation or GetPrintCaps() does some modification of the index passed in.from Printer: Printer.create copies data into the heap, then passes the heap location into CreateDC (which calls OS.CreateDCA or OS.CreateDCW)/** * Creates the printer handle. * This method is called internally by the instance creation * mechanism of the <code>Device</code> class. * @param deviceData the device data */protected void create(DeviceData deviceData) { data = (PrinterData)deviceData; /* Use the character encoding for the default locale */ TCHAR driver = new TCHAR(0, data.driver, true); TCHAR device = new TCHAR(0, data.name, true); int /*long*/ lpInitData = 0; byte buffer [] = data.otherData; int /*long*/ hHeap = OS.GetProcessHeap(); if (buffer != null && buffer.length != 0) { /* If user setup info from a print dialog was specified, restore the DEVMODE struct. */ lpInitData = OS.HeapAlloc(hHeap, OS.HEAP_ZERO_MEMORY, buffer.length); OS.MoveMemory(lpInitData, buffer, buffer.length); } handle = OS.CreateDC(driver, device, 0, lpInitData); if (lpInitData != 0) OS.HeapFree(hHeap, 0, lpInitData); if (handle == 0) SWT.error(SWT.ERROR_NO_HANDLES);}/** * Returns a rectangle which describes the area of the * receiver which is capable of displaying data. * For a printer, this is the size of the printable area * of a page, in pixels. * * @return the client area * * @exception SWTException <ul> * <li>ERROR_DEVICE_DISPOSED - if the receiver has been disposed</li> * </ul> * * @see #getBounds * @see #computeTrim */public Rectangle getClientArea() { checkDevice(); int width = OS.GetDeviceCaps(handle, OS.HORZRES); int height = OS.GetDeviceCaps(handle, OS.VERTRES); return new Rectangle(0, 0, width, height);}/** * Returns a point whose x coordinate is the horizontal * dots per inch of the printer, and whose y coordinate * is the vertical dots per inch of the printer. * * @return the horizontal and vertical DPI * * @exception SWTException <ul> * <li>ERROR_DEVICE_DISPOSED - if the receiver has been disposed</li> * </ul> */public Point getDPI() { checkDevice(); int dpiX = OS.GetDeviceCaps(handle, OS.LOGPIXELSX); int dpiY = OS.GetDeviceCaps(handle, OS.LOGPIXELSY); return new Point(dpiX, dpiY);}from org.eclipse.swt.internal.win32.OS.java: This shows the values of OS.HORZRES, OS.LOGPIXELSX, OS.LOGPIXELSY, OS.VERTRES as used in Printer.getClientArea() and Printer.getDPI() Also shows the code for OS.CreateDC()public class OS extends C { static { Library.loadLibrary ("swt"); //$NON-NLS-1$ } public static final int HORZRES = 0x8; public static final int LOGPIXELSX = 0x58; public static final int LOGPIXELSY = 0x5a; public static final int VERTRES = 0xa;public static final native int GetDeviceCaps (int /*long*/ hdc, int nIndex);public static final native int /*long*/ CreateDCW (char [] lpszDriver, char [] lpszDevice, int /*long*/ lpszOutput, int /*long*/ lpInitData); public static final native int /*long*/ CreateDCA (byte [] lpszDriver, byte [] lpszDevice, int /*long*/ lpszOutput, int /*long*/ lpInitData); public static final int /*long*/ CreateDC (TCHAR lpszDriver, TCHAR lpszDevice, int /*long*/ lpszOutput, int /*long*/ lpInitData) { if (IsUnicode) { char [] lpszDriver1 = lpszDriver == null ? null : lpszDriver.chars; char [] lpszDevice1 = lpszDevice == null ? null : lpszDevice.chars; return CreateDCW (lpszDriver1, lpszDevice1, lpszOutput, lpInitData); } byte [] lpszDriver1 = lpszDriver == null ? null : lpszDriver.bytes; byte [] lpszDevice1 = lpszDevice == null ? null : lpszDevice.bytes; return CreateDCA (lpszDriver1, lpszDevice1, lpszOutput, lpInitData);}from C:\swt-3.4M6-win32-win32-x86\src\os.c Basically these are just wrappers for the Microsoft function calls#define OS_NATIVE(func) Java_org_eclipse_swt_internal_win32_OS_##func#ifndef NO_CreateDCAJNIEXPORT jint JNICALL OS_NATIVE(CreateDCA) (JNIEnv *env, jclass that, jbyteArray arg0, jbyteArray arg1, jint arg2, jint arg3){ jbyte *lparg0=NULL; jbyte *lparg1=NULL; jint rc = 0; OS_NATIVE_ENTER(env, that, CreateDCA_FUNC); if (arg0) if ((lparg0 = (*env)->GetByteArrayElements(env, arg0, NULL)) == NULL) goto fail; if (arg1) if ((lparg1 = (*env)->GetByteArrayElements(env, arg1, NULL)) == NULL) goto fail; rc = (jint)CreateDCA((LPSTR)lparg0, (LPSTR)lparg1, (LPSTR)arg2, (CONST DEVMODE *)arg3);fail: if (arg1 && lparg1) (*env)->ReleaseByteArrayElements(env, arg1, lparg1, 0); if (arg0 && lparg0) (*env)->ReleaseByteArrayElements(env, arg0, lparg0, 0); OS_NATIVE_EXIT(env, that, CreateDCA_FUNC); return rc;}#endif#ifndef NO_CreateDCWJNIEXPORT jint JNICALL OS_NATIVE(CreateDCW) (JNIEnv *env, jclass that, jcharArray arg0, jcharArray arg1, jint arg2, jint arg3){ jchar *lparg0=NULL; jchar *lparg1=NULL; jint rc = 0; OS_NATIVE_ENTER(env, that, CreateDCW_FUNC); if (arg0) if ((lparg0 = (*env)->GetCharArrayElements(env, arg0, NULL)) == NULL) goto fail; if (arg1) if ((lparg1 = (*env)->GetCharArrayElements(env, arg1, NULL)) == NULL) goto fail; rc = (jint)CreateDCW((LPWSTR)lparg0, (LPWSTR)lparg1, (LPWSTR)arg2, (CONST DEVMODEW *)arg3);fail: if (arg1 && lparg1) (*env)->ReleaseCharArrayElements(env, arg1, lparg1, 0); if (arg0 && lparg0) (*env)->ReleaseCharArrayElements(env, arg0, lparg0, 0); OS_NATIVE_EXIT(env, that, CreateDCW_FUNC); return rc;}#endif#ifndef NO_GetDeviceCapsJNIEXPORT jint JNICALL OS_NATIVE(GetDeviceCaps) (JNIEnv *env, jclass that, jint arg0, jint arg1){ jint rc = 0; OS_NATIVE_ENTER(env, that, GetDeviceCaps_FUNC); rc = (jint)GetDeviceCaps((HDC)arg0, arg1); OS_NATIVE_EXIT(env, that, GetDeviceCaps_FUNC); return rc;}#endifBeyond this point lie Dragons, I mean Microsoft API forCreateDCA() and CreateDCW() I do not know if those functions rearrange the lpInitData (arg3) in some way or ifGetDeviceCaps() manipulates the index (arg1) passed in.I can't reproduce this bug. Whatever the paper size to in the print dialog is what is printed in the console. I did observe a windows bug where I saved a set of non-default print settings. When the print dialog opened, it had selected my non-default settings, but the paper size was still the default. If I switched settings to default, then back to my non-default, I got the correct paper size. This also happened in Wordpad, and Notepad, but interestingly Lotus Notes did not have this bug.This is the complete set of steps I used to "print":1. run code from2. select a printer3. click preferences4. select paper size5. click OK.6. click Print.Is this the same thing you are doing?Also, if I make the HP 500 my default printer, I get the right values right away (ie run the code, click print, and I get my non-default settings printed).Still unable to reproduce. Please reopen if this is still a bug.Keith, if your application will be shipping on Eclipse 3.4, please note that there is a new PrintDialog API available to you: setPrinterData(PrinterData).I do not know for sure if this will help you, but I think it might.What you might want to do is store the PrinterData that is returned from the PrintDialog.open(), and then the next time you open a PrintDialog, call setPrinterData() before calling open(). Give it a try and see if it helps you.I'm not sure if this is even resolvable here or if this requires a new bug report, but here goes.1. When the print dialog comes up, if I right click on the printer, then select Printing Preferences... from the popup menu: a) the page size is not used when printing (see 2. to find the page size that will be used) b) the page size is retained for the next right click->Printing Preferences...2. If I highlight (mouse over) the printer, then click on the Preferences button in the print dialog, a) I get a different page size than the right click scenario above, assuming I tried to set the paper size using a right click. Apparently the settings are retained in two different places b) the page size set is used for printing c) the page size is not retained for the next printingObviously my problem with the paper size I set not being used was due to my use of method 1.This seems to work for any printer.No longer a blocker due to workaround described in.	15.0
id=482152	REOPENED	Platform	UI	4.3	PC Linux	P3 normal	Denis Zygann	2015-11-13 13:59 EST by	Lars Vogel	2016-04-19 08:36 EDT (	4 users	Javadoc says: This method exists for backward compatibility. Subclasses should reimplement <code>init</code>.	New Gerrit change created:As deprecated marked.Gerrit changewas merged to [master].Commit:Thanks Denis.The correct Javadoc tag is @deprecated (just use Content Assist).The description should be a full sentence in sentence case.The @Deprecated annotation is missing.New Gerrit change created:Gerrit changewas merged to [master].Commit:.I think this change is a bad one.Firstly it's important to realize that org.eclipse.ui.part.IPage.setActionBars(IActionBars) is not deprecated and that it states that this method is called shorted after createControl, but the init method is called before createControl, so one cannot in general simply move code from one place to another. I.e., they aren't called at equivalent points in the life cycle. There are a great many generated EMF editors that use these methods and the suggested changes are simply a no-op refactoring that doesn't simplify anything and doesn't simplify the Eclipse framework either. I'd strongly suggest reverting this change. Certainly the Javadoc advice for the deprecation is bad, and the inconsistency with IPage is also bad.(In reply to Ed Merks from)Thanks for bringing this up, Ed.I agree. Reverted withIn order to clean this up one has to investigate how IPage#setActionBars(IActionBars) and IPageBookViewPage#init(IPageSite) work (or don't work) together and clearly specify this in the Javadocs. The next step will then be to deprecate IPage before deprecating any methods.	10.0
id=300174	REOPENED	Platform	User Assistance	3.6	PC Windows XP	P3 normal	Chris Goldthorpe	2010-01-20 07:23 EST by	Krzysztof Kazmierczyk	2012-10-10 16:47 EDT (	10 users	Build Identifier: I20091210-1301Internal web browser has sometimes problem with refresh its content when opennew page. Moreover this problem disappears when you click "refresh" button. Ihave observed such situation when IE8 installed but some people noticed on older versions of IE. Generally caching some content is normal behaviour of IE. When you try to open any site in IE and then open it in new window or tab you will get cached version. But when we are developing web application and want to test it, this action is inexpedient.Reproducible: AlwaysSteps to Reproduce:1. Create new dynamic web project and add index.html file in WebContentdirectory.2. Right click on index.html file. Select "Run as -> Run on Server". You shouldsee html file in your internal browser.3. Modify index.html content. Select "Run as -> Run on Server" again. You getold content of file.	It is similar to bugbut in this bug I do not want to change SWT component but org.eclipse.ui.internal.browser.BrowserVeiwer behaviourPlease keep in mind. Actually, this bug is the exact duplicate of the; I'd recommend to continue work in that bug as it contains some extra information.I think the point of this request is for the Internal Web Browser View to not rely on the native browser's cache. SWT does not currently have api that allows a client to bypass the cache, this is whatis now about. However even without this API, if a client really wanted to not rely on the cache they could do something like the lines below. browser.addProgressListener(new ProgressAdapter() { public void completed(ProgressEvent event) { browser.removeProgressListener(this); browser.refresh(); // <---- } }); browser.setUrl("http://...");I'm not necessarily advocating for this change in the Internal Web Browser View, I'm just clarifying what the request is. I don't think the view should do this by default, but I suppose it could provide a second alternate 'Go...' button, or perhaps a view setting, that would ensure that a page's content is always reloaded for navigations.Generally the problem is heavy in following situation:1. Create new dynamic web project and add index.html file in WebContentdirectory.2. Right click on index.html file. Select "Run as -> Run on Server". You shouldsee html file in your internal browser.3. Modify index.html content. Select "Run as -> Run on Server" again. You getold content of file.The easiest way to solve this problem is to add "Cache-Control: no-cache" header in setUrl() method. It is the best sollution for 3.6.Unfortuantely, method setUrl(url, postData, headers) appears only in SWT 3.6. In previous version the best sollution is method fromCreatedpatch-3.6This patch adds "Cache-Control: no-cache" header in setUrl() method.Adding the "Cache-Control: no-cache" definitely sounds like a better way for a client to accomplish this than. However I still suspect that for the Internal Web Browser View to offer this that it would want to provide a way for the user (or maybe the opener of the view?) to specify whether loaded pages should be cached or not, rather than never caching them.I've been trying to reproduce this problem using slightly different steps but so far have not been able to reproduce it. I modified AboutServlet.java to add a counter to the page which would change every time it was refreshed. I then started the help system and openedin the Web browser view. Every time I hit refresh I got a new page. I have not tried the "run on server route" since I am less familiar with what the server is doing in that case. I am running Win XP with IE8. If I opened that same URL in two different tabs in IE8 I saw the exact same page, i.e. the counter was not incremented.I need to understand why I'm seeing refresh work correctly when you are not - is it because of a difference in where we are getting the page from. I'll attach a patch of the hack I made to the AboutServlet and perhaps you can see if you can reproduce my findings.I think you should be repeatedly invoking setUrl() to the same url, not refresh().CreatedHack to about servet to use as a test caseTo test 1. checkout org.eclipse.help.webapp and apply patch2. Start a new Eclipse Application3. Set the help preferences to open help in an external browser.4. Open the internal web browser view5. Set the url in the view to:<port>/help/about.html, you should see "Call 1" on the top line6. Hit refreshIf you keep seeing Call 1 the page is cached, if it goes to Call 2 it has been read from the server again. For me the counter is increasing every time I hit refresh.Grant wrote: "I think you should be repeatedly invoking setUrl() to the same url, not refresh()."You're right, I need to read the bug report more carefully. Now I can reproduce the problem and it shows up if I open the web browser view, open a url, close the view then reopen it and enter the same url. It also shows if I type in a second url, open that page then reenter the first url and open it. If I just hit the open page button without changing the url it acts like a refresh.I can also confirm that the patch fixes the problem. I think that preventing cacheing is an improvement over the current situation so I approve the fix if Grant is also OK with this approach.My idea to patch to older versions of Eclipse is based on.I am going to add progress listener when browser is IE. Do you have any comments or better ideas than my proposition? I know it does not like very good but I cannot find any better sollution. It solves use case fromwhich I think is most common usage of WebBrowser in Eclipse.If the patch is verified to fix the case then the patch is fine, it shouldn't cause a problem.The only thing that I think is worth considering is whether the view should be changed to always do this. My initial instinct is that it shouldn't, since my typical use of it is just for viewing typical on-line content. If it's more heavily used by apps that do web authoring, etc., then perhaps the change makes sense. I had assumed that such apps provided their own Browsers rather than using the Internal Web Browser view, but I've never actually used such an app to verify this.Anyways, you probably know what's best to do here based on the view's most typical use cases. Bypassing the cache doesn't hurt anyone, it just makes some page loads take longer.re:I think the only alternatives to calling refresh() are:- are you generating the page content being viewed? If so then it could include a tag like: <meta http-equiv="Pragma" content="no-cache"> (google this, there are various opinions about how well this works)- hack your swt to add the setUrl() api that takes the header arg (not generally advised)Createdpatch-3.5This patch refreshes web browser after loading url first time.Createdpatch-3.4Refreshes web browser after loading url first time.Chris, could you review patches to 3.5 and 3.4?I have committed the patch to HEAD so this is fixed for 3.6. I was not planning to make any fixes for 3.4 or 3.5, did you still need feedback on the patches?Resolving as FIXEDI want to make sure I understand the suggested patch for 3.4 and 3.5. I see in the comment:// Feature in IE: IE caches Browser caches web pages and for // the same address display always the same page until not refreshed // SeeShould the word "not" be removed?As for how the patch works is this going to cause every page to be loaded twice? If so that would be a very high price to pay to fix a fail to refresh problem but maybe I am not understanding the patch.Comment onpatch-3.5For 3.5 we will look at a different solution.Comment onpatch-3.4For 3.4 we will look at a different solution.Hello!One quick question.I downloaded an Eclipse Helios JEE build (Build id: 20100917-0705), and I still see that a cached version of a web page is shown in the internal web browser after the first "Run As-> Run On Server" action on a web page. Should the patch proposed disable cache in the internal web browser?.I followed the same "Steps to Reproduce" mentioned in the description of this bug and I still get the cached page as a result of the "Run On Server".ThanksMusaYes, the patch should have fixed the problem for Helios. I'm not sure why you are still seeing the issue. I will need to re test.I was able to reproduce the problem using 3.7 M7. I am reopening this bug, I need to figure out what has changed since this was fixed.Here are some instructions on how to reproduce the bug using only Eclipse. This tests refresh using a counter servlet in org.eclipse.ua.tests which contains a counter which is incremented every call.Check out org.eclipse.ua.tests from head into your workspace or import the bundle from the latest build.Launch a new run time workbenchIn the runtime workbench set the help preferences to open in an external browserHelp/Help contents, note the url of help/index.jspIn the browser where help opened replace index.jsp with counter.html so you have a URL likeOpen a web browser viewPaste the url of counter.html into the web browser viewNote the value of the counterClose the web browser viewOpen the web browser view againPaste the url of counter.html into the web browser viewExpected result, the counter has been incremented.Actual result, the counter has not been implementedHi Grant, can you think of any reason why this would have regressed? I tested in a debugger and the patch which turns off cacheing is being taken.The test steps don't work for me, when I invoke Help > Help Contents a bunch of exceptions are written to stdout like:javax.servlet.ServletException: java.lang.Error: Unresolved compilation problem: |?P_KEY_SHOW_SEARCH_DESCRIPTION cannot be resolved or is not a field| at org.apache.jasper.runtime.PageContextImpl.doHandlePageException(PageContextImpl.java:858) at org.apache.jasper.runtime.PageContextImpl.handlePageException(PageContextImpl.java:791) at org.apache.jsp.advanced.searchToolbar_jsp._jspService(searchToolbar_jsp.java:93) at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:97)I don't know why this would have stopped working. What are the arguments to the setUrl() call? Perhaps I can find a more basic case tomorrow with similar arguments.(In reply to)Of course by "this" I meant the caching behaviour, not the exceptions I see.I have no explanation for the exception you saw, I just tried in a clean workspace with the help plug projects checked out into my workspace and help opened fine for me. As for the cacheing problem it's possible that it was IE8 that changed, the problem is also present in Eclipse 3.6 and Eclipse 3.6.2.Removing milestone - it does not look as though this is going to get fixed for Eclipse 3.7.CreatedPatch for 3.7Hi all,This is a patch for 3.7.Explanation:-------------I did some debugging and found out that the proposed patchworks for all IE browsers but not IE 8.Also I found out that the behavior in IE 8 is different. I could't find the root cause for this, as I'm not expert neither in IE 8 nor it's implementation in the Eclipse.Nevertheless I found interesting behavior related to a workaround that is being applied in the org/eclipse/swt/browser/IE.javaThe workaround itself works around IE bugand works as follows: When a web resources is being requested and is about to be opened in the internal browser (IE), first the Eclipse makes a request to "about:blank" and then it makesthe real request to the original resource.The proposed patch makes applying of this workaround conditionally.Till now, the workaround was applied unconditionally for all IE browsers. As this workaround has a side effect (makes bugto reappear), now it is applied only for IE version < 8. The fix works together with patchI tested it with IE 8, IE 7 (border cases) and it works.Could you please review this patch.Thanks for investigating this Vladislav! I'm running with IE9 installed, and I've verified that IE.java's current workaround foris still needed there (MS has not fixed their bug yet) and it is working. Sobasically trades one buggy behaviour for another on IE versions >= 8, which I don't think is desirable.Your findings bring a couple of potential app-level workarounds to mind though. I know that workarounds are not ideal, but mentioning these could be useful in case a resolution for this is not found for 3.8:- If the problem only happens on the initial navigate then a ProgressListener can be added that invokes Browser.refresh() when ProgressListener.completed() is received (first navigate only).- If the problem you're seeing only happens with IE versions >= 8 then you can run in IE 7 emulation mode by setting a Java property as described in(point #2).Just for the record, this issue has regression only for IE 8.	34.0
id=94491	REOPENED	JDT	UI	3.1	Macintosh Mac OS X - Carbon (unsup.)	P3 normal	David Saff	2005-05-10 15:42 EDT by	Kim Horne	2005-06-21 11:29 EDT (	0 users	I20050509-2010I began running a JUnit plugin suite. I switched to console. After about 8/300+ tests had finished I hit the Stop button in the console. The run stopped, but the Junit tab still shows in the Italic font, as if it thinks it's still running. If I hit the Stop button in JUnit then the tab returns to normal.	I couldn't reproduce on Windows, build N20050526-0010. Is it reproduceable for you?Yes, I can reproduce this consistantly. If I stop the Junit tests by any means other than the JUnit stop button then the tab will remain in an italic font.I'll look at this again in 3.2	3.0
id=490353	REOPENED	Platform	UI	4.4	PC Linux	P3 enhancement	David Weiser	2016-03-24 04:38 EDT by	Lars Vogel	2017-01-16 12:44 EST (	7 users	Several users report bad performance if to many editors are opened. We should warn the user if he opens the first time more than 99 editors and explain to him that this might cause performance issues. We could also point tot the preference page for auto-closing editors once a certain threshold is reached.	Stefan, can you take this one?Can you list those bugs here, please.It would be good to make the trigger dynamic. "99" might work for normal textual editors on normal files. If editors are opened on very big files or more complex editors, like PDE editors, are opened, then 99 might already be too high.It might be too high to prevent performance or memory issues, yes... but I don't think that's the point of the prompt. The point of the prompt is to teach users what they should do about it if they find the performance unacceptable without annoying users who are already in the habit of closing their unused tabs regularly.At least in my case, I generally resolved the user issues by telling them "close all those editors". I never filed a bug against Eclipse since I considered the large number of open editors itself to be the problem. Now that we're enabling the auto-close preference within Google, I'm unlikely to see such reports again.However, I'll run some of my own tests the next chance I get and will file some bugs about whatever I find.Mass move to 4.6 RC1. We might push out more to 4.7.I suggest to activate "Close editors automatically" and set the limit to 99. This way we prevent users from running Eclipse with a super large number of open editors in the default configuration.I know this was discussed before but IMHO the limit of 99 should be sufficient to affect normal users.Mass move to M4.(In reply to Lars Vogel from)Dani, any objections against this? I think this will help to keep the Eclipse IDE responsive by default, even if the user never look at the number of open editors.I plan to commit this early M5, unless I hear concerns from Dani or others.David, please provide a Gerrit review for this change.New Gerrit change created:Gerrit changewas merged to [master].Commit:(In reply to Lars Vogel from)The N&N must tell people who enabled that preference and did not change the default, will now no longer get the editors closed after 8 open editors. It will take them 99 editors.This change made editor pinning more prominent/necessary, so it should raise your priority for fixing pinning-related bugs like,,,.(In reply to Markus Keller from)David, Lars, can you fix those for M5? Otherwise I tend to revert your change.(In reply to Dani Megert from)I don't see the connection to the pinned editor issues so I do not see why they should depend on each other.(In reply to Lars Vogel from)Because enabling to close editors automatically enables the pin functionality.New Gerrit change created:Gerrit changewas merged to [master].Commit:(In reply to Eclipse Genie from)This reverts the change. Since pinning was enabled out of the box, the bugs mentioned inbecome prominent. Those need to be fixed before fixing this bug here.	19.0
id=441264	REOPENED	Platform	IDE	4.5	All All	P3 enhancement	Daniel Rolka	2014-08-06 11:40 EDT by	Daniel Rolka	2014-10-23 04:00 EDT (	14 users	The main goal of the solution is to promote the development of the release. When someone during the milestone comes up with the idea about some new, interesting feature for Eclipse then they can provide proper entry to the proposed WIKI. The N&N however can have some "new feature proposal available" icon and proper link to the WIKI. The feature has to be provided in the installable form from the external site, i.e. Eclipse Market or Git Hub. When feature is stable enough and accepted by the users it can be merged to the master Git repository. Additionally the WIKI page and indirectly the N&N one can contain the link to the Bugzilla or blog where the new feature get deeply discussed. When we agree to go with it we have to figure out the way of filtering the craps that can be published from time to time. However I think, we can postpone it till a first crap What can we achieve by this solution?* incoming release can be earlier announced by the blog entries dedicated to the new features and it can encourage the new people from the Community for helping with the development of the new release as well as the users for switching to Eclipse as the primary IDE or RCP platform* new interesting architectural/design changes can be proposed with the features. It will be real prove of concept and not only "raw" idea sent via e-mail* some really strong Eclipse developers/consultants can find the idea interesting and help with development of the new release* during implementation of the new feature you have to quite often fix some defects that block the feature or get exposed by it, what indirectly improves the quality of Eclipse* current solution - announcing the new ideas by mailing list - is not sufficient in my opinion. Some ideas finish with several discussion e-mails. Even when something get implemented it can be forgotten in the moment. Having the persisted list with the feature proposals on WIKI that is connected to N&N page, better visible than the mailing list archive, seems to be better solution in my opinionPlease let me know what do you think about the proposal,Daniel	I think that having a switch in Eclipse SDK to see beta features would be nice. It could be either a cli param or better a setting in Eclipse SDK. In the same time we should not pollute the master code with beta features.I think we could solve the issues on the releng level. If there is a beta feature in some bundle, the Eclipse SDK would contain two versions of it. The stable one and the beta one. Stable bundles would be built from master and beta bundles from another dedicated branch.The beta switch would switch the set of bundles running withing Eclipse SDK.(In reply to Szymon Brandys from)You got it wrong. There won't be any beta code in the repo. The code must be outside Eclipse, e.g. in the Market Place. The new thing is that this can be advertised in the N&N via a new wiki.(In reply to Dani Megert from)I understand the Daniel's idea. What I suggested is a completely new thing.I am suggesting to add one switch to enter 'beta' mode. IMO It would be easier for people to just switch to use 'beta' features and see them all instead of installing them one by one from Market or somewhere. The 'beta' mode could be also used for suggesting new defaults in settings. Then we could gather feedback from users about the changes what can help to decide what should be introduced and what should not.I can imagine that when you enter regular Eclipse, you get a prompt asking if you want to test 'beta' features. It could be a fancy prompt showing what is new. If one decides to switch, he could get a prompt after some time asking for feedback and offering an option to switch back etc. The option to switch between modes should be also easily available somewhere in Eclipse.This is something used across desktop and web solutions already and IMO it works quite well there.(In reply to Szymon Brandys from)Let's keep this bug focused on the original idea. Our milestones must be stable and not contain beta stuff.(In reply to Szymon Brandys from)For me the idea is also very interesting, but for now the original solution seems to be more suitable, I think. The huge benefit that I see with the new approach is a possibility of "safe" refactoring of the source code. For instance we can switch the IDE for using the new E4 progress view and ask the users whether it is fine for them basing on their feedback.I think we can consider it as the 2nd step after applying the original ideaDanielDanielCan we define any rules for this bug saying when it can be closed? Do we need approvals from everybody on the CC list or we can just wait 1 - 2 weeks for the comments and when there is no "-1" comment then we can go with the solution?thanks,Daniel(In reply to Daniel Rolka from)We usually wait for a week. Next week's meeting is a good time for the final go / no go.We will try this in M2. Daniel, please kick it off.I've reopened the bug since I want to attach the link to the new WIKI when it is readyDaniel	9.0
id=118030	REOPENED	JDT	Core	3.2	PC All	P3 enhancement	David Audel	2005-11-25 06:11 EST by	Tobias Widmer	2007-06-22 11:04 EDT (	1 user	I20051123-1200Steps to reproduce:- Open some file in LTK UI which has no import on 'Assert'- Type "Assert<Ctrl+Space>- Proposals for Assert seem to be sorted alphabetically by package name and are ranked highest-> The proposal for o.e.l.i.u.r.Assert is not ranked first-> A common prefix match of the proposed type's packages and the package of the cu being edited would help create a better ranking	Cannot be reproduced using 3.3RC4.The bug is still there (see attached picture). In addition to previous comments it seems also strange that the deprecated Assert classes aren't below all other non-deprecated Assert classes.NOTE: maybe you could not reproduce with the given steps because you tried it on latest code base where the org.eclipse.ltk.internal.ui.refactoring.Assert has been removed. In order to reproduce use Team > Restore from Repository... to bring it back and then go to RejectRefactoringsAction. There remove the import of the Assert and then do code assist where Assert is used in the code.CreatedPicture of proposal popupI had not understood the bug.The request is to take into account the current package to compute relevance when a type inside a subpackage is proposed.package a;public class Foo {}package b;public class Foo {}package b.c;public class Test { Foo| // do code assist at |}With this test case, the request is to propose b.Foo first.What about the deprecated ones?Currently deprecated proposals can be filtered. But when deprecated proposals aren't filtered they have the same relevance than other proposals.We have the same behavior for visibility, discouraged references and forbidden references.	6.0
id=272662	REOPENED	e4	Languages	unspecified	PC Windows Vista	P3 enhancement	Project Inbox	2009-04-17 05:27 EDT by	Miroslav Nachev	2010-06-17 16:12 EDT (	0 users	My idea is to have one universal RCP client which to be common for all applications with the following requirements:1. Eclipse RCP based2. Java Web Start (JNLP) based on Java EE Application Client specification:3. Specialized Servlet which to handle the whole start-up mechanism: preparing and signing the JARs according the requirements of Java EE Application Client specification.4. The communication between the Server and the Client to be based on Distributed OSGi (RFC-119). In this case the client will use all services (local and remote) as local and the communications and the used protocols (RMI, CORBA, JMS, WS, SOAP, etc.) will be hidden for the bundles.5. Single Sign On mechanism. If the user is entered into the application from the Web and then starts the application there will not need to login again.6. Integrated bundles for authentication which to support all populate specifications like username/password, certificate, etc.7. Integrated bundles for user registration with customization options8. Different certificate whit which to be signed the user bundles and the Distributed JWS Eclipse RCP Client. This option is good because the all common functionality can be signed with one certificate and all user specific application bundles will be signed with another certificate. Now in one JWS Application Client all JARs MUST be signed with one certificate. In case that this client will be universal and will be used from many and different project/applications, their bundles should be signed whit vendor specific certificate while the client will be signed with one unique certificate.9. All bundles will be stored in the local computer using OSGi Bundle Repository (OBR) specification.SignaturesRules	Anybody plan to work on this? Please reopen if so.Yes, this is very good feature.	2.0
id=396902	REOPENED	e4	Tools	unspecified	PC Windows 7	P3 normal	Project Inbox	2012-12-19 05:19 EST by	Wim Jongman	2014-07-03 07:10 EDT (	5 users	Open the model editor.Go to the XMI tabChange somethinggo to the model tree tabThe tree is collapsed. Somehow calling IModelResource.replaceRoot() causes the tree to collapse.	This is ugly. Wim, have you done more research on this? Any plan to tackle it?(In reply to)Yes it is. I have a headache examining why this happens. It is related to reloading the EMF model in combination with EMF databinding and it is in the same corner that causes the WidgetDisposed exception when I switch to the filtered tree, The (filtered) tree works fine as long as you stay out of manually updating the XMI.There is hardly any javadoc in this area. The XMI editor is broken on more places. for example, you cannot do undo/redo correctly, there is no way to search something. Etcetera. I would propose disabling the disabling the XMI editor for editing. If people want to edit the XMI directly then open the model with a real aditor.***has been marked as a duplicate of this bug. ***the collapse happens because there's not IElementComparer set on the viewer so when the model is reloaded the viewer is not able to find the elements because it simply uses the equals method.You should simple set a IElementComparer on the viewer which uses the XMI-ID from the model as the equal criteria.The XMI-Editor is really a very dumb Source-Viewer.(In reply to)Thanks, I will take a look at that.After wrestling with this all morning, a simple solution came: Subscribe to the document that the XMI tab updates and cache xmi-ids before the document update, and then find objects and restore expanded and selected after the update.Thanks, submitted withThis is still an issue when multiple editors are opened. I am going to refactor the Tree Tab into it's own class, and then revisit this issue.	8.0
id=31305	REOPENED	Platform	SWT	2.1	PC Windows XP	P3 normal	Duong Nguyen	2003-02-07 10:09 EST by	Pascal Rapicault	2011-11-07 17:03 EST (	14 users	Create a new feature using the wizard.Open the feature.xml, go into the information tab and you will noticethat the default value of the "section" field is truncated.	Moving to SWT for comment - this is an old problem related to CCombo that refuses to go away. Here is the scenario:1) Create a new Feature project. Use any name and accept all the defaults.2) When the feature manifest editor opens, go to the 'Information' page. Notice now the text in the read-only combo is truncated at the beginning.The actual implementation for this section is in the following class:org.eclipse.pde.internal.ui.editor.feature.InfoSectionThe CCombo control is created in 'createContents' and the itemsare set in 'initializeSectionCombo'.***has been marked as a duplicate of this bug. ***Opened a wsa.prereq.workbench defect# 258934 for this problem. Basically thestarting characters are chopped off when selecting an entry. It has been myobservation that the problem happens only when the selection of an entry happensafter the shell has been opened and the layout has been performed. If theselection has been done before the layout, then everything works fine.***has been marked as a duplicate of this bug. ***I cannot recreate the problem using the steps that Dejan has given. The 'Information' page has changed and no longer contains a CCombo.Grant, running the code from(a duplicate) does not show the problem for me in Eclipse 3.3 M6. I am on XP, does the problem happen for you on Windows 2000?I'll test it out on my W2K machine.CreatedSnapshot of CCombo testThe problem appears to happen for W2K only.Sri, I will look into the problem on Windows 2000. Meanwhile, can you confirm that "wsa.prereq.workbench defect# 258934" works on XP but fails on 2000?Here is what is happening: When CCombo calls selectAll() on the text control inside, the i-beam is placed at the end of the text. Windows scrolls to show the i-beam and when the text control is small, it scrolls to the left. Then, the CCombo is resized to be bigger (such that the scrolled text could be shown without scrolling) and the text is not scrolled because text does not scroll on resize.I have no idea how to fix this so CANTFIX for 3.3. I'm waiting for a brainwave.Any plans to fix this in 3.4?If there is no plan to fix this, why is it still open?Reading thisThe problem only happens on Windows 2000. We WONTFIX this.This problem reproduces on Windows XP as well, when the the theme is "Windows Classic" - most people I know use it, though they are all technicians and probably prefer its simpler look...There is a quite good workaround: CCombo combo = new CCombo(outer, SWT.READ_ONLY | SWT.BORDER) { @Override public void select(int index) { super.select(index); setSelection(new Point(0, 0)); } }; combo.addSelectionListener(new SelectionAdapter() { @Override public void widgetSelected(SelectionEvent e) { combo.setSelection(new Point(0, 0)); } }); combo.addFocusListener(new FocusAdapter() { @Override public void focusLost(FocusEvent e) { combo.setSelection(new Point(0, 0)); } });But first you have to remove the "final" keyword from CCombo.java and compile SWT for yourself (see, Fixed > 080714).ViliamIf SWT officially supports XP running the Classic theme, shouldn't this bug be re-opened?I was able to replicate the problem with Windowx XP using the Classic theme.This is open for more than 2,5 years and not yet solved??? I am still running into that ugly bug on WinXP with Eclipse 3.4 and since subclassing is not allowed I cannot fix it without recompiling all SWT.Can someone please fix it or give a solution to it?Additional note. The described fix above works only when also overriding checkSubclass():CCombo rc = new CCombo(parent, SWT.FLAT) { @Override public void select(int index) { super.select(index); setSelection(new Point(0, 0)); } protected void checkSubclass () {}};However, it is nasty to use this workaround :(Seeing this issue on Windows 7 running Indigo and this worked for us: _combo.getShell().getDisplay().asyncExec(new Runnable(){@Overridepublic void run(){_combo.setSelection(new Point(0, 0));int len = _combo.getItem(ii).length();_combo.setSelection(new Point(len, len));}});Seeing this issue on Windows 7 running Indigo and this worked for us: _combo.getShell().getDisplay().asyncExec(new Runnable(){@Overridepublic void run(){_combo.setSelection(new Point(0, 0));int len = _combo.getItem(ii).length();_combo.setSelection(new Point(len, len));}});	21.0
id=283075	REOPENED	e4	UI	0.9	PC Windows XP	P3 normal	Project Inbox	2009-07-09 16:07 EDT by	Kevin McGuire	2010-06-18 10:45 EDT (	1 user	Need to look at how we compute where to draw the horizontal line for when there are no tabs, it should be in the same spot as it would if tabs were there.	CreatedETabFolder line patch v1This patch moves the line down if the webby style is used.The code is extracted from CTabFolder's updateTabHeight(boolean) and ETabItem's preferredHeight(GC) methods.Thanks for patch, let's put it in next week.Note: patch will no longer apply but looks easy to update.In ETab* I've been ignoring CTabItem.TOP_MARGIN and CTabItem.BOTTOM_MARGIN because they're constants, replaced by the fields tabTopMargin and tabBottomMargin.If I remove those then things line up. In any case, the field tabHeight is supposed to represent the correct tab height, ie. including all the margins.The problem is that we inherit updateTabHeight() wherein it should be doing the correct calc for the no tab case.I've released the following changes:- overriding updateTabHeight() for case of webby and no tabs- setWebbyStyle() was completely on crackfixedStrange, I run with increased DPI and get the right tab heights. If however I go to normal DPI, I get the empty folder bar in the wrong spot again. Need to investigate further in RC2Kevin doesn't work on e4 anymore.	6.0
id=308519	REOPENED	e4	UI	1.0	PC Linux	P3 normal	Project Inbox	2010-04-08 12:49 EDT by	Benjamin Muskalla	2014-12-26 13:44 EST (	5 users	The IRendererFactory interface used for alternative renderes currently resides in the org.eclipse.e4.ui.workbench.swt bundle. This means that every other rendered would need a dependency to the SWT rendered in order to implement the required interface. I suggest to move the interface to "org.eclipse.e4.workbench.ui" to resides besides the extension point.	I don't think it belongs to workbench.ui because it is tightly coupled with how the PartRenderingEngine in workbench.swt. workbench.ui only knows about the IPresentationEngine not more not less.Are you saying that it should not be possible to implement an alternative render factory, e.g. workbench.qt? If it is, then workbench.qt should not need to depend on workbench.swt, right?I think if you want to implement another UI-Technology you should implement a new PresentationEngine because it is very likely that you need to e.g. customize event loop spinning, ...The IRendererFactory is a concept that is used in the concrete PresentationEngine implementation found in "org.eclipse.e4.ui.workbench.swt" you can write your own PresentationEngine which has a completely logic to render the workbenchReplaced with a DI oriented version...I'm not sure this is 100% true because the IRendererFactory is still there and in theory it has no dependency on SWT. The interface and the AbstractRenderer and NOT enforcing SWT though as outline in my comment the concept is one implemented in PartRenderingEngine which naturally has a dependency on SWT.The main question is wheter we could factor out generic code into a SWT-Neutral RenderingEngine class and move RenderingEngine, AbstractRenderer and IRendererFactory in an extra bundle.I don't think this will happen 4.0 but I would not close of the bug because probably we can refactor it in 4.1.I think this one can be closed - efxclipse has shown that implementing a completely new ui with javafx works!	6.0
id=14369	REOPENED	e4	UI	unspecified	All All	P3 enhancement	Project Inbox	2002-04-22 18:13 EDT by	Simon Archer	2013-01-22 08:28 EST (	5 users	It's still too easy to accidentally move a view.A preference to lock/unlock all views to prevent/allow them from being moved or undocked accidentally would be useful. It should be possible to override locked view by a keyboard shortcut, such as holding down the ALT key whilst moving the view.View locks should probably not affect resizing of views.	Defer for consideration in v3.Reopen to investigateThere are currently no plans to work on this featurethis is a major issue with eclipse.one of the main drawbacks compared to other IDEs, mainly intelliJ.it is really counter productive to accidentally drag-and-drop a view and then waste my time restoring my layout, especially when a bunch of views are moved at once.the request is:1) an option lock the views - can't be moved using drag & drop, but can be minimized/restored2) an option to undo view movement (using Ctrl-Z, or Windows -> Undo Move View, or whatever you see fit)We are re-working the perspectives with an EMF model in e4 and can probably look at this enhancement there.We would accept patches for 3.7 but won't actively look at this in that stream.PWRemark E4: The DnDAddon defines the "NoMove" tag for a part in PartDragAgent. If it is set, drag and drop is defered.	6.0
id=311064	REOPENED	e4	UI	unspecified	PC Windows 7	P3 minor	Project Inbox	2010-04-29 12:52 EDT by	Sebastian Schneider	2010-07-09 09:27 EDT (	2 users	Build Identifier: I20100428-2215With to perspectives I encounter the following issue:1. Having two perspectives perspective1 and perspective2perspective1 having a sash with tag sash1perspective2 having a sash with tag sash22. Opening view via EPartService in current perspective works fine3. Now switching from perspective1 to perspective2 via EModelService (as performed in e4 photo demo SwitchPerspectiveHandler) works out quite well.4.Now opening a new Part via EPartService using showPart(MPart) with specified category shash2 seems to buggy. While debugging the code I found out, that field rootContainer of PartServiceImpl doesn't get updated when step 3 is performed, thus the specified target container sash2 cannot be found and thus the new part is created in a new viewcontainer in perspective1.Cannot think of a workaround for that.Reproducible: AlwaysSteps to Reproduce:see in details	Hi,I worked around the issue, by finding the stack myself using the App for searchRoot and showing it like:MPart part = partService.createPart(ELEMENT_ID);MPartStack stack = (MPartStack) modelService.find(TARGET_STACK, theApp); stack.getChildren().add(part);// now the workaround for the part getting rendered and activatedstack.setSelectedElement(part);Can anyone think of a case with non-unique <tag>'s in application model?SebastianI've noticed the same thing. It appears that PART_SERVICE_ROOT isn't being properly updated for perspective-changes, with the consequence that PartServiceImpl#isIInContainer() returns false, and bringToTop() never does anything.In the function for updating PART_SERVICE_ROOT, the MPerspective pulled from the current context at line 289 of E4Application: Object object = current.get(MPerspective.class.getName()); is actually the wrong perspective. In my testing, where I have 6 perspectives and had performed a perspective switch prior (from A -> B, and now trying B -> C), the perspective reported is actually A, and not B.CreatedForce a context 'ACTIVE_CHILD' change on a perspective switchSince this is in the rendering code it's now *enforced* that all perspective changes will result in a context 'activation'.Committed in >20100511. Applied the patch.Note that this means that any old code that was performing the context switching itself (i.e. WorkbenchPage#setPerspective) should likely remove that code (even though a code inspection indicates that the context implementation will treat this as a NO-OP).Brian, I'm going to mark this as fixed. If it's still not working correctly in your scenarios feel free to re-open...Since a few I-Builds the automatic update for rootContainer in PartServiceImpl seems to be broken, when switching perspectives as done in e4 photo demo until now (SwitchPerspectiveHandler 1.7).Currently work around is direct update on eclipse context for rootContainer likeeclipseContext.modify(EPartService.PART_SERVICE_ROOT, newRootContainer);So the issue seems to be broken again.Can anyone confirm?Remy, I know we used to have issues here...do you know if they are still there? I seem to remember adding some code is the LSR to handle this but we've lost the history for the class...Is this still a problem? The EPS and the renderers have changed quite a bit.	7.0
id=335768	REOPENED	e4	UI	1.0	PC Mac OS X - Carbon (unsup.)	P3 normal	Project Inbox	2011-01-29 10:38 EST by	Thomas Schindl	2013-06-05 10:57 EDT (	2 users	UILabel now has getLocalizedLabel and getLocalizedTooltip the same must be available for accessibilityPhrase	I am not at all sure what's the purpose of the accessibilityPhrase.Eric, is it used anywhere?I think the renderers are going to use this (currently they don't) to implement an IAccessabilityListener. I'm adding Eric to the CC-List ;-)Yes, the accessibility phrase is a locale oriented string and should be handled accordingly (it's the string passed into the screen reader for visually impaired users).thanks eric for the confirmation - I've released the change to HEAD >= 20110208(In reply to)1) How do you plan to pass it to a screen reader? As far as I know there is noeasy way other than exotic hidden widgets or custom implementation ofaccessible interfaces (which you don't want to do :-)).2) Even if you manage to do (1) you'll have the "old" way for everything insideparts and the "new" way for the workbench itself.(In reply to)This sounded a bit too strong. The easiest way to implement this is to provide accessible listener override with #getName() returning this new field.That, however, a) will require anybody who actually *needs* to override that accessibility listener to skip our code, and b) will prevent normal SWT accessibility code from working. Both of those are bad.It is possible to supply extra information via IAccessible2 interfaces, but so far it is only used to tie two widgets together. Plus, in practical terms, the support for IA2 is limited at the moment, so this can only be considered as supplemental solution, sort of an extra info is screen reader supports IA2.I'd recommend removing those fields until there is an actual implementation connecting them to a screen reader is available. As it is, it will only clutter the model and cause confusion as clients will expect those fields to do something.Removing outdated target milestone.	7.0
id=117568	REOPENED	Platform	Doc	3.2	All All	P3 normal	Kim Horne	2005-11-22 14:57 EST by	Kim Horne	2006-05-31 16:44 EDT (	0 users	There is some confusion as to how these components are related. A document or article explaining this would be very helpful.	SeeVerified.could the article be "beefed up" with the following and moved to the Eclipse UI team page and submitted as an eclipse article?My comments- needs appendix with code samples or pointers to ext. pts. etc..- needs pictures <g>- needs an additional chapter showing how a product should (best practice) weave these things together coherantlyClearing past milestone.	4.0
id=131988	REOPENED	Platform	SWT	3.2	PC Windows XP	P3 normal	Felipe Heidrich	2006-03-15 12:25 EST by	Dani Megert	2013-10-06 06:42 EDT (	1 user	I2006030314-0800TextLayout.setStyle(TextStyle, int, int) is not working with StyleRange which is a public subclass of TextStyle. I could not find anything in the Javadoc which says it's not OK to use StyleRange here. However, when I use a StyleRange with some fontStyle it is simply ignored.	That is right. TextLayout takes TextStyle, and TextStyle don't have fontStyle.You can pass StyleRanges to TextLayout, it works fine. But StyleRange.start, StyleRange.length and StyleRange.fontStyle are not used (ignored).See StyledTextRenderer#getStyleRange() StyledTextRenderer#getFont() This that the only problem ? (fontStyle being ignored?)Mmh - from an OO standpoint the current behavior is OK. I guess you can close this as a user error: I was used to use StyleRange and simply continued to use it when I had to do some computations using TextLayout and was then surprised that this thing didn't get bold even though I've set the fontStyle.Feel free to close.closing.I'm reopening this either to reconsider ignoring the fontStyle or to make it very clear in the Javadoc. Seewhere another user tried to set the fontStyle on StyleRange and then legitimately expects to see it applied.seems to be a duplicate of this bug (colors are fine; fontStyle works with a LineStyleListener but not with a StyledCellLabelProvider).Besides, I second the previous commenters opinion: a user legitimately expects to se fontStyle applied.Is there a workaround (e.g. by overwriting some methods in StyledCellLabelProvider)?Workaround: Set a new font (with the appropriate style) instead of using fontStyle.	6.0
id=207135	REOPENED	Platform	SWT	3.2.2	PC Windows XP	P3 normal	Felipe Heidrich	2007-10-23 05:18 EDT by	Arnaud	2008-03-11 18:18 EDT (	1 user	Build ID: M20070212-1330Steps To Reproduce:Uses the snippet provided in More Information area (see below).Launch the snippet.When focus control is on one of check button, push button or text on the right the MouseWheel events doesn't works.Events seems to be consumed by the ScrolledComposite parent's of those widget even if this composite have no scrollbar.In that case MouseWheel events, as thay produce no action, should be passed to ScrolledComposite parent's.In this snippet this will scrolls the outer ScrolledComposite which display the vertical scrollbar on the right.Please note, when focus is on the List (on the left), MouseWheel scrolls the list as expected. When the focus in on Add or Remove button (on the center),MouseWheel events scrolls then outer Scrolledcomposite as expected.Note also that many browser passe MouseWheel events to parent's composite when the scrollbar is at min or max location (the case for IE).More information:import org.eclipse.swt.SWT;import org.eclipse.swt.custom.ScrolledComposite;import org.eclipse.swt.graphics.Point;import org.eclipse.swt.layout.GridData;import org.eclipse.swt.layout.GridLayout;import org.eclipse.swt.widgets.*;public class TestMouseWheel2 { public static void main(String[]args) { final Display display = new Display(); final Shell shell = new Shell(display); shell.setLayout( new GridLayout() ); shell.setText("MouseWheel test"); ScrolledComposite sc = new ScrolledComposite( shell, SWT.H_SCROLL|SWT.V_SCROLL ); sc.setLayout( new GridLayout() ); sc.setLayoutData( new GridData( GridData.FILL_BOTH|GridData.GRAB_HORIZONTAL|GridData.GRAB_VERTICAL )); Composite cn0 = new Composite( sc, SWT.NONE ); sc.setContent( cn0 ); cn0.setLayout( new GridLayout() ); cn0.setLayoutData( new GridData(GridData.FILL_BOTH)); Composite cn = new Composite( cn0, SWT.NONE ); cn.setLayout( new GridLayout(3,false) ); List list = new List( cn, SWT.H_SCROLL|SWT.V_SCROLL ); list.setItems( new String[]{"Value 1","Value........ 2","Value ...........ooOOOO|OOOOoo...... 3"} ); GridData gd = new GridData(GridData.GRAB_VERTICAL|GridData.FILL_VERTICAL); gd.widthHint = 75 ; list.setLayoutData( gd ); Composite cb = new Composite( cn, SWT.NONE ); cb.setLayout( new GridLayout() ); (new Button(cb,SWT.PUSH)).setText("Add"); (new Button(cb,SWT.PUSH)).setText("Remove"); cb.setLayoutData( new GridData(GridData.VERTICAL_ALIGN_BEGINNING)); ScrolledComposite sc2 = new ScrolledComposite( cn, SWT.H_SCROLL );//|SWT.V_SCROLL ); sc2.setLayout( new GridLayout() ); sc2.setLayoutData( new GridData( GridData.FILL_BOTH|GridData.GRAB_HORIZONTAL )); Composite cn2 = new Composite( sc2, SWT.NONE ); sc2.setContent( cn2 ); cn2.setLayout( new GridLayout()); cn2.setLayoutData( new GridData( GridData.FILL_BOTH|GridData.GRAB_HORIZONTAL)); (new Button(cn2,SWT.CHECK)).setText("Here is a pretty check button"); (new Button(cn2,SWT.PUSH)).setText("There a pushable button vefry smart"); Text txt = new Text(cn2,SWT.SINGLE|SWT.BORDER); txt.setText("Now a little text."); txt.setLayoutData( new GridData(GridData.FILL_HORIZONTAL)); sc2.setExpandHorizontal(true); sc2.setExpandVertical(false); Point size = cn2.computeSize(SWT.DEFAULT, SWT.DEFAULT); cn2.setSize( size ); sc2.setMinSize( size ); size.x = size.x-30; //allow h_scroll of 2nd Scrolledcomposite to appear when resizing down shell. gd = new GridData( GridData.FILL_BOTH ); gd.widthHint = 300 ; cn.setLayoutData( gd ); sc.setExpandHorizontal(true); sc.setExpandVertical(false); size = cn0.computeSize(SWT.DEFAULT, SWT.DEFAULT); cn0.setSize( size ); sc.setMinSize( size ); shell.setSize(450, 150); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } display.dispose(); }}	I'm pretty sure this is not what the platform does. FH to confirm and then close this bug as WONTFIX (if he agrees).mouse wheel events do go up the hierarchy as you said.In your test case, the ScrollComposite named sc2 has a scrollbar bar (enabled, not visible). This scrollbar is first scrollbar in the hierarchy and it is the one consuming the events.The fix your app you need to subclass ScrolledComposite and override layout(Composite, boolean) to disable the scrollbars when they hostBounds is greater than contentBounds.ScrolledComposite's layout choose to set scrollbar visible or not depending on its content's size versus its client area. I don't understand why at this time ScrolledComposite won't fix the scrollbar enablement too.Why all ScrolledComposite users must subclass it to fix scrollbar enablement when this can be done once by swt.custom code ?Steve, does it make sense to send selection events to a not visible scrollbar ?We can change this in ScrollComposite or in Scrollable.(In reply to)Just to be clear, these selection events are generate by the mouse wheel.	5.0
id=206740	REOPENED	Platform	SWT	3.3.1	PC Linux-GTK	P3 minor	Felipe Heidrich	2007-10-18 07:32 EDT by	Mike Whittaker	2016-10-26 11:13 EDT (	9 users	Build ID: M20070921-1145Steps To Reproduce:1. Create source file containing several source lines2. Font used for editor is Lucida Typewriter Sans 93. Save file, note interline spacing is normal4. now add (e.g.) text taken from <linux-kernel>/drivers/i2c/algos/i2c-algo-bit.c- comment including text /* With some changes from ... */(includes byte sequence: hex: 4B 79 EF BF BD 73 74 69 - 'Ky?sti'5. Save, observe line spacing increasesMore information:Bug is directly related to inclusion/deletion of multibyte character(s).May be more general Eclipse problem ?	I don't see the increase in the line spacing, but anyway, this is certainly not a CDT specific issue.CreatedImage from editor window, normal line spacingShows part of the editor window when line spacing is unaffected by the reported bug.CreatedImage from editor window, affected line spacingImage from editor window which is affected by the reported bug.Which encoding do you use?With UTF-8, I see o-umlaut and a-umlaut:/* With some changes from Kyösti Mälkki <> */Did you try different fonts?I have not changed the default encodings:General/Editors/Text Editors/Spelling/Encoding: UTF-8General/Workspace/Text file encoding: UTF-8Any others I have missed ?The rendering is as shown, the mutibyte chars do not render correctly,perhaps triggering the line spacing issue.I have tried it with different font sizes and different font typefaces.Interestingly, if I scroll down to an area of text that does notinclude the text in question within the window, and change editor font,the spacing is correct, but as soon as I scroll back to show,"With some changes ...."the window redraws with the wider spacing.I must admit this is not a new problem to me, I have seen it forover a year on other installations (also Centos or RedHat, hence Gnome v2.8.0)but only now decided it was annoying enough to investigate and report.Something is wrong here.indicates the multi-byte char is o-umlaut (UTF-16 0x00F6)this char in UTF-8 is 0xC3 0xB6the hex dump for the same char is EF BF BD, says the file encoding is UTF-8 and the char is not displayed correctly. It all indicates that the file in reporter's machine is not encoded in UTF-8Going back to main problem, the line spacing is increasing (the lines are getting taller) because the system had to load a fallback font to draw the text. This is not a bug. It is normal for a fallback font to be taller than the normal font.Comparing behaviour with that of 'gedit':gedit changes line spacing of _only_ the line(s) containing character,leaves rest of text unaffected.Eclipse changes spacing of _all_ lines in the file once the offendingcharacter has been rendered.Can I suggest that Eclipse goes with the less intrusive handling ofthis condition rather than spoiling the entire display of the file ?This is still a display bug somewhere, even if it's not a CDT issue,hence should (IMHO) be left open until a workaround or solutionis available.I have tried display using the alternative character modes(UTF-16, ISO-8859-1, UTF-8) and behaviour is still the same.Tried on Eclipse 3.2 on Windows - the offending characters are displayedwithout any problems, so this must be some issue to do with the Linux platform.Why not change the target milestone to 'Later' ? (rather than 'won't fix')That way it will still get fixed should the root cause be understoodat some future date.(In reply to)The reason is simple, StyledText can work in fixed line height mode (all lines have same height) or variable line height mode.Performance with fixed line height mode is much better.Correct, but that is a different bug (it should go to new problem report intead of reusing this one).Can you please attach the exactly file that shows the problem?The one file that has the umlaut encoded as EF BF BD.I second to this bug.With my Korean Windows XP and Eclipse Ganimede, I can reproduce the same problem as with Mike. But with prior versions of Eclipse, there wasn't this problem.I wonder if there's any activities regarding this bug since last comment from Felippe, November 2007.Createdbefore and after entering multibyte charactersThis problem has been here for so long without any answers.Find the png of before and after entering Hangul(Korean) multibyte characters in my Eclipse 3.4.1. Again, this didn't happen before up until version 3.3 as i know. I guess multibyte support has been changed during version ups as there's another problem.Before 3.4, I was able to block-undo my typings, ie. when I press ctrl-z, all my successive typings were undone at once. But now, each of Hangul consonants and vowels is undone by pressing ctrl-z each time. This make me very tired when I want to undo just a little bit of typings.I hope there's any progress regarding this. Thanks for your great work!I just found this ticket while preparing to report a bug. This is indeed very annoying, especially when editing Scala code, where the unicode right arrow ⇒ is quite common.The source code is visible in the screenshot.Eclipse Luna (4.4.1)Mac OS XCreatedLine spacing before and after inserting ⇒I have got similar problem.On the C/C++ Editor if I scroll to the line contains '℃' character,then the Editor's line space widens.It has tested on Eclipse 4.4(Luna 2) ~ 4.6(Neon M6) and it appears on those versions.I tried to change font but not work.I am using monospace like 'Ubuntu Mono' in eclipse under Ubuntu Gnome 16.04.Createdline space widens on c++ editor(In reply to Gumui Yul from)This problem seems to be related with Fontconfig on Ubuntu.For me, monospace font is specified as default on Eclipse and the monospace font family prefer to 'Ubuntu Mono'.(for this, I setup /etc/fonts/local.conf)Also I'm using 'NanumBarun' font for korean characters.Now, Eclipse render multibyte character like '℃' with 'NanumBarun' font instead of 'Ubuntu Mono'.However I think that the editor should not change line-spacing for whole lines. Just do it about the line contained multibyte character.Finally, I solved appending following codes into /usr/share/fontconfig/config.avail/90-fonts-nanum.conf. <match target="pattern"> <test qual="any" name="family"> <string>monospace</string> </test> <edit name="family" mode="append" binding="strong"> <string>Ubuntu Mono</string> <string>NanumBarunGothic Light</string> </edit> </match>Happens to me as well. As soon as I scroll in the editor to where the Japanese characters are, the line spacing throughout the entire file widens and remains until I close the file in the editor. In the default Text Editor (gedit) only the line which contains the Japanese characters is widened.Eclipse Neon. Ubuntu 64-bit 16.04LTS.CreatedSWT StyledText testcaseI am able to reproduce this with unicode "Right Angle Bracket" 0x3009 on Ubuntu and Windows 10. This happens on Neon with the dark theme when pasting it into a text file with a few paragraphs.I'm not sure if 100% related, but I can also reproduce this using SWT StyledText. I've attached a small class where clicking the button will add that character to the StyledText which adjusts all line spacing. Windows Font: Segoe UIUbuntu Font: Sans	19.0
id=216666	REOPENED	Platform	SWT	3.4	PC Windows XP	P3 normal	Felipe Heidrich	2008-01-25 23:55 EST by	Michael Scharf	2008-03-25 03:11 EDT (	3 users	CreatedWhich of the two editors has the focus????If a text is selected and the text does not the focus, the text should be grayed out or the selection should not be shown.- Internet explorer hides the selection when the widget does not have the focus.- Firefox grays it out.	Createdfirefox renders non-focus selectios in grayWe could do something for StyledText but the native text control draws correctly for the platform.NOTE: Choosing a color is generally dangerous. For exmaple, choosing gray will hide the selection when the background is gray or hide the text when the text is gray.*** This bug has been marked as a duplicate of***Drawing the selection "grayed" is not the same as being disabled. For example, on Windows, the tree and the table draw the selection "blue" when they have focus, and "gray" when they do not. This bug is a request for the same sort of behavior for StyledText.StyledText has API to set the selection foreground and background color. The client can call this API during focus out to implemented this behaviour.Steve, if we implement this behaviour in StyledText we will have to added API to allow the user to customize it.The best we can do is change StyledText to follow the native platform behaviour, on windows the code is right (remain blue is the right behaviour, test write.exe and notepad.exe).(In reply to)Neither write nor notepad have other panes. Outlook for example totally hides the text selection if another pane has the focus. Visual Studio 6 (ok that is really old) shows no selection in the editor if another pane or editor has the focus....Show me an microsoft application where multiple panes, views, editors (etc) within the same window show a text-focus in "blue"....Taking a single text-pane is not a good comparison.***has been marked as a duplicate of this bug. ***I think this is a general problem, that the code/text widget doesn't take on desktop colors.If I choose a gtk theme with black background and white text, the code text is still black - and therefore invisible.Felipe, the "black on black" bug is not SWT, right? Is it that Eclipse chooses the wrong colors in this case?(In reply to)Works for me with HighContrastInverse (black background, white foreground).CustomControlExample, StyledText tab, works fine.If fails on Eclipse, but that is because the worksbench forces black foreground on the editor.Confusion. This bug says XP but Thomas talks about GTK. In any case, we don't choose the colors, the Eclipse editor does. Please move the bug over there (after making sure the default colors are good on GTK).The black on black thing is unrelated to this bug. This bug is about selection fg/bg color when the widget doesn't have focus and which is out of the clients control (there's no API to set this).Please file a separate bug report against Platform Text with all the details, e.g. what is black and what is invisible (normal text or selection or both) and of course in which editor do you see this.	12.0
id=277261	REOPENED	Platform	SWT	3.5	PC Windows XP	P3 normal	Felipe Heidrich	2009-05-20 23:11 EDT by	Praveen	2009-06-12 08:37 EDT (	3 users	Build ID: I20090518-2000Steps To Reproduce:Run the following snippet - public static void main(String[] args) { Display display = new Display(); final Shell shell = new Shell(display); shell.setLayout(new GridLayout()); final Combo combo = new Combo(shell, SWT.SINGLE | SWT.BORDER); final Button copy = new Button(shell,SWT.NONE); copy.setText("Copy"); copy.addSelectionListener(new SelectionListener() { public void widgetSelected(SelectionEvent e) { combo.copy(); } public void widgetDefaultSelected(SelectionEvent e) { } }); final Button paste = new Button(shell,SWT.NONE); paste.setText("Paste"); final Text text = new Text(shell, SWT.NONE); paste.addSelectionListener(new SelectionListener() { public void widgetSelected(SelectionEvent e) { text.paste(); } public void widgetDefaultSelected(SelectionEvent e) { } }); combo.setItems(new String[] {"one","two","three","longer text in this one"}); shell.pack(); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } display.dispose(); }1. Press Copy button after selecting text in combo2. Paste (or Ctrl+V) doesn't paste the copied text.More information:The same is reproducible through Clipboard example.	when you click on the button the combo receives a focus out event that causes the control to clear selection.change your code to:combo.setSelection(new Point(0, combo.getText().length()));combo.copy();and it will work as you expected.Thanks for your response FH. However, I think there are 2 things to be addressed, so reopening this bug.1) If we need to use setSelection() method before combo.copy(), then the code of Clipboard example has to be modified, as this example exhibits inconsistent behaviour across different platforms. GTK and Mac platorms copy the selected text as expected without using setSelection() method. This is not the case with Windows.Also, in Clipboard example, the selected text is copied from Text without use of setSelection() method. Since Combo looses selection after focusLost event, the problem appears to exist only with Combo.2) If only part of the combo's text is selected and attempted to copy(through button), then adding the code - setSelection(new Point(0, combo.getText().length())) wouldn't be helpful, as selection of the text can vary. So, do we need to handle this in Combo class itself in order to copy the partly selected text of combo ?Thanks!Okay, we need to determine why combo is losing the selection during focus out:1. is it platform behaviour ? Does it happen to every native combo box in the desktop ?2. is something in our code that is causing it ?CreatedPatchI tried to dig into this problem. I've realized that the text selection of combo is cleared off at the moment any button is pressed. So, the selection is cleared before the focusOut event of combo. This appears to be the native behavior of Combo.In order to have the consistent behavior across platforms, I believe the code has to be modified in Combo.Copy() method to set the selection of entire text before it tries to copy. The attached patch has the suggested code changes.However, the suggested changes might not address the problem when only part of the combo's text is selected. Since it might be complex to note the selected content before the selection is cleared, we might not consider handling this scenario. Please review and comment. Thanks!Praveen, we try to avoid calling public APIs from our code.In the patch you used getText() and setSelection(), in there you have two calls to checkWidget(), create a String and a Point. All unnecessary.For example, In the patch:int stringLength = getText ().length (); could be replaced by:int length = OS.GetWindowTextLength (handle);Even better, the whole block:int stringLength = getText ().length (); setSelection (new Point (0, stringLength)); could be replaced by:int /*long*/ bits = OS.MAKELPARAM (0, -1);OS.SendMessage (handle, OS.CB_SETEDITSEL, 0, bits);---------------------------------------------------The main problem in the patch is that it changes the behaviour of the API, the javadoc for Combo#copy() says 'Copies the selected text'.With the patch the entire text is copied to the clipboard.As for as a solution goes, we can:a) change Combo so it doesn't clear the selection during focus out. Not too desirable cause we will be changing platform behaviour.b) accept we have platform difference in this care and change the example.b1) change the example as I suggested inb2) change the example replacing the cut|copy|paste buttons with a toolbar with 3 push toolitem. That should hide the problem given that toolitems don't take focus.Not great, platform differences are inconvenient for all users, but in this case is probably our better option.FH, I completely agree with you. We have to accept the platform difference in this case. I prefer to solution suggested in 'b2'.(In reply to)allright, do you want to write the code do see how it looks ?CreatedProposed code changesYes Filepe, I am interested in that. Thanks.I've modified the ClipboardExample such that Cut/Copy/Paste buttons of Control group are replaced with the toolItems. To maintain consistency across all controls in Control API group (and in order to prevent isolating combo's toolItems), all those buttons are replaced.Please review and comment. Thanks!Hi Praveen, the code is correct. The only part I'd change is the toolbar for StyledText. You added a dummy item in it just to have it aligned with the others.A better solution is using the layout to fix that:toolbar.setLayoutData(new GridData(GridData.HORIZONTAL_ALIGN_END));--------------------The code works great, but now I see how it looks I think it looks ugly. No border around the toolbar or toolitem just looks ugly.I'm out of ideas. I tried to add border to the toolbar, having it wrapped by a composite with border, create a NO_FOCUS button, etc. Anyhow I think we spent too much time in this. I vote for solution b1.What do you think?Felipe, I would agree with you that the toolItem looks slightly uglier than Button. Considering the fact that we spend enough time on this and the look of the example getting ugly with toolbar, I am OK with your suggestion - b1 (though it changes the behavior of API).	10.0
id=246137	REOPENED	Platform	SWT	3.4	PC Windows XP	P3 normal	Felipe Heidrich	2008-09-03 15:25 EDT by	Francis Upton IV	2010-01-20 10:55 EST (	2 users	CreatedRevisted snippet that respects mouse wheel on WindowsThis is exhibited by the current snippet:Attached is a fix to that Snippet to make it work on Windows.On Linux/GTK the scrolling works correctly with the unmodified original snippet.	This might be related toHmmm ... this might be a WONTFIX. From memory, on Windows, controls need to have focus before they respect the mouse wheel.Ok, I think the snippet should not be changed. Mouse wheel should go to the tree, not the scrolled composite.*** This bug has been marked as a duplicate of***(In reply to)The whole point of this is that the Tree is not supposed to scroll (I can't use the Tree's (native) scrolling behavior because it's missing the ability for me to directly scroll it programmatically where I want, so I'm using NO_SCROLL on the tree an doing the scrolling in the ScrolledComposite.) So I don't want the Tree to handle the mouse wheel.Steve, I didn't test this problem but given the description I'd say it is similar to.What happens is that SysTreeView32's winproc always(1) consumes WM_MOUSEWHEEL, so the parent never gets message.is the same case, but it uses a multiline text instead of a Tree.Should we detect when WM_MOUSEWHEEL doesn't scroll the control and call defwindowproc ourselves ?I think that this is the right (but unwanted) behavior. Mouse wheel goes to the focus widget on Windows. The focus widget is a buttton. Buttons don't do anything with mouse wheel.Am I missing something? I thought that mouse wheel was inherited. Please show me the code etc. and let's get to the bottom of it.Sorry, didn't see the NO_SCROLL (I was reading my email backwards). Yes, if the tree doesn't have scroll bars and cannot scroll, then we should forward the event. Does the table do this?There, that is the behaviour. But I think we can be more specific about the 'cannot scroll' part. Here the cases:a) Control doesn't have scrollbars - SWT.V_SCROLL and/or SWT.H_SCROLL are not set - SWT.NO_SCROLL is setACTION => FORWARD EVENT TO PARENTNOTE: does SWT.NO_SCROLL work everywhere (in all controls) ?b) Control has scrollbars but it is disabled (maximum > pagesize)c) Control has scrollbars and the thumb is showing, but it is scrolled all the way to an end (selection=minimum OR selection==maximum)-------Two options that I would be okay with:1. Implemented (a) and (b) and (c) to behave the same.2. Make sure (a) works, and let the behaviour of (b) and (c) to be platform specific.CreatedpatchSteve, if you are okay with this fix we can do the same for Text.I noticed the patch on this, any chance we can get this in 3.6?(In reply to)Hi Francis, I think first we should decide the proper behaviour for the platform (see) and fix it on all controls (Text/Table/Tree/etc).Right now we are busy finishing items that are in the 3.6 plan, if time allows I plan on fixing this bug (and all others in this area). I'll do my best.CreatedOriginal Snippet296 that shows the problemThe Snippet246 in CVS was revised (version 1.6) to hide the problem and is now incorrect as it causes double scrolling on Linux/GTK. It should work the same on all platforms.If you try this version on GTK and move your scroll wheel one notch it will move only one item as it should, applying the "fixed" version it will move two items.This problem also exists on OSX Cocoa (scrolling does not work with this snippet, but does work correctly when the mousewheel listener is added). Not sure about Carbon.Seethat complains about the revision to Snippet296 (Snippet246 reference in above comment is typo - should be 296).See alsothat is the same problem on OSX Cocoa	13.0
id=292758	REOPENED	Platform	SWT	3.5.1	PC Windows XP	P3 enhancement	Felipe Heidrich	2009-10-20 06:41 EDT by	Stefan Thurnherr	2009-11-02 03:28 EST (	2 users	User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; de; rv:1.9.0.1) Gecko/2008070208 Firefox/3.0.1 (.NET CLR 3.5.30729)Build Identifier: M20090211-1700When selecting text in a [Java,Text] Editor with SHIFT and ARROW_DOWN, it used to be (in Eclipse 3.41 and previous) that the cursor position of the first selected line was respected for every line added to the selection. This still holds true as long as I don't cross an empty line.Once an empty line got crossed while expanding the selection, the editor forgets the intial cursor position and selects the whole line for every additionally selected line (with SHIFT+ARROW_DOWN).This bug was introduced in 3.4.2 and is still there in Eclipe 3.5/3.5.1. The expected behaviour (remember the initial cursor position) is standard behaviour for Windows application and should be restored.Reproducible: AlwaysSteps to Reproduce:1. Open a [Java,Text] Editor with multiple text lines and at least one empty line in between.2. Set the cursor into the middle of the line just above an empty line.3. Hold SHIFT, then press ARROW_DOWN to select the subsequent lines--> After the empty line, for every line the whole line gets selected.	I don't this ever worked as you describe. Just checked 3.3.2 (editor and StyledText).Again, this is not true - just checked notepad on Windows 7.Having said that, since we preserve the column position when moving the caret up and down, it would also make sense to preserve it when selecting.Moving to SWT for comments.closing as wont fix.The same behaviour can be verified in Notepad and Wordpad.Eclipse 3.4.1 Text Editor supported it.Ok, maybe I should have said "Advanced Windows applications"? It is supportedat least in Firefox, Word, UltraEdit (WinXP).No it did not (at least not on Windows 7 and I can't believe that it worked on Windows XP Eclipse SDK 3.4.1). Maybe you installed a plug-in with a (text) editor which worked that way but I also doubt that.You're right, the correct functioning of Shift+Down was due to our own implementation of Block Selection. With Eclipse 3.5, this implementation became obsolete.So this should not be a bug, but a feature request. How do I convert this bug into a feature request? Could also be a papercut (google for 'ubuntu papercuts') if you have such a thing @eclipse? I.e., a nice feature that will be valued by lots of the regular Block Selection mode users (about 300 of them sit over here...).Sorry, monday morning; My previous comment should read:You're right, the correct functioning of Shift+Down was due to our own fixes of TextEditor (due to our own impl of Block Selection). With Eclipse 3.5, these fixes became obsolete.So this should not be a bug, but a feature request. How do I convert this buginto a feature request? Could also be a papercut (google for 'ubuntupapercuts') if you have such a thing @eclipse? I.e., a nice feature that willbe valued by lots of programmers that are used to this behaviour from other "advanced text-based Windows applications" (about 300 of them sit over here...).	6.0
id=312105	REOPENED	Platform	SWT	4.0	PC Linux	P3 normal	Felipe Heidrich	2010-05-07 14:15 EDT by	jose vilmar estacio de souza	2012-10-03 03:41 EDT (	2 users	Build Identifier: N20100506-2000When scrolling in the about box with the arrows, orca read the text "(c) Copyright Eclipse contributors and others 2000, 2010. All" two times.Copying the text from the about box I can verify that it appears only one time.Reproducible: AlwaysSteps to Reproduce:1. Using orca launch eclipse and choose a workspace.2. Press alt+h and choose about eclipse sdk.3. Press the tab key.4. Press the down key until you hear (c) Copyright Eclipse contributors and others 2000, 2010. All 5. Press down one more timeOrca announce the same text	moving this to SWT since things seem to be working as expected on JAWS and NVDA, but not orca. (Carolyn, please correct me if I'm wrong about that).SSQ, can you have a look at this? Is it possibly an example of the problem in?I tried this with N20100510-2000 and it works fine for me. I am running Ubuntu 10.04. Please reopen if you still can reproduce it with a newer build.(In reply to)I can reproduce using build I20100518-0800.I am running a 64-bit ubuntu 10.04 with all updates.Ok, I know how to reproduce it now. I have to press another arrow down KEY once orca reads the line the first time.It happens because the line is wrapped and StyledText considers TEXT_BOUNDARY_LINE the same as TEXT_BOUNDARY_LINE.Meant to say: It happens because the line is wrapped and StyledText considersTEXT_BOUNDARY_LINE the same as TEXT_BOUNDARY_PARAGRAPH.Is there anything we can do here?Seems to be fixed in 3.7 M5.Now the text is read correctly.The bug is back in Build id 20120614-1722.	9.0
id=384473	REOPENED	Platform	Resources	3.7.2	All All	P3 normal	Sergey Prigogin	2012-07-06 09:16 EDT by	Jens Baumgart	2016-04-22 15:10 EDT (	8 users	AbstractTextEditor.validateEditorInputState calls AbstractTextEditor.validateState which executes a workspace runnable.In the call stack below the UI thread freezes because main waits for the OrderedLock and the OrderedLock is owned by a different thread.I think AbstractTextEditor.validateEditorInputState should execute AbstractTextEditor.validateState in a background thread to avoid freezing the UI."main" prio=10 tid=0x00007f6f50007000 nid=0x4770 in Object.wait() [0x00007f6f560a9000] java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x00000000f85593d0> (a org.eclipse.core.internal.jobs.Semaphore) at org.eclipse.core.internal.jobs.Semaphore.acquire(Semaphore.java:39) - locked <0x00000000f85593d0> (a org.eclipse.core.internal.jobs.Semaphore) at org.eclipse.core.internal.jobs.OrderedLock.doAcquire(OrderedLock.java:183) at org.eclipse.core.internal.jobs.OrderedLock.acquire(OrderedLock.java:116) at org.eclipse.core.internal.jobs.OrderedLock.acquire(OrderedLock.java:84) at org.eclipse.core.internal.resources.WorkManager.checkIn(WorkManager.java:119) at org.eclipse.core.internal.resources.Workspace.prepareOperation(Workspace.java:2282) at org.eclipse.core.internal.resources.Workspace.run(Workspace.java:2339) at org.eclipse.ui.actions.WorkspaceModifyOperation.run(WorkspaceModifyOperation.java:118) - locked <0x00000000ccd270a8> (a org.eclipse.ui.actions.WorkspaceModifyDelegatingOperation) at org.eclipse.ui.internal.editors.text.WorkspaceOperationRunner.run(WorkspaceOperationRunner.java:75) at org.eclipse.ui.internal.editors.text.WorkspaceOperationRunner.run(WorkspaceOperationRunner.java:65) at org.eclipse.ui.editors.text.TextFileDocumentProvider.executeOperation(TextFileDocumentProvider.java:456) at org.eclipse.ui.editors.text.TextFileDocumentProvider.validateState(TextFileDocumentProvider.java:1074) at org.eclipse.ui.texteditor.AbstractTextEditor.validateState(AbstractTextEditor.java:4936) at org.eclipse.ui.texteditor.AbstractTextEditor$24.run(AbstractTextEditor.java:4987) at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70) at org.eclipse.ui.texteditor.AbstractTextEditor.validateEditorInputState(AbstractTextEditor.java:4982) at org.eclipse.ui.texteditor.StatusTextEditor.validateEditorInputState(StatusTextEditor.java:131) at org.eclipse.ui.texteditor.AbstractDecoratedTextEditor.validateEditorInputState(AbstractDecoratedTextEditor.java:1038) at org.eclipse.ui.texteditor.AbstractTextEditor$ElementStateListener$Validator.verifyText(AbstractTextEditor.java:369) at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:265) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)	This particular validateEditorInputState() was triggered by what I'm guessing was the first keystroke to modify the contents of an editor and make it dirty, which may be forbidden depending on whether the underlying file can be written to. Not sure this *can* be done asynchronously. Do you have the stack for the other thread that's tying up the workspace?It is "Worker-103" in the attachment "Thread dump" of. (In reply to)(In reply to)I think this can be done asynchronously:1. Editor starts a Job to perform the check2. Editor goes in a kind working state where it does not accept additional input. UI event loop is free, editor can e.g. be closed.3. Editor continues on done notification from Job.Except for the case where the file is read-only, we pass 'null' as scheduling rule i.e. no locking should take place at all. I verified that this is also the case for the Git scheduling rule factory.Jens, I assume your file was not read-only, right?(In reply to)Yes, the file was writeable.But even if null is passed as scheduling rule, the OrderedLock is acquired by Workspace.run (protects broadcasting changes).(In reply to)Yes, but actually it should not, since no rule/lock is given.If rule is null and you do not want workspace lock to be acquired, then why do you use IWorkspaceRunnable at all?(In reply to)Because the factory give the rule (which can be 'null') and it should not be each client that has to deal with that case.OK, but my point is that, as far as I know, it is by design that you can run IWorkspaceRunnable with 'null' rule knowing that it will try to acquire the lock. This way you can wrap many different operations with different rules (even conflicting ones) as a single atomic workspace operation.(In reply to)For me this is still an editor issue since there is at least the read only use case in which the runnable needs to be performed. Thus there needs to be a solution in the editor that works in all cases (execution of the runnable outside the UI thread, ideally in a Job).(In reply to)Well, it *does* work, but just has to wait for the lock that it requires. There are no plans to invent some other mechanism here. Same applies to save and all other resource operations that modify something. The question is rather: what locks the whole workspace (and why?), so that the smaller lock can't be taken?If there is a background job executing a Workspace runnable that takes 30 seconds the UI will freeze 30 seconds. So I am not sure if it is a good approach to acquire OrderedLock in the UI thread.(In reply to)It will not freeze, but rather show the progress dialog.(In reply to)It freezes, here is the call stack:"main" prio=10 tid=0x00007f6f50007000 nid=0x4770 in Object.wait()[0x00007f6f560a9000] java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x00000000f85593d0> (aorg.eclipse.core.internal.jobs.Semaphore) at org.eclipse.core.internal.jobs.Semaphore.acquire(Semaphore.java:39) - locked <0x00000000f85593d0> (a org.eclipse.core.internal.jobs.Semaphore) atorg.eclipse.core.internal.jobs.OrderedLock.doAcquire(OrderedLock.java:183) at org.eclipse.core.internal.jobs.OrderedLock.acquire(OrderedLock.java:116) at org.eclipse.core.internal.jobs.OrderedLock.acquire(OrderedLock.java:84) atorg.eclipse.core.internal.resources.WorkManager.checkIn(WorkManager.java:119) atorg.eclipse.core.internal.resources.Workspace.prepareOperation(Workspace.java:2282) at org.eclipse.core.internal.resources.Workspace.run(Workspace.java:2339)The purpose of IWorkspace.run is to batch resource change events, and that lock is needed when calculating and broadcasting resource change events. There are some resource changes that can result in resource change events even though their required scheduling rule is null, so we can't assume that null rule implies no batching/events are required here. Maybe it is deceiving that we have a IResourceRuleFactory#validateEditRule at all since it turns out this method requires no form of locking. None of the other validate* methods on IWorkspace have a rule factory method.(In reply to)Scatch that comment. The resources plugin doesn't need to do any locking on validateEdit, but the team provider might. For example in the CVS case it does require a scheduling rule for validateEdit. So I think the editor is doing the right thing here by using IWorkspace#run and the rule factory. One could argue it shouldn't be calling this in the UI thread though.(In reply to)Note that we use org.eclipse.ui.actions.WorkspaceModifyOperation from which one could expect that it does not entirely lock the UI (but show progress dialog instead).***has been marked as a duplicate of this bug. ***indicates that the problem is still affecting Eclipse users.***has been marked as a duplicate of this bug. ***Sergey, I see you targeted this to 4.7. Do you plan to fix this? If not, please remove the target again, as no one else will.(In reply to Dani Megert from)I do plan to take a close look at this for 4.7.(In reply to Sergey Prigogin from)Thanks!	23.0
id=285363	REOPENED	Platform	SWT	3.5	PC Windows 7	P3 normal	Felipe Heidrich	2009-08-01 10:47 EDT by	Prashant Deva	2013-11-08 06:56 EST (	34 users	CreatedPackage Explorer not redrawnIn eclipse 3.5 on win 7 rc, a lot of times when I switch back to the eclipse window, the package explorer view does not seem to refresh until I close and reopen it. Image attachment shows the issues.In the instance of eclipse shown in the image attached, if i were to switch to the Outline View and back to Package Explorer, the view would display properly.This problem seems to occur only for the Pkg Explorer view and not any other view.	Anything in .log? Can you also try using the Project Explorer or Navigator?Moving to SWT. The Package Explorer doesn't do anything special regarding redraw, except for owner-drawn labels (but we have that in other views like Outline, Search, Hierarchy, ... as well).In the Package Explorer view toolbar, I see an additional button (3 gray balls). Prashant, could you please also try to reproduce with a plain Eclipse SDK without third-party plug-ins?I've worked on Windows 7 quite a bit recently and never seen this problem.Do you have steps to reproduce this problem ?Please reopen with requested information. Thanks!When I maximize the editor, the left taskbar minimizes. When I then re-maximize the taskbar, the Package Explorer doesn't redraw except for the left-most 1/4 inch. When I move my mouse over that strip, the collapse/expand arrow(s) appear, but that doesn't refresh the rest of the pane. I've tried closing and restarting PackExp, but the only remedy is to restart Eclipse.I can easily replicate the bug by simply doing it over again. I don't know of any other conditions that have to be met, aside from using Windows 7. I use Win7 Home Premium Edition. Also, it's "linked to editor", but I don't know if that has anything to do with the problem.Createdscreen shotscreen shotHi all, has this been solved?I’ve experienced this issue myself with my recent fresh install of Windows 7 - ultimate edition.Screen shot hopefully attached. In my case it happens often on minimize and maximise of the eclipse window. It also happens to the outline view on the far right.Using latest version of Eclipse Java EE – 3.5.2 if I am not mistaken (downloaded file was: eclipse-jee-galileo-SR2-win32.zip)Possible issues that could have led to this are:• I installed the 64 bit version of Windows 7.• I installed the 64 bit version of JAVA (jdk-1_5_0_22-windows-amd64.exe) Confused as to why it has AMD in the name but I decided to wing it (Even though my laptop has an Intel based CPU). Got an error message on start-up of eclipse which I move past by installing a 32 bit version of java (jdk-6u18-windows-i586.exe). So I assumed the 64 bit version was a bad move on my part. Makes sense as I believe Eclipse for windows and MyEclipse only comes in a 32 bit version.• Have changed my Windows background colour from the default eye frying white to a darker grey. (Would’ve liked to change everything to black, similar to my putty consoles but I assume that would wreak havoc.)• Installed MyEclipse on the side before I moved to plain eclipse. Both use separate workspaces but I’m not sure if they possibly share some sort of resource I’m not aware of.• Have multiple versions of JAVA installed as I said before. 1 x 64bit version as I said before in the “Program files\Java” folder (ver: 1.5.0.22) and 1 x 32 bit JRE version 6, and 1 x 32 bit JDK 1.6.0.18 both in the “Program files (x86)\Java” folder.As far as I can remember i didn’t customized Windows 7 too much.I installed an identical second laptop at work for a fellow developer recently; after my experience with the 64 AMD version of java I made better choices this time and as far as I recall installed the 32 bit versions only (will check with him when I next get the chance). Long story short, the problem seems not to occur on his laptop / dev environment. I dread the thought of reinstalling/config so I’m hoping for a quick fix.Additional Notes:• Problem can be fixed for that occurrence by triggering a redraw event of sorts i.e. dragging the horizontal scroll bar right and then back left again, or opening a new file (sometimes), or using the “link with editor” button to shift between open files enough as to trigger a redraw in the project explorer window.• Problem doesn't seem to occur when the vertical scroll bar is present. In other words the Project Explorer view is full with say 3 projects all expanded so they pass over the max available view space and hence require a scroll bar. I can even see the redraw of all the views taking place on min and maximize of the eclipse window. Black and then wam … correct. Might be my system specs, although (Dell vostro 1720, 512 okish gfx card, 4 gig ddr2 800) makes me think otherwise.• After a while of min and maximizing / opening files in the editor or playing with the project explorer view I find the problem is no longer reproducible for that session. I’ve not been developing much of late so I’ve not much else to comment on.Rorysince the problem seems to be occuring for other people too and they are able to reproduce it, I am reopening this bug.Someone in the eclipse team needs to fix this.(In reply to)Happy to hear I'm not alone on this one. Hopefully I don't have to reinstall Win7.Ror(In reply to)you definitely arent alone. i face issue all the time on win7 and reinstallation doesnt help :(I have 64bit Windows 7 Ultimate; 32bit ibm java 1.5; 32bit win32 eclipse 3.6 M6.steps:maximize java editorrestore package explorer viewI did that several times (vertical scrollbar visible and not visible, linked to editor mode on and off, etc). I could not reproduce the problem.Are you sure you are not running the WPF port ?***has been marked as a duplicate of this bug. ***I also tried the steps from:1. maximize eclipse window2. minimize eclipse window3. restore eclipse window I tried that several times, it worked for me everytime.Hi FelipeAbove is the link to the eclipse version I downloaded; have never heard of the WPF port till you mentioned it (Previously used MyEclipse, which I have installed on the side at present for migration purposes).Will attach some screen shots containing version info below this message, hopefully they help in some way.Played with the IDE for about +30 minutes yesterday (minimizing, restoring etc.) and at some point the black project explorer issues went away. The only way I could get it back was to restart windows 7. Played with it again now after capturing the screenshot and +/- 3 minutes later I can't reproduce the problem again.About to restart Windows, remove 64 bit java version and see what happens.RoryCreatedscreen shotCreatedscreen shotThanks Rory, would you be able to try with Eclipse 3.6 M6 Please let me know if (and how) you can reproduce the problem withUsing Eclipse 3.5.2 (eclipse-jee-galileo-SR2-win32.zip) and replacing JDK 1.5 (64 bit) for JDK 1.5 (32 bit) and adding JRE 1.5 ALmost seemed to fix the issue. Took about +/-20 minutes to reproduce the issue again :( but once again I had the black project explorer. I will compare my setup tomorrow to the other developer’s laptop I helped install.Then tried the “Eclipse 3.6 M6” as you requested. Link you posted seems to be incomplete (missing "download.eclipse.org/eclipse/" in place of fullmoon), so downloaded frominstead.Available downloads options were more numerous than I expected: “Eclipse SDK”, “Platform Runtime Binary”, “Platform SDK” all in 32 bit and 64 bit versions stood out. I have downloaded the Eclipse SDK 32 bit version (eclipse-SDK-3.6M6-win32.zip) hopefully that is ok for your test.Took a while to download, but after a Windows restart the Eclipse SDK 3.6 M6 also gave me the black project explorer.So steps to reproduce:1) Have a Windows 7 environment setup like mine (could still be something I am setting up outside of eclipse differently, as I mentioned the developers laptop I setup that is not having this issue)2) Download and extract Eclipse version using 7zip to a folder. (c:\tools\eclipse_3.6_M6\)3) Run eclipse.exe4) Choose a workspace location. (In my case this is on different truecrypted partition e:\projects\workspaces\eclipse_3.6_M6\), make this the default location for the workspace.5) Waited for new shiny eclipse screen to finish loading.6) Closed the “welcome / tutorial” tab7) Checked the JRE versions eclipse has discovered and is using in the eclipse preferences menu; seems to be using newer 1.6 which is expected.8) Imported an existing project. Noticed that the newer version of eclipse has hidden the JARs in my lib directory :) very nice and neat.9) Played around by expanding the folders of my project tree, open a couple of files, pressed the linked with editor button, max, min, restore, close files, and more random min, max and restoring and walla …. Problem reproduced. Then a couple minutes later… problem gone, and then back if I open my project tree a little more or something like that or restart windows and start fresh with a little bit of project tree opening.10) So far since posting I’ve not noticed the outline view having this issue again, but that could be due to my lack of dev work in the last 3 months.Thanks for the idea.Will attach a new picture below of newer version with black project explorer view.RoryCreatedscreen shotif i am correct you have to have the package explorer view(or any other view) open when you minimize eclipse and then when you maximize it you see the issue.Yes it happens with the outline view too.(In reply to)I have a 64x Win7 Home Edition, and it doesn't redraw right at all for me. Furthermore, when I unmaximize the Eclipse app window, the Outline view goes all funky too, but corrects itself when I remaximize the app window.Run out of ideas to try on this side.The second developer at work has exactly the same laptop specs as I do. Same version of Windows 7, similar versions of java installed (including a 64 bit version), He had a JAVA_HOME environment variable which I didn’t, pointing to the 64 bit version of java. Both of us have use the java directory in the path variable. He has tweaked his eclipse layout a bit more but I can’t seem to reproduce this issue on his laptop (even after extracting a fresh copy of the older version of eclipse). On mine all I need to do is restart windows and the problem usually occurs soon after running eclipse. Something must be different on his setup... Will keep looking as I get time.I can reliably reproduce this by having the package explorer open and docked to the left and two java code editors side-by-side in a maximized window. Then minimize and restore the window. The package editor is now blacked out and won't redraw unless I adjust the width of the window a little. Even if I then minimize and restore the package explorer, it remains in the error state.Eclipse 3.5.2Windows 7 Home Premium 64-bitJRE 1.6.0_17 64-bitCan you attach a screenshot of eclipse right before you minimize the window ?What part has the focus when you minimize eclipse ? (does it matter?)Are the tree's expandos showing or hidden ? (does it matter ?)the steps you have work for me.Try going to the preference page, General -> Appearance and disable 'Use mixed fonts and colors for labels'. Can you still reproduce the problem ?Same here (I20100420-0800).CreatedScreenshot before minimize, showing editor stateCreatedScreenshot after minimize and restore, showing error state(In reply to)Done.With the package explorer tree expanded, the package explorer was not redrawn after minimize regardless of where the focus is placed. I tried the left editor, right editor, package explorer, and outline view docked on the right-side of the window.Interestingly, when none of the trees in the package explorer were expanded, the package explorer *was* correctly redrawn after restore, again regardless of where the focus was placed.Disabling that setting made me unable to reproduce the issue. Thanks! I'm going to leave that turned off, especially since I can't determine a visible difference in the UI.(In reply to)Well dang. Now it's happening even with the 'Use mixed fonts and colors for labels' setting turned off. Maximized window, package explorer tree expanded, doesn't matter where the focus is, changing the setting has no effect.William, can you reproduce the problem right after you start Eclipse ? Or do you need to 'use eclipse for awhile' before you get to a state where you reproduce the problem consistently ?Please, try this build (or newer):Maybe this problem is also caused by.Hi,I have Windows 7 64 Enterprise and this problem happens to me with different versions of eclipse (3.4-32, 3.4-64, 3.5.2-64) with JRE 1.6.3-b01 64-bit.I hope this helps:I've noticed that this does not occur if the labels on the package explorer fit well on the container. I mean, if you resize the package explorer to avoid text to be truncated this refresh problem dissapears, so you can maximize the editor and restore anytime it's needed.Regards,I also have had the same problem occur in 3.4 too.I've managed to isolate this on my machine, Windows 7 Enterprise x64. My video card is a NVIDIA Quadro NVS 160M.*) With NVIDIA nView Desktop Manager v121.34 "Desktop Manager features" enabled, this can be reproduced consistently by minimizing and restoring the Eclipse IDE window. Black panel can be fixed by restore/re-maximize.*) With NVIDIA nView Desktop Manager disabled, cannot reproduce.So for me this is probably associated with some particular modes/features of this graphics card. I wonder if other reporters of this problem have the same video card and software installed / modes active.(In reply to)Hi, I've the same problem and I have an ATI 4870x2 videocard.Thank you and have a nice day(In reply to)I have an ATI too, 3450hd.(In reply to)Hi, I've got a Laptop with a NVIDIA GeForce 9600 GS. Dell based drives without NView from what I can tell.ThanksI'm having the same refresh problems in outline view on a very recent Eclipse:Version: 3.6.0Build id: I20100429-1549I"m running Windows 7 x64 Ultimate, with the very latest JDK 6.0. Been having this problem for a year at least, on two Windows 7 machines. *VERY* annoying.It is rather easy to reproduce for me: Start Eclipse, do some work, minimize, maximize, minimize, maximize, and bam, Outline View is black :(Please, any hints?(In reply to)I really want to fix this problem, but without being able to reproduce this problem myself it is rather dificult for me to work on it.Would you be able to help me ?You would need to download SWT from the CVS (see) and start self-hosting eclipse in debug mode.Let me know if you have time to help me on this, I can send you more detailed instructions and code changes to try out. Thank you.Hi Felipe,I am using Windows 7 and fortunately (or maybe not) I am able to reproduce this problem. I will try to find some time to work on it and try to find the cause.The problem is repeatable. It occurs only if there is vertical scrollbar in package explorer (and each common navigator, outline and some other too) in the custom-sized Eclipse window (not maximized). In all attached screenshots this vertical bar is visible. Black is the only that part of the view which is covered by this view in custom-sized window and the rest is gray (this is the reason why only part of the view is black).Felipe, do you have any idea what can cause such problem?(In reply to)In Tree#WM_PAINT, find out if doubleBuffer is false and why (likely TVS_EX_DOUBLEBUFFER is set in the OS). Try to change the code so TVS_EX_DOUBLEBUFFER is never set in the OS, it is done in createHandle() by calling SendMessage with TVM_SETEXTENDEDSTYLE.Other idea is in Tree#WM_VSCROLL, it has a fixScroll flag, make sure the flag is always false and try to reproduce the problem.Thank you(In reply to)I changed the code (doubleBuffer is true) but it doesn't help.The same as in previous case, no change.I have noticed that horizontal scrolling (even if there is no horizontal scrollbar in custom-sized and in maximized window) refresh view correctly. Vertical scrolling doesn't help.Problem doesn't occur when there is a vertical scrollbar in both custom-sized and maximized windows.Okay, so the problem happens happens regardless if TVS_EX_DOUBLEBUFFER is set or not.Go back to Tree#createHandle(), we are also setting OS.TVS_EX_FADEINOUTEXPANDOS when calling TVM_SETEXTENDEDSTYLE. Can you see if removing this flag fixes the problem ? What if you remove custom draw, does the problem happen ?In the very beginning of Tree#_addListener(int, Listener) and add this code. switch (eventType) { case SWT.MeasureItem: case SWT.EraseItem: case SWT.PaintItem: { return; } }When the tree is in the bad state, do you know if WM_PAINT messages are being sent ? (add a println() to Tree#WM_PAINT). If you resize the view does it fixes the drawing ?Thank you(In reply to)Doesn't fix the problem.Doesn't fix the problem.So when a tree is in bad state when I move a mouse over it there are WM_PAINT calls only when I move over the bar with triangles to expand projects. I see that this bar is in correct state cause I can expand and collapse projects but even when I am doing that the rest of tree is still in incorrect state.About resizing window with broken tree, there are couple different behaviors, depends on action:- when window is maximized and I press button in right top corner to back to normal size, the problem is fixed- when window is maximized and I hold top title bar and drag it (it will cause that window is resized to normal size) tree is refreshed but there is no vertical scrollbar which should be displayed- when window is half-screen maximized to left (by hold window and move it to screen edge) and I move it to the same state but to right part of screen tree is refreshed but there is no vertical scrollbar- when window is half-screen maximized and I resize it, the problem is fixedMaybe related to?(In reply to)It crossed my mind, but it is not.I asked Wojciech to remove the TVS_EX_FADEINOUTEXPANDOS flag and it didn't fix the bug ().I really thought this was a problem with double buffering, but I could not prove that either ().I know Windows 7 is retained graphics mode, I suspect that the tree draws while in a "bad" state (clipping nil or something). The pixels generate during this state are retained and the tree remains black till a full redraw happens.We need to prove that, find out what causes the bad state happen or detect that the tree is in the bad state. Once we can detect the bad state we can decide on a fix (I think a old good redraw will do it).I can confirm that this bug is still an issue in the Eclipse Helios Release (build id:20100617-1415). I'm running Windows 7 x64, on a Core2 Duo, with an Intel GMA 4500MHD graphics card. And even though I'm using a 64-bit OS, I have a 32-bit JDK and the 32-bit Eclipse build.I experienced this same issue under Galileo, and I was really hoping it'd be fixed in Helios.Every time I minimize and then restore Eclipse, the Package Explorer fails to redraw (unless the vertical scrollbar is active).On a similar note, the Outline view is doing a similar thing. However, whereas the Package Explorer renders as a black box, the Outline renders as a white box.Really hoping you guys figure this out soon and release a patch. It's extremely annoying.Thanks!Is there any patch for this reported issue? I installed the Helios last night on my Windows 7 Laptop and found to be disturbing.HarshaI described this problem on Eclipse forum:.You may watch the sceen capture on how to reproduce this problem.Hope this helps.***has been marked as a duplicate of this bug. ***(In reply to)(In reply to)I still experience this issue on Helios 3.6.1 (SR1) with Win7, 64 Bit.However when I maximize and restore the editor, the issue with not redrawing happens to package explorer and outline view. Sometimes only to one of them.Happening here too. Happens on both Win7 32 and 64 w/NVidia graphics card.The error still occurs in Eclipse 3.7 (I20110428-0848)...***has been marked as a duplicate of this bug. ***I can reproduce it on Indigo (Release Build id: 20110615-0604) and SpringSource Tool Suite (Version: 2.6.1.RELEASE, Build Id: 201105041000).Steps to reproduce:Open eclipseIn the package explorer expand any tree until a vertical scroll bar appearsCollapse the tree until the vertical scroll bar disappearsMinimize eclipse windowMaximize eclipse windowOn my Win7 64bit I also observe the same redraw problems with Eclipse (Indigo, Build id: 20110615-0604)I also have similar redraw problems with Chandler () which is AFAIK written in Python and uses wxPython (wxWidget wrapper), as well as with Adobe Acrobat 8.1.4.Both other apps have problems when they are started in not maximized mode, and then are being maximized. I don't know if this is related, but thought it may be helpful.Having the same issues here. (Windows 7 Business 64bit, using JDK 1.6 Update 27 (64bit))(adding myself to cc)rgdsMichaelSame thing here. Windows 7, 64bit. JDK 1.7.0.Build: 20110218-0911Can you guys try with our newest build ?it is possible that the fix for(fixed last week) has fixed this bug too.I was still able to reproduce the error (outline view is black) with:Version: 3.8.0Build id: I20110915-1308While experimenting with this issue I just found out that the behavior if the view is drawn correctly or not is also influenced by the non-maximized (restored) size of the Eclipse window. If I make the restored window very small re-draw issues are more likely to occur.The reproduction steps inalone don't seem to be sufficient, at least I was not able to reproduce the issue reliably with just the steps mentioned there.I got the idea of fiddling with the restored window size by reading the description of.Also the redraw issues only occur when going from minimized to maximized. Going from restored to maximized works fine.As a side note the re-draw issue does not always manifest itself by having a black box in the view the box might also have some other color, e.g. grey.After taking a closer look at the most recent build (I20110915-1308). It seems like the behavior has slightly changed. Originally the entire content area of the view was not redrawn correctly but now only the area that should be occupied by the horizontal scroll bar at the bottom of the view stays black.Still the issue can only be reproduced with a certain restored window size where the views have a vertical scroll bar with the restored size and not in the maximized size.CreatedScreen recorded after black area appear...I cannot find the steps for reproduce the problem.After black area appear, I record the screen by "Wink" and save the output to attachment package_explorer_black_e362.swf. If the video is not clear enough, please let me know. I can upload the .wnk file saved by Wink(file size is 5MB)Hope it is helpful...Platform: Eclipse v3.6.2 on Windows XP SP2eclipse.buildId=M20110210-1200java.version=1.6.0_27java.vendor=Sun Microsystems Inc.BootLoader constants: OS=win32, ARCH=x86, WS=win32, NL=zh_TWCommand-line arguments: -os win32 -ws win32 -arch x86Since reinstall of "Indigo SR2 64 bit - Build id: 20120216-1857" 2 days ago problem has not returned. Could be a update / fix in Indigo, I just got lucky (nature of the problem to be weird and random), its coming back soon and I just don't know it, or I changed something as below.Things I have changed (of little importance I'm sure)* Moved from CVS to EGit (installed plugin). More correctly we are in the process of migrating some projects to EGit.* Added "JAVA_HOME=C:\Program Files\Java\jdk1.6.0_23" - to environment variables* Added "%JAVA_HOME%\bin" - to path environment variable* Manually edited exported Ant/Run configurations using notepad++ to clear / neat Indigo entries.* Re-created a fresh workspace, and created working sets for all projects which I imported into eclipse Package Explorer.* Installed the following NEW plugins EGit + EGit Mylyn, Eclipse Colour themes ()* Changed "Colour theme" to use a black background - Theme name: Oblivion.* Changed java default compiler, added 1.5 to installed JRA's* added -vm flag to eclipse.ini to point to 1.6 64 bit java.* added ssh key to eclipse and changed authentication order* imported some more debug settings, unit test configs, etc etc.That might be all I did.Hope Indigo fixed this.RegardsRoryPrevious post mistakes/typo's:* Manually edited exported Ant/Run configurations using notepad++ to clear junk lines. i.e. old entries that no longer work because they point to directories that no longer exist. This happens due to eclipse export from MyEclipse to Eclipse for example. Probably also older versions of eclipse to newer versions* Changed java default compiler, added 1.5 to installed JRE's not JRA'sApologiesRoryCreatedScreenshot of blank Package ExplorerI have been encountering the blank Package Explorer for the 5th time today in the past one month. Today encountered the problem while using Eclipse Version: 4.4.0 Build id: I20131028-2000I do not have the exact steps to reproduce the bug. It has happened mostly when the editor area is fully expanded and then when i restore the Package Explorer view it is blank. Just before the issue appeared i was viewing files opened from either JUnit View or Git Staging view and the Package Explorer view was in minimized state. There is nothing in the log which gives any lead.Am past this issue since a laptop upgrade.Now using:Windows 8 soon to be 8.1Dell XP 1702x - which 3 gig GFX card and instead of the old forced Dell driver I have the latest Nvidia driver direct from Nvidia, which has solved so many of my graphics problems even with other programs (i.e. virtualbox).I've done nothing else to eclipse version, JDK etc. I did upgrade recently to latest eclipse and still the problem is gone on this new configuration.So personally I'm writing this bug off to system config (drivers, setup, versions of something other than eclipse and JDK) I could be wrong and I might get this again in my next upgrade / reinstall but I suspect not.Good luck all.	69.0
id=352927	REOPENED	Platform	SWT	4.1	PC Windows 7	P3 critical	Felipe Heidrich	2011-07-23 06:14 EDT by	Martin Robertson	2012-06-04 16:35 EDT (	3 users	Build Identifier: 20110218-0911I have discovered that the SWT StyledText component renders text with lots of commas very slowly on Windows 7 and possibly other platforms. In particular, scrolling vertically is very laggy.I have done some basic profiling using VisualVM and it seems most of the time is spent in the following place:org.eclipse.swt.graphics.TextLayout.merge(int, int)org.eclipse.swt.graphics.TextLayout.itemize()org.eclipse.swt.graphics.TextLayout.computeRuns(org.eclipse.swt.graphics.GC)org.eclipse.swt.graphics.TextLayout.getLineCount()org.eclipse.swt.custom.StyledTextRenderer.getTextLayout(int, int, int, int)org.eclipse.swt.custom.StyledTextRenderer.getTextLayout(int)I am marking this as critical as it is pretty terrible that the StyledText control becomes so slow depending on the characters it contains.Reproducible: AlwaysSteps to Reproduce:There are two ways you can reproduce this.Method 1- Open the attached files test.txt and testfast.txt in Eclipse. These files contain lines of random length which were generated from the code mentioned in step 2. The only major difference between them is that test.txt uses commas instead of spaces as separators.- Scroll each document vertically and note the responsiveness and CPU usage. On my system test.txt scrolls much slower.Method 2- Run the attached file StyledTextBug.java. This opens a new window with two StyledText controls. One control is filled with space separated text and the other control is filled with comma separated text. The comma based text scrolls much more slowly for me.	CreatedTest text filesCreatedTest java classCreatedEnhanced test classThe output from running this code on my Windows7 machine is as follows:Time to scroll space separated text: 4946Time to scroll comma separated text: 29001This shows the comma separated text is more than 5x slower to scroll.I have cleaned up my example class and put it on github along with a pre-build cross platform runnable SWT jar. There are instructions on the page linked below to run the example on your own platform.Note that in the case where whitespaces are used as delimiters Uniscribe will put all chars for the line in one single run.When commas are used, Unicribe will put each comma in a run, so basically you will have one run for each characters in the line.SWT needs to handle each run separately, I don't think there is nothing I can do here.Can you give a little extra background please?- What is Uniscribe? Part on SWT/Java/Windows?- What is a "run"?- Why are runs split around commas? Could this be optional?(In reply to)is the native technology we use to draw text"runA run is a passage of text for Uniscribe to render. It should have a single style, that is, font, size, and color, but can be drawn from a variety of scripts. A run can contain both left-to-right and right-to-left content."seeI didn't implement Uniscribe so I don't know for sure, but I suspect that they did that to handle bidi reordering.Thanks for the clarifications. I have taken a closer look at the SWT source and found the key OS calls are in the following method.org.eclipse.swt.graphics.itemize()This calls into the native method OS.ScriptItemize(...) which calls through to the Windows specific code:The settings for this method come from the SCRIPT_CONTROL struct. However, the defn of this struct used by SWT is missing the fMergeNeutralItems field. This sounds promising to me but I haven't managed to find anything clear online about whether this field would merge together the returned runs for my comma heavy text.I've raised this issue on StackOverFlow in case anyone else has hit similar issues with Uniscribe.The reason fMergeNeutralItems is not in our java code is because it didn't exist when we first implemented TextLayout,This is from usp10.h from Win SDK 2003typedef struct tag_SCRIPT_CONTROL { DWORD uDefaultLanguage :16; // For NADS, also default for context DWORD fContextDigits :1; // Means use previous script instead of uDefaultLanguage // The following flags provide legacy support for GetCharacterPlacement features DWORD fInvertPreBoundDir :1; // Reading order of virtual item immediately prior to string DWORD fInvertPostBoundDir :1; // Reading order of virtual item immediately following string DWORD fLinkStringBefore :1; // Equivalent to presence of ZWJ before string DWORD fLinkStringAfter :1; // Equivalent to presence of ZWJ after string DWORD fNeutralOverride :1; // Causes all neutrals to be strong in the current embedding direction DWORD fNumericOverride :1; // Causes all numerals to be strong in the current embedding direction DWORD fLegacyBidiClass :1; // Causes plus and minus to be reated as neutrals, slash as a common separator DWORD fReserved :8;} SCRIPT_CONTROL;This is from the same file Win SDK 6.0 (Vista)typedef struct tag_SCRIPT_CONTROL { DWORD uDefaultLanguage :16; // For NADS, also default for context DWORD fContextDigits :1; // Means use previous script instead of uDefaultLanguage // The following flags provide legacy support for GetCharacterPlacement features DWORD fInvertPreBoundDir :1; // Reading order of virtual item immediately prior to string DWORD fInvertPostBoundDir :1; // Reading order of virtual item immediately following string DWORD fLinkStringBefore :1; // Equivalent to presence of ZWJ before string DWORD fLinkStringAfter :1; // Equivalent to presence of ZWJ after string DWORD fNeutralOverride :1; // Causes all neutrals to be strong in the current embedding direction DWORD fNumericOverride :1; // Causes all numerals to be strong in the current embedding direction DWORD fLegacyBidiClass :1; // Causes plus and minus to be reated as neutrals, slash as a common separator DWORD fMergeNeutralItems :1; // Causes merging neutral characters into strong items, when possible DWORD fReserved :7; } SCRIPT_CONTROL;(Note that they used a bit from fReserved for that)I will try setting the bit.try adding 'scriptControl.fReserved = 1;' before the call to OS.ScriptItemize(chars,...)does that fix your problem ?OK I stepped through in the debugger and setOK I stepped through in the debugger and set 'scriptControl.fReserved = 1'.The String being processed was "1,2,3,4,5,". Without this change, the number of runs returned was 10. With fReserved set to 1 the number of runs returned was 1.I haven't rebuilt SWT to always set fReserved = 1 so I can't easily check the performance improvement. However, hopefully this will significantly speed up rendering of comma heavy text.Regarding next steps, will you want to default fReserved to 1 or make that an extra option on the StyledControl object?Okay, usually this type of change introduces new bugs. I googled fMergeNeutralItems and I found no hits regarding performance improvements or problems. MSDN also doesn't say much.That said, we are at good point in the release cycle to try this type of change. Hopefully it will good performance and won't cause trouble.I tested wrapping, bidi, and font substituion. So far looks good.Let me know if you need any help with testing this. Can you confirm what URL I should use to download dev builds of SWT? I would be keen to start using a build of SWT with a fix for this bug ASAP.(In reply to)It should always be set I believe. Agreed ?The tricky part is how to set it.I can't add fMergeNeutralItems to SCRIPT_CONTROL cause we need to compileagainst old version of the SDK where fMergeNeutralItems does not exist.Setting 1 to fReserved looks funny cause it is not taking byte order inconsideration (maybe it fails on a big endian machine...). Hopefully it is okaycause fReserved is the size of byte and it is an atomic unit. One option that can be better is add a variation of SCRIPT_CONTROL that hasfReserved and add a version of ScriptItemize that takes pointer (int /*long*/)instead of a struct (SCRIPT_CONTROL).I will talk to Silenio about this problem.(In reply to)Thank you very much for not giving up and investigating this problem further. Last time I checked MSDN I didn't see the new flag and without your help probably I would never see it. I will take care of this problem now, I will let you know when a build including the change is available.If this new field was only added in Win SDK 6.0 (Vista) does that mean that only Vista and newer will benefit from the fix or can newer Win SDKs be installed on older version of Windows in a similar way to installing .NET 4.0 on Windows XP?Createdc snippet to help test byte orderI was not certain that setting 1 in the fReserved was the right thing to do. So I decided to test it.I tried the snippet.c in LSB machine and in a MSB machine.Linux X86:[felipe@wsfheidrichlnx motif]$ gcc -o t snippet.c [felipe@wsfheidrichlnx motif]$ file tt: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.32, not stripped[felipe@wsfheidrichlnx motif]$ ./tZero=0One=1-One=10x80=0Linux PowerPC:-sh-3.00$ gcc -o t snippet.c -sh-3.00$ file tt: ELF 32-bit MSB executable, PowerPC or cisco 4500, version 1 (SYSV), for GNU/Linux 2.2.5, dynamically linked (uses shared libs), not stripped-sh-3.00$ ./tZero=0One=0-One=10x80=1---Note that in a LSB machine one works fine (fMergeNeutralItems is set), on the MSB machine 0x80 sets fMergeNeutralItems.(In reply to)the fix would only affect runtimes where the bit exists, it was not mention in the doc (MSDN) when the bit was added so I assuming Windows Vista provided that the Windows Vista SDK was the first I saw that had the bit in the header file.Should we care about testing for byte order in this case ?There are places where we assume the runtime is LSB on windows already (and MSB for WinCE).I saw this code in GTK being used to detect byte order:byte[] buffer = new byte[1];int /*long*/ ptr = OS.malloc(4);OS.memmove(ptr, new int[]{1}, 4);OS.memmove(buffer, ptr, 1);OS.free(ptr);boolean bigendian = buffer[0] == 0;Do you know any other technique to set that new field in the struct ?Fixed:Note, one potential problem with this fix is that we will have less items but we will have bigger items, there is a known problem in Windows that when items are too big then will not draw.You can see this problem using your enhanced test case by replacing the line: "int max = r.nextInt(2000);" with "int max = 1024;"This fix causes.I removed this optimization.	24.0
id=210527	REOPENED	Platform	IDE	3.5	PC Windows XP	P3 normal	Eden Klein	2007-11-21 07:46 EST by	Sylvia Tancheva	2009-06-17 07:46 EDT (	3 users	1. Add a task2. Delete the line of code in the editor to which the task is attached to.Expected result: The task is deleted too.Actual result: The task remains and moves one line up (or down depending in which direction you delete the line of code)Note: Same happens with Bookmarks	Still relevant - changing version to 2.0.0Can't re-create with 2.1.0RC3. May be it was fixed.Fixed.Still the same.Probably eclipse bug?Ah... I see now, the task was creating using "Add Task". Yes, it's Eclipse Platform bug.	5.0
id=493687	REOPENED	Platform	Search	4.6	PC Linux	P3 normal	Sergey Prigogin	2016-05-13 22:58 EDT by	Sergey Prigogin	2017-01-23 10:07 EST (	6 users	Multi threaded file search allocates CPU resources too aggressively, which leads to starvation of the UI thread. In my testing reducing the number of allocated threads from Runtime.getRuntime().availableProcessors() to Runtime.getRuntime().availableProcessors() / 2 showed significant improvement in UI responsiveness without a significant slowdown of the search itself.	New Gerrit change created:Gerrit changewas merged to [master].Commit:Stefan, I saw you +1ed the Gerrit change - thanks. Please also set the review flag in this bug accordingly, as requested by Sergey. Thanks.-1 for such a change in RC2.Starvation of the UI thread was an issue. The solution for that would be to "availableProcessors() - 1"."availableProcessors() / 2" is likely to decrease performance much more. Since we don't have the necessary data to justify such a change, the right solution at this time is to only do minimal changes that target the actual problem. Further experiments can be done in 4.7.(In reply to Markus Keller from)+1 for the less aggressive change for RC2.I brought up the same suggestion in the code review and also with Sergey offline. Technically, I suggested using availableProcessors() - 2 in order to leave space for one other background operation. His response was that he had tested 6, 8, and 10 threads on a machine with 12 virtual cores (6 cores, with hyperthreading) and he had found that 6 threads produced the best performance.He did not send me his raw data, the details of his testing methodology, or his exact definition of "best performance" (I'm not sure if he was measuring end-to-end search time or time spent blocking the UI thread). But IMO experimentation trumps theory.If Sergey can attach more information about his testing here and we believe it to be sufficiently rigorous, I think we should go with the approach that performs better in the real world, not the approach we believe should work best in theory.I tested file search with different numbers of threads on a 6-core hyperthreaded Linux machine (availableProcessors() == 12). Since I ran file search repeatedly, the files were cached by the OS.I tried:1. availableProcessors()-2 - UI still slow to respond. No noticeable change of search time.2. availableProcessors()*2/3 - UI still slow to respond. No noticeable change of search time.3. availableProcessors()/2 - UI responding OK. No noticeable change of search time.Even if availableProcessors()/2 increases search time compared to availableProcessors() for cases when the files are not cached, UI responsiveness trumps the search speed.I currently can't comment on the sluggishness of the UI thread because I'm running in HiDPI mode on a 24Hz screen where everything has noticeable delays.But on my 4-core / 8-threads machine, changing the 8 threads to 4 increases the search time in the example I tested from 9s to almost 13s. With 6 threads: 10s. All searches ran repeatedly until results stabilized.I'm more interested in quick results.We have a rebuild today. Would be good to have a better fix for RC2, or revert.Sergey: it sounds like Markus' measurements, above, were more precise - and it looks like he observed a significant change in search time. If we're going to put this back, we should probably have a more accurate measurement of both the search time and UI latency (I'd guess we could measure the average latency by repeatedly posting asyncExecs on the UI thread and measuring the time between them getting scheduled and executing).I'm inclined to agree that we should roll this back.IMO, availableProcessors() - 2 is a safer default than availableProcessors() - 1 since there is often 1 background job running and the consequences of starving the UI thread are pretty bad.Note that this use of Jobs to create a compute pool should really be global. If there are multiple tasks trying to perform expensive parallel computations, they shouldn't each be allocating availableProcessors() jobs -- they should really be sharing a job pool. This suggests we need new API in the future. Something like the parallel for construct used in many concurrent libraries.New Gerrit change created:Gerrit changewas merged to [master].Commit:I've reverted the change since there's doubt from more than one committer and according to our endgame rules the change gets reverted until the committer agrees with a better fix.We can either find a fix that 3 committers (one being a component lead) accept for RC3, or move to 4.6.1.Markus:Wow, I can't imagine how bad that must be. I run on a 144Hz screen and find 60Hz frustrating to use. I don't think I could go a full day at 24Hz. What made you select that monitor?New Gerrit change created:(In reply to Stefan Xenos from)What makes you think so?You are completely ignoring the fact that the number of cores in Intel hyperthreaded CPUs is availableProcessors() / 2.Strongly disagree. Only implementation code has chance to know if certain activity is CPU or I/O bound. The optimal number of threads is number_of_cores / (IO_to_CPU_ratio + 1) - reserve, where reserve is 1 or 2.Absolutely, but that doesn't refute my suggestion at all. My point is that the number of concurrent CPU-bound tasks has a global upper-bound... and that global limit could easily be exceeded if we're only applying a bound locally.I agree that only the implementation knows whether an activity is CPU bound or I/O bound. However, only the scheduler (or some sort of singleton) can know the entire set of CPU-bound activities that are waiting to run. That's why we need a new API so that the implementation can inform the scheduler of which activities are CPU-bound and which aren't.We could easily add a new API for scheduling tasks that are known to be CPU-bound. Implementations wouldn't call it unless they know the task is CPU-bound, and by invoking this new API they would be informing the scheduler of this fact.Could you explain the derivation of that? From my understanding:1. You can have an unlimited number of threads waiting on mutexes or network I/O, since they have minimal runtime cost.2. You should only have one thread performing I/O on a given physical disk at any given time (to avoid thrashing).3. The maximum number of CPU-bound threads should be proportional to the number of cores (more discussion, below).That would mean there is no single optimal number of threads -- there would just be an optimal number of threads for a particular kind of operation, which again seems to suggest the need for new API so the implementation can classify the operation.rxjava does exactly this sort of classification for this same reason. Reference:(In reply to Stefan Xenos from)This is not true for SSD.The fact that he included numbers gave the impression that he had taken measurements rather than just evaluated the subjective experience. However, since neither of you described your testing methodology, I'm admittedly just making assumptions.If you both could include sufficient information for me to replicate your tests (say, in the form of a benchmark test case), it would eliminate the need for assumptions and be very convincing.The last time I tested CPU-bound payloads on an Intel CPU with hyperthreading, I got the same results Markus did - the end-to-end runtime improved until number of threads equalled the number of virtual cores - then it started degrading. There was no obvious change when the number of threads exceeded the number of physical cores. In the tests I did, hyperthreading was pretty much as good as having a real physical core.Now, that was 6 years ago and I was testing very floating-point-heavy workloads at the time so neither outcome would surprise me with these different tasks on modern CPUs... but in the absence of evidence to the contrary, my default assumption is that hyperthreading is not something that needs to be taken into account here.Good point. Thanks for the clarification. I/O which is performed on an SSD could be classified the same as network I/O and have an unlimited upper bound of threads.However, I don't think that's an argument against my main suggestion of adding API for scheduling CPU-bound workloads differently than other kinds of jobs.Another option might be to experiment with thread priorities here. I've never tried this in Java, but we might get good results by just setting the UI thread to have a higher priority to the threads in the computation job pool.(In reply to Stefan Xenos from)We should definitely experiment with thread priorities.Independently from the used API one of the problems we are facing is incomplete knowledge of the environment. We don't know if the CPU is hyperthreaded or not, we cannot tell HD from an SSD or NFS. We also don't know if the files are cached by the OS or not. Due to lack of complete knowledge we are unlikely to be able to hit the maximum possible performance without affecting UI responsiveness. We need to agree on the criteria for choosing the execution strategy, which is bound to be imperfect. I consider UI responsiveness to be higher priority than achieving top search performance. It should be OK to loose up to 30% of search performance as long as not doing so would jeopardize UI responsiveness.I think it depends on the degree of UI responsiveness. I'd say that we should be trying to keep UI latency (user gesture-to-photons) below 16ms. Dropping it below that makes no difference since most screens are 60hz.UI latency above 54ms should be considered a critical failure since that is the average time between characters for the world's fastest typists. At that point the UI would be lagging behind the input by a full character which makes cursor control difficult.So I'd say we should measure our UI latency and determine how much it costs us. If we're going from 8ms to 16ms, search time wins. If we're going from 16ms to 100ms, I don't think it matters how much the search time suffers - latency wins.Would that be acceptable criteria for everyone?If latency is in the 16ms to 54ms range, I think it's a value judgement that depends on how much search time we lose.FYI, I came up with this claim by googling "world's fastest typist" and "average word length English" and doing some math.Also check the memory usage of the file search that is going up rapidly every time I do the search. Memory is not released until I manually do a GC. It should go back down after each completed search. Perhaps this is related to unresponsive UI when swapping all the memory to disk.I usually give Eclipse 6GB of memory (from 16GB of all memory). But the file search is always filling the memory until max possible heap. Only then the memory is released.Set:-Xmx6144mAnd do couple of file searches. Memory goes only up until all the memory is not used.Search should be IO bound and not CPU bound right? Unless doing complex regex-es (with lookaheads).What's the state of this bug? 4.6.2 is closing down soon.(In reply to Dani Megert from)I see that as a reaction of this it got removed from 4.6.2. Can we still expect this for M4?Pushing can down the road.M5 is this week.	30.0
id=472377	REOPENED	Platform	SWT	4.4.2	PC Linux	P3 normal	Eric Williams	2015-07-10 09:55 EDT by	Eric Williams	2016-05-04 07:42 EDT (	6 users	Replacement patch for deprecated function gtk_widget_reparent().	New Gerrit change created:Gerrit changewas merged to [master].Commit:Thanks for the patch. Pushed to master.It appears that this patch has started causing build failures in the last few N-builds due to a crash in SWT (no conclusive proof yet but the failures started happening right after this commit).In order to confirm whether this really is causing the crashes or not, I've reverted the patch temporarily and we should know either ways after the test results from today's I-build.A sample stack trace from the crashing tests is below:Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)C [im-xim.so+0x3b04]Java frames: (J=compiled Java code, j=interpreted, Vv=VM code)j org.eclipse.swt.internal.gtk.OS._gtk_im_context_reset(J)V+0j org.eclipse.swt.internal.gtk.OS.gtk_im_context_reset(J)V+8j org.eclipse.swt.widgets.Control.releaseWidget()V+46j org.eclipse.swt.widgets.Composite.releaseWidget()V+1j org.eclipse.swt.widgets.Widget.release(Z)V+82j org.eclipse.swt.widgets.Control.release(Z)V+94j org.eclipse.swt.widgets.Composite.releaseChildren(Z)V+31j org.eclipse.swt.widgets.Widget.release(Z)V+38j org.eclipse.swt.widgets.Control.release(Z)V+94j org.eclipse.swt.widgets.Composite.releaseChildren(Z)V+31j org.eclipse.swt.widgets.Canvas.releaseChildren(Z)V+42j org.eclipse.swt.widgets.Widget.release(Z)V+38j org.eclipse.swt.widgets.Control.release(Z)V+94j org.eclipse.swt.widgets.Widget.dispose()V+23j org.eclipse.e4.ui.workbench.renderers.swt.SWTPartRenderer.disposeWidget(Lorg/eclipse/e4/ui/model/application/ui/MUIElement;)V+40j org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.safeRemoveGui(Lorg/eclipse/e4/ui/model/application/ui/MUIElement;)V+421j org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.access$1(Lorg/eclipse/e4/ui/internal/workbench/swt/PartRenderingEngine;Lorg/eclipse/e4/ui/model/application/ui/MUIElement;)V+2j org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$3.run()V+8J 3162 C1 org.eclipse.core.runtime.SafeRunner.run(Lorg/eclipse/core/runtime/ISafeRunnable;)V (38 bytes) @ 0x00007f6e8eef4454 [0x00007f6e8eef42a0+0x1b4]j org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.removeGui(Lorg/eclipse/e4/ui/model/application/ui/MUIElement;)V+9j org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.subscribeTopicToBeRendered(Lorg/osgi/service/event/Event;)V+180v ~StubRoutines::call_stubJ 4461 sun.reflect.NativeMethodAccessorImpl.invoke0(Ljava/lang/reflect/Method;Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object; (0 bytes) @ 0x00007f6e8f529c77 [0x00007f6e8f529c00+0x77]J 4460 C1 sun.reflect.NativeMethodAccessorImpl.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object; (104 bytes) @ 0x00007f6e8f3e37cc [0x00007f6e8f3e2640+0x118c]J 786 C1 sun.reflect.DelegatingMethodAccessorImpl.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object; (10 bytes) @ 0x00007f6e8ed06704 [0x00007f6e8ed06600+0x104]J 783 C1 java.lang.reflect.Method.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object; (62 bytes) @ 0x00007f6e8ed04004 [0x00007f6e8ed03c20+0x3e4]J 3964 C1 org.eclipse.e4.core.internal.di.MethodRequestor.execute()Ljava/lang/Object; (239 bytes) @ 0x00007f6e8ef52f64 [0x00007f6e8ef521e0+0xd84]j org.eclipse.e4.core.di.internal.extensions.EventObjectSupplier$DIEventHandler.handleEvent(Lorg/osgi/service/event/Event;)V+61J 4297 C1 org.eclipse.equinox.internal.event.EventHandlerWrapper.handleEvent(Lorg/osgi/service/event/Event;Ljava/security/Permission;)V (138 bytes) @ 0x00007f6e8f601964 [0x00007f6e8f601080+0x8e4]J 4295 C1 org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(Ljava/lang/Object;Ljava/lang/Object;ILjava/lang/Object;)V (19 bytes) @ 0x00007f6e8f60bd4c [0x00007f6e8f60b9e0+0x36c]J 3522 C2 org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(Ljava/util/Set;Lorg/eclipse/osgi/framework/eventmgr/EventDispatcher;ILjava/lang/Object;)V (69 bytes) @ 0x00007f6e8ed6e874 [0x00007f6e8ed6e620+0x254]J 3487 C1 org.eclipse.osgi.framework.eventmgr.ListenerQueue.dispatchEventSynchronous(ILjava/lang/Object;)V (81 bytes) @ 0x00007f6e8eb7222c [0x00007f6e8eb71a20+0x80c]J 3713 C1 org.eclipse.equinox.internal.event.EventAdminImpl.dispatchEvent(Lorg/osgi/service/event/Event;Z)V (219 bytes) @ 0x00007f6e8f0f0c24 [0x00007f6e8f0ef900+0x1324]J 3747 C1 org.eclipse.equinox.internal.event.EventComponent.sendEvent(Lorg/osgi/service/event/Event;)V (9 bytes) @ 0x00007f6e8ec8314c [0x00007f6e8ec83080+0xcc]J 3722 C1 org.eclipse.e4.ui.services.internal.events.EventBroker.send(Ljava/lang/String;Ljava/lang/Object;)Z (56 bytes) @ 0x00007f6e8f126b34 [0x00007f6e8f126700+0x434]J 3700 C1 org.eclipse.e4.ui.internal.workbench.UIEventPublisher.notifyChanged(Lorg/eclipse/emf/common/notify/Notification;)V (61 bytes) @ 0x00007f6e8ef90d64 [0x00007f6e8ef90180+0xbe4]J 2989 C1 org.eclipse.emf.common.notify.impl.BasicNotifierImpl.eNotify(Lorg/eclipse/emf/common/notify/Notification;)V (44 bytes) @ 0x00007f6e8eb961d4 [0x00007f6e8eb95ec0+0x314]j org.eclipse.e4.ui.model.application.ui.impl.UIElementImpl.setToBeRendered(Z)V+34j org.eclipse.ui.internal.WorkbenchWindow.populateStandardTrim(Lorg/eclipse/e4/ui/model/application/ui/basic/MTrimBar;)V+187j org.eclipse.ui.internal.WorkbenchWindow.populateBottomTrimContributions()V+19j org.eclipse.ui.internal.WorkbenchWindow.setup()V+532v ~StubRoutines::call_stubj sun.reflect.NativeMethodAccessorImpl.invoke0(Ljava/lang/reflect/Method;Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+0j sun.reflect.NativeMethodAccessorImpl.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+100J 786 C1 sun.reflect.DelegatingMethodAccessorImpl.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object; (10 bytes) @ 0x00007f6e8ed06704 [0x00007f6e8ed06600+0x104]J 783 C1 java.lang.reflect.Method.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object; (62 bytes) @ 0x00007f6e8ed04004 [0x00007f6e8ed03c20+0x3e4]J 3964 C1 org.eclipse.e4.core.internal.di.MethodRequestor.execute()Ljava/lang/Object; (239 bytes) @ 0x00007f6e8ef52f64 [0x00007f6e8ef521e0+0xd84]j org.eclipse.e4.core.internal.di.InjectorImpl.processAnnotated(Ljava/lang/Class;Ljava/lang/Object;Ljava/lang/Class;Lorg/eclipse/e4/core/di/suppliers/PrimaryObjectSupplier;Lorg/eclipse/e4/core/di/suppliers/PrimaryObjectSupplier;Ljava/util/ArrayList;)V+184j org.eclipse.e4.core.internal.di.InjectorImpl.inject(Ljava/lang/Object;Lorg/eclipse/e4/core/di/suppliers/PrimaryObjectSupplier;Lorg/eclipse/e4/core/di/suppliers/PrimaryObjectSupplier;)V+174j org.eclipse.e4.core.internal.di.InjectorImpl.inject(Ljava/lang/Object;Lorg/eclipse/e4/core/di/suppliers/PrimaryObjectSupplier;)V+4j org.eclipse.e4.core.contexts.ContextInjectionFactory.inject(Ljava/lang/Object;Lorg/eclipse/e4/core/contexts/IEclipseContext;)V+13j org.eclipse.ui.internal.Workbench.createWorkbenchWindow(Lorg/eclipse/core/runtime/IAdaptable;Lorg/eclipse/ui/IPerspectiveDescriptor;Lorg/eclipse/e4/ui/model/application/ui/basic/MWindow;Z)Lorg/eclipse/ui/IWorkbenchWindow;+139j org.eclipse.ui.internal.Workbench.getActiveWorkbenchWindow()Lorg/eclipse/ui/IWorkbenchWindow;+158j org.eclipse.ui.internal.services.WorkbenchSourceProvider.updateActiveShell(Ljava/util/Map;)V+58j org.eclipse.ui.internal.services.WorkbenchSourceProvider.getCurrentState()Ljava/util/Map;+10j org.eclipse.ui.internal.services.WorkbenchSourceProvider$6.handleEvent(Lorg/eclipse/swt/widgets/Event;)V+111j org.eclipse.swt.widgets.EventTable.sendEvent(Lorg/eclipse/swt/widgets/Event;)V+214j org.eclipse.swt.widgets.Display.filterEvent(Lorg/eclipse/swt/widgets/Event;)Z+22j org.eclipse.swt.widgets.Widget.sendEvent(Lorg/eclipse/swt/widgets/Event;)V+7j org.eclipse.swt.widgets.Widget.sendEvent(ILorg/eclipse/swt/widgets/Event;Z)V+73j org.eclipse.swt.widgets.Widget.sendEvent(I)V+4j org.eclipse.swt.widgets.Shell.filterProc(JJJ)J+139j org.eclipse.swt.widgets.Display.filterProc(JJJ)J+21v ~StubRoutines::call_stubj org.eclipse.swt.internal.gtk.OS._g_main_context_iteration(JZ)Z+0j org.eclipse.swt.internal.gtk.OS.g_main_context_iteration(JZ)Z+9j org.eclipse.swt.widgets.Display.readAndDispatch()Z+36j org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$4.run()V+626j org.eclipse.core.databinding.observable.Realm.runWithDefault(Lorg/eclipse/core/databinding/observable/Realm;Ljava/lang/Runnable;)V+12j org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(Lorg/eclipse/e4/ui/model/application/MApplicationElement;Lorg/eclipse/e4/core/contexts/IEclipseContext;)Ljava/lang/Object;+57j org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(Lorg/eclipse/e4/ui/model/application/MApplicationElement;)V+20j org.eclipse.ui.internal.Workbench$5.run()V+310j org.eclipse.core.databinding.observable.Realm.runWithDefault(Lorg/eclipse/core/databinding/observable/Realm;Ljava/lang/Runnable;)V+12j org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Lorg/eclipse/swt/widgets/Display;Lorg/eclipse/ui/application/WorkbenchAdvisor;)I+18j org.eclipse.ui.PlatformUI.createAndRunWorkbench(Lorg/eclipse/swt/widgets/Display;Lorg/eclipse/ui/application/WorkbenchAdvisor;)I+2j org.eclipse.ui.internal.ide.application.IDEApplication.start(Lorg/eclipse/equinox/app/IApplicationContext;)Ljava/lang/Object;+111j org.eclipse.test.UITestApplication.runApplication(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;+41j org.eclipse.test.UITestApplication.run(Ljava/lang/Object;)Ljava/lang/Object;+43j org.eclipse.test.UITestApplication.start(Lorg/eclipse/equinox/app/IApplicationContext;)Ljava/lang/Object;+36j org.eclipse.equinox.internal.app.EclipseAppHandle.run(Ljava/lang/Object;)Ljava/lang/Object;+135j org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(Ljava/lang/Object;)Ljava/lang/Object;+85j org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(Ljava/lang/Object;)Ljava/lang/Object;+82j org.eclipse.core.runtime.adaptor.EclipseStarter.run(Ljava/lang/Object;)Ljava/lang/Object;+109j org.eclipse.core.runtime.adaptor.EclipseStarter.run([Ljava/lang/String;Ljava/lang/Runnable;)Ljava/lang/Object;+132v ~StubRoutines::call_stubj sun.reflect.NativeMethodAccessorImpl.invoke0(Ljava/lang/reflect/Method;Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+0j sun.reflect.NativeMethodAccessorImpl.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+100j sun.reflect.DelegatingMethodAccessorImpl.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+6j java.lang.reflect.Method.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+56j org.eclipse.equinox.launcher.Main.invokeFramework([Ljava/lang/String;[Ljava/net/URL;)V+265j org.eclipse.equinox.launcher.Main.basicRun([Ljava/lang/String;)V+160j org.eclipse.equinox.launcher.Main.run([Ljava/lang/String;)I+4j org.eclipse.equinox.launcher.Main.main([Ljava/lang/String;)V+10j org.eclipse.core.launcher.Main.main([Ljava/lang/String;)V+1v ~StubRoutines::call_stub(In reply to Arun Thondapu from)Thank you for letting me know, I will investigate. Please let me know if you discover anything else.@ArunAny further info from the test results?(In reply to Eric Williams from)Hi Eric,Not sure if this really helps but as I mentioned in, it appears that we ran into this exact same crash earlier as well (see) and apparently that was also caused by changes in the same location (though the changes are not exactly the same).If you want to investigate further, one possible way to proceed would be to checkout the UI tests that started failing after this patch and run them in your local workspace and see whether the crash is reproducible or not...(In reply to Arun Thondapu from)Where can I find these UI tests?Arun, do you speak for? If yes, which one specifically ?Deferring it to 4.7 for the remaining work to be done	11.0
id=470515	REOPENED	Platform	SWT	4.4	PC Linux	P3 normal	Eric Williams	2015-06-18 14:13 EDT by	Leo Ufimtsev	2016-07-02 12:16 EDT (	2 users	But to replace the deprecated GtkCellRenderer background property. I have a feeling it might be causing some crashes and maybe drawing issues.I'll be working on this.	s/But/Bugthis bug is no longer relevant as it's already been addressed by CSS related color fixes.This code still runs in Tree/TableItem and will be fixed as part of.	3.0
id=486068	REOPENED	Platform	SWT	4.6	PC Linux	P3 normal	Eric Williams	2016-01-18 15:58 EST by	Eric Williams	2017-02-16 19:22 EST (	13 users	On Wayland, many of the following warnings are printed in the error console:(SWT:7396): Gtk-WARNING **: Allocating size to GtkFrame 0x7f3228a387f0 without calling gtk_widget_get_preferred_width/height(). How does the code know the size to allocate?This most likely stems from some sort of bug in the SWT sizing machinery that needs to be treated differently on Wayland.	Eric reproduced it on non wayland env. Seems to be related just to latest gtk builds.New Gerrit change created:Gerrit changewas merged to [master].Commit:Pushed to master.Still some allocation warnings in the console for GTK3.20. For example, this is printed when ControlExample runs:(SWT:9780): Gtk-CRITICAL **: gtk_box_gadget_distribute: assertion 'size >= 0' failed in GtkScrollbar(SWT:9780): Gtk-WARNING **: Negative content width -17 (allocation 1, extents 9x9) while allocating gadget (node entry, owner GtkEntry)(SWT:9780): Gtk-WARNING **: Negative content width -6 (allocation 1, extents 4x3) while allocating gadget (node toolbar, owner GtkToolbar)(SWT:9780): Gtk-WARNING **: Negative content width -6 (allocation 1, extents 4x3) while allocating gadget (node toolbar, owner GtkToolbar)(SWT:9780): Gtk-WARNING **: Negative content width -6 (allocation 1, extents 4x3) while allocating gadget (node toolbar, owner GtkToolbar)(SWT:9780): Gtk-WARNING **: Negative content width -6 (allocation 1, extents 4x3) while allocating gadget (node toolbar, owner GtkToolbar)(SWT:9780): Gtk-CRITICAL **: gtk_box_gadget_distribute: assertion 'size >= 0' failed in GtkScrollbar(SWT:9780): Gtk-CRITICAL **: gtk_box_gadget_distribute: assertion 'size >= 0' failed in GtkScrollbar(eog:25201): Gtk-WARNING **: Allocating size to EogStatusbar 0x5638078b8ce0 without calling gtk_widget_get_preferred_width/height(). How does the code know the size to allocate?These messages may also happen without running on Wayland (so you may consider this off topic) and this is what helped:export SWT_GTK3=0/opt/eclipse/eclipseaccording toThis also resolved long delays for dialogs showing up when browsing Windows -> Preferences.(In reply to Stefan from)In case you'll ever want to use the internal browser I suggest you don't use this workaround. Here's why:1. setting `SWT_GTK3=0` enforces SWT to use Gtk+ 2.x2. SWT with Gtk+ 2.x can run the internal web browser with WebKit1 only. Gtk+ 3.x can run either WebKit1 or WebKit2.3. Webkit1 is mostly unmaintained with dozens or hundreds of known security bugs.So you really only should continue using SWT with Gtk+ 2.x if you want to get hacked.***has been marked as a duplicate of this bug. ***	9.0
id=288997	REOPENED	Platform	UI	3.5.1	PC Windows XP	P3 normal	Francis Upton IV	2009-09-09 16:06 EDT by	Mark Melvin	2011-04-21 02:47 EDT (	1 user	User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/532.0 (KHTML, like Gecko) Chrome/3.0.195.17 Safari/532.0Build Identifier: I20090611-1540I have contributed content to the common navigator framework like so: <extension point="org.eclipse.ui.navigator.navigatorContent"> <navigatorContent id="my.content.id" name="My Content" contentProvider="com.company.MyContentProvider" labelProvider="com.company.MyLabelProvider" activeByDefault="true" icon="icons/some.gif" priority="normal" > <triggerPoints> <and> <instanceof value="org.eclipse.core.resources.IProject"/> <adapt type="org.eclipse.core.resources.IProject"> <test forcePluginActivation="true" property="org.eclipse.core.resources.projectNature" value="com.company.MyProjectNature"/> </adapt> </and> </triggerPoints> <possibleChildren> <instanceof value="com.company.model.IModelObject"/> </possibleChildren> </navigatorContent> </extension> <!-- Bind the build settings content extension to the viewer --> <extension point="org.eclipse.ui.navigator.viewer"> <viewerContentBinding viewerId="org.eclipse.ui.navigator.ProjectExplorer"> <includes> <contentExtension pattern="my.content.id" /> </includes> </viewerContentBinding> </extension>This all works fine, and my item shows up in my projects in the Project Explorer. Now, I want my item to behave like a regular IFile in the workspace, because it is really a model on top of an underlying file. I found that I got 99% of the way there by creating my own adapter factory like so: <extension point="org.eclipse.core.runtime.adapters"> <factory class="com.company.MyModelAdapterFactory" adaptableType="com.company.model.IModelObject"> <adapter type="org.eclipse.core.resources.IResource"/> <adapter type="org.eclipse.core.resources.IFile"/> <adapter type="org.eclipse.core.resources.mapping.ResourceMapping"/> </factory> </extension>And the class MyModelAdapterFactory is implemented as follows:public class MyModelAdapterFactory implements IAdapterFactory { /* (non-Javadoc) * @see org.eclipse.core.runtime.IAdapterFactory#getAdapter(java.lang.Object, java.lang.Class) */ public Object getAdapter(Object adaptableObject, Class adapterType) { IFile file = null; if (adaptableObject instanceof IModelObject) { file = ((IModelObject) adaptableObject).getFile(); } if (file != null) { if (IFile.class.equals(adapterType) || IResource.class.equals(adapterType)) { return file; } if (ResourceMapping.class.equals(adapterType)) { return new SimpleResourceMapping(file); } } return null; } /* (non-Javadoc) * @see org.eclipse.core.runtime.IAdapterFactory#getAdapterList() */ public Class[] getAdapterList() { return new Class[] { IFile.class, IResource.class, ResourceMapping.class }; }This all seems to work great. Now I get the appropriate Open actions on the context menu, Team menu items, etc. However, there seems to be a bug where right-clicking and selecting 'Open' will work, but double-clicking the item in the viewer does no trigger the 'Open' action. After a *lot* of debugging I have found that the implementation of org.eclipse.ui.internal.navigator.resources.actions.OpenActionProvider seems to be specific to instances of 'IFile's in one particular case, disabling the action. I don't think it has to be, and I think this is a bug. In particular, OpenActionProvider#fillActionBars does the following: public void fillActionBars(IActionBars theActionBars) { if (!contribute) { return; } IStructuredSelection selection = (IStructuredSelection) getContext() .getSelection(); if (selection.size() == 1 && selection.getFirstElement() instanceof IFile) { openFileAction.selectionChanged(selection); theActionBars.setGlobalActionHandler(ICommonActionConstants.OPEN, openFileAction); } }Why is it checking that selection.getFirstElement() is an instanceof IFile? The method below it (#addOpenWithMenu) seems to go through great pains to check all possible adaptations of the selection, while #fillActionBars does a simple check for instances of IFile. I believe they should both do the same thing. This is what is preventing my item from being opened when double-clicked. The selection is an instance of com.company.model.IModelObject, which is perfectly capable of adapting to IFile, but is never given the chance.If my understanding here is correct I can supply a patch. It looks like to work around this issue I'll have to duplicate the open action with my own implementation, I guess?Reproducible: AlwaysSteps to Reproduce:See above.	CreatedPatch fixing the issue as discussed.Here is a patch to HEAD fixing the issue (tested in my runtime workbench).CreatedNew, simpler patchThat first patch was kinda dumb and too complex.Now that I know more about the framework, this very simple patch fixes the issue.Patch looks good, this will go into 3.6M7Released to HEAD 3.6M7, would you mind verifying this on some I build that's on or after I20100425?It turned out the proposed patch causes a regression which is, so I have backed it out with the fix to that bug. We will have to consider a different solution in 3.7.Sorry it did not work out for this release.	5.0
id=309746	REOPENED	Platform	UI	3.6	PC Windows 7	P3 normal	Francis Upton IV	2010-04-19 18:07 EDT by	Susan McCourt	2010-11-30 13:56 EST (	2 users	While doing the build submission for I20100420-0800...Latest code from HEAD, Win7I saw this failure the first time I ran the navigator test suite. The second time I did not see this failure. (Incidentally, I get out of memory errors every time I run this suite but if I say "No" to closing the workbench, the tests still pass.)org.eclipse.ui.tests.navigator.SorterTest.testSorterContentOverridejunit.framework.ComparisonFailure: null expected:<[f1]> but was:<[BlueParent]> at junit.framework.Assert.assertEquals(Assert.java:81) at junit.framework.Assert.assertEquals(Assert.java:87) at org.eclipse.ui.tests.navigator.SorterTest.testSorterContentOverride(SorterTest.java:181) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at junit.framework.TestCase.runTest(TestCase.java:168) at junit.framework.TestCase.runBare(TestCase.java:134) at junit.framework.TestResult$1.protect(TestResult.java:110) at junit.framework.TestResult.runProtected(TestResult.java:128) at junit.framework.TestResult.run(TestResult.java:113) at junit.framework.TestCase.run(TestCase.java:124) at junit.framework.TestSuite.runTest(TestSuite.java:232) at junit.framework.TestSuite.run(TestSuite.java:227) at junit.framework.TestSuite.runTest(TestSuite.java:232) at junit.framework.TestSuite.run(TestSuite.java:227) at org.eclipse.jdt.internal.junit.runner.junit3.JUnit3TestReference.run(JUnit3TestReference.java:130) at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38) at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467) at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683) at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390) at org.eclipse.pde.internal.junit.runtime.RemotePluginTestRunner.main(RemotePluginTestRunner.java:62) at org.eclipse.pde.internal.junit.runtime.UITestApplication$1.run(UITestApplication.java:116) at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35) at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:134) at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4014) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3633) at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2582) at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2546) at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2395) at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:665) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:658) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:115) at org.eclipse.pde.internal.junit.runtime.UITestApplication.start(UITestApplication.java:47) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:369) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:619) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:574) at org.eclipse.equinox.launcher.Main.run(Main.java:1407) at org.eclipse.equinox.launcher.Main.main(Main.java:1383)	Today (submitting for I20100428-1300) the suite seemingly hung on testSorterContentOverride. I had already had two out of memory errors (but that is typical for me).Other instances from a nightly:testSorterContentOverride Failure null expected:<f[1]> but was:<f[2]>junit.framework.ComparisonFailure: null expected:<f[1]> but was:<f[2]>at org.eclipse.ui.tests.navigator.SorterTest.testSorterContentOverride(SorterTest.java:156)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:376)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:209)at org.eclipse.test.UITestApplication$3.run(UITestApplication.java:195)at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:134)at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3558)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3252)at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2601)at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2565)at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2399)at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:669)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:662)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:115)at org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:138)at org.eclipse.test.UITestApplication.run(UITestApplication.java:60)at org.eclipse.test.UITestApplication.start(UITestApplication.java:210)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:369)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:619)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:574)at org.eclipse.equinox.launcher.Main.run(Main.java:1407)at org.eclipse.equinox.launcher.Main.main(Main.java:1383)at org.eclipse.core.launcher.Main.main(Main.java:34)testSorterContentOverride Failure null expected:<f[1]> but was:<f[2]>junit.framework.ComparisonFailure: null expected:<f[1]> but was:<f[2]>at org.eclipse.ui.tests.navigator.SorterTest.testSorterContentOverride(SorterTest.java:156)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:376)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:209)at org.eclipse.test.UITestApplication$3.run(UITestApplication.java:195)at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:134)at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4041)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3660)at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2601)at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2565)at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2399)at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:669)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:662)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:115)at org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:138)at org.eclipse.test.UITestApplication.run(UITestApplication.java:60)at org.eclipse.test.UITestApplication.start(UITestApplication.java:210)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:369)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:619)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:574)at org.eclipse.equinox.launcher.Main.run(Main.java:1407)at org.eclipse.equinox.launcher.Main.main(Main.java:1383)at org.eclipse.core.launcher.Main.main(Main.java:34)CreatedFix for RC1Fixed the tests to be more flexible and robust about timingReleased to 3.6RC1Sigh...Still looks like there is more work to do.null expected:<f[1]> but was:<f[2]>junit.framework.ComparisonFailure: null expected:<f[1]> but was:<f[2]>at org.eclipse.ui.tests.navigator.SorterTest.testSorterContentOverride(SorterTest.java:164)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:376)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:209)at org.eclipse.test.UITestApplication$3.run(UITestApplication.java:195)at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:134)at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4041)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3660)at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2624)at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2588)at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2422)at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:670)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:663)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:115)at org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:138)at org.eclipse.test.UITestApplication.run(UITestApplication.java:60)at org.eclipse.test.UITestApplication.start(UITestApplication.java:210)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:369)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:619)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:574)at org.eclipse.equinox.launcher.Main.run(Main.java:1407)at org.eclipse.equinox.launcher.Main.main(Main.java:1383)at org.eclipse.core.launcher.Main.main(Main.java:34)Released another try (make the number of tries longer) to 3.6RC2So far the test has not failed since the fix.And again:testSorterContentOverride Failure null expected:<[f2]> but was:<[Bluefile5.txt]>junit.framework.ComparisonFailure: null expected:<[f2]> but was:<[Bluefile5.txt]>at org.eclipse.ui.tests.navigator.SorterTest.testSorterContentOverride(SorterTest.java:194)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:376)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:209)at org.eclipse.test.UITestApplication$3.run(UITestApplication.java:195)at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:134)at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4041)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3660)at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2629)at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2593)at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2427)at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:670)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:663)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:115)at org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:138)at org.eclipse.test.UITestApplication.run(UITestApplication.java:60)at org.eclipse.test.UITestApplication.start(UITestApplication.java:210)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:369)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:619)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:574)at org.eclipse.equinox.launcher.Main.run(Main.java:1407)at org.eclipse.equinox.launcher.Main.main(Main.java:1383)at org.eclipse.core.launcher.Main.main(Main.java:34)Another time:testSorterContentOverride Failure null expected:<[f2]> but was:<[Bluefile5.txt]>junit.framework.ComparisonFailure: null expected:<[f2]> but was:<[Bluefile5.txt]>at org.eclipse.ui.tests.navigator.SorterTest.testSorterContentOverride(SorterTest.java:194)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:376)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:209)at org.eclipse.test.UITestApplication$3.run(UITestApplication.java:195)at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:134)at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4041)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3660)at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2629)at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2593)at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2427)at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:670)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:663)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:115)at org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:138)at org.eclipse.test.UITestApplication.run(UITestApplication.java:60)at org.eclipse.test.UITestApplication.start(UITestApplication.java:210)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:369)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:619)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:574)at org.eclipse.equinox.launcher.Main.run(Main.java:1407)at org.eclipse.equinox.launcher.Main.main(Main.java:1383)at org.eclipse.core.launcher.Main.main(Main.java:34)Another instance:testSorterContentOverride Failure null expected:<[f2]> but was:<[Bluefile5.txt]>junit.framework.ComparisonFailure: null expected:<[f2]> but was:<[Bluefile5.txt]>at org.eclipse.ui.tests.navigator.SorterTest.testSorterContentOverride(SorterTest.java:194)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:376)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:209)at org.eclipse.test.UITestApplication$3.run(UITestApplication.java:195)at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:134)at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3527)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3174)at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2629)at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2593)at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2427)at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:670)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:663)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:115)at org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:138)at org.eclipse.test.UITestApplication.run(UITestApplication.java:60)at org.eclipse.test.UITestApplication.start(UITestApplication.java:210)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:369)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:619)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:574)at org.eclipse.equinox.launcher.Main.run(Main.java:1407)at org.eclipse.equinox.launcher.Main.main(Main.java:1383)at org.eclipse.core.launcher.Main.main(Main.java:34)Another time.testSorterContentOverride Failure null expected:<[f2]> but was:<[Bluefile5.txt]>junit.framework.ComparisonFailure: null expected:<[f2]> but was:<[Bluefile5.txt]>at org.eclipse.ui.tests.navigator.SorterTest.testSorterContentOverride(SorterTest.java:194)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:376)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:209)at org.eclipse.test.UITestApplication$3.run(UITestApplication.java:195)at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:134)at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4041)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3660)at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2629)at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2593)at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2427)at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:670)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:663)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:115)at org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:138)at org.eclipse.test.UITestApplication.run(UITestApplication.java:60)at org.eclipse.test.UITestApplication.start(UITestApplication.java:210)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:369)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:619)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:574)at org.eclipse.equinox.launcher.Main.run(Main.java:1407)at org.eclipse.equinox.launcher.Main.main(Main.java:1383)at org.eclipse.core.launcher.Main.main(Main.java:34)testSorterContentOverride Failure null expected:<f[1]> but was:<f[2]>junit.framework.ComparisonFailure: null expected:<f[1]> but was:<f[2]>at org.eclipse.ui.tests.navigator.SorterTest.testSorterContentOverride(SorterTest.java:168)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:377)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:210)at org.eclipse.test.UITestApplication$2.run(UITestApplication.java:197)at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:134)at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3513)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3162)at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2629)at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2593)at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2427)at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:670)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:663)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:115)at org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:140)at org.eclipse.test.UITestApplication.run(UITestApplication.java:62)at org.eclipse.test.UITestApplication.start(UITestApplication.java:212)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:369)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:621)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:576)at org.eclipse.equinox.launcher.Main.run(Main.java:1409)at org.eclipse.equinox.launcher.Main.main(Main.java:1385)at org.eclipse.core.launcher.Main.main(Main.java:34)Failed again in M20101124-0800.What's the value in the test that is known to intermittently fail? Can it be removed from the test suite until it is fixed?CreatedDisable failing testThe test failed again in N20101129-2000.I temporarily disabled the SorterTest#testSorterContentOverride() test in 3.7 and 3.6 streams.	16.0
id=234252	REOPENED	Platform	UI	3.4	All All	P3 major	Francis Upton IV	2008-05-27 17:18 EDT by	Francis Upton IV	2012-05-09 15:34 EDT (	9 users	Here is the description of how to fix it. This question gets asked over and over in the newsgroups:Should be a better way.See alsofor other magic required to make things work.	I filed this a while ago about the project icons, and then I discovered some more. For example the SaveAs dialog won't work because the image is missing. The problem is about half the images are loaded in the WorkbenchImages class and these are available to RCP applications that use the ui.ide plugin. But the other half of the images are in the IDEWorkbenchAdvisor which is in the ui.ide.application plugin and not available for RCP.The images that certainly need to move are: declareWorkbenchImage(ideBundle, IDEInternalWorkbenchImages.IMG_DLGBAN_SAVEAS_DLG, PATH_WIZBAN + "saveas_wiz.png", false); declareWorkbenchImage(ideBundle, IDE.SharedImages.IMG_OBJ_PROJECT, PATH_OBJECT + "prj_obj.gif", true); declareWorkbenchImage(ideBundle, IDE.SharedImages.IMG_OBJ_PROJECT_CLOSED, PATH_OBJECT + "cprj_obj.gif", true);However there are probably others; anything in the ui.ide plugin should work fine without using the ui.ide.application plugin.This is important enough to fix in 3.4.1, as it wastes a lot of time for RCP developers.My feeling is we should just move all of the images to WorkbenchImages (since the files are in the ui.ide plugin to begin with). It won't cause any performance penalty for the IDE case, and I bet that declaring another 30 or so images for RCP people will not get them upset.I'm happy to fix this however you decide.(In reply to)WorkbenchImages is in org.eclipse.ui.workbench, so we cannot just move the declareImage calls to WorkbenchImages if the image files are in org.eclipse.ui.ide.I don't know how we can fix this without introducing new API.(In reply to)But the actual image files are in ui.ide (unless they are somewhere else as well that I don't know about). Is there some case where we support using ui.workbench without ui.ide? As a practical matter you need ui.ide to do most things for RCP (certainly for resources). Why couldn't we just move the calls to declare the images over to the WorkbenchImages class? (Sorry if I'm being thick here)(In reply to)Yes, definitely! Not all RCP apps use resources. The whole point of the RCP split in 3.0 was to rid the base RCP feature of everything that smelled like IDE, such as core.resources, ui.ide etc.(In reply to)Still, since the images (loaded currently in WorkbenchImages) are defined in ui.ide, they are not going to be available to RCP apps who don't include that package in any case (unless these images are also somewhere else, but I did not see that). So I don't think there is harm (and there is substantial benefit) to do what I propose.This is a subset of, but not a duplicate as I would prefer this be kept separate.CreatedPatch to declare images in the correct placeAfter looking at this more, I realized the real problem.There are some images, declared in IDE.SharedImages (in ui.ide) that are not loaded if you just include ui.ide. This is because they are loaded in IDEWorkbenchAdvisor which is in ui.ide.application, and of course started only when you are running the IDE application.This is clearly a bug, the images in IDE.SharedImages should be available if you use ui.ide and not ui.ide.application.This patch splits those images from the IDEWorkbenchAdvisor startup and addes startup code to declare the ui.ide images in the correct place.This is an important bug because RCP developers who use resources and any of our navigators always have problems with the project icons which don't correctly appear. This corrects that.I tested this with an RCP application (that previously had to explicitly declare the images) as well as the IDE.Boris, can you have a look at this patch today or early tomorrow, as I would like to get it into 3.4.1. If there is a better place to put the startup code for the ui.ide plugin, I will revise the patch. Please look at the previous comment to this as it really explains the issue.Released to HEAD (3.5M2) and R3_4_maintenance (3.4.1)CreatedAdditional patch to handle not starting on the UI threadDani ran into this problem.(from Dani)Hi guys,the fix foris not OKas it assumes that start(BundleContext) is called in the UI thread.Unfortunately this is not true. The bundle is started the very first time aclass from it gets loaded. This can happen because some non-UI job orthread that references a class from the bundle is running . With the fixthis will now result in an invalid thread access.Danistart() should be lightweight and fast which is not the case when you post to the UI thread. Clients might only do some non-UI stuff (aka headless) which starts the IDE bundle because they use one of its classes but never do something in the UI. In fact the UI/workbench might not never be loaded (PlatformUI.isWorkbenchRunning() is false). We also had to protect JDT UI against such situations.In case of doubt simply check bugzilla for various instances where people broke Eclipse start up by putting UI code into the bundle/plugin start method. A prominent case where this can happen is when core starts the auto-build job faster than the workbench gets started.Dani, do you have a stack trace for the invalid thread access? I'd like to know where excatly we are accessing SWT (I thought the code is only creating a couple of ImageDescriptors and remembering them in a map).Well, you run into the problem that others did as well: the image registry - even though only storing descriptors at that point - wants a display. So, while in general you get an invalid thread access when accessing UI stuff, you actually get an NPE in this scenario.Thread (Suspended (exception NullPointerException)) owns: DefaultClassLoader (id=47) JFaceResources.getResources(Display) line: 207 ImageRegistry.<init>(Display) line: 155 ImageRegistry.<init>() line: 126 WorkbenchImages.initializeImageRegistry() line: 570 WorkbenchImages.getDescriptors() line: 471 WorkbenchImages.declareImage(String, ImageDescriptor, boolean) line: 458 IDEWorkbenchPlugin.declareWorkbenchImage(Bundle, String, String, boolean) line: 412 IDEWorkbenchPlugin.declareWorkbenchImages() line: 381 IDEWorkbenchPlugin.start(BundleContext) line: 360 BundleContextImpl$2.run() line: 1009 AccessController.doPrivileged(PrivilegedExceptionAction<T>) line: not available [native method] BundleContextImpl.startActivator(BundleActivator) line: 1003 BundleContextImpl.start() line: 984 BundleHost.startWorker(int) line: 344 BundleHost(AbstractBundle).start(int) line: 267 SecureAction.start(Bundle, int) line: 400 EclipseLazyStarter.postFindLocalClass(String, Class, ClasspathManager) line: 111 ClasspathManager.findLocalClass(String) line: 427 DefaultClassLoader.findLocalClass(String) line: 193 BundleLoader.findLocalClass(String) line: 368 SingleSourcePackage.loadClass(String) line: 33 BundleLoader.findClassInternal(String, boolean, ClassLoader) line: 441 BundleLoader.findClass(String, boolean) line: 397 BundleLoader.findClass(String) line: 385 DefaultClassLoader.loadClass(String, boolean) line: 87 DefaultClassLoader(ClassLoader).loadClass(String) line: 251 DefaultClassLoader(ClassLoader).loadClassInternal(String) line: 319 IDEApplication.start(IApplicationContext) line: 114 EclipseAppHandle.run(Object) line: 193 EclipseAppLauncher.runApplication(Object) line: 110 EclipseAppLauncher.start(Object) line: 79 EclipseStarter.run(Object) line: 386 EclipseStarter.run(String[], Runnable) line: 179 NativeMethodAccessorImpl.invoke0(Method, Object, Object[]) line: not available [native method] NativeMethodAccessorImpl.invoke(Object, Object[]) line: 39 DelegatingMethodAccessorImpl.invoke(Object, Object[]) line: 25 Method.invoke(Object, Object...) line: 585 Main.invokeFramework(String[], URL[]) line: 549 Main.basicRun(String[]) line: 504 Main.run(String[]) line: 1236 Main.main(String[]) line: 1212(In reply to)Dani, what do you recommend we do here? Is there a better place to load these images? I can add a check for PlatformUI.isWorkbenchRunning() (I assume it would be set by the time the ui.ide bundle started).Checking whether the wb is running is a bad idea because if another thread starts the bundle then you will end up with no images.Take a look at org.eclipse.jdt.internal.ui.JavaPluginImages.(In reply to)AgreedOk, this does it all in the static initialization, but how is that better than doing it in start()? I'm certainly happy to move it to be done in static initialization if that's the best answer.Two major differences:1. it's done when the registry is really needed i.e. the class loaded2. it does not crash when created in non-ui thread(In reply to)How are you sure that the static initializer is called on the UI thread? It seems that the constructor you use of ImageRegistry() requires that it be run on the UI thread. There must be something I don't understand here.We aren't. The code is written so that it can safely run in a non-UI thread. Take a closer look at the code (especially at fgAvoidSWTErrorMap).I don't see a simple solution to this problem. Let's back out of it for 3.4.1 and work on a solution for 3.5.Thanks Dani for catching this!Backed out of R3_4_maintenance (3.4.1)I think a simple way to solve this, in a nice general way is to exploit the fact that all image access goes through the shared images object (SharedImages). If this is the case, then the startup code can simply create a Runnable with the code to load the images, this Runnable can be given to the SharedImages so at the next image request, it can load all of the images. I'm also assuming that image requests from the SharedImages must be run on the UI thread. This mechanism could be used to simplify all image loading, for example the JavaPluginImages could be adapted to use this.Are my assumptions about this correct?Please also remove this from 3.5 until we have a working solution.I don't think you need a runnable and in fact it's not directly your patch that's not good but the underlying problem it surfaces: what you want to do on startup is to declare the image DESCRIPTORS using WorkbenchImages.declareImage(String, ImageDescriptor, boolean) - that's OK. Hence what we need to do is make that method safe when called from another thread i.e. allow to set and get descriptors from non-UI threads via WorkbenchImages and create the (shared) images when correctly requested via UI thread (as JavaPluginImages does). If WorkbenchImages would work that way, we would also not have seen:Backed out of HEAD(thanks Dani, I forgot about this)Paul, I know there was some discussion of shared images at the last UI call. Does it have any bearing on this issue? I would like to try and get this resolved for M6 if possible.(In reply to)We were looking into, how to declaratively access shared images.PW+1I just spent a few days trying to figure out why the Navigator view and the Project explorer view project icons were not showing. I followed instructions in this blog post to get them working in 3.6:Just wanted to provide a quicker way to find a workaround for this item by adding this comment.	30.0
id=199361	REOPENED	Platform	SWT	3.2	PC Linux-GTK	P3 normal	Bogdan Gheorghe	2007-08-09 02:04 EDT by	Hui Li	2012-11-01 10:54 EDT (	1 user	Build ID: M20060629-1905Steps To Reproduce:I want to check if it is highcontrast mode in gtk platform, but Display.getHighContrast() always return false, even if it is high contrast mode.The codes of Display.getHighContrast() in gtk:public boolean getHighContrast(){ checkDevice(); return false;}More information:	GTK has not concept of high contrast mode. Instead, the user picks a theme that has high contrast.We WONTFIX this. The only thing I can think of is to query theme names and check for a string match. This won't work when the user has a custom theme that is based on a high contrast one.Bogdan, is this still the case?PW	3.0
id=342100	REOPENED	e4	UI	unspecified	PC Windows XP	P3 critical	Bogdan Gheorghe	2011-04-06 23:40 EDT by	Bogdan Gheorghe	2011-04-08 10:30 EDT (	1 user	In order to allow the overriding of stylesheets, the engine should allow for external sylesheets to be imported via "@import url()".	CreatedPatchFixed in HEAD > 20110406My inner Eclipse has no styling whatsoever.Createdworkbench with strange lines and square tabsBogdan had a quick look, and said that this was related to having the e4 tools (like the model editor and live model editor) installed.Bogdan, is the theme extension in the model editor interfering with the SDK CSS themes?PWThe problem comes from the way the engine chooses which stylesheet to look at when applying styles. I need to fill out more of the CSS DOM interfaces to allow the engine to find all of the applicable stylesheets when calculating which styles to apply - currently, I was creating a new stylesheet with all of the includes and setting that as the one stylesheet to look at. (When another stylesheet comes along, say from the model editor, it would replace my initial stylesheet - which is why Remy and Paul's styling disappeared).Released a temporary fix for this while I work on the final fix.	5.0
id=52523	REOPENED	Platform	SWT	3.0	PC Windows XP	P3 normal	Grant Gayed	2004-02-19 13:54 EST by	Markus Keller	2012-11-21 10:57 EST (	0 users	The numbers below were taken from the same Text fText.It's strange that the client area is not shifted by the border width, but thecomputeTrim(..) is calculated with a border around the given rect.fText.getClientArea(); (org.eclipse.swt.graphics.Rectangle) Rectangle {0, 0, 303, 16}fText.getBorderWidth(); (int) 2fText.getBounds(); (org.eclipse.swt.graphics.Rectangle) Rectangle {104, 175, 307, 20}fText.computeTrim(106, 177, 303, 16); (org.eclipse.swt.graphics.Rectangle) Rectangle {104, 175, 307, 20}	I know what you're saying, but the current behaviour is correct.The trim (ie.- the border) is considered to be around the widget, not part of the widget, so when trim is shown the widget itself is slightly shrunk and shifted southeast to make it fit within the border. Since the client area is relative to the top-left of the widget, its x,y will always be 0,0 unless it is a child within a containment widget (eg.- a Tab in a TabFolder).computeTrim answers the space that would be needed once trim is added to a widget of a specified size. So in your example it answers a rectangle whose x,y are shifted northwest by 2 and width,height are increased by 4 in order to accomodate the border.I tested with the following snippet:public class Main {public static void main (String [] args) { Display display = new Display (); Color red = display.getSystemColor(SWT.COLOR_RED); Shell shell = new Shell (display); shell.setBounds(10,10,200,200); Text text = new Text(shell, SWT.MULTI | SWT.BORDER); text.setBounds(10,10,50,50); shell.open (); Rectangle client = text.getClientArea(); System.out.println("client: " + client); // uncommenting next line will start line too far southeast /* client.x += text.getBorderWidth(); client.y += text.getBorderWidth(); */ GC gc = new GC(text); gc.setForeground(red); gc.drawLine(client.x, client.y, client.x + client.width, client.y + client.height); gc.dispose(); System.out.println("border: " + text.getBorderWidth()); Rectangle bounds = text.getBounds(); System.out.println("bounds: " + bounds); System.out.println("trim: " + text.computeTrim(bounds.x,bounds.y,bounds.width,bounds.height)); while (!shell.isDisposed ()) { if (!display.readAndDispatch ()) display.sleep (); } display.dispose ();}}CreatedClientAreaTrimTestbed.javaThis problem has been itching me again, so I went and wrote a testbed to finally understand what's going on.At least I found that the Javadoc of Scrollable#computeTrim(..) is wrong. It talks about and links to getClientArea() so that it looks like computeTrim(..) is kind of an inverse function to getClientArea(), but this is only the case for some widgets. For Texts and Trees under WinXP, it's definitely not.To see this, e.g. launch the attached testbed, which paints some struts and crop marks to show the rectangle calculated by the strategy that's chosen on the right (press 1,2,3 to toggle). The implementation of the strategies is at the very end of the file.If the Javadoc of computeTrim(..) was right, the first and the second strategy would give the same results, but they don't.CreatedJavadoc fixSince I doubt that the implementation will be touched at this time, I wrote a fix for the Javadoc of Scrollable#computeTrim(..).revisit for 3.6Ping.	5.0
id=352667	REOPENED	Platform	UI	4.2	PC Windows XP	P3 normal	Bogdan Gheorghe	2011-07-20 15:48 EDT by	Kit Lo	2014-06-11 12:32 EDT (	4 users	CreatedEclipse 4.1 splashBuild ID: I20110719-2201- launch Eclipse with "-nl ar -dir rtl" options- splash screen displaying normally- after selecting a workspace from the Workspace Launcher dialog, 2 areas on the splash screen seem to be shifted	Created4.2M2 splashNew behavior in 4.2M2.Kit, in 4.2 we've just re-implemented the code to provide the 'progress' feedback (the bar itself and the name of the bundle being loaded).Bogdan, do you have time to take a look at this ?Moving to platform...Please review target milestone and bump to > 4.2 if appropriate.Kit, could you check this in M7 once it comes out ? I've just tried it here and don't see the effect any more...I'm going to mark this as FIXED...Kit, feel free to re-open this if you think there's still an issue.Created4.2M7 splashI tried 4.2M7 with Babel's Arabic Language Pack and launched Eclipse with -nl ar. There are still problems with the splash. Did I do anything wrong?reopenCreated3.8M7 splashJust as a control test, same environment, same command, the splash screen displays okay for 3.8M7.Bogdan, could you please take a look at this one ?Moving to 4.2.1Created4.3.1 splashProblem still exists in 4.3.1 M20130807-1400 build.Created4.4 splashProblem still exists in 4.4 RC3 build.	13.0
id=494565	REOPENED	Platform	SWT	4.6	PC Linux	P3 normal	Eric Williams	2016-05-25 11:47 EDT by	Markus Keller	2016-08-23 18:40 EDT (	4 users	Ubuntu 14.04, GTK 2 and GTK 3.10.8. Works fine on Windows 7.Snippet243 doesn't work on GTK because Text#insert(String) modifies the topIndex Steps:- launch Snippet243- enter text:123456789101112131415- press ArrowUp until the line "4" becomes the top visible line- modify line "6" to "66"=> expected: right text field should show line "4" on top=> was: line "66" on topAfter, get/setTopIndex(..) seem to work fine, but reseting the topIndex to the modified line on insert(..) is not OK.	This is a regression fromthat was actually fixed morning. It will land in RC3.*** This bug has been marked as a duplicate of***No, still happens with master:Looks like a regression from.The changes from gtk_text_view_scroll_mark_onscreen()to gtk_text_view_scroll_to_mark(..., true, 0, 0)were wrong, since they unconditionally set the topIndex to the line that contains the mark.I stand corrected: will investigate.(In reply to Markus Keller from)So I'm not actually sure this is the case. If I go back past the commit for this fix, the same behavior is exhibited. I.e. doing:Yields the bug: 66 ends up on top as well in the second text box. This doesn't happen on GTK2, though. I have a suspicion that this has something to do with row validation in GTK3.This issue is reproducible on Mars, as well as Mars.1/2.Eric, are you planning to work on this for 4.6.1? I'm changing the target to 4.6.2, please reset if necessary.(In reply to Arun Thondapu from)Correct -- in fact, this is still an issue for 4.7 so I'm going to set that as the milestone. This bug has been reproducible for awhile, back to Mars.	7.0
id=79216	REOPENED	Platform	SWT	3.1	PC Windows XP	P3 normal	Grant Gayed	2004-11-22 12:48 EST by	Platform-SWT-Inbox	2006-10-06 12:00 EDT (	2 users	on Windows, if you attach a dragdetect listener, you'll get one fewer selection event.In control example, go to the sash tab- attach mousedown, mouseup, and selection listeners.- press down and up on a sash.you'll get the following events:Selection: SelectionEvent{Sash {} time=604321406 data=null item=null detail=1 x=0 y=144 width=563 height=3 stateMask=0 doit=true}MouseDown: MouseEvent{Sash {} time=604321406 data=null button=1 stateMask=0 x=180 y=2}Selection: SelectionEvent{Sash {} time=604321484 data=null item=null detail=0 x=0 y=144 width=563 height=3 stateMask=0 doit=true}MouseUp: MouseEvent{Sash {} time=604321484 data=null button=1 stateMask=524288 x=180 y=2}Now attach a dragdetect listener, in addition to the ones above and again click on the sashYou'll get the following events:Selection: SelectionEvent{Sash {} time=604335578 data=null item=null detail=1 x=0 y=144 width=563 height=3 stateMask=0 doit=true}MouseDown: MouseEvent{Sash {} time=604335578 data=null button=1 stateMask=0 x=251 y=2}MouseUp: MouseEvent{Sash {} time=604335578 data=null button=1 stateMask=524288 x=251 y=2}Notice the second selection is missing. Gtk and motif record the same events as the first case whether dragdetect is attached or not.	A similar things happens for scale.With mousedown, mouseup and selection attached, click on the thumbYou'll get the following events:Selection: SelectionEvent{Scale {} time=608545937 data=null item=null detail=0 x=0 y=0 width=0 height=0 stateMask=0 doit=true}MouseDown: MouseEvent{Scale {} time=608545937 data=null button=1 stateMask=0 x=72 y=18}Selection: SelectionEvent{Scale {} time=608546046 data=null item=null detail=0 x=0 y=0 width=0 height=0 stateMask=0 doit=true}MouseUp: MouseEvent{Scale {} time=608546046 data=null button=1 stateMask=524288 x=72 y=18}If dragdetect is also attached, and the thumb clicked, you'll get the following events:Selection: SelectionEvent{Scale {} time=608591921 data=null item=null detail=0 x=0 y=0 width=0 height=0 stateMask=0 doit=true}Selection: SelectionEvent{Scale {} time=608591921 data=null item=null detail=0 x=0 y=0 width=0 height=0 stateMask=0 doit=true}MouseDown: MouseEvent{Scale {} time=608591921 data=null button=1 stateMask=0 x=72 y=17}MouseUp: MouseEvent{Scale {} time=608591921 data=null button=1 stateMask=524288 x=72 y=17}Though an event isn't lost, the order of events is switched.fixed > 20041217fake mouseup in Widget.wm_lbuttondown is now sent using OS.PostMessageThis caused.Grant to prioritize.I've verified that this is working now, it should have been marked as FIXED just before Christmas.I don't remember fixing this, especially for a sash ... and we put back the SendMessage() in WM_LBUTTONUP because this broke tool bars. Billy?I see the original problem again, and now cheese is left on the sash once the DragDetect has been hooked.Possible fix: On most widgets, this can easily be fixed by NOT using OS.DragDetect, but rather emulating the drag-detection from WM_LBUTTONDOWN/UP, WM_MOUSEMOVE and WM_KEYDOWN. In fact, this is fairly simple to do, since all that has to be done is detect WM_MOUSEMOVE outside of a GetSystemMetrix(SM_CX/YDRAG) box between a WM_LBUTTONDOWN and WM_LBUTTONUP/WM_KEYDOWN(wParam=VK_ESC), then send the dragdetect to the position where the WM_LBUTTONDOWN occurred.Two possible issues:1. I don't have WinCE, so I can't be sure, is the behavior there the same?2. Some widgets call DragDetect from the window proc, so some prevention may be in order there. Alternately, allow these to be handled as they are, since they use a completely overridden WM_LBUTTONDOWN anyway, and don't bare the same functionality as a Sash.	8.0
id=379581	REOPENED	Platform	UI	4.2	PC Windows XP	P3 major	Bogdan Gheorghe	2012-05-15 12:32 EDT by	Karen Butzke	2013-06-10 10:35 EDT (	6 users	I am using the Juno 4.2 M7 JEE package.Using Sleak I have found an Image leak in org.eclipse.e4.ui.workbench.renderers.swt.CTabRenderingYou can see the leak if you open and close the Java outline view several times. This shadow image is created each time you open the Java outline view and is not disposed when you close the view.The stack for the creation of the image is:java.lang.Error at org.eclipse.swt.graphics.Device.new_Object(Device.java:859) at org.eclipse.swt.graphics.Resource.init(Resource.java:86) at org.eclipse.swt.graphics.Image.<init>(Image.java:455) at org.eclipse.e4.ui.workbench.renderers.swt.CTabRendering.createShadow(CTabRendering.java:720) at org.eclipse.e4.ui.workbench.renderers.swt.CTabRendering.drawShadow(CTabRendering.java:650) at org.eclipse.e4.ui.workbench.renderers.swt.CTabRendering.drawTabBody(CTabRendering.java:326) at org.eclipse.e4.ui.workbench.renderers.swt.CTabRendering.draw(CTabRendering.java:163) at org.eclipse.swt.custom.CTabFolder.onPaint(CTabFolder.java:1915) at org.eclipse.swt.custom.CTabFolder$1.handleEvent(CTabFolder.java:276) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1077) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1062) at org.eclipse.swt.widgets.Composite.WM_PAINT(Composite.java:1564) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4585) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4989) at org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method) at org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:2545) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3756) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1017) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:911) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:86) at org.eclipse.ui.internal.Workbench$4.run(Workbench.java:582) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:537) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:353) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:180) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:629) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:584) at org.eclipse.equinox.launcher.Main.run(Main.java:1438)	I think the problem is recreate is true and the existing shadowImage is not disposed before creating another oneFixed:I also removed caching of those images via Display.E4_SHADOW_IMAGE as it was not used, was incorrect (only one last image would have being accessible and disposed), and made code more complicated.Karen, thank you for tracking this down!This still leaks. Calling setShadowColor() allows createShadow() to be called repeatedly even after shadowImage has been initialized (unlike in drawShadow() where it's guarded by a null check).As shown in the stack trace below, this can happen very frequently through the CSS engine just by changing focus. In our case, 4 images leak every time we expand a combo box in our main UI.Thread [main] (Suspended (breakpoint at line 875 in CTabRendering)) CTabRendering.setShadowColor(Color) line: 875 NativeMethodAccessorImpl.invoke0(Method, Object, Object[]) line: not available [native method] NativeMethodAccessorImpl.invoke(Object, Object[]) line: not available DelegatingMethodAccessorImpl.invoke(Object, Object[]) line: not available Method.invoke(Object, Object...) line: not available CSSPropertyShadowColorHandler.applyCSSProperty(Control, String, CSSValue, String, CSSEngine) line: 24 CSSPropertyShadowColorHandler(AbstractCSSPropertySWTHandler).applyCSSProperty(Object, String, CSSValue, String, CSSEngine) line: 39 CSSSWTEngineImpl(AbstractCSSEngine).applyCSSProperty(Object, String, CSSValue, String) line: 779 CSSSWTEngineImpl(AbstractCSSEngine).applyStyleDeclaration(Object, CSSStyleDeclaration, String) line: 551 CSSSWTEngineImpl(AbstractCSSEngine).applyStyles(Object, boolean, boolean) line: 457 CSSSWTEngineImpl(AbstractCSSEngine).applyStyles(Object, boolean) line: 405 ThemeEngine.applyStyles(Object, boolean) line: 498 PartRenderingEngine$10.setClassnameAndId(Object, String, String) line: 1207 WBWRenderer(SWTPartRenderer).setCSSInfo(MUIElement, Object) line: 85 WBWRenderer.styleStack(MPartStack, boolean) line: 176 WBWRenderer.trackActivePart(MPart) line: 145 GeneratedMethodAccessor29.invoke(Object, Object[]) line: not available DelegatingMethodAccessorImpl.invoke(Object, Object[]) line: not available Method.invoke(Object, Object...) line: not available MethodRequestor.execute() line: 56 ContextObjectSupplier$ContextInjectionListener.update(IEclipseContext, int, Object[]) line: 88 TrackableComputationExt.update(ContextChangeEvent) line: 107 EclipseContext.processScheduled(Set<Scheduled>) line: 328 EclipseContext.set(String, Object) line: 342 EclipseContext.activate() line: 625 ShellActivationListener$2.run() line: 120 SafeRunner.run(ISafeRunnable) line: 42 ShellActivationListener.activate(Shell) line: 117 ShellActivationListener.handleEvent(Event) line: 73 EventTable.sendEvent(Event) line: 84 Display.filterEvent(Event) line: 1262 Shell(Widget).sendEvent(Event) line: 1052 Shell(Widget).sendEvent(int, Event, boolean) line: 1077 Shell(Widget).sendEvent(int) line: 1058 Shell(Decorations).WM_ACTIVATE(int, int) line: 1664 Shell.WM_ACTIVATE(int, int) line: 2145 Shell(Control).windowProc(int, int, int, int) line: 4525 Shell(Canvas).windowProc(int, int, int, int) line: 341 Shell(Decorations).windowProc(int, int, int, int) line: 1627 Shell.windowProc(int, int, int, int) line: 2069 Display.windowProc(int, int, int, int) line: 4976 OS.SetFocus(int) line: not available [native method] Control.forceFocus() line: 1098 ...CreatedPatch for setShadowColorMarc is right - we leak images when if you call setShadowColor. Here is a patch to fix this.Reopening to deal with resource leak in setShadowColor.Also, I assume this should use a dispose listener to for the final disposal of shadowImage rather than overriding dispose().A dispose listener catches implicit cascading disposal of children by the native graphics system, while the dispose() override is only called when dispose() is explicitly called from java code. (ref: second half of Basic Widget Example here:)actually, nevermind that last comment. It's a renderer, not a widget, so that doesn't apply. my mistake! :)+1 for inclusion into Kepler RC3PW+1 Looks fine to me...In a test build I was just doing on my local machine, I saw many compile errors ... no idea if related to this fix ... or could have been poor timing as to when I started the build and some fix was only partially committed ... but, interested parties should seeand see if related. If thought to be related (and some fix needed) I can cancel the 8 PM build and restart it when ready. Otherwise, I'll just let it go and see what happens :)(In reply to)Just for the records: the fix got released into 4.3 RC3 with this change:Has this been back ported to 4.2.2+ ?(In reply to)No.	13.0
id=84532	REOPENED	Platform	SWT	3.1	PC Windows XP	P3 major	Grant Gayed	2005-02-06 21:32 EST by	Brock Janiczak	2015-06-18 10:43 EDT (	12 users	Version: 3.1.0Build id: I20050201-0800When focus is on the Browser based javadoc hover it will stay on top, even whenswitching applications. The only way to bring the hover down is to switch backto eclipse and click in the Java editor or press escape.1. Hover over a java element2. Give focus to the hover (F2)3. Switch to another application by clicking on it in the taskbar4. Observe the hover is still showing and is on top of all other windows	Tracked the problem down: our closer adds a focus listener to the Browserwidget. This listener is not triggered when we switch to another applicationi.e. we do not get a focusLost event and hence don't know that we have to removethe widget.This is a dup of the old "browser doesn't see events" bug that we are currently tearing our hair out over. The problem is that their is a hierarchy of native widgets inside the browser that SWT can't know anything about, hence we don't see events for them. We are working on it.This problem seems to have gone away for me in M6. Was this fixed?not gone for me in M6. last seen while implementing anonymous inner type:- the yellow popup popped up and held the focus even while the implementation-details-dialog popped up below. had to move the dialog to see at least the necessary elements - the obstinate popup disappeared first after a) closing the dialog and b) pressing escape.Daniel - can you still reproduce with M6? It works for me here.This has been fixed.I meant: it looks fixed for me.Not fixed - removing the workaround code from BrowserInformationControl will cause the behavior described in. The same code that works as expected for StyledText does not work for Browser. Compare SourceViewerInformationControl and BrowerInformationControl for the missing "focusLost" events from the Browser widget.Feel free to downgrade the severity, I left it at the original setting.***has been marked as a duplicate of this bug. ***Run into this today (3.5 M7 + Vista + IE8).Basically the browser will never notifies FocusListeners (focusGained / focusLost()).See attached snippet.CreatedSnippet to show issueShell has a Text and a Browser widget. The Text widget notifies the focus listener; the Browser does not.Createdbug workaroundWe have an html WYSWIG editor embedded into a browser wich its contents must be saved after the user focus out the browser.Then we noticed this focus notification problem.It can be easily worked around with the attacched piece of code wich is self explained.We would appreciate if the correction of this bug could also be done in Eclipse 3.7.Browser does not send focus events after using workaround code on Linux platform(Ubuntu 12.04 LTS)	15.0
id=123158	REOPENED	Platform	SWT	3.1	PC Windows XP	P3 critical	Grant Gayed	2006-01-09 16:21 EST by	Chris Grant	2008-11-20 09:15 EST (	5 users	We are running our RCP app as a 32-Bit application on a Windows x64 Edition, Version 2003, Service Pak 1.Our app runs, for the most part, but most of our dialogs and wizards have severe refreshing problems and many widgets will not draw. Resizing the window/wizard does not help, but updating a sash often helps. Spinner boxes are sometimes not drawn properly, or at all. 32-Bit applications are supposed to run on this operating system. The computer is a @XI running: AMD Athlon(tm) 64 X2 Dual, Core Processor 4400+, 2.21 Ghz, 2.0 GB of RAM. I have pictures to illustrate the problem and have whittled the problem down to a simple composite that can be placed in a Dialog or Wizard. I did not see where to enter it on a new bug report.	CreatedZip file with 4 pictures and java file to reproduce bug.The attached file is a zip file that has 4 pictures showing comparisons of how it should look (pic*_32.jpg) against how it looks with the OS we are using (pic*_64.jpg).Also in the zip file is the composite code that is used for pic pic1_32.jpg and pic2_64.jpg. The behavior in a dialog is Better than in a WizardDialog.(In reply to)Correction: Also in the zip file is the composite code that is used for pic pic1_32.jpg and pic1_64.jpg.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***To update, a fix has been released to HEAD that should fix this. Note that it will NOT be in this week's 3.4M2 milestone release, nor will it be in the upcoming 3.3.1 maintenance release, but WILL be in regular 3.4-stream builds as of next week. Marking this report as a duplicate of the original report that described similar symptoms ().To everyone on this report: The test case that was used to replicate thisproblem was running Logictech SetPoint with eclipse. Many of the reports thathave been dup'd tohad identical symptoms to what we saw but did notreport running with SetPoint. We're quite sure that these other cases do havethe same cause and solution as this problem, but if you get an eclipse3.4-stream build from next week or later and still see this problem then pleasereopen your original report.*** This bug has been marked as a duplicate of***ECLIPSE: I just posted a problem on the ECLIPSE newsgroups for SWT about Controls such as Buttons and ComboBox's not drawing their text properly in XP 64. I then searched futher and then found this bug and it turns out I was the original reporter of this. Where does this stand?Note I am still seeing problems with this. Please note the new picture I have attached and note the annotated redraw problems.thanks,ChrisCreatedAnnotated picture showing the redraw problem of Controls on XP 64.ECLIPSE: I just posted a problem on the ECLIPSE newsgroups for SWT about Controls such as Buttons and ComboBox's not drawing their text properly in XP 64. I then searched futher and then found this bug and it turns out I was the original reporter of this. Where does this stand?Note I am still seeing problems with this. Please note the new picture I have attached and note the annotated redraw problems.thanks,ChrisLike the bug says, we think it is fixed. What version of Eclipse are you running? If it is still happening in 3.4, then it's either the same bug back again (we didn't fix it) or a new and different bug.Sorry I did not specify the release. We are using Version 3.4.0, Build ID: I20080617-2000.So it still appears to be a problem.ChrisStill a problem in 3.4.	11.0
id=503431	REOPENED	Platform	SWT	3.4	PC Linux	P3 normal	Ian Pun	2016-10-04 11:45 EDT by	Ian Pun	2017-01-25 09:36 EST (	10 users	Run snippet 82 in eclipse.swt.snippets. Try switching around tabs; you will notice that there is a noticeable delay in between the switch.	Additional findings: switching between a hidden tab (selected through the chevron list) does not cause any sort of delay at all. There must be something that selection through the chevron list is not doing that selecting directly through the tab is.New Gerrit change created:(In reply to Eclipse Genie from)This bug was discussed on the SWT call. Feedback:1) We should take extra care with using context_iteration. It can change the order of events and potentially lead to crashes/NPEs. Ex:Can you verify that event ordering has not changed?Ex, - In ControlExample, you can add mouse listeners. Ensure that things like double-click, defaultSelection, Mouse-up, motion events occur in the same order as before.Is there a way we can get this to work without using context_iteration btw? If we check mouse state, do we still need context iteration?For both X11 and Wayland:2) Does Double click + Drag still work?3) Does DnD still work in CStyled text? I.e, can you drag bits of code around?4) Does tripple click work in Styled text? (select whole line?)5) The comment in the bug didn't get updated in patch set 2?(In reply to Leo Ufimtsev from)One also needs to test the DnD in the editors not just StyledText.(In reply to Leo Ufimtsev from)Everything has been tested and been working with the patch that I have made, thankfully. The patch is working as intended.Gerrit changewas merged to [master].Commit:Also tested on Gtk2/Gtk3. jUnit tests and DnDExample as well as child Eclipse seem to function well.Thank you for fix.If no major issues are reported, we should probably backport in a few weeks time.New Gerrit change created:Reverted patch for now due to report of DnD issue from AlexNew Gerrit change created:I've added a small patch that adds the additional gdk_threads_leave() call which seems to be used before every g_main_context_iteration() call. Tests seem to run fine on my machine, but I will leave it to Alex to see if it fixes his issue.Gerrit changewas merged to [master].Commit:Please retarget to M4 if there is a chance to complete in M4 time frameRetarget for M5 as there is patch for review in M4.New Gerrit change created:Gerrit changewas merged to [master].Commit:Ian, this broke Table/Tree MULTI selection DnD cause the mouse click on drag start is processed and selects single element only. Please let me know whether we should revert or you can come up with a patch for that fast.So multi selection DnD is broken on both X11 and wayland. If you test on wayland though you must work withor later commit as wayland uses cairo image surface not xlib.(In reply to Alexander Kurtakov from)Ill get to it now, Ill see if i can fix it ASAP without the need to revertNew Gerrit change created:Gerrit changewas merged to [master].Commit:CreatedPatch to get tree multiselection Dnd (not working currently)Alex, I have attached a patch that should give an outline to what I am trying to do. Currently, there is an issue with the compiler not seeing the selectionProc() method inside Display, even though I have put one there explicitly. The use of gtk_tree_selection_set_select_function() would be to set a function that just returns false, as we need it to decline any selections. Once we are on release event, it will check to see if it is in a condition to clear the other selections or not. THe logic seems sound, but the main thing is the implementation of GtkTreeSelectionFunc as one of the parameters. This is all seen within the release_event() and click_event() of Tree for a Proof of Concept.Comment onPatch to get tree multiselection Dnd (not working currently)forgot to push the widget changes that make this semi-workCreatedPatch to get tree multiselection Dnd (not working currently)New Gerrit change created:New Gerrit change created:New Gerrit change created:Gerrit changewas merged to [master].Commit:(In reply to Eclipse Genie from)Accidentally linked to wrong bug. This was is related to another bug:- Add test cases for Browser.evaluate() to browser test suite. (In reply to Eclipse Genie from)New Gerrit change created:	31.0
id=343569	REOPENED	Platform	Resources	3.7	PC All	P3 normal	James Blackburn	2011-04-21 11:32 EDT by	James Blackburn	2012-03-22 11:13 EDT (	2 users	basicBuild: private void basicBuild(int trigger, IncrementalProjectBuilder builder, Map<String,String> args, MultiStatus status, IProgressMonitor monitor) {Makes the current workspace ElementTree immutable in the finally, even though the build is in an operation. This may be ok for WS Rule builders. However for builders with relaxed scheduling rules, bad things may happen as another operation may be checked in & currently running in a beginUnprotected.	I think this would be fixed bywhere the tree is made mutable before relinquishing the WS lock when invoking the builder. (A new working tree is also already created when the top-level build operation ends.)InbuildManager creates a newWorkingTree() before releasing the WS lock.I'm reopening the bug since RC1 requirements were not fulfilled. SeeThe end-games rules are:1) +1 from another committer2) a patch attached reviewed by another committer(In reply to)This was an (likely rare) issue I noticed by inspection. The issue was fixed coincidentally as part ofwhich was reviewed.Sorry, I'm off till the end of the week, so maybe John will take a look at it earlier.(In reply to)I see. I would mention such details, especially during RCs. We also need a test. I talked to James and he will attach one soon.I have reviewed it.CreatedWIP fix + testIt was worth writing a test...With relaxed builders the bug exists since 3.6 and still in 3.7. BuildManager must ensure the working tree is open before beingUnprotected. We must also ensure the tree is not immutable before ending the top-level build operation from Project and Workspace build. Otherwise we'll get the attached exception and the test will fail.This issue has existed since 3.6, so it must be pretty rare that it hasn't been reported up till now.java.lang.RuntimeException: Illegal attempt to modify an immutable tree. at org.eclipse.core.internal.dtree.AbstractDataTree.handleImmutableTree(AbstractDataTree.java:248) at org.eclipse.core.internal.dtree.DeltaDataTree.createChild(DeltaDataTree.java:329) at org.eclipse.core.internal.watson.ElementTree.createElement(ElementTree.java:182) at org.eclipse.core.internal.resources.Workspace.createResource(Workspace.java:1369) at org.eclipse.core.internal.resources.Workspace.copyTree(Workspace.java:1094) at org.eclipse.core.internal.resources.Workspace.move(Workspace.java:2114) at org.eclipse.core.internal.resources.ResourceTree.movedFolderSubtree(ResourceTree.java:595) at org.eclipse.core.internal.resources.ResourceTree.standardMoveFolder(ResourceTree.java:1004) at org.eclipse.core.internal.resources.Resource.unprotectedMove(Resource.java:1966) at org.eclipse.core.internal.resources.Resource.move(Resource.java:1591) at org.eclipse.core.internal.resources.Resource.move(Resource.java:1559) at org.eclipse.core.tests.resources.regression.Bug_343569$3.run(Bug_343569.java:149) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)Createdfix + tests 2Both build & notification may close the tree. As the top level build has a begin and endOperation pair around the POST_BUILD notification, the tree needs to be made mutable both at end of build and end of notification (if other jobs are checked into the workspace). The test catches both these issues.I've moved the logic to #endOperation which can make the best decision about whether to leave the tree immutable, or open.As the bug wasn't fixed by 343256, pinging John for additional review + comment.Createdfix + tests 3Beef up test to test Workspace#buildInternal too.I like the approach but the change in endOperation worries me a bit this close to the release. I'm still trying to convince myself that is safe to reopen the tree in all cases where !depthOne. I'll review it again tomorrow.The comment in endOperation about tree.immutable() being unnecessary because of the notification manager cleanup isn't right.. if we got into the finally via an exception the notification may not have occurred.(In reply to)One way is to consider: as soon as workManager.checkout() is called the WS lock is released. At this point a pending operation blocked on WS lock begins and immediately calls newWorkingTree().The notification job is a good example, as it can exercise the full #beingOperation / #endOperation as a nested operation during the beingUnprotected of a build, or some other workspace job. As the NotifyJob always fires a resource change delta, the tree becomes immutable() / new...(). Given this, it's always safe for a newWorkingTree() to be opened while the lock is held in a nested operation.Really? #endOperation can only throw CoreException if core.resources is shutdown (and this doesn't call this finally). If it were to throw a RuntimeException or Error then there seem to be two issues: 1) it would mask any CoreException or OperationCanceledException thrown by the operation itself (as endOperation is always called from finally) 2) There's nothing to catch and log the runtime exception.AFAICS if #endOperation ever throws, then the workspace is broken and all bets are off. Am I missing something?Sigh. Inspecting the #immutable call-hierarchy, there's a similar problem in IncProjBuilder#getDelta().(In reply to)On a balance of risk, I'd be happy to wait for early 3.8 to fix this issue. I've never seen this exception reported and it's been around since 3.6AFAICS to provoke the issue the tree must be left closed during a #beginUnprotected in the middle of a nested operation. call-hierarchy shows that this would only interfere with a concurrent: delete() & move().(In reply to)I think the fix is probably good. But, considering the failure case is quite rare and this is changing some pretty fundamental code paths, I think waiting for early 3.8 is the better answer. This is the kind of change where I know my ability to predict bad side-effects is not high.On the subject of exceptions during endOperation: yes, if a RuntimeException or Error occurs in the finally block we're probably in bad shape. An Error thrown by a resource change listener is perhaps one of the few cases where we might be able to recover.	15.0
id=47354	REOPENED	JDT	Core	3.0	PC Windows 2000	P3 normal	Jay Arthanareeswaran	2003-11-24 10:51 EST by	Pascal Rapicault	2013-07-08 08:53 EDT (	9 users	To reproduce: Open the Type : ZipFileEntry from the class ZipFileYou will notice that the constructor ZipFileInputStream(long jzentry, ZipFile zf) has only two parameters and that the outline displays ZipFileInputStream(ZipFile, long, ZipFile).	Moving to JDT/Core. JDT/UI asks the method for its parameter types and names and render the returned values.***has been marked as a duplicate of this bug. ***That was the case in M4 as well. This is not something new.Synthetic parameter of the constructor should be hiddenPost 3.0The fix formakes this problem even worse. IMethod#getParameterNames() now returns the correct 2 names, but IMethod#getParameterTypes() still returns 3 types (including the synthetic parameter) and getNumberOfParameters() is also still 3. I fear this will lead to problems that could be avoided if synthetic arguments were completely hidden by the model.JLS3 13.1 says: "In addition the constructor of a non-private inner member class must be compiled such that it has as its first parameter, an additional implicit parameter representing the immediately enclosing instance".Consequently, IMethod#getParameterTypes() for a binary, non-private constructor of an inner class should not return the (synthetic) first parameter type.As of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.***has been marked as a duplicate of this bug. ***Reopening as the bug is still valid.Changing the version no. to the latest one.***has been marked as a duplicate of this bug. ***InI listed a few things where handling ofsynthetic args looked inconsistent to me.There are plenty of places where we are diligently keeping the synthetic parameter. Though I am yet to come across an instance where we are really using it, save the tests where we are trying look up methods using signature.At first glance looks like won't hurt to get rid of them from model classes. I don't see any API mentioned about this. Only that there is code in several places to include the synthetic parameter - all those have to be modified.Yes, getting rid of synthetic args from the model seems like a good plan, but I'm afraid this will cause quite a ripple effect, given how long it has been this way. E.g. just follow the chain of related bugs starting at.Should we schedule this for 4.3 M1 or so?Or maybe 4.4 M1 :)I think the last time we touched this wasand.Known workarounds in JDT UI (should both also work if the synthetic parameter is removed from all APIs, but I haven't verified this recently):- "syntheticParameterCorrection" in MethodProposalInfo#isSameMethodSignature(..)- "nParams" in JavaElementLabelComposer#appendMethodLabel(IMethod, long)	16.0
id=407333	REOPENED	PDE	UI	4.3	PC Windows 7	P3 normal	Ivan Furnadjiev	2013-05-06 16:20 EDT by	Curtis Windatt	2014-04-24 09:26 EDT (	4 users	From:We've run into this problem again on Ubuntu using an encrypted filesystem. It is caused by a limitation of ecryptfs [1], the default filesystem for encrypted home directories in Ubuntu. In this environment, you already get a "filename too long" for filenames that are about 150 chars long.I understand that this problem is not caused by Eclipse. I'm reopening this bug to point out this problem and suggest another improvement.Looking at the fix again, I think that the solution is not bullet proof: If a string with 200 chars contains 10 chars that need escaping, the result will be 230 chars, plus the prefix "TARGET_DEFINITION%58;" (21 chars) and the suffix ".profile" (8 chars), it's 259. If you could consider a solution that works with a fixed-length hash instead of an encoded URL, that would also be helpful in the case of an encrypted filesystem.[1]	Not worried about this for Kepler. Probably worth fixing in Luna. Would definitely appreciate a patch.This is not something I will have time for in Luna.CreatedProposed patchThis patch uses SHA-1 digest of memento in P2TargetUtils#getProfileId( ITargetHandle ).Tried out the patch. While I would prefer something human readable, it is fast and limited in characters.However, I ran into a number of errors saying that the profile folder was read only. This sounds similar to what was reported in, but the sheer amount of content on my drive that is marked read only makes me suspect something is wrong with my machine. I will give this another test some time in the new year and will apply the change if I see no more read-only errors.+1 merged with masterThank you for the contribution. Everything worked correctly this time around. The profile id stays consistent and p2 can retrieve it from the profile store.(In reply to Curtis Windatt from)Not really. 10 tests fail now:I've reverted the change as I don't have time to further investigate this.***has been marked as a duplicate of this bug. ***When passing the memento to p2, it is able to store it and do lookups without issue. However, it logs an error when trying to persist the profile to disk (assuming the name contains illegal filename characters). That error is not returned to the PDE target platform code.The hash must contain valid filename characters, digits would likely be the best choice.CreatedUpdated patch with byte array to hex string conversionAdded toHexString method for digest (byte array) to hex string conversion.(In reply to Ivan Furnadjiev from)Did you run the tests?(In reply to Dani Megert from)No.(In reply to Dani Megert from)Sorry for being so short in my answer on Friday, but I was in a move. I've tried to run the tests locally, but I had compile errors both in org.eclipse.pde.ui (TracingTab) and org.eclipse.pde.ui.tests (PerformanceTestCase). Do you have a verify build job in Gerrit that executes all tests for every uploaded patch set? Is it better to contribute this patch trough Gerrit?(In reply to Ivan Furnadjiev from)For the performance tests you need org.eclipse.test.performance, but the performance tests do not need to be run for this.No suggestions for TracingTab.I find gerrit easier to review with. A hudson build is started for gerrit changes, but the test suite is not run.Comment onUpdated patch with byte array to hex string conversionFinally, I've managed to run the tests locally. Mark the patch as obsolete as there are still some failing tests related to this change - memento scheme must be preserved, also "target" extension for "local" targets. It seems that the current implementation is also not correct - if memento.length is bigger than 200 the target extension will be cutoff and LocalTargetHandle#restoreHandle will fail in tests. Sorry for the trouble.	14.0
id=100267	REOPENED	JDT	Core	3.0.1	All All	P3 enhancement	Jay Arthanareeswaran	2005-06-15 14:42 EDT by	Dave Ruest	2011-12-02 00:10 EST (	7 users	Several types of changes do not notify the listener of the specific element that was modified. The listener only receives the modified class. Our plugin provides warning markers when elements with @generated have been modified. Without the specific element, we can only generate a warning for the class, and not also for the element as we would prefer.The cases where we would like to receive the specific element modified:1) modifying field initializer2) modifying method body3) modifying method throws clause4) changing parameter name	We provide fine grain deltas during reconcile operations. We do not provide more than a converted platform delta in case the file gotchanged as a result of regular resource changes.Providing a fine grain delta in all cases would require holding an entirepicture of the workspace before a change so as to tell how different it became.Please explain better your testcase, to see if there is more we can do to help.Closing since there was no responseThis would be helpful for all clients that compute and cache their own state based on an analysis of method content (e.g. for interprocedural analysis). Currently, they just get this change event:[Working copy] Try.java[*]: {CONTENT | FINE GRAINED}But when e.g. a local class is added (a structural change), then they get:[Working copy] Try.java[*]: {CHILDREN | FINE GRAINED | AST AFFECTED} Try[*]: {CHILDREN | FINE GRAINED} foo(String, int)[*]: {CHILDREN | FINE GRAINED} Local[+]: {}It would be nice if they could get a delta like this if the content of a method changed (but the method didn't change structurally):[Working copy] Try.java[*]: {CHILDREN | FINE GRAINED | AST AFFECTED} Try[*]: {CHILDREN | FINE GRAINED} foo(String, int)[*]: {FINE GRAINED}Since existing element delta listeners don't expect such events, I guess we need a new ElementChangedEvent constant so that clients can explicitly request the additional information, e.g. #FINE_GRAINED_CONTENT_CHANGE.(In reply to)Yes, I guess we have to live with that.(In reply to)Markus, what problem do you see with this?A.java[*]: {CHILDREN | FINE GRAINED | PRIMARY RESOURCE} A[*]: {CHILDREN | FINE GRAINED} foo(String, int)[*]: {CONTENT | FINE GRAINED}(In reply to)It breaks the contracts of IJavaElementDelta#F_CONTENT and #F_FINE_GRAINED. The latter is mentioned in the IJavaElementDelta Javadoc, where it talks about "structural changes". Changing that silently to also also include non-structural changes would be a breaking change.Furthermore, it can be a performance problem or just reveal other problems in existing listeners that don't expect these additional child elements in deltas.I don't know if this is a stupid question and I think I should have asked 'this' first.Why isn't a simple IJavaElementDelta#F_CONTENT enough to cover the cases mentioned in?e.g., A.java[*]: {CHILDREN | FINE GRAINED | PRIMARY RESOURCE} A[*]: {CHILDREN | FINE GRAINED} foo(String, int)[*]: {CONTENT}Since we can report the modified elements only when listeners are registered with a new flag, it will be OK to reuse the existing F_CONTENT and F_FINE_GRAINED flags. The Javadoc just has to tell about the additional meaning of the reused flags for ElementChangedEvent#FINE_GRAINED_CONTENT_CHANGE listeners.Since all changes below a CU currently have F_FINE_GRAINED set, I think it would be best to keep this. The Javadoc of F_FINE_GRAINED already tells that this flag doesn't indicate a change -- it just tells that the analysis has been made.Setting F_CONTENT to an element delta that doesn't have F_CHILDREN set would be OK, but it's redundant: The absence of F_CHILDREN and the fact that the delta node exists already tell that. Every F_CHILDREN change is also a content change.	7.0
id=406561	REOPENED	Platform	SWT	3.8.2	PC Linux-GTK	P3 normal	Grant Gayed	2013-04-25 10:09 EDT by	David North	2013-04-30 16:39 EDT (	1 user	CreatedEclipse project to reproduce the problemSummary: Browser crashes with SIGSEGV using Xulrunner 10.0b6Steps to reproduce:(1) Download 64 bit linux build of Eclipse 3.8.2:(2) Unpack the attached project and import into the workspace(3) Downloadand unpack so there's a 'xulrunner' directory at the root of the browser-test project(4) Run BrowserExample as a java application(5) JVM crash. I'll attach the hs_err_pid file shortly.It looks like the call to browser.setUrl causes the segv. I was under the impression () that I should be able to use Xulrunner 10 with Eclipse 3.8.2.	Createdhs_err_pid crash report from Oracle JVMXULRunner 10b6 is a beta release, which is not supported. Something likeshould work better.Closing report on the assumption that this will fix things for you. If the linked XULRunner still crashes for you then please re-open this report (and update the platform fields), thanks.(In reply to)Thanks, sorry for the confusion. Is there somewhere on the Eclipse wiki or similar that I could document this to avoid confusion?Unfortunately exactly the same crash occurs using 10.0.2 and the 10.0.4esr release.(In reply to)says alphas/betas are bad.Can reproduce this on Fedora 18, but it works fine on earlier distros, so it may not be an swt problem, more investigation is needed.	4.0
id=349697	REOPENED	JDT	Core	3.6.2	PC Windows XP	P3 major	Jay Arthanareeswaran	2011-06-17 11:29 EDT by	Missing name	2011-11-08 01:23 EST (	3 users	When Eclipse is started I get errors that compiler compliance level doesnt match the project facet.I have set compliance level in preferences manually to 1.5 and in project which doesnt override the settingit is showing compliance level 1.4(will attach screenshot).-- Configuration Details --Product: Eclipse SDK 3.6.2.v201102101200 (org.eclipse.sdk.ide)Installed Features: org.eclipse.jdt 3.6.2.r362_v20101117-0800-7z8XFW6FLFlmjJcvz03jyeFBLS_F	Createdscreenshot showing compiler compliance setting in project and global preferencesJay, please investigate.Horn, could you please check with 3.7RC5? Thanks.I tried with 3.7 RC4 and this is what I found. I set the global compliance level to 1.6, came back to the project with 1.5 code (generics) and set the compliance to 1.4. Obviously the code with 1.5 code shows errors. When I disabled the project specific settings, it still shows the compliance drop-down as 1.4, albeit deactivated. But this is only temporary and not a problem at all as the moment I click 'OK' or 'Apply' the code is recompiled and the errors go away.If I close the preference dialog and open again, it properly picks the values from the global settings.So, I don't think this is a bug. Please confirm.Found the same behavior on previous builds as well.This bug still happens in indigo.What Mr. Arthanareeswaran tested is not what I reported.I clearly stated that this happens at eclipse startup.No project properties had been edited at this point.I can manually override the defaults and the error will go away by checking the project setting checkbox and choosing 1.5 compliance.I can even uncheck this checkbox and the compliance level stays at 1.5but as soon as I restart eclipse and try to build the project the error will reappear.Even if it were what I reported this would be still a bug albeit only a cosmetical one.This dialog should show one of 2 states:with the checkbox off it should show global settingswith the checkbox on it show the current project settingsI don't see the reported behavior with 3.7.Moving to JDT/UI for confirmation and investigation if it's still an issue.CreatedWorkspace that will show the problemCreatedprefs file that triggers the problemI copied the attached prefs file from my problem workspace to a new test workspace(also attached) in order to reproduce the problem.My problem workspace has been migrated from Eclipse 3.6 to Eclipse 3.7.Thanks for the workspace. I still can't reproduce the problem, though. Can you please tell me what JRE you have on your environment and what is your default JRE or execution environment?I using the jre that comes with Websphere v6.1 in Rational Application Developer 7.0.0.10.The version string is the following:java version "1.5.0"Java(TM) 2 Runtime Environment, Standard Edition (build pwi32devifx-20110211a (SR12 FP3 +IZ94331))IBM J9 VM (build 2.3, J2RE 1.5.0 IBM J9 2.3 Windows XP x86-32 j9vmwi3223ifx-20101130 (JIT enabled)J9VM - 20101129_69669_lHdSMrJIT - 20100623_16197ifx1_r8GC - 20100211_AA)JCL - 20110208I am using Oracle JDK 1.6.0_25 to start Eclipse.Do you have all the plugins esp the WTP installed?***has been marked as a duplicate of this bug. ***	12.0
id=371508	REOPENED	JDT	Core	3.8	Macintosh Mac OS X - Carbon (unsup.)	P3 normal	Jay Arthanareeswaran	2012-02-14 11:15 EST by	Robert Krajewski	2012-03-12 08:12 EDT (	3 users	Build Identifier: M20110909-1335If you specify a value for a classpath variable (for examples, Preferences: Java/Build Build Path/Classpath Variables) that is a path to a very large directory, Eclipse appears to lock up with a Progress Information dialog that says “Setting classpath variables…”The path that a specified is a network volume; Activity Monitor shows that Eclipse is doing work and reading in a lot of data over the network. My guess is that's it's sweeping the entire directory for some reason.This used to not be a problem for me because I was using a local directory that contains only files applicable to the local platform; in this buggy case, I was using a larger repository that has files for all the platforms at our site.Reproducible: AlwaysSteps to Reproduce:1. Bring up the Preferences dialog, navigate to Java/Build Build Path/Classpath Variables.2. Hit the New… button. Name a new variable.3. Specify a path that contains a lot of files (probably more than 20,000 will do).	This only happens if an entry that incorporates a classpath variable ends up denoting a folder with a lot of files. For some reason, there was an entry in my classpath which consisted of the just the classpath variable. There was another that pointed to the specific that I wanted, in terms of the classpath variable. When I removed the first entry, Eclipse came back much faster.It would still be a good idea to address this issue, because this is an easy way to (apparently) lock up Eclipse.(In reply to)I'm trying to think of the alternative way in which this can be handled. If the classpath variables is a network volume, and there are a large no. of files on there, the slowness of the process may be limited by the speed of the network more than Eclipse's ability to read the classpath.Jay, do you know if we process the classpath differently based on whether its a local path or a network path?(In reply to)No, we don't.(In reply to)I didn't quite understand this. What is the first entry point to? And is the 'specific' location you are referring to, isn't it your network storage?I'll explain. Among the entries in the classpath wereLARGE_DIRandLARGE_DIR/some/specific/module/foo.jarI don't know why the first entry was there, but when I removed it, the problem went away.(In reply to)Thanks for clarifying!The network drive (folder) would have been added as an external folder, which requires the link folder to be created. Being larger in size and not locally present, it's understandable why it's slow. Another factor, which is unlikely in your use case, is the linked resource was being refreshed. Even forcing a refresh doesn't take much time for me. The network access must have been very slow.Anyway, since you said it works for you now, closing it.Robert, when you said this is a way to 'lock up' Eclipse, did you mean the UI is hung and you're unable to do anything? If the UI is otherwise responsive, its ok to leave it as it is, but if that's not the case, then maybe there is a way to set some timeout limit and give a JavaModelException when its crossed (Something like we do for fetching javadoc over the network, etc)Yes, the UI is locked up while showing the progress dialog (because it's refreshing/rebuilding). From the Mac OS X Force Quit Applications dialog (the one you get with Command+Option+Esc), it is noted as (not responding).Eclipse itself is definitely reading the directory (I was seeing network read speeds of 300-500 kb/s from Eclipse, and it was using a reasonable percentage – 7-10% – of the CPU). It was definitely busy and not waiting on the network (particularly). It's just that the large directory has a _lot_ of files.I suppose it would come back eventually, but I let it run for three or four minutes.I could reproduce the problem with the variable pointing to a folder with many jars.We probably may not be able to do anything, but I think we should atleast try to find out the real cause of the problem and then decide what we want to do with this. Hence, reopening.	9.0
id=375249	REOPENED	JDT	Core	3.7.2	PC Windows 7	P3 major	Jay Arthanareeswaran	2012-03-24 09:17 EDT by	Attila Csipak	2013-08-27 11:15 EDT (	12 users	I have to projects in eclipse, the former (A) depending on the second (B) through a jar built from project B with ant. I routinely rebuild project B with ant every day about a dozen of times, then refresh the project A's build path to make the changes visible in Eclipse.The problem is that now Eclipse marks the jar file invalid:"Archive for required library: B.jar in project A cannot be read or is not a valid ZIP file."The jar file in question is OK, if I use the same jar in our Jenkins environment to build project A, it builds without errors. This happened the second time this week. The last time I tried a number of things to fix the problem: clean & build my whole workspace, restart eclipse etc. Finally I removed my full workspace, including the .metadata directory within, then checked it out again from our SVN repository (losing most of my precious workspace settings in the process), which finally solved the problem. This makes me suspect that Eclipse misdiagnoses the jar file then caches the invalid status somewhere in .metadata and fails to fix the invalid status later.Please at least provide a workaround, for example: which part of the .metadata directory should I erase or modify to force eclipse to reconsider about the jar files in use?-- Configuration Details --Product: Eclipse 1.4.2.20120131-1457 (org.eclipse.epp.package.java.product)Installed Features: org.eclipse.jdt 3.7.2.v20120120-1414-7z8gFcuFMP7BW5XTz0jLTnz0l9B1	A similar (although incomplete) story I found googling earlier:Note that:- there's no "OK, that fixed it." post at the end of the thread,- also the proposed fix in Daniel's reply is admittedly a simple sanity check: "but if the original files are ok, the copy should be the same".So there's no trace of _that_ case being fixed.Just thought I post this, before I get a "worksforme" on my bug report...Created.metadata/.log partHere's a part of the .metadata/.log logfile. Looks like it all started with a simple FileNotFoundException (I guess the problematic jar file was being built while a refresh was in progress on the project depending on it).After that came a few "Invalid ZIP archive" messages.Next one is a Java Model Exception.The last message is another "Invalid ZIP archive".Identical "Invalid ZIP archive" messages also appear later on in the log (not present in this attachment).I guess I found a workaround (have to check it again when I run into this situation).1. Close Eclipse.2. Delete the following caches from the workspace:.metadata\.plugins\org.eclipse.jdt.core\invalidArchivesCache.metadata\.plugins\org.eclipse.jdt.core\nonChainingJarsCache(Deleting only the first one may work, I still have to verify this.)3. Start eclipse.4. Clean project depending on the problematic jar.Jay, please follow up, thanks.(In reply to)Yes, deleting the first one would have been enough. That said, it would be better to have the file-not-found scenario addressed. I will take a look at it.I believe this is same asand got fixed in 3.8 M3. The fix wasn't back-ported since it was an uncommon scenario. Could you please try with the 3.8 M6 build.This is same as.*** This bug has been marked as a duplicate of***(In reply to)I'm running into this very same problem when building a Grails project with Eclipse 3.7.2 and STS 2.9.1. However, when I clean the project, nothing happens and I still see the original Build Path Problem in the Problems view:Archive for required library: 'C:/Users/Mirko/.ivy2/cache/net.sf.ehcache/ehcache/poms/ehcache-1.7.1.pom' in project 'elect-admin' cannot be read or is not a valid ZIP fileThe supposedly broken JAR is an Ivy dependency, and all JARs listed in that POM look alright.Are there any other work-around steps I could try?(In reply to)You could try the one mentioned inand 5.Which build are you using, by the way?(In reply to)Hm... that's exactly the work-around that I tried, but unfortunately a subsequent "clean" does not do anything, i.e., I don't see any progress report about the clean actually being triggered.I'm using build M20120208-0800.(In reply to)I don't have an explanation for that. I am assuming you have 'Build automatically' enabled. Did you get a chance to try with 3.8M6, BTW?This doesn't seem to be a duplicate of, aswas a regression of another bug fixed around 3.8M3. As the changes were not on 3.7.2, this shouldn't have been a duplicate. Hence, reopening.At the same time, I couldn't reproduce the problem with 3.7.2 using steps inand. I could see the jar names in the file invalidArchivesCache. I just do a refresh and everything does seem to be set properly. Attila Csipak/Mirko Raner, Can you try to give us some reproducible test case?Sorry, I do not have a stable test case, althought the problem still occurs spontaneously since the original bug report. Sometimes it takes 2 weeks to reouccur, sometimes I get 2-3 cases the same day. It's not clear how the bug can be forced to happen.I also guess that initiating a workspace refresh, while an ant task building the problematic jar is still in progress may be the cause of the problem.(In reply to)Unfortunately, to recreate the problem you would need a rather complicated workspace set-up as well as several third-party plug-ins; our build process is pretty involved, unfortunately. In our particular case the problem occurs for building a Grails project that uses Ivy dependencies, but I'm afraid I can't easily reduce the problem to a simple test case.OK, I encountered it again, new details:1. The situation was the same as I described in, e.g. overlapping ant build and refresh.2. At first I didn't get "cannot be read or is not a valid ZIP file" error marking anywhere, but a java source file marked a couple of imports invalid because it didn't find the package of the imported classes. The strange thing was that while _in_ the editor all appearences of the affected classes were marked as errors, the file itself didn't get marked as erroneous, neither did it show up in package explorer, or in the Problems view. (Of course the affected classes were are residing in the problematic jar.)3. I nagged eclipse for a while to recognize the jar (rebuild, refresh etc.). The next strange thing came when I opened the referenced libraries node in package explorer, and tried to open the problematic jar's node, which wasn't possible. After a while, the usual "cannot be read or is not a valid ZIP file" showed up.4. I tried my own workaround recipe (), but it didn't help, so I started experimenting. What solved problem was (read before trying!):- exit Eclipse- delete .metadata\.plugins\org.eclipse.core.resources\.root\*.tree- start Eclipse, which throws a lot of errors, and an empty workspace- import all projects into the empty workspace... well maybe it would have been less radical to remove only the offending project(s), and re-import them.For what it's worth I see the same error for a library jar (inside project A, referenced by project B) that another developer on my team added and showed up in my workspace via a git operation. Restarting eclipse, deleting invalidArchivesCache and nonChainingJarsCache, cleaning the project don't solve it for me.In the absence of a test case, is anybody able and willing to allowJayaprakash to remote login ?(In reply to)Sorry, I would love to, but my employer wouldn't like it because we're working on pretty sensitive stuff (elections).I was wondering, though, if it would be possible to add some more detail to the generated error message. In my particular case (see), the allegedly broken ZIP is actually a POM file. So, if some code in JDT or M2E is indeed trying to open that .pom file as a ZIP archive, that would be clearly a bug. If it is referring to the ZIP file that corresponds to the POM the error message should state which ZIP file that is.(In reply to)That explains everything. Indeed, JDT tries to open the classpath entries as archives. And if the file can't be opened it marks that entry with an error. There were more discussion on this on another bug. Let me dig it up for you.This is the bug I was talking about -. The workaround is mentioned in.Srikanth, I think we should think of a new option to ignore this, like Dani mentioned, in SR1.That might be the case for Mirko, but mine is definitely an actual jar file, and from Attila's description his is too, so I think Mirko's is actually a separate issue from this one.This issue continues to reappear with different jar files and significantly impedes my workflow. Is anyone else who is affected using the eGit plugin?I'm still willing to allow Jayaprakash remote login to debug if he is willing.(In reply to)We won't add UI or new options in a service release.I experienced this today, I got around it by deleting the project within Eclipse (but not the contents) and then adding it again. All my previous settings were still stored and the error went away.I got some log information from Dave and noticed something wrong with the paths of some classpath entries. There were entries such as "/C:/Users/...". Note the preceding '/' and that in windows, we have '\' in absolute paths.But I don't see any evidence to say this is exactly what is causing the problem, because what Dave experienced on this particular occasion is not really the bug. It appears to be a genuine case of the JAR file not being present because of some resource change, such as git switch branch operation. However, the invalid paths might have played a role in the actual bug. Interestingly, the same classpath entry seem to be accessed with a proper paths, both relative and absolute paths, at various points of time. But in those case, we either have the relative path with the '/' or full path with "\" as expected. What I mentioned earlier seems to be a case of wrongly converting a path from absolute to relative, though at this point I am not sure where things go wrong.Further investigation might take some time, as I am busy with other work right now. However, if anyone is interested in looking at it and posting a patch, you are welcome.Thanks, Jay, for looking into the issue and the log I provided.For the case that occurred while the debug logging was enabled, I didn't verify that the file was actually present and valid (aside from a git status that didn't complain it was missing or modified). In previous cases where this issue has occurred I have manually checked that the file was present and valid, and every time I have checked it has been. I will keep debug logging enabled and the next time it happens do a manual check as well.I think the '/' versus '\' idea is an interesting one. The issue does seem to happen (at least sometimes) after switching git branches from a cygwin command line, so I wonder if there could be anything in play there.For anyone else who has encountered this issue, are you using cygwin and/or git?The issue happened again today after I switched from a git branch that did not contain the jar file in question to a git branch which does contain it. I verified this time that the file does exist in my file system, it is a valid archive file, and eclipse can see it in the Navigator view. Jay, I will email you the debug console log again in case that helps.I have since seen this occur a couple more times, but had one other interesting observation.One time that it happened, (when I made the previous comment), I was able to resolve the problem by editing removing the offending JAR from the build classpath, then adding it back again.Just now the issue occurred again, and removing the offending JAR from the build classpath then adding it back again does not resolve it. So it seems that some cases may be different than others.I just encountered this bug. Some here was using Eclipse 3.3.1.1 to create a project. They zipped the project up and sent it to me. I unzip the project and imported it into my workspace (Eclipse 3.7).When I tried to open the project I was getting this error.I opened the .project file in a text editor and found a <linkedResources> section. Inside this section was <name>, <type> and <location>. The <name> was the library generating the error message. The <type> was 1 and the <location> was a path to the jar file, including the jar file name, on my colleague's machine. I do not have this directory.If I close Eclipse, delete the <linkedResources> section, save the .project and restart Eclipse the problem goes away.Waiting for a reproducible test case does not sound like the winningstrategy for tackling this. I know at the moment everyone is busy, butat some point, we should invest some cycles to come up with various hypotheses and try to validate them - CCing other committers to seeif some one has a ready theory.This is happening to me as well or at least some flavor of it. The symptom seems to be that the jar file that my projects are dependent on is changed outside of Eclipse (via our build system that creates a new jar). The issue seems to go beyond Eclipse though as I cannot even open the new jar file on the file system (jar -tvf myapp.jar):java.util.zip.ZipException: error in opening zip fileIt is as though the file handle is somehow corrupted. Not sure if this is caused by Eclipse or if the Eclipse issue is a symptom of the file handle corruption. I am on Windows 7. Restarting Windows was the only way to resolve the file handle issue (so far).Ed's issue sounds like it may not be the same as this eclipse issue which happens even when the jar is completely accessible on the file system.(In reply to)Right, that doesn't look like an eclipse bug to me.The problem went away for me only after deleting (with eclipse closed):.metadata/.plugins/org.eclipse.jdt.core/externalLibsTimeStampsI had tried to delete these two earlier:.metadata/.plugins/org.eclipse.jdt.core/invalidArchivesCache.metadata/.plugins/org.eclipse.jdt.core/nonChainingJarsCacheBut just deleting those two didn't solve the problem.For the record, here was the specific message for me: MESSAGE Invalid ZIP archive: /home/steveo/.m2/repository/com/google/code/simple-spring-memcached/spymemcached/2.7.3/spymemcached-2.7.3.jarI checked permissions on the jar file (world readable) and tried jar -tf /home/steveo/.m2/repository/com/google/code/simple-spring-memcached/spymemcached/2.7.3/spymemcached-2.7.3.jarwhich is able to list the contents of the file.I found the files to try to delete using grep:$ ack-grep -a spymemBinary file .plugins/org.eclipse.jdt.core/externalLibsTimeStamps matchesBinary file .plugins/org.eclipse.jdt.core/nonChainingJarsCache matches...There were a couple other files that I didn't delete as well that match specific project files.	34.0
id=429264	REOPENED	JDT	Core	4.4	PC Linux	P3 normal	Jay Arthanareeswaran	2014-02-27 13:34 EST by	Stephan Herrmann	2016-04-05 04:32 EDT (	5 users	Fup of: Since we have a new kind of type variable that is created during type inference but survives type inference, we must be able to handle these downstream.This bug is intended for defining a string encoding that will be supported by methods of org.eclipse.jdt.core.Signature.As a reminder, these are the properties of a CaptureBinding18:- it has no source name- it has no wildcard- it may have upper bounds and/or a lower bound- it (now as of WIP in) has a stable captureID and also records the source position of the element that triggered type inferenceSemantically, it is a fresh new type variable invented by type inference.In first experiments I made it share the signature kind with "old" captures, but that has hardcoded the expectation that the next element in the signature is a capture :(	Did you mean to look at this for GA ? If the NPEs we saw are orthogonal tothis and this can wait, by all means let it move it out of GA. For thetime being, just so it stays in the radar setting to to BETA_JAVA8.(In reply to Srikanth Sankaran from)The NPE was caused by failure to compute a unique key. InI have a patch pending, that resolves the NPE, and produces a meaningful unique key, which the BindingKeyParser can actually understand.However, when releasing that patch we would trade the original NPE for this:java.lang.IndexOutOfBoundsException: Index: 0, Size: 0 at java.util.ArrayList.rangeCheck(ArrayList.java:638) at java.util.ArrayList.get(ArrayList.java:414) at org.eclipse.jdt.internal.core.util.KeyToSignature.consumeCapture(KeyToSignature.java:62) at org.eclipse.jdt.internal.core.util.BindingKeyParser.parseCapture18(BindingKeyParser.java:889) at org.eclipse.jdt.internal.core.util.BindingKeyParser.parseFullyQualifiedName(BindingKeyParser.java:707) at org.eclipse.jdt.internal.core.util.BindingKeyParser.parse(BindingKeyParser.java:628) at org.eclipse.jdt.internal.core.util.BindingKeyParser.parse(BindingKeyParser.java:622) at org.eclipse.jdt.internal.core.util.BindingKeyParser.parseTypeArgument(BindingKeyParser.java:991) at org.eclipse.jdt.internal.core.util.BindingKeyParser.parseParameterizedMethod(BindingKeyParser.java:770) at org.eclipse.jdt.internal.core.util.BindingKeyParser.parseMethod(BindingKeyParser.java:843) at org.eclipse.jdt.internal.core.util.BindingKeyParser.parse(BindingKeyParser.java:674) at org.eclipse.jdt.internal.core.util.BindingKeyParser.parse(BindingKeyParser.java:622) at org.eclipse.jdt.core.BindingKey.toSignature(BindingKey.java:334) at org.eclipse.jdt.internal.ui.viewsupport.JavaElementLabelComposer.appendMethodLabel(JavaElementLabelComposer.java:335) at org.eclipse.jdt.internal.ui.viewsupport.JavaElementLabelComposer.appendElementLabel(JavaElementLabelComposer.java:270) at org.eclipse.jdt.internal.ui.viewsupport.JavaElementLinks.getElementLabel(JavaElementLinks.java:667) at org.eclipse.jdt.internal.ui.viewsupport.JavaElementLinks.getElementLabel(JavaElementLinks.java:649) at org.eclipse.jdt.internal.ui.text.java.hover.JavadocHover.getInfoText(JavadocHover.java:741)AFAICS to fix this AIOOBE we need this bug fixed, i.e., add API to Signature.My guess is, that the implementation is the smaller part, but agreeing on the API would require a little discussion, where not all required participants may have the time right now.LMK if you see value in releasing the patch in the other bug as is. It may actually mend some cases, I don't know whether *all* clients of the BindingKeyParser actually need it also in its KeyToSignature guise.Sorry this came up so late in the cycle!Mh, let me see, if I can provide some kind of workaround for the AIOOBE, ... not sure ...(In reply to Stephan Herrmann from)For now I can advise KeyToSignature to simply render the CaptureBinding18 as "!*" meaning "capture-of ?", pretending we have a wildcard, where actually we don't. This finally makes a hover appear on the method in my tests: <?> Comparator<?> Comparator.naturalOrder()I'll shortly release that version of my patch via, allowing us more time for the API addition, OK?Alright, API addition can wait, I guess ...Before closing this bug, verify the points mentioned in.(In reply to Stephan Herrmann from)Mh, why did I say that? We already need PMC approval for API additions since we're past M6, right?So what do stakeholders of Java model & JDT/UI have to say about handling these new capture bindings in class Signature? Seefor summary.Correction:(In reply to Stephan Herrmann from)IIRC this should read"... that the next element in the signature is a wildcard"With the UI issues taken care of, I suggest we take this up early in 4.5.Unlikely for M3. Moving out.Whenis resolved, CaptureBinding18 will surface way much more thanit does today. As such that bug cannot be closed without resolving the presentone.I will subsume the current bug bywhich will comprehensively deal with all aspect of capture bound incorporation. I don't see a value in a loose leaf level task.*** This bug has been marked as a duplicate of***un-duplicating, sinceis not going to make it for M4.@Jay, can you take back this one?Let me restate the requirements again for my own understanding:1. We need to come up with a key to represent the new type variable, preferably a single character. I recommend the inverted exclamation - '¡'. Let me know if anyone has reasons against it.2. Amend the CaptureBinding18#computeUniqueKey() to encode the optional bounds.3. Amend the consumeCapture18ID() and the BindingKeyParser to include the bounds and update methods of Signature class to account for the new capture.4. Not sure yet, but we are going to need Signature#CAPTURE_TYPE_18_SIGNATURE, like the current CAPTURE_TYPE_SIGNATURE to differentiate the new kind and this may need changes in the UI - JavaElementLabelComposer.appendTypeSignatureLabel(IJavaElement, String, long)?Could be more, but don't know at this point.(In reply to Jay Arthanareeswaran from)I didn't even know that is an ascii character :), if 8bit ascii is OK, then it looks like a good choice.I forgot whether the uniqueKey needs to carry all information for re-creating a type binding or just for uniquely identifying?If its only about identifying, then the pair of sourceType x captureID might be all you need (actually captureID is still unique-per-IC18, but I guess we could make it per type or per CUD, if needed).If the uniqueKey must suffice to, e.g., render the type in the UI, then, yes, the upper & lower bounds must be encoded.I don't know either :)I hope the examples in linked bugs may serve for testing this (triggering creation of CaptureBinding18 isn't trivial :)). Let me know if you need more / other examples.(In reply to Stephan Herrmann from)Actually, it's not an ASCII. Problems?Looks like I need a closer look. Will do so and get back.Yep, they are very handy. In fact, I only have the ones you added (like 1f1c7c285f7f6d962c03df0c90855f08aed5d7d3) for now for testing. Could use more. TIA!(In reply to Jay Arthanareeswaran from)Ping! Could be a naive question, but must it be an ASCII?(In reply to Jay Arthanareeswaran from)Sorry, I was naively assuming that characters in this kind of encoding should be ASCII, but at a closer look I have nothing to back this assumption. Given that also the name parts of signatures admit arbitrary unicode any character with !Character.isJavaIdentifierStart(c) should be fine, I guess.If we use '¡' in signatures, do we want to use the same also in binding keys (currently '^')?(In reply to Stephan Herrmann from)There are two parts. We don't need to recreate the binding from the unique key. But, the UI requires we need to recreate the Java element from the signature. So, in effect, I think the unique key should carry the information we want to display in the UI, such as hover.(In reply to Jay Arthanareeswaran from)Sorry, this is incorrect. But ...... this still holds true.Sorry, couldn't complete this in time. Moving to M6.Stephan, one more question along with reminder for more use case I can test with:In the testcase you used in ASTConverter18Test#testBug425183a, what should the hover display for naturalOrder() ?public static <T extends Comparable<? super T>> Comparator<T> naturalOrder() { return null; }...Comparator<? super T> comparator = (Comparator<? super T>) Comparator.naturalOrder();At the moment, we show <?> Comparator<?> Comparator.naturalOrder()That's because the stopgap signature we have "!*" is being treated by the UI as wildcard.Sorry this hasn't got enough attention. I don't expect to get to this till the week after EclipseCon. I have a half-cooked patch, but not close enough to release. If I remember right, this will also need changes from UI. Perhaps, we can just make the API changes for the new key for M6 and take it up later?Let me know if someone is depending on this.(In reply to Jay Arthanareeswaran from)Moving to M7House keeping. Moving out of Mars.No progress yet and unlikely to get time during 4.6. Moving out.	23.0
id=490724	REOPENED	JDT	Core	4.4.1	PC Linux	P3 major	Jay Arthanareeswaran	2016-03-30 15:32 EDT by	Markus Keller	2016-07-11 09:09 EDT (	3 users	master, broken at least back to 4.4.1// compile with JavaSE-1.8:package p18;public class Klass<T> { class MethodInfo { } void addMethod(MethodInfo mi) { }}// compile with J2SE-1.3, in a project that has the above class on build path:package p13;public final class J13 { p18.Klass c; }Result:Error in /J13/src/p13/J13.java: The class file Klass<T> contains a signature '(Lp18/Klass<TT;>.MethodInfo;)V' ill-formed at position 17To debug, set a breakpoint at SignatureWrapper.computeEnd() line: 84with condition: toString().startsWith("(Lp18/Klass<TT;>.MethodInfo;)V")Analysis:The problem is that SignatureWrapper#computeEnd() assumes that type arguments in angle brackets always introduce the end of a type signature. It that were true, skipAngleContents(..) would work fine. But in this case, a nested type name follows. The compound type name is no longer a subsequence of the generic signature, but it picks multiple non-contiguous subsequences ("Klass", "MethodInfo").This bug cannot be resolved by a simple change in SignatureWrapper#computeEnd(). It will also need fixes in callers of that method. In this case in LookupEnvironment#getTypeFromTypeSignature(..).	This bug blocks compilation of 1.3 code against an upcoming version of the IBM Java SDK.(In reply to Markus Keller from)Hmm.. there are as many as 32 references to the SignatureWrapper in over a dozen distinct places. Some of them directly looking for '>'.Trying to understand the code and figured that we use the same instance of SignatureWrapper to extract type names over multiple iterations. We never alter the signature (of course) and wherever necessary, we simply ignore certain parts. For e.g. the generic information in our case. But looks like we might have to depart from that approach.Consider this case:(Lp18/Klass<TT;>.MethodInfo<Ljava/lang/String;>.InnerMethodInfo<Ljava/lang/String;>;)V @ 84Even if the computeEnd() scans beyond the '.' and returns the full type signature, we are having trouble further down with the java/lang/String because we try to split on'/'.Stephan/Markus, do you see any problem with completely getting rid of the generics information from the signature? For the above case, we would end up with:(Lp18/Klass.MethodInfo.InnerMethodInfo;)V @ 84New Gerrit change created:(In reply to Eclipse Genie from)So, I went ahead with that idea I spoke of (removing the generic information from the type name part of the signature) and posted the patch. But I still keep the type parameter upfront for resolution of method parameters, return type etc. I am more comfortable with this patch because this effectively applies the fix to all clients of SignatureWrapper. Touching the myriad uses of the said class seems like trouble to me. But like I said, it is possible I overlooked something, so please take a look at.All existing tests pass locally.The difficulty is with code that accesses the public field SignatureWrapper#signature. I made a pass over all references and didn't spot anything that would assume that the SignatureWrapper retains type arguments.I've fixed the name of the new method and cleaned up some Javadoc and implementation problems.Verified that the fix fixesand the original scenario from which I extracted that test case.Remaining TODO: Move the test into a compiler test.The ReconcilerTests#testBug490724() passes even without the fix in SignatureWrapper. This confirms what I see in the IDE: The reconciler doesn't report this problem. The reconciler is entirely source-based. But the compiler compiles against class files, and that's where we're getting in trouble.The difference is here, where the answer for the compiler is the binary type of p18/Klass, but the answer for the reconciler is a source type, and that one doesn't need to parse the signature from the class file:LookupEnvironment.askForType(PackageBinding, char[]) line: 180 PackageBinding.getTypeOrPackage(char[]) line: 201 MethodScope(Scope).getPackage(char[][]) line: 2879 QualifiedTypeReference.getTypeBinding(Scope) line: 97 QualifiedTypeReference(TypeReference).internalResolveType(Scope, int) line: 495 QualifiedTypeReference(TypeReference).resolveType(BlockScope, boolean, int) line: 586 QualifiedTypeReference(TypeReference).resolveType(BlockScope, boolean) line: 582 SourceTypeBinding.resolveTypeFor(FieldBinding) line: 1759 SourceTypeBinding.fields() line: 934 SourceTypeBinding.internalFaultInTypeForFieldsAndMethods() line: 903 SourceTypeBinding.faultInTypesForFieldsAndMethods() line: 899 CompilationUnitScope.faultInTypes() line: 448 Compiler.process(CompilationUnitDeclaration, int) line: 854 ProcessTaskManager.run() line: 141 Thread.run() line: 745(In reply to Markus Keller from)Thanks Markus, the changes look good to me.My bad. I assumed this was an issue in the reconciler as well since the original bug that introduced/surfaced this () had tests in reconciler. I will move the new test.Gerrit changewas merged to [master].Commit:Thanks Markus, I have released the fix now.This fix revealed another problem, see. Make sure any backport includes both changes.Verified for Neon M7 using I20160426-1615 build.	12.0
id=208482	REOPENED	JDT	APT	3.3	PC Windows XP	P3 normal	Generic inbox for the JDT-APT component	2007-11-01 16:53 EDT by	Yen Lu	2007-12-19 14:00 EST (	3 users	Build ID: 3.3Steps To Reproduce:If you register an annotations processor with a project, the .apt_generated subdirectory is automatically created and added to the project's build path. Our annotations processor doesn't need this directory. We would like to have APT create this directory only when needed or perhaps a flag to turn off the creation of this directory completelyMore information:	This behavior is by design, and by painful experience with the other alternatives :-)We have to create the directory at config time, because it is not possible to create it on the fly within a build due to limitations in what resources can be changed. We have no way of knowing ahead of time whether or not the various processors installed on a project may want to generate files.One possibility, I suppose, would be to have an option in the project preferences to disable file generation. If that option were specified (either through the GUI or programmatically) then no processor would be allowed to generate files - either calls to the Filer interface would throw an exception or they would return no-op writers - and we could remove the .apt_generated directory.I would personally prefer not to implement that, because every time we've changed this code it's eaten up at least a month of effort on my part and broken something else along the way. But if there is a compelling reason, this could be reopened.Can you explain in more detail why you'd like this directory to not exist? Is it causing a problem?Walter,Thank you for the quick response. We have an annotations processor implementation that will never generate any files. When we register them on plain Java projects, the existence of .apt_generated makes the project more complex that what our users would expect (it is hidden but still on the project classpath). Would it be possible to create some kind of property on the annotations processor which the framework could then query to determine whether or not to create .apt_generated?I think if you spend some time contemplating how you would implement such a property (keeping in mind that processors can change; that a project may acquire multiple processors over time; that loading a processor may have side effects; and that changing the classpath can only be done outside of the context of a build) you will discover that getting this to work right is not trivial.I would be willing to review a patch, if you would like to submit one. Please realize, though, that since past experience has shown that changing this code causes problems, considerable testing is required.Perhaps there is something I'm not understanding about the problem your users are facing? From what you've said so far this doesn't seem like the best use of development time: the additional complexity introduced by adding an optional directory to the classpath doesn't seem excessive to me, but I admit to being biased.We don't have the resources at this point to do justice to this feature. Resolving as "won't fix", pending a more clear business case for this feature, or external contribution of a patch.Please feel free to reopen this bug and supply more detail, or a patch, if you feel this prioritization is incorrect.Annotation processors are used for more than just generating files, can also be used for validation etc.Some customers with existing Java projects will get upset if adding validation functionality changes the structure of their projects.The decision as to whether to create the directory doesn't have to be done during the build, but at the time an annotations processor is added to the project. A new attribute could be added to the "factories" element of the org.eclipse.jdt.apt.core.annotationProcessorFactory extension point to indicate if the directory should be created. The default would be true in order to preserve backward compatibility. When an annotations processor is enabled on a project, the directory would be created only if the attribute was true. If a project has more than one processor, then the directory is created if the attribute for any of those processors is true.For annotation processors which are not provided through a plugin, the existing behavior would be unchanged.Reopening per John's comments and suggestions.	6.0
id=152000	REOPENED	JDT	Core	3.2	PC Windows 2000	P3 normal	Jay Arthanareeswaran	2006-07-27 10:21 EDT by	MH	2010-09-22 05:18 EDT (	2 users	I had this problems several versions before 3.2 and now after a longer period of 3.1, I installed 3.2 and this problem appears again: project A uses a JAR from project B. I introduce a new method in project B but forget to compile the new jar and copy it to project A's lib directory => project A shows red circle with compile error (this is as expected).To solve this error, I clean project B, recompile it and generate the JAR. Copy the JAR to project A, refresh the JAR file in the package explorer, clean project A ... the compile error keeps showing! No matter what refresh/recompile/clean I do, the compile error stays. When I restart eclipse the compile error finally goes away ...	I cannot reproduce this problem using 3.2 build (M20060629-1905) and current 3.3 integration build.Can you provide projects .classpath files and also describe more precisely how do you build your jar file (Export?) and how do you copy it (inside or outside eclipse )?Note that you can directly export your project B JAR file to project A while building it (this is the test I did to verify this issue)...In addition: I notice that the error markers vanish correctly in the package explorer (=> project is error free) but stay in the Java classes open editors (yes: red - not grey ghosted to indicate that the project needs to be recompiled). I copy the JARs with ANT script's that I have in Eclipses ANT view (to be able to stay independend of Eclipse and just have the ANT script to do all development things for a project).Using ANT scripts is in fact copying outside eclipse (there's no resources events corresponding to the changes you made on the files). Did you try to perform a refresh of your workspace after having copied your JAR file?The copy is not the problem - I do this since 3-4 years in Eclipse with the same ANT script. This problem with the error markers occured in Eclipse 3.2 and didn't happen in 3.1. It seems a problem in the editor markers - as I said the package explorer markers are correct.Sorry, I missed inthat you already did some refresh...Other questions to try to understand what happen here:1) is your editor dirty or saved when the markers didn't go away?2) do the markers always there if you close/reopen the editor? 3) do you have these markers in Problems view (I guess not but just to be sure)?As I cannot reproduce this problem, it would be really helpful to provide a detailed step-by-step scenario...Thanks1) saved2) yes - they vanish if I exit Eclipse and start it again3) I don't know - hadn't this effect today ...As this effect is quite annoying, I push this bug to keep it alive. And no, the errors don't appear in the problems view - just in the source editor.Does the problem still occur? Any more details on how to reproduce?Yes, it still occurs with latest Eclipse 3.3 - but only occasionally. When it appears, I still try to get it somehow fixed by clean up/refresh/rebuild all/update status, etc. but the only way I have found so far is to exit eclipse and start it again to get the error markers vanished. Sorry, no test case available.I suspect this is related to the reconciler.This has been improved in 3.5.Closing as WORKSFORME.Reopen if this still happens with 3.5.Verified for 3.6M1Unfortunately, this is still an issue! I upgraded to Eclipse Helios (Build id: 20100617-1415) several weeks ago. And today, this bug occured again: I have a Java Project with a referenced library. In another Java project, I changed the library by adding new public methods. After upgrading my first project by copying the new library to its referenced libraries, and using the new methods in a Java class, Eclipse marks those calls as red crosses ("The mothod ... is undefined for the type ..."). Nothing helped: I deleted all class files recompiled/cleaned/refreshed everything several times, closed Eclipse and startet again ... it still shows these errors even though my ANT task compiles the project with the new method calls without errors (and the application runs as expected with the new method functionality).It seems to be the same issue than... But as I said I can hardly reproduce when the editor is dirty, as soon as I save it or it was already saved or after having waited a while, the project refresh is enough to make the compiler errors vanishing.(In reply to)Sorry, you should read: than...I can hardly see any intersections betweenand this bug.I don't what what else to try. I deleted all classes, delete the JARs, recreated the JARs, restartet Eclipse, refreshed/cleaned, restarted Eclipse ... the error markes don't go away ... I also double checked if the Library with the new methods is referenced. Even the SVN icon text decorator shows the latest date of the JAR. The project classpath points to the correct JAR.I have found the problem: this automatic classpath "completion" from manifest files since the last Eclipse versions mess things up:1. in Project A (that still shows the error markers), the "Refernced Libraries" in the package explorer also shows a JAR that I don't added to this project and has a "(from Class-Path of xyz.jar)" behind the JAR-Name.2. The manifest.mf of the referenced JAR has a "Class-Path:" entry with several JARs. One of those JARs had the same classes (and package names) as my latest library JAR. (Reason: we changed the name of the JAR file to a new file name.) So there was a reference to an "old version" of a JAR with theold name.3. After I removed those references from the manifest Class-Path, the erro markers vanished.=> Eclipse adds JARs from referenced JAR manifests to the project's CLASSPATH! As you can question this and maybe make this optional, I don't like this behaviour as I explicitaly state in my Java Project what libraries are referenced.What's worse: even with this "automatic classpath extention from manifests", Eclipse _prefers_ those JARs from the manifest in favour of the explizit stated project CLASSPATH!!!So even you keep this automatic classpath extention from manifest Class-Paths, please prefer the referenced libraries from the project. Better: make this configurable, as I don't like this behaviour because you need to change a referenced JAR to avoid class collitions.I agree, even when there is a conflict, the explicitly added JARs should get the precedence. I think what we can do here is to make eclipse put the explicitly added entries ahead of the referenced entries.MH, can you try a small experiment to see if it helps in your case? Can you try reordering the classpath entries in such a way that the explicitly added conflicting JAR is ahead of the JAR that has the manifest references in the classpath?(In reply to)How could I do this? I have no control how Eclipse is adding the JARs of the referenced JAR's manifest Class-Path to the project's classpath!? ...(In reply to)What I meant was this: Let's say you have JAR a.jar that has the newer version of conflicting classes. And b.jar refers to c.jar and c.jar contains the older version of the conflicting classes. Yes, you can't do anything about the c.jar. But what you can do is, add a.jar ahead of b.jar in the classpath. This should ensure that a.jar is added just ahead of c.jar in the resolved classpath.Unfortunately, I can't find a pattern when this error appears. I was able to reproduce it by changing the manifest back to the old class-path: the error markers reappeared again. Then I found another JAR that also had the old JAR in its manifest's class-path. So I first cleaned up all old manifest class-path entries. The error markers vanished. Then I changed the manifest class-path of 1 jar back again to the old JAR and the error markers didn't reappear (did clean, compile). Moving the new JAR above below the JARs with the old manifest class-path didn't change anything. After typing this text here, I did a "clean" again and voila: the error markers reappeared! Then I moved the new JAR above the JAR with the old manifest class-path and the error markers didn't vanish (after clean/compile)!The "Referenced Libraries" did show the expected message "<old.jar> (from Class-Path of Other.jar)" butProject > Properties > Java Buiild PathandRun Configuration > Classpath both hat the new JAR above the JAR with the old manifest Class-Path.=> the order of the JARs doesn't change anything.Would it be possible to attach the affected workspace and project here? If it's too big, a stripped down version with .project, .classpath, the JARs and some of the sources that are affected would do. Thanks!My workspace is 365 MB ...(In reply to)I would only need a small workspace with the isolated problem. The workspace might just have the affected project with the JARs in question and perhaps with one or two source files using classes from the JARs.	23.0
id=506888	REOPENED	JDT	Core	4.7	PC Windows 7	P3 normal	Jay Arthanareeswaran	2016-11-02 07:08 EDT by	Dani Megert	2017-01-25 04:46 EST (	7 users	I20161027-0700.Unused @SuppressWarnings("incomplete-switch") is not reported.Paste the following code into the Package Explorer: @SuppressWarnings("incomplete-switch") public void test1() { } @SuppressWarnings("unused") public void test2() { }Everything looks good so far.Now, replace the org.eclipse.jdt.core.prefs settings file with the attached one. The warnings will now be errors (expected).Now set the 'Switch is missing default case' to 'Ignore'==> Bug: the first error is no longer shown.NOTE: The strange thing is that I can't reproduce by manually setting the unused suppressWarnings to 'Error'. There must be something in the settings that's causing this.	Createdjdt.core settingsSame with @SuppressWarnings("fallthrough") and switch case fall-through combination.The missing default error is grouped with incompleteEnumSwitch and in the attached pref file, it is set to "ignored". Looking at the code, if option is ignored, then the unused @SuppressWarnings("incomplete-switch") is not reported.This can be observed by manually by changing the option from ignored to warning.(In reply to Jay Arthanareeswaran from)And we agree that this is wrong, right?To be sure we speak of the same things:IProblem constants include: MissingEnumConstantCase MissingEnumConstantCaseDespiteDefault MissingEnumDefaultCase MissingDefaultCaseThese are grouped to irritants (publicly configurable options): case IProblem.MissingEnumConstantCase : case IProblem.MissingEnumConstantCaseDespiteDefault : return CompilerOptions.MissingEnumConstantCase; case IProblem.MissingDefaultCase : case IProblem.MissingEnumDefaultCase : return CompilerOptions.MissingDefaultCase;both irritants are mapped to the same warning token (for @SW): case MissingEnumConstantCase : case MissingDefaultCase : return "incomplete-switch";This follows our general strategy to reduce the number of options at each stage.What exactly should be wrong here?When we map the above to the CLI, things are a bit more convoluted: enumSwitch: OPTION_ReportIncompleteEnumSwitch irritant MissingEnumConstantCase enumSwitchPedantic: OPTION_ReportIncompleteEnumSwitch | OPTION_ReportMissingEnumCaseDespiteDefault irritant MissingEnumConstantCase + extra flag in CompilerOptions switchDefault: OPTION_ReportMissingDefaultCase irritant MissingDefaultCase Inconsistency: CLI can distinguish OPTION_ReportMissingEnumCaseDespiteDefault, which is not covered by any irritant / @SW-token (I do take blame for the convolution around 'enumSwitchPedantic' :-/, see also).Interestingly, CLI is more fine grained here than warning tokens.(In reply to Stephan Herrmann from)I am looking at this as a user and as such, looking at the empty #test1, @SuppressWarnings("incomplete-switch") is clearly unused. I'm not going to argue where the bug in JDT Core is or how a fix would look like ;-).What exactly is the user's expectation?Compiler perspective:- if you are interested in 'Switch is missing default case' then @SW("incomplete-switch") can be used to suppress individual warnings. Any unused @SW("incomplete-switch") will be flagged.- the same if 'Incomplete switch case on Enum' is enabled- if none of these options are enabled, the corresponding @SW token is pointless. Consequently, we cannot flag @SW("incomplete-switch") as unused because we simply didn't perform any analysis in this topic, so we don't know whether it would be used or unused when the option were enabled. Put differently: we don't want to report more warnings just because the user disabled a warning.(In reply to Stephan Herrmann from)If there's not going to be a warning what is the need to suppress it? Why do we want to differentiate between "absence of the culprit code" and "absence of the relevant option"?(In reply to Jay Arthanareeswaran from)Here's what Ed W. and Philipe discussed on these matters 9 years ago:On a technical level, the interaction between ProblemHandler.handle(), ProblemHandler.record() and CompilationUnitDeclaration.finalizeProblems() is not capable of detecting if a suppressed warning *would* be raised if it had been enabled, but isn't (disabled problems are never recorded).In particular for annotation-based null analysis, the current contract is: if you disable it, it should not run at all (e.g., to avoid bugs in the analysis). If it is not run, we cannot decide if @SW("null") is used or not.From a user's p.o.v. my understanding is: if I have @SW("something") in my code (for good reasons), and if for some other reason at some point in time I or s.o. else doesn't wan't to see *any* "something" problems in the code and therefore (temporarily?) disables that analysis, this person surely doesn't want to see lots of "unused @SW". In other context (=compiling with original compiler options) the @SW is still needed.As said: when disabling a warning results in more warnings being reported, users will be confused.However, I see the point that we miss a chance to get rid of @SW's that will never be used. Sounds like a trade-off to me, unless we invent '[ ] report unused @SW for problems that are not being analysed' (and how do you suppress this? sounds like the entrance to infinite recursion ... :p ).(In reply to Jay Arthanareeswaran from)+2.No user (that has no insights in our compiler) would expect that unused @SW depends on some other options. He just wants to see and most likely delete them.I'm not sure I exactly understand what you are requesting.We have two mechanisms for filtering problems: settings (E/W/I/I) and @SW. Can these two mechanisms be explained as a chain of two filters, one applied after the other? I hold that this would be the most intuitive way of precisely describing the semantics, but which one is first?If we first apply settings, then @SW analysis no longer sees problems that are dropped due to Ignore settings. Hence for disabled options we don't know which @SW is used / unused. Hence this bug.If, OTOH, we first apply @SW then we don't yet know if suppressing is allowed (because the problem might be configured as error and @SW may not be enabled for optional errors).It must be something different from filtering, because neither of the possible orders of filtering produce the outcome you want.Are you suggesting that an Ignore setting should *not* prevent the problem from being recorded? Should it make the problem only *invisible*?If so, we can check if any given @SW finds an actual problem (visible or invisible).A side effect of the proposed change seems to be: disabling an warning cannot shortcut the corresponding analysis. For annotation-based null analysis alone this would be a HUGE change. E.g., would compilation at 1.8+ NEVER be allowed to directly use class TypeSystem, ALL must go through AnnotatableTypeSystem. This could also result in performance problems, i.e., compilation pays the price for annotation-aware type checking even when type annotations are not used. Etc.(In reply to Stephan Herrmann from)I want that if a user has this code: @SuppressWarnings("incomplete-switch") public void test1() { }and enables to report unused @SuppressWarnings, that the expected problem is reported. Very simple. You still argue on the compiler level which is completely irrelevant for the user.(In reply to Dani Megert from)Do you only want us to solve this one single example?Voila: if (methodDecl.toString().equals("@SuppressWarnings(\"incomplete-switch\")\n"+ "public void test1() {\n" + "}\n")) report("Unused @SuppressWarnings");or is it allowed to discuss how the two related / conflicting features - problem settings (E/W/I/I) - @SuppressWarningsinteract in general?Seriously, I did my best to separate discussions about observable behaviour () and implementation concerns ().Much of my commenting aimed at showing that a naive implementation of the request will cause harm elsewhere. Should we deliver the naive implementation and wait for users to cry that we broke it??(In reply to Dani Megert from)Still puzzled where the misunderstanding may be rooted, I should state that I never intended to argue that keeping silent in this case is good. So please stop blaming me for ignoring a users' p.o.v.I only tried to explain, that the current behaviour is the result of intentional design 9 years back (), and that a better solution has to be based on understanding the rationale of that design - and then improving it.The existing design ensures that we don't get "unused @SW" on @SuppressWarnings("incomplete-switch") public void test2(SomeEnum e) { switch (e) { // incomplete list of cases } }*even* if the warning is already disabled via settings, and thus the @SW doesn't actually suppress anything.My starting point was to ensure that this design is not broken by fixing this current bug. And that turns out to be more involved than we would like - involved both conceptually and technically.Doesn't anybody agree that this discussion is necessary for designing a good fix here?(In reply to Stephan Herrmann from)I agree. Sorry for harping on the point about "from the programmer point of view", without getting the big picture.(In reply to Jay Arthanareeswaran from)Yes, I agree too :-). I just wasn't sure whether you agree that the reported issue needs a fix.Ok, back to the drawing board :)I believe one root of confusion is the mismatch between "SuppressWarnings" and how we handle it:Strictly speaking the compiler detects "problems". Problems only turn into warnings, if so configured in the settings.We departed from a strict interpretation of SuppressWarnings when the option to suppress optional *errors* using SuppressWarnings was introduced.Next, we silently extended the semantics to suppressing "Info" problems.could have extended this further to support @SW for "Ingore" problems.Hadbeen implemented in this way, then an @SW on a detected but disabled problem would indeed still be "used".Instead, Philipe decided to just avoid checking if a @SW is used or not when a corresponding irritant is set to Ignore (to avoid false positives for the price of false negatives).I *would* love to propose the following resolution:- decide that we interpret @SW indeed as "suppress problem" (no matter if the problem is an error, warning, info or ignored).- to emphasize the above, perhaps we should reverse the option "Suppress optional errors with '@SuppressWarnings'" to s.t. like "Make optional errors unsuppressable" (default enabled) this would harmonize with the notion that *all optional problems* can be suppressed - unless stated otherwise. - agree that suppressing an ignored problem is a relevant use of @SW.Unfortunately, Idoubt that we can afford this solution in full size. Here I explicitly mean implementation concerns, so I will stop arguing for now :)As an alternative resolution I *do* propose to introduce a new "Info" problem , when we detect:- @SW("foo") is declared- (some) problems in category "foo" are set to Ignore.We could say s.t. like: Problems of category "foo" are not analysed (due to compiler settings ...)If a user decides that the current compiler settings are mandatory for everybody, then @SW can be removed. Otherwise she can temporarily enable the corresponding problem and see if @SW is then used or unused.(In reply to Stephan Herrmann from)I like this. I can offer to work on this unless Stephan already has a prototype or something :)(In reply to Jay Arthanareeswaran from)Go ahead :)I haven't prepared any code changes.According toyou were already looking at the exact code location that this proposal is meant for.(In reply to Jay Arthanareeswaran from)I like the direction too, but the message must clearly mention which option(s) need to be enabled. Two Quick Fixes could be offered to remove the @SW and to enable the problem(s).New Gerrit change created:(In reply to Eclipse Genie from)This is the simplest possible patch. Unfortunately, this doesn't tell the user which option needs to be enabled. What I am not sure is, what exactly do we tell the user about the option? The option description in the UI (which jdt.core is not aware of) or the option name, for e.g., org.eclipse.jdt.core.compiler.problem.uncheckedTypeOperation, which the user probably has no clue about?What the fix could still do (but doesn't yet) is to pass the option ID as problem argument, which would be used by the second quick fix that Dani mentioned.(In reply to Jay Arthanareeswaran from)We do have a link from the problem (ID) to the UI option. For example, we mark the option in the UI when the user wants to configure it via problem hover.Another problem I ran into while testing is this: The reporting of unused SuppressWarning is also grouped with the other "unused" problems categories. This means that the conditions to report the new "info" is never met. I.e., one of the following is always true:1) the SuppressWarning is disabled, which means we don't care about SuppressWarning 2) SuppressWarning is enabled, which means the at least one of the irritant that is mapped to @SW("unused") is turned on, which in turn means we can't possibly determine that the analysis is not done.(In reply to Jay Arthanareeswaran from)I meant to propose checking the condition that *at least one* of the irritants is set to ignore - not that *all* irritants are set to ignore. See.This opens the door for:- some irritant is disabled- the @SW is still needed for the sake of an enabled irritant.In that case we should ideally not report the new info.(In reply to Stephan Herrmann from)My bad. I guess the following thought made me take that approach: We will end up reporting an unused @SW warning and the new info together, if one of the irritants is set to warning and the other to ignore. Am I missing something? Or this is what you had in mind too?New Gerrit change created:New Gerrit change created:New Gerrit change created:(In reply to Eclipse Genie from)This is as per requirements stated in. The deliberate limitation in the patch is, only the first ignored irritant is reported. This is passed on to the UI via the problem arguments. And because we offer to fix the option severity, I feel it is not necessary to include the option description in the problem summary. Besides, it makes the summary longer than one might like.(In reply to Eclipse Genie from)A draft patch for quick fixes that I used to test. Note that in cases like, there will be two suggestions (duplicated and should be eliminated) to remove the @SW token and two "configure severity" offers (as expected, one each for @SW and relevant irritant's option).Noopur, when everyone is happy with the core patch, can I request you to take the UI patch forward?(In reply to Jay Arthanareeswaran from)I haven't tried any of the patches yet. Regarding the duplicate quick fixes mentioned above, is it because we will have multiple problemIds at the same location? If so, it is a known wontfix issue - see.Also, it would be helpful to attach some examples which can be used to test this and write test cases for the quick fixes.(In reply to Noopur Gupta from)The example in AnnotationTest#testBug506888a() is what I am talking about. The test case is:public class X { @SuppressWarnings({"incomplete-switch"}) void foo() { }}and CompilerOptions.OPTION_ReportUnusedWarningToken is set to WARNING/ERROR and at least one of CompilerOptions.OPTION_ReportIncompleteEnumSwitch CompilerOptions.OPTION_ReportMissingDefaultCaseis set to IGNORE. This testcase will produce two problems on the @SW ().(In reply to Jay Arthanareeswaran from)I can't claim I had the full layout of the logic in front of me, when I proposed the new info :)But after a little tweaking of your change (see patch set 3) I arrived at s.t. that looks good to me:- the new logic should *replace* the key change fromi.e., no more "if options.isAnyEnabled(tokenIrritants)"- give priority to the new info over an uncertain "@SW is unused" and never report both- @SW("all") at any enclosing scope still rules/silences them allWDYT?(In reply to Stephan Herrmann from)Sounds good, thanks!Gerrit changewas merged to [master].Commit:Resolving.(In reply to Eclipse Genie from)This causes test failures in org.eclipse.jdt.ui.tests.quickfix.ModifierCorrectionsQuickFixTestNew Gerrit change created:(In reply to Till Brychcy from)Part one will be immediately fixed by(remove unnecessary @SW will be offered via a new IProblem).After that remains a small problem in jdt.core, to the effect that the second expected quick fix is still not proposed: Method CompilerOptions.getIgnoredIrritant(IrritantSet) claims to answer just the first ignored irritant bit, but we actually work with bitsets here. As a result, CompilerOptions.optionKeyFromIrritant() doesn't find the corresponding key, to be passed to the jdt.ui side for the sake of it's new quick fix.Once that's fixed, then the new quick fixes fromwill make the failing tests pass again.(In reply to Stephan Herrmann from)A fix for this is coming in a minute. The test is the tricky part.(In reply to Stephan Herrmann from)(In reply to Eclipse Genie from)OK, I'll abandons this.New Gerrit change created:(In reply to Eclipse Genie from)Wow, this stirred up a bit more dust than expected:After fixing CompilerOptions.getIgnoredIrritant(IrritantSet) several tests failed, signalling the new INFO where "unused @SW" was expected. I compensated for this, by setting all warnings of the respective group ("unused", "null" or "resource") to warning.Still UnusedDeclaredThrownException caused trouble, because in optionKeyFromIrritant() it was incorrectly mapped to OPTION_ReportUnusedDeclaredThrownExceptionWhenOverriding, which however is not a E/W/I/I option, but a boolean sub-option. CompilerInvocationTests even expected this wrong mapping. When this was introduced infocus was on s.t. else, so I doubt it was done by intention.Next, MissingNonNullByDefaultAnnotation was raised in some tests, which I then opportunistically excluded from this entire game. First, this warning doesn't necessarily have a location for suppressing it (if no package-info.java exists). Second, I simply don't believe that s.o. enabling this warning then wants to suppress it. Conversely, it's an option that many folks keep disabled, even when they are keen on null warnings. Including it in the new logic would mean that all these folks will see the new INFO instead of "unused @SW".Finally a new test checks for the newly passed problem argument.(In reply to Stephan Herrmann from)Thanks for the analysis and the patches. My bad.In hindsight, this was more work than what we would have wanted :)Gerrit changewas merged to [master].Commit:(In reply to Eclipse Genie from)Released this second part for 4.6 M4, see&(In reply to Jay Arthanareeswaran from):)and this was the tiny, tiny solution compared to the alternatives we had!(In reply to Till Brychcy from)After rebasestill failed.Reason: yesterday's IBuild failed, so hudson still used I20161124-2000 :(I'll keep trying...FYI: I just proposedin JDT/UI.Gerrit changewas merged to [master].Commit:(In reply to Eclipse Genie from)The changes in Core finally became visible for UI builds.=> Released the UI part for 4.6 M4 to resolve the test failures ().(In reply to Stephan Herrmann from)Thanks, I can confirm that test failures have disappeared!This is not fixed.Now I get an Info on my example frominstead of a Warning marker. That info cannot be configured. When using the 'Configure problem severity' quick fix, I'm taken to some preference but not the one that would allow to configure /disable the info. When I change the preference from Ignore to Warning, I'm taken to another preference the next time I invoke the quick fix.The behavior in 4.6. was better where I got the expected warning for the example from.(In reply to Dani Megert from)I don't know which settings you use, but AFAICS, this is as per the design in, which we all agreed upon, didn't we? (see "alternative resolution").I do see room for improving UX for "Configure problem severity". Or maybe you want a solution for?If none of these, I cannot help but recommend we abandon everything here and focus on more important tasks in JDT/Core, because the efforts needed for fiddling with this issue far outweigh the benefits, IMO.(In reply to Stephan Herrmann from)New workspace.I agreed with additional requests, see.My main problem is that we now show a problem that can't be configured by itself. Maybe I don't want to see this. Maybe I want this as a warning. This isn't possible. This is on top of.(In reply to Dani Megert from)I thought we agreed on Info - anyway...So in addition to the fix here you want a new configuration option:Report when a @SuppressWarning could possibly be unused, whereas the compiler cannot really decide because some analysis necessary for this decision has been disabled via compiler options.Right?We may need to apply bzip2 to squeeze the option description into a single line in the UI :p Any suggestions?Question: should it be a boolean flag or [E/W/I/I]?Any proposals what the corresponding cli option should be named? -warn:possiblyUnusedSuppressWarnings ? I know it's too long, but ...We thought INFO to be the right option because people can simply ignore unlike warnings/errors and if they are really bothered about it, then it's there to see. Yes, it is a user's prerogative, but if there's to be an exception to this rule, then this is it.(In reply to Jay Arthanareeswaran from)No, we don't report problems (with whatever default) without allowing the user to change it. And there's not just the issue of getting rid of it, but also of increasing the severity for those who want this as warning or error.(In reply to Dani Megert from)If the already enabled diagnostics result in an unused warning for the token, I think it would be better to show that warning instead of the new message. Otherwise, the only way to make it work and get rid of the message is to enable all related diagnostics and that's often not what the user wants.(In reply to Stephan Herrmann from)Yes, as default for the new diagnostic.Yes.Following up on my previous comment: we could do what we also do in the null analysis: we have the normal unused option and the new one would be "Potential unused '@SuppressWarnings' token:".The code snippet fromwould give a warning like in M3 while the reported issue would trigger the new potential info message.I was going to write "you got what you paid for", but then I discovered that bugis implemented slightly differently from what I assumed from the comments: As of, unused @SW was flagged if options.isAnyEnabled(tokenIrritants)Emphasis on *any*.This also explains the misunderstanding near: while Jay was looking at "isAnyEnabled()" I was assuming "areAllEnabled()" (or "!isAnyDisabled()").If we'd restore that, then we're left to solve two more things:- resolve the dilemma from- rephrase the new messageold:At least one of the problems in category ''{0}'' is not analysed due to a compiler option being ignorednew s.t. like:None of the problems in category ''{0}'' are analysed due to a compiler options being ignoredFrom a logic point of view I still like the current solution better: if there's any doubt whether @SW makes sense report the more tentative form. More agressively reporting unused @SW (as requested by Dani) may lead to removing @SW where s.b. else with different compiler options may still need it, which isn't nice at all.Maybe, keeping the logic as it is and making the new issue configurable would serve all purposes at hand?Besides the missing preference, it looks like the new problem is not categorized correctly. It appears under the 'Fatal Errors' category but as an 'Info'.This feature needs polish.CreatedPicture showing Info under Fatal(In reply to Dani Megert from)You didn't tell us how you created that picture, so I tried a bunch of things:- in "Problems" grouped by Severity info correctly appears under "Infos"- in "Markers" grouped by Severity info is shown under "Other Markers", why??- in "Problems" grouped by "Java Problem Type" it appears under "Fatal Errors" indeed.What *is* "Java Problem Type", is that CategorizedProblem.getCategoryID() ?For most non-configurable problems, getCategoryID() answers CategorizedProblem.CAT_INTERNAL. Does anyone know who translates CAT_INTERNAL into "Fatal Error"? What category should it be translated to? In this case a category "Other" seems to be recommended.Ergo:(1) Once the problem is configurable, we can categorize it via its irritant (perhaps as CAT_UNNECESSARY_CODE)(2) For other non-configurable infos categorization may have to be fixed some place else.(In reply to Stephan Herrmann from)Yep.The mapping is done in JDT UI, org.eclipse.jdt.ui/plugin.xml line 4938.As soon as we give it an ID that is not mapped in JDT UI (see above), it will automatically appear under 'Other'.New problem: This info is now reported as warning in our official build (see below).Not sure whether JDT Core creates a warning or whether the build somewhere maps Info to Warning.e.g.1. WARNING in /ui/org/eclipse/jdt/internal/ui/javaeditor/SemanticHighlightings.java (at line 2111)@SuppressWarnings("deprecation") String oldColorkey= PreferenceConstants.EDITOR_JAVA_METHOD_NAME_COLOR;At least one of the problems in category 'deprecation' is not analysed due to a compiler option being ignored(In reply to Dani Megert from)Very unlikely that JDT reports as warning. I suspect Maven doesn't yet handle 'info' problems.(In reply to Jay Arthanareeswaran from)Then we need to disable it in the build. Do we have a token for this new diagnostic?(In reply to Dani Megert from)Sravan, do you know?(In reply to Dani Megert from)Short answer is no as this is hard-wired. It has a master key in the name of "warningToken". warningToken - unsupported or unnecessary @SuppressWarningsBut we probably don't want to use that here.We run the build with the following option<code.ignoredWarnings>-warn:-deprecation,unavoidableGenericProblems,warningToken</code.ignoredWarnings>In jdt.ui these option are overridden by <code.ignoredWarnings>-warn:-deprecation,unavoidableGenericProblems</code.ignoredWarnings>We are using warningToken in our build so I think there is a problem here(In reply to Sravan Kumar Lakkimsetti from)No, there is no problem here.The question for you was whether the build somewhere converts Info to Warning, but I think the following might not be true:(In reply to Jay Arthanareeswaran from)Are you sure? Does ecj support 'Info' at all?(In reply to Dani Megert from)Yes and no. Just confirmed we do support info in JSR 199 (compiler API), but just running the compiler as a Java application only prints WARNING. This can be confirmed by the commit mentioned in. The Annotation Test, which uses the API, prints INFO but the BatchCompilerTest that runs as Java application prints WARNING.This could be a silly question: So, does this mean the Tycho/Maven runs the batch compiler in a separate process and collects the compiler output in a file?(In reply to Jay Arthanareeswaran from)In any case, I will update the batch compiler to report INFO properly.New Gerrit change created:(In reply to Jay Arthanareeswaran from)I think so. Here's an example:(In reply to Jay Arthanareeswaran from)In the 'yes' case, task-using_batch_compiler.htm needs an update. What is the option to set something to be reported as info? -info?(In reply to Dani Megert from)See also.(In reply to Dani Megert from)I see, thanks.This means each time we introduce a non-fatal problem that is not subsumed in an existing irritant, we need to update ProblemReporter.getProblemCategory().Searching CompilerInvocationTests for CAT_INTERNAL the following look fishy:- ImplicitObjectBoundNoNullDefault (always warning)- NonNullDefaultDetailIsNotEvaluated (harmless: no longer reported)(In reply to Dani Megert from)That's the 'no' part, actually. As you said,covers this. When we add the configuration option to the command line compiler, we should update this documentation too. The 'yes' part was the JSR 199 APIs.(In reply to Dani Megert from)This has been fixed viabut won't have any effect until we upgrade the compiler. I will work with Sravan on that.	81.0
id=48238	REOPENED	JDT	Core	3.0	All All	P3 enhancement	JDT-Core-Inbox	2003-12-07 16:28 EST by	Mohamed ZERGAOUI	2007-10-11 02:26 EDT (	1 user	Report final use :It is possible with this architecture to report that a member, a method or a parameter or a local variable is used as an final one (not reassigned). In that case a hint would be to mention that.Report static use :It is possible with this architecture to report that a method is a static one (no access to this). In that case a hint would be to mention that	Doing a full analysis would be quite expensive, and would require a dedicated QA tool. A local diagnosis to a compilation unit is in range for the compiler though, and we currently perform similar analysis for diagnosing unused private members (as we known private members cannot be used from the outside, the amount of analysis involved here is quite small).We could extend our diagnosis to report these particular scenarii.***has been marked as a duplicate of this bug. ***Will reconsider post 3.0Some hintsReport static-------------If IsImplicitThisMask is not flagged in non static method or inner class, toreport in MethodScope and in ClassScope aIProblem.PotentiallyStaticMethodOrClass (or something like that)Report final ------------I propose in org.eclipse.jdt.internal.compiler.lookup.CompilerModifiers theconstant "AccReUsed" for member, method, parameter or local variable which couldoverlapp the value of AccIsDefaultConstructor (for example) or something in ASTNode.It simply check in Assignment : * it will position AccReUsed in non final member, parameter or local variableif assigned a second time.and in MethodDeclaration (or may be in MethodScope) : * position AccReUsed in non final method if the method is overriddenreopen bug for 3.1 or laterDeferring post 3.1Can we reconsider this RFE ?Too late for 3.3.Can we reconsider it for 3.4 ?This is not on the plan, but a patch is always welcome.	10.0
id=58657	REOPENED	JDT	Core	3.0	PC Windows 2000	P3 enhancement	JDT-Core-Inbox	2004-04-15 10:32 EDT by	Philipe Mulet	2016-01-14 12:59 EST (	4 users	Cheetah02In cases where a generic method type parameter isn't used at all or only once, it may be replaced by a wildcard in parameterized type refs.e.g. <T> void foo(List<T> lt) {} could be rewritten into: void foo(List<?> lt) {}	***has been marked as a duplicate of this bug. ***defer***has been marked as a duplicate of this bug. ***JDT/Summit topic(In reply to)I agree, the compiler should raise a warningin that case<T> void foo(List<T> lt) {}but not in that case:<T> List<T> foo() {}Rémi	5.0
id=57219	REOPENED	JDT	Core	2.1	All All	P3 enhancement	JDT-Core-Inbox	2004-04-02 08:04 EST by	Jim des Rivieres	2009-11-03 10:28 EST (	5 users	Make org.eclipse.jdt.core.dom.NaiveASTFlattener an API class (it's currently internal).There are several usages [from Martin]:- We use the formatter on the result. Of course the formatter doesn't run an all kind of nodes, as by default only compilation units, body declarations, statements and expressions can be formatted. There's some work to overcome that limitation, done by the CodeFormatterUtil.fomat2(ASTNode..).- Get a qualified names from Node or Type node instances , say a replacement for the methods Name.getQualifiedName(),- Some code constructs an AST, flattens it, and then creates an AST on it, again, to get bindings and compiler problems.	NaiveASTFlattener doesn't handle unicodes in keywords. Therefore it must not beAPI until this is fixed.I don't see why we want this as an API if we have the AST rewriting.I don't understand what you mean by "NaiveASTFlattener doesn't handle unicodes in keywords".Note that the AST rewriter is more about 're'-writing. In its current state it expects an existing Compilation unit to apply changes to.When you want to get the flattened version of a Do statement, you go into thismethod: public boolean visit(DoStatement node) { this.buffer.append("do ");//$NON-NLS-1$ node.getBody().accept(this); this.buffer.append(" while (");//$NON-NLS-1$ node.getExpression().accept(this); this.buffer.append(");");//$NON-NLS-1$ return false; }This means that the 'do' keyword or the 'while' keyword will be replaced with"do" and "while" even if in the source code they were written as:\u0064\u006f for 'do' and the same thing for 'while'. An operation on sourcecode should never change the code. If unicode were used, they have to be usedafter the operation through the naive flattener.So exposing the naive flattener as is is not an option. It needs work to be usedas an API.The NaiveASTFlattener does not take into account the source code from which the AST was created (that's why is called "naive"). Obviously the spec would make this fact clear.This is why I really don't see why it is useful. Using it can lead to bugs withthe usage of unicodes. An API class has to support unicodes by default.Will reconsider post 3.0Can we reconsider this for 3.1? We currently have an exact copy of the flattenerin jdt.ui and I just got a bug of an issue () where we forgot to keepthe two in-sync.We could think about a better name to avoid any confusions with the ASTrewriter, e.g. ASTNodesToString visitor, however I think NaiveASTFlattener isnot confusing.We could also think to merge the NaiveASTFlattener with the ASTRewriteFlattenerwhich does exactly the same as the NaiveASTFlattener except that it does notaccess the node properties directly but through a bottle neck method Object getAttribute(ASTNode parent, StructuralPropertyDescriptor childProperty) that so the rewriter can take the described AST rewrite changes into account.That indirection is of course less performant, but adds more possibilities.I don't believe this should be exposed as an API.Why not?I thinkandcontain good point against this class as API. Idon't see what the need can be to have this as an API. This flattener doesn'thandle unicodes and doesn't reflect the source code entered by the user.You mix different things. There is AST rewriting: Get an AST created from existing source, make changes to it and have your code changed according to these changes. That's the AST rewrite infrastructure.The NaiveASTFlattener simply helps you to flatten any kind of AST tree or tree segment, regardless if it was created from source or by hand (ast.new..) and just generates a source represetation from it. As I suggested, rename it to 'ASTNodesToString' or something if you really think the name is misleading. If you're intersted why this is useful, look at the users of ASTNodes.asString, or how our class 'ASTFlattener' is used.Note that we copied this class as it obviously was useful.My concern is that I think people won't use it for the right purpose.The javadoc comment clearly says that it should be use only for debugging purpose. * Internal AST visitor for serializing an AST in a quick and dirty fashion. * For various reasons the resulting string is not necessarily legal * Java code; and even if it is legal Java code, it is not necessarily the string * that corresponds to the given AST. Although useless for most purposes, it's * fine for generating debug print strings.So it would be a mistake to use it for a different purpose. Even worse it thefact that the code might not be legal java code.An API needs to be well specified and returns something predictable.Jim, any comment?Obviously would the comment have to be changed. I'm not aware that the generatedcode would be non-legalJim, can we reconsider this. We are currently maintaining a copy of this whichfeels the wrong thing to do.Dirk, I'm concerned about exposing it as a class. I would prefer to have it surfaces as a single method that returned a string for the given node. We would need to spec where this method deals adds whitespace. Q: do you care at all about whitespace at all (so long as it adds enough)? In particular, would it be any more or less useful if it never contained line breaks?- we don't care about line breaks. However the white space should be added in a way that the resulting string is somehow human readable.- a method that converts a node into a string would be sufficient.However I don't see the difference of such a mehtod compared to makeing thevisitor API. The second would provide more flexibility.***has been marked as a duplicate of this bug. ***As of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.Still a valid request.	20.0
id=58802	REOPENED	JDT	Core	3.0	PC Linux	P3 enhancement	JDT-Core-Inbox	2004-04-16 05:30 EDT by	Robert Wenner	2006-10-16 19:15 EDT (	0 users	I would like to disable Javadoc for some files, e.g. my JUnit tests have publicmethods, but I don't want to comment them. Same for my mock objects.A way to exclude some files (e.g. with a regular expression) from the javadocchecks would be great.	This is an enhancement, not a bug.Post 3.0.This is now 2 and a half years old; is this going to be addressed at all?As is right now it makes Javadoc checking useless because I get way too many messages. They may even hide the real warnings I'd know about.	3.0
id=85839	REOPENED	JDT	Core	3.1	PC Windows XP	P3 normal	JDT-Core-Inbox	2005-02-18 11:23 EST by	Markus Keller	2009-11-03 10:11 EST (	1 user	I20050217-2000Create new CodeFormatter settings by editing "Java Conventions [built-in]",enabling "Use tab character" and saving with a new name.In a project with that formatter, create class p.A:--------------------------package p;public class A { private int field; public void add() { field += INC; }}--------------------------- formatting the class should not change anything- use quick fix to create constant INC- The new field is inserted without an empty line in between: private int field; private static final int INC = 0;- format the class -> an empty line is insertedI think this is a problem of the ListRewrite. With Extract Constant from HEAD(rewritten to use ASTRewrite), I see the missing empty line as well.	the ast rewrite has a own heuristic for new lines between elements: It probesthe spacing between existing elements, and if not exist uses 0 for betweenfields and 1 beween methods.I agree that it should probe the formatter at least for the first field/method***has been marked as a duplicate of this bug. ***not for 3.1As of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.Bug was LATER but is still valid in HEAD.	5.0
id=39699	REOPENED	JDT	Core	2.1	PC Windows 2000	P3 enhancement	JDT-Core-Inbox	2003-07-07 10:09 EDT by	Hartmut Obendorf	2013-04-23 08:50 EDT (	2 users	Since JDK 1.4, javadoc supports the -tag:cm:description argument which provides a nice and simple way of specifying new javadoc tags.The use of this cmd line argument is not supported in Eclipse (while theuse of doclets seems to be) and could be easily integrated in the IDE,e.g. as a project preference.This request is fueled by a university course where we teach programming using the contract model - and while the @require and @ensure tags are still being kept as "future" tags, we would like to have a simple configurationoption that allows us to generate documentation for the contract model _now_.	Martin, can you please comment.Thanks for the pointer. I think we currently have no UI at all for the javadoc1.4 options.Note that you can always use the 'Additional options' field to enter the 1.4command line arguments.I don't know if we find time to add more UI to the wizard, maybe somebody fromthe community would be interesseed to bring the Javadoc wizard up to date?If we introduce taglets, JCore should store them. Problems in Javadoc commentscould then include the taglet rules.Will reconsider post 3.0In addition to the taghead (to be used for Javadoc export via'-tag tagname:Xaoptcmf:"taghead"' and for rendering in the Javadoc hover), the preferences should also contain an option that tells whether the tag needs a tag description (see).As of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.Reopening, this is still a valid request.	7.0
id=102395	REOPENED	JDT	Core	3.1	PC Windows 2000	P3 enhancement	JDT-Core-Inbox	2005-06-30 15:58 EDT by	Ken Silveman	2007-06-22 09:16 EDT (	0 users	It does not make sense to force source files to be UNDER the project folder. (Please read this in entirity. Navigator does not see files that are not child of project folder. I explicitly created a project and specified a separate location of the source files.)What if you change IDE's but do not want to replicate or move your source or deal with a foreign project file parent folder? To have a .projectfile that is forced to be ABOVE or part of the source is not good. Why can't the .project file be in the project folder BUT the source for the project be located somewhere else - WITHOUT importing. ** I tried to do this, but after creating a project with source files located somewhere else, your navigator view DOES NOT SHOW THEM. Therefore, you must import the source files into the project folder in order for the navigator to see them!!!! Can you fix this?PS How do you view 'core' Java source files in the navigator project view without being redundant - ie the source files have .class analogs in the core library .jar and you want to view the source in the project but the project should be aware not to comile the 'core' source files because the .jar core library files should have precedence.PPS How do you simply insert a file into the project?	OK, I think I can be more specific here.1) When you "create project from existing source the option to "create separate source and output folders" is not givenOK, so suppose you have existing source and you want that source to remain SEPARATE from the project BUT you still want to create a project for them. What do you do?You can 'create a new project in workspace' but then the only way to get the new project 'aware' of the existing source files is to "import" them - and that is a no go because importing them copies them into the project which is the very thing we are trying to avoid! Any suggestions?No matter what though a project MUST be a parent of its source files. That to me is INSANE. How then, do you keep source folders uncorrupted by additional project files. Also, how do ou import jhave source to be VIEWED in the package explorer associated with a project conveniently but NOT to be compiled. I'll take it either way, I just want the convenience of clicking aon a java.util.TreeMap for example to QUICKLY see the code for it while in my project.***has been marked as a duplicate of this bug. ***Looking at your comments, this is clearly not a bug. Using "linked" sourcefolder as described in project tutorials will definitely match your requirement.Please post further questions either on eclipse.tools.jdt or eclipse.newcomenewsgroup on news.eclipse.org server, thxFrom reporter:Thanks for your kind and thoughtful reply, but the problem with Eclipse'suse of "advanced" "linked source" directories is that when you link anexternal directory A as source root, All of the class file package andimport declarations are not allowed to contain A! The compiler generatesclass not found errors. Instead you have to make folder A a child of aparent folder P and then use P as the linked source. The problem there isthat let's say you do this:P = 'dev'A = 'actual_source_root' (child of P)You will want to name the folder (in the eclipse UI representation) quitedescriptively with "A" and NOT with P, for P may also contain other sourcefolders for other projects. (If not then the creation of P is redundant andthis problem still needs to be addressed!) If you create a source link todev but want ONLY to include the sub-directory A in the project, then thefolder in the properties looks like A/A yes, indeed the name gets listedtwice!!!!!All because the most straight forward approach which is to have the sourceroot be A is not accepted by the compiler, if in your source code, A isexplicitly mentioned in package declarations like "package A.B.C" But thatis standard! (SUGGESTED SOLUTION BELOW)SUGGESTION: make the default that the root of the project source is onebeneath the root for the compiler. This way the root of the source may bespecified in all package and import declarations. That seems to be the mostlogical thing to do.In this case, you should mount the parent of A = 'actual_source_root', I presumeit would be '/', and then using inclusing rules only includes the subfolder 'A'from it, as the rest you aren't interested into.So you'd end up with:P+- src (linked to '/') +- A +- B ...You can specify inclusion rules on the classpath using the advanced features onthe source folder entry.Read project setup tutorial:Help>Java Development User Guide>Getting Started>Project configurationtutorial>Sibling products in a common source tree***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***(In reply to)presumesubfolder 'A'onPhillip, your suggestion does NOT resolve the alias issue or the requirement to create a parent folder and inclusion rule unnecessarily when all you need to do is allow for the compiler's source root to be one up from the project's source root. Specifically:ALIAS PROBLEM: When you select an external "advanced" "linked source folder" Eclipse names the path to the folder DIFFERENTLY then the ACTUAL path. The path should NOT be the same as if it were in the project - because it is NOT in the project. (Not to mention you have to use an 'advanced' button just to escape the project tree) EXTRA DIRECTORY PROBLEM:Why bother with a parent alias (named different than actual path to a parent directory you have to create unnecessarily to support the Eclipse project methodolgy) and then forced to use inclusion of rules to allow only the child you want, blah, blah ,blah all this when other IDE's simply allow you to select a folder and that's it! Then the compiler's source root is by default one up from the project source root to allow package declarations that include the name of the source root folder - nice and SIMPLE!!!! Please help to make this make more straight forward!------- AdditionalFrom Ken Silveman 2005-07-01 17:06 [reply] ------- This "linking" seems like a patch for something that was never addressed. If you want to go back and edit the source, you don't even know where the "linked source" really is because Eclipse 'pretends' that the link is an actual folder within the project! That, from my perspective, is very patchy indeed! All you need to do is show the ACTUAL folder - not this alias. And you still need to allow the compiler source to be one up from the project source to allow for package declarations that name the source so you don't have to unnecessarily add a parent directory just to accommodate this Eclipse quirk.***has been marked as a duplicate of this bug. ***	11.0
id=105658	REOPENED	JDT	Core	3.1	PC Linux	P3 normal	JDT-Core-Inbox	2005-08-01 06:05 EDT by	Andrew J Huff	2015-05-13 06:06 EDT (	6 users	Problem originally reported asin AspectJ, reproduced in jdt withEclipse 3.1.0, Build id: I20050627-1435.With 2 classes a.C1 and b.C1, the following line:a.C1 a = new b.C1();yields this error message:Type mismatch: cannot convert from C1 to C1.While in this case it is pretty obvious what the problem is, this problem wasoriginally found when using a external API (Type mismatch: cannont convert fromIterator to Iterator).A simple fix would be to test for the case when the shortened name of bothclasses are the same and instead give the full package name. For example:Type mismatch: cannot convert from b.C1 to a.C1.	This should be a rare situation, maybe some hover indication could address this one as well...***has been marked as a duplicate of this bug. ***Another example where the error message could be more precise:package my;public class String { String s= "Hello";}=> "Type mismatch: cannot convert from String to String".As of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.Please fix this, it's super annoying, a tricky-to-find-out problem when it occurs, and it's not really rare at all - mixing up two variables / an actual and a formal parameter with just *seemingly* the same type (same short type, different package) is actually a very typical error that would lead to a type mismatch error.I have been bitten by this in the past too.Shankha, would like to take a look?	6.0
id=108695	REOPENED	JDT	Core	3.1	PC Windows XP	P3 normal	JDT-Core-Inbox	2005-09-02 11:06 EDT by	levan Dvalishvili	2006-10-06 17:19 EDT (	0 users	Eclipse is freezing up for a very long time every time I performe any of cllipboard opperations (copy/pase/cut) if java/bean file that is edited is not under src .	Please provide steps to reproduce.Also could you please check this still occurs under 3.2.1.Closing as REMIND.we have model directory under project's rood directory, it has has regular Java beans , this dir can not be placed under src directory.steps to reproduce are quite simple :open any of the beans,highligh any of the methods with mouse, including method body, so about 3-4 lines . and performa copy with ctrl+C. in 3.2.1 performance is better average of 3-6 seconds freeze right after ctrl+C is pressed, VS about 30 sec in eclipse 3.1, but its gets slower more I try to copy paste.behaviouse is more or less consistant on my machine.Hope this helps.Reopen.Could you please provide a thread dump (Ctrl + Break in the console) when Eclipse is hanging?Thanks.Add -console -debug on the command line that starts Eclipse.Could you please also attach a project that we could use to reproduce this issue?Createdthread dumpabout sample project, that might be a problem due to client confidentiality ... I can tell you the statistics :there is about 200 + library entities(all jars) under class path, and architecture is two layered : Model and application itself, model is kodo JDO, application is customized Struts. bean that I run test has about 45 properties total, 20 is collection type.I started eclipse with followign command :SET CLASSPATH=D:\jdk-1.5.6\lib\rt.jar;SET PATH=D:\jdk-1.5.6\bin;%PATH%;D:\eclipse\eclipse.exe -debug -vmargs -Xms256M -Xmx512M -XX:PermSize=128M -XX:MaxPermSize=256M hope this helps.Createdthread dump 2this thread dump is with additional -console argument to eclipse startup,forgot to add it for first thread dump.	6.0
id=110048	REOPENED	JDT	Core	3.1	PC Windows XP	P3 enhancement	JDT-Core-Inbox	2005-09-20 11:52 EDT by	Jerome Lanneluc	2011-03-29 09:16 EDT (	3 users	I20050920An API that returns the list of folders touched by the Java builder during aclean is needed on IJavaProject.	Martin, you're only interested in output folders, not the files?Also not the source folders either?a. Either the builder can communicate a list of files/folders and we make adialog out of itb. The builder can return a status string that we just show. Note that we are only concerned about 'user files'. Files that might belong tothe user (not interested about the .class files that are just going to beregenerated by the builder)I see two places where the builder could communicate this information:1. before changing a classpath: API similar to validateClasspath2. a callback that is invoked while or just before build.In case 1. a dialog showing information is enough. The user can then decide tonot change the build path to avoid the file deletion.In case 2. The user must be able to say yes/no to the deletion of files (I guesswe can't keep the build on hold)A list of files does not scale.What if the user had 1000's of additional random files? What's the point in displaying those?As for .class files, I thought that's what you wanted... since users complain when we delete their .class files and they didn't expect it.In this case, if they had no additional files, then they wouldn't get any message at all.We can present the 100 files in a resource tree structure, so this should bepossible.Also .class files can be user files. As written, not interesting are only .classfiles that will be recreated by the builder again. But there's always thesepeople who start copying files in their output folders (or put their outputfolders to a folder that already contains library).Just to make sure we agree on that: The worst thing an IDE can do is to deletefiles that it shouldn't. So I think we better show a list of 1000 files and letthe user click OK, as that puts the blame back on the user. Sure, something like'all files in folder 'zzz' mostly would do as well, but what if somebody createda linked folder 'zzz' to its 'My Documents' folder?Well in that case he is an idiot! ;)So what if we gave you IResource[] that contained all files that are NOT marked as derived?These should be all files that the user wrote, that we think we'll delete without 'their permission'.Sound good!Do you want to be able to report that while building?I never want to report it.I suspect you're the only person who will ever call this... and it won't be fast.It could take quite a while to walk all resources looking for nothing.At some point of the build you will remove files. Why not giving a callback then?The builder cannot give callbacks that may delay the build forever.What if the user starts a build and leaves for the night?Personally, I think all we need is to confirm with the user that he knows we're about the delete the output folders.I don't think we even have to tell him what we're deleting.Computing this list of resources is a waste of time in my opinion.What about scenarios where the output folder is the same as a source folder?We can solve this problem also by improving the builder so that it would neverever delete a file that it didn't build itself. As long as you can't guaranteethat you better ask the user.If that's a dialog that stops the build for a night that might be worth it if itis about deleting something that the user will never regret you for :-)We disagree.There is an explicit option for users to say they do not want us to clean the output folder.They can turn it on and pay the performance penalty.For everyone else, we'll continue to clean it as quickly as possible.Then let's disable the 'auto scrub option' by default. We shouldn'tunnecessarely expose unexperienced users.Absolutely NOT!Let's be very clear - its much slower with that option.We will not make every user pay because very few users do not understand their own project setup.All we need is a generic confirmation in the UI that forces them to look at their output folders to see what we're about to delete.No way. Managing the output folder is the expected behavior by default.I would picture the API as such:IJavaProject#computeCleanedFolders()It would tell about the root folders about to be cleaned, and give an indicationwhether they are going to be entirely cleaned or only .class files are going tobe deleted (we may have more modes in the future, e.g. only clean managedcontent, so the API should allow evolutions).Re: deleting only contents we created. This is a separate topic which got stated a long time ago, and results in the current behavior. It is not obvious what apreferrable scenario is. Keeping crap around for ever is often an issue; "clean"is supposed to make things clean.Also, the builder shouldn't do callback on a per file basis, but rather UIshould prompt user (offering an option to never prompt again) when he hit theclean/build button. This wouldn't answer the case where an incremental build isactually performing a full build for certain reasons (classpath change), butmaybe we could handle this case separately. A callback in the builder has thedisadvantage that the build process may already be half-way through, socancelling the build in the middle may leave busted state. Additionnally, abuild is intended to be allowed to perform fully in background, so the promptingshould be reserved to UI interactions.My previous comment relates to.List of folders is fine too.There's still the open question: When do we prompt.Obviouly, when the user changes the classpath.The more difficult scenarios are: New classpath from CVS-catchup. User manuallychanges the classpath. User changes a folder to an external folder (not straigthforward but possible). These cases can only be detected on build. Kent says, nodialogs on build. I agree with Philipp, for sure we don't show a dialog perfile, all at once of course.Whichever user on the team makes a change thru the UI & agrees to the clean speaks for everyone on his team. Very likely, he is also the only one who knows how the project is setup in the first place.Its a waste of time to prompt a new team member whether he wants a clean to happen because of a CVS update.The only change we should be making is to prompt the user (and remember that he told you to buzz off) the first time he chooses Project->Clean... & explain to him what folders are about to be cleaned.So before I release this, I would like to know when you expect to call it.When I do a Clean... its on my entire workspace, so does that mean I'm going to see dozens of dialogs telling me what output folders are about to be cleaned?What if I have 100 source projects in my workspace, will you prompt me 100 times before the build starts?If so, I think this is a waste of time & we should just do a single confirmation to make sure users are aware of the 'clean output folder' option.I assumed the dialog would initially be shown when user changes the classpath for a project through the UI.Including it in true clean UI action would require a hook in the UI/build manager which Martin was going to ask... but this feels a bit more advanced. Now this doesn't handle nicely the case where you get a classpath change from CVS, but you can still hope that whoever changed it got prompted for confirmation.Added CleanOutputFolderTestsWhat's the new API?Kent: PRs are meant to be self-contained.From build notes:Added an API method on IJavaProject to compute the output folders that will be cleaned by the next Clean operation./** * Returns the output folders that will be cleaned by the next Clean operation. * The result is null if the project's output folders are shared with other tools and * the option JavaCore.CORE_JAVA_BUILD_CLEAN_OUTPUT_FOLDER is false. * * @return different groups of output folders to be cleaned, currently: * the first array contains the output folders which are cleaned entirely, and * the second array contains the output folders in which only the .class files are cleaned. * @since 3.2 */IContainer[][] computeCleanedFolders();Would it be possible to have an API where I pass the classpath and outputfolder that I am going to set? (Similar to JavaConventions.validateClasspath(...)).The idea is to show the information to the user before it is to late.Makes total sense. Reopening.It would have helped a lot if that was mentioned 3 weeks ago.So you have no use for this API method? If not, we'll remove it.I think I did, see:Yes, you can remove the API without arguments.Sowas someone else?Removed the new API.No idea when we'll get around to adding this other API.Reconsider for 3.3Deferring post 3.4	31.0
id=132420	REOPENED	JDT	Core	3.1.1	All All	P3 enhancement	JDT-Core-Inbox	2006-03-17 18:07 EST by	Chris Hubick	2011-04-28 04:54 EDT (	4 users	I would like a compiler flag to optionally emit an error/warning when code calls a method which *explicitly* declares a throws clause for a runtime derived (unchecked) exception, which isn't then caught or further declared as thrown by that code.The Java Language Specification says: "The runtime exception classes (RuntimeException and its subclasses) are exempted from compile-time checking because, in the judgment of the designers of the Java programming language, having to declare such exceptions would not aid significantly in establishing the correctness of programs. Many of the operations and constructs of the Java programming language can result in runtime exceptions. The information available to a compiler, and the level of analysis the compiler performs, are usually not sufficient to establish that such run-time exceptions cannot occur, even though this may be obvious to the programmer. Requiring such exception classes to be declared would simply be an irritation to programmers."To some extent, I disagree with "the judgment of the designers of the Java programming language". In the case where it *is* obvious to the programmer that a runtime exception may actually occur (ie, a NumberFormatException while parsing user input), it would be nice to be able to force that to be treated similarily to a checked exception.I'm a pedantic programmer who loves all forms of type safety, and wants to be protected from as many things as possible by my compiler, and as such, I like to explicitly declare throws clauses for some runtime exceptions which I know can occur - just to keep me from otherwise forgetting to handle them. I would like a preference within Eclipse to have the compiler emit warings/errors and force me to handle such cases.Thanks for your consideration :)	I believe this is a dupe of 100278, with a better title for it though. Factorizing the discussion there.*** This bug has been marked as a duplicate of***Removing the dependency (already has it).From Chris comment into, it is clear that I mistakenly assumed this bug to be a dupe. The intent here is to mandate that the callers catch or explicitly rethrow runtime exceptions when calling methods that explicitly declare them.Reopening and tuning the title to lower the risk of confusion (at least the risk that *I* get confused ;-).	3.0
id=148350	REOPENED	JDT	Core	3.2	PC Windows XP	P3 enhancement	JDT-Core-Inbox	2006-06-23 03:48 EDT by	Philipe Mulet	2016-01-14 13:00 EST (	2 users	Build 3.2RC7(From Ed Merks)The following two examples generate different byte code. I.e., this explicit initialization to nullclass X{ Object o = null; X() { }}generates more byte code that this implicit initialization to nullclass X{ Object o; X() { }}	Actually, we cannot optimize this code, since it would break:public class X { int foo = initFoo(); int bar = 0; int initFoo() { this.bar = 5; return this.bar; } public static void main(String[] args) { System.out.println("bar="+new X().bar); }}where bar must be equal to zero at the end.The only case we can easily optimize is a scenario where the field is tagged as final, or we need to do clever analysis of initializers:public class X { int foo = initFoo(); final int bar = 0; int initFoo() {// this.bar = 5; return this.bar; } public static void main(String[] args) { System.out.println("bar="+new X().bar); }}CreatedPatch in progressneed to fix tests to specify 'final'Given the requirement on 'final' I don't think the change is really important, as it will not add much value (field refs are constants anyway).May reconsider later.Given a class that initializes its fields only with constant expressions, you'd not need to do a flow analysis for that case, right? (Perhaps you'd have to ensure there are no static initialization blocks too.)This type of initialization optimization would be *very* useful for EMF generated classes. We can certainly avoid doing Object x = null, but we often has cases like Object DEFAULT = null; Object x = DEFAULT; that allow clients of the generated code to change the DEFAULT value in a single place.I agree this is not rocket science, but still we must be careful at not introducing too much overhead.Reopening, since EMF seems to rely on this a lot.Hmm, about the DEFAULT scenario. Remember that null is not a constant in Java, so it wouldn't propagate back to the field declaration, and would not thus be optimized.You'd have to do a textual replace of "DEFAULT" with "null" to make things work.I don't know that null wasn't a constant! It sure looks like one. ;-)The same type of scenario happens with any data type, including primitives, e.g., replace Object with int and null with 0.Check the JLS for constant expressions, you will see that null isn't part of these.The only supported scenario would be for primitive data types and Strings, this is it. There is no other constant expression value. Would this solve the EMF issue then ? Or would you need something else anyway...Philippe,I guess it makes sense that only the primitives have constant expressions, although String is not a primitive so that's a little more surprising.Yes, it would still be a very useful optimization for features with primitive type, which are very common.***has been marked as a duplicate of this bug. ***	10.0
id=160147	REOPENED	JDT	Core	3.1.1	PC Windows XP	P3 normal	JDT-Core-Inbox	2006-10-08 07:57 EDT by	Ralf Hauser	2015-11-23 14:48 EST (	1 user	as per, opening a new bug for this.1) eclipse probably knows what "A" is, in my case it was "Response", thus ifyou already know that x is HttpHandler why not say what A is?	Can you provide a small complete testcase demonstrating the original problem ?Here's the test case I used to reproduce:HttpHandler.java: public class HttpHandler { class Response {} }Test.java: public class Test { void foo() { new HttpHandler.Response(); } }The compiler doesn't really know what A can be in all cases. It is difficult to get a unified error message.A is clearly an example of what could be wrong.Closing as WONTFIX.Too bad for user friendliness - if you know in most cases what A is, how about saying so and only in case the compiler doesn't only then say *A* as a placeholder...would that be better?	4.0
id=191865	REOPENED	JDT	Core	3.2.2	All All	P3 normal	JDT-Core-Inbox	2007-06-10 16:46 EDT by	Chris Lee	2016-08-18 13:23 EDT (	4 users	Build ID: M20070212-1330Steps To Reproduce:1. Turn the 'finally does not complete normally' compiler setting to warning or error2. Write a method with the following code:try { System.out.println ("Hello");} finally { if (true) return;}3. Note that the compiler does not flag the code as an error or warning. This is the problem.4. Remove the 'if (true)' line. Note that the error setting now works in this trivial case.	The spec allows certain rules to be a little more flexible in presence of if(true) or if(false) clauses.Similar, you can write:if (true) return;return;and the latter 'return' is not blamed as being unreachable. The extra warning is simply reflecting this situation. We could make it stricter, since we have some latitude here, but it feels that it should strictly align to the spec which defines notion of reachability in code.Also, javac happens to have a similar warning, and behaves the same as we do.So I'd rather stay with current behavior as it is for all these reasons.Added regression test: TryStatementTest#test065The problem doesn't just happen in the simple (but should still be caught) "if (true)" or "if (false)" casesboolean blah = true;try { System.out.println ("Hello");} finally { // some code here if (blah) return; // some other code goes here}It also doesn't work if the 'return' is in a while (someBoolean) or even a for (int i=0; i<3; i++) loop. If the code will compile and there is the possibility of the 'return' getting hit, this error case should be caught.I'm a little confused as to your comments in #1 -...let me complete my sentence from #3..."but it feels that it shouldstrictly align to the spec which defines notion of reachability in code."I notice (now that you point it out) that javac has a similar problem where it doesn't flag 'return' within a finally as a warning (using -Xlint) if it's within an 'if', 'while', or 'for' block. I think that's a bug there too...the code is most definitely reachable.I agree the current behavior is somewhat counter-intuitive, but all I was saying is that it reflects the very nature of the Java language spec.See section 14.21, near the end, there is a special case for the IF statement.This explains the situation, and the reasoning behind our behavior you see (both with Eclipse compiler and javac).Closing (again). Note that you do not need to reopen to further argue. Simply post your comments, and I will read them. If in the end, some action is required, don't worry I will reopen it.Verified for 3.3.1.Philippe misunderstood the actual problem. This is not about unreachable code after if (..) statements.Here's an example without if statements: void foo() throws Exception { label: while (new Random().nextBoolean()) { try { throw new IOException(); } finally { for (int i= 0; i < 20; i++) { return;// throw new IllegalArgumentException();// break label; } } } }Any of the three statements inside the for loop should trigger a 'finally does not complete normally' problem, just like they do when have these statements at the end of the finally block (outside of the for loop).tentatively planning to address this some time during the Luna cycle.Java 8 work had priority during 4.4, deferring to 4.5Too much on my plate for 4.6. Bulk deferral to 4.7	10.0
id=210524	REOPENED	JDT	Core	3.4	PC All	P3 normal	JDT-Core-Inbox	2007-11-21 07:13 EST by	Maxime Daniel	2015-11-23 14:47 EST (	0 users	Build id: I20071120-1300According to the documentation, -warn:allDeprecation -warn:-deprecation should equate 'deprecation including inside deprecated code' minus 'deprecation outside deprecated code', resulting into 'deprecation inside deprecated code'. Current behavior is no deprecation warning at all.Entered inactive BatchCompilerTest#173.	BTW, the problem is that '-warn:allDeprecation -warn:-deprecation', would it follow its spec, would be almost dumb. Now, the current behavior is no better, and we would still be better off with an implementation that would abide the spec.I'll fix that in 3.4 cycle, except if someone opposes to it.Will wait untilis released.Will wait onrelease, sorry.Given the current definition of compiler options, this will raise the need of a new option, enabled by default, telling the compiler to signal the use of deprecated code within non-deprecated code. This is somewhat unfortunate, but cannot be avoided if we consider the published semantics of the existing options. Will produce a patch doing this and we'll discuss whether changing the batch options semantics would not be wiser (would most probably need that allDeprecation be deprecated in favor of a new option?).Also, found out another test case that I'll associate to this bug as well: -warn:allDeprecation -warn:+deprecation behaves like -warn:deprecation (not signaling deprecation within deprecated code, which it should since only adding deprecation to allDeprecation should be a noop).CreatedFix + test casesKent, would you please let me know what you think?Looking at, I believe we may have a case for the introduction of'warning option refinements' of sorts, and refrain from delivering the behaviorthe initial documentation implied, but amend the documentation instead.Here, we would redocument allDeprecation and deprecation to match the existingbehavior instead of introducing yet another compiler option.(The other bug detected while elaborating the first fix proposal would remainvalid.)Kent, please let me know what you think (the choice being between:- we align the behaviors on the doc in all cases, in which case we need newcompiler options for this bug and;- we admit that warning options of the batch compiler may compose in arelationship where one option refines the other's behavior, and we change thedocumentation - the only composition the documentation admits so far is the useof 'macros', like unused).(And unfortunately bugzilla won't let me create a circular dependency to model the need for a synchronized resolution, so let us simply keep in mind that both bugs should go hand in hand.)I would change the doc to reflect the current use/implementation, as long as the wording is clear that the suboption requires the main option.I thought a bit more about this one and I'm not satisfied yet. There is a problem with allDeprecation: it does not depend on deprecation for its error level. That means, the comparison I make between it and specialParamHiding inis ill-inspired.We are thus left with two options:1 - apply the patch I have suggested and Kent has approved; this aligns allDeprecation with its documentation, to the cost of an extra compiler option;2 - deprecate allDeprecation, add a new batch option like 'specialDeprecationInDeprecatedCode' (suggesting the use of 'special' in the name to match 'specialParamHiding' as an option that modifies another option's behavior), and keep the bug in the code so as to avoid adding a new compiler option.Unless someone protests by tomorrow I'll follow option 1 and release the patch as it is.Released for 3.4 M5.Maxime - I think this is the PR that Philippe mentioned.We should revisit whether a clarification of the spec if preferred to adding a new option.Please remove the current patch & reopen.Removed patch in HEAD.We should only document that allDeprecation and deprecation cannot be used together.	12.0
id=206725	REOPENED	JDT	Core	3.3	PC Windows XP	P3 normal	JDT-Core-Inbox	2007-10-18 04:58 EDT by	Jerome Lanneluc	2011-03-29 09:16 EDT (	0 users	I20071016-1215A compiler participant that implements the build protocols may misbehave and throw RuntimeExceptions. We should wrap all the calls to CompilationParticipant's methods in a SafeRunnable. See sender of CompilationParticipant#reconcile(ReconcileContext) for an example.	The JavaBuilder is called from within a SafeRunnable already, so all the builder calls to the participant APIs will be caught/handled correctly.Looking at the senders of buildFinished(...), it looks like if a participant is throwing a RuntimeException, notifier.done() will never be called. Isn't that a problem ? for (int i = 0, l = this.participants == null ? 0 : this.participants.length; i < l; i++) this.participants[i].buildFinished(this.javaProject); if (!ok) // If the build failed, clear the previously built state, forcing a full build next time. clearLastState(); notifier.done(); cleanup();Also if the first particpant throws an exception, other participants will not be notified.I would like to fail the build if a participant throws an Error.And the overall build is wrapped in a SafeRunnable to catch such a case.The alternative is potentially 100's errors reported from the same participant as we compile each file.	4.0
id=237245	REOPENED	JDT	Core	3.4	PC Linux	P3 normal	JDT-Core-Inbox	2008-06-16 05:28 EDT by	Martin Aeschlimann	2015-11-23 14:46 EST (	4 users	Spawned from:The NLS Scanner cannot handle structures like these:@NamedQueries({ @NamedQuery(name = Die.QUERY_BLADEHEIGHTLIST, query = "SELECT DISTINCT d.bladeHeight FROM Die d ORDER BY d.bladeHeight"), @NamedQuery(name = Die.QUERY_NEXTIDS, query = "SELECT d.type, max(d.id) + 1 FROM Die d GROUP BY d.type ORDER BY d.type")})If there are unnecessary $NON-NLS$ tags in the nested annotations, warnings are not generated for them (even though top level annotations DO get their warnings).covers the NPE when using the NLS wizard.	There is no NPE when using 3.4 RC3 or newer.CreatedComplete test sourceNote problem existed in 3.3.2 as well.Testing with HEAD. This is no longer an issue.Closing as WORKSFORME.Added regression test:org.eclipse.jdt.core.tests.compiler.regression.ExternalizeStringLiterals15Test#test007I may still be seeing the bug. When I copy paste the code used in the test ExternalizeStringLiterals15Test.test007(), I get only one warning (line no 6) instead of 3 warnings on line number 3, 4 and 6. Interestingly when I ran the test, it is passing. Another observation I made is this: when I move the //$NON-NLS-1$ to the top-level annotation, the warning is being displayed.Reopening.Testing with HEAD, warnings or errors are properly generated, but not cleaned up by the save action to remove unnecessary nls tags.I think the problem comes from the creation of the DOM unit. For some unknown reasons, the created unit has no problems.If I debug it, I do get some problems. Investigating.	8.0
id=116143	REOPENED	JDT	Core	3.2	PC Windows XP	P3 enhancement	JDT-Core-Inbox	2005-11-13 13:49 EST by	Craig Setera	2011-03-29 09:51 EDT (	35 users	For the EclipseME project () we are looking to providepreprocessing support similar to the support provided by the Antenna Ant tasks(). These preprocessor directiveshelp J2ME developers to deal with the many differences between variousconstrained devices without having significant extra code where the memory isnot available. The proposed Mobile Tools for Java Eclipse project can takeadvantage of this functionality as well.In order to maintain a development process that looks and feels equivalent tothe current Eclipse workflow, it is necessary to be able to provide the compilerwith source code that differs from the source code that actually exists in thefile system. The only other option is to alter the actual source file with abuilder that runs before the JDT compiler builder. This is a poor solution, asit will cause the source to be rewritten whenever changes to the preprocessordefinitions are made, which will cause those files to be flagged as changes tosource control.This bug attaches a patch to the current CVS HEAD JDT core support that providesa new "sourceCodeProviders" extension point. A source code provider can beregistered to provide preprocessed or otherwise altered source code to theorg.eclipse.jdt.internal.core.builder.SourceFile class when it is queried viathe #getContents method. The source code providers are related to a projectnature, limiting their effect to projects that can actually take advantage ofthe function.It would be excellent if this functionality could be considered for inclusioninto the 3.2 release stream as is or with appropriate changes. I believe thisis generally useful functionality built in a way that various project types caneasily take advantage of it.Thanks for consideration.	CreatedPatch to provide source code providers extension to JDT CoreKent - could compilation participants solve this one too ?My initial look at this support in CVS makes me think the compilationparticipants might work. I can play with it a bit on HEAD. When is thistargetted to be available in a milestone build?I cannot see the participants helping you since its really intended for applications that generated additional source files, based on the files about to be compiled.In your case, you just want to change the source that the compiler sees. An in-place preprocessor makes more sense.I guess I'm confused. I must have read the code wrong. It looked like I couldmake arbitrary changes to the AST of the compilation unit? If so, I can"comment out" the code that is not enabled via the AST before the compiler getahold of it. Am I mis-reading this? If not, maybe the concept should beextended to allow for this to cover my case as well?The API is not complete. The call you saw only handled the case of the reconcile operation, which is not called during the build loop.The work in progress API for the build path (not released yet) does not provide a way for you to change the source of a file.The problem with allowing you to do that is memory usage. We would need to read the source for every source file about to compiled & cache your changes in memory. For large enough projects, this would cause the VM to run out of memory.We currently only read the source for a file at a time while its parsed, not all source files involved in the build cycle.I'm perfectly fine with not using this support for my required functionality. I'm back to believing that we need something like the source code providers Iproposed in this bug. In that type of a design, my preprocessing builder canrun before the compiler and output the preprocessed content to a temporarydirectory. Then the source code provider in this case would pull thepreprocessed output for every source code request. This avoids the need tocalculate the deltas more than once and keeps the source content out of memory.Any further thoughts here? What are the next steps required to move thisfunctionality along?You entered the bug on Sunday.It will take more than a few days before we can find time to evaluate the patch. ;)We have quite a few things on the go already.What? I'm not the top priority? :-)Sorry. Wasn't so much looking for a yes/no on the patch as a general "goodidea" or "bad idea". Basically, in the event that something like this is notgoing to be accepted (my patch or or something similar), I need to figure outwhat that means to this functionality in EclipseME.How does your patch affect a Java editor? Does quick fix still work?Is the Debugger happy or is it confused by line numbers being off?That is a good question. The patch itself doesn't really dictate what thesource provider does or does not do to the source code. So, it would be fairlyeasy to generate processed source code that has line numbers that no longermatch the originals. In the case of most of the EclipseME directives, I thinkthis can be somewhat handled by commenting out code, which should leave the linenumbers alone. There is the ability to do an "include" which would most likelybreak line number debugging.Again, this all comes back to the source code provider. I'm not sure there isany way to avoid breakage in certain cases, but I'm open to other ideas to solvethe problem. I don't think the patch as it stands makes the prospect any betteror worse. I'm guessing that users of this functionality would be willing toaccept certain debugging problems for the added functionality.The other side of things that I'm not really up to speed on is the sourceproviders for the debugger. If you assume that the preprocesser runs as abuilder prior to the JDT compiler and stores the processed output, it may bepossible to also configure where the source is loaded by the debugger to pointto the preprocessed output.Craig,Sounds like this:The other side of things that I'm not really up to speed on is the sourceproviders for the debugger. If you assume that the preprocesser runs as abuilder prior to the JDT compiler and stores the processed output, it may bepossible to also configure where the source is loaded by the debugger to pointto the preprocessed output...Might be the way to go..the other thought is it could at a later date provide porting hooks via some AOP/aspectj process...Tira Wireless rewrote javassit to use aop to preprcoessosurce for porting beteween j2me midp implementations..Your gem of an idea is solid I think and has promise..Fred Groitt(aka shareme)I looked at this quite extensively over the holiday. In terms of the question about whether or not this effects the editor, the answer in my case is no. The builder run after the save is completed and the source uses Java comments to "hide" the preprocessor defines from the standard compiler. I do think there is room for additional functionality (folding, highlighting) for these syntax elements, but it is not *necessary* nor does it affect this particular enhancement request.Fred is right in terms of the debugger source providers. The way that this is currently working in my workspace is that the preprocessor builder runs before the Java compiler and writes a new copy of the file into a derived file in a subdirectory. This extension point would be used to point the Java compiler to this derived file and the debugger source providers support would be used to include this directory in a source resolution search. In this way, the user will be debugging the exact source of the file *after* processing.At this point, the only thing I have any concern with in terms of this patch is how to "safely" tie this provider to a project nature. As it stands now, multiple source code providers could potentially be attached to a single project nature. The code as it stands will choose one. In practice I don't believe this is an issue, but it is a minor hole in the extension point as currently defined. This is something that could just be documented or perhaps requires a bit more thought.Any further thoughts?Debug commnet: as already noted, the source lookup path could be modified to retrieve the "pre-processed" source, rather than the original source. (I'm not sure if this is what developers want though).Alternately, a more complex solution would be required, where the pre-processor client would also have an opportunity to slam the debug line number table before writing the class file, in order to map back to the original source.I think for an initial release, the current debug source support should suffice for my needs. Longer term, there may be a need/use for something more sophisticated for source lookup (if it doesn't already exist). For instance, the preprocessor I've built to match Antenna allows for an "include" directive. My current plan is that the debugger will just debug the included content within the processed file. Longer term it might be nice to actually be able to direct the debugger to lines within the original included file. In this case, the line number table won't help because the lines would actually exist in another file.Does the debug framework have anything like this? As I said, I don't think it is necessary in the short term.Any new thoughts on this patch? Any chance it will be integrated into one of the upcoming milestones? I hate to be a pain, but I have EclipseME users that would love to have the support that depends on this. It seems if there is no more discussion, that someone should be able to say yes or no to the patch. If there is more discussion to be had or changes to be made to the support, I'd love to help make that happen.I wonder if there could be a hook or callback that compiler will call after parsing an AST, so plugins may apply some transformations right on the AST that will be compiled.Although I think there is room for an AST-based solution, I'm not sure that is the best solution for the current use case EclipseME has a need for. The problem with an AST-based solution is that the changes need to be recalculated and reapplied every time that the compiler needs the AST for a compilation. I haven't spent a lot of time looking at all of the paths through that code, but I would imagine the AST will be built more often than the source actually changes. In that case, having a version of the source on disk with the appropriate changes already in place should be faster than reapplying the changes to the AST over and over. Essentially, the disk becomes the cache of the processed document.I am a user of EclipseME. I am keenly waiting for progress on this issue. I imagine the other 40 people who voted for it are also waiting for progress. I want to know why after more than 3 months, we havent had any evaluation from the Eclipse core team.The reason it is so important to us is that you cannot do commercial-level J2ME development without pre-compilation. The platforms variations are just too great, and code space is so tight that we cannot afford to ship unneeded code.With ExclipseME we have a fantastic tool that very cleverly adapts the Eclipse core to J2ME. But EclipseMe has a weight around its neck. It cannot offer Pre-processing, the most wanted & requested feature in the developer community, because of missing support in the core Eclipse platform.J2ME is an extremely fast moving industry. For those of us who have adopted Eclipse as our development environment of choice, its frustrating to sit helplessly, month after month, waiting for the powers that manage the core to consider our request.And finally, Netbeans can do it. Why cant Eclipse?Well Ben its very simple - JDT Core has over 500 open PRs for bugs that are already part of the release.Clearly the users that want to use the patch can apply it for the short term.And as for having to wait month after month (a little exaggeration maybe?) - the patch was provided half way thru the 3.2 development cycle, when our development plan was already set.I should add that we do think the problem is worth addressing, but we want a solution that fits in with all of the tools: the editor, code assist, debugger etc.Several teams have existing preprocessors, but they have to remember to manually edit the original source after 'fixing' it in the debugger. They accept that their solution is poor but can live with it.When we address this problem, I think we should provide them with a better solution & not just a different implementation of their existing solution.I agree. Integration is key here. We do want a solution which can scale, where all existing tools are going to perform in a seamless fashion (think of search, codeassist as well etc...). Editor must reconcile the right source, and still deal with preprocessed code at some point. I also think as Darin that the client doesn't want to see preprocessed code in the end. This feels really close to what JSPs are doing today, and they plug into our layer, and provide some builder for it. In my original comment about compiler participant, I was hoping we could add some specific hook for preprocessing, but this did not happen by M5, due to other fights on other front.Still this is an interesting problem to tackle, but we want a consistent solution, and not an intermediate one which we will have to live with forever.Looks like we should reconsider this issue early in our 3.3 dev cycle.Craig - would you be interested in documenting exactly what is the usecase and expectations ?To clarify, in the original description, you mostly mentionned hooking into build process, and also told about debugger. What about all the rest of the tooling ?How do you foresee developping with autobuild turned off ? In this mode, the source model is still evolving as changes are made; which means preprocessing needs to occur not just while compiling for building.Philippe and Kent,Let me start by saying thanks for all that you do. I recognize that the Eclipse platform is a huge effort and that all requests such as this cause ripple effects. I understand that this type of functionality needs to be discussed and a plan must be put together to address all of the concerns. I would guess that some of the frustration that people, including myself, are having is the relatively low amount of discussion of this new feature. If I felt that we were talking this through and working on a plan to address the issue, I would be somewhat less concerned. I have considered providing a patched version of this functionality for my users, but I'm concerned with betting on this and having the direction change drastically.In terms of use cases, I'm not sure how much more I can say in addition to the previous discussion. I do feel that this functionality is somewhat different than something like JSP processing. In JSP processing, you start with something that looks very little like Java source files and translate that into Java source code. It is definitely more of a hybrid situation. In the preprocessing case, it seems that the user expects it to act very much like a standard Java source file.As previously discussed, there are a lot of aspects to this functionality. With that said, I think there is a spectrum ranging from "necessary" to "nice". I'm sure there are other things, but here is a list in order or "necessity" in my mind.- Ability to influence the source input to the Java compiler- Ability to influence the debugger to track this information. (I'm not sure how this would work in practice, as line number tables don't allow cross-file references as far as I know.)- Ability to influence the editor functionality. For instance, to recognize that a block of code is currently "disabled" and therefore the error analysis should not notice the variable declarations in that block.I'm sure there are many other aspects to this that I'm not thinking about at this point. I would argue that these don't have to be tackled all at one time. Adding the ability to feed the java compiler a set of source code adds value immediately, although with some potential rough edges. Those rough edges do not negate the positives that are provided by this functionality. I believe that as long as the approach for one of these features does not preclude adding the next level of functionality, it really is not necessary to solve them all at the same time.As I said previously, I'm not sure what other information I can provide in terms of use cases than can be found throughout this bug report. I'm very interested in helping to drive this forward and will provide as much information as I can. I'm just happy to have this conversation moving forward at least a little bit.I spent some time looking at this during my flights to/from EclipseCON. It really looks to me like the compilation participant functionality may be the "correct" way to handle this. I understand there are some concerns about how to make that approach scale that are going to need to be addressed. Since it is obvious that this functionality is not going to make it into Eclipse 3.2, I'm looking for a bit of help to tide my users over until the next release of Eclipse when this is done right. In previous discussions, there was some talk of providing a "patched" version of JDT core with my functionality. I'm not a big fan of doing this due to the maintenance/upkeep of the patch. Are there any other options here? Is there some way that I can inject this functionality without having to build a patched version of JDT core?Assuming the answer to the above is no, how do I build a patched version? Is my best option to just do a plugin export or is there a better way to do this? Is there any way to conditional extend the extension point? It would be nice if EclipseME could gracefully handle the case where the user does not have the patched functionality available. I'm looking for any tips to help make this functionality work as smoothly as possible given the circumstances.As said earlier, will queue this for 3.3I understand that there won't be anything official until later. I'm just hoping that someone can help me do a short-term workaround.Why did this get resolved? Why isn't it just open with a 3.3 target milestone?Maybe allowing the patch tool as part of the build process would help.Here is the idea: Original sources are in base/. base/ offers the full Java options (classpath, navigation, etc) but the code in base/ is *not* compiled. This is under version control.patches/ contains the modification rules (standard patches). Also under version control.Lastely, there is build-src/ which contains the processed sources. This is not under version control but compiled by javac.In a second step, there could be a path which contains scripts which are applied during the build step.The important part here would be to create a list which maps the source lines of the resulting code to the source files (patches, real source, script) where they came from.In the debbugger, we'll need a view which shows the generated source and navigation help to go to the places which contributed to every line.I guess I'm confused by Aaron's last suggestion. There have been a number of suggestions along the way (in and out of this bug). In the end, if it isn't tied directly into the JDT compiler, it isn't going to give the appropriate user experience. I've been hoping to find some time to look closer at what it would take to make the compilation participants do what needs to be done, but I've just been unable to find that time. Having looked at this, I do still believe the compilation participants support is still a better place for this functionality (changing the AST during compilation) than my original source code providers patch, but I'm willing to take advantage of either one to get to the results I'm hoping for.Being able to hook into the AST would be even better. One of my most common problems right now is to insert code in the EMF generated Java source like here: public void setTitle(String newTitle) { String oldTitle = title; title = newTitle; if (eNotificationRequired()) eNotify(new ENotificationImpl(this, Notification.SET, WriterToolPackage.BOOK__TITLE, oldTitle, title)); }In this code, I'd like to replace eNotificationRequired() with "oldTitle == null ? title != null : !oldTitle.equals(title)".Of course, I don't want to edit the generated code because then, the code generation would cause problems (either changes in the model wouldn't be reflected or my changes would be overwritten).So the perfect solution would allow me to select the condition in the if(), raising an error if the if() isn't there anymore (so I will know when the model has changed).The problem is, as you said, the debugger.In, we're talking about a way to map java code to a view (presentation independent of code formatting).Basically, the proposed solution is to reformat the inserted code in such a way that every part that comes from a different file ends up on a single line during compilation: if (oldTitle == null ? title != null : !oldTitle.equals(title))The debugger could then use a kind of reverse map.The second solution, even more radical (and probably way beyond the scope of this bug) is to all hooks in the AST itself.The idea is to have grammar partikels in your project which explain new language constructs. So in my case instead of using EMF, I could create a new Java syntax (or extend the existing one but way beyond the possibilities of annotations): private String title { writable, notifyOnChange, notNull, maxLength=64 }This is but a simple example which could be implemented with Java 5 annotations.But how about this: HTML a = <html><head><title>Title string</title></head></html>; a.html.head.addSibling( <body /> ); String id = "xxx"; a.html.body = <div id="${id}" />; for (HTML.Div div : a.html.body.child(HTML.Div)) { System.out.println (div.id); }that is, the ability to process native HTML in Java by using the class information to determine the parser for the right hand side of an expression.So the question for today is: can compilation participants help some preprocessors solve their problem today on the 3.2 release without any more support from JDT/Core?I think its definitely possible if the solution looks something like this:1. Create as many 'processed' projects from a single 'original' project as you want, based on multiple tags. For example, if tags A & B are enabled then the original project X could produce processed projects X-A, X-B, X-AB. The classpath in each processed project remains the same, but each processed project is not attached to a CVS repository (unless you want to save the processed source for some reason).2. When your compilation participant is told that the builder is about to compile a set of source files in the original project, copy the processed output of each file to its processed project (see CompilationParticipant.buildStarting(BuildContext[] files, boolean isBatch)). You can run your processor on each original source file with different tags enabled, and produce multiple results into the corresponding processed projects. Overhead of the participant should be low assuming your preprocessor is reasonably quick.3. Then you can run/debug different targets by switching to the corresponding processed project. The source in the debugger will be the processed source and the line numbers will be correct. If you choose to make changes to the processed source, you can test fixes immediately but must remember to backport your changes to the original project.With no additional support, search will find references in code that is commented out in the original project, but visible in processed projects.Each processed project represents what you want to package for that set of tags. Source files could be as small as possible if your processor strips disabled source from other tags.Multiple independent source processors could be attached to the same original project and produce their own processed projects, without any conflicts/collisions.I'm going to have to spend some time digesting this idea. I had begun to contemplate whether separate projects could help (thought of it in the shower this morning), so with two of us thinking in that direction, perhaps there is something there. It may be something to consider for a 3.2 base, but it is a pretty ugly hack that should likely be resolved in 3.3. I was digging around in the code that handles that to determine how hard it would be for the builders to honer the changes in an AST from the compilation participant. I also read tbe bug report in which concerns with this were expressed. What is the current thinking on that part of things for a 3.3 release? The advantage of course is that it doesn't involve new API, just new support within that API.I don't see it as a hack at all.One alternative is to make Java projects support 'original' source folder(s) that map to several 'processed' source folder(s), each with their own class folder.But then how does the builder not blow up with 10 source files all defining the type p1.p2.X ?How does a user keep the processed results for several tags around so he can switch between targets without rebuilding ?(In reply to)When we target multiple devices and also when we reuse code without unacceptably bloated OO stuctures (for limited J2ME devices) we make extensive use of the Antenna preprocessor. However we also have found the need to write our own preprocessor tasks to overcome various limitations in both Antenna and Ant itself.Although there is truly great benefit in integrating a preprocessor into the JDT the only bulletproof way of supporting all developers diverse build requirements will be to also provide hooks on which arbitrary scripts can be run at various stages of an automated build: - before the 'built-in' preprocessor - before compilation - after preprocessing - after packaging - ...Integrating Ant scripts into the automated build system of Eclipse is surely something which could be useful in many spheres of development.After spending some time thinking about the multiple projects approach, I believe it could work but that it is not the best long term solution. In reality, if using this approach, there would be no reason for using the ICompilationParticipant support at all. I'm already able to open and parse files using the AST parser, so it would just be another builder in the chain.In the longer term, are you still considering adding the ability to alter the AST using ICompilationParticipants or something like my original request? I just don't believe the multiple project approach is appropriate as the ultimate implementation for a variety of reasons.We have seen the multiple project solution (using separate builder) work quite well. So without specific reasons why multiple projects does not solve your problem, I don't think we will adding more support for this.Please feel free to describe why this doesn't work and include answers to the questions in.Can you give some examples of where multiple projects are being used in this way? Are they doing things that way because they felt it was the "right" way or because that was the only way that was available to them? The multiple project approach is cumbersome and strikes me as a hack. It is significantly more difficult for plugin developers to manage multiple projects and their associated classpaths than to code to a single project. It is confusing to users, as there will be multiple projects, some of which are not being created by the users directly (this is true whether or not they can be filtered out of the user views). In short, while it seems like it could be made to work, it does not strike me as the high quality support that I've come to expect from the Eclipse platform.I don't quite understand the resistance to adding a feature like this. It is obvious from the associated vote count on this bug that I'm not the only one that cares about a feature like this. Is this a matter of resources, time or just that you don't believe it is the correct thing to do? There are a number of entries on this report that mention that they could definitely use this functionality for their plugin project as well.If you read back through this bug report, you will see that my original request was pretty simple. If the concern here is that it is too difficult or expensive to support allowing me to change things from inside an ICompilationParticipant, I'm more than willing to help look at other options including my original proposal. I just don't want to waste another year of Eclipse development without a real solution coming from JDT.I agree with Craig that it does not make any sense from user point of view to have two projects.I agree with Craig that it does not make any sense from user point of view tohave two projects. It seems like a workaround, not a solution.Interestingly, extra source folders for processed sources are not striking you, but extra project folders do... I agree these are more visible, but in essence they are more powerful as well.Anyhow, I think we can investigate this in 3.3 time frame.Java class library developers have similar issues when dealing with platform specific code, SWT has the same issue as well (cc'ing Steve).All took different approaches though.Things I'd like to preserve is the ability to find references. The multi project solution would show references in proper context; i.e. refs to a method in win32 as opposed to for a different platform.JDT is dealing with plain Java; we can provide hook or ease integration of preprocessors, but this isn't truly part of what Java is; and actually goes beyond just Java.Phillipe,Thanks for your comments. I agree that this whole thing goes beyond Java. A lot of people dealing with J2ME (aka Java ME) will tell you that it is not exactly like coding in normal Java, but uses Java syntax. The set of differences and constraints in the ME world make it virtually impossible to code as "normal". On the other hand, things can and do move from the ME world over to the SE/EE world. Take, for example, the split verification support coming in Mustang. That originated in the ME world and has thus moved over the SE.I will say that I would not be quite as opposed to multiple source folders, as they are all within the context of the user's project. That said, I can think of no way to actually make that work given the curent Eclipse functionality. I may not like the multiple project approach, but I can at least envision how it might be workable.Here the questions fromthat we expected answers to:How does the builder not blow up with 10 source files all defining thetype p1.p2.X ?How does a user keep the processed results for several tags around so he canswitch between targets without rebuilding ?The multiple project solution is very workable and has been used by a team for several years. It allows each team member the choice of which tags should be processed... search and debugging work as expected.Given the number of votes this bug has got, I assume that someone has the time to take their processor and have it generate files in several 'generated' projects to see how it works for them, then provide feedback for everyone else.What is the current thinking on this bug? Are there any thoughts/plans from the JDT team at this point? I don't want to see another Eclipse release slip by without progress on solving this problem. My understanding at this point of the potential solutions:1) My original "source code providers" concept. This is straightforward and would solve the initial requirement. There may or may not be lurking "API problems" with the concept. There may or may not be a better way.2) Expand the compilation participants functionality provided in the 3.2 timeframe to actually allow changes to pass through to the compiler. This seems like a very clean API, but I believe there are concerns with implementation and scalability of the solution. Can anyone offer more insight into concerns with the approach?3) Multiple project approach. Although I will admit that this is likely to work, I still feel that it is not a reasonable long-term solution. Based on comments on this bug and in discussions I've had outside this bug report, I'm not alone in this thinking. I would prefer not to invest any time in this "solution" as I don't believe it is something I want to see in EclipseME or MTJ.Are there other options that should be considered, either already available or better long-term additions? I'm certainly willing to pitch in and try to help with this, but it makes no sense for me to go off and try to build something if the JDT team is going to be unwilling to accept the work when completed. I would like to see some significant design discussions before proceeding with any significant work.Craig, you still have not answered questions that we have asked.As for the multiple project solution working vs. not working.IT DEFINITELY WORKS!We know of a team that has used this approach for several years.No one has explained why this solution is not acceptable to them or even had a co-op student try to implement it for a week.(In reply to)One of the reasons why it i not desirable is that it effectively changes a build path for compile time and for launching. So, dependent projects has to be aware of those anomalies and launch configurations has to be ajusted accordingly. Also note that it also affet derived launch configurations, e.g. when applying AspectJ in the runtime and some other similar cases. In my opinion that is more then enough for the reason.Ok - so how do any of the other proprosed solutions not have the same problem?(In reply to)The approach I suggested supposed to preprocess source code right before compiler (e.g. after parsing to AST model). So, neither source folders or target folders would change.It may introduce some challenge for source-level debugging. Though I am not sure if those woven changes shouldbe seen during debugging.But then you can only keep the output for 1 target for 1 group of tags.We have teams doing preprocessing that have 10-20 tags. They would like to have the output for numerous combinations of their tags kept around and built in the workspace.It is completely unacceptable to them that they have to wait for a build everytime they turn off 1 tag and turn on 2 others.So the simple approach of keeping the classpath the same and having the output folder contain the result of the preprocessed source is a waste of time for them. Their situation is no where near that simple.Sorry - accidently tagged as closedTagging as laterBacking up a bit...I apologize that I had forgotten there were outstanding open questions. I should have spent the time to go back through this novel of a bug report as I just did to refresh my memory on the territory covered thus far."But then how does the builder not blow up with 10 source files all defining thetype p1.p2.X ?"I've not been considering a need for multiple tags to be "active" at one time. From a compiler perspective, there is only a single instance of the Java source at any one time. I'm not arguing that having many tags active at one time would be a bad thing, but being able to have a single tag active is better than what developers have right now. I think doing "batch builds" of multiple "configuration" is better kept to Ant and automated builds. In the end, the ability to provide a "virtual file system" view of the sources does not imply to me a particular use for that functionality. "How does a user keep the processed results for several tags around so he canswitch between targets without rebuilding ?"Again, this strikes me as something that should be up to the user of the API to determine. If the plugin chooses to manage the results as separate project, separate derived folder or somewhere completely outside the workspace it should be of no concern to the builder/compiler. We seem to be hung up on the issue of using multiple projects versus some other solution. I understand how that can be done and believe that it is technically doable. I *personally* believe that this is wrong from a user's perspective. I *personally* believe that projects are first class user interface objects that are to be managed by the user, not created implicitly. I'm not a particularly big fan of tools such as TPTP creating projects on the fly to store their data either. This is a purely *personal* opinion, but one that it sounds like others agree with. As previously mentioned, I do not have a problem with creating project-level derived resources, as they can be managed and to some extent hidden from the user.I do not believe that there is a significant difference in the amount of work necessary for any solution to be implemented on my part. EclipseME will need to manage the processed source in multiple projects or somewhere else. It is an issue that EclipseME has to deal with. Given a generic interface into the compiler source, how EclipseME chooses to manage processed source should be of no concern to the compiler. This strikes me as a good thing.Please note that I mentioned "virtual file system" earlier. After some discussions with others, I'm beginning to consider a possibility of using EFS within a single project to manage the source provided to the compiler. If this works, it would be the generic hook that I need and no changes would be necessary to JDT. The trick is in signaling to my EFS implementation that this is the builder running and not the editor (to give out the right sources). One potential here is to set a thread local variable around the build functionality. For this to work, JDT would have to be single-threaded. Can anyone verify that the JavaBuilder, image builders and low-level compiler run within a single thread or are they multithreaded? What other issues might exist with this approach?There is more than just the compiler to think about.JDT also needs to consider how search behaves and does the debugger see the correct source for the .class files, etc.Ignoring the problem of multiple tags generating different source likely means the solution is a waste of time for a large percentage of the listeners to this bug.Assuming your source looks anything like:/*<MY-PREPROCESSOR> IF A */x.doSomething();/*<MY-PREPROCESSOR> ELSEIF Bx.doSomethingElse();/*<MY-PREPROCESSOR> ELSE Cx.doNothing();*/How do you expect search to find senders of the method doSomethingElse() if the only generated source was with the tag A enabled and never the tag B or C?As for your question: at this time the builder is single threaded, but there is no quarantee that will continue.The indexing part of search is run in its own background thread while queries are permitted from any thread.IMHO, the first step here would be a way to get the AST before the compiler/index thread sees it.This would allow people to write arbitrary preprocessors (= AST-to-AST transformers).The next step would be to see which ideas would evolve from that. AspectJ didn't happen in a day. The idea was there, then the compiler but it took several years for people to find out what works and what doesn't.Right now, we all agree that Java is somewhat limited but we cannot agree how to solve that. So lets add an extension point which allows to add A2A transformers and let's compete for the best idea how to use this EP to make us all more productive.I bet that this EP will trigger a plethora of plugins which will do things with Java that we can't even start to imagine right now.(In reply to)Hi Philippe :-)Any chances that you could look into that for 3.3 per your prior comment?This is one of the most popular bugs....53 votes ...It is definitely is the bugzilla TOP 10!Any level of support there even if it is not perfect would be really cool.I am re-opening that bug too.CordiallyWell I cannot re-open it... Craig or Kent?Could you do that please?Could we at the minimu provide with some decent extensibility via fragments?like o.e.ui.workbench does?It would be as simple as adding the following directive to the manifest :Bundle-ClassPath: .This would allow frgamnets to provide patched code when needed... and would go a long way to support many interesting experimentations.Sorry my mistake: the directive should be something like:It would be as simple as adding the following directive to the manifest :Bundle-ClassPath: extensions.jar, .where extensions.jar could be optionally provided by a fragment is would not be in jdt.core .Any code in extensions.jar would be first in the jdt.core classpath :-)There have been a lot of discussions throughout the lifetime of this bug concerning possible workarounds to solve this problem. The primary suggestion has been to use two separate projects to solve this problem. In fact, EclipseME is currently shipping a version of its preprocessor functionality using this approach. Unfortunately, this approach has proven to be as much of a problem from a user's perspective as predicted. This is in addition to thedevelopment effort that was required to get this approach to even work at all. There are currently a number of EclipseME bugs that have been written that likely can never be solved using this approach. Two simple examples:* Java search returns results from both the primary and secondary projects.* As a Java project, the secondary project shows up in the clean dialog.At this time, I'm exploring the possibility of using the OSGi Framework classloader hooks to rewrite the JDT SourceFile class bytes during load. It is certainly dangerous to rewrite classes in the face of potential change, but it appears to be absolutely necessary to maintain a reasonable user workflowwithout further help from the JDT team.Although I would much prefer to use a sanctioned hook into the compiler, Iwill go ahead with my plan to hook the framework classloader. As always, I am more than willing to participate in design and implementation of a sanctioned extension point. EclipseME users would likely benefit from this in the long term. As part of the Mobile Tools for the Java Platform team, I can also say that MTJ would prefer to build on a sanctioned extensionmechanism.I am well aware that such a hook does not solve all of the problems raisedby this bug. Multiple device support, debugger source handling and editorsupport are all examples of functionality that will also need to be addressedat some point in the near future. Most, if not all, can be solved with other extension points available in the platform. But, without a hook into the compiler none of these matter.Please take one more look at this bug and consider what might be able to beaddressed in the 3.3 timeframe for the benefit of the users of EclipseME,MTJ and everyone that has voted for this bug. If there has been progressor discussion about a solution for this bug, please update the bug to reflect that progress.Thanks.I'm removing myself from this bug report. I can't be of any help and have long since resigned myself to accepting the limitations of Java and its effects on the tooling. See ya!I just had a really stupid idea but ... well, see for yourself:Is it possible to call the Java compiler from a classloader?Basically, I would feed the classloader a classname. Certain properties (for example, the package) would hint it to generate the code, then run it through javac and finally return the generated class.I agree, this would be slow but that's not the point. We could add caching and for the final product, we could resolve all these classes once and pack the generated code in the JAR.My main point is that this would give us a well defined (as far as classloaders go ;-) point to hook into Java execution. Comments?Aaron, re: class loader: Frankly, the idea sounds unworkable and rather off-target. We're trying to deliver pre-processed source to a compiler here. The class loading happens on a phone, much later.Aaron, I think I understand your suggested approach and that you are suggesting to do the classloaders from within the Eclipse side of things. While it might be possible to do, it is definitely not the path that I want to see things go. I'm working hard to make sure that the user's experience is as close to the standard JDT experience as possible. Calling out to javac will not yield the tight integration that I'm looking for. In reality, calling out to javac could easily be done without any classloader tricks from within a standard Java builder.Here is an idea borrowed from NetBeans mobility pack preprocessing support:instead of hooking into the build process, the code itself is modified, but in a "toggle-able" way.specifically, in NetBeans they have a Commenting-Preprocessor, that comment and uncomment blocks of code, based on the current profile (set of define variables).in NetBeans, the user can initiate a re-commenting of the code by pressing a key combination. the code is also re-commented after the user changes the defines.a concrete example://#if FOOSystem.out.println("Foo is defined");//#elseifSystem.out.println("Foo is not defined");//#endifwhen the re-comment command would run, it will prefix the first line with //# comment.if FOO is then defined, re-comment will run again (automatically) and the first block would be uncommented and the second would be commented.the main problem with this approach is the interaction with the version control:since the code is actually changing, it will be marked as changed for the purpose of version control, which is problematic - but personally I would live with that.On a side note: I have seen the multiple-project approach offered by EclipseME and I agree with Craig that is a bad solution from the user's perspective.I'm trying very hard to avoid things that mess with source control. It is bad enough with something like CVS and SVN that do no locking, but for systems that use locking it would be a nightmare in my mind.We should investigate this enhancement for 3.5. Kent, for 3.5M3 please define the full requirement across the board:- how does it interact with the compiler/builder?- how does the debugger map the source to what's being executed? (need mapping api?)- how does it get presented in UI (multi-tab editor for toggling filters?) ?- what impact does it have on JDT tooling (model APIs, search, etc.) ?- what extension points are needed?- more ?So to everyone that voted for this & to those that have already commented - please take the time in the next 2 weeks to let us know what you would like to see in 3.5, since it has been a long time since this bug was originally opened.If you could send an email directly to me () & I'll summarize the comments when I'm back in 2 weeks.If you have written a preprocessor, please let us know : - did you attach it to eclipse ? how ? - approx. how many source files need to be preprocessed ? - is performance an issue for you or is preprocessing 'real fast' ? - did you 'cache' the processed source ? - how many tags does your source contain ? - do you generate/debug several different targets at the same time ? - how do you expect the debugger/search/code assist to deal with the original and processed source ? - and anything else you can think of...- did you attach it to eclipse ? how ?Yes.my preprocessor (the one which will be used with MTJ) is reversible, meaning you can execute it again on a previously preprocessed file and get correct results even if you changed the symbols between the two runs.I used this property, what I did was simply to edit the text in the editor buffer.since my preprocessor prefix 'hidden' code lines by a Java comment the code in the text editor compiles and does not confuse the syntax checker. - approx. how many source files need to be preprocessed ?depends on the project.when a file is modified (saved) it's preprocessed.when the entire project is rebuilt, all the files are preprocessed. (I integrated as a builder). - is performance an issue for you or is preprocessing 'real fast' ?I am not sure how much of an issue it is. it wasn't an issue for me. - did you 'cache' the processed source ?Yes, in the editor buffer (meaning on top of the actual files, this is not what you would normally call cache, but it has the same effect: a file is preprocessed only when it needed to be). - how many tags does your source contain ?The terminology is symbols.it can be anything really, my plugin uses a device database which can populate the symbols, and the user can add his own one per project, or per device through an external xml file that extends the device database. - do you generate/debug several different targets at the same time ?No. I consider that the job of the build system (IE: Ant + Antenna, or something similar). - how do you expect the debugger/search/code assist to deal with the original and processed source ?At any given time, there is a set of active symbols per project that have preprocessing enabled.debugging, search and code assist should work on the code which have been preprocessed with those symbols. - and anything else you can think of... Syntax highlighting show show what code is active and what code is 'hidden'.since the entire point of this bug report was to eliminate the need for my approach by being able to provide the preprocessed code to the compiler, I think the original source should not be modified (as it was in my plugin), but instead preprocessed to a different dir (much like classes are compile to bin).assuming this is how things will be, it will be hard for the user to understand what code is active and what code is not.the syntax highlighter should take the preprocessor output into consideration and paint hidden code in disabled colors to make it clear to the user that it's not active.to achieve this, the best way would be to keep an additional data model per file that hold output from the preprocessor about which lines (numbers) are active and which lines (numbers) are disabled after the last preprocessing run.this may require some changes to the Preprocessor.I want to make it very clear that while the underlying preprocessing engine that translates the preprocessing directives into he output source control is indeed the engine that Omry has written and is embedded in Antenna, Omry's plugin, EclipseME and MTJ. *HOWEVER* the way that it is attached and used within Omry's plugin and EclipseME/MTJ is very different. Both are options to be looked at, but it is important to keep both of them separated. My comments are related to EclipseME/MJT, as MTJ is now a derivative of EclipseME. - did you attach it to eclipse ? how ?Yes. Via a an OSGi bundle hook on the bundle classloader. The JDT org.eclipse.jdt.internal.core.builder.SourceFile getContents() method is rewritten to consult a SourceMapper interface. This interface allows a new resource to be returned to the compiler. The code for this hook can be found in MTJ source at. The key here is that the code is processed into a different directory than the source directory to avoid altering the user's source, as this avoids issues with source control showing changed files that have not really changed. - approx. how many source files need to be preprocessed ?As Omry says, it depends on the application. Mobile applications tend to be much smaller than SE/EE applications. - is performance an issue for you or is preprocessing 'real fast' ? - did you 'cache' the processed source ?Performance does not strike me as the primary issue. At least for EclipseME/MTJ the preprocessed results are only generated when a file is altered and saved. - how many tags does your source contain ?As Omry says, this will vary depending on the source used. - do you generate/debug several different targets at the same time ?At this time, no. Although that would be something that might be interesting in the longer term. - how do you expect the debugger/search/code assist to deal with the original and processed source ?I would expect the functionality to primary work based on the processed code. - and anything else you can think of... As I've stated multiple times in the past, there are lots of ways this could be approached and multiple levels of integration. While I'd love to see all parts of the JDT functionality addressed in one fell swoop, I would prefer to see a plan that breaks this functionality and addresses it piece by piece. The first and foremost need is a hook similar to what is currently being done in EclipseME/MTJ by hooking the JDT compiler and rewriting its code. It DOES NOT solve all of the problems, but it solves the MOST IMPORTANT highest priority problem. Waiting until JDT can address every single feature and function makes me nervous whether anything will get done.To be honest, I was hoping for more feedback from the 57 voters of this bug.Other than EclipseME/MJT, are there other existing/planned preprocessors that would like to add their 2 cents to the discussion of what we try to accomplish for 3.5 ?Please let us know as soon as you can.thxMy comments above (#30, #32 and #55) still apply: I'd like a way to invoke the patch tool and to do AST transformations during the build.I just wanted to clarify answers to this question if I can. - how do you expect the debugger/search/code assist to deal with the original and processed source ?Omry you said :Craig :The debugger obviously needs to show the processed source so the line numbers match up.But since the user likely does NOT want to edit the processed source, are you sure that you want search to find references relative to the processed source and not the original source ?Assuming the processed source is never committed to CVS/SVN, shouldn't the user edit/search the original source ?Interesting and somewhat difficult question to answer... In terms of editing, I think you are always correct... you always want to edit the original source code. The preprocessed source should not be editable.I think search is more difficult to answer. Take a "find references" search. If you search across the original source file without taking into account the current "processing symbols" the user may find references that are not *currently* active. It also leads to an interesting question about refactorings and such.I agree it is interesting... it makes me think there are 2 very different solutions for this problem in the short term.**** Let's first assume that we're NOT trying to provide a HUGE solution, but a fairly simple one that people can digest easily ****I see 2 choices:1. So IF we decide that the original source is the source we want displayed in the editor & used by search/code assist. AND the processed source is fed to the compiler/debugger.THEN a preprocessor extension point similar to a CompilerParticipant is the logical solution. Only the compiler/builder/debugger would be made aware of this 'hook'.2. But IF we decide that the original source is the source we want displayed in the editor. AND the processed source is fed to the compiler/debugger and also the search indexer, and code assist [Not sure that refactoring will work in this mode].THEN a new kind of project is the best solution. It would add onto a JavaProject with the notion of an 'original' source folder, to go along with a 'normal' source folder. Each file (do not care whether its .java or .jpg) would be passed to a user supplied Processor and saved in the equivalent place in the JavaProject's 'normal' source folder. This transformation/processing step would happen whenever an individual file was changed, but NOT during a build loop. Instead a normal resource listener would be responsible for noticing when the file changed.There would be no reason to change the compiler/builder/debugger/search/etc since it would appear that the processed source in the 'normal' source folder is the active source.We would need to make sure that the original source is committed to the repository and the files in the JDT source folder is not.Make sense ?hi kent,looking at the options, it seems to me that option 1 is the easiest way to go and also matches the original requirements of this bug.but option 2 seems to be the right way of doing that and also avoid the issue raised by craig of feeding the the code assist with possibly "invalid code".so... if there is is time to do it and you think it is a good solution, i would prefer option 2.:)gustavo(In reply to)I don't have much time but I had an idea how to solve the "real/processed source debugging" problem. We need these features:1. A "#line" statement which the compiler translates into a "debug source location" bytecode.2. A source preprocessor must be able to ask the compiler to put each node of the AST in a different line and generate a mapping tables which translates a line/column information in the real source into a byte code position in the compiled code.3. A stacktrace translator which maps byte code positions using the translation tables into source positions where each position may be in one of three places: The real source (which the user wrote), generated code (which can be around stuff in the real source or injected between stuff the user wrote) and support byte code (generated byte code, for example with the asm framework; calling library code is not an issue because that code has correct line number information). 4. A flag in the compiled bytecode which the Eclipse debugger looks for which enables the translation.5. Maybe a source viewer which can switch between the original source, the intermediate source (as generated by the preprocessor) and a bytecode decompiler.Kent,Can you explain how your #2 solution would work? Two source folders or are you talking about a single source folder? If it is a single source folder that is being managed by the user *and* the builder, I think this would be hard to manage since the user may want to make changes that would need to be allowed back to source control, while other changes would not go to source control. If you are talking about two source folders, how would you picture those being managed?It would be 2 separate folders & the second one with the processed files would be tagged as 'derived' & read-only (as would all of its files). This would make these 'generated' folders/files not visible to source code control, just as .class files do not appear in outgoing changes.So we're essentially tricking a JavaProject to think that this generated source folder is the real one & treat it as a normal source folder (ie. compile its processed source files to .class files in the bin folder, index & search its processed source files & display their contents in the debugger).The 'original' folder would be treated as a normal source folder is now. All of its resource changes would appear to be outgoing changes to CVS, etc.So a simple 'PreProcessor enabled JavaProject' would look like:Project1 bin [derived folder not visible to source control] processedSrc [derived & read-only folder not visible to source control] originalSrc [all files would be 'processed' & result saved to processedSrc]The tricky parts to be worked out would be:- how to hide the processedSrc folder from the UI in the packageExplorer- opening the 'correct' source file for certain situations such as from a search result (want the read-only processed file), or the open type dialog (likely want the original file).- attaching the correct icon to the 'original' source folder in the package explorer instead of a random folder (if we care about UI issues like this)So one question I have is : how useful is this solution to multiple users/applications ? Or should MTJ provide their own customized JavaProject that provides a hook for their preprocessor & manage their symbols ?I'm not sure this is a good idea. There should be a simple way to see the processed sources.I was wondering if it was possible to add a "source/processed" tab (like in an XML or HTML editor) to the Java editor. In the processed tab, you could see immediately what happens to the code you just typed.It would be great if that wasn't limited to Java editors but a standard feature of code editors for processors which aren't limited to Java.Kent,I do believe there is relevance to a solution outside of MTJ. Perhaps there is a way to find out from other users?In terms of a technical approach, the approach you describe seems like it might work. I do believe it needs to be possible to choose to view the processed sources in some cases. It should also be possible to filter the folder(s). However, I don't believe it is necessary to have multiple tabs in the UI to support this... Finally, There is now a discussion going on within the MTJ project to add Multi-configuration support to the tooling. The discussion can be found at. Given that this support only provides for a single "active" configuration, I don't know that it affects this discussion too much. It does imply that changing the active configuration would need to rebuild the processed source and associated binaries. Does that also imply rebuilding the search indices or anything else? (NOTE: It was already possible to switch the active configuration, but it will now be more obvious)one thing that is not clear to me is if this is useful outside the scope of java code. if it is then the solution to extend a javaproject might not be the correct one. (but this bug is open on JDT, so maybe we can just focus on java). but maybe, as craig said, we should see if others on the list have comments.in terms of mtj, this solution is ok for us. other question that i have is about the synmbols management. currently we do the symbols management inside mtj. on this solution you expect that this management will be moved to JDT? so jdt would provide an api to create symbol sets and add symbols to it?thanksgustavo(In reply to)Making the processed source available (preferably as read-only) is definitely reasonable - but likely users would have to be instructed how to find it.As for the symbol management - no I wasn't think it would become part of our support. Right now I think the Preprocessor & its inner workings should be left up to each individual project.Possibly down the road we can generalize a solution, but I'm not sure we could get agreement right now.So I was thinking more about search. Assume an original file looked this:class X { void foo() { // #ifdef My_PROJECT call_function(1); // else // call_quick_function(2); }}And the processed source looked like this :class X { void foo() { // #ifdef My_PROJECT //call_function(1); // else call_quick_function(2); }}Search would record a reference to call_quick_function from X and would select the call in the read-only processed file correctly... BUT what if we want the search result to highlight the call in the original file?Will the line/character positions be correct ? My guess is no, they would be off a few lines/characters especially if the preprocessor removes commented lines.So if opening the processed file is fine, then we're OK. If not, we would have some work to do.for me, what you suggested is o. one question. how i would set the list of "active" symbols in one specific preprocessed project?(In reply to)Whoever supplies the preprocessor needs to provide a way for users to add symbols & choose the active one(s).We do not have enough feedback from several implementors to know what a good general solution would be.I agree that it makes the most sense for MTJ to manage the symbols and activation of those symbols. I also believe that it makes the most sense for MTJ to provide the implementation of the "preprocessing language". I think where it might be useful to provide platform support is in making this all possible in a generic way... be it through an extension point or a specialization of the Java project structure. That way anyone that wanted to could provide preprocessing types of activities without having to build out the low-level platform hooks.hi craig,i thought that the preprocessing language itself (syntax of the preprocessing) would already be implemented inside JDT. we just need to provide the set of active symbols. am i missing something?my understanding was that we would only need an api to set the symbols and maybe also the types of each symbols (necessary to validate the expressions).for example, we could have a set of four active symbols:<symbol, type, value>screenwidth, int, 270screenheight, int, 256devicemovel, string, nokiaserie40JSR179, boolean, true//if (screenwidth > 200)Image.createImage(big_image)//else Image.createImage(small_image)//endifbased on that, the preprocessor would generate the final preprocessed code and also implement some editor features such as code competition, validate expressions, etc. (In reply to)Gustavo, JDT will only provide you with the extension point to attach your preprocessor.We do not know anything about your symbols or the syntax that you chose to write your preprocessed code.That is all left up to individual Preprocessors to handle themselves.I agree with this approach. There are potentially multiple types of preprocessor languages that could be applied... JDT should not be required to know all of those.so let me see if i understand:- currently we have a classpath hook that requires the config.ini to be changed- this is not going to be necessary since we will use another extension point provided by JDT. so we will keep our current solution on mtj, but use an extension point instead of the classpath hook- JDT will not define a new project type. just this extension point that can be used by anyone that wants to use preprocessing- the client of the extension point must define all preprocessing related tasks (language)is that right? other question. is the editor going to be changed to do that fold in/out, code assist, evaluate expressions, etc? i just want to understand clearly what will be provided and what we have to provide on mtj:)gustavo(In reply to)Gustavo, what we're suggesting is :- an extension point for any Preprocessor- an expanded JavaProject (adds an 'OriginalSrc' folder)- a resourceListener that notices whenever a file changes in the OriginalSrc folder & calls the attached Preprocessor, then saves the processed file to the normal source folder & marks it as derived/read-only so CVS will ignore it- debug & search will use the processed files in the normal source folderWhat is NOT provided is :- what the original source looks like; individual preprocessors can use whatever syntax they want- support for symbols and how the current symbol set is identifiedAs for changes to the editor - not sure exactly what you had in mind. A user can always open the processed source file to see what source was compiled.hi kent,thanks for the answers. it is clear to me now. about the editor, i was wondering about a code assist on the possible symbols that are available, but since the preprocessor will be defined outside jdt, then it doesn't make sense to have that inside it.base on what you answered, probably it will not be necessary to set the current active symbols in JDT isn't it? since the component that implement the extension will provided the final preprocessed code, JDT don't need to be aware of the symbols that are active. is that right?thanksgustavo(In reply to)Kent, what's the status on this bug? Any hope to have something for M5?Yes...We've just had a user report that the bundle hook that we have been using for doing this work in past releases no longer works for the 3.5 stream. If there is any chance that the JDT work is not going to be there in the 3.5 timeframe, the MTJ project needs to know immediately so that we can look at what other options may be available.Can I add my 2 cents to the already long discussion:* The preprocessed source code is fed to theSorry for the half-baked comment... Continue with your discussion:)Moving to M7.hi oliver,my name is gustavo and i'm one of DSDP MTJ commiters. we plan to use thie preprocessor feature on MTJ 1.0 that will also be released with galileo train. do you have some nightly build that we can start working on top of it? or at least some design that we can take a look to have an idea of what we need to do on our side to useit. i'm concerned that we don't have enought time to do our part if we are only able to start to work after M7.if there is anything that we can do to help you guys, please let us knowthanksgustavo(In reply to)CreatedProposed preprocessor exampleGustavo, Craig and anyone else still listening:This patch contains an example project with a builder that calls a registered preprocessor (attached thru an extension point). The preprocessor controls when full vs. incremental builds occur & is asked to process each resource in an 'original' folder. The processed contents are written to a 'processed' folder, which in the case of JavaProjects would be on its classpath.The patch is not specific to JDT, but a JDT extension is provided to help in testing.If you're not interested in the simple tests, then you can remove the project dependencies to the 4 test projects: org.junit and org.eclipse.jdt.core.tests.*Now for the 'not-so-good-news' : the powers that be have decided that this patch will not released as part of 3.5.It is being provided here so users can have a good starting point on their own preprocessor infrastructure. It should be sufficient so teams will only need to define their own preprocessor & not all the 'extras' to plug it into eclipse.Please let me know if there is anything in the example project which is unclear.We have waiting for this so long. Even if this patch does not come as part of 3.5, will it come as part of an upcoming release?At least in terms of MTJ, we are still trying to determine if this patch really solves the problem that we set out to solve. What is your use case?We won't do more for 3.5	103.0
id=267045	REOPENED	JDT	Core	3.4	PC Windows XP	P3 normal	JDT-Core-Inbox	2009-03-04 11:33 EST by	Sascha Theves	2009-05-05 11:32 EDT (	1 user	Build ID: I20080617-2000Steps To Reproduce:It`s hard to reproduce but sometimes if you restart Eclipse the workspace has compile errors. JDT Marker says: "java.lang.Object can not be resolved to a type"sometimes the same for other Java built-in Objects, e.g. Enum.The workaround for me was closing the project and reopen it and then call clean project.This bug is a kind of blocker for me because I have to do the workaround for each project with such compile errors and that are about 50 in my workspace.More information:	Sounds like a duplicate of...Please give it a try with 3.4.2 and reopen in case of this assumption was wrong, thx*** This bug has been marked as a duplicate of***I tried now the eclipse M20090211-1700 build. But I run into the same problems. Here is the marker message:"The type java.lang.Object cannot be resolved. It is indirectly referenced from required .class files."Can you reproduce with a 3.5 build (ie. 3.5M7)?	3.0
id=336648	REOPENED	JDT	Core	3.7	PC Mac OS X	P3 normal	JDT-Core-Inbox	2011-02-08 15:00 EST by	Markus Keller	2017-02-25 11:50 EST (	5 users	I20110124-1800Wrong compiler problem "The value of the local variable xxx is not used" if there's a real compile error later:public class Test { void foo(String m) { // wrong "The value of the local variable message is not used": final String message= m; new Runnable() { public void run() { if ("x".equals(message)) { bug(); // undefined method } } }.run(); }}	I'll take a look.Released disabled junit test via org.eclipse.jdt.core.tests.compiler.regression.ProgrammingProblemsTest._test0058()Turns out the local variable's use is recorded in code generation. Given wedon't generate code for the class with the error, the only use of the localis missed resulting in the warning. I'll see how best to handle this.CreatedProposed patchPasses all tests, Ayush please review, TIA.See alsoReleased in HEAD for 3.7 M6Patch looks good. Although initially I thought that its too harsh to stop reporting variable unused problem when there's any error in the code, I observed that this is being done anyways by the use of ignoreFurtherInvestigation flag which gets set on the method whenever an error is encountered. And because of this flag being set, no analysis takes place for the method in question. So this bug can only occur in the kind of case as reported i.e. an inner method inside an anonymous class has the error, and gets marked with ignoreFurtherInvestigation, but the outer method does not. So in the outer method's analysis, we dont analyse the inner method, and hence dont encounter the usage of 'message' inside the inner method. So its better to not report unused warnings when such a scenario occurs.Verified for 3.7M6 using build I20110301-1537OK, given that it is not possible to fix all cases (see) with this fix, we should revert it for 3.7.The right way to fix it would be to check if the current method contains errors. We don't have an easy way to check this right now. The "usage" of the message is only checked really late in the code generation when outer locals are injected into the code generation of the anonymous class.Since there is a problem with that code, the outer local variable emulation is never done.(In reply to)A think the cleanest way of fixing this would be to move usage analysis from generateCode to analyseCode, see. The latter bug, however, shouldbetter be addressed in some M1 or M2 at the latest, IMHO.(In reply to)Concur with Stephan. Moving it out of 3.8 and tagging as plan candidate for 3.9.Thanks Stephan.	11.0
id=341789	REOPENED	JDT	Core	3.6.2	PC Windows 7	P3 normal	JDT-Core-Inbox	2011-04-04 10:35 EDT by	Mauro Molinari	2014-07-28 12:33 EDT (	2 users	Build Identifier: M20110210-1200See steps to reproReproducible: AlwaysSteps to Reproduce:1. write the following classes:public interface A{ /** * @see #setaMethod(B) */ <T extends B & C> T getaMethod(); /** * @see #getaMethod() */ <T extends B & C> void setaMethod(T param);}public class B{}public interface C{}2. look at the rows where I use @see in the Javadoc; this is what I see:- on the first @see in A:Javadoc: Bound mismatch: The generic method setaMethod(T) of type A is not applicable for the arguments (B). The inferred type B is not a valid substitute for the bounded parameter <T extends B & C>- on the second @see in A:Javadoc: Bound mismatch: The generic method getaMethod() of type A is not applicable for the arguments (). The inferred type B is not a valid substitute for the bounded parameter <T extends B & C>	Reproduced in HEAD. You have to enable Javadoc processing for the project and enable "Malformed Javadoc comments" and "Validate tag arguments".This is the same issue. Onceis fixed, this will also be fixed.*** This bug has been marked as a duplicate of***(In reply to)I'm not sure that's really the same issue. Javadoc references should use the erasure of the method parameter types, so no type inference should be necessary in that situation.(In reply to)If this is not the same issue, this will be reopened.This first warning still happens in Kepler and Luna.Also, it is not Java7 specific (aswould suggest).By the way, I'm not certain whether the warning is wrong or the actual syntax of @see is wrong for this specific case, however it's the one produced by JDT code assist. Even if I searched on the net, I was not able to determine whether it's correct or not. I didn't try the Javadoc tool to see what it says.With master, I only get a single problem "Javadoc: The method setaMethod(T) in the type A is not applicable for the arguments (B)" on * @see #setaMethod(B)This warning is wrong.still doesn't clearly specify this, but all evidence tells that the erasure of a type variable should be used (which is "B" here).Javadoc.exe from JDK 8 also accepts the reference.Interestingly, the bug vanishes once I turn "interface A" into "interface A<E>". I don't even have to declare method "void take(E e);" and a reference "@see #take(Object)" to prove the point...	6.0
id=361047	REOPENED	JDT	Core	3.7.1	PC Windows 7	P3 major	JDT-Core-Inbox	2011-10-15 07:26 EDT by	Dmitry Vyazelenko	2012-01-27 08:33 EST (	7 users	Build Identifier: M20110909-1335Attempt to use rename variable refactoring fails with NullPointerExxception.Reproducible: SometimesSteps to Reproduce:1. Select local variable2. Refactor->Rename3. Type in new name4. Press OK - action is rollbacked and you see exception in the error log	CreatedFull stacktrace of the errorStacktrace added.Java tooling bugs go to JDT, not Platform IDE.*** This bug has been marked as a duplicate of***OK, I see that the bug was marked as duplicate of <a href=""></a>. However I do not agree that it can be closed because I have 3.7.1 Eclipse version in which bug is reproducible. And as far I understood the fix was suppose to be delivered as part of 3.7.1 RC2?!(In reply to)Yes, the fix foris in 3.7.1.To understand similarity/difference to that bug, can you please tell uswhether there's also a file package-info.java involved in your case?Can you share an example program where the exception can be reproduced?Yes, the package containing class in which local variable rename fails also contains package-info.java file.Unfortunately I was not able to reproduce issue with sample project. The error occurs only on closed source project.I tried to reproduce with a simple case with a package-info.java file, but works ok. Dmitry, can you extract the method into another one, omitting much of your code except the local variable on which ur'e using the refactoring? If you can still reproduce, then submitting that testcase here will help us and make sure you don't cause any IP issues. Thanks!Ping. We cannot do much here without a reproducible example.Dmitry, have you had chance to try out Ayush's suggestion from?	9.0
id=367440	REOPENED	JDT	Core	3.7.1	PC Windows 7	P3 normal	JDT-Core-Inbox	2011-12-22 11:26 EST by	Mauro Molinari	2012-05-16 06:22 EDT (	5 users	Sometimes when Eclipse starts I have a ConcurrentModificationException during "Initializing Java Tooling".Today it happened with the following stack trace:eclipse.buildId=M20110909-1335java.version=1.6.0_26java.vendor=Sun Microsystems Inc.BootLoader constants: OS=win32, ARCH=x86_64, WS=win32, NL=it_ITCommand-line arguments: -os win32 -ws win32 -arch x86_64 -debug -consoleLog -data d:\workspace37-TrunkErrorThu Dec 22 17:15:23 CET 2011An internal error occurred during: "Initializing Java Tooling".java.util.ConcurrentModificationException at java.util.HashMap$HashIterator.nextEntry(Unknown Source) at java.util.HashMap$EntryIterator.next(Unknown Source) at java.util.HashMap$EntryIterator.next(Unknown Source) at org.eclipse.jdt.internal.core.JavaModelManager$9.run(JavaModelManager.java:2796) at org.eclipse.core.internal.resources.Workspace.run(Workspace.java:2344) at org.eclipse.jdt.internal.core.JavaModelManager.initializeAllContainers(JavaModelManager.java:2816) at org.eclipse.jdt.internal.core.JavaModelManager.getClasspathContainer(JavaModelManager.java:1873) at org.eclipse.jdt.core.JavaCore.initializeAfterLoad(JavaCore.java:3556) at org.eclipse.jdt.internal.ui.InitializeAfterLoadJob$RealJob.run(InitializeAfterLoadJob.java:36) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)	This is fixed in 3.8 via. Please try one of the recent 3.8 builds.*** This bug has been marked as a duplicate of***Are you sureis the same?Its stack trace is totally different and its target milestone is 3.7.1. However, I'm actually seeing my exception in 3.7.1.Satyam, looks like this one is yet to be released in 3.7.x, doesn't it?(In reply to)was released into the BETA_JAVA7 branch, which thenbecome 3.7.1, right?(In reply to)Sorry, I didn't notice that.Yes, it should have been fixed in 3.7.1.The problem is different. Hence, reopening.	6.0
id=387188	REOPENED	JDT	Core	4.2	PC Windows XP	P3 normal	JDT-Core-Inbox	2012-08-14 06:05 EDT by	Hajo Lemcke	2012-08-18 07:02 EDT (	2 users	Java compiler generates errors for constraint annotations like "@NotNull", "@Valid" and others.Problem text = "NotNull cannot be resolved to a type"The lib "validation-api-1.0.0.GA.jar" is part of the build path and contains the complete validation API.The statement "import javax.validation.constraints.NotNull;" is in the source file.Opening such a file with one of these problems, adding a character, removing it and saving the file leads to zero problems when Eclipse recompiled it. Activating the menu item "Project - Clean" recreates all problems.This problem already existed in Indigo. Its available in Eclipse on Win XP, Win 7 and Linux.Enabling or disabling annotation processing makes no difference.	I quickly tried what you describe but I cannot reproduce.Apparently we need some more info.Ideally you would put together a small test project exhibiting the error.Could you do that?Very loosely speaking, parts of this problem sound like,butmentions Indigo which would rule out 386356and point to something else.I'm not yet able to reproduce this problem in a smaller environment. I could give you access to our Subversion Repository. I think the problem may be related to the interdependent projects and the index management of Eclipse.If subversion access is an option for you, please tell where I should send your credentials.I did not really solve the issue, but I have some work-around.The problem with validation constraints vanished after:- copying all sources to a new workspace (no metadata, no classpath, ...)- create all projects as new- recreate all build paths manuallyThe effect can be reproduced when setting up an annotation processor (self written) which creates Remote Interface classes from annotated bean methods (@GenerateRemote) and create them in another project.So the workaround is to create these files in ".apt_generated" in the same project and regularly start a job to copy newer files into the other project.Well ... not perfect but at least working(In reply to)Thanks for reporting your workaround, which means this no longer is a blocker.Still I'd like to find out if it's a bug in the tool.So I see three kinds of types: A) regular classes written by youB) types created by the annotation processorC) additional annotations inside the validation-api jarIs this list complete?No the compiler complains that C) cannot be found.QUESTIONS: Where is that error reported, against A) or against B)?Does the annotation processor evaluate annotations from C)?	5.0
id=370619	REOPENED	JDT	Core	3.8	All All	P3 normal	JDT-Core-Inbox	2012-02-03 18:52 EST by	Andrew Eisenberg	2012-02-08 06:18 EST (	5 users	To reproduce:1. create Java project2. Add external class folder that is outside the workspace3. Add or remove a non-source file to the folder from the filesystem (eg- using windows explorer or mac finder)4. Select folder in package explorer. Right-click -> Refresh5. nothing happens and external class folder is still empty6. Now, select the java project right-click -> refresh7. Finally, class folder is refreshed and new files appearI would have expected that the refresh works on the class folder itself.	I tried this on Eclipse 4.2 M5 (I guess that would be JDT 3.8 M5). I have not tried on other versions.Whenever you do operations in a filesystem on a file that's not active in the editor, a refresh is needed to show it in package explorer. The other way of doing this would be to simply copy the file in the windows explorer, then click on the folder in package explorer view, and press CTRL+V. The file will be copied into the folder inside Eclipse as well.I think this is expected behavior and not a bugI do not think this is expected behavior. There is a "refresh" menu item on external class folders as well as a refresh menu item on the files themselves. However, these refresh menu items do not work.What I am trying to do is a bit more involved than just having the UI available for refreshes of external folders. But, that was the easiest way of describing and reproducing my actual problem.I am trying to allow my plugin to monitor a folder that is attached to a project as an external class folder. However, when I call IFolder.refreshLocal(DEPTH_INFINITE, monitor) on the folder, nothing happens and the folder is not refreshed.Looks to be a duplicate of.On the face of it, I am not sure.describes an issue where a file appears in a non-external class folder, but not in the folder itself in the workspace. This bug describes an issue where new files do not appear in an external class folder even after a refresh.It may be that the underlying problem is the same for both of these bugs, but the problem being described is different. So, whereas likely related to each other, I do not believe that they are duplicates.Mostly looks like the same issue. Will be considered during investigation of.*** This bug has been marked as a duplicate of***As perc7, I am re-opening this bug.I believe this bug is related tosince both deal with the refreshing of external resources.The DeltaProcessor does not get an event when "refresh" is called on external resources, including external archives.I am not sure if this can be addressed in JDT/UI or platform/resources has to be involved.(In reply to)Mmmh, not true. Here's the stack trace:Thread [Worker-11] (Suspended (breakpoint at line 771 in DeltaProcessor)) DeltaProcessor.checkExternalArchiveChanges(IJavaElement[], boolean, IProgressMonitor) line: 771 DeltaProcessor.checkExternalArchiveChanges(IJavaElement[], IProgressMonitor) line: 764 JavaModel.refreshExternalArchives(IJavaElement[], IProgressMonitor) line: 271 BuildActionGroup$RefreshableViewRefreshAction(RefreshAction).refreshJavaElements(IStructuredSelection, IProgressMonitor) line: 218 BuildActionGroup$RefreshableViewRefreshAction(RefreshAction).performRefresh(IStructuredSelection, IProgressMonitor) line: 194 RefreshAction.access$0(RefreshAction, IStructuredSelection, IProgressMonitor) line: 188 RefreshAction$1.run(IProgressMonitor) line: 182	9.0
id=393934	REOPENED	JDT	Core	4.3	PC Windows 7	P3 major	JDT-Core-Inbox	2012-11-08 17:42 EST by	Sobha Duvvuri	2015-05-13 06:01 EDT (	6 users	Hi,Recently, I modified one class in my project to use a dense enum construct which was using "public static final const int = something" construct before.The Enum structure is really huge and I used a switch case statement in return values from the ENUM construct.There is a huge performance hit and eclipse is very very slow during run-time. I ran the same code on NetBeans and it is really fast.Could you please let me know if there is a bug in Eclipse in the way it handles enums?Thanks,Sobha.	Can you share the file with the problem?(In reply to)What exactly do you mean by this?1. Are you developing a plug-in and running Eclipse with this plug-in is slow?2. Or are you saying that your application when compiled by Eclipse is slow?3. Or is Eclipse slow when working on your application?Your sentence sounds like (1) but given the context I'm guessing you mean (2)(In reply to)(2) was my guess too (I presumed the reporter was not aware that eclipse uses its own compiler)Createdexample project for measurementsI created a naive little example project which produced very interesting measurements:compiled with ecj the execution time is 87mscompiled with javac the execution time is 215msmeasurements were pretty constant actually.From this we should expect the opposite of the reported problem: when compiled in Eclipse the program should run faster than when compiled using javac (as other IDEs do).Thus we need more information on the characteristics of your program, what makes it different from my example program?On top of the naive example I made further experiments to find when the ecj compiled version would be slower, but failed to find a witness.I tried:- using random order enum values in the loop- embedding the switch in an int switch (as mentioned in the forum)- embedding the experiment in an outer loop (10 times)the last experiment obviously triggered JIT and the ecj version came down to 9ms vs. 13ms with javac.Versions used:javac 1.7.0_05ecj HEAD, also tried 4.2 (with similar results)java:Java(TM) SE Runtime Environment (build 1.7.0_05-b06)Java HotSpot(TM) Server VM (build 23.1-b03, mixed mode)For now I'm closing as WORKSFORME, feel free to re-open if you can share information (e.g., example program) that lets us reproduce the problem.Comment onexample project for measurementsHi,Thank you for your analysis and prompt response. I went through your example and it is true that Eclipse is faster in cases where the switch statement is called from one class similar to your test case.In our scenario, many of our classes(approx 1000 classes) switch on enum. The Enum is declared in one class file and has approximately 2500 enum members. We decompiled the .class file that is generated by eclipse and observed that each of the class that uses the switch on enum is initializing the big enum array as many times as the number of usages of the switch statement.This is in contrary to what we were expecting. We were expecting that the Enum class should be treated as a static class and should be initialized only once.Also, may i know if the number of members in Enum structure make a difference in performance given that we have around 2500 members. Please help.Eagerly waiting for your response,(In reply to)Does this match your observation, i.e., does the performance penalty only hit once at program start?I still don't see an example of your problem :)Createdexample project 2 witnessing a load-time problemInspired byI found an example where ecj compiled classes perform worse than javac compiled ones (say "thanks"! :) )our version takes 1100ms on my system, the javac version 35ms.I stripped the example so we can exclude the following:- it has nothing to do with our 2000 elements limit, 1990 elements suffice- I don't have to run the switches many times, touching each method once is enoughOTOH, it was necessary to create a number of classes (here 10 nested classes) each holding one switch statement.So the current hypothesis is: loading each class that switches over a large enum type brings a constant performance penalty.I'm still not sure if that is a bug or a feature: ecj-compiled programs take more time during loading but perform better afterwards. Which is more important?Reopening as we have some data to discuss now.Shankha, please follow up.	10.0
id=399074	REOPENED	JDT	Core	3.8.1	PC Windows XP	P3 critical	JDT-Core-Inbox	2013-01-25 07:38 EST by	Cezary Wagner	2013-02-13 03:50 EST (	1 user	Tested on official android.jar and sources/android-17.Problem is not logged in problems and no feedback why it happen.Same problem in 3.8.1.What I do:1. F3 to go to source code2. No source code screen is open and choose attach source.3. Choose external folder method.4. Points to [Android path]/source/android-17 and choose OK.5. Nothing happen still is no source code screen.Alternativly (preferences changes not save at all):1. Project -> Properties -> Java Build Path -> Libraries.2. Android 4.2 -> android.jar -> source attachement -> edit.3. Choose external folder method.4. Points to [Android path]/source/android-17 and choose OK.5. Preferences show that source attachment is [Android path]/source/android-17.6. Click OK to save setting.7. Reopen Project -> Properties -> Java Build Path -> Libraries.8. BUG: nothing in Android 4.2 -> android.jar -> source attachement - SHOULD BE: what was visible before save Android path]/source/android-17I not allo to analyze code correctly!How to reproduce:1. Install Eclipse.2. Install Android SDK with sources.3. Install Android plugin.4. Try to F3 and Android code.	I suspect this is specific to the Andorid Tooling. They probably provide their own library container.If I add JAR to the Java Build path and then attach source, this works fine usingMaybe this helps:Why it is specific to Android Development Toolkit *.jar and sources is just java?I was tested your solution and many more without success but still has hope that is not Eclipse error and solution will be fast but loosing it since no solution works :)As I said before -> 2. Install Android SDK with sources. - so I was downloaded sources.I will show you this magic on pictures since see that you man of "weak" faith so need more visual examples :)1. I download source ->2. My *.jar in build path ->3. I am attaching valid sources ->4. It looks that source is attached but still is not saved ->5. Now magic bug ->I could reapeat it hundread times and has same result. Not sure if it works in ADT-eclipse-bundle but why it not works in eclipse 3.8.1 with installed Android plugin?Do you belive now that bug exists???Nothing is also logged in error log or no popup with error - any error is presented to user it looks like all exceptions is disabled like:try { i_want_signal();}catch(Exception e) { you_say_nothing() :)}Missed error log:It could be not explained enough:5. Now magic bug ->- it is result of reopen project properties just after shources attachment will be set (but not saved by eclipse without known reason).Here is version and modules installed I am using also Aptana + PyDev + Web Tookit:In Python there is not problem with sources at all (F3 works fast).I don't argue that you see a bug, but your pictures clearly show that the library node is an Andorid library.Can you try this:1. select the project in the 'Package Explorer'2. context menu > Build Path > Configure Build Path...3. switch to 'Libraries' 4. use 'Add JARs...' or 'Add External JARs...' to add the JAR file5. set the source attachment on that JAR6. Verify that the property is now stored and not lost again7. assuming the source attachment is correct, the source should appear.First of all there is no:1. select the project in the 'Package Explorer'2. context menu > Build Path > Configure Build Path...Whatever maybe you mean Properties -> Java build path -> Libraries.I will make video since there is not sens to write if you not belive that it not works maybe you are right or not you will see on video.I am not set sound correctly so you need loud up if it need.(In reply to)The video clarifies it: you do not work/test on a Java project (decorated with a blue 'J') but some other kind of project (probably Android specific). Attaching source works fine for Java projects, so please report your bug against Android Tooling.You are wrong that is Eclipse bug not ADT. I found source and workaround of this bug but not found solution.I will send video soon 10min :)Here is workaround and bug source.User have to make some strange tasks:1. Create external library android-17.jar from library setting android-17.jar.2. Attach source and again documentation and copy excluded paths from already include library android-17.jar - just make mirror copy (why it is need???).3. Delete android-17.jar library and leave ecternal library-17.jar (that is strange for humans).And it works.Now see video how I do this and make source attachments working with F3.Tell me why it so complicated?What difference between "library" and "external library"?Is it possible to configure "Library" to to add sources or not and why is visible that is possible or it is editable - it look like bug if it not possible?When bug could be solved ?Thanks for help in finding workaround it is great solution since I started using Android and could debug and learn it much faster with F3! :)Look, your steps all work with the Android project. That project (kind) is having the bug. Of course, if you provide a video that shows the bug on a pure Java project (with the little blue 'J' decorator on the top-right corner of the project) and with e.g. the steps fromthen please reopen the bug again, but otherwise, please leave it closed. There is nothing we can do here.To rephrase: Android projects and Java projects are not the same thing. They behave differently. So far you have showed me that there is a bug on the Android project. I do not doubt that. BUT: you have not given steps or a video that show a bug on a Java project.I think that you was not seen video carefully and icon decorator has not magic meaning of root cause - it is your interpretation.You completly wrong if you think that Google is change source attachment in Eclipse in own plugin - why they want change what is working - could you explain you theory - it is very weak assumption???I am personnaly think you not able to solve this bug or explain Eclipse behaviour.If have time could test for free in on Java project but not know how to make "library" only "external library" but if you convince me that your weak assumption about decorator is true and explain what is difference between "library" and "external library".You not belive me before I am not belive you now.Forget reopen since it not solved.I was put bug in ADT tracker to agree where is bug if it Eclipse or ADT.Cross link - one bug should be open.We also want our bugs get fixed. I just tried again all the possible combinations based onbut cannot reproduce this on Windows 7 and Linux. Since I can't download the Android tooling (legal reasons), I would be happy if you can tell us your steps based off a Java project (File > New > Java Project) that allow to trigger the bug.I also saw your. As you can see there, another engineer can also not reproduce the problem in plain Eclipse (no ADT) since it also seems to be Android specific. Actually, both problems seem to be the same or at least related. ADT (Android Tooling) is probably providing their own class path (library) container and if they do so, they are responsible of storing and reading its attributes.CreatedMy configurationI have the same kind of problem, but with a default inconsistent value:D:/ProgramFiles/eclipse/eclipse-4.2-java/plugins/com.android.ide.eclipse.source_16.0.0.201112171909/7/sources.zipIf I try and change it, the preference is not saved, the old incorrect value comes back even when I do "remove" in the build path.On this laptop, I do not have a D drive. The default path is the one of my other laptop. However I remember having re-download everything but the project workspace itself.Do you have any idea of where this value could be stored? I searched all the config files I could not find it...Who is in charge of maintaining the "Android library (This container manages classpath entries for Android container)" interface in the build path? If I can't change the real value, where can I force change the default one?(In reply to)As I tried to explain before, this (storing the attributes of the container) is part of the Android tooling. They should debug the problem and if they think it is an Eclipse Platform/JDT issue, report it with more details.	19.0
id=424222	REOPENED	JDT	Core	4.3.1	PC Windows 7	P3 normal	JDT-Core-Inbox	2013-12-17 05:57 EST by	kurt	2014-11-12 03:52 EST (	3 users	simple steps to reproduce:1) create a java-project2) add a sourcefolder named properties3) there add a package named properties4) there add a file named any.properties5) type anything in the file6) save7) delete the sourcefolder8) check in file-system: the properties-folder and it's content is still there ! and seen by newly started java-programs (ofcourse in more complex setups)i consider this a critical bug because:a) in development you can't be sure what config you are runnung against, what class-files are in use, ...b) in deployment resources that should not be deployed could leave your house.	This bug still exists in the latest Eclipse 4.4:Version: Luna (4.4)Build id: I20140606-1215Also I investigated a little more and found some other similar issues.Copying the properties-package with any.properties in it from the second sourcefolder to the default-sourcefolder (src).This should bring up the warning "Duplicated resources" - it does not.After cleaning the project it does.Deleting the second sourcefolder clears that warning.Recreating the second sourcefolder with package properties and any.properties does not bring up the expected warning.After renaming (in Eclipse ofcourse) any.properties in src-sourcefolder to any2.properties does that in bin-folder too, but does not copy any.properties from second sourcefolder to bin.Cleaning the projects "corrects" that - now both .properties are in bin folder.Now deleting the second sourcefolder leaves any.properties in bin-folder.I still believe that is a major problem, as in development you always had to clean your projects, to be sure that your program sees the right configuration (or what ever other ill-managed resource-files one depends upon).Hopefully now after more than half a year someone will take care of this bug.Jay, please take a look.(In reply to kurt from)Sorry for not responding to this bug report earlier. But I am not able to reproduce this bug in my environment (has last official build Luna).Can you tell me how you are trying to delete? From Package Explorer? Navigator? I can delete the source folder without any problem. Of course, when the folder is open by any other application, you will get an error that it is being used. But that's the expected behavior. Do you have a simple project where the bug can be seen?(In reply to kurt from)Hmm... I see we are actually allowing resources with same name to be present as long as they are in different folders. Even if they are in the same package, what happens is they get overwritten in the bin folder when the second resource (.java or .properties) is processed/compiled. Again, it will help if you can provide us the testcase in an isolate project.I suspect that you have auto-build disabled. In that case the bin folder will stay until the next build is triggered.CreatedTestproject - for problem when deleting the second sourcefoldersee my last messageJust to be sure that autobuild was enabled I followed the steps from my very first message - exactly the result as described.(The name of the second sourcefolder is irrelevant.)I added the project I tested with.There is a test-class test.CheckProperties in the default-sourcefolder, which you may run before and after deleting the second sourcefolder.(In reply to kurt from)Thanks Kurt, I can reproduce now. Though, this happens only when there is no other java resource in that source. And looks like this has been this way for some time. From a quick investigation, it looks like we conclude that a build is not required because there are no java resources in the source folder being deleted. For future investigation, here are the stacks that are of interest. First, the compilation unit state is stored along with its source folder info:SimpleLookupTable.put(Object, Object) line: 97 State.recordLocatorForType(String, String) line: 188 IncrementalImageBuilder(AbstractImageBuilder).acceptResult(CompilationResult) line: 185 Compiler.compile(ICompilationUnit[]) line: 510 Later, the CU state is looked up to find whether or not deleting a source folder should trigger a new build:State.isSourceFolderEmpty(IContainer) line: 164 JavaBuilder.hasClasspathChanged() line: 519 JavaBuilder.build(int, Map, IProgressMonitor) line: 181looks similar.For your information - bug is still present in Eclipse 4.5M2: Version: Mars (4.5) Build id: I20140918-0330I am not sure I can spare time for this,, at least during Mars. Meanwhile, if someone if interested in working on this, can take a look.	11.0
id=422654	REOPENED	JDT	Core	4.4	PC Linux	P3 normal	JDT-Core-Inbox	2013-11-27 05:21 EST by	Thomas WERMESTER	2014-09-15 03:52 EDT (	2 users	CreatedLog fileVersion: Luna ReleaseBuild id:20131113-1838Eclipse close suddenly without any message	CreatedEclipse configurationorg.eclipse.core.runtime.CoreException: The builder launch configuration could not be found.Caused by: java.io.FileNotFoundException: /home/thomas/work/checkout/git/ok-marche/xmarches/target/test-classes/com/oodrive/omnikles/marches/web/controller/RecordControllerTest.class (Aucun fichier ou dossier de ce type)I doubt that there is anything for us to do here. Please check your set up.ok for error! but it's normally eclipse close without save current file if it not found a file ?Good question. Reopening.There are quite a few exceptions in the given log file. Assuming you took the log file after reopening eclipse (after the crash, i.e.) the last exception I see before the restart is this:java.lang.RuntimeException at org.eclipse.jface.viewers.ColumnViewer.checkBusy(ColumnViewer.java:797) at org.eclipse.jface.viewers.AbstractTableViewer.replace(AbstractTableViewer.java:1072) at org.eclipse.ui.dialogs.FilteredItemsSelectionDialog$ContentProvider.updateElement(FilteredItemsSelectionDialog.java:2898)But I don't know I can move this to other components yet.Thomas, is this something you can reproduce always? If so, can you please provide the steps and resources required to reproduce?BTW, I am moving the bug out of M4 as it's late for the milestone.there are not steps to reproduce, because problem is very random. I feel problem can be provided when a file containing javascript is open. But I'm not sure is the only one case to reproduce problem.For log I'm not totally sure that provided when i restart after closed error. So when i will reproduce the problem, i will post a new stack trace.What do you need kind of resources? Do you need plugin configuration?I am sorry for my poor english.(In reply to Thomas WERMESTER from)Sure, please do that. By resources I meant, anything that might be required to reproduce the bug in our environment - it could be the additional plug-ins you have installed or a library that you have in your project's build path. But the first step would be to find the error that forced eclipse to shut down.CreatedLog file eclipseThis new log file is extract after restart caused by errorcurrent plugin install on my eclipse luna: CollabNet Merge Client 3.0.13 Eclipse IDE for Java EE Developers 2.1.0.20131103-0830 Eclipse Platform 4.4.0.I20131030-2000 Java EE IDE Feature 2.1.0.20131103-0830 Subclipse (Required) 1.8.22 Subclipse Integration for Mylyn 3.x (Optional) 3.0.0 Subversion Client Adapter (Required) 1.8.6 Subversion JavaHL Native Library Adapter 1.7.10 Subversion Revision Graph 1.1.1 SVNKit Client Adapter (Not required) 1.7.9.2before all this error messageeclipse.buildId=4.4.0.I20131030-2000java.version=1.7.0_25java.vendor=Oracle CorporationBootLoader constants: OS=linux, ARCH=x86_64, WS=gtk, NL=fr_FRFramework arguments: -product org.eclipse.epp.package.jee.productCommand-line arguments: -os linux -ws gtk -arch x86_64 -product org.eclipse.epp.package.jee.productErrorMon Dec 09 17:15:22 CET 2013A workspace crash was detected. The previous session did not exit normally. Not using saved taglib indexes.which execute probably at restart, i have this erroreclipse.buildId=4.4.0.I20131030-2000java.version=1.7.0_25java.vendor=Oracle CorporationBootLoader constants: OS=linux, ARCH=x86_64, WS=gtk, NL=fr_FRFramework arguments: -product org.eclipse.epp.package.jee.productCommand-line arguments: -os linux -ws gtk -arch x86_64 -product org.eclipse.epp.package.jee.productErrorTue Dec 10 17:59:18 CET 2013Unable to retrieve the bundle from the URI: bundleclass://net.w3des.extjs.ui/net.w3des.extjs.ui.handler.RefreshJSOReclipse.buildId=4.4.0.I20131030-2000java.version=1.7.0_25java.vendor=Oracle CorporationBootLoader constants: OS=linux, ARCH=x86_64, WS=gtk, NL=fr_FRFramework arguments: -product org.eclipse.epp.package.jee.productCommand-line arguments: -os linux -ws gtk -arch x86_64 -product org.eclipse.epp.package.jee.productErrorTue Dec 10 17:58:59 CET 2013Error restoring branch-project associationsjava.lang.reflect.InvocationTargetException at org.eclipse.egit.ui.internal.clone.ProjectUtils.createProjects(ProjectUtils.java:115) at org.eclipse.egit.ui.internal.branch.BranchProjectTracker.restore(BranchProjectTracker.java:269) at org.eclipse.egit.ui.internal.branch.BranchProjectTracker.restore(BranchProjectTracker.java:230) at org.eclipse.egit.ui.internal.branch.BranchOperationUI$1$2.postExecute(BranchOperationUI.java:232) at org.eclipse.egit.core.op.BaseOperation.postExecute(BaseOperation.java:59) at org.eclipse.egit.core.op.BranchOperation$1.run(BranchOperation.java:156) at org.eclipse.core.internal.resources.Workspace.run(Workspace.java:2346) at org.eclipse.core.internal.resources.Workspace.run(Workspace.java:2328) at org.eclipse.egit.core.op.BranchOperation.execute(BranchOperation.java:162) at org.eclipse.egit.ui.internal.branch.BranchOperationUI$1.run(BranchOperationUI.java:237) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:53)Caused by: org.eclipse.core.internal.resources.ResourceException: Invalid project description. at org.eclipse.core.internal.resources.Project.checkDescription(Project.java:175) at org.eclipse.core.internal.resources.Project.assertCreateRequirements(Project.java:53) at org.eclipse.core.internal.resources.Project.create(Project.java:287) at org.eclipse.core.internal.resources.Project.create(Project.java:269) at org.eclipse.egit.ui.internal.clone.ProjectUtils.createExistingProject(ProjectUtils.java:156) at org.eclipse.egit.ui.internal.clone.ProjectUtils.access$0(ProjectUtils.java:119) at org.eclipse.egit.ui.internal.clone.ProjectUtils$1.run(ProjectUtils.java:91) at org.eclipse.core.internal.resources.Workspace.run(Workspace.java:2346) at org.eclipse.core.internal.resources.Workspace.run(Workspace.java:2328) at org.eclipse.egit.ui.internal.clone.ProjectUtils.createProjects(ProjectUtils.java:111) ... 10 moreRoot exception:org.eclipse.core.internal.resources.ResourceException: Invalid project description. at org.eclipse.core.internal.resources.Project.checkDescription(Project.java:175) at org.eclipse.core.internal.resources.Project.assertCreateRequirements(Project.java:53) at org.eclipse.core.internal.resources.Project.create(Project.java:287) at org.eclipse.core.internal.resources.Project.create(Project.java:269) at org.eclipse.egit.ui.internal.clone.ProjectUtils.createExistingProject(ProjectUtils.java:156) at org.eclipse.egit.ui.internal.clone.ProjectUtils.access$0(ProjectUtils.java:119) at org.eclipse.egit.ui.internal.clone.ProjectUtils$1.run(ProjectUtils.java:91) at org.eclipse.core.internal.resources.Workspace.run(Workspace.java:2346) at org.eclipse.core.internal.resources.Workspace.run(Workspace.java:2328) at org.eclipse.egit.ui.internal.clone.ProjectUtils.createProjects(ProjectUtils.java:111) at org.eclipse.egit.ui.internal.branch.BranchProjectTracker.restore(BranchProjectTracker.java:269) at org.eclipse.egit.ui.internal.branch.BranchProjectTracker.restore(BranchProjectTracker.java:230) at org.eclipse.egit.ui.internal.branch.BranchOperationUI$1$2.postExecute(BranchOperationUI.java:232) at org.eclipse.egit.core.op.BaseOperation.postExecute(BaseOperation.java:59) at org.eclipse.egit.core.op.BranchOperation$1.run(BranchOperation.java:156) at org.eclipse.core.internal.resources.Workspace.run(Workspace.java:2346) at org.eclipse.core.internal.resources.Workspace.run(Workspace.java:2328) at org.eclipse.egit.core.op.BranchOperation.execute(BranchOperation.java:162) at org.eclipse.egit.ui.internal.branch.BranchOperationUI$1.run(BranchOperationUI.java:237) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:53)Contains: OKContains: /home/thomas/work/checkout/git/ok-marche/xmarches overlaps the location of another project: 'okmarches'OR eclipse.buildId=4.4.0.I20131030-2000java.version=1.7.0_25java.vendor=Oracle CorporationBootLoader constants: OS=linux, ARCH=x86_64, WS=gtk, NL=fr_FRFramework arguments: -product org.eclipse.epp.package.jee.productCommand-line arguments: -os linux -ws gtk -arch x86_64 -product org.eclipse.epp.package.jee.productErrorMon Dec 09 16:51:21 CET 2013Exception when synchronizingjava.lang.NullPointerException at org.eclipse.core.internal.filebuffers.ResourceTextFileBuffer.handleFileContentChanged(ResourceTextFileBuffer.java:515) at org.eclipse.core.internal.filebuffers.ResourceFileBuffer$2.execute(ResourceFileBuffer.java:151) at org.eclipse.core.internal.filebuffers.ResourceFileBuffer$SafeFileChange.run(ResourceFileBuffer.java:86) at org.eclipse.core.internal.filebuffers.ResourceFileBuffer$FileSynchronizer.resourceChanged(ResourceFileBuffer.java:182) at org.eclipse.core.internal.events.NotificationManager$1.run(NotificationManager.java:291) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.core.internal.events.NotificationManager.notify(NotificationManager.java:285) at org.eclipse.core.internal.events.NotificationManager.broadcastChanges(NotificationManager.java:149) at org.eclipse.core.internal.resources.Workspace.broadcastPostChange(Workspace.java:396) at org.eclipse.core.internal.resources.Workspace.endOperation(Workspace.java:1531) at org.eclipse.core.internal.resources.Resource.touch(Resource.java:1963) at org.eclipse.jst.jsp.core.internal.taglib.TaglibHelperManager$2.visit(TaglibHelperManager.java:120) at org.eclipse.core.internal.resources.Resource$1.visitElement(Resource.java:85) at org.eclipse.core.internal.watson.ElementTreeIterator.doIteration(ElementTreeIterator.java:82) at org.eclipse.core.internal.watson.ElementTreeIterator.doIteration(ElementTreeIterator.java:86) at org.eclipse.core.internal.watson.ElementTreeIterator.doIteration(ElementTreeIterator.java:86) at org.eclipse.core.internal.watson.ElementTreeIterator.doIteration(ElementTreeIterator.java:86) at org.eclipse.core.internal.watson.ElementTreeIterator.doIteration(ElementTreeIterator.java:86) at org.eclipse.core.internal.watson.ElementTreeIterator.doIteration(ElementTreeIterator.java:86) at org.eclipse.core.internal.watson.ElementTreeIterator.doIteration(ElementTreeIterator.java:86) at org.eclipse.core.internal.watson.ElementTreeIterator.doIteration(ElementTreeIterator.java:86) at org.eclipse.core.internal.watson.ElementTreeIterator.iterate(ElementTreeIterator.java:127) at org.eclipse.core.internal.resources.Resource.accept(Resource.java:95) at org.eclipse.core.internal.resources.Resource.accept(Resource.java:52) at org.eclipse.jst.jsp.core.internal.taglib.TaglibHelperManager$1.run(TaglibHelperManager.java:117) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:53)Thanks for the log files.I see multiple exceptions that seem to have contributed multiple crashes. If you haven't already done so, can you clear the log file once and share the log when it crashes again (without restarting eclipse). Basically, we need to be absolutely sure that we are looking at the correct exception.We haven't heard from the reporter yet and I am assuming the error hasn't occurred yet. Resetting the target.	12.0
id=394475	REOPENED	JDT	Core	4.2.1	PC Windows 7	P3 normal	JDT-Core-Inbox	2012-11-16 10:51 EST by	Gábor Lipták	2012-12-13 06:07 EST (	1 user	Usually I find good to use generic interfaces like. I do not have to create a lot of interfaces just to say, that I want something that gives back a String from a File. However if I look for implementations it makes life harder.For example I create a class like this:public class Bla implements Function<File,String> { public String apply(File file) { return ""; }}It would be awesome, if i could ask for call hierarchy on "apply" method and eclipse could show me only the invocations of "apply" method of Function interface, where the Parameters are File and String. Otherwise it is hard to track down, where this class could be used, or is used (if you use dependency injection, then its really hard).Similarly it would be nice to have some Java based search, which is aware of Parameter classes. For example I could look for Function implementations, where parameters are String and File. Maybe this exists, but I don't know how to use it.	The Call Hierarchy (Ctrl+Alt+H) and Quick Hierarchy (Ctrl+T) on the correct method does the trick for me. Note that in your example #apply only takes one argument, so "It would be awesome, if i could ask for call hierarchy on "apply" method and eclipse could show me only the invocations of "apply" method of Function interface, where the Parameters are File and String."will be hard to satisfy.If it still does not work for you using Juno SR1 (4.2.1), then please add a more detailed example. Note that accessing source outside Eclipse can be a legal problem for some Eclipse developers, so please provide the complete example in the bug report.After work I try to create detailed report with screenshots and code samples.CreatedDemo projectCreatedmy versionCreatedCall hierarchy is not correctCreatedCode completion could suggest a classI tried hard, and I have found two cases, when generics could be handled better. See in the pictures. You can use my demo project to reproduce.(In reply to)Sorry, I can't use the demo project as it uses com.google.common.base which can't download. Could you provide a self-contained example please.CreatedDemo project with removed guava lib self contained sampleCreatedCall hierarchy shows now nothingIts really strange. Now the call hierarchy shows exactly nothing. The second thing with the code completion thing remained the same.(In reply to)I do get the hierarchy when using your example in a new workspace. Thanks!Content assist does not propose all possible constructors after "new " for performance reasons. You have to type at least 1 character and then 'DoublePredicate' will be proposed. Also, this will be cached and the next time you complete after "new ", it will propose it.The other issue with the call hierarchy on FunctionList2Map.apply(List<Double>) is a bug. It used to work in 3.7. I suspect this got broken by the fix for.Code completion:With me it happens really often, that I have no idea how a specific implementation is called. Then I just press the CTRL+SPACE and I expect a result. I however understand, that with a lot of classes it can result in performance problems.It could work however as a limited search. So for example like this:- examining a given number of classes (for example 1000), or for a given timeframe (500 msec for example). If there are more to analyse as possible result, then we just could have a message in the code completion box like: "more than 1000 results, be more specific"- if the limit is not hit, then the results could be displayed- if the limit is hit, the user could still say that i dont care, just do itWhat do you think?(In reply to)When there's no prefix we show what's currently "visible", not just for constructor completion but also when doing type completion. We don't want to change this.	13.0
id=495674	REOPENED	JDT	Core	4.5	PC Windows 7	P3 major	JDT-Core-Inbox	2016-06-08 07:05 EDT by	Stik Dragon	2017-02-23 10:05 EST (	3 users	With the following code, typing single '.' character on the line immediately after the 'case' statement causes Eclipse to lock up. As if you meant to type 'a.something' but didn't quite catch the first key. public class CrashEclipse { public void f() { Function<String, String> func = a -> { switch (a.length()) { case 1: // typing a . here crashes eclipse } return null; }; }}Also present in older version, 4.4.2	I cannot reproduce the crash in Eclipse 4.5 or 4.6. Do you have any logs?There is a long delay after typing a dot and then Eclipse becomes responsive again. The delay is seen in returning from ICodeAssist.codeComplete(int offset, CompletionRequestor requestor, IProgressMonitor monitor).Something is definitely wrong here.After pasting the code and organizing the imports, content assist at the mentioned location does not give me any proposals, e.g.Str<Ctrl+Space>I don't have any error logs. I guess "crash" is the wrong description, it simply becomes unresponsive and i end-task the process. I've just tried leaving it to see how long it would take, but after 15 minutes it still has not returned.How long is "a long delay" for you?(In reply to Stik Dragon from)4 seconds.I've just installed a fresh version of Mars, and i see a 5 or 6s delay now. I then tried installing, which i use on my other installs, and the problem has reappeared. I guess this means it is not an issue with Eclipse itself. I will report the bug with the plugin instead.(In reply to Stik Dragon from)Thanks for the update Stik, but there's still something wrong (see my).This might be a duplicate of 495674	7.0
id=435855	REOPENED	JDT	Core	4.4.2	PC Linux	P3 critical	JDT-Core-Inbox	2014-05-27 03:01 EDT by	Rong Nguyen	2015-04-24 22:49 EDT (	3 users	I using Eclipse 4.4 RC1 to developer OFBiz application.When i work with 4.3.2: everything are ok, but with 4.4 RC1: when i start OFBiz application, the CPU usage of Eclipse always greater than 25%.	I start OFBiz application by Ant build tool, when i set up JRE for Ant with option "Separate JRE" and chose the difference one, the problem will come as i described.When "Run in the same JRE as the workspace" => no issue.But the issue does not occur on Eclipse 4.3.*(In reply to Rong Nguyen from)Please make several stack traces while the CPU is high and then attach them here.We can't do anything without further information.Sorry for slow response.Now, i run Eclipse 4.4.2 RC2 and the application is Apache OFBiz.My flatform:- OS: Fedora 21- Java: Sun JSK 1.6.45I don't see any "stack traces while the CPU is high" or anything else!(In reply to Rong Nguyen from)Please refer to this page on reporting performance problems with eclipse:And share the details here.(In reply to Jay Arthanareeswaran from)Thanks you the the reply,1. What build of Eclipse you are using (see Help > About): - Build id: 20150219-06002. What VM you are using (version and vendor). Use "java -version" to find out version information. - java version "1.6.0_45" Java(TM) SE Runtime Environment (build 1.6.0_45-b06) Java HotSpot(TM) 64-Bit Server VM (build 20.45-b01, mixed mode)3. What you were doing at the time of the deadlock (what dialog, wizard, editor, etc) - Just start Apache OFBiz application by selecting 'start-debug' ant task.4. Your JVM configuration: how much memory is being allocated to the JVM - 4GB5. Your machine configuration: how much RAM, how much RAM is free, was it swapping - RAM: 8GB, 5GB is free, 8GB swap6. Whether it is reproducible; if so, provide steps -There is no stack trace.Thanks, this gives a start but no hint yet regarding the actual cause of your problem.(In reply to Rong Nguyen from)Have you tried to follow the advice on getting a stack trace in?By "steps" we mean a list of instructions how we could replay the problem on our side: what do we need to do in order to run into the same problem?Sorry for late reply.I can not create enough steps in your link.The following steps is the step which caused the error:1. Download any version of OFBiz in this link:2. Import OFBiz project to Eclipse.3. Drag build.xml file to ant window.4. Find "start-debug" task.5. Right mouse to choose the JRE configuration to start ant task6. In JRE tab, choose: "Separate JRE"(pick any jre version)7. Execute "start-debug" task8. See the CPU is very high.Now, I have to choose "Run in the same JRE as the workspace", but this option can not run others task, it only be done in console...Thank you again for the corporation :-)	9.0
id=502241	REOPENED	JDT	Core	4.6	PC Windows NT	P3 normal	JDT-Core-Inbox	2016-09-27 08:26 EDT by	James Nord	2016-09-28 05:27 EDT (	1 user	Launching a scrapbook on Windows fails due to the path being too long.Eclipse should be using unicode APIs which do not suffer from the path lengh issue. (#327193 was similarly fixed but the scrapbook still has issues).Unable to launch scrapbook VM Exception occurred executing command line. Cannot run program "C:\Java\jdk1.8.0_91\bin\javaw.exe" (in directory "C:\workarea\source\github\xxxxxxxxx\xxxxxxxxxx-xxxxxx-xxx\xxxxxxxxxx-xxxxxx-xxxxxxxxx\xxxxxxxxxx-xxxxxx-xxxxxxxxx-xxxxxxxx"): CreateProcess error=206, The filename or extension is too longindividual characters where replaced with an x above...The full length of the path including the filename (.scrapbook.jpage) is 139 characters - which is below the 260 MAX_PATH for DOS.Installation Details and versions: Code Recommenders for Java Developers 2.4.0.v20160607-1609 org.eclipse.recommenders.rcp.feature.feature.group Eclipse Code Recommenders Dynamic Languages Toolkit - Ruby Development Tools 5.5.0.201605241149 org.eclipse.dltk.ruby.feature.group Eclipse DLTK Eclipse Git Team Provider 4.4.0.201606070830-r org.eclipse.egit.feature.group Eclipse EGit Eclipse Git Team Provider - Task focused interface 4.4.0.201606070830-r org.eclipse.egit.mylyn.feature.group Eclipse EGit Eclipse GitHub integration with task focused interface 4.4.0.201606070830-r org.eclipse.mylyn.github.feature.feature.group Eclipse EGit Eclipse Java Development Tools 3.11.2.v20160212-1500 org.eclipse.jdt.feature.group Eclipse.org Eclipse Java EE Developer Tools 3.8.0.v201605251556 org.eclipse.jst.enterprise_ui.feature.feature.group Eclipse Web Tools Platform Eclipse Java Web Developer Tools 3.7.1.v201512021921 org.eclipse.jst.web_ui.feature.feature.group Eclipse Web Tools Platform Eclipse Platform 4.6.0.I20160606-1100 org.eclipse.platform.ide Eclipse.org Eclipse XML Editors and Tools 3.7.2.v201511240257 org.eclipse.wst.xml_ui.feature.feature.group Eclipse Web Tools Platform m2e - Maven Integration for Eclipse (includes Incubating components) 1.7.0.20160504-0322 org.eclipse.m2e.feature.feature.group Eclipse.org - m2e m2e connector for build-helper-maven-plugin 0.15.0.201207090124 org.sonatype.m2e.buildhelper.feature.feature.group Sonatype, Inc. m2e connector for the Maven Dependency Plugin 0.0.4.201409291703 com.ianbrandt.tools.m2e.mdp.feature.feature.group null	*** This bug has been marked as a duplicate of***@Jay Arthanareeswaran - WHAT? You are duplicating this on BUGSPAM? This is a valid report - why do you consider it BUGSPAM?NO comment on either bug as to why this is a duplicate of BUGSPAM so re-opening as this is a distinct issue	3.0
id=458508	REOPENED	JDT	Core	4.4.1	PC Windows 8	P3 major	JDT-Core-Inbox	2015-01-27 06:18 EST by	Alexander Veit	2015-02-10 07:41 EST (	1 user	CreatedSceenshot"Team/Update to HEAD" hangs for arbitrary projects in the workspace. The progress view shows a task "Refreshing external folders" for /.org.eclipse.jdt.core.external.folders/.link16 which does not exist. After > 3 minutes the task completes.When I try to update several projects at once, the tasks seem to hang forever.The workspace contains 63 projects with 5 of them closed.	CreatedCurrent Eclipse configurationThere is no "Refreshing external folders" line in Subversive and there is no action like "Team/Update to HEAD". And so, it seems to be a Subclipse's issue, not Subversive's.You're right, it's not Subversive.I even doubt that this is a bug in Subversion since refreshing is a feature of Eclipse itself.And indeed, if I manually refresh a project from the context menu in the Navigator tree the same problem occurs.Please assign the appropriate "Product" to this bug - I do not understand the cryptic entries in the above list. ;-)(In reply to Alexander Veit from)All right, I tried to google it by "Refreshing external folders" and found it is probably the JDT component. So, I'll reassign the bug.(In reply to Alexander Gurov from)Alexander, thanks a lot!Can you please provide us a thread dump when it hangs?Refer toAfter some search with Google I removed all source attachments from all projects in the workspace. This, despite it is not a solution, fixed the problem.To create the thread dump I have once again attached JDK 8 sources from the Java.NET Mercurial repository stored on a network share. The thread that seemed to hang wasName: Worker-7State: RUNNABLETotal blocked: 1.826 Total waited: 19Stack trace: java.io.WinNTFileSystem.list(Native Method)java.io.File.list(File.java:1122)org.eclipse.core.internal.filesystem.local.LocalFile.childNames(LocalFile.java:95)org.eclipse.core.filesystem.provider.FileStore.childStores(FileStore.java:124)org.eclipse.core.filesystem.provider.FileStore.childInfos(FileStore.java:106)org.eclipse.core.internal.localstore.UnifiedTree.getLocalList(UnifiedTree.java:346)org.eclipse.core.internal.localstore.UnifiedTree.addChildren(UnifiedTree.java:138)org.eclipse.core.internal.localstore.UnifiedTree.addNodeChildrenToQueue(UnifiedTree.java:244)org.eclipse.core.internal.localstore.UnifiedTree.accept(UnifiedTree.java:110)org.eclipse.core.internal.localstore.FileSystemResourceManager.refreshResource(FileSystemResourceManager.java:920)org.eclipse.core.internal.localstore.FileSystemResourceManager.refresh(FileSystemResourceManager.java:904)org.eclipse.core.internal.resources.Resource.refreshLocal(Resource.java:1705)org.eclipse.core.internal.resources.Resource.createLink(Resource.java:711)org.eclipse.core.internal.resources.Resource.createLink(Resource.java:647)org.eclipse.jdt.internal.core.ExternalFoldersManager.createLinkFolder(ExternalFoldersManager.java:175)org.eclipse.jdt.internal.core.ExternalFoldersManager.createPendingFolders(ExternalFoldersManager.java:204)org.eclipse.jdt.core.JavaCore.initializeAfterLoad(JavaCore.java:4074)org.eclipse.jdt.internal.ui.InitializeAfterLoadJob$RealJob.run(InitializeAfterLoadJob.java:36)org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)However, since this was a test, I don't know if this is the same as in the original problem.	7.0
id=507758	REOPENED	JDT	Core	4.6	PC Windows 7	P3 enhancement	JDT-Core-Inbox	2016-11-18 08:16 EST by	Torge Kummerow	2016-12-06 14:13 EST (	3 users	Overview: If the value part of a HashMap is defined as @NonNull, and I get a value via a key, the result still can be null if the key does not exist. So a null check is still neccessary afterwards but gets highlighted as redundantSteps to Reproduce: Set "Redundant Null Check" in Java/Compiler/Error&Warnings to info or aboveimport java.util.HashMap;import org.eclipse.jdt.annotation.NonNullByDefault;import org.eclipse.jdt.annotation.Nullable;@NonNullByDefaultpublic class NullAnnotationTest2 { static HashMap<String, String> map = new HashMap<>(); public static void main(String[] args) { @Nullable final String testString = NullAnnotationTest2.map.get(""); if (testString != null) { System.out.println(testString); } }}Actual Results:if(testString != null) gets highlighted as: "Redundant null check: The variable testString cannot be null at this location"Expected Results: No highlightingBuild Date & Hardware: Version: Neon.1a Release (4.6.1)Build id: 20161007-1200Windows 7org.eclipse.jdt.annotation_2.1.0.v20160418-1457.jarAdditional Information: @NonNullByDefault extends HashMap<String, String> to HashMap<@NonNull String, @NonNull String>. If I overwrite this by saying:static HashMap<String, @Nullable String> map = new HashMap<>();The highlighting stops. But I still think that it also should not highlight with static HashMap<String, @NonNull String> map = new HashMap<>();As this only means that I am not allowed to use put() with null values and that I am guaranteed, that when iterating over the entrySet that there are no null values. But if I try to get a value by a key, it still can return null if the key does not exist.	Ok, I guess I just understood the problem, and how Annotation in combination with Generic work...Mentioned in the section "Substitution" @So this is not really a bug. I understand I would have to solve this by somewhow specifying external null annotations.I'll see how this work. Closing this bug report again.After fighting witt External Null Annotations and failing to get them run I think maybe an "option" would be nice to, by default, threat such cases as "Potentially null" instead of showing the warning: Unsafe interpretation of method return type as '@NonNull' based on the receiver type 'HashMap<@NonNull ServiceState,@NonNull Integer>'. Type 'HashMap<K,V>' doesn't seem to be designed with null type annotations in mindSo a null check is required after accessing such function like the Map.get function.Getting rid of such warnings by using external annotations seems didious. And I would prefer to just add an additional null check in such a case, without getting an "redundand" warning for it.Just to be clear, when that option is enabled this code would be free of any warnings:import java.util.HashMap;import org.eclipse.jdt.annotation.NonNullByDefault;import org.eclipse.jdt.annotation.Nullable;@NonNullByDefaultpublic class NullAnnotationTest2 { static HashMap<String, String> map = new HashMap<>(); public static void main(String[] args) { String testString = NullAnnotationTest2.map.get(""); if (testString != null) { System.out.println(testString); } }}Of all things, mostlylooks fishy: - we're about to report: Unsafe interpretation of method return type as '@NonNull' ...- but assigning this value to a @Nullable variable silences this- still we trust the @NonNull value and flag the null check as redundantI'd favor treating the value as really-nullable, rather than adding yet another option.If that is fixed you can use the assignment to @Nullable to override the "unsafe interpretation as @NonNull".OTOH, there's nothing better than using external annotations to mark get() as returning nullable.	4.0
id=470208	REOPENED	JDT	Core	4.5	PC Linux	P3 normal	JDT-Core-Inbox	2015-06-15 13:46 EDT by	Lars Vogel	2016-09-13 05:43 EDT (	2 users	AFAICS the Map in org.eclipse.jdt.internal.codeassist.impl.AssistOptions is only used with String, String parameters. The IJavaProject.getOptions which is used for constructing an instance of this object via InternalNamingConventions#removeVariablePrefixAndSuffix also states that is only returns Map<String, String>. See also.	I have a pending patch for this, I add it onceis reviewed.No plans to work on this, hence marking as wontfix to clean my queueLet's keep this one open if someone else wants to work on.	3.0
id=507567	REOPENED	JDT	Core	4.7	PC Linux	P3 major	JDT-Core-Inbox	2016-11-15 15:49 EST by	Stephan Herrmann	2017-01-25 04:45 EST (	3 users	See, e.g.,and also recent gerrit builds.I can also see it in the IDE (running on linux).	Caused by a change inAdditionally, I just found this:(In reply to Maxime Daniel from)Since we have JDK 6 by now, if we keep the test, we should make it portable!New Gerrit change created:In order to push the fix forvia gerrit / hudson I had to temporarily disable the test in question - until decision is made whether the expected exception is essential or not.Raising priority to blocker since this basically blocks development on JDT core.(In reply to Stefan Xenos from)Not sure what you mean. Is it still blocking tests after Stephan disabled the test?I saw it fail last night:...but perhaps I didn't leave enough time for his change to propogate. I'll see if it happens again and will raise the priority if it recurs.(In reply to Stefan Xenos from)it looks like you rebased only for patch set #3 and since then you're fighting different bugs, right?Builds are passing again. Marking this as fixed.(In reply to Jay Arthanareeswaran from)Jay, I only disabled the failing test to enable development via gerrit/hudson. Do you really see that as a solution? I see nothing that I could take credits for. Sorry for being a pita ... :)(In reply to Stephan Herrmann from)Sorry about that. Sometimes book keeping gets tedious :)	11.0
id=508860	REOPENED	JDT	Core	4.7	PC Windows 7	P3 normal	JDT-Core-Inbox	2016-12-07 17:08 EST by	Patrick Tasse	2016-12-09 04:11 EST (	5 users	Occurs regularly, latest with build I20161204-2000!ENTRY org.eclipse.jdt.core 4 4 2016-12-05 09:40:05.545!MESSAGE Background Indexer Crash Recovery!STACK 0java.lang.OutOfMemoryError: Requested array size exceeds VM limit at org.eclipse.jdt.internal.compiler.util.HashtableOfObject.<init>(HashtableOfObject.java:38) at org.eclipse.jdt.internal.core.index.DiskIndex.readCategoryTable(DiskIndex.java:663) at org.eclipse.jdt.internal.core.index.DiskIndex.mergeCategory(DiskIndex.java:466) at org.eclipse.jdt.internal.core.index.DiskIndex.mergeCategories(DiskIndex.java:458) at org.eclipse.jdt.internal.core.index.DiskIndex.mergeWith(DiskIndex.java:560) at org.eclipse.jdt.internal.core.index.Index.save(Index.java:197) at org.eclipse.jdt.internal.core.search.indexing.IndexManager.saveIndex(IndexManager.java:939) at org.eclipse.jdt.internal.core.search.indexing.IndexManager.saveIndexes(IndexManager.java:981) at org.eclipse.jdt.internal.core.search.indexing.IndexManager.notifyIdle(IndexManager.java:676) at org.eclipse.jdt.internal.core.search.processing.JobManager.run(JobManager.java:379) at java.lang.Thread.run(Thread.java:745)	I don't recall we ever going over the 2GB limit for array size.Can something go wrong while reading? If not, how did we manage to write it in first place.Copying Stefan and Manoj for comments.See also, which requests better error handling for this case. We can investigate the root cause here.I've had a bunch of reports of this from my own users in the past week. I can't reproduce it myself but I have a user who can reproduce it consistently.- The user reported that his largest index file was 56 megs. That was unusually large but wasn't nearly large enough to cause this sort of overflow.- I asked the user to delete the index manually and restart Eclipse. He reported that the problem came back within an hour of restarting.This leads me to suspect that the index is corrupt - not just overflowing - and that the index is being corrupted by something inside Eclipse.Yep, that is a dup.*** This bug has been marked as a duplicate of***I'd suggest we use two bugs to track, separately, better error handling in the case of a corrupt index () and whatever is causing the frequent corruption in the builds from the past few weeks (this bug).Note that this only affects the legacy index so it will go away once we replace the legacy index with the new one. However, that is still a long way away so it's still worth trying to fix this in the meantime.FYI, initially I had "Disable new Java index" unchecked (having never changed the preference) when I noticed the problem a few times. Then I checked the option to disable the new index, and after restarting Eclipse it still happened a short time later and I wrote the bug.I don't know the internal details e.g. if I needed to do something to rebuild the index from one version to the other.I think it mostly occurred after fetching a patch from gerrit.This is a problem with the legacy index. Disabling the new index is unlikely to have any effect on this problem.(In reply to Stefan Xenos from)Just to be clear, when the new index is enabled, could this problem still occur? Are both old and new index being used simultaneously?Yes. Most of JDT hasn't been migrated to the new index yet and the new index can't (yet) index source files, so both indexes are used when the new one is enabled.	9.0
id=509039	REOPENED	JDT	Core	4.6	PC Windows 7	P3 enhancement	JDT-Core-Inbox	2016-12-11 11:46 EST by	Frank Benoit	2016-12-16 14:37 EST (	2 users	This code:public class FinalNull { @Nullable private final Object value; public FinalNull( @Nullable Object value ){ this.value = value; } void action(){ if( value != null ){ value.toString(); // Here for 'value' } }}Error:Potential null pointer access: this expression has a '@Nullable' typeThis should not give the warning, as the field is checked for non-null and it is final, hence cannot be null in that line.	Thanks for the report, but this is working exactly as designed.The general strategy for @Nullable fields is discussed in "The case of fields" in the help [1]. There's more on this in the wiki [2] in particular under "Risks of flow analysis for fields".Some time ago we had a discussion to apply special analysis just for final fields. Marking as duplicate of that (unresolved) RFE.[1][2]*** This bug has been marked as a duplicate of***I was a bit quick closing as duplicate, since the other bug is closed wontfix, but that applies for the more general case.Re-opening to have a place to discuss just admitting flow analysis for final fields (as opposed to analysing nullness from field initialization).***has been marked as a duplicate of this bug. ***Note for a future investigator: technically, any flow analysis for fields needs infrastructure as we had developed for, which was later withdrawn as of. I should add that this work (see commit d6c2a90130be430285c5f6a000090d250c310afd) had quite some complexity. The main issue was: extending bit vectors to include fields and tweaking computation of IDs so that all variables in scope (incl. inherited and from outer instances) would be linearized nicely.	4.0
id=195757	REOPENED	JDT	Core	3.3	Macintosh Mac OS X - Carbon (unsup.)	P3 normal	JDT Core Triaged	2007-07-08 07:20 EDT by	NoName	2010-09-14 08:45 EDT (	3 users	Build ID: I20070625-1500Steps To Reproduce:If you type in a java file:public class X { boolean test() { return true; } int foo() { if ((test() ? null : null) == null) return 1; return 0; } // more complex int bar() { String s = null; if ((test() ? s : null) == null) return 1; return 0; }}In both case, a "redundant null check" should be reported.More information:	While the test cases are different (and should be used for additional regression tests), the cure would be the same as for, namely compute and use the null status of the ternary operator in due time. Hence I will consider this bug as a duplicate (and we'll leverage the test cases as needed if/when we go after).*** This bug has been marked as a duplicate of***Changing OS from Mac OS to Mac OS X as perThe test case given here is not fixed by. Hence reopening this.(In reply to)While part ofhas moved to, which is still open,the test cases from this bug are different as analysis of the condition is not required here.To start narrow down the issue, consider the following variant, wherethe ternaries have been extracted into local variables:public class Bug_195757 { boolean test() { return true; } int foo() { Object ternary1 = test() ? null : null; if (ternary1 == null) return 1; return 0; } // more complex int bar() { String s = null; String ternary2 = test() ? s : null; if (ternary2 == null) return 1; return 0; }}Already in 3.6.0 this produces the expected warnings:Description Resource Path Location TypeDead code Bug_195757.java /Bug/src line 11 Java ProblemDead code Bug_195757.java /Bug/src line 21 Java ProblemRedundant null check: The variable ternary1 can only be null at this location Bug_195757.java /Bug/src line 9 Java ProblemRedundant null check: The variable ternary2 can only be null at this location Bug_195757.java /Bug/src line 19 Java ProblemThis seems to support Maxime's analysis that this is a matter of when therequired information is available.	4.0
id=261409	REOPENED	JDT	Core	3.4.1	PC Windows XP	P3 minor	JDT Core Triaged	2009-01-17 02:55 EST by	kiril mitov	2011-01-12 09:42 EST (	2 users	Eclipse 3.4.1M20080911-1700Go To Window->Preference->Java-Editor-Content Assits->Advanced and select only Other Java Proposals and Type Proposals.Go an configure proxy setting in Windows->Preference. This problem happens only if proxy is configured.Create a new ejb project and a bean. Go to the class of the bean, type @Re and Ctrl+Space. The following error occurs.Java Model Exception: Java Model Status [Cannot retrieve the attached javadoc for ]at org.eclipse.jdt.internal.core.JavaElement.getLibraryJavadocLocation(JavaElement.java:704)at org.eclipse.jdt.internal.core.JavaElement.getJavadocBaseLocation(JavaElement.java:661)at org.eclipse.jdt.internal.core.BinaryType.getJavadocContents(BinaryType.java:1030)at org.eclipse.jdt.internal.core.BinaryType.getAttachedJavadoc(BinaryType.java:971)at org.eclipse.jdt.internal.ui.text.javadoc.JavadocContentAccess2.getHTMLContent(JavadocContentAccess2.java:98)at org.eclipse.jdt.internal.ui.text.java.ProposalInfo.extractJavadoc(ProposalInfo.java:96)at org.eclipse.jdt.internal.ui.text.java.ProposalInfo.computeInfo(ProposalInfo.java:76)at org.eclipse.jdt.internal.ui.text.java.ProposalInfo.getInfo(ProposalInfo.java:59)at org.eclipse.jdt.internal.ui.text.java.AbstractJavaCompletionProposal.getAdditionalProposalInfo(AbstractJavaCompletionProposal.java:510)at org.eclipse.jface.text.contentassist.AdditionalInfoController$3.run(AdditionalInfoController.java:105)at org.eclipse.core.internal.jobs.Worker.run(Worker.java:55)This error happens in an internal product. The class path of the project contains our adopter jars. I suppose one of the jars (the one containing @Remote annotation) is corrupt or something. It would be great if this information is given in the JavaModelStatus. Which is the jar in problem.	If the problem only occurs with proxies, then it has nothing to do with the jars. The problem must come from the connection to the javadoc location itself. There are known issues with proxies.(In reply to)Yes, I was able to reproduce this problem only with proxy configured.Then closing as a dup of.I had no time to assess the proxy support from the platform.*** This bug has been marked as a duplicate of***(In reply to)I dont think this is really a duplicate. What the user is really asking here is that we should be able to explicitly report which jar's javadoc URL is corrupt. On the other handdeals with a hang due to delay in fetching javadoc, even though the path may be correct.	4.0
id=368106	REOPENED	JDT	Core	3.7.1	PC All	P3 enhancement	JDT Core Triaged	2012-01-08 10:54 EST by	Sven Köhler	2015-07-02 02:08 EDT (	2 users	Build Identifier: I validated the javadoc HTML files generated for a large project I joined (right click on folder in eclipse -> validate, it's a feature of WTP I think). It turned out, that beside some errors caused by the javadoc itself (invalid meta tags), badly written HTML is simply copied from the javadoc comments into the HTML files generated by javadoc.Here's a list of bad HTML which I encountered so far in javadoc comments:@param abc The parameter <code>abc<code> must be larger than zero=> error because <code> is improperly closed@param angle Angle to rotate, is allowed to be >360 degrees=> error because of unescaped > character (>360 should be &gt;360)<pre>int x = y << 7;</pre>=> error because of unescaped < character (<< should be &lt;&lt;)I guess more bad things are possible (improperly escaping the & character for example).Currently, Eclipse does not seem to validate HTML used in javadoc comments.It would be a great enhancement, if Eclipse could check for obviously broken HTML code. Especially since the javadoc tool doesn't do any checking/conversion of broken HTML into proper HTML, the status quo seems to be that the programmer himself has to make sure his HTML-code is correct. Eclipse could be of great help here.Reproducible: Always	Checking for HTML syntax is out of scope for the java compiler. This should be done by another plugin which can validate the HTML code, and not JDT. JDT already offers validation for javadoc through Preferences>Compiler>Javadoc, but for HTML you can use plugins such as EclipseTidy -I'm reopening, because I'm not sure whether your response is appropriate. Maybe you just have to rephrase your answer or maybe reassign to a different team (WTP?).The problem I reported was about HTML _inside_ javadoc comments. Unfortunately, javadoc relies on HTML for certain tasks. That of course doesn't mean that JDT has to understand HTML.At first glance, I cannot tell whether eclipsetidy supports validation of the HTML inside javadoc comments. I will install it and check whether that is the case. However, if that is not the case, there is certainly an open problem here! Probabaly it is in deed not supposed to be solved by the JDT team.May I suggest a cooperation between WTP and JDT? Because HTML validation is already included in WTP, and actually extracting the javadoc comments from Java source files might actually rely on code from JDT. So in conclusion, the two can probably solve this by cooperation. Also, I'd like to see the HTML right in front of me, while I'm editing the Java source file.Also consider, that this problem might be inbetween the scope of WTP and JDT:- WTP focuses on HTML/PHP (no Java)- JDT focuses on Java (no HTML)So I'm not sure who this should be assigned too.I meant you can use the EclipseTidy plugin to validate the generated HTML. If you want to do it in the java editor, the best bet is another plugin which can use extensions of both WTP and JDT plugins to parse and validate HTML inside javadocs. The fact that this problem cannot be solved by either plugin independently itself makes a case for a new plugin.That will introduce dependencies between the two plugins, which is a no go.I intend to close as WONTFIX again, not because this problem cannot be fixed, but because neither WTP or JDT can fix it independently.(In reply to)I use WTP to validate the generated HTML, and it's awful pain searching the Java source/method which results in the error in the HTML file.I agree.I see.Is there no way keeping this open? I understand, that this cannot survive as a request for enhancement of JDT/WTP. So is there no way of keeping this as an RFE asking for a new plugin?The Eclipse bugzilla is only for bugs/RFEs for projects in the Eclipse ecosystem. Work on a plugin project can be done separately and the plugin can be pushed onto the Eclipse Marketplace. You can canvass support for such a plugin on social forums online, or blogposts. There's no point letting it linger on bugzilla because its currently not a bug/REF against an Eclipse project. Thanks!On second thoughts, keeping this open in case someone decides/wants to contribute such a functionality to JDT. PS: WTP should not be used.	6.0
id=30151	REOPENED	JDT	Debug	2.1	PC Windows XP	P3 enhancement	JDT-Debug-Inbox	2003-01-24 05:29 EST by	Simon Tardell	2014-07-03 09:37 EDT (	5 users	If there is an uncaught exception thrown, or if there is a compile error when evaluating the scrapbook, the error message gets inserted into the scrapbook. It felt a bit bizarre already in VAJ, and it feels even more bizarre that it has crept along into Eclipse. It is also quite annoying. Alerts/modal dialogs are also annoying but much less so. Build: 2.1-M4	Nothing planned for 2.1As of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.This bug is still valid in Eclipse Helios (3.6):- open a scrapbook page- add code: int a = 0;int b = 2/a;- select and execute the code- "An exception occurred during evaluation: java.lang.ArithmeticException" is appended next to the last line.I think this bug's status should be CONFIRMED because it is still a problem IMO. If it there is a reason why this will not be fixed, please provided.I think the scrapbook should be split into two panes with all results including exceptions on the bottom pane.(In reply to Marius Kruger from)Reopening.Would you be willing to work on such a feature? Currently there is just not enough committer resources to work on this.	5.0
id=383050	REOPENED	JDT	Core	3.8	PC Windows 7	P3 enhancement	JDT Core Triaged	2012-06-20 02:08 EDT by	Eike Stepper	2012-06-20 03:46 EDT (	2 users	CreatedScreenshotFor example for List<BugFix> the name "bugFixs" is proposed, see attached screenshot.Maybe articles likecan help to further improve name proposals.	(In reply to)No plans to implement this. Please reopen if you want to contribute a patch.No thanks.I'd like to see improvements in this field, too.Is there a better starting point than org.eclipse.jdt.core.NamingConventions and org.eclipse.jdt.internal.core.InternalNamingConventions respectively. Where can I find the tests for that feature?(In reply to)org.eclipse.jdt.internal.core.InternalNamingConventions.suggestVariableNames(..) is your friend here. Tests are in org.eclipse.jdt.core.tests.model.CompletionTests and CompletionTests2	4.0
id=38427	REOPENED	JDT	Debug	2.1	All All	P3 enhancement	JDT-Debug-Inbox	2003-06-04 15:01 EDT by	Uli Bubenheimer	2015-10-07 03:48 EDT (	7 users	Sometimes, when I debug, I want to stop execution as soon as it reaches a certain class context to execute certain methods on the class manually. This is useful, for example, when doing GUI development; after I make certain changes to my GUI components I redisplay them by calling an initialization method on the class.Right now, what I have to do is to set a breakpoint on a particular method of the class, and then somehow make my application call that method, which leads to the breakpoint being hit and me being able to manually call my initialization method. Instead of setting a breakpoint on a particular method, I want the breakpoint to be hit on any class method, since that gives me the class context I need to call my initialization method. I don't want to be required to set a breakpoint on a specific method, when all I need is the class context.JBuilder has this feature from what I've seen.	I'm not clear on the request:* Do you want a class load breakpoint (i.e. suspend when the VM loads the class)?* Or, do you want a "stop in any method on this class" breakpoint?A "stop in any method on this class" breakpoint.This can be done, but the implementation may have performance problems. This is implemented with "method entry requests" into a specific class. If the target VM implements this inefficiently, then the target program may run/debug slowly.Breakpoints that stopped in any method of a class should perform better than our existing method breakpoints.Not true - a method entry breakpoint is currently implemented with a line breakpoint on the method (which is faster than a method entry breakpoint request). Using a method entry request for a type (usually) turns on method tracing in the target VM, which (usually) slows down the target program.DeferredClosing, not planning to implement.As of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.This is a useful feature.. I don't think the sited performance concerns are reason to drop it. If a user were to manually troll thru a class and set a breakpoint at the start of each method, the feature would be, in effect, implemented. You cannot prevent a user from doing that and so the performance issue already exists and has not been reported as an issue (i hope :>). I've done it and hated it with up to 32 methods. Works fine. (matters-not why I can't figure out the entry point by other means). There may be valid performance issue with the manner you envisioned to implement about which I cannot say... but at least look at it from the above perspective. Make it a UI trick, if you must, but please reopen.Re-opening as per request. Currently no plans to implement.You can already do that by selecting the methods in the Outline view and then using Toggle Method Breakpoint (from the context menu or the Run menu).(In reply to)If the selection contains an abstract method the context menu does not have the 'Toggle Method Breakpoint' option :) , the Run menu has the option though which just skips the abstract method.But the original bug is about *any method* in a class, including inherited methods.	12.0
id=66207	REOPENED	JDT	Debug	3.0	All All	P3 enhancement	JDT-Debug-Inbox	2004-06-08 15:07 EDT by	quartz quartz	2009-06-08 12:31 EDT (	3 users	in the variable view, when you need the type displayed, it is difficult to find the variable nameafter the classname.Display the var name first with classname in parenthesis orprint the var name in bold or colored (blue, green, whatever that will highlight)or dim the color of the classname (grey)	Deferred***has been marked as a duplicate of this bug. ***columns make this uneccessary.Marking as won't fixI don't agree. I work without columns, because- the simple labels contain enough information for me, and- the columns mode would just be a waste of screen space (especially, since the width of the first column is just never right, because its optimal width depends on the expansion depth of the tree)Colored labels would be the perfect solution to reduce my seeking while at the same time keeping the variables view small.That's actually the same as in the Java Outline view: I wouldn't want columns there, but I immediately lose valuable visual structure when I turn off colored labels.I'd propose these colors:- Type: StyledString.QUALIFIER_STYLER- Variable name: default (black)- '= <value>': StyledString.DECORATIONS_STYLER- '(id=<123>)': StyledString.COUNTER_STYLERRe-opening.	6.0
id=52131	REOPENED	JDT	Debug	3.0	All All	P3 enhancement	JDT-Debug-Inbox	2004-02-16 04:57 EST by	Felix Pahl	2010-07-19 04:28 EDT (	2 users	The documentation should compare and contrastWatch, Inspect and Display. It took me a while tofigure out that Inspect inspects certain objects,whereas Watch watches certain variables. (If I'mwrong about that, it just underscores the need foran explanation :-) The difference isn't obvioussince it only becomes relevant once you leave thestack frame from which you performed Inspect orWatch, and it isn't indicated in the view. (I'llsubmit the latter as a separate feature request.)The difference between these two and Display isa little more obvious but should also be explainedin the documentation. The explanation of Display (at least the one youfind if you enter "Display" in the help search field)is minimalistic and reminiscent of MS help files:"You can type an expression in the Display view andthen use the Display command to display its value."It should mention how expression values are convertedto strings (toString()? detail formatters? special casesfor arrays?)I couldn't find anything about Watch expect brief entriesin "New features" sections.	Sorry, I take that back -- of course Watch and Inspect havedifferent icons in the Expressions view -- but my suggestionthat the difference be explained in the documentation stands.As of 3.6 RC4 the doc looks good to me. Please reopen if you still miss something.The doc has certainly made great strides since I opened this bug, but most of the problems I was reporting persist.After spending several minutes searching the help in various ways, I haven't found anything that clearly explains the difference between Watch and Inspect. If I search for "watch" and "inspect", I only find brief pages (entitled "Add Watch Expression" and "Inspect Selected Variable", respectively) that explain that I can "create a new watch expression and add it to the Expressions View" and "create an inspect expression associated with the selected variable and add it to the Expressions View", respectively.They both link to a page entitled "Expressions View", which offers a bit more information but likewise uses the terms "watch expression" and "inspect expression" as if they had already been defined, but I couldn't find them defined or explained anywhere. These terms should link to pages called "Inspect expression" and "Watch expression" that define these terms (and link to each other under "Related concepts"). However, the term "inspect expression" is actually a bit misleading. You can inspect an expression, but the result isn't really an "inspect expression", it's a *value* that is then displayed -- though the display may change if the value is an object reference, there is no longer an expression involved at this stage.Also, I still couldn't find anything about how expression values are converted to strings for "Display" (toString()? detail formatters? special cases for arrays?).P.S.: After searching some more I found a page called "Expressions" that contains the sentence "A watch expression is an expression that is repeatedly evaluated as the program executes." This has the form of a definition of a watch expression, but a) it's in the Programmer's Guide, not the user guide, and talks about IExpression etc., and b) it doesn't really clarify the difference between a "watch expression" and an "inspect expression". What's slightly confusing about this difference is that both show changing things in the expressions view, but what the "watch expression" shows changes because the expression gets reevaluated, whereas what the "inspect expression" shows changes only if the result of the expression was an object reference and the object changes. This is straightforward once you figure it out, but it's not trivial to figure out without an explanation.Two related things I noticed while writing this that may or may not warrant opening a separate bug:-- There are help pages called "Inspect Selected Variable" and "Inspect Selected Statement". These both appear to be misnomers, since it's not statements but expressions that are inspected, and a variable is just a special case of an expression, so it seems there should be only one of these pages and it should be called "Inspect Selected Expression".-- The page "Display View" appears to be out of date; e.g. there's an entry "Inspect Result", but in my menu the entry is called just "Inspect".Sorry, I forgot to compare versions -- I'm using Version: 3.4.1, Build id: M20080911-1700 -- I'll look at 3.6 RC4 as soon as I get a chance.I've now downloaded Eclipse 3.6.0, Build id: I20100608-0911, and found that what I wrote inapplies to this version as well.OK, thanks for checking. Moving to Debug to improve the doc.	6.0
id=77793	REOPENED	JDT	Debug	3.1	PC Windows XP	P3 normal	JDT-Debug-Inbox	2004-11-03 20:12 EST by	Darin Swanson	2012-01-11 11:07 EST (	3 users	Keyboard navigation from the stack trace console does not currently seem possible. Map to F3?	It turns out that the FollowHyperlinkAction is busted as well. It attempts to retrieve the latest hyperlink from the console. However, when the menu is realized, the current hyperlink is cleared as the menu appearance causes a "mouseExit" event to occurr.Investigate post M4, as we consider the use of the text framework's hyperlink support.***has been marked as a duplicate of this bug. ***Deferred. Problem with context menu interaction.DeferredF3 would be nice to open links.As of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.Yep, it is still valid.Eclipse SDK 3.8.0.I20111209-1447.I don't have permissions to reopen this bug.Reopening...	9.0
id=89670	REOPENED	JDT	Debug	3.1	PC Windows XP	P3 enhancement	JDT-Debug-Inbox	2005-03-30 15:03 EST by	Stefan Xenos	2011-05-13 23:53 EDT (	1 user	I use Eclipse with OptimizeIt for profiling. I am continually creating launchconfigurations to pass the right command-line arguments, environment variables,etc. to optimize it.ENHANCEMENT 1: Allow launch configurations to be exported.- Provide some way to export a launch configuration in a form which could beimported into another workspace.- Make the export format easy to create, such that 3rd-party vendors (such asOptimizeIt) could ship their product with an importable launch configurationthat picks up all the right libraries, and all I need to do is select the nameof my app and its arguments.ENHANCEMENT 2: Rather than including all options in the launch config, separatethe concerns.Right now, each launch configuration directly contains all options I need tolaunch my app, but I may want to reuse different subsets of options. Forexample, whenever I launch an SWT app I need to provide a certain DLL, wheneverI launch with OptimizeIt I need to include certain VM arguments and additionalenvironment variables, etc... and whenever I'm launching a certain app, I needto include certain dependencies on the classpath.It would be nice if these different concerns could be configured independently.This is, if there was a way for me to describe the following rules (in a formwhich could be reused and exported):- SWT apps are a type of java application. Here's how to launch an SWT app on alocal VM.- java apps can be launched with OptimizeIt. Here's a template that describeshow to launch a java app on a local VM.- Program A is an SWT application with the following dependencies.Configuring these things independently could greatly simplify the launchconfiguration dialog. A launch configuration for a Java Application would onlyneed to contain 1 page with 4 fields:- Which application to execute- What program arguments to pass in- What working directory to use- Which "device" to run on (I'm using the term "device" to indicate where theprogram will be launched. A particular VM running on the local machine might be one kind of device thatcan run Java Applications and Eclipse Applications from the local machine, butit should also be possible for 3rd party plugins to supply devices that runmidlets on a cellphone or emulator, java applications on a remote machine, etc.)The remaining launch configuration options (classpath, VM args, sourcedirectory, JRE, plugins, etc.) would be a function of which application I'mlaunching and what device I'm launching it on.For example, I could supply my OptimizeIt options by declaring OptimizeIt as adevice that passes additional arguments to a local VM. I could then useOptimizeIt to launch any Java Application or Eclipse Application by telling itto run on the OptimizeIt device.If I'm launching an SWT app, I would simply declare that my application requiresSWT and allow the device to resolve the dependency. I (the user) would haveconfigured the local VM to resolve the SWT dependency by adding a particular DLLto the command-line. A remote device (cellphone, etc.) would either take theappropriate steps to resolve the requirement for SWT or report back that it isincapable of launching SWT apps. Similarly, downstream products that supportalternative JCLs could declare the JCL as a type of dependency.Including this device abstraction would simplify the launching UI in Eclipse (Inmost cases, the user would never need to see the classpath, environment, or JREtabs), and would greatly simply the UI for downstream products (like WSDD) thatsupport embedded development. I guess this is just a rambling wishlist for new launching features. Hopefullysomeone finds some part of this inspiring. :-)	Deferred. Thanks for the input. Part of this is similar to the request to allow for launching templates (see).We will consider launching improvements in later releases.marking as dup.import/export =templates =*** This bug has been marked as a duplicate of***doesn't really cover what I'm looking for. Even with templates, managing a M programs that launch in E environments and typically take I different inputs would either require M*E*I different launch configurations or would require constantly changing the configuration.The point of this bug is to let me select the three dimensions of a launch independently.	4.0
id=114097	REOPENED	JDT	Debug	3.2	PC Windows XP	P3 enhancement	JDT-Debug-Inbox	2005-10-28 09:41 EDT by	Darin Wright	2011-05-20 10:19 EDT (	5 users	Currently, when a breakpoint refactoring is undone, the breakpoint is simply deleted. Not ideal, but due to the following limitation reported in.The problem is an assumption in the perform method of the change objects of thedebug rename participants: An IResource for the new element is retrieved andused to create a new breakpoint, but in case of an undo the resource does not(yet) exist.This is not a problem during normal execution: There, the participant changesget executed AFTER the refactoring changes, thus the new renamed element exists,and so does its resource.However, when performing the undo change, the order is reversed: The participantchanges get executed BEFORE the refactoring changes, thus the new renamedelement does not exist, and the resource does not exist either.The undo change should probably be changed back to a NullChange for M3. A realsolution would either require code without assumptions about element existenceor reversing the execution order (for example, on participant request).	Deferredreopening***has been marked as a duplicate of this bug. ***	3.0
id=118946	REOPENED	JDT	Debug	3.1.1	All All	P3 enhancement	JDT-Debug-Inbox	2005-12-01 18:24 EST by	Tim Eck	2009-09-01 12:29 EDT (	6 users	It would be incredibly helpful for our development is we could use string substitution in the "default vm arguments" settings attached to installed JRE profiles. For instance, to run any piece of code I work on, I need specify the full path to a jar in -Xbootclasspath. That path depends on the value of ${workspace_loc} however, thus the desire for string substiution.Thanks for the consideration!	I don't think it makes much of a difference in the description of this RFE, but I meant to say I want to subst ${project_loc} in my default VM args (as opposed to ${workspace_loc})Deferred. Unfortunately this would break the existing API contract of IVMInstall.getVMArguments():"Returns VM arguments to be used with this vm install whenever this VM is launched as they should be passed to the command line, or <code>null</code> if none."Existing clients that use the API would not be expecting variables, and would be broken when attempting to launch.CC'ing Jim for comment/suggestions.***has been marked as a duplicate of this bug. ***As of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.This still makes sense as an enhancement for me.Use Case: grabbing an Environment Variable to use as part of a path. Each build I download is installed into a folder based on build number and date, which I then need to pass as a parameter. While this does work by setting it on each individual launch config, there is a vast number that end up getting created; it makes more sense to define it in one location.I'll re-open it to keep the request alive. Currnetly, we don't have resources to work on this.Thanks, I haven't done much with the eclipse bugzilla so I wasn't sure if simply replying would reopen or if it was a permission only available to the originator.Is the eclipse project still doing Bug Days? The wiki hadn't been updated with a date in a while and I don't see a separate flag on the defect page, but I would be willing to work on this during a Bug Day if it's a candidate.(In reply to)Yes Bug Day is still active. We don't typically update the wiki, but we mark appropriate bugs with the 'bugday' key word. Before you look into fixing this, consider.	8.0
id=119048	REOPENED	JDT	Debug	3.1.1	PC Windows XP	P3 enhancement	JDT-Debug-Inbox	2005-12-02 11:33 EST by	Ralf Hauser	2010-12-30 12:53 EST (	0 users	I updated itext.jar and now I am consistently getting the error message attached next.The option to "no longer tell me" is good, to be able to remove the breakpoint altoghether with a second button would be even better.	CreatedremoveBreakPoints.pngthe pop-up I mean just for referenceCreatedAllows removing of uninstallable breakpointsThis patch modifies the previously shown dialog to include the option of removing uninstallable breakpoints, which acts in unison with "Don't tell me again" option.Assigning to Darin for review.Deferred for post 3.2Closing, do not intend to add option. Auto (silently) deleting breakpoints feels like it could cause unwanted confusion.As of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.I don't want the breakpoints to disappear silently, but to have an additional button in the panel attachment (id=31036) that allows to remove it immediately. So it is a one-time willful action be the operator	7.0
id=170394	REOPENED	JDT	Debug	3.2.1	PC All	P3 enhancement	JDT-Debug-Inbox	2007-01-13 20:34 EST by	David Carver	2010-05-20 15:21 EDT (	0 users	The launch configuration should be refactored so that it isn't a requirement that the JDT be installed. By moving it to the platform level, it would allow for easier development of other programming plugins without the requirement that the JDT be available to allow extensions of the launch configurtion. This allows for standalone IDE's based on eclipse like a PHP, C, XML, etc specific ide.	Launch configurations do not dependon JDT. Only JDT specific configurations depend on JDT. Marking as invalid without further input/description.@see ILaunchConfiguration, ILaunchConfigurationType, etc. They all exist in the debug platform that are not JDT specific.Is the debug platform distributed by default with the platform-api, or does it only come distributed with the jdt and jdt-debug apis? The ideal thing, would be a complete seperation and included with the base platform. If this is already, being done, then I just need to look further. Also having it be based on the debug platform may not necessarily be the best thing. At times, there is a need to have a launch configuration, not like we have for Ant builds or External configurations, that aren't necessarily debugging. Examples would include unit acceptance testing. These aren't necessarily debug configurations, but just ways to launch a particular testing framework for integrated reporting. Currently this is all handled with the launch configuration.Yes, org.eclipse.debug.core and ui are distributed with the platform download, not just JDT. We don't have plans to seperate launch support for the debug plug-ins currently.I'm re-opening this with a different title, and a more accurate title. The eclipse JDT Debug UI depends on JDT UI, which brings in the full editor. XSL tools jaxp launching/debugging support depends on JDT Debug UI for some functionality, but unfortunately this also brings in the full JDT which some users do not want.Seefor additional information.Ideally we would just want to bring in the necessary pieces for launching/debugging jvm related components and runtimes including classpath settings, vm settings, etc without getting the editor as well.We could possibly help refactor out the editor into it's own set of plugins but not sure how complicated that would be considering the number of cycle dependencies that seem to occur in jdt's plugins.	4.0
id=123116	REOPENED	JDT	Debug	3.1.1	PC Windows XP	P3 enhancement	JDT-Debug-Inbox	2006-01-09 11:19 EST by	Marcel Petavy	2009-08-20 10:58 EDT (	1 user	Hi.Would be cool to have "Go To Next Previous" buttons to "walk" through a stacktrace, like i the Synchronize View.Cheers - Marcel.	***has been marked as a duplicate of this bug. ***Not planned for 3.2I don't really need buttons, but binding the Navigate > Next/Previous actions (Ctrl+./,) would be nice.	3.0
id=247425	REOPENED	JDT	Debug	3.5	All All	P3 enhancement	JDT-Debug-Inbox	2008-09-16 06:42 EDT by	Tomasz Bartczak	2009-05-05 11:07 EDT (	4 users	This would be a great feature if there would be a way to export the tree of debug variables down to some specified level - either to system clipboard or to a text file - doesn't matter.I find that useful for text-comparing of two debug sessions that gives a different result, but have quite complex variable state.	Copy (Ctrl-C) copies the text of expanded variables rooted at the current selection. Propose to close as WORKS FOR ME.Closing.Yes but there is not an easy way to automatically expand the object structure (preferably down to some X level given). So if I want the whole structure, that mean clicking and navigating this stuff many many times. Too many for me.Doesn't work for me :)There is already a bug open for auto expanding,. It is very difficult to have an auto expand for a virtual view where variables may be nested. Our first attempt at an implementation had too many problems. Please consider marking this bug as a duplicate or returning it to WORKSFORME.Well - this is very similiar and if that worked - my need probably would be satisfied also. However if this is a problem with UI - You may think about adding a non-ui 'copy variable state tree into clipboard' action which will just simulate expanding all the 'expandable' nodes down to some level and copying data as it is with selecting and ctrl+C.For me it is still a feature missing - but You do what You want. If You want to concentrate on the other bug ok - it will fullfil some requirements :)Changing Version tag to something more believable. Note that this is not a statement about when the enhancement request will be addressed (the Target Milestone field is used for that); the Version tag should be set to the version of Eclipse you were using when you saw the need for the enhancement.	6.0
id=211658	REOPENED	JDT	Debug	3.3.1	All All	P3 normal	JDT-Debug-Inbox	2007-11-30 17:44 EST by	Adam Holley	2013-11-22 11:14 EST (	4 users	Build ID: M20070921-1145Steps To Reproduce:1. Create a program that contains a String variable with >1024 chars2. Debug the program with a breakpoint so you can view the variable.3. Hover over the variable in the code to see the value.More information:The gui eventually responds, however as the strings get larger, the gui is slower even though it doesn't display the entire string until you press F2 to get the focus.	I don't think there's much we can do about this. For me it's not really slugish until I get to about 1,000,000 chars (which seems reasonable).seems this bug wasn't fixed.I see it as critical issue. eclipse hangs, UI freezes for around 2-3 minutes for a string variable with around 5k chars value. I have logged another bug for same issue :.Thanks, Jaireopening, perhaps we could do a better job handling the string during the evaluation to show it.***has been marked as a duplicate of this bug. ***	4.0
id=195875	REOPENED	JDT	Debug	3.3	PC Windows Vista	P3 normal	JDT-Debug-Inbox	2007-07-09 14:47 EDT by	Brad Cupit	2009-07-02 13:54 EDT (	2 users	Build ID: I20070621-1340Steps To Reproduce:1. Under Preferences -> Java -> 'Installed JREs' make sure that a 1.6 JRE is selected (not a 1.6 JDK)2. Under Preferences -> Java -> Compiler make sure compiler compliance level is set to 6.0 (or 5.0)3. Setup a logical structure for the java.lang.String class (any logical structure will do)4. Turn on Logical Structures in the Variables view5. Debug a project and bring up a String variable in the Variables view6. Expand the variable and see the following error: Evalutations must contain either an expression or a block of well-formed statements7. Under Preferences -> Java -> Installer JREs switch to a JDK and see that Logical Structures work normallyMore information:I tried several different class types for logical structures (java.lang.String, java.util.Calendar, the built-in Logical Structures, and java.math.BigDecimal). The BigDecimal type and the built-in Logical Structures consistently worked, regardless of the JRE/JDK setting. String and Calendar consistently failed in a 1.6 JRE being compiled as 1.6 code.Logical Structures did not work under a 1.6 JRE When code was compiled as 1.5 or 1.6Logical Structures always worked under a 1.6 JDKLogical Structures always worked when code was compiled as 1.4 (regardless of the default Installed JRE)Since the default JRE listed under 'Installed JREs' when Eclipse is first installed is always a JRE (and not a JDK) this bug is somewhat visible.Reproduced in Eclipse 3.3 RC4 and 3.3 final.OS: Windows Vista Enterprise EditionVMs: Sun JDK 1.6.0_02, and 1.6.0_01, and 1.6.0, and Sun Java SDK 1.4.2_15	CreatedUser Defined Logical Structure to reproduce the bugThis attachment can be imported (File -> Import -> General -> Preferences -> Next) to add a logical structure for the java.lang.String class that will reproduce the bug. This attachment is only for convenience when reproducing the bug, as it seems to occur on the String class regardless of how the Logical Structure is defined.(In reply to)Quick clarification, this means "types like String and Calendar do not work under a 1.6 JRE" (other types, like BigDecimal, for some reason always work, even in a 1.6 JRE)I am not able to reproduce on XP. The imported the structure, compiled a project using 1.5, and debugged on 1.6.(In reply to)Hrmm...I was able to reproduce it on XP. Are you sure that a JRE (and not a JDK) was checked under Preferences -> Java -> Installed JREs?Oh one other thing, I'm using a Sun JRE/JDKCannot reproduce on 3.5Rc3. Closing as works for me.(In reply to)The bug still happens with Eclipse 3.5 final (not, I didn't try with 3.5 RC3)Just to recap, write the following code:public class Main { public static void main(String[] args) { String x = "123"; System.out.println(x); }}1. setup the Sun JRE (not the JDK) as the default2. ensure the JRE is checked under Execution Environments3. import the attached StringLogicalStructures.epf4. set a breakpoint on the System.out.println line5. press the "Show Logical Structure" button in Variables view6. click the '+' next to the x variable7. see the bug (attached screenshot)this was done on a brand new, empty workspace.Sun JRE 1.6.0_10Under Execution Environments, when I check the JRE, most logical structures don't work, but when I check the JDK, logical structures do work.I can upload a screencast if that would be helpful.Createdscreenshot of bugCreatedshot of Execution Environment settings to reproduce the bug	9.0
id=250639	REOPENED	JDT	Debug	3.4.1	PC All	P3 major	JDT-Debug-Inbox	2008-10-13 08:32 EDT by	kurt	2008-10-31 10:53 EDT (	2 users	Build ID: M20080911-1700Steps To Reproduce:running the following small program from a commandline (winXP) - it returns after 3 secondsthe same program started in eclipse blocks on System.in.close()public class HangOnClose implements Runnable { public HangOnClose() { super(); } public void run() { System.out .print("waiting in System.in.read() for System.in to be closed> "); System.out.flush(); try { System.out.println((char) System.in.read()); } catch (final IOException e) { e.printStackTrace(); } } public static void main(final String[] args) throws InterruptedException, IOException { new Thread(new HangOnClose()).start(); System.out.println("wait 3 seconds"); Thread.sleep(3000); System.out.println("closing input: System.in.close()"); System.in.close(); System.out.println("input closed"); }}More information:	Moving to JDT/DebugThe problem is that in Eclipse our proxy IOConsoleInputStream is waiting for input that it will never get. We should break out of waiting if the underlying input stream is closed before input is received.Once in the waiting state in the console if you press the enter key, you will get an IOException, because System.in has been closed but the IOConsoleInputStream does not think so.Partial dump showing IOConsoleInputStream waiting once System.in has been closed:"Worker-3" prio=6 tid=0x57344c00 nid=0x4c4 in Object.wait() [0x5850f000..0x5850fa14] java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x07a567a8> (a org.eclipse.core.internal.jobs.WorkerPool) at org.eclipse.core.internal.jobs.WorkerPool.sleep(WorkerPool.java:185) - locked <0x07a567a8> (a org.eclipse.core.internal.jobs.WorkerPool) at org.eclipse.core.internal.jobs.WorkerPool.startJob(WorkerPool.java:217) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:51)"Worker-2" prio=6 tid=0x57439400 nid=0xaa0 in Object.wait() [0x5840f000..0x5840fa94] java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x0a408068> (a org.eclipse.ui.console.IOConsoleInputStream) at java.lang.Object.wait(Object.java:485) at org.eclipse.ui.console.IOConsoleInputStream.waitForData(IOConsoleInputStream.java:147) at org.eclipse.ui.console.IOConsoleInputStream.read(IOConsoleInputStream.java:92) - locked <0x0a408068> (a org.eclipse.ui.console.IOConsoleInputStream) at org.eclipse.ui.console.IOConsoleInputStream.read(IOConsoleInputStream.java:117) at org.eclipse.debug.internal.ui.views.console.ProcessConsole$InputReadJob.run(ProcessConsole.java:679) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:55)"Worker-1" prio=6 tid=0x5737ec00 nid=0xa94 in Object.wait() [0x5830f000..0x5830fb14] java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x07a567a8> (a org.eclipse.core.internal.jobs.WorkerPool) at org.eclipse.core.internal.jobs.WorkerPool.sleep(WorkerPool.java:185) - locked <0x07a567a8> (a org.eclipse.core.internal.jobs.WorkerPool) at org.eclipse.core.internal.jobs.WorkerPool.startJob(WorkerPool.java:217) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:51)further inspection revealed this to be a dupe of, with a work-around provided in the sun bug report referenced in.*** This bug has been marked as a duplicate of***I don't think this problem is related to a native library -more that you have the same problem as Java's BufferedReader: close() is synchronized (in BufferedReader on the lock-Object, in eclipse IOConsoleInputStream the method itself.That means it is a synchronize-lock situation.	4.0
id=252074	REOPENED	JDT	Debug	3.4.1	PC Windows XP	P3 normal	JDT-Debug-Inbox	2008-10-24 17:41 EDT by	Alan Haggarty	2008-11-05 15:59 EST (	2 users	Build ID: M20080911-1700Steps To Reproduce:1. Create a java project test12. In test1 create a simple class with a main method3. Create a java project test24. In test2 Properties >> Java Build Path >> Libraries tab add test1 using "Add Class Folder"5. Try to run the class created in test1Result is an error "Selection does not contain a main type" for a class that executed correctly before test2 was created and configured.More information:	Moving to JDT/DebugWorks for me. I added the "test1/bin" folder as the class folder to "test2", expand the folder, select "class1.class", press "Run" and it works.Marking as works for me.Createdscreen shot of config for test2 classI also cannot reproduce if I add test1/bin, but if I add just the top level test1 it does. See the attached screenshot for build path config of test2.Is this valid. What is the output directory for project test1? (is it the root of the project?) When specifying a class folder you have to specify the root of the packages.I am not sure, I have been able to resolve dependencies in a second project this way if I try to instantiate class1 from test2/class2 for example, so it can find the classes. It just includes bin.test1.I looked back at the original test and in that case the projects do not have separate directories for class and src files (Uses "Use project folder as root for sources and class files") and in that case there is no option to add bin directly.Also in that case removing the directory from the library path of test2 doesn't fix the problem in test1. It seems to be permanently unrunnable.	7.0
id=289217	REOPENED	JDT	Debug	3.4.2	PC Windows Vista	P3 normal	JDT-Debug-Inbox	2009-09-11 10:22 EDT by	Ralf Hauser	2009-09-14 02:13 EDT (	1 user	User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.0; en-GB; rv:1.9.1.2) Gecko/20090729 Firefox/3.5.2 (.NET CLR 3.5.30729)Build Identifier: "source not found" - say where the jar sitsbut sometimes it is not an then, it is cumbersome to know why eclipse even attempts to find the sources for a particular jar.Reproducible: AlwaysSteps to Reproduce:1. use sysdeo tomcat plugin2. in source path, add a different projectso if a full file path is given, fine, but if it is in a third-party plugin or a war file, etc. say which plugin or which war file, etc. ...	CreatedonlyCommons-beauntils-1.7.0.jar.pngtried to reproduce what I sawPlease report this bug to Sysdeo.just relying on third-party products to report errors is "lame" and not fail-safe.I suggest that the eclipse main platform observes if the third party component provides any meaningful jar-origin info and otherwise at least lets the user know that it was the *specific* third party component, in our case sysdeo...	3.0
id=298099	REOPENED	JDT	Debug	3.6	PC Linux	P3 normal	JDT-Debug-Inbox	2009-12-17 12:12 EST by	Darin Wright	2017-02-09 05:00 EST (	2 users	This test has failed several times in the N-build.Thread should be suspended junit.framework.AssertionFailedError: Thread should be suspendedat org.eclipse.jdt.debug.tests.breakpoints.ConditionalBreakpointsTests.testSuspendLongRunningCondition(ConditionalBreakpointsTests.java:208)at org.eclipse.jdt.debug.tests.AbstractDebugTest.runBare(AbstractDebugTest.java:1763)at org.eclipse.jdt.debug.tests.DebugSuite$1.run(DebugSuite.java:54)at java.lang.Thread.run(Thread.java:619)	Also failed in N20100201-2000 (RHEL4, SUN 1.6.0)Removing milestone, has not failed for a while.failed again in I20100824-1210Thread should be suspendedjunit.framework.AssertionFailedError: Thread should be suspendedat org.eclipse.jdt.debug.tests.breakpoints.ConditionalBreakpointsTests.testSuspendLongRunningCondition(ConditionalBreakpointsTests.java:208)at org.eclipse.jdt.debug.tests.AbstractDebugTest.runBare(AbstractDebugTest.java:1763)at org.eclipse.jdt.debug.tests.DebugSuite$1.run(DebugSuite.java:54)at java.lang.Thread.run(Thread.java:619)Failed again in N20101129-2000have not seen this fail in a very long time.Marking worksforme.Failed on Windows.Failed on Windows again!!Frequent.	8.0
id=287795	REOPENED	JDT	Debug	3.5	PC Windows Vista	P3 enhancement	JDT-Debug-Inbox	2009-08-27 04:24 EDT by	Ravi	2011-05-09 15:33 EDT (	6 users	I've used Eclipse COM NEON, EUROPA, GANYMEDE & now am using GALILEO but during Debug, there's no option to 'set next statement’ as in VC++ where we can skip statements at debug time.Kindly request you to provide this feature ASAP as it's highly convenient for the developers.	It's not clear to me whether this is a Debug problem or a CDT problem so I'll let the Debug guys decide.Ravi, if you want to skip statements, I suggest you go to the next line you want to suspend at, and use Ctrl+R which will cause the debugger to run up to that line and then suspend. This should work in the Java debugging case anyway and I suspect CDT should support this.CDT/CDI debugger has a feature "Resume At Line" which allows users to resume the execution from the line selected in the editor. Is this what you are requesting?Thanks for the immediate response.I'm working in Android Platform using Eclipse Galileo.The 'set next statement' functionality in VC++ works as described below:void method(){if(false) //Line 1System.out.println("Just right click in debug mode & set next statement to this line 2 & this statement will be printed");}Description: As Line 1 would always be evaluated to false hence, line 2 should never execute normally but through 'Set Next Statement' feature, we can skip the execution of line 1 during debug mode & hence, execute Line 2 without checking Line 1.This 'Set Next Statement' can also be used to Jump to other methods in other classes as well.CTRL + R executes the statements & then, suspends which is similar to 'Run to Cursor' feature in VC++.As Android is based on Java, AFAIK CDT doesn't figure here.Thanks,Ravi.Reassigning to JDT Debug.Currently, this is not possible with the Java debugger as the native debug interface does not provide the ability to move/set the program counter arbitrarily.Yes, accepted that there is no provision to set the program counter but Set Next Statement is a very much valuable feature for debugging & is an essential feature, leading to preference for particular IDE's.Kindly requesting you to consider this as an enhancement & provide this feature in future versions of Eclipse.The java debugger cannot support this feature unless the underlying native debug interface supports it... JDI/JPDA does not support setting the next statement.For what it's worth, this could be done in CDT as GDB does support this. But that won't help with Android if I understand correctly.Yes, Please provide it in CDT. Meanwhile, I've requested Sun for the native interface to support changing the program counter.Not available in CDT till now.I've requested SUN(Oracle) to provide this useful feature but I've received no response so, not available in JDT also.Could you be of help to all the Java Developers?(In reply to)I'm not sure what you wish the Eclipse developers to do here. As Darin noted, the JPDA needs to spec this feature first. You need to engage and follow up with the Java community if you want this to happen.You may also wish to speak with the Android and Android tooling team. It may be possible for them to implement this feature on their side in the Dalvik VM.(In reply to)While not possible to set next statement anywhere, sometimes the most useful thingabout this feature is to skip execution of a single method call.Maybe I'm way off here, but in JVM 6 there is an option to "Force Early Return" from a method:So as a workaround, one could theoretically implement this with:* step into method* force early return immediatelyOptionally, you can do this several times to emulate "set next statment" as longas there is no "atomic" line of execution.Just an idea, not sure it would actually work.	12.0
id=285130	REOPENED	JDT	Debug	3.5	PC Windows Vista	P3 major	JDT-Debug-Inbox	2009-07-30 05:38 EDT by	Henrik Dohlmann	2014-06-12 20:38 EDT (	9 users	OS: Vista 64bit. JVM: 1.6.0u14 32bit.I try to debug an application with lots of recursion that pumps out alot of information to the console.Sometimes the console stops showing data, and Eclipse is sort of dead. Switching to the debug perspective shows an empty debug view. Switching to another perspective is possible, but some views are black (not repainted?). Starting debugger from the debug perspective somtimes freezes with alot of empty entries in the thread list.Somtimes I get a "Problem Occured" dialog with the text "'process model delta' has encountered a problem", "An internal error has occured". The detail view further contains "unable to create new native thread". Nothing is written to the ".log" file.Trying to shut down Eclipse stalls during "Saving workbench state". This is without any information in the ".log". When that happens I cannot connect with JConsole, but with SysInternal's Process Explorer I can see that the javaw.exe has an excessive amount of threads called "msvcr71.dll!_endthreadex+0x31".	Setting an early breakpoint in a loop and continuing each time it is hit, I got an Out Of Memory dialog. The corresponding log entry is:!SESSION 2009-07-30 11:51:41.155 -----------------------------------------------eclipse.buildId=I20090611-1540java.version=1.6.0_14java.vendor=Sun Microsystems Inc.BootLoader constants: OS=win32, ARCH=x86, WS=win32, NL=da_DKFramework arguments: -product org.eclipse.epp.package.jee.productCommand-line arguments: -os win32 -ws win32 -arch x86 -product org.eclipse.epp.package.jee.product -clean!ENTRY org.eclipse.core.jobs 4 2 2009-07-30 12:49:37.090!MESSAGE An internal error occurred during: "Label Job".!STACK 0java.lang.OutOfMemoryError: unable to create new native thread at java.lang.Thread.start0(Native Method) at java.lang.Thread.start(Thread.java:597) at org.eclipse.core.internal.jobs.WorkerPool.jobQueued(WorkerPool.java:145) at org.eclipse.core.internal.jobs.JobManager.schedule(JobManager.java:1001) at org.eclipse.core.internal.jobs.InternalJob.schedule(InternalJob.java:391) at org.eclipse.core.runtime.jobs.Job.schedule(Job.java:461) at org.eclipse.debug.internal.ui.viewers.model.TreeModelLabelProvider.complete(TreeModelLabelProvider.java:309) at org.eclipse.debug.internal.ui.viewers.model.LabelUpdate.done(LabelUpdate.java:146) at org.eclipse.debug.internal.ui.model.elements.ElementLabelProvider$LabelUpdater.run(ElementLabelProvider.java:166) at org.eclipse.debug.internal.ui.model.elements.ElementLabelProvider$LabelJob.run(ElementLabelProvider.java:71) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:55)The machine has 4G of mem.I am launching Eclipse with:C:\Tools\eclipse\eclipse.exe -vm "C:\Program Files (x86)\Java\jdk1.6.0_14\bin\javaw.exe" -clean -vmargs -Xmx1g -XX:MaxPermSize=512mQs:* How many threads does your application have? are they short lived, or do they persist for a while?* How much console output does you application have?* Does debugging your application work on Eclipse 3.4?CreatedFrozen Debug viewThe list of running threads is expanded alot, but no names show up and then it freezesThe app has a handful of long-lived threads and a couple of threadpools formany short-lived ones, like on/off the EDT, internal on/off core/gui-layer,firing messages, communicating with 3d renderer through jni (cortona usingjacozoom).Console output can go from absurd to totatlly crazy, but even reduced to itsminimum (6 lines of copyright stuff), the debugger still hangs.Debugging worked in 3.4, but I think it stopped working at one of the latestupdates (3.4.2, perhaps with some updated).CreatedFrozen Debug view with GC threadsToday I managed to get the Debug View to show all the threads instead of blank lines. The app under debug was still a little alive (?), and when i poked it, the Debug View suddenly managed to add names to all the blank entries.So, there are alot of entries with the name:* Thread [garbage collected] (Running).While the Debug View hanged, i tried to start a new instance. This resulted in the following in the log:java.lang.OutOfMemoryError: unable to create new native threadat java.lang.Thread.start0(Native Method)at java.lang.Thread.start(Thread.java:597)at org.eclipse.jdt.internal.debug.core.model.JDIThread.suspendUnderlyingThread(JDIThread.java:1598)at org.eclipse.jdt.internal.debug.core.model.JDIThread.suspend(JDIThread.java:1489)at org.eclipse.debug.internal.core.commands.SuspendCommand.execute(SuspendCommand.java:29)at org.eclipse.debug.internal.core.commands.ForEachCommand.doExecute(ForEachCommand.java:30)at org.eclipse.debug.internal.core.commands.DebugCommand$1.run(DebugCommand.java:204)at org.eclipse.core.internal.jobs.Worker.run(Worker.java:55)Just rechecked with 3.4.2 and there I can debug without problems. It seems that all the GC threads do not show up at all in the Debug view in 3.4.2 (or it happens so fast I cannot notice).I have a college with the same setup, and the same problem, so it is not faulty hardware!Any idea? Not being able to debug is rather critical, i believe...CreatedError dialog while debuggingA debug session that starts in the Java Perspective.The application is poked alot and works fine until the breakpoint is hit.Then the attached dialog shows up.When pressing details, the rendering of the window turns black.I have updated to JDK 1.6.0_16 and still have this problem.The log contained the following stacktrace when I got the dialog shown in:java.lang.OutOfMemoryError: unable to create new native threadat java.lang.Thread.start0(Native Method)at java.lang.Thread.start(Thread.java:597)at org.eclipse.core.internal.jobs.WorkerPool.jobQueued(WorkerPool.java:145)at org.eclipse.core.internal.jobs.JobManager.schedule(JobManager.java:1001)at org.eclipse.core.internal.jobs.InternalJob.schedule(InternalJob.java:391)at org.eclipse.core.runtime.jobs.Job.schedule(Job.java:435)at org.eclipse.debug.core.DebugPlugin.fireDebugEventSet(DebugPlugin.java:471)at org.eclipse.debug.core.model.DebugElement.fireEvent(DebugElement.java:95)at org.eclipse.debug.core.model.DebugElement.fireCreationEvent(DebugElement.java:113)at org.eclipse.jdt.internal.debug.core.model.JDIDebugTarget.createThread(JDIDebugTarget.java:498)at org.eclipse.jdt.internal.debug.core.model.JDIDebugTarget$ThreadStartHandler.handleEvent(JDIDebugTarget.java:1847)at org.eclipse.jdt.internal.debug.core.EventDispatcher.dispatch(EventDispatcher.java:155)at org.eclipse.jdt.internal.debug.core.EventDispatcher.access$0(EventDispatcher.java:104)at org.eclipse.jdt.internal.debug.core.EventDispatcher$1.run(EventDispatcher.java:250)at org.eclipse.core.internal.jobs.Worker.run(Worker.java:55)John, it looks like the SDK's VM is unable to create new threads a some point. Have you seen any other bugs like this?This looks like he simply exceeded the memory available. Each thread allocated needs a chunk of stack and heap memory, so I'm sure if you create enough threads you eventually run out of memory. I've never seen the thread label "garbage collected", but perhaps there is something preventing these threads from terminating (such as catching and ignoring java.lang.ThreadDeath).Well, as stated earlier, I run on a 64 bit machine with 4GB of RAM.I start Eclipse with: -clean -vmargs -Xmx1g -XX:MaxPermSize=512mAnything else i can try to tweak to see if it is a memory problem?Just a note: I think the threads in the app being debugged are a not the problem. The problem is allocating threads in the SDK where the debug client is executing. The debugger did not change much in 3.5 (from 3.4), so I'm not sure why there is an issue.Whatever small changes have been made between 3.4.2 and 3.5 has a major impact on 64-bit Windows running 32-bit JVM.Am I the only one with that mix that see this problem?I have exactly the same Problem with a Springsource Toolsuite Version: 2.1.0.SR01 (Eclipse 3.5.0)eclipse crashes when debugging an application usually eith the errorI'm using jdk 1.6.18 under 32bit WinOSIt seems the number of threads raises within one or two seconds from 60 up to over 800 threads which then cause the OutOfMemoryError.I made a thread dump using visualVM with the result that there are a few hundred threads in it, and a all of the following kind:"Worker-277" prio=6 tid=0x66040c00 nid=0x11f8 waiting on condition [0x7283f000] java.lang.Thread.State: TIMED_WAITING (sleeping) at java.lang.Thread.sleep(Native Method) at org.eclipse.core.internal.jobs.JobManager.join(JobManager.java:815) at org.eclipse.jdt.internal.debug.core.model.JDIDebugTarget$ThreadDeathHandler.handleEvent(JDIDebugTarget.java:1930) at org.eclipse.jdt.internal.debug.core.EventDispatcher.dispatch(EventDispatcher.java:155) at org.eclipse.jdt.internal.debug.core.EventDispatcher.access$0(EventDispatcher.java:104) at org.eclipse.jdt.internal.debug.core.EventDispatcher$1.run(EventDispatcher.java:250) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:55) Locked ownable synchronizers: - NoneWould be good if it would be fixed soon.Looks like this problem is caused by the fix to. Each event set is handled in a separate job.CreatedpatchPatch processes thread start/death events in one job to avoid flooding the queue. As well, since thread start/death events are serialized we are sure to process them in the correct order (start before death), so the thread death event handler no longer has to join/wait on thread start event jobs.Applied/Fixed. Please verify, Curtis.(In reply to)Thanks, Darko.It seems that was the information needed to pinpoint the bug :-)I will try to remember visualVM for another time...Workaround before patch: Running 64bit eclipse with a 64bit jvm and debugging my 32bit application using a 32bit jre runtime doesn't hang, but still experience extreme slowdowns and the excessive thread-tree in the thread view.Re-opening. Unfortunately, this is causing test failures on Linux/Mac: bub 303486I've reverted these changes until I can figure out why they are causing a failure. Some breakpoints are being missed with this change.Createdpatchupdated patch. On linux, it appears that a ThreadStartEvent set and BreakpointEvent set can delievered for the same thread, at the same time. (One would expect that until the thread start event set is resumed, a breakpoint in that thread cannot be hit). In this case, the breakpoint is on the first line of the a runnable, so it appears the VM is delivering both event sets at once. The debugger was processing the events sets at same time in different jobs, and the breakpoint event failed, since we had not yet created a model object for the thread (being processed in the thread start event job).This fix uses scheduling rules to ensure that the thread start event is processed before any breakpoint event in the same thread.Fixed. Please verify, Curtis.CreatedpatchAdditional fix to avoid running jobs after shutdown. Applied.I've reverted this change again, it appears to be causing.CreatedScreenshot from ProcessExplorer (Windows)Any update on this issue?I am seeing a large number of native threads being created during debug (~800-900), all of which are "MSVCR71.dll!endthreadex+0x31".This causing the CPU to spin up to 50%, and eclipse hangs.I am currently unable to debug.The application I am debugging does create a large number of short-lived threads regularly.Running on (good old) Windows XP, Eclipse build 20100218-1602Sample shot from Process Explorer attachedThanks,JasonAs a Workaround tip:For me it worked out to create a complete new workspace from the scratch. Don't try to copy the workspace or reuse the workspace metadata!!!my workaround has been to reduce the number of threads created/destroyed by the application I am debugging. With fewer threads it seems eclipse is able to handle the native thread creation/destruction without going into a tail spin.No one on the debug team has had more time to spend on this one. Since the fix is in a sensitive code area, and any potential fix is risky, this may not get fixed in 3.6.Understood. I think the problem only manifests with large numbers of threads created/destroyed in rapid succession (on Windows anyway). For now the workaround to reduce thread numbers is fine.I will look into the possibility mentioned in the workaround. Unfortunately, I do not believe we can control the number of threads used while communicating with a 3d renderer through jni (cortona using jacozoom).I am running 32-bit Eclipse (Juno SR 2 - 20130225-0426) on 64-bit Windows 7. The process has 4 GB of virtual address space. The program I am debugging is creating a lot of short-lived threads. This causes Eclipse to create 1791 threads which won't exit. The entire 4 GB address space is used up. I suppose I could run 64-bit Eclipse to get more address space but then my machine will thrash.All of the threads have exactly the same call stack! Do we really need that many threads to deal with debuggee thread death events? I would think only 1 thread would be required.at java.lang.Thread.sleep(Native Method)at org.eclipse.core.internal.jobs.JobManager.join(JobManager.java:925)at org.eclipse.jdt.internal.debug.core.model.JDIDebugTarget$ThreadDeathHandler.handleEvent(JDIDebugTarget.java:2051)at org.eclipse.jdt.internal.debug.core.EventDispatcher.dispatch(EventDispatcher.java:152)at org.eclipse.jdt.internal.debug.core.EventDispatcher.access$0(EventDispatcher.java:100)at org.eclipse.jdt.internal.debug.core.EventDispatcher$1.run(EventDispatcher.java:249)at org.eclipse.core.internal.jobs.Worker.run(Worker.java:53)The simple program below reproduces the problem 100% of the time when debugged with 32-bit Eclipse IDE on 64-bit Windows 7. The program never outputs anything. Both Eclipse IDE and the program stop using the CPU.Eclipse IDE has 1901 threads running. It's virtual address space is completely used up (i.e all 4 GB used). The debugged program is no where near maxed out on its address space.I used SysInternal's VM Map to inspect the address space. It calls out 1901 call stacks with an associated thread ID which consume 1 MB of virtual address space. It calls out another 1901 call stacks which say "64-bit thread stack" which consume 256 KB of virtual address space. Before I really dug into the problem, I assumed this meant the thread had exited and HotSpot didn't clean up the call stack yet. Now that I see there is a 1:1 ratio between call stacks with thread ID and call stacks without an ID, I am wondering if the two are tied to each other. If so, why consume so much space for both? Why not put them together?I took a thread dump of Eclipse. 1870 threads have the following call stack. Some thing is definitely wrong with Eclipse JDT debugger. These threads don't exit after several minutes. These threads might exist because the debuggee's thread terminated instead of created. I say that because the 3ʳᵈ frame says "ThreadDeathHandler". at java.lang.Thread.sleep(Native Method) at org.eclipse.core.internal.jobs.JobManager.join(JobManager.java:925) at org.eclipse.jdt.internal.debug.core.model.JDIDebugTarget$ThreadDeathHandler.handleEvent(JDIDebugTarget.java:2051) at org.eclipse.jdt.internal.debug.core.EventDispatcher.dispatch(EventDispatcher.java:152) at org.eclipse.jdt.internal.debug.core.EventDispatcher.access$0(EventDispatcher.java:100) at org.eclipse.jdt.internal.debug.core.EventDispatcher$1.run(EventDispatcher.java:249) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:53)I used a BTrace script to dump the call stack when Thread.start() is called. 1896 threads were created with the following call stack. Unfortunately, that isn't very helpful... to me. org.eclipse.core.internal.jobs.WorkerPool.jobQueued(WorkerPool.java:148) org.eclipse.core.internal.jobs.WorkerPool.startJob(WorkerPool.java:244) org.eclipse.core.internal.jobs.Worker.run(Worker.java:50)Programpublic class ThreadLauncher{ public static void main(String[] args) { Thread thread; int i; i = 0; try { for ( ; true; i++) { thread = new Thread(); thread.setDaemon(false); thread.setName("Thread " + i); thread.setPriority(Thread.MIN_PRIORITY); thread.start(); } } catch (Throwable t) { System.out.println("Failed to create thread #" + i); System.out.flush(); t.printStackTrace(); System.err.flush(); } }}Hello all,after analyzing the OutOfMemoryException while debugging in eclipse I found out following information, which might be helpful to solve the eclipse-problem:at first some facts:- we are working on a web application (.NET interoperating with JavaVM through Caffeine/JNI) which creates lots of threads.- if a thread ends in the .NET-environment the corresponding Java-thread is also being shutdown/released at the same time.- if a request lifetime ends in the .NET-env. the corresponding Java-thread is also being shutdown/released at the same time (this dued to the problem in eclipse).Now, when I tried debugging (remotely bound to the JavaVM-part of our application) I could sometimes observe that lots of threads are created in eclipse's Debug-Window and shortly after that or almost at the same time eclipse freezes.The more interesting thing was, when I had a look on eclipse's Heap Dump with Eclipse Memory Analyzer after eclipse got frozen.There have been about 700 Workers running, i.e. threads opened.So, what I suppose is that the eclipse debugger tries to "catch" the "lost" Java-threads (shutdown or killed by .NET) by repeatingly instantiating new workers until memory space is completely filled by them.OUR SOLUTION/WORKAROUND was to change the logic of our application as this:When requests are finished in .NET the Java threads are not released any more. After this change the eclipse debugger works fine as it should.I hope this information helps fixing this problem.I'm seeing the same problem with Kepler SR2 and Win 7 64 bit and java 1.6.0.41. Windows resource monitor says that the process has over 18000 threads and when I hit Ctrl-break in the eclipse/java console window the thread dumps have the same thread death related join profile. Is there someway to get a higher priority on fixing this? RIght now I have to download netbeans as I have a serious blocking issue I need to debug and can't do it with Eclipse anymore. Would it help to shorten the join timeout used? Could ThreadDeathHandler detect these cases an not join since it seems that the thread is gone anyway?Here's the stack trace."Worker-2199" prio=6 tid=0x000000001e644800 nid=0x148bc waiting on condition [0x00000000db77e000] java.lang.Thread.State: TIMED_WAITING (sleeping) at java.lang.Thread.sleep(Native Method) at org.eclipse.core.internal.jobs.JobManager.join(JobManager.java:935) at org.eclipse.jdt.internal.debug.core.model.JDIDebugTarget$ThreadDeathHandler.handleEvent(JDIDebugTarget.java:2055) at org.eclipse.jdt.internal.debug.core.EventDispatcher.dispatch(EventDispatcher.java:152) at org.eclipse.jdt.internal.debug.core.EventDispatcher.access$0(EventDispatcher.java:100) at org.eclipse.jdt.internal.debug.core.EventDispatcher$1.run(EventDispatcher.java:249) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:53)	37.0
id=319636	REOPENED	JDT	Debug	3.6	PC All	P3 major	JDT-Debug-Inbox	2010-07-12 17:07 EDT by	Holger Mising name	2011-01-24 14:08 EST (	2 users	Build Identifier: 20100617-1415 Eclipse 3.6 HeliosIf I edit code and save while the debugger has paused execution in the vicinity (the same method), hot code replace fails for the openJDK. Expected behavior would be to drop the last frame from the stack and reenter the method again.If I only edit whitespace or add a comment, no error is shown and execution is aligned with the correct line-numbers. After such a change I can in a second step edit the code without getting the error-message. But the codechanges don't take effect for the currently running debug-session.Versions:java -version > java version "1.6.0_18"OpenJDK Runtime Environment (IcedTea6 1.8) (6b18-1.8-0ubuntu1)OpenJDK Client VM (build 14.0-b16, mixed mode, sharing)uname -a > Linux Samson 2.6.32-23-generic #37-Ubuntu SMP Fri Jun 11 07:54:58 UTC 2010 i686 GNU/LinuxActually it is Kubuntu, so I'm running KDE 4.4.2Reproducible: AlwaysSteps to Reproduce:public class Test { public static void main(String[] args) { boolean flag = true; // breakpoint here if (flag) { System.out.println("debug"); } else { System.out.println("normal"); } }}1. Place a breakpoint on line 4 of the given Test.java2. Debug the program until the execution halts at the breakpoint3. edit the source (any one of:)- change initialization of the flag from true to false- negate the condition of the if-statement- type a letter into one of the String literals in the System.out.println()s4. and save5. Dialog appears with:Obsolete Methods on the Stack<ClassName> at localhost:<Port> contains obsolete methods.Reason:The virtual machine was unable to remove all stack frames running old codefrom the call stack. The virtual machine is not supplying the debugger withvalid data for those frames. Stepping into these obsolete frames may behazardous to the target virtual machine.Do not show error when obsolete methods remainContinue Terminate Restart	This is working as expected. It is not possible to pop/re-enter the last method on the stack. In this case you are modifying "main". The debugger steps out and re-enters the modified method. In this case, we cannot step out of the main method and re-enter, as the debugger will have no where to re-enter from.The debugger also cannot pop native methods. This is a limitation of Java VMs.Thank you Mr. Wright!Sorry, I've reduced the example to much ... but it gave the same error message. You've convinced me, that main() is a special case. Though I wonder why there is no error, if I first edit a comment, save and then edit the code for a second time?Here is another Testcase:public class Test<X> { public static void aMethod() { boolean flag = true; // breakpoint here if (flag) { System.out.println("debug"); } else { System.out.println("normal"); } } public static void main(String[] args) { aMethod(); }}Without the generic type parameter X the debugger will drop aMethod() and reenter it as expected. But in presence of generics hot code replacement fails with the aforementioned error-message.It does not matter, whether aMethod() is static or not, or if it uses the generic type parameter.BTW: I've reproduced the behavior with sun java, so I guess it's not specific to OpenJDK. -> I'm changing the summaryNeeds investigation. Also fails on Windows when the type variable is present.	3.0
id=322932	REOPENED	JDT	Debug	3.5.1	PC Windows Vista	P3 normal	JDT-Debug-Inbox	2010-08-17 13:05 EDT by	Mário Guimarães	2010-10-21 05:27 EDT (	2 users	Build Identifier: M20090211-1700The VM system property "osgi.console.encoding" is being ignored by the Console View. Well, at least the Console View does not show the right characters for the encoding set via this property.Reproducible: AlwaysSteps to Reproduce:1) Create the following "Java Application" inside Eclipse:import java.io.IOException;public class Encode { public static void main(String[] args) throws IOException { System.out.println(System.getProperty("osgi.console.encoding")); System.out.println((char)0xC3); }}2) Create a "Run Configuration" and set "-Dosgi.console.encoding=Cp437" on the VM arguments tab3) Run it from Eclipse.On the Console View you will see that the property was set correctly, but a character (Ã) will appear instead of a box drawing character (&#9500;)4) If the same application is run from the MS-DOS command prompt it will print the box drawing character correctly.	You likely need to set the encoding on the "Common" tab of the launch configuration to match. Does this work?"Not able to manually type console encoding on Run Configurations" prevents me from doing that.This is addressed by*** This bug has been marked as a duplicate of***Sorry, but the reason given to close this bug is not valid because it is not a duplicate of:requested manual editing of the encoding in "Run Configurations->Commons" tab, butconcerns editing the encoding via "Run Configuration->Arguments->VM arguments tag" (e.g., "-Dosgi.console.encoding=Cp437" on this last tab) or directly when running eclipse from the terminal (e.g., "eclipse.exe ... -Dosgi.console.encoding=Cp437 ...").So these two bugs are different though their purpose is to set the same VM property.In addition, you need to decide which setting wins when the VM property is set differently at different places. In this case, I suggest that the"-Dosgi.console.encoding=XXXX" setting should win.Cheers!	4.0
id=332387	REOPENED	JDT	Debug	3.7	PC Windows XP	P3 normal	JDT-Debug-Inbox	2010-12-12 04:32 EST by	Ant Kutschera	2015-02-26 09:55 EST (	6 users	Build Identifier: 20100617-1415Prior to eclipse 3.6, in the debug perspective, you could "inspect" variables by highlighting them and hitting ctrl+shift+i. you could then resize the popup window and eclipse remembered what size it was the next time you inspected something.In eclipse 3.6, you can inspect variables, but regardless of whether you resize the window, the next time you inspect something, the window goes back to its default size. That's annoying because I like that window to be nice and big.Is there any way to set eclipse to remember the size of this window, or is it a bug?Reproducible: AlwaysSteps to Reproduce:1. In debug mode, at a break point in a running program, select a variable2. hit ctrl+shift+i, or use context menu to inspect the variable3. resize the inspect window so that it becomes useful4. press escape, let the program continue. at some other break point, start at step 1 again. expected result: when inspect window opens, it should be the large size, ie like it was after i resized it during the last inspection. actual result: window has returned to its default size.	This works for me in 3.7.Ant, can you try 3.7 to confirm?HelloAs I am new to using this Site, I don't know, where to look fpr the Version-Number. I installed Eclipse new about 2 Weeks ago. Just now Version "Eclipse Helios (3.6.2)" is downloadable, and so I believe, I have just that Version, too. So, I don't understand where I could get Version 3.7.The Problem described above is still current within my Version. Is there a hidden Place, where I could tell the Window to remember its size?Regards Mario+1I'm working with 3.6.1 (classic) and have the same problem...i want to fix the problem in my current version and not to download new one.(In reply to)There are no plans to back-port any of the work we did for pop-up resizing to 3.6.x, so unfortunately you will have to update to 3.7.x.marking as WORKSFORMEJust downloaded Indigo (Developers build, 64 bit Windows) a few Minutes ago. Doesn't seem to be fixed?(In reply to)Thats very odd, I tested on Linux and Win7 64bit using:Version: 3.7.0Build id: I20110322-0800and it works fine.(In reply to)I use:Version: Indigo ReleaseBuild id: 20110319-2305Help says: Eclipse Platform 3.7.0.I20110310-1119Maybe I downloaded something wrong?eclipse.org offers only "Eclipse Helios (3.6.2)" in the download section.So I looked into section "Developer Builds" and fetched "Eclipse IDE for Java EE Developers, 216 MB". I also use Win 7 64 bit.For me there are too many numbers - where exactly do I find the numbers we would need to compare build id version etc.?Could you please explain where you got your Version from? I got mine some minutes before I posted the last msg, but yours seem much newer.Thx a lot(In reply to)Help menu > About. In the resulting dialog the information is available in the text area.I grab mine from:with 3.7-m7, it remembers the size after ctrl-shift-i, but not the position. hovering over the variable opens something different, where unfortunately position and size is not remembered.I'm reopening this bug, because if you hit ctrl+shift+i or select "inspect" from the context menu, it now works again. BUT if you simply hover over a variable, the window always has the same mini size...I'm reopening this bug, because if you hit ctrl+shift+i or select "inspect" from the context menu, it now works again. BUT if you simply hover over a variable, the window always has the same mini size...Im using:Eclipse Java EE IDE for Web Developers.Version: Indigo ReleaseBuild id: 20110615-060432 Bit, Java 1.6.0_19 on Windows7.(In reply to)There is nothing debug can do to persist / restore the size for this kind of pop up. The hover framework seems to enforce a maximum size that the hover can be prior to it opening. Markus, is there a mechanism to allow a hover to open at a persisted size? For example the JavaDebugHover tries to open the hover at 803x432 (my persisted test size), but in AbstractInformationControlManager, that sizing is pruned down to 602x182.Same is true even for 'Run Configurations' and 'Debug Configurations' window pop-ups. If you re-size, and then click on some other Launch Configuration, the whole window reset allowing very little visible space for 'Program Arguments' and 'VM arguments' text area in the 2nd tab on these pop-up windows.	13.0
id=334376	REOPENED	JDT	Debug	3.7	All All	P3 enhancement	JDT-Debug-Inbox	2011-01-14 08:20 EST by	Deepak Azad	2011-05-02 11:24 EDT (	4 users	This default JRE could then be used for all newly created launch configs, e.g. when you invoke a test from the Java editor or Outline view.PDE already supports this in the Target Platform Environment. We could add something similar to Java > Debug, but with an additional option "<Use project JRE>".	You can already select a default JRE on the JRE page. When creating a new launch configuration, the jre is based on the project execution environment, however for many projects the workspace default JRE will be chosen for this.The PDE option you describe actually just uses the existing workspace JRE setting to work.I'm closing this as WORKSFORME. If I have missed something about your issue, please reopen with more information.(In reply to)Right, I want to be able to specify a particular JRE for all the new launch configs and ignore the project execution environment. For example, I prefer to use JRE 1.6 for debugging but when I launch a test from the editor the jre in the launch config is based on project execution env which could be 1.4 or 1.5. I would just like to use 1.6 all the time :)In which cases is the workspace default JRE used ?When you create a new project, one of the options is to use a specific JRE (or the default) instead of an execution environment. Naturally, the launch configuration uses the information in the project to determine what to use.Note that you can change which JRE is associated with an execution environment on the execution environment preference page. If you always want to use you 1.6 jre, changing the settings there should be enough.If you want more custom behaviour (use 1.6 jre when testing, EE when running a java application, etc.), I don't see JDT debug putting in that complex of an option. It sounds very similar to the launch configuration template enhancement that was tried in 3.6 (and removed because it never worked 100%).(In reply to)I guess you mean. Template support would indeed help.	4.0
id=298946	REOPENED	JDT	Debug	3.6	PC Windows XP	P3 normal	JDT-Debug-Inbox	2010-01-06 09:38 EST by	Darin Wright	2014-04-14 11:54 EDT (	2 users	I "removed all" breakpoints from the breakpoints view when the detail pane was displaying the condition editor for a Java line breakpoint. The detail pane remained, and the check box was editable after the fact. Found the following in my log:java.lang.NullPointerExceptionat org.eclipse.jdt.internal.ui.text.java.JavaAutoIndentStrategy.computeSmartMode(JavaAutoIndentStrategy.java:1275)at org.eclipse.jdt.internal.ui.text.java.JavaAutoIndentStrategy.clearCachedValues(JavaAutoIndentStrategy.java:1265)at org.eclipse.jdt.internal.ui.text.java.JavaAutoIndentStrategy.customizeDocumentCommand(JavaAutoIndentStrategy.java:1210)at org.eclipse.jface.text.TextViewer.customizeDocumentCommand(TextViewer.java:3744)at org.eclipse.jface.text.TextViewer.handleVerifyEvent(TextViewer.java:3774)at org.eclipse.jface.text.TextViewer$TextVerifyListener.verifyText(TextViewer.java:433)at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:249)at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1050)at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1074)at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1059)at org.eclipse.swt.widgets.Widget.notifyListeners(Widget.java:773)at org.eclipse.swt.custom.StyledText.modifyContent(StyledText.java:6715)at org.eclipse.swt.custom.StyledText.sendKeyEvent(StyledText.java:7554)at org.eclipse.swt.custom.StyledText.doContent(StyledText.java:2447)at org.eclipse.swt.custom.StyledText.handleKey(StyledText.java:5910)at org.eclipse.swt.custom.StyledText.handleKeyDown(StyledText.java:5940)at org.eclipse.swt.custom.StyledText$7.handleEvent(StyledText.java:5634)at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1050)at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1074)at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1059)at org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:1100)at org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:1096)at org.eclipse.swt.widgets.Widget.wmChar(Widget.java:1505)at org.eclipse.swt.widgets.Control.WM_CHAR(Control.java:4060)at org.eclipse.swt.widgets.Canvas.WM_CHAR(Canvas.java:352)at org.eclipse.swt.widgets.Control.windowProc(Control.java:3952)at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:348)at org.eclipse.swt.widgets.Display.windowProc(Display.java:4678)at org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method)at org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:2437)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3522)at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2407)at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2371)at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2220)at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:500)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:493)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:113)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:194)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:367)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)at java.lang.reflect.Method.invoke(Unknown Source)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:611)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:566)at org.eclipse.equinox.launcher.Main.run(Main.java:1363)	CreatedpatchFixed. Please verify, Mike.It feels awkward to remove all breakpoints and still see a detail pane (with widgets). I think it would better if the pane was removed instead of just having its controls disabled.CreatedcheeseI also found that if you re-add a breakpoint to the view (after removing them all) the widgets re-enable when nothing in the view is selected.(In reply to)This is actually a design point of the detail pane manager. The pane doesn'tchange type unless the input changes to need a different type. The variablesview does the same thing - except you don't notice it because it's just a blanktext widget. If it was removed - you'd see the "no details available".(In reply to)This is covered by, which is the selection issue we're seeing from the single cell selection in the variables view.(In reply to)I'd prefer to open a new bug for this, if you want, since it changes detail pane behavior in all views, not just the breakpoints view.(In reply to)That is exactly what I would expect to happen.Nothing planned for 3.6. The detail pane infrastructure has always left the existing detail pane behind - this is to avoid re-creating a new (possibly identical) detail pane the next time something is added/selected in the view. This was less noticeable with the variables view, as the detail pane is a white text viewer that looks the same when present/missing.	9.0
id=343023	REOPENED	JDT	Debug	3.7	PC Linux	P3 enhancement	JDT-Debug-Inbox	2011-04-15 18:06 EDT by	Ewgeni Grigorov	2013-04-19 06:08 EDT (	6 users	Build Identifier: CVS, 16.04.2011Initially, the idea comes from:I think that it's very useful, because that behavior will save a user operation.Reproducible: AlwaysSteps to Reproduce:To reproduce, just paste a stack trace in the initialized stack trace console. The initial console message will remain.	Createdpossible fixThe attached fix is based on DocumentListener, which is added on the first initialization and removed after the first usage.Fixed as part of the debug patch day. Thanks for the contribution!Verified in:Version: 4.3.0Build id: I20121210-2000There a corner case which is now broken, see.None of the fixes proposed here or inhave been satisfactory. At this point I can't put more time into debugging the console document adapter for this trivial feature. Hopefully someone from the community can make an attempt at a better fix.Reverted fix:does not work with 4.3M6(In reply to)Please read.	7.0
id=365394	REOPENED	JDT	Debug	3.7	PC Windows XP	P3 normal	JDT-Debug-Inbox	2011-12-02 02:44 EST by	Sebastian Dietrich	2014-10-03 14:15 EDT (	7 users	Build Identifier: 20110916-0149In my project (~100 eclipse projects, some rather large) when I set a breakpoint, debug the project and the breakpoint is hit, it takes very long time until the breakpoint line is marked in the editor. It is shown in the Debug window, but takes ~20 secs until it is marked in the editor (even when the corresponding code is already shown in the editor)Reproducible: Always	I also have this problem. I'd add this, though:- only the first hit is veeery slow, i.e. the first breakpoint that is hit after you "run in debug mode" your application/your server (if you're debugging a Tomcat instance with WTP)- you can't watch variables, step forward/into, etc. until the code line highlighting has been performed- since the upgrade from Indigo to Juno, the problem got much worse; I would say it was not a problem in Indigo, but it is in JunoI'm working on Windows 7 64-bit with Eclipse Juno 4.2.1 64-bit. A co-worker of mine has the same problem under Linux Debian 32-bit.Createdslow-breakpoint-hitI've the same problem, attached a JVisualVM snapshot where it takes ~5 seconds to jump to the source line of the breakpoint.Looks like it reading a zip file in thread Worker-4:org.eclipse.debug.internal.ui.sourcelookup.SourceLookupFacility$SourceLookupJob.run() 5.199 mswhich seems to send the most time in I think reading the JDK src.zip (I removed all other sources from the build path).I've about 10 jre/jdks installed (last of JDK 6/7/8 in 32 and 64 bit versions).The problem occurs running a simple unit test with Java 7/8 with a breakpoint in a large project.It occurs as mention the first time a breakpoint is hit after launch in debug mode.Using Eclipse IDE for Java DevelopersVersion: Luna Release (4.4.0)Build id: 20140612-0600(I incorrectly added this comment tobefore)This bug (or at least mine) is a duplicate of*** This bug has been marked as a duplicate of***Hi Michael,how can this bug (reported in 2011 against Juno) be a duplicate of a 2014 bug reported as a regression in Luna against Kepler?(In reply to Mauro Molinari from)My apologies, I was resolving based on Walters comment. Reopening.	6.0
id=394983	REOPENED	JDT	Debug	3.8.1	PC Windows 8	P3 enhancement	JDT-Debug-Inbox	2012-11-23 10:55 EST by	Johan Compagner	2012-11-27 06:45 EST (	1 user	Now we seem to be able go get only to the parent, but for example if the Object is hold on to in a ArrayList then we see that it is hold on to an Object[] but that is not really useful, it would be much better if we could collapse the tree so that we see the ArrayList (that holds the Object[]) and then what object the ArrayList holds and so on.	I believe what you are looking for is already available in logical structures. Logical structures change the structure of variables to display more convenient information.Here is a blog talking about it:There already exists logical structures for lists. You can contribute your own via plugin.xml or on the Java > Debug > Logical Structures preference page.No this has nothing to do with logical structures...The problem is that i see the structure (logical or not) of the objects that references the object i ask "All references" forFor example i am in the debuggerin the variables view i have "this"i click on "this" and then do "All references"then i get a popup dialog like a kind of outline viewWhere it says "this references from"and then the list/tree of all the objects that did reference the "this" objectBut when i collapse 1 item of that object, i get the logical or not view of that object, But that is not what i want to see (or what i only want to see)i want to see as a memory profiler, what is really referencing that object againBecause the 1 level deep doesn't tell me anything. For example the first entry in that list/tree i have another object, if i expand that node then yes i see a entry that is my "this" entry. thats all fine, but now i want to know where that object is referenced. Because this 1 reference deep doesn't tell me much, i need to go to the GC Root.. (or at least way further down) to really see what object is really keeping a reference to my object where i ask "all references" on. Most of the time those intermediate objects are not importantWe added support to display references in the variables view, rather than the popup. On the variable view menu, Java > Show References.If you want a complete map of the references for memory profiling, you are better off using a profiler such as YourKit.yes i use profilers a lot but finding the references directly at debug time is sometimes very handy.The feature we now have is not really helpful at all, going one down/deeper is most of the time not really helpful.It is currently a bit possible i think by constantly inspecting the object that is a referring one again and then doing there the find reference again on.But it would be way nicer if that was just in the popup. So that we have besides the objects internals tree. Also a item that shows the references again of that object	4.0
id=420778	REOPENED	JDT	Debug	4.4	All All	P3 normal	JDT-Debug-Inbox	2013-10-31 01:17 EDT by	shankha banerjee	2013-11-21 10:08 EST (	2 users	Parts did not open: org.eclipse.jdt.debug.tests.context.view.one, org.eclipse.jdt.debug.tests.context.view.twojunit.framework.AssertionFailedError: Parts did not open: org.eclipse.jdt.debug.tests.context.view.one, org.eclipse.jdt.debug.tests.context.view.twoat org.eclipse.jdt.debug.tests.ui.ViewManagementTests.testAutoOpenDebugPerspective(ViewManagementTests.java:210)at org.eclipse.jdt.debug.tests.AbstractDebugTest.runBare(AbstractDebugTest.java:2405)at org.eclipse.jdt.debug.tests.DebugSuite$1.run(DebugSuite.java:55)at java.lang.Thread.run(Thread.java:724)Test Results Location:BuildID: I20131030-1400	*** This bug has been marked as a duplicate of***There's not just. When enabling #testAutoOpenDebugPerspective it consistently fails on all platforms.***has been marked as a duplicate of this bug. ***	3.0
id=428417	REOPENED	JDT	Debug	4.4	PC Windows 7	P3 normal	JDT-Debug-Inbox	2014-02-18 07:00 EST by	Dani Megert	2017-01-19 03:45 EST (	5 users	N20140217-2000.Listener should have been notifiedjunit.framework.AssertionFailedError: Listener should have been notifiedat org.eclipse.jdt.debug.tests.core.HcrTests.testHCRAnonymousType3(HcrTests.java:593)at org.eclipse.jdt.debug.tests.AbstractDebugTest.runBare(AbstractDebugTest.java:2405)at org.eclipse.jdt.debug.tests.DebugSuite$1.run(DebugSuite.java:55)at java.lang.Thread.run(Thread.java:722)	Similar test failstestHCRLocalType3 Failure Listener should have been notifiedjunit.framework.AssertionFailedError: Listener should have been notifiedat org.eclipse.jdt.debug.tests.core.HcrTests.testHCRLocalType3(HcrTests.java:435)at org.eclipse.jdt.debug.tests.AbstractDebugTest.runBare(AbstractDebugTest.java:2464)at org.eclipse.jdt.debug.tests.DebugSuite$1.run(DebugSuite.java:55)at java.lang.Thread.run(Thread.java:744)***has been marked as a duplicate of this bug. ***Failed againtestHCRAnonymousType3 Error N/Ajava.util.ConcurrentModificationExceptionat java.util.ArrayList$Itr.checkForComodification(ArrayList.java:859)at java.util.ArrayList$Itr.next(ArrayList.java:831)at org.eclipse.ui.texteditor.AbstractMarkerAnnotationModel.removeAnnotations(AbstractMarkerAnnotationModel.java:398)at org.eclipse.ui.texteditor.AbstractMarkerAnnotationModel.updateMarkers(AbstractMarkerAnnotationModel.java:640)at org.eclipse.ui.texteditor.AbstractMarkerAnnotationModel.commit(AbstractMarkerAnnotationModel.java:697)at org.eclipse.core.internal.filebuffers.ResourceTextFileBuffer.commitFileBufferContent(ResourceTextFileBuffer.java:409)at org.eclipse.core.internal.filebuffers.ResourceFileBuffer.commit(ResourceFileBuffer.java:327)at org.eclipse.jdt.internal.ui.javaeditor.DocumentAdapter.save(DocumentAdapter.java:513)at org.eclipse.jdt.internal.core.CommitWorkingCopyOperation.executeOperation(CommitWorkingCopyOperation.java:123)at org.eclipse.jdt.internal.core.JavaModelOperation.run(JavaModelOperation.java:729)at org.eclipse.core.internal.resources.Workspace.run(Workspace.java:2241)at org.eclipse.jdt.internal.core.JavaModelOperation.runOperation(JavaModelOperation.java:794)at org.eclipse.jdt.internal.core.CompilationUnit.commitWorkingCopy(CompilationUnit.java:391)at org.eclipse.jdt.debug.tests.core.HcrTests.testHCRAnonymousType3(HcrTests.java:594)at org.eclipse.jdt.debug.tests.AbstractDebugTest.runBare(AbstractDebugTest.java:2466)at org.eclipse.jdt.debug.tests.DebugSuite$1.run(DebugSuite.java:57)at java.lang.Thread.run(Thread.java:744)Again!!It's happening more frequently!!Failed on Linux -Failed on Windows:Windows again!!On Windows again--1 test fails on Windows.3 tests failedThis issue is seen with IBM SDK with the below version.java version "1.7.0"Java(TM) SE Runtime Environment (build pxi3270_27sr4-20160907_01(SR4))IBM J9 VM (build 2.7, JRE 1.7.0 Linux x86-32 20160906_317630 (JIT enabled, AOT enabled)J9VM - R27_jvm.27_20160906_0002_B317630JIT - tr.r13.java_20160823_123277GC - R27_jvm.27_20160906_0002_B317630J9CL - 20160906_317630)Error Trace:--------------------ECL (eclipse) java.util.ConcurrentModificationExceptionECL at java.util.ArrayList$Itr.checkForComodification(ArrayList.java:871)ECL at java.util.ArrayList$Itr.next(ArrayList.java:843)ECL at org.eclipse.ui.texteditor.AbstractMarkerAnnotationModel.removeAnnotations(AbstractMarkerAnnotationModel.java:398)ECL at org.eclipse.ui.texteditor.AbstractMarkerAnnotationModel.updateMarkers(AbstractMarkerAnnotationModel.java:640)ECL at org.eclipse.ui.texteditor.AbstractMarkerAnnotationModel.commit(AbstractMarkerAnnotationModel.java:697)ECL at org.eclipse.core.internal.filebuffers.ResourceTextFileBuffer.commitFileBufferContent(ResourceTextFileBuffer.java:409)ECL at org.eclipse.core.internal.filebuffers.ResourceFileBuffer.commit(ResourceFileBuffer.java:327)ECL at org.eclipse.jdt.internal.ui.javaeditor.DocumentAdapter.save(DocumentAdapter.java:472)ECL at org.eclipse.jdt.internal.core.CommitWorkingCopyOperation.executeOperation(CommitWorkingCopyOperation.java:123)ECL at org.eclipse.jdt.internal.core.JavaModelOperation.run(JavaModelOperation.java:729)ECL at org.eclipse.core.internal.resources.Workspace.run(Workspace.java:2241)ECL at org.eclipse.jdt.internal.core.JavaModelOperation.runOperation(JavaModelOperation.java:794)ECL at org.eclipse.jdt.internal.core.CompilationUnit.commitWorkingCopy(CompilationUnit.java:391)ECL at org.eclipse.jdt.debug.tests.core.HcrTests.testHCRLocalType3(HcrTests.java:435)ECL at org.eclipse.jdt.debug.tests.AbstractDebugTest.runBare(AbstractDebugTest.java:2466)ECL at org.eclipse.jdt.debug.tests.DebugSuite$1.run(DebugSuite.java:57)ECL at java.lang.Thread.run(Thread.java:809)Just wondering if this bug belongs to the Platform Text component?The problem is that access to org.eclipse.ui.texteditor.AbstractMarkerAnnotationModel.fDeletedAnnotations is not thread safe, so that this list can be modified and iterated at same time => causing the ConcurrentModificationException.New Gerrit change created:Yet Again!!(In reply to Andrey Loskutov from)Very much probable, Can you push that fix ? We get this error minimum 3 times every month so we will have the results very soon.Gerrit changewas merged to [master].Commit:(In reply to Sarika Sinha from)I've merged the change now. Next nightly build should have it in.I'm assigning this to me now and set version to 4.6.2: in case the fix works for jdt, it makes sense to backport it.@Sarika: since I'm not monitoring jdt tests state, can you please ping me if the fix will not work?(In reply to Andrey Loskutov from)Thanks, Will keep you updated.We got it failed on 4.6.2 build. Didn't see it failing on 4.7 after the fix.(In reply to Sarika Sinha from)I will also backport it to 4.6, see@Dani: can you please +1?New Gerrit change created:Gerrit changewas merged to [R4_6_maintenance].Commit:Can't mark it Verified so early, will monitor if it fails or not in further M builds.testHCRInnerType3 Failure Listener should have been notifiedjunit.framework.AssertionFailedError: Listener should have been notifiedat org.eclipse.jdt.debug.tests.core.HcrTests.testHCRInnerType3(HcrTests.java:867)at org.eclipse.jdt.debug.tests.AbstractDebugTest.runBare(AbstractDebugTest.java:2470)at org.eclipse.jdt.debug.tests.DebugSuite$1.run(DebugSuite.java:57)at java.lang.Thread.run(Thread.java:745) 45.688testHCRInnerType4 Failure We should be stopped in the run method expected:<[run]> but was:<[<init>]>junit.framework.ComparisonFailure: We should be stopped in the run method expected:<[run]> but was:<[<init>]>at org.eclipse.jdt.debug.tests.core.HcrTests.testHCRInnerType4(HcrTests.java:928)at org.eclipse.jdt.debug.tests.AbstractDebugTest.runBare(AbstractDebugTest.java:2470)at org.eclipse.jdt.debug.tests.DebugSuite$1.run(DebugSuite.java:57)at java.lang.Thread.run(Thread.java:745) 1.985testHCRInnerType5 Failure We should be stopped in the outerrun method expected:<[outerrun]> but was:<[<init>]>junit.framework.ComparisonFailure: We should be stopped in the outerrun method expected:<[outerrun]> but was:<[<init>]>at org.eclipse.jdt.debug.tests.core.HcrTests.testHCRInnerType5(HcrTests.java:984)at org.eclipse.jdt.debug.tests.AbstractDebugTest.runBare(AbstractDebugTest.java:2470)at org.eclipse.jdt.debug.tests.DebugSuite$1.run(DebugSuite.java:57)at java.lang.Thread.run(Thread.java:745)The original error is gone, but now we have "Listener should have been notified" assertion.Moving to M5.testHCRAnonymousType3 Failure Listener should have been notifiedjunit.framework.AssertionFailedError: Listener should have been notifiedat org.eclipse.jdt.debug.tests.core.HcrTests.testHCRAnonymousType3(HcrTests.java:597)at org.eclipse.jdt.debug.tests.AbstractDebugTest.runBare(AbstractDebugTest.java:2469)at org.eclipse.jdt.debug.tests.DebugSuite$1.run(DebugSuite.java:57)at java.lang.Thread.run(Thread.java:745)@Andrey,Are you working or planning to work on this ?(In reply to Sarika Sinha from)No.Moving out of M5, as no one is working on this currently.	32.0
id=437445	REOPENED	JDT	Debug	4.4	PC Windows 8	P3 normal	JDT-Debug-Inbox	2014-06-14 09:58 EDT by	Ed Willink	2014-09-10 05:42 EDT (	1 user	RC4 and many earlier milestones.Approximately 10% of JUnit reruns using the debugger give me a Cannot connect to VM popup elaborated in the error log as:java.io.IOException: Received invalid handshake at org.eclipse.jdi.internal.connect.SocketTransportService.readHandshake(SocketTransportService.java:218) at org.eclipse.jdi.internal.connect.SocketTransportService.access$7(SocketTransportService.java:212) at org.eclipse.jdi.internal.connect.SocketTransportService$3.run(SocketTransportService.java:183) at java.lang.Thread.run(Thread.java:745)The popup occurs promptly so it isn't the usual 3 seconds is not enough timeout.(I also get similarly intermittent failures on EGIT fetch from upstream.)eclipse.buildId=4.4.0.I20140528-2000java.version=1.7.0_55java.vendor=Oracle CorporationBootLoader constants: OS=win32, ARCH=x86_64, WS=win32, NL=en_GBCommand-line arguments: -os win32 -ws win32 -arch x86_64 -data C:\Development\Chital\Workspace	Looks like:The debugger simply writes the 'JDWP-Handshake' bytes to connect to the VM and is not getting back the correct bytes.This is a problem with the VM. If you have the ability to comment on the above bug, I would recommend you do so.I'm inclined to close this not_eclipse since there isn't really anything we can do on our end, unless we wanted to investigate support for re-sending the handshake a few times to try again. But if the VM is in a bad enough state that it can't return a correct handshake I'm not sure trying again would be a good idea (in case it did connect, would the debugger work in a stable way?).I would assume that egit uses the same socket transport the debugger does, except maybe not the JDWP handshake (I don't know anything about how egit works internally, so thats a complete guess).I feel that the 10/20% frequency of this error is inconsistent with the 0.01% of the referenced bug.After further observation the intermittent failures seem to be correlated with starting a debug immediately after setting a breakpoint or immediately after a build completes.So my suspicion is that the debug session start is communicating concurrently with breakpoint installation, consequently the problem can certainly be cured within Eclipse and may well be due to a threading problem.(In reply to Ed Willink from)Breakpoint installation is done only after the connection to the VM has been made, the debug target has been created and the class has been loaded in the VM - i.e. they are lazily installed as needed. There are requests that we do ask the VM for as soon as it is created, but those also do not happen until we have a VM connection + debug target.I would love to know what exactly it is sending back to you though. Would you be able to put a breakpoint in org.eclipse.jdi.internal.connect.SocketTransportService.readHandshake(InputStream) line 218 and check the contents of the input stream when it fails?(In reply to Michael Rennie from)After a few days running a watcher on port 14143 I get:[0, 0, 0, 29, 0, 0, 0, 0, 0, 64, 100, 2, 0, 0]as handshakeInput which is clearly not very equal to[74, 68, 87, 80, 45, 72, 97, 110, 100, 115, 104, 97, 107, 101](Not 20% frequency, so either it doesn't like being watched or my recent activities have involved more thinking and so few of the quick set breakpoint and run sequences that seem to be the trigger.)	4.0
id=478808	REOPENED	JDT	Text	4.5	All All	P3 normal	JDT-Text-Inbox	2015-10-01 09:06 EDT by	Lars Vogel	2015-10-01 11:30 EDT (	2 users	If I have a method parameter JDT can suggest a variable name:public class CopyHandler { public void execute(IWorkbench [PRESS CTRL+SPACE HERE]) { System.out.println("Copied successful");} }Would be nice to have the same for fields. On of my customers reports that this did work in earlier releases but I have never seen this myself.public class CopyHandler { IWorkbench [PRESS CTRL+SPACE HERE]public void execute() { System.out.println("Copied successful");} }	Tested with Eclipse 3.8 and here is really works. This is therefore a regression and I think should be therefore marked as critical.This works fine for me. Note that the feature only works if the type is know and that hasn't changed since 3.8.Here is a snippet there is does not work in Eclipse Neon, even though the type is already imported. package com.example.e4.rcp.todo.handlers;import org.eclipse.e4.core.di.annotations.Execute;import org.eclipse.e4.ui.workbench.IWorkbench;public class CopyHandler { IWorkbench [PRESS CTRL+SPACE HERE] @Execute public void execute(IWorkbench workbench) { System.out.println("Copied successful"); }}Let me know if I should upload an example project for this, I have this example here in my workspace. Note that it is a plug-in not a Java project.(In reply to Lars Vogel from)Yes, please. The above "snippet" is not a snippet. A snippet is considered to be self-contained, i.e. I can paste and test it.CreatedScreenshot - Example to followCreatedExample projectsThis is a set of plug-ins for this example. Should compile fine in Neon. Use Ctrl+T to open ExitHandler and type IWorkbench [CNTRL +Space] for the field.	6.0
id=97590	REOPENED	JDT	UI	3.1	PC Windows XP	P3 normal	JDT-UI-Inbox	2005-05-31 12:55 EDT by	Tod Creasey	2007-06-01 09:40 EDT (	2 users	RC1When you try to create a java class in High Contrast mode the bottom buttons ofthe wizard are cut off.To set up High Contrast select the High Contrast settings in Control Panel ->Accessibility Options -> Display. We test at 1152x768 resolution.	CreatedScreenshotTod, am I missing something. I don't see any cut off button in the screen shot.And do you know what the rule will be regarding high contrast mode. Are wesaying that Eclipse works in High contrast mode. We didn't in the past. Right ?Everything under main is missing (3 buttons and a label). We have supported HighContrast since Eclipse 2.0.There is also cut off text in the following Java wizardsJava ProjectJUnit test caseBut fixing this basically means rewriting the dialogs. Is there another solutionfor it ?Usually making one of the Composites scrollable does the trick.I was able to fix the new project and the new JUnit test case wizard. However Iam not able to fix the new class wizard since there is a layout problem in SWT(see) which results in the fact that the wizard always has a scrollbar :-(I openedto track the new class wizard and will close this one so thatthe fix gets verified for RC2.When verifying this bug make sure that:- both wizard don't have a scroll bar when opened with a normal font and a normal screen resolution settings- when the dialog is resized (made smaller) a vertical scroll bar appears.Reopening...After testing this accross multiple platform I have to revert this. The scrollcomposite trick works under Windos and Motif, but not under GTK2. The wizardalways shops up with a scroll bar which looks really funny and unprofessional.I will revert the changes and see if I understand why this doesn't work underGTK. Have to test Mac Platform as well.Removing milestone.Have to check what we can do here and if we can avoid the scroll bars under GTK.Verified on I20050610-1200 that both wizards don't offer a vertical scroll baranymore.This is even more complicated as I thought. Under GTK using the blue curveschema not scroll bar shows up, however using the Misc theme forces a scroll bar.Our attempts on this one showed that it is really tricky/impossible to get the scrolled composits doing right and not showing up when they aren't necessary. If we really go that way, it should be better to solve this in platform UI, e.g. the wizard dialog. Setting to won't fix until we have a better solutionMartin we are not going to solve this in the platform ui as it will potentially break the layouts of many pages that are out there that are assuming they are not in a scrolled composite.I personally find the same thing you do - the scrolled Composite is too hard to get right.Making the dialog wider might be a better solution as right now the smaller vertical space is larger. The modifers could be moved to the same line for instance.This bug appears to be resolved in 3.2 - I can see everything on the new java class wizard page when running Eclipse in high contrast.Reopening - this is an issue again in 3.3CreatedScreenshot in 3.3This is also an issue with the new project wizard. In 3.3 we added scrollbars in the preference dialog in low resolutions. I think we need to apply the same pattern to wizards.Seefor more details.I also think it would be good if the wizard dialog adds scrollbars when necessary.Can I set this bug as 'duplicate' of?It is up to you but as we haven't decided what to do yet I would keep it blocked byrather than a dup***has been marked as a duplicate of this bug. ***	19.0
id=469324	REOPENED	JDT	Text	4.5	PC Linux	P3 normal	JDT-Text-Inbox	2015-06-03 15:27 EDT by	Aurelien Manteaux	2016-12-14 04:07 EST (	6 users	The bug only append when a Type (class) is not imported. Once the statement "import package.Type;" appear, it works almost as expected.Here is some examples that produce incorrect auto-completed code :- Stream.cl| => Stream<T>.class (the pipe means clrl+space)- ImmutableList.of| => ImmutableList<E>.of()- Strea| => Stream<T> : the only case where it could be good would be in the variable declaration process ; however since Eclipse cannot know the type parameter, it will write Stream<T>, so one has to remove T and replace it with the right type. This case also append when the Type is imported.Here is the only example that produce right auto-completed code :- new ArrayL| => new ArrayList<>()Type arguments should only be appended when the new keyword precedes the type :- new Someth| => append arguments : new Something<>()- Someth| => don't append arguments : Something- Something.me| => still don't append arguments : Something.method()	See other duplicates ofalso which have similar use cases.*** This bug has been marked as a duplicate of***(In reply to Noopur Gupta from)It looks like you have made a mistake, theis marked resolved since Eclipse 4.3 M7, however, the bug I reported is still present in Eclipse 4.5.0RC2.Noopur, please take another look.As mentioned in, we can alleviate this problem a bit by the fix that is released via.(In reply to Aurelien Manteaux from)In your examples, you can invoke content assist on the type name first and remove the type arguments (via fix for) before appending .class or a static method/field.Let me know if I am missing something else from your bug report in terms of being different fromand its duplicates.(In reply to Noopur Gupta from)Thank you Noopur for your response.Is the patch foralready released ?On Eclipse 4.5.0RC2 and 4.4.2, when1/ I type Map|,2/ I will get Map<K|, V>, with the cursor on K.3/ If I press on backspace, K is deleted : Map<|, V>,4/ If I press again on backspace, < is deleted : Map|, V>From what I understood in, at step 3, I should have had only : Map|Did I miss something ?However, even if the fix would our life easier, it would not be ideal :1/ We would have to remove the generics parameters (with only one backspace, but still one backspace)2/ As you said, we would have to always use content assist with the type before referencing a method or a field.Don't get me wrong, I use a lot and I like Eclipse, but in Intellij this feature seems to be implemented in an easier way which is working very fine : the generic parameters are only appended when the type is prepended by "new ". Would it possible to implement something like that in Eclipse ? Is there any concern with this feature ?(In reply to Aurelien Manteaux from)Seefor the behavior. The first backspace will delete the first type arg and the second backspace will delete the entire text up to '>'. So after step 4, u should be left with just 'Map'. I checked with 4.5 RC3 build and it works as expected.I cannot comment on this right now. Will have to look deeper. Based on, it seems complicated to decide where we need type args."Type arguments should only be appended when the new keyword precedes the type": This should be checked to see that it doesn't create more issues with raw types than adding unnecessary type args right now.(In reply to Noopur Gupta from)Unfortunately, this behavior actually fails to apply for the use case originally described in(as Aurelien tried to point out). The backspace behavior works as described in the context of starting a new line of code, but not when invoking content assist on the right side of an assignment operator. Try the following steps in an attempt to invoke Guava's ImmutableMap.of("Key","Value"):1. Type: Map<String, String> map = ImmutableM|2. Invoke content assist with CTRL+Space, Enter3. Note that this returns "ImmutableMap<String, String>|", with cursor trailing after the inserted text instead of selecting the first type argument for editing.The mitigation behavior fromis not applicable because Eclipse already believes it has identified the type arguments (that still don't qualify as valid syntax in this context). This situation currently requires 16 backspaces, not 2. The fix introduced inhelped mitigate duplicates 336043 and 356282, but did not address 283950, which was improperly closed.Correct, and I actually strongly disagree with Aurelien's claim here. Type arguments should still be supplied for:1. Start-of-line contexts for field and local method variable declarations: List<String> accounts = null;2. Parameters defined in method/constructor declarations: private void validate(List<String> accounts) {Retaining the behavior for #1 still breaks static void method invocations on generic classes, but this case is rare and already mitigated satisfactorily.As for "new List<String>()", I'd argue even that should rarely require the full type definition due to Java 7 inference.My suggestion: Remove the invalid type completion in the following three scenarios:1. Immediately following an assignment operator2. Parameter value in a method invocation3. Parameter value in a constructor invocationThis would eliminate 99% of my pain with this issue.***has been marked as a duplicate of this bug. ***Jeremy sums up pretty good the problem!Noopur, do you think it would be possible to implement his idea?	9.0
id=195674	REOPENED	JDT	UI	3.3	PC Windows XP	P3 normal	JDT-UI-Inbox	2007-07-06 12:56 EDT by	Brad Reynolds	2008-05-29 12:20 EDT (	3 users	If I create a basic JUnit4 test and attempt to run it as a JUnit Plugin Test no methods are found. The same test will run fine as a normal JUnit Test.Steps to reproduce:1. Create a new project.2. Create a new JUnit Class (select to add the JUnit4 dependencies in the wizard).3. Create a method with the Test annotation.4. Set the application in the run configuration to "[No Application] - Headless Mode". (the test runner is JUnit 4)5. Run the test as a JUnit Plugin Test.My test class:package test;import org.junit.Test;public class MyTestCase { @Test public void run() { }}This will result in:java.lang.Exception: No runnable methods at org.junit.internal.runners.TestClassMethodsRunner.run(TestClassMethodsRunner.java:33) at org.junit.internal.runners.TestClassRunner$1.runUnprotected(TestClassRunner.java:42) at org.junit.internal.runners.BeforeAndAfterRunner.runProtected(BeforeAndAfterRunner.java:34) at org.junit.internal.runners.TestClassRunner.run(TestClassRunner.java:52) at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:38) at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38) at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:460) at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:673) at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:386) at org.eclipse.pde.internal.junit.runtime.RemotePluginTestRunner.main(RemotePluginTestRunner.java:58) at org.eclipse.pde.internal.junit.runtime.CoreTestApplication.run(CoreTestApplication.java:24) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:585) at org.eclipse.equinox.internal.app.EclipseAppContainer.callMethod(EclipseAppContainer.java:533) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:155) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:585) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:504) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:443) at org.eclipse.equinox.launcher.Main.run(Main.java:1169) at org.eclipse.equinox.launcher.Main.main(Main.java:1144)	Move to JDT/UI(Frederic said he couldn't reproduce a search issue here)Is your project a plug-in?If yes, add org.junit4 as plug-in dependency (adding the container doesn't work)Make sure that your plugin has J2SE 1.5 set as execution environmentIf no, don't use the 'JUnit Plug-In Test' runner, but the 'JUnit Test' runner.Please reopen the bug if this wasn't the problem.(In reply to)This was the issue. Why isn't this handled for me when I I create a new test class and it sets up the project to use JUnit4?PDE sits on top of Junit. The JUnit wizard doesn't know of PDE and PDE projects.It is planed to fix this with a new extension point, where adding the dependency can be provided by PDE.(In reply to)Thanks. Do you have a bug number for this?that'sVersion: 3.3.2Build id: M20080221-1800I'm using JUnit (4) Plug-in Test Fragments. The test in one of my fragments runs as expected, while another fails consistently with "No runnable methods" -- stack trace below. The code for the one that fails is included below, as well.I stepped through the org.eclipse.jdt code, leading up to the exception. I saw that the methods, but all of them were missing their respective annotations. So, for all annotation types, org.junit.internal.runners.TestIntrospector.getTestMethods() returned an empty 'results' list.In both fragments -- the one whose tests run, and the one whose tests don't run -- the following is declared in MANIFEST.MF:o org.junit4 is in the Require-Bundle list.o Bundle-RequiredExecutionEnvironment: J2SE-1.5Any ideas as to what might be wrong?=====import org.junit.After;import org.junit.Assert;import org.junit.Before;import org.junit.BeforeClass;import org.junit.Test;public class TestLayout2Setup { @BeforeClass public static void setUpTestClass() { System.out.println("...setUpTestClass()..."); } @Before public void setUpTest() { System.out.println("...setUpTest()..."); } @After public void tearDownTest() { System.out.println("...tearDownTest()..."); } @Test public void testSetLayout2() { System.out.println("...testSetLayout2()..."); Assert.assertEquals("a", "a"); }}=====java.lang.Exception: No runnable methods at org.junit.internal.runners.TestClassMethodsRunner.run(TestClassMethodsRunner.java:33) at org.junit.internal.runners.TestClassRunner$1.runUnprotected(TestClassRunner.java:42) at org.junit.internal.runners.BeforeAndAfterRunner.runProtected(BeforeAndAfterRunner.java:34) at org.junit.internal.runners.TestClassRunner.run(TestClassRunner.java:52) at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:38) at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38) at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:460) at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:673) at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:386) at org.eclipse.pde.internal.junit.runtime.RemotePluginTestRunner.main(RemotePluginTestRunner.java:58) at org.eclipse.pde.internal.junit.runtime.CoreTestApplication.run(CoreTestApplication.java:24) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:585) at org.eclipse.equinox.internal.app.EclipseAppContainer.callMethod(EclipseAppContainer.java:572) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:171) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:106) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:76) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:363) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:176) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:585) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:508) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:447) at org.eclipse.equinox.launcher.Main.run(Main.java:1173) at org.eclipse.equinox.launcher.Main.main(Main.java:1148)reopen.I can't reproduce the problem with given code. Can you maybe attach a more compete example (with the fragment).If you debug into the code of TestIntrospector.getTestMethods(), are the annotations discovered? Can you check in the debugger what method.getDeclaredAnnotations returns?(In reply to)Thx, Martin, for the quick response.Stepping into TestIntrospector.getTestMethods()......w/ param annotationClass=Class<T>(org.junit.Test);...first iteration of outer for-loop -- eachClass=Class<T>(TestLayout2Setup);...after the execution of eachClass.getDeclaredMethods() -- line 26...inspecting 'methods' array showed that 'declaredAnnotations' was null for all 4 elements in the array. I'll try to pare down the fragment before attaching it here.CreatedTest fragment, w/ the test that fails to run.CreatedLaunch config of the test in question.I tried to reproduce with the fragment you provided. After some struggles to set it up (and) the fragment compiled without errors. I also was able to execute the test without any problems.If method.getDeclaredAnnotations() doesn't return any annotation, there must be either a compile problem, or a VM problem.Can you make sure to rebuild all class files and make sure that there are no compile errors. Philippe, do you have ab idea why it can happen that annotations are not available in reflection?(In reply to)I expected as much :( ...since I've seen JUnit4 tests, in other fragments, run as intended. I suspect this has to do with dependencies upstream, but am not sure which, or why that would be so.Some background: Tests written in JUnit3 were failing to run, investigating which led me to discover that Eclipse 3.3 defaults to the JUnit4 test runner, and that JUnit4 has a subtle backwards compatibility gap (the AllTests class of JUnit3 must be annotated with @RunWith). I also found that some JUnit3 tests ran OK with the Eclipse JUnit4 runner, but not with its JUnit3 runner. I concluded that it would be best to eliminate JUnit3 from the picture. I believe I've done this for the test/s in question. However, some upstream bundles still have JUnit3 test code, and thus a dependency on org.junit (3.x); these tests have no relation with the test/s in question, so the upstream JUnit3 dependency shouldn't come into play, but maybe it does...I am stumped. Any insight would be welcome.I don't see any compile errors.	14.0
id=208862	REOPENED	JDT	UI	3.3	All All	P3 enhancement	JDT-UI-Inbox	2007-11-06 04:46 EST by	Daniel Grob	2016-04-10 19:08 EDT (	3 users	Currently it is possible to run all tests in a project, package or source folder. Please provide a way to run all tests in a package and all sub packages. Thanx!Rationale: We use packages to organize our unit test. So the tests for a certain functionality are placed in a package and in corresponding sub packages. Now it is not possible to run all tests for a certain functionality with one launch configuration.Example:com.foo.func1.MyTestcom.foo.func1.dev.MyDevelopmentTestcom.foo.func1.integ.MyIntegrationTestcom.foo.func1.prod.MyProductionTestI want to create a launch configuration that runs all 4 tests below the func1 package.Workaround: Create an AllTests suite in com.foo.func1 but this is very error prone.	Move to JDT/UIWe recommend to use TestSuite to run multiple tests. This give you more control over what is ran and how it is run.No plans to improve the current 'run package/project' functionality.I agree that it is possible to create test suites. However this is* Very, very error prone Whenever you add a new test you have to make sure that you adapt the corresponding suite as well. We often had the case that we missed some tests because someone forgot to adapt the corresponding test suite.* Makes the possibility to structure your tests in packages somewhat obsolete (because you recommend to structure your tests by suites only and not by packages...)In our case we don't need more control. The only thing we need is the ability to run all tests in a package including its sub packages. I consider this as an important use case whereas I rate the use case to run the tests in the package without the sub packages as not very common.Could you please reconsider this feature request? Thanx!	3.0
id=205036	REOPENED	JDT	UI	3.4	PC Windows XP	P3 normal	JDT-UI-Inbox	2007-10-01 08:17 EDT by	NoName	2007-10-11 04:16 EDT (	2 users	Build ID: I20070921-0919Steps To Reproduce:1. Paste the code of the 2 java file below2. Put the cursor on '.n' in B class constructor3. Type Ctrl+14. Select change visibility of 'n' to 'default'5. The javadoc of A.n is removedpublic class A { /** Some integer */ private int n = 3;}public class B { public B(A a) { a.n = 1; }}	I can't reproduce this in I20070925-1406 (which should be the same as I20070921-0919).The Javadoc comments stays there. Can you make sure the sample is correct?Createdscreen shots of the bugI have exactly the same setup. Can you archive the project as is and attach it?CreatedArchive of the project folderHere is a zip of the project folder. Nothing special in it though.I get the correct behavior also with the zipped project. Strange.I can reproduce this when I disable 'Process Javadoc' on the Java > Compiler > Javadoc page. Did you do this?(In reply to)Yes.Shouldn't the bug be reopened ?Reopen.I recommend you to turn on the 'Process Javadoc' option. I don't know of a good reason to turn it off.(In reply to)Well i know one : processing javadoc add imports, see,, and some others.You don't like imports from Javadoc.Sorry if I ask: Why adding Javadoc then? Why writing incomplete Javadoc that can never be generated as its references can't be resolved as imports are missing?I'd rather fully qualify the references then.But of course this is not relevant for this bug which should be fixed.(In reply to)Agree, but Ctrl+Space in javadocs adds unqualified references. Should i open an engancement for asking "Add qualified references in content assist" ?(In reply to)was already opened for this issue.	12.0
id=232990	REOPENED	JDT	UI	3.4	PC Windows XP	P3 normal	JDT-UI-Inbox	2008-05-20 10:54 EDT by	Benno Baumgartner	2008-05-26 04:13 EDT (	1 user	I20080516-13331. Check-out code from the repository in CVS Watch/Edit mode (stores file in read-only mode)2. Do Refactor>Extract Class... on such a resourceIs: Refactoring fails with a fatal error: File is read-only. Also the refactoring does make the file writable.Should: Show dialog that 'A CVS edit notification is required', make the file writable and perform the refactoring, like i.e. rename does.	I tried with the pessimistic simple provider: The refactoring correctly prompted to check out before opening the dialog.I also tested with CVS Watch/Edit and didn't see a problem. The files were automatically checked out, no error dialog. Benno, if you have steps, please add them here.(In reply to)On Watch/Edit preference page I set:Configure projects to use Watch/EditEnable temporary watches on editSend a CVS edit notification to the serverAlways promptPrompt to update if out of date	3.0
id=339742	REOPENED	JDT	UI	3.7	All All	P3 enhancement	JDT-UI-Inbox	2011-03-11 13:21 EST by	Gary D. Gregory	2016-09-19 09:52 EDT (	4 users	Build Identifier: I20110127-2034The idea is allow the developer to run a unit test 10, 20, or 100 times. This is useful to find apparently random bugs.Reproducible: Always	That's not something we want to add in the UI. It's also unclear how it should behave if you run a suite multiple times: Stop after the first failure? Or continue? Or collect all failures? What about PDE JUnit tests?If necessary, this can be implemented either directly in your test, or as a reusable add-on to JUnit (see e.g.).Hi,Thank you for the pointer.No, JUnit does not stop a test case or suite class when a method fails a test. Repeating tests should not be any different.Yes, just like failures are collected now when running a test class or test suite.I now see that JUnit does support this feature through the RepeatedTest test decorator. It seems more legitimate to me now to surface this JUnit (4.x) feature in the UI.public static Test suite( ) { // run the entire test suite ten times return new RepeatedTest(new TestSuite(TestGame.class), 10);}***has been marked as a duplicate of this bug. ***From:Ideally, the JUnit launch configurations would have a checkbox "[ ] Repeat test N times:" and a text filed next to it allowing users to specify how many times the test should be repeated. Additionally to that one could add "[ ] Stop execution on first failure" checkbox, which can be used not only for the proposed case but also in general.	5.0
id=399181	REOPENED	JDT	UI	4.3	PC Mac OS X	P3 enhancement	JDT-UI-Inbox	2013-01-26 17:33 EST by	Gustavo Soares	2016-09-23 08:12 EDT (	2 users	Step 1: Create the class.package p1;public class A { private long n( int a){ return 38; } public long test(){ return n(2); }}package p2;import p1.*;public class B extends A { protected long k( int a){ return 58; }}package p2;import p1.*;public class C extends A {}Step 2: apply the rename method to rename n to k. Eclipse will show a warning: Type in its hierarchy defines a method with the same number of parameters and same parameter type names. In spite of the warning, the behavior of this program would be preserved after the transformation. This precondition seems to be too strong.	Moving to JDT/UI***has been marked as a duplicate of this bug. ***I20130122-0800 doesn't show a message in this case.(In reply to Markus Keller from)I have tried to apply this same refactoring using Eclipse 4.6 and it still shows this message.	4.0
id=399183	REOPENED	JDT	UI	4.3	PC Mac OS X	P3 enhancement	JDT-UI-Inbox	2013-01-26 17:59 EST by	Gustavo Soares	2016-09-23 08:20 EDT (	2 users	Eclipse rejects a rename class refactoring. The transformation could be performed with an additional change. Steps:1. Create the classes:package p1;public class A {}package p1;import p2.*;public class B extends A {}package p2;import p1.*;public class C extends A {}2. Apply the rename class to rename A to C. Eclipse will show an error: Another type named C is referenced in C.java. Other refactoring tools perform the following behavior-preserving transformation:package p1;public class C {}package p1;import p2.*;public class B extends C {}package p2;import p1.*;public class C extends p1.C {}	Moving to JDT/UI*** This bug has been marked as a duplicate of***(In reply to Markus Keller from)Why do you consider this bug as duplicate of? In this bug, Eclipse rejects the transformation and reports the warning message: " Another type named * is referenced in *.", while in theEclipse rejects the transformation and reports the message: "Name conflict with type *.". Therefore, for each transformation (this bug and) a different precondition was unsatisfied. In my point of view each bug is related to a different overly strong condition.	3.0
id=434881	REOPENED	JDT	UI	4.3	PC Mac OS X	P3 normal	JDT-UI-Inbox	2014-05-14 12:23 EDT by	Melina Mongiovi	2016-09-22 09:39 EDT (	1 user	Behavior Preserving Transformation is rejected.Reproducible: AlwaysSteps to Reproduce:1. Create the classespackage p1;public class A {}package p0;import p1.*;public class B extends A{ public C f = null; private long m(int a) { return 0; }}package p0;public class C extends B { protected long m(int a) { return 1; } public long test() { return new C().m(2) }}2. Apply the move method refactoring to move method m(int) from class B to class C.3. The tool does not apply the transformation and warn the following message:The visibility of method p0.B.m(int) will changed to default4. Another refactoring tool applies the same transformation and the resulting program (the program below) preserves the program behavior.package p1;public class A {}package p0;import p1.*;public class B extends A{ public C f = null;}package p0;public class C extends B { long m(B b, int a) { return 0; } protected long m(int a) { return 1; } public long test() { return new C().m(2) }}	*** This bug has been marked as a duplicate of***(In reply to Manju Mathew from)Why do you consider this bug as duplicate of? In this bug, Eclipse rejects the transformation and reports the warning message: "The visibility of method p0.B.m(int) will changed to default", while in theEclipse rejects the transformation and reports the message: "A method with * name already exists in the target type". Therefore, for each transformation (this bug and) a different precondition was unsatisfied. In my point of view each bug is related to a different overly strong condition.What are the criteria that you use to classify a bug as duplicate of another bug?	2.0
id=464439	REOPENED	JDT	UI	3.8.2	All All	P3 normal	JDT-UI-Inbox	2015-04-11 07:37 EDT by	Frank Benoit	2016-11-09 11:37 EST (	3 users	CreatedExample JARHiin this forum message i illustrated the problem:	CreatedJavaDoc OK from sourcesthis is when hoovering over a source that links to an imageCreatedJavaDoc Fail from jarWhen the JAR is used in a client project,the JavaDoc text is shown, be refering to an image not.The problem is, that the images are shown with a browser widget, which cannot access the images in a jar.The HTML is gathered here:/org.eclipse.jdt.ui/ui/org/eclipse/jdt/internal/ui/infoviews/JavadocView.javagetJavadocHtml()A solutions could be1. extract the image, write it to disk, change the reference in the <img> tag. But I think there would be more problems. Like "when to delete the files", "what about deeper nesting?" ...2. Embed the image directly as Base64 into the HTML.<img src="doc-files/sample2.gif" >would be<img src="data:image/gif;base64,R0lGODlhEAA....QQA7" >No temp files. The reference can be evaluated where the JavaDoc is gathered.So solution (2) seems better.Are there alternative ways to solve?What is the preferred way to have Base64 encoding available in that plugin?As show herethere are many ways:- adding a dependency to com.google.guave?- adding a dependency to org.apache.commons.codec?- use java6 javax.xml.bind.DatatypeConverter? not possible jdt.ui is java5- use java8 java.util.Base64? not possible jdt.ui is java5- adding a utility class into jdt.ui? << preferred ?I can start to work on a patch.New Gerrit change created:It's quite unusual to have .class files, .java files, and doc-files all together in a single JAR.In most cases, projects produce a JAR with .class files, a src.zip with source files, and a doc.zip with generated Javadoc. The doc.zip then also contains the doc-files.JDT already supports loading images from the doc.zip via the integrated help server, see org.eclipse.jdt.internal.corext.javadoc.JavaDocLocations#getBaseURL(..).For your specific case, you can just open the Properties dialog on the JavaDocExample.jar and then set the JavaDocExample.jar as its own Javadoc location (Javadoc in Archive).That would have been the solution, since jdt.ui will soon move to 1.7.(In reply to Markus Keller from)Interestingly our application hits now same issue, so it seem to be not that unusual :-).AFAIK we are at 1.8 now, so we could also use java.util.Base64Beside this extra Base64 class which we can get for free now, what speaks against the proposed patch? This seem to be small enough, but makes our life much more convenient. Any objections if I revive the patch?	6.0
id=485542	REOPENED	JDT	UI	4.5.1	All All	P3 normal	JDT-UI-Inbox	2016-01-11 07:47 EST by	Marvin Fröhlich	2016-03-18 05:37 EDT (	3 users	Preconditions:There is an overloaded method with many arguments per signature.There is a call to one of them.Now I want to check, if the call is correct and therefore show method signature highlighting. I hit CTRL+Space and a list of method signatures shows up.It is hard to know, which method signature is currently being used, if they're similar. Of course I can place the caret at one of the later parameters and hit CTRL-Space. But if the signatures differ in the last parameter only or my call is incorrect and it doesn't perfectly match, this is difficult.It would be nice, if there was a way to show method signature highlighting (CTRL+Space -> Choose -> Hit Enter), that is currently selected by the compiler by just hitting a hotkey.	I'm not sure I understand your situation: the full method call with all arguments already exists? In that case, I wouldn't think of Ctrl-space, as you don't want to insert new text.What do you mean by "my call is incorrect"? Are you speaking of a compile error, or of an invocation of a different method than you intended?Doesn't the javadoc hover serve your purpose?Or is this about visually associating formal parameter names with arguments, like it is done during completion, after selecting a method and while editing the arguments of the call in "linked mode"?(In reply to Stephan Herrmann from)Same here.Yes, the full method call already exists.Yes, it is about linked mode. And yes, I want to visually associate my arguments. Hence javadoc hover doesn't do the trick.By that "incorrect call" thing I was talking about an existing method call, that got compiler wisely incorrect for some reason. Let's say, I inserted a parameter somewhere in the original method. If the IDE is still able to guess a method signature selection, then it can help me with linked mode to check and fix my arguments.Will this be addressed?You're looking for Show Parameter Hints (Ctrl+Shift+Space), but that one is still broken for overloaded methods, see.*** This bug has been marked as a duplicate of***Sorry, no, this is not, what I am looking for. Unfortunately I cannot screenshot this.Let's say, you have a syntactically correct method call. If you place the caret before the first argument, hit CTRL+Space(, select the desired overloaded method variant) and hit Enter, then you get into a mode, where the argument (with type) with the caret on it is highlighted. I want to get into this mode. I think, this is not exactly linked mode, but something similar.If you're browsing a read-only class (binary view), you cannot start this mode, because eclipse assumes, you want to start editing, which might not be true.If the method call is wrong and cannot be compiled for what ever reason, eclipse still tries to do a best match and could still allow to start this mode for debugging reasons.I hope, this explains better, what I am looking for. Please remove the "duplicate of" for 70631. This is not true.	6.0
id=446203	REOPENED	JDT	UI	4.4	All All	P3 normal	JDT-UI-Inbox	2014-10-07 14:09 EDT by	EPP Error Reports	2016-04-08 08:13 EDT (	8 users	Hello committers,we received a new error report for Eclipse 4.4.1.M20140925-0400.General Information: anonymous-id: 296de9fd-8607-4c9b-9e75-eb0223c847a5 eclipse-build-id: 4.4.1.M20140925-0400 eclipse-product: org.eclipse.epp.package.rcp.product operating system: Windows7 6.1.0 (x86) - win32 java-runtime-version: 1.8.0_11-b12The following plug-ins were present on the execution stack (*): 1. org.eclipse.core.databinding.observable_1.4.1.v20140210-1835 2. org.eclipse.core.databinding_1.4.2.v20140729-1044 3. org.eclipse.core.runtime_3.10.0.v20140318-2214 4. org.eclipse.e4.ui.services_1.1.0.v20140328-1925 5. org.eclipse.e4.ui.workbench_1.2.1.v20140901-1244 6. org.eclipse.e4.ui.workbench.swt_0.12.100.v20140530-1436 7. org.eclipse.emf.common_2.10.1.v20140901-1043 8. org.eclipse.equinox.app_1.3.200.v20130910-1609 9. org.eclipse.equinox.event_1.3.100.v20140115-1647 10. org.eclipse.equinox.launcher_1.3.0.v20140415-2008 11. org.eclipse.jdt.ui_3.10.1.v20140817-1500 12. org.eclipse.jdt_3.10.0.v20140925-0400 13. org.eclipse.osgi_3.10.1.v20140909-1633 14. org.eclipse.swt_3.103.1.v20140903-1938 15. org.eclipse.ui_3.106.0.v20140812-1751 16. org.eclipse.ui.ide.application_1.0.500.v20140514-2033 17. org.eclipse.ui.ide_3.10.1.v20140828-0944Error Status: code: 2 plugin: org.eclipse.ui.workbench_3.106.1.v20140827-1737 message: Problems occurred when invoking code from plug-in: "org.eclipse.ui.workbench". fingerprint: e462692a exception class: org.eclipse.swt.SWTException exception message: Widget is disposed number of children: 0 org.eclipse.swt.SWTException: Widget is disposed at org.eclipse.swt.SWT.error(SWT.java:4441) at org.eclipse.swt.SWT.error(SWT.java:4356) at org.eclipse.swt.SWT.error(SWT.java:4327) at org.eclipse.swt.widgets.Widget.error(Widget.java:476) at org.eclipse.swt.widgets.Widget.checkWidget(Widget.java:348) at org.eclipse.swt.widgets.Composite.getChildren(Composite.java:451) at org.eclipse.jdt.internal.ui.javaeditor.JavaEditor.showBreadcrumb(JavaEditor.java:1992) at org.eclipse.jdt.internal.ui.javaeditor.JavaEditor.handlePreferenceStoreChanged(JavaEditor.java:2904) at org.eclipse.ui.texteditor.AbstractTextEditor$PropertyChangeListener.propertyChange(AbstractTextEditor.java:715) at org.eclipse.ui.texteditor.ChainedPreferenceStore.firePropertyChangeEvent(ChainedPreferenceStore.java:164) at org.eclipse.ui.texteditor.ChainedPreferenceStore.handlePropertyChangeEvent(ChainedPreferenceStore.java:431) at org.eclipse.ui.texteditor.ChainedPreferenceStore.access$0(ChainedPreferenceStore.java:408) at org.eclipse.ui.texteditor.ChainedPreferenceStore$PropertyChangeListener.propertyChange(ChainedPreferenceStore.java:69) at org.eclipse.ui.preferences.ScopedPreferenceStore$3.run(ScopedPreferenceStore.java:382) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.preferences.ScopedPreferenceStore.firePropertyChangeEvent(ScopedPreferenceStore.java:378) at org.eclipse.jdt.internal.ui.javaeditor.ToggleBreadcrumbAction.perspectiveActivated(ToggleBreadcrumbAction.java:133) at org.eclipse.ui.internal.PerspectiveListenerList$1.run(PerspectiveListenerList.java:75) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.core.runtime.Platform.run(Platform.java:867) at org.eclipse.ui.internal.PerspectiveListenerList.fireEvent(PerspectiveListenerList.java:58) at org.eclipse.ui.internal.PerspectiveListenerList.firePerspectiveActivated(PerspectiveListenerList.java:72) at org.eclipse.ui.internal.WorkbenchWindow.firePerspectiveActivated(WorkbenchWindow.java:1683) at org.eclipse.ui.internal.WorkbenchPage$4.handleEvent(WorkbenchPage.java:2958) at org.eclipse.e4.ui.services.internal.events.UIEventHandler$1.run(UIEventHandler.java:40) at org.eclipse.swt.widgets.Synchronizer.syncExec(Synchronizer.java:187) at org.eclipse.ui.internal.UISynchronizer.syncExec(UISynchronizer.java:156) at org.eclipse.swt.widgets.Display.syncExec(Display.java:4734) at org.eclipse.e4.ui.internal.workbench.swt.E4Application$1.syncExec(E4Application.java:218) at org.eclipse.e4.ui.services.internal.events.UIEventHandler.handleEvent(UIEventHandler.java:36) at org.eclipse.equinox.internal.event.EventHandlerWrapper.handleEvent(EventHandlerWrapper.java:197) at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:197) at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:1) at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:230) at org.eclipse.osgi.framework.eventmgr.ListenerQueue.dispatchEventSynchronous(ListenerQueue.java:148) at org.eclipse.equinox.internal.event.EventAdminImpl.dispatchEvent(EventAdminImpl.java:135) at org.eclipse.equinox.internal.event.EventAdminImpl.sendEvent(EventAdminImpl.java:78) at org.eclipse.equinox.internal.event.EventComponent.sendEvent(EventComponent.java:39) at org.eclipse.e4.ui.services.internal.events.EventBroker.send(EventBroker.java:81) at org.eclipse.e4.ui.internal.workbench.UIEventPublisher.notifyChanged(UIEventPublisher.java:59) at org.eclipse.emf.common.notify.impl.BasicNotifierImpl.eNotify(BasicNotifierImpl.java:374) at org.eclipse.e4.ui.model.application.ui.advanced.impl.PerspectiveStackImpl.setSelectedElement(PerspectiveStackImpl.java:135) at org.eclipse.e4.ui.model.application.ui.advanced.impl.PerspectiveStackImpl.setSelectedElement(PerspectiveStackImpl.java:1) at org.eclipse.e4.ui.workbench.addons.perspectiveswitcher.PerspectiveSwitcher$16.widgetSelected(PerspectiveSwitcher.java:622) at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:248) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4353) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1061) at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4172) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3761) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1151) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1032) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:148) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:636) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:579) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:135) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:380) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:235) at sun.reflect.NativeMethodAccessorImpl.invoke0(null:-2) at sun.reflect.NativeMethodAccessorImpl.invoke(null:-1) at sun.reflect.DelegatingMethodAccessorImpl.invoke(null:-1) at java.lang.reflect.Method.invoke(null:-1) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:648) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:603) at org.eclipse.equinox.launcher.Main.run(Main.java:1465) Messages, stacktraces, and nested status objects may be shortened. Please visitfor the complete error log.Some general information and guidelines about how to use this bug report:1. Feel free to move this bug to your own product and components. Please note that this bug is only accessible to Eclipse committers. If you move this bug please make sure that it's still in the "Security Advisor" group.2. The bug contents of the fields status, resolution, keywords, and whitelist are presented to reporters. If you needs more information, please set the keyword "needinfo". This will trigger a specialized dialog asking the user to provide further details.3. Use the following resolutions for the following situations: * CLOSED / FIXED: This bug has been fixed. Please provide additional information in the whiteboard field. * CLOSED / WORKSFORME: Use this resolution if you can't reproduce this issue and request further information. Please use the whiteboard text to specify more details what a user should provide and how. * CLOSED / INVALID: Use this resolution if the reported problem is a 'user-configuration' problem. Please consider giving hints how to fix these issues in the whiteboard field. * CLOSED / NOT ECLIPSE: Use this if the problem is caused by another plugin not developed at Eclipse.org * CLOSED / MOVED: If this bug has been moved else where. Please provide more information (e.g. a link) in the whiteboard field.4. Please remember that only committers can view and comment on this bug. You may, however, manually add the reporting user to the bug's cc list. But keep in mind that the report may contains sensitive information.5. If you are missing a feature, please file a enhancement request here:Thank you for your assistance.Your friendly error-reports-inbox.--* Note: The list of present bundles and their respective versions was calculated by package naming heuristics. This may or may not reflect reality.	This one might be tricky to reproduce but is well localized I think. Sending to JDT UI for comment.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***I don't see how this could happen. We'd need steps to reproduce or a least some more information. E.g.:- Do you work with multiple windows?- In which perspectives do you have breadcrumbs enabled? See the "Toggle Breadcrumb" item in the toolbar (with the black triangle that points rightwards).- Does it happen after you had trouble opening a Java editor?- Are there other entries in the log around the same time?- Do you work with multiple windows?I have in the past. Sometimes I want to view two sources fullscreen, I have two screens, so I pull a source from the editor area using the tab with the filename and drag it to the other screen.- In which perspectives do you have breadcrumbs enabled? See the "Toggle Breadcrumb" item in the toolbar (with the black triangle that points rightwards).Breadcrumb is enabled in "Java", but not "Debug" or "Synchronize". I get the error switching from or to any breadcrumb enabled perspective. Switching between "Debug" and "Synchronize" does not create the error.I enabled the breadcrumb in Debug perspective and it gave the widget is disposed error straight away.- Does it happen after you had trouble opening a Java editor?No, it works for a while when Eclipse is opened fresh, but after some time something happens which then means the error occurs every single time I switch perspectives.- Are there other entries in the log around the same time?I can't see any.Are there any files from the workspace (.metadata) that might help with understanding the scenario?(In reply to Stuart Stephen from)Only the .log file. Look out for entries that contain "dispose".The problem is that an editor didn't get closed properly, so it still listens to property changes (like enabling/disabling the breadcrumb), although its widget has already been disposed. That shouldn't ever happen.I've added better logging, so that we at least know which editor is causing trouble:Starting from the next I-build, it will write this to the log:org.eclipse.swt.SWTException: Widget is disposed. Editor not properly disposed; please report scenario to <>. Editor input: [Working copy] Try18.java [in xy [in src [in zz1.8]]]***has been marked as a duplicate of this bug. ***I encounter the issue. it happens when swithcing from perspective. here is the new log:!ENTRY org.eclipse.ui.workbench 4 2 2016-01-29 14:39:45.470!MESSAGE Problems occurred when invoking code from plug-in: "org.eclipse.ui.workbench".!STACK 0org.eclipse.swt.SWTException: Widget is disposed at org.eclipse.swt.SWT.error(SWT.java:4491) at org.eclipse.swt.SWT.error(SWT.java:4406) at org.eclipse.swt.SWT.error(SWT.java:4377) at org.eclipse.swt.widgets.Widget.error(Widget.java:482) at org.eclipse.swt.widgets.Widget.checkWidget(Widget.java:354) at org.eclipse.swt.widgets.Control.getLayoutData(Control.java:1395) at org.eclipse.jdt.internal.ui.javaeditor.JavaEditor.hideBreadcrumb(JavaEditor.java:2020) at org.eclipse.jdt.internal.ui.javaeditor.JavaEditor.handlePreferenceStoreChanged(JavaEditor.java:2912) at org.eclipse.ui.texteditor.AbstractTextEditor$PropertyChangeListener.propertyChange(AbstractTextEditor.java:715) at org.eclipse.ui.texteditor.ChainedPreferenceStore.firePropertyChangeEvent(ChainedPreferenceStore.java:164) at org.eclipse.ui.texteditor.ChainedPreferenceStore.handlePropertyChangeEvent(ChainedPreferenceStore.java:431) at org.eclipse.ui.texteditor.ChainedPreferenceStore.access$0(ChainedPreferenceStore.java:408) at org.eclipse.ui.texteditor.ChainedPreferenceStore$PropertyChangeListener.propertyChange(ChainedPreferenceStore.java:69) at org.eclipse.ui.preferences.ScopedPreferenceStore$3.run(ScopedPreferenceStore.java:351) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.preferences.ScopedPreferenceStore.firePropertyChangeEvent(ScopedPreferenceStore.java:347) at org.eclipse.jdt.internal.ui.javaeditor.ToggleBreadcrumbAction.perspectiveActivated(ToggleBreadcrumbAction.java:133) at org.eclipse.ui.internal.PerspectiveListenerList$1.run(PerspectiveListenerList.java:75) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.internal.PerspectiveListenerList.fireEvent(PerspectiveListenerList.java:58) at org.eclipse.ui.internal.PerspectiveListenerList.firePerspectiveActivated(PerspectiveListenerList.java:72) at org.eclipse.ui.internal.WorkbenchWindow.firePerspectiveActivated(WorkbenchWindow.java:1694) at org.eclipse.ui.internal.WorkbenchPage$4.handleEvent(WorkbenchPage.java:2982) at org.eclipse.e4.ui.services.internal.events.UIEventHandler$1.run(UIEventHandler.java:40) at org.eclipse.swt.widgets.Synchronizer.syncExec(Synchronizer.java:186) at org.eclipse.ui.internal.UISynchronizer.syncExec(UISynchronizer.java:145) at org.eclipse.swt.widgets.Display.syncExec(Display.java:4761) at org.eclipse.e4.ui.internal.workbench.swt.E4Application$1.syncExec(E4Application.java:211) at org.eclipse.e4.ui.services.internal.events.UIEventHandler.handleEvent(UIEventHandler.java:36) at org.eclipse.equinox.internal.event.EventHandlerWrapper.handleEvent(EventHandlerWrapper.java:197) at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:197) at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:1) at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:230) at org.eclipse.osgi.framework.eventmgr.ListenerQueue.dispatchEventSynchronous(ListenerQueue.java:148) at org.eclipse.equinox.internal.event.EventAdminImpl.dispatchEvent(EventAdminImpl.java:135) at org.eclipse.equinox.internal.event.EventAdminImpl.sendEvent(EventAdminImpl.java:78) at org.eclipse.equinox.internal.event.EventComponent.sendEvent(EventComponent.java:39) at org.eclipse.e4.ui.services.internal.events.EventBroker.send(EventBroker.java:85) at org.eclipse.e4.ui.internal.workbench.UIEventPublisher.notifyChanged(UIEventPublisher.java:59) at org.eclipse.emf.common.notify.impl.BasicNotifierImpl.eNotify(BasicNotifierImpl.java:374) at org.eclipse.e4.ui.model.application.ui.advanced.impl.PerspectiveStackImpl.setSelectedElement(PerspectiveStackImpl.java:135) at org.eclipse.e4.ui.model.application.ui.advanced.impl.PerspectiveStackImpl.setSelectedElement(PerspectiveStackImpl.java:1) at org.eclipse.ui.internal.WorkbenchPage.setPerspective(WorkbenchPage.java:4010) at org.eclipse.ui.internal.Workbench.activate(Workbench.java:3084) at org.eclipse.ui.internal.Workbench.showPerspective(Workbench.java:3106) at org.eclipse.ui.internal.Workbench.showPerspective(Workbench.java:3073) at org.eclipse.debug.internal.ui.launchConfigurations.PerspectiveManager.switchToPerspective(PerspectiveManager.java:390) at org.eclipse.debug.internal.ui.launchConfigurations.PerspectiveManager$4.runInUIThread(PerspectiveManager.java:471) at org.eclipse.debug.internal.ui.launchConfigurations.PerspectiveManager$MyUIJob$1.run(PerspectiveManager.java:229) at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35) at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135) at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4155) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3772) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$4.run(PartRenderingEngine.java:1127) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1018) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:156) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:654) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:598) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:139) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:380) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:235) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:669) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:608) at org.eclipse.equinox.launcher.Main.run(Main.java:1515) at org.eclipse.equinox.launcher.Main.main(Main.java:1488)!ENTRY org.eclipse.ui.workbench 4 2 2016-01-29 14:39:45.504!MESSAGE Problems occurred when invoking code from plug-in: "org.eclipse.ui.workbench".!STACK 0org.eclipse.swt.SWTException: Widget is disposed at org.eclipse.swt.SWT.error(SWT.java:4491) at org.eclipse.swt.SWT.error(SWT.java:4406) at org.eclipse.swt.SWT.error(SWT.java:4377) at org.eclipse.swt.widgets.Widget.error(Widget.java:482) at org.eclipse.swt.widgets.Widget.checkWidget(Widget.java:354) at org.eclipse.swt.widgets.Control.getLayoutData(Control.java:1395) at org.eclipse.jdt.internal.ui.javaeditor.JavaEditor.hideBreadcrumb(JavaEditor.java:2020) at org.eclipse.jdt.internal.ui.javaeditor.JavaEditor.handlePreferenceStoreChanged(JavaEditor.java:2912) at org.eclipse.ui.texteditor.AbstractTextEditor$PropertyChangeListener.propertyChange(AbstractTextEditor.java:715) at org.eclipse.ui.texteditor.ChainedPreferenceStore.firePropertyChangeEvent(ChainedPreferenceStore.java:164) at org.eclipse.ui.texteditor.ChainedPreferenceStore.handlePropertyChangeEvent(ChainedPreferenceStore.java:431) at org.eclipse.ui.texteditor.ChainedPreferenceStore.access$0(ChainedPreferenceStore.java:408) at org.eclipse.ui.texteditor.ChainedPreferenceStore$PropertyChangeListener.propertyChange(ChainedPreferenceStore.java:69) at org.eclipse.ui.preferences.ScopedPreferenceStore$3.run(ScopedPreferenceStore.java:351) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.preferences.ScopedPreferenceStore.firePropertyChangeEvent(ScopedPreferenceStore.java:347) at org.eclipse.jdt.internal.ui.javaeditor.ToggleBreadcrumbAction.perspectiveActivated(ToggleBreadcrumbAction.java:133) at org.eclipse.ui.internal.PerspectiveListenerList$1.run(PerspectiveListenerList.java:75) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.internal.PerspectiveListenerList.fireEvent(PerspectiveListenerList.java:58) at org.eclipse.ui.internal.PerspectiveListenerList.firePerspectiveActivated(PerspectiveListenerList.java:72) at org.eclipse.ui.internal.WorkbenchWindow.firePerspectiveActivated(WorkbenchWindow.java:1694) at org.eclipse.ui.internal.WorkbenchPage$4.handleEvent(WorkbenchPage.java:2982) at org.eclipse.e4.ui.services.internal.events.UIEventHandler$1.run(UIEventHandler.java:40) at org.eclipse.swt.widgets.Synchronizer.syncExec(Synchronizer.java:186) at org.eclipse.ui.internal.UISynchronizer.syncExec(UISynchronizer.java:145) at org.eclipse.swt.widgets.Display.syncExec(Display.java:4761) at org.eclipse.e4.ui.internal.workbench.swt.E4Application$1.syncExec(E4Application.java:211) at org.eclipse.e4.ui.services.internal.events.UIEventHandler.handleEvent(UIEventHandler.java:36) at org.eclipse.equinox.internal.event.EventHandlerWrapper.handleEvent(EventHandlerWrapper.java:197) at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:197) at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:1) at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:230) at org.eclipse.osgi.framework.eventmgr.ListenerQueue.dispatchEventSynchronous(ListenerQueue.java:148) at org.eclipse.equinox.internal.event.EventAdminImpl.dispatchEvent(EventAdminImpl.java:135) at org.eclipse.equinox.internal.event.EventAdminImpl.sendEvent(EventAdminImpl.java:78) at org.eclipse.equinox.internal.event.EventComponent.sendEvent(EventComponent.java:39) at org.eclipse.e4.ui.services.internal.events.EventBroker.send(EventBroker.java:85) at org.eclipse.e4.ui.internal.workbench.UIEventPublisher.notifyChanged(UIEventPublisher.java:59) at org.eclipse.emf.common.notify.impl.BasicNotifierImpl.eNotify(BasicNotifierImpl.java:374) at org.eclipse.e4.ui.model.application.ui.advanced.impl.PerspectiveStackImpl.setSelectedElement(PerspectiveStackImpl.java:135) at org.eclipse.e4.ui.model.application.ui.advanced.impl.PerspectiveStackImpl.setSelectedElement(PerspectiveStackImpl.java:1) at org.eclipse.ui.internal.WorkbenchPage.setPerspective(WorkbenchPage.java:4010) at org.eclipse.ui.internal.Workbench.activate(Workbench.java:3084) at org.eclipse.ui.internal.Workbench.showPerspective(Workbench.java:3106) at org.eclipse.ui.internal.Workbench.showPerspective(Workbench.java:3073) at org.eclipse.debug.internal.ui.launchConfigurations.PerspectiveManager.switchToPerspective(PerspectiveManager.java:390) at org.eclipse.debug.internal.ui.launchConfigurations.PerspectiveManager$4.runInUIThread(PerspectiveManager.java:471) at org.eclipse.debug.internal.ui.launchConfigurations.PerspectiveManager$MyUIJob$1.run(PerspectiveManager.java:229) at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35) at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135) at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4155) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3772) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$4.run(PartRenderingEngine.java:1127) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1018) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:156) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:654) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:598) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:139) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:380) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:235) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:669) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:608) at org.eclipse.equinox.launcher.Main.run(Main.java:1515) at org.eclipse.equinox.launcher.Main.main(Main.java:1488)!ENTRY org.eclipse.ui.workbench 4 2 2016-01-29 14:40:34.252!MESSAGE Problems occurred when invoking code from plug-in: "org.eclipse.ui.workbench".!STACK 0org.eclipse.swt.SWTException: Widget is disposed. Editor not properly disposed; please report scenario to <>. Editor input: MethodRoadie.class (not open) [in org.junit.internal.runners [in C:\ws\FuseTooling\.metadata\.plugins\org.eclipse.pde.core\.external_libraries\org.junit_4.12.0.v201504281640\junit.jar]] at org.eclipse.swt.SWT.error(SWT.java:4491) at org.eclipse.jdt.internal.ui.javaeditor.JavaEditor.showBreadcrumb(JavaEditor.java:1994) at org.eclipse.jdt.internal.ui.javaeditor.JavaEditor.handlePreferenceStoreChanged(JavaEditor.java:2910) at org.eclipse.ui.texteditor.AbstractTextEditor$PropertyChangeListener.propertyChange(AbstractTextEditor.java:715) at org.eclipse.ui.texteditor.ChainedPreferenceStore.firePropertyChangeEvent(ChainedPreferenceStore.java:164) at org.eclipse.ui.texteditor.ChainedPreferenceStore.handlePropertyChangeEvent(ChainedPreferenceStore.java:431) at org.eclipse.ui.texteditor.ChainedPreferenceStore.access$0(ChainedPreferenceStore.java:408) at org.eclipse.ui.texteditor.ChainedPreferenceStore$PropertyChangeListener.propertyChange(ChainedPreferenceStore.java:69) at org.eclipse.ui.preferences.ScopedPreferenceStore$3.run(ScopedPreferenceStore.java:351) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.preferences.ScopedPreferenceStore.firePropertyChangeEvent(ScopedPreferenceStore.java:347) at org.eclipse.jdt.internal.ui.javaeditor.ToggleBreadcrumbAction.perspectiveActivated(ToggleBreadcrumbAction.java:133) at org.eclipse.ui.internal.PerspectiveListenerList$1.run(PerspectiveListenerList.java:75) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.internal.PerspectiveListenerList.fireEvent(PerspectiveListenerList.java:58) at org.eclipse.ui.internal.PerspectiveListenerList.firePerspectiveActivated(PerspectiveListenerList.java:72) at org.eclipse.ui.internal.WorkbenchWindow.firePerspectiveActivated(WorkbenchWindow.java:1694) at org.eclipse.ui.internal.WorkbenchPage$4.handleEvent(WorkbenchPage.java:2982) at org.eclipse.e4.ui.services.internal.events.UIEventHandler$1.run(UIEventHandler.java:40) at org.eclipse.swt.widgets.Synchronizer.syncExec(Synchronizer.java:186) at org.eclipse.ui.internal.UISynchronizer.syncExec(UISynchronizer.java:145) at org.eclipse.swt.widgets.Display.syncExec(Display.java:4761) at org.eclipse.e4.ui.internal.workbench.swt.E4Application$1.syncExec(E4Application.java:211) at org.eclipse.e4.ui.services.internal.events.UIEventHandler.handleEvent(UIEventHandler.java:36) at org.eclipse.equinox.internal.event.EventHandlerWrapper.handleEvent(EventHandlerWrapper.java:197) at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:197) at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:1) at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:230) at org.eclipse.osgi.framework.eventmgr.ListenerQueue.dispatchEventSynchronous(ListenerQueue.java:148) at org.eclipse.equinox.internal.event.EventAdminImpl.dispatchEvent(EventAdminImpl.java:135) at org.eclipse.equinox.internal.event.EventAdminImpl.sendEvent(EventAdminImpl.java:78) at org.eclipse.equinox.internal.event.EventComponent.sendEvent(EventComponent.java:39) at org.eclipse.e4.ui.services.internal.events.EventBroker.send(EventBroker.java:85) at org.eclipse.e4.ui.internal.workbench.UIEventPublisher.notifyChanged(UIEventPublisher.java:59) at org.eclipse.emf.common.notify.impl.BasicNotifierImpl.eNotify(BasicNotifierImpl.java:374) at org.eclipse.e4.ui.model.application.ui.advanced.impl.PerspectiveStackImpl.setSelectedElement(PerspectiveStackImpl.java:135) at org.eclipse.e4.ui.model.application.ui.advanced.impl.PerspectiveStackImpl.setSelectedElement(PerspectiveStackImpl.java:1) at org.eclipse.e4.ui.workbench.addons.perspectiveswitcher.PerspectiveSwitcher$12.widgetSelected(PerspectiveSwitcher.java:590) at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:248) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4362) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1113) at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4180) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3769) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$4.run(PartRenderingEngine.java:1127) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1018) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:156) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:654) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:598) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:139) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:380) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:235) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:669) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:608) at org.eclipse.equinox.launcher.Main.run(Main.java:1515) at org.eclipse.equinox.launcher.Main.main(Main.java:1488)!ENTRY org.eclipse.ui.workbench 4 2 2016-01-29 14:40:34.290!MESSAGE Problems occurred when invoking code from plug-in: "org.eclipse.ui.workbench".!STACK 0org.eclipse.swt.SWTException: Widget is disposed. Editor not properly disposed; please report scenario to <>. Editor input: SchemaDocument.class [in org.apache.xmlbeans.impl.xb.xsdschema [in C:\Data\TP\org.fusesource.ide.targetplatform.target.repo-Mars\plugins\org.apache.xmlbeans_2.3.0.v201405241900.jar]] interface SchemaDocument at org.eclipse.swt.SWT.error(SWT.java:4491) at org.eclipse.jdt.internal.ui.javaeditor.JavaEditor.showBreadcrumb(JavaEditor.java:1994) at org.eclipse.jdt.internal.ui.javaeditor.JavaEditor.handlePreferenceStoreChanged(JavaEditor.java:2910) at org.eclipse.ui.texteditor.AbstractTextEditor$PropertyChangeListener.propertyChange(AbstractTextEditor.java:715) at org.eclipse.ui.texteditor.ChainedPreferenceStore.firePropertyChangeEvent(ChainedPreferenceStore.java:164) at org.eclipse.ui.texteditor.ChainedPreferenceStore.handlePropertyChangeEvent(ChainedPreferenceStore.java:431) at org.eclipse.ui.texteditor.ChainedPreferenceStore.access$0(ChainedPreferenceStore.java:408) at org.eclipse.ui.texteditor.ChainedPreferenceStore$PropertyChangeListener.propertyChange(ChainedPreferenceStore.java:69) at org.eclipse.ui.preferences.ScopedPreferenceStore$3.run(ScopedPreferenceStore.java:351) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.preferences.ScopedPreferenceStore.firePropertyChangeEvent(ScopedPreferenceStore.java:347) at org.eclipse.jdt.internal.ui.javaeditor.ToggleBreadcrumbAction.perspectiveActivated(ToggleBreadcrumbAction.java:133) at org.eclipse.ui.internal.PerspectiveListenerList$1.run(PerspectiveListenerList.java:75) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.internal.PerspectiveListenerList.fireEvent(PerspectiveListenerList.java:58) at org.eclipse.ui.internal.PerspectiveListenerList.firePerspectiveActivated(PerspectiveListenerList.java:72) at org.eclipse.ui.internal.WorkbenchWindow.firePerspectiveActivated(WorkbenchWindow.java:1694) at org.eclipse.ui.internal.WorkbenchPage$4.handleEvent(WorkbenchPage.java:2982) at org.eclipse.e4.ui.services.internal.events.UIEventHandler$1.run(UIEventHandler.java:40) at org.eclipse.swt.widgets.Synchronizer.syncExec(Synchronizer.java:186) at org.eclipse.ui.internal.UISynchronizer.syncExec(UISynchronizer.java:145) at org.eclipse.swt.widgets.Display.syncExec(Display.java:4761) at org.eclipse.e4.ui.internal.workbench.swt.E4Application$1.syncExec(E4Application.java:211) at org.eclipse.e4.ui.services.internal.events.UIEventHandler.handleEvent(UIEventHandler.java:36) at org.eclipse.equinox.internal.event.EventHandlerWrapper.handleEvent(EventHandlerWrapper.java:197) at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:197) at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:1) at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:230) at org.eclipse.osgi.framework.eventmgr.ListenerQueue.dispatchEventSynchronous(ListenerQueue.java:148) at org.eclipse.equinox.internal.event.EventAdminImpl.dispatchEvent(EventAdminImpl.java:135) at org.eclipse.equinox.internal.event.EventAdminImpl.sendEvent(EventAdminImpl.java:78) at org.eclipse.equinox.internal.event.EventComponent.sendEvent(EventComponent.java:39) at org.eclipse.e4.ui.services.internal.events.EventBroker.send(EventBroker.java:85) at org.eclipse.e4.ui.internal.workbench.UIEventPublisher.notifyChanged(UIEventPublisher.java:59) at org.eclipse.emf.common.notify.impl.BasicNotifierImpl.eNotify(BasicNotifierImpl.java:374) at org.eclipse.e4.ui.model.application.ui.advanced.impl.PerspectiveStackImpl.setSelectedElement(PerspectiveStackImpl.java:135) at org.eclipse.e4.ui.model.application.ui.advanced.impl.PerspectiveStackImpl.setSelectedElement(PerspectiveStackImpl.java:1) at org.eclipse.e4.ui.workbench.addons.perspectiveswitcher.PerspectiveSwitcher$12.widgetSelected(PerspectiveSwitcher.java:590) at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:248) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4362) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1113) at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4180) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3769) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$4.run(PartRenderingEngine.java:1127) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1018) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:156) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:654) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:598) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:139) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:380) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:235) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:669) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:608) at org.eclipse.equinox.launcher.Main.run(Main.java:1515) at org.eclipse.equinox.launcher.Main.main(Main.java:1488)I also started to encounter this issue when switching between perspectives. Please, find the details below:"Problem Occurred" dialog message:Error notifying a preference change listener. Check the log for details.Widget is disposed. Editor not properly disposed; please report scenario to <>. Editor input: CollectionUtils.class [in org.springframework.cglib.core [in /Users/bzlatanov/.m2/repository/org/springframework/spring-core/4.2.1.RELEASE/spring-core-4.2.1.RELEASE.jar]] class CollectionUtils"Event Details" dialog from "Error Log":- Message: Problems occurred when invoking code from plug-in: "org.eclipse.ui.workbench".- Session Data: eclipse.buildId=3.7.2.201511261048-RELEASE-e45 java.version=1.8.0_72 java.vendor=Oracle Corporation BootLoader constants: OS=macosx, ARCH=x86_64, WS=cocoa, NL=en_US Framework arguments: -product org.springsource.sts.ide -keyring /Users/user/.eclipse_keyring -showlocation Command-line arguments: -os macosx -ws cocoa -arch x86_64 -product org.springsource.sts.ide -keyring /Users/user/.eclipse_keyring -showlocation Created Time: 2016-02-10 17:38:13.737- Exception Stack Trace:org.eclipse.swt.SWTException: Widget is disposed. Editor not properly disposed; please report scenario to <>. Editor input: CollectionUtils.class [in org.springframework.cglib.core [in /Users/user/.m2/repository/org/springframework/spring-core/4.2.1.RELEASE/spring-core-4.2.1.RELEASE.jar]] class CollectionUtils at org.eclipse.swt.SWT.error(SWT.java:4491) at org.eclipse.jdt.internal.ui.javaeditor.JavaEditor.showBreadcrumb(JavaEditor.java:1994) at org.eclipse.jdt.internal.ui.javaeditor.JavaEditor.handlePreferenceStoreChanged(JavaEditor.java:2910) at org.eclipse.ui.texteditor.AbstractTextEditor$PropertyChangeListener.propertyChange(AbstractTextEditor.java:715) at org.eclipse.ui.texteditor.ChainedPreferenceStore.firePropertyChangeEvent(ChainedPreferenceStore.java:164) at org.eclipse.ui.texteditor.ChainedPreferenceStore.handlePropertyChangeEvent(ChainedPreferenceStore.java:431) at org.eclipse.ui.texteditor.ChainedPreferenceStore.access$0(ChainedPreferenceStore.java:408) at org.eclipse.ui.texteditor.ChainedPreferenceStore$PropertyChangeListener.propertyChange(ChainedPreferenceStore.java:69) at org.eclipse.ui.preferences.ScopedPreferenceStore$3.run(ScopedPreferenceStore.java:351) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.preferences.ScopedPreferenceStore.firePropertyChangeEvent(ScopedPreferenceStore.java:347) at org.eclipse.jdt.internal.ui.javaeditor.ToggleBreadcrumbAction.perspectiveActivated(ToggleBreadcrumbAction.java:133) at org.eclipse.ui.internal.PerspectiveListenerList$1.run(PerspectiveListenerList.java:75) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.internal.PerspectiveListenerList.fireEvent(PerspectiveListenerList.java:58) at org.eclipse.ui.internal.PerspectiveListenerList.firePerspectiveActivated(PerspectiveListenerList.java:72) at org.eclipse.ui.internal.WorkbenchWindow.firePerspectiveActivated(WorkbenchWindow.java:1694) at org.eclipse.ui.internal.WorkbenchPage$4.handleEvent(WorkbenchPage.java:2982) at org.eclipse.e4.ui.services.internal.events.UIEventHandler$1.run(UIEventHandler.java:40) at org.eclipse.swt.widgets.Synchronizer.syncExec(Synchronizer.java:186) at org.eclipse.ui.internal.UISynchronizer.syncExec(UISynchronizer.java:145) at org.eclipse.swt.widgets.Display.syncExec(Display.java:4781) at org.eclipse.e4.ui.internal.workbench.swt.E4Application$1.syncExec(E4Application.java:211) at org.eclipse.e4.ui.services.internal.events.UIEventHandler.handleEvent(UIEventHandler.java:36) at org.eclipse.equinox.internal.event.EventHandlerWrapper.handleEvent(EventHandlerWrapper.java:197) at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:197) at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:1) at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:230) at org.eclipse.osgi.framework.eventmgr.ListenerQueue.dispatchEventSynchronous(ListenerQueue.java:148) at org.eclipse.equinox.internal.event.EventAdminImpl.dispatchEvent(EventAdminImpl.java:135) at org.eclipse.equinox.internal.event.EventAdminImpl.sendEvent(EventAdminImpl.java:78) at org.eclipse.equinox.internal.event.EventComponent.sendEvent(EventComponent.java:39) at org.eclipse.e4.ui.services.internal.events.EventBroker.send(EventBroker.java:85) at org.eclipse.e4.ui.internal.workbench.UIEventPublisher.notifyChanged(UIEventPublisher.java:59) at org.eclipse.emf.common.notify.impl.BasicNotifierImpl.eNotify(BasicNotifierImpl.java:374) at org.eclipse.e4.ui.model.application.ui.advanced.impl.PerspectiveStackImpl.setSelectedElement(PerspectiveStackImpl.java:135) at org.eclipse.e4.ui.model.application.ui.advanced.impl.PerspectiveStackImpl.setSelectedElement(PerspectiveStackImpl.java:1) at org.eclipse.e4.ui.workbench.addons.perspectiveswitcher.PerspectiveSwitcher$12.widgetSelected(PerspectiveSwitcher.java:590) at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:248) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4230) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1491) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1514) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1499) at org.eclipse.swt.widgets.Widget.notifyListeners(Widget.java:1299) at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4072) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3698) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$4.run(PartRenderingEngine.java:1127) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1018) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:156) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:654) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:598) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:139) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:380) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:235) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:669) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:608) at org.eclipse.equinox.launcher.Main.run(Main.java:1515)Can you provide steps to reproduce it? Switching perspectives usingdoes not give me the error.(In reply to Dani Megert from)I started experiencing this issue out of the blue on the 16.02.2016. Ever since it's constantly showing up when I switch between Debug and Java perspectives. In between those, I sometimes get a widget dispose failures with nothing more but a "NullPointerException" message. I'm actually using STS 3.7.2 and this error shows up while I'm debugging Spring MVC applications. I'll have more time for this during the weekend and will do my best to provide you with solid steps to reproduce.Encountered the same issue in Eclipse 4.5.2. Each time I've switched between perspectives - if exactly one of them (either the "switched from", or the "switched to") had an editor window with breadcrumb switched on - I've got two instances of this error, for two different classes (javax.faces.model.SelectItem and javax.faces.component.UICommand, stacktraces below). What those classes have in common is that I've had them opened at some point with JD eclipse plugin. Also, though I'm not 100% sure, eclipse might've closed unexpectedly when those two were open, due to unrelated reasons. Unfortunately, the problem had since disappeared as suddenly as it appeared and I'm no longer able to reproduce it.eclipse.buildId=4.5.2.M20160212-1500java.version=1.8.0_66-internaljava.vendor=Oracle CorporationBootLoader constants: OS=linux, ARCH=x86_64, WS=gtk, NL=en_USFramework arguments: -showlocation -product org.eclipse.epp.package.jee.productCommand-line arguments: -os linux -ws gtk -arch x86_64 -showlocation -product org.eclipse.epp.package.jee.product!ENTRY org.eclipse.ui.workbench 4 2 2016-04-08 12:18:44.111!MESSAGE Problems occurred when invoking code from plug-in: "org.eclipse.ui.workbench".!STACK 0org.eclipse.swt.SWTException: Widget is disposed. Editor not properly disposed; please report scenario to <>. Editor input: SelectItem.class (not open) [in javax.faces.model [in /home/lbak/Development/jboss-6.1.0.Final/server/default/deployers/jsf.deployer/Mojarra-2.0/jsf-libs/jsf-api-2.0.3-b05.jar]] at org.eclipse.swt.SWT.error(SWT.java:4491) at org.eclipse.jdt.internal.ui.javaeditor.JavaEditor.showBreadcrumb(JavaEditor.java:1994) at org.eclipse.jdt.internal.ui.javaeditor.JavaEditor.handlePreferenceStoreChanged(JavaEditor.java:2910) at org.eclipse.ui.texteditor.AbstractTextEditor$PropertyChangeListener.propertyChange(AbstractTextEditor.java:715) at org.eclipse.ui.texteditor.ChainedPreferenceStore.firePropertyChangeEvent(ChainedPreferenceStore.java:164) at org.eclipse.ui.texteditor.ChainedPreferenceStore.handlePropertyChangeEvent(ChainedPreferenceStore.java:431) at org.eclipse.ui.texteditor.ChainedPreferenceStore.access$0(ChainedPreferenceStore.java:408) at org.eclipse.ui.texteditor.ChainedPreferenceStore$PropertyChangeListener.propertyChange(ChainedPreferenceStore.java:69) at org.eclipse.ui.preferences.ScopedPreferenceStore$3.run(ScopedPreferenceStore.java:351) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.preferences.ScopedPreferenceStore.firePropertyChangeEvent(ScopedPreferenceStore.java:347) at org.eclipse.jdt.internal.ui.javaeditor.ToggleBreadcrumbAction.perspectiveActivated(ToggleBreadcrumbAction.java:133) at org.eclipse.ui.internal.PerspectiveListenerList$1.run(PerspectiveListenerList.java:75) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.internal.PerspectiveListenerList.fireEvent(PerspectiveListenerList.java:58) at org.eclipse.ui.internal.PerspectiveListenerList.firePerspectiveActivated(PerspectiveListenerList.java:72) at org.eclipse.ui.internal.WorkbenchWindow.firePerspectiveActivated(WorkbenchWindow.java:1719) at org.eclipse.ui.internal.WorkbenchPage$4.handleEvent(WorkbenchPage.java:3000) at org.eclipse.e4.ui.services.internal.events.UIEventHandler$1.run(UIEventHandler.java:40) at org.eclipse.swt.widgets.Synchronizer.syncExec(Synchronizer.java:186) at org.eclipse.ui.internal.UISynchronizer.syncExec(UISynchronizer.java:145) at org.eclipse.swt.widgets.Display.syncExec(Display.java:4633) at org.eclipse.e4.ui.internal.workbench.swt.E4Application$1.syncExec(E4Application.java:211) at org.eclipse.e4.ui.services.internal.events.UIEventHandler.handleEvent(UIEventHandler.java:36) at org.eclipse.equinox.internal.event.EventHandlerWrapper.handleEvent(EventHandlerWrapper.java:197) at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:197) at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:1) at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:230) at org.eclipse.osgi.framework.eventmgr.ListenerQueue.dispatchEventSynchronous(ListenerQueue.java:148) at org.eclipse.equinox.internal.event.EventAdminImpl.dispatchEvent(EventAdminImpl.java:135) at org.eclipse.equinox.internal.event.EventAdminImpl.sendEvent(EventAdminImpl.java:78) at org.eclipse.equinox.internal.event.EventComponent.sendEvent(EventComponent.java:39) at org.eclipse.e4.ui.services.internal.events.EventBroker.send(EventBroker.java:85) at org.eclipse.e4.ui.internal.workbench.UIEventPublisher.notifyChanged(UIEventPublisher.java:59) at org.eclipse.emf.common.notify.impl.BasicNotifierImpl.eNotify(BasicNotifierImpl.java:374) at org.eclipse.e4.ui.model.application.ui.advanced.impl.PerspectiveStackImpl.setSelectedElement(PerspectiveStackImpl.java:135) at org.eclipse.e4.ui.model.application.ui.advanced.impl.PerspectiveStackImpl.setSelectedElement(PerspectiveStackImpl.java:1) at org.eclipse.e4.ui.workbench.addons.perspectiveswitcher.PerspectiveSwitcher$12.widgetSelected(PerspectiveSwitcher.java:590) at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:248) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4481) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1329) at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3819) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3430) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$4.run(PartRenderingEngine.java:1127) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1018) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:156) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:694) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:606) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:139) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:380) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:235) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:497) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:669) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:608) at org.eclipse.equinox.launcher.Main.run(Main.java:1515) at org.eclipse.equinox.launcher.Main.main(Main.java:1488)!ENTRY org.eclipse.ui.workbench 4 2 2016-04-08 12:18:44.125!MESSAGE Problems occurred when invoking code from plug-in: "org.eclipse.ui.workbench".!STACK 0org.eclipse.swt.SWTException: Widget is disposed. Editor not properly disposed; please report scenario to <>. Editor input: UICommand.class [in javax.faces.component [in /home/lbak/Development/jboss-6.1.0.Final/server/default/deployers/jsf.deployer/Mojarra-2.0/jsf-libs/jsf-api-2.0.3-b05.jar]] class UICommand at org.eclipse.swt.SWT.error(SWT.java:4491) at org.eclipse.jdt.internal.ui.javaeditor.JavaEditor.showBreadcrumb(JavaEditor.java:1994) at org.eclipse.jdt.internal.ui.javaeditor.JavaEditor.handlePreferenceStoreChanged(JavaEditor.java:2910) at org.eclipse.ui.texteditor.AbstractTextEditor$PropertyChangeListener.propertyChange(AbstractTextEditor.java:715) at org.eclipse.ui.texteditor.ChainedPreferenceStore.firePropertyChangeEvent(ChainedPreferenceStore.java:164) at org.eclipse.ui.texteditor.ChainedPreferenceStore.handlePropertyChangeEvent(ChainedPreferenceStore.java:431) at org.eclipse.ui.texteditor.ChainedPreferenceStore.access$0(ChainedPreferenceStore.java:408) at org.eclipse.ui.texteditor.ChainedPreferenceStore$PropertyChangeListener.propertyChange(ChainedPreferenceStore.java:69) at org.eclipse.ui.preferences.ScopedPreferenceStore$3.run(ScopedPreferenceStore.java:351) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.preferences.ScopedPreferenceStore.firePropertyChangeEvent(ScopedPreferenceStore.java:347) at org.eclipse.jdt.internal.ui.javaeditor.ToggleBreadcrumbAction.perspectiveActivated(ToggleBreadcrumbAction.java:133) at org.eclipse.ui.internal.PerspectiveListenerList$1.run(PerspectiveListenerList.java:75) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.internal.PerspectiveListenerList.fireEvent(PerspectiveListenerList.java:58) at org.eclipse.ui.internal.PerspectiveListenerList.firePerspectiveActivated(PerspectiveListenerList.java:72) at org.eclipse.ui.internal.WorkbenchWindow.firePerspectiveActivated(WorkbenchWindow.java:1719) at org.eclipse.ui.internal.WorkbenchPage$4.handleEvent(WorkbenchPage.java:3000) at org.eclipse.e4.ui.services.internal.events.UIEventHandler$1.run(UIEventHandler.java:40) at org.eclipse.swt.widgets.Synchronizer.syncExec(Synchronizer.java:186) at org.eclipse.ui.internal.UISynchronizer.syncExec(UISynchronizer.java:145) at org.eclipse.swt.widgets.Display.syncExec(Display.java:4633) at org.eclipse.e4.ui.internal.workbench.swt.E4Application$1.syncExec(E4Application.java:211) at org.eclipse.e4.ui.services.internal.events.UIEventHandler.handleEvent(UIEventHandler.java:36) at org.eclipse.equinox.internal.event.EventHandlerWrapper.handleEvent(EventHandlerWrapper.java:197) at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:197) at org.eclipse.equinox.internal.event.EventHandlerTracker.dispatchEvent(EventHandlerTracker.java:1) at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:230) at org.eclipse.osgi.framework.eventmgr.ListenerQueue.dispatchEventSynchronous(ListenerQueue.java:148) at org.eclipse.equinox.internal.event.EventAdminImpl.dispatchEvent(EventAdminImpl.java:135) at org.eclipse.equinox.internal.event.EventAdminImpl.sendEvent(EventAdminImpl.java:78) at org.eclipse.equinox.internal.event.EventComponent.sendEvent(EventComponent.java:39) at org.eclipse.e4.ui.services.internal.events.EventBroker.send(EventBroker.java:85) at org.eclipse.e4.ui.internal.workbench.UIEventPublisher.notifyChanged(UIEventPublisher.java:59) at org.eclipse.emf.common.notify.impl.BasicNotifierImpl.eNotify(BasicNotifierImpl.java:374) at org.eclipse.e4.ui.model.application.ui.advanced.impl.PerspectiveStackImpl.setSelectedElement(PerspectiveStackImpl.java:135) at org.eclipse.e4.ui.model.application.ui.advanced.impl.PerspectiveStackImpl.setSelectedElement(PerspectiveStackImpl.java:1) at org.eclipse.e4.ui.workbench.addons.perspectiveswitcher.PerspectiveSwitcher$12.widgetSelected(PerspectiveSwitcher.java:590) at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:248) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4481) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1329) at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3819) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3430) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$4.run(PartRenderingEngine.java:1127) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1018) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:156) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:694) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:606) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:139) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:380) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:235) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:497) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:669) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:608) at org.eclipse.equinox.launcher.Main.run(Main.java:1515) at org.eclipse.equinox.launcher.Main.main(Main.java:1488)	14.0
id=510758	REOPENED	JDT	UI	4.7	PC Linux	P3 normal	JDT-UI-Inbox	2017-01-20 08:31 EST by	Lars Vogel	2017-01-27 04:45 EST (	2 users	Run "convert for loops to enhanced loops" cleanup action on org.eclipse.ui.internal.activities.ws;ActivityEnabler-> Creates syntax error	Just applied it on master code and no error.Just had this again in PDE:RemoveUnsupportedTagOperation from pde.ui in current master.Run Convert to enhanced for loop on RemoveUnsupportedTagOperation and you receive an syntax error.	2.0
id=491700	REOPENED	JDT	UI	4.6	PC Windows 8	P3 minor	JDT-UI-Inbox	2016-04-14 09:37 EDT by	Stephanie Swiderski	2016-04-15 11:24 EDT (	2 users	 	In the following example renaming foo will present two linked ui areas for the foo in the declaration of foo and in the wrong @see reference.After confirmation with return the changes at the @see reference will disappear.Expectation: no linked UI for wrong @see reference./** * Breaking example */package basic;public class TestArea { public void foo() { // Try to rename foo } /** * @see TestArea#foo this foo reference will have linked ui */ public void fooOther() { }}Moving to UI for investigation. This might very well be a problem in core, but we will need some inputs as to what's going wrong in case.Those references do match.(In reply to Dani Megert from)The issue I see is when renamed, the reference in Javadoc doesn't change. Is that expected?(In reply to Jay Arthanareeswaran from)Well, the problem is that the bug has a wrong summary and is not precise. The reference match and that is correct. There are two different rename commands. One for the file and one for the workspace. The latter seems to fail.Actually I think the match is not correct since the reference is pointing to a field like:public int foo;If this field is added to the example the match does not any longer occurand the linked UI is not drawn.(In reply to Stephanie Swiderski from)Nope, this is valid Javadoc for methods, e.g. if you don't want to restrict the Javadoc @see to a specific signature of #foo.There will be a problem for rename if there's more than one foo in the same file.By Java Doc documentation:@see class#fieldis different to @see class#method()and so I expect that renaming TestArea#foo()would not touch the comment/** * @see TestArea#foo this foo reference will have linked ui */Ok my mistake:Here is desribed what you meant.Then (In reply to Dani Megert from)Maybe close this bug an reopen a different one for the failing rename command.I started the rename with rename refactoring hotkey and cursor on foo().(In reply to Stephanie Swiderski from)It's fine - we can use that for the workspace rename.	11.0
id=240773	REOPENED	Platform	UI	3.5.1	PC Linux	P3 normal	Kevin McGuire	2008-07-15 03:26 EDT by	Guo Yun	2010-04-20 09:49 EDT (	7 users	CreatedSample codeBuild ID: Version: 3.4.0Build id: I20080617-2000Steps To Reproduce:1. Use StringFieldEditor to contribute a text editor preference eara in Preference page2. Use -dir rtl to run the in bidi mode3. Found the text inputted in it is still align to left, not align right. Attached the sample code below.More information:Same source code works well on Windows platform.	Assigning back to the inbox for another look...Felipe, do you think this is another duplicate of?screenshot ?Guo Yun, could you please attach screenshots to this bug, ideally one on Windows showing the correct behaviour, and one on Linux showing the problem?Createdsnapshot on WindowsCreatedsnapshot on LinuxOkay, in GTK alignment is switched automatically according with the paragaph reading order (which is a good thing).Fixing 236513 will fix this too (note that the description of 236513 doesn't say anything about alignment so this is not very intuitive).Last note: we fixed this problem for label, see.Feel free to close as a duplicate of 236513.*** This bug has been marked as a duplicate of***I saw theis fixed in 3.5M4. But I still can reproduce this problem in 3.5.1. So I reopen this bug.Requesting feedback from Felipe as our Lotus XPD browser team is continuing to see this problem.(In reply to)The problem was not fixed for the Text control, seein	11.0
id=446437	REOPENED	JDT	UI	4.4.1	All All	P3 normal	JDT-UI-Inbox	2014-10-09 06:44 EDT by	EPP Error Reports	2015-08-27 05:23 EDT (	3 users	Hello committers,we received a new error report for Eclipse 4.4.1.M20140925-0400.General Information: anonymous-id: 4a814b2d-7243-4e42-b54a-2ae5d8456eb0 eclipse-build-id: 4.4.1.M20140925-0400 eclipse-product: org.eclipse.epp.package.rcp.product operating system: MacOSX 10.9.5 (x86_64) - cocoa java-runtime-version: 1.8.0_20-b26The following plug-ins were present on the execution stack (*): 1. org.eclipse.core.resources_3.9.1.v20140825-1431 2. org.eclipse.core.runtime_3.10.0.v20140318-2214 3. org.eclipse.jface_3.10.1.v20140813-1009 4. org.eclipse.ltk.core.refactoring_3.6.101.v20140817-1500 5. org.eclipse.ltk.ui.refactoring_3.7.100.v20140324-1358Error Status: code: 10.000 plugin: org.eclipse.ltk.ui.refactoring_3.7.100.v20140324-1358 message: Internal Error fingerprint: d225ec0b exception class: org.eclipse.core.runtime.AssertionFailedException exception message: assertion failed: number of children: 0 org.eclipse.core.runtime.AssertionFailedException: assertion failed: at org.eclipse.core.runtime.Assert.isTrue(Assert.java:110) at org.eclipse.core.runtime.Assert.isTrue(Assert.java:96) at org.eclipse.ltk.core.refactoring.CompositeChange.add(CompositeChange.java:111) at org.eclipse.ltk.core.refactoring.CompositeChange.addAll(CompositeChange.java:124) at org.eclipse.ltk.core.refactoring.CompositeChange.<init>(CompositeChange.java:69) at org.eclipse.ltk.core.refactoring.CompositeChange.createUndoChange(CompositeChange.java:456) at org.eclipse.ltk.core.refactoring.CompositeChange.handleUndos(CompositeChange.java:345) at org.eclipse.ltk.core.refactoring.CompositeChange.perform(CompositeChange.java:323) at org.eclipse.ltk.core.refactoring.PerformChangeOperation$1.run(PerformChangeOperation.java:258) at org.eclipse.core.internal.resources.Workspace.run(Workspace.java:2313) at org.eclipse.ltk.core.refactoring.PerformChangeOperation.executeChange(PerformChangeOperation.java:306) at org.eclipse.ltk.internal.ui.refactoring.UIPerformChangeOperation.executeChange(UIPerformChangeOperation.java:92) at org.eclipse.ltk.core.refactoring.PerformChangeOperation.run(PerformChangeOperation.java:218) at org.eclipse.core.internal.resources.Workspace.run(Workspace.java:2313) at org.eclipse.ltk.internal.ui.refactoring.WorkbenchRunnableAdapter.run(WorkbenchRunnableAdapter.java:87) at org.eclipse.jface.operation.ModalContext$ModalContextThread.run(ModalContext.java:122) Messages, stacktraces, and nested status objects may be shortened. Please visitfor the complete error log.Some general information and guidelines about how to use this bug report:1. Feel free to move this bug to your own product and components. Please note that this bug is only accessible to Eclipse committers. If you move this bug please make sure that it's still in the "Security Advisor" group.2. The bug contents of the fields status, resolution, keywords, and whitelist are presented to reporters. If you needs more information, please set the keyword "needinfo". This will trigger a specialized dialog asking the user to provide further details.3. Use the following resolutions for the following situations: * CLOSED / FIXED: This bug has been fixed. Please provide additional information in the whiteboard field. * CLOSED / WORKSFORME: Use this resolution if you can't reproduce this issue and request further information. Please use the whiteboard text to specify more details what a user should provide and how. * CLOSED / INVALID: Use this resolution if the reported problem is a 'user-configuration' problem. Please consider giving hints how to fix these issues in the whiteboard field. * CLOSED / NOT ECLIPSE: Use this if the problem is caused by another plugin not developed at Eclipse.org * CLOSED / MOVED: If this bug has been moved else where. Please provide more information (e.g. a link) in the whiteboard field.4. Please remember that only committers can view and comment on this bug. You may, however, manually add the reporting user to the bug's cc list. But keep in mind that the report may contains sensitive information.5. If you are missing a feature, please file a enhancement request here:Thank you for your assistance.Your friendly error-reports-inbox.--* Note: The list of present bundles and their respective versions was calculated by package naming heuristics. This may or may not reflect reality.	Moving to JDT core for comments.It's hard to tell what's going on here without steps to reproduce.CompositeChange.perform(CompositeChange.java:323) tells that another exception occurred, but that's overridden by the AFE that happens in error-handling code.The AFE is due to an invalid implementation of org.eclipse.ltk.core.refactoring.Change#perform(IProgressMonitor)that returns a Change object that already is already part of another change. E.g. returns 'this'.I just submitted this:In my case, this happened when I tried to preview a refactoring (class move from one package to another).Steps to repro were approximately these:- drag the class from the old package to the new one- checked "Update fully qualified names in non-Java text files" (pattern *)- hit preview,- hit back- unchecked "Update fully qualified names in non-Java text files"- hit previewJust tried another time doing exactly this and it seems like I got the exception once again.	3.0
id=341544	REOPENED	Platform	PMC	3.7	All All	P3 enhancement	John Arthorne	2011-03-31 16:17 EDT by	John Arthorne	2016-01-22 10:56 EST (	8 users	The Eclipse project charter hasn't been updated in ten years. Several elements of the charter are out of date, including the list of sub-projects and components. With the introduction of Orion it seems like a good time to revise this.	For background context, see Mike M's note on the Orion project proposal:The standard charter template is here:CreatedCharter patchHere is an initial attempt at updating the charter. It contains the following changes:1) In the "Mission" section, there are a few places where the general word "Eclipse" is used to refer to the Eclipse Project's tool platform. Since "Eclipse" now means far more than this, I have updated the wording. For example, "Eclipse is a kind of universal tool platform" becomes "The Eclipse Project provides a kind of universal tool platform".2) The Scope section has been completely rewritten. This was previously an exhaustive list of sub-projects and components circa 2001. Since changing the charter is a rare and heavy-weight process, I have avoided listing any particular sub-projects at all. From looking at other top-level project charters this seems to be the norm.3) Changed all occurrences of the word "newsgroup" to "forum" (to match the new principle interface at eclipse.org/forums).4) Remove specific mention of CVS. There was only one occurrence of the word. "One or more CVS repositories" became "One or more source code repositories..."I have two other proposed changes, but wanted some feedback on them first.- There is a section entitled "Ports", that talks about defining Port Components, Port Leads, etc. This is mainly with SWT in mind, but I think it no longer matches our practices. I suggest just removing this section entirely.- A question for Wayne/Mike M: There is a reference to the "Eclipse Foundation Architectural Roadmap". Is the Roadmap eliminated along with the Requirements Council in the proposed Foundation bylaw updates? If so, is there something to replace this? Here is the relevant section, from the list of PMC responsibilities:"Providing the leadership and vision to guide the Project's overall direction in a manner consistent with the Eclipse Foundation Architectural Roadmap."(In reply to)+1. I don't see why we should have different rules than for normal/other code.(In reply to)I would recommend changing this to say: "Providing the leadership and vision to guide the Project's overall direction in a manner consistent with the Eclipse Development Process."CreatedCharter patch v2Two further changes (as mentioned above):- Removed the section on "Ports" entirely- Updated the paragraph that references the roadmap:Old text: <li>Providing the leadership and vision to guide the Project's overall direction in a manner consistent with the Eclipse Foundation Architectural Roadmap.</li>Proposed new text: <li>Providing the leadership and vision to guide the Project's overall direction and architecture.</li>Mike M suggested replacing this with a statement about conforming to the development process. I think that point is covered elsewhere in the charter, and this statement is really about responsibility for overall architecture.Looks good. +1much better. +1.All changes mentioned here look good to me.Compared to the standard toplevel charter referenced by Wayne, the responsibilities of the PMC seem to be elaborated much more than in the standard. I'm wondering whether that amount of elaboration is necessary and helpful?Given that over-specification is to be handled with care, and that adopting common standards is typically a good thing, I'd like to see a draft copy of the proposed Eclipse Platform Charter (with patch applied) and how it diffs against the standard toplevel charter template.Looks good to me. +1.(In reply to)The standard charter template says almost nothing about the responsibilities of PMC members. Essentially "subscribe to the mailing lists" is the only concrete responsibility it lays out. This might be reasonable for the standard template since PMC responsibilities vary widely across different projects. Perhaps for other PMCs this is sufficient because individual project leads take on responsibility for their area.Our charter does go into a lot of detail about PMC responsibilities. However reading through the list, I don't see anything listed there that I disagree with. Unless there are specific things you want to remove, I suggest leaving it. I find it a helpful reminder of the kinds of things we should be doing.Dani, these changes alone might not be worth the effort, but if there are other charter changes coming it would be easy enough to incorporate them. Changing the top-level project charter requires a vote on the Eclipse board of directors, but I expect this sort of change would be passed easily.I do realize that this is basically housekeeping, but I would certainly love to get Eclipse's charter updated, and re-based on the standard template.I started to look at this and then discovered that John already made all the above changes when he added the Orion 0.4 release review withCharter changes require board approval.Mike, what do we need to take this to the board?Should the title include the word "Charter" ?(In reply to Wayne Beaton from)Just for the record: this was mostly a clean up and has been done almost 4 years ago (March 2012).	17.0
id=400771	REOPENED	Platform	UI	4.3	PC All	P3 normal	Lars Vogel	2013-02-14 04:21 EST by	e mucha	2016-04-20 12:09 EDT (	10 users	CreatedStandalone e4ApplicationA Part is used as shared element referenced by a placeholder. The Part and also the Placeholder are declared as non closeable in the Model Editor. Regardless of that in the running application the close button on the Part header is shown and works. Kind regards,ErikAttached Standalone	Which build are you running against?PWTested with 4.3 nightly -> reproducableReproduced on:Reproduced on: Eclipse SDKVersion: Luna (4.4)Build id: N20140301-1500Having the 'closeable' attribute on a part was likely a bad idea. The problem is that a (shared) view can be closeable in one perspective but not in a different one, meaning that the flag on the MPart isn't really that useful. There's a tag IPresentationEngine#NO_CLOSE that should be applied to the MPlaceholder if you want to inhibit the close button from appearing on the tab.We honor the attribute if the MPart is directly in the presentation and not referenced through a placeholder (or at least we should...;-).I'm not sure whether the model editor understands this though, can you verify if the "NO_CLOSE" tag has been added to your placeholder ?(In reply to Eric Moffatt from)I don't think that is a tooling issue. If the shared part has the "Closeable" attribute set, then it should be closeable. If the "NO_CLOSE" tag is set this should IMHO override the model attribute. But if the model element does not have the "Closeable" attribute set to true, that should be sufficient and no tag should be needed.Dzmitry, I think this similar to, do you want to give it a try to fix this?We got the same problem here... +1I'll have a look at this problem, but might need additional info for that...I think I can fix this bug by changing org.eclipse.e4.ui.workbench.renderers.swt.StackRenderer::isClosable(MPart part) implementation. However before I submit a patch I would like to make it clear what the priority of different attributes/tags is.Does an explicitly specified NO_CLOSE tag for Placeholder overrule the closeable attribute of the same Placeholder? Should the close-ability of the referenced part be ignored if a Placeholder is defined (if yes - ignore in all cases or only in some of them like only when Part.closeable is explicitly enabled)? In other words in the following table correct:Placeholder.NO_CLOSE defined && Placeholder.closeable=False -> part not closeablePlaceholder.NO_CLOSE not defined && Placeholder.closeable=False->not closeablePlaceholder.NO_CLOSE defined && Placeholder.closeable=True->not closeablePlaceholder.NO_CLOSE not defined && Placeholder.closeable=True->is closeableor should this table be extended with Part.closeable values, like:Placeholder.NO_CLOSE not defined && Placeholder.closeable=False && referenced Part.closeable=true -> is closeable.Please let me know what the expected behavior should be and I'll submit a patch for that.(In reply to Dmitry Spiridenok from)Thanks for the pre-analysis. I had problems following your logic without looking at the code, hence I propose the following fix:(In reply to Lars Vogel from)Dmitry, can you please review it and let me know if you are OK with my implementation?Hmmm, I didn't even realize that MPlaceholders *had* an 'isCloseable()'; this looks like a mis-implementation to me (i.e. the 'NO_CLOSE' tag should only be used on elements that do *not* have a 'closeable' state in the model.If that's true then the logic is straightforward:Placeholders win: use the placeholder's state first (whether in the model or in the tag. Only if the MPart is not shared should its state be checked...I'm also wondering whether we should deprecate the 'NO_CLOSE' tag ? Are there any other cases where you think it might be useful ? At minimum we should update the javadocs to point out that the preferred mechanism to use for MParts / MPlaceholders is to use the model state...(In reply to Eric Moffatt from)I think tag must win to preserve the current logic.I think we first need to adjust the logic to use the model property instead of the NO_CLOSE tag. Can you point me to the place in which the part placeholder is constructed?The Javadoc of MPlaceholder looks OK to me, see below. * <p> * The following features are supported: * <ul> * <li>{@link org.eclipse.e4.ui.model.application.ui.advanced.MPlaceholder#getRef <em>Ref</em>}</li> * <li>{@link org.eclipse.e4.ui.model.application.ui.advanced.MPlaceholder#isCloseable <em>Closeable</em>}</li> * </ul> * </p>The placeholders are created in the ModeledPageLayout code (where we populate perspectives) or in the 'showView' code for parts for which there is no existing placeholder.I can't think of any other places where we create placeholders for shared parts.I have no problem maintaining the current behavior as long as you're comfortable that it's the *correct* behavior...I'll check the patch itself tomorrow (trying to fix DnD today).(In reply to Eric Moffatt from)Eric, any update?Committed:Thanks Lars, I'll let you 'VERIFY' this one next week...;-).Looks like the "Close" model attribute of the Shared Elements in not correctly set (also false), until we have fixed that we need to revert that change which surfaces it.Previous logic works a a view is closable if the tag is not present.Is there already a bug about that? I'll be willing to have a look at the problem with closeable on the Placeholder.Had a look at the 433465 bug. Might there be a problem with live application viewer/changing the model property dynamically and not with the (static) model itself?If I use debugger to view the states of the elements of my E4 application I see that the right static closeable values is applied (the same value as specified in my *.e4xmi file). So it looks like the statically specified model value is applied correctly. While dynamically changing the close value I indeed see that closeability of part/placeholder does not change. So for me it sounds like it's not possible to change/view the closeable property of a part run-time/dynamically after the model is instantiated (that's what 433465 is about). However specifying the close property in the e4xmi file still leads to the correct behavior of the part/placeholder.For this reason these bugs seem for me to be unrelated. The solution in review 24518 looks like a desired change which does not make the existing situation worse. So I would vote for delivering the solution in 24518 regardless of the solution for 433465.OK, now I think i understand whatis about...That bug is about "Package Explorer" part that has the default value of closeable=false. Because the solution for this bug respects this flag, it's not possible to close "Package Explorer" anymore. Is it correct?(In reply to Dmitry Spiridenok from)Correct.Lars, you 1. increased to 'major' and 'reopened'. What are the exact steps to reproduce this (sorry, don't have time to read all the comments).(In reply to Dani Megert from)I think this might actually been solved in the meantime / might have been a misunderstanding. Moving to 4.6 for investigation.Mass move to 4.7 as M7 is approaching. Please move back in case you are planning to fix it for Neon.	25.0
id=287761	REOPENED	Platform	UI	3.5	PC Windows XP	P3 normal	Krzysztof Daniel	2009-08-26 19:33 EDT by	Ryan Baxter	2013-06-05 10:50 EDT (	10 users	Build ID: M20080911-1700Steps To Reproduce:1. Launch Eclipse with provided plugin2. Click Eclipse icon in toolbar3. Once progress icon shows in the status bar click it to open the progress view4. Wait for job to run and finish, do not clear finished job from the view5. Close progress view6. Go to Window -> Show View -> ProgressProblem: Notice task that appears to be running in the progress view and never finishes.More information:From debugging the progress view code it appears that this job and its task gets added to the FinishedJobs object when it finishes. When you close the view and open it again while the new job is running the job is placed back in the view, but the associated task is also placed back in the view. Before the task was associated with the job and now it seems to be separated out and appears to be running, even though it is not. This all appears to take place in ProgressViewContentProvider.getElements.	CreatedScreen shot of problemCreatedSample plugin to reproduce problemI have checked this with 3.6M1 and it works correctly (only one finished job is presented).As Eclipse 3.4.1 is out of maintenance, could you try to reproduce on newer Eclipse version (3.5 or 3.6)?Otherwise this bug will be closed as WORKSFORME.(In reply to)I downloaded a clean version of 3.5 and tried and it was reproducable for me. Please let me know if you are still having problems reproducing.Is this bug being investigated? Is there any estimated time of completion?It is after initial investigation. If everything will go fine I'll try to fix the issue in 3.6 M3.CreatedFix propositionI think I have nailed the root cause.TaskInfo is used to store the task information. After the job is finished, we do not need it anymore. Existing code just disconnected TaskInfo from JobInfo, but both objects were stored in the FinishedJobs.When the view was recreated, there was no way to connect info and task.The fix is quite simple - it seems to be enough to remove task info from finished jobs when it is not necessary anymore.I'll do more testing tomorrow.All tests passed.Without reopening the view the issue is impossible to observe, because only changed job is refreshed, so when it is finished, orphaned task is still in the tree, but Progress view does not refresh roots.Prakash,could you review the patch?(In reply to)Reviewing.... Meanwhile, a quick question. Do we need to push this into maintenance branch? Or fixing in the HEAD is enough?CreatedPatch v02Patch looks good to me. Adding a test (note, I've created the patch from the HEAD. Will attach a right patch from the maint branch in the evening)Adding Boris, we would need a +1 from him to check into the maint branch.+1 for the one-line fix for 3.5.2 (the one from). Prakash, can you explain why the changes to getParent() were needed for the tests you added? Not sure if these changes need to go into 3.5.2 if they are not part of the actual bug fix. It may be better to make these changes in HEAD only.pingPrakash, can you release the patch into 3.5 or should I?I have tried to do the release but I have no write access to map file. The code is in repository and is tagged as M20100113-1400 but map file needs to be updated.I am doing build submissions currently, will pick your changes up tomorrow.(In reply to)The method was not accessible by the tests, so changed it to public. It was not part of the fix, but only for testing. The patch has been checked in the Maintenance branch. Marking as fixedChristopher, can you please use a commit comment as per our conventions, i.e. something that includes the full bug number and title? Otherwise, the releng tool will not pick up the bug id and our build notes do not include the change.For example: "fix for- [Progress] Finished Tasks Still Show In Progress View" or just "- [Progress] Finished Tasks Still Show In Progress View"CreatedThe bug still exists in 3.5.2The bug still exists in 3.5.2 (I use eclipse-rcp-galileo-SR2-win32.zip). Please see the attached screen-shot.ReopeningMichael,is this issue still occurring? Are you able to prepare a test-case?(In reply to)The bug happens sometimes, not constantly, so it's difficult to prepare a 100% working reproduction. You can see the attached screenshot.CreatedProgress view with erroneous entries for TaskInfo objects.Bug, or something very like it, still exists in 3.6.2. See attached screenshot.I don't understand the codebase enough to know why TaskInfos are being kept in FinishedJobs at all. However, looking at the implementation of ProgressViewerContentProvider it is obvious that it was intended to prioritize JobInfos over TaskInfos:---Iterator keptIterator = kept.iterator();while (keptIterator.hasNext()) { JobTreeElement next = (JobTreeElement) keptIterator.next(); if (next.getParent() != null && all.contains(next.getParent())) continue; all.add(next);}---So it appears to be trying to skip adding elements whose parent was already added. But this doesn't work because //kept// is a HashSet and therefore the iteration order is unpredictable (and I believe it would currently be wrong even if it were a LinkedHashSet, just wrong 100% of the time :)).To reproduce with reasonably high probability:1) Run 10 or so jobs that get kept in the Progress View.2) Close and reopen the Progress View.3) Look for tasks marked as "running" near the top of the list.I should also note that this basically stops us from using IProgressConstants.KEEP_PROPERTY in our RCP application.	25.0
id=401043	REOPENED	Platform	UI	4.3	PC All	P3 normal	Lars Vogel	2013-02-18 02:42 EST by	Lars Vogel	2016-04-20 12:04 EDT (	6 users	AFAIK container data must be a number, currently we accept all input, e.g. letters too. I suggest to restrict this to numbers. @Eric/ Tom: Are integers only ok?	Well if it is the child of a SashPart-Container your are right but it really depends on the container you are in. IMHO we should have made the ContainerData a Map with key-value pairs instead of a dumb-string, this would make it easier to spec min/max values in future.If we would have a model upgrade story we could try to address this before we make the model API, not sure if the reason I give here are sufficient since this container-Data has been like this from the first day.Eric, we should set it on our discussion list.I discussed this some time ago with Eric inI agree with Tom that a map with key-value pairs would be helpful. I close this bug as INVALID. Tom, please open a new bug report for the map with key/value pairs.We could also *remove* 'containerData' as a specific attribute now that we have the 'persistentData' map...the contract is totally at the discretion of the *owning* (i.e. parent) container how / what it wants to store to correctly handle its children...The SashRenderer could just add a new key 'sashWeight' to the map and use it, making the current attribute unnecessary.+1 for removal of the container data. @Eric: Is this still an option for Eclipse 4.3?Removing containerData must be discussed on P/UI.No, basically due to the fact that we would have to be able to handle reading / updating existing saved models. I've marked this for a look in Luna but this in one of those cases where backwards compatibility (even in 4.x...;-) may rule out doing it in Luna.Eventually I know we're going to change the model in some breaking manner but we have nobody here that knows the right hoops to jump through to dynamically upgrade a model on 'read'...I'm moving this off to the side for Luna...it's not causing any issues and nothing is preventing a renderer from skipping the use of this field and directly using keyed values in the persistentData map...If I'm going to do anything here it'll most likely be to just mark the 'containerData' as deprecated and point towards the persistentData approach...Does anybody want to make a strong case that the field *must* be removed ?We should do something here or defer this until post-Luna.If it effects API we would have to deprecate it and if we want to remove it, make that claim.PW(In reply to Eric Moffatt from)Eric did you manage to deprecate the fields and use persistentData?I mark this as WONTFIX. No need to adjust the current implementation.Steven started to work on this in. Reopening.We should support the existing container data but deprecated it (issue a message if it is used) and replace it with persistent state.(In reply to Lars Vogel from)Is the SashLayout the only class using ContainerData. Are their any non-SWT renderers or classes that use it?How likely will a new model using persistentData instead be opened on an older build that is still looking for containerData?The new patch allows for an integer or value such as (size:50%;min:20px;max:100px) I could keep those values separate with persistentData, but it is trivial to parse the string, and simple to enter it into the UI. If we are going to restrict or validate the input, it might make sense to just keep the containerData. I think it is specialized enough to warrant its own setting on the main tab.If we do remove containerData, I would suggest still having a separate text box in the editor that just modifies the relevant keys in the map; I was going to put in a tooltip to describe the new ContainerData format.Here is a reason we may want to keep ContainerData as a discrete attribute:SashRenderer subscribes to changes:eventBroker.subscribe(UIEvents.UIElement.TOPIC_CONTAINERDATA, sashWeightHandler);Does EMF allow us to subscribe to a single key in the map?(In reply to Steven Spungin from)e(fx)clipse JavaFX renderer use containerData as well as persistedState so we can already work with persitedState and track changes in there as well. If upstream changes to persistedState we are fine with that and will support it as well in our sash-renderer.(In reply to Steven Spungin from)I think we can do it similar to the event handler in StackRenderer for transient data.(In reply to Thomas Schindl from)I would suggest refactoring the calculation logic out of the SWT renderer so both platforms can benefit. Where would we put this shared code?(In reply to Steven Spungin from)Yes it allows you to listen do changes in a Map-Attribute what you get as an event has:event.getProperty(UIEvents.EventTags.ATTNAME) == UIEvents.ApplicationElement.PERSISTEDSTATE;java.util.Map.Entry<String,String> e = event.getProperty(UIEvents.EventTags.NEW_VALUE);(In reply to Steven Spungin from)if there's code you want to share it would be somewhere in the ui.workbench at the same level where you have IPresentationEngine. The question is what you want to return from such a service. JavaFX SplitPane works completely different to e4-SWT-SashLayout so I don't think that makes a whole lot of sense.Beside that e(fx)clipse renderers internally work completely different than the their SWT counter parts with respect to how informations are transfered into the rendering pipeline.(In reply to Thomas Schindl from)I am referring to code that calculates the current weights during layout and resizing based on min/max values and the other relative/absolute values in the container. Also code that parses and regenerates the container data. The current implementation has all that logic in the SWT renderer. It makes sense to me that e(fx)clipse renderers (and other renderers) would not need to reinvent that stuff.Another reason to keep ContainerData discrete. Now that constraints and absolute sizes can be set, a part can declare its size. It will be simple for users to set ContainerData vs needing to know the map key, etc. It would also be nice if a part-stack without container data set would fall through and consider the container data in the parts it contains, if their data is set.In addition, if we store this in the map, all other map listeners are going to receive MANY callbacks when the sash is resized if we can't subscribe to just one key.If this values was not written to often, and did not have to do with size, I would be more convinced to migrate it to a map.Many implementations (addons, etc) clone a part's ContainerData; storing discrete values would make it difficult to only copy those fields.Could we deprecate containerData in favor of using PersistedData, and also add a new member to MUIElement. This new member could be more focused as to the size/resize behavior of the element; It could either be a map<string,object> or have discreet members. (I suggest string,object because it would optimize calculations).(In reply to Steven Spungin from)I think persistedData is the write place as we need to persist the data between application restarts. I think it is very important to keep the model as simple as possible and adding a persisted map<string,object> is not a good way. We could use transientData to store any calculated data. That is already map<string,object>.(In reply to Lars Vogel from)Questions:1. So how does an addon that only wants to clone the size data get to just those items? Clone the transient data? I guess we could we store an sizing object in transient data, and just clone that.2. Where would the best place in the code to load/save the persistedData to transientData be?3. Are we OK with these keys: <prefix>.resizeMode, <prefix>.size, and <prefix>.unit? What prefix to use?4. Can we add a new widget in on the main tab of the editor for these 3 values, right after the containerData?5. What's the strategy for legacy containerData values?(In reply to Steven Spungin from)The base data would be in persistedState and the converted data in transient data. The model add-in would pick whatever it like.If required, I think SashRenderer is the correct place.Sounds good for an initial implementation. What about sashlayoutdata as prefix?I suggest to first use the existing tooling, once this is implemented we can enhancement the tooling.I must still support it. Maybe convert it at runtime to the new values and issue a warning message to the log?Createdusing persisted state to set part size informationCreatedequivalant container data shortcutIt is MUCH easier to still specify as a string. Lateset patch will automatically convert this to persistent data.Createdperspective showing runtime valuesMass move to 4.7 as M7 is approaching. Please move back in case you are planning to fix it for Neon.	31.0
id=412824	REOPENED	Platform	UI	4.3	PC All	P3 enhancement	Lars Vogel	2013-07-12 02:58 EDT by	Lars Vogel	2016-04-24 13:59 EDT (	10 users	Currently @Preference is not released as API. Maybe we can release it with Eclipse 4.4.	Marking as WONTFIX for Luna, we can decide again for Mars..I'm not 100% fine with the API as of today. It currently also exposes the IEclipsePreference API (if you want to) - while we could keep this for backwards reason I'd like to keep it as an implementation detail.The IEclipsePreference is injected for publishing purposes but IMHO this is not needed in the 99% case (and makes porting this to RAP a nightmare because the IEclipsePreference-API is not supported there).I would propose we simply allow the injection if an API like:interface IPreferenceValue { void setValue(String value, ValueType t); enum ValueType { STRING, INTEGER, DOUBLE, .... }}(In reply to Thomas Schindl from)This bug is only about the annotation, hence it would not make an assumption how it is implemented.As part of publishing the API you need to spec in the JavaDoc what the user can expect to get injected. So you need to clarify that before making it API.It is important to discuss what we expect to get injected because this has an impact on this very API.Keep it as API, keep it for backward, remove it. If you go for the last one (possibly breaking clients) you would have value() as a none-defaulted property because you require the user to provide the key in the IEclipsePreference node.... and because we are at it. The location of the annotation is a bad thing and we should move that one also to an extra bundle like we did it with core.di.annotations!unfortunately this time it is not as easy as it was because of the EventUtils class who should not move anywhere! So we'd have a split-package which we should avoid at all costs!(In reply to Thomas Schindl from)+1, I agree (now).Can you upload a Gerrit change so that we can discuss the code?(In reply to Lars Vogel from)After looking at other annotations, they typically do not describe the implementation details or only as examples. So we might be able to release the annotation even if we do not fix the implementation.we better fix the other annotations and make them describe what the user can expect them to do - so it is the other way round those other annotation should have never been released with a proper description what one can expect them to do!Although we could have a custom IPreferenceValue, this needing to change values seems like a recurring issue (we need to inject IEclipseContext for the same reason). JSR 330 has a Provider<T> class for deferred fetching, and I think it would make sense to have a _modifier_ interface that @Preference and ContextObjectSupplier could leverage. I haven't been able to come up with a good name as Modifier seems to clash with java.lang.reflect.Modifier. Replacer? Alterer? Setter? Updater?(In reply to Thomas Schindl from)No. The annotations should not describe the implementation details.(In reply to Brian de Alwis from)in e(fx)clipse we named it ContextBoundValuebut as you can learn from the wiki you can also inject an IObservableValue or a JavaFX-Property.(In reply to Lars Vogel from)I think it is not an implementation detail to describe what happens when I write:@Preference(nodePath = "my/bla/node")Where if not at the JavaDoc you spec what happens?I would agree that specifying the expected interface to retrieve when using @Preference is part of the API, too and not an implementation detail.I also like the idea of having a slim interface which does not depend on any existing preference stuff.About the name: I like names which end with "Value", because from my POV a value is what you get and what you can change. "ContextValue" implies a bit, that it lives in the context, which doesn't necessary have to be the case.Without having chekced: isn't there something in plain Java like this?Right contextvalue is to much bound context - DIValue would be more general maybeDIValue implies, that is is used with dependency injection, which is not necessarily true. What about EValue following the naming pattern for Eclipse 4 services? You could see an value as a micro service...EMF uses a Setting class with a set(Object) method.e(fx)clipse 2.1.0 (released tomorrow) has itsown annotation now -maybe the platform can be inspired by it ;-)Dirk anyways wanted to bring some of the cool stuff from the e(fx)clipse runtime to eclipse. Final note: One of the mature pain points in case of @Preference is also that it is in a bundle with OSGi-Dependencies so creates a direct dependency on all the stuff. Unforunately moving the annotations into an extra bundle like we did with core.di.annotations is not as easy because it will produce a split package (although I'd still take this hit and move it because it is simply bad design)(In reply to Thomas Schindl from)Yes I still want to do that, but I currently don't know where to start. ;)Regarding the Preference annotation, I think that needs to discussed and planned well as it will affect users that already use the @Preference annotation. Or should we introduce a new one in a new bundle?What I'm also curious about, does the e(fx)clipse Preference annotation support the fallback to the default scope? In several customer projects I come across the issue that setting a preference to a default value will inject null as preference value (Eclipse Platform). This leaves developers to manually inspect the default scope to identify the default value correctly. IMHO that is also a bad design regarding the annotation, as it should always get the preference value in use and not leave the developer to inspect other scopes manually.No - I would:a) move the existing annotations to a new bundle (like we did for core-annotations already)b) I would introduce the Value<T> concept (can be used for context value as well - in fact the very same thing will happen to ContextBoundValue in e(fx)clipse 3.0)c) I would spec the fact that Value<T> is a possible injection typed) I would keep IEclipsePreferences injection for now but log a deprecation warningWe are using InstanceScope.INSTANCE as of today and then call the IEclipsePreferences.get*() methods. Not sure what else you want me to call. I'm happy to merge anything useful into the e(fx)clipse codebase - just look at the code in PreferenceValueSupplier.For completeness of this ticket. We discussed the fallback stuff in another channel and Tom created	22.0
id=416339	REOPENED	Platform	UI	4.4	All All	P3 normal	Lars Vogel	2013-09-02 05:43 EDT by	Hendrik Still	2015-08-14 11:26 EDT (	5 users	For example the input parameter type ofsetContentProvider(IContentProvider<I>) should be IContentProvider<?extends I> to allow clients to set subtypes of IContentProvider<I> asContentProvider.This would allow a more flexible use for the client.	The usage of extends is not that useful in this case.An upper bounded wildcard would allow to set a more specific ContentProvider, which could possibly not handle the input of the type I.For example we change the signature to setContentProvider(IContentProvider<? extends I> cp).Now create a Viewer which handles every Object as input TableViewer<XYZ,Object>.With the upper bounded wildcard, it is now possible so set a ContentProvider which handles a subtype of Object.tableViewer.setContentProvider(new IContentProvider<String>(){});This is wrong, because now we can set an Object as input which can not be handled my the assigned "String ContentProvider"So to be less restrictive we should use lower bounded wildcards.With the Signature setContentProvider(IContentProvider<? super I> cp)it is possible to assign ContentProvider which can handle input from the type I or its super types.For example with the viewer TableViewer<String,MyDAO>() it is now possible to set a ContentProvider which handles input of every type.tableViewer.setContentProvider(new IContentProvider<Object>(){});CreatedExample for incorrect generics implementationI agree with Hendriks analysis. If we could use void setContentProvider(IContentProvider<? extends I> provider) on StructuredViewer we could not avoid runtime failures. I attach an example for such an incorrect behavior. setContentProvider(IContentProvider<? super I> provider) avoids IMHO CCE.Adding Ed as he suggested <? extends I> for the content provider. @Ed we think <? super I> is the correct implementation.Yes, I see what you mean! It's more like java.util.Collections.sort(List<T>, Comparator<? super T>) where you have to ensure that the comparator can properly receive any of the list's elements...Currently it is possible to use the <? super I> type only with a casting. My idea was to also use the super-type not only as input type for the setContentProvider method, but also as type for the field contentProvider in the ContentViewer. But this leads to compiler error, which I don't really understand. If the contentProvider field is typed as <? super I> the following line will not compile:contentProvider.inputChanged(this, getInput(), null);With the following error message:The method inputChanged(Viewer<capture#3-of ? super I>, capture#3-of ? super I, capture#3-of ? super I) in the type IContentProvider<capture#3-of ? super I> is not applicable for the arguments (ContentViewer<E,I>, I, null)I tracked the error down with the sample class I'll attache.CreatedSample Class to describe the compile error(In reply to Hendrik Still from)The problem is your provider interface:public class Provider<I> { void doSomeThing(List<I> inData){}}It expects exactly a list that promises to accept elements of type I and to return elements of type I. In other words, the compiler wants to ensure that implementations of that interface may read and write the the 'inData' without type propblems. Now consider that the type variable I is bound to '? super T' which is not concrete but only an existential type, e.g. the compiler will only ensure that this is some type which exists and which is a super type of T. Based on that, it cannot be proven that the List of T is not used in an invalid manner. To give you an example on what happens if you use a cast:class ProviderContainer<T>{ Provider<? super T> provider; public void setProvider(Provider<? super T> provider) { this.provider = provider; } void doSomeThingWithTheProvider(List<T> inData){// cast here ((Provider<T>)this.provider).doSomeThing(inData); } public static class Provider<I> { void doSomeThing(List<I> inData){ System.out.println(inData); } }}// custom provider implementation that sticks to the// contract of Provider<T>class MyProvider extends ProviderContainer.Provider<CharSequence> { @Override void doSomeThing(List<CharSequence> inData) {// we add a StringBuilder to the list of char sequences inData.add(0, new StringBuilder()); }}class MyProviderContainer extends ProviderContainer<String> { @Override void doSomeThingWithTheProvider(List<String> inData) { super.doSomeThingWithTheProvider(inData);// caboom in the next line// since we read from the list as String but the provider// legally added a string builder String first = inData.get(0); } public static void main(String[] args) { MyProviderContainer container = new MyProviderContainer(); container.setProvider(new MyProvider()); container.doSomeThingWithTheProvider(new ArrayList<String>()); }}A better way to solve the compile problem is to think about the contract of a provider, e.g. it could be worthwhile to only read from the the list and therebythe API should only guarantee that readers will get some instance of I and disallowing writer to alter the list, e.g to doSomething(List<? extend I> inData) is compilable and will prevent CCE due to valid client code.Thank you Sebastian for your really quick answer.I had to think more than twice about it.Thank you very much.I have merged Hendrik's fix into the generics branch so we can try it out on real world examples:There was a small additional fix to some synchronization code in Hendrik's previous fix:Reopen for investigation for migration to master for Neon.	11.0
id=417676	REOPENED	Platform	UI	4.4	All All	P3 normal	Lars Vogel	2013-09-20 05:14 EDT by	Hendrik Still	2016-03-29 06:34 EDT (	1 user	The JFace Viewer Snippets should be updated to take use of the generic viewer api.	This has been done in the JFace generics branch:Reopening to bring this work into master***has been marked as a duplicate of this bug. ***	3.0
id=450914	REOPENED	Platform	UI	4.5	PC Linux	P3 normal	Lars Vogel	2014-11-11 04:34 EST by	Lars Vogel	2016-04-20 12:04 EDT (	1 user	Withsolved, we should remove the duplicated classes from org.eclipse.e4.ui.workbench.swt.internal.copy. This will take a bit more work, as it seems that several internal classes are now used outside of this plug-in.	Gerrit changewas merged to [master].Commit:.New Gerrit change created:WARNING: this patchset contains 2060 new lines of code and may require a Contribution Questionnaire (CQ) if the author is not a committer on the project. Please see:WARNING: this patchset contains 2060 new lines of code and may require a Contribution Questionnaire (CQ) if the author is not a committer on the project. Please see:Gerrit changewas merged to [master].Commit:WARNING: this patchset contains 2060 new lines of code and may require a Contribution Questionnaire (CQ) if the author is not a committer on the project. Please see:I also need to update the e4 tools code if I want to remove this package. Reopening.Mass move to 4.7 as M7 is approaching. Please move back in case you are planning to fix it for Neon.	8.0
id=453520	REOPENED	Platform	UI	4.5	PC Linux	P3 blocker	Lars Vogel	2014-11-28 07:01 EST by	Lars Vogel	2017-01-19 14:25 EST (	3 users	 	***has been marked as a duplicate of this bug. ***Mass move to 4.7 as M7 is approaching. Please move back in case you are planning to fix it for Neon.New Gerrit change created:Gerrit changewas merged to [master].Commit:One of the test is failing systematically with Gerrit jobs: testOverridePropertyWithNameAndValueSplitAndNameAlreadyAddedByUser . See.It should be fixed to be Tycho-surefire friendly.What I don't understand is why wasn't it failing with the initial Gerrit patch. Do you have a clue?Lets handle the failing test via.New Gerrit change created:Gerrit changewas merged to [master].Commit:This test suite was crashing the Gerrit validation job. ReopeningI don't have the impression those specific tests are to blame. If you look at, it also fails with the same (absence of) error, but on another test suite.137 seems to mean that the process might have been killed by the OSNew Gerrit change created:Issue is, nothing seems related to this issue. Let's restore state and keep discussing onGerrit changewas merged to [master].Commit:	15.0
id=417142	REOPENED	Platform	UI	4.4	All All	P3 normal	Lars Vogel	2013-09-12 18:16 EDT by	Hendrik Still	2016-03-29 06:33 EDT (	2 users	The JFace Viewer JUnit tests should be updated to take use of the generic viewer api.	Pushed two commits:Another small one:I will mark this fixed as it looks like the bulk of the changes are done now.Reopening to bring this work into master.New Gerrit change created:	4.0
id=457134	REOPENED	Platform	Runtime	4.5	PC Linux	P3 normal	Lars Vogel	2015-01-09 06:45 EST by	Lars Vogel	2016-06-02 13:07 EDT (	4 users	Tom deprecated 2006 this interface. I suggest we mark it for deletion. Tom, please advice if that is OK for you. Marking it for deletion would allow us to remove if for Mars+2.	First step deprecate all fields and methods:(In reply to Lars Vogel from)Fine with me.(In reply to Lars Vogel from)Committed asTom, can you give the PMC flag or should I ask Dani?(In reply to Lars Vogel from)This lives with the Eclipse PMC.No, it would be Mars + 3. The 2 year retention policy is "inclusive":Note that the API is used at several places (mainly fallback code), so, someone will have to do some work here.New Gerrit change created:Gerrit changewas merged to [master].Commit:.The deletion date (after 2016) was wrong. We keep it for the next two releases. Fixed this to be 2017.(In reply to Dani Megert from)Thanks, as said in todays call I wasn't sure about the date.If you really want to remove things, you have to followIPlatformRunnable is currently not marked for deletion in the @deprecated message and with @no* tags.Furthermore, there are many references to this type in various components, and I don't see announcements for all the referencing APIs. See also.(In reply to Markus Keller from)I think process changes are only valid for new API deprecation and not stuff that happened in the past. Please open a new bug to align the code with the new requirements.Lars, two simple ways to fix this:1. Postpone deletion2. Add a comment to IPlatformRunnableWe will postpone this deletion (), and first resolve.	15.0
id=436505	REOPENED	Platform	UI	4.4	PC All	P3 normal	Lars Vogel	2014-06-03 15:19 EDT by	Lars Vogel	2016-09-28 10:13 EDT (	10 users	 	Follow up onNew Gerrit change created:Fine with me to remove them ... even if SWT announced removal "years ago" ... wouldn't hurt to re-announce, say on eclipse-dev? And be sure to upgrade migration guide (or, what ever the procedure it ... since some people may not migrate each release, but might move up to Neon, say ... from Kepler or something?Gerrit changewas merged to [master].Commit:.(In reply to David Williams from)It is part of our migration guide:New Gerrit change created:Gerrit changewas merged to [master].Commit:New Gerrit change created:Gerrit changewas merged to [master].Commit:Lars: After fixing, please make sure you also add API filters for the removed APIs in org.eclipse.jface and org.eclipse.ui. Unfortunately, those bundles re-export SWT, and hence they inherit the API breakages..I just checked out the current sources of Platform UI and Platform Runtime.There are now several compile errors in org.eclipse.core.tools of Platform Runtime regarding the missing TableTreeViewer.New Gerrit change created:Gerrit changewas merged to [master].Commit:(In reply to Dirk Fauth from)Looks like we are not building this plug-in anymore, hence we did not notice this breakage. Createdto update the plug-in.(In reply to Markus Keller from)Thanks Markus, should be fixed now. Marking this bug as fixed. Follow-up via.After the API filters for the removed types have been added, the problem about the major version increment is no longer reported (and that's good).The new API filters for the major version increment now create "unused" API filter warnings.Fixed withand also- added proper comments with bug #- removed other unused API filtersI'd like to re-open this, while we discuss community issues as raised in cross-project thread atCDT was affected by this change, seeandThis was not a difficult change because in was unused code in an internal package.I feel like this kind change is a bit dangerous in the Platform, in something as widely used as JFace. I think that jface should bump its major version and the best time for that would have been for Eclipse 4.0. But I understand that it's impossible to go back in time now and this would n... But I understand that it's impossible to go back in time now and there is some value in cleaning up some code even before Eclipse 5.0.(Sorry, I accidentally managed to hit TAB then space which sent an incomplete message by mistake)It looks to me like this removal did not follow the Eclipse Platform policy:1) It was deleted one year too early. The policy is that API is retained for two years after announcing the removal:So this should only be removed in the "O" release train. The removal announcement also has this wrong (should be the release *after* June 2016)2) I can't see any record of this change being announced on any mailing lists. A paragraph buried deep in our documentation is not a wide enough announcement for downstream consumers to be made aware of it. Here is the current removal process documentation:Which says eclipse-dev and cross-project-issues-dev should at minimum be notified.I think we are in agreement these classes will go back into Neon. Lars, Arun, can you say "when" ... for example, I am assuming we can get back in Monday night's 8 PM I-build? Please confirm. I'd also suggest that for M2, we not worry about adding back any related unit tests or "doc" (if there was any) just to minimize change (unless easier for you all to do "as a whole"?) And long term, adding junit's back may depend on if we ever plan to remove it (such as in Neon +1) or if we will decide to "keep it forever" (in which case, we'd just as well have JUnits, even if deprecated and "not supported"). Thanks all,I think platform.ui needs to wait one build cycles after SWT.I've reverted all 4 commits in SWT, so that we are in a clean state again (). That we needed 4 commits for a trivial deletion is not a good sign. Involved parties, please take note and improve this for the next time.If we decide to really delete TableTree,can just be reverted.David, can you start an I-build right now, so that Platform UI can revert the changes for this bug in a clean way before tonight's build?(In reply to Markus Keller from)Yes, schedule for 11:30 Eastern. (in 10 minutes!)New Gerrit change created:WARNING: this patchset contains 1236 new lines of code and may require a Contribution Questionnaire (CQ) if the author is not a committer on the project. Please see:(In reply to Eclipse Genie from)As a reminder, to get Gerrit "build one bundle" methods to "work" at this point in time, we'd need to change the related repo in parent pom (I assume still set to N-builds) and then force a republish of that parent pom. Or ... perhaps Lars will use the I-build in progress as his PDE target? :)David, I count on you or Markus to give me thumbs up to release the change.(In reply to Eclipse Genie from)Thanks Lars. In patch set 1, the code changes were good. But there were a few more commits in .api_filters files -- with the net effect that these files can be removed completely.Pushed patch set 2, which can be released as soon as the I-build is available.(I tookas a confirmation that we want to "play by the rules", i.e. only rely on APIs that were released in an I-build. We could also have pushed SWT and UI changes at the same time, but that would have left people without SWT from source in a broken state.)(In reply to John Arthorne from)More points of the process that were not followed:3) No compelling reason was given. If you look at the history of those classes, literally *nothing* had to be done to them -- so "maintenance cost" is hardly a reason.4) No anticipated impact on downstream clients was given. I don't even see an attempt to identify clients.5) Major bundle versions were not increased.In, I tried to justify the "cheating" w.r.t. the versioning guidelines, butactually says that deletions should always be considered a breaking change. As I argued, both solutions (breaking everybody for no good reason vs. silently breaking existing clients of the deleted API) are not satisfactory.We always told clients to set a tight upper bound on their dependency declaration. If we now start to break them repeatedly for no reason that affects them, they're just going to remove the upper bound and we're back to field one (no working version dependency story). And remember: This mostly affects well-written bundles that don't need a maintenance release every year.The best solution is to keep the bar for such deletions high. For the TableTree / TableTreeViewer deletions, that means: Don't do it, unless you can piggy-back on a breaking change that was really unavoidable.In the long term, it would be good to have different deprecation severities:- warning (what we have today): Please don't use me, but use this better way: [*]- error: This API will be removed soon! You need to remove your calls right away.(In reply to Lars Vogel from)The I-build completed, but I do not think it is correct. I think the version (qualifier) has to be increased, not left the same. The comparator log has SWT issues, where it appears the "old" bundles were "swapped in" to the build deliverables. (So, the JFace changes would likely fail as "table tree" not thre). Seefor example, 1. eclipse.platform.swt.binaries/bundles/org.eclipse.swt.gtk.linux.x86 no-classifier: different META-INF/ECLIPSE_.RSA: different META-INF/ECLIPSE_.SF: different org/eclipse/swt/custom/TableTree$1.class: not present in baseline org/eclipse/swt/custom/TableTree$2.class: not present in baseline org/eclipse/swt/custom/TableTree.class: not present in baseline org/eclipse/swt/custom/TableTreeEditor$1$1.class: not present in baseline org/eclipse/swt/custom/TableTreeEditor$1.class: not present in baseline org/eclipse/swt/custom/TableTreeEditor$2.class: not present in baseline org/eclipse/swt/custom/TableTreeEditor.class: not present in baseline org/eclipse/swt/custom/TableTreeItem.class: not present in baseline classifier-sources: different META-INF/ECLIPSE_.RSA: different META-INF/ECLIPSE_.SF: different org/eclipse/swt/custom/TableTree.java: not present in baseline org/eclipse/swt/custom/TableTreeEditor.java: not present in baseline org/eclipse/swt/custom/TableTreeItem.java: not present in baseline The main artifact has been replaced with the baseline version. The following attached artifacts have been replaced with the baseline version: [pack200, sources](In reply to Markus Keller from)You may do not see the other side of the fence. Whenever something does not move forward, I get feedback similar to "Eclipse is doomed as we cannot move forward" or "Doesn't make sense to work on this, if they still control everything" and I and other have to calm these people down. IMHO we have to find a balance, I personally like the approach to continue to deprecate and / or announce deletion (of course following the correct process). We can always decide not to delete, who knows what happens in 3 years.Gerrit changewas merged to [master].Commit:(In reply to David Williams from)Yup, looks like the SWT build input is not as automatic as I'd expected. I've bumped the forceContextQualifier in the /org.eclipse.swt/pom.xml now.Since it's getting late and this should really be in the test build, we will take the direct route now and try an I-build that contains both changes. SWT and UI repos have been updated.(In reply to Markus Keller from)As a potential "early warning", in my local test build (which, doesn't sign, so is faster, I did get this build failure below. I theory, in might be my "local setup", but ... hasn't been wrong yet (that I recall). We should know, in "official build" soon.). [INFO] {osgi.os=linux, osgi.ws=gtk, org.eclipse.update.install.features=true, osgi.arch=x86}[ERROR] Cannot resolve project dependencies:[ERROR] Software being installed: org.eclipse.equinox.sdk.product 4.6.0.qualifier[ERROR] Missing requirement for filter properties ~= $0: org.eclipse.swt 3.104.0.v20150914-1522 requires 'org.eclipse.swt.gtk.linux.x86 [3.104.0.v20150914-1522]' but it could not be found[ERROR] Cannot satisfy dependency: org.eclipse.equinox.p2.installer 1.0.400.v20150430-1836 depends on: bundle org.eclipse.swt 0.0.0[ERROR] Cannot satisfy dependency: org.eclipse.equinox.p2.sdk.feature.group 3.9.100.v20150907-2149 depends on: org.eclipse.equinox.p2.installer [1.0.400.v20150430-1836][ERROR] Cannot satisfy dependency: org.eclipse.equinox.sdk.product 4.6.0.qualifier depends on: org.eclipse.equinox.p2.sdk.feature.group 0.0.0(In reply to David Williams from)Well, maybe this is a first :) ... not so much with setup, but I see some "platform UI" changes cam in after I started my test build, so I may have simply started "too early" and not all changes were in yet?(In reply to David Williams from)I was wrong about being wrong. :) Production build failed in same way, and Markus said he missed some updates in "swt binary repo" (I assume there's a string qualifier in there too?) So, will try another test build, but this time, since it is near 8 PM, will just try a 'test build" on build machine ... no unit tests, and no tagging. But will report back here if it succeeds or fails.(In reply to David Williams from)The "build machine only" test build completed without errors, and without "comparator errors".New Gerrit change created:Note that this won't work out because the API Removal Process is inherently broken, see.New Gerrit change created:ColorCellEditor and OpenStrategy classes have code like if (var instanceof TableTree) {dosmth;}. I think it is fine do remove these leaves now . It's not API change although it's behavior change for people using TableTree but as removal is planned it would serve as fine warning.Gerrit changewas merged to [master].Commit:New Gerrit change created:New Gerrit change created:New Gerrit change created:Gerrit changewas merged to [master].Commit:	48.0
id=457214	REOPENED	Platform	UI	4.5	PC All	P3 normal	Lars Vogel	2015-01-12 03:03 EST by	Lars Vogel	2016-03-30 15:32 EDT (	6 users	ToolBarManager contains a logic to turn of redraw if the toolbar entries are above a certain limit. I think we should remove the logic because it makes the code a bit more complex and I see no advantage of not doing it for a small number of items.SeeLine 304boolean useRedraw = (clean.size() - (mi.length - toRemove.size())) >= 3;	Andrey, what do you think?(In reply to Lars Vogel from)You mean we should always set setRedraw(false) before starting TB manipulations?I have no experience in that area, no idea if this can cause any regression.But BTW I've seen Paul had some bugs related to the non-refreshing toolbar buttons - might be this is somehow related?(In reply to Andrey Loskutov from)Maybe. Could you find the bug numbers?SeeNew Gerrit change created:New Gerrit change created:(In reply to Eclipse Genie from)Sorry, forgot to press ammend commit. Correct one isGerrit changewas merged to [master].Commit:Fixed. Seefor more work here.Createdintroduced rendering problemThe last commit has the side effect that simple trim widgets (like) registered via the org.eclipse.ui.menus extension point were no more rendered correctly.If I remove the last commit everything looks fine. I have attached a screenshot that shows the rendering problem in our RCP application.(In reply to Dominik G. from)Which platform? Please attach an example RCP application which demonstrates the problem.CreatedSample RCP ProductI have attached a sample product that has two trim widgets. One in the main toolbar that has a text control and one in the status line that has a combo control.My platform is Windows 7 (64bit), Java 8 (64bit), eclipse 4.5RC1.CreatedSample RCP ProductI am seeing the same regression on Windows 7 with an Eclipse (IDE) plugin on Mars.1 that used to work correctly on Kepler. With this change, our trim bar control contribution gets a fixed height of 7 pixels, which makes it unusable. Reverting this change returns it to the previous fixed height of 22 pixels (which is not ideal either, but acceptable).Since the change looks reasonable, it seems like this might only have worked by chance before. However, I have not been able to figure out where the 7 pixels come from that appear to be caused by the additional WM_SETREDRAW Windows messages caused by this change. I am wondering why the SWT ToolBar is implemented using a Win32 Toolbar at all, as that just seems to result in a whole bunch of quirks and limitations.	14.0
id=460987	REOPENED	Platform	UI	4.5	PC Linux	P3 trivial	Lars Vogel	2015-02-26 15:03 EST by	Lars Vogel	2016-04-06 01:29 EDT (	1 user	I tend to copy this snippet, so I would like to use a more generic parameter name.	New Gerrit change created:Gerrit changewas merged to [master].Commit:.New Gerrit change created:Gerrit changewas merged to [master].Commit:This breaks the build, reverted.	6.0
id=463268	REOPENED	PDE	UI	4.5	PC Linux	P3 normal	Lars Vogel	2015-03-27 05:14 EDT by	Lars Vogel	2015-04-22 09:44 EDT (	3 users	Similar tobut for PDE.	New Gerrit change created:Gerrit changewas merged to [master].Commit:See previous comment for commit id.Reverted via commitI prefer the old structure. Searching in nested projects would be confusing and slow.	4.0
id=464271	REOPENED	Platform	UI	4.5	PC Linux	P3 normal	Lars Vogel	2015-04-09 05:56 EDT by	Mat Booth	2016-03-30 15:30 EDT (	6 users	Hamcrest 1.3 has been in orbit for a long time -- we should use the latest version available -- and we only need the "core" APIs so we should require "org.hamcrest.core" instead of "org.hamcrest"Patch to follow.	CreatedPatchWell, a patch *was* going to follow but my Eclipse CLA expired today and although I have re-signed it, I am still not able to push to gerrit.See attached for the patch I want to submit.If I need an "officially" valid CLA before you take this patch, please block onNew Gerrit change created:(In reply to Eclipse Genie from)Finally I can submit changes again :-)David, FYI, in case this causes issues in releng.Gerrit changewas merged to [master].Commit:Thanks Mat, now in master.(In reply to Lars Vogel from)As long as it matches eclipse-sdk-prereqs.targetand, vague memory the test frame work itself packages it (but, it may just be the feature picks up "0.0.0" match). [And, as always ... I wonder if anyone opened a CQ for "1.3"? :) ... even though obviously from orbit, so would be "ok", as far as I know, the rules are we still need to track.New Gerrit change created:Gerrit changewas merged to [master].Commit:(In reply to David Williams from)Yes, eclipse-sdk-prereqs already contains:<unit id="org.hamcrest.core" version="1.3.0.v201303031735"/>And your memory serves you well here too :-)So what needs to happen then?Looking at IPzilla, I see things like this:Do we need to open a ticket like that for platform.ui?I am new to the CQ process.(In reply to David Williams from)Thanks for the reminder, reverted and openedIn looking through some CQ, I was reminded that JUnit depends on hamcrest 1.1 (not sure if that's an embedded library, or depends on the 1.1 bundle0 AND not sure if hamcrest is a "singleton" (either literally, or "in practice" for bundles that work together)? Adding Markus to CC. Markus, I think it was you that knows about JUnit and Hamcrest? If not, perhaps you know who?The Eclipse SDK currently ships JUnit 4.11, which already depends on Hamcrest 1.3.I remember there were issues with Mockito, which depended on Hamcrest 1.1 and didn't work with Hamcrest 1.3 (due to breaking API changes in Hamcrest). I don't know at what state Mockito is nor whether these problems have been solved in the mean time (I don't use Mockito).New Gerrit change created:Seefor the issues with Mockito. I have no problem with requiring hamcrest core 1.3 in test bundles if it actually works.(In reply to Lars Vogel from)I've closed that CQ. We always considered the JUnit and Hamcrest CQs for JDT as being enough for the Platform and SDK, i.e. no separate CQs. We include both bundles in our SDK and Platform test features.Gerrit changewas merged to [master].Commit:Thanks Dani for the clarification and Mat for the patch.(In reply to Eclipse Genie from)Can it be that this commit caused UI tests not running anymore:java.lang.Exception: Could not find plugin "org.eclipse.ui.tests" org.eclipse.test.EclipseTestRunner$TestFailedException: java.lang.Exception: Could not find plugin "org.eclipse.ui.tests"at org.eclipse.test.EclipseTestRunner.runFailed(EclipseTestRunner.java:622)at org.eclipse.test.EclipseTestRunner.getTest(EclipseTestRunner.java:551)at org.eclipse.test.EclipseTestRunner.<init>(EclipseTestRunner.java:534)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:317)at org.eclipse.test.UITestApplication$2.run(UITestApplication.java:197)(In reply to Andrey Loskutov from)Thanks Andrey, this might be related. I asked on the releng mailing list for clarification.Ah, so Mockito is problematic.Although Mockito claims to require org.hamcrest [1.1,2.0) and hamcrest 1.3 claims to export org.hamcrest 1.3 -- this is not working.There must be some magic supplied by the org.hamcrest_1.1.0 bundle (the one that contains no code, just re-exports other hamcrest bundles) to make this work. (Just when I think I start to understand OSGi!)There is no equivilent bundle in orbit for hamcrest 1.3 so I guess this needs to be reverted.I really wish to stop shipping out-dated deps so I will think harder about this.Sorry for the noise.If you migrate to newer mockito (1.9.5) from Orbit, this bundle contains the necessary hamcrest packages.(In reply to Mickael Istria from)Replacing require-bundle with import-package might also do the trick.New Gerrit change created:Gerrit changewas merged to [master].Commit:(In reply to Eclipse Genie from)This change was breaking the text run, reverted (again) as suggested via the releng mailing list.So, was reverted? Should this be re-opened? Or, is it really fixed now? FYI, I looked for this bug, because by chance I ran across this Orbit bug that *might* be related. Probably not, but wanted to make you aware of it:- A suggestion to provide a complete Hamcrest implementation or remove it completely(In reply to David Williams from)Yes, yes, no.Mat, any plans to fix this for M7 or shall we retarget it for 4.6?	31.0
id=476404	REOPENED	Platform	UI	3.7.1	PC Windows 7	P3 normal	Lars Vogel	2015-09-02 05:09 EDT by	Lars Vogel	2016-03-29 11:06 EDT (	7 users	+++ This bug was initially created as a clone of+++From the bug:The summary of APIs I think we should mark for future deletion:Entire packages:org.eclipse.core.bootorg.eclipse.core.runtime.modelorg.eclipse.ui.presentationsMethods: - Platform#addAuthorizationInfo - Platform#getAuthorizationInfo - Platform#flushAuthorizationInfo - Platform#addProtectionSpace - Platform#getProtectionSpaceThese are all cases of API that are no longer functional in 4.2.	New Gerrit change created:Gerrit changewas merged to [master].Commit:.New Gerrit change created:Gerrit changewas merged to [master].Commit:Reverted since it broke our build.	6.0
id=468487	REOPENED	JDT	UI	4.5	All All	P3 enhancement	Lars Vogel	2015-05-27 10:44 EDT by	Lars Vogel	2016-10-25 05:23 EDT (	6 users	I think it makes sense to add the info how to build the JDT plug-ins via Maven Tycho. Gerrit review on its way.	New Gerrit change created:Dani, what do you think?Everyone who uses Maven should know those and all others should use Gerrit and let it build - and test - the stuff for them. In addition, it's not a must to use Maven. One could still use PDE Build if desired.(In reply to Dani Megert from)The -build-individual-bundles profile is specific to Eclipse and unfortunately not easy to find. A normal Maven build "mvn clean verify" will fail without this profile. IMHO adding a short section to a Readme file does not harm. Please reconsider.(In reply to Lars Vogel from)I might reconsider if we (speak: every single repo) can point to a wiki page where the build process is described and can be adapted when things change over time. That page should also contain instructions for beginners, which never used the mvn command before.I hope you don't mind me chiming in.A big +1 from me for adding this info to the readme. This would have saved me a considerable amount of time last night, trying to analyze a JDT bug and having to fight the build first before getting to my actual issue.As Lars is saying, Maven users won't know by default about any specific profiles that need to be enabled, so providing this info will make things much easier for them.Actually much better would be to make "mvn clean install/verify" workable, because that's really the expectation Maven users have. Not sure what's needed for that, maybe that profile could just be enabled by default?I don't see how such wiki page is related (as nice as it may be), why should the ease-of-use for potential contributors not improved for a single repo? Actually I found the solution in a stack overflow answer, how much better it would be to have the answer right there where it is needed.(In reply to Gunnar Morling from)Noopur, could you merge this for M3? As new component lead I hope you will continue to make contributions to JDT UI easier.shows the current stats.(In reply to Gunnar Morling from)+1. This should be the correct approach for all Eclipse projects. Lars, could you please check if someone can provide a patch for this?In the meantime:(In reply to Dani Megert from)+1. We should have a common wiki page which mentions this and we can add a link to this page in the readme files from individual Eclipse projects so that it is easier to maintain the changes over time. Patch for this is welcome if the first approach is not feasible at the moment.	8.0
id=467028	REOPENED	Platform	UI	4.5	All All	P3 enhancement	Lars Vogel	2015-05-11 15:07 EDT by	Thomas Schindl	2017-02-20 10:16 EST (	10 users	Iwe tracked that all stuff we require from javax.xml is provided by the JRE and we should get rid of this old javax.xml stuff and directly use the JRE provided versions.To use the JRE versions all imports who bind to javax.xml should be changed to unversioned imports and javax.xml should not be delivered by the Platform anymore.	+1 HurraNew Gerrit change created:Dani, Do we need some announcement before removing bundles from the platform? I fully agree we should remove the javax.xml bundles, but I think our policies require some notice to the community.Also, this patch removes the bundle from the feature. I assume all the require-bundle: javax.xml have been adjusted to import-package. Keep in mind all third-party plugins would need to do the same so that is why I think we need to make advanced notice to the community before doing this.(In reply to Thomas Watson from)Well, first you need to get PMC approval explaining why this is necessary after the API freeze. Send a note to the pmc-list if you really want to do this for 4.6. Personally I'd prefer 4.7.I know that WTP was using javax.xml (IIRC through Xerces?)Mass move to 4.6 RC1. We might push out more to 4.7.IMHO, it's the right time to give a try to that removal. For 4.7, all dependent projects will have time to react and if it's causing an issue, it will be noticed by Simrel Oxygen RC3.@Thomas: can you take care of sending the note to PMC and of the "administrative" part of that change?Unfortunately no - I'm currently not able to put time into Eclipse Platform stuff.I suggest to remove the javax.xml early M5 so that project have time to react.Tom suggested that this should be decided by the PMC. I add this to our next call.Just as a side note - e(fx)clipse RCP application run with a javax.xml replacement who delegates to the JRE without ANY problems!(In reply to Thomas Schindl from)Thanks, that's good news.I'm +1 to remove it, but first you have to announce this on the cross-project-issues-dev mailing list where you explain what will happen and detailed instructions what the projects have to do. I suggest you do this asap and announce the deletion for M6. Once the message is sent, I'll give the PMC approval on this bug.Together with the deletion you also have to add an entry to the migration guide.If you want to fix this for 4.7, you need to act now.(In reply to Dani Megert from)Eamil to crossI suggest to wait a week and then go ahead.(In reply to Dani Megert from)+1.Gerrit changewas merged to [master].Commit:This is not done yet.From:"Together with the deletion you also have to add an entry to the migration guide."And it needs an N&N entry.I just updated my Oxygen installation and face an issue with this change.!MESSAGE Could not resolve module: org.eclipse.e4.ui.css.swt.theme [33] Unresolved requirement: Require-Bundle: org.eclipse.e4.ui.css.swt; bundle-version="0.9.1" -> Bundle-SymbolicName: org.eclipse.e4.ui.css.swt; bundle-version="0.13.0.qualifier"; singleton:="true" org.eclipse.e4.ui.css.swt [32] Unresolved requirement: Require-Bundle: org.eclipse.e4.ui.css.core; bundle-version="0.9.0" -> Bundle-SymbolicName: org.eclipse.e4.ui.css.core; bundle-version="0.12.100.qualifier"; singleton:="true" org.eclipse.e4.ui.css.core [31] Unresolved requirement: Import-Package: org.w3c.dom.css; version="2.0.0"javax.xml also provides the org.w3c.dom.css package in version 2.0.0. Which bundle provides this package now? There is a bundle dependency but it seems to be not provided by the JRE. At least my application is not starting anymore. Any hints?OK, the org.w3c.dom.css and org.w3c.dom.stylesheets bundle is also provided by the JRE. But there we don't have a version constraint.So the dependencies in org.eclipse.e4.ui.css.core needs to be modified. The version constraints on the package imports need to be removed in order to make it work again.New Gerrit change created:I'm not sure but it looks like the same issue applies to some Equinox bundles. At least I get some warnings for org.eclipse.equinox.registry where the javax.xml packages are specified with a 0.0.0 version constraint.The warning is raised by PDE if I start with the -console parameter. Not sure how this is related. But it looks like some additional checks need to be done in Equinox aswell.(In reply to Dirk Fauth from)What does the warning say? The org.eclipse.equinox.registry already imports the xml packages with no version constraint.I think the problem is PDE who is not smart enough to find out what JRE/JDK you try to run on, hence it does not find out that javax.xml is part of the JRE (same is true for the Target-Platform UI) because the Java8 EE contains it.In e(fx)clipse we ship an EMPTY java.xml bundle to satisfy PDE in both cases!(In reply to Thomas Schindl from)When you mentioned this it made me think the issue is because equinox.registry still claims it supports J2SE-1.4 BREE (something I think needs to be updated at some point). But the required xml packages are available on J2SE-1.4. So PDE should not complain here about that missing.Createdwarning screenshotI get this validation error on starting. Interestingly org.eclipse.equinox.registry starts and is in ACTIVE state. So it seems to be a PDE issue.(In reply to Dirk Fauth from)What is interesting here is that only the org.eclipse.equinox.registry has the issue. My understanding is many other bundles in your testing import the xml packages in the same way. This brings me back to suspecting something is going wrong with the BREE being J2SE-1.4 while I suspect all the other bundles are at a much later BREE.If I recall correctly there is a PDEState object that is used to validate the set of bundles for launch. In that state it is supposed to be loaded with all the supported execution environments by calling:org.eclipse.osgi.service.resolver.State.setPlatformProperties(Dictionary<?, ?>[])Where each Dictionary represents a supported execution environment. One of the properties in the dictionary is supposed to contain the available packages for the execution environment ("org.osgi.framework.system.packages"). Perhaps somewhere along the way the java profile for J2SE-1.4 is losing this information for the PDEState.Gerrit changewas merged to [master].Commit:(In reply to Thomas Watson from)I suggest to open a separate bug against PDE.(In reply to Dirk Fauth from)I also got this with I20170219-2000. If you disregard it, it seems to start without issues though.(In reply to Dani Megert from)DoneAs a related note, I noticed because of this change that org.apache.xerces also "requires bundle" javax.xml. So eventually it could be good for Orbit to go through a similar removal process.Because our product (Trace Compass) includes some Web Tools dependencies that depend on org.apache.xerces, we also have to make sure javax.xml is included. I'm not sure if it will affect some EPPs but I thought I'd mention it.	32.0
id=477409	REOPENED	Platform	Resources	4.5	PC Linux	P3 normal	Lars Vogel	2015-09-14 17:14 EDT by	Lars Vogel	2016-12-08 22:23 EST (	3 users	 	New Gerrit change created:Gerrit changewas merged to [master].Commit:I think this one is fixed. Sergej, please reopen if you still plan to do more work here.I don't think this bug should be closed. org.eclipse.core.internal.utils.Policy.subMonitorFor(IProgressMonitor, int) returns SubProgressMonitor and this method is called in 156 places. I don't have near future plans to work on this, but will gladly review patches in Gerrit reducing number of places where Policy.subMonitorFor is called..New Gerrit change created:New Gerrit change created:Gerrit changewas merged to [master].Commit:Gerrit changewas merged to [master].Commit:New Gerrit change created:New Gerrit change created:New Gerrit change created:Gerrit changewas merged to [master].Commit:Gerrit changewas merged to [master].Commit:Gerrit changewas merged to [master].Commit:	14.0
id=482012	REOPENED	e4	Tools	unspecified	PC Linux	P3 normal	Lars Vogel	2015-11-12 09:01 EST by	Lars Vogel	2016-09-16 10:38 EDT (	1 user	To allow to use the foreach closure.	New Gerrit change created:Gerrit changewas merged to [master].Commit:New Gerrit change created:Gerrit changewas merged to [master].Commit:.Several spies are still on Java 6.New Gerrit change created:New Gerrit change created:Gerrit changewas merged to [master].Commit:Gerrit changewas merged to [master].Commit:	10.0
id=485640	REOPENED	Platform	Releng	4.3	PC Linux	P3 normal	Lars Vogel	2016-01-12 06:48 EST by	Lars Vogel	2016-03-22 12:09 EDT (	4 users	 	New Gerrit change created:I am not sure being empty is sufficient reason to remove it. Sometimes Interfaces are "marker interfaces" and it's mere presence is enough to trigger early startup. Do you know?(In reply to David Williams from)I have worked on the EaryStartup code in Platform UI and this code in releng should be save to remove.Did you test it? I did, and the function no longer works. I tested by simply turning off the preference. So maybe we both learned something?(In reply to David Williams from)Reopening the bug so that I can investigated. Sounds like this early Startup extension is used as "dirty" trick to enforce plug-in activation.Adding Michael to CC. Michael, I think it was you that wrote the "pom checker", right? Added you to CC in case you care to comment.I'm pretty sure Curtis did, CC'ing himNot much I can add here. I don't believe I had to hack anything to get the plug-in to activate at start up. The tool was originally part of PDE but we decided to move it to releng tools as it was really only helpful for the committers, not the community as a whole.	8.0
id=478598	REOPENED	Platform	Releng	4.5	PC Linux	P3 normal	Lars Vogel	2015-09-29 04:07 EDT by	Lars Vogel	2015-10-19 08:41 EDT (	3 users	See.	I don't see it, so far, in org.eclipse.test. Can you be more specific?From what I have loaded ... I see org.eclipse.core.runtime.compatibilityonly in org.eclipse.equinox.commonSo, adding Tom to CC. Tom, any reason it's still in equinox.common?And, I should mention, it is *possible* in an actual build, it's still being included, by some magic of "comparator" swapping out some current bundle/feature for a previously built one ... though, seems that'd be rare, for this case.(In reply to David Williams from)Looks like I had an old status in my worksapce. Looks like b7f4c4295be955a5520c9bcdd4cef8aded059d81 fixed that.(In reply to David Williams from)Are you referring to the x-friends in Export-Package:Export-Package: org.eclipse.core.internal.boot;x-friends:="org.eclipse.core.resources,org.eclipse.core.runtime.compatibility,org.eclipse.pde.build"We can certainly remove that, but it does not hurt to keep it as a friend for now. Are we completely removing the runtime.compatibility bundle and never building it now? Is there a possibility that some product could decide to build and install the bundle themselves?(In reply to Thomas Watson from)Yes, it has already been deleted from Git.If they do, they still can do this even without the x-friend entry.Retargeting org.eclipse.equinox.common(In reply to Lars Vogel from)I assume the x-friend entry is there because the runtime.compatibility bundle uses this internal package from common. Removing the x-friend means it potentially will not have access to the internal common package.To be honest, yes, "x-friends" is what I initially saw, and agree, that does not harm (if someone "mixes and matches"?) But, looking at it again, I see it also has org.eclipse.core.runtime.compatibility,in the "export packages" list? Not sure how that works, exactly, but will leave up to you, if that is a "false contract", or ... something that is harmless?(In reply to David Williams from)Oh, wait, I see, that second time too, I think, is just a bit long x-friends list. So, I think fine the way it is, if you want to leave that bundle "backwards compatible". Still not sure, Lars, what you were seeing that made you open this to begin with.(In reply to Thomas Watson from)x-friends without specified plug-in behaves like x-internal, so removing the listed plug-in should be fine. For very long I also misunderstood the x-friends flag as "only accessible for friends" but that is not true. It only means no discouraged access warning for the x-friends.(In reply to Lars Vogel from)I'm not sure why I am continuing to debate here, since I am fine if we remove the x-friends for the compatibility bundle. but ... ;-)In the past the framework could actually be launched in 'strict' mode. When in strict mode bundles could not get runtime access to things that are x-internal or things that are x-friends for which you are no friend for.As of Luna I dropped support for strict mode so that argument is not very strong, but that is what I meant above by stating "it potentially will not have access to the internal common package". Potentially meaning, if we re-implement the 'strict' mode again at runtime.(In reply to Thomas Watson from)Oh sorry, I thought you set the bug to INVALID, but looking at the history I see David did this. I upload a Gerrit review for the change so that you can release it.Thanks for the info. I did not know that Equinox dropped strict mode, I usually tell my customers that "nobody I know of uses this mode", now I know the reason for that. :-)(In reply to Thomas Watson from)So ... where do we stand, here? Tom, it seems like you are saying "if we bring back strict mode" (seems unlikely?) and "if we bring back compatiblity bundles" (seems even less likely), then you would not have to re-add these "friends" relationships. To me, seems little advantage to leaving them in. And to me, the advantage of removing them, is then if/when we do "searches" for "are they still used anywhere" we do not get spurious matches.As I have said, I am fine removing the x-friends. I was just trying to clear up some of the confusion between what x-internal and x-friends means.	15.0
id=489921	REOPENED	Platform	Releng	4.5	PC Linux	P3 normal	Lars Vogel	2016-03-18 06:53 EDT by	Lars Vogel	2017-01-20 04:47 EST (	3 users	Seeandfor background information. Quote:If a new Integer instance is not required, this method should generally be used in preference to the constructor Integer(int), as this method is likely to yield significantly better space and time performance by caching frequently requested values.	New Gerrit change created:For explanation of 'won't fix" see 489986.I learned that new Integer() will be deprecated in Java 9. So we should definitely replace there usage.SeeHi Lars,Can you please complete this by M5. otherwise can you retarget to next milestone?ThanksSravanRetargetting to 4.7.	5.0
id=505364	REOPENED	Platform	UI	4.6	PC Linux	P3 normal	Lars Vogel	2016-10-07 08:24 EDT by	Lars Vogel	2017-02-09 10:08 EST (	2 users	 	New Gerrit change created:Gerrit changewas merged to [master].Commit:This change breaks my (and other) plugins, at least in one place.The change from getNamespace() -> getNamespaceIdentifier() is not equivalent and can't be used as 1:1 replacement of the old API, especially if the old "deprecated" code delegates to getContributor().getName() and NOT to getNamespaceIdentifier().So the change for example in org.eclipse.ui.internal.ActionDescriptor is bad and causes plugin images not be found, because instead of the plugin id of the contribution the *action extension* id is used to lookup images:String extendingPluginId = actionElement.getDeclaringExtension() .getNamespace();was changed to String extendingPluginId = actionElement.getDeclaringExtension() .getNamespaceIdentifier();but should be:actionElement.getDeclaringExtension() .getContributor().getName()You can see the bad result by cloningand opening "Data Hierarchy" view in the target Eclipse. The view toolbar contains no icons but textual buttons.I'm going to revert the commit now to fix the broken code.If you wish to remove the deprecated stuff, create another one where getNamespace() would be replaced with getContributor().getName().New Gerrit change created:Gerrit changewas merged to [master].Commit:	5.0
id=485666	REOPENED	Platform	Releng	4.3	PC Linux	P3 normal	Lars Vogel	2016-01-12 09:48 EST by	Lars Vogel	2016-11-22 10:18 EST (	2 users	These folder should not necessary anymore, see	***has been marked as a duplicate of this bug. ***New Gerrit change created:Some of the files in the Gerrit patch can be removed, but I am not sure all of them can be. One I noticed is feature.properties for the platform source template. It has a "Name" of something like "...Platform... Developer Resources". If we remove it, then the name of the "source feature" would be simply "... Platform ... Source". I don't think those are semantically the same. Am I missing something?There's certainly some files that can be removed, but it would be incorrect to do a wholesale removal of sourceTemplateFeature. SeeFWIW, I have learned, even without anything special, that source *features* get the name suffixed with "Developer Resources" (just like we do) not "Source" as I thought. So if that exact name is the only reason we have "sourceTemplateFeature" then those could probably be removed and would not effect the build results.That David for the follow up. Reopening based on your comment.	6.0
id=489985	REOPENED	Platform	Releng	4.5	PC Linux	P3 normal	Lars Vogel	2016-03-19 01:43 EDT by	Lars Vogel	2016-11-08 11:58 EST (	2 users	Seeandfor background information. Quote:If a new Integer instance is not required, this method should generally be used in preference to the constructor Integer(int), as this method is likely to yield significantly better space and time performance by caching frequently requested values.	New Gerrit change created:For explanation of 'won't fix" see 489986.I learned that new Integer() will be deprecated in Java 9. So we should definitely replace there usage.See	3.0
id=490658	REOPENED	Platform	UI	4.4	PC Linux	P3 normal	Lars Vogel	2016-03-30 03:33 EDT by	Lars Vogel	2016-03-31 06:29 EDT (	3 users	 	New Gerrit change created:Gerrit changewas merged to [master].Commit:Hi Lars, I would prefer to revert and defer to 4.7 as this creates ripples throughout the SDK, see compile logs:(In reply to Dani Megert from)and lots of clients.New Gerrit change created:Gerrit changewas merged to [master].Commit:(In reply to Dani Megert from)+1Change was reverted and I marked this bug for 4.7.Filedfor the missing entry in the API freeze report.	8.0
id=501418	REOPENED	e4	UI	unspecified	PC Linux	P3 normal	Lars Vogel	2016-09-14 08:58 EDT by	Lars Vogel	2016-10-31 12:25 EDT (	1 user	 	New Gerrit change created:Gerrit changewas merged to [master].Commit:New Gerrit change created:Gerrit changewas merged to [master].Commit:Looks like the e4 tools are still build against an older version of Eclipse.	5.0
id=509086	REOPENED	Platform	SWT	4.4	PC Linux	P3 normal	Lars Vogel	2016-12-12 10:08 EST by	Lars Vogel	2017-02-16 05:49 EST (	3 users	 	New Gerrit change created:New Gerrit change created:New Gerrit change created:Which one of the last 2 gerrit patches is for review? Please abandon the unneeded one.Gerrit changewas merged to [master].Commit:Gerrit changewas merged to [master].Commit:Is there still work you plan in this bug?Resolving the bug. Please open new one if/when you plan additional work.I will do the rest of the conversion.	9.0
id=508734	REOPENED	Platform	UI	4.7	All All	P3 major	Lars Vogel	2016-12-06 06:12 EST by	Sravan Kumar Lakkimsetti	2017-01-23 11:45 EST (	4 users	During the execution of jdeps -jdkinternals I found we are using a third party library obj.objenesis. This uses jdk internal api.. So we need to either upgrade or remove completely. You can see the jdeps -jdkinternals report hereMy quick search identified references in platform.ui set up scripts. I am guessing this was used earlier but dropped now. If platform ui team can clear the references, we can remove the references from prereqs as well	New Gerrit change created:Gerrit changewas merged to [master].Commit:I did not verify who still has a reference on objenesis, but the report still complains in I20161211-2000:(In reply to Dani Megert from)#jdeps -jdkinternals output:org.objenesis_1.0.0.v201505121915.jar -> /opt/public/common/jdk1.8.0_102.x64/jre/lib/rt.jar org.objenesis.instantiator.sun.SunReflectionFactoryInstantiator (org.objenesis_1.0.0.v201505121915.jar) -> sun.reflect.ReflectionFactory JDK internal API (rt.jar) org.objenesis.instantiator.sun.SunReflectionFactorySerializationInstantiator (org.objenesis_1.0.0.v201505121915.jar) -> sun.reflect.ReflectionFactory JDK internal API (rt.jar)Sravan, how is this log generated? I mean, on which jars/directories it is running - on *all* included into SDK?Why do we think this is platform UI related?On 4.6 aggregator (I have not 4.7 right now) I see following:cd eclipse.platform.releng.aggregatorfor D in */; do [ -d "${D}" ] && (cd ${D}; pwd; git grep objenesis) ; done/data/4x_platform/eclipse.platform.releng.aggregator/eclipse-platform-parent/data/4x_platform/eclipse.platform.releng.aggregator/eclipse.jdt.core.binaries/data/4x_platform/eclipse.platform.releng.aggregator/eclipse.jdt.core/data/4x_platform/eclipse.platform.releng.aggregator/eclipse.jdt.debug/data/4x_platform/eclipse.platform.releng.aggregator/eclipse.jdt.ui/data/4x_platform/eclipse.platform.releng.aggregator/eclipse.jdt/data/4x_platform/eclipse.platform.releng.aggregator/eclipse.pde.build/data/4x_platform/eclipse.platform.releng.aggregator/eclipse.pde.ui/data/4x_platform/eclipse.platform.releng.aggregator/eclipse.platform.common/data/4x_platform/eclipse.platform.releng.aggregator/eclipse.platform.debug/data/4x_platform/eclipse.platform.releng.aggregator/eclipse.platform.releng.prereqs.sdkeclipse-sdk-prereqs.target: <unit id="org.objenesis" version="1.0.0.v201505121915"/>/data/4x_platform/eclipse.platform.releng.aggregator/eclipse.platform.releng.tychoeclipsebuildereclipse.platform.repository/workbenchTest/saveStandards/testInputcontent.xml:<unit id="org.objenesis" version="1.0.0.v201505121915" singleton="false">eclipse.platform.repository/workbenchTest/saveStandards/testInputcontent.xml:<update id="org.objenesis" range="[0.0.0,1.0.0.v201505121915)" severity="0"/>eclipse.platform.repository/workbenchTest/saveStandards/testInputcontent.xml:<provided namespace="org.eclipse.equinox.p2.iu" name="org.objenesis" version="1.0.0.v201505121915"/>eclipse.platform.repository/workbenchTest/saveStandards/testInputcontent.xml:<provided namespace="osgi.bundle" name="org.objenesis" version="1.0.0.v201505121915"/>eclipse.platform.repository/workbenchTest/saveStandards/testInputcontent.xml:<provided namespace="java.package" name="org.objenesis" version="1.0.0"/>eclipse.platform.repository/workbenchTest/saveStandards/testInputcontent.xml:<provided namespace="java.package" name="org.objenesis.instantiator" version="1.0.0"/>eclipse.platform.repository/workbenchTest/saveStandards/testInputcontent.xml:<provided namespace="java.package" name="org.objenesis.instantiator.basic" version="1.0.0"/>eclipse.platform.repository/workbenchTest/saveStandards/testInputcontent.xml:<provided namespace="java.package" name="org.objenesis.instantiator.gcj" version="1.0.0"/>eclipse.platform.repository/workbenchTest/saveStandards/testInputcontent.xml:<provided namespace="java.package" name="org.objenesis.instantiator.sun" version="1.0.0"/>eclipse.platform.repository/workbenchTest/saveStandards/testInputcontent.xml:<provided namespace="java.package" name="org.objenesis.strategy" version="1.0.0"/>eclipse.platform.repository/workbenchTest/saveStandards/testInputcontent.xml:<artifact classifier="osgi.bundle" id="org.objenesis" version="1.0.0.v201505121915"/>eclipse.platform.repository/workbenchTest/saveStandards/testInputcontent.xml: Bundle-SymbolicName: org.objenesiseclipse.platform.repository/workbenchTest/saveStandards/testInputcontent.xml:<required namespace="org.eclipse.equinox.p2.iu" name="org.objenesis" range="[1.0.0.v201505121915,1.0.0.v201505121915]"/>eclipse.platform.repository/workbenchTest/saveStandards/testInputcontent.xml:<required namespace="java.package" name="org.objenesis" range="[1.0.0,2.0.0)"/>eclipse.platform.repository/workbenchTest/saveStandards/testOutputcontent.xml:<unit id="org.objenesis" version="1.0.0.v201505121915" singleton="false">eclipse.platform.repository/workbenchTest/saveStandards/testOutputcontent.xml:<update id="org.objenesis" range="[0.0.0,1.0.0.v201505121915)" severity="0"/>eclipse.platform.repository/workbenchTest/saveStandards/testOutputcontent.xml:<provided namespace="org.eclipse.equinox.p2.iu" name="org.objenesis" version="1.0.0.v201505121915"/>eclipse.platform.repository/workbenchTest/saveStandards/testOutputcontent.xml:<provided namespace="osgi.bundle" name="org.objenesis" version="1.0.0.v201505121915"/>eclipse.platform.repository/workbenchTest/saveStandards/testOutputcontent.xml:<provided namespace="java.package" name="org.objenesis" version="1.0.0"/>eclipse.platform.repository/workbenchTest/saveStandards/testOutputcontent.xml:<provided namespace="java.package" name="org.objenesis.instantiator" version="1.0.0"/>eclipse.platform.repository/workbenchTest/saveStandards/testOutputcontent.xml:<provided namespace="java.package" name="org.objenesis.instantiator.basic" version="1.0.0"/>eclipse.platform.repository/workbenchTest/saveStandards/testOutputcontent.xml:<provided namespace="java.package" name="org.objenesis.instantiator.gcj" version="1.0.0"/>eclipse.platform.repository/workbenchTest/saveStandards/testOutputcontent.xml:<provided namespace="java.package" name="org.objenesis.instantiator.sun" version="1.0.0"/>eclipse.platform.repository/workbenchTest/saveStandards/testOutputcontent.xml:<provided namespace="java.package" name="org.objenesis.strategy" version="1.0.0"/>eclipse.platform.repository/workbenchTest/saveStandards/testOutputcontent.xml:<artifact classifier="osgi.bundle" id="org.objenesis" version="1.0.0.v201505121915"/>eclipse.platform.repository/workbenchTest/saveStandards/testOutputcontent.xml: Bundle-SymbolicName: org.objenesiseclipse.platform.repository/workbenchTest/saveStandards/testOutputcontent.xml:<required namespace="org.eclipse.equinox.p2.iu" name="org.objenesis" range="[1.0.0.v201505121915,1.0.0.v201505121915]"/>eclipse.platform.repository/workbenchTest/saveStandards/testOutputcontent.xml:<required namespace="java.package" name="org.objenesis" range="[1.0.0,2.0.0)"/>eclipse.platform.repository/workbenchTest/testInputcontent.xml:<unit id="org.objenesis" version="1.0.0.v201505121915" singleton="false">eclipse.platform.repository/workbenchTest/testInputcontent.xml:<update id="org.objenesis" range="[0.0.0,1.0.0.v201505121915)" severity="0"/>eclipse.platform.repository/workbenchTest/testInputcontent.xml:<provided namespace="org.eclipse.equinox.p2.iu" name="org.objenesis" version="1.0.0.v201505121915"/>eclipse.platform.repository/workbenchTest/testInputcontent.xml:<provided namespace="osgi.bundle" name="org.objenesis" version="1.0.0.v201505121915"/>eclipse.platform.repository/workbenchTest/testInputcontent.xml:<provided namespace="java.package" name="org.objenesis" version="1.0.0"/>eclipse.platform.repository/workbenchTest/testInputcontent.xml:<provided namespace="java.package" name="org.objenesis.instantiator" version="1.0.0"/>eclipse.platform.repository/workbenchTest/testInputcontent.xml:<provided namespace="java.package" name="org.objenesis.instantiator.basic" version="1.0.0"/>eclipse.platform.repository/workbenchTest/testInputcontent.xml:<provided namespace="java.package" name="org.objenesis.instantiator.gcj" version="1.0.0"/>eclipse.platform.repository/workbenchTest/testInputcontent.xml:<provided namespace="java.package" name="org.objenesis.instantiator.sun" version="1.0.0"/>eclipse.platform.repository/workbenchTest/testInputcontent.xml:<provided namespace="java.package" name="org.objenesis.strategy" version="1.0.0"/>eclipse.platform.repository/workbenchTest/testInputcontent.xml:<artifact classifier="osgi.bundle" id="org.objenesis" version="1.0.0.v201505121915"/>eclipse.platform.repository/workbenchTest/testInputcontent.xml: Bundle-SymbolicName: org.objenesiseclipse.platform.repository/workbenchTest/testInputcontent.xml:<required namespace="org.eclipse.equinox.p2.iu" name="org.objenesis" range="[1.0.0.v201505121915,1.0.0.v201505121915]"/>eclipse.platform.repository/workbenchTest/testInputcontent.xml:<required namespace="java.package" name="org.objenesis" range="[1.0.0,2.0.0)"/>eclipse.platform.repository/workbenchTest/testOutputcontent.xml:<unit id="org.objenesis" version="1.0.0.v201505121915" singleton="false">eclipse.platform.repository/workbenchTest/testOutputcontent.xml:<update id="org.objenesis" range="[0.0.0,1.0.0.v201505121915)" severity="0"/>eclipse.platform.repository/workbenchTest/testOutputcontent.xml:<provided namespace="org.eclipse.equinox.p2.iu" name="org.objenesis" version="1.0.0.v201505121915"/>eclipse.platform.repository/workbenchTest/testOutputcontent.xml:<provided namespace="osgi.bundle" name="org.objenesis" version="1.0.0.v201505121915"/>eclipse.platform.repository/workbenchTest/testOutputcontent.xml:<provided namespace="java.package" name="org.objenesis" version="1.0.0"/>eclipse.platform.repository/workbenchTest/testOutputcontent.xml:<provided namespace="java.package" name="org.objenesis.instantiator" version="1.0.0"/>eclipse.platform.repository/workbenchTest/testOutputcontent.xml:<provided namespace="java.package" name="org.objenesis.instantiator.basic" version="1.0.0"/>eclipse.platform.repository/workbenchTest/testOutputcontent.xml:<provided namespace="java.package" name="org.objenesis.instantiator.gcj" version="1.0.0"/>eclipse.platform.repository/workbenchTest/testOutputcontent.xml:<provided namespace="java.package" name="org.objenesis.instantiator.sun" version="1.0.0"/>eclipse.platform.repository/workbenchTest/testOutputcontent.xml:<provided namespace="java.package" name="org.objenesis.strategy" version="1.0.0"/>eclipse.platform.repository/workbenchTest/testOutputcontent.xml:<artifact classifier="osgi.bundle" id="org.objenesis" version="1.0.0.v201505121915"/>eclipse.platform.repository/workbenchTest/testOutputcontent.xml: Bundle-SymbolicName: org.objenesiseclipse.platform.repository/workbenchTest/testOutputcontent.xml:<required namespace="org.eclipse.equinox.p2.iu" name="org.objenesis" range="[1.0.0.v201505121915,1.0.0.v201505121915]"/>eclipse.platform.repository/workbenchTest/testOutputcontent.xml:<required namespace="java.package" name="org.objenesis" range="[1.0.0,2.0.0)"/>/data/4x_platform/eclipse.platform.releng.aggregator/eclipse.platform.relengfeatures/org.eclipse.sdk.tests/feature.xml: id="org.objenesis"/data/4x_platform/eclipse.platform.releng.aggregator/eclipse.platform.resources/data/4x_platform/eclipse.platform.releng.aggregator/eclipse.platform.runtime/data/4x_platform/eclipse.platform.releng.aggregator/eclipse.platform.swt.binaries/data/4x_platform/eclipse.platform.releng.aggregator/eclipse.platform.swt/data/4x_platform/eclipse.platform.releng.aggregator/eclipse.platform.team/data/4x_platform/eclipse.platform.releng.aggregator/eclipse.platform.text/data/4x_platform/eclipse.platform.releng.aggregator/eclipse.platform.ua/data/4x_platform/eclipse.platform.releng.aggregator/eclipse.platform.ui.tools/data/4x_platform/eclipse.platform.releng.aggregator/eclipse.platform.uireleng/org.eclipse.ui.releng/createDevInstall.sh:org.objenesis/1.0.0.v201105211943,\releng/org.eclipse.ui.releng/platformUiTools.p2f: <iu id='org.objenesis' name='org.objenesis' version='1.0.0.v201105211943'>releng/planning/mars/output.txt:| 14 || <strike>{{bug|440735}}</strike> || 4.5 M1 || normal || lars.vogel || FIXED || <strike>Remove unnecessary dependency of org.objenesis from org.eclipse.ui.tests...</strike>releng/planning/mars/output.txt:| 58 || <strike>{{bug|443061}}</strike> || 4.5 M2 || normal || lars.vogel || FIXED || <strike>Remove unused dependency to org.objenesis from org.eclipse.e4.ui.tests.css.swt...</strike>releng/planning/mars/search_o_other.csv:440735,"4.5 M1","lars.vogel","VERIFIED","FIXED","Remove unnecessary dependency of org.objenesis from org.eclipse.ui.tests","normal",releng/planning/mars/search_o_other.csv:443061,"4.5 M2","lars.vogel","VERIFIED","FIXED","Remove unused dependency to org.objenesis from org.eclipse.e4.ui.tests.css.swt","normal",/data/4x_platform/eclipse.platform.releng.aggregator/eclipse.platform/data/4x_platform/eclipse.platform.releng.aggregator/production/data/4x_platform/eclipse.platform.releng.aggregator/rt.equinox.binaries/data/4x_platform/eclipse.platform.releng.aggregator/rt.equinox.bundles/data/4x_platform/eclipse.platform.releng.aggregator/rt.equinox.framework/data/4x_platform/eclipse.platform.releng.aggregator/rt.equinox.p2/data/4x_platform/eclipse.platform.releng.aggregator/scripts/data/4x_platform/eclipse.platform.releng.aggregator/workspaceSo the problem is most likely coming from:/data/4x_platform/eclipse.platform.releng.aggregator/eclipse.platform.relengfeatures/org.eclipse.sdk.tests/feature.xml/data/4x_platform/eclipse.platform.releng.aggregator/eclipse.platform.releng.prereqs.sdkeclipse-sdk-prereqs.target(In reply to Dani Megert from)Yes Dani. The references needs to removed from releng repos as I mentioned in.(In reply to Sravan Kumar Lakkimsetti from)New Gerrit change created:Gerrit changewas merged to [master].Commit:New Gerrit change created:Gerrit changewas merged to [master].Commit:(In reply to Eclipse Genie from)(In reply to Eclipse Genie from)With these references in prereqs and tests have been removed(In reply to Sravan Kumar Lakkimsetti from)With the latest master I get [ERROR] Cannot resolve project dependencies:[ERROR] Software being installed: org.eclipse.ui.tests 3.13.0.qualifier[ERROR] Missing requirement: org.mockito 1.8.4.v201303031500 requires 'package org.objenesis [1.0.0,2.0.0)' but it could not be found[ERROR] Cannot satisfy dependency: org.eclipse.ui.tests 3.13.0.qualifier depends on: bundle org.mockito 1.8.4[ERROR] Looks like mockito requires objenesis so this should be reverted.New Gerrit change created:Gerrit changewas merged to [master].Commit:New Gerrit change created:Gerrit changewas merged to [master].Commit:Based on, it looks like mockito requires objenesis. Please upgrade both libraries to fix this issue.(In reply to Sravan Kumar Lakkimsetti from)Which issue?CreatedJdeps log for o.e.ui.tests packageCreatedjdeps log for org.mockitoFrom these you can see ui.tests depends on org.mockito and org.mockito depends on org.objenesis. We either drop Mockito or need to upgrade both mockito and objenesis to a level where jdk internals are not being used(In reply to Sravan Kumar Lakkimsetti from)There'srequesting to upgrade Mockito. Sravan, please check whether that no longer uses internals. If it still does, check whether they are aware of the issue.(In reply to Dani Megert from)I checked latest version of objenesis 2.4. it still uses jdk internal apiobjenesis-2.4.jar -> /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/rt.jar org.objenesis.instantiator.sun.UnsafeFactoryInstantiator (objenesis-2.4.jar) -> sun.misc.Unsafe JDK internal API (rt.jar)I also checked for mockito core latest version 2.5.4. and it depends on objenesis 2.4.We need a different approach hereI believe mockito is used by platform.ui. So we need to use alternate tools for this. This requires code change in platform UI code. I am assigning to platform.ui for commentmockito and objenesis have been introduced as part of. Since objenesis uses jdk internal api even in its latest version we need to remove it. This will not work with java9. Mockito has a dependency on objenesis.Please remove this dependency from platform UI so that I can remove3 from prereqs(In reply to Sravan Kumar Lakkimsetti from)Isn't this?(In reply to Dani Megert from)Is this bug about Mockito or Easymock or both?(In reply to Lars Vogel from)The link has objenesis in it, so I assume both use the objenesis library and suffer from the same issue. I think they maintain that library.Possible solutions:1) We can disable and remove the tests from source path. Not much of them, but sad anyway and this will be very quick to implement.2) We could replace mockito with easymock (is on orbit) but we would need to update the tests. I haven't seen the code yet, but this is something doable in mid-term if someone will step in.3) We could wait for the fixed library, then wait for the IP process & Orbit update etc. Easy but probably not for 4.7 anymore?4) We could try to help them to fix their dependencies, but this is probably out of our expertise here, and still 3) is a danger.Anyone has other ideas?Should we follow with 1) and create a bug to do 2)?(In reply to Andrey Loskutov from)2) is not a solution because even latest easymock requires objenesis.(In reply to Alexander Kurtakov from)The version 2.4 in Neon orbit seem to have no such dependencies:	30.0
id=511862	REOPENED	Platform	Runtime	4.6	All All	P3 normal	Andrey Loskutov	2017-02-07 13:42 EST by	Andrey Loskutov	2017-02-14 04:30 EST (	1 user	Every time I open org.eclipse.core.tests.runtime and forget to open org.eclipse.test.performance project too, I see lot of errors in the workspace.I see no reason why the obvious, direct dependency on org.eclipse.test.performance should be marked as "optional".I'm going to patch that.	New Gerrit change created:Gerrit changewas merged to [master].Commit:With this change you cannot execute the non-performance tests anymore without the performance plug-in in the ws. I suggest to revert.(In reply to Lars Vogel from)But then you have compile errors in the org.eclipse.core.tests.runtime project?(In reply to Andrey Loskutov from)You also have compile errors with your change, if the plug-in is not present. Your change did not improve the situation, it only made it harder to execute the "normal" tests.	5.0
id=427393	REOPENED	Platform	UI	4.4	PC Linux	P3 major	Andrey Loskutov	2014-02-04 12:45 EST by	Denis Golovin	2017-01-15 11:28 EST (	9 users	CreatedSreenshot of blank splash behind Workspace Selection dialogWhen eclipse starts it shows Luna splash screen, but when Workspace selection dialog pops up splash gets blank.	Which distribution? Which Gtk version do you use? Any detail is helpfulUbuntu 13.10 (saucy) x86_64Oracle JVM 1.7.0_51GTK+3.0 ver. 3.8.6-0ubuntu3.1(In reply to Denis Golovin from)Denis, which Eclipse build is this? Does this problem happen every time you launch?Niraj, can you please try this? Thanks!(In reply to Arun Thondapu from)It is Luna m5, but I have the same for Luna m4. It is not critical, but it just looks not good and happens every start.(In reply to Arun Thondapu from)I could notice this issue when Eclipse stops for Workspace location, tried with 4.4 M5 & 4.2.1 builds.One way to reproduce this is by launching Eclipse twice on the same workspace location. So, during the second launch, eclipse will popup with "Workspace Unavailable" message and it will ask you to choose a different workspace location and the Splash screen goes blank.As soon as you specify a valid workspace location, the standard Splash screen comes back.This issue can be seen on Ubuntu 12 as well, with both GTK2 & GTK3 combinations.To me, this might require some fix in the launcher workflow on Linux.***has been marked as a duplicate of this bug. ***(In reply to Arun Thondapu from)The issue is 100% reproducible as long as the Workspace Selection dialog is enabled.Ubuntu 14.04 LTSGTK 2.24.23 (GTK 3 is disabled by SWT_GTK3=0)New Gerrit change created:(In reply to Eclipse Genie from)The fix works for Fedora 21, both gtk 2 and gtk 3.[andrey@Pinguin ~]$ rpm -q gtk3gtk3-3.14.9-1.fc21.x86_64[andrey@Pinguin ~]$ rpm -q gtk2gtk2-2.24.27-1.fc21.x86_64I have not tested this patch on other platforms, so it would be nice if someone could do this.I've also increased the severity because on Linux this ugly thing in front of the prompt is the *first* Eclipse UI user sees.(In reply to Andrey Loskutov from)I cannot reproduce the issue on Ubuntu 14.10.Adding Dani, as he merged the fix for.Gerrit changewas merged to [master].Commit:(In reply to Lars Vogel from)Sorry to chime in late. Though this is really an OS or SWT issue, I'm fine with the fix, but would prefer if you restore the alpha value to it's original value (shell.getAlpha()), instead of 255.New Gerrit change created:(In reply to Eclipse Genie from)(In reply to Dani Megert from)Right. While playing with the proposed change I found even better solution, which properly fixes this bug andand restores the previously not shown progress bar in the splash (). Also if the workspace selection was wrong and we show an error, gray rectangle was *also* shown behind the error popups - and this is fixed now too!Please reviewand check if this works on Windows/Mac/Linux Gnome too.On Fedora 21 KDE it workspace prompt dialog now as expected - no gray rectangles anymore!Gerrit changewas merged to [master].Commit:(In reply to Eclipse Genie from)The change is available inOn Fedora 21 KDE the change is OK with GTK2/GTK3 Eclipse. Please verify if the splash change is OK on other operating systems/windowing systems.New Gerrit change created:Gerrit changewas merged to [master].Commit:Closing as fixed since no one seem to complain about broken splash or startup progress dialog in newest builds with integrated fix. Hope this one remain closed too.***has been marked as a duplicate of this bug. ***The problem is still reproducible in the following scenario:1. Open an instance of Eclipse and select a workspace directory.2. Open the second instance of Eclipse and try to select the same workspace directoryYou will get the Workspace Unavailable dialog and a blank splash screen behind it.(In reply to Sergey Prigogin from)Why o why have you found it again :-)	22.0
id=507400	REOPENED	Platform	Text	4.7	PC Linux	P3 normal	Lars Vogel	2016-11-11 07:58 EST by	Lars Vogel	2017-01-17 05:39 EST (	7 users	We we decided in our platform summit to make import dialogs not modal, I suggest to make the Search dialog non-modal.I frequently have the case that I want to copy something from the editor (after I have opened the Search dialog) and this currently not possible.	I talking about the CTRL+H dialog(In reply to Lars Vogel from)Care to share the reasons?(In reply to Nitin Dahyabhai from)You find a write up of the discussion here:For search in particular, see my initial comment.HTHAgreed. This should be non-modal.New Gerrit change created:Gerrit changewas merged to [master].Commit:New Gerrit change created:Gerrit changewas merged to [master].Commit:New Gerrit change created:Gerrit changewas merged to [master].Commit:From-------When the (now modal) Search dialog is already open, then the specific Search > *... actions should activate the correct tab. Currently, the only activate the dialog.Likewise, when "Search... > Customize... > Remember last used page" is disabled, Ctrl+H should always select the context-dependent tab, even if the dialog was already open.[reply] [−]--------The change was reverted for M4 and is now planned for M5 including the feedback from.***has been marked as a duplicate of this bug. ***(In reply to Eclipse Genie from)Thanks.	13.0
id=212773	REOPENED	Platform	SWT	3.3.1	PC Windows XP	P3 normal	Lakshmi Shanmugam	2007-12-12 11:18 EST by	David Kyle	2011-10-17 18:56 EDT (	3 users	Build ID: M20071023-1652Multipage TIFF images are a standard in the oil industry. 100 or more images in a single TIFF file is not uncommon.	Createdmulti page tiffCarolyn, looks like some more potential image work for 3.5.Fixed > 20090811.I have released the code to handle multi-page TIFFs - it is fairly simple code. Unfortunately, the only multi-page TIFFs I can find are not currently supported by SWT's baseline TIFF reader. So for this feature to be useful, we need to also support the TIFF type requested in.Note that I only added decoder (loader) support and not encoder (unload) support. It should be fairly simple to add multi-file encoding support, because we do encode single TIFF files (just as standard baseline TIFF).I am reopening this bug as a place holder for encoding multi-page TIFFs.(In reply to)Hi Carolyn,Has your new code (for decoding multi-page TIFFS) been released yet? When can I expect to be able to use it. BTW, thanks.Craig(In reply to)bump?Sorry I didn't reply earlier. The code for decoding multi-page TIFFS has been in since fall 2009, which means it is in eclipse 3.6 and up. If it is not working for you, then it is possible that you need group iv tiff decoding, which is covered in.If you really do mean "encoding" (or "writing") of multi-page tiff, then this shouldn't be too difficult to add however I don't have time to work on it.Lakshmi, do you have time?All you have to do is refactor TIFFDirectory(image).writeToStream(outputStream) a bit so that the header is always written before calling writeToStream. Then call writeToStream for each image in the ImageLoader.data array. You also have to write the IFD offsets in the same way that they are read and used in the loadFromByteStream() method.You can test using ImageAnalyzer example. Maybe open a multi-image (animated) gif and try saving it as multi-image tiff (and reading it back again).(In reply to)Thanks Carolyn. I just need the decoding of the tiff into multiple SWT images. We don't actually write tiffs out but rather sometimes write jpgs of its pages. I'm very happy to hear it's been added and will report to my team that we should no longer need to convert to AWT images as intermediates. Thanks very much!CraigWait! I tried your attached image - patent.tif - and we don't read it correctly. All I saw was 17 blank pages.I ran tiffinfo on your tiff, and I see that all of the pages in it have group 4 (fax) encoding. Since this is not considered "Baseline TIFF" (i.e. it is one of the TIFF 6.0 extensions) we did not originally decode this type of tiff.So you needto be fixed first.(In reply to)You are right on both counts. Oh well, back to using AWT intermediaries.	10.0
id=507062	REOPENED	Platform	Text	4.6	PC Linux	P3 normal	Leo Ufimtsev	2016-11-04 11:50 EDT by	Leo Ufimtsev	2017-02-02 10:07 EST (	5 users	Even with recent fixes, there is still a small black strip of text in JavaDoc hover. We should fix.	CreatedBlack strip in JavaDocIt looks OK on Windows 7. Is this Linux only?Leo, can you provide a fix for M4? We only have this week left.New Gerrit change created:Gerrit changewas merged to [master].Commit:One thing that still does not seem to work are hyperlinks, both in the Problem and the Javadoc hover. They stay blue for me on Windows 7 even if I change the Hyperlink text color in the preferences. This is a potential problem.Leo, do you see this too? If so, can you work on that?(In reply to Dani Megert from)IIRC hyperlink color is overriden by the CSS settings of EGit. Nothing EGit can be blamed, it is based on a fundamental design flaw of the CSS engine. See. In short, I think the whole preference handling via CSS needs to re-written.1) Note:I did observe an issue. If colors are changed in preference, then the strip at the bottom is not updated till eclipse is restarted. This is because there is no property change listener. I filed a bug to followup on this small detail:– Implement property change listener in AbstractInformationControl for Javadoc2) (In reply to Dani Megert from)I filed a bug for this:– Hyperlink text in hovers / information views does not get styled by "Hyperlink text color" preference.Re-opening to change implementation. Patch to be submitted shortly.(In reply to Leo Ufimtsev from)Ping! This is the last week before we have the M5 milestone week next week.(In reply to Dani Megert from)The color business took longer than I initially anticipated.I have to try to finish webkit2 port in time to make it into Oxygen. Perhaps after I could continue on this guy.(In reply to Leo Ufimtsev from)What's the time frame for that?	11.0
id=241095	REOPENED	JDT	Core	3.5	PC Windows XP	P3 normal	Manoj Palat	2008-07-16 10:13 EDT by	Markus Keller	2014-06-23 03:47 EDT (	7 users	I20080715-1015Formatting selected lines still formats the whole Javadoc comment. I thought this was fixed for 3.4, but apparently, it wasn't.	*** This bug has been marked as a duplicate of***This is not a duplicate. Seeand 13 for more discussion.Still investigating and haven't got a fix in sight yet. Moving to RC1.Just so that I understand it better, I have this question:Does this bug concern only the select + format scenario or also edit + save scenario? It may not really matter since both behaviors appear to be broken, though I am not very sure if it's the same code that causes both.(In reply to)The latter is more important to me.Breakpoints are your friend ;-)Just a heads up that this needs to be watched closely and there isa chance we may want to move this out of 3.8. Jay (or for that matterno active committer of JDT/Core) is not an expert on formatter and ifthe issue proves to be complex and/or the patch is not straight forward,it would be risky.(In reply to)+1. Maybe Frédéric can help a little?(In reply to)As I said in, IMO, this a duplicate of. The way selection works for formatter is to use one region inside the javadoc comment, hence if 233967 was fixed, this one would be fixed automatically.Unfortunately, as I said in, to fix this issue, the javadoc formatter will need redesign, hence I strongly doubt that can be achieved for 3.8 at this late development stage.If you plan to fix that for 3.9, I'll try to do my best to provide some help if needed...(In reply to)Thanks for weighing in and your offer to help Frédéric. We'll have that in mind.This is a long standing issue, but we might want to consider this for Mars if time permits.	10.0
id=427398	REOPENED	JDT	Text	4.3	PC Windows 7	P3 major	Manju Mathew	2014-02-04 13:40 EST by	Sam goldberg	2014-02-13 14:28 EST (	1 user	While working on Junit test class and some other class being tested, the Java Editor suddenly starts showing "<ClassName> class name cannot be resolved to a type" in the Junit test class. This seems to happen while I am making changes to the class being tested. Some other symptoms of the same problem are: (when editor is on the class which cannot be resolved)* the Outline view stops updating new methods and fields* clicking on existing methods/fields in Outline view navigates to incorrect line in the Editor window.* adding Javadoc with alt-shift-J key combination inserts Java doc into the middle of the code.The workaround I have been using is to close all open editor windows (ctrl-shift-w), and then reopen the files I was editing. The problem clears for a short time, until it happens again. This problem occurs very frequently during the day. Some other points of information:* The Java code files I am working in are in 2 different projects. The unit test file is in one project, and the class being tested is in another project. The build path for the test project references the other project.* The UI problem seems isolated just to the file I am editing. Other files do not seem to get their references corrupted. The trigger seems to be that I make some kind of code change to the target class (class being tested), and suddenly it cannot be found by the test project. Cleaning project does not help. * I have been using Eclipse for about 11 years and only started seeing this problem in the last few months, after I upgraded to the Kepler release (Build id: 20130614-0229). In particular, it is possible that this problem started only after I installed the Android development plugin. (but I am not sure)The JDT version info is:Eclipse Java Development ToolsVersion: 3.9.0.v20130605-2000Build id: I20130605-2000(c) Copyright Eclipse contributors and others 2000, 2013. All rights reserved.Visit* I typically work with 2 IDE windows open (on dual display system). I'm not sure if this affects the problem or not.* Error Log view does not seem to show any relevant errors when this occurs.	CreatedScreenshot of IDE when error occursCreatedScreenshot of IDE - Editor out of synch with Outline viewI cannot reproduce this on the latest Eclipse SDK:If you can reproduce the problem using that build, then please provide the steps and reopen this bug. Thanks!I upgraded to the Eclipse 4.4.0 Stable Build: 4.4M5. The Java Editor problem is still occurring. I can't provide steps to reproduce because it seems to happen randomly. I am happily coding away, and suddenly the windows get out of synch with the code.Today what happened:1. Was running Junit test and fixing broken test. After a certain number of changes, I double clicked on the test method in the Junit View, and it navigated to incorrect location in the Java Editor window.2. Clicking on method in Outline View navigates also navigates to wrong location in the Java editor window. Am providing updated screen shot.CreatedEclipse 4.4: Java IDE - Editor and other Views out of synch with the codeCreatedEclipse 4.4: Version Window (shows build number)Another symptom of the same problem (happens at the same time), when I try to run the Junit test with right click, Run As -> Junit Test, a dialog pops up and says "No Junit tests found". This only happens when the IDE is getting out of synch with the code.I am attaching a screen shot of this as well. If you can tell me steps to try to troubleshoot, I would happily try to help track down the problem. (It's killing my productivity).CreatedEclipse 4.4: screenshot linked to(In reply to Sam goldberg from)Is this on the plain SDK or with Android tooling? If it is with Android Tooling, please try whether you also see it in the plain SDK.Manju, try to reproduce using Sam's hints.(In reply to Dani Megert from)This was plain SDK. When I upgraded, I had to do a full install, so all my plug-ins needed to be reinstalled. The only plug-ins I reinstalled so far are: m2eclipse Regex TesterOne other hint about the problem: I noticed that after some time passed, it seemed like the Editor and the Code synched back up, without me doing anything! (this was maybe after about 20-30 minutes of working while references were out of synch.)Maybe one other fact - the workspaces I have has been reused for multiple Eclipse versions. Meaning, when I upgrade Eclipse, I don't delete and rebuild the workspace folder, I just point the new version to that folder. Is there anything stored in workspace which could be incompatible with newer versions?I couldn't reproduce the issue with all the hints that you provided. While browsing through m2e bugs, i came acrosswhich said "changed tests are not picked up when run as JUnit Test", even this issue could not be reproduced. Since another m2e user had trouble with JUnit, it would really help if you could come up with a sample workspace which we can use to reproduce the issue.(In reply to Sam goldberg from)We generally point to our existing WS when a new Eclipse build is out and it has never caused any issues so far.(In reply to Manju Mathew from)A couple points:It would be very hard to reproduce the bug, since it seems to happen randomly while I am coding. I could be coding for a several hours, then, all of sudden it loses the reference to the Java file I most recently edited. And also, randomly after more time passes, the error seems to clear. It is as if some background thread, or some file change callback method is failing intermittently when it tries to read the changed code file, and then messages to GUI objects that the Type is missing. So I doubt you could reproduce this. I have seen this happen in each of my 2 workspaces, so I know it is not workspace specific. I am guessing that maybe some O/S process locks the file, and somehow prevents Eclipse from reading the changed file? I tried to see if turning off Windows 7 indexing of files in the workspace folders makes a difference, but it didn't seem to matter. I think solving this problem will require reasoning, rather than replicating the problem. Points to consider:1. Note that only the GUI/Intellisense cannot to find the compiled object/source file. Running application or Junit does not have any error, even though Editor shows all sorts of errors due to missing reference.2. It happens over time, and self corrects over time (but does not correct very quickly, it could take 30 minutes or more).If you can think of anything I can do to troubleshoot this on my own, I will follow any steps. I could upload my whole workspace, but it would be big. Do you want me to zip the entire folder and upload somewhere?	12.0
id=511607	REOPENED	Platform	Debug	4.7	PC Windows 7	P3 normal	Markus Duft	2017-02-03 00:03 EST by	Sarika Sinha	2017-02-06 01:27 EST (	2 users	Seeing first timetestWaitForOutput Error Failed to await output 'TestOutput' on the console of 'Test1'.java.lang.RuntimeException: Failed to await output 'TestOutput' on the console of 'Test1'.at org.eclipse.debug.internal.core.groups.GroupLaunchConfigurationDelegate.postLaunchAction(GroupLaunchConfigurationDelegate.java:208)at org.eclipse.debug.internal.core.groups.GroupLaunchConfigurationDelegate.launchChild(GroupLaunchConfigurationDelegate.java:173)at org.eclipse.debug.internal.core.groups.GroupLaunchConfigurationDelegate.launch(GroupLaunchConfigurationDelegate.java:123)at org.eclipse.debug.internal.core.LaunchConfiguration.launch(LaunchConfiguration.java:885)at org.eclipse.debug.internal.core.LaunchConfiguration.launch(LaunchConfiguration.java:739)at org.eclipse.debug.internal.core.LaunchConfiguration.launch(LaunchConfiguration.java:731)at org.eclipse.debug.tests.launching.LaunchGroupTests.testWaitForOutput(LaunchGroupTests.java:265)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:749)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:350)at org.eclipse.test.UITestApplication.lambda$0(UITestApplication.java:195)at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:37)at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:182)at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4468)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:4081)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$4.run(PartRenderingEngine.java:1133)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:336)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1022)at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:153)at org.eclipse.ui.internal.Workbench.lambda$3(Workbench.java:679)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:336)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:593)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:148)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:138)at org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:139)at org.eclipse.test.UITestApplication.run(UITestApplication.java:61)at org.eclipse.test.UITestApplication.start(UITestApplication.java:210)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:388)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:243)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:653)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:590)at org.eclipse.equinox.launcher.Main.run(Main.java:1499)at org.eclipse.equinox.launcher.Main.main(Main.java:1472)at org.eclipse.core.launcher.Main.main(Main.java:34)	2 tests failed, we need to make the tests more robust.testWaitForOutput Failure output was not awaitedjunit.framework.AssertionFailedError: output was not awaitedat org.eclipse.debug.tests.launching.LaunchGroupTests.testWaitForOutput(LaunchGroupTests.java:268)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:749)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:350)at org.eclipse.test.UITestApplication.lambda$0(UITestApplication.java:195)at org.eclipse.test.UITestApplication$$Lambda$277/32220244.run(Unknown Source)at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:37)at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:182)at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4216)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3823)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$4.run(PartRenderingEngine.java:1145)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:336)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1034)at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:153)at org.eclipse.ui.internal.Workbench.lambda$3(Workbench.java:679)at org.eclipse.ui.internal.Workbench$$Lambda$13/28511378.run(Unknown Source)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:336)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:593)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:148)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:138)at org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:139)at org.eclipse.test.UITestApplication.run(UITestApplication.java:61)at org.eclipse.test.UITestApplication.start(UITestApplication.java:210)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:388)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:243)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:653)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:590)at org.eclipse.equinox.launcher.Main.run(Main.java:1499)at org.eclipse.equinox.launcher.Main.main(Main.java:1472)at org.eclipse.core.launcher.Main.main(Main.java:34)testDelay Failure delay was not awaitedjunit.framework.AssertionFailedError: delay was not awaitedat org.eclipse.debug.tests.launching.LaunchGroupTests.testDelay(LaunchGroupTests.java:132)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:749)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:350)at org.eclipse.test.UITestApplication.lambda$0(UITestApplication.java:195)at org.eclipse.test.UITestApplication$$Lambda$277/32220244.run(Unknown Source)at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:37)at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:182)at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4216)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3823)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$4.run(PartRenderingEngine.java:1145)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:336)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1034)at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:153)at org.eclipse.ui.internal.Workbench.lambda$3(Workbench.java:679)at org.eclipse.ui.internal.Workbench$$Lambda$13/28511378.run(Unknown Source)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:336)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:593)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:148)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:138)at org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:139)at org.eclipse.test.UITestApplication.run(UITestApplication.java:61)at org.eclipse.test.UITestApplication.start(UITestApplication.java:210)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:388)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:243)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:653)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:590)at org.eclipse.equinox.launcher.Main.run(Main.java:1499)at org.eclipse.equinox.launcher.Main.main(Main.java:1472)at org.eclipse.core.launcher.Main.main(Main.java:34)Sarika, I think you wanted to assign this issue, not close?(In reply to Andrey Loskutov from)Yes, my mistake!! Thanks.	3.0
id=395548	REOPENED	JDT	Core	3.6.2	All All	P3 normal	Manoj Palat	2012-12-01 14:37 EST by	Dave Dyer	2014-12-01 02:50 EST (	4 users	"find references in workspace results in this error, which is non-continuable and not clearable, including by restarting eclipse or calling "clean" on the workspace. This is a newly appeared bug so I presume it must reflect some corruption in caches for this workspace.An internal error occurred during: "Java Search".org.eclipse.jdt.internal.core.CompilationUnit cannot be cast to org.eclipse.jdt.internal.core.ClassFile-- Configuration Details --Product: Eclipse 1.3.2.20110218-0812 (org.eclipse.epp.package.java.product)Installed Features: org.eclipse.platform 3.6.2.r362_v20110210-9gF78Gs1FrIGnHDHWkEcopoN8AmxeZflGDGKQi	Can you please post the complete stack trace.There is no stack trace - it appears as a pop-up with an "ok" box.(In reply to)Please look in the log file at <workspace>/.metadata/.logTIA!ENTRY org.eclipse.core.jobs 4 2 2012-12-01 11:44:46.339!MESSAGE An internal error occurred during: "Java Search".!STACK 0java.lang.ClassCastException: org.eclipse.jdt.internal.core.CompilationUnit cannot be cast to org.eclipse.jdt.internal.core.ClassFile at org.eclipse.jdt.internal.core.search.matching.MatchLocator.createHandle(MatchLocator.java:468) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.reportMatching(MatchLocator.java:2203) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.reportMatching(MatchLocator.java:2689) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.reportMatching(MatchLocator.java:2416) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.process(MatchLocator.java:1668) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1078) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1119) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1251) at org.eclipse.jdt.internal.core.search.JavaSearchParticipant.locateMatches(JavaSearchParticipant.java:94) at org.eclipse.jdt.internal.core.search.BasicSearchEngine.findMatches(BasicSearchEngine.java:231) at org.eclipse.jdt.internal.core.search.BasicSearchEngine.search(BasicSearchEngine.java:515) at org.eclipse.jdt.core.search.SearchEngine.search(SearchEngine.java:582) at org.eclipse.jdt.internal.ui.search.JavaSearchQuery.run(JavaSearchQuery.java:144) at org.eclipse.search2.internal.ui.InternalSearchUI$InternalSearchJob.run(InternalSearchUI.java:91) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)Dave, can you also give some details on what you are trying to search for?You also mention about caches - what did you mean by that. Did you recently upgrade your eclipse, if so, from which version?search for "references in workspace" of win of int win[]=null; Thereare many subclasses and references.The search terminates at a particular place, resulting in a truncatedlist."caches" is purely speculation on my part. I've observer that thereis an enormous amount of bookkeeping that makes this kind of searchfast. In a similar problem several years ago, the problem was "fixed"by deleting some particular cache file from the workspace.(In reply to)I guess you are talking about the search indexes. Yes, if the problem is with the index, you can workaround the issue by deleting the index files from the following location:<workspace_loc>/.metadata/.plugins/org.eclipse.jdt.core/*.indexBut in order to get to the bottom of the issue, we need is the steps that leaves the index in such a state (i.e. assuming the corrupt index is the problem). First, you can try out this and let us know if that fixes the issue.Removing the indexes fixes the problem. Why are these indexes not removed by a "clean" operation?As for how to get the indexes into this state, I suspect it's a one-of nota logic problem. Something like writing the new index failed because the oldindex was open (unespectedly).(In reply to)Indexes are used by the search and clean is more specific to the build operation. Besides, indexing take a lot more time too. Thanks for confirming the workaround works. Closing the bug now. If it occurs again and you have the steps, feel free to reopen the bug.I don't think this is a satisfactory resolution. 99.9% of people whoencounter this problem will just shrug and guess that eclipse is broken.At the very least, the pop-up that reports the error ought to offerthe option of deleting the indexes.Rebuilding after a "clean" takes so long, I don't see that adding rebuildingthe indexes to the process would ever be noticed.(In reply to)I agree, it's not a resolution. What I offered was only a workaround. Providing an UI option to delete the index can neither be the right resolution. The right fix would be to keep the index from get into such a state. For that, we need reproducible steps. I don't have a problem in keeping the bug in open state, if you will prefer that.I agree that fixing the underlying problem would be the best solution, butin the meantime, making the workaround as automatic as possible is appropriate. In the real world, indexes become corrupt despite your best effortsto make them perfect. When it happens, it shoud't make the IDE useless.The code in MatchLocator.createHandle(AbstractMethodDeclaration, IJavaElement) is just wrong and needs to be fixed: this.currentPossibleMatch.getSimilarMatch() can be a class file or a CU but the following code just assumes it's a class file.And of course, if the indexer detects a corrupt state, it should1. log the error2. clean the index3. rebuild the indexJay, please open a corresponding bug if there isn't one already and cc me. Thanks.(In reply to)The closest ever was, which was closed when 'LATER' was removed from resolutions. Considering it's been very long time since the bug was closed, I would prefer a new bug. Let me know if you would prefer to revisit the old one.(In reply to)Sounds good to me.(In reply to)Openedto track this.Can't get to this for M4. Resetting the target.***has been marked as a duplicate of this bug. ***I have another instance of this problem, this time with a stack trace.I had recently cleaned all projects and allowed a rebuild.The most recent operation was adding a new method to an interface(which caused lots of errors in users of the interface) then defininga default implementation for the method, which cleared all the errors.The search was for references to a integer variable "robotPlayer" whichis present in the current class, but the same variable name also appearsin other classes not related to the current one.!STACK 0java.lang.ClassCastException: org.eclipse.jdt.internal.core.CompilationUnit cannot be cast to org.eclipse.jdt.internal.core.ClassFile at org.eclipse.jdt.internal.core.search.matching.MatchLocator.createHandle(MatchLocator.java:502) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.reportMatching(MatchLocator.java:2344) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.reportMatching(MatchLocator.java:2855) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.reportMatching(MatchLocator.java:2569) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.process(MatchLocator.java:1752) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1161) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1202) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1334) at org.eclipse.jdt.internal.core.search.JavaSearchParticipant.locateMatches(JavaSearchParticipant.java:122) at org.eclipse.jdt.internal.core.search.BasicSearchEngine.findMatches(BasicSearchEngine.java:232) at org.eclipse.jdt.internal.core.search.BasicSearchEngine.search(BasicSearchEngine.java:516) at org.eclipse.jdt.core.search.SearchEngine.search(SearchEngine.java:584) at org.eclipse.jdt.internal.ui.search.JavaSearchQuery.run(JavaSearchQuery.java:144) at org.eclipse.search2.internal.ui.InternalSearchUI$InternalSearchJob.run(InternalSearchUI.java:91) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)!ENTRY org.eclipse.core.jobs 4 2 2014-11-30 22:32:09.329!MESSAGE An internal error occurred during: "Java Search".!STACK 0java.lang.ClassCastException: org.eclipse.jdt.internal.core.CompilationUnit cannot be cast to org.eclipse.jdt.internal.core.ClassFile at org.eclipse.jdt.internal.core.search.matching.MatchLocator.createHandle(MatchLocator.java:502) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.reportMatching(MatchLocator.java:2344) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.reportMatching(MatchLocator.java:2855) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.reportMatching(MatchLocator.java:2569) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.process(MatchLocator.java:1752) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1161) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1202) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1334) at org.eclipse.jdt.internal.core.search.JavaSearchParticipant.locateMatches(JavaSearchParticipant.java:122) at org.eclipse.jdt.internal.core.search.BasicSearchEngine.findMatches(BasicSearchEngine.java:232) at org.eclipse.jdt.internal.core.search.BasicSearchEngine.search(BasicSearchEngine.java:516) at org.eclipse.jdt.core.search.SearchEngine.search(SearchEngine.java:584) at org.eclipse.jdt.internal.ui.search.JavaSearchQuery.run(JavaSearchQuery.java:144) at org.eclipse.search2.internal.ui.InternalSearchUI$InternalSearchJob.run(InternalSearchUI.java:91) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)And another unusual circumstance, which is definitely causing other confusionin the IDE, is that there are unexpected class files in the local hierarchywhich correspond to the .java files, but are not the ones that are supposedto be in use.Specifically, the project as a whole has a separate bin hierarchy,bit this particular directory contains copies of class files from an earlier version of the current .java(In reply to Dave Dyer from)This is interesting. Anything that rings a bell, Manoj? Also, please take this over.	23.0
id=64302	REOPENED	JDT	UI	3.0	PC Windows XP	P3 enhancement	Markus Keller	2004-05-27 06:17 EDT by	Markus Keller	2010-09-05 13:57 EDT (	2 users	E.g.void doTheWork(int workItemCount) {}void caller() { doTheWork(17); //extract "17" into local variable}-> proposed name: "i"-> better suggestions: "workItemCount", "itemCount", "count".This can be used in ExtractTemp, ConvertTempToField, IntroduceParameter, andmaybe also in ExtractConstant refactorings.Priorities for guessing types:1. guessTempNamesFromMethodInvocation()2. guessTempNamesFromArgument()3. guessTempNamesFromExpression().This whole guessing code should be extracted into StubUtility.	Good suggestion. We should consider this for 3.1Quick fixes use ASTResolving.suggestLocalVariableNames(IJavaProject, ITypeBinding, Expression, String[]) to guess the name from an expression. It doesn't use parameter names so far.Would make sense to move to StubUtility.Dup of?verified that the example works with the fix for*** This bug has been marked as a duplicate of***Reopening to add support in Introduce Parameter as well.	5.0
id=148804	REOPENED	JDT	UI	3.2	PC Windows XP	P3 normal	Markus Keller	2006-06-27 08:52 EDT by	Frederic Fusier	2013-04-11 17:48 EDT (	2 users	Using 3.2 but already exists in 3.1...Let's consider following test case:pack/X.java: package pack; public class X { public X() {} public X(int x) {} }pack/Test.java: package pack; public class Test { /** * @see X#X() */ X x1 = new X(); /** * @see X#X(int) */ X x2 = new X(0); }Refactor type 'X' to 'Y', you get following changes in Test.java: package pack; public class Test { /** * @see A#X() */ A x1 = new A(); /** * @see A#X(int) */ A x2 = new A(0);}Constructor references in javadoc should have been modified like it was done in code...I would expect following result instead: package pack; public class Test { /** * @see A#A() */ A x1 = new A(); /** * @see A#A(int) */ A x2 = new A(0); }Note that SearchEngine correctly finds constructor references both in code and javadoc...	I would expect also this to work with member type constructor references which have qualified names (see).Here's a test case:pack/X.java: package pack; public class X { public static class Y { public Y() {} public Y(int x) {} } }pack/Test.java: package pack; public class Test { /** * @see X.Y#X.Y() */ X.Y y1 = new X.Y(); /** * @see X.Y#X.Y(int) */ X.Y y2 = new X.Y(0); }Note that qualified constructor name positions will be difficult to get withoutfixed...Setting to wont fix as we can't fix bug.Its a corner case...I don't agree,test case is not related with...There's no inner class and refactoring misses javadoc references...Note that in, you should read:Refactor type 'X' to 'A'...you're right, sorry. We seem to miss all constructors references in Javadoc comments.This is due to the inconsistency from. When we search for references to type X, the constructor name in the MethodRef is not reported.***has been marked as a duplicate of this bug. ***Reopening to get rid of deprecated REMIND state. I really think this should be fixed with a fix for. Doing a second search for references to constructors is inefficient, and it's a PITA to fiddle out the double matches we would then get for constructor references in code.Still seeing this bug in Eclipse Juno SR2 (eclipse.buildId=M20130204-1200).Does this highlight the fact that people don't enable javadoc warnings (in which case it could perhaps Eclipse could make them enabled/set to warning by default).E.g. Simple example showing the problem. Simply refactor the class name to RefactorTestX./** * Use the {@link RefactorTest}{@link #RefactorTest()} ... */public class RefactorTest { public RefactorTest() { // Do something... }}	9.0
id=387565	REOPENED	PDE	UI	4.2	PC All	P3 major	Martin Karpisek	2012-08-20 03:41 EDT by	Torkild Resheim	2017-01-30 20:27 EST (	6 users	The wizard in **Export > Deployable Plug-ins and Fragments** stores the keystore password in clear text. This is a fairly major problem as confidential information is exposed. The password is stored in <workspace>/.metadata/.plugins/org.eclipse.pde.ui/dialog_settings.xml<section name="PluginExportWizard"> ... <item value="asdfasdf" key="password"/> <item value="asdfasdf" key="keypass"/> ...</section>We would be pretty much better off if Equinox Secure Storage was used instead.	This sounds like a reasonable request, but there isn't enough committer time to work on it. It is more common for builds to be done headlessly, not from the UI.A quick fix would be to no longer store the keypass and the password and let the user enter it each time.Patch for review was submitted to gerrit (is using equinox secure storage)C:\Users\IBM_ADMIN\workspace_\.metadata\.plugins\org.eclipse.pde.core\temp\org.eclipse.pde.container.feature\assemble.org.eclipse.pde.container.feature.win32.win32.x86_64.xml:93: The following error occurred while executing this line:C:\Users\IBM_ADMIN\workspace_6nov_\.metadata\.plugins\org.eclipse.pde.core\temp\org.eclipse.pde.container.feature\assemble.org.eclipse.pde.container.feature.win32.win32.x86_64.xml:111: The following error occurred while executing this line:C:\Users\IBM_ADMIN\workspace_6nov_\.metadata\.plugins\org.eclipse.pde.core\temp\org.eclipse.pde.container.feature\assemble.org.eclipse.pde.container.feature.win32.win32.x86_64.xml:68: The jarsigner could not be found. Make sure to run with the build with a JDK. at org.apache.tools.ant.ProjectHelper.addLocationToBuildException(ProjectHelper.java:568) at org.apache.tools.ant.taskdefs.Ant.execute(Ant.java:443) at org.apache.tools.ant.taskdefs.CallTarget.execute(CallTarget.java:105)Whenever I try to use password, it gives me this error with or without the patch.Any sure-shot way to export with password without causing this issue?attaching test steps i used for development and verification(should work always - with or without patch, tested with oracle JDK 1.8.0_101, windows7, Oxygen (4.7) Build id: I20161130-2000)i think error is caused by somehow missing jarsigner binary in JRE --TEST STEPSPrerequisites:JAVA_HOME is JDK installation containing both jarsigner.exe (present only in JDK) and keytool.exe (i think present for both JDK or JRE)Steps:0) generate test keystore which will be used for signing (named test.keystore, with password testpwd): %JAVA_HOME%/bin/keytool -genkey -keystore test.keystore -storepass testpwd -keypass testpwd -keyalg RSA -alias test -dname "CN=test-cn , OU=Test-ou, O=test-org, L=test-loc , ST=test-state, C=test-county"1) create new plugin project named plugin1 (default parameters, empty plugin without code)2) export plugin using export wizard 2.1) Export... > Deployable plugins and features2.2) select plugin1 for export2.3) define directory for export (same directory where is generated test.keystore)2.4) on Tab Jar signing enable "Sign jar archives using keystore" and enter: keystore location = absolute path to our test.keystore keypass=testpwd alias=test password=testpwd2.5) finish - run export3) verify export plugin results3.1) there should be new plugin in subdirectory of export directory in plugins/plugin1_1.0.0.201612012231.jar (for example)3.2) verify jar is signed %JAVA_HOME%/bin/jarsigner -verify -verbose -certs -keystore test.keystore plugins/plugin1_1.0.0.201612012236.jarExpected result is someting like: s k 189 Thu Dec 01 22:36:04 CET 2016 META-INF/MANIFEST.MF X.509, CN=test-cn, OU=Test-ou, O=test-org, L=test-loc, ST=test-state, C=test-county (test) [certificate will expire on 1.3.2017 22:17] 230 Thu Dec 01 22:36:04 CET 2016 META-INF/TEST.SF 1397 Thu Dec 01 22:36:04 CET 2016 META-INF/TEST.RSA 0 Thu Dec 01 22:36:06 CET 2016 META-INF/ s = signature was verified m = entry is listed in manifest k = at least one certificate was found in keystore i = at least one certificate was found in identity scope jar verified.--Thanks Martin, I am able to export a plugin with jar signing password.The fix works fine and now the password is no longer shown.I will test some more and commit it later today ( if I don't find anything in testing).Gerrit changewas merged to [master].Commit:Thanks Martin !Martin, can you please verify this fix in latest 4.7 eclipse?verified in Version: Oxygen (4.7)Build id: I20161205-2000The change caused.	12.0
id=488938	REOPENED	Platform	Resources	4.5	All All	P3 enhancement	Mickael Istria	2016-03-03 08:27 EST by	Mickael Istria	2016-10-10 03:23 EDT (	2 users	Replace some string concatenation, iterations on maps	Gerrit changewas merged to [master].Commit:Fixed in master. Thanks, Mickael!There are still a few instances of these issues:Should I reopen this bug?(In reply to Mickael Istria from)We are still in the same milestone so I will reopen the bug. It would have been better if you had provided this link earlier so that we could verify when all occurrences are fixed. Please make sure to try to fix all remaining cases in one Gerrit. Thank you!Ping.New Gerrit change created:The summary already tells that this doesn't qualify for RC*.Gerrit changewas merged to [master].Commit:@Sergey: do you think this it worth backporting to mainteannce?	9.0
id=488937	REOPENED	Platform	Resources	4.5	All All	P3 enhancement	Mickael Istria	2016-03-03 08:15 EST by	Mickael Istria	2016-05-06 10:17 EDT (	2 users	Several Number literal are instantiated frequently whereas the Number class provide better way to retrieve an instance. Relying on the "factorish" methods should save some time and memory.	Gerrit changewas merged to [master].Commit:Fixed in master. Thanks, Mickael!There are still a few instances of this issue, in tests:Should I reopen this bug?(In reply to Mickael Istria from)We are still in the same milestone so I will reopen the bug. It would have been better if you had provided this link earlier so that we could verify when all occurrences are fixed. Please make sure to try to fix all remaining cases in one Gerrit. Thank you!Ping.New Gerrit change created:The summary already tells that this doesn't qualify for RC*.	7.0
id=505831	REOPENED	Platform	UI	4.6	All All	P3 major	Mickael Istria	2016-10-12 17:50 EDT by	Dani Megert	2017-02-14 11:46 EST (	6 users	org.eclipse.egit.ui_4.5.0.201609210915-rImport gives Invalid directory or archive file when the project already exists in the workspace. This is very bad - the user has no clue what this means. It must tell that the project is already in the workspace, and hence import can't be done.	Why did you set version to 4.2 if you used egit 4.5 ?I don't get what you tried, can you provide steps to reproduce ?(In reply to Matthias Sohn from)Sorry, I didn't set it, so it probably used the one that was used last time.1. Import a project from a random Git repository (makes sure it's already there)2. Import the same project againMickael, this is probably a general bug in the smart importer.I can reproduce it without EGit. The error message is indeed wrong. There is no reason to show an error on location even if the project is already existing.Steps to reproduce1. create a dummy empty folder in your filesystem2. File > Open projects from filesystem... Select this folder, Finish3. Try again. The error message says directory is invalid.New Gerrit change created:(In reply to Eclipse Genie from)@Dani: this patch introduces a new UI string. Is this ok in maintenance branch or does it require additional approvals/process to make sure it gets considered for internationalization?(In reply to Mickael Istria from)It should be avoided whenever possible, but in this case we better have a correct English string than a translation that provides wrong information.New Gerrit change created:Gerrit changewas merged to [master].Commit:Marking as FIXED.Whoops, hit enter too soon.The message is still not as clear as it could be. If the project(s) that can be imported are already imported, it should simply say that the project(s) is(are) already imported.Another problem with the current approach is that the "Folder already imported as project" is not easy to see because it's at an unexpected location and the element is disabled/grayed.Mickael, is this still planned for 4.6.3?(In reply to Lars Vogel from)Unfortunately, some other higher priority tasks make it very lowly probable that I can fix this for 4.6.3.If someone wants to have a stab at it by then, that'd be welcome; otherwise this will have to sleep to the 4.7 stream.	15.0
id=266030	REOPENED	Platform	UI	3.5	All All	P3 enhancement	Mickael Istria	2009-02-24 16:19 EST by	Chuck Bridgham	2017-02-02 08:50 EST (	30 users	This is to disclose a possible implementation for common navigator purposes, an Others working set that dynamically assigns membership.	Createdjava fileCan you explain a bit more what the intention of this is? What should it do? Where would it be used?This look like a modified copy of org.eclipse.jdt.internal.ui.workingsets.OthersWorkingSetUpdater. The Common Navigator has its own working set story -- not sure how this would fit in there...This might be a dup of***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Hi Francis, you said either in your blog or platform UI mailing list that we need to use project explorer rather than package explorer.This issue likely blocks migration to project explorer.In the package explorer, there is an "Other projects" working set for projectsnot yet in a working set.The project explorer does not have such a capability. Once you enable workingsets in the project explorer, all projects must belong to a working set.This makes it difficult to find projects that need to be added to a workingset.Picture a workspace with over 100 plug-ins. I can turn on and off working sets, but I am not sure how to find projects not in a working set.In package explorer (and other explorers), this was accomplished by the "Other projects" working set.(In reply to)need to use project explorer rather than package explorer.>Thanks for your comment on this, I will do this first for M7. It's good to have this perspective.***has been marked as a duplicate of this bug. ***CreatedFirst cut - has some issuesHere is a first cut at the "Other Projects" working set. It has a few issues:1) The icon "workset.gif" needs to be copied from org.eclipse.ui (or workbench -- I forget which)2) It stores the "Other Projects" working set in the main working set manager, which matches things up by name. This will not work if a workspace changes locales (since the "Other Projects" name is localized.3) There is a test for this in the working sets test, but they don't pass atm.4) The Other Projects working set ends up being sorted in both the ProjectExplorer and the dialog to select working sets. In the package explorer it's always on the top (since it's special). The package explorer was is better.5) Deselecting the "Other Projects" working set in the selection dialog does not cause it to not appear.It's clearly too late to try to get this into 3.5; and I think there are several other issues with working set support in the Project Explorer that should be addressed with this. For example, the dialog for selecting the working set comes from the base UI and that may not be adaquate to the task (JDT UI uses their own).So this is a start and will be continued for 3.6/e4.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***The Project Explorer is also missing the Package Explorer's ability to drag projects between Working Sets.(In reply to)Would you mind filing a separate bug report about that?(In reply to)I should have seen that coming :). I added it as.***has been marked as a duplicate of this bug. ***Hwew is a suggested alternative implementation.In the "Select working set" dialog, have a checkbox after the list of working sets, with label "Use this working set as default" and a combo allowing to choose an available working set.When checked, the Navigator would show all projects that are not assigned to a working set into this working set.Ongoing experiment at. Any help is welcome!Gerrit patchaims at providing a similar fonctionality, with more control to avoid breaking existing users.Note that change suggested byintroduce a new method in an Interface of the API.Since there is a review pending, couldn't this review be planned for 4.5? The issue with letting contribution pending is that they quickly become obsolete and it's not really motivating for contributors to keep on contributing if patches get ignored.I'd really like to see this proposal at least evaluated to be integrated in Mars. Is there anyone who could have a look at it?Is it possible to schedule this review for 4.5.M6 ?Mickael, the patch seem to create a workingset called "default" instead of "Other" which is explicitly "anything that is *not* in a working set".I tried to check it out but no luck without alot of conflicts.The suggested patch allow to select an existing working set as a default placeholder for projects that don't have a working set.It's not exactly the same approach as JDT, but it allows to do the same thing, and I believe it's a nicer implementation than showing something that is not a working set (Others) as a working set and forcing the name to "Others".(In reply to Mickael Istria from)I prefer to implement the same concept as in the 'Package Explorer'.(In reply to Dani Megert from)Well, that's a matter of opinion, so let's discuss ;)Why do you think a static "Others" working set is better for the user than ability to select a default working set?Note that to get the exact same behaviour out-of-the-box, we could think about providing an actual "Others" working set by default, and enabling it as target WS for projects that are not attached to any working set.(In reply to Mickael Istria from)It will be easier for Project Explorer users when they have the same concept as known from years in the Package Explorer. And at this point we are not going to change the Package Explorer.(In reply to Dani Megert from)I understand your point, but here it's a new feature in another explorer. It's the right time to make things better than they used to be.I don't think trying to mimic all features from package explorer without taking the opportunity to think of whether there is a better way to do it is a good approach. Project Explorer have space to become better than Package Explorer, that's something we should leverage.I really do not think it is a good thing to force creation of a "special case" working set.It will change depending on what version of eclipse I use, it will *force* creation of workingsets even though I do not use them - and it will only happen if I actually have used the project explorer.I would definitely prefer it to be "Other" and that it is *not* a workingset that gets created.Reason the current "Other" that is virtually calculated is better than "default" working set.A) does not need to change every wizard/UI element that has workingset as targetB) does not need to actively listen to projects being added/removed to eclipse to maintain the "default" working setC) does not need to actively listen to projects being added/removed to workingsets to maintain the "default" working set.D) does not introduce a new conflicting UI conceptbtw. this concept should preferably be applied to *all* common navigator explorers so adopting what is done in Project Explorer by "Other" seems so much more straightforward and simpler.If we go for the exact same approach than with Package Explorer, then we need to have the "others" working set optional, or we introduce a regression to what Project Explorer is able to do: show only the selected working sets, which I find pretty useful when doing demos as it allows to hide irrelevant things.Note that unlike some users, I'm using a single workspace for all my work, and I actively use working sets and hide some of them to "scope" my work, instead of switching between workspaces.Package Explorer supports the exact same thing. You can unselect the "Other Projects" and it will not be shown.How about not adding an "Others" working set but instead adding a checkbox in Edit Working Set... dialog labeled e.g. "Show also Projects not in any Working Set". This would then list all non-working set projects in Project Explorer's list below the list of working sets without grouping them, even with working sets set as top-level elements. Adding a horizontal separator line between these two groups might be a good idea too.CreatedImage: missing working "Other Projects" Working Set in Project ExplorerThe "Other Projects", collects projects unlisted in other any working set. This feature is available in Package Explorer for a long time. We should add this also in Project Explorer, to make users happy, especially now that Project Explorer is the default in PDE for Neon. I use working sets 90% of the time, and without the "Other Projects" is impossible to view any project not included in one of the visible working sets. Consider this case: when you create a new project, usually you don't assign it to any working set. So, from Project Explorer, to have it visible, you have to switch to a different view; select the project; add it to one of the "visible" Working Sets. But, when you are in Package Explorer, you just need to keep the "Other Projects" working set active!IMHO it's a "must have", possibly for Neon!(In reply to Patrik Suzzi from)I completely agree. After upgrading to Neon, I was getting ready to go back to Mars until I found this issue and realized they changed the default to "Project Explorer". As it stands, "Project Explorer" is unusable to me because of this issue.(In reply to David Glodich from)As workaround, you can either use the Package Explorer view in PDE perspective or use the Java Perspective (which uses as default the Package Explorer)(In reply to David Glodich from)In case you're using working sets to group projects that are part of the same "tree", with Project Explorer, you can trigger the hierarchical project layout via the View Menu to have projects from the same hierarchy grouped without using working sets.Not sure it's helpful for your use-case though.(In reply to Patrik Suzzi from)Yes, I'm using Package Explorer now - thank you. Just makes me wonder what features I may be missing out on, since Project Explorer is the "recommended" view now. ;-)(In reply to David Glodich from)Try it and you'll see ;)For Java EE projects, WTP adds many "model" nodes showing endpoints and resources in project explorer that aren't visible with Package Explorer.Same thing for JavaScript, you'll miss the ability to browse the content of the files.You'll also miss the ability to show project hierarchically.Basically, many things that aren't plain Java are missing.I suggest that rather than using Package Explorer, you manually define an "Others" working set for Project Explorer, and put what you want in it. For many projects (maybe not yours), there is much value in Project Explorer that isn't accessible with Package Explorer.(In reply to Mickael Istria from)I don't believe that works for my use-case. The only thing switching to a hierarchical presentation does for me, is change how my packages are laid out (e.g. makes me have to expand multiple folders to get to my classes.) It doesn't appear to affect the way my projects/bundles are organized at all. Maybe I'm missing something?My use case is that my team works with close to 300 bundles organized in close to 50 working sets. We organize our bundles into working sets to ease our ability to find closely related bundles while still maintaining visibility of our entire workspace (e.g. we don't use working sets as a "filter" which restricts the visibility to a specific subset of our workspace.) (Note: Package Explorer also allows you to rearrange the order your working sets are displayed in, which is very helpful/useful, while Project Explorer does not.)The "Other Projects" node is important, because we need to be able to see bundles that are not assigned a working set (e.g. we just created the bundle, someone has forgotten to assign it a working set, or it's a temporary/testing bundle for which I don't feel like going through the work of setting up a working set.)There is a patch suggested. Feel free to give it a try and check whether this would work for you.(In reply to Mickael Istria from)I pretty much only work with eclipse RCP/java projects, so maybe I'm not missing much. ;-) To be honest, I usually don't like to expand my nodes past the file level in the Package/Project Explorer anyway - I prefer to use the Outline view to see any further detail.I'm not sure what the "show project hierarchically" thing is - maybe that's what I was missing from your earlier comment. I now see there is both a"Projects Presentation/Hierarchical" and a "Package Presentation/Hierarchical" option. The "Package" one is the one I was playing with before - the "Project" one does not seem to do anything for me... (If that where to work similar to the "Package" option for projects, then that might be pretty useful - though I'm not sure it would be preferable to the more flexible Working Sets functionality found in Package Explorer.)(In reply to Mickael Istria from)Thanks, I'll give this a try a bit later today.To chime in, I was really glad to find this bug, because I didn't realize that Neon had swapped the "Project Explorer" as default in place of "Package Explorer". I was pulling my hair out trying to figure out how to show "Other Projects".I too expect/depend on "Other Projects" as I work with a sizable number of plug-ins. It's nice to know that you don't have a plug-in that has slipped your notice simply because you didn't add it to a working set.I was about to file the same bug for the same reason. I wonder how many hundreds of hours have now been wasted by people trying to understand why behavior in Neon is different than Mars with only a single line in the N&N to give any clue!Please don't change things unless you can guarantee the behavior is the same, or at the very least make a VERY public statement of what has changed. You may not use a feature, but you can be sure that many users do!New Gerrit change created:Removing reference to previous patch (which was overkill), see nowwhich only add a checkbox in the "Top-Level element" menu to decide whether to show "others" when top level elements are working sets.Technically, adding this involves1. adding the right things to content provider2. disabling the filter when we want to show "Others" or projects are still hidden.As this seems to be a blocker for many people interested in adopting the project explorer, I hope some of the interested parties can review it soon.As it's a feature addition without breaking any previous workflow nor API and all changes are part of internal packages, we might even consider it for 4.6.2 in best case.I think it's important that it works and looks like it does in the Package Explorer. Unless you think the Package Explorer is wrong.(In reply to Doug Schaefer from)Did you try the last patch?(In reply to Mickael Istria from)No, I don't have the platform source checked out. I just saw "Others" and it's "Other Projects" in the Package Explorer. Minor detail, but it got me wondering.The main thing is that it shows up in the list of Working Sets and you can turn it on and off there. That looks like what you're doing, I think.So you'll notice it doesn't work the same, because Project Explorer working set can also be used as filters (Which they are not in Package Explorer). As we cannot remove features from Platform UI, we have to stick with the "filter" part of Project Explorer.In Project Explorer, working sets enablement can also affect the content you see when you're not using Working Sets as root.We cannot at all simply mimic the JDT behavior, so we have to consider some adaptations to make it play nice with the legacy of Project Explorer.So the implementation for the view part is simply to add a checkbox in the menu allowing to choose a top level element, to show whether there's an "Others" working set or not - when top-level elements are working set. It seems pretty consistent to me as users will see it immediately, and since the "Others" is not a working set (even totally the opposite), that we can add as a root element.Let me put this another way.When using the Project Explorer and you create/import a new project and forget to put it in a Working Set when the top element is Working Sets, it never shows up and the user doesn't know why. And, yes, that happened to me early on and I was really confused.So, IMHO, showing Others in the Project Explorer should be the default like it is in the Package Explorer when top element is Working Sets. As long as that's true, I'm good. I don't really care about filtering. Others may.And I don't consider this a breaking change. It's fixing a bug (missing projects on creation).(In reply to Doug Schaefer from)Changing the default behavior (to show content that so far was explicitly filtered by user) is often a breaking change. I wouldn't mind personally, but that's usually the kind of things to negociate with Dani.As usual, a first iteration is to ship an opt-in solution (I proposed one and would be glad to see it reviewed ASAP so it gets chances to even get into Neon.2), and then to evaluate possibility to turn it opt-out in a 2nd iteration.Gerrit changewas merged to [master].Commit:Patch was merged and feature is now available from the "Top Level Elements > Show "others" working set" menu.Leaving it open to write a N&N entry.New Gerrit change created:Gerrit changewas merged to [master].Commit:N&N done,I tried with N20161002-2000 and it does not seem to work.1. I've set top level element to working sets EXPECTED: 'Other Projects' working set is visible, but instead only projects are shown.2. OK, I see there is another option Show 'Other Projects' Working Set. Why do we have this? Who does not want this?3. Enabled that option ==> nothing changed.(In reply to Dani Megert from)This is the current behaviour of working set with Project Explorer: even if top level-elements are working set, at least one must be selected in the "Select working set..." dialog to show working sets as root.I believe if we want to change this, it should be another bug. Or maybe the menu item should say "Selected working sets" ?The menu allows to have this feature opt-in and to not change current bahvior by default. If you're OK to get rid of the menu and show 'Other projects' by default, I'm all for it.Same as 1., as long as no working set is selected, it doesn't change anything.(In reply to Mickael Istria from)Even after checking the additional option, the 'Other Projects' working set did not appear in that dialog. So, no way to make it appear.+1Thanks for your feedback Dani, I see what are your expectations and I agree with it. I'm also glad that we can get rid of this menu and always have "Other projects".+1 Thanks!Just to confirm, implementation details aside, the expectation is for it to work just as it does in the Package Explorer, pretty much exactly. If it's good enough for Java developers, it's good enough for everyone else too :).New Gerrit change created:(In reply to Eclipse Genie from)This makes the Others working set appear, but in the 'Select Working Set...' dialog, the Others working set is not available.Even worse: it looks like the 'Configure Working Sets' functionality is completely missing (filed).(In reply to Dani Megert from)Ok, I'll try to add it. However, the "Others" working set is exactly a non-working set, so we need to be careful about treating it as such.The "Select Working Set..." serves this purpose. What do you think is a missing blocker compared to the "Configure Working Set" dialog?(In reply to Mickael Istria from)Right, but if you then go back to Projects mode, the the ones from 'Others' are hidden. Another bug.Just compare the two dialogs. Doug already said it in:"the expectation is for it to work just as it does in the Package Explorer, pretty much exactly".So you're ok to abandon all the concept of working set filtering in Project Explorer? As mentioned in previous comments, working sets are also used as filters in Project Explorer. We cannot expect things to work exactly the same than in Package Explorer without getting rid of this filtering capability.(In reply to Mickael Istria from)Mh, no. I did not say that. As mentioned in previous comments, working sets are also used asNot sure what "filtering" you are talking about, but the Package Explorer allows to filter on working sets in both modes. Please take a closer look at the Package Explorer.The current implementation in M3 provides the bases of this feature but need some more work as reported by Danu. Splipping to M4.Should we put a note in the N&N to explicit that the UI/UX is not final and going to change by next milestone?The overhaul should get rid of the option to enable/disable 'Other Projects'.(In reply to Dani Megert from)Ok, I like the idea of removing options ;)(In reply to Dani Megert from)I have a few additional questions:1. When top-level elements=Working Sets, should the 'other projects' be always visible or only when there's content to show (ie projects not assigned to any enabled working set)2. Should the "other projects" group/pseudo-working-set be also visible when top-level elements=Projects? Currently, projects in non-enabled working set are simply hidden; the alternative would be to group them under "other projects" anyway. In case all projects are shown, the "other projects" group would be hidden.(In reply to Mickael Istria from)3. When top-level elements=Working Sets and no working set is selected, should we show the "Other projects" working set containing all projects, or show directly all projects?New Gerrit change created:Mass move. Please move to a concrete milestone if you plan to work on this item.@Dani: at the moment, the proposed fix is purely about UI. Moving to the same approach as JDT would require to create an actual working set object in the workspace and to compute it's content dynamically whenever something change regarding working sets. This is code that's on the workbench side, not on the navigator side any more.Is this fine?I'd like to merge an iteration on this topic with(which covers) before considering more complex implementations. Would that be fine?	80.0
id=511101	REOPENED	Platform	Text	4.7	All All	P3 enhancement	Mickael Istria	2017-01-26 10:37 EST by	Mickael Istria	2017-02-27 09:30 EST (	4 users	The Generic Editor shows error markers, but doesn't provide the quickfixes to troubleshoot the errors.To try it:* Create a file such as a MANIFEST.MF with errors and quick-fixes available for those errors* Open With > Generic Editor* See error markers there, no quickfix proposal	This is the same behavior on the plain text editor. Would it make sense and be an acceptable change to try to enable quick fixes on the default text editor as well if the generic editor can inherit from it?(In reply to Mickael Istria from)From the user perspective it doesn't matter in which editor marker appears, but *if* it appears and can be fixed in one editor, why it should not be fixable in another?That would most likely require to add a dependency on org.eclipse.ui.ide, which defines the marker resolution extension point. I'm not sure this is something we want to allow for the legacy text editor. However, for the Generic Editor, I don't see anything wrong with adding this dependency.@Dani: WDYT? Can the generic editor depend on the org.eclipse.ui.ide bundle to provide that feature?(In reply to Mickael Istria from)Yep, our Text Editor in 'org.eclipse.ui.editors' does the same.New Gerrit change created:Gerrit changewas merged to [master].Commit:New Gerrit change created:Gerrit changewas merged to [master].Commit:Please remove the dependency from org.eclipse.ui.genericeditor.tests to org.eclipse.ui.tests.harness.The eclipse.platform.text repo should not require developers to check out the huge eclipse.platform.ui repo, and especially not the ill-designed test bundles in that repo that clutter runtime workspaces with bad contributions.	9.0
id=465288	REOPENED	Platform	UI	4.5	All All	P3 major	Mylyn Inbox	2015-04-23 08:20 EDT by	maarten meijer	2015-06-05 05:34 EDT (	4 users	What steps will reproduce the problem?1. Switch between application launched from IDE and Debugger perspective2. Wait for breakpoint to kick in3. After switch to debugger there is duplicate screen and IDE refuses to quit-- Error Details --Date: Thu Apr 23 14:15:37 CEST 2015Message: Problems occurred when invoking code from plug-in: "org.eclipse.ui.workbench".Severity: ErrorProduct: Eclipse 4.5.0.20150326-0704 (org.eclipse.epp.package.rcp.product)Plugin: org.eclipse.ui.workbenchException Stack Trace:java.lang.NoClassDefFoundError: org/eclipse/ui/views/markers/internal/TableViewLabelProvider at org.eclipse.mylyn.ide.ui.AbstractFocusMarkerViewAction.updateMarkerViewLabelProvider(AbstractFocusMarkerViewAction.java:59) at org.eclipse.mylyn.internal.debug.ui.FocusBreakpointsViewAction.getViewers(FocusBreakpointsViewAction.java:39) at org.eclipse.mylyn.context.ui.AbstractFocusViewAction$2.preShutdown(AbstractFocusViewAction.java:163) at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:949) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.internal.JFaceUtil$1.run(JFaceUtil.java:50) at org.eclipse.jface.util.SafeRunnable.run(SafeRunnable.java:173) at org.eclipse.ui.internal.Workbench.firePreShutdown(Workbench.java:946) at org.eclipse.ui.internal.Workbench.busyClose(Workbench.java:1085) at org.eclipse.ui.internal.Workbench.access$21(Workbench.java:1073) at org.eclipse.ui.internal.Workbench$19.run(Workbench.java:1414) at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70) at org.eclipse.ui.internal.Workbench.close(Workbench.java:1411) at org.eclipse.ui.internal.Workbench.close(Workbench.java:1384) at org.eclipse.ui.internal.handlers.QuitHandler.execute(QuitHandler.java:37) at org.eclipse.ui.internal.handlers.HandlerProxy.execute(HandlerProxy.java:295) at org.eclipse.ui.internal.handlers.E4HandlerProxy.execute(E4HandlerProxy.java:90) at sun.reflect.GeneratedMethodAccessor177.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:497) at org.eclipse.e4.core.internal.di.MethodRequestor.execute(MethodRequestor.java:55) at org.eclipse.e4.core.internal.di.InjectorImpl.invokeUsingClass(InjectorImpl.java:247) at org.eclipse.e4.core.internal.di.InjectorImpl.invoke(InjectorImpl.java:229) at org.eclipse.e4.core.contexts.ContextInjectionFactory.invoke(ContextInjectionFactory.java:132) at org.eclipse.e4.core.commands.internal.HandlerServiceHandler.execute(HandlerServiceHandler.java:152) at org.eclipse.core.commands.Command.executeWithChecks(Command.java:499) at org.eclipse.core.commands.ParameterizedCommand.executeWithChecks(ParameterizedCommand.java:508) at org.eclipse.e4.core.commands.internal.HandlerServiceImpl.executeHandler(HandlerServiceImpl.java:210) at org.eclipse.e4.core.commands.internal.HandlerServiceImpl.executeHandler(HandlerServiceImpl.java:196) at org.eclipse.e4.ui.workbench.renderers.swt.cocoa.CocoaUIHandler.runCommand(CocoaUIHandler.java:715) at org.eclipse.e4.ui.workbench.renderers.swt.cocoa.CocoaUIHandler.access$6(CocoaUIHandler.java:703) at org.eclipse.e4.ui.workbench.renderers.swt.cocoa.CocoaUIHandler$8.widgetSelected(CocoaUIHandler.java:568) at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:248) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4203) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1467) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1490) at org.eclipse.swt.widgets.Widget.sendSelectionEvent(Widget.java:1540) at org.eclipse.swt.widgets.MenuItem.sendSelection(MenuItem.java:583) at org.eclipse.swt.widgets.Display.windowProc(Display.java:5507) at org.eclipse.swt.internal.cocoa.OS.objc_msgSendSuper(Native Method) at org.eclipse.swt.widgets.Display.applicationNextEventMatchingMask(Display.java:5024) at org.eclipse.swt.widgets.Display.applicationProc(Display.java:5405) at org.eclipse.swt.internal.cocoa.OS.objc_msgSend(Native Method) at org.eclipse.swt.internal.cocoa.NSApplication.nextEventMatchingMask(NSApplication.java:94) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3666) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$4.run(PartRenderingEngine.java:1112) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:993) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:156) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:654) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:598) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:138) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:380) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:235) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:497) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:648) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:603) at org.eclipse.equinox.launcher.Main.run(Main.java:1465)	I have the same problem a few time of cannot shutdown eclipse 4.5(was M6 but updated to latest).I did not find a perfect step to reproduce, but it quite often that it block me from closing eclipse more than once in a week, for last few weeks.When it happen, I am not sure, sometime it can be closed after some other random clicks - stop debugging or closing some view. But most of the time it just dead.When eclipse become that state, I have to close all my projects (to prevent dirty write broken file) and kill the eclipse process from task manager.java.lang.NoClassDefFoundError: org/eclipse/ui/views/markers/internal/TableViewLabelProvider at org.eclipse.mylyn.ide.ui.AbstractFocusMarkerViewAction.updateMarkerViewLabelProvider(AbstractFocusMarkerViewAction.java:59) at org.eclipse.mylyn.ide.ui.AbstractFocusMarkerViewAction.getViewers(AbstractFocusMarkerViewAction.java:82) at org.eclipse.mylyn.context.ui.AbstractFocusViewAction$2.preShutdown(AbstractFocusViewAction.java:163) at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:949) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.internal.JFaceUtil$1.run(JFaceUtil.java:50) at org.eclipse.jface.util.SafeRunnable.run(SafeRunnable.java:173) at org.eclipse.ui.internal.Workbench.firePreShutdown(Workbench.java:946) at org.eclipse.ui.internal.Workbench.busyClose(Workbench.java:1085) at org.eclipse.ui.internal.Workbench.access$21(Workbench.java:1073) at org.eclipse.ui.internal.Workbench$19.run(Workbench.java:1414) at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70) at org.eclipse.ui.internal.Workbench.close(Workbench.java:1411) at org.eclipse.ui.internal.Workbench.close(Workbench.java:1384) at org.eclipse.ui.internal.WorkbenchWindow.busyClose(WorkbenchWindow.java:1552) at org.eclipse.ui.internal.WorkbenchWindow.access$16(WorkbenchWindow.java:1523) at org.eclipse.ui.internal.WorkbenchWindow$10.run(WorkbenchWindow.java:1584) at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70) at org.eclipse.ui.internal.WorkbenchWindow.close(WorkbenchWindow.java:1581) at org.eclipse.ui.internal.WorkbenchWindow.close(WorkbenchWindow.java:1595) at org.eclipse.ui.internal.WorkbenchWindow$6.close(WorkbenchWindow.java:519) at org.eclipse.e4.ui.workbench.renderers.swt.WBWRenderer$7.shellClosed(WBWRenderer.java:518) at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:98) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4354) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1061) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1085) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1070) at org.eclipse.swt.widgets.Decorations.closeWidget(Decorations.java:308) at org.eclipse.swt.widgets.Decorations.WM_CLOSE(Decorations.java:1696) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4647) at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:339) at org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1626) at org.eclipse.swt.widgets.Shell.windowProc(Shell.java:2117) at org.eclipse.swt.widgets.Display.windowProc(Display.java:5042) at org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2544) at org.eclipse.swt.widgets.Shell.callWindowProc(Shell.java:498) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4743) at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:339) at org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1626) at org.eclipse.swt.widgets.Shell.windowProc(Shell.java:2117) at org.eclipse.swt.widgets.Display.windowProc(Display.java:5042) at org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2544) at org.eclipse.swt.widgets.Shell.callWindowProc(Shell.java:498) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4743) at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:339) at org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1626) at org.eclipse.swt.widgets.Shell.windowProc(Shell.java:2117) at org.eclipse.swt.widgets.Display.windowProc(Display.java:5042) at org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method) at org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:2549) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3759) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$4.run(PartRenderingEngine.java:1112) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:993) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:156) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:654) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:598) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:138) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:380) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:235) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:497) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:648) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:603) at org.eclipse.equinox.launcher.Main.run(Main.java:1465)Caused by: java.lang.ClassNotFoundException: org.eclipse.ui.views.markers.internal.TableViewLabelProvider cannot be found by org.eclipse.mylyn.ide.ui_3.15.0.v20150113-0039 at org.eclipse.osgi.internal.loader.BundleLoader.findClassInternal(BundleLoader.java:439) at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:352) at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:344) at org.eclipse.osgi.internal.loader.ModuleClassLoader.loadClass(ModuleClassLoader.java:160) at java.lang.ClassLoader.loadClass(ClassLoader.java:357) ... 75 more@Andrey, Is it related to?(In reply to Sarika Sinha from)No, it is related tocommit 2de1d33b740b3c8ee099688a51f5135c819e73e9.org/eclipse/ui/views/markers/internal/TableViewLabelProvider is not an API and was removed during M6 since it belongs to the old obsoleted ProblemView. Mylyn should never use this class and if not fixed already, has to be fixed.*** This bug has been marked as a duplicate of***@Sarika and @Andrey, I don't think it is a duplicate of that bug.Yes, there is a bug or class missing in mylyn, or in any other plugins.But here we are reporting "IDE refuses quit". Eclipse should able to provide a way to quit when where is an error found during destruction process.I am expecting it has a popup like-----Warning: Some problems were found during graceful shutdown, do you want to force Eclipse to close anyway?[Detail] [Force Shutdown] [Back to workspace]----(In reply to Dennis from)+1all exceptions / errors / throwables should be caught in stack trace lineorg.eclipse.ui.internal.handlers.QuitHandler.execute(QuitHandler.java:37)This means the bug should be reassigned back to Platform, not closed as duplicateI mean	7.0
id=502157	REOPENED	Platform	Releng	4.7	PC Linux	P3 critical	Mickael Istria	2016-09-26 08:57 EDT by	Andrey Loskutov	2017-02-06 04:53 EST (	1 user	The two tests below are unstable and must be fixed:SmartImportTests.testImport6ProjectsSmartImportTests.testImportModularProjectsWithSameNameThey were failed on.Regressionorg.eclipse.ui.tests.datatransfer.SmartImportTests.testImport6Projects (from org.eclipse.ui.tests.UiTestSuite)Failing for the past 1 build (Since Unstable#10609 )Took 5.3 sec.Error Messageexpected:<6> but was:<2>Stacktracejunit.framework.AssertionFailedError: expected:<6> but was:<2> at junit.framework.Assert.fail(Assert.java:57) at junit.framework.Assert.failNotEquals(Assert.java:329) at junit.framework.Assert.assertEquals(Assert.java:78) at junit.framework.Assert.assertEquals(Assert.java:234) at junit.framework.Assert.assertEquals(Assert.java:241) at junit.framework.TestCase.assertEquals(TestCase.java:409) at org.eclipse.ui.tests.datatransfer.SmartImportTests.testImport6Projects(SmartImportTests.java:122)Standard Output----- testImport6ProjectstestImport6Projects: setUp...testImport6Projects: tearDown...Regressionorg.eclipse.ui.tests.datatransfer.SmartImportTests.testImportModularProjectsWithSameName (from org.eclipse.ui.tests.UiTestSuite)Failing for the past 1 build (Since Unstable#10609 )Took 1.4 sec.Error Messageexpected:<10> but was:<11>Stacktracejunit.framework.AssertionFailedError: expected:<10> but was:<11> at junit.framework.Assert.fail(Assert.java:57) at junit.framework.Assert.failNotEquals(Assert.java:329) at junit.framework.Assert.assertEquals(Assert.java:78) at junit.framework.Assert.assertEquals(Assert.java:234) at junit.framework.Assert.assertEquals(Assert.java:241) at junit.framework.TestCase.assertEquals(TestCase.java:409) at org.eclipse.ui.tests.datatransfer.SmartImportTests.testImportModularProjectsWithSameName(SmartImportTests.java:132)Standard Output----- testImportModularProjectsWithSameNametestImportModularProjectsWithSameName: setUp...testImportModularProjectsWithSameName: tearDown...	I also saw it a couple times in the last week. My first guess is that it could be a workspace sync issue.I've worked a bit on this but didn't manage to find a reason nor solution yet. So if anyone has a clue, feel free to take this share it or even take this bug.New Gerrit change created:Gerrit changewas merged to [master].Commit:New Gerrit change created:New Gerrit change created:Gerrit changewas merged to [R4_6_maintenance].Commit:The last patches should fix this on both master and branch. About 10 builds with some of them under heavy Hudson load have been run with this patch and none reproduced the issue. So I've good hope that this is actually fixed.However, if one sees failures on the SmartImportTest, feel free to reopen.(In reply to Mickael Istria from)The testImportModularProjectsWithSameName is still failing from time to time.	9.0
id=462642	REOPENED	PDE	Build	4.5	PC Mac OS X	P3 normal	Pascal Rapicault	2015-03-20 05:49 EDT by	Vikas Chandra	2016-05-11 06:18 EDT (	5 users	testBug237662 Failure N/Ajunit.framework.AssertionFailedErrorat org.eclipse.pde.build.internal.tests.p2.P2Tests.testBug237662(P2Tests.java:290)at org.eclipse.pde.build.tests.PDETestCase.runTest(PDETestCase.java:60)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:657)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:310)at org.eclipse.test.CoreTestApplication.runTests(CoreTestApplication.java:36)at org.eclipse.test.CoreTestApplication.run(CoreTestApplication.java:32)at org.eclipse.equinox.internal.app.EclipseAppContainer.callMethodWithException(EclipseAppContainer.java:587)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:198)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:380)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:235)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:648)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:603)at org.eclipse.equinox.launcher.Main.run(Main.java:1465)at org.eclipse.equinox.launcher.Main.main(Main.java:1438)at org.eclipse.core.launcher.Main.main(Main.java:34)	The problem is in Utils.findDeltaPack() line: 326: deltaLocation = findExecutable(new File(baseLocation.getParent(), "deltapack/eclipse"));This test code assumes it knows where on the file system the delta pack is located relative to the currently running platform's install location. This test always fails when I run it in my workspace (even on Windows).Like in, the fix is to skip two additional parent directories.New Gerrit change created:Gerrit changewas merged to [master].Commit:Thanks MarkusMarking this resolved but will wait for next build results for verificationtestBug237662 is still failing.The first change did fix the delta pack location to where it actually sits in the official Eclipse SDK build. But now the test fails because the Ant files that drive the product build in the test haven't been updated to the new Eclipse.app format.I've never used PDE build, so I'm afraid I can't be of more help here. I can't even tell whether the problem is in the test, or whether an actual product build would fail in the same way.Increasing the scope of bug to cover all test cases that are failing on MacOS but passing on windows and linux.For making the test case pass ( I'm not recommending it )For testBug237662 on MacOS_____________________________In build.properties in feature org.eclipse.equinox.executable_3.6.100.datestamp(inside delta pack)This change should be madeFrom root.macosx.cocoa.x86_64.permissions.755=${launcherName}.app/Contents/MacOS/${launcherName}toroot.macosx.cocoa.x86_64.permissions.755=../eclipse/MacOS/${launcherName}Note that this change is in conflict with change ofinFor testP2SimpleProduct on MacOS----------------------------assertTouchPoint configure instruction should be commented out ( also seeof)Also assertLogContains -startup and --launcher.library should be commented to make this test pass. In the test.ini file made now these two lines are not there.For testPublishAndRunSimpleProductIt has the same issue as testP2SimpleProduct . To confirm it, I am putting a temporary check-inI will revert this code commit tomorrow.In my machine setup, this test fails somewhere else on MacOs although I have latest eclipse+code. This is fastest way to verify if this is the only issue here.The temporary checkin in previous comment fixed the issue and caused no further issue. I will revert the fix today but it established the problem that test case has.Reverted viaWe should be back to 6 failures on MacOs.Also warning should go off now.Committed these Pascal's test case fixesRelated defect isStatus as of today:- ProductTests.testBug192127 fails on all platforms,could be related- P2Tests.testP2SimpleProduct and P2Tests.testBug237662 only fail on Mac OS XPascal is going to disable those tests for 4.5.Here is the commit that disables the testsi guess i encounter this bug now when building for the mac?C:\eclipse\plugins\org.eclipse.pde.build_3.9.100.v20150521-1524\scripts\productBuild\productBuild.xml:45: The following error occurred while executing this line:C:\eclipse\plugins\org.eclipse.pde.build_3.9.100.v20150521-1524\scripts\build.xml:129: The following error occurred while executing this line:C:\eclipse\plugins\org.eclipse.pde.build_3.9.100.v20150521-1524\templates\headless-build\customTargets.xml:13: The following error occurred while executing this line:C:\eclipse\plugins\org.eclipse.pde.build_3.9.100.v20150521-1524\scripts\productBuild\allElements.xml:20: The following error occurred while executing this line:C:\eclipse\plugins\org.eclipse.pde.build_3.9.100.v20150521-1524\scripts\genericTargets.xml:195: The following error occurred while executing this line:C:\Users\Administrator\dev_trunk\eclipse_build\build\forEclipse\package.org.eclipse.pde.build.container.feature.all.xml:27: The following error occurred while executing this line:C:\Users\Administrator\dev_trunk\eclipse_build\build\forEclipse\package.org.eclipse.pde.build.container.feature.all.xml:15: The following error occurred while executing this line:C:\eclipse\plugins\org.eclipse.pde.build_3.9.100.v20150521-1524\scripts\productBuild\allElements.xml:35: The following error occurred while executing this line:C:\Users\Administrator\dev_trunk\eclipse_build\build\forEclipse\package.org.eclipse.pde.build.container.feature.macosx.cocoa.x86_64.xml:92: The following error occurred while executing this line:C:\Users\Administrator\dev_trunk\eclipse_build\build\forEclipse\package.org.eclipse.pde.build.container.feature.macosx.cocoa.x86_64.xml:1741: C:\Users\Administrator\dev_trunk\eclipse_build\build\forEclipse\tmp\servoy\Contents\MacOS does not exist.thats what i get problem is that the MacOS folder is in:C:\Users\Administrator\dev_trunk\eclipse_build\build\forEclipse\tmp\MacOSTo patch this locally for now i have to change some code in the delta pack?i used this script:to get the deltapack for 4.5says something about changing something but thats doesn't seem to be fully correct for me either.It seems to me that it is something with eclipse.base or the collectingFolder?Moving to 4.5.2Moving to 4.6Moving to 4.7	19.0
id=303650	REOPENED	Platform	Debug	3.5.2	PC Windows Vista	P3 normal	Pawel Piech	2010-02-23 11:59 EST by	Christian Georgi	2013-04-23 09:54 EDT (	4 users	Build Identifier: 3.5Whenever IndexedVariablePartition.getAdapter() is called to get IElementContentProvider etc., the default implementations from Debug framework are used, not the custom ones from the wrapped variable. Simply overriding getAdapter IndexedVariablePartition like this should do the job: public Object getAdapter(Class adapter) { return fOriginalVariable.getAdapter(adapter); }Reproducible: Always	Should be straightforward.We should try this fix early in M6. I don't think there should be any side effects, but this is kind of a broad change so we'll have to try it out.Committed the fix:reverted with:this fix exposes an internal class in a way it was not intended causing.3.8 M7 has sailed. Please set a new target if still on the plan.	5.0
id=309124	REOPENED	Platform	Compare	3.5	All All	P3 normal	Noopur Gupta	2010-04-14 09:33 EDT by	Markus Keller	2016-03-28 04:55 EDT (	5 users	HEAD, already broken in 3.5.2, works fine in 3.4.2- import the attached project- select packages p and q- Compare With > Each Other- in the "Structure Compare" pane, double-click C.java- in the editor context menu check "Show Whitespace Characters"=> whitespace not renderedWorks fine when I choose "Text Compare" or when I compare the two files directly.	CreatedCompareBugs.zipThis got broken when the enhanced Java compare was introduced in 3.5. Unfortunately, besides breaking 'Show Whitespace' we also don't get the enhanced Java compare.***has been marked as a duplicate of this bug. ***The Git compare editor for the Index version also doesn't show whitespace characters. Such an editor can be opened on a changed file either via double-click in the Git Staging view, or via Compare With > Git Index.Only fails for .java editor, but works fine for .txt or .properties files.CreatedProposed Fix in org.eclipse.jdt.uiCreatedProposed Fix in org.eclipse.compareCreatedProposed Fix in org.eclipse.egit.uiJavaMergeViewer require the editor input to activate the "Show Whitespace Characters" action.During the folder compare the Java file input was FilteredBufferedResourceNode which is not an IAdaptable and hence the getEditorInput always returned null. In the current fix we make sure a FileEditorInput is returned in this case.Compare with Git index worked with EditableRevision which is IAdaptable, but #getAdapter did not handle IEditorInput. The fix now takes care of this scenario.Whenever the "Show whitespace characters" action is enabled a message is logged saying "!MESSAGE Conflicting handlers for org.eclipse.ui.edit.text.toggleShowWhitespaceCharacters: {ActionHandler(org.eclipse.compare.internal.ShowWhitespaceAction@5d955d95)} vs {ActionHandler(org.eclipse.ui.texteditor.ShowWhitespaceCharactersAction@70717071)}".(In reply to)Note here, at least not in the editors I use. Please try to find steps and then file a separate bug report.The patch applies but results in an API error. Not good, especially since I already mentioned this in our last chat.The fix for the original bug is not right. It should not be JDT specific but instead make sure that the document key is set in the contributor.There is no need to add a coupling (adapter) for Git. Compare already asks the 'EditableRevision' for the shared document adapter and that adapter should simply return the correct document key. Pushedto Gerrit for that.CreatedFix in org.eclipse.compareIn the updated patch, no change is made in JDT UI. Inside the contributor of TextMergeViewer the documentKey is returned as a FileEditorInput.The fix in egit which Dani had pushed is not yet verified.(In reply to)The new code should only be executed for shared documents. Otherwise the patch is fine. I made that small change and pushed it to 'master' withI'm marking this bug fixed. The EGit issue is tracked byThis change broke Java refactoring previews: The right hand side of the merge viewer doesn't show the refactored document any more.Even worse: When the editor was dirty, and you click "Preview >" and "< Back", then you get a question about saving a resource.Example: System.out.println("Hello"); // extract local variable for "Hello"Reverted the fix withManju, please investigate.In the earlier fix, #getDocumentKey returns a FileEditorInput if the element is a IResourceProvider.The refactoring preview TextEditChangePreviewViewer#CompareElement implements IResourceProvider, but does not require a document key. With the fix, it gets one and it tries to connect to the underlying shared document and this triggers the problems Markus has pointed out.We can return a FileEditorInput if the element is a ResourceNode instead of IResourceProvider. This will fix the original issue and will not affect the refactoring preview.Dani, kindly advise.(In reply to)Is there a technical explanation why it works?Please also add a new test for this. Our fix did not trigger a TextMergeViewerTest failure, but it obviously should have.(In reply to)Java refactoring preview uses the same framework as that of the Java compare editor. Java compare editor after getting the editor input tries to connect to an existing shared document and it monitors the dirty state of the editor. But for the Java refactoring preview, no association to an existing shared document is required as the data shown in the preview cannot be edited by the user and is discarded as soon as the refactoring is applied or cancelled. By returning an editor input this existing behavior of the refactoring preview was disturbed.FilteredBufferedResourceNode (the element in Resource compare editor)and LocalResourceTypedElement (used while comparing the contents from history) extends ResourceNode. Since LocalResourceTypedElement implements IAdaptable, a valid editor input is returned for this case. Only for FilteredBufferedResourceNode we need to explicitly take care. So instead of checking for instanceof IResourceProvider if we check for ResourceNode this bug should be fixed.Will write a test for this scenario.CreatedFix in org.eclipse.compareUpdated the code to return the FileEditorInput on a ResourceNode rather than on a IResourceProvider. Added a testcase in TextMergeViewerTest to make sure the refactoring preview contents are not affected with this change.Executed the testsuit org.eclipse.compare.tests.AllTests and all the existing tests are green.Comment onFix in org.eclipse.compareWhile the patch itself looks OK to me, it surfaces another problem, which is more severe than the one we try to fix: typing into the compare editor (left side), now triggers a save. This might be related to.Regarding the EGit patch: I tried your EGit patch again and this does not seem to fix this bug. The fix I proposed, also does not work, as it breaks thescenario.We can try to find a fix during RC1. Otherwise we have to move it to 4.4.This is broken for a while and worth taking any risks for 4.3.(In reply to)Of course, I meant *not* worth taking any risks.(In reply to Dani Megert from)Is it still targeted for 4.4? If not, please update target milestone accordingly.	24.0
id=261512	REOPENED	PDE	API Tools	3.5	All All	P3 minor	PDE API Tools Inbox	2009-01-19 10:39 EST by	Dani Megert	2016-09-19 13:30 EDT (	3 users	I200901The API Problem Filter property page shows info and error icons but there's no explanation what they mean.I assume the error icon means that the filter is outdated or somehow invalid. I should be able to see why I get an error icon.In addition, it would be good to have a button 'Remove Invalid Filters' so that I can get rid of them with one click.	Or maybe it is the icon of the problem that it filters?See attached picture for the source of my confusion.Currently the icons represent the severity of the problem they filter. We could change this to something more meaningful like the JDT icon(s) for the member the problem appears on (like the Java outline).It would be awesome to have a button to remove invalid ones, but the only way we can compute which filters are invalid is to run a build, which users might not be expecting to happen with a remove button. Perhaps we could add another button (in addition to the remove one mentioned above) like 'Find Invalid Filters' or the like.CreatedPictureAs you can see I get the same problem filtered, once as error and once as info.Createdscreen shotwhat if we showed the Java icon for the element the filtered problem is on with an overlay of the severity of the problem?applied fix to HEAD to show the filters as shown in the screen cap. Created new bug () for scanning for stale filters directly from the property page.please verify Darin WBetter I think. But still does not explain the duplication and especially not what the 'info' thing would have meant.That is only true if auto-build is off. Assuming thatgot correctly fixed I would assume that you already have all that data.Reopening, The page is not that good. I think the icon for the element the filter applies to is OK, but having the little decoration for the severity of the problem being filtered conveys nothing to user - except adding clutter. It would be far better if we just kept the element icon (tossing the decoration) and could convey the use of the filter to the user (i.e. is it used / unused).We have all of the use information from the last build state so it should be easy to show this to the user.Agree. Adjusted target milestone.	8.0
id=325465	REOPENED	Platform	Debug	3.7	PC Windows XP	P3 normal	Pawel Piech	2010-09-16 09:38 EDT by	Darin Wright	2014-05-23 04:11 EDT (	5 users	The virtual viewer tests have been failing on linux due to an update service dialog being open on the machine when the tests run. If possible, we should force the viewer shell to be on top/in the foreground.	I converted the shells used in the viewer to use SWT.ON_TOP. The down-side is that on Linux/GTK, this removes the shell's trim controls, but the tests still work.Mike, please have a look.It seems that changing the shell style to ON_TOP had a bad effect on the Linux tests. I'm going to make a slight adjustment: instead of calling shell.setMaximized(), i'll call shell.setSize(800,600). We'll see if this has a positive effect on the over night tests.The Mac tests also ended in DNF. I'll run those locally.I'll leave the bug open until the nightly tests pass.The tests on Linux passed last night so that's some progress. However, I'm seeing something very odd on Mac. I managed to get my home Mac (10.6 x86_64) set up to run the tests and I get a behavior where the tests repeatedly get stuck with no updates in the viewers. If I manually change the focus away from the shell with the viewer, the viewer refreshes and the test continues. It's as if the lazy loading viewer thinks that it's covered by another window and simply doesn't refresh. I foundbut it doesn't explain why the nightly tests end in DNF when they were running fine in M5 on the same hardware.My theory about finding a duplicate ofdidn't pan out because I cannot reproduce that failure on my Mac. I'll try reverting the new shell behavior (SWT.ON_TOP) for macs and see if that cures the DNF in nightly build.The mac tests started passing again as so did others. So I'm marking as fixed. Although the win32 tests ended with a dnf on the 21st so if a popup window was responsible then the ON_TOP style didn't help there. I'm closing this bug for now. If we get persistent failures we may need to consider some other alternatives for these tests.I think we need to revisit the tests, the Win test DNF'd again in the N20110222-2000 buildI still can't reproduce the DNF locally, so I'm kind of shooting in the dark:I tried one theory last night - by disabling a test that was recently changed, but that didn't help. Now I backed out the change made originally for this fix for the Windows platform (I already backed it out for Mac). Let's see if that cures it.(In reply to)The tests still ended with DNF over the weekend. I'm out of ideas on this since I can't reproduce the failure locally. Mike do you know if there is any way we could "see" the tests failing on the test machine.(In reply to)There is no way that I am aware of, the person to ask would be Kim.CC'ing Kim for comment.We are having problems with the Windows machine being logged off as the build user intermittently which can cause these types of tests. I'm working right now with the sysadmin to try to solve this. It's impacting other teams. Very frustrating.Thank you Kim for the clarification. I wish I asked sooner :-)The tests are passing again, and the changes from this bug are mostly disabled. All in all, I think I'm starting to think that the ON_TOP style is not really buying us any advantage. For example it didn't help any on the Windows machine that was logging out the user. Any opinions?(In reply to)I agree, I don't think there is much we can do, if even forcing the viewer to be ON_TOP does not prevent the tests failing.I backed out the ON_TOP change.We still get DNF failures. Had another failure on I20130730-0800.Could we not run the tests inside a 'normal' workbench? How come we have to have the viewer so large / on top / etc?***has been marked as a duplicate of this bug. ***And another DNF:And Another DNF:	19.0
id=283574	REOPENED	PDE	API Tools	3.5	PC Windows XP	P3 enhancement	PDE API Tools Inbox	2009-07-15 12:10 EDT by	Lars Vogel	2016-07-20 05:25 EDT (	9 users	Build ID: 20090619-0625Steps To Reproduce:Hi, it would be helpful if the PDE API Tools provides a way to idendify all methods which are not used within the plug-in / project / workspace. I find myself quite often checking if a certain method is used or not. For private methods the editor gives you a warning / error but for public methods you have to check manually.Best regards, LarsMore information:	Any thoughts Mike?I think this would be pretty useful. Is this something we should add on to our usage scan task?I know we have had a problem in the SDK where there were many cases we had dead code lying around...(In reply to)I'm not sure this is something to augment the use scan with, there is too much info in that scan already :)It feels to me this would be best done in JDT, they could just extend their unused detection to also include public members, or better to have an option to scan for unused public members. The main problem I could see with this is the performance issues.Olivier, any thoughts on something like this appearing in JDT?Just for reference, my prototype which a standard plugin can be found here:I believe that it would be really powerful if THE standard scan could consider the OSGi Export statements. If a public class is not exported AND not used in the plugin it is clearly dead code.For the rest it still might be that someone uses the Api but still the information is valuable.So if you develop a standard scan I believe it would be could to consider the OSGi statements.I agree with Mike that this would be better in JDT, since I would think many projects, not just plug-in or RCP projects, would like to have the capability. Personally, I'd opt for on-demand (as opposed to a compiler warning/error).(In reply to)It has to be on demand. Checking for unused public members can only be done from within a specified scope.So this could be done when exporting a RCP application.A public member is never "unused" as it can always be used by an external user.Checking this in a scope is something that should be done when exporting a set of bundles.So I see this more as an external tool that would take a set of jars and return all the unused members (types, fields, methods, constructors) from within that set of jars.There is no plan in JDT to add such a tool. This could be easily contributed by the community.My 2 cents.@Oliver: Also a public API can be unused. Not if you write a framework (like Eclipse platform) but if someone writes a small application with a small number of team members it is possible that this person know all the consumers of his code and that he has everything in one workplace. In this case the possibility to check if public methods are used, is valuable. It should perhaps not be the default but the option should exists.I frequently use my little plugin from the blog post to check my own code to validate if I have created dead code.(In reply to)This is exactly my point. The check has to be done for a scoped set of bundles.In this case, it could be done by an external tool or as an option inside the export feature.What is reported as unused can only be cleaned as part of that reduced set of bundles.This is why an external tool could not only process all the bundles, but also removed the corresponding unused members. However that resulting sets of bundles cannot be used by anybody else.So I see that more as a pluggable tool that would do a post processing of an Eclipse export action than part of the JDT bundles.I personally use it during development time to check if someone have created methods which are used. I recently had a collegue who changed his unused private methods to public just to avoid the warnings. Having such a checker durind development time can help you identifying this.(In reply to)It sounds like you might be thinking too narrowly, in terms of plug-in projects and bundles. What I'm thinking of (and I think Lars, too) is that a common and useful scope for such a search would be "all Java projects in the current workspace." It would be a command that the user could invoke from the context menu of any member in a Java project, not something useful only in the context of projects that produce bundles.Does that make sense? I think the code in Lars' blog post (linked above) is pretty much that idea. Lars, could you attach that code to this bug for review?CreatedPrototype@Eric: sorry for taking so long to respond. My example analyser (prototyp) fromis attached.I already created a plugin to find unused code.See UCDetector homepage:There are no plans to add this kind of feature to API tools, and since JDT does not want it either, I am going to mark this as WONTFIX.(In reply to Eric Rizzo from)+1Please reconsider this - it is an everyday need :I am surprised really that eclipse does not offer this capability. Think of developing an app in many projects - from time to time one has to check one's public APIs to see if they are really used - currently the only way to do this is manually check for references - clearly a chore and bug prone in major projects.This should be indeed moved to the JDT and reopened - after all the code is here.Please reopen+1 I agree, please re-consider adding this utility to Eclipse(In reply to Donald Dunne from)I'm also for contributing this as an optional tool to PDE. Donald would you be available to provide a patch for PDE? I think it should be contributed as a spy similar to the existing spies.	16.0
id=104156	REOPENED	PDE	Build	3.1	PC Windows XP	P3 major	pde-build-inbox	2005-07-17 11:01 EDT by	Erik Bengtson	2006-01-10 14:52 EST (	1 user	I have a plugin which adds a new builder to the plugin project. While using theUI only, it call all builders set to the project but not when using thebuild.xml generated by the PDE.The PDE generates a build.xml that compiles the java code, and regarless thebuilders that are currently set for the plugin, the generated build.xml has noscript to call the additional builders.Please consider that using the build.xml script we still need to call allbuilders set for the project.	***has been marked as a duplicate of this bug. ****** This bug has been marked as a duplicate of***Can you elaborate more why this is marked as resolved? I can't see it as a duplicate of 120210 since that only talks about exclusion filters.Good catch. I meant to close another bug as dup.	4.0
id=118631	REOPENED	PDE	Build	3.2	PC Windows XP	P3 normal	pde-build-inbox	2005-11-30 09:08 EST by	Pascal Rapicault	2007-05-17 11:00 EDT (	2 users	Since the introduction of real version numbers, it is no longer possible to refer to a plug-in jar or have configuration files refering to plug-in since the version of the plug-in potentially change at each build.Therefore we need to provide in a file the versions that have been generated for each plug-in. In addition we may want to investigate the creation of a replace mechanism if no ant task is suitable.	After discussions we have decided to not worry about the replacement mechanism.Files named finalPluginsVersions.<config>.properties and finalFeaturesVersions.<config>.properties are generated in the working directory.For a given bundle the plugin file contains <bundleSymbolicName>=<version> <bundleSymbolicName>_<3_First_segment_of_the_version>=<version>If a bundle appears multiple time <bundleSymbolicName>=<version>refers to the highest version number.This format doesn't seem that simple. Perhaps it would be easier to just list the bundles and their versions? As inorg.eclipse.foo=1.1.2.dssadfdsorg.eclipse.foo=1.3.3.dsafdsorg.eclipse.bar=1.1.0.sdfsfdWhat is the other key used for?nit: consider file names like "pluginVersions.config.properties" and "featureVersions.config.properties". "plugin" and "feature" should be singular and the meaning of "final" is unclear from a user point of view.This is what is done. The extra <bundleSymbolicName>_<Three_First_Segment_of_the_version> key is used to handle the case where two versions of the same bundle are present in the build, or when people care about a particular version of a bundle.As for the file name, "final" refers to the final version that the plug-in will have at the end of the build. Moreover a "pluginVersions.properties" file already exists and contains the tags from the repository.Andrew if you can think of a better filename please change it.The main use of this file would be loaded in as properties in ant scripts, in this case we can't have multiple instances of the same key. Similarily we can't manipulate a value in ant so "org.eclipse.foo=1.1.2.dasf, 1.3.3.fgh" wouldn't work either.Ok. There are two uses of this information. One is for parts of the PDE build process. The other is as a bill of materials for the build. In the former case, no one really cares about the content. For the latter, the file itself will come under scrutiny and people will want/need to understand it.I'm proposing that at least for the latter case that the structure of the data should be homogenous. One format for data if there is one version of a bundle and another format if there are more is confusing.Reopening to generate another file that will be the actual complete billing list.as a point of interest, does it have to be a different file? Can we just change the current one.The current file is meant for tools/people that need to replace version numbers during the build process (For example, in macos drop of the SDK the eclipse.ini file needs to refer to the debug plug-in). Therefore the current file needs to support multiple occurences of the same bundle and preferably in a format that is easy for people to consume (this is why we have the multiple entries for the same bundle).The file needed for a warm and fuzzy feeling tool is a laundry list that should unlikely contain multiple entries for one bundle. A tool should just have to iterate over it and not wonder if the same bundle is listed twice in the file.We also like file :-)Is the version file that you have now included in the output of the build? Seems like the simple one is all that should be needed in the output (i.e., to enable the warm fuzzies)I have two features to build in customTargets.xml (allElements).The properties file holding the version information from the first feature is overwritten during generation of the second feature.Is this planned this way, so that I have to copy the files prior generation of the second feature?Olivier please open a separate bug report for the issue you mentionned.(In reply to)OpenedAs noticed in previous comment the file may contain redundant data, however given that no data is missing to write a "warm and fuzzy feeling tool", no work is further planned in the 3.2 time frame.In 3.3, we might want to rename the file and maybe generate a new file with only the laundry list of what is built, but even that is unclear.Nothing more planned here.We will still need this at some point if we are going to do a warm fuzzy tool. One could argue that it is somehow related to the provisioning work but either way the functionality seems useful.references this bug as a general solution to substitute the final bundle name_version into the eclipse.ini for the mac. This was needed to set the -Xbootclasspath:p option to prepend the correct version of com.sun.jdi needed by debug.This particular usecase on the mac is no longer needed (see). It appears this bug report is tracking other usecases. I'm just recording this here. There may be other reasons to hardcode bundle name_versions in the eclipse.ini, but this is a very brittle usecase.	17.0
id=307750	REOPENED	PDE	API Tools	3.6	All All	P3 minor	PDE API Tools Inbox	2010-03-31 11:42 EDT by	Martin Oberhuber	2014-12-17 09:13 EST (	5 users	Build ID: I20100312-1448 (3.6m6) on WinXP SP2Steps to reproduce:1. Launch Eclipse 3.6m62. Import org.eclipse.core.resources project3. In Preferences, specify Eclipse-3.5.1 SDK as baseline--> Missing @since tags are reported on a number of classes which are not API because their package is marked x-internal in the Manifest. For instance:Description Resource Path Location TypeMissing @since tag on org.eclipse.core.internal.resources.FilterDescription FilterDescription.java /org.eclipse.core.resources/src/org/eclipse/core/internal/resources line 23 @since tag problemThis issue is pretty annoying because the error markers obscure real compilation errors. On the other hand, I do not want to turn off error reporting on missing @since tags completely, because there are some API packages that I want the API Tooling to report errors on.	I'll take a look.I cannot reproduce with I20100406-1034.Martin, could you please give it a try?Thanks.I still see this with I20100406-1034 on WinXP in my Workspace, after a clean rebuild of o.e.core.resources HEAD.As mentioned my baseline is Eclipse-3.5.1 SDK ... perhaps there's an issue with this baseline not properly identifying "internal" packages or reporting too much in its .api_description files?I am retrieving the 3.5.1 SDK to double-check it.Would it be possible for you to isolate the problem in a small workspace?I still cannot reproduce the failure.Without further details, I will close as WORKSFORME.CreatedTeam project set to reproduceOk, so I reproduced this with I20100406-1034 with a fresh empty workspace.I'm not exactly sure which of the steps below are actually must-haves to trigger the problem; the problem wasn't there when I initially imported the team project set and started editing, but it manifested when I changed the API baseline to include both plugins and features.1. Launch I20100406-10342. Preferences > API Baselines : Enter D:/eclipse351/eclipse/plugins3. Import attached team project set4. (maybe) edit core.internal.resources/SaveManager.java, adding a constant5. (maybe) edit core.resources/IProject, adding method bar() with @since6. (maybe) edit core.internal.resources/Project, adding impl of bar()7. Preferences > API Baselines : Switch to "D:/eclipse351/eclipse"I tried those steps and for some reason I don't get the @since tags errors.Something else must be different.When you have the pb, do you still get it after a full build ?Interesting... in this new workspace, the errors are gone after the clean rebuild. In my old workspace, the errors remained even through clean rebuild with M6; now with I20100406-1034, they are gone there as well after the clean rebuild.So... looks like current state is that there must be some odd condition triggering the issue when changing the baseline, but the error is not persistent. Which makes the issue minor IMO.One option to try reproduce might be repeatedly changing the baseline: .../eclipse/plugins , APPLY , OK .../eclpse , APPLY, OK .../eclipse/plugins, APPLY, OK ...I tried that many times without luck.Do you still get it using this week I-build ?Cannot reproduce any more with I20100414-1200, with none of my workspaces.I also notice that the "full build" seems a lot faster now, when I hit Apply in the Preferences after changing a baseline. So I assume something has been changed in this area which fixed the issue. Will reopen in case I ever see it again.The problem is back, with I20100422-1310 .I had upgraded to the new I-build, re-using the existing workspace. The upgrade forced me to create a new target platform based on the running platform (I have several addons like CDT pulled into my Eclipse via *.link files).It took several iterations until everything built clean again (there were build path errors). At some point the build path errors were resolved, but API Tooling now keeps indicating "missing @since tags" on "internal" packages in core.resources. A clean build doesn't resolve the problem - markers are removed but then return again.Let me know what I can do to help diagnosing the issue.If only I could reproduce it. Right now I cannot, so I doubt I can actually fix it for M7.Removing target milestone as long as I cannot reproduce and therefore fix this problem.I could try debug this if you can give any hints what to look for. Or I zip up my entire workspace for you. Or I start a remote debugging session and have you connect remotely (not sure how well JDWP protocol works with high latencies).My feeling is that this is related to changing the target platform underneath an existing workspace. Where is the information that something is "x-internal" taken from ... the target platform, the workspace or the API baseline?(In reply to)If this is the case, then this should be a bug in PDE/UI. API tooling is using the target platform information. If the target platform is not properly initialized, then we might end up with wrong errors.If you could zip up your workspace and tell me what you do to get the error, this would definitely help.I could never reproduce this one so unless this is reproducable and I can get access to a test case to reproduce it, I'll close as WORKSFORME.I could never reproduce. Closing as WORKSFORME.Reopen if you get it again in 3.7 cycle.Just seen again with 3.7m5.Here's exactly what I did:1. Launch 3.7m4 on a fresh empty workspace.2. Set API Baseline to C:\Eclipse\361\eclipse\plugins3. Get following projects from HEAD: org.eclipse.core.resources org.eclipse.core.tests.harness org.eclipse.core.tests.resources org.eclipse.test org.eclipse.test.performance org.eclipse.test.performance.data org.eclipse.test.performance.win324. Observe a build error in core.resources (needs core.runtime 3.7.0)5. Launch 3.7m5 (fresh empty config area)6. Open the workspace --> API Tooling reports "Missing @since tag" on o.e.core.internal.dtree"This time, the problem remains after a clean rebuild.Ankur, I didn't have time to look at this one. Could you please take a look?Thanks.I got the same problem. The reason it happens is when an existing package is newly marked as x-internal.(In reply to Dani Megert from)Test Case:1. clone2. import 'org.eclipse.equinox.p2.ui'3. add 4.4.1 as API baseline==> at the moment you get an unexpected error regarding wrong @since tag in StringMatcher. Onceis fixed, you have to remove the workaround/problem filter:4. select the project in the 'Package Explorer'5. context menu > Plug-in Tools > Remove API Tools Problem Filters...6. remove the one for StringMatcher==> unexpected error regarding wrong @since tag in StringMatcher(In reply to Dani Megert from)(In reply to Dani Megert from)Please ignore those comments. What I saw was caused by something else (seefor details).	28.0
id=141741	REOPENED	PDE	Build	3.1.2	PC Windows XP	P3 normal	pde-build-inbox	2006-05-15 07:56 EDT by	Beat Hörmann	2010-04-29 14:48 EDT (	4 users	Assume a fragment "f" for a plugin "p". Further assume that the fragment exports a package "pa". Thus, plugin "p" exports package "pa". Now assume another plugin "p1" that depends on plugin "p" since it uses the package "pa".Within PDE add "p" as a required plugin for "p1". Export "p1" with PDE's "Deployable plug-ins and fragments" export wizard.Error: PDE is not able to *build* the plugin "p1" since it does not recognize package "pa".Further details:- Plugin "p1" developed against a target platform that contains both, the fragment "f" and the plugin "p".- Known workaround: Hack "build.properties" header "jars.extra.classpath" and put the Jar containing package "pa" - very ugly.- News group related thread: News group: eclipse.platform.rcp, thread: Export problems (fragment related) by Daniel Krügler, September 2005.	Because it is not possible to require a fragment, fragments should be treated as optional. Therefore what you are seeing is expected since P1 can not rely that F will always be around.To bypasse this, in cases where you know that P1 will always be shipped with F add into P1 manifest.mf the following line and that will fix your problem: Eclipse-ExtensibleAPI: trueNote that this tooling specific markup is only supported in 3.2 so you can develop with 3.2 and still target 3.1.Plugin development is against a target platform. The target platform comprises a distinct set of fragments and plugins. The set of packages ultimatively seen by other plugins is therefore dependent on the set of fragments and plugins contained in the target platform. If plugin "p" and fragment "f" are contained in the target platform then plugin "p" naturally exports package "pa". (If fragment "f" was not contained in the target platform then plugin "p" would not export package "pa".) I don't think that it is too hard to add this feature to PDE's dynamic classpaths computation.***has been marked as a duplicate of this bug. ***It is unclear for me why PDE just builds the plugin "p1" without a problem as soon as the fragment "f" is in the workspace but the build fails when "f" is not in the workspace but still contained in the target platform. (This forces us to either import our fragments into the workspace or to apply the dirty trick with the hacked "jars.extra.classpath" entry in the "build.properties" described above.) It is not a question of a missing entry in the "manifest.mf". It is just a lack of PDE's process of *building* the plugin. PDE knows of all fragments and plugins in the target platform, hence, it also knows that plugin "p" exports package "pa". Therefore it should build plugin "p1" without any complaints, even if fragment "f" is not in the workspace. Pascal, did I miss something or did I express myself in an unclear way?I understand your point, but I would appreciate if you could provide smaple plugins and fragments to help us capture the problem.(In reply to)I use Eclipse 3.21. Create plug-in "p1": File/New Project.../Plug-in Development/Plug-in Project Next Project name: pluginP1 Next Finish2. Create plug-in "p": File/New Project.../Plug-in Development/Plug-in Project Next Project name: pluginP Next Finish3. Create fragment "f": File/New Project.../Plug-in Development/Fragment Project Next Project name: fragmentF Next Host Plug-in/Plug-in ID: pluginP Finish In Package Explorer right-click fragmentF/New Folder Folder name: lib Put into the lib-folder any jar-file that you want to use in plug-in "p1". I put Apache's XSL-FO Processor, as an example. Hence, my lib folder contains the "fop.jar" file. The editor aera of the PDE perspective shows the "fragmentF" editor. Select the "Runtime" tab Classpath/Add... Open "lib" and double-click lib/fop.jar Exported Packages/Add... double-click on "org.apache.fop.apps" (or any other package that you want to use in plug-in "p1"). File/Save4. Make plug-in "p" a required plug-in for plug-in "p1" In the editor aera click on "pluginP1" Select the "Dependencies" tab Required/Plug-ins/Add... double click on "pluginP" File/Save5. We now want to use package "org.apache.fop.apps" (or any other package that was given to plug-in "p" via its fragment "f") in plug-in "p1". In Package Explorer right-click pluginP1/Properties Java Build Path/Libraries/Add External JARs... double-click on "fop.jar" Ok In Package Explorer unfold pluginP1/src/pluginp1 right-click package "pluginP1" New Class Name: "MyClass" Finish Put the following (useless) source-code into MyClass.java package pluginp1; import java.io.IOException; import org.apache.fop.apps.Driver; import org.apache.fop.apps.FOPException; public class MyClass { public void runFO2PDF() throws IOException, FOPException { Driver driver = new Driver(); driver.run(); } } File/Save6. Export plug-in "p" and fragment "f" to the Target-Platform. I take the "standard" Target Platform, in my case "C:\Program Files\eclipse-SDK-3.2". In Package Explorer right-click pluginP/Export... double-click Plug-in Development/Deployable plug-ins and fragments select "Available Plug-ins and Fragments/pluginP and fragmentF" Select the Target Platform: Destination/Directory: "C:\Program Files\eclipse-SDK-3.2" select "Options/Package plug-ins as individual JAR archives" Finish The directory "C:\Program Files\eclipse-SDK-3.2\plugins" should now contain the files "pluginP_1.0.0.jar" and "fragmentF_1.0.0.jar".7. Now the most important step: Close the fragment project in the workspace. In PackageExplorer right-Click fragmentF/Close Project8. Export plug-in "p1" to the Target-Platform In Package Explorer right-Click pluginP1/Export... double-click Plug-in Development/Deployable plug-ins and fragments pluginP1 should be selected Other settings should be okay Finish A popup appears: Errors occurred during the operation. A zip file containing the build logs has been generated and placed at "C:\Program Files\eclipse-SDK-3.2". The zipped-logs contains the following messages: # 07.09.06 10:41:53 CEST # Eclipse Java Compiler 0.671, 3.2.0 release, Copyright IBM Corp 2000, 2006. All rights reserved. ---------- 1. ERROR in C:\workspaces\Standard\pluginP1\src\pluginp1\ MyClass.java (at line 11) import org.apache.fop.apps.Driver; ^^^^^^^^^^ The import org.apache cannot be resolved ---------- 2. ERROR in C:\workspaces\Standard\pluginP1\src\pluginp1\MyClass.java (at line 12) import org.apache.fop.apps.FOPException; ^^^^^^^^^^ The import org.apache cannot be resolved ---------- 3. ERROR in C:\workspaces\Standard\pluginP1\src\pluginp1\MyClass.java (at line 21) public void runFO2PDF() throws IOException, FOPException { ^^^^^^^^^^^^ FOPException cannot be resolved to a type ---------- 4. ERROR in C:\workspaces\Standard\pluginP1\src\pluginp1\MyClass.java (at line 22) Driver driver = new Driver(); ^^^^^^ Driver cannot be resolved to a type ---------- 5. ERROR in C:\workspaces\Standard\pluginP1\src\pluginp1\MyClass.java (at line 22) Driver driver = new Driver(); ^^^^^^ Driver cannot be resolved to a type ---------- 5 problems (5 errors)Remarks: - Exporting plug-in "p1" runs without error if the fragment project is in the workspace, that is, if Step 7 was omitted. - Exporting plug-in "p1" runs without error (the fragment project being closed) if I apply the dirty trick described in the first message: Directly hack the "build.properties" of plug-in "p1" setting: jars.extra.classpath = ../../../Triangulum/Entwicklung/libraries/ Apache FOP/build/fop.jar - Another thing that seems to be new in Eclipse 3.2: If I close the plug-in project "pluginP" then Eclipse immediately shows an error in plug-in project "pluginP1". The same question again: Am I programming against my workspace or against the Target Platform. (The latter one should be the right one. I want to do PDE without having to load all required plug-ins and fragments into the workspace.)After two years, I still think that PDE should be agnostic to fragments in the target platform.	7.0
id=149609	REOPENED	PDE	Build	3.2	PC Windows XP	P3 trivial	pde-build-inbox	2006-07-04 20:56 EDT by	Pascal Rapicault	2007-05-23 15:13 EDT (	1 user	When a plug-in does not resolve, it is not always caused by a missing immediate prereq. In an example where A depends on B which depends on C, the error message of A will say somthing like "missing dependencies B" even though the actual problem is caused by C. This makes the actual tracking of errors really painful and it would greatly improve usability if the message could be collapsed.	This should be as simple as displaying the root cause returned by the state.Should we sill display the complete list of errors after the short message?Fixed in HEAD to only show the first thing that causes everyone else to fail. We pass the osgi.resolverMode=development property to the State object.The fix is not appropriate. The change should have been done in BuildTimeSite.getRegistry() and use the getUnsatisfiedLeaves() method from the state.	3.0
id=133074	REOPENED	PDE	UI	3.2	PC Windows XP	P3 major	PDE-UI-Inbox	2006-03-23 17:10 EST by	Rafael Chaves	2009-12-02 15:56 EST (	3 users	3.2 M5 (this is similar to what is reported for, but it does not involve optional requirements)We have dozens of projects in a CVS repo. Groups of these projects make components. While for the projects in the component our team is responsible for we get the contents from HEAD, for the components we rely upon we will check out (at once) a stable version (tagged), once a week, overwriting the existing contents.Often the list of projects from other components we check out changes (a few projects are added or deleted), and dependencies between those projects change as well version numbers are not changed though). This causes lots of build errors, were PDE complains about missing prerequisites when prerequisites are there (causing Java build errors as well).In this situation, it is really hard to make the build errors go away, but it seems to involve a combination of touching some MANIFEST.MF files and restarting Eclipse. Project > Clean... does not help.The impression it leaves is that the old dependencies are cached and the cache is not properly updated/discarded when plug-ins change. That is bad, but what annoys me the most is that Project > Clean... does not fix this mess (does PDE really clears the dependency model when clean is performed?).Marking as major as this is a significant hurdle for our dev process.	I missed an opening parenthesis:"...dependencies between those projects changeas well (version numbers are not changed though)..."I sympathize, but do you have a test scenario that we can start with?I am not sure there is enough info to investigate.I (and others in the team) have been seeing this for months now, and the only reason I didn't report it before is that I don't know how to reproduce it. I was in the hope that the fix towould solve this, but since it didn't (I suspect they are related), I thought I should at least report it. I can try to reproduce it later, with projects from Eclipse (we use the same RelEng tool to fetch all projects appearing in a map file).I would say that there are actually two bugs here: the first, what this bug is about, is related to getting the bundle model kept by PDE into a bogus state. The second, is related to Project > Clear... not being effective as a workaround. Wassim, does PDE recompute the bundle model when Project > Clear... is issued? If not, how can a user achieve that?Hi Rafael, I was wondering if you had any luck finding a recreateable test scenario?No, sorry, all my efforts to reproduce it in a controlled manner failed, and I don't see the problem any longer because I left the team earlier this year. My current setup involves only a few Eclipse projects.You might want to ping others in the team about this. Adding Nick just in case he still/also sees this (hey Nick!).Hi Rafael!Yes, I still see this occasionally. I'll try to come up with a reproduceable case.Since the bug report was open, the PDE models/notifications have been completely rewritten and a number of related bugs have been fixed in jdt/core and equinox that were resulting in bad build behavior on Rafael's old team.Closing as we believe there are no such related remaining issues as of 3.3M7.Anyone who can reproduce on >= 3.3M7 gets a shiny nickel (for a maximum of two nickels ;)Are those Canadian nickels or US nickels? Not sure it is worth my time if they are Canadian :)They are shiny. Bauman likes shiny objects :)Ten Canadian nickels are worth nine US nickels. That's almost as good :-).For the record, I can often reproduce this still with 3.5. Turns out there is one scenario where this happens really often: having the same plugins in your workspace in source form (from SCM) and in your target in binary form (let's say, because you are self-hosting). I use the <major>.<minor>.<service>.qualifier approach (Eclipse replaces qualifier for me), I wonder if that is related (does PDE resolve the 'qualifier' part when comparing the plug-in in source form with the plugin in binary form (which will have a timestamp instead of 'qualifier')?Steps are more or less like this:1 - check out plug-ins in source form (plug-ins have dependencies between them)2 - build them and install in your running Eclipse (which is your target platform by default)3 - restart Eclipse4 - make changes to the plug-in projects, for instance, replace the entire contents of a source form project with the latest from the repository.Eventually you will get bogus compilation errors, with errors in MANIFEST.MF files and Java source code due to missing dependencies (which are not really missing).This are not definitive steps, but are part of my basic workflow. One might have to work like that for some time to experience it. I now avoid such setup (by deploying into a different Eclipse install).No one is currently investigating this, removing milestone.	12.0
id=121691	REOPENED	PDE	UI	3.2	PC Windows XP	P3 normal	PDE-UI-Inbox	2005-12-21 01:46 EST by	Thomas Hallgren	2006-08-24 04:50 EDT (	1 user	Since 3.2M4, Eclipse issues the following warning on a plugin.xml that contains extensions of type org.eclipse.ant.core.antTasks:"Referenced class '<name of class>' in attribute 'class' is not on the plug-in classpath."The class is not supposed to be in the plug-in classpath. It is included in the jar referenced by the attribute 'library' in the same extension point. The warnings can of course be disabled but that disables all other, potentially very useful manifest warnings about non-existent classes as well.	The warning is of course accurate since the class is not on the plug-in project's classpath.Even if the jar in question is not supposed to be on the "runtime" classpath, there is no reason why it should not be on the development classpath.Add said JAR to the .classpath file on the Libraries tab of the Java Build path property page of the plug-in project and the compiler warning will go away.I think there's a big reason to not add the jar to the .classpath. If you do, you also have to include the ant build framework in the .classpath (since it's very common that you inherit those classes). That in turn, will cause the ant classloader to see two versions of its own framework. One version that it loads itself and another passed from Eclipse. The result is not good to say the least.In other words, it's *imperative* to separate the .classpath from the classpath used by the ant-task.Incorrect.1. A JAR is not compiled by the compiler. So adding it to the .classpath will actually benefit you by adding the classes in it to the java indexer, and no one will complain about missing type hierarchies from the Ant classes.2. Take a look at how the ant.ui plug-in itself uses that extension point and how it also opts to add ant.jar to its classpath via the jars.extra.classpath key in the build.properties file of the plug-in project.Many teams in the eclipse sdk uses this extension point and none requires special treatment with respect to classpath, so I suspect your scenario does not either.(In reply to)I agree with this. But it's not that simple.I don't doubt that some plugins indeed can do this. In fact, some of mine can too. It all depends on what kind of tasks they are contributing and how they are compiled (and run). I suggest you take a look at the org.eclipse.core.resources plugin. They don't add their ant-tasks to the .classpath and they have a good reason not to.Why do you think the ability to add a special jar file exists in the first place?Well, I'm sorry, but it does.As I said, there is no bug here from a PDE point of view.Please stop reopening this bug report as managing the bug inbox is already a challenging job.This is not the forum for user questions. Please try the newsgroups for that.I'm sorry, but I'm going to reopen this again. I'm bothered by having a growing set of 'warnings' in my problems view that *are not problems*, even though PDE thinks they are. I may be vain, but I believe I/we know better than the PDE in this case.Don't misunderstand me, it's great to have warnings of *possible* problems, but please let me suppress them in those instances when I actually know they are not problems in my particular case. Now they're just obscuring my view of other problems that are real - therefore, for me/us it is a bug not to be able to override this.Can we have more friendly discussion of this problem this time around? Pretty please?We can re-examine the situation if you have new evidence or a more compelling argument that the referenced class is on the Java classpath but PDE is saying that it is not. That's what the flag does and is designed to do. If it is not suitable for you, you can lower it to IGNORE. It's fully customizable both at a project level and at a workspace level.What new arguments do you have that were not discussed inthrough?The classes in question is *not on the classpath nor should they be*. They should be in the plugin.xml though. Please don't suggest that they should be in the cp just because they are in the plugin.xml because in our usecase things work just as we want them to, despite the warning.Just to make everyone happy, we've actually tried to put them on the cp per your suggestions. Then self-hosting breaks for us. That's all the evidence we need.Sure it's designed to warn about things not being on the cp. Well-intentioned and sometimes a catch. In this case however it simply is wrong about it being a problem - first, it is not a problem for us regardless, and second, actually following the warning and adding it to the cp *does* make it a problem for us.Yes, it can be lowered to ignore. But then it will miss potential *real* troubles. I doubt that's a better situation - I'd feel better keeping it on. Rather, like many other warnings, say when the JDT warns about something, then I can suppress that particular *instance* (not for the whole project, just for selected instances). It seems quite reasonable to be able to do this here also. Because, as I say: we understand the warning but deem it to not be a problem for us. We don't claim there's a bug with the warning as such - it is the fact that the granularity of turning it off or on is too coarse.You've seen a number of them above; maybe you don't consider them new, but I fail to see fault with my argumentation. I don't claim the issue to be earth-shattering or requiring high-priority fixing, but I do have an issue with its function and hence I call it a bug.We have in good faith reported a problem for us. I think we've been, and still are, mostly civil. Some of your comments so far can unfortunately be read somewhat differently I must admit. I feel your hostility to be very strange. You seem to claim "you don't have a problem with it, you just don't understand the problem you do have", rather than accept our arguments and that your suggestions fail to work for our usecase. It's plain insulting to be treated as some half-wits by you just because you don't agree with our apparently valid usecase.To reiterate: PDE says we have a problem. We know we haven't got a problem. Why isn't it useful to be able to nicely tell PDE to 'ignore these instances but keep warning me for others'?I will focus on the technical content of:Each extension point comes with a schema describing the type of each attribute in the schema. A schema attribute of type 'Java' means that the value of this attribute is supposed to be a class on the plug-in classpath. No nuances. It's black and white. PDE does not own these schemas. They are specified by the owners of the extension points respectively.The schema attribute ('class' in the case of the org.eclipse.ant.core.antTasks), which is owned by the Ant component, is declared to be of type Java. So PDE correctly flags it as missing if the class referenced in the attribute is not on the classpath. That's what it is designed to do. The semantic of that attribute type and flag is very clear.Now, if it's common for this 'class' attribute to denote a class that is not on the project's classpath, then one solution would be for the attribute type to be changed in the extension point schema from 'Java' to 'String', since the PDE validation won't be of much value.I am going to cc Darin, the owner of the extension point in question, for comment on this attribute and whether it is a special case that should be changed.Either way, the resolution of this bug report was correct. There is no bug on the PDE side nor is it possible for us to distinguish between this attribute and other attributes of type 'Java'. they are all the same to us.(In reply to)Thank you! We will endevour to stick to the facts too. If I do happen to sound confrontational below, it is certainly not intended - I just wish to make my arguments as clear as I can make them. I hope we can come to an agreement on what our differences (and agreements!) are in order to productively come to a conclusion. True, we hope to convince you that we actually have a valid usecase, that is also generally useful to be able to support. Again, whether we'll succeed with this is yet to be seen, or even if we do, maybe the end result is a low-priority enhancement...Before addressing your comments more specifically I would like to add an item that further highlights that 'compensating for one thing creates another problem'. Thus, the proposed solution is to add the classes to the cp just to make the warning go away. The claim is that this is harmless. As I stated, this is wrong, at least for us - it isn't harmless. But, even if it were, another thing crops up: a warning gets added claiming that the source folder is now missing from the build.properties. This is completely true of course, so the same reasoning applies here: 'there is no bug since the warning is completely correct and as designed'. But this is now going full circle - we specifically don't want the source to be built the regular way in the first place. So what to do?As argumented below, I think the root problem here is in a lower level, so to speak. It really isn't localized to the ant extpoint really, albeit it's very easy to see the effects there since running Ant and custom tasks inside Eclipse sometimes is a challenge due to classloader issues.Yes. But I believe this is the crux of the problem. Would you agree, that there is a possibility that the entire assumption of 'the development cp is the same as the runtime cp' is what is causing this issue?If it is, this is something wholly controlled by the schema PDE (?) is responsible for (i.e. the extpoints just uses the schema that says that using the 'Java' attribute has the semantics it now has).We (apparently successfully) use the notion that the development classpath is one thing. In the plugin.xml however, we specify things that are only valid for the runtime classpath. We must specify them in there in order for the extpoint to work, of course. This is perhaps a usecase that isn't supported by PDE at the present time. Could it ever be? Should it be?A very simplistic suggestion is to add an attribute of 'runtimeOnly=true|false' or something similar in order to make it clear to involved code what is going on. Or, probably simplest, is just adding a way to make a 'suppress warning' comment/annotation for instances of problems. If that could be added to the list of 'quick fixes' for the problem marker it'd would give us the tool we need to avoid this.No, the validation is then not useful. However, as stated above, the possibility exists for this happening with any usage of the 'Java' attribute type in any extpoint so treating the ant task extpoint specially is probably not the right way. And, there are other nice things that happen when PDE sees it's 'Java' so it'd be sad to drop down to 'String' semantics.I appreciate this, as its helpful to have more brains chewing at a problem. I think by now however, it's clear that we believe it isn't this extpoint in particular that is problematic so I doubt Darin would be inclined to mess with it.Ok, point taken. I agree with the reasoning, and don't contest that it should warn, all things being equal.But I sincerely hope you can appreciate our view that while warnings are warnings, there are sometimes reasons to allow the user to override the warning because the human behind the keyboard can actually make a more informed decision. Or, that in fact the warning occurs not because it is wrong in itself, but because it is based on a faulty assumption in the first place - that makes it a bug, but in a different area.A more elaborate solution would perhaps be to define yet another type 'lib' to be used in extension point schemas and have PDE check a) that such libs exists, and b) that 'java' used in the same extension is found in the lib. That would be really helpful and it would also give extension point authors more declarative power.>I think there is a danger in closing bugs just because it extends beyond the area of a certain domain. I've seen this happen on other reports as well. A better approach in my opinion, would be to delegate the problem to whoever it concerns, add a dependency, and leave the bug open. I think most people would perceive this as a PDE problem at first. Finding the problem here (as an open bug) with a more elaborate break down and dependencies is far better then finding nothing at all or a closed 'RESOLVED INVALID' bug.	11.0
id=158923	REOPENED	PDE	UI	3.2	PC Windows XP	P3 normal	PDE-UI-Inbox	2006-09-27 00:53 EDT by	Philippe Ombredanne	2006-09-27 17:13 EDT (	1 user	When a sequence contains a ref and an inline element, the inline element is reported as a warning, and no UI assistance is offered in the manifest editor.The warning for "inlined" elements is "element <xyz> is not a legal child of element <abc>"A good example of the situation are to check out:the o.e.atf.personality.dojo.core ::pserver::/home/webtools org.eclipse.atf/components/plugins/org.eclipse.atf.personality.dojo.core that exposes that markup:<extension point="org.eclipse.wst.common.project.facet.core.facets"> <project-facet id="dojo"> <label>Dojo</label> <category>atf.category</category> <<<This will trigger a warning...when the schema in o.e.wst.common.project.facet.core:pserver::/home/webtools wst/components/common/plugins/org.eclipse.wst.common.project.facet.coreprovides the following schema/factes.exsd :<element name="project-facet">... <complexType> <sequence> <element ref="label"/> <element ref="description" minOccurs="0" maxOccurs="1"/> <element ref="version-comparator" minOccurs="0" maxOccurs="1"/> <element name="category" type="string"> <<<<This element is defined inline .... </sequence>....This is a pain, and yet there is no workaround as there is already an other top-level element named category in the same schema.	PDE schamas are not full XML schemas - they are a subset good enough for PDE to express extension points' grammar. You must define your element globally and reference it as done elsewhere.Sure, yet why is the tooling not providing warnings in the Schema editor?And why would that syntax even be supported and working then?Those should be addressed at the minimum, IMHO, to provide feedback.Those are not my schemas, they are defined in the web tools project at Eclipse.Can using an include help with the cases where several element have the same name yet different definitions, as it is the case in the WTP project?I remember a similar problem elsewhere where include was involved. You are also right that the manifest editor should warn people from adding XML that PDE will ignore (note though that it is not possible to define an inline element in the schema editor GUI, so this must have been added through the source page).Reopening to track the schema confusion issue. Schema validator should warn users when grammar not supported/ignored by PDE is used."warn people from adding XML that PDE will ignore"Well, the markup in question functions just fine at runtime since the extension registry can consume arbitrary XML. The problem from where I stand is that PDE is not capable of describing and handling every shape of XML that might be used for extension markup. It seems that this is a limitation that should be addressed.Correct. There are some creative cases that cannot be expressed in a way that PDE can use to validate the resulting plugin.xml. In those cases, PDE will incorrectly flag a valid extension.	6.0
id=182391	REOPENED	PDE	UI	3.3	Other Linux	P3 normal	PDE-UI-Inbox	2007-04-13 15:33 EDT by	Stefan Xenos	2011-06-20 09:49 EDT (	4 users	Turn on live annotate and annotate a fileLeft click on the annotation margin, to the left of the editor.Observed behavior:- If you click near the top (the first few pixels) of the annotation, a range of rows is selected.- If you click elsewhene in the annotation, only one row will be selected.Expected behavior:- Clicking anywhere on the annotation does the same thing.Suggestion:- Remove the behavior of selecting text when clicking on the annotation margin. This seems to be a rather arbitrary behavior. Suggest making it consistent with the other margins just ignore clicks on the margin.	In I20070410-1043 CVS Live Annotate always selects the current line. Either you are using an old version or a different a Live annotate provider - if so, file the bug there.This was observed in I20070323-1616, using the live annotate provider supplied by CVS. I was able to reproduce it by annotating the plugin.xml for org.eclipse.compare.There is no sich thing as "range annotation". Clicking in the ruler selects the current line.PDE decided to override this behavior via PDESelectAnnotationRulerAction.This has been sitting here for several years and has garnered no interest. Closing as WONTFIX. Please reopen if you are interested in contributing a fix.Seriously? Closing valid bugs just because it was forgotten about or because nobody has had time to fix yet it isn't cool. If the behavior is intentional, fine... but as long as the problem is valid, closing the bug report just means the problem isn't documented anymore. Hiding the documentation doesn't make the bug go away - it just means someone else needs to take the time to document it next time they encounter it.	5.0
id=158856	REOPENED	PDE	Build	3.2	PC Linux	P3 normal	pde-build-inbox	2006-09-26 16:02 EDT by	Chris Longfield	2010-06-18 16:55 EDT (	2 users	I have a feature that includes a second feature (launchers) for my RCP.I want the launchers to only be included for my non-mac platforms: <includes id="org.eclipse.platform.launchers" version="0.0.0" os="linux,win32" ws="gtk,win32" arch="x86"/>However, when I do a build (headless feature build for feature one), the mac launchers are included (my build.properties lists mac carbon ppc/x86 as build targets).	Maybe I have my syntax wrong. This appears to work: <includes id="org.eclipse.platform.launchers" version="0.0.0" os="linux" ws="gtk" arch="x86"/> <includes id="org.eclipse.platform.launchers" version="0.0.0" os="win32" ws="win32" arch="x86"/>Will do this work as*** This bug has been marked as a duplicate of***hmmm.. this is actually different from.Currently when processing included feature, we aren't looking at the os/ws/arch values on the feature inclusion at all. We are only looking at them on plugin includes.However, when building with p2, these filters will be considered when installing the final product. The question then is just about supporting them in older non-p2 builds.	3.0
id=194122	REOPENED	PDE	UI	3.3	PC Windows XP	P3 normal	PDE-UI-Inbox	2007-06-23 23:04 EDT by	Kevin McGuire	2009-03-16 12:05 EDT (	2 users	In the import plugins wizard, on the first page where you get to choose where to import from, the first choice is "the target platform". It seems this is ignored and instead all the plugins show up in the next page. To verify, I have a target with 92 plugins and if I press the "Target Platform" the plug-ins list in the dialog correctly states "92 of 149". Yet when I proceed to the next wizard page it shows all 149 plugins.	This is intended behavior, since it would be silly to force the user to check a plug-in in the Target Platform before he is able to import it into the workspace.Dani, how do you feel about this one?If I recall, your target platform is always completely unchecked. So this would result in not being able to import anything unless you check everything on the target platform first.No, it's not ignored: it imports from there.This works as expected. Suggest to close as INVALID. If Kevin feels strong about this one you could add a button: 'Add Enabled Target Plug-ins'.*** This bug has been marked as a duplicate of***I'm confused.The bug says that the next page picks up all 192 plugins of my install which includes plugins not in the target. So what's the purpose then of the first page option of installing from my target if we go and ignore it?Lets say someone hands me "platform definition X", with a directory of plugins and an accompanying target definition. It's great if I can be assured that I'm only working with those, and not accidentally picking up some from the eclipse install. I assumed this was the purpose of this option.If I *also* want the option of installing from the installation (which is needed if say they'll never be part of the target), then I should be able to do that too as one of the options on the first page.	5.0
id=218593	REOPENED	PDE	UI	3.4	PC Windows XP	P3 enhancement	PDE-UI-Inbox	2008-02-12 01:55 EST by	Ed Willink	2008-02-13 10:55 EST (	3 users	The following erroneous extension <extension point="org.eclipse.ui.popupMenus"> <objectContribution id="id1" adaptable="true" objectClass="WrongClass"> <menu id="Path" path="additions" label="Open Sheet"> <separator name="sheets"/> </menu> </objectContribution> <objectContribution id="id2" adaptable="true" objectClass="RightClass"> <action id="ActionId" label="Label" menubarPath="Path/sheets" enablesFor="*" class="ActionClass"/> </objectContribution> </extension>(with names changed to save space, eliminate spurious Bugzilla Finds)generates Plug-in 'PlugIn' contributed an invalid Menu Extension (Path: 'Path' is invalid): ActionIdwhen the RightClass context menu is activated. This is correct but not very helpful, since Path appears to be ok. It's just not ok for RightClass. After a couple of hours finding no fault with AdapterFactory and ItemProvider registrations, I finally found it.Enhancement: The message would be better as:Plug-in 'PlugIn' contributed an invalid Menu Extension (Path: 'Path' is undefined for 'ActualClass'): ActionId.Bug: This fault can and should be diagnosed by the ManifestBuilder just the same as a bad class is.	The classic 'id hell' problem found within extension points ;)*** This bug has been marked as a duplicate of***The ManifestBuilder 'bug' is perhaps covered by the 181515 'enhancement'.The run-time message enhancement is not.fair enoughattaching a context for the braveCreatedmylyn/context/zip	5.0
id=218904	REOPENED	PDE	UI	3.4	PC Windows Vista	P3 normal	PDE-UI-Inbox	2008-02-13 20:42 EST by	Jeff McAffer	2009-05-06 11:32 EDT (	5 users	in i0207I have a target editor open in the Java perpsecitve and the editor is too wide. The right side of the content is cut off by the outline view such that a horizontal scroll bar is needed. Grabbing the outline | editor sash and dragging you can see the editor resize (correctly) for a split second and then revert back to being too wide. For the content on the Outline page of the editor there ought not be much of a width limit.	I don't have the problem on XP :/Can you please attach a screenshot?Createdshot of the target editor being too wideI haven't seen this at all in the new editor. Closing as WORKSFORME.Createdscreen shot of the problem on MacThere has been no decernible change. The problem still happens. I'll attach a shot from the MacReopening. I have seen similar issues with vertical space on linux. Could easily be caused by something lower level than PDE since as far as I know we just create a composite the fills the area the form gives us.most likely a Forms issuebumping to RC1I'm not sure if this is a Forms or SWT issue.Kevin, any ideas?I suppose it's a layout issue. If it's happening on mac and windows I don't think that SWT would be to blame. Some widget's size must getting computed (or set) to be wide. I'd start by figuring out which control is causing the width to be so big.No one is currently looking at this bug, deferring.	9.0
id=160295	REOPENED	PDE	UI	3.2.1	PC Windows XP	P3 normal	PDE-UI-Inbox	2006-10-10 08:00 EDT by	Helmut J. Haigermoser	2009-09-24 13:14 EDT (	2 users	Ciao @ll :)When trying to export my product my CM keeps asking me whetheror not I want to check out the two mentioned files. My answer:1. "no": export operation is cancelled2. "yes": files are checked out, but not changed.I'd really like to avoid such CM operations during theexport, especially if the files in question are just finethe way they are...Thoughts?	What may be causing this need to rewrite is our attempt to replace the version number in the plugin.xml and manifest.mf files.Do you use ".qualifier" in your version numbers?That's it, my feature is of version x.y.z,the fourth digit, the qualifier, is unusedso far...Do your projects have a MANIFEST.MF file or are they old-style and use a plugin.xml to store the plug-in information? Pascal, the ManifestModifier class seems to keep a dirty flag so it doesn't write things back out if not necessary but the plugin.xml one doesn't keep track.My projects already had a Manifest.MFI just noticed this is marked as 3.2.1. Can you try this with a recent 3.3 build to see if you still have the same problem?Also an exact set of steps to reproduce the problem would be good. I don't have the same problem on build i20070410. I am creating a plug-in with version 1.0.0.qualifier and then exporting it. The timestamp of the plug-in's manifest does not change.This is reproducable with 3.3 M6.Did you try setting MANIFEST.MF readonly?CreatedMANIFEST.MF is checked outCreatedmanifest is checked out..Yes, I'm setting them manifest to be read-only. These are my steps. Do they work for you? Or maybe there is something that I am missing?- create new plug-in project- set the version to be 1.0.0.qualifier- mark the manifest to be read-only- file -> export -> Deployable plug-in- Note that the plug-in is exported correctly and the version is replaced(In reply to)Here are the steps to reproduce this:- Fire up plain 3.3 M6- Create new plug-in project- Create new product- Configure product:-- Add new plug-in to product-- Add a new product to the product, use any application.- Set Manifest read-only- Export productPlease NOTE that when trying to create a new product in the "Configure product" step above the same error occurs if the manifest is read-only, that's why I chose to set the file ro only as last step, however, I would say that's another problem. NOTE also that I did not have to set the version to ".qualifier" or something...I can reproduce with the attached steps.The problem comes from PDE UI. It seems to be caused by some validation steps being run as part of the product export (ProductExportWizard#performPreliminaryChecks - first call in the if (fPage.doSync()))Mike, when we synchronize, we should make sure to not dirty files unless we are making real changes.Using Build id: I20070517-1700.During the product export operation, PDE synchronizes relevant changes made tothe product configuration with the plug-in's manifest files. It is importantto note, that PDE almost always requires to read the manifest files duringa synchronize operation to determine if anything needs to be synchronized.This is probably causing the unwanted check-outs even though nothing is being modified.I have verified that the plugin.xml and MANIFEST.MF files are not dirtied unnecessarily (modified) by the synchronization operation.Basically, I went through all the different options in the Product editor pagesand did the following:(1) Toggled on an option(2) Saved the product configuration file(3) Synchronized the manifest files with the product configuration (using Synchronize hyperlink on Product editor Overview page) -> Made sure any change to the manifest files were necessary(4) Synchornized again (should be NO-OP) -> Made sure NO changes made to manifest files If you would like to prevent the automatic synchronization altogether duringevery product export, uncheck the "Synchronize before exporting" checkboxin the product export wizard. This should prevent the check-outs. Just make sure you manually synchronize using either the "Synchronize" or "Launch an Eclipse application" hyperlink on the Product editor Overviewpage.Closing as WORKSFORME.If you find a specific scenario where the synchronization unnecessarily dirties the manifest files, please reopen the bug.(In reply to)What does "WORKSFORME" mean here, does it work now to have read-only Manifestsand export a product or not? If not, why did you close the bugzilla? Did you try to reproduce my issues with the steps I described in?RE:WORKSFORME in this case, primarily means PDE is not unnecessarily dirtying any of the manifest files. Also, PDE is operating as expected under the constraintof read-only manifest files.And finally, there is a work-around of not synchronizing the product configuration with the manifest files if theyare read-only.I did reproduce your issue in; but, the behaviour you are observing is intended.PDE requires the plugin.xml and MANIFEST.MF to be writable during a synchronize operation between the product configuration and manifest files (which is invoked before the product exportif specified). In fact, we explicitly check to make sure the MANIFEST.MF and plugin.xml files are not read-only and abort if they are not made writable.(In reply to)Thanks for the explanation :)I'm still convinced it's a bug to make the Manifest file writable ifthere is no need for it, which is proven by the fact that it is leftunchanged during the whole operation. Wouldn't any attempt to actuallychange the manifest file lead to a "set writable" operation in any case?Anyway, I would suggest to either fix this behaviour (i.e. to leave Manifest files untouched if they are not actually changed) or set this t.o bugzilla to "Not a bug" with a hint to your suggested workaround(do not synchronize)...Actually you raise a valid point. If we do not modify the manifest files, they should not be made writable. We are essentially pre-empting any problems that could occur further along if the synchronize needs to modify the manifest files. Reopening to investigate alternatives.I'd like to add further that, regardless of whether or not the manifest files are read-only or read/write, they should not be touched unless synchronization has real changes to make (I've lost count of the number of times I've run a "Replace with Latest from HEAD" on my product plug-in plugin.xml file).Disabling automatic synchronization is not really a work-around, in my opinion, as this leaves the door open for the accidental introduction of inconsistancies between the two sources of product config information (which is not desirable, and certainly avoidable given that the software exists to ensure that this doesn't happen). I'd argue that if the synchronization software could be made just a bit smarter, the option to enable/disable synchronization could be safely removed from the product configuration editor, thus streamlining it a bit and eliminating an extra step/setting that the user has to worry about.Also, as an FYI: I encounteredwhich seems to be somewhat related with nailing down the definition and behavior of product config info synchronization.A quick clarification on my particular issue: I'm seeing the unnecessary update of the plugin.xml file in my product plug-in when I perform a product launch (as opposed to a product export).Newgroup reference:Thanks -Pete	19.0
id=204297	REOPENED	PDE	UI	3.4	PC Windows Vista	P3 enhancement	PDE-UI-Inbox	2007-09-21 13:19 EDT by	Mik Kersten	2007-10-08 13:22 EDT (	1 user	On projects that have a policy of no warnings (e.g. Mylyn) this recommendation pollutes the Problems view and AFAIK currently has no way of being suppressed. Since it is reasonable for the odd plug-in to not be unpacked (e.g. because it has HTML resources that need to be available via filesystem), it would be beneficial to have a way of suppressing this warning (e.g. via a Feature Builder project-specific preference similar to project -> Properties -> Plug-in Development -> Plug-in Manifest Compiler). The warnings have this form:Severity and Description Path Resource Location Creation Time IdIt is recommended for plug-in 'foo.bar' to run from a JAR, specify 'unpack="false"' attribute foo.bar-feature feature.xml line 104 1190394430628 495069	Your in luck. You can actually set your preferences to not create those markers.Open the Preferences (Windows > Preferences). Select PDE's Compiler Page (Plug-in Development > Compilers). Flip to the last tab 'Feature and Update Sites'. And set 'Unresolved plug-in references' to ignore. When the project is rebuilt, you should no longer see the errors.Mik, if you don't find this satisfactory, please reopen the bug and we can discuss.Brian: I'm using the work-around you suggested, so yup, I am in luck :) But I think that that this work-around may be problematic for the following reasons:* It's hard to think of a suggestion to pack a plug-in as an unresolved plug-in reference.* Whatever the option, it would be great to support in in the Project preference, which can be checked in, because overall I find this warning valuable and only want to have it ignored on very specific projects.I've updated the description, should we reopen?Reopening bug to track supporting project specific preferences for feature projects.	4.0
id=247679	REOPENED	PDE	UI	3.4	PC All	P3 normal	PDE-UI-Inbox	2008-09-17 12:18 EDT by	James Blackburn	2010-01-28 16:30 EST (	4 users	CreatedImage showing the problemBuild ID: 3.4Steps To Reproduce:1) Create a "Plug-in and Fragments Working Set" selecting some plugins (either in the workspace or provided by the platform).2) Select the working set in the Project Explorer view.3) The projects don't have icons, and their labels state: "Error: no label provider for org.eclipse.pde.internal.ui.util.PersistablePluginObject@..."This seems to happen every time.More information:Screenshot attached.	*** This bug has been marked as a duplicate of***Still happens in HEAD (I20090707-0800) if the "Plug-in and Fragments" working set contains an external plug-in (from the target platform).CreatedPlugins&Fragments working set with Team ProviderDamaged label provider.(In reply to)This happens also for "normal" plugin/fragment projects which are connected with a team provider. See my attachment.(In reply to)This happend in version 3.5.No plans to fix. I don't know why plug-in and fragment working sets even exist.	6.0
id=243438	REOPENED	PDE	UI	3.4	PC Linux	P3 enhancement	PDE-UI-Inbox	2008-08-07 11:40 EDT by	Wieant	2010-04-29 11:08 EDT (	7 users	Createdpatch proposalBuild ID: I20080617-2000Steps To Reproduce:1. set the 'Derived' Resource property of plugin.xml2. open the plugin.xml source page in the Plug-in Manifest Editor3. change anything that normally causes a warning/error markerNothing will happen as derived resources seem to be explicitly skipped in the ManifestConsistencyChecker builder.More information:	Why are your plug-in files and manifests marked as derived? Derived files are never validated usually.We don't validate derived resources for PDE. It doesn't make sense as far as I can tell.. and not sure how your files are ended up marked as derived.We have several product plugins there are almost similar but not entirely. So we have introduced a kind of preprocessing builder that generates the plugin.xml for these plugins, hence the derived status. This all worked fine until switching to Eclipse 3.4. For instance, one issue we encountered is that the generated plugin.xml contains a product extension, but when creating a launch configuration, this product id does not appear in the 'Run a product' dropdown list. When opening the plugin.xml on the source page you get a warning marker 'A plug-in manifest must contain at least one extension or extension point' while it clearly shows all extension points which are also perfectly editable in the 'Extensions' page. With some clearing/rebuilding/restarting we could work around most issues, but still not a perfect situation."hen opening the plugin.xml on the source page you get a warningmarker 'A plug-in manifest must contain at least one extension or extensionpoint' while it clearly shows all extension points which are also perfectlyeditable in the 'Extensions' page."This is telling you that your plugin.xml file is empty... it's a warning. The quickfixes available to you are to either add an extension or extension point, or remove the file. A plugin.xml is essentially useless with any extensions or extension points in it.Createdscreenshot of plugin.xml editor source page with invalid warningCreatedscreenshot of plugin.xml editor Extension pageWell I understand the warning and know about quickfixes, but the issue is that the plugin.xml is not empty, it contains all the right extension points. Attached a screenshot showing the not so empty plugin.xml file and one that shows the Extension page for the same plugin.xml source file. It is just one of the issues that popped up when switching to Eclipse Ganymede.!?What happens if you 'clean' the project. That's really weird. Maybe it's a stale marker?Createdpatch proposalFound another isDerived() test that seems to be responsible for the incorrect'plug-in manifest must contain at least one extension or extension point'warning. Using the latter patch proposal, handling derived plugin.xml filesappears to work fine again.The patch looks good to me (and is still valid on pde.core HEAD), but we should really get sure that no performance regression is introduced.IMO we would have serious performance issues if the bin/ derived folder were visited, but it's not the case in any of the two impacted files...Benjamin, the only problem I have is that nowhere in PDE do we mark a plugin.xml file as derived. This is something the user has done.(In reply to)See:"We have several product plugins there are almost similar but not entirely. Sowe have introduced a kind of preprocessing builder that generates theplugin.xml for these plugins, hence the derived status."I personally think this is rather fair to use the derived flag for this usage (i.e. the generated plugin.xml files will not be automatically added to source control, etc.)!***has been marked as a duplicate of this bug. ***Createdorg.eclipse.pde.core (patched)Here's a patched version of pde.core for Ruud.Let's look at this for 3.5.1 / 3.6(In reply to)Fyi: I've been using the patch for over a month now and I'm very happy with the results and my generated plugin.xml files. A 3.5.1 patch would be very welcome.	17.0
id=267162	REOPENED	PDE	UI	3.5	PC Windows XP	P3 enhancement	PDE-UI-Inbox	2009-03-05 04:22 EST by	Pavel Sklenak	2010-05-17 12:24 EDT (	3 users	Build ID: I20090202-1535Steps To Reproduce:I imported plugin fragment org.eclipse.swt.win32.win32.x86 into workspace then changed EventTable#handleEvent (added catch block with e.printStackTrace()) to debug my problem easily. After then I updated running configuration to use correct fragment. I started debugging at handleEvent() to ensure that right version is used. Debugging fell into wrong version of source attachment. I removed org.eclipse.swt.win32.win32.x86.source and restarted eclipse. Situation arose again with linux-gtk source attachment and later with carbon (see attached screenshot)	CreatedscreenshotIt sounds like a dupe of.*** This bug has been marked as a duplicate of***There are a couple problems here.is part of the problem (we aren't looking up source in fragments properly). However, the other issue that we need a way to install new source bundles into the running install, or we won't be able to find it.Currently, when we export/install into the running platform, we don't install source bundles (even when they are exported). We need to install them so that the target platform can find them.Re-opening to address second issue.	4.0
id=267629	REOPENED	PDE	UI	3.5	All All	P3 normal	PDE-UI-Inbox	2009-03-09 09:57 EDT by	Dani Megert	2009-08-12 12:01 EDT (	2 users	I20090309-0100.The import wizard shows:[ ] The active target platform (as specified in the Preferences)Previously there was a button that allowed me to check/change that preference. This functionality is missing in the latest I-build.	Press the "Target Definitions..." button. It takes you to the preferences.True, but not obvious because it is on the line which is not selected.The active target platform is the default choice and most users will know what is in their current target platform. If the user wants to import something specific, they can select a different target platform and open the preference page. Marking as WONTFIX.I'm old and can't afford to waste my memory with such details ;-)By all means, write at least what the value is.	4.0
id=297101	REOPENED	PDE	UI	4.0	All All	P3 enhancement	PDE-UI-Inbox	2009-12-07 13:12 EST by	Del Myers	2009-12-07 15:01 EST (	1 user	User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/532.0 (KHTML, like Gecko) Chrome/3.0.195.33 Safari/532.0Build Identifier: M20090917-0800I've had to write a couple of plugin fragments that require platform filters recently, and I found myself struggling due to lack of tool support for them. When platform filters get long, they can be difficult to verify just because they are visually difficult to understand. Consider this filter for a fragment that works for windows and linux:(|(&(osgi.os=win32)(osgi.ws=win32))(&(osgi.os=linux)(|(osgi.ws=gtk)(osgi.ws=motif))))logically, it works, if there is a problem, it is very difficult to spot it because of all of the parentheses, and the placement of the operators, etc. It is very difficult to spot, for example, where a parenthesis is closed.I suggest that there should be some more tool support for this. Even parentheses matching would be a help. But, would it be possible to have some sort of check-box based UI, in which you could select the platform components that are supported? It might be a little difficult because the filters allow for boolean expressions, but there should be a better way than what is currently available.Reproducible: AlwaysSteps to Reproduce:1. Try to make a long platform filter.	This is a great suggestion.I consider this a dupe of.*** This bug has been marked as a duplicate of***I'm just wondering if it is actually a duplicate? My issue is with the platform filter tooling support, not the Bundle-Native-Code property. Though I'm sure that there could be better support for that as well. Is there any necessary connection between the platform filter and the native code property?Yes, my mind blanked. You're correct.I swear we had a dupe for this one somewhere too :) Can't find it atm so reopening.	3.0
id=318948	REOPENED	PDE	UI	3.6	Macintosh Mac OS X	P3 normal	PDE-UI-Inbox	2010-07-05 19:29 EDT by	Miles Parker	2010-07-12 14:31 EDT (	1 user	To reproduce:1. Create a folder within an existing PDE project.2. Create a build.properties file within that folder.3. Open the file.The editor will open the build.properties file for the project as a whole. (And to the wrong page, so this is tangentially related to.)	This works for me using 3.6.I added a /test/build.properties to the project. Was able to open/edit the files with the build.properites editor independently.Darin,On reconstructing a test case from scratch I discovered that this only happens in some circumstances -- that wasn't obvious because I had many projects open at the time and I assumed that it was a more general issue. Here's a test case that I ran through from scratch. It might fail in other circumstances but I'm certain that it fails in this one for me.1. Create a new *Feature* Project.2. Create a folder "test" within that project.3. Create a file "build.properties" in test.4. Open the MANIFEST.MF file for the feature, i.e. test.feature/MANIFEST.MF.5. (At this point, you might move to the build.properties page.)6. Open the build.properties file in the test folder, i.e. test.feature/test/build.propertiesNote that if you simply open build.properties this own't happen, because that causes the simpler build editor to open. I'm on Mac OS X (changed to specify) so if you can't reproduce on your platform it should be tested there.	2.0
id=319268	REOPENED	PDE	UI	3.6	PC Linux	P3 major	PDE-UI-Inbox	2010-07-08 09:50 EDT by	Igor Fedorenko	2016-04-26 06:27 EDT (	11 users	In my development workspace I have a combination of PDE and regular java projects. Some of my non-PDE projects *happen* to have META-INF/MANIFEST.MF. Even though the projects do not have PDE.PLUGIN_NATURE, PDE still parses META-INF/MANIFEST.MF files and considers whatever it is able to find there during resolution of dependencies of (proper) PDE projects. These unexpected and often invalid dependencies pollute compile classpath inside workspace and, more importantly, cause runtime problems for Eclipse applications and JUnit Plug-in tests launched from the workspace.I have rather trivial fix (check for PDE natures in org.eclipse.pde.internal.core.WorkspaceModelManager isXXXProject methods), if you are interested.	(In reply to)Suggested fixes are always welcome.I'm surprised that there isn't already a check for the PDE nature. Marking for M1 inclusion. We just have to make sure that there isn't a case that expects this behaviour (where a plug-in is in the workspace, but doesn't have a PDE nature). The only place I could think of where this could happen would be importing binary projects, however, we do assign a PDE nature to all the imported plug-ins.Chris, Darin, any other ideas what side effects this change could have?I recall that this is a feature, but I can't recall exactly why. Tom, do you know the history on this?(In reply to)I do not recall the history of this "feature". So the non-PDE project has a manifest with some OSGi headers (e.g. Bundle-SymbolicName and Export-Package) and other PDE-projects are able to import packages from the project or require-bundle on it? That does seem incorrect.Createdproposed patched that add project.hasNature to relevant methodsAlright, since consensus appears to be this is a bug, attached is a proposed fix that adds project.hasNature checks to isXXXProjet methods of WorkspaceModelManager. The patch appears to work for my workspace but is not tested otherwise ;-) Also, I am not sure about possible natures of binary projects, so I added both plugins and features to isBinaryProject. Hope this helps.Patch seems reasonable. Chris, do you know if there's any reason PDE does not require a PDE nature to consider a project a plug-in/bundle?(In reply to)I can't think of any reason off the top of my head. Many years ago we put some things in the PDE code to help the Harmony team use PDE to develop Harmony. I would just double check with the team to see we don't break their development workflow. Other than that, this change seems reasonable.(In reply to)Even in that case, is it not reasonable for the harmony projects to have a PDE nature?(In reply to)"But why do we need to check in these .project files everywhere"*sigh*It is too late to put this in for M1. Since no one has been able to come up with a concrete case for not changing this, we'll try it in M2.I applied the patch with one modification, I took out the changes to isBinaryProject. For a project to be 'binary' it needs to have a internal property set on the project. Only the PDE tooling should be modifying the property and if a project has that property set, we should assume it is intended to be there even if the project doesn't have a plugin or feature nature.Thanks for trying :-(This causesand probably also.Also, I do not see what's 'major' here.RE-opening.I've reverted this fix in HEAD.(In reply to)What sort of content is in the manifests in the regular Java projects? Are theybundle manifests or something else? Can you attach a sample?My non-PDE projects have perfectly valid bundle manifest generated by maven-bundle-plugin.We should document and write a test for this case as no one knew that some SDK projects were missing the nature. We should add the nature to those projects () so that in a future release we might be able to require that only projects with the correct nature get built.Right but my problem was not about building but simply launching with the SDK project in my workspace. Once the project has been built it might not be required to still have (and test for) the nature. Like the binary bundles don't keep that info either.Marking for consideration in 4.5. Inwe discovered that when the PDE model state changes, all 'plug-in' projects get touched. However, we do not check for the PDE nature, so we end up forcing projects unrelated to PDE to build.	19.0
id=322773	REOPENED	PDE	UI	3.7	PC Windows XP	P3 normal	PDE-UI-Inbox	2010-08-16 06:15 EDT by	Markus Keller	2016-06-20 08:42 EDT (	3 users	I20100810-0800I've changed the EE of org.eclipse.jdt.junit on the classpath from J2SE-1.4 to J2SE-1.5 and updated the project-specific compiler compliance settings, but I forgot to update the Bundle-RequiredExecutionEnvironment in the MANIFEST.MF.After that, I got the following warning on build.properties: "There is no 'jre.compilation.profile' build entry and the project has Java compliance preferences set".Problems:- The warning did not appear before (when compliance matched the BREE's compliance) => Warning should tell about the mismatch, e.g.: "There is no 'jre.compilation.profile' build entry and the project has Java compliance preferences set that don't match the Bundle-RequiredExecutionEnvironment".- The problem should have a quick fix that fixes the BREE in the MANIFEST.MF.	*** This bug has been marked as a duplicate of***Sorry for closing this bug. It was a mistake ... I'll reopen it	2.0
id=323289	REOPENED	PDE	UI	3.6	PC Linux	P3 major	PDE-UI-Inbox	2010-08-20 15:16 EDT by	Stephen McCants	2014-12-01 15:39 EST (	3 users	Build Identifier: I was trying to switch target platforms from the default "Running Platform" to my groups target platform definition and I got this error everytime I hit Apply:java.lang.NullPointerExceptionat org.eclipse.pde.internal.core.target.IUBundleContainer.resolveWithPlanner(IUBundleContainer.java:306)at org.eclipse.pde.internal.core.target.IUBundleContainer.resolveBundles(IUBundleContainer.java:195)at org.eclipse.pde.internal.core.target.AbstractBundleContainer.resolve(AbstractBundleContainer.java:97)at org.eclipse.pde.internal.core.target.TargetDefinition.resolve(TargetDefinition.java:239)at org.eclipse.pde.internal.core.target.provisional.LoadTargetDefinitionJob.handleReload(LoadTargetDefinitionJob.java:361)at org.eclipse.pde.internal.core.target.provisional.LoadTargetDefinitionJob.loadPlugins(LoadTargetDefinitionJob.java:284)at org.eclipse.pde.internal.core.target.provisional.LoadTargetDefinitionJob.runInWorkspace(LoadTargetDefinitionJob.java:141)at org.eclipse.core.internal.resources.InternalWorkspaceJob.run(InternalWorkspaceJob.java:38)at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)The target platform definition was okay, pointing to valid directories with plugins in them. I tried moving back to Eclipse 3.5.2 and didn't have this problem.Magically, the problem went away after struggling with it for four hours.Reproducible: SometimesSteps to Reproduce:1. Start Eclipse 3.62. Switch target platform definitions in the Preferences3. Click "Apply"4. At "Load Target Platform 31%" you'll get a NPE.	Are you using the official helios release? I just want to make sure that the line numbers are accurate as there are a couple similar npes that have been fixed (such asfixed in 3.6.1).I do see how we could end up with an NPE while looking up artifacts in the bundle pool. If the bundle pool directory has been deleted (or myabe if it wasn't created by p2 earlier in the resolve) the repo would be null.Yes, I'm using the official 3.6 release.Where does the bundle pool directory exist?(In reply to)<workspace>/.metadata/.plugins/org.eclipse.pde.core/.bundle_poolSo, let us suppose that it some how got deleted in my current workspace (this workspace worked before this morning and started working again this afternoon). Then creating a new workspace should have resolved the problem, right?Unfortunately, when I tried creating a new workspace, the new workspace didn't work either. Shortly after the old workspace started working (using 3.5.2, instead of 3.6), the new workspace (never touched by 3.5.2) started working too. Now both workspaces work for 3.6.Strange problem.I just hit this too with the official 3.6 release.I was changing target platforms and after applying the change my workspace started rebuilding. During this time, I switched target platforms and got the NPE while loading the new target. Whenever I try to load this target I get the NPE. Restarting does not resolve the problem. Creating a new workspace still results in a NPE.I'm not sure why I would magically get the NPE unless the target platform switch while building corrupted my bundle pool. It doesn't really explain why a new workspace gets the same NPE. It's just this one target platform that doesn't work. If I use another one, it's fine.I'm using target platform files explained here:Fixed in HEAD, see IUBundleContainer.java. This won't make your bundle pool work if it has problems, but it will prevent the NPE and instead provide the actual error p2 is throwing.I've run into this as well on 3.6.2, after manually clearing out the .bundle_pool. Workaround: Rename the target platform definition file and open it, at which point the bundle pool is repopulated and all appears to be fine...I still see similar behavior on 4.4.0. Switching between two target definitions where one has a newer version of mockito eventually caused my .bundle_pool to end up to be inconsistent. I tried removing but then also ran into the problem of re-populating it. Reading the workaround that Eric had posted helped in my case: rename the .target file, set it as the target platform and watch the .bundle_pool fill up.This seems pretty broken, still so many years after the issue was already described. Any ideas what a good fix could look like? I really suggest re-opening this bug.Reopening as requested. Do you have additional information in the log?One element I was able to see in the .log file that may be of interest was this:!ENTRY org.eclipse.pde.core 4 0 2014-12-01 20:46:57.146!MESSAGE The current target platform contains errors, open Window > Preferences > Plug-in Development > Target Platform for details.!STACK 1org.eclipse.core.runtime.CoreException: Problems occurred getting the plug-ins in this container at org.eclipse.pde.internal.core.PluginModelManager.getExternalBundles(PluginModelManager.java:604) at org.eclipse.pde.internal.core.PluginModelManager.initializeTable(PluginModelManager.java:525) at org.eclipse.pde.internal.core.PluginModelManager.targetReloaded(PluginModelManager.java:473) at org.eclipse.pde.core.target.LoadTargetDefinitionJob.resetPlatform(LoadTargetDefinitionJob.java:229) at org.eclipse.pde.core.target.LoadTargetDefinitionJob.runInWorkspace(LoadTargetDefinitionJob.java:150) at org.eclipse.core.internal.resources.InternalWorkspaceJob.run(InternalWorkspaceJob.java:38) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)I'll continue trying to reproduce.It's fairly easy to reproduce the "rename-to-populate" behavior. When I remove .bundle_pool, reloading the target platform gives errors due to bundles not being found. Re-starting with -clean, renaming the .target file and setting that as the target platform properly loads the bundles into .bundle_pool each time I've tried. This in itself is a bit awkward as Eclipse would have to expect the directory to become inconsistent for any reason and should offer an intrinsic way to make the .bundle_pool consistent again. Explicitly reloading the target platform selected would be a good point in time to do so.I now tried again to reproduce the problem with the mockito upgrade. I built a local p2 repository that has a newer version of mockito (1.10.14 instead of 1.9.5), then switched to a target definition that refers to the local repository using a file:// URL. The status bar said "loading target platform" but the new mockito JAR didn't make it into .bundle_pool where still only the old version resides. The .log file again has:!ENTRY org.eclipse.pde.core 4 0 2014-12-01 21:32:18.330!MESSAGE The current target platform contains errors, open Window > Preferences > Plug-in Development > Target Platform for details.!STACK 1org.eclipse.core.runtime.CoreException: Problems occurred getting the plug-ins in this container at org.eclipse.pde.internal.core.PluginModelManager.getExternalBundles(PluginModelManager.java:604) at org.eclipse.pde.internal.core.PluginModelManager.initializeTable(PluginModelManager.java:525) at org.eclipse.pde.internal.core.PluginModelManager.targetReloaded(PluginModelManager.java:473) at org.eclipse.pde.core.target.LoadTargetDefinitionJob.resetPlatform(LoadTargetDefinitionJob.java:229) at org.eclipse.pde.core.target.LoadTargetDefinitionJob.runInWorkspace(LoadTargetDefinitionJob.java:150) at org.eclipse.core.internal.resources.InternalWorkspaceJob.run(InternalWorkspaceJob.java:38) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)Contains: Required plug-in could not be found: org.mockito.mockito-coreContains: Required plug-in could not be found: org.objenesis!SUBENTRY 1 org.eclipse.pde.core 4 0 2014-12-01 21:32:18.330!MESSAGE Problems occurred getting the plug-ins in this container!SUBENTRY 2 org.eclipse.pde.core 4 100 2014-12-01 21:32:18.330!MESSAGE Required plug-in could not be found: org.mockito.mockito-core!SUBENTRY 2 org.eclipse.pde.core 4 100 2014-12-01 21:32:18.330!MESSAGE Required plug-in could not be found: org.objenesisAn explicit "Reload" in the target platform settings dialog gives an error popup saying "Problems occurred getting the plug-ins in this container" listing the mockito-core and the objenesis bundles as "could not be found."And, as before, renaming the .target file that points to the local file:// repository and then setting it using Window > Preferences > Plug-in Development > Target Platform immediately loads the new versions into .bundle_pool and the workspace build succeeds. The .log file does not provide any new messages for these actions.	14.0
id=326259	REOPENED	PDE	UI	3.6.1	PC Windows XP	P3 normal	PDE-UI-Inbox	2010-09-26 14:54 EDT by	Joe	2010-09-29 16:03 EDT (	4 users	Build Identifier: Eclipse 3.6.1 M20100909-0800I have a Target Platform which contains one plugin deployed as directory. One of my projects uses a class from this plugin. Eclipse will not find classes from plugin. If the plugin is deployed as jar file then Eclipse will find the classes.Expected behaviour: Eclipse should find classes from both bundle shapes (jar and directory).Reproducible: AlwaysSteps to Reproduce:Testcase will be attached1. Extract the testcase and import it into a workspace.2. Close project a.testcase. It contains the source for the plugin used in Target Platform3. Create and activate a custom target platform. The custom platform uses Platform/plugins and ${eclipse_home} as Locations.4. Rebuild the workspace5. Project b.testcase will show 3 compile errors. 'A cannot be resolved to a type' (2x) and 'The import a cannot be resolved'.6. The compilation problems can be fixed by packing the plugin as a jar.7. A restart may be required.	Createdtestcase addedAccidentaly set the version to 3.7. 3.6.1 is correctMay be a PDE problem. Moving to PDE/UI for comment.The problem is real. Tested and confirmed on latest I-build.May be Dupe of.The bundle "a.testcase" is configured to have class files compiled/located at the root of the bundle (since no bundle classpath is specified, and build.properties includes the default output locatoin of "."). However, the class files are in the /bin folder of the bundle, and as such will not be found. The project is not in a "deployed bundle" format and cannot be used as part of a target platform.Marking as dup.*** This bug has been marked as a duplicate of***I think you have closed this too early.I haven't talked about the bundle 'a.testcase'. 'a.testcase' is just there to provide the source code. This bundle is just there to provide the source code.Please look at 'Platform\plugins\a.testcase_1.0.0.201009261748' it contains the exported version of the bundle. If you set 'Platform\plugins' as your custom target platform then eclipse will not find classes inside the bundle 'Platform\plugins\a.testcase_1.0.0.201009261748'.If you jar the bundle to 'Platform\plugins\a.testcase_1.0.0.201009261748.jar' then eclipse will find the classes. A restart might be required.(In reply to)Yeah, we might have. The jarred plug-in does appear to be the right format. We'll have to take a second look.	7.0
id=308274	REOPENED	PDE	UI	3.5.1	PC Windows 7	P3 normal	PDE-UI-Inbox	2010-04-06 17:57 EDT by	Michael Moser	2010-04-14 16:01 EDT (	3 users	From a PDE forum discussion:On 3/30/10 3:12 PM, Michael Moser wrote:Can you file a bug for this? You shouldn't get that warning at all :)Cheers,Chris Aniszczyk+1 860 839 2465	We need more detailed steps to reproduce. If I have a plug-in with all packages exported I do not get a warning.What build are you using (3.5.1?)Are you in a clean workspace, how did you create the plug-in, did you use a template, what packages are listed in the manifest?I am getting this the very moment I create a new Plugin-Project, i.e. I pick File => New => Other => Plugin Project, I pick, say "Hello RCP" and click Finish and - voila - there is that warning:Description Resource Path Location TypeThis plug-in does not export all of its packages MANIFEST.MF /TestForExportWarning/META-INF line 1 Plug-in ProblemCreatedMy newly created plugin projectBy default, the compiler setting for missing exported packages is set to IGNORE. It's done so these type of warnings don't come up by default. Eclipse.org projects are expect to export everything so this is why this compiler setting is available. I'm going to close this as INVALID because everything is working as planned.Sorry to reopen, but I have two objections here:First and minor: If that flag should be set to IGNORE by default why is it then on "Warning" in my case? I can't remember that I ever modified that.Second and major: I am getting this warning also, if I *do* export everything, i.e. even if I list *all* packages defined in my plugin I am still getting this warning. So, apparently, *enabling* warnings invariably also *triggers* warnings which is *not* what I would expect as a user. Does the code behind that warning actually validate anything or does it simply always emit a warning if enabled? So, to summarize: either that option is useless and hence should be removed or it should be fixed to actually validate what it's supposed to check and only issue warnings if necessary.MichaelComing back to this: I actually may have been fooled by an odd effect: apparently that warning is a marker that does not get automatically removed, if the warning is no longer valid. I just tried and explicitly deleted that warning and then did a build clean and it indeed did *not* show up any more. So, apparently the problem was just, that the warning didn't go away "by itself" but that one explicitly has to remove it and only if then comes up again, there still is an issue...That's also not quite what I would expect, but if one knows that one can actually get "silent" builds (which is what I am always aiming for...).MichaelSorry again and sorry for the bandwidth, but I have to call back my last statement () and reopen again. In an other project that warning keeps re-appearing even after deleting it and even though I *do* export all packages of that plugin! So, alas, my objection () still holds!MichaelAfter changing the manifest to export all the packages, you are saying the warning continues to show up? If you close the editor and reopen it does the warning remain? Is this now only happening in some other plug-in or does it happen in the attached project as well?I don't know why your preferences were set to warn instead of ignore. The default has been ignore for at least a couple years.	8.0
id=330926	REOPENED	PDE	UI	3.6	PC Mac OS X - Carbon (unsup.)	P3 normal	PDE-UI-Inbox	2010-11-23 10:02 EST by	Randy Hudson	2010-11-24 12:45 EST (	1 user	When I add a new dependency, I get something like:com.company.foo;bundle-version="1.2.0"Which eventually becomes incorrect when 1.3.0 is actually being used for development and nobody updates the min-version. Or, it becomes annoying when the bundle is updated to 2.0.0, causing a false negative when compiling against the newer version of the dependency.Please provide a preference setting so that only the following is added when using the "Add..." action in the "Required Plug-ins" section of the manifest editor and related UI pieces (like quick-fix, etc.):com.company.foo	As part ofwe are investigating the right lower and upper version limits. I am updating the description of that one to bring this also under its scanner and closing this as duplicate.*** This bug has been marked as a duplicate of***IMOshould not be fixed. Just because a major version of a bundle **might** break bundles which depend on it doesn't mean that it will. If you add an upper limit of ",4.0)", you are guaranteeing breakage.Why was this a dupe? 288396 is asking for more, this bug is asking for less (and implies a new preference page setting).	2.0
id=342454	REOPENED	PDE	UI	3.7	PC Mac OS X - Carbon (unsup.)	P3 normal	PDE-UI-Inbox	2011-04-11 11:30 EDT by	Bryan Hunt	2011-04-15 09:12 EDT (	2 users	I'm running Eclipse 3.7M6. If I bring up the Target Definition editor and attempt to add the Linux Tools from the Indigo P2 repository, I will get an error that the filter does not match. I'm building for multiple platforms which includes Linux and I'd like to include the Linux tools in my build.	You need to uncheck required software at the bottom of the wizard when adding/editing a p2 repo location. When checked, the option will check that all required software (including OS restrictions) is available.CreatedscreenshotThat's great except that it doesn't work. I tried to add all of CDT to my target platform with the that checkbox unchecked and got the error shown in the screenshot.Jeff, any ideas?Do you have the Include all Environments check box set?Alternatively, on the the Environments tab, did you set the Operating System to be linux?Either one of those works for me.	4.0
id=365228	REOPENED	PDE	UI	3.7.1	PC Windows XP	P3 normal	PDE-UI-Inbox	2011-11-30 12:37 EST by	None	2011-12-05 07:41 EST (	4 users	Build Identifier: M20110909-1335The text boxes for workspace locations should be in ltr but are being scrambled when eclipse is run in Hebrew.Reproducible: AlwaysSteps to Reproduce:1. Open window -> preferences2. Select Plugin Development	CreatedExample of the issue in Hebrew.*** This bug has been marked as a duplicate of***(In reply to)I don't think this bug here will be automatically fixed by the fix for.Thanx Dani, you're right. Once that's fixed, we'll have to take advantage of what the input fields offer.PW	4.0
id=375386	REOPENED	PDE	UI	3.7.1	PC Windows 7	P3 normal	PDE-UI-Inbox	2012-03-27 04:13 EDT by	Tobias Willig	2012-03-29 09:38 EDT (	3 users	Build Identifier: Version: Indigo Service Release 1 Build id: 20110916-0149I develop Eclipse Plug-ins, which use the PDE. In order to explain under which conditions the bug occurs, I like to distinguish between two Eclipse instances. I will refer to my Plug-in development Eclipse instance as DevEclipse and to my Plug-in testing Eclipse instance as TestEclipse. First, I create a new Plug-in called BasePlugin in DevEclipse. BasePlugin is based on a JAR file and is created using the “plug-in from existing JAR archives” wizard. My TestEclipse instance uses the BasePlugin and the PDE. I start my TestEclipse instance and create a new Plug-in called DependentPlugin. In the DependentPlugin Manifest file I add BasePlugin to the list of required bundles. I can now use the exported classes of the JAR file of the BasePlugin in my DependentPlugin. All is fine so far.Now I add a source folder, a Java package and some Java classes to the BasePlugin. I export the newly created Java package via the Manifest file. I also add “.” to the Classpath in the Manifest file. I’m now able to use the exported Java classes and the exported classes of the JAR file of the BasePlugin in any Plug-in in my DevEclipse instance. If I try to use the exported classes in my DependentPlugin or any other Plug-in in my TestEclipse instance, PDE is unable to resolve the dependencies. PDE either cannot resolve the classes of the source folder or the classes of the JAR file of the BasePlugin. PDE’s resolving behavior seems to be dependent from the current workspace in DevEclipse. P.S. PDE was able to resolve some ”javax” packages of the JAR file of the BasePlugin. Use “org” packages when you try to reproduce this bug.Reproducible: AlwaysSteps to Reproduce:1. Create a new Plug-in project called <BasePlugin> from an arbitrary JAR file2. Use the “plug-in from existing JAR archives” wizard for the Plug-in creation3. Uncheck the “Unzip the JAR archives into the project” option4. Use JavaSE-1.6 Execution Environment5. Create a source folder, a Java package and a Java file in <BasePlugin>6. Export the newly created Java package via the Manifest7. Add “.” to the Manifest Classpath8. Start the Plug-in using the “Run as Eclipse Application” option9. Create a new Plug-in project called <DependentPlugin> in the newly started Eclipse Application10. Add <BasePlugin> to the list of required Plug-ins in the <DependentPlugin> Manifest file11. Try to use classes of the JAR file and of the Java package of <BasePlugin>12. PDE is unable to resolve the dependencies	To me this sounds like a configuration problem, not a bug in PDE.Your 'TestEclipse' is what we call a runtime workbench. It was started using a combination of the workspace and target plug-ins from the host Eclipse. Your TestEclipse also has a target platform and this is where the dependent plug-in is found. PDE does a special step called 'target weaving' so that the target platform in your runtime workbench includes the projects from the host workspace.While target weaving does allow you to do plug-in development in a runtime workbench, it isn't a supported workflow.If the editor in Dependant Plug-in offers BasePlugin as an option to add to the list of required plug-ins, that means that target weaving is happening successfully. The fact that the classes you need are not available suggests something is wrong with how BasePlugin exports its packages.You can open the Plug-in Dependencies container in the package explorer view inside the DependentPlugin. This is the PDE classpath and BasePlugin should be listed, with all available packages inside.For now I am closing this as INVALID. Please reopen if this is a real bug that impacts your work.Well it is a bug for 4 reasons:1. All packages are correctly exported in the BasePlugin.2. If I remove the source folder package from the list of exported packages and remove “.” from the classpath in the BasePlugin, I can still use the source folder classes in the DependentPlugin and I still cannot use the classes of the exported JAR file packages. This is a very odd behavior.3. PDE’s behavior seems to be workspace dependent and not project dependent.4. In the “Plug-in Dependencies “of DependentProject only the bin folder of the BasePlugin is listed and it includes only the packages of the source folder. This is also odd, because in the Manifest of the BasePlugin the JAR packages are correctly exported.Tested it out and confirmed that this is a bug.What I find most odd is that the bin folder is correctly added to the PDE classpath container. JDT knows about the class (can be found in OpenType) and it's source attachment is there too. Yet, when trying to import any of the classes to a file in the dependent project, the classes can't be resolved. I am cc'ing some JDT committers as they have far more knowledge of how the classpath is resolved.The other part to this bug is that packages exported from a jar file are not added to the classpath at all. I suspect this is a bug in how we write out the dev.properties file at launch time.However, neither of these are high priority. Developing plug-ins in a runtime workbench is not a supported workflow. This is nothing to do with the workspace you are using and instead all about how the IDE is started.(In reply to)Satyam, can you take a look and see what's up ? Thanks.Curtis,JDT/Core would need the bin directory in the classpath rather than root directory. If you had noticed, the 'Open Type' shows bin.<qualifiedtype>.(In reply to)Thanks Satyam, I didn't notice that. This definitely indicates the bug is in where PDE writes out the dev.properties at launch time.	6.0
id=423324	REOPENED	PDE	UI	4.3.1	PC Windows 7	P3 normal	PDE-UI-Inbox	2013-12-05 09:48 EST by	Mike Urann	2013-12-18 13:49 EST (	1 user	CreatedFirst half is the output of the console tab of the IDE, second half is the 1386251685153.log file created by the IDEHad this problem on a project I'm working on but was able to replicate it with a very simple program which I'll explain later. After you've created this simple program and you run a program from the IDE by clicking Launch an Eclipse application from the product file, it works. If you export the product and run that from the command prompt, it works. If you copy the config.ini file from the exported product to the workspace such that you can use that config.ini file as your custom config.ini in the IDE, it fails. Have verified this on Windows 7 (those files are attached) and also on Red Hat 6 with GTK.Here are the steps to replicate the problem.1. download 64 bit version of Eclipse for RCP and RAP Developers2. Install the following e4 tools: + CSS spy for Eclipse 4 [E4 CSS Spy (Incubation)] + Eclipse 4 core tools [Eclipse e4 Tools (Incubation)]3. Create a simple project + Click File -> New -> Other + Select Eclipse 4 -> Eclipse 4 Application Project + give it a name and click next and then click Finish4. Open the .product file, go to the Overview tab and click Launch an Eclipse application to verify it works5. Right click the product and select Plug-in Development -> Eclipse product and select Next6. Give an output location and click Finish7. Go to that output location, find the executable and run the product to verify it works8. from the same directory as that executable, go to the configuration directory and find config.ini9. copy that config.ini to the workspace that was used to create this product10. refresh the workspace and verify the config.ini file is now in the workspace11. In eclipse, open the .product file and go to the Configuration tab and select 'Use an existing config.ini file'12. Click Browse and then find and select the config.ini file that was just copied over13. save the workspace14. Open the .product file, go to the Overview tab and click Launch an Eclipse application to verify it does not work	1) please attach the config.ini that was generated that you now want to use.2) after you set the config.ini in the .product file, please delete the existing launch config before trying to launch again (as changes to the .product file are not made to the launch config reliably).PWCreatedconfig.ini usedRequested to have the config.ini file attached which this is.I did try deleting the launch configuration but the result was the same.You cannot use a relative path osgi.bundles config file in a PDE launch config. To compare, you can look in your <workspace>/.metadata/.plugins/org.eclipse.pde.core/<product_launch_name>/config.ini if you go back and generate your original Launch config with the auto-generated config.ini.ex:osgi.framework=file\:/opt/local/e4-self/I20131126-0800/eclipse/plugins/org.eclipse.osgi_3.10.0.v20131121-1552.jarosgi.bundles=reference\:file\:/opt/local/e4-self/I20131126-0800/eclipse/plugins/org.eclipse.core.contenttype_3.4.200.v20130326-1255.jar,reference\:file\:/opt/...Without absolute paths I'm guessing it can actually find any of the bundles.PWForgot to mention that this error only occurs on the 64 bit version of the IDE. If I do the same steps with the 32 bit version of 4.3.1, all scenarios work.Tried the config.ini that was mentioned with the same result.Deleted the launch config again and tried but it failed again.Cleared the workspace instead of deleting the launch config but that also failed.Can someone verify that they can replicate the problem on their machine? Curious to see if the error could be caused by an enironmental error on my side.(In reply to Mike Urann from)OK, but it will have to be after next Tuesday.PWDid you change the .product file between one and the other? Or does your product file list all different native fragments?PW(In reply to Paul Webster from)I don't understand your question. Not sure if you mean the .product file between 32bit Linux and 64bit Linux or between 64bit Linux and 64bit Windows or if you are referring to something else. Whichever one you are referring to though, I followed the steps given in the bug report from scratch on all 3 systems I did this test on (32bit Linux, 64bit Linux, and 64bit Windows). If you are asking if I used the same .product file for more than one test, I did not. Eclipse made a new one each time. If you are asking if I made one project and added delta packages so that I could export it to multiple platforms, I did not do that either. It only takes a few minutes to replicate the problem so I did it from scratch on each system with a JDK and a version of Eclipse for that system. If you are asking me something else then I'm not sure what that is so please give me some more information so that I can answer your question. On a different note, were you able to replicate the problem on another machine? I would still like to verify it isn't a environmental issue on my end.(In reply to Mike Urann from)Yes, this was what I was asking, thanks.I can reproduce the failure on linux x86_64.PW	9.0
id=433980	REOPENED	PDE	UI	4.4	PC Mac OS X	P3 enhancement	PDE-UI-Inbox	2014-05-02 07:08 EDT by	Steven Spungin	2014-05-05 10:39 EDT (	2 users	 	partial implementation is in this patch:The gerrit link points to a change set containing e4.emf changes with 10 pathc sets and 4 bugs listed in the commit comment. Closing this as INVALID.If you want to contribute something to PDE, please reopen, adding a description/steps to reproduce and a new patch set with just the pde changes.I posted the link as a reference so someone would not have to reinvent the wheel if implementing. Referenced patch paves way for implementations to index entire drive for manifests.The PDE shows an error when a bundle cannot be resolved, without any quickfix options to resolve it. That has NOTHING to do with the patch I posted.Steps to reproduce: Put an invalid bundle (not in workspace or target platform) in the require-bundle section of a manifest.See screenshot for current quick fixes. Suggestion is for an option to search for bundle.Createdscreenshot	4.0
id=438526	REOPENED	PDE	UI	4.4	PC Mac OS X	P3 enhancement	PDE-UI-Inbox	2014-06-30 05:08 EDT by	Christophe Bouhier	2015-09-23 07:02 EDT (	3 users	In the spirit of Ruby On rails, Bundler -> git support:gem 'forem', :github => 'radar/forem', :branch => "rails4"Dependencies in Ruby On Rails are in a so called "Gemfile", can get them by using a github location. more reading:An equivalent for Eclipse target, could be created for a .target file source location. why: well simply cut-out an intermediate step, which is a P2 repo, when we can get plugins/features from the source.	To load source into your workspace you use a PSF file, not a target definition (which is, by definition, binary artifacts).Are you asking for a way to fill in a target definition but have PDE load source for some bundles into your workspace?PWPaul, This is not about loading source in the workspace, but about a target source location being a git repo containing features/plugins. These would be loaded in the target. (In the same way the plugins in the workspace end up in the target). So what I mean is this, see the repository location. <?xml version="1.0" encoding="UTF-8" standalone="no"?><?pde version="3.8"?><target name="test" sequenceNumber="0"><locations><location includeAllPlatforms="false" includeConfigurePhase="true" includeMode="planner" includeSource="true" type="InstallableUnit"><unit id="" ><repository location=""/></location></locations></target>For the Eclipse SDK (and any other bundles that include the Eclipse Source Reference header), you can already import the git repo source for bundles in your target.File > Import > Plug-ins and FragmentsImport from: Active target platformImport As: Projects from a RepositoryThis will search your target platform for bundles with a source reference header. That header specifies the git (or CVS or SVN) location to get the source for the project.(In reply to Christophe Bouhier from)p2 does not recognize a git repository as a valid repository.While a new location type could be created for Git, this would not be effective as the target platform requires the built binary bundles, not the source.Closing as INVALID.(In reply to Curtis Windatt from)Yes, the point of this bug is to support this.How true is this statement, when the plugins in my own workspace (Which are not binary) are mixed into the Target Platform.It seems to me the bug is closed very quickly. I started this bug with a comparison from another framework where this is common practise and very appreciated I can assure. What would you need to be convinced? More uses cases, votes etc..?(In reply to Christophe Bouhier from)But they're in your workspace. A mechanism to load bundles from the target platform into your workspace exists already, under File>Import...>Plug-in Development>Plug-ins and Fragments. You can import them as source, and import them from their repository (usually git).PW(In reply to Paul Webster from)so, a git source locations could resolve in the workspace as well. I use target files with tycho. I can easily imagine the IU's from a git location end up in the workspace as well. This would especially make sense with a headless build using tycho and hudson/jenkins.Perhaps in the Ruby world it works, because there are no compiled/linked binaries...A mechanism to load bundles from the target(In reply to Christophe Bouhier from)As an enhancement, it's possible that target files could be enhanced with a "and load from the EclipseSource header into workspace" for loading a target platform into the IDE with PDE. Although that seems like something you'd want as an import switch/check-box to allow the user to control (I wouldn't want the source for my target platform, except in rare circumstances).Tycho is a different component, and not part of PDE. It doesn't have a workspace, so there's no place to grab the source. I also suspect loading the target platform happens at a maven build step/phase that might make it difficult to suddenly materialize source in the current maven reactor (where it would have to be in order to be compiled).If you want a target platform to fetch and compile source in tycho, you should open a bug against them though, and see what they have to say.PWHi Guys, What I really would like to have addressed, is outdated P2's or in other words compile against the latest in a git repo. We now have a build cycle, where every library/project has to produce an integration type of p2, which is by nature always behind the source code and even worse, it's an additional artifact, which has to be produced, published, maintained and found. I spend a great deal of time understanding which P2 I need, while many sources is in git.eclipse.org with a unified URL naming. P2's come and go. Recently, I nailed my target on plugins (I checked some specific plugins versions) in the xtext p2 repo. Luna was released, and these plugins where not offered anymore by the P2. Eclipse complained about it. Why do I need to be confronted with this? Just hook me into the source, with tags for the version I need. The materialization of a project, is as a step which can easily be taken by the final producer of a SW product (The guy at the end of the production chain). Now: lib1 -> lib1.p2 -> lib2 -> lib2.p2 -> app1 (find,wait,update) (find,wait,update). Anticipated: lib1 -> lib2 -> app1. (lib2 target includes src lib1 etc..) The EclipseSource header, could achieve this, but non optimal. (The reason it was introduced, addresses a similar need, which is stay close to the source!). On the Eclipse IDE, it could work like this: " Hey I have a binary, but there is a newer source(judging from last commit?), do you want to pull it in the workspace, to be more on the edge? We will update the target state to compile your own projects against it" (Can we hide this part of the workspace please? we don't want to change the code, just use it!). On the tycho part, same story really. It ends up in a workspace which the Maven reactor will compile against. I will ask the google people of tycho to give their opinion on this. A more optimal user story would be to skip p2 location altogether... and do whatever is necessary in the IDE to make it work with Git locations and be non-intrusive. (So hidden workspace with source projects, support git locations in target files, ).. After thinking this through it makes more and more sense. P2's are instable particles. Git repos are solid has granite. Cheers ChristopheSo you want a target definition that can specify a list of projects from one or more git repositories. This would automate the existing workflow of importing the projects into the workspace and doing a pull on each git repo.I think it is possible to do this, by creating a new target location type. This would have to be contributed work that PDE would review.I see several potential roadblocks:- Target platforms do not update automatically. You would have to hook into the update button functionality to do a git pull request.- PDE has no dependencies on eGit/jGit as it isn't part of the SDK. This would likely mean that this work has to be done in a separate plug-in not in the SDK.- The layout of a project in git can vary significantly from the built binary bundle. It is quite possible that the project in git will not be recognized as a plug-in by PDE. Most projects will work as long as PDE can find the manifest, but a git project can contain any layout.	10.0
id=441684	REOPENED	PDE	UI	4.4	PC Linux	P3 normal	PDE-UI-Inbox	2014-08-13 09:08 EDT by	Lars Vogel	2016-12-21 03:48 EST (	9 users	CreatedInactive buttonsIn my RCP / plug-in training session I noticed that most "newcomers" fight with the buttons in the Runtime configuration. These are only active if the filter is not set. See screenshotI suggest to handle the button activation independently of the filter.	I am closing this as WONTFIX because I know that the filtered tree implementation used there is very fragile. If you want to work on a fix, you can reopen, but any change will require substantial testing.All of the disabled buttons affect the checked items, including those that are currently filtered. The solution may have to clear the filter, change the checked items, then reapply the filter, causing flashing in the UI.You find it common that users are entering a filter and not clearing that filter?(In reply to Curtis Windatt from)Yes, out of two reasons:1.) I see it with my RCP / Plug-in trainees all the time. These days our PDE runtime exercise has two BIG warning issues reminding the people to remove the filter to avoid that issue in the exercises.2.) Other Eclipse functionality works differently, e.g., the Target Editor from PDE does not require to delete a filter to work fine these days, seeor the p2 installation dialog does also not require that a filter is removed. I think the common assumption (and implementation in Eclipse) is that the filter filters the UI and that this does not affect the "model", e.g. the ability to add dependencies based on the current selection.OK, I give it a try. Might get easier, once I fix, in this case we would have a "common" FilteredTree implementation.(In reply to Lars Vogel from)The target uses a filtered tree implementation I built from borrowed bits from p2. It is far better than the implementation used in the launch config and I still ended up with many subtle issues with running actions while a filter was applied.So good luck :)Martin, something for you? This is a major usability issue IMHO?(In reply to Lars Vogel from)Martin, are you available to have a look at this for M5?yes, i think most probably i will be able to look at itNote: AbstractPluginBlock contains the relevant code.	7.0
id=453290	REOPENED	PDE	UI	4.5	PC Linux	P3 normal	PDE-UI-Inbox	2014-11-26 06:38 EST by	Arnaud MERGEY	2014-11-27 14:20 EST (	1 user	Currenlty defining a launch configuration for equinox based producs (OSGI, RAP, RCP, ..)in Bundles tab it is possible to choose "features selected below" or "bundles selected below"using selected bundles launch only checked bundles in the listusing selected features launch bundles in selected features on their required dependencies.There should be an option allowing to choose to have required dependencies or only selected features otherwise it is not really consistentFor example I have bundles A B and C, B requires CI have a feature F containing A and BIf I define a launch config using "selected bundles" A and B, B bundle will not be able to start because C is not foundIf I define a launch config using "selected features" F, A B and C will be started, I would like to have a way to configure a "strict" mode where C is not automatically added as it is not in my selected feature	This is working as intended. The feature based launch config is intended to make it as simple as possible to launch the content required. If you need exact control over what is in the launch config, then use the plug-in based launch config. Closing as WONTFIX.Under what circumstances do you need to launch just F (A, B)? B couldn't start without C, so you've defined a broken launch config.I understand it works as intended, but it is not consistent with bundles, so I can return your question, why with "bundles selected below", if I choose A and B it does not launch C as well ? I do not ask to change default behavior, but it should be configurable by an option.In my sample having not C in any selected feature is clearly a mistake, but a mistake I will not see in development because my application will run fine, as the run config automatically add C even if not in feature.Having an option to strictly use feature as defined would be helpful to detect incomplete feature definition.If you still think it does not makes sense, so at least, there is still a bug because in this case, why not to add the same wa required dependencies when "bundles selected below" is used ?I get that there is some inconsistency between the types. Feature based launches were added much later in PDE with the express intent to make it easier to launch a small subset of PDE. There was no need to change the existing plug-in based launch behaviour, which could also break existing configurations.The only case I know of where a strict selected features only mode makes sense would be when creating a launch for a feature based product.Note that a plug-in based launch config allows you to 'select required plug-ins' already.Let's take my sample another time I declare my run config with feature F (bundle A and bundle B)I click on "Validate Bundle" button I will have "No problem is detected" dialogNow I switch to bundle, and check A and B, "Validate Bundle" will complain about missing CMy point is if "feature selected" way behavior is the the good one, then there is a bug for "bundle selected"If "bundle selected" behavior is the good one, then there is a bug for "feature selected".If both behaviors makes sense, then there is still a bug because in this case behavior should be configurable by an option.Currently if I define run config with list of bundles and I want "feature selected" like behavior I need to define a feature.If I have a feature define and I want "bundle selected" behavior I need to define and synchronize manually list of bundles between run config and feature.There is definitely something that should be fixed here(In reply to Arnaud MERGEY from)Both behaviours make sense. The behaviour could be configurable by an option, but why add more complexity/configurability when there is no driving need for it. Is this blocking your work or do you have a workflow that encounters this situation regularly?Well "Bundle selected below" bundle list is quite unusable in a team because no one as completely the same list of bundles in his workspace, so bundle run config "magically" uncheck or check bundles from the list, so each commit on the run config file can breaks run config for others in the team.The only way to have a stable list of bundles is to use "Feature selected below", unfortunately it does not launch only selected bundles.As I said before it can be useful to have only bundles selected in feature started, because it allow to detect incomplete feature in dev environmentFor RCP feature based products, for RAP applications, even OSGI applicationIt can be useful to rely on features, to declare the list of bundles required by an application and then define an automated build process that will use features to build the project.With current behavior, I have no way to be sure to launch this product or application directly from eclipse with the same bundle list that will be used to build it, I can only detect incomplete feature after build process.Anyway I think, but maybe I am wrong, it is useful to have a way to run something from eclipse, that will be the same after a build, and if you still think it is not a missing important feature, I could start some post on RAP and RCP forum to see if I am the only one suffering from this. In conclusion I am quite surprised you closed the bug so fast, with other eclipse products I am not used of this "kill first then talk" way of doing thingsThe feature based launch was added specifically to make it very easy for a developer to launch a feature they were working on. The common workflow doesn't care if the required plug-ins are added for you.I closed this bug because it goes against this behaviour, but I will reopen it as you feel strongly that this is a needed feature in the RCP community.I would rather see better target platform management (target per project/product for example) rather than specialized launch configurations to handle the case of dev runtimes and built runtimes not matching. However, as there isn't the resources to take on such work in PDE, perhaps having a launch config option would be a partial solution. I would be more than happy to hear about the pain points RCP/RAP users are encountering with PDE.	7.0
id=393295	REOPENED	PDE	UI	4.2.1	Macintosh Mac OS X	P3 normal	PDE-UI-Inbox	2012-10-31 17:36 EDT by	Bertus Hölscher	2013-04-05 15:28 EDT (	2 users	After adding Help to a working rcp application I get errors. When I select lucene 2.9.1 instead of lucene 3.5.0 in Run Configurations > Plugins the application works in eclipse. However, the exported application does not work, because lucene 3.5 gets exported.	Can you provide some simple steps for me to reproduce? Do you have a product configuration file? Changing something in the run configuration has no effect on your exported application.Closing due to lack of info. Please reopen if you can answer my previous questions.I would like to re-open this bug because I see the same problem under 4.2.2:I have an RCP application that runs under 4.2.2 using the compatibility layer. When I open my *.product file, press "Synchronize" and "Launch an Eclipse application", the help system does not start because it requires org.apache.lucene and org.apache.lucene.analysis version 2.9.1, but the launch configuration adds lucene plugins with version 3.5.0.I can adjust the Run Configuration in the IDE: Select the 2.9.1 lucene plugins, and the RCP app will start.But whenever I "Synchronize", or when I "export" the product from the IDE, this results in Eclipse trying to use the 3.5.0 version of the lucene plugins.My product is based on features, and in one feature I explicitly listed <plugin id="org.apache.lucene" download-size="0" install-size="0" version="2.9.1.v201101211721" unpack="false"/> <plugin id="org.apache.lucene.analysis" download-size="0" install-size="0" version="2.9.1.v201101211721" unpack="false"/>No difference, the "Synchronize" step will still create a run configuration with lucene 3.5.0 plugins, and then the help.base plugin fails to load.Reopening. I don't have time to investigate this further right now. Perhaps another plug-in requires the newer version of Lucene or somewhere the dependency only has a lower bound.(In reply to)Tried again:The "Export" works. It picks lucene plugin versions 2.9.1.v201101211721 as explicitly requested in my feature.xml.The "Synchronize" & "Launch.." inside the IDE picks some version 3.5.0 plugins.After manually adjusting the Run Configuration to only use 2.9.1, it's OK.So this is limited to the IDE Synchronize/Launch. Seems to be less picky than the "export" or headless build. Usually, during development, that's good: While the "export" or headless build fails unless all plugins are perfectly resolved, the product still starts up in the IDE.In this case, the IDE second-guessig what I put in the feature.xml is not helpful.But not fatal, either: Can adjust the run configuration, and the 'export' works fine.	5.0
id=490063	REOPENED	PDE	UI	4.6	PC Windows 7	P3 enhancement	PDE-UI-Inbox	2016-03-21 04:58 EDT by	Dirk Fauth	2016-09-06 09:32 EDT (	2 users	Equinox supports capabilities and we could therefore add the generation of capability headers aswell.1. Provide-CapabilityIf a service is provided, the Provide-Capability header should be added. Inthis is also discussed for Equinox services. If I understand correctly, adding the header should not have any impact if the header is not supported (e.g. by older Equinox implementations) and only adds information that can be used. For a service org.eclipse.MyService, the header would look like this: Provide-Capability: osgi.service;objectClass:List<String>="org.eclipse.MyService" 2. Require-CapabilityIf a bundle provides a DS, it should specify the requirement for DS. Since Neon Equinox adds the corresponding Provide-Capability header in the Manifest. We could therefore add the corresponding Require-Capability header, which would look like this: Require-Capability: osgi.extender;filter:="(&(osgi.extender=osgi.component)(version>=1.2)(!(version>=2.0)))"But there are two downsides with adding the Require-Capability header.a) The service won't work with an older Equinox version, because the Provide-Capability header is added with Neon and not available in prior versions.b) p2 does not support OSGi capabilities. It has its own capability mechanism that needs to be specified via p2.inf. That means, the p2.inf file needs also to be added in case OSGi capabilities should be supported. So if we decide to add that, we should make it configurable.	AFAIK the OSGi exports do not recommend that you use capacities for custom services. SeeI suggest to mark this as wontfix, customers which want to use this, can add these entries themself.I checked the content of the mail and asked on the Bndtools mailing list about the same, as they generate these headers.I therefore reopen the ticket as it makes sense to generate these headers.The warning is about consuming the service and using Require-Capability on resolve level.An additional information by BJ Hargrave on the Google Groups discussion, says we should not add the Require-Capability on the osgi.extender, because ds implementations before 1.3 don't specify the capability header"But earlier versions of SCR wont since the earlier versions of the DS spec did not define the capability."But still adding the header to provide a service should not hurt.Updated the title to reflect that first only the Provide-Capability header should be automatically added.The Require-Capability header was specified with DS 1.3 and is also supported by Equinox DS 1.2 since Neon. As this is beyond the spec I also think we should not generate that one, or make it somehow configurable in case Equinox DS in the Neon version is involved.We could take up the Require-Capability stuff in case Equinox decides to go with Apache Felix SCR in the future, which would give us DS 1.3 also in Eclipse (fingers crossed).	4.0
id=462462	REOPENED	PDE	UI	4.5	PC Mac OS X	P3 normal	PDE-UI-Inbox	2015-03-18 08:52 EDT by	DJ Houghton	2015-11-04 17:03 EST (	2 users	Continued from our discussion in.I've been running our product on top of Build id: I20150311-1300 for the past few days and have seen this behaviour every day:previous day:- there are 2 shared target platform files shared in a stream (let's call them A and B)- my target platform is target B.- both files change in repository (sequence number is also updated)- I accept the changes- I go into the preferences- when I click on target A the entry in the Locations part of the table is correct (points to an https url)- when I click on target B the entry in the Locations part of the table is still pointing to the old URL- I select "Edit" and it loads the file from the new location and everything is good after I exit from the dialog (target platform reloads and workspace recompiles)the next morning:- I start up Eclipse and see the splash screen and then my Workbench window opens- at this point I'm prompted (modal prompt) for my username/password for the site where the target URL is pointing- I look in the background and see my currently open Java file is full of compile errors (implying the target isn't set or is invalid?)- I enter my username/password and the target reloads (and takes a while so I assume it is downloading JARs from the target site)- after reloading it recompiles my workspace and the compile errors disappear.	Same as?Looks like it. I'll mark as a dup and reopen if the dup is fixed and my problem still occurs.*** This bug has been marked as a duplicate of***Re-opening asonly deals with the reload blocking the UI whereas the intent of this bug is to not do the reload if the target hasn't changed.Vikas and I were able to connect this morning and set up a screen share/remote debug session so I was able to reproduce the issue and he could see it and dig a little deeper. I'll try and summarize our findings here - please correct me if needed. There are 2 issues that we are looking into:1). when I start Eclipse even though the target platform hasn't changed, the target platform is reloaded from the remote server which prompts me for a username/password2). when starting Eclipse the open editor has compile errors and they don't disappear after the target platform reload unless I close and reopen the editorAlthough I see scenario #2 randomly, we weren't able to reproduce it today so I will focus on scenario #1.When debugging, we noticed that in P2TargetUtils#checkProfile (line 454) the sequence number in the file is different than the sequence number in the profile. We also determined that the username/password dialog is coming from p2. The current theory is that on startup the profile sequence number is checked, found to be different, and then p2 is asking the user for the username/password so it can load the repository referenced by the target platform file.Also note that later on in our debug session the fProfile variable in P2TargetUtils#checkProfile was null so we were getting the prompt every time. I believe this is because I was hitting ESC on the prompt and not allowing the repository to load, so it had to load the next time it started. It takes a while to reload the target platform in my example (and reproducing the problem requires you to change the target first) so I'm going to try and come up with a smaller test case that Vikas can use to debug locally. I also openedto track the issue with the preference page not showing the proper target after loading a new one from the server. (as noted in original description of this bug) I'm not sure if it is related but it is interesting to call out and track.I occasionally see the same behaviour: PDE reloads my target on startup. Occasionally the target is corrupted during the reload (I'm not sure if that's related to this bug).	5.0
id=497638	REOPENED	PDE	UI	4.7	PC Windows 7	P3 normal	PDE-UI-Inbox	2016-07-11 01:22 EDT by	Vikas Chandra	2016-12-06 01:51 EST (	1 user	testFragment Error N/Ajava.lang.NullPointerExceptionat java.io.File.<init>(File.java:277)at org.eclipse.pde.internal.core.MinimalState.addBundle(MinimalState.java:71)at org.eclipse.pde.internal.core.PluginModelManager.addWorkspaceBundleToState(PluginModelManager.java:706)at org.eclipse.pde.internal.core.PluginModelManager.addWorkspaceBundleToState(PluginModelManager.java:689)at org.eclipse.pde.internal.core.PluginModelManager.handleAdd(PluginModelManager.java:844)at org.eclipse.pde.internal.core.PluginModelManager.modelsChanged(PluginModelManager.java:221)at org.eclipse.pde.internal.core.AbstractModelManager.fireModelProviderEvent(AbstractModelManager.java:34)at org.eclipse.pde.internal.core.WorkspaceModelManager.createAndFireEvent(WorkspaceModelManager.java:259)at org.eclipse.pde.internal.core.WorkspacePluginModelManager.createAndFireEvent(WorkspacePluginModelManager.java:481)at org.eclipse.pde.internal.core.WorkspaceModelManager.processModelChanges(WorkspaceModelManager.java:231)at org.eclipse.pde.internal.core.WorkspaceModelManager.processModelChanges(WorkspaceModelManager.java:193)	and subsequent commit seems to responsible for this. Need to debug on ep47N-unit-cen64linux.gtk.x86_648.0Need errors here may be related -Fixed via revert of the commits ( of)I will "reopen" this bug once I put the commit again forin early 4.7M2.This doesnt happen anymoreNew Gerrit change created:Reopening since after committing the 2nd fix in- [patch] Target platform misses bundle after version of workspace bundle gets changed, this problem re-appears. ( as expected).New Gerrit change created:Created a dummy gerrit to see if the failures happenResolving for now. Will try again in M4 when I commit the 2nd part of the fix.verified inreopeningThis problem no longer occurs. This is due to the new option of( which is by default on.This problem only happens on 1 platform and that too under some specific circumstances ( nightly test run fails while gerrit test runs on same test case passes). Also now, this doesnt happen by default option.	13.0
id=321388	REOPENED	Platform	User Assistance	4.0	PC Linux	P3 normal	Jim Perry	2010-07-30 13:23 EDT by	Miwako Tokugawa	2013-11-29 15:43 EST (	3 users	Build Identifier: 20100617-1415 (Version: Helios Release)I tried setting help preferences using plugin_customization.ini and it doesn’t seem to be working.1. My product plug-in (x.y.z) has <extension id="ide" point="org.eclipse.core.runtime.products"> <product application="x.y.z.workbench" .. > <property name="preferenceCustomization" value="plugin_customization.ini"/>plugin_customization.ini is in eclipse/plugins/x.y.z_7.0.0and hasorg.eclipse.help.base/remoteHelpOn = trueorg.eclipse.help.base/remoteHelpHost = localhostorg.eclipse.help.base/remoteHelpPath = /helporg.eclipse.help.base/remoteHelpUseDefaultPort = falseorg.eclipse.help.base/remoteHelpPort = 80814. I start eclipse with Eclipse –pluginCustomization .. (I’m not sure if I need this flag)If I set the same values in Windows->Preferences, everything works and the remote help is pulled in.But, doing this through plugin_customization.ini doesn’t seem to work.I’m using CDT.This may be a possible user error but I've been looking for info anywhere for a while and don't know what I may be doing wrong. Your attention is appreciated.Reproducible: Always	If you are using the "-pluginCustomization <filepath>" command line argument, then the filepath is interpreted to be relative to the directory that Eclipse was started from. (usually the Eclipse install directory)Otherwise if you are specifying a product customization file via the product declaration in the plugin.xml, then the file (in your case plugin_customization.ini) must be in the primary feature's plug-in install directory. Here is an old document that briefly explains the order that default preferences are calculated:Hi.Thank you very much for taking a look. I tried the relative path but it did not solve my problem. I can't access the remote help, and preferences->help->content is set to "Include local help only"1 >cat ./plugins/com.intel.compiler.cdt_7.0.0/plugin_customization.iniorg.eclipse.help.base/remoteHelpOn = trueorg.eclipse.help.base/remoteHelpHost = localhostorg.eclipse.help.base/remoteHelpPath = /helporg.eclipse.help.base/remoteHelpUseDefaultPort = falseorg.eclipse.help.base/remoteHelpPort = 80812 >cat startEclipse./eclipse -pluginCustomization ./plugins/com.intel.compiler.cdt_7.0.0/plugin_customization.ini -clean -data runtime -showlocation -vm /export/users/mtokugaw/jre1.6.0_17/bin/java -vmargs -Xmx758MI looked at DefaultPreferences.class in the debugger.applyDefaults (called from applyCommandLineDefaults) does correctly read in the file and the fields (key,value,localQualifier), butIf (name().equals(localQualifier)) { ..} is never executed.I am unable to reproduce this problem locally. I tried using both a relative path and an absolute path as an argument to the command-line option and both times the preference was applied correctly and when I opened the Help it showed the local server with the correct port, etc. I'm not sure what is happening if you say that lines of code are not being executed when you step through them in the debugger. I stepped through them and on my machine everything looks ok.Depending on how the Help team stores its preferences, this may effect whether or not the values are stored. The values that you are trying to set are default values, which means if there already exists another value then you wont' see the defaults in the preferences.Take a look in the <workspace>/.metadata/.plugins/org.eclipse.core.runtime/.settings/ folder. If there is an org.eclipse.help.base file already there, then it means that you have over-ridden some preferences via the UI and you won't see the defaults when you go into the dialog.Hi.I tried again and it still doesn't work. I am able to display the remote help only if I use Window->Preferences.org.eclipse.help.base.prefs is there but not org.eclipse.help.base.The former original haseclipse.preferences.version=1scope=andremoteHelpICEnabled=remoteHelpOn=falseremoteHelpHost=remoteHelpPath=remoteHelpName=remoteHelpPort=remoteHelpProtocol=remoteHelpPreferred=falseeclipse.preferences.version=1scope=after I set the values in Window->Preferences, then reset to the original and exit.Ok, I've taken another look at this from the Help side. When you hit "Restore defaults" rather than clearing the values altogether, they are being set to copies of the default values.This is what looks like is happening:- start up initially with no defaults and nothing set- go into the preferences, notice nothing is set- hit OK--> At this point the code copies the default values (empty strings) to the "per workspace" (instance) preference location. (the file I pointed you to earlier)- restart Eclipse and specify the plug-in customization file for defaults- open preferences- notice nothing is set- hit Restore Defaults- suddenly the dialog is populated with your values- hit OK--> the instance preferences are now being written out and the values are the same as the defaultsThis explains why setting the customized values worked for me (new workspace, started up for the first time) but didn't work for you. (most likely an old workspace, not initial startup)Moving to Platform/UA for comment. It almost seems like the defaults are being used incorrectly and as a method for specifying additional values. (I think you always want to add the default list of servers to your list no matter what?)Jim, can you take a look at this?In the configuration folder of your app, open the config.ini. Do you have the eclipse.product value set correctly? This is how eclipse knows the product to load:eclipse.product=PLUGINID.PRODUCTIDThe PLUGINID is the id of the plugin as in the ManifestThe PRODUCT ID is the id of your product (ide)exampleeclipse.product=com.example.xyz.ideMake sure this value is there. Then, verify you have these settings in your plugincustomization.ini - as it appears you do.org.eclipse.help.base/remoteHelpOn=trueorg.eclipse.help.base/remoteHelpName=Collaborative Lifecycle Management Helporg.eclipse.help.base/remoteHelpHost=jazz.netorg.eclipse.help.base/remoteHelpPath=/help-dev/rational-team-concertorg.eclipse.help.base/remoteHelpUseDefaultPort=falseorg.eclipse.help.base/remoteHelpPort=443org.eclipse.help.base/remoteHelpICEnabled=trueIf this does not work, then it is likely that Eclipse is not loading your plugin_customization.ini values. You can try another value to check this, such as productName:org.eclipse.ui/SHOW_PROGRESS_ON_STARTUP=trueIf your product plugin is working correctly, then you should be able to toggle the progress bar behavior. IF this does not work, then the issue is with your product pluin.I looked into this a bit...Seems that in Eclipse 422, HelpContentPreferencePage changed quite a bit.RemoteICViewer and RemoteICContentProvider and RemoteICList are gone.In eclipse 3.x,RemoteICList was pretty smart and would read the default (or current) preferencesand your remote help info would show up in the table when you openedPreferences > Help > Content (in a brand new workspace)In eclipse 422, it seems that the only time theHelpContentPreference page will try to read the default preferences(originally specified in plugin_customization.ini)is if the user presses [Restore Defaults].NOTE: Even though your default remote help preferences do not getproperly shown in the Preferences dialog, they are actively present, and openingHelp > Content from your product's main menu will open the Help application, and your remote or local content will be present.One possible workaround (for the Help > Content preference page), is to perform the following code ONCE per new workspace:*These classes are in org.eclipse.help.ui(Use a unique preference store value to tell you if you've done this work in this workspace at least once )//get the info center entries that have been serialized by Help > Content pageList<IC> currentICs = ICPreferences.getICs();//// Look through this list to see if your remote help entry is there..// If NOT, then do the following //gets the values from plugin_customization.ini that were serialized in //DefaultPreferencesList<IC> defaultICs = ICPreferences.getDefaultICs();if ( (null!=defaultICs) && (!defaultICs.isEmpty()) ) { //serialize them in the ICPreference fashion. ICPreferences.setICs(defaultICs);}//if If you put this code, let's say, in the perspective class of your product, thenit will only be executed ONCE in a brand new workspace, or everytime youselect Reset Perspective.Additionally, if you have a unique preference in a preference store thatyou use to ensure you only do this work ONCE (per new workspace), then it will only ever be executed once.	9.0
id=29827	REOPENED	Platform	Ant	2.1	PC Windows 2000	P3 enhancement	Platform-Ant-Inbox	2003-01-20 13:07 EST by	Darin Wright	2011-06-06 15:39 EDT (	3 users	As a convenience, we should have an "expand all" action in the Ant view build file list.	Time permittingRevisit post 2.1This is related to- perhaps this should be marked as dependent on that one?As of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.Reopening, since the platform now supports retargetable commands.	5.0
id=212446	REOPENED	Platform	SWT	3.4	PC Windows 2000	P3 normal	Praveen	2007-12-10 14:14 EST by	Felis Cattus	2010-01-28 14:28 EST (	5 users	Build ID: I20071101-2000If focus is set to a component, inside a CTabItem, before the shell is first opened (to try to determine the component that is first focused when the shell opens), the focus request has no effect. Or it seems that after the focus event on the requested component, there is a subsequent focus event on CTabItem.This happens only inside CTabItem, and not inside TabItem. The difference can be seen if in the attached snippet, CTabFolder and CTabItem are changed to TabFolder and TabItem.With TabFolder, the focus/cursor is in text2, when the shell is first opened, and the user can start typing immediately.With CTabFolder, the user must first click in the text field, before he can start typing.More information: public static void main(String[] args) { Display display = new Display(); Shell shell = new Shell(display); shell.setLayout(new GridLayout()); shell.setText("Main window"); CTabFolder tabs = new CTabFolder(shell, SWT.NONE); tabs.setLayoutData(new GridData(GridData.FILL_BOTH)); CTabItem tab = new CTabItem(tabs, SWT.NONE); tab.setText("Test Tab"); Composite center = new Composite(tabs, SWT.NONE); tab.setControl(center); center.setLayout(new GridLayout()); Text text1 = new Text(center, SWT.BORDER); text1.setLayoutData(new GridData(GridData.FILL_BOTH)); Text text2 = new Text(center, SWT.BORDER); text2.setLayoutData(new GridData(GridData.FILL_BOTH)); ////// DOESN'T WORK text2.setFocus(); shell.setSize(1000, 600); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) { display.sleep(); } } display.dispose(); }	Praveen to reproduce and analyze.CreatedCTabItem sets the Composite visibility to False during setControl methodDuring the call to <CTabItem>.setControl(<Composite>), CTabItem receive that it's parent(CTabFolder) doesn't consider it as a selected item and thus, it sets the Composite visiblity to False.Thus, when shell tries to set the Focus of Text control during Shell.Open(), it encounters that the Text's control parent Compsite is NOT visible and thus, shell ignores to set focus on Text.reassigning since there's a patch attachedFixed in HEAD > 20091021Any active CTabItems that declare SWT.CLOSE seems to have been broken by this fix when the widget is first constructed. Snippet82 can be used as a testbed.Before the patch, the first item will have the 'X' marker drawn on it. With the patch applied, the item will not have the 'X' marker. Hovering over it will cause it to be drawn though.(In reply to)I agree. Due to the added code changes, after the CTabFolder recieved focus, setSelection() is never called as selectedIndex is never -1. Thus, the required code for setting the closeImage is not set.The correct fix might be to call setSelection(0) in createItem() when the items.length is 1, which could set the state for focussing the tabfolder properly. I am currently testing the impact/effect of implementing this.(In reply to)Praveen, do you know if a unit test can be extracted out to verify that the activation/selection problem does not come back? The UI tests failed peras you know so I was wondering if it was possible to test for this on the SWT/CTabFolder side?As it is M3 week, I took the patch out. Praveen to investigate and come up with an alternative solution.CreatedPatch v02When a 1st item is created, it is required to intialize selectedIndex. That is achieved through invoking setSelection(), which sets all the required params for displaying the tab-item.The test case snippet provided below tests the sequence of events generated while creating a tab-item: public static void main(String[] args) { Display display = new Display(); Shell shell = new Shell(display); shell.setLayout(new GridLayout()); shell.setText("Main window"); CTabFolder tabs = new CTabFolder(shell, SWT.SINGLE); tabs.setTabHeight(30); tabs.setLayoutData(new GridData(GridData.FILL_BOTH)); tabs.addSelectionListener(new SelectionListener() { @Override public void widgetSelected(SelectionEvent e) { System.out.println("Widget selected"); } @Override public void widgetDefaultSelected(SelectionEvent e) { System.out.println("Widget Default selected"); } }); tabs.addFocusListener(new FocusListener() { @Override public void focusLost(FocusEvent e) { System.out.println("Focus Lost"); } @Override public void focusGained(FocusEvent e) { System.out.println("Focus Gained"); } }); tabs.addListener(SWT.Activate, new Listener() { @Override public void handleEvent(Event event) { System.out.println("Activated"); } }); CTabItem tab = new CTabItem(tabs, SWT.CLOSE); tab.setText("Test Tab"); Composite center = new Composite(tabs, SWT.NONE); tab.setControl(center); center.setLayout(new GridLayout()); Text text1 = new Text(center, SWT.BORDER); text1.setLayoutData(new GridData(GridData.FILL_BOTH)); Text text2 = new Text(center, SWT.BORDER); text2.setLayoutData(new GridData(GridData.FILL_BOTH)); CTabItem tab1 = new CTabItem(tabs, SWT.CLOSE); tab1.setText("Other Tab"); Composite comp2 = new Composite(tabs, SWT.NONE); comp2.setLayout(new GridLayout()); tab1.setControl(comp2); Text txt = new Text(comp2, SWT.BORDER); txt.setLayoutData(new GridData(GridData.FILL_BOTH)); text1.setFocus(); shell.setSize(1000, 600); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) { display.sleep(); } } display.dispose(); }Bogdan, please review the patch. Thanks.Your patch replaces:if (!updateTabHeight(false)) updateItems();redraw();withsetSelection(index, true);Calling setSelection() gets you a call to redraw for free. But I'm concerned about losing the calls to updateTabHeight() and updateItems(). Both of those code paths are no longer taken once you apply the patch and it is not clear to me that they are no longer required.(In reply to)Here are the reasons for replacing those statements with setSelection -1) setSelection() invokes showItem(), which takes the responsibility of calling updateItem(index).So, I think that updateItems() would be redundant if is used along with setSelection() call.2) The value of tabHeight is initialized (in updateTabHeight) by CTabFolder constructor through init() method. So, any other invokation of updateTabHeight() actually updates the tab height only if the height/font is changed, or text/image is set on Item (and when the APIs are called for changing these parameters, tabHeight is updated accordingly). Otherwise, it just returns without updating anything. So, I feel it is just redundant to make another invokation of this call at that place as there would be no changes/updates to the tab height.Considering these factors, I felt that it is valid to replace those statements with setSelection() call.	11.0
id=99038	REOPENED	Platform	Ant	3.1	PC Windows XP	P3 enhancement	Platform-Ant-Inbox	2005-06-08 15:02 EDT by	Konstantin Komissarchik	2013-08-06 14:02 EDT (	3 users	Repro=====1. Turn of auto-build.2. Setup a project to use an ant script for build. Disable other builders.3. Project->Clean4. Select the project and make sure that "Start a build immediately" is checked.5. Hit ok.6. Get the error.This error can also be seen when auto-build is on and eclipse attempts to build a project and a dependent project, when both use ant for build.Error=====Dialog Title = Building WorkspaceDialog Message = Build problemsDetails =Errors during build. Errors running builder "Integrated External Tool Builder" on project <pj>. Ant build <script-file-name> already in progress. Concurrent Ant builds are possible if you specify to build in a separate JRE.Expectation===========Since I was not intentionally trying to run ant concurrently, I would expect that something (maybe ant builder) would compensate for eclipse's desire to run build concurrently and block/serialize invocations to build scripts.The current workaround of running build in a separate VM is not a good solution since it drastically effects performance and memory foot print.	On the common tab for your builders you will need to toggle off "Launch in background". This ensures serialization of the builds.re: separate VM effects performance and memory foot print.I would be interested in more on this. The memory footprint should be short lived (the separate VM comes and goes --> build memory should be gc'd) and I see almost no performance difference between same and separate JRE builds.Decreasing severity as this does not cause a crash, loss of data or a memory leak.Disabling "Launch in background" does get around this problem, but since it blocks user from being able to do anything in eclipse until build finishes, I don't think it's a real good answer. The underlying problem should be addressed.re: separate VM effects performance and memory foot print.While memory footprint is short lived, it does cause a significant spike in memory utilization, especially if eclipse triggers a couple of these vms to spawn at the same time. As far as performance is concerned, you end up paying the fixed overhead of a vm launch, which last time I checked is on order of a couple of seconds. On top of that, you pay the classloading cost for the common classes that are already in eclipse.The other problem with the separate vm solution is that of configuration. In order to specify that ant script should launch in a separate vm, I have to choose a named jre configuration. This will differ from one user to the next and will make it difficult to share the launch config. One solution for this problem would be to offer the "run in a separate vm, but always use the jre that eclipse is using" option.I would be interested in more on this. The memory footprint should be short lived (the separate VM comes and goes --> build memory should be gc'd) and I see almost no performance difference between same and separate JRE builds.Ignore the last paragraph of my previous comment. A copy-n-paste error.As there are numerous workarounds for this problem and this has been the behavior for Eclipse 3.0 and through the 3.1 development I am seeing this more as an enhancement request. Even if not deemed an enhancement, I am not convinced to do this change so late in the 3.1 cycle.You are correct on the separate JRE cost...I was thinking of trivial examples. Sorry.To facilitate sharing of builders with JREs set the Ant launch configuration attribute is set as follows if you select the default JRE:<booleanAttribute key="org.eclipse.ant.ui.DEFAULT_VM_INSTALL" value="true"/>Default jre is defined as: The VM install is explicitly specified on the launch configuration via the ATTR_VM_INSTALL_TYPE and ATTR_VM_INSTALL_ID attributes. If no explicit VM install is specified, the VM install associated with the launch confiugration's project is returned. If no project is specified, or the project does not specify a custom VM install, the workspace default VM install is returned.This is how the Eclipse debug, JDT and Ant teams work with their shared builders.Deferred for post 3.1 consideration of a feature to automatically serialize same JRE background builds.As of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.This is still an issue.***has been marked as a duplicate of this bug. ***	8.0
id=81288	REOPENED	Platform	Ant	3.1	PC Windows XP	P3 normal	Platform-Ant-Inbox	2004-12-15 14:25 EST by	Darin Swanson	2009-11-02 16:05 EST (	2 users	I200412142000Right click on an Ant debug elementEdit <name of launch>...Nothing happens	This is the problem of having no group for debug mode external tool configurations.Shouldn't "ANT" be a complete new launch/debug configuration type?Strong candidate for 3.2Not currently planned.As of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.marking this bug dependent on, because if Ant supported the Debug launch group proper, this would work.	6.0
id=76936	REOPENED	Platform	Debug	3.4	All All	P3 enhancement	Philippe Marschall	2004-10-25 10:31 EDT by	Phil Herold	2017-01-22 22:34 EST (	53 users	The code at(which is useful for getting and masking a password from a shell), sends the Eclipse console into an infinite loop. It doesn't seem to recognize/handle \b.	It's true that the console does not handle \b, but the code from the sun site doesn't use \b. The loop is intentional in this code. MaskingThread tries to write \r + prompt to the console every millisecond to prevent the user's input from being displayed. The problem here is that the Console does not properly handle \r because its document considers \r to be a legal line delimiter. Handling \r (and \b) properly would require changes to ConsoleDocument and to the Viewer which would need to update it's caret position.form feed (\f) is also not handled by the consoleDeferredCan you give a reason for this deferral? Also, I'm not sure that this bug shouldbe marked as Resolved because it will just get lost in bugzilla.The reason is time & resources. Contributions welcome.Debug marks bugs as RESOLVED/LATER for things we intend to consider in the future.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Instead of closing this bug, is it possible to re-open it with a very very lowpriority? I usually search for bugs before I report them, and AFAIK this doesn'tshow any closed bugs (so this one may be reported again and againThe set of bugs searched is determined by your input on the query page. Makesure that you have either all or none (they're equivalent) of the "Status:"options selected.This bug is not closed - it's marked LATER, meaning we'll do it when we get a chance, but it's not committed to any particular release.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***I am reopening this bug as RESOLVED/LATER is deprecated in bugzilla, but the debug team does not currently have the time/resources to work on this. Contributions would be greatly appreciated.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***See also.***has been marked as a duplicate of this bug. ***The bug title should be updated (for searches), it's not just about \b, but also \r and \f. Apparently I cannot do that.Can somebody give me a pointer at where to find the implementation of the console window? I'd like to have a look at implementing support for \r.(In reply to)See. I'd start with:org.eclipse.ui.internal.console.ConsoleDocumentorg.eclipse.ui.internal.console.IOConsoleViewerUnbelievable that this bug is still unresolved after 8 years!!., btw confirm a reasonable donation to fix this issue.It's worth mentioning that there is a full terminal emulator implemented that's part of the Target Management project. It's a stand-alone component, so you don't have to make your IDE dependent on RSE or anything. However if you want to connect it to a local process (e.g. bash), you'll also need the process spawner from CDT.***has been marked as a duplicate of this bug. ***Perhaps the Target Management project's terminal emulator could be integrated into the code for the standard Console? The fact that projects are implementing their own is a sure sign that it should be built-in and this should be addressed before we have a proliferation of many similar efforts duplicated for different projects.Problem still occurs with Eclipse Juno SR29 years to solve a bug...??????????? Problem still occurs in Eclipse Juno 4.2. I believe that not being able to handle such characters is a BIG defect. If a console can handle things better that an IDE then we are going backwards.***has been marked as a duplicate of this bug. ***Hi Anyone working on it... I am ready to contribute please let me know where I should start..(In reply to varahalaraju penmetsa from)See.(In reply to varahalaraju penmetsa from)To get a feel for the expectations for contributing to debug, give this wiki page a read:Then refer to the two classes as a good place to start:org.eclipse.ui.internal.console.ConsoleDocumentorg.eclipse.ui.internal.console.IOConsoleViewerThanks Rennie...Here's a Gerrit pull request(In reply to Philippe Marschall from)Thank you very much for the fix Phillippe!I quickly tested the fix by dumping the following out to the console:"this is a \r\n line with carriage return and \f form feed in it, there is also a \b backspace thrown in for good measure"Prior to the fix the output was all messed up, with the fix the output in the Eclipse console matches the system console (in my case Terminal on Mac OS).It would be nice to have some JUnit tests for the fix.If you are interested in providing those as well Phillippe, they would go in the org.eclipse.debug.tests bundle and you can look here:for some example console tests we already have for the Java debugger.I can provide unit tests but it will likely take a week (at least). I used the following examplesagainst the Terminal on Mac OS X.I am not too familiar with Gerrit, would an amend and force push be OK?(In reply to Philippe Marschall from)Ok, we can give a week, and if you find you don't have time to get them done we can just merge the fix and provide the tests later.You should be able to amend the commit and just push (force shouldn't be needed)Ok, here are some tests:they are in jdt.debug so they will fail because the code is in platform.debug(In reply to Philippe Marschall from)The platform debug changes have been merged:and the JDT debug tests have been merged:Thank you very much for providing a fix for this bug Philippe!Verified usingEclipse SDKVersion: Mars (4.5)Build id: N20141126-2000I had to revert this withOn Windows, a simple "echo" program like the one below is completely broken, since it throws exceptions when the user presses the Return key. This also happens to the OSGi console.import java.io.*;public class Echo { public static void main(String[] args) throws IOException { BufferedReader in = new BufferedReader(new InputStreamReader(System.in)); String answer; int i = 1; do { System.out.print("prompt" + i++ + "> "); answer = in.readLine(); System.out.println("You said: \"" + answer + "\"."); } while (!"exit".equals(answer)); System.out.println("Bye."); }}!ENTRY org.eclipse.ui 4 0 2014-12-10 19:33:54.192!MESSAGE Unhandled event loop exception!STACK 0java.lang.StringIndexOutOfBoundsException: String index out of range: -9 at java.lang.AbstractStringBuilder.insert(AbstractStringBuilder.java:1005) at java.lang.StringBuffer.insert(StringBuffer.java:514) at org.eclipse.ui.internal.console.IOConsolePartition.insert(IOConsolePartition.java:75) at org.eclipse.ui.internal.console.IOConsolePartitioner.documentChanged2(IOConsolePartitioner.java:394) at org.eclipse.jface.text.AbstractDocument.updateDocumentStructures(AbstractDocument.java:696) at org.eclipse.jface.text.AbstractDocument.fireDocumentChanged(AbstractDocument.java:793) at org.eclipse.jface.text.AbstractDocument.replace(AbstractDocument.java:1191) at org.eclipse.jface.text.AbstractDocument.replace(AbstractDocument.java:1210) at org.eclipse.ui.internal.console.ConsoleDocument.replace(ConsoleDocument.java:150) at org.eclipse.ui.internal.console.ConsoleDocumentAdapter.replaceTextRange(ConsoleDocumentAdapter.java:266) at org.eclipse.swt.custom.StyledText.modifyContent(StyledText.java:7283) at org.eclipse.swt.custom.StyledText.sendKeyEvent(StyledText.java:8134) at org.eclipse.swt.custom.StyledText.doContent(StyledText.java:2501) at org.eclipse.swt.custom.StyledText.handleKey(StyledText.java:5970) at org.eclipse.swt.custom.StyledText.handleKeyDown(StyledText.java:6001) at org.eclipse.swt.custom.StyledText$7.handleEvent(StyledText.java:5681) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4354) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1061) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1085) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1070) at org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:1112) at org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:1108) at org.eclipse.swt.widgets.Widget.wmChar(Widget.java:1529) at org.eclipse.swt.widgets.Control.WM_CHAR(Control.java:4746) at org.eclipse.swt.widgets.Canvas.WM_CHAR(Canvas.java:343) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4627) at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:339) at org.eclipse.swt.widgets.Display.windowProc(Display.java:5042) at org.eclipse.swt.internal.win32.OS.CallWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.CallWindowProc(OS.java:2443) at org.eclipse.swt.internal.BidiUtil.windowProc(BidiUtil.java:640) at org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method) at org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:2549) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3759) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1151)...Using snippet from code 50, gives following exception in console.java.lang.NullPointerException at org.eclipse.ui.internal.console.IOConsolePartition.delete(IOConsolePartition.java:85) at org.eclipse.ui.internal.console.IOConsolePartitioner.documentChanged2(IOConsolePartitioner.java:383) at org.eclipse.jface.text.AbstractDocument.updateDocumentStructures(AbstractDocument.java:696) at org.eclipse.jface.text.AbstractDocument.fireDocumentChanged(AbstractDocument.java:793) at org.eclipse.jface.text.AbstractDocument.replace(AbstractDocument.java:1191) at org.eclipse.jface.text.AbstractDocument.replace(AbstractDocument.java:1210) at org.eclipse.ui.internal.console.ConsoleDocument.replace(ConsoleDocument.java:150) at org.eclipse.ui.internal.console.ConsoleDocumentAdapter.replaceTextRange(ConsoleDocumentAdapter.java:266) at org.eclipse.swt.custom.StyledText.modifyContent(StyledText.java:7283) at org.eclipse.swt.custom.StyledText.sendKeyEvent(StyledText.java:8134) at org.eclipse.swt.custom.StyledText.doContent(StyledText.java:2501) at org.eclipse.swt.custom.StyledText.handleKey(StyledText.java:5970) at org.eclipse.swt.custom.StyledText.handleKeyDown(StyledText.java:6001) at org.eclipse.swt.custom.StyledText$7.handleEvent(StyledText.java:5681) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4354) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1061) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1085) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1070) at org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:1112) at org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:1108) at org.eclipse.swt.widgets.Widget.wmChar(Widget.java:1529) at org.eclipse.swt.widgets.Control.WM_CHAR(Control.java:4746) at org.eclipse.swt.widgets.Canvas.WM_CHAR(Canvas.java:343) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4627) at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:339) at org.eclipse.swt.widgets.Display.windowProc(Display.java:5042) at org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method) at org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:2549) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3759) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1151) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1032) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:148) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:648) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:592) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:138) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:380) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:235) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:648) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:603) at org.eclipse.equinox.launcher.Main.run(Main.java:1465)Reverted the commit for JDT Debug tests viaHere is an updated change that no longer causes the exception on Windows. The difference is that the sequence "\r\n" (Enter on Windows) is no longer considered to contain control characters.(In reply to Philippe Marschall from)It will be good to add a test case for this sequence of characters.It doesn't seem to work for me. Running System.out.println("x\by"); still prints "x[0008]y" instead of "y", in eclipse console.I'm using build I20150203-1300.(In reply to Jonathan Murray from)Right because this bug is still open ;-)Gerrit changewas merged to [master].Commit:Tested with snippets from the comments in the bug, the OSGi console and a Rhino debug console.Thanks for the updated fix Philippe.Verified usingEclipse SDKVersion: Mars (4.5)Build id: I20150315-2000CreatedAnimated O on a lineRun this snippet to reproduce the bug.I downloaded the final release of Mars today and run the little animation snippet in the attachment. Unfortunately, the backspace characters are not always interpreted correctly, which breaks the animation.The issue seems to appear randomly, so I suspect some sort of race condition between print() and the interpreter.(In reply to Martin Steiger from)Please file a new bug report, thanks.New Gerrit change created:Reopened due to related bugsandGerrit changewas merged to [master].Commit:@Philippe,Do you plan to work on this?src:System.out.println("This \b is \f a \r Test");Console:This is a TestVersion: 3.8.1Build id: debbuild***has been marked as a duplicate of this bug. ***Conflict information about this bug has been provided to me. I thought if someone working on this issue can be benefit if I provide a test code.1. Create class //EraserThread.javaimport java.io.*;class EraserThread implements Runnable { private boolean stop; /** *@param The prompt displayed to the user */ public EraserThread(String prompt) { System.out.print(prompt); } /** * Begin masking...display asterisks (*) */ public void run () { stop = true; while (stop) { System.out.print("\010*"); try { Thread.currentThread().sleep(1); } catch(InterruptedException ie) { ie.printStackTrace(); } } } /** * Instruct the thread to stop masking */ public void stopMasking() { this.stop = false; }}2. Create class //PasswordField.javaimport java.io.BufferedReader;import java.io.IOException;import java.io.InputStreamReader;public class PasswordField { /** *@param prompt The prompt to display to the user *@return The password as entered by the user */ public static String readPassword (String prompt) { EraserThread et = new EraserThread(prompt); Thread mask = new Thread(et); mask.start(); BufferedReader in = new BufferedReader(new InputStreamReader(System.in)); String password = ""; try { password = in.readLine(); } catch (IOException ioe) { ioe.printStackTrace(); } // stop masking et.stopMasking(); // return the password entered by the user return password; }public static String readPassword1(String prompt) { // TODO Auto-generated method stub return null;}}3. Create main TestApp.javaclass TestApp { public static void main(String argv[]) { String password = PasswordField.readPassword("Enter password: "); System.out.println("The password entered is: "+password); } }4. Compile and run from Eclipse Console, it will hang at the lineSystem.out.print("\010*");// System.out.print("\b*");I changed the code a bit. Mar Eclipse version 4.5.2 might partially fix this issue. Corrected code is below. I hope others may find it useful.import java.io.*;@SuppressWarnings("unused")class EraserThread implements Runnable { private boolean stop; /** *@param The prompt displayed to the user */ public EraserThread(String prompt) { System.out.print(prompt); } /** * Begin masking...display asterisks (*) */ public void run () { stop = true; System.out.print("\010*"); try { Thread.currentThread(); Thread.sleep(1); } catch(InterruptedException ie) { ie.printStackTrace(); } } /** * Instruct the thread to stop masking */ public void stopMasking() { this.stop = false; }}The fix is not valid. Mars 4.5.2 still has issues. The code changed the behavior completely, and didn't fix the issue. The console does not hang any more, but it displays the user typing pwd. Not good.Here we go again.import java.io.*;class EraserThread implements Runnable { private boolean stop; /** *@param The prompt displayed to the user */ public EraserThread(String prompt) { System.out.print(prompt); } /** * Begin masking...display asterisks (*) */ @SuppressWarnings("static-access")public void run () { stop = true; while (stop) { System.out.print("\010*"); try { Thread.currentThread().sleep(1); } catch(InterruptedException ie) { ie.printStackTrace(); } } } /** * Instruct the thread to stop masking */ public void stopMasking() { this.stop = false; }}The fix was reverted due to some regressions so, you are correct, it does not work. @Dean,You can work on the first patch provided by Philippe.	72.0
id=132829	REOPENED	Platform	Ant	3.2	PC Linux	P3 normal	Platform-Ant-Inbox	2006-03-22 08:44 EST by	Brindl Ronald	2008-11-03 15:09 EST (	2 users	the variables available in external-tools / ant-build / properties dont get resolved. for example i had an ant-file which does xslt and gets the xslt-file via a property from eclipse. therefore i use the variable ${resource-loc} to get the current file-location into ant.the value, that ant gets is "${resource-loc}", which cant be found of course. so the variables dont get resolved.version information:Version: 3.2.0Build id: I20060223-1656	Thank you for the bug report.Unfortunately I cannot reproduce your problem.On the properties tab for my particular test Ant build launch configuration, I create a property with the name testFor132829 and a value of ${resource_loc}I use <echo>${testFor132829}</echo> in the buildfile and get the expected path for the selected resource.Please reopen if more information is forthcoming.I had the same problem. After some investigation i found out, that this only happens if i use an external JRE. If i use "Run in the same JRE as the workspace" , everything works ok. if i use an external JRE (doesnt seem to matter wich one, i tried suns java 5 jre/jdk and ibms java 5 jre/jdk, everything with the same result), i get the variable-names in ant, i.e. the above example would output:${testFor132829}Version: 3.2.0Build id: M20060629-1905Unfortunately whether I run in the same or separate JRE, the variable is resolved correctly.I now tried a simple testcase similar to that you suggested and it worked in same and external jre. i played a bit around with different combinations of variables and it worked. Then i tried my original example again (an ant-script for doing xslt transformations), and to my big surprise it worked, in all jre-configurations. I am a bit confused now, because yesterday it definitely didnt work and i didnt change anything in the meantime aside from trying your example.I think we can close this bug again. if i have troubles with this again, i try to investigate further, for now it seems to work.closingI've found out that if there's an error in one of the property expression, e.g. "${resource_loc:/x}" (where the resource x does not exists), no variable substitution will occur while forking Ant (I've checked with ps on Linux). Can you re-open this bug? Should I open a new one?reopen, thanks for looking into this Jean-Philippe	8.0
id=208563	REOPENED	Platform	Ant	3.3.1	PC Windows XP	P3 normal	Platform-Ant-Inbox	2007-11-02 10:28 EDT by	David Jackman	2008-07-10 14:30 EDT (	1 user	Build ID: M20071023-1652Steps To Reproduce:1. In Eclipse Preferences, go to the Text Editors page and change the "Background color" to something other than the default. Apply the change.2. Now go to the Ant Editor page, and select the Syntax tab. You'll see that the preview window is showing the now-changed background color. Now close the preferences dialog (click OK).3. Now open a build.xml file with the Ant Editor. You'll see that the background color in the actual Ant Editor isn't using the Text Editor background color (as was shown in the preview). It's using something else.More information:The Ant Editor should either use the Text Editor background color (preferable), or it should allow for changing it's background color in the Ant Editor preference page.	Version: 3.4.0Build id: I20080401-0851Changing the default text editor background color is also reflected in Ant editor and Ant editor previews in preferences.(In reply to)I want to be sure I'm setting the "default text editor background color" the way I should be. In the preferences dialog I go to General > Editors > Text Editors. On that page is a list box labelled "Appearance color options," which contains an item named "Background color." This item is already set to the color I'd like the Ant editor to use. However, the Ant editor is definitely NOT using this as its background color. The Preview on the Ant > Editor (Syntax) page is using this color, though.Setting as you describe on Eclipse 3.4 the Ant editor background is honoring the user choice.I just installed Eclipse 3.4, and this still is NOT working for me. If this is indeed working for everyone else, please tell me what I'm doing wrong.David, can you please attach a screen shot of the editor with the incorrect background color.CreatedScreenshot of bad backgroundThis is a screenshot of Eclipse 3.4 showing the Ant editor with the incorrect background. The left hand side is the Ant file in the XML editor (which displays the correct background color). The right hand side is the Ant file in the Ant editor (which should be showing the same background color). In the foreground is the Eclipse preferences window, showing a preview of what the Ant editor should look like. Note that the background color here is correct, but in the actual editor it is not.	6.0
id=211669	REOPENED	Platform	Ant	3.4	All All	P3 enhancement	Platform-Ant-Inbox	2007-12-01 06:09 EST by	Isaac Shabtay	2014-02-25 07:08 EST (	4 users	When creating a Run Configuration for an Ant build file, the developer has the possibility of adding items to the classpath via the "Classpath" tab.In contrary to other Run Configurations, the Ant Run Configuration dialog does not permit the user to add a "User Library" to the classpath (currently accepts individual JARs, external JARs, folders and variables).It may be useful for developers to be able to specify custom pre-defined User Libraries as classpath entries in Ant Run Configurations.	On the same note, and for the same reasons, perhaps enabling the developer to also add Classpath Variables?In what respect is a "User Library" different than a folder or classpath variable? Is there anything you *can not* do with Eclipse today, or is there a workaround?I can't really see the problem here. Perhaps we could resolve this WORKSFORME as per Eclipse 3.5 ?agreed(In reply to)I think it's just convenience... If there is a user library already set up that contains other libraries, perhaps it's just a more convenient way to add things to the classpath.Hi Martin,Sorry, was away for a few days.Darin's response was correct. Under certain circumstances, using a classpath variable or a user library is a much more convenient way to add things to the classpath than attaching individual JAR files. This also holds in case I'd like to store the Launch Configuration in my SCM and don't want to hold absolute, machine-specific locations there.There's nothing broken in the current behavior - it is just inconsistent (other places within Eclipse allow you to add user libraries and classpath variables. For example, you can add a user library to a Java Launch Configuration... so why not allow it for Ant Launch Configurations?)Re-opening...	5.0
id=230860	REOPENED	Platform	Ant	3.4	PC All	P3 normal	Platform-Ant-Inbox	2008-05-07 06:25 EDT by	N J	2008-09-12 04:10 EDT (	1 user	CreatedExported Project containing trivial Java and ant build.xmlBuild ID: I20080409-1425Steps To Reproduce:Create a project from the attached exported project archive.Disable the eclipse java project builder.Add an ant projectbuilder.Select the build.xml file.Set targets for the Compile and Clean.Attempt combinations of building and cleaning the project.If compiling works, alter the build.xml file, such as adding another target, and try again.More information:Some times Build is not available from the menu. It is disabled even after performing a clean.Clean seems to always work. If the associated target is set to the Compile target in the build.xml file, then Eclipse will Compile when told to Clean.This is with 3.4M6aIf I start the Eclipse bundled ant from the command line with a command similar to the following, it works fine:java -cp "C:/Program Files/Java/jdk1.6.0_06/lib/tools.jar;C:/Eclipse/3.4M6a/plugins/org.apache.ant_1.7.0.v200803061910/lib/ant-launcher.jar" -Dant.home=C:/Eclipse/3.4M6a/plugins/org.apache.ant_1.7.0.v200803061910 org.apache.tools.ant.launch.Launcher	Moving to Platform/Antfollow with interestThis is the same bug as 196811, with additional aspects described.*** This bug has been marked as a duplicate of***I am unable to edit/correct the 'Details' information on, so am reopening this bug.	4.0
id=319198	REOPENED	Platform	Compare	3.6	All All	P3 normal	Platform-Compare-Inbox	2010-07-07 18:30 EDT by	Matt Lavin	2010-08-05 06:52 EDT (	1 user	CreatedZipped javacore file showing deadlocked threadsMy IDE recently became unresponsive and I captured a javacore to explain why. The UI thread is blocked as follows:at org/eclipse/core/internal/filebuffers/SynchronizableDocument.getModificationStamp(SynchronizableDocument.java:166(Compiled Code)) at org/eclipse/text/undo/DocumentUndoManager$UndoableTextChange.canUndo(DocumentUndoManager.java:160(Compiled Code)) at org/eclipse/core/commands/operations/DefaultOperationHistory.canUndo(DefaultOperationHistory.java:269(Compiled Code)) at org/eclipse/ui/operations/UndoActionHandler.shouldBeEnabled(UndoActionHandler.java:82) at org/eclipse/ui/operations/OperationHistoryActionHandler.update(OperationHistoryActionHandler.java:438) at org/eclipse/ui/operations/OperationHistoryActionHandler$1.run(OperationHistoryActionHandler.java:144) at org/eclipse/swt/widgets/RunnableLock.run(RunnableLock.java:35(Compiled Code)) at org/eclipse/swt/widgets/Synchronizer.runAsyncMessages(Synchronizer.java:130(Compiled Code)) at org/eclipse/swt/widgets/Display.runAsyncMessages(Display.java:3527(Compiled Code)) at org/eclipse/swt/widgets/Display.readAndDispatch(Display.java:3164(Compiled Code)) at org/eclipse/ui/internal/Workbench.runEventLoop(Workbench.java:2629) at org/eclipse/ui/internal/Workbench.runUI(Workbench.java:2593) at org/eclipse/ui/internal/Workbench.access$4(Workbench.java:2427) at org/eclipse/ui/internal/Workbench$7.run(Workbench.java:670) at org/eclipse/core/databinding/observable/Realm.runWithDefault(Realm.java:332) at org/eclipse/ui/internal/Workbench.createAndRunWorkbench(Workbench.java:663) at org/eclipse/ui/PlatformUI.createAndRunWorkbench(PlatformUI.java:149) at org/eclipse/ui/internal/ide/application/IDEApplication.start(IDEApplication.java:115) at org/eclipse/equinox/internal/app/EclipseAppHandle.run(EclipseAppHandle.java:196) at org/eclipse/core/runtime/internal/adaptor/EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) at org/eclipse/core/runtime/internal/adaptor/EclipseAppLauncher.start(EclipseAppLauncher.java:79) at org/eclipse/core/runtime/adaptor/EclipseStarter.run(EclipseStarter.java:369) at org/eclipse/core/runtime/adaptor/EclipseStarter.run(EclipseStarter.java:179) at sun/reflect/NativeMethodAccessorImpl.invoke0(Native Method) at sun/reflect/NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48) at sun/reflect/DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java/lang/reflect/Method.invoke(Method.java:600) at org/eclipse/equinox/launcher/Main.invokeFramework(Main.java:619) at org/eclipse/equinox/launcher/Main.basicRun(Main.java:574) at org/eclipse/equinox/launcher/Main.run(Main.java:1407) at org/eclipse/equinox/launcher/Main.main(Main.java:1383)The thread that is holding the lock that the UI is waiting for is also waiting on the UI thread to complete it's operation (hence the deadlock):at java/lang/Object.wait(Native Method) at java/lang/Object.wait(Object.java:196(Compiled Code)) at org/eclipse/ui/internal/Semaphore.acquire(Semaphore.java:30(Compiled Code)) at org/eclipse/ui/internal/UISynchronizer.syncExec(UISynchronizer.java:134(Compiled Code)) at org/eclipse/swt/widgets/Display.syncExec(Display.java:4294(Compiled Code)) at org/eclipse/compare/internal/Utilities.firePropertyChange(Utilities.java:166) at org/eclipse/compare/internal/Utilities.firePropertyChange(Utilities.java:140) at org/eclipse/compare/contentmergeviewer/ContentMergeViewer.fireDirtyState(ContentMergeViewer.java:1156) at org/eclipse/compare/contentmergeviewer/ContentMergeViewer.setLeftDirty(ContentMergeViewer.java:1173) at org/eclipse/compare/contentmergeviewer/TextMergeViewer.updateDirtyState(TextMergeViewer.java:3038) at org/eclipse/compare/contentmergeviewer/TextMergeViewer.access$12(TextMergeViewer.java:3032) at org/eclipse/compare/contentmergeviewer/TextMergeViewer$ContributorInfo.elementDirtyStateChanged(TextMergeViewer.java:1005) at org/eclipse/ui/editors/text/TextFileDocumentProvider$FileBufferListener.dirtyStateChanged(TextFileDocumentProvider.java:288(Compiled Code)) at org/eclipse/core/internal/filebuffers/TextFileBufferManager$3.run(TextFileBufferManager.java:706) at org/eclipse/core/runtime/SafeRunner.run(SafeRunner.java:42(Compiled Code)) at org/eclipse/core/internal/filebuffers/TextFileBufferManager.fireDirtyStateChanged(TextFileBufferManager.java:704) at org/eclipse/core/internal/filebuffers/ResourceTextFileBuffer$DocumentListener.documentChanged(ResourceTextFileBuffer.java:77) at org/eclipse/jface/text/AbstractDocument.doFireDocumentChanged2(AbstractDocument.java:769(Compiled Code)) at org/eclipse/jface/text/AbstractDocument.doFireDocumentChanged(AbstractDocument.java:736(Compiled Code)) at org/eclipse/jface/text/AbstractDocument.doFireDocumentChanged(AbstractDocument.java:719(Compiled Code)) at org/eclipse/jface/text/AbstractDocument.fireDocumentChanged(AbstractDocument.java:796(Compiled Code)) at org/eclipse/jface/text/AbstractDocument.replace(AbstractDocument.java:1191(Compiled Code)) at org/eclipse/core/internal/filebuffers/SynchronizableDocument.replace(SynchronizableDocument.java:195) at org/eclipse/jface/text/AbstractDocument.replace(AbstractDocument.java:1210(Compiled Code)) at org/eclipse/core/internal/filebuffers/SynchronizableDocument.replace(SynchronizableDocument.java:180(Compiled Code)) at org/eclipse/text/edits/DeleteEdit.performDocumentUpdating(DeleteEdit.java:64(Compiled Code)) at org/eclipse/text/edits/TextEdit.traverseDocumentUpdating(TextEdit.java:917(Compiled Code)) at org/eclipse/text/edits/TextEdit.traverseDocumentUpdating(TextEdit.java:910(Compiled Code)) at org/eclipse/text/edits/TextEditProcessor.executeDo(TextEditProcessor.java:195(Compiled Code)) at org/eclipse/text/edits/TextEdit.dispatchPerformEdits(TextEdit.java:739(Compiled Code)) at org/eclipse/text/edits/TextEditProcessor.performEdits(TextEditProcessor.java:150(Compiled Code)) at org/eclipse/text/edits/TextEdit.apply(TextEdit.java:710(Compiled Code)) at org/eclipse/text/edits/TextEdit.apply(TextEdit.java:735(Compiled Code)) at com/ibm/team/codegen/internal/query/UnusedImportRemover.removeUnusedImports(UnusedImportRemover.java:103(Compiled Code)) at com/ibm/team/codegen/internal/query/UnusedImportRemover.access$1(UnusedImportRemover.java:101) at com/ibm/team/codegen/internal/query/UnusedImportRemover$UnusedImportsRequestor.acceptAST(UnusedImportRemover.java:178) at org/eclipse/jdt/core/dom/CompilationUnitResolver.resolve(CompilationUnitResolver.java:883) at org/eclipse/jdt/core/dom/CompilationUnitResolver.resolve(CompilationUnitResolver.java:577) at org/eclipse/jdt/core/dom/ASTParser.createASTs(ASTParser.java:888) at com/ibm/team/codegen/internal/query/UnusedImportRemover.removeUnusedImports(UnusedImportRemover.java:93) at com/ibm/team/codegen/internal/query/QueryModelGen.generate(QueryModelGen.java:254) at com/ibm/team/codegen/internal/CodeGenerator.generateQueryModel(CodeGenerator.java:155) at com/ibm/team/codegen/internal/CodeGenerator.generate(CodeGenerator.java:139) at com/ibm/team/codegen/TeamCodeGen$1.run(TeamCodeGen.java:38) at org/eclipse/core/internal/resources/Workspace.run(Workspace.java:1975(Compiled Code)) at org/eclipse/core/internal/resources/Workspace.run(Workspace.java:1957) at com/ibm/team/codegen/TeamCodeGen.generate(TeamCodeGen.java:41) at com/ibm/team/codegen/ui/actions/GenerateComponentAction.generate(GenerateComponentAction.java:56) at com/ibm/team/codegen/ui/actions/GenerateComponentAction$1.run(GenerateComponentAction.java:34) at org/eclipse/core/internal/jobs/Worker.run(Worker.java:54(Compiled Code))I've also attached the full javacore file.	The deadlock happens because a third party product applies text edits in the wrong context/thread. This should either be done directly in the UI thread, a modal context or - preferred - by using org.eclipse.core.filebuffers.IFileBufferManager.execute(Runnable).(In reply to)Thanks for the quick answer. I didn't realize that the text editing should only happen in the UI thread. I looked at the Javadoc for TextEdit class and the apply method in particular, but neither had any reference to the method only working on the UI thread. Would it make sense to fail to execute the method when the wrong thread is used if that is a real requirement? In my case, the code has been working for >1 year before this problem happened.Additionally, can you explain why TextEdits can only happen on the UI thread? Editing file contents seems like a non-UI operation.Do you have steps? Normally your code will probably work. I assume in this case a compare editor was open on the same file.Not the UI thread but the same synchronization context that you apply your edits on. If you do this on a simple document you're fine but in your case you have a synchronized document at hand.We can improve the Javadoc but there's nothing we can do to fix the deadlock.No, because in most cases it will still work.Actually Compare could resolve the problem by using asyncExec(...) instead of syncExec(...). That's the pattern that should be used to avoid such deadlocks unless there's a proven must-have for syncExec.	4.0
id=427422	REOPENED	Platform	Compare	4.3.1	PC Windows 7	P3 normal	Platform-Compare-Inbox	2014-02-04 18:53 EST by	Sam Davis	2014-02-25 17:32 EST (	2 users	Lately I am finding that opening a compare editor from the history view very often takes more than 10 seconds. The only thing I can think of that has changed is that I have cloned some more Git repositories - I now have a total of 25.	Createdstack traceCreatedstack trace2Createdstack trace3Here are thread dumps taken a few seconds apart while Eclipse was frozen. If you diff them it appears that all the activity is on the main thread.That doesn't say much. Try a profiler, e.g. jvisualvm instead. To me it seems the time spent is not in EGit nor JGit and depends on the file type and size. Compare even without involving Git is awfully slow.Thanks. I think I am seeing this sometimes with the Gerrit connector as well, so maybe it just something wrong with my workspace. I'm marking this invalid for now.Opening the compare editor *is* slow. The question is where the problem is. I don't think it is EGit.CreatedJVisualVM samplingI can't attribute the issue to EGit. Opening the compare editor is very slow without EGit, i.e. without Egit attached, from the local history.The local history works fine for me. But with EGit it's more than just slow - after I try to open a compare editor from the EGit history view, lots of things stop working (e.g. find (ctrl+f) in the Java editor) and I have to restart Eclipse. I will probably ditch this workspace when I get a chance.	9.0
id=8760	REOPENED	Platform	CVS	2.0	All All	P3 normal	platform-cvs-inbox	2002-01-30 11:25 EST by	Peter Burka	2011-02-08 04:55 EST (	1 user	On the advice of JM, I turned on the 'Link History view to current selection' option in the preferences panel for Team. However I found that this option didn't provide the functionality that I desire.I opened up a Team perspective so that I could load changes from the repository. As I selected classes that had changed in the 'Synchronize - Catch Up Mode' editor, I had expected the history view to update itself automatically, but it seems that it does not track selection in this editor.This is very unfortunate, since this is the only view where I really want this feature -- I want to know why the changes that I'm browsing were made.	I noticed this not always working too.We've completely disabled the link history view feature. It caused no end ofproblems, mostly due to the fact that we have to perform long-running serveroperations on selections, which caused problems with progress monitoring anddouble-clicking, as well as others.I'll mark this as future, as if we re-enable this feature later we'll look atmaking it work in the sync view too.Link to hisotry view is no longer supportedAs of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.Link with history has been brought back some time ago and hence this bug is back.The problem is that the selection works until a file gets modified locally and then replaced from CVS: the timestamp does not get updated to the revision and hence the revision is no longer found because the selection is computed based on the timestamp, see CVSHistoryPage.selectLocalRevision(long).Other test case: simply replace a file with another sticky revision.Possible fix: If no matching entry is found, check whether the file has changed compared to the base revision and if not, select the base revision.	5.0
id=37864	REOPENED	Platform	CVS	2.1	PC Windows XP	P3 normal	platform-cvs-inbox	2003-05-20 08:57 EDT by	Michael Valenta	2010-09-03 17:15 EDT (	9 users	This is from the platform-vcm-dev mailing list. The inconsitency is caused by the use of phantom folders to improve sync efficiency. I don't think it causes any problems with the command line client. The concern mentioned below that is of interest is that, on update, there may be a lot of extra work done because of the phantom folders.Eclipse 2.1I have noticed a strange behaviour when using the "purge empty dir" option.When i checkout a project that has deleted directories they are correctly not checked out but the related CVS/Entries file that is built, still lists them and any following cvs update (all done with -d -P options) do not clean Entries file and still tries to update from those deleted directories producing a lot of useless work when the project has many of them.The same happens if i delete a directory from within eclipse, the cvsupdate does not clean Entries file from that deleted dir.This looks different from normal cvs behaviour that when said to "purge empty dir" deletes the entry from Entries file and never more bothers with that directory unless you resurrect it somehow.Is that an intended behaviour or is an error?Regards, Gabriele.	***has been marked as a duplicate of this bug. ***I got a question from a user on this; any update on this one?This item wil not be addressed for 3.0.That's understandable (should it be marked LATER?), but I guess I was asking if you have any ideas for if/when/how to do this andpost 3.0? From what little I know about CVS, I was wondering if it was even feasible.This bug is unrelated to. This bug is not overly difficult to fix but it is not trivial either.is harder to fix since it is a limitation of CVS.I think i've found some strage behaviour in Eclipse 3.0.1that seems to berelated to this bug.We work with an Eclipse project which contained a folder hierarchy that used tostore some files. They were all deleted after some time. The root was also addedto the .cvsignore file.But every time a "synchronize with cvs" operation is performed Eclipse seems tosomehow "remember" that those folders existed and simply ignores the .cvsignorefile including it's files as possible "add" entries. Even the local CVS data("CVS" directories and its files) are recreated for all folders in thehierarchy, leaving other CVS softwares a little confused (like TortoiseCVS).***has been marked as a duplicate of this bug. ***This behaviour still exists in 3.1.1(In reply to)There is currently no plan to address this item.As of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.(In reply to)I'm not sure how to reopen the bug, but it is "still valid" for me.My scenario is that I accidentally commited my "target" directory where all my compiled .class files end up. So I deleted the directory, committed the fact the directory was deleted, and then created a ".cvsignore" file instructing the CVS clients to ignore the "target" directory.Unfortunately, Eclipse does not obey the ".cvsignore" file and attempts to recommit the .class files on every synchronize.(In reply to)Done.	12.0
id=76561	REOPENED	Platform	CVS	3.0	PC Windows XP	P3 normal	platform-cvs-inbox	2004-10-19 10:10 EDT by	Michael Valenta	2009-10-08 04:57 EDT (	4 users	The following line should allow a date to be loaded from a branch: cvs update -D"2004-09-28" -rR2_BugfixWe should investigate how this could be surfaced in Eclipse.	Would be nice but not currently plannedThre is currently no plan to address this item.As of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.This bug is worth fixing.	4.0
id=399375	REOPENED	Platform	CVS	4.3	All All	P3 normal	platform-cvs-inbox	2013-01-29 07:13 EST by	Szymon Brandys	2014-09-12 09:25 EDT (	4 users	Build I20130128-2000, but I see it in other builds too.org.eclipse.team.core.TeamException: Problems reported while synchronizing CVS Workspace. 0 of 1 resources were synchronized.at org.eclipse.team.core.variants.ResourceVariantTreeSubscriber.refresh(ResourceVariantTreeSubscriber.java:144)at org.eclipse.team.tests.ccvs.core.mappings.ResourceMapperTests.getIncoming(ResourceMapperTests.java:392)at org.eclipse.team.tests.ccvs.core.mappings.ResourceMapperTests.replace(ResourceMapperTests.java:106)at org.eclipse.team.tests.ccvs.core.mappings.ResourceMapperTests.testReplace(ResourceMapperTests.java:516)at org.eclipse.team.tests.ccvs.core.EclipseTest.runTest(EclipseTest.java:1448)at org.eclipse.team.tests.ccvs.core.EclipseTest.runBare(EclipseTest.java:1295)at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)at junit.extensions.TestSetup$1.protect(TestSetup.java:23)at junit.extensions.TestSetup.run(TestSetup.java:27)at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)at junit.extensions.TestSetup$1.protect(TestSetup.java:23)at junit.extensions.TestSetup.run(TestSetup.java:27)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:655)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:310)at org.eclipse.test.UITestApplication$2.run(UITestApplication.java:197)at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135)at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3680)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3329)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1057)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:941)at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:79)at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:588)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:543)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124)at org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:140)at org.eclipse.test.UITestApplication.run(UITestApplication.java:62)at org.eclipse.test.UITestApplication.start(UITestApplication.java:212)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:354)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:181)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:636)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:591)at org.eclipse.equinox.launcher.Main.run(Main.java:1450)at org.eclipse.equinox.launcher.Main.main(Main.java:1426)at org.eclipse.core.launcher.Main.main(Main.java:34)Contains: An error occurred synchronizing /testReplace-1359440078863: I/O has been interrupted.org.eclipse.team.internal.ccvs.core.connection.CVSCommunicationException: I/O has been interrupted.at org.eclipse.team.internal.ccvs.core.connection.Connection.flush(Connection.java:92)at org.eclipse.team.internal.ccvs.core.client.Session.open(Session.java:171)at org.eclipse.team.internal.ccvs.core.resources.RemoteFolderTreeBuilder.fetchNewDirectories(RemoteFolderTreeBuilder.java:239)at org.eclipse.team.internal.ccvs.core.resources.RemoteFolderTreeBuilder.buildTree(RemoteFolderTreeBuilder.java:161)at org.eclipse.team.internal.ccvs.core.resources.RemoteFolderTreeBuilder.buildRemoteTree(RemoteFolderTreeBuilder.java:138)at org.eclipse.team.internal.ccvs.core.resources.CVSWorkspaceRoot.getRemoteTree(CVSWorkspaceRoot.java:178)at org.eclipse.team.internal.ccvs.core.syncinfo.CVSResourceVariantTree.fetchVariant(CVSResourceVariantTree.java:78)at org.eclipse.team.core.variants.AbstractResourceVariantTree.refresh(AbstractResourceVariantTree.java:84)at org.eclipse.team.internal.ccvs.core.syncinfo.CVSResourceVariantTree.refresh(CVSResourceVariantTree.java:334)at org.eclipse.team.core.variants.AbstractResourceVariantTree.refresh(AbstractResourceVariantTree.java:54)at org.eclipse.team.core.variants.ResourceVariantTreeSubscriber.refresh(ResourceVariantTreeSubscriber.java:173)at org.eclipse.team.core.variants.ResourceVariantTreeSubscriber.refresh(ResourceVariantTreeSubscriber.java:114)at org.eclipse.team.tests.ccvs.core.mappings.ResourceMapperTests.getIncoming(ResourceMapperTests.java:392)at org.eclipse.team.tests.ccvs.core.mappings.ResourceMapperTests.replace(ResourceMapperTests.java:106)at org.eclipse.team.tests.ccvs.core.mappings.ResourceMapperTests.testReplace(ResourceMapperTests.java:516)at org.eclipse.team.tests.ccvs.core.EclipseTest.runTest(EclipseTest.java:1448)at org.eclipse.team.tests.ccvs.core.EclipseTest.runBare(EclipseTest.java:1295)at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)at junit.extensions.TestSetup$1.protect(TestSetup.java:23)at junit.extensions.TestSetup.run(TestSetup.java:27)at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)at junit.extensions.TestSetup$1.protect(TestSetup.java:23)at junit.extensions.TestSetup.run(TestSetup.java:27)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:655)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:310)at org.eclipse.test.UITestApplication$2.run(UITestApplication.java:197)at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135)at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3680)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3329)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1057)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:941)at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:79)at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:588)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:543)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124)at org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:140)at org.eclipse.test.UITestApplication.run(UITestApplication.java:62)at org.eclipse.test.UITestApplication.start(UITestApplication.java:212)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:354)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:181)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:636)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:591)at org.eclipse.equinox.launcher.Main.run(Main.java:1450)at org.eclipse.equinox.launcher.Main.main(Main.java:1426)at org.eclipse.core.launcher.Main.main(Main.java:34)Caused by: java.io.InterruptedIOException: Timeout while writing to output streamat org.eclipse.team.internal.core.streams.PollingOutputStream.flush(PollingOutputStream.java:130)at org.eclipse.team.internal.ccvs.core.connection.Connection.flush(Connection.java:90)Contains: The most likely cause of the interrupt is either an intermittent network failure or a communications timeout.Contains: The CVS communications timeout can be adjusted in the Team/CVS preferences.Contains: Another possible cause is the improper configuration of the "ext" connection method.Contains: The "ext" connection method can be configured on the Team/CVS/EXT Connection Method preference page	This problem is caused by a timeout, probably a connection problem. In last few builds it happens from time to time in those tests: testReplace, testUpdate, testCommit. When I use localhost repository for running the tests locally I never get this error.David, is there a way we could improve the connection with CVS?Are you 100% sure it's a timeout? It could also be a test ordering problem: when looking at the the test results of the last two builds, I see that the tests run in different order each time. This is expected with Java 7. If the order is the problem, then you should use org.eclipse.test.OrderedTestSuite#OrderedTestSuite(Class), which guarantees that the tests are run as they appear in the (class) file.I managed to reproduce similar problems by manipulation of the CVS timeout preference. I'll increase the timeout for tests, commit it and see if it helps in next few builds.(In reply to)Out of curiosity, how did you change the CVS timeout for the tests? Is that a command line property? Or, do you have your own workspaces, and change in .metadata/.plugins/org.eclipse.core.runtime/.settings/org.eclipse.team.cvs.ui.prefsor something? (I'm not sure where its stored). I once added some "settings customization" code for our tests for org.eclipse.core.net.prefs (to specify proxies for p2) but a) it was pretty convoluted and a lot of work and b) I was never sure if it was working or not :) As I'm sure you know, our cvs test repos are on "hudson", so if you suspect an infrastructure problem, you could open a bug there (under hudson).(In reply to)This is a preference of CVS, but you can change it programmatically:CVSProviderPlugin.getPlugin().setTimeout(TIMEOUT);Looks like increasing timeout did the trick: no failing tests in the last build.The timeout occurred again in N20130131-2000 in testUpdate. It's now increased to 10 minutes, I will check if there aren't other places where the timeout may be overwritten, but there is still a possibility that this machine suffers from some network overloads and this makes our tests fail.The timeout occurred in I20130205-0800 again. I verified that there are no other places that could overwrite the timeout on the client side, so the reason of timeouts must be some network failures or overload on the CVS server.Looks like we finding the solution in this release is unlikely, I modified the tests so that they should only log when timeout happens, not fail. Let's got back to it in M1.(In reply to)ResourceVariantTreeSubscriber.refresh still fails:Please disable the test until it is fixed.(In reply to)I found a reason. It's not easy to fake the failure locally, but from what I managed to test it should not fail now.In N20130618-2000 #testCommit failed:Problems reported while synchronizing CVS Workspace. 2 of 3 resources were synchronized.org.eclipse.team.core.TeamException: Problems reported while synchronizing CVS Workspace. 2 of 3 resources were synchronized.at org.eclipse.team.core.variants.ResourceVariantTreeSubscriber.refresh(ResourceVariantTreeSubscriber.java:144)at org.eclipse.team.tests.ccvs.core.mappings.ResourceMapperTests.assertUnchanged(ResourceMapperTests.java:378)at org.eclipse.team.tests.ccvs.core.mappings.ResourceMapperTests.assertCommit(ResourceMapperTests.java:370)at org.eclipse.team.tests.ccvs.core.mappings.ResourceMapperTests.commit(ResourceMapperTests.java:124)at org.eclipse.team.tests.ccvs.core.mappings.ResourceMapperTests.testCommit(ResourceMapperTests.java:594)at org.eclipse.team.tests.ccvs.core.EclipseTest.runTest(EclipseTest.java:1493)at org.eclipse.team.tests.ccvs.core.EclipseTest.runBare(EclipseTest.java:1340)at junit.extensions.TestDecorator.basicRun(TestDecorator.java:23)at junit.extensions.TestSetup$1.protect(TestSetup.java:23)at junit.extensions.TestSetup.run(TestSetup.java:27)at junit.extensions.TestDecorator.basicRun(TestDecorator.java:23)at junit.extensions.TestSetup$1.protect(TestSetup.java:23)at junit.extensions.TestSetup.run(TestSetup.java:27)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:655)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:310)at org.eclipse.test.UITestApplication$2.run(UITestApplication.java:197)at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135)at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3976)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3653)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1113)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:997)at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:138)at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:610)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:567)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124)at org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:140)at org.eclipse.test.UITestApplication.run(UITestApplication.java:62)at org.eclipse.test.UITestApplication.start(UITestApplication.java:212)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:354)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:181)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:636)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:591)at org.eclipse.equinox.launcher.Main.run(Main.java:1450)at org.eclipse.equinox.launcher.Main.main(Main.java:1426)at org.eclipse.core.launcher.Main.main(Main.java:34)Contains: An error occurred synchronizing /testCommit-1371620406596/folder1/subfolder1/c.txt: I/O has been interrupted.org.eclipse.team.internal.ccvs.core.connection.CVSCommunicationException: I/O has been interrupted.at org.eclipse.team.internal.ccvs.core.connection.Connection.flush(Connection.java:92)at org.eclipse.team.internal.ccvs.core.client.Session.open(Session.java:171)at org.eclipse.team.internal.ccvs.core.resources.RemoteFolderTreeBuilder.buildTree(RemoteFolderTreeBuilder.java:289)at org.eclipse.team.internal.ccvs.core.resources.RemoteFolderTreeBuilder.buildRemoteTree(RemoteFolderTreeBuilder.java:142)at org.eclipse.team.internal.ccvs.core.resources.CVSWorkspaceRoot.getRemoteTree(CVSWorkspaceRoot.java:171)at org.eclipse.team.internal.ccvs.core.syncinfo.CVSResourceVariantTree.fetchVariant(CVSResourceVariantTree.java:78)at org.eclipse.team.core.variants.AbstractResourceVariantTree.refresh(AbstractResourceVariantTree.java:84)at org.eclipse.team.internal.ccvs.core.syncinfo.CVSResourceVariantTree.refresh(CVSResourceVariantTree.java:334)at org.eclipse.team.core.variants.AbstractResourceVariantTree.refresh(AbstractResourceVariantTree.java:54)at org.eclipse.team.core.variants.ResourceVariantTreeSubscriber.refresh(ResourceVariantTreeSubscriber.java:173)at org.eclipse.team.core.variants.ResourceVariantTreeSubscriber.refresh(ResourceVariantTreeSubscriber.java:114)at org.eclipse.team.tests.ccvs.core.mappings.ResourceMapperTests.assertUnchanged(ResourceMapperTests.java:378)at org.eclipse.team.tests.ccvs.core.mappings.ResourceMapperTests.assertCommit(ResourceMapperTests.java:370)at org.eclipse.team.tests.ccvs.core.mappings.ResourceMapperTests.commit(ResourceMapperTests.java:124)at org.eclipse.team.tests.ccvs.core.mappings.ResourceMapperTests.testCommit(ResourceMapperTests.java:594)at org.eclipse.team.tests.ccvs.core.EclipseTest.runTest(EclipseTest.java:1493)at org.eclipse.team.tests.ccvs.core.EclipseTest.runBare(EclipseTest.java:1340)at junit.extensions.TestDecorator.basicRun(TestDecorator.java:23)at junit.extensions.TestSetup$1.protect(TestSetup.java:23)at junit.extensions.TestSetup.run(TestSetup.java:27)at junit.extensions.TestDecorator.basicRun(TestDecorator.java:23)at junit.extensions.TestSetup$1.protect(TestSetup.java:23)at junit.extensions.TestSetup.run(TestSetup.java:27)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:655)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:310)at org.eclipse.test.UITestApplication$2.run(UITestApplication.java:197)at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135)at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3976)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3653)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1113)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:997)at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:138)at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:610)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:567)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124)at org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:140)at org.eclipse.test.UITestApplication.run(UITestApplication.java:62)at org.eclipse.test.UITestApplication.start(UITestApplication.java:212)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:354)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:181)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:636)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:591)at org.eclipse.equinox.launcher.Main.run(Main.java:1450)at org.eclipse.equinox.launcher.Main.main(Main.java:1426)at org.eclipse.core.launcher.Main.main(Main.java:34)Caused by: java.io.InterruptedIOException: Timeout while writing to output streamat org.eclipse.team.internal.core.streams.PollingOutputStream.flush(PollingOutputStream.java:130)at org.eclipse.team.internal.ccvs.core.connection.Connection.flush(Connection.java:90)Contains: The most likely cause of the interrupt is either an intermittent network failure or a communications timeout.Contains: The CVS communications timeout can be adjusted in the Team/CVS preferences.Contains: Another possible cause is the improper configuration of the "ext" connection method.Contains: The "ext" connection method can be configured on the Team/CVS/EXT Connection Method preference page(In reply to)And this was on Mac OS X.ResourceMapperTests.testCommit failed again on Mac (N20130707-2000).ResourceMapperTests.testCommit failed again on Mac (N20130708-2000).And again:#testCommit failed again on Mac OS X:==> I've disabled that test on Mac OS X for now.This came back, see.	19.0
id=418328	REOPENED	Platform	CVS	3.8.2	PC Windows 7	P3 major	platform-cvs-inbox	2013-09-30 08:53 EDT by	Ken Douglas	2016-04-07 04:51 EDT (	2 users	I am using eclipse 3.8.2 (SR2) having downloaded it today.I went to import a project from CVS. Whilst in the CVS Repository Explorer and then trying to refresh CVS Branches I am prompted to select the cvs modules to refresh. I selected the Alias module(This alias has several modules in it) and then I do a "Search Deeply" on the selcted Alias module. At this point I am returned to to the CVS Repository Explorer page and nothing has refreshed. In 3.5.2 this was working as expected.I am therefor unable to proceed.Let me know if you need any more details.RegardsKen	More details:-Our CVS System is on a Red Hat v5 Versions System (CVS) 1.11.22Have tested with Version: 3.7.2Build id: M20120208-0800and works as expected.Just confirmed that this functionality stopped working in 3.8.0 of Eclipse.As Tom pointed out, the crash is NOT_ECLIPSE.That it failed to restart is probably caused by a corrupted 'workbench.xmi' file.I assume this got fixed via. Please reopen is you can still reproduce using Luna (4.4).*** This bug has been marked as a duplicate of***(In reply to Dani Megert from)Sorry, this was meant for another bug.Does it still not work using our latest release:?Do you have a public repository where I can test this?This bug seems to be still present in Mars.I can confirm that MyEclipse 10 was working fine and since then I have had to move up to Java 8 so tried Eclipse Mars before going to MyEclipse Can anyone else assist?(In reply to Ken Douglas from)Sorry, no one is currently working on the CVS component.	8.0
id=421436	REOPENED	Platform	CVS	4.4	All All	P3 normal	platform-cvs-inbox	2013-11-11 05:52 EST by	Dani Megert	2016-06-04 04:03 EDT (	1 user	N20131108-2000.N/Ajunit.framework.AssertionFailedErrorat org.eclipse.team.tests.ccvs.core.provider.RemoteResourceTest.testFileRevisionsForBranches(RemoteResourceTest.java:335)at org.eclipse.team.tests.ccvs.core.EclipseTest.runTest(EclipseTest.java:1493)at org.eclipse.team.tests.ccvs.core.EclipseTest.runBare(EclipseTest.java:1340)at junit.extensions.TestDecorator.basicRun(TestDecorator.java:23)at junit.extensions.TestSetup$1.protect(TestSetup.java:23)at junit.extensions.TestSetup.run(TestSetup.java:27)at junit.extensions.TestDecorator.basicRun(TestDecorator.java:23)at junit.extensions.TestSetup$1.protect(TestSetup.java:23)at junit.extensions.TestSetup.run(TestSetup.java:27)at junit.extensions.TestDecorator.basicRun(TestDecorator.java:23)at junit.extensions.TestSetup$1.protect(TestSetup.java:23)at junit.extensions.TestSetup.run(TestSetup.java:27)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:657)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:310)at org.eclipse.test.UITestApplication$2.run(UITestApplication.java:197)at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:136)at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4144)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3761)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1113)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:997)at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:146)at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:613)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:567)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124)at org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:140)at org.eclipse.test.UITestApplication.run(UITestApplication.java:62)at org.eclipse.test.UITestApplication.start(UITestApplication.java:212)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:109)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:80)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:372)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:226)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:636)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:591)at org.eclipse.equinox.launcher.Main.run(Main.java:1450)at org.eclipse.equinox.launcher.Main.main(Main.java:1426)at org.eclipse.core.launcher.Main.main(Main.java:34)	Also failed in the last M-build:This test hasn't failed for a long time. Closing for now.Failed again. This time on Linux:	3.0
id=428608	REOPENED	Platform	CVS	4.4	All All	P3 normal	platform-cvs-inbox	2014-02-20 02:54 EST by	Dani Megert	2016-05-13 02:48 EDT (	1 user	N20140219-2000,expected:<1> but was:<0>junit.framework.AssertionFailedError: expected:<1> but was:<0>at org.eclipse.team.tests.ccvs.ui.RepositoriesViewTests.testBranchSubmoduleChildren(RepositoriesViewTests.java:104)at org.eclipse.team.tests.ccvs.core.EclipseTest.runTest(EclipseTest.java:1493)at org.eclipse.team.tests.ccvs.core.EclipseTest.runBare(EclipseTest.java:1340)at junit.extensions.TestDecorator.basicRun(TestDecorator.java:23)at junit.extensions.TestSetup$1.protect(TestSetup.java:23)at junit.extensions.TestSetup.run(TestSetup.java:27)at junit.extensions.TestDecorator.basicRun(TestDecorator.java:23)at junit.extensions.TestSetup$1.protect(TestSetup.java:23)at junit.extensions.TestSetup.run(TestSetup.java:27)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:657)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:310)at org.eclipse.test.UITestApplication$2.run(UITestApplication.java:197)at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:136)at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3746)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3394)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1122)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1006)at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:147)at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:620)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:571)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:125)at org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:140)at org.eclipse.test.UITestApplication.run(UITestApplication.java:62)at org.eclipse.test.UITestApplication.start(UITestApplication.java:212)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:133)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:103)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:374)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:228)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:648)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:603)at org.eclipse.equinox.launcher.Main.run(Main.java:1462)at org.eclipse.equinox.launcher.Main.main(Main.java:1438)at org.eclipse.core.launcher.Main.main(Main.java:34)	Failed again:This test hasn't failed for a long time. Closing for now.Failed again:	3.0
id=72906	REOPENED	Platform	CVS	3.0	PC Windows XP	P3 normal	platform-cvs-inbox	2004-08-30 16:16 EDT by	Patrick Dubroy	2009-05-20 05:06 EDT (	1 user	1. Right-click on a project that has some changes, and choose "Team->Synchronizewith Repository..."2. Go through the differences using the down arrow ("Go to Next Difference").3. When you reach the last difference, clicking the down arrow no longer doesanything. It should either be greyed out, or it should wrap around and startshowing the differences from the top again.	It could also prompt the user to wrap. This is currently what the comparenext/previous does.This was fixed in 3.3.Build id: I20090515-1143This is still/again a problem. Moreover if the last file in the Synchronize View is selected and Compare Editor is closed hitting "Next Difference" button does nothing. It even doesn't open the editor for the file.	3.0
id=452981	REOPENED	Platform	CVS	4.5	PC Mac OS X	P3 normal	platform-cvs-inbox	2014-11-24 04:49 EST by	Dani Megert	2016-06-04 04:06 EDT (	1 user	N20141123-2000.ResourceMapperTests.testCacheRemote failedProblems reported while synchronizing CVS Workspace. 0 of 1 resources were synchronized.org.eclipse.team.core.TeamException: Problems reported while synchronizing CVS Workspace. 0 of 1 resources were synchronized.at org.eclipse.team.core.variants.ResourceVariantTreeSubscriber.refresh(ResourceVariantTreeSubscriber.java:144)at org.eclipse.team.tests.ccvs.core.mappings.ResourceMapperTests.cacheRemote(ResourceMapperTests.java:717)at org.eclipse.team.tests.ccvs.core.mappings.ResourceMapperTests.testCacheRemote(ResourceMapperTests.java:712)at org.eclipse.team.tests.ccvs.core.EclipseTest.runTest(EclipseTest.java:1493)at org.eclipse.team.tests.ccvs.core.EclipseTest.runBare(EclipseTest.java:1340)at junit.extensions.TestDecorator.basicRun(TestDecorator.java:23)at junit.extensions.TestSetup$1.protect(TestSetup.java:23)at junit.extensions.TestSetup.run(TestSetup.java:27)at junit.extensions.TestDecorator.basicRun(TestDecorator.java:23)at junit.extensions.TestSetup$1.protect(TestSetup.java:23)at junit.extensions.TestSetup.run(TestSetup.java:27)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:657)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:310)at org.eclipse.test.UITestApplication$2.run(UITestApplication.java:197)at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:136)at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3983)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3660)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1151)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1032)at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:148)at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:648)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:592)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:138)at org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:140)at org.eclipse.test.UITestApplication.run(UITestApplication.java:62)at org.eclipse.test.UITestApplication.start(UITestApplication.java:212)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:380)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:235)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:648)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:603)at org.eclipse.equinox.launcher.Main.run(Main.java:1465)at org.eclipse.equinox.launcher.Main.main(Main.java:1438)at org.eclipse.core.launcher.Main.main(Main.java:34)Contains: An error occurred synchronizing /testCacheRemote-1416805746927: I/O has been interrupted.org.eclipse.team.internal.ccvs.core.connection.CVSCommunicationException: I/O has been interrupted.at org.eclipse.team.internal.ccvs.core.connection.Connection.flush(Connection.java:92)at org.eclipse.team.internal.ccvs.core.client.Session.open(Session.java:171)at org.eclipse.team.internal.ccvs.core.resources.RemoteFolderTreeBuilder.fetchDelta(RemoteFolderTreeBuilder.java:187)at org.eclipse.team.internal.ccvs.core.resources.RemoteFolderTreeBuilder.buildTree(RemoteFolderTreeBuilder.java:155)at org.eclipse.team.internal.ccvs.core.resources.RemoteFolderTreeBuilder.buildRemoteTree(RemoteFolderTreeBuilder.java:138)at org.eclipse.team.internal.ccvs.core.resources.CVSWorkspaceRoot.getRemoteTree(CVSWorkspaceRoot.java:178)at org.eclipse.team.internal.ccvs.core.syncinfo.CVSResourceVariantTree.fetchVariant(CVSResourceVariantTree.java:78)at org.eclipse.team.core.variants.AbstractResourceVariantTree.refresh(AbstractResourceVariantTree.java:84)at org.eclipse.team.internal.ccvs.core.syncinfo.CVSResourceVariantTree.refresh(CVSResourceVariantTree.java:334)at org.eclipse.team.core.variants.AbstractResourceVariantTree.refresh(AbstractResourceVariantTree.java:54)at org.eclipse.team.core.variants.ResourceVariantTreeSubscriber.refresh(ResourceVariantTreeSubscriber.java:173)at org.eclipse.team.core.variants.ResourceVariantTreeSubscriber.refresh(ResourceVariantTreeSubscriber.java:114)at org.eclipse.team.tests.ccvs.core.mappings.ResourceMapperTests.cacheRemote(ResourceMapperTests.java:717)at org.eclipse.team.tests.ccvs.core.mappings.ResourceMapperTests.testCacheRemote(ResourceMapperTests.java:712)at org.eclipse.team.tests.ccvs.core.EclipseTest.runTest(EclipseTest.java:1493)at org.eclipse.team.tests.ccvs.core.EclipseTest.runBare(EclipseTest.java:1340)at junit.extensions.TestDecorator.basicRun(TestDecorator.java:23)at junit.extensions.TestSetup$1.protect(TestSetup.java:23)at junit.extensions.TestSetup.run(TestSetup.java:27)at junit.extensions.TestDecorator.basicRun(TestDecorator.java:23)at junit.extensions.TestSetup$1.protect(TestSetup.java:23)at junit.extensions.TestSetup.run(TestSetup.java:27)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:657)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:310)at org.eclipse.test.UITestApplication$2.run(UITestApplication.java:197)at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:136)at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3983)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3660)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1151)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1032)at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:148)at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:648)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:592)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:138)at org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:140)at org.eclipse.test.UITestApplication.run(UITestApplication.java:62)at org.eclipse.test.UITestApplication.start(UITestApplication.java:212)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:380)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:235)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:648)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:603)at org.eclipse.equinox.launcher.Main.run(Main.java:1465)at org.eclipse.equinox.launcher.Main.main(Main.java:1438)at org.eclipse.core.launcher.Main.main(Main.java:34)Caused by: java.io.InterruptedIOException: Timeout while writing to output streamat org.eclipse.team.internal.core.streams.PollingOutputStream.flush(PollingOutputStream.java:129)at org.eclipse.team.internal.ccvs.core.connection.Connection.flush(Connection.java:90)Contains: The most likely cause of the interrupt is either an intermittent network failure or a communications timeout.Contains: The CVS communications timeout can be adjusted in the Team/CVS preferences.Contains: Another possible cause is the improper configuration of the "ext" connection method.Contains: The "ext" connection method can be configured on the Team/CVS/EXT Connection Method preference page	CreatedTest Failure XMLThe message already says that "the most likely cause of the interrupt is either an intermittent network failure or a communications timeout". We observe such failures from time to time for different tests, so I don't think it is sufficient to say that it is not a network problem.Failed again in N20141126-2000 (also Mac).This test hasn't failed for quite some time and as mentioned inthere are different random CVS tests failing on Mac from time to time and all of them mention a network problem as one of possible causes. Closing for now.Failed again. This time on Linux:	5.0
id=96780	REOPENED	Platform	Debug	3.1	PC Windows XP	P3 major	Platform-Debug-Inbox	2005-05-26 09:56 EDT by	Gytis Jakutonis	2011-11-30 08:10 EST (	2 users	{External tools/Ant Build} freezes (waiting for 'Building workspace'), even if Build before launch is unchecked.	Going to need more details...I have done thousands of Ant builds and external tool launches in Eclipse recently and have not seen this problem.Which Eclipse build are you using?Do all builds cause this to occur?Do you have auto-build on or off?Can you provide a reproduceable test case?CreatedscreenshotWhich Eclipse build are you using? Version: 3.1.0 Build id: I20050513-1415Do all builds cause this to occur? I've tried to run ant task as external tool and through ant view.Do you have auto-build on or off? I've tried with auto-build on and off.By the way - it is very simpe project (pure Java) and simple ant task (zipping some files).It was not that I did not believe you that the build was freezing, I do :-)But I need a test case to reproduce as I have never seen this behavior.Are you running your builds in the same or separate JRE?Can you run Java programs?If you do a full clean (Project>Clean>Clean All Projects) with autobuild on, do you still see the problem?Moving to Platform debug which provides the launching framework that Ant uses.Is this still an issue in 3.1RC2?Marking as REMIND for more input.I have never seen this either, reopening to closemarking WORKSFORME without further input or additional steps to produceI have an Ant build configuration with "Build before launch" unchecked and "Run in the same JRE as the workspace" selected. While a full build is running (e.g. after Clean), the Ant build doesn't start (is waiting for the build to finish).When I turn off auto-build and cancel the full build, then I can run the Ant build.	9.0
id=153919	REOPENED	Platform	Debug	3.2	PC Linux	P3 normal	Platform-Debug-Inbox	2006-08-15 10:59 EDT by	Jerry Quinn	2012-07-05 10:42 EDT (	3 users	I use the emacs keybindings pref. If I put the cursor into the console, I can't use emacs keys to navigate and select text.	Moving to Debug for comment.Things to check, from Dani:"key bindings are per scope i.e. they also work in views if they tell the key binding service to support that scope (newer term for this is 'context') and if the view binds the command""...with old deprecated API you need to call: IKeyBindingService.setScopes(keyBindingScopes);this activates the commands from the given scopesthere is similar non-deprecated api using contexts"The scope for most of the emacsAcceleratorConfiguration keybindings is org.eclipse.ui.textEditorScope. That is the also the scope for most of the text editor type keybindings in the normal scheme.But just setting the scope might not enable the actions.AFAIK, standard selection like CTRL+A and copy like CTRL+C are contributed in one of the global scopes, which is why they might be working already in the Console View.PWwhich emacs keybindings are you finding do not work? I can use the emacs copy/paste/select all/cut with no problems(In reply to)C-a selects all text rather than moving cursor to the start of the line.C-e brings up a list of buffers to switch toA-w, C-y doesn't copy and paste as expected.(In reply to)Also, C-w doesn't cut.I agree the C-a and C-e don't work, because we don't provide those actions in the console, but the others you mention work fine for me. The problem really is that we cannot mix contexts for "editing text" and "in console" (as discovered in)marking as LATER to be fixed alongsidewhen we decide how much we are willing to treat the console like a text editor instead of the text viewer that it is now.(In reply to)Would it make sense to treat the console as a read-only text editor? Then all the commands that don't change the contents work fine.yeah that is one idea we tossed around, the problem is that extending the editor adds in alot of extra goodies we don't want.....As of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.I'd really like to re-open this bug. PyDev has a lovely interactive console (which, as the name suggests, allows the user to enter commands and observe the results). It would be great if Emacs keybindings (especially CTRL+A, CTRL+E, CTRL+K) could be applied to the console.I'd like to re-open this bug but I can't see how to re-open it.I've opened a new bug for this issue:.***has been marked as a duplicate of this bug. ***Thanks Michael for re-opening this bug!	16.0
id=171849	REOPENED	Platform	Debug	3.3	PC All	P3 normal	Platform-Debug-Inbox	2007-01-26 14:25 EST by	Jared Burns	2013-01-24 13:57 EST (	1 user	Currently, launch configuration favorites are persisted as a property inside the configs themselves. This is a major problem for shared launch configurations.First, if anyone shares a launch config which is marked as a favorite, this config will show up in the run/debug menu of everyone who loads the affected project. This means that for large teams to have reasonable run/debug menus, everyone on the team must agree that no shared configs can be marked as favorites. This creates an ongoing problem as each new team member inevitably shares their "favorite" configs until they're cajoled.A complication of this arrangement is that if you mark a shared launch configuration as a favorite it dirties the .launch file. So unless you want to clutter everyone else's menus, you end up with a perpetual "outgoing change" showing up in your source control UI. The alternative is to create local duplicates of the shared configs, which can easily go out of sync.The overall result of this is that shared launch configurations are clumsy to work with and no nearly as useful as they could be.I think the solution to this problem is to change the way favorites are persisted. Instead of storing the favorites information in the launch config, this information should be stored in the local metadata. I should be able to choose the list of *my* favorite configurations from both shared and local configs and my personal choice of favorites should not hinder the rest of the team with whom I'm collaborating.	Marking as LATER. Feels late for 3.3As of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.I would really like this to be reconsidered. This issue is the result of a big design mistake in the support we added to share launch configs. The "favorites" attribute shouldn't be part of the launch config itself. It should be stored as workspace metadata.	3.0
id=59289	REOPENED	Platform	Debug	3.0	PC Linux-GTK	P3 enhancement	Platform-Debug-Inbox	2004-04-20 12:17 EDT by	Adam Kiezun	2015-09-23 06:17 EDT (	15 users	3.0 M7it seems that external tool builder names must be globally uniquei wanted to have 2 external tool builders for /usr/bin/make for 2 differentprojects, both called 'make clean' - eclipse would not allow methis restriction seems unnecessary	This is an artificial limitation in the launch framework, imposed by the launch dialog. The only real limitation is that two configs in the same directory/folder (metadata) cannot have the same name (since the name is used as the file name).We should be able to relax this.If a configuration isn't shared, the name has to be unique because we store the configs in files in the same location (the metadata area).For shared configs, we can get more complex. So long as the file location isn't the same, the names can be the same. But we need to make sure that when the user changes a shared config's location that we re-verify that there's no name collision.sounds like an implementation detail that surfaces as nuisance for usersDeferred, post 3.0. Too late for this change. As well, it creates problems in the LCD when configs have the same name (i.e. the tree needs to render more info to be able to distinguish them).Consider for 3.1Deferred***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***CreatedpatchThis is a work in progress that allows configs to have the same name if stored in different locations. It enhances the way "local" configs are stored. Rather than storing them all in one directory in the metadata, a directory structure is created based on the resource that a configruation is stored with. It effectively gives configurations a namespace based on their resource mapping. So, two configs can have the same name if the're not associated with the same "container" resource.It does not add UI support to distingusish between configs with the same name.What if launch configuration is not associated with any resource? Or what if it's associated with multiple resources?P.S. Sorry, I didn't have time to look at the patch itself.No resource == default package (i.e. all configs that have no resource association share the same namespace).Multiple resoruces == use the first resource (not sure what the rule should be here - probably should use the "deepest" resource in the association, but if it's cross project resources, then not sure what to do).As of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.***has been marked as a duplicate of this bug. ***As requested by Denis Roy (see comment above), I would like to have this bug reopened, because it seems as if the patch has never been applied or is not functioning.The issue still exists in Version: Indigo Service Release 1 Build id: 20110916-0149Because this is an enhancement request, I would like to suggest an related enhancement which allows the use of a global external tool launcher by a logical reference (no file system soft link) instead of copying it to the project folder. (It could be another option besides creating a new builder or importing a global one). I think this is the actual reason why most people would like to have the same name for a builder in multiple projects. It would even allow to migrate the same project on different platforms without changing the external tool builder launcher each time you switch between them (consider for example different OSs or different tools doing the same thing). This would come in very handy e.g. for teams working on a common source code repository which contains the project configuration as well.(In reply to)Could you create a separate bug for the additional request?Latter enhancement request moved into seperate enhancement request (Bug: 400126).Is this really such a toughie?CreatedtestprojectsThis is still a problem with Mars, exactly as described in.The limitation seems totally artificial since the following workaround works:Project1 > Properties > Builders, New, "testbuilder", SaveProject2 > Properties > Builders, New, "testbuilder" --> Error: A 'Program' configuration with that name already exists.After CLOSING Project1 the "testbuilder" can be added and seems to work OK.Also, when IMPORTING attached projects, the builders seem to work OK.Can the team confirm that this workaround is acceptable ?And could the odd UI limitation be finally lifted?CQ:WIND00-WB3-51391Going through the patch from, I think we are stuck for multiple resources scenario	25.0
id=250306	REOPENED	Platform	Debug	3.4	PC Windows XP	P3 normal	Platform-Debug-Inbox	2008-10-09 11:33 EDT by	Dan Heidinga	2016-05-05 05:52 EDT (	2 users	Build ID: I20080617-2000Steps To Reproduce:1. Paste multiple lines into the IOConsole.2. Clear the console.3. Paste the multiple lines in again.More information:After the IndexOutOfBoundsException, moving the mouse into the console will also cause multiple IllegalArgumentExceptions from org.eclipse.swt.custom.StyledText.setCaretOffset(StyledText.java:6867).It appears the partition we are looking for in the partitions ArrayList no longer exists. We then try to insert at position -1.Stacktrace:java.lang.IndexOutOfBoundsException at java.util.ArrayList.add(Unknown Source) at org.eclipse.ui.internal.console.IOConsolePartitioner.documentChanged2(IOConsolePartitioner.java:413) at org.eclipse.jface.text.AbstractDocument.updateDocumentStructures(AbstractDocument.java:672) at org.eclipse.jface.text.AbstractDocument.fireDocumentChanged(AbstractDocument.java:759) at org.eclipse.jface.text.AbstractDocument.replace(AbstractDocument.java:1157) at org.eclipse.jface.text.AbstractDocument.replace(AbstractDocument.java:1176) at org.eclipse.ui.internal.console.ConsoleDocument.replace(ConsoleDocument.java:82) at org.eclipse.ui.internal.console.ConsoleDocumentAdapter.replaceTextRange(ConsoleDocumentAdapter.java:258) at org.eclipse.swt.custom.StyledText.modifyContent(StyledText.java:5876) at org.eclipse.swt.custom.StyledText.sendKeyEvent(StyledText.java:6631) at org.eclipse.swt.custom.StyledText.doContent(StyledText.java:2186) at org.eclipse.swt.custom.StyledText.handleKey(StyledText.java:5145) at org.eclipse.swt.custom.StyledText.handleKeyDown(StyledText.java:5170) at org.eclipse.swt.custom.StyledText$7.handleEvent(StyledText.java:4873) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1003) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1027) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1012) at org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:1040) at org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:1036) at org.eclipse.swt.widgets.Widget.wmChar(Widget.java:1352) at org.eclipse.swt.widgets.Control.WM_CHAR(Control.java:3894) at org.eclipse.swt.widgets.Canvas.WM_CHAR(Canvas.java:341) at org.eclipse.swt.widgets.Control.windowProc(Control.java:3787) at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:337) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4528) at org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method) at org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:2370) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3420) at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2382) at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2346) at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2198) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:493) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:288) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:488) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:113) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:193) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:382) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:45) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:612) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:549) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:504) at org.eclipse.equinox.launcher.Main.run(Main.java:1236) at org.eclipse.equinox.launcher.Main.main(Main.java:1212)	CreatedOne line fix for IOOBEThis checks if the index is -1 and then doesn't attempt to add the partition. Very basic testing seems to indicate that this corrects the problem. ie: I still see all the text I expect to see in the console.Another re-emergence of?See also #249878 which this may be a duplicate of.If this is still a problem, please reopen.Occuring many times as reported by error reporting tool.	4.0
id=393254	REOPENED	Platform	Debug	4.3	PC Windows 7	P3 normal	Platform-Debug-Inbox	2012-10-31 11:22 EDT by	Michael Rennie	2013-07-08 16:42 EDT (	2 users	FUP fromThere were IOCconsole test failures:testPatternMatchListener Failure Should be two foo's expected:<2> but was:<0>junit.framework.AssertionFailedError: Should be two foo's expected:<2> but was:<0>at org.eclipse.jdt.debug.tests.console.IOConsoleTests.testPatternMatchListener(IOConsoleTests.java:62)at org.eclipse.jdt.debug.tests.AbstractDebugTest.runBare(AbstractDebugTest.java:2342)at org.eclipse.jdt.debug.tests.DebugSuite$1.run(DebugSuite.java:55)at java.lang.Thread.run(Thread.java:637)	The IOConsoleTests always succeeded recently on all platforms. I would close this bug.(In reply to)Agreed, I just wanted to make a separate bug to be able to reopen in the event they fail again.Does not work for me, see	3.0
id=324093	REOPENED	Platform	Debug	4.0	PC Windows XP	P3 enhancement	Platform-Debug-Inbox	2010-08-31 10:07 EDT by	Patrick Chuong	2011-06-08 13:49 EDT (	1 user	Build Identifier: I20100608-0911Currently there is no API to control the enablement of the breakpoint actions/operations. For my debugger, it is not possible to change (enable/disable/skip) the breakpoint while the target is running. It would be nice to be able to control the breakpoint actions/operations. However, the API should also consider other debugger that might not be able to add/remove breakpoint.Modifing source file is a tricky one to tackle, changes might need to be cached until the target is capable to perform these operations.Reproducible: Always	This is a tough problem because for most debugger implementations any breakpoint can be installed on any number of debugger instances. So if one debugger instance disables it, it will reduce functionality for another.In our (Wind River) debugger we've solved the problem as following:- target enters state where bps can't be modified- user changes breakpoint state- debugger attempts breakpoint change, it fails - since the update breakpoint can't be installed on target, it's marked with an error- debugger re-reads breakpoints state from target to synchronize the IDE breakpoints- debugger adds an IDE breakpoint that corresponds to the target breakpoint in old stateThe end result is that if user tries to modify a breakpoint he ends up with an extra copy. It's neither simple nor intuitive, but at least it's correct. Fortunately the use case is rather rare.HOWEVER. For your use case you, you can simply throw a CoreException from within IBreakpoint.setEnabled(). I just gave it a try and it works, both in the editor and in BP view.Please reopen if you have something else in mind.After readingI see the use case: gray out the checkboxes in Breakpoints view.	2.0
id=404210	REOPENED	Platform	Debug	4.3	PC Windows 8	P3 normal	Platform-Debug-Inbox	2013-03-23 11:21 EDT by	Ed Willink	2014-12-01 06:08 EST (	2 users	On a Windows platform with Unix workspace preferences, Unix project preferences, Unix existing file content, editing a JDT launch config saves the file with Windows line endings. At least one of the three Unix settings should be used.IMHO it is the project setting that should apply.	*** This bug has been marked as a duplicate of***I am not able to reproduce this withEclipse SDKVersion: Mars (4.5)Build id: I20141029-2000can you confirm you are seeing it now also ?I have Workspace and project setting as Unix line delimiter.I modify a .launch file on Windows, On save I still see LF as line endings.Have I missed anything ?(In reply to Michael Rennie from)This is not a duplicate.concerns a line ending corruption when round-tripping through GIT.This bug makes no use of GIT; just edit and save.Are you able to reproduce it with Mars ?(In reply to Sarika Sinha from)Using 4.5M3.I have a default Workspace with Windows settings.I have a project with Unix line endings.I modify a launch configuration in the project/,settings and the line endings are corrupt.This seems to be a double bug.a) existing line endings should be respected.b) project settings should dominate workspace settings.CreatedDemo projectReiterating one of theissues:The attached trivial Hello World plugin project contains a launch configuration.Workspace: Windows out-of-the-box Windows defaults.Project: Unix line endingsFile: Unix line endingsEdit the .launch file by:Run Configurationsselect the HelloWorld Arguments tab and specify -ea as a VM argument. Run..launch file now has Windows line endings.Soa) the pre-existing file characteristics have been ignored.b) the project file characteristics have been ignored by a UI application that can easily be aware of them	6.0
id=453407	REOPENED	Platform	Debug	4.5	All All	P3 normal	Platform-Debug-Inbox	2014-11-27 07:16 EST by	EPP Error Reports	2014-12-12 04:29 EST (	4 users	The following error was reported via the automated error reporting: code: 0 plugin: org.eclipse.ui_3.107.0.v20141010-0853 message: Unhandled event loop exception fingerprint: 11c4ed00 exception class: java.lang.StringIndexOutOfBoundsException exception message: String index out of range: 22 number of children: 0 java.lang.StringIndexOutOfBoundsException: String index out of range: 22 at java.lang.AbstractStringBuilder.insert(null:-1) at java.lang.StringBuffer.insert(null:-1) at org.eclipse.ui.internal.console.IOConsolePartition.insert(IOConsolePartition.java:75) at org.eclipse.ui.internal.console.IOConsolePartitioner.documentChanged2(IOConsolePartitioner.java:394) at org.eclipse.jface.text.AbstractDocument.updateDocumentStructures(AbstractDocument.java:696) at org.eclipse.jface.text.AbstractDocument.fireDocumentChanged(AbstractDocument.java:793) at org.eclipse.jface.text.AbstractDocument.replace(AbstractDocument.java:1191) at org.eclipse.jface.text.AbstractDocument.replace(AbstractDocument.java:1210) at org.eclipse.ui.internal.console.ConsoleDocument.replace(ConsoleDocument.java:92) at org.eclipse.ui.internal.console.ConsoleDocumentAdapter.replaceTextRange(ConsoleDocumentAdapter.java:266) at org.eclipse.swt.custom.StyledText.modifyContent(StyledText.java:7286) at org.eclipse.swt.custom.StyledText.sendKeyEvent(StyledText.java:8137) at org.eclipse.swt.custom.StyledText.doContent(StyledText.java:2501) at org.eclipse.swt.custom.StyledText.handleKey(StyledText.java:5973) at org.eclipse.swt.custom.StyledText.handleKeyDown(StyledText.java:6004) at org.eclipse.swt.custom.StyledText$7.handleEvent(StyledText.java:5681) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4353) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1061) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1085) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1070) at org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:1112) at org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:1108) at org.eclipse.swt.widgets.Widget.wmChar(Widget.java:1529) at org.eclipse.swt.widgets.Control.WM_CHAR(Control.java:4746) at org.eclipse.swt.widgets.Canvas.WM_CHAR(Canvas.java:343) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4627) at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:339) at org.eclipse.swt.widgets.Display.windowProc(Display.java:5037) at org.eclipse.swt.internal.win32.OS.DispatchMessageW(OS.java:-2) at org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:2549) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3759) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1151) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1032) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:148) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:638) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:582) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:138) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:380) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:235) at sun.reflect.NativeMethodAccessorImpl.invoke0(null:-2) at sun.reflect.NativeMethodAccessorImpl.invoke(null:-1) at sun.reflect.DelegatingMethodAccessorImpl.invoke(null:-1) at java.lang.reflect.Method.invoke(null:-1) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:648) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:603) at org.eclipse.equinox.launcher.Main.run(Main.java:1465) General Information: reported-by: anonymous-id: 0fc19c81-9a6c-4900-bcb1-f3ea44e7c721 eclipse-build-id: 4.5.0.I20141029-2000 eclipse-product: org.eclipse.epp.package.committers.product operating system: WindowsXP 5.1.0 (x86) - win32 jre-version: 1.8.0_25-b18The following plug-ins were present on the execution stack (*): 1. org.eclipse.core.databinding.observable_1.4.1.v20140910-2107 2. org.eclipse.core.databinding_1.4.100.v20141002-1314 3. org.eclipse.core.runtime_3.10.0.v20140724-1132 4. org.eclipse.e4.ui.workbench_1.3.0.v20141024-2249 5. org.eclipse.e4.ui.workbench.swt_0.12.100.v20141020-2115 6. org.eclipse.equinox.app_1.3.200.v20130910-1609 7. org.eclipse.equinox.launcher_1.3.0.v20140415-2008 8. org.eclipse.jface.text_3.10.0.v20141027-1716 9. org.eclipse.jface_3.11.0.v20141013-0842 10. org.eclipse.swt_3.104.0.v20141029-1116 11. org.eclipse.ui_3.107.0.v20141010-0853 12. org.eclipse.ui.console_3.6.0.v20140812-1255 13. org.eclipse.ui.ide.application_1.0.600.v20141003-0522 14. org.eclipse.ui.ide_3.10.100.v20141024-1629Please note that:* Messages, stacktraces, and nested status objects may be shortened.* Bug fields like status, resolution, and whiteboard are sent back to reporters.* The list of present bundles and their respective versions was calculated by package naming heuristics. This may or may not reflect reality. Please visitfor further details. Thank you for your assistance.Your friendly error-reports-inbox.	I've looked up the (to date) top-3 most similar bug groups and listed the closest bug of each group below. This report may or may not be duplicate ofthose (low or similar scores for all entries may indicate that this hasn'tbeen reported yet):If this report actually is a duplicate of those, please mark it as such. Thisinformation helps me to improve the recommendations further for the next issue.Thank you for your assistance.Your friendly error-reports-inbox.***has been marked as a duplicate of this bug. ***Moving to platform team for review.This was due to a bad fix that has been reverted. See.Oops, spoke too fast.only went into I20141118-0800 and later, so it can't be in 4.5.0.I20141029-2000.There must be another way to produce similar exceptions.	5.0
id=37016	REOPENED	Platform	Doc	2.1	All Windows XP	P3 enhancement	Platform-Doc-Inbox	2003-04-28 14:19 EDT by	Daniel B.	2009-05-22 15:30 EDT (	1 user	In the Eclipse Help System documentation, the HTML pages do not have normalNext and Previous links.This makes it inconvenient to read through a series of sequential pages.Even if the last page in a group of sequential pages can't or can'teasily have a Next link to the first page in the next section, mostpages in the group can.	Closing. Unless we have a volunteer to add these links, it won't be happening. The tree view on the left hand side provides adequate navigation.I would agree with you, but we have done usability testing and end users do notfind the tree to be adequate.Every single user failed to navigate pages, most tried the next/prev buttons. Itcould be that the Eclipse project has a smarter class of users, but when usingthe online help in a RCP context we are less lucky.Try the following:1. Open up Welcome2. Select Over view3. Select Java developmentTry and explain why the "Basic tutorial" consists of one page.Reopening.***has been marked as a duplicate of this bug. ***	5.0
id=252515	REOPENED	Platform	Debug	3.5	All All	P3 major	Platform-Debug-Inbox	2008-10-28 19:06 EDT by	Pawel Piech	2013-09-16 11:21 EDT (	6 users	In 3.4 we significantly improved the saving and restoring of the expansion and selection state in the variables view. But I can still get this feature to fail with a 20-level deep test structure (in C). The view expands the first 15-levels automatically, but then stops for some reason. If I scroll the view down to where the selection used to be, the view keeps expanding the structure and finally selects the correct element.	We are also still seeing problems with expansion and selection in 3.4.1.I have seen problems with PDE and also in our own debuggers. Unfortunately, it is hard to come up with steps to reproduce consistently.Improved in 3.7. Will make specific test cases in future if needed.I also see this from time to time, in which case it's a pain.1. have JDT UI in source2. put a breakpoint into SemanticHighlightings.AutoboxHighlighting.isAutoUnBoxingExpression(Expression)3. launch a new workspace4. paste the following code into the Package Explorer:package snippet;import java.util.ArrayList;public class Snippet { void bug(ArrayList<Long> vals) { long tim = 12; long fred = 8; long john = 9; vals.add(tim + fred + john); }}5. enable semantic highlighting for Auto(un)boxed expressions==> breakpoint is hit in dev IDE6. select 'expression' in the Variables view (optionally also expand it)7. Resume==> selection lost (if not, just resume again)This is annoying. We should try to fix this for 4.4 or even 4.3.x.***has been marked as a duplicate of this bug. ***	6.0
id=459399	REOPENED	Platform	PMC	4.5	All All	P3 enhancement	Project Inbox	2015-02-08 22:44 EST by	Sergey Prigogin	2015-03-05 22:58 EST (	8 users	reflects some moment in the past when BREE 1.5 was considered the most appropriate. The static recommendations referring to specific JDK version numbers should be replaced by a time-based policy that would automatically move the recommended BREE forward as time passes.Each next Java version is superior to the previous one. As a general rule, using a newer version of Java makes Eclipse committers and contributors more productive and the code safer. On the other hand Eclipse platform has to support users who for a legitimate reason cannot upgrade to the latest JRE.defines dates of the end of public updates for different JDK versions. For overwhelming majority of Eclipse Platform users who do not have Oracle premium support, there is no legitimate reason to run an old JDK that is no longer receiving updates for security vulnerabilities. This means that Eclipse Platform doesn't need to support JDKs that no longer receive public updates from Oracle.should be modified to state that individual Eclipse projects are free to decide what BREE to use, but no project should be required to support JDK older than the one receiving public updates from Oracle, unless the project has specific reasons for that.	+1This is not just a website update.Our policy (Eclipse top-level project / PMC) is always to only update the BREE when really needed, e.g. a project wants to use new APIs or language constructs. We do not want or recommend mass updates to the latest, but as said, when a project has good arguments it can update the BREE. However, when increasing the BREE the project must ensure that no new warnings appear in the official build, e.g. due to raw types when switching form 1.4 to something higher.For anyone "skim reading", to cross-reference, seethat "gave rise" to this bug. That is, "the current policy" is a real and current issue, not something in the abstract. I personally like having a notion of "time" built-in to the policy (whether it's tied to other's versions of JVM or not is another issue?) That is, we want to encourage a certain "length of time of stability" on "common VMs" ... but, at the same time encourage updates and upgrades, as that seems important to the community, especially of contributors. I know the way things are, it is not even that easy to find a version of "Java 1.4" to download, and define to PDE's set of EEs, so that users get accurate content assist, and accurate warnings/errors for using methods that don't exist in Java 1.4. Dani mentioned one "criteria" (no new warnings appear in the official build) but one thing that's unclear to me, is how to specify "no or little impact to others" downstream -- or, even if that's possible. I know at one point, there was talk about moving JFace to use generics (I believe it was JFace) but there was a downstream out cry that was not a good thing, since it caused lots of "errors or warnings" in downstream projects, for little gain, in the case of JFace. I'm simply stating this as a "plea for education" :) if there is a good way to state "minimal impact to others" (or similar), that'd be good to know. As well as, if there is any "change to policy", it should also include "by a certain milestone" (obviously, by API freeze, M6, but wonder if should be even earlier?) ... combined with "notice to the community" so that others at least have a chance of expressing concern, and/or support. (Keeping in mind that we also want to stay "nimble" and encourage rapid improvements, when possible). Much appreciate the efforts to balance "keeping us stable" as well as "keeping us current" -- it's not easy! Can we make it easier?Thanks,(In reply to David Williams from)(In reply to David Williams from)It is not our job to force people to 1.6 or newer. If someone e.g. knows for sure he runs in a closed environment and his 1.5 JRE just works, then we should not break him, unless, as said, the project has a real need to do so. I know people that run older versions of IE for a good reason, and Windows silently let them do so.In case it wasn't clear from the, what is being proposed is a change of policy. The proposal is to change the statically defined BREE 1.5 golden standard by a dynamically defined one that is based on the latest Oracle JDK receiving public updates. If we decide to be really conservative, we can define the standard as the latest JDK receiving public updates minus one. What is important here is that the standard is going to move forward over time.The dynamic standard BREE makes sense because each new version of JDK brings new advantages that make Eclipse committers and contributors more productive and the code safer. Again, the final decision is up to individual projects.A static policy, on the other hand, is like a tax law not indexed for inflation. It may work for some period of time, but is bound to become a source of friction at some point. In case ofwe've already reached that point.(In reply to Dani Megert from)This example is flawed. You may be able to run IE6 if you have a Windows XP machine disconnected from the Internet. In every other case running IE6 is likely to make your organization another Anthem® Blue Cross or Target.(In reply to Dani Megert from)I guess that's the issue. What counts as "a real need". IMHO, some of "staying as is" would be less painful if we had "EE definitions" for some of the older VM's, such as 1.3, 1.4, and 1.5 (see). But ... even then ... is it "a real need" if committers/contributors wanted to use "enhanced for loops" (introduced in 1.5, I believe). Or, if they wanted to use Boolean.parseBoolean, (1.5) instead of Boolean.getBoolean? (1.4)The former, having the advantage of accepting "yes", "ok", as well as "true" as all meaning "true". I'm just asking! I can definitely see both sides of the issue. (Well, except we really should develop some EE definitions ... but not sure that's the reason the originator opened this bug.) I think originator wanted more the burden of proof turned around ... is there "a real need" to stay on older VMs.(In reply to David Williams from)E.g. the need (or say "wish") to use Generics, need to use new API like nio, new language constructs etc.We do have that safety net! :-) They are called 'API Tools Execution Environment Descriptions'. If those are installed, then API Tools will throw an error if you use APIs outside the defined BREE, even if you have a JRE 7 on the project. The following EEs are installed when you install the descriptions:JRE-1.1, J2SE-1.2, J2SE-1.3, J2SE-1.4, J2SE-1.5, JavaSE-1.6, JavaSE-1.7, JavaSE-1.8, CDC-1.0/Foundation-1.0, CDC-1.1/Foundation-1.1, OSGi/Minimum-1.0, OSGi/Minimum-1.1, OSGi/Minimum-1.2Sometimes yes. It depends from which version you change to what version. E.g. from 1.4 to 1.5 or even 1.6 is for almost all bundles a no-brainer. But if we talk about upgrading to JRE 8, it becomes difficult, since there aren't JREs for all architectures available yet.(In reply to Sergey Prigogin from)Yes, it definitely makes sense to change the JRE mentioned in4 Which Execution Environment should I use?From working a lot with new Eclipse contributors, I can add that contributing to a project is more interesting for contributors if it uses the latest API.Contributing to an OS project (in your unpaid time) is something you do because "it is cool". But programming with outdated / unsupported Java API is not "cool" at all.I would like to add that a common impression most software engineers get when they see non-generified code in 2015, is that the code is not being maintained. Insistence on compliance with very old JDKs they see as a sign of project stagnation.(In reply to David Williams from)Exactly. We want the presumption of moving forward not the presumption of standing still.As a practical step, could please somebody review and submit patches for- Update org.eclipse.equinox.common to use Java 1.6 and- Move all Platform Resources plugins to Java 1.6 BREE(In reply to Lars Vogel from)+ 1000 to this. At eclipse we can only learn from the amount of contributors LibreOffice managed to get just by letting them "modernize" the codebase.+1000I'm currently facing the stupid issue that I can't get error-free workspace because I have those nice projects below (and much more if looking on [1]) insisting to see 1.4 strictly compatible JRE:org.eclipse.core.filebuffersorg.eclipse.ltk.core.refactoringorg.eclipse.ltk.ui.refactoringorg.eclipse.core.expressions.testsorg.eclipse.core.expressionsI simply *physically* can't get any compatible 1.4 JRE on my 64 bit Fedora box - one can download the archived 1.4 Java versions from Oracle site but they can't even be extracted/installed and used on modern Linux boxes!!![1](In reply to Andrey Loskutov from)These fall into the platform.ui project, I'm fine with updating them as long as we do not create new warnings in the build. Can you open a new bug report for them?(In reply to Lars Vogel from)I think most of the controversial discussion is about the recommendation of upgrading an existing plug-in. For new plug-ins I think we should state that we recommend Java 1.7 at the moment. I think that this makes sense, as the platform itself moves to Java 1.7 and this version is the lowest one that is currently maintained by Oracle for the general public.(In reply to Lars Vogel from)My opinion on this is to recommend Java 1.6 as minimum BREE - reasoning for this is there is no working open source pre Java 1.6 JVM. GCJ, Kaffee, JamVM just can't be counted as such.(In reply to Alexander Kurtakov from)Why not Java 1.7?(In reply to Lars Vogel from)I make a strong difference between minimum and recommended. I can see why some people would want to keep working with older jvm versions but having this at the price of having strong requirement to closed source jvm is a bit too much.So to make my statement clear:* Recommended BREE - Java 1.7* Minimum BREE (if current maintainers have strong reasons for) - Java 1.6(In reply to Alexander Kurtakov from)I don't find a minimum BREE specified in the wiki. Can you point me to the place? For all: I edit the recommended section to recommend Java 1.7 for new plug-ins, AFAICS we call happily agree to that. Here is the new text, please adjust or revert, if you disagree with the change:now states:---------------As discussed above, you should seek to use the smallest EE which give you all the features you require. Practically speaking, when creating a new OSGi bundle J2SE-1.7 is a reasonable starting point. Given that this version is currently actively maintainend by Oracle (see Java support by Oracle and the pervasive use of generics in both the OSGi framework and other libraries, lower EE settings are only practical in very specialized applications. -----------------(In reply to Lars Vogel from)There is none yet.What I look for is "smallest EE (but not lower than J2SE-1.6 to ensure open source availability of such an environment)"(In reply to Alexander Kurtakov from)I think for new plug-ins BREEs this is a good recommendation. I suggest that you edit the wiki directly and wait if someone disagrees with that change.(In reply to Alexander Kurtakov from)I don't think that the notion of the lowest BREE would be productive. Without active project maintenance the lowest BREE rule would be automatically violated and the rules with a lot of de facto violations tend to loose people's respect.It is important to emphasize in the new policy that moving a project to a higher BREE does not require any special justification. A REFUSAL TO MOVE to a BREE corresponding to the oldest JRE receiving public updates does require specific reasons for keeping compatibility with older JREs.I think we're done here. The suggested starting BREE has been moved to 1.7 and the wiki explicitly says that the BREE should be chosen based on the needs of the bundle/project:The execution environment listed in the table is based on the needs of the bundle and the expected use scenarios for the bundle.This bug is about replacing a static policy linked to a specific JDK version by a dynamic one that automatically adjusts the baseline JDK version as the time passes. The change made so far, although positive, preserves the static policy by giving it a temporary face lift.(In reply to Sergey Prigogin from)I see your point. We will discuss it in our next PMC meeting.How about this:Practically speaking, when creating a new OSGi bundle choose a BREE for which there's an officially supported target environment for the Eclipse release that you code against.[1](In reply to Dani Megert from)The above sentence sounds pretty cryptic to me.I'd like to propose the following text for the first two paragraphs of the "Which Execution Environment should I use?" section:"As discussed above, you should seek to use the lowest EE, which receives public updates by Oracle (see Java support by Oracle) and gives you all the features you require. For example, as of March 2015 the recommended EE is 1.7 since it is the lowest one receiving public updates at this time. Lower EE settings are only practical in very specialized applications. If your particular bundle requires capabilities from a later EE, then specify a higher EE, but keep in mind this may limit adoption of your bundle for applications using an older Java runtime.Be prepared to move your EE forward on regular basis to avoid forcing your project contributors to use unsupported JDKs."The following section, "I have prerequisites that require version X to run, so shouldn't I require version X too?" also needs revision. Here is a proposed text:"It is not strictly required but is an advisable thing to do. For example, if your project uses 1.4 BREE and it depends on a project that uses 1.7 BREE, that project is prevented from using java.lang.Iterable in any of its public APIs until your and other dependent projects move to at least 1.5 BREE."(In reply to Sergey Prigogin from)We definitely won't stick this to a particular JRE provider. That's why want to refer to the target env. table.Nope. This does not belong here to that wiki.Nope. The required project can add APIs based on 1.7 at will, but if your project wants to use those new APIs then it will simply move to 1.7.(In reply to Dani Megert from)The link tois already in the document.Could you please provide rationale for this opinion.There seems to be a misunderstanding here. The proposed text change was intended to make situations like the one encountered inless likely.(In reply to Sergey Prigogin from)Yes, and that's not good, and was only recently added by Lars.We want to leave it up to the individual projects to decide, when and how fast they adopt new Java versions. There was never and there should never be a rule that requires a project to update their BREEs.(In reply to Dani Megert from)Since this bug wants to get rid of the frozen BREE, here's the dynamic link:(In reply to Dani Megert from)OK, the link to the project plan will work.We still need to address the BREE stagnation issue for existing projects by emphasizing advantages of moving BREE forward () and setting expectation that BREEs of existing plugins should be adjusted at least once a year unless there is an important reason not to do that.	32.0
id=160379	REOPENED	Platform	Releng	3.3	PC All	P3 enhancement	Platform-Releng-Inbox	2006-10-10 16:59 EDT by	Andrew Overholt	2006-10-12 13:12 EDT (	0 users	It would be nice if the SDK tests could be run against an unwritable SDK instance. This is how we run the tests as Linux distributions -- that is, a regular (non-root) user runs the tests and the results must be written somewhere where they have permissions. I will attach a patch that adds this option.	Createdworkspace patch to add datadir option to SDK testsThis patch adds a data-dir option for tests. I just realized that if this is going to be applied, we'll need to coordinate with all SDK plugins to make use of the data-dir option. How should I go about filing bugs against each .tests plugin? One for each or one giant one with a big workspace patch?Please note that in my patch I actually skirtedbut _manually_ taking the output of a command-line diff and inserting into the bug. Good times :) . I've verified that it still applies.Andrew, we already run the tests a a non-root user. This change isn't really a priority for us. I'm sorry, but we're not changing our tests to accomodate this.Createdpatch to make all plugins use the data-dir variableThis patch is against all of the SDK tests and makes each of them use ${data-dir}.(In reply to)Sorry, I should have been more clear. All of the SDK tests currently assume that they can write their output to the same location as where they are installed, ${eclipse-home}. This doesn't work for the case of testing an installed Eclipse instance where the user running the tests can't write to the installation directory (with tests also installed in the same way). This is the case with Linux distributions' packages.I can understand if it isn't a priority for you but it would *really* help Linux distributions who want to run the SDK tests on their Eclipse packages. I'm not requesting that you actually use the data-dir option but just that it's available for us to use. I'm of course willing to work on any issues that may arise.Either way, I wanted to get the patches out of my RPM and into bugzilla so others can make use of them.Thanks,AndrewSorry for the misunderstanding. I didn't realize that you didn't want us to implement it for our tests.	6.0
id=278683	REOPENED	Platform	Releng	4.0	PC Windows XP	P3 normal	Platform-Releng-Inbox	2009-06-01 17:19 EDT by	Carolyn MacLeod	2016-07-11 16:09 EDT (	4 users	Eclipse 3.5The AdvancedFixCopyrightAction version of the Copyright tool reports 100% complete progress very soon after it starts. There is in fact (for the org.eclipse.swt project) another 25 or more minutes remaining after this point.This problem should be addressed at the same time as.	I fixed the performance issue. Let's take a look at this progress bar business.Fixed. Daniel/David, would you guys be able to review the gerrit submission?----------------The progress bar was only moving for items that were selected by the user but it was not recursive for sub-items beneath a selection. So if one were to select two folders with a total of 10000 sub-items, the progress would jump from 0 -> 50% -> 100%I added a visitor that counts files. Now the progress bar moves on per-file basis. In terms of performance. I tested with large samples. Counting files generates a ~5% overhead. But I think considering the tool now runs through a million files in ~22 minutes, the benefit of having a progress bar outweighs the cost of the overhead. It would be great if someone could verify that it works well in their scenario. (Carolyn?)I just realized that I liked to a bug instead of the gerrit review. (wrong clipboard content).This is the correct link:Accepted Gerrit patchThis is still a problem using Releng Tools from 4.5 RC1.Test Case: Fix Copyrights on 'org.eclipse.jdt.ui' project. It jumps to above 70% very quickly, then slowly goes to 100% and then stays there while still doing lots of work for a long time.(In reply to Dani Megert from)It's been a long time since I worked on this, so details are a bit fuzzy. Also, I currently don't have time to work on this. However, from what I remember, the issue was that progress was shown only for selection. E.g if you select 5 items, it will jumping 20% increments.I added a method that would count the number of files in each selection and then give that file count to the progress bar object.Counting the objects it self took maybe 3-4% of the total operation time.To troubleshoot this, I would see if this occurs when you select a single project in the project view. Another point of interest is the file sizes. It processes small files faster than big once. So if a project has lots of small files at the beginning and lots of big once at the end, then there can be 'jump' at the beginning and a slow down at the end.I.e, a test case would be to create a single project with 5000-10000 identical files and see if progress is reported ok. If so, it's also possible that there is some limit somewhere. I.e, the progress bar updates itself on traversing files, that is the increment. If a single file takes too long to process, then it may not be the issue of the progress reporting but some performance issue.(In reply to Leo Ufimtsev from)That's what I did - fixed copyright for the selected project in.We should probably close this bug as wontfix as copyright tool will probably go out of use since the copyright header is no longer updated.	8.0
id=114546	REOPENED	Platform	Releng	3.2	PC Windows XP	P3 enhancement	Platform-Releng-Inbox	2005-11-01 10:42 EST by	Steven Wasleski	2010-06-02 16:07 EDT (	16 users	In order to accomplish two goals of the 3.2 release, the Eclipse Project documentation plugins need to be moved from the "code" features that currently include them to separate documentation features. The two goals are:1) Enable the update (via update manager) of documentation after the release independently from the "code" features.2) Enable the support (provision of documentation fixes via updates) of translation of the documentation after the 3.2 release date without having to wait until the first maintenance release.There needs to be at least one documentation feature for each subproject that included documentation (Platform, JDT, PDE). Ideally, there would be separate features for end user and ISV documentation since some downstream products only want the end user documentation and it is common industry practice to only translate end user documentation and not ISV documentation. In addition, the ISV documentation features should only be contained in the SDK packages on the download site and not the runtime packages.It was recommend that this enhancement request start in the Releng component since this is where feature / packaging changes are often implemented.	I have a few questions regarding your requirements:1)Would it be sufficient to create doc features that are only used for updatesite purposes? These features would not be included in the actual zips with therelease. The doc plugins would remain in the zips provided with the build, nonew doc features would be added. We cannot provide updates to ISV doc separatefrom the "code" because it contains javadoc and requires a full source tree togenerate. Or in other words, the new ISV doc plugin would not reflect the codein the the rest of the eclipse install.2) My understanding is that the time interval between the platform API freezeand the actual release date is sufficient for translations for the platform. NLtranslation packs are currently provided separately from the release. It's not arequirement to wait for a maintenance release to release the translations. However, translations are usually delivered after a maintenance release toincorporate all the bug fixes.CreatedProjects for the proposed featuresKim, this attachment contains 5 projects. One each for the proposed documentation features (not 6 since PDE does not have any ISV docs).With regard to, I think we should include these features in the release so that users will know that there may be separate doc updates. This will provide a good mechanism for improving the docs out of band of the releases. Also, I think we need them for the ISV docs because not all the content in the ISV docs is generated. Some of it is hand crafted. These new features can be incorporated into the existing download zip packages. There is no need to invent new downloads nor would we have to remove the doc plugins from the features that currently contain them. It is my understanding that overlapping features are supported by the update manager.As for the timing, the desire was to have the translations done at Platform/Callisto GM time. Given the last minute nature of doc updates, this was deemed not to be possible. The English will be done at that time and we do not want to hold up doc translation availability until the first fix pack, however, we do need a way to service the English documentation in support of the translation effort. That is why Kevin and I agree on this doc feature route.Note that most of the other Callisto projects had doc features in their previous releases and it has worked fine for them.I discussed this issue with Mcq, Jeff and SoniaThere are issues with versions and overlapping features.Sonia another approach. She suggested we move the existing doc plugins out of the existing features into a new doc feature for every plugin. Then we could nest these new doc features in the in the existing platform, pde and jdt features. However, this causes issues with versions. For instance, if we only upgraded the version of the platform.doc.isv feature, the org.eclipse.platform feature would still refer to the old version of the platform.doc.isv feature. Consequently, there would be red Xs in Help->Software Updates->Manage Configuration.So Sonia suggested the only way to overcome this would be to create a new top level doc feature that is on the same level as the sdk feature. This feature could be packaged with the Eclipse SDK on the downloads page. Otherwise, Help would not have any content. This separation would provide the future ability, if required, to decouple the doc content from the sdk download.So, we need a PMC decision if we should proceed with creating a top level doc feature, yes or no? If yes, I will proceed with the testing and implemention but it must before M5.I've been arguing that we should separate the doc from the sdk download for years, but Jeff reminded me that an "SDK" actually needs the doc. A better separation would be a "Java IDE" download with all the other pieces (i.e. doc + PDE) as an add on.Adding Jeff to the CC to get his comments on how to proceed.result of conf callIf required we will a build against the release build maps + updated doc plugin versions and rev the associated but existing features for release on an update site.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Jim, in one of our next Eclipse PMC calls we will reconsider the WONTFIX decision and let you know here.Thanks, Dani. Just to make sure it's captured here, there is a third goal to Jim's bug that wasn't captured in this original request:3) To allow Eclipse adopter products to decide whether or not to ship documentation with the product. (this will also allow adopter products to make docs an install option, or provide it on the web, etc.)The reason for this is that documentation is usually a relatively large part of the download & install. Just as an example, there is about 94Mb of docs in WTP & prereqs (about 36% of the ~260Mb plugins on disk).We can't simply remove the doc from the features that currently include them, since that would break existing clients who expect our feature contents to be stable. For example if a client upgrades org.eclipse.platform from 3.5 to 3.6 and this causes documentation to be deleted, they will be broken.We could support this by splitting org.eclipse.platform into two new features that would be included by org.eclipse.platform: org.eclipse.platform.doc and org.eclipse.platform.binary for example. That would allow a consumer to choose to consume only the binaries, or the binaries+doc.In general this approach of splitting features for each subset people want to consume is not scalable. In the extreme we end up with one feature per plug-in, and the feature concept loses all value as a grouping mechanism. There is another approach to this problem supported by p2. p2 allows filters to be added to a dependency, and that dependency will be traversed at install-time only if that filter is satisfied. For example documentation could have a filter such as (org.eclipse.exclude.doc=false), which would be satisfied by default for compatibility purposes, but would become unsatisfied if someone added the property "org.eclipse.exclude.doc=true" to their application's profile. Filters give more flexibility to slice and dice the platform in different ways without an explosion of features (say one client wants doc but not source, another wants doc+source, and another wants source but not doc, etc).(In reply to)Seems to me "docs" is a fundamental division and this fear of not scaling is a bit extreme in this case. Seems to me there should be some general model or architecture of what the right division or grouping of installable units should be ... and that to say "clients can do the slicing and dicing however they'd like" is a bit of a cop-out. It seems to me there are three obvious divisions (that we've argued about for years :) 'code', 'end-user docs', 'extender docs', and 'source'.(In reply to)Er, that's four ... I split docs into two types as I typed, thus strengthening your argument (ha ha). But, let's say someone wanted to advocate the P2 approach you mention ... that means the provider still has to "label" each bundle with appropriate properties, right? So we'd still need some model of what to label them with, right? Can you imagine a recommendation as a Planning Council for all projects to follow? Seems it'd be a possible solution for "source vs. no-source" installs. Also, be sure to cover the case where documentation-only is desired ... no code ... such as if someone wanted to "install" into an InfoCenter? How would they specify the installable and the property constraint then? (I have a feeling there's an obvious answer ... just not obvious to me). Much thanks.Yes, this would work just like the filters we have in feature.xml today such as os="win32". There would need to be consistent labelling of these attributes and their values. So it's more work for the provider to define these labels but less work for the consumer (who otherwise needs to dig through the features and figure out what is source, binary, doc, etc).I don't know how InfoCenters are installed today, but I suspect they don't use our features at all. However in theory if every bundle had an attribute on it (such as "doc", "binary", or "source"), you would be able to express that with filters too. (doc="true", binary="false", source="false" in this case).Jim and Tim, as John already said we cannot restructure the stuff at this point (at least not in the 3.x stream). Would John's approach work for you?Reopening because we are actively discussing the issue.I have openedin order to discuss feature reorganization in the context of e4.John's approach sounds like the correct solution, but since this is a new p2 feature I want to ensure our installer can make use of it first. Sent mail to our install team and cc'd Pascal to confirm.Although p2 already supports such filters, there would be some work required here to add authoring-time support. I'll start this discussion in PDE to see if this support can be added.The other limitation with install filters that Pascal pointed out is that they are global in scope. Thus this would result in an "all or nothing" solution where all documentation is installed or none. This might be the right answer in some cases but is somewhat limited.And another thing to consider is the behavior of the old update manager in the presence of such filters. It may break ppl using those features in a pure update manager world.I've confirmed that our installer doesn't currently support this type of filtering, but like PDE could be made to in time for the 3.6 release. I understand there are issues still to work out, but would like to proceed with this change.I like the idea of using 'code', 'end-user docs', 'extender docs', and 'source' as four "Eclipse standard" properties since it seems like any functional feature (such as "Java Editor", "XML Editor") could indeed have these 4 parts (in principle .. some might not literally). One thing I wanted to mention though, in case impacts this issue, is how does this intersect with feature patches? For example, could a patch still be made for exactly one plugin? (even if, for example, the original installed version had both "code" and "source" bundles ... would the patch have to include both types?***has been marked as a duplicate of this bug. ***Just to restate. There are 4 different properties optionally added to a bundle's manifest:'code', 'end-user docs', 'extender docs', and 'source'The p2 metadata generator will generate a <unit> <filter> expression for the bundle based on the property in the manifest.Will the ability to set the property in the profile be exposed through the p2 update ui?(In reply to)No, I was thinking of a filter on the feature that includes a given bundle. The dependency from the feature to the bundle would depend on the satisfaction of the filter property (as we do today with os/ws/arch filters). This is a bit more flexible because it delegates the decision about what is "user doc", etc, to the feature. It would also allow someone to explicitly install a particular piece of user doc even if the "install user doc" property wasn't set on the profile.makes more sense thenIn order to install the doc without "install user doc" property set in the profile, would the individual doc <unit>s for the bundles need to be <required> ?(In reply to)Yes. Essentially by default the features would require the doc bundle with a conditional requirement based on the presence of a profile property. Another feature could come along and make an simple (unconditional) dependency on a doc bundle, which would cause that doc bundle to be installed regardless of any properties set on the profile.I raisedto support specifying filters in the feature.xmlFeatures containing doc bundles can define arbitrary filters something like:(| (!(install.docs=*))(install.docs=any)(install.docs=isv))The above filter passes when the profile doesn't contain the install.docs property or has install.docs=any or install.docs=isv	29.0
id=287709	REOPENED	Platform	Releng	3.5	PC Mac OS X - Carbon (unsup.)	P3 normal	Platform-Releng-Inbox	2009-08-26 11:24 EDT by	Pascal Rapicault	2012-04-02 09:50 EDT (	3 users	Finding the failed tests in the result page can be really painful. In my case I have two tests among 1500. It would be good if they could be presented first, or have the good tests hidden.	CreatedStyle sheet only showing the errorsHere is a new style sheet that will produce a page where only the failed tests are reported.Createdpatch for org.eclipse.testThanks Pascal! I've released and tested the fix.Reopening as there are two issues with this fix:1. BUG: each failure/error is shown twice (see e.g.)2. missing info: often I need to know how long a test took. This is now gone.After fixingwe can keep the filtered look and add a link 'Show All' that allows us to see all the results again.If that's too complicated or takes too long to fix then please revert to the old behavior until we have a fix.The discussion is being tracked atClosing.I've reverted this patch for I20090929-0800.Reopening as this is now no longer fixed. Closedinstead.If fixing this bug alongis too expensive/complicated then I can also live with marking it as WONTFIX now that we can look at the results in the JUnit view and filter them there.	7.0
id=342997	REOPENED	Platform	Releng	3.7	PC Mac OS X - Carbon (unsup.)	P3 normal	Platform-Releng-Inbox	2011-04-15 12:25 EDT by	Thomas Watson	2013-04-29 18:27 EDT (	3 users	I have updated the equinox-incubator.map file with a new org.eclipse.equinox.region project and a org.eclipse.equinox.region.tests project.I would like to have the org.eclipse.equinox.region bundle show up as an equinox incubator bundle in the equinox build.The tests project depends on org.easymock 2.4.0 and org.aspectj.runtime version 1.6.7 both of which are included in the orbit.map file already. I'm not sure how much effort it would take to run the tests during the build, but it would be good to get the region bundle built in the near term.	CreatedpatchTom, the region bundle is added for the N20110419-2000 build. How do you want the tests to run if they aren't part of the SDK? What do they need to run?(In reply to)The tests require the following to be installedorg.eclipse.equinox.region (the implementation to test)org.eclipse.equinox.region.tests (the tests themselves)And the following two bundles from the orbit.map,1.6.7=p2IU,id=org.aspectj.runtime,version=1.6.7.20091231194938,repository=,2.4.0=p2IU,id=org.easymock,version=2.4.0.v20090202-0900,repository=Would that be difficult to setup for testing?There are two approaches to this1) Change the existing build to run tests for a single bundle. Right now, our tests run by installing the test bundles into the SDK.2)Create a new Hudson build that just builds Equinox incubator bundles and runs their tests. Advantage: faster build, faster test results.Thoughts?(Also, I couldn't get the php working on the test server for your test Equinox build Tom, I check it tonight on the real server. The php libaries seem to be different on the two machines and I'm not sure what is happening)(In reply to)I don't mind this approach because we have other bundles in the Equinox SDK (not in the Eclipse SDK) with tests that we would like to run. Perhaps we could install the equinox test bundles and set of equinox bundles (region, coordinator, metatype etc) to test in one pass?Not sure I like this because I am not only talking about testing incubator bundles.The N-Build seems to be generated correctly for the region bundle.Okay, thanks for the clarification Tom, I'm writing a patch so the Equinox incubator tests can be invoked separately.Moving to RC1 for the so I can complete the portion of the bug where the tests are run for the incubator bundle.Createdpreliminary patch to run tests for incubator bundlesKim, I am working on some performance tests for regions that would require org.eclipse.core.tests.harness and org.eclipse.test.performance to be installed. Do you know if these two bundles will be installed as part of the test run?Tom, they are available in the repo, I'll modify the patch to include them in director call that installs the required bundles. I didn't realize there would be performance tests. The performance tests are called separately from the JUnit tests.Createdupdated patchKim, is there anywhere we keep the source bundles for the inclubator bundles?No, not right now. These bundles are just included in a build time feature, their source bundles aren't generated at the moment.(In reply to)You probably can guess my next question is: Can we get the source bundles generated?Regarding, I openedfor this request.To clarify, the region bundle is in 3.7, just running the region tests is missing in the build.This is no longer valid. The region bundle is now part of the the Equinox SDK build.So you don't care about having the tests running?(In reply to)Actually I do care about that, sorry. I renamed the defect and reopened.I would like to see this happen in Kepler.Still want to add these to Kepler? :) I'm asking because as I looked into the fact that org.aspectj.runtime is not signed, one thing I did was unzip our actual tests to look for it (see what version we were including, etc.) and was surprised I didn't see it. I think to run these tests, we've have to "include" org.aspectj.runtime in one of the test features ... right? So it gets packaged up?Not important for Kepler at this late stage.	22.0
id=344821	REOPENED	Platform	Releng	3.7	PC Windows XP	P3 normal	Platform-Releng-Inbox	2011-05-05 05:46 EDT by	Tomasz Zarna	2016-12-14 04:13 EST (	3 users	Eclipse Releng Tools 3.4.0.v20100923-45-7w3121173AAdding a new copyright section where it's missing is great but filling it just with the today's date is not enough. If the first revision of a file has been created in 2005 and I'm running the tool in 2011, the section should say "2005, 2011" instead of just "2011".Maybe it's a matter of configuration, if so, the default should be changed.	All code is in git now.(In reply to Alexander Kurtakov from)Yep, but the code which creates the copyright is also used when running the tool on Git code.	2.0
id=363603	REOPENED	Platform	Releng	3.8	PC Windows XP	P3 normal	Platform-Releng-Inbox	2011-11-11 12:16 EST by	Kim Moir	2012-06-20 21:35 EDT (	5 users	See Andrew's blog for detailsThis should make the build faster as we will only have to replicate clone deltas instead of full repos.	I talked to Andrew and you should set a fetchCacheLocation for every type of build. (I,M,N) Apparently there is a bug in the EGit fetch factory that it doesn't switch to the correct branch sometimes if you are pulling multiple branches from the same repo.Okay I should have implemented this a long time ago.Some numbersWithout fetchCacheLocation (times from start of build, no signing)build source zips: 34 minutesbuild tests: 1h 4minutesFinish build: 2h 30minutes Some numbersWith fetchCacheLocation and git repos content primed(times from start of build, no signing)build source zips: 18 minutesbuild tests: 44 minutesFinish build: 1h 37minutes Total savings: 53 minutesWow. Thanks Andrew for implementing this feature in the fetch factory!I've implemented this for the integration and nightly builds. I can't do this for 3.7.2 yet since we are in the endgame and changes require PMC approval etc.Not sure ifis relevant. Was talking to Ian and he mentioned he had issues with the caching but this may just have been related to how he specified his branch.is the egit bug, it does a fetch but no merge(In reply to)Did the fetch factory already moved back to PDE?Gunnar, no the fetch factory hasn't moved to PDE. I don't think we have any committers to work on it.Andrew, from reading, it's not clear to me that this causes an issue for our builds. I've configured our build so there are directories for the Git cache for every stream (M, N, I) but these directories are reused when that build runs. You seem to suggest in that bug that a new directory be used for the cache for every build which seems to negate the advantage of having a cache in the first place.This seems to be working. Closing.This changed caused problems in. Thus I'm reverting it.upsetting 3.8 M6 target since this wasn't fixed in 3.8.	9.0
id=86848	REOPENED	Platform	Releng	3.3	Power PC Linux-GTK	P3 normal	Platform-Releng-Inbox	2005-02-28 11:30 EST by	Andrew Overholt	2010-04-15 18:07 EDT (	14 users	icon.xpm is distributed in the x86 and x86_64 directories (for Linux-GTK) butisn't copied over during build/install for other architectures such as ppc. Since build machinery exists for these platforms, it'd be cool if the icon couldalso get copied over to the same place.I'll attach a patch of what I've done in the mean time for our non-x86{,_64}builds (untested so far .. it's building now). I know it's a hack, so anyadvice is appreciated.Thanks,Andrew	Createdhacky patch to copy the icon over from x86Moving to SWT since we would need to include this file in other subdirectoriesin the platform-launcher project to fix.The icon.xpm is apparently useless on linux and should be removed.Other platforms like Solaris Sparc has 4 special icons (Eclipse.m.pm file etc).Andrew - do you have suggestions to be friendly with the linux desktop regarding the launcher icon? Otherwise we'll just remove the icon.xpm which does nothing at the moment.This is what we currently do during our RPM build:# rh/freedesktop.org iconsinstall -p -D -m0644 eclipse-48.gif \ /usr/share/icons/hicolor/48x48/apps/eclipse.pnginstall -p -D -m0644 eclipse-32.gif \ /usr/share/icons/hicolor/32x32/apps/eclipse.pnginstall -p -D -m0644 eclipse-16.gif \ /usr/share/icons/hicolor/16x16/apps/eclipse.pnginstall -d -m0755 /usr/share/pixmapsln -s ../icons/hicolor/48x48/apps/eclipse.png \ /usr/share/pixmapsPerhaps shipping icons in the same sizes in PNG format would work? I'm justgetting some opinions from some of the people more in the know with this andwill post more soon.Sorry for taking so long on this. I spoke with some people who work on GNOMEand they said that we should just ship PNGs. I'm in favour of removing icon.xpmand replacing it with icon.png (48x48).Please provide icons to the releng team.Created48x48 PNG of the Eclipse iconCreatedFreedesktop menu entry fileWhile we're at it, it would be cool if we could also include a freedesktop.orgmenu entry file for Eclipse. I've attached the one that JPackage.org, Fedoraand RH use.Moving back to SWT since the files should be placed in the appropriate locations in the platform-launcher project.Any news on this? It would be great to get this fixed before 3.2 final.Andrew, could you precisely tell where in an eclipse tree these icons should be installed?(In reply to)It looks like they're already included:As for the .desktop file, Ben remembers Billy saying something about it last week. Billy?The problem with .desktop files is that they require anabsolute path. Since we're not shipping an installer, it isa little awkward to provide a .desktop file since it willlook like something you can just use when in reality itmay require editing.Andrew, do you agree with that? Maybe you can try itout and verify?(In reply to)I agree. Thanks.Based on, I believe this can be closed.(In reply to)Actually,was about the .desktop file.Can we remove icon.xpm from the builds as per? I see that the PNG files are in the drops and that's all that is used for Linux-GTK.Could the request inbe fixed for 3.3M5? Thanks.Ping :) Any chance somebody can deal with this? Thanks, BenCreatedpatchto remove icon.xpm from linux buildsFixed in builds >= N20080116-0010.Bogdan, this is the bug I mentioned on Friday.***has been marked as a duplicate of this bug. ***So, the PNG file's were not put in? Even if not automatically associated, I always "manually" associate these icons with what ever launcher I create on Linux, so seems useful to me.I suggest to reopen this bug.Obviously, the .xpm file has been removed. But no .png files have been added. In other words, there is currently no possibility to add an Eclipse icon for a custom launcher on Linux.Andrew, would you consider adding the icon.png in the second attachment to the linux directories in the org.eclipse.equinox.executable project (same directories as icon.xpm). I would then update the builder to include them.Confirm that this is still a problem with Ganymede build for both x86_64 and i386 Linux.I'm not sure why this bug is marked fixed when there's still no icon provided as noted by other notes on this bug?reopening***has been marked as a duplicate of this bug. ***Is this blocking on me? A 48x48 PNG of the icon is attached:Is there more I can do, Kim?***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***	32.0
id=407130	REOPENED	Platform	Releng	4.3	PC Linux	P3 enhancement	Platform-Releng-Inbox	2013-05-02 20:57 EDT by	David Williams	2016-08-11 15:25 EDT (	1 user	In eclipse.platform.releng.tychoeclipsebuilderthere is a directory named 'repos'that contains 4 files: build.xmlbuildAll.xmlplatformrepo.xmlrcprepo.xmlAs far as I can tell (from many searches) these are not used, and should be removed to avoid confusion.	Will try a quick test build, just to confirm.Ok, the are used in gather-parts scripts. buildALl is called from there, which calls the others. Should give better names, so more unique, so can finded with search. Also, should move into the /eclipse.platform.releng.aggregator/eclipse.platform.releng.tychoeclipsebuilder/eclipse/buildScriptswhere similar production scripts are.The more I look at these, the more I wonder if they should be ... Or, if they are "repeating" work that Tycho/Maven is already doing. (or, could do). As a small example, in, I wondered why pack.gz files were removed from some repos, but not other. But likely due to these scripts, such as in rcprepo.xml clearly has <p2.remove.iu> <repository location="file://${featureTemp}" /> <iu query="" artifacts="(format=packed)" /> </p2.remove.iu>But, many others don't. So, something is off, here. Not sure if merely inconsistent, or, if plain wrong.I suspect its too late to do all the work required to get rid of the need for these files ... though, that is a future goal. But, still considering move and rename so it makes more sense when trying to decipher our production scripts.There's also an odd 'extras' directory that should be moved, so we have all our "production scripts" in one place. And perhaps where they are are now, under tychoeclipsebuild in a folder named 'eclipse' (and similar in 'equinox') should be renamed to "eclipseScripts" and "equinoxScripts". So ... deferring this "big cleanup" to Luna.Doing a mass "reset to default assignee" of 52 bugs to help make clear it will (very likely) not be me working on things I had previously planned to work on. I hope this will help prevent the bugs from "getting lost" in other people's queries. Feel free to "take" a bug if appropriate.	6.0
id=424136	REOPENED	Platform	Releng	4.4	All All	P3 enhancement	Platform-Releng-Inbox	2013-12-16 10:32 EST by	Mickael Istria	2016-01-30 13:02 EST (	3 users	It seems to me that since Tycho is mainly aimed at making it easier for contributors to build and test stuff locally, it makes sense that the default maven execution "mvn clean verify" does exactly what contributors need.In such case, I'd like to suggest that the "build-individual-bundles" profile should be activeByDefault. Indeed, when working on a single bundle or single component, just like contributors do, this profile is mandatory to resolve dependencies to other Platform components.If this get activeByDefault, it can be easily disabled in "Build All" cases, by using command-line "mvn clean verify -P!build-individual-bundles" which will skip the eclipse.p2.repo repository definition and will try to resolve Platform dependencies from inside the reactor.	Thanh said:"""+1In my own use case I almost always build with -Pbuild-individual-bundles enabled and rarely need it disabled. So I think from this perspective having it active by default makes more sense."""David (Williams) said:"""I don't like the idea. I think building an individual bundle comes with a ton of assumptions ... which experts know about ... but experts can also write a little script to invoke how ever they'd like to do "most often" if you are trying to save yourself key strokes ... but I think non-experts should get the standard behavior until they learn enough about what the assumptions and shortcomings are (by which point they could write a their own script or alias). The "real" problem is we still have a monolithic, dirty-tree build, and think solving that is the only valid "build less" solution.But I don't want discussion to stop just based on my opinion, so if important to you ... open a bug and I'll be glad to read about pros and cons. But would not want to make a snap decision"""(In reply to Mickael Istria from)I also agree with David regarding the shortcomings. I guess since I understand the risk of using build-individual-bundles and when it doesn't work.(In reply to Mickael Istria from)I think we agree on that, let's not care about experts, they're good enough to deal with it and let's focus on non-experts (those who are contributing code but don't get much of how to build).I disagree, and it is based on my experiments with providing Gerrit votes for components contributions. Most components can be built independently with "mvn clean verify -Pbuild-individual-bundles", it's actually not monolithic at all, it's easy to run this command-line from almost any place of the working tree and end-up with some modules built.What makes the build appear monolithic is that it ends with a single site for dependencies, whereas we could expect each component to provide its own repo.I believe developers will never want to build the whole Platform locally, and focus on their module. So IMO, build should focus on helping them first, and focus on modular build 1st.Big build should be optional, for experts only.Ran across this "old" bug while searching for another, and think best to close as "won't fix". My views on the "correctness" of it have not changed. Plus, if a user uses the "build-individual-bundles" profile, they still have to specify the pom to build on the command line, right? So doesn't seem that much harder to specify the profile. I have been reading about the maven-properties-plugin lately, though, and there might be other reasons for using that, so -- if we do -- one possible solution might be to have some "pre-canned" property files to help users do both (specify the profile, and the repository to build), among other things? If you think that approach would work, please open a new bug suggesting that, with ideally a working example. Thank you for opening this for discussion.Seefor "the other reason" to use property files that I mentioned in.Actually, I think we can leave this open, with a changed title, and depend on. I think the changed title satisfies the intent of "making it default" but, not make it the default, per se -- must make it easier to invoke. This will depend on the investigations of using "property files" to satisfy the diverse needs of our builds. I am not positive that will work for things like "profiles" ... but, seems like it should!	7.0
id=407588	REOPENED	Platform	Releng	4.3	PC Linux	P3 normal	Platform-Releng-Inbox	2013-05-08 16:05 EDT by	David Williams	2016-08-11 15:24 EDT (	12 users	As a "post-build" step, I mirror our Tycho/CBI produced repo to our final published repo ... mostly as a sanity check, rather than simply "copy" the final repo from CBI. It shows some problems ... such as seeThis might be related to incomplete fix in?= = = = = p2.mirror - Wed May 08 14:50:17 EDT 2013 Problems resolving provisioning plan. Unable to satisfy dependency from toolingorg.eclipse.sdk.ide.application 4.3.0.I20130508-1200 to toolingorg.eclipse.sdk.ide.executable.cocoa.macosx.x86-bundled [4.3.0.I20130508-1200]. Unable to satisfy dependency from toolingorg.eclipse.sdk.ide.application 4.3.0.I20130508-1200 to toolingorg.eclipse.sdk.ide.executable.cocoa.macosx.x86_64-bundled [4.3.0.I20130508-1200]. Unable to satisfy dependency from toolingorg.eclipse.platform.ide.application 4.3.0.I20130508-1200 to toolingorg.eclipse.platform.ide.executable.cocoa.macosx.x86-bundled [4.3.0.I20130508-1200]. Unable to satisfy dependency from toolingorg.eclipse.platform.ide.application 4.3.0.I20130508-1200 to toolingorg.eclipse.platform.ide.executable.cocoa.macosx.x86_64-bundled [4.3.0.I20130508-1200]. Unable to satisfy dependency from toolingorg.eclipse.rcp.id.application 4.3.0.I20130508-1200 to toolingorg.eclipse.rcp.id.executable.cocoa.macosx.x86_64-bundled [4.3.0.I20130508-1200]. Unable to satisfy dependency from toolingorg.eclipse.rcp.id.application 4.3.0.I20130508-1200 to toolingorg.eclipse.rcp.id.executable.cocoa.macosx.x86-bundled [4.3.0.I20130508-1200]. Unable to satisfy dependency from toolingorg.eclipse.platform.sdk.application 4.3.0.I20130508-1200 to toolingorg.eclipse.platform.sdk.executable.cocoa.macosx.x86-bundled [4.3.0.I20130508-1200]. Unable to satisfy dependency from toolingorg.eclipse.platform.sdk.application 4.3.0.I20130508-1200 to toolingorg.eclipse.platform.sdk.executable.cocoa.macosx.x86_64-bundled [4.3.0.I20130508-1200]. Unable to satisfy dependency from toolingorg.eclipse.rcp.sdk.id.application 4.3.0.I20130508-1200 to toolingorg.eclipse.rcp.sdk.id.executable.cocoa.macosx.x86-bundled [4.3.0.I20130508-1200]. Unable to satisfy dependency from toolingorg.eclipse.rcp.sdk.id.application 4.3.0.I20130508-1200 to toolingorg.eclipse.rcp.sdk.id.executable.cocoa.macosx.x86_64-bundled [4.3.0.I20130508-1200].	I get a similar error when I use the org.eclipse.platform.sdk as a build dependency in a target platform file and using Tycho to build my plug-ins.I do not get the error when I use a juno p2 repository. But I do get the error in a p2 kepler repository.When is it fixed? The public repository of Kepler is damaged (for version M7).I'm assuming we can configure this profile just once, in our parent pom, an will apply everywhere we need it too. Such asPaul, does this sound right to you? (please review). Thanh, or Jan, can you confirm this is in the 0.18.0-SNAPSHOT we are using?(In reply to)yes configuring globally in the parent pom should do it.yes the fix is inwhich I believe you consume tycho 0.18.0-SNAPSHOT fromFixed as promised in I20130515-2000 ... confirmed by looking at our "mirror log" from a post-build task:Thanks Jan!I'm beginning to wonder if I was supposed to say <macosx-bundled>false</macosx-bundled>(instead of 'true')In the profile setting? Do we want those "IUs"? Or not?This change was reverted, due to bug. Will revisit to see what issue root issue is and/or if things we should do to simply ommit the macosxx-bundled IUs from our repos. (Though, that could effect downstream consumers, who have somehow figured out hwo to use them).From:Contrary to what I said on IRC, we do mirror some repos, some using maven, some using p2.mirror/ant and while this LAST mirror operation that caused me to open this bug does not have any filters, some of the earlier ones do. In one spot, we do this during "prepare-package" phase.In other spots, during "package", but some filters specified: <followStrictOnly>true</followStrictOnly><includeOptional>false</includeOptional><includeNonGreedy>false</includeNonGreedy><latestVersionOnly>true</latestVersionOnly>In preparing "slices" of repo, we use ant tasks, with p2.mirror tasks as we used to in PDE: using platformFilter=trueIn another spot, I found we do "slice" more specifically:So I'm left with a few questions: A. If we wanted the "macosx-bundled" IUs, how/where do we specify that in these type of mirror calls? B. Do we want "macosx-bundled" IUs in our platform repository at all? C. If we do what them at all, I think we'd definitely want BOTH types, so the filter would be "macosx-bundled=*"? D. If we wanted both, I'm assuming the configuration data would be + <configuration>+ <profileProperties>+ <macosx-bundled>*</macosx-bundled>+ </profileProperties>+ </configuration>E. If we do not want the at all, I'm assuming we'd tell Tycho+ <configuration>+ <profileProperties>+ <macosx-bundled>false</macosx-bundled>+ </profileProperties>+ </configuration>I'm dong a local test build for this latter case and see if we can get rid of the whole thing, since a) seems undocumented; b) we have not provided before, to my knowledge.(In reply to)From Pascal's comments in, I can answer some of my own questions. No, we don't want macosx-bundled in Kepler (for the Platform ... other projects might). It is pretty much "one or the other" ... with "how to update from one to the other" still not known. The only valid value (now) for the Tycho profile is "true" ... so doesn't help us to try 'false' or '*' ... I tried, and failed, which matches what Pascal later wrote in. So, my main remaining question is how these "phantom dependencies" get generated in the first place, and if there is any easy/safe way to get rid of them. I did confirm they are are only "warnings" in the p2.mirror task ... that is, the task succeeds the same if "ignoreErrors" is set either true or false. So ... not a blocker ... but ... I think very confusing to users (builders/release engineers) since it makes it look like something is wrong with the repository, when it fact there is nothing wrong with it (except for the phantom dependencies).(In reply to)I see I pasted wrong bug number ... I should have said.Marking for SR1 for the simple reason to investigate further. I am still not sure if this is "our" problem, or an artifact of "the builder" ... but unlikely we'll take any action, even in SR1, unless there are lots of community complaints or confusion over the warning messages.Still no time to investigate ... though I think everyone has learned to work around the issue (plus, I don't know if it's "useful" to anyone?)untargetting since unclear if this is a true bug ... and/or if removing the "mac-bundled" filter would "interfere" with others wanting to use the more traditional packaging for Mac Apps.(In reply to David Williams from)Actually to be compatible in update scenarios a repository needs both IUs, the bundled and traditional ones. I managed to get this working the other way by setting the macosx-bundled filter property and then adding the other IU back in a subsequent mirror step. A bad hack still.So, Tycho would need to preserve the IUs, i.e. by ignoring the property during mirroring.(In reply to Jan Sievers fromof)Pascal, can you answer Jan's question?***has been marked as a duplicate of this bug. ***Doing a mass "reset to default assignee" of 52 bugs to help make clear it will (very likely) not be me working on things I had previously planned to work on. I hope this will help prevent the bugs from "getting lost" in other people's queries. Feel free to "take" a bug if appropriate.	17.0
id=438116	REOPENED	Platform	Releng	4.4	All All	P3 normal	Platform-Releng-Inbox	2014-06-25 02:17 EDT by	David Williams	2016-08-11 15:25 EDT (	1 user	I have a vague memory that when we turned on "M6 freeze reports" last release, that Markus (I think) commented he thought we should have "comparisons" always done ... it's just the reference would be "previous release", instead of M6. I recall being surprised that was not already happening, so this bug is just to track what's needed to make that happen. The place in the build where this is controlled is around this location:To get the build to work (at all), I'm guessing it would fail since "M6" no longer exists ... I will first "comment out" the M6-freeze variables ... but, glad to work with others, get advice, or eventually just "trail and error" experiment to see what would (still) produce the reports.	Markus, I think it was you that made this comment ... and I'm sure you "know more about it" than I do ... so if there are some obvious settings we should be using, let me know. But, if it something that takes some investigation or experimentation, I'll be glad to do that over the weeks ahead.Markus, as far as I know, this is working. Can you confirm the current reports are what you were talking about? Such as underSeeandIf not, please reopen, un-target, and explain, Thanks,The links you listed are interesting, but they just show usage problems and new deprecations.This bug is about API change reports that list all API changes since the previous release. I just did this locally on org.eclipse.jdt.core and found. That's a good example to show why such reports are interesting up to M6 as well.After enabling the "freeze" reports against the final 4.4 release, I guess the download page also needs some wording fixes, since the pre-M6 API changes are not "illegal changes after the freeze", but "API news since the last release".Doing a mass "reset to default assignee" of 52 bugs to help make clear it will (very likely) not be me working on things I had previously planned to work on. I hope this will help prevent the bugs from "getting lost" in other people's queries. Feel free to "take" a bug if appropriate.	4.0
id=461748	REOPENED	Platform	Releng	4.5	PC Linux	P3 normal	Platform-Releng-Inbox	2015-03-09 13:51 EDT by	David Williams	2016-08-11 15:25 EDT (	1 user	Now that the Eclipse Foundation certificate has changed, it might be a good idea to turn "on" full signing checking at runtime at least for an I-build or two leading up to M6? Seeand what lead up to that comment. See also. Here's "how to" info I see in Help: = = = = = Since 3.4, the Equinox runtime has had the ability to check the signature of code as it is loaded. The benefit to this feature beyond checking signatures during provisioning is the ability to dynamically remove trust and disable code should an exploit be exposed in deployed code. In order to enable signature-based authorization at load time, the following VM argument must be passed:-Dosgi.signedcontent.support=authorityosgi.signedcontent.supportA comma separated list of options for signed content support. The valid types are the following:- certificate - enables parsing and verification of certificates.- trust - enables verification of certificate trust. This option implies "certificate".- runtime - enables verification of signed bundle content at runtime. This option implies "certificate".- authority - enables the default authorization engine. This option implies "certificate" and "trust"..- all - same as "certificate,trust,runtime,authority".= = = = = We just need to be sure not to turn on during "N-builds" (since not signed) and to also not turned on during performance tests (well, ideally we might, but probably not that important, and would "invalidate" comparing those builds, to others).	Is there a way you would do this globally for all the tests? Note that this will not catch cases like. It will only catch cases where we have fragments that contribute to the same package as their host. I know there is a extension registry compatibility fragment that does this, but I am not sure there are other examples within Equinox and/or Platform.At any rate, if you want to enable this then you will need to enable the 'certificate' check:osgi.signedcontent.support=certificateThat forces the signing certificates to be used while defining classes with the bundle class loaders.This effects performance it two ways:1) The initial parsing of the certificates is expensive for large numbers of bundles, but this is cached so subsequent startups should not be as bad, but still takes time to load the certificates. If the 'same' certificate is used for many bundles then we do share the same data, on disk as well as in memory when loading from a cache.2) The amount of memory slightly increases because we must load the certificates into memory. But when loading from a cached state we do share the same certificate objects if the are the 'same'.Runtime verification of the signed content is still not done. This is the check that ensures bytes for a class have not be tampered with since signing the jar. Enabling the 'runtime' option would have additional verification cost at runtime.(In reply to Thomas Watson from)I have added -Dosgi.signedcontent.support=all globally to all the "Hudson jobs" that run our Unit tests. Assume "all" is ok? (even though not all implemented, and may not all be necessary?) The "technique" of adding it is a little different on Windows, so will need to verify, but each unit test summary has a little "properties link" at the very very bottom right hand corner, so we can see what properties are in effect, for each suite, each build. For Mac and Linux, which are each "shell scripts" that start things off, I've added to "ANT_OPTS" which (due to my efforts) get "passed through" each step of the several processes that get started and eventually passed to the VM (as -D args) that start each test. Windows is a more a direct invocation of Ant, and not sure I've changed it there, in a way that get's "passed through". Do we need need on each platform? Oh, yes, we would ... since be definition some fragments are windows specific. I'll need to think a bit more about how to do on Windows.Even on Windows, in the tests of the yesterday's I-build, I could see "osgi.signedcontent.support=all" ... so guess Windows masks those settings proper ANT_OPTS or similar. So, I think we are set here. A final reminder: this property is set in configuration of Hudson jobs, so it is easier to be very specific about "which jobs" applied to. That is, we don't turn 'on' for N-builds or performance tests.(In reply to Thomas Watson from)What about the filesystem fragments, or even swt fragments? Did you not name those because they are "DLLs" only? And do not contribute *packages*? I'm asking, since I was thinking to "hack up" a case that should "break", to confirm locally, that the parameter does indeed catch such cases. We also have an "org.eclipse.ant.optional.junit" fragment, which "contributes" to "org.apache.ant" host but I think it too does not have it's own classes, just "requires bundle" org.junit. Ah ... just saw "org.eclipse.jdt.compiler.apt" is a fragment that contributes to "o.e.jdt.core" ... maybe it'd work as a test case (a test case for the test case :) Thanks if any advice.I ended up removing this, because it was causing a lot of "security exceptions" errors on one workspace log, in a part of our test scripts that we don't even care about. (i.e. a 9 year old version of "basebulder" that we use for the sole purpose of "bootstrappiong" the Hudson tests (and, then the more recent "eclipse versions "take over"). The requirement for that old "basebuilder" is weak (we already have code to "install sdk and tools appropriate to platform" ... just a matter of fitting it together, and at that point, may turn this back on. Seeand. Some of the security exception observed imply the version of "basebuilder" in Git is "contaminated" ... most likely due to a "change in line endings" of "directory plugins".Doing a mass "reset to default assignee" of 52 bugs to help make clear it will (very likely) not be me working on things I had previously planned to work on. I hope this will help prevent the bugs from "getting lost" in other people's queries. Feel free to "take" a bug if appropriate.	6.0
id=420078	REOPENED	Platform	Releng	4.3	PC Linux	P3 normal	Platform-Releng-Inbox	2013-10-22 09:48 EDT by	Lars Vogel	2017-01-04 04:50 EST (	8 users	Tycho 0.19 added a check that makes the CBI build fail is the git repo is dirty after the build.The eclipse build create real dirt and needs some work to either move build output into .gitignored output folders or to add the output files to .gitignore.	There's already specific bugs open for these against each component, search eclipse bugs for subject "Dirty working tree".The issue you are hitting now, based on your post to CBI mailing list is actually a case of "over cleaning" :) See.Thanks David. Maybe a "Master Bug" which depends on all the component bugs for the dirty issue would be helpful?(In reply to Lars Vogel from)You are welcome to re-open this one and use for that purpose, if you'd like. (Be sure to include the fixed ones :) (which were not in my query above).Reopening the bug to track the detailed dirty bugs. David, adding &bug_status=RESOLVED and and &bug_status=CLOSED to your query did not show me more bugs.Is the assumption correct that after all these "dirt" bugs are fixed, the reset of the submodule via Git (see below) is not required anymore?git submodule foreach git clean -f -d -xgit submodule foreach git reset --hard HEADgit clean -f -d -xgit reset --hard HEAD(In reply to Lars Vogel from)In theory yes.Createdpost build clean status after I20131023-2000shows that all "about.mappings" are now no longer dirt (). (I'll periodically attach "git status" listings here, after one of our production builds ... but I'm not expecting this to be fixed "real quick" ... but we'll make progress!)Createdpost build clean status after I20131030-0800While not quite final build for M3 ... close enough to say this is the state of things at M3. Some progress made ... much still to go.(In reply to David Williams from)Thought I'd check today, after I20131126-0800 build, and there has been no change since last attachment.Looks like the "dirt" is produced by the builder by placing temp files into the root of bundles. In that case the builder should actually remove those files. The source providers can't and don't want to know what a certain build system puts into their source tree.If the builder is not capable deleting that temp stuff or use a temp directory outside the source tree, then it remains to clients to call git clean.Having said that, most of the "dirt" could be avoided by changing the packaging of those bundles to get rid of nested JARs.Createddirty repo after M5 build (I20140123-1600)I think there as been progress.Createdstatis of build tree after RC2This file shows things about the same as they were in previous check ... maybe progress during Mars?Createdresult of "git status" after I20150210-0800 buildI have attached a check of dirt in working tree, taken after today's "production I-build". Seems some improvement (though, I've lost track) and did notice there is a new one .. I've openedto track it.(In reply to David Williams from)Would you please share the state after latest I-build? I have my own builds and check against them but would rather have eclipse.org results for comparison too.Createddirt "report" after 20150224 I-build(In reply to Alexander Kurtakov from)Sure. I've added attachment. Does it match what you see? I "get" these by running, in the "build area" (under /shared/eclipse/builds/4I/gitCache/eclipse.platform.releng.aggregator) the following sort of commands: git status > ~/temp/dirt<date>.txtgit submodule foreach git status >> ~/temp/dirt<date>.txtIf you agree that is "the right way", I will make a "dirt report" part of every build. Eventually, we'd want a "releng tests" to make sure we don't regress.(In reply to David Williams from)Yes, it's exactly the same with mine.Having such a report would be nice. When you say releng test you mean only when we have all the dirt gone? Or one comparing against current status?(In reply to Alexander Kurtakov from)Either. I've not really thought it through, but for such tests, we often simply look at "file size" of the report to be sure it has not "grown". And then as improvements are made, we reduce the hard coded "checked file size".Did I ever document the "dirty report". Created every build. For example, for M6, the report is atTo navigate there, from DL page, there is a link to logs for the current buildand from that page, there is a link to Release engineering build logsand on that page, there is a link to dirtReport.txtThere is also a "releng test" that fails with "regression" if the file get's larger ... and every now and then, I'll have to change the constant in the test on what the "maximum file size" should be. Currently set as 37179 bytes.I also wanted to point out one solution to "cleaning" mentioned inand in gerrit atIn short, the idea being to do more "cleaning" from the pom ... less that ideal, I think ... but ... perhaps a tactical solution? (If anyone had time to work on it).All the "depends on" bugs show "fixed", but the "dirt report" shows we are not clean. Did we miss opening some initially? Or have things changed? Entering 'eclipse.jdt'Entering 'eclipse.jdt.core'?? org.eclipse.jdt.core/jdtCompilerAdapter.jarEntering 'eclipse.jdt.core.binaries'Entering 'eclipse.jdt.debug'?? org.eclipse.jdt.debug.tests/javadebugtests.jar?? org.eclipse.jdt.debug/jdi.jar?? org.eclipse.jdt.debug/jdimodel.jarEntering 'eclipse.jdt.ui'Entering 'eclipse.pde'Entering 'eclipse.pde.build'Entering 'eclipse.pde.ui'Entering 'eclipse.platform'Entering 'eclipse.platform.common'?? bundles/org.eclipse.jdt.doc.isv/index/?? bundles/org.eclipse.jdt.doc.user/index/?? bundles/org.eclipse.pde.doc.user/index/?? bundles/org.eclipse.platform.doc.isv/index/?? bundles/org.eclipse.platform.doc.isv/samples/org.eclipse.compare.examples.xml/?? bundles/org.eclipse.platform.doc.isv/samples/org.eclipse.compare.examples/?? bundles/org.eclipse.platform.doc.isv/samples/org.eclipse.swt.examples.launcher/?? bundles/org.eclipse.platform.doc.isv/samples/org.eclipse.swt.examples.ole.win32/?? bundles/org.eclipse.platform.doc.isv/samples/org.eclipse.swt.examples.views/?? bundles/org.eclipse.platform.doc.isv/samples/org.eclipse.swt.examples/?? bundles/org.eclipse.platform.doc.isv/samples/org.eclipse.team.examples.filesystem/?? bundles/org.eclipse.platform.doc.isv/samples/org.eclipse.ui.examples.fieldassist/?? bundles/org.eclipse.platform.doc.isv/samples/org.eclipse.ui.examples.javaeditor/?? bundles/org.eclipse.platform.doc.isv/samples/org.eclipse.ui.examples.multipageeditor/?? bundles/org.eclipse.platform.doc.isv/samples/org.eclipse.ui.examples.propertysheet/?? bundles/org.eclipse.platform.doc.isv/samples/org.eclipse.ui.examples.readmetool/?? bundles/org.eclipse.platform.doc.isv/samples/org.eclipse.ui.examples.undo/?? bundles/org.eclipse.platform.doc.user/index/Entering 'eclipse.platform.debug'Entering 'eclipse.platform.releng'Entering 'eclipse.platform.resources'Entering 'eclipse.platform.runtime'Entering 'eclipse.platform.swt'Entering 'eclipse.platform.swt.binaries'Entering 'eclipse.platform.team'Entering 'eclipse.platform.text'Entering 'eclipse.platform.ua'Entering 'eclipse.platform.ui'Entering 'eclipse.platform.ui.tools'Entering 'rt.equinox.binaries'Entering 'rt.equinox.bundles'Entering 'rt.equinox.framework'?? features/org.eclipse.equinox.executable.feature/bin/cocoa/macosx/x86_64/Eclipse.app/Contents/MacOS/?? features/org.eclipse.equinox.executable.feature/bin/gtk/?? features/org.eclipse.equinox.executable.feature/bin/win32/Entering 'rt.equinox.p2'(In reply to David Williams from)I'm not aware of any change.I've opened 3 new bugs (and attached possible patches for .gitignore files) for the "dirt" I saw in my broken build:- [releng] Dirty git status after build in eclipse.jdt.core- [releng] Dirty git status after build in eclipse.jdt.debug- [releng] Dirty git status after build in eclipse.platform.common***has been marked as a duplicate of this bug. ***	23.0
id=485646	REOPENED	Platform	Releng	4.3	All All	P3 enhancement	Platform-Releng-Inbox	2016-01-12 07:37 EST by	Lars Vogel	2016-04-17 14:24 EDT (	3 users	+++ This bug was initially created as a clone of+++p2 added support for xz-compressed metadata with Mars (see) and Tycho can create this directly (see). I suggest that we change our build to create the compressed meta-data directly. AFAIK the current process requires some shell scripts and if that is true, these can now be replaced via Tycho. David, please correct me, if the shell script assumption is incorrect.	This bug is not helpful since you do not mention what version of Tycho we would have to move to use that feature or when it is planned to be released. As it is, we are still on 23.1 and can not (easily) move to 24 until we no longer create dirty working tree during build.Since when is a bug invalid only because we cannot fix it now?FYI - The change is planned to be included in Tycho 0.25 and most likely turn on by default.(In reply to Lars Vogel from)Invalid means "invalid as written". I'm sorry I did not make that clear. It is a little like saying "we should adopt all good things that Tycho does in the future". That is, you are just stating something obvious that serves no constructive purpose. Please make it constructive.(In reply to David Williams from)I agree, sorry for leaving out critical information. Do we have a bug for the blocking move to Tycho 0.24 so that this bug can be marked as dependent on it?(In reply to Lars Vogel from)I've added the dependent bug. Thanks for the additional detail. As a note to self, assuming the option is the default, the action (if not title) of this bug is "remove post-build creation of xz compressed files when Tycho 25 is adopted".Even after moving to Tycho 0.25.0, we can not avoid our post-build processing of content.xml due to the reasons stated in. So, I will add the blockingto the list here. I also changed the title to reflect the real issue being covered here, since nothing special has to be done to "adopt Tycho's compression".	7.0
id=495750	REOPENED	Platform	Releng	4.6	PC Linux	P3 normal	Platform-Releng-Inbox	2016-06-08 15:59 EDT by	David Williams	2016-06-17 09:24 EDT (	0 users	In the past, when a cronjob would start our "bootstrap" build file, I set it up so all output was "tee'd" to another local file in addition to the logs put in "buildlogs". This was handy to have one big log to search through for certain types of errors. But, the file is several hundred megabytes large, and now, running on Hudson, it all goes to the Hudson console. I am pretty sure Hudson (and people's browsers!) will not handle that much data well. So, this bug is to remove that redirection. If anything, we should "write to console" at just a few strategic points to know what stage the build is at.	Actually, I see I have already done this, long ago. There is a file named mb4N_hudson.sh which is nearly identical to our cronjob version, mb4N.sh, but does not re-direct output. So, the output going to Hudson's log is only about 6 Megabytes.This is not quite right, after all. For at least two reasons. One reason the Hudson logs were realtively small is I had set our MVN_DEBUG variable to false (which later controls maven's -X paramter). We normally run with that variable as "true", and when I tried taht, my browser "froze up" after a while because so much ouput was being displayed to to it. The second reason, even with MVN_DEBUG set to false, it seems some very banel output comes to the Hudson console, that really should be being piped to its own "build log". For example, page after page of great detail about "cleaning the git repository". Seems a few lines of output (of the strategic steps) would be more appropriate, but still pipe the output somewhere to a file under "buildlogs" in case we needed to see the detail. Not sure why so much output was coming to the console when MVN_DEBUG set to true (or, technically, just commented out). Seems it should have been going to the "mvn build" output file?	2.0
id=483395	REOPENED	Platform	Releng	4.6	All All	P3 normal	Platform-Releng-Inbox	2015-12-01 11:46 EST by	Markus Keller	2016-12-16 04:27 EST (	5 users	From /eclipse.platform.releng.aggregator/eclipse-platform-parent/pom.xml:118 : <!-- Production bundles are produced by ignoring the compiler warnings specified by ${code.ignoredWarnings} (see further down). Good citizens don't override those default settings for their production bundles. --> <code.ignoredWarnings>-warn:-deprecation,unavoidableGenericProblems</code.ignoredWarnings>It's time to remove the global "unavoidableGenericProblems". Nowadays, good citizens should not have such problems any more. If they do, they should try to fix them or update their dependencies. To work on, they can add this to build.properties:javacWarnings..=-unavoidableGenericProblemsTrigger:In org.eclipse.ui.workbench.texteditor, the TemplatePreferencePage class had a warning due to. I added @SuppressWarnings("unchecked"), but this got flagged during the build as "Unnecessary".Early M5 would be a good time for this.	I have removed from parent pom.Seems to me we should also remove -deprecation from blanket suppression. Do we have that many? Just a suggestion -- i.e. our own code should not use what we have deprecated. It makes sense, though, that we'd not care so much about "test bundles" and could leave it there (... for now :) Suggest to open a new bug if -deprecation should be removed. Maybe I'll try it on some local builds to get an idea of how many there are.(In reply to David Williams from)One "finding" I've made doing local builds .... since -deprecation is the last option, if we set the value of the variable to "empty string", such as <code.ignoredWarnings></code.ignoredWarnings>Then we get a "null pointer exception" later the build. Not sure if there is an "innocent" value we could use ... such as an empty -warn:of if that has it's own meaning. In other words, this will be more complicated to do that I originally thought. :/Markus, are there plans for generifing org.eclipse.jdt.core.dom ? I'm just checking so I don't needlessly add ignores in swt if this is already in the works.(In reply to David Williams from)That would be a huge effort, and it's often not possible to fix, since we need to call deprecated code for compatibility reasons.Yeah, we definitely need to keep tests for deprecated APIs (forever ;).(In reply to David Williams from)That shouldn't happen, please file a bug for Tycho and include the stack trace. Tycho should just ignore empty arguments.I've reverted this change for the I-build, to avoid that other (more important) warnings go undetected:Components should checkand fix the warnings or make sure there are open bugs for APIs that need to be generified.(In reply to Alexander Kurtakov from)Eventually yes, see. But this is a bigger effort that will need some time.Since Tycho does not support javacWarnings..=-unavoidableGenericProblems in the build.properties, the solution for bundles that can't fix all warnings will be to add this at the top of their pom.xml: <properties> <code.ignoredWarnings>${code.ignoredWarningsUnavoidable}</code.ignoredWarnings> </properties>You should only start doing this tomorrow, after this property has been propagated to the aggregator that's being used for Gerrit builds.(In reply to Markus Keller from)I disagree with adding a variable for this specific case or any non-standard combination of warnings to suppress. The parent pom should have exactly one standard "ignore warnings" properties.If individual properties want to override it, they can/should. They can either override the whole thing or, if they want, they can combine their exception with the standard, such as <code.ignoredWarnings>${code.ignoredWarnings},-unavoidableGenericProblems</code.ignoredWarnings>I am fairly sure this form will work. If not, then they should override the whole thing: <code.ignoredWarnings>-warn:-deprecation,unavoidableGenericProblems</code.ignoredWarnings>The advantage of a special variable in the parent POM is that you can easily switch this to code.ignoredWarnings and run a build to see who really still depends on un-generified code.I agree that this is not a "clean" solution, but I think the (temporary) code.ignoredWarningsUnavoidable is the best tradeoff between the end goal (no ignored warnings) and reality (it will still take some time until the whole build is warning-free).(In reply to Markus Keller from)I think I understand your use case, but is still better, if just one variable. That variable represents the desired defaults for all. Then if you want to do something "special" for some run, you just override that one variable on the command line with whatever values you want, or don't want. The *source* of the parent pom, should not have to change to "run a test".The code.ignoredWarningsUnavoidable would have made it possible to override just bundles that override only this warning, but given that nobody currently overrides any other warnings, I agree this is just academic.Removed the property withPlan from(all on one line):<code.ignoredWarnings>${code.ignoredWarnings},-unavoidableGenericProblems</code.ignoredWarnings>Testing this in jdt.ui:(In reply to Markus Keller from)I think we need to go with plan B in, base on tonight's build failure, and just override "whole thing". <code.ignoredWarnings>-warn:-deprecation,unavoidableGenericProblems</code.ignoredWarnings>Somehow Maven, or Tycho, thinks the first form is "recursive". The error from the build was Resolving expression: '${code.ignoredWarnings}': Detected the following recursive expression cycle in 'code.ignoredWarnings': [code.ignoredWarnings]Fixed the build failure withI searched for "-warn:-" in pom.xml files and found dozens of projects that are even worse citizens and override the compiler settings with the full Maven verbosity: <build> <plugins> <plugin> <groupId>org.eclipse.tycho</groupId> <artifactId>tycho-compiler-plugin</artifactId> <version>${tycho.version}</version> <configuration> <compilerArgs> <arg>-warn:-raw,unchecked</arg> </compilerArgs> </configuration> </plugin> </plugins> </build> These should either be fixed or changed to <properties> <code.ignoredWarnings>-warn:-deprecation,raw,unchecked</code.ignoredWarnings> </properties>(In reply to Markus Keller from)Good catch Markus. I will add "if it is a test bundle" to use<tests.ignoredWarnings>....</tests.ignoredWarnings>but I only saw a few cases of that. This is the list I saw based on what I had loaded in workspace: pom.xml - eclipse-releng-test-parent (2 matches)pom.xml - eclipse.platform.debug/org.eclipse.debug.uipom.xml - org.eclipse.core.databindingpom.xml - org.eclipse.core.databinding.beanspom.xml - org.eclipse.core.databinding.observablepom.xml - org.eclipse.core.databinding.propertypom.xml - org.eclipse.core.jobspom.xml - org.eclipse.debug.uipom.xml - org.eclipse.e4.tools.emf.uipom.xml - org.eclipse.e4.ui.progresspom.xml - org.eclipse.equinox.apppom.xml - org.eclipse.equinox.coordinatorpom.xml - org.eclipse.equinox.metatypepom.xml - org.eclipse.helppom.xml - org.eclipse.jdt.debug.uipom.xml - org.eclipse.jfacepom.xml - org.eclipse.jface.databindingpom.xml - org.eclipse.jface.examples.databindingpom.xml - org.eclipse.jface.tests.databindingpom.xml - org.eclipse.osgipom.xml - org.eclipse.osgi.servicespom.xml - org.eclipse.osgi.utilpom.xml - org.eclipse.pde.api.tools.uipom.xml - org.eclipse.pde.runtimepom.xml - org.eclipse.ui.cheatsheetspom.xml - org.eclipse.ui.idepom.xml - org.eclipse.ui.navigatorpom.xml - org.eclipse.ui.viewspom.xml - org.eclipse.ui.views.logpom.xml - org.eclipse.ui.views.properties.tabbedpom.xml - org.eclipse.ui.workbenchI guess once this bug is "done" we should open a new umbrella bug to clean those up?I think the "variables" issue has been fixed, Question for you, Markus, (and whole team?) ... did you want to manipulate the value, say in "N-builds" so, say, for N-builds the value was set in production code to be <code.ignoredWarnings>-warn:-deprecation</code.ignoredWarnings>rather than the current default of <code.ignoredWarnings>-warn:-deprecation,unavoidableGenericProblems</code.ignoredWarnings>That might help us know when it was time to change the default?(In reply to David Williams from)That would be really nice to have N-builds more verbose about compile warnings and enabling these warnings for other builds when N-builds are good.I have tweaked our production code to use the verbose version during N-builds: -Dcode.ignoredWarnings=-warn:-deprecationBut to use the parent pom's default value during other types of builds. Once the warnings are few enough during N-builds, we can change the default value.Considering the large number of warnings across all projects (at least in JDT Core) it is fair to say we can take this on an incremental fashion, isn't it? It is going to take a huge effort for us to fix all of them in the right way. It is likely that some will just get suppressed (because of the complexity etc.) and some get fixed but could be a while before all can addressed one way or other.(In reply to Jay Arthanareeswaran from)Yes, we are not asking for a large, immediate effort here. The initial effort is just for those cases where there are, say, 1 to 5, such warnings (per bundle). If even that is not possible, we will know not to change the default. And FWIW, instead of marking as "suppress" with individual annotations, it would be preferable to add an override to your pom.xml. There is no need to do that now, but only once we change the parent pom default (if we do). Thanks,(In reply to Jay Arthanareeswaran from)You can suppress the ones in the test plug-ins but in the real code there is no other option than fix them, or suppress those that can't fixed (being hard to fix is not a case that qualifies for that), best for 4.6 M5.By the way, I'm not sure what you mean by "right way". Do you intend to fix some of them in the "wrong" way? ;-)(In reply to Markus Keller from)Mea culpa, I underestimated the number of remaining issues. In the light of the actual data, I retract my original wish to get all theses problems fixed for 4.6.Fixing all would be a huge effort. We have only ONE chance at getting this right, and the cost of rushing in wrong generifications is higher than the cost of some pending raw APIs. I think it would take me a few days only to generify the JDT DOM APIs (and be sure I did it "the right way").should be fixed, but the rest is not so urgent.(In reply to Dani Megert from)That would be "suppressing" the warnings or as mentioned in [1]I see two big hurdles in JDT core. First is what Markus mentioned - DOM API.We have another similar problem in the model area where we are throwing simply everything into raw containers. It would be major rewrite of Java model and its cache or [2] generify the cache with "Object", just to appease compiler. This is all internal, of course.(In reply to Markus Keller from)David, for now please change the N-build to match the I-build.(In reply to Dani Megert from)Accomplished withI have removed M5 from target, but left in 4.6. Remember, the "goal" here was not to necessarily fix all such warnings, but enough that the default could be changed. Then others that could not fix their warnings could override the default in their pom's, by using the same property -- as given in-- that we use in the parent pom. Then that would help other projects that were "clean" by warning if there were "regressions". But, obviously, if there are too many that need to "override the default" then that doesn't help much. I think we were hoping only 6 or 10 would have to override the default? Please correct/clarify anything I have said. (Such as if the whole topic/effort is to be dropped from 4.6!)New Gerrit change created:Gerrit changewas merged to [master].Commit:New Gerrit change created:Gerrit changewas merged to [master].Commit:New Gerrit change created:New Gerrit change created:Gerrit changewas merged to [master].Commit:It appears there has been some fixes for this bug. On a whim I decided to do one build only (today's 3 PM N-build) with the verbose warnings. I will revert the change after that build, so on Sunday's N-build it will be back to normal. Commit to revert:(In reply to David Williams from)Reverted. (From a local test build, the list will actually be longer than it was, I think because some of the UI "overrides" have been fixed. Thank you.)Createdsummary table of warningsFrom the N20160130-1500 build this attachment is a shallow copy of a part of the test results page, ("Shallow" in the since the links do not go anywhere. But since the original build, atwill only be there 3 or 4 more days, I thought best to capture "test state of things" at Neon M5. Its purpose is to simply give an idea of the number of bundles that still have "warnings" and the magnitude of the number of them -- at Neon M5. The only type of warning that was excluded was 'deprecation'.Gerrit changewas merged to [master].Commit:I think this is fixed. Please reopen, if necessary.Fixed a few more:I see remaining verbose poms in these 4 projects:- eclipse.pde.ui:org.eclipse.pde.api.tools.ui- rt.equinox.framework:org.eclipse.osgiorg.eclipse.osgi.servicesorg.eclipse.osgi.utilNew Gerrit change created:New Gerrit change created:(In reply to Markus Keller from)Reopened for the fixes for them.I am assuming this won't be fixed in M6, perhaps not in 4.6? so I am untargeting. Please correct if I have the incorrect assumption.Gerrit changewas merged to [master].Commit:Doing a mass "reset to default assignee" of 52 bugs to help make clear it will (very likely) not be me working on things I had previously planned to work on. I hope this will help prevent the bugs from "getting lost" in other people's queries. Feel free to "take" a bug if appropriate.(In reply to Markus Keller from)is fixed. Markus, I don't see us doing this. OK to close as WONTFIX?	42.0
id=73131	REOPENED	Platform	Resources	3.0	PC Windows XP	P3 normal	Platform-Resources-Inbox	2004-09-02 04:16 EDT by	Dani Megert	2010-08-11 12:09 EDT (	2 users	Found in .log (no other entries) while testing M200409010800. Happened in a testworkspace with auto-build on and auto-refresh off (yes off).!ENTRY org.eclipse.core.resources 4 1 Sep 02, 2004 10:06:15.58!MESSAGE Problems occurred refreshing resources!SUBENTRY 1 org.eclipse.core.resources 4 1 Sep 02, 2004 10:06:15.58!MESSAGE Problem occurred in auto-refresh native code: 5.!ENTRY org.eclipse.core.resources 4 1 Sep 02, 2004 10:06:16.80!MESSAGE Problems occurred refreshing resources!SUBENTRY 1 org.eclipse.core.resources 4 1 Sep 02, 2004 10:06:16.80!MESSAGE Problem occurred in auto-refresh native code: 5.!ENTRY org.eclipse.core.resources 4 1 Sep 02, 2004 10:06:17.91!MESSAGE Problems occurred refreshing resources!SUBENTRY 1 org.eclipse.core.resources 4 1 Sep 02, 2004 10:06:17.91!MESSAGE Problem occurred in auto-refresh native code: 5.!ENTRY org.eclipse.core.resources 4 1 Sep 02, 2004 10:06:18.133!MESSAGE Problems occurred refreshing resources!SUBENTRY 1 org.eclipse.core.resources 4 1 Sep 02, 2004 10:06:18.133!MESSAGE Problem occurred in auto-refresh native code: 5.!ENTRY org.eclipse.core.resources 4 1 Sep 02, 2004 10:06:19.144!MESSAGE Problems occurred refreshing resources!SUBENTRY 1 org.eclipse.core.resources 4 1 Sep 02, 2004 10:06:19.144!MESSAGE Problem occurred in auto-refresh native code: 5.!ENTRY org.eclipse.core.resources 4 1 Sep 02, 2004 10:06:20.156!MESSAGE Problems occurred refreshing resources!SUBENTRY 1 org.eclipse.core.resources 4 1 Sep 02, 2004 10:06:20.156!MESSAGE Problem occurred in auto-refresh native code: 5.!ENTRY org.eclipse.core.resources 4 1 Sep 02, 2004 10:06:21.167!MESSAGE Problems occurred refreshing resources!SUBENTRY 1 org.eclipse.core.resources 4 1 Sep 02, 2004 10:06:21.167!MESSAGE Problem occurred in auto-refresh native code: 5.!ENTRY org.eclipse.core.resources 4 1 Sep 02, 2004 10:06:22.179!MESSAGE Problems occurred refreshing resources!SUBENTRY 1 org.eclipse.core.resources 4 1 Sep 02, 2004 10:06:22.179!MESSAGE Problem occurred in auto-refresh native code: 5.!ENTRY org.eclipse.core.resources 4 1 Sep 02, 2004 10:06:23.200!MESSAGE Problems occurred refreshing resources!SUBENTRY 1 org.eclipse.core.resources 4 1 Sep 02, 2004 10:06:23.200!MESSAGE Problem occurred in auto-refresh native code: 5.!ENTRY org.eclipse.core.resources 4 1 Sep 02, 2004 10:06:24.212!MESSAGE Problems occurred refreshing resources!SUBENTRY 1 org.eclipse.core.resources 4 1 Sep 02, 2004 10:06:24.212!MESSAGE Problem occurred in auto-refresh native code: 5.	I think that a call to WaitForMultipleObjects is returning "Access is denied.".Hmm...I saw this also on one of our users boxes. Auto-Build OFF but auto-refresh ON. The message is a little bit confusing because it doesn't explain very much.It was logged multiple times and caused a log file size of more than 5MB. Note that Eclipse was very unresponsive while this message was logged 3 or 4 times EVERY second.We were never able to reproduce this.With I20100810-0800, I got 16 such entries in my dev workspace (at irregular intervals, about 5-20 seconds apart)!ENTRY org.eclipse.core.resources 4 1 2010-08-11 14:40:30.538!MESSAGE Problems occurred refreshing resources!SUBENTRY 1 org.eclipse.core.resources 4 1 2010-08-11 14:40:30.553!MESSAGE Problem occurred in auto-refresh native code: 5.Auto-refresh is enabled (and has been like that for a long time).Could be the same reason as. I was cleaning up an old temp directory at that time, and my workspace had linked resources that were invalid afterwards. If you can't / don't want to remove these messages, it would be helpful if they contained a file system and/or resource path.	5.0
id=117727	REOPENED	Platform	Resources	4.4.2	PC CentOS	P3 normal	Platform-Resources-Inbox	2005-11-23 10:12 EST by	John Weidner	2016-08-02 11:19 EDT (	2 users	After my machine shut down unexpectedly, whenever I try to restart eclipse I get the "An error has occurred. See the log" message. The log contains:!SESSION 2005-11-23 09:56:44.571 -----------------------------------------------eclipse.buildId=I20050627-1435java.version=1.5.0_05java.vendor=Sun Microsystems Inc.BootLoader constants: OS=win32, ARCH=x86, WS=win32, NL=en_USCommand-line arguments: -os win32 -ws win32 -arch x86 -clean!ENTRY org.eclipse.core.resources 2 10035 2005-11-23 09:56:47.899!MESSAGE A workspace crash was detected. The previous session did not exit normally.!ENTRY org.eclipse.osgi 2005-11-23 09:56:48.930!MESSAGE An error occurred while automatically activating bundle org.eclipse.core.resources (17).!STACK 0org.osgi.framework.BundleException: Exception in org.eclipse.core.internal.compatibility.PluginActivator.start() of bundle org.eclipse.core.resources. at org.eclipse.osgi.framework.internal.core.BundleContextImpl.startActivator(BundleContextImpl.java:1013) at org.eclipse.osgi.framework.internal.core.BundleContextImpl.start(BundleContextImpl.java:969) at org.eclipse.osgi.framework.internal.core.BundleHost.startWorker(BundleHost.java:321) at org.eclipse.osgi.framework.internal.core.AbstractBundle.start(AbstractBundle.java:266) at org.eclipse.core.runtime.adaptor.EclipseClassLoader.findLocalClass(EclipseClassLoader.java:116) at org.eclipse.osgi.framework.internal.core.BundleLoader.findLocalClass(BundleLoader.java:337) at org.eclipse.osgi.framework.internal.core.SingleSourcePackage.loadClass(SingleSourcePackage.java:37) at org.eclipse.osgi.framework.internal.core.BundleLoader.findClass(BundleLoader.java:386) at org.eclipse.osgi.framework.internal.core.BundleLoader.findClass(BundleLoader.java:350) at org.eclipse.osgi.framework.adaptor.core.AbstractClassLoader.loadClass(AbstractClassLoader.java:78) at java.lang.ClassLoader.loadClass(Unknown Source) at java.lang.ClassLoader.loadClassInternal(Unknown Source) at org.eclipse.ui.internal.ide.model.WorkbenchAdapterFactory.<init>(WorkbenchAdapterFactory.java:35) at org.eclipse.ui.internal.ide.model.WorkbenchAdapterBuilder.registerAdapters(WorkbenchAdapterBuilder.java:33) at org.eclipse.ui.internal.ide.IDEWorkbenchAdvisor.initialize(IDEWorkbenchAdvisor.java:132) at org.eclipse.ui.application.WorkbenchAdvisor.internalBasicInitialize(WorkbenchAdvisor.java:172) at org.eclipse.ui.internal.Workbench.init(Workbench.java:1002) at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1636) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:367) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:143) at org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:103) at org.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:226) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:376) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:163) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at org.eclipse.core.launcher.Main.invokeFramework(Main.java:334) at org.eclipse.core.launcher.Main.basicRun(Main.java:278) at org.eclipse.core.launcher.Main.run(Main.java:973) at org.eclipse.core.launcher.Main.main(Main.java:948)Caused by: java.lang.StackOverflowError at org.eclipse.core.internal.dtree.DeltaDataTree.reroot(DeltaDataTree.java:815) at org.eclipse.core.internal.dtree.DeltaDataTree.reroot(DeltaDataTree.java:815) at org.eclipse.core.internal.dtree.DeltaDataTree.reroot(DeltaDataTree.java:815)	The extra plugins I had installed were:jadclipse_3.1.0.jarde.tobject.findbugs_0.0.16org.vssplugin_1.6.1com.sysdeo.eclipse.tomcat_3.1.0.betaNot reproducible.CreatedLog from headless build tool(In reply to John Arthorne from)I have seen this several times at one of our customers with a tool based on Eclipse Luna SR2.There, a small Eclipse application runs a headless build of an Eclipse workspace checked out from SCM. Going through the logs of these headless builds I found that in a third of the cases, the StackOverflowError mentioned inoccurred.I'll try to reproduce this locally, with a SCM revision that failed for our customer, but unfortunately I won't be able share the workspace's contents with you. Any hints on how to assist you in debugging this are thus greatly appreciated.Reopening because of(can't attach something and change status at the same time).(In reply to Andreas Sewe from)Given that my headless build starts from a fresh workspace (the -data command line option points at a directory that was just created and that does not contain a .metadata folder), I wonder why I am also seeing messages like the following:How does org.eclipse.core.resources determine this? AFAICT, there was not previous session.(In reply to Andreas Sewe from)Scratch that. There may indeed be a .metadata folder from a previous invocation. I can't spot an obvious pattern between failing (StackOverflowError) and successful sessions, though: Fail OK OK OK Fail Fail OK OKIt's not that the next session always successfully "resets" the metadata. Weird.	6.0
id=46297	REOPENED	Platform	Resources	3.0	All All	P3 enhancement	Platform-Resources-Inbox	2003-11-07 14:39 EST by	David Whiteman	2016-11-29 11:00 EST (	61 users	We use Eclipse to manage a lot of files, including shell scripts that have nofile extension. Unfortunately, there is no way to specify a list of valideditors for files with no extension via the file associations preferences page. Even without that, it would be nice if you could select any registered editorvia the Open With menu for a file, not just the ones that are listed in FileAssociations. As it is, my shell script named "xxx" has no way of opening inanything other than the default text editor or the system editor.	***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***We need to adapt to Platform Core's new content type mechanism. This will allow editor associations based on file content.We need a way to provide a document describer that is called everytime a file isabout to be opened. If the decriber exists and specifies a given editor, thatis the editor which is used. The describer will be checked for every file thatis opened regardless of name, extension, or lack of extension.I could use this too. What's the current status? A "(no extension)" listing inthe File Associations preferences would be a low tech way to take care of this,or just allow a file type of "*" in the New File Type dialog (currently thatcomplains that "The file extension cannot be empty").Related isAlso see this EPIC bug:which is essentially blocked by Eclipse's incapability of assigning file typeand associations based on content or on mode lines. Naturally a lot of perlprograms that are getting used as commands do not have and must not have extensions.The EPIC big also mentions an API interface "IContentDescriber and friends" thatis in Eclipse and intended to do this but which gets used only in a waydefeating the purpose for files without extensions.BTW -- it would already be extremely helpful if there was some other way toselect the plugin/editor to use for a file or to assign the type to a file (andremember it in some project preference). E.g. when right-clicking on a filewithout extensions, make it so that the user can choose "open in EPIC editor" or"open as perl file". Currently, Currently the only alternatives for such filesare text, system, and default editor, but no way to edit it as perl or HTML etc.Yes, I agree with the previous comment... it would be nice to have an OpenWith... where you could select any program on your system to open the file, andfor there to be a "remember this decision" checkbox so that file will always beopened with the program you selected.andare the subject of.not having this feature is extremly annoying, especially since emacs and vi have had it for ages. this is the reason i keep using vi to edit shell scripts***has been marked as a duplicate of this bug. ***Moving Dougs bugsWould it be possible to just get a sub menu off of the "Open With" menu that says "Other Editors" or something like it which list all the editors currently registered with eclipse. Some sort of traction needs to be made on this bug since almost all Unix projects need it."Opened: 2003-11-07"...Is it any chance to get "no extension file support" feature? I'm in in the middle of creating a developement tool for UV Basics progs and unfortunetly there are no extension assigned to the source code files. We are thinking about adding a tempoprary extension for this files when editing (source code files are stored in CVS repository). But that makes this solution more complex. Maybe some of You know how to resolve this bug in nice way.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***(In reply to)We added Open With->Other... as of 3.3 M5.I know that this has an obvious performance impact. One thought (if anyone is still interested) is to make this a user selectable property to turn on/off (with RCP apps able to set it globably). Not a perfect solution, but my two cents. My problem is similar to others described; while 90% of the time I anticipate 'correct' file extensions I'd like to be able to handle non-compliant extensions too.Still very interested, is there any progress on this (content describers for extensionless files)?This is a show-stopper for us, we used EFS to expose resources that are stored in a repository but none of them has any filename extension and without a proper way to associate our structured editors which each file type the product isn't usable.(In reply to)Not that I know. From re-reading this bug, it seems that we need support for this at the Core level, or is it possible to have content describers that look at files without extensions already? Passing to Resources for comment.(In reply to)AFAIK, no progress. What you can do now for extensionless files is to define list of file names in content type ext. point.(In reply to)Describers work only when extensions or file names are provided. And Boris is right, this has to be fixed on the Core level.That is not really true. Describers are unaware of file names, and if a file name is not provided to the content type matcher, it will do purely content based content type matching.Addressing this issue should not be too hard, but extra care should be taken in order to keep content type lookup fast.I worked in the design and wrote the content type support (2004/2005). I wouldn't have time to implement this myself, but unless the idea is to do more than a small incremental change to the existing story, I would be keen on supporting whoever implements this by helping with understanding the existing code and/or providing design/code reviews.(In reply to)Indeed, from a very quick look at the source it looks like it may be possible to extend the classes around ProjectContentType to add the ability to provide custom content type matchers for projects of a given nature, but I didn't look into the details. The benefit is that there would be no performance impact for projects of other natures.If you think that is the right direction to look into I can spend some time on this.Project-specific content-types were developed for CDT in 3.1 but I am not sure whether they ever built a configuration tab for the project properties dialog (or ended up adopting that mechanism after all). I know Platform does not provide a UI for it so at best whatever UI CDT has come up with would have to be pushed down to platform.I am not saying that that is really bad but I was hoping the scope of changes down to a minimum. An obvious (and maybe naive) approach would be to add the ability of supporting empty extensions. There are some assumptions in the content type mechanism about extensions not being empty, and those would have to be loosened up.This would only affect the content type plug-in, no action required from any downstream plug-ins.Guys, don't over think this. For my needs it would be sufficient if I could pick the editor that would open when I click on a file without an extension. You don't have to figure out the file type for me.A feature to simply select the mode for editing the file has already been discussed in comments #7 ff.Even more useful would be something similar to what Emacs can do: look into the first nonblank line (or the first N characters of the first nonblank line) and figure out the mode by matching the content of that line against a set of regexp rules. This can cover a lot of script languages (which usually do not have an extension on non-Windows systems) but can also be used for many other files by simply placing an appropriate "mode comment line" into the first line.(In reply to)I actually have the content type as meta-information associated with the EFS store that backs the resource. If we are going to fix this I think plugins should have the ability to provide custom matchers, otherwise the enhancement requests will keep flowing in.I'll have a look at what Rafael suggest about empty extensions.I examined what it would take to implement extension-less support for Perl files in the EPIC plugin today. I have two main findings:1. In order for a plugin-provided IContentDescriber to be consulted at all, the content type must be associated with the examined file's name or extension. Specifically, if the method "public IContentType[][] internalFindContentTypesFor(ContentTypeMatcher matcher, final String fileName, Comparator sortingPolicy)" in ContentTypeCatalog does not find any content type based on file associations, the call to matcher.getSpecificDescription in getDescriptionFor(ContentTypeMatcher matcher, ILazySource contents, String fileName, QualifiedName[] options) won't occur and accordingly no IContentDescriber will ever be consulted. Instead, the file will be classified as having no known content type.2. In the method IContentTypeMatcher.findContentTypeFor(String fileName) IContentDescribers are never consulted - and can't be consulted - simply because this method has no access to the IFile reference, so no access to file's content needed by IContentDescribers. Unfortunately, it is invoked by quite a few callers, most notably IDE.guessContentType (where the IFile is still available). IDE.guessContentType is used while determining an icon for the file, even before an editor is opened or any content type contributing plugin activated.Based on point 1) above, I concluded that associating the empty extension ("") with the Perl source file content type would be a first step toward the goal. I hacked FileExtensionDialog to permit entering "*." to check this assumption. It helped - all extension-less files were now globally classified as Perl source files. This effect could also be reached programmatically. But it also caused false positives while determining file icons - not a surprise, given that the Perl IContentDescriber was never involved in the process, as noted in point 2).Point 2) also highlights that enabling plugins to provide a project-specific IContentTypeMatcher (which indeed can't be done yet), would not by itself solve the problem. In my opinion, the main flaw is that the method findContentTypeFor(String), which supposedly determines a file's content type based on a file name, belongs to the IContentTypeMatcher API and that several other classes are hardwired to rely on this guesswork.I checked that hacking IDE.guessContentType to use the findContentTypeFor(InputStream, String) method, which actually consults IContentDescribers, was enough to make the false positives disappear, and would be enough to get EPIC users happy. Obviously, it's not a viable solution.I think that a reasonable approach to fix this properly would be as follows:1. Get rid of findContentTypeFor(String) entirely, or at least never invoke it from clients that *do* have access to richer context information (an IFile/InputStream/ILazySource reference).2. Make the default implementation of IContentTypeMatcher ignore the IFile reference passed by clients in order to maintain backwards compatibility and current performance levels.3. Make it possible to extend/override the default implementation of IContentTypeMatcher, preferably on a per-project basis. It should probably be tied to project natures. Naturally, the question arises what should happen when a project has multiple natures with conflicting IContentTypeMatchers contributed by different plugins.Thanks for looking into this, Jan. I thought I should mention a few things:a) intention of referring to IFile from the content type API. That is a no-no given that IFile is a core.resources abstraction; the content type framework is completely unaware of resources and lies at a lower layer. But maybe I misunderstood you.b) switching from name-only content type determination to content *and* name based is not a trivial change. Those API have different purposes and *very* different performance characteristics (the second does I/O). But that is a different concern altogether. As far as I know, any critical functionality (including encoding determination and editor associations) that is based on content types use the content-based API. Icons for label decoration are the only use case I recall for the name-based API. For that specific scenario, it has been considered (don't recall the bug #) the idea of using the faster API first and then to asynchronously update the label images based on the true content type from a background job. But that is a different issue.c) for resource-aware clients, the way to determine content types is by invoking IFile#getContentDescription(), as that will cache the result so following requests for the content-type of an IFile won't require the file to be read. No one should be reading the contents of an IFile and passing it into the content type API themselves.(In reply to)You're right. I overlooked that independence constraint. It can be upheld by using IFile#getContentDescription() as you suggested in c).How so? The only purpose I can see is to determine a file's content type.That's correct. However, the performance aspect is only nasty when dealing with non-local resources and caching surely helps a lot.Clients of the name-based API according to Call Hierarchy for ContentTypeMatcher#findContentTypeFor(String):- the already mentioned IDE#guessContentType, used in WorkbenchFile#getBaseImage for determining a file's icon- IDE#getContentType, uses the name-based API as a fallback if the content-based API fails; seems ok and harmless- IDE#getEditorDescriptor, uses the name-based API; this is apparently invoked to find an editor for an IRemoteFile and might be justified with performance arguments- CompareUIPlugin#getContentType, name-based API used as fallback- ContentDescriptionManager#getDescriptionFor uses the name-based API if the M_DEFAULT_CONTENT_DESCRIPTION flag is set in a file's ResourceInfo. I couldn't find any location where this flag is actually set and don't understand why it's necessary.- FileContentManager#getType(IStorage) in Team plugin uses the name-based API, apparently to tell apart text/binary; it could easily use the content-based API instead, don't know about performance- EditorRegistry#guessAtContentType(String), uses the name-based API. It is called by EditorRegistry#getDefaultEditor and EditorRegistry#getImageDescriptor. Those two have themselves many clients, including non-platform plugins (among others, EPIC).Overall, I can imagine that most users would prefer a solution which works reasonably well for local files (or is only enabled in selected projects) to no solution at all. If you disapprove partial hacks in the platform, a good compromise might be to open it wide enough to make such hacks possible in a third-party plugin. This way, plugin developers can take responsibility, if they wish, and you don't bind your hands for implementing a future better solution.Right now, it seems that all I'm missing to fix EPIC is a change in IDE#guessContentType (new extension point? a new unofficial public method to override behavior?).Another possibility might be to annotate files with their content type manually or, in case of EPIC, using a builder. The content type would then become a file's metadata attribute much like the encoding or the user-selected editor. Such explicitly defined content type should then take precedence over automatically guessed content types.Well, one guesses the content type based on the file name and the other determines the content type based on contents. The former is cheap (non-blocking) and returns a result that is only a rough approximation whereas the latter is expensive but returns the "exact" content type (at least as Eclipse sees it). Overloading the same name there was a mistake.Not really. The platform UI team considered using the content-based API and the performance was not acceptable. If you have a workspace with thousands of resources, even in the local case the price is too high if you are talking about lightweight clients that (which often don't do I/O) that want to determine the content type for lots of resources (for example, label decoration). The cache helps after it is built only, and it can only handle up to a number of non-trivial content types.It is not (comparatively) as bad for clients that already do I/O (such as compilers) and are performing long-running tasks. Those though could be using the API that takes contents (instead of IFile#getContentDescription) as they might already have the contents in memory, but I digress.Sorry for not being able to provide concrete help towards a solution, just wanted to contribute with some background.Any chance to get attention to this bug for 3.6 release?Szymon, do you have something likebut for the Platform Resources component?See(In reply to)We haven't created the final 3.6 plan yet. However we maintain the tentative plan under. I added this bug there since it looks like a good 3.6 candidate.not sure, but I should probably open a separate feature request for this?? but since it is part of the code that you are actively working on for this bug, it seems just as appropriate to mention it here.Condition:1) I use custom extensions for my files and configure the "content type" accordingly.2) I create/use lots of different workspaces (mostly for the convenience of switching between sets of open files).Problem:When I create a new workspace, the settings that define the file content types do not get copied. I must then reenter them by hand.Solution:It would be really really nice if these file type settings were global or at least copyable during workspace creation. Ditto for the ~tags~ e.g. "FIXME", "TODO"-------as far as performance problems with content analysis... if you could constrain that to only looking at the selected file, instead of all files, then performance should be tolerable.(In reply to)File > Export > General > Preferences > Export allFile > Import > General > Preferences > Import allDoes that work for these file type settings?(In reply to)no, did not work... in fact I saw no discernible difference. Missing settings are debugger exe, task tags, projects and content types....given this lack, I verified that the .epf file looks sane. it looks fine, just very incomplete... It takes a lot of time and effort to enter all of these setting by hand for each workspace. So these days I resort to manually copying the workspace folder, which I can live with. But I figured as long as people were going to be touching the preferences code, it would be nice if they would consider this issue. Should this be a separate bug?Note: I keep my workspace configs separate from my code files, not sure why you would ever want them together....(In reply to)Yeah, that's what I do too after filtering out some stuff that are disposable.Yes, please file a separate bug to request content types be export-able (in some way, shape, or form).(In reply to)Please look at? This may be a bug, you're looking for.yes, Szymon, thanks. that's the bug. I've updated it to include the scenario of creating a new workspace.dev's, when fixing this bug please take a look atI suspect that you are going to be touching the same code areas and it would be nice to have that problem fixed as well.(In reply to)The reason that this was not enough is that even if you do an "Open with..." you get an "Unsupported Content Type" error. If We could get past this error, the "Open with..." option would be good enough for most cases and we wouldn't have to go the more expensive route of trying to determine the content type.I was wondering about the performance side again.As I see it, the only time you need to open the file and look into it is when the user actually wants to open it, right? This bug is about "select the correct editor", not "invoke the right builder".So I don't see why the performance should be a (big) issue:1. We need to open the file and read the contents anyway2. This is not something that happens all the time, the user specifically has to request it. Since Eclipse already remembers which editor I used for a certain file (I can open most *.CSV files in Excel and, in the same project, open some with the text editor), this is a small performance penalty that has only to be paid once.I'm not sure where Eclipse saves this info (in the project, or the workspace) but it should be relatively trivial to extend the project settings to remember the editor to use for a file in the project (just like Eclipse already remembers the encoding).***has been marked as a duplicate of this bug. ***We have run out of time. Removing the target. We can give it another chance during 3.7, but help is needed.(In reply to)Ditto.Steps to reproduce:1. Have a file containing PHP that's named something like 5.4r12. Right click file, select Open With > Other3. Select PHP Editor4. Get "Unsupported content type in editor" dialog box and no syntax highlighting in file.I just TOLD the software what content type to assume by selecting what editor to use. It should not overrule or second-guess me. Just open the file in the editor I choose and make a best effort to highlight it instead of throwing useless dialog boxes in my face.(In reply to)I totally agree. If I tell it what content type I am opening the file as it should just believe me.(In reply to)A data point: Open With... works fine for perl scripts with no extension in3.5 (Galileo) if I have EPIC installed.The interesting questions appears to be: Why it doesn't work for PHP files?Which extension-less file types does it work with and which does it not.? Is it a problem with the Open With... code or with particular editors? There may be hope for progress next year if these questions can be answered.Paul AllenI suggest you file a separate bug report for that.(In reply to)Please raise a separate bug against the PHP plug-in/product being used. Editors can display warnings or errors instead of the file content, if they compute that the content is not appropriate for some reason.Hi, I came here via, and I'm surprised that this issue has not been addressed in almost 7 years. Is there anything I could help with to get this fixed for 3.7?"I'm surprised that this issue has not been addressed in almost 7 years."it would be unprofessional for me to express my opinion, so instead I am going to remove myself from the cc list and confine my comment to stating that I no longer use Eclipse.(In reply to)Well, I can't see any patch attached to the bug. During 3.6 I and other core committers released many community contributions to Eclipse. So I'm not sure why, if it so important, nobody provided any contribution here. But it is always easier to just blame others.Anyway answering you question Mirko, I know that Eduard Bartsch is interested in working in the content type area during 3.7. If you want to help us, you can join our Resources calls which will start again at the end of August. Then we can discuss how you can work on this issue. Of course, you could just provide a raw patch that fixes the issue.Stay tuned with the platform-core-dev mailing list.We have a slightly different but closely related issue with the content type APIs.We map resources into the workspace using EFS stores that point to a structured repository.In that repository content-type information is stored as metadata separately from the file. Even if we register our content describer with the framework the only information we get to make a determination are the file name and an input stream to its content - which isn't enough for us to get a handle on the metadata.To avoid introducing a dependency from the content type system to resources, file stores or other higher level concepts couldn't the ContentTypeMatcher use an adapter based mechanism? It could try to adapt the entity to be analyzed to an IContentDescription, and if that returns null it could adapt it to an InputStream and proceed with the current APIs.This would let third party plug-ins register adapter factories for IFile, IFileStore, IEditorInput, and implement their custom policies to assign a content type to those entities.The benefit is that this doesn't tie the content type APIs to a specific shape or form of the information being made available by clients...Any thoughts?(In reply to)Franck, could you please check the? There, I have proposed a patch that goes into a very similar direction and allows registration of adapter factories for IFileStore.Since you are using EFS with a structured repository that contains additional metadata, I would also like to point you to thethat describes an e4 incubator component designed to bridge between structured repositories and Eclipse resource management using EFS.(In reply to David Whiteman from)I don't know when it has been fixed, but you can now (Oxygen M3) add a file type with no extension in the "file associations" preference section. I've tested adding "README" as a file type and configured it to open the "Build Properties Editor" as its associated editor (I know, stupid example, but for the sake of the test it was enough). And voila, all README files in my workspace now open inside the "Build Properties Editor"I don't think this ticket is FIXED and should not be CLOSED.I'm not sure that is the use case this ticket was originally opened up to address. It's been years and years here so it's hard to recall, but I believe the use case was being able to register some sort of content type sniffer on files with no extension globally - so that you could sniff for things like #! headers to determine if the file was a bash script or ruby script or node binary script, etc.I believe you've always been able to register specific filenames as a given content type, such as "Rakefile" as ruby or something along those lines. Which is fine. But it's not uncommon for various languages to have libraries which register "binary scripts" in some PATH that are actually not executables but are shell/ruby/node/etc scripts.(In reply to Mikaël Barbero from)That's not the point. That always worked. The point is to register an editor for all file names that have no extension and to make it more flexible (see duplicate bug reports).	58.0
id=90617	REOPENED	Platform	Resources	3.1	PC Windows XP	P3 normal	Platform-Resources-Inbox	2005-04-07 10:39 EDT by	Leopold Welsch	2006-03-28 18:05 EST (	2 users	I'm currently working on a calendar-programming and therefore have to test withdifferent dates. But changing the date itself prevents Eclipse from launching anewly built application. I guess it's not built.I guess the time-shifts are critical when shifting behind and then it fails tobuild and therefore to launch.=> with the current version calendar-tests are not really possible. Start/StopEclipse all the time is little bit annoying.	Moving to platform resources for investigation. When launching we simply call build on the projects associated with a build (if a launcher has "scoped build" knowledge), or build on the workspace when scoped information is not available.For example:ResourcesPlugin.getWorkspace().build(IncrementalProjectBuilder.INCREMENTAL_BUILD, subMonitor);and:for (int i = 0; i < projects.length; i++ ) { projects[i].build(IncrementalProjectBuilder.INCREMENTAL_BUILD, monitor);}- What build of Eclipse are you using (See Help > About) - Are there any errors in your log file? - What leads you to conclude the build failed? Did you get an error dialog, ormarker indicating the build failed?Closing until requested details are provided.1) 3.1.M5a, with the new M6 I didn't try2) None, nothing at all3) The message-box appeared with start rebuilding resp. launching and NOTHINGhappens. If I click the red-button, next time I couldn't even start. I guess ithangs completely.Traces requested? If yes, how to obtain, since nothing is printed!After rereading this bug I understand better what you are doing. You aresetting the system date back in time while Eclipse is running. This is likelyto break anything that relies on file timestamps to determine if things havechanged. It doesn't surprise me that this causes problems.If it hangs completely, a Java stack dump will tell us what is going on. Simplylaunch eclipse using java.exe instead of javaw.exe, and hit Ctrl+Break when thesystem is completely hung. This will dump a stack trace, which you can pasteinto a file and attach to this bug. I'm not convinced we'll be able to help youthough.Let's look at the following sample-set:- Today is April, 29- I have HelloWorld.java- Build id: I20050401-16451) Run via Eclipse-Alt+Shift+X+J => Output in the console OK2)a) I change the date to April 30b) I change the code to HelloWorld1 (NOTE: Code-changes are required)c) Launching like 1) works fine3) a) I change back to the April 29b) Launching HelloWorld1 is no problem at allc) Changing the code to HelloWorld2d) Start like 1 => infinite Launching procedure###################- I guess you could easily reproduce it.- According to your last statement, 2) should not work, but does. As well 3b)shouldn't work but does very well.- the 'hung'-issue is currently not reproducable, since I don't know how toreproduce it. But it could occur!- How to start eclispe via java??? I'm launching it via 'eclipse' + options (Aswell as, where could the trace be located?)***has been marked as a duplicate of this bug. ***	7.0
id=132220	REOPENED	Platform	Resources	3.2	PC Windows XP	P3 normal	Platform-Resources-Inbox	2006-03-16 13:45 EST by	Rafael Chaves	2015-04-01 09:49 EDT (	6 users	3.2 M5I had a bug in my file system implementation (a NPE if the URI format did not match what was expected). That prevented Eclipse from starting, since the NPE was thrown during the activation of the resources plug-in.It would be good if Resources was more resilient to failures calling third-party code during startup (wrapping RuntimeExceptions into CoreExceptions, for instance), something I believe might not have happened in the past, before EFS.java.lang.NullPointerException at java.net.URI$Parser.parse(Unknown Source) at java.net.URI.<init>(Unknown Source) at java.net.URI.create(Unknown Source) at my.BogusFileSystem.getStore(BogusFileSystem.java:55) at org.eclipse.core.internal.filesystem.InternalFileSystemCore.getStore(InternalFileSystemCore.java:107) at org.eclipse.core.filesystem.EFS.getStore(EFS.java:296) at org.eclipse.core.internal.localstore.FileStoreRoot.toLocalPath(FileStoreRoot.java:119) at org.eclipse.core.internal.localstore.FileStoreRoot.<init>(FileStoreRoot.java:56) at org.eclipse.core.internal.localstore.FileSystemResourceManager.setLocation(FileSystemResourceManager.java:777) at org.eclipse.core.internal.localstore.FileSystemResourceManager.initializeStore(FileSystemResourceManager.java:387) at org.eclipse.core.internal.localstore.FileSystemResourceManager.read(FileSystemResourceManager.java:611) at org.eclipse.core.internal.resources.SaveManager.restoreMetaInfo(SaveManager.java:765) at org.eclipse.core.internal.resources.SaveManager.restoreMetaInfo(SaveManager.java:746) at org.eclipse.core.internal.resources.SaveManager.restore(SaveManager.java:637) at org.eclipse.core.internal.resources.SaveManager.startup(SaveManager.java:1299) at org.eclipse.core.internal.resources.Workspace.startup(Workspace.java:1882) at org.eclipse.core.internal.resources.Workspace.open(Workspace.java:1652) at org.eclipse.core.resources.ResourcesPlugin.startup(ResourcesPlugin.java:367) at org.eclipse.core.internal.compatibility.PluginActivator.start(PluginActivator.java:31) at org.eclipse.osgi.framework.internal.core.BundleContextImpl$2.run(BundleContextImpl.java:994) at java.security.AccessController.doPrivileged(Native Method) at org.eclipse.osgi.framework.internal.core.BundleContextImpl.startActivator(BundleContextImpl.java:988) at org.eclipse.osgi.framework.internal.core.BundleContextImpl.start(BundleContextImpl.java:969) at org.eclipse.osgi.framework.internal.core.BundleHost.startWorker(BundleHost.java:314) at org.eclipse.osgi.framework.internal.core.AbstractBundle.start(AbstractBundle.java:256) at org.eclipse.core.runtime.internal.adaptor.EclipseLazyStarter.preFindLocalClass(EclipseLazyStarter.java:83) at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalClass(ClasspathManager.java:402) at org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.findLocalClass(DefaultClassLoader.java:186) at org.eclipse.osgi.framework.internal.core.BundleLoader.findLocalClass(BundleLoader.java:338) at org.eclipse.osgi.framework.internal.core.SingleSourcePackage.loadClass(SingleSourcePackage.java:37) at org.eclipse.osgi.framework.internal.core.BundleLoader.findClass(BundleLoader.java:387) at org.eclipse.osgi.framework.internal.core.BundleLoader.findClass(BundleLoader.java:351) at org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.loadClass(DefaultClassLoader.java:81) at java.lang.ClassLoader.loadClass(Unknown Source) at java.lang.ClassLoader.loadClassInternal(Unknown Source) at org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:107) at org.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:99) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:92) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:68) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:374) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:169) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at org.eclipse.core.launcher.Main.invokeFramework(Main.java:338) at org.eclipse.core.launcher.Main.basicRun(Main.java:282) at org.eclipse.core.launcher.Main.run(Main.java:977) at org.eclipse.core.launcher.Main.main(Main.java:952)	I got this failure using 03091200 build.java.lang.NullPointerException at org.eclipse.core.internal.filesystem.InternalFileSystemCore.getStore(InternalFileSystemCore.java:104) at org.eclipse.core.filesystem.EFS.getStore(EFS.java:296) at org.eclipse.jdt.internal.core.util.Util.toLocalFile(Util.java:2044) at org.eclipse.jdt.internal.core.builder.ClasspathJar.<init>(ClasspathJar.java:91) at org.eclipse.jdt.internal.core.builder.ClasspathLocation.forLibrary(ClasspathLocation.java:38) at org.eclipse.jdt.internal.core.builder.State.read(State.java:255) at org.eclipse.jdt.internal.core.builder.JavaBuilder.readState(JavaBuilder.java:125) at org.eclipse.jdt.internal.core.JavaModelManager.readState(JavaModelManager.java:2586) at org.eclipse.jdt.internal.core.JavaModelManager.getLastBuiltState(JavaModelManager.java:1365) at org.eclipse.jdt.internal.core.builder.JavaBuilder.getLastState(JavaBuilder.java:367) at org.eclipse.jdt.internal.core.builder.JavaBuilder.build(JavaBuilder.java:150) at org.eclipse.core.internal.events.BuildManager$2.run(BuildManager.java:593) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37) at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:168) at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:202) at org.eclipse.core.internal.events.BuildManager$1.run(BuildManager.java:231) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37) at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:234) at org.eclipse.core.internal.events.BuildManager.basicBuildLoop(BuildManager.java:253) at org.eclipse.core.internal.events.BuildManager.build(BuildManager.java:282) at org.eclipse.core.internal.events.AutoBuildJob.doBuild(AutoBuildJob.java:143) at org.eclipse.core.internal.events.AutoBuildJob.run(AutoBuildJob.java:204) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:58)org.eclipse.core.runtime.CoreException[2]: java.lang.NullPointerException at org.eclipse.core.internal.filesystem.InternalFileSystemCore.getStore(InternalFileSystemCore.java:104) at org.eclipse.core.filesystem.EFS.getStore(EFS.java:296) at org.eclipse.jdt.internal.core.util.Util.toLocalFile(Util.java:2044) at org.eclipse.jdt.internal.core.builder.ClasspathJar.<init>(ClasspathJar.java:91) at org.eclipse.jdt.internal.core.builder.ClasspathLocation.forLibrary(ClasspathLocation.java:38) at org.eclipse.jdt.internal.core.builder.State.read(State.java:255) at org.eclipse.jdt.internal.core.builder.JavaBuilder.readState(JavaBuilder.java:125) at org.eclipse.jdt.internal.core.JavaModelManager.readState(JavaModelManager.java:2586) at org.eclipse.jdt.internal.core.JavaModelManager.getLastBuiltState(JavaModelManager.java:1365) at org.eclipse.jdt.internal.core.builder.JavaBuilder.getLastState(JavaBuilder.java:367) at org.eclipse.jdt.internal.core.builder.JavaBuilder.build(JavaBuilder.java:150) at org.eclipse.core.internal.events.BuildManager$2.run(BuildManager.java:593) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37) at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:168) at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:202) at org.eclipse.core.internal.events.BuildManager$1.run(BuildManager.java:231) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37) at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:234) at org.eclipse.core.internal.events.BuildManager.basicBuildLoop(BuildManager.java:253) at org.eclipse.core.internal.events.BuildManager.build(BuildManager.java:282) at org.eclipse.core.internal.events.AutoBuildJob.doBuild(AutoBuildJob.java:143) at org.eclipse.core.internal.events.AutoBuildJob.run(AutoBuildJob.java:204) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:58)java.lang.NullPointerException at org.eclipse.core.internal.filesystem.InternalFileSystemCore.getStore(InternalFileSystemCore.java:104) at org.eclipse.core.filesystem.EFS.getStore(EFS.java:296) at org.eclipse.jdt.internal.core.util.Util.toLocalFile(Util.java:2044) at org.eclipse.jdt.internal.core.builder.ClasspathJar.<init>(ClasspathJar.java:91) at org.eclipse.jdt.internal.core.builder.ClasspathLocation.forLibrary(ClasspathLocation.java:38) at org.eclipse.jdt.internal.core.builder.State.read(State.java:255) at org.eclipse.jdt.internal.core.builder.JavaBuilder.readState(JavaBuilder.java:125) at org.eclipse.jdt.internal.core.JavaModelManager.readState(JavaModelManager.java:2586) at org.eclipse.jdt.internal.core.JavaModelManager.getLastBuiltState(JavaModelManager.java:1365) at org.eclipse.jdt.internal.core.builder.JavaBuilder.getLastState(JavaBuilder.java:367) at org.eclipse.jdt.internal.core.builder.JavaBuilder.build(JavaBuilder.java:150) at org.eclipse.core.internal.events.BuildManager$2.run(BuildManager.java:593) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37) at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:168) at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:202) at org.eclipse.core.internal.events.BuildManager$1.run(BuildManager.java:231) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37) at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:234) at org.eclipse.core.internal.events.BuildManager.basicBuildLoop(BuildManager.java:253) at org.eclipse.core.internal.events.BuildManager.build(BuildManager.java:282) at org.eclipse.core.internal.events.AutoBuildJob.doBuild(AutoBuildJob.java:143) at org.eclipse.core.internal.events.AutoBuildJob.run(AutoBuildJob.java:204) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:58)org.eclipse.core.runtime.CoreException[2]: java.lang.NullPointerException at org.eclipse.core.internal.filesystem.InternalFileSystemCore.getStore(InternalFileSystemCore.java:104) at org.eclipse.core.filesystem.EFS.getStore(EFS.java:296) at org.eclipse.jdt.internal.core.util.Util.toLocalFile(Util.java:2044) at org.eclipse.jdt.internal.core.builder.ClasspathJar.<init>(ClasspathJar.java:91) at org.eclipse.jdt.internal.core.builder.ClasspathLocation.forLibrary(ClasspathLocation.java:38) at org.eclipse.jdt.internal.core.builder.State.read(State.java:255) at org.eclipse.jdt.internal.core.builder.JavaBuilder.readState(JavaBuilder.java:125) at org.eclipse.jdt.internal.core.JavaModelManager.readState(JavaModelManager.java:2586) at org.eclipse.jdt.internal.core.JavaModelManager.getLastBuiltState(JavaModelManager.java:1365) at org.eclipse.jdt.internal.core.builder.JavaBuilder.getLastState(JavaBuilder.java:367) at org.eclipse.jdt.internal.core.builder.JavaBuilder.build(JavaBuilder.java:150) at org.eclipse.core.internal.events.BuildManager$2.run(BuildManager.java:593) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37) at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:168) at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:202) at org.eclipse.core.internal.events.BuildManager$1.run(BuildManager.java:231) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37) at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:234) at org.eclipse.core.internal.events.BuildManager.basicBuildLoop(BuildManager.java:253) at org.eclipse.core.internal.events.BuildManager.build(BuildManager.java:282) at org.eclipse.core.internal.events.AutoBuildJob.doBuild(AutoBuildJob.java:143) at org.eclipse.core.internal.events.AutoBuildJob.run(AutoBuildJob.java:204) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:58)Olivier, yours is a different issue and would deserve a PR of its own. And probably against JDT/Core, as the NPE happens because null is passed as argument to EFS.getStore() (possibly because the resource it obtained the location URI from did not exist).Opened.***has been marked as a duplicate of this bug. ***When starting Eclipse and the workspace is opened, my custom filesystemencounters an error and throws an exception. This exception is not caught andcauses the org.eclipse.core.resources.ResourcesPlugin bundle starter to be interrupted and Eclipse not being started.Stacktrace of my exception:java.lang.RuntimeException: org.eclipse.core.runtime.CoreException:Unauthorized - invalid username and/or password atorg.eclipse.core.filesystem.provider.FileStore.fetchInfo(FileStore.java:255) atorg.eclipse.core.internal.localstore.FileSystemResourceManager.read(FileSystemResourceManager.java:654) atorg.eclipse.core.internal.resources.SaveManager.restoreMetaInfo(SaveManager.java:765) atorg.eclipse.core.internal.resources.SaveManager.restoreMetaInfo(SaveManager.java:746) atorg.eclipse.core.internal.resources.SaveManager.restore(SaveManager.java:637) atorg.eclipse.core.internal.resources.SaveManager.startup(SaveManager.java:1299) atorg.eclipse.core.internal.resources.Workspace.startup(Workspace.java:1883) atorg.eclipse.core.internal.resources.Workspace.open(Workspace.java:1653) atorg.eclipse.core.resources.ResourcesPlugin.startup(ResourcesPlugin.java:367) atorg.eclipse.core.internal.compatibility.PluginActivator.start(PluginActivator.java:31) atorg.eclipse.osgi.framework.internal.core.BundleContextImpl$2.run(BundleContextImpl.java:991)...Note that, according to the documentation, FileStore#fetchInfo must not fail ifthe resource does not exist, however, it is allowed to throw a CoreException ifthere are problems while contacting the file system (in my case the resourcedoes exist).Unfortunately, the FileSystemResourceManager uses FileStore#fetchInfo without catching CoreExceptions. (line 654)I really want to have this bug fixed, because I have no other option than using my custom FileStore class with appropriate CoreException messages.***has been marked as a duplicate of this bug. ***(In reply to)Gert - as a workaround until this is fixed, you may want to have a look at the fetchInfo() implementation inin case it encounters a CoreException, it first checks whether the ResourcesPlugin is already activated. If not (exception while opening the workspace the first time), instead of re-throwing as a RuntimeException it claims that the file does not exist.In case of unavailable remote .project files, this leads to an error message during startup and the project appears closed - but Eclipse comes up. For a detailed analysis of the issue and suggested fix, see.I'd also like to note that because of the improper API in fetchInfo() hiding the checked exception, not only improper EFS providers can lead to Eclipse not coming up; quite contrary, a proper implementation that abides to the API description can lead to this issue if a remote .project file is not available during startup.In my opinion, this should justify increasing severity to Critical (proper implementation leads to Eclipse not coming up at all).The issue described in the bug report is solved by the fix from. The discussion started incan be continued in.This still happens (see recent dup).***has been marked as a duplicate of this bug. ***I am no longer involved in Platform Core development.	12.0
id=208982	REOPENED	Platform	Resources	3.4	PC Windows XP	P3 normal	Platform-Resources-Inbox	2007-11-07 03:58 EST by	Dani Megert	2015-03-12 22:14 EDT (	4 users	3.4 M3Just saw this: IResource.isReadOnly() is deprecated but IFile.isReadOnly() is not . They share the same implementation on Resource though.If this is intended then the deprecation on IResource.isReadOnly() should be better explained. Getting of the deprecation is also a bit painful as one has to first check the resource attributes (see: getResourceAttributes()) for 'null'.	It seems that the method is there on purpose. As you said it would be painful to do a check null. So I would treat it as a helper method for files or folders. The best way would be to just remove isReadOnly from IResource, but we can't do it.Moving implementation from Resource to File and Folder and leaving Resource#isReadOnly deprecated could be the solution.Note that there is no IFolder.isReadOnly().The question really is: should we have non-deprecated IFile.isReadOnly() and IFolder.isReadOnly() or should we simply remove the deprecation again: as you said (and I agree) it is a useful helper, so why deprecate it in the first place. If we go for the first variant then the deprecation comment of IResource.isReadOnly() should say: "read-only flag is only supported for IFile and IFolder. Use IFile.isReadOnly() and IFolder.isReadOnly() instead.The deprecation is intentional. getResourceAttributes() is a better method because it distinguishes the three interesting cases: file is read only, file is not read only, or file does not exist. This is also consistent with how any other file attribute is checked, such as the executable flag (why have a convenience for one attribute but not others?).I think IFile needs a non-deprecated isReadOnly() method only because it's a required method to implement the IStorage interface. Theoretically, we could delete the IFile.isReadOnly() method, but I don't know what this means for clients because one supertype has a non-deprecated isReadOnly() method, and another supertype has a deprecated copy.John, I understand these points but the question remains why to put pain on clients who already know their file exists: why do they need to replace the simple call to isReadOnly() with more complicated code that does not bring any benefit in such situations? In other words: while the deprection is intentional it might not be a benefit for clients.I thought about this again and here are my thoughts and a possible solutions:As John indicates inthe deprecation was intentional in order to advertise the getResourceAttributes() API. Unfortunately almost all calls to isReadOnly() are done on IFile and hence most of the good intention is lost.In my opinion we should decide how important it is to move away from isReadOnly(). If it is important then IFile.isReadOnly() has to be deprecated. If not, I suggest to remove the deprecation from IResource.CreatedProposalIFile extends IStorage as well. I think that one of the reasons to have IFile#isReadOnly() is to override IResource#isReadOnly javadoc. If we remove or deprecate IFile#isReadOnly(), one who wants to use IFile#isReadOnly (thinking about IStorage) will see in the Java editor that the method is deprecated. To be consistent we should do the same in File and add there isReadOnly method. Of course IFile#isReadOnly has to updated.Check the patch.Comment onProposalI don't like the patch. Most clients reference the interface and not File or Resource, hence they will get the right thing if they access IStorage or IFile when following one of my suggested solutions.Actually File is internal class, so it is just an improvement for myself :-) We have two things here.- we don't want people to use IResource#isReadOnly() because we have a new method- IFile extends IStorage and IStorage#isReadOnly() is not deprecatedSo we should- delete IResource#isReadOnly(), but we can't. So we make it deprecated.But it results in - showing IFile#isReadOnly as deprecated, what is wrongSo the soulution is- create IFile#isReadOnly which people can use without warnings with appropriate javadoc referring to IStorage#isReadOnly()It look like I'm trying to workaround java content assist issue. Because doing that (creating IFile#isReadOnly()) I'm trying to avoid showing isReadOnly as deprecated in java editor.Maybe there is another way to achieve that. Maybe we can just change order of extended interfaces in IFile :-) and remove IFile#isReadOnly(). It won't be API change I suppose.As already tried to explain before: if so, then also IFile.isReadOnly() must be deprecated as most clients call this method. IStorage.isReadOnly() is not relevant in this case and can be left as so that clients who call IStorage.isReadOnly() are fine.So, to recapitulate I see two solutions:1. deprecate IFile.isReadOnly() so that clients use the new method2. remove deprecation of IResouce.isReadOnly(). Optionally remove IFile.isReadOnly()Dani, if we deprecate IFile.isReadOnly then it's inconsistent with the IStorage method. I.e., if your whole argument is about consistency, then we can't be consistent with both supertypes, so we can't win no matter what we do. I suggest leaving things as they are.It's the scenario when I write or read code I care about and there I either have a reference to IStorage or IFile. In the IFile case it will be deprecated and I can replace/fix my code. In the case of IStorage everything is green. I don't care about implementations of those interfaces as I am not allowed to implement them anyway.No changes planned.***has been marked as a duplicate of this bug. ***(In reply to John Arthorne from)In practice, the interesting question is usually: Is the file known to be read-only or not? IFile#isReadOnly() answers exactly this question. If the file doesn't exist etc., then it answers false.This is not an interesting consistency, since the read-only flag often has to be checked, but the executable flag is rarely of interest.The only argument that's left is to advertise #getResourceAttributes(). And the solution for that is * @see getResourceAttributes()Seefor further trouble caused by deprecating IResource#isReadOnly().(In reply to Markus Keller from)I agree with Markus and Dani that IResource.isReadOnly should be undeprecated.@see getResourceAttributes() with additional explanation of superiority of getResourceAttributes should be sufficient. getResourceAttributes() does not replace isReadOnly since while it provides power, it at the same time doesn't match convenience of isReadOnly. There are numerous precedents in the API where methods are kept for convenience only.	17.0
id=331753	REOPENED	Platform	Resources	3.6	PC Windows XP	P3 normal	Platform-Resources-Inbox	2010-12-03 04:49 EST by	harishiva	2010-12-19 05:20 EST (	4 users	Build Identifier: I20100713-0800Hi there, I am using Eclipse Helios IDE for C/++ development as well as for customizing it for some custom toolchain. In my application I want to have all my source files under project directory but at the same time I want them to be grouped and show them under specific folders. For this I can use virtual folders and I can import the files to appropriate virtual folders with virtual link. But my problem here is I can not create new files under any virtual folder. Actually I want all source files under project directory and a link is need to be created to this virtual folder. So, virtual file creation would be very useful. Also, while developing or extending a plugins how can I make it to create virtual folders for a project? Which plugin I can use for this purpose? Thanks,HarishivaReproducible: Always	Virtual resources are a platform feature.(In reply to)Virtual folders may contain only other virtual folders or linked resources. If you want to group linked and regular files under a folder, use a regular folder here.You should use org.eclipse.core.resources bundle. To create a virtual folder useIFolder#create(int, boolean, IProgressMonitor) and IResource#VIRTUAL flag.(In reply to)I see different questions/requests in your comment.1) Virtual files, i.e. files that are defined in the .project file, and do not exist in the file system, is not a feature that currently exist in Helios.2) It is possible to simulate having virtual files, by having the files in the first level under the project directory, hiding them using resource filters, then creating linked resources under the virtual folders with the link target pointing to those files.3) If you want create virtual folders programatically from an Eclipse plugins, you have to use the org.eclipse.core.resources API, using the IFolder.create() using the VIRTUAL flag.Does this answers your question?Yes. This answers my questions partially. Thanks for your help.Virtual files here I mean the regular files itself. Actually my project involves source files of different file types. eg: .c, .cpp, .lib, .h, etc., In the project viewer I want them to be groped depending on the file type. I can do this by creating regular folders and importing and/or adding such files under them. But I don't want to create folders in the file system. I was able to do this using the concept called virtual folders. This way I can order files in my project explorer. But I cannot add new files under these folders. I want to allow the end users to add source files under these virtual folders as well as to create new files of appropriate type. But all newly created files should be under main project directory. Virtual folder in the project explorer is just for the ordering purpose.(In reply to)From what I can understand, you want all the files to reside under the project folder in the file system, but to be organized in the Eclipse workspace in a different hierarchy.This is possible by using resource filters to systematically hide the real files from appearing in the workspace (with a 'Exclude all *.c [recursive]' filter), and by manually creating linked resources pointing to those files (with using drag and drop from windows explorer, for example) under virtual folders in the project.There is no way to currently automate have this process.(In reply to)Yes, I want all the files reside under project folder in the file system, but to be organized in the Eclipse workspace in a different folder hierarchy. The hierarchy should be look like as follows:Project Name------------ |_Header Files Folders |_Libraries Folder |_Source File Folders |_Folder A |_Folder BI want this hierarchy to be created when user creates a new project.I should be able to do all file operations on these virtual folders.eg: I should be able create new source files under "Source Files Folder" as well as I should be able to add/delete existing source files under this folder. Reopening this bug as this is a very good feature. If there is no plan to add this kind of feature in near future, please point me somewhere so that I can start work on it and thus I can contribute to eclipse.(In reply to)I'm not sure I understand your use case, and how common it could be.From one hand, you can create a linked folder that points anywhere in the file system, so you can make files and folders from directory foo in the file system to appear in any folder in the workspace project.Then, when you mention that you would like to create new files under the virtual folders, it doesn't make sense in so far as virtual folders don't exist in the file system (they are virtual), so since real files need to have real parent, they can't be created under a virtual folder.But if you use linked folder, then you can create files and folders under it.Regarding your point of having the hierarchy created when the user creates a new project, it sounds to me that this would be something that would be in domain of the new project wizard, such as the CDT new project wizard.Alternatively, you could create a "new" wizard (such as the new "class", "folder", "file", etc...) to automate the creation of the hierarchy setup you are describing.So far, I don't see something that cannot already accomplished using the existing core.resources primitives.Let me know if you think I'm missing something.	7.0
id=168091	REOPENED	Platform	Resources	3.2	All All	P3 enhancement	Platform-Resources-Inbox	2006-12-14 12:33 EST by	Mike Whittaker	2007-04-27 09:49 EDT (	0 users	An external tool cannot operate on files 'down' from a project root ifthere are any linked folders, since it has no way of expanding the linked folder name.The only method is to explicitly state linked folder names as ${} variables in thetool command line, which then makes the tool definitions project-specific,somewhat defeating the object.It would be useful if there was a mechanism to allow an external tool to dothis expansion.	I'm still not quite following. Are you talking about expanding linked folders that are provided as arguments to an external tool (In Run > External Tools > External Tool... dialog)?Closing. Requested details not provided.Thought was to provide 'variables' that could be used in the tools command line that would be expanded in the same way as those used in e.g. the Project Build settings, to refer to workspace- and project-relative resources.Scratch #3, I wasn't thinking clearly !Say you want to set up an external tool to Lint a project.The project may contain linked subfolders as well as 'normal' ones.From the Eclipse project point of view, you can just navigate downthe hierarchy if you want to refer to any file in a subdirectory.However if you want to run a tool on the project, the tool cannotjust go down the hierarchy since when it hits a linked folder it cannot resolve it - that depends on Eclipse's knowledge.The only way I could come up with would be to (temporarily?) insertsymbolic links into the project directory structure to point to the linkedresources - then the tool would be unaware of any difference between linkedand normal folders. But this is a kludge.So I was soliciting views on how else you might acheive the required result,i.e. running useful external tools on projects containing linked folders.A magic tool-runner app akin to fakeroot, that ran the external tool and madethe linked folders appear to be real ?Reopening due to response. I don't have an answer on hand, but I'll keep this open to track discussion.	5.0
id=336734	REOPENED	Platform	Resources	3.7	PC Linux	P3 enhancement	Platform-Resources-Inbox	2011-02-09 11:51 EST by	Ralf Sternberg	2011-03-17 12:25 EDT (	7 users	Most html files declare their encoding in a meta header like this: <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"/>This encoding often differs from the source file encoding set on project or workspace level. Typical examples are about.html or package.html files in Eclipse projects with charset=ISO-8859-1", when the Java code in the projects is encoded in UTF-8.Currently, the encoding of all *.html files seem to be inherited from container. It would be great if it could be derived from the content.	Though we parse the content for content-type, we don't do it to determine the char set. I guess this would be a new extension point and should be provided by the Core Resources, rather than Platform UIThis can be handled by our existing "content description" mechanism, which includes both encoding and content type. We currently only provide content describers for XML, rather than HTML. Nitin, does WTP already have an HTML content describer?Yes, and it does use the meta tag's information.Thanks Nitin. This functionality appropriately belongs in Web Tools, which you can install if you want this capability. We have no HTML tooling in the platform so providing HTML content analysis in the core platform doesn't make sense.Thanks. Do I have to install Web Tools entirely to get content analysis for html, or can you point me to a single bundle that does it?(In reply to)The functionality lies in the org.eclipse.wst.html.core bundle.***has been marked as a duplicate of this bug. ***I think we should reconsider this. XML tooling is also not provided by the Platform but we ship the XML content type and we also ship HTML files. And it's important that the encoding is right even when opened with the Text editor.Maybe we could ship the content type definition from 'org.eclipse.wst.html.core' and WST would remove its own definition? We might even think of keeping the ID, so that those referring to the WST content type continue to work. We did similar things when moving commands to lower layers.(In reply to)All of the existing detection support lies in the org.eclipse.wst.html.core.internal.contenttype package in /cvsroot/webtools under sourceediting/plugins/org.eclipse.wst.html.core/src/org/eclipse/wst/html/core/internal/contenttype , except for the contents of org.eclipse.wst.html.core.internal.encoding which build on it for working with IDocuments.(In reply to)I think that core.runtime and resources should not provide content types. We should keep this set as minimal as possible at least. My opinion is that each application should decide what is the set of supported content types. So if we decided to provide the HTML content type, it should be done on the application level i.e. Eclipse IDE.It makes sense to me.Other similar content types are provided by core.resources or core.contentype itself.PW(In reply to)I don't really buy the argument that since we support XML we should support HTML. Yes it is important that the editor get the correct content type when opening a file, but that is true for any time of file. XML is special because it is such a widely used format for data serialization. The framework itself reads and writes XML files in many places. This is why for example the Java class libraries include XML parsers but not HTML parsers.It's not just a matter of including a content definition. We would also need to include a minimal HTML parser, and HTML is far less structured and uniform than XML. We would need to support XHTML, HTML 5, etc. I suspect this is a fairly big chunk of code to include and maintain.The necessary analysis for HTML is a lot more complicated than for XML. For XML, you can use a standard parser and look for the 'encoding' attribute in the prolog. For HTML, the encoding is burried deep in the document and is much harder to get right (and parsers are even advised to "guess" the encoding), see e.g.:Maybe a low-cost solution could be shipped with the platform with priority="low" and alias-for="<the WST content type>", similar to the basic definition of *.properties in org.eclipse.core.contenttype/plugin.xml?By low-cost, I mean a simple case-insensitive ASCII parser that looks for <htmlfollowed by <headfollowed by <meta\s*http-equiv="Content-Type"\s*content="text/html;\s*charset=([^"]+)"and gives up at </head>.Yes, that would be enough along with a describer that provides the encoding.(In reply to)To avoid scanning too much, also stop on <body, <p, and after about 10KB of text.	15.0
id=368614	REOPENED	Platform	Resources	4.2	PC Windows XP	P3 major	Platform-Resources-Inbox	2012-01-15 03:55 EST by	Ayah Magdy	2012-03-06 10:00 EST (	2 users	Build Identifier: 3.7When you try to move a read only file a confirmation dialog pops saying its is a read only file do u want to move it (yes no cancel)If u press cancel an exception will be thrown Reproducible: AlwaysSteps to Reproduce:1. choose a read only file2. right click and choose move3. when the dialog pops up press cancel	Please attach your workspace's log file.Is this related to your other bug ()? This also has nothing to do with PDE.Closing as INVALID - Needs more info. If you can attach your workspace log with the exception, please reopen and we will look for who this belongs to.Sorry I got the steps wrongwhen u try to drag and drop a read only file a dialog occurs asking for confirmationIf you press cancel another dialog comes up with a title Drag & drop problem with an exception java.lang.reflect.InvocationTargetException in the detailsNo log occursMoving to Platform for commentSorry, I can't reproduce. Are you going to d'n'd a read-only file from outside Eclipse or between folders in Eclipse workspace?I drag and drop a file from eclipse's browser project explorerI am using this browser in a rcp project when i try to drag and drop a read only file a confirmation dialog comes up when If I press cancel the exception occursI tried to do this in eclipse but there is no cancel button in the confirmation dialog	6.0
id=199518	REOPENED	Platform	Resources	3.3	PC Windows XP	P3 normal	Platform-Resources-Inbox	2007-08-09 23:16 EDT by	John Camelon	2009-06-23 12:00 EDT (	4 users	Discovered in testing Jazz SCM ... We have test plugins which programatically create projects in a kind of sloppy way. .project files get added after the project directory is created. At a later point, the .project file gets removed through user actions, but the project directory remains. After some time, the .project file comes back, as for all intent and purpose, this directory still looks and feels like an eclipse project, however the item does not show up in the navigator (we see it in another view we have to track deltas in the EFS).What appears to happen is eclipse creates the .project file through the EFS layer, but does not notify the resource tree. Refreshing the resource tree from package explorer (or navigator) fixes the problem.	Could you paste in a snippet of code which does what you described? It would be easier for us to reproduce the problem then. Or maybe we could even write a test case based on that. Thanks in advance.I'm curious why you do that. Is it necessary to delete .project file instead of just using API?Anyway I can't reproduce the issue using the steps. It would be great, if you can attach the snippet or the test case as Tomasz mentioned. If the bug is not an issue now, please add an appropriate comment, please.John, please reopen it, if you have more details and the required test case. So far this is WORKSFORME.CreatedSample action that demonstrates the problemThe attached plugin demonstrates the problem. Steps:create a plugin project.open the package explorerselect the build.properties filerun the "Replace with folders" action.Observe: on disk, build.properties is now a folder. However no amount of refreshing of the package explorer causes it to recognize this.Test case attached.This new problem seems to be completely different from the original description. This file>folder problem wasfix in 3.4 M1.CreatedTest plugin to demonstrate the problemYou're right. Here's a new plugin that demonstrates the problem this bug was talking about.Select a java project and run the "Delete .project and snapshot" action.Observe that it fails because the .project gets created in the filesystem by the snapshot, but the resource tree is not notified about it.This is intentional (SaveManager#saveMetaInfo(Project,IProgressMonitor)). If we discover the .project file for an existing project is missing but we have the project description in memory, we write it out to avoid the information getting lost. This happens in either IWorkspace#save or IProject#close which are not resource-changing operations, so updating the tree at that point is not permitted. A message is written to the log when this happens on snapshot or project close to describe what happened.But why couldn't it at least schedule a job to update the tree later, so that it isn't out of sync with the filesystem without the user going outside of eclipse?	9.0
id=404080	REOPENED	Platform	Resources	4.2.2	PC Mac OS X	P3 enhancement	Platform-Resources-Inbox	2013-03-21 16:30 EDT by	gossi	2013-03-26 12:43 EDT (	2 users	When creating an eclipse plugin, one might add support for a nature and a corresponding builder. Adding a builder programmatically requires some lines of code, I followed this tutorial:However, I would liked to disable/enable the builder programmatically for a given project, the same as if you'd to this in the UI. Unfortunately I can't find an API to do that. So I looked into the .project file to inspect how a deactivated builder is stored. Which is not as simple as setting a flag. I was able to derieve this takes a lot of steps to reproduce using given eclipse APIs for that.Maybe I didn't put enough research into that, however can't find a proper way. Anyway, could there be a public API that serves adding, removing, enabling, disabling and checking whether a given builder is present and if that builder is enabled?Sth like (in short):IProjectDescription.getBuilderConfiguration() which returns an IBuilderConfiguration.IBuilderConfiguration:- add(String ID)- remove(String ID)- has(String ID) : boolean- get(String ID) : IBuilderIBuilder:- setEnabled(boolean enabled)- isEnabled() : boolean+ what's worth putting here (such as stuff from org.eclipse.core.internal.events.InternalBuilder)Thanks for your incoming feedback.gossi	(In reply to)You should use IProjectDescription#setBuildSpec and #getBuildSpec..Hey Szymon,I'm already using these methods. However, there is no API to enable/disable a builder (ID given) nor to check wether a builder is installed (either in enabled or disabled state).I'm proprietarly checking wether my builder is installed. However, I have no idea whether this is correct (as I'm traversing the .project with eclipse API methods) nor do I have the ability to simply enable/disable a builder. And how much can I be safe on my logic for checking whether my install methods works or if in any future eclipse release, this will be changed?So, here is my code checking if my builder is installed:private boolean hasBuilder() { try { for (ICommand cmd : project.getDescription().getBuildSpec()) { // activated builder if (ComposerBuildPathManagementBuilder.ID.equals(cmd.getBuilderName())) { return true; } // deactivated builder if ("org.eclipse.ui.externaltools.ExternalToolBuilder".equals(cmd.getBuilderName())) { Map<String, String> args = cmd.getArguments(); if (args.containsKey("LaunchConfigHandle")) { String launch = args.get("LaunchConfigHandle"); if (launch.contains(ComposerBuildPathManagementBuilder.ID)) { return true; } } } } } catch (CoreException e) { e.printStackTrace(); } return false;}where I think, this should be a simple API call: IProjectDescription().getBuild***().has(ID); which handles the eclipse logic internal.	3.0
id=407888	REOPENED	Platform	Resources	4.3	PC Mac OS X	P3 normal	Platform-Resources-Inbox	2013-05-13 10:19 EDT by	Dani Megert	2016-05-11 04:13 EDT (	1 user	junit.framework.AssertionFailedError: 4.0at org.eclipse.core.tests.internal.alias.BasicAliasTest.testDeepLink(BasicAliasTest.java:716)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:655)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:310)at org.eclipse.test.CoreTestApplication.runTests(CoreTestApplication.java:36)at org.eclipse.test.CoreTestApplication.run(CoreTestApplication.java:32)at org.eclipse.equinox.internal.app.EclipseAppContainer.callMethodWithException(EclipseAppContainer.java:587)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:198)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:354)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:181)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:636)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:591)at org.eclipse.equinox.launcher.Main.run(Main.java:1450)at org.eclipse.equinox.launcher.Main.main(Main.java:1426)at org.eclipse.core.launcher.Main.main(Main.java:34)	Seefor another test failure in BasicAliasTest.This test hasn't failed for a long time. Closing for now.Failed again in I20160510-2000:	3.0
id=454072	REOPENED	JDT	Core	4.3.2	PC Windows 7	P3 normal	Platform-Resources-Inbox	2014-12-03 20:42 EST by	NINGAREDDY MODASE	2014-12-04 04:27 EST (	1 user	CreatedRename Resource Exception error dialogFor example I have tried to enter following name"rdstdtysdrtydrtydry45653213454^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$88888888888888888888888888888888888888@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@;;;;;;;;;;;;;;;;;;;;;;;;;$$$@@@@@@@@@@"It accepted this name and latter I got the error "Rename Resource Exception"After click on OK, to the error dialog, the whole workspace got corrupted	I couldn't rename and got the exception at the time of re factoring.Sorry, I don't understand what do you mean it works for you?The problem starts after you click on "OK" buttonAfter this your project got renamed and its contents were deletedLet us trace the steps.1) You create a project called Test.2) You right click and say refactor and then enter a name > 256 characeters.3) You hit Okay.4) Rename is complete.On your FileSystem is the Project under the new name or old name?Your renaming (refactoring) is not not complete and you get a exception.Thanks1) You create a project called Test: YES2) You right click and say refactor and then enter a name > 256 characeters. YES3) You hit Okay. YES4) Rename is complete Got error dialog saying rename encountered problem Click on "OK"On your FileSystem is the Project under the new name or old name?I am using Eclipse Kepler SR2+Java 8Assigning it Platform resources.After clicking on the exception dialogue box the project is in stale state. Although the Package Explorer shows the project as renamed the project has not been renamed on disk. We observe the same behavior with Project Explorer as well.Thanks	5.0
id=476448	REOPENED	Platform	Resources	4.5	PC Linux	P3 normal	Platform-Resources-Inbox	2015-09-02 10:35 EDT by	Marvin Fröhlich	2016-03-15 10:14 EDT (	2 users	I have the following code to save a file and maintain local history.###################################################IFile file = project.getFile( filename );InputStream in = new ByteArrayInputStream( newContents );file.setContents( in, IFile.FORCE | IFile.KEEP_HISTORY, null );###################################################After that there will be a local history entry with the current time, but it will simply contain the NEW file contents. And I think, this entry only exists, if it existed before (with older timestamp).Now I have the following test code.###################################################IFile file = project.getFile( filename );file.clearHistory( null );InputStream in;// Write the current contents back to the file to force a new local history entry.{ ByteArrayOutputStream baos = new ByteArrayOutputStream(); transferBytes( file.getContents(), baos ); in = new ByteArrayInputStream( baos.toByteArray() ); file.setContents( in, IFile.FORCE | IFile.KEEP_HISTORY, null );}in = new ByteArrayInputStream( newContents );file.setContents( in, IFile.FORCE | IFile.KEEP_HISTORY, null );###################################################Using this code the file won't have any local history.There seems to be something wrong. Or I completely misunderstood, how the local history works.	This doesnt look like PDE API tool problem. If you think this is an eclipse issue, please reopen and assign to appropriate component.I'm sorry, I think, this is a misunderstanding here. The component PDE should be correct unless I didn't do anything wrong. But the API and javadoc are pretty clear here.Do you need anything else from me? There is no more coding though.This line here should lead to the creation of a local history entry, shouldn't it? But it doesn't. Hence there must be something wrong in PDE.file.setContents( in, IFile.FORCE | IFile.KEEP_HISTORY, null );Should it be on component Platform Resource?Which is the class name you think the problem lies ? Can you give the full package of that class?I am working on an instance of org.eclipse.core.internal.resources.File.IFile is org.eclipse.core.resources.IFile.project is an org.eclipse.core.internal.resources.Project. The variable is of org.eclipse.core.resources.IProject.The rest are all standard Java classes. Since the code is pretty small, there's little room for bugs in other areas.My guess is, that file.setContents() doesn't properly handle local history.That is in Platform Resource component and not in PDE.Ok, then this is properly placed now. Do you need anything else to get this ticket going?Szymon, can you please comment if this is a bug.Any news here?	8.0
id=109004	REOPENED	Platform	Runtime	3.2	All All	P3 enhancement	platform-runtime-inbox	2005-09-07 17:58 EDT by	Michael Levi	2006-08-09 14:53 EDT (	3 users	The narrow need to replace the current Eclipse logging runtime with java.util.logging. This is not a requirement for an API change but simply a mechanism for changing the runtime.A suggested solution would be to provide an abstract factory that would allow the use of adapters for arbitrary logging implementations based on some property. I would suggest the default be java.util.logging. A set of adapters would be nice and should probably include the Eclipse, java.util.logging and log4j.	There are no such thing such as IEvent in the eclipse runtime. Are you sure youare reporting the bug against the right component?Please re-open with more details.Sorry for writing such a confusing bugzilla.The point that I am interested in is that we would like to be able to have all logging events expressed through the java.util.logging infrastructure rather than through the current Eclipse default model of creating and managing a log file within Eclipse code. Once java.util.logging is the Eclipse logging runtime it will become possible to provide a common, standards based logging management framework and to leverage other components designed to manage or leverage java.util.logging. An extension of this change would be to allow the substitution of arbitrary logging runtimes, making java.util.logging the default.This request does not imply that the logging API and IStatus API need to be changed.So some other folks inare proposing that we use Common Base Events as a logging strategy. Punting our current homebrew logging mechanism for something more flexible/standard etc is attractive. We do have some things to consider however. - There are a mess of people who use the current logging API. That cannot change- There are some tools and mechanisms that understand the current log format, location, ... That can change but we ought not do it gratuitously- There are some unique logging requirements wrt startup (logging in startup.jar and in the framework) before we know where to write the log. Normally it is in the instance area but that location is not known for some time. A new mechanism must cover that- Whatever solution we use must not put undo JRE requirements on the plugins using the mechanaims. For example, there are many plugins that should run on the J2ME Foundation class lib (not to mention that the framework itself must run on the OSGi minimum execution environment).So, having said all that, can you come up with a concrete proposal for exactly what you want to see happen here?	3.0
id=79818	REOPENED	Platform	Runtime	3.0	PC Windows 2000	P3 enhancement	platform-runtime-inbox	2004-11-30 16:11 EST by	Pascal Rapicault	2010-06-07 10:31 EDT (	16 users	Bugs to track the discussion about adding a markup to express bundle dynamiccapabilities. Initial RFC is at	The section on Default Values says:>This seems to be the opposite of what we really want. It seems to me that it isnot safe to assume that a plugin will do the right things unless it specificallyclaims to do so. Basically, a plugin should be required to state explicitelythat it IS dynamic enabled before it can be treated as so and thus can beuninstalled dynamically with no restart needed. This is a straightforwardpracticality in the face of the fact that the vast majority of existing pluginsthat do not have manifests are not going to be safe to assume they are dynamic. The default value for manifests generated from plugin.xml should be that theyare not dynamic enabled. I.E. - this header should not be added when themanifest is generatated automatically at plugin load time.Thus, the only way a plugin could be considered dynamic enabled is if it is anew (v3.0) plugin with an actual manifest of its own and with theEclipse-Dynamic: header already set.It might be reasonable to have 'enabled' be the default value in manifestsgenerated in the PDE when developing a new plugin.Am I being too cautious?Agreed. Default should be conservative.In fact, I suspect that many/most plugins are NOT Dynamic Enabled as they likely do not clean up after themselves by removing listeners and removing things from ImageRegistries etc.On a different note, I am not a fan of adding to the plugin.xml. Without that however we will be forcing people writing dynamic plugins to write manifest.mf files (They need a way to add the dynamic markup). Our initial position on plugin.xml vs manifest.mf was that the current plugin.xml would be preserved but new things would go in the manifest. The impact of this needs to be clear to people.1. Don't you need a value for 'not enabled' and one for 'unspecified'?Default would be 'unspecified', which the platform could take to mean notenabled or enabled depending on how trusting it wants to be (see earlier comments).2. I'd like to be able to specify dynamic-enabledness without a manifest.mf.Maybe in a special block like the version number uses, or an optional attributeon the plugin element. Justification: So far I've avoided using manifest.mf andgiven it's subject to change (for example as OSGi adopts Eclipse-isms into thestandard) and it's marked as an 'advanced feature' and it's more complicated toexplain to new plug-in developers I'd like to keep avoiding it if possible. Currently I'm content for manifest.mf to be completely behind the scenes. Makingtoo much stuff API will tie the hands of future platform-core developers.How do you propose we handle "normal" OSGi bundles? These are bundles that have been developed for other OSGi frameworks. A majority of these bundles ARE dynamic aware and never require a restart when bundles are installed/updated/uninstalled. These bundles will not have the Eclipse-Dynamic header and therefore will not be dynamic aware according to the default value of the Eclipse-Dynamic header. Would configurators/installers force a restart when these bundles are updated/installed/uninstalled? Or do we only pay attention to this header when a bundle has an extension or extension point?Peter Kriens said:I think the default is reversed. OSGi bundles are by default dynamic.It is unlikely that OSGi bundles, which work perfectly OK underEclipse, would not be seen as dynamic.An Eclipse-Static header seems to make more sense because you couldautomatically add it when you generate the manifest from the plugin.Kind regards, Peter KriensI just posted an updated version of the document.The changes are around the default values.Here is a recap: - unspecified value added - pure osgi bundles will be considered "enabled" to reflect the osgi reality. - 3.0 plugins with a manifest should review the code and set the value - 3.0 plugins with a plugin.xml (manifest being generated) default value is"unspecified"There will be no support in the plugin.xml. Marking dynamic capability is onlyinteresting for people writing dynamic plugins and we consider that they shoulduse the manifest which is the new way of expressing dependencies. Moreover PDEis likely to provide first class edition support for manifest.mf in 3.1 to blurthe distinction even more.There are currently many eclipse plugins which are addition aware, so this proposal will force all of them to use a manifest.What's wrong with adding another optional attribute to the <plugin> element in plugin.xml ?Hummm... plenty of reasons let me see:- Plugin.xml is history <g>- If the syntax of the plugin.xml is changed a lot of code will have to be changed. - Tools willing to use those tags they will have to be able to understand both plugin.xml and manifest.mf. Note that parsing XML is heavier than reading a manifest for which helper class exists.- Having the markup in both place is confusing.- PDE provides a nice editor that seamlessly allow me to edit the plugin manifest (plugin.xml and manifest)okay, so let me summarize my interpretation of the spec so far based on yourlatest changes.Define a 'pure OSGi bundle' as a bundle without a plugin.xml.Define 'eclipse plugin' as a bundle with a plugin.xml. It may or may not have amanifest.mf.Define a 'modern eclipse plugin' as an eclipse plugin with a manfifest.mf.[Q: What about plugin that has an <?eclipse version="3.0"?> tag, but nomanifest.mf? How is that to be treated? I'll assume like a legacy plugin.]For pure OSGI bundles, the default value is assumed to be 'enabled'. Are theyalso assumed to be addition/deletion aware?For modern eclipse plugins, they should indicate the Eclipse-Dynamic: header inthe manifest. This will be inserted by the PDE at development time in thefuture. Can be manually added/changed by the developer otherwise. It isexpected that usually modern plugins will use some combination of 'enabled','addition-enabled' and/or 'deletion-enabled', but some might set 'unspecified'explicitely. If the manifest.mf is there, but this particular value is notspecified, then the default value is what? Enabled? Unspecified? Myconservative streak says it should be Unspecified.For legacy eclipse plugins, when the manifest is auto-generated duringload-time, the default value will be 'unspecified'.USAGE:If the value for a bundle is 'unspecified' then the bundle should NOT beconsidered able to handle dynamic changes to its dependency scope within theconfiguration. That is, if one of its dependencies or dependents getsadded/removed, or if this bundle itself gets added/removed, then a restart wouldbe assumed to be necessary.If the value for a bundle includes 'enabled' then the that bundle may beadded/removed without a restart, provided all its dependents/dependencies areaddition/deletion-enabled.If the value for a bundle includes 'addition-enabled' then that bundle is okayif a dependent/dependency is added.If the value for a bundle includes 'deletion-enabled' then that bundle is okayif a dependent/dependency is removed.Mel let me first refine your description.There are mainly two types of things we are dealing with:1) pure osgi bundles2) plugins, for which there is two types (whether <?eclipse version="3.0"?> is present is irrelevant) a) plugin with a plugin.xml only (for example some 3.0 and all the 2.1 plugins) - legacy plugins b) plugin with a manifest.mf and a plugin.xml - modern pluginsPure osgi bundles will not have the Eclipse-Dynamic header and we can not expect to be able to modify them. After all, they just happen to be running in eclipse. The idea I was trying to capture in the document is: "it is recommanded for tools to consider pure osgi bundles as dynamic enabled". "addition-aware" or "removal-aware" are meaningless in this context. Note that if it helps a tool to consider other values as default, it is up to it.A modern plugin that would not have specified a value would fall under the same category than a pure osgi bundle. That's why in the proposal, it is recommanded to check the values of the manifest.mf. Of course here again, since those values are advisory a tool can decide otherwise and do more check. Note that we expect that all of the RCP plugins will have this tag.Maybe the proposal should force people that have a manifest to set the value as a step to move to 3.1?For legacy plugins the value will be set to 'unspecified' by the manifest generator. It is the only case where actually a value is "forced" instead of being indicated by a user.In complement of defining the new header the goal of the document is to define a rough guideline on how to deal with the default cases, however this can be refined by every tool. That's why I'm commenting on the usage/interpretation you are doing of the values. Of course it would be best if everybody agreed :-)In addition to Pascal's: we have done this (require bundle manifests)during the 3.0 cycle already for selective plug-in activation. PDE plug-inmanifest editor requests the developer to start using a MANIFEST.MF in order forhim/her to take advantage of selective activation support (see the "Runtime"tab, "Plug-in Activation" section).True but selective plug-in activation is much more esoteric than dynamicawareness. Every plug-in currently running in the system will need to be markedas addition- and removal- aware in order for the Update manager to upgrade analready installed feature without restarting the workbench, right? Which meansif we ever want Update to do this (I do), then every plug-in in the Platform SDKplus every plug-in the user has installed (Perforce team provider, XML editor,whatever) will need to migrate to manifest.mf even if it didn't actually need acode change. That seems harsh. Is manifest.mf and its syntax even considered API?Every plug-in that can actually react properly to dynamic changes. I assumethat, at this moment, many are not, so they do not require any changes. Making aplug-in dynamic is not a trivial task in many cases, so migrating to using abundle manifest should not be the main problem.The manifest.mf syntax is defined by the OSGi spec, so it sure is not just animplementation detail. AFAIK, those headers added by Eclipse itself (the onediscussed here and the Eclipse-AutoStart for instance, among others) areintended to be API, as well.We imagine that at some point in the future, all plug-ins have plugin.xml filesthat describe their extension and extension points only (seeorg.eclipse.core.runtime's), if they have any, and all other description isspecified in bundle manifests. For that to happen, better/more complete toolingfor bundle development is necessary, and that is planned.To emphasize Rafael last point: If a plug-in is marked as "enabled" or *-aware, it is a strong statement and any incorrect behavior (leaks, registry not tracked, etc.) will be a *bug*.Therefore marking a plugin is *not* a thing you just so it avoids restart. It is somehow an API statement of the behavior of your plugin.Note as well that there is no plan to make the full SDK fully dynamic-aware (it is however probably 'enabled'). I think the best we can hope for is to have the RCP SDK fully dynamic.Regarding- I don't see that every plugin in the runtime would needto be additiona/deletion aware in order to support adding/deleting a bundle. Only the bundles within the dependency scope of that bundle (i.e. - those thatcan see / be seen by the particular bundle) would need to be aware.A few points:- re:I actually doubt that many plugins are "enabled". Being enabled means that plugins correctly unhook listeners etc when they are stop()'d- re:The dependency scope does not capture the extension/extension point interactions. There is no need to say that A depends on B if A contributes an extension to B etc etc.Good point Jeff - in my mind I was including the implicit dependency ofextension point usage. However, how 'hard' of a dependency this might be ispretty variable. How do we characterize this? It seems like this should beresolveable.It would seem an overly onerous requirement to insist that the entirety of theruntime is addition/deletion aware in order to add/delete a plugin (that haslimited scope of interaction within the runtime). In some sense, as Pascalindicates, this is up to the tooling to decide how to handle. However, weprobably should establish the basic rules and algorythms that all tooling wouldexpect to conform to.I agree that it would be good to refine this. We should be able to do some matching for example, if the plugin being added does not have any extensions then the need for the others in the system to be dynamic aware is *reduced*. If the plugin being added contributes extensions only to plugins which are aware then again, the need is *reduced*.I highlighted the *reduced* because enablement and awareness are not only registry related. For example, if some plugin gathers up and retains a list of all other plugins that are installed and is not aware, then adding/removing other plugins will put it in an inconsistent state. If the author of that plugin doesn't care about this then they can mark themselves as aware.In effect, the markup (or lack of) indicates whether or not they want to request a restart when things change.Summary: There are some things which could be done but they will be imprecise and incomplete. The question we have then is "is the complexity of doing, managing and explaining this worth the less than optimal results?"Re:and:Take a plugin P that defines an extension point EP. Assume that P cannot process extensions to EP dynamically (i.e. if new plugins get installed and contribute extensions to EP, P will ignore them).To behave correctly, P cannot declare it is addition-aware.So, based on this, any installation containing P is doomed to be restarted upon installing any new plugin, even though those plugins would have nothing to do with P.To me, it looks like addition-aware should imply that a plugin is ok with installing new plugins that extend it.However, if plugin relationships are to be looked at, the arguments inare not all valid, as plugin.xml will have to be parsed and looked at.API's:Do you plan any API's for install agents (such as update manager)? For example, update manager could create a "virtual configuration" that includes the newly installed/uninstall/updated plugins, and the runtime can be asked whether this configuration can just be "applied" without restarting, etc.One thing that has been missed in the usage of the tag is "when do we do theanalysis?". Do we do it before even installing (provisionning) the plugin intoosgi, or do we do it after the installation (and refresh).In the first case: doing a full analysis of the extension / extension pointmodel does not seem to be tractable, since a plugin registry would have to berecreated. In the second case it would be possible to have all the information aboutextensions and extensoin points but I'm not sure we would gain a lot from it.Indeed even though it is true that extensions are not tight to bundleprerequisite, the reality is that a vast majority of plugins require the pluginto which they contribute an extension.Another thing that has been omitted in the tooling conversation is the state ofthe bundles (mainly ACTIVE or not). For example it is probably okay to install aplugin if its prereqs are not started.I've tried to come up with a table indicating whether or not the system shouldbe shutdown if a plugin B was installed and required the plugin A (Bcapabilities are in rows and A in columns).Y indicates that the system must be shutdown and N that it can be kept running.The first letter captures B' addition and the second its removal.For example, the second row, first column indicate that you do not have torestart when B (an enabled plugin) is added and requires A (a add-aware onlyplugin). It shows that when B goes away the system has to be shutdown.A \ B enabled add-aw rem-aw allenabled Y(1) Y(2) Y(1) Y(2) Y(1) Y(2) Y(1) Y(2)add-aw N Y(2) N Y(2) N Y(2) N Y(2)rem-aw Y(1) N Y(1) Y(4) Y(1) Y(4) Y(1) Nall N N N Y(4) N Y(4) N N1) A will does not see B coming 2) A will not see B leaving 4) B won't clean up after itself since it is not enabledAbout the API, org.eclipse.osgi.service.resolver.State andorg.eclipse.osgi.service.resolver.PlatformAdmin should help you to figure outthe dependencies and do the computation. PDE core and PDE build have code thatalready uses it.I updated the document. It includes changes in the section to compute thedefault values and the way tools should behave.Thanks, Pascal. This draft looks real good.Is everybody happy here?I'm planning to start tagging the RCP plugins for M5, and provide snippets ofcode on how to use the values for M6 (unless someone already implemented itbefore? :-)The defaults in the document are not clear. For example, what is the value for a plugin with just a plugin.xml? I know the converter will generate one but what is it? Can you post a table/list that has all the cases with the defaults.The proposal has been updated with an explicit list of values.I'm not sure this will happen for M6.need to consider the API implications wrt M6 API freeze. We should talk to Jim about adding this after M6.I was not thinking on introducing new APIs for that purpose in 3.1.(except themarkup in the manifest).My goal here was to provide a snippet of code for people to use as a base.This won't be addressed in 3.1It seems that there is no plan to implement this. Please feel free to re-open if there is still an intention to implement this.***has been marked as a duplicate of this bug. ***Reopened based on interest expressed in.***has been marked as a duplicate of this bug. ***	34.0
id=89304	REOPENED	Platform	Runtime	3.1	All All	P3 normal	platform-runtime-inbox	2005-03-28 18:16 EST by	Klaus Wenger	2005-04-12 14:30 EDT (	0 users	as we all know, there were some major changes when OSGi was introduced intoEclipse 3. one of them being the removal of the URL-handler extension point'org.eclipse.core.runtime.urlHandlers'. that introduces one issue with makingcustom URL handling available universially. the new URL handling services areregistered by code and not by declaration. this would require the definingplug-in to be able to register it before any other plug-ins may create URLs of thatparticular type. the "platform:/resource/<path>" and"platform:/plugin/<symbolic-name>" get registered by the platform plug-inalright, but how can any lazy loaded plugin do so w/o the hack of becomingUI-dependent and using the org.eclipse.ui.startup extension point?	What you can do is have a very small bundle that only register your URL handler. This bundle will then be started using the start level service.Hello Pascal,with start level service, do you mean the "Eclipse-AutoStart" property of theMANIFEST.MF? I tried that and the Plug-in would not be started at Eclipsestartup time. Anything else that has to be observed?This seems like a legitimate concern. You can do it using the start levels but thta support is really only available if you are using the osgi.bundles list. There are no other convenient ways of specing the start level.Without that, people cannot use URL access/creation as an entry point into their plugin's logic. for example, register the handler declaratively and then start the plugin when the URL is actually used.So we could either1 fix the world so using start levels is easier2 add something to handle the URL case (e.g., revive the extension point)Personally I'm in favour of something simple for #1.Reopening with no promises for 3.1What you do have in mind?In later version we will have declarative service that will overcome thatproblem as well.I have #1 in mind. perhaps a way of a plugin stating its prefered start level in its manifest. There may already be something for this in OSGi thta we can use.There is no markup available in OSGi to specify the startlevel a bundle should use. A bundle developer does not know what the start level should be in the context of an installation. In an eclipse installation we use a convention for what the default startlevels should be for all the installed bundles. But this default can be changed. Also setting a startlevel != starting a bundle. The bundle must still be started by someone (Bundle#start must be called). It seems like what you want is to ensure that a particular bundle is started before the eclispe application is run. This would allow the bundle to register its URL handler before the rest of the system is started. This requires two things1) Set the startlevel of the bundle to a startlevel that will allow it to start before the other bundles in the system (maybe we could set it to the same startlevel as core.runtime)2) Make sure the bundle is started before the application is run.Do we need markup in the bundle manifest to specify these type of settings?Actualy I am taking back my. bundles don't have any understanding of how they will be used. I guess they could give a hint but... If there were a hint it should be relative to the default level e.g, "before" or "after".	7.0
id=114269	REOPENED	Platform	Runtime	3.1.1	PC Windows 2000	P3 enhancement	platform-runtime-inbox	2005-10-28 19:01 EDT by	Ian Graham	2014-04-24 11:41 EDT (	2 users	I realize that the Job doc says "There is no guarantee that jobs of one priority will be run before all jobs of lower priority." However, the reality seems to be that priority has no effect except for distinguishing DECORATOR from all the other priorities. Unless a job has DECORATOR priority it just seems to get run in the sequence in which it was scheduled, and maybe that's only because of a minimum startup delay that gets inserted.So I'm now going to have to do some complicated scheduling when a priority-based approach would have been good enough for my purposes.Although I don't need a guarantee, something approximately in order would still be really useful.	CreatedJUnit Plugin test that shows effects of priority on job schedulingI've attached a JUnit Plugin test that shows how little effect priority has.OK, I discovered that priority is entirely ignored, except for a start-delay tweak. JobQueue.enqueue() uses InternalJob.compareTo() to insert into the queue, but compareTo() only uses startTime, ignoring priority.For a moment I thought I could just override compareTo(), but then I discovered that it has been declared final. Is this necessary? Unfortunately, I haven't been able to come up with a scheduling workaround to get precisely the behaviour I need, so it'd be really helpful to be able to override this method. The only concern I can see is that maybe compareTo() is also used in a different context where startTime really needs to be the deciding factor(it'd be helpful if the doc for InternalJob.compareTo() described the context for which it is intended).Hi Ian, Everything you say is true. The scheduling priority is used to tweak thestartTime field, and then jobs are sorted in the wait queue by start time. Thishas similar behaviour to the decaying properties in traditional Unix scheduling. Priority essentially increases the longer the job is in the queue. A job oflower priority that has been in the queue awhile may run before a high priorityjob that has just arrived in the queue.I don't think it is appropriate for jobs to be able to completely control theirscheduling priority, either via overriding compareTo or through other means.Everyone probably thinks *their* job is more important than other jobs andshould always run first ;)In my case we're talking about an RCP app, and within a limited context I only care to influence the scheduling of my own jobs relative to each other, with greater emphasis on priority. In fact, for my jobs I really really don't want time in the queue to have the effect of increasing priority, at least not relative to each other.So I can see how having InternalJob.compareTo() marked final is beneficial for the IDE, to keep rogue plugins in line. But it does impact the flexibility I could have for my RCP app.How about figuring out a way to allow jobs within the same family to have more explicit control over scheduling with respect to other family members? Maybe an overrideable compareFamilyMemberTo() that gets used by compareTo() if they are the same family member, and for which the default implementation is identical to the current compareTo(). That would provide RCP apps with more flexibility without allowing IDE plugins to create aggressive rogue Jobs too easily.Not planning to implement this.(In reply to)John,I really like Jobs and their well-separated UI support.And I do recognize that my specialized - and admittedly now somewhat neglected - RCP app really calls for a custom scheduler rather than tweaks to Jobs. It's been a while since I've looked at it all, but I remember that it didn't seem viable to replace the scheduler. So to take the app any further I would need a completely separate scheduler/task framework to get the control I needed, or add my own layer on top of the existing job framework that does a lot of canceling and rescheduling of jobs.However, I thought that my last suggestion above would have allowed me to use the existing framework directly without exposing the platform unduly to rogue Jobs that would simply try to jump the queue. I'd get what I want: the ability to change priorities and RELATIVE execution order of MY OWN queued jobs, and rogue jobs could not generally take priority from those of other plugins. And the implementation changes would be simple.As an example, imagine a user scrolling right in Google maps. Tiles that had been but are no longer visible and were already queued to be rendered could remain queued but their priority dropped so that the rendering of newly exposed and queued tiles would occur first. Because the original tiles remained queued, the user may subsequently scroll back left again and find the tiles already rendered, even though they hadn't been before the user had scrolled away from them.It'd be nice and easy just to change priorities of tile-rendering jobs as the visible portion of the map is moved.Could one get the required effect by canceling jobs and rescheduling them immediately with a lower priority? Would that be a cleaner solution than my suggestion in, or is it just a matter of needing someone to do the work when there are so many higher priority things to be done?Reopening.I'm going to mark this LATER rather than WONTFIX. I think you can achieve the kind of result you're looking for by layering something on top. For example you can manage a queue of work items in whatever way you want, and then allocate a job or two to process items from that queue. This gives you ultimate control over the work your plugin is doing without affecting the overall job execution queue. A number of components do this already. The open question is whether this can or should be generalized in a way that suits a wide variety of clients. I suspect we could do something useful here, but it doesn't fit into the current 3.3 plan.As an interesting aside, I've spoken with members of the Maestro team at NASA who are using the jobs framework for exactly the purpose you describe... tile-rendering very large images in parallel with multiple jobs ().[LATER->WONTFIX] The "LATER" bugzilla resolution is being removed so reopening to mark as WONTFIX.[LATER->WONTFIX] The "LATER" bugzilla resolution is being removed so reopening to mark as WONTFIX.I'd like to reopen this issue.I have a use-case where I create around 30 jobs polling p2 repo, that are currently running with a single thread but that's a detail, and I know that some of them are more important than others and that the output of the job is most likely going to be necessary earlier.My jobs typically have a Job.LONG priority, and I want to set some of those jobs to (Job.LONG - 1) in order to make them run before the other job I created.But the API doesn't allow that, so that I have to make my "most likely useful jobs" using priority Long.SHORT, which would have more import on other 3rd-party jobs than using Job.LONG - 1.	11.0
id=130157	REOPENED	Platform	Runtime	3.1	PC Windows 2000	P3 enhancement	platform-runtime-inbox	2006-03-02 12:18 EST by	Christophe Elek	2007-01-16 13:32 EST (	3 users	Is it possible to call 'Configuration Details' from headless ?(the button is avail in Help->about)Could it be done while Eclipse is up and running ? (by starting an app without locking the workspace ? maybe pointing at the configuration ?)We want to dump info about eclipse config if an issue occurs, so we know the java properties, loaded plugins and info in .logThanks :)	The dialog cannot be but there you can call the API from Core. Moving to core for advice.The data being displayed in the configuration details is provided by various contributors (I think there is an extension point in UI land: org.eclipse.ui.systemSummaryExtensions) and therefore there is no such APIs.However I think it might be good to try to move the extension point out of runtime so that such a requirement could be fullfilled. Would you like to prototype that?In the interim, you can get all the runtime stuffs by various APIs.Pascal, Yep,Can you elaborate ? I checked org.eclipse.ui.systemSummaryExtensions... you are sating the best way would be to move the extension point OUT of UI into Runtime ? And then provide API for it ?Yes Christophe, moving the ui extension point into runtime would be the easiest way to go, especially now that we have decoupled the extension point namespace from the plug-in one.As for the API, I'm not sure what would be best here.Starting refactoring in 3.2 M6CreatedPatch for org.eclipse.core.runtimeCreatedpatch for org.eclipse.uiCreatedpatch for org.eclipse.ui.workbenchTested with 3.2M6, looks good, Pascal, you mind checking the patch ? Thanksof course, some UI team interaction would be needed here... Adding Boris cause he seems like that kind of guy...-1 for 3.2. Thanks for the patches but this touches on a number of pluigns and it is getting too late in the cycle. We can revisit in 3.3 as part of a manageabilty effort.Hey Jeff... Is now a good time to revisit for 3.3 ? :)	12.0
id=453744	REOPENED	Platform	Runtime	4.4.1	PC Linux	P3 critical	platform-runtime-inbox	2014-12-01 07:44 EST by	arne anka	2016-07-01 18:29 EDT (	2 users	i've got eclipse deployed in a separate folder writable to root only.folder has been created by extracting the downloaded tar ball there.in user's $HOME there#s both the workspace and a .eclipse/ folder. since for reasons nowhere explained eclipse 4.4.0 fails to find updates to eclipse 4.4.1 (#453388), i decided to download instead a new tar ball.finding the right one proves difficult -- the last one was "standard", a flavour that is not available via the web site.so i downloaded JEE which seems to be the closest.extracted, started eclipse -- and previously installed plugins are gone as well as the configured update sites.research shows, these (at least the plugins) still live in .eclipse/ -- but sadly below org.eclipse.platform_4.4.0_* while the new eclipse version is org.eclipse.platform_4.4.1_*sorry, but this is inacceptable! it's 2014 and even Windows nowadays struggles to recognize older configurations when updating something -- i expect eclipse to be able to automatically migrate existing configurations instead of assuming all is fresh and new and there's nothing to think about and leaving the user in the lurch (how, for example, am i supposed to gte the list of update sites back???).	same game again -- just upgraded to 4.4.2 and all of a sudden everything is lost.upon start eclipse asks again for the workspace and all update sites and installed plugins are lost again.i doubt that it would be difficult to recognize the existing subfolder in .eclipse and migrate or even re-use.since it seems not to be easy to figure out where a name likeorg.eclipse.platform_4.4.1_1473617060_linux_gtk_x86_64/comes from, i cannot even try to rename it myself to force eclipse to do its job.this getting seriuos -- it makes the idea of an update mechanism rather questionable if i have to spend more time afterwards to fix everything that update breaks.CreatedMigration wizard in actionWhat you are asking is working (see attached screenshot).Given the tone user, I'm not tempted to investigate any further.updated to mars.1 and the issue persists.given that eclipse for over 110 years now fails to cope sufficiently with multi- user setups, i think i am entitled to frustration, don't you think?In another ticket you mentioned that you are installing Eclipse in a read-only folder. I'm not sure if that is the case for all your issues.if this is the core cause, it's a very big bug in eclipse.a) it's called multi user setup -- that is, the main installation is central and readable for all users, but all write operations are directed to the user's $HOMEb) eclipse obviously has support for that since it silently installs into $HOME/.eclipse/org.eclipse.platform_<VERSION> all plugins installed through p2 when it cannot write to the central locationc) at least parts of eclipse still fail to recognize this and cause all kinds of trouble, ignoring those directories in $HOME/.eclipse/ silently -- i don't know which parts act independently, but the migration wizard should be aware of this scenario and act accordinglygiven that a genuine end-user multi user system like linux is around for more than twenty years now, and that my first bug report regarding the linited multi user facilities of eclipse dates from 2004/5, this is more than just a little frustrating.still true with 4.6.0This has been fixed in 4.5.no, it hasn't.as per #7 it still is broken with neon.	9.0
id=200809	REOPENED	Platform	Runtime	3.2	All Linux	P3 normal	platform-runtime-inbox	2007-08-22 08:16 EDT by	Mariot Chauvin	2014-12-05 04:47 EST (	8 users	Build ID: M20070212-1330 (Fedora Core release 6 (Zod))Steps To Reproduce:Eclipse seems to store information on ~/.eclipse whithout to care about $XDG* environment variablesMore information:See	You might want to change it against 3.3 (or even 3.4), since no further work is likely to be done on 3.2.In any case, it's customisable. The property is taken from the entry in config.ini, which usually points to @user.data/workspace, but in your case sounds like it might be @user.data/.eclipse. The @ refers to a Java system property; I don't know if environment variables such as the one you quote might be there or not. It would be simple to launch Eclipse with "eclipse -data $XDB_BASE/.eclipse" if you wanted.This might well be a packaging issue for your distro, rather than Eclipse per se.As Alex says, the directories where Eclipse writes data can be configured via command line arguments and/or system properties. Eclipse isn't going to build in special awareness of $XDG environment variables.What is planned now about FreeDesktop XDG basedir specification for Eclipse?From the point of view of the committers involved, the plans have not evolved since the bug has been closed as wontfix.For my own education which linux distro implement this spec?Now by curiosity I glanced through the requirements () to see what it required. My overall feeling is that from a pure runtime point of view, some things could be supported, however this would not make all the plugins work. This is because there are concepts that do not explicitely exist in eclipse as API and as such various plugins rolled out their own implementation (e.g. runtime caches). Here is a quick review of the reqs:For eclipse I'm not sure what this folder would be. I would assume that this is the "workspace" in which case having just one does not make sense. For example when I work on two different projects, I need two different workspaces. The other thing that comes in mind are the preferences stored in the configuration folder.This is supported by the -configuration option and which would immediately change the config scope in eclipse prefs.Eclipse preference mechanism has the concept of scope, I suppose that additional scopes could be created and added to the default lookup order. However many plugins just look in one scope so they would not be affected.Not sure how this would go with as Eclipse way of doing things that consists in loading configuration information on startup from two places and merge values. The only potential way would be to limit the config dirs to 2 and have the first one refer to -configuration and the other to the base configuration. Also if there is expectation around a merge or precedence this may not work.There is no such concept. Currently application level caches are stored in sub folders of the configuration location. This is the responsibility of each plugin. A new concept would need to be added to Eclipse and adopted.This would apply to p2 for the dropins folder and for the location where bundles get downloaded when running in a shared install.This spec is implemented by a lot of upstream applications including GNOME/GTK, KDE, XFCE, LXDE .... Thus nearly all distributions implement this spec.-configuration option should default to $XDG_CONFIG_HOME/eclipseA sigle cache dir is very important, because it can be easily excluded from backupThanks for the details. Given that the compliance would not be a matter of just settings a few flags (because concepts are missing). At this point I think that nothing will happen on this front unless a contribution is a done.If you are waiting for a contrib, I suggest to reopen this bug.Re-opening and flagging helpwantedOk, so it seems a thorough compliance would be difficult to achieve, but some parts are relatively easy.To start with, it should be simple - to make osgi.instance.area default to $XDG_DATA_HOME/eclipse/workspace_appId instead of @osgi.install.area/workspace - to make osgi.configuration.area default to $XDG_CONFIG_HOME/eclipse/appId_appVersion_installDirHash instead of $HOME/.eclipse/appId_appVersion_installDirHash (see) - to make osgi.user.area default to $XDG_CONFIG_HOME/eclipse/common instead of $HOME/userSupporting $XDG_DATA_DIRS and $XDG_CONFIG_DIRS sounds feasible but would require more work, and introducing support for $XDG_CACHE_HOME and $XDG_RUNTIME_DIR sounds like a lot more work.Finally, I guess osgi.install.area also has to be split into $XDG_DATA_HOME and $XDG_CONFIG_HOME parts but that looks like yet one more separate work item that would have to take into account shared installations.I am writing this down to increase the chances that "simple" fixes make it into the code, and adding myself to cc in case I eventually get time to do them.Would it make things easier from the Eclipse perspective if the XDG spec was modified to have one configuration and data directory instead of separate XDG_DATA_HOME and XDG_CONFIG_HOME? (cache would remain unchanged)Disclaimer: I'm not an Eclipse committer but have experience of Eclipse plug-in development and use it regularly.Equinox platform, on top of which Eclipse is built, requires one to specify the following areas (see [1]): - instance, which is roughly equivalent to XDG_DATA_HOME + XDG_CACHE_HOME + XDG_RUNTIME_DIR, and which has to stay the same during application runtime but may change between startups. - configuration, which is equivalent to XDG_CONFIG_HOME and should be unique for each eclipse installation. - user, which is also equivalent to XDG_CONFIG_HOME and should be shared between different eclipse installations.So, I don't think merging XDG_DATA_HOME and XDG_CONFIG_HOME would help in any way, and I don't think it would create problems either.On a side note, there is also support for several hierarchical configuration areas, but I don't know if and how it can be integrated with XDG_CONFIG_DIRS. On the other hand, instance areas cannot be hierarchical as of now, and I am not sure there is need to support XDG_DATA_DIRS.[1]***has been marked as a duplicate of this bug. ***	12.0
id=467356	REOPENED	Platform	Runtime	4.5	PC Mac OS X	P3 normal	platform-runtime-inbox	2015-05-14 17:45 EDT by	Sam Davis	2015-05-14 19:50 EDT (	1 user	* install Luna SR2 Java package on Mac* try to install any feature from(I've tried, separately, EGit, and Mylyn Tasks)* Eclipse says it has to restart and never comes back. At this point the Eclipse.app package is empty except for eclipse.ini. If I copy a good Eclipse.app into the directory and try to run it, launching fails and logs a bunch of "Could not resolve module" errors (see attached).	CreatedlogThis is normal. You are running java 1.6 and now some bundles require Java 7. If you try to change your JRE to 1.7 or higher, Eclipse should start again.I am running Java 8:$ java -versionjava version "1.8.0"Java(TM) SE Runtime Environment (build 1.8.0-b132)Java HotSpot(TM) 64-Bit Server VM (build 25.0-b70, mixed mode)I also find it strange if the files in Eclipse.app being deleted is related to the Java version.There's actually another 1MB of similar errors. Here's the start of the log:!SESSION 2015-05-14 14:33:45.861 -----------------------------------------------eclipse.buildId=java.version=1.6.0_51java.vendor=Apple Inc.BootLoader constants: OS=macosx, ARCH=x86, WS=cocoa, NL=en_USFramework arguments: -product org.eclipse.epp.package.java.product -keyring /Users/sam.davis/.eclipse_keyring -showlocationCommand-line arguments: -os macosx -ws cocoa -arch x86 -product org.eclipse.epp.package.java.product -keyring /Users/sam.davis/.eclipse_keyring -showlocation!ENTRY org.eclipse.equinox.common 4 0 2015-05-14 14:33:46.850!MESSAGE FrameworkEvent ERROR!STACK 0org.osgi.framework.BundleException: Could not resolve module: org.eclipse.equinox.common [131] Another singleton bundle selected: osgi.identity; osgi.identity="org.eclipse.equinox.common"; type="osgi.bundle"; version:Version="3.7.0.v20150402-1709"; singleton:="true" at org.eclipse.osgi.container.Module.start(Module.java:434) at org.eclipse.osgi.container.ModuleContainer$ContainerStartLevel.incStartLevel(ModuleContainer.java:1582) at org.eclipse.osgi.container.ModuleContainer$ContainerStartLevel.incStartLevel(ModuleContainer.java:1562) at org.eclipse.osgi.container.ModuleContainer$ContainerStartLevel.doContainerStartLevel(ModuleContainer.java:1533) at org.eclipse.osgi.container.ModuleContainer$ContainerStartLevel.dispatchEvent(ModuleContainer.java:1476) at org.eclipse.osgi.container.ModuleContainer$ContainerStartLevel.dispatchEvent(ModuleContainer.java:1) at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:230) at org.eclipse.osgi.framework.eventmgr.EventManager$EventThread.run(EventManager.java:340)!ENTRY org.eclipse.equinox.ds 4 0 2015-05-14 14:33:46.852!MESSAGE FrameworkEvent ERROR!STACK 0org.osgi.framework.BundleException: Could not resolve module: org.eclipse.equinox.ds [134] Another singleton bundle selected: osgi.identity; osgi.identity="org.eclipse.equinox.ds"; type="osgi.bundle"; version:Version="1.4.300.v20150423-1356"; singleton:="true" at org.eclipse.osgi.container.Module.start(Module.java:434) at org.eclipse.osgi.container.ModuleContainer$ContainerStartLevel.incStartLevel(ModuleContainer.java:1582) at org.eclipse.osgi.container.ModuleContainer$ContainerStartLevel.incStartLevel(ModuleContainer.java:1562) at org.eclipse.osgi.container.ModuleContainer$ContainerStartLevel.doContainerStartLevel(ModuleContainer.java:1533) at org.eclipse.osgi.container.ModuleContainer$ContainerStartLevel.dispatchEvent(ModuleContainer.java:1476) at org.eclipse.osgi.container.ModuleContainer$ContainerStartLevel.dispatchEvent(ModuleContainer.java:1) at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:230) at org.eclipse.osgi.framework.eventmgr.EventManager$EventThread.run(EventManager.java:340)!ENTRY com.ibm.icu 4 0 2015-05-14 14:33:46.858!MESSAGE FrameworkEvent ERROR!STACK 0org.osgi.framework.BundleException: Could not resolve module: com.ibm.icu [10] Another singleton bundle selected: osgi.identity; osgi.identity="com.ibm.icu"; type="osgi.bundle"; version:Version="54.1.1.v201501272100"; singleton:="true" at org.eclipse.osgi.container.Module.start(Module.java:434) at org.eclipse.osgi.container.ModuleContainer$ContainerStartLevel.incStartLevel(ModuleContainer.java:1582) at org.eclipse.osgi.container.ModuleContainer$ContainerStartLevel.incStartLevel(ModuleContainer.java:1561) at org.eclipse.osgi.container.ModuleContainer$ContainerStartLevel.doContainerStartLevel(ModuleContainer.java:1533) at org.eclipse.osgi.container.ModuleContainer$ContainerStartLevel.dispatchEvent(ModuleContainer.java:1476) at org.eclipse.osgi.container.ModuleContainer$ContainerStartLevel.dispatchEvent(ModuleContainer.java:1) at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:230) at org.eclipse.osgi.framework.eventmgr.EventManager$EventThread.run(EventManager.java:340There is something fishy with your install because the version reported in the error log says: java.version=1.6.0_51Now the other thing that you need to know is that it is not possible to update Eclipse from Luna to Mars on the Mac. Normally the installation should be blocked but it is not yet done, seeHowever installing some plug-ins from Mars into Luna sohuld still as long as the dependencies are satisfied and the appropriate JRE is being used.	4.0
id=474304	REOPENED	Platform	Runtime	4.5	PC Linux	P3 enhancement	platform-runtime-inbox	2015-08-05 06:07 EDT by	Lars Vogel	2016-04-16 01:55 EDT (	4 users	I'm sorry but I'm still not familiar with the setup of the performance tests. In Platform UI runtime I have ContextPerformanceTest.java. I would like to migrate that test to JUni 4. Is that supported by our performance test infrastructure? If yes, what do I need to do?	We run them just like the JUnit tests, so shouldn't matter (as far as I know) but the "performance" flag turned on (and performance capturing bundles/fragments installed). If you already have performance tests, just make sure it's part of the suite that's named in the test.xml file. The "performance flag" is what causes our framework to execute the target in your test.xml that looks similar to the following (this example is from org.eclipse.ui.tests.performance) <target name="performance" depends="init,performance-suite,jface-performance-suite,cleanup"> <ant target="collect" antfile="${library-file}" dir="${eclipse-home}"> <property name="includes" value="org*.xml"/> <property name="output-file" value="${plugin-name}.xml"/> </ant> </target>If the code is not yet "instrumented" at all, you will need to readand decide how you want to instrument it. (I'd start off minimally :) HTHThanks David.I don't think this is a releng bug. Or perhaps I misunderstand what Lars asked.Eventually we will have to remove the usage of junit.framework junit 3 type packages ()But the PerformanceTestRunner which gets used by (all of?) the performance tests takes the junit 3 API junit.framework.TestCase in its run methods:org.eclipse.core.tests.harness.PerformanceTestRunner.run(TestCase, String, int, int)There are similar issues with our session test harness code:org.eclipse.core.tests.session.SessionTestSuiteorg.eclipse.core.tests.session.SessionTestRunnerThanks for the clarification and education, Tom. I've been confused about this before. :) (Since "TestCase" is part of JUnit 4 -- I need things spelled out for me -- at least in areas I that I do not follow closely) . So, I do think it is a valid enhancement request since it could be interpreted as meaning provide support for "the new 4.0 (only) JUnit-Style of tests" (if that is the right wording .. if not, please correct the title) And we'll carry forward as that sort of request).(In reply to Thomas Watson from)No, that was false information. Sopot has not given any evidence why JUnit 3 tests wouldn't run in JUnit 5.JUnit 4 includes JUnit 3, so even if JUnit 5 wouldn't include direct support for JUnit 3, those tests could still be run using the JUnit 4 runner. There's no need to migrate any tests.(In reply to Markus Keller from)Except to take advantage of any new functionality in JUnit and to attract contributors, which typically want to use latest and greatest. I had once one student working for me and after I showed him our platform UI JUnit3 tests, he said "these are not test, the annotations are missing". That was my trigger to start migrating the platform UI tests.	7.0
id=481891	REOPENED	Platform	Runtime	4.6	PC Mac OS X	P3 normal	platform-runtime-inbox	2015-11-10 17:00 EST by	Thomas Schindl	2015-12-02 07:46 EST (	2 users	.	New Gerrit change created:It's the impl of our adapter service which can be injected. I have customers using it.But then the creation/registration happens somewhere else (e4 ui) so then the impl has to be moved there instead of relying on an internal package of another eclipse project. It's exactly this architectual problems we created and now even refuse to fix?(In reply to Thomas Schindl from)Moving the impl somewhere else is fine, but this bug says "is not used anywhere and should be removed" which is -2.And for "runtime" this statement is absolutely true but platform-ui is getting in the way. It looks like e4.ui.workbench.swt is the one responsible for this leakage.(In reply to Thomas Schindl from)Not sure what you mean by leakage. runtime defines lots of services which are not used in runtime but only in ui. Runtime contains all non UI related services.I mark this bug as wontfix, please reopen if I misunderstood.What sense does it make that we declare this service impl while it is not contributed there but at a completely different location	7.0
id=313207	REOPENED	Platform	Search	3.5.2	PC Windows XP	P3 normal	Platform-Search-Inbox	2010-05-17 13:54 EDT by	Felix Saphir	2016-11-21 09:49 EST (	3 users	Build Identifier: 20100218-1602Most times, double clicking on a result in the lower search result pane opens a new editor tab (and the file the match was found in). But sometimes, after a while, the contents of the currently open editor tab seems to be replaced. It seems like the hey-the-user-double-clicked-on-a-search-result-let's-open-the-file-action seems to be stuck on that single editor tab. Only workaround is to drag'n'drop the "match" in the editor, which opens the file in a new tab.Restarting the IDE doesn't help.I could not find a similar entry in neither Bugzilla nor the forum, which btw. doesn't let me login.Reproducible: Sometimes	Guess bug belongs to platform-searchI assume you hit the maximum number of open editors and then the last one is always reused (see General > Editors preference page). You can also choose whether Search reuses editors to show matches (General > Search preference page).If that doesn't solve your problem then please provide more detailed steps to reproduce and then reopen this bug.(In reply to Dani Megert from)1.) Clone SWT repo and import projects2.) Search for "test_addSelectionListener"3.) Navigate to the first test and double-click the class containing the test-> Open new editor4.) Navigate to the next text in another file and double-click on this class-> Closes the tab (editor) from step 3 and opens the new classDouble-click on a file in Project Explorer opens new editor, behavior should be consistent with search.	3.0
id=489977	REOPENED	Platform	Search	4.5.1	All All	P3 minor	Platform-Search-Inbox	2016-03-18 17:18 EDT by	Filipus Klutiero	2016-06-11 20:58 EDT (	1 user	When performing a search (either global or per-file), the search term defaults to the first line selected only. This is problematic if my selection is multiline.For example, if I select:<br><div class="LigneBoutons">then hit Ctrl+H, "Containing text:" will default to just "<br>", ignoring the second line.	We do this for the simple search in order to avoid line delimiter issues. If you enable regular expression search it works as you desire.Dani, why was this ticket marked as resolved?I confirm, as indicated by Dani Megert, that the behaviour depends on the state of the "Regular expression" option. This option's initial value depends on its final value the previous time the search dialog was opened.My understanding is that no one has failed to reproduce this bug.(In reply to Filipus Klutiero from)Looks like you prefer INVALID as resolution.Dani, why was this ticket marked as invalid?(In reply to Filipus Klutiero from)Because this works as designed. The multi-line selection is only entered when in regex mode where \R is used to denote any kind of newline.See also.(In reply to Dani Megert from)Such behavior is more accurately called BAD.You could say it is always entered, but unless the Regular expression option defaults to enabled, only one line from that selection is entered.(In reply to Filipus Klutiero from)Maybe you like WONTFIX better. We won't change this.(In reply to Dani Megert from)[...]What makes you think so?If you cannot solve this, leave the ticket open.	11.0
id=74001	REOPENED	Platform	SWT	3.0	All All	P3 enhancement	Platform-SWT-Inbox	2004-09-15 13:45 EDT by	Jens Fransson	2010-11-15 04:41 EST (	2 users	The class org.eclipse.swt.widgets.Shell does not allow to intercept a SWT.RESIZEevent BEFORE resizing occurs. Therefore it is not possible to prevent such anevent from being processed by the Shell. Such a veto-mechanism would be helpful in order to implement constraints for theShell's bounds. Although not commonly used, I find it useful to restict therange of possible Shell sizes in some cases as an alternative to make the windowa fixed-size dialog. Borland Delphi's VCL also has such a mechanism. Itconveniently allows to set a maximum and a minimum width and height for a window.Until this may become a reality, I wrote a workaround which has the disadvantageof making the Shell flicker when the user tries to resize the window into theforbidden range. The following example enforces a minimum width which is 25%wider than the standard width (obtained through shell.pack()) and a fixed height:public MyApp extends ApplicationWindow { ... protected Control createContents(final Composite parent) { ... constrainWindowBounds(); return ...; } /** * Dirty way to enforce minimum/maximum window constraints. * Unfortunately this results in flickering of the window if * the window must be retrofitted into its constrained bounds. */ private void constrainWindowBounds() { getShell().pack(); final Rectangle r = getShell().getBounds(); final Rectangle minBounds = new Rectangle(r.x, r.y, (r.width * 5) / 4,r.height); getShell().setBounds(minBounds); getShell().addControlListener(new ControlListener() { public void controlMoved(final ControlEvent e) { } public void controlResized(final ControlEvent e) { final Rectangle newBounds = getShell().getBounds(); final Rectangle constrained = new Rectangle(newBounds.x, newBounds.y, Math.max(minBounds.width, newBounds.width), minBounds.height); if ((newBounds.width != constrained.width) || (newBounds.height !=constrained.height)) { getShell().setBounds(constrained); } } }); }I would love to see a way to set constraints on the bounds of a Shell as a newhigh-level feature. I would also appreciate to be able to intercept SWT.RESIZEevents before they are being processed by the Shell.Are there any supporters for this idea?	It's not possible to intercept and veto a shell resize request on all platforms. You can set the minimum size for a Shell using Shell.setMinimimSize(). We didn't implement Shell.setMaximimSize() because no one seemed to care about it. You could consider reopening this bug report and turning into a feature request for Shell.setMaximumSize() which can be implemented on the various platforms.Hi Steve, thank you for your quick answer. I am very pleased to hear that this feature isalready implemented in the development version of SWT! I will wait for the nextstable SWT release in order to use it. Since I don't need aShell.setMaximumSize() yet, I leave things as they are for now.Thank you and keep up the good work!Regards,JensI overlooked that I actually do need a Shell.setMaximumSize(), so I reopen thisas a new feature request as suggested.Ok, but this new API is low priority.This would also be interesting for the Find/Replace dialog in text editors. That dialog should be resizable horizontally, but since there are no elements with variable height, I'd like to restrict the maximum height.	5.0
id=490100	REOPENED	Platform	Runtime	4.5.2	All All	P3 normal	platform-runtime-inbox	2016-03-21 11:17 EDT by	Marvin Fröhlich	2016-04-26 02:57 EDT (	1 user	I'm searching for a way to get project order according to working sets. I have a single-containment for my projects over all working sets.IWorkingSetManager wsm = PlatformUI.getWorkbench().getWorkingSetManager();IWorkingSet[] wss = wsm.getWorkingSets();wss contains all WorkingSets in alphabetical order losing the custom defined order.I also tried to access package explorer as the order may be defined in there. But it's access restricted.Is this really a bug? Or can I access the order in a different way?	Do you need more info for this bug?I'm sorry to insist here. Is it even supposed to work this way? Is there another way to access the working set order?There is no order defined by IWorkingSetManager. Even if there seems to be an order, the UI components decide how to present the contents of working sets (e.g., using the working set name, or via working set type). The working set infrastructure has no control over how the UI chooses to represent them.I can see how this would be useful though. I'll re-open and perhaps it something we can look at for Oxygen. At worst, the IWorkingSetManager could offer the WS in an order, and honouring that order or not can be left to the consumers.The package explorer seems to define an order over the working sets. And the manager looks pretty "integrated". Is there a programmatic way to read this order from a plugin?Apart from that I agree, with. Thanks.	5.0
id=93809	REOPENED	Platform	SWT	3.1	PC Windows XP	P3 enhancement	Platform-SWT-Inbox	2005-05-05 12:20 EDT by	Damian Biollo	2013-08-30 18:51 EDT (	14 users	One of the most useful Win32 controls is the extended combo box.It is like a combo box with 2 additions: each item can have an image and each item can be indented. I think (not totally sure) that the indenting increases in increments of half the icon size (it might be a fixed # of pixels). I can't really see a good cross-platform way to implement this with SWT. The Combo class just shows strings. On the newsgroup, people have recommend to use a table as the drop down; however, one critical function (setImageIndent) is now deprecated, so I'm not sure how to set the indenting. Using a tree as a the drop area would seem to be inappropriate as trees behave differently from combo box wrt expand/collapse and selection.Anyway, it seems like a few people are going to be custom implementing this control anyway, but I think this belongs in the SWT layer. Is there any chance we can get an ExtendedCombo class before Eclipse 3.1 is complete?	There is no chance before 3.1. We are API frozen.See also(requests the same for CCombo).Any chance that this will be considered for 3.4?*** This bug has been marked as a duplicate of***Reopening, this is not a dup and has dependencies.	5.0
id=11731	REOPENED	Platform	SWT	2.0	PC Windows All	P3 normal	Platform-SWT-Inbox	2002-03-19 17:08 EST by	Randy Hudson	2016-11-15 03:48 EST (	5 users	1) Create a file foo.txt2) Dirty it in the default text editor3) Delete the file from the navigator4) At this point, a modal dialog is created, but you can't see it until you click on the shell somewhere.If you click in the wrong place, you can actually click on the "close" button which loses the changes made in the editor.I remember reporting this earlier, but I think it was on the newsgroup. Sorry if this is a dupe.	Could not reproduce.The dialog is correctly opened when the editor is activated.I just noticed the code that only displays the dialog when that Editor is activated, so I mistakenly thought that it should popup sooner.However, if I actually click on the Editor's Control, thus making it active, there is a problem in that mouse event. Somehow, that first mouseDown that activates the viewer, causing it to show the dialog, actually then gets sent to the dialog. So, if you happen to click on the Editor in the area where the dialog is to appear, you can actually click on the "Do Not Save" button on the Dialog by accident, losing your changes.Please try this again , and note where the dialog appears, then do it again and Press (don't release) this time in the location where the "Don't Save" button appears. If you hit it, the button will be pressed, and releasing will close without commit.Is this a duplicate of?Changed title since this is not an accessibility bug.Moving to SWT to explain why dialog is getting the mouse down event. Seems like a bug.To clarify for SWT team, Step 4 is incorrect. The dialog is not created until you mouse down, but that mouse down gets sent to the Dialog that is created on the mouse down.Let me clarify things here (should have done that when moving this to SWT).Steps to reproduce:1) In the navigator view, create f1.txt in a project (opens up a text editor)2) Modify the content of the editor but do not save3) Give focus to the navigator view and delete the file f1.txt4) Mouse down on the editor and notice the dialog (as of M5 build, you actually get 3 different dialogs...we are looking into this)5) Unless you were lucky, your mouse was probably not over a button of the dialog, so move it there.6) Do not move your mouse again for this test. Dismiss the dialog(s) using the keyboard7) Using the keyboard, give focus to the navigator view (Ctrl+F7)8) Create a new file f1.txt (Alt+f+n)9) In the opened editor, type some text10) Switch to the navigator view (Ctrl+f7)11) Delete the file f1.txt12) **WITHOUT MOVING THE MOUSE**, mouse down on the editor to give it focusNotice the dialog comes up and the button under the mouse is "armed". What is happenning is the mouse down caused the SWT.Activate callback. In this callback, the dialog is opened. Then somehow the mouse down event goes to the dialog, instead of the text editor.Repeatable on Win98.I tried using this simple code to replicate the problem, but I couldn't.I will try something else later, but in case this is useful, here it is:import org.eclipse.swt.*;import org.eclipse.swt.graphics.*;import org.eclipse.swt.widgets.*;import org.eclipse.swt.layout.*;import org.eclipse.swt.events.*;import org.eclipse.swt.custom.*;public class StyledTextDialogTest { static Display display; static Shell shell, dialog; static StyledText text; static Listener activateListener; public static void main(String[] args) { display = new Display(); shell = new Shell(display); shell.setLayout(new GridLayout()); shell.setText("StyledText Activate Dialog Test"); text = new StyledText(shell, SWT.MULTI); text.setText("\nthis is a multi-line text\n\nadd an activate listener to me,\n\nand then click on me to open a dialog\n"); text.setLayoutData(new GridData(GridData.FILL_BOTH)); activateListener = new Listener() { public void handleEvent(Event e) { openDialog(); //new MessageBox(shell, SWT.NONE).open(); text.removeListener(SWT.Activate, activateListener); } }; Button add = new Button(shell, SWT.PUSH); add.setText("Add Activate Listener"); add.setLayoutData(new GridData(GridData.FILL_HORIZONTAL)); add.addSelectionListener(new SelectionAdapter() { public void widgetSelected(SelectionEvent e) { text.addListener(SWT.Activate, activateListener); } }); shell.pack(); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } } static void openDialog() { dialog = new Shell(shell, SWT.DIALOG_TRIM); dialog.setLayout(new GridLayout()); dialog.setText("Dialog"); Label message = new Label(dialog, SWT.WRAP); message.setText("Click on the OK button to dismiss this dialog."); Button ok = new Button(dialog, SWT.PUSH); ok.setText("OK"); GridData data = new GridData(GridData.FILL_BOTH); data.heightHint = 200; ok.setLayoutData(data); dialog.setDefaultButton(ok); ok.addSelectionListener(new SelectionAdapter() { public void widgetSelected(SelectionEvent e) { dialog.close(); } }); dialog.pack(); dialog.open(); }}If it helps any, the 2 extra dialogs still show up in 20020530.(the ones that Simon mentions are being looked into as of M5).The .log entry for those 2 (error) dialogs is:!ENTRY org.eclipse.ui 4 0 May 31, 2002 11:01:49.589!MESSAGE MarkerRulerAction.getMarker!ENTRY org.eclipse.core.resources 4 368 May 31, 2002 11:01:49.589!MESSAGE Resource /Test/test.txt does not exist.!ENTRY org.eclipse.ui 4 0 May 31, 2002 11:01:52.834!MESSAGE SelectMarkerRulerAction.getMarker!ENTRY org.eclipse.core.resources 4 368 May 31, 2002 11:01:52.834!MESSAGE Resource /Test/test.txt does not exist.OK - here's what's happening: The activate message comes in before the mouse down. So we are calling the application's activate listener, and the application is opening a dialog and running an event loop that dispatches the key to the dialog.Here's what the application should do:See the little SWT standalone example below. Note that the dialog is opened inside the Activate listener. If you run this, you will see the strange "dialog button is already pressed" behavior.Now comment out the line with "openDialog();" and uncomment the lines that open the dialog asynchronously. The strange behavior is gone, and everything works as it should.import org.eclipse.swt.*;import org.eclipse.swt.graphics.*;import org.eclipse.swt.widgets.*;import org.eclipse.swt.layout.*;import org.eclipse.swt.events.*;import org.eclipse.swt.custom.*;public class StyledTextDialogTest { static Display display; static Shell shell, dialog; static StyledText text; static Button add; static Listener activateListener; public static void main(String[] args) { display = new Display(); shell = new Shell(display); shell.setLayout(new GridLayout()); shell.setText("StyledText Activate Dialog Test"); text = new StyledText(shell, SWT.MULTI); text.setText("\nthis is a multi-line text\n\nadd an activate listener to me,\n\nand then click on me to open a dialog\n"); text.setLayoutData(new GridData(GridData.FILL_BOTH)); activateListener = new Listener() { public void handleEvent(Event e) { text.removeListener(SWT.Activate, activateListener); openDialog();// display.asyncExec(new Runnable() {// public void run() {// openDialog();// }// }); } }; add = new Button(shell, SWT.PUSH); add.setText("Add Activate Listener"); add.setLayoutData(new GridData(GridData.FILL_HORIZONTAL)); add.addSelectionListener(new SelectionAdapter() { public void widgetSelected(SelectionEvent e) { text.addListener(SWT.Activate, activateListener); } }); shell.pack(); shell.setLocation(10, 10); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } } static void openDialog() { dialog = new Shell(shell, SWT.DIALOG_TRIM | SWT.APPLICATION_MODAL); dialog.setLayout(new GridLayout()); dialog.setText("Dialog"); Label message = new Label(dialog, SWT.WRAP); message.setText("Click on the OK button to dismiss this dialog."); Button ok = new Button(dialog, SWT.PUSH); ok.setText("OK"); GridData data = new GridData(GridData.FILL_BOTH); data.heightHint = 200; ok.setLayoutData(data); dialog.setDefaultButton(ok); ok.addSelectionListener(new SelectionAdapter() { public void widgetSelected(SelectionEvent e) { dialog.close(); } }); dialog.pack(); dialog.setLocation(10, 10); dialog.open(); while (!dialog.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } }}Closing the PR.Sorry - I shouldn't have closed this PR - I should have reassigned it back to the UI team... reopening. :)Moving back to UI.The problem is that lots of clients copied this code from UI and won't know to change to use asyncExec.IMO, using async is a workaround. It seems like Activate and MouseDown should be "atomic". If mousedown caused the activate, why doesn't the control get the MouseDown? Would listening to focus cause the same problem?Carolyn, can you comment on Randy's comment. Is it platform behavior what we are seeing?The answer is that the mouse down did not cause the mouse event. We are using WM_MOUSEACTIVATE on Windows that comes in before the mouse is pressed. If this causes any more problems, we may change to use WM_LBUTTONDOWN etc. after R2.0.The async could be considered to be a work around but it is the safest thing to do at this point.Kai, since you know this area very well, can you take care of this? You can talk with Nick to find out if it should be done for freeze 3 of release 2.0F3 candidate. To be discussed.Need to leave this in UI until after R2.0, to indicate that workarounds are in UI code.Reducing priority to get in sync with the other F3 items.Reviewed by Erich Gamma.While we have the workaround in place this is still not fixed. Seefor a test case.SSQ, let's discuss this when you return.has a snippet to show the problem (which can be worked around with async).has SN's explanation.Dani, just from reading, this looks like the type of change that could break other things at this point. The behavior has been there for so long.Where are you actually seeing this problem? Can it be worked around with async?(In reply to)It's still the same issue. Just ran into the workaround when reading code. AsyncExecs are known to cause trouble so I'd like to get rid of them whenever possible.Can this issue still be reproduced on Windows? I tried steps to reproduce fromand dialog popped up properly and I didn't notice anything wrong. I'm on Linux Fedora 24 with GTK.(In reply to Mickael Istria from)Please try the steps from.	25.0
id=23406	REOPENED	Platform	SWT	2.0	PC Windows All	P3 major	Platform-SWT-Inbox	2002-09-11 09:28 EDT by	Kai-Uwe Maetzel	2017-01-16 05:16 EST (	28 users	See.I am debugging an application that has XML text. This results in very largestrings or files with no line seperators. For example, one of my files has aline with 27,000 characters. Such large unbroken lines cause eclipse problemsin a number of areas.1) The editor simply cannot handle such a large line and ends up throwing anexception warning. The line is a mess of characters. It looks line the line isoverwriting itself.	It's a StyledText bug.StyledText seems to wrap around if a line contains more than ~12530 bytes.This seems to be the case for linux-gtk as well.Here's the test case:---8<---package bugs;import org.eclipse.swt.SWT;import org.eclipse.swt.custom.StyledText;import org.eclipse.swt.layout.FillLayout;import org.eclipse.swt.widgets.Display;import org.eclipse.swt.widgets.Shell;public class LongLinesBug { private static String createLongLine() { StringBuffer buffer= new StringBuffer(); for (int i= 0; i < 1253; ++i) { String string= "" + (i * 10); buffer.append(string); for (int j= string.length(); j != 10; ++j) buffer.append(' '); } return buffer.toString(); } public static void main(String[] args) { Display display= new Display(); Shell shell= new Shell(); StyledText text= new StyledText(shell, SWT.NONE); text.setText(createLongLine()); shell.setLayout(new FillLayout()); shell.pack(); shell.open(); while (!shell.isDisposed()) if (!display.readAndDispatch()) display.sleep(); display.dispose(); }}Bug in Windows. We can't work around this because it depends on the display driver and we can't determine the limit programatically. Funny that the GTK display driver seems to have the same bug.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***So does someone have a recommendation for addressing this particular bug? If it's a GTK issue on Linux, has it been reported? If not, can someone who understands the problem help by reporting it?If you haven't figured out, I would really like to see this resolved. :)***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***(In reply to Steve Northover from)Yes we can, at least well enough to know when it starts to get fishy. When I add the following in TextLayout#shape(long, StyleItem) line 3501 right after "OS.ScriptPlace(..., abc);", then I get a horizontal scroll bar and see logging output as soon as the line goes empty: if (chars.length > 100 && abc[1] == 0) { abc[1]= 10 * chars.length; System.out.println("bug, setting abc[1] to " + abc[1]); }We can use a more conservative limit, but you get the point. I know a run can contain 101+ zero-width characters, but it's perfectly OK to make that case more expensive.This bug has too many dups for a WONTFIX. Reopening. The right solution would be to render runs in smaller chunks when the OS is incapable to comply.A maybe less complex solution would be to just render as many characters as possible and then draw something like ###OS_GRAPHICS_LIMIT_REACHED### or write the problem to System.err.***has been marked as a duplicate of this bug. ***CreatedSnippet to find the limitsNote that the Windows bug is not bound by the character count but depends on the actual line contents! The attached snippet finds the upper limit for the pattern from.If you use the commented pattern construction method// String string = "x" + (i * 10); // works!, then it works with lines that are millions of characters long.Hi Markus, are you working on a fix for Mars ?(In reply to Niraj Modi from)No, I had not planned to, but I would support a fix in RC1.***has been marked as a duplicate of this bug. ***This can be worked around with Word wrap (Alt+Shift+Y), at least with PDT.	25.0
id=206173	REOPENED	Platform	SWT	3.3	PC Linux	P3 normal	Platform-SWT-Inbox	2007-10-12 13:37 EDT by	Stefan Xenos	2016-09-15 10:43 EDT (	4 users	ScrolledComposite needs a way to indicate that its child's preferredSize (as returned from child.computeSize) should be used as its minimum size.The Forms library is working around this by calling setMinimumSize on every resize or layout event, but this creates extra flicker.	Note that this enhancement will mean more calls to child.computeSize, which will require adding a layout cache to ScrolledComposite (using the same pattern used by GridLayout). Otherwise, the extra calls will degrade performance.This is still a major source of inconvenience.PingDuong, please investigate.Released code to allow SWT.DEFAULT for ScrolledComposite.setMinSize.Fixed > 081007Thank you for looking into this.However, in the last code I tried, ScrolledComposite.setMinSize(someConstant, SWT.DEFAULT) was not working as expected for wrapping controls if someConstant was smaller than the default preferred width of the control. I was using expand(true) in both dimensions. Reopening.Observed: 1. The control expands in both dimensions. 2. When the horizontal size becomes smaller than someConstant, horizontal scrollbars appear and the control is not completely visible. Vertical scroll bars appear when the vertical size becomes too small to see the entire control.3. When the horizontal size is larger than someConstant, vertical scroll bars start appearing too soon. Once the wrapping control starts to stretch horizontally, it consumes less vertical space. However the scroll bars start appearing at the same point as though the control were currently occupying its minimum size. This means that you see vertical scrollbars even though the control is fully visible. The scroll bars scroll over empty space.Expected:1 & 2, but not 3. You should not see any scroll bars if the control is fully visible.I realize you could argue that 3 is a consistent behavior since the point where the vertical scrollbars appear is predictable, well-defined, and controlled by the arguments to setMinSize. However, I don't believe anyone would want to create SC instances with scrollbars that scroll over empty space, whereas almost everyone will want scrollbars when their widget can't be seen.We MUST fix this before this behavior finds its way into a release and changing it would arguably be an API change.Note: this is the exact same bug that was in GridLayout in Eclipse 2.1 and earlier, when you supplied (someConstant, SWT.DEFAULT) as size hints for wrapping widgets.Createdpatch for partial fixAlthough I would like to work with you to fix this problem. Unfortunately, I don't have time to look into this any more. I'm rolling back my fix for now and include a patch in this defect. I don't want to release a partial fix that will be considered API. Until there's a complete fix, I will not release it.Stefan, is this something you still want added?	9.0
id=156734	REOPENED	Platform	SWT	3.3	PC Windows XP	P3 major	Platform-SWT-Inbox	2006-09-08 12:56 EDT by	Eugene Kuleshov	2012-08-17 05:38 EDT (	5 users	Dropdown menu for the toolbar dropdown buttons is always positioned to the bottom edge of the dropdown button. So, if it does not fit on the screen it will go above that button and will overlap the button itself, so when you click on dropdown button that click is caught by the last item from the dropdown menu that jumps right under the mouse.To resolve this, drop down menu should be positioned at the top edge of the toolbar button of it does not fit below it.	Createdappearance of this issue on Synchronize viewCreatedWindows Explorer screenshot 1This seems to be native behaviour. This is a toolbar in Windows Explorer.CreatedWindows Explorer screenshot 2...and this is how the menu opens when there is not enough space.Closing as WONTFIX. What you describe makes sense to me, but it would have to be fixed by Microsoft.Boris, do you believe that it is going to happend?Exmple with Synchronize view is not the worst one. The last action in History dropdows for Search and JUnit views is "Clean", so I hit into it every time. Please somehow address this issue.Adding Boris to make the conversation fair. :)By the way, Back and Forward buttons in Windows Explorer actually do repositioning for dorpdowns...Our code looks very much like Snippet67 from SWT, which has the same behaviour. Normally (Windows XP), the menu drops down so that the menu's top left corner is at the position we set. If there is not enough space to let the menu drop down, the menu's bottom left corner will be at the set location.Steve, do you think we should try to be smart about this?Paging Dr. Steve. Dr. Steve, please report to the bug report.Does this mean this issue won't be addressed for 3.3?Mylar is planning to add a new trim bar at the bottom of the screen and use drop-down button on that trim. So, menu positioning is much worse there.(In reply to)Yes - we are out of time for 3.3 - we only fix critical issues at this point.Bugzilla and/or Lotus is throwing away email at random. I never got the page from Kim.***has been marked as a duplicate of this bug. ***Moving to SWT for comment.We WONTFIX this, however, the behavior you want might be implemented as part of the fix for.WONTFIXActually, we could probably hack/fix this with TrackPopupMenuEx() by remembering that a Menu.setVisible() was called in response to a drop down tool item and the menu was positioneed at the coordinates we suggested. If this happened, we could store the tool item rectangle and use it when the menu is shown.	17.0
id=292464	REOPENED	Platform	SWT	3.6	PC Windows All	P3 normal	Platform-SWT-Inbox	2009-10-15 16:39 EDT by	Stephen McCants	2017-01-05 15:41 EST (	4 users	User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.1.3) Gecko/20090824 Firefox/3.5.3Build Identifier: 20090619-0625I was using Eclipse, as I normally do and all of a sudden the mouse stopped working in Eclipse editors and views (still worked on the top level menus). I could still use the keyboard, so I finished my edit and saved with ctrl-S. Then I exited using the mouse. It exited oddly (the shutdown progress dialog never came up) with an error dialog to look at the workspace log file. I did and found lots of SWTErrors. Looks like the problem started with a no more handles error.Reproducible: Didn't trySteps to Reproduce:Unsure.	Created.log file from my workspaceAttaching the .log file from my workspace. Hope it helps.Unfortunately without steps to reproduce the bug, there isn't much we can do here.Closing as WORKSFORME. If this remains a problem, please reopen.Kevin, I've seen this problem for many months. I can reproduce it by running Eclipse for long enough. Unfortunately, I haven't found a way to identify the plugins that are not properly closing their file handles.Since this problem isn't going away, I'm reopening. If I manage to gather more data (I'll try lsof next time it hangs), I'll post it.Thanks for your help.Any other ideas on how I might find the offending plugins are welcome.Setup:eclipse.buildId=4.4.2.M20150204-1700java.version=1.7.0_76java.vendor=Oracle CorporationBootLoader constants: OS=win32, ARCH=x86, WS=win32, NL=en_USFramework arguments: -product org.eclipse.epp.package.jee.productCommand-line arguments: -os win32 -ws win32 -arch x86 -product org.eclipse.epp.package.jee.productThe way to reprduce on win7 x64:1. Please install ad-muncher which is ads-free software (it's freeware) from here:www.admuncher.com2. Restart eclipse, left-click to select any file, and right-click to select menu item as: "open with"->"Java Editor"3. Clicking switch between "package explorer" or "Console/Error Log" and Editor view4. See this error: org.eclipse.swt.SWTError: No more handlesThanks,	5.0
id=148364	REOPENED	Platform	SWT	3.2	PC Windows XP	P3 normal	Platform-SWT-Inbox	2006-06-23 06:12 EDT by	Markus Keller	2012-11-29 05:39 EST (	3 users	I20060620-1010A Tree with MULTI | FULL_SELECTION does not show the focus ring when the focus is moved with Ctrl+Up / Ctrl+Down. Can be reproduced in the ControlExample.Works fine with MULTI alone and in the Table widget.(Note that Ctrl+Space sometimes fails in the Eclipse SDK due to.)	You are right. This is platform behavior and has been there for a while.If you feel very strongly about this, we could consider drawing it ourselves (but I'd hate to do this). Please reopen as necessary.I still run into this problem every time I try to select two non-adjacent entries in the History view. I tried to resist from reopening for almost two years, but I just can't bear it another year ;-).Would be nice if you could look into custom-drawing the focus ring (in 3.5, I guess it's too late for 3.4).This problem was flagged infor p2 when doing an accessibility checklist. Using various snippets, I noticed the behavior occurs with SWT.FULL_SELECTION, regardless of whether the SWT.MULTI or SWT.SINGLE bit is used. It's worse for SWT.MULTI because if you don't set an initial selection, then there's no indicator whatsoever that the keyboard focus is in the tree.Composite composite = new Composite(parent, SWT.NONE);composite .setLayout(new FillLayout());Tree tree = new Tree(composite , SWT.MULTI | SWT.FULL_SELECTION);// Tree tree = new Tree(composite , SWT.MULTI);TreeItem item = new TreeItem(tree, SWT.LEFT);item.setText("where is the focus?");item = new TreeItem(tree, SWT.LEFT);item.setText("I'm not sure");Marking this bug with the "accessibility" keyword.This is platform behavior. Do you need to use FULL_SELECTION?(In reply to)it would look better, but I suppose we could change it (later) to work around the problem. It begs the question though why have it if it won't work...For some reason, the Windows does not draw the focus ring for full selection trees. All I can do is draw the focus ring and hope Windows doesn't fix the bug. At this point, the safest thing for you to do is get rid of SWT.FULL_SELECTION in your code.Wow, this really bites for keyboard accessibility.I'd vote for the "we draw the focus ring" approach under the assumption that in win32 anyway MS will never change it. I don't like 'augmenting' the platform but in this case it seems to have real usability impact.We're too far gone for all users of SWT.FULL_SELECTION to change their code.	8.0
id=295014	REOPENED	Platform	SWT	3.4.2	PC Windows XP	P3 enhancement	Platform-SWT-Inbox	2009-11-12 16:03 EST by	Izzet Safer	2013-05-02 02:22 EDT (	4 users	When using the SWT.TRANSPARENT style on composites and controls, the right to left orientation has serious problems. Please run the snippet to see how incorrectly the text is mirrored. Also the buttons on the shell doesn't function properly -- they get painted correctly according to RTL, however they still function in a way they were laid out LTR.This issue had very severe repercussions on our product based on 3.4.2, please address this issue promptly.Izzet	CreatedThe screenshot of the snippet.Sorry -- I had a wrong statement above about the shell buttons. They are positioned wrongly according to RTL, however function correctly as the buttons were laid out according to RTL.Where is the snippet ?Please check the java doc for SWT.TRANSPARENT, it says:WARNING: THIS API IS UNDER CONSTRUCTION AND SHOULD NOT BE USEDCreatedSnippetInteresting.. I thought I uploaded the snippet :)I'm aware of the javadoc warning. However using this style was the only solution for our particular case. I'm setting the background of a composite using a paint listener and GC.drawImage (this is a requirement on our side), and not using setBackgroundImage. The only way to make the controls in this composite transparent is then use SWT.TRANSPARENT. I cannot use setBackgroundImage and the regular transparency via Composite.setBackgroundMode(SWT.INHERIT_FORCE).I cannot complain much because of the javadoc warning, but I also wanted to open this bug to ask you finalize the design of this useful SWT.TRANSPARENT, and help you see a bug when using in RTL orientation.I also want to note that, the problem expressed on the first comment doesn't happen in my Ubuntu setup. It only happens in Windows (tried XP.)Closing as WONT FIX, I'll talk to SSQ to decide what to do about SWT.TRANSPARENT (as far as I know it should work for Shell only). We should fix (at least) the java doc.In your case, the only workaround I can suggest is to use setBackgroundImage() and setBackgroundMode(). To make sure the bottom-right corner of the image is always at the bottom-right corner of the composite you need:-handle SWT.Resize events for the composite--create a new image the size of the client area--draw the background image to the new image with right offset--set the new image in the composite (setBackgroundImage)--dispose the old image (if any)I'm reopening this defect as an enhancement request to finish implementing the correct behaviour of SWT.TRANSPARENT. As this is a useful style bit, please complete its implementation.I test in windows7, the TRANSPARENT cannot combine the SWT.Paint event listener.the painter will flicker.just modify the snippet, composite.setLayout(new GridLayout());composite.addListener(SWT.Paint, new Listener() { @Override public void handleEvent(Event event) { event.gc.drawImage( new Image(...)); } });the flicker will BOM!If remove the TRANSPARENT bit, the painter works fine.Silenio, what should we do about SWT.TRANSPARENT ?Changed it work for Shell only ? Or remove/depreacte it ?I am using Eclipse Indigo Release 2 version.I used SWT.TRANSPARENT for giving tranparent effect to Shell.But the output was different.It hides the Titlebar.Is there any development going on in this direction or should i assign it as a Bug???	10.0
id=295480	REOPENED	Platform	SWT	3.5	PC Windows XP	P3 normal	Platform-SWT-Inbox	2009-11-18 11:04 EST by	Stefan Thurnherr	2010-03-02 06:55 EST (	5 users	User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.1.5) Gecko/20091111 Firefox/3.5.5 (.NET CLR 3.5.30729)Build Identifier: I20090611-1540A Tree widget with an already selected element but nofocus does not emit a selectionChanged event when regaining focus.My use case: 2 different widgets ((Table)widget1, (Tree)widget2) as selection providers of a View. When both have a selection, and focus switches from widget1 to widget2 by directly right-clicking on the selected element of widget2, no selectionChanged event gets emitted -> the appearing context menu's selection context is the now inactive element of widget1.Workaround: catch the focus event and manually fire a selectionChanged event.Reproducible: Always	Selection events are sent when the selection changes. In the case you described, the selection is not changing (the focus is). Therefore, not sending an event is the correct behaviour, agreed ?(I verified that GTK behaves the same way).closing as wont fix.I would also not expect a selection event because the focus changes (which can also be done with the tab key).But on left-click, you currently always get a selection event (even if the item has already been selected before). You could also send a redundant event on right-click.Felipe, I basically agree with you that selectionChanged events should be fired when the selection changes.The problem here is consistency when clicking an already selected element: * For a Table element, a selectionChanged event gets fired upon a LEFT and RIGHT mouse click * For a Tree element, a selectionChanged event gets fired only upon a LEFT mouse click, but not upon a RIGHT mouse click.I suggest a consistent implementation, i.e., sending a redundant selectionChanged event as suggested by Markus in.On GTK, both the Table and Tree widgets does not send Selection events on Right click, which appears to be appropriate. May be, Windows behavior should be aligned to GTK.	4.0
id=225361	REOPENED	Platform	SWT	3.4	PC Windows XP	P3 minor	Platform-SWT-Inbox	2008-04-02 11:24 EDT by	Markus Keller	2010-08-12 16:39 EDT (	3 users	CreatedScreenshotI20080401-0851Checkboxes in disabled Tree should not keep white background (should be gray).	This WORKSFORME. CAR, can you test it on your machine and attach a working screen shot.CreateddisabledCheckboxTree.pngXP SP2, ControlExample Tree with CHECK=true and Enabled=false.This snapshot shows the checkboxes have the correct background color. They are white in the center, but grey around the outside.CreateddisabledCheckboxTree2.PNGHere it is again, but configured exactly the same as your snapshot, with Size=100 x 100 and Node 3 expanded. Color is still good.I don't know how this could happen. I cannot reproduce today with the same build. I initially saw it in an Eclipse launch configuration on the Plug-ins tab, and then reproduced in the ControlExample.Must have been an asyncExec'd April Fool's bug.The snapshot proves that you saw it! <g>I wonder if you were running low on resources or something?Have you rebooted your machine since then?I could also have forged the screenshot, but it's nice to hear you trust me ;-)Bingo! Now I remember that I had problems with the Presentation Director [1] on my machine. From time to time, it decides to set the bit depth of my display to 16 bit (which is hard to notice, since I don't play games and the performance degradation in 16 Bit mode is not very big).So, to reproduce, you have to set the Color qualify in Control Panel > Display > Settings to 16 bit. OK to WONTFIX or NOT_ECLIPSE for displays < 32 bit.[1] Presentation Director: A tool that screws up the screen resolution and window bounds when you dock/undock the laptop.***has been marked as a duplicate of this bug. ***Not sure ifis really a dup of this. This bug turned out to be a 16-bit-only problem, which only affects the Tree widget, but not Table.is about applying the fix forfor Tree as well.(In reply to)This is the openning description:"Checkboxes in disabled Tree should not keep white background (should be gray)."I see this problem on my machine (32bits).Or where you refering exclusively to the white border around of the check box ?(In reply to)Yes, I didn't even know that the background inside the checkbox can also be gray.I don't care too much about this bug (since 16-bit is a rare case), but I don't like the inconsistency between tables and trees in HEAD.Applying the same fix used in table doesn't work for the Tree.WM_NOTIFY/TVN_GETDISPINFO does not request info about the state image mask on the Tree.	11.0
id=298937	REOPENED	Platform	SWT	3.5.1	PC Linux	P3 enhancement	Platform-SWT-Inbox	2010-01-06 07:32 EST by	Leonardo Silveira	2010-01-14 11:36 EST (	3 users	would be nice to have a method on TreeCell able to return the selected cell.we can easily detect which item are selected, just adding an listener and casting event.item is enough.after google the web for some time many sources recomend me to use JFace for that, but i think that it's could be better implemented by adding a method on TreeItem.	(In reply to)There is no SWT API called TreeCell. I guess you meant TreeItem?(In reply to)sorry for mistake. That's it, TreeItem. someting like item.getSelectedColumn() or getSelectedIndex().it's very useful and don't want my app depending on jface. unless of course i have no choice, ;)TreeItem == a row in the treeYou can get the selected items using getSelection() and the selection count using getSelectionCount(). SWT does not have the concept of selection a "cell" within the row. Closing as wont fix.Please reopen the bug if you believe I've misunderstood your request. Thank you.(In reply to)thanks for the patience.see, the snippet 111 shows me how to place a dynamic editor on my tree, actually it also have calls to inform which column i want to edit.by adding the tree observer to watch clicks i can recover the item and if i always edit the very same column it's ok.i was wondering a way (like jface does, but i still don't want to depend on jface, since would be nice to have it as a core feature) to given that i have the selected TreeItem also have a method do figure which cell/column exactly i clicked.select the row the toolkit already does and does it pretty well, i have getSelection and event.item to serve me. the problem is just which column/cell on that item the user clicked exactly.i'm reopening and hope to see that sugar in 3.6, ;)thanks in advance.	4.0
id=302343	REOPENED	Platform	SWT	3.5	PC Linux	P3 normal	Platform-SWT-Inbox	2010-02-09 17:53 EST by	Alfonso Parra	2010-09-09 15:53 EDT (	4 users	Build Identifier: I have tried with several onesI have found it in different versions of Galileo and in one of Ganymede on Centos 4.7 and Centos 5.2It pastes previously deleted text and ctrl Z removes what has being pasted one at a time.Reproducible: AlwaysSteps to Reproduce:1. Delete some text2. Keep doing what you were doing3. One of the open classes will show multiple errors. You can remove them deleting them or with crl Z	Sending to SWT - any idea what could be causing this, or how Alfonso can help us understand what's happening?I tried to take some screen shots to document the bug: "Here you can see two classes with no errors", "I am going to delete this line", etc., but when I did it, nothing happened, no pasting whatsoever.The bug just disapeared.I assume, but have no proof that the bug has something to do with the clipboard and the screen shots interfered somehow.Now everything is back to normal and the bug is acting as described.If I can help in anyway, please let me know.AlfonsoVersion: 3.4.2Build id: M20090211-1700Redhat LinuxI believe this is what I am seeing. The paste buffer will occasionally randomly be inserted into (somewhat) random places in the file being edited. Sometimes if there is just one occurrence of the insertion and I delete the inserted text, upon a 'save' the same text will appear further down in the file. Repeated <ctrl>z will remove the text (as well as anything I added before noticing it). *Sometimes* the text will be unrelated to anything I am editing, including random text that seems to be part of a Thunderbird email message!?!?This *may* be reproduced by (1) copy some text, (2) highlight some other text, (3) <ctrl>v to replace the selected text with the copied text.(4) Save(4) Wait a while or do other things. Random insertion(s) may occur.I wonder whether this is due to. Can you please try with the latest version of Eclipse, or does the problem go away if you disable Klipper/Glipper on your Linux machine ?As tofrom Praveen:The bug has not being removed from Helios Eclipse.I am using Centos 4.8 and I do not know how to deactivate Gliper if present in that Centos The bug is more bothersome that harmful, except in the cases in which the pasting occurs on places where it makes sense for the compiler, so it is not marked as an error, in those cases it is very difficult to find what went wrong with the program.I don't think this API makes sense for StyledText.To restore the editor we would need to savethe textthe stylesthe selectionthe boundsthe horizontal/vertical scroll offsetthe fontthe foreground/backgroundother line attributes (alignment, justify, wrap, indent, wrapIndent)bidi segmentsetcclosing as won't fix.on a side note, I tested setTopPixel() and it worked fine, please report a bug if you have case where it fails.my appologies, obviously I post the comment in the wrong bug report. please ignore it.	7.0
id=304922	REOPENED	Platform	SWT	4.0	PC Windows 7	P3 enhancement	Platform-SWT-Inbox	2010-03-06 14:42 EST by	Ricky Patel	2016-11-25 03:01 EST (	4 users	This has been requested a few times but I haven't been able to find a formal bug request for this feature so I thought I would write one.The request is for a new method called Shell.requestAttention() of which allows a developer to inform a user that there is new information for a specific shell without interrupting a user's current process. This functionality is much like setActive() where for windows the icon in the task bar will blink or for Mac the icon will jump, except setActive will also bring the shell to the top of the application if the user is any shell in the Application. Overall this can be very distracting for a user. Consider an instant messaging program. While using setActive() if you were typing to user1, and then user2 sent you a message, user2's window would steal focus and interrupt what you were typing to user1.	See org.eclipse.swt.TrayI don't believe that you understand the request. I know that SWT provides a way to give the user system tray notifications such as balloons, very powerful but overall this is not the functionality that I'm looking for.What I'm looking for is more like the FlashWindow(hWnd, bInvert) method in the Windows API. Where the actual shell program name in the TaskBar will blink. This functionality has nothing to do with the system tray.I've attached a picture with a red box around what I'm understanding as the taskbar.Createdexample of a taskbar iconFWIW, in windows I think you can do this by minimizing a window then calling "forceActive" on it. I think so, anyway.Now that I understand what you mean, I like the suggestion for the new API.We recently add a TaskItem class that is exactly what you showed in.Unfortunately TaskItem in only available on Windows 7 and MacOS, so it might not be the best place for it.Other problem is that API freeze is tomorrow, I won't be allowed adding any new API till 3.6 is out.I've seen the "blinking taskbar" in Linux (albeit inadvertently) before, so it should be possible there, too, theoretically (at least in gnome).in response to minimizing the window and calling forceActive. Though this will work under eclipse supported platforms, this won't work in windows 7 (which I'm assuming will be supported soon). The reason for this is a change in how alt tab functions in that it will show you the outlines of where your windows are. I think a user would be confused if the outline for their chat window disappearedI'm not familiar with the new TaskItem API () nor the functions associated with it... Is there a place where I may look this up? Google came up with nothing...Also, it seems that this is a well received feature request... I'm not to familiar with native programming in java but I can research into what functions need to be called to the os level to cause a shell to blink. What OS's would need to support this feature? Windows, MacOSX and Linux... Any others?	8.0
id=306156	REOPENED	Platform	SWT	3.6	PC Windows XP	P3 normal	Platform-SWT-Inbox	2010-03-17 05:27 EDT by	Sebastian Zarnekow	2012-11-09 09:49 EST (	4 users	This happens not on a Mac but on Windows.See ContentAssist in Xtext grammar editor for TypeRefs, e.g. type=[JvmDec<invoke CA here>].	The problem manifests itself if the labels are italic or the font-size is different from the default. It seems that the computation of the column width does not honor the applied style-ranges.Steps to reproduce the issue on windows:1) Create a new Xtext project2) Change the grammar file as follows:grammar org.xtext.example.mydsl.MyDsl with org.eclipse.xtext.common.Terminalsgenerate myDsl ""import ""Model: type=[Model]; 3) Invoke ContentAssist at the following position |Model: type=[|Model];Note the truncated labels.CreatedScreenshot 1CreatedScreenshot 2The screenshots illustrate the problem. As the size 4th entry in the proposal list changes when it's selected, I'ld guess that it has something to do with the computation of the width of the cells. I guess that the support for StyledStrings in table columns is implemented by means of the TableOwnerDrawSupport. Should it handle SWT.MeasureItem explicitly instead of skipping the event?Is the problem on Windows ?Any chances you can provides us with snippet to reproduce the problem ?CreatedReproducable exampleRun Main#main on windows to see the misbehaviour on windows. Looks good on Mac. The code is written against 3.5 but fails on 3.6 as well. You may have to change fontData.style = SWT.. to fontData.setStyle(SWT... ) on 3.6.I have the same bug on Windows XP using Eclipse 3.5.after some debug, The first paint of the proposal called from xtext code ( org.eclipse.jface.text.contentassist.CompletionProposalPopup.displayProposals() line: 1192 ) shows the text correctly, but right after that, there is second paint issued from Windows and then the string are truncated.the value of drawx in the following fragment is not the same from one paint to the otherorg.eclipse.swt.graphics.TextLayout.draw(GC, int, int, int, int, Color, Color, int).....(line 618) drawX = alignmentX; for (int i = 0; i < lineRuns.length; i++) { StyleItem run = lineRuns[i]; TextStyle style = run.style; boolean hasAdorners = style != null && (style.underline || style.strikeout || style.borderStyle != SWT.NONE); if (run.length == 0) continue; if (drawX > clip.x + clip.width && !hasAdorners) break;.....this make it break at the last line too soon.Is there any workaround please ?I have found a workaround to this truncatenation issue.Use an image when creating your completion proposal.This will not truncate the following text.example : acceptor.accept(createCompletionProposal(validString, validString, COMPONENT_IMAGE, context));don't know if this is still an issue. Please reopen if that's the case.sorry wrong bug :-)	11.0
id=303321	REOPENED	Platform	SWT	3.6	PC Windows XP	P3 major	Platform-SWT-Inbox	2010-02-19 09:59 EST by	Dani Megert	2010-03-17 14:15 EDT (	5 users	I20100217-1031.1. start Eclipse2. open the following patch (11.52 KB) in Firefox (important):3. select all and copy4. paste into the Package Explorer==> OOME!ENTRY org.eclipse.ui 4 0 2010-02-19 15:55:49.490!MESSAGE Unhandled event loop exception!STACK 0java.lang.OutOfMemoryError: Java heap space at org.eclipse.swt.graphics.ImageData.<init>(ImageData.java:448) at org.eclipse.swt.graphics.ImageData.internal_new(ImageData.java:515) at org.eclipse.swt.internal.image.GIFFileFormat.readImageBlock(GIFFileFormat.java:392) at org.eclipse.swt.internal.image.GIFFileFormat.loadFromByteStream(GIFFileFormat.java:106) at org.eclipse.swt.internal.image.FileFormat.loadFromStream(FileFormat.java:48) at org.eclipse.swt.internal.image.FileFormat.load(FileFormat.java:84) at org.eclipse.swt.graphics.ImageLoader.load(ImageLoader.java:130) at org.eclipse.swt.graphics.ImageDataLoader.load(ImageDataLoader.java:22) at org.eclipse.swt.graphics.ImageData.<init>(ImageData.java:331) at org.eclipse.swt.graphics.Image.<init>(Image.java:541) at org.eclipse.compare.internal.ImageMergeViewer.setInput(ImageMergeViewer.java:95) at org.eclipse.compare.internal.ImageMergeViewer.updateContent(ImageMergeViewer.java:60) at org.eclipse.compare.contentmergeviewer.ContentMergeViewer.internalRefresh(ContentMergeViewer.java:783) at org.eclipse.compare.contentmergeviewer.ContentMergeViewer.inputChanged(ContentMergeViewer.java:683) at org.eclipse.jface.viewers.ContentViewer.setInput(ContentViewer.java:274) at org.eclipse.compare.CompareViewerSwitchingPane.setInput(CompareViewerSwitchingPane.java:270) at org.eclipse.compare.internal.CompareContentViewerSwitchingPane.setInput(CompareContentViewerSwitchingPane.java:132) at org.eclipse.compare.CompareEditorInput.internalSetContentPaneInput(CompareEditorInput.java:839) at org.eclipse.compare.CompareEditorInput.access$8(CompareEditorInput.java:837) at org.eclipse.compare.CompareEditorInput$11.run(CompareEditorInput.java:782) at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70) at org.eclipse.compare.CompareEditorInput.feed1(CompareEditorInput.java:771) at org.eclipse.compare.CompareEditorInput.access$3(CompareEditorInput.java:770) at org.eclipse.compare.CompareEditorInput$5.open(CompareEditorInput.java:656) at org.eclipse.compare.CompareViewerPane.open(CompareViewerPane.java:325) at org.eclipse.jface.viewers.StructuredViewer$2.run(StructuredViewer.java:842) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.internal.JFaceUtil$1.run(JFaceUtil.java:49) at org.eclipse.jface.util.SafeRunnable.run(SafeRunnable.java:175) at org.eclipse.jface.viewers.StructuredViewer.fireOpen(StructuredViewer.java:840) at org.eclipse.compare.structuremergeviewer.DiffTreeViewer.internalSetSelection(DiffTreeViewer.java:666) at org.eclipse.compare.structuremergeviewer.DiffTreeViewer.internalNavigate(DiffTreeViewer.java:537)	can you attach only the image ?this code worked for me:new ImageData("C:\\Users\\ssq\\Desktop\\Felipe\\workspace\\org.eclipse.jface\\src\\org\\eclipse\\jface\\wizard\\images\\stop.gif");Can't you reproduce it with the detailed steps given in?(In reply to)noI cannot reproduce on I20100309-0100.The important part of the steps is that you start Eclipse without changing the defaults (especially without giving more memory). When I do this on Windows XP using 3.6 M6 (I20100312-1448) and a new workspace then I can constantly reproduce the problem.It tries to create a byte array with 16140 bytesPerLine and height of 16139.Might also be important: make sure that the- browser loads the patch using 'Western (ISO-8859-1)' encoding- workspace encoding is 'Cp1252' (which should be the case when starting a new workspace on Windows XP)Okay, I can reproduce the problem.There is no bug in our end. The byte stream is corrupted (probably copying binary data as text to the clipboard did the trick). When the loader reads image header it tries to create a very large image and runs out of memory (the bytes for the header are bogus).If you save the attachment to a file and apply the patch from that file it works.closing as wont fix. sorry.I agree on that.I contradict ;-)The SWT contract clearly specifies: * <li>ERROR_INVALID_IMAGE - if the image stream contains invalid data</li>which is something the client can prepare for.Since you just agreed that the stream seems corrupted I expect that this is correctly detected and reported instead of throwing an OOME.(In reply to)I don't think it is possible to detect this case. Not all bytes are wrong, the signature data and other section of the fine. The header also specifies an image 16140x16139, which is a valid input. We know that is garbage because we know the image is only 13x13.You can also know it when the given stream is much smaller than the specified size, right?We checked again all the fields and there is nothing we can use to detect that the image is invalid. Several bytes (>x7F) where replaced by 0x3F (question mark, used to represent undefinied character) in this case. But nothing we can use. We don't have the byte count of the stream.I'd assume you can read the whole stream which results in the byte count.Reading the whole stream is not efficient and it is wrong because the loader is supposed to leave the stream pointing to the end of the image (the stream may contain other content). We could catch OOME exceptions and throw invalid image exception. but this does not seem correct because we cannot determine if it is really an out of memory situation or just a corrupted image.Well, in 99% of the case where the data is correct) you do have to read the whole stream in order to create the image, so I don't buy that argument.I didn't have time to read through the SWT code in detail but I'm pretty confident that this situation can be detected and reported. You could even try to detect it only after getting the OOME.	14.0
id=308651	REOPENED	Platform	SWT	3.6	PC Mac OS X	P3 normal	Platform-SWT-Inbox	2010-04-09 10:27 EDT by	Thomas Watson	2011-03-17 08:39 EDT (	2 users	I20100406-1034I've only tried this on Mac Cocoa. If I open Peferences and select General->Compare/Patch then the the selection on the tree of preferences jumps down to General->Startup and Shutdown. The preference page still looks to be the Compare/Patch page, but if you try to change any preference then it will not work. You have to select Compare/Patch again without closing the Preferences dialog to make it work. The second time you select Compare/Patch it does not jump to Startup and Shutdown.You can continue to reproduce the problem if you select any other preference page, close the dialog, reopen preferences and try to select General->Compare/Patch again.	(In reply to)Looks like a Mac specific issue, couldn't reproduce on Windows.This should have been fixed with. I can't reproduce in I20110310-1119 Cocoa. Please reopen if you still see this with recent builds.Still an issue for me on I20110315-0800 with OSX 10.5.8.	3.0
id=318881	REOPENED	Platform	SWT	3.7	PC Windows Server 2003	P3 normal	Platform-SWT-Inbox	2010-07-05 07:47 EDT by	Tomer Mahlin	2012-08-08 01:29 EDT (	13 users	Build Identifier: What is it ?-------------- Bidi layout engine (or Bidi engine) transforms text from one Bidi layout to another Bidi layout in accordance with Bidi Unicode algorithm. For more info on Bidi Unicode algorithm please read following article:Why do we need it ?-------------------- Bidi engine is used in many contexts when change in attributes of Bidi text is required. For example in transforming Bidi text from visual Bidi layout to logical Bidi layout (e.g. DTP). What is currently available ?------------------------------- Currently Eclipse is packaged with following main Bidi engines:1. IBM Bidi engine available from IBM JDK: com.ibm.bidiTools.bdlayout.*2. Bidi engine from ICU4J (): com.ibm.icu.text.Bidi3. Bidi engine available from JDK: java.text.Bidi In terms of functional completeness the main Bidi engines of interest are that of IBM JDK and ICU4J. What is missing ?------------------ Eclipse can't depend on IBM JDK. This is because it also support other JDK and since Bidi engine is not available in IBM JDK for all platforms (it is available for Windows, Linux but not on HP-UX, Sun etc.). ICU4J Bidi engine is less functional than that of IBM JDK (lacks of several important features) and less convenient for usage. What can be done ?------------------- Basically we have following options:1. Enhance ICU4J Bidi engine to match the level of IBM JDK Bidi engine2. Provide the enhancements for ICU4J Bidi engine on the Eclipse level3. Adopt another version of Bidi engine. For example, JTOpen () Bidi engine: com.ibm.as400.access.Bidi*4. Develop brand new implementation of Bidi engine in Eclipse.Reproducible: Always	Without any usage in the SDK it seems wrong to add it here (option 2). I think the right approach is to go with 1. and offer the bundle via Orbit, so that interested parties can take and include it from there.At any rate Platform Text is too high in the stack. This rather belongs to either SWT or Equinox Components where the enhanced TextProcessor will be hosted. Trying SWT for now, but as said, this is rather a bug for Orbit and ICU4J.The originally opened defect was a transcript of idea voiced out by Lina. I believe Lina is planning to open a separate bug in which she will share her perspective on the problem. Thus, I am closing this bug as irrelevant.Just wanted to provide an update on the progress made in this context. Most prominent and also cheap direction to proceed with seems to be option 1 (work with ICU). We are currently checking with ICU if it is possible to provide the enhancement of Bidi engine as part of ICU itself or as a separate ICU dependent package. If latter option is chosen, we will need to pack this separate package with Eclipse (or via Orbit). Thus I prefer to keep this defect open for the time being.	3.0
id=309286	REOPENED	Platform	SWT	3.6	PC Linux	P3 major	Platform-SWT-Inbox	2010-04-15 06:30 EDT by	Bhanu Pratap	2011-03-16 07:25 EDT (	7 users	Build Identifier: I20080617-2000F12 key does not receive SWT.KeyDown or KeyPressed event when used in eclipse's plugin environment. It works fine if used as a java Application. Similar behaviour is observed for F10 Key.Reproducible: AlwaysSteps to Reproduce:1. Use the F12F10SWTBug.zip to form an eclipse plugin project.2. Test this plugin by using "Eclipse Application" from Debug/Run Configurations. (Eclipse Application should be configured to run org.eclipse.ui.ide.workbench application)3. Once the eclipse Application is started, go to Window->Show View->Other-> Sample Category -> F12 F10 SWT. Once the application is started, its text area displays the Key event recieved. Note that pressing F12 on buttons does not recieve SWT.KeyDown and KeyPressed events. Similarly for F10 Key.	CreatedPlugin project zip file containing source code for recreating this bugSWT is sending the key events. The workbench has a display filter the changes the event type to SWT.None.F10 opens the left most (File) menu. F12 activates the open editor.These are being processed by the keybindings filter (Keys preference page) first.PWIs there a way to overwrite the Keybindings?(In reply to)For F12, change the keybinding in the keys preference page.For F10, that is done by SWT and cannot be changed. If you add a menu bar to your SWT only snippet, you'll see you no longer get F10 events at all.PW(In reply to)Is this the correct behaviour?? Shouldn't it be like this:Window which has the focus should get all the events which it has registered for. Also, once such application is deployed how are we expecting an end user to know that his/her F12/F10 keys are not working because they are being filtered by environment's key binding filter. Here is an example:We have a product which emulates Host Screen and is in the form of an OSGI container. It is developed on eclipse. Now, if a user wants to send F12 key to the host he would not be able to do so because F12 key doesn't work because it is being consumed by the eclipse's Key binding filter instead of the application window which is in focus.(In reply to)Because your application is responsible for its keybindings.If you use the default scheme, then you will consume F12. Publish that. If you don't want F12 to mean activate editor, then you need to use your own scheme, not the default scheme. Check out the keybinding extension point description for more information. This should only be a problem if you are starting up the Workbench (org.eclipse.ui), not if you deploy a bundle in OSGi.F10 should have an immediately obvious action (jumping to the menu bar and activate the File menu). But this should only be a problem if you have an SWT Menu bar. Do you?The only way I can think of to work around F10 is the way that something like vnc does: Pick a keybinding that will pop up a menu. That menu can send that key as well as F10 through your host screen.The other option is to re-open this bug as an enhancement request against SWT to provide API to allow F10 to be overridden. That could be looked at in 3.7.PW(In reply to)Paul, I was not able to confirm the above:public static void main(String[] args) { Display display= new Display(); Shell shell= new Shell(display); shell.addListener(SWT.KeyDown, new Listener() { public void handleEvent(Event e) { System.out.println("KeyDown " + e.keyCode); } }); shell.addListener(SWT.KeyUp, new Listener() { public void handleEvent(Event e) { System.out.println("KeyUp " + e.keyCode); } }); Menu menu = new Menu(shell, SWT.BAR); shell.setMenuBar(menu); MenuItem item = new MenuItem(menu, SWT.CASCADE); item.setText("File"); shell.setSize(300, 300); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } display.dispose();}Note that F10 is received by the listener, after that focus moves to the first menu item (which will show in blue). With the menu item blue press another key down, this key down is lost, the menu loses focus.You can prevent the OS from changing to focus to the menu during f10 by setting doit=false in the event handler.(In reply to)With your snippet, I get KeyUp (but no KeyDown on linux).If I add items under File, then I no longer get any KeyDown or KeyUpMenu file = new Menu(item);item.setMenu(file);new MenuItem(file, SWT.PUSH).setText("One");new MenuItem(file, SWT.PUSH).setText("Two");new MenuItem(file, SWT.PUSH).setText("Three");PW(In reply to)Thank you Paul, defining the new key binding for F12 key using org.eclipse.ui.bindings extension point works fine for F12 key. But the issue with F10 key still remains, and I was also able to confirm the above i.e. No key event received when your application have a SWT Menu bar. Going by your suggestion I am re-opening this bug as an enhancement request in SWT component. Bhanu(In reply to)Which platform and eclipse build are you seeing this problem? I believe we fix the problem Paul mentioned above () on Linux (see).(In reply to)I am able to recreate the problem using eclipse 3.6.1 on linux. The sample used to recreate the problem is there in, with a modification of adding a menu item under the"file"menu. The problem is that no key down or key up events are received by the listener when F10 key is pressed, as mentioned by Paul in. While on windows, only key released event is received. Bhanu.was only fixed in 3.7 M2. Please try that build.(In reply to)Thank you Silenio. I verified with 3.7, the listener was now able to get KeyDown events. Also, noticed that still no KeyUp event for F10 and the focus goes on to the menu bar's first menu item. I guess this behaviour can be changed by overriding the OS's key binding for F10. Bhanu.	14.0
id=325222	REOPENED	Platform	SWT	3.6	PC Mac OS X	P3 normal	Platform-SWT-Inbox	2010-09-14 06:44 EDT by	Markus Keller	2012-05-15 15:13 EDT (	3 users	3.6Shift+Enter (Enter from the numpad, not Return) gives a strange invisible character 0x03. In the Find/Replace dialog, we now use Shift+Return to find backwards, but this doesn't work on Cocoa, since we get this character instead of the expected Traverse event. Shift+Return is OK.BTW: Ctrl+Return and Ctrl+Enter also result in strange characters, but that's maybe just platform behavior (I do get the expected Traverse event).public class Snippet { public static void main(String[] args) { Display display = new Display(); Shell shell = new Shell(display); shell.setLayout(new GridLayout(1, false)); final Text text = new Text(shell, SWT.MULTI | SWT.BORDER); GridData layoutData = new GridData(SWT.FILL, SWT.FILL, true, false); layoutData.widthHint= 300; layoutData.heightHint= 60; text.setLayoutData(layoutData); final Label label= new Label(shell, SWT.NONE); layoutData = new GridData(SWT.FILL, SWT.FILL, true, false); layoutData.widthHint= 300; layoutData.heightHint= 60; label.setLayoutData(layoutData); text.addModifyListener(new ModifyListener() { public void modifyText(ModifyEvent e) { String origText = text.getText(); byte[] bytes; try { bytes = origText.getBytes("UTF-16BE"); String string = Arrays.toString(bytes); label.setText(string + ": \"" + origText + "\""); } catch (UnsupportedEncodingException e1) { e1.printStackTrace(); } } }); shell.pack(); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } display.dispose(); }}	Shift + return is taking a different path through the key handling code. It ends up in Control.insertText because it doesn't map to some other NSResponder message, and we aren't calling translateTraversal in insertText.Patch coming in a moment...CreatedFixCall translateTraversal in insertText as the enter key may find its way into this method.insertText does not need to return boolean as it's a notification, but that's a bigger and unrelated patch.Fixed > 20100920.Can't not call translateTraverse in insertText. This has causedbtw, the bugzilla is wrong for this fix, seeWhat mac are you on Markus ? 10.6 or 10.5 ?I removed the fix but I do not see the shift+enter bug.I'm on 10.6. I can check it again tonight (my Mac is at home, and I don't trust VNC to understand the difference between the Return and the Enter key).Markus, I removed the fix from Scott.I can't reproduce the problem.Let me know if the bug comes back and we will look at another approach for solve it (we really can't use the fix Scott released as it breaks Japanese input). Thank youSorry, the Snippet didn't actually show the real problem, which is the missing Traverse event in Shift+Enter. Add this to the snippet to see the events: text.addTraverseListener(new TraverseListener() { public void keyTraversed(TraverseEvent e) { System.out.println(e); } });The fix was indeed not good, since it also caused double Traverse events in some cases. HEAD doesn't have that problem any more, but the original problem is back now (the missing Traverse event on Shift+Enter).I don't know what to tell you. I don't see the problem, I am running your snippet+traverse_listener with SWT from HEAD.This is the output for shift+enter:Event {type=31 Text {} time=35617374 data=null x=0 y=0 width=0 height=0 detail=4}Is your keyboard german or something else ?I have Swiss German keyboard, but I still have the bug when I switch to U.S.Please try it again with the typed TraverseListener from. That one also gives you the stateMask and the keyLocation, so that you can be sure you see the right event (not e.g. one without Shift). With that and the patch from(to make the Events more readable), I get this on Enter:TraverseEvent{Text {} time=110304824 data=null character=''=0xd keyCode=0x1000050 keyLocation=0x2 stateMask=0x0 doit=false detail=4}On Shift+Enter, I don't get a Traverse event. Same behavior when I show the Mac OS Keyboard Viewer, hold down Shift on the keyboard and then click Enter on the numpad of the on-screen keyboard.You can also use the ControlExample to see the events.- for Shift+Enter, I get:KeyDown [1]: KeyEvent{Text {} time=111487897 data=null character='\0'=0x0 keyCode=0x20000 keyLocation=0x4000 stateMask=0x0 doit=true}KeyDown [1]: KeyEvent{Text {} time=111488673 data=null character=''=0x3 keyCode=0x1000050 keyLocation=0x2 stateMask=0x20000 doit=true}- for Enter, I get:Traverse [31]: TraverseEvent{Text {} time=111495001 data=null character=''=0xd keyCode=0x1000050 keyLocation=0x2 stateMask=0x0 doit=false detail=4}KeyDown [1]: KeyEvent{Text {} time=111495001 data=null character=''=0xd keyCode=0x1000050 keyLocation=0x2 stateMask=0x0 doit=true}KeyDown [1]: KeyEvent{Text {} time=111495001 data=null character=''=0xa keyCode=0x1000050 keyLocation=0x2 stateMask=0x0 doit=true}I did some more testing on another Mac with different keyboards. I could not reproduce the Shift+Enter problem with recent Apple keyboards (US or Swiss German models).But I could reproduce with a Lenovo Swiss German Windows keyboard (same behavior as my old Swiss German keyboards from Macally and Apple at home).I can also reproduce when I connect to the Mac via UltraVNC from a Lenovo Windows 7 notebook (engage NumLock to turn the Return key into an Enter key).So it looks like a problem that only shows up with certain keyboards (independent of the keyboard settings in the OS).I also tried to see what System Preferences > Keyboard > Shortcuts does with the keys. The new Apple keyboards don't allow me to use Enter or Shift+Enter as shortcuts, but the older keyboards allow them.In the snippet, I can produce the 0x03 character and the missing traverse event also with the new Apple keyboards, but I have to press Ctrl+Option+Enter instead of Shift+Enter.Tentatively setting milestone to 3.7 RC1, but this could also be skipped if no safe fix can be found.We are not going to get this fixed in 3.7.	13.0
id=326376	REOPENED	Platform	SWT	4.1	PC Windows 7	P3 normal	Platform-SWT-Inbox	2010-09-28 03:20 EDT by	None	2016-11-09 10:06 EST (	5 users	Build Identifier: 20100917-0705If a column in a tree is smaller than the text in the column, "automatic" tooltips are enabled. However, if the columns in the tree are swapped via drag&drop, the tooltip contains the text of the old column.Reproducible: AlwaysSteps to Reproduce:1. Open Java Perspective, Problems view2. Resize resource column in problems view so the text in it won't fit.3. Swap resource and path column.4. hover over an entry in the resource column.5. the wrong tooltip should be displayed	*** This bug has been marked as a duplicate of***I don't think this is a duplicate of.This bug here is about SWT Tree and 131182 is about SWT Table, also the behaviour is different. In Table the tooltip is shown in another cell with the correct text for that cell. In Tree, you get a tooltip in the cell where the mouse is but with the wrong text.Reopening.has an SWT snippet.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***CreatedSnippet to reproduce the errorI turned the method frominto a complete standalone snippet. To reproduce the error, switch column positions by dragging a header with the mouse, then reduce the size of the 2nd column so the text in the cells is not completely visible. Then hover over a cell with cut off text in the 2nd column to get a tooltip, which shows the text from the 1st column in the same row.I also reproduced the Problem with Eclipse 4.6.1 and Windows 7. The ToolTips are wrongly displayed if I reorder the columns of the Tree.When is it planned to fix this Bug?	7.0
id=318942	REOPENED	Platform	SWT	3.6	PC Windows 7	P3 normal	Platform-SWT-Inbox	2010-07-05 17:09 EDT by	Christopher Deckers	2015-12-01 04:46 EST (	10 users	Build Identifier: 3.6Creating an instance of an OLE component (not embedded) fails:OleAutomation application = new OleAutomation("Excel.Application");=> org.eclipse.swt.SWTException: Failed to create Ole Client. result = -2147221164If we change the code in the OleAutomation(String) constructor to add the "COM.CLSCTX_LOCAL_SERVER" flag, then it works:int result = COM.CoCreateInstance(appClsid, 0, COM.CLSCTX_LOCAL_SERVER | COM.CLSCTX_INPROC_SERVER, COM.IIDIUnknown, ppvObject);Reproducible: AlwaysSteps to Reproduce:1. new OleAutomation("Excel.Application");	Fixed in HEAD > 20100812Same problem with a fresh install:---Eclipse for RCP and RAP DevelopersVersion: Helios Service Release 2Build id: 20110218-0911---Why is the "COM.CLSCTX_LOCAL_SERVER" flag is still missing in my sources?The code is not in Helios, Indigo only.Switched to Indigo and problem remains. The COM.CLSCTX_LOCAL_SERVER flag is only added in case of excel automation:if (progId.startsWith("Excel")) flags |= COM.CLSCTX_LOCAL_SERVER;Since I work with MS Word I can tell you that it is needed for Word automation, too.Probably it's the same with all MS Office products.Okay, I can't do anything for Indigo anymore. Lets target this for 3.8Is it possible for this fix to come as part of a patch update. I have an application that uses Outlook as a key component. My entire office is in the process of migrating to Windows 7, and this causes a major issue for me.Hey Bob, what version of Eclipse are you using ?Can you provide a patch for this bug ?It seems that all that is needed is to set COM.CLSCTX_LOCAL_SERVER in more cases than progId.startsWith("Excel")Is that the fix for you too ?(In reply to)I just got Indigo, and am running SWT 64-bit 3.7.1I think that fix will work for me. The only difference with my current code is that I am making use of OleControlSite, then declaring OleAutomation(OleControlSite)Looking at that source, I don't see any of the CoCreate logic that is part of OleAutomation(String)However, if any fix can be applied, I'd take it, if there is no workaround.I would hate to re-tool all my OLE code to use some other means.Robert, the fix suggested here goes in:OleAutomation(String)If you are saying you are not using the method then how is this going to help you ?Try to get SWT source and try differents fixes ?SeeYou can also attach the snippet to this bug (or open a new one) so I can try to reproduce your problem. The sooner I'll have time to look into this is next week.(In reply to)I figured how to export as a jar, but I am running Windows 7 64 bit. How do I export the SWT as 64 bit?it would probable be easier to run with 32bit eclipse on a 32bit VM.Anyhow, get the bundle org.eclipse.swt.win32.win32.x86_64 (instead of org.eclipse.swt.win32.win32.x86) and export that as Deployable plug-ins and fragments. I think that should take care of the 32->64 java code conversion before compiling and packing all up.it that doesn't work try running the task replace.32.to.64 in org.eclipse.swt/buildSWT.xml and then export the jars the usual way.Hello,This bug is alwais present in Helios RCP distibution :org.eclipse.swt.SWTException: Failed to create Ole Client. result = -2147221164 at org.eclipse.swt.ole.win32.OLE.error(OLE.java:302) at org.eclipse.swt.ole.win32.OleAutomation.<init>(OleAutomation.java:159)With this code :OleAutomation outlook = new OleAutomation("Outlook.Application");Is a correction planned for other MS applications?Kepler RCP distribution, sorry for the mistake...Any update on this case? Solving this is very easy. Just do following: (simple, retains backward compatibility, and do the job)public OleAutomation(String progId, int flags) { initialize(progId, flags);}public OleAutomation(String progId) { int flags = COM.CLSCTX_INPROC_SERVER; if (progId.startsWith("Excel")) flags |= COM.CLSCTX_LOCAL_SERVER; initialize(progId, flags);}public void initialize(String progId, int flags) { try { OS.OleInitialize(0); GUID appClsid = getClassID(progId); if (appClsid == null) { OS.OleUninitialize(); OLE.error(OLE.ERROR_INVALID_CLASSID); } long /*int*/[] ppvObject = new long /*int*/[1]; int result = COM.CoCreateInstance(appClsid, 0, flags, COM.IIDIUnknown, ppvObject); if (result != COM.S_OK) { OS.OleUninitialize(); OLE.error(OLE.ERROR_CANNOT_CREATE_OBJECT, result); } objIUnknown = new IUnknown(ppvObject[0]); ppvObject[0] = 0; result = objIUnknown.QueryInterface(COM.IIDIDispatch, ppvObject); if (result != COM.S_OK) OLE.error(OLE.ERROR_INTERFACE_NOT_FOUND); objIDispatch = new IDispatch(ppvObject[0]); ppvObject[0] = 0; result = objIDispatch.GetTypeInfo(0, COM.LOCALE_USER_DEFAULT, ppvObject); if (result == OLE.S_OK) { objITypeInfo = new ITypeInfo(ppvObject[0]); } } catch (SWTException e) { dispose(); throw e; }}(In reply to Zygmunt Horodyski from)Do you have a test snippet handy, which reproduces this problem ?something simple like that:import org.eclipse.swt.ole.win32.OleAutomation;import org.junit.Test;public class OleAutomationTest { @Test public void testThatLocalServerApplicationIsAccessible() { new OleAutomation("Outlook.Application"); // No error has occurred }}Actually, I'm not using Outlook.Application in my case but company software, but this two has the same problem.(In reply to Zygmunt Horodyski from)Same here, I'm also not using Outlook.. Please suggest any alternate out there in open/public to try ?There are also applications like InternetExplorer.Application.1Easiest way to find application that needs to be started as COM.CLSCTX_LOCAL_SERVER is to open registry and under HKEY_CLASSES_ROOT\CLSID search for LocalServer32 and if you will find one then if there is folder ProgID you can read its progId there.Any update here?	19.0
id=333130	REOPENED	Platform	SWT	3.4.2	PC Linux-GTK	P3 normal	Platform-SWT-Inbox	2010-12-23 01:07 EST by	None	2013-09-20 13:56 EDT (	8 users	Build Identifier: JFace 3.4.2SLED11+SP1, the messagedialog UI incorrect with RTL, the message should use right alignment.Reproducible: AlwaysSteps to Reproduce:1. run my sample2: click any buttons, will show message dialog.Bug:The message should use right alignment.	Createdsample codeCreatedscreen shotis the problem on Linux or Windows ?It is only reproduced on SLED11+SP1(Suse11+ SP1)(In reply to)Don't you see the same problem on windows ?That MessageDialog is provided by JFace, moving to UI.(In reply to)it only reproduce on SLED11+SP1(Suse11+ SP1), not reproduce this on windowsSnippet:public class PR333130 {public static void main(String[] args) { Display display = new Display(); Shell shell = new Shell(display, SWT.DIALOG_TRIM|SWT.RIGHT_TO_LEFT); shell.setSize(500, 375); shell.setLayout(new GridLayout()); final Label l = new Label(shell, SWT.WRAP); l.setText("\u0646\u0635 \u0627\u0644\u062A\u0631\u0634\u064A\u062D"); l.setLayoutData(new GridData(SWT.FILL, SWT.BEGINNING, true, false, 0, 0)); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } display.dispose();}}*** This bug has been marked as a duplicate of***Sorry,uses a Text. This bug is on a Label.What is the GTK version on the platform reporting the bug ?(In reply to)I believe any version of GTK will do.Did you try the snippet I posted ? Does it work for you ?(In reply to)I tried it on RHEL , it worked without problems , that is why I am asking about GTK version, I don't have a Suse Linux environment right now , but I may try Ubuntu if it will help(In reply to)Did you try the snippet in?In which side what that text aligned ?It fails for me on GTK 2.16.6The text in the label should be aligned on the right edge but instead it shows on the left edge. Remove the SWT.WRAP from the Label and it will work as expected.the red hat machine I am working on is not reproducing the buggy behavior gtk version is : gtk2-2.10.4-20.el5while on Suse Linux Enterprise server, where the defect happens, the gtk version is : gtk2-2.14.4-16.1does this mean we need to file a bug against gtk or try to handle things using api's from within swt?the red hat machine I am working on is not reproducing the buggy behavior gtk version is : gtk2-2.10.4-20.el5while on Suse Linux Enterprise server, where the defect happens, the gtk version is : gtk2-2.14.4-16.1does this mean we need to file a bug against gtk or try to handle things using api's from within swt?(In reply to)you can try both, but before reporting a bug against gtk try to write a gtk app that shows the alignment is inconsistent in GtkLabel between a wrappable and a non wrappable control.	16.0
id=331263	REOPENED	Platform	SWT	3.6.1	PC Windows 7	P3 critical	Platform-SWT-Inbox	2010-11-26 21:09 EST by	None	2010-12-02 12:40 EST (	6 users	Build Identifier: M20100909-0800**NOTE : I HAVE NOT SEEN THIS BUG REPORTED UNDER WINDOWS 7 BEFORE **Every time I open eclipse this is happening. I am using the latest 64bit JDK 1.6.0_22. Both Eclipse and OS are 64bit. From reading other bug reports with the same problem, I understand that this should have been fixed by now. Why is this happening I've spent far too long looking for answers online at this stage - all the suppoort seems to be for linux.Reproducible: AlwaysSteps to Reproduce:1. Open Eclipse2. Do something to prompt content assist.3.	CreatedEclipse.ini fileForgot to mention that I have tried re-installing eclipse in case it was one of the plugins.Comment onEclipse.ini fileIf Eclipse is crashing, you should look for crash logs. They're probably wherever your Eclipse is installed or possibly where your Eclipse shortcut is (if you use shortcuts).I checked! There is none.I checked! There is none.From the information you provided there is no obvious hint at any possiblecause for the crash. So for others to be able to help you, you should tryhard to provide additional information, like errors logged in .metadata/.loginside your workspace directory, or try different JDKs etc.pp.If there is indeed a similarity toand thus to its 'master'the exact version of your operating system and its librariesmight be relevant.If by crashing you say Eclipse terminates abruptly this indicates an errorwithin native code (library, OS or JVM). The JDT/Core has no native codeso maybe the folks at SWT can ask you better questions.CreatedError messageThis is the error message I get each time it crashes.Here is the log in that appears in .metadata each time it crashes:SESSION 2010-11-27 18:52:28.051 -----------------------------------------------eclipse.buildId=M20100909-0800java.version=1.6.0_22java.vendor=Sun Microsystems Inc.BootLoader constants: OS=win32, ARCH=x86_64, WS=win32, NL=en_IECommand-line arguments: -os win32 -ws win32 -arch x86_64 -clean!ENTRY org.eclipse.team.core 4 0 2010-11-27 18:52:34.629!MESSAGE Could not instantiate provider org.tigris.subversion.subclipse.core.svnnature for project Calculater.!STACK 1org.eclipse.team.core.TeamException: Could not instantiate provider org.tigris.subversion.subclipse.core.svnnature for project Calculater. at org.eclipse.team.core.RepositoryProvider.mapNewProvider(RepositoryProvider.java:165) at org.eclipse.team.core.RepositoryProvider.mapExistingProvider(RepositoryProvider.java:235) at org.eclipse.team.core.RepositoryProvider.getProvider(RepositoryProvider.java:507) at org.eclipse.team.internal.ccvs.ui.CVSLightweightDecorator.isMappedToCVS(CVSLightweightDecorator.java:192) at org.eclipse.team.internal.ccvs.ui.CVSLightweightDecorator.decorate(CVSLightweightDecorator.java:147) at org.eclipse.ui.internal.decorators.LightweightDecoratorDefinition.decorate(LightweightDecoratorDefinition.java:263) at org.eclipse.ui.internal.decorators.LightweightDecoratorManager$LightweightRunnable.run(LightweightDecoratorManager.java:81) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.internal.decorators.LightweightDecoratorManager.decorate(LightweightDecoratorManager.java:365) at org.eclipse.ui.internal.decorators.LightweightDecoratorManager.getDecorations(LightweightDecoratorManager.java:347) at org.eclipse.ui.internal.decorators.DecorationScheduler$1.ensureResultCached(DecorationScheduler.java:371) at org.eclipse.ui.internal.decorators.DecorationScheduler$1.run(DecorationScheduler.java:331) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)!SUBENTRY 1 org.eclipse.team.core 4 0 2010-11-27 18:52:34.630!MESSAGE Could not instantiate provider org.tigris.subversion.subclipse.core.svnnature for project Calculater.!ENTRY org.eclipse.team.core 4 0 2010-11-27 18:52:34.645!MESSAGE Could not instantiate provider org.tigris.subversion.subclipse.core.svnnature for project Test.!STACK 1org.eclipse.team.core.TeamException: Could not instantiate provider org.tigris.subversion.subclipse.core.svnnature for project Test. at org.eclipse.team.core.RepositoryProvider.mapNewProvider(RepositoryProvider.java:165) at org.eclipse.team.core.RepositoryProvider.mapExistingProvider(RepositoryProvider.java:235) at org.eclipse.team.core.RepositoryProvider.getProvider(RepositoryProvider.java:507) at org.eclipse.team.internal.ccvs.ui.CVSLightweightDecorator.isMappedToCVS(CVSLightweightDecorator.java:192) at org.eclipse.team.internal.ccvs.ui.CVSLightweightDecorator.decorate(CVSLightweightDecorator.java:147) at org.eclipse.ui.internal.decorators.LightweightDecoratorDefinition.decorate(LightweightDecoratorDefinition.java:263) at org.eclipse.ui.internal.decorators.LightweightDecoratorManager$LightweightRunnable.run(LightweightDecoratorManager.java:81) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.internal.decorators.LightweightDecoratorManager.decorate(LightweightDecoratorManager.java:365) at org.eclipse.ui.internal.decorators.LightweightDecoratorManager.getDecorations(LightweightDecoratorManager.java:347) at org.eclipse.ui.internal.decorators.DecorationScheduler$1.ensureResultCached(DecorationScheduler.java:371) at org.eclipse.ui.internal.decorators.DecorationScheduler$1.run(DecorationScheduler.java:331) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)!SUBENTRY 1 org.eclipse.team.core 4 0 2010-11-27 18:52:34.645!MESSAGE Could not instantiate provider org.tigris.subversion.subclipse.core.svnnature for project Test.(In reply to)I know alot of the above has to do with the subclipse plugin that I had installed before I rein-stalled eclipse to see if it were a dodgy plugin causing the problem.I don't have enough information to work on this problem.Please try to find the native crash log (the one that is created by the VM when it crashes). It should be on the same folder where the VM was launched (usually the same folder where you double-clicked eclipse.exe but not necessarily if you used a shortcut or the command prompt).Does the problem happen without the subversion plugin ? If does, what do you get in the .log ?Does the problem happen with a new Eclipse (e.g Eclipse 3.7 M3) ?(In reply to)I have looked in the Eclipse folder, it's not there.Could you give me the name of it so I could search for it.Yes. That is the log attached - a reinstall of 3.6.1 without installing subclipseHaven't tried. Is that a new beta? From what I've read this problem was should have been fixed by 3.6.GTKRemove the javadoc you added (only windows needs javadoc; we have tooling that copies the javadoc of windows to all others platforms).ExpandBar#setOrientatio(boolean) needs to call setOrientation on the ExpandItems (just like you did for TabFolder).Menu#setOrientatio(boolean) needs to call setOrientation on the MenuItems (just like you did for TabFolder).(I suspect) MenuItem#setOrientatio(boolean) needs to call setOrientation on the 'menu' (for CASCADE menu items). See MenuItem#reskinChildren() as an example.Scrollable#setOrientatio(boolean) needs to call setOrientation on the ScrollBars (see Scrollable#reskinChildren(int) for example how to propagate a change from the Scrollable down to the ScrollBars).Table#setOrientatio(boolean) needs to call setOrientation on the TableColumns. Same thing you did for the TableItems you need to do for the TableColumns. (see Table#reskinChildren())Tree#setOrientatio(boolean) needs to call setOrientation on the TreeColumns. Same thing you did for the TreeItems you need to do for the TreeColumns. (see Tree#reskinChildren())In Composite#setOrientatio(boolean) instead of:void setOrientation (boolean create) { super.setOrientation (create); if (!create) { int dir = (style & SWT.RIGHT_TO_LEFT) != 0 ? OS.GTK_TEXT_DIR_RTL : OS.GTK_TEXT_DIR_LTR; Control [] list = _getChildren (); for (int i=0; i<list.length; i++) { list[i].setOrientation ((dir == OS.GTK_TEXT_DIR_RTL) ? SWT.RIGHT_TO_LEFT : SWT.LEFT_TO_RIGHT); } } } What about this:void setOrientation (boolean create) { super.setOrientation (create); if (!create) { int flags = SWT.RIGHT_TO_LEFT | SWT.LEFT_TO_RIGHT; int orientation = style & flags; Control [] list = _getChildren (); for (int i=0; i<list.length; i++) { list[i].setOrientation (orientation); } } }Please ignore my last comment, it was meant to another bug and accidently paste in here. Sorry for the confusion.(In reply to)Depends on the VM, but try:hs_err_pid*.log javacore*Funny, I still see subversion packages in the stack frame.Yes, could you download it and make sure it is indeed fixed ?Thank you(In reply to)3.7? Is there a link?(In reply to)(In reply to)Ok so here's what I've just done. Downloaded 3.7 M3. Made a new workspace. Created a new project. Began writing a class. As soon as content assist opened, eclipse exited.I will attach the error message as "Error 3.7" though i think it's the same as the previous one. I have aslo attached the .log file from .metadata folder inn the workspace (attached as ".log 3.7").There is NO error log in the eclipse installation folder.Anything else I can do?Created.log 3.7CreatedError 3.7The log has lots of entries which indicates that it's not a clean install with new workspace. Are you sure that this is the .log from the new workspace?Try again to find the VM crash log - look in:- the eclipse.exe location- the current directory where you called/started eclipse- C:\Windows\system32Also, do you use a 64-bit JRE? I'm asking because you run the 64 bit Eclipse build. See also:(In reply to)Absolutely! Look at the heading of the .log - " !SESSION 2010-11-30 21:00:05.400. " Last night (I am in GMT timezone by the way, 5/6 hours ahead of you I think).I've said twice already that's it' not there. Is there any way I can force a crash log?Again, I have stated already that I am using 64 bit JDK 1.6.)_22(In reply to)OK, so let's start off there. Which package/download did you use exactly from?(In reply to)It was in fact this one(In reply to)I cannot reproduce any problems with this build, JDK6_22 64bit, and a brand new workspace. The .log is empty right after startup and also when I create a Java project and a class, and then use content assist.(In reply to)Looks like you forgot to set an explicit VM here (it's using the default Windows VM). I also see more arguments like -Dosgi.requiredJavaVersion=1.5(In reply to)OK, if the log fromis really from a fresh workspace, then the log entries look like a p2 problem:!ENTRY org.eclipse.equinox.preferences 4 4 2010-11-30 21:00:27.528!MESSAGE Exception saving preferences to: C:/Users/Cristover/.eclipse/org.eclipse.platform_3.7.0_920333535/p2/org.eclipse.equinox.p2.engine/profileRegistry/epp.package.java.profile/.data/.settings/org.eclipse.equinox.p2.metadata.repository.prefs.!STACK 0java.io.FileNotFoundException: C:\Users\Cristover\.eclipse\org.eclipse.platform_3.7.0_920333535\p2\org.eclipse.equinox.p2.engine\profileRegistry\epp.package.java.profile\.data\.settings\org.eclipse.equinox.p2.metadata.repository.prefs (The requested operation cannot be performed on a file with a user-mapped section open) at java.io.FileOutputStream.open(Native Method)How exactly do you start Eclipse (command line including arguments)?Start using Start menu shortcut.(In reply to)Start menu shortcut, no arguments. Added -XX:ErrorFile argument to the eclipse.ini file and hurrah! We have an error log file! Hopefully this helps somewhat.CreatedJVM Error Log.Looks like a bug in an IE library. I suggest to update to the latest version.Most likely a duplicate of.(In reply to)Of IE? I don't use IE.(In reply to)Also, that bug isn't resolved.Who said that?No, but Eclipse does if it's not configured otherwise.(In reply to)So tell me if I've configured it correctly yo use firefox.I've done the following: Window > Preferences > General > Web Browser > Search. Located the Firefox directory, at which point Firefox appeared in the web browser box. Selected this, yet eclipse still crashes.(In reply to)Right. This only sets the Web browser but not what's used by the SWT Browser widget.(In reply to)How do i do this?I agree with Dani (duplicate of 279680).Adding Grant to CC list, maybe he knows a way to make the Browser control to always use FF (as a workaround).*** This bug has been marked as a duplicate of***A Browser created with style SWT.NONE, which is the case here, will not use mozilla as the underlying renderer on platforms other than *ix.(In reply to)Well it doesn't even have to be Firefox, I am just looking for a solution to the problem. I don't understand how eclipse goes from working fine to crashing. The only thing that ever changes is the JDK with new updates and the issue is happening with both 3.6.1 and 3.7 - which(In reply to)So how do I solve the problem?(In reply to)I just readand it seems this is not a SWT bug, it is possible that we can not do anything to help (as far as changing SWT code goes). Sorry.Can you go back using your old JDK as a workaround ?(In reply to)Look:. That bug is the exact same one as this. It was said that it would be fixed by 3.6 yet I am still having the same problem. If the JDK alone were the issue, then many others would have this problem. It is not affecting anything else on my system	38.0
id=331771	REOPENED	Platform	SWT	3.7	PC Mac OS X	P3 major	Platform-SWT-Inbox	2010-12-03 09:41 EST by	Jeff McAffer	2010-12-06 17:15 EST (	4 users	using i1116 on the Mac Cocoa 64 I frequently get a livelock situation where one core is maxed out and Eclipse is hung. It seems to happen when I launch eclipse and then do some manipulation in the workspace chooser. there does not seem to be a particular pattern just sometimes while I'm selecting from the list of previous workspaces or driving through the file chooser (browse) it locks up.It may be related that the console pretty much always (with or without hang) shows the followingjava.lang.IllegalStateException: Workbench has not been created yet. at org.eclipse.ui.PlatformUI.getWorkbench(PlatformUI.java:92) at org.eclipse.ui.internal.ide.IDEWorkbenchPlugin$2.run(IDEWorkbenchPlugin.java:360) at org.eclipse.swt.widgets.Display.runTimers(Display.java:3922) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3434) at org.eclipse.jface.window.Window.runEventLoop(Window.java:825) at org.eclipse.jface.window.Window.open(Window.java:801) at org.eclipse.ui.internal.ide.ChooseWorkspaceDialog.prompt(ChooseWorkspaceDialog.java:91) at org.eclipse.ui.internal.ide.application.IDEApplication.promptForWorkspace(IDEApplication.java:277) at org.eclipse.ui.internal.ide.application.IDEApplication.checkInstanceLocation(IDEApplication.java:225) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:105) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:369) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:597) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:621) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:576) at org.eclipse.equinox.launcher.Main.run(Main.java:1409)	I've had some luck reproducing by starting Eclipse and then clicking the Browse button in the workspace chooser *before* that stack trace appears (seems like in the first 5 seconds or so). The file chooser opens but then I get the lockup. I just tried another theory. Start Eclipse and then drop down the previous workspace list and don't pick anything, just leave it dropped down. When that timeout happens and the stacktrace appears, one core will get saturated. I seem to be able to reproduce this all the time.Please try upgrading to a newer build, Jeff.*** This bug has been marked as a duplicate of***I am able to reproduce this problem with the same build (i1116 32bit version) on my Mac. I start up Eclipse, open up the "previous workspace" drop down, don't select anything, wait a few (30?) seconds, (I actually went to another app and then back later) then you get the "beachball of death". (as Jeff refers to it :-)I tried these steps with the 1130 i-build though and don't get the livelock.I think the stack trace is a red herring. Maybe there was a change in SWT here? I *think* the drop-down remained open when I switched apps in the i1116 build but when I switch apps in the i1130 build it closes when losing focus.Maybe someone in SWT can comment/close.When you say "the drop-down", do you mean the sub-menu of "File > Switch Workspace", or do you mean the Combo in the "Switch Workspace > Others..." dialog?If it's the former, then the problem could also be in Platform UI, near(but it's not that bug).I'm starting Eclipse from the command-line (not doing a switch workspace) so it is the combo/dropdown/thingie that allows me to choose a recently used workspace.(In reply to)I've been doing some work with fixing focus saving/restoration lately, so it's very possible that I fixed this. See. I just fixed it on 11/29, though, so I don't think it would have made it into an 11/30 I-build. I could be wrong, though.The combo box should close when the window deactivates. Actually, just about any click that isn't on the combo box should hide the drop-down menu.Jeff (or anyone else who can reproduce this), are you using Mac OS X 10.6 or 10.5.x? See.I am using 10.6.5.10.6.5 here too. This does look like it could be a dupe of the other bug...Aha! I think I just figured this out, looking at the native samples in 330345. Clicking outside the popup or switching to another application _should_ trigger something inside AppKit so that the combo box's popup window can be hidden. But when a Java exception is thrown JNI is basically hosed at that point, so no callbacks into the SWT will fire, including calls that AppKit is relying on to keep event dispatch going. So, we end up stuck in a tight loop.Let me try to reproduce this again and I'll try to confirm the theory.sounds promising. I will just point out that I don't need to click outside. Just drop down the combo. My naive theory was that this triggers another event loop to manage the dropdown action and then the exception happens and ... (as you say). This is reproducible every time for me.(In reply to)Yep, you are exactly right. Dropping down the combo box should be enough -- eventually a timer will fire and execute the offending line of code. The trick, I guess, is showing the combo box popup menu quickly enough to trigger it.	12.0
id=335769	REOPENED	Platform	SWT	4.1	PC Windows 7	P3 major	Platform-SWT-Inbox	2011-01-29 10:51 EST by	None	2016-10-28 09:12 EDT (	5 users	Build Identifier: M20100909-0800Use the following code.package com.zetcode;import org.eclipse.swt.SWT;import org.eclipse.swt.events.PaintEvent;import org.eclipse.swt.events.PaintListener;import org.eclipse.swt.graphics.Transform;import org.eclipse.swt.widgets.Display;import org.eclipse.swt.widgets.Shell;/** * ZetCode Java SWT tutorial * * This program creates a donut shape * * @author jan bodnar * website zetcode.com * last modified June 2009 */public class SWTApp { private Shell shell; public SWTApp(Display display) { shell = new Shell(display); shell.addPaintListener(new DonutPaintListener()); shell.setText("Donut"); shell.setSize(430, 300); shell.setLocation(300, 300); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) { display.sleep(); } } } private class DonutPaintListener implements PaintListener { public void paintControl(PaintEvent e) { drawDonut(e); e.gc.dispose(); } } private void drawDonut(PaintEvent e) { int w = e.width; int h = e.height; e.gc.setAntialias(SWT.ON); Transform tr = new Transform(e.display); tr.translate(w / 2, h / 2); e.gc.setTransform(tr); for (int rot = 0; rot < 36; rot++) { tr.rotate(5f); e.gc.drawOval(-125, -40, 250, 80); e.gc.setTransform(tr); } } public static void main(String[] args) { Display display = new Display(); new SWTApp(display); display.dispose(); }}In this example, we create a donut. The shapes resembles a cookie, hence the name donut. Transform tr = new Transform(e.display); tr.translate(w / 2, h / 2); e.gc.setTransform(tr);We move the middle of the axis to the center of the window. for (int rot = 0; rot < 36; rot++) { tr.rotate(5f); e.gc.drawOval(-125, -40, 250, 80); e.gc.setTransform(tr); }Reproducible: AlwaysSteps to Reproduce:1.Run the code in the details.2.Notice the ellipses at 45, 135, 225, and 315 are missing. It should be a perfect donut.3.Can can simplify the example to rotate a simple line at 45 degrees and it does not show up on the screen. If you use the transform method on Transform class instance it works correctly, the issue is inside the GC class.	I see a few problems on your code:First one is here:public void paintControl(PaintEvent e) { drawDonut(e); e.gc.dispose(); <--You can not dispose this GC, you didn't create it }Then here: Transform tr = new Transform(e.display); tr.translate(w / 2, h / 2); e.gc.setTransform(tr); for (int rot = 0; rot < 36; rot++) { tr.rotate(5f); e.gc.drawOval(-125, -40, 250, 80); e.gc.setTransform(tr); }You can't reuse a Transform.Change to this: Transform tr = new Transform(e.display); tr.translate(w / 2, h / 2); e.gc.setTransform(tr); tr.dispose(); for (int rot = 0; rot < 36; rot++) { tr = new Transform(e.display); tr.rotate(5f); e.gc.setTransform(tr); tr.dispose(); e.gc.drawOval(-125, -40, 250, 80); }See if works after you fix your code.I"m closing this now as not eclipse, reopen it if need it.I'll reopen this, because I'm seeing a similar problem in Cocoa. However, in Cocoa only the ovals at 45 and 215 degrees. The behavior is unchanged on Windows 7.There may still be some kind of problem with the code, but with the changes from Felipe inthe problem doesn't go away.New code:===============import org.eclipse.swt.*;import org.eclipse.swt.events.*;import org.eclipse.swt.graphics.*;import org.eclipse.swt.widgets.*;/** * ZetCode Java SWT tutorial * * This program creates a donut shape * * @author jan bodnar * website zetcode.com * last modified June 2009 */public class SWTApp { private Shell shell; public SWTApp(Display display) { shell = new Shell(display); shell.addPaintListener(new DonutPaintListener()); shell.setText("Donut"); shell.setSize(430, 300); shell.setLocation(300, 300); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) { display.sleep(); } } } private class DonutPaintListener implements PaintListener { public void paintControl(PaintEvent e) { drawDonut(e); } } private void drawDonut(PaintEvent e) { int w = e.width; int h = e.height; e.gc.setAntialias(SWT.ON); for (int rot = 0; rot < 36; rot++) { Transform tr = new Transform(e.display); tr.translate(w / 2, h / 2); tr.rotate(5f * rot); e.gc.setTransform(tr); tr.dispose(); e.gc.drawOval(-125, -40, 250, 80); } } public static void main(String[] args) { Display display = new Display(); new SWTApp(display); display.dispose(); }}Interesting, we have the same problem on cairo (nothing draws when rot=45||rot==225).SeeThe problem is how we compute the x, y draw offset in checkGC (all platforms have the same code).Indeed it is. Adding the linee.gc.getGCData().state |= 1 << 9;before the drawOval call fixes it, and in my gesture snippet.As the rotation value gets closer to 45 or 225 the x offset goes out of wack. Removing the fix forfixed the problem on windows. But that is not the right solution neither.I just came across this bug. This is still not fixed in 4.2.Is the statement about not reusing a transform in, true? Does this mean that one could not set the same transform on another instance of GC? Then this should be clearly documented on GC.setTransform.Createdmethods to fixI use intensively the class GC in an experimental application.Hopefully, the few information provided below will be helpful to fix the issue.I observed the following differences:- drawX methods failed when a rotation angle is specified around 45, 135, 315 degrees,- fillX methods never fail.I provide two attachments:- report.html, listing all methods of the GC class that cannot be used.- Transformation_checker.java, snippet showing the bug in action for various shapes.I tried some workarounds but they caused performance difficulties.I tried to patch some drawX methods like for the following:public void drawOval(int x, int y, int width, int height) { if (handle == 0) SWT.error(SWT.ERROR_GRAPHIC_DISPOSED); checkGC(DRAW); if (width < 0) { x = x + width; width = -width; } if (height < 0) { y = y + height; height = -height; } long /*int*/ cairo = data.cairo; if (cairo != 0) { if (width == height) { Cairo.cairo_arc_negative(cairo, x + width / 2f, y + height / 2f, width / 2f, 0, -2 * (float)Compatibility.PI); } else { Cairo.cairo_save(cairo); Cairo.cairo_translate(cairo, x + width / 2f, y + height / 2f); Cairo.cairo_scale(cairo, width / 2f, height / 2f); Cairo.cairo_arc_negative(cairo, 0, 0, 1, 0, -2 * (float)Compatibility.PI); Cairo.cairo_restore(cairo); } Cairo.cairo_stroke(cairo); return; } OS.gdk_draw_arc(data.drawable, handle, 0, x, y, width, height, 0, 23040);}The shape is correctly displayed.CreatedJava snippet illustrating the bugComment onmethods to fixDrawText is OK (in report.html).Sorry for the inconvenience.I am no longer working on SWT. Moving to INBOX so that the team see the new comments.Createdmethods to fix	15.0
id=342507	REOPENED	Platform	SWT	3.6	PC Windows 7	P3 normal	Platform-SWT-Inbox	2011-04-11 22:52 EDT by	None	2011-04-12 19:07 EDT (	1 user	CreatedSimple Application exhibiting the problemRunning the attached application, and performing large resizing of the shell, you can see black regions to the bottom and right of the table. As you slow down the resizing, or even hold the mouse stationary during resize, the black regions disappear. This appears to be due to the PaintItem listener. If you comment out both the EraseItem and PaintItem listeners from the attached code, resize behaves smoothly and as expected.NOTE: Does not appear to happen on MAC OSX, but does on Vista and Windows 7, and potentially other Windows flavors.	Remove the SWT.NO_BACKGROUND flag from the Shell (or better, remove all those flags, use SWT.SHELL_TRIM instead).I think SWT.NO_BACKGROUND is not implemented in Cocoa, that is why you don't see the problem there.Closing.Unfortunately, this does not fix the problem. The SWT.SHELL_TRIM appears to have no affect on Win7. Removing SWT.NO_BACKGROUND somewhat "disguises" the problem, because the black regions that can be seen in my example application become "white" when you remove this flag. But that is not a fix... the problem still exists.	2.0
id=337148	REOPENED	Platform	SWT	3.7	PC Windows 7	P3 normal	Platform-SWT-Inbox	2011-02-14 12:55 EST by	Olivier Thomann	2013-01-21 03:35 EST (	15 users	Using eclipse.buildId=I20110210-2002 (4.1 build)java.version=1.6.0_24java.vendor=Sun Microsystems Inc.BootLoader constants: OS=win32, ARCH=x86_64, WS=win32, NL=fr_CACommand-line arguments: -os win32 -ws win32 -arch x86_64 -console,I got this exception in the .log file.No steps to reproduce yet as I didn't get any dialog about this error.java.lang.NullPointerExceptionat org.eclipse.jface.viewers.OwnerDrawLabelProvider$OwnerDrawListener.handleEvent(OwnerDrawLabelProvider.java:48)at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053)at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1077)at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1062)at org.eclipse.swt.widgets.Table.sendMeasureItemEvent(Table.java:3766)at org.eclipse.swt.widgets.Table.wmNotifyToolTip(Table.java:7129)at org.eclipse.swt.widgets.Table.wmNotify(Table.java:6571)at org.eclipse.swt.widgets.Control.WM_NOTIFY(Control.java:5090)at org.eclipse.swt.widgets.Control.windowProc(Control.java:4563)at org.eclipse.swt.widgets.Table.windowProc(Table.java:5833)at org.eclipse.swt.widgets.Display.windowProc(Display.java:4933)at org.eclipse.swt.internal.win32.OS.CallWindowProcW(Native Method)at org.eclipse.swt.internal.win32.OS.CallWindowProc(OS.java:2418)at org.eclipse.swt.widgets.Table.callWindowProc(Table.java:564)at org.eclipse.swt.widgets.Table.callWindowProc(Table.java:430)at org.eclipse.swt.widgets.Control.windowProc(Control.java:4601)at org.eclipse.swt.widgets.Table.windowProc(Table.java:5833)at org.eclipse.swt.widgets.Display.windowProc(Display.java:4946)at org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method)at org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:2524)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3713)at org.eclipse.jface.window.Window.runEventLoop(Window.java:825)at org.eclipse.jface.window.Window.open(Window.java:801)at org.eclipse.jdt.internal.ui.dialogs.FilteredTypesSelectionDialog.open(FilteredTypesSelectionDialog.java:500)at org.eclipse.jdt.internal.ui.actions.OpenTypeAction.runWithEvent(OpenTypeAction.java:78)at org.eclipse.jdt.internal.ui.actions.OpenTypeAction.run(OpenTypeAction.java:65)at org.eclipse.jdt.internal.ui.actions.OpenTypeAction.run(OpenTypeAction.java:141)at org.eclipse.ui.internal.handlers.ActionDelegateHandlerProxy.execute(ActionDelegateHandlerProxy.java:289)at org.eclipse.ui.internal.handlers.E4HandlerProxy.execute(E4HandlerProxy.java:58)at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)at java.lang.reflect.Method.invoke(Method.java:597)at org.eclipse.e4.core.internal.di.MethodRequestor.execute(MethodRequestor.java:52)at org.eclipse.e4.core.internal.di.InjectorImpl.invokeUsingClass(InjectorImpl.java:226)at org.eclipse.e4.core.internal.di.InjectorImpl.invoke(InjectorImpl.java:207)at org.eclipse.e4.core.contexts.ContextInjectionFactory.invoke(ContextInjectionFactory.java:123)at org.eclipse.e4.core.commands.internal.HandlerServiceImpl.executeHandler(HandlerServiceImpl.java:122)at org.eclipse.e4.ui.bindings.keys.KeyBindingDispatcher.executeCommand(KeyBindingDispatcher.java:266)at org.eclipse.e4.ui.bindings.keys.KeyBindingDispatcher.press(KeyBindingDispatcher.java:465)at org.eclipse.e4.ui.bindings.keys.KeyBindingDispatcher.processKeyEvent(KeyBindingDispatcher.java:515)at org.eclipse.e4.ui.bindings.keys.KeyBindingDispatcher.filterKeySequenceBindings(KeyBindingDispatcher.java:348)at org.eclipse.e4.ui.bindings.keys.KeyBindingDispatcher.access$0(KeyBindingDispatcher.java:294)at org.eclipse.e4.ui.bindings.keys.KeyBindingDispatcher$KeyDownFilter.handleEvent(KeyBindingDispatcher.java:76)at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)at org.eclipse.swt.widgets.Display.filterEvent(Display.java:1262)at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1052)at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1077)at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1062)at org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:1104)at org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:1100)at org.eclipse.swt.widgets.Widget.wmChar(Widget.java:1509)at org.eclipse.swt.widgets.Control.WM_CHAR(Control.java:4618)at org.eclipse.swt.widgets.Tree.WM_CHAR(Tree.java:5890)at org.eclipse.swt.widgets.Control.windowProc(Control.java:4507)at org.eclipse.swt.widgets.Tree.windowProc(Tree.java:5886)at org.eclipse.swt.widgets.Display.windowProc(Display.java:4933)at org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method)at org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:2524)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3713)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$7.run(PartRenderingEngine.java:842)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:758)at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:87)at org.eclipse.ui.internal.Workbench$3.run(Workbench.java:540)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:522)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:115)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:344)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)at java.lang.reflect.Method.invoke(Method.java:597)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:622)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:577)at org.eclipse.equinox.launcher.Main.run(Main.java:1410)at org.eclipse.equinox.launcher.Main.main(Main.java:1386)	viewer.getViewerColumn(event.index) returns null.Maybe this is the opposite of SWTwhere the handleEvent is sent before the table is fully realized?***has been marked as a duplicate of this bug. ***Moving to SWT. Looks like the OwnerDrawListener gets an invalid column index in the MeasureItem event sent from Table.wmNotifyToolTip(Table.java:7189)andlook similar (but in those cases, the table items have fonts set).(In reply to)possibleMarkus, can you reproduce this problem ?Nope. I even tried delaying some events with breakpoints and play with different mouse positions to trigger tooltips of items that are not fully there yet.I coworker sent his .log to me, because he had some problems. So I don't know anything about how it happened and it is old.!SESSION 2011-09-29 10:39:44.441 -----------------------------------------------eclipse.buildId=I20110613-1736java.version=1.7.0java.vendor=Oracle CorporationBootLoader constants: OS=win32, ARCH=x86_64, WS=win32, NL=en_USFramework arguments: -product org.eclipse.epp.package.java.productCommand-line arguments: -os win32 -ws win32 -arch x86_64 -product org.eclipse.epp.package.java.product!ENTRY org.eclipse.ui 4 0 2011-10-04 12:45:07.914!MESSAGE Unhandled event loop exception!STACK 0java.lang.NullPointerException at org.eclipse.jface.viewers.OwnerDrawLabelProvider$OwnerDrawListener.handleEvent(OwnerDrawLabelProvider.java:48) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1077) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1062) at org.eclipse.swt.widgets.Table.sendMeasureItemEvent(Table.java:3766) at org.eclipse.swt.widgets.Table.wmNotifyToolTip(Table.java:7189) at org.eclipse.swt.widgets.Table.wmNotify(Table.java:6631) at org.eclipse.swt.widgets.Control.WM_NOTIFY(Control.java:5086) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4584) at org.eclipse.swt.widgets.Table.windowProc(Table.java:5893) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4972) at org.eclipse.swt.internal.win32.OS.CallWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.CallWindowProc(OS.java:2424) at org.eclipse.swt.widgets.Table.callWindowProc(Table.java:564) at org.eclipse.swt.widgets.Table.callWindowProc(Table.java:430) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4623) at org.eclipse.swt.widgets.Table.windowProc(Table.java:5893) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4985) at org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method) at org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:2530) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3752) at org.eclipse.jface.window.Window.runEventLoop(Window.java:825) at org.eclipse.jface.window.Window.open(Window.java:801) at org.eclipse.ui.dialogs.FilteredResourcesSelectionDialog.open(FilteredResourcesSelectionDialog.java:410) at org.eclipse.ui.internal.ide.handlers.OpenResourceHandler.queryFileResource(OpenResourceHandler.java:159) at org.eclipse.ui.internal.ide.handlers.OpenResourceHandler.execute(OpenResourceHandler.java:93) at org.eclipse.ui.internal.ide.handlers.OpenResourceHandler.run(OpenResourceHandler.java:181) at org.eclipse.ui.internal.handlers.ActionDelegateHandlerProxy.execute(ActionDelegateHandlerProxy.java:289) at org.eclipse.core.commands.Command.executeWithChecks(Command.java:476) at org.eclipse.core.commands.ParameterizedCommand.executeWithChecks(ParameterizedCommand.java:508) at org.eclipse.ui.internal.handlers.HandlerService.executeCommand(HandlerService.java:169) at org.eclipse.ui.internal.keys.WorkbenchKeyboard.executeCommand(WorkbenchKeyboard.java:468) at org.eclipse.ui.internal.keys.WorkbenchKeyboard.press(WorkbenchKeyboard.java:786) at org.eclipse.ui.internal.keys.WorkbenchKeyboard.processKeyEvent(WorkbenchKeyboard.java:885) at org.eclipse.ui.internal.keys.WorkbenchKeyboard.filterKeySequenceBindings(WorkbenchKeyboard.java:567) at org.eclipse.ui.internal.keys.WorkbenchKeyboard.access$3(WorkbenchKeyboard.java:508) at org.eclipse.ui.internal.keys.WorkbenchKeyboard$KeyDownFilter.handleEvent(WorkbenchKeyboard.java:123) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Display.filterEvent(Display.java:1262) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1052) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1077) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1062) at org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:1104) at org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:1100) at org.eclipse.swt.widgets.Widget.wmChar(Widget.java:1509) at org.eclipse.swt.widgets.Control.WM_CHAR(Control.java:4640) at org.eclipse.swt.widgets.Canvas.WM_CHAR(Canvas.java:345) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4528) at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:341) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4972) at org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method) at org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:2530) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3752) at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2696) at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2660) at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2494) at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:674) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:667) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:123) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:344) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:622) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:577) at org.eclipse.equinox.launcher.Main.run(Main.java:1410) at org.eclipse.equinox.launcher.Main.main(Main.java:1386)A couple of our SmartGit 3 users also report this bug.(In reply to)Sorry, there's no information in this statement that could help tracking this down. Please ask you users for stack traces and any info they have about the circumstances (e.g. steps to reproduce, even if they only work sometimes).SmartGit steps from user:"Went to the log view, turned on the Date column and then turned off theCommit Date column but instead the internal error screen appeared."os.arch : "x86"os.name : "Windows 7"java.runtime.version : "1.7.0-b147"java.lang.NullPointerException at org.eclipse.swt.widgets.Widget.getData(Widget.java:558) at org.eclipse.jface.viewers.ColumnViewer.getViewerColumn(ColumnViewer.java:186) at org.eclipse.jface.viewers.OwnerDrawLabelProvider$OwnerDrawListener.handleEvent(OwnerDrawLabelProvider.java:47) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1077) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1062) at org.eclipse.swt.widgets.Table.sendMeasureItemEvent(Table.java:3766) at org.eclipse.swt.widgets.Table.CDDS_SUBITEMPREPAINT(Table.java:998) at org.eclipse.swt.widgets.Table.wmNotifyChild(Table.java:6840) at org.eclipse.swt.widgets.Control.wmNotify(Control.java:5534) at org.eclipse.swt.widgets.Composite.wmNotify(Composite.java:1896) at org.eclipse.swt.widgets.Control.WM_NOTIFY(Control.java:5086) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4584) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4985) at org.eclipse.swt.internal.win32.OS.CallWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.CallWindowProc(OS.java:2427) at org.eclipse.swt.widgets.Table.callWindowProc(Table.java:564) at org.eclipse.swt.widgets.Table.callWindowProc(Table.java:430) at org.eclipse.swt.widgets.Widget.wmPaint(Widget.java:2273) at org.eclipse.swt.widgets.Control.WM_PAINT(Control.java:5090) at org.eclipse.swt.widgets.Composite.WM_PAINT(Composite.java:1406) at org.eclipse.swt.widgets.Table.WM_PAINT(Table.java:6222) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4585) at org.eclipse.swt.widgets.Table.windowProc(Table.java:5893) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4972) at org.eclipse.swt.internal.win32.OS.CallWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.CallWindowProc(OS.java:2427) at org.eclipse.swt.widgets.Table.callWindowProc(Table.java:564) at org.eclipse.swt.widgets.Table.callWindowProc(Table.java:430) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4623) at org.eclipse.swt.widgets.Table.windowProc(Table.java:5893) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4985) at org.eclipse.swt.internal.win32.OS.SendMessageW(Native Method) at org.eclipse.swt.internal.win32.OS.SendMessage(OS.java:3277) at org.eclipse.swt.widgets.Table.destroyItem(Table.java:2066) at org.eclipse.swt.widgets.TableColumn.destroyWidget(TableColumn.java:194) at org.eclipse.swt.widgets.Widget.release(Widget.java:818) at org.eclipse.swt.widgets.Widget.dispose(Widget.java:446)os.arch : "x86"os.name : "Windows 7"java.runtime.version : "1.7.0-b147"java.lang.NullPointerException at org.eclipse.jface.viewers.OwnerDrawLabelProvider$OwnerDrawListener.handleEvent(OwnerDrawLabelProvider.java:48) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1077) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1062) at org.eclipse.swt.widgets.Table.sendMeasureItemEvent(Table.java:3766) at org.eclipse.swt.widgets.Table.wmNotifyToolTip(Table.java:7189) at org.eclipse.swt.widgets.Table.wmNotify(Table.java:6631) at org.eclipse.swt.widgets.Control.WM_NOTIFY(Control.java:5086) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4584) at org.eclipse.swt.widgets.Table.windowProc(Table.java:5893) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4972) at org.eclipse.swt.internal.win32.OS.CallWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.CallWindowProc(OS.java:2427) at org.eclipse.swt.widgets.Table.callWindowProc(Table.java:564) at org.eclipse.swt.widgets.Table.callWindowProc(Table.java:430) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4623) at org.eclipse.swt.widgets.Table.windowProc(Table.java:5893) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4985) at org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method) at org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:2533) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3752)We are using the SWT/JFace jars from 3.8M2.(In reply to)Looks like a slightly different NPE, but also related to OwnerDrawLabelProvider$OwnerDrawListener.handleEvent(In reply to)That looks like someone is playing games with the package-private Widget#data field. I'm afraid we can't help much here, and you have to debug it in SmartGit.Code from Widget.java:public Object getData (String key) { checkWidget(); if (key == null) error (SWT.ERROR_NULL_ARGUMENT); if ((state & KEYED_DATA) != 0) { Object [] table = (Object []) data; for (int i=1; i<table.length; i+=2) { // NPE on this line(In reply to)Thank you very much for this hint. There are indeed some usages of widget.setData(obj) in our code. I replace them with widget.setData(key, obj) with a surely unique key (and, of course, the corrsponding getData invocations).If you really had a conflict with the null data key, then you would see this all the time. But in this case, you seem to have an NPE because Widget#table is null. This shouldn't ever happen, and I didn't find any execution paths in SWT that would make this happen.(In reply to)I have found a way to reproduce the bug by adding two table columns and removing the first of the two added. We are trying to extract the essential code into a small example and report a separate bug.(In reply to)see*** This bug has been marked as a duplicate of***This bug is about the NPE atorg.eclipse.jface.viewers.OwnerDrawLabelProvider$OwnerDrawListener.handleEvent(OwnerDrawLabelProvider.java:48) which is triggered by a Table.wmNotifyToolTip(..).to 17 mostly talk about, which is an NPE in Widget.getData(..).Reopening this bug, since it's not clear that these two bugs are related.***has been marked as a duplicate of this bug. ***Finally found steps to reproduce in I20120419-1434 (3.8), Windows 7.Reason for the NPE: We get a bad MeasureItem event with index == -1 when the mouse is on the left of the table widget and the table selection changes (after a short delay).This can also be seen in the ControlExample if you hack Event#toString() to print the index.Steps to get the NPE:- new workspace- paste this into Package Explorer:package p;public class C { public static void main(String[] args) { int i= 2; System.out.println(i); }}- Open Resource... (Ctrl+Shift+R)- type **- press ArrowDown- put the mouse cursor to the left of the first item in the list (outside of the table widget)- expand/reduce the selection with Shift+ArrowDown/Up=> each selection change triggers an NPE (after a short delay)java.lang.NullPointerException at org.eclipse.jface.viewers.OwnerDrawLabelProvider$OwnerDrawListener.handleEvent(OwnerDrawLabelProvider.java:48) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1077) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1062) at org.eclipse.swt.widgets.Table.sendMeasureItemEvent(Table.java:3766) at org.eclipse.swt.widgets.Table.wmNotifyToolTip(Table.java:7189) at org.eclipse.swt.widgets.Table.wmNotify(Table.java:6631) at org.eclipse.swt.widgets.Control.WM_NOTIFY(Control.java:5086) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4584) at org.eclipse.swt.widgets.Table.windowProc(Table.java:5893) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4976) at org.eclipse.swt.internal.win32.OS.CallWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.CallWindowProc(OS.java:2439) at org.eclipse.swt.widgets.Table.callWindowProc(Table.java:564) at org.eclipse.swt.widgets.Table.callWindowProc(Table.java:430) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4623) at org.eclipse.swt.widgets.Table.windowProc(Table.java:5893) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4989) at org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method) at org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:2545) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3756) at org.eclipse.jface.window.Window.runEventLoop(Window.java:825) at org.eclipse.jface.window.Window.open(Window.java:801) at org.eclipse.ui.dialogs.FilteredResourcesSelectionDialog.open(FilteredResourcesSelectionDialog.java:410) at org.eclipse.ui.internal.ide.handlers.OpenResourceHandler.queryFileResource(OpenResourceHandler.java:159)...I don't want to ship with the NPE, and there's an easy workaround in jface, so I released that.R3_development:master:(In reply to)Thanx Markus.PW***has been marked as a duplicate of this bug. ***	23.0
id=351634	REOPENED	Platform	SWT	3.6.1	PC Windows 7	P3 major	Platform-SWT-Inbox	2011-07-09 11:22 EDT by	None	2011-07-25 12:26 EDT (	5 users	Build Identifier: M20100909-0800Hi,I have 2 different perspectives on my RCP applicationand when i switch between them the contents of both are missing,if i close and reopen the views then everything is visible again...what can be the cause of such behavior?i'm using embedded SWT in both perspectives... best regarsReproducible: Always	(In reply to)Embedded SWT? You mean embedded Swing?ah i wrote swt...yes i mean SWING,and in the second perspective i use a JInternalFrame:Frame frame =SWT_AWT.new_Frame(composite);JInternalFrame mainFrame =new JInternalFrame();......mainFrame.setSize(600, 600);mainFrame.setVisible(true);frame.add(mainFrame);ah i wrote swt...yes i mean SWING,and in the second perspective i use a JInternalFrame:Frame frame =SWT_AWT.new_Frame(composite);JInternalFrame mainFrame =new JInternalFrame();......mainFrame.setSize(600, 600);mainFrame.setVisible(true);frame.add(mainFrame);i suspect it is because of low memory issues,causethe second perspective has many panels with lots of widgets in them...if i remove some of the widgets it gets a little better,the first switch is ok,then the contents disappear again...Anything in .log?Todor, can you attach a sample code that would allow us to duplicate the problem? I don't think we can do much without it.Please reopen if you can provide more info, seeand.well i'm using this software:i add the frame from it to a internal frame in the view FaultTreeView which is in the perspective FaultTreePerspective,there is also another perspective: the MainPerspective,you can test it just with a empty perspective,then by switching between both perspective the components disappear... this is how my FalutTreeView looks like:public void createPartControl(Composite parent) { b Composite composite= new Composite (parent,SWT.EMBEDDED|SWT.BACKGROUND); Frame frame =SWT_AWT.new_Frame(composite); JInternalFrame mainFrame =new JInternalFrame(); JPanel panel=new JPanel(); FUtil = new FileUtility(); container = mainFrame.getContentPane(); gridLayout = new GridBagLayout(); constraints = new GridBagConstraints(); container.setLayout(gridLayout); infoPanel = new InfoPanel(); details = new FaultTreeDetails(infoPanel); menuBar = new BrowserMenu(); report = new Report(); drawingArea = new DrawingArea(details, infoPanel, menuBar); generalToolBar = new GeneralToolBar(infoPanel, report,drawingArea); faultTreeToolBar = new FaultTreeToolBar(infoPanel); toolHolder1 = new JPanel(); toolHolder2 = new JPanel(); toolHolder1.add(generalToolBar); toolHolder2.add(faultTreeToolBar); viewPort = new JViewport(); viewPort.setView(drawingArea); scroller = new JScrollPane(scroller.VERTICAL_SCROLLBAR_ALWAYS, scroller.HORIZONTAL_SCROLLBAR_ALWAYS); scroller.setViewport(viewPort); addComponent(toolHolder1, 0, 0, 1, 1, constraints.WEST, 0, 0, constraints.NONE); addComponent(toolHolder2, 1, 0, 1, 1, constraints.WEST, 0, 0, constraints.NONE); addComponent(scroller, 2, 0, 1, 2, constraints.WEST, 2, 1, constraints.BOTH); addComponent(details, 2, 1, 0, 0, constraints.WEST, 0, 0, constraints.BOTH); addComponent(infoPanel, 4, 0, 2, 2, constraints.WEST, 0, 0, constraints.NONE); mainFrame.setJMenuBar(menuBar.getMenu()); mainFrame.setSize(600, 600); mainFrame.setVisible(true); frame.add(mainFrame);}in the .log is nothing about it,the eclipse doesn't register it like a bug...i think this is because of low memory ,i get constantly this windows messages about low memory...sorry i add the internal frame to the SWT Frame...and here is the whole code:package com.example.rcpapp;import java.awt.Component;import java.awt.Container;import java.awt.Dimension;import java.awt.Frame;import java.awt.GridBagConstraints;import java.awt.GridBagLayout;import java.awt.event.MouseWheelEvent;import javax.swing.JDesktopPane;import javax.swing.JFrame;import javax.swing.JInternalFrame;import javax.swing.JPanel;import javax.swing.JScrollPane;import javax.swing.JViewport;import org.eclipse.swt.SWT;import org.eclipse.swt.awt.SWT_AWT;import org.eclipse.swt.widgets.Composite;import org.eclipse.ui.part.ViewPart;import FaultTree.*;import org.apache.xerces.dom.*;import org.apache.xerces.parsers.*;import org.apache.xml.serialize.*;import org.w3c.dom.*;public class FaultTreeView extends ViewPart { public static final String ID="com.example.rcpapp.view4"; /** * The fault tree toolbar. */ private FaultTreeToolBar faultTreeToolBar; /** * The general toolbar. */ private GeneralToolBar generalToolBar; /** * The drawing area. */ public DrawingArea drawingArea; /** * The fault tree details panel. */ private FaultTreeDetails details; /** * The menubar. */ private BrowserMenu menuBar; /** * The infopanel. */ private InfoPanel infoPanel; /** * The report panel. */ private Report report; /** * Panel that holds the general toolbar. */ private JPanel toolHolder1; /** * Panel that holds the fault tree toolbar. */ private JPanel toolHolder2; /** * The introscreen panel. */ private IntroScreen introScreen; /** * The JFrame container. */ private Container container; /** * The gridbaglayout for the JFrame. */ private GridBagLayout gridLayout; /** * The gridbag constraints. */ private GridBagConstraints constraints; /** * The scrollbars for the drawing area. */ private JScrollPane scroller; /** * The viewport on the drawing area. */ private JViewport viewPort; /** * The FileUtility for opening the xmi files */ private FileUtility FUtil; public FaultTreeView() { // TODO Auto-generated constructor stub } @Override public void createPartControl(Composite parent) { Composite composite= new Composite (parent,SWT.EMBEDDED|SWT.BACKGROUND); Frame frame =SWT_AWT.new_Frame(composite); JInternalFrame mainFrame =new JInternalFrame(); JPanel panel=new JPanel(); //FaultTreeBrowser browser = new FaultTreeBrowser(); //frame.add(browser); FUtil = new FileUtility(); container = mainFrame.getContentPane(); gridLayout = new GridBagLayout(); constraints = new GridBagConstraints(); container.setLayout(gridLayout); infoPanel = new InfoPanel(); details = new FaultTreeDetails(infoPanel); menuBar = new BrowserMenu(); report = new Report(); drawingArea = new DrawingArea(details, infoPanel, menuBar); generalToolBar = new GeneralToolBar(infoPanel, report,drawingArea); faultTreeToolBar = new FaultTreeToolBar(infoPanel); toolHolder1 = new JPanel(); toolHolder2 = new JPanel(); toolHolder1.add(generalToolBar); toolHolder2.add(faultTreeToolBar); viewPort = new JViewport(); viewPort.setView(drawingArea); scroller = new JScrollPane(scroller.VERTICAL_SCROLLBAR_ALWAYS, scroller.HORIZONTAL_SCROLLBAR_ALWAYS); scroller.setViewport(viewPort); addComponent(toolHolder1, 0, 0, 1, 1, constraints.WEST, 0, 0, constraints.NONE); addComponent(toolHolder2, 1, 0, 1, 1, constraints.WEST, 0, 0, constraints.NONE); addComponent(scroller, 2, 0, 1, 2, constraints.WEST, 2, 1, constraints.BOTH); addComponent(details, 2, 1, 0, 0, constraints.WEST, 0, 0, constraints.BOTH); addComponent(infoPanel, 4, 0, 2, 2, constraints.WEST, 0, 0, constraints.NONE); mainFrame.setJMenuBar(menuBar.getMenu()); mainFrame.setSize(600, 600); mainFrame.setVisible(true); frame.add(mainFrame); } private void addComponent(Component c, int row, int column, int width, int height, int anchor, int weightx, int weighty, int fill) { constraints.gridx = column; constraints.gridy = row; constraints.gridwidth = width; constraints.gridheight = height; constraints.weightx = weightx; constraints.weighty = weighty; constraints.anchor = anchor; constraints.fill = fill; gridLayout.setConstraints(c, constraints); container.add(c); }Passing to SWT.ok thanks that you took teh tiem to answer,can you suggest a solution?cause not using SWT and Swing together is not the best solution...	12.0
id=362536	REOPENED	Platform	SWT	3.7.1	PC Windows 7	P3 critical	Platform-SWT-Inbox	2011-10-31 21:50 EDT by	Shawn Yuan	2011-11-04 10:28 EDT (	4 users	Build Identifier: 20110916-01491. eclipse can't display the latest project location when launch2. after launch, i can't click the package explorer. After resizing, it can be clicked3. when i try to change the encoding of file, at preference panel, the other encoding can't be shownReproducible: AlwaysSteps to Reproduce:1.dell m4600 win7 sp1 intel integrated graphic2.jdk 6 u29 64 edition3.exteral plugin : subClipse 1.6.10 jadClipse	Please provide screenshots.CreatedSee the preferencelos of radio button missingCreatedcombox errorcombox errorCreatedFail to disply combox for changing unicodeFail to disply combox for changing unicode.It's blank, but actually i could input utf-8 gb2312 gbkuploaded(In reply to)SWT, please advise.any suggestions??Are you working on this issue? SWT Team??How is it going? Nobody's working on this issue?(In reply to)(In reply to)Please be patient. The team will triage it, but it will take a while.PWok, i'm glad you replied me.. otherwise i've no idea about the progress. Thank you very much, if you need any info, please let me know(In reply to)i think you could close this now, i upgraded both integrated and standalone graphic drivers, it's ok now.(In reply to)(In reply to)Thank you for getting back to us, Shawn.eh... i turned on my computer just now... it failed again...is swt conflict with double graphic card??(In reply to)eh... i turned on my computer just now... it failed again...is swt conflict with double graphic card??Hey Shawn, sorry not being able to post earlier.The true is that I not able to reproduce your problem and I never heard of anyone else having similar type of problem. So as you see, I don't have where to start investigating this problem.I suspect there is something unique about your system and configuration that causes this problem to happen. Please continue to try changes to your system, I believe that eventually you will find the culprit. If it turns out that it is something I can recreate in machine then I will have a go at it.hi, i tried to uninstall one software that maybe cause such probelm. My colleagus use the same computer, same version of win7...i install the same softwares exclude one thing... Filezilla 3.2.2.1 and now it looks ok to me. but i'm still afraid of being reproducted again...(In reply to)	17.0
id=363441	REOPENED	Platform	SWT	3.7.1	Macintosh Mac OS X	P3 normal	Platform-SWT-Inbox	2011-11-10 04:38 EST by	Martin Novák	2011-11-12 18:00 EST (	6 users	Build Identifier: 20110916-0149I have dark editor background in Eclipse, and Lion is set to show scrollbars only when I'm scrolling. Eclipse really shows the scrollbars, but as they are dark as well, they cannot be seen easily. They blur with the background. I think they should be of opaque colour than the background of the editor.Also, please note that there is a small area in the bottom where there are some remaining gray instead of normal background. See the screenshot, please.Reproducible: AlwaysSteps to Reproduce:1. Set the Lion scrollbars to hide (Show scrollbars when scrolling in system prefs)2. Set the Eclipse editor background to something dark. #0c162c (12,28,60) in my case3. Try to scroll in the editor.	CreatedScreenshot of the problem*** This bug has been marked as a duplicate of***Moving to SWT for the hardly visible scrollbar.I guess we don't have control over the scrollbar color. At least SWT clients shouldn't have to care about this, but I also think SWT shouldn't have to do anything special. Looks like a bug for Apple. The OS should deal more gracefully with this situation.Spawnedfor the gray box in the line number ruler..If you openin Safari and reduce the window width, you can see that Apple doesn't address this problem in a general way.But in Terminal.app, they make the scroll bars gray when the background is too dark.(In reply to)I was looking into Cocoa docs, and there is just one possibility how to handle this - setKnobStyle (see the link bellow). So, it's possible just to set light/dark scrollbar. And this is how I think it should be handled. If you have dark background colour, set the know style to light. But maybe, it might be handled SWT.(In reply to)Yeah, that's true. It looks like they don't handle the scrollbar colour by the content, but by colour of the background...	7.0
id=344966	REOPENED	Platform	SWT	3.7	All All	P3 major	Platform-SWT-Inbox	2011-05-06 09:50 EDT by	Andreas Hoegger	2011-05-09 10:01 EDT (	3 users	CreatedPatch change isShowing() to isVisible()Looking at Control.setTabItemFocus() returns false for all controls having a size of 0,x or x,0 at this time. I do not see any reason to mix up showing information with a tab traversal. To ensure the layout of complex forms we collect all invalidation on the layout and async recalculate the layout once (Performance boost about factor 10). Since the traverse can change the visibility of the next control (master-slave) this field can getVisible immediatly and having a size of (0,0) - will be updated with the next layout batch job. -> Focus is anywhere but not in the next control. To fix this bug I suggest to change Control.setTabItemFocus the isShowing request with a isVisible.Have a look at the following example. After shell open the first TAB-traversal does not set the focus to the text2. Every next TAB works well.--------------------- Example ------------import org.eclipse.swt.SWT;import org.eclipse.swt.events.TraverseEvent;import org.eclipse.swt.events.TraverseListener;import org.eclipse.swt.layout.GridData;import org.eclipse.swt.layout.GridLayout;import org.eclipse.swt.widgets.Composite;import org.eclipse.swt.widgets.Display;import org.eclipse.swt.widgets.Shell;import org.eclipse.swt.widgets.Text;public class TraverseBug { public static void main(String[] args) { new TraverseBug().displayLoop(); } private void displayLoop(){ Display display = new Display(); Shell shell = new Shell(display); createContents(shell); shell.pack(); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } display.dispose(); } Text text1; Text text2; private void createContents(Composite parent) { text1 = new Text(parent, SWT.BORDER); text1.addTraverseListener(new TraverseListener() { @Override public void keyTraversed(TraverseEvent e) { toggleText2Visible(); } }); text2 = new Text(parent, SWT.BORDER); text2.setVisible(false); //layout parent.setLayout(new GridLayout(2, true)); text1.setLayoutData(new GridData(GridData.FILL_BOTH)); GridData gd = new GridData(GridData.FILL_BOTH); gd.exclude = true; text2.setLayoutData(gd); } private void toggleText2Visible() { boolean visible = !text2.getVisible(); GridData gd = (GridData) text2.getLayoutData(); gd.exclude = !visible; text2.setVisible(visible); text2.getDisplay().asyncExec(new Runnable() { @Override public void run() { text2.getParent().layout(true); } }); }}--------------- END EXAMPLE -----------------------	(In reply to)why would a control that is not visible take part in the traverse code ?You are changing the children list during traverse, that is special case and you will have to deal with it in your code.Does that work for you: text1.addTraverseListener(new TraverseListener() { public void keyTraversed(TraverseEvent e) { //toggleText2Visible(); boolean visible = !text2.getVisible(); GridData gd = (GridData) text2.getLayoutData(); gd.exclude = !visible; text2.setVisible(visible); text2.getParent().layout(new Control[] {text2}, SWT.DEFER);//note, in this case you don't really need to defer the layout... if (visible) { text2.setFocus(); e.doit = false; } } });(In reply to)I agree invisible controls should not take any focus. Now we have somehow to define what exactly an invisible control describes. From my point of view the size of a control has really nothing to do with its visibility especially in the SWT concepts where usually invisible controls reserve its space on in the container. Otherwise the getVisible() method should also consider the size of a control what nobody would expect.If you are having remote validations on a field (client-server), validation during traversal is the usual way also the validation can change visibility of controls. Furthermore in any RAP project people should take care about how many requests are shipped to the server part and think twice validating on anykey or modify.Separating model and UI makes a direct 'text2.setFocus()' impossible since text1 has no idea about the existence of a text2.If you do not want to change the existing behavior the bug could also be solved in a flag (stylebit) to set 'do not consider size in tab traversals'. This bug is relevant for the Eclipse Scout project.Thank youAndreasSorry Andreas, I can not change a behaviour that has been working over 10 years now. Besides, your code adds a bug, apply your patch and try this code:public class TraverseBug2 { public static void main(String[] args) { Display display = new Display(); Shell shell = new Shell(display); shell.setLayout(new GridLayout(3, true)); Text text1 = new Text(shell, SWT.BORDER); text1.setText("text1"); Text text2 = new Text(shell, SWT.BORDER); text2.setText("text2"); GridData gd = new GridData(GridData.FILL_BOTH); gd.exclude = true; text2.setLayoutData(gd); Text text3 = new Text(shell, SWT.BORDER); text3.setText("text3"); shell.pack(); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } display.dispose(); }}hit the Tab key, the focus moves from the text1 to text2 (which is not visible). To the user of the UI that is a bug.At this point I can't add any flags, we are passed API freeze.In your snippet you call text2.setVisible(), why can't you call setFocus() ?Sorry, this type of problem you need to fix in the application side. As you mention, your code has a concept of master-slave, change your framework to allow you to do what you need.Closing as not Eclipse.(In reply to)A 10 year existence of a bug does not legitimize it to exist an other 10 years;)>From my point of view this snippet is a bug. The concept of SWT is to set a control invisible to disappear from the screen and remove from the traversal list. The exclude flag in the layout is to free the allocated space in the layout for other controls. To get the expected behavior add the line 'text2.setVisible(false);'.The only reason makes the expected result is the layout has not be called before setting the exclude flag. Something like: Text t1 = new Text(parent, SWT.NONE); final Text t2 = new Text(parent, SWT.NONE); Text t3 = new Text(parent, SWT.NONE); //layout parent.setLayout(new GridLayout(3, true)); t1.setLayoutData(new GridData(GridData.FILL_BOTH)); GridData gd = new GridData(GridData.FILL_BOTH); t2.setLayoutData(gd); t3.setLayoutData(new GridData(GridData.FILL_BOTH)); t2.getDisplay().asyncExec(new Runnable() { @Override public void run() { ((GridData) t2.getLayoutData()).exclude = true; parent.layout(true); } }); }makes the focus traversing the invisible t2 because the size where set once to the t2.But we could try to find a solution for the next release.One of the main patterns in MVC and M2V architectures is the decoupling of UI and model/controller. In such architectures the value change of a UI (e.g. text) sets the new value to its model. A controller listens to this change executes some business logic and sets same properties of (other) controls (e.g. the visibility of the model part from text2). The model of text2 fires a property change where it's UI component listens to and sets the visibility of the UI control. So there is really no change without braking all patterns to set the focus straight from one UI control to another.The only and less performance killing workaround I see is to ensure with every visibility property event the size of a control is not (0,x) or (x,0). Even that increases the execution time of some property changes by factor 8.I reopend this bug since I have not seen any good reason to call the isShowing() method from the setTabItemFocus. Furthermore I'm really interested in having a sound and simple SWT code base. If needed I could help to solve this issue, create some test cases or doing some manual tests.ThanksAndy(In reply to)The one and only way to fix the TraverseBug2 is to consider the GridData.exclude flag in the Control.setTabItemFocus() method. Every other assumption as considering the size is a lucky punch could work for a certain use case. We both agree that considering a concrete layout data (GridData) in the traverse mechanism breaks SWT concepts and is not the way to go. -Andreas	5.0
id=368924	REOPENED	Platform	SWT	3.7.1	PC Linux	P3 normal	Platform-SWT-Inbox	2012-01-18 04:36 EST by	Marvin Fröhlich	2012-01-31 04:48 EST (	2 users	Build Identifier: 20110916-0149When I want to select a whole word through a double click it sometimes happens, that I accidentally do a triple click, which leads to the selection of the whole line. Unfortunately this also makes the editor scroll horizontally to the beginning of the line. Hence I have to scroll back to the word and do it again. This can be pretty nasty, if the line is not a short one.Since I have never ever needed that whole-line-selection-through-triple-click thing, I would be fine disabling it, if this is possible. Is it?I don't see the reason for scrolling back to column 0. The editor's view should stay where it is when selecting the whole line.Reproducible: Always	This is the behavior we get from StyledText and this is the expected behavior which most editors exhibit. Some set the caret at the end but they also scroll.I'd close this as INVALID or WONTFIX.Moving to SWT for comment.This might be the behavior of most text editors. But don't we want eclipse to be better? ;)I've asked some colleagues. And they all agree, that this behavior always sucked in any editor.(In reply to)Sure, but loosing the context/caret is not better but worse.Yes, you're loosing the caret, but not the context. The context is lost with the current behavior. And this is exactly my point.I agree with Dani. That said, note that StyledText allows the user to disable the double-click/triple-click behavior by calling setDoubleClickEnabled(false).closing.You agree with him by the statement, that context is lost? Why is the leftmost part of the current line more "context" than the part, that I scrolled to? Scrolling left most doesn't make any sense to me.Well, if I can disable the tripple-click behavior without disabling the double-click behavior, I am fine. Though I still consider it a bug.Could you possibly place the tripple-click disabling on the preferences pages?Sorry, this won't happen.	8.0
id=357874	REOPENED	Platform	SWT	3.6	PC Windows 7	P3 normal	Platform-SWT-Inbox	2011-09-15 16:11 EDT by	Shyam	2011-09-19 16:35 EDT (	2 users	Build Identifier: I20100608-0911This issue *only* occurs on 64-bit runtime. I cannot duplicate it using 32-bit runtime.Basically, when using SWT Ole to render an MSWord document, it is popping up a new, external window in order to render the document. If we try excel, powerpoint, etc...it all works fine, this is only an issue with MSWord on the 64-bit runtime.**Please note, that we have applied the Microsoft registry fix, to enable embedding MS Office documents in IE.I have attached a snippet for testing it out.Reproducible: AlwaysSteps to Reproduce:prereq - use the 64-bit runtime!1. Execute the snippet i attach to this bug.2. A file browser will open, choose an .docx file, click OK.Result: a new, external window opens and renders the document, instead of it being embedded in the application window. If you use the 32-bit runtime, the document is rendered withing the application window.	CreatedApplication which uses SWT Ole to render an MSWord document.Here is the registry fix from Microsoft which I mentioned in my bug report:This fix enables the Office applications to be embedded in IE. It must be installed in order to properly test this issue.SWT is not doing anything different for 64 bits, I suspect this is a bug in Office.ops, I didn't mean to close the bug.	4.0
id=370155	REOPENED	Platform	SWT	3.6.2	PC Windows 7	P3 normal	Platform-SWT-Inbox	2012-01-30 14:32 EST by	Garry Sager	2012-02-27 12:10 EST (	4 users	Build Identifier: M20110210-1200I have extended the Canvas class to create an expandable section control when The code is called the first time the composite is created when the code is called to draw focus the methodorg.eclipse.swt.graphics.GC.drawFocus (int x, int y, int width, intheight)which on the second line has this check:if ((data.uiState & OS.UISF_HIDEFOCUS) != 0) return;In the debugger I could see that data.uiState is always 3, so drawFocus()always exits without doing anything. on other versions of windows there is no issue and if the widget is recreated a second time there is no issue. It's not clear how the uiState is getting set differently on different OS's or why the second time creating the widget on a new composite makes the uiState 0Reproducible: Always	The behavior is correct, if you press ALT once while you window is up the ui state will change the focus rect will start drawing.Alternatively we can change windows preferences to always show the focus ring.So is there a way that through code I can have widgets I create that extend the canvas class display the focus We have radio buttons, combo boxes and others that get the focus but don't show the focus the first time the form they are displayed on is created on windows 7 but the second time the focus is displayed. On other versions of windows and linux we don't have this issue. Is there something we are supposed initialize in the control or the composite so the focus will display.SO I reopened this bug because the widgets I created that extended the canvas class do not display focus the very first time I display them only on windows 7. I don't understand how to get the UI state set for them but also combo boxes and radio buttons. Is there something I am supposed to call to init this UIstate for windows 7 that I don't need on other system. This setting for windows 7 that you mentioned I could not find. Any help would be appreciated.The issue seems to be if the controls are opened within the edtior view within a CTabFolder the CTabfolder UI state needs to be cleared of the Hide Focus on the first time the tab is created.Hi Garry, not sure why this work around did not work:void updateforFocus(Composite control) { Event e= new Event(); e.type= SWT.KeyDown; e.keyCode= SWT.ALT; control.getDisplay().post(e); e.type= SWT.KeyUp; control.getDisplay().post(e);}What you could try instead, is to change your workaround:void updateforFocus(Composite control) { int /*long*/ hwndShell = control.getShell ().handle; int uiState = /*64*/(int)OS.SendMessage (hwndShell, OS.WM_QUERYUISTATE, 0, 0); if ((uiState & OS.UISF_HIDEFOCUS) != 0) { OS.SendMessage (hwndShell, OS.WM_CHANGEUISTATE, OS.MAKEWPARAM (OS.UIS_CLEAR, OS.UISF_HIDEFOCUS), 0); } }to use reflection and only run it when SWT.getPlatform() == "win32".Garry, try this code: public static void main(final String[] args) { final Display display = new Display(); Shell shell = new Shell(display); shell.setLayout(new RowLayout()); Label label = new Label(shell, SWT.SINGLE); label.setText("text:"); final Combo combo = new Combo(shell, SWT.DROP_DOWN | SWT.READ_ONLY); combo.setItems(new String[] {"hello", "hi"}); combo.select(0); Button button = new Button(shell, SWT.PUSH); button.setText("button"); display.addFilter(SWT.KeyDown, new Listener() { public void handleEvent(Event event) { if (event.keyCode == SWT.F1) { combo.redraw(); System.out.println("redrawing"); } } }); shell.setSize(200, 200); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } display.dispose(); }note that when the window open the focus ring is not visible. When I press Alt the focus ring shows around the combo.Adding:Event e= new Event();e.type= SWT.KeyDown;e.keyCode= SWT.ALT;display.post(e);e.type= SWT.KeyUp;display.post(e);After shell.open() causes the windows to show with the focus ring showing.	6.0
id=374208	REOPENED	Platform	SWT	3.7.2	PC All	P3 critical	Platform-SWT-Inbox	2012-03-14 07:35 EDT by	Aaron Digulla	2016-10-09 05:57 EDT (	3 users	There is a critical bug in the handling of the SWTException: "Widget is disposed" inside of BusyIndicator.showWhile(): When the error happens, parts of the UI lock up. In my case, the save buttons are dead, so I can't save my work.I can close Eclipse when I start it with -console; this allows me to send the "close" command via OSGi. Without this, I risk a corrupted workspace when I have to kill Eclipse.The problem is when the shell is already disposed (happens pretty often when I type faster then Eclipse can pop up the code completion popup). In this case, the "install busy cursor" loop can fail with the error above.Suggested fix: Move the code to install/deinstall the busy cursor in a new method and protect this method with a `try/finally` plus a check whether the shell is already disposed.The resulting code must make sure that in case of any error, all installed busy cursors are remove again and that the code doesn't crash so in case of an error, no shells stay in the "locked" state.	Would it be possible to get this fix in 3.8?This bug accounts for 95% of my crashes of Eclipse, it's really annoying and relatively easy to fix.I can't reproduce this issue on Oxygen. Please try against a newer 4.7M build to see if the issue is still reproducible. Closing in the meantime.It's still there:display.getShells(); can return already disposed shells. One of the calls to shell.getData() or shell.setCursor() will throw "Widget is disposed" and the loop will abort. That in turn will leave some shells behind which still have the busy cursor installed which makes them unusable.You have to add a try-catch in all the loops.(In reply to Aaron Digulla from)	4.0
id=368926	REOPENED	Platform	SWT	3.7.1	PC Linux	P3 normal	Platform-SWT-Inbox	2012-01-18 04:47 EST by	Marvin Fröhlich	2012-01-31 05:04 EST (	3 users	Build Identifier: 20110916-0149Example code:###############################sdkfj lkwjekwj sdfjsd wlkjelkwj sdlkfjskldfj wekrjweklrj sdf AAA werewrwer asdQuick brown fox jumps over the lazy dog.Long line of code, that I would like to select parts of together with other ones.###############################The editor width is number of # chars here. I place the caret left to the AAA and start selecting. I want to select everything from AAA to together (two lines below). It I select using the mouse only or SHIFT+arrow_keys, the editor will jump left, because of the shorter line in the middle. I cannot select, what I wanted to select without interrupting the selection, scrolling back to where I was and proceed the selection.During a selection process the editor should always stay where it is unless I move the mouse or the caret to it's borders just like it is for the vertical case. It must never scroll horizontally just to show shorter lines. At least there should be a setting to make it behave.Reproducible: Always	Btw. I know, that the caret moves out of the editor's borders. But you know, what I mean. I haven't explicitly moved it out of scope.That's how all editors work that I know. Moving to SWT since this is StyledText behavior. I'd close this as WONTFIX.This might be the behavior of most text editors. But don't we want eclipse tobe better? ;)I've asked some colleagues. And they all agree, that this behavior alwayssucked in any editor.(In reply to)Sure, but loosing the context/caret is not better but worse.Yes, you're loosing the caret, but not the context. The context is lost withthe current behavior. And this is exactly my point.The editor has to show the selection. Not showing the user what is happening does not make sense to me. Sorry. Closing as wont fix.I think, you didn't get me. The point is, that I have scrolled to some excerpt for a reason. My scope is on the part of the text, that I am seeing atm. If the editor scrolls left when marking the second line, it may show, what's going on at exactly this time. But the context is completely lost andone line later I can't see, what should be going on, because I cannot select the text, that I want to select, because the editor accidentally scrolled away.You simply can't show, what's going on at all times, because the right-most part of the text will be invisible, if you scroll left. So some parts of what happens will always be hidden. And what the use actually wants to see, is the text he scrolled to and that he obviously wants to select.It would be an option to scroll left for the second line, but scroll back to the initial view when marking the third line.Could you please at least make it a user preference not to scroll leave the scope in that situation? I think, it would help a lot of people.Sorry, this won't happen.	8.0
id=375527	REOPENED	Platform	SWT	3.8	Macintosh Mac OS X	P3 normal	Platform-SWT-Inbox	2012-03-28 09:05 EDT by	Igor Fedorenko	2013-01-24 04:31 EST (	4 users	Createdtrivial java projectSteps to reproduce* start eclipse ide in self-hosted mode, i.e. as eclipse application started from another "primary" eclipse instance.* from the secondary instance debug attached project as java application and make the program stop at a breakpoint in main() method* hoover over args variableProblem: hoover is emptyThe problem is not present in "primary" eclipse instance.I was able to reproduce this problem on Eclipse 4.2M6, but it was present in earlier 3.8 and 4.2 builds.	Maybe something is not correct in your dev (primary) workspace is not complete. I can neither reproduce this on 3.8 M6 nor 4.2 M6 with these steps:1. start a new workspace2. Run > Run Configurations...3. double click 'Eclipse Application'4. click 'Run' ==> second workspace startsIn second workspace:1. import your project2. open Main.java3. add a breakpoint4. start debugger5. hover over main==> value is shown@Deni what operating system are you on? I only have the problem on OSX and everything works as expected under Linux. Brian de Alwis from e4 team was able to reproduce it his environment, so I am quite certain it is not specific to my environment.Here is a short video of the problem in OSX. Note that variable value only becomes visible when I select the hoover with the mouse and the hoover is blank before that.I'm on Windows 7. So this looks like an SWT bug then.	3.0
id=379852	REOPENED	Platform	SWT	3.6.2	PC Linux	P3 normal	Platform-SWT-Inbox	2012-05-17 16:47 EDT by	Kevan Holdaway	2012-12-10 04:26 EST (	1 user	Build Identifier: 3.6.2.r362_v20101117-0800org.eclipse.jface.wizard.WizardPage doesn't fully support Bidi. The title header is not working correctlyReproducible: AlwaysSteps to Reproduce:1. Launch eclipse with the arg -dir rtl2. Launch a wizard that uses org.eclipse.jface.wizard.WizardPage (e.g. Java Project or New Wizard Dialog).See screen shot.	CreatedScreen shot of text being on left instead of rightAny progress here? This has b een in the new state for almost 6 months.Is this fixed in Eclipse 4.2.x?I just tried plain 3.6.2:and 4.2.1:1. download one of the two builds2. start new workspace with -dir rtl==> all text is on the right.CreatedScreenshot from 3.6.2The screen shot added clearly shows Windows platform. This is a linux bug.And to clarify, it does indeed work on Windows. When this bug was opened we also discovered that it only applied to Linux. We saw it on RedHat. I am sure its not specific to Redhat. But it is a bug that doesn't apply to Windows.(In reply to)Yes, I only tested on Windows. So this looks like an SWT bug then.	8.0
id=385296	REOPENED	Platform	SWT	4.2	PC Windows 7	P3 critical	Platform-SWT-Inbox	2012-07-17 08:43 EDT by	dj l	2014-06-25 09:16 EDT (	11 users	Build Identifier: 20120614-1722I'm getting frequent and consistently reproducible hangs in the Java Editor in Eclipse Juno that makes the system usuable. The only fix is to force close Eclipse.I've Googled everything I can find on this subject, but have found nothing that will fix the issue.I've tried taking a heat dump, but visualvm and jmap will not connect to eclipse process after it hangs. If I attach visualvm before Eclipse hangs and monitor process, I can see the following jump on graphs at the time of crash:PermaGen: 60MB to 115MB (Max 135MB)Number loaded classes: 9K to 16KLive threads: 21 to 30CPU usage spikes to about 90%, but drops back to 0% after a few minutes (but Eclipse remains unresponsive).My eclipse.ini file is:-startupplugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar--launcher.libraryplugins/org.eclipse.equinox.launcher.win32.win32.x86_64_1.1.200.v20120522-1813-productorg.eclipse.epp.package.jee.product--launcher.defaultActionopenFile--launcher.XXMaxPermSize256M-showsplashorg.eclipse.platform--launcher.XXMaxPermSize256m-XX:MaxPermSize=256M--launcher.defaultActionopenFile-vmC:\Program Files\Java\jdk1.7.0_05\jre\bin\javaw.exe-vmargs-Dosgi.requiredJavaVersion=1.5-Dhelp.lucene.tokenizer=standard-Xms256m-Xmx1024mEclipse short-ut command line:"C:\Program Files\Java\eclipse\eclipse.exe" -XX:MaxPermSize=256M -XX:+HeapDumpOnOutOfMemoryError(Note - I can't see a heat dump file saved by Eclipse on out of memory error. It appears that Eclipse is not totally out of memory when it hangs, which could explain it).Installed Add-Ins:- Eclipse IDE for Java EE Developers- JBoss Drools Core 5.3.0 Final- JBoss Drools Guvnor 5.3.0 Final- JBoss Drools Task 5.3.0 Final- Memory Analyser- Memory Analyser (Charts)I previously experienced same hanging issue in Indigo, which is why I upgraded to Juno. I've also tried downgrading to JDK/JRE 1.6, which no success.I've turned off all autocomplete and spelling options in Eclipse for Java Editor, together with Copy short-cut key bindings.Happy to provide any other details. Also, if you can advise how to get a heat dump, I'd be happy to attach.Look forward to your assistance. Been suffering this issue for about 2 weeks and now at my wits end!Reproducible: AlwaysSteps to Reproduce:1. Open Eclipse2. Open any .java file in Java Editor3. Start typing some simple text, such as editing a string.4. Within 30 seconds Eclipse will become non-responsive.I can edit other files (jsp, html, drl) with no problems.Sometimes Eclipse hangs after start-up with the status bar showing "Marketplace DND Initialization".	When it hangs, could you please take a stack snapshot and attach it.PWCreatedHeap Dump (BEFORE Hang)Attached is a Heap Dump immediately BEFORE Eclipse hangs.I have unsuccessfully attempted to obtain a Heap Dump AFTER Eclipse hangs as follows:1. Java VisualVM is able to obtain a Heat Dump before the Eclipse hang (attached). However, once Eclipse has hung, Visual VM itself hangs when trying to obtain a heap dump.2. I attempted to download the Adaptj StackTrace tool, but the adaptj site no longer exists:. Searching the internet it appears that this tool has now been deprecated. Please advise if there is a safe, working copy of this tool that I can download.3. I have attempted to obtain a stack trace using eclipsesec.exe, however this too seems to crash after Eclipse has hung. When I press the Control+Break keys, the console window disappears and I'm left with the hung version of Eclipse. No stack trace is diplayed on screen. Should a dump file be saved to my hard drive? Please provide further instructions to complete this method.4. I have attempted to connect to Eclipse with jconsole.exe. As with visualvm, I am able to connect OK before Eclipse hangs. Once Eclipse hangs (which happens within seconds of opening a Java Editor window), jconsole loses the connection to Eclipse and cannot reconnect. I'll attach further screen shots to be attached.5. I haven't attempted to follow the methods for obtaining stack traces on Unix, Linux, and Mac OS X systems. Please provide some additional guidance or instructions for obtaining a heap dump or stack trace.Note that after I force close Eclipse, the following error message is displayed:---------------------------Eclipse---------------------------Java was started but returned exit code=-805306369C:\Program Files\Java\jdk1.7.0_05\jre\bin\javaw.exe-Dosgi.requiredJavaVersion=1.5-Dhelp.lucene.tokenizer=standard-Xms256m-Xmx1024m-XX:MaxPermSize=256m-jar C:\Program Files\Java\eclipse\\plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar-os win32-ws win32-arch x86_64-showsplash C:\Program Files\Java\eclipse\\plugins\org.eclipse.platform_4.2.0.v201206081400\splash.bmp-launcher C:\Program Files\Java\eclipse\eclipse.exe-name Eclipse--launcher.library C:\Program Files\Java\eclipse\\plugins/org.eclipse.equinox.launcher.win32.win32.x86_64_1.1.200.v20120522-1813\eclipse_1503.dll-startup C:\Program Files\Java\eclipse\\plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar--launcher.overrideVmargs-exitdata 24d0_5c-product org.eclipse.epp.package.jee.product-XX:MaxPermSize=256M-XX:MaxPermSize=256M-XX:+HeapDumpOnOutOfMemoryError-vm C:\Program Files\Java\jdk1.7.0_05\jre\bin\javaw.exe-vmargs-Dosgi.requiredJavaVersion=1.5-Dhelp.lucene.tokenizer=standard-Xms256m-Xmx1024m-XX:MaxPermSize=256m-jar C:\Program Files\Java\eclipse\\plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar ---------------------------OK ---------------------------I look forward to your further assistance. In the meantime I am using Notepad to edit my java code, which is not very productive!Try to use java.exe instead of javaw.exeAlso, can you try whether the hang occurs in plain Eclipse SDK:(In reply to)Thanks for the suggestions.I've downloaded the plain Eclipse SDK and the hang does not appear to occur when editing Java files in this version. After switching back to Juno release from the plain Eclipse SDK, I could edit Java files for a few minutes before the hang returned (previously the hang would arise within seconds of editing a Java file).I have tried starting Eclipse Juno with java.exe instead of javaw.exe, but still not able to take a heap dump when Eclipse crashes (either using Control + Break keys in console or attempting to attach to Eclipse with visualvm).Do you have any further suggestions for obtaining a heapdump?(In reply to)How are you launching eclipse in the console? You need to use java.exe and eclipsec.exe to get a stack dump on CTRL+BREAK.c:\eclispe> eclipsec.exe -vm "C:\Program Files\Java\jdk1.7.0_05\jre\bin\java.exe"PW(In reply to)If I try to run eclipsec.exe from DOS prompt (using your suggestion), the console window doesn't display when Eclipse launches.If I run "C:\Program Files\Java\eclipse\eclipsec.exe" -vm "C:\Program Files\Java\jdk1.7.0_05\jre\bin\java.exe" from Windows Start-Run menu, the console window opens. However, when Eclipse hangs, pressing Control + Break in the console window does nothing. (Note - as I'm using a laptop the Break key is doubled with Pause key on keyboard, so I have to press Control + Fn key + Pause/Break. Perhaps that short cut combination isn't recognised by console windows? Control + Pause doesn't work either).Just Googled that I can use Control + ScrLk instead and got the dump below from console when eclipsec hang shortly after opening (note that I wasn't in the Java editor when this happened). I tried to repeat this after eclipse hung in Java editor, but Control + ScrLk didn't work again in this situation.2012-07-21 00:15:34Full thread dump Java HotSpot(TM) 64-Bit Server VM (23.1-b03 mixed mode):"[ThreadPool Manager] - Idle Thread" daemon prio=6 tid=0x000000000f878000 nid=0x2fd4 in Object.wait() [0x000000001124e000] java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x00000000ebb1b2e8> (a org.eclipse.equinox.internal.util.impl.tpt.threadpool.Executor) at java.lang.Object.wait(Object.java:503) at org.eclipse.equinox.internal.util.impl.tpt.threadpool.Executor.run(Executor.java:106) - locked <0x00000000ebb1b2e8> (a org.eclipse.equinox.internal.util.impl.tpt.threadpool.Executor)"org.eclipse.jface.text.reconciler.MonoReconciler" daemon prio=2 tid=0x000000000f877000 nid=0x26bc in Object.wait() [0x000000000ff7f000] java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x00000000c1df7268> (a org.eclipse.jface.text.reconciler.DirtyRegionQueue) at org.eclipse.jface.text.reconciler.AbstractReconciler$BackgroundThread.run(AbstractReconciler.java:179) - locked <0x00000000c1df7268> (a org.eclipse.jface.text.reconciler.DirtyRegionQueue)"Worker-2" prio=6 tid=0x000000000f876800 nid=0x994 in Object.wait() [0x000000001203f000] java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x00000000c1b04900> (a org.eclipse.core.internal.jobs.WorkerPool) at org.eclipse.core.internal.jobs.WorkerPool.sleep(WorkerPool.java:188) - locked <0x00000000c1b04900> (a org.eclipse.core.internal.jobs.WorkerPool) at org.eclipse.core.internal.jobs.WorkerPool.startJob(WorkerPool.java:220) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:50)"Java indexing" daemon prio=4 tid=0x000000000f875800 nid=0x240c in Object.wait() [0x000000001339f000] java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x00000000c1b6c9b0> (a org.eclipse.jdt.internal.core.search.indexing.IndexManager) at java.lang.Object.wait(Object.java:503) at org.eclipse.jdt.internal.core.search.processing.JobManager.run(JobManager.java:382) - locked <0x00000000c1b6c9b0> (a org.eclipse.jdt.internal.core.search.indexing.IndexManager) at java.lang.Thread.run(Thread.java:722)"Bundle File Closer" daemon prio=6 tid=0x000000000f875000 nid=0x2584 in Object.wait() [0x000000000fdff000] java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x00000000c1df72e8> (a org.eclipse.osgi.framework.eventmgr.EventManager$EventThread) at java.lang.Object.wait(Object.java:503) at org.eclipse.osgi.framework.eventmgr.EventManager$EventThread.getNextEvent(EventManager.java:400) - locked <0x00000000c1df72e8> (a org.eclipse.osgi.framework.eventmgr.EventManager$EventThread) at org.eclipse.osgi.framework.eventmgr.EventManager$EventThread.run(EventManager.java:336)"Worker-1" prio=6 tid=0x000000000dc03800 nid=0x3a8 in Object.wait() [0x000000000faff000] java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x00000000c1b04900> (a org.eclipse.core.internal.jobs.WorkerPool) at org.eclipse.core.internal.jobs.WorkerPool.sleep(WorkerPool.java:188) - locked <0x00000000c1b04900> (a org.eclipse.core.internal.jobs.WorkerPool) at org.eclipse.core.internal.jobs.WorkerPool.startJob(WorkerPool.java:220) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:50)"Worker-0" prio=6 tid=0x000000000cffd800 nid=0xa00 in Object.wait() [0x000000000e94e000] java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x00000000c1e22448> (a org.eclipse.ui.internal.Semaphore) at org.eclipse.ui.internal.Semaphore.acquire(Semaphore.java:43) - locked <0x00000000c1e22448> (a org.eclipse.ui.internal.Semaphore) at org.eclipse.ui.internal.UISynchronizer.syncExec(UISynchronizer.java:168) at org.eclipse.swt.widgets.Display.syncExec(Display.java:4687) at org.eclipse.team.internal.ccvs.ui.CVSLightweightDecorator.ensureFontAndColorsCreated(CVSLightweightDecorator.java:88) at org.eclipse.team.internal.ccvs.ui.CVSLightweightDecorator.<init>(CVSLightweightDecorator.java:73) at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57) at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) at java.lang.reflect.Constructor.newInstance(Constructor.java:525) at java.lang.Class.newInstance0(Class.java:372) at java.lang.Class.newInstance(Class.java:325) at org.eclipse.core.internal.registry.osgi.RegistryStrategyOSGI.createExecutableExtension(RegistryStrategyOSGI.java:184) at org.eclipse.core.internal.registry.ExtensionRegistry.createExecutableExtension(ExtensionRegistry.java:905) at org.eclipse.core.internal.registry.ConfigurationElement.createExecutableExtension(ConfigurationElement.java:243) at org.eclipse.core.internal.registry.ConfigurationElementHandle.createExecutableExtension(ConfigurationElementHandle.java:55) at org.eclipse.ui.internal.WorkbenchPlugin$1.run(WorkbenchPlugin.java:273) at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:52) at org.eclipse.ui.internal.WorkbenchPlugin.createExtension(WorkbenchPlugin.java:269) at org.eclipse.ui.internal.decorators.LightweightDecoratorDefinition$1.run(LightweightDecoratorDefinition.java:124) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.core.runtime.Platform.run(Platform.java:857) at org.eclipse.ui.internal.decorators.LightweightDecoratorDefinition.internalGetDecorator(LightweightDecoratorDefinition.java:120) at org.eclipse.ui.internal.decorators.LightweightDecoratorDefinition.decorate(LightweightDecoratorDefinition.java:251) at org.eclipse.ui.internal.decorators.LightweightDecoratorManager$LightweightRunnable.run(LightweightDecoratorManager.java:81) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.internal.decorators.LightweightDecoratorManager.decorate(LightweightDecoratorManager.java:365) at org.eclipse.ui.internal.decorators.LightweightDecoratorManager.getDecorations(LightweightDecoratorManager.java:347) at org.eclipse.ui.internal.decorators.DecorationScheduler$1.ensureResultCached(DecorationScheduler.java:371) at org.eclipse.ui.internal.decorators.DecorationScheduler$1.run(DecorationScheduler.java:331) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)"Worker-JM" prio=6 tid=0x000000000c4e1800 nid=0x1508 in Object.wait() [0x000000000e22f000] java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x00000000c1f0b148> (a java.util.ArrayList) at org.eclipse.core.internal.jobs.InternalWorker.run(InternalWorker.java:58) - locked <0x00000000c1f0b148> (a java.util.ArrayList)"[Timer] - Main Queue Handler" daemon prio=6 tid=0x000000000d4d1800 nid=0x2a8c in Object.wait() [0x000000000e44f000] java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x00000000c1c0e9d0> (a java.lang.Object) at org.eclipse.equinox.internal.util.impl.tpt.timer.TimerImpl.run(TimerImpl.java:141) - locked <0x00000000c1c0e9d0> (a java.lang.Object) at java.lang.Thread.run(Thread.java:722)"Framework Event Dispatcher" daemon prio=6 tid=0x000000000d304800 nid=0x774 in Object.wait() [0x000000000e11f000] java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x00000000c1df7540> (a org.eclipse.osgi.framework.eventmgr.EventManager$EventThread) at java.lang.Object.wait(Object.java:503) at org.eclipse.osgi.framework.eventmgr.EventManager$EventThread.getNextEvent(EventManager.java:400) - locked <0x00000000c1df7540> (a org.eclipse.osgi.framework.eventmgr.EventManager$EventThread) at org.eclipse.osgi.framework.eventmgr.EventManager$EventThread.run(EventManager.java:336)"Start Level Event Dispatcher" daemon prio=6 tid=0x000000000c87d000 nid=0x2fa8 in Object.wait() [0x000000000cdaf000] java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x00000000c1df75b8> (a org.eclipse.osgi.framework.eventmgr.EventManager$EventThread) at java.lang.Object.wait(Object.java:503) at org.eclipse.osgi.framework.eventmgr.EventManager$EventThread.getNextEvent(EventManager.java:400) - locked <0x00000000c1df75b8> (a org.eclipse.osgi.framework.eventmgr.EventManager$EventThread) at org.eclipse.osgi.framework.eventmgr.EventManager$EventThread.run(EventManager.java:336)"State Data Manager" daemon prio=6 tid=0x000000000b109800 nid=0x58c waiting on condition [0x000000000cf1f000] java.lang.Thread.State: TIMED_WAITING (sleeping) at java.lang.Thread.sleep(Native Method) at org.eclipse.osgi.internal.baseadaptor.StateManager.run(StateManager.java:297) at java.lang.Thread.run(Thread.java:722)"Framework Active Thread" prio=6 tid=0x000000000b373800 nid=0x2d4c in Object.wait() [0x000000000cb3f000] java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x00000000f2bf03e0> (a org.eclipse.osgi.framework.internal.core.Framework) at org.eclipse.osgi.framework.internal.core.Framework.run(Framework.java:1863) - locked <0x00000000f2bf03e0> (a org.eclipse.osgi.framework.internal.core.Framework) at java.lang.Thread.run(Thread.java:722)"Service Thread" daemon prio=6 tid=0x0000000009609800 nid=0x2e3c runnable [0x0000000000000000] java.lang.Thread.State: RUNNABLE"C2 CompilerThread1" daemon prio=10 tid=0x0000000009608800 nid=0x1af0 waiting on condition [0x0000000000000000] java.lang.Thread.State: RUNNABLE"C2 CompilerThread0" daemon prio=10 tid=0x00000000095fb800 nid=0x25d0 waiting on condition [0x0000000000000000] java.lang.Thread.State: RUNNABLE"Attach Listener" daemon prio=10 tid=0x00000000095f8800 nid=0x2de0 runnable [0x0000000000000000] java.lang.Thread.State: RUNNABLE"Signal Dispatcher" daemon prio=10 tid=0x00000000095f1000 nid=0x1e44 waiting on condition [0x0000000000000000] java.lang.Thread.State: RUNNABLE"Finalizer" daemon prio=8 tid=0x0000000002106800 nid=0x11c8 in Object.wait() [0x000000000a7bf000] java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x00000000c1e24070> (a java.lang.ref.ReferenceQueue$Lock) at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:135) - locked <0x00000000c1e24070> (a java.lang.ref.ReferenceQueue$Lock) at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:151) at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:177)"Reference Handler" daemon prio=10 tid=0x00000000020ff800 nid=0x5b0 in Object.wait() [0x000000000a8ef000] java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x00000000c1e62368> (a java.lang.ref.Reference$Lock) at java.lang.Object.wait(Object.java:503) at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:133) - locked <0x00000000c1e62368> (a java.lang.ref.Reference$Lock)"main" prio=6 tid=0x0000000002048000 nid=0x2e00 runnable [0x00000000023bd000] java.lang.Thread.State: RUNNABLE at org.eclipse.swt.internal.win32.OS.VtblCall(Native Method) at org.eclipse.swt.widgets.TaskBar.getDirectory(TaskBar.java:346) at org.eclipse.swt.widgets.TaskBar.getDirectory(TaskBar.java:304) at org.eclipse.swt.widgets.TaskBar.setMenu(TaskBar.java:518) at org.eclipse.swt.widgets.TaskItem.setMenu(TaskItem.java:247) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:601) at org.eclipse.mylyn.commons.workbench.TaskBarManager$TaskBarMenuManager.setMenuOnTaskItem(TaskBarManager.java:120) at org.eclipse.mylyn.commons.workbench.TaskBarManager$TaskBarMenuManager.update(TaskBarManager.java:111) at org.eclipse.jface.action.MenuManager.update(MenuManager.java:682) at org.eclipse.mylyn.internal.tasks.ui.TasksUiPlugin.addSystemTaskBarActions(TasksUiPlugin.java:486) at org.eclipse.mylyn.internal.tasks.ui.TasksUiPlugin.access$6(TasksUiPlugin.java:465) at org.eclipse.mylyn.internal.tasks.ui.TasksUiPlugin$TasksUiInitializationJob.runInUIThread(TasksUiPlugin.java:439) at org.eclipse.ui.progress.UIJob$1.run(UIJob.java:95) at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35) at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135) - locked <0x00000000c1f0a858> (a org.eclipse.swt.widgets.RunnableLock) at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4144) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3761) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1022) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:916) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:86) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:585) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:540) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:353) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:180) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:601) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:629) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:584) at org.eclipse.equinox.launcher.Main.run(Main.java:1438) at org.eclipse.equinox.launcher.Main.main(Main.java:1414)"VM Thread" prio=10 tid=0x0000000009573000 nid=0x7f0 runnable"GC task thread#0 (ParallelGC)" prio=6 tid=0x0000000002055800 nid=0x2080 runnable"GC task thread#1 (ParallelGC)" prio=6 tid=0x0000000002057000 nid=0x2f20 runnable"GC task thread#2 (ParallelGC)" prio=6 tid=0x0000000002059000 nid=0x2de4 runnable"GC task thread#3 (ParallelGC)" prio=6 tid=0x000000000205a800 nid=0x17ec runnable"VM Periodic Task Thread" prio=10 tid=0x0000000009612800 nid=0x2ad4 waiting on conditionJNI global references: 372Heap PSYoungGen total 142080K, used 30952K [0x00000000eaab0000, 0x0000000000000000, 0x0000000000000000) eden space 131200K, 15% used [0x00000000eaab0000,0x00000000ebe4ab80,0x00000000f2ad0000) from space 10880K, 99% used [0x00000000f2ad0000,0x00000000f356f4f0,0x00000000f3570000) to space 47040K, 0% used [0x00000000fd210000,0x00000000fd210000,0x0000000000000000) ParOldGen total 174784K, used 57341K [0x00000000c0000000, 0x00000000caab0000, 0x00000000eaab0000) object space 174784K, 32% used [0x00000000c0000000,0x00000000c37ff5e0,0x00000000caab0000) PSPermGen total 59456K, used 59365K [0x00000000b0000000, 0x00000000b3a10000, 0x00000000c0000000) object space 59456K, 99% used [0x00000000b0000000,0x00000000b39f9700,0x00000000b3a10000)It hangs in OS.VtblCall(...).Workaround: disabling/uninstalling Mylyn. at org.eclipse.swt.internal.win32.OS.VtblCall(Native Method) at org.eclipse.swt.widgets.TaskBar.getDirectory(TaskBar.java:346) at org.eclipse.swt.widgets.TaskBar.getDirectory(TaskBar.java:304) at org.eclipse.swt.widgets.TaskBar.setMenu(TaskBar.java:518) at org.eclipse.swt.widgets.TaskItem.setMenu(TaskItem.java:247) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) atsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) atsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:601) atorg.eclipse.mylyn.commons.workbench.TaskBarManager$TaskBarMenuManager.setMenuOnTaskItem(TaskBarManager.java:120) atorg.eclipse.mylyn.commons.workbench.TaskBarManager$TaskBarMenuManager.update(TaskBarManager.java:111) at org.eclipse.jface.action.MenuManager.update(MenuManager.java:682) atorg.eclipse.mylyn.internal.tasks.ui.TasksUiPlugin.addSystemTaskBarActions(TasksUiPlugin.java:486) atorg.eclipse.mylyn.internal.tasks.ui.TasksUiPlugin.access$6(TasksUiPlugin.java:465) atorg.eclipse.mylyn.internal.tasks.ui.TasksUiPlugin$TasksUiInitializationJob.runInUIThread(TasksUiPlugin.java:439) at org.eclipse.ui.progress.UIJob$1.run(UIJob.java:95) at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)Thanks - this appears to have fixed the issue.I had never installed Mylyn as a plug-in (I double-checked my installation history - I believe it came pre-installed with Eclipse Juno) and wasn't actively using it (although the Mylyn task list was occasionally showing up in my views). Accordingly there was nothing for me to "uninstall".I deleted all Mylyn files from my eclipse plugins and features folders (as per Mylyn FAQ) and did a clean start of Eclipse.Thanks very much for the excellent and responsive support. Really appreciate your assistance and would encourage others to submit any Eclipse issues here. Wish I'd done it sooner rather than trying to Google a result!!!Hope this helps someone else.I have marked this issue as resolved.Reopening, as it should also not hang when Mylyn is there.I was experiencing a very similar issue - hanging (Application greyed) and slow UI interface components.To resolve it I upgraded from JDK 1.6.0_27 to 1.6.0_33.I did not try removing Mylyn.I'm using Java 1.7:C:\Program Files\Java\jdk1.7.0_05\bin>java -versionjava version "1.7.0_05"Java(TM) SE Runtime Environment (build 1.7.0_05-b06)Java HotSpot(TM) 64-Bit Server VM (build 23.1-b03, mixed mode)I am using Sun's 7u6 on Win7 x86. Reproducible. Open a relatively large java file, write something, delete it, write again, delete again -> eclipse becomes extremely sluggish and after a bit it hangs and CPU usage drops to <= 5%. Never recovers, must force-close.C:\Users\Tadas>java -versionjava version "1.7.0_06"Java(TM) SE Runtime Environment (build 1.7.0_06-b24)Java HotSpot(TM) Client VM (build 23.2-b09, mixed mode, sharing)(In reply to)What size does it have exactly? Are there very long lines (please provide the line length) in the file?In my looking into a similar problem I discovered that my eclipse.ini file had somehow disappeared. This left me with default heap settings. Others with similar experiences should also review the heap size settings in their eclipse.ini file.Recently I also experienced Eclipse Juno hangups at startup. I found out that as long as I did not install the Subversive plugins there was no problem. As soon as I installed Subversive the hangups occurred again. Well, so my solution to the startup hangup was simply using Subclipse instead of Subversive. I know this sounds strange but it worked out for me.I had this issue after installing JBoss tools. It was fixed by removing plugin and features folders for anything saying jboss.Install JBoss Tools eclipse pluginsHelp >> Install New Software... ()JBoss Maven support (all)JBoss Web and Java EE Development (all minus portlet and mobile browser simulator)That didn't do it. I removed Mylin and Jboss and it is STILL hanging. In my case, it's whenever I'm in the Windowbuilder visual designer tool making changes. Before long, when I go to save it checks out to lunch-- just hangs. When I go to see what's up, it's always the "JAVAW.EXE" process that's hung and killing it is the only way out.I have not found any workaround. I'm using the latest version of Eclipse (Juno 4.2 eclipse-jee-juno-SR2-win32-x86_64), Java (jdk-7u21-windows-x64, jre-7u21-windows-x64, jre-7u21-windows-i586), etc. When I was just using the plain vanilla Eclipse with just the Windowbuilder, it seemed okay. It was after I installed a number of plugins (no idea what combination did it, or maybe it was just the act of installing any plugin??) that's when the problems seem to start. I have dumped and rebuilt my eclipse installation a number of times and always end up in this situation sooner or later.(In reply to)Can you please create a stack dump when it hangs and attach it here.Maybe similar. Eclipse (eclipse-jee-kepler-SR2-win32-x86_64, freshly installed) hangs when: during rebuilding workspace the SVN team provider asked to update the working copy to a new version. Thread dump:2014-03-10 13:08:10Full thread dump Java HotSpot(TM) 64-Bit Server VM (24.45-b08 mixed mode):"RMI TCP Connection(2)-10.1.2.5" daemon prio=6 tid=0x000000001cdfb800 nid=0x2614 runnable [0x000000002114e000] java.lang.Thread.State: RUNNABLE at java.net.SocketInputStream.socketRead0(Native Method) at java.net.SocketInputStream.read(Unknown Source) at java.net.SocketInputStream.read(Unknown Source) at java.io.BufferedInputStream.fill(Unknown Source) at java.io.BufferedInputStream.read(Unknown Source) - locked <0x00000007674704d0> (a java.io.BufferedInputStream) at java.io.FilterInputStream.read(Unknown Source) at sun.rmi.transport.tcp.TCPTransport.handleMessages(Unknown Source) at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(Unknown Source) at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(Unknown Source) at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) at java.lang.Thread.run(Unknown Source) Locked ownable synchronizers: - <0x0000000767470720> (a java.util.concurrent.ThreadPoolExecutor$Worker)"JMX server connection timeout 52" daemon prio=6 tid=0x000000001cdfa800 nid=0x2754 in Object.wait() [0x0000000022c7f000] java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x00000007674371e8> (a [I) at com.sun.jmx.remote.internal.ServerCommunicatorAdmin$Timeout.run(Unknown Source) - locked <0x00000007674371e8> (a [I) at java.lang.Thread.run(Unknown Source) Locked ownable synchronizers: - None"RMI Scheduler(0)" daemon prio=6 tid=0x000000001cdfa000 nid=0x4fc waiting on condition [0x000000002139f000] java.lang.Thread.State: TIMED_WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for <0x0000000767400068> (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject) at java.util.concurrent.locks.LockSupport.parkNanos(Unknown Source) at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(Unknown Source) at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(Unknown Source) at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(Unknown Source) at java.util.concurrent.ThreadPoolExecutor.getTask(Unknown Source) at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) at java.lang.Thread.run(Unknown Source) Locked ownable synchronizers: - None"RMI TCP Connection(1)-10.1.2.5" daemon prio=6 tid=0x000000001cdf9000 nid=0x19fc runnable [0x000000001e91e000] java.lang.Thread.State: RUNNABLE at java.net.SocketInputStream.socketRead0(Native Method) at java.net.SocketInputStream.read(Unknown Source) at java.net.SocketInputStream.read(Unknown Source) at java.io.BufferedInputStream.fill(Unknown Source) at java.io.BufferedInputStream.read(Unknown Source) - locked <0x00000007674a5bc0> (a java.io.BufferedInputStream) at java.io.FilterInputStream.read(Unknown Source) at sun.rmi.transport.tcp.TCPTransport.handleMessages(Unknown Source) at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(Unknown Source) at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(Unknown Source) at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) at java.lang.Thread.run(Unknown Source) Locked ownable synchronizers: - <0x00000007674a5d00> (a java.util.concurrent.ThreadPoolExecutor$Worker)"RMI TCP Accept-0" daemon prio=6 tid=0x000000001cdf8800 nid=0x2054 runnable [0x000000002168e000] java.lang.Thread.State: RUNNABLE at java.net.DualStackPlainSocketImpl.accept0(Native Method) at java.net.DualStackPlainSocketImpl.socketAccept(Unknown Source) at java.net.AbstractPlainSocketImpl.accept(Unknown Source) at java.net.PlainSocketImpl.accept(Unknown Source) - locked <0x0000000767437338> (a java.net.SocksSocketImpl) at java.net.ServerSocket.implAccept(Unknown Source) at java.net.ServerSocket.accept(Unknown Source) at sun.management.jmxremote.LocalRMIServerSocketFactory$1.accept(Unknown Source) at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.executeAcceptLoop(Unknown Source) at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.run(Unknown Source) at java.lang.Thread.run(Unknown Source) Locked ownable synchronizers: - None"Worker-10" prio=6 tid=0x0000000016bae000 nid=0x23e4 in Object.wait() [0x000000001e2ae000] java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x000000076112e7a8> (a org.eclipse.core.internal.jobs.WorkerPool) at org.eclipse.core.internal.jobs.WorkerPool.sleep(WorkerPool.java:188) - locked <0x000000076112e7a8> (a org.eclipse.core.internal.jobs.WorkerPool) at org.eclipse.core.internal.jobs.WorkerPool.startJob(WorkerPool.java:220) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:50) Locked ownable synchronizers: - None"Worker-9" prio=6 tid=0x0000000016bad000 nid=0x25ec in Object.wait() [0x000000001ec8f000] java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x000000076112e7a8> (a org.eclipse.core.internal.jobs.WorkerPool) at org.eclipse.core.internal.jobs.WorkerPool.sleep(WorkerPool.java:188) - locked <0x000000076112e7a8> (a org.eclipse.core.internal.jobs.WorkerPool) at org.eclipse.core.internal.jobs.WorkerPool.startJob(WorkerPool.java:220) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:50) Locked ownable synchronizers: - None"ModalContext" prio=6 tid=0x0000000016bab800 nid=0x2508 in Object.wait() [0x000000002100f000] java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x00000007627a99b8> (a java.lang.Object) at java.lang.Object.wait(Object.java:503) at org.eclipse.core.internal.jobs.ThreadJob.waitForRun(ThreadJob.java:270) - locked <0x00000007627a99b8> (a java.lang.Object) at org.eclipse.core.internal.jobs.ThreadJob.joinRun(ThreadJob.java:197) at org.eclipse.core.internal.jobs.ImplicitJobs.begin(ImplicitJobs.java:92) at org.eclipse.core.internal.jobs.JobManager.beginRule(JobManager.java:286) at org.eclipse.core.internal.resources.WorkManager.checkIn(WorkManager.java:118) at org.eclipse.core.internal.resources.Workspace.prepareOperation(Workspace.java:2283) at org.eclipse.core.internal.resources.Workspace.run(Workspace.java:2340) at org.eclipse.ui.actions.WorkspaceModifyOperation.run(WorkspaceModifyOperation.java:118) - locked <0x00000007674003a8> (a org.eclipse.team.svn.ui.utility.WorkspaceModifyCancellableOperationWrapper) at org.eclipse.jface.operation.ModalContext$ModalContextThread.run(ModalContext.java:121) Locked ownable synchronizers: - None"SVN Kit 1.8 Connector" prio=6 tid=0x0000000016baa000 nid=0x2514 in Object.wait() [0x0000000022b2f000] java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x0000000767dded30> (a java.util.ArrayList) at java.lang.Object.wait(Object.java:503) at org.polarion.team.svn.connector.svnkit.SVNKitConnector$ProgressMonitorThread.run(SVNKitConnector.java:2469) - locked <0x0000000767dded30> (a java.util.ArrayList) Locked ownable synchronizers: - None"Timer-0" daemon prio=6 tid=0x000000001b7a1800 nid=0x2698 in Object.wait() [0x000000002196f000] java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x0000000767ddea20> (a java.util.TaskQueue) at java.util.TimerThread.mainLoop(Unknown Source) - locked <0x0000000767ddea20> (a java.util.TaskQueue) at java.util.TimerThread.run(Unknown Source) Locked ownable synchronizers: - None"Worker-8" prio=6 tid=0x0000000018cc8000 nid=0x238c in Object.wait() [0x000000002124e000] java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x000000076112e7a8> (a org.eclipse.core.internal.jobs.WorkerPool) at org.eclipse.core.internal.jobs.WorkerPool.sleep(WorkerPool.java:188) - locked <0x000000076112e7a8> (a org.eclipse.core.internal.jobs.WorkerPool) at org.eclipse.core.internal.jobs.WorkerPool.startJob(WorkerPool.java:220) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:50) Locked ownable synchronizers: - None"[ThreadPool Manager] - Idle Thread" daemon prio=6 tid=0x0000000018cc8800 nid=0x1be4 in Object.wait() [0x000000002152f000] java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x0000000763400408> (a org.eclipse.equinox.internal.util.impl.tpt.threadpool.Executor) at java.lang.Object.wait(Object.java:503) at org.eclipse.equinox.internal.util.impl.tpt.threadpool.Executor.run(Executor.java:106) - locked <0x0000000763400408> (a org.eclipse.equinox.internal.util.impl.tpt.threadpool.Executor) Locked ownable synchronizers: - None"JavaScript indexing" daemon prio=4 tid=0x0000000018cc7000 nid=0x1c74 in Object.wait() [0x000000001e67f000] java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x0000000765500000> (a org.eclipse.wst.jsdt.internal.core.search.indexing.IndexManager) at java.lang.Object.wait(Object.java:503) at org.eclipse.wst.jsdt.internal.core.search.processing.JobManager.run(JobManager.java:370) - locked <0x0000000765500000> (a org.eclipse.wst.jsdt.internal.core.search.indexing.IndexManager) at java.lang.Thread.run(Unknown Source) Locked ownable synchronizers: - None"Java indexing" daemon prio=4 tid=0x0000000018cc5800 nid=0x251c in Object.wait() [0x000000001e7fe000] java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x0000000767049648> (a org.eclipse.jdt.internal.core.search.indexing.IndexManager) at java.lang.Object.wait(Object.java:503) at org.eclipse.jdt.internal.core.search.processing.JobManager.run(JobManager.java:382) - locked <0x0000000767049648> (a org.eclipse.jdt.internal.core.search.indexing.IndexManager) at java.lang.Thread.run(Unknown Source) Locked ownable synchronizers: - None"Worker-7" prio=6 tid=0x0000000018cc5000 nid=0x2544 in Object.wait() [0x000000001dfef000] java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x00000007627a99b8> (a java.lang.Object) at java.lang.Object.wait(Object.java:503) at org.eclipse.core.internal.jobs.ThreadJob.waitForRun(ThreadJob.java:270) - locked <0x00000007627a99b8> (a java.lang.Object) at org.eclipse.core.internal.jobs.ThreadJob.joinRun(ThreadJob.java:197) at org.eclipse.core.internal.jobs.ImplicitJobs.begin(ImplicitJobs.java:92) at org.eclipse.core.internal.jobs.JobManager.beginRule(JobManager.java:286) at org.eclipse.core.internal.utils.StringPoolJob.run(StringPoolJob.java:100) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:53) Locked ownable synchronizers: - None"Worker-6" prio=6 tid=0x0000000018cc4000 nid=0x1c1c in Object.wait() [0x000000001e57e000] java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x0000000767ddea70> (a org.eclipse.ui.internal.Semaphore) at org.eclipse.ui.internal.Semaphore.acquire(Semaphore.java:43) - locked <0x0000000767ddea70> (a org.eclipse.ui.internal.Semaphore) at org.eclipse.ui.internal.UISynchronizer.syncExec(UISynchronizer.java:168) at org.eclipse.swt.widgets.Display.syncExec(Display.java:4688) at org.eclipse.team.svn.ui.utility.UIMonitorUtility.parallelSyncExec(UIMonitorUtility.java:42) at org.eclipse.team.svn.ui.crashrecovery.UpgradeWorkingCopyHelper.acquireResolution(UpgradeWorkingCopyHelper.java:35) at org.eclipse.team.svn.core.extension.crashrecovery.DefaultErrorHandlingFacility.acquireResolution(DefaultErrorHandlingFacility.java:47) at org.eclipse.team.svn.core.SVNTeamProvider.acquireResolution(SVNTeamProvider.java:213) at org.eclipse.team.svn.core.SVNTeamProvider.connectToProject(SVNTeamProvider.java:187) - locked <0x0000000768f163f0> (a org.eclipse.team.svn.core.SVNTeamProvider) at org.eclipse.team.svn.core.SVNTeamProvider.getRepositoryResource(SVNTeamProvider.java:86) - locked <0x0000000768f163f0> (a org.eclipse.team.svn.core.SVNTeamProvider) at org.eclipse.team.svn.core.svnstorage.SVNRemoteStorage.loadLocalResourcesSubTreeSVNImpl(SVNRemoteStorage.java:782) at org.eclipse.team.svn.core.svnstorage.SVNRemoteStorage.loadLocalResourcesSubTree(SVNRemoteStorage.java:660) at org.eclipse.team.svn.core.svnstorage.SVNRemoteStorage.asLocalResourceImpl(SVNRemoteStorage.java:431) - locked <0x0000000768f08610> (a org.eclipse.team.svn.core.svnstorage.SVNRemoteStorage) at org.eclipse.team.svn.core.svnstorage.SVNRemoteStorage.loadLocalResourcesSubTree(SVNRemoteStorage.java:657) at org.eclipse.team.svn.core.svnstorage.SVNRemoteStorage.asLocalResourceImpl(SVNRemoteStorage.java:431) - locked <0x0000000768f08610> (a org.eclipse.team.svn.core.svnstorage.SVNRemoteStorage) at org.eclipse.team.svn.core.svnstorage.SVNRemoteStorage.loadLocalResourcesSubTree(SVNRemoteStorage.java:657) at org.eclipse.team.svn.core.svnstorage.SVNRemoteStorage.asLocalResourceImpl(SVNRemoteStorage.java:431) - locked <0x0000000768f08610> (a org.eclipse.team.svn.core.svnstorage.SVNRemoteStorage) at org.eclipse.team.svn.core.svnstorage.SVNRemoteStorage.loadLocalResourcesSubTree(SVNRemoteStorage.java:657) at org.eclipse.team.svn.core.svnstorage.SVNRemoteStorage.asLocalResourceImpl(SVNRemoteStorage.java:431) - locked <0x0000000768f08610> (a org.eclipse.team.svn.core.svnstorage.SVNRemoteStorage) at org.eclipse.team.svn.core.svnstorage.SVNRemoteStorage.asLocalResource(SVNRemoteStorage.java:417) at org.eclipse.team.svn.core.SVNTeamMoveDeleteHook.doDelete(SVNTeamMoveDeleteHook.java:185) at org.eclipse.team.svn.core.SVNTeamMoveDeleteHook.deleteFolder(SVNTeamMoveDeleteHook.java:60) at org.eclipse.team.internal.core.MoveDeleteManager.deleteFolder(MoveDeleteManager.java:62) at org.eclipse.core.internal.resources.Resource.unprotectedDelete(Resource.java:1976) at org.eclipse.core.internal.resources.Resource.delete(Resource.java:803) at org.eclipse.jdt.internal.core.builder.BatchImageBuilder.cleanOutputFolders(BatchImageBuilder.java:114) at org.eclipse.jdt.internal.core.builder.BatchImageBuilder.build(BatchImageBuilder.java:46) at org.eclipse.jdt.internal.core.builder.JavaBuilder.buildAll(JavaBuilder.java:254) at org.eclipse.jdt.internal.core.builder.JavaBuilder.build(JavaBuilder.java:178) at org.eclipse.core.internal.events.BuildManager$2.run(BuildManager.java:733) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:206) at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:246) at org.eclipse.core.internal.events.BuildManager$1.run(BuildManager.java:299) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:302) at org.eclipse.core.internal.events.BuildManager.basicBuildLoop(BuildManager.java:358) at org.eclipse.core.internal.events.BuildManager.build(BuildManager.java:381) at org.eclipse.core.internal.events.AutoBuildJob.doBuild(AutoBuildJob.java:143) at org.eclipse.core.internal.events.AutoBuildJob.run(AutoBuildJob.java:241) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:53) Locked ownable synchronizers: - None"Worker-4" prio=6 tid=0x0000000018cc2000 nid=0x2610 in Object.wait() [0x000000001dbff000] java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x000000076112e7a8> (a org.eclipse.core.internal.jobs.WorkerPool) at org.eclipse.core.internal.jobs.WorkerPool.sleep(WorkerPool.java:188) - locked <0x000000076112e7a8> (a org.eclipse.core.internal.jobs.WorkerPool) at org.eclipse.core.internal.jobs.WorkerPool.startJob(WorkerPool.java:220) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:50) Locked ownable synchronizers: - None"Worker-3" prio=6 tid=0x0000000018cc1000 nid=0x2454 in Object.wait() [0x000000001deaf000] java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x000000076112e7a8> (a org.eclipse.core.internal.jobs.WorkerPool) at org.eclipse.core.internal.jobs.WorkerPool.sleep(WorkerPool.java:188) - locked <0x000000076112e7a8> (a org.eclipse.core.internal.jobs.WorkerPool) at org.eclipse.core.internal.jobs.WorkerPool.startJob(WorkerPool.java:220) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:50) Locked ownable synchronizers: - None"Worker-2" prio=6 tid=0x000000001a801800 nid=0x2620 waiting for monitor entry [0x000000001ca8f000] java.lang.Thread.State: BLOCKED (on object monitor) at org.eclipse.team.svn.core.svnstorage.SVNRemoteStorage.asLocalResourceImpl(SVNRemoteStorage.java:428) - waiting to lock <0x0000000768f08610> (a org.eclipse.team.svn.core.svnstorage.SVNRemoteStorage) at org.eclipse.team.svn.core.svnstorage.SVNRemoteStorage.asLocalResource(SVNRemoteStorage.java:417) at org.eclipse.team.svn.ui.decorator.SVNLightweightDecorator.decorateResource(SVNLightweightDecorator.java:221) at org.eclipse.team.svn.ui.decorator.SVNLightweightDecorator.decorate(SVNLightweightDecorator.java:194) at org.eclipse.ui.internal.decorators.LightweightDecoratorDefinition.decorate(LightweightDecoratorDefinition.java:263) at org.eclipse.ui.internal.decorators.LightweightDecoratorManager$LightweightRunnable.run(LightweightDecoratorManager.java:81) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.internal.decorators.LightweightDecoratorManager.decorate(LightweightDecoratorManager.java:365) at org.eclipse.ui.internal.decorators.LightweightDecoratorManager.getDecorations(LightweightDecoratorManager.java:347) at org.eclipse.ui.internal.decorators.DecorationScheduler$1.ensureResultCached(DecorationScheduler.java:371) at org.eclipse.ui.internal.decorators.DecorationScheduler$1.run(DecorationScheduler.java:331) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:53) Locked ownable synchronizers: - None"Worker-1" prio=6 tid=0x000000001928d000 nid=0x27cc in Object.wait() [0x000000001c20e000] java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x000000076112e7a8> (a org.eclipse.core.internal.jobs.WorkerPool) at org.eclipse.core.internal.jobs.WorkerPool.sleep(WorkerPool.java:188) - locked <0x000000076112e7a8> (a org.eclipse.core.internal.jobs.WorkerPool) at org.eclipse.core.internal.jobs.WorkerPool.startJob(WorkerPool.java:220) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:50) Locked ownable synchronizers: - None"Bundle File Closer" daemon prio=6 tid=0x000000001d509800 nid=0x189c in Object.wait() [0x000000001c82f000] java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x0000000761930370> (a org.eclipse.osgi.framework.eventmgr.EventManager$EventThread) at java.lang.Object.wait(Object.java:503) at org.eclipse.osgi.framework.eventmgr.EventManager$EventThread.getNextEvent(EventManager.java:400) - locked <0x0000000761930370> (a org.eclipse.osgi.framework.eventmgr.EventManager$EventThread) at org.eclipse.osgi.framework.eventmgr.EventManager$EventThread.run(EventManager.java:336) Locked ownable synchronizers: - None"Worker-0" prio=6 tid=0x0000000018bc1000 nid=0x2264 in Object.wait() [0x000000001c63f000] java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x000000076112e7a8> (a org.eclipse.core.internal.jobs.WorkerPool) at org.eclipse.core.internal.jobs.WorkerPool.sleep(WorkerPool.java:188) - locked <0x000000076112e7a8> (a org.eclipse.core.internal.jobs.WorkerPool) at org.eclipse.core.internal.jobs.WorkerPool.startJob(WorkerPool.java:220) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:50) Locked ownable synchronizers: - None"EMF Reference Cleaner" daemon prio=6 tid=0x000000001a262800 nid=0x5ac in Object.wait() [0x000000001c06f000] java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x0000000762758e68> (a java.lang.ref.ReferenceQueue$Lock) at java.lang.ref.ReferenceQueue.remove(Unknown Source) - locked <0x0000000762758e68> (a java.lang.ref.ReferenceQueue$Lock) at java.lang.ref.ReferenceQueue.remove(Unknown Source) at org.eclipse.emf.common.util.CommonUtil$1ReferenceClearingQueuePollingThread.run(CommonUtil.java:70) Locked ownable synchronizers: - None"Worker-JM" prio=6 tid=0x0000000019453800 nid=0x2500 in Object.wait() [0x000000001ad9f000] java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x0000000762180010> (a java.util.ArrayList) at org.eclipse.core.internal.jobs.InternalWorker.run(InternalWorker.java:58) - locked <0x0000000762180010> (a java.util.ArrayList) Locked ownable synchronizers: - None"[Timer] - Main Queue Handler" daemon prio=6 tid=0x0000000019c4e000 nid=0x1130 in Object.wait() [0x000000001aedf000] java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x0000000762180000> (a java.lang.Object) at org.eclipse.equinox.internal.util.impl.tpt.timer.TimerImpl.run(TimerImpl.java:141) - locked <0x0000000762180000> (a java.lang.Object) at java.lang.Thread.run(Unknown Source) Locked ownable synchronizers: - None"Framework Event Dispatcher" daemon prio=6 tid=0x0000000016ccb800 nid=0x2040 in Object.wait() [0x000000001aadf000] java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x0000000762180028> (a org.eclipse.osgi.framework.eventmgr.EventManager$EventThread) at java.lang.Object.wait(Object.java:503) at org.eclipse.osgi.framework.eventmgr.EventManager$EventThread.getNextEvent(EventManager.java:400) - locked <0x0000000762180028> (a org.eclipse.osgi.framework.eventmgr.EventManager$EventThread) at org.eclipse.osgi.framework.eventmgr.EventManager$EventThread.run(EventManager.java:336) Locked ownable synchronizers: - None"Start Level Event Dispatcher" daemon prio=6 tid=0x0000000018712000 nid=0x25a4 in Object.wait() [0x000000001996f000] java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x0000000761eaf0f8> (a org.eclipse.osgi.framework.eventmgr.EventManager$EventThread) at java.lang.Object.wait(Object.java:503) at org.eclipse.osgi.framework.eventmgr.EventManager$EventThread.getNextEvent(EventManager.java:400) - locked <0x0000000761eaf0f8> (a org.eclipse.osgi.framework.eventmgr.EventManager$EventThread) at org.eclipse.osgi.framework.eventmgr.EventManager$EventThread.run(EventManager.java:336) Locked ownable synchronizers: - None"State Data Manager" daemon prio=6 tid=0x0000000016aa8000 nid=0x26c0 waiting on condition [0x000000001983f000] java.lang.Thread.State: TIMED_WAITING (sleeping) at java.lang.Thread.sleep(Native Method) at org.eclipse.osgi.internal.baseadaptor.StateManager.run(StateManager.java:297) at java.lang.Thread.run(Unknown Source) Locked ownable synchronizers: - None"Framework Active Thread" prio=6 tid=0x000000001689a800 nid=0x24d8 in Object.wait() [0x00000000183bf000] java.lang.Thread.State: TIMED_WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x0000000761e79358> (a org.eclipse.osgi.framework.internal.core.Framework) at org.eclipse.osgi.framework.internal.core.Framework.run(Framework.java:1862) - locked <0x0000000761e79358> (a org.eclipse.osgi.framework.internal.core.Framework) at java.lang.Thread.run(Unknown Source) Locked ownable synchronizers: - None"Service Thread" daemon prio=6 tid=0x000000001666f000 nid=0x10b4 runnable [0x0000000000000000] java.lang.Thread.State: RUNNABLE Locked ownable synchronizers: - None"C2 CompilerThread1" daemon prio=10 tid=0x000000001665b800 nid=0x25f8 waiting on condition [0x0000000000000000] java.lang.Thread.State: RUNNABLE Locked ownable synchronizers: - None"C2 CompilerThread0" daemon prio=10 tid=0x0000000016656000 nid=0x2288 waiting on condition [0x0000000000000000] java.lang.Thread.State: RUNNABLE Locked ownable synchronizers: - None"Attach Listener" daemon prio=10 tid=0x0000000016653000 nid=0x231c waiting on condition [0x0000000000000000] java.lang.Thread.State: RUNNABLE Locked ownable synchronizers: - None"Signal Dispatcher" daemon prio=10 tid=0x0000000016652000 nid=0x2420 runnable [0x0000000000000000] java.lang.Thread.State: RUNNABLE Locked ownable synchronizers: - None"Surrogate Locker Thread (Concurrent GC)" daemon prio=6 tid=0x000000001664d800 nid=0x222c waiting on condition [0x0000000000000000] java.lang.Thread.State: RUNNABLE Locked ownable synchronizers: - None"Finalizer" daemon prio=8 tid=0x0000000016644800 nid=0x22b4 in Object.wait() [0x000000001731f000] java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x0000000761e79330> (a java.lang.ref.ReferenceQueue$Lock) at java.lang.ref.ReferenceQueue.remove(Unknown Source) - locked <0x0000000761e79330> (a java.lang.ref.ReferenceQueue$Lock) at java.lang.ref.ReferenceQueue.remove(Unknown Source) at java.lang.ref.Finalizer$FinalizerThread.run(Unknown Source) Locked ownable synchronizers: - None"Reference Handler" daemon prio=10 tid=0x000000001663e000 nid=0x2550 in Object.wait() [0x00000000170df000] java.lang.Thread.State: WAITING (on object monitor) at java.lang.Object.wait(Native Method) - waiting on <0x0000000761e79320> (a java.lang.ref.Reference$Lock) at java.lang.Object.wait(Object.java:503) at java.lang.ref.Reference$ReferenceHandler.run(Unknown Source) - locked <0x0000000761e79320> (a java.lang.ref.Reference$Lock) Locked ownable synchronizers: - None"main" prio=6 tid=0x00000000021bf000 nid=0x21bc runnable [0x00000000024ab000] java.lang.Thread.State: RUNNABLE at org.eclipse.swt.internal.win32.OS.WaitMessage(Native Method) at org.eclipse.swt.widgets.Display.sleep(Display.java:4657) at org.eclipse.jface.operation.ModalContext$ModalContextThread.block(ModalContext.java:174) at org.eclipse.jface.operation.ModalContext.run(ModalContext.java:388) at org.eclipse.jface.dialogs.ProgressMonitorDialog.run(ProgressMonitorDialog.java:507) at org.eclipse.team.svn.ui.utility.UIMonitorUtility.doTaskNow(UIMonitorUtility.java:162) at org.eclipse.team.svn.ui.utility.UIMonitorUtility.doTaskNowWorkspaceModify(UIMonitorUtility.java:148) at org.eclipse.team.svn.ui.crashrecovery.UpgradeWorkingCopyHelper$1.run(UpgradeWorkingCopyHelper.java:40) at org.eclipse.ui.internal.UILockListener.doPendingWork(UILockListener.java:164) at org.eclipse.ui.internal.UISynchronizer$3.run(UISynchronizer.java:158) at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35) at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135) - locked <0x0000000767df0b38> (a org.eclipse.swt.widgets.RunnableLock) at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4145) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3762) at org.eclipse.jface.window.Window.runEventLoop(Window.java:826) at org.eclipse.jface.window.Window.open(Window.java:802) at org.eclipse.jdt.internal.ui.dialogs.FilteredTypesSelectionDialog.open(FilteredTypesSelectionDialog.java:512) at org.eclipse.jdt.internal.ui.actions.OpenTypeAction.runWithEvent(OpenTypeAction.java:80) at org.eclipse.jdt.internal.ui.actions.OpenTypeAction.runWithEvent(OpenTypeAction.java:162) at org.eclipse.ui.internal.handlers.ActionDelegateHandlerProxy.execute(ActionDelegateHandlerProxy.java:287) at org.eclipse.ui.internal.handlers.E4HandlerProxy.execute(E4HandlerProxy.java:90) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at org.eclipse.e4.core.internal.di.MethodRequestor.execute(MethodRequestor.java:56) at org.eclipse.e4.core.internal.di.InjectorImpl.invokeUsingClass(InjectorImpl.java:243) at org.eclipse.e4.core.internal.di.InjectorImpl.invoke(InjectorImpl.java:224) at org.eclipse.e4.core.contexts.ContextInjectionFactory.invoke(ContextInjectionFactory.java:132) at org.eclipse.e4.core.commands.internal.HandlerServiceHandler.execute(HandlerServiceHandler.java:167) at org.eclipse.core.commands.Command.executeWithChecks(Command.java:499) at org.eclipse.core.commands.ParameterizedCommand.executeWithChecks(ParameterizedCommand.java:508) at org.eclipse.e4.core.commands.internal.HandlerServiceImpl.executeHandler(HandlerServiceImpl.java:213) at org.eclipse.e4.ui.bindings.keys.KeyBindingDispatcher.executeCommand(KeyBindingDispatcher.java:285) at org.eclipse.e4.ui.bindings.keys.KeyBindingDispatcher.press(KeyBindingDispatcher.java:504) at org.eclipse.e4.ui.bindings.keys.KeyBindingDispatcher.processKeyEvent(KeyBindingDispatcher.java:555) at org.eclipse.e4.ui.bindings.keys.KeyBindingDispatcher.filterKeySequenceBindings(KeyBindingDispatcher.java:376) at org.eclipse.e4.ui.bindings.keys.KeyBindingDispatcher.access$0(KeyBindingDispatcher.java:322) at org.eclipse.e4.ui.bindings.keys.KeyBindingDispatcher$KeyDownFilter.handleEvent(KeyBindingDispatcher.java:84) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Display.filterEvent(Display.java:1262) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1056) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1081) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1066) at org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:1108) at org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:1104) at org.eclipse.swt.widgets.Widget.wmChar(Widget.java:1525) at org.eclipse.swt.widgets.Control.WM_CHAR(Control.java:4723) at org.eclipse.swt.widgets.Tree.WM_CHAR(Tree.java:6009) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4611) at org.eclipse.swt.widgets.Tree.windowProc(Tree.java:6005) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4977) at org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method) at org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:2549) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3757) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1113) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:997) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:140) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:611) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:567) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:354) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:181) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:636) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:591) at org.eclipse.equinox.launcher.Main.run(Main.java:1450) at org.eclipse.equinox.launcher.Main.main(Main.java:1426) Locked ownable synchronizers: - None"VM Thread" prio=10 tid=0x000000001663b000 nid=0x67c runnable "Gang worker#0 (Parallel GC Threads)" prio=10 tid=0x00000000020cf000 nid=0x1bc0 runnable "Gang worker#1 (Parallel GC Threads)" prio=10 tid=0x00000000020d0800 nid=0x224c runnable "Gang worker#2 (Parallel GC Threads)" prio=10 tid=0x00000000020d2800 nid=0x6e4 runnable "Gang worker#3 (Parallel GC Threads)" prio=10 tid=0x00000000020d4000 nid=0x1da0 runnable "Gang worker#4 (Parallel GC Threads)" prio=10 tid=0x00000000020d7800 nid=0x26c4 runnable "Gang worker#5 (Parallel GC Threads)" prio=10 tid=0x00000000020dc800 nid=0x25ac runnable "Gang worker#6 (Parallel GC Threads)" prio=10 tid=0x00000000020de000 nid=0x2304 runnable "Gang worker#7 (Parallel GC Threads)" prio=10 tid=0x00000000020df000 nid=0x2474 runnable "G1 Main Concurrent Mark GC Thread" prio=10 tid=0x00000000020fc000 nid=0x2710 runnable "Gang worker#0 (G1 Parallel Marking Threads)" prio=10 tid=0x0000000002103800 nid=0x26f8 runnable "Gang worker#1 (G1 Parallel Marking Threads)" prio=10 tid=0x0000000015cd6800 nid=0x275c runnable "G1 Concurrent Refinement Thread#0" prio=10 tid=0x00000000020f3800 nid=0xf8c runnable "G1 Concurrent Refinement Thread#1" prio=10 tid=0x00000000020ed800 nid=0x21b4 runnable "G1 Concurrent Refinement Thread#2" prio=10 tid=0x00000000020ed000 nid=0x21c8 runnable "G1 Concurrent Refinement Thread#3" prio=10 tid=0x00000000020ea000 nid=0x25c4 runnable "G1 Concurrent Refinement Thread#4" prio=10 tid=0x00000000020e9800 nid=0x1df4 runnable "G1 Concurrent Refinement Thread#5" prio=10 tid=0x00000000020e9000 nid=0x1478 runnable "G1 Concurrent Refinement Thread#6" prio=10 tid=0x00000000020e8000 nid=0x264c runnable "G1 Concurrent Refinement Thread#7" prio=10 tid=0x00000000020e7000 nid=0x248c runnable "G1 Concurrent Refinement Thread#8" prio=10 tid=0x00000000020e4000 nid=0x2540 runnable "VM Periodic Task Thread" prio=10 tid=0x0000000016671800 nid=0x215c waiting on condition JNI global references: 629Anyone, facing this problem with latest Eclipse 4.4 or 4.3.2 ?If so, please provide steps/code snippet to reproduce it.Thanks!	21.0
id=393379	REOPENED	Platform	SWT	4.2.1	PC Linux	P3 normal	Platform-SWT-Inbox	2012-11-01 17:10 EDT by	Alexander Karatarakis	2013-12-20 10:35 EST (	12 users	System details:Ubuntu 12.10 64-bitopenjdk-7 (7u9-2.3.3-0ubuntu1~12.10.1)Eclipse 4.2 SR1 [Version: Juno Service Release 1 Build id: 20120920-0800]Steps to reproduce:1) Start any project 2) Do some basic operation from git (from inside eclipse). This may be changing a file and commiting, changing a file and restoring it ("Replace with file in git index" etc.3) From this moment, if eclipse loses focus it will "crash". I put this in quotation marks because there is no hs_err_pid*log, the window just disappears.Things I have tried:- Using a freshly downloaded version of Eclipse 4.2 SR1- Using a previous version (4.2)- Using a new workspace- Starting eclipse from the console, but there were no errors when the crash occurredThe bug started occurring for me after I installed Ubuntu 12.10 (clean install). I was using Eclipse 4.2 SR1 with openjdk-7 in Ubuntu 12.04 without a problem, but the same configuration causes a problem in 12.10. It is possible that there is something borked in 12.10. I will probably downgrade to verify. Since there were no error logs I have not been able to provide something more concrete for the bug resolution. If there is some other log I can look that pinpoints the problem please let me know.	(In reply to)Please try this:1. get the latest Kepler build (this is our 4.3 M3 candidate)2. start the workbench and install the latest EGit viaHelp > Install New Software...use this update site:Tested and it keeps happening. I am able to consistently reproduce this when changing branches after a commit. This time, after I restart eclipse after a branch change, all files changed due to the branch change are marked on the Unstaged Changes list and there are project errors all over the place. I cannot refresh or Project->Clean them and the only way to restore is to change branches and back again [it seems that without having made a commit first it does not crash].Furthermore, I tried downgrading to Ubuntu 12.04 and the bug was NOT present [Tested on 4.2 SR1]. I am back at 12.10 with a fresh install and the bug is back again.Correction: It does not seem to crash if i do not make a commit or some other change before changing branches. And sometimes it seems that some change might cause this without even changing branches, but I have not been able to pinpoint which changes yet.Reading the whole bug again and seeing other bugs pass by, I pretty sure you're seeing.^Perhaps, but its not very clear.I have some more info though:- When using console git instead of Egit, eclipse does not crash.- When using Ubuntu 12.04 eclipse does not crash, but with 12.10 it does. This is both with the Unity DE.- When using Ubuntu 12.10 with LXDE instead of Unity it does not crash either. Seems pretty weird..(In reply to)I suspect that the point when it crashes, is when it tries to display something in the internal browser (widget).Is there some way to turn it off to check?Under General-> Web browser I have "Use external browser" selected. The Internal browser radio button is shaded, so I can't select it. Is this relevant, or are you referring to something else?(In reply to)No, but you could install the correct browser as mentioned in.^That was it! :)sudo apt-get install libwebkitgtk-1.0-0fixes the problem! So its. Thank you very much :). [Marking as duplicate, hope its the correct action]*** This bug has been marked as a duplicate of***The workaround did not work after all :(, the bug is still present. It seemed alright at first, but then it re-appeared.I tried with the packages in, both the ones in the default repos and the ones mentioned inbut the bug persists. I also tried the latest Kepler build but no luck.(In reply to)OK, in that case please try to provide more details, e.g. exact steps, so that we can try to reproduce it or give you hints on how to debug it further.In the simplest form:1) Open a project which is under git.2) Make changes on branch a and commit them from inside eclipse (EGit).3) Switch to branch b.At this point, eclipse will crash when its window loses focus. No crash if you do not switch to another window. No error messages when starting eclipse from console, no hs_err_pid*log to give a pointer about where the problem lies.(In reply to)I can't reproduce this. I assume you do use a 64-bit JRE?CreatedError logYes. I have openjdk-7 (7u9-2.3.3-0ubuntu1~12.10.1)[/usr/lib/jvm/java-7-openjdk-amd64]But I think I may have found a useful log, which I attach. What I found interesting from inspecting the log is at line 1616 and after. There are a lot of FileNotFoundExceptions like this one:org.eclipse.core.runtime.CoreException: File not found: /media/640GB/Code/EclipseWorkspace/Solverize/Solverize/src/com/solverize/meshless/entities/GaussPointEFG.java.All files mentioned in such FileNotFoundExceptions exist on branch A but not on branch B. Can it be that when changing branches from A to B and the files disappear that something can't handle this correctly causing the crash?There are a lot of errors in that .log. This looks like something is wrong with your install and/or workspace. I suggest you download the latest build towards 4.2.2:and start with a new workspace.If the crash happens again, check the .log, so that we know the entries are related to the crash.Ok, used the version you mentioned (the link has "granite" in it, but I swapped it for "download") in a new workspace. I attach the log before the crash and right after the crash.CreatedBefore the crashCreatedAfter the crashwhen the JVM crashes you normally get an core dump next to the eclipse.exe. Is there one?There isn't :/CreatedError log 2Another crash just happened. The error log contains something that looks more useful that the previous one.(In reply to)There were some problems with the Eclipse.org infrastructure when I copied the link from their website.(In reply to)This isand happens on shutdown.Without the crash log we can't do much. Since you can reproduce it quite often, the best chances are if you remote debug your IDE and step through the code which causes the crash.Ok, I will look into it.(In reply to)In case yo don't know how to do it see:Sorry for the delay, I have not abandoned the bug, but I had to meet some deadlines and installed Ubuntu 12.04 which doesn't have the bug. I will get back to 12.10 as soon as possible.I tried remote debugging like this:1) Add these to eclipse.ini-Xdebug-Xrunjdwp:transport=dt_socket,address=1044,server=y,suspend=n2) From the console,jdb -attach 1044Output was:Set uncaught java.lang.ThrowableSet deferred uncaught java.lang.ThrowableInitializing jdb ...Then, I made eclipse crash. Output was only:The application has been disconnectedI figured a way that crashes eclipse 100% of the time:1) Have a project with branchA and branchB. Have File1 in branchA but not branchB.2) Checkout branchA and make a change in File1. 3) In Git Staging of Git Repository exploring, right click File1 and choose Replace with File in git index. 4) Checkout branchB5) Open the home folder OR switch workspace OR generally do anything that changes the active window to something other than eclipse. Eclipse now crashes.[I repeat that this only applies to Ubuntu 12.10 with jdk 7. Ubuntu 12.04 with jdk 7 works fine]Also tried with latest eclipse nightly (eclipse-SDK-N20130103-2000-linux-gtk-x86_64) and latest EGit fromand got the same results.i meet the same thing, just after install a pure 12.10 with a APT installed eclipse.(In reply to)This indicates an SWT problem. Moving to SWT hoping they have Ubuntu 12.10 and can reproduce with above steps.Also occurs in Ubuntu 13.04.CreatedLog when reproducing the crashFound a simpler way to reproduce the crash:1) Have a project with branchA and branchB. Have File1 in branchA but not branchB.2) Checkout branchA and open File1 in eclipse as you normally would if you wanted to make an edit. No need to do anything, just open it. 4) Checkout branchB.5) Open the home folder OR switch workspace OR generally do anything that changes the active window to something other than eclipse. Eclipse now crashes.So it seems that just having a file open that does not exist in the branch you are changing to causes the crash. The previous reproduction required a random change in said file. I cleared the .log file and caused the crash. I attach the errors shown in the .log after the crash. Note that the file EFGSearcher.java mentioned in the log is the one that exists in branchA but not in branchB as in the example. [This is with Ubuntu 13.04 64-bit and Eclipse 4.3 M7 with openjdk-7]Just to clarify, if you only have files open that also exist in the target branch, then the crash does not occur. You need one that does not exist in the target branch.I'm experience the same bug with Ubuntu 13.04, Juno 4.2.2 + JDT + Egit.In apport log I've got this :ERROR: apport (pid 6180) Fri Jun 7 11:16:10 2013: called for pid 5983, signal 11, core limit 0ERROR: apport (pid 6180) Fri Jun 7 11:16:10 2013: executable: /usr/lib/jvm/java-7-openjdk-amd64/jre/bin/java (command line "/usr/bin/java -Xms40m -Xmx1512m -XX:MaxPermSize=1512m -jar /opt/eclipse//plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar -os linux -ws gtk -arch x86_64 -showsplash /opt/eclipse//plugins/org.eclipse.platform_4.2.2.v201302041200/splash.bmp -launcher /opt/eclipse/eclipse -name Eclipse --launcher.library /opt/eclipse//plugins/org.eclipse.equinox.launcher.gtk.linux.x86_64_1.1.200.v20120913-144807/eclipse_1502.so -startup /opt/eclipse//plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar --launcher.overrideVmargs -exitdata ee800d -vm /usr/bin/java -vmargs -Xms40m -Xmx1512m -XX:MaxPermSize=1512m -jar /opt/eclipse//plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar")ERROR: apport (pid 6180) Fri Jun 7 11:16:10 2013: debug: session gdbus call: (true,)ERROR: apport (pid 6180) Fri Jun 7 11:18:38 2013: wrote report /var/crash/_usr_lib_jvm_java-7-openjdk-amd64_jre_bin_java.1000.crash I will attache the 231 Mo log file.CreatedCleip crash PIDCreatedAnother eclipse crash(In reply to)This matches, you should CC yourself there to be notified of its progress.I'm not going to mark this as a duplicate ofuntil it's confirmed to be the same issue. Will follow up here soon.Still an issue on the release Eclipse 4.3(Version: Kepler ReleaseBuild id: 20130614-0229)I'm having the same issue running Kepler and Ubuntu 13.04.Yes, same here. Tested with Eclipse Kepler & Juno on x86_64 on Ubuntu 13.04 and this crash happens all of the time. I don't have to change branches, only commiting a file on git and then switching to another window using the unity launcher causes to silently crash.Still an issue with Ubuntu 13.10 and eclipse 4.3.1.Version: Kepler Service Release 1Build id: 20130919-0819***has been marked as a duplicate of this bug. ***	42.0
id=394348	REOPENED	Platform	SWT	4.3	PC Windows 7	P3 major	Platform-SWT-Inbox	2012-11-14 19:01 EST by	Sopot Cela	2015-06-09 10:26 EDT (	10 users	I20121031-2000 (M3) + egit + e4 toolsWhile debuggingthe debugger went into a file, the code of which was not in my workspace and loaded from Eclipse inner sources (InjectorImpl class). I will attacha screenshot. Problem is whenever I click inside this editor to activate it I get the error box with Unhandled event loopNo more handles error message. I click ok, get what you see in the screenshot, click around other parts but when I click back to that .class file's contents I get the same behavior with the prompt to close. If I do and start again and click the .class file it pops up again, rendering Eclipse unusable. I have this bug "caught" in a cage and can reproduce it at will. Attached also the log.	CreatedscreenshotThe dialog prompts me to close eclipse after clicking in the .class file in the background and also after giving me the No more handles error.CreatedError logCould you try installing sleak and taking some snapshots as you go? Sleak (+launching your outer in debug mode) will allow you to record where SWT resources are being allocated, great for finding leaks.PWDamn while at work windows (home laptop) restarted itself after update. Can't reproduce anymore. Sorry.I'll keep an eye on it and if can't reproduce it for a long time will close it as invalid.Reproduced it again. This is exclusively linked when opening .class files for inspection. Once it comes up, only PC restart fixes it. I installed Sleak, open its view but when I click Snap I get a " Device is not tracking resource allocation" warning. Any hint ?There should be instructions on the page where you got the tool, but you need to start with a -debug flag and some optionsPWYou also find instructions here:Unfortunately I'm not able to get that sleak working. I've updated my ini and the .options file but to no avail.I'm updating to say that I constantly see it with other editors also (not just .class but with this it occurs more often).I've found that activating other random parts before activating the editor sometimes makes the error go away.@Sopot AFAIK ini changes are not required. Can you post your .options file? Did you start Eclipse from the command line with the -debug option?Another approach would be to try to provide steps starting off a new workspace, so that we can also reproduce it.(In reply to)I added the -debug in the .ini file. I suppose it is the same as specifying it to the command line. Anyway no I didn't try from command line.Will post more details when I get home.(In reply to)I've switched workspaces multiple times and there is no common procedure in the reproducing steps. You start working normally and it just pops up when you click a part in the *editor area*. After that you're stuck.Win 7 Home edition, Hotspot JVM 7, Eclipse M3 all 64 bit architecture.I think if you start if from the command line with -debug you have a higher chance that it will work. :-)Yes the -debug run from the command line made it work. I was being unnecessarily creative...I got Sleak to work. I've not found any leak while opening/closing that specific editor which opens the error dialog. What I found drag and dropping around is that there is the Region class which the dnd addon leaks heavily. I noticed bluntly that every time a suggesting green border (the drag and drop hint) appears there is an object leak. The number you see hereis the result of ~1 minute drag and dropping around.I'm not sure if this dnd thing relates but I have never used sleak before and I don't know how to dig deeper. The fact is that now I can reproduce it right away when my eclipse starts if I want to (focus the sleak view and then any *.class editor part makes the error pop) so I'm not sure how to measure when this massive leak which makes the system run out of handles occurs this early.If I check the Stack check box I see for each and all elements in the list an error like this (this one is for images):java.lang.Error at org.eclipse.swt.graphics.Device.new_Object(Device.java:859) at org.eclipse.swt.graphics.Resource.init(Resource.java:86) at org.eclipse.swt.graphics.Image.<init>(Image.java:581) at org.eclipse.jface.resource.URLImageDescriptor.createImage(URLImageDescriptor.java:162) at org.eclipse.jface.resource.ImageDescriptor.createImage(ImageDescriptor.java:227) at org.eclipse.jface.resource.ImageDescriptor.createImage(ImageDescriptor.java:205) at org.eclipse.ui.internal.Workbench.initializeImages(Workbench.java:1577) at org.eclipse.ui.internal.Workbench.createDisplay(Workbench.java:679) at org.eclipse.ui.PlatformUI.createDisplay(PlatformUI.java:161) at org.eclipse.ui.internal.ide.application.IDEApplication.createDisplay(IDEApplication.java:154) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:96) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:353) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:180) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:629) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:584) at org.eclipse.equinox.launcher.Main.run(Main.java:1438) at org.eclipse.equinox.launcher.Main.main(Main.java:1414)Anything else I can do to bring more details?Sopot, could you add the stacktrace for one or two of the regions you say were created?How I use sleak:1) get the system into a stable state, and then Snap2) perform your action that should get the system into the next state, and then do a diff.The problem is it will show all resources allocated since the snap. So opening a new editor can show a bunch of resources.Eric, I looked at the region code in org.eclipse.e4.ui.workbench.addons.dndaddon.SplitFeedbackOverlay ... if it exists, I see it disposed before a new one is added. But in the overlay dispose, it only disposes the Shell ... since the Region wasn't created with a parent, are you sure disposing the shell will dispose it as well?PWjava.lang.Error at org.eclipse.swt.graphics.Device.new_Object(Device.java:859) at org.eclipse.swt.graphics.Resource.init(Resource.java:86) at org.eclipse.swt.graphics.Region.<init>(Region.java:81) at org.eclipse.swt.graphics.Region.<init>(Region.java:55) at org.eclipse.e4.ui.workbench.addons.dndaddon.SplitFeedbackOverlay.defineRegion(SplitFeedbackOverlay.java:88) at org.eclipse.e4.ui.workbench.addons.dndaddon.SplitFeedbackOverlay.<init>(SplitFeedbackOverlay.java:41) at org.eclipse.e4.ui.workbench.addons.dndaddon.SplitDropAgent.showFeedback(SplitDropAgent.java:284) at org.eclipse.e4.ui.workbench.addons.dndaddon.SplitDropAgent.track(SplitDropAgent.java:207) at org.eclipse.e4.ui.workbench.addons.dndaddon.DragAgent.track(DragAgent.java:112) at org.eclipse.e4.ui.workbench.addons.dndaddon.DnDManager$4.run(DnDManager.java:185) at org.eclipse.swt.widgets.Synchronizer.syncExec(Synchronizer.java:180) at org.eclipse.ui.internal.UISynchronizer.syncExec(UISynchronizer.java:150) at org.eclipse.swt.widgets.Display.syncExec(Display.java:4687) at org.eclipse.e4.ui.workbench.addons.dndaddon.DnDManager.track(DnDManager.java:182) at org.eclipse.e4.ui.workbench.addons.dndaddon.DnDManager.access$1(DnDManager.java:181) at org.eclipse.e4.ui.workbench.addons.dndaddon.DnDManager$6.handleEvent(DnDManager.java:217) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1077) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1062) at org.eclipse.swt.widgets.Tracker.wmMouse(Tracker.java:1173) at org.eclipse.swt.widgets.Tracker.open(Tracker.java:585) at org.eclipse.e4.ui.workbench.addons.dndaddon.DnDManager.startDrag(DnDManager.java:229) at org.eclipse.e4.ui.workbench.addons.dndaddon.DnDManager$1.dragDetected(DnDManager.java:87) at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:127) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053) at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4169) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3758) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1023) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:917) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:86) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:587) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:542) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:353) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:180) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:629) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:584) at org.eclipse.equinox.launcher.Main.run(Main.java:1438) at org.eclipse.equinox.launcher.Main.main(Main.java:1414)Oh you meant debug-breakpoint stacktrace?(In reply to)at org.eclipse.e4.ui.workbench.addons.dndaddon.SplitFeedbackOverlay.SplitFeedbackOverlay.dispose() does not dispose the last Region - filedto track that. However, I don't think this is the source for the "no more handles" problem, as this leak only happens when you drag and drop parts.FYI it just popped out on another machine with clear workspace.What I did:1. download m3.2. Install e4 tools3. Install egit4. Clone e4 tools repo5. Import e4 tools repo projects6. Create sample app7. Open e4xmi of sample app8. Click on editor part-errorWill try to bring more sleak details tonight. Machine specs are the same as those above.I'm pretty sure that Paul's nailed this one...I'll check with Bogdan but it's likely that my presumption that the current Region is disposed may be false...It appears that Dani was ahead of me (...again...;-).See: SplitFeedbackOverlay leaks RegionSo I suspect that this has been addressed...Sopot, could you check using the latest code ?(In reply to)See.Sopot, can you still reproduce this with I20121211-2000?I'll give it a shot tonight.Couldn't reproduce with a short try. I'll keep watching though and will invalidate the bug if I don't see it.Defered to 4.3Haven't reproduced it with the latest builds.Thanks Sopot !Sorry but it happened again on I20130516-2200. It always happens when I'm exploring a .class file's source code. Same machine specs as before.Sopot, I'll have to tag this for the service release since it's too late to get a fix in Kepler's GA.Do you have steps I can use to reproduce this ? Is it just a matter of having a few .class files open or is there more to it ?Createdscreenshot(In reply to)No having one open is enough. How I reproduce it (do it in a SDK with no platform sources on the workspace):CTRL+SHIFT+T - type a type name which will open as a .class file, say MUIElement (you have to have 'Include all plug-ins from target in Java search' enabled in the 'Plug-in development' preferences).After it opens click on the console view to focus it. Click back on the java editor containing MUIElement and it happens. I'm open for a shared screen session if anyone can get more info on this.(In reply to)This does not trigger the error for me on 4.3 RC2.I've just stumbled into this using eclipse-SDK-4.4M1-win32. This is a nasty bug, it causes the UI to stop updating, prevents graceful shutdown, can close workbench windows with or without a chance to save and leave workbench state corrupted. To reproduce, do these steps in a new workspace:1. Download file "Mieliestronk's English list -- all lower case" fromto some folder.2. Close Welcome screen.3. Create a new project with Right-click->New->Project...->General ->Project.4. Drag the downloaded file corncob_lowercase.txt onto the new project and select Copy files.5. Right-click on the file in the Package Explorer view and select properties.6. Under text file encoding, change from Default Cp1252 to Other and choose UTF-16LE, then click OK.7. Inside the project, double-click the file to open it.Eclipse stops responding for a brief moment, then is left in a corrupted state from multiple internal errors. Step 7 can be performed between steps 4 and 5, then the bug is triggered at the end of step 6. If the open view has been saved to workbench state then the failure persists over restarting the Eclipse process.(In reply to Timo Kinnunen from)Thanks Timo! I can easily reproduce this using 4.4 M1. Looks like SWT allocates lots of handles when trying to render that file.1. in the SWT TextEditor example modify #openFile to use "UTF-16LE"2. start the sample3. open the file from==> you might get lucky and it opens after a while4. try open another file==> locks upHi Niraj, can you please try this?Created45K characters in single line when opened as "UTF-16LE" encoding(In reply to Timo Kinnunen from)The mentioned sample file() when opened in any of the UTF-16/UTF-16BE/UTF-16LE encoding opens up as a single line file with character count reaching 3 lac.Note:- When I try reducing the size of this file to be roughly 45K characters in single line in UTF-16, refer attachment (), it seems to be running fine.Refer comments w.r.t. to Long lines in StyledText:-The file contents becoming one single line sounds like a separate bug. I originally encountered this or these issues by opening the conrncob_lowercase.txt normally in workspace with default UTF-8 encoding and then trying to convert its encoding to UTF-16LE from its properties. So the file was already correctly open when something went wrong and the new encoding setting was not applied right. Improvements to this should get a separate bug, because:The main issue in my mind is the exhaustion of available handles, which causes serious subsequent errors including loss of data and leaving workspace in a corrupted state. Running out of handles shouldn't happen, ever. There's even some minor disruption to the OS. (For major disruption; see)CreatedTesting if long lines use up too many of available handlesNotepad has a line length limit of 1025 but Wordpad allows at least 52k characters long lines.generated the ASCII text which I then duplicated 8 times. The resulting plain text file from the screenshot was 1,322,973 bytes. Opening this file in Eclipse works, manually editing all the lines together works too without running out of handles. The final line was 1,322,895 characters long but the editor didn't always show some ranges of characters, often at the end.CreatedClean crash with no more handles on Windows 8.1I've investigated this crash a bit more and I think there is 2 different "No more handles" failure modes that are triggered depending on Windows version. The first failure mode, detailed with test application inno longer runs out of handles on Windows 8. TextViewer still consumes large amount of memory when text is in a single line but -Xmx512m makes the test application open and display a 10MB single line file without errors.As a sanity check, right after that I copied the corncob-text file into the workbench, opened it, and switched its encoding from Cp1252 to UTF-16LE. The log of the surprisingly clean crash that followed is in the attachment. Some things I think notable from the log:The first Error thrown - also confirmed with Java mission Control - is SWTError: No more handles from at org.eclipse.swt.graphics.GC.drawBitmapAlpha(GC.java:1222) at org.eclipse.swt.graphics.GC.drawBitmap(GC.java:1180) at org.eclipse.swt.graphics.GC.drawImage(GC.java:1005) at org.eclipse.swt.graphics.GC.drawImage(GC.java:943) at org.eclipse.e4.ui.workbench.renderers.swt.CTabRendering.drawShadow(CTabRendering.java:728)After that, there's 33 more "No more handles" errors before a workbench emergency shutdown has completed. All 33 have a method named internal_new_GC() in common but not from the same class.24 are from org.eclipse.swt.widgets.Control.internal_new_GC(), during executing Composite.WM_PAINT(). They have 3 slightly differing stacktraces.9 are from org.eclipse.swt.widgets.Display.internal_new_GC(), called from the Display.getIconDepth() API method, whose result could be easily cached. They involve the classes WorkbenchAdvisor and WorkbenchErrorHandler which are trying to handle previous errors, unfortunately by trying to display a new dialog shell.Overall this seems like a different failure mode than what's described inor the class org.eclipse.ui.tests.api.workbenchpart.HeavyResourceView. Unlike that last example which claims to be slow and I don't think occurs in like that in Windows 8 at all, this happens very fast with most of the errors being thrown under 0,3 seconds.(In reply to Timo Kinnunen from)Since original file was in UTF-8 format and when we change that to UTF-16LE, so it seems UTF-16LE doesn't interpret 'new line' characters of UTF-8 encoding, hence draw them in single line.(In reply to Sopot Cela from)Possibility of any memory leak is also not seen here.(In reply to Timo Kinnunen from)Something similar happens with Eclipse too, was able to open file with 45k characters refer, with UTF-16LE encoding on Win7(32/64bit eclipse)Beyond 45K characters the issue is not 100% reproducible, it seems this error occurs only when platform limit is reached and we land up in no more handles error.Not sure, if having a similar fixed upper limit on length of a line in Eclipse can help avoid such error.FYI: Work in progress to find upper limit programmatically inResetting target milestone for now.	41.0
id=398958	REOPENED	Platform	SWT	4.2.1	PC Linux-GTK	P3 normal	Platform-SWT-Inbox	2013-01-24 05:33 EST by	Lars Schuetze	2017-01-06 15:10 EST (	8 users	CreatedScreenshot showing the half drawn menu item iconsVersion: Juno Service Release 1Build id: 20121004-1855The main menu icons are just drawn half (see attachement). After hovering them with the mouse they will be drawn correctly.I am using Ubuntu 12.10 and OpenJDK 6.	Do you see these UI issues only with Eclipse or does it happen with any native GTK+ apps too? I'm wondering if it could be something with the video drivers... which video card and drivers are you using? Could be related to.No, I do not have this issue with any other GTK+ based app.I am using fglrx (catalyst 13.1) and have an IntelHD3000/ATI HD6490m hybrid graphics (using the dedicated one). Switching to the Intel graphics is currently not possible due to bugs in the catalyst driver. Furthermore I have an 64bit system.Starting Eclipse with ./eclipse -vmargs -Dorg.eclipse.swt.internal.gtk.cairoGraphics=false make the items be drawn correctly. What does this mean?(In reply to)Cairo is a vector graphics library that is used by the recent versions of GTK+ 2 and GTK+ 3 for all of their drawing. Setting this property to false ensures that Eclipse/SWT does not use Cairo APIs for drawing but this is not recommended for newer GTK+ versions. Which version of GTK+ is installed on your machine?Can you also please try to test with Eclipse Kepler 4.3 (use the latest available M-build or I-build) and update whether you see the same problem there too?Thanks!dpkg -s libgtk2.0-0|grep '^Version'Version: 2.24.13-0ubuntu2I downloaded Eclipse Keplar M4 (Build id: 20121220-1030). Just run it with ./eclipse and I do not have those Icons be not drawn correctly. Seems it has been fixed there.Lars, if this is fixed in Kepler, do you mind closing the bug?No reply for few months. Closing. Please reopen if problem still exists.I still see this happening.I see this too on gtk2-2.24.28-1.fc21.x86_64 and 4.6 I20151229-0800When I added the -Dorg.eclipse.swt.internal.gtk.cairoGraphics=false, as this bug suggests, this solved the first-time startup issue, but the issues is still there if I cover eclipse window with a different window, and then make it pop in the foreground. If I do that, I can only see half of the icons again. They become whole if I traverse them with a mouse.My configuration is below.==========================================================================*** Date: Monday, January 4, 2016 at 10:21:50 AM Eastern Standard Time*** Platform Details:*** System properties:applicationXMI=org.eclipse.ui.workbench/LegacyIDE.e4xmiawt.toolkit=sun.awt.X11.XToolkiteclipse.application=org.eclipse.ui.ide.workbencheclipse.buildId=4.5.1.M20150904-0015eclipse.commands=-oslinux-wsgtk-archx86_64-showsplash/home/timotej/eclipse-4.5-full/eclipse//plugins/org.eclipse.platform_4.5.1.v20150904-0015/splash.bmp-launcher/home/timotej/eclipse-4.5-full/eclipse/eclipse-nameEclipse--launcher.library/home/timotej/eclipse-4.5-full/eclipse//plugins/org.eclipse.equinox.launcher.gtk.linux.x86_64_1.1.300.v20150602-1417/eclipse_1612.so-startup/home/timotej/eclipse-4.5-full/eclipse//plugins/org.eclipse.equinox.launcher_1.3.100.v20150511-1540.jar--launcher.appendVmargs-exitdata510013-Dorg.eclipse.swt.internal.gtk.cairoGraphics=false-vm/usr/java/jdk1.8.0_25//bin/javaeclipse.home.location=file:/home/timotej/eclipse-4.5-full/eclipse/eclipse.launcher=/home/timotej/eclipse-4.5-full/eclipse/eclipseeclipse.launcher.name=Eclipse/../p2/eclipse.p2.profile=SDKProfileeclipse.product=org.eclipse.sdk.ideeclipse.startTime=1451920538787eclipse.stateSaveDelayInterval=30000eclipse.vm=/usr/java/jdk1.8.0_25//bin/javaeclipse.vmargs=-Xms256m-Xmx8192m-jar/home/timotej/eclipse-4.5-full/eclipse//plugins/org.eclipse.equinox.launcher_1.3.100.v20150511-1540.jarequinox.use.ds=truefile.encoding=UTF-8file.encoding.pkg=sun.iofile.separator=/gosh.args=--nointeractivejava.awt.graphicsenv=sun.awt.X11GraphicsEnvironmentjava.awt.printerjob=sun.print.PSPrinterJobjava.class.path=/home/timotej/eclipse-4.5-full/eclipse//plugins/org.eclipse.equinox.launcher_1.3.100.v20150511-1540.jarjava.class.version=52.0java.endorsed.dirs=/usr/java/jdk1.8.0_25/jre/lib/endorsedjava.ext.dirs=/usr/java/jdk1.8.0_25/jre/lib/ext:/usr/java/packages/lib/extjava.home=/usr/java/jdk1.8.0_25/jrejava.io.tmpdir=/tmpjava.library.path=/home/timotej/git/jlink/latest/lib/linux_x86_64/:/usr/lib/mozilla:/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/libjava.runtime.name=Java(TM) SE Runtime Environmentjava.runtime.version=1.8.0_25-b17java.specification.name=Java Platform API Specificationjava.specification.vendor=Oracle Corporationjava.specification.version=1.8java.vendor=Oracle Corporationjava.vendor.url=java.vendor.url.bug=java.version=1.8.0_25java.vm.info=mixed modejava.vm.name=Java HotSpot(TM) 64-Bit Server VMjava.vm.specification.name=Java Virtual Machine Specificationjava.vm.specification.vendor=Oracle Corporationjava.vm.specification.version=1.8java.vm.vendor=Oracle Corporationjava.vm.version=25.25-b02line.separator=org.eclipse.equinox.launcher.splash.location=/home/timotej/eclipse-4.5-full/eclipse//plugins/org.eclipse.platform_4.5.1.v20150904-0015/splash.bmporg.eclipse.equinox.simpleconfigurator.configUrl=file:org.eclipse.equinox.simpleconfigurator/bundles.infoorg.eclipse.swt.internal.gtk.version=2.24.24org.eclipse.update.reconcile=falseorg.eclipse.update.resolution_url=org.osgi.framework.executionenvironment=OSGi/Minimum-1.0,OSGi/Minimum-1.1,OSGi/Minimum-1.2,JavaSE/compact1-1.8,JavaSE/compact2-1.8,JavaSE/compact3-1.8,JRE-1.1,J2SE-1.2,J2SE-1.3,J2SE-1.4,J2SE-1.5,JavaSE-1.6,JavaSE-1.7,JavaSE-1.8org.osgi.framework.language=enorg.osgi.framework.os.name=Linuxorg.osgi.framework.os.version=3.17.7.fc20org.osgi.framework.processor=x86-64org.osgi.framework.system.capabilities=osgi.ee; osgi.ee="OSGi/Minimum"; version:List<Version>="1.0, 1.1, 1.2",osgi.ee; osgi.ee="JRE"; version:List<Version>="1.0, 1.1",osgi.ee; osgi.ee="JavaSE"; version:List<Version>="1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8",osgi.ee; osgi.ee="JavaSE/compact1"; version:List<Version>="1.8",osgi.ee; osgi.ee="JavaSE/compact2"; version:List<Version>="1.8",osgi.ee; osgi.ee="JavaSE/compact3"; version:List<Version>="1.8"org.osgi.framework.system.packages=javax.accessibility,javax.activation,javax.activity,javax.annotation,javax.annotation.processing,javax.crypto,javax.crypto.interfaces,javax.crypto.spec,javax.imageio,javax.imageio.event,javax.imageio.metadata,javax.imageio.plugins.bmp,javax.imageio.plugins.jpeg,javax.imageio.spi,javax.imageio.stream,javax.jws,javax.jws.soap,javax.lang.model,javax.lang.model.element,javax.lang.model.type,javax.lang.model.util,javax.management,javax.management.loading,javax.management.modelmbean,javax.management.monitor,javax.management.openmbean,javax.management.relation,javax.management.remote,javax.management.remote.rmi,javax.management.timer,javax.naming,javax.naming.directory,javax.naming.event,javax.naming.ldap,javax.naming.spi,javax.net,javax.net.ssl,javax.print,javax.print.attribute,javax.print.attribute.standard,javax.print.event,javax.rmi,javax.rmi.CORBA,javax.rmi.ssl,javax.script,javax.security.auth,javax.security.auth.callback,javax.security.auth.kerberos,javax.security.auth.login,javax.security.auth.spi,javax.security.auth.x500,javax.security.cert,javax.security.sasl,javax.sound.midi,javax.sound.midi.spi,javax.sound.sampled,javax.sound.sampled.spi,javax.sql,javax.sql.rowset,javax.sql.rowset.serial,javax.sql.rowset.spi,javax.swing,javax.swing.border,javax.swing.colorchooser,javax.swing.event,javax.swing.filechooser,javax.swing.plaf,javax.swing.plaf.basic,javax.swing.plaf.metal,javax.swing.plaf.multi,javax.swing.plaf.nimbus,javax.swing.plaf.synth,javax.swing.table,javax.swing.text,javax.swing.text.html,javax.swing.text.html.parser,javax.swing.text.rtf,javax.swing.tree,javax.swing.undo,javax.tools,javax.transaction,javax.transaction.xa,javax.xml,javax.xml.bind,javax.xml.bind.annotation,javax.xml.bind.annotation.adapters,javax.xml.bind.attachment,javax.xml.bind.helpers,javax.xml.bind.util,javax.xml.crypto,javax.xml.crypto.dom,javax.xml.crypto.dsig,javax.xml.crypto.dsig.dom,javax.xml.crypto.dsig.keyinfo,javax.xml.crypto.dsig.spec,javax.xml.datatype,javax.xml.namespace,javax.xml.parsers,javax.xml.soap,javax.xml.stream,javax.xml.stream.events,javax.xml.stream.util,javax.xml.transform,javax.xml.transform.dom,javax.xml.transform.sax,javax.xml.transform.stax,javax.xml.transform.stream,javax.xml.validation,javax.xml.ws,javax.xml.ws.handler,javax.xml.ws.handler.soap,javax.xml.ws.http,javax.xml.ws.soap,javax.xml.ws.spi,javax.xml.ws.spi.http,javax.xml.ws.wsaddressing,javax.xml.xpath,org.ietf.jgss,org.omg.CORBA,org.omg.CORBA_2_3,org.omg.CORBA_2_3.portable,org.omg.CORBA.DynAnyPackage,org.omg.CORBA.ORBPackage,org.omg.CORBA.portable,org.omg.CORBA.TypeCodePackage,org.omg.CosNaming,org.omg.CosNaming.NamingContextExtPackage,org.omg.CosNaming.NamingContextPackage,org.omg.Dynamic,org.omg.DynamicAny,org.omg.DynamicAny.DynAnyFactoryPackage,org.omg.DynamicAny.DynAnyPackage,org.omg.IOP,org.omg.IOP.CodecFactoryPackage,org.omg.IOP.CodecPackage,org.omg.Messaging,org.omg.PortableInterceptor,org.omg.PortableInterceptor.ORBInitInfoPackage,org.omg.PortableServer,org.omg.PortableServer.CurrentPackage,org.omg.PortableServer.POAManagerPackage,org.omg.PortableServer.POAPackage,org.omg.PortableServer.portable,org.omg.PortableServer.ServantLocatorPackage,org.omg.SendingContext,org.omg.stub.java.rmi,org.w3c.dom,org.w3c.dom.bootstrap,org.w3c.dom.css,org.w3c.dom.events,org.w3c.dom.html,org.w3c.dom.ls,org.w3c.dom.ranges,org.w3c.dom.stylesheets,org.w3c.dom.traversal,org.w3c.dom.views,org.w3c.dom.xpath,org.xml.sax,org.xml.sax.ext,org.xml.sax.helpersorg.osgi.framework.uuid=00e8f603-f6b2-0015-1f5e-fb9b62a9c6ecorg.osgi.framework.vendor=Eclipseorg.osgi.framework.version=1.8.0org.osgi.supports.framework.extension=trueorg.osgi.supports.framework.fragment=trueorg.osgi.supports.framework.requirebundle=trueos.arch=amd64os.name=Linuxos.version=3.17.7-200.fc20.x86_64osgi.arch=x86_64osgi.bundles=reference:file:org.eclipse.osgi.compatibility.state_1.0.100.v20150402-1551.jar,reference:file:org.eclipse.equinox.simpleconfigurator_1.1.100.v20150423-1455.jar@1:startosgi.bundles.defaultStartLevel=4osgi.compatibility.bootdelegation=trueosgi.configuration.area=file:/home/timotej/eclipse-4.5-full/eclipse/configuration/osgi.framework=file:/home/timotej/eclipse-4.5-full/eclipse/plugins/org.eclipse.osgi_3.10.101.v20150820-1432.jarosgi.framework.extensions=reference:file:org.eclipse.osgi.compatibility.state_1.0.100.v20150402-1551.jarosgi.framework.shape=jarosgi.framework.useSystemProperties=trueosgi.frameworkClassPath=., file:/home/timotej/eclipse-4.5-full/eclipse/plugins/org.eclipse.osgi.compatibility.state_1.0.100.v20150402-1551.jarosgi.install.area=file:/home/timotej/eclipse-4.5-full/eclipse/osgi.instance.area=file:/home/timotej/workspace-studio-v4/osgi.instance.area.default=file:/home/timotej/workspace/osgi.logfile=/home/timotej/workspace-studio-v4/.metadata/.logosgi.nl=en_USosgi.os=linuxosgi.splashLocation=/home/timotej/eclipse-4.5-full/eclipse//plugins/org.eclipse.platform_4.5.1.v20150904-0015/splash.bmposgi.splashPath=platform:/base/plugins/org.eclipse.platformosgi.syspath=/home/timotej/eclipse-4.5-full/eclipse/pluginsosgi.tracefile=/home/timotej/workspace-studio-v4/.metadata/trace.logosgi.ws=gtkpath.separator=:sun.arch.data.model=64sun.boot.class.path=/usr/java/jdk1.8.0_25/jre/lib/resources.jar:/usr/java/jdk1.8.0_25/jre/lib/rt.jar:/usr/java/jdk1.8.0_25/jre/lib/sunrsasign.jar:/usr/java/jdk1.8.0_25/jre/lib/jsse.jar:/usr/java/jdk1.8.0_25/jre/lib/jce.jar:/usr/java/jdk1.8.0_25/jre/lib/charsets.jar:/usr/java/jdk1.8.0_25/jre/lib/jfr.jar:/usr/java/jdk1.8.0_25/jre/classessun.boot.library.path=/usr/java/jdk1.8.0_25/jre/lib/amd64sun.cpu.endian=littlesun.cpu.isalist=sun.io.unicode.encoding=UnicodeLittlesun.java.command=/home/timotej/eclipse-4.5-full/eclipse//plugins/org.eclipse.equinox.launcher_1.3.100.v20150511-1540.jar -os linux -ws gtk -arch x86_64 -showsplash /home/timotej/eclipse-4.5-full/eclipse//plugins/org.eclipse.platform_4.5.1.v20150904-0015/splash.bmp -launcher /home/timotej/eclipse-4.5-full/eclipse/eclipse -name Eclipse --launcher.library /home/timotej/eclipse-4.5-full/eclipse//plugins/org.eclipse.equinox.launcher.gtk.linux.x86_64_1.1.300.v20150602-1417/eclipse_1612.so -startup /home/timotej/eclipse-4.5-full/eclipse//plugins/org.eclipse.equinox.launcher_1.3.100.v20150511-1540.jar --launcher.appendVmargs -exitdata 510013 -Dorg.eclipse.swt.internal.gtk.cairoGraphics=false -vm /usr/java/jdk1.8.0_25//bin/java -vmargs -Xms256m -Xmx8192m -jar /home/timotej/eclipse-4.5-full/eclipse//plugins/org.eclipse.equinox.launcher_1.3.100.v20150511-1540.jarsun.java.launcher=SUN_STANDARDsun.jnu.encoding=UTF-8sun.management.compiler=HotSpot 64-Bit Tiered Compilerssun.os.patch.level=unknownuser.country=USuser.dir=/home/timotejuser.home=/home/timotejuser.language=enuser.name=timotejuser.timezone=America/New_York*** Features:org.codehaus.groovy.compilerless.feature (2.9.2.xx-201508121448-e45) "Groovy-Eclipse plugin"org.codehaus.groovy.eclipse.feature (2.9.2.xx-201508121448-e45) "Groovy-Eclipse plugin"org.codehaus.groovy.jdt.patch (2.9.2.xx-201508121448-e45) "Groovy-Eclipse plugin"org.codehaus.groovy23.feature (2.9.2.xx-201508121448-e45) "Groovy-Eclipse plugin"org.eclipse.cdt (8.8.0.201509131935) "Eclipse C/C++ Development Tools"org.eclipse.cdt.gdb (8.8.0.201509131935) "GDB Common"org.eclipse.cdt.sdk (8.8.0.201509131935) "Eclipse C/C++ Development Tools SDK"org.eclipse.cvs (1.4.200.v20150904-0015) "Eclipse CVS Client"org.eclipse.draw2d (3.10.1.201508170204) "Graphical Editing Framework Draw2d"org.eclipse.draw2d.sdk (3.10.1.201508170204) "Graphical Editing Framework Draw2d"org.eclipse.emf (2.11.1.v20150806-0404) "EMF - Eclipse Modeling Framework Runtime and Tools"org.eclipse.emf.codegen (2.11.0.v20150806-0404) "EMF Code Generation"org.eclipse.emf.codegen.ecore (2.11.0.v20150806-0404) "EMF Ecore Code Generator"org.eclipse.emf.codegen.ecore.ui (2.11.1.v20150806-0404) "EMF Ecore Code Generator UI"org.eclipse.emf.codegen.ui (2.8.0.v20150806-0404) "EMF Code Generation UI"org.eclipse.emf.common (2.11.0.v20150805-0538) "EMF Common"org.eclipse.emf.common.ui (2.10.0.v20150806-0404) "EMF Common UI"org.eclipse.emf.converter (2.11.0.v20150806-0404) "EMF Model Converter"org.eclipse.emf.databinding (1.4.0.v20150806-0404) "EMF Data Binding"org.eclipse.emf.databinding.edit (1.4.0.v20150806-0404) "EMF Edit Data Binding"org.eclipse.emf.doc (2.10.0.v20150806-0404) "EMF Documentation"org.eclipse.emf.ecore (2.11.1.v20150805-0538) "EMF Ecore"org.eclipse.emf.ecore.edit (2.9.0.v20150806-0404) "EMF Ecore Edit"org.eclipse.emf.ecore.editor (2.11.0.v20150806-0404) "EMF Sample Ecore Editor"org.eclipse.emf.edit (2.11.1.v20150806-0404) "EMF Edit"org.eclipse.emf.edit.ui (2.11.0.v20150806-0404) "EMF Edit UI"org.eclipse.emf.mapping (2.9.0.v20150806-0404) "EMF Mapping"org.eclipse.emf.mapping.ecore (2.9.0.v20150806-0404) "EMF Ecore Mapping"org.eclipse.emf.mapping.ecore.editor (2.10.0.v20150806-0404) "EMF Ecore Mapping Editor"org.eclipse.emf.mapping.ui (2.9.0.v20150806-0404) "EMF Mapping UI"org.eclipse.gef (3.10.1.201508170204) "Graphical Editing Framework GEF"org.eclipse.gef.sdk (3.10.1.201508170204) "Graphical Editing Framework GEF"org.eclipse.help (2.1.1.v20150904-0015) "Help System Base"org.eclipse.jdt (3.11.1.v20150904-0015) "Eclipse Java Development Tools"org.eclipse.pde (3.11.1.v20150904-0345) "PDE"org.eclipse.platform (4.5.1.v20150904-0015) "Eclipse Platform"org.eclipse.rcp (4.5.1.v20150904-0015) "Eclipse RCP"org.eclipse.sdk (4.5.1.v20150904-0345) "Eclipse Project SDK"org.eclipse.test (3.7.0.v20150428-2048) "Eclipse Automated Testing"BTW the bug is not only visible on latest 4.6, it is there *at least* starting from 3.8.2, because we observe them all the time on RHEL 7.0 (with pretty ancient gtk2 version). I *believe* it was introduced in 3.8, because we haven't seen this on 3.7.2.My earlier environment was 3.8.2 Build id: M20130131-0800 and I didn't have a problem there.My new environment is 4.5.1 and I do see a problem.Reproducible only with env variable SWT_GTK3=0. Without icons are drawn, nevertheless the are twices biggerSo this bug is visible with GTK2 only? I don't expect anyone to work on it.I don't use Eclipse with GTK3, so didn't test it enough time. I think this bug may be closed and if someone with GTK3 will expirience the same - he will open new one	14.0
id=393602	REOPENED	Platform	SWT	4.2.1	PC Linux	P3 normal	Platform-SWT-Inbox	2012-11-05 15:16 EST by	John Koumarelas	2013-11-01 10:30 EDT (	7 users	CreatedCombined hover - values missing and ctrl-1 hover - everything is okHello, I have Arch Linux x64, KDE. The problem that appeared is that when I hover over a problem, e.g. a class that isn't imported, the combined hover appears but some values are not present. If I press ctrl+1, everything appears fine.This happens to: "import", "create class", "change to" etc.I attach an example (2 pictures)	This is expected. The hover shows the error/warning along with the possible quick fixes for that problem. Ctrl+1 shows the Quick Fixes plus Quick Assists which are not related to the error/warning. Hence Ctrl+1 can show more entries.(In reply to)Dani it is my fault, I didn't explain it correctly. The "sentences" are not completed fully.e.g. Instead of showing: import 'IOException' (java.io)it only showsimportThere are several packages where this happens, and it not only happens in imports, but on "create class", "change to" etc. The sentences/phrases are not completed. When I press ctrl-1 the same sentences that were not completed in the combined hover, are fine....so it's not completed yet. (changing status to REOPENED)To be even more precise, if you look at the attachment picture:You can look at the following mapping: (ctrl+1 --> combined hover)Create class 'IOException' --> Create classChange to 'IndirectionException' --> Change toChange to 'InvalidKeyException' (java.security) --> Change toChange to 'InvalidKeyException' (javax.management.openmbean) --> Change toWhat is your dialog font (Preferences > Appearance > Colors and Fonts)?.CreatedDialog fontActually I played with a different font Daniel and the problem disappeared! We're close...CreatedProblem across font familiesAfter a bit of experimenting, the problem seems a bit weird. The (DejaVu) Sans and (DejaVu) Serif fonts are problematic but the (DejaVu) monospace are not. (All monospace fonts show correct entries/sentences.We should not use WRAP style when creating our links. I've fixed that inHowever, on my Ubuntu box those fonts render correctly, so I suspect that your fonts are not correct and hence we get wrong font metrics.Moving to SWT for comment.Can you attach one of the font files for further investigation?CreatedFont FilesAttached Fonts: DejaVu Sans, Serif and Mono (Monospace must be SansMono file).Thank you for your help!***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***I foundandabout the same problem in Link#computeSize().I've released a workaround in JDT Text (master for 4.4) that will make the full label visible when the hover is wide enough:***has been marked as a duplicate of this bug. ***CreatedUbuntu (13.10) FontEclipse on Ubuntu uses the above font at size 11.	18.0
id=420360	REOPENED	Platform	SWT	4.3	PC Linux	P3 normal	Platform-SWT-Inbox	2013-10-25 05:47 EDT by	Jörg von Frantzius	2015-01-24 19:28 EST (	2 users	Copying of Java code to the clipboard on Linux does not retain syntax highlighting. It would be great to have it on Linux as well (it does work on Windows).This is not, i.e. there is no collapsed folding section.	(In reply to Jörg von Frantzius from)It also works on Linux if you use an editor that's capable of RTF. See attached example.CreatedExample with pasted colorsInteresting, when I paste to LibreOffice it does work for me as well, but not in the Thunderbird email editor. When I then copy the same code snippet from LibreOffice Writer and paste it into Thunderbird, the formatting is retained. Unfortunately, the intendation gets lost when doing so.The exact same behaviour shows with the GMail editor in the browser (Chrome, in my case): no RTF when pasting directly from Eclipse, lost indentation when pasting via LibreOffice.Would it be possible to have both formatting and indentation retained when pasting to Thunderbird and Gmail?(In reply to Jörg von Frantzius from)Sorry, but this rather indicates that they don't accept plain RTF. Forwarding to SWT for final comment.	4.0
id=426021	REOPENED	Platform	SWT	4.4	All All	P3 normal	Platform-SWT-Inbox	2014-01-17 14:39 EST by	Markus Keller	2014-01-20 12:03 EST (	3 users	StyledText#setAlwaysShowScrollBars(true) was not implemented with.	Fixed with(In reply to Markus Keller from)Sorry, this broke quite a few things:- scrolling in normal Eclipse text editors: - jumps to top - scrolls pixel-wise, not line-wise)- scrollbars are shown in compare editorReverted the bad fix with	2.0
id=418774	REOPENED	Platform	SWT	4.4	PC Linux	P3 normal	Platform-SWT-Inbox	2013-10-06 16:03 EDT by	Roman Galaktionov	2013-10-10 10:02 EDT (	3 users	Created.log file in .metadata hidden dir in project location and problem java code exampleWhen working with javafx built in swing frame, eclipse freeze (on Parse code) or crash when open WindowBuilder design tab and in many other cases. After the restart writes logs in the attachments.Among other things :1. X.org segfault: 202.491] (EE) [ 202.491] (EE) Backtrace: [ 202.491] (EE) 0: /usr/bin/X (xorg_backtrace+0x36) [0x7f4a84853516] [ 202.491] (EE) 1: /usr/bin/X (0x7f4a846a3000+0x1b4359) [0x7f4a84857359] [ 202.491] (EE) 2: /lib/x86_64-linux-gnu/libpthread.so.0 (0x7f4a837a6000+0xfbd0) [0x7f4a837b5bd0] [ 202.491] (EE) 3: /usr/lib/x86_64-linux-gnu/libpixman-1.so.0 (pixman_region_intersect+0x24) [0x7f4a83358034] [ 202.491] (EE) 4: /usr/lib/xorg/modules/drivers/intel_drv.so (0x7f4a80f37000+0x5667f) [0x7f4a80f8d67f] [ 202.491] (EE) 5: /usr/bin/X (0x7f4a846a3000+0x132d35) [0x7f4a847d5d35] [ 202.491] (EE) 6: /usr/bin/X (0x7f4a846a3000+0x58af1) [0x7f4a846fbaf1] [ 202.491] (EE) 7: /usr/bin/X (0x7f4a846a3000+0x475aa) [0x7f4a846ea5aa] [ 202.491] (EE) 8: /lib/x86_64-linux-gnu/libc.so.6 (__libc_start_main+0xf5) [0x7f4a823f2ea5] [ 202.491] (EE) 9: /usr/bin/X (0x7f4a846a3000+0x478f1) [0x7f4a846ea8f1] [ 202.491] (EE) [ 202.491] (EE) Segmentation fault at address 0x29 [ 202.491] Fatal server error: [ 202.491] Caught signal 11 (Segmentation fault). Server aborting [ 202.491] [ 202.491] (EE) Please consult the The X.Org Foundation support atfor help. 2. X.org close:[ 2944.418] Server terminated successfully (0). Closing log file.This occurs at startup javafx App in attachment.	I see a lot of trouble in the log file but I don't see how JDT could cause any of this. Moving to e(fx)clipse for comment. Could also be an Xtext issue, or ...X.org server segfault or close only when i work in eclipse+javafx+swing (see example app). Sad but true.Wow! I download eclipseVersion: 4.4.0Build id: N20131005-1500no plugins installed!Open project (example in first attach)Run project.x.org server segfault!2215.595] (EE) [ 2215.595] (EE) Backtrace:[ 2215.595] (EE) 0: /usr/bin/X (xorg_backtrace+0x36) [0x7fc3109c2516][ 2215.595] (EE) 1: /usr/bin/X (0x7fc310812000+0x1b4359) [0x7fc3109c6359][ 2215.595] (EE) 2: /lib/x86_64-linux-gnu/libpthread.so.0 (0x7fc30f915000+0xfbd0) [0x7fc30f924bd0][ 2215.595] (EE) 3: /usr/lib/x86_64-linux-gnu/libpixman-1.so.0 (pixman_region_intersect+0x24) [0x7fc30f4c7034][ 2215.595] (EE) 4: /usr/lib/xorg/modules/drivers/intel_drv.so (0x7fc30d0a6000+0x5667f) [0x7fc30d0fc67f][ 2215.596] (EE) 5: /usr/bin/X (0x7fc310812000+0x132d35) [0x7fc310944d35][ 2215.596] (EE) 6: /usr/bin/X (0x7fc310812000+0x58af1) [0x7fc31086aaf1][ 2215.596] (EE) 7: /usr/bin/X (0x7fc310812000+0x475aa) [0x7fc3108595aa][ 2215.596] (EE) 8: /lib/x86_64-linux-gnu/libc.so.6 (__libc_start_main+0xf5) [0x7fc30e561ea5][ 2215.596] (EE) 9: /usr/bin/X (0x7fc310812000+0x478f1) [0x7fc3108598f1][ 2215.596] (EE) [ 2215.596] (EE) Segmentation fault at address 0x6e00000063[ 2215.596] Fatal server error:[ 2215.596] Caught signal 11 (Segmentation fault). Server aborting[ 2215.596] [ 2215.596] (EE)Please change bug to eclipse bug.Createdxorg server segfault logMy notebook with "Optimus" (hybrid APU+GPU video system Nvidia GEForce 640m+Intel HD 4000).If i run ./eclipse then crash x server with segfaultIf i run optirun ./eclipse (its bumblebee project optirun utility) with 325 nvidia driver, then i recieve:## A fatal error has been detected by the Java Runtime Environment:## SIGSEGV (0xb) at pc=0x0000000000000000, pid=4011, tid=140479057688320## JRE version: Java(TM) SE Runtime Environment (7.0_40-b43) (build 1.7.0_40-b43)# Java VM: Java HotSpot(TM) 64-Bit Server VM (24.0-b56 mixed mode linux-amd64 compressed oops)# Problematic frame:# C 0x0000000000000000## Failed to write core dump. Core dumps have been disabled. To enable core dumping, try "ulimit -c unlimited" before starting Java again## An error report file with more information is saved as:# /mnt/data/Personal/Projects/Sleep/SleepGraph/hs_err_pid4011.log## If you would like to submit a bug report, please visit:## The crash happened outside the Java Virtual Machine in native code.# See problematic frame for where to report the bug.#In attachment full log files (several).Createdfull jvm crash logs(In reply to Roman Galaktionov from)Sorry.If i run ./eclipse and then run javafx project in eclipse -> many xorg server segfaultandIf i run optirun ./eclipse and then run javafx project in eclipse -> sigserv segfault jvmIt's not a bug, but a few bugs.1. WindowBuilder not parse javafx swing app with JFXPanel2. JavaFX project crash xorg server3. JavaFX project run on optimus (bumblebee optirun) crash jvm(In reply to Roman Galaktionov from)The stacktrace in the logs show that the crash happens in JavaFx, not in eclipse. I think the bug has to be logged on JavaFx.Yes, I have come to the same conclusion. Has already sent a bug in Oracle.But. WindowBuilder still does not work.I check java 8 on same bugs.(In reply to Roman Galaktionov from)Moving bug to WindowBuilderIt seems Java 8 does not cause segfolts!1. i run project.jar. It work fine.2. i run optirun project.jar It work fine.3. WindowBuilder crash eclipse when parse swing app with JFXPanelEclipse crash log in new attachment.Creatednext start log when windowbuilder crash eclipse (silent crash, no logs)I don't see what this has to do with WindowBuilder, and I don't see anything WB related in any of the logs. If JavaFX has issues running in Eclipse, it certainly won't work with WB either. When WB opens a file for edit, all of the widgets are instantiated in order to get the WYSIWYG visual presentation. If those widgets have problems and throw exceptions, WB will trap those exceptions and show an appropriate error to the user. If those widgets actually crash the system, there is nothing we can do other than suggest not using those components in the future until the underlying problem is fixed. I don't see anything here for WB to "fix" or even investigate further.I don't think we can do anything to make things work, at least not e(fx)clipse which is not involved at all.When1. I run eclipse2. Open swing project with JFXPanel3. Open "design" tab in windowbuilder4. Eclipse show progress windowbuilder "parsing"->"refreshing"->crashIn apport (ubuntu crash report system):ERROR: apport (pid 23135) Tue Oct 8 21:52:12 2013: called for pid 23072, signal 6, core limit 0ERROR: apport (pid 23135) Tue Oct 8 21:52:12 2013: executable: /usr/lib/jvm/java-8-oracle/jre/bin/java (command line "/usr/bin/java -Dosgi.requiredJavaVersion=1.7 -XX:MaxPermSize=1024m -Xms256m -Xmx2048m -jar /mnt/data/IDE/eclipse-java-kepler-R-linux-gtk-x86_64//plugins/org.eclipse.equinox.launcher_1.3.0.v20130327-1440.jar -os linux -ws gtk -arch x86_64 -showsplash /mnt/data/IDE/eclipse-java-kepler-R-linux-gtk-x86_64//plugins/org.eclipse.platform_4.3.1.v20130911-1000/splash.bmp -launcher /mnt/data/IDE/eclipse-java-kepler-R-linux-gtk-x86_64/eclipse -name Eclipse --launcher.library /mnt/data/IDE/eclipse-java-kepler-R-linux-gtk-x86_64//plugins/org.eclipse.equinox.launcher.gtk.linux.x86_64_1.1.200.v20130807-1835/eclipse_1506.so -startup /mnt/data/IDE/eclipse-java-kepler-R-linux-gtk-x86_64//plugins/org.eclipse.equinox.launcher_1.3.0.v20130327-1440.jar --launcher.appendVmargs -exitdata 3d2001f -product org.eclipse.epp.package.java.product -vm /usr/bin/java -vmargs -Dosgi.requiredJavaVersion=1.7 -XX:MaxPermSize=1024m -Xms256m -Xmx2048m -jar /mnt/data/IDE/eclipse-java-kepler-R-linux-gtk-x86_64//plugins/org.eclipse.equinox.launcher_1.3.0.v20130327-1440.jar")ERROR: apport (pid 23135) Tue Oct 8 21:52:12 2013: debug: session gdbus call: (true,)ERROR: apport (pid 23135) Tue Oct 8 21:57:16 2013: wrote report /var/crash/_usr_lib_jvm_java-8-oracle_jre_bin_java.1000.crashI add new attachment: _usr_lib_jvm_java-8-oracle_jre_bin_java.1000.crashwithout crash dumpCreatedeclipse crash logIn java 7 same crash eclipseCreatedeclipse crash with java 7I agree with Eric: the problem is not related to WB and we can do nothing if JavaFX crashes Eclipse. The only thing I can suggest you is to try to uninstall bumblebee (since it is not very stable yet and I've heard about many issues with it and even cancelled to use Linux on my dual-GPU system).CreatedFully work project swing+JFXPanel ->crash windowbuilder+eclipseIn java 8 javafx NOT crash jvm or eclipse. Full and fine work!In every eclipse+windowbuilder->swing+JFXPanel->crash eclipse.Now I do not use bumblebee. Eclipse+windowBuilder+Swing+JFXPanel->Crash.In ubuntu linux:1. In java 8 javafx work fine. 2. WindowBuilder crash when parse+refreshing swing+JFXPanel code.In windows XP:1. I download Eclipse for windows. 2. setup java 73. Open same project (in last attacment). 4. Open WindowBuilder Design Tab.5. WindowBuilder work fineI loaded up WB source code and attempted to reproduce the issue using provided sample code. I wasn't able to get it crashes, but I can see a bunch of "invalid thread access" messages:"Exception in thread "JavaFX Application Thread" org.eclipse.swt.SWTException: Invalid thread access" (see attachment for JavaFX thread dump).I think this is incompatibility between SWT & JavaFX.CreatedInvalid thread access messageMay be reopen bug?It might be worth having the SWT team comment.JavaFX and SWT share the same event-thread => Swing and JavaFX/SWT don't - I can only repeat this has nothing to do with e(fx)clipse, not sure where this bug should get move too, it clearly does not belong into our bucket.I just do not know where to move it. If you have any suggestions, move.Possibly Platform > SWT...?OkI do not know, the messages in the SWT team will come right after the redirect bug, or need more messages in the comments? What is no reaction from them no.May be its intel driver bug.I install new intel driver (from freedesctop bug tracker).1. Start eclipse2. Open example attached project3. Open windowbuilder design tab.4. Eclipse crash.JVM terminated. Exit code=1/usr/bin/java-Dosgi.requiredJavaVersion=1.7-XX:MaxPermSize=1024m-Xms256m-Xmx2048m-jar /mnt/data/IDE/eclipse-java-kepler-R-linux-gtk-x86_64//plugins/org.eclipse.equinox.launcher_1.3.0.v20130327-1440.jar-os linux-ws gtk-arch x86_64-showsplash /mnt/data/IDE/eclipse-java-kepler-R-linux-gtk-x86_64//plugins/org.eclipse.platform_4.3.1.v20130911-1000/splash.bmp-launcher /mnt/data/IDE/eclipse-java-kepler-R-linux-gtk-x86_64/eclipse-name Eclipse--launcher.library /mnt/data/IDE/eclipse-java-kepler-R-linux-gtk-x86_64//plugins/org.eclipse.equinox.launcher.gtk.linux.x86_64_1.1.200.v20130807-1835/eclipse_1506.so-startup /mnt/data/IDE/eclipse-java-kepler-R-linux-gtk-x86_64//plugins/org.eclipse.equinox.launcher_1.3.0.v20130327-1440.jar--launcher.appendVmargs-exitdata 6a000c-product org.eclipse.epp.package.java.product-vm /usr/bin/java-vmargs-Dosgi.requiredJavaVersion=1.7-XX:MaxPermSize=1024m-Xms256m-Xmx2048m-jar /mnt/data/IDE/eclipse-java-kepler-R-linux-gtk-x86_64//plugins/org.eclipse.equinox.launcher_1.3.0.v20130327-1440.jar No other logs.	36.0
id=426849	REOPENED	Platform	SWT	4.3	PC Windows 7	P3 major	Platform-SWT-Inbox	2014-01-29 01:25 EST by	Sumit Singh	2015-07-09 08:44 EDT (	3 users	As I'm bound to Eclipse RCP / SWT, I am working with the org.eclipse.swt.widgets.FileDialog.The documentation of this FileDialog points out to use the setFilterPath(String string)-method which should do exactly what I need. FileDialog dialog = new FileDialog(shell, SWT.OPEN); dialog.setFilterExtensions(new String [] {"*.html"}); dialog.setFilterPath("c:\\temp"); String result = dialog.open();Unfortunately it is not working, at least not "every time".I have currently no installation to check on it, but I'm quite sure that the feature would work totally fine on a Windows 200/XP/Vista machine. I am working with a Windows 7 machine and I think I am suffering from the behaviour described here for lpstrInitialDir().At least, this is exactly the behaviour I am facing: The path is good the first time I open the dialog, but the second time, the path is initially set to the last chosen path. This seems to be convenient in most cases, but it is not in mine.Can this be right? If so, have I any chance on changing the behaviour according to my needs?	Hi Sumit,The second time filter-path of FileDialog changing to the most recent selected directory, is Windows specific behavior and does seems correct.Note:- I could see a similar behavior in Window XP as well.(For which MSDN says: For 2000/XP/Vista if the application is not run for a long time, only then FileDialog's save selected path is discarded.)For your need, recommend you to re-set the FilterPath to the intended path every-time, before you open the dialog. Something like below should work:String openDialog(FileDialog dialog, String filterPath) { dialog.setFilterPath(filterPath); return dialog.open();}Closing this bug as not an Eclipse-SWT problem.Hi Niraj,I know thank but my code is like following:void openDialog() { FileDialog dialog = new FileDialog(shell, SWT.OPEN); dialog.setFilterExtensions(new String [] {"*.html"}); dialog.setFilterPath("c:\\temp"); String result = dialog.open();}So obviously i'm setting it every time but it always opens last selection.***has been marked as a duplicate of this bug. ***CreatedTestSnippetHi Sumit,The same steps works for me, please refer my test snippet attached.This works fine with SWT 4.3 as well.Hi Niraj,Yes this is working for me too. But the problem is I'm using same code in My RCP.When I run my RCP from eclipse it working as expected.But When I Export my RCP then its not working as expected.Then it start problem as describe above. I try to print what value is going to set in setFilterPath and its correct but i don't have any clue why for exported Application its not setting the setFilterPath .Thanks,SumitCreatedSample ProjectHi,I added a sample RCP project please try to export it and run it.Befor exporting please set path in TestPart class according to your system.I'm not very sure it will show you the problem because problem is not very consistence.We just ran into the same issue in our RCP app, and found a work-around. Remember in a static member in one of your classes whether the file dialog has already been opened in your application, and if not (i.e. on the very first opening), prefix the directory with \\?\.private static boolean FIRST_FILE_OPEN_DIALOG = true;public static String getInitialDirectoryForFileDialog(String initialDir) { if (FIRST_FILE_OPEN_DIALOG) { initialDir = "\\\\?\\" + initialDir; FIRST_FILE_OPEN_DIALOG = false; } return initialDir;}Then use the directory in setFilterPath().	7.0
id=455555	REOPENED	Platform	SWT	4.5	Macintosh Mac OS X	P3 enhancement	Platform-SWT-Inbox	2014-12-18 02:25 EST by	Marco Descher	2014-12-18 03:46 EST (	2 users	Please allow to search within the table of available commands!	CreatedScreenshotThe command table is basically a big SWT browser control and your (platform-specific?) search key should already work. On my Windows system I press Ctrl+F.Closing as worksforme. Please reopen if it still doesn't work on your system.Does not work on OS X :( Nothing happens for all keysNo key on OS X shows a search dialog, triedCMD+FALT+FCTRL+FWhat underlying browser is that on Mac?According toit should be WebKit.In my Mac virtual box I could reproduce:1) In Safari option+f opens a search bar at the top of the browser page.2) In SWT's browser control that doesn't work.I've googled a little bit but found nothing that suggests how to make this work on Mac. I'm marking this bugzilla as helpwanted because I have no experience with Mac.One more note: Eclipse's "Internal Web Browser" has the same problem. That could mean that this enhancement request should be moved to SWT.There's not much we can do in Oomph to make this work. Moving to SWT.	9.0
id=453051	REOPENED	Platform	SWT	4.5	PC Mac OS X	P3 critical	Platform-SWT-Inbox	2014-11-24 09:42 EST by	Marco Descher	2014-11-24 15:31 EST (	0 users	I have a jface tree viewer implementation in current Luna. If I select an element of this treeViewer using either Keyboard or a os x keypad or right mouse down on an external mouse the selection works ok.If I however select LEFT-mouse-down to select an element, the system goes to 100 % cpu in org.eclipse.swt.internal.cocoa.OS.objc_msgSendSuper(Native Method)org.eclipse.swt.widgets.Widget.callSuper(Widget.java:221)org.eclipse.swt.widgets.Widget.mouseDownSuper(Widget.java:1101)org.eclipse.swt.widgets.Tree.mouseDownSuper(Tree.java:2044)org.eclipse.swt.widgets.Widget.mouseDown(Widget.java:1093)org.eclipse.swt.widgets.Control.mouseDown(Control.java:2563)org.eclipse.swt.widgets.Tree.mouseDown(Tree.java:2012)org.eclipse.swt.widgets.Display.windowProc(Display.java:5627)org.eclipse.swt.widgets.Widget.windowSendEvent(Widget.java:2105)org.eclipse.swt.widgets.Shell.windowSendEvent(Shell.java:2329)org.eclipse.swt.widgets.Display.windowProc(Display.java:5691)org.eclipse.swt.widgets.Display.applicationSendEvent(Display.java:5128)org.eclipse.swt.widgets.Display.applicationProc(Display.java:5277)org.eclipse.swt.internal.cocoa.OS.objc_msgSend(Native Method)org.eclipse.swt.internal.cocoa.NSApplication.sendEvent(NSApplication.java:128)org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3655)org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1151)org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1032)org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:148)org.eclipse.e4.ui.internal.workbench.swt.E4Application.start(E4Application.java:164)org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134)org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104)org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:380)org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:235)sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)java.lang.reflect.Method.invoke(Method.java:606)org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:648)org.eclipse.equinox.launcher.Main.basicRun(Main.java:603)org.eclipse.equinox.launcher.Main.run(Main.java:1465)org.eclipse.equinox.launcher.Main.main(Main.java:1438)This reminds me a lot of, where we never checked wether the situation is the same for a Table and a Tree.	Further research led me into suspicion that the problem lies within a loop in the registered EMF listeners! Marking as invalid - will reopen if yet prooves to be subject to the viewer.The problem is not dependend on these listeners, and the current code I have works fine in JUNO, yet crashes when switching to >=Kepler.I could find out the following fact:The listener used isorg.eclipse.swt.widgets.Tree..addMouseListener(new MouseListener() { ... }------> LUNA & KEPLERselecting with both fingers (on the pad) works without crash and generates the following MouseEventsmouseDown MouseEvent{Tree {} time=5106660 data=null button=3 stateMask=0x0 x=295 y=6 count=1}mouseUp MouseEvent{Tree {} time=5106667 data=null button=3 stateMask=0x200000 x=295 y=6 count=1}selecting with one finger, however, crashes the system and generates ONLY the mouseDown Event - NO mouseUp is generated!!mouseDown MouseEvent{Tree {} time=5145471 data=null button=1 stateMask=0x0 x=211 y=8 count=1}-------> JUNOboth events are generated as required2 fingersmouseDown MouseEvent{Tree {} time=5296156 data=null button=3 stateMask=0x0 x=222 y=39 count=1}mouseUp MouseEvent{Tree {} time=5296162 data=null button=3 stateMask=0x200000 x=222 y=39 count=1}1 fingermouseDown MouseEvent{Tree {} time=5299079 data=null button=1 stateMask=0x0 x=221 y=3 count=1}mouseUp MouseEvent{Tree {} time=5299085 data=null button=1 stateMask=0x80000 x=221 y=3 count=1}	3.0
id=429995	REOPENED	Platform	SWT	4.2.2	PC Windows 7	P3 normal	Platform-SWT-Inbox	2014-03-10 07:24 EDT by	Navnidhi Sharma	2014-09-03 09:24 EDT (	5 users	CreatedCrash report screenEclipse is not allowing to open or edit any file like HTML, JS etc.It hangs as soon as we are tring to edit any JS file & crashes immediately while opening the index.HTML file.	Why is this on PDE UI?Please check for a log file in your workspace metadata directory. This is not a problem in PDE and you have not provided enough information for me to guess which component owns this issue.Comment onCrash report screen## A fatal error has been detected by the Java Runtime Environment:## EXCEPTION_ACCESS_VIOLATION (0xc0000005) at pc=0x000007feed82af15, pid=8064, tid=1644## JRE version: Java(TM) SE Runtime Environment (7.0_51-b13) (build 1.7.0_51-b13)# Java VM: Java HotSpot(TM) 64-Bit Server VM (24.51-b03 mixed mode windows-amd64 compressed oops)# Problematic frame:# C [jscript9.dll+0x6af15]## Failed to write core dump. Minidumps are not enabled by default on client versions of Windows## If you would like to submit a bug report, please visit:## The crash happened outside the Java Virtual Machine in native code.# See problematic frame for where to report the bug.#--------------- T H R E A D ---------------Current thread (0x000000000051f000): JavaThread "main" [_thread_in_native, id=1644, stack(0x00000000025f0000,0x00000000026f0000)]siginfo: ExceptionCode=0xc0000005, reading address 0x0000000000000084Registers:RAX=0x000000001d018c03, RBX=0x000000000000000d, RCX=0x0000000000000000, RDX=0x0000000000000028RSP=0x00000000026ec2c0, RBP=0x00000000026ec339, RSI=0x000000001d018c03, RDI=0x000000001f0e57b0R8 =0x000000001d018c06, R9 =0x0000000000000080, R10=0x000000000000fffd, R11=0x0000000000000000R12=0x000000000000000d, R13=0x000000001d018c05, R14=0x000000001f0e57b8, R15=0x000000001d01987fRIP=0x000007feed82af15, EFLAGS=0x0000000000010246Top of Stack: (sp=0x00000000026ec2c0)0x00000000026ec2c0: 000000001f0e57b0 00000000026ec3180x00000000026ec2d0: 000007feed7c0000 00000000000000180x00000000026ec2e0: 0000000000000003 00000000000010080x00000000026ec2f0: 0000000021b2a360 000000001f0e52600x00000000026ec300: 00000000007244d0 00000000000000000x00000000026ec310: 0000000000000600 000000001d018c060x00000000026ec320: 000000001d018be5 000007fe000000280x00000000026ec330: 0000000000000000 00000000000006080x00000000026ec340: 000000001f0d0190 00000000000008000x00000000026ec350: 0000000021ae5780 000007feed89bbbd0x00000000026ec360: 000000001f0e57b0 00000000000000000x00000000026ec370: 0000000000000001 000000001f0e52600x00000000026ec380: 0000000000000081 00000000026ec3e00x00000000026ec390: 00000000026ec460 000007feed9b97870x00000000026ec3a0: 000000001f0e57b0 00000000026ec3f00x00000000026ec3b0: 000000001f0e57b0 0001000000000003 Instructions: (pc=0x000007feed82af15)0x000007feed82aef5: 09 83 fb 0a 0f 85 20 e4 05 00 48 ff ce f6 87 900x000007feed82af05: 00 00 00 10 0f 85 71 ef fe ff 48 8b 4f 18 8b c60x000007feed82af15: 44 8b 81 84 00 00 00 2b 47 48 41 0f ba e0 0e 730x000007feed82af25: 4d 8b d0 48 8b 81 88 00 00 00 48 3b c2 0f 86 5f Register to memory mapping:RAX=0x000000001d018c03 is an unknown valueRBX=0x000000000000000d is an unknown valueRCX=0x0000000000000000 is an unknown valueRDX=0x0000000000000028 is an unknown valueRSP=0x00000000026ec2c0 is pointing into the stack for thread: 0x000000000051f000RBP=0x00000000026ec339 is pointing into the stack for thread: 0x000000000051f000RSI=0x000000001d018c03 is an unknown valueRDI=0x000000001f0e57b0 is an unknown valueR8 =0x000000001d018c06 is an unknown valueR9 =0x0000000000000080 is an unknown valueR10=0x000000000000fffd is an unknown valueR11=0x0000000000000000 is an unknown valueR12=0x000000000000000d is an unknown valueR13=0x000000001d018c05 is an unknown valueR14=0x000000001f0e57b8 is an unknown valueR15=0x000000001d01987f is an unknown valueStack: [0x00000000025f0000,0x00000000026f0000], sp=0x00000000026ec2c0, free space=1008kNative frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)C [jscript9.dll+0x6af15]Java frames: (J=compiled Java code, j=interpreted, Vv=VM code)j org.eclipse.swt.internal.ole.win32.COM.VtblCall(IJII[J)I+0j org.eclipse.swt.internal.ole.win32.IDispatch.GetTypeInfo(II[J)I+8j org.eclipse.swt.ole.win32.OleAutomation.<init>(Lorg/eclipse/swt/internal/ole/win32/IDispatch;)V+40j org.eclipse.swt.ole.win32.Variant.getAutomation()Lorg/eclipse/swt/ole/win32/OleAutomation;+31j org.eclipse.swt.browser.IE.execute(Ljava/lang/String;)Z+109j org.eclipse.swt.browser.IE$7.handleEvent(Lorg/eclipse/swt/ole/win32/OleEvent;)V+1502j org.eclipse.swt.ole.win32.OleEventTable.sendEvent(Lorg/eclipse/swt/ole/win32/OleEvent;)V+39j org.eclipse.swt.ole.win32.OleEventSink.notifyListener(ILorg/eclipse/swt/ole/win32/OleEvent;)V+34j org.eclipse.swt.ole.win32.OleEventSink.Invoke(IJIIJJJJ)I+152j org.eclipse.swt.ole.win32.OleEventSink.access$1(Lorg/eclipse/swt/ole/win32/OleEventSink;IJIIJJJJ)I+15j org.eclipse.swt.ole.win32.OleEventSink$1.method6([J)J+33j org.eclipse.swt.internal.ole.win32.COMObject.callback6([J)J+52v ~StubRoutines::call_stubJ org.eclipse.swt.internal.win32.OS.DispatchMessageW(Lorg/eclipse/swt/internal/win32/MSG;)Jj org.eclipse.swt.internal.win32.OS.DispatchMessage(Lorg/eclipse/swt/internal/win32/MSG;)J+7j org.eclipse.swt.widgets.Display.readAndDispatch()Z+64j org.eclipse.jface.window.Window.runEventLoop(Lorg/eclipse/swt/widgets/Shell;)V+23j org.eclipse.jface.window.Window.open()I+49j org.eclipse.jface.dialogs.MessageDialog.open()I+1j com.ibm.etools.rpe.internal.ui.SplitPane$21$1.run()V+39j org.eclipse.swt.widgets.RunnableLock.run()V+11J org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Z)ZJ org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run()Vj org.eclipse.core.databinding.observable.Realm.runWithDefault(Lorg/eclipse/core/databinding/observable/Realm;Ljava/lang/Runnable;)V+12j org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(Lorg/eclipse/e4/ui/model/application/MApplicationElement;Lorg/eclipse/e4/core/contexts/IEclipseContext;)Ljava/lang/Object;+57j org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(Lorg/eclipse/e4/ui/model/application/MApplicationElement;)V+20j org.eclipse.ui.internal.Workbench$5.run()V+256j org.eclipse.core.databinding.observable.Realm.runWithDefault(Lorg/eclipse/core/databinding/observable/Realm;Ljava/lang/Runnable;)V+12j org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Lorg/eclipse/swt/widgets/Display;Lorg/eclipse/ui/application/WorkbenchAdvisor;)I+18j org.eclipse.ui.PlatformUI.createAndRunWorkbench(Lorg/eclipse/swt/widgets/Display;Lorg/eclipse/ui/application/WorkbenchAdvisor;)I+2j org.eclipse.ui.internal.ide.application.IDEApplication.start(Lorg/eclipse/equinox/app/IApplicationContext;)Ljava/lang/Object;+108j org.eclipse.equinox.internal.app.EclipseAppHandle.run(Ljava/lang/Object;)Ljava/lang/Object;+135j org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(Ljava/lang/Object;)Ljava/lang/Object;+103j org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(Ljava/lang/Object;)Ljava/lang/Object;+29j org.eclipse.core.runtime.adaptor.EclipseStarter.run(Ljava/lang/Object;)Ljava/lang/Object;+149j org.eclipse.core.runtime.adaptor.EclipseStarter.run([Ljava/lang/String;Ljava/lang/Runnable;)Ljava/lang/Object;+183v ~StubRoutines::call_stubj sun.reflect.NativeMethodAccessorImpl.invoke0(Ljava/lang/reflect/Method;Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+0j sun.reflect.NativeMethodAccessorImpl.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+87j sun.reflect.DelegatingMethodAccessorImpl.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+6j java.lang.reflect.Method.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+57j org.eclipse.equinox.launcher.Main.invokeFramework([Ljava/lang/String;[Ljava/net/URL;)V+211j org.eclipse.equinox.launcher.Main.basicRun([Ljava/lang/String;)V+126j org.eclipse.equinox.launcher.Main.run([Ljava/lang/String;)I+4j org.eclipse.equinox.launcher.Main.main([Ljava/lang/String;)V+10v ~StubRoutines::call_stub--------------- P R O C E S S ---------------Java Threads: ( => current thread ) 0x000000000e282000 JavaThread "Worker-36" [_thread_blocked, id=9160, stack(0x000000001bae0000,0x000000001bbe0000)] 0x0000000008ca0800 JavaThread "Worker-35" [_thread_in_Java, id=7900, stack(0x0000000019c90000,0x0000000019d90000)] 0x0000000008c9d800 JavaThread "Link Indexer worker-0" [_thread_blocked, id=8944, stack(0x0000000019910000,0x0000000019a10000)] 0x0000000008c9f000 JavaThread "Worker-34" [_thread_blocked, id=7312, stack(0x0000000019790000,0x0000000019890000)] 0x0000000008c9e800 JavaThread "Worker-33" [_thread_blocked, id=6832, stack(0x0000000010e50000,0x0000000010f50000)] 0x0000000008c9a800 JavaThread "Worker-32" [_thread_blocked, id=7692, stack(0x00000000127d0000,0x00000000128d0000)] 0x0000000008ca3800 JavaThread "Worker-31" [_thread_blocked, id=3408, stack(0x0000000018450000,0x0000000018550000)] 0x0000000008ca5000 JavaThread "Link Indexer Thread Scheduler-0" [_thread_blocked, id=9028, stack(0x0000000018290000,0x0000000018390000)] 0x000000000c389000 JavaThread "Timer-1" [_thread_blocked, id=9004, stack(0x0000000017d50000,0x0000000017e50000)] 0x000000000c388000 JavaThread "org.eclipse.wst.sse.ui.internal.reconcile.StructuredRegionProcessor" daemon [_thread_blocked, id=8220, stack(0x000000000fdc0000,0x000000000fec0000)] 0x000000000c384800 JavaThread "JavaScript indexing" daemon [_thread_blocked, id=2808, stack(0x0000000017130000,0x0000000017230000)] 0x000000000c383800 JavaThread "qtp880646576-156" [_thread_blocked, id=5032, stack(0x0000000014cd0000,0x0000000014dd0000)] 0x000000000c383000 JavaThread "qtp880646576-155" [_thread_blocked, id=8188, stack(0x0000000014af0000,0x0000000014bf0000)] 0x000000000c387800 JavaThread "qtp880646576-154 Selector0" [_thread_in_native, id=8368, stack(0x0000000014230000,0x0000000014330000)] 0x000000000c386000 JavaThread "qtp880646576-153 Acceptor0:52282" [_thread_in_native, id=7628, stack(0x0000000012e20000,0x0000000012f20000)] 0x000000000c425000 JavaThread "Timer-0" [_thread_blocked, id=8764, stack(0x0000000010bb0000,0x0000000010cb0000)] 0x000000000c385000 JavaThread "Worker-30" [_thread_blocked, id=8980, stack(0x0000000012cb0000,0x0000000012db0000)] 0x000000000e283800 JavaThread "Worker-29" [_thread_blocked, id=6948, stack(0x0000000012570000,0x0000000012670000)] 0x000000000c386800 JavaThread "Worker-24" [_thread_blocked, id=8928, stack(0x00000000126a0000,0x00000000127a0000)] 0x0000000008ca2000 JavaThread "[ThreadPool Manager] - Idle Thread" daemon [_thread_blocked, id=9144, stack(0x0000000018580000,0x0000000018680000)] 0x000000000e283000 JavaThread "MultiThreadedHttpConnectionManager cleanup" daemon [_thread_blocked, id=8616, stack(0x0000000017f10000,0x0000000018010000)] 0x000000000c424800 JavaThread "Java indexing" daemon [_thread_blocked, id=2392, stack(0x0000000012f70000,0x0000000013070000)] 0x000000000c422800 JavaThread "Thread-3" [_thread_in_native, id=6200, stack(0x0000000012460000,0x0000000012560000)] 0x0000000008ca4800 JavaThread "Collaboration Service Job Manager" [_thread_blocked, id=5280, stack(0x0000000012350000,0x0000000012450000)] 0x0000000008ca6000 JavaThread "Bundle File Closer" daemon [_thread_blocked, id=8356, stack(0x00000000109f0000,0x0000000010af0000)] 0x0000000008c9c000 JavaThread "Worker-JM" [_thread_blocked, id=4808, stack(0x000000000d8f0000,0x000000000d9f0000)] 0x0000000008c9b800 JavaThread "[Timer] - Main Queue Handler" daemon [_thread_blocked, id=8644, stack(0x000000000d6e0000,0x000000000d7e0000)] 0x0000000008c9a000 JavaThread "Framework Event Dispatcher" daemon [_thread_blocked, id=4264, stack(0x000000000d470000,0x000000000d570000)] 0x0000000008c99000 JavaThread "Start Level Event Dispatcher" daemon [_thread_blocked, id=1392, stack(0x000000000d120000,0x000000000d220000)] 0x0000000008c98800 JavaThread "State Data Manager" daemon [_thread_blocked, id=6548, stack(0x000000000d230000,0x000000000d330000)] 0x0000000008c97800 JavaThread "Framework Active Thread" [_thread_blocked, id=6716, stack(0x000000000c020000,0x000000000c120000)] 0x0000000008c97000 JavaThread "Service Thread" daemon [_thread_blocked, id=2124, stack(0x000000000a7b0000,0x000000000a8b0000)] 0x0000000008c95000 JavaThread "C2 CompilerThread1" daemon [_thread_blocked, id=2088, stack(0x000000000a6b0000,0x000000000a7b0000)] 0x0000000008c90000 JavaThread "C2 CompilerThread0" daemon [_thread_in_native, id=708, stack(0x0000000009fe0000,0x000000000a0e0000)] 0x0000000008c8f000 JavaThread "Attach Listener" daemon [_thread_blocked, id=8828, stack(0x000000000a430000,0x000000000a530000)] 0x0000000008c88000 JavaThread "Signal Dispatcher" daemon [_thread_blocked, id=8308, stack(0x000000000a310000,0x000000000a410000)] 0x0000000008c34800 JavaThread "Finalizer" daemon [_thread_blocked, id=7144, stack(0x000000000a0f0000,0x000000000a1f0000)] 0x0000000008c2d800 JavaThread "Reference Handler" daemon [_thread_blocked, id=5592, stack(0x0000000009e30000,0x0000000009f30000)]=>0x000000000051f000 JavaThread "main" [_thread_in_native, id=1644, stack(0x00000000025f0000,0x00000000026f0000)]Other Threads: 0x0000000008c27000 VMThread [stack: 0x0000000009cf0000,0x0000000009df0000] [id=7024] 0x000000000a8b8800 WatcherThread [stack: 0x000000000a530000,0x000000000a630000] [id=3760]VM state:not at safepoint (normal execution)VM Mutex/Monitor currently owned by a thread: NoneHeap PSYoungGen total 209920K, used 185883K [0x00000000eaa80000, 0x00000000f9080000, 0x0000000100000000) eden space 199680K, 87% used [0x00000000eaa80000,0x00000000f5608718,0x00000000f6d80000) from space 10240K, 99% used [0x00000000f7c00000,0x00000000f85fe510,0x00000000f8600000) to space 14848K, 0% used [0x00000000f6d80000,0x00000000f6d80000,0x00000000f7c00000) ParOldGen total 162304K, used 102389K [0x00000000c0000000, 0x00000000c9e80000, 0x00000000eaa80000) object space 162304K, 63% used [0x00000000c0000000,0x00000000c63fd688,0x00000000c9e80000) PSPermGen total 124416K, used 124009K [0x00000000b0000000, 0x00000000b7980000, 0x00000000c0000000) object space 124416K, 99% used [0x00000000b0000000,0x00000000b791a568,0x00000000b7980000)Card table byte_map: [0x00000000056f0000,0x0000000005980000] byte_map_base: 0x0000000005170000Polling page: 0x0000000000240000Code Cache [0x00000000026f0000, 0x0000000003020000, 0x00000000056f0000) total_blobs=3453 nmethods=2545 adapters=857 free_code_cache=39940Kb largest_free_block=40706048Compilation events (10 events):Event: 3036.147 Thread 0x0000000008c90000 2945 java.util.LinkedList$Node::<init> (20 bytes)Event: 3036.147 Thread 0x0000000008c90000 nmethod 2945 0x0000000002f80c10 code [0x0000000002f80d40, 0x0000000002f80db8]Event: 3036.148 Thread 0x0000000008c95000 2946 com.ibm.team.filesystem.client.internal.RelativeLocation::sameLocation (96 bytes)Event: 3036.152 Thread 0x0000000008c95000 nmethod 2946 0x0000000002f805d0 code [0x0000000002f80740, 0x0000000002f80958]Event: 3036.169 Thread 0x0000000008c90000 2947 java.nio.CharBuffer::put (39 bytes)Event: 3036.187 Thread 0x0000000008c90000 nmethod 2947 0x0000000002fd8310 code [0x0000000002fd8480, 0x0000000002fd8cb8]Event: 3036.187 Thread 0x0000000008c95000 2948 org.eclipse.core.runtime.ProgressMonitorWrapper::isCanceled (10 bytes)Event: 3036.188 Thread 0x0000000008c95000 nmethod 2948 0x0000000002f81f50 code [0x0000000002f820a0, 0x0000000002f82118]Event: 3036.227 Thread 0x0000000008c95000 2949 org.eclipse.core.internal.resources.Folder::getType (2 bytes)Event: 3036.228 Thread 0x0000000008c95000 nmethod 2949 0x0000000002f81d50 code [0x0000000002f81e80, 0x0000000002f81ed8]GC Heap History (10 events):Event: 2949.839 GC heap before{Heap before GC invocations=122 (full 53): PSYoungGen total 193536K, used 64K [0x00000000eaa80000, 0x00000000f6a00000, 0x0000000100000000) eden space 190976K, 0% used [0x00000000eaa80000,0x00000000eaa80000,0x00000000f6500000) from space 2560K, 2% used [0x00000000f6500000,0x00000000f6510000,0x00000000f6780000) to space 2560K, 0% used [0x00000000f6780000,0x00000000f6780000,0x00000000f6a00000) ParOldGen total 162304K, used 75738K [0x00000000c0000000, 0x00000000c9e80000, 0x00000000eaa80000) object space 162304K, 46% used [0x00000000c0000000,0x00000000c49f6a28,0x00000000c9e80000) PSPermGen total 114176K, used 114050K [0x00000000b0000000, 0x00000000b6f80000, 0x00000000c0000000) object space 114176K, 99% used [0x00000000b0000000,0x00000000b6f60bb0,0x00000000b6f80000)Event: 2950.129 GC heap afterHeap after GC invocations=122 (full 53): PSYoungGen total 193536K, used 0K [0x00000000eaa80000, 0x00000000f6a00000, 0x0000000100000000) eden space 190976K, 0% used [0x00000000eaa80000,0x00000000eaa80000,0x00000000f6500000) from space 2560K, 0% used [0x00000000f6500000,0x00000000f6500000,0x00000000f6780000) to space 2560K, 0% used [0x00000000f6780000,0x00000000f6780000,0x00000000f6a00000) ParOldGen total 162304K, used 75738K [0x00000000c0000000, 0x00000000c9e80000, 0x00000000eaa80000) object space 162304K, 46% used [0x00000000c0000000,0x00000000c49f6a28,0x00000000c9e80000) PSPermGen total 114176K, used 114050K [0x00000000b0000000, 0x00000000b6f80000, 0x00000000c0000000) object space 114176K, 99% used [0x00000000b0000000,0x00000000b6f60bb0,0x00000000b6f80000)}Event: 3009.838 GC heap before{Heap before GC invocations=123 (full 53): PSYoungGen total 193536K, used 6816K [0x00000000eaa80000, 0x00000000f6a00000, 0x0000000100000000) eden space 190976K, 3% used [0x00000000eaa80000,0x00000000eb1283b8,0x00000000f6500000) from space 2560K, 0% used [0x00000000f6500000,0x00000000f6500000,0x00000000f6780000) to space 2560K, 0% used [0x00000000f6780000,0x00000000f6780000,0x00000000f6a00000) ParOldGen total 162304K, used 75738K [0x00000000c0000000, 0x00000000c9e80000, 0x00000000eaa80000) object space 162304K, 46% used [0x00000000c0000000,0x00000000c49f6a28,0x00000000c9e80000) PSPermGen total 114176K, used 114050K [0x00000000b0000000, 0x00000000b6f80000, 0x00000000c0000000) object space 114176K, 99% used [0x00000000b0000000,0x00000000b6f60bb0,0x00000000b6f80000)Event: 3009.847 GC heap afterHeap after GC invocations=123 (full 53): PSYoungGen total 192512K, used 64K [0x00000000eaa80000, 0x00000000f6900000, 0x0000000100000000) eden space 190976K, 0% used [0x00000000eaa80000,0x00000000eaa80000,0x00000000f6500000) from space 1536K, 4% used [0x00000000f6780000,0x00000000f6790000,0x00000000f6900000) to space 2048K, 0% used [0x00000000f6500000,0x00000000f6500000,0x00000000f6700000) ParOldGen total 162304K, used 75738K [0x00000000c0000000, 0x00000000c9e80000, 0x00000000eaa80000) object space 162304K, 46% used [0x00000000c0000000,0x00000000c49f6a28,0x00000000c9e80000) PSPermGen total 114176K, used 114050K [0x00000000b0000000, 0x00000000b6f80000, 0x00000000c0000000) object space 114176K, 99% used [0x00000000b0000000,0x00000000b6f60bb0,0x00000000b6f80000)}Event: 3009.847 GC heap before{Heap before GC invocations=124 (full 54): PSYoungGen total 192512K, used 64K [0x00000000eaa80000, 0x00000000f6900000, 0x0000000100000000) eden space 190976K, 0% used [0x00000000eaa80000,0x00000000eaa80000,0x00000000f6500000) from space 1536K, 4% used [0x00000000f6780000,0x00000000f6790000,0x00000000f6900000) to space 2048K, 0% used [0x00000000f6500000,0x00000000f6500000,0x00000000f6700000) ParOldGen total 162304K, used 75738K [0x00000000c0000000, 0x00000000c9e80000, 0x00000000eaa80000) object space 162304K, 46% used [0x00000000c0000000,0x00000000c49f6a28,0x00000000c9e80000) PSPermGen total 114176K, used 114050K [0x00000000b0000000, 0x00000000b6f80000, 0x00000000c0000000) object space 114176K, 99% used [0x00000000b0000000,0x00000000b6f60bb0,0x00000000b6f80000)Event: 3010.127 GC heap afterHeap after GC invocations=124 (full 54): PSYoungGen total 192512K, used 0K [0x00000000eaa80000, 0x00000000f6900000, 0x0000000100000000) eden space 190976K, 0% used [0x00000000eaa80000,0x00000000eaa80000,0x00000000f6500000) from space 1536K, 0% used [0x00000000f6780000,0x00000000f6780000,0x00000000f6900000) to space 2048K, 0% used [0x00000000f6500000,0x00000000f6500000,0x00000000f6700000) ParOldGen total 162304K, used 75738K [0x00000000c0000000, 0x00000000c9e80000, 0x00000000eaa80000) object space 162304K, 46% used [0x00000000c0000000,0x00000000c49f6a28,0x00000000c9e80000) PSPermGen total 114176K, used 114050K [0x00000000b0000000, 0x00000000b6f80000, 0x00000000c0000000) object space 114176K, 99% used [0x00000000b0000000,0x00000000b6f60b90,0x00000000b6f80000)}Event: 3031.880 GC heap before{Heap before GC invocations=125 (full 54): PSYoungGen total 192512K, used 190976K [0x00000000eaa80000, 0x00000000f6900000, 0x0000000100000000) eden space 190976K, 100% used [0x00000000eaa80000,0x00000000f6500000,0x00000000f6500000) from space 1536K, 0% used [0x00000000f6780000,0x00000000f6780000,0x00000000f6900000) to space 2048K, 0% used [0x00000000f6500000,0x00000000f6500000,0x00000000f6700000) ParOldGen total 162304K, used 75738K [0x00000000c0000000, 0x00000000c9e80000, 0x00000000eaa80000) object space 162304K, 46% used [0x00000000c0000000,0x00000000c49f6a28,0x00000000c9e80000) PSPermGen total 123392K, used 122902K [0x00000000b0000000, 0x00000000b7880000, 0x00000000c0000000) object space 123392K, 99% used [0x00000000b0000000,0x00000000b7805920,0x00000000b7880000)Event: 3031.903 GC heap afterHeap after GC invocations=125 (full 54): PSYoungGen total 193024K, used 2043K [0x00000000eaa80000, 0x00000000f8600000, 0x0000000100000000) eden space 190976K, 0% used [0x00000000eaa80000,0x00000000eaa80000,0x00000000f6500000) from space 2048K, 99% used [0x00000000f6500000,0x00000000f66fef48,0x00000000f6700000) to space 10240K, 0% used [0x00000000f7c00000,0x00000000f7c00000,0x00000000f8600000) ParOldGen total 162304K, used 96317K [0x00000000c0000000, 0x00000000c9e80000, 0x00000000eaa80000) object space 162304K, 59% used [0x00000000c0000000,0x00000000c5e0f4d8,0x00000000c9e80000) PSPermGen total 123392K, used 122902K [0x00000000b0000000, 0x00000000b7880000, 0x00000000c0000000) object space 123392K, 99% used [0x00000000b0000000,0x00000000b7805920,0x00000000b7880000)}Event: 3034.040 GC heap before{Heap before GC invocations=126 (full 54): PSYoungGen total 193024K, used 193019K [0x00000000eaa80000, 0x00000000f8600000, 0x0000000100000000) eden space 190976K, 100% used [0x00000000eaa80000,0x00000000f6500000,0x00000000f6500000) from space 2048K, 99% used [0x00000000f6500000,0x00000000f66fef48,0x00000000f6700000) to space 10240K, 0% used [0x00000000f7c00000,0x00000000f7c00000,0x00000000f8600000) ParOldGen total 162304K, used 96317K [0x00000000c0000000, 0x00000000c9e80000, 0x00000000eaa80000) object space 162304K, 59% used [0x00000000c0000000,0x00000000c5e0f4d8,0x00000000c9e80000) PSPermGen total 123904K, used 123856K [0x00000000b0000000, 0x00000000b7900000, 0x00000000c0000000) object space 123904K, 99% used [0x00000000b0000000,0x00000000b78f4058,0x00000000b7900000)Event: 3034.064 GC heap afterHeap after GC invocations=126 (full 54): PSYoungGen total 209920K, used 10233K [0x00000000eaa80000, 0x00000000f9080000, 0x0000000100000000) eden space 199680K, 0% used [0x00000000eaa80000,0x00000000eaa80000,0x00000000f6d80000) from space 10240K, 99% used [0x00000000f7c00000,0x00000000f85fe510,0x00000000f8600000) to space 14848K, 0% used [0x00000000f6d80000,0x00000000f6d80000,0x00000000f7c00000) ParOldGen total 162304K, used 102389K [0x00000000c0000000, 0x00000000c9e80000, 0x00000000eaa80000) object space 162304K, 63% used [0x00000000c0000000,0x00000000c63fd688,0x00000000c9e80000) PSPermGen total 123904K, used 123856K [0x00000000b0000000, 0x00000000b7900000, 0x00000000c0000000) object space 123904K, 99% used [0x00000000b0000000,0x00000000b78f4058,0x00000000b7900000)}Deoptimization events (10 events):Event: 3034.219 Thread 0x000000000c383800 Uncommon trap: reason=unreached action=reinterpret pc=0x0000000002f33f40 method=org.eclipse.wst.xml.core.internal.parser.XMLSourceParser.parseNodes()Lorg/eclipse/wst/sse/core/internal/provisional/text/IStructuredDocumentRegion; @ 296Event: 3034.220 Thread 0x000000000c383800 Uncommon trap: reason=class_check action=maybe_recompile pc=0x0000000002fdfef0 method=org.eclipse.wst.xml.core.internal.document.NodeImpl.getStartOffset()I @ 76Event: 3034.220 Thread 0x000000000c383800 Uncommon trap: reason=class_check action=maybe_recompile pc=0x0000000002fdfef0 method=org.eclipse.wst.xml.core.internal.document.NodeImpl.getStartOffset()I @ 76Event: 3034.220 Thread 0x000000000c383800 Uncommon trap: reason=class_check action=maybe_recompile pc=0x0000000002fdfef0 method=org.eclipse.wst.xml.core.internal.document.NodeImpl.getStartOffset()I @ 76Event: 3034.220 Thread 0x000000000c383800 Uncommon trap: reason=class_check action=maybe_recompile pc=0x0000000002fdfef0 method=org.eclipse.wst.xml.core.internal.document.NodeImpl.getStartOffset()I @ 76Event: 3034.469 Thread 0x000000000c383800 Uncommon trap: reason=null_check action=make_not_entrant pc=0x0000000002ff9eec method=org.eclipse.jetty.io.BufferCache.get(Lorg/eclipse/jetty/io/Buffer;)Lorg/eclipse/jetty/io/BufferCache$CachedBuffer; @ 8Event: 3034.905 Thread 0x000000000c383000 Uncommon trap: reason=null_check action=make_not_entrant pc=0x000000000300f45c method=org.eclipse.jetty.io.BufferCache.getBest([BII)Lorg/eclipse/jetty/io/BufferCache$CachedBuffer; @ 24Event: 3034.920 Thread 0x000000000c383800 Uncommon trap: reason=null_check action=make_not_entrant pc=0x0000000003006234 method=org.eclipse.jetty.io.BufferCache.getBest([BII)Lorg/eclipse/jetty/io/BufferCache$CachedBuffer; @ 24Event: 3036.084 Thread 0x000000000c385000 Uncommon trap: reason=bimorphic action=maybe_recompile pc=0x0000000002b38b20 method=org.eclipse.core.internal.localstore.UnifiedTree.addChildren(Lorg/eclipse/core/internal/localstore/UnifiedTreeNode;)V @ 9Event: 3036.164 Thread 0x000000000c383800 Uncommon trap: reason=unreached action=reinterpret pc=0x0000000002d27dac method=org.eclipse.jetty.util.StringMap.getBestEntry([BII)Ljava/util/Map$Entry; @ 91Internal exceptions (10 events):Event: 3033.489 Thread 0x000000000051f000 Threw 0x00000000f3c9f7f8 at C:\re\jdk7u51\527\hotspot\src\share\vm\prims\jvm.cpp:1244Event: 3033.489 Thread 0x000000000051f000 Threw 0x00000000f3c9fd30 at C:\re\jdk7u51\527\hotspot\src\share\vm\classfile\systemDictionary.cpp:185Event: 3033.490 Thread 0x000000000051f000 Threw 0x00000000f3ca04a0 at C:\re\jdk7u51\527\hotspot\src\share\vm\prims\jvm.cpp:1244Event: 3033.490 Thread 0x000000000051f000 Threw 0x00000000f3ca1898 at C:\re\jdk7u51\527\hotspot\src\share\vm\prims\jvm.cpp:1244Event: 3033.905 Thread 0x000000000c387800 Implicit null exception at 0x0000000002d92ac0 to 0x0000000002d93185Event: 3034.219 Thread 0x000000000c383800 Implicit null exception at 0x0000000002ee2880 to 0x0000000002ee2bc1Event: 3034.469 Thread 0x000000000c383800 Implicit null exception at 0x0000000002ff7c58 to 0x0000000002ff9ee1Event: 3034.905 Thread 0x000000000c383000 Implicit null exception at 0x000000000300ce1c to 0x000000000300f44fEvent: 3034.920 Thread 0x000000000c383800 Implicit null exception at 0x000000000300426c to 0x0000000003006211Event: 3036.164 Thread 0x000000000c383800 Implicit null exception at 0x0000000002d27b16 to 0x0000000002d27d79Events (10 events):Event: 3036.084 Thread 0x000000000c385000 Uncommon trap: trap_request=0xffffffc6 fr.pc=0x0000000002b38b20Event: 3036.084 Thread 0x000000000c385000 DEOPT PACKING pc=0x0000000002b38b20 sp=0x0000000012dae800Event: 3036.084 Thread 0x000000000c385000 DEOPT UNPACKING pc=0x00000000027275a4 sp=0x0000000012dae798 mode 2Event: 3036.164 Thread 0x000000000c383800 Uncommon trap: trap_request=0xffffffad fr.pc=0x0000000002d27dacEvent: 3036.164 Thread 0x000000000c383800 DEOPT PACKING pc=0x0000000002d27dac sp=0x0000000014dceef0Event: 3036.164 Thread 0x000000000c383800 DEOPT UNPACKING pc=0x00000000027275a4 sp=0x0000000014dcee70 mode 2Event: 3036.247 Executing VM operation: RevokeBiasEvent: 3036.249 Executing VM operation: RevokeBias doneEvent: 3036.251 Executing VM operation: RevokeBiasEvent: 3036.251 Executing VM operation: RevokeBias doneDynamic libraries:0x000000013f700000 - 0x000000013f733000 C:\windows\system32\javaw.exe0x0000000077970000 - 0x0000000077b19000 C:\windows\SYSTEM32\ntdll.dll0x0000000077750000 - 0x000000007786f000 C:\windows\system32\kernel32.dll0x000007fefdb10000 - 0x000007fefdb7b000 C:\windows\system32\KERNELBASE.dll0x0000000075500000 - 0x0000000075587000 C:\windows\System32\SYSFER.DLL0x000007fefdb80000 - 0x000007fefdc5b000 C:\windows\system32\ADVAPI32.dll0x000007feff660000 - 0x000007feff6ff000 C:\windows\system32\msvcrt.dll0x000007feff700000 - 0x000007feff71f000 C:\windows\SYSTEM32\sechost.dll0x000007feffb20000 - 0x000007feffc4d000 C:\windows\system32\RPCRT4.dll0x0000000077870000 - 0x000000007796a000 C:\windows\system32\USER32.dll0x000007fefe2e0000 - 0x000007fefe347000 C:\windows\system32\GDI32.dll0x000007fefe170000 - 0x000007fefe17e000 C:\windows\system32\LPK.dll0x000007feff730000 - 0x000007feff7f9000 C:\windows\system32\USP10.dll0x000007fefc780000 - 0x000007fefc974000 C:\windows\WinSxS\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.7601.17514_none_fa396087175ac9ac\COMCTL32.dll0x000007fefe410000 - 0x000007fefe481000 C:\windows\system32\SHLWAPI.dll0x000007feffc50000 - 0x000007feffc7e000 C:\windows\system32\IMM32.DLL0x000007feff550000 - 0x000007feff659000 C:\windows\system32\MSCTF.dll0x0000000063a30000 - 0x0000000063b02000 C:\Program Files\Java\jre7\bin\msvcr100.dll0x000000005e2a0000 - 0x000000005ea69000 C:\Program Files\Java\jre7\bin\server\jvm.dll0x000007fefaf30000 - 0x000007fefaf39000 C:\windows\system32\WSOCK32.dll0x000007fefdc60000 - 0x000007fefdcad000 C:\windows\system32\WS2_32.dll0x000007feff720000 - 0x000007feff728000 C:\windows\system32\NSI.dll0x000007fefae10000 - 0x000007fefae4b000 C:\windows\system32\WINMM.dll0x0000000077b40000 - 0x0000000077b47000 C:\windows\system32\PSAPI.DLL0x0000000074440000 - 0x000000007444f000 C:\Program Files\Java\jre7\bin\verify.dll0x00000000646c0000 - 0x00000000646e8000 C:\Program Files\Java\jre7\bin\java.dll0x0000000064370000 - 0x0000000064385000 C:\Program Files\Java\jre7\bin\zip.dll0x000007fefd180000 - 0x000007fefd197000 C:\windows\system32\CRYPTSP.dll0x000007fefcdb0000 - 0x000007fefcdf7000 C:\windows\system32\rsaenh.dll0x000007fefca60000 - 0x000007fefca7e000 C:\windows\system32\USERENV.dll0x000007fefd750000 - 0x000007fefd75f000 C:\windows\system32\profapi.dll0x000007fefd680000 - 0x000007fefd68f000 C:\windows\system32\CRYPTBASE.dll0x00000000640e0000 - 0x00000000640f9000 C:\Program Files\Java\jre7\bin\net.dll0x000007fefcfa0000 - 0x000007fefcff5000 C:\windows\system32\mswsock.dll0x000007fefd010000 - 0x000007fefd017000 C:\windows\System32\wship6.dll0x000007fefb5d0000 - 0x000007fefb5e5000 C:\windows\system32\NLAapi.dll0x000007fef2800000 - 0x000007fef2815000 C:\windows\system32\napinsp.dll0x000007fef27e0000 - 0x000007fef27f9000 C:\windows\system32\pnrpnsp.dll0x000007fefce30000 - 0x000007fefce8b000 C:\windows\system32\DNSAPI.dll0x000007fef27d0000 - 0x000007fef27db000 C:\windows\System32\winrnr.dll0x000007fef2da0000 - 0x000007fef2db0000 C:\windows\system32\wshbth.dll0x0000000073eb0000 - 0x0000000073ed6000 C:\Program Files\Bonjour\mdnsNSP.dll0x000007fefb1d0000 - 0x000007fefb1f7000 C:\windows\system32\Iphlpapi.DLL0x000007fefb1c0000 - 0x000007fefb1cb000 C:\windows\system32\WINNSI.DLL0x000007fefc620000 - 0x000007fefc627000 C:\windows\System32\wshtcpip.dll0x000007fef1520000 - 0x000007fef1528000 C:\windows\system32\rasadhlp.dll0x000007fefa640000 - 0x000007fefa693000 C:\windows\System32\fwpuclnt.dll0x0000000063450000 - 0x0000000063461000 C:\Program Files\Java\jre7\bin\nio.dll0x0000000072000000 - 0x0000000072012000 C:\Navnidhi\Software\eclipse\plugins\org.eclipse.equinox.launcher.win32.win32.x86_64_1.1.200.v20120913-144807\eclipse_1503.dll0x000007fefc550000 - 0x000007fefc55c000 C:\windows\system32\VERSION.dll0x000007fefbc50000 - 0x000007fefbca6000 C:\windows\system32\uxtheme.dll0x000007fefb070000 - 0x000007fefb080000 C:\windows\system32\PGPhk.dll0x000007fef2d30000 - 0x000007fef2d6f000 C:\Program Files\ThinkPad\Bluetooth Software\btmmhook.dll0x000007fefe490000 - 0x000007feff218000 C:\windows\system32\SHELL32.dll0x000007feff340000 - 0x000007feff543000 C:\windows\system32\ole32.dll0x000007feff800000 - 0x000007feff8d7000 C:\windows\system32\OLEAUT32.dll0x0000000010000000 - 0x00000000100a8000 C:\Navnidhi\Software\eclipse\configuration\org.eclipse.osgi\bundles\636\1\.cp\swt-win32-4236.dll0x000007fefe350000 - 0x000007fefe3e7000 C:\windows\system32\comdlg32.dll0x000007fefaeb0000 - 0x000007fefaf21000 C:\windows\system32\WINSPOOL.DRV0x000007fefdcb0000 - 0x000007fefdedd000 C:\windows\system32\WININET.dll0x000007fefdb00000 - 0x000007fefdb04000 C:\windows\system32\api-ms-win-downlevel-user32-l1-1-0.dll0x000007fefd820000 - 0x000007fefd825000 C:\windows\system32\api-ms-win-downlevel-advapi32-l1-1-0.dll0x000007fefd830000 - 0x000007fefd834000 C:\windows\system32\api-ms-win-downlevel-shlwapi-l1-1-0.dll0x000007fefd9c0000 - 0x000007fefd9c4000 C:\windows\system32\api-ms-win-downlevel-version-l1-1-0.dll0x000007fefdaf0000 - 0x000007fefdaf3000 C:\windows\system32\api-ms-win-downlevel-normaliz-l1-1-0.dll0x0000000077b30000 - 0x0000000077b33000 C:\windows\system32\normaliz.DLL0x000007fefdee0000 - 0x000007fefe16c000 C:\windows\system32\iertutil.dll0x000007fefd840000 - 0x000007fefd9aa000 C:\windows\system32\CRYPT32.dll0x000007fefd7f0000 - 0x000007fefd7ff000 C:\windows\system32\MSASN1.dll0x000007fefbb90000 - 0x000007fefbba8000 C:\windows\system32\dwmapi.dll0x000007fefbde0000 - 0x000007fefbf0c000 C:\windows\system32\propsys.dll0x000007feff220000 - 0x000007feff2b9000 C:\windows\system32\CLBCatQ.DLL0x0000000005c60000 - 0x0000000005c7e000 C:\Navnidhi\Software\eclipse\configuration\org.eclipse.osgi\bundles\636\1\.cp\swt-gdip-win32-4236.dll0x000007fefb950000 - 0x000007fefbb66000 C:\windows\WinSxS\amd64_microsoft.windows.gdiplus_6595b64144ccf1df_1.1.7601.18120_none_2b25b14c71ebf230\gdiplus.dll0x000007fefb260000 - 0x000007fefb3c1000 C:\windows\system32\WindowsCodecs.dll0x0000000180000000 - 0x0000000180011000 C:\Navnidhi\Software\eclipse\configuration\org.eclipse.osgi\bundles\72\1\.cp\os\win32\x86_64\localfile_1_0_0.dll0x0000000005e00000 - 0x0000000005e06000 C:\Navnidhi\Software\eclipse\configuration\org.eclipse.osgi\bundles\945\1\.cp\os\win32\x86_64\fsnatives.dll0x000007fef4d70000 - 0x000007fef4d81000 C:\Navnidhi\Software\eclipse\configuration\org.eclipse.osgi\bundles\75\1\.cp\jWinHttp-1.0.0.dll0x000007fefa4a0000 - 0x000007fefa511000 C:\windows\system32\WINHTTP.dll0x000007fefa430000 - 0x000007fefa494000 C:\windows\system32\webio.dll0x000007fefa5b0000 - 0x000007fefa5c1000 C:\windows\system32\dhcpcsvc6.DLL0x000007fefa620000 - 0x000007fefa638000 C:\windows\system32\dhcpcsvc.DLL0x000007fefae50000 - 0x000007fefaea4000 C:\windows\system32\oleacc.dll0x00000000633f0000 - 0x0000000063414000 C:\Program Files\Java\jre7\bin\sunec.dll0x0000000074350000 - 0x000000007435b000 C:\Program Files\Java\jre7\bin\sunmscapi.dll0x000007fefd730000 - 0x000007fefd744000 C:\windows\system32\RpcRtRemote.dll0x000007fef0100000 - 0x000007fef013b000 C:\windows\system32\mlang.dll0x000007feec760000 - 0x000007feed618000 C:\Windows\System32\ieframe.dll0x000007fefd9b0000 - 0x000007fefd9b4000 C:\windows\system32\api-ms-win-downlevel-ole32-l1-1-0.dll0x000007fef8940000 - 0x000007fef8944000 C:\Windows\System32\api-ms-win-downlevel-shlwapi-l2-1-0.dll0x000007fef9650000 - 0x000007fef9654000 C:\Windows\System32\api-ms-win-downlevel-advapi32-l2-1-0.dll0x000007fef5d10000 - 0x000007fef5d14000 C:\Windows\System32\api-ms-win-downlevel-shell32-l1-1-0.dll0x000007fefe180000 - 0x000007fefe2d9000 C:\windows\system32\urlmon.dll0x000007fefd690000 - 0x000007fefd721000 C:\windows\system32\SXS.DLL0x000007fefd620000 - 0x000007fefd677000 C:\windows\system32\apphelp.dll0x000007fefd2d0000 - 0x000007fefd2db000 C:\windows\system32\Secur32.dll0x000007fefd5f0000 - 0x000007fefd615000 C:\windows\system32\SSPICLI.DLL0x000007feea6e0000 - 0x000007feeb949000 C:\Windows\System32\mshtml.dll0x000007fefd000000 - 0x000007fefd007000 C:\windows\system32\msimg32.dll0x000007fefc060000 - 0x000007fefc06e000 C:\windows\system32\msimtf.dll0x000007fef0610000 - 0x000007fef06ca000 C:\Windows\system32\uiautomationcore.dll0x000007feee7e0000 - 0x000007feeeba4000 C:\windows\system32\d2d1.dll0x000007fef03f0000 - 0x000007fef0586000 C:\windows\system32\DWrite.dll0x000007fef93f0000 - 0x000007fef944d000 C:\windows\system32\dxgi.dll0x000007fefdab0000 - 0x000007fefdae9000 C:\windows\system32\WINTRUST.dll0x000007fef8e40000 - 0x000007fef9015000 C:\windows\system32\d3d11.dll0x000007feeddf0000 - 0x000007feee069000 C:\windows\system32\D3D10Warp.dll0x000007fef9660000 - 0x000007fef982a000 C:\windows\system32\explorerframe.dll0x000007fefbc00000 - 0x000007fefbc43000 C:\windows\system32\DUser.dll0x000007fefb850000 - 0x000007fefb942000 C:\windows\system32\DUI70.dll0x000007fefb820000 - 0x000007fefb84d000 C:\windows\system32\ntmarta.dll0x000007feffac0000 - 0x000007feffb12000 C:\windows\system32\WLDAP32.dll0x000007feff8e0000 - 0x000007feffab7000 C:\windows\system32\SETUPAPI.dll0x000007fefd9d0000 - 0x000007fefda06000 C:\windows\system32\CFGMGR32.dll0x000007fefd800000 - 0x000007fefd81a000 C:\windows\system32\DEVOBJ.dll0x000007fef5230000 - 0x000007fef529d000 C:\Program Files\ThinkPad\Bluetooth Software\btncopy.dll0x000007fef8dc0000 - 0x000007fef8e40000 C:\windows\system32\ntshrui.dll0x000007fefd1f0000 - 0x000007fefd213000 C:\windows\system32\srvcli.dll0x000007fefa7d0000 - 0x000007fefa7df000 C:\windows\system32\cscapi.dll0x000007fefb480000 - 0x000007fefb48b000 C:\windows\system32\slc.dll0x000007fefacd0000 - 0x000007fefacdc000 C:\windows\system32\netutils.dll0x000007fef84c0000 - 0x000007fef84cc000 C:\windows\system32\LINKINFO.dll0x000007fef0a70000 - 0x000007fef0a8d000 C:\windows\system32\mssprxy.dll0x000007feed7c0000 - 0x000007feedb8e000 C:\windows\System32\jscript9.dll0x000007fef8760000 - 0x000007fef8799000 C:\windows\system32\msls31.dll0x000007fefbf10000 - 0x000007fefbf5b000 C:\windows\system32\MMDevAPI.DLL0x000007fef4c90000 - 0x000007fef4ccb000 C:\windows\system32\wdmaud.drv0x00000000714c0000 - 0x00000000714c6000 C:\windows\system32\ksuser.dllVM Arguments:jvm_args: -Dosgi.requiredJavaVersion=1.5 -Dhelp.lucene.tokenizer=standard -Xms40m -Xmx1024m -XX:MaxPermSize=256m java_command: C:\Navnidhi\Software\eclipse\\plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar -os win32 -ws win32 -arch x86_64 -showsplash C:\Navnidhi\Software\eclipse\\plugins\org.eclipse.platform_4.2.2.v201302041200\splash.bmp -launcher C:\Navnidhi\Software\eclipse\eclipse.exe -name Eclipse --launcher.library C:\Navnidhi\Software\eclipse\\plugins/org.eclipse.equinox.launcher.win32.win32.x86_64_1.1.200.v20120913-144807\eclipse_1503.dll -startup C:\Navnidhi\Software\eclipse\\plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar --launcher.overrideVmargs -exitdata 1afc_60 -product org.eclipse.epp.package.jee.product -vm C:\windows\system32\javaw.exe -vmargs -Dosgi.requiredJavaVersion=1.5 -Dhelp.lucene.tokenizer=standard -Xms40m -Xmx1024m -XX:MaxPermSize=256m -jar C:\Navnidhi\Software\eclipse\\plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jarLauncher Type: SUN_STANDARDEnvironment Variables:JAVA_HOME=C:\Program Files\Java\jdk1.7.0_51CLASSPATH=C:\Program Files\Java\jdk1.7.0_51\binPATH=C:\windows\system32;C:\windows;C:\windows\System32\Wbem;C:\windows\System32\WindowsPowerShell\v1.0\;C:\Program Files\ThinkPad\Bluetooth Software\;C:\Program Files\ThinkPad\Bluetooth Software\syswow64;C:\Program Files\Intel\WiFi\bin\;C:\Program Files\Common Files\Intel\WirelessCommon\;C:\Program Files (x86)\Lenovo\Access Connections\;C:\Program Files (x86)\IBM\Personal Communications\;C:\Program Files (x86)\IBM\Trace Facility\;C:\Program Files (x86)\IBM\Mobility Client\;C:\Program Files (x86)\Common Files\Roxio Shared\DLLShared\;C:\Program Files (x86)\Common Files\Roxio Shared\DLLShared\;C:\Program Files (x86)\Common Files\Roxio Shared\13.0\DLLShared\;C:\Program Files\Java\jdk1.7.0_51\bin;C:\Program Files\nodejs\;C:\Navnidhi\WaitroseProject\apache-ant-1.8.1-bin\apache-ant-1.8.1\bin;C:\Program Files (x86)\QuickTime\QTSystem\;C:\Program Files\Intel\WiFi\bin\;C:\Program Files\Common Files\Intel\WirelessCommon\;C:\Program Files\Java\jdk1.7.0_51\bin;C:\Users\IBM_ADMIN\AppData\Roaming\npm;C:\Navnidhi\WaitroseProject\apache-ant-1.8.1-bin\apache-ant-1.8.1\binUSERNAME=IBM_ADMINOS=Windows_NTPROCESSOR_IDENTIFIER=Intel64 Family 6 Model 42 Stepping 7, GenuineIntel--------------- S Y S T E M ---------------OS: Windows 7 , 64 bit Build 7601 Service Pack 1CPU:total 4 (2 cores per cpu, 2 threads per core) family 6 model 42 stepping 7, cmov, cx8, fxsr, mmx, sse, sse2, sse3, ssse3, sse4.1, sse4.2, popcnt, avx, aes, ht, tsc, tscinvbitMemory: 4k page, physical 7952408k(3973876k free), swap 15902932k(11772924k free)vm_info: Java HotSpot(TM) 64-Bit Server VM (24.51-b03) for windows-amd64 JRE (1.7.0_51-b13), built on Dec 18 2013 18:40:56 by "java_re" with unknown MS VC++:1600time: Mon Mar 10 11:06:17 2014elapsed time: 3036 secondsPlease find the log file text:## A fatal error has been detected by the Java Runtime Environment:## EXCEPTION_ACCESS_VIOLATION (0xc0000005) at pc=0x000007feed82af15, pid=8064, tid=1644## JRE version: Java(TM) SE Runtime Environment (7.0_51-b13) (build 1.7.0_51-b13)# Java VM: Java HotSpot(TM) 64-Bit Server VM (24.51-b03 mixed mode windows-amd64 compressed oops)# Problematic frame:# C [jscript9.dll+0x6af15]## Failed to write core dump. Minidumps are not enabled by default on client versions of Windows## If you would like to submit a bug report, please visit:## The crash happened outside the Java Virtual Machine in native code.# See problematic frame for where to report the bug.#--------------- T H R E A D ---------------Current thread (0x000000000051f000): JavaThread "main" [_thread_in_native, id=1644, stack(0x00000000025f0000,0x00000000026f0000)]siginfo: ExceptionCode=0xc0000005, reading address 0x0000000000000084Registers:RAX=0x000000001d018c03, RBX=0x000000000000000d, RCX=0x0000000000000000, RDX=0x0000000000000028RSP=0x00000000026ec2c0, RBP=0x00000000026ec339, RSI=0x000000001d018c03, RDI=0x000000001f0e57b0R8 =0x000000001d018c06, R9 =0x0000000000000080, R10=0x000000000000fffd, R11=0x0000000000000000R12=0x000000000000000d, R13=0x000000001d018c05, R14=0x000000001f0e57b8, R15=0x000000001d01987fRIP=0x000007feed82af15, EFLAGS=0x0000000000010246Top of Stack: (sp=0x00000000026ec2c0)0x00000000026ec2c0: 000000001f0e57b0 00000000026ec3180x00000000026ec2d0: 000007feed7c0000 00000000000000180x00000000026ec2e0: 0000000000000003 00000000000010080x00000000026ec2f0: 0000000021b2a360 000000001f0e52600x00000000026ec300: 00000000007244d0 00000000000000000x00000000026ec310: 0000000000000600 000000001d018c060x00000000026ec320: 000000001d018be5 000007fe000000280x00000000026ec330: 0000000000000000 00000000000006080x00000000026ec340: 000000001f0d0190 00000000000008000x00000000026ec350: 0000000021ae5780 000007feed89bbbd0x00000000026ec360: 000000001f0e57b0 00000000000000000x00000000026ec370: 0000000000000001 000000001f0e52600x00000000026ec380: 0000000000000081 00000000026ec3e00x00000000026ec390: 00000000026ec460 000007feed9b97870x00000000026ec3a0: 000000001f0e57b0 00000000026ec3f00x00000000026ec3b0: 000000001f0e57b0 0001000000000003 Instructions: (pc=0x000007feed82af15)0x000007feed82aef5: 09 83 fb 0a 0f 85 20 e4 05 00 48 ff ce f6 87 900x000007feed82af05: 00 00 00 10 0f 85 71 ef fe ff 48 8b 4f 18 8b c60x000007feed82af15: 44 8b 81 84 00 00 00 2b 47 48 41 0f ba e0 0e 730x000007feed82af25: 4d 8b d0 48 8b 81 88 00 00 00 48 3b c2 0f 86 5f Register to memory mapping:RAX=0x000000001d018c03 is an unknown valueRBX=0x000000000000000d is an unknown valueRCX=0x0000000000000000 is an unknown valueRDX=0x0000000000000028 is an unknown valueRSP=0x00000000026ec2c0 is pointing into the stack for thread: 0x000000000051f000RBP=0x00000000026ec339 is pointing into the stack for thread: 0x000000000051f000RSI=0x000000001d018c03 is an unknown valueRDI=0x000000001f0e57b0 is an unknown valueR8 =0x000000001d018c06 is an unknown valueR9 =0x0000000000000080 is an unknown valueR10=0x000000000000fffd is an unknown valueR11=0x0000000000000000 is an unknown valueR12=0x000000000000000d is an unknown valueR13=0x000000001d018c05 is an unknown valueR14=0x000000001f0e57b8 is an unknown valueR15=0x000000001d01987f is an unknown valueStack: [0x00000000025f0000,0x00000000026f0000], sp=0x00000000026ec2c0, free space=1008kNative frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)C [jscript9.dll+0x6af15]Java frames: (J=compiled Java code, j=interpreted, Vv=VM code)j org.eclipse.swt.internal.ole.win32.COM.VtblCall(IJII[J)I+0j org.eclipse.swt.internal.ole.win32.IDispatch.GetTypeInfo(II[J)I+8j org.eclipse.swt.ole.win32.OleAutomation.<init>(Lorg/eclipse/swt/internal/ole/win32/IDispatch;)V+40j org.eclipse.swt.ole.win32.Variant.getAutomation()Lorg/eclipse/swt/ole/win32/OleAutomation;+31j org.eclipse.swt.browser.IE.execute(Ljava/lang/String;)Z+109j org.eclipse.swt.browser.IE$7.handleEvent(Lorg/eclipse/swt/ole/win32/OleEvent;)V+1502j org.eclipse.swt.ole.win32.OleEventTable.sendEvent(Lorg/eclipse/swt/ole/win32/OleEvent;)V+39j org.eclipse.swt.ole.win32.OleEventSink.notifyListener(ILorg/eclipse/swt/ole/win32/OleEvent;)V+34j org.eclipse.swt.ole.win32.OleEventSink.Invoke(IJIIJJJJ)I+152j org.eclipse.swt.ole.win32.OleEventSink.access$1(Lorg/eclipse/swt/ole/win32/OleEventSink;IJIIJJJJ)I+15j org.eclipse.swt.ole.win32.OleEventSink$1.method6([J)J+33j org.eclipse.swt.internal.ole.win32.COMObject.callback6([J)J+52v ~StubRoutines::call_stubJ org.eclipse.swt.internal.win32.OS.DispatchMessageW(Lorg/eclipse/swt/internal/win32/MSG;)Jj org.eclipse.swt.internal.win32.OS.DispatchMessage(Lorg/eclipse/swt/internal/win32/MSG;)J+7j org.eclipse.swt.widgets.Display.readAndDispatch()Z+64j org.eclipse.jface.window.Window.runEventLoop(Lorg/eclipse/swt/widgets/Shell;)V+23j org.eclipse.jface.window.Window.open()I+49j org.eclipse.jface.dialogs.MessageDialog.open()I+1j com.ibm.etools.rpe.internal.ui.SplitPane$21$1.run()V+39j org.eclipse.swt.widgets.RunnableLock.run()V+11J org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Z)ZJ org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run()Vj org.eclipse.core.databinding.observable.Realm.runWithDefault(Lorg/eclipse/core/databinding/observable/Realm;Ljava/lang/Runnable;)V+12j org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(Lorg/eclipse/e4/ui/model/application/MApplicationElement;Lorg/eclipse/e4/core/contexts/IEclipseContext;)Ljava/lang/Object;+57j org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(Lorg/eclipse/e4/ui/model/application/MApplicationElement;)V+20j org.eclipse.ui.internal.Workbench$5.run()V+256j org.eclipse.core.databinding.observable.Realm.runWithDefault(Lorg/eclipse/core/databinding/observable/Realm;Ljava/lang/Runnable;)V+12j org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Lorg/eclipse/swt/widgets/Display;Lorg/eclipse/ui/application/WorkbenchAdvisor;)I+18j org.eclipse.ui.PlatformUI.createAndRunWorkbench(Lorg/eclipse/swt/widgets/Display;Lorg/eclipse/ui/application/WorkbenchAdvisor;)I+2j org.eclipse.ui.internal.ide.application.IDEApplication.start(Lorg/eclipse/equinox/app/IApplicationContext;)Ljava/lang/Object;+108j org.eclipse.equinox.internal.app.EclipseAppHandle.run(Ljava/lang/Object;)Ljava/lang/Object;+135j org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(Ljava/lang/Object;)Ljava/lang/Object;+103j org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(Ljava/lang/Object;)Ljava/lang/Object;+29j org.eclipse.core.runtime.adaptor.EclipseStarter.run(Ljava/lang/Object;)Ljava/lang/Object;+149j org.eclipse.core.runtime.adaptor.EclipseStarter.run([Ljava/lang/String;Ljava/lang/Runnable;)Ljava/lang/Object;+183v ~StubRoutines::call_stubj sun.reflect.NativeMethodAccessorImpl.invoke0(Ljava/lang/reflect/Method;Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+0j sun.reflect.NativeMethodAccessorImpl.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+87j sun.reflect.DelegatingMethodAccessorImpl.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+6j java.lang.reflect.Method.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+57j org.eclipse.equinox.launcher.Main.invokeFramework([Ljava/lang/String;[Ljava/net/URL;)V+211j org.eclipse.equinox.launcher.Main.basicRun([Ljava/lang/String;)V+126j org.eclipse.equinox.launcher.Main.run([Ljava/lang/String;)I+4j org.eclipse.equinox.launcher.Main.main([Ljava/lang/String;)V+10v ~StubRoutines::call_stub--------------- P R O C E S S ---------------Java Threads: ( => current thread ) 0x000000000e282000 JavaThread "Worker-36" [_thread_blocked, id=9160, stack(0x000000001bae0000,0x000000001bbe0000)] 0x0000000008ca0800 JavaThread "Worker-35" [_thread_in_Java, id=7900, stack(0x0000000019c90000,0x0000000019d90000)] 0x0000000008c9d800 JavaThread "Link Indexer worker-0" [_thread_blocked, id=8944, stack(0x0000000019910000,0x0000000019a10000)] 0x0000000008c9f000 JavaThread "Worker-34" [_thread_blocked, id=7312, stack(0x0000000019790000,0x0000000019890000)] 0x0000000008c9e800 JavaThread "Worker-33" [_thread_blocked, id=6832, stack(0x0000000010e50000,0x0000000010f50000)] 0x0000000008c9a800 JavaThread "Worker-32" [_thread_blocked, id=7692, stack(0x00000000127d0000,0x00000000128d0000)] 0x0000000008ca3800 JavaThread "Worker-31" [_thread_blocked, id=3408, stack(0x0000000018450000,0x0000000018550000)] 0x0000000008ca5000 JavaThread "Link Indexer Thread Scheduler-0" [_thread_blocked, id=9028, stack(0x0000000018290000,0x0000000018390000)] 0x000000000c389000 JavaThread "Timer-1" [_thread_blocked, id=9004, stack(0x0000000017d50000,0x0000000017e50000)] 0x000000000c388000 JavaThread "org.eclipse.wst.sse.ui.internal.reconcile.StructuredRegionProcessor" daemon [_thread_blocked, id=8220, stack(0x000000000fdc0000,0x000000000fec0000)] 0x000000000c384800 JavaThread "JavaScript indexing" daemon [_thread_blocked, id=2808, stack(0x0000000017130000,0x0000000017230000)] 0x000000000c383800 JavaThread "qtp880646576-156" [_thread_blocked, id=5032, stack(0x0000000014cd0000,0x0000000014dd0000)] 0x000000000c383000 JavaThread "qtp880646576-155" [_thread_blocked, id=8188, stack(0x0000000014af0000,0x0000000014bf0000)] 0x000000000c387800 JavaThread "qtp880646576-154 Selector0" [_thread_in_native, id=8368, stack(0x0000000014230000,0x0000000014330000)] 0x000000000c386000 JavaThread "qtp880646576-153 Acceptor0:52282" [_thread_in_native, id=7628, stack(0x0000000012e20000,0x0000000012f20000)] 0x000000000c425000 JavaThread "Timer-0" [_thread_blocked, id=8764, stack(0x0000000010bb0000,0x0000000010cb0000)] 0x000000000c385000 JavaThread "Worker-30" [_thread_blocked, id=8980, stack(0x0000000012cb0000,0x0000000012db0000)] 0x000000000e283800 JavaThread "Worker-29" [_thread_blocked, id=6948, stack(0x0000000012570000,0x0000000012670000)] 0x000000000c386800 JavaThread "Worker-24" [_thread_blocked, id=8928, stack(0x00000000126a0000,0x00000000127a0000)] 0x0000000008ca2000 JavaThread "[ThreadPool Manager] - Idle Thread" daemon [_thread_blocked, id=9144, stack(0x0000000018580000,0x0000000018680000)] 0x000000000e283000 JavaThread "MultiThreadedHttpConnectionManager cleanup" daemon [_thread_blocked, id=8616, stack(0x0000000017f10000,0x0000000018010000)] 0x000000000c424800 JavaThread "Java indexing" daemon [_thread_blocked, id=2392, stack(0x0000000012f70000,0x0000000013070000)] 0x000000000c422800 JavaThread "Thread-3" [_thread_in_native, id=6200, stack(0x0000000012460000,0x0000000012560000)] 0x0000000008ca4800 JavaThread "Collaboration Service Job Manager" [_thread_blocked, id=5280, stack(0x0000000012350000,0x0000000012450000)] 0x0000000008ca6000 JavaThread "Bundle File Closer" daemon [_thread_blocked, id=8356, stack(0x00000000109f0000,0x0000000010af0000)] 0x0000000008c9c000 JavaThread "Worker-JM" [_thread_blocked, id=4808, stack(0x000000000d8f0000,0x000000000d9f0000)] 0x0000000008c9b800 JavaThread "[Timer] - Main Queue Handler" daemon [_thread_blocked, id=8644, stack(0x000000000d6e0000,0x000000000d7e0000)] 0x0000000008c9a000 JavaThread "Framework Event Dispatcher" daemon [_thread_blocked, id=4264, stack(0x000000000d470000,0x000000000d570000)] 0x0000000008c99000 JavaThread "Start Level Event Dispatcher" daemon [_thread_blocked, id=1392, stack(0x000000000d120000,0x000000000d220000)] 0x0000000008c98800 JavaThread "State Data Manager" daemon [_thread_blocked, id=6548, stack(0x000000000d230000,0x000000000d330000)] 0x0000000008c97800 JavaThread "Framework Active Thread" [_thread_blocked, id=6716, stack(0x000000000c020000,0x000000000c120000)] 0x0000000008c97000 JavaThread "Service Thread" daemon [_thread_blocked, id=2124, stack(0x000000000a7b0000,0x000000000a8b0000)] 0x0000000008c95000 JavaThread "C2 CompilerThread1" daemon [_thread_blocked, id=2088, stack(0x000000000a6b0000,0x000000000a7b0000)] 0x0000000008c90000 JavaThread "C2 CompilerThread0" daemon [_thread_in_native, id=708, stack(0x0000000009fe0000,0x000000000a0e0000)] 0x0000000008c8f000 JavaThread "Attach Listener" daemon [_thread_blocked, id=8828, stack(0x000000000a430000,0x000000000a530000)] 0x0000000008c88000 JavaThread "Signal Dispatcher" daemon [_thread_blocked, id=8308, stack(0x000000000a310000,0x000000000a410000)] 0x0000000008c34800 JavaThread "Finalizer" daemon [_thread_blocked, id=7144, stack(0x000000000a0f0000,0x000000000a1f0000)] 0x0000000008c2d800 JavaThread "Reference Handler" daemon [_thread_blocked, id=5592, stack(0x0000000009e30000,0x0000000009f30000)]=>0x000000000051f000 JavaThread "main" [_thread_in_native, id=1644, stack(0x00000000025f0000,0x00000000026f0000)]Other Threads: 0x0000000008c27000 VMThread [stack: 0x0000000009cf0000,0x0000000009df0000] [id=7024] 0x000000000a8b8800 WatcherThread [stack: 0x000000000a530000,0x000000000a630000] [id=3760]VM state:not at safepoint (normal execution)VM Mutex/Monitor currently owned by a thread: NoneHeap PSYoungGen total 209920K, used 185883K [0x00000000eaa80000, 0x00000000f9080000, 0x0000000100000000) eden space 199680K, 87% used [0x00000000eaa80000,0x00000000f5608718,0x00000000f6d80000) from space 10240K, 99% used [0x00000000f7c00000,0x00000000f85fe510,0x00000000f8600000) to space 14848K, 0% used [0x00000000f6d80000,0x00000000f6d80000,0x00000000f7c00000) ParOldGen total 162304K, used 102389K [0x00000000c0000000, 0x00000000c9e80000, 0x00000000eaa80000) object space 162304K, 63% used [0x00000000c0000000,0x00000000c63fd688,0x00000000c9e80000) PSPermGen total 124416K, used 124009K [0x00000000b0000000, 0x00000000b7980000, 0x00000000c0000000) object space 124416K, 99% used [0x00000000b0000000,0x00000000b791a568,0x00000000b7980000)Card table byte_map: [0x00000000056f0000,0x0000000005980000] byte_map_base: 0x0000000005170000Polling page: 0x0000000000240000Code Cache [0x00000000026f0000, 0x0000000003020000, 0x00000000056f0000) total_blobs=3453 nmethods=2545 adapters=857 free_code_cache=39940Kb largest_free_block=40706048Compilation events (10 events):Event: 3036.147 Thread 0x0000000008c90000 2945 java.util.LinkedList$Node::<init> (20 bytes)Event: 3036.147 Thread 0x0000000008c90000 nmethod 2945 0x0000000002f80c10 code [0x0000000002f80d40, 0x0000000002f80db8]Event: 3036.148 Thread 0x0000000008c95000 2946 com.ibm.team.filesystem.client.internal.RelativeLocation::sameLocation (96 bytes)Event: 3036.152 Thread 0x0000000008c95000 nmethod 2946 0x0000000002f805d0 code [0x0000000002f80740, 0x0000000002f80958]Event: 3036.169 Thread 0x0000000008c90000 2947 java.nio.CharBuffer::put (39 bytes)Event: 3036.187 Thread 0x0000000008c90000 nmethod 2947 0x0000000002fd8310 code [0x0000000002fd8480, 0x0000000002fd8cb8]Event: 3036.187 Thread 0x0000000008c95000 2948 org.eclipse.core.runtime.ProgressMonitorWrapper::isCanceled (10 bytes)Event: 3036.188 Thread 0x0000000008c95000 nmethod 2948 0x0000000002f81f50 code [0x0000000002f820a0, 0x0000000002f82118]Event: 3036.227 Thread 0x0000000008c95000 2949 org.eclipse.core.internal.resources.Folder::getType (2 bytes)Event: 3036.228 Thread 0x0000000008c95000 nmethod 2949 0x0000000002f81d50 code [0x0000000002f81e80, 0x0000000002f81ed8]GC Heap History (10 events):Event: 2949.839 GC heap before{Heap before GC invocations=122 (full 53): PSYoungGen total 193536K, used 64K [0x00000000eaa80000, 0x00000000f6a00000, 0x0000000100000000) eden space 190976K, 0% used [0x00000000eaa80000,0x00000000eaa80000,0x00000000f6500000) from space 2560K, 2% used [0x00000000f6500000,0x00000000f6510000,0x00000000f6780000) to space 2560K, 0% used [0x00000000f6780000,0x00000000f6780000,0x00000000f6a00000) ParOldGen total 162304K, used 75738K [0x00000000c0000000, 0x00000000c9e80000, 0x00000000eaa80000) object space 162304K, 46% used [0x00000000c0000000,0x00000000c49f6a28,0x00000000c9e80000) PSPermGen total 114176K, used 114050K [0x00000000b0000000, 0x00000000b6f80000, 0x00000000c0000000) object space 114176K, 99% used [0x00000000b0000000,0x00000000b6f60bb0,0x00000000b6f80000)Event: 2950.129 GC heap afterHeap after GC invocations=122 (full 53): PSYoungGen total 193536K, used 0K [0x00000000eaa80000, 0x00000000f6a00000, 0x0000000100000000) eden space 190976K, 0% used [0x00000000eaa80000,0x00000000eaa80000,0x00000000f6500000) from space 2560K, 0% used [0x00000000f6500000,0x00000000f6500000,0x00000000f6780000) to space 2560K, 0% used [0x00000000f6780000,0x00000000f6780000,0x00000000f6a00000) ParOldGen total 162304K, used 75738K [0x00000000c0000000, 0x00000000c9e80000, 0x00000000eaa80000) object space 162304K, 46% used [0x00000000c0000000,0x00000000c49f6a28,0x00000000c9e80000) PSPermGen total 114176K, used 114050K [0x00000000b0000000, 0x00000000b6f80000, 0x00000000c0000000) object space 114176K, 99% used [0x00000000b0000000,0x00000000b6f60bb0,0x00000000b6f80000)}Event: 3009.838 GC heap before{Heap before GC invocations=123 (full 53): PSYoungGen total 193536K, used 6816K [0x00000000eaa80000, 0x00000000f6a00000, 0x0000000100000000) eden space 190976K, 3% used [0x00000000eaa80000,0x00000000eb1283b8,0x00000000f6500000) from space 2560K, 0% used [0x00000000f6500000,0x00000000f6500000,0x00000000f6780000) to space 2560K, 0% used [0x00000000f6780000,0x00000000f6780000,0x00000000f6a00000) ParOldGen total 162304K, used 75738K [0x00000000c0000000, 0x00000000c9e80000, 0x00000000eaa80000) object space 162304K, 46% used [0x00000000c0000000,0x00000000c49f6a28,0x00000000c9e80000) PSPermGen total 114176K, used 114050K [0x00000000b0000000, 0x00000000b6f80000, 0x00000000c0000000) object space 114176K, 99% used [0x00000000b0000000,0x00000000b6f60bb0,0x00000000b6f80000)Event: 3009.847 GC heap afterHeap after GC invocations=123 (full 53): PSYoungGen total 192512K, used 64K [0x00000000eaa80000, 0x00000000f6900000, 0x0000000100000000) eden space 190976K, 0% used [0x00000000eaa80000,0x00000000eaa80000,0x00000000f6500000) from space 1536K, 4% used [0x00000000f6780000,0x00000000f6790000,0x00000000f6900000) to space 2048K, 0% used [0x00000000f6500000,0x00000000f6500000,0x00000000f6700000) ParOldGen total 162304K, used 75738K [0x00000000c0000000, 0x00000000c9e80000, 0x00000000eaa80000) object space 162304K, 46% used [0x00000000c0000000,0x00000000c49f6a28,0x00000000c9e80000) PSPermGen total 114176K, used 114050K [0x00000000b0000000, 0x00000000b6f80000, 0x00000000c0000000) object space 114176K, 99% used [0x00000000b0000000,0x00000000b6f60bb0,0x00000000b6f80000)}Event: 3009.847 GC heap before{Heap before GC invocations=124 (full 54): PSYoungGen total 192512K, used 64K [0x00000000eaa80000, 0x00000000f6900000, 0x0000000100000000) eden space 190976K, 0% used [0x00000000eaa80000,0x00000000eaa80000,0x00000000f6500000) from space 1536K, 4% used [0x00000000f6780000,0x00000000f6790000,0x00000000f6900000) to space 2048K, 0% used [0x00000000f6500000,0x00000000f6500000,0x00000000f6700000) ParOldGen total 162304K, used 75738K [0x00000000c0000000, 0x00000000c9e80000, 0x00000000eaa80000) object space 162304K, 46% used [0x00000000c0000000,0x00000000c49f6a28,0x00000000c9e80000) PSPermGen total 114176K, used 114050K [0x00000000b0000000, 0x00000000b6f80000, 0x00000000c0000000) object space 114176K, 99% used [0x00000000b0000000,0x00000000b6f60bb0,0x00000000b6f80000)Event: 3010.127 GC heap afterHeap after GC invocations=124 (full 54): PSYoungGen total 192512K, used 0K [0x00000000eaa80000, 0x00000000f6900000, 0x0000000100000000) eden space 190976K, 0% used [0x00000000eaa80000,0x00000000eaa80000,0x00000000f6500000) from space 1536K, 0% used [0x00000000f6780000,0x00000000f6780000,0x00000000f6900000) to space 2048K, 0% used [0x00000000f6500000,0x00000000f6500000,0x00000000f6700000) ParOldGen total 162304K, used 75738K [0x00000000c0000000, 0x00000000c9e80000, 0x00000000eaa80000) object space 162304K, 46% used [0x00000000c0000000,0x00000000c49f6a28,0x00000000c9e80000) PSPermGen total 114176K, used 114050K [0x00000000b0000000, 0x00000000b6f80000, 0x00000000c0000000) object space 114176K, 99% used [0x00000000b0000000,0x00000000b6f60b90,0x00000000b6f80000)}Event: 3031.880 GC heap before{Heap before GC invocations=125 (full 54): PSYoungGen total 192512K, used 190976K [0x00000000eaa80000, 0x00000000f6900000, 0x0000000100000000) eden space 190976K, 100% used [0x00000000eaa80000,0x00000000f6500000,0x00000000f6500000) from space 1536K, 0% used [0x00000000f6780000,0x00000000f6780000,0x00000000f6900000) to space 2048K, 0% used [0x00000000f6500000,0x00000000f6500000,0x00000000f6700000) ParOldGen total 162304K, used 75738K [0x00000000c0000000, 0x00000000c9e80000, 0x00000000eaa80000) object space 162304K, 46% used [0x00000000c0000000,0x00000000c49f6a28,0x00000000c9e80000) PSPermGen total 123392K, used 122902K [0x00000000b0000000, 0x00000000b7880000, 0x00000000c0000000) object space 123392K, 99% used [0x00000000b0000000,0x00000000b7805920,0x00000000b7880000)Event: 3031.903 GC heap afterHeap after GC invocations=125 (full 54): PSYoungGen total 193024K, used 2043K [0x00000000eaa80000, 0x00000000f8600000, 0x0000000100000000) eden space 190976K, 0% used [0x00000000eaa80000,0x00000000eaa80000,0x00000000f6500000) from space 2048K, 99% used [0x00000000f6500000,0x00000000f66fef48,0x00000000f6700000) to space 10240K, 0% used [0x00000000f7c00000,0x00000000f7c00000,0x00000000f8600000) ParOldGen total 162304K, used 96317K [0x00000000c0000000, 0x00000000c9e80000, 0x00000000eaa80000) object space 162304K, 59% used [0x00000000c0000000,0x00000000c5e0f4d8,0x00000000c9e80000) PSPermGen total 123392K, used 122902K [0x00000000b0000000, 0x00000000b7880000, 0x00000000c0000000) object space 123392K, 99% used [0x00000000b0000000,0x00000000b7805920,0x00000000b7880000)}Event: 3034.040 GC heap before{Heap before GC invocations=126 (full 54): PSYoungGen total 193024K, used 193019K [0x00000000eaa80000, 0x00000000f8600000, 0x0000000100000000) eden space 190976K, 100% used [0x00000000eaa80000,0x00000000f6500000,0x00000000f6500000) from space 2048K, 99% used [0x00000000f6500000,0x00000000f66fef48,0x00000000f6700000) to space 10240K, 0% used [0x00000000f7c00000,0x00000000f7c00000,0x00000000f8600000) ParOldGen total 162304K, used 96317K [0x00000000c0000000, 0x00000000c9e80000, 0x00000000eaa80000) object space 162304K, 59% used [0x00000000c0000000,0x00000000c5e0f4d8,0x00000000c9e80000) PSPermGen total 123904K, used 123856K [0x00000000b0000000, 0x00000000b7900000, 0x00000000c0000000) object space 123904K, 99% used [0x00000000b0000000,0x00000000b78f4058,0x00000000b7900000)Event: 3034.064 GC heap afterHeap after GC invocations=126 (full 54): PSYoungGen total 209920K, used 10233K [0x00000000eaa80000, 0x00000000f9080000, 0x0000000100000000) eden space 199680K, 0% used [0x00000000eaa80000,0x00000000eaa80000,0x00000000f6d80000) from space 10240K, 99% used [0x00000000f7c00000,0x00000000f85fe510,0x00000000f8600000) to space 14848K, 0% used [0x00000000f6d80000,0x00000000f6d80000,0x00000000f7c00000) ParOldGen total 162304K, used 102389K [0x00000000c0000000, 0x00000000c9e80000, 0x00000000eaa80000) object space 162304K, 63% used [0x00000000c0000000,0x00000000c63fd688,0x00000000c9e80000) PSPermGen total 123904K, used 123856K [0x00000000b0000000, 0x00000000b7900000, 0x00000000c0000000) object space 123904K, 99% used [0x00000000b0000000,0x00000000b78f4058,0x00000000b7900000)}Deoptimization events (10 events):Event: 3034.219 Thread 0x000000000c383800 Uncommon trap: reason=unreached action=reinterpret pc=0x0000000002f33f40 method=org.eclipse.wst.xml.core.internal.parser.XMLSourceParser.parseNodes()Lorg/eclipse/wst/sse/core/internal/provisional/text/IStructuredDocumentRegion; @ 296Event: 3034.220 Thread 0x000000000c383800 Uncommon trap: reason=class_check action=maybe_recompile pc=0x0000000002fdfef0 method=org.eclipse.wst.xml.core.internal.document.NodeImpl.getStartOffset()I @ 76Event: 3034.220 Thread 0x000000000c383800 Uncommon trap: reason=class_check action=maybe_recompile pc=0x0000000002fdfef0 method=org.eclipse.wst.xml.core.internal.document.NodeImpl.getStartOffset()I @ 76Event: 3034.220 Thread 0x000000000c383800 Uncommon trap: reason=class_check action=maybe_recompile pc=0x0000000002fdfef0 method=org.eclipse.wst.xml.core.internal.document.NodeImpl.getStartOffset()I @ 76Event: 3034.220 Thread 0x000000000c383800 Uncommon trap: reason=class_check action=maybe_recompile pc=0x0000000002fdfef0 method=org.eclipse.wst.xml.core.internal.document.NodeImpl.getStartOffset()I @ 76Event: 3034.469 Thread 0x000000000c383800 Uncommon trap: reason=null_check action=make_not_entrant pc=0x0000000002ff9eec method=org.eclipse.jetty.io.BufferCache.get(Lorg/eclipse/jetty/io/Buffer;)Lorg/eclipse/jetty/io/BufferCache$CachedBuffer; @ 8Event: 3034.905 Thread 0x000000000c383000 Uncommon trap: reason=null_check action=make_not_entrant pc=0x000000000300f45c method=org.eclipse.jetty.io.BufferCache.getBest([BII)Lorg/eclipse/jetty/io/BufferCache$CachedBuffer; @ 24Event: 3034.920 Thread 0x000000000c383800 Uncommon trap: reason=null_check action=make_not_entrant pc=0x0000000003006234 method=org.eclipse.jetty.io.BufferCache.getBest([BII)Lorg/eclipse/jetty/io/BufferCache$CachedBuffer; @ 24Event: 3036.084 Thread 0x000000000c385000 Uncommon trap: reason=bimorphic action=maybe_recompile pc=0x0000000002b38b20 method=org.eclipse.core.internal.localstore.UnifiedTree.addChildren(Lorg/eclipse/core/internal/localstore/UnifiedTreeNode;)V @ 9Event: 3036.164 Thread 0x000000000c383800 Uncommon trap: reason=unreached action=reinterpret pc=0x0000000002d27dac method=org.eclipse.jetty.util.StringMap.getBestEntry([BII)Ljava/util/Map$Entry; @ 91Internal exceptions (10 events):Event: 3033.489 Thread 0x000000000051f000 Threw 0x00000000f3c9f7f8 at C:\re\jdk7u51\527\hotspot\src\share\vm\prims\jvm.cpp:1244Event: 3033.489 Thread 0x000000000051f000 Threw 0x00000000f3c9fd30 at C:\re\jdk7u51\527\hotspot\src\share\vm\classfile\systemDictionary.cpp:185Event: 3033.490 Thread 0x000000000051f000 Threw 0x00000000f3ca04a0 at C:\re\jdk7u51\527\hotspot\src\share\vm\prims\jvm.cpp:1244Event: 3033.490 Thread 0x000000000051f000 Threw 0x00000000f3ca1898 at C:\re\jdk7u51\527\hotspot\src\share\vm\prims\jvm.cpp:1244Event: 3033.905 Thread 0x000000000c387800 Implicit null exception at 0x0000000002d92ac0 to 0x0000000002d93185Event: 3034.219 Thread 0x000000000c383800 Implicit null exception at 0x0000000002ee2880 to 0x0000000002ee2bc1Event: 3034.469 Thread 0x000000000c383800 Implicit null exception at 0x0000000002ff7c58 to 0x0000000002ff9ee1Event: 3034.905 Thread 0x000000000c383000 Implicit null exception at 0x000000000300ce1c to 0x000000000300f44fEvent: 3034.920 Thread 0x000000000c383800 Implicit null exception at 0x000000000300426c to 0x0000000003006211Event: 3036.164 Thread 0x000000000c383800 Implicit null exception at 0x0000000002d27b16 to 0x0000000002d27d79Events (10 events):Event: 3036.084 Thread 0x000000000c385000 Uncommon trap: trap_request=0xffffffc6 fr.pc=0x0000000002b38b20Event: 3036.084 Thread 0x000000000c385000 DEOPT PACKING pc=0x0000000002b38b20 sp=0x0000000012dae800Event: 3036.084 Thread 0x000000000c385000 DEOPT UNPACKING pc=0x00000000027275a4 sp=0x0000000012dae798 mode 2Event: 3036.164 Thread 0x000000000c383800 Uncommon trap: trap_request=0xffffffad fr.pc=0x0000000002d27dacEvent: 3036.164 Thread 0x000000000c383800 DEOPT PACKING pc=0x0000000002d27dac sp=0x0000000014dceef0Event: 3036.164 Thread 0x000000000c383800 DEOPT UNPACKING pc=0x00000000027275a4 sp=0x0000000014dcee70 mode 2Event: 3036.247 Executing VM operation: RevokeBiasEvent: 3036.249 Executing VM operation: RevokeBias doneEvent: 3036.251 Executing VM operation: RevokeBiasEvent: 3036.251 Executing VM operation: RevokeBias doneDynamic libraries:0x000000013f700000 - 0x000000013f733000 C:\windows\system32\javaw.exe0x0000000077970000 - 0x0000000077b19000 C:\windows\SYSTEM32\ntdll.dll0x0000000077750000 - 0x000000007786f000 C:\windows\system32\kernel32.dll0x000007fefdb10000 - 0x000007fefdb7b000 C:\windows\system32\KERNELBASE.dll0x0000000075500000 - 0x0000000075587000 C:\windows\System32\SYSFER.DLL0x000007fefdb80000 - 0x000007fefdc5b000 C:\windows\system32\ADVAPI32.dll0x000007feff660000 - 0x000007feff6ff000 C:\windows\system32\msvcrt.dll0x000007feff700000 - 0x000007feff71f000 C:\windows\SYSTEM32\sechost.dll0x000007feffb20000 - 0x000007feffc4d000 C:\windows\system32\RPCRT4.dll0x0000000077870000 - 0x000000007796a000 C:\windows\system32\USER32.dll0x000007fefe2e0000 - 0x000007fefe347000 C:\windows\system32\GDI32.dll0x000007fefe170000 - 0x000007fefe17e000 C:\windows\system32\LPK.dll0x000007feff730000 - 0x000007feff7f9000 C:\windows\system32\USP10.dll0x000007fefc780000 - 0x000007fefc974000 C:\windows\WinSxS\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.7601.17514_none_fa396087175ac9ac\COMCTL32.dll0x000007fefe410000 - 0x000007fefe481000 C:\windows\system32\SHLWAPI.dll0x000007feffc50000 - 0x000007feffc7e000 C:\windows\system32\IMM32.DLL0x000007feff550000 - 0x000007feff659000 C:\windows\system32\MSCTF.dll0x0000000063a30000 - 0x0000000063b02000 C:\Program Files\Java\jre7\bin\msvcr100.dll0x000000005e2a0000 - 0x000000005ea69000 C:\Program Files\Java\jre7\bin\server\jvm.dll0x000007fefaf30000 - 0x000007fefaf39000 C:\windows\system32\WSOCK32.dll0x000007fefdc60000 - 0x000007fefdcad000 C:\windows\system32\WS2_32.dll0x000007feff720000 - 0x000007feff728000 C:\windows\system32\NSI.dll0x000007fefae10000 - 0x000007fefae4b000 C:\windows\system32\WINMM.dll0x0000000077b40000 - 0x0000000077b47000 C:\windows\system32\PSAPI.DLL0x0000000074440000 - 0x000000007444f000 C:\Program Files\Java\jre7\bin\verify.dll0x00000000646c0000 - 0x00000000646e8000 C:\Program Files\Java\jre7\bin\java.dll0x0000000064370000 - 0x0000000064385000 C:\Program Files\Java\jre7\bin\zip.dll0x000007fefd180000 - 0x000007fefd197000 C:\windows\system32\CRYPTSP.dll0x000007fefcdb0000 - 0x000007fefcdf7000 C:\windows\system32\rsaenh.dll0x000007fefca60000 - 0x000007fefca7e000 C:\windows\system32\USERENV.dll0x000007fefd750000 - 0x000007fefd75f000 C:\windows\system32\profapi.dll0x000007fefd680000 - 0x000007fefd68f000 C:\windows\system32\CRYPTBASE.dll0x00000000640e0000 - 0x00000000640f9000 C:\Program Files\Java\jre7\bin\net.dll0x000007fefcfa0000 - 0x000007fefcff5000 C:\windows\system32\mswsock.dll0x000007fefd010000 - 0x000007fefd017000 C:\windows\System32\wship6.dll0x000007fefb5d0000 - 0x000007fefb5e5000 C:\windows\system32\NLAapi.dll0x000007fef2800000 - 0x000007fef2815000 C:\windows\system32\napinsp.dll0x000007fef27e0000 - 0x000007fef27f9000 C:\windows\system32\pnrpnsp.dll0x000007fefce30000 - 0x000007fefce8b000 C:\windows\system32\DNSAPI.dll0x000007fef27d0000 - 0x000007fef27db000 C:\windows\System32\winrnr.dll0x000007fef2da0000 - 0x000007fef2db0000 C:\windows\system32\wshbth.dll0x0000000073eb0000 - 0x0000000073ed6000 C:\Program Files\Bonjour\mdnsNSP.dll0x000007fefb1d0000 - 0x000007fefb1f7000 C:\windows\system32\Iphlpapi.DLL0x000007fefb1c0000 - 0x000007fefb1cb000 C:\windows\system32\WINNSI.DLL0x000007fefc620000 - 0x000007fefc627000 C:\windows\System32\wshtcpip.dll0x000007fef1520000 - 0x000007fef1528000 C:\windows\system32\rasadhlp.dll0x000007fefa640000 - 0x000007fefa693000 C:\windows\System32\fwpuclnt.dll0x0000000063450000 - 0x0000000063461000 C:\Program Files\Java\jre7\bin\nio.dll0x0000000072000000 - 0x0000000072012000 C:\Navnidhi\Software\eclipse\plugins\org.eclipse.equinox.launcher.win32.win32.x86_64_1.1.200.v20120913-144807\eclipse_1503.dll0x000007fefc550000 - 0x000007fefc55c000 C:\windows\system32\VERSION.dll0x000007fefbc50000 - 0x000007fefbca6000 C:\windows\system32\uxtheme.dll0x000007fefb070000 - 0x000007fefb080000 C:\windows\system32\PGPhk.dll0x000007fef2d30000 - 0x000007fef2d6f000 C:\Program Files\ThinkPad\Bluetooth Software\btmmhook.dll0x000007fefe490000 - 0x000007feff218000 C:\windows\system32\SHELL32.dll0x000007feff340000 - 0x000007feff543000 C:\windows\system32\ole32.dll0x000007feff800000 - 0x000007feff8d7000 C:\windows\system32\OLEAUT32.dll0x0000000010000000 - 0x00000000100a8000 C:\Navnidhi\Software\eclipse\configuration\org.eclipse.osgi\bundles\636\1\.cp\swt-win32-4236.dll0x000007fefe350000 - 0x000007fefe3e7000 C:\windows\system32\comdlg32.dll0x000007fefaeb0000 - 0x000007fefaf21000 C:\windows\system32\WINSPOOL.DRV0x000007fefdcb0000 - 0x000007fefdedd000 C:\windows\system32\WININET.dll0x000007fefdb00000 - 0x000007fefdb04000 C:\windows\system32\api-ms-win-downlevel-user32-l1-1-0.dll0x000007fefd820000 - 0x000007fefd825000 C:\windows\system32\api-ms-win-downlevel-advapi32-l1-1-0.dll0x000007fefd830000 - 0x000007fefd834000 C:\windows\system32\api-ms-win-downlevel-shlwapi-l1-1-0.dll0x000007fefd9c0000 - 0x000007fefd9c4000 C:\windows\system32\api-ms-win-downlevel-version-l1-1-0.dll0x000007fefdaf0000 - 0x000007fefdaf3000 C:\windows\system32\api-ms-win-downlevel-normaliz-l1-1-0.dll0x0000000077b30000 - 0x0000000077b33000 C:\windows\system32\normaliz.DLL0x000007fefdee0000 - 0x000007fefe16c000 C:\windows\system32\iertutil.dll0x000007fefd840000 - 0x000007fefd9aa000 C:\windows\system32\CRYPT32.dll0x000007fefd7f0000 - 0x000007fefd7ff000 C:\windows\system32\MSASN1.dll0x000007fefbb90000 - 0x000007fefbba8000 C:\windows\system32\dwmapi.dll0x000007fefbde0000 - 0x000007fefbf0c000 C:\windows\system32\propsys.dll0x000007feff220000 - 0x000007feff2b9000 C:\windows\system32\CLBCatQ.DLL0x0000000005c60000 - 0x0000000005c7e000 C:\Navnidhi\Software\eclipse\configuration\org.eclipse.osgi\bundles\636\1\.cp\swt-gdip-win32-4236.dll0x000007fefb950000 - 0x000007fefbb66000 C:\windows\WinSxS\amd64_microsoft.windows.gdiplus_6595b64144ccf1df_1.1.7601.18120_none_2b25b14c71ebf230\gdiplus.dll0x000007fefb260000 - 0x000007fefb3c1000 C:\windows\system32\WindowsCodecs.dll0x0000000180000000 - 0x0000000180011000 C:\Navnidhi\Software\eclipse\configuration\org.eclipse.osgi\bundles\72\1\.cp\os\win32\x86_64\localfile_1_0_0.dll0x0000000005e00000 - 0x0000000005e06000 C:\Navnidhi\Software\eclipse\configuration\org.eclipse.osgi\bundles\945\1\.cp\os\win32\x86_64\fsnatives.dll0x000007fef4d70000 - 0x000007fef4d81000 C:\Navnidhi\Software\eclipse\configuration\org.eclipse.osgi\bundles\75\1\.cp\jWinHttp-1.0.0.dll0x000007fefa4a0000 - 0x000007fefa511000 C:\windows\system32\WINHTTP.dll0x000007fefa430000 - 0x000007fefa494000 C:\windows\system32\webio.dll0x000007fefa5b0000 - 0x000007fefa5c1000 C:\windows\system32\dhcpcsvc6.DLL0x000007fefa620000 - 0x000007fefa638000 C:\windows\system32\dhcpcsvc.DLL0x000007fefae50000 - 0x000007fefaea4000 C:\windows\system32\oleacc.dll0x00000000633f0000 - 0x0000000063414000 C:\Program Files\Java\jre7\bin\sunec.dll0x0000000074350000 - 0x000000007435b000 C:\Program Files\Java\jre7\bin\sunmscapi.dll0x000007fefd730000 - 0x000007fefd744000 C:\windows\system32\RpcRtRemote.dll0x000007fef0100000 - 0x000007fef013b000 C:\windows\system32\mlang.dll0x000007feec760000 - 0x000007feed618000 C:\Windows\System32\ieframe.dll0x000007fefd9b0000 - 0x000007fefd9b4000 C:\windows\system32\api-ms-win-downlevel-ole32-l1-1-0.dll0x000007fef8940000 - 0x000007fef8944000 C:\Windows\System32\api-ms-win-downlevel-shlwapi-l2-1-0.dll0x000007fef9650000 - 0x000007fef9654000 C:\Windows\System32\api-ms-win-downlevel-advapi32-l2-1-0.dll0x000007fef5d10000 - 0x000007fef5d14000 C:\Windows\System32\api-ms-win-downlevel-shell32-l1-1-0.dll0x000007fefe180000 - 0x000007fefe2d9000 C:\windows\system32\urlmon.dll0x000007fefd690000 - 0x000007fefd721000 C:\windows\system32\SXS.DLL0x000007fefd620000 - 0x000007fefd677000 C:\windows\system32\apphelp.dll0x000007fefd2d0000 - 0x000007fefd2db000 C:\windows\system32\Secur32.dll0x000007fefd5f0000 - 0x000007fefd615000 C:\windows\system32\SSPICLI.DLL0x000007feea6e0000 - 0x000007feeb949000 C:\Windows\System32\mshtml.dll0x000007fefd000000 - 0x000007fefd007000 C:\windows\system32\msimg32.dll0x000007fefc060000 - 0x000007fefc06e000 C:\windows\system32\msimtf.dll0x000007fef0610000 - 0x000007fef06ca000 C:\Windows\system32\uiautomationcore.dll0x000007feee7e0000 - 0x000007feeeba4000 C:\windows\system32\d2d1.dll0x000007fef03f0000 - 0x000007fef0586000 C:\windows\system32\DWrite.dll0x000007fef93f0000 - 0x000007fef944d000 C:\windows\system32\dxgi.dll0x000007fefdab0000 - 0x000007fefdae9000 C:\windows\system32\WINTRUST.dll0x000007fef8e40000 - 0x000007fef9015000 C:\windows\system32\d3d11.dll0x000007feeddf0000 - 0x000007feee069000 C:\windows\system32\D3D10Warp.dll0x000007fef9660000 - 0x000007fef982a000 C:\windows\system32\explorerframe.dll0x000007fefbc00000 - 0x000007fefbc43000 C:\windows\system32\DUser.dll0x000007fefb850000 - 0x000007fefb942000 C:\windows\system32\DUI70.dll0x000007fefb820000 - 0x000007fefb84d000 C:\windows\system32\ntmarta.dll0x000007feffac0000 - 0x000007feffb12000 C:\windows\system32\WLDAP32.dll0x000007feff8e0000 - 0x000007feffab7000 C:\windows\system32\SETUPAPI.dll0x000007fefd9d0000 - 0x000007fefda06000 C:\windows\system32\CFGMGR32.dll0x000007fefd800000 - 0x000007fefd81a000 C:\windows\system32\DEVOBJ.dll0x000007fef5230000 - 0x000007fef529d000 C:\Program Files\ThinkPad\Bluetooth Software\btncopy.dll0x000007fef8dc0000 - 0x000007fef8e40000 C:\windows\system32\ntshrui.dll0x000007fefd1f0000 - 0x000007fefd213000 C:\windows\system32\srvcli.dll0x000007fefa7d0000 - 0x000007fefa7df000 C:\windows\system32\cscapi.dll0x000007fefb480000 - 0x000007fefb48b000 C:\windows\system32\slc.dll0x000007fefacd0000 - 0x000007fefacdc000 C:\windows\system32\netutils.dll0x000007fef84c0000 - 0x000007fef84cc000 C:\windows\system32\LINKINFO.dll0x000007fef0a70000 - 0x000007fef0a8d000 C:\windows\system32\mssprxy.dll0x000007feed7c0000 - 0x000007feedb8e000 C:\windows\System32\jscript9.dll0x000007fef8760000 - 0x000007fef8799000 C:\windows\system32\msls31.dll0x000007fefbf10000 - 0x000007fefbf5b000 C:\windows\system32\MMDevAPI.DLL0x000007fef4c90000 - 0x000007fef4ccb000 C:\windows\system32\wdmaud.drv0x00000000714c0000 - 0x00000000714c6000 C:\windows\system32\ksuser.dllVM Arguments:jvm_args: -Dosgi.requiredJavaVersion=1.5 -Dhelp.lucene.tokenizer=standard -Xms40m -Xmx1024m -XX:MaxPermSize=256m java_command: C:\Navnidhi\Software\eclipse\\plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar -os win32 -ws win32 -arch x86_64 -showsplash C:\Navnidhi\Software\eclipse\\plugins\org.eclipse.platform_4.2.2.v201302041200\splash.bmp -launcher C:\Navnidhi\Software\eclipse\eclipse.exe -name Eclipse --launcher.library C:\Navnidhi\Software\eclipse\\plugins/org.eclipse.equinox.launcher.win32.win32.x86_64_1.1.200.v20120913-144807\eclipse_1503.dll -startup C:\Navnidhi\Software\eclipse\\plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar --launcher.overrideVmargs -exitdata 1afc_60 -product org.eclipse.epp.package.jee.product -vm C:\windows\system32\javaw.exe -vmargs -Dosgi.requiredJavaVersion=1.5 -Dhelp.lucene.tokenizer=standard -Xms40m -Xmx1024m -XX:MaxPermSize=256m -jar C:\Navnidhi\Software\eclipse\\plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jarLauncher Type: SUN_STANDARDEnvironment Variables:JAVA_HOME=C:\Program Files\Java\jdk1.7.0_51CLASSPATH=C:\Program Files\Java\jdk1.7.0_51\binPATH=C:\windows\system32;C:\windows;C:\windows\System32\Wbem;C:\windows\System32\WindowsPowerShell\v1.0\;C:\Program Files\ThinkPad\Bluetooth Software\;C:\Program Files\ThinkPad\Bluetooth Software\syswow64;C:\Program Files\Intel\WiFi\bin\;C:\Program Files\Common Files\Intel\WirelessCommon\;C:\Program Files (x86)\Lenovo\Access Connections\;C:\Program Files (x86)\IBM\Personal Communications\;C:\Program Files (x86)\IBM\Trace Facility\;C:\Program Files (x86)\IBM\Mobility Client\;C:\Program Files (x86)\Common Files\Roxio Shared\DLLShared\;C:\Program Files (x86)\Common Files\Roxio Shared\DLLShared\;C:\Program Files (x86)\Common Files\Roxio Shared\13.0\DLLShared\;C:\Program Files\Java\jdk1.7.0_51\bin;C:\Program Files\nodejs\;C:\Navnidhi\WaitroseProject\apache-ant-1.8.1-bin\apache-ant-1.8.1\bin;C:\Program Files (x86)\QuickTime\QTSystem\;C:\Program Files\Intel\WiFi\bin\;C:\Program Files\Common Files\Intel\WirelessCommon\;C:\Program Files\Java\jdk1.7.0_51\bin;C:\Users\IBM_ADMIN\AppData\Roaming\npm;C:\Navnidhi\WaitroseProject\apache-ant-1.8.1-bin\apache-ant-1.8.1\binUSERNAME=IBM_ADMINOS=Windows_NTPROCESSOR_IDENTIFIER=Intel64 Family 6 Model 42 Stepping 7, GenuineIntel--------------- S Y S T E M ---------------OS: Windows 7 , 64 bit Build 7601 Service Pack 1CPU:total 4 (2 cores per cpu, 2 threads per core) family 6 model 42 stepping 7, cmov, cx8, fxsr, mmx, sse, sse2, sse3, ssse3, sse4.1, sse4.2, popcnt, avx, aes, ht, tsc, tscinvbitMemory: 4k page, physical 7952408k(3973876k free), swap 15902932k(11772924k free)vm_info: Java HotSpot(TM) 64-Bit Server VM (24.51-b03) for windows-amd64 JRE (1.7.0_51-b13), built on Dec 18 2013 18:40:56 by "java_re" with unknown MS VC++:1600time: Mon Mar 10 11:06:17 2014elapsed time: 3036 secondsMoving to SWT for commentThis looks like a duplicate of, which was a problem in native IE that has been fixed. Is it possible you don't have the required software updates from MS installed? I notice that you have Service Pack 1, but this was released 18 months before the fix for, so I cannot tell more precisely from your dump whether you appear to have the fix from MS installed or not.Can you install the MS OS updates and please confirm if the problem still happens for you?(In reply to Lakshmi Shanmugam from)Any update, did installing OS updates fix the problem?	8.0
id=454447	REOPENED	Platform	SWT	4.4	PC Linux-GTK	P3 normal	Platform-SWT-Inbox	2014-12-08 10:28 EST by	Thomas Singer	2016-10-18 02:22 EDT (	4 users	Following exception has been reported to us for SmartGit 6.5.1:org.eclipse.swt.SWTException: code=2003 at org.eclipse.swt.dnd.DND.error(DND.java:287) at org.eclipse.swt.dnd.DND.error(DND.java:238) at org.eclipse.swt.dnd.FileTransfer.javaToNative(FileTransfer.java:70) at org.eclipse.swt.dnd.DragSource.dragGetData(DragSource.java:410) at org.eclipse.swt.dnd.DragSource.DragGetData(DragSource.java:227) at org.eclipse.swt.internal.gtk.OS._gtk_main_do_event(Native Method) at org.eclipse.swt.internal.gtk.OS.gtk_main_do_event(OS.java:9074) at org.eclipse.swt.widgets.Display.eventProc(Display.java:1253) at org.eclipse.swt.internal.gtk.OS._g_main_context_iteration(Native Method) at org.eclipse.swt.internal.gtk.OS.g_main_context_iteration(OS.java:2473) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3439)Java-Version: 1.7.0_65Max memory : 768OS : LinuxOS Version : 3.13.0-40-genericOS Arch : amd64Thread : swt	Hello Thomas,I'm currently working on imporving SWT's DND:But what you report doesn't seem to be related that the issue above in particular. Instead it seems a file was dropped onto the application (or within the application) and the underlying JVM failed to read/aquire that file. (DragSource dragGetData). It could be a fault with what ever was providing the file (broken file handle?)I presume you are using GTK-2 (as DND doesn't work properly in GTK-3 yet? Please provide steps to reproduce / scenario in which this occurs to troubleshoot further. Thank youIt's the exception we get auto-reported by our application without user contact. Unfortunately, I can't provide further details, but whatever comes in, SWT must not crash.DND usually happens when the user drags and drop an item. Are you saying that the application crashed without the user even using the system, i.e, it happened on it's own?No, I mean that we have no contact details of the user, because SmartGit just sent this stacktrace.Hello Tomas, I see now. Ok, here's a deep analysis based on what we have:I looked at this business:org.eclipse.swt.SWTException: code=2003 at org.eclipse.swt.dnd.DND.error(DND.java:287) at org.eclipse.swt.dnd.DND.error(DND.java:238)Below is the code that throws the error: case DND.ERROR_INVALID_DATA:{ String msg = DND.INVALID_DATA_MESSAGE; if (hresult != 0) msg += " result = "+hresult; //$NON-NLS-1$ throw new SWTException (code, msg);#Ref: line 284I.e the occur is thrown in the case of: DND.ERROR_INVALID_DATAError 2003 (ERROR_INVALID_DATA) is defined as: * Error code: Data does not have correct format for type (value is 2003). public static final int ERROR_INVALID_DATA = 2003;I.e, a file was dropped.SWT calls a native call to attempt to convert the file name to a 'native' file path, But the file name is invaild or not supported, the native code fails, a fail-safe check triggers a DND error.if (!checkFile(object) || !isSupportedType(transferData)) { DND.error(DND.ERROR_INVALID_DATA);}This means that somewhere in your code, you have not checked if the file is supported and instead you attempt to 'accept' it anyway.To fix this, you need to find the code that makes your widget 'accept' a drop operation and add some code to 'check if a file is of a supported type'. And only proceed if it is supported. Alternatively, try a DND drop and then catch the thrown exception.I.e, something like this:target.addDropListener (new DropTargetListener() { .. public void drop (DropTargetEvent event) { //CHECK FILE TYPE HERE or insert try/catch if (textTransfer.isSupportedType(event.currentDataType)) { }} Here is a full example of file-type checking: (see line 71).I.e, it seems like an issue in the program, at the moment I can't detect an issue in SWT.However, if you have already done this, then we need to see the source code that accepts the DND drop and I need to know what file was dropped onto the control. (perhaps write some try/catch code that would collect the file path and next time you get an error like this, attach it here). A snippet of code to reproduce would be even better =).Let me know if I can help further.I don't think it is something we can handle in our code. As you can see from the stacktrace, the exception happens in pure SWT (no application) code (event loop).Hello Thomas, That is a good observation.I have re-thought things, investigated further and ran some code on my machine.If of help:It may be your dragSource listener hasn't picked off the invalid file type.--- I.e:I'm assuming the following: - You have a widget somewhere, that you have registered as a 'drag-source', because otherwise the DragSource.dragGetData() method would not be called. This means contrary to the above, the source of the 'drag' operation comes from within smartgit, and not from outside.I think you can 'catch' this type of error if you add a dragListener to your dragSource widget and check the data type in the dragSetData() method. I.e, I'm looking at your stack trace: at org.eclipse.swt.dnd.DragSource.dragGetData(DragSource.java:410) at org.eclipse.swt.dnd.DragSource.DragGetData(DragSource.java:227)In particular, in this method:dragGetData(DragSource.java:410)Just before calling the javaToNative, the method calls listeners and allows them to check file types and 'cancel' a drag operation if the file type is not supported. (i.e set event.doit = false)DragSource.dragGetData() { 398: notifyListeners(DND.DragSetData, event); 400: if (!event.doit) return; //cancel op if we cancled the event. 410: transfer.javaToNative(event.data, transferData);I.e, Somewhere in your code you probably have a statement that says your widget is a 'dragSource'DragSource source = new DragSource(Control, DND.DROP_MOVE);Now you can add a listener and in the dragSetData() method you could check for valid file types and if it fails 'isSupportedType()' then set event.doit=false:(Or perhaps you already have a listener, but in the 'dragSetData' you are not checking for supported file types).Control.addDragListener (new DragSourceListener() {@Override public void dragStart (DragSourceEvent event) { } @Override public void dragSetData (DragSourceEvent event) { //provide data for dnd. if (TextTransfer.getInstance().isSupportedType (event.dataType)) { event.data = dragLabel.getText (); } } @Override public void dragFinished (DragSourceEvent event) { }});In general, this is how a 'normal' stack trace looks like if you have a listener registered. DNDGroupTest (G3) [Java Application] DNDTesting.DNDGroupTest at localhost:44323 Thread [main] (Suspended (breakpoint at line 83 in DNDGroupTest$1)) DNDGroupTest$1.dragSetData(DragSourceEvent) line: 83 #Here we reach the widget's listener. DNDListener.handleEvent(Event) line: 55 EventTable.sendEvent(Event) line: 84 Display.sendEvent(EventTable, Event) line: 4465 DragSource(Widget).sendEvent(Event) line: 1388 DragSource(Widget).sendEvent(int, Event, boolean) line: 1412 DragSource(Widget).sendEvent(int, Event) line: 1397 DragSource(Widget).notifyListeners(int, Event) line: 1182 DragSource.dragGetData(long, long, long, int, int) line: 398 #Here the listener 'dragSetData' is notified. DragSource.DragGetData(long, long, long, long, long) line: 227 OS._gtk_drag_get_data(long, long, long, int) line: not available [native method] OS.gtk_drag_get_data(long, long, long, int) line: 7401 DropTarget.drag_drop(long, long, int, int, int) line: 432 DropTarget.Drag_Drop(long, long, long, long, long) line: 258 OS._gtk_main_do_event(long) line: not available [native method] OS.gtk_main_do_event(long) line: 9137 Display.eventProc(long, long) line: 1253 OS._g_main_context_iteration(long, boolean) line: not available [native method] OS.g_main_context_iteration(long, boolean) line: 2482 Display.readAndDispatch() line: 3411 DNDGroupTest.swtMainLoop() line: 56 DNDGroupTest.main(String[]) line: 29 /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.25-4.b18.fc21.x86_64/bin/java (Dec 11, 2014, 11:25:30 AM) Please let me know if the above makes sense or if you would like clarification. Otherwise, please let me know if I can help further.Thanks for your detailed explaination. Maybe I'm too ignorant to understand why our code should be able to cause an SWT crash. Our code looks like this one:final DragSource source = new DragSource(control, operations);source.setTransfer(new Transfer[] {TextTransfer.getInstance()});source.addDragListener(new DragSourceListener() { ... public void dragSetData(DragSourceEvent event) { event.data = obj.getText(); } ...});so I've already told SWT what data we are going to transfer.Ok, we're getting pretty close here, I would suggest to try and change this business: ... public void dragSetData(DragSourceEvent event) { event.data = obj.getText(); } ...To look something like this over here: ... public void dragSetData(DragSourceEvent event) { if (TextTransfer.getInstance().isSupportedType(event.dataType)) { event.data = obj.getText(); } else { event.doit = false; //stops the transfer if type is not supported. } ...This would cancel a drag-start operation in case there is a datatype that is not supported as dragSource, just before the javaToNative() method is called. Source reference:(I found this article very useful personally)Please let me know if it helps or if I can help further. If curious about the details:----------------------------I kinda look at it as an uncaught exception but in 'Drag and Drop land'.In java, you catch exceptions that return from your methods. In Drag and Drop land it's in reverse, you kinda have to register exception handling logic before exceptions occur. It's kinda the nature of GUI's as they are event driven.What you see there isn't a 'crash' per-se, it's an SWTException triggered intentionally by SWT itself. Like if you divide by 0 and don't catch the exception something similar occurs.DND is implemented by the operating system, SWT is just a layer on top of it. The reason it's not like standard java is that Drag and Drop has to interact with other applications (e.g drop a file from the file manager onto an SWT application or the other way around) and so we have to 'think the way of an operating system' in a way.To make it work, we have to give up the control from the widget to the OS and eventually the OS will give control back to the widget. The fail occurs on the path as control-flow returns from the OS back to the widget (as oppose to the widget doing something) and it triggers a fail-safe that should have been checked before by the user. I.e, it's not really a 'crash', it's not a fatal error. SWT triggers the exception itself to indicate that the user forgot to check something.Since control is returning from the OS back to the widget, the stack trace is kinda in 'reverse', not having reached the widget yet. If curious, when I was learning DND for C, these two documents were very helpful:In SWT, DND is somewhat simplified actually =). If I missed something or made a mistake somewhere, please let me know. Thank youHmmm, you did make me think about dnd's architecture here. There is a flaw probably due to age of SWT's DND implementation. Currently control flow goes like this:> DND > Widget > DND copies data **1**1 If a fault occurs here, it's not clear which widget caused it.It might make sense to rewrite the logic so that the widget calls the transfer like this:> DND > Widget > DND copies data That way the stack-trace would be easier to read as it would contain the widget. Once I've fixed up:- [GTK3] SWT - DND broken (I might see if I have time to implement this change.Oh btw, it's not that you didn't tell SWT about the data, it's more like you gave it data that was invalid. E.g unsupported type?The problem is, that I can't reproduce the problem, because I don't know what the user did to get the reported exception. Because of that, I'm not able to verify whether any code change really solves the problem.(In reply to Leo Ufimtsev from)I meant, withsource.setTransfer(new Transfer[] {TextTransfer.getInstance()});I've already told SWT what kind of values I'm going to provide. Why do I provide that if SWT obviously does not verify it?Hello Tomas, Good question =), Let me try to explain:The line is basically a type declaration for DND, it is not exception checking logic.That said, SWT did double check the validity of the data, then decided it's not valid and threw an exception.---- Details:This business tells SWT/OS what data you're transferring so that SWT/OS knows how to deal with it, how to allocate memory for it, how to copy it across etc. Otherwise SWT would have to make a wild 'guess' as to what it's transferring. (rtf/url/file etc..?)It's like declaring a type in java so java knows how to deal with it:int i = 32;But suppose you write something like int i = getUserInput();and the user decides to type in some large value like this:231212273891273891273897128937128931This will trigger an 'Invalid Data / out of range' exception.The same thing is happening here except that the exception is labeled as:"Error code: Data does not have correct format for type (value is 2003)."And the reason that the application is terminated is that the exception is sort-of not checked and is thrown by swt.i.e SWTException extends java.lang.RuntimeException, meaning it is 'catchable', non-fatal. As with all exceptions, one has to double check the user's input manually as it may not be safe. This is what this code would do: public void dragSetData(DragSourceEvent event) { if (TextTransfer.getInstance().isSupportedType(event.dataType)) { event.data = obj.getText(); } else { event.doit = false; //stops the transfer if type is not supported. }However, I'm not saying 'Thomas, you made a mistake, this is how to fix it'. Instead I think it is not clear the way SWT deals with this exception and this makes it difficult to understand what is throwing it or how to catch it. It's not 'standard-java-logic' per-se.I've just created a task to improve the architecture so that it would make the stack-trace more understandable in this bug:When I get time, I'll work on it.---------------I've tried out snippets of code, but I haven't been able to reproduce the exact error that you're getting, it seems to be a bit of an exotic situation.I think for the time being, the fix above should probably fix the exception issue. If not, steps to reproduce would be helpful, maybe ask some user to report how he/she triggered the issue or play around with smartgit with various DND operations on files to see if you can reproduce it?Please let me know if you have any further questions or if I can help further.Thank you.Ping ping.Thanks, Leo. I've added the safety-checks to all our DND methods.I'm glad to hear =](In reply to Thomas Singer from)Can we close this bug now?I reopen this bug because we still get reports for the latest SmartGit bundles which has safety checks:org.eclipse.swt.SWTException: Data does not have correct format for type at org.eclipse.swt.dnd.DND.error(DND.java:287) at org.eclipse.swt.dnd.DND.error(DND.java:238) at org.eclipse.swt.dnd.FileTransfer.javaToNative(FileTransfer.java:69) at org.eclipse.swt.dnd.DragSource.pasteboard_provideDataForType(DragSource.java:746) at org.eclipse.swt.dnd.DragSource.dragSourceProc(DragSource.java:538) at org.eclipse.swt.internal.cocoa.OS.objc_msgSend_bool(Native Method) at org.eclipse.swt.internal.cocoa.NSRunLoop.runMode(NSRunLoop.java:42) at org.eclipse.swt.widgets.Display.sleep(Display.java:4720) at com.syntevo.q.gui.QSwt.dispatchEvents(SourceFile:317) at com.syntevo.smartgit.SaApplicationStarter.openGui(SourceFile:327) at com.syntevo.smartgit.SaApplicationStarter.parse(SourceFile:214) at com.syntevo.sc.application.ScParsingApplicationStarter.start(SourceFile:61) at SmartGit.main(SourceFile:11) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:483) at QBootLoader.main(SourceFile:117)The user is not aware of having performed a drag-and-drop operation. Maybe some unintentional drag when switching to our application?Steps in I20160517-2000 with EGit 4.4.0.201605171453:- have a Git repo with unstaged changes- open Git Staging view and select view menu > Presentation > Tree- in the "Unstaged Changes" pane, select the top-level folder or project- drag the selected container horizontally onto itself=> "Unhandled event loop exception" in the log:org.eclipse.swt.SWTException: Data does not have correct format for type at org.eclipse.swt.dnd.DND.error(DND.java:287) at org.eclipse.swt.dnd.DND.error(DND.java:238) at org.eclipse.swt.dnd.FileTransfer.javaToNative(FileTransfer.java:70) at org.eclipse.swt.dnd.DragSource.dragGetData(DragSource.java:404) at org.eclipse.swt.dnd.DragSource.DragGetData(DragSource.java:229) at org.eclipse.swt.internal.gtk.OS._gtk_main_do_event(Native Method) at org.eclipse.swt.internal.gtk.OS.gtk_main_do_event(OS.java:9545) at org.eclipse.swt.widgets.Display.eventProc(Display.java:1275) at org.eclipse.swt.internal.gtk.OS._g_main_context_iteration(Native Method) at org.eclipse.swt.internal.gtk.OS.g_main_context_iteration(OS.java:2495) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:4130)...(In reply to Markus Keller from)That one is(FileTransfer is empty if selection in EGit staged/unstaged viewer contains only containers) and(drop on drag source does not cancel the DND).is fixed with.is fixed with the same change unless the selection contains only deleted resources. Not sure how to deal with that (rather special) case. It also appears that on GTK transfers are created up front. On Mac, for instance, a transfer of a particular type is created lazily when the mouse hovers over a potential drag target that would accept it.In general: that "Data does not have correct format for type" not necessarily indicates that the drag data has the wrong type. It can also mean that the drag data is empty.BTW: to fixI wrap the selection to also remember where it came from, so that the DropTargetAdapter can check it. Is there some better way?	21.0
id=457752	REOPENED	Platform	SWT	4.4	PC Windows 7	P3 major	Platform-SWT-Inbox	2015-01-16 14:50 EST by	Sam Beroz	2016-08-16 07:54 EDT (	1 user	The following code correctly loads the PDF into the Browser but on two machines here the call to shell.close() never returns and when the window is closed I get the a stack trace.import org.eclipse.swt.SWT;import org.eclipse.swt.browser.Browser;import org.eclipse.swt.events.SelectionAdapter;import org.eclipse.swt.events.SelectionEvent;import org.eclipse.swt.layout.GridData;import org.eclipse.swt.layout.GridLayout;import org.eclipse.swt.widgets.Button;import org.eclipse.swt.widgets.Display;import org.eclipse.swt.widgets.Shell;public class PDFTest { public static void main(String[] args) { //basic PDF available via a URL String testPdfFile = ""; Display display = new Display(); final Shell shell = new Shell(display, SWT.NONE); final GridLayout gridLayout = new GridLayout(); shell.setLayout(gridLayout); Browser browser = new Browser(shell, SWT.NONE); browser.setLayoutData(new GridData(SWT.FILL, SWT.FILL, true, true)); Button btnClose = new Button(shell, SWT.NONE); btnClose.addSelectionListener(new SelectionAdapter() { public void widgetSelected(final SelectionEvent e) { System.out.println("Got button selection event!"); //selection event is received shell.close(); //shell.close never returns System.out.println("Done calling close!"); //this line does not get printed } }); final GridData gd_btnClose = new GridData(SWT.RIGHT, SWT.CENTER, false, false); btnClose.setLayoutData(gd_btnClose); btnClose.setText("Close"); browser.setUrl(testPdfFile); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } }}Clicking the close button fires the event listener but the call to shell.close() doesn't close the window. When I 'X' out of the window I get the following stack trace:org.eclipse.swt.SWTException: Widget is disposed at org.eclipse.swt.SWT.error(Unknown Source) at org.eclipse.swt.SWT.error(Unknown Source) at org.eclipse.swt.SWT.error(Unknown Source) at org.eclipse.swt.widgets.Widget.error(Unknown Source) at org.eclipse.swt.widgets.Widget.checkWidget(Unknown Source) at org.eclipse.swt.widgets.Widget.removeListener(Unknown Source) at org.eclipse.swt.ole.win32.OleClientSite.onDispose(Unknown Source) at org.eclipse.swt.ole.win32.OleClientSite.access$100(Unknown Source) at org.eclipse.swt.ole.win32.OleClientSite$1.handleEvent(Unknown Source) at org.eclipse.swt.widgets.EventTable.sendEvent(Unknown Source) at org.eclipse.swt.widgets.Display.sendEvent(Unknown Source) at org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source) at org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source) at org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source) at org.eclipse.swt.widgets.Widget.release(Unknown Source) at org.eclipse.swt.widgets.Composite.releaseChildren(Unknown Source) at org.eclipse.swt.widgets.Widget.release(Unknown Source) at org.eclipse.swt.widgets.Composite.releaseChildren(Unknown Source) at org.eclipse.swt.widgets.Widget.release(Unknown Source) at org.eclipse.swt.widgets.Composite.releaseChildren(Unknown Source) at org.eclipse.swt.widgets.Canvas.releaseChildren(Unknown Source) at org.eclipse.swt.widgets.Decorations.releaseChildren(Unknown Source) at org.eclipse.swt.widgets.Shell.releaseChildren(Unknown Source) at org.eclipse.swt.widgets.Widget.release(Unknown Source) at org.eclipse.swt.widgets.Widget.dispose(Unknown Source) at org.eclipse.swt.widgets.Decorations.dispose(Unknown Source) at org.eclipse.swt.widgets.Shell.dispose(Unknown Source) at org.eclipse.swt.widgets.Decorations.closeWidget(Unknown Source) at org.eclipse.swt.widgets.Decorations.WM_CLOSE(Unknown Source) at org.eclipse.swt.widgets.Control.windowProc(Unknown Source) at org.eclipse.swt.widgets.Canvas.windowProc(Unknown Source) at org.eclipse.swt.widgets.Decorations.windowProc(Unknown Source) at org.eclipse.swt.widgets.Shell.windowProc(Unknown Source) at org.eclipse.swt.widgets.Display.windowProc(Unknown Source) at org.eclipse.swt.internal.win32.OS.CallWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.CallWindowProc(Unknown Source) at org.eclipse.swt.widgets.Shell.callWindowProc(Unknown Source) at org.eclipse.swt.widgets.Control.windowProc(Unknown Source) at org.eclipse.swt.widgets.Canvas.windowProc(Unknown Source) at org.eclipse.swt.widgets.Decorations.windowProc(Unknown Source) at org.eclipse.swt.widgets.Shell.windowProc(Unknown Source) at org.eclipse.swt.widgets.Display.windowProc(Unknown Source) at org.eclipse.swt.internal.win32.OS.CallWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.CallWindowProc(Unknown Source) at org.eclipse.swt.widgets.Shell.callWindowProc(Unknown Source) at org.eclipse.swt.widgets.Control.windowProc(Unknown Source) at org.eclipse.swt.widgets.Canvas.windowProc(Unknown Source) at org.eclipse.swt.widgets.Decorations.windowProc(Unknown Source) at org.eclipse.swt.widgets.Shell.windowProc(Unknown Source) at org.eclipse.swt.widgets.Display.windowProc(Unknown Source) at org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method) at org.eclipse.swt.internal.win32.OS.DispatchMessage(Unknown Source) at org.eclipse.swt.widgets.Display.readAndDispatch(Unknown Source)I've tested this with 32 bit SWT 4.2.2 & 4.3.2 and everything works fine. The problem starts with SWT 4.4 and seems to also be present in 4.4.1 and 4.5M.The machine is running 64 bit Windows 7 6.1 and we've updated it with all available OS patches. The version of IE installed is 11.0.9600.17501The version of Adobe Reader XI installed is 11.0.2This test code constantly fails on two Windows PCs but runs fine elsewhere. Please let me know if other information would be helpful and I will append it.Thanks - Sam	Tested with 32bit IBM_JRE6 on Win7 with IE-10 on latest build, snippet works fine & loads the PDF successfully.Are you able to open the PDF() on external IE browser ?Also try to narrow down on the environment, to reproduce this issue as our end ?Please check out, if the problem is specific to any:- IE version- Acrobat reader version- JRE versionSorry for the delay, we've managed to narrow down the issue.The code appears to work fine with Adobe Reader set as the as the default PDF handler. The two machines that are having the issue have Adobe Standard and Adobe Pro installed.With Adobe Systems - Acrobat Version 11.0.10.32, I was able to avoid the failure by doing the following:In Adobe Pro, under the Edit Menu-> Preferences--> General , click "Select Default PDF Handler" and pick either Adobe Acrobat XI Pro or Adobe Reader (11.0.02) from the list.Toggling the value back to use Adobe Pro as the default PDF handler caused the issue to reappear.(In reply to Sam Beroz from)Thanks for the details/update.I am resolving this bug as NOT_ECLIPSE.Closing.Niraj, why mark this as NOT_ECLIPSE, considering this configuration worked until the SWT 4.4 release? I'd guess that Adobe Acrobat is used by a significant number of people and this change would seem to cause nearly all of them an issue when viewing a PDF in the SWT Browser. - SamWhen I use VisualVM to dump the threads of the test program configured to run with the 32 bit version of swt 4.4 it looks like it's hung here:"main" #1 prio=5 os_prio=0 tid=0x01dbc800 nid=0x42c0 runnable [0x0207f000] java.lang.Thread.State: RUNNABLE at org.eclipse.swt.internal.ole.win32.COM.CoFreeUnusedLibraries(Native Method) at org.eclipse.swt.ole.win32.OleClientSite.releaseObjectInterfaces(Unknown Source) at org.eclipse.swt.ole.win32.OleControlSite.releaseObjectInterfaces(Unknown Source) at org.eclipse.swt.ole.win32.OleClientSite.onDispose(Unknown Source) at org.eclipse.swt.ole.win32.OleClientSite.access$100(Unknown Source) at org.eclipse.swt.ole.win32.OleClientSite$1.handleEvent(Unknown Source) at org.eclipse.swt.widgets.EventTable.sendEvent(Unknown Source) at org.eclipse.swt.widgets.Display.sendEvent(Unknown Source) at org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source) at org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source) at org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source) at org.eclipse.swt.widgets.Widget.release(Unknown Source) at org.eclipse.swt.widgets.Composite.releaseChildren(Unknown Source) at org.eclipse.swt.widgets.Widget.release(Unknown Source) at org.eclipse.swt.widgets.Composite.releaseChildren(Unknown Source) at org.eclipse.swt.widgets.Widget.release(Unknown Source) at org.eclipse.swt.widgets.Composite.releaseChildren(Unknown Source) at org.eclipse.swt.widgets.Canvas.releaseChildren(Unknown Source) at org.eclipse.swt.widgets.Decorations.releaseChildren(Unknown Source) at org.eclipse.swt.widgets.Shell.releaseChildren(Unknown Source) at org.eclipse.swt.widgets.Widget.release(Unknown Source) at org.eclipse.swt.widgets.Widget.dispose(Unknown Source) at org.eclipse.swt.widgets.Decorations.dispose(Unknown Source) at org.eclipse.swt.widgets.Shell.dispose(Unknown Source) at org.eclipse.swt.widgets.Decorations.closeWidget(Unknown Source) at org.eclipse.swt.widgets.Shell.close(Unknown Source) at com.automate.PDFTest$1.widgetSelected(PDFTest.java:59) at org.eclipse.swt.widgets.TypedListener.handleEvent(Unknown Source) at org.eclipse.swt.widgets.EventTable.sendEvent(Unknown Source) at org.eclipse.swt.widgets.Display.sendEvent(Unknown Source) at org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source) at org.eclipse.swt.widgets.Display.runDeferredEvents(Unknown Source) at org.eclipse.swt.widgets.Display.readAndDispatch(Unknown Source) at com.automate.PDFTest.main(PDFTest.java:71)Based on the above, I've found that I can avoid the deadlock if I set COM.FreeUnusedLibraries = false prior to closing the shell. I see that this is also done in certain cases in IE to work around an Acrobat Reader issue. What would be the downside of this approach?The documentation for CoFreeUnusedLibraries says:Applications can call CoFreeUnusedLibraries periodically to free resources. It is most efficient to call it either at the top of a message loop or in some idle-time task. CoFreeUnusedLibraries internally calls DllCanUnloadNow for DLLs that implement and export that function.Could the call to CoFreeUnusedLibraries be moved out of the UI thread dispose process (OleClientSite.releaseObjectInterfaces) and instead be run in a daemon Timer at a regular interval? Making this change to my application seems to do the trick: final long period = 5 * 60 * 1000; //5 minutes COM.FreeUnusedLibraries = false; //prevent call on dispose Timer timer = new Timer(true); timer.schedule(new TimerTask() { @Override public void run() { COM.CoFreeUnusedLibraries(); //free whatever can be freed } }, period, period);It's not clear to me how the changes made between SWT 4.3.2 and 4.4 result in CoFreeUnusedLibraries blocking but I think this may resolve the issue. Is this a change you'd consider adding? Thanks - SamI've dug a little deeper to try and get to the bottom of this. I've found that this issue was caused by the commit to fix(Widget is disposed using Browser in Section).commit 200e62389c669a1f87627fe1ed034f46c7d17ed8Author: Grant Gayed <>Date: Thu Jul 11 12:27:38 2013 -0400Which went into the 4.4 release.The specific line that causes it is the early return in Composite's WM_PAINT method: 1532 74d0b289 (Markus Keller 2015-11-02 19:10:50 +0100 1532) @Override 1533 5721cfd1 (Silenio Quarti 2012-09-24 14:45:57 -0400 1533) LRESULT WM_PAINT (long /*int*/ wParam, long /*int*/ lParam) { 1534 200e6238 (Grant Gayed 2013-07-11 12:27:38 -0400 1534) if ((state & DISPOSE_SENT) != 0) return LRESULT.ZERO; 1535 093c579a (Silenio Quarti 2009-07-01 14:50:54 +0000 1535) if ((state & CANVAS) == 0 || (state & FOREIGN_HANDLE) != 0) { 1536 093c579a (Silenio Quarti 2009-07-01 14:50:54 +0000 1536) return super.WM_PAINT (wParam, lParam); 1537 093c579a (Silenio Quarti 2009-07-01 14:50:54 +0000 1537) }Now when I try and dispose the window containing a PDF rendered by Acrobat the system goes into an infinite loop calling WM_PAINT repeatedly.I dumped the stack when it's looping and got: at org.eclipse.swt.widgets.Composite.WM_PAINT(Composite.java:1533) at org.eclipse.swt.widgets.Control.windowProc(Unknown Source) at org.eclipse.swt.widgets.Display.windowProc(Unknown Source) at org.eclipse.swt.internal.win32.OS.VtblCall(Native Method) at org.eclipse.swt.internal.ole.win32.IOleInPlaceObject.InPlaceDeactivate(Unknown Source) at org.eclipse.swt.ole.win32.OleClientSite.deactivateInPlaceClient(Unknown Source) at org.eclipse.swt.ole.win32.OleClientSite.onDispose(Unknown Source) at org.eclipse.swt.ole.win32.OleClientSite.access$100(Unknown Source) at org.eclipse.swt.ole.win32.OleClientSite$1.handleEvent(Unknown Source) at org.eclipse.swt.widgets.EventTable.sendEvent(Unknown Source) at org.eclipse.swt.widgets.Display.sendEvent(Unknown Source) at org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source) at org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source) at org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source) at org.eclipse.swt.widgets.Widget.release(Unknown Source) at org.eclipse.swt.widgets.Composite.releaseChildren(Composite.java:949) at org.eclipse.swt.widgets.Widget.release(Unknown Source) at org.eclipse.swt.widgets.Composite.releaseChildren(Composite.java:949) at org.eclipse.swt.widgets.Widget.release(Unknown Source) at org.eclipse.swt.widgets.Composite.releaseChildren(Composite.java:949) at org.eclipse.swt.widgets.Canvas.releaseChildren(Unknown Source) at org.eclipse.swt.widgets.Decorations.releaseChildren(Unknown Source) at org.eclipse.swt.widgets.Shell.releaseChildren(Unknown Source) at org.eclipse.swt.widgets.Widget.release(Unknown Source) at org.eclipse.swt.widgets.Widget.dispose(Unknown Source) at org.eclipse.swt.widgets.Decorations.dispose(Unknown Source) at org.eclipse.swt.widgets.Shell.dispose(Unknown Source) at org.eclipse.swt.widgets.Decorations.closeWidget(Unknown Source) at org.eclipse.swt.widgets.Shell.close(Unknown Source)Removing that line reverts to the prior behavior and avoids the infinite loop however it also re-introduces.I was able to avoid bothand the infinite loop by changing the Composite WM_PAINT method, adding a call to OS Begin / End Paint which is effectively what was happening prior to the 4.4 release in this case: LRESULT WM_PAINT (int /*long*/ wParam, int /*long*/ lParam) { if ((state & DISPOSE_SENT) != 0){ PAINTSTRUCT ps = new PAINTSTRUCT (); OS.BeginPaint (handle, ps); OS.EndPaint (handle, ps); return LRESULT.ZERO; }For now I can work around the issue by adding a tweaked version of the Composite class early in my classpath but it would be nice if the official distribution could accommodate bothand this one.Thanks - Sam	9.0
id=475664	REOPENED	Platform	SWT	4.5	PC Linux	P3 normal	Platform-SWT-Inbox	2015-08-23 06:45 EDT by	tot to	2017-01-03 11:58 EST (	2 users	I've downloaded the file eclipse-cpp-mars-R-linux-gtk-x86_64.tar.gz and executed the following commands under user root:# tar xzf eclipse-cpp-mars-R-linux-gtk-x86_64.tar.gz -C /usr/local/opt/# cd /usr/local/opt# mv eclipse eclipse-4.5# ln -s /usr/local/opt/eclipse-4.5/eclipse /usr/local/bin/eclipse-4.5and then executed under the restricted user account:$ eclipse-4.5Result:I see the splash screen and then a window with the following text:An error has occurred. See the log file/var/home/tot-to/.eclipse/org.eclipse.platform_4.5.0_2034131179_linux_gtk_x86_64/configuration/1440326505547.log.$ cat /var/home/tot-to/.eclipse/org.eclipse.platform_4.5.0_2034131179_linux_gtk_x86_64/configuration/1440326505547.log!SESSION 2015-08-23 12:41:45.071 -----------------------------------------------eclipse.buildId=4.5.0.I20150603-2000java.version=1.7.0_79java.vendor=Oracle CorporationBootLoader constants: OS=linux, ARCH=x86_64, WS=gtk, NL=en_USFramework arguments: -product org.eclipse.epp.package.cpp.productCommand-line arguments: -os linux -ws gtk -arch x86_64 -product org.eclipse.epp.package.cpp.product!ENTRY org.eclipse.osgi 4 0 2015-08-23 12:41:48.117!MESSAGE Application error!STACK 1java.lang.UnsatisfiedLinkError: Could not load SWT library. Reasons: /var/home/tot-to/.eclipse/org.eclipse.platform_4.5.0_2034131179_linux_gtk_x86_64/configuration/org.eclipse.osgi/420/0/.cp/libswt-gtk-4527.so: /var/home/tot-to/.eclipse/org.eclipse.platform_4.5.0_2034131179_linux_gtk_x86_64/configuration/org.eclipse.osgi/420/0/.cp/libswt-gtk-4527.so: failed to map segment from shared object no swt-gtk in java.library.path /var/home/tot-to/.swt/lib/linux/x86_64/libswt-gtk-4527.so: /var/home/tot-to/.swt/lib/linux/x86_64/libswt-gtk-4527.so: failed to map segment from shared object Can't load library: /home/tot-to/.swt/lib/linux/x86_64/libswt-gtk.so at org.eclipse.swt.internal.Library.loadLibrary(Library.java:327) at org.eclipse.swt.internal.Library.loadLibrary(Library.java:236) at org.eclipse.swt.internal.C.<clinit>(C.java:16) at org.eclipse.swt.internal.Converter.wcsToMbcs(Converter.java:63) at org.eclipse.swt.internal.Converter.wcsToMbcs(Converter.java:54) at org.eclipse.swt.widgets.Display.<clinit>(Display.java:134) at org.eclipse.ui.internal.Workbench.createDisplay(Workbench.java:734) at org.eclipse.ui.PlatformUI.createDisplay(PlatformUI.java:162) at org.eclipse.ui.internal.ide.application.IDEApplication.createDisplay(IDEApplication.java:169) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:111) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:380) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:235) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:606) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:669) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:608) at org.eclipse.equinox.launcher.Main.run(Main.java:1515) at org.eclipse.equinox.launcher.Main.main(Main.java:1488)	The problem still there. Although, I found a workaround. Before starting eclipse I execute as root:# mount -o remont,exec /homeThen I start Eclipse and after it is started I can bring things back to normal by executing:# mount -o remount,noexec /homeIs your home directory mounted from a shared network drive?I've had something similar setup before, worked for me. But I actually had the eclipse installation it self in the mounted home directory as well. Can you try that and see what happens?	2.0
id=472416	REOPENED	Platform	SWT	4.5	PC Linux	P3 major	Platform-SWT-Inbox	2015-07-11 03:47 EDT by	Son Mising name	2015-07-31 11:17 EDT (	4 users	using the 4.5 version, when scrolling horizontally, or vertically (with mouse or scrollbar), text is garbled.- debian jessie: 3.16.0-4-amd64 #1 SMP Debian 3.16.7-ckt11-1 (2015-05-24) x86_64 GNU/Linux- gtk: 3.14.5-1- display: is hipdi (4K)1- scrolling vertically:it seems there is a wrong calcul at the position (and size ?) where invalid portion is to be repainted: therefore lines don't get correctly repainted and either we get partial duplicate line or extra white line inserted.2- scrolling horizontally: i guess the same problem occurs again ... but this time, the scroll triggers a 1 point (?) vertical scroll as well.text is becoming unreadable ... but changing focus to another window (ie: package view) restores correct display.unfortunately, when attemtping to perform 'print-screen', a refresh occurs and the display is then correctly fixed.	(In reply to Son Mising name from)Scroll where exactly?*** This bug has been marked as a duplicate of***According to the new attachments on, this is about h/v scrolling in the text editor, not in the tree views:@Son Mising name: please validate if this is *not* appearing on GTK2, see how inCreatedeffect of 'end' keyCreatedeffect with up/down keyCreatedeffect of horizontal scrollingCreatedeffect of vertical scrollingsorry for this late reply.1- GTK version issue.by including in the eclipse.ini file the following lines:...--launcher.GTK_version2...i do no longer reproduce the problem2- videos in attachment exhibit the issue with vertical & horizontal scrolling and with keyboard: using 'end' to access end of line and up/down keys to go previous/next line.for this last case, we see a little change in the spacing of lines	8.0
id=471094	REOPENED	Platform	Team	4.5	PC Linux	P3 normal	Platform-SWT-Inbox	2015-06-26 03:41 EDT by	Janos Binder	2017-02-16 19:35 EST (	30 users	CreatedBroken UI where the file name is not shown.Hi there,when I launched Commit Changes it does not show the names of the files.Below my installation details.Best wishes,Janos	CreatedClicking on the file in the Commit Changes the Compare window is also brokenCreatedInstallation detailsLooks like SWT issue with GTK3.Can you please try to export SWT_GTK3=0 before starting Eclipse and check is the issues are still reproducible?Can you also please run dpkg -l | grep gtk2; dpkg -l | grep gtk3and post the results here?I guess you are using Eclipse 4.5?The issue with the Commit Changes dialog is gone after exporting SWT_GTK3=0, but the compare window is still broken. The installation details on my Ubuntu 15.04:jbinder@pwenig-XPS-8500:~$ export SWT_GTK3=0 jbinder@pwenig-XPS-8500:~$ dpkg -l | grep gtk2; dpkg -l | grep gtk3ii gtk2-engines-murrine:amd64 0.98.2-0ubuntu2 amd64 cairo-based gtk+-2.0 theme engineii gtk2-engines-murrine:i386 0.98.2-0ubuntu2 i386 cairo-based gtk+-2.0 theme engineii gtk2-engines-pixbuf:amd64 2.24.27-0ubuntu1 amd64 pixbuf-based theme for GTK+ 2.xii gtk2-engines-pixbuf:i386 2.24.27-0ubuntu1 i386 pixbuf-based theme for GTK+ 2.xii libcheese-gtk23:amd64 3.14.1-2ubuntu4 amd64 tool to take pictures and videos from your webcam - widgetsii libgtk2.0-0:amd64 2.24.27-0ubuntu1 amd64 GTK+ graphical user interface libraryii libgtk2.0-0:i386 2.24.27-0ubuntu1 i386 GTK+ graphical user interface libraryii libgtk2.0-bin 2.24.27-0ubuntu1 amd64 programs for the GTK+ graphical user interface libraryii libgtk2.0-common 2.24.27-0ubuntu1 all common files for the GTK+ graphical user interface libraryii libunity-gtk2-parser0:amd64 0.0.0+15.04.20150118-0ubuntu1 amd64 GtkMenuShell to GMenuModel parserii overlay-scrollbar-gtk2:amd64 0.2.16+r359+15.04.20150319-0ubuntu1 amd64 GTK 2 module for overlay scrollbarsii python-gtk2 2.24.0-3ubuntu4 amd64 Python bindings for the GTK+ widget setii unity-gtk2-module:amd64 0.0.0+15.04.20150118-0ubuntu1 amd64 GtkMenuShell D-Bus exporterii ibus-gtk3:amd64 1.5.9-1ubuntu3 amd64 Intelligent Input Bus - GTK+3 supportii libavahi-ui-gtk3-0:amd64 0.6.31-4ubuntu4 amd64 Avahi GTK+ User interface library for GTK3ii libcanberra-gtk3-0:amd64 0.30-2ubuntu2 amd64 GTK+ 3.0 helper for playing widget event sounds with libcanberraii libcanberra-gtk3-module:amd64 0.30-2ubuntu2 amd64 translates GTK3 widgets signals to event soundsii libdbusmenu-gtk3-4:amd64 12.10.3+15.04.20150410.2-0ubuntu1 amd64 library for passing menus over DBus - GTK+ versionii libindicate-gtk3 12.10.1-0ubuntu3 amd64 library for raising indicators via DBus - GTK+ bindingsii libunity-gtk3-parser0:amd64 0.0.0+15.04.20150118-0ubuntu1 amd64 GtkMenuShell to GMenuModel parserii overlay-scrollbar-gtk3:amd64 0.2.16+r359+15.04.20150319-0ubuntu1 amd64 GTK 3 module for overlay scrollbarsii python-aptdaemon.gtk3widgets 1.1.1+bzr982-0ubuntu3.1 all Python 2 GTK+ 3 widgets to run an aptdaemon clientii python3-aptdaemon.gtk3widgets 1.1.1+bzr982-0ubuntu3.1 all Python 3 GTK+ 3 widgets to run an aptdaemon clientii unity-gtk3-module:amd64 0.0.0+15.04.20150118-0ubuntu1 amd64 GtkMenuShell D-Bus exporterAnd yes, I use Eclipse Mars (4.5) and updated EGit to 4.0.1 using the update site.CreatedCompare window after running export SWT_GTK3=0(In reply to Janos Binder from)1) So this is GTK3 specific SWT issue. Please report this in a separate bug report to the "Platform/SWT". Interestingly I don't see the gtk3-* library in the output, probably it is named differently (gtk+ ???) on Ubuntu (I'm on Fedora). Can you please add this info to the new bug, since SWT is gtk version dependent.2) This seems to be Eclipse 4.5 SWT gtk specific issue (reproducible on gtk2 and gtk3), your version is 2.24.27-0ubuntu1 and ???, my is gtk2-2.24.22-5.el7.x86_64 and gtk3-3.8.8-5.el7.x86_64.I don't see it on SWT with 3.8.2 Eclipse BUT I see it with I20150603-2000 build of 4.5 (probably on 4.5 final too, haven't had time to download it). So this is a regression in SWT somewhere after 3.8.2...To reproduce (requires Eclipse 4.5!): 1 change any file in git managed project 2 right click it and say Team->Commit 3 In the commit dialog double click the changed file 4 The opened compare dialog content does not fill the entire dialog windowStep 4 is reproducible on gtk2 and gtk3.Note, that once the "broken" dialog is re-sized (or maximized), it layouts itself properly.Thanks Andrey for the comments, I will report it under Platform/SWT. From my side this issue is closed.Here is my GTK 3 version.jbinder@pwenig-XPS-8500:~$ dpkg -l | grep gtk-3ii gir1.2-gtk-3.0:amd64 3.14.13-0ubuntu1 amd64 GTK+ graphical user interface library -- gir bindingsii gir1.2-javascriptcoregtk-3.0:amd64 2.4.8-1ubuntu2 amd64 JavaScript engine library from WebKitGTK+ - GObject introspection dataii gir1.2-spice-client-gtk-3.0 0.25-1build1 amd64 GTK3 widget for SPICE clients (GObject-Introspection)ii gtk-3-examples 3.14.13-0ubuntu1 amd64 example files for GTK+ 3ii libgtk-3-0:amd64 3.14.13-0ubuntu1 amd64 GTK+ graphical user interface libraryii libgtk-3-bin 3.14.13-0ubuntu1 amd64 programs for the GTK+ graphical user interface libraryii libgtk-3-common 3.14.13-0ubuntu1 all common files for the GTK+ graphical user interface libraryii libgtk-3-dev:amd64 3.14.13-0ubuntu1 amd64 development files for the GTK+ libraryii libjavascriptcoregtk-3.0-0:amd64 2.4.8-1ubuntu2 amd64 JavaScript engine library from WebKitGTK+ii libspice-client-gtk-3.0-4:amd64 0.25-1build1 amd64 GTK3 widget for SPICE clients (runtime library)ii libwebkitgtk-3.0-0:amd64 2.4.8-1ubuntu2 amd64 Web content engine library for GTK+ii libwebkitgtk-3.0-common 2.4.8-1ubuntu2 all Web content engine library for GTK+ - data filesResubmitted underSee: *this* bug is about commit dialog layout, it is reproducible on both GTK2 and GTK3 and is a regression on Eclipse 4.5 comparing with Eclipse 3.8.2***has been marked as a duplicate of this bug. ***Regarding, resizing the window doesn't permanently fix this issue, the layout is broken each and every time the dialog is opened.The issue of the file names/path not appearing has been fixed in.As for the dialog layout issue, I have encountered this in Gtk2 as well as Gtk3 on 4.5.CreatedWindow showing differences when trying to commit is wrong renderedToday (2015-08-24) installed Eclipse Mars on Ubuntu 14.10 and that's what it looks like.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Hi there,same problem here on Fedora 22.Is there any update/fix/workarround available?Best wishes,FloHello!Please, any chance to fix this?It's not really hard to fix I suppose.Thanks!***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***It looks like nobody is going to fix this anytime soon. A work around is adding protected Control createContents(Composite parent) { // because of bugComposite retval = (Composite) super.createContents(parent); retval.layout(true, true); return retval; }to the class:org.eclipse.compare.internal.CompareDialogCould somebody please commit this until the real issue gets fixed.(In reply to Martin Platter from)These sorts of fixes are usually just temporary things that don't fix the actual root issue.I'm investigating in a different bug that seems to be related to this one. It looks to be a problem in ScrolledComposite:I still see the issue with the compare dialog with even with the fix provided in. System: Fedora 24, GTK 3.20.6 (Note that EGit does not provide the commit dialog anymore since 4.3, so if anyone want to try the use case, he must install EGit 4.2 max).@Mikael: At least in 4.4, there is preference under Team > Git > Committing where you can choose to revert to use the commit dialog instead of the staging view.I also still see this issue in Neon.New Gerrit change created:New Gerrit change created:I've pushed a review with Martin's workaround as the fix fordid not solve the root issue.(In reply to Mikaël Barbero from)Is there a new bug for the root cause issue?(In reply to Sergey Prigogin from)No. Should I create one?(In reply to Mikaël Barbero from)Yes, please.Done. See.I don't think we need a temporary workaround. This type of bug is normally trivially easy to fix.I'll take a look at doing a real fix, but could someone please describe the updated steps to reproduce? EGit doesn't use the commit dialog anymore, so the original steps don't work... and I can't find any way to open that dialog box in the UI.Mikaël - If you can reproduce this, open the problematic dialog and then hit ctrl-alt-shift-F9. It will open a layout inspector that will help you investigate the root cause.(In reply to Stefan Xenos from)See;)(In reply to Stefan Xenos from)Will do later today. Thanks.The issue seems to be in the org.eclipse.compare.Splitter class. I suspect the method org.eclipse.compare.Splitter.setMaximizedControl(Control) to be responsible for this. I was not able to push investigation much further, my linux VM is continuously crashing.Perhaps org.eclipse.compare.Splitter.setMaximizedControl(Control) should be invoking requestLayout?(Note that calling requestLayout is significantly faster than calling layout(..., true)).Replacing fComposite.layout() with parent.requestLayout() in CompareEditorInput#createContents seems to fix this issue. Gerrit upcoming.New Gerrit change created:Gerrit changewas merged to [master].Commit:Gerrit changewas merged to [master].Commit:(In reply to Eclipse Genie from)Is this the final fix? How one can verify if this bug is finally fixed? Are there steps to reproduce?(In reply to Andrey Loskutov from)This should fix the compare editor opened from the EGit commit dialog.To test:1.) Configure EGit to use commit dialog2.) Double-click on a changed file to see the differences.-> All space should be used after the initialization of the dialog, no window resizing should be required.	44.0
id=475833	REOPENED	Platform	SWT	4.5	PC Linux	P3 normal	Platform-SWT-Inbox	2015-08-25 11:23 EDT by	Lars Vogel	2016-05-31 11:49 EDT (	8 users	Inwe marked org.eclipse.swt.custom.TableTree and related items for deletion.See	New Gerrit change created:Gerrit changewas merged to [master].Commit:(In reply to Eclipse Genie from)Thanks for the clean up patch Lars!Arun, we should also remove the JUnits for TableTree and TableTreeItem as they have references to TableTree.(In reply to Lakshmi Shanmugam from)I had missed that, thanks for pointing out! Done viaShould we also update the major version number of org.eclipse.swt to indicate the breaking API change?(In reply to Ian Bull from)I think for announced API removals () I'm not sure. Adding Dani for clarification.CreatedStack trace from TableTree issuesThis seems to cause some issues for me when I launch child Eclipses that use the SWT source code. Even when removing all JFace source code dependencies, I still get NullPointerExceptions sometimes causing Eclipse to not launch at all.Are there some steps I need to take to prevent this?(In reply to Lars Vogel from)No, we don't consider it a breaking change if the removal process was followed.(In reply to Dani Megert from)System integrators (and build tools) rely on semantic versions to properly assembly systems. Eclipse pioneered this idea over a decade ago [1]. Our use of version numbers and version range dependencies help ensure that we can argue sensibly about our dependencies. If someone specified a dependency on swt as [3.0, 4.0) they are making a statement about what versions will work with their system. By breaking API without updating the bundle versions, we have effectively made all our dependency ranges useless.I think the depreciation process is great, and I have no problem with this change. But why not update the version numbers appropriately. Who is benefiting from the decision to not follow our semantic version guidelines? [1]New Gerrit change created:Gerrit changewas merged to [master].Commit:New Gerrit change created:Gerrit changewas merged to [master].Commit:(In reply to Ian Bull from)The majority of clients doesn't expect their built bundles to break just because we removed an API that has been deprecated for ages.The problem with semantic versioning is that it always causes a cascade of breaking API changes as soon as the slightest change is applied. This would not be a problem if dependencies were expressed at the class level, but that's not how OSGi works.Since we only have the choice between two bad solutions (breaking all clients vs. not strictly following SemVer), such changes should be reserved for cases where maintaining the API causes high cost. I'm not convinced that this is/was really the case for TableTree.Added API filters:Issue with JFace and child Eclipses not launching has been fixed.Reopening this bug as per the discussions inand.(In reply to Markus Keller from)I've proposed packaging versioning be part of the deletion process, to attempt to help some clients, in some cases. It would not solve all cases ... but, might help in most cases? Seefor my proposal.New Gerrit change created:WARNING: this patchset contains 1977 new lines of code and may require a Contribution Questionnaire (CQ) if the author is not a committer on the project. Please see:Reverted all 4 commits for this deletion:Moved out of 4.6.New Gerrit change created:Gerrit changewas merged to [master].Commit:Fixed API filters withNote that this won't work out because the API Removal Process is inherently broken, see.	26.0
id=479646	REOPENED	Platform	SWT	4.5	PC Linux	P3 normal	Platform-SWT-Inbox	2015-10-13 09:19 EDT by	Thomas Singer	2015-10-21 03:08 EDT (	0 users	Just take a simple SWT table snippet, e.g. Snippet52, and add a MouseHover listener to the table. Then launch on Linux (with SWT_GTK3=0), hover over a cell and move the cursor. You will get following output in the console:(SWT:8680): GLib-CRITICAL **: Source ID 155 was not found when attempting to remove it	CreatedexampleDoes it happen with GTK3?I haven't tried because other table-related examples are unusable on GTK3.Why this bug is marked as resolved-invalid? Did I do that by accident??I've tried now without SWT_GTK3=0 and the problem is 100% reproducible, too.	5.0
id=481539	REOPENED	Platform	SWT	3.8	PC Windows 7	P3 critical	Platform-SWT-Inbox	2015-11-05 14:52 EST by	Victor Sms	2016-06-01 16:36 EDT (	2 users	Opening Microsoft Word Document with Macros wrongly pop up a security notice dialogSteps to reproduce:-Launch provided OLEExample sample code from Eclipse IDE.-Select "Open File".-Choose the provided Word document with macros.Microsoft Security Notice dialog will pop up. This will lock up parent dialog.If the same Word document with macros is opened in Internet Explorer 10, it can be opened with no Microsoft Security Notice pop-up, everything looks fine. This is the issue from Eclipse Ole, it should behave same as Internet Explorer 10.Sample code and sample Microsoft Word Document with macros are in attached word_with_macros_data.7z.	CreatedSample MS Word document with macrosCreatedSample codeAttached two separate files since attaching zip file failed.Created"Microsoft Word Security Notice" DialogPlease refer attached "Microsoft Word Security Notice" Dialog.Click on 'more information' link in the security notice, it lead you to steps on "how to enable the macro settings: from the 'Trust Center': ()After enabling the macro from the Trust Center.. I don't security notice anymore with the attached SWT snippet.Hi Niraj:I suggested the same to customer to disable security notice, customer believes that will compromise their environment. If user directly clicks on word doc, security warning is displayed on message bar. So only OLE has issues, it pops up a security warning dialog and blank dialog outside main workbench, and blocks main workbench afterwards, its a major issue for them.CreatedMicorsoft Word Security Notice for Excel FileThis Problem is also occured for the Excel file.CreatedSample Excel File contains MacroThis problem is also occured for the Excel fileOpening Microsoft Excel Document with Macros wrongly pop up a security notice dialogSteps to reproduce:-Launch OLEViewer from Eclipse Application.-Select "Open File".-Choose the provided Excel document with macros.Microsoft Security Notice dialog will pop up. This will lock up parent dialog.Security Dialog and sample Microsoft Excel Document with macros are in attached.This is a major issue blocking our customer, can we fix this ASAP?	10.0
id=486316	REOPENED	Platform	SWT	4.6	PC Linux	P3 normal	Platform-SWT-Inbox	2016-01-22 03:11 EST by	Kaloyan Raev	2016-04-22 08:26 EDT (	4 users	This issue happens only when GTK3 is used. GTK2 is not affected.When I hover the mouse on a problem marker inside the code editor, a hover window with proposed quick fixes is displayed. Clicking on a quick fix does not produce the expected result. The following exception is logged in the error log:org.eclipse.swt.SWTException: Widget is disposed at org.eclipse.swt.SWT.error(SWT.java:4491) at org.eclipse.swt.SWT.error(SWT.java:4406) at org.eclipse.swt.SWT.error(SWT.java:4377) at org.eclipse.swt.widgets.Widget.error(Widget.java:482) at org.eclipse.swt.widgets.Widget.checkWidget(Widget.java:419) at org.eclipse.swt.widgets.Control.redraw(Control.java:3719) at org.eclipse.swt.widgets.Link.gtk_event_after(Link.java:387) at org.eclipse.swt.widgets.Widget.windowProc(Widget.java:1966) at org.eclipse.swt.widgets.Control.windowProc(Control.java:5590) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4717) at org.eclipse.swt.internal.gtk.OS._gtk_main_do_event(Native Method) at org.eclipse.swt.internal.gtk.OS.gtk_main_do_event(OS.java:9279) at org.eclipse.swt.widgets.Display.eventProc(Display.java:1225) at org.eclipse.swt.internal.gtk.OS._g_main_context_iteration(Native Method) at org.eclipse.swt.internal.gtk.OS.g_main_context_iteration(OS.java:2425) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3428) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$4.run(PartRenderingEngine.java:1127) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1018) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:156) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:654) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:337) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:598) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:139) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:380) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:235) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:497) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:669) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:608) at org.eclipse.equinox.launcher.Main.run(Main.java:1515) at org.eclipse.equinox.launcher.Main.main(Main.java:1488)	Which OS is that? Which Gtk version? Which Eclipse version? I can't reproduce with latest Neon N-build on Fedora 23.I've just tried with Eclipse SDK N20160123-1500 and it is still reproducible.The OS is Fedora 23 64-bit. I could not find how to get the exact version of GTK3 I have installed.Here are the exact steps to reproduce:1. Download and extract Eclipse SDK.2. Start it in a new workspace.3. Create new Java Project.4. Create new Java Class.5. Have the following code in the class file: public class Main { public static void main(String[] args) { System.out.println(myvar); }}6. Hover the mouse over "myvar".7. Click on any the action link of the proposed quick fixes in the hover window, e.g. "Create local variable".(In reply to Kaloyan Raev from)rpm -q gtk3(In reply to Andrey Loskutov from)gtk3-3.18.6-1.fc23.x86_64P.S. Sorry for the late response. I've just found that most of the Bugzilla notifications go to my mail's junk folder.I can't reproduce the issue. I have tested Neon 4.6M4 with GTK 3.14.13 and SWT master with GTK 3.18.5, GTK 3.18.6, GTK 3.18.7However, I think() will fix this issue as well as a lot of freezing issues.Can not reproduce either with F23 and GTK 3.18.9, on Eclipse Neon 4.6M7, so maybe this could be set as fixed.Marking as fixed as per last two comments. If someone still reproduce it please reopen with details about versions of relevant libraries, distro, special cases to reproduce and etc.I still get the error with the latest N-build N20160418-2000, following the exact same steps from.I updated my Fedora with "sudo dnf update --refresh". Now I have GTK 3.18.9.(In reply to Kaloyan Raev from)Any chance you're using Gnome on wayland, KDE, XFCE, smth else?No. I believe I have a pretty standard installation of Fedora.I have just tried again with the latest nightlies, also on Fedora 23 (X11 session, not Wayland) freshly updated with the same command, with gtk3-3.18.9-1.fc23.x86_64, I have tried all the links in the quick fix tooltip, and all of them work.Alex suggested that I try debugging the issue.I've put a breakpoint on the call to redraw() in the Link.gtk_event_after() method (currently line 414).When clicking on a quick fix's link on the hover window, the debugger stops at the breakpoint, i.e. a "focus change" event has been generated. The Link's reference to the Display is still != null.The Link.gtk_event_after() method calls the super Control.gtk_event_after() method, which sends the focus event, which is handled by the StickyHoverManager, which closes the hover window. Closing the hover windows disposes all contained widgets, including the Link I've just clicked. Disposing the widget makes its reference to Display == null.So far, so good. The problem comes when immediately a second focus change event comes and the debugger stops at the same breakpoint. But the Display reference for this Link is already null and hence the "Widget is disposed" exception is thrown.Perhaps, the root cause of the issue is that GTK generates two "focus change" events for a single click on the Link widget. Can't we just check if the widget is disposed before calling the redraw() method? I see this approach is already used in the Link.enableWidget() method.	12.0
id=489640	REOPENED	Platform	SWT	4.6	PC Linux	P3 normal	Platform-SWT-Inbox	2016-03-15 07:17 EDT by	Thomas Singer	2017-02-16 19:35 EST (	5 users	With the attached sample setting 169 items to the read-only combobox on SWT 4.614 takes around 10s on my Ubuntu 14.04 (and Ubuntu 15.10, too) causing the window to turn dark.	CreatedSample codeOn fedora 23 I am getting a time of 1.4 seconds with I20160314-2000.Can you please check this again with the latest build?I've tried with 4.615 and this is MUCH snappier. It took only ~100ms.Sorry, it looks like I've tried the wrong jars. Now I'm getting ~8s for 169 items again (with the latest 4.615 jars).The fast time was with SWT_GTK3=0.Were you able to reproduce the delay? I've tried the v4621 and it still is there.I can't reproduce this bug on Eclipse Neon, SWT master, Fedora 24 with GTK3.20. GTK2 insert time is ~21ms, GTK3 insert time is ~820 ms.I'm getting these times on Ubuntu 14.04.$ gnome-session --versiongnome-session 3.9.90After having upgraded to Ubuntu 16.04 (Gnome 3.18) it is faster, but still takes 4100ms.After updating Gnome to versiion 3.20 I'm getting now ~3700ms. Not that quick for only 171 items. I expect it to be below 100ms.Downgrading severity since this is a performance issue.Also this seems CPU dependent. At home (AMD FX-8120) I am getting ~2000ms. At work (Intel Core i5 4300) the time was 820ms. No doubt GTK3 takes longer -- but the difference in the two times varies greatly depending on what CPU you have.My tests were done on Core i5 machines.A have the same issue with Combo on Linux Mint 18.Adding 1500 items tooks about 1-2 minutes on i5 cpu. A've tried setItems with no difference in performance.This bug must have top priority to fix.Forgot to say swt 4.6.1 linux x64	15.0
id=480032	REOPENED	Platform	SWT	4.5.1	PC Linux	P3 major	Platform-SWT-Inbox	2015-10-17 11:08 EDT by	Renan Furtado	2016-05-09 13:41 EDT (	11 users	CreatedImages of the bugHi, sorry my english.After updated to Eclipse Mars.1, the path of change files doenst show when i want commit to master.See details in atached file.This problems dont ocurrs in Version: Mars Release (4.5.0) - (check the print). Only in Mar.1 .The version of EGit (4.1.x) is the same in the both version of eclipse.I Use GitLab.Thanks.	*** This bug has been marked as a duplicate of***We've got second bug with same issue () on 4.5.1 which looks like a duplicate of, but according toit should be merged to 4.5.1, so I'm reopening to investigate.***has been marked as a duplicate of this bug. ***Renan, please attach here details about your operating system, desktop and gtk3 version. Thanks.Same issue on Mars.1 Release (4.5.1)Build id: 20150924-1200withorg.eclipse.swt.gtk.linux.x86_64 Version 3.104.1.v20150825-0743andorg.eclipse.egit.ui Version 4.0.3.201509231615-ron Linux Mint Cinnamon 64 bit(See)Please let me know if you need any further information.Please post your gtk3 version.rpm -q gtk3 or dpkg -l | grep libgtk-3or Help -> About -> Installation Details -> Configuration" dialog - search for the "org.eclipse.swt.internal.gtk.version" property.dpkg -l | grep libgtk-3-> 3.10.8~8+qianaand from the configuration:-> org.eclipse.swt.internal.gtk.version=3.10.8I can't reproduce this on Neon Nightly 20151001.I think the issue here is the version of Gtk you are using. If you'll note, the fixes inare guarded by a version check for versions greater than Gtk3.13. Since you are using Gtk3.10 I imagine this would be causing the problem.Would it be possible to update the version of Gtk3 on your system?I have the same issue. The latest GTK version on the current Linux Mint 17.x distro is 3.10.8~8+qiana, so upgrading that is not easy without opening a can of dependency worms.And Linux Mint 17.x is the long term support version, which will be supported until April 2019. Many users may prefer to stay on the LTS version for stability.***has been marked as a duplicate of this bug. ***I can't reproduce the issue on GTK 3.10.8 (compiled from source).The issue described inoccurs only on GTK >= 3.14. See.I don't have Mint 17.x to test, but the issue doesn't happen on GTK 3.10.8.The Bug is still there after the update to 4.5.2.Are there any plans to solve this?It's one of the major show stopper to use Mars.You can use the follow workaround while there is not solution:Add this to your eclipse.ini file:--launcher.GTK_version2The option --launcher.GTK_version should be before --launcher.appendVmargs(Thanks Bernard Arjan Draaisma ())Renan, Daniel, can you confirm exactly which version of Linux Mint you have? 17.3?The workaround works for the empty paths on the commit dialogue.If you double click a file there, to see the changes, the compare dialogue opens with estimated 1000x500px. But it's broken...Also a Problem that is there since Mars Release... (4.5, 4.5.1, 4.5.2)(In reply to Nabor Gilgalad from)This is a separate bug, see.(In reply to Marc-Andre Laperle from)I am using Qiana (17.0)(In reply to Marc-Andre Laperle from)I'm using 17.3 - Rosa. I had the some bug in the 17.2 - Rafaela.I reproduce the some bug in 2 computers (Mint 17.3).(In reply to Renan Furtado from)Thanks, I can reproduce it with the latest 4.6-I build. I'll investigate a bit. Could be a theme specific issue or a patch applied to this GTK.CreatedControls theme settingIf I change the Controls theme from Mint-x to Adwaita then it works correctly. I'm not sure what the root cause is yet. I attached a screenshot of the setting to make it easier to find. It could serve as a work around for some.I can reproduce it on Ubuntu 15.10 with GTK 3.10.8. I modified the Ambiance theme to be able to reproduce it. In gtk-widgets.css, I added this:GtkTreeView { -GtkWidget-focus-line-width: 0;}I seems to be a bug with the handling of focus-line-width when it is set to 0. In later version of GTK it works correctly. I'll bisect to find the commit.It turns out that the commit in question in GTK was just a version bump to 3.13.1, which means this behavior depends on a version check in SWT. The one that matches this is the one introduced in.(In reply to Snjezana Peco from)I can reproduce it on Ubuntu 15.10 with GTK 3.10.8 by modifying the Ambiance theme. To reproduce, you can copy/usr/share/themes/Ambiance to ~/.themesthen edit ~/.themes/Ambiance/gtk-3.0/gtk-widgets.cssaddGtkTreeView { -GtkWidget-focus-line-width: 0;}**Don't forget to remove it once your done with this bug!**When I modify the SWT Tree code to remove the version check, then it works.--- a/bundles/org.eclipse.swt/Eclipse SWT/gtk/org/eclipse/swt/widgets/Tree.java+++ b/bundles/org.eclipse.swt/Eclipse SWT/gtk/org/eclipse/swt/widgets/Tree.java@@ -2726,7 +2726,7 @@ } if (item != null) { if (OS.GTK_IS_CELL_RENDERER_TOGGLE (cell) ||- ( (OS.GTK_IS_CELL_RENDERER_PIXBUF (cell) || OS.GTK_VERSION > OS.VERSION(3, 13, 0)) && (columnIndex != 0 || (style & SWT.CHECK) == 0))) {+ ( (OS.GTK_IS_CELL_RENDERER_PIXBUF (cell) || OS.GTK3) && (columnIndex != 0 || (style & SWT.CHECK) == 0))) { drawFlags = (int)/*64*/flags; drawState = SWT.FOREGROUND; long /*int*/ [] ptr = new long /*int*/ [1];Would it be possible to have more information on the original fix that introduced the version check? I understand there was a difference in behavior in the number of rendererRender signals sent () but it's not clear to me why and if it would happen in other situations (i.e. when focus-line-width == 0).I saw some commits later in the GTK commit history that removed the use of focus-line-width so perhaps removing the use of focus-line-width (>= 3.14?) and setting focus-line-width to 0 is one and the same code path. In fact, if I go back to GTK 3.4.4 and set focus-line-width to 0, I get the bug and it gets fixed if I remove the version check in SWT. I think at this point it would be better to check what's going on in GTK to really understand what the right fix is.(In reply to Marc-Andre Laperle from)I have tried your patch. It introduces a clipping issue on GTK 3.10.8.See the screenshot.CreatedA clipping issue(In reply to Snjezana Peco from)Hi Snjezana. I'm not suggesting to apply the patch as is, otherwise I will push it to Gerrit. But I thought it would be easier to communicate what I meant. I do not know the right fix but I'm trying the best I can to bring the investigation further :)	26.0
id=490504	REOPENED	Platform	SWT	4.6	PC Windows 10	P3 normal	Platform-SWT-Inbox	2016-03-27 16:37 EDT by	MÃ¡rton Ledneczki	2016-12-15 12:20 EST (	6 users	I am using Surface Pro 4 (Intel Core M3 6Y30, 4 GB RAM, 128 GB SSD) with Windows 10. I always keep my system up to date, so I always install the latest updates, that are available. After starting Eclipse Mars and some time later my screen goes black and reappears. A popup tells me that the graphics driver has stopped responding and successfully restarted. This kind of issue can occur 5 times in 10 minutes. I have enough RAM while I am running Eclipse, and the CPU usage is also low. I have already contacted Intel Customer Support, Microsoft Community, Microsoft Surface tech Support to solve my problem, but no luck. Everybody just redirect me to a next company.One more thing about the GUI:Surface has a very high density display, in this way I use Windows Scaling, but the icons in Eclipse are so small, so they could be barely seen.	Moving to SWT.(In reply to MÃ¡rton Ledneczki from)Eclipse works fine on Win10 without such a problem.Is this problem specific to this particular graphics card ?Try latest Eclipse 4.6M6 build which supports autoScale at HighDPI displays:Yes, sadly, I think this is an individual case. I do not know if it is connected to Intel HD 515 generic configuration or to the Surface Pro 4's HD 515 Graphics Adapter. I have already reported my problem to Intel and Microsoft, but they could not offer me a private solution. Intel released new graphics driver for HD 515 (released this month), but Microsoft has not released it yet. Furthermore, I do not know whether this driver update will solve this problem or not.Can Eclipse cause such a graphics driver hang up?I will download the latest build and give it a try.Problem still exists. I already tried it with Eclipse Neon, and installed the newest intel hd 515 driver.Can reproduce this with the same drivers on an HP laptop with a high density screen on Neon M6 (i.e. with the fix in Neon M6 to rescale the icons). Seems to be provoked by the cursor-keys moving in the Java editor. Not reproducible in any application other than Eclipse (but I use it for little other than Eclipse).Still reproducible on Neon RC2: most commonly seen pressing the up arrow repeatedly in the Java editor window faster than the editor can refresh (though it may just be that one key-press has already caused the display to hang, and the subsequent key-presses are not "too fast for Eclipse to process" and are merely queued behind the ongoing crash).Can still easily reproduce, sometimes multiple times in a minute, with the released Neon.I have used Eclipse Neon for several hours since installing the Windows 10 Anniversary update without seeing a reoccurance of this problem.Thanks for letting us know! Marking as WORKSFORME.***has been marked as a duplicate of this bug. ***Being alerted thatwas marked as a duplicate has reminded me that the closure 490504 was in error: within an hour of posting that I could not reproduce the bug, the black screens started happening again. Can this be reopened please?NB since originally posting the issue I have used that laptop for things other than Eclipse (Office Libre, Firefox) and the black screen only happen with Eclipse, and almost always when the cursor keys are used to navigate in an editor.Reopening as per.	12.0
id=492433	REOPENED	Platform	UI	4.6	PC Linux	P3 normal	Platform-SWT-Inbox	2016-04-26 06:56 EDT by	Michael Rapp	2017-01-10 20:36 EST (	6 users	CreatedScreenshot of the Eclipse UI up-scaled too much on WaylandI just tested out Eclipse Neon Milestone 6 (4.6.0M6) to see if any progress concerning the HiDPI support has been made. Unfortunately on my system, the UI is up-scaled way too much (see attached screenshot). These are the specifications of my system:OS: Arch Linux 64 bitDE: GNOME 3.20.1 on WaylandGTK version: 3.20.3Display resolution: 2880 x 1620 pxI figured out, that the issue has something to do with Wayland as it disappears when using X as the display server instead. Maybe the reason is, that on Wayland GTK3 applications are scaled automatically depending on the display's DPI. So the HiDPI scaling is done twice - by Eclipse as well as by Wayland/GTK - causing the UI elements to have double the size they should have.By the way, I face the same issues with Libre Office (also using GTK3) on the same system ().	Would you please try with latest I-build? There were a number of fixes to the way detection was done since M6 so maybe one of them fixed your case.Alright, I just installed the latest version using the Eclipse Installer (I am not sure, if this is what you meant with "I build") and indeed the UI elements now have the correct size even on Wayland. Thank you.I just tried out the latest Eclipse Neon (4.6.0) release and the exact same issue as I described it earlier occurs again, althought it seemed to be fixed in a previous build: A lot of icons are upscaled too much on Wayland with GTK3 as it can be seen on the originally uploaded screenshot, causing Eclipse to be unusable. My system's specifications are:OS: Arch Linux 64 bitDE: GNOME 3.20.2 on WaylandGTK version: 3.20.6Display resolution: 2880 x 1620 pxI'm not seeing what the attached screenshot shows on Wayland on Fedora 24 (although I'm noticing a few other, much more minor issues there; see), so must suspect that this has perhaps something to do with how Wayland is pre-configured on Arch Linux?I don't think that there are any modifications of the Wayland configuration on Arch Linux as its against its philosophy of providing packages without any upstream modifications. You have tested this issue on a HiDPI screen with GTK3 enabled, right? Because this is what this bug report is about: The combination of GTK3, Wayland and HiDPI causes the UI to be up-scaled too much (see my original post). This becomes more obvious when varying the configuration as follows:- When using Wayland, a HiDPI screen and switching back to GTK 2 by starting Eclipse with the command "eclipse --launcher.GTK_version 2" the issue goes away.- When running a X session, even when using GTK 3 and a HiDPI screen, the problem does not occur.- When using Wayland and GTK3 on a regular screen, the UI is scaled correctly (it is not scaled at all).As I already mentioned, a similar issue occurs with LibreOffice running on the same system (). It has already been cofirmed by other users. As far as I know, both Eclipse as well as LibreOffice implement an application-side mechanism for HiDPI UI-scaling. However, GTK3 on Wayland causes applications to be up-scaled out of the box when run on HiDPI screens. So my guess would be, that either the UI-scaling performed by GTK or by Eclipse itself must be disabled in such case.I have the exact same issue on Fedora 24 using Wayland with a HiDPI display. GTK version: 3.20.8Eclipse: 4.6.0-3.fc24Display: 2880x1620 / 340mm x 190mmI have the exact same issue on Fedora 25, Wayland, Gnome 3.22, 3200x1800 resolution and the latest Oxygen. See my attachments on	7.0
id=506885	REOPENED	Platform	SWT	4.5	PC Linux	P3 normal	Platform-SWT-Inbox	2016-11-02 06:17 EDT by	Lars Vogel	2017-01-10 03:30 EST (	3 users	 	The underscore is not visible in Eclipse with Ubuntu 16.04. Here is my example text, paste this into a text editor in Eclipse. I attach screenshots how it looks like.Test _underscore_ in Eclipse.CreatedScreenshot EclipseCreatedScreenshot GeditResetting the font to the default via the Color and Fonts dialog fixed that.Why is this bug invalid? The screenshots attached show gedit drawing the underscores and eclipse not? There are other people[1] having this same issue, and while it can be worked around with a font change, users have no visibility of that.[1]and forum:and certainly others who just move on.	5.0
id=492102	REOPENED	Platform	SWT	4.4.1	PC Linux	P3 normal	Platform-SWT-Inbox	2016-04-20 11:11 EDT by	Robert Roth	2016-04-21 06:59 EDT (	3 users	The quick access tooltip (Opened by clicking the text box or by Ctrl+3) is getting smaller each time opened, so eventually by using it repeatedly it will get too small to be useful, or even too small without resizing it. Having to resize it after using it a couple of times is not really user-friendly :)Steps to reproduce:1. start eclipse (I used Eclipse Neon 4.6 N20160419-2000 for this test)2. Open the quick access (either by click or Ctrl+3 shortcut)3. Close it (either by clicking somewhere else or by pressing escape)4. Repeat steps 2-3 until you have no quick access left (if you do not resize the quick access tooltip)Other info:Using Fedora 23, gtk 3.18.9, all updates applied.	Most likely fixed via*** This bug has been marked as a duplicate of***(Un)fortunately, this bug is not directly related to. I can reproduce this problem with SWT from before the changes for, and it happens even on 4.5.2 and 4.4.1 on GTK2 and GTK3.(In reply to Markus Keller from)Should we move this bug to SWT?Shell#getBounds() starts to return too small values after the call to OS.gtk_widget_size_allocate() in Shell#forceResize().It looks like the problem is that Shell#setBounds() is called before the shell is visible. The hack forlooks wrong, since it only adjusts x & y, but doesn't touch width & height.I did some experiments, and by trial-and-error, I found a "solution" in Shell#forceResize() that looks like it fixes this concrete scenario: int border = gtk_widget_get_mapped (shellHandle) ? OS.gtk_container_get_border_width (shellHandle) : 0;... allocation.width = width + 2 * border; allocation.height = height + 2 * border;Unfortunately, this "solution" has a few problems:- It's obviously wrong to *add* the borders to width & height. Subtracting would make sense. I should not have tried that at all...- Shell#getBounds() returns wrong values for quite some time until after the Shell has been made visible.- When I resize the Content Assist popup, the label on the bottom gets cut off.Maybe the problem is that Shell#getSizeInPixels()/getBoundsInPixels() uses OS.gtk_widget_get_allocation() to determine the shell's size.andsay that this is not guaranteed to return the allocation that was previously set.I looked into a better solution, but didn't find anything I'd be comfortable to touch at this time.	4.0
id=220917	REOPENED	Platform	Team	3.3.2	PC Windows 2000	P3 normal	Platform Team Inbox	2008-02-29 06:45 EST by	Mauro Molinari	2011-04-26 12:49 EDT (	1 user	Build ID: M20080221-1800Steps To Reproduce:1. start Eclipse2. switch to the Team Synchronizing perspective: it has to be already in "Change Sets" model and already configured for any kind of synchronization (i.e.: a workspace synchronization, or just a folder synchronization) on a resource containing files with uncommitted changes; you may leave the Synchronize View in this state, close Eclipse and restart3. click on "Synchronize" (nearby "Populate"): the synchronization with the CVS starts; uncommitted changes appear in the tree; THERE HAVE TO BE AT LEAST TWO UNCOMMITED CHANGES!4. select an uncommited resource and right click->remove from view5. confirm on "Confirm Remove" alert6. the uncommitted resource doesn't get removed from the view; however, if you then do the needed synchronization actions on the other resources (i.e.: update the remotely modified ones and commit the locally modified ones), then the view is completely empied, actually removing also the resource that you previously had removed from the viewMore information:It simply seems an UI synchronization problem, because if you try to commit all the changes, the resource you removed from the view does not appear in the "Changes" section of the "Commit Files" dialog.Moreover, if you do the following:- follow steps from 1. to 5.- commit all the other uncommitted changes or update all the remotely modified files, so that the view gets emptied- modify a file and save it, so that you create a new uncommited change=> the resource you previously have removed from view appears again in the synchronize view, together with the new uncommited change...Instead, if in step 3. there's only one change and you remove it from the view, the action is successful.PLEASE NOTE: affected Eclipse version is 3.3.2: there is no 3.3.2 version available in Bugzilla "Version" field...	Mauro, have you tried reproducing it with the latest, Eclipse 3.4?(In reply to)I just did some quick tests and it seems not to happen in Eclipse 3.4.You may close this bug and I will reopen if I encounter it again.Thank you!Mauro.Thanks for checking it again, and letting us know how did it go. Closing as WORKSFORME in 3.4.(In reply to)Unfortunately, I encountered this problem again in 3.4.1, (build id M20080911-1700). I was working with 8 outgoing changes shown in Change Sets model and I tried to remove from the view one of them. It didn't go away. I had to switch the model (to "All models", then to "Change Sets" again) to make it disappear. In my current environment, it's always repoducible...I don't know if it's the case to reopen this bug...Mauro.I haven't received any feedack, however I can reproduce sistematically in Eclipse 3.4, even in simpler scenarios (see my).So, I'm reopening it.For a long time I hadn't seen this problem anymore, however with the latest version of Eclipse 3.6.2 (M20110210-1200), I see this problem always happening in the following form:- do a "synchronize with repository" and switch the Synchronize view to the Change Sets model- let we have an outoing change on the resource A - right click on A and click "remove from view"- A is NOT removed from the view!- try to commit to CVS- the commit dialog shows A! So, contrary to my original report, where A was absent, I now see A even in the commit dialog!- cancel the commit dialog and switch the Synchronize view to All Models- A is absent!- switch back to Change Sets model: A is absent!Moreover, if you do "remove from view" while using All Models directly, the action works as it should.So, it must be a problem with the Change Sets model of the Synchronize view. Can you reproduce?	6.0
id=146917	REOPENED	Platform	Team	3.2	PC Windows XP	P3 enhancement	Platform Team Inbox	2006-06-13 16:43 EDT by	Eugene Kuleshov	2011-09-26 09:49 EDT (	11 users	There are cases when projects are using different version control systems, e.g. for historical reasons or while migrating. When dealing with those one would have to create multiple synchronizations and it is difficult navigate trough changes when they are broken across multiple synchronizations.	One hurdle to getting this going is figuring out how to provide a common triggering mechanism. Currently, all repo providers contribute their own actions to the Team menu and Sync is driven by that (or by creating a new synchronization in the sync view). One possibility would be to have some way of adding more than one repository type when creating a new synchronization. Needs further investigation.Hmm. Why do you mark it resolved then? You could at least use "remind later" resolution...To clarify: while this could be an interesting feature, the problem is that as a platform, Eclipse can only "speak" for CVS. We can't provide an implentation of a generic sync action for all other repo providers that integrate with Eclipse, and unless we can get a broad consensus from most other repo providers, we wouldn't feel comfortable forcing this type of API on them.Hmm. I would expect that platform should provide enough plugability to 3rd party providers to fit nicely into the developers activities... It is been pointed out before, but current Team API is designed based on CVS and has number of shortcomings that make it difficult for other providers to do certain tasks or have to reimplement same functionality over again.Besides, there is need from other tools (like Mylar) to be able to interact with Team providers and execute certain tasks (for instance, commit, create and apply patch) and none of this stuff has been made a standard API.There are two things that are at odds here. What you are saying is that you work with multiple repositories and would like a unified view of those repositories. What repository providers want is the ability to provide a repository specific UI so that they can surface the feature that make their tooling stand apart from other repository tooling.We tried to have a unfied Synchronize view in Eclipse 1.0 and it was a failure because it provided the lowest common denominator. What we did in 2.0 is provide a set of low level integration points so that repository providers could surface their UI as they saw fit. Both the repository providers and the users were much happier with this architecture.Since 2.0, we have provided a CVS workflow that we, as Eclipse developers, like. Other users have indicated that they like it as well so we've made some of the pieces of this architecture API so that other repository providers could benefit from it if they desired. However, they are not required to do so and can provide their own workflows if they prefer.So, with that in mind, it is OK if we define optional Team API that others can choose to use or not. What we don't want to do is force repository providers to implement Team API in order to integrate into the Platform without their involvement in the genesis of that API. As you say, we, the Eclipse Team/CVS Team have not done a good job at defining generally useful API (i.e. it has been too CVS specific). Therefore, from your own argument it would be a mistake for us to define the API for a generic sync view. The API would only succeed if a good cross section of repository vendors were involved in its design. JSR 147 (mentioned in) is such an effort.Michael, JSR 147 is probably the way to go for a long term, but now it would make sense to at least handle common providers. There is already synchronization model supported by sync view, so why can't it allow aggreagtion of different providers? At least for some most popular providers... Also, it doesn't look like JSR 147 API is a good fit for high level operations such as commit, cheate patch, etc that are typicaly bound to Eclipse workspace ot even to specific synchronization.Integration into the Synchronize view can happen at many levels and the repository providers can provide customized actions in the toolbar, view menu and context menu. In essence, what your proposal would require is a single level of integration into the Synchronize view with a unified set of actions. That is not something we want to force on repository providers.(In reply to)Provider-specific actions could go into node-specific popup menu in the same way as in package explorer or navigator views. Personally I find toolbar actions really confusing, especially with that jumpy-buggy behavior of the current view toolbars.It should be ok to restrict actions like commit, create patch, etc. to single provider, but still allow integration tools to use common API to invoke such actions. I believe we have a separate bug report for that already.I can appreciate this tension between keeping the API think thereby giving more control to the providers. However, it can result in a problematic user experience for those that use more than one repository, and many developers are forced to check out the sources of the APIs that they depend on.Personally, I rely heavily on the Synchronize view always showing me the diff between my workspace and the rest of the world that I find it confusing to have no way of knowing that there are changes in a SVN or FTP synchronization when I've got my CVS synchronization up (most of the time).So I wonder if this can be finessed by the UI. For example, how about providing a mode, called All Synchronizations, in which the top-level nodes are the individual Synchronizations (or Change Sets containing synchronizations)? Each provider can still get it's own context menu, schedule, etc, but at least multiple synchronizations would be visible.By the way, Michael, isn't Synchronize view already using common navigator framework? For some reason I thought that it does allow to have different actions depends on the model.The Synchronize view is just a paged based view to which repository providers can plug in pages. We do provide a page implementaion to repository providers that makes use of the Common Navigator framework in order to allow the repository provider to delegate the rendering of the Synchronization state to the models involved. However, it is up to the repository provider to decide whether they want to use the page we provide or if they want to role their own page (or even provide their own view).Michael, can you please clarify how exactly that page would work for CVS provider and some other one? I am not sure how can user select two different provider types to be shown on the same sync page. Unless CVS provider is also not using this feature... Thanks.Eugene, I'm not sure what you are asking. Are you asking me to speculate on what this feature would require? Or are you asking about the current shape of the Synchronize view framework?(In reply to)Michael, you said that: "We do provide a page implementaion to repository providers that makes use of the Common Navigator framework in order to allow the repository provider to delegate the rendering of the Synchronization state to the models involved. However, it is up to the repository provider to decide whether they want to use the page we provide or if they want to role their own page (or even provide their own view)."So, I am asking if CVS provider does using sync page provided by team plugin? If so, how other plugins could add their synchronizations to that page in order to see their changes on the same page with CVS? I am confused, because it is not obvious from the Synchronization wizard UI.Team provides a bunch of interfaces and abstract superclasses the repositories can implement. They are describe here in the ISV doc:CVS makes use of the classes provided by Team to create a CVS specific Synchronize view. The framework is not structured in such a way to allow other repository providers to put their Synchronization results in the same page as CVS. It requires them to have their own page.If I was to speculate on a good starting point for supporting a page that shows results from multiple repositories, I would say that it would require an IMergeContext that delegated to the appropriate repositories IMergeContext. The problem is that you would need a command/action that knew how to build the merge contents for all the repositories involved. Also, this is only a starting point and there would be many more details that would need to be worked out (e.g. how would you surface the commit operation in the sync view).As of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Reopening the bug.	19.0
id=364550	REOPENED	Platform	Team	3.7.1	PC Linux-GTK	P3 critical	Platform Team Inbox	2011-11-23 04:32 EST by	James Blackburn	2014-05-21 04:34 EDT (	3 users	Createddeadlock backtraceInstalled Features:org.eclipse.team.svn_0.7.9.I20110819-1700org.polarion.eclipse.team.svn.connector_2.2.2.I20110819-1700org.polarion.eclipse.team.svn.connector.svnkit15_2.2.2.I20110819-1700org.polarion.eclipse.team.svn.connector.svnkit16_2.2.2.I20110819-1700org.polarion.eclipse.team.svn.m2eclipse_1.0.2.I20110227-1700Using the latest Indigo release (AFAICS), I get a deadlock every time I startup a certain workspace.	After careful consideration of the situation and the provided stacktraces the only conclusion is that there are no deadlocks. It seeme like some time consuming operation is in progress instead. The only related thing that comes to mind is that since the time of the report there were some performance improvements (related to the JDT support and refreshing resources) made in Subversive that probably (but no guarantee) could help the situation.Can you explain why this isn't a deadlock?syncExec isn't processed during earlyStartup (which is where the main thread is). The result is: main thread (UI): holds UI ; trying to acquire ws lock Worker-0 : holds WS lock ; trying to syncExec onto the UI=> Deadlock.Note this may be a team issue, rather than a SVNKit issue.However if I have my history view at the top, and shutdown the WS, then I can't start the worskpace again. (A workaround is to delete the securestorage file, disabling the password prompt...)The point is that the main thread awaits team provider being loaded, while team provider loading is stumbled upon a class loading and awaits for closing of the secure storage password prompt dialog called somewhere deep inside the Eclipse Platform class loader workflow (I do not understand why, since I know nothing of the Eclipse Platform class loader implementation).It means that IDE was locked not due to the Subversive code:public void start(BundleContext context) throws Exception { super.start(context); this.tracker = new ServiceTracker(context, IProxyService.class.getName(), null); // <---- locked here on class loadingbut due to class loader implementation.I could have tried to move this report somewhere else (Platform Component), but there are few other points present too:1) There is a high chance somewhere around your visually "locked" Eclipse IDE instance was present a password prompt window, for whatever the reason it was called.2) There are no threads in BLOCKED state. There are no cross-locks in Subversive (the only thread running Subversive code is worker-0, which is just plug-in startup) or Platform code.3) On the other hand it seems there are at least two actively running IO streams (they're not in IO-wait mode), which could cause slow startup for the workspace.Considering all those reasons I've closed the report.P.S.It is definitely not the Subversive issue, but it does not seem as Team issue either. Also considering thread's states it does not seem like a "deadlock" issue at all. It more seems like "dialog opened behind the main window" issue.Ok. I do understand how the eclipse platform and ui interact, and trust me this a real deadlock. Neither the main UIthread, nor the worker thread can make progress because they each require a resource held by the other, as outlined in my previous comment. The other threads are unimportant to the deadlock.Moving to platform as its history view and team.(In reply to)Yes, I get what is it you're telling me. Looks like it'll be better for me to get a little more sleep time this week. :)CreatedTestcaseI was about to log this bug. I'm experiencing a deadlock (well more specifically a "LiveLock") when the workbench starts up for an RCP application (version 4.3.2, but I think this problem exists in older version too) that I'm working on. It only happens on gtk and after debugging it I found the problem. org.eclipse.ui.application.WorkbenchAdvisor.java class has a method called: public boolean openWindows(){... }And this method tells the main method to fire off a thread to do work and call display.wake() when its done. In the meantime the main thread calls display.sleep() in while loop waiting for this thread to finish. The main thread never gets past this point ... because the "wake" signal was never picked up.looking in the sleep() method there is a comment:/** Bug in GTK. For some reason, g_main_context_wakeup() may * fail to wake up the UI thread from the polling function.* The fix is to sleep for a maximum of 50 milliseconds.*/and what it does it resets the "wake" flag that was raised by the wake thread ... I've attached a small test class that will hopefully prove this livelock.I have 2 workarounds:1) Override that openWindows method and add a sleep just before the display.wake gets called in the thread. (1000ms ... it really sucks)2) Start another rcp application instance to unstuck the first one ... (this sucks too)CreatedMy improved workaroundInstead of the sleep workaround I now do the following to workaround the live lock	10.0
id=293786	REOPENED	Platform	Team	3.5.1	PC Linux	P3 normal	Platform Team Inbox	2009-10-30 09:41 EDT by	Andrew Overholt	2010-01-07 11:28 EST (	8 users	This appears to be a GTK 2.18 difference (hence me CCing Bogdan), but it looks like the selection area for the checkbox in CVS checkouts is too wide. I'll attach two screenshots of checking out from CVS with 3.5.1 on both GTK 2.16 and 2.18.	CreatedGTK 2.16Checkbox selected, GTK 2.16CreatedGTK 2.18Checkbox selected, GTK 2.18Is this valid for the checkbox in CVS checkouts dialog only or for all dialogs for jobs that can be run in background?It looks like all that can be run in the background. Sorry, I don't know where to re-assign for that.If so, it sounds like an UI issue to me, but they can push it further to SWT.Also happens in other dialogs like the "Install new software dialog". I guess GridData.FILL is not appropriate for checkboxes anymore.(In reply to)In my opinion they never were. :PPraveen, could you look into this? If GTK is just drawing the selected state differently in 2.18, this might be a WONTFIX. Need to know for sure what's happening.This works for me. On both the GTK versions (2.16 and 2.18), the selection area of the checkbox pertains to its text adjacent to it.This applies to all the dialogs/views in the Eclipse, or even the ControlExample clearly shows the behavior for the selection/focus of check-box.Since the reported problem is expected behavior, closing as WORKSFORME. Please reopen with more details, if the problem seems to be different.ControlExample checkboxes have the correct selection area on GTK 2.18. Should we re-open and move this to CVS since that's the component that seems to be offending?We could do that...	11.0
id=499812	REOPENED	Platform	Text	4.7	PC Linux	P3 minor	Platform-Text-Inbox	2016-08-17 05:31 EDT by	Sopot Cela	2016-10-04 07:59 EDT (	4 users	See title.	See discussion onfor why this is necessary.The Gerrit patch doesn't show an activator any more. Should this issue be closed?(In reply to Mickael Istria from)is still around(In reply to Sopot Cela from)Do we have stats that show we are not micromanaging things here?(In reply to Dani Megert from)I have no stats. This was a request from Lars which I pushed to a later pass.As I said in the gerrit, I'll take a look after I take care of the major merge-blocking issues in the main patch.Please reopen if you have data that proofs we are gaining something.(In reply to Dani Megert from)Please leave this bug open for this investigation.	7.0
id=142557	REOPENED	Platform	User Assistance	3.1.1	PC Windows XP	P3 normal	platform-ua-inbox	2006-05-18 14:06 EDT by	Missing name	2008-06-18 13:03 EDT (	1 user	For Windows XP and Win2K the selected background color and hyperlink foreground color are shades of blue which provides little if any contrast between the hyperlink text and the background color. On Win2K the colors are the same and therefore the text disappears. Suggest adding selectedForeground and possibly selected activeForeground to the HyperlinkSettings to allow the hyperlink to reacte to selection and focused states	Please try again with a more recent 3.3 build and let us know if this still happens. In particular, provide a scenario where this problem can be seen.I tested this out with 3.3 RC3 and see no problem with the default/selected/active hyperlink colours in FormText.Closing as FIXED.CreatedXP blue theme with selected background color with hover over hyperlinkDoesn't look fixed to meSorry, the attachment is from 3.4RC3 using XP Blue themeCreatedscreenshot showing correct colorsI'm not sure what the "XP Blue Theme" is. Is this the default XP theme? If so, then I cannot reproduce the problem. Attached is a screenshot showing a selected link staying white on hover.Please provide more details and perhaps a testcase./** * Example of Selection background/foreground changing for hyperlink inside * FormText * * @author dsbrown * */public classextends ApplicationWindow { private static final int MARGIN = 10; private FormToolkit toolkit = new FormToolkit(Display.getDefault()); /** * @param args */ public static void main(String[] args) {bug = new(); bug.setBlockOnOpen(true); bug.open(); Display.getCurrent().dispose(); } /** * C'tor */ public() { super(null); } @Override protected Control createContents(Composite parent) { getShell().setText(""); //$NON-NLS-1$ parent.setSize(400, 250); final Form form = toolkit.createForm(parent); form.setText("Example"); //$NON-NLS-1$ final TableWrapLayout twLayout = new TableWrapLayout(); twLayout.leftMargin = twLayout.rightMargin = twLayout.topMargin = twLayout.bottomMargin = MARGIN; final Composite body = form.getBody(); body.setLayout(twLayout); toolkit.paintBordersFor(body); final Section section = toolkit.createSection(body, ExpandableComposite.EXPANDED | ExpandableComposite.FOCUS_TITLE | ExpandableComposite.TITLE_BAR | ExpandableComposite.CLIENT_INDENT); section.setLayoutData(new TableWrapData(TableWrapData.FILL, TableWrapData.MIDDLE)); section.setText("New Section"); //$NON-NLS-1$ final FormText formText = toolkit.createFormText(body, false); StringBuilder bldr = new StringBuilder(); bldr.append("<form><p>This is selectable text in a FormText widget with a <a href=\"\">hyperlink</a>.</p>"); //$NON-NLS-1$ bldr.append("<p>Select the text with the mouse and hover over the hyperlink. There will be no color change of the foreground color of the hyperlink on mouse hover.</p></form>"); //$NON-NLS-1$ formText.setText(bldr.toString(), true, true); return form; }Createdscreenshot of hovered link in provided sample codeI tried your sample code and this still works for me. I'm using the default Windows XP theme. Again, what is the "XP Blue theme"?The (XP blue theme) is the default scheme in Control Panel>Display>Appearance under Color scheme: Default (blue), Olive Green, Silver are the three that I have listed. What I see for behavior is a change in color of the hyperlink text foreground for unselected text on mouse hover from say blue underlined to black underlined. When the text is selected using the mouse, the text foreground no longer changes on mouse hover. For the Default (blue) scheme the selected text background is blue with white foreground for both mouse hover and non-hover behavior which is different from non-selected text behavior. I also get left an right 1 pixel vertical white bars that appear on mouse hover for the selected hyperlink text but do not ever go away once displayed. I think these may be from the selection highlighting rectangle that is not getting repainted when mouse hover ends.In your screen shot you are seeing white foreground on the selected hyperlink that is the same foreground as the rest of the text that is not a hyperlink. As the hyperlink started as a different foreground color than the rest of the text. Why is it no longer visually separated when selected?(In reply to)This is the same behaviour as both Firefox and IE. Browser behaviour is what we are attempting to emulate, so this is working as designed and I do not intend to change it.I do see the white bars you are talking about as focus changes in selected text, so I will keep the bug open to address that issue. Changing summary to reflect outstanding issue.I don't have an issue if the goal was to emulate browser behavior. CSS doesn't allow you to set the selected hyperlink color either. It just means that you can't use the FormText widget on anything with a background that approaches the selected foreground color because there would be no visual differentiation. Which is unfortunateCreatedFormText widget with different background	12.0
id=155558	REOPENED	Platform	User Assistance	3.3	PC Windows XP	P3 enhancement	platform-ua-inbox	2006-08-29 11:48 EDT by	Tim deBoer	2009-11-03 13:01 EST (	5 users	When the internal browser support was moved down from WTP to the platform, one piece of function (quick menu to change the current browser) was not accepted as platform function or API that should be exposed at the time. Since the function remained in WTP, there are 8 references to internal classes in WTP (see report below).This bug is opened to track cleaning up this internal usage, either through the platform picking up this function, exposing additional API, or other means. A correspondingis open against WTP, and I'm available to help with implementation once we decide which way to go.WTP build API report:org.eclipse.wst.server.ui.internal.webbrowser.SwitchBrowserWorkbenchActionCannot reference:org.eclipse.ui.internal.browser.BrowserManagergetInstance(...) 99 100getCurrentWebBrowser(...) 99getWebBrowsers(...) 101org.eclipse.ui.internal.browser.IBrowserDescriptororg.eclipse.ui.internal.browser.WebBrowserPreferencegetBrowserChoice(...) 97 104org.eclipse.ui.internal.browser.WebBrowserUtilcanUseInternalWebBrowser(...) 96org.eclipse.wst.server.ui.internal.webbrowser.SwitchDefaultBrowserActionCannot reference:org.eclipse.ui.internal.browser.BrowserManagersetCurrentWebBrowser(...) 54org.eclipse.ui.internal.browser.IBrowserDescriptorgetName(...) 40org.eclipse.ui.internal.browser.WebBrowserPreferencesetBrowserChoice(...) 51 53	Could you elaborate a little on what the function is for?The function adds a menu item to the Windows menu that has a submenu listing all of the available Web browsers. The user can see which browser is currently being used and select a different one. This is handy primarily for web developers who want to test their code on multiple browsers - they can easily toggle between browsers by using keystrokes or menu item instead of going to the preference page.If you want to see the code (it's very simple), you can find the org.eclipse.wst.server.ui classes listed above in the WTP SDK.It looks like nothing has changed related to this after almost 3 years.I would like to see the browser support classes to become a public API too. I think a lot of plugin developers would love to see which browsers are supported and launch one of their choice without resorting to internal functions.More specific, I'm talking about the following functionality:- See which external browsers have been configured: BrowserManager.getWebBrowsers()- See if the internal browser is available: WebBrowserUtil.canUseInternalWebBrowser()- Launch one specific browser. This is currently only possible by using WebBrowserPreference.setBrowserChoice(), but this clears the browserIdMap in DefaultBrowserSupport which makes it impossible to reuse old windows.The main reason this has not been implemented so far is competing priorities and limited resources. Would you consider creating a patch to add this functionality to Eclipse?Sure, I'll look into it within the coming weeks.Createdproposed patchHere's my proposal for the change.I tried to keep it as simple as possible, so I didn't touch IWorkbenchBrowserSupport or anything else outside of the org.eclipse.ui.browser jar.I added 2 new methods to DefaultBrowserSupport next to th existing createBrowser methods:- createInternalBrowser: creates an internal browser regardless of the user preference- createExternalBrowser: creates an external browser from the given IBrowserDescriptorThese methods and a few others are made public for the outside world in a new class org.eclipse.ui.browser.ExtendedBrowserSupport, this one also makes sure the browser support is loaded before using it.Legal Message: I, Tim Slechten, declare that I developed attached code from scratch, without referencing any 3rd party materials except material licensed under the EPL. I certify that I am the copyright owner and authorize this contribution.Targeting 3.6M3The new API is not totally clean - I get this warning when I turn on API checking in the PDE preferences. Can you take a look at this and see if this can be fixed without exposing large numbers of new API interfaces?IBrowserDescriptor.getWorkingCopy() has non-API return type IBrowserDescriptorWorkingCopy IBrowserDescriptor.java /org.eclipse.ui.browser/src/org/eclipse/ui/browser line 73 API Usage ProblemCreatedupdated patchI missed that one.IBrowserDescriptorWorkingCopy can be easily exposed without dragging anything else along with it, it is just a small extension to IBrowserDescriptor.See updated patch.Patch committed to HEAD after making minor changes to update copyright, add correct @since tags and update bundle version. Fixed.The changes are great, but reopening since it doesn't cover all of the original request. Specifically, there is no API for the following internal usage: WebBrowserPreference.getBrowserChoice() WebBrowserPreference.setBrowserChoice() WebBrowserPreference.INTERNAL WebBrowserPreference.EXTERNAL - gets and sets whether the internal browser or an external browser is the current preference BrowserManager.getCurrentWebBrowser() BrowserManager.setCurrentWebBrowser() - gets and sets which external browser to useWTP has a menu that displays the user's browser preference and quickly change it without going to the preferences.Can you submit another patch?CreatedPatch converting rest of WTP usage to APIHere's a patch that adds the remaining usage as API. I've gone as clean as I thought I could, but there are two aspects here: whether or not the internal browser is the current default, and if it isn't which of the external browsers is. With getters and setters that adds up to 4 new methods. I've gone with 'default browser' as the terminology for which browser will be used if you don't specify one. Feel free to change this to 'current browser' or something else if you prefer.I've confirmed that this additional change provides API for all internal usage from WTP server tools, and I have a corresponding patch ready for WTP () to react to this change and remove all internal usage.FWIW, I also looked at if the original change could have been made in a 'non-breaking' way, since the WTP build is currently going to fail when picking up a new platform build. I haven't found any good way of doing that without doing it in multiple steps, which would be too much of a pain on both sides. This additional patch doesn't break anything new, but preferably we'd get it in ASAP so that WTP only needs to make changes once.The patch looks good, I have applied it.It turns out that the incompatibility with previous versions of WTP has the potential to cause problems, for example in a shell sharing environment and we cannot guarantee that users will not update to a newer version of org.eclipse.ui.brower without updating WTP. For this reason I have backed out thse changes for now. I will work to see if they can be done in a way that adds new API without breaking backward compatibility.Reopening since the patch was backed out.	17.0
id=179273	REOPENED	Platform	User Assistance	3.2	All All	P3 normal	platform-ua-inbox	2007-03-26 06:25 EDT by	Sebastian Davids	2010-04-29 18:07 EDT (	3 users	*.xhtml files do not have an "Open With/Web Browser" context menu entry.	Moving to Platform since that's where the Web Browser comes from.Createdfixshtml (which is quite uncommon) is already included, so I see no reason why xhtml should not be included.This bug has a patch ready to go. Sorry for not forwarding it to UA earlier.Tentatively targeting RC1Dejan, do you see any reason not to do this?David, is WTP ok with this change?Yes, fine for now. In 3.4, we may want to reconsider and/or have a more coordinated cross-project content type. But, does no harm. That is, nothing "worse" that is already being done for html, shtml, etc. Thanks for checking.Curtis, do you think this is OK to put into RC1? If so can your +1.+1Fixed in HEADWe had to back this fix out, see.***has been marked as a duplicate of this bug. ***	12.0
id=143928	REOPENED	Platform	User Assistance	3.2	PC Windows XP	P3 normal	platform-ua-inbox	2006-05-26 06:48 EDT by	Martin Aeschlimann	2011-04-29 12:46 EDT (	1 user	RC6- open help > help contents- enter 'IContextMenuConstants' -> No matches foundAPI reference would be	Sorry, my fault. I happend to have configured a scope that expluded the API Reference.Sorry again, still doesn't work. While putting the scope to 'All Topics' helped me finding help for 'ITypeInfoRequestor', I still doesn't for IContextMenuConstants.Are you running with the doc plugin in your workspace and a run-time workbench? The javadocs only get added to the isv doc plugins during build, so if you check out from CVS it won't have it and won't find it.It's a normal startup from an installed Eclipse.It's with I20060526-0010 and I have other searches that don't seem to work. E.g. 'JUnit' result in 0 matches. Same on Dani's machine. The log says!ENTRY org.eclipse.help.base 4 4 2006-05-26 11:15:03.183!MESSAGE Help documentation could not be indexed completely.!SUBENTRY 1 org.eclipse.help.base 4 4 2006-05-26 11:15:03.183!MESSAGE Help document /org.eclipse.gef.doc.isv/notices.html cannot be opened.!SUBENTRY 1 org.eclipse.help.base 4 4 2006-05-26 11:15:03.183!MESSAGE Help document /org.eclipse.platform.doc.isv/reference/api/org/eclipse/ui/ide/fileSystem/package-summary.html cannot be opened.!SUBENTRY 1 org.eclipse.help.base 4 4 2006-05-26 11:15:03.193!MESSAGE Help document /org.eclipse.platform.doc.isv/reference/api/org/eclipse/jface/menus/package-summary.html cannot be opened.!SUBENTRY 1 org.eclipse.help.base 4 4 2006-05-26 11:15:03.193!MESSAGE Help document /org.eclipse.platform.doc.isv/reference/api/org/eclipse/jface/layout/package-summary.html cannot be opened.It would be very bad it the missing files can block the index to complete for the other files.Note that I have WTP RC2 as extra plugins as well. With that I get 1 match for 'JUnit', but in WTP. It is mentioned many times in JDT, so that's still strange.What is your locale?en_USI tested with I20060526-0010, WTP 1.5 RC2 + dependencies, on en_US locale, and I get many JDT results. I also get the same log errors, so I don't think it's because of those problems.The only thing I've seen like this is when using a non-english locale.. see. It would actually be consistent with what you're seeing - results from WTP only, because they don't appear to have their content pre-indexed, and that bug only affects pre-indexed docs.Could you double check the log to make sure it was not in some other locale? Or, have you run the same workspace and/or configuration with a non-english locale in the past?I don't think that I only see WTP result. I also have JDT result, but not all.As mentioned in, I find IContextMenuConstants but not ITypeInfoRequestor.The local setting I got from Help > About > Configuration. I could well be that this workspace was also opened in a different locale.Only the package overviews are indexed by help, not the class specific javadocs. When I search for both ITypeInfoRequestor and IContextMenuConstants, I get links to the package overviews as expected (using en_US).Martin, are you still able to reproduce this on 3.3RC4?Using I20110427-1300 I find matches for both IContextMenuConstants and ITypeInfoRequestor. Is this different from your results? Are there any other examples of strings that are not found when searching the documentation?	11.0
id=159745	REOPENED	Platform	User Assistance	3.2.1	PC Windows XP	P3 enhancement	platform-ua-inbox	2006-10-04 11:59 EDT by	Michael Barkhouse	2009-02-11 15:31 EST (	1 user	I'm working on a dynamic wizard. By dynamic I mean the pages are not hard coded in the wizard. My clients provide me with one or more Composites each of which represent a page in the wizard. Each Composite has setup it's integration with the help system by calling the setHelp method from IWorkbenchHelpSystem.I want all of my pages to be scrollable, so I'm wrapping the client Composite in a ScrolledComposite. From my wizard, if I open the help it looks ok. However, if I press the Next or Back buttons to change the page the help is not automatically updated. I need to press F1 again to get the help of the new page.I determined the reason for this is the help was set for the client Composite, not the ScrolledComposite I wrapped the client Composite in. I had to ask the client Composite for it's help id and then set the help id of the ScrolledComposite to be the same.Here's how I implemented this: Object helpId = clientComposite.getData(WorkbenchHelpSystem.HELP_KEY); if (helpId instanceof String) PlatformUI.getWorkbench().getHelpSystem() .setHelp(scrolledComposite, (String) helpId); The field WorkbenchHelpSystem.HELP_KEY although public is declared in an internal class. So I should not be using it. I could not find any way in the public API to do this. If there is a way please let me know what it is and close this enhancement request. If there isn't, please consider adding one in a future release.	What you need to do instead is set the focus appropriately upon page activation so that after you click next, the focus is set on one of the fields in the new page. This is not only useful for context help but also for usability so that users can start typing right away or tab through the page.For an example, see File -> New -> Project. Select General -> Project and click Next. Notice how the focus is automatically set on the Project name field and you can start typing right away. Doing this should solve your problem.I have seen examples where setting the focus to a particular control in an editor has caused the proper help to be displayed, but I haven't seen an example for a wizard. An example was given in the last update to this defect about the New Project wizard. It's true that it does set focus to a particular control and that the proper help is always displayed as the user traverses the wizard pages. However, I do not think this has anything to do with the fact that focus was set to a control.To test my theory, I imported the plug-in that defines the New Project wizard, org.eclipse.ui.ide, into my workspace. In the method that sets the focus to a control, WizardNewProjectCreationPage.setVisible(), I commented out the line that calls setFocus(). I launched a runtime workbench and opened the New Project wizard. On the first page I noticed the text control at the top did not have focus (because of my change). I pressed F1, the help opened and displayed the proper text. I pressed Next to move to the next page and the help changed to the help for the new page. I went back to the previous page and again the help changed. This is exactly how I would expect it to work and it was done without setting focus to a control. Also note that the second page of this wizard never explicitly sets focus to a control like the first page does and it also works.Perhaps this strategy works for editors, but I'm not convinced it does for wizards. I think the reason the New Project wizard works is a help id is assigned to the top most Composite of each page. When I do this in my wizard, everything works too. It's not as straight forward for me tho because, as I described in my initial comment in this defect, I am hosting pages that others define. I am wrapping the Composite of each client page in a ScrolledComposite. I think in order to get the help to update properly I need to extract the help id from the client composite and set it in the scrolled composite.I will attach a plug-in to this defect that simulates the design of my wizard. It contributes a wizard with two pages. I'm using the help ids from the import/export wizards just as an example. Maybe you can use it to prove me wrong. :) If not, does my original request to provide public access to WorkbenchHelpSystem.HELP_KEY now make sense?CreatedExample wizardWorkbenchHelpSystem is defined in org.eclipse.ui.workbench. Reassigning to Platform UI for consideration.Boris, I notice that you assigned this back to UA. Do you have any thoughts on this bug (the code in question lives in org.eclipse.ui.workbench)? I'm thinking that we don't necessarily want to expose the constant WorkbenchHelpSystem.HELP_KEY because that is an implementation detail of how the context help information is stored. On the other hand wanting to know the context help id of a control seems like a valid use case - I don't know how often it would occur.	5.0
id=214528	REOPENED	Platform	User Assistance	3.4	PC Windows XP	P3 normal	platform-ua-inbox	2008-01-07 14:43 EST by	Payman Maghsoudian	2008-03-31 17:26 EDT (	3 users	CreatedIndex ErrorBuild ID: I20071213-1700Steps To Reproduce:1. Install a Multilingual Eclipsehelp (using fragment)2. By using a browser, try to change the language to the different languages except English (by passing ...?lang=xx)3. Select English,French and then German, the all indexes for the selected languages are displayed at the same time at Index Tab.4. If we open another browser with a language rather than English, we have the same problem, but In this case, if we select English again, just the indexes in English are shown.More information:	After some investigation on this problem, I found that this is not a bug in Eclipse and rather it's a bug of DITA-OT.Please check the following link for more detail:Are you using your own help content? If you are able to attach a small test plugin which contains an index in more than one language and which demonstrates teh problem I can look into it.I'm using Infocenter for displaying Help of a web application andby using DITA-OT, we create the eclipsehelp files and then we pack them and infocenter project into a single war file.The problem was when we used ANT scripts in DITA-OT to create the eclipsehelps consecutively for several langagues for example en, fr, de, the DIAT-OT kept the indexes in memory and added the new ones to them. So at Infocenter just the first one was correct and the next ones were mixed.Anyway, I fixed this problem by cleaning the index of DITA-OT ant task after every build and now the life is good.I can attach the patch of DITA-OT if you are interested but I think we must discuss it in DITA-OT forums.Closing as WORKSFORME. The DITA forum would indeed be the right place to discuss anything DITA related.Hi Chris,In fact, the problem that I mentioned about mixing the indexes in Infocenter was a problem in DITA-OT but I have still another problem in indexes.I put my help war here:In french version by connecting to, at second index page, there exist some terms in English, for example, 'Searching inbound history records'. I checked at plugin folder for 'fr' and at index.xml ([webapps]\faxhelp\WEB-INF\eclipse\plugins\userguide.nl\nl\fr\index.xml) and the related phrases for these terms were in French and another problem is that the these indexes in English are not displayed at English help.It seems that this one is a bug of Eclipse.I will appreciate you, if you can verify this issue.Thanks	5.0
id=187352	REOPENED	Platform	User Assistance	3.3	Macintosh Mac OS X - Carbon (unsup.)	P3 enhancement	platform-ua-inbox	2007-05-16 14:55 EDT by	Adam Archer	2011-05-04 18:14 EDT (	1 user	Previously the SWT browser was disabled on the Mac platform since it was not stable with Safari. It should be re-enabled.When this is done, the external browser option needs to be added to the preferences page on Macs and the test cheetsheat will need to be modified to reflect the option.	CreatedPatchFixed in HEADPatch tested on MacOS Carbon, Windows, Linux.This fix is being backed out, see.	4.0
id=224893	REOPENED	Platform	User Assistance	3.4	PC Windows Vista	P3 normal	platform-ua-inbox	2008-03-31 09:48 EDT by	Moshe WAJNBERG	2009-07-27 18:29 EDT (	5 users	Build ID: 20080314_1059Steps To Reproduce:1.On a Windows platform with Hebrew default locale lauch Eclipse with the -nl iw argument2. Open the Welcome page (Help->welcome page)3. Double click on the Welcome Page tabThe Welcome page appears at the left of the screen and is not mirrored (see capscreen)More information:	I'm not sure that this is an issue. The Intro simply shows a Browser onto its HTML...what happens if you define an Intro whose HTML content is in a RTL language?I'm not sure that this is an issue. The Intro simply shows a Browser onto its HTML...what happens if you define an Intro whose HTML content is in a RTL language?Is this the same problem that is described in?Yes you are right. This the same problem that is described in?This is a duplicate ofwhich I am hoping to be able to address for Eclipse 3.4.*** This bug has been marked as a duplicate of***I tried the scenario of this bug, I found that not all the defects are fixed.For example, the tooltip text beside icons is not right aligned and icons are not mirrored. Please refer to the screen shot in the attached file.CreatedScreen shot of the Welcome pageReopening to track the remaining issues.	8.0
id=220876	REOPENED	Platform	User Assistance	3.4	All All	P3 normal	platform-ua-inbox	2008-02-28 23:15 EST by	Paul Slauenwhite	2009-05-20 14:35 EDT (	3 users	Clicking duplicate topic headings jumps to the first instance.When a topic is reused, clicking the second instance of the topic jumps focus to the first instance. Steps to reproduce:1) Download TPTP 4.5 M5 all-in-one package ().2) Open the Help and select Testing applications >> Testing with JUnit >> Generating test reports.3) Note focus jumps to Testing applications >> Testing performance >> Generating test reports.	I have noted something like this as well. I have multiple help plugins where each has its own overview and release notes pages which have links in the various pages of the Welcome screen. When the user clicks on a link the correct page appears in the help pane but the wrong TOC entry is highlighted.Out help plugins are grouped in the TOC using a common top-level entry that looks like this:Product Help- Manual A-- Overview- Manual B-- Overview- Manual C-- OverviewIf I throw out the top-level entry (Product Help) so that the help plugins appear in the TOC list ungrouped, then the links and the TOC highlighted are correct.I have been able to reproduce this, it happens when a topic occurs more than once with the same href and the same title and when the "Link with contents" button is on. Will fix for 3.4.CreatedPatchFixed in HEAD. Frank, can you see if this fixes your problem also? If not can you file a separate bug?Tried just copying the nightly build files into the product and had no luck, but the product is still based on the 3.3 release. Will be converting it to use 3.4 sometime soon. Will check again at that time and let you know.Chris, this is still a problem in Eclipse 3.4 M6 (I20080305-1100).The fix may have been too late for that particular I-build. Can you try using N20080310-0100 or wait for this weeks I-build.Sorry Chris, the Eclipse 3.4 M6 N20080310-0100 build contains the fix.Verified in the Eclipse 3.4 M6 N20080310-0100 build.Chris, we are seeing a similar behavior with the I20080330-1350 driver. Although the original problem is resolved, clicking on a link in a HTML file that references a shared file, the topic jumps focus to the first instance.Can you elaborate on the previous comment? Do both topics have the same href? If the same href appears in more than one table of contents or more than once in a single table of contents then the show in table of contents will pick the first one that it finds. Does this describe the problem you are seeing?(In reply to)Sorry Chris for the late reply.We are using relative URLs in the hrefs. I believe what you described is the problem we are seeing. Can you confirm using the following example:>> Analyzing test resultsWhen following a hyperlink from one page to another the algorithm for highlighting in the toc does indeed look through all the books for the first match for that href. It is not always going to be possible to determine the right topic to select but there are some cases that could be handled. I see three distinct cases1. Following a hyperlink from topic A to topic B which exists in the same book and in another book, only one instance of B exists in that book. This is the case that we would be easiest to handle.2. Following a hyperlink from topic A to topic B which exists in the same book, more than one instance of B exists in that book. This is much harder, we can pick the right book but how do we decide which of the topics in that book is the correct one? I'm guessing that this is the most common case.3. Following a hyperlink from topic A to topic B which only exists in other books. In this case there is no way to know which book was intended. I think this case might be pretty rare.Paul, am I correct in thinking that case 2 is the one you are interested in?(In reply to)Hi Chris. Yes, you are correct that use case #2 applies to us. Since we are always linking to a topic that is within the current branch of the TOC, could you walk up the branch to find the first instance?It may be possible to handle just that one case where the link target is an ancestor of the page containing the link. I need to think this through to see what the implications are, I don't want to add overhead to the show in toc mechanism if I can avoid it.There is a way which you can disambiguate multiple identical pages in a TOC byusing anchors which allows you full control of which page will get selectedwhen you follow a link. I think that this is preferable to using a heuristic totry to guess which page is the correct one to highlight. This does not requirethe page in question to contain any anchors Consider this TOC<?xml version="1.0" encoding="UTF-8"?><?NLS TYPE="org.eclipse.help.toc"?><toc label="Anchored TOC" topic="html/toc.html"> <topic href="html/a.html#A1" label="Topic A1"> <topic href="html/b.html" label="Topic B11"> </topic> <topic href="html/a.html#A12" label="Topic A12"> <topic href="html/c.html" label="Topic C121"> </topic> </topic> <topic href="html/b.html" label="Topic B13"> <topic href="html/d.html" label="Topic D131"> </topic> </topic> <topic href="html/c.html" label="Topic C14"> </topic> <topic label="Nav Topic"> <topic href="html/e.html" label="Topic E151"> </topic> <topic href="html/a.html#A152" label="Topic A152"> </topic> </topic> </topic> <topic href="html/maintopic.html" label="Links"> </topic></toc>And this html snippet:<a href="a.html#A1">link to A1</a><a href="a.html#A12">link to A12</a><a href="a.html#A152">link to A152</a>Page a.html appears 3 times in the same tree but each link clicked will cause adifferent node is highlighted.Can you try this to see if it works for you?Removing the 3.4 milestone because the last problem as described inis not easy to fix and we are late in the cycle. The problem initially described has been fixed.(In reply to)This solution does not pertain to our situation. We have several subtopics that link to a shared TOC. For example, the following link to:When the user selects the link intofor Help >> Help Contents >> Testing applications >> Testing with JUnit >> Analyzing test results >> Opening a test log, it opens Help >> Help Contents >> Testing applications >> Testing performance >> Analyzing test results >> Opening a test log.Hi Paul and Chris,Do you think there should be a separate (new) bug entry for symptoms that occur when a shared toc file is used in multiple locations?I ask because I have been testing with another information set that uses <link toc=.. to a shared toc file in multiple locations, and I've discovered some additional symptoms involving search. The symptoms seem to only occur when a toc file is reused in multiple locations, and not specifically what this Bugzilla was originally about.Chris, the solution inwon't work when a toc.xml file is linked in multiple places, because the hrefs at those <link toc spots are identical in each spot. There's no facility for us in the hrefs to include unique anchors because it's the same toc.xml file that gets resolved at run-time in those locations.(I don't know--maybe there could be a new attribute on a <link toc element that specifies the context for that particular reuse instance, and on resolving the entries at runtime, that attribute is converted into an anchor in the hrefs.)If you want to keep the discussion in this bug, that's fine also.Best,Lee AnneUsing a shared toc file is used in multiple locations sounds dangerous, but as far as I know it is legal and yes there should be a separate bug for each problem.	20.0
id=260193	REOPENED	Platform	User Assistance	3.4.1	PC Windows XP	P3 normal	platform-ua-inbox	2009-01-06 21:33 EST by	Yi Yan Zhou	2009-01-14 20:46 EST (	1 user	Build ID: I20080617-2000Steps To Reproduce:1.Open help.eclipse.org in English locale2.Search "to_show"3.Get results with "show" onlyMore information:If I search keyword with underscore in non-English locale, the result is correct. So I guess if the weight is raised in English locale, it would solve the problem.	This is actually a result of search stemming, which is Lucene's way of recognizing slight variants of words, for example a search for "apple" will match "apples" in English. In other languages the matching rules will be different, which is why you saw different results. Lucene will also ignore common words such as "to" in English.If you search for "to_show" help will look for an exact match.I have to disagree. The keyword "browse topics"(with double quotes) and browse_topics give the same result in help.eclipse.org site. And if you search _topics and it will give the same result as topics, too.So I don't think it's a stemming case, Lucene is definitely ignoring underscore in the search, which does no good for users to search for API keyword with underscores.CreatedPossible patchI took a look at the source and I can see where the query is being tokenized, in org.eclipse.help.internal.search.Analyzer_en.tokenStream(String, Reader). This uses a subclass of org.apache.lucene.analysis.CharTokenizer at its tokenizer. The patch simply allows underscores to be part of a token.I need to think through the implications of this some more since this analyzer is used when builing the search index as well as when processing the query. What this means is that with the patch a search for "abc" will not match "abc_def" as it used to. I'm not sure if that is a good or a bad thing.An alternative would be for the query builder to always enclose tokens containing underscores in quotes but this would prevent wildcards from working if you have an underscore in a token.The other option is to leave it to the user to surround the search term in quotes, although few users would realize how to do this.Does this only affect underscore or are there other characters which have similar qualities?The code makes me think that all the other non-digit-and-alphabet characters are treated the same way like underscore. But until now, I didn't get any compliant except for the underscore case.I suggest that we can use the original tokenizer method during the index and the new tokenizer (that consider underscore non-splittable in the keyword) during the search.Another method is to do a two phase search: the original keyword and the keyword with double quotes. The exact match could be given higher priority to show on the top.If I use the original tokenizer for indexing and treat underscores as not being a token separator in the query any search for a term containing an underscore will yield no matches (I tried this).Let me take an example here. For "CHAR_LEN", the original indexer will get keyword "CHAR" and "LEN" only. Can "CHAR_LEN" also be recorded?	6.0
id=298369	REOPENED	Platform	User Assistance	3.5	PC Linux	P3 normal	platform-ua-inbox	2009-12-21 20:50 EST by	None	2011-03-03 17:25 EST (	1 user	Build Identifier: 20090920-1017OS: Linux (Debian Lenny)Base Package: RCP/PluginAfter installing and running Eclipse once and then placing CDT in the dropins directory and then running Eclipse once more, the Welcome screen is updated from the default RCP/Plugin layout to a multi-selection layout showing the available functionality of all installed plugins, including C/C++ Development.However, if Eclipse is not run once before placing CDT in the dropins directory, the Welcome screen does not update to the multi-selection layout.Reproducible: AlwaysSteps to Reproduce:1. untar Eclipse2. place CDT zip file contents in a directory under dropins3. start Eclipse4. Note that the Welcome screen is the default RCP/Plugin layout and not the multi-selection layout	I don't think this is related to installation technology. User Assistance creates a special Welcome page that highlights new content that has been installed *after* first use. This doesn't apply to the initial welcome page, which is specified by whatever product you are running. Moving to UA for further comment.I believe that this is working as designed. After new bundles containing welcome content are installed into Eclipse and Eclipse is started the page containing those bundles will be shown in Welcome. This is what is happening when you run Eclipse after installing CDT. If you are running Eclipse for the first time you will see the home page, even if you have added CDT to the dropins folder.If this is what you are seeing I will close this bug out.Closing since this is working as designed.(In reply to)I'm sorry for not replying to your first comment Chris, but did you actually read my report and steps to reproduce?Depending on the order the plugins are installed and Eclipse is started, the welcome screen NEVER switches over to the bundles multi-selection layout. I fail to see how this could be working as designed.So after CDT is installed every time you restart Eclipse it still shows a welcome page other than the start page? That is expected behavior the first time you restart after installing new plug-ins but is not expected after the second restart.(In reply to)The welcome screen NEVER switches over to the bundles multi-selection layout, no matter how many times eclipse is restarted.Is this still an issue. I just installed CDT and the Welcome page looks to be working as expected.	7.0
id=308520	REOPENED	Platform	User Assistance	3.6	PC Linux-GTK	P3 normal	platform-ua-inbox	2010-04-08 12:50 EDT by	Mohamed El-Kholy	2010-05-25 17:59 EDT (	8 users	CreatedWrong display of Arabic characters in internal address barFollow same steps as inDownload TPTP All_In_One 4.7.0 M6 build and extract it on a RHEL machine set locale variables (LANG and LC_ALL) to ar_EG.UTF-8Create a workspace, then a java project with an Arabic name, then create JUnit test cases and testsuites, make sure there are Arabic contents in test cases (test case name, Javamethods and classes) Generate a report for the testsuite, give the report an Arabic name Open the report in Eclipse internal web browser, the name of the report is not shown correctly in the address bar of Eclipse internal browser, Arabic characters are replaced by what appears to be ascii code points values	CreatedCorrect display of Arabic characters in address in Eclipse internal browser on Windows7 The Arabic characters in address bar are displayed correctly but the order is not correct, this issue will be addressed in another bugCreatedWrong ordering of Project name and report name in address bar of Eclipse browser for Arabic textMohamed: What are the following results:RHEL: FireFoxWindows 7: FireFox and Internet ExplorerCan you attach the project/report?Note, opening a report with Arabic characters in its name with Internet Explorer or FireFix causes the same symptoms as.There are two symptoms:1) Corrupt Arabic characters in the title and address bars when opening the report in the internal Web browser (Linux only). This is caused by the internal Web browser and the symptom cannot be fixed or worked-around programatically in TPTP.2) Wrong order of the project and report names in the title and address bars when opening the report in the internal Web browser. This is caused by Eclipse when creating IFile resources. We create resolve the report file from its container (project in this case) and the resultant IFile contains the incorrect ordering (see org.eclipse.hyades.test.tools.ui.common.internal.report.ReportWindowWizard.getReportFile()) and the symptom cannot be fixed or worked-around programatically in TPTP.(In reply to)Paul, I will change component to UI, as the problem is not TPTP related but it still exist (the encoding problem on RHEL, but for Windows, it is addressed in another bug "308536")Reopened against Platform/UI(In reply to)AFAIK that's just text in a combo box in the org.eclipse.ui.internal.browser.BrowserViewerI was under the impression that we still don't support BiDi text in "input" widgets like Text. In this case it's a GTK+ Combo box.Felipe, is this something that should just work if we apply TextProcessor to it? Or is that likely to hurt the browser itself since it's a URL that will be passed to the native browser widget?PW***has been marked as a duplicate of this bug. ***(In reply to)This isn't valid for this bug.PW(In reply to)>OK, here we are displaying the encoded URL (using the standard %xx notation).The question is are we doing this, or is URL returning this (I would expect the same on both win and linux, though).PWThe BrowserViewer is simply setting the text in the address bar to the location returned from the browser widget. The url is correct in the sense that it conforms to the character standard for URIs which require non ascii characters to be encoded. It is however not easy to read.If I understand the bug the request is to display unencoded characters, is that correct? Does the URL as displayed work to open the file or does that fail? Some browsers will display unencoded characters in the address bar, for example I did an experiment with creating an html file in a folder whose name was in russian characters and opened that file in Firefox. Firefox displayed the russian characters in the address bar as part of a url with file: protocol, but if you copy that address it is encoded and contains only ASCII characters. I also searched around the web a bit to see if I could find a link to a URL containing non ASCII characters (encoded or unencoded) but could not find one so was not able to use that for testing.I'm guessing the problem would be most likely to show up when using the file: protocol and It seems that a possible solution would be to unencode the url before showing it in the address bar and encode it when the user chooses to navigate to that address. I need to think this through to see if there is a downside to doing that.This bug is currently marked as P1 which we interpret as "stop ship" priority. Chris if you aren't planning to address this for 3.6 can you update the priority?This should not be P1, the file is opening correctly it's just that the URI is not unencoded before display.	14.0
id=323937	REOPENED	Platform	User Assistance	3.5	PC Windows XP	P3 normal	platform-ua-inbox	2010-08-30 05:05 EDT by	salever	2013-08-13 06:23 EDT (	7 users	Build Identifier: I20090611-1540When you search the help contents using 'Help' --- 'Search', there will be a list of result details. And after moving the scroll bar on the right a litter lower, try to select some contents dragging mouse's left key. The selection shows abnormally and the cursor locates in the wrong position.Reproducible: AlwaysSteps to Reproduce:1.Open "Help" menu and click on "Search"2.Search a key word, eg. "new"3. Move the right scroll bar a little lower4.Try to select some content using the left key of mouse5.funny Selection	CreatedsnapshotSearch "new", and here is the snapshot of bug.I can reproduce the problem. Targeting Eclipse 3.7Found this problem when using the FormText control with a ScrolledForm as a parent. Besides the "Help" sections its also evident in the IDE anywhere the FormText is used and a scrollbar is present, just select the text and scroll and the problem shows up.This problem does not show up in Eclipse 3.7 M3, using 3.7 M2 the problem still exists so the bug has been fixed indirectly between M2 and M3. I'm pretty sure that the fix foris what also fixed this problem.The problem has returned since the fix for the fix forwas backed out. I don't want to close this as a duplicate since it may be possible to fix this bug without getting the bad side effects of the fix to.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***CQ:WIND00209292(In reply to)Chris, did you find any such fix that would have less impact on other areas?HelmutI spent a day or so working on this earlier this year. While I was under the impression that it would be easy to separate the part of the patch that fixed the layout issues from the part of the patch which handled the transparency that was not the case. I spent quite a while debugging the layout algorithm to see if I could see why it was miscalculating the effect of the scrollbar. I did not end up getting to the root of the problem as the FormText layout code is quite complex and not well documented.(In reply to)Thanks Chris, sounds like a complicated fix...What's your estimate, will there be time to spend on analyzing and fixing this bug in the 3.8 time frame?TIA,Ciao, HelmutI would like to think that this can be fixed in Eclipse 3.8, it's mainly a question of getting a large enough block of time to work out the problem.	11.0
id=284393	REOPENED	Platform	User Assistance	3.5	PC Windows XP	P3 major	platform-ua-inbox	2009-07-23 05:46 EDT by	Philipp Kursawe	2012-11-04 11:34 EST (	11 users	Its currently not possible to use the FormText outside a form, cause it refuses to draw itself transparently over its parent. I tried every trick (transparent GIF as parents background image, setting the background colour to null gets reverted to the default control colour). Is there a reason why every other control can render itself transparently when its parent has the INHERIT_FORCE background mode set, except for the FormText? Does its paragraph rendering not support rendering without a background colour set?It would be very nice, if that behaviour could be changed, although I have no idea how. Maybe just allow to set a null background colour would do the trick?	Do you have a code sample which illustrates the problem? Can you attach a screenshot also?CreatedNon-transparent form on compositeI am painting the background myself in the resize listener, and set a background image for the parent. On top of that I create controls, which are all transparently painted except for the FormText. See attached screenshot.parent.setBackgroundMode(SWT.INHERIT_DEFAULT);final String message = formTextNotification.getFormTextMessage();text = new FormText(parent, SWT.WRAP | SWT.NO_FOCUS);((FormText) text).setText(message, true, true);I can verify this as well.The implementation of FormText does not seem to support any kind of transparency at all.The problem seems to be the way FormText is being painted:there is a bit of hand crafteed double buffering going on, where the text is being painted on an intermediate image (FormText.java lines 1573-1603):On the line 1581, the text buffer is being created: GC textGC = new GC(textBuffer, gc.getStyle());On the line 1585, the text buffer is being filled with the background color: textGC.fillRectangle(0, 0, width, height);And later on the line 1601, the buffer image is being painted to the GC: gc.drawImage(textBuffer, x, y);I see few problems with this approach:1) the most obvious one is that the text background is being explicitly repainted2) the less obvious one is tat the text is being painted on the image. As I've found out the hard way, the image objects created inside the SWT are opaque by default and making them partially transparent does not come naturally to them (e.g. you'll have to manually post-process the resulting image data to insert alpha channel information - painting on a transparent image is not very useful either, as the whole result remains transparent)One possible solution (with the least amount of changes) would probably be to paint the FormText content twice on two images in parallel - once for the actual display value and once on a grayscale image for a alpha channel calculations, then compose the grayscale and full color imaged into a new image with appropriate alpha channel bits set up and use that image to draw to the canvas.This would of-course be also twice as slow as current method, so it might not be as desirable approach as some other, but would probably yield the most accurate results.The control could check the SWT.TRANSPARENT style and only perform the described approach if the user created it in transparent mode. This would also not affect existing code.(In reply to)there's a warning in SWT.TRANSPARENT javadoc:: * WARNING: THIS API IS UNDER CONSTRUCTION AND SHOULD NOT BE USEDAdded my vote to this bug. FormText is a good control to use in any UI where one needs a stand-alone label that would not be normally read by a screen reader. Since it can get focus on tab traversal, it will be read. The other alternative is to use a read-only border-less Text field, which has a number of undesirable characteristics on some platforms when used in this way. Unfortunately, the lack of background transparency for FormText, is a show-stopper for this usage. You don't have to draw your own background to run into a problem with this. Some variants of Windows, for instance, will draw a gradient across the active tab in a tab group. A FormText in this context looks terrible. I am even seeing this problem in default Vista config. The default tab background is plain white, the default dialog background is gray. FormText draws a gray background.There is a related problem with how FormText handles disabled state. It sets the background to a fixed color (among other things). There needs to be a way to tell it to leave the background alone in either enabled or disabled state.Resolving this issue would make it easier for people to write accessible UI in Eclipse without sacrificing appearance.Is this assigned to the correct inbox? FormText seems to me more of a general facility than help system. I just went through and ripped out out all references to FormText from the product that I am working on. Too many transparency glitches that aren't getting addressed. We aren't even doing anything fancy with the UI. It's just that the lack of transparency in FormText makes it not render properly when placed in a tab group on many operating systems.(In reply to)FormText is from org.eclipse.ui.forms.widgets.The Forms API is owned by UA (User Assistance). This is why I sent it there [from UI] last year. Ownership has not changed since then. Sending back. :oAny comment from UA team?I took a look at the example code you pasted. It didn't look exactly like the screenshot - did you try using FormToolkit.adapt() as follows:FormToolkit toolkit = new FormToolkit(parent.getDisplay());parent.setBackgroundMode(SWT.INHERIT_DEFAULT);final String message = "This is my message";FormText text = new FormText(parent, SWT.WRAP | SWT.NO_FOCUS);toolkit.adapt(text);((FormText) text).setText(message, false, true);If that doesn't work can you paste in a larger chunk of your example - in particular the code that is setting the background.:oThe easiest repro of this problem is to put FormText in a tab group and then run it on any operating system that paints active tab background differently than the default window background. No custom painting required. For instance, Win XP paints a gradient, Win Vista and 7 paint solid.Toolkit adapt will not do anything for this problem. FormText makes explicit calls to set background color on GC all over the place.Tab Group as in Launch Configuration Tab Group? If someone can paste a self contained example it will be a lot easier to investigate the problem.Basic SWT tabs. Used in launch configuration and other places. Will attach a repro shortly.CreatedRepro (main java file)A dialog that shows formtext directly on top of dialog's composite and also nested inside SWT tab folder. Variants are shown with and without FormToolkit styling.CreatedRepro (full project zip)Runnable plugin project containing the repro dialog. Run source and look for ReproBug284393 menu at the top level.CreatedRepro (screen capture on Windows 7)CreatedRepro (screen capture on Windows XP)The size of the dialog doesn't make the gradient very evident, but it is there if you load it in a graphics tool. The screen capture does clearly show that the embedded FormText is not transparent, not matter how you configure it.Thanks, I will give that a try next week.(In reply to)FormToolkit.adapt(Control) only relieves the problem very slightly - it is masking the problem by painting the background with a diferent solid color.It is quite impossible for example for FormText to have any kind of gradient or custom-drawn background.(InI pointed out the primary causes for this issue)The lines above cause the FormText widget to always draw a sdolid background to the text.Setting a background image or putting the widget on the composite/canvas widget that has a non-solid background will be negated by the fact that the text is drawn on a offscreen image that has been filled with an explicit background color and then that image is painted on the FormText, effectively overriding any background the FormText might have...Thanks for the example I can clearly see the problem now (although I don't yet see a solution). Are you suggesting adding a style flag which could be passed into the constructor to make the FormText be transparent?Standard behavior for similar SWT controls (such as Label or Canvas) is to be transparent unless background color or image is explicitly set on the control in question. That would be the preferred option, but if not possible a new style flag or some other method for indicating that transparent behavior is desired would work too.(In reply to)I would not want to use SWT.TRANSPARENT or some such style flag to denote that a widget should be transparent.Konstantin is only partly correct in his, where he claims that Label and other such widgets are transparent by default unless an explicit background color has been set.Another part of the story is that it also depends on the parent composite's backgroundMode attribute value. From Composite.setBackgroundMode(int) javadoc: Sets the background drawing mode to the argument which should be one of the following constants defined in class SWT: INHERIT_NONE, INHERIT_DEFAULT, INHERIT_FORCE.And SWT JavaDoc has this to say about above constants: SWT.INHERIT_NONE: The <code>Composite</code> constant to indicate that an attribute (such as background) is not inherited by the children (value is 0). SWT.INHERIT_DEFAULT: The <code>Composite</code> constant to indicate that an attribute (such as background) is inherited by children who choose this value as their "default" (value is 1). For example, a label child will typically choose to inherit the background color of a composite while a list or table will not. SWT.INHERIT_FORCE: The <code>Composite</code> constant to indicate that an attribute (such as background) is inherited by all children.As to the solution, I can only offer some things I've thought that might help.As I currently do not have the few days to experiment with this, these will have to stay only suggestions for now.One possibility would be to use Canvas.drawBackground(GC, int, int, int, int) method to copy canvas's background to the text buffer. before painting the text on top of it, thus creating a plausible illusion of transparency. Since I've never used the method before, I have no idea if this will work though.Another solution would be to actually paint the text on 2 images - one would be the full color image with a text and graphics as usual, another would be on a grayscale image and then inserting the grayscale image data into the text buffer image as an alpha channel, thereby creating the transparency.Third and maybe the best solution to this would be to alter the implementation of Image and GC in such a way that we could create a transparent image so start with and when drawing on the transparent image with GC, also modify the transparency of the pixels.In some ways, the second option seems to me the most reliable of three and I expect that in most cases, it would fit perfectly with most expectations.The extra double drawing step has me somewhat worried, but considering the sizes of the text n my use of FormText widget, I am not too concerned about it...I'm not sure what to do next. For Eclipse 3.6 this is too late to be fixed, and even in 3.7 we don't have a committer assigned to work on forms, I have been fixing a few bugs myself but this looks like it might be complex and take more time than I have available. Do any of you feel like looking into creating a patch?I took a look at the code, but I am afraid I do not have sufficient expertise with custom controls and painting techniques to be of much use on this. Perhaps part of the issue with resources is with bucketing this in UA. I understand that this is part of forms api which has seen drastic reduction in attention as of recent, but perhaps this control should be treated separately as it is very useful independent of forms context and base SWT/JFace provides nothing comparable?CreatedPatch v1I am attaching a partial fix to this bug. The patch contains the fix that will draw itself transparently when the parent has a background image or background color is set. I believe the only issue that's not addressed is Konstantin's example in which the FormText is added to the tab which on Window's XP is light grey.CreatedTest case showing the fixTab1 shows the existing behavior that was not fixed. Tab2 shows the fix.CreatedImage before the patchCreatedImage after the patchCreatedPatch v2I removed the double buffer draw in the paint callback and added DOUBLE_BUFFER style bit, plus a few minor fixes to make work. I tested on Windows XP only.CreatedRepro v2 (full project zip)Repro project showing both problems that this patch is seeking to address:1. FormText on custom drawn gradient.2. FormText on TabFolder's TabItem.CreatedRepro v2 (main java file)CreatedAfter Patch (Windows 7)CreatedBefore Patch (Windows 7)Could we get consideration for this patch for 3.6.1 release. This problem has been a collective pain in our behinds for a while now. Ling just spent about a week learning SWT custom draw, understanding this problem and producing this patch. I have updated the repro to show the two problem cases that have been described in this bug. The before and after captures show that the problem has been corrected and that the case where background color is explicitly set has not been compromised. This can be seen by observing that the lines labeled "adapted with FormToolkit" retain their white background regardless of placement.Ling, please download my revised repro and attach before/after captures on WinXP. Make sure to save them as png, not bmp. I will do the same for Linux.Comment onPatch v2The 'iplog' flag shall be applied after said attachment has actually contributed to the resolution of a bug. There is no need to flag it pre-emptively as the attachment may require additional revisions.I'm going to commit this for Eclipse 3.7. I don't want to try to push this into 3.6.1 which is in the final stages, seefor the 3.6.1 endgame plan.If it's too late for 3.6.1, what about 3.6.2? This is a very important fix for the adopter community. We cannot wait until 3.7 to have this resolved.CreatedBefore Patch (Linux Ubuntu 10)CreatedAfter Patch (Linux Ubuntu 10)Patch v2 applied to HEAD, Fixed.Thanks, Chris. Could you comment on feasibility of releasing these changes into Helios SR2 stream? Should we open a separate bug to track that?Can you open a new bug for Helios? To release into the Helios stream we would need additional approvals.A new bug has been created:- [Forms] [Helios] Allow FormText to be transparentWe've discovered that there is an issue with Patch V2 on Windows 7. The issue happens with <a> link in the form text during mouse over. The hover changes the text color and the text gets thicker and out of focus (probably because of anti-aliasing on Windows7, since this patch works in both XP and Linux) The issue is line 67 in TextHyperlinkSegment.java:gc.drawText(s, clipX, clipY, false);I have been unable to find a way to repaint just the background before drawing the text. Please revert patch v2 change until this issue is resolved.I am re-opening this as it is important to revert the patch due to ill effect on Windows 7 systems. Doesn't seem to be a problem on WinXP and Linux, likely due to more primitive anti-aliasing algorithms (not using alpha channel blending). Haven't tried MacOS. There are two possible solutions that I see:1. Request SWT API to trigger background re-painting prior to re-drawing the text. Ling, please open an enhancement request for this and post back the bug number.2. Get rid of the on-hover color change behavior. It is on-hover re-painting that is causing anti-aliasing artifacts on Windows 7. On every re-paint, the text gets progressively thicker as transparent pixels at the edge of the text mix with previous text's anti-aliasing pixels. We are pursuing #2 in Sapphire by branching FormText as working transparent support in FormText is very important for our use cases. If there is general interest in getting rid of on-hover behavior globally as a trade-off for getting transparency, we can contribute that as a patch here.I have opened- [Forms] Revert Fix forto track the reversion of the patch, I should be able to get to this before the end of the year.(In reply to)*ping*Chris, did this make it's way into 3.7, any chance to get it into 3.7.1/3.8?HelmutThe fix did not make it into 3.7. Unfortunately UA forms is understaffed at the moment ( there is no full time committer ) and will likely continue to be that way, which is the main reason this did not make it into 3.7. This is a fairly complex section of code and it has been hard to create a patch that did not cause regressions.(In reply to)Thanks for the comment! :)Is there any way we could help, by testing a fix or something?HelmutI've got the same problem with Label - it is not transparent (and also not listen to SWT.TRANSPARENT).I also tried to find another solution, but due to the hided LayoutComposite class or the protected computeSize-methode in ColumnLayout it is not possible.Sven	53.0
id=355810	REOPENED	Platform	User Assistance	4.2	All All	P3 major	platform-ua-inbox	2011-08-25 05:36 EDT by	Eero Helenius	2016-05-13 05:19 EDT (	6 users	Build Identifier: 3.7The Eclipse Help system returns response code 200 even though a resource is NOT found.This is causes a problem with search engine spiders and link checking tools such as the W3C Link Checker (), which will never report a broken link because missing pages don't send it a 404.I'm not 100% sure this is caused solely by the Eclipse Help system or if it has to do with web server configuration, but I'm hoping you might be able to shed some light on the matter.Reproducible: AlwaysSteps to Reproduce:1. Open the Net tab in Firebug or the Network tab in Chrome developer tools.2. Open any topic that doesn't exist in the document set. For example:3. Check the HTTP response code.	CreatedA screenshot of the Network tab of Chrome developer tools.As you can see, the response code is 200 even though the topic clearly doesn't exist.There is a preference which can be used to cause the help system to return a 404 status instead of the error page: It is org.eclipse.help.base/page_not_found and if set to an empty string a 404 code will be returned for any broken links.See(In reply to)Thanks, that works!That tip might be worth mentioning explicitly on the page you linked, too.However, if you define a custom 404 page (something like this: org.eclipse.help.base/page_not_found=/customization/404.html), the Eclipse Help system won't return a 404 code but a 200 OK code.Would it be possible to make the Eclipse Help system return a 404 when a custom 404 page is defined?Thanks again for the tip!(In reply to)I recall there was some reason for not doing that. I would have to look at the history of the bug report which added the 404 status to see if I can find out more information.I saw this comment one one commit to EclipseConnector.java:Stopped setting 404 status when an error page is presented because some custom pages would not display unless the status was OK.As I recall for a while 404 was returned for all broken links, even if the error page was defined but it caused unwanted side effects and was backed out. I'm resolving this bug as as WONTFIX because I don't want to reinrtoduce any side effects.(In reply to)Hi Chris,That's understandable.Thanks for the earlier tip, nonetheless, it's quite sufficient for our purposes for now.Reopening, sincea) not returning a 404 is just wrongb) the wrong default and the org.eclipse.help.base/page_not_found="" hack are not described in the ua_help_setup_preferences.htm docc) no reason was given for why the broken behavior would help anyone.Looks like this was once fixed withbut thenreintroduced the bug without any explanationI think we should just revert that commit (and its child commit).Here's the concrete workaround (tested in 4.5):* Create file "<path-to-your>/pluginCustomization.ini" with contents:# hack around: [Webapp] Eclipse Help System does not send the HTTP 404 response code when a topic is missingorg.eclipse.help.base/page_not_found=""* Add this your command line / eclipse.ini: -pluginCustomization <path-to-your>/pluginCustomization.iniMoving to 4.7. Please move back to 4.6 RC2 if you think that is important enough and if you plan to provide a Gerrit review..	9.0
id=152999	REOPENED	Platform	UI	3.2	PC Windows 2000	P3 normal	Platform-UI-Inbox	2006-08-07 13:50 EDT by	Matthew Dickie	2017-02-20 04:30 EST (	3 users	The new Project Explorer view does not honour new wizard shortcuts added in the Perspective Factory. This is inconvenient and is inconsistent with Resource Navigator and Package Explorer.We need to use Project Explorer as Resource Navigator does not show error decorations, and Package Explorer is too Java specific.This may be intentional, but I suspect it is a bug.	Hi Matthew,The Common Navigator Framework defines an extension known as "Common Wizards". Instead of assuming the perspective wizards, it instead uses the current selection to decide which wizard shortcuts to use. You can define these through the org.eclipse.ui.navigator.navigatorContent/commonWizard extension point.This behavior is confusing for plug-in developers. Instead of one common extension point they now have to deal with multiple. It's also not documented within the existing perspective extensions extension point that the Project Navigator needs a separate extension. It also does not follow the Eclipse UX best practice of consistency. We have multiple places in the UI all showing the same in File -> New - except the common navigator.	2.0
id=199476	REOPENED	Platform	UI	3.3	PC All	P3 enhancement	Platform-UI-Inbox	2007-08-09 16:11 EDT by	Thomas Kratz	2013-06-05 10:38 EDT (	5 users	HI everyone. I tried to persist a WritableSet with hibernate today and found its not serializable. Wouldn't it be Handy if these classes were all serializable ?Regards Thomas	Would you be interested in submitting a patch, ideally together with a test case that confirms serializability?I'll have a look at it today.Hello Boris, I'm not really happy now I had a look at it. I started off with making IObservableCollection Serializable, added all the required UIDs etc. then I had a look at what to serialize an what could be transient and reconstructed after deserialization. I wrote a simple Test for an JavaBeansObservableList to get started. The problem here is that JBOList holds a PropertyDescriptor which is needed and is not serializable. I can make the Realm and the ChangeSupport transient, but I have no idea what to do with the descriptor. Any ideas ?This brings us back to the start - I can see how a WritableList/Set could be made serializable. But why would you make a JavaBeansObservableList/Set serializable?I don't know much about Hibernate, but isn't it used to put things into a relational database? Why would you serialize objects rather than mapping them to the appropriate columns and rows in your database?Its not that big a problem as I can workaround with a single line of code. Just thought it would be nice. All my domain objects are JavaBeans. So I use them through all layers of the application. I have a server process with hibernate that exposes RMI services to the client. Was a little tricky to make hibernate work with the JavaBeans but now it works. So what I do is Edit a JavaBean with An eclipse client and happily with databinding. I send it over the line via good old RMI and the Server process persists it in the database. The client doenst fiddle with hibernate. So it just came to the point where I had indeed a WritableList in my domain object which couldnt be sent over the line. Maybe I wanted too much when I started with making IObservableCollection my starting point ? :) I just found out that I have different troubles when I serialize them as the server has to know the classes then too (which it doesnt right now). Its just for the sake that I can use the same domain objects in the server that I use in the client, as converting business domain objects is a really stupid task. I liked this with JSF and Seam.Ok I now made WriteableList/Set only serializable. I had to introduce a default constructor in the non serializable superclasses.Please have a look at it its no big deal.CreatedWriteableListCreatedObervableListCreatedWritableSetCreatedObervableSetCreatedSerializableTestThomas, could you please post a combined attachment with all changes, in patch format? To do this, check out the required projects from CVS, make the changes, and then select all changed projects, right-click, "Team > Create Patch...", and use the default options when creating the patch.CreatedCombined PatchHope this works :)ok for meChanging to WONTFIX since we didn't do anything.Can you share with us why you don't need this anymore?Hello,I just found this bug, since I have the same problem with serializing of a WritableList. I have to transfer objects containing WritableLists over DnD and over a network. As I understand Thomas patch worked for him so why wasn't this integrated?Regards VeselinI guess it would benefit a lot of people if databinding API became serializable.In my case I'm using databinding with RAP project which works great. However you soon end up having observables that you need to serialize to be able to put them safely in your session attributes. Also I'm not sure to understand from the bug history why it was changed to WONTFIX. Could someone clarify what was the rational behind the wontfix status?I don't see any reason why this patch shouldn't be applied. I think Boris did not apply the patch because of some confusion over the meaning of.It does seem odd to be serializing an observable because you can't really listen for changes in the collection that arrive remotely if you are replacing the observable. However I can see situations where it would be beneficial to allow serialization. Databinding work is now being done in the e4 repository so I'll get it checked in there once I have finished other pending commits.	19.0
id=209780	REOPENED	Platform	IDE	3.3.1	PC Windows XP	P3 normal	Platform-UI-Inbox	2007-11-14 07:21 EST by	Tobias Schwarz	2012-11-15 09:32 EST (	5 users	Build ID: 3.3.1.1Steps To Reproduce:first prblem:1.create general project "test" in workspace2.select project and click File->Move...3. -> ok button is greyed out4.deselect "use default location"5.select "use default location"6. -> ok button is enabled ???!!!second problem:7.deselect "use default location" again8.choose location outside workspace (e.g. "c:\temp\")9.hit ok10. -> error dialog comes up reporting a problem "ressource already exists on disk c:\temp."but there is no project on c:\temp called test!	the main problem is the not working move operation - the enablement of the ok button is a secondary problem.so i change the summary to the main problem.This is an IDE/Dialog issue.The first problem isn't a problem - you are trying to move it back to it's current location.If you do the same steps with a project that is not at the default location it will work for you.The second part is from our call to project.move(description, IResource.FORCE | IResource.SHALLOW, monitor).Moving to resources and renaming.I can reproduce it.(In reply to)CQ:WIND00084563Hi Szymon :)Any news on this one?Thanks a lot! :)HelmutI can reproduce this, but it is expected behaviour. You can't move a project to a location that already exists.I think there is a user misunderstanding here. If you select the location C:\temp for a project called test, the project location will be C:\temp, not C:\temp\test. I.e., the directory you enter here *IS* the location of the project. The directory name and project name do not have to match.(In reply to)Hi John :)I'm not sure I understand the reasoning here:Q: Why is moving into an existing directory not allowed, all the difference is one "mkdir" in between, right?Q: If moving into an existing directory is not allowed, why isn't the dialog just plainly refusing the existing directory with a reasonable message, like "You cannot move the project "test" into the existing directory <whatever dir> because it already exists and <explain why>"Let me know what you think! :)Helmut(In reply to)If the existing directory is empty, then the move will succeed. If the existing directory contains other files, then the move would involve merging the existing files at the destination into the project. This is more than a mkdir and potentially involves a complex merge. Also, it would strike me as strange as an end-user that "moving" a project could result in it acquiring new contents as part of the process.Yes I agree the UI could check this first.One might think we could add this test to IWorkspace#validateProjectLocation. However this method is used for both project creation and project move, so it can't add this extra check. This is why the javadoc says, "This method does not consider whether files or directories exist in the file system at the specified path." I think the easiest option is to add a check in the UI to the effect of if (fileStore#childNames(EFS.NONE,null).length > 0) error("The destination directory is not empty");(In reply to)Thanks John, this sounds like a good resolution to me: the UI will refuse an operation we know would fail. The error message could go into more details, or the associated help entry could, so that customers know we do not want to get into the merging business and thus refuse this kind of operation..HelmutPing, this looks like a great bug for a bugday or hackathon ... adding a "bugday" keyword for now, do we have any other kind of markup ?	11.0
id=353139	REOPENED	Platform	User Assistance	3.7	PC Windows 7	P3 normal	platform-ua-inbox	2011-07-26 13:03 EDT by	Chris Goldthorpe	2013-01-21 11:49 EST (	6 users	3.7The Samples page of Intro contains a small number of samples which are not well maintained, are unsigned and rely on the PDE Samples framework. If we could replace the samples mechanism with a page which used P2 it would be easier to keep the samples up to date.	*** This bug has been marked as a duplicate of***.Note that the PDE samples framework does use p2 to install. However, the process is still convoluted and has much room for improvement. I updated the title to reflect this.	3.0
id=232171	REOPENED	Platform	UI	4.4	PC Windows XP	P3 normal	Platform-UI-Inbox	2008-05-14 15:40 EDT by	Edwin Chan	2016-04-20 12:08 EDT (	4 users	CreatedA plugin setup to demonstrate the issueBuild ID: M20071023-1652This seems to work for other extension points, such as actions and wizards, so it's strange that this doesn'twork here.Steps To Reproduce:1. Declare a decorator in your plugin.xml (no Java impl)2. Make sure that it uses an icon from another plugin (e.g. icon="platform:/plugin/org.eclipse.ui/icons/full/ovr16/lock_ovr.gif")3. Run your plugin in a run-time workbench on a workspace with projects in it4. See that the decorator does not show up in the Project explorer(You can change the icon to point to something in the plugin to see that it otherwise works.More information: It tries to compute a URL for the icon, but gets a null in decorate(Object,IDecoration) in org.eclipse.ui.internal.decorators.DeclarativeDecorator (line 72 under Eclipse 3.3.1.1)	Oleg is now responsible for watching the [Decorators] category.Createdfix to use accept platform URIsShould take care of the problem(In reply to)Thanks for the patch, but it's extremely noisy. Could you please attach a patch with only the changes you need to make in it?PW(In reply to Christian Pontesegger from)I've fixed up the patch, but now I can't even push it to Gerrit:remote: Reviewing commit: commit ddb0da3b5f39e772b449d4c66f0fb8d30b652f9c 1380048566 ----spremote: Authored by: Christian Pontesegger <>remote: remote: error: The author does not have a Gerrit account.remote: All authors must either be a commiter on the project, or have a current CLA on file.remote: Please seeremote: To ssh://:29418/platform/eclipse.platform.ui ! [remote rejected] HEAD -> refs/for/master (The author must register with Gerrit.)error: failed to push some refs to 'ssh://:29418/platform/eclipse.platform.ui'I can get around this for now, but you should probably register the same email you used for your CLA with Gerrit.PWReleased asChristian, can you please check this for correctness?PWIn 4.4.0.I20131028-2000PWThis fix breaks declarative icons using "$nl$", e.g.icon="$nl$/icons/ovr16/binary_co.gif"Seefor details.I've reverted to fix with(In reply to Dani Megert from)OK, we'll look at it again. I thought the URL syntax handler org.eclipse.core.internal.boot.PlatformURLHandler supports de-referencing the $nl$ directive, but it looks like that support was added in org.eclipse.core.runtime.FileLocator.find(Bundle, IPath, Map)PWMass move to 4.7 as M7 is approaching. Please move back in case you are planning to fix it for Neon.	9.0
id=296927	REOPENED	Platform	UI	3.6	PC Mac OS X - Carbon (unsup.)	P3 normal	Platform-UI-Inbox	2009-12-04 11:05 EST by	Markus Keller	2011-12-05 06:09 EST (	3 users	The platform should consume and test the sequenceModifier for the org.eclipse.ui.bindings extension point. After this is done and verified, please inform the other projects that they should do the same.	CreatedPatch v01Patch v01 released to HEADReopening, I have a few issues with that patch:- uses undocumented features of the <sequenceModifier> element: The doc says "This key sequence should consist of one or more modifier keys without the actual key" but you use complete key bindings. The sequenceModifier feature was mainly meant to replace M2+M3 with M1+M3 on the Mac. If it does more, then this should be documented (with proper "since ..." statements that tell since when it does more). - uses "cocoa" as platform. This is redundant and we should not confuse others by starting to use this now (cf.and following). It's again too late to remove the hack from.- only patches o.e.ui, but not o.e.ui.ide- an explicit comment that you tested this on all 3 major platforms would be reassuring.Patch v01 reverted in HEAD***has been marked as a duplicate of this bug. ***Please make sure you test this on Windows and GTK as well before releasing the next version. Patch v01, e.g. broke the key binding for Open System Menu (Alt+-) on Windows.BTW: On Cocoa, Patch v01 removed the keybinding for File > Properties in the Java editor (M3+CR, see).Not for this release. Will revisit later.	8.0
id=319355	REOPENED	Platform	UI	4.2	PC Windows 7	P3 normal	Platform-UI-Inbox	2010-07-09 05:39 EDT by	Stefan Mücke	2012-04-11 07:00 EDT (	3 users	CreatedScreenshotSee screenshot for details.	Susan, can you have a look at this? Is this really intended?I still have this look with the latest build (I20100716).The gradients are intentional. They differ slightly per theme. Are you saying you don't like having a gradient? Or you want the gradient to be smoother? We are using the images in org.eclipse.platform/images (win7.png, winXPBlue.png, etc.).CreatedScreenshot 2 (tweaked)Susan, please have a look at the two screenshots. In the second one, I have tweaked the image winXPBlue.PNG to show you the difference. I think the lower part of the gradient should have continued with the same color as the end of the gradient.Please also see. I have just discovered that the dot rendered at a regular distance comes from the image.I am wondering why images are used for the toolbar background, while the tab headers are rendered using the gradient values specified in the CSS file.The gradient getting dark and then changing and getting lighter again is intentional. This was spec'ed by our graphic designer (for example, there is a design mockup at).(In reply to)This is really just a product of the history/evolution of the design. The toolbar gradients have been tweaked over the course of the design and it was simplest to grab the gradient from the designer mockups. The tab headers were originally solid colors or simple gradients. It was near the end of the design process that they evolved to look more like the toolbar.I'm going to mark this bug as a blocker for the overall "new look" bug. This is how we are tracking feedback about the design.We are going to close this bug as "WONTFIX" for now, since the design "bump" in the gradient is intentional. If we see a lot of similar feedback in the future, we could reopen. (And of course, we are going to encourage people to try alternate stylesheets as well.)CreatedScreenshot: different heights of toolbar gradientsSusan, I would like to point you to another aspect I feel looks broken. The gradients in the main and local toolbars have a different height. Neither the absolute height in pixels nor the percentage height agree. Reopen?(In reply to)sure, can you retitle the bug to capture the specific issue?Updated the title and reopened.	8.0
id=272884	REOPENED	Platform	UI	3.5	PC Windows XP	P3 normal	Platform-UI-Inbox	2009-04-20 08:55 EDT by	Markus Keller	2016-04-20 12:11 EDT (	4 users	N20090419-2000Follow-up to(regression compared to 3.4).IWorkbenchPage#openEditors(IEditorInput[], ..) should add the non-materialized editors at the front of the editors MRU list.Currently, when I select and open multiple elements in the Open Type dialog, the first editor is created and comes to front (good), but the others are added at the end of the MRU list. This causes several problems:- 'Close' on the topmost editor does not reveal the next of the opened types. Instead, I am thrown back to the previously active editor.- If there's not enough space to show all editor tabs, then the other freshly opened editors are not visible (they are hidden in the tab extension menu).- Ctrl+F6 does not easily let me switch to the other editors.	Oleg, could you please look into this?CreatedPatchGood catch. The attached patch fixes inconsistencies you found - except for the:"- If there's not enough space to show all editor tabs, then the other freshlyopened editors are not visible (they are hidden in the tab extension menu)."I am not sure how to implement that one in a reasonable way.CreatedUpdated patchThe first patch included some extra changes, please use this one.Boris, can you look at this for M7? This is new in 3.5 and should be fixed for the release.Released to HEAD. Thanks for the reminder, Dani! It's a crazy day...Almost fixed.>Markus point was that the newly opened editor tabs should be shown in favor of existing ones.Take a look at the example screen shots.CreatedInitial stateCreatedExpected / 3.4 sate after opening 3 editorsCreatedUnexpected state after opening 3 editors(In reply to)See the.I read that but since it worked in 3.4 I would assume there is already an algorithm that does this and which can be used here too.(In reply to)Opeining multiple editors is a new functionality added in 3.5. I don't know why Markus used word "regression". Maybe he was comparing it to opening multiple editors from IMemento's on startup? That works from a "clean slate" and does not have to deal with tab space being occupied already.(I addedto see if we can add more control over the tab visility in 3.6.)Markus, is that correct? Or is there some "opening multiple editors without materialization" path that worked in 3.4 and does not work in 3.5?Well, it is a regression for the user who does not really care about internals.(In reply to)Everybody who used 3.4 APIs behaves the same as in 3.4. If you use the new API to open multiple editors in a "quick" way then you get the new behaviour with tabs. But you do have to use the new API for that. Did you change JDT code to use "open multiple editors without materalization"?Yes, not only Open Type but also Open Resource uses the new API and we started to use the new API, expecting to get the same behavior for the user but with the performance gain of not creating all the editors.(In reply to)We did not foresee this but unfortunately cannot implement the same behavior. I suggest that you revert your use of the new API (which should work without problems for the Mylyn use case). We can fixin 3.6 after which you can start using the new API without introducing regressions.The reason for the regression is that CTabFolder manages the MRU list, and there is no way for us to tweak it using API to get the new tabs to show up.There's another issue with the fix: while the MRU list is now better, it inverts the order of files i.e. before this bug was fixed it was f1, f2 and now they appear as f2, f1:3.4.x/correct: f1 [f2]before this fix: [f1] f2with this fix: f2 [f1]CreatedFixThis fixes all the issues initially raised.Plus the issue mentioned in.Sorry, my patch is useless as it activates all editors.Let me know this week whether you plan to work on this for 3.5. If not, I'll back out the changes next week.I believe we should try to fix the problem described in. Oleg, could you look into this?As for the editors not showing up as tabs because of the built-in MRU logic in CTabFolder, I don't think this is something we can fix for 3.5.CreatedBetter FixThis fix makes the order right again and also fixes the tab item issue. If we think it is too dangerous to change PresentablePartFolder.insert(IPresentablePart, int) at this point, we might be able to select the tab item at a higher level place.CreatedBetter Fix (same as before but fixed broken comment)(In reply to)I don't think this is correct. Using 3.4 as a reference is strange for the functionality added in 3.5.What happens now: say, we have multi-selected 3 files:text1text2text3and used #openEditors() method to open all 3 of them at once.The File MRU list will be: text1, text2, text3.The active tab will be "text1".The tab order will be: text1 (active) -> closed: -> text2 -> closed: -> text3.What you are asking about is the opposite: text3 to be active, and MRU lists be text3, text2, text1.To me, the current behavior is more intuitive. Plus, the Javadoc on IWorkbenchPage#openEditors() sais:"Only the editor constructed for the first input gets activated." With the proposed patch it is the last editor passed in that gets activated. (Which, by the way, breaks JUnits in IWorkbenchPageTest.)============For the tab visibility part of the patch (PresentablePartFolder), that looks interestings. I don't know that code so can't comment on side effects, but it seems to work well for the rudimentary testing I've done.Oh well. The one and only purpose was to get a performance effective way to replace the existing code that materialized the editors and not to discuss whether the many year old behavior is good or not. I can't see any bug report/comment that asked to change that behavior and hence cannot understand why the new API decided to change this.Boris, what's the reason to change this in the new API?Please decide asap how you intend to proceed as otherwise we have to go back to the old API that materializes the editors.It's the right direction but we need to call setSelection at some other place: I ran with the patch for quite some time now and see side-effects, e.g. when restoring view stacks. This is probably also what the failing test detected.(In reply to)No particular reason, other than that the new API Javadoc makes sense as is. I don't think it is more intuitive to say that "only the editor for the last element in the array is materialized".I think it's up to you to decide in which order you want the editors to appear, but this is something you can do easily on your end (just reverse the array if needed).(In reply to)The change in PresentablePartFolder is interesting but seems to risky at this point. We can release something like this early in 3.6 and if it works well backport it to 3.5.1. What do you think?OK.As stated in my previous comment we'd first have to find a better place. My current "fix" breaks things. So yes, we probably have to move this to 3.5.x or 3.6.For 3.5 I'll remove the usage of the new API in the Open * dialogs because it's very annoying that closing newly opened editors doesn't activate them in the right order.Moving to 3.6. Sorry that the new API is not useful for you (I hope it is useful for Mylyn at least though). We can try to get this into 3.5.1, by addressing the MRU issue early in 3.6.Btw, it would be useful to document what kind of side-effects you saw while running with the patch, and how to reproduce them. I am hoping that the change to PresentablePartFolder is close to the solution.Sure. When starting a fresh workspace it has the 'Hierarchy' view tab in front with the not yet created view instead of the 'Package Explorer'.Boris, I suggest that for consistency we also revert the change to 'Open Resource'. I can make a patch for you to review if you agree.(In reply to)Good point. Thanks for the offer!CreatedPatch v2I think if we use CTabFolder#showItem() instead of CTabFolder#setSelection() we'll reduce extra processing.The attached Patch v2 produces the desired behavior for editor tabs and so far I haven't seen side effects.The bulk of changes in the patch are propagating CTabFolder#showItem() to the level at which we can use it.(As Boris mentioned, the ordering of editors - "first in - first out" vs. "first in - last out" can be changed by filling argument arrays in reverse order. To me, the API makes sense as it is, so this patch is concentrated on the producing correct tabs for editors.)Boris, could you have a look at the patch?Kevin, as the master of the CTabFolder, could you review the Patch v2?The patch does not completely fix the problem: while the editors are now in the correct order, the editor list that appears when clicking the chevron still has wrong/scrambled order.My problem is that currently neither LTR nor RTL is specified anywhere in the API. The only thing that I see currently specified is that the first one from the given array is activated. Or did I miss something?(In reply to)Hmm... that's not what I see. With Patch v2, when I use the same order (i.e., rememeber to reverse array for multi-open) the drop-down lists from the chevron look the same. (To me, the ordering in the drop-down makes no sense, but that is a dfferent subject that has been widely debated before. See,"MRU ordering is considered a feature, not a bug" :-),, and I am sure many others.)CreatedEditors opened on-by-one; order is in red letters to the rightCreatedEditors opened using the new APIpingDani, could you check the editor drop-down order () ? From what I gothered, the chevron's drop-down has two lists: visible tabs (in normal font) and invisible tabs (in the bold font). Both lists are sorted alphabetically and do not follow MRU order. Boris, could you review "Patch v2"?Right, very unnatural and unexpected and hence I forgot to do that ;-). I retrieved OpenResourceHandler rev. 1.6 from the repository which does not yet "fix" the order. With that changed, the patch works.Ping PingBoris, could you review "Patch v2"?Patch looks good.CreatedPatch v2 updatedUpdating patch as the old one is out of synch.Thank you! "Patch v2 updated" is applied to CVS head. This should fix the MRU problem when files are passed in the order described in the new APIs.I can still not use that API as it does not transfer the keyboard focus to the editor which is in front :-(I filedto track this.Verified in I20091207-1800.I reopen the bug, because the problems described instill occur in Eclipse 4.4 when trying to fix(by applying a patch attached to that bug).Mass move to 4.7 as M7 is approaching. Please move back in case you are planning to fix it for Neon.	49.0
id=346009	REOPENED	Platform	UI	4.2	All All	P3 normal	Platform-UI-Inbox	2011-05-16 17:45 EDT by	Brian de Alwis	2016-04-20 12:15 EDT (	6 users	introduced support for dragging editors between windows. This functionality no longer seems to work. On the bright side, you can drag an editor as a detached window, which is pretty good too.	Saw this on Eclipse 4.2 M1 on Windows 7 as well. Adjusting the bug accordingly.Yep, I need to adjust the DnDAddon to accommodate this behavior...Hi, everyone. I tried out Eclipse 4.3 M6 for Linux and still managed to observe the behaviour. Heard that this bug was going to be address in version 4.3, so I had to try it out purely out of excitement.It'd be great though if this functionality was restored back into the softwareI just took a look into this and while it's fairly simple to implement the DnD behavior (just make the check in DnDInfo's 'getModelElement' check that it's the same *app* rather than the same top level window) there are are few subtle details to be worked out.1) In order to avoid confusion we should be limiting this to 'editors' only. Otherwise you can make strange perspectives that, for example, have two Outline views...this is likely doable without too much difficulty.2) We'd need to trap and adjust the EditorRef for the editor that's been moved since moving it from one window to another means that it has effectively changed form one WorkbenchPage to a different one. This is a bit more problematic, we're already looking into this code however since we have other defects relating specifically to EditorReference management, perhaps we can blend the logic required for this defect into the fix for that one...I see thanks for taking a look at it. Hope the feature returns soon. At any rate, I'll just go back to 3.8.2 for the meantime as I frequently drag around open editors in one window to anotherI've pushed the following to Gerrit:This is a change set against R4_3_maintenance...Committed:This is a good first cut but there are two remaining corner cases:1) Our current drag strategy is to drag the whole stack if the element being dragged is the only visible element and it's *not* the last editor stack. This means that dragging the only editor from a stack in the *split* editor doesn't work. Should be easy to fix by never dragging the while stack if the initial element is an MPart rather than a MPlaceholder.2) Dragging the editor to the new window doesn't fix up the EditorRef's of the two WorkbenchPages. We expect this to be managed by a new approach to handling both view / editor refs by listening to model additions / removals.Committed:Which fixes corner case 1) from aboveBTW, we likely won't be able to back port this whole fix but at least the change in the DnDManager should go back to 4.3.2 since it's likely broken in multi-window cases...M4 is done...Committed:This fixes scenario 2) by adding a listener in the workbench page that detects new parts being added and ensuring that any ones with EditorReferences get their page updated...Marking FIXED...Verified in 4.4.0.I20140303-2000.This feature got pulled out due to too many issues. Seeand duplicates.(In reply to Dani Megert from)Reverting the following commit will enable it again:Mass move to 4.7 as M7 is approaching. Please move back in case you are planning to fix it for Neon.	16.0
id=356540	REOPENED	Platform	UI	3.6	PC Linux	P3 normal	Platform-UI-Inbox	2011-09-01 23:28 EDT by	Francis Upton IV	2016-08-13 09:44 EDT (	3 users	I don't think I can reproduce this; the problem went away when I closed the debug perspective, but until then it happened every time I showed one of the views associated with my application.eclipse.buildId=I20100608-0911java.version=1.6.0_22java.vendor=Sun Microsystems Inc.BootLoader constants: OS=linux, ARCH=x86_64, WS=gtk, NL=en_USCommand-line arguments: -os linux -ws gtk -arch x86_64ErrorThu Sep 01 20:11:50 PDT 2011Problems occurred when invoking code from plug-in: "org.eclipse.ui.workbench".java.lang.NullPointerExceptionat org.eclipse.debug.internal.ui.views.variables.VariablesView.partDeactivated(VariablesView.java:612)at org.eclipse.ui.part.PageBookView$4.partDeactivated(PageBookView.java:1022)at org.eclipse.ui.internal.PartListenerList2$4.run(PartListenerList2.java:115)at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)at org.eclipse.core.runtime.Platform.run(Platform.java:888)at org.eclipse.ui.internal.PartListenerList2.fireEvent(PartListenerList2.java:55)at org.eclipse.ui.internal.PartListenerList2.firePartDeactivated(PartListenerList2.java:113)at org.eclipse.ui.internal.PartService.firePartDeactivated(PartService.java:242)at org.eclipse.ui.internal.PartService.setActivePart(PartService.java:300)at org.eclipse.ui.internal.WorkbenchPagePartList.fireActivePartChanged(WorkbenchPagePartList.java:57)at org.eclipse.ui.internal.PartList.setActivePart(PartList.java:136)at org.eclipse.ui.internal.WorkbenchPage.setActivePart(WorkbenchPage.java:3537)at org.eclipse.ui.internal.WorkbenchPage.internalActivate(WorkbenchPage.java:617)at org.eclipse.ui.internal.WorkbenchPage.activate(WorkbenchPage.java:589)at com.oaklandsw.transform.editor.c.a(c.java:1555)at com.oaklandsw.transform.editor.c$3.run(c$3.java:1642)at org.eclipse.swt.widgets.Synchronizer.syncExec(Synchronizer.java:179)at org.eclipse.ui.internal.UISynchronizer.syncExec(UISynchronizer.java:150)at org.eclipse.swt.widgets.Display.syncExec(Display.java:4294)at com.oaklandsw.gui.k.b(k.java:1917)at com.oaklandsw.transform.editor.c.setCurrentMainNode(c.java:1640)at com.oaklandsw.transform.editor.c$6.run(c$6.java:2126)at org.eclipse.swt.widgets.Synchronizer.syncExec(Synchronizer.java:179)at org.eclipse.ui.internal.UISynchronizer.syncExec(UISynchronizer.java:150)at org.eclipse.swt.widgets.Display.syncExec(Display.java:4294)at com.oaklandsw.gui.k.b(k.java:1917)at com.oaklandsw.transform.editor.c.showNode(c.java:2165)at com.oaklandsw.transform.editor.results.a$1$0.run(a$1$0.java:340)at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:134)at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3527)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3174)at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2629)at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2593)at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2427)at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:670)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:663)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:115)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:369)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)at java.lang.reflect.Method.invoke(Method.java:616)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:619)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:574)at org.eclipse.equinox.launcher.Main.run(Main.java:1407)at org.eclipse.equinox.launcher.Main.main(Main.java:1383)	I don't think this is Debug's problem; I can now make it happen at will and you are the victim of a part ref with a null part.This seems to be a dup of*** This bug has been marked as a duplicate of***For the record, I found out what's causing this problem. In one of my partActivated listeners I'm hiding a view, which causes trouble further down the invocation chain. When I moved the hiding of the view to an asyncExec, the problem went away.Platform UI might want to have a look at this; I'm not sure what the rules are for hiding a view withing a partActivation event.(In reply to)Can you provide a test plug-in / example?	3.0
id=360983	REOPENED	Platform	User Assistance	3.7.1	PC Windows XP	P3 major	Platform-UI-Inbox	2011-10-14 11:05 EDT by	Riccardo Mising name	2012-06-07 07:48 EDT (	2 users	Build Identifier: M20110909-1335The interface IUAElement defines a method isEnabled(IEvaluationContext context) which can be used to filter out elements. An example is, that a topic is only included in the TOC if plugin x.y.z is running.<topic href="html/subtopic.html" label="This topic is shown only if plugin x.y.z is running"> <enablement> <with variable="platform"> <test property="org.eclipse.core.runtime.isBundleInstalled" args="x.y.z"/> </with> </enablement></topic>This defenition works as expected.However, if a toc provider is used, own implementation of the various interfaces (eg. IToc and ITopic) can be returned, which can determine the enabled state to their own logic. The problem is, that the isEnabled method of the implementation is never called by the bundles of the eclipse help.The reason seems to be the fact, that the help plugins create a wrapper for tocs (and all children via appendChildren(src.getChildren())) created by the toc provider whereat the method appendChild(UAElement uaElementToAppend) does not store the element as a child since the varibale children of the class UAElement is still null at this moment.At a later point the method getChildren() of the class UAElement is called by the help bundles and new UAElement of the corresponding type (eg. ITopic) are created without a connection to the original source element.Reproducible: AlwaysSteps to Reproduce:1. Implement a toc provider like the following and register it via the extension point "org.eclipse.help.toc". Note that the topic should be filtered out, since the isEnabled method returns false.public class SimpleTocProvider extends AbstractTocProvider { public ITocContribution[] getTocContributions( final String locale ) { ITocContribution contribution = new ITocContribution() { public String getContributorId() { return "TocProvider Example"; } public String getId() { return "SimpleTocProvider"; } public String getCategoryId() { return null; } public boolean isPrimary() { return true; } public IToc getToc() { return new SimpleToc(); } public String getLocale() { return locale; } public String[] getExtraDocuments() { return new String[ 0 ]; } public String getLinkTo() { return null; } }; return new ITocContribution[] { contribution }; }}public class SimpleToc implements IToc { private ITopic topic; public SimpleToc() { this.topic = new SimpleTopic(); } public boolean isEnabled(IEvaluationContext context) { return true; } public IUAElement[] getChildren() { return getTopics(); } public String getHref() { return null; } public String getLabel() { return "SimpleToc" } public ITopic[] getTopics() { return new ITopic[] { this.topic }; } public ITopic getTopic(String href) { if( href.equals( this.topic.getHref() ) ) return this.topic; return null; }}public class SimpleTopic implements ITopic { public boolean isEnabled(IEvaluationContext context) { System.out.println( "isEnabled is never called" ); return false; } public IUAElement[] getChildren() { return getSubtopics(); } public ITopic[] getSubtopics() { return new ITopic[0]; } public String getLabel() { return "SimpleTopic" } public String getHref() { return "simple.xhtml"; }}2. Open the help of eclipse.	I took a look at your example and was able to reproduce the problem. The children of the Toc were not getting copied correctly when a Toc object was created from a SimpleToc.I think I know how to fix the problem, targeting 3.8M3.Fixed in master with commit message- [Help] isEnabled is not called for children of ITocs which are created by a toc provider.This also enabled a previously disabled JUnit test to pass, testUserTopicWithFilteredChildren. The failing test should have alerted me to the problem earlier but I had thought that it was another instance ofwhich caused two other test cases in the same class to fail.Hallo Chris,your patch only works for primary tocs. If I contribute a toc which is linked to another toc only the first level entriesof my provited toc have the reference to the original source.The problem seems to be in the method importElement(UAElement) where the children of the element to import are set to NULL.	3.0
id=330117	REOPENED	Platform	UI	4.1	All All	P3 normal	Platform-UI-Inbox	2010-11-12 11:55 EST by	Michael Valenta	2015-05-22 12:54 EDT (	12 users	We have several views in our product that use view descriptions. I have two issues with the way these are displayed Eclipse 4.1.1) In Eclipse 3.x, they description and toolbar would appear on the same line if there was space. this is not the case in Eclipse 4.1.2) There is no separators between the toolbar, the description and the view content.I have attached a screenshot that illustrates the second point.	No, you haven't.Oops, sorry. I guess I didn't attach the image. Unfortunately, I changed laptops since I logged the issue but it should be pretty obvious if you look at a view with a description in 3.7 and 4.1 that the 4.1 presentation is different in a way that I would claim is not as good as how it was done in 3.7.***has been marked as a duplicate of this bug. ***(In reply to)Seefor images.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***I've pushed a change to get the separator back.(In reply to)This goes into the right direction. The separator after the toolbar is still missing though. See attached screenshot for the Java Outline view.CreatedPicture of confusing Outline due to missing separatorCreatedSeparator still missing sometimesThe separator is now only missing if the view has a toolbar, has no description, and the toolbar is shown below the tab folder.CreatedConsistency would be good, but...Please see the this screenshot. While views behaving consistently is a worthy goal, I have reservations about the direction suggested to be taken here. I don't want to see more useless lines added to the UI. If some must be added then there needs to be a way to turn them off in CSS.I've prepared the initial patch for it -Currently the user is able to modify the 'e4 default' theme with the preference dialog so maybe we should skip this bug in order to avoid the regression in the 'e4 default' layout.Daniel(In reply to Daniel Rolka from)I'm not sure I understand this. Is it just the user can modify it, and that would cause a regression for them? If they do it themselves, I'm not that worried about it.PW(In reply to Paul Webster from)I was thinking about the regression in the layout connected to the new patch - to see the separation I had to replace the 'white' color of the selected MPart with the 'blue' or 'olive' color. I think the users got used to lack of separation so I'm not sure if we should fix itDaniel(In reply to Daniel Rolka from)Maybe regression is not proper word here, let's call it the change in the layoutDaniel(In reply to Daniel Rolka from)I was fine with fixing this, so that there is at least some border between the 3 areas. Just because we're used to it doesn't mean it's not clear :-)PWFixed withWe can still tweak this during the RCs.(In reply to Dani Megert from)Gack, I think that that's horrible (I'm sure others might like it :-). But mostly because it doesn't match the color palette I see with gtk. What if we made the gradient start with a lighter blue and end with a lighter blue, even if only on GTK?Also, because the disabled active tab is darker at the top and lighter at the bottom, would it make sense to reverse the active tab gradient and make it lighter on the bottom and darker on the top?PW(In reply to Paul Webster from)Paul, yes, this was a first commit, basically to bring some movement into this. Please go ahead and just either tweak the basic theme or the one for GTK.(In reply to Dani Megert from)I'm also OK to move the change from basic to win7 only.What about?It's lighter, I think it doesn't jump out as much. I kept the lighter to darker order because the END value is used to draw around the view.You can revert it if it's not quite what you're looking for, or tweak it again :-)PW(In reply to Paul Webster from)I was planning to use the similar colors working on the, but it was rejected - seeDaniel(In reply to Daniel Rolka from)DanielWe have to also define the new colors for the 'active.noFocus' state or at least copy the 'active' state ones. Currently it looks strange (the 'active.noFocus' state gets rendered with the white color)DanielCreatedScreenshot of the progress view.With the recent changes (I20140428-2000) some views look bad. At least with Windows 7 theme.Empty and selected Outline view is all blue.Progress view - the same, except the "No operations to display at this time." label which has white background - see screenshot.Help View - see screenshot.CreatedScreenshot of the Help view.CreatedScreenshot of the Outline view.(In reply to Daniel Rolka from)When does the active.noFocus apply? when the workbench window doesn't have focus? On GTK, it's just white.CreatedThe current 'active.noFocus' stateCreatedThe new 'active.noFocus' state proposal(In reply to Paul Webster from)It is the same as in the 'classic' theme - when the selected part loses the focus (after opening the modal dialog, switching to other window, ...)Currently on my Windows 7 it looks like - 'The current 'active.noFocus' state' - for me it doesn't look nice (the mixture of the white color with the blue one)I think it would be better to remove the blue color - 'The new 'active.noFocus' state proposal'DanielI used it this morning and it's obvious we would have to change lots of other colors to get a consistent look and a lot is currently "tuned" for white color. We also need more time to test on all platforms.Since M7 is already this week, I think it's best to move this to 4.5 and work on a new consistent scheme early in the Mars cycle.I've reverted the changes back to white for now.Maybe we should follow the 'Dark' theme example and adopt some 'White with Blue' theme created by the Community -Daniel(In reply to Daniel Rolka from)Is their a popular 'white with Blue' theme? Maybe Andrea or others wanted to help directly with our default theme?(In reply to Lars Vogel from)I believe it has to be created from scratch. I used the 'White with Blue' phrase in order to point the color palette for the theme.It would be great!DanielSeefor the general issue.	35.0
id=325937	REOPENED	Platform	UI	4.1	All All	P3 major	Platform-UI-Inbox	2010-09-22 05:05 EDT by	Dani Megert	2016-11-15 09:40 EST (	16 users	I20100921-1710.It's hard to immediately see which part is active. The problem is that in a stack the active part tab is white and the others in blue color. Now, if a part from another stack is selected the part tabs from the deactivated stack get white too, making it hard to detect the active part/stack.Problem summary: active part tab has same white color as inactive ones in other stacks.	Dani, is this the same problem asor is this a slightly different variant?(In reply to)I was a aware of that bug. Looking closer they are indeed different but bug 3208934 is not restricted to editors. I've update the bug accordingly.This is still one of the bugs that makes me not use 4.1.(In reply to)Me too.IMHO working fluently with the workbench requires that finding which partis active must not consume more than very few milliseconds of your brain.You shouldn't ever be aware of this kind of question.Emphasis by coloring the inactive portion of the tab bar of the active partrequires that you actually think about it. Keep in mind that this inactiveportion of the tab bar can be smaller than the active tab. For finding theactive part you do not want to actively search for inactivate tab bar areas.Please consider either:- using a dedicated color for the active thing (active tab within active part)- or: paint significantly different borders, e.g., 3-D effect only for the active part, other parts are strictly flat on the background. E.g., KDE has this "glow" around the active window, which works well to attract the eyes.No progress here? 4.2 milestones still don't look convincing.Desperate to get some useful emphasis back I tried to change thepreference back to 3.x values. Much to my surprise the preferences seemto "believe" that I still HAVE a 3.x Eclipse.(General > Appearance > Colors and Fonts > View and Editor Folders).If proper emphasis is not the default that's a regression,if configuration options are out of sync with the implementationI'm all at loss.Please:The current scheme requires the user to actively think in indirections:I'm looking at a tab in a stack: it's white, what does it tell me?Nothing, tabs in all stacks are white. Is it active? Look at the thoseparts of the tab-bar that you are NOT looking at! Do they have a differentcolor than all the other not-looked-at parts of tab-bars? Yes?Mind you: that's way too much indirection and negation doesn't work wellunconsciously. Pretty please, give back a one-stop info.This is still one of the bugs that makes me not use 4.2 on a regular basis.Bogdan, is there any CSS mechanism through which to specify the color of the tab item for the active part ?Personally I don't find this confusing but I've been using it for a long time...This is probably controlled by the basestyle followed by the platform stylesheet.base:.MPartStack { swt-tab-renderer: url('bundleclass://org.eclipse.e4.ui.workbench.renderers.swt/org.eclipse.e4.ui.workbench.renderers.swt.CTabRendering'); swt-unselected-tabs-color: #FFFFFF #FFFFFF #FFFFFF 100% 100%; swt-outer-keyline-color: #FFFFFF; swt-inner-keyline-color: #FFFFFF; padding: 0px 9px 10px; swt-tab-outline: #B6BCCC; swt-shadow-visible: true; swt-mru-visible: false;}.MPartStack.active { swt-inner-keyline-color: #FFFFFF; swt-tab-outline: #B6BCCC; swt-shadow-visible: true;}gtk:.MPartStack.active { swt-unselected-tabs-color: #DCDCDC #E1E1E1 #FFFFFF 100% 100%; swt-outer-keyline-color: #B4B4B4; swt-tab-outline: #B4B4B4;}CreatedPicture showing active tab not recognizableGiven the active part is more important, its tabshould also be more eye-catching that inactive ones. Maybe it's just me, butthe gray-shaded tabs jump much faster to my eyes than the white one.I would be willing to close this as being a matter of taste, but only ifgot fixed.Given, the current look is a pain for me. Can you please reconsider to fix this for 4.2?(In reply to)Or.also explains the lack of consistency in the E4 themes.Do you have any suggestions how to mark the active part? Do you want to have any specific background color or any specific border?I would use some the specific border color since it won't introduce the major change in the 'e4 default' layout and it should be smoothly accepted by the users, IMHODaniel(In reply to Daniel Rolka from)In the old 3.x theme the active part is easy to detect because it has- colored background of the tab- border around the entire part in the same colorI'm not particular keen on any specific color as long as it can be easily distinguished from the rest.So, why not re-adopt what has worked just fine in the past? :)(BTW I didn't quite understand your proposal grammatically, so not sure if you're actually proposing the same)CreatedModified E4 default theme(In reply to Stephan Herrmann from)Do you want to get the following effect: 'Modified E4 default theme'?I'm not sure if we want to copy the entire 'classic' theme to the 'E4 default' oneThe 'E4 default' theme has got the specific color scheme and I would like to solve the current issue following it. I don't want to introduce major changes in the theme - for me replacing the 'white' background of the active part with other color is the major change. From my point of view adding some border that will help the user distinguish the active part is better option (the current 'blue' background of the inactive parts seems to be insufficient)Daniel(In reply to Daniel Rolka from)This makes it even harder to see the active tab in the active part stack (e.g. if you have many editors open).These theming problems cannot be resolved one-by-one, since all colors depend on each other, and whenever you change one color, you break other constraints. The only way out of the misery is to define a few core concepts and then stick to them. See.(In reply to Markus Keller from)All colors used by the 'E4 default' theme are exposed in the preference page. Are you able to modify the theme as you think it should look and attach the proper screenshot? When we all agree with the new color palette I will update the CSS files with the new default values.thanks for help,Daniel(In reply to Daniel Rolka from)I wasn't suggesting to copy all aspects of the classic scheme, just the aspect relating to highlighting of the active part. :)I think the only way leading us out of a discussion of personal preferences is to really do a little usability experiment along the following lines:- start with 3-5 draft theme proposals- create 10-20 different screenshots in each variant (for all IDE situations)- pick 3-5 test persons, for each: - present the screenshots in sequence - let test person name the active part as quickly as s/he can - measure total time for all screenshots, milleseconds are relevant ...I believe, when drafting a proposal, one should take the freedom to modify other aspects of the theme as well, because the contrast (brightness & color) matters, not the color by itself.CreatedActive part with borderCreatedActive part with gradient(In reply to Daniel Rolka from)I would like to propose the following solutions for the issue: - marking the active part with border - 'Active part with border' - marking the part with the 'classic' like gradient - 'Active part with gradient'Daniel(In reply to Daniel Rolka from)-1. The thin colorful border looks like a rendering issue. The 1px line is too intrusive and the rounded corners look jagged because there's no anti-aliasing.(In reply to Daniel Rolka from)This looks better, but it's hard to tell from the screenshot how easy it is to find the active editor tab if you have many editors open. (That's already hard today if the workbench window doesn't have focus.)CreatedActive editor with gradient(In reply to Markus Keller from)I've attached the snapshot with the active editor - 'Active editor with gradient'(That's alreadyWe have the support for the active and without focus parts in the 'e4 default' theme, but by default it is rendered as the active parts. We have to just define better colors for this state (the 'classic' ones don't match here)DanielDo you agree with the following proposals:CreatedActive part with gradientCreatedActive editor with gradientand I can update the 'e4 default' themes with the new default colors?Daniel(In reply to Daniel Rolka from)My e4 default is all greys, whites, and gradients. But that's GTK. What is it supposed to look like on GTK?PWCreatedThe CSS style sheet used to generate the active part/editor with gradient(In reply to Paul Webster from)For me the new colors are fine on the GTK. Are you able to confirm it using the style sheet - 'The CSS style sheet used to generate the active part/editor with gradient'?I don't know if it is fine on the Mac OSDanielCreatedPackage explorer with jarring bluw, attached CSSThis changes the colors on GTK and is quite jarring (and deviates significantly from the default e4 style).The blue isn't part of the e4 color pallete on linux at all.Also, activating a non-eclipse window gets rid of the blue completely.PWCreatedPackage explorer currentCreatedType hierarchy with jarring blue, attached CSSCreatedType hierarchy currentOK, so we can focus on Windows now and prepare the separate patches for the GTK as well as the Mac OSDanielLooks like a bug in the E4 themes that the "Active part background end" color bleeds into the wrapped view toolbar and even into the view background. This doesn't happen in Classic themes.(In reply to Markus Keller from)Yes, see.Fixed withWe can still further improve the details during RC1.(In reply to Dani Megert from)I've reverted that change, seefor more details.CreatedProposal 20150922-1 : reverse part colorsThis proposal is reversing settings of enabled/disabled parts in order to put more "light" on the active part and soften colors for inactive parts.CreatedProposal 20150922-2: white + 2 shades of greyThis second proposal introduce a new grey in order to have only 1 tab, the active one on the active part, using white.***has been marked as a duplicate of this bug. ***CreatedJeeyul's Chrome ThemeAnd is the proposal better? I have more confidence in our (Platform/UI interested parties) ability to propose and implement small improvement and iterate than in our ability to agree on one good solution within a year.Here it is.I believe you'll like Jeeyul's theme (and there are several very good ones, more usable than default Eclipse one)Most of us are probably well aware of this; some but not all proposals seem to adhere to it:Human vision recognizes brilliant colors with high contrast as proximity, things to pay attention to right now.Mist, blur, weaker colors, darker colors, smaller size, those signal distance and things that can be ignored right now.Let's make sure "active" is perceived as "close by", "inactive" as "distant" and all will be fine.(In reply to Stephan Herrmann from)Amongst the recent proposal, is there one that you think would make a first iteration on the right direction, compared to actual theme?(In reply to Mickael Istria from)+1. Looks good. Just wondering what (visually) would happen if we give it a 1 pixel border (with some blueisch Eclipse color)?(In reply to Andrey Loskutov from)I pushed the suggested CSS for the 2nd proposal on. However, since I don't feel very easy with e4 CSS, I didn't go further and didn't try to add a border for selected tab.Sonce the proposal on Gerrit implementingseems to be an improvement over current status, I'm setting a target to 4.6.M3 hoping this can be reviewed and merge as a step forward.Created56418/3: active part tab presentation with opened modal dialog on win 10(In reply to Mickael Istria from)Mickael, after trying the new theme on Windows 10 (unfortunately I have no other PC at the moment), I've noticed a small issue: the currently selected and active part appearance changes if one open a dialog, see attached picture. Since the new theme has no gradient, but this "active inactive" tab has a gradient, it looks strange. I'm not sure if this is intended or not (the old theme didn't changed tab appearance with opened dialog), but my feeling is that in this case the appearance shouldn't change.Thanks for trying the patch and noticing this issue Andrey. Indeed, it seems to be something important to improve before merging the patch. I'll do my best to fix that, but since I'm not good at e4 CSS, any help would be highly welcome!@Andrey: your screenshot seems to show that you have Jeeyul's Chrome Theme installed while trying the patch. Is that the case? Can you please try without it?(In reply to Mickael Istria from)No, I do not use it. Usually I do not have theming enabled at all, but if I do, I use "pure" Eclipse.Ok, got it. I got confused because the default color on Windows seems to be a similar blue as Jeeyul's Chrome theme.CreatedProposal in Patch Set #6I uploaded the suggested Gerrit review to include changes suggested by Andrey about keeping same color of the active selected tab with or without focus (current behaviour in Mars.1). I also changed the shade of gray by a mix of blue and gray that was already referenced in the CSS.I like the result (see attached screenshot).Createdactive/inactive part/stack color proposalI was asked to comment on patch #7 regarding this issue. While it succeeds to improve the discriminability of the active/inactive part/stack I find the overall color scheme less appealing as the one of the original theme. This attachment shows a solution that keeps most of the active part/stack color settings of patch 7 but increases the outline contrast of active and inactive stacks. Plus, it works with decent shades of the active-non-selected tab color for the inactive part/stack elements. One first sight this seems a neat compromise to me - what do you think?CreatedPatch forPatch for(In reply to Frank Appel from)Frank, the result looks great (the theme in overall is not for my taste because of the colored toolbars, but this is not the point here). Two things:1) Can you provide a gerrit patch?2) Can you provide a Linux GTK version?Some comments about Franz's proposal. Most also applies to the current CSS:* The selected part stack (whole stack, not tab) is darker than the not selected one. So it makes that the unselected part stack is literally highlighted compared to the inactive one* On GTK3, I tried the patch and I didn't see a clear improvement over current status. There is still white on the inactive stacks, and a lot of light is put everywhere, making it difficult to identify context at first sight* In general, the use of gradients seem to be an anti-pattern: indeed, gradients give an impression of relief and make the tabs with gradient feel like they are a bit above all the others without gradient. As we already are using colors and light to express the distance and focus for tabs, having also gradients makes that we use 2 metaphors for the same thing, with conflicting results. Like most of the applications I'm using, both web and desktop, Eclipse IDE should probably avoid gradients.So IMO, this issue is mainly about removing the gradients, and making sure that the more an item is active, the lighter it is.So I published a patch set 8 on Gerrit which is removing gradients (similar to patch set 6 which has screenshot attached, but with a shade of grey instead of a blue-ish one). In my opinion, it's comfortable to use and fixes the initial issue about detected active part/stack.About the palette of colors, it would be better to discuss it in another bug since it's a related but different topic.(In reply to Mickael Istria from)I see what you mean by the similarities, but given it a second thought I actually can't follow the initial statement of this issue. I clearly perceive the outline view as the active part in the. So probably it's no wonder why my proposal has similarities to the original theme. Which raises the question (at least for me) whether this issue is indeed observed as a problem by the majority of the users. So, let me share some reasoning on this.What I tried to achieve was to intensify the contrasts to emphasize the active part even more. This is because from what I understand of color theory, emphasizing has more to do with contrasts than simply putting some light or dark colors on UI elements (I deliberately avoid the term highlighting here). Putting a darker color or black around a box of light color, for example, emphasizes the box content much more because it appears brighter. Looking at the original theme screenshot from that point of view, the outline view tab is the most prominent element of the workbench parts, which is a clear signer that it reflects the active part of the conceptual model - I can't follow the argument of the issue creator here, which shows how different the perception of people can be.The relief effect of the gradient, as you named it, actually reduces the contrast and makes the element less prominent. But, while I doubt the theory of conflicting results, I can see that the gradient might be a bit of an alien element as it isn't used on other parts of the UI. However, considering the steering effects of colors, in general, I'm skeptical of the idea to separate the decision about the color palette from this topic.But since I'm far from being a professional designer there is a good chance that I got it all wrong - so it might be a good idea to ask a pro for help ;-)CreatedPatchSet #8 vs Current (GTK3)Attached screenshot shows the current status of Eclipse IDE on GTK3 (on the right) vs current proposed patch set 8 (on the left).To me, it seems obvious that the proposal is a step towards fixing the issue of detecting the active tab more easily. I wouldn't say it's perfect, but at least, it works and it can be a 1st iteration. WDYT (Franz, Andrey and other interested parties)? Note that for the sake of actual progress, the question isn't really "how could it be better?", but more "is it actually better and should it be merged as a valid solution for the reported issue?".I just checked competiting IDEs, and IJ uses a similar approach of flat, no gradient, tabs with white/light grey + 2 shades of grey ; and NB uses a specific color (light blue) for the selected tab where all other tabs are in 2 shades of grey.(In reply to Mickael Istria from)I definitively agree that the color scheme on GTK is an improvement (given my explanations about contrast above I still would give it a try to use a darker shade of gray for the inactive tab of the active part stack than the one for the inactive tab of the inactive part stack. Well, but as you said that might not be the focus here).However, given that the windows theme uses a color scheme based on shades of blue, comparison with other applications that are based on shades of gray may not be appropriate. So from the point of the windows theme, the latest patch isn't an improvement, it simply looks broken. But maybe there is something broken indeed (only with my checkout?) because the inactive tabs of the inactive parts show a gray gradient. If I understand your previous remarks correctly, you would prefer to avoid any gradients, right?(In reply to Mickael Istria from)I definitively agree that the color scheme on GTK is an improvement (given my explanations about contrast above I still would give it a try to use a darker shade of gray for the inactive tab of the active part stack than the one for the inactive tab of the inactive part stack. Well, but as you said that might not be the focus here).However, given that the windows theme uses a color scheme based on shades of blue, comparison with other applications that are based on shades of gray may not be appropriate. So from the point of the windows theme, the latest patch isn't an improvement, it simply looks broken. But maybe there is something broken indeed (only with my checkout?) because the inactive tabs of the inactive parts show a gray gradient. If I understand your previous remarks correctly, you would prefer to avoid any gradients, right?Createddark themed Idea and VS 2015 side-by-sideHere's a side by side comparison of IDEA 15 and Visual Studio 2015. VS uses a striking blue focus color for currently active part stack. In general its theme is really very good. IDEA uses a weak nondescript blueish grayish focus color for active parts, which you can barely see from few steps away. Oh, IDEA also has something called scopes for files which in practice means code editor tabs don't get any focus color when they are active. A bit weird. I picked a color I'd used earlier and it's not really getting it...Since the UI styles are quite different between Windows (which uses shades of blue and gradients) and GTK (shades of grey, flat) applications, this requires specific changes for Windows and GTK.Frank Appel and I have collaborated on a patch that was submitted as a new patch set on. We believe that this is a good solution for this issue, on both systems.(In reply to Mickael Istria from)I had hard time to see differences on Windows but commit message helped finally. +1.Gerrit changewas merged to [master].Commit:Thanks everyone! I'm very pleased of the GTK fix, and the Windows change seems good too (although I didn't try in action).Is there anything to add on this topic or can we mark this issue as resolved?Would it be possible to backport it to maintenance branch? What's the policy regarding theme changes?(In reply to Mickael Istria from)-1. We only backport critical fixes not enhancements(In reply to Lars Vogel from)Correct, and we avoid UI tweaking changes in service releases. Same applies to strings shown in the UI. Adopters and products often produce documentation and screenshots based on the release and don't expect to have to change that for a service release. In addition, they might have set colors for their UI based on what we deliver with the release theme(s).(In reply to Mickael Istria from)On Windows 7 with a new workspace I cannot really see a difference between 4.5 and N20151129-1300.(In reply to Dani Megert from)I just checked the build on windows and verified that the changes have been applied. It's only a small evolution of the original default theme, but it should make the active tab of the active stack a bit more prominent by reducing the contrast of the inactive stack elements - without disrupting the accustomed L&F. Maybe the win related commit message helps:On Windows:* reduce contrast on inactive tab gradient* reduce contrast between inactive tab and unselected inactive tabs by the use of a light blue background colorOr did you notice these changes but think they do not work out well or they are not enough?Marking as fixed as we have some improvements, please reopen or open a new bug, if there is still work to be done.(In reply to Lars Vogel from)I filed this bug and just commented a day ago that it is not fixed for me, so, closing this is not OK.Created4.5 vs. N20151129-1300(In reply to Frank Appel from)I didn't really notice any change that jumped into my eyes. See attached picture that shows 4.5 (left) and N20151129-1300 (right), with the Problems view being the active part.(In reply to Dani Megert from)Ok, seems as if you're expecting something different. Sorry that it didn't work out, but I'm running out of ideas. Maybe someone else can come up with a better approach.I believe the approach used for the GTK Theme (Flat tabs without gradient, white and light colors for the active part and darker for the inactive ones) would work well on Windows too.(In reply to Frank Appel from)Can you see any real difference in my attached picture?Some other software with a blueish theme (such as visual studio) use some yellow/orange as background or underline for the active tab. Maybe we could simply adopt it for Eclipse IDE on Windows?(In reply to Mickael Istria from)No, that would be too intrusive and not fit into the blue theme. Just take a look how it was done in 3.8.2: everything was grey except for the active part tab, which was blue (similar color as the active window title bar).Createdwhat is the active editor / view?I'm not 100% sure if this is caused by the change here, but since recently I started spending time in guessing which editor I'm currently looking at, when the editor stack doesn't have focus (see attached screenshot).Similar for the bottom stack: where do I have to click to close the history view?Feels like a regression to me.Seen in I20151222-0800 running on Kubuntu 15.10 with SWT_GTK3=0.The same lack of difference can be observed on GKT3, too.The following seems to be the best way to figure out which editor/view in an inactive stack is shown: hover over all the tabs in the stack, the one that is *not* highlighted (white background) during hover, is the visible one, outch.Since in this bug we are discussing how to de-emphasize inactive parts, I'd like to suggest to mark the visible editor / view by a stronger outline around the tab, rather than continued fiddling with tab colors.(In reply to Stephan Herrmann from)The GTK2 theme you are using seem to be not usual nor the default one (both widget shapes and colors). Can you please try to set the default one (not sure which is this for Kubuntu, if it is still Oxygen then better not use it at all), but I would try Adwaita (default for Gnome) or Clearlooks-Phoenix. Another option is to try to manually configure theme colors in KDE and apply this to GTK theme in the GTK+ appearance settings tab.(In reply to Andrey Loskutov from)In a stock Kubuntu 15.10, I have two "acceptable" themes: "Orion" (GTK2/3) and "Emacs" (GTK3 only). When taking the above snapshot "Orion" was selected for GTK2, but it seems that setting wasn't taking effect, defaulting to "Raleigh" - which would explain some of the ugliness :) (I'm well aware of the dangers of using oxygen-gtk ...).However, independent of the GTK theme (even when using oxygen-gtk or Raleigh), the colors for shown/hidden tabs was the same almost identical pair of shades of gray. Are all these themes "broken"??? How do you distinguish tabs in an inactive part in other linux environments?FWIW: - GTK2 is 2.24.28-1ubuntu1- GTK3 is 3.16.7-0ubuntu3(In reply to Stephan Herrmann from)< How do youshows how it looks like on GTK3 with a recent Fedora (I believe the same thing applies to all gnome3-based environments).Some other contributors have reported on the mailing-list their satisfaction regarding this theme change on Linux. Like Andrey, I'm wondering whether what you're looking at is actually the default Eclipse IDE theme.The screenshot I linked to isn't totally accurate.On a second look, I agree with Stephan that "active no focus" tabs have a color that's very close to "inactive no focus" ones, sometimes making it a bit tricky to identify which one is enabled. Maybe the "active no focus" color could be a bit brighter or outline a but stronger could be worth trying.Still a bad bug that we should address.***has been marked as a duplicate of this bug. ***If it's too hard to agree upon a set of colors that clearly conveys the different levels of activeness (6 years not being enough time to discuss this), then a solution a lacould help very much, IMHO.(In reply to Stephan Herrmann from)+1(In reply to Stephan Herrmann from)A solution a lajust adds a new possible way of doing things, I don't think it's going to make agreement any better.Things on Linux have much improved in the last year. All it's missing is changing the grayscale of the active unselected tab. You can pick one in the Colors & Fonts preference page, it's "Inactive, unselected part color". Once you find a grayscale that looks nice to you, please share it with a screenshot and we could easily update the CSS accordingly (or you could also push a patch directly).For Windows, a similar solution could be taken. It just requires a Windows user to drive this effort and make some proposals and so far, no-one stood up. I believe fixingwon't increase chances for a Windows user to take action here.	84.0
id=374767	REOPENED	Platform	IDE	3.7.2	PC Linux	P3 normal	Platform-UI-Inbox	2012-03-20 10:44 EDT by	Danny Staple	2012-11-28 07:24 EST (	1 user	Build Identifier: IndigoI have egit and pydev plugins in use.Egit had gone into its state of no right-click menus being supported.Upon exit the following stack trace was seen:org.eclipse.swt.SWTException: Widget is disposed at org.eclipse.swt.SWT.error(SWT.java:4282) at org.eclipse.swt.SWT.error(SWT.java:4197) at org.eclipse.swt.SWT.error(SWT.java:4168) at org.eclipse.swt.widgets.Widget.error(Widget.java:466) at org.eclipse.swt.widgets.Widget.checkWidget(Widget.java:403) at org.eclipse.swt.widgets.Control.getBounds(Control.java:706) at org.eclipse.ui.internal.progress.ProgressManagerUtil.animateUp(ProgressManagerUtil.java:414) at org.eclipse.ui.internal.statushandlers.InternalDialog.open(InternalDialog.java:338) at org.eclipse.ui.internal.statushandlers.WorkbenchStatusDialogManagerImpl.doAddStatusAdapter(WorkbenchStatusDialogManagerImpl.java:270) at org.eclipse.ui.internal.statushandlers.WorkbenchStatusDialogManagerImpl.addStatusAdapter(WorkbenchStatusDialogManagerImpl.java:197) at org.eclipse.ui.statushandlers.WorkbenchStatusDialogManager.addStatusAdapter(WorkbenchStatusDialogManager.java:156) at org.eclipse.ui.statushandlers.WorkbenchErrorHandler.showStatusAdapter(WorkbenchErrorHandler.java:101) at org.eclipse.ui.statushandlers.WorkbenchErrorHandler.handle(WorkbenchErrorHandler.java:57) at org.eclipse.ui.internal.ide.IDEWorkbenchErrorHandler.handle(IDEWorkbenchErrorHandler.java:108) at org.eclipse.ui.internal.WorkbenchErrorHandlerProxy.handle(WorkbenchErrorHandlerProxy.java:36) at org.eclipse.ui.statushandlers.StatusManager.handle(StatusManager.java:189) at org.eclipse.ui.internal.JFaceUtil$3.show(JFaceUtil.java:70) at org.eclipse.jface.util.SafeRunnable.handleException(SafeRunnable.java:67) at org.eclipse.core.runtime.SafeRunner.handleException(SafeRunner.java:75) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:44) at org.eclipse.ui.internal.Workbench.busyClose(Workbench.java:1111) at org.eclipse.ui.internal.Workbench.access$15(Workbench.java:1040) at org.eclipse.ui.internal.Workbench$25.run(Workbench.java:1284) at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70) at org.eclipse.ui.internal.Workbench.close(Workbench.java:1282) at org.eclipse.ui.internal.Workbench.close(Workbench.java:1254) at org.eclipse.ui.internal.WorkbenchWindow.busyClose(WorkbenchWindow.java:727) at org.eclipse.ui.internal.WorkbenchWindow.access$0(WorkbenchWindow.java:715) at org.eclipse.ui.internal.WorkbenchWindow$6.run(WorkbenchWindow.java:867) at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70) at org.eclipse.ui.internal.WorkbenchWindow.close(WorkbenchWindow.java:865) at org.eclipse.jface.window.Window.handleShellCloseEvent(Window.java:741) at org.eclipse.jface.window.Window$3.shellClosed(Window.java:687) at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:98) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1258) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1282) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1267) at org.eclipse.swt.widgets.Shell.closeWidget(Shell.java:617) at org.eclipse.swt.widgets.Shell.gtk_delete_event(Shell.java:1189) at org.eclipse.swt.widgets.Widget.windowProc(Widget.java:1735) at org.eclipse.swt.widgets.Control.windowProc(Control.java:5016) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4408) at org.eclipse.swt.internal.gtk.OS._gtk_main_do_event(Native Method) at org.eclipse.swt.internal.gtk.OS.gtk_main_do_event(OS.java:8422) at org.eclipse.swt.widgets.Display.eventProc(Display.java:1245) at org.eclipse.swt.internal.gtk.OS._g_main_context_iteration(Native Method) at org.eclipse.swt.internal.gtk.OS.g_main_context_iteration(OS.java:2276) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3207) at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2701) at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2665) at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2499) at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:679) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:668) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:123) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:344) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:597) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:622) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:577) at org.eclipse.equinox.launcher.Main.run(Main.java:1410) at org.eclipse.equinox.launcher.Main.main(Main.java:1386)Job found still running after platform shutdown. Jobs should be canceled by the plugin that scheduled them during shutdown: org.eclipse.ui.internal.progress.WorkbenchSiteProgressService$SiteUpdateJobJob found still running after platform shutdown. Jobs should be canceled by the plugin that scheduled them during shutdown: org.eclipse.ui.internal.progress.AnimationManager$This is not the first time I've seen it, but it is the first time I've capture the stack trace and reported it.Reproducible: Didn't trySteps to Reproduce:1. Use egit + pydev a lot (2 days session)2. Eclipse will get into a state of not responding to context menu clicks3. Close down eclipse	I've copied over the relevant information.*** This bug has been marked as a duplicate of***Danny, I'm going to re-open this bug as I'm going to close the old one.PWI am not sure, but I don't think thatis really a duplicate. The exception there occurs when using the properties view and I can reproduce this here *without* shutdown, just by playing with the properties sheet and the filter button. I will provide a more detailed scenario if possible.	3.0
id=364569	REOPENED	Platform	IDE	3.7	PC Windows 7	P3 enhancement	Platform-UI-Inbox	2011-11-23 06:15 EST by	Mauro Molinari	2015-10-15 08:28 EDT (	4 users	Build Identifier: M20110909-1335The lazy loading mechanism of Eclipse Platform for plugins can cause the following problem: if you try to import in the workspace a project which had already been checked out from a Subversion repository into an external folder (with an external client), if the Subversive plugin has not yet started, the imported project won't be connected to SVN, although the Subversive option to automatically share project is enabled.The discussion is at, which is marked as "fixed" but the fix is some kind of workaround that may work in some cases but not in others.If an extension point prior to project import existed, the Subversive plugin could use it to "intercept" that event and load itself in time for the automatic project sharing to work.Reproducible: AlwaysSteps to Reproduce:Please seefor the steps to repro.As a summary: checkout a project from SVN with an external Subversion client into an external folder, start Eclipse (with Subversive plugin but without Subversive-Mylyn integration) on a fresh new workspace, try to import the checked out project into the workspace => your project won't be connected to SVN.	I think it is not related to IDE but more like to Resources component, because the issue is related to the headless environments as well.Actually I've already tried to find a solution for the problem but without success. Currently I can listen to the project import events only by connecting my listener through Java code. But since plug-in is not loaded at startup, whatever I do have no effect at all, because there is no Java code to be executed due to lazy load policy. So, having some extension point that will allow to intercept the events will be really helpful.I'm not sure how it is related to Resources. I tried similar steps for CVSclient and it works fine, so SVN could do the same. If you are looking for ahook for importing/creating projects, you could use a resource changelisteners, see IResourceChangeListener.Moving back to IDE.(In reply to)Hello Szymon,That is obviously the case with listening through IResourceChangeListener. But then could you please point me, how I can install a listener through the code, when plug-in itself is not loaded yet and will never be loaded if no one tried to access it first?Thank you in advance.The guidelines for IDE plugins are1) wait for a user operation to load your plugin2) on load, check for any conditions that could have happened while in the STARTING state.Is it not possible for you to scan the list of projects after you've started and run the "oh, you're an unshared SVN project" code? Or is your code a contribution (like an extra page) in the Import wizard?Advanced plugin loading is to be avoided at all costs, as once your plugin has been activated the framework will load and instantiate all contributions it can within a very short amount of time (cost in performance and memory consumption).In RCP apps it is not an issue as RCP apps are free to start up whatever they want in their WorkbenchAdvisor#postStartup() method.PW(In reply to)I think the problem is that, after the import has finished, the user sees the projects as unshared. What the user should do to share them, apart from issuing a manual Team | Share project operation (which is exactly what we want to avoid)?Even though Subversive did such a scan, the user would be forced to do some action related to Subversive in order to "activate it", while the imported project should have all the SVN-related facilities already working after the import has finished, without the user having to do anything (unless the option to automatically share projects is unchecked).Please note that mine is just a user point-of-view Alexander knows the technical details.(In reply to)I guess, you're refering to something like this?ISavedState ss =ResourcesPlugin.getWorkspace().addSaveParticipant(SVNTeamPlugin.instance(),this);if (ss != null) { ss.processResourceChangeEvents(this);}But after importing a project there were not a single change available (I don'tthink debug break point could influence it, right?).Another point is what will hapen if we're going with the flow (even if theimport project event really was saved which is not the case):1) We're starting IDE2) Workspace is clean, so there are no interaction with the source controlprovider and it is not loaded3) We're importing a bunch of projects with the SVN meta-info4) We're expecting something...forever! There will be no automatic share ofthose projects until we do something that will cause SVN Team Provider to beloaded!And the last point is that WorkbenchAdvisor is something related to UI. Andwhat will we do in the headless environment?(In reply to)And there is more to be wary of, the real issue is not that the projects will not be shared, but that none of all the .svn folders with their contents will be marked as team private. Then those folders will interfere with the build process, after sharing the project they will be regarded as damaged parts of Subversion working copy etc.(In reply to)yes. If the user does Team>Share, or switches to the SVN perspective or opens an SVN view, then your plugin will be activated and you can process existing projects to see if they are unshared but contain SVN metadata.This only applies to the IDE, and it is the expected behaviour for all plugins contributions. CVS behaves the same way, it doesn't get activated until a user action (and then occasionally responds with "Operation is not currently enabled"). The Eclipse IDE lazy loading policy trades accuracy for performance.WorkbenchAdvisor is what RCP apps control in a UI environment (allowing an RCP app to circumvent the lazy loading policy). We don't have access to that in the IDE.In a headless environment you're in an equinox application. Then it totally depends on how your app starts up plugins. Did it specify start levels in osgi.bundles? If not, and your headless app also uses the standard equinox/plugin model (everything is lazy) and you want to force a bundle activation, you can do that via code in your IApplication start method.org.eclipse.core.runtime.Platform.getBundle(String) and then bundle.start(Bundle.START_TRANSIENT).PWExtra information:A way to circumvent this that is least unpalatable is to write a small plugin that 1) has no UI contributions and 2) has almost no extension point contributions and 3) can do the simple checks you need on startup and only start other plugins if deemed necessary.Then you use org.eclipse.ui.startup to cause org.eclipse.ui.IStartup (not the activator) to be run soon after the workbench is realized.PW(In reply to)Yes, this is a major problem that was observed in other circumstances as, but that still exists wheneveris hit (as a consequence of the problem we're talking about).(In reply to)And this is exactly what users see as an issue. There exists this saying that "premature optimization is the root of all evil". It's a joke, obviously, but there are some truth in it. As I said this behaviour will cause a lot of issues with a negative user expirience:1) Many useless nodes in the Navigatore, Package Explorer etc.2) Interference with the build process3) Issues with the source control metainformation integrity4) Failed user expectationsWe're not talking about something like forceful loading of source control plug-in. It will be pretty stupid, since the lazy loading policy is not that bad itself. But! When the project is imported - it is obviously the point where the team providers core (and core only) plug-ins could be loaded to check if some actions are required. And more over, there could be some expressions/data in the extension point specification, that will allow to load only the team provider plug-in related to the project. For example it could be something like a filter, saying to load SVN Team Provider if there is a .svn folder inside the project folder or load CVS Team Provider if there is a CVS folder.I know of the org.eclipse.ui.IStartup extension point existance, but I don't think it is suitable for the task.1) As I've mentioned before, the solution should work in any headless environment too2) Also there should be no way to disable it through preferences (it is not the same as disabling autoshare, we still should mark team-private members!)(In reply to)This optimization was added long ago after a consistently reported problem by users. There was a lot of debate about the pros and cons before it was implemented, but it was the solution that was picked.The cost of having all plugins activated on startup is huge, especially when you start adding a number of different projects (CVS, SVN, EGit, Xtext, EMF, WTP, XML Editors and tools). Plugins must avoid starting up without a user action at all costs.In the Eclipse IDE, this lazy startup has been that way for a long, long time. When unknown that it's the standard policy for the entire Release Train stack yes, it can lead to some user confusion. But long startup also cause failed user expectations, and a huge consumption of memory does as well.And AFAICT this is a corner case. The user starts up, externally uses SVN to get their projects, and imports them into eclipse without ever touch SVN plugin functionality. Presumably they don't then import external projects into empty workspaces all the time, and starting up with even one SVN project (which has decorators and would cause activation) is enough to prevent the problem ever again.Slow startups and huge memory consumption continue to be an issue in the release stack, and for us (in the framework) we want to avoid that at all costs.In the headless environment you have a different way to start up plugins. You wouldn't want to pull the >4Meg workbench just to start up a plugin. That would make your headless tool startup time comparable to the UI :-)Starting the small startup plugin from an headless app would work the same way, arguably.The user can disable them if they really want to ... but 1) don't often because they don't know what they do and 2) if they did, then they would have a problem and would quickly re-enable them.PW(In reply to)I understand your point, but it sounds just like "if because of the missing handrails on the ladder one of the ten people will break their neck - it is not a problem at all because nine of them will still be safe". :-)I understand, that is why I've proposed an idea that will allow to cover the case without excessive memory/CPU consumption: an extension point. And we even can merge it with your idea regarding "small plugin": small plug-in that implements extension point reacting to the resource addition event, that will cause loading the main plug-in only if it is required.P.S.I understand that when we're in the IDE, we can use IStartup but I still find it inappropriate because it won't work outside graphical environment and could be disabled. And this is exactly the reason why I tried to move the issue report to the Resources component.(In reply to)There are use cases for which this is not a corner case.When you work with Gradle multiprojects, since Eclipse does not support nested projects, the typical workflow is the following:- checkout the whole multiproject on an external folder (I mean "external" relative to the workspace) with an external SVN client- import the multiproject in the workspace using Spring Tools Suite Gradle Integration Import Wizard (which may or may not do some Eclipse projects setup; in our case, it's used just like the standard Import Existing Projects Into Workspace, except that this one doesn't let you import nested subprojects of a Gradle multiproject)- start to work on your projects, which should appear as already shared and without missing SVN metadata due to this problemI think the problem here is not that we want to consume memory or to slow down the platform startup, but that there should be a way for the SVN plugin to be loaded before any action is performed that needs the SVN plugin to be already loaded and active.The import of projects into the workspace is one of them and this is the reason of this enhancement request.If you think there could be another way to do what is needed, without adding an extension point, I think Alexander would be glad to try it, but I don't think the best answer is to say that there is no problem here or that this is a "corner case" to ignore. Please forgive me if I misunderstood.(In reply to)Sorry, this should be read: "without *corrupted* SVN metadata".(In reply to)There's a cost associated with extension points in maintenance for the implementation and API (and once published API can only evolve in one direction). And solving this problem for the many extension points that all have that one or two corner cases could consume an entire release.We have a general solution for plugins that really have a situation where they can't wait for user action. A small plugin to evaluate when things need to be started up that uses an early startup extension for use in the IDE.The small plugin that can determine the condition to activate is the solution. IStartup when in the UI to start the plugin at the appropriate time, and Platform.getBundle(*) to start the plugin with fine grained control in headless equinox or OSGi applications.That the startup extensions can be disabled is the trade-off for people that hate having things start up when they fire up eclipse. But even they turn it back one when told it must work that way.PW(In reply to)The small plugin that can make a determination and the startup extension point is the general solution for situations where a project *must* circumvent the lazy loading strategy.PWHi Alexander, do you have decided something about this?Should we open a new bug or move this to Subversive?(In reply to)Hello Mauro!I think I won't hit the wall with my head anymore. If it is all right to have such an unobvious issue then there is nothing I can do.I'll reopen the original issue report, then use the UI IStartup extension point to handle it in the Eclipse IDE (hoping there won't be anyone who will disable it in their environments) and expect that the people responsible for their headless environments will handle the case properly as well.P.S.So, if there are no plans to provide an extension point for the issue, please feel free to close this report.(In reply to)Thank you Alexander. I'll leave the decision to reject this request or not to the Platform dev team..In order to fixright way we needto be reopened and fixed. Anything else are workarounds. It's platform duty to make sure that appropriate team providers are lazy loaded for project import, not other way around.I don't see why should egit/svn/whoever *each one* provide extra plugins which must implement IStartup and always activate egit/svn/whoever as bundles (proposed in) even if no import functionality is requested.Since team providers are only used in IDE's, each of them could for sure directly contribute IStartup's, but this drives all those recently started platform startup enhancement initiatives ad absurdum.We should provide an extension point in platform which would only be used *if needed* (truly lazy loading) during project import and not force each and every team plugin provider to add overhead to the platform by contributing extra bundles to IStartup and finally loading all team plugins even if the user don't need all of them at all.	22.0
id=375220	REOPENED	Platform	UI	3.7.1	All All	P3 normal	Platform-UI-Inbox	2012-03-23 18:24 EDT by	Andreas Zimmermann	2012-03-28 06:06 EDT (	4 users	Build Identifier: 20110916-0149When using HandlerUtil.getCurrentSelection(ExecutionEvent):ISelection, I get only selections, which's length does not equal zero. Selections with length >= 1 are propagated to the SelectionListener of TextEditor. Just changing the cursor postion is also a selection change, so changing the cursor has to trigger the SelectionListener to update it's current selection.Reproducible: AlwaysSteps to Reproduce:1. Use a AbstractHandler's execute() method implementation2. Use HandlerUtil.getCurrentSelection(ExecutionEvent):ISelection to get a TextSelection instance.3. The selection offset of a document in a TextEditor is not up-to-date, if just the cursor changes from a zero-length selection to another zero-length selection. E.g.: Changing the cursor in a TextEditor's IDocument from offset 123, length 0 to offset 345, length 0.This is definitely a bug and should be fixed in future versions. I have a workaround for this:Assuming to have a command, context menu and handler in the same plug-in, I could use the following code in my handler:MyEditor myEditor = (MyEditor) PlatformUI.getWorkbench().getActiveWorkbenchWindow().getPartService().getActivePart();int cursorOffset = myEditor.getCursorOffset(); // own method// then using method getCursorOffset() in myEditor with the following code:return getSourceViewer().getTextWidget().getCaretOffset();// finally, I have to check, if the caret offset is in the range, reported by HandlerUtil.getCurrentSelection(). If not, the selection is made up of a zero length selection with the caret offset, which I got through my workaround.	This is not a bug but works as designed. Caret movements (and typing) is not reported via selection changed listeners but only through the post-selection changed listeners.As I can see so far, I'm not able to get the PostSelection from the ExecutionEvent via the HandlerUtil in a Handler. So, I'm not able to get a caret movement via the HandlerUtil from another plug-in.I may get the IEditorPart from the HandlerUtil, cast it and then get the caret position from a self-implemented method. If this is the accurate way, this bug can be closed.But, if I have an AbstractHandler implementation in another plug-in, I probably cannot get the caret position, as long as I don't have a dependency on the other plug-in.Sorry Andreas, I misinterpreted your bug as it landed in the Text inbox.One can either see the bug in the implementation of the HandlerUtil.getCurrentSelection() or in how the handler service updates the ACTIVE_CURRENT_SELECTION_NAME variable.The easiest workaround for you is to get the selection directly from the active part's selection provider. That information is up-to-date and not depending on the listener notifications.	3.0
id=372941	REOPENED	Platform	UI	4.2	PC Mac OS X	P3 normal	Platform-UI-Inbox	2012-03-01 02:39 EST by	Sven Efftinge	2016-09-19 13:32 EDT (	28 users	During debugging Java code the focus gets lost from time to time (quite often) such that F5, F6, F7, etc. don't work anymore. I'll have to manually click into the editor again to get the focus again.It seems to happen when stepping into a different editor, which is already opened.	I don't think I've seen this on Windows before. Perhaps it's related tothough?This problem also happens with bndtools. After you add a bundle, cmd-S will not do a save until you click on a list to give it focus.(In reply to)I don't seem to have this problem. However, I'm not testing this on a Mac.It's reproducible on my machine and is quite annoying.Do you have someone with a mac on your team or do you need someone to do the debugging?If you need help with this give me a starting point, please.(In reply to)You mean you also get the Ctrl+S problem with bndtools?No, I meant focus lost during debuggingWe debugged and found that the focus went to Toolbar.java.lang.Exception: Stack trace at java.lang.Thread.dumpStack(Thread.java:1273) at org.eclipse.e4.ui.bindings.keys.KeyBindingDispatcher$KeyDownFilter$1.handleEvent(KeyBindingDispatcher.java:92) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Display.filterEvent(Display.java:1068) at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4129) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1457) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1480) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1461) at org.eclipse.swt.widgets.Control.sendFocusEvent(Control.java:3291) at org.eclipse.swt.widgets.Display.checkFocus(Display.java:645) at org.eclipse.swt.widgets.Shell.makeFirstResponder(Shell.java:1234) at org.eclipse.swt.widgets.Display.windowProc(Display.java:5572) at org.eclipse.swt.internal.cocoa.OS.objc_msgSend_bool(Native Method) at org.eclipse.swt.internal.cocoa.NSWindow.makeFirstResponder(NSWindow.java:194) at org.eclipse.swt.widgets.ToolItem.setFocus(ToolItem.java:1023) at org.eclipse.swt.widgets.ToolBar.forceFocus(ToolBar.java:358) at org.eclipse.swt.widgets.Control.forceFocus(Control.java:1425) at org.eclipse.swt.widgets.Control.setFocus(Control.java:3710) at org.eclipse.swt.widgets.Composite.setFocus(Composite.java:1032) at org.eclipse.swt.widgets.Composite.setFocus(Composite.java:1030) at org.eclipse.swt.widgets.Control.fixFocus(Control.java:1351) at org.eclipse.swt.widgets.Control.setVisible(Control.java:4207) at org.eclipse.e4.ui.widgets.CTabItem.setControl(CTabItem.java:287) at org.eclipse.e4.ui.workbench.renderers.swt.StackRenderer.createTab(StackRenderer.java:686) at org.eclipse.e4.ui.workbench.renderers.swt.StackRenderer.childRendered(StackRenderer.java:736) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.safeCreateGui(PartRenderingEngine.java:581) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.safeCreateGui(PartRenderingEngine.java:718) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.access$2(PartRenderingEngine.java:689) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$7.run(PartRenderingEngine.java:683) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.createGui(PartRenderingEngine.java:668) at org.eclipse.e4.ui.internal.workbench.PartServiceImpl.createElement(PartServiceImpl.java:1004) at org.eclipse.e4.ui.internal.workbench.PartServiceImpl.delegateBringToTop(PartServiceImpl.java:579) at org.eclipse.e4.ui.internal.workbench.PartServiceImpl.bringToTop(PartServiceImpl.java:314) at org.eclipse.ui.internal.WorkbenchPage.bringToTop(WorkbenchPage.java:727) at org.eclipse.debug.internal.ui.sourcelookup.SourceLookupFacility.openEditor(SourceLookupFacility.java:270) at org.eclipse.debug.internal.ui.sourcelookup.SourceLookupFacility.display(SourceLookupFacility.java:219) at org.eclipse.debug.ui.DebugUITools.displaySource(DebugUITools.java:994) at org.eclipse.debug.internal.ui.elements.adapters.StackFrameSourceDisplayAdapter$SourceDisplayJob.runInUIThread(StackFrameSourceDisplayAdapter.java:157) at org.eclipse.ui.progress.UIJob$1.run(UIJob.java:95) at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35) at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135) at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3940) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3617) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1015) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:909) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:85) at org.eclipse.ui.internal.Workbench$4.run(Workbench.java:580) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:535) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:353) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:180) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:597) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:629) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:584) at org.eclipse.equinox.launcher.Main.run(Main.java:1438) at org.eclipse.equinox.launcher.Main.main(Main.java:1414)CreatedStackRenderer patch v1This patch should fix the problem. Not 100% sure I'm comfortable with this though.Neil, I think this is the same bug that you're seeing. Try the patch and see if it fixes your problem.(In reply to)With Igor's help I've been able to confirm that the problem goes away with this patch. I feel that this is a problem with SWT though.(In reply to)Thanks Remy, I've tested that patch and can confirm that it fixes the focus issues I was having.***has been marked as a duplicate of this bug. ***I've also noticed that focus is lost when interacting with the OSGi console. If you enter a command like "ss" and hit return, you have to click on the Console view before you can type another command. Would this problem be the same, or a new bugzilla?(In reply to)Bryan, sounds the same to me. Also if you're unlucky the focus will traverse to the Stop button on the view toolbar, and your next keystroke kills the runtime. I thought my app was crashing ;-)Pushed Remy's fix, Bogdan is aware of the SWT issue involved here...commit bcbd4357507d02c8990d425a0363cb0d2b316676I'm still experiencing this problem with the Juno build (official download).Me too. Still experiencing this problem with the official Juno build on OSX.(In reply to)Which problem? Is it that you have to hit a debugger key twice to continue?PW(In reply to)Hitting twice doesn't help. First I have to change focus to any of editor windows (i.e. click on edit window and then press debugger's key)I see this happening quite a lot. Workaround is to enable the Debug view's "Show Debug Toolbar".I can confirm that I also still see the issue.(In reply to)Thx for the workaround. Unfortunately, it helps sometime, but in many case I still loose the focus and have to click edit window to make debugging keys available***has been marked as a duplicate of this bug. ***I'm seeing this on 4.2.1 on 10.7.4 as well. The "Show Debug Toolbar" does definitely help.I'm seeing this on 4.2.1 as well even though I have switched on the Debug toolbar (MacBook, Mountain Lion 10.8.2). This problem is really annoying, as it breaks the flow because I have to take my hands off the keyboard. This also happens sometimes with other views or editors, but usually after opening a new file, i.e. when debugging into some class which is not yet open in an editor. Also always happens when switching from Java to Debug perspective.Actually, "Show Debug Toolbar" seems to only sporadically help. It does seem to be the "have to hit it twice" problem since I can hit it more than twice and nothing happens. As others have stated, this is amazingly painful - especially since its so random.Sorry guys, can't move to Juno because of that. Stay with indigo for a while...(In reply to)Is this problem in 3.8.X also, or it only in e4/4.2.X?(In reply to)Indigo Service Release 2 on mac os works just fine without loosing the focus during the debug with keyboard.(In reply to)Indigo is 3.7, 3.8 is released fromPW(In reply to)I still have this problem on a Mac/OSX laptop with eclipse 4.3 (latest stream build + e4 tools + web page editor)This has appeared on my 'hit list'...I know that I've hit it during my debugging but I have a question...Does everybody experience this only when the editor is maximized or does it happen when there are no minimized stacks ?The cut and paste stops working, and eventually the search/file... stops bringing up a dialog. A quick fix for the cut and paste is to change the perspective, but eventually that does not resurrect the shortcuts. Once the search dialog goes, restart is the only fix.I pulled down a fresh install of the latest integration build over the weekend, and only had the debug and java perspectives active; Still a problem.Every once in a while I see that the text that I was typing was input inside a .java editor on another not-visible perspective. It seems an editor is continuing to capture (but not always consume) events after it looses focus, and every time it regains focus, a new callback is created, resulting in a resource leak.@Eric Minimizing and/or Maximizing does not factor in on my end. Just switching between two perspectives (Debug and Java)It happens for me simply staying in the Debug perspective, without anything maximized. I'll just be doing Step-Over/Step-Into, and all of the sudden those buttons don't work anymore unless I click in the text editor.I see the problem without maximizing (with 4.2.1). I do have views dragged into external windows.I can get it to work again by clicking in the editor or the debug stack.I've just committed some changes forthat *may* help here, especially in cases where the debugger was bringing an existing editor to the top at the stack changed. I'd appreciate it if someone could check whether this has helped (or not..;-).Does anybody have any specific steps (guesses?) as to how to get this problem to manifest ??I have been debugging GWT code lately, and noticing unresponsive keyboard shortcuts, especially in cases when I have EventPreview listeners on keyboard events in my GWT code.I don't know if this is the same problem, but on both 4.2 and 4.3 I whenever I hit a breakpoint in the debugger the stack trace window has a huge amount of white space above where the breakpoint was, and then when I scroll back up to the top of the stack trace window, it seems to fix itself. This has happened on both Windows and the Mac pretty consistently and makes it almost unusable.CreatedScreen shot of problem in debugger with 4.3 I20130605-2000If this is not the same issue I can file another bug report for this.(In reply to)This looks. We have never been able to reproduce the problem locally, so if it is happening to you consistently can you enable the tracing options:org.eclipse.debug.ui/debug = trueorg.eclipse.debug.ui/debug/viewers/deltas = trueorg.eclipse.debug.ui/debug/viewers/contentProvider = trueorg.eclipse.debug.ui/debug/viewers/updateSequence = trueorg.eclipse.debug.ui/debug/viewers/stateSaveRestore = trueorg.eclipse.debug.ui/debug/viewers/presentationId=org.eclipse.debug.ui.DebugViewand add the tracing to?Seefor another focus lost issue (with steps).	42.0
id=376514	REOPENED	Platform	UI	4.2	PC Linux	P3 minor	Platform-UI-Inbox	2012-04-11 13:45 EDT by	Marc Khouzam	2012-06-06 09:08 EDT (	1 user	After disabling the global debug toolbar through the 'Debug' action set, clicking around will make it reappear.I'm using 4.2M6 but I've also seen it with 4.2 I20120321-0610.This happens with or without CDT.I've also tried it with the latest git code of the two platform debug plugins and the problem is there.This does not happen with 3.8.1- go to the debug perspective2- Customize the perspective to disable the action set called 'Debug'.-> the global debug toolbar disappears as expected3- select any view (e.g., variables view)4- select the debug view=> global debug toolbar reappears.Maybe this bug should go to Platform/UI for 4.2, but I wanted to get the opinion of the debug experts first.	It's not a bug, it's a feature! ;-)The debug action set is linked to the Debug view such that when the latter is activated so it the former. You can still hide individual toolbar and menu actions from the Customize Perspectives dialog.(In reply to)I started to doubt myself after I wrote this because I couldn't find the extension point that links the view to the actions set. It turns out that it's hard-coded into LaunchView.partVisible(). If you manually turn off the action set, then workbench should respect that and not re-enable it again. If this mechanism doesn't work then it could be a regression in UI in 4.2.(In reply to)And since the behavior is different between 4.2 and 3.8, it sounds like a regression.I'll re-open and move to platform UI.Moving to platform UI.Minor bug that causes an action set disablement not be respected with 4.2.Still happening with 4.2RC3. Still minor though.	5.0
id=380233	REOPENED	Platform	UI	4.2	All All	P3 normal	Platform-UI-Inbox	2012-05-22 05:59 EDT by	Robert Munteanu	2016-10-03 03:27 EDT (	15 users	I've recently upgraded to Eclipse 4. 2 and right-clicking on the buttons from the toolbar no longer brings up the context menu which allowed me to customize the perspective. Right-clicking in other places in Eclipse works and I can customize the perspective using Window -> Customize perspective.Using OpenSUSE 12.1 x86_64, Gnome 3.2 , GTK 2.20 .Eclipse Java EE IDE for Web Developers.Version: Juno ReleaseBuild id: 20120510-1218	Same story for me, but I observed the bug on both Mac OS X 10.7.3 and Windows XP.Same for me. I've noticed that I can go to Window->Customize Perspective... though, however under Command Groups Availability the Toolbar and Menubar details are not displayed.Also, even if I disable the Debug icons, they reappear (I don't want my debug icons up there :) )Eclipse Platform 4.2.0 under Windows 7 64-bitSame platform here, Win7x64 with Juno. The toolbar is twice the height it was in Indigo, mostly because the toolbar and the search/perspecitives combo aren't on the same row. I really don't think this was a "feature" - pretty sure it is a bug.***has been marked as a duplicate of this bug. ***Fix is trivial, patch follows.New Gerrit change created:Gerrit changewas merged to [master].Commit:Very nice solution. Thanks Andrey.Verified in I20150318-2000This bug is not fixed. The request was to have a context menu on tool bar items like in 3.x. The context menu entry on the perspective switcher is too hard to find for the casual user.Not sure if someone plans to work on this for M7, removing target.New Gerrit change created:Gerrit changewas merged to [R4_4_maintenance].Commit:I have no idea how to put a right context menu on arbitrary toolbar items.The Toolbar renderer class can be used for that but we need to ensure not to implement that for RCP applications.Any news on this?We currently do not plan to offer that. You can use the Customize Perspective command for that. This can be accessed via Quick Access therefore you and reach it very fast.@Lars This wasn't a feature request, this was a bug! Saying "We currently do not plan to offer that" makes no sense in this context.I strongly recommend reopening this ticket and actually fixing this regression bug.Platform behavior at least on Windows and Mac is that commands to customize a UI object are in the context menu. Quick Access is not a replacement for the normal interaction patterns.Can this be considered for reopening? It is quite natural to right-click to remove toolbar items, as seen in many other programs. Also, this used to work in Eclipse 3.x so this is a regression.It's OK if current Platform UI committers do not want to commit to doing it but at least it would be good to know if such contribution would be welcomed. In that case, the bug could be reopened and tagged with Help wanted.(In reply to Marc-Andre Laperle from)Patches are definitely welcome	21.0
id=388097	REOPENED	Platform	IDE	4.3	PC Windows 7	P3 normal	Platform-UI-Inbox	2012-08-27 07:57 EDT by	Asgeir Storesund Nilsen	2012-09-27 05:21 EDT (	2 users	Createdlog fileDownloaded Juno Java package. It starts up nicely on a clean workspace, but crashes on startup if I point it to my pre-existing Indigo workspace.I have tried closing all other perspectives and resetting the perspective in Indigo, but Juno still doesn't load it.Is this supposed to work?If not, is there an easy way to import all projects from the previous workspace?	One thing you can try is to rename <workspace>/.metadata/.plugins/org.eclipse.e4.workbench/workbench.xmi to a backup name after shutting down eclipse.Then restart it on your indigo workspace.PWThank you very much -- that worked just fine!I think this is supposed to work, out of the box, though, and removing workbench.xmi was just a work around? Asgeir, perhaps if you can attach your old workbench.xmi and re-open maybe someone could look at it some day, especially if you we get lots of reports, it'd be nice to "accumulate" data. Of course, if you know you had some special case, where you'd been "experimenting" or something with some rare procedure or odd migration steps, then probably not that helpful to anyone. But glad you got going. Thanks for reporting.CreatedWorkbench XMI from IndigoReopened and added workbench.xml from the Indigo installation.	5.0
id=380854	REOPENED	Platform	UI	4.2	PC Windows Vista	P3 normal	Platform-UI-Inbox	2012-05-29 01:43 EDT by	Bevan Thistlethwaite	2012-06-01 18:37 EDT (	1 user	Build Identifier: M20120208-0800Duplication of the symptoms of the problem is easy as it occurs right out of the box after a clean install.1) Start up eclipse in a new workspace;2) Open Error Log view;3) Restart eclipse (File|Restart)Eclipse log contains the following information:!SESSION 2012-05-27 14:20:39.690 -----------------------------------------------eclipse.buildId=2.9.2.201205071000-RELEASEjava.version=1.6.0_27-eajava.vendor=Sun Microsystems Inc.BootLoader constants: OS=win32, ARCH=x86, WS=win32, NL=en_USFramework arguments: -product com.springsource.sts.ideCommand-line arguments: -data C:\Users\tetje\workspace-sts-2.9.2.RELEASE-e3.7.2 -os win32 -ws win32 -arch x86 -product com.springsource.sts.ide!ENTRY org.eclipse.core.jobs 2 2 2012-05-27 14:22:14.986!MESSAGE Job found still running after platform shutdown. Jobs should be canceled by the plugin that scheduled them during shutdown: com.springsource.sts.roo.core.RooCoreActivator$1!SESSION 2012-05-27 14:22:17.031 -----------------------------------------------eclipse.buildId=2.9.2.201205071000-RELEASEjava.version=1.6.0_27-eajava.vendor=Sun Microsystems Inc.BootLoader constants: OS=win32, ARCH=x86, WS=win32, NL=en_USFramework arguments: -product com.springsource.sts.ideCommand-line arguments: -data C:\Users\tetje\workspace-sts-2.9.2.RELEASE-e3.7.2 -os win32 -ws win32 -arch x86 -product com.springsource.sts.ide!ENTRY org.eclipse.ui 4 4 2012-05-27 14:22:32.154!MESSAGE Could not create view: 'org.eclipse.ui.internal.introview'.!ENTRY org.eclipse.ui 4 0 2012-05-27 14:22:39.651!MESSAGE Problems occurred restoring workbench.!SUBENTRY 1 unknown 0 0 2012-05-27 14:22:39.651!MESSAGE OK!SUBENTRY 1 unknown 0 0 2012-05-27 14:22:39.651!MESSAGE OK!SUBENTRY 1 unknown 0 0 2012-05-27 14:22:39.651!MESSAGE OK!SUBENTRY 1 unknown 0 0 2012-05-27 14:22:39.651!MESSAGE OK!SUBENTRY 1 org.eclipse.ui 4 0 2012-05-27 14:22:39.651!MESSAGE Unable to restore perspective: Workspace - Spring.!SUBENTRY 2 org.eclipse.ui 0 0 2012-05-27 14:22:39.651!MESSAGE Problems occurred restoring perspective.!SUBENTRY 3 org.eclipse.ui 0 0 2012-05-27 14:22:39.651!MESSAGE !SUBENTRY 2 unknown 0 0 2012-05-27 14:22:39.651!MESSAGE OK!SUBENTRY 2 unknown 0 0 2012-05-27 14:22:39.651!MESSAGE OK!SUBENTRY 2 unknown 0 0 2012-05-27 14:22:39.651!MESSAGE OK!SUBENTRY 2 unknown 0 0 2012-05-27 14:22:39.651!MESSAGE OK!SUBENTRY 2 unknown 0 0 2012-05-27 14:22:39.651!MESSAGE OK!SUBENTRY 2 unknown 0 0 2012-05-27 14:22:39.651!MESSAGE OK!SUBENTRY 2 unknown 0 0 2012-05-27 14:22:39.651!MESSAGE OK!SUBENTRY 2 unknown 0 0 2012-05-27 14:22:39.652!MESSAGE OK!SUBENTRY 2 unknown 0 0 2012-05-27 14:22:39.652!MESSAGE OK!SUBENTRY 2 unknown 0 0 2012-05-27 14:22:39.652!MESSAGE OK!SUBENTRY 2 org.eclipse.ui 4 0 2012-05-27 14:22:39.652!MESSAGE Could not find view: org.eclipse.ui.internal.introview!SUBENTRY 1 unknown 0 0 2012-05-27 14:22:39.652!MESSAGE OKHere are the references to org.eclipse.ui.internal.introview in the code:..>grep -r "introview" /cygdrive/c/Users/tetje/eclipse-classic-3.7.2-source/cygdrive/c/Users/tetje/eclipse-classic-3.7.2-source/src/plugins/org.eclipse.ui/plugin.xml: id="org.eclipse.ui.internal.introview">/cygdrive/c/Users/tetje/eclipse-classic-3.7.2-source/src/plugins/org.eclipse.ui/plugin.xml: id="org.eclipse.ui.internal.introview">/cygdrive/c/Users/tetje/eclipse-classic-3.7.2-source/src/plugins/org.eclipse.ui.workbench/Eclipse UI/org/eclipse/ui/internal/intro/IIntroConstants.java: public static final String INTRO_VIEW_ID = "org.eclipse.ui.internal.introview"; //$NON-NLS-1$/cygdrive/c/Users/tetje/eclipse-classic-3.7.2-source/src/plugins/org.eclipse.ui.workbench/Eclipse UI/org/eclipse/ui/internal/Perspective.java: if (ref.getId().equals("org.eclipse.ui.internal.introview")) { //$NON-NLS-1$..>grep -r "INTRO_VIEW_ID" /cygdrive/c/Users/tetje/eclipse-classic-3.7.2-source/cygdrive/c/Users/tetje/eclipse-classic-3.7.2-source/src/plugins/org.eclipse.ui.workbench/Eclipse UI/org/eclipse/ui/internal/dialogs/CustomizePerspectiveDialog.java: if (view.getId().equals(IIntroConstants.INTRO_VIEW_ID)) {/cygdrive/c/Users/tetje/eclipse-classic-3.7.2-source/src/plugins/org.eclipse.ui.workbench/Eclipse UI/org/eclipse/ui/internal/dialogs/ViewContentProvider.java: if (view.getId().equals(IIntroConstants.INTRO_VIEW_ID)) {/cygdrive/c/Users/tetje/eclipse-classic-3.7.2-source/src/plugins/org.eclipse.ui.workbench/Eclipse UI/org/eclipse/ui/internal/intro/IIntroConstants.java: public static final String INTRO_VIEW_ID = "org.eclipse.ui.internal.introview"; //$NON-NLS-1$/cygdrive/c/Users/tetje/eclipse-classic-3.7.2-source/src/plugins/org.eclipse.ui.workbench/Eclipse UI/org/eclipse/ui/internal/PartStack.java: if (vp.getID().equals(IIntroConstants.INTRO_VIEW_ID))/cygdrive/c/Users/tetje/eclipse-classic-3.7.2-source/src/plugins/org.eclipse.ui.workbench/Eclipse UI/org/eclipse/ui/internal/Perspective.java: if (id.equals(IIntroConstants.INTRO_VIEW_ID)) {/cygdrive/c/Users/tetje/eclipse-classic-3.7.2-source/src/plugins/org.eclipse.ui.workbench/Eclipse UI/org/eclipse/ui/internal/Perspective.java: if (id.equals(IIntroConstants.INTRO_VIEW_ID)) {/cygdrive/c/Users/tetje/eclipse-classic-3.7.2-source/src/plugins/org.eclipse.ui.workbench/Eclipse UI/org/eclipse/ui/internal/Perspective.java: if (id.equals(IIntroConstants.INTRO_VIEW_ID)) {/cygdrive/c/Users/tetje/eclipse-classic-3.7.2-source/src/plugins/org.eclipse.ui.workbench/Eclipse UI/org/eclipse/ui/internal/ShowViewMenu.java: if (id.a.equals(IIntroConstants.INTRO_VIEW_ID)) {/cygdrive/c/Users/tetje/eclipse-classic-3.7.2-source/src/plugins/org.eclipse.ui.workbench/Eclipse UI/org/eclipse/ui/internal/WorkbenchIntroManager.java: .findViewReference(IIntroConstants.INTRO_VIEW_ID);/cygdrive/c/Users/tetje/eclipse-classic-3.7.2-source/src/plugins/org.eclipse.ui.workbench/Eclipse UI/org/eclipse/ui/internal/WorkbenchIntroManager.java: page.showView(IIntroConstants.INTRO_VIEW_ID);/cygdrive/c/Users/tetje/eclipse-classic-3.7.2-source/src/plugins/org.eclipse.ui.workbench/Eclipse UI/org/eclipse/ui/internal/WorkbenchIntroManager.java: workbenchPage.showView(IIntroConstants.INTRO_VIEW_ID);/cygdrive/c/Users/tetje/eclipse-classic-3.7.2-source/src/plugins/org.eclipse.ui.workbench/Eclipse UI/org/eclipse/ui/internal/WorkbenchIntroManager.java: .findViewReference(IIntroConstants.INTRO_VIEW_ID);/cygdrive/c/Users/tetje/eclipse-classic-3.7.2-source/src/plugins/org.eclipse.ui.workbench/Eclipse UI/org/eclipse/ui/internal/WorkbenchIntroManager.java: .findView(IIntroConstants.INTRO_VIEW_ID);/cygdrive/c/Users/tetje/eclipse-classic-3.7.2-source/src/plugins/org.eclipse.ui.workbench/Eclipse UI/org/eclipse/ui/internal/WorkbenchLayoutSettingsTransfer.java: && activePage.findView(IIntroConstants.INTRO_VIEW_ID) != null) {/cygdrive/c/Users/tetje/eclipse-classic-3.7.2-source/src/plugins/org.eclipse.ui.workbench/Eclipse UI/org/eclipse/ui/internal/WorkbenchPage.java: showView(IIntroConstants.INTRO_VIEW_ID);/cygdrive/c/Users/tetje/eclipse-classic-3.7.2-source/src/plugins/org.eclipse.ui.workbench/Eclipse UI/org/eclipse/ui/internal/WorkbenchWindow.java: && activePage.findView(IIntroConstants.INTRO_VIEW_ID) != null) {Reproducible: AlwaysSteps to Reproduce:1) Start up eclipse in a new workspace;2) Open Error Log view;3) Restart eclipse (File|Restart)4) Observe garbage in Error Log view.	CreatedEclipse Error Log Window with spurious outputYou'll have to open a bug against whoever provided com.springsource.sts.ideI can't reproduce in eclipse-SDK-3.7.2-linux-gtk-x86_64.tar.gzPWPaul,Did you do a fresh install as I downloaded a fresh eclipse-SDK-3.7.2-linux-gtk.tar.gz release on Ubuntu and obtained similar results there (please see the attached screenshot). I also obtained similar results with eclipse-jee-indigo-SR2-linux-gtk.tar.gzCreatedScreenshot of Eclipse Error Log for eclipse-SDK-3.7.2-linux-gtk.tar.gzI followed your instructions fromand when I restart, it just comes up with no errors.Were you using a distro version of eclipse before? What if you move your $HOME/.eclipse to $HOME/.eclipse_bak so you are starting fresh.PWHi Paul,I've done this with different releases on different machines an OS's and get the same result as follows on Windows:1) Eclipse Classic 3.7.22) Eclipse JEE Helios3) Eclipse JEE Helios SR24) Eclipse JEE Indigo SR25) Eclipse JEE Juno M66) Springsource 2.9.1 RELEASE7) Springsource 2.9.1 RELEASE E3.68) Springsource 2.9.2 RELEASE E3.7.2I tried to find the class org.eclipse.ui.internal.introview in the current source archive without any luck, although the references persist.Please see:which seems to indicate that the problem has persisted in different forms since 2006.I notice that you're using the 64-bit version and wonder whether the source archive is the same in both cases...(In reply to)Please unzip this in c:\eclipse372. Then fire it up using c:\eclipse372\eclipse\eclipse.exeRun your experiment, and then please attach the .log file (as text/plain)PW(In reply to)That should be Run your experiment in a clean, new workspace PWCreatedC:\eclipse372\eclipse\eclipse.exe .log filePaul,Here's the .log file for C:\eclipse372\eclipse\eclipse.exe(In reply to)Which workspace did you use?PWA new workspace: C:\Users\tetje\workspace-zzz(In reply to)What's the file and size of the 3.7.2 zip you unzipped?PWeclipse-SDK-3.7.2-win32.zip 178,879K(In reply to)eclipse-SDK-3.7.2-win32.zip 183171707PWThat's 1024-byte blocks.Using ls, it is 183171707 bytes as you indicate.CreatedHere's my ErrorLog on a fresh open using M20120127-0800I get neither errors nor warnings when I installed M20120127-0800 and opened it on a fresh workspace...Eric,Did you try an instant restart immediately after and check the error log again?The problem is still outstanding and can be demonstrated on both Windows Vista and Ubuntu using numerous versions of Eclipse-32 as specified in the log.We just can't reproduce it here. On windows and linux. A clean download of eclipse-SDK-3.7.2-win32.zip and eclipse-SDK-3.7.2-linux-gtk-x86_64.tar.gzWe'll try again tomorrow.PWPaul,I've performed the same test using eclipse-SDK-3.7.2-win32.zip on another machine using Windows XP and I get the same result.Do you think environment settings might influence the result, or alternatively, the flavour of Java?In addition, in the information I first presented, I provided a "grep" of the source archive eclipse-sourceBuild-srcIncluded-3.7.2.zip where I indentified all occurrences of "org.eclipse.ui.internal.introview" in the source, but couldn't identify that class there. Please review that to see if I've missed anything.(In reply to)When you created this .log file, there wasn't anything in eclipse for your first run, only the restart?Inwhen how do you do step #2? What happens to the welcome screen when you do? Even if I leave the welcome screen open in my fresh workspace and just open the error log view (it unmaximizes the intro view and puts it at the side) I can't reproduce the problem with Eclipse classic 3.7.2.PW(In reply to)One possibility would be for you to get a new JVM (the lastet 1.7 maybe) and try launching your eclipse in a clean workspace with:eclipsec.exe -vm "c:\path\to\jdk1.7\bin\java.exe"See if that makes a difference. The other potential environmental impact could be what web browsers you have installed in your system, as that's what renders the intro view.PWJAVA7 solved the problem...I rescind that last statement: Java7 didn't solve the problem just reduced the frequency of the occurrence.On Eclipse 3.7.2, I have run through permutations of jdk1.7.0 and jdk1.6.0_27 and alternating between an internal and external browser and have come to the conclusion that there is a timing issue involved, which my relatively slower laptop keeps picking up.If I delete the error log and restart again, the problem does not seem to recur, which supports the conclusion that there is a timing problem somewhere.It does not seem to still be a problem in Juno M6.However I am still required to use 3.7.2 for springsource-tool-suite-2.9.2.RELEASE-e3.7.2-win32 so a solution.It looks the practical solution will be to delete the error log on startup and pretend it didn't happen...	24.0
id=389255	REOPENED	Platform	IDE	4.3	PC Linux	P3 normal	Platform-UI-Inbox	2012-09-11 09:25 EDT by	Jamie Strachan	2014-04-11 04:23 EDT (	8 users	Whenever I start Eclipse, the Debug perspective is not configured as I saved it.1. Start eclipse2. Open debug perspective3. Note that there are buttons there that I previously removed4. Open "Customize Perpective"Note that the visible buttons on the perspective do NOT match what is shown in the "Customize Perspective" dialogNote that if at this point I save without modification, the Debug perspective is not changed, still shows unwanted buttons5. Make a change and save -> Debug perspective is updated to remove unwanted buttons6. Select "Save Perspective As..." and save it as Debug, select Yes to overrideIf, at this point I close and reopen the Debug perspective, it looks correct7. Exit eclipse8. Goto 1.I did see, but that bug does not use the "Save Perspective As" function, whereas this one does.	Oops, this also affects me on WindowsI believe this was an issue because I used my old Helios workspace with Juno, rather than creating a new workspace.The problem was resolved by removing the .metadata folder, starting Juno, and then adding all my projects back in again.I thought I had fixed the problem by recreating my workspace, but today the problem has returned, with my new workspace.See also.I have the same problems in the debug perspective running Juno SR1 on Fedora 14, both with saved changes reverting to standard and with changes I make not taking effect.Today I also had the problem where everything was fine for many days and then suddenly it reverted to the default layout, and again my changes wouldn't take effect. I got it to work by first resetting the layout and then making my changes.***has been marked as a duplicate of this bug. ***I have the same behavior as mentioned in the original comment, with Eclipse Kepler RC1 on Windows.Some items (notably from the Clearcase plugin; yes, I HAVE to use that...) appear in the view. In the customize dialog, they are also listed as active (even though not all of them are actually shown in the toolbar), and deselecting does not remove them immediately. I have to switch between different perspectives for the changes to become active.I also saved my perspective configurations under other names (which I believed to maybe help with persisting the changes), and now the Clearcase perspective (of all things!) does NOT show the Clearcase items in the toolbar, and I cannot seem to get them shown.So overall, something seems to seriously not work at all with toolbar configuration in Kepler (3.8, which I used before, worked fine).	7.0
id=381010	REOPENED	Platform	UI	4.2	All All	P3 minor	Platform-UI-Inbox	2012-05-30 06:21 EDT by	Mark S.	2016-10-03 09:28 EDT (	14 users	Build Identifier: see, for example:That issue is still a very boring one because there is no configuration option in Eclipse to change tooltip colors.Reproducible: Always	+1 Gnome 3.6 was released just now, the default tooltip background color is dark. Especially links that are blue by default are impossible to read against the dark background. The default tooltip background color for eclipse should be white since some elements that are rendered inside the tooltip assume that it is and are unreadable otherwise.We use the OS settings. There are no plans to provide an option to override those. Most OSes offer to change the color. If your OS doesn't do this, then please request the feature there.Why is this a "wont fix" you can override the background color of the javadoc view, but not the font color?? I can hardly read the text, and I /don't/ want to change the tooltip text for the entire system.This is probably the most frequent dialog inside editor along content assist and it doesn't have bg/fg colour controls. This is a serious UX issue that is bothering majority of people out of the box on Linux side.Saying that OS should control tooltip windows (again most used thing in IDE) but at the same time provide colour controls inside IDE for everything else is really bad. People are wasting timeLars Vogel covered this atStack overflow has many variations of this like this one20K viewsCircus continues with migration between GTK2 and GTK3 as old fixes stopped workingCan someone please elaborate on what components need to be changed for this and unfreeze this ticket?Dusan, you are making good points. I think we should allow to configure the background color via CSS, as we do for the rest of the IDE.I reopen the ticket for this purpose. Patches are welcome.Added a few interested parties from.CreatedScreenshotCreatedContent AssistsAs far as the ToolTip widget is concerned on GTK: the background is set at creation to SWT.COLOR_INFO_BACKGROUND. AFAICT there is no background API for ToolTips since it's a child of Widget, not Control. This makes sense to me as SWT tooltips should look consistent depending on the OS colors.(In reply to Em Recio from)The Javadocs view is *not* an SWT ToolTip. It is a Browser with restricted size and displays HTML content. At best it could be considered a "popup", but in reality it's a fully fledged widget that has been made to look like a ToolTip. Browsers have configurable background colors, ToolTips do not.As for the Javadocs view/popup/hover, there are plans to allow for full background/foreground color configuration (see bug 5001960). However that discussion doesn't have anything to do with this bug, IMO.(In reply to)Thank you for adding me to this relevant bug.I'm in the process of fixing javadoc in. Should look nice after fix:White:Black:But there are indeed elements of Eclipse that will still look a bit broken even with Javadoc fix. Ex heap status.It is odd that this should pop up because i just came across this again with another eclipse based app from IBM. This is a major fail from the swt toolkit.(In reply to)Yea, unfortunately active Gtk3.0+ development broke a lot of stuff at a quick paste and fixing things took quite a while. But contributions are always welcome =).I'll aim to backport the Javadoc changes once all the patches were merged into master and verified to work well, hopefully that should make the UI more readable.Also, I've introduced a colorFactory in, which could be re-used for a bunch of black/white color related issues, which should hopefully make UI look nicer.	12.0
id=390403	REOPENED	Platform	UI	3.7	PC Windows XP	P3 normal	Platform-UI-Inbox	2012-09-26 01:43 EDT by	Kitesurfer ()	2012-09-27 10:49 EDT (	1 user	I have a plugin which assigns a function to functionkey F1. When I run the plugin and press the F1-key, the function is executed, but also the help-screen is shown.Also the Shift-F1 and Ctrl-F1 show this behaviour.PS. I'm using Eclipse Helios.	This isn't a bug, this is a problem with your setup. The use of commands isn't always easy, try looking into the tutorial here:For questions on how to get started, please try the forums (newcomers) or the IRC channels."This isn't a bug, this is a problem with your setup. The use of commands isn't always easy"I've implemented around 15 function-keys, all in the same way. Most of them work as expected. When there are no collisions, they directly execute the command. When there are collisions (more commands behind one key), then this yellow box pops up to select one of them, and the correct command is executed. As said, with the F1-key other behaviour is noticed: the command (of the plugin) is executed, but also the Help-window pops up. F1 must be deeply in Eclipse, as it's also not listed in "Preferences, Keys" to be the help-command.With Shift/Ctrl-F1: When I have a file open in Eclipse for edit, the command (of the plugin) is executed, but also the Help-window pops up.When I have a file open in Eclipse that's read-only (on disk), a yellow box also pops up saying: "Each workbench window contains one or more perspectives, which are made up of various views and editors." followed by three links to Workbench, Perspectives and 'Customizing the workbench".I can't imagine that all this is a problem with my setup.Another thing I notice is that I can't seem to get rid of collisions (more commands behind one key). The situations is that behind F12 there are two commands:- Activate Editor (which is of Eclipse itself)- MyCommand (which is of my plugin).When I press F12 the yellow box pops up to select one of them. So far no problem.I go to "Prefences, Keys" ... select the line where "Activate Editor" is binded to the F12-key, press the "Unbind command" button ... and the F12 dissapears in the line of "Activate Editor". The key is still visible in the line with "MyCommand". I then click the Apply-button, followed by the OK-button. When I then press F12 in my editor nothing happens. Both commands of the F12 key are unbinded. This is unexpected behaviour; a bug ? ... as when I left the "Prefences, keys" window the F12-key was still behind MyCommand.Thanks for you reply.I will reopen and move to Platform UI. However, there is not enough committer time on that component to look at this.I don't know how F1 is bound to the help system, it way be done in a OS specific way.	3.0
id=398351	REOPENED	Platform	UI	3.6.2	PC Windows 7	P3 normal	Platform-UI-Inbox	2013-01-17 00:31 EST by	Kumaraswamy Gowda	2013-05-07 09:06 EDT (	1 user	Switching between tabs across different properties view caused null pointer exception.Steps to reproduce the issue----------------------------------- Highlight any element (in editor) so that its properties are displayed in the Properties View (In our case, we use palette elements for which we have tabbed properties view)-- Click on the "View Menu" and select "New Properties View".-- Now switch between different tabs under the "Properties View" (try it in original properties view as well as in New Properties View).-- This will throw "An error has occurred. See error log for more details. java.lang.NullPointerException" error. We won't be able to switch between Properties Views and will have to close Eclipse and re-open.Exception stack trace----------------------!ENTRY org.eclipse.ui.views.properties.tabbed 4 2 2013-01-17 10:50:58.851!MESSAGE Problems occurred when invoking code from plug-in: "org.eclipse.ui.views.properties.tabbed".!STACK 0java.lang.NullPointerException at com.ibm.rational.rpe.studio.views.properties.sections.RPEAbstractSection.setInput(RPEAbstractSection.java:331) at org.eclipse.ui.views.properties.tabbed.TabContents$5.run(TabContents.java:181) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.internal.JFaceUtil$1.run(JFaceUtil.java:49) at org.eclipse.jface.util.SafeRunnable.run(SafeRunnable.java:175) at org.eclipse.ui.views.properties.tabbed.TabContents.setInput(TabContents.java:184) at org.eclipse.ui.views.properties.tabbed.TabbedPropertySheetPage$SelectionChangedListener.selectionChanged(TabbedPropertySheetPage.java:212) at org.eclipse.jface.viewers.Viewer$2.run(Viewer.java:162) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.internal.JFaceUtil$1.run(JFaceUtil.java:49) at org.eclipse.jface.util.SafeRunnable.run(SafeRunnable.java:175) at org.eclipse.jface.viewers.Viewer.fireSelectionChanged(Viewer.java:160) at org.eclipse.jface.viewers.StructuredViewer.updateSelection(StructuredViewer.java:2162) at org.eclipse.jface.viewers.StructuredViewer.handleSelect(StructuredViewer.java:1190) at org.eclipse.jface.viewers.StructuredViewer$4.widgetSelected(StructuredViewer.java:1220) at org.eclipse.jface.util.OpenStrategy.fireSelectionEvent(OpenStrategy.java:228) at org.eclipse.jface.util.OpenStrategy.access$4(OpenStrategy.java:222) at org.eclipse.jface.util.OpenStrategy$1.handleEvent(OpenStrategy.java:389) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1077) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1062) at org.eclipse.swt.widgets.Widget.notifyListeners(Widget.java:774) at org.eclipse.ui.internal.views.properties.tabbed.view.TabbedPropertyList.select(TabbedPropertyList.java:664) at org.eclipse.ui.internal.views.properties.tabbed.view.TabbedPropertyList$2.mouseUp(TabbedPropertyList.java:156) at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:213) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053) at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4066) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3657) at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2640) at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2604) at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2438) at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:671) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:664) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149) at com.ibm.rational.rpe.studio.Application.start(Application.java:42) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:369) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:60) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37) at java.lang.reflect.Method.invoke(Method.java:611) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:620) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:575) at org.eclipse.equinox.launcher.Main.run(Main.java:1408) at org.eclipse.equinox.launcher.Main.main(Main.java:1384)	It's NPEing in RPEAbstractSection.setInput. You need to open a bug with the provider of com.ibm.rational.rpe.studioPWThe following method is from org.eclipse.ui.views.properties.tabbed.TabContents class.public void setInput(final IWorkbenchPart part, final ISelection selection) { for (int i = 0; i < sections.length; i++) { final ISection section = sections[i]; ISafeRunnable runnable = new SafeRunnable() { public void run() throws Exception { section.setInput(part, selection); // ####### watch this } }; SafeRunnable.run(runnable); }}RPEAbstractSection is extending AbstractPropertySection (implements ISection) and the parameters part and selection are null during section.setInput(part, selection) (check above method) method causing NPE.Please check stack trace in my previous comment/description.It NPEed in customer code ... please provide that code if you feel that the framework sent something in error.PWThe customer code ispublic void setInput(IWorkbenchPart part, ISelection selection){ @SuppressWarnings("unchecked") List<IStructuredSelection> selectionList = ((IStructuredSelection) selection).toList(); ListIterator<IStructuredSelection> iterator = selectionList.listIterator(); . .}Eclipse Platform UI code ispublic void setInput(final IWorkbenchPart part, final ISelection selection) { for (int i = 0; i < sections.length; i++) { final ISection section = sections[i]; ISafeRunnable runnable = new SafeRunnable() { public void run() throws Exception { section.setInput(part, selection); // ####### watch this } }; SafeRunnable.run(runnable); }}In the customer code, List<IStructuredSelection> selectionList = ((IStructuredSelection) selection).toList();is causing NPE since selection is null. "selection" is passed from Eclipse Platform UI code (TabContents.java).I can't reproduce it on 3.8. Can you?PWHi Paul,The product that I work (RPE) on is supported on Eclipse 3.6.2. I doubt the RPE product works on Eclipse 3.8 without any changes.If you have a sample code to test tabbed properties view, share it with me. I can test it on Eclipse 3.6.2 and 3.8 to see the behavior.Thanks,KumarCreatedtabbed property test build PSFYou can use this to import the tabbed property view tests (import Team Project Sets). Open one of the test views and you get multiple tabs in the properties view.You might have to switch to R3_6_maintenance from R4_2_maintenance if it doesn't compile in your workspace.PWHi Paul,I was a bit busy last week, hence could work on it.How do I see/test/use this psf file. Do I have to install egit eclipse plugin and then import the test case using the psf file? Is there any other way to get access to the test case code? bcoz, I'm having issue installing egit plugin on my eclipse.Thanks,Kumar(In reply to)If you can't install egit, you'll have to use git to checkout the repositories listed in the .psf (it's a text file) and then use File>Import...>Existing projects into workspace to load in the projects as listed in the PSFPWHi Paul,I was able to perform a junit plugin test for tabbed properties view. However, there are no tests for "New Properties View".How do I test this for "New Properties View"?Currently, we are on 3.6.2 and we will move to 4.2.x.Thanks,Kumar(In reply to)You can open a new properties view using IWorkbenchPage#showView(*) with the secondary ID.But you can modify the same tabbed properties view that are provided in the test plugin and reproduce the scenario manually, that would be good enough.PWHi Paul,One of my team member upgraded to Eclipse 4.2.x and the issue (NPE) is still happening.Thanks,Kumar(In reply to)Still waiting on a reproducible scenario.PW	13.0
id=401114	REOPENED	Platform	UI	4.3	PC Windows Vista	P3 normal	Platform-UI-Inbox	2013-02-18 13:53 EST by	Ed Willink	2017-02-17 14:30 EST (	8 users	M5: When debugging I was surprised to hit some of my breakpoints when cleaning up the workspace by closing some inactive editors. On investigation it seems that the active editor is re-activated causing a potentially buggy editor to do a lot of unnecessary work. Buggy or not, surely clicking on the close tab of an inactive, indeed never active, editor should do very little.	I set a breakpoint in the EPartService#showPart and it doesn't hit when I close another editor which is not the active one. Maybe I am misunderstanding what you mean with 're-activated'.Can you provide a bit more detail on where you set the breakpoints so that you think it's reactivated? I'm on I20130402-0800.Sorry. It has been fairly clear from the number of Bugzillas I've come across/reported involving 'activation' that this is a disaster area in e4, so as soon as I hit this area. I just sign, oh yet another one, and move on.I can only observe that showPart is not activate.I was encountering unexpected handleActivation or similar listener call back in an editor that misbehaved (not due to e4) and so revealed its redundant 're-activation'.I noticed, that when an Eclipse window is being activated, all the open editors have there respective Parts activated, even those that are not on top. I don't think that's right. The editor on top is activated last.Although I am not observing the editor being activated when it is being closed.Scenario:1. set up a breakpoint in AbstractTextEditor$ActivationListener.handleActivation2. in the debugging session, open two java files - top.java and bottom.java3. close the editor with bottom.java (inactive editor)The breakpoint is not hit.Ed, can you please let me know if this scenario is similar to yours, otherwise, can you clarify what your scenario is?(In reply to)I have seen so many problems with part activation that I've given up reporting them. There must be more than enough in existing Bugzillas for a proper analysis and design of how e4 will reproduce the distinct 3.x editor/view behaviour.Already fixed, putting a BP onto PartServiceImpl#activate does fire when you close a non-active editor...Verified in 4.4.0.I20131001-0800.(In reply to Eric Moffatt from)?? missing "not" ??This is not fixed and should be reopened. I don't think Eric understood the problem.To reiterate, consider two open editors, E1 and E2, in the same editor area.E2 is active.Click on the close button of E1.This action causes activation of E1 even though it will close subsequently under normal circumstances.The close prompts the reactivation of E2.These activations may cause the UI to convulse quite a bit, seemingly unnecessarily.This bug appears to be intractable.First we get the E1 activate event…PartServiceImpl.activate(MPart, boolean, boolean) line: 689 PartServiceImpl.activate(MPart, boolean) line: 620 DSStackRenderer(AbstractPartRenderer).activate(MPart) line: 106 StackRenderer$9.handleEvent(Event) line: 1013 EventTable.sendEvent(Event) line: 84 Display.sendEvent(EventTable, Event) line: 4353 CTabFolder(Widget).sendEvent(Event) line: 1061 CTabFolder(Widget).sendEvent(int, Event, boolean) line: 1085 CTabFolder(Widget).sendEvent(int, Event) line: 1070 Shell.setActiveControl(Control, int) line: 1453 Shell.WM_MOUSEACTIVATE(long, long) line: 2334 Shell(Control).windowProc(long, int, long, long) line: 4654 … long series of windowProc dispatching omitted CTabFolder(Control).windowProc(long, int, long, long) line: 4705 Display.windowProc(long, long, long, long) line: 5036 OS.PeekMessageW(MSG, long, int, int, int) line: not available [native method] OS.PeekMessage(MSG, long, int, int, int) line: 3141 [b]Display.readAndDispatch() line: 3756[/b] At this point the Display eventQueue is empty… and then the close …PartServiceImpl.savePart(MPart, boolean) line: 1333 DSStackRenderer(StackRenderer).closePart(Widget, boolean) line: 1217 StackRenderer.access$3(StackRenderer, Widget, boolean) line: 1200 StackRenderer$12.close(CTabFolderEvent) line: 1092 CTabFolder.onMouse(Event) line: 1874 Button press eventCTabFolder$1.handleEvent(Event) line: 288 EventTable.sendEvent(Event) line: 84 Display.sendEvent(EventTable, Event) line: 4353 CTabFolder(Widget).sendEvent(Event) line: 1061 Display.runDeferredEvents() line: 4172 [b]Display.readAndDispatch() line: 3761[/b] The activate event is processed fully before the button event that closes E1 is ever created and placed into the Display eventQueue…Display.postEvent(Event) line: 3710 Button press event added to eventQueueCTabFolder(Widget).sendEvent(int, Event, boolean) line: 1087 CTabFolder(Widget).postEvent(int, Event) line: 790 CTabFolder(Widget).sendMouseEvent(int, int, int, int, boolean, long, int, long, long) line: 1135 CTabFolder(Widget).wmLButtonDown(long, long, long) line: 2013 CTabFolder(Control).WM_LBUTTONDOWN(long, long) line: 4991 CTabFolder(Composite).WM_LBUTTONDOWN(long, long) line: 1372 CTabFolder(Control).windowProc(long, int, long, long) line: 4646 Display.windowProc(long, long, long, long) line: 5036 OS.DispatchMessageW(MSG) line: not available [native method] OS.DispatchMessage(MSG) line: 2549 [b]Display.readAndDispatch() line: 3759[/b]The only practical way to omit the activation would be for StackRenderer SWT.Activate listener $9.handleEvent to check CTabItem.closeRect.contains(event.x,event.y) and omit the activate invocation when it is true.Unfortunately, StackRenderer cannot access CTabItem.closeRect.contains(event.x,event.y)The best it can do is examine the CTabFolder or CTabItem toolTipText and check that it is equal to “Close” and infer it… Not an ideal solution and may not be very robust.Even if StackRenderer could omit the activation, how many applications count on the closing editor also being the active editor?It's worthy of mentioning that if the editors are in the same CTabFolder then there is no activation.To be consistent, either there should always be an activation before closing or the activation must never occur.I favor the latter. I would judge that Ed and most others do too.(In reply to darrel karisch from)Indeed though I wonder how this relates to the general maliase:A GIT branch change starts a rebuild for every project as it changes.Close all projects takes a really long time.Type hierarchy recomputes when invisible...There seems to be much too much reacting to a change without an overall ability to block up multiple changes as a single composite change that will complete before corrolaries occur.(In reply to darrel karisch from)This kludgy little modification to org.eclipse.e4.ui.workbench.renderers.swt.StackRenderer SWT.Activate listener prevents the activation invocation when a Close is imminent ... public void handleEvent(org.eclipse.swt.widgets.Event event) { if (event.detail == SWT.MouseDown) { CTabFolder ctf = (CTabFolder) event.widget; if (ctf.getSelection() == null || SWT.getMessage("SWT_Close").equals(ctf.getToolTipText())) { return; } // get the item under the cursor CTabItem overItem = ctf.getItem(event.display.map(null, ctf, event.display.getCursorLocation())); // If the item we're over is *not* the current one do // nothing (it'll get activated when the tab changes) if (overItem == null || overItem == ctf.getSelection()) { MUIElement uiElement = (MUIElement) ctf.getSelection().getData(OWNING_ME); if (uiElement instanceof MPlaceholder) { uiElement = ((MPlaceholder) uiElement).getRef(); } if (uiElement instanceof MPart) { activate((MPart) uiElement); } } } }(In reply to Ed Willink from)I'd guess that "Close All" causes PartServiceImpl::hidePart invocation at some point.PartServiceImpl::hidePart selects a sibling part when the input MPart is the selected element.The problem is that the CTabFolder has a mouseUp event still pending after the CTabFolder's close-event is fired. The mouseUp event treats the mouseUp as if it were a normal click on the CTabItem and sets focus to the CTabItem's control.(In reply to Brian de Alwis from)with org.eclipse.swt.win32.win32.x86_64_3.103.2.v20150203-1351.jar I do not see where CTabFolder MouseUp event handling sets focus on the CTabItem.The code I see only acts to close the CTabItem when the event occurs within its closeRect, i.e. item.closeRect.contains(x,y) is true.(In reply to darrel karisch from)My mistake. You are referring to StackRenderer. Its mouseUp behaves as you describe.(In reply to Brian de Alwis from)In this case, one of the remaining CTabItem control's is focused and activated. The result being that a new part is activated, rather than the original active part in another CTabFolder.Only the case where the CTabFolder has no other remaining tabs do we end up with the original part remaining active.Nevertheless, omitting the activation of the closing part is an improvement.	18.0
id=407318	REOPENED	Platform	Runtime	4.3	PC Windows 7	P3 normal	Platform-UI-Inbox	2013-05-06 12:42 EDT by	Jordan Dukadinov	2013-05-10 13:13 EDT (	3 users	Createdstack traceThe class org.eclipse.ui.internal.handlers.E4HandlerProxy throws s IllegalStateException: Workbench has not been created yet.The error happens in this line of the method handlerChanged(HandlerEvent e)IEclipseContext appContext = ((Workbench) PlatformUI.getWorkbench()).getApplication().getContext();In our pure E4 application, PlatformUI.getWorkbench() does not return a valid workbench.I attached the relevant stack trace. The exception prevents us to set an object to the eclipse context.	Createdstack traceYou can't use o.e.ui/.workbench objects without running the workbench.It seems to me that this is invalid.PWHi Paul, PlatformUI.getWorkbench() returns an object of the type org.eclipse.ui.IWorkbench which seems to me somehow 3.x specific.Is the usage of PlatformUI valid at all for a E4 application?(In reply to)No, an Eclipse4 application can't use org.eclipse.ui or o.e.ui.workbench at all.Only the org.eclipse.e4.ui* bundles.PWSince this is an E4 class we can't do much instead of copy it (what we did). We made two small changes to E4HandlerProxy make it work (see below).I reopen the bug, so you can eventually review and contribute the changes.instead of (replaced two times in the class):IEclipseContext appContext = ((Workbench) PlatformUI.getWorkbench()).getApplication().getContext();we use:IEclipseContext appContext = getWorkbenchContext();where:private IEclipseContext getWorkbenchContext() { final org.eclipse.e4.ui.internal.workbench.Activator plugin = org.eclipse.e4.ui.internal.workbench.Activator.getDefault(); if (plugin == null) { return null; } IEclipseContext serviceContext = EclipseContextFactory.getServiceContext(plugin.getContext()); return serviceContext.getActiveLeaf();}(In reply to)This can't be contributed back, as we don't use the service context as the root of lookups (we always use the MApplication context as root) and there's no gaurantee that EclipseContextFactory.getServiceContext(*) will return the service context that's the root of our MApplication context hierarchy.PW	6.0
id=400217	REOPENED	Platform	UI	4.3	PC Windows 7	P3 normal	Platform-UI-Inbox	2013-02-07 09:03 EST by	Dirk Fauth	2016-11-09 03:06 EST (	19 users	CreatedSmall project for visible state refresh not workingAs reported herecore expressions are not working on HandledToolItems or DirectToolItems.Even changing the visibility flag at runtime doesn't rerender the toolbar or menu bar correctly.I have extended and reattached the toolbar example I created to show this issue.If you start the app you will see the "Debug Menu" menu item for the main menu. It shouldn't be visible though, because the core expression evaluates false.If you select "Toggle Menu Item" in the "Item Test Menu" two things should apply.1. The item "Core Expression visible" should appear in the "Item Test Menu" - works2. An additional item should become visible in the toolbar of the part.Note that even setting the visible flag directly to that toolitem doesn't rerender correctly. This can be tested by clicking the visible toolitem in the example, which calls a command that changes the visible flag of the second toolitem.	Update:I tested this with M6 and it is still not working.I ensured that the HandlerProcessingAddon is added prior testing with M6, so this doesn't seem to be the issue.I face the same issue with eclipse 4.2but I have succeed to make it work by adding my HandledToolItems to a toolbox contribution. But when I add my items directly to the toolbox the core expression is not evaluated.I am facing the same problem with Eclipse 4.3.1.I think this is a dup ofHi,this ticket is closed and marked as fixed. But IMHO it is not fixed. I tried to test it with the Luna Release and the described issues still exist.Issue 1:The "Debug Menu" entry is visible in the main menu. But the core expression evaluates to false, so it shouldn't be visible.Issue 2:If you select "Toggle Menu Item" in the "Item Test Menu" two things should apply.1. The item "Core Expression visible" should appear in the "Item Test Menu"2. An additional item should become visible in the toolbar of the part.While 1. worked before, 2. still doesn't work. There is no item shown in the toolbar of the project.The issues still appear in the example app I attached. Is the example code wrong and does it need to be modified so the evaluation of core expressions are correctly handled?And now I even see a new issue. The toolitems in the part are never shown. Not even the one without a visibile-when expression.Is an addon missing?There is also no Target Milestone set. So I wonder, is the status wrong and this issue isn't fixed? If it is fixed, how can the example application I attached be modified so all the use cases work correctly?If it is just closed because it is a duplicate, it should be marked as such and not as fixed.I still think it might be a dup of Bug, but lets keep this one open too.It might be a duplicate, but int that case the state should be CLOSED DUPLICATE and not CLOSED FIXED ;)I think I've found a solution. Not sure about side effects with the compat layer. In my example e4 application on GitHub everything seems to work as intended now.To trigger core expression evaluation the UIEvent UIEvents.REQUEST_ENABLEMENT_UPDATE_TOPIC needs to be fired. From what I was told, this is the way to go since the periodic refresh was disabled.New Gerrit change created:Gerrit changewas merged to [master].Commit:fixed with above patch(In reply to Dirk Fauth from)Awesome Dirk, thanks. Can you add this to the N&N? As committer you can directly push or release a Gerrit review for it.(In reply to Lars Vogel from)Do we really add bugfixes to the N&N? I always thought that new features or improvements are part of N&N, not bugfixes.(In reply to Dirk Fauth from)No.(In reply to Dani Megert from)We typically add "bugfixes" to the N&N which are of high interest for customers. Remember the buzz about fixing "Customize Perspective"? In this case I think this is a new functionality that several customers are interested in so we should promote it. But I leave it to Dirk if he wants to add it.Sorry, but I had to revert this withIt causes lots of unexpected bundle loading and also lets our test fail that checks for unexpected bundle loading:Wrong bundles loaded:- org.eclipse.debug.ui- org.eclipse.jdt.debug- org.eclipse.jdt.debug.ui- org.eclipse.ui.consolejunit.framework.AssertionFailedError: Wrong bundles loaded:- org.eclipse.debug.ui- org.eclipse.jdt.debug- org.eclipse.jdt.debug.ui- org.eclipse.ui.consoleat org.eclipse.jdt.text.tests.PluginsNotLoadedTest.testPluginsNotLoaded(PluginsNotLoadedTest.java:265)at junit.extensions.TestDecorator.basicRun(TestDecorator.java:23)at junit.extensions.TestSetup$1.protect(TestSetup.java:23)at junit.extensions.TestSetup.run(TestSetup.java:27)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:692)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:319)at org.eclipse.test.UITestApplication$2.run(UITestApplication.java:197)at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135)at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3794)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3433)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$4.run(PartRenderingEngine.java:1127)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:336)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1018)at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:156)at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:654)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:336)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:598)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:139)at org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:140)at org.eclipse.test.UITestApplication.run(UITestApplication.java:62)at org.eclipse.test.UITestApplication.start(UITestApplication.java:212)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:380)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:235)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:669)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:608)at org.eclipse.equinox.launcher.Main.run(Main.java:1515)at org.eclipse.equinox.launcher.Main.main(Main.java:1488)at org.eclipse.core.launcher.Main.main(Main.java:34) Here is an example contribution from 'org.eclipse.debug.ui' who surfaces one of those problems: <menuContribution locationURI="menu:org.eclipse.ui.run?after=breakpointGroup"> <menu id="breakpointTypes" label="%BreakpointTypesMenu.label"> <visibleWhen checkEnabled="false"> <and> <with variable="org.eclipse.core.runtime.Platform"> <test property="org.eclipse.core.runtime.bundleState" args="org.eclipse.debug.ui" value="ACTIVE"/> </with> <with variable="activeContexts"> <iterate operator="or"> <equals value="org.eclipse.debug.ui.breakpointActionSet"/> </iterate> </with> <systemTest property="org.eclipse.debug.ui.breakpoints.toggleFactoriesUsed" value="true"> </systemTest> </and> </visibleWhen> <dynamic id="org.eclipse.debug.ui.actions.BreakpointTypesContribution" class="org.eclipse.debug.ui.actions.BreakpointTypesContribution"> </dynamic> </menu> </menuContribution>Under normal circumstances (say e.g. in the Eclipse SDK), that menu will never be shown because of the toggleFactoriesUsed system property that is set to 'false'. With the wrong commit, this menu is now evaluated (but not shown), which causes the unexpected loading of 'org.eclipse.debug.ui.actions.BreakpointTypesContribution' and hence the Debug UI plug-in.Furthermore, this commit also caused duplicated toolbar items in I20150721-0800.Steps:- new workspace- paste to Package Explorer:package p;public class C { public static void main(String[] args) { System.out.println(1); System.out.println(2); }}- set a breakpoint on the "println(2)" line.- Run > Debug (F11)- confirm switching to Debug perspective- Run > Debug (F11) again- Run > Debug (F11) a third time=> most items in the Console view toolbar are duplicated nowAnd more fallout to check with the next fix attempt: The "Window > Editor > ..." submenu showed two items called "Split Editor".In 4.5 and after the reversal of this bug's commit, they were called "Toggle Split Editor" ().So this is another episode of "The compat layer strikes back"I thought about this for a while, and I have some questions because I don't really understand everything in detail.@DaniYou say that the menu for which the systemTest returns false is now evaluated and wasn't before. Well, in fact that is what this patch intends. From the application model point of view this is exactly what should happen. The behavior before to not re-evaluate is wrong.I am thinking about this for a while now, and it is hurting my brain. Maybe because the assumptions and concepts behind the core expressions and the expected bundle loading are not clear to me in detail.If I understand you correctly org.eclipse.debug.ui should not be loaded because a systemTest core expression returns false. Therefore you assume that in such a case there should be no re-evaluation performed. This leads to the following questions:a) Why should the plugin not be loaded? It contributes a menu item which seems to get inspected. Otherwise how is the systemTest evaluated if the plugin isn't loaded? How can something be inspected that isn't loaded?b) From your statement the assumption is that if a visibleWhen core expression contains a systemTest that returns false, the contribution should not happen. From the application model point of view this means the contribution to the application model should not be performed. I wonder how this should work when not cleaning the persisted state but changing the system property.c) You statement assumes that systemTest should only be evaluated on startup and never again. But system properties can change at runtime via System.getProperties().setProperty(). This is fairly uncommon, but possible. So what is the semantic of systemTest? Is it intended that it only evaluates once and never again? In such a case the core expression evaluation needs to be changed somehow (and try to deal with b), maybe overridden to always return false or evaluate the core expression before it is transformed to the application model?Sorry for all those question, but IMHO my commit is correct from the application model point of view (plain Eclipse 4). But it raises issues with the compat layer. So hopefully with your help I will understand the concepts behind the plugin loading mechanism and the systemTest semantic. After that I will think about the other issues Markus found. It seems they are related on how the compat layer is dealing with dynamic menu contributions, but one step after the other, so my next "attempt" is better and also works with the compat layer.Looking at the ConsoleView, well the toolbar is still created using actions. And AFAIK actions are deprecated for years. Maybe the ConsoleView should be updated to use commands & handlers instead of programmatically added actions?Just an idea to bring the migration forward.(In reply to Dirk Fauth from)Sorry Dirk, I think I was not precise enough when I said "this menu is now evaluated". Of course it is evaluated each time the menu updater runs. However, since the <visibleWhen> expression is 'false', the menu is not shown, and hence, it is wrong and unnecessary to load BreakpointTypesContribution (which causes the plug to be started). This happens with your code changes.At a later point the system property might be 'true' and the Debug UI plug-in might have been loaded (first condition for the menu to become visible). In that case org.eclipse.debug.ui.actions.BreakpointTypesContribution should be loaded and used.Re-evaluation of the menu condition is desired and does happen fine in 4.5, e.g. via the menuUpdater in WorkbenchWindow.Maybe that already answered most of your questions.For performance and memory reasons as long as the real code of a bundle is not used. That's a fundamental part of the Eclipse plug-in architecture.That's the whole idea behind the core expressions: allow to express as much as possible in the 'plugin.xml' file to avoid/defer the loading of the full plug-in. In this case there is a property tester which can do the test without loading Debug UI.(In reply to Dani Megert from)Thanks for the explanation. So to repeat if I understand correctly:a) the bundle is loaded but not started. I guess that was the misunderstanding on my side, because it is of course loaded but not activated. correct?b) the re-evaluation is done in a menuUpdater in the compat layer. That means it works in compat mode, but not in plain e4. So a solution might be to have a similar behavior in the model as in this menuUpdater. which than should also fit better in the whole plugin architecture.This should help in finding a more suitable solution for both cases (compat and app model).(In reply to Dirk Fauth from)In terms of OSGi speak, the bundle is not ACTIVE yet, it's in the STARTING state (see 'org.osgi.framework.Bundle' for more details on the different bundle states). Most of our bundles have Bundle-ActivationPolicy: lazywhich means, the bundle gets activated when one of its classes gets loaded. Many bundles have an activator, e.g. Bundle-Activator: org.eclipse.debug.internal.ui.DebugUIPluginand activating the bundle loads that class and calls #start(BundleContext) on it.The tricky part will be to make sure that you don't update the same item twice every time.Mass move to 4.7 as M7 is approaching. Please move back in case you are planning to fix it for Neon.	24.0
id=411639	REOPENED	Platform	IDE	4.3	All All	P3 normal	Platform-UI-Inbox	2013-06-25 16:55 EDT by	Rob Gansevles	2016-05-12 06:33 EDT (	5 users	I am using a new install of 4.3 (eclipse-SDK-4.3RC4-linux-gtk) on an existing workspace that was last used with 3.8.This workspace was using the 'Java EE' perspective which I think is not present in the 4.3 install.All still works fine it seems, the old perspective is used.But when I want to customize the perspective I get an NPE.!ENTRY org.eclipse.ui.workbench 4 0 2013-06-25 22:44:54.813!MESSAGE java.lang.NullPointerException!STACK 0java.lang.NullPointerException at org.eclipse.ui.internal.dialogs.CustomizePerspectiveDialog.configureShell(CustomizePerspectiveDialog.java:1489) at org.eclipse.jface.window.Window.createShell(Window.java:503) at org.eclipse.jface.window.Window.create(Window.java:431) at org.eclipse.jface.dialogs.Dialog.create(Dialog.java:1104) at org.eclipse.jface.window.Window.open(Window.java:791) at org.eclipse.ui.internal.WorkbenchPage.editActionSets(WorkbenchPage.java:1858) at org.eclipse.ui.internal.handlers.EditActionSetsHandler.execute(EditActionSetsHandler.java:41) at org.eclipse.ui.internal.handlers.HandlerProxy.execute(HandlerProxy.java:290) at org.eclipse.ui.internal.handlers.E4HandlerProxy.execute(E4HandlerProxy.java:90) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:601) at org.eclipse.e4.core.internal.di.MethodRequestor.execute(MethodRequestor.java:56) at org.eclipse.e4.core.internal.di.InjectorImpl.invokeUsingClass(InjectorImpl.java:243) at org.eclipse.e4.core.internal.di.InjectorImpl.invoke(InjectorImpl.java:224) at org.eclipse.e4.core.contexts.ContextInjectionFactory.invoke(ContextInjectionFactory.java:132) at org.eclipse.e4.core.commands.internal.HandlerServiceHandler.execute(HandlerServiceHandler.java:167) at org.eclipse.core.commands.Command.executeWithChecks(Command.java:499) at org.eclipse.core.commands.ParameterizedCommand.executeWithChecks(ParameterizedCommand.java:508) at org.eclipse.e4.core.commands.internal.HandlerServiceImpl.executeHandler(HandlerServiceImpl.java:213) at org.eclipse.ui.internal.handlers.LegacyHandlerService.executeCommand(LegacyHandlerService.java:420) at org.eclipse.ui.internal.actions.CommandAction.runWithEvent(CommandAction.java:157) at org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:584) at org.eclipse.jface.action.ActionContributionItem.access$2(ActionContributionItem.java:501) at org.eclipse.jface.action.ActionContributionItem$5.handleEvent(ActionContributionItem.java:411) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1392) at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3742) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3363) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1113) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:997) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:138) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:610) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:567) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:354) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:181) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:601) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:636) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:591) at org.eclipse.equinox.launcher.Main.run(Main.java:1450)	Fix:Because Perspective API allows to have perspective without descriptors, the fix only changes the CPD in the way that it allows to work such perspectives (which also covers the "missing" perspective case). The changes however will be lost on next Eclipse restart. I don't know what should be the best way to deal with such situation - probably UI should never allow perspectives without descriptors to be set, but I think this would be a bigger change.New Gerrit change created:New Gerrit change created:Gerrit changewas merged to [master].Commit:Thank you, Andrey.This does not work for me using 'master'. While it writes the log entry and displays the perspective in <>, the perspective itself is broken.Test Case:1. start new workspace out of dev env (master)2. close Welcome page3. switch to Debug perspective4. exit5. in org.eclipse.debug.ui/plugin.xml remove the perspective contribution6. start workspace==> bugs:- Java perspective is active instead of <Debug>- clicking on <Debug> perspective icon gives!ENTRY org.eclipse.equinox.event 4 0 2015-03-03 14:41:44.488!MESSAGE Exception while dispatching event org.osgi.service.event.Event [topic=org/eclipse/e4/ui/model/ui/ElementContainer/selectedElement/SET] {NewValue=org.eclipse.e4.ui.model.application.ui.advanced.impl.PerspectiveImpl@5c2808fc (elementId: org.eclipse.debug.ui.DebugPerspective.<Debug>, tags: [persp.actionSet:pomUtilities, persp.actionSet:bundleUtilities, persp.actionSet:planAppendixGenerator, persp.actionSet:org.eclipse.jdt.ui.tests.actionSet1, persp.actionSet:org.eclipse.ui.cheatsheets.actionSet, persp.actionSet:org.eclipse.search.searchActionSet, persp.actionSet:org.eclipse.help.pageloader.actionSet, persp.actionSet:org.eclipse.ui.edit.text.actionSet.annotationNavigation, persp.actionSet:org.eclipse.ui.edit.text.actionSet.navigation, persp.actionSet:org.eclipse.ui.edit.text.actionSet.convertLineDelimitersTo, persp.actionSet:ProgressExamples.actionSet, persp.actionSet:org.eclipse.ui.examples.rcp.texteditor.fileActionSet, persp.actionSet:org.eclipse.ui.externaltools.ExternalToolsSet, persp.actionSet:org.eclipse.ui.actionSet.keyBindings, persp.actionSet:org.eclipse.ui.actionSet.openFiles, persp.actionSet:org.eclipse.debug.ui.launchActionSet, persp.actionSet:org.eclipse.debug.ui.debugActionSet, persp.viewSC:org.eclipse.debug.ui.DebugView, persp.viewSC:org.eclipse.debug.ui.VariableView, persp.viewSC:org.eclipse.debug.ui.BreakpointView, persp.viewSC:org.eclipse.debug.ui.ExpressionView, persp.viewSC:org.eclipse.ui.views.ContentOutline, persp.viewSC:org.eclipse.ui.console.ConsoleView, persp.viewSC:org.eclipse.ui.views.TaskList, persp.viewSC:org.eclipse.ant.ui.views.AntView, persp.actionSet:org.eclipse.ui.NavigateActionSet, persp.actionSet:org.eclipse.debug.ui.breakpointActionSet, persp.viewSC:org.eclipse.pde.runtime.LogView, persp.showIn:org.eclipse.egit.ui.RepositoriesView, persp.actionSet:org.eclipse.jdt.debug.ui.JDTDebugActionSet, persp.viewSC:org.eclipse.jdt.debug.ui.DisplayView, persp.showIn:org.eclipse.jdt.jeview.views.JavaElementView, persp.perspSC:org.eclipse.jdt.ui.JavaPerspective, persp.perspSC:org.eclipse.jdt.ui.JavaBrowsingPerspective, persp.actionSet:org.eclipse.jdt.ui.JavaActionSet, persp.showIn:org.eclipse.jdt.ui.PackageExplorer], contributorURI: null) (widget: Composite {}, renderer: org.eclipse.e4.ui.workbench.renderers.swt.PerspectiveRenderer@12d80ece, toBeRendered: true, onTop: false, visible: true, containerData: null, accessibilityPhrase: null) (label: <Debug>, iconURI: platform:/plugin/org.eclipse.debug.ui/icons/full/eview16/debug_persp.png, tooltip: null, context: PerspectiveImpl (org.eclipse.debug.ui.DebugPerspective) Context, variables: []), ChangedElement=org.eclipse.e4.ui.model.application.ui.advanced.impl.PerspectiveStackImpl@6b2cf4fc (elementId: org.eclipse.ui.ide.perspectivestack, tags: [], contributorURI: null) (widget: Composite {}, renderer: org.eclipse.e4.ui.workbench.renderers.swt.PerspectiveStackRenderer@67ffbbe2, toBeRendered: true, onTop: false, visible: true, containerData: 7500, accessibilityPhrase: null), EventType=SET, AttName=selectedElement, OldValue=org.eclipse.e4.ui.model.application.ui.advanced.impl.PerspectiveImpl@2da09081 (elementId: org.eclipse.jdt.ui.JavaPerspective, tags: [persp.actionSet:pomUtilities, persp.actionSet:bundleUtilities, persp.actionSet:planAppendixGenerator, persp.actionSet:org.eclipse.jdt.ui.tests.actionSet1, persp.actionSet:org.eclipse.ui.cheatsheets.actionSet, persp.actionSet:org.eclipse.search.searchActionSet, persp.actionSet:org.eclipse.help.pageloader.actionSet, persp.actionSet:org.eclipse.ui.edit.text.actionSet.annotationNavigation, persp.actionSet:org.eclipse.ui.edit.text.actionSet.navigation, persp.actionSet:org.eclipse.ui.edit.text.actionSet.convertLineDelimitersTo, persp.actionSet:ProgressExamples.actionSet, persp.actionSet:org.eclipse.ui.examples.rcp.texteditor.fileActionSet, persp.actionSet:org.eclipse.ui.externaltools.ExternalToolsSet, persp.actionSet:org.eclipse.ui.actionSet.keyBindings, persp.actionSet:org.eclipse.ui.actionSet.openFiles, persp.actionSet:org.eclipse.debug.ui.launchActionSet, persp.actionSet:org.eclipse.jdt.ui.JavaActionSet, persp.actionSet:org.eclipse.jdt.ui.JavaElementCreationActionSet, persp.actionSet:org.eclipse.ui.NavigateActionSet, persp.viewSC:org.eclipse.jdt.ui.PackageExplorer, persp.viewSC:org.eclipse.jdt.ui.TypeHierarchy, persp.viewSC:org.eclipse.jdt.ui.SourceView, persp.viewSC:org.eclipse.jdt.ui.JavadocView, persp.viewSC:org.eclipse.search.ui.views.SearchView, persp.viewSC:org.eclipse.ui.console.ConsoleView, persp.viewSC:org.eclipse.ui.views.ContentOutline, persp.viewSC:org.eclipse.ui.views.ProblemView, persp.viewSC:org.eclipse.ui.views.ResourceNavigator, persp.viewSC:org.eclipse.ui.views.TaskList, persp.viewSC:org.eclipse.ui.views.ProgressView, persp.viewSC:org.eclipse.ui.navigator.ProjectExplorer, persp.viewSC:org.eclipse.ui.texteditor.TemplatesView, persp.viewSC:org.eclipse.pde.runtime.LogView, persp.newWizSC:org.eclipse.jdt.ui.wizards.JavaProjectWizard, persp.newWizSC:org.eclipse.jdt.ui.wizards.NewPackageCreationWizard, persp.newWizSC:org.eclipse.jdt.ui.wizards.NewClassCreationWizard, persp.newWizSC:org.eclipse.jdt.ui.wizards.NewInterfaceCreationWizard, persp.newWizSC:org.eclipse.jdt.ui.wizards.NewEnumCreationWizard, persp.newWizSC:org.eclipse.jdt.ui.wizards.NewAnnotationCreationWizard, persp.newWizSC:org.eclipse.jdt.ui.wizards.NewSourceFolderCreationWizard, persp.newWizSC:org.eclipse.jdt.ui.wizards.NewSnippetFileCreationWizard, persp.newWizSC:org.eclipse.jdt.ui.wizards.NewJavaWorkingSetWizard, persp.newWizSC:org.eclipse.ui.wizards.new.folder, persp.newWizSC:org.eclipse.ui.wizards.new.file, persp.newWizSC:org.eclipse.ui.editors.wizards.UntitledTextFileWizard, persp.perspSC:org.eclipse.jdt.ui.JavaBrowsingPerspective, persp.perspSC:org.eclipse.debug.ui.DebugPerspective, persp.viewSC:org.eclipse.ant.ui.views.AntView, persp.showIn:org.eclipse.egit.ui.RepositoriesView, persp.viewSC:org.eclipse.jdt.astview.views.ASTView, persp.actionSet:org.eclipse.debug.ui.breakpointActionSet, persp.actionSet:org.eclipse.jdt.debug.ui.JDTDebugActionSet, persp.viewSC:org.eclipse.jdt.jeview.views.JavaElementView, persp.showIn:org.eclipse.jdt.jeview.views.JavaElementView, persp.newWizSC:org.eclipse.jdt.junit.wizards.NewTestCaseCreationWizard, persp.actionSet:org.eclipse.jdt.junit.JUnitActionSet, persp.showIn:org.eclipse.jdt.ui.PackageExplorer, persp.showIn:org.eclipse.team.ui.GenericHistoryView, persp.showIn:org.eclipse.ui.views.ResourceNavigator, persp.showIn:org.eclipse.ui.navigator.ProjectExplorer], contributorURI: null) (widget: Composite {}, renderer: org.eclipse.e4.ui.workbench.renderers.swt.PerspectiveRenderer@12d80ece, toBeRendered: true, onTop: false, visible: true, containerData: null, accessibilityPhrase: null) (label: Java, iconURI: platform:/plugin/org.eclipse.jdt.ui/icons/full/eview16/jperspective.gif, tooltip: null, context: PerspectiveImpl (org.eclipse.jdt.ui.JavaPerspective) Context, variables: []), Widget=Composite {}} to handler org.eclipse.e4.ui.services.internal.events.UIEventHandler@459a60e1!STACK 0java.lang.NullPointerException at org.eclipse.e4.ui.workbench.renderers.swt.LazyStackRenderer.showElementRecursive(LazyStackRenderer.java:232) at org.eclipse.e4.ui.workbench.renderers.swt.LazyStackRenderer.showElementRecursive(LazyStackRenderer.java:275) at org.eclipse.e4.ui.workbench.renderers.swt.LazyStackRenderer.showElementRecursive(LazyStackRenderer.java:281) at org.eclipse.e4.ui.workbench.renderers.swt.LazyStackRenderer.showElementRecursive(LazyStackRenderer.java:281) at org.eclipse.e4.ui.workbench.renderers.swt.LazyStackRenderer.showElementRecursive(LazyStackRenderer.java:281) at org.eclipse.e4.ui.workbench.renderers.swt.LazyStackRenderer.showElementRecursive(LazyStackRenderer.java:281) at org.eclipse.e4.ui.workbench.renderers.swt.LazyStackRenderer.showTab(LazyStackRenderer.java:161) at org.eclipse.e4.ui.workbench.renderers.swt.PerspectiveStackRenderer.showTab(PerspectiveStackRenderer.java:88) at org.eclipse.e4.ui.workbench.renderers.swt.LazyStackRenderer$1.handleEvent(LazyStackRenderer.java:71) at org.eclipse.e4.ui.services.internal.events.UIEventHandler$1.run(UIEventHandler.java:40) at org.eclipse.swt.widgets.Synchronizer.syncExec(Synchronizer.java:187) at org.eclipse.ui.internal.UISynchronizer.syncExec(UISynchronizer.java:145) at org.eclipse.swt.widgets.Display.syncExec(Display.java:4753)Moving to M7, Andrey in case you want to fix that tomorrow, please move it back.AFAICS this bug is the last real blocker for infamous.I confirm the errors, and I cannot fix them for 4.5 M7.BTW after second restart with the "missing" perspective everything seems to work fine. I'm removing the dependency to 420956 since this is not about "customization" anymore, it's "just" perspective thing (sure annoying too).(In reply to Andrey Loskutov from)Do you have time to fix them during RC1?(In reply to Dani Megert from)I cannot guarantee it, but I will try to look into it again.(In reply to Andrey Loskutov from)RC2?(In reply to Lars Vogel from)Not by me, sorry.	13.0
id=412569	REOPENED	Platform	UI	4.4	PC Windows 7	P3 normal	Platform-UI-Inbox	2013-07-09 04:44 EDT by	Dani Megert	2014-05-29 13:06 EDT (	4 users	N20130708-2000.SimpleVirtualLazyTreeViewerTest.testRemoveAt failed.expected:<2> but was:<0>junit.framework.AssertionFailedError: expected:<2> but was:<0>at org.eclipse.jface.tests.viewers.SimpleVirtualLazyTreeViewerTest.testRemoveAt(SimpleVirtualLazyTreeViewerTest.java:200)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:655)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:310)at org.eclipse.test.CoreTestApplication.runTests(CoreTestApplication.java:36)at org.eclipse.test.CoreTestApplication.run(CoreTestApplication.java:32)at org.eclipse.equinox.internal.app.EclipseAppContainer.callMethodWithException(EclipseAppContainer.java:587)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:198)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:109)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:80)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:372)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:226)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:636)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:591)at org.eclipse.equinox.launcher.Main.run(Main.java:1450)at org.eclipse.equinox.launcher.Main.main(Main.java:1426)at org.eclipse.core.launcher.Main.main(Main.java:34)	Also failed in the I-build:Probably a regression either in UI or SWT.We haven't made a change in the tests since May and not in JFace since the middle of June.Silenio, any chance of Tree or Lazy changes in SWT?PWNo changes in SWT. Test has not failed in latest I-build and N-build either.Moving to M2 as per.I haven't seen this failure recently, has anybody seen this or should we close it ?(In reply to Eric Moffatt from)No, I haven't seen since then.It's back in the last two I-builds.Wojtek,Can you try and reproduce this?PWI cannot reproduce it. I tested pure I20140506-2000 build, as well as the latest commits. In the official build the test passes again.It still hasn't been happening in the official builds, deferring until later.PW	10.0
id=451084	REOPENED	Platform	UI	4.4	PC Windows 7	P3 normal	Platform-UI-Inbox	2014-11-12 03:03 EST by	Fabian Miehe	2016-04-25 15:16 EDT (	3 users	Createdexample implementationThe tableviewer doesnt update elements if a filter is active and the content of the viewer is changing.i.e.1) add element (integer value 1) -> element is visible2) Activate filter (filter all elments % 2 != 0)3) element is invisible4) change element value to 25) element is still invisble, but should be visible	From the example you posted I see that you call update() in between 4.) and 5.). Does refresh() work correctly?yes refresh works, but if the filter is still active the item is filtered again if it is invalid.So you have to call update() and afterthat refresh()....tableViewer.update(new Object[]{model}, properties);tableViewer.refresh();...I thought, refresh() reloads the complete model and we just wanna update one or more columns.(performance?)(In reply to Fabian Miehe from)Correct, I just wanted to know if refresh works. Please create a Gerrit review for the fix in TableViewer.update(In reply to Lars Vogel from)Any update here Fabian?I think I misunderstood the example. The viewer can not model the content of the viewer, for this you would need to use data binding.The model is the same, but if a single property value inside the model is changed, the filter doesnt work.The ViewerFilter recognizes add or remove (Structural Changes), but if a single property in a existing table row changes the filter doesnt work.So you have to remove and then add a table row, if the content of an exitisting row is changed.If you always have to filter inside the model(this is possible), the ViewerFilter is useless (for us :-) ).We use a lot of tables with dynmanic content.e.g. if you have aircraft data, the latitude and longitude values change frequently, but the name of the aircraft is still the same. So it is only neccessary to update the lat or lon value not the whole table row.Fabian, I think I misunderstood your case. Reopening, I agree this sounds like a bug. Are you planning to provide a patch?New Gerrit change created:I changed the update method inside the TableViewer.But maybe i would be better to change the update method inside the base class ColumnViewerSorry Fabian, we try to integrate that into early 4.6.Mass move to 4.7.	11.0
id=453983	REOPENED	Platform	UI	4.5	PC Windows 7	P3 enhancement	Platform-UI-Inbox	2014-12-03 06:33 EST by	Stefan Eder	2014-12-03 09:05 EST (	2 users	There is apparently no way to customize the sort order of entries in the project explorer.It would be just so nice to be able to specify a sort order for folders - like update time descending or to have the ability to sort numeric portions of file names in a more natural way.I consider this a bug because it bugged me for years now.	*** This bug has been marked as a duplicate of***Sorry,is specific to working sets.This is not about sorting within working sets. Its about sorting folder entries in the project explorer.Besidesis marked as duplicate, too.(In reply to Stefan Eder from)It's not really necessary to repeat this after I've reopened the bug ;-).Not in my "version" of bugzilla.	4.0
id=422284	REOPENED	Platform	IDE	4.3.1	PC Linux	P3 enhancement	Platform-UI-Inbox	2013-11-21 14:00 EST by	vinicius brito	2014-05-27 10:03 EDT (	1 user	Are closing every hour, alone ...Ubuntu 13.10-- Configuration Details --Product: Eclipse 2.0.1.20130919-0803 (org.eclipse.epp.package.jee.product)Installed Features: org.eclipse.platform 4.3.1.v20130911-1000	This bug report is incomplete.what is missing?(In reply to vinicius brito from)A better description of the problem with steps to reproduce it.My eclipse is closing all the time, just happen, and it closes'm developing alone, there appears no error, has no log ... I have no more to say, use Ubuntu 13.10 X64 was only changing the version of the operating system that began errors. Sorry for my english ....(In reply to vinicius brito from)You can start and it crashes after some time? If so, please check whether you can crash it with these steps:1. open a Java file2. type "Strin" and invoke content assist (Ctrl+Space)3. does the Javadoc appear on the right side, or does it crash?Did you check in <yourWorkspace>/.metadata/.log?If you changed the OS, did you also ensure that the Eclipse version is for that platform and that you use the correct JRE?"You can start and it crashes after some time? If so, please check whether youcan crash it with these steps:1. open a Java file2. type "Strin" and invoke content assist (Ctrl+Space)3. does the Javadoc appear on the right side, or does it crash?"About this, working normallyIf you changed the OS, did you also ensure that the Eclipse version is for thatplatform and that you use the correct JRE?About this...Yes, I've downloaded the Eclipse website."Download eclipse-jee-kepler-SR1-linux-gtk-x86_64.tar.gz from:Download [Brazil] C3SL - Federal University of Parana (http) "java version "1.7.0_45"Java(TM) SE Runtime Environment (build 1.7.0_45-b18)Java HotSpot(TM) 64-Bit Server VM (build 24.45-b08, mixed mode)crash log:!ENTRY org.eclipse.ui 4 4 2013-11-26 17:25:08.032!MESSAGE Could not retrieve EHandlerService or ICommandService from context evaluation context fororg.eclipse.wst.xml.ui.disable.grammar.constraints!ENTRY org.eclipse.ui 4 4 2013-11-26 17:25:08.032!MESSAGE Could not retrieve EHandlerService or ICommandService from context evaluation context fororg.eclipse.wst.xml.ui.reload.dependencies!ENTRY org.eclipse.ui 4 4 2013-11-26 17:25:08.033!MESSAGE Could not retrieve EHandlerService or ICommandService from context evaluation context fororg.eclipse.wst.xml.ui.disable.grammar.constraints!ENTRY org.eclipse.ui 4 4 2013-11-26 17:25:08.033!MESSAGE Could not retrieve EHandlerService or ICommandService from context evaluation context fororg.eclipse.wst.xml.ui.reload.dependencies!ENTRY org.eclipse.ui 4 4 2013-11-26 17:25:08.038!MESSAGE Could not retrieve EHandlerService or ICommandService from context evaluation context fororg.eclipse.wst.xml.ui.disable.grammar.constraints!ENTRY org.eclipse.ui 4 4 2013-11-26 17:25:08.038!MESSAGE Could not retrieve EHandlerService or ICommandService from context evaluation context fororg.eclipse.wst.xml.ui.reload.dependencies!SESSION 2013-11-27 08:38:07.258 -----------------------------------------------eclipse.buildId=4.3.0.M20130911-1000java.version=1.7.0_45java.vendor=Oracle CorporationBootLoader constants: OS=linux, ARCH=x86_64, WS=gtk, NL=en_USFramework arguments: -product org.eclipse.epp.package.jee.productCommand-line arguments: -os linux -ws gtk -arch x86_64 -product org.eclipse.epp.package.jee.product!ENTRY org.eclipse.core.resources 2 10035 2013-11-27 08:38:11.937!MESSAGE The workspace exited with unsaved changes in the previous session; refreshing workspace to recover changes.!ENTRY org.eclipse.jst.jsp.core 4 4 2013-11-27 08:39:14.726!MESSAGE A workspace crash was detected. The previous session did not exit normally. Not using saved taglib indexes.!ENTRY org.eclipse.m2e.logback.appender 2 0 2013-11-27 08:40:11.629!MESSAGE The POM for com.oracle:ojdbc6:jar:11.1.0.7 is missing, no dependency information available!ENTRY org.eclipse.m2e.logback.appender 2 0 2013-11-27 08:40:15.161!MESSAGE The POM for com.oracle:ojdbc6:jar:11.1.0.7 is missing, no dependency information available!ENTRY org.eclipse.m2e.logback.appender 2 0 2013-11-27 08:40:20.024!MESSAGE The POM for com.oracle:ojdbc6:jar:11.1.0.7 is missing, no dependency information available!ENTRY org.eclipse.osgi 2 1 2013-11-27 08:41:09.276!MESSAGE NLS missing message: CANNOT_FIND_FACELET_TAGLIB in: org.eclipse.jst.jsf.core.validation.internal.facelet.messages!ENTRY org.eclipse.jface 2 0 2013-11-27 08:55:52.572!MESSAGE Keybinding conflicts occurred. They may interfere with normal accelerator operation.!SUBENTRY 1 org.eclipse.jface 2 0 2013-11-27 08:55:52.572!MESSAGE A conflict occurred for CTRL+D:Binding(CTRL+D, ParameterizedCommand(Command(org.eclipse.debug.ui.commands.eof,EOF, Send end of file, Category(org.eclipse.debug.ui.category.run,Run/Debug,Run/Debug command category,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@1e2dfdc9, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.debug.ui.console,,,system)Binding(CTRL+D, ParameterizedCommand(Command(org.eclipse.ui.edit.text.delete.line,Delete Line, Delete a line of text, Category(org.eclipse.ui.category.textEditor,Text Editing,Text Editing Commands,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@5d70a699, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.ui.textEditorScope,,,system)!ENTRY org.eclipse.jface 2 0 2013-11-27 08:57:19.670!MESSAGE Keybinding conflicts occurred. They may interfere with normal accelerator operation.!SUBENTRY 1 org.eclipse.jface 2 0 2013-11-27 08:57:19.670!MESSAGE A conflict occurred for CTRL+I:Binding(CTRL+I, ParameterizedCommand(Command(org.eclipse.jdt.ui.edit.text.java.indent,Correct Indentation, Corrects the indentation of the selected lines, Category(org.eclipse.jdt.ui.category.source,Source,Java Source Actions,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@140cf814, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.jdt.ui.javaEditorScope,,,system)Binding(CTRL+I, ParameterizedCommand(Command(org.eclipse.wst.sse.ui.format.active.elements,Format Active Elements, Format active elements, Category(org.eclipse.ui.category.edit,Edit,null,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@52305318, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.wst.sse.ui.structuredTextEditorScope,,,system)!SUBENTRY 1 org.eclipse.jface 2 0 2013-11-27 08:57:19.670!MESSAGE A conflict occurred for CTRL+SHIFT+F:Binding(CTRL+SHIFT+F, ParameterizedCommand(Command(org.eclipse.jdt.ui.edit.text.java.format,Format, Format the selected text, Category(org.eclipse.jdt.ui.category.source,Source,Java Source Actions,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@5f72f354, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.jdt.ui.javaEditorScope,,,system)Binding(CTRL+SHIFT+F, ParameterizedCommand(Command(org.eclipse.wst.sse.ui.format.document,Format, Format selection, Category(org.eclipse.ui.category.edit,Edit,null,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@792f1d1b, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.wst.sse.ui.structuredTextEditorScope,,,system)!SUBENTRY 1 org.eclipse.jface 2 0 2013-11-27 08:57:19.670!MESSAGE A conflict occurred for ALT+SHIFT+ARROW_UP:Binding(ALT+SHIFT+ARROW_UP, ParameterizedCommand(Command(org.eclipse.jdt.ui.edit.text.java.select.enclosing,Select Enclosing Element, Expand selection to include enclosing element, Category(org.eclipse.ui.category.edit,Edit,null,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@73c540c0, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.jdt.ui.javaEditorScope,,,system)Binding(ALT+SHIFT+ARROW_UP, ParameterizedCommand(Command(org.eclipse.wst.sse.ui.structure.select.enclosing,Select Enclosing Element, Expand selection to include enclosing element, Category(org.eclipse.ui.category.edit,Edit,null,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@5205f8e0, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.wst.sse.ui.structuredTextEditorScope,,,system)!SUBENTRY 1 org.eclipse.jface 2 0 2013-11-27 08:57:19.670!MESSAGE A conflict occurred for CTRL+SHIFT+/:Binding(CTRL+SHIFT+/, ParameterizedCommand(Command(org.eclipse.jdt.ui.edit.text.java.add.block.comment,Add Block Comment, Enclose the selection with a block comment, Category(org.eclipse.jdt.ui.category.source,Source,Java Source Actions,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@1b1e38a1, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.jdt.ui.javaEditorScope,,,system)Binding(CTRL+SHIFT+/, ParameterizedCommand(Command(org.eclipse.wst.sse.ui.add.block.comment,Add Block Comment, Add Block Comment, Category(org.eclipse.ui.category.edit,Edit,null,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@7a462cf5, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.wst.sse.ui.structuredTextEditorScope,,,system)!SUBENTRY 1 org.eclipse.jface 2 0 2013-11-27 08:57:19.670!MESSAGE A conflict occurred for CTRL+O:Binding(CTRL+O, ParameterizedCommand(Command(org.eclipse.jdt.ui.edit.text.java.show.outline,Quick Outline, Show the quick outline for the editor input, Category(org.eclipse.ui.category.navigate,Navigate,null,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@5d17dfef, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.jdt.ui.javaEditorScope,,,system)Binding(CTRL+O, ParameterizedCommand(Command(org.eclipse.wst.sse.ui.quick_outline,Quick Outline, Show the quick outline for the editor input, Category(org.eclipse.ui.category.navigate,Navigate,null,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@4a6ef3a8, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.wst.sse.ui.structuredTextEditorScope,,,system)!SUBENTRY 1 org.eclipse.jface 2 0 2013-11-27 08:57:19.670!MESSAGE A conflict occurred for CTRL+SHIFT+P:Binding(CTRL+SHIFT+P, ParameterizedCommand(Command(org.eclipse.jdt.ui.edit.text.java.goto.matching.bracket,Go to Matching Bracket, Moves the cursor to the matching bracket, Category(org.eclipse.ui.category.navigate,Navigate,null,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@3a3ec0c5, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.jdt.ui.javaEditorScope,,,system)Binding(CTRL+SHIFT+P, ParameterizedCommand(Command(org.eclipse.m2e.core.ui.command.addPlugin,Add Maven Plugin, Add Maven Plugin, Category(org.eclipse.ui.category.edit,Edit,null,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@6de1e362, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.core.runtime.xml,,,system)Binding(CTRL+SHIFT+P, ParameterizedCommand(Command(org.eclipse.wst.sse.ui.goto.matching.bracket,Matching Character, Go to Matching Character, Category(org.eclipse.ui.category.navigate,Navigate,null,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@29c408c6, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.wst.sse.ui.structuredTextEditorScope,,,system)!SUBENTRY 1 org.eclipse.jface 2 0 2013-11-27 08:57:19.670!MESSAGE A conflict occurred for CTRL+SHIFT+ARROW_UP:Binding(CTRL+SHIFT+ARROW_UP, ParameterizedCommand(Command(org.eclipse.jdt.ui.edit.text.java.goto.previous.member,Go to Previous Member, Move the caret to the previous member of the compilation unit, Category(org.eclipse.ui.category.navigate,Navigate,null,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@9176f4a, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.jdt.ui.javaEditorScope,,,system)Binding(CTRL+SHIFT+ARROW_UP, ParameterizedCommand(Command(org.eclipse.wst.xml.ui.previousSibling,Previous Sibling, Go to Previous Sibling, Category(org.eclipse.ui.category.edit,Edit,null,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@2f792a52, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.wst.sse.ui.structuredTextEditorScope,,,system)!SUBENTRY 1 org.eclipse.jface 2 0 2013-11-27 08:57:19.670!MESSAGE A conflict occurred for ALT+SHIFT+ARROW_DOWN:Binding(ALT+SHIFT+ARROW_DOWN, ParameterizedCommand(Command(org.eclipse.jdt.ui.edit.text.java.select.last,Restore Last Selection, Restore last selection, Category(org.eclipse.ui.category.edit,Edit,null,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@618b67ef, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.jdt.ui.javaEditorScope,,,system)Binding(ALT+SHIFT+ARROW_DOWN, ParameterizedCommand(Command(org.eclipse.wst.sse.ui.structure.select.last,Restore Last Selection, Restore last selection, Category(org.eclipse.ui.category.edit,Edit,null,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@1990c3f5, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.wst.sse.ui.structuredTextEditorScope,,,system)!SUBENTRY 1 org.eclipse.jface 2 0 2013-11-27 08:57:19.670!MESSAGE A conflict occurred for CTRL+SHIFT+C:Binding(CTRL+SHIFT+C, ParameterizedCommand(Command(org.eclipse.jdt.ui.edit.text.java.toggle.comment,Toggle Comment, Toggle comment the selected lines, Category(org.eclipse.jdt.ui.category.source,Source,Java Source Actions,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@754adf1, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.jdt.ui.javaEditorScope,,,system)Binding(CTRL+SHIFT+C, ParameterizedCommand(Command(org.eclipse.wst.sse.ui.toggle.comment,Toggle Comment, Toggle Comment, Category(org.eclipse.ui.category.edit,Edit,null,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@7d3abee, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.wst.sse.ui.structuredTextEditorScope,,,system)!SUBENTRY 1 org.eclipse.jface 2 0 2013-11-27 08:57:19.670!MESSAGE A conflict occurred for ALT+SHIFT+ARROW_RIGHT:Binding(ALT+SHIFT+ARROW_RIGHT, ParameterizedCommand(Command(org.eclipse.jdt.ui.edit.text.java.select.next,Select Next Element, Expand selection to include next sibling, Category(org.eclipse.ui.category.edit,Edit,null,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@4867acf9, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.jdt.ui.javaEditorScope,,,system)Binding(ALT+SHIFT+ARROW_RIGHT, ParameterizedCommand(Command(org.eclipse.wst.sse.ui.structure.select.next,Select Next Element, Expand selection to include next sibling, Category(org.eclipse.ui.category.edit,Edit,null,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@2fbb968d, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.wst.sse.ui.structuredTextEditorScope,,,system)!SUBENTRY 1 org.eclipse.jface 2 0 2013-11-27 08:57:19.670!MESSAGE A conflict occurred for CTRL+SHIFT+\:Binding(CTRL+SHIFT+\, ParameterizedCommand(Command(org.eclipse.jdt.ui.edit.text.java.remove.block.comment,Remove Block Comment, Remove the block comment enclosing the selection, Category(org.eclipse.jdt.ui.category.source,Source,Java Source Actions,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@e8d3492, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.jdt.ui.javaEditorScope,,,system)Binding(CTRL+SHIFT+\, ParameterizedCommand(Command(org.eclipse.wst.sse.ui.remove.block.comment,Remove Block Comment, Remove Block Comment, Category(org.eclipse.ui.category.edit,Edit,null,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@21602963, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.wst.sse.ui.structuredTextEditorScope,,,system)!SUBENTRY 1 org.eclipse.jface 2 0 2013-11-27 08:57:19.670!MESSAGE A conflict occurred for CTRL+SHIFT+ARROW_DOWN:Binding(CTRL+SHIFT+ARROW_DOWN, ParameterizedCommand(Command(org.eclipse.jdt.ui.edit.text.java.goto.next.member,Go to Next Member, Move the caret to the next member of the compilation unit, Category(org.eclipse.ui.category.navigate,Navigate,null,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@587664b4, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.jdt.ui.javaEditorScope,,,system)Binding(CTRL+SHIFT+ARROW_DOWN, ParameterizedCommand(Command(org.eclipse.wst.xml.ui.nextSibling,Next Sibling, Go to Next Sibling, Category(org.eclipse.ui.category.edit,Edit,null,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@6ffb8048, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.wst.sse.ui.structuredTextEditorScope,,,system)!SUBENTRY 1 org.eclipse.jface 2 0 2013-11-27 08:57:19.670!MESSAGE A conflict occurred for ALT+SHIFT+ARROW_LEFT:Binding(ALT+SHIFT+ARROW_LEFT, ParameterizedCommand(Command(org.eclipse.jdt.ui.edit.text.java.select.previous,Select Previous Element, Expand selection to include previous sibling, Category(org.eclipse.ui.category.edit,Edit,null,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@44cd92cb, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.jdt.ui.javaEditorScope,,,system)Binding(ALT+SHIFT+ARROW_LEFT, ParameterizedCommand(Command(org.eclipse.wst.sse.ui.structure.select.previous,Select Previous Element, Expand selection to include previous sibling, Category(org.eclipse.ui.category.edit,Edit,null,true), org.eclipse.ui.internal.WorkbenchHandlerServiceHandler@1ef2c762, ,,true),null), org.eclipse.ui.defaultAcceleratorConfiguration, org.eclipse.wst.sse.ui.structuredTextEditorScope,,,system)another crash log:!ENTRY org.eclipse.jdt.debug 4 125 2013-11-27 10:37:31.572!MESSAGE Internal error logged from JDI Debug: !STACK 0org.eclipse.jdi.TimeoutException: Timeout occurred while waiting for packet 47234. at org.eclipse.jdi.internal.connect.PacketReceiveManager.getReply(PacketReceiveManager.java:186) at org.eclipse.jdi.internal.connect.PacketReceiveManager.getReply(PacketReceiveManager.java:197) at org.eclipse.jdi.internal.MirrorImpl.requestVM(MirrorImpl.java:191) at org.eclipse.jdi.internal.MirrorImpl.requestVM(MirrorImpl.java:226) at org.eclipse.jdi.internal.VirtualMachineImpl.classesBySignature(VirtualMachineImpl.java:638) at org.eclipse.jdi.internal.VirtualMachineImpl.classesByName(VirtualMachineImpl.java:667) at org.eclipse.jdt.internal.debug.core.model.JDIDebugTarget.jdiClassesByName(JDIDebugTarget.java:1600) at org.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager.filterUnloadedTypes(JavaHotCodeReplaceManager.java:349) at org.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager.doHotCodeReplace(JavaHotCodeReplaceManager.java:460) at org.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager.access$0(JavaHotCodeReplaceManager.java:443) at org.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager$1.run(JavaHotCodeReplaceManager.java:315) at org.eclipse.debug.core.DebugPlugin$AsynchRunner.run(DebugPlugin.java:1091) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.debug.core.DebugPlugin$AsynchRunner.async(DebugPlugin.java:1074) at org.eclipse.debug.core.DebugPlugin$EventDispatchJob.run(DebugPlugin.java:428) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:53)!ENTRY org.eclipse.jdt.debug 4 125 2013-11-27 10:37:34.573!MESSAGE Internal error logged from JDI Debug: !STACK 0org.eclipse.jdi.TimeoutException: Timeout occurred while waiting for packet 47236. at org.eclipse.jdi.internal.connect.PacketReceiveManager.getReply(PacketReceiveManager.java:186) at org.eclipse.jdi.internal.connect.PacketReceiveManager.getReply(PacketReceiveManager.java:197) at org.eclipse.jdi.internal.MirrorImpl.requestVM(MirrorImpl.java:191) at org.eclipse.jdi.internal.MirrorImpl.requestVM(MirrorImpl.java:226) at org.eclipse.jdi.internal.VirtualMachineImpl.classesBySignature(VirtualMachineImpl.java:638) at org.eclipse.jdi.internal.VirtualMachineImpl.classesByName(VirtualMachineImpl.java:667) at org.eclipse.jdt.internal.debug.core.model.JDIDebugTarget.jdiClassesByName(JDIDebugTarget.java:1600) at org.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager.filterUnloadedTypes(JavaHotCodeReplaceManager.java:349) at org.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager.doHotCodeReplace(JavaHotCodeReplaceManager.java:460) at org.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager.access$0(JavaHotCodeReplaceManager.java:443) at org.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager$1.run(JavaHotCodeReplaceManager.java:315) at org.eclipse.debug.core.DebugPlugin$AsynchRunner.run(DebugPlugin.java:1091) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.debug.core.DebugPlugin$AsynchRunner.async(DebugPlugin.java:1074) at org.eclipse.debug.core.DebugPlugin$EventDispatchJob.run(DebugPlugin.java:428) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:53)!ENTRY org.eclipse.jdt.debug 4 125 2013-11-27 10:38:08.206!MESSAGE Internal error logged from JDI Debug: !STACK 0org.eclipse.jdi.TimeoutException: Timeout occurred while waiting for packet 47250. at org.eclipse.jdi.internal.connect.PacketReceiveManager.getReply(PacketReceiveManager.java:186) at org.eclipse.jdi.internal.connect.PacketReceiveManager.getReply(PacketReceiveManager.java:197) at org.eclipse.jdi.internal.MirrorImpl.requestVM(MirrorImpl.java:191) at org.eclipse.jdi.internal.MirrorImpl.requestVM(MirrorImpl.java:226) at org.eclipse.jdi.internal.VirtualMachineImpl.classesBySignature(VirtualMachineImpl.java:638) at org.eclipse.jdi.internal.VirtualMachineImpl.classesByName(VirtualMachineImpl.java:667) at org.eclipse.jdt.internal.debug.core.model.JDIDebugTarget.jdiClassesByName(JDIDebugTarget.java:1600) at org.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager.filterUnloadedTypes(JavaHotCodeReplaceManager.java:349) at org.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager.doHotCodeReplace(JavaHotCodeReplaceManager.java:460) at org.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager.access$0(JavaHotCodeReplaceManager.java:443) at org.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager$1.run(JavaHotCodeReplaceManager.java:315) at org.eclipse.debug.core.DebugPlugin$AsynchRunner.run(DebugPlugin.java:1091) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.debug.core.DebugPlugin$AsynchRunner.async(DebugPlugin.java:1074) at org.eclipse.debug.core.DebugPlugin$EventDispatchJob.run(DebugPlugin.java:428) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:53)!ENTRY org.eclipse.jdt.debug 4 125 2013-11-27 10:38:11.206!MESSAGE Internal error logged from JDI Debug: !STACK 0org.eclipse.jdi.TimeoutException: Timeout occurred while waiting for packet 47251. at org.eclipse.jdi.internal.connect.PacketReceiveManager.getReply(PacketReceiveManager.java:186) at org.eclipse.jdi.internal.connect.PacketReceiveManager.getReply(PacketReceiveManager.java:197) at org.eclipse.jdi.internal.MirrorImpl.requestVM(MirrorImpl.java:191) at org.eclipse.jdi.internal.MirrorImpl.requestVM(MirrorImpl.java:226) at org.eclipse.jdi.internal.VirtualMachineImpl.classesBySignature(VirtualMachineImpl.java:638) at org.eclipse.jdi.internal.VirtualMachineImpl.classesByName(VirtualMachineImpl.java:667) at org.eclipse.jdt.internal.debug.core.model.JDIDebugTarget.jdiClassesByName(JDIDebugTarget.java:1600) at org.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager.filterUnloadedTypes(JavaHotCodeReplaceManager.java:349) at org.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager.doHotCodeReplace(JavaHotCodeReplaceManager.java:460) at org.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager.access$0(JavaHotCodeReplaceManager.java:443) at org.eclipse.jdt.internal.debug.core.hcr.JavaHotCodeReplaceManager$1.run(JavaHotCodeReplaceManager.java:315) at org.eclipse.debug.core.DebugPlugin$AsynchRunner.run(DebugPlugin.java:1091) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.debug.core.DebugPlugin$AsynchRunner.async(DebugPlugin.java:1074) at org.eclipse.debug.core.DebugPlugin$EventDispatchJob.run(DebugPlugin.java:428) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:53)!SESSION 2013-11-27 10:59:34.250 -----------------------------------------------eclipse.buildId=4.3.0.M20130911-1000java.version=1.7.0_45java.vendor=Oracle CorporationBootLoader constants: OS=linux, ARCH=x86_64, WS=gtk, NL=en_USFramework arguments: -product org.eclipse.epp.package.jee.productCommand-line arguments: -os linux -ws gtk -arch x86_64 -product org.eclipse.epp.package.jee.product!ENTRY org.eclipse.core.resources 2 10035 2013-11-27 10:59:36.855!MESSAGE The workspace exited with unsaved changes in the previous session; refreshing workspace to recover changes.!ENTRY org.eclipse.jst.jsp.core 4 4 2013-11-27 10:59:51.818!MESSAGE A workspace crash was detected. The previous session did not exit normally. Not using saved taglib indexes.I'm currently seeing the stack trace fromin my Error Log using Luna RC2. Are you intending to do anything with this for Luna ?As well as the entries against 'org.eclipse.wst.xml.ui.disable.grammar.constraints'I also get errors against'org.eclipse.wst.xml.ui.reload.dependencies'	9.0
id=454112	REOPENED	Platform	UI	4.4	PC Linux	P3 normal	Platform-UI-Inbox	2014-12-04 07:21 EST by	Stephan Herrmann	2014-12-07 09:34 EST (	1 user	The command bound to Ctrl+_ - is named "Toggle Split Editor (Horizontal)"- is explained in the N&N as "splits the editor one above the other"So: one above the other == horizontal.Shouldn't we change all those views that have layout options "horizontal"/"vertical" to match the new scheme?:)Remember: 2 + 2 = 5	When the application model (before Eclipse 4.0) was defined horizontal got that meaning. Still confuses me too, but its to late to change that.(In reply to Lars Vogel from)By that you are saying everybody has already learned that 2 + 2 = 5.I cannot agree.What defines "too late"?BTW, how's the application model a justification for a Text in the UI?IIRC this follows SWT-SashForm logic of what horizontal / vertical mean - do you have a better wording which probably should not include horizontal / vertical?(In reply to Stephan Herrmann from)I guess Lars meant it is consistent with what vertical / horizontal mean in SWT, the application model, ...(In reply to Thomas Schindl from)Also with the model attribute name of a sash container.(In reply to Thomas Schindl from)Good question.Here's a list of views that have similar layout options: - Call Hierarchy (JDT) - Type Hierarchy (JDT) - JUnit - Variables (Debug) - Breakpoints (Debug) - Expressions (Debug) - Registers (Debug)*All* views in this list use "horizontal" to mean side-by-side and "vertical" for one-above-the-other.I found 1 view with a related but different option: - Git Staging [ ] Column LayoutSo, putting Git Staging aside, it is clear that horizonal and vertical are indeed the common terms in the Eclipse UI for this issue. It is also clear that terms "horizontal" and "vertical" commonly describe the placement of different view compartments, *not* the orientation of the sash between them. Using the same terms with different (opposite!) meaning is a severe UX-bug.I don't believe that "Column Layout"/"Row Layout" (see Git Staging) would improve the situation, since the terms "column"/"row" are commonly used within 2-dim tables, whereas the editor split should be seen as a 1-dim structure.The "one above the other" phrase from the N&N is a bit too clumsy for a command name.IMO, this issue will only be fully resolved when split editor follows the consistent use of existing terminology. Since just swapping the names of these commands will also create confusion among those that have already learned the wrong terminology, this should probably be resolved in two stages, e.g.:Mars: Toggle Split Editor (Side by side) Ctrol-{ Toggle Split Editor (Vertical) Ctrl-_By using "Side by side" for one option, the meaning of this option is beyond doubt. The (corrected) meaning of "Vertical" can easily be inferred from the contrast with "Side by side".Neptune: Toggle Split Editor (Horizontal) Ctrol-{ Toggle Split Editor (Vertical) Ctrl-_	7.0
id=460091	REOPENED	Platform	UI	4.5	PC Mac OS X	P3 normal	Platform-UI-Inbox	2015-02-17 06:58 EST by	Alex Blewitt	2015-02-23 16:39 EST (	3 users	The splash screen has a 1 pixel border on the right and bottom of the BMP on OSX.	CreatedSplash bitmapTaken from ./plugins/org.eclipse.platform_4.5.0.v20150203-1300/splash.bmpThis is intentional. See. If you were just "point it out", I think we can close as "worksforme". If you are saying "it looks bad", please re-open with a suggestion on how to improve (and satisfyat the same time).Re-opening as per previous comment.If the problem is that the dialog doesn't have an obvious edge due to the fade-to-white on the bottom right corner, the solution is to regenerate the background image such that it doesn't have a fade-to-white on the bottom right hand corner, not plaster some random pixelated border of any colour.There will always be a case where the background of the splash (as a whole) matches some standard background colour, but more often than not the Eclipse will be launched from an icon in the start menu/desktop/short key cut/dock. Whilst I agree with the sentiment thatraises, the solution to have an arbitrary border which looks awful on all operating systems isn't the right way of fixing it.In fact, Eclipse Luna had the same background and wasn't a concern there by many people; the new one looks much, much worse.Createddifference between Luna and Mars splachI've also tracked downwhere some change was introduced. (and, comparison in even Eclipse shows the difference).I actually thought this was a bug in SWT when I saw the black borders. I like the one on the right side better in the attachment. The black clashes to much with the purple/white colors. This is a matter of taste though :)	5.0
id=430872	REOPENED	Platform	UI	4.4	PC Windows 7	P3 normal	Platform-UI-Inbox	2014-03-21 08:41 EDT by	Dani Megert	2015-05-22 12:56 EDT (	2 users	The ACTIVE_TAB_BG_END must not be used to set view background and description background. Only the border should get that color.	CreatedThe CTabItem snapshot(In reply to Dani Megert from)Do you want to get the following effect - 'The CTabItem snapshot'?CreatedThe CTabItem snapshot with the 'e4 default' colors(In reply to Daniel Rolka from)Yes.Gerrit review link:DanielDaniel, could you please attach some CSS file(s) that I can use to check out the changes in the patch ?Also, a before / after screenshot with the same CSS would also help me test this out...(In reply to Eric Moffatt from)Just change it via preferences :-)Do we have a scheme that uses gradients on the tabs ?CreatedIssue in the 'e4 default blue' theme(In reply to Eric Moffatt from)Each 'e4 default' theme uses gradient on the tabs.Btw. regarding the gradients, I've noticed the issue in the patch that corrupts the 'e4 default blue' theme (see attachment). I will prepare the update for the patch that handles itDaniel(In reply to Daniel Rolka from)OK, I've pushed the altered patch to Gerrit that solves the issue above for the 'e4 default blue' theme. It is not perfect (there is a little flicking of the toolbar during resizing the part), but it works fine. Having thefixed we will be able to create sth betterDanielCreatedWith and without the patchLet me attach small snapshot that presents what we are trying to achieve with this patchDaniel(In reply to Daniel Rolka from)Your picture shows that the fix is not good yet: the borders around the view must keep the end color (as shown in the preview of the preference page).(In reply to Dani Megert from)Argh! Looks like this is not broken by your fix but by some other change done after M6 (there the border is present). Filed.(In reply to Dani Megert from)With the fix foreverything works as expected.Committed:Which color theme can I use to see this in action (i.e. like the screen cap) ?(In reply to Eric Moffatt from)Just set the color via preferences.(In reply to Eric Moffatt from)For the 'With and without the patch' snaphot you have to use the 'Windows XP Blue' oneDanielVerified in the build: I20140428-2000DanielThe fix forbrought this one back.CreatedThe gradient issueWe have to have the patch for thein order to fix it properly, see the snapshotDaniel	19.0
id=465663	REOPENED	Platform	UI	4.5	PC Linux	P3 minor	Platform-UI-Inbox	2015-04-28 05:38 EDT by	Lars Vogel	2016-04-03 05:25 EDT (	5 users	If I try to start Eclipse for an existing workspace or try to switch to it, I get the following error. A new workspace works fine.vogella@BigMachine:~/dev/Eclipse45_20150428a/eclipse$ ./eclipse Exception in thread "Event Loop Monitor" org.eclipse.swt.SWTException: Device is disposed at org.eclipse.swt.SWT.error(SWT.java:4491) at org.eclipse.swt.SWT.error(SWT.java:4406) at org.eclipse.swt.SWT.error(SWT.java:4377) at org.eclipse.swt.widgets.Display.error(Display.java:1186) at org.eclipse.swt.widgets.Display.asyncExec(Display.java:725) at org.eclipse.ui.internal.monitoring.EventLoopMonitorThread.run(EventLoopMonitorThread.java:489)	Works for me with I20150428-0100. Maybe some fallout fromon 64-bit machines? Please check logs/debug on your end.CreatedWorkspaceAttached my failing test workspace. I also get the same exception if I try to select this workspace via a runtime Eclipse. I do not see any additional log entry.Markus, does this workspace work for you? I'm using Ubuntu 14.10 with GTK3.Then just set some breakpoints, e.g. in Device#dispose(), in the EventLoopMonitorThread, and in DarkThemeProcessor.(In reply to Lars Vogel from)This workspace somehow got corrupted. It also doesn't start with 4.4 or 4.5 M6.The exception you pasted is just one of many that I see in the .log and most likely a follow-up error due to the workbench shutting down.(In reply to Dani Megert from)Starting the workspace with clearPersistedState makes it work again../eclipse -clearPersistedStateI assume an investigation here is not helpful, so I mark this bug as worksforme.An investigation would be helpful, but can only be done by someone from the E4 team who knows why introducing all this persisted state was a good idea.I'm currently unable to download this file but what are the other stacktraces - Markus refers to the fact that too many informations are store in the XMI-File. How did you came to this conclusion? So that once I have better WiFi I can take a look and don't have to start from scratch?(In reply to Thomas Schindl from)I did not see any other stacktraces.(In reply to Thomas Schindl from)If -clearPersistedState solves the problem without data loss, then too much is stored.CreatedLog file showing the errorI tried to unzip the zipped workspace in Windows 10x64, using 7zip, but there was an error during the extraction "the destination has 9 files with the same names" (see) So, I split into two tests: one replacing files and one keeping them. In both cases Eclipse does not start at all, and I can read in the log the same error: org.eclipse.core.internal.resources.ResourceException: The project description file (.project) for '.org.eclipse.jdt.core.external.folders' is missing. This file contains important information about the project. The project will not function properly until this file is restored. at org.eclipse.core.internal.localstore.FileSystemResourceManager.read(FileSystemResourceManager.java:889) at org.eclipse.core.internal.resources.SaveManager.restoreMetaInfo(SaveManager.java:903) at org.eclipse.core.internal.resources.SaveManager.restoreMetaInfo(SaveManager.java:883) ( etc .. )Root exception:org.eclipse.swt.SWTException: Device is disposed at org.eclipse.swt.SWT.error(SWT.java:4522) at org.eclipse.swt.SWT.error(SWT.java:4437) at org.eclipse.swt.SWT.error(SWT.java:4408) ( etc .. )See full log attached. Note: I opened the workspace with a newer version of Eclipse: Neon 4.6.0.I20160128-2000, but I get the same error even when using MarsCould you please try to reproduce the problem into another workspace and attach it?	10.0
id=465959	REOPENED	Platform	UI	4.5	All All	P3 enhancement	Platform-UI-Inbox	2015-04-30 11:35 EDT by	Dawid Pakula	2015-10-22 03:33 EDT (	1 user	As in subject, to be consistent with for example Open Type and Package Explorer.	Hmm, this functionality is already there in 4.5 M7. Could you attach some screenshots to illustrate the problem?I downloaded latest m7 build and it's not available.I'm talking about "Window working set" like in open type popup menu. I'll attach screenshot.CreatedOpen Type vs Open resource (item highlighted)Same difference is between Project Explorer and Package Explorer. "Window Working Set" is important if you want for example filter projects in Explorers based on working set selection in "Task List" view.Should I raise another bug or change title of this one?	4.0
id=475357	REOPENED	Platform	UI	4.5	PC Windows 10	P3 normal	Platform-UI-Inbox	2015-08-19 05:45 EDT by	Yann Zimmermann	2017-01-13 04:15 EST (	8 users	Trying to update at runtime the icon of a part but it does not work.@PostConstructpublic void postConstruct(Composite parent, EPartService partService, Branding currentBranding, IEclipseContext context) {... MPart part = partService.findPart(PARTID); URI logoUri = currentBranding.getLogo(); if (null != logoUri) { part.setIconURI(logoUri.toString()); part.setLabel("blabla"); }...}setLabel and setTooltip do their jobs however setIconURI does not change nothing. If there is already an iconURI in my Application.e4xmi, this icon is displayed but setIconURI does nothing even in this case: I can call it with any String, nothing happen.This bug now happen with Mars, the above code worked well with Luna.	Simon, can you have a look?I'm guessing that your part has an overridden icon: it's added as a transient state element to the part. Try removing it and see if that helps: part.getTransientData().remove(IPresentationEngine.OVERRIDE_ICON_IMAGE_KEY);Perhaps the CleanupAddon should listen for ICON_URI changes and remove the override icon?Thanks for your answer.Trying the suggested correction did not resolve the problem. However, by inspecting the Map retuned by getTransientData(), I have seen there is only on entry, with the key "IconUriForPart" and no value (there is no default icon in the application).So, with the following correction, my icon is displayed:part.getTransientData().remove("IconUriForPart");I did not find a public constant for that String "IconUriForPart", there is a private static constant ICON_URI_FOR_PART in org.eclipse.e4.ui.workbench.renderers.swt.SWTPartRendererThanks for your helpWorks via tip from BrianThis workaround, to remove an unpublished key, doesn't seem like a good thing. The key was brought in as part of. I'll re-open that bug: there needs to be some discussion about it.With my target at the latest Mars release I still cannot set the icon of an MPart dynamically without removing the "IconUriForPart" map entry.Brian states that removing a completely out-of-the blue tag from a map is not a good workaround, and I agree. Unfortunately, none of the two referenced bugs seems to actually fix the issue:which introduced the problem only references this one andwhich is supposed to be the one fixing the issue but only fixes issues with the spys as far as I can tell.I propose re-opening this bug.Working with and targeting Neon.1 still shows this bug and the (not-so-pretty) workaround still works.Therefore I support Alexander's suggestion to re-open this bug.Thanks!I see no comment *why* it was closed at all, and I agree the proposed workaround is dirty, so reopening.Event registration for the icon change seems missing in StackRendererSomething like this: @Inject @Optional private void subscribeTopicIconChanged(@UIEventTopic(UIEvents.UILabel.TOPIC_ICONURI) Event event) { // TODO update the icon in the part, see updateClosableTab }@Simon, can you take this one? This is similar to the close fix.	10.0
id=478292	REOPENED	Platform	IDE	4.5	PC Linux	P3 normal	Platform-UI-Inbox	2015-09-24 06:00 EDT by	yichen tang	2015-09-24 08:08 EDT (	3 users	char[] chars = new char[5]; chars[0] = 'h'; chars[1] = 'i'; String s = String.copyValueOf(chars); System.out.println("ss:" + s); System.out.println("s length: " + s.length()); System.out.println("s+:" + s + " world");// it only display hi NOT world after it	This does not sound like an Eclipse error.I tried the same code in Intellj its ok.I tried export jar and run it in console, its ok.I tried in eclipse with Mac, its ok.I tried different jvm in eclipse, its not ok.(In reply to Lars Vogel from)Here is the simplified example:public class Snippet { public static void main(String[] args) { char[] chars = new char[4]; chars[0] = 'h'; chars[1] = 0; chars[2] = 'i'; chars[3] = '!'; String s = String.copyValueOf(chars); System.out.println("s length: " + s.length()); System.out.println("s:" + s);// it only display h }}Eclipse console:##########s length: 4s:h##########shell:##########java -cp . Snippet s length: 4s:hi!##########The important thing here is the "char [1] = 0" which writes "zero" middle in the string. Looks like console UI stops reading from the program output at first "zero" character.	3.0
id=478336	REOPENED	Platform	UI	4.5	PC Linux	P3 normal	Platform-UI-Inbox	2015-09-24 12:39 EDT by	Lars Vogel	2016-07-26 09:20 EDT (	4 users	+++ This bug was initially created as a clone of+++I frequently see methods like this:@Overridepublic void initialize(AnimationEngine engine) { // TODO Auto-generated method stub background = tabItem.getParent().getBackground(); display = tabItem.getParent().getDisplay();}Such TODOs should be removed from our code basis.	I also plan to to minor formating updates during this removal but no functional chanagesNew Gerrit change created:Gerrit changewas merged to [master].Commit:merged 1 month ago...Still lots of other placesMass move to 4.7 as M7 is approaching. Please move back in case you are planning to fix it for Neon.New Gerrit change created:New Gerrit change created:(In reply to Friederike Schertel from)whoops... didn't realize this was created automatically. xD Sorry for the spam.Gerrit changewas merged to [master].Commit:	10.0
id=477391	REOPENED	Platform	UI	4.6	All All	P3 enhancement	Platform-UI-Inbox	2015-09-14 14:15 EDT by	Alex Blewitt	2016-08-19 09:39 EDT (	13 users	As discussed in, the use of an ImageRegistry to cache images based on an ImageDescriptor is a good way of avoiding creating images until they are required; however, if there may be multiple variations of an image (based on windowing system, operating system, or even localised for a different locale) then there may be multiple calls to the filing system to determine the file name to use for the image. Given that we know we don't need that image immediately we can defer the cost of the file lookup and perform the search only when the image data is requested.This can be used to optimise access in places like WorkbenchImages.declareImages() and JFaceResources.initializeDefaultImages(), which currently perform a lookup using a FileLocator.find(Bundle) first and then fallback to a createFromFile operation instead.	The code might look something like:static class DefferedImageDescriptor { DefferedImageDescriptor(String bundle, String path) { this.bundle = bundle; this.path = path; } ImageData getImageData() { return ImageDescriptor.createFromURL(BundleUtility.find(PlatformUI.PLUGIN_ID,path).getImageData(); }}and then be called like: private final static void declareImage(String key, String path, boolean shared) { ImageDescriptor desc = new DefferedImageDescriptor(String bundle, String path); declareImage(key, desc, shared); }I'd think this should be rolled into ImageDescriptor since its purpose is to defer the actual image creation? If needed, we could have a debug flag / property to force resolving on creation to surface unresolved files earlier.(In reply to Brian de Alwis from)Great idea Brian. This would maximize the benefit of this development without creating any additional API.@Alex, I assigned this bug to you, as I assume you plan to work on this.Does JFace target Java 8 yet? If so we could take a Supplier<URL> which would only attempt to look up the image when requested.(In reply to Alex Blewitt from)Yes :-)OK - in that case we can have a ImageDescriptor.createFromURL(Supplier<URL>) which could defer the lookup until the image data is requested. It might be tricky to integrate with the URL descriptor because if the supplier returns null we need to use the MissingInstanceDescriptor instead.Given the URL often has a bundle and file component, which is created to form a URL and then decomposed to look it up, it might make sense to have a separate one that takes a Bundle and a path as well. I'll do some prototypes and measure the results before I submit a Gerrit review.Re:I think it's much better to write a descriptor that does something specific for Bundle + path (as mentioned in) than to take a Supplier. A critical part of the *Descriptor classes are their hashCode + equals methods, since they're used as hash keys everywhere.If we wrote one that took Supplier, callers would be very tempted to invoke it with lambdas (which won't have hashCode and equals implemented on them). That means we'd have all sorts of *Descriptor instances floating around the system that we aren't refcounting properly.A custom descriptor that is hardcoded to work with bundle + path can also have a good hashCode + equals implementation, ensuring that everyone that uses it will always do the right thing.I'd also suggest that we use Strings, IPaths, or URIs rather than URLs since the hashCode and equals method on URL is severely broken.No plans for me to work on this at the moment, re-assigning to inbox.I'll take this.***has been marked as a duplicate of this bug. ***Actually, now that I think about it more, lambdas aren't a bad idea. As long as you cached and reused the same ImageDescriptor instance (which we do in most cases), there would be no problem with ref counting....but perhaps we should use something more like ImageDescriptor.createFromURL(Supplier<ImageData>)New Gerrit change created:Gerrit changewas merged to [master].Commit:Fixed, using the lambda approach.Thanks for the patch, Sergey!This change broke a few things and will be reverted for M5. It came in too late and has apparently not been tested.For one, there's.And then I saw a "Pin Editor" spelled out in the workbench toolbar.Steps:- new workspace- pastepackage p;public class C { public static void main(String[] args) { int i= 2; System.out.println(i); }}- Preferences > General > Editors: Enable "Close editors automatically"Reverted withI tried to debug the problem with the "Pin Editor" button and had to filefor JDT Debug to fix conditional breakpoints for lambdas. I manually stepped over the delayed image creations, and I didn't see a request for a "pin" icon.I guess the problem is that infamous E4 model adapter layer bridge still inspects the ImageDescriptor instances and only "works" if they are actually URLImageDescriptors.org.eclipse.ui.internal.menus.MenuHelper#getIconURI(ImageDescriptor, IEclipseContext) looks like it's the bad guy.Okay. Thanks for catching and reverting this, Markus.We'll look into a fix early post-M4. E4 should be respecting ImageDescriptor's API contracts and shouldn't be breaking the abstraction layer.3.x icons were specified as paths or URLs in extension points. The grottiness in MenuHelper wasn't an unreasonable assumption.There are a bunch of things we could do here (and we could do several of them): 1. Provide a clean way to adapt an ImageDescriptor to a File or URL We could have ImageDescriptor support IAdaptable? That doesn't help the Supplier approach. 2. Do what I suggested inand move the deferral into ImageDescriptor instead. 3. We could add support for data: URLs and encode non-URL & non-File ImageDescriptors 4. We could add support for a custom URL type to do an XPath-style lookup against the extension registry. E.g., x-registry:/org.eclipse.ui.views/view[@id=%27org.eclipse.ui.console%27]/@iconSupporting lambda/Suppliers is definitely useful, but I don't think it makes sense to wrap everything within them.In fact we could get most of bang for this bug just by changing WorkbenchImages#declareImage() and remove the call to FileLocator:@@ -107,10 +105,14 @@ public/*final*/class WorkbenchImages { */ private final static void declareImage(String key, String path, boolean shared) {- declareImage(key, ImageDescriptor.createFromSupplier(()-> {- URL url = FileLocator.find(Platform.getBundle(PlatformUI.PLUGIN_ID), new Path(path), null);- return ImageDescriptor.createFromURL(url).getImageData();- }), shared);+ try {+ URL url = new URL("platform:/plugin/" + PlatformUI.PLUGIN_ID + "/" + path); //$NON-NLS-1$ //$NON-NLS-2$+ ImageDescriptor desc = ImageDescriptor.createFromURL(url);+ declareImage(key, desc, shared);+ } catch (MalformedURLException e) {+ // TODO Auto-generated catch block+ e.printStackTrace();+ } }And remove(In reply to Brian de Alwis from)I really meant the following, which removes the unnecessary call to BundleUtility.find():@@ -103,9 +104,14 @@ public/*final*/class WorkbenchImages { */ private final static void declareImage(String key, String path, boolean shared) {- URL url = BundleUtility.find(PlatformUI.PLUGIN_ID, path);- ImageDescriptor desc = ImageDescriptor.createFromURL(url);- declareImage(key, desc, shared);+ try {+ URL url = new URL("platform:/plugin/" + PlatformUI.PLUGIN_ID + "/" + path); //$NON-NLS-1$ //$NON-NLS-2$+ ImageDescriptor desc = ImageDescriptor.createFromURL(url);+ declareImage(key, desc, shared);+ } catch (MalformedURLException e) {+ // TODO Auto-generated catch block+ e.printStackTrace();+ } }Re:If we wanted to use the adapter system to provide an opt-in interface to certain subclasses, we could use the adapters extension point. No need to implement IAdaptable on ImageDescriptor.However, a new method on ImageDescriptor might be best if we really wanted to be in the business converting ImageDescriptors to URIs. That would make it easier for people to understand the API contracts. MenuHelper.getIconURI would then reduce to a simple call to the new method. If we were to do this then the new Supplier-based API should be returning a URI rather than an ImageData.(While we're on the subject, I notice that MenuHelper is using the wrong algorithm for requesting adapters. It should really be calling Adapters.adapt).I guess we may need to do something like this in order to respect the API contracts on ImageDescriptor (which isn't required to point to a file on disk). Othewise we'd end up with two types ImageDescriptor, those that can be used with the workbench model-based APIs and those that cannot. I'm not fond of the memory cost this may create, since we may end up with objects holding onto a URI that don't realize they're retaining a large amount of memory by doing so.Temp files are another approach, but I'm not sure how we could safely clean them up.What was the motivition for making the E4 workbench pass around URIs rather than using the ImageDescriptors themselves for describing images?(In reply to Stefan Xenos from)E4 is not dependent on SWT or JFace. For example Tom Schindl offers a solution to develop e4 RCP with JavaFX.I get it.Well, if we're going to fix this without breaking the barrier between e4 and JFace, I think it would make sense to put a getURL method right on ImageDescriptor. That would make the contract explicit and it would mean that any user-defined ImageDescriptor classes would at least have the option of working correctly with e4.I also like Brian's suggestion in, but I'm not sure it would work for JFaceResources since osgi might not be running.(In reply to Stefan Xenos from)Not all URLs/URIs are created equal. Some of the contortions of MenuHelper are to rewrite URLs to a more stable format as the URLs produced from a URLImageDescriptor are bundle resource: or bundleentry: URLs that may change between executions or on restarts of the OSGi framework.I mentioned being able to adapt to a java.o.File as URLs aren't necessarily sufficient for all cases either. Some of the work I'm doing onwith enhancing the Welcome/Intro require writing out references to images in HTML that can be loaded by the SWT Browser.I don't disagree. And where it receives an IEclipseContext, it should be trying to pull out the org.eclipse.e4.core.services.adapter.Adapter instance too.In addition to what Lars said, E4 supports serialization out of the UI model, currently implemented using EMF. data: URLs work for a (literally) small class of images as they are effectively limited to 2038 characters.One thing to keep in mind when starting to cache images is the ongoing work for HDPI support. Markus, please comment if the proposed solution makes it hard to choose the right image for a given resolution as per the current approach that we're taking.(In reply to Dani Megert from)A solution that relies on URIs is fine. A solution that ultimately caches URLImageDescriptor#getImageData() is not. Converting a file-based Image/ImageDescriptor to ImageData and then creating an Image from the ImageData would also be a bad idea (unnecessary overhead; wouldn't use efficient native image loading).The HiDPI support that is already in URLImageDescriptor [1] requires clients to use createImage(..) and would be broken by any use of ImageData. ImageDatas only contain a single resolution and are not appropriate in any code that need multi-resolution images.[1] Currently disabled. I'll work on that for M5 via. The SWT APIs are not yet ready, so there's nothing I can currently recommend for testing.Please put this bug on hold for now. I've moved the target milestone to M6 to make sure it doesn't fall through the cracks.The BundleUtility/FileLocator#find(..) call in WorkbenchImages#getWorkbenchImageDescriptor(String) will most likely be removed as part of, and the responsibility for calling FileLocator#find(..) will be moved into URLImageDescriptor#createImage(..). This is required because HiDPI icons can be contributed by separate bundles, and therefore the platform:/... URLs must not be resolved upfront.I'll work on this in M5 with top priority. The best way to avoid delays is not to release other bad changes to the SDK that absorb my attention.Re:Wouldn't what I proposed, above (adding a getURL() method to ImageDescriptor), fit in nicely with what you're working on?(In reply to Markus Keller from)Markus, is your HDPI work still blocking this bug? Having a deferred way to create ImageDescriptors in JFace is highly desired.(In reply to Lars Vogel from)The SWT changes were only done very late in M6. I'll work on the adoption in M7.Removing Stefan as assignee, AFAIK he is busy with his JDT core work.	33.0
id=467735	REOPENED	Platform	UI	4.6	PC Mac OS X	P3 normal	Platform-UI-Inbox	2015-05-20 12:13 EDT by	Andreas Sewe	2016-07-08 10:00 EDT (	1 user	CreatedThe PDE manifest form-based editor with text selectionJust noticed this when opening a MANIFEST.MF file with PDE's form-based editor. The pre-selected "ID" field is very hard to read using the dark them (see the attached screenshot).Tested with Mars RC1.	Createdimage: selected text is readable in Eclipse NeonFixed in Neon, closed as fixed.Createdimage: selected text looks bad in Eclipse NeonErgo, I can reproduce the issue in Eclipse Neon under Mac OSThe previous image was taken under Linux Ubuntu. details:Eclipse SDKVersion: Neon (4.6)Build id: I20160606-1100see above	3.0
id=481656	REOPENED	Platform	UI	4.6	PC Windows 10	P3 normal	Platform-UI-Inbox	2015-11-07 21:40 EST by	Timo Kinnunen	2015-11-10 03:03 EST (	3 users	I have installed a very simple plugin to automatically save any files whenever Eclipse loses focus. The plugin works by listening for the windowDeactivated event and then calling WorkbenchPage.saveAllEditors on receiving one. If I have an Untitled Text File open and dirty and I switch to any other window on the computer, then Eclipse and its UI immediately breaks. The workbench enters an infinite recursion and it won't recover after that. Using Alt-F4 repeatedly is the only somewhat clean way of shutting down.This is the infinite recursion:2015-11-08 02:56:58"main" - Thread t@1 java.lang.Thread.State: RUNNABLE at org.eclipse.swt.internal.win32.OS.WaitMessage(Native Method) at org.eclipse.swt.widgets.Display.sleep(Display.java:4728) at org.eclipse.jface.window.Window.runEventLoop(Window.java:819) at org.eclipse.jface.window.Window.open(Window.java:794) at org.eclipse.jface.dialogs.MessageDialog.open(MessageDialog.java:396) at org.eclipse.ui.internal.ide.dialogs.InternalErrorDialog.open(InternalErrorDialog.java:81) at org.eclipse.ui.internal.ide.IDEWorkbenchErrorHandler.openQuestionDialog(IDEWorkbenchErrorHandler.java:190) at org.eclipse.ui.internal.ide.IDEWorkbenchErrorHandler.handleException(IDEWorkbenchErrorHandler.java:145) at org.eclipse.ui.internal.ide.IDEWorkbenchErrorHandler.access$0(IDEWorkbenchErrorHandler.java:137) at org.eclipse.ui.internal.ide.IDEWorkbenchErrorHandler$1.runInUIThread(IDEWorkbenchErrorHandler.java:112) at org.eclipse.ui.progress.UIJob$1.run(UIJob.java:97) at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35) at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135) - locked <cb2220c> (a org.eclipse.swt.widgets.RunnableLock) at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4155) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3772) at org.eclipse.jface.window.Window.runEventLoop(Window.java:818) at org.eclipse.jface.window.Window.open(Window.java:794) at org.eclipse.ui.texteditor.AbstractDecoratedTextEditor.performSaveAs(AbstractDecoratedTextEditor.java:1586) at org.eclipse.ui.texteditor.AbstractTextEditor.doSave(AbstractTextEditor.java:4853) at org.eclipse.ui.texteditor.AbstractTextEditor$TextEditorSavable.doSave(AbstractTextEditor.java:7209) at org.eclipse.ui.Saveable.doSave(Saveable.java:216) at org.eclipse.ui.internal.SaveableHelper.doSaveModel(SaveableHelper.java:357) at org.eclipse.ui.internal.SaveablesList$3.run(SaveablesList.java:665) at org.eclipse.ui.internal.SaveableHelper$5.run(SaveableHelper.java:285) at org.eclipse.jface.operation.ModalContext.runInCurrentThread(ModalContext.java:460) at org.eclipse.jface.operation.ModalContext.run(ModalContext.java:368) at org.eclipse.ui.internal.WorkbenchWindow$14.run(WorkbenchWindow.java:2156) at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70) at org.eclipse.ui.internal.WorkbenchWindow.run(WorkbenchWindow.java:2152) at org.eclipse.ui.internal.SaveableHelper.runProgressMonitorOperation(SaveableHelper.java:293) at org.eclipse.ui.internal.SaveablesList.saveModels(SaveablesList.java:675) at org.eclipse.ui.internal.WorkbenchPage.saveAll(WorkbenchPage.java:3646) at org.eclipse.ui.internal.WorkbenchPage.saveAllEditors(WorkbenchPage.java:3624) at org.eclipse.ui.internal.WorkbenchPage.saveAllEditors(WorkbenchPage.java:3567) at autosave.AutoSaveActivator$1.windowDeactivated(AutoSaveActivator.java:91)[... repeats many times, then ...] at autosave.AutoSaveActivator$1.windowDeactivated(AutoSaveActivator.java:91) at org.eclipse.ui.internal.Workbench$12.run(Workbench.java:1066) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.internal.Workbench.fireWindowDeactivated(Workbench.java:1063) at org.eclipse.ui.internal.WorkbenchWindow$15.shellDeactivated(WorkbenchWindow.java:2295) at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:111) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4362) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1113) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1137) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1118) at org.eclipse.swt.widgets.Decorations.WM_ACTIVATE(Decorations.java:1722) at org.eclipse.swt.widgets.Shell.WM_ACTIVATE(Shell.java:2244) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4673) at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:339) at org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1669) at org.eclipse.swt.widgets.Shell.windowProc(Shell.java:2166) at org.eclipse.swt.widgets.Display.windowProc(Display.java:5050) at org.eclipse.swt.internal.win32.OS.BringWindowToTop(Native Method) at org.eclipse.swt.widgets.Decorations.bringToTop(Decorations.java:231) at org.eclipse.swt.widgets.Shell.open(Shell.java:1268) at org.eclipse.jface.window.Window.open(Window.java:790) at org.eclipse.ui.texteditor.AbstractDecoratedTextEditor.performSaveAs(AbstractDecoratedTextEditor.java:1586) at org.eclipse.ui.texteditor.AbstractTextEditor.doSave(AbstractTextEditor.java:4853) at org.eclipse.ui.texteditor.AbstractTextEditor$TextEditorSavable.doSave(AbstractTextEditor.java:7209) at org.eclipse.ui.Saveable.doSave(Saveable.java:216) at org.eclipse.ui.internal.SaveableHelper.doSaveModel(SaveableHelper.java:357) at org.eclipse.ui.internal.SaveablesList$3.run(SaveablesList.java:665) at org.eclipse.ui.internal.SaveableHelper$5.run(SaveableHelper.java:285) at org.eclipse.jface.operation.ModalContext.runInCurrentThread(ModalContext.java:460) at org.eclipse.jface.operation.ModalContext.run(ModalContext.java:368) at org.eclipse.ui.internal.WorkbenchWindow$14.run(WorkbenchWindow.java:2156) at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70) at org.eclipse.ui.internal.WorkbenchWindow.run(WorkbenchWindow.java:2152) at org.eclipse.ui.internal.SaveableHelper.runProgressMonitorOperation(SaveableHelper.java:293) at org.eclipse.ui.internal.SaveablesList.saveModels(SaveablesList.java:675) at org.eclipse.ui.internal.WorkbenchPage.saveAll(WorkbenchPage.java:3646) at org.eclipse.ui.internal.WorkbenchPage.saveAllEditors(WorkbenchPage.java:3624) at org.eclipse.ui.internal.WorkbenchPage.saveAllEditors(WorkbenchPage.java:3567) at autosave.AutoSaveActivator$1.windowDeactivated(AutoSaveActivator.java:91) at org.eclipse.ui.internal.Workbench$12.run(Workbench.java:1066) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.internal.Workbench.fireWindowDeactivated(Workbench.java:1063) at org.eclipse.ui.internal.WorkbenchWindow$15.shellDeactivated(WorkbenchWindow.java:2295) at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:111) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4362) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1113) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1137) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1118) at org.eclipse.swt.widgets.Decorations.WM_ACTIVATE(Decorations.java:1722) at org.eclipse.swt.widgets.Shell.WM_ACTIVATE(Shell.java:2244) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4673) at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:339) at org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1669) at org.eclipse.swt.widgets.Shell.windowProc(Shell.java:2166) at org.eclipse.swt.widgets.Display.windowProc(Display.java:5050) at org.eclipse.swt.internal.win32.OS.BringWindowToTop(Native Method) at org.eclipse.swt.widgets.Decorations.bringToTop(Decorations.java:231) at org.eclipse.swt.widgets.Shell.open(Shell.java:1268) at org.eclipse.jface.window.Window.open(Window.java:790) at org.eclipse.search.internal.ui.OpenSearchDialogAction.run(OpenSearchDialogAction.java:54) at org.eclipse.search.internal.ui.OpenSearchDialogAction.run(OpenSearchDialogAction.java:45) at org.eclipse.ui.internal.handlers.ActionDelegateHandlerProxy.execute(ActionDelegateHandlerProxy.java:299) at org.eclipse.ui.internal.handlers.E4HandlerProxy.execute(E4HandlerProxy.java:90) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at org.eclipse.e4.core.internal.di.MethodRequestor.execute(MethodRequestor.java:56) at org.eclipse.e4.core.internal.di.InjectorImpl.invokeUsingClass(InjectorImpl.java:279) at org.eclipse.e4.core.internal.di.InjectorImpl.invoke(InjectorImpl.java:261) at org.eclipse.e4.core.contexts.ContextInjectionFactory.invoke(ContextInjectionFactory.java:132) at org.eclipse.e4.core.commands.internal.HandlerServiceHandler.execute(HandlerServiceHandler.java:152) at org.eclipse.core.commands.Command.executeWithChecks(Command.java:494) at org.eclipse.core.commands.ParameterizedCommand.executeWithChecks(ParameterizedCommand.java:491) at org.eclipse.e4.core.commands.internal.HandlerServiceImpl.executeHandler(HandlerServiceImpl.java:210) at org.eclipse.e4.ui.bindings.keys.KeyBindingDispatcher.executeCommand(KeyBindingDispatcher.java:286) at org.eclipse.e4.ui.bindings.keys.KeyBindingDispatcher.press(KeyBindingDispatcher.java:507) at org.eclipse.e4.ui.bindings.keys.KeyBindingDispatcher.processKeyEvent(KeyBindingDispatcher.java:558) at org.eclipse.e4.ui.bindings.keys.KeyBindingDispatcher.filterKeySequenceBindings(KeyBindingDispatcher.java:378) at org.eclipse.e4.ui.bindings.keys.KeyBindingDispatcher.access$0(KeyBindingDispatcher.java:324) at org.eclipse.e4.ui.bindings.keys.KeyBindingDispatcher$KeyDownFilter.handleEvent(KeyBindingDispatcher.java:86) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Display.filterEvent(Display.java:1266) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1112) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1137) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1122) at org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:1164) at org.eclipse.swt.widgets.Widget.sendKeyEvent(Widget.java:1160) at org.eclipse.swt.widgets.Widget.wmChar(Widget.java:1581) at org.eclipse.swt.widgets.Control.WM_CHAR(Control.java:4795) at org.eclipse.swt.widgets.Canvas.WM_CHAR(Canvas.java:343) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4676) at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:339) at org.eclipse.swt.widgets.Display.windowProc(Display.java:5050) at org.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method) at org.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:2550) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3767) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$4.run(PartRenderingEngine.java:1132) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:336) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1023) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:157) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:654) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:336) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:598) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:139) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:388) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:243) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:669) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:608) at org.eclipse.equinox.launcher.Main.run(Main.java:1515) Locked ownable synchronizers: - NoneThis was tested on Eclipse SDK Version: Neon (4.6) Build id: N20151003-1500andEclipse auto save plugin available from Update Site -	This sounds like an issue of the third party plugin, ergo the Platform UI it is not responsible. I'm going to close this bug as WORKSFORMEIf you're interested in using the plugin, contact the authors, as it sounds like the autosave, on focus lost, sets the focus again on editor, and loops. For general questions on Eclipse Platform, please use the forums.This looks like an issue of the third party plugin. Closing as WORKSFORMEThese are the problems that I have identified:1. WorkbenchPage.saveAllEditors is called with confirm being false, so that the user is not prompted to confirm the command. Despite the parameter, Untitled Text File editor still prompts, to ask for a file name. With confirm being false it should either not save and have saveAllEditors return false or save to a temporary file and have it return true. 2. The Save file dialog is displayed while the windowDeactivated event handler hasn't returned. This is one part required for the infinite recursion.3. When the save file dialog pops up, the shell is deactivated, which causes another windowDeactivated event to fire, despite the execution already being inside a windowDeactivated handler. In response, the plugin asks Workbench to save all dirty editors. Workbench still hasn't saved them, so it starts saving the editors again, Untitled Text File tries to put up another prompt and all hell breaks loose.Here's the source code for the plugin, available under Apache 2:For a plugin of about 10 lines of implementing code the resulting breakage is quite impressive.Let's see what we can do to avoid such breakage	4.0
id=486215	REOPENED	Platform	IDE	4.5.1	Macintosh Mac OS X	P3 major	Platform-UI-Inbox	2016-01-20 21:00 EST by	Ari Carr	2016-04-11 18:40 EDT (	1 user	I like to save my work all the time while working on something, but when I hit Command-S to save my work and then start typing more, any keys that I press while the "save" progress bar is running don't register, even after the save is finished. Please fix this!-- Configuration Details --Product: Eclipse 4.5.1.20150917-1200 (org.eclipse.epp.package.java.product)Installed Features: org.eclipse.platform 4.5.1.v20150904-0015	We need a better description to start investigating. Please provide a clear description of the problem.Closing, not enough information. Please re-open if the problem persists.see previous commentSaving Eclipse files always takes a few seconds. Microsoft Word has conditioned me to assume I can hit Command-S and then just keep typing, and the computer will catch up with me. In Eclipse, when I hit Save and then immediately continue typing, any keystrokes I make during the save process are totally ignored. Please fix this so that I can hit save and then continue typing and my keystrokes will continue to be logged during the save process. Thank you!If this isn't enough information, please let me know what other details you would like me to provide.Thanks for your interest in making Eclipse better. 1. Which is the editor slow in saving ?2. Which Eclipse are you running, is the Eclipse for Java ?3. Which extra plug-ins do you installed on your Eclipse ?I would like to get more information so we can understand and fix the problem.As first thing, I will need to know if there is a particular editor that is slow in saving. Is the Java editor slow in saving?Then, I would like to know which Eclipse you installed, and which plug-ins you added to your Eclipse installation. Finally, it would be good having further details, as an example a video showing the issue, or maybe the log file, to check if there is some error We can not investigate without proper information.	6.0
id=479217	REOPENED	Platform	UI	4.6	All All	P3 normal	Platform-UI-Inbox	2015-10-07 05:08 EDT by	Dani Megert	2016-04-12 15:38 EDT (	6 users	N20151005-0945 and following builds.B has lost data in the process of save/restorejunit.framework.AssertionFailedError: B has lost data in the process of save/restoreat org.eclipse.ui.tests.api.IAggregateWorkingSetTest.testWorkingSetSaveRestoreAggregates(IAggregateWorkingSetTest.java:273)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:692)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:319)at org.eclipse.test.UITestApplication$2.run(UITestApplication.java:197)at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135)at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3795)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3434)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$4.run(PartRenderingEngine.java:1132)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:336)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1023)at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:157)at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:654)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:336)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:598)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:139)at org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:140)at org.eclipse.test.UITestApplication.run(UITestApplication.java:62)at org.eclipse.test.UITestApplication.start(UITestApplication.java:212)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:388)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:243)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:669)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:608)at org.eclipse.equinox.launcher.Main.run(Main.java:1515)at org.eclipse.equinox.launcher.Main.main(Main.java:1488)at org.eclipse.core.launcher.Main.main(Main.java:34)	cc-ing Lars and Stefan who made most changes around the time it started to fail.(In reply to Dani Megert from)IIRC this test fails on my local machine if I run it with GTK3. Did we change something in our test setup?(In reply to Lars Vogel from)It fails on all platforms (see summary).Able to reproduce in a local debugging session.Working set "C" is missing from the working set manager after it is restored, so when aggregate working set "B" tries to restore its state, it can't find C. That triggers the failure.C is missing because the working set manager fires a change event while it is still in the process of restoring the memento. Here's the stack trace that triggers realization of B (below).WorkingSetManager.restoreWorkingSetState(IMemento) is still midway through restoring the working sets when it fires a property change via internalAddWorkingSet.BreakpointSetOrganizer is listening to the property change and asks for the elements synchronously.This triggers realization of the working set in AggregateWorkingSet.restoreWorkingSet(), but it can't restore its contents from the working set manager because the manager is still in the process of restoring itself.Most likely, the thing that changed recently is that BreakpointSetOrganizer is now listening to the property changes and wasn't previously. This isn't necessarily a bug (although I'll still investigate why it is happening). It's fortunate that it did happen, though, because it revealed a bug in WorkingSetManager: namely, that it fires change events while it is midway through restoring its state.This may have been a long-standing bug. We probably just weren't testing the case where there are listeners attached to the working set manager which ask for an aggregate's componontes at the time we restore the manager.AggregateWorkingSet.restoreWorkingSet() line: 272 AggregateWorkingSet(AbstractWorkingSet).getElementsArray() line: 169 AggregateWorkingSet(AbstractWorkingSet).getElements() line: 157 BreakpointSetOrganizer.propertyChange(PropertyChangeEvent) line: 156 AbstractWorkingSetManager$6$1.run() line: 394 SafeRunner.run(ISafeRunnable) line: 42 AbstractWorkingSetManager$6.run() line: 402 WorkingSetManager(AbstractWorkingSetManager).firePropertyChange(String, Object, Object) line: 408 WorkingSetManager(AbstractWorkingSetManager).internalAddWorkingSet(IWorkingSet) line: 243 WorkingSetManager(AbstractWorkingSetManager).restoreWorkingSetState(IMemento) line: 505 WorkingSetManager.restoreWorkingSetState(IMemento) line: 184 NativeMethodAccessorImpl.invoke0(Method, Object, Object[]) line: not available [native method] NativeMethodAccessorImpl.invoke(Object, Object[]) line: 62 DelegatingMethodAccessorImpl.invoke(Object, Object[]) line: 43 Method.invoke(Object, Object...) line: 497 IAggregateWorkingSetTest.invokeMethod(Class, String, Object, Object[], Class[]) line: 335 IAggregateWorkingSetTest.saveRestoreWorkingSetManager() line: 322 IAggregateWorkingSetTest.testWorkingSetSaveRestoreAggregates() line: 258 NativeMethodAccessorImpl.invoke0(Method, Object, Object[]) line: not available [native method] NativeMethodAccessorImpl.invoke(Object, Object[]) line: 62 DelegatingMethodAccessorImpl.invoke(Object, Object[]) line: 43 Method.invoke(Object, Object...) line: 497 IAggregateWorkingSetTest(TestCase).runTest() line: 176 IAggregateWorkingSetTest(TestCase).runBare() line: 141 TestResult$1.protect() line: 122 TestResult.runProtected(Test, Protectable) line: 142 TestResult.run(TestCase) line: 125 IAggregateWorkingSetTest(TestCase).run(TestResult) line: 129 TestSuite.runTest(Test, TestResult) line: 252 TestSuite.run(TestResult) line: 247 JUnit38ClassRunner.run(RunNotifier) line: 86 JUnit4TestReference.run(TestExecution) line: 86 TestExecution.run(ITestReference[]) line: 38 RemotePluginTestRunner(RemoteTestRunner).runTests(String[], String, TestExecution) line: 459 RemotePluginTestRunner(RemoteTestRunner).runTests(TestExecution) line: 675 RemotePluginTestRunner(RemoteTestRunner).run() line: 382 RemotePluginTestRunner.main(String[]) line: 62 PlatformUITestHarness$1.run() line: 47 RunnableLock.run() line: 35 UISynchronizer(Synchronizer).runAsyncMessages(boolean) line: 135 Display.runAsyncMessages(boolean) line: 3794 Display.readAndDispatch() line: 3433 PartRenderingEngine$4.run() line: 1132 Realm.runWithDefault(Realm, Runnable) line: 336 PartRenderingEngine.run(MApplicationElement, IEclipseContext) line: 1023 E4Workbench.createAndRunUI(MApplicationElement) line: 157 Workbench$5.run() line: 654 Realm.runWithDefault(Realm, Runnable) line: 336 Workbench.createAndRunWorkbench(Display, WorkbenchAdvisor) line: 598 PlatformUI.createAndRunWorkbench(Display, WorkbenchAdvisor) line: 150 IDEApplication.start(IApplicationContext) line: 139 UITestApplication(NonUIThreadTestApplication).runApp(Object, IApplicationContext, String[]) line: 54 UITestApplication.runApp(Object, IApplicationContext, String[]) line: 47 UITestApplication(NonUIThreadTestApplication).start(IApplicationContext) line: 48 EclipseAppHandle.run(Object) line: 196 EclipseAppLauncher.runApplication(Object) line: 134 EclipseAppLauncher.start(Object) line: 104 EclipseStarter.run(Object) line: 380 EclipseStarter.run(String[], Runnable) line: 235 NativeMethodAccessorImpl.invoke0(Method, Object, Object[]) line: not available [native method] NativeMethodAccessorImpl.invoke(Object, Object[]) line: 62 DelegatingMethodAccessorImpl.invoke(Object, Object[]) line: 43 Method.invoke(Object, Object...) line: 497 Main.invokeFramework(String[], URL[]) line: 669 Main.basicRun(String[]) line: 608 Main.run(String[]) line: 1515 Main.main(String[]) line: 1488BreakpointSetOrganizer is being created as part of DebugUIPlugin's startup, so this failure was almost certainly being triggered by the unrelated regression that was causing a lot of plugin activation in recent builds (DebugUIPlugin must be one of the newly-activated plugins).Renaming bug to reflect the underlying problem. What needs to happen:1. WorkingSetManager.restoreWorkingSetState must not fire any change events until after it has finished the last modification of a member variable (the change events can either be asynchronous or be synchronous at the end of the method). We can't continue to use the pattern of calling a helper function which both modifies member variables and fires a change event.2. We need a regression test for this. The currently-failing test is only failing due to an unrelated bug. Once that bug gets fixed, we'll need an explicit test for this corner case. The test should attach a listener to the working set manager and fail if any of the saved working sets are not present at the moment the first change event is received.The failure was triggered by the fix for. However, the failure is correct -- the test really should be failing and the fact that it passed to begin with indicates that the test was insufficient.I'd guess if we looked hard enough, we can find bugs where people have reported elements being removed from aggregate working sets after restoring them from disk.(In reply to Stefan Xenos from)+1I came to same conclusion (without to know that this bug exists while analyzing failures in).I did just that:Thanks for the unit test, Andrey. I'll take a look at fixing the underlying failure the next time I have a free weekend (probably some time in Feb).Andrey, I tried enabling testWorkingSetSaveRestoreAggregates but the test passes.Which test did you write that verifies this bug?New Gerrit change created:New Gerrit change created:No worries. I found the test, Andrey.In the future, I'd suggest that you comment out the failing assertions rather than asserting that the wrong value is present.Gerrit changewas merged to [master].Commit:This causes test failures in jdt.ui (N20160116-1500).WorkingSetDropAdapterTest.java - testRearrange1/testRearrange2/testRearrange3:assertion failed: org.eclipse.core.runtime.AssertionFailedException: assertion failed: at org.eclipse.core.runtime.Assert.isTrue(Assert.java:110)at org.eclipse.core.runtime.Assert.isTrue(Assert.java:96)at org.eclipse.text.tests.Accessor.fail(Accessor.java:329)at org.eclipse.text.tests.Accessor.invoke(Accessor.java:187)at org.eclipse.text.tests.Accessor.invoke(Accessor.java:160)at org.eclipse.jdt.ui.tests.packageview.WorkingSetDropAdapterTest.setWorkingSets(WorkingSetDropAdapterTest.java:206)at org.eclipse.jdt.ui.tests.packageview.WorkingSetDropAdapterTest.testRearrange1(WorkingSetDropAdapterTest.java:153)at junit.extensions.TestDecorator.basicRun(TestDecorator.java:23)at junit.extensions.TestSetup$1.protect(TestSetup.java:23)at junit.extensions.TestSetup.run(TestSetup.java:27)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:743)at org.eclipse.test.EclipseTestRunner.run(EclipseTestRunner.java:351)at org.eclipse.test.UITestApplication$2.run(UITestApplication.java:197)at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:182)at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3807)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3446)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$4.run(PartRenderingEngine.java:1118)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:336)at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1019)at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:157)at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:691)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:336)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:604)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:138)at org.eclipse.test.UITestApplication.runApplication(UITestApplication.java:140)at org.eclipse.test.UITestApplication.run(UITestApplication.java:62)at org.eclipse.test.UITestApplication.start(UITestApplication.java:212)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:388)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:243)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:670)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:609)at org.eclipse.equinox.launcher.Main.run(Main.java:1516)at org.eclipse.equinox.launcher.Main.main(Main.java:1489)at org.eclipse.core.launcher.Main.main(Main.java:34)New Gerrit change created:Gerrit changewas merged to [master].Commit:Reverted. You also get such AFEs if you just configure Package Explorer to show Top Level Elements > Working Sets.Thank you for the timely revert, Markus. I'll resubmit once I have fixes for the issues described above.No problem. And thanks to Noopur for your investigation and stacktrace, which saved me quite some time when I ran into AFEs in a runtime workspace.I didn't look deeply into the WorkingSetManager, but I think the asyncExec is a breaking API change that needs to be avoided. The general contract in SWT/JFace/Platform is to deliver events without delay.Here's the stacktrace for the original exception that was swallowed in the stacktrace in(fixed in master, where I copied this cause):Caused by: org.eclipse.core.runtime.AssertionFailedException: null argument: at org.eclipse.core.runtime.Assert.isNotNull(Assert.java:85) at org.eclipse.core.runtime.Assert.isNotNull(Assert.java:73) at org.eclipse.jdt.internal.ui.workingsets.WorkingSetModel.<init>(WorkingSetModel.java:272) at org.eclipse.jdt.internal.ui.packageview.PackageExplorerPart$9.handleException(PackageExplorerPart.java:1463) at org.eclipse.core.runtime.SafeRunner.handleException(SafeRunner.java:75) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:44) at org.eclipse.jdt.internal.ui.packageview.PackageExplorerPart.createWorkingSetModel(PackageExplorerPart.java:1456) ... 56 moreGerrit changewas merged to [master].Commit:(In reply to Eclipse Genie from)Just for the records: this was not the fix but only getting rid of warnings.Yeah. I was taking another look at this one and figured I'd squish some warnings while I was in there. Would you prefer if I file a separate bug for such cleanup?(In reply to Stefan Xenos from)Either that, or make a Gerrit without bug number, or directly push such simple fixes.The AFE in the package explorer is being caused by some unusual initialization for OthersWorkingSetUpdater. Rather than having OthersWorkingSetUpdator listen to changes in other working sets and update the "others" set based on their contents, all other java working sets have special knowledge of the "Others" working set and push changes to it directly.WorkingSetModel locates the OthersWorkingSetUpdator in its constructor like this:...addListenersToWorkingSetManagers();...if (memento == null || ! restoreState(memento)) { ... fLocalWorkingSetManager.addWorkingSet(others); ...}Assert.isNotNull(fOthersWorkingSetUpdater);addListenersToWorkingSetManagers attaches a listener to the working set manager. When a change event occurs related to working set updators, it initializes the fLocalWorkingSetManager field by pulling the updator from the change event.The subsequent call to addWorkingSet triggers the updator to be lazily initialized which fires a change event. Since the change events were (previously) being fired synchronously, this initializes fLocalWorkingSetManager.To me, this looks like a bug in WorkingSetModel. It is assuming that the events are fired synchronously, which isn't promised by API. AbstractWorkingSetManager always had the possibility of firing asynchronous events for changes initiated outside the UI thread. (See the last line of AbstractWorkingSetManager#firePropertyChange).It's also relying on some side-effects which seem brittle (although I haven't investigated enough to understand whether or not they're guaranteed to work):- That each call to addWorkingSet will result in the creation of an updator.- That the created updator will always be an instance of OthersWorkingSetUpdater.My suggestion is as follows:- Unconditionally use asynchronous events in AbstractWorkingSetManager.- Change OthersWorkingSetUpdater to pull in change events rather than have the working sets push changes to the updater. This would eliminate the unsafe downcasts and the assumptions about event timing.- Delay this fix until 4.7.Although I believe that asynchronous events are in line with the intent of the working set manager API, it's quite likely that other clients were also making assumptions about the event timing so almost anything we do here is likely to break someone... so let's do it early in a cycle to let us locate the breakages.There's other more complicated fixes possible, but they all involve some change to the event timing... and as long as code like WorkingSetModel exists, even very slight changes to event timing are risky.Markus, let me know what you think of the approach described in. If you're still opposed to asynchronous change events (as suggested by), I'd be interested in hearing your alternative suggestion.(In reply to Stefan Xenos from)I agree with.Bear in mind that pretty much any change here will cause the event to be asynchronous for *someone*. Even if it's synchronous to top-level callers of WorkingSetManager, it will be asynchronous to - say - constructors of working sets and working set updators that recursively call back into WorkingSetManager.Whoever fixes this will need to be someone who has the power to reverse the "no asynchronous events" decision - and someone who can also make changes in JDT UI, which leaves you and Markus.Basically, you can't simultaneously offer all of these as API contracts because they contradict:1. Events will always be fired synchronously within the WorkingSetManager method that initiated the change.2. Events won't be fired in the middle of initialization.3. WorkingSetManager calls into third-party code during initialization, which is allowed to invoke methods on WorkingSetManager.JDT UI relies on 1 and 3. WorkingSetManager itself and the composite working set support relies on number 2. 3 seems impossible to change without serious API breakage due to the fact that there are extension points that participate in working set creation.	32.0
id=490740	REOPENED	Platform	IDE	4.6	PC Linux	P3 normal	Platform-UI-Inbox	2016-03-30 21:09 EDT by	Renato Garcia	2016-08-04 18:41 EDT (	1 user	Overview:While working on Neon M6 and using the new very welcome 'window toolbar visibility' functionality I've noticed that if the view is maximized while the window toolbars are hidden you are unable to switch views.1) Maximize any view2) Toggle visibility of the window toolbars3) Try to switch to a different view using either the keyboard (Ctrl+F7), the show views shortcut (Shift+Alt+Q) or the menu Window -> Show view.Actual Results: Even after picking a different view it doesn't change and stays on the current view.Expected Results: Change to the selected view.Build Date & Hardware: Build 20160329-0659 Neon Milestone 6 (4.6.0M6)Linux Gtk 3.18.9-1Additional Information: It works if the view is not maximized.	I tried reproducing in Windows and Ubuntu Linux without success.steps: - starting with the toolbar visible, maximize the Problems view- hide the toolbar via menu: Window Appearance > Hide Toolbar- All the following are working: - Press Ctrl+F7 to switch between views - Shift+Alt+Q + view to switch view - menu: Window > Show View > ..Details:Eclipse SDKVersion: Oxygen (4.7)Build id: I20160803-2000OS: Linux, v.4.4.0-31-generic, x86_64 / gtk 3.18.9, WebKit 2.10.9Further Details:Linux Ubuntu 16.04export SWT_WEBKIT2=1export SWT_GTK3=1Closing as I can not reproduce in Latest Build. Please, feel free to re-open if you can reproduce the bug in Eclipse Neon / OxygenThanks for looking into this.The issue is not with the toolbar hide, but with new functionality "Toggle visibility of the window toolbars". You can toggle it using Ctrl+3 and looking for the former description.I've tested with lastest Neon as well and the problem persists.Version: Neon Release (4.6.0)Build id: 20160613-1800GTK3/GNOME Shell 3.20.3	4.0
id=496764	REOPENED	Platform	IDE	4.6	PC Windows XP	P3 normal	Platform-UI-Inbox	2016-06-25 01:41 EDT by	Denis Shmakov	2016-07-12 09:09 EDT (	1 user	In editor when i switch betwin tabs with Ctrl+PageUp and open last tab next pressing not switch to first tab.	Thanks for reporting; but the description does not explain the issue. Closing as invalid.Please, re-open if you can provide a proper descriptionSorry but i don't understand. What wrong?Issue title - "cycling tabs with Ctrl+PageUp"Description - "switch between tabs with Ctrl+PageUp"Issue and Description match.Problem exist.By the way. In all Eclipse interface switching between tabs not cycled.After i reach last i can't move to first moving forward.Now I understand the issue: Switch between editor tabs with Ctrl+PageUp(PageDown) in a circular list.The tab switch is executed after the command "org.eclipse.ui.navigate.nextSubTab" ( ".previousSubTab" ), that I found is referenced in MultipageEditorPart#initializeSubTabSwitching() only.However, MultipageEditorPart#initializeSubTabSwitching() is not called when I'm Pressing Ctrl+PageUp (PageDown) in common java editor (and in other editors). Could someone advise me on the recommended way to find which is the code executed when the users press Ctrl+PageUp (PageDown) ?	4.0
id=497179	REOPENED	Platform	UI	4.6	PC Linux	P3 enhancement	Platform-UI-Inbox	2016-07-02 10:22 EDT by	Yan Pas	2016-07-16 13:54 EDT (	3 users	CreatedscreenshotWhen I clicked on "Create account". Some little window with progress bar popped up and then text editor has opened. Use xdg-open for links in linux please.Linux Mint 17.3 Xfce, java 8, kernel 4.4.	This is most likely because you opened once html file with text editor and set this as default. Can you confirm this, and remove the default ?Yes, you were right, mimeapps.list is pretty mazeful, so I didn't notice it first time :)I personally think this is still a valid bug or at least enhancement request. Seems to me that "editor associations" should not influence what is opened for links in dialogs, if that is what you are saying. Seems they should always use "web browser" settings. Right? Or, am I misunderstanding?Createdcomponent screenshotThe default program for links (acually it was mimetype text/html) is choosed based on my OS settings. This peace of code (Eclipse User Storage Service) uses different mechanism from Eclipse Platform for defining web browser. After editing file $HOME/.local/share/applications/mimeapps.list () this links began to open in Firefox (which is not the default browser). Now after more several edits they still open in my notepad app (Mousepad). I don't know how this component decides which app to use. So the bug is really reopened.I've tried to remove every entry with my Mousepad but Eclipse still opens links in mousepad...	4.0
id=499232	REOPENED	Platform	UI	4.7	PC Windows NT	P3 normal	Platform-UI-Inbox	2016-08-05 09:23 EDT by	Ben Tatham	2016-09-03 20:36 EDT (	4 users	The Package Explorer conveniently has a link to the Filters and shows recently/commonly used ones directly in the drop-down of the view. Project Explorer should do the same.For example, I find it very convenient to quickly show/hide Closed Projects.	Createdimage: project explorer vs package explorerI can reproduce the issue in Eclipse SDK Version: Oxygen (4.7)Build id: I20160803-2000OS: Windows 10, v.10.0, x86_64 / win32Createdimage: filters are already available in Project ExplorerFilters are already available in Project Explorer, under the Customize View menu item.Closing as Worksforme.Please, re-open if you want to suggest improvements to the visibility of Filters in Project Explorer.Comment onimage: filters are already available in Project ExplorerYes - the Filters are available, but this bug is about making them more easily accessible directly on the drop-down, as they are in the Package Explorer.Further, Package Explorer shows a list of commonly used Filters directly in the drop-down which is also what this bug is requesting.I'd like to help. Please be more specific with the requirements. (In reply to Ben Tatham from)- Do you want a different name for "Customize View..." or you want another menu Item? - If you want another menu item, describe what you expect to see in there. (In reply to Ben Tatham from)Please, specify the list of common filters. As we can not see those filters in, I expect a dynamic list.Can you provide a screenshot or a list of filter names with descriptions, and the condition when the filter should be active?Thanks for helping in making Eclipse better.CreatedScreenshot of Package Explorer view menuIt is not that hard to understand what is being requested here, since the requests are already as specific as it can be.I will try to be even more specific by explicitly describing the workflows.Workflow to set a filter in the Package Explorer:1. Open View Menu2. Click Filters Menu Item3. Choose a filter4. Hit OKThats 4 clicks to set a filter and no need to think since it is intuitiveWorkflow to set a filter in the Project Explorer:1. Open View Menu2. Click "Customize View..." Menu Item3. Choose a filter4. Hit OKAlso 4 clicks, but not (!) intuitive. Never would i expect to find filters in a dialog opened by a menu item that is called "Customize View...".So the first request is to find a proper name for that menu item or create a new menu item that is called filters and that opens the filter selection dialog.I attached a Screenshot that displays the Package Explorer view menu.In that screenshot a recently used Filter is displayed.I am now able to click that filter which will activate it (it is then checked) and then i can click it again and thus deactivate it.This is convenient and easy.Requirements: 1.) Use a new name for "Customize View...", a name that recalls "Filters...". - Perhaps we can use "Filters and Customization..."2.) Package Explorer can remember the last two filters used, and add them as a dynamic menu item with a checkbox. - We should do the same for Project ExplorerAdding Mickael in c/c, as ha can give good directionsYes, that () sounds like what I had in mind. Just do what the Package Explorer does.(In reply to Patrik Suzzi from)Tracked separately in. I believe that's a great thing to improve the current menu name.Yes, it's mostly a matter of adding a dynamic menu contribution to the view which adds entry from the 2 last enabled filters.However, I don't think project explorer keeps in mind which were the 2 last filters enabled/disabled. This would require to store those in the memento (state) of the view.	10.0
id=500790	REOPENED	Platform	IDE	4.6	All All	P3 enhancement	Platform-UI-Inbox	2016-09-03 05:27 EDT by	Yauheniy Ratkevich	2016-09-05 08:23 EDT (	4 users	It would be great to add an ability to open any editor without file creation (like in Notepad++).Especially for JSON and SQL.(File -> New Editor -> Select type/Language)-- Configuration Details --Product: Eclipse 4.6.0.20160613-1800 (org.eclipse.epp.package.jee.product)Installed Features: org.eclipse.platform 4.6.0.v20160606-1342	This is already possible with File > New.. > Untitled Text FileKeyboard shortcurt combo:Press Ctrl+N, type "unt", and press enter.Note: if you close without saving, you'll lose the content.@Patrik, I mean not just a notepad, but an ability to qualify a type of this editor JSON / SQL / JAVA / XML etc.Otherwise it's almost useless... I have just a Notepad or Sticky NotesIIUC you want to: Create an Untitled Text File (without saving) and force Eclipse using a specific editor for that file, i.e. the XML or JSON Editor. To do the same now, you first need to save; then you can choose the editor, i.e. Open With > XML Editor.Notes: - Notepad++ just does lightweight editing, activating syntax highlighting, when you select the Language Type. - Eclipse is more advanced and, If I Recall Correctly, the "classic editors" are working against a file-based buffer.Assuming we want to proceed with this implementation, I see two options: (1) Instruct the editors to use an in-memory buffer, instead of a file one. (2) Implement this using the upcoming Eclipse Generic editor; that seems the right choice for lightweight editing. Adding Dani and Mickael in c/c as they can correct me and guide to the right direction.Fixing this seems a bit tricky as Patrick identified. And creating a new file for edition seems pretty natural, and the current situation has only for drawback to create a file. So I'm not sure this is worth being worked on at the moment.The workaround is just to create a file. In general, it's useful to get content persisted anyway, even for draft work.(In reply to Patrik Suzzi from)(In reply to Mickael Istria from)Yes, you've understood me correctly.As for this: "To do the same now, you first need to save; then you can choose the editor, i.e. Open With > XML Editor."Yes, I can. But here I still need to create a file.You can do it for some very popular formats, like JSON. Just JSON editor.If you do it, it will be really a killer-feature in Eclipse.For my understanding, you can create TEMPORARY file (like "7a8f1f2.json", somewhere in 'C:\Temp' or anywhere else) and work with it, and delete it on Editor closing.(In reply to Yauheniy Ratkevich from)I have some serious doubts about it ;)Having users doing File > New > JSon Editor (selection) rather that doing File > New > text.json (freetext) is not much better because:* there are as many steps to go* Both are equally simple/difficult to discover and understand* freetext allows to create any file type then to choose or discover the best editor, without restriction; whereas selection introduces a set of supported types* In most cases, people do want to save their file, so asking them for the name 1st is saving them one step in saving laterDo you have a user-story to share when the workflow you propose would be considerably better than the current one?(In reply to Mickael Istria from)I may explain, why I wasn't so lazy and even opened this discussion.It's not the secret that almost all users of Eclipse are web-developers with stack Java+JS/HTML.And during working on the project, each day I'm facing with JSON data: in requests, responses, in logs (yes, it's very comfortable to have JSON-logs), mock data, data in my DB, etc. And each time I need to format it, have outline, search for some fields. And I don't want to create any freaking file somewhere in my project or workspace.It shouldn't be somewhere deep in Menus. It can be somewhere on the top. For example Window->New JSON Editor.And I don't think, that it needs huge refactoring to create temporary file for it, doesn't it?I've found plugin, that have such option:But it would be good to see native JSON editor there.Mickael, if the classic editors are not made for lightweight editing, we could create a new eclipse project that ships a set of lightweight editors, based on the Generic editor (IIRC you and Sopot are working on this, adding him in c/c). As pointed by Yauheniy, we probably need few fundamental editors. As example XML, JSON, Java, JavaScript, HTML and SQL.Hence, for each of the above, we should add language server support, and I think there are already some options, i.e.- Java:- JSON: once license is cleared, we could use the @code / or we can ask the JSDT team.For the servers not available, we could contribute new ones:- JavaScript: this can be contributed by the JSDT team, via Chromium- XML: we could write a new one (I'm available)- HTML and SQL: write a new one, as for XML. (There are a lot of companies working on Language Servers, and after a language server is available, we are also closer to offer that service on the web)Then, we could ship this set of lightweight editors as an Eclipse Project, and add them to any Eclipse distribution. (perhaps in future, using language servers, we can offer a web edition of Eclipse?)That could be really cool, especially if we can get guidance from the Eclipse Platform Text team. WDYT?(In reply to Patrik Suzzi from)Here, it's not a matter of lightweight or not. Yauheniy seems to actually want the current editors, so nothing to consider on this topic.The requested change is a workflow additio: additionally to the entry to select a file to create and then get an editor, user wants an entry to directly select an editor to open.I didn't read this in Yauheniy's comments, I believe you're over-interpreting and the other parts of your answers do not relate at all with the original request.(Note that I don't disagree with you on those other parts, I'm just trying to keep focused request on the bug tracker)I think I see what you mean:Ctrl+N > Untitled File > new UI > EditingThe new UI allow you to keep the Eclipse generic editor, or to choose any of the registered editors to edit the new file.	10.0
id=501277	REOPENED	Platform	UI	4.6	Macintosh Mac OS X	P3 major	Platform-UI-Inbox	2016-09-12 13:45 EDT by	David Leeds	2016-09-15 00:48 EDT (	1 user	When typing into Find/Replace dialog with Incremental search enabled, the focus will jump to the editor while the user is typing. This is very disruptive, because the remainder of your search query is inserted into your source code.This bug has been observed on both Windows 10 and OSX with Eclipse Neon CDT, and appears intermittantly, but is easily reproducable.-- Configuration Details --Product: Eclipse 4.6.0.20160613-1800 (org.eclipse.epp.package.cpp.product)Installed Features: org.eclipse.platform 4.6.0.v20160606-1342	Cannot reproduce in Windows 10.see:details: Eclipse SDKVersion: Oxygen (4.7)Build id: I20160912-1005OS: Windows 10, v.10.0, x86_64 / win32Cannot reproduce in Mac OSsee:details: Eclipse SDKVersion: Oxygen (4.7)Build id: I20160913-0800OS: Mac OS X, v.10.11.5, x86_64 / cocoaI also cannot reproduce in Eclipse Neon 4.6.0Closing this bug as worksforme. Please, Re-open if you have updates, improved steps to reproduce, a video, etc.This is easily reproducible.Steps:1. Start with a multi-page .c or .h file.2. CTRL-f to get a find/replace dialog, and type in a query that matches multiple tokens on the page.3. Repeatedly hit ENTER to cycle through search results. Eventually, the focus will jump to the editor unexpectedly and begin editing the code.Notes:* I have now reproduced this with Incremental search both on or off* The problem does not occur when you hit the Find button. You have to be typing on the keyboard or hitting ENTER for it to occur.* Sometimes (< 50% of the time) the problem does not manifest itself at all. This seems to be the case on smaller source files. If I cannot reproduce it on a file, I switch to a different file and usually start seeing it happen.* There does not appear to be a predictable number of button presses between occurrences.I have reproduced it on both IOS and Windows 10 computers running the latest released version of Eclipse CDT (4.6.0).	4.0
id=495230	REOPENED	Platform	UI	4.6	PC Linux	P3 normal	Platform-UI-Inbox	2016-06-01 22:00 EDT by	Kris De Volder	2017-02-05 11:35 EST (	5 users	CreatedscreenshotWith the RC of Eclipse 4.6 when I drag and tear-off an editor to create two side-by-side editors, there's an ugly, very-wide empty space above the two editors.Ugly... I can live with. But wasted space could be put to better use to show the contents of the files I'm editing.These ugly borders aren't really 'new' they also existed in Eclipse 4.5 (and earlier). What's new is that these ugly border are now about 4 times as wide and wasting a lot more space than they did before.I'll attach a screenshot to show what I mean.OS: Ubuntu 12.04	This seems a duplicate of(see also)Could you please tell which version of GTK are you using ?See:*** This bug has been marked as a duplicate of***GTK3This is not a dup of, because I observe this issue and have NO problems with extra toolbar reserved for min/max.This issue appears, if you drag/drop one editor next to the sibling editor *inside* the editor area. If you drag/drop the editor to the view stack, no ugly heading appears. So I this is the problem of the editor area rendering with two editors next to each other.Creatededitor area without cssHere you see how it looks like *without* CSS themes.It does NOT waste that huge extra space above the min/max upper border.But without CSS we see another issue with this: the wrong white color applied to the editor area title. Without CSS this wrong white color applied to the border of the title only.	4.0
id=501503	REOPENED	Platform	IDE	4.6	PC Windows 10	P3 normal	Platform-UI-Inbox	2016-09-15 10:29 EDT by	Antônio Diego	2017-02-05 18:00 EST (	1 user	I have found some errors during renaming of filds in the editor.-- Configuration Details --Product: Eclipse 4.6.0.20160613-1800 (org.eclipse.epp.package.java.product)Installed Features: org.eclipse.platform 4.6.0.v20160606-1342	Closing as invalid as there is not enough information to identify the issue. Please, re-open this when you can provide clear steps to reproduce the bug and the expected behavior.Thanks for reporting!The errors ocurs at a small frequency. The name of field that I renaming is unorganized and than ocurrs reclamation of erros, but when I try again the erros end. I believe that this ocurrs only in local fields.CreatedBefore rename.See that the highligth of the filds names are incorrect.CreatedCapture during renamingNow the selection of fields names are incorrect.CreatedError on higlightMost one screenshot of errors.I posted some screenshots of errors related to this.	6.0
id=502524	REOPENED	Platform	IDE	4.6	PC Windows 7	P3 major	Platform-UI-Inbox	2016-09-29 03:33 EDT by	Missing name	2016-12-23 11:26 EST (	3 users	I've just updated from Neon to Neon.1, now all update sites are lost. The list of "Available Software Sites" is completely empty which means I'm locked out of any future updates.-- Configuration Details --Product: Eclipse 4.6.1.20160912-1200 (org.eclipse.epp.package.jee.product)Installed Features: org.eclipse.platform 4.6.1.v20160907-1200	Lowering the bug severity as there is no crash, loss of data or severe memory leak.-CreatedIssue not reproducible.I can not reproduce the issue with these steps:- get a fresh Eclipse Neon R- add an update site, i.e. WindowBuilder- select Help > Check for Updates- after the update is complete verify the update sites are still in place.Could you please tell us the steps to reproduce the issue on your system?I cannot tell if it is reproducible as I've now upgraded. However what I noticed was that one file seemed to be destroyed by the update:p2\org.eclipse.equinox.p2.engine\profileRegistry\epp.package.jee.profile\.data\.settings\org.eclipse.equinox.p2.metadata.repository.prefsThis file was very small after the update and contained no references anymore to the repositories defined in org.eclipse.equinox.p2.artifact.repository.prefsThe latter still existed and had all the information in it, but the metadata file only contained around 15 lines (I don't have a copy anymore) containing not a single http repository reference.Maybe that helpsWe can't do much without further details.Well it just happened again when trying to upgrade from Neon.1 to Neon.2 on one of my installations.After searching for updates and installing everything, I restarted Neon. I instantly saw that there was something wrong as the splash screen still showed "Neon.1" and after rechecking for updates I was told that there were no update sites, and surely, that file was reset again."About Eclipse" however shows me "Version: Neon.2 Release (4.6.2)", but the splash screen still shows Neon.1 on this installation.Maybe there was something going wrong during the update? Are there any logs somewhere from the update?In the configuration tab I also still see that the splash is taken from the Neon.1 plugin:-showsplashD:\Eclipse\Eclipse-4.6-Neon\\plugins\org.eclipse.platform_4.6.1.v20160907-1200\splash.bmpThis is extremely annoying... :-(I confirm that this happens when upgrading from Neon.1 to Neon.2.	6.0
id=503369	REOPENED	Platform	IDE	4.4.2	All All	P3 enhancement	Platform-UI-Inbox	2016-10-04 08:38 EDT by	Girish Kumar	2016-10-04 11:54 EDT (	2 users	With the headless mode, project containing the filteredResources in .project causes below exception, however my build is not getting disturbed.!ENTRY org.eclipse.core.resources 4 2 2016-06-11 00:05:15.164!MESSAGE Missing resource filter type: 'org.eclipse.ui.ide.multiFilter'.!STACK 0java.lang.Error at org.eclipse.core.internal.resources.Filter.match(Filter.java:62) at org.eclipse.core.internal.resources.Filter.filterExcludes(Filter.java:157) at org.eclipse.core.internal.resources.Filter.filter(Filter.java:110) at org.eclipse.core.internal.resources.Resource.filterChildren(Resource.java:2171) at org.eclipse.core.internal.resources.Resource.filterChildren(Resource.java:2133) at org.eclipse.core.internal.localstore.UnifiedTree.getLocalList(UnifiedTree.java:350) at org.eclipse.core.internal.localstore.UnifiedTree.addChildren(UnifiedTree.java:138) at org.eclipse.core.internal.localstore.UnifiedTree.addNodeChildrenToQueue(UnifiedTree.java:244) at org.eclipse.core.internal.localstore.UnifiedTree.accept(UnifiedTree.java:110) at org.eclipse.core.internal.localstore.FileSystemResourceManager.refreshResource(FileSystemResourceManager.java:920) at org.eclipse.core.internal.localstore.FileSystemResourceManager.refresh(FileSystemResourceManager.java:904) at org.eclipse.core.internal.localstore.FileSystemResourceManager.refreshRoot(FileSystemResourceManager.java:951) at org.eclipse.core.internal.localstore.FileSystemResourceManager.refresh(FileSystemResourceManager.java:897) at org.eclipse.core.internal.resources.Resource.refreshLocal(Resource.java:1705) at org.eclipse.core.internal.refresh.RefreshJob.runInWorkspace(RefreshJob.java:167) at org.eclipse.core.internal.resources.InternalWorkspaceJob.run(InternalWorkspaceJob.java:38) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)I was able to do some quick analysis and found that the below extension definition is in org.eclipse.ui.ide bundle, which is a UI bundle, so the framework is not able to get the implementation. I feel positively that this implementation needs to be moved to a non ui bundle(May be a new bundle). so that one does not get this. I already svn also has their own implementation for hiding .svn and its a part of core plugins not UI<extension point="org.eclipse.core.resources.filterMatchers"> <filterMatcher argumentType="string" class="com.odcgroup.headless.resource.filters.DSFileInfoAttributesMatcher" id="org.eclipse.ui.ide.multiFilter" name="File and Folder Attributes"> </filterMatcher> </extension>	com.odcgroup.headless.resource.filters.DSFileInfoAttributesMatcher is not Eclipse codeMy bad i pasted the wrong one. The actual one is <filterMatcher argumentType="string" class="org.eclipse.ui.internal.ide.misc.FileInfoAttributesMatcher" description="%multiFilterProvider.description" id="org.eclipse.ui.ide.multiFilter" name="%multiFilterProvider.name" ordering="first"> </filterMatcher>you can check this in org.eclipse.ui.ideMy bad i copied a wrong one. The correct one you can find in org.eclipse.ui.ide <filterMatcher argumentType="string" class="org.eclipse.ui.internal.ide.misc.FileInfoAttributesMatcher" description="%multiFilterProvider.description" id="org.eclipse.ui.ide.multiFilter" name="%multiFilterProvider.name" ordering="first"> </filterMatcher>OK, this makes sense then.I've changed the bug title to "Move org.eclipse.core.resources.filterMatchers contributions from org.eclipse.ui.ide to non-UI bundle".But I fear this is nod easily doable, not sure if there is anyone depending on the fact that org.eclipse.ui.ide is contributing those matchers.Feel free to provide a patch, seeCurrently I have done some hot fix for headless to work with my env.I would love to contribute the same in a very near future.	5.0
id=505678	REOPENED	Platform	UI	4.6	All All	P3 normal	Platform-UI-Inbox	2016-10-11 02:29 EDT by	Mickael Istria	2017-01-23 11:45 EST (	8 users	Some tests are failing on the org.eclipse.e4.ui.tests. The prevent both "regular" build to complete successfully (for instance) and the Tycho build to run tests without reporting a BUILD FAILURE (). Some examples of tests failing - apparently depending on the machine where they're run:*org.eclipse.e4.ui.tests.workbench.PartRenderingEngineTests.testSelectedElementNullingTBR*org.eclipse.e4.ui.tests.workbench.PartFocusTest.testFocusChangesOnExplicitPartActivation* org.eclipse.e4.ui.tests.workbench.PartFocusTest.testNoActivationOnExplicitInPartWidgetSelection	testSelectedElementNullingTBR also fails locally for me. I don't find a commit which causes this in platform UI or runtime (I did revert the history several times). Did we recently update our EMF dependencies?testSelectedElementNullingTBR selects the next tab item under Linux, if the selected tab is removed. @SWT colleagues, any known change in SWT CTabFolder which could cause this? Under Windows this works fine.Shall we move this to SWT?I contributed a fix for CTabFolder somewhat recently. I don't think it's likely to be the cause but it might worth trying to revert it and see:commit 8a456e1b2a83efab27513cfa8ed8f72ab32fa6e0Author: Marc-Andre Laperle <>Date: Sun Sep 25 17:44:18 2016 -0400- [CTabFolder] Toolbar items overflow when explicit tab height is used Do not let controls overflow when explicit tab height is used. Also fixes. Change-Id: I9c3d0e4f099aac7cda434b52b7b8af4e2c52200f Signed-off-by: Marc-Andre Laperle <>I don't think this is really related to SWT. All patches I'm aware of about CTabItem recently have happened to be pure drawing, and not changing anything about the focus or other state.Don't those test use the e4-custom CTabRenderer?The only remaining failing test is org.eclipse.e4.ui.tests.workbench.PartRenderingEngineTests#testSelectedElementNullingTBR . the 2 other ones are working.Can we know when this test started failing?(In reply to Lars Vogel from)I believe that the issue is simply that the test wasn't updated when this behaviour was introduced. I'll send a Gerrit for an update of the test.New Gerrit change created:The 2 PartFocusTest failure work locally, on "production" CI builds. I've tried to restict the build eclipse.platform.ui-Gerrit job to CentOS slave and it seems to work.I believe those failures are caused by an issue in the version of Xvnc used by SLES. So additionally to the attached patch, the fix is also to force usage of a CentOS slave.Gerrit changewas merged to [master].Commit:This seems fixed.The change I made couldn't be tested on WIndows and Mac, but I am optimistic that the patch doesn't break it all ;) In any case, if there happen to be an issue with those tests, feel free to reopen it.Reopening as the tests are failing again during gerrit triggered build (see recent build history). Interestingly enough, they don't fail during integration builds (neither on SLES12 nor CentOS, e.g.,).To quote Dani in, "Note that we recently changed the jobs to also use SLES." So it seems to be undesirable to force usage of CentOS slave to fix the issue.(In reply to Mikaël Barbero from)Correction: our integration build tests run on CentOS we do not use SLES12 during integration builds(In reply to Sravan Kumar Lakkimsetti from)So the unit tests results table is misleading. I see two columns "ep47I-unit-lin64linux.gtk.x86_64 8.0" and "ep47I-unit-cen64 linux.gtk.x86_64 8.0" and I assumed that lin64 was SLES12 and cen64 was CentOS. Both columns have different numbers of failed unit tests (e.g. for "team.tests.cvs.core") so it must be different from cen64. I see that the lin64 column could be collected from(which run on hippcentos), but I can't find anything with a cen64 label. Would you please give me some details about all of this? Thanks.(In reply to Mikaël Barbero from)ep47I-unit-lin64 runs with GTK2 and ep47I-unit-cen64 runs with GTK3the jobs arethese are running from platform hipp(In reply to Sravan Kumar Lakkimsetti from)Thanks Sravan. Then it is the following sentence which is misleading on the test results page ()"The unit tests are run on the shared Hudson instance."Sorry for the off topic comments on this bug. If needed, I will continue on the releng mailing list.(In reply to Sravan Kumar Lakkimsetti from)Sravan, please fix the labels. It should sayep47I-unit-cen64-GTK2 and ep47I-unit-cen64-GTK3. Everything else is misleading.I would like to disable the two test below until we have the right solution, otherwise each Gerrit build fails.org.eclipse.e4.ui.tests.workbench.PartFocusTest.testFocusChangesOnExplicitPartActivationorg.eclipse.e4.ui.tests.workbench.PartFocusTest.testNoActivationOnExplicitInPartWidgetSelectionAny objections?I can't run them in the IDE either, I see only endless sequence of those errors:!ENTRY org.eclipse.ui 4 0 2017-01-10 11:11:53.626!MESSAGE Unhandled event loop exception!STACK 0org.eclipse.e4.core.di.InjectionException: Unable to process "WorkbenchWindow.model": no actual value was found for the argument "MTrimmedWindow". at org.eclipse.e4.core.internal.di.InjectorImpl.reportUnresolvedArgument(InjectorImpl.java:452) at org.eclipse.e4.core.internal.di.InjectorImpl.resolveRequestorArgs(InjectorImpl.java:443) at org.eclipse.e4.core.internal.di.InjectorImpl.inject(InjectorImpl.java:140) at org.eclipse.e4.core.internal.di.InjectorImpl.inject(InjectorImpl.java:118) at org.eclipse.e4.core.contexts.ContextInjectionFactory.inject(ContextInjectionFactory.java:73) at org.eclipse.ui.internal.Workbench.createWorkbenchWindow(Workbench.java:1498) at org.eclipse.ui.internal.Workbench.openWorkbenchWindow(Workbench.java:2581) at org.eclipse.ui.internal.Workbench.getWorkbenchPage(Workbench.java:2022) at org.eclipse.ui.internal.Workbench.setReference(Workbench.java:2070) at org.eclipse.ui.internal.Workbench.lambda$11(Workbench.java:1964) at org.eclipse.e4.ui.services.internal.events.UIEventHandler$1.run(UIEventHandler.java:40) at org.eclipse.swt.widgets.Synchronizer.syncExec(Synchronizer.java:233) at org.eclipse.ui.internal.UISynchronizer.syncExec(UISynchronizer.java:144) at org.eclipse.swt.widgets.Display.syncExec(Display.java:5410)New Gerrit change created:Gerrit changewas merged to [master].Commit:	21.0
id=19103	REOPENED	Platform	UI	2.0	PC Linux	P3 normal	Platform UI Triaged	2002-06-04 11:40 EDT by	Randy Giffen	2014-12-26 06:47 EST (	1 user	F21) Open the property sheet 2) Select a file in the navigator3) Select the name property and perform copy from the context menu4) Paste to a text editor to see that you copied the property correctly5) Select the Info category and perform copy from the context menu6) Paste to a text editor to see that nothing was copiedNot sure whether copy should be disabled here or should be made to work.Probably the latter it might be useful to copy a category name.	I'd expect Copy on a category to copy text for the whole category, including its property values.agreed. additional comments: copy/paste from category name actually does paste the most recent clipboard (for instance, the 'name' property in the example below). i'm running 2.0.1 release.***has been marked as a duplicate of this bug. ***Cleaning up defect lists by setting ones without recent traffic to 'REMIND'.As of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.The issue still occurs in Eclipse 4.5 I20141208-2000.	6.0
id=23862	REOPENED	Platform	UI	2.0.1	PC Windows 2000	P3 minor	Platform UI Triaged	2002-09-19 12:23 EDT by	Jeff Kobal	2016-05-18 04:22 EDT (	7 users	Open up two files from the Navigator, and enable the "Properties" view. Notice that as you click on each file in the Navigator, the Properties view is updated with the properties for that file, and the editor for that file comes to the front, as expected. However, if you click on the editor tabs for each of those files, the Properties view does NOT update (though the highlighted file DOES change in the Navigator window as expected); instead, the last file clicked in the Navigator is still shown in the Properties view.	Investigating as candidate for 2.1.1, in conjunction with another bug:.The Properties View adds itself as a selection listener for the workbench page. However, the Properties View will only update itself when the Resource Navigator is active (i.e., has focus). When selecting editor tabs, the ResourceNavigator is not active, so no updates for the Properties View occur. This is how the selection service for the Workbench Page is set up to work. Should defer this until after 2.1.1 because any fix would not be simple.Since this is not a regression from 2.0.3, we have decided to defer this.Should address for R3.0 by tracking editor inputs, not just selection.(This must be done in a generic way, not tied to IResource.)I'm not sure I understand the difficulty here. The Navigator window updates the"selected" resource when you switch editor tabs, so can't the properties viewupdate based on the IResource selected in the Navigator, even when it isn't infocus?Marking as LATER please respond if you think this is critical for 3.0As of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.This is something we should simply fix. For editors we could use the editor input as fallback if there's not structured selection.I didn't understand as much about the Workbench back in 2002/2003 when I opened this bug, but I think I get the difficulty now. The Properties View is populated by the active View in the workbench. For example, if you open up two Java source files, and switch between those resources in the Navigator or Package Explorer, you will see the Properties update for the selected Resource. If you then click on the different Java methods listed in the Outline View, you will see the Properties update for the selected method. If you then click on either of the Java Source Editors, the Properties View doesn't update at all (it keeps the previous contents). This is because the ViewPart (EditorPart) that corresponds to each of the editors isn't updating the Properties View by default.So what Daniel says makes sense -- if the editor doesn't have a StructuredSelection to provide to the Properties View, the default behavior for the EditorPart would be to query the EditorInput for the IResource being edited (if one exists), and provide that resource's properties to the Properties View, instead of continuing to show outdated information.Sounds good to me. If we make the text editor a property source that would get us most of the cases (many of the non-text editors like GEF are already providing properties so they wouldn't have any issues).What would that mean? Would it help if text editors provideI love bugzilla (do I?).Does the framework query IPropertySourceProvider on selection changed - I'm not positive on this? One remaining issue is that the properties view does not nicely deal with post selection changed events (see).***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***	13.0
id=508507	REOPENED	Platform	UI	4.7	PC Linux	P3 blocker	Platform-UI-Inbox	2016-12-01 03:36 EST by	Lars Vogel	2017-01-05 09:37 EST (	8 users	Our Gerrit builds get frequently killed. SeeLooks to me that if a job manages to run below 60 mins, it run successful. After 60 or more minutes something seems to kill the jobs.The Abort the build if it's stuck is set to 400 minutes, so I do not think this is the cause, but I remove it for testing.	@Frederic, are you aware of any reason why the jobs are cancelled after a certain time? 400 min is never reached for an individual job. Or is this a general limit for all jobs running at the same timeFYI - I removed the "Abort the build if it's stuck" flag for testingJobs are still failing. Frederic, is something on the server killing these jobs?The jobs are failing, but not because they are aborted. AFAICT test errors are causing this.It is not gerrit, it is our code.The tests DNF in the latest build on CentOS mashine too, seeDNF:OK:Comparing the logs from CentOS with other Linux we see that the last test executed was:org.eclipse.e4.ui.tests.css.swt.Test#testTransparentColorConstantReferenceand the next one which should be executed would be:org.eclipse.e4.ui.tests.css.swt.Test#testOriginalBugReportDifferentOrderProbably it fails to create a shell, but I don't see any logs...(In reply to Andrey Loskutov from)The strange thing for me is that sometimes the css.swt tests are running fine (basically whenever the runtime of the job is below 60 minutes).And if you take a "running fine build" and re-trigger it, it frequently fails. This is an indicator to me that it is not in our code.@Lars: probably you've right. I see that in ALL recent Gerrit jobs *independently* from the test time Eclipse process terminates with error code 137 which is usually a sign of "kill -9" (128 + 9).The gerrit jobs seem to be killed, they terminated all with:[ERROR] Failed to execute goal org.eclipse.tycho:tycho-surefire-plugin:0.26.0:test (default-test) on project org.eclipse.e4.ui.tests.css.swt: An unexpected error occured while launching the test runtime (return code 137). See log for details. -> [Help 1]What wonders me is that the time is not 60-70 minutes, it is *anything* from 30 minutes to 1.5 hours.Any clue? Do you see something is /var/log/dmesg? Can it be OOM Killer?@Frederic: it would be nice if you would restart our hudson instance, this all above is not usual.I've now pushedto Gerrit - this will disable CSS tests enabled via.If this Gerrit build succeeds, we've found the root cause...(In reply to Andrey Loskutov from)Jobs are still failing. @Frederic we think the OS is killing our jobs. Could you check?The slave may be overcrowded. Would it be fine to uncheck the parallel builds option and see how it goes?(In reply to Mickael Istria from)+1(In reply to Andrey Loskutov from)Yes, I see that OOM Killer is active on the hippcentos slave. I will restart the slave once the last ep47I-unit-* builds are done (in 1.5h from now).To stop other jobs from piling up, I put the platform HIPP in shutdown mode and will also restart it once the jobs are finished.I'd suggest to dial down the number of executors on the hippcentos slave, especially because hippcentos is not only used by the platform HIPP.hippcentos slave and Platform HIPP master have been restarted. I've reduced the number of executors on hippcentos from 4 to 2.(In reply to Frederic Gurr from)Frederic, we have a problem with low number of executors on hippcentos. Right now (and since yesterday) the 2 available executors on hippcentos are fully fully blocked by platfrom nightly builds.If I understand it right, we run two nightly platform builds on *same* machines reserved for Gerrit builds, and nightly builds block all available executors for half a day. Can we please decouple platform Gerrit builds from nightly platform builds, so that they run with separated hudson instances?(In reply to Frederic Gurr from)Which other projects are on the same machine? I agree with Andrey that the Eclipse top-level project should have a designated machine. The IDE project is getting more and more active and it looks like we have outgrown the shared server instance.Looking atit seems like lots of projects are running on the same hipp10.Many project are prefering CentOS over SUSE to run UI tests because of(In reply to Andrey Loskutov from)Frederic, any news on that? Our Gerrit is not operable anymore most of the time. The 2 platform builds eat all our time (they run over 6 hours), and the rest is blocked by builds which need to be restarted again and again due other infrastructure and test instabilities.Please move Platfrom UI from that HIPP or change back the executors number to 4.(In reply to Andrey Loskutov from)Too many executors have the side effect of causing OS to kill jobs (because of lack of resources).I believe what would really help here are more CentOS-based slaves.(In reply to Lars Vogel from)The hippcentos slave is currently connected to the following HIPPs:* CBI* GEF* Shared* PlatformPlatform is using it the most though.(In reply to Frederic Gurr from)Could we get our own slave? See, the current configuration and instability is slowing down significantly platform development.(In reply to Andrey Loskutov from)I'm reluctant to increase it to 4 because it increases the chance of OOM errors, therefore I have set it to 3 for now.I understand that the Platform HIPP requires more resources for building and testing. Unfortunately we can't just offer a dedicated slave to Platform without making this unfair for other projects.We will try to upgrade hippcentos to a machine with more resources in the future.----Apart from that, I think in general 6 hour+ long builds/tests are far from CI best practices and should be broken down into smaller pieces or changed to staged tests (do we really need to run ALL tests every night?).(In reply to Frederic Gurr from)Those test do find issues regularly. Removing the test execution comes with a high risk of reducing feedback loop, reducing team productivity and product quality.Hardware is meant to serve humans, not the other way round ;)(In reply to Frederic Gurr from)I don't understand this sentence. It seems that we need more resources for our development. How is this unfair to other projects? If other projects need more resources, they should also get them.The current situation is affecting the speed and quality of developments for the Eclipse SDK which is the basis for many other Eclipse projects.(In reply to Frederic Gurr from)Thanks!Let say it this way: the life is not fair anyway. If Platform UI can't deliver, others will not be much happier because they sit on top of our code and see all our bugs plus they own dog food.Could you please create a dedicated bug for that and add some estimation? I would like to trace the progress on it :-)I don't know much about CI best practices but even 6 hour+ tests aren't covering all what we should actually test. We have way to less tests in Platform UI.What does "staged" mean? I really have no idea. If the test coverage will remain same and we can gain something from it, why not?I guess, I had it coming...(In reply to Mickael Istria from)I agree, but we should try to use it efficiently. It's cheap but not free. :)(In reply to Lars Vogel from)If platform asks for a dedicated machine and gets it, how can we deny other projects the same service? Unfortunately resources (hardware and humans) are limited though.I'm not denying that Platform requires more resources and we will try to improve the overall situation.(In reply to Andrey Loskutov from)If you are the reporter, we save a few clicks. ;)+10 for more tests.For example, some basic tests can catch 80% of common errors but only take 20% of the time. Only if those basic tests don't fail, more detailed tests will be executed. Highly specific tests could only be executed every few days. As always: YMMV.(In reply to Frederic Gurr from)I've filed. Feel free to fix the description, since I have no idea which HW is needed etc.(In reply to Andrey Loskutov from)If we look at the root of the issue, it's just that because of, we had to move the Gerrit jobs for Platform to CentOS only rather than all Linux slaves (since update to newer -but worth?- SLES on CI). So this workaround added much more load to CentOS instances, and drove to resource issue.Onceis fixed, we'll be able to get back in a less stressful state for centos slaves, and should see way less failures.Summarizing, we have frequent test errors, and we think fixingwill solve most of them. If the above is correct, I'd lower the importance of this bug.Our Hudson jobs continue to fail regulary. SeeThe failing infrastructure impacts our developments. This slows down Eclipse platform development and that is a very bad thing.Frederic, anything you can do to improve the situation?(In reply to Patrik Suzzi from)I'd like to stress the indirection that Mikael summed up in.(test failures on SLES12 based HIPPs) is the reason why platform jobs have been moved to the hippcentos slave. The CentOS slave has become overcrowded and therefore kills jobs randomly (OOM killer). The randomly killed jobs cause the tests to fail (not the problem described in).(In reply to Lars Vogel from)I noticed that the last three builds (starting with #11483) ran successfully. Did you change something that has caused this?I currently don't see a viable solution for. Therefore moving all UI tests to CentOS based slaves seems to be the best option. I will try to get a new CentOS slave provisioned, but can't give a time frame for it.Just for the record: all last seven (!) I-builds startig from I20161226-2000 had DNF in org.eclipse.e4.ui.tests.css.swt.CssSwtTestSuite.The last successful run was I20161219-0145.Also I see Gerrit builds failing again for same reason.If this is HW/OS problem with centOS slave, why it happens for those tests only? We have LOT of testsuites with various load, but only css tests are crashing (or, better say, killed).What those tests are doing differently so that Eclipse is killed? Is this really a limitation of memory/whatever, or may be a real SW problem with our code?see "e4.ui.tests.css.swt" row for example here:quote from:java-test: [echo] Running org.eclipse.e4.ui.tests.css.swt.CssSwtTestSuite. Result file: /opt/public/hipp/homes/genie.platform/workspace/ep47I-unit-cen64/workarea/I20170104-2000/eclipse-testing/results/ep47I-unit-cen64_linux.gtk.x86_64_8.0/org.eclipse.e4.ui.tests.css.swt.CssSwtTestSuite.xml [echo] timout property: 7200000 [echo] frameworkvmargs: -Xms256m -Xmx1024m -Dhttp.proxyHost=proxy.eclipse.org -Dhttp.proxyPort=9898 -Dhttps.proxyHost=proxy.eclipse.org -Dhttps.proxyPort=9898 -Dhttp.nonProxyHosts="172.30.206.*" -Dhttps.nonProxyHosts="172.30.206.*" -Dftp.proxyHost=proxy.eclipse.org -Dftp.proxyPort=9898 -Dftp.nonProxyHosts="172.30.206.*" -Djava.io.tmpdir=/opt/public/hipp/homes/genie.platform/workspace/ep47I-unit-cen64/tmp [echo] vmargs: [echo] extraVMargs: [echo] frameworkperfargs: [echo] crash loglocationarg (if any): ${loglocationarg} [echo] crash loglocation (if not default): [java] INFO: timeoutScreenOutputDir: /opt/public/hipp/homes/genie.platform/workspace/ep47I-unit-cen64/workarea/I20170104-2000/eclipse-testing/results/ep47I-unit-cen64_linux.gtk.x86_64_8.0/timeoutScreens [java] INFO: timeout: 7200000 [java] starting EclipseTestRunner Timer with timeout=7080000 at 2017-01-04 23:17:34 -0500 [java] Java Result: 137collect-results:[junitreport] the file /opt/public/hipp/homes/genie.platform/workspace/ep47I-unit-cen64/workarea/I20170104-2000/eclipse-testing/test-eclipse/eclipse/org.eclipse.e4.ui.tests.css.swt.CssSwtTestSuite.xml is empty.[junitreport] This can be caused by the test JVM exiting unexpectedly@Frederic: you mentioned that you have access to /var/log/dmesg and saw OOM Killer traces in the log. Is this still the case? Is there anything useful except "killing java" process in the log? Linux OOM Killer has no preferences to kill our CSS tests only, so if there would be not enough memory, it would kill ANY of our test suites, but we don't see crashes except for the CSS testsuite, so I wonder if there is anything else killing us?(In reply to Frederic Gurr from)As said, the only testsuite we see killed is org.eclipse.e4.ui.tests.css.swt, like here:It is terminated randomly but pretty often, and no other testsuites are affected, so I doubt this is due Linux OOM Killer.(In reply to Andrey Loskutov from)OOM killer was active and killed Java processes. I've restarted hippcentos, so it should be better for a while.As far as I understand, the kernel uses a heuristic to determine which process can be killed to free up memory without breaking the system. The UI tests seem to be a good target. I assume(!) the SWT tests use a lot of memory and trigger the OOM killer.The easiest solution is to give hippcentos more memory. We will try to move some VMs around to achieve this.	35.0
id=79991	REOPENED	Platform	UI	3.1	PC Windows XP	P3 normal	Platform UI Triaged	2004-12-02 06:52 EST by	Markus Keller	2014-06-13 10:25 EDT (	3 users	'File > Save As' doesn't update navigation history:- open a file f.txt, then open a file x.txt- File > Save As, enter y.txt, Save- File > Close-> new file y.txt does not appear in File > 'Recently used files'-> new file y.txt does not appear on Navigate > Back	As perRemy is now responsible for watching the [EditorMgmt] component area.This no longer seems to be a problem with Version: Luna (4.4)Build id: I20140528-2000Thanks for verifying.PW(In reply to Markus Keller from)I can still reproduce these problems in I20140528-2000.Thanks Wojtek.	6.0
id=85331	REOPENED	Platform	UI	3.1	PC Windows XP	P3 normal	Platform UI Triaged	2005-02-15 16:28 EST by	Eric Moffatt	2006-11-15 14:08 EST (	6 users	The 'isActivated' check uses the 'isVisible' method to determine the activation state. There are at least two cases where this can lead to a change being left 'uncommitted'...1) If the PropertySheetPage hosting the editor is contained with a TabFolder then clicking on a different tab will not commit the change. This is because the FIRST thing it does is to make the previously selected folder invisible. This means that by the time the CellEditor gets the focusLost event it's 'invisible' and no commit occurs. While this may arguably be deemed a defect in the TabFolder for not gaining focus on LButtonDown there seem to be other cases where the editor can be made 'invisible' before the lost focus event occurs...see below.2) If that TabFolder is inside a Dialog then hitting the "X" to close the dialog exhibits the same behaviour...no commit.I'm using a 'single select' version of the PropertySheetPage and I'm only using the standard editors for text and combo.	CreatedUse the style bit rather than 'isVisible' which may give misleading infoAs per Nick's suggestion...txNick , could you please apply this patch for me ??ThanksPatch released. Eric, can you please verify it?Note that I changed the commented you added to be an implementation comment rather than an API comment.Fixed (tested by Krzysztof)...thanksThe second case of this issue (TabFolder is inside a Dialog then hitting the "X" button to close the dialog)is still occuring in Eclipse 3.2.1 .This defect should be reopenedRod, I'll re-open it but I doubt that the defect is serious enough to be accepted into the 3.2.x stream. If you think that this causes problems then comment here to make the case and I'll take a look...	7.0
id=88527	REOPENED	Platform	UI	3.1	PC All	P3 normal	Platform UI Triaged	2005-03-18 16:45 EST by	Pratik Shah	2007-07-19 10:07 EDT (	2 users	For the TextCellEditor, the actions aren't being updated enough to be in the right state all the time. I can override add/removeCellEditor to add additional listeners, but I need to be able to invoke updateActionsEnableState(). Can you make that method protected? Otherwise, the CellEditorActionHandler should itself be responsible for keeping the default action handlers in the right state all the time (which might vary slightly depending on the type of CellEditor).Is it possible to get this done for 3.1M6?	too late for 3.1?I'm afraid so.Pratik - can you please expand upon your first comment? In what cases should the actions be updated that we are not currently handling? It sounds like there are particular listeners that need to be added for different kinds of cell editors. Attaching your workaround code would help in explaining the problem.If it seems like a general problem and that extending the action handler is the right solution, we can make the method protected, but I want to explore whether this can/should be fixed inside.Currently, if you bring up a TextCellEditor with two words (say "some text") and all the text selected, you can follow these steps to see that the actions are not enabled properly:Hit "End" key. At this point copy, cut and delete should be disabled, but are not.Hit Ctrl+Shift+Left Arrow to select the last word. At this point copy, cut and delete should be enabled, but they are not.Again hit Ctrl+Shift+Left Arrow to select everything and then hit the backspace key to delete everything. At this point, cut, copy and delete are still enabled.This is reproducible in GEF's logic example. We do not have a workaround for this right now.The problem here is that the action's state at all times is what it should've been before the last keystroke, and is really caused by TextCellEditor. This bug was introduced by the fix for. TextCellEditor updates the actions' enablement on keyPressed() instead of keyReleased(), and hence before the change resulting from that keystroke is applied. As a result, the actions' enablement state is always one keystroke behind.There is a comment in TextCellEditor#createControl() that says that mouse and key listeners are used to determine selection changes because selection listeners are not supported. However, I see an addSelectionListener() in Text now (that probably wasn't there originally). Maybe the TextCellEditor can switch to using that mechanism? That will simplify the code, fix this problem, and hopefully won't break the API (since TextCellEditor is marked as not to be subclassed). Otherwise the simpler solution would be to update the actions' state not just when the key is pressed, but also when it is released.Sounds like a great opportunity to use asyncExec ;-)***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***just tried this using the propertysheet example and the menu seems to be correct all the time...Eric, can you clarify how you verified this? I am still seeing this problem in the property sheet with the EMF Ecore editor in 3.3RC4.I imagine Pratik is referring to the actions that are associated with keybindings. There is also a native context menu for a text control, but its contents are not related to the problem.Randy, I tried the scenario as described in...these are all 'standard' commands used by the Text control itself. It's conceivable that there may be some 'bound' Copy/Paste command in the ECore code itself I suppose...Pratik, What I did was to start a fresh workspace, connect to CVS and check out 'org.eclipse.ui.examples.propertysheet'. This is our reference implementation. Then run an 'inner' (i.e. through the 'Run/Debug' menu).In the inner, create a project (any type), add a file "foo.usr" to it. It should open the file and the Outline view should be showing some names (of golfers). If you open the Properties view at this point and select a name in the Outline you should see that person's 'properties'. At this point I activated a text editing control and ran your scenarios...As Randy mentioned in, I am talking about the copy/cut/paste actions under the Edit menu of the menubar, not on the cell editor's context menu. Is that what you were checking, Eric?Aha, yes indeed that was what I was looking at...I'll re-test and get back.	13.0
id=74073	REOPENED	Platform	UI	3.0	Macintosh Mac OS X	P3 enhancement	Platform UI Triaged	2004-09-16 11:16 EDT by	Elliotte Rusty Harold	2016-11-04 04:38 EDT (	14 users	On Mac OS X, if you close the Main Eclipse window the appication exist and themenu bar disappears. This is not consistent with Apple's Human InterfaceGuidelines (though it is how applications are expected to work on otherplatforms.) On the Mac, the application should only exit when the use selectsQuit from the Eclipse menu. The menu bar should remain present when the lastwindow is closed and allow the user to open a new window.	We could be sneaky about this and dork around with hidden windows and whatnot but this seems like a good candidate for 4.0. Though it only is readily apparent on the Mac the ability to have a windowless UI app is also applicable on other platforms. Ie: apps that dont have a window but live in the windows system tray. This would mean us reconsidering our actions/commands and see if it makes sense to have the ability for them to be keyed off the workbench instead of a particular window.As perPrakash is now responsible for watching bug in the [Mac] component area.CreatedPatch v01This feature doesn't make much sense from the IDE perspective, but should be useful for the RCP apps.The patch enables the windowless application + adds the feature to the IDE. When no windows are available, the main menu stays now with just one menu item - New Window.Boris/Paul, Need your inputs on this feature.From a Mac perspective that is not correct behavior. The menus in the menu bar are constant regardless of which windows are or are not on the screen. Menu items in the menus are usually constant as well aside from a few special cases like Bookmarks in a web browser. Menu items are disabled when they are not functional do the state of the application but they do *not* vanish and appear according the state of the application. This assists with muscle memory and usability. Arguably other platforms should do likewise. Tog on Interface laid out the reasons why 20 years ago, and nothing had change din that respect since. But certainly on the mac users expect that their menus are stable.(In reply to)The patch is not the final version :-) We need to rework on the other ActionFactory actions, WorkbenchSourceProvider, detached views etc to complete this feature. The patch is just to see whether this feature will work properly on Mac.(In reply to)If org.eclipse.ui.application.IWorkbenchConfigurer.getExitOnLastWindowClose() was always true in the past, then ideally you should make it so that a new workspace has it set to false on cocoa, but existing workspaces have it as true.As for WorkbenchWindow menus items, they'll disappear with the last window. The infrastructure that allows them to exist is totally gone with that last window. Even if you could make them hang around safely (and I believe that's not possible) it's a lot of work and there are much higher priority items we need to invest time in.PWScott, do you have any opinion on this?(In reply to)Although I did have an idea for a quick hack :-)Simply clone the SWT menu hierarchy so you have a dummy set of disabled SWT MenuItems. The you could leave New Window and Exit enabled. Of course, if they picked New Window you'd have to dispose your dummy menus.PW(In reply to)Well, starting in 3.7 you can address this with Display.getAppMenuBar(). Clone the workbench window's menus, as Paul suggested, and then add them to the Display's menu bar. For compatibility Shell.setMenuBar will still override the application menu, but when there are no more shells the Display's menu bar will be used.I agree, in principle, with the gist of the bug description: Closing the last window of an application shouldn't automatically exit the application, but I think that's mainly relevant only if you have a Mac-style, document-based application, like SimpleText or Xcode, for that matter. The workspace isn't a 'document' in the Mac sense of the word. It does behave like a document, though. Maybe the right behavior when you close the workspace should be to leave the Quit and Switch Workspace items enabled. File -> New doesn't make sense, because you can't create a project or file outside of a workspace. Preferences and About make sense, too -- I can't recall how many preferences are global in scope.CreatedPatch v02Patch v02.Hi! I think(In reply to)This is a *lot* of structuring and changing that I don't think is appropriate.If this is extra functionality that's supported on the Mac, can the application menu bar be filled in with the 3 or 4 items that would be appropriate in the cocoa fragment? Quit, Preferences, About, and New Window are obvious candidates.PW(In reply to)As per the functionality, the changes are minimal. If there is an appMenu available, then fill that menu bar. Major changes changes are in our actions, which assumes that there is always a workbench window available. Many actions are currently performing well without a workbench window (new, import, export, restart, switch workspace, clean, build, help, etc) Even earlier, it was possible for the client to invoke these actions without a workbench window (by a popup menu in a tray item) - it just that no one did that. If we are not comfortable about changing our actions, we can probably stop at giving ability to fill the app menu and not do anything in the IDE. As I've mentioned earlier, having IDE as a windowless application doesn't make much sense, but its a very valuable one for the RCP apps and clients already expect it (likeC#20).CreatedPatch v03Just the framework for supporting the windowless apps. No change in the actions/IDE to support this.CreatedA sample windowless RCP appChanges done for the default RCP mail app:(1) Added these lines IWorkbenchConfigurer.setExitOnLastWindowClose(false); IWorkbenchConfigurer.setSaveAndRestore(true);(2) Added application menu via the menucontribution in the plugin.xml to the application menu URI (menu:org.eclipse.ui.application.menu)(3) Made the bindings to be in the workbench context instead of default context, so that they are active when no windows are available.Now with the above changes, you can see that when no window is available, the application menu is displayed. Also, when a non workbenchwindow is active (like the message dialog), the application menu is displayed - instead of an empty menu.CreatedTestsCreatedzipped workspace to be in the o.e.ui.tests/data for testingPaul/Boris, I get so many CNF exceptions when I run the test WindowlessSessionTest.testWindowlessWorkbench() But when I run the test application directly, I'm not getting any errors. Any idea of where I'm doing wrong?For the menu that lives without any windows, the term Application menu could be misleading, as it might be ambiguous with the errrrr the "Application menu" (the one with the About, Preferences and Quit). Probably we should term this as Workbench menu and change the URI to menu:org.eclipse.ui.workbench.menu and rename methods accordingly.(In reply to)Paul/Boris, Any luck with the testcase?I agree that this could be interesting for certain RCP apps, but the Eclipse SDK should not behave this way. Eclipse is not a document-based application, and its primary purpose is not something that's often done in the background.Apple even has a specific guideline for this (see "Closing Windows"):We should keep behaving like iPhoto, Disk Utility, etc.CreatedPatch v04(In reply to)minor comments:shouldReturnNoWindowError(*) - shouldn't that use StartupThreading, like all other calls in the initialization?I didn't see a call to IMenuService#releaseContributions(*)PW(In reply to)But why? Its called in the initThread of openWindows().Is it ok to do that it in the shutdown() method?CreatedPatch v05Patch v05 (Patch v04+releaseContributions() call)Patch v05 released to HEADWow, that's quite a big amount of code for that (didn't check though whether this is needed or not).Do we really need the new context? It looks weird in the 'Keys' pref page:When: 'Workbench'.Also, it doesn't seem to work, e.g. if I assign commands using that context they won't be enabled - hence the context is very misleading. I think we should be very careful in defining a new context and avoid it if possible.(In reply to)We need a context to be activated when there are no workbench windows. Couldn't use existing ones for that.(In reply to)No other way to do that? I still think it's wrong that this appears in the UI.(In reply to)I didn't find any other way to do that. If it doesn't appear in the UI, then how does a user assign a key binding to a command when no workbench windows are present?(In reply to)Well, I would interpret 'Workbench' context as the context enabled when a workbench is active and not the other way around and I would also expect that if I bind an existing command to it (e.g. Save) it will work when a workbench window is active.A better name for the context might be "Application Menu" but that should only appear for Mac users. It doesn't make sense to pollute the UI for more than 90% of our users just to fix this bug.(In reply to)These are the general problems that commands don't declare their context (only key bindings can declare a context, see) and that the context hierarchy is not shown to the user any more ().Verified in I20110124-1800Looks like this fix did not make it into R4_development. Please close again if I was wrong.Aggregate move to M5. Retarget to a different milestone if you wish...Note that the first fix caused follow-up problems, see.I don't think the fix works in any of our current streams. It does not work for me on Mac 64bit with either 3.7.2 or 3.8M6.As it does not work in current 3.x streams, I don't that it is a "must have" for 4.2 at this time. Another point to consider is that, as said inandthis feature has rather dubious value for Eclipse. As Scott said, about the only useful items we can have in the "windowless" menu would be "switch workspace". "quit", "about", and, possibly, "Help".(In reply to)It's correct and intended that the Eclipse SDK still exits when the last window is closed. This bug only added infrastructure for products which opt-in to this behavior by calling IWorkbenchConfigurer#setExitOnLastWindowClose(boolean)In the SDK, the only visible difference is probably that the org.eclipse.ui.contexts.workbenchMenu key binding context is not defined in 4.2. But applications that enable this behavior will have a hard time on 4.2.Related commits:The Gerrit's review link with back port for master:Daniel(In reply to Daniel Rolka from)What is the purpose of the patch? What exactly does it fix? How is it related to commits mentioned in?To test the patch, I created an RCP mail template app and modified its ApplicationWorkbenchAdvisor class by calling configurer.setExitOnLastWindowClose(false) in the initialize(*) method. Then I run the app in Eclipse 3.7.2, 4.5 and 4.5 with the patch.In Eclipse 3.7.2 it works as expected - closing the app's window doesn't close the app, the app icon is still present in dock and menu.In Eclipse 4.5 (without the patch) the app crashes when closing its window (NPE Workbench.getActiveWorkbenchWindow(*)).With the patch the app doesn't start (NPE in WorkbenchMenuService.getMenuModel(*));(In reply to Wojciech Sudol from)It seems the patch needs to be more adjusted to the new E4 architecture. Unfortunately its original version is not applicable for 4.5 without any changesI will try to fix it,DanielFrom reading the history of this bug -- even though I don't understand it :) -- seems clear no one is "close" or "actively" working on a fix for 4.4.2. (It had originally been targeted to 4.4 M5, and then re-opened, so I believe it "got lost") I'll move to "Mars", but if anyone knows better, feel free to set as you like. (Or, "unset" if even Mars is out of the question).As everybody agreed, the behavior of the Eclipse SDK should not change (neither on the Mac nor in general).Adjusted the summary. This bug is now about making IWorkbenchConfigurer#setExitOnLastWindowClose(boolean) work (again).As long as nobody has an actual use case for this and nobody commits to working on a fix, it doesn't make sense to have a target milestone set. Clearing target.Maybe the trigger for this bug was actually/, which finally made the "Confirm Exit" dialog work on the Mac as well.	47.0
id=123400	REOPENED	Platform	UI	3.2	All Windows XP	P3 normal	Platform UI Triaged	2006-01-11 04:43 EST by	Yves Harms	2013-07-10 00:04 EDT (	5 users	When undocking a view it always stays on top.This behaviour makes this "undocking feature" pretty useless for us.It should be possible to bring the app window into the foreground (at least optional). I see two ways to achieve this:- let the view implementor decide if the view should be ON_TOP or not (optional flag)- add a minimize button to the view windowThis applies to 3.2M4 and 3.1.1.	(In reply to)I prefer the first option, and would even argue that the !ON_TOP should be the default. But in any case, those of us writing our own Views would like to be able to make them not always on top.This will either be covered as part of making the DW's first-class shells or making their visibility dependent on the activation of the 'main' shell. Giving fine-grained visibility control here will lead to users 'losing' their DW's.For what it's worth, I agree with the original reporter, in that I think the use of detached views is degraded by them always being on top. I thought the purpose of the detached view was similar to the minimize/hide function of attached views - to free up screen real estate until the user actually wants to see the view. But obviously, if the view is still on top, no screen real estate is freed.So may I suggest that proper closure of this bug should include a description of what the intended use is for detached views? My apologies if this information is spelled out elsewhere...if it is, I think it should be linked to from here.***has been marked as a duplicate of this bug. ***Hello all.I am not pleased that the bug is now marked as: "Won't Fix". I'll address the big points after the important points. 1. The problem is not: "on-top". 1.1 The window is ALWAYS_on-top (you can't see the display) 2. Any non-dialogue window MUST be 'normal' -- That means exhibit the same behaviour of any other normal window (not a dialog or prompt, etc). Minimize, maximise, re-dock/undock, etc. What ever makes sense to the User Experience (UX) model. 3. I note that I concede it is the VIEW designer to choose initial pop-out attributes (if they 'care'). 3.1 My assertion is that the end-users (in all use cases) are the ultimate arbitrators. 3.2 Provide View or Window options to help people do their paid work, their community projet work, and have fun! Most comments seem to basically concur with the initial description. I concede that the person designing a View ought have the "first" say about the pop-out window's initial attributes (Always_On_Top or "standard").That only makes sense if the view designer feels his/her window is so IMPORTANT that it must block all of the display(??). I'm not convinced there are many cases like that.To me, a "must have" is that the pop-out window can Minimize. It is a workspace window, why must it be non-Minimized?@Joshuaj>> proper closure of this bug should include a description of what j>> the intended use is for detached views?This description would fill a large Olympic sized swimming pool, signifying nothing in my opinion. There are millions and millions of examples where and depending on what a designer, SA, tester, coder, QA person, Project Manager, BI consultant, etc, etc ~WANT~ to see and How they ~Want~ to see it.However I concede to radical views such as leaving the user in control as much as possible (so called, user-centric UX philosophy). 'Today' I am a developer (user) and I cannot SEE the dialogues and output console messages because the pop-out I dragged over 'there' can't be minimized or made 'Normal' (= NOT Always_On_Top).Tomorrow as a RAP or SCOUT end-user my pop-out window might hide some key stock-market tell and allow me to crash the whole global financial system because I didn't kill the pop-out I really (actually wanted to have aside on my screen), oops well we'll just blame the "computer system" again shall we?~~ I won't do more. The key choice is: are the End-users in-power, or are they drones controlled by Eclipse? It is philosophical I know. Back in 1985~ish, the users were drones largely controlled by user interfaces driven by IBM 1400 series controllers. Almost 30 years later; people tend to shy away from that kind of facism (mostly). I don't consider this current (Kepler) behaviour to be a new feature; it is a lament on the user experience taking power from the "customers".(In reply to)This was closed as wontfix 6 years ago. Your diatribe is as misplaced as it is inappropriate in an OSS setting.That being said, I'll reopen so anyone that's interested can contribute. We have 2 weeks of Kepler M7 left to accept contributions, otherwise it would be early Luna.SeePWHi I am running the latest version of Eclipse Kepler and I noticed that when I undock the console view I can't put it back in the editor. Also it always stays on top even though when I right click it it shows and Always on Top option which doesn't make much sense to me since it is always on top for me anyway. Is there a way to redock the item back into the editor? Also, is there a way to have it go behind so that it is not on top of all my other windows I may be using at the time when clicking on the eclipse app? Thanks for your help. Also, I am new to this bug site so forgive me if this is not the place to post this comment.Thanks, BenEclipse Standard/SDKVersion: Kepler ReleaseBuild id: 20130614-0229Benjamin, which platform are you running on ? Windows doesn't seem to provide a menu item for 'Always on Top'.IMO about the only thing that might be *possible* here is to at least provide the ability to minimize the DW.I am running on ubuntu 13.04 3.8.0-26-generic #38-Ubuntu SMP Mon Jun 17 21:43:33 UTC 2013 x86_64 x86_64 x86_64 GNU/LinuxIt seems that Always On Top was the linux window system from a right click on the Console window once it was out of the Eclipse and on it's own. Basically once the Console window comes out of eclipse it stays on top by default. Also, is there a way to dock it back into the eclipse environment panes, once it is out, there is no way that I can see to get it back in the editor.	10.0
id=129936	REOPENED	Platform	UI	3.2	PC Windows XP	P3 enhancement	Platform UI Triaged	2006-03-01 08:32 EST by	Martin Aeschlimann	2009-11-11 17:32 EST (	4 users	20060301When a view part has a longer description and several toolbar action, the description is cut off and I can't a way to get the full text expect by expanding the view.See screenshot. There seems to be enough space for the description of a view part to wrap. Maybe limit it on 2 lines if you think this is a problem.There should be at least a tooltip that shows the full line.	CreatedscreenshotI've modifed this to an enhancement request...Boris, I'm guessing that this constitutes view 'management' but feel free to punt back (or forward) if you think otherwise...any plans to fix this for 3.2?Consider this case when looking at new e4 presentation issues.CreatedScreen shot for text wrappingWorks for me in build I20090803-1800CreatedAnother screenshotI think for the Search view had special processing was added in Eclipse 3.4 - see SearchView class from org.eclipse.search bundle; ver. 1.65; changes to #updateLabel().In general case, in Eclipse 3.5, we don't resize control / wrap, but we do have the full description in the tooltip - see the screenshot attached.I tend to agree with Dina's "works for me". We could add automatic resize to the description control to multiple lines. However, if we have to allocate limited screen estate between the view contents and its description, in my opinion, the view contents should get the priority.It's not fixed.Most views don't show a description, so if the implementer decides to show one then it should be visible and he should not need to do tricks like the Search view.Remy is now responsible for watching the [ViewMgmt] category.	9.0
id=134086	REOPENED	Platform	UI	3.3.1	PC Windows XP	P3 normal	Platform UI Triaged	2006-03-30 11:01 EST by	James Kingdon	2007-10-30 11:26 EDT (	1 user	This is a little bit tricky to reproduce, the key is having the window the right size.1) Open the J2EE perspective, reset to defaults if necessary.2) Open a console view3) Select the servers tab4) Resize the servers window until the debug/run/etc buttons pop to the line below the tabs5) Resize the servers window until the debug/run/etc buttons *JUST* pop up to the line with the tab. Make sure the window is not resized again during the rest of the test.6) Select the console tab, and close the console view7) Make sure the Servers view is displayed, then re-open the console view8) If the defect has been demonstrated, the buttons for the console should be in the normal place, and the buttons from the servers view should be displayed on the line below. These buttons are still active! Note that the appearance is different, but still incorrect, if the console has been used before the above procedure is run. In this case, because the console window has extra buttons, the console button bar is drawn underneath the servers button bar instead of above.9) Switching between tabs corrects the displayThe problem has been observed both on windows and linux, and I don't think it is specific to the particular windows described above.	James, can you supply a screenshot? (a picture is indeed worth a 1,000 words in these cases...;-)CreatedScreen shot showing incorrect buttonsAs requested, screen shot showing buttons from servers view inappropriately drawn in the console view. Red highlight added to indicate incorrect buttons.And this is a 3.1.2 problem? Hmmmm.It's similar to a couple of other I have open likebut I'm going to wait until I can confirm it before I close it as a dupe.PWCan you reproduce this in 3.2.x? Preferably M6 (which will be out by Monday).PWIs this still a problem in 3.3?PWThe latest driver I have to hand is 3.2.1 which still has the problem.I'll try and grab a later driver when I get some more time.Oh, this is still a problem in 3.3, but a dup.PW*** This bug has been marked as a duplicate of***This bug still reproduces in the latest download from eclipse.org(Version: 3.3.0 Build id: M20070921-1145)And confirmed still present with Version: 3.3.1, Build id: M20070921-1145.	10.0
id=135451	REOPENED	Platform	UI	3.1.1	PC Windows XP	P3 normal	Platform UI Triaged	2006-04-07 01:15 EDT by	vin2000	2008-04-15 08:59 EDT (	0 users	Hi,when i select multiple UI elements and right click, the context menu has multiple entries of the same menu.problem description with an example!-i have an object contribution on objects A and B.-both these derieve from the super class Z. the comman menus required are put under the object contribution Z.- now when i select 2 objects of the same type , things work fine.- but when i select 2 objects, one of type A and the other of type B, then the menus under the object contribution Z apper multiple times. regards,vineeth	Boris, I think this is one ot the cases you mentioned.I mentioned prompting for save on editor close, nothing about context menus. Assigning to Paul...Vineeth, which version of Eclipse are you using? Is it 3.1.1 as specified in this bug? Have you tried Eclipse 3.1.2 yet?(In reply to)The version of eclipse is 3.1.1. Version 3.1.2 is not being used and supported by my company. ill have to stick to 3.1.1 .*** This bug has been marked as a duplicate of***This is an object contribution bug, based on org.eclipse.ui.popupMenusPW	6.0
id=141102	REOPENED	Platform	UI	3.2	PC Windows XP	P3 normal	Platform UI Triaged	2006-05-10 13:51 EDT by	Cary Sweet	2008-04-09 10:24 EDT (	1 user	Call Hierarchy defined as a tabbed viewPackage Explorer is defined as a Fast ViewStart on Class A (any class)Go to a method and Right Click on Open Call HierarchyClick on a class other than the current one (Class B)Note: Class B is now active in the editorOpen the Package ExpolorerPackage Explorer has Class A still highlighted (instead of Class B)Click on the editor (which still has Class B)Open the Package ExpolorerPackage Explorer has Class B is now correctly highlightedClick on the editor	Was able to reproduce this even with the resource navigator, so I believe this is a problem with part activation events.We can discuss tomorrow, but I don't believe it's an event problem.If you have both classes open and you are using the Call Hierarchy view to switch between them you are changing the editor but not activating it. As soon as you activate the editor, it links to the correct file.The package explorer doesn't have to be a fast view to show this behaviour.This might be fixable by having the navigator and the package explorer listen for partBroughtToTop() as well as partActivated().Is this behaviour consistent with 3.1.2?PWIs this still a problem in 3.3?PWChanges requested onCreatedPatch to provide the requested behaviour for the Navigator.Reproduced on I20070920-0936. Should a separate bug be filed for JDT?CreatedUpdated patch against HEAD.This is still a problem on I20080401-0851.Released to HEAD >20080408PWThis is only partically fixed in the Resource Navigator, seePW	8.0
id=150008	REOPENED	Platform	UI	3.2	All All	P3 enhancement	Platform UI Triaged	2006-07-07 11:58 EDT by	Markus Keller	2013-06-05 10:43 EDT (	3 users	I20060704-0800Make 'Navigate > Show In' enablement user-configurable (per perspective). This has already been raised in the original 'Show In', and it is still an issue.Currently, I e.g. can not invoke 'Show In > Package Explorer' from the Synchronize view when I'm in the CVS Repository Exploring Perspective (or a customized perspective derived thereof).Like other perspective-dependent settings, this should be configurable in the 'Customize Perspective' dialog.	There are currently no plans to work on this.This is one of the last remaining holes we have when it comes to perspective configuration by the user.Boris, this would be a nice 3.7 item.Internal note: Perspective.java rev. 1.193 contains the code to save the ShowIn targets on shutdown and read them on startup.Removing outdated target milestone.	3.0
id=151086	REOPENED	Platform	UI	3.1.2	PC Windows XP	P3 normal	Platform UI Triaged	2006-07-19 10:17 EDT by	Tracy Hodges	2010-01-27 08:35 EST (	0 users	When the SourceLookupFacility reuses an already open editor (openEditor method calls setInput), the new IEditiorInput is not added to the workbench's editor history.If a page.openEditor is called, then the workbench editor history is updated.Problem can be demonstrated with the JDT.To recreate the problem: Make sure the Run/Debug preferences is set to reuse editors Set a breakpoint somewhere in a Java program (The breakpoint will need to be several calls deep through different classes). Close All Editors (Open and close enough editors on class files you will not be debugging, to fill up the MRU with irrelevant files) Execute the Java program and hit the breakpoint. The file with the breakpoint should be opened automatically. Notice that the file should have been added to the MRU (under the File menu) Now using the Debug View, click back into the stack frame to a method that is in another class. The editor should switch to that class. Check the MRU list. It should not be showing the 2nd class like I think it should.Basically, SourceLookupFacility.openEditor(...) will call setInput on the editor directly if it is an IReusableEditor and it is already opened. This bypasses the IWorkbenchPage.openEditor call. If the IWorkbenchPage.openEditor call was made, then eventually the workbench's EditorHistory would be modified.The IWorkbenchPage interface defines a reuseEditor() method that I think should be being called instead.	Using IWorkbenchPage.reuseEditor(...) lead me to this error:Problem detected with part org.eclipse.debug.ui.sourcelookup.CommonSourceNotFoundEditor (class = org.eclipse.debug.ui.sourcelookup.CommonSourceNotFoundEditor): Editor is not firing a PROP_INPUT event in response to IReusableEditor.setInput(...)Fixed in SourceLookupFacility and CommonSourceNotFoundEditor.fixed, pending verificationDoesn't seem to be working when you select another frame.The following simple exmaple demonstrates:public class C1 { public void foo() { System.out.println("breakpoint"); //breakpoint here }}public class C2 { public static void main(String[] args) { C1 c1 = new C1(); c1.foo(); }}Run C2 following the steps above, and notice that if you select the stack frame for C2 while suspended at C1, the C2 editor is not added to the MRU editor list.As we are now using the workbench page's method I'll kick it over to them for comment.Punting to BorisCannot reproduce. WorkbenchPage.reuseEditor() was changed as part of the fix for, which might have fixed the issue described here as well.I have retested this myself again using the 3.4 codebase. The problem is still present and easily reproducable. NOTE: You must have the debug preference 'Reuse editor when displaying source code' set to checked.Reopening the issue.	7.0
id=173004	REOPENED	Platform	UI	3.3	PC Windows XP	P3 normal	Platform UI Triaged	2007-02-06 03:12 EST by	Krzysztof Daniel	2007-03-28 15:32 EDT (	1 user	Build ID: I20061214-1445Steps To Reproduce:1. Create GEF Project (Logic example).2. Select multiple objects3. See propertyViewMore information:Only the first selected object properties are displayed.	CreatedBlanking not equal property valuesDisplays empty string when properties are not equal.Daniel, is this a duplicate of the patch that you added to?If not then remove the un-dup this one with an explanation of how they're different.*** This bug has been marked as a duplicate of***Ooops, just saw randy's comment and agree that this is a somewhat different case...	3.0
id=69953	REOPENED	Platform	UI	3.0	PC Windows XP	P3 normal	Platform UI Triaged	2004-07-13 14:00 EDT by	May Zhu	2009-11-24 09:38 EST (	3 users	when switch between "Task" and "Properties" view, all contents in the "Properties" view are missing, the view changed to pick up the table view of "Task".	Sorry, can you please clarify? Exact steps would help.Note that the Tasks view is not a property source, so the Properties view willbe empty when the Tasks view is active. If the Properties view is activated, it keeps the property source from thepreviously active part. This is working in 3.0. E.g. selecting a resource inthe Navigator, then activating the Properties view, still shows the resourceproperties.If you open a file, e.g. XML schema or Java file, as you select an object in the editor, the properties of the object will be displayed in the properties. Now if you clicked on "Task" view for some reason (e.g. adding a to-do task), then you want to switch back to the "Properties" view, what you do is to click on the "Properties" view tab. Now the contents displayed in the view before is gone, the view pick up the table view in "Task" with nothing displayed thereI see. You have the Tasks view and the Properties view stacked together, so itfeels like selecting the Tasks view should just hide the Properties view, notchange its contents. But in fact what happens is that the Properties viewtracks the active part, so when you activate the Tasks view, the Properties viewis blanked at that time (since the Tasks view provides no property source). Then when you activate the Properties view, it is still blank rather thanshowing the same content it did before it was hidden.We could change the Properties view to only change the source when a new sourceis available, but this might be confusing. E.g. if I select A, B, C, D, andonly A provides properties, then the Properties view would still show theproperties for A, even though that may be far from my current "context".Alternatively, the Properties view could check the active view first, then if itdoesn't provide a property source, check the active (frontmost) editor.This would address your case, and would be less likely to cause confusion thanthe approach in the previous paragraph.We have got similar user feedback on this problem. The users thought that theproperties view wasn't working properly. It seems that a lot of views are engaging the Properties view when they havenothing to show. Could some work be done come up with a better definition ofwhat a property source is? Regarding what to show when a user has selected multiple items only some ofwhich have properties, what may help is to at least indicate somewhere in theProperties view what object(s) properties are being shown. If there are multipleitems, the indication could show: <n> items selected and then show propertiesfor the first (or last - pick one) item selected or all the common elements ofproperties for those objects that have properties. (There are probably someother solutions to this).Reassigning bugs in component areas that are changing ownership.CreatedUpdated test casesSeeabout the patch requirement.This patch contains updated tests which shows how properties view should work if it is hidden/visible again.The testcases will work only with patch provided for.Committed in >20090401. Applied the tests patch...Andrei, the NewPropertySheetHandlerTest was passing even before I applied the 'fix' patch in 268676, is that OK?Adding iplog for Andrei...thanks !Thanks Andrei, marking as FIXED by the code committed in.Verified in I20090428-0100.Fix has been delivered and verified.Seems that recent fixes forbroken the behavior of Properties view again (at least in 3.5 RC3), and this bug has to be reopened...I'm wondering what is happened to the tests I've commited, they should fail if they were enabled. Any idea?Another failing use case is from:Properties view which shows the editor related content, looses it after switching to the tasks view and back (tasks view from the same view pane).So now with 3.5 RC3 we are again at the beginning of this bug...Can somebody (Remy?) with enbough rights reopen this bug?(In reply to)We turned one of them off in.Createdfixed again, plus test enabledIt turned out that the commit from Paul (version 1.21 from 05.05.2009) where he removed "hidden" flag has broken the previous fix again.With the attached patch I re-introduce the patched code, including all patches AFTER version 1.21 AND with enabled test case (again green).It would be GREAT to have it back in 3.5 before final release...@Remy: I'm not the reporter of this bug, so I can't reopen it again.Can you please reopen it?Removing iplog+ from bug - this indicates an IP contribution in a commentrather than a patch.CreatedShows two unpinned PV's with different stateAndrei, I've just tested your patch and notice the following behavior:I have two 'unpinned' property views (PVs) open; one in the same stack as the Tasks View and one in its own stack, both visible. I select an element in the Package Explorer to prime them (i.e. they now both show the file's properties).Now I activate the Tasks view (causing the PV in its stack to become hidden). The PV in its own stack goes blank. Now if I click on the PV that was hidden it's still showing the file's properties. This means that I now have two unpinned PV's showing different information.I think that Susan gives the correct definition of this problem in; the base issue is that too many views are acting as property sources when they really have nothing to offer (causing the PV to go blank). One approach to fixing this would be to add a new extension point through which a plugin could explicitly declare that a particular view (by id) does not participate in the property mechanism and augment the 'isImportant' method to pick up this new info. We should also determine why so many views cause this issue, is it the default behavior? Note that not all views do this...the Decorations view for example does not (you can make it active and visible PV's don't change state).Re-opening defect as the issue hasn't been correctly addressed.(In reply to)I can't reproduce it. BTW, the picture you've attached shows two PINNED views.You mean? Similar also to... But this is again a new feature and in my opinion belongs to the new bug.Not sure what you mean by "Decorations view". I cannot find a view (except exlicitely hardcoded Help view exception) which does NOT disturb the properties view from SAME view stack.This bug is about properties view content loss after activating ANY other view in SAME view stack. This is very annoing behavior, especially if you have workflow based on editors where the properties view allows to change editor content. Basically you can't use any other view in SAME stack while editing inside the properties view, otherwise you will get a customer defect, see alsowhich describes a similar issue.It's obvious that if Properties view is hidden by another view, it does NOT make sense to change the content of it, because 1) it is invisible2) after properties becames visible again, the "new" content source is gone because it is hidden by the properties view now...The patch I've proposed solves exactly this one issue. Even with additinal extension point the current bug will remain: a view which is expected to provide properties view content, will break the scenario above if it will be in the SAME view stack as properties view.CreatedCorrect attachmentSheesh, my apologies...I shouldn't respond to defect before finishing my first coffee...;-).I also meant the 'Declaration' view (it's in the image).The issue does, however, exist. What do you get when you try it ?Createdexperimental fix including isImportant patch, plus test enabled(In reply to)Ok, the view I've never used ;-) If I understood it properly, it can be related to the fact, that this view does not set selection provider for the site. Such views are probably rare.Yo've right. I've tested the *unpatched* Eclipse ;-)But I think that the case where 2 NOT pinned properties view are active is rather academic and has much smaller (or not at all) impact to the "editing" workflow. The original issue is very "practical" one - our customers are complaining that our (dumb) software can't hold the focused properties object properly. From the user point of view the bug is so silly...The second issue (you've pointing to) can be however fixed if the Properties view would not blindly implement selectionChanged() for ALL selection change events from ANY view.isImportant() implementation is somewhat strange: I would expect it would check whether the part returns something useful to getAdapter(IPropertySheetPage.class).I've attached my last patch with additionally improved version of isImportant() method. I can't judge yet if it works for all use cases, but at least this matches the class javadoc, stating: "The property sheet view asks the active part * for its property sheet page; this is done by invoking * <code>getAdapter(IPropertySheetPage.class)</code> on the part"So now it seems that the original request is fixed AND much less views are disturbing Properties view.I didn't run all UI tests, but I guess they still must pass also for the second patch.Ok,I've run all UI tests, many (or most of) PropertySheet tests are failing with the experimental patch, most of them because the (wrong) assumption that ANY view acting as selection provider CAN contribute to the Properties view (SelectionProviderView is used as the source for Properties view BUT does not implement getAdapter(IPropertySheetPage.class)).Createdexperimental fix #2 including isImportant patch, plus testsUpdated "experimental" patch which fixes tests code (implement getAdapter()) in two test views used by tests. Currently only 1 UI test is still failing: org.eclipse.ui.tests.services.EvaluationServiceTest.testRestriction()line 263: assertTrue(contextService.getActiveContextIds().contains(CONTEXT_ID1)); fails. It uses some SelectionProviderView's in the test, but not sure how the failure is related to my changes on getAdapter().Anyway, the change in isImportant() seems to fix theas well, because there is ALREADY an sign if a particular view supports Properties view: getAdapter(IPropertySheetPage.class) must return non null value. In my opinion, Properties view was just not properly implemented from very beginning :-)Andrei, I'd first like to say that I really do appreciate the effort that you're making here. As committers one of the things we get drilled into our heads is that fixes requiring everybody to get on board by making changes is essentially a non-starter because we've learned that many groups simply don't want to (or can't) invest the time to make the changes.I'm pleased that you ran the tests and picked up the fact that the 'isImportant' code you added was preventing many -valid- property providers from working...but...the fix is most certainly *not* to start changing the view specifications. Over all of galileo we have many 100's of views, most of which we don't own, how are you going to get all of them to change?My concern with the approach is that simply -ignoring- events while the view is not visible (unless it correctly brings itself up-to-date when it becomes visible) isn't a viable fix. This is IMO a case of trying to fix the symptom rather than the problem.As you say we need a more fine grained mechanism to distinguish between parts that should update the PS and parts that shouldn't. Since we have the time (nothing is going to happen here until 3.6) we should take the opportunity to re-examine what we're really trying to do here.Resetting target. If we want to re-examine the mechanisms we should do it in the 4.0 context I think.	26.0
id=236054	REOPENED	Platform	UI	3.3.2	PC Windows Vista	P3 normal	Platform UI Triaged	2008-06-06 10:29 EDT by	Carlos Ortiz	2014-08-29 16:31 EDT (	2 users	Build ID: I20070621-1340Steps To Reproduce:1. Detached any window [ console for example]2. Move the Detached window to a other screen 3. Move the screen of position , for example if your second screen the one on the right on move his position to left , none of the Detached window position are update, so they are impossible to see or interact with then , you must reset the perspective so you can see the Detached windowMore information:I'm guessing that Detached windows position are fixed when windows do a change of position it remaps all the screen resolution , example screen a is 0,0 and 1280,1024,screen 2 is 1280,0 when i move the screen 2 to the right screen 2 new position is -1600,0, so if the Detached windows position is 1600,500 if the screen position change now the new position must be -1600,500 but the detached window position is 1600,500	Carlos, I think that if you shut down and restart it should at least force the DW's onto the display. I added code to handle this because more and more folks are using laptops which, when docked, may have two monitors but when the laptop is not docked there's only one display.I'm not actually sure how trivial this is since it would require that SWT be able to report these type of changes the same for all the supported platforms...Hi, Just for the record, not even a PC restart doesn't work only a perspective restart works, I put the bug as trivial since is just a bit annoying to reset and rearrange the views of a perspective,.By the way i can confirm this bug in xubuntu 8.4 with all the updates , with the latest Ecplise stable linux version.Carlos, what happens on an eclipse restart? Could you provide screen caps of the 'before' and 'after' for some of the scenarios?***has been marked as a duplicate of this bug. ***Tried this with Eclipse Luna 20140612-0600 on Linux Mint 16 KDE.Following the steps to repro, I cannot reproduce: if the main window is on screen A and the detached window on screen B and A is on the left on B, when I move B to be on the left of A the main window is moved to B and the detached window is moved to A, by actually maintaining the relative position of both windows. Trying this back and forth behaves correctly.Since I cannot determine when it was fixed, I mark this as "WORKSFORME". If you can still reproduce (in particular, I can't test on Windows and it may behave differently there) please reopen.Mauro, you can not test a bug on Linux that is reported on a PC-Windows-Vista. The bug still exists and driving me crazy!Still exists on Version: Luna Release (4.4.0)Build id: 20140612-0600(In reply to Peter from)Since a lot of work has been done in this area since 2008 and that most of the Eclipse Platform features and behaviours are platform-independent, I thought that testing this on another platform were still useful, especially since this bug has been stale for years.Reopening as per comments 5 and 6.Yes, many bugs has become stale, but closing will indirectly close clones too who has been reported in the past or/and will be reported in the future by "CLOSED DUPLICATE".(In reply to Peter from)The intention is not to close bugs BECAUSE they are stale, but in contrast to triage them with a recent Eclipse build to revitalize them and let the committers focus their efforts only on currently valid reports. Please see discussion at.	10.0
id=179628	REOPENED	Platform	UI	3.2.2	PC Linux	P3 normal	Platform UI Triaged	2007-03-27 20:11 EDT by	Fabio Zadrozny	2008-05-16 12:46 EDT (	1 user	Build ID: Version: 3.2.2Build id: M20070212-1330Steps To Reproduce:Version: eclipse 3.2.2OS: Ubuntu (vm is sun 1.5)When some action is defined with Ctrl, and there is some other action that is defined with Ctrl+Shift, the action with Ctrl+Shift seems to be always executed (at least in my tests).E.g.: In pydev, Ctrl+3 is comment and Ctrl+Shift+3 is uncomment, and pressing Ctr+3 calls uncomment and not comment.I've done some tests, and in ubuntu having a keybinding with Ctrl+Shift+xxx will be called even when Ctrl+xxx is called -- and that keybinding isn't even defined (I'm attaching an example where ctrl+shift+7 is defined, and doing ctrl+7 will activate that action).Thanks,Fabio	CreatedSample plugin project where this happensFabio this works fine for me on linux. CTRL+K and CTRL+SHIFT+KDo a CTRL+SHIFT+L ... can you see the commands in the popup? What about in the keys preference page, which you sort by keybindings ... can you see any conflicts.Create a debug options file withorg.eclipse.ui/debug=trueorg.eclipse.ui/trace/keyBindings=trueorg.eclipse.ui/trace/keyBindings.verbose=trueorg.eclipse.ui/trace/commands=truethe run eclipse with -debug <file>Attach a trace of what you see when you do CTRL+SHIFT+3 vs CTRL+3Later,PWNo, there are no conflicts there (I've checked this a lot)I'll create the debug file and attach it later today (when I'm at home again)Are you in ubuntu edgy? (that's the version where people complained about -- I've been able to reproduce it in 6.10 -- I'm also not discarding that this is actually an ubuntu bug... hopefully the debug file will give you that info)It seems to be a feature of GTK+ ... ctrl+shift+[1-9] are interpretted by GTK and not processed correctly by the WorkbenchKeyboard. I assume its to be used to enter unicode characters.PWctrl+shift+[1-9] was part of the legacy GTK+ way of entering unicode chars.PWSince I'm still seeing this bug in Eclipse 3.3.2 under Ubuntu 8.04, why did you say "was" and "legacy"?And is there any known way to disable this "feature" of GTK+? I've tried some google searches, but apart from setting "gtk_key_theme" to "Emacs" instead "Default" (which didn't help) I didn't find any information on this topic./usr/share/themes/Default/gtk-2.0-key/gtkrc contains only this note:## Default keybinding set. Empty because it is implemented inline in the code.#Any help would be very appreciated.Ciao, Steffen(In reply to)>I'm not sure why you are seeing this. If I assign CTRL+SHIFT+5 to about dialog command, it works fine. In my version of GTK+, CTRL+SHIFT+U is used for entering unicode. gtk2-2.10.4-16Maybe your system has a configuration file that tells GTK+ to "do it the old way".PWAccording to my understanding of the problem you have to define another command to CTRL+5 in addition to defining CTRL+SHIFT+5 as about dialog.Due to the issue pressing CTRL+5 would then open the about dialog (though bound to CTRL+SHIFT+5) and the command you've defined for CTRL+5 can't be invoked at all using CTRL, 5 and whatever.Ciao, SteffenSweet merciful stuff ... I totally misread the problem. My apologies.PWStrangely enough, I restarted eclipse with some trace options:org.eclipse.ui/debug=true#org.eclipse.ui/trace/graphics=trueorg.eclipse.ui/trace/keyBindings=trueorg.eclipse.ui/trace/keyBindings.verbose=true#org.eclipse.ui/trace/sources=trueorg.eclipse.ui/trace/commands=trueorg.eclipse.ui/trace/handlers=trueorg.eclipse.ui/trace/handlers.verbose=trueorg.eclipse.ui/trace/handlers.verbose.commandId=org.eclipse.ui.help.aboutAction#org.eclipse.ui/trace/contexts=true#org.eclipse.ui/trace/contexts.verbose=trueNow CTRL+7 and CTRL+SHIFT+7 work. I used Preferences>Keys to bind them to Add Bookmark and About respectively ... I also had to unbind the JDT keys for CTRL+7 in java editing context.PW(In reply to)it seems to be a transient state ... I tested it out and it appeared to be a problem. Now I cannot reproduce it in my workspace (even with tracing off). I reset all of the bindings (so the JDT ones are in place) and run my tests in the text editor (which should not be effected by the JDT key bindings).It works fine (CTRL+7 and CTRL+SHIFT+7 execute the different commands).PW	11.0
id=238901	REOPENED	Platform	UI	3.4	All All	P3 normal	Platform UI Triaged	2008-06-29 04:44 EDT by	Andreas Goetz	2009-11-26 09:46 EST (	1 user	Copied from new://eclipse.platform.swt:Using a TableViewer with ILazyContentProvider, the provder's updateElement method is _always_ called when selection changes (e.g. keyboard navigation), regardless if table row already has an associate data element (AbstractTableViewer#VirtualManager#getVirtualSelection). This breaks performance, as - multiple unnecessary calls to updateElement are issued and- updateElement cannot be used to perform batch updates in this caseStack trace of the updateElement call:Thread [main] (Suspended (breakpoint at line 105 in ContactsView$ContactsContentProvider)) ContactsView$ContactsContentProvider.updateElement(int) line: 105 TableViewer(AbstractTableViewer).getVirtualSelection() line: 497 TableViewer(AbstractTableViewer).getSelectionFromWidget() line: 468 TableViewer(StructuredViewer).getSelection() line: 972 ColumnViewerEditorActivationStrategy.isEditorActivationEvent(ColumnViewerEditorActivationEvent)line: 47 TableViewerEditor(ColumnViewerEditor).handleEditorActivationEvent(ColumnViewerEditorActivationEvent) line: 436 TableViewer(ColumnViewer).triggerEditorActivationEvent(ColumnViewerEditorActivationEvent) line: 680 TableViewer(ColumnViewer).handleMouseDown(MouseEvent) line: 664	Createdmylyn/context/zipmylyn contextThe behaviour observed seems to contradict the ILazyContentProvider docs at:updateElement(int index) Called when a previously-blank item becomes visible in the TableViewer.How important is it that we fix this? (The fix would likely be in the Javadoc)Hi Boris, not doing any strategic projects here, but not sure about the javadoc fix. I fail to understand why updateElement requires to be called when element data has already been associated. Also, some eclipse examples indicate using updateElement for batch updates- which doesn't make sense if it gets called per item? I.e., shouldnt it rather do like VirtualManager.addTableListener? if (element == null) { // Didn't find it so make a request // Keep looking if it is not in the cache. IContentProvider contentProvider = getContentProvider(); // If we are building lazily then request lookup now if (contentProvider instanceof ILazyContentProvider) { ((ILazyContentProvider) contentProvider) .updateElement(index); return; } }I looked into the CVS history for this method (all the back to 2005) and agree that we don't need to call the content provider for items that already have a non-null getData().Createdpatch proposaHi Boris, tried to be a little proactive here and have created a patch for you. Couldn't test it though as I have no idea how to make my application depend on the checked out jface package. I'm especially unsure if it can be doGetItem or if it shouldn't rather be getElementAt.I've also cleaned the cachedElements access- I believe this is already encapsulated in VirtualManager.resolveElement?Had to add element = doGetItem(selectionIndex).getData();to your patch.Patch released. Thanks!Reopening - this fix has caused a regression (see) and I had to revert the change.Boris, I've tried reproducing this with the SampleHandler sample attached tobut am unable to. Any idea how to progress with this?Excerpt from: virtual table viewer as used in Open Type JDT dialog misses to display certain items on Linux. Issue has not ben reproducible on XP. It was verified that the content provider correctly supplies the items.(In reply to)Not really. Paul, which version of GTK do you have? I am suspecting a GTK problem, or perhaps a bug in SWT that JFace is masking by looping over all selected items and calling contentProvider.update on them.(In reply to)I have gtk2-2.10.4-20 and I'm running the default Gnome window manager. I'm on a distro based on RHEL5.2.PWMoving to M2.Cannot help unfortunately- Windows only.Removing target milestone. Unfortunately, I don't have the time to investigate this.Hitesh is now responsible for watching bugs in the [Viewers] component area.	18.0
id=204971	REOPENED	Platform	UI	3.3.1	PC Linux	P3 normal	Platform UI Triaged	2007-09-28 21:57 EDT by	Sergey Prigogin	2009-11-17 10:53 EST (	2 users	Open Resource dialog often freezes for up to 5 seconds with "Searching 23%" displayed in the right corner, usually after typing one or two characters. Both typing and mouse operations are blocked in that state. This behavior almost nullifies the advantage of the fast search the dialog provides.All ongoing activity should be immediately canceled when a user presses a key or clicks on something.	I've done a quick test in 3.3 (but not 3.3.1) and am not seeing this behaviour. The message you describe sounds like it might be the indexer running, but that should only be possible immediately after loading resources or a full build and doesn't match your "often" comment. I tried with 20 projects loaded (most of org.eclipse.ui to org.eclipse.ui.workbench.texteditor).Can you please describe approx the # of project/resources you have loaded? Also, let us know if there's anything particular about your setup or usage (e.g. many linked resources).The workspace contains a single project with 15 linked folders. There are just a few files included directly, the rest 30K files are under the linked folders. The files are on NFS.The duration of the freeze varies from time to time, but the long freezes are not uncommon.Although this isn't a deadlock, can you attach a stack dump from the time it is frozen as described here:That will tell us exactly what's going on at the time it is frozen.CreatedFew stack snapshotsThe stacks are obtained with 3.4M2.Please let me know if you need me to do more experiments.Thanks for the stack traces Sergey. The freezing is caused by a Perforce plugin: at java.io.FileInputStream.read(FileInputStream.java:194) at java.io.BufferedInputStream.fill(BufferedInputStream.java:218) at java.io.BufferedInputStream.read(BufferedInputStream.java:235) - locked <0x9d4df3e8> (a java.io.BufferedInputStream) at com.perforce.p4api.PythonMarshall.readObject(PythonMarshall.java:144) at com.perforce.p4api.PythonMarshall.readDictionaries(PythonMarshall.java:45) at com.perforce.p4api.PerforceConnection.exec(PerforceConnection.java:404) at com.perforce.p4api.PerforceConnection.exec(PerforceConnection.java:329) at com.perforce.p4api.PerforceFileAccess.statFiles(PerforceFileAccess.java:288) at com.perforce.team.ui.PerforceAccess.statFiles(PerforceAccess.java:317) at com.perforce.team.ui.decorator.Folder.getFiles(Folder.java:112) at com.perforce.team.ui.decorator.PerforceDecorator.decorateText(PerforceDecorator.java:349)That decorator really shouldn't be doing long-running work such as reading files from disk. I suggest reporting this to the provider of the Perforce plugin.However, it's possible the dialog could handle this by performing decoration in a background thread. Moving to UI for comment.(In reply to)Thanks for the quick response. Indeed, disabling decorations eliminates the problem.Thanks for the help John.Its a good point that perhaps we shouldn't be doing this in the foreground. In theory decorators can be quite slow (e.g. get version info from a server).I've renamed the bug title to denote the real platform UI specific part of the bug. Routing to Tod for comment.I'm not clear whether the suggestion is to do something specific in the open resource dialog or handle this at the decorator level. Routing to the [Decorators] component for comment.(In reply to)It was that we might be able to do more decorator work in a background thread. But the work itself is all in the extender, and as I think about it, that'd mean changing the contract with the callers on which thread we're issuing work on, so I don't see this change happening.I'm closing this bug since the original problem (bad perforce decorator) is not eclipse, and I don't see anything else realistically that we could do to improve things. Please reopen, or open a new bug, if ideas.(In reply to)Could you please elaborate on the contract you referred to and the place where it's documented. Eclipse has a long history of moving work from UI to background threads. How the decorators case would be different from previous ones?I strongly disagree with this assessment. The problem is not that the decorator is bad. Some decorators should be assumed to be slow since they do complex work. The problem is that the dialog executes decorators synchronously in spite of the fact that the decorations are not essential for the primary function of the dialog.Oleg is now responsible for watching the [Decorators] category.	11.0
id=217974	REOPENED	Platform	UI	3.4	PC Windows XP	P3 minor	Platform UI Triaged	2008-02-06 05:47 EST by	Tomasz Zarna	2016-10-12 23:51 EDT (	26 users	Build: I20080205-0010Set up:I've got several workspaces (eg one for Team/CVS/Compare plug-ins, one for CDT etc). All of them share the same location for runtime workspace.Steps to reproduce:1. Run "Eclipse Application" from CDT workspace2. Open "C/C++ Perspective"3. Close the application4. Run "Eclipse Application" from a different workspace5. The "C/C++ Perspective" is unavailable, this is expected6. Try to remove (close) it in the perspective bar => nothing happens	Similar problem:I was using eclipse 3.4M1 (for example) with the Mylyn plugin. The mylyn perspective was in the perspective bar. Today, i download 3.4RC2, launch it, and i select the same workspace in my file system. So i have a "wrong" perspective icon (with a good tooltip), and when i try to close this perspective icon, nothing happens.In previous versions of eclipse (< 3.4 ?) the perspective icon was removed in that kind of case.CreatedPatch fixing this issueHere is a patch fixing this issue. If a perspective descriptor cannot be retreived from the registry, it iterates over the currently open perspectives to find one.Thanks Mark ! I'll take a gander at this after we get 3.4 out the door...***has been marked as a duplicate of this bug. ***Is it not possible to fix this for 3.4?Not really, at this point we only address 'stop ship' issues and I can't make the case for this one...I found a similar issue - I was using Europa plus a third-party plugin that contributes a perspective. Then I download Ganymede and start it up WITHOUT the third party plugin installed, but the perspective still exists and is empty - and there is no way to close it.I came about the same problem when removing one of my plugins from my configuration with one of the perspectives still open. After restarting the IDE, I am now unable to close this perspective. I'm guessing that this should be fixed by this patch.Still in 3.5M3 ...The patch seems straightforward to me.Are there any concerns with this issue still?Not really, just waiting for a chance to review it. The patch is fairly straightforward but wouldn't it be better if the (newly) bogus perspective was never 'opened' (i.e. detect that it's bundle is gone and not open it) ?We just kicked this around at our weekly meeting and have come up with the following:Leave the Perspective open and allow close as per the patch.Have the 'Reset Perspective' command show a dialog indicating that it cannot be reset because its factory bundle is not available (with a 'Save as...' option?).We decided that there are too many work flows where the perspective may be 'transiently' unavailable (usual case is getting a fresh eclipse install and opening it to use the install manager to re-install the other plugins).This is essentially the fix as proposed with the added work to manage the reset (which would fail because it uses the factory...).Upshot: under this scenario everything works as expected except that some views are likely to be missing (if they were defined by the same package(s) that defined the perspective, which will be fairly common) and that the reset will give you a warning about the bogosity of the state.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***CreatedProposed fixThe original patch fixed the Close issue but the bogus perspective would have broken the environment in other ways; Reset, DnD...This patch turns the offending perspective into a 'custom' perspective on activation. This allows it to become a 'real' perspective in the environment, meaning that all operations work correctly.I'm still testing edge conditions but if anyone wants to give it a try and get back the info would be appreciated.Kevin, one downside to this is that we end up with a perspective that purports to be the original but is simply a copy (i.e. if the original plugin were to come back it would -not- just take this perspective back, it's a one way street).Given that I'm thinking we should provide at least some affordance to indicate what we've done.Log a warning/error?Modify the label? (i.e. Foo -> <Foo>) ?Change the icon (the original icon is also likely not available) ?Other?Also, another possible approach was suggested that would -remove- the offending perspective from the set of currently open perspectives. If it was the active perspective then another would be chosen, if it was the only one then the 'default' perspective would be opened (the expectation is that this would -not- be the default perspective).If anyone would like to give their thoughts on which of the two would be best now's your chance...we face the same issues within a perspective as far as missing views go and perhaps we can find a common pattern to handling these issues.***has been marked as a duplicate of this bug. ***Kevin, I'm going to commit this patch as is (i.e. with no indication that you now have a 'clone' rather than a 'real' perspective.Feel free to post any suggestions and we can incorporate them later (but soon...;-). Right now it's just plain busted.Sorry I missed commenting on this.How about changing the label to "Copy of XXX" and dropping something in the log?The main problem with 'Copy of <x>' is that the strings get severely truncated in the Perspective Switcher (for example I'm now seeing "Team Synchr..."). This means that pre-pending a string would likely result in the truncation of the 'real' name...Adding a logged message is a fine idea, I'll take two (but only log one...;-).How about (In reply to)How about "* <Perspective Name>"? Might be too subtle but at least gives some feedback and when you bring the real one back in they aren't identical. Plus we already use * for dirty which kind of fits.I'm not so sure about using "*" because in our environment it means 'this is something you can/should save' which isn't really the case here. How about just using '<PerspName>' ?Committed in >20090305. Applied the patch with the following changes:changed 'fixZombie' to 'fixOrphan'Log a warning that the perspective has been made localChange the 'cloned' perspective's label to <oldLabel>Kevin, we can revisit this post-M6 if you'd like...Seeing all the problems of keeping the perspective, forcing the close would have been a better choice.The reason for keeping the perspective open is explaned in, and doesn't seem doable by the final decision.I agree with- just close the perspective. To satisfy, when closing the perspective you should keep the perspective layout, so that in future if the correct plugin is re-installed and perspective is available again with exactly the same settings as before.Eric, what happens if I have preferences contributed by a plugin, I've modified them, and I remove that plugin? (e.g. JDT preferences and I remove JDT). Do the preference values stick around? If I add the plugin back, do I get my modified values?Kevin, it depends where they're stored. AFAIK once there's a (non default) value in a particular pref store it's maintained through the save/restore cycle regardless of where it came from. If it were in a pref store that the JDT saved/restored in its own memento then I'm pretty sure that it would also be maintained.The decision to keep the 'copy' as a valid perspective rather than closing it was made mostly because closing it brings up other issues; What happens if this was the -only- perspective open? What if it was the only -available- perspective?I won't say that this is an ideal solution, just that it's better than what we have...I'd welcome a patch that allows the 'copy' to be subsumed back into a 'real' perspective if the bundle re-appeared but it's non-trivial so I was hoping to defer these type of patterns until it can be done as part of a general strategy on managing plugin dynamism.Re-opening...further testing reveals that if you go through the cycle twice* the second attempt to save the perspective as a 'copy' fails.* by twice I mean...open persp 'Foo', shutdownclose Foo's project, restart (persp is turned into '<Foo>'), shut downopen Foo's project and restart, then open 'Foo' and shutdownclose Foo's project and restartNow we have issues because we have -two- '<Foo>' projects...CreatedPatch to find an unused perspective idThis is a temporary work-around that just keeps adding <'s and >'s to the perspective id until it finds one that isn't being used...I'll leave this defect open for a more refined fix post-M6...(In reply to)I guess the difference is that for prefs, they can hang around all you want and it won't matter because the pref page that would've accessed them is also gone. So nobody is the wiser. The problem here is that we want to keep the perspective around for the reasons you stated below.Would you be broken? ie. do we have other bugs where we assume you must have at least one perspective, or there are things you can't do to get yourself out of trouble if you don't have one?Could you still run Install to get the feature back though right?I don't mean to repeat the entire thread of decision here, but I noticed that you've reopened this because of another bug now, which makes me wonder if it's the right path.I'm -sure- it's the wrong path...;-).I think the pattern we should be aiming for is the one we use for Views/Editors; we open an 'Error Part' that acts as a layout placeholder for the element and magically 'restore' it once the contributing bundle is available again. In this case it would open an 'Error Perspective' with the same behavior. It's not quite as simple because the Perspective is a container rather than a discreet part so it introduces questions as to how to keep the original (real) perspective's layout across sessions while showing something different (the Error Perspective) in the meantime. We also have issues with allowing the user to modify the Error Perspective since we won't be saving/restoring its layout...The question is whether or not we have the cycles to address this in 3.5. Closing the failing perspective is looking more and more appealing.(In reply to)Right, except as you note below there are things you can do to perspectives that you can't to zombie views/editors. We'd need to disable Customize, etc. etc., since presumably when the real one came back any mods would be lost anyway.I think we can get away with a minimal approach here. My working assumption is that this is only an intermediate state -- eventually the person will either get the plugin back which contributed the perspective, or will close it because it has no value with the plugins gone. I think the original intent here was just that the zombie perspective not do bad things (e.g. throw exceptions), and that it be clear to the user it's some brain-dead (or brain-eating, to carry the zombie theme along) stand-in.Agree.Yeah, I can see the possibility of having to work through every operation we can do to perspectives.So there are 2 important cases:* intermediate state : the plugin has disapeared for some time : no modifications to the perspective will work, but when the plugin will be put back, everything is the same* definitive state : the user won't reinstall the plugin and wants to be able to close the perspective and all settings (layout, ?) can be lostIf the user still want to modify a "zombie" perspective, he should carry his mistake.Do you agree?Yes, there are the two use-cases you mention. Unfortunately we have no way to tell on a startup -which-. That's one of the main advantages of the 'Error Part' approach; it's maintained so that -if- the bundle comes back so does the part and folks who never expect to go back can simply close the part.Kevin, note that it's not just 'Customize Perspective', it's -all- operations that change the perspective; opening new views, re-arranging stacks...I guess the question is where we want to go with this for M7. I'm less than satisfied with the current <foo> solution but it's far better that a true 'zombie' (i.e. it's half-dead...you can see it and change it but not close or reset it) that we had. It it good enough for 3.5 or is there more work necessary in M7?* intermediate state doesn't require to be detected* definitive state could be solved by letting the user manualy close the perspective (even without reseting all associated settings)So why would you detect "bad perspectives" on startup ?Technically the issue is that when the bundle is not there we cannot instantiate the IPerspectiveFactory needed to perform such operations as 'Reset'...that leaves the perspective in an non-deterministic state (i.e. some things work some don't).Deferring to 3.6 for creation of a proper 'error perspective' placeholder.Deferring due to lack of cycles...The patch to find an unused ID doesn't work if the perspective label contains spaces. It compares the perspective label to existing perspective IDs, which works if the label will be used as the new perspective ID--but when the perspective is created, spaces in the label are replaced with underscores to form the ID. So if you have an orphaned perspective called "My Perspective", the code will try to create a new perspective with the label "<My Perspective>" and ID "<My_Perspective>" every time.How do I remove such an orphaned perspective? After an upgrade, I made the mistake of switching to a perspective before I installed the plugin. It now has the angle brackets ("<My Perspective>"). When I reinstalled the plugin I got the new "real" perspective. I would like to remove the useless orphaned-angle-bracket perspective but I can't see where to do so. I've tried grepping the .metadata directory to no avail...(In reply to)This is not too hard: Open: Window>PreferencesSelect entry: General>PerspectivesMark the "orphan" perspective in the perspective list ("Available perspectives")- the "Delete" button should now be enabled - and press "Delete"is this planned to be fixed sometime in 3.6 release (3.6.2?) ?Due to this bug whenever orphaned perspective is present and I change the perspective to another perspective, all the views present in orphaned perspective throws error that saysUnable to read workbench state, problems occurred restoring -could not find view - xyzAnshul, If you close the orphan perspective do these issues persist ?NO, once i close the orphan perspective then i get NO such exceptions.(In reply to)	46.0
id=243076	REOPENED	Platform	UI	3.4	PC Linux	P3 normal	Platform UI Triaged	2008-08-04 12:42 EDT by	William Deans	2008-10-07 10:32 EDT (	2 users	Build ID: I20080617-2000Steps To Reproduce:1. Use alt-f-s to save your work2. Eventually ... on my platform on my build the File menu item itself will become grayed out so that no file actions may be activated from the menu. This always eventually happens but I cannot make it happen at will.3. Closing and opening Eclipse solves the problem.More information:Eclipse PlatformVersion: 3.4.0Build id: I20080617-2000Linux deans2188 2.6.24-19-generic #1 SMP Fri Jul 11 21:01:46 UTC 2008 x86_64 GNU/LinuxUbuntu 8.04java -versionjava version "1.6.0_10-beta"Java(TM) SE Runtime Environment (build 1.6.0_10-beta-b25)Java HotSpot(TM) Server VM (build 11.0-b12, mixed mode)	Can you still save with Ctrl+S? Are the other menus greyed out too? If not, have you ever seen those greyed out?Are there any errors in your error log? <workspace>/.metadata/.log?Please re-open with requested information.PWGreetings,Thank you for looking at this issue. I think I may have found the source of the problem and it is a bug with vmware where keyboard mappings are lost:Since it is a bug with vmware I suppose this issue should remain closed? Or should eclipse be updated to better handle the error condition in which the proper keyboard mapping is lost?Hope this helps,WilliamPS: If you want to re-open it please let me know and I will fire vmware back up and get you the error log you request.It's fine resolved with it being a vmware problem. If you are able to reproduce it without vmware (or there is a useful error in the error log) please re-open and I'll have another look.PWCreatedfile menu item grayed outVMware released version 6.5 of their Workstation product which was suppose tosolve the issue of losing the keyboard mappings. I upgraded to this versionyesterday and rebooted. I have not seen the keyboard mappings lost since but Idid experience the loss of the File menu item today in Eclipse so I amreopening the bug. I have attempted to provide all the information youpreviously requested:a) I have provided a screenshot of the lost file menub) I have attached the error log. I do not know if it is useful.c) Ctrl-S still appears to function properlyCreatedlog file -- useless?	7.0
id=253002	REOPENED	Platform	UI	3.4	All All	P3 normal	Platform UI Triaged	2008-10-31 13:16 EDT by	Kim Horne	2010-04-12 09:47 EDT (	7 users	I20080911-0800CompoundContributionItem will dispose of old items, but only when the menu is shown. This has the effect of temporarily leaking old items. Could this not make use of IMenuListener2 to dispose of the items on menu close?	CreatedCompoundContributionItem early disposal v01Paul, can we look at this together tomorrow?if (display.isDisposed()) { dispose.run(); } else { display.asyncExec(dispose); }Questions:1. Can the display even be disposed at this point? This code is called from menuAboutToHide().2. By doing the work in an async exec, could we end up with empty menus in some cases?CreatedCompoundContributionItem early disposal v021) you're right, were in the UI thread event loop when this is calledThis is the updated patch.2) as it turns out, this doesn't have the same problem that I was talking about with PopupMenuExtender. We copy out the items for dispose, so that when the asyncExec runs it cannot overrun the new items.PW+1. Would be good to either check for display.isDisposed / PlatformUI.getWorkbench().isClosing() in the runnable, or add a comment that calling dispose on IContributionItem has nothing to do with SWT resources or Workbench resources.(In reply to)Released to HEAD for I20090511-2000I added a check for display.isDisposed() just to be careful.PWIn I20090514-2000PWThis causedSteve, what we were doing was creating an asycnExec in the Menu SWT.Hide. On windows, the asyncExec Runnable would dispose the MenuItems before the submenu actually disappeared (even though the SWT.Hide has finished processing).Should the menu not simply disappear after the SWT.Hide is finished?PWAre you telling me that you got to watch the items be disposed when you did not do the asyncExec() on Windows but the behavior was different elsewhere?Steve ... hmmm. I'll say right!On windows, we launch the asyncExec from the SWT.Hide and it is processed before the submenu disappears. We watch all of the menu items disappear, and then the submenu disappears.On linux, it works as expected (the menu just hides normally).PWSilenio we were talking about event ordering and menus disappearing on windows.PWPaul, do you know what is the behavior on Mac (carbon and cocoa)?Felipe, please investigate if we can make SWT.Hide come after the menu is hidden.public static void main (String [] args) { Display display = new Display (); Shell shell = new Shell (display); final Menu menu = new Menu (shell, SWT.POP_UP); MenuItem item = new MenuItem(menu, SWT.PUSH); item.setText("File"); item = new MenuItem(menu, SWT.PUSH); item.setText("Edit"); item = new MenuItem(menu, SWT.PUSH); item.setText("view"); shell.setMenu(menu); menu.addListener(SWT.Show, new Listener() { public void handleEvent(Event e) { System.out.println("show: " + menu.getVisible()); } }); menu.addListener(SWT.Hide, new Listener() { public void handleEvent(Event e) { System.out.println("hide: " + menu.getVisible()); } }); shell.setSize(50, 50); shell.open (); while (!shell.isDisposed ()) { if (!display.readAndDispatch ()) display.sleep (); } display.dispose ();}Windows and cocoa:show: truehide: trueGtk and carbon:show: falsehide: falseSSQ, who is right ?	13.0
id=263511	REOPENED	Platform	UI	3.4.1	PC Windows Vista	P3 enhancement	Platform UI Triaged	2009-02-03 13:42 EST by	Thomas Kratz	2010-12-10 18:56 EST (	1 user	Around my work with MessageManager/Databinding integration I got the idea to work on a ValidationStatusProvider that validates content of an editable TableViewer. The Problem is with EditingSupport that validation happens only when Items are edited, and messages get lost when leaving the cell editor.So far so good attached is the hack I have so far (I only have IObservaleSets as input) I abuse an totaly abnorm IObservable wrapper for the table to make the messageManager render the decoration on the table. The only way to get this message out to the messagemanager seems to be getModels().Any ideas on improving this will be appreciated. I thought of decorating a concrete TableItem thats erroneous but MessageManager only decorates Controls. Any ideas on using a decorating label Provider ?see also	with help from matthew hall it got even easier and more flexible.Thomas, were you going to post an attachment?Matthew, I was straight up to do this when I noticed that it didn't work. I post the demo app instead which demonstrates my problem with the validator does not get notified when updating the cell. Maybe you can have a look it it, it should work quite straightforward.CreatedDemo to show problemCreatedUpdated snippetYour MultiValidator was working correctly. It was the code that adds listeners to all validation status providers that did not work. What you want to use is AggregateValidationStatus.If this class doesn't do what you want, it would be easier to observe all the validation statuses like this:IObservableList validationStatuses = BindingProperties.validationStatusProviders() .values(BindingProperties.validationStatus()).observe(bindingContext);This will give you an IObservableList<IStatus>WORKSFORME. If I missed anything please reopen.BindingProperties was only added 4 days ago so you may need to update from CVS to get it.Hi Matthew, this is all quite nice (don't clearly see the bug be now), but I need the ValidationStatusProvider to get the targets/models for the stati. I then use MessageManager to decorate the appropriate widgets. If you have any hint how the solve this in another clean way, let me know. I tried the latest code from cvs but it gives me more headache :) see(In reply to)Are you talking about ControlDecoration / FieldDecoration ? Personally I think we should add support for those right into jface.databinding. I don't know anything about MessageManager so it would help if you could spell out that part a little more.MessageManager simple takes a control with its message that then gets decoratet. I inspect the targets/models to find the control thats bound. Thats all.(In reply to)Please provide an "unclean" example of how you decorate controls currently so I can see the problem. Standalone snippets are best.Clearing target milestone until more information is providedCreatedDecorating Controls from ObservablesHi Matthew, look at the still buggy code I attached. Its in "guessControl" what I actually mean. Should be straightforward.Ran out of time for 3.5.	14.0
id=244316	REOPENED	Platform	UI	3.4	PC Windows XP	P3 major	Platform UI Triaged	2008-08-15 12:09 EDT by	Kevin McGuire	2014-07-02 06:21 EDT (	14 users		3.4 final1. Startup eclipse SDK (this step required to ensure you haven't tried this menu item in this session)2. Pick File->Switch Workspace->OtherNOTE: nothing happens. No dialog, no error, and nothing in .log.3. Repeat step (2)You will get the dialog successfully.Same seems to be true for first time selection of any workspaces in the menu.Hmm. I haven't been able to reproduce this on the latest 3.5 build. Are you still seeing this?I will have a look(In reply to)I still cant reproduce this on Windows or Mac. Have you been seeing it?/nagHitesh, could you look into this? I think I just saw this on a recent Win32 build.We have had this issue reported here as well (Eclipse 3.4.1 on Windows XP). There appears to be nothing in the log file. If I can find a way to reproduce it I will report back.Removing 3.5 target milestone. We are in the end-game now. Please have a look and decide if this should be targeted at 3.6.Prakash is now responsible for watching bugs in the [WorkbenchLauncher] component area.Still reproducing in Eclipse 3.6, but only sometimes! I can't understand what are the conditions under which this happens. I'm using Eclipse for Win64 under Windows XP Professional x64 Edition.A coworker of mine was able to reproduce this almost always on his 3.5 installation some weeks ago. He is working with Windows XP Professional (32-bit edition).I can't remember any log entry was produced.Just as a data point, I have seen this happening for some time now (since the feature was implemented), on both on Windows and Linux versions.***has been marked as a duplicate of this bug. ***I ran thru this and not able to reproduce the issue. I had a code walkthrough and couldn't find a path that doesn't show the dialog.Hi Prakash,Could you try on 3.4.2?PWOne possibility to reproduce: bring up eclipse on a new workspace. Open File> Switch Workspace>Other (make sure that the File and Switch Workspace menus don't close before you hit other.Although even using this, I can't reproduce.PWI still reproduce in 3.6.1 under Windows 7 64-build (using the 64-bit build), instead. But, as I said, this only happens sometimes and I don't know what to tell you to try to reproduce.Maybe it happens more often when you try to switch the workspace as soon as Eclipse has started. Subsequent switches usually work.I surely see this problem when selecting one of the most recent opened workspaces, I can't say for sure if it happens also when you click on "Other...".(In reply to)I tried in Windows 7 (32 bit) but no luck :-(Hitesh, Your Windows 7 is 64 bit? If so can you try this and let us know whether you are able to reproduce?Took a look at this: When I first tried to reproduce I also had no luck but as I almost stopped it happened to me as well sporadically. After that, Markus and I tried to find the steps along with inspecting the code:==> the bug is in ActionContributionItem.handleHideProxy(Menu) where it can happen that the proxy is not yet replaced when the menu is used the next time.Steps to reproduce:1. change the asyncExec in handleHideProxy to a timerExec(3000, ...)2. start target3. open File > Switch Workspace (just by stopping the mouse over the item)4. move the mouse down to the next item, so that the sub-menu closes5. move the mouse up again so that Switch Workspace menu opens again6. wait at least 3s7. select 'Other...'==> nothing happensAfter that the proxy is replaced and it always works.Paul, can you take a look since you introduced that asyncExec in 3.4?(In reply to)Yes, I'll have a look.PWThis is awesome, thanks for tracking it down, Dani! This one was annoying...CreatedSwitching proxies v01It's the dispose that has to be guarded by an async exec, not the proxy menu/real menu swap.When the menu was re-opening before the async exec executed, it was the proxy menu re-opened (and then the async exec disposed the item). On windows it does nothing, on linux the menu item disappears completely.I've moved the menu swap outside of the async exec, and allowed the now discarded proxy to be dispose in the async exec.PWReleased to HEAD >20101122PWPaul, this fix does introduces another ugly problem:1. start target2. File > Switch Workspace (stopping the mouse over the item, Other... appears)3. wait a few seconds4. move the mouse down to the next item==> BOOM! The menu closes unexpectedly.(In reply to)OK, I'll keep looking into it.PW(In reply to)This is more severe than the original problem, and it happens with all kinds of menus (e.g. the "Replace With" menus in the context menu).Unless you find a working fix this week, the please revert.I've reverted the patch for now while I look for a solution.PWCreatedProxy menuing SWT exampleSilenio, please see the attached test class, which can be pasted into JFace and run from there.Description:we create a cascading MenuItem and a proxyMenu Menu. On the SWT.Show on proxy, we are allowed to instantiate the IMenuCreator (realMenu).The proxy code creates copies of all subitems from the realMenu that are displayed during the first SWT.Show event of the proxy.If you go away from the cascading menu, our SWT.Hide listener has to swap the realMenu for the proxyMenu, so that the next SWT.Show shows the real menu.The original problem reported in this bug on windows is because of the handleHideProxyOrig(Menu) code. I've been posting an asyncExec(*) to deal with the swap.The new code I tried in handleHideProxyNew(Menu) set up the swap in the proxyMenu SWT.Hide event and then disposed the proxy in an asyncExec(*). This seems to have made things worse, however, as the it makes the parent menu disappear.But I don't see either of these problems on GTK+, maybe because menu processing doesn't run the event loop?PW***has been marked as a duplicate of this bug. ***(In reply to)Is the fix for this problem going to be provided in the near future? I have customer who have reported this problem using RDz v8.0.1(built with eclipse 3.6).Thanks.I found steps to reproduce this problem on Windows. See. The problem happens because the SWT.Hide event is sent, but the menu is not hidden. I am not sure there are other ways of reproducing it. Also,indicates it happens on Linux as well. I am not going to close this bug for now. Please try the next integration build.indeed fixed this problem. I tried to reproduce with and without replacing the asyncExec by a timerExec (), but it always worked fine in I20110519-1138.*** This bug has been marked as a duplicate of***(In reply to)Sorry, that was wrong. An important addition to the steps fromis that steps 4 and 5 must be performed quickly (less than 3 seconds to move the mouse down to Restart and then up to Switch Wokspace again).CreatedActionContributionItemTest2Here's a second version of the example from. At the beginning of the class, you can configure which proxy strategy you want to use (HEAD or new one), and whether you want to use asyncExec (HEAD) or timerExec (makes it much easier to reproduce).Steps:1. click the File menu2. move mouse to Switch Workspace and wait there until the submenu appears3. move the mouse down to Restart, and when the submenu closes, immediately move back to Switch Workspace4. wait at least 3s (on some systems, you'll see some flickering when the menu is replaced)5. move the mouse to the submenu and click an item=> no selection feedback on the menu item, and the item is not executedAdditional caveat: In step 3, you can be too fast with moving down and up again, so that the Switch Workspace submenu doesn't appear at all. Then you won't see the bug, even if moving horizontally opens the submenu again.Removing passed target milestone.CreatedReproducible test case using SWTBotI modified the test fromand created an automatic scenario for this problem using SWTBot. Using this scenario and handleHideProxyOrig() it is possible to get four different results: 1. delayedExec() happens before menu item is executed 2. menu item is executed before delayedExec() 3. menu item is NOT executed at all (problem described in this bug) 4. exception: "SWTException: Widget is disposed"I am not sure if the 4th result is correct since SWTBot is used. I think it is easier to reproduce the problem using SWTBot than counting seconds.***has been marked as a duplicate of this bug. ***(In reply to Kevin McGuire from)WORKSFORME in Luna(In reply to Markus Keller from)The scenario described inalso WORKSFORME in Luna.(In reply to Lars Vogel from)The bug is hard to reproduce in the normal workbench, but using e.g. the steps from, still easily reproduce it.	39.0
id=267454	REOPENED	Platform	UI	3.4.2	All All	P3 enhancement	Platform UI Triaged	2009-03-06 17:22 EST by	Biörn Biörnstad	2009-12-12 21:37 EST (	5 users	Build id: M20090211-1700Steps to reproduce:1. Open any text file (or any other file with a simple text editor, too keep it simple)2. Choose 'Window > New Editor' to get a second editor for the resource3. Change the contents of one editor and observe how both editors become dirty (asterisk in tab)4a. Make sure that only one of the two editors is visible at a time (stacked, as by default)4b. Restart the workbench (no need to save the changes made in the editors)5. Change the contents of one editor (do not touch the other editor in order not to activate it)Expected result:Again, both editors should become dirty.Actual result:Only the editor where the change text file was changed becomes dirty, the other editor does not change its dirty state. This is inconsistent with the behavior before restarting and non-intuitive for the user.As soon as the second editor is activated, its dirty state will be updated correctly. I assume the second editor was not able to update the dirty state in sync with the first editor simply because it had not been activated yet.	Yes. We do not materialize editors until they are shown, at which point we can tell that the two editors operate on the same file.CreatedProposed patchConsidering that an editor description in the workbench's memento provides enough information to restore the editor, shouldn't it be possible to find all editors which operate on the same input as the one being activated, without restoring all editors?I was curious whether this could be solved without too much effort and gave it a try (attached). Whenever an editor is restored, all editors for the same ID and input are also restored as well. This seems to solve the problem -- but I am not an expert on Platform UI.Thanks for the patch, will have a look at it for M7. The idea sounds good.Released to HEAD. Thanks!Boris, this fix is a no-go, please revert it: it causes all editors with same input as the active one to be materialized on start up and each time another editor is activated, all similar ones are also activated.The costs are to high just to have this little '*' in the tab later (assuming someone is even starting to type in that editor).A correct fix would listen for changes to the dirty property and then update the tab without loading the editor.(In reply to)Not sure I agree. The editors would have to have the same input and id, and be in the same workbench window. Yes, there is an additional cost of materializing a second copy of the same code, but this is not a very common setup, and when it happens it's potentially confusing.Maybe more.So far in 7 years no one reported it and if it is not common, why take that risk one week before RC-mode?Are you sure that the getPart method you changed is not used in any other context/scenario which now also suffers this side effect?What's the problem implementing the * based on the property change?I still like to back out of this change (at least for 3.5).***has been marked as a duplicate of this bug. ***Createdpatch to revert the change(In reply to)Yes - however many editors were open in the last session, with the same editor id and editor input.I did not see this as a particularly risky fix, but agree that there is a potential performance effect.Whichever context/scenario we had that materializes the editor, yes, it would cause the same side-effect. We try very hard not to materialize editors until the user clicks on the tab, though.I would expect this to be a more complicated and riskier change. But it's certainly doable.Sure, we can back out of this. Dani, can I get your +1 for this patch?+1 forfor RC1.released to HEAD. Moving to 3.6.Remy is now responsible for watching the [EditorMgmt] component area.	12.0
id=275393	REOPENED	Platform	UI	3.5	PC Windows XP	P3 normal	Platform UI Triaged	2009-05-07 19:19 EDT by	Susan McCourt	2010-04-15 14:53 EDT (	2 users	In, Remy wrote some "fake the event" type tests to regression test some field assist popup behaviors.I'm wondering if some of the manual tests in org.eclipse.ui.tests/Manual componentTests/FieldAssist.txt could be automated in this way.Some of those tests document platform differences and nuances, but some are more basic, such as when/how the popup opens and closes, when the control content changes and when it does not, etc...could be tested this way.Remy volunteered to work on something like this with some guidance from me as to what the cryptic manual tests mean ;-)	We discussed trying to do some of this during 3.5 end-game, but I'm not assigning a milestone as this is a "nice to have" and not critical for 3.5. I think it should be done before we make any more functional changes to field assist.demonstrates that it's getting harder to make changes without breaking someone.CreatedGeneralize field assist tests patch v1This patch introduces some new classes that are intended to make our testing lives a lot easier instead of copy/pasting the same code three times like we did in. The commented out testX() method is intended to test the case described by.The idea is to create some abstract classes that will do the basic and some public methods to tweak the actual CPA/CACA. Then there's another batch of abstract classes that would actually extend TestCase and provide protected methods in addition to doing some simple setUp() tearDown()s. Subclasses would do the actual testing (invoke content assist, send KeyDown, check shell count, etc.) and then the last level of the hierarchy would simply return Combo- or Text-related details. Hence, the superclass can be reused for testing both Combo and Text cases.With this kind of setup, I think it should be much more straightforward for us to add more support for field assist such as StyledText (included in) and CCombo. :)--------Hierarchy as follows, and should make things clearer (I hope):AbstractFieldAssistWindow+ComboFieldAssistWindow++ComboCommandFieldAssistWindow+TextFieldAssistWindow++TextCommandFieldAssistWindowAbstractFieldAssistTestCase+AbstractContentAssistCommandAdapterTest++ComboContentAssistCommandAdapterTest++TextContentAssistCommandAdapterTest--------AbstractFieldAssistWindow-abstract IControlContenteAdapter getControlContentAdapter()-abstract Contrl createFieldAssistControl(Composite)Amongst other methods, this class is a simple subclass of Window that lets subclasses define their own field assist's contents. There are also public methods for setting things like autoactivation delay and such.--------ComboFieldAssistWindowTextFieldAssistWindowExtends the AFAW and implements the two methods to return appropriate field assist controls (Combo or Text) and the corresponding control content adapter.--------ComboCommandFieldAssistWindowTextCommandFieldAssistWindowExtends the CFAW and TFAW and overrides the CPA construction method defined in AFAW to construct a CACA.--------AbstractFieldAssistTestCaseDefines some simple protected methods for sending low-level SWT events, setting text to the control, and such.--------AbstractContentAssistCommandAdapterTestExtends the AFATC to provide a convenience method for executing the content assist handler through the workbench. Also implements the actual test classes.--------ComboContentAssistCommandAdapterTestTextContentAssistCommandAdapterTestExtends ACACAT to simply construct a CCFAW and a TCFAW. The tests are defined and subsequently performed by ACACT.Remy, I'll take this one to look at getting this in for 3.6. Does this still represent the state of the art (I know you were talking to Francis at one point about other places where we fake events)...(In reply to)At the moment, this is what I've got that works (on my computer anyway).Francis, Eric, and I were investigating DND-related stuff actually, which is unrelated to field assist at the moment. For referencing purposes, the bug Francis opened against SWT requesting assistance is.Fixed in HEAD >20091014.Thanks again, Remy.I changed the framework methods that fake key events to actually post an event to the display. That meant some of the test cases that faked an event and then set the content to match it didn't have to set content anymore. Posting the event allows us to test lower level constructs that require cooperation of the native control, like "propagate keys."I added some simple tests for propagate keys, autoactivate, etc. I did not get as detailed as I originally intended, simply because I don't have any more time to put into this, but this gives us a decent start and I'll ensure there are new tests added for any future fixes or new function added.Reopening. The field assist tests that I added (raw field assist, not the content assist command adapter) are failing in the nightly build. They are passing locally. Need to investigate.For the missing workbench failures, it may be worth instantiating and opening a shell and granting focus to that shell instead. It is after all not entirely inconceivable for someone to want to just run the JFace tests via a standard JUnit runner instead of PDE's JUnit runner (not having to wait for the workbench to come up saves a lot of time :)).For the other failures, given that the command adapter tests are a-okay, I think we can only assume that the event is not being posted appropriately. Perhaps using an assertion like so...assertTrue(window.getDisplay().post(event));...might give some insight to the problem.Note that these all pass on my XP workstation locally. Will try again on Linux/gtk+ when I get home.(In reply to)Yes, that was bogus to use the workbench there. I reran the tests with a regular launch (not workbench) and verified that those failures are gone.I added these assertions, good idea.I also made sure we used the same display everywhere, vs. Display.getDefault(). I also added spinEventLoop() before originally counting the shells and also in the asserts for shell counts, in case there's a pending event or async that affects the initial or current count.(In reply to)Susan, the tests are NO GO for me locally on Linux/gtk+. The failures are intermittent but since there are so many of them, some of them fails for sure even if some others end up passing. Display's post(Event) method seems to be working in a small snippet I wrote (i.e. the listener is being notified) but I'm not getting many SWT.KeyDown events when I put print statements in ContentProposalAdapter. :(One thing I noticed is that X seems to take these key events very literally. When I first ran the tests, they completed and failed and...I noticed my computer started entering 'i' into my editor a bajillion times until I stopped it by hitting ESC. In one instance where I was stepping through the code X even crashed. After seeing this phenomena a couple of times, I eventually realized that these were the key down events that were being posted and confirmed this problem in a snippet. Posting _both_ key down and key up events stops this from happening although the tests _still_ fail so I guess this isn't really the problem.(In reply to)hmmm...I have a Linux box I can try this on this weekend. One change I made in the abstract test case is to put focus on the control before sending the event. I'm wondering if there was a problem where no one had focus, so the events were just queued up until something did. But at this point I'm just guessing, I'll have to debug further.Paul said he get test failures locally on his workstation as well. His X didn't crash...or at least, he hasn't ran it enough times yet. :PRemy, are the content assist command adapter tests still passing on Linux? I'm going to disable the failing tests until this gets sorted out.(In reply to)I got some strange errors just now which claimed the content assist handler couldn't be found. Repeated attempts produced similar results...until my X server crashed. I think we should disable all of them (or at least the ones that use post(Event)) for now.disabled the tests.Here's an abridged version of an IRC chat from yesterday.<krbarnes> rcjsuen: any more luck with Display.post?<rcjsuen> krbarnes: I didn't try. Well, before I tried the junit thing I said I was going to do, I had to test something else for Susan...and in the process it brought down my X...again. So I just gave up. :|<rcjsuen> I should say I got discouraged to work on it anymore.<rcjsuen> Think I need to figure out this xfvb thing.<rcjsuen> tho dunno how that would interact with post(Event)<krbarnes> have you tried on any other machines?<krbarnes> linux machines<rcjsuen> well it fails on paul's machine too<rcjsuen> tho it didn't bring his machine down<krbarnes> is the test in CVS?<rcjsuen> krbarnes: yeah, it's in org.eclipse.ui.tests<rcjsuen> org.eclipse.jface.tests.fieldassist.FieldAssistTestSuite<krbarnes> rcjsuen: great.. I'll take a look at it today.<rcjsuen> oh and it fails on the test machines<rcjsuen> so i guess that's 3 boxes<rcjsuen> krbarnes: Thanks.<rcjsuen> krbarnes: you can report any findings on ~275393 so Susan will know too, thx<paulweb515> rcjsuen: One of the differences I thought was my GTK+ was older ... but the linux test machines won't be higher than me<Arbalest>-- Platform / UI / 3.5 - PC / Windows XP - REOPENED / normal / - Assignee: susan_franklin - [FieldAssist] Automate the manual test cases------------<krbarnes> rcjsuen: are you guys really flooding the queue with key events?<krbarnes> the test suite finished and the host eclipse has been getting key events for 5 minutes now.<krbarnes> mostly 'i' but some spaces<krbarnes> rcjsuen: if you create a long enough line in StyledText, you'll crash X. I suspect that's happening to you (and about to happen to me)<krbarnes> rcjsuen: also, IIRC while(readAndDispatch) is not sufficient to be sure that the event you posted has been processed. You should check the events until you get the one you're expecting.<krbarnes> rcjsuen: I think you should be posting a KeyUp for every KeyDown as well, though I'm not sure what the consequences are for not doing so.<rcjsuen> krbarnes: yeah i changed it to post KeyDown too (locally not on CVS) but the tests still failed<rcjsuen> krbarnes: Waiting and checking for the one that we want sounds like something worthwhile to try though.<krbarnes> I'm not sure why it was happening, but I never stopped getting events..<rcjsuen> krbarnes: well that matches your guess last week that keydown with no keyup = *depressed key................ infinity*, no?<krbarnes> could be<rcjsuen> krbarnes: Did your system ever crash?<krbarnes> no, but it did make the machine unusable. I had to reboot<rcjsuen> lol<krbarnes> felipe says that a long enough line is StyledText will crash X though. Some old bug<rcjsuen> in my case X crashed but i was back in my ol' tty1 so i could just go $ startx again<rcjsuen> we're not testign ST tho<rcjsuen> unless you had an editor open (and had focus)<rcjsuen> and sent 'i' over there i supposeRunning the code below in a JUnit test method on Linux/gtk+ seems to work as expected.I get the following output:If I comment out the rAD() call then I just get three lines of '>>><<<'. So ignoring the problem of X crashing, it seems that the posted events are not being "sent" to the right control.------------------final Display display = getDisplay();Shell shell = new Shell(display);shell.setSize(200, 50);shell.setLayout(new FillLayout());final Text t = new Text(shell, SWT.SINGLE);shell.open();System.out.println(">>>" + t.getText() + "<<<"); //$NON-NLS-1$ //$NON-NLS-2$Event event = new Event();event.character = 'i';event.type = SWT.KeyDown;display.post(event);while (display.readAndDispatch());System.out.println(">>>" + t.getText() + "<<<"); //$NON-NLS-1$ //$NON-NLS-2$event = new Event();event.character = 'i';event.type = SWT.KeyUp;display.post(event);System.out.println(">>>" + t.getText() + "<<<"); //$NON-NLS-1$ //$NON-NLS-2$shell.dispose();looks like this isn't going to resolve for M3. Marking M4.Remy, do we need to open an SWT bug with that last snippet?(In reply to)Maybe, I need to talk to Kevin again tomorrow. He looked attoday and suggested that I add a while rAD() loop after the shell was opened (to ensure that the "standard" events were completed) but it seems that adding that after shell.open() just gives me three blank lines instead of the expected 'i' events. Very odd...The shell positioning tests need to use more interesting layouts than a single control in a field assist window. I totally missed a blatant bug () by doing my detailed testing on too simple of a case. (Of course a sanity check of the find/replace dialog is always the right thing to do! I got too comfortable with my tests).The change noted inseems to work on and off. When it fails I see the 'i' character show up in my editor so I guess it was "missed".Adding a while loop to check that the control's content actually changes helps but is still not foolproof as it's kind of a 50-50 thing. Sometimes I will run the tests and it will just hang there with the text caret blinking at me in the while loop so I guess the key events got lost in the X server's abyss somewhere.other work taking priority over this...marking 3.6 to keep on radar.I had to disable the focus-related tests in ControlDecorationTests.It seems that I can't ensure the focus-related events are processed by the control before making the assertions, even though I spun the event loop before doing so. I must be missing something obvious.(In reply to)Clarifying previous remark.I added some ControlDecorationTests in N20091202-2000.The focus-related part of this test failed in the build, so I've disabled it for now. I'll come back to it while looking at this bug.	23.0
id=268310	REOPENED	Platform	UI	3.4.1	All All	P3 enhancement	Platform UI Triaged	2009-03-12 05:20 EDT by	Aaron Digulla	2009-12-02 03:57 EST (	5 users	Build ID: M20080911-1700Steps To Reproduce:1. Select a project2. Open the context menu3. Select "Export..."Welcome to hell ;)More information:As a beginner, my first question is: What the hell is this dialog? I selected a project, why is it offering "Launch Configurations"? Okay, stupid thing. Just export my project. Ah, nice, I have a filter. "project" ... WTF?!?!? What is a "Team Project Set"??? What? "Export a file containing the names and locations of shared ... uh ... what? What's going on here? Why isn't Eclipse allowing me to give my projects to my friends??? ...Let's leave Joe here. When I select a project (any kind of project) for export, Eclipse should offer an "Export project" as the default in the wizard. The next page should then ask me for a file name, whether I want it to include necessary other projects (i.e. projects which are in my build path) and external resources (for example, external JARs which are in the build path or files and directories which are linked in).The default settings should result in an archive file which contains a fully working project that I can directly import without further fuzz and which compiles out of the archive.	For you exporting the project to an archive (or file system) might seem the natural/default thing but for others (e.g. those who have their code in a repository) it might be creating a runnable JAR or just a JAR or....Anyway, I agree that the Export wizard is a bit overloaded.One way to reduce the list of items in the wizard is thru activities. If you never ever debug anything/use CVS, you can disable those activities in the preferences. Workbench will filter out those things in Export/Import/New wizards and in the menu/action contributions.Apart from that, how can the Platform decide which one of the wizards will be/will not be used by a user?I don't object to the number of options; my objection is that there is no obvious entry "Export whole project".The current situation leads to people leaving Eclipse to ZIP up the whole workspace or the project folder with an external tool.(In reply to)Why do you need an external tool? You can do it right within Eclipse. Right click the Project, Export->Archive File-> Specify destination->Finish. Can it be more simpler?Yeah, sad if they don't know what an Archive is ;-)Something that we could also improve is to the usability of the search field by specifying keywords like it is done in the preference dialog. Currently import/export dialogs only match what's in the dialog and hence most useful options go away if I e.g. type "project".(In reply to)Dani, Would it be a good idea to have a 'primaryWizard' in the export/import wizard extensions? (just like the new wizard) JDT can add a Export Jar and PDE can add Export Plugin etc? Will it simplfy things a bit?I think in general it's a good idea but it will still not help a beginner to know that 'Archive File' is the way to go when he wants to export his project(s).Maybe it would help to add a new export wizard called 'Projects' which would simply launch the 'Archive File' wizard with the selected projects pre-selected.There are two ways to improve the situation. One by supporting keywords and other by having primary wizard. These are addressed byand. Nothing more to be done here. If you have any other suggestions that can help the user to avoid confusion, please reopen this bug and add it in the commentsAs outlined in my previous comment, keywords will not help to find the simplest export wizard. And it also contains a possible solution.I just added a comment towhich might help with this bug here.	11.0
id=286115	REOPENED	Platform	IDE	3.4	PC Windows XP	P3 enhancement	Platform UI Triaged	2009-08-10 08:29 EDT by	Jayadevan Atta	2009-11-30 16:46 EST (	2 users	CreatedScreen shot of listing of files opened in EditorIt will be nice to have mouse track wheel scrolling on the listing of files opened in Editor	Marking as PresentationsAPI. Paul, please reassign if its not correctI tried this and it worked for me:1) opened enough files to have 30 in the dropdown list2) used my mouse to open the list3) my mouse is hovering over the list4) my scroll wheel moves the scroll bar up and down.PW"Mouse track wheel scrolling on the listing of files opened in Editor" does not work on the version of Eclipse that I haveEclipse SDKVersion: 3.4.2Build id: M20090211-1700I would like to know the Eclipse version on which this works. ThanksIt works for me on both 3.4.2 and 3.5 (but my mistake, I'm on linux).Kevin, is this a CTabFolder problem?PWI am able to scroll after pressing down the mouse roller and focusing on one of the items in the list.It would be much better if it scrolls when the mouse hovers over the list. This could be related to the cursor being on the filter area at the top to restrict the list.Possible solution:- Initially set focus on the file name of the currently opened file- Set the filter only when user types in the key letters - Set focus back to first matching item in the listThanks(In reply to)I believe this is a feature/bug/whatever-you-want-to-call-it on GTK+ but is not the case on Windows. I'm on XP right now and I too have to click on the list before I can start scrolling. I recall having this conversation with Kevin Barnes.should this be moved to SWT?	7.0
id=293408	REOPENED	Platform	UI	3.5.1	PC Windows XP	P3 normal	Platform UI Triaged	2009-10-27 05:20 EDT by	Arnaud Lucien	2015-04-13 12:20 EDT (	2 users	User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; fr; rv:1.9.1.3) Gecko/20090824 Firefox/3.5.3 (.NET CLR 3.5.30729)Build Identifier: M20090917-0800This happens only when there are several property pages are associated to a working set.When opening the properties on a working set, when the "Working Set Contents" page is displayed and you try to click on another page, you get the error message "The currently displayed plage contains invalid values". At this point, the only way to move on is to do a dummy change on the working set (like selecting/deselecting a project). This sets back the page to a valid state.My idea is that a call to validateInput() should be added at the end of method ResourceWorkingSetPage#createControl. However, this needs to be confirmed.Reproducible: AlwaysSteps to Reproduce:1. Launch Eclipse + CDT2. Create a dummy "Hello World" C project and a resource working set "MyWS" containing the "Hello World" project.3. Set up the Project Explorer view so as to display the Working Sets as "Top Elements". Select "MyWS" as a working set to display.4. Open the Properties on "MyWS"-> You see that as soon as the "Working Set Contents" page is displayed, you get an error message when you click on "C/C++ Build".	CreatedPatch v01Released to HEAD.Fixed by above patch.Removed the confusing ,unrequired variable 'firstCheck '.Thanks for the fix!(In reply to)That need much investigation. It was there in the bug report already:) Thanks.Oops!! I noticed the omission of "didn't" in the above. Got this while going through the mails today.I hope you got the message though :)(In reply to)No problem, I got it!See. Unfortunately the above fix causes the error message to appear earlier than we'd like to. Putting the setPageComplete(false)in an else block, at end of the method createControl, seems to workaround this . But I am not sure if enabling the finish with out any edits is a good idea. The problem here is that the Wizard's canFinish() is used to check if we can safely change to another property-page. See the corresponding adapter : WizardPropertyPageIt works for me in the 'eclipse-cpp-kepler-R-win32-x86_64' CDT build. Could you please confirm that the issue is still valid and update the steps to reproduce it if needed?thanks,Daniel	8.0
id=281455	REOPENED	Platform	IDE	3.5	All All	P3 normal	Platform UI Triaged	2009-06-25 03:05 EDT by	Prakash Rangaraj	2014-11-05 11:33 EST (	8 users	eclipse.buildId=I20090611-1540java.version=1.5.0_16java.vendor=Apple Inc.BootLoader constants: OS=macosx, ARCH=x86, WS=cocoa, NL=en_USFramework arguments: -product org.eclipse.epp.package.rcp.product -keyring /Users/prakash/.eclipse_keyring -showlocationCommand-line arguments: -os macosx -ws cocoa -arch x86 -product org.eclipse.epp.package.rcp.product -keyring /Users/prakash/.eclipse_keyring -showlocationErrorThu Jun 25 12:34:47 IST 2009Problems occurred when invoking code from plug-in: "org.eclipse.jface".java.util.ConcurrentModificationExceptionat java.util.AbstractList$Itr.checkForComodification(AbstractList.java:449)at java.util.AbstractList$Itr.next(AbstractList.java:420)at org.eclipse.ui.actions.CloseResourceAction.updateSelection(CloseResourceAction.java:312)at org.eclipse.ui.actions.BaseSelectionListenerAction.selectionChanged(BaseSelectionListenerAction.java:124)at org.eclipse.jdt.ui.actions.ProjectActionGroup.performSelectionChanged(ProjectActionGroup.java:136)at org.eclipse.jdt.ui.actions.ProjectActionGroup$1.selectionChanged(ProjectActionGroup.java:114)at org.eclipse.jface.viewers.Viewer$2.run(Viewer.java:162)at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)at org.eclipse.core.runtime.Platform.run(Platform.java:888)at org.eclipse.ui.internal.JFaceUtil$1.run(JFaceUtil.java:48)at org.eclipse.jface.util.SafeRunnable.run(SafeRunnable.java:175)at org.eclipse.jface.viewers.Viewer.fireSelectionChanged(Viewer.java:160)at org.eclipse.jface.viewers.StructuredViewer.updateSelection(StructuredViewer.java:2132)at org.eclipse.jface.viewers.StructuredViewer.handleInvalidSelection(StructuredViewer.java:1124)at org.eclipse.jdt.internal.ui.packageview.PackageExplorerPart$PackageExplorerProblemTreeViewer.handleInvalidSelection(PackageExplorerPart.java:330)at org.eclipse.jface.viewers.StructuredViewer.preservingSelection(StructuredViewer.java:1405)at org.eclipse.jface.viewers.TreeViewer.preservingSelection(TreeViewer.java:402)at org.eclipse.jface.viewers.StructuredViewer.preservingSelection(StructuredViewer.java:1353)at org.eclipse.jface.viewers.StructuredViewer.refresh(StructuredViewer.java:1482)at org.eclipse.jface.viewers.ColumnViewer.refresh(ColumnViewer.java:548)at org.eclipse.jdt.internal.ui.packageview.PackageExplorerContentProvider$6.run(PackageExplorerContentProvider.java:971)at org.eclipse.jdt.internal.ui.packageview.PackageExplorerContentProvider.runUpdates(PackageExplorerContentProvider.java:194)at org.eclipse.jdt.internal.ui.packageview.PackageExplorerContentProvider.runPendingUpdates(PackageExplorerContentProvider.java:186)at org.eclipse.jdt.internal.ui.packageview.PackageExplorerContentProvider$1.runInUIThread(PackageExplorerContentProvider.java:164)at org.eclipse.ui.progress.UIJob$1.run(UIJob.java:95)at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:134)at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3404)at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3101)at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2405)at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2369)at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2221)at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:500)at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:493)at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:113)at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:194)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:368)at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)at java.lang.reflect.Method.invoke(Method.java:585)at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:559)at org.eclipse.equinox.launcher.Main.basicRun(Main.java:514)at org.eclipse.equinox.launcher.Main.run(Main.java:1311)	Prakash, is this something you can reproduce with steps?From the stack I can't tell if this is a JDT problem or IDE. The selection list is being accessed from multiple places. Moving to JDT because this seems to involve a UI job run in the PackageExplorerContentProvider.(In reply to)I don't remember the steps that created this exception. It just appeared in the Error Log and thought its better to file a bug for investigation. Haven't seen this one after that.The bug in org.eclipse.ui.actions.CloseResourceAction: it's designed to listen for selection and resource change events. The latter can happen in any thread and because it calls getSelectedResources() it can cause concurrent access/modification of 'resources' and 'selectionDirty'. This needs to be shielded.thanks, Dani. Moving to IDE.There's a separate component for 'IDE'.(In reply to)yep, I was just trusting the greasemonkey triage script to do the right thing. I'll talk to Boris about what we are trying to do with the IDE componentOption one: I could protect getSelectedResources() so that it can't be re-entered and it will always return a copy of the list. This would be a localized change.Option two: I think this only solves the local problem, but I can have org.eclipse.ui.actions.CloseResourceAction.resourceChanged(IResourceChangeEvent) post to the display thread.Option three: Dig down into SelectionListenerAction and try and protect the individual variables.I'm open to suggestions here if the quick fix protection is sufficient (which I could still consider for 3.6) or if we need to take the deeper route (which I'd prefer to do in 3.7)PWI would do a local fix (option 1, not 2) in CloseResourceAction unless we already know of other CCMEs caused by SelectionListenerAction.CreatedSuggestion v01IMHO, something along the lines of option 3. This seems to overlap with option 1 in some way, not vice versa though. This is roughly shown by the attachment.CreatedCloseResourceAction v02This contains the change to CloseResourceAction. getSelectedResource()/getSelectedNonResource()are synchronized, since it can write to the list.resourceChanged(*) is synchronized as it makes use of getSelectedResource() and the call to org.eclipse.ui.actions.BaseSelectionListenerAction.selectionChanged(IStructuredSelection) can clear the cache and start again.With getSR()/getSNR() protected it might not be necessary to synchronize resourceChanged(*) because clearing the cache creates a new list instead of changing the one in play, but for now I'm including it.PWReleased to HEAD >20100414PWThe changes are in I20100425-2000 and there's no sign of a behavioural change when opening,closing projects and launching a resource change.PW***has been marked as a duplicate of this bug. ***(In reply to)was against 3.6 i.e. after this bug got "fixed". Unfortunately, the fix was not complete: it does not protect CloseResourceAction#updateSelection and hence not fix this bug.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Synchronizing CloseResourceAction#updateSelection(IStructuredSelection) should do the trick.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***I got this exception when *opening* projects. But the stack trace is the same.	20.0
id=308010	REOPENED	Platform	UI	4.0	All All	P3 normal	Platform UI Triaged	2010-04-02 16:10 EDT by	Ryan Dunn	2010-11-28 15:37 EST (	1 user	Build Identifier: 20090920-1017The class org.eclipse.jface.databinding.viewers.ObservableValueEditingSupport has a call to bindValue() with a hard-coded UpdateValueStrategy. This causes problems when using this class to bind EMF objects (would need to use EMFUpdateValueStrategy instead), or anytime you would want to provide your own UpdateValueStrategy.This class should be updated to fix this issue. A second create() method could be created to accept the modelToTarget and targetToModel strategies, or the createBinding() method could changed to allow overriding, at which point a subclass could specify the strategies to be used.Reproducible: Always	Actually, it should already be possible to override the createBinding() method which would easily allow for the injection of your own UpdateValueStrategies.It's been several months without feedback. I'll assume you went with Ovidio's advice in.Closing as WORKSFORMESorry, hadn't been keeping up with this bug.Ovidio's advice would work, however, all the fields in the class are marked private, and thus even though the createBinding method could be overridden, I don't have access to the databindingcontext.Ryan, what I meant is that you could keep a reference to the DBC in the constructor and then override createBinding() to do what you're looking for which, however, is only possible when you're subclassing ObservableValueEditingSupport. In any case, I don't think that we should introduce a second create() method since update strategies are usually not shared amongst bindings so they should be (re-)created whenever the binding is created. In addition, the create method is already highly parameterized.We might, however, make the dbc field protected or provide a getter for it. Would this help?	4.0
id=320951	REOPENED	Platform	UI	4.0	PC Linux	P3 normal	Platform UI Triaged	2010-07-26 15:05 EDT by	Micah Hainline	2012-08-13 15:10 EDT (	4 users	Build Identifier: 20100617-1415When ComboViewers and other ContentViewers are disposed, they clear their content provider. If setInput is called later, instead of failing with a widget disposed error, they throw an error related to having no content provider. This sets the developer down the wrong track when debugging it. Instead, we should add an additional check in ContentViewer to throw an SWT exception right before the line Assert.isTrue(getContentProvider() != null, "ContentViewer must have a content provider when input is set."); //$NON-NLS-1$Reproducible: AlwaysSteps to Reproduce:Create a ComboViewer with ArrayContentProvider, dispose it, then set a list of strings as input.	CreatedPatch v01Some of the other methods do check for the control's state. Boris, I gather that getControl()==null implies that the control has been disposed. Just had a mild doubt about it after looking at the patterns in the code...Thanks.The check itself looks good to me, but we shouldn't use "SWT.error(SWT.ERROR_WIDGET_DISPOSED);" because that's usually a sign that you are using SWT in an invalid way. In this instance, I would do something like:throw new IllegalStateException("Need an underlying widget to be able to set the input (has the widget been disposed?)");(In reply to)Thanks Boris. Sounds good to me, will make a new patch on monday.CreatedPatch v02(In reply to)On second thought, the patch was rather simple; released it to CVS HEAD.Marking as Fixed.Verified in I20101012-0800.I'm curious why checking the control was implemented in this change. The description talks about the ContentProvider being disposed, not the Control. Was any consideration given to backwards compatibility when this patch was accepted?I'm asking because I'm upgrading an application to be based on Eclipse 3.7 (from 3.4 or 3.5) and some of the code used custom a "NullViewer" that had no visible Control. It worked perfectly before, but now runs into this IllegalStateException. It seems to me that the contract of ContentViewer was changed as a result of this change, breaking existing subclasses of ContentViewer.As the Eric Rizzo remarks, I'm also surprise by this fix because, because the SWT Control is optional as it's written in javadocs : "create SWT controls for viewer (in constructor) (optional)"So why check in setInput method if the control exist or not and if it disposed ? I'm checking compatibilty of tools developped on version 3.4, and it's the only blocking point for us.So this fix definitly change the contract of this class.(In reply to)The problem was (as I read it) the widget was disposed (because the viewer was disposed) but the viewer was throwing an error about the content provider, causing people to look for incorrect setContentProvider(*) instead of the eager dispose.But it seems to me that the current solution also causes problems. I'll take any patches to fix.PW	9.0
id=308536	REOPENED	Platform	UI	3.6	PC Windows 7	P3 normal	Platform UI Triaged	2010-04-08 13:49 EDT by	Mohamed El-Kholy	2010-04-21 11:52 EDT (	4 users	CreatedCorrect display of address when the project name is Arabic but report name is English Download and extract TPTP_All_In_One 4.7.0M6 build Create a java project with an Arabic nameCreate JUnit test cases and test suites, then generate report with Arabic name for the test suite (similar to this) When viewing the report in browser (Eclipse internal browser), the ordering of the folders and file names which have Arabic names are reversed	*** This bug has been marked as a duplicate of***(In reply to)Paul, this is not what I meant, there are two separate issues On RHEL, the Arabic characters are displayed as Ascii valuesOn Windows, they are displayed correctly, but the order of segments is wrong Those two are separate, independent issuesSorry Mohamed, could you attach the failure case to this bug? I see the "correct" one, and it looks correct :-)Re-opening.Felipe, is the windows Combo a native control as well? Would seeing ascii in it mean that it's not picking up the system font?PW(In reply to)Sorry I forgot the attachment, I don't know howI will post it in this bug nowCreatedThe wrong order of display when both project name and file name are in ArabicOK, my comment from the other bug is actually more applicable here:AFAIK that's just text in a combo box in theorg.eclipse.ui.internal.browser.BrowserViewerI was under the impression that we still don't support BiDi text in "input"widgets like Text. In this case it's a GTK+ Combo box.Felipe, is this something that should just work if we apply TextProcessor toit? Or is that likely to hurt the browser itself since it's a URL that will bepassed to the native browser widget?(In reply to)Correct, blocked by.Yes, if the control was read-only.Not sure, we would need to test it.	7.0
id=322487	REOPENED	Platform	UI	3.4.2	PC Windows XP	P3 normal	Platform UI Triaged	2010-08-12 05:13 EDT by	shiqinl	2010-08-17 07:38 EDT (	8 users	Build Identifier: M20090211-1700for example:input a url in text bar like this:"/".it is incorrect,the correct url is:"".If not fix it,it would cause url error in some states. Reproducible: AlwaysSteps to Reproduce:1.Create a RCP plug-in project,chose the sample of Mail template.2.add the confirguation "-nl ar",run the sample plug-in project.3.chose the "Field Assist" menu file,select the Field Assist Test Dialog.4.it pop-up a dialog.5.choose any text bar,input a url like this "/".6.it is incorrect,the correct url is "".	Createdincorrect url input in the state of BIDI*** This bug has been marked as a duplicate of***This bug has nothing to do withwhich is for a concrete problem in JDT. The bug needs to be addressed directly in the Field Assist Test Dialog and depends on. No idea though where that dialog comes from.It is the same problem, but different components.shiqinl: do you know which components owns that 'Field Assist Example' dialog ?the field assist test dialog is a platform UI example, org.eclipse.ui.examples.fieldassistSorry,I just pay attention to it.Much sorry for provide the wrong reproduce steps.As Felipe Heidrich said,the difference betweenandis that they are different components.The reproduce steps as follows:1.create a plug-in project(not an RCP application);2.choose the templates of "Hello World"; 3.click finish button,then a plug-in project is created;4.click the "Run Configurations..." in the "Run" menu.5.a "Run Configurations" dialog is pop up and chose the "Arguments" tab;6.in the "Program arguments:",add this command:"-nl ar";7.click the "Run" button,you can see a Eclipse shell is created;8.chose the "Field Assist" menu file,select the Field Assist Test Dialog.9.it pop-up a dialog.10.choose any text bar,input a url like this "/".11.it is incorrect,the correct url is "".	6.0
id=323706	REOPENED	Platform	UI	3.6	PC Windows XP	P3 normal	Platform UI Triaged	2010-08-26 09:19 EDT by	Remy Suen	2015-08-17 16:34 EDT (	13 users	CreatedScreenshot depicting the problem in question.M20100825-08001. Close all editors if any are open.2. Detach the 'Package Explorer' view.3. Activate the 'Problems' view in the original workbench window.4. Activate the detached 'Package Explorer' view.5. You should see a 'Source' menu in the workbench window.6. Try to click the 'Source' menu.7. You will end up getting the 'Navigate' menu.	This is a regression! It works in 3.4...The issue here seems to be the activation handling which activates some part *within* the main window when the shell activates...this ends up resulting in the menu being re-evaluated...Not sure to whom it should go (DW's, Commands, Workbench?) but I'll tag it for 3.7 so it won't get lost...I wasn't following the repro instructions exactly (no editors open!), this problem exists in 3.4 (it's not a regression...).Yeah, I also don't see a difference between 3.4.2 and HEAD. It works in a few limited scenarios, but I guess that's more by chance (e.g. when the active view in the main window doesn't have a selection -- e.g. the empty Type Hierarchy view).The underlying problem is that the focus and goes to the main window. This changes the current selection and therefore makes all selection-dependent actions unusable (menus, main toolbar buttons).***has been marked as a duplicate of this bug. ***I'll send this to 'Workbench' since its an activation issue...Fixing that by allowing the actions in the main window to go to the detached view would be unexpected because at the end of the action you have the main window with its recent active part in focus but the last action executed on the selection from the detached view.A simpler approach could be to disable the actions in the main window if the detached view has focus. Important is to not hide/show menus and toolbar items. With such an approachis not a dup and becomes invalid again.***has been marked as a duplicate of this bug. ***The actual issue here is that we change the active part when the main shell gets activated...This is the result of an SWT.Activate listener in the PartPane which calls 'requestActivation', a specific invitation for the main WB to activate a part in itself.Perhaps the fix should be to have requestActivation honor DW's ??Worse than I thought...this is a result of the Shell's restoreFocus method granting focus (and activating) the last widget with focus in the shell owning the menu.In the worst scenario I can think of you'd have the Project Explorer open (and active) in the main shell and the Package Explorer detached. If you then select files "A", "B" and "C" in the Project Explorer, then select files "D", "E" and "F" in the Package Explorer then doing "Edit -> Delete" will end up deleting ABC rather than DEF as expected.Fortunately this doesn't appear to be a very common workflow, presumably most folks that use DW's don't detach the 'navigation' views but usually detach the ancillary views like Search...most of which contain their own menus etc to operate locally on their selection (i.e. not many views actually provide selections for which the main menu would be of use so users don't hit this).I've spent some extra time on this since we have the same issue in e4. Unfortunately I'm not sure that a viable fix is even possible here...SWT:Clicking on the main shell's menu activates it (seems like correct behavior)Activating a shell restores its previous focus and ectivationUs:If a part gets activated by SWT we make it the active part. This is correct in every situation except this one (i.e. the user may just have clicked on the shell's title area to activate it in which case we want the current behavior.We have *no* way to detect that the shell going active was the result of the user selecting the main menu.I've rigged up an SWT testbed to try out various strategies but even if I can prevent the part's activation we just end up with an 'active' part that doesn't have focus and an active shell that doesn't contain the active part...confusing at best.CreatedSWT TestbedSee also.This is exactly the same problem as. The detached view should be in a palette window that doesn't deactivate the workbench window.***has been marked as a duplicate of this bug. ***probably the most annoying of this bug is when you're looking in a .class file (that you can see its source because it's in a jar to which you attached source) and then you want to click on Project->Properties and find that Properties is grayed out, so you have to click on the exact project(or any files in it)[even though that project is already selected] in the package explorer (not enough to just activate/focus package explorer) in order to ungray the Properties... hmm actually this seems unrelated to this bug, but I thought it's same... can anyone confirm it's unrelated?(In reply to)Yes, this is an unrelated bug. Please file a new one against JDT UI. We need to investigate whether we can register an IProject adapter on those Java elements.*** This bug has been marked as a duplicate of******has been marked as a duplicate of this bug. ***Reopening, as most of the discussion is in this bug..***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***At first I thought this bug were a duplicate of, which had some different steps to repro but described the same misbehaviour about the main window main menu bar.However, while I can't reproduceon Eclipse Luna I20140606-1215, I can still reproduce this one by following the steps to repro in the description.So this is still valid in current Eclipse.Confirming that this is reproducible in Kepler and Luna. This makes the detached feature unusable especially when the detached editor relies on the contributed menu/toolbar actions to function.	24.0
id=332519	REOPENED	Platform	UI	3.6	Macintosh Mac OS X - Carbon (unsup.)	P3 normal	Platform UI Triaged	2010-12-14 08:54 EST by	Justin Dolezy	2012-05-08 09:18 EDT (	2 users	Build Identifier: 20100917-0705On Cocoa (don't recall if the widget appears with carbon, it might..) there is as a standard Mac button widget in the top right corner which allows users to show/hide the toolbar/perspective bar in RCP apps - this will probably occur with the IDE also but I don't want to lose my toolbar :)Once the toolbar is hidden and the app exited in this state, this title trim widget no longer appears when the app is again started so that you cannot again show the toolbar, without making use of e.g. the org.eclipse.ui.ToggleCoolbarAction command.The trim button should remain after restart.Reproducible: AlwaysSteps to Reproduce:1. Create a new RCP Mail example2. Run it, & use the trim buttom to hide the toolbar3. Exit the app4. Restart the app5. Observe that there's no toolbar trim button any more	CreatedScreenshot showing normal state with title trim button, then showing broken state with unrecoverable toolbarIts seems to be designed that way. The button won't show up unless there is a toolbar to hide. In Eclipse, you can use the Window-Show ToolBar to show the toolbar (and bring back the button) As you said, in RCP apps, you have to use the command to show the button again (or give a menu contribution for that command as the SDK does).I guess the behaviour is correct and hence marking as wont-fixHi Prakash, I'll have to disagree with you on this! Just because something has been implemented a particular way doesn't necessarily make it right! ;)I imagine it is the way it currently works simply because it's following the visibility behaviour of the IDE show/hide toolbar context & Window menu items? Folks have argued that those are inconsistent anyways, doing effectively the same thing from different places! But anyways...The show/hide toolbar title trim is Mac specific, no? Surely it should then be consistent with other Mac apps? No Mac apps that have the trim visible will ever hide it. If RCP apps behave differently it's going to confuse users on the platform; it's not natural to then later have to find a menu item to undo the change.Actually further to that - by your argument, for full consistency the title trim should actually disappear as soon as you've clicked it to hide the toolbar, no? Having it disappear only after a restart actually makes things worse! The user that actually reported this problem with my app was very "WTF?!" ;)Maybe worth getting Scott Kovatch's opinion, or Silenio, on this??(In reply to)Yes, you are right. Let me look into itSure. Cc-ing Scott.Great! But let's not make it disappear on clicking - that'd definitely be a step backwards; just mentioned that to prove a point!Take a look at CocoaUIEnhancer#modifyWindowShell. If the coolbar or perspective bar is not initially visible we don't call createDummyToolbar. If it's not initially visible, then we create a property change listener that sets it up when the coolbar becomes visible.There's a comment in modifyWindowShell about why this is necessary, but I think the rationale is wrong. You always want to call createDummyToolbar() -- all it does is turn on the native toolbar button and set up the listener for it. It doesn't actually make the coolbar visible.(In reply to)Actually, it does happen in the IDE, too -- click the button to hide the toolbar, then quit and launch Eclipse again. The button is gone, but you can get the button and the toolbar back with 'Window -> Show Toolbar'. That's also bad UI. The menu item should stay there all the time and change to 'Hide Toolbar' when the toolbar is visible.	7.0
id=336312	REOPENED	Platform	UI	3.6	PC Windows 7	P3 minor	Platform UI Triaged	2011-02-04 01:34 EST by	Sunil Bannur	2011-05-24 13:44 EDT (	4 users	Build Identifier: 20100617-1415The context help in each wizard page of project creation wizard is not showing up consistently. After clicking on the help icon, the content changes.Reproducible: AlwaysSteps to Reproduce:1.Bring up the generic project wizard or Java project wizard. 2.Click on the context sensitive help 'question mark' on the first page of the wizard. 3.The help contents for that page is shown, keep this help window open4.Now type in some project name and click next in the wizard. 5.The help window remains and contents get changed for that page which is correct. 6.Now click on the question mark in the second page of the wizard (you might have to click twice). 7.The default eclipse help shows up. Also when we close the help window and click on the question mark once again now, the proper help contents comes up.	I'm not able to reproduce this. Assigning to JDT for investigation.In 3.7, the help button is now a toggle, so you can't reproduce the multi-click scenario any more. The multi-click was actually a "feature" (allowed to step up in the widget hierarchy to see context help of outer scopes). But that feature has been used rarely, so we improved the help button to be a toggle. F1 still gives access to outer contexts.In 3.7, a different problem shows up when you follow the steps fromand use the generic project wizard:In step 6, when you click the help button twice to close/reopen, then the focus is on the "< Back" button when you reopen help. But since the "< Back" button doesn't belong to the "Project References" wizard page, you get the help from the outer context.	3.0
id=345917	REOPENED	Platform	UI	4.1	PC Windows XP	P3 normal	Platform UI Triaged	2011-05-16 07:10 EDT by	Dani Megert	2011-11-09 09:43 EST (	4 users	4.1 build: I20110515-0800.1. start new workspace2. Ctrl+33. click into the editor area to close the dialog==> does not work. Same when clicking in the toolbar areaIt works if one clicks on a real part.	Works in I20111014-1625(In reply to)I can't say whether it works in I20111014-1625 but in I20111025-2000 it still does not work.Yep, problem also exists on I20111108-2200.Possibly related is the behaviour that if you re-size the quick access window while it is open, it will not close even when you select a real part. In this state the only way to close it is to give it focus then press esc, or select something from its list.	3.0
id=322381	REOPENED	Platform	UI	3.5.2	PC Windows XP	P3 normal	Platform UI Triaged	2010-08-11 10:56 EDT by	William	2010-11-02 03:15 EDT (	2 users	Hi,I tried out the ini file setting:-Dline.separator=\nwhich actually kind of works yet does not.It replaces all carriage returns in a file with linefeeds (once one linefeed has been entered into the file)However the copy and paste function is now borked and a multiline paste shows the lines all on one line with \n instead of linefeeds.Is there a way to set a 'hard' preferrence for linefeeds - ie any file merely opened in eclipse will be converted to linefeeds?Many ThanksWilliam	I was referred to report this possible bug here via a Eclipse Community Forums posting:William, this works just fine for me. Please provide more details, see also.Note that- -Dline.separator=\n only affects newly created files- this can be overridden by the preference on the 'Workspace' preference page- for existing files the line delimiter of the first line is used to guarantee that the file does not get mixed line delimiters- textual editors in Eclipse honor the existing line delimiters- some VCSs do auto-conversion when checking in/out filesNot sure what to say Dani, it is clearly reproducible here.Build id: 20100218-1602The problem is what "it" is. Different editors might behave differently, so what I'm asking for are detailed steps to reproduce the problem, best starting with a fresh workspace.Createdscreenshot of eclipse new workspace, intro screenCreatedscrolledI tried a new workspace just now, (File, Switch Workspace, Other)It loaded the spalsh start screen with loads of /n appearing on it and asked me if I wanted to debug an error (I have debugging enabled in internet explorer).An eclipse error message occured(on second attempt to load into the new workspace), the details of which stated:"Unable to read workbench state. Workbench UI layout will be reset.\n Content is not allowed in prolog.\n Content is not allowed in prolog.\n"here is the contents of eclipse.ini-startupplugins/org.eclipse.equinox.launcher_1.0.201.R35x_v20090715.jar--launcher.libraryplugins/org.eclipse.equinox.launcher.win32.win32.x86_1.0.200.v20090519-productorg.eclipse.epp.package.jee.product--launcher.XXMaxPermSize256M-showsplashorg.eclipse.platform--launcher.XXMaxPermSize256m--launcher.timeout--launcher.openFile-vmargs-Dosgi.requiredJavaVersion=1.5-Xms40m-Xmx512m-Dline.separator=\nincedently, this has it seems wiped my normal workspace for some reason.I seem to recall attempting to put commented out comments into the eclipse.ini file broke(wiped) the workspace settings in a very similar way to what just occured.here is the complete log from workspace2\.metadata\.login the logfile it appears all on one line, with \n in place of newlines.oddly there are some 'related' loglines in the normal workspace that I use.Eclipse panels seem to all be positioned ok, but all my projects have dissapeared from package explorer.!SESSION 2010-10-12 09:56:02.607 -----------------------------------------------\neclipse.buildId=unknown\njava.version=1.6.0_20\njava.vendor=Sun Microsystems Inc.\nBootLoader constants: OS=win32, ARCH=x86, WS=win32, NL=en_GB\nFramework arguments: -product org.eclipse.epp.package.jee.product --launcher.timeout --launcher.openFile -product org.eclipse.epp.package.jee.product --launcher.timeout --launcher.openFile\nCommand-line arguments: -os win32 -ws win32 -arch x86 -product org.eclipse.epp.package.jee.product --launcher.timeout --launcher.openFile -data c:\Java\workspace2 -product org.eclipse.epp.package.jee.product --launcher.timeout --launcher.openFile\n\n!ENTRY com.google.gdt.eclipse.suite 1 0 2010-10-12 09:56:19.260\n!MESSAGE Registering: com.google.appengine.eclipse.sdkbundle.1.3.4_1.3.4.v201005212032\n\n!ENTRY com.google.gdt.eclipse.suite 1 0 2010-10-12 09:56:19.885\n!MESSAGE Registering: com.google.gwt.eclipse.sdkbundle.2.0.3_2.0.3.v201002191036\n\n!ENTRY org.eclipse.core.net 1 0 2010-10-12 09:56:40.698\n!MESSAGE System property http.proxyHost is set to 192.168.102.102 but should not be set.\n\n!ENTRY org.eclipse.core.net 1 0 2010-10-12 09:56:40.698\n!MESSAGE System property http.proxyPort is set to 3128 but should not be set.\n\n!ENTRY org.eclipse.core.net 1 0 2010-10-12 09:56:40.713\n!MESSAGE System property http.proxyHost is set to 192.168.102.102 but should not be set.\n\n!ENTRY org.eclipse.core.net 1 0 2010-10-12 09:56:40.713\n!MESSAGE System property http.proxyPort is set to 3128 but should not be set.\n\n!ENTRY com.instantiations.eclipse 1 0 2010-10-12 09:56:58.898\n!MESSAGE Failed to determine version of plugin com.instantiations.eclipse.application.audit\n\n!ENTRY com.instantiations.eclipse 1 0 2010-10-12 09:56:58.898\n!MESSAGE Failed to determine version of plugin com.instantiations.profiler.ui\n\n!ENTRY com.instantiations.eclipse 1 0 2010-10-12 09:56:58.898\n!MESSAGE Failed to determine version of plugin com.windowtester.runtime\n\n!ENTRY com.instantiations.eclipse 1 0 2010-10-12 09:56:58.898\n!MESSAGE Failed to determine version of plugin com.windowtester.runtime\n!SESSION 2010-10-12 09:58:21.490 -----------------------------------------------\neclipse.buildId=unknown\njava.version=1.6.0_20\njava.vendor=Sun Microsystems Inc.\nBootLoader constants: OS=win32, ARCH=x86, WS=win32, NL=en_GB\nFramework arguments: -product org.eclipse.epp.package.jee.product --launcher.timeout --launcher.openFile\nCommand-line arguments: -os win32 -ws win32 -arch x86 -product org.eclipse.epp.package.jee.product --launcher.timeout --launcher.openFile\n\n!ENTRY org.eclipse.ui.workbench 4 2 2010-10-12 09:59:01.613\n!MESSAGE Problems occurred when invoking code from plug-in: "org.eclipse.ui.workbench".\n!STACK 1\norg.eclipse.ui.WorkbenchException: Content is not allowed in prolog.\n at org.eclipse.ui.XMLMemento.createReadRoot(XMLMemento.java:121)\n at org.eclipse.ui.XMLMemento.createReadRoot(XMLMemento.java:64)\n at org.eclipse.ui.internal.Workbench$49.run(Workbench.java:1895)\n at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)\n at org.eclipse.ui.internal.Workbench.restoreState(Workbench.java:1890)\n at org.eclipse.ui.internal.WorkbenchConfigurer.restoreState(WorkbenchConfigurer.java:183)\n at org.eclipse.ui.application.WorkbenchAdvisor$1.run(WorkbenchAdvisor.java:781)\nCaused by: org.xml.sax.SAXParseException: Content is not allowed in prolog.\n at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(Unknown Source)\n at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(Unknown Source)\n at org.eclipse.ui.XMLMemento.createReadRoot(XMLMemento.java:94)\n ... 6 more\n!SUBENTRY 1 org.eclipse.ui 4 0 2010-10-12 09:59:01.613\n!MESSAGE Content is not allowed in prolog.\n!STACK 0\norg.xml.sax.SAXParseException: Content is not allowed in prolog.\n at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(Unknown Source)\n at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(Unknown Source)\n at org.eclipse.ui.XMLMemento.createReadRoot(XMLMemento.java:94)\n at org.eclipse.ui.XMLMemento.createReadRoot(XMLMemento.java:64)\n at org.eclipse.ui.internal.Workbench$49.run(Workbench.java:1895)\n at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)\n at org.eclipse.ui.internal.Workbench.restoreState(Workbench.java:1890)\n at org.eclipse.ui.internal.WorkbenchConfigurer.restoreState(WorkbenchConfigurer.java:183)\n at org.eclipse.ui.application.WorkbenchAdvisor$1.run(WorkbenchAdvisor.java:781)\n!SUBENTRY 1 org.eclipse.ui 4 0 2010-10-12 09:59:01.613\n!MESSAGE Content is not allowed in prolog.\n!STACK 0\norg.xml.sax.SAXParseException: Content is not allowed in prolog.\n at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(Unknown Source)\n at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(Unknown Source)\n at org.eclipse.ui.XMLMemento.createReadRoot(XMLMemento.java:94)\n at org.eclipse.ui.XMLMemento.createReadRoot(XMLMemento.java:64)\n at org.eclipse.ui.internal.Workbench$49.run(Workbench.java:1895)\n at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)\n at org.eclipse.ui.internal.Workbench.restoreState(Workbench.java:1890)\n at org.eclipse.ui.internal.WorkbenchConfigurer.restoreState(WorkbenchConfigurer.java:183)\n at org.eclipse.ui.application.WorkbenchAdvisor$1.run(WorkbenchAdvisor.java:781)\n\n!ENTRY com.google.gdt.eclipse.suite 1 0 2010-10-12 09:59:02.285\n!MESSAGE Registering: com.google.appengine.eclipse.sdkbundle.1.3.4_1.3.4.v201005212032\n\n!ENTRY com.google.gdt.eclipse.suite 1 0 2010-10-12 09:59:02.363\n!MESSAGE Registering: com.google.gwt.eclipse.sdkbundle.2.0.3_2.0.3.v201002191036\n\n!ENTRY com.google.gwt.eclipse.core 4 0 2010-10-12 09:59:02.379\n!MESSAGE Could not load UiBinder indices.\n!STACK 1\norg.eclipse.ui.WorkbenchException: Content is not allowed in prolog.\n at org.eclipse.ui.XMLMemento.createReadRoot(XMLMemento.java:121)\n at org.eclipse.ui.XMLMemento.createReadRoot(XMLMemento.java:64)\n at com.google.gwt.eclipse.core.uibinder.model.reference.UiBinderReferenceManager.load(UiBinderReferenceManager.java:381)\n at com.google.gwt.eclipse.core.uibinder.model.reference.UiBinderReferenceManager.start(UiBinderReferenceManager.java:348)\n at com.google.gwt.eclipse.core.GWTPlugin.start(GWTPlugin.java:112)\n at org.eclipse.osgi.framework.internal.core.BundleContextImpl$1.run(BundleContextImpl.java:783)\n at java.security.AccessController.doPrivileged(Native Method)\n at org.eclipse.osgi.framework.internal.core.BundleContextImpl.startActivator(BundleContextImpl.java:774)\n at org.eclipse.osgi.framework.internal.core.BundleContextImpl.start(BundleContextImpl.java:755)\n at org.eclipse.osgi.framework.internal.core.BundleHost.startWorker(BundleHost.java:352)\n at org.eclipse.osgi.framework.internal.core.AbstractBundle.start(AbstractBundle.java:280)\n at org.eclipse.osgi.framework.util.SecureAction.start(SecureAction.java:408)\n at org.eclipse.core.runtime.internal.adaptor.EclipseLazyStarter.postFindLocalClass(EclipseLazyStarter.java:111)\n at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalClass(ClasspathManager.java:449)\n at org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.findLocalClass(DefaultClassLoader.java:211)\n at org.eclipse.osgi.internal.loader.BundleLoader.findLocalClass(BundleLoader.java:381)\n at org.eclipse.osgi.internal.loader.SingleSourcePackage.loadClass(SingleSourcePackage.java:33)\n at org.eclipse.osgi.internal.loader.BundleLoader.findClassInternal(BundleLoader.java:454)\n at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:410)\n at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:398)\n at org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.loadClass(DefaultClassLoader.java:105)\n at java.lang.ClassLoader.loadClass(Unknown Source)\n at com.google.gwt.eclipse.sdkbundle.SdkBundleRegistrant.register(SdkBundleRegistrant.java:50)\n at com.google.gdt.eclipse.suite.preferences.GdtPreferences.registerSdks(GdtPreferences.java:195)\n at com.google.gdt.eclipse.suite.GdtPlugin.start(GdtPlugin.java:364)\n at org.eclipse.osgi.framework.internal.core.BundleContextImpl$1.run(BundleContextImpl.java:783)\n at java.security.AccessController.doPrivileged(Native Method)\n at org.eclipse.osgi.framework.internal.core.BundleContextImpl.startActivator(BundleContextImpl.java:774)\n at org.eclipse.osgi.framework.internal.core.BundleContextImpl.start(BundleContextImpl.java:755)\n at org.eclipse.osgi.framework.internal.core.BundleHost.startWorker(BundleHost.java:352)\n at org.eclipse.osgi.framework.internal.core.AbstractBundle.start(AbstractBundle.java:280)\n at org.eclipse.osgi.framework.util.SecureAction.start(SecureAction.java:408)\n at org.eclipse.core.runtime.internal.adaptor.EclipseLazyStarter.postFindLocalClass(EclipseLazyStarter.java:111)\n at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalClass(ClasspathManager.java:449)\n at org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.findLocalClass(DefaultClassLoader.java:211)\n at org.eclipse.osgi.internal.loader.BundleLoader.findLocalClass(BundleLoader.java:381)\n at org.eclipse.osgi.internal.loader.BundleLoader.findClassInternal(BundleLoader.java:457)\n at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:410)\n at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:398)\n at org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.loadClass(DefaultClassLoader.java:105)\n at java.lang.ClassLoader.loadClass(Unknown Source)\n at org.eclipse.osgi.internal.loader.BundleLoader.loadClass(BundleLoader.java:326)\n at org.eclipse.osgi.framework.internal.core.BundleHost.loadClass(BundleHost.java:231)\n at org.eclipse.osgi.framework.internal.core.AbstractBundle.loadClass(AbstractBundle.java:1193)\n at org.eclipse.core.internal.registry.osgi.RegistryStrategyOSGI.createExecutableExtension(RegistryStrategyOSGI.java:160)\n at org.eclipse.core.internal.registry.ExtensionRegistry.createExecutableExtension(ExtensionRegistry.java:874)\n at org.eclipse.core.internal.registry.ConfigurationElement.createExecutableExtension(ConfigurationElement.java:243)\n at org.eclipse.core.internal.registry.ConfigurationElementHandle.createExecutableExtension(ConfigurationElementHandle.java:51)\n at org.eclipse.ui.internal.util.Util.safeLoadExecutableExtension(Util.java:873)\n at org.eclipse.ui.internal.menus.MenuAdditionCacheEntry.createControlAdditionContribution(MenuAdditionCacheEntry.java:297)\n at org.eclipse.ui.internal.menus.MenuAdditionCacheEntry.createContributionItems(MenuAdditionCacheEntry.java:183)\n at org.eclipse.ui.internal.menus.WorkbenchMenuService$5.run(WorkbenchMenuService.java:561)\n at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)\n at org.eclipse.ui.internal.menus.WorkbenchMenuService.processAdditions(WorkbenchMenuService.java:622)\n at org.eclipse.ui.internal.menus.WorkbenchMenuService.addContributionsToManager(WorkbenchMenuService.java:683)\n at org.eclipse.ui.internal.menus.WorkbenchMenuService.populateContributionManager(WorkbenchMenuService.java:669)\n at org.eclipse.ui.internal.menus.TrimContributionManager$ToolBarTrimProxy.dock(TrimContributionManager.java:75)\n at org.eclipse.ui.internal.menus.TrimContributionManager.update(TrimContributionManager.java:232)\n at org.eclipse.ui.internal.WorkbenchWindow.updateLayoutDataForContents(WorkbenchWindow.java:3785)\n at org.eclipse.ui.internal.WorkbenchWindow.setLayoutDataForContents(WorkbenchWindow.java:3796)\n at org.eclipse.ui.internal.WorkbenchWindow.createDefaultContents(WorkbenchWindow.java:1114)\n at org.eclipse.ui.internal.WorkbenchWindowConfigurer.createDefaultContents(WorkbenchWindowConfigurer.java:625)\n at org.eclipse.ui.application.WorkbenchWindowAdvisor.createWindowContents(WorkbenchWindowAdvisor.java:268)\n at org.eclipse.ui.internal.WorkbenchWindow.createContents(WorkbenchWindow.java:1000)\n at org.eclipse.jface.window.Window.create(Window.java:431)\n at org.eclipse.ui.internal.Workbench$20.runWithException(Workbench.java:1032)\n at org.eclipse.ui.internal.StartupThreading$StartupRunnable.run(StartupThreading.java:31)\n at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\n at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:134)\n at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3885)\n at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3506)\n at org.eclipse.ui.application.WorkbenchAdvisor.openWindows(WorkbenchAdvisor.java:803)\n at org.eclipse.ui.internal.Workbench$28.runWithException(Workbench.java:1384)\n at org.eclipse.ui.internal.StartupThreading$StartupRunnable.run(StartupThreading.java:31)\n at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\n at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:134)\n at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3885)\n at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3506)\n at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2316)\n at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2221)\n at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:500)\n at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)\n at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:493)\n at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)\n at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:113)\n at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:194)\n at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)\n at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)\n at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:368)\n at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)\n at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n at java.lang.reflect.Method.invoke(Unknown Source)\n at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:559)\n at org.eclipse.equinox.launcher.Main.basicRun(Main.java:514)\n at org.eclipse.equinox.launcher.Main.run(Main.java:1311)\nCaused by: org.xml.sax.SAXParseException: Content is not allowed in prolog.\n at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(Unknown Source)\n at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(Unknown Source)\n at org.eclipse.ui.XMLMemento.createReadRoot(XMLMemento.java:94)\n ... 96 more\n!SUBENTRY 1 org.eclipse.ui 4 0 2010-10-12 09:59:02.379\n!MESSAGE Content is not allowed in prolog.\n!STACK 0\norg.xml.sax.SAXParseException: Content is not allowed in prolog.\n at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(Unknown Source)\n at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(Unknown Source)\n at org.eclipse.ui.XMLMemento.createReadRoot(XMLMemento.java:94)\n at org.eclipse.ui.XMLMemento.createReadRoot(XMLMemento.java:64)\n at com.google.gwt.eclipse.core.uibinder.model.reference.UiBinderReferenceManager.load(UiBinderReferenceManager.java:381)\n at com.google.gwt.eclipse.core.uibinder.model.reference.UiBinderReferenceManager.start(UiBinderReferenceManager.java:348)\n at com.google.gwt.eclipse.core.GWTPlugin.start(GWTPlugin.java:112)\n at org.eclipse.osgi.framework.internal.core.BundleContextImpl$1.run(BundleContextImpl.java:783)\n at java.security.AccessController.doPrivileged(Native Method)\n at org.eclipse.osgi.framework.internal.core.BundleContextImpl.startActivator(BundleContextImpl.java:774)\n at org.eclipse.osgi.framework.internal.core.BundleContextImpl.start(BundleContextImpl.java:755)\n at org.eclipse.osgi.framework.internal.core.BundleHost.startWorker(BundleHost.java:352)\n at org.eclipse.osgi.framework.internal.core.AbstractBundle.start(AbstractBundle.java:280)\n at org.eclipse.osgi.framework.util.SecureAction.start(SecureAction.java:408)\n at org.eclipse.core.runtime.internal.adaptor.EclipseLazyStarter.postFindLocalClass(EclipseLazyStarter.java:111)\n at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalClass(ClasspathManager.java:449)\n at org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.findLocalClass(DefaultClassLoader.java:211)\n at org.eclipse.osgi.internal.loader.BundleLoader.findLocalClass(BundleLoader.java:381)\n at org.eclipse.osgi.internal.loader.SingleSourcePackage.loadClass(SingleSourcePackage.java:33)\n at org.eclipse.osgi.internal.loader.BundleLoader.findClassInternal(BundleLoader.java:454)\n at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:410)\n at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:398)\n at org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.loadClass(DefaultClassLoader.java:105)\n at java.lang.ClassLoader.loadClass(Unknown Source)\n at com.google.gwt.eclipse.sdkbundle.SdkBundleRegistrant.register(SdkBundleRegistrant.java:50)\n at com.google.gdt.eclipse.suite.preferences.GdtPreferences.registerSdks(GdtPreferences.java:195)\n at com.google.gdt.eclipse.suite.GdtPlugin.start(GdtPlugin.java:364)\n at org.eclipse.osgi.framework.internal.core.BundleContextImpl$1.run(BundleContextImpl.java:783)\n at java.security.AccessController.doPrivileged(Native Method)\n at org.eclipse.osgi.framework.internal.core.BundleContextImpl.startActivator(BundleContextImpl.java:774)\n at org.eclipse.osgi.framework.internal.core.BundleContextImpl.start(BundleContextImpl.java:755)\n at org.eclipse.osgi.framework.internal.core.BundleHost.startWorker(BundleHost.java:352)\n at org.eclipse.osgi.framework.internal.core.AbstractBundle.start(AbstractBundle.java:280)\n at org.eclipse.osgi.framework.util.SecureAction.start(SecureAction.java:408)\n at org.eclipse.core.runtime.internal.adaptor.EclipseLazyStarter.postFindLocalClass(EclipseLazyStarter.java:111)\n at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalClass(ClasspathManager.java:449)\n at org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.findLocalClass(DefaultClassLoader.java:211)\n at org.eclipse.osgi.internal.loader.BundleLoader.findLocalClass(BundleLoader.java:381)\n at org.eclipse.osgi.internal.loader.BundleLoader.findClassInternal(BundleLoader.java:457)\n at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:410)\n at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:398)\n at org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.loadClass(DefaultClassLoader.java:105)\n at java.lang.ClassLoader.loadClass(Unknown Source)\n at org.eclipse.osgi.internal.loader.BundleLoader.loadClass(BundleLoader.java:326)\n at org.eclipse.osgi.framework.internal.core.BundleHost.loadClass(BundleHost.java:231)\n at org.eclipse.osgi.framework.internal.core.AbstractBundle.loadClass(AbstractBundle.java:1193)\n at org.eclipse.core.internal.registry.osgi.RegistryStrategyOSGI.createExecutableExtension(RegistryStrategyOSGI.java:160)\n at org.eclipse.core.internal.registry.ExtensionRegistry.createExecutableExtension(ExtensionRegistry.java:874)\n at org.eclipse.core.internal.registry.ConfigurationElement.createExecutableExtension(ConfigurationElement.java:243)\n at org.eclipse.core.internal.registry.ConfigurationElementHandle.createExecutableExtension(ConfigurationElementHandle.java:51)\n at org.eclipse.ui.internal.util.Util.safeLoadExecutableExtension(Util.java:873)\n at org.eclipse.ui.internal.menus.MenuAdditionCacheEntry.createControlAdditionContribution(MenuAdditionCacheEntry.java:297)\n at org.eclipse.ui.internal.menus.MenuAdditionCacheEntry.createContributionItems(MenuAdditionCacheEntry.java:183)\n at org.eclipse.ui.internal.menus.WorkbenchMenuService$5.run(WorkbenchMenuService.java:561)\n at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)\n at org.eclipse.ui.internal.menus.WorkbenchMenuService.processAdditions(WorkbenchMenuService.java:622)\n at org.eclipse.ui.internal.menus.WorkbenchMenuService.addContributionsToManager(WorkbenchMenuService.java:683)\n at org.eclipse.ui.internal.menus.WorkbenchMenuService.populateContributionManager(WorkbenchMenuService.java:669)\n at org.eclipse.ui.internal.menus.TrimContributionManager$ToolBarTrimProxy.dock(TrimContributionManager.java:75)\n at org.eclipse.ui.internal.menus.TrimContributionManager.update(TrimContributionManager.java:232)\n at org.eclipse.ui.internal.WorkbenchWindow.updateLayoutDataForContents(WorkbenchWindow.java:3785)\n at org.eclipse.ui.internal.WorkbenchWindow.setLayoutDataForContents(WorkbenchWindow.java:3796)\n at org.eclipse.ui.internal.WorkbenchWindow.createDefaultContents(WorkbenchWindow.java:1114)\n at org.eclipse.ui.internal.WorkbenchWindowConfigurer.createDefaultContents(WorkbenchWindowConfigurer.java:625)\n at org.eclipse.ui.application.WorkbenchWindowAdvisor.createWindowContents(WorkbenchWindowAdvisor.java:268)\n at org.eclipse.ui.internal.WorkbenchWindow.createContents(WorkbenchWindow.java:1000)\n at org.eclipse.jface.window.Window.create(Window.java:431)\n at org.eclipse.ui.internal.Workbench$20.runWithException(Workbench.java:1032)\n at org.eclipse.ui.internal.StartupThreading$StartupRunnable.run(StartupThreading.java:31)\n at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\n at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:134)\n at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3885)\n at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3506)\n at org.eclipse.ui.application.WorkbenchAdvisor.openWindows(WorkbenchAdvisor.java:803)\n at org.eclipse.ui.internal.Workbench$28.runWithException(Workbench.java:1384)\n at org.eclipse.ui.internal.StartupThreading$StartupRunnable.run(StartupThreading.java:31)\n at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)\n at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:134)\n at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3885)\n at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3506)\n at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2316)\n at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2221)\n at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:500)\n at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)\n at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:493)\n at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)\n at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:113)\n at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:194)\n at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)\n at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)\n at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:368)\n at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)\n at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n at java.lang.reflect.Method.invoke(Unknown Source)\n at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:559)\n at org.eclipse.equinox.launcher.Main.basicRun(Main.java:514)\n at org.eclipse.equinox.launcher.Main.run(Main.java:1311)\n\n!ENTRY org.eclipse.jdt.ui 4 10001 2010-10-12 09:59:13.825\n!MESSAGE Internal Error\n!STACK 1\norg.eclipse.jdt.internal.ui.JavaUIException: Problems reading information from XML 'OpenTypeHistory.xml'\n at org.eclipse.jdt.internal.corext.util.History.createException(History.java:70)\n at org.eclipse.jdt.internal.corext.util.History.load(History.java:257)\n at org.eclipse.jdt.internal.corext.util.History.load(History.java:166)\n at org.eclipse.jdt.internal.corext.util.OpenTypeHistory.<init>(OpenTypeHistory.java:199)\n at org.eclipse.jdt.internal.corext.util.OpenTypeHistory.getInstance(OpenTypeHistory.java:185)\n at org.eclipse.jdt.internal.ui.JavaPlugin.initializeAfterLoad(JavaPlugin.java:381)\n at org.eclipse.jdt.internal.ui.InitializeAfterLoadJob$RealJob.run(InitializeAfterLoadJob.java:36)\n at org.eclipse.core.internal.jobs.Worker.run(Worker.java:55)\nCaused by: org.xml.sax.SAXParseException: Content is not allowed in prolog.\n at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(Unknown Source)\n at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(Unknown Source)\n at org.eclipse.jdt.internal.corext.util.History.load(History.java:255)\n ... 6 more\n!SUBENTRY 1 org.eclipse.jdt.ui 4 4 2010-10-12 09:59:13.825\n!MESSAGE Problems reading information from XML 'OpenTypeHistory.xml'\n!STACK 0\norg.xml.sax.SAXParseException: Content is not allowed in prolog.\n at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(Unknown Source)\n at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(Unknown Source)\n at org.eclipse.jdt.internal.corext.util.History.load(History.java:255)\n at org.eclipse.jdt.internal.corext.util.History.load(History.java:166)\n at org.eclipse.jdt.internal.corext.util.OpenTypeHistory.<init>(OpenTypeHistory.java:199)\n at org.eclipse.jdt.internal.corext.util.OpenTypeHistory.getInstance(OpenTypeHistory.java:185)\n at org.eclipse.jdt.internal.ui.JavaPlugin.initializeAfterLoad(JavaPlugin.java:381)\n at org.eclipse.jdt.internal.ui.InitializeAfterLoadJob$RealJob.run(InitializeAfterLoadJob.java:36)\n at org.eclipse.core.internal.jobs.Worker.run(Worker.java:55)\n\n!ENTRY org.eclipse.wst.jsdt.ui 4 10001 2010-10-12 09:59:13.903\n!MESSAGE Internal Error\n!STACK 1\norg.eclipse.wst.jsdt.internal.ui.JavaUIException: Problems reading information from XML 'OpenTypeHistory.xml'\n at org.eclipse.wst.jsdt.internal.corext.util.History.createException(History.java:65)\n at org.eclipse.wst.jsdt.internal.corext.util.History.load(History.java:251)\n at org.eclipse.wst.jsdt.internal.corext.util.History.load(History.java:161)\n at org.eclipse.wst.jsdt.internal.corext.util.OpenTypeHistory.<init>(OpenTypeHistory.java:189)\n at org.eclipse.wst.jsdt.internal.corext.util.OpenTypeHistory.getInstance(OpenTypeHistory.java:175)\n at org.eclipse.wst.jsdt.internal.ui.JavaScriptPlugin.initializeAfterLoad(JavaScriptPlugin.java:358)\n at org.eclipse.wst.jsdt.internal.ui.InitializeAfterLoadJob$RealJob.run(InitializeAfterLoadJob.java:33)\n at org.eclipse.core.internal.jobs.Worker.run(Worker.java:55)\nCaused by: org.xml.sax.SAXParseException: Content is not allowed in prolog.\n at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(Unknown Source)\n at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(Unknown Source)\n at org.eclipse.wst.jsdt.internal.corext.util.History.load(History.java:249)\n ... 6 more\n!SUBENTRY 1 org.eclipse.wst.jsdt.ui 4 4 2010-10-12 09:59:13.903\n!MESSAGE Problems reading information from XML 'OpenTypeHistory.xml'\n!STACK 0\norg.xml.sax.SAXParseException: Content is not allowed in prolog.\n at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(Unknown Source)\n at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(Unknown Source)\n at org.eclipse.wst.jsdt.internal.corext.util.History.load(History.java:249)\n at org.eclipse.wst.jsdt.internal.corext.util.History.load(History.java:161)\n at org.eclipse.wst.jsdt.internal.corext.util.OpenTypeHistory.<init>(OpenTypeHistory.java:189)\n at org.eclipse.wst.jsdt.internal.corext.util.OpenTypeHistory.getInstance(OpenTypeHistory.java:175)\n at org.eclipse.wst.jsdt.internal.ui.JavaScriptPlugin.initializeAfterLoad(JavaScriptPlugin.java:358)\n at org.eclipse.wst.jsdt.internal.ui.InitializeAfterLoadJob$RealJob.run(InitializeAfterLoadJob.java:33)\n at org.eclipse.core.internal.jobs.Worker.run(Worker.java:55)\n\n!ENTRY org.eclipse.core.net 1 0 2010-10-12 09:59:14.481\n!MESSAGE System property http.proxyHost is set to 192.168.102.102 but should not be set.\n\n!ENTRY org.eclipse.core.net 1 0 2010-10-12 09:59:14.481\n!MESSAGE System property http.proxyPort is set to 3128 but should not be set.\n\n!ENTRY org.eclipse.core.net 1 0 2010-10-12 09:59:14.497\n!MESSAGE System property http.proxyHost is set to 192.168.102.102 but should not be set.\n\n!ENTRY org.eclipse.core.net 1 0 2010-10-12 09:59:14.497\n!MESSAGE System property http.proxyPort is set to 3128 but should not be set.\n\n!ENTRY com.instantiations.eclipse 1 0 2010-10-12 09:59:34.215\n!MESSAGE Failed to determine version of plugin com.instantiations.eclipse.application.audit\n\n!ENTRY com.instantiations.eclipse 1 0 2010-10-12 09:59:34.215\n!MESSAGE Failed to determine version of plugin com.instantiations.profiler.ui\n\n!ENTRY com.instantiations.eclipse 1 0 2010-10-12 09:59:34.215\n!MESSAGE Failed to determine version of plugin com.windowtester.runtime\n\n!ENTRY com.instantiations.eclipse 1 0 2010-10-12 09:59:34.215\n!MESSAGE Failed to determine version of plugin com.windowtester.runtime\n\n!ENTRY org.eclipse.jdt.ui 4 10001 2010-10-12 10:09:42.059\n!MESSAGE Internal Error\n!STACK 1\norg.eclipse.jdt.internal.ui.JavaUIException: Problems reading information from XML 'QualifiedTypeNameHistory.xml'\n at org.eclipse.jdt.internal.corext.util.History.createException(History.java:70)\n at org.eclipse.jdt.internal.corext.util.History.load(History.java:257)\n at org.eclipse.jdt.internal.corext.util.History.load(History.java:166)\n at org.eclipse.jdt.internal.corext.util.QualifiedTypeNameHistory.<init>(QualifiedTypeNameHistory.java:33)\n at org.eclipse.jdt.internal.corext.util.QualifiedTypeNameHistory.getDefault(QualifiedTypeNameHistory.java:26)\n at org.eclipse.jdt.internal.ui.JavaPlugin.stop(JavaPlugin.java:602)\n at org.eclipse.osgi.framework.internal.core.BundleContextImpl$2.run(BundleContextImpl.java:843)\n at java.security.AccessController.doPrivileged(Native Method)\n at org.eclipse.osgi.framework.internal.core.BundleContextImpl.stop(BundleContextImpl.java:836)\n at org.eclipse.osgi.framework.internal.core.BundleHost.stopWorker(BundleHost.java:474)\n at org.eclipse.osgi.framework.internal.core.AbstractBundle.suspend(AbstractBundle.java:546)\n at org.eclipse.osgi.framework.internal.core.Framework.suspendBundle(Framework.java:1098)\n at org.eclipse.osgi.framework.internal.core.StartLevelManager.decFWSL(StartLevelManager.java:593)\n at org.eclipse.osgi.framework.internal.core.StartLevelManager.doSetStartLevel(StartLevelManager.java:261)\n at org.eclipse.osgi.framework.internal.core.StartLevelManager.shutdown(StartLevelManager.java:216)\n at org.eclipse.osgi.framework.internal.core.InternalSystemBundle.suspend(InternalSystemBundle.java:266)\n at org.eclipse.osgi.framework.internal.core.Framework.shutdown(Framework.java:685)\n at org.eclipse.osgi.framework.internal.core.Framework.close(Framework.java:583)\n at org.eclipse.core.runtime.adaptor.EclipseStarter.shutdown(EclipseStarter.java:409)\n at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:200)\n at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n at java.lang.reflect.Method.invoke(Unknown Source)\n at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:559)\n at org.eclipse.equinox.launcher.Main.basicRun(Main.java:514)\n at org.eclipse.equinox.launcher.Main.run(Main.java:1311)\nCaused by: org.xml.sax.SAXParseException: Content is not allowed in prolog.\n at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(Unknown Source)\n at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(Unknown Source)\n at org.eclipse.jdt.internal.corext.util.History.load(History.java:255)\n ... 25 more\n!SUBENTRY 1 org.eclipse.jdt.ui 4 4 2010-10-12 10:09:42.059\n!MESSAGE Problems reading information from XML 'QualifiedTypeNameHistory.xml'\n!STACK 0\norg.xml.sax.SAXParseException: Content is not allowed in prolog.\n at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(Unknown Source)\n at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(Unknown Source)\n at org.eclipse.jdt.internal.corext.util.History.load(History.java:255)\n at org.eclipse.jdt.internal.corext.util.History.load(History.java:166)\n at org.eclipse.jdt.internal.corext.util.QualifiedTypeNameHistory.<init>(QualifiedTypeNameHistory.java:33)\n at org.eclipse.jdt.internal.corext.util.QualifiedTypeNameHistory.getDefault(QualifiedTypeNameHistory.java:26)\n at org.eclipse.jdt.internal.ui.JavaPlugin.stop(JavaPlugin.java:602)\n at org.eclipse.osgi.framework.internal.core.BundleContextImpl$2.run(BundleContextImpl.java:843)\n at java.security.AccessController.doPrivileged(Native Method)\n at org.eclipse.osgi.framework.internal.core.BundleContextImpl.stop(BundleContextImpl.java:836)\n at org.eclipse.osgi.framework.internal.core.BundleHost.stopWorker(BundleHost.java:474)\n at org.eclipse.osgi.framework.internal.core.AbstractBundle.suspend(AbstractBundle.java:546)\n at org.eclipse.osgi.framework.internal.core.Framework.suspendBundle(Framework.java:1098)\n at org.eclipse.osgi.framework.internal.core.StartLevelManager.decFWSL(StartLevelManager.java:593)\n at org.eclipse.osgi.framework.internal.core.StartLevelManager.doSetStartLevel(StartLevelManager.java:261)\n at org.eclipse.osgi.framework.internal.core.StartLevelManager.shutdown(StartLevelManager.java:216)\n at org.eclipse.osgi.framework.internal.core.InternalSystemBundle.suspend(InternalSystemBundle.java:266)\n at org.eclipse.osgi.framework.internal.core.Framework.shutdown(Framework.java:685)\n at org.eclipse.osgi.framework.internal.core.Framework.close(Framework.java:583)\n at org.eclipse.core.runtime.adaptor.EclipseStarter.shutdown(EclipseStarter.java:409)\n at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:200)\n at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n at java.lang.reflect.Method.invoke(Unknown Source)\n at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:559)\n at org.eclipse.equinox.launcher.Main.basicRun(Main.java:514)\n at org.eclipse.equinox.launcher.Main.run(Main.java:1311)\n\n!ENTRY org.eclipse.wst.jsdt.ui 4 10001 2010-10-12 10:09:42.106\n!MESSAGE Internal Error\n!STACK 1\norg.eclipse.wst.jsdt.internal.ui.JavaUIException: Problems reading information from XML 'QualifiedTypeNameHistory.xml'\n at org.eclipse.wst.jsdt.internal.corext.util.History.createException(History.java:65)\n at org.eclipse.wst.jsdt.internal.corext.util.History.load(History.java:251)\n at org.eclipse.wst.jsdt.internal.corext.util.History.load(History.java:161)\n at org.eclipse.wst.jsdt.internal.corext.util.QualifiedTypeNameHistory.<init>(QualifiedTypeNameHistory.java:33)\n at org.eclipse.wst.jsdt.internal.corext.util.QualifiedTypeNameHistory.getDefault(QualifiedTypeNameHistory.java:26)\n at org.eclipse.wst.jsdt.internal.ui.JavaScriptPlugin.stop(JavaScriptPlugin.java:569)\n at org.eclipse.osgi.framework.internal.core.BundleContextImpl$2.run(BundleContextImpl.java:843)\n at java.security.AccessController.doPrivileged(Native Method)\n at org.eclipse.osgi.framework.internal.core.BundleContextImpl.stop(BundleContextImpl.java:836)\n at org.eclipse.osgi.framework.internal.core.BundleHost.stopWorker(BundleHost.java:474)\n at org.eclipse.osgi.framework.internal.core.AbstractBundle.suspend(AbstractBundle.java:546)\n at org.eclipse.osgi.framework.internal.core.Framework.suspendBundle(Framework.java:1098)\n at org.eclipse.osgi.framework.internal.core.StartLevelManager.decFWSL(StartLevelManager.java:593)\n at org.eclipse.osgi.framework.internal.core.StartLevelManager.doSetStartLevel(StartLevelManager.java:261)\n at org.eclipse.osgi.framework.internal.core.StartLevelManager.shutdown(StartLevelManager.java:216)\n at org.eclipse.osgi.framework.internal.core.InternalSystemBundle.suspend(InternalSystemBundle.java:266)\n at org.eclipse.osgi.framework.internal.core.Framework.shutdown(Framework.java:685)\n at org.eclipse.osgi.framework.internal.core.Framework.close(Framework.java:583)\n at org.eclipse.core.runtime.adaptor.EclipseStarter.shutdown(EclipseStarter.java:409)\n at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:200)\n at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n at java.lang.reflect.Method.invoke(Unknown Source)\n at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:559)\n at org.eclipse.equinox.launcher.Main.basicRun(Main.java:514)\n at org.eclipse.equinox.launcher.Main.run(Main.java:1311)\nCaused by: org.xml.sax.SAXParseException: Content is not allowed in prolog.\n at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(Unknown Source)\n at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(Unknown Source)\n at org.eclipse.wst.jsdt.internal.corext.util.History.load(History.java:249)\n ... 25 more\n!SUBENTRY 1 org.eclipse.wst.jsdt.ui 4 4 2010-10-12 10:09:42.106\n!MESSAGE Problems reading information from XML 'QualifiedTypeNameHistory.xml'\n!STACK 0\norg.xml.sax.SAXParseException: Content is not allowed in prolog.\n at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(Unknown Source)\n at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(Unknown Source)\n at org.eclipse.wst.jsdt.internal.corext.util.History.load(History.java:249)\n at org.eclipse.wst.jsdt.internal.corext.util.History.load(History.java:161)\n at org.eclipse.wst.jsdt.internal.corext.util.QualifiedTypeNameHistory.<init>(QualifiedTypeNameHistory.java:33)\n at org.eclipse.wst.jsdt.internal.corext.util.QualifiedTypeNameHistory.getDefault(QualifiedTypeNameHistory.java:26)\n at org.eclipse.wst.jsdt.internal.ui.JavaScriptPlugin.stop(JavaScriptPlugin.java:569)\n at org.eclipse.osgi.framework.internal.core.BundleContextImpl$2.run(BundleContextImpl.java:843)\n at java.security.AccessController.doPrivileged(Native Method)\n at org.eclipse.osgi.framework.internal.core.BundleContextImpl.stop(BundleContextImpl.java:836)\n at org.eclipse.osgi.framework.internal.core.BundleHost.stopWorker(BundleHost.java:474)\n at org.eclipse.osgi.framework.internal.core.AbstractBundle.suspend(AbstractBundle.java:546)\n at org.eclipse.osgi.framework.internal.core.Framework.suspendBundle(Framework.java:1098)\n at org.eclipse.osgi.framework.internal.core.StartLevelManager.decFWSL(StartLevelManager.java:593)\n at org.eclipse.osgi.framework.internal.core.StartLevelManager.doSetStartLevel(StartLevelManager.java:261)\n at org.eclipse.osgi.framework.internal.core.StartLevelManager.shutdown(StartLevelManager.java:216)\n at org.eclipse.osgi.framework.internal.core.InternalSystemBundle.suspend(InternalSystemBundle.java:266)\n at org.eclipse.osgi.framework.internal.core.Framework.shutdown(Framework.java:685)\n at org.eclipse.osgi.framework.internal.core.Framework.close(Framework.java:583)\n at org.eclipse.core.runtime.adaptor.EclipseStarter.shutdown(EclipseStarter.java:409)\n at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:200)\n at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n at java.lang.reflect.Method.invoke(Unknown Source)\n at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:559)\n at org.eclipse.equinox.launcher.Main.basicRun(Main.java:514)\n at org.eclipse.equinox.launcher.Main.run(Main.java:1311)\n(In reply to)OK, so your bug is about the Welcome page, which is not an editor but some content displayed in a web browser widget. Correct?Looking at your stack trace it seems that you did not pass the '\n' character but rather the string "\n" (two chars) which of course completely confuses any reader/writer.See.so -Dline.separator=\n should not be -Dline.separator=\n but -Dline.separator=? (ie just press enther after the equals symbol?)"OK, so your bug is about the Welcome page, which is not an editor but somecontent displayed in a web browser widget. Correct?"this is a fairly obtuse stance to take dont you think Dani?Clearly eclipse.ini is being parsed in a manner that that does not understand asimple switch and also does not understand comments in any form and thisintolerance(=bad programming) breaks workspaces. Why bother checking if anyfiles opened/edited have the expected newlines if the entire eclipseenvironment is so obviously adversely affected?why not have in the first place:-Dline.separator=newline-Dline.separator=carriagereturnThis is a VM argument you're using and not an Eclipse property - you would have to complain there. Note that Eclipse offers to set the line delimiter for new text files on the 'Workspace' preference page. This might do the trick for you.And yes, it's hard if not impossible to correctly set the line delimiter via that VM property but that's a limitation that the VM vendor decided not to fix, see bug referenced above.Having said that, Eclipse itself must make sure that it doesn't loose data when the user tries the obvious.Moving to Platform UI as it starts to fail when trying to restore the workspace.Should this be re-opened then?PW(In reply to)Yep. Done.Ok, let's start with Workbench.restoreState() to deal with this.	17.0
id=352135	REOPENED	Platform	UI	4.1	All All	P3 normal	Platform UI Triaged	2011-07-14 12:37 EDT by	Remy Suen	2015-02-03 10:48 EST (	2 users	When reproducing, the 3.x stack trace ofdoes not match ours. This is because the selection listeners are notified of the active part having changed after the part listeners have been notified.The selection listeners should be fired first.	Fixed by 7c5ba07e173ab5551549c30571740504b312cbae in R4_development.Verified by source inspection on M20110817-2001.(In reply to Remy Suen from)This change introduced. As explained in, this issue should be fixed in a different way. In commit 05f82f43566364722a1594238161aadaa551da07 I have reverted this change to fix.Because of that I need to reopen this bug.	3.0
id=350078	REOPENED	Platform	UI	3.7	PC Windows XP	P3 normal	Platform UI Triaged	2011-06-22 12:33 EDT by	yulei	2011-07-25 03:01 EDT (	3 users	Build Identifier: I20110613-1736Create a RCP firstly.When the perspective is actived, the menubarManager could be updated. However,the toolbarManager or coolbarManager couldn't.Reproducible: AlwaysSteps to Reproduce:1.Create an extension of org.eclipse.ui.perspectiveExtensions.2.Create a hiddenTooBarItem on the extension.3.Run the program.4.The hiddenTooBarItem does not work.	Line 984 of class Perspective.final IMenuManager windowManager = page.getActionBars() .getMenuManager();allowUpdates(windowManager);windowManager.update(false);The MenuManager is updated, but the CoolBarManager or ToolBarManager is not.Seewhich fixed the menu manager issue.*** This bug has been marked as a duplicate of***fixed the menu but not the CoolBarManager or ToolBarManager.	4.0
id=357666	REOPENED	Platform	UI	4.2	All All	P3 normal	Platform UI Triaged	2011-09-14 13:51 EDT by	Remy Suen	2013-05-27 10:30 EDT (	1 user	Parent bug for all issues affecting PDT on Eclipse 4.x.	Marking as M5 to check the state of the other defects related to this one...Since there are no open 'Depends on' defects left I'll move this to 4.2.1....dependency	4.0
id=355750	REOPENED	Platform	UI	3.7	PC Mac OS X - Carbon (unsup.)	P3 normal	Platform UI Triaged	2011-08-24 13:07 EDT by	Thomas Schindl	2014-11-10 12:48 EST (	8 users	The API introduced inis not working in conjunction with save and restore. I've tried debugging in the workbench a bit but I must admit I have no clue what needs to be changed.Any pointers how we can achieve this would appreciateds so that I can prepare a patch for 3.8	CreatedPatchThis fixes the problem for me - can someone review that and tell me if I'm on a completely wrong track?Createdexample projectCreatedRevised patch to never create a ContainerPlaceholder for a 'durable' stackTom, the original patch worked but was overkill since the 'replacePlaceholderWithPart(LayoutPart)' is called for every part in the presentation.This patch just augments your change to the ViewSashContainer's restoreState method to not create a ContainerPlaceholder if the actual ViewStack is to be 'durable'.I'll commit this into 3.8 and I'll open a new defect to see if we can get it into 3.7.2 (no promises but we can show that the change can only affect 'durable' ViewStacks and is otherwise without side-effects).Committed in >20110826. Applied the revised patch.Tom, get back to me if there are any issues with this. I tested it using your example project (thanks!) and it appears to work fine.Did you opened a bug for this Eric? I have no problem rolling my own workbench-plugin but getting it from upstream would certainly make my life easier.TomThe current fix for this introduces a regression into the existing work flows (seefor details).We need the perspective's id in order to make the 'isDurable' API call to the advisor. Not sure what the correct fix is yet...Well first of all isDurable is used mainly RCP applications who normally not hit by the problem we are seeing here because this happens only if a perspective is restored in a New Window, so we could simply add a check for null-check and omit the call isDurable() - in the other parts where the call is done there's also a check if the descriptor is not null BTW.I think we need to document the fact that we are not calling isDurable() in the above mentionned case.Another interesting question naturally is also why the perspective is not set when we restore a view in a new window.I start to ask myself why Boris introduce this by setting a boolean field and not simply invoking the check on the advisor when getDurable() is called. Then this would not be different whether the folder is restored or created from scratchEric, I think we don't need to store those in the ViewStack. I've taken a look and the getDurable() is only used in the PerspectiveHelper. Instead of storing/restoring the durable information we can simply test in the PerspectiveHelper by calling the WindowAdvisor.The problem with we are seeing when a perspective is restored in a new window the perspective is set after the restore happened. I'll prepare a patch.and btw your fix didn't worked out fully because when one restored a ViewStack which is empty it was hidden. I think we should remove the durable-attribute and implement the logic inside the PerspectiveHelper where we are guaranteed to have the perspective.Tom, any chance you could make a patch ? I think I understand but I read code better...;-).It's at the top of my work queue for MondayBeauty, mine too :)CreatedPatchThis patch completely removes the durable-attribute and simply calls out to the advisor when needed. If I read the code correct this perspective is guaranteed to be set when when helper is invoked and so we don't run in the NPE like the one in. Now the only question I'm still uncertain about is why Boris introduced the durable attribute, am I missing a race condition here e.g. with the window-advisor?Boris - do you by chance remember why you added this durable attribute?Tom, this patch looks good. I'm just being a bit more diligent about testing this time. I think you are correct though in that by placing the code directly into the PerspectiveHelper is should be *impossible* to not be able to get its id as needed...The only concern I have is that the ViewStack is still using the 'durable' field in 'setMinimized' but the field no longer reflects the actual 'durable' state. This ends up leaving the window in an incorrect state if you minimize a 'durable' folder (screen shot coming).Let me see if I can work around that since the code that's in 'setMinimized' is a hack to get around the issue and there's already added logic in the PerspectiveHelper regarding min/max (so adding a special check to 'isDurable' to return false under this condition isn't really too bad I think).CreatedScreen shot of the sample app if you minimize the 'messages' stackSince the field is no longer used by the PerspectiveHelper the code no longer works.Tom, I'm still working on this but my first three tries...#fail. Sheesh, the 3.x codebase is complicated (it's been a while since I've had to . I've gone back to your original patch since is still has the field in use (changing the min/max implementation is hairier than getting this working I suspect).CreatedPatchThis patch is an improved version from the very first one:a) durable replacement happens in PerspectiveHelperb) It takes care of minimized stacks by consulting the perspectives mementoThanks Tom, I'm going to do both this patch as well as the fix forat the same time since the NO_CLOSE tag is the 'e4' version of 'durable'...OK, as far as I can tell this one doesn't introduce any issues in the IDE itself and looks safe.There is still one corner case that's not perfect. If you minimize the durable stack and close its last view while its minimized the stack disappears from the trim but does *not* show back up in the UI.If you are OK with that then I'll commit this patch. It may be possible to detect when a 'durable' but minimized stack goes empty and force a restore on it from the FastViewManager...Let me know what you think.***has been marked as a duplicate of this bug. ***We can fix this now easily in 4.x by using the NO_AUTO_CLOSE tag introduced inWhat's the current state of this defect ? I'm considering moving if out of Luna...In Eclipse3 compatibility mode the method WorkbenchWindowAdvisor#isDurableFolder() is never called and therefore the tag "NoAutoCollapse" is not defined in the corresponding MStack model elements with the result that the Folder will be always collapsed when the last part is closed	26.0
id=366600	REOPENED	Platform	UI	4.2	PC Linux	P3 major	Platform UI Triaged	2011-12-13 13:46 EST by	Paul Webster	2014-07-03 16:18 EDT (	3 users	org.eclipse.ui.tests.services.ILevelService is contributed through org.eclipse.ui.services, but they don't appear to line up with what we returned:The window level service locator returns an ILevelService that says "1" but it should be "2".org.eclipse.ui.tests.services.ContributedServiceTest.testWindowService()	Createdstart to fix the ServiceLocator v01I think there needs to be a walk up the IEclipseContext after the getLocal(*)PWReleasedPW(In reply to)Reopening as this comment caused keybindings to stop working. See.The keybinding problem has apparently been fixed. What's left to do here?We're still not correctly using org.eclipse.ui.services. Any contribution will only get one service, instead of 1 per level. But we might have to push this to SR1 as even a simple change can break it.PWThis needs to be fixed, but any fix is extremely risky.Once this works, our own services (like commands) should be contributed the correct way as in 3.8.PW(In reply to Paul Webster from)Not sure what the issue is here, but it sounds to me that this must have been solved in the mentime. Marking as fixed, please reopen if need.You mean we've started honouring org.eclipse.ui.services? Please test it out before you close the bug.PW(In reply to Paul Webster from)The description was a bit to fuzzy for me to test it. This bug sounds like a private note to yourself. And as keybinding work fine (mentioned here) in 4.4 work fine, I guessed you fixed the issue in the meantime. Can you describe the way how to test this issue and what the actual problem it?You shouldn't close bugs especially if you can't reproduce the usecase that causes the problem.Use the org.eclipse.ui.services extension point.These tests fail: org.eclipse.ui.tests.services.ContributedServiceTestThat's part of the reason the org.eclipse.ui.tests.services.ServicesTestSuite is commented out of the UI tests suites. The correct course of action is to fix it so all the tests pass, as it's a regression and indicates there is an entire piece of functionality that's broken.PW(In reply to Paul Webster from)Thanks for the clarification on the nature of this bug.(In reply to Paul Webster from)I think in general that is a valid reason to close a bug. But I agree with you that this should not be applied for bugs opened by another active committer.(In reply to Lars Vogel from)I mean by that you can't figure out the usecase to run to test the bug, then you can ask for clarification but you can't close the bug.If you run the usecase in the bug and you can't reproduce the problem, that's a valid reason to close the bug.PW	13.0
id=359059	REOPENED	Platform	UI	4.2	PC Windows XP	P3 normal	Platform UI Triaged	2011-09-27 09:33 EDT by	Remy Suen	2015-04-10 10:12 EDT (	6 users	Eclipse appears to continue to function.org.eclipse.core.commands.common.NotDefinedException: Cannot get the parent identifier from an undefined context. org.eclipse.wst.server.ui.internal.webbrowser.actionSet at org.eclipse.core.commands.contexts.Context.getParentId(Context.java:201) at org.eclipse.jface.bindings.BindingManager.createFilteredContextTreeFor(BindingManager.java:825) at org.eclipse.jface.bindings.BindingManager.recomputeBindings(BindingManager.java:1721) at org.eclipse.jface.bindings.BindingManager.contextManagerChanged(BindingManager.java:689) at org.eclipse.core.commands.contexts.ContextManager.fireContextManagerChanged(ContextManager.java:165) at org.eclipse.core.commands.contexts.ContextManager.setActiveContextIds(ContextManager.java:295) at org.eclipse.e4.ui.internal.services.ContextContextService.getActiveContextIds(ContextContextService.java:84) at org.eclipse.ui.internal.contexts.ContextService.getActiveContextIds(ContextService.java:253) at org.eclipse.ui.internal.contexts.ActiveContextSourceProvider.getCurrentState(ActiveContextSourceProvider.java:68) at org.eclipse.ui.internal.contexts.ActiveContextSourceProvider.contextManagerChanged(ActiveContextSourceProvider.java:50) at org.eclipse.core.commands.contexts.ContextManager.fireContextManagerChanged(ContextManager.java:165) at org.eclipse.core.commands.contexts.ContextManager.setEventCaching(ContextManager.java:324) at org.eclipse.core.commands.contexts.ContextManager.deferUpdates(ContextManager.java:83) at org.eclipse.ui.internal.contexts.ContextAuthority.sourceChanged(ContextAuthority.java:673) at org.eclipse.ui.internal.services.ExpressionAuthority.sourceChanged(ExpressionAuthority.java:310) at org.eclipse.ui.internal.services.ExpressionAuthority.sourceChanged(ExpressionAuthority.java:290) at org.eclipse.ui.AbstractSourceProvider.fireSourceChanged(AbstractSourceProvider.java:99) at org.eclipse.ui.internal.services.WorkbenchSourceProvider.checkActivePart(WorkbenchSourceProvider.java:407) at org.eclipse.ui.internal.services.WorkbenchSourceProvider.checkActivePart(WorkbenchSourceProvider.java:297) at org.eclipse.ui.internal.services.WorkbenchSourceProvider$1.partDeactivated(WorkbenchSourceProvider.java:247) at org.eclipse.ui.internal.PartService$4.run(PartService.java:109) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.internal.PartService.partDeactivated(PartService.java:107) at org.eclipse.ui.internal.WorkbenchPage$12.run(WorkbenchPage.java:3877) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.internal.WorkbenchPage.firePartDeactivated(WorkbenchPage.java:3875) at org.eclipse.ui.internal.WorkbenchPage.access$16(WorkbenchPage.java:3868) at org.eclipse.ui.internal.WorkbenchPage$E4PartListener.partDeactivated(WorkbenchPage.java:176) at org.eclipse.e4.ui.internal.workbench.PartServiceImpl$3.run(PartServiceImpl.java:205) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.e4.ui.internal.workbench.PartServiceImpl.firePartDeactivated(PartServiceImpl.java:203) at org.eclipse.e4.ui.internal.workbench.PartServiceImpl.setPart(PartServiceImpl.java:159) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at org.eclipse.e4.core.internal.di.MethodRequestor.execute(MethodRequestor.java:56) at org.eclipse.e4.core.internal.contexts.ContextObjectSupplier$ContextInjectionListener.update(ContextObjectSupplier.java:76) at org.eclipse.e4.core.internal.contexts.TrackableComputationExt.update(TrackableComputationExt.java:91) at org.eclipse.e4.core.internal.contexts.EclipseContext.processScheduled(EclipseContext.java:326) at org.eclipse.e4.core.internal.contexts.EclipseContext.set(EclipseContext.java:343) at org.eclipse.e4.core.internal.contexts.EclipseContext.activate(EclipseContext.java:596) at org.eclipse.e4.core.internal.contexts.EclipseContext.activateBranch(EclipseContext.java:601) at org.eclipse.e4.ui.internal.workbench.PartActivationHistory.activate(PartActivationHistory.java:52) at org.eclipse.e4.ui.internal.workbench.PartServiceImpl.activate(PartServiceImpl.java:571) at org.eclipse.e4.ui.internal.workbench.PartServiceImpl.activate(PartServiceImpl.java:530) at org.eclipse.e4.ui.internal.workbench.swt.AbstractPartRenderer.activate(AbstractPartRenderer.java:105) at org.eclipse.e4.ui.workbench.renderers.swt.ContributedPartRenderer$1.handleEvent(ContributedPartRenderer.java:61) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1077) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1058) at org.eclipse.swt.widgets.Shell.setActiveControl(Shell.java:1447) at org.eclipse.swt.widgets.Shell.WM_MOUSEACTIVATE(Shell.java:2328) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4572) at org.eclipse.swt.widgets.Canvas.windowProc(Canvas.java:341) at org.eclipse.swt.widgets.Decorations.windowProc(Decorations.java:1627) at org.eclipse.swt.widgets.Shell.windowProc(Shell.java:2069) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4985) at org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2528) at org.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java:80) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4623) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4985) at org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2528) at org.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java:80) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4623) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4985) at org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2528) at org.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java:80) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4623) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4985) at org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2528) at org.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java:80) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4623) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4985) at org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2528) at org.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java:80) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4623) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4985) at org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2528) at org.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java:80) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4623) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4985) at org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2528) at org.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java:80) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4623) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4985) at org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2528) at org.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java:80) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4623) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4985) at org.eclipse.swt.internal.win32.OS.DefWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.DefWindowProc(OS.java:2528) at org.eclipse.swt.widgets.Scrollable.callWindowProc(Scrollable.java:80) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4623) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4985) at org.eclipse.swt.internal.win32.OS.CallWindowProcW(Native Method) at org.eclipse.swt.internal.win32.OS.CallWindowProc(OS.java:2427) at org.eclipse.swt.widgets.Tree.callWindowProc(Tree.java:1533) at org.eclipse.swt.widgets.Control.windowProc(Control.java:4623) at org.eclipse.swt.widgets.Tree.windowProc(Tree.java:5937) at org.eclipse.swt.widgets.Display.windowProc(Display.java:4985) at org.eclipse.swt.internal.win32.OS.PeekMessageW(Native Method) at org.eclipse.swt.internal.win32.OS.PeekMessage(OS.java:3116) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3749) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:970) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:886) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:90) at org.eclipse.ui.internal.Workbench$3.run(Workbench.java:559)	Cannot reproduce with I20120110-2200 on Windows 7.Same problem for me on Ubuntu 12.04.Any time I open a file, or change tabs.The error is repeated a lot (up to 2 minutes of console scrolling worth) of times per action (see observed actions below) which in turn is causing a delay. It occurs regardless of which perspective is open.Installation details:Eclipse Juno I20120608-1400.Windows 2008 Enterprise SP2 x64Java VM: JDK 1.6.0_14 jvm.dllInstalled software:Eclipse EGIT 2.0.0.201206130900-rEclipse SDK 4.2.0.I20120608-1400Marketplace Client 1.1.1.I20110907-0947PHP Development Tools (PDT) SDK Feature 3.0.0.v201201110400-77-184_2BEICRgM_fMVcz0M4Va9OSubversive Revision Graph (Optional) 1.0.0.I20120601-1700Subversive SVN Connectors 3.0.0.I20120601-1700Subversive SVN Integration for the Mylyn Project (Optional) 1.0.0.I20120601-1700Subversive SVN JDT Ignore Extensions (Optional) 1.0.0.I20120601-1700 Subversive SVN Team Provider 1.0.0.I20120601-1700Subversive SVN Team Provider Localization (Optional) 1.0.0.I20120601-1700Subversive SVN Team Provider Sources 1.0.0.I20120601-1700SVNKit 1.7.4 Implementation (Optional) 3.0.0.I20120601-1700Observed actions:Startupshutdowntab focustab bluropen fileswitch tabAdam, could you please provide one or two stack traces?PWCreatedLog file showing java stack trace.Running eclipse with the -console argument shows the first trace is repeated many many times per action. Only once the trace stops does the action actually get performed.Thanx Adam.Could you please attach your <workspace>/.metadata/.plugins/org.eclipse.e4.workbench/workbench.xmi file?I believe some process installed the WST server and has since uninstalled it, without cleaning up the actionset. Now it will complain about it every time contexts are summed up and set.PWCreatedworkbench.xmi as requestedThank you for looking into this Paul.As requested, \.metadata\.plugins\org.eclipse.e4.workbench\workbench.xmiAdam(In reply to)OK, the root cause is installing something and then uninstalling it. We're not cleaning up the context as we should.Adam, as a workaround you can edit the workbench.xmi file and remove this line:<tags>persp.actionSet:org.eclipse.wst.server.ui.internal.webbrowser.actionSet</tags>If you do that when eclipse is shut down and then start up eclipse again, it shouldn't complain about that tag any more.PW"undefined context org.eclipse.wst.server.ui.internal.webbrowser.actionSet"This problem itself is a bug of PDT.PDT uses org.eclipse.wst.server.ui but it is not being installed when PDT was installed. ()Eclipse 3.x informs the problem when PHP perspective is opened.One time only. No more reports while perspective is opened.Eclipse 4.x outputs the stacktrace anytime, always. Invalid action set is not ignored. This is the problem on e4, I guess.org.eclipse.e4.ui.bindings.internal.ContextSet.CComp.getLevel(Context)...not good...Furthermore, this problem occurs when eclipse starts with PHP perspective. With other perspective such as Resource, there are no exceptions, even when switched to PHP perspective.Steps to reproduce:0. Setup eclipse 4.2 (extract zip, start eclipse, create new workspace)1. Install PHP Development Tools2. Open PHP perspective3. Exit eclipse4. Start eclipsec from command prompt * you can see enormous stacktraces5. Switch to Resource perspective6. Exit eclipse7. Start eclipsec from command prompt * no error8. Switch to PHP perspective * no error9. Close PHP perspective * no error10. Open PHP perspective * no errorMaybe something wrong in startup sequence.The workaround suggested fails for me as the tag is re-added to the xml file upon existing eclipse. Even with the tag removed the issue still occurs.I have confirmed the Toshihiro's observation that it does not occur if eclipse starts with the resource perspective and then switch to php.Adam(In reply to)Changing that file only works if eclipse is already shut down, but that's just the work around. We should emit the message once and disable that actionSet.PWJust faced the same problem using custom plugin with perspectiveExtensions. I don't want to open a separate report, since the root cause is probably the same; but I'll add 2 more scenarios here to make sure that perspectiveExtensions are covered:First, an easy way to reproduce the problem:- create a simple "hello world" plugin, and add with the following: <extension point="org.eclipse.ui.perspectiveExtensions"> <perspectiveExtension targetID="org.eclipse.ui.resourcePerspective"> <actionSet id="not.existing.actionset"/> ... </perspectiveExtension> </extension>- start eclipse, switch to Resource perspective. The single "Unable to find Action Set" error is logged;- close eclipse while the current perspective is Resource perspective;- open eclipse - it starts spamming exceptions to console, and becomes very slow..org.eclipse.core.commands.common.NotDefinedException: Cannot get the parent identifier from an undefined context. not.existing.actionset3 at org.eclipse.core.commands.contexts.Context.getParentId(Context.java:201) at org.eclipse.e4.ui.bindings.internal.ContextSet$CComp.getLevel(ContextSet.java:48) at org.eclipse.e4.ui.bindings.internal.ContextSet$CComp.compare(ContextSet.java:38) at org.eclipse.e4.ui.bindings.internal.ContextSet$CComp.compare(ContextSet.java:1) at java.util.Arrays.mergeSort(Arrays.java:1270) at java.util.Arrays.mergeSort(Arrays.java:1281) at java.util.Arrays.sort(Arrays.java:1210) at java.util.Collections.sort(Collections.java:159) at org.eclipse.e4.ui.bindings.internal.ContextSet.<init>(ContextSet.java:76) at org.eclipse.e4.ui.bindings.internal.BindingTableManager.createContextSet(BindingTableManager.java:90)...- switch back to Java perspective, close eclipse, open eclipse => no spamming. Switch to Resource perspective - a single "Unable to find Action Set" error is logged again.So, the spamming occures when the perspective with unresolved action set is opened on startup.The second scenario is worse.The older version of my plugin was using a perspectiveExtension with actionSet; then I removed the action set itself, and the reference from perspective extension. When the new version of the plugin is installed on top of the old plugin, eclipse starts spamming NotDefinedExceptions.The workaround is to reset the perspective; but it's not really a solution to ask end user to do it.The only thing I can do now is to leave an empty action set with the old id, and only remove the references to action set from perspective extensions.Since the last comment is from 2012, is this behaviour still occurring?	14.0
id=368466	REOPENED	Platform	UI	4.2.1	All All	P3 normal	Platform UI Triaged	2012-01-12 11:30 EST by	Josh Davis	2016-04-20 12:17 EDT (	13 users	CreatedSimple project to reproduce the bugI have attached a sample project to show this bug.In order to reproduce do the following1) Enter text in the text box and press add button, this will add the first button which will have space to display (Unless you set the text of button to a long string, in my tests I used the label of "1")2) Enter some different text in the text box and press add button (this button will not be shown, in my tests I used a label of "2")To force it to render, minimize the part and then restore it. The second button added will be displayed in the part toolbar.This was also mentioned in the follow forum:	I have also found that this issue also exists when removing a tool or menu item. The render is not properly resizing the toolbar or menuThis is almost certainly a layout issue; we're simply not causing the CTabFolder to re-calculate its layout once the toolbar changes its items.Wherever we're calling the TBManager's 'update' we should likely be adding some layout code. At least the TB should be 'packed', we could (maybe already do) listen for size changes to the TB in the Stack renderer (which is the one that 'knows' the TB is should as part of a CTabFolder...Fix pushed to master.Thanks for the bug report, Josh. Sorry it took us a while to get this fixed. Please do not hesitate to let us know if you find other problems with Eclipse.Verified by source code inspection with I20120312-1730.(In reply to)I am trying to test this fix locally and I can't get it to workWhat I did was download eclipse-4.2-I20120314-2200-repositoryand am using those jars in my targetThere are two swt renderer jars in that repository0.10.0.v20120314-17580.10.100.201203160704If I use 0314 the bug is not fixed.If I use 201203160704 I get java.lang.ClassNotFoundException: org.eclipse.e4.ui.internal.workbench.renderers.swt.IUpdateServiceI saw you verified this on 3/13 and it appears the code was moved to the master so I am assumed the fix would be in the 20120314 repo. Is that correct?(In reply to)I unzipped I20120315-1300 and imported your project and it worked for me. Does this work for you?(In reply to)I think problem is I don't know how to properly install the integration build. I am trying to find documentation on how to do it, and will try again.(In reply to)I figured it out and got it working.It worked with 4.2 but is broken again in 4.2.1(In reply to)I'm a little confused. The specific case tested by Josh's sample project seems to work for me in both 4.2.0 and 4.2.1.The case of removing toolbar items as mentioned inseems to be broken in both 4.2.0 and 4.2.1. To test that case I just used Josh's example project and added another button that does the following:mPart.getToolbar().getChildren().remove(mPart.getToolbar().getChildren().get(0));When I do that I don't see the toolbar button go away.Dirk - which case is it that you were referring to?CreatedSmall project for visible state refresh not workingHi Ben,you are right, removing the button doesn't work in both cases. What worked in 4.2.0 is the refresh of the toolbar when changing the visible state of a toolbar item. This doesn't work with 4.2.1 anymore. I added a small project showing that case.@PaulIf you are running the example on Windows, this example should also show. Not sure how it behaves on other OS.is a similar scenario.CreatedSample application with toolbar on non-modal dialogI am seeing the same issue with a toolbar on a non-modal dialog in 4.4.This sample app uses a source provider (provides selection from a list in the dialog) to enable a toolbar contribution.The toolbar contribution on the dialog will not refresh unless the user moves focus over to the main application window.Can also bee seen in the Search view, see.***has been marked as a duplicate of this bug. ***Mass move to 4.7 as M7 is approaching. Please move back in case you are planning to fix it for Neon.	18.0
id=366602	REOPENED	Platform	UI	4.2	PC Linux	P3 normal	Platform UI Triaged	2011-12-13 13:48 EST by	Paul Webster	2014-02-03 11:43 EST (	1 user	IServiceLocatorCreator doesn't work/is not used in Eclipse 4.org.eclipse.ui.tests.services.ContributedServiceTest.testLocalServiceCreated()org.eclipse.ui.tests.services.ContributedServiceTest.testLocalDialogService()	ReleasedPWThis depends on a proper fix forPWDoes this produce functional regressions ?If not then we should likely defer...	3.0
id=379016	REOPENED	Platform	UI	4.2	All All	P3 major	Platform UI Triaged	2012-05-09 12:27 EDT by	Markus Keller	2017-02-17 10:17 EST (	4 users	In 3.8, the System Menu (Alt+-) allowed to move/resize/detach a tab or tab group via keyboard.In 4.2, this menu only contains 'Close' commands.	*** This bug has been marked as a duplicate of***is an umbrella bug of loosely related items that probably won't be fixed for a while.This bug is an important accessibility blocker. Reopening.CreatedImg: accessibile menu for move resize detach in Eclipse 3.7.2This bug is still actual in Eclipse Neon (4.6)Currently, Alt+- (Alt + "Minus") shows only the "Close" command.Note, you'll see the same menu by right-clicking on a tab. See also:To solve this bug, we could:- find the accessible menu providing the "Close" action- add the missing "accessible" commands.The accessible menus are created in StackRenderer#popupateTabMenu(Menu, MPart)AFAICS we can solve just by adding the missing menu items here. Can someone point to the old implementation for 3.8?(This would be good for having a reference)(In reply to Patrik Suzzi from)I'm afraid the main problem is not adding the menu items but implementing them.The best way to see how it worked and how it was implemented in the past is to just launch 3.8.2 and then check out R3_8_maintenance.Launch the Plug-in Menu Spy (Alt+Shift+F2), and then right-click a view or editor tab and choose a command.org.eclipse.ui.internal.presentations.SystemMenuMovePane from org.eclipse.ui.workbench is one of the actions you will find this way.(In reply to Markus Keller from)With the R3_8_maintenance, the available projects are different w.r.t. Latest (Neon), so I'm having issues in launching. I miss a project set with the list of projects needed to launch it. Is there a guide on how to setup the development environment for 3.8.2 ?(In reply to Patrik Suzzi from)Simply run with 3.8.2 and use this as target. Then the only thing you need to check out is the bundle you want to modify.	7.0
id=387881	REOPENED	Platform	IDE	4.2	PC Windows 7	P3 normal	Platform UI Triaged	2012-08-23 05:11 EDT by	Max Max0r	2012-11-05 07:03 EST (	2 users	Teh navigator and an editor tab is opened, both are not maximized. Then I maximize the editor by double-clicking the editor tab. The navigator gets minimized and the editor maximized. When double-clicking again on the editor tab, the navigator stays minimized. In Eclipse 3.7, the navigator was restored which was very nice because you didn't have to do an extra click to restore the navigator.	This usecase works for me (double-click on maximized editor area restores the perspective).Eric, can you give it a try?PWI found out that the file .metadata\.plugins\org.eclipse.e4.workbench\workbench.xmi is causing the problem. Would it help to paste certain parts of that file here?(In reply to)Could you please attach it as a text file?Also, if you open a new workspace and add a project, do you have the same problem?PWCreatedworkbench.xmiI just attached the file.Yes, it also happens when I create a brand-new workspace.Max, perhaps this is a misunderstanding...the only stacks that will auto-restore are the ones that the original maximize caused to move to the trim. If you explicitly minimize a stack then it will *not* restore on an un-maximize. This is by design as it allows clients to have stacks that they can leave permanently in the trim while still having the ability to max / restore in the rest of the environment.Eric, what you say makes sense to me. The problem is that for me, those views which were minimized due to the maximizing of the editor window don't get restored after restoring the beforely maximized editor window. I don't minimize the other views (the navigator for example) manually.I can't reproduce this and haven't seen any other reports about it...Which perspective are you doing this in ? Does max/restore work in any perspective ?It seems to happen in all perspectives. I just tried if in Java, Team Synchronizing and CFEclipse (the last is the one which it happened first in).(In reply to)Is there any additional information I could provide so you can better find out what's going on?Max, Perhaps you could give screen caps of your session:Before you maximizeAfter you maximize (indicate how you did it)After you restore (indicate how you did it)Also, do you get the same behavior using Ctrl-M ?CreatedBefore maximizing the editorCreatedEditor maximizedThe editor is maximized by double-clicking the file's "titlebar"CreatedEditor closedThe editor was closed by clicking the "X" in the editor's title barI added three attachments, see comments for details.Hmmm, the only oddity I see is that the state of the editor area appears to be 'maximized' in your 'before' image (the top/rightmost button shows double 'folders').If you click on that icon what happens ?Also, could you check to see if this issue persists in a fresh window (just do 'Window -> New Window' and try the same thing in the new window.When I click that icon, nothing happens. The icon just turns into a single "folder" icon.When no editor is open and I open a file, there is the double-folder icon. When I maximize the editor then, it turns into a single folder icon. Now, when I close the editor using the X in the title bar, the editor stays in the maximized state and the perspective does not restore (that's what the bug's about). Then, when I restore the perspective by clicking the restore (double-folder) icon in the left (where navigator and search are in), the editor keeps the double-folder icon. Maybe that helps in some way.Interesting: when I open a new window, everything works as expected in that window - closing the editor restores the perspective.Max, I suspect that this is a transient edge condition...that's just a way of saying that we likely missed something when you opened an older workspace with the later version of eclipse.I suspect that the model you were opening contained some sort of bad state (not sure what). If you're happy that using a new window works for you I'll close this defect...any objections ?Yes, I'm happy with it. Thank you :)But don't you, as a developer, want to know what happened here? :)Short answer..yes. Long answer...I don't have time for the long answer...;-).Ideally yes but we have enough on our plate that we just don't have the time necessary...Unfortunatelly I keep facing the problem again from time to time. Openning a new window does fix the issue for some time but I cannot get rid of it :(	21.0
id=396974	REOPENED	Platform	UI	4.1	All All	P3 enhancement	Platform UI Triaged	2012-12-20 03:41 EST by	Marco Descher	2014-02-03 11:41 EST (	2 users	InI posted the question wether it is possible to set a MenuContribution on multiple menus via providing multiple parentIds.After some research I found no evidence that this is possible. If this is really the case then IMHO this is a missing feature.If for example I want to provide the same subset of menuitems within two different menu items (covering e.g. aspects of user-management add/remove/edit) I have to add two MenuContribution items with different parentIds. The ideal case would be to manage only one contribution allowing it to be hooked to n menus.	The pattern for using MenuContributions as they are now is to group your content in one MenuContribution and insert the MMenu with the same id in your 2 locations.It doesn't work between popup and regular menu, however, as those are different schemes.One of the things I'm considering (although I doubt it will be in 4.3) is to allow model fragments to 1) be more dynamic in nature and 2) specify them using XPath. Then specifying specific locations or multiple parent IDs would be possible.PWPaul, thank you, I understand. This however forces me to introduce menus in the original model instead of linking to already existing menu items. I do not understand the approach you mention in 1 or 2, but if you go for a specific way, tell me if i can help!Createdemf xpath integrationPart 1 would be to look at model fragment processing. For the existing model, apply fragments at all locations that match their insertion point. Then for any new additions to the model, be able to evaluate them as well.Part 2 would be to allow insertion points expressed as XPath. See this project set file for the 2 bundles that supply EMF-XPath integration. XPath would be able to specify insertion points more precisely.PWDoes this still stand as an enhancement request (Requiring the MC to have multiple parents)?I'm supposing no but feel free to repoen.For consideration withPW	5.0
id=402055	REOPENED	Platform	UI	4.3	Sun Solaris-GTK	P3 normal	Platform UI Triaged	2013-02-28 14:24 EST by	Grant Gayed	2014-07-09 21:56 EDT (	6 users	- I20130227-2000- observed on Solaris Sparc, Linux PPC64 and AIX PPC32, so probably affects all platformsThe plug-in with SWT's source is missing from Eclipse's plugins directory.	I think gtk.linux.x86_64 is OK:plugins/org.eclipse.swt.gtk.linux.x86_64_3.101.0.v20130225-2231.jarplugins/org.eclipse.swt.gtk.linux.x86_64.source_3.101.0.v20130225-2231.jarPWCreatedpatch to remove excluded swt plugins from source featureThere is a long list of excluded swt plugins from the org.eclipse.e4.rcp feature. And, there was some "churn" last milestone or so about what swt was providing and what they were not, so I think the "excluded" list was based on an "old" understanding of what was out, and what was in (say, 4.2.1 timeframe ... in fact, one "changed" in kepler, gtk.hpux.ia64 is now only one included, and gtk.hpux.ia32 no longer is). In theory, you could just "narrow down" the excluded list, to make it accurate for today, but SWT fixed another pom/module problem and they no longer build the bundles for unsupported platforms, ... so, long term its better to not exclude any, and then should "stay correct" even if SWT later changes their plans ... that is, there would be nothing to coordinate between "low level" pom's, and those up higher in the chain. Here's the current "excluded" list. The patch removes the whole list. = = = = <plugin id="org.eclipse.swt.gtk.linux.s390x"/> <plugin id="org.eclipse.swt.gtk.linux.s390"/> <plugin id="org.eclipse.swt.gtk.solaris.sparc"/> <plugin id="org.eclipse.swt.gtk.solaris.x86"/> <plugin id="org.eclipse.swt.gtk.linux.ppc"/> <plugin id="org.eclipse.swt.gtk.linux.ppc64"/> <plugin id="org.eclipse.swt.cocoa.macosx"/> <plugin id="org.eclipse.swt.cocoa.macosx"/> <plugin id="org.eclipse.swt.gtk.aix.ppc"/> <plugin id="org.eclipse.swt.gtk.aix.ppc64"/> <plugin id="org.eclipse.swt.gtk.hpux.ia64"/>(assigned to you Paul, feel free to move to the component where the code is to be changed if you'd like ... but, pretty sure it'd "your" code either way).Released asPWThis change is causing a build failure on my local test machine. (see below). I don't think the "exclusion" is the cause, per se, but might be hiding the real issue? Is org.eclipse.swt.cocoa.macosx still being "built"? (should it be?) If so, is it missing source? [ERROR] Failed to execute goal org.eclipse.tycho.extras:tycho-source-feature-plugin:0.17.0-SNAPSHOT:source-feature (source-feature) on project org.eclipse.e4.rcp: Could not generate source feature for project MavenProject: org.eclipse.e4.feature:org.eclipse.e4.rcp:1.2.0-SNAPSHOT @ /data/shared/eclipse/builds/4I/master/gitCache/eclipse.platform.releng.aggregator/eclipse.platform.ui/features/org.eclipse.e4.rcp/pom.xml[ERROR] Missing sources for plugins [org.eclipse.swt.cocoa.macosx_0.0.0][ERROR] -> [Help 1]org.apache.maven.lifecycle.LifecycleExecutionException: Failed to execute goal org.eclipse.tycho.extras:tycho-source-feature-plugin:0.17.0-SNAPSHOT:source-feature (source-feature) on project org.eclipse.e4.rcp: Could not generate source feature for project MavenProject: org.eclipse.e4.feature:org.eclipse.e4.rcp:1.2.0-SNAPSHOT @ /data/shared/eclipse/builds/4I/master/gitCache/eclipse.platform.releng.aggregator/eclipse.platform.ui/features/org.eclipse.e4.rcp/pom.xml Missing sources for plugins [org.eclipse.swt.cocoa.macosx_0.0.0] at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:217) at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153) at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145) at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84) at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59) at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183) at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161) at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:320) at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156) at org.apache.maven.cli.MavenCli.execute(MavenCli.java:537) at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196) at org.apache.maven.cli.MavenCli.main(MavenCli.java:141) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:601) at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290) at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230) at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409) at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)Caused by: org.apache.maven.plugin.MojoExecutionException: Could not generate source feature for project MavenProject: org.eclipse.e4.feature:org.eclipse.e4.rcp:1.2.0-SNAPSHOT @ /data/shared/eclipse/builds/4I/master/gitCache/eclipse.platform.releng.aggregator/eclipse.platform.ui/features/org.eclipse.e4.rcp/pom.xmlBogdan, where's the best place to get the list of the current fragments? If they're being built, does that automatically mean they have source plugins?PWJust to cross reference, see also... too much source in "platform binaries" ... something else missing.May I suggest you revert the commit in, until we know more about this? Maybe next time I "guess" at an answer I should run a test build first. Thanks.I've reverted the commitPW***has been marked as a duplicate of this bug. ***The recent CBI activity reminded me of this one. I've confirmed that this jar is still missing on at least PPC64, but from what I remember it was missing from all of the uncommon platforms (platforms != Windows, Linux on Intel, OS X).Createdunexclude except for cocoa.macosxI can successfully build with this patch.The only plugin that seems to have issue is the org.eclipse.swt.cocoa.macosx and I think it has to do with the fact that there are 2 plugins with the same ID. In o.e.swt.binaries the pom file for org.eclipse.swt.cocoa.macosx creates sources for the x86 version but there is no ppc version.I think the org.eclipse.swt.cocoa.macosx problem has to do with this pom [1].Specifically the section: <properties> <os>macosx</os> <ws>cocoa</ws> <arch>x86</arch> <buildid>${buildId}</buildid> </properties>It's creating this bundle only for x86, but the feature [2] wants the source bundles for both x86 and ppc so I think the failure is because it cannot find the ppc version. <plugin id="org.eclipse.swt.cocoa.macosx" os="macosx" ws="cocoa" arch="ppc" download-size="0" install-size="0" version="0.0.0" fragment="true" unpack="false"/> <plugin id="org.eclipse.swt.cocoa.macosx" os="macosx" ws="cocoa" arch="x86" download-size="0" install-size="0" version="0.0.0" fragment="true" unpack="false"/>[1][2](In reply to Thanh Ha from)I think you are right ... especially since the "runtime environments" I see in the parent pom do not include the ppc version. I see only <environment> <os>macosx</os> <ws>cocoa</ws> <arch>x86</arch> </environment> <environment> <os>macosx</os> <ws>cocoa</ws> <arch>x86_64</arch> </environment>	14.0
id=394386	REOPENED	Platform	UI	4.3	All All	P3 normal	Platform UI Triaged	2012-11-15 09:24 EST by	Ed Willink	2016-03-30 15:31 EDT (	13 users	I've just switched from 3.8.1 to 4.2M3 and find that the debug tool bar has moved (very irritating, keep hitting Run app rather than Run to BP).and worse the ordering of Step-Into, Step-Over and Step-Return has been reversed.Is this a deliberate attempt to make e4 unpopular?	No, I guess it's just a reflection of e4's quality...I think the bug introduced in _4.3M3_, because I can't seem to reproduce with M2. Another bizzare detail is that when the IDE is started with a clean workspace, the ordering is correct, only when re-using the workspace ordering is reversed. Also, not only debug actions are affected, I see that "Open Type" and "Search" actions traded places as well.OK, let's move this to Platform UI. The orders must be like in 3.x everywhere.(In reply to)Today (after restarting) the ordering is back to normal.(In reply to)Thanks for the conformation. This seems to be the key. It is a 3.8.1 to 4.3M3 workspace re-use migration problem, possibly aggravated by doing 3.8.1 to 4.3M3 to 3.8.1 to 4.3M3 to check up on strange EGIT behaviours.***has been marked as a duplicate of this bug. ***Is this likely to be addressed in Kepler? I can easily change the ordering of the declaration of actions in the action set, but there is still going to be an inconsistency between when launching with a new workspace or not.(In reply to)I'm really surprised that what seems like a trivial but MAJOR fix has been allowed out unfixed.I'm inclined now to WONTFIX since there will Kepler users who gow used to the changed ordering.Certainly I have been using random ordering (outer/inner Eclipse) for so long now that I frequently have to consult the hover text to tell me which button is which. The icons no longer make any sense to me. If I don't use the hover text I frequently make the wrong selection.(In reply to)I work on two different machines both of wose workspaces ahve been upgraded over many months if not years.One has one order, the other is reversed. No wonder I'm confused/depressed.(In reply to)Reset Perspective... might bring it back in order.Using new workspaces, the order is the same for 3.x and 4.x.CreatedScreenshotSteps in 4.3 (no older release necessary to reproduce, just a restart):- launch new workspace, close Welcome, open Debug perspective => order is correct- File > Restart => order is mangledThe mangling only seems to happen when you restart while the Debug perspective is open.WORKAROUND: Switch to Java perspective before shutting down Eclipse.(In reply to)And if so, the perspective is corrupt forever in its current window, i.e. resetting the perspective does not help. Opening the Debug perspective in a new window fixes the problem.***has been marked as a duplicate of this bug. ***This bug may be related to.Are you really not going to fix this for Luna? It was bad enough this UI being broken in Kepler, but Luna too?Not in Luna, unless it gets fixed as part ofPWWojtek,Please verify if it is still valid. If not, I will remove it from the priority list of Marsthanks,DanielI tested Eclipse 4.4.0, 4.4.1 and 4.5 I20141027-2000.The order of Step Into/Over/Return buttons is now correct and stay correct after restart, but the problem with order of "Search" and "Open Type" buttons still exists.(In reply to Wojciech Sudol from)I tested Eclipse 4.5M3.Markus' repro fromdoesn't seem to be repro any more.I'll keep my eye out to see if it's stable, but I've got used to it being wrong now.Everything is OK now in 4.5 M5 (open type/search order is OK, step in/out too). Closing as fixed, but I have no idea where the fix was actually introduced.Using 4.5 M5a, I still see the problem (only checked Search / Open Type):With a new workspace (or new Java perspective being opened), the order is wrong:Search | Open TypeAfter one restart it becomes correct: Open Type | Search(In reply to Dani Megert from)Dani, which product are you using? Can the problem you still observe (or my own state I've observed) be caused by some 3rd party plugins redefining the toolbar definitions?(In reply to Andrey Loskutov from)That could be. I'm using "our" plain SDK build:CreatedScreenshot on Linux 64 bit gtk SDK build of M5a(In reply to Dani Megert from)Just tried exact this "plain" build out - it works fine out of the box, see attached picture. BTW I'm using 64 bit Linux gtk build and GTK3 on KDE.Any ideas what can be wrong with your build - I guess Windows or Mac?(In reply to Andrey Loskutov from)I don't think so ;-). I assume that you tried with an existing workspace instead of a new one, see.CreatedPicture on Windows 7 and Ubuntu(In reply to Dani Megert from)I've used new workspace and fresh install - everything from scratch.(In reply to Andrey Loskutov from)I also managed to see it correct on one install. I might depend on the Welcome page (Browser widget) and how it is closed (timing issue?). When I add-Dorg.eclipse.swt.browser.DefaultType=mozilla -Dorg.eclipse.swt.browser.XULRunnerPath=/noneit starts to fail again.(In reply to Dani Megert from)Can't reproduce with 4.5.0.N20150325-2000(In reply to Lars Vogel from)Same here using N20150224-2000.(In reply to Dani Megert from)We probably closed it by clicking on the arrow. When I click on the [x] immediately after startup, it is still swapped. This is with eclipse-SDK-N20150416-2000-win32-x86_64.(In reply to Dani Megert from)Using same build N20150413-2000 (different natives of course) on Windows 7 and RHEL 7 I see the issue only on Win 7, and only if I use [x] close button on the welcome view tab to close the welcome view. If I use "restore" button to un-maximize the welcome view, the buttons order is OK. But as said, this is visible only on Windows 7, on RHEL I don't see any "bad" ordering at all.So it seems to be part closing/SWT related - the order/amount of events can depend on the SWT platform code (e.g. extra refreshes or events here and there) after part closing.	31.0
id=394645	REOPENED	Platform	UI	3.8	PC Windows 7	P3 trivial	Platform UI Triaged	2012-11-20 07:33 EST by	Karsten Thoms	2015-01-05 04:38 EST (	2 users	The class KeySequence does not override the hashCode method, but instances of KeySequence are stored e.g. in BindingManager#prefixTable. The distribution in this table is very bad.KeySequence should consider the KeyStrokes for its hashCode. Since the KeyStrokes are fixed with the constructor call it should be considered to store the hashCode as final instance variable. It is not necessary to recompute the hashCode on call of hashCode().	org.eclipse.jface.bindings.TriggerSequence overrides hashCode() and equals(*)PWCorrect, I guess this bug is invalid then.Strange, I came over this when profiling an application, and there I saw bad hash distribution for this class. I thought this was because of missing hashCode implementation, but it is present.Thanks for your analysis.The only other thing to look at is the hash function, which I think came out of a book. It's in org.eclipse.jface.bindings.TriggerSequence.hashCode() and org.eclipse.jface.util.Util.hashCode(Object[])PWCreatedProfiler Screenshot#1CreatedProfiler Screenshot#2I looked again into the profiler results. There might be still an issue, though it is not KeySequence which is causing it, but rather KeyBinding.From the provided screenshots you can see that there are 2 different HashMap$Entry with the same hash code. The KeySequence is in both cases differ 1: [(196608,81);(0,76)] 2: [(196608,81);(0,79)]But the hashCode of the KeyBinding is -1, which I cannot explain by looking at Binding#hashCode(). There I see the same implementation again, which should compute a reasonable hashCode for the Binding. The KeyBindings of both map entries are similar except for their Parametrization.Just a minor thing: I think that Util.hashCode(Object[]) can be replaced by Arrays.hashCode(Object[]).(In reply to Karsten Thoms from)Sorry for bump of really old bug, but I just noticed this too.The high amount of hash collisions might (and I do mean MIGHT) be because TriggerSequence's hashCode (which KeySequence inherits) is NOT thread safe. It is very possible for one thread's computation to "step on" another threads' computation of the hash code if two threads try to compute it at the same time, or all sorts of other weird effects. This might partially explain the high collision rate of them in HashTables. Worse, in some circumstances, it could corrupt the cached hashCode leading to a violation of the hashCode contract (equal objects must have same hashCode).Although I do find the hashing to be a bit suspect, it wouldn't explain the amount of collisions we can sometimes see, plus the hashCode's that seem to make no sense.Thread safety is NOT a concern because all operations are considered to be run on the UI-Thread.	8.0
id=408150	REOPENED	Platform	UI	4.3	Macintosh Mac OS X	P3 normal	Platform UI Triaged	2013-05-15 12:12 EDT by	Radu Toader	2013-06-20 11:10 EDT (	1 user	I'm trying to bind F2 as content assist but, when I press F2 i got tooltip, even I disabled = unbind other commands that were set to F2 from keys(rename,show description).	What exactly did you unbind F2 from? What did you bind it to?I can't reproduce this in 4.3.0.I20130515-2000, when I bind "Show Tooltip Description" in Editing Text from F2 to something else, F2 no longer does anything in Java editors.PWI have eclipse kepler. I will tell you tomorrow the build id.I have macos 10.8.31. Unbind F2. Sort by bindings. Go to F2 and hit unbind command.2. Search content assist. Copy command bind F2.Note: this happens also if you bind directly f2 to content assist without copy command.If I sort by bindings I have 9nly content assist for F2.Eclipse Kepler build id : 20130509-1105Createdbindings pageCreatedwhen hit f2If I go to the Keys pref page and unbind F2 from show tooltip and go back to my editor, F2 does nothing.If I then bind it to content assist (in the editing text context, not In Dialog And Windows) then it works.Do you have a lot of customized keybindings? Can you reset your keys preference page (it wipes out all user bindings)?PWIt works in eclipse kepler RC1 : build ID 20130523-2011'Eclipse DSL TOols'Thanks for the follow up.PWThis bug is still happening in Kepler RC 3 Build id: 20130606-0932I can't reproduce this. You'll have to answer the questionsas well as please attach your exported preferences from File>Export...>General>Preferences.PWFile>Export->Preferences Which ones when I search for preferences I found:General PreferencesOther PreferencesCreatedEclipse key preferences - Build id: 20130606-0932I've tried binding F2 to content assist - Editing text - doesn't workand neighter - Dialogs And Windows..It works fine on linux. I've got ahold of a mac to try it on as well, but F2 effects the brightness of the screen. How do I turn it into a normal key?PWtry FN + F2 /or KeyRemap4MacBookPro	15.0
id=412558	REOPENED	Platform	UI	4.3	PC Windows 7	P3 enhancement	Platform UI Triaged	2013-07-09 02:41 EDT by	Sven Klemm	2013-07-22 10:35 EDT (	0 users	CreatedWorkingSetDialog without the possibility of changing the iconshould do the trick, but it doesn't i can't set an custom specific icon for a working set.	According tothe icon is determined by the type of working set.It has never been able to apply a random icon to a working set.If you would like that, please re-open this as an enhancementPWAh ok, so it would be nice to have it as an enhancement - but not on high priority.It is just nice to have a little more overview over your workspace by having distinct icons.Thanks + RegardsSven	2.0
id=419304	REOPENED	Platform	IDE	4.3.1	PC Windows 7	P3 normal	Platform UI Triaged	2013-10-12 03:57 EDT by	Stefan Cordes	2013-11-04 08:47 EST (	2 users	I tried to get back MRU as described in by settingswt-mru-visible: true; vialike described inbut that does not work with kepler 4.3.1 (either tried the checkbox and the custom css).Steps to reproduce:Open the Java files out of package java.rmi:AccessException.classAlreadyBoundException.classConnectException.classConnectIOException.classMarshalException.classMarshalledObject.classNaming.classNoSuchObjectException.classNotBoundException.classRemote.classRemoteException.classOnly them from Naming are visible (visibility1-Classic.PNG) / (visibility1-Windows7.PNG)Jump back to AccessException using the >>6 dropdown in the toolbar.=> Classic Theme: RemoteException keeps visible (as it was the last used)(Visibility2-Classic.PNG) => That is O.K.!=> Windows 7 Theme: RemoteException is always hidden (independent of Plugin-Settings).(Visibility2-Windows7.PNG) => That is wrong!How do I get back MRU for Window 7 Theme?	CreatedOKCreatedVisibility1-Classic.PNGCreatedVisibility1-Windows7.PNGCreatedVisibility2-Classic.PNGCreatedVisibility2-Windows7.PNGSo you set the MRU CSS attribute and then restarted, right?PWCreatedMake-MRU-Visible-Checkbox.PNGWe don't support the chrome theme, I don't know what it's doing.Please re-open if you can reproduce without that installed.PWCreatedChrome-Theme-CSS.PNGOK, I'm finding it nearly impossible to follow what the usecase is to get to the failure case.What do your Visibility1 represent? Does it "work" in Visibility1 scenario?And you are saying the using the Classic theme allows MRU to work (Visibility2-classic) but manually setting the CSS below fails?.MPartStack { swt-mru-visible: true;}PWVisibility1-Classic.PNG and Visibility2-Classic.PNG shows what happens in case opening some Java-Classes and switching back to the first one when using Windows7-Classic Theme (MRU is working).Visibility1-Windows7.PNG and Visibility2-Windows7.PNG show the same scenario but with the eclipse default Theme (Windows 7 in my case).Additional info for the Plugin:Did use Windows 7 classic theme.I installed Jeeyul's themes 1.7.4 from Eclipse Marketplace(version 1.7.4.201307160945)and then "MRU" checkbox is on by default(Make-MRU-Visible-Checkbox.PNG)Restarted but visibility of Editor Tabs is not MRU (Visibility2-Windows7.PNG)Even when changing the .MPartStack { swt-mru-visible: true;}in the CSS Tab (and restart) (see Chrome-Theme-CSS.PNG)the shown editors are just in alphabetic order and not most recently used.So only workaround is to use Windows-7-Classic Theme.The "NOT_ECLIPSE" Plugin was mentioned as workaround inBut obviously the MRU "Bug" 388476 will be fixed for 4.4 and so nothing to do here.Daniel, on linux in the default theme I tried changing:.MPartStack { font-size: 11; swt-simple: false; swt-mru-visible: false;}into:.MPartStack { font-size: 11; swt-simple: false; swt-mru-visible: true;}And it works (the tabs shown are no longer consecutive).Could you test this on windows7?PW(In reply to Paul Webster from)It seems that the switching of the swt-mru-visible property value works fine on Windows 7 (I got different tab order in the editor area with different property settings). However I'm not sure I understand what the issue is about. What should I see in my Eclipse? Are you able to attach two snapshots with proper and wrong behavior or one with some red arrows pointing the issue?thanks,DanielThats correct,but my intention was to change to MRU order without manipulating files in the eclipse\plugins\org.eclipse.platform_*\css\*installation directory.--------My expected behaviour is: * open more editors than fitting in the panel (">>" appears) (open A,B,C,D,E,F,G => D,E,F,G visible) * select first a non visible editor via ">>" (select A) => actual result: A,B,C,D visible expected result: A,E,F,G visible (as E F G were used later than C D E).Screenshot of actual result: Visibility2-Windows7.PNGScreenshot of expected result: Visibility2-Classic.PNG---------but as mentioned above it probably will be changed for 4.4 with #388476.It seems to be similar to theDaniel(In reply to Stefan Cordes from)We don't edit those files, we use "E4 Orion CSS Preference editor (Incubation)" fromto change the CSS in Preferences>General>Appearance.Even if you use the Chrome plugin, could you check in your install in <INSTALL>/configuration/org.eclipse.e4.ui.css.swt.theme/ Please attach any css files you find in that directory.The above seems to imply that your configuration isn't correctly activated. When I open a bunch of editors one at a time, I get D,E,F,G and if I select A I get A,E,F,GThe functionality should be working, but we can't reproduce on our end. That's why it's different from. The old MRU behaviour should be activated by the CSS I displayed.PWOk. "E4 Orion CSS Preference editor (Incubation)"is working for me, too.But the CSS editor is modifying the file in the eclipse installation (and so for all workspaces): Directory of C:\java2\kepler-4.3.1\eclipse\plugins\org.eclipse.platform_4.3.1.v20130911-1000\css11.09.2013 10:05 1.240 e4_basestyle.css11.09.2013 10:05 950 e4_classic_win7.css11.09.2013 10:05 949 e4_classic_winxp.css11.09.2013 10:05 1.072 e4_default.css11.09.2013 10:05 1.243 e4_default_gtk.css11.09.2013 10:05 1.256 e4_default_mac.css11.09.2013 10:05 1.224 e4_default_mru_on_win7.css17.10.2013 15:37 1.220 e4_default_win7.css11.09.2013 10:05 1.269 e4_default_winxp_blu.css11.09.2013 10:05 1.290 e4_default_winxp_olv.css 10 File(s) 11.713 bytesI expected to have the changes saved in each workspace separately like all other window appearance settings.(In reply to Stefan Cordes from)Oh, we don't recommend changing files in the install, as it can be read-only (or jarred, although obviously not in this case).Our CSS prefs expect to be set per install, not per workspace.That could be opened up at some later date (allow per workspace or per install) but for now it's per install.PW	18.0
id=422674	REOPENED	Platform	UI	4.3.1	PC Mac OS X	P3 enhancement	Platform UI Triaged	2013-11-27 09:57 EST by	Jon Schewe	2017-02-21 08:00 EST (	2 users	I like to use the cmd-e binding to switch between files without using the mouse. Unfortunately I can't seem to get this binding to work in the Git Repositories and Git Staging views. cmd-shift-r works, but not cmd-e. I've seen this behavior on both Mac OS and on Linux.	I can not reproduce this on Linux, Eclipse 4.3.1 and EGit nightly (3.2.0.201311211813).What version of Eclipse and EGit are you using?Eclipse Standard/SDKVersion: Kepler Service Release 1Build id: 20130919-0819EGit: 3.0.3.201309161630-rI'm using the standard release channels.Hm, could you try it with a newly-downloaded Eclipse and a new workspace? I'm not sure what EGit would be doing that causes this to break (and what the difference is between this and Open Resource).I just installed this eclipse in the past month with a new EGit install as well. Is there something newer than what I have available?You could try if updating to EGit nightly fixes the problem (although I don't know why is should be different regarding this), see the download page:Trying with a clean workspace would also be help, because some things are stored in the .metadata folder of the workspace.OK, I just tried it on Linux with an empty workspace and open resource works, but ctrl-e doesn't work. I checked and there's no .log file in my .metadata directory either. I was thinking perhaps there would be some errors listed.Eclipse Java EE IDE for Web Developers.Version: Kepler ReleaseBuild id: 20130614-0229When I look in plugins I see 2 entries for EGit, one is 3.0.0.201306101825-r and one is 3.1.0.201310021548-r.I also notice that ctrl-e doesn't work in the history view either. I tested putting focus on the other views that are typically at the bottom and no ctrl-e there either. Perhaps it's related to the fact that these views are at the bottom by default? I have them moved up with my editors as I want the extra space in these views.(In reply to Jon Schewe from)Ok, so it's not just in EGit's views that the Quick Switch Editor keybinding (Ctrl+E) does not work. I'm reassigning this to Platform UI.Jon, could you attach some screenshots of when this works and when it doesn't? I think that could be helpful in diagnosing this.Createdscreenshot of pluginsSince I opened this ticket I have added the stable update site and updated to 3.1.X of EGit (see the screenshot). Now ctrl-e is working for me in Linux. I don't understand what changed, but it appears to be fine for me on Linux. I guess I'll make sure I have the same version at work on Mac and see if it works there as well.Need some ideas here. It works in my test workspace that was created from scratch. I went back to my other workspace on Linux and ctrl-e didn't work. So I created a new workspace and imported my project and it still doesn't work. Is it possible for something in the project to be messing with the keybindings?Ctrl+E now works from the mentioned views, both under MacOs and in Linux. Closing as worksforme. Please, reopen if you can reproduce.I'm running Eclipse Neon on Linux and ctrl-e still doesn't do anything when I open git staging.	11.0
id=404015	REOPENED	Platform	UI	4.3	PC Windows 7	P3 normal	Platform UI Triaged	2013-03-21 08:08 EDT by	Markus Keller	2014-12-12 06:41 EST (	2 users	I20130319-1000- new workspace- enable Preferences > General > Show heap status- try to move the jobs trim item from the lower-right corner e.g. to the left of the heap status=> depending on where exactly you move the mouse, you see:- wrong drop locations - e.g. green rectangle squashed on the left below the status bar. If you then resize the window, it jumps to the right again.- workbench window changes from active to inactive, thereby showing how broken the part tabs color scheme is ()- missing "rubber dots" (drag handles)- sometimes exceptions:org.eclipse.swt.SWTException: Widget is disposed at org.eclipse.swt.SWT.error(SWT.java:4397) at org.eclipse.swt.SWT.error(SWT.java:4312) at org.eclipse.swt.SWT.error(SWT.java:4283) at org.eclipse.swt.widgets.Widget.error(Widget.java:472) at org.eclipse.swt.widgets.Widget.checkWidget(Widget.java:344) at org.eclipse.swt.widgets.Control.getParent(Control.java:1501) at org.eclipse.e4.ui.workbench.renderers.swt.TrimBarLayout.ctrlFromPoint(TrimBarLayout.java:312) at org.eclipse.e4.ui.workbench.addons.dndaddon.TrimDropAgent.getInsertionElement(TrimDropAgent.java:86) at org.eclipse.e4.ui.workbench.addons.dndaddon.TrimDropAgent.track(TrimDropAgent.java:165) at org.eclipse.e4.ui.workbench.addons.dndaddon.TrimDropAgent.dragEnter(TrimDropAgent.java:135) at org.eclipse.e4.ui.workbench.addons.dndaddon.DragAgent.dragStart(DragAgent.java:104) at org.eclipse.e4.ui.workbench.addons.dndaddon.IBFDragAgent.dragStart(IBFDragAgent.java:74) at org.eclipse.e4.ui.workbench.addons.dndaddon.DnDManager.startDrag(DnDManager.java:227) at org.eclipse.e4.ui.workbench.addons.dndaddon.DnDManager$1.dragDetected(DnDManager.java:88) at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:127) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1057) at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4170) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3759)	Just tried this and it is indeed harder that expected to just move it left of the HeapStatus (a problem with docking after 'stretch' trim controls like the status line ?).The patch proposal has been sent to Gerrit -Danieladded a new API org.eclipse.e4.ui.workbench.IPresentationEngine#DRAGGABLE that's even missing Javadoc.Please remove the API or document it and ask for PMC approval (after API freeze).Daniel, if you want PMC approval to add the API, you'll have to update its javadoc (which is broken at the moment).PW(In reply to Paul Webster from)Fixed with:Daniel(In reply to Daniel Rolka from)The Javadoc comment needs to be improved. "It enables the DND support..." is not enough for a client/developer to understand how this constant would be used. Also, please make sure Javadoc comments end it a dot. +1 for the API addition after M6, assuming the mentioned changes will be addressed for M7.Fixed with:DanielA quick verification shows thatfromis still present in N20140406-2000.(In reply to Dani Megert from)Unfortunately I don't manage to recreate it. It works fine for me. Additionally I've compared the DND support with the Eclipse 3.x and I don't see any serious differences in the DND behaviorCould you please put more details regarding this point of the bug, attach some snapshot if possibleSince currently the DND support in the Eclipse 4.x works fine except of the considered part of the bug, can we extract the issue to the separate bug and close the current one?thanks,Daniel(In reply to Daniel Rolka from)Simply enable the heap status, then drag it outside the workbench window==> window title/border becomes disabled look	10.0
id=424489	REOPENED	Platform	UI	4.3	All All	P3 normal	Platform UI Triaged	2013-12-19 14:28 EST by	Eric Moffatt	2015-06-10 15:35 EDT (	7 users	During a conversation on the Eclipse Forums I came across a possible alternative to Perspectives...seefor some of the details.As I currently understand it the gist is that Christian hates the fact that the minimized stacks 'fly out' *on top* of the existing presentation, in too many instances blocking his view of the editor. This is certainly a problem; a large enough one that I now actively drag the minimized stacks to the right side trim (where they don't obscure the editor nearly as much).In Eclipse 4 we're looking for ways to move beyond the legacy 3.x mechanisms so now's the time to see if we can find alternatives...here's a few possibilities:1) No non-editor stack should be visible unless it contains the active part. When the part is active its stack appears in the presentation, not on top of ir. This pretty well sums up Christian's workflow I think. Downside is that you'll have to use Ctrl-3 or Ctrl-F7 to cause a view to appear.2) A tweak on the above approach that would also hide the other parts in the stack (i.e. whenever a non-editor stack is showing it only has one tab).3) A tweak on 2) that actually *closes* all the views, opens them to show and then closes them again. More costly in performance but keeps memory down.Note that in all of these approaches we'll likely need to provide some way to 'pin' a view so that it remains in the presentation even when it's not active. Note that this is the inverse of the current mechanism which never closes a view once it's been opened.I already have a (mostly) working version of 1) which I'll attach here once it's good enough for public display...;-).	Sorry to say, but I have tried hard for a while now, and still cannot make sense of the description in 1). As I said in the forum: my idea is simply that there be an option to cause all views to immediately go into "restored" mode when activated, rather than appearing in a flyover. I certainly want several stacks to be visible at the same time. And it should continue to be possible to activate a view from within an editor, by, say, choosing the "find references in workspace" item.I agree with Christian that there should be a one-click/one-shortcut way to restore a view to the docked, non-overlay mode (currently it requires two mouse clicks, what is not very comfortable when frequently used). However I am not sure I understand one thing. Christian, in the forum you wrote:What did you mean by "disable fastviews"? As far as I know, the behaviour of minimized views is very similar in 3.x and 4.x. Actually, I don't see any difference from the perspective of the problem you describe. In both, 3.x and 4.x, if an icon of minimized view is clicked, it opens in the flyover mode and automatically hides when loses focus. So the problem applies to 3.x as well. Have I overlooked something? BTW. A limited workaround for the problem is switching an editor between the maximized and regular mode (Ctrl + M) instead of hiding views.in pre-4 eclipse, there was an option under "General->Appearance" where you could choose the "presentation". "Classic Presentation" would change view behavior such that ther was no flyover.In eclipse 4, the option has been renamed to "theme", and only does what the name suggests: change the view aesteticsI think that for the first cut I'll just add a modifier (preference) on the current Min / Max implementation that will change its behavior to restore the stack to the presentation rather than opening it as a 'fly out'. I'll be attaching a patch shortly (once M5 goes out next week)...Wojciech, I'm not sure I understand. You can restore a stack from the minimized state with a single click on the 'restore' button...(In reply to Eric Moffatt from)But it restores the last active view, which is not necessarily the one you want to restore.Anyway I think that adding the modifier is optimal solution.(In reply to Wojciech Sudol from)Yes, thats what I think, tooI've pushed an implementation that changes the default behavior of the MinMaxAddon to Gerrit:If you apply this and run an inner (debug) session then you should see what it looks like when the 'fly outs' are replaced by restoring the stack to the presentation (temporarily)...Try it out and provide feedback....Committed:This adds a menu item on the 'Restore' button of minimized Part Stacks that allows you to toggle between the current mode (Use Overlays) and a new mode that rather than displaying the minimized stack as an overlay restores it (temporarily) to the presentation...Right now this is a 'global' setting so changing it for one stack will affect the behavior of all stacks.I'm putting this in now in order to get feedback during M6...Marking as FIXED...Love this feature, quick views never worked for me but this makes them very usable. Verified with I20140120-2000Lars, for me I can't get the mode to switch; if I bring up the context menu and hit 'Use Overlays' the checkmark stays on and I always get 'fly out' mode...Which system weer you using ?My bad, I changed the string I look for in 'setMimMaxElement' to "MinMaxAddon", I should switch to checking the URI if I'm going to use this string...Should have been an enhancement, but now it's major and has not been tested enough. This commit should be reverted and the bug moved to M6.(In reply to Markus Keller from)See e.g..***has been marked as a duplicate of this bug. ***OK, committedThis fixes both the menu issue and the NPE on the restore...I prefer to put this into M5 in order to get feedback on the new mechanism with a view towards making it the default for Luna. I've spent the last few hours testing various scenarios without seeing anything odd but if you *do* find any other regressions then we'll pull it.I didn't find severe problems any more, just two nits:- Toggling "Use Overlays" doesn't toggle an already-opened fast view.- It's a bit strange that the "Use Overlays" popup menu is only on the "Restore" button. The setting doesn't affect the "Restore" button. It affects the behavior of the hidden parts buttons, and it makes their "Orientation" popup menu choices pointless.Sorry I need to reopen this. There are two issues we need to fix for M5:1. Exit with open fast view in old mode gives NPE (see below)2. Exit with open fast view in new mode and then restart shows the fast view, but the state in the fast view bar is not set. The fast view stays around when clicking into other views.!ENTRY org.eclipse.e4.ui.workbench 4 0 2014-01-23 09:49:58.273!MESSAGE Error disposing widget for : org.eclipse.e4.ui.model.application.ui.menu.impl.ToolControlImpl!STACK 0java.lang.NullPointerException at org.eclipse.e4.ui.workbench.addons.minmax.TrimStack.showStack(TrimStack.java:955) at org.eclipse.e4.ui.workbench.addons.minmax.TrimStack$9.widgetDisposed(TrimStack.java:528) at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:123) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4353) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1061) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1085) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1066) at org.eclipse.swt.widgets.Widget.release(Widget.java:816) at org.eclipse.swt.widgets.Composite.releaseChildren(Composite.java:874) at org.eclipse.swt.widgets.Canvas.releaseChildren(Canvas.java:165) at org.eclipse.swt.widgets.Widget.release(Widget.java:819) at org.eclipse.swt.widgets.Widget.dispose(Widget.java:454) at org.eclipse.e4.ui.workbench.renderers.swt.SWTPartRenderer.disposeWidget(SWTPartRenderer.java:168) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.safeRemoveGui(PartRenderingEngine.java:908) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.access$3(PartRenderingEngine.java:837) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$8.run(PartRenderingEngine.java:832) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.removeGui(PartRenderingEngine.java:817) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.safeRemoveGui(PartRenderingEngine.java:862) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.access$3(PartRenderingEngine.java:837) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$8.run(PartRenderingEngine.java:832) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.removeGui(PartRenderingEngine.java:817) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.safeRemoveGui(PartRenderingEngine.java:887) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.access$3(PartRenderingEngine.java:837) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$8.run(PartRenderingEngine.java:832) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.removeGui(PartRenderingEngine.java:817) at org.eclipse.ui.internal.WorkbenchWindow.hardClose(WorkbenchWindow.java:1824) at org.eclipse.ui.internal.WorkbenchWindow.busyClose(WorkbenchWindow.java:1457) at org.eclipse.ui.internal.WorkbenchWindow.access$15(WorkbenchWindow.java:1424) at org.eclipse.ui.internal.WorkbenchWindow$10.run(WorkbenchWindow.java:1487) at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70) at org.eclipse.ui.internal.WorkbenchWindow.close(WorkbenchWindow.java:1485) at org.eclipse.ui.internal.Workbench$14.run(Workbench.java:1101) at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42) at org.eclipse.ui.internal.Workbench.busyClose(Workbench.java:1084) at org.eclipse.ui.internal.Workbench.access$19(Workbench.java:1029) at org.eclipse.ui.internal.Workbench$19.run(Workbench.java:1332) at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70) at org.eclipse.ui.internal.Workbench.close(Workbench.java:1330) at org.eclipse.ui.internal.Workbench.close(Workbench.java:1303) at org.eclipse.ui.internal.handlers.QuitHandler.execute(QuitHandler.java:36) at org.eclipse.ui.internal.handlers.HandlerProxy.execute(HandlerProxy.java:290) at org.eclipse.ui.internal.handlers.E4HandlerProxy.execute(E4HandlerProxy.java:90) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:601) at org.eclipse.e4.core.internal.di.MethodRequestor.execute(MethodRequestor.java:56) at org.eclipse.e4.core.internal.di.InjectorImpl.invokeUsingClass(InjectorImpl.java:243) at org.eclipse.e4.core.internal.di.InjectorImpl.invoke(InjectorImpl.java:224) at org.eclipse.e4.core.contexts.ContextInjectionFactory.invoke(ContextInjectionFactory.java:132) at org.eclipse.e4.core.commands.internal.HandlerServiceHandler.execute(HandlerServiceHandler.java:163) at org.eclipse.core.commands.Command.executeWithChecks(Command.java:499) at org.eclipse.core.commands.ParameterizedCommand.executeWithChecks(ParameterizedCommand.java:508) at org.eclipse.e4.core.commands.internal.HandlerServiceImpl.executeHandler(HandlerServiceImpl.java:222) at org.eclipse.ui.internal.handlers.LegacyHandlerService.executeCommand(LegacyHandlerService.java:420) at org.eclipse.ui.internal.actions.CommandAction.runWithEvent(CommandAction.java:157) at org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:588) at org.eclipse.jface.action.ActionContributionItem.access$2(ActionContributionItem.java:505) at org.eclipse.jface.action.ActionContributionItem$5.handleEvent(ActionContributionItem.java:415) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4353) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1061) at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4172) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3761) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1122) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1006) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:146) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:612) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:565) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:125) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:109) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:80) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:372) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:226) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:601) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:636) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:591) at org.eclipse.equinox.launcher.Main.run(Main.java:1450) at org.eclipse.equinox.launcher.Main.main(Main.java:1426)OK then, hopefully the last issue here:This changes over to using a new life cycle event to indicate that the application is shutting down. This was necessary because we need to tear down the open stacks *before* we start un-rendering the model.The other fix in UIEvents is to handle the case where the uiElement that's being used *is* the MApplication (and so has no containing context).The rest of the changes are there to 'safe up' the original code by removing the dependence on the trimStackTB as well as better checking in 'setMinMaxElement'...Thanks again for the feedback !(In reply to Eric Moffatt from)Verified in I20140123-1600.sorry for not trying this out earlier. I installed M5 today and tested the new feature. Heres my findings:a) I think the option should really be added to the preferences dialog. Having to right-klick over the restore icon is totally non-intuitive. I had to go back to this bug report after searching for the option for quite a while.b) the feature really doesn't help much in the way of my initial request, because the restored view behaves the same as the flyover - it disappears when I click into the editor area. This only happens when I "implicitly" restore it, e.g. by initiating a search in the editor window while the stack is minimized. The stack gets restored OK, but when I klick into the editor, it disappears again. It only stays open when I restore it by clicking on the restore icon.as it stands, I see no use for this featureto add to my last comment:as now implemented in M5, the minimized stack, after having been restored, can live in 2 modes:- after having been restored implicitly, it will disappear as soon as it loses focus.- after having been restored explicitly, it will remain open until minimized explicitlyI think this is rather confusing. I would suggest keeping the "disappearing" (I'll call it "flyaway") behavior together with flyover mode, and let the restored view behave consistenly by staying open until minimized by the userChristian, I'm confused as to when you expect the view to go away if it's not when the part is no longer active. If a Search causes the Search view to appear when would you expect it to go away ?It should only go away when I explicitly remove it, by clicking on the minimize icon. This is how it behaves after it was restored by clicking the restore button.If a search yields multiple lines of results, I find it totally annoying to have the view disappear whenever I go to the editor to work on one result line. Heres the example scenario I want:- stack with search view minimized- I press Ctrl+F to start a search- the minimized view stack gets restored with the search view activated- I double-click a result line to show it in the editor and work on it- AT THIS POINT THE STACK SHOULD NOT GET MINIMIZED,BUT STAY OPENChristian, I think I get it now...you want 'AUTO_RESTORE' where instead of showing the view's stack temporarily we 'restore' it instead. I'm not sure if I can do this, at least in Luna.BTW, if it helps you can use the down (Ctrl + .) / up (Ctrl + ,) arrows or set the 'Single Click' preference (Window->Preferences->General) with the 'open when using arrow keys option. Both of these will leave the Search view in place until you actually click in the editor...BTW, if you want I can likely show you how to create your own addon that will give you this behavior. Basically you add a listener for part activation, check whether the MPart's stack has the 'MINIMIZED' tag and, if so, remove it.(In reply to Eric Moffatt from)I dont understand what these options do for me. What I want is that the search result view REMAIN OPEN while I investigate the results, even if I decide to go to the editor and, say, change one occurrence. That is how it was in pre-4 (when choosing one specific presentation option), and that is what I requested from the start.As implemented now, my initial request is not adressed at all. The "use Overlays" option is simply cosmetic, the basic behavior is unchanged. I am back to my workaround solution (keep Overlays on, but minimize the Overlay window so it is invisible, and always click the "restore" Button after an operation whose results appear in a view inside the minimized stack). Annoying, indeed. I'll keep bugging my boss to go back to 3.7.I'd be grateful, a little learning never hurts. You can email be at c [dot] sell [at] byterefinery.deI'm going to re-open this for more work in M7. The main issue is that hiding stacks in the presentation when you click (for example) in the editor causes a layout that can mess up the cursor handling.To repro:Turn 'Use Overlays' off, have an editor opengo to the Debug perspective and maximize the editorClick on the Debug view in the minimized stack to move it back to the presentationNow, clicking on the editor will cause the Debug view's stack to go back to the trim *while you're still clicking*, resulting in a random text selection.I think that Christian may have been correct in that once restored a stack should remain visible until explicitly minimized again (or by hitting ESC ?).(In reply to Eric Moffatt from)yesss!! But please, leave out the ESC thing. I think the behavior of all elements should be clearly defined, consistent and straightforward. Why would a restored part that is not visibly distinguishable from any other suddenly respond to certain keys by hiding itself (same argument as against the flyout behavior)? To me this seems totally awkward. ESC is for closing dialogs.(In reply to Eric Moffatt from)Anything pending for M7 or shall we move that to Mars?You will have to fix in RC1 or defer to Mars.PWChristian, if we remove the ESC and other auto-close handling we'd be better off just changing the mode to 'auto-restore' and restore the stack...note that since stacks can now be re-minimized directly and still participate in the 'unzoom' handling there'd be no loss of functionality.Dani, I can do this (make the stack just auto-restore...do you think I should ?(In reply to Eric Moffatt from)Let me think about it and answer tomorrow morning.(In reply to Eric Moffatt from)I cannot make sense of this, as there are too many unknown terms (auto-restore, auto-close, unzoom, re-minimize directly). I haven't gained any functionality, so there's nothing to lose for me. Just do what you have to do, and I'll try to get along..Dani, I'm going to move this out to 4.5 (SR1?) where we'll have some time to get feedback.Basically, having 'auto-restore' (where the stack gets restored to the presentation just as if you hit the 'restore' button) doesn't get us much over the user just restoring the stack when they want.(In reply to Eric Moffatt from)let me throw in here (again) that "the user just restoring the stack when they want" may mean that the user is forced to click twice to express an intention that is obvious from the start. So much for an intelligent IDE.I am working with only one monitor, and would like to keep the stack with console, search view etc. hidden to save space. However, when I search for some string in the editor, I would like the stack to open/activate with the search view focused, AND STAY OPEN even if I move to and fro between search results and editor. I think this is a very natural/obvious requirement, since I have a list of search results. As it is now, I always have to click again to "nail" the stack.Until 3.4 the "auto-restore" (IF that is what I describe) was the default behavior. Until 3.7, this was still configurable, and since 4 this flyout stuff has been forced on us without escape.I agree that auto-restore doesn't buy us anything since one can easily click on the stack's 'Restore' button.At the moment I don't think that I'll use 'Show in original location' because it's something weird in the middle of restore and fly-out/overlay. What I really miss is the functionality referred to as "fast view" where I could minimize a view even if it was inside a stack and then restore that single view individually.I would like to second Christian's request. I have the exact same use-case he does where I would like to maximize the search results to study them and find what I'm looking for. When I double-click the search result I'm interested in I want the editor to restore and stay restored.	37.0
id=427887	REOPENED	Platform	UI	4.4	PC Linux	P3 enhancement	Platform UI Triaged	2014-02-11 07:20 EST by	Mickael Istria	2015-06-11 11:42 EDT (	5 users	Similarly to what's available in JDT package explorer, it would be convenient to be able to sort working sets in the proejct explorer.The working set implementation of Package Explorer could be ported to Project Explorer.	*** This bug has been marked as a duplicate of***This does not seem to be a DUP of. Indeedis about order of projects inside working set, whereas this request is about the order of working sets one related to the other.Related discussion on mailing-list:@Timo: you're the one who mentioned it on the jdt-dev mailing-list. I had a quick look and couldn't find a way to order working sets one with the other from the "Package Explorer" view.Did I understand correctly your message? If so, can you please details how you can achieve that?You have to choose 'Configure working sets' and than use 'up' and 'down' to get the order you want.Ok, I see. It only shows up on Package Explorer when top-level elements are working sets.Suggested patch:The UI is accessible from the "Select Working Sets..." menu of Package Explorer.This contain an API change (addition of a method on public interface). This implementation also change default behaviour so that working sets are by default listed in order of creation, and not in alphabetic order.Since there is a review pending, couldn't this review be planned for 4.5? The issue with letting contribution pending is that they quickly become obsolete and it's not really motivating for contributors to keep on contributing if patches get ignored.(In reply to Mickael Istria from)Of topic, but how can I sort working sets in the JDT package explorer?(In reply to Lars Vogel from)I find it fully inside the topic ;) JDT Package Explorer provides 2 ways AFAIK:* In the view menu of Package Explorer, Configure Working Sets, you see some up/down buttons that allow to sort working sets* By DND in the navigation tree: dropping a working sets just before or after another.My current patch supports the 1st approach. If it gets accepted, I'll provide a patch for the 2nd one.Released to master as:Thanks for patch Mickael,DanielThanks for the review!Mickael, great thanks a bunch. Can you provide a entry for the N&N for M4?(In reply to Lars Vogel from)Yes, the N&N entry would be greatDanielI've pushed to master a small polishing of API, released as:DanielSuggested N&N entry:(In reply to Daniel Rolka from)This causes Javadoc compile warnings in the workspace and in our official build. Didn't you see them in your workspace?Fixed withAs I wrote in thethe change modifies the API behavior that can corrupt clients that use it. It will be safer to add the new API that returns working sets as array sorted by adding order or manual reordering. I will revert the changeDanielReverted with:and with:DanielMickael,Please update the patch with the proper new API for the IWorkingSetManager class and send to Gerrit to review (please assign me as reviewer for it)The feature is interesting for me so I would like to push it in M4Daniel(In reply to Daniel Rolka from)I think we can add the new ArrayList for the AbstractWorkingSetManager class that will keep working sets sorted by adding order/manual reordering (as original patch does), expose it by the new API and use it in the updated version of the patchDanielWhich exact API contract was broken by my previous change? Looking at the code, it doesn't seem to me that explicits how working sets are expected to be sorted.About the test that checks that Working Sets were sorted by name, then it seems to me that it's not an API test, and that it would be better to remove the assertion in the test which is testing more that what's the API is providing.(In reply to Mickael Istria from)The IWorkingSetManager.getWorkingSets() returns the array sorted by the WorkingSetComparator. It is possible that someone bases on it. The additional array for working sets seems to be simple solution and will allow to keep the old API unmodified.Daniel(In reply to Daniel Rolka from)The additional ArrayListDanielWell, I'll try to make another shot to this patch when I have time. But I'm still not convinced that Eclipse Platform has interest in guaranteeing such behaviours if they're not specified by API. The WorkingSetComparator is internat and is an implementation choice, so anyone who relies on internal behaviour and implementation choices instead of API specification and contracts is aware that they're taking the risk of some behavioural change.TLDR;Dani,Could you please advice here?Daniel(In reply to Daniel Rolka from)The bug is that the sorting wasn't mentioned in the Javadoc (Daniel, please fix this). There are 3 rational reasons why the current behavior is the desired one:1. No one sorts in the code/implementation if not desired/needed.2. No one adds a test to verify 1 if not really intended to work like this.3. The current clients don't sort, but in the UI it must be sorted to be usable.For all those reasons we can't change the current API.@Daniel R: before doing anything, I'd like to make sure I understand what you're suggesting/expecting.* Add List manuallySortedWorkingSets to AbstractWorkingSetManager, and keep the workingSets SortedSet (that we could rename workingSetsByName)* Add to the add/remove methods also addition/removal to the list (as well as the set)* Use the manuallySortedWorkingSets as the structure to use for persistence* Do not touch the getWorkingSets method* Create a getManuallySortedWorkingSets method based on the List (that could even return an ImmutableList instead of an Array)?Overall, that's possible, but I really have the feeling that it shouldn't be the responsibility of Platform UI code to deal with issue that bad clients have (ie assuming things about order of working sets when there is nothing recommending to assume that).(In reply to Mickael Istria from)The only bad thing was that it was missed to document in the Javadoc by the developer. Like code, Javadoc can have bugs.We must not add the 'Up'/'Down' buttons to the 'Select Working Set' dialog if the view shows the projects as top-level elements. In that case the user always wants to see the working sets in sorted order, so that he can easily choose. In addition, the order would not be honored by the explorer anyway, and that's good so.I also think the feature to quickly switch back to sorted again is important if you have many working sets. Otherwise you have to manually sort them via 'Up'/'Down'.Maybe we could simply push down JDT's 'ConfigureWorkingSetAction' and 'WorkingSetConfigurationDialog'?I guess moving and reusing the JDT dialogs would be ideal given the goal of this bug (ie make Project Explorer have all good features from JDT Package Explorer).(In reply to Mickael Istria from)OK. Can you create a Gerrit change for that? I'm willing to review when ready.(In reply to Dani Megert from)I'll do it when it gets to the top of my todo-list, but my todo-list contains several higher priority stuff at the moment, so I can't guarantee I'm able to write a patch it time for review and inclusion in M4.(In reply to Mickael Istria from)Sure, np. It's the same on my side.***has been marked as a duplicate of this bug. ***(In reply to Mickael Istria from)I remove the planning for Eclipse 4.5, based on this comment. Once we have again a patch, we can retarget.I just had a look at moving WorkingSetConfigurationDialog and there is a huge WorkingSetModel class in JDT that should be moved together with it.I'm not familiar with this part of JDT. What's in JDT working set mechanism that isn't provided by Platform UI? What do we really need to move to provide same amount of functionality?It seems to me that trying to migrate JDT parts is actually more difficult than just providing the feature in Project Explorer.Another question is where we would like the working set sorting to be stored? In the view memento or in the whole IDE (in the WorkingSetManager) ?(In reply to Mickael Istria from)Manual sorting ;-). Others working set, store and restore state.The view (done by WorkingSetModel). You can have a Project Explorer each windows but sorted differently.	37.0
id=431893	REOPENED	Platform	UI	4.4	PC Linux	P3 major	Platform UI Triaged	2014-04-03 06:50 EDT by	Stephan Herrmann	2016-08-08 12:40 EDT (	6 users	In a customized Java Debug perspective I made a Java search for references, but no result view appeared.Explicit Window > Show View doesn't produce any visible result either.I had one part stack minimized, but the problem persists after restoring it.No indication of anything else being minimized is shown.This seems to affect a certain group of views that would go into the same part stack:- Search- Errors- Tasks- Progress- ...Not affected:- views belonging to the debug perspective, e.g., Expressions- views belonging to another part stack, e.g., NavigatorReset perspective to defaults does fix the issue. Next I'll save my customized perspective and if it happens again, I'll try if resetting to the saved state also helps.	I think I observed the same problem in version 4.5.1 on Windows 7.While working in the Java Debug perspective I wanted to open the Call Hierarchy view.I tried the following without success:- the command Open Call Hierarchy in the Java editor context menu- the keyboard shortcut Ctrl+Alt+H- Window > Show View (the Call Hierarchy view is grayed out)After resetting the perspective I have been able to open the view.*** This bug has been marked as a duplicate of***Re-opening as I'm seeing this bug still in I20151222-0800 (despite the fix for).Comparing versions of workbench.xmi in the broken state vs. good states, I see that the following element is missing in the broken state: <children xsi:type="menu:ToolControl" xmi:id="_b_5N4KzFEeWJePGVwhE9UQ" elementId="org.eclipse.debug.internal.ui.ConsoleFolderView(IDEWindow).(org.eclipse.debug.ui.DebugPerspective)" contributionURI="bundleclass://org.eclipse.e4.ui.workbench.addons.swt/org.eclipse.e4.ui.workbench.addons.minmax.TrimStack"> <tags>TrimStack</tags> <tags>Draggable</tags> </children>Indeed in the debug perspective it's the PartStack "ConsoleFolderView" that contains all the invisible views.I assume, the breakage has happened long ago, but I'd suggest that attempts to show a view in a PartStack with missing TrimStack should re-create the missing stack.BTW, in the same broken state, the Java perspective was unable to show the Outline view. Adding a snippet like the above succeeded in repairing this situation, too.Can we formulate an invariant for consistent state in workbench.xml? It seems that each (hidden?) PartStack should always have a TrimStack associated, right?To fix this I see two options:(1) repairing workbench.xmi when it is definitely broken(2) raise an exception when it is changed in a way that violates an invariant.Not being able to open views is a really bad situation to be in.(In reply to Stephan Herrmann from)I assume that's on 4.6/Neon? The backported fix wasn't committed for 4.5.2 until January 7.(In reply to Stephan Herrmann from)I don't think that's true. The 3.x Workbench code creates a TrimStack to host a minimized stack, but a PartStack could be hidden by 4.x code for arbitrary reasons.Can you attach your workbench.xmi?Createdworkbench.xmi in the bad stateHere's a workbench.xmi that defines two debug perspectives:- one with elementId "org.eclipse.debug.ui.DebugPerspective.Debug Dual", which is broken- one with elementId "org.eclipse.debug.ui.DebugPerspective", which works OKIn the broken "Debug Dual" perspective, the following views cannot be displayed, although the corresponding action (e.g., search) is performed OK (as can be seen by activity in the progress bar):- Search- Call Hierarchy- Task List (mylyn) (I even need to enter credentials for secure storage, which proves that mylyn is already accessing my task repositories, still nothing is shown)- Outline- Error Log- History- Registers (debug)- MonitorView (Object Teams)Except for the mylyn Task List I see all these views mentioned as children of these two part stacks:<children xsi:type="basic:PartStack" xmi:id="_zBa6nXXaEeW4XdW1FOYCzg" elementId="org.eclipse.debug.internal.ui.OutlineFolderView" visible="false" containerData="2500" selectedElement="_zBa6nnXaEeW4XdW1FOYCzg">...<children xsi:type="basic:PartStack" xmi:id="_zBa6oHXaEeW4XdW1FOYCzg" elementId="PartStack@fdab88" visible="false" containerData="2659" selectedElement="_zBa6pXXaEeW4XdW1FOYCzg">...Inside <trimBars>..</trimBars>, OutlineFolderView has a TrimStack for DebugPerspective, but none for "DebugPerspective.Debug Dual".PartStack@fdab88 doesn't have any TrimStack associated to it.HTH(In reply to Brian de Alwis from)I20151222-0800 *is* a Neon build :)Plus I'm not speaking about views remaining blank (like), but remaining completely invisible, not a single pixel indicating their existence.done, although in this particular case it was from a 4.5.1 setup. I'll keep you posted when I see it again on Neon.Createdone more broken workbench.xmiOnce more, now in Build id: I20160317-0200.Trying to look into the Console View but it is nowhere to be found.(In reply to Stephan Herrmann from)I was in perspective "Debug Dual"Seeing the "needinfo" keyword: please specify what info you need!***has been marked as a duplicate of this bug. ***This bug has keyword "needinfo" set.Meanwhile it's the reporters who need additional info: I have no idea what additional info we should supply after having provided a broken workbench.xmi and having analysed in which regard this file is broken.Createdworkbench.xmi for broken viewsThis is a broken workbench for. Not sure, if this is really a duplicate.Is workbench.xmi the only file, that is changed, if I reset perspective is invoked?I found this in my workbench.xmi (Java perspective):############################### <children xsi:type="basic:PartStack" xmi:id="_7GJIVjlbEeaKteDjMjLumA" elementId="PartStack@564b8049" visible="false" containerData="2443" selectedElement="_7GJIVzlbEeaKteDjMjLumA"> <tags>Minimized</tags> <children xsi:type="advanced:Placeholder" xmi:id="_7GJIVzlbEeaKteDjMjLumA" elementId="org.eclipse.ui.views.ContentOutline" ref="_7GJKWzlbEeaKteDjMjLumA"/> </children>###############################Once I removed these lines and restarted Eclipse I was able to restore my Outline view again. I had to show it, drag it and minimize it to a quick view. It remains intact even after an eclipse restart. Somehow these lines keep the view from functioning.Removing 'needinfo' keyword since no question for additional info was asked.	14.0
id=426826	REOPENED	Platform	UI	4.4	PC Mac OS X	P3 normal	Platform UI Triaged	2014-01-28 13:33 EST by	Thomas Schindl	2016-04-20 12:10 EDT (	1 user	restricting to MUIElement is unnecessary give the the backend API called also accepts an MApplicationElement	pushed as gerrit reviewCommitted:This is just Tom's change without the noise...Caused massive failures in the tests.PWReverted withPWTom, what do we lost by not being able to call this with an MApplicationElement ?If the element is an MApplicationElement but not an MUIElement are there any cases where the containing context would be anything other than the MApplicaiton's context ?Yep for a e.g. Handler attached to a Window?Mass move to 4.7 as M7 is approaching. Please move back in case you are planning to fix it for Neon.	7.0
id=433812	REOPENED	Platform	UI	4.4	PC Windows 7	P3 normal	Platform UI Triaged	2014-04-30 02:40 EDT by	Alexander Fichtinger	2014-04-30 10:21 EDT (	3 users	There is no way to remove the System In-Place Editor from the "Open With" menu.Maybe the class EditorRegistry should provide a method to remove the System In-Place Editor from the registry.The reason why we want this is, that the In-Place editor is not working in our application most of the time.See also:	We don't provide "In-Place editor" anywhere in the eclipse SDK.I see Open With>Text editor, System editor, Default editor.You'll have to find out which component contributes In-Place editor.PWHello Paul,sorry, I forgot to mention that the In-Place Editor does only occur on Windows.I think the following part of the method "addSystemEditors()" is responsible for that (in the class "org.eclipse.ui.internal.registry.EditorRegistry"): // there may be a system in-place editor if supported by platform if (ComponentSupport.inPlaceEditorSupported()) { editor = new EditorDescriptor(); editor.setID(IEditorRegistry.SYSTEM_INPLACE_EDITOR_ID); editor.setName(WorkbenchMessages.SystemInPlaceDescription_name); editor.setOpenMode(EditorDescriptor.OPEN_INPLACE); // @issue we need a real icon for this editor? map.put(IEditorRegistry.SYSTEM_INPLACE_EDITOR_ID, editor); }And the method "inPlaceEditorSupported" does the following: public static boolean inPlaceEditorSupported() { // check preference if (PrefUtil.getAPIPreferenceStore().getBoolean(IWorkbenchPreferenceConstants.DISABLE_OPEN_EDITOR_IN_PLACE)) { return false; } // only Win32 is supported return Util.isWindows(); }So maybe you tried it on Mac or Linux?Reopened because I think it IS actually an eclipse problem.Yes, we should re-open and investigate on windows.PW	4.0
id=436322	REOPENED	Platform	UI	3.8	PC Windows 7	P3 normal	Platform UI Triaged	2014-06-02 01:01 EDT by	Manju Mathew	2016-04-20 12:08 EDT (	5 users	Reproducible in Juno SR2 and Luna RC3.The exception stack looked similar to.1. Make sure at least one Java editor is opened. 2. Close All Perspectives3. Click 'Back' button of the Eclipse workbench window.Below IAE is thrown:java.lang.IllegalArgumentException: at org.eclipse.core.runtime.Assert.isLegal(Assert.java:63) at org.eclipse.core.runtime.Assert.isLegal(Assert.java:47) at org.eclipse.e4.ui.internal.workbench.ModelServiceImpl.findElementsRecursive(ModelServiceImpl.java:142) at org.eclipse.e4.ui.internal.workbench.ModelServiceImpl.findElements(ModelServiceImpl.java:309) at org.eclipse.e4.ui.internal.workbench.ModelServiceImpl.findElements(ModelServiceImpl.java:295) at org.eclipse.e4.ui.internal.workbench.PartServiceImpl.addPart(PartServiceImpl.java:889) at org.eclipse.e4.ui.internal.workbench.PartServiceImpl.addPart(PartServiceImpl.java:1085) at org.eclipse.e4.ui.internal.workbench.PartServiceImpl.showPart(PartServiceImpl.java:1109) at org.eclipse.ui.internal.WorkbenchPage.busyOpenEditor(WorkbenchPage.java:3182) at org.eclipse.ui.internal.WorkbenchPage.access$23(WorkbenchPage.java:3104) at org.eclipse.ui.internal.WorkbenchPage$9.run(WorkbenchPage.java:3086) at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70) at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:3081) at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:3045) at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:3035) at org.eclipse.ui.internal.NavigationHistoryEntry.restoreLocation(NavigationHistoryEntry.java:66) at org.eclipse.ui.internal.NavigationHistory.gotoEntry(NavigationHistory.java:464) at org.eclipse.ui.internal.NavigationHistory.shiftEntry(NavigationHistory.java:529) at org.eclipse.ui.internal.NavigationHistory.backward(NavigationHistory.java:513) at org.eclipse.ui.internal.NavigationHistoryAction.run(NavigationHistoryAction.java:251) at org.eclipse.jface.action.Action.runWithEvent(Action.java:519) at org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:595) at org.eclipse.jface.action.ActionContributionItem.access$2(ActionContributionItem.java:511) at org.eclipse.jface.action.ActionContributionItem$6.handleEvent(ActionContributionItem.java:462) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Display.sendEvent(Display.java:4353) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1061) at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4172) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3761) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1151) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1032) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:148) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:636) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:579) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:135) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:382) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:236) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:483) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:648) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:603) at org.eclipse.equinox.launcher.Main.run(Main.java:1465)	This is likely an instance of a more general defect that occurs when trying to open new views when there are no perspectives open, I'll see if I can track down the bug...We should likely make an uber bug covering off scenarios involving 'no perspectives open', there are likely quite a few (then again how many folks work this way?).The problem come from PartServiceImpl.classMethodorg.eclipse.e4.ui.internal.workbench.PartServiceImpl.addPartLinearea = modelService.find("org.eclipse.ui.editorss", container);BTW: We should use IPageLayout.ID_EDITOR_AREA instead of the string1) Open Java perspective2) Open java fileAt this point if you inspect the container variable it will be a PerspectiveStackImpl3) Close the perspective4) Click the back buttonAt this point if you inspect the container variable it will be a TrimmedWindowsImplIf you inspect the model after clicking on the back button, you will find there is no more perspective in the model...so there is no placeholder (IPageLayout.ID_EDITOR_AREA) anymore !Potential solution:Refactor the restoreLocation method and make sure we have the appropriate perspective open before opening the editor. The basic idea is to also store the PerspectiveDescriptor in the class NavigationHistoryEditorInfo and call Workbench.setPerspective before calling openEditor. (I tested and it works)Just want to update my last comment regarding: "BTW: We should use IPageLayout.ID_EDITOR_AREA instead of the string"My mistake, this can't be achieve since the plugin does not have dependencies to the the *.*.*.ide.ui pluginHere is an example of a potential fixI don't know that much the NavigationHistory, so I maybe did a mistake but seems to work as expected for me.The 'Back' button should be disabled.(In reply to Dani Megert from)In Eclipse 3.x the "Back" button is deactivated by NavigationHistoryAction.pageClosed(IWorkbenchPage).In Eclipse 4.x this method is never called because WorkbenchPage.closeAllPerspectives(boolean, boolean) no longer calls WorkbenchPage.close() (which eventually calls NavigationHistoryAction.pageClosed(IWorkbenchPage)).Readding WorkbenchPage.close() to WorkbenchPage.closeAllPerspectives(boolean, boolean) (see) seems to solve the issue, however I am not sure yet if this is correct approach.Even though the WorkbenchPage.close() is no longer called when closing last perspective too, the "Back" button is deactivated correctly in this case.In Eclipse 3.x WorkbenchWindow.firePageClosed() is called every time the last perspective in a window is being closed. In Eclipse 4.x it is called only when closing window. Paul, do you know if this is intentional change (e.g. because of the 'new' sticky folder)?(In reply to Wojciech Sudol from)Moreover, in Eclipse 4.x it is called twice when closing Eclipse by pressing window's 'x' button, and once when closing by "File > Exit". In Eclipse 3.x it is called only once in both cases.I've updated the patch () to fix all mentioned issues.(In reply to Wojciech Sudol from)No, this wasn't intentional.PW(In reply to Wojciech Sudol from)The patch looks reasonable. On thing I didn't notice is where the page closed event is fired now when you close all perspectives. Other than that (and I might have missed it) it looks good.PWHi Paul,Thank you for your comments.(In reply to Paul Webster from)Here is the stack:(In reply to Wojciech Sudol from)Thanks Wojtek, then I think it looks good.PWSubmitted to master withVerified in 4.5 M3 candidate (I20141027-2000).(In reply to Wojciech Sudol from)This fix affects several other issues related to closing all perspectives, e.g.and.Reopened to be backported to 4.4.2. It requires to backporttoo.Review link for R4_4_maintenance:.***has been marked as a duplicate of this bug. ***(In reply to Wojciech Sudol from)For clarity:should be backported too, because it was introduced by fix for this bug.(In reply to Wojciech Sudol from)The original fix (for this bug here) needs more attention. When I just loadthe Help > Welcome menu gets busted:1. close all perspectives2. Help > Welcome==>org.eclipse.core.commands.NotEnabledException: Trying to execute the disabled command org.eclipse.ui.help.quickStartAction at org.eclipse.core.commands.Command.executeWithChecks(Command.java:490)or1. close all perspectives2. open Java perspective3. Help > Welcome is disabledThe additional fix:doesn't fix this.(In reply to Dani Megert from)We already discussed this -.(In reply to Wojciech Sudol from)Actually this particular issue was not discussed earlier. I will continue investigation in.Mass move to 4.7 as M7 is approaching. Please move back in case you are planning to fix it for Neon.	25.0
id=450130	REOPENED	Platform	UI	4.5	PC All	P3 normal	Platform UI Triaged	2014-11-05 09:11 EST by	Wojciech Sudol	2016-04-20 12:17 EDT (	4 users	Scenario:1. Close all perspectives.2. Open Java perspective.3. Open Help view.Expected behavior:Help view opens in a sticky folder (on the right, outside perspective).Current behavior:Help view opens inside the perspective (in the stack at the bottom).Found in Eclipse 4.5 M3 candidate (I20141027-2000).It is caused by a fix for.	The direct reason of the problem is that sticky folder is being removed from model after closing page.Eric, is sticky folder considered to be inside or outside workbench page (from compatibility point of view)? Should sticky folder be accessible when all perspectives are closed? These questions are related to.Interesting question...this is one of the areas where the UI Model doesn't match 3.x. In 3.x the 'stickFolder' is created in *every* perspective and there's a bunch of hacky code to try to keep the content in synch across the perspectives to make it appear as if it was 'global'. In eclipse 4 we decided that the 'stickyFolder' should *really* be outside the perspective. What this means is that in 3.x if you close all the perspectives there's no place to even have a 'stickyFolder' but in 4.x there is.Why does the sticky folder go away ? Since in the model it's not inside any perspective the opened (or not) state of the perspectives shouldn't matter (i.e. the CleanupAddon shouldn't be removing it...). Note that there may be other issues that arise from having an active view with no open perspectives (i.e. I'm not sure whether the commands code has any paths that it thinks *require* an open perspective but I wouldn't be surprised.First we need to know why it goes away (it shouldn't). If we find that views in it have problems if there are no open perspectives then there may be some extra work to 'hide' the stack if there are no open perspectives.The sticky folder is being removed by CleanupAddon, which is triggered by the following code from the WorkbenchPage.close(boolean, boolean) method:In this snippet partService.getParts() returns views from sticky folder. Removing this code solves the issue, however it suggest that the WorkbenchPage.close(boolean, boolean) method is not well adjusted to be called when closing all perspectives (before the fix forit was not called in Eclipse 4.x, but was called in Eclipse 3.x). After some additional tests I will provide the fix.BTW. Is Javadoc for the EModelService.IN_ANY_PERSPECTIVE correct?Currently it is:This suggests that active perspective is not included, which AFAIK is not true. Shouldn't it be:?I consider Window.close doing *anything* about closing views / editors as very suspicious. The only case I can think of is that it *might* be useful to remove non-restorable editors / views from the model. If this code is explicitly there to close the views in the sticky folder I don't think this makes sense.Why the heck does closing a perspective (even the last one) call Window#close ? The window is *not* closing...I agree that taking another look at the fix forto come up with a fix that doesn't call 'close' would be a good approach.As far as the IN_ANY_PERSPECTIVE goes I think that if you check the GIT blame you should see that this doc change was a part of a fix for the 'getElementLocation' call where we decided that the result was a single value as opposed to a bit set of OR'd values. I agree that the name of the flag is misleading, certainly when it's being used as a parameter to the 'find' methods. Could you check to see what the actual meanings the flag has in both the 'getElementLocation' and 'findElements' APIs ? Based on the results we may want to add a new flag (== IN_ANY_PERSPECIVE) called IN_NONACTIVE_PERSPECTIVE (and deprecate the current flag).Eric, I call WorkbenchPage.close() - not WorkbenchWindow.close().I added it because in Eclipse 3.x closing last perspective fires "page closed" notification, whilst in 4.x this notification was missing causing several issues, e.g.:,and.To sum up, the main question is whether IWorkbenchPage.close() (it is API) should close/hide views from outside perspectives (including sticky folder)?Wojciech, got it...IMO no it shouldn't. The concept with a 'page' can in *before* we had perspectives (each perspective *was* a page (which is why there's still code to deal with multiple pages even though we only have one).In 3.x the only place views / editors could exist was within a perspective (within a page) but there's no reason for that logic to be maintained in 4.x. I think the real question is whether closing the 'sticky' views is a desired behavior but IMO it's not necessary.Let me know if you want more info...Fixed in master with.In this change parts located outside perspective are not hidden on closing page.This fix should be updated whenis fixed. Current version contains additional code to workaround the bug.Reopened in order to backport the patch to 4.4.2. It is required by. Review link for R4_4_maintenance:.(In reply to Wojciech Sudol from)For clarity: this bug has been introduced by fix for. Thus,should be backported together with this bug.See.Mass move to 4.7 as M7 is approaching. Please move back in case you are planning to fix it for Neon.	12.0
id=430964	REOPENED	Platform	UI	4.4	PC Windows 7	P3 normal	Platform UI Triaged	2014-03-23 17:55 EDT by	Luke Usherwood	2016-04-20 12:07 EDT (	3 users	When selecting text the keyboard repeat/update rate is slower than other keyboard actions. (My keyboard repeat rate is on maximum in the windows control panel.) * Hold down Shift+Right arrow: (it feels about) half speed * Hold down Right arrow: full speedI've recently updated to Eclipse 4.4M6.(Similar although probably not a duplicate:)	Now that I've thought a bit more about testing this: * Occurs in a Java editor and a plain-text editor * It's a bit sluggish with a click-and-drag across text with the mouse too. * CPU is indeed peeked at 100% of 1 CPUOnce selected, scrolling the screen seems as fluid as ever. So I guess it's doing too much work on that selection change. Next I thought to try Java Visual VM Profiler... Bang! Down goes Eclipse.Okay... then... Java Visual VM Sampler & some manual Thread Dumps?Sampler highlights 'ModelServiceImpl.findElementsRecursive' as a hotspot, and this seems like a typical trace of the busy looking thread (after taking a few):"main" #1 prio=6 os_prio=0 tid=0x02e2cc00 nid=0x1b68 runnable [0x0018e000] java.lang.Thread.State: RUNNABLE at org.eclipse.e4.ui.internal.workbench.ModelServiceImpl.findElementsRecursive(ModelServiceImpl.java:181) at org.eclipse.e4.ui.internal.workbench.ModelServiceImpl.findElementsRecursive(ModelServiceImpl.java:182) at org.eclipse.e4.ui.internal.workbench.ModelServiceImpl.findElementsRecursive(ModelServiceImpl.java:192) at org.eclipse.e4.ui.internal.workbench.ModelServiceImpl.findElements(ModelServiceImpl.java:261) at org.eclipse.e4.ui.internal.workbench.ModelServiceImpl.findElements(ModelServiceImpl.java:249) at org.eclipse.ui.internal.WorkbenchPage.getPerspectiveStack(WorkbenchPage.java:3975) at org.eclipse.ui.internal.WorkbenchPage.getCurrentPerspective(WorkbenchPage.java:4298) at org.eclipse.ui.internal.WorkbenchPage.getHiddenItems(WorkbenchPage.java:5291) at org.eclipse.ui.internal.WorkbenchWindow$3.getVisible(WorkbenchWindow.java:2937) at org.eclipse.jface.action.MenuManager.isChildVisible(MenuManager.java:1036) at org.eclipse.jface.action.MenuManager.isVisible(MenuManager.java:597) at org.eclipse.jface.action.MenuManager.isChildVisible(MenuManager.java:1040) at org.eclipse.jface.action.MenuManager.update(MenuManager.java:802) at org.eclipse.jface.action.MenuManager.update(MenuManager.java:721) at org.eclipse.ui.internal.WorkbenchWindow$8.run(WorkbenchWindow.java:678) at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35) at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:136) - locked <0x80aebd10> (a org.eclipse.swt.widgets.RunnableLock) at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4147) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3764) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1122) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1006) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:147) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:630) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)Note: I'm running Java8-ea-118 (32bit) on Windows x64I cannot reproduce this usingon Windows 7 with Oracle JRE 7.Maybe you've installed some additional bundles that cause this.Please reopen if you can reproduce this with said download and a fresh workspace.OK, I've spent most of Sunday analysing this, mostly as a black box, but I think I've cracked it. There's a general scalability problem in conjunction with hidden junk in my workbench layout.In summary, the full slowness is observed with: * my workspace * the following (minimal) installation: - Eclipse SDK - CDT - m2e - EGitAlthough increased CPU can also be seen in certain other combinations. Some key findings...Installation Workspace % of 1 CPU used (when selecting text)------------ --------- ---------------Original (23 items installed) Original 200%Original Clean 64%Clean Original 16%Clean Clean 16%Note "200% of 1 CPU" actually means 1 CPU running at 100% but taking 2x longer than normal to move the cursor. (Measured by timing how long it takes to scroll down 200 lines holding Shift.)This hinted I should look at software components, so I tried first keeping my own workspace. I worked through each component that had changed version in my M5 -> M6 upgrade, narrowing it eventually to these:4.4 M6 Clean + m2e: 16% -- no change4.4 M6 Clean + EGit: 22% -- tiny increase4.4 M6 Clean + CDT: 120% -- quite a bump in CPU, bad for laptops, but not noticeable in raw speed4.4 M6 Clean + CDT + m2e + EGit: 200% -- ah-ha!The connection with CDT surprised me, since I was testing only with .java files.Next I tried to make a clean workspace start to run badly... I tried putting projects in there with git and maven etc... none of it made any difference. Eventually I reflected back on the call-stack, and this method: "workbench.ModelServiceImpl.findElements"So I presume this is what's being called much more often with this particular set of features. Using JVisualVM's Sampler again I found the lion's share of time was going into, quite specifically, the third level of recursion into this method: ModelServiceImpl.findElementsRecursive "What's that searching?" I thought. Googling the workbench layout failed me, so I dived into the scary folder that is ".metadata" and shortly found org.eclipse.e4.workbench/workbench.xmi. To cut a long story short, the element for the main toolbar... <trimBars xmi:id="_xVM-J73fEeORoocf3zfrVg" elementId="org.eclipse.ui.main.toolbar">...is 7,000 lines long, and a mess! Duplicate <children> almost everywhere. (The 5 buttons of one sub-toolbar were repeated 90 times, for example.)Seems there are a couple of avenues to pursue: 1. What's creating the duplicate entries? Note, unlikeI don't SEE any duplicate buttons. 2. Should Eclipse clean up toolbar duplicates automatically? (It looks like something like this was already attempted in(?)) 3. Even with a clean workspace/toolbar, should the 64% CPU (of one i7-860 core) be investigated (e.g. by the CDT folk?) It seems rather on the high side for text-range updates.CreatedMy workbench.xmi fileAttached my workbench.xmi file ... it seems to be growing each time I restart Eclipse.Thanks for the analysis Luke. It would be great if you could profile the slow scenario and attach profiler outputs to this bug report.The only profiler I'm familiar with is JVisual VM, but when I use its profiler to try and get an instrumented call-hierarchy Eclipse simply goes down. Also I can't seem to save a report from the Sampler in any form that JVisual VM will actually load up again. So I'll just attach some screenshots of its reports.Otherwise, any pointers or links as to how to profile Eclipse?CreatedJVisual VM sampling report (top contribution)CreatedJVisual VM sampling report (second & third contributions)Eric, there seems to be a lot time spent in in findElements*. This is something we should look at. Related to?As a general comment,offers to refactor and optimize the search tree.PWSee alsoPWI'm actually more concerned withwhich indicates that we're rampantly growing the set of menu / tb elements (most of which need to be re-evaluated when the selection changes, leading to many calls to MenuManager.isChildVisible which ultimately searches for the perpective stack (PS).Simply caching the PS in the MenuManager would tell us whether it's really the search or if it's just that we have leaked massive amounts of model elements into the top trim (and the main menu ??).I've just done some tests to compare the state of the top trim on a clean start versus restarts. We're definitely growing by 13 elements per restart. Here's the diff, perhaps we can figure out what's going on:- org.eclipse.e4.ui.model.application.ui.menu.impl.ToolBarImplID: org.eclipse.debug.ui.launchActionSet- org.eclipse.e4.ui.model.application.ui.menu.impl.DirectToolItemImplID: debug- org.eclipse.e4.ui.model.application.ui.menu.impl.DirectToolItemImplID: org.eclipse.debug.internal.ui.actions.DebugDropDownAction- org.eclipse.e4.ui.model.application.ui.menu.impl.DirectToolItemImplID: org.eclipse.debug.internal.ui.actions.RunDropDownAction- org.eclipse.e4.ui.model.application.ui.menu.impl.DirectToolItemImplID: org.eclipse.ui.externaltools.ExternalToolMenuDelegateToolbar+ org.eclipse.e4.ui.model.application.ui.menu.impl.ToolBarImplID: org.eclipse.ui.tutorials.rcp.part3.toolbar+ org.eclipse.e4.ui.model.application.ui.menu.impl.HandledToolItemImplID: org.eclipse.ui.tutorials.rcp.part3.open+ org.eclipse.e4.ui.model.application.ui.menu.impl.HandledToolItemImplID: org.eclipse.ui.tutorials.rcp.part3.openMessage+ org.eclipse.e4.ui.model.application.ui.menu.impl.ToolBarImplID: org.eclipse.debug.ui.launchActionSet+ org.eclipse.e4.ui.model.application.ui.menu.impl.DirectToolItemImplID: debug+ org.eclipse.e4.ui.model.application.ui.menu.impl.DirectToolItemImplID: org.eclipse.debug.internal.ui.actions.DebugDropDownAction+ org.eclipse.e4.ui.model.application.ui.menu.impl.DirectToolItemImplID: org.eclipse.debug.internal.ui.actions.RunDropDownAction+ org.eclipse.e4.ui.model.application.ui.menu.impl.DirectToolItemImplID: org.eclipse.ui.externaltools.ExternalToolMenuDelegateToolbar+ org.eclipse.e4.ui.model.application.ui.menu.impl.DirectToolItemImplID: debug+ org.eclipse.e4.ui.model.application.ui.menu.impl.DirectToolItemImplID: org.eclipse.debug.internal.ui.actions.DebugDropDownAction+ org.eclipse.e4.ui.model.application.ui.menu.impl.DirectToolItemImplID: org.eclipse.debug.internal.ui.actions.RunDropDownAction+ org.eclipse.e4.ui.model.application.ui.menu.impl.DirectToolItemImplID: org.eclipse.ui.externaltools.ExternalToolMenuDelegateToolbar+ org.eclipse.e4.ui.model.application.ui.menu.impl.DirectToolItemImplID: JavaWizards+ org.eclipse.e4.ui.model.application.ui.menu.impl.DirectToolItemImplID: org.eclipse.jdt.ui.actions.OpenProjectWizard+ org.eclipse.e4.ui.model.application.ui.menu.impl.DirectToolItemImplID: org.eclipse.jdt.ui.actions.OpenPackageWizard+ org.eclipse.e4.ui.model.application.ui.menu.impl.DirectToolItemImplID: org.eclipse.jdt.ui.actions.NewTypeDropDown+ org.eclipse.e4.ui.model.application.ui.menu.impl.DirectToolItemImplID: Search+ org.eclipse.e4.ui.model.application.ui.menu.impl.DirectToolItemImplID: openType+ org.eclipse.e4.ui.model.application.ui.menu.impl.DirectToolItemImplID: org.eclipse.search.OpenSearchDialogPage- org.eclipse.e4.ui.model.application.ui.menu.impl.ToolBarImplID: org.eclipse.ui.tutorials.rcp.part3.toolbar- org.eclipse.e4.ui.model.application.ui.menu.impl.HandledToolItemImplID: org.eclipse.ui.tutorials.rcp.part3.open- org.eclipse.e4.ui.model.application.ui.menu.impl.HandledToolItemImplID: org.eclipse.ui.tutorials.rcp.part3.openMessage+ org.eclipse.e4.ui.model.application.ui.menu.impl.DirectToolItemImplID: workingSets+ org.eclipse.e4.ui.model.application.ui.menu.impl.DirectToolItemImplID: org.eclipse.ui.tests.action125011- org.eclipse.e4.ui.model.application.ui.menu.impl.ToolBarImplID: org.eclipse.ui.tests.- org.eclipse.e4.ui.model.application.ui.menu.impl.ToolControlImplID: org.eclipse.ui.tests..control+ org.eclipse.e4.ui.model.application.ui.menu.impl.ToolBarImplID: org.eclipse.ui.tests.+ org.eclipse.e4.ui.model.application.ui.menu.impl.ToolControlImplID: org.eclipse.ui.tests..controlSanity check...adding the + and subtracting the - = 13I've also just timed the WorkbenchPage#getCurrentPerspective() call:Single Call: 9868 (call it 10 uSec)Per Sec: 8619870 (call it 8 million / sec)Note that 'getPerspectiveStack' *does* cache the MPerspectiveStack but this is a *very* recent commit by Brian De Alwis...I think next I'll try my code out on the attached XMI file to see if I can at least get a count of the number of element in it.OK then, there are 2275 items in the top trim of the given XMI...I've saved the file in my WS so we can go over it later...This looks to me like a major regression...Luke, what version of eclipse are you using ?I'm on 4.4M6 32-bit (with quite a few features installed).While I don't recall any particular slowness before I upgraded from 4.4M5 to 4.4M6, I certainly could reproduce it during my investigation on Sunday when I downgraded to 4.4M5 to test. However, my toolbar also looked totally messed up back in 4.4M5 - showing 5 or 6 blank rows. (So I didn't do too much investigation in that version. I figured the data structures might have changed or something which would mean I was testing artificial / unrealistic scenarios.) Anyway, I leave it to you whether that might be a clue.Incidentally, now that I've deleted the main-toolbar section of `workbench.xmi` (and Eclipse recreated it) this resolved a number of other sluggishness/freezes that I'd felt in the UI as well. (Switching views, after saving files, dragging toolbar items...) It makes sense now that I understand what's behind it.I was about to suggest this...;-). I'm not sure how you got the XMI into this state but as I pointed out above we *are* leaking elements into the top trim on every restart (but at 13 a pop it'd be 200 restarts...;-).I'm also wondering whether there may be an issue with CDT reacting to normal vs 'post' selection events. The difference is that the post-selection events are specifically designed not to 'spam' selection changes, allowing things like drag selection or arrow repeats to work smoothly.Dani, do you have any idea whether CDT uses the same pattern to handle selection changes as the JDT does ?(In reply to Eric Moffatt from)No idea. We'd have to check in their source, or ask them.(In reply to Eric Moffatt from)If the leaks were being introduced before 4.4M6, then 200 restarts doesn't sound too crazy for me - I probably average at least one restart a day normally & there were also periods when I was playing with JVM flags & installing features.Dani, does it sound to you as if someone is doing heavy work on a selection listener rather than on a *post* selection Listener ? That's what seemed to cause this in JDT when the workbench was mistakenly sending a post event for every selection change...(In reply to Eric Moffatt from)Yes, that's possible.It was the other way around: JDT listens to post-selection changes and the workbench fired them immediately, seefor details.Moving to 4.6, please move back to 4.5.1 if you think these bugs are important enough to be addressed in the service release.Mass move to 4.7 as M7 is approaching. Please move back in case you are planning to fix it for Neon.	23.0
id=448933	REOPENED	Platform	UI	4.4	PC All	P3 normal	Platform UI Triaged	2014-10-27 05:35 EDT by	Rob Stryker	2016-05-12 05:12 EDT (	8 users	New Internal Browser view may show expired or innacurate content. Steps the replicate:1) Start some local server on your command line, for example JBoss, apache, etc. 2) Open new Internal Browser in eclipse3) Browse to a url in that server, for example,, see content you expect4) Stop the server5) Open new internal browser view6) Browse to same URL7) See expired content (BAD)8) Start a DIFFERENT server or one serving different content at the same URL9) Open new internal browser view, 10) Browse to same url:11) See outdated content This is the method to replicate wtihout any API use, just user actions. If the user then clicks the 'go' button, it will refresh the browser and load the newest content available. However, on the API level, as far as I can tell, there's no way for me to call refresh on this browser object. My code path is as follows: public static void openBrowser(URL url) { try { IWorkbenchBrowserSupport browserSupport = JBossServerUIPlugin.getDefault().getWorkbench().getBrowserSupport(); IWebBrowser browser = browserSupport.createBrowser(IWorkbenchBrowserSupport.LOCATION_BAR | IWorkbenchBrowserSupport.NAVIGATION_BAR, null, null, null); browser.openURL(url); } catch (Exception e) { JBossServerUIPlugin.getDefault().getLog().log( new Status(IStatus.ERROR, JBossServerUIPlugin.PLUGIN_ID, "Unable to open web browser", e)); //$NON-NLS-1$ } }I could workaround this issue if I had a way to guarantee a refresh after opening the browser, but looking at the API, this doesn't seem possible. The IWebBrowser interface has no ability to refresh. The IWorkbenchBrowserSupport also lacks anything useful here. There are two primary widgets in charge of displaying the browser from what I can tell: WebBrowserView and WebBrowserEditor. WebBrowserView DOES have a setURL(String url) method, but WebBrowserEditor does not. The above API migrates into the editor, so I can't even work around this by finding the editor part and forcing a refresh.	Moved to SWT for preliminary investigationDanielA user discovered this bug on Linux and our team was able to reproduce it on OS X, so it does not seem to be isolated.Anyone have any ideas here?The issue will happen if there are two browser widgets with the same url within an Eclipse session.In this case, browser.setURL(...) doesn't update its contents. I have tested webkit, mozilla and ie browser. They all behave in the same way.The following is a patch to fix the issue -Moving to UI as the above suggested fix is in UI.I've verified the patch works as intended. It ensures that any new browser editor will be refreshed at least once. This effectively clears the cache. The primary concern I have with the patch is that if a new (unique) URL is used to open the browser, it is being force-refreshed a second time, effectively two fetches for any initial browser editor with a unique url. This somehow seems inefficient to me, and I wonder if there exists a way to check if the underlying browser implementation is using a cached resposne or not. If no such way exists, then I'd imagine this is the best we can do.Anyone able to either approve or reject Snjezana's patch here? As much as I see inefficiency in the patch, I think it's much better to accept the patch for now with a comment referencing this bug than allowing the bug to persist.Hi:I humbly request this bugzilla with an attached patch be reviewed in a reasonable amount of time, to encourage more contributions from stakeholders in the extended eclipse community.(In reply to Rob Stryker from)To speed up the review process I typically advice to help with the review in Gerrit. For example this patch had several formal issues which you could have help to spot.New Gerrit change created:I've tried to fix the issues on Snjezana's patch but was having issues trying to get gerrit to do what I wanted (add the fixes to her change), so I made a new change with the whitespace removed since Snjezana is unavailable for a short while. Hopefully we can see some progress on the issue now.I'm trying this on 4.5 and I'm not seeing the issue. I'm using a simple Python-based HTTP server [1] and I see explicit requests coming through on load.Rob, could you clarify: in steps 5 and 9 are you closing the Internal Web View and then opening it again?I'm on OS X 10.10, but I should see this problem from.Is it possible that you're seeing a web caching issue (e.g., etag or otherwise)? Could you check the HTTP headers?[1](In reply to Brian de Alwis from)Hi Brian:When using only the browser view, you will need to close it and open it again. Then paste the URL in. If you paste the same URL into the same instance of the view a second time in a row without closing it in between, it will treat this as a refresh, and the bug will not manifest any longer (until you start your server again and repeat the cycle). So the primary use case is: 1) Run local server 2) Open browser view, Browse to3) Stop server 4) Close browser view 5) Open browser view 6) Browse to7) Still see the contentNow, an additional use case is that we can still see the bug if I load in one view a second time, so long as there was a different url loaded in the middle. As follows: 1) Run local server 2) Open browser view, Browse to3) Stop server 4) In same existing browser, browse to www.eclipse.org 5) After content is loaded, in same browser view, browse to6) Still see content 7) In same existing browser, browse to www.google.com 8) After content is loaded, in same browser view, browse to9) Still see contentThis will stop the moment you try to go to the local url twice in a row. It will treat this as an actual refresh, and will actually send a request to the server (which is stopped)It also tends to stop after about 3 or 4 times repeating that action. The bug we're most interested in solving (for our usecase) is when it's a new browser view / editor. We actually make use of browser editors in our code more often than the view itself, but the bug is present in both. I can replicate this every time with basically any web server at all, though my internal browser is limited to Webkit. Snjezana seems to have done more extensive tests and come up with the same results.I'm not terribly familiar with etag, but a quick google on it seems to indicate the server should still be up and running, right? Well in all my tests the server is stopped completely. Nothing is responding at the url, so it's quite clear to me no requests are being made. I tried playing around with wireshark as well and saw no traffic, neither a request nor a response. So it's clear to me no request is being made at all. The internal / native implementations are simply pulling from their local cache. So i really doubt it's any etag caching, and this caching is purely on the client side / eclipse / webkit / etc.I cannot reproduce with testing on OS X 10.10 with Eclipse 4.5 I20150224-0800. Note that I'm testing with http-based file fetches, and not a webapp.(In reply to Rob Stryker from)This doesn't happen to me: I get an error dialog saying "Page load failed with error: Could not connect to the server."I get an error dialog with "Page load failed with error: Could not connect to the server."Rob, I tried your two test cases on a VM running Windows 7 and Eclipse 4.5 I20150305-1200 and I can reproduce the second testcase:But this seems to be an IE bug, not an Eclipse bug as I can reproduce it in IE (IE 8 in my case) with the same steps. In fact, I can't get IE to show an error page! If I open the IE Dev Tools and cause it to clear the browser cache, then I get the error page I was expecting (both in IE and the Eclipse browser view).If I set in IE: Internet Options > General > Browsing History > Settings > Check for newer versions of stored pages > Ever time I visit the pagethen I never see cached content.I'll mark this as NOT_ECLIPSE, but please re-open if the above doesn't fix your problem.Credit:The above does not fix my issue, since I'm on linux and do not have IE as my internal browser. The fact is, there's a lot of caching going on in ALL of the underlying browser implementations for the internal browser. Users would be hard-pressed to know just by looking at the BrowserView what internal browser is being used, or where they should change these options. Snjezana was able to replicate on " webkit, mozilla and ie browser". You can say this isn't eclipse, but the fact is users of WTP (and the associated adopter products) are finding this very confusing. They will "Run as -> Run on Server" an html file or servlet multiple times and get the same result even when the result should be requeried from the server. They will not know how to change the caching details for WebKit, for example. I certainly have no idea how to disable the internal caching on eclipse's internal browser when it's using webkit. Do you? Snjezana's bug may cause a very slight performance difference when opening an internal browser. It will make a first request and basically immediately force a second request, thus forcing an *actual* request to the underlying browser implementation and then to the server. You can say this bug "isn't eclipse", but our users feel very strongly that it is a bug in our tooling when multiple browser editors open with the same content; and we feel very strongly that this is a bug in how eclipse deals with internal browser implementations that aggressively cache. If there was only one internal browser implementation, I may agree with your workaround... but there aren't. There are several, not all have workarounds, and it is very difficult for a user to discover which internal browser implementation is being used or how to workaround them. And, as I mentioned above, I could maybe accept that this is an underlying bug, if eclipse.ui exposed API to force a refresh, but your browser view / browser editor expose no such API. See my comments from:I could workaround this issue if I had a way to guarantee a refresh after opening the browser, but looking at the API, this doesn't seem possible. The IWebBrowser interface has no ability to refresh. The IWorkbenchBrowserSupport also lacks anything useful here. This is a bug, and an API deficiency. Adopters can not do what they need (open a web browser and force an actual request to the server to occur).I would like to note that BrowserViewer has the following code: /** * */ private boolean navigate(String url) { Trace.trace(Trace.FINER, "Navigate: " + url); //$NON-NLS-1$ if (url != null && url.equals(getURL())) { refresh(); return true; } if (browser!=null) return browser.setUrl(url, null, new String[] {"Cache-Control: no-cache"}); //$NON-NLS-1$ return text.setUrl(url); }You can see it's setting cache-control: no-cache. Tracing forward, it goes into org.eclipse.swt.browser.WebKit, and yet it still returns out-of-date material, even with those headers. It's possible this is a bug in WebKit, and thus technically "not eclipse". However, if an underlying library your implementation depends on has a bug, it is your responsibility to work around it and make sure the user gets what they expect as a result. In this case, it would seem WebKit is ignoring the Cache-Control directive. I would expect you to either work around it in the org.eclipse.swt.browser.WebKit class, to force a refresh, or to work around it at a higher level (as Snjezana's patch does) to ensure it works the same for all implementations until all underlying deps can be confirmed as behaving correctly.I understand how this behaviour must be annoying for your users. My office mate insists on hammering his F5 after every change in the vain hope that his Firefox instance won't cache some stale data.Snjezana's patch might be ok if a refresh was idempotent. But we can't guarantee that a second refresh won't trigger some action. Since this bug is not universal across browsers implementations, we'd just be opening ourselves up to a new set of bugs ("[browser] Opening new browser does a double refresh and caused data loss").This bug cannot be solved within the Platform UI components. More importantly, we don't have the information to determine whether a refresh should be done. I'll re-assign to SWT to see if they can work around the caching problems on a per-browser implementation basis. But as you found in the cache-control code above, they seem to have already done what they can.An aside: IWebBrowser and IWebBrowserSupport provide a lowest-common-denominator interface for opening content in either an internal browser or an external browser. There's no refresh() as we cannot trigger a refresh on an external browser. Besides, these interfaces not used by the Internal Web Browser view and the Web Browser editor, which use the SWT Browser instance directly.Yes, I see that. Unfortunately, the BrowserView and BrowserEditor do not expose API such as 'refresh'. Can you suggest any series of API I could perform such that I can 1) Open an internal browserview or browsereditor, and 2) refresh it? Our current code path is: IWorkbenchBrowserSupport browserSupport = workbench.getBrowserSupport(); IWebBrowser browser = browserSupport.createBrowser(IWorkbenchBrowserSupport.LOCATION_BAR | IWorkbenchBrowserSupport.NAVIGATION_BAR, null, null, null); browser.openURL(url);sounds like we should at platform UI level default to use external browser then ?Since the embedded browser in eclipse will not reload content even when explicitly asked to open content ?[I wrote this before the above comments came in.]Some additional thoughts: since this is behaviour primarily of importance in developing (JBoss) webapps, perhaps you could introduce some server-side debugging support to workaround the stale caching issue.The simplest might be appending "&__jb__timestamp__=timestamp" to the URL? Or incorporate live-reload.js style support to trigger browser refreshes?In looking at the WebKit caching options (more on that below), I saw a note in the WebKit blog about pages with unload handlers (): "Since the unload event’s purpose is to allow “important work when a page is closed,” all major browsers refuse to put such pages in their Page Cache, causing a direct negative impact on the user experience."That same article notes that https pages aren't cached. I'm not sure that's still true, and I'm not sure how our internal browsers handle self-signed certs.One possible strategy on the Eclipse side might be to provide a pref page to tune settings on the underlying embedded web browser. It seems WebKit offers a few cache tuning parameters:(In reply to Max Rydahl Andersen from)External browsers have the same problem: this isn't an issue unique to the embedded browser. Heck, Wikipedia even has an entire page devoted to instructions:none of this is specific to jboss and no, we do not want to mutate/change the users app - just like you don't want to risk triggering two unnecessary reloads.In external browser it reloads the page just fine on most OS's or it opens a new tab.The problem is that for the built-in web browser there is no api to do a "force refresh" - it just defaults to use the cache even though we are explicitly asking for open the page again.Perhaps it would be prudent to add an eclipse setting / preference page for the internal browser that exposes a similar 'bypass your cache' option at the eclipse level. The 'navigate' method (as shown above) will already do a refresh if it thinks it's loading the same url for a second time. Perhaps with such a setting, we could rewrite the navigate as follows: private boolean navigate(String url) { Trace.trace(Trace.FINER, "Navigate: " + url); //$NON-NLS-1$- if (url != null && url.equals(getURL())) {+ boolean forceRefresh = // pull from setting somewhere+ if (url != null && (forceRefresh || url.equals(getURL()))) { refresh(); return true; } if (browser!=null) return browser.setUrl(url, null, new String[] {"Cache-Control: no-cache"}); //$NON-NLS-1$ return text.setUrl(url); }This setting could be added to / exposed via WebBrowserPreferencePageI would also expect someone on the eclipse browser team to open a bug with WebKit on this issue to see why it's not respecting the Cache-Control: no-cache flag you pass in, and find out whether its an error in eclipse's WebKit class (ie, how you're setting it or the methods you're calling) or an error in the deeper library (ie, library not respecting it).Ok nevermind, it seems that idea is dumb. Ignore the above pseudo-code. However my point is the same. You're passing in the no-cache flag. If you intend to pass off eclipse's internal browser as useful and complete, then you need to (occasionally) track down bugs in libraries you use. It's possible WebKit may have a bug, or WebKit will tell you you're using the jni functions incorrectly.From the discussion I think the problem is related to browser caching.I think this requires some more discussion on how to tackle the the caching problem.Since it is late in the cycle for M6 retargetting it for M7.Unfortunately, nobody from the SWT team was able to spend time on this bug during M7 as well and frankly, I've no idea what exactly needs to be done by SWT at this point of time...Alex, do you think using webkit2 could help here?Rob, if possible, please verify whether using the webkit2 port of SWT's browser implementation helps - make sure you have the webkit2 libraries installed and run eclipse with the environment variable SWT_WEBKIT2=1. The webkit2 port is not complete yet but is probably still worth a try.Not sure about it. I'll wait for Rob's testing on this first.The issue can also be reproduced on Windows and Mac. See.(In reply to Snjezana Peco from)Thanks Snjezana, I've updated the bug to reflect the same.If the same problem is seen with all the underlying browser renderers, it would probably be a good idea to create a workaround for the bug within the UI code itself (which is what was initially proposed in Snjezana's patch as well).In any case, its increasingly unlikely that we're going to find a proper fix for this bug now in the Mars release, and so I'm deferring it to 4.6.Looking at the org.eclipse.swt.browser.WebKit source, I see that there's a method webView_resource_willSendRequest_redirectResponse_fromDataSource() that creates a new NSMutableURLRequest and calls newRequest.setCachePolicy (OS.NSURLRequestReloadIgnoringLocalCacheData);One possible approach to solving this issue could be have the browser implementations act upon the request headers passed in via setUrl() as per Rob's example in. So 'Cache-Control: no-cache' would call setCachePolicy() as above in WebKit.Since the patches are in UI and assigned to UI I am setting the component to UI	33.0
id=438115	REOPENED	Platform	UI	4.3.1	PC Windows 7	P3 normal	Platform UI Triaged	2014-06-25 02:13 EDT by	sudhan p	2014-07-23 06:08 EDT (	1 user	Createdproduct contribution porjectWhen using a custom product configuration, the handles which allow users to drag and drop toolbar items disappear. A number of arbitrary spaces appear too- see attached customProduct.png. When launched with standard eclipse application, the spaces disappear and the handles are present- see attachedeclipseApplicationWithDraggableSeparators.png. The zip contains the custom product- it is a bare-bones product configuration.	Createdcustom Product- no handles, highlighted spacesCreatedstandard eclipse Application With Draggable SeparatorsWhen this happens are their any errors in your error log?PW(In reply to Paul Webster from)no- the error log is clean.Adding this property to the product extension in plugin.xml seems to fix this issue:<property name="applicationCSSResources" value="platform:/plugin/org.eclipse.platform/images/"></property>My question is if this is a valid fix and if it is, why does it work? I tried debugging by putting a conditional breakpoint in Product.getProperty() to halt when the key is applicationCSSResources but the brekpoint was never reached. Could someone please explain how this property is consumed?(In reply to sudhan p from)Yes, it is valid fix for now since we don't support the absolute paths for images in the CSS files yet. We have thestill not resolvedDanielSorry, I closed the bug, but I think we should keep it opened until we fix theDaniel	7.0
id=206299	REOPENED	Platform	UI	3.5	All All	P3 normal	Patrik Suzzi	2007-10-15 05:50 EDT by	gapon	2016-09-24 13:33 EDT (	20 users	Build ID: M20070921-1145Steps To Reproduce:1. open 2 files in editor2. try to switch tabs using CTRL + TAB3.More information:I mean that CTRL + TAB is "standard" shortcut - try firefox, opera, netbeans etc.	Hmmm... Cntrl-tab gives us accessibility so we can move between control groups, one of which is actually the editor tabs (another is the toolbar). Once highlighted, you can move back and forth between the tabs using arrow keys.I agree that consistency with web browsers is valuable, just commenting that we're currently using cntrl-tab for something larger.Tod any thoughts?Ctrl-Tab is the standard up level tabbing in most OS's. If we break how tabs work to be consistent with a different paradigm (web browsers) we will be breaking OS behaviour which we try hard to avoid.If the platforms we run on switch to this behaviour so should we.***has been marked as a duplicate of this bug. ***Tod, put yourself in a User point of view.I'm NOT ABLE to set the shortcut in Eclipse to cycle through tabs using CTRL Tab and CTRL SHIFT TAb.Eclipse should AT LEAST offer the possibility to set it up. Users don't care about OS Paradigm. We just want to be able to reproduce the feature that exists in browsers because it is EFFICIENT.You should provide a solution even if it's not built in. This is a MAJOR flaw of the IDE. Visual Studio offers it built-in and users LOVE it because it's efficient.Something we should consider in er/4.1PWWould be nice to have this along with.(In reply to)This is a problem on two levels.First Ctrl+Tab cycles between tab groups in Swing and is a common metaphor for switching to the next tab in all of the main browsers. I don't see any obvious way around this!However the key problem (pun intended) is that there are several ways to navigate between editors and the most common requirement of simply Next Editor/Previous Editor which DO have keyboard shortcuts of Ctrl+PgDown and Ctrl+PgUp respectively are not listed in the Keys preferences (or at least I could not find it).So when people search for the key combo to switch editors in Keys prefs they only find the option to show a popup list of editors and choose which to switch to which is Ctrl+F6.Surely the solution would be to add Next Editor/Previous Editor to the Keys prefs with Ctrl+PgDown and Ctrl+PgUp and then rename the other option to say Switch Editor which more accurately describes its function.Can any developer fix this please?The main problem is the cycle through tabs:It should go to the next tab (the tab on the right) or the previous (the tab onthe left), like in Firefox,Chrome,etc.. and what it really does is just prompta tab list and by default it points to the last tab you visualized.For example, if we have these tabs:[A][B][C][D]And I press the Next Editor shortcut, eclipse should go to tab [B], and if Ipress it again go to [C].. if then I press the Previous Editor shortcut, itshould go to [B], etc...Many thanks, this bug makes me crazy and will save me lots of time indevelopment if it gets fixed.(In reply to)This is being worked on in 4.1PWActually the control tab should work as in Netbeans - switch to the *most recently used Tab*, ie keep a stack of tabs and pop the previously visited tab. Cycling through tabs is quite inadequate - as one usually selects one tab with the mouse then wants to jump back to the previous tab - or back and forth - quickly via control tab. For people who want to cycle through tabs (for reasons unknown, but time will tell) there should be the option to do so (as in Notepad++ IIRC).Those being said I am quite amazed that eclipse does not support control tab in the editor - it is incredible reallyBottom line is that this worked in 3.7 and still works in 3.8, but not in 4.x.There are other built-in shortcuts (e.g. "Toggle Breakpoint" , which I want to reassign to F9) that the Keys preferences dialog will allow you to reassign, but when you come to use them the functionality does not work as expected (the toggle breakpoint pops up a tooltip select list to select either "Rebuild Last Target" or "Toggle Breakpoint").This behaviour is surprising, disappointing and a change from the existing previous behaviour.I concur with Palmer Eldritch on the point that the desired behavior of Ctrl+TAB is "cycle through tabs in the most-recent-first order." All other things equal, and even disregarding the well-established paradigms, I believe this is optimal for productivity, although I know of no user studies to back up the claim.I still think this should be the default as most IDEs, text editors, terminals, browsers and other software have the ctrl-tab/ctrl-shift-tab behavior to switch between next/previous tabs by default.I know it's not a reliable source, but ihateeclipse.com has a very high rage score on this feature not being the default behaviour...The behaviour is already in place. - use CTRL+PageUp and CTRL+PageDown to switch between tabs (non circular)- and use ALT+PageUp and ALT+PageDown to switch between sub tabsSo, the question now: can we agree on changing KeyBingdings ?(In reply to Patrik Suzzi from)Is CTRL+Tab currently used in the Eclipse IDE?(In reply to Lars Vogel from)Currently not used AND I have mapped it to "Next Editor" command AND it works since years flawlessly on Win/Lin in the same way as it does in Opera/Firefox/you name it.So personally I would just replace Ctl+F6 with Ctrl+Tab binding but I guess Mac is as usually special with this shortcuts.(In reply to Andrey Loskutov from)Brian, can you comment for Mac?To test the behavior, open from menu: Windows > Preferences > Keys Then search "Next Tab" and "Previous Tab", and assign the CTRL+TAB and CTRL+SHIFT+TAB bindings (When: In dialogs and Windows). With Neon under Win10 work fine, until Eclipse restart (<-a conflict?). The related commands ids are org.eclipse.ui.navigate.nextTab and org.eclipse.ui.navigate.previousTab, as you can see in org.eclipse.ui/plugin.xmlNote: I was not able to set CTRL+Tab as Key binding in org.eclipse.ui/plugin.xml > Extensions tab, under the bindings node. Actually, I can not find the "Tab" binding anywhere.Control-Tab seems to have some special meaning on OS X with accessibility. It cycles between controls in most application. But on Safari it does switch between tabs.Using Patrik's configuration infor Next Tab and Previous Tab works fine.I can proceed by editing /org.eclipse.ui.ide/plugin.xml and linking:- org.eclipse.ui.navigate.nextTab to M1+TAB- org.eclipse.ui.navigate.previousTab to M1+M2+TABThe only strange thing is I don't see any declared shortcut using TAB.Is there some special reason for that?(In reply to Patrik Suzzi from)Assuming you mean no explicit bindings for plain TAB: Tab, Shift-Tab, and Alt-Tab are handled by the WS/OS.New Gerrit change created:The proposed solution works for Win(10) and Linux(Ubuntu). Brian, could you please tell if this is ok also for Mac ?Thanks and Regards.Gerrit changewas merged to [master].Commit:Fixed for 4.6M7.New Gerrit change created:Gerrit changewas merged to [master].Commit:This broke accessibility, at least on Windows and GTK.In SWT, Ctrl(+Shift)+Tab is used to put the focus to the next/previous control when Tab already has another function (e.g. in an editable text field). A prime example is a textual compare editor in which both sides are editable.Maybe this is something we incorporate into the Oomph Welcome Questionnaire.(In reply to Markus Keller from)Thanks for the feedback, and for fixing this.I see your point, and think we can use special context in Editable Texts where: - Ctrl(+Shift)+Tab put focus on next (prev) control (as it is now)- pressing Esc, the focus is back to the Composite Container, so Ctrl(+Shift)+Tab works for switching tabs. In that case, we could have both "good parts", with the only hassle that the user have to remember to use ESC to exit from the "editable text contexts". Do you think this could work?(In reply to Patrik Suzzi from)No. As said before, Ctrl+Tab is a general accessibility feature that needs to work without any client-specific hacks.Out of the box, Eclipse will stay accessible. Allowing users to rebind Ctrl+Tab would be fine, and showing default bindings like Ctrl+Tab and Ctrl+PageDown in the Keys preference page would also be nice, but only if you can guarantee that the addition of these bindings doesn't influence anything unless the user sets the bindings to non-default values.E.g. a solution where the key binding infrastructure catches a traverse event and then re-posts the event would already be unacceptable, since that could break existing display filters.Keeping this open as we should evaluate adding this to the Oomph Welcome Questionnaire. SeeIf we're interested in Using Ctrl+Tab, I think we could:- keep the defaults as they are to preserve accessibility.- add a preference for using Ctrl+Tab, but warn the user that breaks accessibility .- add a question in the Oomph welcome questionnaire to set that preference.	33.0
id=431404	REOPENED	Platform	UI	4.4	PC All	P3 normal	Patrik Suzzi	2014-03-27 16:14 EDT by	Lars Vogel	2016-03-30 13:45 EDT (	6 users	If we drag a view upon a stack it is hardly visible.The required change should be located in StackDropAgent#showFrame	Added simple feedback styling like in 3.x (rectangle around drop target). SeeSome quick testing revealed this bug (but mot everything else looks great!).Starting with a new Java Perspective:Drag the Problems view to the rightOnce you get past half-way through the Javadoc's tab you (correctly) get the box over the Declaration tab...but......moving it back to the left so the cursor is on the left half of the Javadoc tab does not *remove* the box so the feedback doesn't match the operation (which is in this case a no-op).I think that this issue here is that the logic in the StackDropTarget was written to calculate the spaces *between* tabs. If we go this route we should likely change the logic to be simpler; just track the tab the cursor is over and use that (i.e. doesn't matter which half of the tab you're on...).Alternatively we could keep the logic and just spruce up the feedback. I'll attach a sample of what I'm thinking about...CreatedScreencap showing the insert 'caret' as a triangleThis is just a small example of how to make the existing insertion point more visible, other variations are certainly possible...New Gerrit change created:Createdcannot see the drop down image, but only its boundsI tried to solve the problem by drawing a drop down triangle centered on the drop insertion point For an unknown reason I'm not able to draw the image at the insertion point (see gerrit commit)Any suggestion on how to create the image to make sure the image is displayed on the overlay ?CreatedSolution - drop arrow is made by 8 stacked rectangles (magnified)I implemented a solution in which the drop arrow is made by 8 stacked rectangles.I think it is an acceptable solution until we're still missing a way to paint an image onto the overlay.CreatedNew DND Drop feedbackI just resubmitted a Gerrit change. Is there any blocker on this ?(In reply to Patrik Suzzi from)Looks initially good, I plan to test and review in early M2.Gerrit changewas merged to [master].Commit:Thanks Patrik.For 4.6M3This does not look good on Ubuntu, I see in most cases only a blurry fog, screenshot to follow.CreatedBlurryLooks bad. Could you please test with patchset 6, that draw in a different way?New Gerrit change created:CreatedPatchset 6 Screenshot - Still blurry(In reply to Patrik Suzzi from)Patch set 6 also does not work for me under Linux. I revert the change for now. Please investigate that create something which also works under Linux. I really like this change, it is a great improvements once it works.I'll test it under Linux, It'll take me some day to prepare a Linux box. I suppose we should check under Ubuntu and Fedora.Gerrit changewas merged to [master].Commit:CreatedStill blurry even on master - unrelated to patchUpdate: I set up the test project under (Ubuntu) Linux.Even at the current status of the master, the IDE shows a blurry line when moving tabs (see screenshot)Bottom line: - the blurry behavior is unrelated to the patch - the bug is still open as "Feedback on Stack" is still not clearly visible, at least on ubuntu.I'm still working on this.I think there is no solution for Ubuntu. The "Feedback on Stack" looks good on all platforms, except it is still not clearly visible under Ubuntu.The blurred edge seems a "feature of Ubuntu" for drawing contours. Any hint / suggestion is welcome !Patrik, are you still planning to finish this?Yes, I will give one last try in the next few days. My current problem is still how to get rid of the "blurry" effect on Ubuntu. Do we have a code example of an Eclipse plug-in drawing on top of a feedback layer that is not blurry on Ubuntu ?Any suggestion would be helpful.How about generating a single image rather than a suite of blocks?Better yet, make the image loadable and configurable via CSS (via CSSRenderingUtils): themes could have a different image for different stacks.	24.0
id=429899	REOPENED	Platform	Team	4.4	PC All	P3 enhancement	Patrik Suzzi	2014-03-07 12:44 EST by	Lars Vogel	2016-04-26 06:29 EDT (	8 users	I think we should customize the Eclipse SDK so that the History View is automatically synchronized with the current selection. I have several times seen people (including myself) wondering over the empty History View. Maybe we can change that preference setting in our Eclipse SDK build and ask to do EPP the same? Opinions?	We just discussed that on EclipseCon in our Git/Gerrit and the overall feedback was that this should be the default setting.Dani, sorry can't find team inbut I think you are responsible for this project. Would you be in favor of setting this as default?Dani, are you the component lead for team?This could have high performance impact based on the team provider.We can either close as WONTFIX or have a closer look during 4.5.Marking as WONTFIX for Luna, if required I open a new bug for Mars(In reply to Lars Vogel from)No need to create a new bug, you can reopen this one if needed.In Platform UI Andrey fixed the update of the History view if it is not visible. SeeWith that, I think we should make the "Link with Editor and Selection" the default.Background: I delivering a EGit training this week and the "why is my History view" empty is the most frequently question. I think changing the default here, will help new developers to use the History with less issues, while experience developers will know where to change this.Matthias/ Andrey, any input from the EGit team on this?From a usability perspective this would make a lot of sense. It could affect performance but nowadays EGit is pretty fast also on large repositories.I think I always switch this linking on hence +1 from me(In reply to Lars Vogel from)I have it always on and even with our monster repo I see no performance issues (on Eclipse 3.8). We should enable it if the platform version is >= 4.6, since earlier 4.x would cause unexpected refreshes.ok, so looks like we have agreement to switch linking on by default if the team provider is EGit, don't know for other team providers (see Dani's)(In reply to Matthias Sohn from)There's only one setting for the view (doesn't depend on the provider).Personally I also have it enabled, but I heard from people not having an SSD, that the History view updating can badly slow down the whole machine while (E)Git provides the input for the history. Is anyone on this bug not using an SSD and can comment on that?(In reply to Dani Megert from)If the find toolbar isn't shown (which is the default) EGit's history view loads the history incrementally in chunks of 256 commits. In addition there is a limit to not show more than 10k commits (preference "Team > Git > History > Max number of commits to show"). For large repositories the WindowCache limit (preference "Team > Git > Window Cache > Window Cache limit") is probably too small, increasing that should avoid repeated loading of the same objects from disk.if we have someone who can reproduce this slowness they can use tracing to trace the history view:- type "trace" in quick access and select "Configure Git Debug Trace"- enable trace for plug-in org.eclipse.egit.ui- enable trace "/debug/ui/historyview"then repeat the slow operations and post the trace here(In reply to Dani Megert from)I used a older laptop without SSD. Eclipse starts ultra slow (oh boy) and with this laptop everything was slower. But the History view sync setting did not create any (for me observable) slower interaction.History synced with the selection a great idea as its performances are good now. Also, the History View should be visible by default in SDK, so more people can understand and use it.IIUC, this bug mentions two items:1. Link the HistoryView with the selection 2. add the feature containing History View to EPP packages for SDKIn reply to Lars Vogel from)The sync itself can be performed via injection@Inject@Optionalvoid selectionChanged( @Named(IServiceConstants.ACTIVE_SELECTION) Object selection) { if(selection==null) return; this.selection = selection; // perform the sync synchronizeHistoryWithSelection();}Is it just a preference, a setting to enable? - If so, the behaviour above is already implemented somewhere and we have just to set a flag; where?In case we find cases in which objects are slow to be rendered in History, (w.r.t. Dani's), we could intercept them in the "selection changed", and render them gracefully.(In reply to Patrik Suzzi from)Sounds you misunderstood the scope. The sync is already where, you just need to change the default. Also History view is already part of all (relevent) EPPs.The changes needs to be done in GenericHistoryView. Have a look at thesetLinkingEnabled method and how it gets its default.(In reply to Lars Vogel from)Ok, thanks, now I understand. I observed GenericHistoryView#setLinkingEnabled(), and we use the property:IFileHistoryConstants.PREF_GENERIC_HISTORYVIEW_EDITOR_LINKING I'm going to set the default in TeamUIPlugin#initializeDefaultPluginPreferences()so GenericHistoryView#createPartControl() will be initialized by the default.(In reply to Patrik Suzzi from)Sounds good, please ensure that it works for the Git team provider. As it is a global setting, it should in this case also work for other team providers.New Gerrit change created:CreatedAnim Gif: History autosync is quite responsive on a PC with SSDI did some test and it seems quite responsive. It just lags a bit the first time you select a repository(In reply to Patrik Suzzi from)History view performance is very dependent on the type of the provider and for providers that have to query a remote server is dependent on how fast or slow that server is. Flipping the default may have a significant negative performance impact on some users. I'm not sure if this is justified by some additional convenience for EGit users. Should this preference be flipped for EGit users only?(In reply to Sergey Prigogin from)Currently, it is a global setting, and it uses a single boolean preference and a single button on the UI to activate/deactivate. If we differentiate per provider, we might need to introduce new boolean preferences, and maybe a button with a drop-down menu listing the known providers. Please, see this image as an example:If we can not agree on a solution here, on this bug, I suggest opening a new linked bug to track the Idea.Sergey, is this a general concern or can you observe performance problems with your team provider (perforce?) and this setting?(In reply to Lars Vogel from)Haven't tried it with my provider (Piper -) yet, but I know that retrieving history isn't particularly fast whenever a server call is involved.(In reply to Sergey Prigogin from)Please update the bug with your test results, once you have the chance to try it out.(In reply to Andrey Loskutov from)I must correct me. Working with *multiple* repositories seems to be still an issue. Seereported against EGit 4.2 (4.3 contains no changes in that area, so it is still valid).I suggest we put this on hold untilis fixed.	28.0
id=498302	REOPENED	Platform	UI	4.7	PC Windows 7	P3 normal	Patrik Suzzi	2016-07-21 12:51 EDT by	Markus Keller	2016-08-16 12:03 EDT (	1 user	I20160719-0800- press Ctrl+3- type "cbi"=> There's an entry "Copy Build Id Information To Clipboard [...] (Ctrl+C)"The shortcut is wrong. Ctrl+C doesn't do that in the workbench window. And it's also wrong that it currently does that in the About dialog, see.	I cannot reproduce the bug with Oxygen M1. Most likely is solved by, as last change for.Eclipse SDKVersion: Oxygen (4.7)Build id: I20160803-2000OS: Windows 10, v.10.0, x86_64 / win32Closing as fixed.The general bug is that Quick Access shows commands that are only active in the "In Dialogs" context (or in child contexts of that one, like the "About Dialog" context that was used for "Copy Build ID").In master, you can reproduce with the "Close User Assistance Tray (Ctrl+W)" command.Most probably this is related to how the commands are fetched in CommandProvider.is related. After that bug is solved, we should have a clearer view on how to get the proper context for the quickaccess.	3.0
id=375576	REOPENED	Platform	UI	4.1	All All	P3 major	Patrik Suzzi	2012-03-28 15:13 EDT by	Lakshmi Shanmugam	2016-04-20 12:14 EDT (	28 users	Createdscreenshotbuild id: 4.2 I-20120321-0610Steps to reproduce:1. Using Open Type dialog, open a file with long lines. One or more long lines should be somewhere in the beginning (first "page") of the file.2. The file opens in the editor but it has been scrolled horizontally to the beginning of the Class name. The attached screenshot shows the problem.	This works fine in 3.x. Looks like some broken/changed event flow when opening editors.Test case:1. paste:public class Bug {// Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug}2. close the editor3. use 'Open Type' to open 'Bug'This is caused by extensive requests to do a layout with SWT.DEFER (even on the shell). As a result, the part which is being opened, is not yet realized and hence all size and position computations are doomed to fail.When executing this code:takeAPartsControl.isLayoutDeferred();in partOpened(...) or partActivated(...) 4.2 returns 'true', which is wrong.This is a critical bug since it affects every part that wants to initialize itself based on its controls sizes and positions.Maybe this could be fixed within SWT by always forcing the layout when a client calls methods which rely on the layout. Tricky part with this is to distinguish calls from clients vs. internal ones.I tried to force a layout as a workaround but there doesn't seem to be a way to force the layout once it's in deferred mode.The only way to force a layout right now is by calling display.readAndDispatch(). You could call setLayoutDefered(false) while isLayoutDeffered() is true on the appropriate composite but I believe this will leave the deffered count unbalanced since next display.readAndDispatch() will also call setLayoutDeferred(false).SWT could add API, another layout flag -> NOW which means the opposite of SWT.DEFER. I am not sure that makes sense given that you still need to know how many times to call layout(..., SWT.NOW). Maybe SWT.NOW means call setlayoutDeferred(false) as many times as necessary.But wouldn't this just defeat SWT.DEFER? What is the point.Anyway, the problem only happens when there are no editors open. It should be possible to handle this above SWT.Comment above is mine.(In reply to)Right. I guess it's just overused in this case.No, it also happens when editors are open. Every part which gets opened and wants to do computations based on the layout is affected.OK, adding the following code (I put it in CompatibilityEditor at the end of the 'createPartControl' method): Display display = parent.getDisplay(); while (display.readAndDispatch()) ; parent.layout(true, true);While this appears to fix the issue by first flushing any DEFER'd layouts and then explicitly laying out the parent I'm concerned that spinning the event loop while opening *all* editors may introduce other regressions.If there are no other cases then it would be better if this code was put into the editor itself rather than potentially affecting currently working editors.Dani, what's your take ?(In reply to)I suspect that driving the event loop might also have other side-effects. So, I'd neither add this for all parts nor for just the textual editors.Silenio just pointed out that we only need a *single* call to 'readAndDispatch()' in order to flush the DEFER'd layouts.I've verified that this works and while I'm still a bit concerned about affecting other editors I'll take the initial hit.To be clear, if this introduces *any* regressions in currently working editors I'll revert the change and the code will have to go into the editor itself.(In reply to)Note, that not only editors are affected, but also any parts that rely on the layout. The effect is incorrectly laid out parts. There might already be other bugs complaining about this.Dani, I know of no other instances where the current code pattern is causing similar issues, do you ? I'm not about to put this code (ok, hack) into more general use unless we can clearly identify that it's needed.commit 26e36800be05a142d83b0dae6f37d885be5073d0Pushed the changes with the single 'readAndDispatch()'...I'll mark this as FIXED...Dani would you please get this and test whether you agree that it is indeed fixing the issue ?(In reply to)No, but I guess that graphic editors like GEF might be affected.No, it is not, because after your fix is executed many other setLayoutDeferred(true) calls are made (e.g. when updating the action bars [1]). You need to make sure that the layout is done just before partOpened/Activated is sent.[1]Thread [main] (Suspended (breakpoint at line 1082 in Composite)) Shell(Composite).setLayoutDeferred(boolean) line: 1082 WorkbenchWindow.updateActionBars() line: 1795 WorkbenchWindow.updateActionSets() line: 1874 WorkbenchPage$ActionSwitcher.updateActionSets(ArrayList) line: 777 WorkbenchPage$ActionSwitcher.updateTopEditor(IEditorPart) line: 671 WorkbenchPage.updateActiveEditorSources(MPart) line: 353 WorkbenchPage.updateBroughtToTop(MPart) line: 397 WorkbenchPage.access$16(WorkbenchPage, MPart) line: 396 WorkbenchPage$E4PartListener.partBroughtToTop(MPart) line: 173 PartServiceImpl$6.run() line: 246 SafeRunner.run(ISafeRunnable) line: 42 PartServiceImpl.firePartBroughtToTop(MPart) line: 244 PartServiceImpl.access$4(PartServiceImpl, MPart) line: 242 PartServiceImpl$1.handleEvent(Event) line: 92 UIEventHandler$1.run() line: 41 UISynchronizer(Synchronizer).syncExec(Runnable) line: 180 UISynchronizer.syncExec(Runnable) line: 150 Display.syncExec(Runnable) line: 4683 E4Application$1.syncExec(Runnable) line: 184 UIEventHandler.handleEvent(Event) line: 38 EventHandlerWrapper.handleEvent(Event, Permission) line: 197 EventHandlerTracker.dispatchEvent(EventHandlerWrapper, Permission, int, Event) line: 197 EventHandlerTracker.dispatchEvent(Object, Object, int, Object) line: 1 EventManager.dispatchEvent(Set, EventDispatcher, int, Object) line: 230 ListenerQueue.dispatchEventSynchronous(int, Object) line: 148 EventAdminImpl.dispatchEvent(Event, boolean) line: 135 EventAdminImpl.sendEvent(Event) line: 78 EventComponent.sendEvent(Event) line: 39 EventBroker.send(String, Object) line: 81 UIEventPublisher.notifyChanged(Notification) line: 57 PartStackImpl(BasicNotifierImpl).eNotify(Notification) line: 374 PartStackImpl(ElementContainerImpl<T>).setSelectedElement(T) line: 171 ModelServiceImpl.showElementInWindow(MWindow, MUIElement) line: 418 ModelServiceImpl.bringToTop(MUIElement) line: 385 PartServiceImpl.delegateBringToTop(MPart) line: 578 PartServiceImpl.bringToTop(MPart) line: 314 PartServiceImpl.showPart(MPart, EPartService$PartState) line: 962 WorkbenchPage.busyOpenEditor(IEditorInput, String, boolean, int, IMemento, boolean) line: 3066 WorkbenchPage.access$22(WorkbenchPage, IEditorInput, String, boolean, int, IMemento, boolean) line: 2991 WorkbenchPage$8.run() line: 2973 BusyIndicator.showWhile(Display, Runnable) line: 70 WorkbenchPage.openEditor(IEditorInput, String, boolean, int, IMemento, boolean) line: 2969 WorkbenchPage.openEditor(IEditorInput, String, boolean, int) line: 2928 WorkbenchPage.openEditor(IEditorInput, String, boolean) line: 2919 EditorUtility.openInEditor(IEditorInput, String, boolean) line: 373 EditorUtility.openInEditor(Object, boolean) line: 179 OpenAction.run(Object[]) line: 249 OpenAction.run(IStructuredSelection) line: 228 OpenAction(SelectionDispatchAction).dispatchRun(ISelection) line: 275 OpenAction(SelectionDispatchAction).run() line: 251 PackageExplorerActionGroup.handleOpen(ISelection, boolean) line: 376 PackageExplorerPart$4.open(ISelection, boolean) line: 538 OpenAndLinkWithEditorHelper$InternalListener.open(OpenEvent) line: 48 StructuredViewer$2.run() line: 866 SafeRunner.run(ISafeRunnable) line: 42 JFaceUtil$1.run(ISafeRunnable) line: 49 SafeRunnable.run(ISafeRunnable) line: 175 PackageExplorerPart$PackageExplorerProblemTreeViewer(StructuredViewer).fireOpen(OpenEvent) line: 864 PackageExplorerPart$PackageExplorerProblemTreeViewer(StructuredViewer).handleOpen(SelectionEvent) line: 1152 StructuredViewer$6.handleOpen(SelectionEvent) line: 1256 OpenStrategy.fireOpenEvent(SelectionEvent) line: 275 OpenStrategy.access$2(OpenStrategy, SelectionEvent) line: 269 OpenStrategy$1.handleEvent(Event) line: 309 EventTable.sendEvent(Event) line: 84 Tree(Widget).sendEvent(Event) line: 1053 Display.runDeferredEvents() line: 4165 Display.readAndDispatch() line: 3754 PartRenderingEngine$9.run() line: 1016 Realm.runWithDefault(Realm, Runnable) line: 332 PartRenderingEngine.run(MApplicationElement, IEclipseContext) line: 910 E4Workbench.createAndRunUI(MApplicationElement) line: 85 Workbench$4.run() line: 580 Realm.runWithDefault(Realm, Runnable) line: 332 Workbench.createAndRunWorkbench(Display, WorkbenchAdvisor) line: 535 PlatformUI.createAndRunWorkbench(Display, WorkbenchAdvisor) line: 149 IDEApplication.start(IApplicationContext) line: 124 EclipseAppHandle.run(Object) line: 196 EclipseAppLauncher.runApplication(Object) line: 110 EclipseAppLauncher.start(Object) line: 79 EclipseStarter.run(Object) line: 353 EclipseStarter.run(String[], Runnable) line: 180 NativeMethodAccessorImpl.invoke0(Method, Object, Object[]) line: not available [native method] NativeMethodAccessorImpl.invoke(Object, Object[]) line: 57 DelegatingMethodAccessorImpl.invoke(Object, Object[]) line: 43 Method.invoke(Object, Object...) line: 601 Main.invokeFramework(String[], URL[]) line: 629 Main.basicRun(String[]) line: 584 Main.run(String[]) line: 1438 Main.main(String[]) line: 1414Dani, not sure I understand...can you give me a repro scenario that ends up wrong with the new code ?(In reply to)The problem is that it sometimes indeed works but sometimes not (depending on whether other calls to setLayoutDeferred(true) happen before calling partOpened/Activated (seec).I can easily reproduce (master and I20120410-0633) on Windows 7 with these steps:0. start new workspace1. close Welcome2. paste this into Package Explorer:public class Bug {// Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug}3. Window > New Window4. Open Type 'Bug'==> now the bug might appear. If not, repeat step 3 and 4 until it appears. For me this normally happens in less than 3 attempts.Thanks Dani, I now see that the current 'fix' won't cut it...Dani, if you move the same 'fix' that I made in the CompatibilityEditor just before firing the event can you verify that this will fix the issue ?I had some trouble finding this API, is it the one from PartService ?Adding the fix just at one place won't do, because lots of setLayoutDeferred(true) calls happen between partOpened, partBroughtToTop and partActivated. Therefore, we either have to fix the underlying issue of calling setLayoutDeferred(true) so many times, or we need to patch 3 places. I guess at this point, the latter is the way to go.I've removed the changes made to CompatibilityEditor and added a fix to WorkbenchPage. The fix is less intrusive than the first attempt since I only drive the event loop once and don't force a layout. This is enough to flush the deferred layouts.Fixed in master:Eric, please review the fix. Thanks.Dani, I'm seeing a strange NPE now....I'm running N20120420-2153 and don't see this in there but I do when ever I run an inner (debug) session when clicking on any view that has not been instantiated (i.e. gets lazily rendered).java.lang.NullPointerException at org.eclipse.e4.ui.workbench.renderers.swt.StackRenderer$8.mouseUp(StackRenderer.java:878) at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:220) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053) at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4169) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3758) at org.eclipse.ui.internal.WorkbenchPage.firePartOpened(WorkbenchPage.java:4365) at org.eclipse.ui.internal.e4.compatibility.CompatibilityPart$2.handleEvent(CompatibilityPart.java:110) at org.eclipse.e4.ui.services.internal.events.UIEventHandler$1.run(UIEventHandler.java:41)(In reply to)Did you revert my change to verify it's form that change? If so, please reopen this bug.I put a fix in for the NPE in. Eric, can you verify whether that fixes your NPEs too? (Though maybe it's papering over a different issue; everything seemed to work though.)I haven't reverted it yet but I do think I have a possible fix...If you look at the trace where firePartOpened is called it's currently sent when the 'object' for the part goes non-null. This should likely just be moved to when the 'widget' is going non-null (the code for firing partClosed is already there...This defect scares me...here's the analysis:1) we add a model check on 'object' and firePartOpened2) in that code we ultimately spin the event loop3) the 'mouseUp' happens to be the top event on the queue4) the StackRenderer's 'mouseUp' handler fires and NPE'sTo be that sensitive to the timing of a single event is an indication that our life cycle handling is not very robust.Adding the NPE check is a good idea but in 4.3 we should take a closer look at this...I've addedto track this...OK, the preliminary testing shows that moving the 'firePartOpened' up to when the 'widget' is set seems to solve this issue.Now I have to test whetherhas regressed...other than that it looks OK. I'm going to get Bogdan to help me go over Dani's code just to be sure...OK...a) The change to firing off 'partOpened' to when the widget goes non-null did not introduce a regression.b) After checking it appears that the only part of Dani's commit that is needed to fix this issue is the code that was added to 'firePartActivated' (makes sense as this is the last event to fire so there are no opportunities for more deferred layouts to happen).As perwe have to avoid this hack whenever possible so my preference is to revert the changes in the 'firePartOpened' and 'fireBroughtToTop' methods. Since we have no idea *what* event is on the queue any regressions (like the one we found) could be completely random and thus hard to fix. If we find that similar defects start appearing we can revisit this but for now I have to lean towards the least change possible.Dani, I'd still prefer to remove this altogether...now that I've changed where 'partOpened' gets called to after the widget is created could you re-check whether you can add this code in your 'partActivated' implementation instead of in WorkbenchPage ? That would be the minimal use of the 'readAndDispatch' hack.commit 740d35da1cb0feda4ecc9bda7d855a8045886e19This commit moves 'firePartOpened' to when the part's 'widget' goes non-null (as opposed tot eh 'object' as it was). This looks symmetrical now since we fire part closed when the widget goes null.It also reverts some of Dani's original commit, leaving the only place we do the 'readAndDispatch' hack is in the firePartActivated method. This is about the least intrusive I can figure out how to make it (for now).Dani, I've run the scenario multiple times but a second check would be useful...Marking FIXED (again)(In reply to)Sorry, but that change made things *way* worse, e.g. partOpened(...) is now no longer fired at all. I reverted your commit to fix this and to fix this original bug (again ;-).If you make further changes please test them the following way before committing:1. open the source for ResourceNavigator.java2. add the following code: if (viewer.getTree().isLayoutDeferred()) System.out.println("bug!"); else System.out.println("works!);to each part listener method: partListener.new IPartListener() {...}.partActivated(IWorkbenchPart) partListener.new IPartListener() {...}.partBroughtToTop(IWorkbenchPart) partListener.new IPartListener() {...}.partClosed(IWorkbenchPart) partListener.new IPartListener() {...}.partDeactivated(IWorkbenchPart) partListener.new IPartListener() {...}.partOpened(IWorkbenchPart)3. add a breakpoint on the line with the "if" in each listener method4. start the target5. verify that each method is triggered when you open, activate, deactivate, bring-to-top and close views, and that the code goes through the "works!" code pathThanks.Sheesh Dani, sorry...;-( You are correct that I completely broke partOpened...back to the drawing board <sigh>To be clear my goal here (for M7) is to get the original test case (Bug Bug Bug Bug ...) to work correctly, not to match the old behavior exactly. However I'll see how close I can get.BTW, does the code that I committed fix the 'bug bug' test case ?(In reply to)We not only have to make partActivated work but also partOpened. That's what my fix did and now does again.I didn't bother spending further time on this, given the breakage it caused.OK, I'll leave this code in even with my concerns as outlined in...Should we start seeing issues we can come back then, otherwise we'll fix this properly in 4.3.Note that the partOpened event is still generated when the control is null, if this is going to be an issue please let me know right away...if we hadn't added the null check the StackRenderer would still be throwing NPE's...Verified in I20120503-1800.***has been marked as a duplicate of this bug. ***We've had to revert the part of this work that was calling 'readAdnDispatch' because it was causing serious reversions in the CTabFolder handling on the Mac.I'll re-open this for another look during 4.2.1.(In reply to)What's the bug number?PWThe real fix should really get rid of all the deferred layout requests.***has been marked as a duplicate of this bug. ***(In reply to)I see that this bug is marked as Critical, which is good, but I want to reinforce how serious this bug is for Mac users. It really compromises our ability to jump around in the Java IDE through following references.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Dani, there may be a quick fix for this on your side...before you do your layout call 'setLayoutDeferred(false)' on the shell. I'm not saying that we shouldn't then work with SWT to better understand the interactions between the two modes going forward but this is likely the quickest path to a working solution...Hmm, just re-read the whole defect and it seems this may not work but it may still be worth a shot if we actually haven't attempted it yet.(In reply to)There are several issues with that suggestion:1. One setDeferredLayout(false) call won't work because the framework excessively makes deferred=true calls. Clients would have to call the method until the layout isn't deferred anymore.2. The client has many places where it expects the stuff to be layouted and asks for some values, e.g. StyledText.getHorizontalPixel(). We can't go and find/hack all those places to workaround a severe framework bug.3. All other editors would still suffer from the problem.Dani, I think that you are right in that the correct solution to this will have to come from SWT. It looks like a non-deferred layout should first run the deferred layouts.However, I don't think that this will happen in the service releases (certainly not SR1 and likely not SR2). Silenio, correct me if I'm wrong here...The platform may indeed have to drop its current use of DEFER but this also is unlikely to happen during the SR cycles.For now it might be best to address this issue in the particular instance we have of the Java Editor.Dani, I'm begging dude, can you not see if you can fix this on your side ? I realize that I'm trying to fix the symptom not the disease here but I see no other solution and agree that this is a serious regression.Should other defects of a similar kind come in then we can address them separately.(In reply to)Sure. Fixed withThis adds a workaround that should cover all textual editors. Once we see it's working fine in 4.3, I'll backport it.(In reply to)This fix looks wrong, since it just calls shell.setLayoutDeferred(false), but doesn't undo its action by calling shell.setLayoutDeferred(true) the same number of times.It effectively leaves the layout undeferred. Since all correct earlier callers of setLayoutDeferred(true) will eventually call setLayoutDeferred(false), the layoutCount will end up negative. In the end, simple one-level usages of setLayoutDeferred will be ineffective after this.Thanks Dani...Markus, you've hit on one of the things that Silenio pointed out when we were discussing this issue. The real fear is that as the other folks call 'setDeferredLayouts(false)' themselves to 'unwind' the deferred stack they'll end up making the count go < 0 (a known bug in SWT).His suggestion was to place the layout into an 'asynchExec', thus guaranteeing that it would be run after the event loop has spun (and purged the pending layouts). It sounds questionable to me since it changes the timing of the layout but if it works...BTW, I just checked and even calling 'Display.getCurrent.update()' will *not* run the deferred layouts, lending more weight to the idea that SWT may have to take another look at the various interactions taking place here...CreatedTextViewer workaround 2Here's the "restoring" I had in mind (patch on top of master).(In reply to)I see your point and like your patch==>Seefor the backport.Thanks guys, hopefully before 4.3 goes out we'll have a better solution for this at the SWT level...***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Eric, can this be moved to 4.3 now?PWOK, this appears fixed to me. I'm going to mark this as FIXED, feel free to re-open if you still have concerns...(In reply to)It works for me.(In reply to)You already had that "feeling" several times now. Let me repeat two easy test cases that you can try before closing it next time ;-).Test Case 1:------------1. get 'org.eclipse.jface.text' as source in your dev workspace2. open TextViewer3. replace the two calls to internalRevealRangeWithWorkaround with calls to internalRevealRange4. save5. start new target workbench and execute next steps in it6. close Welcome7. paste this into Package Explorer:public class Bug {// Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug Bug}8. Window > New Window9. Open Type 'Bug'==> now the bug might appear: the editor is wrongly horizontally scrolled.If not, repeat step 3 and 4 until it appears. For me this normally happens in less than 3 attempts.Test Case 2:------------1. open the source for ResourceNavigator.java2. add the following code: if (part == ResourceNavigator.this && viewer.getTree().isLayoutDeferred()) System.out.println("bug!");to those part listener methods: partListener.new IPartListener() {...}.partActivated(IWorkbenchPart) partListener.new IPartListener() {...}.partOpened(IWorkbenchPart)3. start a target workbench4. close Welcome5. Window > Show View > Navigator==>bug!bug!Both test cases pass fine on 3.x.Dani, I'm moving this to 4.4...We know what the issue(s) are:1) The new 4.x code makes extensive use of SWT.DEFER-and-2) SWT's handling of this type of layout has serious issues (i.e. effectively blocks layouts which are not expected to be deferred).The only two possibilities for a proper fix require either that we rewrite all the current layout code in the workbench to avoid the use of SWT.DEFER or to have a fix from SWT that fixes the current blocking behavior.It's too late to change the workbench and I strongly suspect that it's also too late to provide the necessary SWT fix as well (Silenio ?).At this point it seems that the user community at large is not seeing the effects of this defect thanks to your workaround so it shouldn't appear as a regression to our users...***has been marked as a duplicate of this bug. ***M4 is done...Reducing severity based on.Assigning to myself for investigation. We definitely shouldn't be setting scroll bars to the wrong spot, but we also shouldn't be doing synchronous layouts due to the performance cost.Going to see if I can find a solution which is both correct and fast.(In reply to Stefan Xenos from)The first thing to do here is writing tests that assert correct event sequences.I disagree with the claim that performing a synchronous layout prior to firing the event is the only way to fix this, so I wouldn't want to write a test asserting that this is the case.Without having dug into this yet, the following general strategies often work for this type of problem:A. Lazily perform a partial synchronous layout on demand in order to supply the requested information.B. Defer the operation until after the layout has completed rather than performing it synchronously.C. Move some code out of listeners and into custom layout implementations such that it executes as part of the layout passD. Some combination of the aboveNone of these would require forcing a synchronous layout prior to firing the event and I'd like to rule them out before considering a solution with a heavy performance cost.(In reply to Stefan Xenos from)When a client gets the listener notification that the part is open/on top, then he can assume to safely call methods on SWT. Those methods will only work if no deferred layouts are pending. That's all what the test should do. Anything that would require the client to do something prior to calling the SWT methods would be wrong.I'll respond to this once I've had a chance to investigate further.CreatedBug tested (case1)(In reply to Dani Megert from)Dani, according, I'm able to reproduce the error in both Test Case 1 (see image) and 2 (Navigator is now deprecated).According Eric's, we should better understand the extensive use of SWT.DEFER, and ask the SWT guys to point us to the "best practices" for having propert SWT layouting. At this point we could follow Stefan's, by choosing to: (a) perform a sync layout request; (b) defer the layout operation and (c) implement a custom layout. As test, I could think to add a plugin contributing a view, to be displayed by a command (like in Navigator). Then in the test listen to to partOpened(), partBroughtToTop() and partActivated(), to verify the layout is NOT deferred. In the worst case, see Eric's, we could ask SWT guys to provide us an hook (API) to get synced (wait?) for a deferred layout :)To better understand, I'd like to ask you some questions:1. Could you please give me a reference on "best practices" for "proper" layouting?2. How would you suggest to sync with deferred layouts?3. Do you know whether there is already a test, similar to the one I described, that I can reuse to verify the bug?Kind Regards.I'm probably the guy you want to ask. I did a lot of work on the SWT layout system and wrote the pseudocode that SWT.DEFER was based on. Sorry, I've been planning (and really looking forward) to fix this one, but my users have been keeping me so busy with JDT core stuff that I haven't had a chance to come back to it.Why are deferred events desirable?When you do something like switch perspectives, there will be a whole bunch of part events fired and a whole bunch of views and editors realized. If each one forces a synchronous layout, you end up doing a bunch of layouts when you could have done exactly one. You basically multiply the cost of the layout by the number of views.The SWT.DEFER thing marks all the controls that need to be recomputed and lays them out in a single pass. This is massively more efficient. However, in order to work properly, anything which positions a control needs to happen as part of the layout pass.Actually, that's not just due to deferred layouts. It's actually true all the time, but when using deferred layouts the consequences are much more visible. Even without deferred layouts, methods like getBounds() return the result from the most recent layout pass, not the currently-running layout pass... so if you're making a decision about a widget position based on it, your calculations are going to be slightly out of date. The results are particularly noticable when using deferred layouts, though, because the previous layout pass may have never happened so you'll get answers that are wildly off rather than just a few pixels off.I was planning to address this using a custom layout implementation which bases its decisions on the results of computeSize (which returns a hypothetical size that is always up-to-date), not the result of getBounds() or getSize() (which is always slightly out-of-date).If you're stumped and you want a rich set of layout examples, check out the Android source code. All the layouts are open-source and the layout algorithm is very similar to SWT's. However, in Android all layouts are deferred - there is no option to layout synchronously, so the source code is full of useful idioms for this sort of thing. An Android RecyclerView also faces this kind of problem -- the view gets instantiated synchronously and its owner may ask it to scroll to a particular row immediately after it is created, before the first asynchronous layout pass runs and the dimensions of the view or its contents are known. The code won't port directly, but it may be a useful source of inspiration since it has so many similarities to SWT.(Instead of a computeSize(...) that returns a Point, they have a method called measure(...) which returns stores its result in the receiver. You can access it by calling getMeasuredWidth/Height()...).In the case of Android, most application developers are unaware that the layouts are all asynchronous since they have useful helper methods like "scrollToPosition" that take a row number and figure out the pixel position on the next layout pass. IMO, SWT could offer similar helper methods so that each view and editor doesn't need to write a custom layout to make everything work correctly.Here's the code for it (LinearLayoutManager.java does the asynchronous magic which turns a synchronous method called by client code into something asynchronous that works with the deferred layout system):Notice that scrollToPosition remembers a "pending" scroll position independently of the actual control size and triggers an asynchronous layout. During the asynchronous layout (onLayoutChildren is very similar to SWT's "layout" method), it then figures out the actual pixel position for the scroll as the children are being layed out.iOS, QT, and every other layout system I've used does something very similar, but the code isn't as easy to read if you're used to SWT.I believe the same general approach will work here.Anyway. I'm lurking in the #eclipse-dev IRC channel most days if you'd like to discuss this with me... and if you don't end up fixing this, I promise I will - eventually - as soon as I'm done fixing all my critical JDT core bugs. :-)Patrik, I wanted to follow up on our discussion on IRC.There was a suggestion to use readAndDispatch to force the deferred layout to happen. It will probably do that, but it will also execute unknown code that was scheduled via asyncExec and will eventually cause a hard-to-reproduce crash when one of those asyncExecs tries to close the very part you're opening or corrupts the workbench state by activating a different part. Don't do this.There was another suggestion to defer the work using asyncExec. Deferring the work is a good idea, but doing so with asyncExec won't work 100% of the time. It would be a race condition since there's no guarantee that your asyncExec will run after the deferred layout. Don't do this either. If I'm reading the above comments correctly, it looks like someone tried this and hit exactly this race.Instead, defer the work using a custom layout's Layout#layout method. This will always run at exactly the right time (as part of the next layout pass)... and running as part of the layout pass rather than after it is even better since - if you do it right - you'll only reposition the child widgets once rather than twice.Taking the bug, I plan to solve this using a custom Layout#layoutGood to hear. Let me know what you come up with. Once we understand the problem better, it may make sense to push the solution up to SWT so that others who face similar problems won't have to do such an elaborate fix.Patrik: Are you still working on this? Anything I can do to help?Stefan, I re-started working on this after a long pause. - I reproduced the bug, by get+editing org.eclipse.jface.text.TextViewer class(eclipse.platform.text\.git)As we agreed in IRC, I should create a new custom layout and attach the custom layout to TextViewer. I wasn't very clear how to create and assign the custom layout, so I logged the layout responsible of this bug, that is :org.eclipse.e4.ui.workbench.renderers.swt.TrimmedPartLayout(eclipse.platform.ui\.git)This layout is instantiated once, at startup, for each workbench window, in:WBWRenderer.createWidget(MUIElement, Object) line: 376 Construction and assignment are as you can see: TrimmedPartLayout tl = new TrimmedPartLayout(wbwShell); // .. wbwShell.setLayout(tl);So, according what we agreed, I should create a new layout (#1, #2) then replace the TrimmedPartLayout, unless we want to just "edit" it, instead of creating a new one. To be honest, I'm more for editing the existing TrimmedPartLayout, instead of creating a new one.Thanks for giving your time.Any suggestion is welcome. #1#2Mass move to 4.7 as M7 is approaching. Please move back in case you are planning to fix it for Neon.	78.0
id=511198	REOPENED	Platform	UI	4.7	PC Linux	P3 normal	Patrik Suzzi	2017-01-27 09:29 EST by	Lars Vogel	2017-02-14 09:05 EST (	4 users	We should use verbs instead of yes, no dialogs.If an editor is changed, and if you close it, a "Do you want to Save" dialog is shown. This dialog should say save no save (see Microsoft user guide for good wording).	CreatedImage: the new save dialog buttons+1 as with "Save"/"Don't Save" dialog will be more consistent.Code change will follow shortlyNew Gerrit change created:Createdimage: Save list of resources is not changedPlease, note: as you can see in the image above, the "Save Resources" (list) dialog is not (yet) changed. I think we could change also the "Ok" / "Cancel" button labels with "Save" / "Don't Save". Do you agree?(In reply to Patrik Suzzi from)+1(In reply to Lars Vogel from)I think the Gerrit does not yet contain this change. Any plans to update it?Createdimage: also saveable list now displays Save/don't saveAlso the SaveableList$MyListSelectionDialog displays "Save" / "Don'tsave" instead of "Yes" / "No"(In reply to Patrik Suzzi from)I think the Cancel label should be preserved, or even better called "Cancel Exit", if only used during existing the workbench.I(In reply to Lars Vogel from)Thanks for pointing this. SaveableList seems generic. I'm rolling back "Don't save" to "Cancel"Creatediamge: updated save resources list selection dialogGerrit changewas merged to [master].Commit:The change is now merged in master. Adding N&N shortly.New Gerrit change created:Gerrit changewas merged to [master].Commit:These buttons still need mnemonics.Make sure you don't introduce a conflict with "&Save" and "&Select All". Since "&Save" should use the standard mnemonic S [1], try to change "&Select All" to "Select &All". Check all existing users of that label for further conflicts.[1] See e.g. table "Access keys" inThis reverts the change since changing the labels for the MessageDialogWithToggle also changes the return codes and hence the mapping to ISaveablePart2.YES|NO|CANCEL fails.Test Case:1. open a file and modify it2. open a new window3. open the same file from step 1 (should be dirty)4. close the editor==> none of the buttons does something useful.NOTE: "Don't save" must be title style, i.e. "Don't Save".(In reply to Dani Megert from)Looks like this also requires the changes in. Patrik, maybe you can review the related change and use it here?(In reply to Lars Vogel from)Reviewed; indeed the change 90281 (for) looks good. In practice, it adds a map to link button labels with proper return values. When that change is merged, I can push a new change, similar to the old change, but with these improvements: - "Save" and "Don't Save"- mnemonics as suggested by Markus in- label-to-value mappings: "Save"-> YES , "Don't Save" -> NO	17.0
id=193361	REOPENED	Platform	UI	3.3	PC All	P3 normal	Remy Suen	2007-06-19 12:57 EDT by	Paul Webster	2010-02-17 12:08 EST (	3 users	I created the Sample XML editor and lauched eclipse. When I try and open my random XML file (test.xml) it opens in the text editor, not the sample XML editor we've provided. The XML editor *is* available if you go to "Open With".It seems that just having the content type descriptions override the editor extension declaration.PW	The bug is in EditorRegistry.findRelatedObjects: it correctly collects the xml editor but also adds all the editors that match the supertype of XML content type. Unfortunately it adds the editors for the supertypes to the list before it adds the ones bound to the extension. The whole method could deserve some polish ;-)Mass update - removing 3.4 target. This was one of the bugs I marked for investigation (and potential fixing) in 3.4 but I ran out of time. Please ping on the bug if fixing it would be really important for 3.4, and does not require API changes or feature work.Remy is now responsible for watching the [EditorMgmt] component area.CreatedEditorRegistry patch v1This patch corrects the order of the collection with a test.I didn't put the test directly in IEditorRegistryTest since I didn't want to be contributing an XML editor in the org.eclipse.ui.tests bundle directly as this can cause undesired effects when opening XML files in the runtime workspace.(In reply to)Patch released to HEAD >20100119.Verified on I20100125-1800.Had to roll this back for.	7.0
id=461999	REOPENED	JDT	UI	4.5	PC Linux	P3 enhancement	Till Brychcy	2015-03-12 09:01 EDT by	Stephan Herrmann	2017-02-21 17:19 EST (	3 users	The new warning being prepared vianeeds to be configurable in the UI.Current proposals look like this:Unlikely argument type for Map.get() et al [Ignore/Warning/Error] [X] Accept arguments that could be cast to the expected type	has the fix, but Hudson fails because a relevant change in JDT/Core is still unavailable as a nightly build :(Released for 4.5 M6This feature has been withdrawn from Mars.See.Thanks, Stephan.The "Map.get() et al" part of the compiler option needs to be polished a bit:- we should avoid latin ("e.g." is already at the limit)- should try to give a general problem description, not just a single example. E.g.: "Unlikely argument type for collection methods using 'Object'"In org.eclipse.jdt.internal.ui.preferences.ProblemSeveritiesConfigurationBlock:- code style: PREF_15_PB_DISCOURAGED_INVOCATION_UNLIKELY_ARGUMENT_TYPE and PREF_15_PB_DISCOURAGED_INVOCATION_ACCEPT_CASTABLE_ARGUMENT should be defined in the order in which they are shown on the preference page- #getKeys() missed the PREF_15_PB_DISCOURAGED_INVOCATION_ACCEPT_CASTABLE_ARGUMENTI've added a test for the latter to the OptionsConfigurationBlockTest (which is not run in the build, since we don't want to create test failures every time jdt.core adds a new option):(In reply to Markus Keller from)For my education, what is the effect of that omission?I could see that the other key was needed for the "Configure Problem Severity" link, but I saw now reason to add this key.We assume that a project has project-specific settings for a preference page if at least one of the options is stored in the project.Since we always store all project-specific settings (even if their value matches the workspace setting), most of the keys are usually not strictly necessary. But if a user releases a .prefs file with just that one option set, then it becomes necessary.SeeNew Gerrit change created:(In reply to Eclipse Genie from)See.@Stephan, I'm not a jdt.ui committer, so I had to set myself as author to push this to gerrit and I've set you to Also-By. I hope that's ok.Patch set 1 just is the rebased patch,Patch set 2 is updated.	9.0
id=410218	REOPENED	JDT	Core	4.3	PC Windows 7	P3 enhancement	Till Brychcy	2013-06-07 12:50 EDT by	Markus Keller	2017-02-26 12:48 EST (	10 users	Add an optional compiler warning if arguments of "unexpected" types are passed to java.util.Map#get/remove(Object), Collection#contains/remove(Object), Collection#retain/remove/containsAll(Collection<?>), List#indexOf(Object), etc.Example: Set<Short> set = new HashSet<>(); short one = 1; set.add(one); set.remove("ONE"); // bad (wrong type) set.remove(1); // bad (tries to remove "Integer 1") System.out.println(set); // shows that the "Short 1" is still in! set.remove(one); // ok System.out.println(set);The calls marked as "// bad" compile without error, although they often hide a programming error that would have been caught at compile time if these accessor methods would not accept all types, but just the type variable E (or K or Collection<? extends E> etc.).Unfortunately, the affected accessor methods cannot be determined in a generic way, so we need an explicit list of special methods and their "expected" argument types. For method invocations of a special method, the compiler can then also check whether a variant with the "expected" signature would also be applicable. If it's not applicable, then a warning should be issued.Some background:	I wholeheartedly agree.I assigned the bug to me, but I won't start right away, so if s.o. elsehas cycles to spare and is interested in this bug please let me know.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***Stephan, do you expect to work on this for Luna ? ISTM, this is best addressedin the start of Mars ? If you agree, please retarget. Thanks.Since an optional warning requires additional API it is too late already for 4.4, right?(Other than that, implementation _might_ be straight forward and simple).Linking to, which requests special/similar warnings for equals() of certain well known types.I have a draft implementation in my workspace.An example warning message would be:----------1. WARNING in X.java (at line 8) if (set.contains("ONE")) // bad ^^^^^Discouraged invocation of method contains(Object), this argument should have type Short to match the declaring type Collection<Short>----------Here's another example I used for experiments:void test(Map<? extends Number, Number> m) { if (m.containsKey("ONE")) // bad m.remove("ONE"); // bad}Recognizing this as bad is easy, too. Question is: what would a user have to write to avoid the new warning? Literally, the "expected" type would be a capture, a value of which is quite difficult to obtain.My initial feeling was, that we may want to silence the warning if the mismatch between "expected" and actual type is only a matter of captures. OTOH, if those methods were declared using a type variable, the strict interpretation would be mandatory, of course. But users will not like the warning if it creates situations that are hard to get right and may still do the right thing.What do you think: is it a relevant concern to avoid warnings involving captures?More questions: What should be the default value for this new diagnostic? Warning? Ignore?I think we want to make it suppressable with @SW, right? Which token? Should we introduce a new token? (proposed "rawtypes" :-/).requests a distinction of potentially incompatible vs. incompatible. Should we? I don't have a strong opinion on this, but surfacing both levels as separate options in the UI feels like overkill to me.(In reply to Stephan Herrmann from)This particular example is obviously wrong because a String cannot ever be a Number. If you replaced "ONE" with 1, then it becomes more interesting, because the ? could be Integer for some invocations. Still, it seems unclean for a generic method to include specific functionality, so I wouldn't object to inflicting some SuppressWarnings pain on people who are doing this.I'm curious, what are the rules about casting - would a compile-time cast from the capture type [or equivalent type variable] to Integer be accepted? What about the other way? This is relevant if the 'incompatible' vs 'potentially incompatible' distinction is preserved (see further down).Personally I would say not, because this (your example tweaked to use only Numbers):void test(Map<? extends Number, Number> m) { if (m.containsKey(1)) // [potentially?] bad m.remove(1); // [potentially?] bad}has exactly the same level of potential wrongness as this:void test(Map<Short, Number> m) { if (m.containsKey(1)) // bad m.remove(1); // bad}And in fact, it's less obvious that the first example is wrong, so perhaps the warning is even more useful there.In a real use case, perhaps test() should be taking the '1' as an extra argument (and using a type parameter):void test<T extends Number>(Map<T, Number> m, T removeMe)Warning!!! It's so rare to need to pass a strange type deliberately. Oh by the way though, perhaps if the method is just a wrapper like the following, then you might want to suppress the warning (I don't see any need to make this optional).class MySet<T> implements Set<T> { public bool contains(Object t) { //implements Set<T> return wrappedList.contains(t); //bad but unavoidable }}Not rawtypes :) Those methods were declared in terms of Object instead of T for a non-rawtypes-related reason: for example, HashSet<T>.equals(TreeSet<T>) can return true, and therefore so can HashSet<HashSet<T>>.contains(TreeSet<T>). It's just that those cases are much rarer than the common case of passing the wrong key by accident.I can't see an existing token that's correct - not even "unchecked" since this has nothing to do with heap pollution. Meanwhile, "serial" and "sync-override" are very specific, so it looks as if it's fine to make a new very specific one. Perhaps something like "keytypes"?That was my proposal, and it's to do with the HashSet<T>.equals(TreeSet<T>) case above.So if you write this: HashSet<HashSet<T>>.Contains(TreeSet<T>)then the new warning will kick in because a TreeSet<T> cannot be a HashSet<T>. However, my reasoning was, if you cast it like this: HashSet<HashSet<T>>.Contains((Set<T>)TreeSet<T>)then it can be classed as only 'potentially incompatible', and perhaps users will disable the 'potentially' warning if they need to do this.Surfacing the two options might not be overkill if you do it using an indented checkbox:Incorrect key type passed to Map.get et al [Ignore/Warning/Error] [X] Allow arguments that could be cast to the correct typeThen it still looks like a single concept and doesn't use up too much space.Here's another thought actually: perhaps we don't even need the 'potentially' case, i.e. if the argument could be cast to the correct key type then no warning. That would also save you having to write a special case for wrappers.Createddraft(In reply to Missing name from)Thanks, Anonymous, for detailed comments.I see that my considerations about captures were a bit off. Just because it's hard to supply an argument of the required type doesn't make for a good excuse :)Instead I now included a distinction between - argument can be casted to the "expected" type -> softly discouraged - argument cannot be casted to the "expected" type -> strongly discouragedIn deviation from standard casting rules I'm admitting a boxing operation before the compatibility check.That's my take, too. Let's see if anyone objects.>That's actually a situation for which we need a good story, if we want to enable the warning by default. * It doesn't make much sense to insert an unchecked cast "(T) t". * @SW would be the natural answer, if this occurs infrequently. * We could also treat j.l.Object as a tolerable catch-all (In that case users should know that they don't know what they are doing). Would that be part 3 of the option??I agree that none of the existing tokens really match. "keytypes" would cover only the K from Map, not the V and T arguments. Still taking bets.Let me brainstorm a bit what it really *is*, before condensing into a short token: the library methods are "over generalized", resulting in "dangerous signatures", which falsely admit arguments that semantically don't match."problem-signature"We're slightly mixing two things here: the reason that both types are admissible is in the implementation of their equals methods. The fact that both have a non-trivial common super type has little to do with this (except, that Set<T> indeed happens to establish this contract of equality).Obviously, inserting a cast to j.l.Object is the escape door, allowing to soften all warnings to "potential". That's in fact similar to how nested casts can circumvent the checks for uncastable types.Looks good.At the bottom line, to me the wording seems to be the hard part. This concerns the @SW token and also the warning messages. Tests in the attachment show the following messages in action:1200 = Discouraged argument for method {0}, should be of type {1} to match the declaring type {2}1201 = Discouraged argument for method {0}, provided type {1} is definitely incompatible to type {2}. Declaring type is {3}Here's an alternative pair of proposals:1200 = Invoking method {0} with an argument of type {1} is discouraged. Should use {2} to meet the semantics of declaring type {3}1201 = Invoking method {0} with an argument of type {1} cannot meet the semantics of declaring type {3}. Recommended type: {2}I really want to show: (a) what's wrong, (b) what should it be instead, and (c) why. For the "why" I'm including the declaring type (that's where we see the effective parameterization).(In reply to Stephan Herrmann from)Sounds good on the face of it; I'm sure you've thought about boxing in more depth than I have. By the way, not sure if you used it in any messages, but we just say 'cast', not 'casted' (it's irregular).The Object solution would affect people who have Map<String,Object> - which does happen, though it's not that common. Still, what I had in mind is you could check if the argument is a field access expression which resolves to an affected parameter of an affected method. If that's not too onerous then I think it is better. I can't think of any cases it doesn't catch; can you?Good point.Too general I'd say, and it also draws attention to the signature (not in the user's control) rather than the invocation (which is).Generalising directly from "keytypes", "argtypes" is closer but it's still too general.What these methods all have in common is that they never store the Object you pass in, they just use it for comparisons. Not sure if that helps us at all.I just had a read oftoo in the hope of some ideas, perhaps some terminology we haven't thought of. I haven't found a great deal, but terms like liberal, restrictive..."liberal-arg-type"?Another way we could look at it is, while there is a reason why these strange argument types are accepted, they are "unlikely" to be correct."unlikely-arg-type"?If more cases are found in the future that have nothing to do with this but are still examples of someone passing an argument of a type that seems unlikely to be right, then I think it could share @SW quite validly with this one.Aside: it's reassuring to see how many people have upvoted the comments we agree with :)Not sure I understand which two things we're mixing. I think the Set<T> example is merely to explain why someone decided to make these methods take Object instead of T in the first place. It's also definitely the case that 'type cannot be implicitly cast' and 'ditto explicitly' are heuristics, and that they don't take Set<T> into account. (We could do something messy like check if Set<T>.equals() exists and HashSet<T>.equals() doesn't, but that's not foolproof since HashSet<T>.equals() might exist to optimise the 'two HashSets' case without changing semantics, for example. I think our heuristics plus @SW are good enough.)Yep :) but it's messy if it happens a lot, so @SW is still useful - someone might have a valid reason to use it on a whole method or class.Cool :) Though now I'm thinking, 'Unlikely key type' may be better?These are much easier to understand with examples, so I guess that would be:1200 = Discouraged argument for method get(Object), should be of type String to match the declaring type Map<String, Integer>1201 = Discouraged argument for method get(Object), provided type Class is definitely incompatible to type String. Declaring type is Map<String, Integer>1200 = Invoking method get(Object) with an argument of type Object is discouraged. Should use String to meet the semantics of declaring type Map<String, Integer>1201 = Invoking method get(Object) with an argument of type Class cannot meet the semantics of declaring type Map<String, Integer>. Recommended type: StringYes, it makes sense. I like the second proposal for 1200 the most (since it includes the current argument type), and would perhaps tweak 1201 so we can get the recommended type out before the declaring type. Here's a new proposal (sorry for leaving the examples in, it just makes it easier to discuss and refine):1200 = Invoking method get(Object) with an argument of type Object is discouraged. Should use String to meet the semantics of declaring type Map<String, Integer>1201 = Invoking method get(Object) with an argument of type Class is unlikely to be correct. Should use String to meet the semantics of declaring type Map<String, Integer>, or consider adding a cast to Object* if correct* That's the most specific common supertype, and obviously if they do it then they'll get warning 1200 if enabled.By the way, if someone does this: class MyVerySpecificMap implements Map<String, Integer>then that will obscure the message, so it may be worth degenerating the 'declaring type' (for message purposes) to the built-in collection interface that originally declared the problematic method - i.e. the message says Map<String, Integer> instead of MyVerySpecificMap.Oh, in the interests of succinctness, you could also remove the words 'declaring type' and 'method' if you want - it's pretty obvious once it's got examples.Hope that helps :)Make that 'Unlikely argument type'!(In reply to Missing name from)And 'to the expected type' perhaps?(In reply to Ben Davis from)That's exactly what the implementation indoes :)I don't yet have tests matching your exact situation, but for all tests using Set<Short> the message mentions the 'declaring type Collection<Short>'. This is done by searching the super type that is a parameterization of one of the well-known trouble makers (Collection and Map, so far)And the previous point is exactly the reason why I say 'declaring type'. Still users will complain: why is the message talking about Map<String,Integer>? I don't see this type anywhere in the flagged code. I want to give at least some hint where to look.(In reply to Ben Davis from)I'm not sure which effect you have in mind? For such map asking containsValue(x) is always OK, with or without any special rule for j.l.Object, but anyway I wouldn't include this rule just now.too complex, IMHO.I like this best, so far.Accordingly, the UI proposal would now be s.t. likeUnlikely argument type for Map.get() et al [Ignore/Warning/Error] [X] Allow arguments that could be cast to the expected type(I don't think we want to say "argument type passed to").Maybe "allow" has too strong indication of legality wrt JLS? "Ignore" might be more correct, but also more confusing. I think "accept" would strike a good balance.I'd leave the following as a possible future addition: [X] Accept arguments of type java.lang.ObjectAs for the warning messages, we seem to agree on:1200 = Invoking method {0} with an argument of type {1} is discouraged. Should use {2} to meet the semantics of declaring type {3}For the stronger message, my initial thought was that uncastable types are definitely wrong. As the Set example shows, this isn't even true. Hence, "uncastability" is only an even stronger indication of an error, not a proof.From that, 1201 could either just emphasize like in "strongly discouraged", or harp more on a connection to the UI option, perhaps by saying:1201 = Discouraged invocation of method {0}. Argument type {1} cannot be cast to the likely type {2} according to the declaring type {3}.If this agreeable, we could assimilate 1200 by saying1200 = Discouraged invocation of method {0}. Argument type {1} is incompatible to the likely type {2} according to the declaring type {3}.I'll add tests, which spell these out with examples in my next patch.I was also playing with different orders of parts of the message, but I think the current order succeeds in putting the most important parts first.The "or" part is too much, IMHO. I'm not even sure if we want to *recommend* that workaround using a cast.(Replying to both posts at once)Great, I hadn't checked :)I'm sure it will work.You're right, it won't entirely solve the problem you're trying to solve. But I think most people will get it with either version (come on, they KNOW about the Map<A,B> they're using that the warning mentioned), and my feelings about keeping/removing the words are as weak as gravity :)I was thinking of the case where someone accidentally passes a value to a function that expects a key. Since the values are Objects, they'd miss out on a warning. Granted they're already subject to the opposite risk (passing a key where a value was expected), but there's no sense in making it worse.Shrug. Wouldn't stop me, but OK :)More succinctness - good :)I noticed that too but was too tired (and felt I'd spammed enough) to explore it. I agree - change it to 'Accept'.Hardcoded to accept those for now? Mainly so we don't screw container wrappers up.That all sounds good, except grammatically it needs to be 'incompatible with'. Or if you want to be clearer, I think 'not convertible to' would convey the right meaning.Agreed - that was what motivated my suggestion for 1201.Fair point - leave it out. @SW is probably better than casting in such cases.:)Playing further with the 'not convertible' thing, we could consider saying 'not convertible' for one and 'not convertible even with a cast' for the other?So you'd have1200 = Discouraged invocation of method {0}. Argument type {1} is not convertible to the likely type {2} according to the declaring type {3}.1201 = Discouraged invocation of method {0}. Argument type {1} is not convertible to the likely type {2} according to the declaring type {3}, even with a cast.Nah, don't like it. Stick with what you've got. (Posting anyway just in case you do want to explore this.)New Gerrit change created:Shifted from linguistics back to engineering :)(In reply to Eclipse Genie from)@Markus, do you want to comment on added API (constants in JavaCore and IProblem - plus new @SW token) and message wording?I also Cc'd you on, marked that one as M7, though.For better accessibility, here's the list of methods recognized by the change:Collection.contains(Object)Collection.remove(Object)Collection.containsAll(Collection<?>)Collection.removeAll(Collection<?>)Collection.retainAll(Collection<?>)List.indexOf(Object)List.lastIndexOf(Object)Map.containsKey(Object)Map.get(Object)Map.containsValue(Object)Methods are also recognized via any sub-type of the above.A failure in BatchCompilerTest reminded me, that hasTypeBit() may trigger super type traversal, thus making lookup more eager than strictly necessary. I reduced this effect to the minimum by first comparing selectors and only then checking the receiver type.Gerrit changewas merged to [master].Commit:Released for 4.5 M6.Let me know if I missed s.t. relevant.New Gerrit change created:(In reply to Eclipse Genie from)This changes one of the options from [E/W/I] to [Enable/Disable] to better support the intended way to surface this in the options/preferences UI.We still use two IProblems, just the way they are controlled via JavaCore options is changed.(In reply to Stephan Herrmann from)Pushed directly viato accommodate tiny javadoc corrections.New Gerrit change created:(In reply to Eclipse Genie from)No, Genie. That commit is not for this bug, it just mentions this bug's number in its title.Gerrit changewas merged to [master].Commit:(In reply to Eclipse Genie from)No, Genie. That commit is not for this bug, it just mentions this bug's number in its title.We should not enable new experimental options by default and let users be the guinea pigs.The jdt.core repo contains about 20 such problems, and jdt.ui over 100. We first have scrutinize at least these invocations and be sure they are really problematic. That will also tell us if we should provide Quick Fixes for common problem patterns.Stephan, can you please disable the main option for M6?Some analysis of reported warnings:org.eclipse.jdt.coretotal: 8 warnings- 2 real bugs- 6 cases pass a value of a super type of the expected type This is a (probably unconscious) shorthand for an instanceof check plus castLet's check if just flipping the sub-option gives an even better ratio:- 2 warning are of the severe form "cannot be cast"- 6 warnings say "is incompatible with"Unfortunately, only 1 of the 2 bugs is in the "uncastable" group.The other "uncastable" problem concerns a removeAll() invocation, where we could possibly relax the warning by comparing element types instead of collection types.OTOH, we have a bug that escapes the weaker form of the warning. This happens, because an interface is involved, and hence types are considered as castable although totally unrelated.That would mean for the small sample of o.e.j.core by flipping the sub-option we could reduce the number of reports to 1, with 0 false positives but 1 false negative.It probably depends on how you look at the 6 cases that are not strictly bugs (from a cursory look most of the warnings in jdt.ui also fit into this group). I personally think those reports are still interesting, but I know that many users will not agree.=====When I started working on this bug I didn't expect this to be controversial (otherwise I would have started earlier), but seeing the request to disable by default I will simply revert this feature for Mars and start a discussion early after Mars. This will give us time to sharpen the analysis for the best possible hit-ratio.I don't want to publish yet another warning that is off-by-default and is wasted to most users. Remember, switching the default after initial release doesn't reach any users that already persisted the preferences in their projects.New Gerrit change created:New Gerrit change created:New Gerrit change created:(In reply to Stephan Herrmann from)Absolutely - it's very common for example to go Set<T>.removeAll(List<T>), e.g. if we were iterating over the set and couldn't modify it until we finished. Definitely worth refining.Presumably because the compiler can't rule out that the class may have a subtype that implements the interface. One possible, pretty simple, refinement could be, "Accept arguments that are a supertype of the expected type."Agreed!Gerrit changewas merged to [master].Commit:(In reply to Ben Davis from)It's not about Set<T> vs. List<T> (both conform to Collection<T>), but about Collection<Super> vs. Collection<Sub>. A Collection<Super> is not castable to Collection<Sub>, but each contained element Super, is castable to Sub - which may be enough for the invocation to do s.t. useful.A fix to add when this is resurrected:Javadoc of org.eclipse.jdt.core.JavaCore.COMPILER_PB_DISCOURAGED_INVOCATION_ACCEPT_CASTABLE_ARGUMENT had typos in "Possible values" and "Default":Said e.g. "enable" instead of "enabled".(In reply to Stephan Herrmann from)The check in this ticket (including the corresponding "equals"-check) is for the main kind of easily avoidable, common and still hard to find bug that is currently not reported by eclipse (but is reported by intellij, netbeans and of course by findbugs, but this is awkward and slow by comparison to a build-in check in eclipse)It's a shame this didn't make into Mars, but I guess its already past "early after Mars", so maybe you please start the discussion so it could hopefully make into the next milestone :-)Maybe the default level could simply be the new "info"-level?(In reply to Till Brychcy from)I'm all ears. I think I've put enough information regarding my understanding of the issue into previous comments.Markus, are you still interested in this feature?(In reply to Stephan Herrmann from)Markus is on vacation for a week or so. So, it could be a while before we get a response.(In reply to Jay Arthanareeswaran from)Markus, are you back?I'm back, but I'm afraid I won't have time for bigger feedback rounds or test/fix passes. If you think you have a solution that doesn't trigger many false positives, then I'm OK with releasing it with Info severity by default.Please review it with a code base that actually uses typed collections. In jdt.core, many collections are still raw or the code uses arrays or internal data structures. The platform.text repo could be a good test case. jdt.ui still has unavoidableGenericTypeProblems=disabled and uses raw types from jdt.core and jface APIs.(In reply to Markus Keller from)Thanks. Before I invest more time, I still need to check with you:Raising problems only in situations that are certain not to be false positives and setting severity to Info will be lame, for two reasons:(1) For a small fraction (not-castable types) we can be quite sure of detecting real bugs. Here anything below Warning severity would be wrong IMHO. (Programs could still work due to equals/hashCode hacks, but we have no chance to sift these cases out anyway).(2) For the majority of situations we indeed cannot clearly distinguish "false positives" from useful reports.I'm willing to continue work if we agree that- not-castable types are reported as warnings- at info level it's OK to raise "false positives"Within the latter group, some fine tuning may still be possible, but each match in this group could be an intentional abbreviation for if (k instanceof ElementType) set.remove((ElementType) k);If from this we would conclude, that "set.remove(k)" must not be flagged for castable types, then I don't think the whole thing would be worth the effort and we should close this as WONTFIX (which would only be the last resort if we can't agree better).I'm very sorry to say: considering the expectations expressed inI am not able to provide an implementation of a very useful analysis.This is a great pity after the work that has already gone into it and given that such a validation should be expected from any Java IDE.What?! Resolved as WONTFIX? Design by committee at its finest.Suuuuurely to goodness, an off-by-default warning is better than just giving up entirely?Verified for 4.6 M6New Gerrit change created:(In reply to Eclipse Genie from)@Stephan, as discussed at EclipseCon Ludwigsburg last year, I think this is badly missing in Eclipse and I have rebased your (great!) patch which already solved all the hard parts and worked on it to find "a solution that doesn't trigger many false positives".(In reply to Stephan Herrmann from)See 1)See 2)Patch set 1 just contains the rebased patch with some conflicts resolved (bits & problem ids)I've tested the patch against a few workspaces including a workspace with nearly 500 projects that are in the git repositories checked out in a eclipse.platform.releng.aggregator-build (details see below, more than 40000 classes) and another workspace with more than 800 projects and 30000 classes.1) As Stephan already noted, applying the type compatibility check directly on the arguments is too restrictive for methods like removeAll because collection of a type is not a supertype of a collection of subtype, so it helps to compare the type arguments in this case, which needed a change of the message reported.2) In a lot of projects, disabling "Accept arguments that could be cast to the expected type" gives too many false problem reports, e.g. because of collections of a subtype, because of wildcards, or in classes that implement collection interfaces themselves. But as Stephan wrote, enabling "Accept arguments that could be cast to the expected type" disables the check for all invocations, where the collection type is not a final class and the argument type is an "unrelated" interface. But many usages of this kind I have observed where bugs.To improve the situation, I have played with the check for allowed types and looked at the actual bugs found .Many bugs that were found fall into the following categories:- confusion of a type and a "primary key" member of it. This kind of bug is sometimes not reported, if all castable classes are accepted.- confusion of key and value types of maps (or confusion of respective methods). This also happens in generic code where both types are type variables.- confusion of arrays and their elementsSo I have arrived at the following check, which leads to good results:"Take the erasure of both types (unless both are true type variables, i.e. not captures) and then compare if they are compatible in either direction."This is a bit similar, but different to "Accept arguments that could be cast to the expected type", so I have removed that option for now (we can still introduce a kind of "strict"-mode later)With this new condition and the change for removeAll all actual bugs if have seen are still reported and only very few false alarms appear.Some other things I have added:- Implement the check for method references. This, and the change for removeAll etc. made it necessary to alter the wording of the problem messages (e.g. avoid the word "invocation")- Implement the check for "equals", too (see), including java.utils.Objects.equals(a,b). With the same check as described above, many bugs are reported, but there are more false reports, as implementations of equals() that actually allow different argument types are rare, but not completely uncommon.The message for collection methods is now:"Unlikely argument type String for contains(Object) on a Collection<Short>""Unlikely argument type Set<String> for removeAll(Collection<?>) on a Collection<Number>For equals, not the declaring type of the equals-method is reported but the instance/other argument type:"Unlikely argument type for equals(): Integer seems to be unrelated to String"All of this is contained in patch set 2.The next section contains a detailed comparison of patch set 1 (with "Accept arguments that could be cast to the expected type" enabled) with patch set 2 in a workspace with most projects contained in the git repos checked out in a eclipse.platform.releng.aggregator-build (as of 12. Feb 2017, excluding platform-specific code, embedded test projects and some emf-related code, that need dependencies not contains in those git-repos) - only for the collection methods, not for equals().I've grouped the reported problems into three groups.A: Locations that are reported by patch set 2, but not by patch set 1.B: Locations reported in patch set1, but are not in patch set 2. They are variations of removeAll. None of them seemed to be a bug for me.C: Locations that are reported both by patch set 1 and patch set 2.-----------Group A: New in patch set 2: 9 additional bugs found, 6 false alarms added--------------------BUGS: (confusion of key and values or the respective methods):ConsumerReportConvertor.java /org.eclipse.pde.api.tools/src/org/eclipse/pde/api/tools/internal/search line 201 Java ProblemEventListeners.java /org.eclipse.osgi/supplement/src/org/eclipse/osgi/framework/eventmgr line 71 Java ProblemInternalSearchUI.java /org.eclipse.search/new search/org/eclipse/search2/internal/ui line 117 Java ProblemManyToMany.java /org.eclipse.jdt.compiler.apt/src/org/eclipse/jdt/internal/compiler/apt/util line 314 Java ProblemManyToMany.java /org.eclipse.jdt.apt.core/src/org/eclipse/jdt/apt/core/internal/util line 315 Java ProblemRecentSettingsStore.java /org.eclipse.jdt.ui/ui/org/eclipse/jdt/internal/ui/javadocexport line 96 Java ProblemBUGS: (other)DragHost.java /org.eclipse.e4.ui.workbench.addons.swt/src/org/eclipse/e4/ui/workbench/addons/dndaddon line 138 Java Problem- should remove from getWindows() not from getChildren()ResourceToItemsMapper.java /org.eclipse.jdt.ui/ui/org/eclipse/jdt/internal/ui/viewsupport line 125 Java Problem- should remove resource, not listResourceToItemsMapper.java /org.eclipse.search/search/org/eclipse/search/internal/ui line 138 Java Problem- should remove resource, not listNOT BUGS:ChangeCollector.java /org.eclipse.jdt.core/model/org/eclipse/jdt/internal/core/hierarchy line 371 Java Problem- CompilationUnit extends Openable which extends JavaElement and implements IOpenableFragmentExtractHelper.java /org.eclipse.e4.tools/src/org/eclipse/e4/internal/tools/wizards/model line 53 Java ProblemModelAssembler.java /org.eclipse.e4.ui.workbench/src/org/eclipse/e4/ui/internal/workbench line 407 Java Problem- e.g. ApplicationElementImpl implements EObject and MApplicationElementRuntimeClasspathViewer.java /org.eclipse.jdt.debug.ui/ui/org/eclipse/jdt/internal/debug/ui/classpath line 144 Java Problem- ClasspathEntry extends AbstractClasspathEntry which implements IClasspathEntry and implements IRuntimeClasspathEntrySourceReferenceUtil.java /org.eclipse.jdt.ui/core refactoring/org/eclipse/jdt/internal/corext/refactoring/reorg line 54 Java Problem- e.g. Member extends SourceRefElement implements IMemberTypeHierarchy.java /org.eclipse.jdt.core/model/org/eclipse/jdt/internal/core/hierarchy line 1045 Java Problem- already guarded by instanceof ClassFile which extends Openable--------- Group B: Reported by patch set 1, not any more in patch set 2----------------NOT BUGS: removeAll etc for collections of subtypes/supertypeAbstractWorkingSetWizardPage.java /org.eclipse.jdt.ui/ui/org/eclipse/jdt/internal/ui/workingsets line 482 Java ProblemIdentityMapTest.java /org.eclipse.jface.tests.databinding/src/org/eclipse/core/tests/internal/databinding line 342 Java ProblemIdentityMapTest.java /org.eclipse.jface.tests.databinding/src/org/eclipse/core/tests/internal/databinding line 346 Java ProblemIdentityMapTest.java /org.eclipse.jface.tests.databinding/src/org/eclipse/core/tests/internal/databinding line 383 Java ProblemIdentityMapTest.java /org.eclipse.jface.tests.databinding/src/org/eclipse/core/tests/internal/databinding line 393 Java ProblemIndexerTest.java /org.eclipse.jdt.core.tests.model/src/org/eclipse/jdt/core/tests/nd/indexer line 255 Java ProblemJarManifestWizardPage.java /org.eclipse.jdt.ui/ui/org/eclipse/jdt/internal/ui/jarpackager line 638 Java ProblemJarManifestWizardPage.java /org.eclipse.jdt.ui/ui/org/eclipse/jdt/internal/ui/jarpackager line 643 Java ProblemLaunchDelegateTests.java /org.eclipse.jdt.debug.tests/tests/org/eclipse/jdt/debug/tests/launching line 178 Java ProblemLaunchModeTests.java /org.eclipse.jdt.debug.tests/tests/org/eclipse/jdt/debug/tests/launching line 191 Java ProblemLaunchModeTests.java /org.eclipse.jdt.debug.tests/tests/org/eclipse/jdt/debug/tests/launching line 204 Java ProblemMenuManagerRenderer.java /org.eclipse.e4.ui.workbench.renderers.swt/src/org/eclipse/e4/ui/workbench/renderers/swt line 1084 Java ProblemMenuManagerRenderer.java /org.eclipse.e4.ui.workbench.renderers.swt/src/org/eclipse/e4/ui/workbench/renderers/swt line 1091 Java ProblemMenuManagerRenderer.java /org.eclipse.e4.ui.workbench.renderers.swt/src/org/eclipse/e4/ui/workbench/renderers/swt line 1098 Java ProblemModuleResolver.java /org.eclipse.osgi/container/src/org/eclipse/osgi/container line 1140 Java ProblemModuleResolver.java /org.eclipse.osgi/container/src/org/eclipse/osgi/container line 944 Java ProblemModuleResolver.java /org.eclipse.osgi/container/src/org/eclipse/osgi/container line 945 Java ProblemPullUpRefactoringProcessor.java /org.eclipse.jdt.ui/core refactoring/org/eclipse/jdt/internal/corext/refactoring/structure line 947 Java ProblemRemoveFromBuildpathAction.java /org.eclipse.jdt.ui/ui/org/eclipse/jdt/internal/ui/wizards/buildpaths/newsourcepage line 161 Java ProblemRemovedImportCommentReassigner.java /org.eclipse.jdt.core/dom/org/eclipse/jdt/internal/core/dom/rewrite/imports line 150 Java ProblemReorgPolicyFactory.java /org.eclipse.jdt.ui/core refactoring/org/eclipse/jdt/internal/corext/refactoring/reorg line 2233 Java ProblemTargetLocationsGroup.java /org.eclipse.pde.ui/src/org/eclipse/pde/internal/ui/shared/target line 381 Java ProblemToolBarManagerRenderer.java /org.eclipse.e4.ui.workbench.renderers.swt/src/org/eclipse/e4/ui/workbench/renderers/swt line 966 Java ProblemTypesConfigurationArea.java /org.eclipse.ui.ide/src/org/eclipse/ui/internal/views/markers line 426 Java ProblemWorkingSetDropAdapter.java /org.eclipse.jdt.ui/ui/org/eclipse/jdt/internal/ui/packageview line 260 Java Problem--- Group C: Reported by both patch set 1 and patch set 2: 17 Bugs, 2 Non-Bugs--------------------BUGS: (confusion of key and values or the respective methods):BaseMessageRegistry.java /org.eclipse.e4.core.services/src/org/eclipse/e4/core/services/nls line 307 Java ProblemLogicalPackagesProvider.java /org.eclipse.jdt.ui/ui/org/eclipse/jdt/internal/ui/browsing line 129 Java ProblemProvisioningContext.java /org.eclipse.equinox.p2.engine/src/org/eclipse/equinox/p2/engine line 168 Java ProblemSourceLookupFacilityTests.java /org.eclipse.debug.tests/src/org/eclipse/debug/tests/sourcelookup line 313 Java ProblemTest_org_eclipse_swt_program_Program.java /org.eclipse.swt.tests/JUnit Tests/org/eclipse/swt/tests/junit line 160 Java ProblemBUGS: otherAbstractPDELaunchConfiguration.java /org.eclipse.pde.launching/src/org/eclipse/pde/launching line 203 Java Problem- string used as keyBaseMessageRegistry.java /org.eclipse.e4.core.services/src/org/eclipse/e4/core/services/nls line 231 Java Problem- "this" is the PrivilegedAction, not the MessageConsumer NdNodeTypeRegistry.java /org.eclipse.jdt.core/search/org/eclipse/jdt/internal/core/nd line 39 Java Problem- should be this.types.containsKey(shortTypeId)ProductFile.java /org.eclipse.equinox.p2.publisher.eclipse/src/org/eclipse/equinox/internal/p2/publisher/eclipse line 437 Java Problem- string used as argumentRequiredPluginsClasspathContainer.java /org.eclipse.pde.core/src/org/eclipse/pde/internal/core line 380 Java Problem- string used as argumentTestReporter.java /org.eclipse.pde.api.tools.tests/src/org/eclipse/pde/api/tools/search/tests line 59 Java Problem- argument is not a string. maybe String.valueof should be applied to it?BUGS: confusion of array with array elementBoundSet.java /org.eclipse.jdt.core/compiler/org/eclipse/jdt/internal/compiler/lookup line 1259 Java Problem- should be get(iv) instead of get(outerVariables)CallHistory.java /org.eclipse.ui.tests.harness/src/org/eclipse/ui/tests/harness/util line 129 Java Problem- should be methodNameBUGS: confusion of type with member of it:LaunchConfigurationManager.java /org.eclipse.debug.ui/ui/org/eclipse/debug/internal/ui/launchConfigurations line 751 Java Problem- should be types.contains(type.getIdentifier())NewJavaProjectWizardPageTwo.java /org.eclipse.jdt.ui/ui/org/eclipse/jdt/ui/wizards line 337 Java Problem- should be fOrginalFolders.contains(child)Product.java /org.eclipse.pde.core/src/org/eclipse/pde/internal/core/product line 647 Java Problem- should be fFeatures.contains(features[i])VariableCreationDialog.java /org.eclipse.jdt.ui/ui/org/eclipse/jdt/internal/ui/wizards/buildpaths line 98 Java Problem- should be remove(element)NOT BUGS: (but actually interesting warnings)ApiFiltersPropertyPage.java /org.eclipse.pde.api.tools.ui/src/org/eclipse/pde/api/tools/ui/internal/properties line 340 Java Problem- not a bug, but surprising: CommentChange delegates equals to its filter member - an example for the kind of code that leads to false alarms for the equals()-check.SetBindingTest.java /org.eclipse.jface.tests.databinding/src/org/eclipse/core/tests/databinding line 80 Java Problem- it seems like the remove call intentionally tries to remove an object that cannot be contained in the test.--------------------Summary:Patch set 2 finds 26 bugs and gives 8 false alarms. The results in my other workspaces were similar, with even fewer false alarms per bug found.For equals(), I haven't done a detailed analysis, but the absolute number of bugs found was lower, and the ratio of false alarms was a bit higher.I have set the default level for both to "INFO" (though i will set them to "WARNING" in my workspaces)The test failures in BatchCompilerTest.test330_warn_options() and BatchCompilerTest.test331_warn_options() are because there is currently no way to disable "INFO"s for the batch compiler. I guess this should be discussed in bug.Thanks, Till for your huge efforts.With all the real bugs the analysis detects, this may well become a huge success story.With your improvements and the facts to back our claims, it would be a shame to release this with severity below WARNING. Remember we have a @SW token to silence any "unwanted" warnings.@Markus, do you care to comment?	50.0
id=332644	REOPENED	Platform	UI	3.1	All All	P3 major	Remy Suen	2010-12-15 10:33 EST by	Remy Suen	2011-03-31 09:34 EDT (	1 user	Every time you hit Ctrl+E with editors opened and you hide the shell by granting focus to another control, we are leaking a shell. The shells will only get disposed when you actually close the workbench window itself.	CreatedDefaultPartList patch v1Dispose the shell instead of making it when it gets deactivated.(In reply to)Fix released to CVS HEAD.Verified by source inspection with I20110124-1800.1. Open an editor.2. Ctrl+E3. Alt+Tab to another window.4. Alt+Tab back to Eclipse.5. Ctrl+E does nothing.It may be that the disposal is causing issues with the source providers. I'll rollback this change tomorrow.(In reply to)Change rolled back due to. Will look at this again later.(In reply to)This is not related to source providers. The problem is that the focus is not returned to styled text (no caret) though Caret.setFocus() is called. This looks like an SWT issue to me. A possible ugly workaround would be to do the dispose in an asyncExec.(In reply to)Thanks for investigating, Dani! This is quite interesting. Perhaps I can draw up a snippet that will reproduce the problem.Indeed. I tried this while I was verifying thatwas caused by this change and the asyncExec workaround does work.(In reply to)I have openedfor this problem.*** This bug has been marked as a duplicate of***(In reply to)Actually Dani, I would like to keep this bug open.If SWT fixes the problem, I still need to deliverback to HEAD so that the shell is actually disposed.(In reply to)Yes, of course: me too. I wanted to mark it as depends on, but obviously was to fast/lazy.Verified thatis no logger bugged with I20110127-2034 on Windows XP.Not clear if SWT will fixfor 3.7. Unsetting the target milestone.	13.0
id=410292	REOPENED	Platform	UI	4.3	PC Windows 7	P3 normal	René Brandstetter	2013-06-09 17:20 EDT by	Jonas Helming	2016-05-12 04:16 EDT (	6 users	As pointed out in severeal newsgroup discussions, there is no easy and clean way to exchange the IWindowCloseHandler for specific windows. (same for the ISaveHandler).This feature is useful, e.g. in the following use case:The application has a second window. If this window is closed, the latest state, e.g. psoition perspective should be persisted. Therefore the window should be set to "toBeRendered" false instead of closing it, which will remove it from the workbench model. A work-aorund is described here:I have opened this BR to discuss possible solutions. As a first step, it should be avoided that the WBR overrides the IWindowCloseHandler, if you simple add it with an event listener.However, I think in general there is no easy way of enhancing the context of an element, which is not thereOne idea which comes to my mind is to extend the application model with something called context element, which can be contained by elements having an own context. These elements would be filled into the context after the context of an element has been created.Alternativly there could be something like ContextProcessors.What do other people think?	The context for rendering an element is its IEclipseContext. That's where localized data that's needed during runtime is stored (that's not directly generated by the element's contribution itself).PWPaul,that is correct, but the question is how to enhance the context of an element(In reply to)For Strings, they can be added to the MContext model objects (AFAIK).But for runtime objects (like the handlers), right now the only way I know of is to use a processor to register an event listener or model listener, listening for MContext/context to go from null to the IEclipseContext. Then you can add extra information.PWNew Gerrit change created:Createdtest addonsThe changes of my gerrit commitwill register only one IWindowCloseHandler or ISaveHandler in the application#context. This allows an easier change of the default handlers with just an add-on which subscribes to the UILifeCycle.APP_STARTUP_COMPLETE event (this is shown in the attached zip-file).With the registration of only one handler at the application#context level it is also possible to substitute them for particular windows with just adding a new IWindowCloseHandler or ISaveHandler in the appropriate window#context level. The rest will be done by the hierarchical nature of the IEclipseContext.BTW, the ISaveHandler implementation is not optimal because the current API and implementations are a little bit wierd, because it contains methods for just prompting to save (promptToSave()-methods) and the save-method also contain a flag to prompt for a save. So what is the purpose of the ISaveHandler? - Should it be just a way to change the prompting-behavior or should it be a way to change the way a part is saved?Explanation of the attached zip:It contains a small plug-in which adds two add-ons via an e4-model-fragment. The add-ons will be registered to "Contacts-Demo" (id=org.eclipse.e4.demo.contacts.application) which is also part of the platform-git repo.CustomSaveHandlerAddon - is an add-on which replaces the ISaveHandler with a custom prompt UIAskOnEveryWindowCloseAddon - will ask on every window close (regardless if it's detachted, created via applcation-model or the main window) if it should be closedThe plug-in also contains an other add-on which is not installed (and so not running) but the code shows some other implementation of an IWindowCloseHandler. The "WindowCloseHandlerAddon" class contains code which will show a different close-dialog only when the main window is closed and leaves the default close-behavior on the other windows.Lars, you started to comment on the change. Please either review during M7 or move to 4.7.Gerrit changewas merged to [master].Commit:Thanks a lot René, I'm very sorry that it took me forever to review this one.(In reply to Lars Vogel from)Looks like this caused.New Gerrit change created:Gerrit changewas merged to [master].Commit:	12.0
id=459664	REOPENED	Platform	Debug	4.4.1	PC Windows 7	P3 normal	Richard Birenheide	2015-02-11 09:47 EST by	Richard Birenheide	2016-05-09 07:28 EDT (	1 user	Extending my IDebugModelPresentation to an IInstructionPointerPresentation leads to the stack trace below when the debugger halts at a breakpoint.I return an own annotation type inheriting from "org.eclipse.debug.ui.currentIP" when getInstructionPointerAnnotationType(IEditorPart, IStackFrame) is called. The same error occurs when I return the platforms own annotation type using IDebugUIConstants.ANNOTATION_TYPE_INSTRUCTION_POINTER_CURRENT.A quick check on what happens suggests that I can't avoid this by returning an annotation as it must inherit from the class for which the cast fails.!ENTRY org.eclipse.ui 4 0 2015-02-11 15:43:29.150!MESSAGE Unhandled event loop exception!STACK 0org.eclipse.swt.SWTException: Failed to execute runnable (java.lang.ClassCastException: org.eclipse.debug.internal.ui.DynamicInstructionPointerAnnotation cannot be cast to org.eclipse.debug.internal.ui.InstructionPointerAnnotation) at org.eclipse.swt.SWT.error(SWT.java:4441) at org.eclipse.swt.SWT.error(SWT.java:4356) at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:139) at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:4147) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3764) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1151) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:1032) at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:148) at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:636) at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:579) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:150) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:135) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:134) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:104) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:380) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:235) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:601) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:648) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:603) at org.eclipse.equinox.launcher.Main.run(Main.java:1465) at org.eclipse.equinox.launcher.Main.main(Main.java:1438)Caused by: java.lang.ClassCastException: org.eclipse.debug.internal.ui.DynamicInstructionPointerAnnotation cannot be cast to org.eclipse.debug.internal.ui.InstructionPointerAnnotation at org.eclipse.debug.internal.ui.InstructionPointerImageProvider.getManagedImage(InstructionPointerImageProvider.java:26) at org.eclipse.ui.texteditor.DefaultMarkerAnnotationAccess.getImage(DefaultMarkerAnnotationAccess.java:377) at org.eclipse.ui.texteditor.DefaultMarkerAnnotationAccess.paint(DefaultMarkerAnnotationAccess.java:264) at org.eclipse.jface.text.source.AnnotationRulerColumn.doPaint(AnnotationRulerColumn.java:692) at org.eclipse.jface.text.source.AnnotationRulerColumn.doubleBufferPaint(AnnotationRulerColumn.java:543) at org.eclipse.jface.text.source.AnnotationRulerColumn.redraw(AnnotationRulerColumn.java:824) at org.eclipse.jface.text.source.AnnotationRulerColumn$6.run(AnnotationRulerColumn.java:807) at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35) at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:136) ... 24 more	Richard,Can you explain how are you extending my IDebugModelPresentation to an IInstructionPointerPresentation ? Providing an example with steps to produce this exception will help.In Debug code :IInstructionPointerPresentation extends IDebugModelPresentation andInstructionPointerAnnotation extends DynamicInstructionPointerAnnotationCreatedImplementation of IInstructionPointerPresentationPlease find attached an implementation of the interface.Culprit is org.eclipse.debug.internal.ui.DelegatingModelPresentation#getInstructionPointerAnnotation(IEditorPart, IStackFrame). If one does not provide an annotation (which must be a subclass of org.eclipse.debug.internal.ui.InstructionPointerAnnotation.InstructionPointerAnnotation(IStackFrame, String, String, Image) to avoid the ClassCastException) a org.eclipse.debug.internal.ui.DynamicInstructionPointerAnnotation.DynamicInstructionPointerAnnotation(IStackFrame, String, String) is created which can't be cast. The simplest fix would be to replace the lines:if (defaultAnnotation) { annotation = new InstructionPointerAnnotation(frame, id, text, image); } else { annotation = new DynamicInstructionPointerAnnotation(frame, id, text); }with:annotation = new InstructionPointerAnnotation(frame, id, text, image);as the image can be null, the framework will then take the default image.However, this would not exactly match the contract of IInstructionPointerPresentation as in this case an annotation type returned by getInstructionPointerAnnotationType will not be honored (this should be taken from the annotation preferences).You might want to have a look into org.eclipse.ui.texteditor.DefaultMarkerAnnotationAccess#getImage(Annotation, AnnotationPreference, String) in how to handle image retrieval for the annotation.CreatedPatch for InstructionPointerImageProviderI suggest the attached patch. This will not only solve the problem for providing an id from an IInstructionPointerPresentation but also the problem when providing an own annotation from the same interface.Just discovered a workaround until the patch is submitted:Define a org.eclipse.ui.editors.markerAnnotationSpecification for your annotation. Define an own annotationImageProvider, which the editor framework will use instead of InstructionPointerImageProvider.If your annotationType provides this it is safe to return your annotationType from org.birenheide.bf.debug.ui.BfDebugModelPresentation#getInstructionPointerAnnotationType(IEditorPart, IStackFrame) or an annotation implementation of your choice from org.birenheide.bf.debug.ui.BfDebugModelPresentation#getInstructionPointerAnnotation(IEditorPart, IStackFrame).Richard,Can you please sign CLA and write into this bug:"This contribution complies with"Here you go:This contribution complies withRegardsRichardThanks Richard!!Pushed viaThe patch you committed does not exactly match my proposal. The committed class will fail to show an image for a client provided annotation, be it via getInstructionPointerAnnotationType(IEditorPart, IStackFrame) or via etInstructionPointerAnnotation(IEditorPart, IStackFrame).Is there any reason why you didn't copy over the the propsed changes for methods:public String getImageDescriptorId(Annotation) andpublic ImageDescriptor getImageDescriptor(String) as proposed in?RegardsRichard(In reply to Richard Birenheide from)We generally put the annotation type and descriptor in the ImageRegistry. Will also appreciate a testcase for this support.(In reply to Sarika Sinha from)Which ImageRegistry do you prefer?org.eclipse.debug.ui defines at least two, one in DebugPluginImages and one in DebugUIPlugin. I'd suggest the latter.The editor plugin uses org.eclipse.ui.internal.editors.text.EditorsPlugin#getImageRegistry() for storing annotation images but this is an internal class which shouldn't be used be the debug plugin, I assume.A test case is very difficult to provide without a full blown debugger implementation. I tested the changes proposed against my debugger. A test case would need to run the debugger with fully setup UI.(In reply to Richard Birenheide from)I've just seen, that both refer to the same. Please disregard my.CreatedPatch for InstructionPointerImageProvider #2Changed patch to use DebugPluginImages ImageRegistry.Will appreciate a simple test case ( not a full blown debugger) in which we can test that it is using this new code snippet properly.Ping!!	14.0
id=502841	REOPENED	Platform	UI	4.7	PC All	P3 normal	Rüdiger Herrmann	2016-09-30 06:29 EDT by	Rüdiger Herrmann	2017-02-06 05:20 EST (	4 users	Expanding all items of a tree is fairly slow. But worse, when calling TreeViewer::expandAll() on a tree with an average amount of items, the cursor flickers while changing from arrow to hour-glass during the whole process.Run the snippet below and select the 'Expand All' button. Don't move the mouse cursor and see how the pointer constantly changes.public class TreeViewerExpandBug { public static void main( String[] args ) { Display display = new Display(); Shell shell = new Shell( display ); shell.setLayout( new GridLayout() ); TreeViewer treeViewer = new TreeViewer( shell, SWT.VIRTUAL ); treeViewer.setContentProvider( new TreeNodeContentProvider() ); treeViewer.setLabelProvider( new LabelProvider() ); treeViewer.setInput( createTreeModel( null, 5 ) ); treeViewer.getControl().setLayoutData( new GridData( SWT.FILL, SWT.FILL, true, true ) ); Button button = new Button( shell, SWT.PUSH ); button.setText( "E&xpand All" ); button.addListener( SWT.Selection, event -> treeViewer.expandAll() ); button.setLayoutData( new GridData( SWT.FILL, SWT.CENTER, true, false ) ); shell.open(); while( !shell.isDisposed() ) { if( !display.readAndDispatch() ) display.sleep(); } display.dispose(); } private static TreeNode[] createTreeModel( TreeNode parent, int depth ) { TreeNode[] treeNodes = new TreeNode[ 10 ]; for( int i = 0; i < treeNodes.length; i++ ) { treeNodes[ i ] = new TreeNode( new Object() ); treeNodes[ i ].setParent( parent ); for( int k = 0; k < depth; k++ ) { createTreeModel( treeNodes[ i ], depth - 1 ); } } if( parent != null ) { parent.setChildren( treeNodes ); } return treeNodes; }}AbstractTreeViewer::createChildren() runs the tree item creation code within a BusyIndicator.showWhile() which I think is causeing the described behavior.	Gerrit reviews welcome(In reply to Lars Vogel from)Would you accept a change that removes the BusyIndicator.showWhile() around the item-creation code?(In reply to Rüdiger Herrmann from)Sounds reasonable, but our team would need to see this in Gerrit. Gerrit will also run the JFace viewer unit tests.I've submitted a patch:However, the build fails due to a compile error in org.eclipse.e4.ui.di:Any idea?New Gerrit change created:Digging in the history of platform UI, the BusyIndicator.showWhile was added via. But as BusyIndicator.showWhile does not do any additional protection, e.g., like using a SafeRunnable, I think it is save to remove it.(In reply to Lars Vogel from)Nope, this was viacommitPlease re-test the original issue described inand if this is still observable with/without the patch.(In reply to Andrey Loskutov from)Right, the change would have broken the fix for. I've uploaded a new patch that moves the BusyIndicator::showWhile() to a place where it is only shown when a user triggers the tree expansion.Mass move to M4.Sorry for the delay in review. Reviewing the patch now.Gerrit changewas merged to [master].Commit:Thanks Rüdiger for the patch and sorry for the long delay in review.New Gerrit change created:Gerrit changewas merged to [master].Commit:New Gerrit change created:Fixed caused test errors. Reverted to investigate.(In reply to Lars Vogel from)I re-ran some of the failing tests locally (e.g. o.e.jface.tests.viewers.AllTests) and they succeeded. I doubt that the build failed because of this change. Looking at the history of the Gerrit change (), it looks like the build failed earlier for reasons unrelated to this change. Back then, re-running the build seemed to help.(In reply to Rüdiger Herrmann from)shows twice the failing tests. I rebased it again to verify.(In reply to Lars Vogel from)Still failing. Rüdiger, can you please have a look?	19.0
id=57580	REOPENED	JDT	Debug	3.0	All All	P3 enhancement	Sarika Sinha	2004-04-06 10:18 EDT by	Alex Blewitt	2016-06-01 11:56 EDT (	22 users	It would be really useful if the watch expression editor in the debugger could take advantage of code-completion	Deferred. The editor is used for all debuggers, and thus does not have a "content assist" context.Verified closed in 3.0 final on Mac OS X.Oops. Updated wrong bug.Returned to 'resolve later'***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***This enhancement request has been open since 2004.Are there any plans to do anything about it?It borders on being classified as a bug.It is quite frustrating to have to edit expressions in the Display view and then copy them to the expressions view, and feels inconsistent with the general eclipse experience.I understand that the view is used for debugging in non-java contexts, however there must be a creative solution for that. At worst, create a new java-expressions view with code completion.***has been marked as a duplicate of this bug. ***There are plenty of duplicated bugs for this, but this is still in a deprecated status. It's quite absurd that Eclipse doesn't give code completion in the "edit watch expression" dialog...Please reopen this enhancement request and take it into consideration!Mauro.I agree, this is actually one of the reasons, I will move away from using Eclipse.Could the JDT team at least REOPEN this enhancement request???Later used to mean "future consideration". Open means the same thing, unless it gets assigned a milestone...***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***This would be useful. .Net and Visual Studio has this :-)Pretty necessary. Eclipse will not be usable for debugging until this is resolved.This auto complete bug is absurd, considering it was open in 2004.The eclipse debugger, sad to say, is just light years of being at the level of the netbeans debugger.I find myself, time and time again, using the Java Editor to write the expressions with a working autocomplete working to copy paste them to the eclipse "Expressions" view because of this bug.It would be nice to see this issue gone after .... 12 years.12 years!!!!!!!This auto complete bug is absurd, considering it was open in 2004.The eclipse debugger, sad to say, is just light years of being at the level of the netbeans debugger.I find myself, time and time again, using the Java Editor to write the expressions with a working autocomplete working to copy paste them to the eclipse "Expressions" view because of this bug.It would be nice to see this issue gone after .... 12 years.12 years!!!!!!!Could you use the display tab, which has autocomplete, to create the code you want to add to the watch expression?CreatedAutocomplete in expressionsThis isn't convenient to open additional tab. Actually autocomplete is already implemented in the bottom area of expressions window (see "autocompele in expressions"). Is it difficult to add this autocomplete to field and "Add watch expression" dialog?Actually, that seems like an unintended side effect since it seems to only work as an editor with something that isn't valid and gives you the <error(s) during the evaluation> message. If you have something that is valid, the toString for it displays on the bottom part and you can't type and autocompleteNo. If I have something that is valid, the toString for it displays on the bottom part. That's true. But I can type and autocomplete	28.0
id=473081	REOPENED	Platform	Debug	4.5	PC Linux	P3 normal	Sarika Sinha	2015-07-20 09:24 EDT by	Tobias Hirning	2016-04-25 03:08 EDT (	4 users	Observed on Kubuntu 14.04.2 LTS with GTK 3.10.8 andEclipse Java EE IDE for Web Developers.Version: Mars Release (4.5.0)Build id: 20150621-1200Steps to reproduce:1. Run something that prints to the console.2. Clear the console using the "Clear Console" button.3. Scroll up inside of the now empty console.Observed behaviour:Scroll lock enables automatically.Behaves like there is still one invisible line left.Expected behaviour:Scroll lock does not enable automatically.	We need to check for Start of document the way we check for end Of Document.Fixed viaAdded the check for End Of Document for Page up and similar action to not enable Scroll lock if already at the end of document.Verified usingVersion: Neon (4.6)Build id: I20150803-2000That fix broke the feature completely!1. start a program that writes to console2. lock the console3. scroll up with ARROW_UP, scroll wheel or anything else==> scroll is unlocked, which makes it unusable1. start a program that writes to console3. scroll up with ARROW_UP, scroll wheel or anything else==> auto-scroll lock does not happen ==> can't auto-lock itI've reverted that fix withWill look at it in 4.7	5.0
id=503050	REOPENED	JDT	Debug	4.7	PC Windows 7	P3 major	Sarika Sinha	2016-10-03 06:39 EDT by	Chandrakala MS	2017-01-18 10:39 EST (	5 users	Unable to run a junit test both as a module and as a non-module, I get the below error with eclipse version eclipse-SDK-Y20160908-1000-win32-x86_64 that supports Java9.Error: Could not find or load main class org.eclipse.jdt.internal.junit.runner.RemoteTestRunner<?xml version="1.0" encoding="UTF-8"?><classpath> <classpathentry kind="src" path="src"/> <classpathentry kind="con" path="org.eclipse.jdt.launching.JRE_CONTAINER/org.eclipse.jdt.internal.debug.ui.launcher.StandardVMType/JavaSE-9"/> <classpathentry exported="true" kind="lib" path="/lib.java/junit-4.12/junit-4.12.jar"/> <classpathentry kind="lib" path="/lib.java/junit-4.12/hamcrest-core-1.3.jar"/> <classpathentry kind="output" path="bin"/></classpath>	I can reproduce.Noopur, can you help me with some insight on Junit side as to what's going on? Is the JUnitContainer even resolved properly?org.eclipse.jdt.internal.junit.runner.RemoteTestRunner is the main class which is present in org.eclipse.jdt.junit.runtime bundle. This bundle is specified from the JUnit side in the classpath to org.eclipse.jdt.launching.VMRunnerConfiguration as:.../eclipse.jdt.ui/org.eclipse.jdt.junit.runtime/bin/This is same for both JDK8 and JDK9 projects running the test.Further, the classpath and other passed args from VMRunnerConfiguration are used in org.eclipse.jdt.internal.launching.StandardVMDebugger#run, which eventually gives the specified error from the VM.The command line args passed to the java.lang.Runtime.exec(String[] cmdarray, String[] envp, File dir) method in DebugPlugin#exec are same for both JDK8 and JDK9 projects running the test (except the corresponding path of javaw.exe, which is obvious).Moving to JDT Debug for further analysis.I investigated this and found a problem with the path of the jdt.junit bundle:/C:/JDT/repo/eclipse.jdt.ui/org.eclipse.jdt.junit.runtime/bin/Note the '/' at the beginning.I don't yet know how we end up with this, but I have a vague feeling I have seen this before, albeit long ago.(In reply to Jay Arthanareeswaran from)We get the same for a test being run in a JDK8 project, which runs successfully.(In reply to Jay Arthanareeswaran from)I am afraid that's not the full story. Yes, when I run the command after removing the '/', things are better, but the tests do run fine with the same arguments!(In reply to Jay Arthanareeswaran from)I meant to say, run fine with JRE 8 (same observation as Noopur mentioned)(In reply to Noopur Gupta from)org.eclipse.jdt.internal.junit.runner.RemoteTestRunner comes as the classTolaunch, but classpath does not have junit path or bundle. I don't see any class path as ".../eclipse.jdt.ui/org.eclipse.jdt.junit.runtime/bin/"attaching the classpath input screenshot.CreatedClasspath(In reply to Jay Arthanareeswaran from)Removing the extra '/" in the starting makes it work in Java 9 as well. So some change in JDK behaviour, where it used to work in Java 8 (with or without '/' but not any more in Java 9 with '/'.And JDT UI is getting this url using the method from org.eclipse.core.runtime.FileLocatorFileLocator.toFileURL(url).getFile(); It should be handled at runtime level perhaps as it can cause problems at other places as well with Java9.org.eclipse.core.runtime.FileLocator.toFileURL(url) uses deprecated method File.toURL(); This method was deprecated in Java 6.Java Doc says -Deprecated. This method does not automatically escape characters that are illegal in URLs. It is recommended that new code convert an abstract pathname into a URL by first converting it into a URI, via the toURI method, and then converting the URI into a URL via the URI.toURL method.In ant also, we had to change this to use something like this (URIUtil.toFile(URIUtil.toURI(FileLocator.toFileURL(url))).getAbsolutePath()and making this change in JDT UI works as well to run Junits for JDK 9 and JDK 8 both.I see that FileLocator.toFileURL(url) is being used at several places, so updating this method to make it relevant will make more sense.(In reply to Sarika Sinha from)Added the fix mentioned above to JUnit code in BETA_JAVA9 branch:Verified for BETA_JAVA9 with build Y20161020-1000.Chandra, please let me know if this works for you too.(In reply to Sarika Sinha from)FileLocator#toFileURL(URL) doesn't use that method. Please file a new bug for Platform/Runtime, make it block this bug, and add a stacktrace that shows where File#toURL() is called in this sencario.Also note in that bug that touching this area is very risky. The JDK's handling of "unencoded" URLs was buggy in several places for a long time, and I don't know what the current state is. But I do know that the Eclipse Platform and the SDK are full of hacks that work around the worst issues (e.g. to support paths with spaces). OTOHtells that URIUtil doesn't even know what it's meant for.This is an area where there are only two successful strategies:a) Don't touch anything.b) Thoroughly analyze the problem bottom-up, carefully document any behavior changes (even if they just align the implementation with the spec), and recursively follow all dependencies until you're sure nothing relies on the old behavior any more.Reopening to make suredoesn't get lost.The released hack also needs a comment in the code. Your change only works by chance (or by accident) and that is not a pattern for anybody to use.Also post the JDK9 version that exhibits the problem.could be related. Sarika, please test the scenario in a broken build with VM arg "-Djdk.io.permissionsUseCanonicalPath=true". The change inlooks like it targets exactly the kind of URLs that cause problems here. Maybe that code caused the problem, or maybe it's a workaround for the same underlying problem that broke us.(In reply to Markus Keller from)Tested with jdk-9-ea+140_windows-x64 after reverting the committed fix and using the above VM arg. We get the same error:Error: Could not find or load main class org.eclipse.jdt.internal.junit.runner.RemoteTestRunnerI have tested with this eclipse-SDK-Y20161020-1000-win32-x86_64- Simple junit test worked- Above test as a module worked- But when tried with some other module that has other project dependencies, it failed with compilation errors - import org cannot be resolved. Both build path & .classpath contain the junit jarWill open a new bug for this.This change doesn't depend on Java 9 support in the IDE. It needs to be either reverted in BETA_JAVA9, or also released in master. Currently, P-builds don't contain this change, and it would be wrong to add org.eclipse.jdt.junit.core to the patch feature.New Gerrit change created:Gerrit changewas merged to [master].Commit:(In reply to Eclipse Genie from)Released the change to master branch also with a reference to this bug.	20.0
id=509096	REOPENED	JDT	Debug	4.7	PC Windows 7	P3 normal	Sarika Sinha	2016-12-12 11:38 EST by	Dani Megert	2017-02-07 03:52 EST (	0 users	4.7 M3.From the N&N of M3: The connection limit may be set to a fixed number, or 0And the user knows this how?	(In reply to Dani Megert from)The connection limit may be set to a fixed number, or 0 for unlimited connections.Also using F1 Help - no luck.Help content was changed via.Are you not able to see under Java development user guide > Tasks > Running and Debugging > Remote DebuggingUsing the remote Java application launch configuration The Standard (Socket Listen) connection type listens for incoming connections from a remote VM. It is typically used for debugging an application that spans multiple VMs, such as a distributed system. ◦ In the Port field of the Connect tab, type the port on your local machine where the remote VM should connect to. Generally, your host and this port is specified when the remote VM is launched.◦ In the Connection limit field of the Connect tab, type the number of expected connections, or 0 to support an unlimited number of connections.Does not work for me.It should be explained on the page.The F1 Help gives:Java application launch configurationRemote debuggingLaunching a Java Programand I have to dig long to find the relevant information.This is working as before.This commit has just added an explanation to the Standard (Socket Listen) connection type.	5.0
id=509095	REOPENED	JDT	Debug	4.7	All All	P3 minor	Sarika Sinha	2016-12-12 11:36 EST by	Dani Megert	2017-02-07 03:47 EST (	0 users	4.6 M4Remote Java Application page: missing mnemonics.Port and Connection limit have no mnemonic.	Added mnemonics.Verified usingEclipse SDKVersion: Oxygen (4.7)Build id: I20170123-2000Not good. The same string is also used to display errors on the page and now the '&' appears there. Never use the same NLSed string at different places!Reverted the adding of mnemonics.Will add 15 new NLS strings as currently the label on dialog is used for Error message display. This is an old bug since starting of the Connect tab.	4.0
id=465366	REOPENED	JDT	Debug	4.5	All All	P3 normal	Sarika Sinha	2015-04-24 02:23 EDT by	EPP Error Reports	2016-04-04 06:09 EDT (	2 users	The following incident was reported via the automated error reporting: code: 125 plugin: org.eclipse.jdt.debug_3.9.0.v20150314-0247 message: Internal error logged from JDI Debug: fingerprint: c92ab53e exception class: org.eclipse.debug.core.DebugException exception message: Invalid stack frame number of children: 1 org.eclipse.debug.core.DebugException: Invalid stack frame at org.eclipse.jdt.internal.debug.core.model.JDIStackFrame.getUnderlyingStackFrame(JDIStackFrame.java:1151) at org.eclipse.jdt.internal.debug.core.model.JDIStackFrame.getUnderlyingThisObject(JDIStackFrame.java:789) at org.eclipse.jdt.internal.debug.core.model.JDIStackFrame.getThis(JDIStackFrame.java:1205) at org.eclipse.jdt.internal.debug.ui.JavaDebugHover.getHoverInfo2(JavaDebugHover.java:371) at org.eclipse.jdt.internal.ui.text.java.hover.BestMatchHover.getHoverInfo2(BestMatchHover.java:163) at org.eclipse.jdt.internal.ui.text.java.hover.BestMatchHover.getHoverInfo2(BestMatchHover.java:129) at org.eclipse.jdt.internal.ui.text.java.hover.JavaEditorTextHoverProxy.getHoverInfo2(JavaEditorTextHoverProxy.java:85) at org.eclipse.jface.text.TextViewerHoverManager$4.run(TextViewerHoverManager.java:166) --- code: 100 plugin: org.eclipse.jdt.debug_3.9.0.v20150314-0247 message: Invalid stack frame fingerprint: 00000000 number of children: 0 General Information: reported-by: anonymous-id: e86dd9c7-4c69-40b5-a5b9-19c54bb8ed7a eclipse-build-id: 4.5.0.I20150320-0800 eclipse-product: org.eclipse.epp.package.committers.product operating system: Linux 3.16.0 (x86_64) - gtk jre-version: 1.7.0_75-b13The following plug-ins were present on the execution stack (*): 1. org.eclipse.jdt.debug_3.9.0.v20150314-0247 2. org.eclipse.jdt_3.11.0.v20150320-0800 3. org.eclipse.jdt.debug.ui_3.7.0.v20150316-0938 4. org.eclipse.jdt.ui_3.11.0.v20150316-2042 5. org.eclipse.jface.text_3.10.0.v20150112-1146 6. org.eclipse.jface_3.11.0.v20150313-1544Please note that:* Messages, stacktraces, and nested status objects may be shortened.* Bug fields like status, resolution, and whiteboard are sent back to reporters.* The list of present bundles and their respective versions was calculated by package naming heuristics. This may or may not reflect reality.Other Resources:* Report:* Manual:Thank you for your assistance.Your friendly error-reports-inbox.	This is an interim state where this frame's thread has been resumed, and is not yet suspended.If I can help somehow, please let me know.From POV of user:1. Debugging is not working ( the debug phase is frozen, the pointer is in place, white, waiting for something unknown )2. I mark all the threads of my JBoss 6.1.0 Final server and rightclick -> suspend.3. then I rightclick -> resume.4. The error comes out as a windows with, ok.5. I can't use debug anymore with this JVM instance process anymore, i have to restart it.That's all I know, if you want some files, project structure information, poke me.Thanks Karol for the help !!If you could give some test case without JBoss,on plain eclipse - that would be really helpful. If not possible at all. Then may be give a project with setup and step instructions to reproduce.Createdproject configuration fileProject configuration fileI wish I could give you help with creating testcase for this issue, but just idea struck me today, when this lovely bug happened again.I am not using Debug persepctive, instead i have to click each time the debug begins at the frame in the Debug sub-window ( view component ).So the thing is likely, that the Debug-view is not updated as quickly as i think, and i click then on the frame which was already executed but the view still refers to it.Just happened to me, could you check it?Just noticed that when I debug and use Source Attach plugin for source download, the debug frame in view and step-into are different form one on the stack.Thanks Karol,I was wondering if I could try getting the stackframe a couple of time before really throwing this exception. If I give a patch, can you apply and test it out ? as it is difficult for me to test without reproducing the problem.Sure, I can test it, but I would need your guidance on how to apply the patch ( is it just simple jar replacement in the eclipse dir ? ).Will try to make the jar , you can use 4.6 or your usage is limited to 4.5 ?I was going to update the environment anyway, so yes, 4.6 is as option.	10.0
id=373371	REOPENED	JDT	Core	3.8	PC Windows 7	P3 normal	Sasikanth Bharadwaj	2012-03-06 09:39 EST by	Dominik Gruntz	2016-04-14 03:59 EDT (	6 users	Build Identifier: 20120202-1513if the following class is entered:class Outer { class Inner extends Outer { } class SubInner extends Inner { public SubInner() { // Outer.this.super(); // (1) } }}eclipse reports an error on the constructor of class SubInner: No enclosing instance of type Outer is available due to some intermediate constructor invocation.However, if this class is compiled with javac (I used javac 1.7.0), then the java compiler does not report an error.A workaround is to explicitly invoke the constructor of the base class at (1).Reproducible: Always	See also buf 388903This is not fixed by the fix to.*** This bug has been marked as a duplicate of***(In reply to)Did you mean "this is fixed" ? If the code from here is not alreadyreleased as a test, perhaps it makes sense to do so. TIA.My mistake, this is NOT resolved by the fix to. It appears to be the non-anoymous variation of the same problem. I'll investigate.This bug is the opposite of e.g org.eclipse.jdt.core.tests.compiler.regression.Compliance_1_5.test063()javac has changed behaviour between 1.6 and 1.7 for this.We should fix this to bring Eclipse in line with javac, perhaps for Kepler?CreatedFix for this bug (but test regressions need attention)This tightens the test for denying access so unqualified super() calls are not incorrectly reported.This causes test regressions in the Compliance_1_5.test063-test069.I doubt if this is the right fix. The workaround instops workingwith this fix. I think we need to go back to the JLS and read up the relevantsections: 8.8.7.1, 15.9.2 etc.googling for "cannot reference this before supertype constructor has been called" site:bugs.sun.com pulls up some interesting entries. Some pages seem accessibleonly from google archives.Srikanth, do you still see this going for Kepler?Considering that we don't have a good fix yet, we don't want to to rush a fix. Targeting 4.4.sorry, this need to be moved yet again - too busy with Java 8 maintenance workat the moment.Shankha, please take this to completion.***has been marked as a duplicate of this bug. ***I will take this one.I see this in 15.9.2:• If C is an inner member class, then: – If the class instance creation expression is unqualified, then: › If the class instance creation expression occurs in a static context, then acompile-time error occurs. › Otherwise, if C is a member of a class enclosing the class in which the class instance creation expression appears, then let O be the immediately enclosing class of which C is a member. Let n be an integer such that O is the n'th lexically enclosing type declaration of the class in which the class instancecreation expression appears. The immediately enclosing instance of i is the n'th lexically enclosing instance of this.As per this, it should be legal to invoke Inner() because it's appears in Outer.(In reply to Jay Arthanareeswaran from)In light of this, I thought that the following code in CodeStream is not required:else { //compliance >= JDK1_5 denyEnclosingArgInConstructorCall = (invocationSite instanceof AllocationExpression || invocationSite instanceof ExplicitConstructorCall && ((ExplicitConstructorCall)invocationSite).isSuperAccess()) && !targetType.isLocalType();}But removing that results in failures to report the following. Note that Javac error is on invocation of new Inner(), not super(...). Looks like this needs closer attention.class Outer { class Inner extends Outer { public Inner(Object o) { } } class SubInner extends Inner { public SubInner() { super(new Inner(null)); } }}This needs more investigation. RC is not the time for this. Moving to 4.6.I think Sasi is a better person to handle this.Sasi, I leave it to you to adjust the target to suite your schedule.Couldn't get to it during 4.6. Will take it up later	18.0
id=230188	REOPENED	JDT	Core	3.4	PC Linux	P3 normal	Satyam Kandula	2008-05-05 08:00 EDT by	Sergey Yevtushenko	2011-01-31 07:37 EST (	2 users	Build ID: I20080502-0100Steps To Reproduce:The Scribe class uses a lot of StringBuffer instances. They can be replaced with StringBuilder without any additional efforts. Since all instances are local variables and are not involved in mutlithreaded interactions, there is no need to use synchronized StringBuffer.More information:	StringBuilder is a 1.5 class and JDT/Core cannot use any classes from 1.5. The EE specified for JDT/Core is 1.4.Closing as INVALID.Setting target milestone to 3.4RC1 as per JDT/Core processQuestion: how would a JDT backport of StringBuilder fare on a cost/benefit standpoint?I agree that even if StringBuilder is not usable because it's a part of JRE 1.5, we can improve the Scribe to avoid StringBuffer current intensive usage...My point was more along the following: we have utilities in place around char arrays, etc., that focus on speed quite a bit, and were (and still are) somewhat involving in terms of implementation when they were coded. I believe it would not be stretching such a design too much to envision adding a port of StringBuilder to that arsenal, *provided we get some clear benefit from doing so*.In fact that was exactly what I understood of your remark but I took advantage of this bug to remind that some performance improvements could be done in the Scribe (in fact the exact summary of this bug).IMO, this could be done either by using an internal class as you suggested or a more aggressive way which would avoid to use any temporary buffer by creating edits directly...StringBuffer allocations have been strongly reduced while improving formatter performances in 3.6, hence closing this bug as duplicate of.*** This bug has been marked as a duplicate of***The number of StringBuffer creation(s) has been reduced a lot in. However, as I understand all the string buffer methods are synchronized and hence they could still be having some performance impact. As we will be moving to Java 1.5, I think we should keep this bug open. Olivier, comments?Once we move to 1.5, we should use StringBuilder instead of StringBuffer.Satyam, please update the title accordingly.Reopening this as we want to move to Java 1.5. When we move to Java 1.5, we could use StringBuilder instead of StringBuffer.(In reply to)Satyam, do you expect me to have a look on this when possible?Thanks Frederic. I can take care of this when we move to 1.5.	12.0
id=369511	REOPENED	JDT	Core	3.8	PC Windows 7	P3 normal	Sasikanth Bharadwaj	2012-01-24 08:06 EST by	Alexander Thauerböck	2016-04-19 13:59 EDT (	12 users	Build Identifier: Version: Indigo Service Release 1 Build id: 20110916-0149When i'm searching for method-references in workspace on a specific method i get a NPE.java.lang.NullPointerException at org.eclipse.jdt.internal.compiler.lookup.ReferenceBinding$2.compare(ReferenceBinding.java:48) at java.util.TimSort.countRunAndMakeAscending(TimSort.java:325) at java.util.TimSort.sort(TimSort.java:203) at java.util.Arrays.sort(Arrays.java:727) at org.eclipse.jdt.internal.compiler.lookup.ReferenceBinding.sortFields(ReferenceBinding.java:152) at org.eclipse.jdt.internal.compiler.lookup.BinaryTypeBinding.availableFields(BinaryTypeBinding.java:200) at org.eclipse.jdt.internal.core.search.matching.ClassFileMatchLocator.locateMatches(ClassFileMatchLocator.java:239) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.process(MatchLocator.java:1639) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1083) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1124) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1256) at org.eclipse.jdt.internal.core.search.JavaSearchParticipant.locateMatches(JavaSearchParticipant.java:94) at org.eclipse.jdt.internal.core.search.BasicSearchEngine.findMatches(BasicSearchEngine.java:231) at org.eclipse.jdt.internal.core.search.BasicSearchEngine.search(BasicSearchEngine.java:515) at org.eclipse.jdt.core.search.SearchEngine.search(SearchEngine.java:584) at org.eclipse.jdt.internal.ui.search.JavaSearchQuery.run(JavaSearchQuery.java:144) at org.eclipse.search2.internal.ui.InternalSearchUI$InternalSearchJob.run(InternalSearchUI.java:91) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)Reproducible: AlwaysSteps to Reproduce:1.Rightclick on the method name2.Select "References"3.Then "Workspace"	Could you please provide us a reproducible test case? If not your project, a minimal test perhaps so that we can investigate? Thanks!Similar bugs in the past (and) had different causes.Can you give me a reproducible workspace? I am unable to reproduce this error.*** This bug has been marked as a duplicate of***Is it really a dup? This NPE happens in org.eclipse.jdt.internal.compiler.lookup.ReferenceBinding.FIELD_COMPARATOR.new Comparator() {...}.compare(Object, Object)whilehappens in org.eclipse.jdt.internal.compiler.lookup.ReferenceBinding.METHOD_COMPARATOR.new Comparator() {...}.compare(Object, Object)You are right. They are different.Reopening.Sorry, i can't give you operative code. I create a test-project, maybe i can trigger the same error too.I've played around alot, but i couldn't reproduce this error in a testproject again.Please let us know if you can reproduce this again. Thanks!Though the call stacks are different, I believe the problem is same as. I have a potential fix. I will post it shortly.Alexander, I believeis similar to this one and would like to see if the patch incould fix your problem also. Can you please try out the latest nightly build and see if your problem is fixed.Hi Satyam,i have tested with:Version: 3.8.0Build id: N20120203-2000and got the same error again.!MESSAGE An internal error occurred during: "Java Search".!STACK 0java.lang.NullPointerException at org.eclipse.jdt.internal.compiler.lookup.ReferenceBinding$3.compare(ReferenceBinding.java:65) at java.util.TimSort.countRunAndMakeAscending(Unknown Source) at java.util.TimSort.sort(Unknown Source) at java.util.Arrays.sort(Unknown Source) at org.eclipse.jdt.internal.compiler.lookup.ReferenceBinding.sortFields(ReferenceBinding.java:169) at org.eclipse.jdt.internal.compiler.lookup.BinaryTypeBinding.availableFields(BinaryTypeBinding.java:208) at org.eclipse.jdt.internal.core.search.matching.ClassFileMatchLocator.locateMatches(ClassFileMatchLocator.java:242) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.process(MatchLocator.java:1639) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1083) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1124) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1256) at org.eclipse.jdt.internal.core.search.JavaSearchParticipant.locateMatches(JavaSearchParticipant.java:95) at org.eclipse.jdt.internal.core.search.BasicSearchEngine.findMatches(BasicSearchEngine.java:231) at org.eclipse.jdt.internal.core.search.BasicSearchEngine.search(BasicSearchEngine.java:515) at org.eclipse.jdt.core.search.SearchEngine.search(SearchEngine.java:584) at org.eclipse.jdt.internal.ui.search.JavaSearchQuery.run(JavaSearchQuery.java:144) at org.eclipse.search2.internal.ui.InternalSearchUI$InternalSearchJob.run(InternalSearchUI.java:91) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)(In reply to)Sigh :(. I will put in some debug statements which could help to narrow down the problem. I will update you once I release this.I am getting a similar error since updating to Indigo SR2.Version: Indigo Service Release 2Build id: 20120216-1857Platform: Ubuntu!ENTRY org.eclipse.core.jobs 4 2 2012-03-02 11:16:21.233!MESSAGE An internal error occurred during: "Java Search".!STACK 0java.lang.NullPointerException at org.eclipse.jdt.internal.compiler.lookup.ReferenceBinding$3.compare(ReferenceBinding.java:57) at java.util.TimSort.binarySort(TimSort.java:265) at java.util.TimSort.sort(TimSort.java:208) at java.util.Arrays.sort(Arrays.java:727) at org.eclipse.jdt.internal.compiler.lookup.ReferenceBinding.sortMethods(ReferenceBinding.java:159) at org.eclipse.jdt.internal.compiler.lookup.BinaryTypeBinding.availableMethods(BinaryTypeBinding.java:259) at org.eclipse.jdt.internal.core.search.matching.ClassFileMatchLocator.locateMatches(ClassFileMatchLocator.java:197) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.process(MatchLocator.java:1693) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1099) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1156) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1273) at org.eclipse.jdt.internal.core.search.JavaSearchParticipant.locateMatches(JavaSearchParticipant.java:94) at org.eclipse.jdt.internal.core.search.BasicSearchEngine.findMatches(BasicSearchEngine.java:231) at org.eclipse.jdt.internal.core.search.BasicSearchEngine.search(BasicSearchEngine.java:515) at org.eclipse.jdt.core.search.SearchEngine.search(SearchEngine.java:592) at org.eclipse.jdt.internal.ui.search.JavaSearchQuery.run(JavaSearchQuery.java:144) at org.eclipse.search2.internal.ui.InternalSearchUI$InternalSearchJob.run(InternalSearchUI.java:91) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)Alexander and Russ, I have put in some more debug statements to track this problem in the nightly build through the new fix for. Can you please try that out by turning some debug options and giving me the output?Here are the instructions. Create a file called .options in the eclipse folder with the following lines######org.eclipse.jdt.core/debug=trueorg.eclipse.jdt.core/debug/search=true######Then run eclipse as%eclipsec.exe -debugPlease give the output of the command. Please also attach the file.metadata/.log located in your workspace.Thanks in advance.Satyam, it was happening reliably when I added the bugnote. However, now I can no longer reproduce the issue. If/when I can I'll add a bugnote. Thanks.Hy Satyam,we've created a new Project, where we moved all the testsources and now the NPE does not occur any more.Before we had the testsources in a folder named test/src in every project.I hope this helps to fix the problem, thanks.(In reply to)Thanks for the info. Can you tell what your buildpath was?I'm getting this error as well, but not just on searching -- I get it when I build my project.The stack trace is the same except the ReferenceBinding.java line number is different.java.lang.NullPointerException at org.eclipse.jdt.internal.compiler.lookup.ReferenceBinding$3.compare(ReferenceBinding.java:67) at java.util.TimSort.binarySort(TimSort.java:265) at java.util.TimSort.sort(TimSort.java:190) at java.util.Arrays.sort(Arrays.java:727) at org.eclipse.jdt.internal.compiler.lookup.ReferenceBinding.sortMethods(ReferenceBinding.java:169) at org.eclipse.jdt.internal.compiler.lookup.BinaryTypeBinding.getMethods(BinaryTypeBinding.java:922) at org.eclipse.jdt.internal.compiler.lookup.ParameterizedTypeBinding.getMethods(ParameterizedTypeBinding.java:596) at org.eclipse.jdt.internal.compiler.lookup.ReferenceBinding.getMethods(ReferenceBinding.java:883) at org.eclipse.jdt.internal.compiler.lookup.Scope.findMethod(Scope.java:1327) at org.eclipse.jdt.internal.compiler.lookup.Scope.findMethod(Scope.java:1298) at org.eclipse.jdt.internal.compiler.lookup.Scope.getMethod(Scope.java:2360) at org.eclipse.jdt.internal.compiler.ast.MessageSend.resolveType(MessageSend.java:488) at org.eclipse.jdt.internal.compiler.ast.FieldDeclaration.resolve(FieldDeclaration.java:222) at org.eclipse.jdt.internal.compiler.ast.TypeDeclaration.resolve(TypeDeclaration.java:1098) at org.eclipse.jdt.internal.compiler.ast.TypeDeclaration.resolve(TypeDeclaration.java:1272) at org.eclipse.jdt.internal.compiler.ast.CompilationUnitDeclaration.resolve(CompilationUnitDeclaration.java:561) at org.eclipse.jdt.internal.compiler.Compiler.process(Compiler.java:770) at org.eclipse.jdt.internal.compiler.ProcessTaskManager.run(ProcessTaskManager.java:137) at java.lang.Thread.run(Thread.java:722)Eclipse version:Version: Juno Service Release 1Build id: 20120920-0800I then updated to the newest prod version and got the same exception on Java Build:Version: Juno Service Release 2Build id: 20130225-0426eclipse.buildId=M20130204-1200java.version=1.7.0_21Okay, updating to Kepler (Build 20130614-0229) did not fix the issue, but creating a new workspace did. So it appears something happened to the workspace to cause this issue.Note that I had been using that workspace for months with no issues until this morning. The only thing that changed was that I updated all of my Ubuntu packages, installed all updates, and restarted the computer.I normally don't restart often, so it appears to be related either to some update that got applied, or to some settings change in Eclipse that only breaks Eclipse after a restart. Note that I had a co-worker with basically the same setup do his updates and restart and his build was fine.I traced the problem down to the Java JRE compliance level.I created a reproducible test for this issue. I copied the broken workspace to several new workspaces to test the fix.When I get the NullPointerException described above during build, I go to Window -> Preferences -> Java -> Compiler -> JDK ComplianceI verify that the following settings are correctly set:Compiler compliance level: 1.7[check] Use default compliance settingsI also verify that none of my projects have project-specific settings enabled; they're all using JRE 1.7 compliance.I then go to one of the error lines in my source code, and use the Quick Fix menu to select "Chance workspace compliance to JRE 1.7". After selecting this, all the errors are gone, and the project works perfectly again.I diff'd the project settings of the workspace before and after this change, and the following 5 lines were added:$ diff workspace/.metadata/.plugins/org.eclipse.core.runtime/.settings/org.eclipse.jdt.core.prefs workspace2/.metadata/.plugins/org.eclipse.core.runtime/.settings/org.eclipse.jdt.core.prefs4a5,811a16Now these are the settings I checked, and they were already set to 1.7, but that must have been a default setting that isn't defaulting correctly.My guess is that something in the build process checks the compliance version and the absence of an explicit setting causes an NPE (stacktrace above).Fix steps for others who run into this issue:Go to one of the red-underlined sections of your source code and select "Chance workspace compliance to JRE 1.7".If you can't get that to work, you could also probably add the lines above to the org.eclipse.jdt.core.prefs file manually.(In reply to Erik B from)Thanks for your observations.Unfortunately, I don't see how this could explain the NPE.My feeling is that an exception might have interrupted the reading of a BinaryTypeBinding, hence leaving the array of methods (fields) half initialized.So, anyone seeing this exception:- do you see any previous exceptions from JDT in your logs?- please see Satyam's request for debug information inThis bug is still occuring in the newest Luna version.I followed that instructions, and I may have something for you.Yep.[... 500+ "Report matching" entries... lots of possible matches]Report matching: - node set: accurate=0, possible=4 - must resolve: true (locator: true, nodeSet: true) - fine grain flags=none - node set: accurate=0, possible=0AbortCompilation while resolving unit LoaderRepository.classorg.eclipse.jdt.internal.compiler.problem.AbortCompilation: Pb(324) The type EDU.oswego.cs.dl.util.concurrent.ConcurrentReaderHashMap cannot be resolved. It is indirectly referenced from required .class files at org.eclipse.jdt.internal.compiler.problem.ProblemHandler.handle(ProblemHandler.java:152) at org.eclipse.jdt.internal.compiler.problem.ProblemHandler.handle(ProblemHandler.java:217) at org.eclipse.jdt.internal.compiler.problem.ProblemReporter.handle(ProblemReporter.java:2366) at org.eclipse.jdt.internal.compiler.problem.ProblemReporter.isClassPathCorrect(ProblemReporter.java:4679) at org.eclipse.jdt.internal.compiler.lookup.LookupEnvironment.getTypeFromCompoundName(LookupEnvironment.java:1201) at org.eclipse.jdt.internal.compiler.lookup.LookupEnvironment.getTypeFromConstantPoolName(LookupEnvironment.java:1231) at org.eclipse.jdt.internal.compiler.lookup.LookupEnvironment.getTypeFromConstantPoolName(LookupEnvironment.java:1239) at org.eclipse.jdt.internal.compiler.lookup.LookupEnvironment.getTypeFromSignature(LookupEnvironment.java:1309) at org.eclipse.jdt.internal.compiler.lookup.BinaryTypeBinding.createFields(BinaryTypeBinding.java:547) at org.eclipse.jdt.internal.compiler.lookup.BinaryTypeBinding.cachePartsFrom(BinaryTypeBinding.java:473) at org.eclipse.jdt.internal.compiler.lookup.LookupEnvironment.createBinaryTypeFrom(LookupEnvironment.java:696) at org.eclipse.jdt.internal.compiler.lookup.LookupEnvironment.cacheBinaryType(LookupEnvironment.java:214) at org.eclipse.jdt.internal.compiler.lookup.LookupEnvironment.cacheBinaryType(LookupEnvironment.java:201) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.cacheBinaryType(MatchLocator.java:417) at org.eclipse.jdt.internal.core.search.matching.ClassFileMatchLocator.locateMatches(ClassFileMatchLocator.java:194) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.process(MatchLocator.java:1718) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1161) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1202) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1319) at org.eclipse.jdt.internal.core.search.JavaSearchParticipant.locateMatches(JavaSearchParticipant.java:122) at org.eclipse.jdt.internal.core.search.BasicSearchEngine.findMatches(BasicSearchEngine.java:232) at org.eclipse.jdt.internal.core.search.BasicSearchEngine.search(BasicSearchEngine.java:516) at org.eclipse.jdt.core.search.SearchEngine.search(SearchEngine.java:584) at org.eclipse.jdt.internal.corext.callhierarchy.CallerMethodWrapper.findChildren(CallerMethodWrapper.java:155) at org.eclipse.jdt.internal.corext.callhierarchy.MethodWrapper.performSearch(MethodWrapper.java:301) at org.eclipse.jdt.internal.corext.callhierarchy.MethodWrapper.doFindChildren(MethodWrapper.java:232) at org.eclipse.jdt.internal.corext.callhierarchy.MethodWrapper.getCalls(MethodWrapper.java:84) at org.eclipse.jdt.internal.ui.callhierarchy.DeferredMethodWrapper.getCalls(DeferredMethodWrapper.java:65) at org.eclipse.jdt.internal.ui.callhierarchy.DeferredMethodWrapper.fetchDeferredChildren(DeferredMethodWrapper.java:79) at org.eclipse.ui.progress.DeferredTreeContentManager$1.run(DeferredTreeContentManager.java:238) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)Report matching: - node set: accurate=0, possible=0 - must resolve: false (locator: true, nodeSet: true) - fine grain flags=none!ENTRY org.eclipse.jdt.ui 4 10001 2014-12-12 18:49:12.258!MESSAGE Internal Error!STACK 0java.lang.NullPointerException at org.eclipse.jdt.internal.compiler.lookup.ReferenceBinding$2.compare(ReferenceBinding.java:83) at org.eclipse.jdt.internal.compiler.lookup.ReferenceBinding$2.compare(ReferenceBinding.java:1) at java.util.TimSort.binarySort(TimSort.java:292) at java.util.TimSort.sort(TimSort.java:217) at java.util.Arrays.sort(Arrays.java:1512) at org.eclipse.jdt.internal.compiler.lookup.ReferenceBinding.sortFields(ReferenceBinding.java:208) at org.eclipse.jdt.internal.compiler.lookup.BinaryTypeBinding.availableFields(BinaryTypeBinding.java:292) at org.eclipse.jdt.internal.core.search.matching.ClassFileMatchLocator.locateMatches(ClassFileMatchLocator.java:242) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.process(MatchLocator.java:1718) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1161) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1202) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(MatchLocator.java:1319) at org.eclipse.jdt.internal.core.search.JavaSearchParticipant.locateMatches(JavaSearchParticipant.java:122) at org.eclipse.jdt.internal.core.search.BasicSearchEngine.findMatches(BasicSearchEngine.java:232) at org.eclipse.jdt.internal.core.search.BasicSearchEngine.search(BasicSearchEngine.java:516) at org.eclipse.jdt.core.search.SearchEngine.search(SearchEngine.java:584) at org.eclipse.jdt.internal.corext.callhierarchy.CallerMethodWrapper.findChildren(CallerMethodWrapper.java:155) at org.eclipse.jdt.internal.corext.callhierarchy.MethodWrapper.performSearch(MethodWrapper.java:301) at org.eclipse.jdt.internal.corext.callhierarchy.MethodWrapper.doFindChildren(MethodWrapper.java:232) at org.eclipse.jdt.internal.corext.callhierarchy.MethodWrapper.getCalls(MethodWrapper.java:84) at org.eclipse.jdt.internal.ui.callhierarchy.DeferredMethodWrapper.getCalls(DeferredMethodWrapper.java:65) at org.eclipse.jdt.internal.ui.callhierarchy.DeferredMethodWrapper.fetchDeferredChildren(DeferredMethodWrapper.java:79) at org.eclipse.ui.progress.DeferredTreeContentManager$1.run(DeferredTreeContentManager.java:238) at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)More informations:- I searched for method references ("Call hierarchy") in Eclipse. The same error appeared when renaming the method ("Refactor").- The method signature was "public static void trace(String s)".- The exception occurs when parsing the class "LoaderRepository". It's org.jboss.mx.loading.LoaderRepository from jboss-jmx.jar.- This class has a reference to "EDU.oswego.cs.dl.util.concurrent.ConcurrentReaderHashMap", which is not in the classpath (from library oswego-concurrent:concurrent:1.3.4).- Adding concurrent.jar to the classpath fixed the problem. (Alternatively, removing the jboss-jmx.jar fixed it.)The bug is hard to investigate, because:- seems to appear only in big legacy projects- seems to appear only with methods with "generic" names (many possible matches during the search)- I tried to setup a smaller project, but wasn't able to reproduce the behaviour. - The inner exception (org.eclipse.jdt.internal.compiler.problem.AbortCompilation, see below) is only sometimes logged. I neded several tries until that was visible in the logs.Looks like you are right.-----Workaround:- setup debugging as described in- in the log, search for "AbortCompilation while resolving unit". There's a classname after that text.- find that class- check all references in that class. There must be one that is not in the current classpath- add the missing library to the classpathAlright, if LE.getTypeFromSignature() throws AbortCompilation while we are doing createField() or createMethod() this will leave one of the arrays half-initialized indeed.We should look out for any indirect callers of BTB.cachePartsFrom() that catch the exception with insufficient cleanup, so that broken BTBs may get reused after this incident. Some candidates:- HierarchyResolver.resolve() (both variants).- SuperTypeNamesCollector.collect()- MatchLocator.process()Next BTB.availableMethods() tries to sort the array containing nulls. Boom.Sasi, please take a look at this.(In reply to Michael Keuchen from)This could relate to the way how MatchLocator groups possible matches in chunks of 400. Guess: the AbortCompilation must be thrown while processing the first chunk. Then a second chunk must still exist, during which we encounter a possible match that refers to the half-initialized type from the first chunk.This could perhaps be leveraged for testing by tweaking the chunk size to some small value so that the bug is easier to trigger (or create a test with lots of dummy matches).Prior art in this field:-- test case in(In reply to)Couldn't we catch the AbortCompilation exception in createFields & createMethods and eliminate the unresolved methods/fields from the equation so that we never run into this situation? ClassFileMatchLocator seems to be prepared to handle the mismatch between number of available methods and number of resolved methods. Others do not seem to be interested in fields and methods in particular, only in caching the binding(In reply to Sasikanth Bharadwaj from)That would effectively avoid the NPE, indeed.After this cleanup, what should happen then?Proceed as if nothing happened, or rethrow the exception? (or use try-finally without catch)?***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***(In reply to Sasikanth Bharadwaj from)Did you plan to draft a fix along these lines? For hints on testing see the links in.(In reply to)I did create a patch, just need to find it and test it. Will take it up for 4.6Unlikely for 4.6, didn't get to look into it, moving to 4.7Sounds like a duplicate of.Note: The patch for it doesn't try to selectively catch AbortCompilation exceptions, instead it just makes sure that the methods/fields are not partially initialized - so if you think that is not good enough, you still might want to keep this open.(In reply to Till Brychcy from)very much so.One more thought: maybe we should ensure that the cleanup fromhappens even in case of exceptions thrown.***has been marked as a duplicate of this bug. ***	34.0
id=17185	REOPENED	Platform	SWT	2.0	PC Linux-GTK	P3 normal	Silenio Quarti	2002-05-23 06:43 EDT by	Claude Knaus	2008-02-27 16:35 EST (	4 users	F1 linux-gtkPress F1 on some element in the package view. Nothing happens.On w2k, a hover appears with entries "Java Views" "Package Views".	This has not been implemented yet.Changing status to LATER.I believe this is important and should be fixed.Support for help has been added. There is one issue yet. On GTK, thehelp callback happens with Ctrl+F1 or Shift+F1. On Windows and Motif,the help callback happens with F1.Need to decide if this is acceptable or not?I believe very strongly that we must follow the platform's standards. Especially on a platform that claims "UI consistency among applications" as one of the primary goals.Steve, what do you think?We should use the standard help key for the platform which is not a simple F1 according to BS. SSQ, do you want to mark this WONTFIX?Marking as WONTFIX.I tried several applications (FireFox, Terminal, GIMP, gEdit...) on ReadHat and SLES and they all use F1 for help and not Shift-F1. GIMP was the only one that supported Shift-F1 but it's used for Context Help only. I'm not sure if Shift-F1 was used a few years ago but it appears that F1 is the standard key for help now.Not sure why this is reopened. We just use the key bindings provided by the GTK. If other applications choose to look for F1, then GTK needs to be changed to look for it, not SWT.I still think that we have a problem in our implementation even after talking to Steve. I'm not sure if it's an Eclipse problem or SWT or both.Most applications on Linux would open a help window when you press F1 except for Eclipse. You have to press Shift-F1 to get help.Shift-F1 is for Context Help (which appears to be support in Windows and Linux applications). When Shift-F1 is pressed it should change the cursor to an arrow with a question mark, and you can press on any button, view or editor on the screen to get a pop-up help. We (SWT) do not support this.Eclipse F1 help is neither a context pop-up help nor a separate general help window. It's a view within Eclipse that show help for the current active item (which is a context sensitive help). We should make F1 or Shift-F1 open Eclipse help the same way on all platforms.	11.0
id=42114	REOPENED	Platform	SWT	3.0	PC Windows 2000	P3 normal	Silenio Quarti	2003-08-27 10:17 EDT by	Eugene Kuleshov	2004-08-02 23:13 EDT (	0 users	On windows bold "Lucida Console" font is displayed wider then nonbold typeface.The same text in "Courier New" font looks fine.	Created"Visual" testcase for this issueThis picture is demonstrating the issue.Createdwordpad pictureI believe this is the correct behavior. See the attached picture of wordpad.Please reopen this bug if Lucida Concole plain and bold have the same width inyour wordpad?Closing.They are the same in MS Word.This Wordpad example is quite confusing. I'm not sure what the problem is, but"Lucuda Console" is real fixed-width font, so it should have the same width forall glyphts.A font is fixed-width when all glyphs for a given style are the same width. A bold fixed-width font may be wider than its respective plain font.The picture I attached is just showing that "Lucida Console" bold is wider than "Lucida Console" plain even for Wordpad.I'm sorry to open it again, but I've checked this font in both Wordpad AND MSWord. So, Word shows it in the same width. If I'm not mistaken fixed-width fonts has some special marker (i.e. Mozilla cantell if font is fixed-width right away).I tested this on Windows 98, NT, 2000 and Xp, and for all sizes of Lucida Console, the bold glyphs are wider than the plain glyphs in Wordpad. I am not sorry what is the difference here.Please could you attach a picture of Wordpad showing that they are the same width? Thanks.CreatedLucida Console font in MSWordHere is the example of Lucida Console font in MSWord at Windows 2000.WordPad, please.See, and try patches.These patches will work for me. Is there are any chance to integrate them intoEclipse?Only a member of the SWT team knows.	12.0
id=69253	REOPENED	Platform	SWT	3.0	All All	P3 enhancement	Silenio Quarti	2004-07-04 02:58 EDT by	Michel Ishizuka	2016-05-14 02:23 EDT (	7 users	Many programmers like editing a program with monospace font.Many programmers like syntax highliting with bold.However, many monospace fonts have a problems that width of bold gryph is notsame as regular, like MS Gothic in Windows.Force monospace feature corrects this problem, in draw time.I believe that force monospace feature increase user experience.Principle is simple, if font style of run is not regular,recalculate position and width of each gryph with regular style, and set these position and width to the run.It is very easy to implement force monospace feature in win32.You may implement force monospace feature in gtk and carbon, but it is not somuch easy as win32.Maybe, it is difficult to implement in motif and emulate(photon), because these platform do not have the way to operate the gryph position and width.	Createdfor org.eclipse.swt pluginwin32 only.Createdfor org.eclipse.ui.editors pluginCreatedfor org.eclipse.ui.workbench.texteditor pluginCreatedfor org.eclipse.jdt.ui pluginoverview of patchsfor org.eclipse.swt plugin implementation of force monospace, only win32.for org.eclipse.ui.editors plugin add a checkbox which is labeled "force monospace" to Preference->Workbench->Editors->TextEditor.for org.eclipse.ui.workbench.texteditor plugin support force monospace option in Preference.for org.eclipse.jdt.ui plugin add a checkbox which is labeled "force monospace" to Preference->Workbench->Java->Editor->Appearance. Syntax preview supports force monospace.Createdscreenshot, before patch.Java Editor Text Font is set to "MS Gothic"."public class" is highlighted with bold.and width of highlighted "public class" is not same as not highlighted"public_class".this screenshot is used "MS Gothic"Createdscreenshot, after patchJava Editor Text Font is set to "MS Gothic"."public class" is highlighted with bold, and width of highlighted "publicclass" is same as not highlighted "public_class".Createdmonospace font checker. (for J2SE 5.0)Execute this program, then you will see the output like following."not" intends that it is not monospace font."true" intends that it is monospace font and regular width equals bold width."pseudo" intends that it is monospace font, however regular width does notequal bold width.you can execute this program with encoding names,then you will see the output like following.The Number of middle column shows percentage of displayable in specifiedencoding.Createdoutput of "java MonospaceTest ASCII JIS BIG5 EUCCN EUCKR"This file is output of "java MonospaceTest ASCII JIS BIG5 EUCCN EUCKR" on myWindowsXP. It is clearly that WindowsXP has no "true monospace font" which canuse with CJK characters.If eclipse does not support this force monospace feature, 1. Seek "true monospace font" at start, This solution increases initial cost of Eclipse.2. Use "Courier New", and do not use their native language. This solution decreases user experience.3. Use "pseudo monospace font", and do not highlight with bold. This solution decreases user experience.4. Throw away monospace layout. This solution decreases user experience.Createdscreenshot, hidemaru(Japanese famous editor)"public class" is highlighted with bold, and width of highlighted "publicclass" is same as not highlighted "public_class". It is same as patchedscreenshot.This request is same as, but this is not a bug.However, many editors support a feature like force monospace feature.Current Eclipse behaviour is not satisfactory behaviour.I believe that many people hope to enhance Eclipse behaviour.I forgot that AWT can not operate bitmap font.I will attach screenshot with bitmap font which contains Japanese glyphs.(FixedSys, SmallFonts, System, Terminal)Createdscreenshot, FixedSysFixedSys is not monospace font.Createdscreenshot, Small FontsSmall Fonts is "pseudo monospace font".Createdscreenshot, SystemSystem is not monospace font.(same as FixedSys?)Createdscreenshot, TerminalTerminal is "pseudo monospace font".Createdscreenshot, preference windowAfter patched, new check box which is labeled "Force monospace" is added, inpreference window. If you want to enable force monospace feature, check it.The main (enabling) patch is the one which has to be applied to SWT. Movingthere for comments. Once applied please move back to text.SSQ and FH to discuss this with SN. If I read the patches properly, we are ignoring then operating system spacing for bold fonts and hammering them to be the same as regular fonts? Although it makes Eclipse look nice, it doesn't seem right to do this.Michel, why don't you just turn bold fonts off in the Eclipse preferences and rely on coloring for key words?for bold fonts and hammering them to be the same as regular fonts?Yes, you read patches properly.rely on coloring for key words?It is same as solution 3 in #9? I have said that the solution reduces userexperience. If this solution can satisfy everyone, the bold option for key wordhighlighting is not needed. So you should eliminate the bold option for key wordhighlighting from Eclipse. Steve, why does Eclipse have bold option for key wordhighlighting? Of course, many people think it's useful. Many people who uses'pseudo monospace font' think it's useful too and hope to use it.I can't understand. What's wrong?***has been marked as a duplicate of this bug. ***Steve says, "We won't override the operating system behavior, especially whenthere is an option in the Eclipse UI to disable bolding".This feature is expected to all usual editors. So, I think that Eclipse shouldsupport it. (it is unnecessary for people who use only ISO-8859-X, however suchpeople is not the whole)The most of japanese editors use more than one operating system API like mypatch when rendering bold font.I cannot believe that after so many years this issue is still open. I had the very same problem with Lucida Console. Lucida Typewriter was okay, though. I do think thise patch should make it into the core product.A little hint for all those who wonder how to work around this problem: As I explained on StackOverflow [1], Microsoft Consolas is a good choice, even in size 8, as long as you activate ClearType. Dina is also okay, but I prefer Consolas.[1]	25.0
id=74736	REOPENED	Platform	SWT	3.0	PC Windows XP	P3 enhancement	Silenio Quarti	2004-09-22 18:44 EDT by	Stefan Xenos	2009-12-15 11:20 EST (	7 users	When inside our modal event loop for drag and drop, we'd like to change theeffect of a drop when the user presses a modifier key (like ctrl, shift, etc.)Our drag and drop event loop uses the SWT Tracker class. To make this happen, weneed two things:1. Ability to get the current state of all modifier keys.2. The ability to determine when the key state changes (even if the user isn'tmoving the tracker, we need to know that the key state changed so that we canchange the drop cursor).	Steve: this is one of the Tracker things we were discussing with Michael.I forget exactly what we were going to do about this. SSQ to consult with SN and GG.Are interested only on modifier keys (SHIFT, CTRL, etc) or any key?To fix, we only need modifier keys... but don't let me stop you fromsolving it for any key. :-)Fixed > 20040929.It is possible to add key listener to Tracker now.This is still only half-fixed. We now have access to the state changes, but notthe ability to query for the current state of modifier keys.If the user presses and holds ctrl before starting the drag, we have no way ofknowing that control is being held down (since we don't have a tracker at thetime of the keydown event).This is similar to, however we only need to know the state of modifierkeys (control, shift, alt) to fix our bug.Can you query the initial key and mouse state from the event stateMask? It should be set in mouse, key and selection events.That is a much better solution than the key listener on its own, but it willonly work once the first event is received from the tracker. This means that atthe very start of the drag loop (until the mouse moves 1 pixel), we will beshowing the wrong drop target.Steve: are you saying that the stateMask now contains valid information? If so,I can proceed with.Use the inital state from the event. It is set in mouse and keyboard and menu selection events. Hopefully, that is enough for you to determine the initial state when you launch the Tracker. SSQ will advise while I am gone.That workaround may work, but we can't use it. Our drags are startedprogramatically. The SWT event that triggered the start of the drag (if any) maybe on the other side of an API boundary from the code that creates the Tracker.That's a problem because the key state may have changed between the time of the event and the time your API is called. Are you stuck on this?Yes, this is still blocking.I just tested... the stateMask for the Tracker's SWT.Move event is not beingfilled in, either.	14.0
id=91157	REOPENED	Platform	SWT	3.1	Other Linux-GTK	P3 normal	Silenio Quarti	2005-04-12 12:19 EDT by	Bruno Haible	2011-04-23 01:56 EDT (	3 users	With SWT from Eclipse 3.1M6 on Linux/x86 with the gtk window system, the attached application - which contains three SWT_AWT embedded frames - flickers when the SWT application window is resized (both when it is enlarged and also when it is shrinked). To reproduce: 1) Unpack the attached application. 2) $ export ECLIPSE_HOME=directory_of_your_eclipse_installation 3) "ant" 4) with a JDK 1.5: "ant run" 5) resize the application window	Createdsample application that uses embedded SWT framesWe believe strongly that the flickering is on the AWT/Swing side. SSQ to provide strategies to reduce this. Isn't there one on the SWT snippets page?The strategy from Snippet 154 is already taken into account in the sample. It succeeds to fix the problem only on Windows, not on linux-gtk.This is an AWT problem and I believe there is nothing SWT can do to work aroundit. The problem does not happen on because of the AWT system property"sun.awt.noerasebackground", but this property is only honoured on Windows. System.setProperty("sun.awt.noerasebackground", "true");Here is a simple AWT only example that shows the problem:public static void main(String[] args) { java.awt.Frame frame = new java.awt.Frame(); java.awt.Panel panel = new java.awt.Panel(new BorderLayout()) { public void update(java.awt.Graphics g) { // Don't erase the background, to decrease flickering. paint(g); } }; JRootPane root = new JRootPane(); panel.add(root); java.awt.Container contentPane = root.getContentPane(); JPanel blackPanel = new JPanel(); blackPanel.setBackground(java.awt.Color.black); contentPane.add(blackPanel, BorderLayout.CENTER); frame.add(panel); frame.setVisible(true);}The AWT sample can be changed so that it doesn't show the problem any more: public static void main(String[] args) { java.awt.Frame frame = new java.awt.Frame() { public void update(java.awt.Graphics g) { // Don't erase the background, to decrease flickering. paint(g); } }; JRootPane root = new JRootPane(); frame.add(root); java.awt.Container contentPane = root.getContentPane(); JPanel blackPanel = new JPanel(); blackPanel.setBackground(java.awt.Color.black); contentPane.add(blackPanel, BorderLayout.CENTER); frame.setVisible(true); } The two tricks to get rid of the flickering are: 1) Not to use java.awt.Panel, 2) Override the update(Graphics) method of the java.awt.Frame class, to avoid the clearRect call found in java.awt.Container:update(Graphics). These two tricks can be transposed to the SWT world. Find attached a sample with a class FixedXEmbeddedFrame, subclass of sun.awt.X11.XEmbeddedFrame, that overrides the update(Graphics) method as needed. This shows that the problem can indeed be fixed. However, this fix is not satisfactorily deployable on our side, because it is platform dependent: - The class FixedXEmbeddedFrame cannot be compiled on non-X11 platforms. - The comments in class SWT_AWT say that the constructor should take an 'int' on some platforms and a 'long' on others. Therefore I believe this fix should best be integrated into SWT, so that code that uses SWT can remain platform independent.CreatedSample without flickering, through a subclass of sun.awt.X11.XEmbeddedFrameThe extra java.awt.Panel is needed with JDK 1.4.2 (at least). The cursor will not change to the "resize cursor" when you try to resize the columns of the table without the panel (see).Now, If I put the java.awt.Panel back, the example will still flicker even if I subclass XEmbeddedFrame and reimplement update().sun.awt.X11.XEmbeddedFrame is not public API and there are binary incompatability between JREs for the same platform. So how can I have a subclass that will work on all JREs, since I have to decide between int or long at compile time. Right now, we use reflection to work around this problem.To make a subclass that works on all JREs, you can either a) Compile the subclass with the 'int' constructor on a platform where sun.awt.X11.XEmbeddedFrame has 'int'; likewise with 'long' on a different platform; then choose the appropriate one at runtime and load it through an extra classloader. Or b) Construct the appropriate subclass entirely at runtime using the Apache BCEL package, parametrizing it with the information about sun.awt.X11.XEmbeddedFrame. The class is converted from a byte[] to a Class object through a custom ClassLoader whose findClass method just calls defineClass of the byte array. How to solve the conflict betweenand this one regarding the extra java.awt.Panel, I don't know.Having different classes at compile time for different platforms was not a option in JDK 1.3, because the same platform (Windows) had JREs with different WEmbeddedFrame classes. So if we compiled for one jre, we would not be able to run in the other jre. This may have change for newer JREs, I would have to check.I believe adding dependence to Apache BCEL package is not a option (over kill).This bug is still (in Eclipse 3.4M4) a major problem with SWT_AWT on Gtk.You can easily reproduce it with Albireo: Install Albireo from, then launch the examples plugin, and open the "Resize Flickering" view. At every mouse drag events, it resizes 4 adjacent SWT_AWT instances, and the flickering is *heavy*.You can see the flickering with the white color (#xffffff), although the background is set to grey.You are right inthat a subclass of sun.awt.X11.XEmbeddedFrame does not fix the flickering, at least not with JDK 1.5.Also, the following do not fix the problem: - Use of the SWT.NO_REDRAW_RESIZE flag in the constructor. - Use of the SWT.TRANSPARENT flag in the constructor. - OS.gtk_widget_set_redraw_on_allocate(composite.handle, false); - OS.gtk_fixed_set_has_window(composite.handle, false);Single-stepping through the code, I found that the flickering occurs in(or as a consequence of) the call OS.gtk_widget_size_allocate (topHandle, allocation);in Control.java, methodsetBounds (int x, int y, int width, int height, boolean move, boolean resize).I've been looking at the source code of gtk_widget_size_allocate andgtk_fixed_size_allocate (since the handle is an instance of SwtFixed,subclass of GtkFixed), but I don't understand where the area is filled withwhite color.Is SwtFixed the right class at all for this? The SWT_AWT.new_Frame methodtakes a Composite as argument. A Composite is meant to contain other widgetsand therefore normally paints a background. But here, the entire Composite'sarea is covered by the Frame's area, therefore it should not paint abackground. Possibly this could be achieved by using the GTK_NO_WINDOW flag- but this flag is not used by the implementation of Composite. - IsSwtFixed or GtkFixed the right type to use here at all?There's an old post by Havoc Pennington (you won't find a better experton Gtk)who explains (AFAIU) that one should use NO_WINDOW in order to avoid flicker.	11.0
id=162219	REOPENED	Platform	SWT	3.2	PC Solaris-GTK	P3 normal	Silenio Quarti	2006-10-25 10:10 EDT by	Ken Larson	2006-10-25 15:30 EDT (	2 users	I get:org.eclipse.swt.SWTError: Not implemented (java.lang.reflect.InvocationTargetException) at org.eclipse.swt.SWT.error(SWT.java:3400) at org.eclipse.swt.SWT.error(SWT.java:3297) at org.eclipse.swt.awt.SWT_AWT.new_Frame(SWT_AWT.java:161)(at my code)Caused by: java.lang.reflect.InvocationTargetException at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39) at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27) at java.lang.reflect.Constructor.newInstance(Constructor.java:494) at org.eclipse.swt.awt.SWT_AWT.new_Frame(SWT_AWT.java:159) ... 26 moreCaused by: java.lang.ClassCastException: sun.awt.motif.MToolkit at sun.awt.X11.XEmbeddedFrame.<init>(XEmbeddedFrame.java:31) ... 31 moreI created an SWT jar by extracting the relevant class files from the Eclipse SDK.A relevant link:	Are you running Java 1.5?Yes.You need to change the AWT toolkit from MToolkit to XToolkit. XToolkit implements the XEmbed protocol which is essential for this o work. Have a look at:For XEmbed protocol have a look at:There needs to be a FAQ that describes this. GG?I've added.Thank you Grant for taking the time to do this.Thanks for your help. Setting the environment variable worked.I'm having trouble getting it to work using java web start, setting the properties in the jnlp file, but that is not an SWT issue obviously.The basic problem can be solved by setting environment variables.However, running from Java Web Start is a problem because generally the whole point of JWS is that it takes the place of an install. Requiring a user to set an environment variable or set something in their java control panel before running the program - well, it simply isn't very scalable if you have lots of users who want the easy web start install.So I believe it can be made to work with JWS if the user sets the variable themselves somewhere. But it does not appear to be possible in the jnlp, because if you specify <property name="awt.toolkit" value="sun.awt.X11.XToolkit" />it will set the property, but only after it is too late. Looking at the jnlp spec, it does not guarantee that the system properties will be set at jvm startup - it only guarantees that it is before your main executes. And if you look at your call stacks when running from JWS, you'll see why this is true: the JWS launcher itself uses java, so the JVM is already started well before any of your code is executed.That said, I'd like to reopen this bug, not because it is necessarily the responsibility of the SWT team (it seems like some of the other SWT/AWT issues, it is a combination of SWT issues and Java issues), but because, simply put, it is still a problem. A Swing app can be made to deploy nicely with JWS, but an SWT one still has issues, this being one of them.Any help appreciated.I have filed this issue with Sun as well.	9.0
id=106981	REOPENED	Platform	SWT	3.2	PC Windows XP	P3 normal	Silenio Quarti	2005-08-14 20:35 EDT by	Florian Priester	2009-09-03 01:30 EDT (	5 users	SWT-win32, 3.2M1While drawing images with an alpha channel on a GC, I found the performancea bit puzzling in some places.Please see the snippet below for a simple benchmark which draws two imagesof the same size (one with alpha values set, the other without) onto ashell (first test) and a destination image (second test), 1000 times each.Some results on my system (WinXP Pro SP2 on a P4-2.4GHz, JRE 1.4.2_08): [display depth=16, image size=32x32, passes=100, times per pass=1000] shell test... average time without alpha=21.88ms average time with alpha=209.68ms factor=9.583181 image test... average time without alpha=16.9ms average time with alpha=207.0ms factor=12.248521 [display depth=16, image size=128x128, passes=100, times per pass=1000] shell test... average time without alpha=73.59ms average time with alpha=2380.01ms factor=32.341488 image test... average time without alpha=59.23ms average time with alpha=2437.96ms factor=41.160896 [display depth=32, image size=32x32, passes=100, times per pass=1000] shell test... average time without alpha=18.31ms average time with alpha=151.85ms factor=8.2932825 image test... average time without alpha=17.17ms average time with alpha=288.76ms factor=16.817705 [display depth=32, image size=128x128, passes=100, times per pass=1000] shell test... average time without alpha=90.3ms average time with alpha=1557.52ms factor=17.248283 image test... average time without alpha=90.93ms average time with alpha=3087.67ms factor=33.95656Things to note:- Alpha blending is expected to have a higher cost in terms of processor cycles than simply blitting opaque pixels, but these numbers (16, 32, 40 times slower?) seem out of proportion - The cost factor of alpha vs. non-alpha varies wildly with the image size instead of being constant- With a display depth of 32-bit, drawing onto an image appears to be about twice as slow as drawing onto a control for the alpha case (but not the non-alpha case)Would you have any thoughts about these results and might it be possibleto improve the numbers?(Feel free to close this report if you feel that my expectations are wrong or that the problem is likely to lie with my system setup.)---import org.eclipse.swt.graphics.*;import org.eclipse.swt.widgets.*;import java.util.*;public class AlphaBenchmark { private static final int WIDTH = 32; private static final int HEIGHT = WIDTH; private static final int PASSES = 100; private static final int TIMES_PER_PASS = 1000; public static void main(String[] args) { // create display Display display = new Display(); System.out.print(" [display depth=" + display.getDepth()); System.out.print(", image size=" + WIDTH + "x" + HEIGHT); System.out.print(", passes=" + PASSES); System.out.print(", times per pass=" + TIMES_PER_PASS); System.out.println("]"); // get sample image data Image img = new Image(display, WIDTH, HEIGHT); ImageData noAlphaImgData = img.getImageData(); ImageData alphaImgData = img.getImageData(); img.dispose(); // set alpha values byte[] alphas = new byte[WIDTH * HEIGHT]; Arrays.fill(alphas, (byte) 127); alphaImgData.setAlphas(0, 0, alphas.length, alphas, 0); // create images Image noAlphaImg = new Image(display, noAlphaImgData); Image alphaImg = new Image(display, alphaImgData); // shell test Shell destShell = new Shell(display); destShell.setBounds(500, 200, 200, 200); destShell.open(); System.out.println(" shell test..."); runTest(destShell, noAlphaImg, alphaImg); destShell.dispose(); // image test Image destImg = new Image(display, WIDTH, HEIGHT); System.out.println(" image test..."); runTest(destImg, noAlphaImg, alphaImg); destImg.dispose(); // dispose images noAlphaImg.dispose(); alphaImg .dispose(); // dispose display display.dispose(); } private static void runTest( Drawable destDrawable, Image noAlphaImg, Image alphaImg) { int noAlphaTotal = 0; int alphaTotal = 0; // create GC GC gc = new GC(destDrawable); // drawing loop for (int pass = 0; pass < PASSES; pass++) { noAlphaTotal += draw(gc, noAlphaImg); alphaTotal += draw(gc, alphaImg); } // dispose GC gc.dispose(); // display results float avgNoAlpha = (float) noAlphaTotal / PASSES; float avgAlpha = (float) alphaTotal / PASSES; System.out.println(" average time without alpha=" + avgNoAlpha + "ms"); System.out.println(" average time with alpha=" + avgAlpha + "ms"); System.out.println(" factor=" + ((float) alphaTotal / noAlphaTotal)); } private static int draw(GC gc, Image srcImg) { gc.fillRectangle(0, 0, WIDTH, HEIGHT); long start = System.currentTimeMillis(); for (int i = 0; i < TIMES_PER_PASS; i++) { gc.drawImage(srcImg, 0, 0); } long end = System.currentTimeMillis(); return (int) (end - start); }}	Fixed > 20050901.Please try the latest.New benchmark results for swt-N20050902-0010-win32-win32-x86:Hi-Color=== [display depth=16, image size=32x32, passes=100, times per pass=1000] shell test... average time without alpha=21.43ms average time with alpha=185.61ms factor=8.661222 image test... average time without alpha=20.0ms average time with alpha=182.82ms factor=9.141 [display depth=16, image size=128x128, passes=100, times per pass=1000] shell test... average time without alpha=68.62ms average time with alpha=2041.23ms factor=29.746866 image test... average time without alpha=59.06ms average time with alpha=2091.41ms factor=35.411613 [display depth=16, image size=256x256, passes=100, times per pass=1000] shell test... average time without alpha=212.54ms average time with alpha=8262.93ms factor=38.87706 image test... average time without alpha=192.52ms average time with alpha=8580.14ms factor=44.567524True-Color=== [display depth=32, image size=32x32, passes=100, times per pass=1000] shell test... average time without alpha=17.82ms average time with alpha=128.9ms factor=7.2334456 image test... average time without alpha=18.3ms average time with alpha=130.14ms factor=7.1114755 [display depth=32, image size=128x128, passes=100, times per pass=1000] shell test... average time without alpha=90.21ms average time with alpha=1211.19ms factor=13.426338 image test... average time without alpha=90.16ms average time with alpha=1218.43ms factor=13.514086 [display depth=32, image size=256x256, passes=100, times per pass=1000] shell test... average time without alpha=363.47ms average time with alpha=5381.99ms factor=14.807247 image test... average time without alpha=364.6ms average time with alpha=5677.12ms factor=15.570817Observations:All in all, the numbers are better. Most notably, the "penalty" fordrawing onto an image (as opposed to a control) in 32-bit mode is gone.That's a big step forward.However, the cost factor of using an alpha channel still seems fairly highfor some cases, especially for bigger image sizes. The idea (hope) would beto aim for a factor that's somewhere in the range of (estimating here) 4-7,regardless of the image size.Looking at the source code, some of the current performance seems to bedue to the overhead that occurs each time GC.drawBitmapAlpha is called.Among other things, a buffer the size of the image is allocated and afterthat, every pixel is set and prepared for subsequent use with AlphaBlend.If it were possible to cache some of this data, this would surely boostthe painting speed. There are situations in which the ability to (repeatedly)draw images quickly may be well worth the cost of any additional memoryconsumed by cached data. (Note that the images in such a scenario couldbe several different ones that are drawn in an arbitrary order.)Reopening this report as a request for checking whether further optimizationssuch as caching are feasible.Thanks for looking into this issue!These are the results of running the bench on my machine (WinXP pro sp1, P4 2.0GHz, 1.5 RAM). They are more reasonable than the ones you posted. Probably because my display driver performs better.Anyway, the problem here is that AlphaBlend() takes premultiplied data and other APIs like ImageList_Add() take non-premultiplied data which forces us to create a temporary DIB section. We have investigated ways of using premultiplied data all the time, but it involves a lot of work (and new API for getImageData() that describes premultiplied data). I will look at this only after the next milestone. [display depth=16, image size=32x32, passes=100, times per pass=1000] shell test... average time without alpha=49.79ms average time with alpha=196.31ms factor=3.9427595 image test... average time without alpha=37.78ms average time with alpha=184.4ms factor=4.8808894 [display depth=16, image size=128x128, passes=100, times per pass=1000] shell test... average time without alpha=261.19ms average time with alpha=1902.41ms factor=7.283625 image test... average time without alpha=246.06ms average time with alpha=1890.04ms factor=7.681216 [display depth=32, image size=32x32, passes=100, times per pass=1000] shell test... average time without alpha=63.92ms average time with alpha=201.24ms factor=3.1483104 image test... average time without alpha=64.3ms average time with alpha=184.29ms factor=2.8660965 [display depth=32, image size=128x128, passes=100, times per pass=1000] shell test... average time without alpha=1272.39ms average time with alpha=1970.11ms factor=1.5483539 image test... average time without alpha=1270.92ms average time with alpha=1935.96ms factor=1.5232744 [display depth=32, image size=256x256, passes=100, times per pass=1000] shell test... average time without alpha=1497.62ms average time with alpha=8437.22ms factor=1.6337523 image test... average time without alpha=5433.39ms average time with alpha=9349.88ms factor=1.7208189CreatedAlphaBenchmark v2.0Slightly improved benchmark to replace the one from.(In reply to)This could certainly be a factor, although I'm using a recent revision of thestandard ATI drivers. To be honest, I find it hard to get any sensible patternsfrom comparing your numbers with mine. I still think that my benchmark measuresthe right thing (since for a developer who is using SWT, the code chain endsat the point where he's calling GC.drawImage), but perhaps other approachesare needed to get a clearer picture.If that's possible, that would be great.SWT-win32, 20070129 (HEAD)Here are some benchmark results (see) from a different machine.The numbers are better.---Hi-Color: [display depth=16, image size=32x32, passes=100] shell test... 1000*drawImage without alpha=14.21ms 1000*drawImage with alpha=59.69ms factor=4.20 image test... 1000*drawImage without alpha=10.80ms 1000*drawImage with alpha=58.89ms factor=5.45 [display depth=16, image size=64x64, passes=100] shell test... 1000*drawImage without alpha=25.92ms 1000*drawImage with alpha=141.58ms factor=5.46 image test... 1000*drawImage without alpha=17.96ms 1000*drawImage with alpha=141.72ms factor=7.89 [display depth=16, image size=128x128, passes=100] shell test... 1000*drawImage without alpha=69.07ms 1000*drawImage with alpha=471.24ms factor=6.82 image test... 1000*drawImage without alpha=53.31ms 1000*drawImage with alpha=471.38ms factor=8.84 [display depth=16, image size=256x256, passes=100] shell test... 1000*drawImage without alpha=223.29ms 1000*drawImage with alpha=1847.49ms factor=8.27 image test... 1000*drawImage without alpha=193.79ms 1000*drawImage with alpha=1847.77ms factor=9.53True-Color: [display depth=32, image size=32x32, passes=100] shell test... 1000*drawImage without alpha=10.64ms 1000*drawImage with alpha=55.14ms factor=5.18 image test... 1000*drawImage without alpha=9.99ms 1000*drawImage with alpha=55.48ms factor=5.55 [display depth=32, image size=64x64, passes=100] shell test... 1000*drawImage without alpha=16.72ms 1000*drawImage with alpha=126.25ms factor=7.55 image test... 1000*drawImage without alpha=16.70ms 1000*drawImage with alpha=125.64ms factor=7.52 [display depth=32, image size=128x128, passes=100] shell test... 1000*drawImage without alpha=70.47ms 1000*drawImage with alpha=414.68ms factor=5.88 image test... 1000*drawImage without alpha=70.94ms 1000*drawImage with alpha=414.38ms factor=5.84 [display depth=32, image size=256x256, passes=100] shell test... 1000*drawImage without alpha=281.57ms 1000*drawImage with alpha=1657.33ms factor=5.89 image test... 1000*drawImage without alpha=281.56ms 1000*drawImage with alpha=1653.60ms factor=5.87	6.0
id=171776	REOPENED	Platform	SWT	3.2.1	PC Windows XP	P3 normal	Silenio Quarti	2007-01-26 07:02 EST by	Patrick	2007-07-29 10:23 EDT (	4 users	Build ID: v3.2.1 / M20060921-0945Steps To Reproduce:1. enable antialiasing2. create graph containing nodes with a dashed border3. print graph using PrintGraphicalViewerOperation4. when the output is tiled across multiple pages, some of the dashed lines on the second page appear as solid linesMore information:This problem occurs with most printers, i.e. the Adope postscript printer drivers or PDFCreator 0.9.2. Microsoft Office Image Writer, on the other hand, produces the correct output.I'm using the same widgest class in different places, and depending on the parent container the output differs. When removing all calls to .setAntialias() (i.e. not triggering the use of "advanced graphics") the correct output is produced in all cases.I can try to produce a minimal test case for this. Example output is attached.	Createdexpected output (antialiasing never set)CreatedWrong output (page 2) created when antialias has been enabledPlease move to SWT.SSQ, is there anything special that Carolyn should be doing?I believe this is fixed in 3.3 already. Patrick could you try your steps with a newer 3.3 build?Please reopen if the problem still happens in 3.3.I just tested this using Eclipse 3.3 (Build id: I20070621-1340) and the errors are still occurring. Again, after disabling AA the dashed lines are drawn properly on all pages.I'm seeing some additional printing problems with transparent images, but I assume that's another bug :-)Createdtiled printing w/ aaCreatedtiled printing w/out AA	9.0
id=234644	REOPENED	Platform	SWT	3.4	PC Windows All	P3 normal	Silenio Quarti	2008-05-29 11:01 EDT by	Klaus Pesendorfer	2011-09-06 08:36 EDT (	3 users	I got troubles creating an Image-object (org.eclipse.swt.graphics.Image) using .ico files as image source.Especially on MS Windows it does not work at all.The code samples I used:1) Image ico = new Image(display, "c:\\Temp\computer.ico");2) Image ico = new Image(display, IcoTest2.class.getResourceAsStream("computer.ico"));3) ImageDescriptor iDescr = ImageDescriptor.createFromFile(IcoTest.class, "computer.ico"); Image ico = iDescr.createImage();-> the first two examples crash with an SWTException SWTException: Invalid image:Exception in thread "main" org.eclipse.swt.SWTException: Invalid image at org.eclipse.swt.SWT.error(Unknown Source) at org.eclipse.swt.SWT.error(Unknown Source) at org.eclipse.swt.SWT.error(Unknown Source) at org.eclipse.swt.internal.image.WinICOFileFormat.loadInfoHeader(Unknown Source) at org.eclipse.swt.internal.image.WinICOFileFormat.loadIcon(Unknown Source) at org.eclipse.swt.internal.image.WinICOFileFormat.loadFromByteStream(Unknown Source) at org.eclipse.swt.internal.image.FileFormat.loadFromStream(Unknown Source) at org.eclipse.swt.internal.image.FileFormat.load(Unknown Source) at org.eclipse.swt.graphics.ImageLoader.load(Unknown Source) at org.eclipse.swt.graphics.ImageDataLoader.load(Unknown Source) at org.eclipse.swt.graphics.ImageData.<init>(Unknown Source) at org.eclipse.swt.graphics.Image.<init>(Unknown Source) at IcoTest.main(IcoTest.java:...)-> the third example does not crash but also does not display the image, instead the red square placeholder icon is displayed.On Linux everything exept the second example DO work, also with correct image (.ico) displayed!I'm using Eclipse/SWT 3.4RC2 and Java 6	Created.ICO-File to testI cannot open this icon with "IE", "Paint" or the "Windows Picture and Fax Viewer" (on Xp) either. Are you able to open it anywhere?Reopening bug because this is a valid image... it's called a Vista ICO.Microsoft has thrown us a curve ball and they have changed their icon format.We do not (yet) support the new Vista ICO format.Changing title to include the word "Vista".Apparently, Vista ICO's are just PNG's with a short ICO header.Good article here:See the section on "Windows Vista Icons Support" for decoding the ICO.Also, for grins (and for background on why they changed it and broke compatibility - in fact, they cause some icon readers to crash...), see the section on "Ohh Microsoft policy about compatibility is changing?".We won't have time to look at this until after 3.4 ships.	3.0
id=264011	REOPENED	Platform	SWT	3.5	PC Mac OS X	P3 normal	Silenio Quarti	2009-02-06 17:52 EST by	Antoine Toulmé	2009-02-18 09:45 EST (	3 users	I get this error when I try to self host an Eclipse instance:!ENTRY org.eclipse.osgi 4 0 2009-02-06 23:49:06.724!MESSAGE Application error!STACK 1org.eclipse.swt.SWTError: Not implemented [multiple displays] at org.eclipse.swt.SWT.error(SWT.java:3886) at org.eclipse.swt.widgets.Display.checkDisplay(Display.java:563) at org.eclipse.swt.widgets.Display.create(Display.java:648) at org.eclipse.swt.graphics.Device.<init>(Device.java:128) at org.eclipse.swt.widgets.Display.<init>(Display.java:556) at org.eclipse.swt.widgets.Display.<init>(Display.java:547) at org.eclipse.ui.internal.Workbench.createDisplay(Workbench.java:531) at org.eclipse.ui.PlatformUI.createDisplay(PlatformUI.java:161) at org.eclipse.ui.internal.ide.application.IDEApplication.createDisplay(IDEApplication.java:143) at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:88) at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:194) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:368) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:597) at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:556) at org.eclipse.equinox.launcher.Main.basicRun(Main.java:511) at org.eclipse.equinox.launcher.Main.run(Main.java:1270) at org.eclipse.equinox.launcher.Main.main(Main.java:1246)	There shouldn't be multiple displays under normal self-hosting circumstances. SSQ to try 64-bit builds.This happened to me once because my plugin list was incorrect when I tried to run Eclipse from Eclipse. I have it working now, but it seems like the introduction of equinox changed what plugins were needed to start up the IDE.Self host on 64-bit (and 32 bit) works fine for me, but we know that multiple displays are not implemented. *** This bug has been marked as a duplicate of***This bug is not the same thing as. This bug covers having more than one Display object in existence at a time. 252251 covers creating, disposing and then creating another Display.I would mark this as WONTFIX, since Cocoa or Carbon doesn't support multiple UI threads in the same process.Reopening...	5.0
id=163934	REOPENED	Platform	SWT	3.3	Macintosh Mac OS X - Carbon (unsup.)	P3 major	Silenio Quarti	2006-11-09 05:14 EST by	Missing name	2012-06-20 16:39 EDT (	5 users	It works fine on Windows or Linux (GTK).The problem is the following: TreeEditor's default height (on Mac) is low enough that the user can not see the text he/she is typing. I tried to use grabVertical, change font size/height with no success.	TreeEditor is SWTI don't see this problem withusing either 3.0.1 or the latest.- does the snippet link above give you any hints of something you're not doing correctly?- if not, do you still see the problem with a recent eclipse 3.3 build? (eg.-)- if so, can you provide a code snippet that demonstrates the problem?I guess I should have explained a little bit more:<init> Tree TT = new Tree(parent.getParent(), SWT.SINGLE | SWT.BORDER | SWT.V_SCROLL | SWT.H_SCROLL); Editor = new TreeEditor(TT); Editor.grabHorizontal = true; Editor.horizontalAlignment = SWT.LEFT; Editor.minimumWidth = 50;</init>Then when the TreeITem is selected:<SetEditorUp> Text TIEditor = new Text(tti.getParent(), SWT.BORDER); TIEditor.addKeyListener(aKeyListener); TIEditor.addFocusListener(aFocusListener); TIEditor.setFocus(); Editor.setEditor (CellEditor, tti);</SetEditorUp>This code works on Win and Linux. Mac has the problem described.On Eclipse 3.0X:The TreeItem selection does not even work (i.e the composite does not even display on top of the TreeItem.On 3.1 and 3.2:I have not been able to get around the unsatisfied link error. If you could tell me where the native libaries are in these versions I can try.Please reopen this bug with a test case that fails for Eclipse 3.3 M3 or greater. Thanks!Ok. when I get there I will reopen.CreatedPNG to show how TreeEditor + Text are not usableComment onPNG to show how TreeEditor + Text are not usableThis is 3.3M3This source reflects the same problem as the screenshot attachment on 3.3M3import org.eclipse.swt.*;import org.eclipse.swt.events.FocusEvent;import org.eclipse.swt.events.FocusListener;import org.eclipse.swt.events.KeyEvent;import org.eclipse.swt.events.KeyListener;import org.eclipse.swt.events.SelectionEvent;import org.eclipse.swt.events.SelectionListener;import org.eclipse.swt.graphics.*;import org.eclipse.swt.widgets.*;import org.eclipse.swt.layout.*;import org.eclipse.swt.custom.*;public classimplements SelectionListener, KeyListener, FocusListener{ Display D; Shell shell; final Tree tree; TreeEditor ATreeEditor; public(Display d){ D = d; shell = new Shell (d); tree = new Tree (shell, SWT.BORDER); shell.setLayout (new FillLayout ()); for (int i=0; i<16; i++) { TreeItem itemI = new TreeItem (tree, SWT.NONE); itemI.setText ("Item " + i); for (int j=0; j<16; j++) { TreeItem itemJ = new TreeItem (itemI, SWT.NONE); itemJ.setText ("Item " + j); } } ATreeEditor = new TreeEditor(tree); ATreeEditor.grabHorizontal = true; ATreeEditor.horizontalAlignment = SWT.LEFT; ATreeEditor.minimumWidth = 50; tree.addSelectionListener(this); } public void Open(){ shell.pack (); shell.open (); while (!shell.isDisposed()) { if (!D.readAndDispatch ()) D.sleep (); } D.dispose (); } public void widgetSelected(SelectionEvent e) { this.PrepareEditor((TreeItem)e.item); } public void widgetDefaultSelected(SelectionEvent e) {} public void keyPressed(KeyEvent e){} public void focusGained(FocusEvent e){} public void focusLost(FocusEvent e){ this.DisposeEditor(); } public void DisposeEditor(){ Text TT = (Text)ATreeEditor.getEditor(); if (!TT.isDisposed()) TT.dispose(); } public void keyReleased(KeyEvent e){ } public void PrepareEditor(TreeItem tti){ Text CellEditor = new Text(tti.getParent(), SWT.BORDER); CellEditor.addKeyListener(this); CellEditor.addFocusListener(this); CellEditor.setFocus(); ATreeEditor.setEditor(CellEditor, tti); }}I managed to start working on this again.I am using Mac Os 10.4.8 and eclipse 3.2.2. I am using a different JVM from the one I used to open the bug.If I use setMinimumHeight the problem is solved. I will post again if the behavior is different on 3.3M5 otherwise this should be it.I believe using minimumHeight field of TreeEditor's superclass ControlEditor is not really a resolution, rather a workaround. I.e. clients of org.eclipse.jface.viewers.TreeViewerEditor can't access TreeEditor and control aspects like minimumHeigth. Since the issue seems to be in treatment of Text#setBounds() on different platforms (Win: TreeEditor#computeBounds().height == 20, perfectly readable; Mac: #computeBounds().height == 19, barely one third is visible), I'd ask for fix.This is not as bad on cocoa, but the text is not completely visible either.	12.0
id=276058	REOPENED	Platform	SWT	3.4	PC Windows Vista	P3 major	Silenio Quarti	2009-05-13 06:37 EDT by	Madhu Samuel	2012-06-21 14:57 EDT (	2 users	Build ID: I20080617-2000Steps To Reproduce:1. I created an SWT image using the swt Image class.2. I created a draw2d graphics instance using the GC instance.3. I drew a circle on the image.4. After that I changed the scale using the graphics.scale() method.5. The quality of the image is distorted. More information:	Please attach a SWT only snippet that reproduces the problem.For all I know it could be a problem on graphics.scale()closing as works for me, here is a SWT only testcase you can use for testing.public static void main(String[] args) { final Display display = new Display(); final Shell shell = new Shell(display); final Image image = new Image(display, 100, 100); GC gc = new GC(image); gc.setBackground(display.getSystemColor(SWT.COLOR_WHITE)); gc.fillRectangle(0, 0, 100, 100); gc.setForeground(display.getSystemColor(SWT.COLOR_RED)); gc.drawOval(0, 0, 99, 99); gc.dispose(); shell.addListener(SWT.Paint, new Listener() { public void handleEvent(Event event) { event.gc.drawImage(image, 0, 0); event.gc.drawImage(image, 0, 0, 100, 100, 100, 100, 200, 200); } }); shell.setSize(800, 600); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } display.dispose();}Thanks for posting the snippet.When you do a scale up (ie, making a small image bigger) the above issue is not significant.But if you scale down the image, the distortion of the image is easily recognizable. I have modified the previous example Mr. Heidrich has posted. Please use the below snippet to see the issue. You can notice that the quality of the smaller circle which is scaled down is less.TEMPORARY WORK AROUND---------------------We have found a temporary work around to live with the problem. ie, When I need to scale down an image by 50%, I will create one more image which is half the size of the previous image and draw the same contents into the new image using a scaled down Draw2d graphics instance.SAMPLE SNIPPET - SWT IMAGE SCALE DOWN ISSUE------------------------------------------import org.eclipse.swt.SWT;import org.eclipse.swt.graphics.GC;import org.eclipse.swt.graphics.Image;import org.eclipse.swt.widgets.Display;import org.eclipse.swt.widgets.Event;import org.eclipse.swt.widgets.Listener;import org.eclipse.swt.widgets.Shell;public class SWTImageIssue { public static void main(String[] args) { final Display display = new Display(); final Shell shell = new Shell(display); final Image image = new Image(display, 400, 400); GC gc = new GC(image); gc.setBackground(display.getSystemColor(SWT.COLOR_WHITE)); gc.fillRectangle(0, 0, 400, 400); gc.setForeground(display.getSystemColor(SWT.COLOR_RED)); gc.drawOval(0, 0, 390, 390); gc.dispose(); shell.addListener(SWT.Paint, new Listener() { public void handleEvent(Event event) { event.gc.drawImage(image, 0, 0); event.gc.drawImage(image, 0, 0, 400, 400, 400, 400,200, 200); } }); shell.setSize(800, 800); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } display.dispose();}}I'm afraid we can't help you.The result you get is what the native StretchBlt() does.You can improve the result using advance mode (gc.setAdvance(true)). AA will make the circle look better. Can you use advance mode in your application ?SSQ, the result of StretchBlt() depends on the stretch mode. We use colorncolor, which doesn't look good in this case. In this case, half tone and black on white work better.You should use GC.setInterpolation() in advanced mode to control the quality of stretching.When not in advanced mode, we could use half tone when we are reducing the size of the image. I remember playing with this in the past and have decided against it. I do not remember why right now. Maybe at the time Win98 did not support it. If that was the only reason, we could try again.I tried gc.setAdvanced() and gc.setInterpolation(SWT.HIGH). But these two approaches does not make any difference.When I use "gc.setAntialias(SWT.ON)" the results are better, but still needs improvement.	7.0
id=242280	REOPENED	Platform	SWT	3.4	PC Windows XP	P3 normal	Silenio Quarti	2008-07-28 14:11 EDT by	Randy Hudson	2008-12-11 09:39 EST (	3 users	When calculating the DRAW_OFFSET in GC, the scaling is first applied to the current penwidth. This doesn't match what the client saw when drawing unscaled. For example://gc.scaleBy(1.05);gc.setAntialias(SWT.ON);gc.setLineWidth(5.99f);gc.setForeground(red);gc.drawOval(somewhere);gc.setLineWidth(5);gc.setForeground(yellow);gc.drawOval(somewhere);The above code draw a yellow oval with a thin red outline around the yellow. As soon as you scale this such that 5.99 * scale >= 6.0, the rendering is messed up because SWT shifts the first oval by 0.5/scale, but not the second (when scaling by 1.05).The fix is to just not apply the scale, so:float penWidth = data.lineWidth;Further optimization: no need to fetch the current transform unless the penwidth is even.	Silenio, I have a patch for this bug, as well as a snippet that shows how to draw common shapes so that they render the right way whether with/without antialiasing, and with 100%, 200%, 300% scaling transforms applied (when you would hope for even anti-aliased shapes to "grid-fit" with real pixels).As you might hope, the "right way" to draw stuff at 100% with default settings requires no changes to code working today, whether it is invoking gdi or gdiplus. I'll try to attach the patch this afternoon. Ping me directly if you want.Please attached the patch.CreatedGC and GCData patchI still haven't tested TextLayout or gc.drawText(...).This patch changes GC to use GDI+ PixelOffsetNone all the time, and removes the drawOffset approach that was causing problems. For primitive fills (all fills except for fillPath), it is necessary to pre-translate (meaning prior to any user transforms like scaling) by -1/2 pixel. But then you have to also translate any "complex" brush back by the same amount due to gdip's different treatment of brushes when doing a primitive fill vs. "draw" operations.There is still a remaining issue with drawString, which seemed to have problems prior to this patch anyway. Font rendering seems to behave like a fill, but when I tried the fill approach I was seeing clipping at the top of one character.Createdgdiplus test packageUnzip this archive into your "src" folder with SWT on the classpath. Run the class AdvancedGraphics.I added a test for drawImage(), and found that it too requires the 1/2-pixel shift. I've updated GC locally but wanted to wait for additional feedback before submitting a new patch.Fonts seem to be working in the tests, so I'm not sure if they will require the 1/2-pixel correction or not. If only we had a font where each character was a solid rectangle... Does anyone know the /u#### for that character??CreatedScreenshotHere is a screenshot of the example with the previous patch applied.Legend:1st "column" is plain GDI painting2nd is GDI+ at 100%3rd is GDI+ at 200%3th is GDI+ at 300%Note that painting "stuff" at integral zoom levels (especially with anti-aliasing) requires that the client understand how things worked at 100%. When you call:gc.setLineWidth(1);gc.drawLine(0, 0, 99, 0);...which is equivalent to...gc.fillRectangle(0, 0, 100, 1);You do not get a line drawn along the "x-axis" (y == 0). You get a line centered around y == 0.5, extending +/-0.5. The point (0,0) is really (0.5, 0.5). So, if you want that same line at 300% to cover the first 3 pixels, you need to scale about the "real" origin, like so:transform.translate(-0.5, -0.5);transform.scale(3, 3);transform.translate(0.5, 0.5);This even works at 200%, so there are no tests needed in SWT to see if the line width is "even". The line falls exactly on 2 pixels, even if anti-aliased. Using the correct 200% transform yields results equivalent to calling:gc.setLineWidth(2);gc.drawLine(0.5, 0.5, 198.5, 0.5);//(CAP_SQUARE should be used, for best results)Since drawing is shifted down and to the right by 1/2 pixel, you end up with a line from (1,1) to (199,1), expanded by 1 (half the line width). With CAP_SQUARE, the result is the rectangle (0, 0, 200, 2), as expected.Note - other bugs encountered:- when "Textured" background option is enabled, fillGradientRectangle at 200% and above does NOT result in a gradient. The Pattern appears instead.- drawString(... transparent:FALSE) fills a rectangle starting 1-pixel to the left of the given x location, and whose right edge extends 1-pixel beyond the width of the string's extent. With advanced graphics turned on, the problem goes away (the filled rectangle is exactly the width/height of the string's extent).Silenio, what do you think of the proposed patch? This type of change could affect clients who may have worked around the current behavior, so it would be best if we could deliver it early in the release cycle.Silenio??Sorry, it is taking so long for me to look at this bug. I have done some investigation already and I will update the bug shortly.Ok, I finally understood this problem. The patch offsets fill operations by -0.5, but it does this after the user transformation. So if the user transformation scales by 2, the offset is actually -1 pixel in device coordinates. This causes fill operations to draw in the wrong x,y position when scaled. The following sample shows the problem. Change the scale factor and you will see the filled rectangle moving in the final picture.I believe the proper code in gdiFillPrepare() is to transform it by -0.5 using Gdip.MatrixOrderAppend instead of Gdip.MatrixOrderPrepend, but when this is done, the original bug comes back.This problem happens because subtracting -1 from the width and height of the stroked rectangle to make the stroked rectangle draw inside the filled rectangle is only correct when the line width is 1 and the transformation is the identity. I will post a snippet that shows how to do this next. import org.eclipse.swt.SWT;import org.eclipse.swt.graphics.GC;import org.eclipse.swt.graphics.Rectangle;import org.eclipse.swt.graphics.Transform;import org.eclipse.swt.widgets.Display;import org.eclipse.swt.widgets.Event;import org.eclipse.swt.widgets.Listener;import org.eclipse.swt.widgets.Shell;public class PR242280 { static final int SCALE = 10; public static void main(String[] args) { final Display display = new Display(); Shell shell = new Shell(display); shell.setBackground(display.getSystemColor(SWT.COLOR_WHITE)); shell.addListener(SWT.Paint, new Listener() { public void handleEvent(Event event) { GC gc = event.gc; gc.drawLine(30, 30, 30, 1000); gc.drawLine(30, 30, 1000, 30); gc.drawLine(30 + 3 * SCALE, 28, 30 + 3 * SCALE, 32); Transform t = new Transform(display); t.translate(30, 30); t.scale(SCALE, SCALE); gc.setTransform(t); t.dispose(); Rectangle r = new Rectangle(0, 0, 3, 3); gc.setBackground(display.getSystemColor(SWT.COLOR_RED)); gc.setLineWidth(1); gc.fillRectangle(r); } }); shell.setBounds(10, 10, 200, 200); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } display.dispose(); }}Here is the snippet I mentioned above:import org.eclipse.swt.SWT;import org.eclipse.swt.graphics.GC;import org.eclipse.swt.graphics.Path;import org.eclipse.swt.graphics.Transform;import org.eclipse.swt.widgets.Display;import org.eclipse.swt.widgets.Event;import org.eclipse.swt.widgets.Listener;import org.eclipse.swt.widgets.Shell;public class PR242280_2 { static final int SCALE = 10; public static void main(String[] args) { final Display display = new Display(); Shell shell = new Shell(display, SWT.DOUBLE_BUFFERED | SWT.SHELL_TRIM); shell.setBackground(display.getSystemColor(SWT.COLOR_WHITE)); shell.addListener(SWT.Paint, new Listener() { public void handleEvent(Event event) { GC gc = event.gc; int originX = 30, originY = 30; int x = 0, y = 0; int width = 10, height = 10; int lineWidth = 1; gc.drawLine(originX, originY, originX, 1000); gc.drawLine(originX, originY, 1000, originY); gc.drawLine(originX + width * SCALE, originX - 2, originX + height * SCALE, originX + 2); Transform t = new Transform(display); t.translate(originX, originY); t.scale(SCALE, SCALE); gc.setTransform(t); t.dispose(); gc.setLineWidth(lineWidth);// gc.setAntialias(SWT.ON); gc.setBackground(display.getSystemColor(SWT.COLOR_RED)); gc.setForeground(display.getSystemColor(SWT.COLOR_BLACK)); /* * Note that if a transformation is applied, it is necessary * to use path in order to have fractional shapes. */ { Path path = new Path(gc.getDevice()); path.addRectangle(x, y, width, height);// path.addArc(x, y, width, height, 0, 360); gc.fillPath(path); path.dispose(); } //Only necessary to show the stroke on top the fill gc.setAlpha(0x7f); { Path path = new Path(gc.getDevice()); float originOffset = lineWidth / 2f; float extentOffset = (float)lineWidth; path.addRectangle(x + originOffset, y + originOffset, width - extentOffset, height - extentOffset); // path.addArc(x + originOffset, y + originOffset, width - extentOffset, height - extentOffset, 0, 360); gc.drawPath(path); path.dispose(); } } }); shell.setBounds(10, 10, 200, 200); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } display.dispose(); } }CreatedSilenio's snippet running with the patchSilenio, I ran your snippet with my patch and the behavior seems completely normal. Could you describe what is wrong in the screenshots?(I've modified the colors and turned off the alpha in favor of a dashed line)Silenio, your example never painted properly unscaled. If the origin is (0,0), and line width is 1, your example draws a rectangle whose top-left corner begins at (0.5, 0.5), which is *NOT* (0,0). So, when scaled to 10x, the rectangle is supposed to be ~5 pixels (or 1/2 the line width) off the axes. Instead, it touches the axes, which it shouldn't. Your snippet looks correct at 100% if antialiasing is turned off, but if you turn on anti-aliasing and remove the transform in your original snippet, you can see that the rectangle does not really start at 0,0.Here is the correct version of the code, which works both with and without the transform, and with and without anti-aliasing enabled. Of course, you have to apply my patch for it to paint properly.shell.addListener(SWT.Paint, new Listener() { public void handleEvent(Event event) { GC gc = event.gc; int originX = 30, originY = 30; int x = 0, y = 0; int width = 10, height = 10; int lineWidth = 1; gc.drawLine(originX, originY, originX, 1000); gc.drawLine(originX, originY, 1000, originY); gc.drawLine(originX + width * SCALE, originX - 2, originX + height * SCALE, originX + 2); Transform t = new Transform(display); t.translate(originX - 0.5f, originY - 0.5f); t.scale(SCALE, SCALE); t.translate(.5f, .5f); gc.setTransform(t); t.dispose(); gc.setLineWidth(lineWidth); gc.setAntialias(SWT.ON); gc.setBackground(display.getSystemColor(SWT.COLOR_GREEN)); gc.setForeground(display.getSystemColor(SWT.COLOR_BLUE)); float originOffset = lineWidth / 2f; /* * Note that if a transformation is applied, it is necessary to use path * in order to have fractional shapes. */ { Path path = new Path(gc.getDevice()); path.addRectangle(x - originOffset, y - originOffset, width, height); // path.addArc(x, y, width, height, 0, 360); gc.fillPath(path); path.dispose(); } gc.setAlpha(0x7f); { Path path = new Path(gc.getDevice()); float extentOffset = (float) lineWidth; path.addRectangle(x, y, width - extentOffset, height - extentOffset); // path.addArc(x + originOffset, y + originOffset, width - // extentOffset, height - extentOffset, 0, 360); LineAttributes la = gc.getLineAttributes(); la.dash = new float[]{2f, 2f}; la.cap = SWT.CAP_FLAT; la.style = SWT.LINE_CUSTOM; la.dashOffset = 0.5f; gc.setLineAttributes(la); gc.drawPath(path); path.dispose(); } } }); shell.setBounds(10, 10, 200, 200); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } display.dispose();}CreatedscreenshotThis is what I get running the snippet from. Note that the red square is not at the origin (30, 30).Is the patch you are running different than mine? The patch fromdoes not apply completely to HEAD. I have to comment the block that calculate the DRAW_OFFSET.CreatedscreenshotRunning PR242280_2, only changed I made was in this line:originX = 1, originY = 1;The SWT I used is exactly what is in HEAD right now.Note that the rectangle (the fill and the draw) is exactly at 1,1CreatedScreenshot with lineWidth = 3Change the code fromto lineWidth=3 and look at the output.(In reply to)Forgot to say to run it with the patch applied.Silenio, the code inmust be modified to read: t.translate(29.5f, 29.5f); t.scale(SCALE, SCALE); t.translate(0.5f, 0.5f);This is something that could be hidden from the client. The patch could be modified to prepend and append the necessary 1/2 pixel shifts. I don't really understand why GDI-plus is performing scaling around the origin (0.5, 0.5).Here's the change to hide the 1/2 pixel translation from the user:Along with the patch, in GC#setTransform(...), change to:...if (transform != null) {+ Gdip.Matrix_Translate(identity, -0.5f, -0.5f, Gdip.MatrixOrderPrepend); Gdip.Matrix_Multiply(identity, transform.handle, Gdip.MatrixOrderPrepend);+ Gdip.Matrix_Translate(identity, +0.5f, +0.5f, Gdip.MatrixOrderPrepend);}...At one point I tried always using Gdip.PixelOffsetModeHalf, but I couldn't get that to work as well. I think that all of the brushes and pens had to be fixed by translating them 1/2 pixel, so NONE seemed to be the way to go.Ok, I went over the changes you made in, mainly:1) t.translate(originX - 0.5f, originY - 0.5f);t.scale(SCALE, SCALE);t.translate(.5f, .5f);2) You add subtracting lineWidth/2 from x and y in the fill3) You removed adding lineWidth/2 from x and y in the drawGiven that, the figure is exactly were it was supposed to be. -translate 29.5 to the right, then translate more 5 (0.5*scale) to right-then you subtracted 5 in the fill (linewidth/2 * scale), so the fill falls exactly at 29.5------What are you trying to do ?I thought you were trying to have the draw within the fill. Am I right ?Do you also want your figure to be antialiased ?Note that SWT snap all draws and fill in the middle of the pixel to make advance and non-advance drawing consistent.If that is the case all you have to do is to add .5 to the very first translate, the one before the scale.CreatedGC and GCData patch #2Here's an updated patch.Changes:- Merged with HEAD- Updated setTransform so that scaling is about the originCreatedAdvanced Graphics Test Package 2.0Updated version of the test package.Changes:- removed translations that were rolled into GC- Added additional "Tranpose" test settingIt's Silenio's snippet. I've uploaded a much larger snippet which visually tests the following assumptions:1) fillOval(...) should behave the same with/without an identity transform applied (i.e., turning on GDI+)2) drawOval(...) should behave the same with/without .....3) same for fillRect(...), drawRect(...), roundedRect, gradientRect, etc.4) drawPolygon(...) should behave the same as a Path with the same pointsPlease take a look at the test package with and without the patch applied. Also, let me know if the above assumptions are wrong. For example, maybe these two approaches to drawing a rectangle are supposed to behave differently:gc.drawRectangle(0,0,10,10);// vs.path.moveTo(0,0);path.lineTo(10,0);path.lineTo(10,10);path.lineTo(0,10);path.lineTo(0,0);gc.drawPath(path);(Without my patch, the path's rectangle is shifted down and right 1/2 pixel)Here's another assumption which fails (without the patch):- anti-aliased drawRectangle(0,0,10,10) translated by (2,2) should look the same as before, only shifted down and right exactly 2 pixels. In 3.4 at least, the translation would cause a non-zero gdipX/YOffset, causing bogus results.(In reply to)This has been fixed in HEAD. We are calculating the scaling factor with Graphics.TransformPoints() instead of Graphics.TransformVectors().(In reply to)Please give me a snippet that shows this. I believe both drawRectangle() and drawPath() shift down and right 1/2 pixel. So the drawing is identical.This is the snippet I tried (running against HEAD). We have to play with the usePath flag. I will attach a screenshot.import org.eclipse.swt.SWT;import org.eclipse.swt.graphics.GC;import org.eclipse.swt.graphics.Path;import org.eclipse.swt.graphics.Transform;import org.eclipse.swt.widgets.Display;import org.eclipse.swt.widgets.Event;import org.eclipse.swt.widgets.Listener;import org.eclipse.swt.widgets.Shell;public class PR242280_4 { static final int SCALE = 1; public static void main(String[] args) { final Display display = new Display(); Shell shell = new Shell(display, SWT.DOUBLE_BUFFERED | SWT.SHELL_TRIM); shell.setBackground(display.getSystemColor(SWT.COLOR_WHITE)); final boolean usePath = true; if (usePath) { shell.setText("drawPath"); } else { shell.setText("drawRect"); } shell.addListener(SWT.Paint, new Listener() { public void handleEvent(Event event) { GC gc = event.gc; int originX = 30, originY = 30; int x = 0, y = 0; int width = 10, height = 10; int lineWidth = 1; gc.drawLine(originX, originY, originX, 1000); gc.drawLine(originX, originY, 1000, originY); gc.drawLine(originX + width * SCALE, originX - 2, originX + height * SCALE, originX + 2); Transform t = new Transform(display); t.translate(originX, originY); t.scale(SCALE, SCALE); gc.setTransform(t); t.dispose(); gc.setLineWidth(lineWidth); gc.setAntialias(SWT.ON); gc.setBackground(display.getSystemColor(SWT.COLOR_RED)); gc.setForeground(display.getSystemColor(SWT.COLOR_RED)); if (usePath) { Path path = new Path(gc.getDevice()); path.addRectangle(x, y, width, height); gc.drawPath(path); path.dispose(); } else { gc.drawRectangle(x, y, width, height); } } }); shell.setBounds(10, 10, 200, 200); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } display.dispose(); } }Createdscreenshoot for drawPath versus drawRectangleWith the patch, fillPath() does not shift up and left so it draws different from fillRectangle() (which does).Again play with the usePath flag. I will attach a screenshot.import org.eclipse.swt.SWT;import org.eclipse.swt.graphics.GC;import org.eclipse.swt.graphics.Path;import org.eclipse.swt.graphics.Transform;import org.eclipse.swt.widgets.Display;import org.eclipse.swt.widgets.Event;import org.eclipse.swt.widgets.Listener;import org.eclipse.swt.widgets.Shell;public class PR242280_3 { static final int SCALE = 10; public static void main(String[] args) { final Display display = new Display(); Shell shell = new Shell(display, SWT.DOUBLE_BUFFERED | SWT.SHELL_TRIM); shell.setBackground(display.getSystemColor(SWT.COLOR_WHITE)); final boolean usePath = true; final boolean fill = true; if (fill) { if (usePath) { shell.setText("fillPath"); } else { shell.setText("fillRect"); } } else { if (usePath) { shell.setText("drawPath"); } else { shell.setText("drawRect"); } } shell.addListener(SWT.Paint, new Listener() { public void handleEvent(Event event) { GC gc = event.gc; int originX = 30, originY = 30; int x = 0, y = 0; int width = 10, height = 10; int lineWidth = 1; gc.drawLine(originX, originY, originX, 1000); gc.drawLine(originX, originY, 1000, originY); gc.drawLine(originX + width * SCALE, originX - 2, originX + height * SCALE, originX + 2); Transform t = new Transform(display); t.translate(originX, originY); t.scale(SCALE, SCALE); gc.setTransform(t); t.dispose(); gc.setLineWidth(lineWidth); gc.setAntialias(SWT.ON); gc.setBackground(display.getSystemColor(SWT.COLOR_RED)); gc.setForeground(display.getSystemColor(SWT.COLOR_RED)); if (fill) { if (usePath) { Path path = new Path(gc.getDevice()); path.addRectangle(x, y, width, height); gc.fillPath(path); path.dispose(); } else { gc.fillRectangle(x, y, width, height); } } else { if (usePath) { Path path = new Path(gc.getDevice()); path.addRectangle(x, y, width, height); gc.drawPath(path); path.dispose(); } else { gc.drawRectangle(x, y, width, height); } } } }); shell.setBounds(10, 10, 200, 200); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } display.dispose(); } }CreatedfillRectangle versus fillPath with patchWith the patch applied, the stroke is not centered in the path edge when scaling using transforms (it is aligned on the inside of the edge). The user should be able to scale the path manually and have the same output as applying the equivalent transformation.Play with the useTransform flag. I will attach screenshot.import org.eclipse.swt.SWT;import org.eclipse.swt.graphics.GC;import org.eclipse.swt.graphics.Transform;import org.eclipse.swt.widgets.Display;import org.eclipse.swt.widgets.Event;import org.eclipse.swt.widgets.Listener;import org.eclipse.swt.widgets.Shell;public class PR242280_5 { static final int SCALE = 10; public static void main(String[] args) { final Display display = new Display(); Shell shell = new Shell(display, SWT.DOUBLE_BUFFERED | SWT.SHELL_TRIM); shell.setBackground(display.getSystemColor(SWT.COLOR_WHITE)); final boolean useTransform = false; if (useTransform) { shell.setText("setTransform"); } else { shell.setText("scale by hand"); } shell.addListener(SWT.Paint, new Listener() { public void handleEvent(Event event) { GC gc = event.gc; int originX = 30, originY = 30; int x = 0, y = 0; int width = 10, height = 10; int lineWidth = 1; gc.drawLine(originX, originY, originX, 1000); gc.drawLine(originX, originY, 1000, originY); gc.drawLine(originX + width * SCALE, originX - 2, originX + height * SCALE, originX + 2); if (useTransform) { Transform t = new Transform(display); t.translate(originX, originY); t.scale(SCALE, SCALE); gc.setTransform(t); t.dispose(); } else { x += originX; y += originY; width *= SCALE; height *= SCALE; lineWidth *= SCALE; } gc.setLineWidth(lineWidth);// gc.setAntialias(SWT.ON); gc.setForeground(display.getSystemColor(SWT.COLOR_RED)); gc.drawRectangle(x, y, width, height); } }); shell.setBounds(10, 10, 200, 200); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } display.dispose(); } }CreatedsetTransform() versus scaling by hand with patchHere is another snippet which produces strange results without the patch:shell.addListener(SWT.Paint, new Listener() { public void handleEvent(Event event) { GC gc = event.gc; gc.setLineWidth(1); Transform t= new Transform(null); t.scale(6, 6); gc.setTransform(t); gc.setBackground(display.getSystemColor(SWT.COLOR_RED)); gc.fillRectangle(0, 0, 10, 10); gc.drawRectangle(1, 1, 7, 7); t.translate(15, 5); t.rotate(180); t.translate(-15, -5); gc.setTransform(t); gc.setBackground(display.getSystemColor(SWT.COLOR_BLUE)); gc.fillRectangle(10, 0, 10, 10); gc.drawRectangle(11, 1, 7, 7); }});What's happening is the 1/2-pixel shift should be in the up+left direction due to the 180-degree rotation. I mentioned this via e-mail. I already have the fix incorporated in with my other changes.We need to decide what set of options to expose to clients. I think the choices are:1) RAW - do nothing2) HALF - Shift all operations by 1/2 pixel (equivalent to PixelOffsetNone)3) SHIFT_ODD_DRAWING - When line width is odd, shift all drawing by (+.5,+.5).4) SHIFT_EVEN_DRAWING - When line width is even, shift drawing by (-.5, -.5). This isn't really useful for clients, but it is how one implements (3) on top of a "PixelOffsetNone" drawing system.Scope of the shifting (when to shift):A) "INTEGER_DRAWING" - Only shift for drawing API which takes integers. If Paths are used, the behavior is RAW.B) "INTEGER_DRAWING_AND_FILLS" - Same as (A), but fills, especially fillPolygon(int[]), need to be shifted too. The shifting for fills could be sensitive to the linewidth being odd. Example: //Trying to draw an "down" triangle int triangle[] = new int[]{0,0, 8,0, 4,4}; gc.setBackground(blue); gc.setForeground(black); gc.fillPolygon(triangle); gc.drawPolygon(triangle);Without shifting both the draw and fill, the triangle will look bad, with anti-aliasing on or off.IMHO, I would only ever want the following two modes:MODE1 : (1) RAWMODE2 : (3+B) When line width is odd and using integer API, shift both strokes and fills.MODE2 is basically the "win32-GDI compatibility mode", but it is also the "convenience" mode, allowing clients to work with integers and still get crisp output.I already have these two modes implemented for win32, but I don't like the way that I have to do the shifting. I think GDI+ and WPF both have API which takes floats. It would be much easier if we could call those methods instead of playing with the transforms.Silenio-Can you guys decide IF and WHICH modes you want? It's getting pretty far along in the milestones and GEF would need some time afterwards to benefit from these improvements in SWT. I can work on a patch for win32 and Cocoa once I hear back from you, although I don't know how to add new native methods to OS/Gdip.Hi Randy, Silenio is on vacation. He will be back on the first week of January.Last time I talked to him we talked about adding a pixel "mode" for GC.The two modes we would have:1) the current one (unmodified), or win32-GDI compatibility mode as you called.2) PixelOffsetModeHalf, which you called RAW I believe. The implementation would be the same in all platforms: don't compute drawXOffset, drawYOffset in checkGC(); don't ever translate anything for free. Let the native drawing draw where it wants. GDI+, cairo, and mac are consistent in this matter.We will have to wait SSQ to get back before making any decision. But can you try (2) and let us know if it would work for you ?Note: this is how GDI+, cairo, and mac defined the drawing natively. If it worked for them, it shold work for us.CreatedPatch with API to toggle compatibility modeFelipe,here's the patch which adds the API for toggling pixel offset compability mode.	35.0
id=243618	REOPENED	Platform	SWT	3.4	PC Windows XP	P3 normal	Silenio Quarti	2008-08-08 14:23 EDT by	Randy Hudson	2008-11-25 10:44 EST (	2 users	The problem seems to be that 1/2 pixel is being added for draw operations (but not for fills) when the line width is an odd number, which is why even the 100% case is not working.Here's a modified version of the snippet that applies the same 1/2-pixel shift for fillOval, which gives the expected results:public static void main(String[] args) { final Display display = new Display(); final Shell shell = new Shell(display); shell.setText("Shell"); shell.setBackground(display.getSystemColor(SWT.COLOR_BLUE)); final Color YELLOW = display.getSystemColor(SWT.COLOR_YELLOW); shell.addPaintListener(new PaintListener() { public void paintControl(PaintEvent e) { GC gc = e.gc;// gc.setAntialias(SWT.ON); gc.setLineWidth(1); Transform t = new Transform(null); gc.setTransform(t); gc.setBackground(YELLOW); paintOval(gc, t, 0.5f); t.scale(3f, 3f); gc.setTransform(t); paintOval(gc, t, 0.5f/3); t.dispose(); } private void paintOval(GC gc, Transform t, float correction) { t.translate(correction, correction); //Apply the missing 1/2-pixel shift when filling gc.setTransform(t); gc.fillOval(10, 10, 20, 20); t.translate(-correction, -correction); gc.setTransform(t); gc.drawOval(10, 10, 20, 20); } }); shell.setSize(200, 200); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } display.dispose();}	To see same problem for Paths, "apply" this "patch": final Color YELLOW = display.getSystemColor(SWT.COLOR_YELLOW);+ final Path path = new Path(display);+ path.moveTo(40, 15);+ path.lineTo(60, 5);+ path.lineTo(80, 15);+ path.lineTo(60, 25);+ path.close();and gc.setTransform(t); gc.fillOval(10, 10, 20, 20);+ gc.fillPath(path); t.translate(-correction, -correction); gc.setTransform(t); gc.drawOval(10, 10, 20, 20);+ gc.drawPath(path);See related. Because of it, the problem shown here disappears for scale factor 2.0.*** This bug has been marked as a duplicate of***Sorry, I meant to resolve another GEF bug as duplicate, not this one. Reopened.	4.0
id=405450	REOPENED	Platform	SWT	3.7.2	PC Windows All	P3 major	Silenio Quarti	2013-04-11 06:12 EDT by	Qian Liang	2014-01-10 07:00 EST (	5 users	To support IAccesible2 API, we are trying to create Accessible object for each table cell in a custom table. For performance, we just create Accessible object as needed. The goal is not to create Accessible object for cell when there is no AT running.When cell focus changed, we will call tableAccessible.setFocus(childID) to fire an accessibility focus change event. In such case, code in Accessible.setFocus(childID) will result in a call to getChild() which cause a cell Accessible object created even with no AT tools running. Here is the call stack: STableRow(STableItem).getAccessible(Accessible) line: 2776 STable$41.getChild(AccessibleControlEvent) line: 8718 Accessible.checkUniqueID(int) line: 4619 Accessible.childIDToOs(int) line: 4645 Accessible.setFocus(int) line: 1385 STable.fireFocusAccessibilityEvent() line: 8243 STable.onBodyFocusIn(Event) line: 1478 STable$4.handleEvent(Event) line: 804 EventTable.sendEvent(Event) line: 84 STableBody(Widget).sendEvent(Event) line: 1053 STableBody(Canvas).WM_SETFOCUS(int, int) line: 448 STableBody(Control).windowProc(int, int, int, int) line: 4598 Display.windowProc(int, int, int, int) line: 4972 OS.SetFocus(int) line: not available [native method] One solution to improve: in Accessible.setFocus(childID) method, check refCount first. If refCount <= 1, it means that only current application running, not AT tools available. In such case, we do not need to fire COM event any more, thus no Accessible object for child will be created. Here is the code:org.eclipse.swt.accessibility.Accessible.java public void setFocus(int childID) { checkWidget(); if(this.refCount>1){ // only there is AT tools running, we need to fire COM event int osChildID = childID == ACC.CHILDID_SELF ? eventChildID() : childIDToOs(childID); if (DEBUG) print(this + ".NotifyWinEvent EVENT_OBJECT_FOCUS hwnd=" + control.handle + " childID=" + osChildID); COM.NotifyWinEvent (COM.EVENT_OBJECT_FOCUS, control.handle, COM.OBJID_CLIENT, osChildID); } }Could you help to review above solution to the problem? Could we contribute this to Eclipse build. Thanks!	We can't always trust that the refCount will be accurate - for example, if a screen reader crashes, then the refCount may never be decremented back down to 1.However, there is a platform way to tell if a screen reader is running.On Windows:static boolean isATRunning() { final int SPI_GETSCREENREADER = 70; int [] pvParam = new int [1]; boolean result = OS.SystemParametersInfo(SPI_GETSCREENREADER, 0, pvParam, 0); return result && (pvParam [0] != 0);}On Mac:static boolean isATRunning() { NSUserDefaults defaults = NSUserDefaults.standardUserDefaults(); defaults.addSuiteNamed (NSString.stringWith("com.apple.universalaccess")); defaults.synchronize(); return defaults.integerForKey (NSString.stringWith("voiceOverOnOffKey")) != 0;}On GTK:static boolean isATRunning() { // Currently no platform way to get this info on GTK. // See:// andreturn true;}Although the refCount is not always accurate, it does not matter. In most case, screen reader will not run and the refCount is always 0. We can improve performance in such situation. For screen reader crash scenario, even refCount is always 1, we just always send the focus event if the setFocus method called. It has no any bad effect.Even we have way to know whether AT tools is running in each platform, it is not good to add such kind of code each time we call setFocus. This should not be handled by upper layer applications. Thanks!The detecting code ofis going to add uncecessary overhead when the AT is running. I believe checking the refCount is a good compromise.FixedNote that the final fix also avoids sending other events.Fix for this bug has caused a regression w.r.t. functioning of JAWS screen reader, refer:- [Accessibility] [Regression] - JAWS does not read text from label associated with text fieldThe below assumption made in this bug fix does not hold true for JAWS screen reader:"refCount <= 1, it means that only current application running, no AT tools available"But when JAWS screen reader is running the refCount continues to be 1, so JAWS is not able to read text from label.In order to fix issue in, required to partially revert change done as part of this bug.'refCount' approach to optimize Accessible code has being reverted, since it broke the functioning of JAWS.Re-opening this bug for further investigation.Reverted the fix for this bug via	6.0
id=440380	REOPENED	Platform	UI	4.4	PC Linux	P3 normal	Simon Scholz	2014-07-24 14:15 EDT by	Lars Vogel	2016-04-20 12:14 EDT (	1 user	This version of FilteredTree sets showFilterControls to true, as it cannot access the 3.x platform preferences like the origin. We should remove this field and associated code. Also a FilteredTree without filter is a Tree and customers can simply use a tree in this case.	Not that importantNow that the e4 tools are not using this tree anymore we should be able to remove it.Mass move to 4.7 as M7 is approaching. Please move back in case you are planning to fix it for Neon.	3.0
id=442747	REOPENED	Platform	UI	4.4	PC All	P3 minor	Simon Scholz	2014-08-27 19:34 EDT by	Simon Scholz	2016-03-23 13:13 EDT (	2 users	In my opinion the following three methods of the ColumnViewer should be deprecated, as the JavaDoc of those methods already states that the ViewerColumn´s EditingSupport is more flexible and therefore better.-org.eclipse.jface.viewers.ColumnViewer.setCellEditors(CellEditor[])-org.eclipse.jface.viewers.ColumnViewer.setCellModifier(ICellModifier)-org.eclipse.jface.viewers.ColumnViewer.setColumnProperties(String[])When deprecating those methods, also the ICellModifier interface can be deprecated.	+1 for the change, please provide a Gerrit review for it.See patchAlso moved "old" cell editor EditingSupport to the DefaultColumnViewerEditingSupport class, so that there is less deprecated code in the ColumnViewers class.We set a bug to Fixed once the patch is applied.At the moment platform.ui, PDE (and potentially JDT) is still using the old API. If we want to deprecate this, we need to remove this usage. Simon, please create new bug reports for this adjustment and mark this bug as dependent on this changes.(In reply to Lars Vogel from)Any update on the new bug report for the remove of the usage of the old API? We should start in platform.ui.(In reply to Lars Vogel from)Ping?	6.0
id=506081	REOPENED	Platform	SWT	4.7	PC All	P3 enhancement	Simon Scholz	2016-10-17 09:37 EDT by	Simon Scholz	2017-02-22 06:33 EST (	6 users	The SPACING constant in the CTabFolder should be changable via setter.There even already is a TODO above the SPACING constant asking whether a setter for the SPACING should be added.One of our customers needs to change the SPACING to 0 in order to have the Chevron directly besides the tabs. It´s a UI requirement for them.	New Gerrit change created:New Gerrit change created:Gerrit changewas merged to [master].Commit:Removing the target as it's not clear when it will be in mergeable state.I think offering a setter might be overkill. I suggest to set the spacer to zero in our default implementation. This way we avoid "wasting" useful space in the UI. Openedfor that.(In reply to Lars Vogel from)Agree, setter just for the purpose of setting the Chevron spacing doesn't sound a good idea(owing to it limited use)Instead of above, I suggest to add a more generic API like:CTabFolder#ignoreMargins (boolean )By default margin will not ignored in eclipse, this flag when turned 'ON', will draw CTabFolder more compact by ignoring the Chevron margins.This API gives scope for future improvements to ignore any other extra margin/spacing in CTabFolder.(In reply to Niraj Modi from)This is a great suggestion and will solve our customer RCP implementation problem. The additional spacing was identified as a show-stopper for our current customer. I prepare a review for M5. Unfortunately I cannot updateas I'm not a SWT committer.(In reply to Lars Vogel from)That's fine, you could create an alternate gerrit patch.Moving to M6New Gerrit change created:(In reply to Eclipse Genie from)Need some detailing on JavaDoc and I also think we should have equivalent getter method as well for 'ignoreMargins' may be something like below:setIgnoreMargins()/getIgnoreMargins()Thanks for the updated patch Lars, changes looks good to me.Suggest we add JUnit test for the new APIs as well.New Gerrit change created:(In reply to Niraj Modi from)Test have been added viaDue to fix forwhich is also in CTabFolder, have to manually rebase the patches. Hence, I combined the changes of gerrit&and merged to master via below git commit:Resolving now.Thanks Niraj for the fast feedback cycle during the review.Hi Niraj,CTabFolder has marginWidth and marginHeight fields which are already APIs. The new API name setIgnoreMargins() seems to be misleading that it would ignore these margin fields, but that is not the usecase of this API. Since the API is specific to ignoring chevron spacing, I think the name should be more specific and clear. Something like setIgnoreChevronSpacing()/setIgnoreChevronMargin(), what do you think? Any other ideas?(In reply to Lakshmi Shanmugam from)The idea for setIgnoreMargins() method was to make it generic to have future scope to ignore the spacing or margins w.r.t. CTabFolder. But with current API naming convention it wrongly sounds like we are ignoring the marginWidth and marginHeight field values.Yes, that was the original idea but owing to the limited use for this API it sounds an overkill.I suggest we revert the current API changes and instead make the SPACING field non-staic and public, just like the marginWidth and marginHeight fields ?Am analyzing on this, will revert back shortly.(In reply to Niraj Modi from)That would also be fine for our use-case.(In reply to Lars Vogel from)Thanks for confirming on this.Reverted today's change via below git commit:New Gerrit change created:CreatedIssues_seen_in_Snippet165_with_0_Spacing(In reply to Eclipse Genie from)Thanks Lakshmi for verifying the above patch.Hi Lars,It seems with 0 spacing we have multiple drawing problems as seen with Snippet165(see attachment). Reason being the spacing field is used at many places apart from chevron spacing.But, interestingly we don't see any issues in Eclipse with 0 spacing, we don't have a definite explanation to this, it needs to be investigated on UI side.(In reply to Niraj Modi from)Even with the spacing set to 0, CTabFolder in Eclipse seems to have more spacing. This may be caused due to the CTabFolderRenderer used by the Platform UI code.(In reply to Lakshmi Shanmugam from)Which platform are you using? We noticed that too under GTK but on Windows the spacing is really zero.(In reply to Lars Vogel from)I tested on Mac. See attached screenshot.Createdscreenshot on mac	26.0
id=337464	REOPENED	Platform	SWT	3.6.1	All All	P3 normal	Silenio Quarti	2011-02-17 11:40 EST by	Alexander Nyßen	2011-02-17 11:48 EST (	1 user	Within GEF's Graphics, we have implemented a local method to clone LineAttributes. It would be nice if LineAttributes would be cloneable itself, so we could remove this from our code.	only ImageData and StyleRange are cloneable in the entire toolkit.I'll let SSQ decided this one.(closed my mistake, sorry)	2.0
id=490038	REOPENED	Platform	IDE	4.6	PC All	P3 enhancement	Snjezana Peco	2016-03-20 14:43 EDT by	Fred Bricon	2016-03-29 08:17 EDT (	4 users	When creating a new file from the New > File menu, type foo/bar/Some.properties as file name causes an error "/ is an invalid character in resource name 'foo/bar/Some.properties'."This forces users to first create the parent folders from the new Folder wizard, which is clearly a suboptimal workflow. Most modern IDEs allow the creation of a new File by allowing path+filename. Would be awesome if Eclipse could also create the file hierarchy when necessary.	CreatedProviding a pathYou can do it, but the path needs to be done in the parent folder area. It seems weird until I realized that having directories in the "File name:" widget was equally weird.Marking as WORKSFORME.This definitely counts as a UX fail to me.Can't we just have 1 input text, prepopulated with the current path?(In reply to Fred Bricon from)+1, Gerrit reviews welcomeNew Gerrit change created:fixes the issue.I have tested it on Windows and Linux.Thanks for the speedy patch Snjezana. I posted some comments on the patch. This ResourceAndGroupContainer is used in other areas (the SaveAsDialog and the NewFolderWizardPage) and if we're going to fix this in one place, we should fix them in all. But more to the point, having two areas for path names is kinda silly and if we're going to revisit one for UX reasons then we should do this right.If we allow specifying new paths in the file name area, then we can get rid of the parent path area to the top and just use the path selection in the directory-selection area.(In reply to Brian de Alwis from)I am not sure what change exactly you want. I could create a wizard with a field (as it is in Intelij IDEA), but maybe some users would want the existing behaviour. The current patch won't change the behaviour of the existing wizard.If this patch is acceptable, I can add it to other places, too.BTWI have also fixed a bug that can be reproduced in the following way:- enter an invalid file name ("/", for instance)- click the Advanced buttonYou will get the "Unhandled event loop exception" exception.I have updated the patch -.(In reply to Snjezana Peco from)The patch should change the existing wizard so that the folder and the file name is in one field, prepopulated with the current path. Seeand.(In reply to Lars Vogel from)That would require the API changes. Do you really want to change the mentioned wizards and dialog?(In reply to Snjezana Peco from)I think we could change the UI representation of the wizard without API breakage. But I'm also OK with fixing the behavior of the existing UI, if that is what you prefer.	12.0
id=465280	REOPENED	Platform	SWT	4.5	PC Linux	P3 normal	Snjezana Peco	2015-04-23 06:39 EDT by	Sopot Cela	2016-06-07 11:06 EDT (	9 users	CreatedSnippet to reproduce the issueIn GTK2 (and windows) if you call getSize on a control that has been set to not be visible the getSize method still returns non-zero values but with GTK3 it returns (0,0) if the control is not visible.This inconsistent behavior is causing a test to fail under PlatformUI, namely UIDialogsAuto#testShowView.Find attached a snippet to reproduce the issue.	From:Invisible widgets now return a size of 0x0.(In reply to Alexander Kurtakov from)Calling getSize() on a control will return the width and height of topHandle for that control, which is the swtFixed container/object for that particular control.In Gtk3, widgets that are not visible will return a size of 0x0. For widgets (buttons, labels, etc.) this will be 1x1 (with x and y coordinates of -1). In the case of swtFixed, it appears to be 0x0. Gtk2 returns the size allocated to the widget regardless of whether it is visible or not.(In reply to Eric Williams from)I should clarify: native widgets (which are not visible) return a size of 1x1 and coordinates of -1. SWT widgets have swtFixed containers/objects, therefore calling getSize() on an SWT widget returns 0x0, since the call uses the GtkAllocation of the swtFixed container/object.New Gerrit change created:New Gerrit change created:***has been marked as a duplicate of this bug. ***Can this be reviewed for M4? It breaks our e4 tools, see.Gerrit changewas merged to [master].Commit:Hi Snjezana, Looking at the code, it seems that calling setVisible(true) and setVisible(false) will cause unnecessary SWT.Show and SWT.Hide events to be sent every time computeSize() is called. There could be other side-effects too of calling setVisible() in computeSize(). Can you please verify?(In reply to Lakshmi Shanmugam from)SWT.Show and SWT.Hide events will be called for GTK3 (sometimes for GTK2) when a control is invisible.I haven't looked into details but using gtk_widget_show/hide should be better option than doing the full SWT cycle setVisible.(In reply to Alexander Kurtakov from)+1. We should try to use gtk_widget_show/hide () instead of setVisible () to achieve the same effect.(In reply to Snjezana Peco from)Thanks for verifying, Sravan. I'm not sure, but there could be other side-effects too since setVisible() does other things.(In reply to Arun Thondapu from)But, we can't use it for Custom Controls as they have common code for all platforms.IMHO it's better to revert the patch for M4 and find a fix that works for both native and custom controls for M5.Sorry, I meant to say - Thanks for verifying, Snjezana.(In reply to Lakshmi Shanmugam from)I don't think this change is even necessary for the custom controls, it should be enough to make the change in the native controls alone AFAICS, because the computeSize() methods in the custom controls anyway use the computeSize() methods from the native controls internally...It would have been good to have this bug fixed in M4 as it affects UI scenarios like the one mentioned in, but I agree that we should find the optimal solution to avoid the side-effects of using setVisible() here.Reverted the patch viaand moved to M5.New Gerrit change created:uses gtk_widget_show/gtk_widget_hide to fix the issue.The patch fixes the issue described inand.Calling gtk_widget_show/gtk_widget_hide for Shell locks Eclipse.As to the CCombo, CLabel, CoolBar and CTable class, I haven't changed them because there aren't any known issues related to these classes. If we face an issue related to them, we will be able to fix it using the setVisible method.(In reply to Arun Thondapu from)is one example of an undesirable side-effect caused by toggling visibility using setVisible().I'm not sure if the patch using gtk_widget_show/gtk_widget_hide would exhibit this or other similar problems, needs to be tested to confirm...(In reply to Arun Thondapu from)In my opinion, the issue described inisn't related either to this bug or to any patches I have created within it.I can reproduce it on Mars.1, Neon M3, the current SWT master with or without these patches using GTK >= 3.14.It is easier to reproduce it on a slower machine. Try to start several Eclipse instances.isn't fixed, but it is a duplicate of.I think Alexander is right. SeeWith the latest code also the ui test testShowView(org.eclipse.ui.tests.dialogs.UIDialogsAuto) fails.This test actually test the get_allocation using hidden buttons.moving to M6 as review is not completeIs it possible to have a look at the problem for M6. There are some issues with the attached gerrit PatchMoving to M7 now as it is still not clear whether the patch is fixing the real problem or not...the patch still does not fix the main issue so moving out of 4.6. since it only test failure I am reducing the severityI haven't read into this bug too deeply, but I've worked on Visibility issues in:- ScrolledComposite is empty if it is hidden and then made visible via setVisible(true|false) I added a check that shows a widget in setBounds() if it's suppose to be shown on SWT side but hasn't been shown on GTK side.It might be a bit relevant to this bug.	25.0
id=39184	REOPENED	Platform	SWT	3.0	All All	P3 normal	Steve Northover	2003-06-20 15:27 EDT by	Nick Edgar	2009-10-23 19:20 EDT (	6 users	build I20030618The UI team has received a question on how to position a context menu so that it does not obscure a control that is located at the bottom of the window.Positioning of the menu can be achieved using the new MenuDetect event, however there is no way to determine the height of a Menu.They require methods like Menu.getSize() and/or Menu.getBounds().There also seems to be no getLocation() to match up with setLocation().	We are also encountering problems with not being able to determine the height of a Menu or getting its bounds. This is information that we need to be able to get from a Menu to place it how we want to.It won't happen for 3.0 because we are API frozen (unless mountains are moved with the PMC). Sorry about that.*** This bug has been marked as a duplicate of***The underlying window systems typically can not provide size information until after the menu has been popped up. They do however support the notion of "alignment" (e.g. pop up above, below, or centered on a point).If SWT provided access to this alignment capability, then it could be used to solve the problem identified by the original poster. Fixing this would require a new setAlignment() method on Menu (and supporting SWT.UP, SWT.CENTER, SWT.DOWN styles?), meaning that this would probably be done for R3.1.This bug is not a duplicate of 38436.There's been no activity on this bug for more than 2 years. Can we get this on the list of things to be addressed for 3.3? The bug is showing up in our product.McQ is right. Determining the height of a menu is most likely not what you want. Even if all the platforms could be convinced to give up the height, when items are added dynamically before a menu is shown, the height will change. Also,documents the fact that we can't get this information on the Mac anyways (yes, it does say it somewhere if you can ignore all the arguing with Tom).Are you after menu alignment instead?***has been marked as a duplicate of this bug. ***Yes, the alignment solution is perfect - actually the menu size is irrelevant in 90% of the cases.Could you decide on a "target milestone"?Well, you have a perfect workaround (i.e. setting the menu alignment) that is readily implementable in Eclipse 3.6.Perhaps the number of votes or the venerable age of such a well bred bug are discouraging?	8.0
id=24052	REOPENED	Platform	SWT	2.0	PC Windows 2000	P3 normal	Steve Northover	2002-09-24 15:00 EDT by	John Arthorne	2014-02-22 14:06 EST (	20 users	Build 20020917I use the windows task bar in "auto-hide" and "always on top" mode, at thebottom of my screen. I have my main Eclipse workbench window filling most ofthe screen, so that at the bottom it overlaps the area occupied by the windowstask bar. I have noticed in builds from the past month or so that Eclipse oftenends up on top of the windows task bar, even though the task bar should be"always on top".I do not have a reproducible case, but in the course of developing this happensto me at least every half hour. This did not occur at all in release 2.0, and Ihave not seen this behaviour in any other applications.I will attach a screen capture that shows this. Notice in this picture that thewindows task bar has popped up on top of Netscape, but is still hidden behindEclipse.	Createdjpg screen shot showing hidden task barThanks John. I have no idea how this could be happening. Please be on the look out for a repeatable case. I tried a bit and couldn't get it to happen.I'll keep trying. It feels timing related though. Sometimes I can reproduceit, then I repeat exactly the same steps again and it doesn't happen. The basicflavour is that I click somewhere that causes widgets to be created or revealed,and while it is still painting I move the mouse to the bottom of the screen tocause the task bar to pop up. Here are some cases where it has happened (butnot reproducibly):- Click on another perspective in the toolbar on the left hand side. While itis coming up, move mouse to bottom of screen to reveal taskbar, but it pops upbehind Eclipse shell.- Move mouse to bottom of screen, and task bar pops up on top. Hit Ctrl+F6 toswitch to another editor, and Eclipse jumps on top of the taskbar.- While editing and using F3 to jump around between editors, occasionally movemouse quickly to bottom of screen. Sometimes the taskbar will come up behindeclipse.Another note: once the taskbar is behind Eclipse, it will stay there. Switchingto other applications, revealing and hiding the taskbar, will not bring it backon top of Eclipse. Only clicking on the taskbar itself will bring it back tothe top once it has dropped behind.***has been marked as a duplicate of this bug. ***must have something to do with those buggy tooltips: some did badly use alwayson top, or the native ui stuff is again in the way.***has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ******has been marked as a duplicate of this bug. ***From Randy Hudson on: "This may seem obvious, but is it possible that you don't have the setting "Keep the taskbar on top of other windows" enabled? I have auto-hide and keep-on-top enabled, and I have never seen this problem."Randy's comment doesn't apply in my case. I have always on top turned on. Asseen from the screen shot, other apps are drawing behind the task bar asexpected, while only Eclipse is drawing on top of the task bar.To easy your pain:my workaround is to press the 'windows' key.(Yes, I finally found a usage for it after all these years!)I have the same problem, and it has been happening since Eclipse version 1.Moreover Thinkpad laptops don't have the windows key...I've been having the same problem with Eclipse for a while as well (I don't remember when it started). Interestingly, it affects not only the primary Windows task bar, but also the additional task bar created by UltraMon on my secondary monitor, and the sidebar created by Desktop Sidebar. Both of these are set as "hidden, always on top" as well, which may point towards a more general z-order problem in Eclipse.I have gotten the same thing in windows, it also does this when using a shell replacement for explorer.Me too.I also noticed it on my coworkers PC.Windows XP Pro SP2, Eclipse 3.2(for those with no Windows key, try ctrl-ESC)I usualy see this, when I start the Java program I'm working on from Eclipse (F11 key, debug).Sigh ... what could we be doing?I have the same problem, and I've noticed this happening for some time over several years for many versions of Eclipse, mostly against XP.Wow, this bug is already 5 years old.This also happens to me with my "Quick Launch" tool bar set to "always on top" and "auto-hide".I am using Eclipse 3.3.0.Since I have nothing to debug and the problem does not happen to me or anyone else I know, how can I possibly make progress on it?Can you make it happen every time? If so, please get me some steps.If it helps, I also noticed similar problems with other Java based programs.The jump to the foregorund, grab focus etc...For example MKS Integrity.So maybe it is a JRE problem.I personally didn't experience the eclipse-over-taskbar problem for months now, so I can't help.I don't see how it could be a Java problem ... except for running javaw.exe vs java.exe. Hopefully, the JVM isn't making window system calls.Who is then ???(read: how does then the picture get on the monitor ?)Hi,After some days testing this problem I have the following information:- The toolbar gets under all the other windows, even Putty or Outlook;- I have no idea of how this starts happening, but it takes a long time;- I started using Eclipse a few weeks ago and I never had this problem for years using other Java tools, that is why I think Eclipse is causing this;It just happened again and now I noticed that it was after a small freeze in Eclipse where the menu bar disappeared for a while (the area occupied by the menu was still there but it was blank).I was in the C/C++ perspective.I have seen this problem both with Eclipse and with other Java applications. Could one of these be related:Don't know if it's important, but I'm running dual screen.Happened again. At this time I typed crtl-L and it did not respond, after that the menu bar disappeared for a while and then I verified that the problem really happened.Createdscreen shot of the windows when the menu bar disappearsNotice that the icon is not the Eclipse one.Eclipse 3.1.2 and 3.3.0 on WinXP, sun java build 1.5.0_13-b05I use it in my work and experience the problem several times each day.I always have the eclipse windows maximized, maybe that is a contributing factor ?I'm sorry but WORKSFORME. We never got it to happen here so we didn't have anything to debug.Interresting. I noticed that too.I agree. In fact, another comment says that the taskbar goes under other apps too.Could windows shell be raising that taskbar Z index so high that it wraps around to 0 or negative?I still experience that with eclipse 3.4.I still have XP sp2.Question, are all of you guys on the classic window manager?Just in case...I am. Also, I don't use animations, I have a border width at 3 pixels. I have had powertoys tweakui set the 'don't steal focus - flash n times in taskbar' option enabled, I have menu delay set to 1 ms. Does anything in there ring any bell?SWT is quite native... I wouldn't rule that out, no?I have the same windows settings as in, except I did not change anything related to "border width".Do you have steps on your computer that makes this bug happen?I also experienced this problem on two installations of Eclipse 3.4M6 on two different pc with WinXP pro sp2.Very hard to replicate but always happen to me.I've got powertoys with "Do not steal focus" enabled too.Happens still with eclipse 2.4.1 and Java 1.6.0_07Happened again.Eclipse EE 3.5.1 , Sun Java 1.6.0_17-b04XP Pro SP3This time I had _no_ autohide on task bar. It is all default settings. I do have Classic Windows look.I do have two monitors, but was using only one for the last few hours.Also happening on Windows 7 with eclipse 3.6 on jre 1.6.0_21This issue was happening to me with various programs on Windows 7 x64. (Chrome, Eclipse, Outlook 2010) The behavior only occurred when at least one of these windows was maximized. I was able to resolve the issue by changing the properties of my taskbar and unchecking "lock taskbar". Now, my taskbar functions as expected in Chrome, Eclipse, and Outlook.(In reply to)I have the same problem. I will keep reading the thread.(In reply to)I'm amending my previous post. The action of changing the "lock taskbar" preference results in only a temporary fix, the same annoying taskbar behavior would eventually resurface after this change.Windows XP Pro SP3Sun Java "1.6.0_23"Eclipse Java EE IDE for Web Developers.Version: Helios Service Release 1Build id: 20100917-0705Classic lookTask bar is set to: - lock the taskbar : OFF - Auto-hide the taskbar: OFF - Keep the taskbar on top of other windows: ON - Group similar taskbar buttons: OFF - Show Quick Launch: OFFNotification area: - Show the clock is ON - Hide inactive icons: OFFI am also running Taskbar Shuffle 2.5Again the taskbar went under all other Windows.I booted a couple hours ago, started Firefox, Eclipse, Remote Desktop, Skype (two instances), Oracle SQL Developer Data Modeler, Notepad, MS OCS (Office Communicator 2007), ESET NOD32 v4.0.After a while it just happened. Not sure when exactly. In eclipse I did some SVN operations (subclipse plugin).Let us celebrate the tenth anniversary of this issue!Some weeks ago, I started to regularly use Eclipse.And verily, this issue is bugging me.You can read about my adventures with this issue onHere's some specifics:Windows 7 Pro SP1 64bitEclipse 3.0.2 (Rational AD 6.0.1, to be specific)."Windows Classic" style(Desktop -> Personalize -> scroll down to "Basic and High Contrast Themes" to fin d it)For what it's worth, I no longer see this happening with Eclipse Classic 4.2 on Windows 7. In fact I don't even see an "always on top" option for the taskbar in Windows 7.I just experienced this after a long time.Using Windows 7 Pro 64 bit SP1and Juno SR2 and Indigo SR2, Java 1.7u17 (64 bit)I have the classic theme in Windows, the taskbar is standard, I did not change any settings related to it (it is always shown, no autohide)The actual window which got over the taskbar was the Command Prompt console.I'll attach a screenshot.CreatedScreenshot of problem (orange is my self-censorship)CreatedGifCam recording of taskbar getting sent behind other windowsThis taskbar issue has been bothering me for some time now so I decided to see if I could find a reproducible test case for it. Turned out simpler than I expected:1. Click on a view's tab and start dragging it until you see the 2 pixel lines of taskbar disappear from the bottom of the screen.2. Release the dragged view at its starting location or in an invalid location. Taskbar visibility can change again regardless of whether it already changed during this gesture.When the taskbar disappears it goes behind all other windows as well. The problem seems to be caused by the overlay that shows green boxes when dragging views around somehow "deposing" taskbar and then not going away gracefully. I couldn't catch the overlay while recording as it goes on top of GifCam, which it probably shouldn't do.You can see colors change slightly as the overlay becomes active. I had never realized it was happening from looking at the real-time truecolor desktop but this is easy to see in the 256-color GIF recording. Look at the grey background color in the welcome screen or the bright yellow river banks in the desktop wallpaper in the attached file.Good that there is a way to reproduce the issue, at least for some.With Eclipse 3.0.2 however, this does not reproduce the problem.My 3.0.2 does not use "green" view placing indicators,the indicators are 3-pixel-wide checkered frames.CreatedGifCam recording of a simpler repro, this one doesn't need any draggingHere's an easier repro, no dragging needed. Steps:1. Press and hold on a tab for a few seconds.The careful arrangement in the recording is only for illustrative purposes, the same thing seems to happen regardless of workbench window position, size, maximized state or the tab used.Great work, Timo!I can confirm that the steps to reproduce the problem work on Windows 7 Pro SP1 64 bit, using Eclipse Kepler Release (4.3.0) and Indigo SR2 (3.7.2).As before, I have the Classic Windows theme and two monitors.With Eclipse 4.3.1 Kepler the issue still occurs, and I can reproduce it (most of the time) with Timo's second method, by pressing on a tab for a while.Which reminded me that I had something in mind that I didn't around to until now. Which was to create a detector to make some noise as soon as taskbar gets hidden. If people affected by this bug could leave this code running in the background and report what was happening in the IDE at the time it beeps it could help narrow down the cause to some specific views, perspectives or plugins.To do this, have taskbar auto-hiding and always on top enabled, taskbar itself placed at the bottom edge, and Eclipse's window maximized. Then leave this self-contained class running until it beeps. Running it from Eclipse works just fine for this purpose: public class TaskbarObscuredDetector { public static void main(String[] args) throws java.awt.AWTException { java.awt.Toolkit tk = java.awt.Toolkit.getDefaultToolkit(); int w = Math.max(2, tk.getScreenSize().width); int h = tk.getScreenSize().height; java.awt.Rectangle r = new java.awt.Rectangle(0, h - 1, w, 1); java.awt.Robot robot = new java.awt.Robot(); boolean same = false; while(true) { int[] rgb = robot.createScreenCapture(r).getRGB(0, 0, w, 1, null, 0, w); java.util.Arrays.sort(rgb); if(same == false & (same = rgb[0] == rgb[rgb.length - 1])) { tk.beep(); System.out.println(new java.text.SimpleDateFormat( "yyyy-MM-dd HH:mm:ss.SSS").format(System.currentTimeMillis())); } robot.delay(100); } } }Wow, what a difference instant feedback makes! I've been monitoring the taskbar since yesterday and during that time the taskbark got hidden 10 times, so it's pretty rare but frequent enough to be really annoying. This is what was happening in the IDE during those 10 instances the bug was triggered:1) ALT-Tab from non-maximized Planning window to maximized Java+Git window.2) Double-click in Choose Type modal dialog to select an item and return back to modal Move Static Member dialog. 3) Clicking maximized Java+Git window's title bar from nonmaximized Planning window that is active. 4) Clicking OK in the dialog for cleaning projects, all projects was selected.5) Switching perspective windows just like in 3).6) Content Assist popup opened and then immediately closed in response to mouse movements over Java source code..7) When a debugged Eclipse Application was closed from top-right close button and normal Eclipse got focus.8) When Content Assist showed 2 non-model popup views after pressing .-key in block editing mode. Status line text also changed at the same time. 9) Almost same as 8 and only few minutes later, but this time in response to pressing CTRL-Space.10) Switching perspective windows just like in 3).	52.0
id=97604	REOPENED	Platform	SWT	3.1	PC Windows 2000	P3 normal	Steve Northover	2005-05-31 13:29 EDT by	Grant Gayed	2008-06-04 14:21 EDT (	0 users	3.1RC1- this also happens (just slightly differently) in Table- run the snippet at the bottom- click on the shell and Tree.setRedraw(false) is invoked- click on the shell again and Tree.setHeaderVisible(true) is invoked. This shows the header and overwrites the first item. It seems like this should do nothing because of the previous setRedraw(false)- click on the shell again and Tree.setRedraw(true) is invoked: now the item reappearspublic class Main { static int counter = 0;public static void main(String[] args) { final Display display = new Display(); final Shell shell = new Shell(display); shell.setBounds(10, 10, 300, 300); final Tree tree = new Tree(shell, SWT.NONE); tree.setBounds(10, 10, 200, 200); new TreeItem(tree, SWT.NONE).setText("abc"); shell.addListener(SWT.MouseDown, new Listener() { public void handleEvent(Event event) { if (counter == 0) { System.out.println("setRedraw(false)"); tree.setRedraw(false); counter++; return; } if (counter == 1) { System.out.println("setHeaderVisible(true): overwrites item"); tree.setHeaderVisible(true); counter++; return; } if (counter == 2) { System.out.println("setRedraw(true), item reappears"); tree.setRedraw(true); counter++; return; } System.out.println("nothing left to do"); } }); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } display.dispose();}}	This WORKSFORME on XP. Can you confoirm 2000?I still see it on win2000.	2.0
id=46556	REOPENED	Platform	SWT	2.1.1	PC Windows 2000	P3 normal	Steve Northover	2003-11-13 03:10 EST by	Thorsten van Ellen	2016-11-04 15:50 EDT (	5 users	Hi!When I open the find dialog, it pops up over the main window of eclipse.When I switch to (an)other application(s) and switch back to eclipse,e.g. with Alt-Tab, only the find dialog appears,the main window of eclipse is still hidden behind the other application(s).So I have to turn back to the other application(s) andminimize them all one after another or cancel the find dialog of eclipse.Not very nice.best regardsThorsten van Ellen	This is a standard non - modal dialog. Moving to SWT for comment.Can't seem to make this happen outside of Eclipse. Carolyn, can you try?I have definitely seen an example because I went looking for one when I noticed the behavior in eclipse. Of course, I can't find an example at the moment (Murphy's Law).There are plenty of examples of the opposite behavior in the OS - you bring up a dialog, switch to another app, then switch back - and where is the dialog? You need to minimize stuff to find it. For an example of that behavior, open a File Explorer, select any file, bring up its context menu and select Properties. Bring another application to the front, then bring File Explorer to the front again - the dialog is not on top any more.I will keep looking for the behavior described here - it probably depends on the dialog style, and I just have to find the right non-modal dialog somewhere.In the meantime, you don't actually have to minimize everything to find the eclipse window - you can just minimize and restore the eclipse window from the task bar. An easy way to do this (on XP - not sure if this works on 2K also) is to click on eclipse in the task bar (to bring it to the front), then click on it again (to minimize it), then click it again (to maximize). So basically, it takes 2 extra clicks to get where you want.Sorry all I can offer at this time is a slightly faster work-around and not a concrete example, but I know I've seen one.My problem is that in order to debug this, I need a stand alone SWT example and can't seem to create one. CAR to find me a snippet!Interesting. I had a little standalone modeless dialog test lying around, and I just ran it. I'll paste the code below, but it does NOT have the same problem as eclipse.When I "sniff" the class, window style, and extended style bits, I get the exact same thing for both dialogs (my little modeless guy and the eclipse Find dialog), so it doesn't appear to have been created any differently: class="#32770" style=0x96C80000 ex=0x100101Also, the "sniffed" parent is the same for both (Desktop).Here's the code. Not too useful, though, as it doesn't show the problem.import org.eclipse.swt.*;import org.eclipse.swt.widgets.*;import org.eclipse.swt.layout.*;import org.eclipse.swt.events.*;public class DialogTest { static Display display; static Shell shell; static Text text; public static void main(String[] args) { display = new Display(); shell = new Shell(display); shell.setLayout(new GridLayout()); shell.setText("Modeless Dialog Test"); Button button = new Button(shell, SWT.PUSH); button.setText("Open Modeless Dialog"); button.addSelectionListener(new SelectionAdapter() { public void widgetSelected(SelectionEvent e) { final Shell dialog = new Shell(shell, SWT.DIALOG_TRIM | SWT.MODELESS); dialog.setLayout(new GridLayout()); dialog.setText("Modeless"); final Text textField = new Text(dialog, SWT.SINGLE | SWT.BORDER); textField.setLayoutData(new GridData(GridData.FILL_HORIZONTAL)); Button append = new Button(dialog, SWT.PUSH); append.setText("Append"); append.setLayoutData(new GridData(GridData.FILL_HORIZONTAL)); append.addSelectionListener(new SelectionAdapter() { public void widgetSelected(SelectionEvent e) { String result = textField.getText(); text.append(result); } }); Button close = new Button(dialog, SWT.PUSH); close.setText("Close"); close.setLayoutData(new GridData(GridData.FILL_HORIZONTAL)); close.addSelectionListener(new SelectionAdapter() { public void widgetSelected(SelectionEvent e) { dialog.close(); } }); dialog.pack(); dialog.open(); }; }); text = new Text(shell, SWT.MULTI | SWT.H_SCROLL | SWT.V_SCROLL); GridData data = new GridData(GridData.GRAB_VERTICAL | GridData.FILL_HORIZONTAL); data.heightHint = 100; text.setLayoutData(data); shell.pack(); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } }}HAck Shell (Decorations?) to never send SWT.Activate or SWT.Deactivate. This will destroy Eclipse but see if it fixes the problem. Hack to get rid of ON_TOP style. Does this fix the problem?Getting rid of ON_TOP appears to fix the problem. The comment says that the ON_TOP style (WS_EX_TOPMOST) was problematic on Win 98 and NT when there are multiple dialog children of a window... but the behavior we are seeing does not match the comment (it says the dialog will be behind the parent). Perhaps this is some related problem in the current versions of Windows (2K, XP, ...). We may be able to work around having this bit set on all Windows platforms.By the way, the modeless Find dialog in Notepad sniffs as follows: class="#32770" style=0x94C820C4 ex=0x10501Car, should we investigate setting/clearing SWT.ON_TOP in WM_SHOWWINDOW?Hi Steve!What do you mean with "make this happen outside of Eclipse"?Why do you want to do that? Does that help you?Some thoughts:I assume, if the dialog has been modal, the OS or eclipsewould already support correct handling, but with non-modal dialog,it does not. I would expect that each such non-modal-dialog (not every non-modal dialog) has to hold a reference to the main window andat "activation" it has to bring up:1. the main window2. the non-modal dialog in front of the main-window.Perhaps it makes sense to give such dialogs a special name:semi-modal: semi because such dialogs are not totally independend from another,but the user can focus several windows. Perhaps it makes sense to create a special class for this, that has a reference to a "main" window.best regardsThorsten van EllenThis means "create a stand alone example, like those found on the SWT snippets page that demonstrates the problem". This sort of thing allows us to isolate the exact circumstances.It seems from our analysis that Windows has a bug involving WS_EX_TOPMOST but we don't have the exact case. This was proved when we commented out the code that set this style (causing the Eclipse problem to go away). Carolyn was looking into this.*** This bug has been marked as a duplicate of***Oops, got the duplicate thing the wrong way round.***has been marked as a duplicate of this bug. ***Aha! Found an example of this with an MS Word Find dialog on my home machine (Windows XP, Word 2002, Notes 6).Open 2 copies of Word on two different Word files.Open Lotus Notes.In one of the Word files, Edit -> Find...Then use Alt+Tab to go to Notes.Type something into an email and then use Alt+Tab to go back to Word.I only got the dialog - the Word window did not take focus.They must be hitting the same bug in WS_EX_TOPMOST that we are.This bug is still an annoyance in Eclipse 3.1M6 on WinXP SP2.Looks like MS has not fixed their bug in WS_EX_TOPMOST yet :-(.However, I managed to create a snippet to reproduce this outside of Eclipse.CreatedSnippet to reproduce in pure SWTTo reproduce:- have your development Eclipse in maximized mode- run the snippet- press the button- Alt-Tab (you're back in Eclipse now)- Alt-Tab=> only the "Modeless" dialog shows upIt looks like the problem comes from an additional child shell of the mainshell (see comment in the snippet). In Eclipse, the Task View'sComboBoxCellEditor creates such a shell .***has been marked as a duplicate of this bug. ***Even though(which has been marked as a duplicate of this bug)already mentions this, I would like to point out that this problemis not limited to modeless dialogs (see also).In the snippet provided in, SWT.MODELESS can be changedto SWT.APPLICATION_MODAL, and the bug will still show up.CreatedShell-Focus-IssueHello,Do we have any update here wrt fixing the problem with shell focus when switching to other application with ALT+TAB.Problem can also be seen and reproduced with JavaDoc control. (Refer to attachment)Any workarounds to creating shell which BLOCKS the shell to get focus outside eclipse workbech?--Thanks and Regards,Bhuvan Mehta	21.0
id=100552	REOPENED	Platform	SWT	3.1	PC Windows XP	P3 normal	Steve Northover	2005-06-17 06:31 EDT by	Tom Hofmann	2009-03-26 09:57 EDT (	1 user	3.1-RC2Spawned from.Calling Table.remove(int,int) several times in a row, seems to take a long timeon the windows platform. Steve in:Could be. I also think I see some animation (aka. smooth scrolling) of thevertical scroll bar going on.Will try and report. Although the reason behind removing certain ranges was toreduce the flickering due to redrawing. Specifically, we are trying to optimizethe case where the top n items are left unchanged.Example from: - bring up the code assist popup for a JFrame instance-> note that all visible items start with an 'a'- press 'a'-> the visible items do not change. -> the only visible change should be the different v-scrollbar length	Need a benchmark in order to proceed. I know that remove(int, int) draws right away, rather than damaging and redrawing. You can see this in Explorer.exe when you delete a range of files.Finally had time to look at this.The summary might be a bit misleading. The bug got filed because we used Table.remove() on a virtual table but found out it is 2-3 times slower than clearing the table and setting the new count.I attached a snippet that shows the time used to remove 5005 items when clicking the 'Remove Items' button.You can choose between the two implementations by changing the "if (true) {" on line 49.Please close the bug again if you think it's OK/expected that remove is slower than clearing everything.CreatedSnippet to show the diff	3.0
id=130754	REOPENED	Platform	SWT	3.2	PC Windows XP	P3 normal	Steve Northover	2006-03-07 11:59 EST by	Rutger Ovidius	2007-03-30 18:27 EDT (	1 user	There is no way to disable the Table column selection background color on win32 while using the .manifest file. Perhaps a Hint of some type can allow the user to control this feature.My app currently sets its own selected column background color and lets the user choose the color to use, but this is no longer possible as the windows color now overrides it.There is also no way to get the color of the OS's selected column background color in Display.getSystemColor();	My initial position on this one is WONTFIX. We have no control over how the operating system draws. Although we could put back the 3.1 behavior, the selected column on XP is a nice feature and most people will benefit from it.Can you provide some code that shows your own selected column color failing? Off the top of my head, your color should win out over the default. That sounds like a bug.I hope you will re-consider this. Most people will want the selected column color by default, but a way to disable it is really required.As a programmer, I have no control over the unused area of the table.If my table is displaying 100 rows, but I only have 5 rows instatiated, the selected column background color is shown for all 100 rows. I can not customize the background color of the bottom 95 rows. Even if the TableItem#setBackgroundColor did win out over the selected column background color (which it currently doesn't), the rest of the column wouldn't match.Here is an example of the selected column color winning over the TableItem.setBackgroundColor. public static int c, d; public static void main(String[] args) { final Display display = new Display(); final Shell shell = new Shell(display); shell.setLayout(new FillLayout()); final Table table = new Table(shell, SWT.VIRTUAL | SWT.BORDER | SWT.MULTI | SWT.FULL_SELECTION); final int columns = 5; for (int i = 0; i < columns; i++) new TableColumn(table, SWT.LEFT).setWidth(150); table.setLinesVisible(true); table.setHeaderVisible(true); table.setSortDirection(SWT.DOWN); table.setSortColumn(table.getColumn(0)); table.addListener(SWT.SetData, new Listener() { public void handleEvent(Event event) { TableItem item = (TableItem) event.item; String text = null; text = "node " + table.indexOf(item); item.setText(text); Color c = display.getSystemColor(SWT.COLOR_BLUE); item.setBackground(c); } }); table.setItemCount(5); table.getHorizontalBar().setSelection(100000); final int timerDelay = 1250; final Runnable r = new Runnable() { public void run() { if (c++ >= columns - 1) c = 0; int dir = table.getSortDirection() == SWT.DOWN ? SWT.UP : SWT.DOWN; if (c == 2) { table.setRedraw(false); } table.clearAll(); table.setSortDirection(dir); table.setSortColumn(table.getColumn(c)); if (c == 2) { table.setRedraw(true); } if (c == 4) table.redraw(); if (c == 0) d++; if (d % 2 != 0) { table.setItemCount(0); } else { table.setItemCount(5); } display.timerExec(timerDelay, this); } }; display.timerExec(timerDelay, r); shell.setSize(800, 600); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } display.dispose(); }i second the motion for a way to disable the auto background color and i further backup the claim that the system color wins	3.0
id=113160	REOPENED	Platform	SWT	3.2	PC Windows XP	P3 normal	Steve Northover	2005-10-19 17:16 EDT by	Randy Hudson	2006-01-24 11:17 EST (	2 users	We have instances of system colors that are being referenced in tons ofpaintable objects. Now that we get notification when a system color changes, itwould be nice to be able to update the instance of the Color that referred toit. This way there is no need to notify tons of objects that are holding ontothe old Color to pick up the new "constant".An alternative approach is to create a subclass of Color called SystemColorwhich is automatically reinitialized whenever the system color changes. Or maybea more generic MutableColor subclass.Of course, a color's changing after it has been set on a widget would have noaffect. This behavior has precedence in Images that are set on buttons ortoolitems (I can't remember which) on GTK. If you update the Image, the widgetis still displays an old copy of the Image.	I had considered this but eventually rejected the idea.Why not query the color from display when needed? In that case, there would be no need to listen for setting changes and your paintable objects will always be right.(In reply to)That doesn't help for the same reason that invoking canvas.setForeground(Display.getCurrent().getSystemColor(SWT.COLOR_INFO_FOREGROUND)) would not automatically update the foregournd Color later on.What were your reasons for rejecting this idea, Steve? Even if you can't reinit the Color, SystemColor could use the adapter pattern and act as a wrapper that points to the up-to-date Color. We can't do this ourselves since Color is final.Color objects (and other graphics objects for that matter) are not unique. If you set a color into a control and then query it back, depending on the control and the platform, you might get then identical color back or an equal() color. This means that there can be copies of system colors.If you never set a color, the default color is used and will change automatically when the theme changes. I realize that you may have a framework in place that prevents you from knowing whether a color should be set or not.No one has said anything about asking to get the color back from a GC or Widget. If you return a different instance and even a different color, it doesn't affect our scenario.Unfortunately, our system color constants are declared on an interface, so they are final and can't be updated even with the current notification. We would have to break API and make it a class.Treating system colors specially might be safer than just reinitializing any color. on win32, it might look like this:class GC {...public void setForeground(Color color){ ... setPen(color.handle(), -1,-1,-1,-1,data.dashes);}...}class SystemColor extends Color {...int handle() { return OS.GetSysColor(sysID);}...}Of course I have no idea how slow that native method is so it might be a stupid idea/non-portableIf you have a generic paintable object like a Polygon, etc., there is no easy way to set its background to be "query the display for the system's xxx color", right? I mean, its color can be red, or it could be widget_background, both are just stored in a field typed as Color. For us to do it your way we would have to wrapper SWT's color and create the SystemColor concept ourselves. Or we could create two fields to store either a color or system "int" identifier.The code you gave won't work in general. If you set a SystemColor in a widget and then query it back, on some platforms, you would get a Color and this would no longer be correct.If you have a field in the polygon that represents the color, don't initialize it and always use an accessor. Inside the accessor, if the color is null, get the system color. If the color is not null, return it. If someone sets the color, they are no longer using the system color. I have no idea whether this would work for you but this is the approach that custom widget writers have been using for a while. It's not great, but it works.So, a system color might work for us but not for widgets, which don't hold onto the java instance. I think the showstopper would be if the widget didn't track the system color.I think the original request is the most reasonable one and it doesn't introduce anything too complicated like a mapping of system constants->(widget+ fg/bg).Not sure what you mean. The original request doesn't work.Why does the original request (the summary) not work? Colors would be exactly like Images. If you modify an Image by painting on it, you are only modifying that image. If you set the Image on a Button and get it back, it could be a different java object and a different resource. Painting on the image after setting it to a widget may have no effect. It's the same, no?Depends on the platform and the control. For example, custom control that don't take a copy of the image will be updated. On Windows, even the native controls are different. Trees and tables take a copy, menu items don't etc.Hammering a single instance and hoping that no one has any copies seems wrong to me. It's not what the operating systems do and it doesn't work in general (although it might work for GEF).Sorry but I'm going to have to WONTFIX this bug report.OK, but HOW is it different than the Image scenario? It's exactly the same, except it's even more consistent whereas the Image scenario varies on each platform.Nope. Both are the same. If you set a color into some native controls and then get it back, you might get back a copy that won't get hammered.A color is a cross-platform reference to some OS resource. Reinitializing is just changing that reference. SWT clients already know that widget.setColor() is just a cross-platform way of handing over the current resource, and not the java object itself. They must be aware of this for the other reasons you mentioned.This is not GEF-specific. It helps anyone that works with SWT's colors without reaching in and grabbing the platform-specific data, which is everyone except for widgets. For example, JFace's ColorProvider and ColorDecorator classes. Also syntax highlighters, and even StyleRange used by StyledText control.(In reply to)That's what I said. It's the same. So let clients change a Color just like they can currently create a GC on an Image and change the Image. Or as you call it, hammering an _Image_ and hoping that no one has any copies.This is the last time I'll try.Colors are not unique. There can be 1,000,000 instances of color, each one having the same operating system handle. I don't have a refererence to every color that is creates so I can't find all the instances and hammer the handle.That is not what we are asking you to do and it wouldn't even be the correct behavior. Some manually-created colors might happen to have the same handle as a system color and it wouldn't make any sense to update them. The scenario is for the non-widget world that must hold on to specific instances of colors, regardless of whether they have the same handles or not.I have no idea what you are talking about. Please submit a patch.I'm not sure I understood your use of "hammer" the first time. I thought you were referring to the client making the change to the color. If you meant SWT updating the handle for a single color instance, this is all that we are asking for. It wouldn't make sense to update copies of the color.Here's the patch to Color.java:/** * Disposes the current color reference and reinitializes this * color using the given values. Equivalent to calling: * <pre>dispose(); * new Color (device, r, g, b);</pre> */public void disposeAndInit(Device device, int r, int g, int b) { dispose(); init(device, r, g, b);}/** * Used to update a Color that was created using Display#getSystemColor. */public void initSystemColor(Device device, int id) { // copy code from Display or refactor it.}The first method is exactly the same as calling dispose() on the Color, and then creating a new color. The effect on the other 1,000,000 "copies" is the same in either case.The second method is exactly the same as just calling Display.getSystemColor(int) and garbage collecting the old instance (since disposing isn't necessary).The only difference in both cases is that the java object is reused.Ok, and I have already described how this does not work in general (while it may work for your use of system colors). Updating a single instance is a lie. Anyone who sets and then queries a color back will be burned. The new instance won't be updated and they will have no idea why their code fails.WONTFIXTHISEVER.But it's exactly what the proposed API would state, so how is it a lie?Using your exact same scenario, someone who sets and then queries a color back, and then disposes the *original* instance, will be "burned" because now they have a color with a bogus handle (on 8-bit displays). What is your solution to this scenario? There is no solution because it's incorrect usage and it's a pointless example.Actually, having copies of the Color isn't even necessary. There could be references to the handle in the native widgets. I could just set the color on a TreeItem and the dispose the color. SWT does not go in and repair the reference to the handle of the disposed color.If I set a font on a control and then dispose the Font SWT doesn't go and repair references to that handle either.Or, what if I have a copy of a Font and I dispose the original? Does SWT go in and hammer the copies to indicate that the copies are also disposed? No. Try the following:Font font = new Font(display, "Papyrus", 18, SWT.BOLD);shell.setFont(font);Font another = shell.getFont();font.dispose();System.out.println(another.isDisposed());Any copies of the Font are completely invalid, just like colors.I have been trying to follow this conversation but I find it quite confusing. Randy, can you please post a patch (like a real one, team > create patch) thatshows what you are proposing? I find your notes fromtoo vague.(In reply to)Any patch I would submit would not involve updating copies of colors. So the first step is to convince Steve that NOT updating copies is correct and consistent with the way dispose() works for both Fonts and Colors.The other scenarios involving disposing fonts and colors are programming errors. You should not dispose a resource that you did not allocate.(In reply to)If you look at the code, I am disposing the resource that I created.Your argument went something like "It's wrong for fonts that get disposed, so it's ok to get it partially right for system colors".The argument is a color is a useless java object once its been disposed. So let me reuse that object to do something else.Eh? Once an object is disposed, you can't use it (or reuse it) for anything.disposed != GCedOnce an SWT object with associated operating system resources is disposed, it cannot be used (reused) for anything. The garbage collector doesn't enter into it.So this is the real issue. How important is it that such resource pointers be "immutable"? What does it guarantee?Steve, please reconsider this. We have system colors declared on an interface, which means there is no other way we can update them. Even if we deprecate the interface and create a class to replace it, it still wouldn't help us.	32.0
id=150024	REOPENED	Platform	SWT	3.2	PC Windows XP	P3 normal	Steve Northover	2006-07-07 14:18 EDT by	None	2007-04-09 14:25 EDT (	3 users	I have a GEF editor similar to VE which creates figures by scraping SWT widget images.In Draw2D 3.2, I have noticed a painting problem with Group widgets on a FigureCanvas.I am attaching a screenshot and a test case to duplicate the problem.	CreatedScreenshot showing problemSee the blank space on the right side of the Group border.CreatedTest caseTest case to reproduce the problem.You will need to add draw2d to the build path and then run as SWT application.I reproduced this, but I have no idea how our Canvas can paint on top of one of its children.Interesting quirks about this bug. The problem goes away if:1. The Group text is changed to "Lorem ipsum dolor"or2. The Group width is increased to 217 (up from 187)or3. The Group x location is changed to 0 (from 77)To better see the problem, add this line of code:group.setBackground(ColorConstants.yellow);Note that the inner rectangle is the same width as that of the group's text and is offset from the group's top left corner by about the same amount as the group's location (ie, group's offset inside the canvas).Within the group, the mysterious box occurs at the same location at which the group's label appears relative to its parent composite.Moving to SWT, as I can't imagine that anything GEF does would "bleed through" a child control. I tried to create a simple Canvas test case but I couldn't easily remove all of the draw2d gorp.The culprit is the LightweightSystem.Comment the line in the FigureCanvas constructor which sets the LWS control and the mystery box disappears.With the following snippet, the Group's outline completely disappears: public static void main (String [] args) { final Display display = new Display (); final Shell shell = new Shell (display); FillLayout fillLayout = new FillLayout(); fillLayout.marginHeight = fillLayout.marginWidth = 5; shell.setLayout(fillLayout); Canvas canvas = new Canvas(shell, SWT.NO_BACKGROUND | SWT.DOUBLE_BUFFERED | SWT.NO_REDRAW_RESIZE | SWT.H_SCROLL | SWT.V_SCROLL); canvas.getHorizontalBar().setVisible(false); canvas.getVerticalBar().setVisible(false); canvas.addPaintListener(new PaintListener() { public void paintControl(PaintEvent e) { e.gc.setClipping(e.x, e.y, e.width, e.height); e.gc.fillRectangle(e.x, e.y, e.width, e.height); } }); Group group = new Group(canvas, SWT.NONE); group.setBounds(new Rectangle(77,72,187,113)); group.setText("Lorem ipsum dolor sit amet"); shell.setSize (400, 400); shell.open (); while (!shell.isDisposed ()) { if (!display.readAndDispatch ()) display.sleep (); } display.dispose (); }SN, note thatonly makes the Group's border disappear on XP; the border is still visible when I run the snippet on win2000.Sure you can draw on top of the border of a group (on some platforms). You should only be drawing withing the client area.(In reply to)The group is not painting on top of its own border. The Canvas is painting on top of the group's border. That should be impossible. Remember how we painted connections in VA-Java (composite painted over top of its children)? That is not supported in SWT.The group's border isn't an SWT.BORDER. It is painted by the group (on Windows). If you call getClientArea() on a group, the origin will not be (0, 0). On Windows, it is possible to draw on top of a group's border.That's a red herring. No one is drawing on the group, period. A Canvas can not paint on top of its children.I think this is related to the general problems with group borders not showing up, but it should be resolved as a dupe instead of wontfix.Right, the group is a child of the canvas so the canvas can't draw on top.My mistake ... reopening.Seems that the SWT.NO_BACKGROUND bit is causing the trouble.Here is simpler code that fails:public static void main(String[] args) { final Display display = new Display(); final Shell shell = new Shell(display); FillLayout fillLayout = new FillLayout(); fillLayout.marginHeight = fillLayout.marginWidth = 5; shell.setLayout(fillLayout); Canvas canvas = new Canvas(shell, SWT.NONE); canvas.addPaintListener(new PaintListener() { public void paintControl(PaintEvent e) { e.gc.setClipping(e.x, e.y, e.width, e.height);// e.gc.fillRectangle(e.x, e.y, e.width, e.height); } }); Group group = new Group(canvas, SWT.DEFAULT); group.setBounds(new Rectangle(77, 72, 187, 113)); group.setText("Lorem ipsum dolor sit amet"); shell.setSize(400, 400); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } display.dispose();}	17.0
id=150274	REOPENED	Platform	SWT	3.2	PC Windows XP	P3 normal	Steve Northover	2006-07-11 11:49 EDT by	Chris Gross	2009-06-12 14:13 EDT (	3 users	The new XP-ish blue border on Composites flickers, sometimes significantly. It almost appears like the older non-XP border is drawn first, then the new XP border is drawn over top (but maybe thats only in my mind).	Here's some easy sample code to demonstrate the flicker.public class Main2 { private static Shell shell; public static void main (String [] args) { Display display = new Display (); shell = new Shell (display); createContents(shell); shell.open (); while (!shell.isDisposed()) { if (!display.readAndDispatch ()) display.sleep (); } display.dispose (); } private static void createContents(Composite parent) { final Canvas c = new Canvas(parent,SWT.BORDER | SWT.DOUBLE_BUFFERED); c.setBounds(20,20,200,200); c.addListener(SWT.MouseMove,new Listener() { public void handleEvent(Event arg0) { c.redraw(); } }); }}"It almost appears like the older non-XP border is drawn first, then the new XPborder is drawn over top (but maybe thats only in my mind)."That is exactly what happens! SWT needs to call the windowproc for wm_ncpaint to draw the non-client part of the window (borders and scrollbars), people don't like the old 3-d border look, so after it returns from the windowproc SWT draws the xp look border on top of the old border. Steve, any idea how to fix this ? clipping maybe ?This has already been fixed for a while.Is it fixed in 3.2.1 or 3.3?3.3Is there any chance we can get this fix into the 3.2.1 codebase?Can you verify that the 3.3 SWT code in HEAD fixes the flickering you are seeing?This is definitely not fixed in the 3.3 M1. I attempted to test with the HEAD SWT (3306), but I apparently lack the skills to update just the SWT portion of my 3.3M1. I replaced the DLLs and Eclipse itself ran fine, but my RCP test application now dies from deep workbench errors. Maybe I'll wait a few weeks and see if we can get a stable nightly build.Making a stand alone SWT snippet (like Main2) is trivial. Can you make one that uses the widget that is failing in your RCP application? If the bug is not fixed, it should be reopened.There is definitely a flicker bug with the canvas when shows its scrollbars. In the Main2 example code, change the canvas declaration to look like this:final Canvas c = new Canvas(parent,SWT.BORDER | SWT.DOUBLE_BUFFERED | SWT.V_SCROLL | SWT.H_SCROLL);Then move the mouse around on it.So should I make a separate bug entry to handle the specific flicker issue concerning a Canvas with scrollbars?Nope.	12.0
id=156164	REOPENED	Platform	SWT	3.2	PC Windows XP	P3 normal	Steve Northover	2006-09-05 04:30 EDT by	Andreas Buchen	2006-09-08 04:10 EDT (	3 users	- Run Snippet232- Text from the first column spills over into the second column(see screenshot in next posting)	Createdsnippet232 after resizing first columnThis is working for me on XP for both the XP theme and the classic look (which I can see you are using from your screen shot). Please retest on the latest SWT from HEAD and reopen if the problem is still happening for you.Test against SWT from HEAD showed the same error.Tested on XP sp2. I do not have another environment available.The problem occurs _only_ if I resize the column to be smaller. If you hide and restore the window (e.g. via Ctrl-Tab), the redraw is done correctly. If only happens if a SWT.PaintItem listener is registered.Felipe, can you make this happen and show me?works for me.can you please give us exact steps how to reproduce the problem?here I tried.1. run snippet 2322. resize first column smaller3. exand the second tree itemit draws correctly.I gave it a try and could reproduce the problem using the following steps:- Run snippet- Expand "UI" node- Make first column narrower- Start making first column wider again, but don't release the left mouse button, instead press the right mouse button to cancel the resizingSorry for the imprecise description.I can create the problem using the following steps (Florian's first three steps only):- Run snippet- Expand "UI" node- Make first column narrower	7.0
id=137786	REOPENED	Platform	SWT	3.2	PC Windows XP	P3 major	Steve Northover	2006-04-20 13:23 EDT by	Chris Lee	2009-06-12 14:13 EDT (	10 users	I recently updated my Eclipse version from 3.2 M4 to the builds associated with Callisto RC0, and am noticing some new feedback when dragging from another view. For example, start dragging a file around from the Navigator view - you'll see a little ghost feedback of the filename being dragged around everywhere. (I'm assuming it's SWT because it shows up when dragging over any part of the Eclipse program.)The bug is the interaction that this new feedback has with other feedback, supplied by us developers, or by interaction with GEF. If doing this drag operation over top of a GEF canvas would show feedback on the canvas, we end up with a crazy flickering going back and forth between the GEF feedback and the SWT feedback, which ends up leaving a mess behind as you drag, and bits of feedback are only partially erased.Is there a way of at least turning this new "feature" off, especially for those who want to provide their own feedback (or none if the drag will result in no actual action taking place)	Can you attach a screenshot of the problem? Or is the problem that there is a bunch of flash and then it looks right?Does GEF draw outside of the paint event in this case? Is there a simple example I can run to see it? How are you drawing your feedback - in what events, what kind of calls?The only way to disable the drag over effect is to disable it in the drag source. That is, Navigator, PackageExplorer could turn it completely off, however, it can not be turned off for just some drop targets.GEF does not paint outside of the paint event any more. Is this a new feature in SWT? It would be a lot cooler if they dragged the name along with the icon.Will you be exposing createImageList in the future on the DragSource :-)?Createdscreenshot 1 of feedbackHere's a screenshotCreatedanother screenshotAnother screenshot - note the feedback 'trail' left behind shouldn't be there; it will remain after the object is dropped as well..."is the problem that there is a bunch of flash and then it looks right?"The problem is that it seems as if the GEF feedback and the other feedback are fighting, with a constant flicker between the two and not being properly erased.We're handling the drag event with an extension of AbstractTransferDropTargetListener (GEF), which generates a CreateRequest; the policy handling the request shows feedback through the same code that shows it as if we dragged from the palette.Re:There is a "known" bug on windows that if the image list contains certain types of images, you will only see the icon. Usually you will see both the icon and the text. See#c21.Re:Yes I hope so.Here is a little snippet that draws a drag under effect as the mouse moves.There is a small amount of flash in the drag over effect (drag over effect goes away as canvas is redrawn and then reappears - this is unavoidable) but otherwise there is not a continuous flash nor is there a trail. Can you explain what you are doing that is different from this example?public static void main (String [] args) { final Display display = new Display (); Image image = new Image(display, 16, 16); GC gc = new GC(image); gc.setBackground(display.getSystemColor(SWT.COLOR_LIST_SELECTION)); gc.fillRectangle(0, 0, 16, 16); gc.dispose(); Shell shell = new Shell (display); shell.setLayout(new FillLayout()); Tree tree = new Tree(shell, SWT.BORDER | SWT.MULTI); for (int i = 0; i < 3; i++) { TreeItem item = new TreeItem(tree, SWT.NONE); item.setText("item "+i); item.setImage(image); for (int j = 0; j < 3; j++) { TreeItem subItem = new TreeItem(item, SWT.NONE); subItem.setText("item "+j); subItem.setImage(image); for (int k = 0; k < 3; k++) { TreeItem subsubItem = new TreeItem(subItem, SWT.NONE); subsubItem.setText("item "+k); subsubItem.setImage(image); } } } DragSource source = new DragSource(tree, DND.DROP_COPY); source.setTransfer(new Transfer[] {TextTransfer.getInstance()}); source.addDragListener(new DragSourceAdapter() { public void dragSetData(DragSourceEvent event) { event.data = "Hello World"; } }); final Canvas c = new Canvas(shell, SWT.BORDER | SWT.DOUBLE_BUFFERED); final Rectangle dragUnderEffect = new Rectangle(0, 0, 0, 0); c.addPaintListener(new PaintListener() { public void paintControl(PaintEvent e) { GC gc = e.gc; // draw regular image gc.setBackground(display.getSystemColor(SWT.COLOR_RED)); gc.fillRectangle(c.getClientArea()); //draw drag under effect gc.setForeground(display.getSystemColor(SWT.COLOR_BLUE)); gc.drawRectangle(dragUnderEffect.x, dragUnderEffect.y, dragUnderEffect.width-1, dragUnderEffect.height-1); } }); DropTarget target = new DropTarget(c, DND.DROP_COPY | DND.DROP_DEFAULT); target.setTransfer(new Transfer[] {TextTransfer.getInstance()}); target.addDropListener(new DropTargetAdapter() { public void dragEnter(DropTargetEvent event) { if (event.detail == DND.DROP_DEFAULT) event.detail = DND.DROP_COPY; } public void dragOperationChanged(DropTargetEvent event) { if (event.detail == DND.DROP_DEFAULT) event.detail = DND.DROP_COPY; } public void dragOver(DropTargetEvent event) { Point pt = display.map(null, c, event.x, event.y); if (dragUnderEffect.x != pt.x || dragUnderEffect.y != pt.y || dragUnderEffect.width != 100 || dragUnderEffect.height != 100) { // need to update drag under effect // clear old effect c.redraw(dragUnderEffect.x, dragUnderEffect.y, dragUnderEffect.width, dragUnderEffect.height, true); // save coordinates of new effect dragUnderEffect.x = pt.x; dragUnderEffect.y = pt.y; dragUnderEffect.width = 100; dragUnderEffect.height = 100; // draw new effect c.redraw(dragUnderEffect.x, dragUnderEffect.y, dragUnderEffect.width, dragUnderEffect.height, true); } } public void dragLeave(org.eclipse.swt.dnd.DropTargetEvent event) { c.redraw(dragUnderEffect.x, dragUnderEffect.y, dragUnderEffect.width, dragUnderEffect.height, true); dragUnderEffect.x = 0; dragUnderEffect.y = 0; dragUnderEffect.width = 0; dragUnderEffect.height = 0; } }); shell.open (); while (!shell.isDisposed ()) { if (!display.readAndDispatch ()) display.sleep (); } display.dispose ();}Does the trail etc happen only when you scroll while dragging over the target?Re:We're not using anything remotely close to that (at least, not on purpose). We're relying on GEF to draw the target feedback on the GEF canvas, but it seems that this conflicts with the new feedback drawn by dragging member(s) of a tree control (new from 3.2 M4 -> 3.2 M6).Re:The trail happens only while I'm dragging over the GEF canvas, and doesn't have anything to do with scrolling.I can probably come up with a code example that demonstrates this bug, though it may take some time as I'm busy with other parts of our project. As the bug only presents itself when interacting with GEF, it may be a GEF bug. The tree control drag feedback is new though, so I'm currently assuming the bug is in there somewhere.Chris, can you post a picture of your editor before you drag over it? Are you displaying a box around the text at any time, pre- or during DND?The editor is just a plain white GEF canvas; it has an EditPolicy installed to handle CreateRequests generated by our extension of AbstractTransferDropTargetListener...we're using the default feedback mechanism provided by GEF (which uses FigureUtilities.makeGhostShape(Shape)).Another issue related to this is that this new tree feedback always follows the mouse exactly (and shows multiple tree items when dragging multiple tree items), so it doesn't follow any snap-to rules we have for our GEF canvas (or removing itself as a form of unwanted feedback).Where are you displaying the ghost shape? Is it in a fixed location, which it what it looks like in the screenshot you attached?Chris, which graphics source are you using in GEF? If you are using the older double buffered version, then you are painting outside of an OS paint event. This could be the issue.re:We're not doing anything special to do the painting - it's using a subclass of XYLayoutEditPolicy; we're even using the default showSizeOnDropFeedback(CreateRequest) provided in the class, which gets the Figure and sets its bounds; it then gets painted when GEF tells the scaled feedback layer to paint.The code flow for painting the feedback would be the same as if you dragged an existing object around on the GEF canvas (a la the shapes example)The scenario seems like a very simple one to me; based on what I can tell, it should be reproducible by taking the shapes example, adding a dnd handler to create a CreateRequest with non-empty size, which would be passed to the target edit part when dragging from a view (such as Navigator).Put a breakpoint in BufferedGraphicsSource.getGraphics(), and make sure it doesn't get hit. Thanks.Createdstack trace of BufferedGraphicsSource hitThe breakpoint gets hit once when starting our editor (caused by a stack that seems to be from loading the palette), but does not get hit during the drag operation.I've attached the stack trace for the breakpoint hit (as a note, "MultiPageEditor" and "LayoutPage" are our extensions of MultiPageEditorPart and GraphicalEditorWithFlyoutPalette)You will see a lot of flicker if you (or GEF) calls redraw() on the drop target widget in every drag over event. This was not the case before the drag over effect was added. It is important to not damage unless it is required. This however would not explain the trail.Do you have steps that I can follow to recreate the problem? Is there a plugin I can install?re:I can create a sample plugin to demonstrate the problem. It may be a few days until it's ready though.Thanks for the info. That means the diagram is using native painting. Veronika, the only other interesting piece of information is that GEF is calling update() to force the paint.I modified the example into call c.update() directly after c.redraw() and this is causing excessive flashing and a trail to be left behind.Randy, why are you calling update()? Do you have a scenario where the paints must be flushed immediately?It's more of a compatibility thing now. We have a method performUpdate() that does layout (a.k.a. validation) and painting combined. It used to create its own GC and paint. Now, it calls redraw(). But, we wanted to maintain the behavior that when the method returns, the bits on the screen were up-to-date.More importantly, we call performUpdate() directly in dragOver becuase deferred events used to not get processed during DND. Maybe we can stop doing this, in which case we still call update, but not from within a dragOver callback.CreatedSample plug-in demonstrating the bugThis is a sample plug-in similar to the shapes editor. To recreate the problem:- start eclipse with this plug-in loaded- File -> New -> Other... select Blank circles document under the Circles Editor category and follow the wizard- drag something from another view (Navigator for example) into the circles editor and you should see the flashing and trails left behind as you drag around- dragging from the palette and moving/resizing circles in the editor does not cause this problemHey Randy & VeronikaIs there a workaround we can use to fix this problem in our scenario? (see the attached sample plugin); this is an important issue for us as it severly impacts the user feedback for what we expect to be a common user operation. Can we set a target for an RC release of 3.2?Chris, you could remove the call to update() from the graphics source in draw2d. Bsaically, you'd have to copy NativeGraphicsSource and remove line 43, then set it in you application's LWS.It's better (doesn't look *as* crappy because it isn't leaving trails behind), but it still flickers quite a bit.We've found that if null is returned as the image for the view's label provider, then we don't get the SWT-ghosty image of the tree control being dragged around, and we get the desired GEF based feedback. However, this isn't really a viable solution/workaround in this case. Are there ways to disable the ghosty image of the tree control?It seems like there's no way to disable the swt feedback.DragAndDropEffect is initialized in DragSource's constructor, where it checks if the control is a tree, table or anything else (in which case NoDragAndDropFeedback is used). Since our control is a tree, it always creates the TreeDragAndDropEffect. So a workaround would be a way to specify that we want the NoDragAndDropEffect.I've found some possible workarounds, but they'd require a corresponding change in the Eclipse code:(a) remove the use of 'DragAndDropEffect' in org.eclipse.swt.dnd.DragSource. We don't want to show this feedback for our tree control.(b) Expose classes DragAndDropEffect and NoDragAndDropEffect to be visible; change the constructor of DragSource to allow creation of the effect to be overridden in subclasses (ie: instead of instantiating as 'effect = new TreeDragAndDropEffect ((Tree)control)', use 'effect = createDragAndDropEffect (control)', where createDragAndDropEffect is a protected method that we can override to use NoDragAndDropEffect.Veronika, do you have any ideas? The automatic drag feedback needs to be turned off. For 3.2.1, we can't add API or expose any non-API classes.Investigating for 3.2.1.Ok, I have a few ideas about how this could be done but all of them either involve new API and/or reworking the current framework.Is anyone affected outside of GEF clients? There are several changes that could be made to GEF which *may* avoid this issue. The most obvious being not to force the repaint in the drag over callback. We were doing this in the past because of the flooding of dragover callbacks that used to pre-empt our deferred runnables from ever getting a chance to run.CCing Anthony to consider making this change in GEF 3.2.1. It's not even a workaround, but a removal of a previous workaround.If you can change the GEF code for 3.2.1, please do so. Thanks.There is feedback in both the drag source and drop target. Just to confirm, it's only the drag source feedback you need to get rid of, right?Anthony, can you weigh in on?GEF to see whether they can work around the problem. We are not planning to fix this for 3.2.1.The method DropTarget.refresh() is responsible for minimizing flash and drawing the drag under effect correctly. For the drag under effect to be correctly drawn, the drag over effect must be hidden so that it does not conflict with the drawing of the drag under effect.If we hide the drag over effect in every drag over, the drag over effect flashes like crazy. As a result we check if there are oustanding paints before hiding the drag over effect.If you call update and draw before refresh() is called you will get bad cheese. Steve and I looked at a call that would prevent you from forcing the paints to be updated but this had other bad side effects so we abandoned that idea.Bottom line I guess is that you need to figure out a way to stop calling update() within a DND operation.To disable the drag over effect, we can cause getDragSourceImage() to return null.Mohammed, this is the one I asked you to take a look at while Anthony is on vacation this week. What do you think from a GEF perspective?Anthony and Mohammed, is there any update on the possibility of GEF 3.2.1 changes to work around this issue?(In reply to)sorry it is taking us time to get to it; will hopefully update you by the end of todaycomminting outthe flush calls on hookDropTarget in the GraphicalViewerImpl did not help muchit looks like the update are triggered in other places ; invsitigating ...one question for the client though, if you are looking for a work around would it be aceptable to, enable the shape feed back unless the drag operation is comming from the palette ?noticed that lots of update requests created in response to the drag move; and each one triggers DeferredUpdateManager#performUpdate(In reply to)Please post stack traces showing why Control#update() is getting called while dragMove is still on the stack.GEF should be calling update() asynchronously if you removed the flush calls(). So, in the example in, change the test case to be inside an asyncExec(). Does the test case still work? What about when you add update() back into the test case, which is what causes the problem when done synchronously.(In reply to)1- i'm not using the example code provided in; i'm using the sample plugin provided by the client.2- the problems i'm seeing on my machine, using the provided sample plugin, is the trial problem and some flickering. But the flickering i'm getting on my machine is not for the whole diagram, it is only for the 2 feedbacks being drawn (which might be expected), 3- the update runnable created by the deferredupdate manager, runs during the mouse move (i'm gussing it's running because of read and dispatch call). As a result the updateQueued falg will be down and as soon as add dirty region is called another runable will be created and so on 4- even after fixing the trail issue and the flickering issue, would not it look ugly to see the two feed back drawn beneth each other, i'm attaching a picture to show how the feed back looksCreatedfeedback on top of each otherTry removing the update() call in NativeGraphicsSource, without any other changes.(In reply to)This definitely improves the use case a lot; it fix the trail issue and improve the flickering. (There is still some minor flickering, it might be related to the fact that the deferred update manager keep calling performUpdate and repairDamage during mouse move, but I知 not sure if we can get around this issue)If Randy does not see a problem in commenting out the update call in NativeGraphicsSource then we could submit this change as a work aroundCreatedgef patchI have only seen this problem using the SWT snippet. But, it seems like minor cheese because it is eventually erased when the DND finishes. It is not permanent cheese, at least using Veronika's snippet. Is this true in the GEF scenario?Mohammed,The GEF patch seems low-risk. The risk is if a client expects to call draw2d's performUpdate, and then have the pixels immediately on the screen. An imaginary use case for that would be screen-scraping.The patch would have to be tested on all platforms, with a "real" test case including auto-scrolling.SWT team,1) GEF can not prevent update() from happening as a result of calling Canvas.scroll(), which is going to happen as part of auto-scrolling during DragOver. So the workaround leaves a few crumbs of cheese.2) Now we can not remove an old workaround that we still had. Specifically, the one which forced a layout on each DND event instead of waiting for our asyncExec to run. The following test case (modified to use async) shows that cheese still occurs without the use of update() (or scroll()):public static void main(String[] args) { final Display display = new Display(); Image image = new Image(display, 16, 16); GC gc = new GC(image); gc.setBackground(display.getSystemColor(SWT.COLOR_LIST_SELECTION)); gc.fillRectangle(0, 0, 16, 16); gc.dispose(); Shell shell = new Shell(display); shell.setLayout(new FillLayout()); Tree tree = new Tree(shell, SWT.BORDER | SWT.MULTI); for (int i = 0; i < 3; i++) { TreeItem item = new TreeItem(tree, SWT.NONE); item.setText("item " + i); item.setImage(image); for (int j = 0; j < 3; j++) { TreeItem subItem = new TreeItem(item, SWT.NONE); subItem.setText("item " + j); subItem.setImage(image); for (int k = 0; k < 3; k++) { TreeItem subsubItem = new TreeItem(subItem, SWT.NONE); subsubItem.setText("item " + k); subsubItem.setImage(image); } } } DragSource source = new DragSource(tree, DND.DROP_COPY); source.setTransfer(new Transfer[] { TextTransfer.getInstance() }); source.addDragListener(new DragSourceAdapter() { public void dragSetData(DragSourceEvent event) { event.data = "Hello World"; } }); final Canvas c = new Canvas(shell, SWT.BORDER | SWT.DOUBLE_BUFFERED); final Rectangle dragUnderEffect = new Rectangle(0, 0, 0, 0); c.addPaintListener(new PaintListener() { public void paintControl(PaintEvent e) { GC gc = e.gc; // draw regular image gc.setBackground(display.getSystemColor(SWT.COLOR_RED)); gc.fillRectangle(c.getClientArea()); // draw drag under effect gc.setForeground(display.getSystemColor(SWT.COLOR_BLUE)); gc.setClipping(dragUnderEffect); gc.setLineWidth(4); gc.setLineStyle(SWT.LINE_DASH); gc.drawRectangle(dragUnderEffect.x, dragUnderEffect.y, dragUnderEffect.width - 1, dragUnderEffect.height - 1); } }); DropTarget target = new DropTarget(c, DND.DROP_COPY | DND.DROP_DEFAULT); target.setTransfer(new Transfer[] { TextTransfer.getInstance() }); target.addDropListener(new DropTargetAdapter() { public void dragEnter(DropTargetEvent event) { if (event.detail == DND.DROP_DEFAULT) event.detail = DND.DROP_COPY; } public void dragOperationChanged(DropTargetEvent event) { if (event.detail == DND.DROP_DEFAULT) event.detail = DND.DROP_COPY; } public void dragOver(DropTargetEvent event) { final Point pt = display.map(null, c, event.x, event.y); if (dragUnderEffect.x != pt.x || dragUnderEffect.y != pt.y || dragUnderEffect.width != 100 || dragUnderEffect.height != 100) { // need to update drag under effect // clear old effect Display.getCurrent().asyncExec(new Runnable() { public void run() { c.redraw(dragUnderEffect.x, dragUnderEffect.y, dragUnderEffect.width, dragUnderEffect.height, true); // save coordinates of new effect dragUnderEffect.x = pt.x; dragUnderEffect.y = pt.y; dragUnderEffect.width = 100; dragUnderEffect.height = 100; // draw new effect c.redraw(dragUnderEffect.x, dragUnderEffect.y, dragUnderEffect.width, dragUnderEffect.height, true); } }); } } public void dragLeave(org.eclipse.swt.dnd.DropTargetEvent event) { c.redraw(dragUnderEffect.x, dragUnderEffect.y, dragUnderEffect.width, dragUnderEffect.height, true); dragUnderEffect.x = 0; dragUnderEffect.y = 0; dragUnderEffect.width = 0; dragUnderEffect.height = 0; } }); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } display.dispose(); }(In reply to)Randy, When i use the plugin provided sample plugin, the trails stay on the screen after the DND operation is finished. It disappear if i scroll the diagram or resize the diagram editorFixed > 20060914DragSource:The fix is to allow the application code to turn off the default feedback. A new field 'feedback' has been added to DragSourcEvent. That field is set to DND.FEEDBACK_DEFAULT. Setting it to DND.FEEDBACK_NONE will cancel the drag start effect.DropTarget:It has always been possible to get rid of the target effect by setting the feedback field in the DropTargetEvent to DND.FEEDBACK_NONE.Steve N, is this change in 3.3 or 3.2.1? The GEF team was looking at a 3.2.1 work around.The change is for 3.3. All we have provided is a mechanism to turn off the default feedback on a widget by widget basis. The default is still that the feedback is on. GEF would need to decide which trees and tables were causing the problem and have them turn off the feedback. I suspect that the trees and tables belong to other components.We *might* consider changing the default to off for feedback for 3.3 but then other components would turn it on and GEF would suffer.Thoughts anyone?Mohammed, is there a GEF bug open to continue the investigation of a possible GEF work around for 3.2.x? Could you post the bug number here? Thanks.The area with cheese seems to be related to the size of the text in the TreeItem being dragged. Is it possible that SWT is doing something to prevent the Text from being shown as part of the feedback, and that there is some feature in windows related to this feedback being shown in "icon-only" mode?NOTE: We punted SWT.FEEDBACK_DEFAULT. The new way to get rid of default drag effects for 3.3 is to set the effect to null right after the drag source has been created.See: DragSource.setDragSourceEffect().The problem of DND feedback is specific to the target, not the source. How would a GEF target turn off feedback on the source (navigator view)?How would it turn it off if a drag was started in another application?Here's a funny article talking about some poorly documented windows API:From what I gleaned, SWT's DropTarget might be able to temporarily lock and unlock the target window on each drag over increment. That way, no matter what the target Control does, if it attempts to update(), windows will instead defer the rectangle that needs to be drawn until the target window is "unlocked".I'm reopening for 3.3 since the original fix was changed for one that was source-specific.Eh?It sounded like the fix that went into 3.2 handled the problem at the drop target, which I'm guessing worked for GEF without and GEF changes. But then that change was backed out in favor of one where the drag source has to turn off the feedback. In eclipse, the drag source and drop target don't know about each other. It is the same as your, when an external application is dragging over the GEF canvas.The link I provided seems to refer to a win32 API for locking a single Control, and preventing it from painting even if someone calls Control#update(). It is similar to calling setRedraw(false) I think.	61.0
id=205611	REOPENED	Platform	SWT	3.4	PC Windows Vista	P3 minor	Steve Northover	2007-10-05 16:59 EDT by	Nate Chu	2007-10-05 23:37 EDT (	2 users	Createdsnippet demonstrating issueBuild ID: I20070323-1616More information:When running Vista's Aero interface, A GC fillGradientRectangle(...) call will take a second or more to paint, slowly filling specified region from top to bottom. In the snippet, it appears that all the controls in the region are repainted as soon as fillGradientRectangle completes, with the end result that the gradient rectange is painted slowly and then disappears.	What is the bug? The slowness? You are drawing on the screen and then redrawing the controls, erasing the gradient.Please add Time.currentTimeMillis() to benchmark the slowness.What effect are you trying to get?Ok, I get it. You want to draw a gradient on top of the controls (sorry, I saw the clear code and thought you were calling it when you were drawing the gradient).I'm not sure why the controls redraw.Createdbetter snippetI pared down the snippet to only show the gradient issue; the average times for the various window appearances:windows classic - 8mswindows standard - 7msvista basic - 7ms (but with more variance)vista aero - 310ms	4.0
id=208866	REOPENED	Platform	SWT	3.4	PC Windows XP	P3 normal	Steve Northover	2007-11-06 05:11 EST by	Wassim Melhem	2009-12-30 17:08 EST (	4 users	Build ID: 3.3.1Steps To Reproduce:When displaying results in a table column, it is very clear that when the cell has a colored background that the content of the first cell is a few pixels off to the right.We see a sliver of white to the left. Screenshot to follow.More information:	CreatedStriped tableI don't think that there's much I can do about this. Windows leaves this margin.I might be able to do something but it seems low priortity. Closing as WONTFIX...... you can reopen with test code, present you case a bit stronger etc.but how are we supposed to build professional grade native-looking Eclipse-based database development IDEs with margins like that when others don't have them? :)Here is what some Joe Schmoe was able to accomplish out of his basement:Eh? Just attach the test code, reopen the bug and I'll see what I can do (if you care). You can probably get what you want with custom draw but let's not go there first.Thanks Steve. Will attach a snippet in the next day or so. Any insight/workaround/fix will be greatly appreciated.Createdsnippet to demonstrate the problemReopening for consideration. Steve, please let me know if the snippet is sufficient.Here is my workaround:Start with a zero width dummy column.(In reply to)This didn't work for me on XP, Vista or Windows 7.It works for me on XP, both default and classic theme!Just took thesnippet and changed setWidth(30) to setWidth(i == 0 ? 0 : 30) to make the white stripe disappear.Using a dummy column is a slipper slope. You then have to deal with it when setMoveable is True.Instead of letting the table draw its own images using getColumnImage in your label provider, override PaintItem on your table, and paint the image then. If you haven't already, see the EraseItem workaround () to paint the background color you want first. PaintItem is called after each EraseItem, so you can store objects looked up Erase for used in Paint in the event.item if you want as well to save computations.Using a dummy column is a slippery slope. You then have to deal with it when setMoveable is True.Instead of letting the table draw its own images using getColumnImage in your label provider, override PaintItem on your table, and paint the image then. If you haven't already, see the EraseItem workaround () to paint the background color you want first. PaintItem is called after each EraseItem, so you can store objects looked up Erase for used in Paint in the event.item if you want as well to save computations.	14.0
id=211876	REOPENED	Platform	SWT	3.3	PC Windows XP	P3 normal	Steve Northover	2007-12-04 08:29 EST by	Bernhard Gruber	2010-08-25 13:14 EDT (	3 users	Build ID: M20070212-1330Steps To Reproduce:1) start reproducer program2) click on button "Open non modal dialogue" on main window.3) click on button "Open MessageBox" in nonmodal window4) click on button "Open non modal dialogue" on main window again.now nothing happens, but it is possible to enter data in the textfield of main window.5) click on button "Ok" on message box "Hallo".now the second nonmodal window opens!The expected behaviour would have been, that the nonmodal window is modeless meaning that itdoes not prevent the processing of events in main window. In the textfield the behaviour isas expected. Only the selection event of the button seems to be delayed.More information:detected against SWT 3.1.1 and reproduced with SWT 3.3This is a problem in standalone SWT programs.Reproducer code:public class MessageBoxEventLoopSample { Display display; Shell shell; Shell dialogShell; public static void main(String[] args) { new MessageBoxEventLoopSample().go(); } protected void go() { display = new Display(); shell = new Shell(display); shell.setText("main window"); shell.setSize(400,200); shell.setLayout(new FormLayout()); Button button = new Button(shell,SWT.PUSH|SWT.CENTER); FormData data = new FormData(); data.left = new FormAttachment(0,100,0); data.top = new FormAttachment(0,100,0); button.setLayoutData(data); button.setText("Open non modal dialogue"); Text text = new Text(shell,SWT.BORDER); data = new FormData(); data.left = new FormAttachment(0,100,0); data.top = new FormAttachment(button,3); text.setLayoutData(data); button.addSelectionListener(new SelectionAdapter(){ public void widgetSelected(SelectionEvent arg0) { NonModalDialog nonModalDialog = new NonModalDialog(shell); nonModalDialog.open(); }}); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } }}public class NonModalDialog { Shell parent; public NonModalDialog (Shell parent) { this.parent=parent; } public void open () { final Shell shell = new Shell(parent.getDisplay(),SWT.MODELESS|SWT.CLOSE|SWT.MAX|SWT.MIN|SWT.RESIZE|SWT.TITLE); shell.setText("nonmodal dialogue"); shell.setSize(400,200); shell.setLayout(new FormLayout()); Button button = new Button(shell,SWT.PUSH|SWT.CENTER); FormData data = new FormData(); data.left = new FormAttachment(0,100,0); data.top = new FormAttachment(0,100,0); button.setLayoutData(data); button.setText("Open MessageBox"); button.addSelectionListener(new SelectionAdapter(){ public void widgetSelected(SelectionEvent arg0) { MessageBox messageBox = new MessageBox(shell,SWT.PRIMARY_MODAL); messageBox.setText("Hallo"); messageBox.open(); }}); shell.open(); }}	That's what ST.PRIMARY_MODAL does. Change it to SWT.APPLICATION_MODAL to get the effect you are after.I do not think, that this is what PRIMARY_MODAL should do.It should not interfere with other modeless windows.Currently it delivers some events (keystrokes to the textfield) and blocks someevents in the event queue (selection event of the button). The selection event is not ignored, it is just delayed until the message box is closed.Such an event delay is not defined for any kind of modality!It looks like the dispatching of events is not correct or incomplete in the event loop of the message box.The only change I suggest is to deliver the selection event of the button just the same way as the keystroke events of the text field. This would be the behavior observed in other windows applications using this kind of modality.Of course, we currently use APPLICATION_MODAL, because it is currently the only way to get a consistent behavior - it ignores all events outside the message box. Since PRIMARY_MODAL is supported by org.eclipse.swt.widgets.MessageBox, it should be implemented correctly. If only APPLICATION_MODAL can be supported, this restriction should be documented accordingly.A window that is "primary modal" blocks input to the parent. This is what primary modal does and we can't/shouldn't change it.The delayed events part is a bug and needs investigation. It's possible the fix will be to upgrade PRIMARY_MODAL for MessageBox to APPLICATION_MODAL.	3.0
id=215007	REOPENED	Platform	SWT	3.3.1	PC Windows XP	P3 normal	Steve Northover	2008-01-11 07:10 EST by	Richard Birenheide	2008-02-27 09:00 EST (	2 users	Build ID: M20070921-1145Steps To Reproduce:1. Put a couple of listeners (any kind) on a widget2. One of the listeners throws an arbitrary RuntimeException (eg. NPE)3. listeners subsequently called in the loop (EventTable) are not called. More information:The listener calls not being safeguarded has also severe consequences for any caller of Display.readAndDispatch() since the listeners RuntimeException travels outside without being wrapped in a SWTException. If a runtime exception is happening in a runnable running a Display.syncExec or Display.asyncExec it comes wrapped in a SWTException. Therefore callers of Display.readAndDispatch() might not expect that they must catch RuntimeExceptions as well which leads to undesired and hard-to-track problems, as Display.readAndDispatch() is mainly used when multi-threading is involved.We had this problem when setting up for UI tests. Since the PDE-JUnit tests are run in the UI thread we have to fork out to a separate tests with an own test suite in order to not block the test run with modal dialogs being opened. Our test suite forks the test run into a separate test (from the UI thread) and issues then a Display.readAndDispatch() loop until a flag indicates the test run being finished. The (expected) SWTException had been caught in the waiting loop but not a RuntimeExcpetion which might easily be propagated through from a listener. This lead to a premature death of the WorkbenchTestable thread and the IDE subsequently not being shut down, which caused severe problems in test run nightly. Also the bug was very hard to find since (as the RuntimeException was not caught and/or logged in the loop) it was not apparent that the Exception led to premature end of the waiting loop.I think the following behaviour would be desired:1. Catching any RuntimeException from listeners for each individually while looping through the listeners.2. Wrap the caught exception into a SWTException (like it is done for Runnables in a Display.syncExec) and throw after ALL listeners are being notified. This also prevents the UI from undesired behaviour if one of the players in the game is playing false.	(In reply to)Must read:We had this problem when setting up for UI tests. Since the PDE-JUnit tests arerun in the UI thread we have to fork out to a separate <em>thread</em> with an own test suite in order to not block the test run with modal dialogs being opened. Our test suite forks the test run into a separate <em>thread</em> (from the UI thread) and issues then a Display.readAndDispatch() loop until a flag indicates the test run being finished. The (expected) SWTException had been caught in the waiting loop but not a RuntimeExcpetion which might easily be propagated through from a listener.SorryRichardI can't see us changing this. When an exception happens in a listener, processing stops. If you want processing to continue, then catch (and swallow) the exception in your listener. Even if we wanted to change it, code has been written that relies on the current behavior.I wonder, is there anything else we can do in this area to help?The problem is not that MY listener plays false (where I easily could swallow the exceptions under question).The problem is, that Eclipse is an open platform. Anyone can register stupid listeners and this has ocurred in the past, even from Eclipse projects. When a RuntimeException occurs, subsequent listeners on the widget will not being called. Even worse, as order is not guaranteed, behaviour might differ from run to run. I cannot see any compatibility issue here. If you run the event loop completely and throw an SWTException (which is a RuntimeException) there is no issue, as anyone involved has to precaution for these anyway (as Display.readAndDispatch() throws it).	3.0
id=127264	REOPENED	Platform	Releng	3.2	PC All	P3 normal	Sonia Dimitrov	2006-02-10 09:59 EST by	Tom Hofmann	2006-03-12 16:21 EST (	0 users	Hi Sonia,I will attach two patches that allow to augment the performance test reports with information about the statistical significance of the displayed differences. Could you review them? They worked fine for me but would certainly need testing before inclusion in the testing process.On the fingerprint bars, we currently display the quotient of the means of two samples (one current and one reference sample) as a percentage. However, if one or both samples are not robust (i.e. have a high standard deviation), even a large difference of the two means may not be statistically significant. That is, the difference may have occured by chance and it cannot be concluded from the data that the real average performance is different.The statistic being tested for significance is the "difference of the means" of the two measurements (current and reference measurement). Significance is tested using the Student's t-test on that statistic. The signifcance level is currently set to 10%, but can be changed easily (see StatisticsUtil.Percentile). A "significance level of 10%" means: the probability that we measured the observed difference on the same code base is less than 10%.The implemented solution grays out the percentage bars of the fingerprint graphs and the check/failure marks for insignificant tests.-- implementation notes- in order to compute the standard error of the difference of the means of a certain test when generating the graphs, we need more information about the collected measurements than just the mean. We also need the standard deviation and sample size. This is implemented by storing them analogous to how the mean was stored up to now: as a DataPoint with a step id identified by the STDEV and SIZE constanst in InternalPerformanceMonitor. See DB.internalStore for the details. There is no database change needed, and the change only modestly increases the amount of stored data.Since these values will not be available until the next run of the baseline tests, there won't be any visible change on the performance pages until then.- the significance computation is done in FingerPrint.add (for the graphs) and ScenarioStatusTable.toString (for graying out check/failure marks). The implementation is delegated to StatisticsUtil.	CreatedFP_org.eclipse.jdt.text_I20060208-0848_I20060208-0853.eclipseperflin2_R3.2.gifAn example fingerprint bar showing two tests, of which one is significant but not the other.Createdperformance.diffSaid patch - only one actually, but containing changes to both org.eclipse.test.performance and org.eclipse.test.performance.ui.Thanks Tom, I will give it a spin and send you some sample results.Createdperformance.diffalmost the same - fixes an incorrect assumption in StatisticsSession.Patch applied, changes released to HEAD.Patch applied and used in 3.2M5 performance testing (though not released for 3.2M5). I don't know how to verify that this works since the scenario in the attached gif does not appear to be part of results. Please reopen if further changes required.Cool, thanks!No change in the results will be visible until there is a reference build available with the additional data. Hm, I assumed that also the reference test runs would be run with the updated version of the performance plug-ins - is this correct? If yes, there should be a visible difference after the next reference test run has collected data.Will run the next reference test with the change (this Thursday).Ok, we start seeing some results with I20060228-1207:- some tests are greyed due to their statistical insignificance- the detail view shows a note about the test not being significantHere are the things that we'll have polish:- add the OK_greyed.gif icon for insignificant positive measurements (its missing on the details pages) > should be easy to correct on your side, right?- choose a color for insignificance different from the grey used for "explainable" degradations. Yellow was suggested, but may be too much alerting. > what do you think?- add hovers for insignificant fingerprint bars (probably also for explained degradations). > this would require adding more HTML output code to the generator - do you think this is feasible?Also, I noticed that some measurements appear not-greyed out but still carry the note when looking at the details page. I have no idea why this is happening and will investigate.Reopening.- add hovers for insignificant fingerprint bars (probably also for explaineddegradations). > this would require adding more HTML output code to the generator - do youthink this is feasible?I had investigated this previously (see#c20) - help wanted in this area.Changes for yellow cautionary markings released for next performance test run (i.e this Tuesday's I build).	12.0
id=172850	REOPENED	Platform	SWT	3.3	PC Windows XP	P3 normal	Steve Northover	2007-02-05 08:14 EST by	Thomas Schindl	2010-02-08 12:30 EST (	1 user	setAlignment() is not working for Buttons who hold an image and text at the same time. Maybe this is platform-specific behaviour and can not be worked around but it should be documented in the javadoc of setAlignment() that this has no effect in the described situation.	We might be able to work around this one day, but not today.I'm just wondering if we can get this limitation added to the JavaDoc (i.e. is it just when an Image and Text is present, does it only happen on certain platforms, etc...). I just got bit by this too.	2.0
id=432115	REOPENED	Platform	SWT	4.4	PC Linux	P3 normal	Sravan Kumar Lakkimsetti	2014-04-06 21:12 EDT by	Luke Swart	2017-02-16 19:35 EST (	8 users	Creatededitor change viewWhen changing between editors, using the `Ctrl-TAB` shortcuts, the develop can only see 2 editors. This makes it difficult to scroll when many editors are open. This bug was not present until upgrading from 4.3.* to 4.4. This bug is also present when switching between views. I am on Ubuntu 13.10 if it matters.Any help or feedback would be appreciate.	Reproduced in Ubuntu 13.10 (Unity with default settings).Cannot reproduce in Windows 7.Tested with I20140402-0100.Luke, try launching your eclipse with SWT_GTK3=0Does it work better then?PW(In reply to Paul Webster from)Yes, it works! Adding SWT_GTK3=0 resolves this issue and several other issues. Thank you.Marking the issue as resolved.That's just the workaround :-)PW(In reply to Paul Webster from)Oops, that's right. Got it!I was suspecting this would be related to the use of overlay scrollbars in Ubuntu Unity, which caused the bugs 420771, 424343 and 432116. I was able to however reproduce the bug on Ubuntu 13.10 even with the overlay scrollbars disabled. The same problem is not seen on Ubuntu 12.04 with GTK+ 3.4.2.Alex, do you see this problem on Fedora/RHEL?So what is the problem here ? The missing scrollbar on the screenshot or that only 2 rows are visible ?I experience the later one.Createdprevious behavior(In reply to Alexander Kurtakov from)The latter is indeed the problem Alex. With GTK+ 3.4.2 on Ubuntu 12.04, I get a much bigger popup window as seen in the screenshot. Something seems to have changed in later GTK+ versions...The problem is with gtk_widget_get_preferred_size call.The workaroung code has been commited byI can't reproduce the issue on Mars or Neon.	12.0
id=459834	REOPENED	Platform	SWT	4.5	PC Linux	P3 normal	Sravan Kumar Lakkimsetti	2015-02-12 16:47 EST by	Steven Hung	2017-02-16 19:17 EST (	6 users	CreatedPatch for reproducing the issueThis problem only happens on RHEL 7. It was fine in RHEL 6 and fine on other OS. Setup:1.Download and install Eclipse Mars M52. Download and install WTP 3.6.0 ()1. Start Eclipse2. Import org.eclipse.jst.server.tomcat.ui_v2.zip as an existing workspace3. Run the plugin as self-hosting (i.e. Run > Run Configurations... > Eclipse Application > Run)4. File > New > Other... > Servers > Select tomcat 8 server5. Click Next, you will now see the stack overflow errorThe code that causes this problem can be found in org.eclipse.jst.server.tomcat.ui.internal.TomcatRuntimeComposite	CreatedTraceHere is the full trace.The problematic code is:Table connTypeTable; int numSupportedConnTypes= 3;TableItem[] tableItems = new TableItem [numSupportedConnTypes];connTypeTable = new Table(this, SWT.BORDER | SWT.MULTI);TableLayout tLayout = new TableLayout();GridData data2 = new GridData(GridData.FILL_HORIZONTAL);data2.horizontalSpan = 2;data2.horizontalIndent = 20;data2.widthHint = 100;connTypeTable.setLayoutData(data2);connTypeTable.setLinesVisible(true);connTypeTable.setHeaderVisible(true);String[] columns = {"Connection type", "Port", "Default port", "Description"};for (int i = 0; i < columns.length; i++) { TableColumn column = new TableColumn(connTypeTable, SWT.NONE); column.setText(columns[i]);} tLayout.addColumnData(new ColumnWeightData(50, 50, true)); tLayout.addColumnData(new ColumnWeightData(35, 35, true)); tLayout.addColumnData(new ColumnWeightData(35, 35, true)); tLayout.addColumnData(new ColumnWeightData(100, 100, true));connTypeTable.setLayout(tLayout);for (int i = 0; i < tableItems.length; i++) { tableItems[i] = new TableItem(connTypeTable, SWT.NONE); for (int j = 0; j < 3; j++) { if (j == 0) { //Add connection Checkbox control TableEditor editor = new TableEditor(connTypeTable); Button button = new Button(this,SWT.None); button.pack (); editor.minimumWidth = button.getSize ().x; editor.horizontalAlignment = SWT.LEFT; editor.setEditor (button, tableItems[i], j); } else if (j == 1) { //Add port Text control TableEditor editor = new TableEditor(connTypeTable); Text text = new Text(this,SWT.NONE); text.setText("asdf"); text.pack(); editor.minimumWidth = text.getSize().x; editor.minimumHeight = text.getSize().y; editor.setEditor(text, tableItems[i], j); } else if (j == 2) { //Add connection type default ports tableItems[i].setText(j, "1234"); } else { //Add connection type descriptions tableItems[i].setText(j, "1234"); } connTypeTable.getColumn(j).pack(); }}connTypeTable.pack();New Gerrit change created:Gerrit changewas merged to [master].Commit:Patch is in master now, needs to be verified in the I-build.I had tried downloading the latest nightly build to verify. My version of org.eclipse.swt was 3.104.0.v20150422-0737 and org.eclipse.platform was 4.5.0.v20150422-1000. I still see the issue though.I had downloaded fromis that the correct place to get it from?(In reply to Steven Hung from)That indeed is the right place and is the build which contains the proposed fix, thanks for verifying!I'll reopen the bug since the problem is still reproducible, however, I'm not sure whether it will get fixed in 4.5 or not...Thanks for confirming and reopeningThis is not consistently reproducible scenario. We did fix a part of the problem. Need more effort in fixing this problem. Moving this out of 4.5Can you please check with the latest version of eclipse and see whether it is reproducible. Also it does not affect the eclipse IDE so moving out of 4.6I just tried this with the latest Eclipse Neon and this problem still exists.	11.0
id=499147	REOPENED	Platform	Releng	4.7	All All	P3 normal	Sravan Kumar Lakkimsetti	2016-08-04 07:11 EDT by	Sravan Kumar Lakkimsetti	2016-11-28 02:44 EST (	5 users	This test is failing with the following errorEither file (url) does not exist (build may have been removed?), or HTTP response does not contain content length. urlOfFile:The URL is accessible. but some how this is not accessible during test. this is happening for all platforms	It indeed does most of the time, but in I20160803-2000 it did not fail on Windows.Retargetting for M3Fixed withThe code change didnot work. I will look at this in M3Happened again in I20161011-0800:Moving to M4The previous commit tried to disable the test, but it introduced a compile error that broke the build.Disabled the test via @Ignore:Disabled this test for now. The root cause of the problem is delay in writing to the disk on build.eclipse.org. I am targeting it to 4.7	8.0
id=493357	REOPENED	Platform	UI	4.6	PC CentOS	P3 normal	Sravan Kumar Lakkimsetti	2016-05-10 11:15 EDT by	Dani Megert	2016-07-28 16:13 EDT (	6 users	4.6 M7.8 tests consistently fail on CentOS.	This can be reproduced using gtk3 machine not necessary to have CentOS.There two problems in this particular case.1. SWT.SetData event is getting delayed. atleast 3 tests gets cancelled because this event is not received in time for the test case to pass.2. There is a delay in processing setSelection call. The delay is on the gtk side. This is causing the topindex calls to return wrong values.I will need some more to properly analyse these test failuresMoving to RC3 as there is not much time. @Dani is this really needed for Neon? these problems exists in GTK3 implementations quite long time.(In reply to Sravan Kumar Lakkimsetti from)Then disable the tests for now, since others running those tests will also see them fail.New Gerrit change created:Gerrit changewas merged to [master].Commit:Sravan, this causes 790 test failures on all non-Linux platforms, e.g.New Gerrit change created:New Gerrit change created:Hi Dani,Please review. This has better implementation of verifying the GTK3 version. This uses system property to check for GTK3 instead of OS.GTK3.ThanksSravanGerrit changewas merged to [master].Commit:With the latest patch, the test are skipped on a my GTK3-based Fedora.Reopening to investigate the failures during 4.7.I did some preliminary investigation: right off the bat I can see that 3 of the tests are failing due to List.getTopIndex(). Those are:testNoSelectionRefreshtestSelectionRefreshtestSelectionRevealBug177619As for the others, I can't yet say if they are caused by getTopIndex() issues. Those test cases have more JFace in them so it will take me a bit longer to dig to the bottom of it.(In reply to Eric Williams from)This bug stems from List.getTopIndex(), but isn't the same problem outlined in. This particular test failure is caused by gtk_tree_view_get_path_at_pos() returning false, which makes List.getTopIndex() to return 0.These two bugs are definitely caused by. Working on a fix for that at the moment.(In reply to Eric Williams from)I've actually included a fix for this in the patch foras well, since they are similar in nature.What is the status here Eric? Are the tests reenabled and fixed now?(In reply to Alexander Kurtakov from)Will check, IIRC there are still 2 or 3 failures.(In reply to Eric Williams from)Tests are disabled, if I re-enable them on my local machine there are the old failures and a few new ones. Still work to be done then as part of.	18.0
id=506953	REOPENED	Platform	Releng	4.7	PC Linux	P3 normal	Sravan Kumar Lakkimsetti	2016-11-03 04:19 EDT by	Sravan Kumar Lakkimsetti	2017-02-23 07:06 EST (	3 users	This is simply to document the update to the semi-persistent URL for Orbit's latest build: S20161021172207This change is simply to change the URL.	Please let me know it there is a new version of Orbit platform needs to pick up.There should be a build with Lucene 6.1 jars soon which is work in progress for M4. Seefor details.I will wait till last week of development before adopting new orbit platformwe are currently using N20161115170919 version in our build. Do we have new version that should be used for M4?Orbit's Oxygen M4 contribution will be released next week (a week before Oxygen M4+0)There's also a newer I-build I20161118141606 you could try.(In reply to Roland Grunberg from)I will pick the released version and use it for M4. Please let me know once it is released(In reply to Roland Grunberg from)I will move to I build for M4. We will check again during M5New Gerrit change created:Gerrit changewas merged to [master].Commit:Added dependency for M4. Lets check again for M5Orbit has declared a build for Oxygen M4 at.. although it would have no changes with respect to Lucene comparing to the I-build you've selected.New Gerrit change created:Gerrit changewas merged to [master].Commit:We have M5 Release on Jan 27th. Do we have a new version available for Eclipse use? If so can you please provide us the URL?Equinox is waiting for a library from orbit.(In reply to Sravan Kumar Lakkimsetti from)Orbit will release the Oxygen M5 contribution one week before Oxygen M5+0 deadline.I've promoted an I-build for testing purposes :It can be seen from the Orbit Downloads Page () under the I-builds.(In reply to Roland Grunberg from)Thanks Roland. I will switch to I build for now.moved tofor M5 with(In reply to Sravan Kumar Lakkimsetti from)In master for M5Reopening the bug for M6 contribution. Please let us know if we have a build for M6	19.0
id=506955	REOPENED	Platform	Releng	4.7	PC Linux	P3 normal	Sravan Kumar Lakkimsetti	2016-11-03 04:25 EDT by	Sravan Kumar Lakkimsetti	2017-02-23 07:05 EST (	4 users	This bug is check emf updates and modify prereqs if requiredWe are currently using basecore	New Gerrit change created:Gerrit changewas merged to [master].Commit:We are currently using basecoreDo we have a new build for EMF(In reply to Sravan Kumar Lakkimsetti from)Wanted to check with emf team regarding availability of new version for M4(In reply to Sravan Kumar Lakkimsetti from)I will create a new version, there were some build related changes. Stay tunedemf-base Oxygen M4 contribution:~/downloads/modeling/emf/emf/updates/2.13milestones/base/S201611290615(In reply to Dennis Huebner from)Thanks Dennis. I will update in our scriptsNew Gerrit change created:Gerrit changewas merged to [master].Commit:(In reply to Eclipse Genie from)Updated in master. keepint it open for M5We have M5 Release on Jan 27th. Do we have a new version available for Eclipse use? If so can you please provide us the URL?Hi Dennis,Do we have a new version of EMF for eclipse use for M5. We have M5 scheduled for Jan 27.ThanksSravanSince there is no response from EMF team I guess there are no changes for M5. I will reopen this during M6(In reply to Sravan Kumar Lakkimsetti from)Sravan,I normally do not read bugzilla mails on weekend. I saw some changes in the EMF git repository, so think we need to build a newer emf-base version. When is the deadline?(In reply to Dennis Huebner from)Tomorrow is the testing day. If we can get a build next few hours I can incorporate this in to M5.I will start building now. Stay tunedemf-base 2.13.0M5 for Oxygen:~/downloads/modeling/emf/emf/updates/2.13milestones/base/S201701230427/Why are you using emf-core? The idea was to have all the dependencies for the eclipse platform being in emf-base, AFAIK.(In reply to Dennis Huebner from)This is there from quite long time. I will check and remove emf-core if it is not used.We use the following from emf core.org.eclipse.emf.editorg.eclipse.emf.databindingorg.eclipse.emf.databinding.editPlease let us know if we need to change.New Gerrit change created:Gerrit changewas merged to [master].Commit:(In reply to Eclipse Genie from)In master now(In reply to Eclipse Genie from)If you need an m5 Version of emf-core please use:~/downloads/modeling/emf/emf/updates/2.13milestones/core/S201701230457(In reply to Sravan Kumar Lakkimsetti from)@Ed, we need to change that IMHO.New Gerrit change created:Gerrit changewas merged to [master].Commit:New Gerrit change created:Gerrit changewas merged to [master].Commit:Added emf-core repo as wellReopening the bug for M6 contribution. Please let us know if we have a build for M6	30.0
id=506956	REOPENED	Platform	Releng	4.7	PC Linux	P3 normal	Sravan Kumar Lakkimsetti	2016-11-03 04:27 EDT by	Sravan Kumar Lakkimsetti	2017-02-27 14:47 EST (	4 users	This will be are on-going bug to update ECF pre-reqs for Milestones, if/when we need to. We are in M4, thought it important to check with ECF team. We are currently using bundles from	Do we have a new build for ECF for M4?Our plan is to produce a maintenance release (3.13.3) on Dec 5. If that can be used for M4 then great, if not then it can be used for M5.(In reply to Scott Lewis from)I will wait for 3.13.3Sravan, Should we move it to M5 ?(In reply to Alexander Kurtakov from)Yes. We discussed this in our call today.(In reply to Alexander Kurtakov from)Yes pushing to M5ECF 3.13.3 released todayNew Gerrit change created:Gerrit changewas merged to [master].Commit:Gerrit changewas merged to [master].Commit:New Gerrit change created:New Gerrit change created:Some more changes required 1. equinox-sdk.product in eclipse.platform.releng.aggregator repo2. org.eclipse.equinox.server.p2/feature.xml in rt.equinox.bundles3. org.eclipse.equinox.p2.core.feature/feature.xml in rt.equinox.p24. org.eclipse.equinox.p2.sdk/feature.xml in rt.equinox.p2(In reply to Sravan Kumar Lakkimsetti from)1. patch in2. not really needed as no source feature is included in this feature.xml3 and 4.patch inGerrit changewas merged to [master].Commit:Gerrit changewas merged to [master].Commit:New Gerrit change created:Gerrit changewas merged to [master].Commit:We have M5 Release on Jan 27th. Do we have a new version available for Eclipse use? If so can you please provide us the URL?(In reply to Sravan Kumar Lakkimsetti from)I will complete a new maintenance release (3.13.4) between now and Monday Jan 16, and post the URL here before cob on 16th.(In reply to Scott Lewis from)ECF 3.13.4 p2 repo, with new httpcomponent/httpclient is available here:(In reply to Scott Lewis from)Thanks Scott. I will move to 3.13.4 today.New Gerrit change created:Gerrit changewas merged to [master].Commit:Udated ECF prereq with 3.13.4. Lets try again in M6.Thanks(In reply to Sravan Kumar Lakkimsetti from)Hi Sravan. What do you mean 'try again in M6'?And I think this bug should be resolved shouldn't it? (along with 510179 dep)...at least until the next need for update.(In reply to Scott Lewis from)Hi Scott,This is ongoing bug. I update the ECF prereqs every milestone till RC4. 1 week before next milestone I normally update this bug for latest ECF repo. Thanks the reason I will try for new version in M6 again. Thanks,Sravan(In reply to Sravan Kumar Lakkimsetti from)I would prefer it if a new bug was opened and closed for each needed contribution rather than keep this one contribution bug open indefinitely. The reason is that with our new Tycho build nothing will change (even the filetransfer version numbers) unless an update to the ECF code or dependencies is actually needed. For example, the latest build of the ECF filetransfer bundles is exactly the same as the previous one, as we only had to substitute in the new Apache httpclient versions...with no code changes to ECF's bundles at all.So, in any event, I would prefer it if a bug was only opened when an actual update was needed...otherwise everything about ECF's contributions to platform will stay the same.Ok I am resolving this now. What I will do is reopen when we near next milestone. I hope that would be OK with you.(In reply to Sravan Kumar Lakkimsetti from)As far as I'm concerned, that's only necessary if some change needs to be made to either the version of Apache httpclient that's being used (as per 3.13.4) or some change is needed to ECF filetransfer code.Yes, thanks.Reopening the bug for M6 contribution. Please let us know if we have a build for M6(In reply to Sravan Kumar Lakkimsetti from)SeeNew Gerrit change created:Gerrit changewas merged to [master].Commit:	34.0
id=507271	REOPENED	Platform	Releng	4.7	PC Windows 7	P3 normal	Sravan Kumar Lakkimsetti	2016-11-09 03:45 EST by	Sravan Kumar Lakkimsetti	2017-01-20 04:35 EST (	3 users	With move to I-builds we need a new retention policy.The schedule is Daily 8 PM build and extra build on Tuesday 8:00AM (similar to weeky I buildThe retention policy is to have last 7 builds built at 8:00PM and retain all 8:00 AM builds till the end on milestoneNeed to implement this policy	Here is the final policy there will be I-builds on everyday at 8PM est and Monday's build will be retained.New Gerrit change created:Gerrit changewas merged to [master].Commit:(In reply to Eclipse Genie from)In master nowAFAICS, the script retains all Monday builds (not only the Monday 20:00 builds), and it doesn't care whether I-builds are marked as unstable.In case the Monday I-build is unstable, we would lose the rebuild, since that typically only happens on Tuesday morning.I'm not sure it's worth trying to prevent these problems right now, but I wanted to mention them so that we're aware of potential problems with unstable Monday builds.The policy should be to retain each Monday I-build or the first rebuild that was not marked as unstable.At the beginning of November, we still had the old schedule where we produced I20161101-0800 and I20161108-1015 (a same-day rebuild on a Tuesday). Those builds are already lost now.With builds starting at 20:00, it will be common that we lose rebuilds. This makes it too hard to track down problems that were not identified right away.I wanted to make one comment on the retention policy. One of the purposes of "leaving old builds around" was to allow users to "revert" to to previous install. For example, if someone had an I-build from Monday, then installed one from Tuesday, then installed one from Wednesday, and then again on Thursday and found the Thursday I-build had a subtle error that was "getting in their way", they should be able to revert to Wednesday's build, or revert to Tuesday's, or revert to Monday's. If some of the I-builds they have installed are "missing", then the revert is more likely to fail or not be possible. I do not think too many people take advantage of this feature of p2, but just thought I would mention it in case anyone thought it would be significant. I personally think it would be better to leave all I-builds, say, over a two week period, or so. Unless of course one was found to be "dangerous" if installed such as damaged a workspace or interfered with the ability to update, etc. The previous policy of "leaving 3 I-builds in the repository" basically had the effect of leaving 2 or 3 weeks worth of "work" in the repository, for the purposes of reverting. Just a suggestion.I did not had time to work on this issue. Retargetting	8.0
id=477848	REOPENED	Platform	UI	4.6	All All	P3 normal	Stefan Winkler	2015-09-18 14:31 EDT by	Stefan Winkler	2016-04-20 12:18 EDT (	2 users	The Properties view is still at Java pre-1.4 level. Hence, it shows quite a few warnings, because it does not use typed collections etc.	New Gerrit change created:Gerrit changewas merged to [master].Commit:Thanks Stefan.Fix caused. Reverted.Lars, you really have to be more careful when reviewing patches.Mass move to 4.7 as M7 is approaching. Please move back in case you are planning to fix it for Neon.	5.0
id=322531	REOPENED	JDT	Core	3.6	All All	P3 major	Srikanth Sankaran	2010-08-12 09:44 EDT by	Achim Loerke	2011-06-03 03:26 EDT (	6 users	The following snippet compiles fine using the build-in compiler in Eclipse 3.5.2 and 3.6 but yields an error using javac 1.6.0_21 and 1.5.0_22import java.awt.event.ActionListener;import java.util.ArrayList;public class Test { public Test() { } public <T extends ActionListener> void test(Class<T> clazz) { boolean b = clazz == ArrayList.class; }}The message isTest.java:7: incomparable types: java.lang.Class<T> and java.lang.Class<java.util.ArrayList>boolean b = clazz == ArrayList.class;Seems to me that javac is right since ArrayList is not a subclass of ActionListener.	Indeed, this is a bug in eclipse. Will follow up.Slightly shorter test case:interface I {}public class Test { <T extends I> void main(Class<T> clazz) { boolean b = clazz == Test.class || // eclipse - !Error, javac - Error I.class == Test.class; // Both compilers complain here }}Also interesting is:interface I {}public class Test { <T extends I> void main(Class<T> clazz, Test t) { boolean b = clazz == t.getClass() || // eclipse mum, javac mum I.class == t.getClass(); // eclipse mum, javac scream }}Again, at the outset, javac behaviour seems to be correct.Also interesting is that eclipse compiles the following without error:import java.util.List;interface I {}public class Test { <T extends I> void main(List<T> clazz, List<Test> testList) { boolean b = clazz == testList; }}while javac complains.but if you make Test a final class, eclipse also complains.In the exact same contexts, eclipse has no hesitation inflagging an assignment as being illegal.Here is another very interesting case:interface List<E> {}interface I {}public class X implements I { void main(List<I> li, X t) { boolean b = I.class == t.getClass(); // javac complains here b = li == t.getList(); // javac does not complain here } List<? extends Object> getList() { return null; }}which indicates that javac recognizes I.class to be a constantclass literal expresssion.(In reply to)I have raisedto track this.CreatedProposed patchAll tests pass, Jay, please review. TIA.The problem here basically is that the eclipse compilerwas not recognizing (in the comparison context) thatan expression such as ArrayList.class is a compile timeconstant, it being a class literal and that the type ofthat expression is frozen cannot refer to any subtypeswhatsoever.Patch looks good. Sorry about the delay, Srikanth.Released in HEAD for 3.7 M2.Verified for 3.7M2 using I20100914-0100Reopening since this causes more serious problems(see). Will look to fix this for M4.This seems to be a big twilight zone, best reflected in Philippe's comment:.The JLS arbitrarily defines what criteria can be used to "prove" two typesdistinct. This is different from what javac checks, is different fromwhat common sense may conclude, which is different from ...For the issue at hand JLS 4.5.1 has this simple rule:"Two type arguments are provably distinct if neither of the arguments is a type variable or wildcard, and the two arguments are not the same type."According to that rule we have no reason to report an error for any of theexamples that involve a type variable.I made a quick test by adding to the top of isProvablyDistinctTypeArgument() if (isTypeVariable() || otherArgument.isTypeVariable()) return false;This changed the outcome of 2 tests in GenericsRegressionTest - test322531d() and test322531f()and 10 distinct tests in GenericTypeTestIn all cases common sense seems to agree with our compiler, but I doubtthat these are in line with the JLS.Other related bugs are,and, which introducedthe method TypeBinding.isProvableDistinctSubType(), and many more relatedissues I'm sure.Srikanth, what's your strategy in this mine field? Is it time to makestrictness configurable (JLS - emulate javac - best effort)? Might becleanest but also a significant effort I'm afraid.(In reply to)I agree that there is room for discretion in these cases. What I wouldlike to do here is to address those cases where the distinction can bediscerned fairly obviously and match up eclipse behavior with javac, butthis is going to have to wait as I don't have time right now.I'll revisit this later and see what is the best course of action.(In reply to)See JLS spec bug 6557279 and sun compiler bug 6932571.(In reply to)Do you have a working link to the spec bug?All I get on oracles pages is: "This bug is not available."(In reply to)Yes, this link looks broken now - Here is the text from notes I hadmade earlier:JLS 4.5.1.1 should be clarified along these lines:"Two type arguments are provably distinct if one of the following is true:- Neither argument is a type variable or wildcard, and the two arguments are not the same type.- One type argument is a type variable or wildcard, with an upper bound (from capture conversion, if necessary) is S; and the other type argument T is not a type variable or wildcard; and neither |S|<:|T| nor |T|<:|S|.- Each type argument is a type variable or wildcard, with upper bounds (from capture conversion, if necessary) of S and T; and neither |S|<:|T| nor |T|<:|S|."Stephan, Olivier,I have been staring at this text for a long time now - does not this makeList<? extends Number> and List<Object> not provably distinct ? For:"Two parameterized types are provably distinct if either of the following conditionshold:• They are invocations of distinct generic type declarations.• Any of their type arguments are provably distinct."Bullet 1 obviously holds. Looking at bullet 2,Argument#1 = "? extends Number" and Argument#2 = ObjectS = UpperBound(Argument#1) = NumberT = Object.|S| <: |T|What silly mistake/oversight am I committing here ?(In reply to)Hi Srikanth,"Sorrry" I can't find a mistake in your reasoning.Here's how I interpret the situation: the currently valid version of the JLSis a strawman in this regard: as soon as we see a type variable or a wildcardwe are not allowed to mark any parameterized types as provably distinct. EOS.The "improvement" you quote (let's assume it has any authorization,to me it is little more than a rumour) takes the smallest possible stepin the desired direction: if we encounter any type variable or wildcard,those must be really really different for the overall types to be consideredprovably distinct.So while List<Number> is provably distinct from List<Object>, the "new spec" indeed doesn't consider List<? extends Number> or List<E extends Number> as provably distinct from List<Object>.Sure, if we have wildcard/typevariable with an upper bound and a class typeabove the upper bound those can never be unified, but the "new spec"simply doesn't exploit this fact and thus it is probably much weaker thanthe current implementation of javac.Sure the spec would become longer if all cases would be aggressivelyspelled out to mark as provably distinct as many pairs of types as possible.If one type argument is a typevariable or wildcard with an upper bound,maybe different cases would need to be created for the other type argument (class type vs. interface type) to determine whether two-way incompatibility or one-way incompatibility must be required etc.I'm sure between us we could prove lots of pairs of types distinct, whichthe JLS shyly accepts as may-be-this-may-be-that.My question is: do we see strong activity towards a really improved spec?Otherwise, why not indeed consider different levels of type checking:- strict JLS (weakest)- approximate javac (medium)- best effort (strongest)I admit the medium level would be difficult to maintain, because all dependson practical experiments, and the evolution of javac may be diffictul totrace. But I don't see how one fixed algorithm can ever serve all masters.(In reply to)Thanks for taking a look and re-affirming the observation.When I saw the spec bug being fixed, I rather naively expectedjavac7 of the latest vintage to comply to this version.In the end as you say, this _is_ only the smallest possible stepin the desired direction and is not a panacea for the all thebehavior differences between javac & ecj due to each one'sidiosyncratic interpretation of distinctness of types and type arguments.There are some behavior differences between javac7 and javac6 which intandem with the spec bug seemed to indicate such activity, but it nowlooks just a smoke screen.We have some use cases and user scenarios where compatibilityis paramount and that really narrows down the choice to themedium level,Sigh.(In reply to)I wasn't suggesting to abandon the medium level, but to make strictnessconfigurable. I don't mind making medium the default, but give people achoice to push the compiler either way.Or are you saying that *everybody* leave it at the (muddled) medium?Maybe having the option to revert to medium, people get the courageto use best effort during day-to-day business?(In reply to)[...]Strict JLS mode is not going to serve any useful purpose given howunderspecified things are. If we make medium the default (which is theonly real choice we have), we anyway have the onerous burden of diviningjavac's interpretation by little more than staring into tea leaves. Andyou want to complicate things further by adding yet another mode ? :)On a more serious note, I agree there is no gainsaying the value of astrict mode, but it is a project for another day.Another test case frompublic class Test { public static class Foo<T>{ } public static class Bar<T> extends Foo<T>{ } public <Z,E extends Foo<Z>> Class<E> test(){ return (Class<E>) Bar.class; }}***has been marked as a duplicate of this bug. ***Another test case frominterface List<E> {}interface I {}public class X { <T extends I> void main(List<T> clazz, List<X> xList) { boolean b = clazz == xList || xList == clazz; }}***has been marked as a duplicate of this bug. ***	27.0
id=343060	REOPENED	JDT	Core	3.6.2	PC Windows XP	P3 major	Srikanth Sankaran	2011-04-17 06:29 EDT by	Bartosz Bankowski	2012-01-19 10:47 EST (	6 users	Build Identifier: 20110218-0911Given the following interfaces and classes:Interface.java:interface Interface<M, X> { void method(X x, M m);}Abstract.javaabstract class Abstract<X> implements Interface<String, X> { @Override public void method(X x, String string) { }}PublicAbstract.java:public abstract class PublicAbstract<X> implements Interface<String, X> { @Override public void method(X x, String string) { }}AbstractChild.java:public class AbstractChild extends Abstract<Integer> {}PublicAbstractChild:public class PublicAbstractChild extends PublicAbstract<Integer> {}And the program to test it (Main):import java.lang.reflect.Method;public class Main { public static void main(String[] args) { printMethods(PublicAbstractChild.class); printMethods(AbstractChild.class); } private static void printMethods(Class<?> clazz) { System.out.println("Methods for class: " + clazz.getName()); for (Method m : clazz.getMethods()) { if (m.getName().startsWith("method")) { System.out.println(m); } } } }When I have classes compiled by Eclipse the result is:Methods for class: PublicAbstractChildpublic void PublicAbstract.method(java.lang.Object,java.lang.String)public void PublicAbstract.method(java.lang.Object,java.lang.Object)Methods for class: AbstractChildpublic void AbstractChild.method(java.lang.Object,java.lang.String)public void Abstract.method(java.lang.Object,java.lang.Object)When I have classes compiled by Oracle JDK (tested on versions 1.6.0_24 and 1.6.0_20) the result is:Methods for class: PublicAbstractChildpublic void PublicAbstract.method(java.lang.Object,java.lang.String)public void PublicAbstract.method(java.lang.Object,java.lang.Object)Methods for class: AbstractChildpublic void Abstract.method(java.lang.Object,java.lang.String)public void Abstract.method(java.lang.Object,java.lang.Object)Results are different which causes major problems using reflection.Reproducible: AlwaysSteps to Reproduce:1. Take the code described in the details section.2. Compile it and run Main within Eclipse.3. Compile it with Oracle JDK 1.6.0_2x and run Main.4. Compare the results.	CreatedSources to reproduce the problemFrom a quick look at the compiled byte code:Eclipse indeed generates an extra bridge method into AbstractChild: public bridge synthetic void method(Object arg1, String arg2)This method is unnecessary, because it has the same signature as theinherited method and it does nothing but delegate (no cast involved).I haven't seen a paragraph in the spec that defines when bridges must(not) be created. So maybe the bytecode is legal, but maybe we shouldstill try to avoid creating such unnecessary bridge methods?Will consider a fix for this in 3.8 M4See eclipse bugandrelated sun bugs.Need to see why those considerations don't kick in for javac in this testcase. In particular, need to construct a test case similar to the oneinusingtest case to see if the IllegalAccessException shows up.(In reply to)Duh. Eclipse compiler misses the nuance that such a bridge would need to beintroduced only when inheriting public methods introduced by non public classes from a named package. Patch will follow shortly.Simpler test case that can be cut & pasted into package explorer:import java.lang.reflect.Method;interface Interface<M, T> { void method(T x, M m);}abstract class Abstract<T> implements Interface<String, T> { @Override public void method(T x, String string) { }}public class X extends Abstract<Integer> { public static void main(String[] args) { printMethods(X.class); } private static void printMethods(Class<?> clazz) { System.out.println("Methods for class: " + clazz.getName()); for (Method m : clazz.getMethods()) { if (m.getName().startsWith("method")) { System.out.println(m); } } }}Turns out the regression tests added forare actuallytesting the current scenario (i.e default package) I need to writejunits for that bug now :)Released fix and tests in 3.8 stream via commit id : f966b547afe1ce6e5e600680e6f3625db1aa756f.Ayush, this also needs to be backported to 3.7.2after a bit more testing as this is a regressionin 3.7 relative to 3.6.Released in 3.7 maintenance via commit cc817186788a86e60b58427a9b7e989e5093af0aVerified for 3.8M4 using build I20111202-0800.Released in 362+java7 branch via commit b317a1f8cb626a10310b9e4d19e0361f15b998dajavac is behaving the same if the package is default or not. With this patch, Eclipse is behaving similar to javac if the package is default and not otherwise. I believe there could be more to the observations in.(In reply to)Not sure I understand, can you post a test case that shows materialdifference ? Thanks.Run the following test with both javac and Eclipse. They differ in the output.This is the simpler test case in, put in a package. ######package pkg1;import java.lang.reflect.Method;interface Interface<M, T> { void method(T x, M m);}abstract class Abstract<T> implements Interface<String, T> { @Override public void method(T x, String string) { }}public class X extends Abstract<Integer> { public static void main(String[] args) { printMethods(X.class); } private static void printMethods(Class<?> clazz) { System.out.println("Methods for class: " + clazz.getName()); for (Method m : clazz.getMethods()) { if (m.getName().startsWith("method")) { System.out.println(m); } } }}########Some more update:I don't think javac differs depends on the defaultness of the package. I think there is an issue with javac itself whenever type parameters are used.For eg: Use this testcase in a default package######class AbstractY { public void method() {}}public class Y extends AbstractY { public static void main(String[] args) { printMethods(Y.class); } private static void printMethods(Class<?> clazz) { System.out.println("Methods for class: " + clazz.getName()); for (Method m : clazz.getMethods()) { if (m.getName().startsWith("method")) { System.out.println(m); } } }}########Run with javac and ecj. ecj prints AbstractY.method(), but javac prints Y.method(). I will do some investigations and update.(In reply to)Thanks, if this isn't a regression relative to 3.7.1, please opena follow up defect.I verified that the scenario specified inis nota regression. i.e for the default package case, we now conformwith java7. For the named package case we differ from javac7,but not from 3.7.1 (i.e there is no regression).(In reply to)I agree there could be more here. Bridge method generation is not specifiedin JLS and so there are some differences historically that we are tryingto bridge ;-)The defaultness came into picture from following the reasoningfor java.lang.IllegalAccessException discussed inIf the concerned public method belongs to a package defaulttype but that package happens to be the default package, the visibility barrier goes away and so there is no need for a bridge.So I think the current fix is actually correct, but your testinghas uncovered some more nuances where we differ.(In reply to)You may also want to see if the abstractness or not of the superclass hasany bearing.(In reply to)I am not sure about this. Please look at the test case in. javac and Eclipse 3.7.1 are similar for this test case but there is a change in 3.7.2.(In reply to)This doesn't have any bearing.(In reply to)There _is_ a change in behavior for this test case, but I don't think it is a regression, it is a progression.I think what it is showing is that there is many inconsistencies in javac'sbridge generation algorithm and it is nowhere nearly as straightforward asas the statement "Specifically, we would generate a bridge method when a public methodis inherited from a nonpublic class into a public class." in(In reply to)I meant to say if this isn't a regression relative to 3.7 and/or 3.7.1.I think the problem is with substitution of the type parameter that the methodtakes causes the problem.###abstract class AbstractY<T> { public void method(T a) {}}public class Y extends AbstractY<String> {}####javac breaks or differs in this condition. Note that the parameter that themethod 'method' takes is substituted by it's subclass. I still don't understandcompletely but in my opinion ECJ3.7.1 behaviour is correct.(In reply to)I agree that this is the right thing to do, but with this bug fix, there is a change in behaviour for classes in default package. I don't think that is right. As I understand from 6342411, a bridge method is being added so that things work fine with reflection. So, the defaultness of the package should not cause change in behaviour.It could be either way depending upon what is the expected behaviour. What should be the behaviour of the testcase in? Should the bridge method be generated or not? BTW, this bug fix breaks (I believe it breaks and not differs) the test in. Hence, this may be a regression.(In reply to)On thinking more about this, I think I understand what Satyamis trying to say: I have been guilty of muddled thinking intreating default package as though it were a globally accessiblepackage and claiming per earlier that the visibility barrier goesaway and so there is no need for a bridge...Satyam, thanks for persisting and for putting together a test casethat will show that this package barrier does exist between defaultand named packages that can be used a test case when we work onthis further.I think we should back put this fix for 3.7.2 and restore status quoas of 3.7.1 and continue future work only for 3.8.x streams.Createdzip of the projectProject to show that the current behavior is wrong. Run <default>.Y in this project.Talked to Srikanth. I agree that this is the best thing to do at this point.(In reply to)We will shortly restore the behavior to what it was at 3.8M3/3.7.1/3.6.2time for the respective streams by backing out the "fix", which fortunatelyis very small (only two lines of code change not counting tests.)Apologies for the confusion. Satyam, once again thanks for insistence/persistence in the face of my inclination to dismiss it rather readily.Reverted from 3.7 maintenance branch via commit 52ffa6a622336b1154708c0ba10ecff9e5941c7fPushing revert into 3.6.2+java7 branch fails with Can't connect to any repository: ssh:///gitroot/jdt/eclipse.jdt.core.git (An internal Exception occurred during push: ssh:///gitroot/jdt/eclipse.jdt.core.git: Short read of block.)Weird. :\Reverted in 3.6.2+java7 branch via commit 6ddf29924a61a973ae1bd8add4af0942f5b5d8fbReverted in master via commit 99e06cdf0656ed0f6c3eb604300a8baae7ee3beb	31.0
id=366007	REOPENED	JDT	UI	3.8	All All	P3 enhancement	Stephan Herrmann	2011-12-08 06:45 EST by	Stephan Herrmann	2016-01-24 14:42 EST (	3 users	When using @NonNullByDefault for only some parts of the code, it is nottrivial to see what the effective specification of any given method is.Any parameter without a null annotation could either be affected by thedefault or be unspecified if outside the scope of the default.It would be great if the UI could somehow visualize the "effective"specification, i.e., after applying any defaults.I suggested to do this in the hover. @Markus: when we discussed this I remember you mentionedand seeing this resolved is great. But I don't remember if we came toa conclusion regarding the "effective" specification from a default.Let me know if JDT/Core should surface the implicit annotations ineither model or DOM.	I just stumbled upon a project that seems to subclass SourceViewerDecorationSupport for a similar purpose: drawing overlays that indicate results of some semantic inference right in the editor.Having a little "!" (nonnull) or "?" (nullable) superscript on type references would be really cool :)Yet I assume, printing something into the (javadoc) hover is probably much more straight-forward.Marking as duplicate, because the proposed solution in the other bug already covers this request, too.*** This bug has been marked as a duplicate of***While indeedsignificantly improves the situation, it doesn't yet help for declaration annotations.The existing solution can be extended for "old" null annotations by:JDT/Core:(1) letting MethodBinding (DOM) materialize implicit null annotations into IAnnotationBindings (the compiler binding has all information we need)JDT/UI:(2) prepending a null annotation to the binding label.I tried to implement (1) restricted to certain call graphs (e.g., only clients of ASTParser.createBindings()), but found that this is likely to create inconsistencies, rather than improve anything.Change (2) is needed because declaration annotations on the method are still discovered only via the IJavaElement (only the label / signature is driven by bindings). I think rendering a @NonNull/@Nullable on a method as part of the signature improves usability anyway.These two changes improve the user experience regarding all of: - @NonNullByDefault - external annotations - inherited annotations (if that option is enabled)making the recent achievements regarding TYPE_USE annotations available also for declaration annotations.New Gerrit change created:CreatedUI part concerning part (2)(In reply to Eclipse Genie from)The gerrit change contains the Core part regarding (1).The UI part for (2) has a new test which cannot succeed without the Core part, hence I'm attaching this as patch.(In reply to Stephan Herrmann from)I've uploaded an extended version that considers the fact that implicit null annotations are initialized on demand.This part remains unchanged (see).Sorry for the delay. I have reviewed the JDT Core part and looks good to me.This will not qualify for an RC2 rebuild. Moving to RC3 but this might be moved out of 4.5.Sorry, I think it's too late for adding this feature. Furthermore, I have some reservations against the changes:The IMethodBinding#getParameterAnnotations(int) and IBinding#getAnnotations() APIs clearly specify that they only return declaration annotations that are specified on the given element. Returning implict null-related type annotations violates those specifications.In the UI, I think the implicit annotations should look a bit different from annotation that are actually declared on the element.(In reply to Markus Keller from)This seems to leave us with two options:(1) add new API, s.t. like IMethodBinding#getImplicitParameterAnnotations(int) and IBinding#getImplicitAnnotations(), or(2) tell users that support for declaration null annotations is in maintenance mode, no new features will be added here.Any preferences?no further action planned, atm.	11.0
id=340506	REOPENED	JDT	Core	3.7	PC Windows 7	P3 normal	Stephan Herrmann	2011-03-20 06:15 EDT by	Lukas Eder	2015-06-04 09:58 EDT (	8 users	Build Identifier: 20100917-0705This is a very tricky issue related to choosing the most specific method on method invocation, when generic type arguments are involved.Essentially, when overloading methods like this: public <T> void setValue(Parameter<T> parameter, T value) { } public <T> void setValue(Parameter<T> parameter, Field<T> value) { }And calling those methods like this: Parameter<Object> p = null; Field<Object> f = null; setValue(p, f);We *should* get a compilation error telling us that the method invocation is ambiguous.Read my full report (and the accepted answer) on stackoverflow:Reproducible: AlwaysSteps to Reproduce:1. Compile this class with Eclipse, works-----------------------------------------public class Test { public <T> void setValue(Parameter<T> parameter, T value) { System.out.println("Object"); } public <T> void setValue(Parameter<T> parameter, Field<T> value) { System.out.println("Field"); } public static void main(String[] args) { new Test().test(); } private void test() { Parameter<String> p1 = p1(); Field<String> f1 = f1(); setValue(p1, f1); Parameter<Object> p2 = p2(); Field<Object> f2 = f2(); setValue(p2, f2); } private Field<String> f1() { Field<String> f1 = null; return f1; } private Parameter<String> p1() { Parameter<String> p1 = null; return p1; } private Parameter<Object> p2() { Parameter<Object> p2 = null; return p2; } private Field<Object> f2() { Field<Object> f2 = null; return f2; }}interface Field<T> {}interface Parameter <T> {}2. Compile that class with javac, doesn't work----------------------------------------------	CreatedA test file containing an ambiguous method invocationEven worse, I can pass null as the second argument of the overloaded setValue() method. I.e: setValue(p1, null); setValue(p2, null);Here, clearly, there should be ambiguity indicated by the compilerEclipse behavior hasn't changed here since at least 3.4.I agree the difference in behavior needs to be looked intoand understood and fixed if needed. Unfortunately, I don'texpect to get to this any time soon.For the time being retargetting this to 3.7.If we want to address it for 3.7, it has to be done for RC1.Didn't have time to look into this yet as most ofthe cycles in the last few months went into Java 7work. Postponed to 3.8There is a similar issue reported in.The accepted answer at the reference stackoverflow concluded the second method is *not* more specific than the first because Field<V> <: V does not hold, mentioning that "V is not Object in this analysis; the analysis considers all possible values of V."However, in JLS 15.12.2.5 I find the subtype requirement to be Tj <: Sjwhere Sj is a type *after* type argument inference: let A1 ... Ap be the type arguments inferred (§15.12.2.7) for this invocation under the initial constraints Ti << Ui (1 ≤ i ≤ n), and let Si = Ui[R1=A1,...,Rp=Ap] (1 ≤ i ≤ n).So my first judgement is: the invocation where V = Object must indeed be considered, so JDT would we correct, and javac wrong.From the accepted answer at stackoverflow:I don't see this in the spec. By contrast I see let Si = Ui[R1=A1,...,Rp=Ap] (1 ≤ i ≤ n)It seems the JLS itself is inconsistent between the "informal intuition" (speaking of *any invocation*) and the formal details (saying *this invocation*).(In reply to)I don't see a connection as the Sun/Oracle bug talks about finding a substitution for a type parameter, not about overloading.From these initial findings I lean towards closing as INVALID.Any comments?Thanks for the analysis Stephan.Here Ti and Ui are method parameter types, not invocation argument types.The meaning of "for this invocation" is unclear; if we interpret it as that the initial constraints Ei << Ui should also be included, where Ei is the type of invocation argument ei, then we need to solve Ei << Ui Ti << Uiwhich will usually yield two conflicting results for each type variable Rl.Suppose the inference process favors results from Ei<<Ui, then the mentioning of Ti<<Ui is apparently pointless in the first place.Next, the spec requires For all j from 1 to n, Tj <: Sj. for this example <V> void setValue(Parameter<V> parameter, Field<V> value) <R> void setValue(Parameter<R> parameter, R value) if we infer, from Ei<<Ui, that R=Object, we need to check Parameter<V> <: Parameter<Object> Field<V> <: Objectthe 1st subtype relation is false, therefore "more specific" is still false.Zhong Yu,thanks for your comment, this is much more substantial than what was discussed so far.(In reply to)I'd actually say it a bit stronger: this sentence looks plain inconsistent to me. §15.12.2.7 speaks about "Inferring Type Arguments Based on Actual Arguments " but in 15.12.2.5 that rule seems to be abused to infer type arguments based on another method *declaration* and its formal parameters. If the mentioning of "Ti << Ui" is correct then saying "invocation" is wrong.I admit I believed the "invocation" part more than the "Ti << Ui" part, which may be different from what the JLS authors intended.I agree, considering both these constraints gets us nowhere.I see, comparing two signatures where one has substituted type parameters while the other has not, will not yield the expected compatibility.Looking at the code the JDT compiler essentially compares these: void setValue(Parameter<Object> parameter, Field<Object> value) void setValue(Parameter<Object> parameter, Object value)i.e., we work on the basis of substitutions for both methods.I've a simple patch under test that changes the JDT compiler to comparing the method declarations disregarding the current invocation. The naive way of fixing this, however, breaks the fixes forandI'm willing to reopen the bug if we agree to realize the semantics based on the constraints "Ti << Ui" while deliberately ignoring the mentioning of an invocation and how 15.12.2.7 is inconsistently used without any actual arguments.However, if we change the compiler ...(a) we need to find how to do this without breakingand(b) we will reject more programs where intuition would see no problem(In reply to)The change regardingseems acceptable: first we report a name clash, and afterwards it is disputable if those erroneous methods should be considered as overloads, or whether secondary errors should be suppressed.Createdtest & possible fix*Assuming* ... "... we agree to realize the semantics based on the constraints "Ti << Ui" while deliberately ignoring the mentioning of an invocation and how 15.12.2.7 is inconsistently used without any actual arguments"... then this patch seems to fix the issue.Note, however, that there is a very fine line between fixing this issue and breaking. The patch distinguishes both situations be looking for the presence of a wildcard, if one is found the substituted parameters must be used, otherwise go back to the originals.This distinction is more based on experimentation than on findings from the JLS and needs further validation.Unfortunately this part of the implementation is structured differently than the JLS (see comment above Scope#mostSpecificMethodBinding).Reopening to allow for consideration offf.Hi Stephan, my understanding is that if wildcards are involved, capture conversion should be applied first to remove the wildcards. 15.12.2.7:(if A<<F) If F has the form G<...> ... then if A has a supertype of the form G<...>...now if A has wildcards, to find super types of A:4.10.2 : The direct supertypes of the type C<R1,...,Rn> , where at least one of the Ri, 1in, is a wildcard type argument, are the direct supertypes of C<X1,...,Xn>, where C<X1,...,Xn> is the result of applying capture conversion (§5.1.10) to C<R1,...,Rn>.For example ArrayList<? super A> << List<T>apply capture conversion to ArrayList<? super A>, we get ArrayList<x>, where A <: x <: Objectit has a super type List<x>, therefore T = xinference succeeds.It is odd if the inference result contains a free/unknown type variable. Usually A in A<<F does not contain wildcards, because the type of a method argument has undergone capture conversion first even before 15.12 starts. Unfortunately I cannot back that up with words in the spec, however I believe it is intended that, the type of any expression must undergo capture conversion before evaluating its enclosing expression. List<?> list = ...; foo(list); // the type of `list` here is List<x> where x<:Objectit makes sense because `list` indeed is a List<x> for some concrete but unknown type x (x would be knowable if there's no erasure); narrowing down the type of `list` from List<?> to List<x> increases type information.With the same principle, I think 15.12.2.5 would be better if it says If the second method is generic ... inferred under the initial constraints T'i << Ui, where T'i is the result of applying capture conversion on Ti, ...although in its current form it happens to work too, thank to 4.10.2.Update: at 1.8 ecj also reports an error:----------1. ERROR in /tmp/Test.java (at line 21) setValue(p2, f2); ^^^^^^^^The method setValue(Parameter<Object>, Object) is ambiguous for the type Test----------This can be taken as a hint that the same was also intended for 1.7-.	16.0
id=79930	REOPENED	Platform	SWT	3.7	PC Mac OS X	P3 normal	Project Inbox	2004-12-01 16:37 EST by	Grant Gayed	2011-03-29 10:24 EDT (	1 user	- run the ControlExample, pick any control page other than Button, Slider, ToolBar- listen for MouseDown and MenuDetect- right-click on the example widget on the page -> on osx you'll get MenuDetect - MouseDown, but these should be MouseDown - MenuDetect- the order comes in correctly for Button, Slider and ToolBar	Grant to prioritize.Please check this one in the latest.This behaviour hasn't changed in HEAD.Moving report to triage, seefor more info about bug handling.Works fine in Cocoa, so we won't be addressing this.Reopening and updating the platform/version, I see this in the latest Cocoa in the ControlExample, including on the controls that were previously indicated as working on Carbon. Perhaps this has been recently broken. I'm using OSX 10.5.8.	6.0
id=507716	REOPENED	JDT	Core	4.7	All All	P3 normal	Stephan Herrmann	2016-11-17 17:49 EST by	Stephan Herrmann	2017-02-16 01:34 EST (	4 users	Follow-up fromThe workaround from(explicit lambda param) was broken since the fix for.Analysis (ff) revealed that inside copied lambdas we create fresh inference variables, which duplicate existing inference variables of the same purpose. Due to lack of relationship between duplicates, tiny changes in the inference process could produce unresolvable constraint sets.I'm working on a revamped strategy for ivar creation that fixes this.	New Gerrit change created:(In reply to Eclipse Genie from)Contained in this change:- interning for inference variables per CompilationUnitScope- remove old insufficient interning- remove tweaks that updated source names when IC18's where merged to ensure unique names (for debugging)- consistently avoid "this.site == that.site" to be safe against lambda copying- disable ErrorTests.test0105 to avoidInterning does not work below LambdaExpression.findGroundTargetType() (since we don't have an InvocationSite) - the mechanism should perhaps be generalized to work with (InvocationSite|LambdaExpression).Inwe discussed inclusion in 4.6.2 RC3. The current change is perhaps a bit larger than usual for RC3, so I won't fight for it, but:- a clear impl bug has been identified (no reading between the lines of JLS)- everything relating to InferenceVariable#sourceName is for debugging only- I hope the change is well amenable to standard code review, no black magic or rocket science.Gerrit changewas merged to [master].Commit:(In reply to Eclipse Genie from)Released for 4.7M4Verified for 4.7 M4 using I20161205-2000 buildReopening for 4.6.3 [RC3?](In reply to Manoj Palat from)For RC3 will require PMC approval as well - will flag once we have the two reviews in	7.0
id=284712	REOPENED	Platform	SWT	3.5	PC Windows Server 2003	P3 normal	Project Inbox	2009-07-27 06:28 EDT by	Dawid Weiss	2011-04-13 09:48 EDT (	5 users	CreatedA snippet demonstrating the bug.Short introduction:We use SWT's Browser component with embedded Flash. Bidirectional communication between Java and Flash is possible by registering ExternalInterface methods from Flash (JavaScript) and invoking these methods from Java using Browser's execute or evaluate methods.The problem:Everything works fine for the first instance of the Browser component. Subsequent instances load Flash fine, but the registered methods are no longer present in JavaScript (or in the browser's DOM model for that matter). Applicable to:Internet Explorer ONLY (using SWT.MOZILLA with embedded XULRunner works fine).Attachment:I attach a simple snippet demonstrating the problem. It connects to our server to download the flash application and jquery -- it would inflate the example greatly to run an embedded HTTP server from it, so I hope it's o.k.	I have observed that this happens only on computer running the latest version of Internet explorer 8. Also if i query the browser version using javascript. It is reported as IE7.CreatedUpdated test/bug snippetThis seems to be fixed with SWT 3.6.2, I can't reproduce the problem.Great! Closing report.Hi,I use richfaces, <rich:fileupload> component in my application. The same problem still exists even though if swt 3.6.2 is been use.reopeningCan you provide a code snippet that shows that this bug is still present? Maybe it's something else that looks similar? I couldn't reproduce it on 3.6.2.Hi,As below.Currently encountering one problem, i using the richfaces fileupload, setting the allowFlash="true" which allow batch upload.Notice that a fileuploadComponent.swf.jsf_[1].swf will be cache to the temporary internet files when the page is loaded. Everything works fine for the first time, the subsequent time, the "Add" button is disabled.If i delete the fileuploadComponent.swf.jsf_[1].swf and refresh the page again, the add button will be enabled and the fileuploadComponent.swf.jsf_[1].swf will be created again.Note that if i run my application using a browser(e.g. IE or firefox) without using SWT's Browser, it work fine.Codes for richfaces. <rich:fileUpload id="upload" fileUploadListener="#{fileBean.listener}" maxFilesQuantity="20" immediateUpload="false" acceptedTypes="gif" allowFlash="true" noDuplicate="true" validator="#{fileBean.validateUpload}">Thanks and Regards	8.0
id=509324	REOPENED	JDT	Core	4.6	PC Linux	P3 normal	Stephan Herrmann	2016-12-15 16:56 EST by	Kris De Volder	2017-02-16 01:34 EST (	4 users	Createdsample maven projectGot some code that - compiles fine in neon 1 - has a compile error in neon 2 - compiles fine with javac / maven on commandline - compiles fine in oxygen (I didn't try but one of my coleagues did)Wasn't totally sure if we should report this. Since maybe its already fixed in oxygen. But since neon.2 isn't even released yet and this seems to be a problem actually introduced in neon.2...Anyhoo I'l leave it to the experts to decide if this can / should still be fixed in Neon. To reproduce: import attached maven project in neon.2You will get a compile error like this:Description Resource Path Location TypeType mismatch: cannot convert from Object to TestGenerics.SshHost TestGenerics.java /neon-2-compilation-problem/src/main/java/testgenerics line 32 Java Problem	(In reply to Kris De Volder from)reproducedreproduced with javac version 1.8 and 9 (ea)accepted in 4.7M1 & 4.7M2, rejected since 4.7M3unfortunately not.neon.2 is in "quiet week". No more code changes unless to prevent severe damage.This is going to be difficult: the change is caused by the fix for, which was part of a cluster includingby the same reporter. Hi, Kris :)Difficult also, because that cluster of fixes deliberately moves our implementation away from JLS, to leverage advice from javac developers. I.e., all this was done to make ecj more similar to javac, despite JLS saying differently. If this breaks congruence with javac in other cases we will have to request more information about how javac is implemented, not sure if this can possibly terminate ...Still after fixing another regression () the current bug can be reproduced.Self-contained repro://---package testgenerics;import java.time.Duration;import java.util.function.Function;import java.util.function.Supplier;interface Publisher<T> {}abstract class Mono<T> implements Publisher<T> { public static <T> Mono<T> just(T data) { return null; } public static <T> Mono<T> empty() { return null; } public final <R> Mono<R> then(Function<? super T, ? extends Mono<? extends R>> transformer) { return null; } public T block() { return null; } public final T block(Duration timeout) { return null; }}class Info { public String getApplicationSshEndpoint() { return null; }}class SshHost { public SshHost(String host, int port, String fingerPrint) { }}public class TestGenerics { private Mono<Info> info = Mono.just(new Info()); public static <T> T ru_get(Mono<T> mono) throws Exception { return mono.block(); } public SshHost getSshHost() throws Exception { return ru_get( info.then((i) -> { String host = i.getApplicationSshEndpoint(); if (host!=null) { return Mono.just(new SshHost(host, 0, host)); } return Mono.empty(); }) ); }}//---New Gerrit change created:(In reply to Eclipse Genie from)The problem occurred in code added via:In particular this interpolated rule: - if all these parameters are proper types we add ‹ei → Fi θ›did not have it's substitution (θ) defined. As a result a type variable was used in a type bound, where in fact the corresponding inference variable should be used. Wrongly checking against the proper type variable, the constraint reduced to FALSE.It turns out that we need to apply more unspec'ed magic, because we are combining stuff from different levels of inference (outer & inner).The change under test constructs enhanced substitutions that:- hold several invocationSites to check against- try harder to match two TypeVariableBindings (inner and outer may disagree in the degree of parameterization / original)If successful, we should consider the fix for 4.6.3, since it's a regression in 4.6.2.New Gerrit change created:(In reply to Eclipse Genie from)Ensure item (2) of the fix is only applied in this specific situation.(Previous change lacked a proper change id for amending :( ).Gerrit changewas merged to [master].Commit:(In reply to Eclipse Genie from)Released for 4.7 M6Re-opening for 4.6.3 (RC3?)(In reply to Manoj Palat from)For RC3 will require PMC approval as well - will flag once we have the two reviews in	12.0
id=366886	REOPENED	Platform	SWT	3.7	PC Windows 7	P3 normal	Project Inbox	2011-12-15 16:43 EST by	Patrick Chuong	2012-01-09 09:51 EST (	2 users	I have a 64bit app shortcut in the sendto folder, clicking this shortcut within the internal browser (IE) context menu doesn't work. The link in the menu points to c:\Program Files(x86) instead of C:\Program Files.I have a 64bit Win7 machine.Steps to reproduce1. Open the Internal Web Browser2. Set the url to a local folder (i.e file://C:/)2. Right click on a file and select a 64bit app to send this file to (i.e winzip)	The Browser control does not do anything to interfere with the native behavior of this scenario. Does this work for you in stand-alone IE with the same bitness (meaning, if you're running 64-bit eclipse then try this in 64-bit IE, not 32-bit IE)?I wasn't able to reproduce this issue with other 64-bit app on either 32-bit eclipse or 64-bit eclipse. I am using 64-bit winrar, I guess it is winrar that is having problem. I have close the bug.New update:I downloaded notepad2 (64bit) and put it within c:/Program Files/ folder and create a link to the sendto shutcut.I am able to send a txt file to notdpa2 for a 64bit eclipse, but not a 32bit eclipse.I am not able to enter file://c:/mydir URL within IE to see the embedded File Explorer, instead it opens an external File Explorer. I am not sure whether this is an IE issue or eclipse issue. I have reopening this bug.	3.0
id=309660	REOPENED	Platform	SWT	3.6	Macintosh Mac OS X	P3 normal	Project Inbox	2010-04-19 08:10 EDT by	Daoen Pan	2011-10-07 13:54 EDT (	7 users	Build Identifier: I20100312-1448i do like the dark color theme for text based editors. but the black I-Beam cursor in dark background is really annoying. Eclipse can not change the color of the cursor.Reproducible: Always	CreatedMy first patch to implement the featuretwo screenshot for the resultThe OS automatically chooses the color depending on the current background on the fly, that's how it's done in all text widgets. One static color is not enough because you can have many different backgrounds.(In reply to)This did not happen for StyledText based editor such as text and java editor, on at least Windows and MaOSX. My cursor is always black.Can you attach a screenshot? There was a bug on the Mac but that got fixed for 3.5.1.(In reply to)as you see, the cursor is really hard to see.i habe try this with 3.5 and 3.6 on macosx-cocoa 10.6 and windows 7.Indeed. Which OS? Could you export all your preferences and attach them here?Also, can you provide a picture that also shows the caret in the text.Createdmy full preference(In reply to)MacOSX 10.6 and Windows 7. the color of caret is OK.CreatedLooks good on Windows XPAh, my mistake, it looks also good on Windows 7. only cocoa not good.OK. Are you sure that you are using latest 3.6 or 3.5.1 or 3.5.2 build?Looks similar to.(In reply to)Yes, i am sure with my eclipse version.This bug is only on cocoa, right ?Createdsecond patch with bugfixCreatedthird patch with bugfixCreatedthird patch with bugfixIs this no longer an SWT bug? Looks like it's being addressed in the text editor.Yes it is an SWT bug: the caret should be white on black/dark background (seefor a similar problem in the past).The initial request was to workaround this but Text is not adding a preference for that, see.***has been marked as a duplicate of this bug. ***Based on testing I did this morning, this issue is present in following Eclipse versions:Version: 3.5.2Build id: M20100211-1343Version: 3.6.0Build id: I20100513-1500***has been marked as a duplicate of this bug. ***	22.0
id=314181	REOPENED	Platform	SWT	4.0	PC Windows XP	P3 major	Project Inbox	2010-05-24 21:24 EDT by	Paul Johnson	2010-06-21 06:13 EDT (	1 user	Build Identifier: M20100211-1343I'm developing a plugin for eclipse that relies on the SWT Xulrunner browser for windows xp. To test the plugin i've been using the PDT and running a copy of eclipse from within eclipse.The browser will load a page, but after scrolling or doing some stuff with jquery it crashes with the following error:## A fatal error has been detected by the Java Runtime Environment:## EXCEPTION_ACCESS_VIOLATION (0xc0000005) at pc=0x0510cdc2, pid=2376, tid=3000## JRE version: 6.0_18-b07# Java VM: Java HotSpot(TM) Client VM (16.0-b13 mixed mode, sharing windows-x86 )# Problematic frame:# C [xul.dll+0x4bcdc2]## An error report file with more information is saved as:# H:\eclipse\hs_err_pid2376.log## If you would like to submit a bug report, please visit:## The crash happened outside the Java Virtual Machine in native code.# See problematic frame for where to report the bug.#I've tried using different xulrunners including 1.9.2 and 1.8.0.9 through starting the eclipse copy using -Dorg.eclipse.swt.browser.XULRunnerPath , but they all seem to give the same error. Xulrunner 1.9.3a5 seems to work, but the <canvas> element no longer works which is needed by my project.Reproducible: Always	Createderror logError Log from eclipsethats the source of my projectOops... sorry, it appears to be working now, I think this was caused by the Windows XP firewall blocking XPCOM.Sorry for the trouble.Okay, I was wrong it's still broken with the same problemThe error logs look like the Browser is being disposed. I assume you meant that the crash happens at dispose time, after scrolling/doing stuff?Is it possible to provide just a page (along with its accompanying jquery libs, etc.) that can be navigated to in Eclipse's Internal Web Browser view to show the problem? Having a small case would make investigating this much easier.Also, can you verify that it still happens in a recent eclipse 3.6 build like?	5.0
id=300587	REOPENED	Platform	SWT	3.5.1	PC Windows XP	P3 normal	Project Inbox	2010-01-22 19:26 EST by	Doug M	2010-03-30 14:41 EDT (	3 users	Build Identifier: swt-3.5.1-win32-win32-x86When typing at the right end of a single-line Text (implemented as Edit Control), Windows scrolls the text left to keep caret in view. If the Text is resized to show the full content, it remains scrolled with the start of the text invisible.This problem is specifically identified in Text.setBounds. The author writes a fix that I believe is supposed to be triggered by testing whether the text width is greater than the control width. However, the control's width is actually compared to the control's margins alone (as in its trim), without adding in the text width. Therefore the fix is not done when it is needed and part of the text remains cut off.Reproducible: AlwaysSteps to Reproduce:See attached demo TextResize.java.A workaround for my particular application is after resizing, to detect that the caret is at the right edge, and then send the caret to the beginning and back to the end. This is demonstrated in the example. But it won't work in general since the shift may occur when the caret is not at the far right.Solutions I have tried that did not work:1) Turning off horizontal autoscroll. * int bits = OS.GetWindowLong (handle, OS.GWL_STYLE); * bits &= ~OS.ES_AUTOHSCROLL; * OS.SetWindowLong (handle, OS.GWL_STYLE, bits);The shifting of the caret into view must be unrelated to autoscroll.2) Sending the message that * is supposed to scroll Edit Controls. Although as usual, MS documentation * is vague about whether this works with single-line controls. * In any case, it also does not work. * OS.SendMessage(handle, OS.EM_LINESCROLL, 2, 2);//-2,-2 also fails3) Creating the Text with SWT.RIGHT. It does stop the scrolling, but introduces a severe flicker, with redraw errors.(sorry - another bug.)	CreatedDemo of bugI can reproduce this with a simple SWT snippet.As mentioned in, there is code(& comments) in Text.setBounds to workaround this windows bug, but the fix is not called when it is required.*** This bug has been marked as a duplicate of***The problem with Combo was similar but not the same. Reopening.	4.0
id=483865	REOPENED	Platform	UI	4.6	All All	P3 enhancement	Stefan Xenos	2015-12-08 02:56 EST by	Lars Vogel	2016-03-23 13:07 EDT (	9 users	+++ This bug was initially created as a clone of+++JFaceResources.initializeDefaultImages(), which currently perform a lookup using a FileLocator.find(Bundle) first and then fallback to a createFromFile operation instead, should use the new approach from.	Sergey grant fixed this as part of his patch to.Reopened sincewas reverted.Mass move to M6	3.0
id=335792	REOPENED	Platform	UI	4.1	PC Windows XP	P3 normal	Stefan Xenos	2011-01-30 13:13 EST by	Simon Clarkson	2017-02-23 07:11 EST (	18 users	Build Identifier: Usually frameworks such as the Eclipse data binding use generics. By specifying the type parameters we have type safety and a lot cleaner code.Currently everything is coming back from data binding as an Object. The only way those objects are usable is to cast them. If they are being cast to a type that is itself parameterized then the situation is even worse, requiring as to wrap every observable in a typed observable.Obviously data binding is not ready for prime-time until generics are added. We can't get any code that uses generics to be type safe, we can't get it past a code review from any other team.I have heard that there is some company somewhere that wants to use generics with Java 1.3. In all my years experience, I just cannot imagine such a company. There is no reason to stay on Java 1.3 unless the code development is completely dead, and such a project would never be using generics. I am now working at my second company that can't use data binding because of data binding's insistence that everything is typed as Object.There is talk here that we need to fork the data binding code to a repository outside Eclipse and add generics to that. I have been in touch with the previous company for which I worked and they too would be interested in such a fork. However before starting such a fork I want to be sure that I have not been misinformed that generics can't be added quickly to the eclipse.org repository.Reproducible: AlwaysSteps to Reproduce:1. use data binding2. have to cast every object to its correct type which includes type un-safe casts3. the result is messy unreadable code and no type safety	Generics can be added without loosing pre 1.5 support because from a bytecode level this is no problem. Equinox is doing this in 3.7.The problem was/has been until now that nobody had the time/resource make this big investment. I often tried to raise funds for work on JFace, ... but because nobody ever did I left 3.x. If you'd ask me and you want Eclipse Databinding to be Generics aware I'd say you should do this at Eclipse.Tom, how do you think that it would be possible to introduce generics to the databinding framework? Even if the bytecode is backward compatible, would it be possible (from Eclipse's API point-of-view) to introduce generics on the existing plugins or would we have to fork them and maintain two versions of the plugins? Of course, it would be great to have generics for databinding (and Eclipse in general...).(In reply to)Yes because it is not breaking any backwards compability. Just like your Java 1.4 code magically still worked even that the JDK introduced generics e.g. in List, ... . Naturally we'll have to do it correct. As said Equinox did that in 3.7.No need for a fork. Java Generics are defined in a way that you are not break source or binary compability.(In reply to)I'll try to come up with a starting example but as outlined in my first reply to Simon I'm not able to be the primary driver for this because I'm not having enough unpayed spare time to work on it beside that it is too late for 3.7 because M6 is in about 6 weeks.My understanding is that code using generics can be built byte-code compatible with 1.4 but not 1.3, so if the project lead is willing to drop Java 1.3 support in data binding for Eclipse 3.8 then there is no reason to fork.I can wait for Tom's starting example or if he does not have time then I would be very pleased to put together a patch to start this process for Eclipse 3.8. The most useful areas for me would be:1. WriteableValue, WritableList, WritableMap, WritableSet2. ComputedValue, ComputedList, ComputedSetHowever I suspect, from my experience adding generics to other projects, that it will really end up being an all or nothing change. Once one starts adding generics it is hard to stop.One area that is not clear to me is when dealing with observables provided by BeansObservables and PojoObservables. In order to do this in a type-safe manner the calls will require the class to be passed. BeansObservables.observeValue, for example, will need an extra parameter being the class. That will work if the bean property is of a type that is not parameterized. If the bean property is parameterized then we will not be able to use reflection but must instead provide method implementations to get and set. For example, consider the bean:class Bean { List<String> getFoo(); void setFoo(List<String>);}Something like:BeansObservables.observeList(myBean, "foo", new ListProperty<Bean, String>() { @Override getList(Bean bean) { return bean.getFoo(); } @Override void setList(Bean bean, List<String> value) { bean.setFoo(value); }}I haven't looked at the code in a while so I don't know exactly how this fits in but the gist is that property accessors would need to be written for each property instead of using reflection. I think this can be added to the IValueProperty, IListProperty etc implementations.It would also be useful if problem areas can be identified.(In reply to)Correct.Don't wait for me to act - I've plenty of other things I'm currently heavily invested!I think we need to have an all or nothing!BeanObservable and PojoObservable is deprecated - we should concentrate on the Properties-API.Createdpatch to add generics to o.e.core.databinding.observablesWell, here is my initial attempt. I started with o.e.core.databinding.observable.Follows the usual pattern, use types only when needed but allow Objects when type restrictions are not strictly necessary. For type names I have followed the pattern in the Java collections. I have also used <M> for the type of the master record in master-detail classes and <I> for the type of the intermediate keys/values in CompositeMap.This work did show one bug which I have reported as.The static helper methods to create empty observable lists and sets cannot return a typed collection. They are parameterized with <Object>. This ensures backward compatability and users can call the constructor directly if they need it to be parameterized.BidiObservableMap. This contained a map that mapped either value (type V) to a key (type K) or to a set of keys (type Set<K>). In order to keep the typing clean I created two maps, one contains the value if a single key and the other map contains the value if a set of keys. The alternative would have been to always create a set of keys even when there is only one key. I decided not to do that because that would be less efficient in the majority of cases where there is only one key, and I assume it was for efficiency that a set of keys was not created everytime when this code was originally written. The other alternative would be a map from V to a class that contains two fields, a K and a Set<K>. That would avoid two map lookups. However on the assumption that most values will have only a single key there are two lookups only in a minority of cases (if an entry is found in the map to keys then we don't bother to look in the map to sets of keys).addMapping seems to accept a set as a key. Not sure why, and I think the code was broken if the keys happened to be a sets themselves (not likely, I know). This is a private method and sets of keys are never passed so I just removed that code.UnionSet used an array for the child sets which I changed to a HashSet. This was done because arraYS of parameterized types are not allowed.toArray in IdentitySet, IdentityMap etc were changed a bit. These are not type safe and I don't think it is possible to implement these methods in a type-safe manner which is a shame.I am concerned at how this is going to be committed because 1. It is a lot of code for a committer to review and could take longer to review that it took to make the changes. So a committer is really just going to have to trust that there have not been code changes except in the areas identified by me above. I would also be concerned if this did not get committed reasonably quickly because there could otherwise be a lot of merging to do. Another issue is that I believe we are too late for 3.7 which means this needs to go into 3.8 code. I don't know if 3.8 has been forked yet from the 3.7 builds. These changes are based on the copy in git.The listeners and diffs have not been done. That would be the next step and most of the warnings will go away when that is completed. There are now around 300 warnings in the observables bundle (down from a peak of almost 1000). I would be very happy to complete the work but I would like to see the work already done be committed before going any further, or at least to know what the plan for committing is. I don't think a CQ will needed because, although a lot of lines have been changed, it is a routine upgrade with nothing original. If you disagree though I would be happy to submit a CQ.Matthew, Boris, what do you think would be the best approach for this?Even if we're not at M6 yet, I would say that it is too late to get this done for 3.7.If we do this for 3.8 and want to start with this now, we would probably have to make a BRANCH of the databinding plug-ins but this would of course imply a certain overhead for any change to the databinding code until the end of the 3.7 release cycle. I'm not even sure whether it's common practice to make such a BRANCH during the API freeze period in order to still keep things running?Wow Nigel! Very thorough.Here are my comments as I go through the patch:* Observables.emptyObservableList could be typed as "<T> IObservableList<T> emptyObservableList()", similar to java.util.Collections.emptyList() returns a list of whatever type is inferred on the left hand side. Ditto for Observables.emptyObservableSet. I think these just got overlooked.* Looks like we still need to generify the listener interfaces and diff classes. Just putting it here so we don't forget.* Nice catch on generifying MasterDetailObservables and IObservableFactory to work together. However you could loosen the type requirements a little, e.g.: public static <M, E> IObservableSet<E> detailSet( IObservableValue<M> master, IObservableFactory<? super M, IObservableSet<E>>) // note wildcard This way if you have an IObservableFactory<Object, IObservableSet<Foo>> you could still observe the detail of an IObservableValue<Bar>.* Java 5 has built in IdentitySet<E> and IdentityMap<K,V> classes. If we're still targeting Java 1.4 then we have to keep these in. If we're targeting Java 5 then we can just extend these off the ones in the standard collections library and be done with it. So this decision needs to be discussed further.I think moving up to 1.5 would make sense, unless we know specifically that there are consumers who are still on 1.4 (I am not aware of any).Createdpatch to add generics to o.e.core.databinding.observablesAbove is a patch with my second batch of changes foro.e.core.databinding.observables. This completes the work for this bundle interms of parameterizing what should be parameterized though there is stillquite a bit of tidy up and testing to do. This patch does not include theloosening of detailSet method or the use of IdentityMap and IdentitySet fromthe Java libraries. I have one question about the toArray methods. As you will note these are thecause of most of the warnings. In my view I don't think there is any need toprovide implementations of these methods at all because the methods from thesuper classes will work just as well.I now need to run this through the tests and also to use in our production codeso I can identify potential problems.Createdfix tests and rebase to current headI have rebased to the latest head. This includes the new master-detail collections added by Mallo back in February and to which generics have now been added.The tests all pass. There was one test I needed to change. The test for the immutable list passed "new Object()" and expected UnsupportedOperationException. That actually now gives a cast class exception. Passing a Map.Entry object will give the desired result.I updated the version from 1.4 to 1.5 because if users add generics then they can't go back.This works in our production code and I believe this is in a state that it can be committed. If this gets committed then I might feel motivated to look at the other plug-ins, which should be much easier, and to sort out the remaining 23 warnings.Matt, could you look to see if this could go into M5?PWJust let me know what I can do to help get this into 4.2 M6.Matt did you ever get a chance to look at this again?The data binding project is dead. There has not been a commit to the project for well over a year, although many bugs in it, features, patches. I don't think any of the committers are involved with the project any more. I don't know what the dead project procedures are at Eclipse but in the short term we need to fork so we can continue to get bug fixes, generics and all the rest. Please put the generics version on GitHub or somewhere and build the jars so I and others can use them.It's nominally under Platform UI, but you are correct no one is actively looking at these plugins. If you (or someone) is interested in becoming a databinding committer (providing code fixes and accepting community contributions) you can post an email towith a little about yourself and how you would like to see databinding go forward.For the technical side of getting involved, seeThe repo that contains databinding is already on github, underPWI empathize with your position, Simon. Let me offer an alternative viewpoint, and a proposal.30 months ago I switched jobs, and data binding in SWT+JFace was no longer part of my everyday work. For a little while I continued to support the project and fix small bugs in my spare time. However my motivation to participate has waned. There are a couple good reasons for that.1. It's no longer part of my job description. I am authorized by my employer to work on the project, however I cannot use work time to do so except in rare situations when I have no tasks.2. The API is painted into a corner. For several years we have doggedly maintained backward compatibility, and continued to support some old, poorly thought-out APIs that have turned into a "spec once, implement everywhere." Realms are a perfect example of this.3. The Eclipse Platform development schedule and policies (e.g. code freezes) are, in my opinion, not conducive to part-time or amateur contributors. Maybe it's just Murphy's Law working against me, but it seems every time I get really motivated to work on things and fix bugs, it's a damn milestone week again. So even if I code up something, I can't push it back to the repository.3a. We may have adopted Git with all its great branching and merging abilities. However we are still using the same old CVS branching model that requires everybody to stop checking in code whenever it's time to cut a release. With tools like Git, this should not be necessary [1].I would very much like to move this project forward. However within the confines of the Eclipse process, I do not have sufficient autonomy to accomplish anything meaningful in my limited spare time.Eclipse Data Binding needs to be gutted and rebuilt.I propose we fork Eclipse Data Binding at Github. Having built a few new different data binding libraries in the past few years, I think I have a pretty good vision of what API we should shoot for [2].The long-term goal is still to have the project live at Eclipse. But for the sake of rapid iteration, I think we should leave the reservation for a while. We can continue to enforce the same IP constraints (e.g. obtain positive declaration of ownership and licensing when contributions exceed 250 LOC). This should help ensure that the project will be IP clean to contribute back when we are ready.[1][2](My own project: flex data binding for AS3)(In reply to)we always allow pushes to topic branches, even during milestone week. Same applies to 3a, work can continue even during a freeze, just not on the main line.While I'm not saying this is a good idea or bad idea, if you want to fork to evolve the API on a "lighter" timeline you should consider the Platform E4 incubator project (some extensive core.resources experimental features were done in E4 with forks before being consumed back into the main repo).Some of the advantages of using E4 is 1) still built and signed at the foundation, 2) it's easy to become a committer on E4, and 3) contributions and committers have already signed up for the eclipse IP guidelines making it easy to roll work there back into the fold, so to speak.PW(In reply to)+1.It would be easy for me to put my changes into a Github fork but it seems like the consensus is that data binding is moved to e4. So assuming the extra bureaucracy can be completed, I'll plan on checking the changes in there.Matthew, you say that data binding needs to be gutted and rebuilt. Can you document the details? How would the ideal APIs look if you did not need to worry about backwards-compatibility?(In reply to)Right now it's an offer for Matthew to consider.Just to give you an idea of the bureaucracy if e4 is a good place to re-work databinding:1) setting up the e4 fork for databinding to work on should take very little time2) becoming an e4 committer involves posting you would want to work on the databinding project. Then there are committer elections, to get approval (easy, just takes 7 days). Then you have to fill in the committer paperwork (your current employer may or may not make it easy for you), and get an ID.Once the fork is in e4 the e4 version is also on github, and committers can accept contributions from other github forks (bugzilla can be used for a pull request).That's more or less where the process is now.PWSome time ago I wrote up a google doc with the details:(In reply to)Sorry I failed to provide context with my previous comment. The Google Doc link was in answer to the above question.Thanks Matthew for the link to the documents with all your ideas. I added a couple of comments but then ended up just copying the document and making a few changes. My copy is at.It seems the best way forward with the Generics is if someone puts data binding into e4. I'll then check-in the Generics into a fork. Others can build from that and it will be easy to pull into e4. I can also use the fork to play around with the ideas in Matthew's document and see how well they work in a real project.Nigel, I've added your Bugzilla email address as an editor on the document. Could you please highlight your additions in a separate color so I can see which parts are new to the discussion?I am now back involved in a project that could really benefit from the discussed work and I also have time that will allow be to make considerable progress on this.It does not appear that Databinding has been moved into the e4 repository. Paul Webster said that was easy to do. If there is anything I can do to help that happen please let me know. Once that is done I will can start work. Paul also mentioned that I should get IP approved so I can commit to a fork from which you can pull without IP issues There won't be issues from my employer, I've had committer status before on another project.I tried editing Matthew's document in googledocs. Despite creating an account with the same e-mail as I use in Bugzilla, I did not appear to have edit rights. However the changes essentially boil down to:1. It should not be necessary to have to provide both a validator and a converter if the validator is only checking that the convertor can proceed. The converter itself should raise the errors directly. This makes it simpler for the user. It also makes more sense from an implementation point-of-view because to validate one often has to do the conversion and check for errors, then drop the converted value, then do the conversion again in the converter.2. I don't think it is necessary to use the twoWay method to do two-way bindings. The same form used for one-way binding could in fact be used for two-way binding. This is also safer and simpler for the user because they only specify one convertor which can handle conversions in both directions.3. You are correct to separate out the 'binding' from the 'observables', so, for example, delayed binding is considered a different form of binding, not implemented as an observable. The two are interchangable but by isolating observables to just the actual data we get more flexibility. The 'stale' issue can then be cleaned up. It is also easier to implement other binding forms. An example of another form of binding is the 'default value' binding, which binds together three observables, model, target, and default value. The default value is usually a computed value and is input only to the binding.Some of the changes to the API were to make generics work better. The idea of Functors in particular makes type checking harder. Also, is there a dev mailing list for databinding? It seems platform-ui-dev is the closest that covers databinding.Nigel(In reply to)If this works for you and Matthew we can start that right now:1) make sure you and Matthew are committers on the e4 project or start elections for it2) once that's moving ahead, create an e4 repo to build the databinding bundles you specify.Matthew, what do you think?PWCreatedmy changes to add generics to org.eclipse.core.databinding.observable 1.4.0Createdmy changes to add generics to org.eclipse.core.databinding.property 1.4.0As requested by Nigel, I’ve just added two patches with the changes I made to add generics to both org.eclipse.core.databinding.observable and org.eclipse.core.databinding.property as published in my github repo. Feel free to use in any way!Thank you Jean-Philippe. Attaching that allows us to use the work you have done and that is especially helpful as o.e.c.d.property does really need generics too.Hopefully we will sort out some committers soon so all this work everyone has done on generics can finally get checked in.In the latest E4 build, we had pom version failures (then version in the pom file needs to be updated when the MANIFEST.MF is).Also, when you start using Generics you need to bump up the Bundle-RequiredExecutionEnvironment to J2SE-1.5I've releasedto fix that and restart the buildPWOoops, had to update the test plugin as well.[ERROR] Failed to execute goal org.eclipse.tycho:tycho-compiler-plugin:0.17.0-SNAPSHOT:compile (default-compile) on project org.eclipse.jface.tests.databinding: Compilation failure: Compilation failure:[ERROR] /opt/public/eclipse/e4/build/e4/downloads/drops/4.0.0/I20130312-1315/org.eclipse.e4.databinding/tests/org.eclipse.jface.tests.databinding/src/org/eclipse/core/tests/internal/databinding/observable/masterdetail/SetDetailValueObservableMapTest.java:[143,0][ERROR] sdom.put(person, "name2");[ERROR] ^^^[ERROR] The method put(Object, Object) is ambiguous for the type SetDetailValueObservableMap[ERROR] /opt/public/eclipse/e4/build/e4/downloads/drops/4.0.0/I20130312-1315/org.eclipse.e4.databinding/tests/org.eclipse.jface.tests.databinding/src/org/eclipse/core/tests/internal/databinding/observable/masterdetail/MapDetailValueObservableMapTest.java:[146,0][ERROR] mdom.put(person, "name2");[ERROR] ^^^[ERROR] The method put(Object, Object) is ambiguous for the type MapDetailValueObservableMap[ERROR] /opt/public/eclipse/e4/build/e4/downloads/drops/4.0.0/I20130312-1315/org.eclipse.e4.databinding/tests/org.eclipse.jface.tests.databinding/src/org/eclipse/core/tests/databinding/observable/list/AbstractObservableListTest.java:[87,0][ERROR] list.add(element);[ERROR] ^^^[ERROR] The method add(Object) is ambiguous for the type AbstractObservableListTest.AbstractObservableListStubThe errors show up if you have multiple JREs configured in Preferences>Java>Installed JREsPW***has been marked as a duplicate of this bug. ***I am very interested in generics for Databindings and JFace, because it would simplify a lot of things. The current API feels very unattractiv without it. Is there any progress on this?Yes, this work is completed. I hadn't resolved this bug because it is still in the e4 project (not yet pulled into Platform), and there is always a little more work to do. However it is currently being used in production environments.To get the changes from source:You can find the builds at:At the time of writing the latest release build is 0.14, with the p2 repository at:In this repository you will find all the binary and source bundles together with the databinding feature which is:org.eclipse.e4.source.databinding.featureAll feedback will be greatly appreciated!resolving this as it is now available in the e4 project.That's great to hear and I'm looking forward to using them! Nigel, out of curiosity, did you use any of the stuff I attached? Cheers, —J.-P.(In reply to J.-P. Pellet from)Yes, you attached, I think it was, the Observable bundle and the Properties bundle with generics. The Observable bundle had been mostly done by then, but your work on the Properties bundle was of great help. You had done the entire bundle which saved a lot of time, and some of your work on the Observable bundle was incorporated too. Thank you so much for making those attachments.>>>The Feature "org.eclipse.e4.source.databinding.feature" is not included in the repository. Only the features: - E4 Databinding (Incubation) 0.13.0.v20130503-1433 - E4 Databinding Test/Examples 0.13.0.v20130503-1433It seems that only "E4 Search" includes Source Features but no other Category. I think every feature should contain an corresponding source feature.Nigel, thanks. My pleasure to have been able to contribute something. Any other such plugin which would badly need generics?Yes JFace! There was some work done, but i don't know the actual state, see:I contacted J.-P. Pellet already via email, for JFace Generics help.I want give some feedback to the generified methods of the class Observables:public static IObservableXXX<Object> emptyObservableXXX() it should be -> public static <T> IObservableXXX<T> emptyObservableXXX() other wise one get an compiler error: cannot convert from IObservableSet<Object> to IObservableSet<ExpectedType>public static IObservableXXX<Object> emptyObservableXXX(Object elementType) should be deprecated, and this should be added as alternative: public static <T> IObservableXXX<T> emptyObservableXXX(Class<T> elementType)^^ the same should be applied to emptyObservableXXX(Realm realm,Object elementType)(In reply to Christian Schwarz from)I agree. Nigel, that's how I've done it in my patch for the observables bundle, feel free to copy from it.Some more Feedback...DataBindingContext.bindValue(..) should return Binding<M, T> not Binding<?, ?> to avoid a unnecessary casting.Last night's build failed:[ERROR] Failed to execute goal org.eclipse.tycho:tycho-compiler-plugin:0.18.0:compile (default-compile) on project org.eclipse.core.databinding.observable: Compilation failure: Compilation failure:[ERROR] /opt/public/eclipse/e4/build/e4/downloads/drops/4.0.0/I20131023-2200/org.eclipse.e4.databinding/bundles/org.eclipse.core.databinding.observable/src/org/eclipse/core/databinding/observable/Observables.java:[577,0][ERROR] public synchronized void addSetChangeListener([ERROR] ISetChangeListener<E> listener) {[ERROR] ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[ERROR] Name clash: The method addSetChangeListener(ISetChangeListener<E>) of type new ObservableSet<E>(){} has the same erasure as addSetChangeListener(ISetChangeListener<? super E>) of type ObservableSet<E> but does not override it[ERROR] /opt/public/eclipse/e4/build/e4/downloads/drops/4.0.0/I20131023-2200/org.eclipse.e4.databinding/bundles/org.eclipse.core.databinding.observable/src/org/eclipse/core/databinding/observable/Observables.java:[754,0][ERROR] public synchronized void addListChangeListener([ERROR] IListChangeListener<E> listener) {[ERROR] ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[ERROR] Name clash: The method addListChangeListener(IListChangeListener<E>) of type new ObservableList<E>(){} has the same erasure as addListChangeListener(IListChangeListener<? super E>) of type ObservableList<E> but does not override itProbably related to this commit:PW***has been marked as a duplicate of this bug. ***Reassigning to myself -- I'll handle merging the changes into the main repo.Note that the patches no longer apply cleanly, but I spent yesterday merging them and they seem to be good now.I've removed some of the changes- This patch also contained some refactoring to split apart the PrivateInterface private classes into separate classes. This would defeat the purpose of the PrivateInterface pattern which, AFAIK, is there to minimize anonymous classes and speed up classloading.- ListDiff contained a commented-out, faster, version of one of the methods which didn't compile - I fixed and used the faster version.- ListDiff contained a new getDifferencesAsList() method that required all subclasses to implement the getter for the set of differences twice. The idea behind it is good, but we should probably deprecate or remove the old method if we're going to replace it. Also, that cleanup isn't required as part of adding generics and we should do it carefully as its own change.New Gerrit change created:New Gerrit change created:WARNING: this patchset contains 4429 new lines of code and may require a Contribution Questionnaire (CQ) if the author is not a committer on the project. Please see:Not sure if you're talking about Nigel's changes or my changes, but if it helps, I'm of course willing to fill out the questionnaire.(In reply to J.-P. Pellet from)I think we are fine here, as this code is already in the e4 project. But thanks for the reaction. Maybe you can also have a look at the Gerrit reviews from Stefan and see if you can spot any issues with them?(In reply to Lars Vogel from)I'm afraid that's currently out of the scope of things I can realistically do these months. Apologies! Should be better around October if help is still needed.After going over several iterations of reviews with Sergey, I think I've rewritten every single line of the original patch (and the first patch is almost 10,000 lines long now).New Gerrit change created:Since this change is growing so large, I've broken it into a number of smaller bugs -- and I've broken up the first patch into two smaller patches.covers the changes to org.eclipse.core.databinding.observablecovers the changes to org.eclipse.core.databinding.propertycovers the changes to org.eclipse.core.databindingThere are more databinding plugins, but these are as far as I can take this since it's turned into way more work than I planned for.Really wonderful to see this work being done!Are there plans to also add generics to the EMF databinding bundle (org.eclipse.emf.databinding)?Are there plans to add generics to the Ecore classes? That is, EClass, EStructuralFeature and related classes?Please open a bug for EMF for this. The platform UI team cannot make any decisions for EMF.	61.0
id=497119	REOPENED	JDT	Core	4.6	PC Linux	P3 normal	Stefan Xenos	2016-06-30 14:48 EDT by	Stefan Xenos	2017-01-25 04:49 EST (	2 users	The unit tests for the new index are currently disabled. We should enable them.	Which tests in JDT Debug were disabled ?None. I think it was just the tests for the new index. I think they're enabled now... But I'll check when I get back to my computer.I don't see any tests in JDT Debug for index, Please reopen if you think otherwise.Reopening and moving to correct component.Bulk change, moving out all bugs that couldn't make it to M3.This was fixed earlier in M4.(In reply to Stefan Xenos from)@Stefan: Could you please share the commit link here?(In reply to Manoj Palat from)From the logs, the commit at :@Stefan: The tests are enabled. However, the addition is more appropriate in RunJavaSearchTests rather than AllJavaModelTests (which includes RJST anyway).re-opening for this and moving the target to M5.New Gerrit change created:Manoj: I've attached a patch implementing your request from. Please confirm that it's what you wanted.(In reply to Stefan Xenos from)Did a +1 a couple of weeks back but I guess missed out due to no explicit comment. moving to M6	11.0
id=149975	REOPENED	JDT	Core	3.2	All All	P3 enhancement	Stefan Xenos	2006-07-07 10:09 EDT by	"Z" Zorzella	2017-01-25 05:05 EST (	7 users	"Open Type" (SHIFT-CTRL-T) is just about the most useful way to navigate the sources, and it relies on indexes that don't get updated until the user requests the function. For a large project, that "Progress Information -- xxxx files to index" box (and its lesser sibling, the "refresh indices" message that shows up on the "Open Type" dialog itself) can take up to several minutes. Just like it's possible to have the system "build automatically" (and even "refresh automatically"), the indexes should be (optionally?) refreshed automatically as well.Z	It already works as you expected to. Indexes are created and refreshed automatically (see step 5) and 6) below).They are created when user adds new projects or jar files, refreshed when he updates them and deleted when he deletes them...If update or delete operation are not noticeable for user, creation may take a noticeable amount of time. So, if you perform a request before the indexing operation finishes to create all index files, then you'll get progress dialog until the end of the process(step 11) below).Here's a simple use case to observe this behavior:1) Start eclipse on a brand new workspace (lets say in d:\tmp\wksp)2) Open Windows explorer on d:\tmp\wksp\.metadata\.plugins\org.eclipse.jdt.core (index files are stored there) => this directory is empty3) In you eclipse session, open Java perspective4) Import org.eclipse.jdt.core plugin with source folders in your workspace5) Wait the end of the import and go to Windows explorer => ".index" files start to be created in .plugins\org.eclipse.jdt.core directory6) Wait until all ".index" files are created (it can take 1 minute)7) Go back to eclipse session and hit Shift+Ctrl+T => Open Type dialog opens without any progress dialog on indexing8) Close your eclipse session9) Remove all files in d:\tmp\wksp\.metadata\.plugins\org.eclipse.jdt.core using Windows explorer10) Restart eclipse on same workspace11) As soon as your session is opened, hit Shift+Ctrl+T => you'll see the progress dialog for indexing files...So I've imported a brand new project in my workspace, and watched the folder you suggested for the index files. I waited over an hour and watched again -- the file with the greated lastmodified date had been "touched" an hour before. Then I hit Shift-Ctrl-T and it said "10000 files to index", and proceeded to decrease them. There was an .index.tmp file while that happened. At the end of it, it was renamed to .index.ZSo it's sounds there's a problem here... What is your build ID?Well, I'm using 3.2 (Build id: I20060602-1317). But, honestly, I can almost assure you this problem has been happening for a long time (say, since 3.1 days or before).I guess you wrongly closed this bug as FIXED...Do you have 'Build automatically' General->Workspace preference checked or not?If so, then built of your workspace, like indexing, starts automatically just after the end of the import. However, indexing background process has a lower priority than build one => you have to wait for the entire build to be finished before starting indexing your project files.If your project has 10,000 files, then built and indexing processes can take a noticeable amount of time depending on your box and your Java Heap size. The less memory you'll have allowed to your VM, the longer time it will take to build and index your project with this numerous number of compilation units (garbage collect will be frequently required and slow down these processes)...Can you provide more info on your preferences and VM setup to figure out if this can be a valid explanation? (Honestly, I sincerely doubt this can be the case as you said you have waited more than an hour for index file creation and even a Pentium II with 64Mo will have done the job during this time...).I'm also interested by the time it takes to build new index file (ie. the .index file, not the tmp one) as soon as you hit on Ctrl+Shift+T key?Finally, I would also be interested by having some trace on this issue. So, if you could start your eclipse session using debug for indexing and attach console output to this bug... To do that, create an .options file in the eclipse launch directory (or modify existing one...) and add following lines:# Turn on debug tracing for org.eclipse.jdt.core pluginorg.eclipse.jdt.core/debug=true# Reports background indexer activity: indexing, saving indexes, index queriesorg.eclipse.jdt.core/debug/indexmanager=trueThe easy ones first: 1) I mostly have "Build Automatically" checked, but, in my experiment, it was long finished before I hit Shift-Ctrl-T2) The index, in that particular case, was generated reasonably quickly (less than a minute), as it was the only thing the box was doing. Mind you, the source is very largeAs for your need for debug -- I'm testing at my work environment, and I don't want to send a trace from here. I'll see what I can do about reproducing the problem at home, though with a much smaller source base :^>BTW, wouldn't there be a way for you to have the indexing, indeed, as a lesser priority than compilation, but, still taking some cycles? It seems odd that a quick(er) thing should be entirelly blocked on a potentially long process, particularly a feature that's so key for development... It's like not having background compilation at all.Thanks,Z(In reply to)It sounds a reasonable time to index a large amount of codeOKBuild new files is really more important than having the indexes while you do not need them. But, as soon as you perform a search request (this happens when you open the Open Type dialog), priority of indexing is increased and then you get the result in a reasonable time. So, indexing process is blocked by other processes only if you do not care of it... this sounds like a reasonable strategy, don't you think?However, I'm investigating if there's some corner cases which can make this priority a little bit too much low and prevent indexing to run normally even when there's nothing really important to do (built in your case does not seem to be involved...). To help me on this I also would like to know how much time it takes to rebuild your project. For that, you can clean it and measure the time the built takes to finish...ThanksI see (about the priority). The one wart with the reasoning is that, with idexing competing with compilation, it can take a quite non-trivial amount of time -- and I hate it when work is blocked for more than 3 seconds (or less)... I think the larger issue is to decide if "Open Type" is the only "reasonable" way to get to open a class. As it stands, the only other ways I can think of opening a project class is by browsing Navigator/Package Explorer (not "reasonable" IMHO, for the mouse is not an effective/fast way to do this), or File > Open file, which is even worse. I've always felt that an emacs-like minibuffer that allows me to do these things as effectivelly as I can in emacs would be a great boon to Eclipse... Haven't had the time, though, to learn how to and write a plugin :^<Lest I forget the main point, I can estimate quite well (without actually doing the clean) for you that the compile time (from scratch) for this project is 20-30 minutes.Unfortunately we do not have more time either to investigate further and think about any other strategies to open types.Verified for 3.4M5.Reopening. We should be able to fix this using the new index.Suggested behavior:Ctrl-Shift-T opens the dialog instantly based on the existing contents of the index (whatever they happen to be). If indexing is in progress, some sort of spinner is shown as an indicator that additional results may show up later, but this does not interfere with the operation of the dialog. When indexing completes, the new results are added to whatever is currently visible in the dialog.It would be better to fixfirst so that we can safely add code to SearchEngine that blocks on the index.To really implement this properly we'd need to implement a source indexer for the new index, so I'll also mark this as dependent on. However, a workaround is possible: we could also implement a combined approach like we used in the type hierarchy, where results from both indices are merged.moving out of M5 (a general target of 4.7)	15.0
id=508938	REOPENED	JDT	Core	4.6	PC Linux	P3 normal	Stefan Xenos	2016-12-08 12:47 EST by	Stefan Xenos	2017-01-25 04:46 EST (	2 users	The indexer currently uses job groups for mutual exclusion between indexing jobs. It should be using scheduling rules for this purpose.	New Gerrit change created:Gerrit changewas merged to [master].Commit:This patch created a serious regression. I'm going to revert it and leave the deprecated version in place.See.Reopening. Actually, this exception was a good thing - it was detecting a potential deadlock that is present right now - due to the fact that another thread can hold the workspace lock while joining the indexer thread which can then try to reobtain the workspace lock.Sergey and I discussed two potential fixes to this issue - one involves changing the way Job.join works in order to give it the same sort of deadlock protection and lock inheritance that happens with beginRule.The other fix involves changing the way the indexer works and splitting its responsibilities into multiple threads. The indexer itself would receive only a list of files to index and any thread that blocks on the indexer would be responsible for gathering up that list by resolving the project classpaths and whatnot.Both changes may even make sense independenty, but either one would resolve the potential deadlock and let us avoid the use of the deprecated job group APIs.Investigating this issue uncovered the need for.moving out of M5	7.0
id=511802	REOPENED	Platform	UI	4.6	PC Linux	P3 normal	Stefan Xenos	2017-02-06 16:33 EST by	Stefan Xenos	2017-02-13 09:49 EST (	3 users	I recently had a UI freeze in my log. After investigation, I discovered that SashLayout is forcing a synchronous uncached layout and full repaint on each mouse event. Neither of these are necessary. They can be replaced by a call to requestLayout.It performs an asynchronous layout that merges with other layout events, doesn't block the event loop, and will only repaint those regions of the screen whose size actually changed.	New Gerrit change created:Gerrit changewas merged to [master].Commit:SashLayout is not API, so we can simply remove "layoutUpdateInProgress". Gerrit patch to follow.New Gerrit change created:Why is it not API? It looks to me like an exported package without the word internal. Doesn't that make it API?(In reply to Stefan Xenos from)Everything which is marked as x-internal or x-friends in the MANIFEST.MF is not API.Export-Package: org.eclipse.e4.ui.internal.workbench.renderers.swt;x-friends:="org.eclipse.ui.workbench", org.eclipse.e4.ui.workbench.renderers.swt;x-friends:="org.eclipse.e4.ui.workbench.addons.swt,org.eclipse.ui.workbench"Gerrit changewas merged to [master].Commit:This change ruines drag/drop views re-layout. Just grab the resize handler shown if you mouse hovers in the top left corner of the problems view and try to resize vies. The resize doesn't follow the mouse anymore, it feels as if this waits seconds to relayout itself.New Gerrit change created:Gerrit changewas merged to [master].Commit:Andrey, what platform are you using? It works great for me on GTK.(In reply to Stefan Xenos from)Windows 10, sorry.Either we'll need a plaform-specific fix or we'll need to fix the windows port of SWT such that it repaints properly in such situations. My inclination is the latter, since we've had other reports of windows not repainting and there's quite a few workarounds in place. Fixing this at the SWT layer would eliminate the need for such platform-specific workarounds and would also fix other similar bugs.	13.0
id=440373	REOPENED	Platform	UI	4.4	PC Linux	P3 enhancement	Wim Jongman	2014-07-24 13:06 EDT by	Lars Vogel	2016-11-02 17:38 EDT (	5 users	 	Toni, as discussed, can you provide a snippet for DeferredContentProviderFabian, looks like Tony is not available for this. Would you be able to contribute a snippet?Marking as wontfix, no feedback from Fabian or TonyI will provide a snippet.	4.0
id=475604	REOPENED	Platform	IDE	4.6	All All	P3 normal	Stefan Xenos	2015-08-21 14:09 EDT by	Alex Blewitt	2016-03-23 12:36 EDT (	7 users	The org.eclipse.ui.internal.Workbench class has a method: private final static void declareImage(String key, String path, boolean shared) { URL url = BundleUtility.find(PlatformUI.PLUGIN_ID, path);This is used to load images in a static initialiser with many different arguments: private final static void declareImages() { // Overlays declareImage(ISharedImages.IMG_DEC_FIELD_ERROR, PATH_OVERLAY + "error_ovr.png", true); //$NON-NLS-1$ declareImage(ISharedImages.IMG_DEC_FIELD_WARNING, PATH_OVERLAY + "warning_ovr.png", true); //$NON-NLS-1$...It's called from the workbench startup: Workbench::init method: activityHelper = ActivityPersistanceHelper.getInstance(); StartupThreading.runWithoutExceptions(new StartupRunnable() { @Override public void runWithException() { WorkbenchImages.getImageRegistry(); } });This causes a lot of file traffic for all images even when they're not necessary.	The reason why it does this, by the way, is because it delegates to a 'find' method that attempts to do filesystem resolution by name (specifically, the FindSupport::find method) // Worry about variable substitution IPath rest = path.removeFirstSegments(1); if (first.equalsIgnoreCase("$nl$")) //$NON-NLS-1$ return findNL(b, rest, override, multiple); if (first.equalsIgnoreCase("$os$")) //$NON-NLS-1$ return findOS(b, rest, override, multiple); if (first.equalsIgnoreCase("$ws$")) //$NON-NLS-1$ return findWS(b, rest, override, multiple); if (first.equalsIgnoreCase("$files$")) //$NON-NLS-1$ return null;The net result is that a given file does a lot of lookups to determine if the files are there. Admittedly this is likely to use the list of a JAR file which may be cached but most of the time it's not necessary.Note that the result of this is an ImageDescriptor which is a pointer to the file anyway; it doesn't load any data until the getData is called anyway, which means the metadata lookup for the files can be excessive.The solution is to use a DeferredImageDescriptor that just represents the file name, and then use the getImageData call to do the Platform.find() lookup at that point.It would mean that an error in specifying the image wouldn't be visible until the image file data was requested (right now, an error would be displayed if it tried to load any of them I think - or at least, a red image square) but this could be mitigated by tests.Admittedly, on my test system the initializeImages() only takes ~25ms in total (so there's not likely to be a huge win) but it's on the critical path for startup.To put things in perspective, this change: // URL url = BundleUtility.find(PlatformUI.PLUGIN_ID, path); URL url = new URL("platform:/plugin/" + PlatformUI.PLUGIN_ID + "/" + path);in WorkbenchImages::declareImagedrops the time from ~25ms to ~10ms. Part of that's due to the reduction in method calls, but mainly it's to do with the fact we're not hitting bundle.getEntry() on a whole bunch of those file names.I'm not suggesting this is necessarily the best fix (we don't support $os$ or similar with the above hack) but just documenting the kind of improvement that might be possible.BTW when I was testing against the .jar the declareImages was taking ~50ms to run. I suspect that's because bundle.getEntry() has to do more work when it's a JAR, but when running in debug in the workspace it's just mapping the calls down to File calls which thus can be executed faster (it's relying on the OS to navigate the filesystem instead of Java which will navigate the JAR entry)Deferring would also make sense if providing replacement images in a fragment…I had a proof-of-concept for the deferred images using a wrapper: private final static void declareImage(String key, String path, boolean shared) { URL url = BundleUtility.find(PlatformUI.PLUGIN_ID, path); ImageDescriptor desc = ImageDescriptor.createFromURL(url); declareImage(key, desc, shared); }replaced with something along the lines of: private final static void declareImage(String key, String path, boolean shared) { ImageDescriptor desc = new DefferedImageDescriptor(String bundle, String path); declareImage(key, desc, shared); }static class DefferedImageDescriptor { DefferedImageDescriptor(String bundle, String path) { this.bundle = bundle; this.path = path; } ImageData getImageData() { return ImageDescriptor.createFromURL(BundleUtility.find(PlatformUI.PLUGIN_ID,path).getImageData(); }}That way the lookup is deferred until the getImageData is called.BTW I note that JFace has some similar lookups in JFaceResources.initializeImages and JFaceResources.declareImage private static final void declareImage(Object bundle, String key, String path, Class<?> fallback, String fallbackPath) { ImageDescriptor descriptor = null; if (bundle != null) { URL url = FileLocator.find((Bundle) bundle, new Path(path), null); if (url != null) descriptor = ImageDescriptor.createFromURL(url); } // If we failed then load from the backup file if (descriptor == null) descriptor = ImageDescriptor.createFromFile(fallback, fallbackPath); imageRegistry.put(key, descriptor);(Or to put it another way, a deferred JFace image lookup class might be worth putting in JFace, and then use that standard in both JFace and other dependent classes)(In reply to Alex Blewitt from)+1. Can you please create a new bug for that and potentially provide an implementation for it?Yeah, it's on the backlog ...(In reply to Lars Vogel from)Adding Stefan, as he might also be interested in this.Createdfor the JFace enhancement.No plans for me to work on this at the moment, re-assigning to inbox.*** This bug has been marked as a duplicate of***This depends on, it's not a dupe. I'd like to give Sergey the appropriate credit for fixing it.Reopened sincewas reverted.	16.0
id=473741	REOPENED	PDE	UI	4.5	PC Windows 7	P3 normal	Vikas Chandra	2015-07-28 06:51 EDT by	Dennis Hendriks	2017-01-31 03:46 EST (	3 users	Entering a 'Vendor' in the wizard during creation of a plug-in project has no effect.Steps to reproduce: - File -> New -> Project... - 'Plug-in Project' - 'Next >' - Type some project name. - 'Next >' - Type some vendor name. - 'Finish' - The project is created, and the manifest editors is automatically opened/shown. - Observe no 'Vendor' name in the manifest.	works well in Version: Neon (4.6)Build id: I20160428-0800Feel free to re-open with steps and snapshotConfirmed. It does indeed work now.I use Eclipse version: Neon.2 Release (4.6.2)Build id: 20161208-0600and it does not work.CreatedWorks on the same build id..see snap attached.Can you please give detailed steps in scenario it doesn't work.Comment onWorks on the same build id..see snap attached.I found the problem:I you type in a new vendor then the value is copied to the MANIFEST.MF.I you just select a previously used vendor with the combo box then the value is not copied.Can you please give detailed steps for this ?1. selected File > New > Project ... > Plug-in Project > Next2. entered project name abc, then Next >3. click into field "Vendor" and enter abc.4. Press Finish5. manifest contains vendor value6.selected File > New > Project ... > Plug-in Project > Next7. entered project name abc3, then Next >8. click into field "Vendor" and press key CURSOR_DOWN. The previously entered value 'abc' is shown and entered9. Press Finish10. a manifest without vendor is generatedWhen you use the combo box and then press the Finish button after usage you can see that the vendor field is emptied before the wizard closes.Creatednew plugin project wizardCreatedmanifest editor with missing vendor entryI am able to recreate this now.	10.0
id=490770	REOPENED	PDE	API Tools	4.6	All All	P3 normal	Vikas Chandra	2016-03-31 06:28 EDT by	Markus Keller	2016-05-04 04:30 EDT (	4 users	changed public StructuredSelection(Object[] elements) {..}to public StructuredSelection(Object... elements) {..}This is a compatible API change that should have been reported inCompare With > API Baseline... correctly says:"Replaced an array type with a variable argument type in constructor org.eclipse.jface.viewers.StructuredSelection.StructuredSelection(Object[])"Note that this change was only present in that build and has been reverted in master.	The freeze report also missed a change in a static final field declaration (from non-constant to compile-time constant).The change was reverted in master with, but it was present in N20160406-2000 although the report missed it:=> known undetected API changes:- method signature change from array to varargs- static final field change from non-constant to compile-time constantI can take a quick look at this if you want, Markus.(In reply to Olivier Thomann from)That would be great!With my current set of changes, new entries are needed in the freeze exclude list.org.eclipse.compare.core:org.eclipse.compare.core:EXECUTION_ENVIRONMENT=J2SE-1.4org.eclipse.compare.win32:org.eclipse.compare.win32:EXECUTION_ENVIRONMENT=J2SE-1.4org.eclipse.compare:org.eclipse.compare:EXECUTION_ENVIRONMENT=J2SE-1.4org.eclipse.core.net.win32.x86_64:org.eclipse.core.net.win32.x86_64:EXECUTION_ENVIRONMENT=J2SE-1.4org.eclipse.core.net:org.eclipse.core.net:EXECUTION_ENVIRONMENT=CDC-1.1/Foundation-1.1org.eclipse.core.net:org.eclipse.core.net:EXECUTION_ENVIRONMENT=J2SE-1.4org.eclipse.jsch.core:org.eclipse.jsch.core:EXECUTION_ENVIRONMENT=J2SE-1.4org.eclipse.jsch.ui:org.eclipse.jsch.ui:EXECUTION_ENVIRONMENT=J2SE-1.4org.eclipse.team.core:org.eclipse.team.core:EXECUTION_ENVIRONMENT=J2SE-1.4org.eclipse.team.cvs.core:org.eclipse.team.cvs.core:EXECUTION_ENVIRONMENT=J2SE-1.4org.eclipse.team.cvs.ssh2:org.eclipse.team.cvs.ssh2:EXECUTION_ENVIRONMENT=J2SE-1.4org.eclipse.team.cvs.ui:org.eclipse.team.cvs.ui:EXECUTION_ENVIRONMENT=J2SE-1.4org.eclipse.team.ui:org.eclipse.team.ui:EXECUTION_ENVIRONMENT=J2SE-1.4org.eclipse.ui.net:org.eclipse.ui.net:EXECUTION_ENVIRONMENT=J2SE-1.4These are the two entries related to compile time constants that are not required to be added since this is fixed:org.eclipse.jdt.core:org.eclipse.jdt.core.ToolFactory#M_FORMAT_EXISTINGorg.eclipse.jdt.core:org.eclipse.jdt.core.ToolFactory#M_FORMAT_NEWThis is the entry that would have been displayed for the array to varargs change:org.eclipse.jface:org.eclipse.jface.viewers.StructuredSelection#StructuredSelection([Ljava/lang/Object;)VSo both issues would now be returned. The execution environment entries above are required in the exclude list. Patch to follow.CreatedProposed patchI delivered the fix.Thanks Olivier. For reference I think this is the relevant commit:We upgraded to the latest API Tools in our build and got a confusing freeze report:Several of these (for different bundles):REMOVED org.eclipse.ui.intro.universal#J2SE-1.4(Execution Environment)I know you said we have to exclude this, but didn't do so yet. I would rather expectCHANGED org.eclipse.ui.intro.universal#J2SE-1.4 to JavaSE-1.8 (Execution Environment)ADDED org.eclipse.jdt.ui.actions.WorkingSetFindActionThis action exists since many years, hence clearly a false positive.If we also show compatible changes, we need to see this difference in the report, i.e. incompatible versus compatible changes.I've reverted the change withso that we can build a new version of the API Tools which we can then use in the build itself.If you have time to look at this, we can still put it into M7 or RC1.(In reply to Dani Megert from)Or have a corresponding ADDED entryADDED org.eclipse.ui.intro.universal#JavaSE-1.8 (Execution Environment)It looks like the change in DeltaXmlVisitor.processLeafDelta(IDelta) caused:Instead of flags = 72the entries have flags = DEPRECATIONLet's see whether reverting also fixes.I'll take a look at.(In reply to Dani Megert from)This is what I have done.(In reply to Olivier Thomann from)You mean now? Currently it's not in the report as you can see.(In reply to Dani Megert from)I mean I fixed it :-)(In reply to Dani Megert from)The problem comes from the display of what has been found.The message from the delta is:"The method org.eclipse.jdt.ui.actions.WorkingSetFindAction.run(IJavaElement[]) has been added, overriding a method from a superclass"which is true. I am trying not to filter any delta and instead require a filter to be added for them. So in this case, I can filter it right way or I can improve the way the delta is reported requiring an exclusion to be added.Let me know what you prefer.(In reply to Olivier Thomann from)The report should report the real issue which is the compatible change of adding WorkingSetFindAction.run(IJavaElement[]).The filter proposal should propose to filter that explicit thing.(In reply to Dani Megert from)It does report it. It is just that its display is bogus. I wonder if the best is not to report the actual delta's message which is very detailed.I'll make sure we provide a good way to filter it out in the exclude list.I think changing the BREE should be reported as a compatible change. Best as CHANGED.(In reply to Dani Megert from)CHANGED is fine when you go from one BREE to another one. When you have more than one, how do you know which one is changed? In this case reported REMOVED and ADDED is fine.(In reply to Olivier Thomann from)Well, that's not the case for 'org.eclipse.ui.intro.universal' - it simply moved from 1.4 to 1.8.(In reply to Dani Megert from)This is what I mean. When you go from one to one, I can report a CHANGED, but for all other cases it would be REMOVED and ADDED. For me this is a detail. As long as I see what has changed, both would be ok.CreatedProposed patch including updated regression testsDaniel, Vikas, please try this patch. I could run a deprecation report and a freeze report successfully and all tests are green except the test for old style bundle that is also failing without the patch.There are still some issues with the bundle org.eclipse.core.databinding.property, but this is due to a bogus .api_description file in the M6 zip. Some signatures are unresolved causing some bogus errors to be reported.(In reply to Olivier Thomann from)Hi Olivier, can you post the detailed steps here how you created the reports? If I recall correctly one has to go via Ant scripts and it's not possible via UI. Thanks!Will the freeze report show the difference between compatible and incompatible changes?This is the ant script I used to get the freeze report:<?xml version="1.0" encoding="UTF-8"?><project name="api_freeze_reporting" default="run" basedir="."> <target name="run"> <apitooling.apifreeze debug="true" baseline="C:/api/eclipse-SDK-4.6M6-win32-x86_64/eclipse" profile="C:/api/eclipse-SDK-N20160423-1500-win32-x86_64/eclipse" report="C:/api/report_freeze.xml" excludeList="C:/api/exclude.list" /> <apitooling.apifreeze_reportconversion debug="true" htmlfile="C:/api/report_freeze.html" xmlfile="C:/api/report_freeze.xml" /> </target></project>I don't remember about the way incompatible changes are shown compare to compatible changes. I modified the report to list the actual message from the delta which is more meaningful when you get something listed.Let me know what you think.(In reply to Olivier Thomann from)So far we only showed incompatible ones. I would expect to render them in either different sections or in different color.(In reply to Dani Megert from)No, so far we were reporting compatible and incompatible ones. I made changes to make sure we report incompatible ones with a red background color.(In reply to Olivier Thomann from)Mh no, otherwise this bug would have been obsolete.(In reply to Dani Megert from)I will attach a new report where you can see compatible and incompatible changes. We used to filter some of the compatible changes that we should not have filtered, but some compatible changes were already shown properly.Creatednew report formatCreatedUpdated patch to put incompatible changes in red(In reply to Olivier Thomann from)The red color makes it hard to read the text and hurts my eyes ;-)(In reply to Dani Megert from)What do you propose? It was the idea to hurt eyes as these ones should never happen.(In reply to Olivier Thomann from)I would use bold and explain at the top that bold means breaking.Just to clarify: that example report does not use the exclude_list.txt:?CreatedMessage not found in report_freeze.htmlI get this with this patchADDED Message not found for id: 0 REMOVED Message not found for id: 0delta.getFlags returns 68 which doesn't have a matching id. So 0 is returned.Also in IDelta, public static final int TYPE_ARGUMENT = 68;My suggestion would be white against red background td.incompatible { background-color: red; color: white; }Since freeze report and deprecation report baseline will be no longer changed for 4.6, moving this to 4.7	37.0
id=502360	REOPENED	Platform	Runtime	4.6	All All	P3 enhancement	Stefan Xenos	2016-09-28 02:57 EDT by	Lars Vogel	2017-02-01 15:51 EST (	12 users	Currently the platform plug-ins use a multitude of API to write their logs* AbstractUIPlugin#getLog * Activator.getDefault().getLogService() * InternalPlatform.log* org.eclipse.e4.core.services.log.Logger (e4 services)* org.eclipse.core.databinding.observable has a Policy class for logging* RuntimeLog.logand most likely more.AFAICS we do not have public API for writing log statements, and I think using the activator for logging is bad, as we have seen that activators can affect the performance.I suggest to define a simple API with static methods for logging.	It's not only bad for the core e4 bundles it even forces them to run on OSGi and even worse only on equinox! So if we add a logging API it must be located at a bundle who can run even without OSGi!(In reply to Lars Vogel from)If you don't plan to get rid of the old API, then introducing new API (aka "standard") will result in this:(In reply to Szymon Ptaszkiewicz from)Once we have new API, I plan to replace all internal API calls and if we can @Deprecate inferior API.(In reply to Thomas Schindl from)Sounds good. Any concrete suggestions how to implement this?(In reply to Szymon Ptaszkiewicz from)+1000If we will do this, exact this will happen.Introducing new API must go on along with deprecation of old API's.This will however affect everyone, so it must be coordinated task for all projects on eclipse.org. I don't think this is doable.Please also check xtext, jgit etc projects - they are using log4j and slfj additionally to existing Eclipse API. I don't think they will ever move to *another one* logging framework.(In reply to Andrey Loskutov from)See.That is not the topic of this bug.(In reply to Lars Vogel from)So you want to introduce new *public* API just to fix calls inside Platform/SDK? That sounds like a terrible trade-off. Also, the fact that you deprecate API does not mean you can stop maintaining it so you will have more work if you introduce new API. Fixing only Platform calls is a very small gain compared to the overhead and confusion you will get by having yet another logging mechanism.In the old days, there was a principle in Eclipse that it is better to have small but complete API rather than large and thus hard to maintain API with different variants of the same method/mechanism. We should still follow this principle.Adding Tom who already fixed a number of issues to unify logging in Eclipse.(In reply to Szymon Ptaszkiewicz from)No, other plug-ins can and should also use this, if this API is better. Like I said earlier, AFAIK we do not have public API for logging except the Activator approach, which I think is bad.That sounds like a terrible trade-off. Also, the fact that youHence this bug, to discuss and find the best solution.Thanks.(In reply to Andrey Loskutov from)Please note that API is not only for eclipse.org projects. The number of non-eclipse.org API consumers is a lot bigger than those inside eclipse.org. Even if we move the whole eclipse.org to new API, this will not be even half of the work needed to get rid of the old API, so it's even less doable.(In reply to Lars Vogel from)They *can* but *do not* have to, so you will get more mess than we currently have. See.Well, sure, but the bug summary andsay you want to add new API not that you want to discuss how to improve the current situation. New API is not a silver bullet that fixes all problems.Having said that, I'm all eyes and ears to discuss how to improve the current situation.(In reply to Szymon Ptaszkiewicz from);-) That is what we do, we discuss in bug reports. Also the following fromcould have been a good pointer:If I already have usable API which allow us to replace all the non-API calls without Activators, that would be great. But I'm not aware of such. And the platform code basis also seems not aware of this.Usable means, that the plug-ins don't have to write boilerplate code to query the OSGi registry.Even Equinox is kind of inconsistent with regards to logging. There are:- OSGi LogService- Equinox ExtendedLogService- org.eclipse.equinox.log.Logger (most likely used internally for logging, e.g. via FrameworkLog)These use the OSGi LogService:- Activator.getDefault().getLogService()These use the Equinox ExtendedLogService:- AbstractUIPlugin#getLog() (actually Plugin#getLog())- InternalPlatform#getLog()These use Equinox FrameworkLog:- InternalPlatform#getFrameworkLog()- org.eclipse.e4.core.services.log.LoggerFrom what I can see the FrameworkLog in the end uses the ExtendedLogService which is the implementation of LogService and Logger in one.Why are there so many different loggers? From what I see we have the following use cases:1. Log a simple statement (can be done by anyone)2. Log an error/throwable (can be done by anyone)3. Log a message associated to a ServiceReference (that is actually the OSGi LogService)4. Log additional information like bundle name, context and stuff. This seems to be the reason for FrameworkLog which is used by org.eclipse.e4.core.services.log.Logger, which allows to log an IStatus (that is transformed to a FrameworkLogEntry).I tried to follow path 4 through the code, which was really confusing. The ExtendedLogServiceImpl is an ExtendedLogService and a org.eclipse.equinox.log.Logger. By calling one log statement I needed to follow multiple steps down the stack just to jump always again inside the ExtendedLogServiceImpl and at the very end to a LogReaderServiceFactory.It looks like regardless which API we are using right now, in the end we land in the ExtendedLogServiceImpl which in the end is an OSGi LogService.Inside platform we need all the use cases, so probably we need an API that supports methods for all the cases. It needs to be located in a common bundle and the implementation is specific to the environment. E.g. for Equinox we can utilize FrameworkLog or ExtendedLogService directly. We need to check the details. For other OSGi frameworks the LogService is used. In case of non-OSGi the implementation needs to use some logging framework.The main reason for all the logger implementations I currently see is that additional information is requested in the log that should be added automatically, like the bundle name for example.Doesn't seem to be an easy task and some time to think about. But I hope my observations help so we can together find a solution.(In reply to Lars Vogel from)Actually we need something like a LogFactory.getLogger() where the implementation needs to check if we are in an OSGi context, if we are Equinox or not, or if we are plain Java. And then we can operate on the logger. Only static methods won't work as we then don't have a chance to distinguish.(In reply to Dirk Fauth from)See(In reply to Thomas Schindl from)That is what I had in mind. Well at least to some extend as I didn't got a full picture.The question is, could it be extended to support logging with ServiceReferences or context objects like FrameworkLogEntry? Because we have quite a lot of logging statements that log one of these.[...]What is logging with ServiceReferences? You want the API to get a FrameworkLogEntry passed and logs it? So you want Logger#log(FrameworkLogEntry) API?(In reply to Thomas Schindl from)I thought of LogService#log(ServiceReference, int, String, Throwable). But looking into the code it looks like this kind of logging is not used in platform code. And if we need to log inside a service that an error happened we can reference the LogService in there. So we should be able to skip this for the new API.And yes, I would like to have Logger#log(FrameworkLogEntry) and a Logger#log(IStatus). But both rely on Eclipse specific API. So maybe we can have some Logger#log(Object) where the implementation can decide what to do based on the type. So in case of the Equinox implementation we can handle FrameworkLogEntry and IStatus as we probably know them, in other implementations we would simply log Object#toString().Does that make sense?(In reply to Dirk Fauth from)I like the concept of the Android logger, it has the following methods:Log.v() , Log.d() , Log.i() , Log.w() , Log.e() v - verbosed - debugi - infow - warninge - errorI think we should have overloaded methods accepting:Log.w(String)Log.w(String, Exception)and the logger could convert that internally to whatever is needed, e.g., IStatus.I think this is also very similar to what the standard Java logger does, see(In reply to Lars Vogel from)I don't like the Android logger concept. Still don't understand what is better in using a single character instead of a small word. I am not a physicist or mathematician and can handle words. ;-)Nevertheless I don't understand what you mean with using only String parameter and internally convert to IStatus. We currently have a lot of log statements that log IStatus and need to convert that into String internally for the log statement. So it is vice versa.(In reply to Dirk Fauth from)What I like about the Android and the Java logger, is that they have methods for error, warn, etc. instead of one method with the first parameter defining the type of log statement.(In reply to Dirk Fauth from)See org.eclipse.e4.core.services.log.Logger and its implementation WorkbenchLogger. There methods do this conversion. IMHO the consumer of the logging API should not work with Eclipse specific objects, but with exceptions and strings for the log description.(In reply to Lars Vogel from)Ah, ok I totally agree with that. And looking at Tom's implementation his API offers both ways. Which IMHO has the most comfort especially with regards to migration to the new API.(In reply to Lars Vogel from)Actually for me it looks like the IStatus and FrameworkLogEntry where mostly intended for internal use. And it looks like you are right that all relevant information could get retrieved inside a log#error(String, Throwable) if it is created via factory (e.g. to get the bundle information of the class that logs). So yes, I think you are right that we don't need a log(Object) but force people to use the corresponding factory and method to get the correct result. Typically this will also result in easier to read code as one does not need to create IStatus or FrameworkLogEntry objects by himself.Sorry this bug has (In reply to Dirk Fauth from)I lost track of which Tom this refers to, pretty sure it is Schindl :)Sorry I am late to this conversation. I will mention that the OSGi LogService API is being overhauled for OSGi R7 to more closely align with slf4j. I have a branch going in Equinox with the implementation. You can see the proposed API at:This has a Logger API with error, warn, etc.(In reply to Lars Vogel from)OSGi DS should be used for that.(In reply to Thomas Watson from)Nice! Is R7 finalized and will oxygen be the R7 reference implementation? Of course I meant Tom Schindl. ;) If we need to use OSGi DS we will likely need some wrapper for the use cases where we are not on the matching layer. But definitely good news! Thanks for the update.(In reply to Dirk Fauth from)At this time I am not planning on Oxygen for R7 because I am not confident the spec will land in time for the rampdown before the Oxygen release. I have been bitten by this before and it resulted in us having a release that implemented a specification of OSGi that was not finalized. Or it required us to do very late changes to the API during release candidates.I'm thinking Oxygen.1 maybe a good time for OSGi R7.New Gerrit change created:IMHO core.runtime is for to high in the stack - we need something far far more down which can be used by ANY bundle in core.e4 whether it runs on Equinox, Felix, ... or outside OSGi.(In reply to Thomas Schindl from)This seems an unrelated request. Please open a new bug for support of Felix or non-OSGi as runtime(In reply to Lars Vogel from)hm your initial comment includes:- org.eclipse.e4.core.services.log.Logger- org.eclipse.core.databinding.observablewho have their own logger - and you want to consolidate that. Now the API is proposed in core.runtime so all of those need to run on OSGi which is at least for databinding.observable just plain wrong because it has been designed to run without OSGi from day one. I also question that the e4-API (and implementation) has to have a hard dependency on core.runtime (and with that Equinox) - which is something Dirk worked quite hard since some time.(In reply to Thomas Schindl from)Both depends on equinox.common. Does equinox.common not require equinox?No, OSGi does not need to run. FYI JFace also requires equinox.common. If you want to consolidate logging for Platform projects you need:a) something very very low in the stackb) has to work outside OSGi so that "bundles" designed to run outside OSGi can also make use of it(In reply to Thomas Schindl from)I think Stefan suggested to have one "simple to use" logging API in core.runtime and another one in a lower level based on OSGi logging. But I leave it to Stefan to clarify that.Perhaps I didn't explain well enough in my patch notes but my patch wasn't intended to be a new logging service -- it was just intended as a more convenient way to access ILog, so that we can remove the various logging methods that seem to get attached to every plugin activator.I know this isn't exactly what Lars requested in, but it is what he requested during the platform summit at EclipseCon on Monday.I must not have explained properly - I was suggesting that we have one API here for logging and a second API at the lower level for constructing IStatus instances and CoreException objects. This would be the only new logging class.(In reply to Stefan Xenos from)So you suggest to reduce the 6 different APIs to two different APIs? Surely an improvement, but we can do better, don't we?(In reply to Dirk Fauth from)Ca you provide a concrete code suggestions via Gerrit?(In reply to Lars Vogel from)I openedand await further information from Tom on that ticket. IMHO that API is complete AFAICS, it is already in use in productive projects, so it is tested and mature, it contains concepts for retrieving a logger in various scenarious (DI, DS, factory). And it contains methods to cope with the always discussed debug String concatenation and reference holding topic by using Java 8 semantics with functional interfaces.In short, I would like to use something existing rather than creating something new. If we can agree on that API and add it to Equinox Common, we could satisfy multiple "stakeholders". We then need to conform on where to put the default implementation to. But I also hope Tom will give us a direction.Related to your question, yes I will provide a suggestion via Gerrit after the clarification on the linked ticket.Re:proposes a new logging abstraction to sit on top of several other frameworks. This bug proposes some convenience methods for accessing the existing ILog framework. These are two separate problems, not alternatives to the same problem. The presence of convenience methods for accessing ILog doesn't negate any utility offered by a new abstraction... and even if we had a new abstraction, convenience methods for ILog would still be helpful for those API clients that still wish to use it.Please, let's disentangle these two issues.IMHO we need to specify clearly the intention of this ticket, the proposed API and the correlation to a common logging API. We are discussing in different directions and therefore don't come to a conclusion.From my understanding (and please correct me if I'm wrong) your intention is:a) create one common API for logging in platformb) make the API very convenient so it can be easily usedc) reduce boilerplate from plugins that only log in exceptional circumstancesPros:1. Remove LogService references from Activators (which could lead to removing even more Activators shortly)2. Deprecate additional loggers like o.e.e4.core.services.log.Logger which in the end also just uses the ExtendedLogService.3. Have a smaller memory consumption compared to creating and keeping a log instance per class when there is very less logging involved. But honestly that doesn't really count if we use the correct factory which leads to keep the reference to something that already exists and not create a new instance.Cons:1. Additional cost of service lookup on every log2. Introducing a new logging pattern that is different to known logging frameworksTo elaborate my last statement:The well known logging frameworks (SLF4J, Log4J, JUL) work with a name logger instance per class or per whatever .. but at least on a named logger instance. The reason is some slight state - the name of the class or bundle for which something is logged. In Android, where you have static methods for logging which is where you probably got the idea for the API from, you provide that state with every method call. In Android that is called TAG. You now want to provide an Android like logging API with static methods that is probably not very common for most of the typical Java developers.And also for some more comparison, the Android logging mechanism actually works with static methods because you provide the context information and there is no need for additional lookups on the way. We need the additional lookups, which is my concern against the static API.Nevertheless, to get started with consolidating the logging in the platform and the fact that we internally do not log that much, I would be fine with adding it. Reducing the amount of loggers and Activators has an overall higher value ATM than an optimized logging from the beginning.After this is done we can optimize further by for example getting rid of ILog or even replacing the static methods with a factory in a later state.BTW, I think ILog only exists to send the logs also the the StatusManager in the IDE. That said, the usage of ILog is probably incorrect in todays E4 world and we should think about an alternative implementation e.g. using a LogReader service. But to be honest this is only an assumption and it would be nice if someone could bring some light in why ILog exists.I'm now migrating an Eclipse 3.x plugin to E4, and one of the issues I need to solve is how to get an instance of ILog inside the (E4) Activator. I agree with Stefan that we should provide a convenient way to access ILog. I don't think we should stop using ILog. Is it bad practice for plug-ins logging to IDE StatusManager? (As an example, my plug-in analyses JavaCode and send feedback back to the IDE).Two considerations:1. Simplicity and usability. Anyone can write a Logger, but we should have a logger which is simple to create, and flexible enough to be used in Eclipse plugins.// simple to instantiate, flexible to useLogger LOG = LogFactory.getLogger();LOG.error("whops: %s ", exception);2. OSGi, Equinox and other contexts. We can use options when creating the logger, to specify the context where we want to use the logger. // Hook OSGi logging. Fail when the plugin is missing.Logger LOG = LogFactory.getLogger("context:osgi");It seems as though we've been avoiding acceptance of the patch attached here while we wait on the outcome of(a new logging framework).Sincedoesn't look like it will come to a resolution any time soon, could we please revisit this patch? If we eventually come up with a unified logging framework, we can redirect the static helper methods to whatever logging framework we eventually choose.I actually found the arguments against ILog fairly compelling, but I also think that the deprecation of ILog and the creation of new static helper functions are orthogonal. We can do both.(In reply to Stefan Xenos from)+1 for merging Stefan patch. The current status for logging leads to otherwise unnecessary activators.Let us merge Stefans patch in M5 and see that we convert some code to use it in M6.Just for the record -1 from my side because I dislike the static design that constantly needs to retrieve state information and assumes runtime state. Once such code is included in the platform we won't get it out anymoreGerrit changewas merged to [master].Commit:Sorry, I missed this comment and submitted (I'd suggest putting a -1 on the code review itself next time). Do you feel strongly enough about this that you want me to revert it?I have two questions about this:1. Why is it a problem to fetch runtime state in code that logs infrequently (specifically: all of Eclipse platform)?2. What would prevent us from removing such code if we ever discovered a problem with it?Let's not pay a real cost in unnecessary boilerplate and plugin activators in order to solve a nonexistent performance problem. Code that has any possibility of logging rapidly doesn't need to (and shouldn't) use these helper functions.(In reply to Stefan Xenos from)Well there was already a -1 set on the patch. So I did not set another one. Will do the next time.Project lead decision. I personally have strong feelings against static helper methods that rely on runtime states. In the end I'm really against singletons and static helper with runtime state dependencies. They are well in 99%, but in 1% of the cases they go wrong and you need to put a lot of effort in it to fix it again. In the OO world it is one of the worst anti-pattern I phased the last years, because it is very easy to get it in without seeing and knowing the impacts, and very hard to get rid of it again.As I said, it is bad in general to have static helper code that depends on runtime states. You only look at it from the infrequent logging capabilities of the Eclipse platform. But it will be public API, so users of the platform will also use it, and then it will become a mess. Typically such static helper are also not very thread-friendly.So I'm more against a general design decision that introduces an OO anti-pattern to a platform.Counterquestion: Why have you such strong feelings against the factory approach every other well known logging framework uses for a reason?The platform rules on backwards compatibility. As I said, if we add such a helper as public API we will probably never get rid of it anymore. Platform users will discover and use it.That statement is IMHO very weak as it doesn't avoid that anybody uses the helper functions for whatever reason and in whatever scenario.IMHO a factory that returns a logger is better, as this would give options to wrap implementations to use whatever logger.(In reply to Eclipse Genie from)This causes compile warnings in our official build:Please fix them.I agree. Could you be specific about what aspect of these new APIs are stateful?As far as I can tell:- There is nothing about them that remembers past invocations.- There is no public API that modifies their behavior in any way.- The order of invocations affects the order in which things are logged (which is an intentional part of any logging API) but otherwise there are no side-effects caused by the order of invocations.- This patch did not add any static variables or singletons of any kind.You're arguing against stateful static methods. Fair enough, but the methods added by this patch aren't stateful.The android logging framework uses static helper methods, so there is at least one counterexample that disproves the claim that every well known logging framework avoids them.I'm against the imposition of factories since it creates a lot of boilerplate in every caller of the logging APIs without offering any practical benefit.The state I refer to is the runtime state. There are assumptions on the state regarding services and contexts. You always refer to the Android logging API. But that API has a very basic difference. It does not try to access any runtime state or context information. Every information needed is provided as method parameter. This is IMHO the correct design for a static method. It is able to get executed without any additional information that needs to be accessed additionally. Your static helper methods only share a similar API, but not the implementation design.We had the same discussion in this ticket before. Stable and reliable implementation design vs. easy to use API. It looks like you and the rest of the platform team already made a decision. IMHO it is a bad design decision from a platform point of view.What assumptions, specifically, are present in my patch that weren't already present before?You introduced a way to statically access these states, log service, bundle context,...Before, the access was not static so the runtime ensured we are in the correct state. With the static approach you could call the methods before the initialization is readyNew Gerrit change created:If there is indeed a new case that might fail, I agree that would be a problem.Help me understand the use-case. In what circumstance could this fail:Log.error(this, "All your base are belong to us");but not this:JavaPlugin.getDefault().logErrorMessage("All your base are belong to us");What is the specific scenario where the former would fail but not the latter? Can you write a unit test that demonstrates this case (or provide an outline of what that unit test would look like)?No I can't. From a plain Java OO perspective the second statement is even worse! Looking at the implementation the static field is initialized in the constructor. So again there is an assumption made on the runtime state that nobody will/can access the code BEFORE it is initialized.Easy in this case as this class is the Activator, and before any class can access a class from the Bundle, the Activator needs to be called. But what if code is executed before. In some OSGi hooks or other low level OSGi calls.My point of view is the platform character and the introduction that makes it easy to fail in some special cases. I think we should make things better and more stable, and not to introduce API that only doesn't make it worse.I have such strong feelings about the static implementation design because I worked on several projects that used the same "easy-to-use-static-API" approach in various ways. And they always failed at a certain point of time because static access to runtime states is an anti-pattern designed to fail in a multi-threaded environment.To make it clear, I don't see a concrete use case now that could fail. As I said, maybe some low-level OSGi calls like hooks or something similar. Some multi-threaded stuff, e.g. heavy logging in an immediate DS component at the same time as in an Activator.Gerrit changewas merged to [master].Commit:I agree. So replacing the second version with the first would be an improvement then, yes?Would you argue that Math.max is a design flaw? Or just those static methods that expose shared mutable state - like ResourcesPlugin.getWorkspace()?You keep making arguments against singletons and shared mutable state. Arguments I wholeheartedly agree with.To convince me that this patch is undesirable, you don't need to convince me that shared mutable state and singletons are bad (I'm already convinced). You just need to demonstrate one way in which the patch introduces some shared mutable state or a new dependency on some existing shared mutable state.If you can't do that, none of the arguments you're making against shared mutable state apply to this patch.We shouldn't refrain from fixing a real problem because of a (valid) general principle that doesn't actually apply to this specific case.(In reply to Dirk Fauth from)I'm deeply confused. JavaPlugin.getDefault().logErrorMessage("All your base are belong to us"); is the standard way to do logging in Eclipse. Did you mean to say that Log.error(this, "All your base are belong to us"); is an improvement compared to JavaPlugin.getDefault().logErrorMessage but that it is sill not good enough?If you meant something else, I'll appreciate if you can explain it.Does Math.max depend on a runtime state of some framework? From what I know Math.max gets all informations it needs to operate on.Just because it is the standard way it doesn't need to be good. As I said, from the Java OO perspective it is wrong to have static methods that are used to access state informations, which is in the JavaPlugin.getDefault() case really wrong, because it only works in the OSGi context with the Activator. Well, it only works if you don't use DS components that would use the same mechanism to log, as DS components are started in the SCR thread, so (haven't tested it) but it could lead to side effects if the DS tries to log on startup while the Activator is created.So what I say is that both approaches have the same bad design, as they provide state access via static methods. I would not say that the one is better or worse than the other.(In reply to Dirk Fauth from)Thank you for the clarification. What do you propose to improve the situation?(In reply to Sergey Prigogin from)I made proposals already which you can find in the comments. They were all declined either because of "boilerplate code" or because osgi R7 will introduce a new logging api.(In reply to Dirk Fauth from)Sorry, my comments regarding alternatives and more detailed remarks about the static Log API in this patch are in.There Stefan said that with his benchmark the static Log API is only 2.3% slower than the current approach. And since we internally do not log much, it is not a problem.In my opinion the current approach is already not good, and creating some nice API around the old stuff doesn't make it better. Even worse as it makes it easier to consume.Again a remark on the context retrieval on every logging call. Despite the log level that is currently active, the Bundle is retrieved. To do this either the low level OSGi API FrameworkUtil is used (can't tell much about that performance as it operates on ClassLoader level) or the deprecated PackageAdmin. Looking at PackageAdmin#getBundles() you see that operates on the wiring, then inspects the capabilities by iterating over them and then sorts a list of found bundles. And the sorted list is then returned as an array. Sure maybe not a big deal in platform code as our bundles are mainly singletons, but consumers could face issues with this.Also Bundle#getSymbolicName() could introduce a memory barrier. If you follow the road down to org.eclipse.osgi.container.ModuleRevisions#getCurrentRevision() there is a synchronized code block.So in a multi-threaded environment I assume issues with the new static API design.And again, probably it doesn't make a difference now in platform internals. But the API is introduced as a new public API. It is easy to use (which was the intention) therefore consumers of the Platform will find and use it (should be the intention of public platform API). And then at a certain point of time when some users are doing stuff we totally did not expect, things will get messy. And telling the users then that in such a case they should use something else and follow some rules on using the API will make it a "Gremlin API". Looks nice and cute, but you need to follow some specific rules, otherwise it is getting very ugly.I personally would wait for R7 and start the whole refactoring stuff of the logging with the new OSGi logging API, rather than introducing new public API that has design flaws from the beginning. Especially because we won't get rid of it anymore because of the backwards compatibility rules.Also note that even the R7 logging API uses the factory approach as far as I have seen.(In reply to Dirk Fauth from)I fully agree with this. And yes, the R7 API uses the factory approach as does the current Equinox LogService.(In reply to Thomas Watson from)+1.Regarding the static helpers, JDT UI is not a valid example since that bundle is a singleton bundle, hence it's OK to always use the single activator to access the log. Other bundles that are not singletons can run several instances inside the same VM, hence static access is a no go.Another thing to consider/investigate when really adding yet another logging API is whether one could do this via dependency injection.Please explain the connection between those two statements. Why would the presence of multiple instances prevent the use of a static helper method for logging?System.out.println(...) works fine no matter how many bundle instances you have. Why would it be impossible to write something similar that writes to the Eclipse log rather than stdout?Re:If there's a design flaw, please identify it.Your comment suggests the possibility of performance problem, but our current benchmarks indicate that there is no such problem. The proof of a performance problem is a benchmark, not unsupported assertions.Even if we did discover a performance problem in some corner case we didn't test for, we should be able to fix any such bottleneck by keeping a cache that maps Classes onto ILog instances... or by attaching additional metadata to the classloader to avoid extra lookups. Neither would require changing this API.Re:Let's discuss this. Why is it that you find additional lookups to be bad? That seems to be the key to why you dislike static methods. Presumably, by additional lookups you don't just mean "has an implementation that does some stuff" since that applies to the Android one, too. I'll try take the most charitable interpretation and assume you mean both of the following:1. "additional lookups" -> Has an unacceptable performance cost.2. "additional lookups" -> Relies on external state that may cause it to fail.Is this what you mean by additional lookups? If so, let's dig into this and figure out if it's actually the case. If not, please explain what it is about additional lookups that you consider to be bad.If we could come up with static utility methods that did not have such problems, would you find it acceptable? For example - the existing Android logging APIs taken verbatim. Are those acceptable to you? Or is there another reason you dislike static methods?New Gerrit change created:I'll revert the new API pending resolution of this discussion.(In reply to Stefan Xenos from)This writes everything to one channel for all bundle instances. The logging for different bundle instances need to go to different logs. I don't think your static methods will handle this. But I admit, I did not do a code review.Gerrit changewas merged to [master].Commit:(In reply to Stefan Xenos from)There seems to be a slight misunderstanding here. I don't dislike static methods in general. I dislike static methods that need to retrieve additional information to work correctly. Especially if that information is a runtime state, which costs time and as I wrote in a previous comment also has a memory barrier.So yes your assumptions on the "additional lookups" is correct. Retrieving the BundleContext and then reading the bundle symbolic name for every log statement is an unnecessary and IMHO risky operation if it is done for every log statement.And yes the Android API is acceptable because it is able to do what it is intended to do without the need to read some external state. Therefore yes, if you have an idea how we could provide the necessary information for every log call from the outside and not need to retrieve it everytime, it would be ok. But actually that would introduce boilerplate code on the consumer side of such an API. So we would not win anything. That is actually the reason why I suggested to use a factory, as the necessary context information would only need to be retrieved once.But as of now I think waiting for the R7 implementation and then do some major refactoring should be the way to go.	72.0
id=495016	REOPENED	Platform	UI	4.4.1	PC Linux	P3 normal	Oleksandr Zakusylo	2016-05-31 08:40 EDT by	yasodha rmsh	2017-01-23 11:44 EST (	5 users	type 'h' in the quick access bar.resize the pop-up quick access window so that horizontally, the size is less than the lines of text seen.A horizontal scroll bar appears. The scroll bar that appears, when scrolled all the way right, still does not reveal the full text.Also, the scroll bar does not appear directly at the point where text is being cut off on the rightAlso. Vertical scroll bar flickers on and off upon resizing of Quick Access pop-up. Potential to miss items at the bottom of the list because there is no scroll bar to get to them (unless you know to resize your window) Size of Quick Access pop-up box is persistant; user can forget the window is too small.	New Gerrit change created:Gerrit changewas merged to [master].Commit:Thanks, Oleksandr. It's a great fix!in master now.I assume this one is fixed with the comment. Please reopen if that is wrong.This caused bad regressions and got reverted, see.(In reply to Dani Megert from)I'm pretty sure the ultimate cause forwas the removal of the display.timerExec(..) in the controlResized(..) method. But the timerExec was just a hack for an utter design failure.The underlying problem is much deeper: QuickAccessContents#createTable(Composite, int) creates a non-virtual table, and then adds a ControlListener that effectively tries to implement a virtual table. The implementation gets into a vicious circle:The controlResized callback calls QuickAccessContents#refreshTable(..), which removes and creates TableItems. Table#remove(..), new TableItem(..) etc. call Table#setDeferResize(false/true) which eventually sends an SWT.Resize event that triggers the code at the beginning of this paragraph again.The widget disposed exception happens because the TableItem that should have been created in QuickAccessContents.java:354 already got disposed by a another call to QuickAccessContents#refreshTable(..). StackOverflowErrors are another natural consequence of this uncontrolled recursion.With the timerExec, we were more often lucky that the user didn't have a chance to type additional characters at the same time Quick Access tried to refresh the table.To avoid further breakage, we should not touch Quick Access any more, but rewrite it using a virtual table.(In reply to Markus Keller from)Thanks for the Analysis. I added(enhancement) to track your suggestion.Mass move. Please move to a concrete milestone if you plan to work on this item.	8.0
id=326046	REOPENED	JDT	Core	3.7	PC Windows XP	P4 minor	Ayushman Jain	2010-09-23 09:04 EDT by	Krzysztof Kazmierczyk	2010-09-30 08:55 EDT (	3 users	Build Identifier: I20100805-1700When developing code I encountered silly messages produced by Eclipse compiler. See steps to reproduce.Reproducible: AlwaysSteps to Reproduce:1. Create new Class2. Insert into class following method:private void printProperties(OleAutomation document2) { for (int i = 0; i < 10000; i++) { final String name = document.getName(;) if (name != null) System.out.println(i + " " + name); } }(you must import OLEAutomation class).3. You have syntax error token/misplaced constructor in the line "for (int i = 0; i < 10000; i++) {" and other silly errors in next lines despite the fact given line is correct	Createderror message screenshotIt is indeed difficult for the parser to infer what exactly was yourintention, in order to report the error at the exact location where youerred. However, the error location does include: "final String name = document.getName("which is not a valid statement but it is terminated with ";"Isn't that enough of a hint for what's wrong here?The only issue I see is that the problem marker has to be set fora specific line of code, whereas the problem location actually spanstwo lines.This is about what the error recovery can do. There is no perfect solution there and this is not something on the plan right now.In your case, given the reported markers it is quite easy to spot the syntax error even if the messages are not great.No plan to improve that right now. If you want to provide a patch, feel free to do it.Closing as WONTFIX.Oliver, what about such code: private void printProperties(OleAutomation document2) { for (int i = 0; i < 10000; i++) { System.out.println("koko"); int b = 0; while (true) { b++; } final String name = document.getName(;) if (name != null) System.out.println(i + " " + name); } }Do you think that in such code still be easy to find where exactly error is?Feel free to close it again if you are not going to fix it.Ayushman, please investigate if the last case can be improved.If you remove the "for statement" (for line + closing brace), the reported error is much better.This is time permitting.	5.0
id=487758	REOPENED	JDT	Core	4.5	PC All	P4 enhancement	JDT-Core-Inbox	2016-02-12 12:17 EST by	Christoph Nievergelt	2016-03-19 13:09 EDT (	3 users	The Parser does not accept the following code:import java.util.HashMap;import java.util.Map; public class Bug { private static final Map<String , String[]> FONT_FILES = new HashMap<String , String[]>() { private static final long serialVersionUID = 1L; { super(1); put("Key", new String[]{"Value1", "Value2"}); } }; }but complains that super must be at the beginning of a constructor.When you run the code (disregarding the IDEs warning) the code runs just fine and invokes the appropriate HashMap constructor.	The code example contains no constructor declaration. What you wrote is an "instance initializer", cf.An explicit constructor invocation (like "super(1)") can, however, only occur within a constructor declaration.When ignoring the error message, this is the implicit constructor I see in the byte code: Bug$1(); descriptor: ()V flags: Code: stack=3, locals=1, args_size=1 0: new #13 // class java/lang/Error 3: dup 4: ldc #15 // String Unresolved compilation problem: \n\tConstructor call must be the first statement in a constructor\n 6: invokespecial #17 // Method java/lang/Error."<init>":(Ljava/lang/String;)V 9: athrow LineNumberTable: line 9: 0It will not invoke a HashMap constructor, but abort the program via a java.lang.Error.FYI, there doesn't seem to be a direct workaround, because anonymous classes cannot contain explicit constructor declarations. If you need an explicit constructor, use a name class (may still be local to the current method).Verified for Eclipse Neon 4.6 M6 using Build id: I20160315-2000(In reply to Stephan Herrmann from)Sorry StephanI did not realize your response to my bug report until now (didn't expect that fast a response).You are correct, that my code is faulty and Eclipse should treat it accordingly (I can no longer recreate the conditions that allowed me to step in the debugger into the HashMap constructor :-<).You are also correct about the instance initializer.However, the error message "Constructor call must be the first statement in a constructor" is certainly misleading; something along the lines of "Constructor call must be the first statement in a constructor (anonymous classes cannot have explicit constructors)" would be less confusing.But it would be really great, if the message could help developer to find the correct solution, which is to place the constructor parameter(s) in the bracket of class instance creation expression, like so: private static final Map<String , String[]> FONT_FILES = new HashMap<String , String[]>(1) { private static final long serialVersionUID = 1L; { put("Key", new String[]{"Value1", "Value2"}); } };as explained in paragraph "15.9.5.1. Anonymous Constructors".So, yes, there is no workaround, but there is a (little obscured) language construct and a message like "Constructor call must be the first statement in a constructor (anonymous classes cannot have explicit constructors; actual arguments for the implictly declared anonymous class constructor have to be given in the class instance creation expression)" would lead the developer to the solution and a better understanding of the language (researching this topic certainly did for me :-).I also found that I'm not the first person to complain about this:OK, we could debate whether this is still the same bug.Instead I adjusted title and some meta data to reflect the updated RFE.The given message is not wrong (you placed a super-ctor call in a wrong location and the message tells you so), but I agree, that the message could be more specific, e.g., in telling which part of the requirement ("first statement in a constructor") is violated (like saying "but this is not a constructor" :) ).I wouldn't, however, consider this situation wide-spread enough to motivate putting a recipe for correction into the error message. If recipe, JDT would typically do this by offering a quick fix, but I don't really see us going so far.	4.0
id=376339	REOPENED	Platform	Releng	4.2	PC Linux	P4 normal	Platform-Releng-Inbox	2012-04-09 13:21 EDT by	David Williams	2016-08-11 15:27 EDT (	1 user	At least eclispebuilder (base builder less important, since I hope its going away before Juno). If I had to guess, this is just a matter of adding a new line to repositories.txt.Something like (eventually) git://git.eclipse.org/gitroot/platform/eclipse.platform.releng.eclipsebuilder.git master(FYI, I think no rush, since its been undergoing to many changes ... but ... it will start to slow down soon).	What the heck, trying it now. (Still using R4_2_primary) which will have to change to "master" once we fix that.Note sure what to do here. Didn't work as expected, but more I think about it, not sure of best approach .... we already have the eclipsebuilder checked out for the build ... we could just tag it. ... and ... not sure it's right to automatically tag when changed. Seems for reproducibility we might want to tag "manually" and then pull that particular version for a particular build.FYI, when I tried to tag using "autotagging" besides adding line to repositories.txt .... after seeing that alone didn't cause tagging .... added a "fake" map entry. but, was getting a "hung up" message: So, obviously, something not specifiedf right? (Or, maybe impossible with a "root project"? /shared/eclipse/eclipse4/build/supportDir/gitCache/eclipse.platform.releng.eclipsebuilder /shared/eclipse/eclipse4/build/supportDir/gitCachefatal: The remote end hung up unexpectedlyDoing a mass "reset to default assignee" of 52 bugs to help make clear it will (very likely) not be me working on things I had previously planned to work on. I hope this will help prevent the bugs from "getting lost" in other people's queries. Feel free to "take" a bug if appropriate.	4.0
id=366606	REOPENED	Platform	UI	4.2	PC Linux	P4 normal	Lars Vogel	2011-12-13 14:10 EST by	Paul Webster	2016-04-20 12:16 EDT (	3 users	Createdfailure stack tracesTests: 9/9 Errors: 0 Failures: 4	page.showView(partid) creates and activated the part, but it doesn't appear to update the active contexts.Failed:org.eclipse.ui.tests.contexts.Test.testPartIdSubmission()org.eclipse.ui.tests.contexts.PartContextTest.testBasicContextActivation()org.eclipse.ui.tests.contexts.PartContextTest.testContextActivation()org.eclipse.ui.tests.contexts.PartContextTest.testPageBookPageContextActivation()(In reply to)If the event is spun, then these tests pass for me. This is because our context changes are dispatched asynchronously by the UpdateExpression in ContextService.has a similar problem but will need the change forreverted first because the N copies of ContextAuthority is causing problems.ByPWIt causes wonkiness when you have 2 workbench windows open.I've reverted the change in master.PWDoes this cause functional issues or is it just that the tests are failing ?If the latter then we should likely defer...This is a functional issue, that can effect anyone using o.e.ui.contexts (keybindings, most of Debug and CDT, etc).PWThis is down to org.eclipse.ui.tests.contexts.Test.testPartIdSubmission()It can be deferred to 4.3PWMass move to 4.7 as M7 is approaching. Please move back in case you are planning to fix it for Neon.	8.0
id=133626	REOPENED	JDT	Core	3.1	PC All	P4 normal	JDT-Core-Inbox	2006-03-28 12:58 EST by	Adam Kiezun	2011-03-29 09:14 EDT (	0 users	3.2M5aI want to rule out the use of HashSet (to eliminate non-determinism, we moved all our code to LinkedHashSet, which is a subclass of HashSet).In 3.1 the restriction was OK.In 3.2M5a the error seems too eagerly reported.It complains about LinkedHashSet<Integer> s= new LinkedHashSet<Integer>();s.add(2); //complains hereI'd like to have an option to make it not complain here - there's no direct access to HashSet in the code)	not a big deal since it actually resulted in better code:Set<Integer> s= new LinkedHashSet<Integer>();s.add(2); //ok nowMight be related to.In 3.2, we did propagate access restriction on members, and thus though you restricted access to HashSet, you are still using its members indirectly through inheritance.There are situations where this is simply wrong (think of public class extending an internal one, and you want to prevent reaching inside by mistake). This however feels like #add() is part of the standard contract to use. We discussed this, and post 3.2 we may want to consider method overriding/implementing public contracts to be considered as non restricted.Will look at it post 3.2.LATER is deprecated.	5.0
id=30314	REOPENED	Platform	UI	2.1	PC Windows XP	P4 enhancement	Platform-UI-Inbox	2003-01-27 12:33 EST by	Nick Edgar	2016-04-25 15:17 EDT (	2 users	build I20030115Now that ArrayContentProvider has been added (see), we should check to see where we can use it in the workbench.	DeferThere are currently no plans to work on thisI did a quick text search for the usage of "new IStructuredContentProvider" and I think in lot of place it can be easily replaced by the usage of ArrayContentProvider.Mass move to 4.7.	4.0
id=209177	REOPENED	Platform	Resources	3.3	PC Windows XP	P4 enhancement	Platform-Resources-Inbox	2007-11-08 08:02 EST by	Walter Brunauer	2015-04-01 09:50 EDT (	2 users	Build ID: M20070921-1145Steps To Reproduce:1. Create a simple project.2. Link in any file into the project.3. Delete the file.-> Within an implementation of an IResourceChangeListener for IResourceChangeEvent.POST_CHANGE, retrieving the location of the file from the IResourceDelta within resourceChanged() returns an absolute path consisting of the project root location (instead of the link location) and the project relative path.Expected behavior:The location should still be the real location.	I can reproduce it on 3.4 M3 as well.The issue here is that the delta is created when the store for the linked file doesn't exist. That's why FileSystemResourceManager returns such a strange location for the resource.Actually it's behaving as the API states. If you look at the javadoc for IResource#getLocation, you can read* If this resource is a linked resource under a project that is open, this* method returns the resolved path to the linked resource's local contents.* This value will be null in the case where the location is relative to an* undefined workspace path variable.* If this resource is a file or folder under a project that exists, or a* linked resource under a closed project, this method returns a (non-* <code>null</code>) path computed from the location of the project's local* content area and the project- relative path of the file or folder. This is* true regardless of whether the file or folders exists, or whether the project* is open or closed.You are trying to get the location for the file that is already deleted. It results in a non-null path computed from the location of the project's local content area and the project-relative path of the file or folder.That's a matter of interpretation, I guess:-)What option do I have to get the real location of a linked resource, if it is going to be deleted? Is there any notification before the resource actually gets deleted?I can't see such an event in Resources. The only one that sounds interesting is PRE_DELETE, but it works only for projects.Maybe having PRE_RESOURCE_DELETE would help.Changing summary to reflect the real issue. Others have done this by listening to resource change events as resources are created, and maintaining their own table of linked resource locations. It would be useful if we could provide the old location of a linked resource in a POST_CHANGE delta.I am no longer involved in Platform Core development.	7.0
id=54116	REOPENED	Platform	UI	2.1.1	PC Windows XP	P4 normal	Platform-UI-Inbox	2004-03-09 00:37 EST by	Matthew Phillips	2015-02-11 14:13 EST (	4 users	I'm calling TreeViewer.expandToLevel (entry, AbstractTreeViewer.ALL_LEVELS) foritems buried several layers into the tree. This works on the tree before anyitems have been expanded, but after I manually collapse the root of the expandedbranch, calling expandToLevel () again does nothing.The only workaround I've found is to use the code below just before the expand(uses the unsupported TreeViewer.testFindItem () method): for (TreeItem item = (TreeItem)treeViewer.testFindItem (entry); item != null; item = item.getParentItem ()) { item.setExpanded (true); }	*** This bug has been marked as a duplicate of***I just tested this bug, and it is not a duplicate of 57798. The 57798 issue wasresolved by implementing the getParent() method. I am now investigating this one.Reopening as Ines has identified this as being differentFrom the little example that I have run, it seems that when a "TreeExpansionEvent" event is thrown on the item that has been expanded/collapsed in the tree, the state of that tree item is not set properly, or set after the event.I added a listener to the TreeViewer as follows:viewer.addTreeListener(new ExpansionListener());private class ExpansionListener implements ITreeViewerListener { public void treeCollapsed(TreeExpansionEvent event) { System.out.println("Before " + viewer.getExpandedState("One")); } public void treeExpanded(TreeExpansionEvent event) { System.out.println(viewer.getExpandedState("One")); }}This is a weird bug. Here are the 2 interesting scenarios:1- If I expand/collapse the node called "One", and print its state, it does not get updated properly. It prints out "true" when I collapse the node, and "false" when I expand it. Either the node's expansion state is not being set correctly, or it's happening after the event. In which case setting the enablement of the node in the event methods would have no effect. Still investigating.2- If I expand/collapse any node but the one called "One", the expanded state for the node “One” is printed out correctly.I am attaching my sample plug in.Are you also collapsing/expanding the nodes in the "TreeExpansionEvent"? I end up with the same weird behavior whether I set the node "One" to be expanded or not on start up. I am not sure if we are talking about the same bug, but just to be sure, could you attach your sample project so I can compare my test project to yours?CreatedSample plug inSample view to test the expand/collapse events.This seems to be an SWT bug. A bug report has been logged.I had forgotten that in fact I *am* listening to expand events and causing theexpand to occur for all children also eg: public void handleEvent (Event e) { if (e.type == SWT.Expand) { treeView.expandToLevel (e.item.getData (),AbstractTreeViewer.ALL_LEVELS); } }This seems likely to be related to the problem, sorry!I logged an SWT bug about this () and their reply:"This isn't a bug. The state gets set in the operating system after expand orcollapse notification."Apparently, it is not possible to change the state of a node that has just beenexpanded/collapsed in the events methods, since its state has not been updated yet.I am looking at an alternative solution now.Off the top of my head I can't think of a workaround. marking as a dup of 59941 in case you want to get some ideas from the SWT team*** This bug has been marked as a duplicate of***Hello All,I am trying to use the method expandToLevel(TreeItem, level); This doesnt work. Any idea if this bug is fixed?I have got the treeItem by iterating the model. After I get the item, I have this statementtreeViewer.expandToLevel(treeItem, AbstractTreeViewer.ALL_LEVELS);When the tree is initialized, I see that the tree is not expanded to the level I have provided.Any idea? Any thoughts? Any help on this? Please!Thanks & RegardsIrfanThis still seems to a problem. Any suggestions of workaround? Can we use the method TreeViewer.testFindItem()?This bug, as described by the initial reporter, still exists in jface.Test and fix (proposal):	12.0
id=125319	REOPENED	JDT	Core	3.2	PC Linux	P5 enhancement	Ayushman Jain	2006-01-26 07:24 EST by	Maxime Daniel	2012-01-22 07:45 EST (	2 users	Upon experimental v_634a version.The following pattern is much in use in modules that heavily resort to arrays for performance reasons:Object[] a = getArray(); // or whatever, aka parameterint length = a == null ? 0 : a.length;for (int i = 0; i < length; i++) { doSomething(a[i]);}Various flavours are met in source code. While the very simplest case as above can easily be rewritten without sacrifying to performance:if (a != null) { for (int i = 0, length = a.length; i < length; i++) { doSomething(a[i]); }}more complex cases, like multiple loops interspreaded by code that must be executed regardless of the null status of a, are difficult to rewrite.A suggestion would be to somehow recognize that the null status of a is conditioned by length value, and at least that if length is strictly positive, a is non null.A few caveats:- any side effect on length destroys the link; one suggestion would be to require that it be final; the other way round would be recognize side effects on length and break the link just in time; while this is easy for simple patterns, embedded loops, try statements and so on could well prove much more difficult;- the detection of protected zones is not that easy; the simplest case:if (length > 0) is not that useful; more complex cases:for (int i = 0; i < length; i++) call for quite a deal of checking; as a result, it should be expected that rather rigid patterns be recognized and priviledged over equivalents that would escape the recognition...	CreatedFirst proposal - apply to v_634aFour patterns supported for now (see NullReferenceTests #3000 and following):final int l = a == null ? 0 : a.length;for (int i = 0; i < l; i++) { // a not null here}int i;final int l = a == null ? 0 : a.length;for (i = 0; i < l; i++) { // a not null here}final int l = a == null ? 0 : a.length;if (l > 0) { // a not null here}final int l = a == null ? 0 : a.length;if (l != 0) { // a not null here}These are variants around two main patterns. Note the use of final on l declaration so as to lock it into its role of predictor of a nullness.Experimental only (still needs to check a is not modified since l declaration).CreatedSuggested change plus tests - added a constraint: the array must be finalThe rationale here is that we want to make sure that the array does not get modified between the length initialization and its use.Alternative solution would be to leverage the flow info to detect changes, but it is due to place extra requirements on it in terms of space, and it would introduce a computing overhead for somewhat I believe is the exception rather than the norm.Post 3.2.Reopening as P5 (since RESOLVED LATER is deprecated).	4.0
id=148441	REOPENED	JDT	Debug	3.2	PC Windows 2000	P4 normal	Sarika Sinha	2006-06-23 15:24 EDT by	John Arthorne	2015-04-09 05:13 EDT (	2 users	Build: Eclipse 3.2 finalIf I launch an Eclipse Application in debug mode, and then immediately click "Terminate" in the debug view as soon as the button is enabled, I get an error dialog that says "Cannot connect to VM". I also get an error in the log (shown below). Shouldn't you know that the process was terminated by the user and not show an error in this case?java.net.SocketException: socket closedat java.net.PlainSocketImpl.socketAccept(Native Method)at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:384)at java.net.ServerSocket.implAccept(ServerSocket.java:471)at java.net.ServerSocket.accept(ServerSocket.java:442)at org.eclipse.jdi.internal.connect.SocketTransportService.accept(SocketTransportService.java:93)at org.eclipse.jdi.internal.connect.SocketTransportImpl.accept(SocketTransportImpl.java:56)at org.eclipse.jdi.internal.connect.SocketListeningConnectorImpl.accept(SocketListeningConnectorImpl.java:128)at org.eclipse.jdt.internal.launching.StandardVMDebugger$ConnectRunnable.run(StandardVMDebugger.java:78)at java.lang.Thread.run(Thread.java:816)	If we call stopListening() because the launch has been cancelled we should expect the error and ignore it. Need to have fast fingers to reproduce this one. :Dfixed in StandardVMDebugger.Darin, please verifyWas able to reproduce in Build id: I20060711-1100java.net.SocketException: socket closed at java.net.PlainSocketImpl.socketAccept(Native Method) at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:384) at java.net.ServerSocket.implAccept(ServerSocket.java:471) at java.net.ServerSocket.accept(ServerSocket.java:442) at org.eclipse.jdi.internal.connect.SocketTransportService.accept(SocketTransportService.java:93) at org.eclipse.jdi.internal.connect.SocketTransportImpl.accept(SocketTransportImpl.java:56) at org.eclipse.jdi.internal.connect.SocketListeningConnectorImpl.accept(SocketListeningConnectorImpl.java:128) at org.eclipse.jdt.internal.launching.StandardVMDebugger$ConnectRunnable.run(StandardVMDebugger.java:78) at java.lang.Thread.run(Thread.java:816)Terminating the launch/process does not set the progress monitor to cancelled in the launch job.removing 3.3 targetNot planned for 3.3As of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.Sarika, can you have a look to see if we are still not cleaning up the launch job properly?(In reply to Michael Rennie from)Could not find anything specific, Do you have anything particular in mind which you think might be missing?(In reply to Sarika Sinha from)Specifically I was thinking about:"Terminating the launch/process does not set the progress monitor to cancelled in the launch job."I don't see that Terminate cancels the Launch Job monitor.	12.0
id=132875	REOPENED	JDT	Core	3.2	PC Windows XP	P5 major	Ayushman Jain	2006-03-22 13:16 EST by	Eugene Kuleshov	2013-05-07 02:32 EDT (	8 users	Null reference analyzer raizing a false positive on the following code: public static void main(String[] args) { String v = System.getProperty("test"); if(v==null) { System.exit(0); } if(!v.startsWith("a")) { System.err.println("### B.main() "+v); } } Basically System.exit() here should have the same effect as return or trow.	Not really if you follow the standard rules for definite assignment etc...System.exit(...) is just another message send.The nullref analysis is consistent with our conservative data flow analysis in this respect.If you want to make it obvious to the compiler, then write: public static void main(String[] args) { String v = System.getProperty("test"); if(v==null) { System.exit(0); return; // cannot be reached for real due to #exit(...) call } if(!v.startsWith("a")) { System.err.println("### B.main() "+v); } }(In reply to)Philippe, I don't think it is acceptable to add return after System.exit(). I'd agree that using system.exit() in first place is moveton, but this particular warning appeared in some legacy code I am not allowed to touch and yet I see this warning. I believe it is reasonable to take into account that stis call can terminate JVM execution.This might well imply a separation between the current flow analysis and the null flow analysis, which is due to be expensive at runtime. Currently, the null analysis leverages the knowledge the flow analysis has of dead branches. But the latter is commanded by the JLS, which is fairly conservative and doesn't know about System.exit(). This hence implies that we introduce 'null only dead branches', and recraft the whole logic. I would rather not do this without considering other needs for refactoring as well.Post 3.2.Since this one is due to be expensive, I'd rather leave it to more comprehensive static analysis tools and close it as WONTFIX.Philippe, what do you think?Reopening as P5 (since RESOLVED LATER is deprecated).***has been marked as a duplicate of this bug. ***(In reply to comments 4,5 and 6)How about adding System.exit(), Runtime.getRuntime().exit() and Runtime.getRuntime().halt() as always throwing an exception to the normal flow analysis, marking code behind calls as dead code? The assertion that these methods methods don't return normally should be true for the foreseeable future.API specification from Sun specifies clearly that System.exit never returns normally:)In addition to this, there is no way to return a specific error code and exit the JVM, so you can't really replace the System.exit() calls with something else.So in light on these, System.exit() should have just the same effect as throw.This problem makes the "potential null pointer access" warning give false positives.Switching off that warning for now and adding my vote:Eclipse really lost the momentum.After encountering this bug, I somehow knew there is already a bug open for it. and I somehow knew no one gives a shit.the bug is now over 7 years old.	12.0
id=129907	REOPENED	JDT	Core	3.2	PC Windows XP	P5 normal	Ayushman Jain	2006-03-01 04:35 EST by	Martin Aeschlimann	2012-09-21 10:46 EDT (	2 users	20060301I think the new null reference is really useful. It has some fails positive though. In our code most of these result from the following pattern:ISourceRange range= fSuperType.getSourceRange();final boolean sameUnit= range != null && fCompilationUnit.equals(fSuperType.getCompilationUnit());if (sameUnit) { int x= range.getOffset();}sameUnit can only be true range != null(I'm aware that this is a complicated case)	Thx for the kind words.We are considering making some patterns special (seefor example). My first attempts to do something around the topic are encouraging, but please do not take it as a commitment.***has been marked as a duplicate of this bug. ***Post 3.2.Reopening as P5 (since RESOLVED LATER is deprecated).	4.0
id=140766	REOPENED	JDT	Core	3.2	PC All	P5 enhancement	Ayushman Jain	2006-05-09 06:45 EDT by	Maxime Daniel	2012-06-23 09:11 EDT (	2 users	Some queries are typically used in a cascaded manner throughout the null reference analysis (like 'if (flowInfo.isDefinitelyNull(local)... else if (flowInfo.isPotentiallyNull(local)...). Grouping such calls into a singe query that returns a composite state and using masks to analyze the said result should improve time performance.	CreatedSuggested change + testsPromising prototype. Needs to be hardened before release. Preliminary perf tests show an improvement.Post 3.2.Still seems valid, but incurs some more complexity when dealing with usage in the code. May also consider a multi-dimensional array for the indexed values instead of shifting by different positions.Philippe, what do you think re. 3.3?Reopening as P5 (since RESOLVED LATER is deprecated).	4.0
id=84101	REOPENED	JDT	Core	3.0.1	PC Windows 2000	P5 normal	David Audel	2005-01-31 18:41 EST by	Stu Pidasso	2007-09-21 06:27 EDT (	1 user	Hi,I searched through the bug list to make sure that this isn't a repeat and couln't find anything. It seems that code assist will not display the inner classes of a superclass. I have a vendor who gives me a class of static variables and static inner classes. I need to create a class that extends the vendor class to add my constants so I just have to use one class for all my application wide constant variables and so forth. The problem is that Code assist will only help me with the super class variables and not the super class inner classes. A rough example is this.public class Cartoon{ public static class Flintstones { public static String Fred = "fred"; public static String Wilma = "wilma"; }}public class Cartoon2 extends Cartoon{ public static class Rubbles { public static String Barney = "Barney"; public static String BamBam = "BamBam"; }}I should be able from another class to do this:Cartoon2.<code assist should show me Rubbles and Flintstones>Flinstones.<Code assist should show me Fred or Wilma>WilmaUnfortunately Code assist will only display what's in the current class as a static inner class.Thanks,Stu	Defer post 3.2Reopen as LATER is deprecated and change priority to P5.***has been marked as a duplicate of this bug. ***	3.0
id=61437	REOPENED	JDT	Core	3.0	PC Windows XP	P5 minor	JDT-Core-Inbox	2004-05-07 14:58 EDT by	Markus Keller	2008-04-02 07:00 EDT (	0 users	With a jdk with source attachment, search for references to typejava.util.Random . There are matches in the import statements of class files(e.g. in java.io.File).-> was: enclosing element of these matches is the BinaryType of the IClassFile-> expected: enclosing element is the class file	deferred post 3.0If(and its duplicate) is fixed, the enclosing element should be an IImportDeclaration.Reopen as LATER is deprecated...	3.0
id=79392	REOPENED	JDT	Core	3.1	PC Windows XP	P5 normal	JDT-Core-Inbox	2004-11-24 10:17 EST by	Victor Toni	2016-01-14 12:49 EST (	3 users	I am trying to use a small library I wrote in 5.0 (only generics were harmed)with an 1.4 project and got an "UnsupportedClassVersionError".Trying to set ("Generated .class files compability") (for the library) inPreferences->Java->Compiler->Compliance and Classfilesto "1.4" gives this error:"When source compability is 5.0, the classfile compabilty has to be 5.0"How am I supposed to do something like "javac -source 5 -target 1.4" (without Ant)?	I found a workaround for this problem by editing .settings/org.eclipse.jdt.core.prefsand setting org.eclipse.jdt.core.compiler.codegen.targetPlatform=1.4It seems to be only a constraints problem for the UI.Moving to jdt.core: Question, should the UI allow to set source=5 target=1.4?Move back if it should.This mode is not tolerated. We are not verifying the settings (control is meantin the UI). It looks like we should perform some sanity check in the compileritself, as you found a way to workaround the limitation.Basically, this mode is not supported (1.5 sources need 1.5 target).Olivier - pls look at adding validation in the compiler itself (likely takevalidation from batch compiler and push it down into compiler). If compliancesettings are broken, the compiler should immediately abort.Editing the preference page is clearly not something to do. It the UI complains,there is a good reason for that.I will see how to add check to prevent this workaround.Frederic,If compliance = 1.5, we want to discard all changes to .settings that are notcompatible. We don't need to test the value of source and target. They should be1.5 if the user didn't update the preference file.compliance = 1.5 => source 1.5 and target = 1.5Please don't do this.This would break compability for programs which must run under 1.4.AFAIK e.g. generics is only a "preprocessor" hack, so this should be able to runon an older VM.It makes perfectly sense to write 5.0 which may be used in an 1.4 environment.I would apppreciate the possibility to shoot myself in the foot if I would like to.SUN's compiler has this option and I would like to have the same option withinEclipse.Check:BTW: my library works like a charm after the .seetings workaround.Sorry, my fault.Just after summiting I tried the SUN compiler just to realize that it can beused with "-source 1.4 -target 1.x" (x < 5) but not with "-source 1.5 -target 1.x".(why did they introduce erasure if it doesn't work with 1.4?)Nevertheless I would like this possibilty to stay within JDT.At least with generics it works seemless and I think this will be one of themost used features of 1.5.Changing the JDT compiler would mean that I would prefer not to upgrade beyondmy current version.Perhaps it works in your specific case, but it has 99% of "chance" to fail inother cases... Having target > source level is definitely something notacceptable for Eclipse compiler (as Sun one's...).So, JavaProject will now always verified that options stored in jdt-core.setting file will always verify rules: target <= source <= compliance.In case not, then these options will be automatically modified as follow:1) if source > compliance then compliance will be set to source and target to default value (see below)2) if source <= compliance and target > source then target will be set to default value (see below)Target default value--------------------1) compliance == 1.3 => target = 1.12) compliance == 1.4 a) source == 1.3 => target = 1.2 b) source == 1.4 => target = 1.43) compliance == 1.5 a) source == 1.3 => target = 1.2 b) source == 1.4 => target = 1.4 c) source == 1.5 => target = 1.5Olivier, this proposal (got from verifications done in Main) does not match therule you talked about in...Instead of: if compliance == 1.5 then source = 1.5 and target = 1.5we will have: if source == 1.5 then compliance = 1.5 and target = 1.5Then this implementation will allow: compliance = 1.5, source = 1.4 and target = 1.4which sounds perfectly valid...Sorry, I've made a mistake while reading verification done in Main...target <= source <= compliance is not enough...So, in, you should read:So, JavaProject will now always verified that options stored in jdt-core.setting file will always verify following rules:1) if source == 1.5 then compliance >= 1.5 and target >= 1.52) if source == 1.4 then compliance >= 1.4 and target >= 1.43) target <= complianceThe default in 3.0.1 is:Compliance == 1.4target == 1.2source == 1.3Why shouldn't it be possible to have:Compliance == 1.5target == 1.4source == 1.5I don't see a point to delete this feature, you may make it harder to use (e.g.by having another default) but it still has a value to be able to compile for anolder platform.Victor,Compliance == 1.5target == 1.4source == 1.5doesn't make sense. Some 1.5 source code patterns need new 1.5 classes duringthe code generation or at runtime. So if you don't have these classes around, itwon't run properly.Allowing your configuration would allow to run 1.5 code using 1.5 classes on a1.4 VM. This would lead to NoClassDefFoundError or NoSuchFieldError orNoSuchMethodError.Note that javac doesn't allow it as well. Try to compile using -source 1.5 and-target 1.4. You would get:C:\tests_sources>javac -source 1.5 -target 1.4 X.javajavac: source release 1.5 requires target release 1.5Frederic, yourlooks good. This should prevent this invalid setting.I know because it happend to me, but this may happen also if one develops withone version of a certain library and deploys with another.If one takes a library e.g. like JDOM and changes all standard Lists to typedLists there is no need for additional libraries or classes, it's only aconvenience implementation to avoid all the casting (at least in written code).This would make some of the code easier to maintain/read/whatever withoutbreaking support for people depending on older JVM.IMHO it shouldn't be a default but people should be able do this if they reallywould like to. Maybe I am the only one arguing about it because this issue isn't widelyrecognized (yet).All articles I've read talk about the "new/wonderful/buzzword" features of"Tiger" and explain why erasure was introduced, but fail to mention that onceyou switch, there is no way back.Your project, your decision.Maybe you would like to take a look at this thread:Sorry to bother you all, I just thought that this would be a nice and importantfeature for people who know what they do; I'll stick with my milestone.I made another test to be sure:SUN's compiler in 1.5 doesn't support:-source 1.5 -target 1.4but it does support (the undocumented feature):-source 1.5 -target jsr14which will compile 1.4.x compatible bytecode.Jsr14 is not an official target, and does not mean it should be supportedofficially by Java compilers. For instance, some 1.5 features cannot be easilyretrofitted in 1.4 VMs, and have to be turned off (think covariance). So thisextra mode is somewhat hybrid, and likely not maintained. And yes, perconstruction, we are likely close to supporting it, but this is not intentionaland you exposed it by manually tampering with property files (which actually weshould handle in a consistent manner).We could investigate supporting this 1.5->1.4 scenario, but this is an extrafeature request, not precluded by 1.5 support per se. Thus this is something forLATER (iff there is an actual need for it). Currently we are focusing on 'real' 1.5 support.Moreover, after long discussion about this verification, it appears that modifyproject options silently, even it they are not correct, would be not the rightsolution.So, you're surely happy to hear that we'll not modify current behavior, but weprefer to think about API changes on IJavaProject getOption, getOptions,setOption and setOptions methods to raise an exception while discovering invalidoptions.I remove target from this bug as this is not planned yet...When time permitThanks.Initial implementation has been released in HEAD as commented code.When uncommented, it only verifies values and compatibility for 3 compiler options:- JavaCore.COMPILER_COMPLIANCE,- JavaCore.COMPILER_SOURCE,- JavaCore.COMPILER_CODEGEN_TARGET_PLATFORM.***has been marked as a duplicate of this bug. ***Reopen as LATER is deprecated...	22.0
id=90112	REOPENED	JDT	Core	3.0.1	PC All	P5 enhancement	JDT-Core-Inbox	2005-04-03 09:33 EDT by	Ralf Hauser	2008-08-22 11:25 EDT (	1 user	Apparently, there is a second class that already does this.Therefore my suggestion:1) say where the other occurrence is...2) offer (in a quick fix?) to show the other location in the navigator as welland/or open it...3) Suggest (in a quick-fix) to review whether all "source folders" in the JavaBuild Path are adequate...This happened to me when getting xml-crimsom from the apache cvs, attempting todo an ant on the command-line. This created a build/src directory. Then Iimported it into eclipse and an extra src file was registered in the build-path	Moving to JDT/Core first to- add additional info to the error text- optionally provide information so that quick fix could navigate to the second classDeferring post 3.1I would also need this. Today a co-worker of mine encountered this problem. The main issue is that the error given is wrong (there actually is not any other type defined with the same name!!!), but I cannot track the problem because:1) the error doesn't say WHERE the type should be already defined...2) I don't find any other Java problem in the Problems view that could be the source of this problem (i.e.: a build path problem or such...)3) I don't find anything useful in Eclipse logMaybe, if this error gave the position of the "already defined type" I would have some more information to search for the actual source of problems...Mauro.Reopening since LATER is deprecatedMarking as enhancement	5.0
id=89093	REOPENED	JDT	Core	3.1	PC Windows XP	P5 normal	JDT-Core-Inbox	2005-03-25 07:29 EST by	Philipe Mulet	2011-03-29 09:15 EDT (	0 users	Build 3.1m5aIn the same way as it caches JAR package lists globally, one could imagine doingthe same for binary folders as well.The updating scenario would be when:- it is an output folder : then when owning project build, data is discarded(note that output could be shared across several projects)- refreshed internally(delta)/externally(manual refresh timestamp based)This could speed up quite a lot a build full-source scenario since binaryfolders are massively used then	We did the jar file package cache because of the memory used to open every jar file to find out it didn't include the package... binary/class folders do not need memory to answer isPackage().Also with the jar package cache, we have the timestamp of the jar file to tell us when to flush it. What can we use for a binary/class folder?How would we know that another ant task/builder (even during this build cycle) has not modified the folder? How do we avoid scanning the folder & its sub-folders?My intent was to cache binary folder packages throughout a build iteration.Nothing more fancy. Pretty much, a binary folder cache would be trusted, unlessit contains any delta, and output folders would be reset by projects outputtingto them.I am interested in speeding up the clean build of full source workspacescenario; and trying to find possible speed optimizations.But you do not know whether a binary/class folder has been modified by another builder or task... its not an issue if/when the JavaBuilder modifies it.We get a delta when this occurs, don't we ? Rule would be if any delta in it,then flush.deferneed to think more of it	6.0
id=97822	REOPENED	JDT	Core	3.1	PC Windows XP	P5 minor	JDT-Core-Inbox	2005-06-01 08:46 EDT by	Frederic Fusier	2015-11-19 12:00 EST (	1 user	Using 3.1 RC1.Here's test case: import java.util.ArrayList; import java.util.List; public class X { public <T> List<Y<T> foo(T t) { List<Y<T>> lyt = new ArrayList<Y<T>>(); return lyt; } } class Y<T> {}I get 5 errors: - "Syntax error, insert '>' to complete ReferenceType1": expected error - 5 x "T cannot be resolved to a type": unexpectedIsn't there a way to avoid these 4 unexpected errors ?	Probably a weakness in recoveryCurrently, there is no recovery for type parameter.There is a syntax error in the return type, so the recovered method is "Y<T>foo(T t)">. When this recovered method is parsed, the type paramater has beenalready parsed and removed from Parser stack.A change in this area is too risky for now. Deferred post 3.1.As of now 'LATER' and 'REMIND' resolutions are no longer supported.Please reopen this bug if it is still valid for you.(In reply to Frederic Fusier from)Those are all gone in master (4.6.0.I20151028-0800).Current errors:- Syntax error, insert ">" to complete ReferenceType1=> good- At "return lyt;": Type mismatch: cannot convert from List<Y<T>> to Y<T>=> bad; AST recovery for the return type dropped the "List<" and just left "Y<T>"	4.0
id=127994	REOPENED	JDT	Core	3.2	PC Windows XP	P5 major	JDT-Core-Inbox	2006-02-15 05:26 EST by	David Turley	2014-11-13 19:09 EST (	8 users	NOTE: This bug is similar to a previous Bug report (43993) that was marked as resolved, but I think the bug report was mis-understood.Why is this a Problem: ----------------------Want to use "Project -> Java Build Path -> Source Tab"to configure my project IDE build processs to include EAR/WAR config dependencies (like web-inf/web.xml). The "PROJECT/build" directory will then contain all the files necessary for local deployment and debug testing in Eclipse, which JBoss server point to on startup. For trying to track down a solution for this via google, I find its a common senario alot of eclipse developers want to use to make easier local deployment of there Web project, but the keep on running into "Cannot nest output folder .. inside ..." problem.Advantage are------------- a) is it easy to setup then 3 party solution - dont have to hand edit other files like WTP .wtpmodules etc.b) higher intergration and better customization of enterprise build process in the IDE.c) any changes made to source, JSP, config files etc, are automatically reflected/deployed (by Project->Build Automatically) within you running web application without additional work. Scenario:---------I have the following project structure (J2EE app):- src +- java (Java sources) +- web (JSP, HTML, ...)- conf (e.g. web.xml)and would like to build to the following output:- build +- webapp (all from src/web) +- WEB-INF (all from conf) +- classes (compiled from src/java)to achieve this, I would define three source folders, each with its own output folder:src/java -> build/webapp/WEB-INF/classessrc/web -> build/webappconf -> build/webapp/WEB-INFUnfortunately, this does not work with Eclipse 3.x, as you keep on getting the "Cannot nest output folder .. inside ..." message.Example: "Cannot nest output folder 'PROJECT/build/webapp/WEB-INF/classes' inside 'PROJECT/build/webapp'".Possible solution:------------------In tab "Project->Properties->[Java Build Path]->[Source]"on pressing the Edit button for [Output-folder] option of "build/webapp",could you a) allow the user to "Specify output folder (path relative to 'PROJECT') ------------------------------------------------------------------------NOTE: this not work a present because get the "Cannot nest output folder..." message. Example: if Default Output folder is 'PROJECT/build' and Source 'conf' output folder is 'PROJECT/build/webapp/WEB-INF'then 'conf/web.xml' is allowed to deployed under 'PROJECT/build/webapp/WEB-INF/web.xml'b) allow the user to "Specify output folder (path relative to 'DEFAULT OUTPUT FOLDER').-----------------------------------------------------------------------------Example: if Default Output folder is 'PROJECT/build' and Source 'conf' output folder is '[DEFAULT OUTPUT FOLDER]/webapp/WEB-INF'then 'conf/web.xml' is allowed to deployed under 'PROJECT/build/webapp/WEB-INF/web.xml'c) or introduce or reuse another tab (like Order and Export)-------------------------------------------------------------to allow the user to specify other enterprise dependencies (that may not necessary be source code like JSP, XML config files etc) to be automatically reflected/deployed (by Project->Build Automatically) within your local build without additional work.Thanks guys and girls for any help on this. This would be a great bug-fix or enhancment to improve the Eclipse build process.Kind regardsDavid	I'd like to second this. I'm working on a webapp and want to be able to point Tomcat at the directory that eclipse compiles code into (using a custom context) for ease of development. Currently, this is done by pointing tomcat at PROJECT/web (containing the master web files) and PROJECT/src/java outputs to PROJECT/web/WEB-INF/classes. However this makes building with other tools difficult because the "clean" web directory is "polluted" by generated classes. In particular, maven builds run from the command line have problems. Being able to set things up as David has described would make life much easier; I don't understand why eclipse actively prevents this.Definitely not in reach for 3.2, but will consider allowing more flexible layouts in 3.3 (plan item). This is a great usecase.Hi folks,I'd just like to add my voice to this issue to ensure it's resolved in 3.3.The recommended Tomcat source/deploy layout of <base>/web --> <base>/build/weband <base>/src --> <base>/build>/web/WEB-INF/classescannot be used in Eclipse. I'm really puzzled as to why not.Thanks,John MuirI agree with you too.This problem can be a nightmare if you work with a medium/large web project and every file you save you have to recompile all with maven and then redeploy it back to the server.I would give you all my votes if I could :-)Regards,Alejandro.As of 3.3 RC4, this bug is still outstanding and has not been RESOLVED as previously indicated.Package your project: Alternative to NESTED BUILD folder issue.---------------------------------------------------------------Issue: define your own NESTED folders under Project->Java Build Path->Source-output-folders, thereby allowing you to package your project.While you wait for the Project build issue to be resolved, there are 2 alternative approached you can try, both of which I've used successfully. 1) Ant - Create your own ant build .xml file to do your stuff (for instance package compiled code to an exploded .ear directory) and add it to 'Project->Builders' by pressing 'New' and select 'ant' from the list that appears. So next time Eclipse does an automatic compile of your modified .java or some other text file by calling the 'Java Builder' ant file, it will follow that by calling your newly added build file.2) JBoss Package Builder (Ant) - Use JBoss IDE, which has a Package Builder UIto allow you to package your .jar or .ear any which way you want – much better then (Project->Java Build Path->Source-output-folders). What Package Builder UI does, is it automatically creates an ant .xml file for you and like 1) above adds it to Project->Builders just after 'Java Builder'. What good is you are not dependant of JBoss server to take advantage of its Package Builder UI, after all, it just generates an Ant .xml file. Hope this helps youCheers allDavidI'm using Eclipse on Linux:Eclipse IDE for Java DevelopersVersion: Helios Service Release 1Build id: 20100917-0705This is still a major problem, and like the other comments it's because I'm developing a web app.This is REALLY MAJOR BUG! Hhhhh (silent angry) - switching onto Idea...	8.0
id=263976	REOPENED	Platform	Resources	3.5	PC Windows XP	P5 enhancement	Platform-Resources-Inbox	2009-02-06 12:11 EST by	Karen Butzke	2009-08-03 10:47 EDT (	2 users	Createdproposed patch against HEAD to support contentType versionThe WTP Dali team needs a content type that is only different by the schema version. We are currently using XmlRootElementContentDescriber2 as our content type describer and are specifying the namespace and root element name. Now we need support for a version as well.I have attached a patch with a possible fix for this issue. The content-type element value is now described with {namespace}name/dtd:version	Please note that super class of XMLRootElementContentDescriber2 e.i. XMLContentDescriber is API now. You could extend it and create a describer that considers the version.However if you think that XMLRootElementContentDescriber2 should support the version, your patches are welcome. It would be desirable, to have javadoc and tests updated too.Marking WONTFIX, see.Hey, was this closed because we didn't yet provide javadocs and tests?We recently had this bug opened against us:One solution to that would be to add the content type describers that we use, such as the one that tests for version as well, to foundation plugins. Is this still an open possibility?(In reply to)Really it was because XMLContentDescriber is API now (as described in), so now you can create an arbitrary xml describer by extending this API.Sure. However tests and robust javadocs are required.(In reply to)Right, and we did do that. But the extension point is loading the describer and our plugin. We *could* work around that, but to me it makes more sense to try and contribute the content describer version support back to core.	5.0
id=53370	REOPENED	Platform	UI	3.0	All All	P5 enhancement	Platform UI Triaged	2004-02-29 21:27 EST by	quartz quartz	2014-06-26 09:59 EDT (	3 users	there is a loss of space (titlebar) when a view is alone (not stacked with others).	Assuming that I understand you, this is not different from any other tab folder, native or emulated (ie.- this is not specific to the new look, since views have always been shown as tab folder tabs). Are you requesting that views not be shown as tab folder tabs?I'm guessing that this will resolve to a ui-level request, so moving report there. If I'm wrong then please move it back.Use case: the debug view, alone (nothing else stacked) in the "rectangle section"The old look:-there is NO tabs, because there is only one view. The view name is in theview toolbar.The new look:-there is always a tab, with the minimize/maximize icons on the right.and then there is the view toolbar underneath.When there are stacked view, tabs are shown. They use a similar space in bothlooks, but when the view is alone, the tabs should disappear entirely and leaveonly the "named" view toolbar.Reassigning bugs in component areas that are changing ownership.There are no plans to fix this in the default presentation.Of course there are no plans, it is a request for enhancement.File a request to the change control board, and have them make a plan or state the reason for rejection (and copy it here).This empty comment is not the proper way to discard a RFE.There should be consensus.If it cannot even be an option, then at least a comment should indicate why this UI regression is deemed acceptable and why a fix will not be tried.Thank you for sticking with the development process.Remy is now responsible for watching the [ViewMgmt] category.Views are an important concept of Eclipse.This idea makes sense, but it should probably be opt-out (a preference should control whether this is enabled or not and be set to false by default).The issue I see with this suggestion is that the workbench would look different if someone opens another view, then tabs will appear. There is a risk of confusing users.	7.0
id=141636	REOPENED	Platform	UI	3.2	PC Windows XP	P5 normal	Platform UI Triaged	2006-05-12 17:11 EDT by	Davor Cubranic	2008-07-07 22:51 EDT (	3 users	3.2RC1I switched to another editor and its contents went blank (gray background). Switching to other editors showed the same thing. The following is the entry from the .log:!ENTRY org.eclipse.ui 4 0 2006-05-12 13:57:13.598!MESSAGE java.lang.NullPointerException!STACK 0java.lang.NullPointerException at org.eclipse.ui.internal.presentations.PresentablePart.setVisible(PresentablePart.java:140) at org.eclipse.ui.internal.presentations.util.PresentablePartFolder.select(PresentablePartFolder.java:270) at org.eclipse.ui.internal.presentations.util.LeftToRightTabOrder.select(LeftToRightTabOrder.java:65) at org.eclipse.ui.internal.presentations.util.TabbedStackPresentation.selectPart(TabbedStackPresentation.java:394) at org.eclipse.ui.internal.PartStack.refreshPresentationSelection(PartStack.java:1147) at org.eclipse.ui.internal.PartStack.setSelection(PartStack.java:1100) at org.eclipse.ui.internal.PartStack.presentationSelectionChanged(PartStack.java:798) at org.eclipse.ui.internal.PartStack.access$1(PartStack.java:784) at org.eclipse.ui.internal.PartStack$1.selectPart(PartStack.java:122) at org.eclipse.ui.internal.presentations.util.TabbedStackPresentation$1.handleEvent(TabbedStackPresentation.java:126) at org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent(AbstractTabFolder.java:267) at org.eclipse.ui.internal.presentations.util.AbstractTabFolder.fireEvent(AbstractTabFolder.java:276) at org.eclipse.ui.internal.presentations.defaultpresentation.DefaultTabFolder.access$1(DefaultTabFolder.java:1) at org.eclipse.ui.internal.presentations.defaultpresentation.DefaultTabFolder$2.handleEvent(DefaultTabFolder.java:84) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:925) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:949) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:934) at org.eclipse.swt.widgets.Widget.notifyListeners(Widget.java:706) at org.eclipse.swt.custom.CTabFolder.setSelection(CTabFolder.java:3170) at org.eclipse.swt.custom.CTabFolder.onMouse(CTabFolder.java:1953) at org.eclipse.swt.custom.CTabFolder$1.handleEvent(CTabFolder.java:288) at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:66) at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:925) at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3346) at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2966) at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1914) at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:1878) at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:419) at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:143) at org.eclipse.ui.internal.ide.IDEApplication.run(IDEApplication.java:95) at org.eclipse.core.internal.runtime.PlatformActivator$1.run(PlatformActivator.java:78) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:92) at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:68) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:376) at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:169) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at org.eclipse.core.launcher.Main.invokeFramework(Main.java:336) at org.eclipse.core.launcher.Main.basicRun(Main.java:280) at org.eclipse.core.launcher.Main.run(Main.java:977) at org.eclipse.core.launcher.Main.main(Main.java:952)	Are you using the default presentation?Could you please add your entire log as an attachement?Thanx,PW(In reply to)I started off with the default presentation and customized it just a bit: I use only icons in the perspective switcher and I've rearranged the views somewhat.Sorry, I don't have it any more.That's OK for presentation, I was wondering if you used the R2.1 presentation. And I'm guessing the editors show up in multiple tabs.Ostensibly, this is caused by trying to show editors shortly after they've been disposed.What were you doing just before it went grey? Had you tried to shut down eclipse? What type of editors did you have open? Did it effect different types of editors (java/text/ant) or did you just have one type open. Did restarting eclipse fix the grey problem?What extra plugins do you have installed? WTP, EMF, subversion, etc?Later,PW(In reply to)I was just using it normally, didn't try to shut it down or anything. I tried switching to an editor and there was just the gray area where there should have been text. The problem affected all editors that were open, switching between them didn't change anything, there was just gray. The editors open at the time were mostly Java plus possibly a couple of text files shown using an internally developed editor plugin that does colouring and indentation.Yes, everything is working normally now.Mylar and the internal plugin already mentioned.Is this still a problem in 3.3?PWI don't use 3.3 and haven't seen the bug reappear in 3.2 either. But as I said, it was not readily reproducible, and the only thing I have is the log.If it does crop up again, please re-open.PWChanges requested onI haven't been able to reproduce this yet in 3.3PWHi,I got the same problem on eclipse 3.3 in this code, no custom presentations used (org.eclipse.ui.workbench_3.3.0.I20070608-1100.jar).try { PlatformUI.getWorkbench().getActiveWorkbenchWindow().getActivePage().openEditor(...);} catch (Exception e) { if (e instanceof PartInitError) { PlatformUI.getWorkbench().getActiveWorkbenchWindow().getActivePage().closeEditor(...);}}As I debugged it, the editor part was disposed and set to null right before the moment, the TabbedStackPresentation want to set it not visible.Hope it helps.Pavel, could you please attach any error log that's generated when you do this?ThanxPWjava.lang.NullPointerException at org.eclipse.ui.internal.presentations.PresentablePart.setVisible(PresentablePart.java:179) at org.eclipse.ui.internal.presentations.util.TabbedStackPresentation.setVisible(TabbedStackPresentation.java:314) at org.eclipse.ui.internal.PartStack.setVisible(PartStack.java:1058) at org.eclipse.ui.internal.PartSashContainer.remove(PartSashContainer.java:734) at org.eclipse.ui.internal.EditorSashContainer.removeEditor(EditorSashContainer.java:295) at org.eclipse.ui.internal.EditorAreaHelper.closeEditor(EditorAreaHelper.java:84) at org.eclipse.ui.internal.EditorAreaHelper.closeEditor(EditorAreaHelper.java:62) at org.eclipse.ui.internal.WorkbenchPage.closeEditors(WorkbenchPage.java:1298) at org.eclipse.ui.internal.WorkbenchPage.closeEditor(WorkbenchPage.java:1367)... this call comes from our code as described above.The same problem during workbench restart (Eclipse 3.3.2 on Linux):java.version=1.6.0_06java.vendor=Sun Microsystems Inc.BootLoader constants: OS=linux, ARCH=x86, WS=gtk, NL=en_USCommand-line arguments: -os linux -ws gtk -arch x86ErrorMon Jul 07 12:09:20 PDT 2008Problems occurred when invoking code from plug-in: "org.eclipse.ui.workbench".java.lang.NullPointerExceptionat org.eclipse.ui.internal.presentations.PresentablePart.setVisible(PresentablePart.java:179)at org.eclipse.ui.internal.presentations.util.TabbedStackPresentation.setVisible(TabbedStackPresentation.java:314)at org.eclipse.ui.internal.PartStack.setVisible(PartStack.java:1058)at org.eclipse.ui.internal.PartSashContainer.remove(PartSashContainer.java:735)at org.eclipse.ui.internal.EditorSashContainer.removeEditor(EditorSashContainer.java:295)at org.eclipse.ui.internal.EditorAreaHelper.closeEditor(EditorAreaHelper.java:84)at org.eclipse.ui.internal.EditorAreaHelper.closeEditor(EditorAreaHelper.java:62)at org.eclipse.ui.internal.WorkbenchPage.closeEditors(WorkbenchPage.java:1307)at org.eclipse.ui.internal.WorkbenchPage.closeAllEditors(WorkbenchPage.java:1131)at org.eclipse.ui.internal.WorkbenchPage.dispose(WorkbenchPage.java:1653)at org.eclipse.ui.internal.WorkbenchWindow.closeAllPages(WorkbenchWindow.java:825)at org.eclipse.ui.internal.WorkbenchWindow.hardClose(WorkbenchWindow.java:1559)at org.eclipse.ui.internal.WorkbenchWindow.busyClose(WorkbenchWindow.java:699)at org.eclipse.ui.internal.WorkbenchWindow.access$0(WorkbenchWindow.java:675)at org.eclipse.ui.internal.WorkbenchWindow$2.run(WorkbenchWindow.java:790)at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:67)at org.eclipse.ui.internal.WorkbenchWindow.close(WorkbenchWindow.java:788)at org.eclipse.jface.window.WindowManager.close(WindowManager.java:109)at org.eclipse.ui.internal.Workbench$15.run(Workbench.java:908)at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)at org.eclipse.ui.internal.Workbench.busyClose(Workbench.java:905)at org.eclipse.ui.internal.Workbench.access$15(Workbench.java:834)at org.eclipse.ui.internal.Workbench$22.run(Workbench.java:1078)at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:67)at org.eclipse.ui.internal.Workbench.close(Workbench.java:1076)at org.eclipse.ui.internal.Workbench.restart(Workbench.java:2075) ...	13.0
id=20298	REOPENED	Platform	UI	2.0	All All	P5 minor	Platform UI Triaged	2002-06-13 17:24 EDT by	Peter Burka	2008-04-09 10:22 EDT (	1 user	Build F2I created an instance of a org.eclipse.jface.action.MenuManager.The menu is used as a sub-menu in a context menu, and is populated each time it's shown when my editor receives an editorContextMenuAboutToShow() message.If the menu is empty the first time that it is shown, it is displayed as disabled.If the menu is non-empty on subsequent clicks, the sub menu still displays as disabled. But if you click on the submenu, it corrects itself and shows its contents, as desired.I can work around this problem by sending update(false) to the MenuManager after I populate it, but I don't believe that this should be necessary.	The update should not be necessary.Moving Dougs bugsAssigning to component ownerPWIs this still a problem in 3.3?CreatedPatch to update the MenuManager when its parent menu is about to be shown.The updating code for enabling the submenu isn't being called until it is about to be shown so it is being rendered as disabled. The attached patch shows that this problem can be resolved by listening for notifications that the _parent_ menu is about to be shown. This way, the setting of the enabled/disabled state can be processed and what's drawn on the parent menu corresponds to what should be happening.I am not suggesting that this is the right way to fix it but am purely attaching it for illustrative purposes.------I believe that the code below illustrates the scenario depicted in.The sample will open up a new shell with a button. The context menu of the shell should just have a submenu, this will appear as being enabled but once you try to "cascade in" the submenu (by hovering over it), it'll disable itself.Now click the button, a contribution item will be added to the manager. Bring up the context menu again, it is still being disabled, but after clicking on it, the submenu "expands" as described by.------import org.eclipse.jface.action.Action;import org.eclipse.jface.action.MenuManager;import org.eclipse.swt.SWT;import org.eclipse.swt.events.SelectionAdapter;import org.eclipse.swt.events.SelectionEvent;import org.eclipse.swt.layout.FillLayout;import org.eclipse.swt.widgets.Button;import org.eclipse.swt.widgets.Display;import org.eclipse.swt.widgets.Menu;import org.eclipse.swt.widgets.Shell;public class SampleUI { public static void main(String[] args) { Display display = new Display(); Shell shell = new Shell(display); final MenuManager manager = new MenuManager("Menu"); shell.setLayout(new FillLayout()); Button button = new Button(shell, SWT.PUSH); Menu menu = new Menu(button); button.setMenu(menu); manager.fill(menu, 0); button.setText("Add"); //$NON-NLS-1 button.addSelectionListener(new SelectionAdapter() { public void widgetSelected(SelectionEvent e) { manager.add(new Action("Action") {}); } }); shell.setSize(200, 200); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } display.dispose(); }}Released to HEAD >20080408PWpartBroughtToTop will not solve this in all cases either, seePW(In reply to)Sorry, the comment was bogus. This is reopened because it was killing eclipse application launching on linux.PW	8.0
id=214025	REOPENED	Platform	UI	3.4	PC Linux	P5 normal	Platform UI Triaged	2007-12-30 14:17 EST by	Patrik Dufresne	2008-05-03 19:03 EDT (	1 user	Build ID: M20070921-1145Steps To Reproduce:Calling setMenuCreator() function of an Action object doesn't update the associated widget.More information:Action object of the jFace library must be modify to fire a propertyChanged message when the MenuCrator are change. Also, ActionContributionItem must update MenuItem when receiving this message.	Do you mean for an dropdown action used in a menu (as opposed to a dropdown tool item)?PWPlease re-open with info.PWAction object in JFace library have a method named setMenuCreator(IMenuCreator creator). As describe in SWT documentation, this method are used to set the menu creator for this action.When I create the action, I set a default MenuCreator. For some reason, I want to change the MenuCreator of this action. A legitimate try is to call an second time setMenuCreator() with a new menuCreator.If I do so, ActionContributionItem doesn't update the state of the associated widget (menuItem, toolBarItem, etc.).As mention in first description, Action object must notify listener by calling propertyChanged() method and ActionContributionItem must handle this change.It doesn't say that IAction should fire a change event when setMenuCreator(*) is called.The common pattern (and this is old API) is to set one menu creator and update it as needed. Something like the Run button does, where the run dropdown menu must display the last N launch configs used).setMenuCreator(*) is API (unfortunately) that allows you to tie your action "abstraction" directly to the underlying widgets, bypassing the rendering engine.PW	4.0
id=488743	REOPENED	Platform	SWT	4.5.2	PC Linux	P5 normal	Platform-SWT-Inbox	2016-03-01 04:11 EST by	Piotr Findeisen	2016-03-03 08:09 EST (	1 user	* steps to reproduce1. Open a Java editor with the following contentpublic class C { // fear forest for f<cursor>}2. press Alt+/ (Word Completion) several times (holding Alt all time, or releasing and pressing it again -- doesn't matter).* expected (and actually observed on Windows)Word Completion offers "for", "forest", "fear" and then other proposals (based on other files, i guess), cycling when set of proposals is exhausted.* observed on LinuxWord Completion offers "for", "forest" and nothing more, not even "fear" (same file proposal). Doesn't even cycle.It looks as if Alt+/ Word Completion was losing the memory that it's being used in a continuous manner; i.e. every Alt+/ was a fresh completion. Effectively, the previous completion is a prefix for next completion, whereas the text actually written by a human should be the prefix for next completion.	Word completion is disabled by default. I suspect you have enabled in your Windows workspace but not on Linux. You can configure this viaWindow > Preferences > Java > Editor > Content Assist > Advanced(In reply to Dani Megert from)Hi Dani,Thanks, but i think we talk about different things.In '... Java > Editor > Content Assist > Advanced' i can enable "Word Proposals" and this indeed does change the proposals returned by Ctrl+Space ("Content Assist" command as far as "preferences > keys" are concerned).And yes, I had this disabled -- in both workspaces (I use workspacemechanic to sync settings, btw.)However, the bug concerns Alt+/ ("Word Completion" command) rather than "Content Assist".(In reply to Piotr Findeisen from)Oops, sorry about that!Alt+/ works fine for me on Windows and Linux usingMaybe the keybinding got lost, changed or overridden by another plug-in. Please check on the General > Keys preference page. There you can also try whether it works when you assign a different key binding.(In reply to Dani Megert from)Thanks for the suggestion. I found out that:* "Word Completion" is the only command bound to Alt+/* when I assigned Ctrl+H, word completion started to work* when I assigned Alt+H, is started to work erratically (as initially described).So I guess it's a matter of Alt functioning differently.Oh, and BTW, I'm using Unity (@ Ubuntu 15.10), although I have Unity's Alt binding ("show HUD") disabled.(In reply to Piotr Findeisen from)Seems to be a Unity specific keybinding issue. I suggest to use an alternate keybinding for now.	5.0
id=93551%0D%0A	REOPENED	Platform	SWT	3.1	PC Windows XP	P5 enhancement	Steve Northover	2005-05-03 11:47 EDT by	Randy Hudson	2010-03-18 10:02 EDT (	3 users	I have a canvas with multiple fake widgets on it. When my canvas gains focus, Ineed to know whether I should set "fake focus" on the first or the last fakewidget. In other words, I need to know whether SHIFT+TAB occurred, or somethingelse.There is no state mask on a FocusEvent, so I don't know how to do this.Our current workaround is just to place focus on the most-recently-focused fakeitem, or the first one if there is no MRU.	This information is not available from the operating systems. For example, WM_SETFOCUS on Windows won't tell you whether focus was assigned using the keyboard or the mouse.Do you have any ideas as to how AWT/Swing with mixed heavyweight composites with lightweight components inside handle TAB/Shift+TAB?I could always try a display filter but it seems like a hack.I have no knowledge about how Swing works other than to mixing heavyweights and lightweights is not recommended/supported. I read this somewhere on the web.Good reply. So, resolved, "CANTFIX".Actually, we should leave this bug open. On some platforms, native components such as the tool bar contain lightweight components (ie. on Windows, each tool item is not an HWND). The strategy they generally use is to remember the item that had focus and restore that item when they get focus. The shell also does this when it is activated.So, WONTFIX is premature. Post 3.1 is better.... and CANTFIX because AWT/Swing CANTFIX or WONTFIX doesn't apply.***has been marked as a duplicate of this bug. ***	7.0
id=74861	REOPENED	JDT	Core	3.0	PC Windows 2000	P5 normal	Satyam Kandula	2004-09-23 17:10 EDT by	John Arthorne	2011-03-15 11:30 EDT (	3 users	Build: R3.0.1VM: IBM J9SC 20040917I have a workspace with a small number of projects, but one of the projects hasa very large number of JARs on its search path (about 2,000 JARs). Sometimeswhile searching I get the exception below. It is possibly caused by otherconcurrent things going on, but it seems that the search might be openingseveral JARs at once during the search, causing it to fail:!ENTRY org.eclipse.jdt.core 4 -1 Sep 23, 2004 11:06:42.221!MESSAGE I/O exception!STACK 0java.util.zip.ZipException: Too many open filesd:\rad20040919_dev\workspace\com.xyz.myplugin\runtime\myplugincode.jar at java.util.zip.ZipFile.open(Native Method) at java.util.zip.ZipFile.<init>(ZipFile.java:140) at java.util.zip.ZipFile.<init>(ZipFile.java:100) at org.eclipse.jdt.internal.core.JavaModelManager.getZipFile(Unknown Source) at org.eclipse.jdt.internal.core.JarPackageFragmentRoot.getJar(Unknown Source) atorg.eclipse.jdt.internal.core.search.matching.MatchLocator.getBinaryInfo(UnknownSource) at org.eclipse.jdt.internal.core.search.matching.MatchLocator.process(UnknownSource) atorg.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(UnknownSource) atorg.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(UnknownSource) atorg.eclipse.jdt.internal.core.search.matching.MatchLocator.locateMatches(UnknownSource) atorg.eclipse.jdt.internal.core.search.JavaSearchParticipant.locateMatches(UnknownSource) at org.eclipse.jdt.core.search.SearchEngine.findMatches(Unknown Source) at org.eclipse.jdt.core.search.SearchEngine.search(Unknown Source) at org.eclipse.jdt.internal.ui.search.JavaSearchQuery.run(Unknown Source) atorg.eclipse.search2.internal.ui.InternalSearchUI$InternalSearchJob.run(UnknownSource) at org.eclipse.core.internal.jobs.Worker.run(Unknown Source)	Its not the search but the JavaModelManager's cache.Does the JavaModelManager cache keep all the JARs open?No, it does not, but they are all opened by JavaSearchNameEnvironment whilecomputing classpath locations. They remain opened during search operation andare closed only at the end. For a large number of jars on classpath, thisprocess is not valid.I've to figure out how it could be possible to handle this specific scenario...CreatedTest to know how many zip files can be opened simultaneouslyJohn,Running attached test case shows that only 2006 zip files can be openedsimultaneously. This seems to be a Windows or VM limitation as we get aZipException...So, I wonder how with such a project (2,000 jar in your classpath!) you caneven build your workspace as all zip files are opened while computingclasspath...?!Seems to be a very peculiar test case as no other similar complain about thislimitation has come since 3.0...Seems to be highly risky trying to change something in this area at this latestage of dvpt => defer post 3.1Yes, there is certainly an OS limitation on the number of open file handles(usually configurable). It might be an unusual case, but I should mention it wasa "real" development workspace, not an artificially created test case. I agreewith deferring until post 3.1,Reopen for 3.2FYI .. I've starting seeing similar java.util.zip.ZipException: Too many open filesin a completely different scenerio ... using update manager's mirror command to "mirror" the callisto projects, on a PPC system, using IBM's 1.4.2 JRE. (and 3.2 RC2 of Eclipse) I have not yet investigated, but thought I'd make a note here, in case anyone has more "news" on this exception. david_williams@utils:~/org.eclipse.callisto.tools/build-home> ulimitunlimiteddavid_williams@utils:~/org.eclipse.callisto.tools/build-home> java -versionjava version "1.4.2"Java(TM) 2 Runtime Environment, Standard Edition (build 1.4.2)Classic VM (build 1.4.2, J2RE 1.4.2 IBM build cxppc32142-20060120 (SR4) (JIT enabled: jitc))david_williams@utils:~/org.eclipse.callisto.tools/build-home>(In reply to)Oh ... never mind ... there was an exception earlier in the log that pointed me to the real problem -- a null file passed to the zip file contructor ... Apparently ZileFile(null) will not throw an exeption right then, but then later throw "too many files open" error. Weird.John,may you please have another go and try with a build > 3.3 M6 and tell us if this issue is still relevant.Thanks.Hello Eric, unfortunately I no longer have that large workspace with the 2,000 JARs available. Feel free to close if you cannot reproduce it.(In reply toThanks John.Frédéric, feel free to close this one if not reproduced with a build > 3.3 M6I'd rather prefer to keep this bug open as the limitation still exists even if the workspace on which it happened is no longer used.However, as this kind of wksp is not so common, I reduce the priority to P4...	13.0
id=304526	REOPENED	Platform	Text	3.6	All All	P5 normal	Serge Beauchamp	2010-03-03 10:35 EST by	Serge Beauchamp	2011-04-29 02:54 EDT (	2 users	When a refresh is performed, and resources that are being edited in the editor window are removed, then no dialog is displayed that allows the user to save his un-saved changes or cancel the operation.	Is it the right component? I think it should be in UI.(In reply to)Yes, I suppose so.The right component is Platform Text but I can't think of a scenario other than the one fromwhich we should fix there. Or do you have steps beyond those?(In reply to)Many user operations can cause resources to disappear, including:- The user adds new filter to a parent of a currently edited resource that ends up removing that resource from the workspace- The user change the link location of a parent (must be a linked resource folder) of a currently edited resource that ends up removing that resource from the workspace- The user creates a new resource that would be filtered out, then refreshes its parent.Note each time I mention 'the user', it could be done programmatically by any plugin as well.Moving to Text as per Dani's comment...The ugly part caused by the resource filter feature is that it can create black holes inside the workspace. Therefore, when we try to save the file by recreating it and its parents - if they don't exist - we get an exception that the resource already exists on disk.I'm not planning to work around this. The user can use 'Save As...'. I've added that hint to the 'Save Problems' dialog.The problem is that the user doesn't have the chance to select 'Save As...', the file is closed right away, and the unsaved content is lost.This is unlike when a drive disappear, for instance, when the user has the option of saving his file in another location.I'm not sure I understand the reason why you are flagging this bug as "Won't fix", it should be left open in my opinion.This isn't a design limitation, or a user error, it is simply an incorrect behaviour in the UI.(In reply to)Please provide detailed steps.(In reply to)Sure:1) Create a new project "project-p"2) Create a new folder in the project-p named "folder-f"3) Create a new file under the folder-f named "file.txt"4) Double-click the file in explorer to open in in the editor5) Type "some text" in the file, DO NOT save the file6) Right click on the "project-p", and select "Properties...".7) Go in the section "Resource | Resource Filters"8) Click the "Add..." button, and create the following filter: - Exclude All - Folders - Name matches "folder-f"9) Click OK and OK again to close the properties dialog10) click on the text editorAt this point, the text editor is summarily closed without any dialog, and displays "File /project-p/folder-f/file.txt does not exist".The user did not have the chance to save his un-saved data.(In reply to)Note that the user can't save the file by closing the editor either, it gives an error "file already exists on disk".CreatedBeginning of a fixHere's a beginning of a fix.The dialog now appears properly, asking the user to save his file, although the next dialog (to select where to save the file) gives an error.(In reply to)That's not what I see but I guess we talk about the same thing ;-). The editor stays open dirty with in-place message that the file no longer exists. If you close the editor you are asked to save. That save fails. As mentioned inI added a hint to that dialog that 'Save As' can be used.A fix would have to show the 'File Not Accessible' dialog with the choice to either 'Close' or 'Save' (where 'Save' would open a 'Save As' dialog) the editor. As a bonus, the dialog could inform the user that the (resource) file is filtered in the workspace but available on disk.Falling back to the files system (location) as proposed by your fix is a no go.(In reply to)Unless I'm missing something, that's exactly what the patch does - see attached screenshot.CreatedBehavior with the patchI didn't try the patch as I don't like where and how it changes things. The behavior looks good though.	15.0
